static int dissect_BISPDU_OPEN(tvbuff_t * tvb, int offset, proto_tree * tree)\r\n{\r\nguint8 rdi_len;\r\nguint8 number_of_non_empty_rib_attributes;\r\nguint8 number_of_distinguishing_attributes;\r\nguint8 rib_attribute_type;\r\nguint8 number_of_rdcs;\r\nguint8 length_indicator_guint8;\r\ngint i;\r\ngint j;\r\nproto_tree_add_item(tree, hf_idrp_open_version, tvb, offset,1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_idrp_open_hold_time, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_idrp_open_max_pdu_size, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nrdi_len = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_idrp_open_src_rdi, tvb, offset, rdi_len, ENC_NA);\r\noffset += rdi_len;\r\nnumber_of_non_empty_rib_attributes = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nfor (i = number_of_non_empty_rib_attributes; i > 0; i--) {\r\nnumber_of_distinguishing_attributes = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nfor (j = number_of_distinguishing_attributes; j > 0; j--) {\r\nrib_attribute_type = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nswitch (rib_attribute_type) {\r\ncase IDRP_PATH_ATTR_TYPE_ROUTE_SEPARATOR:\r\ncase IDRP_PATH_ATTR_TYPE_EXT_INFO:\r\ncase IDRP_PATH_ATTR_TYPE_RD_PATH:\r\ncase IDRP_PATH_ATTR_TYPE_NEXT_HOP:\r\ncase IDRP_PATH_ATTR_TYPE_DIST_LIST_EXCL:\r\ncase IDRP_PATH_ATTR_TYPE_DIST_LIST_INCL:\r\ncase IDRP_PATH_ATTR_TYPE_MULTI_EXIT_DISC:\r\ncase IDRP_PATH_ATTR_TYPE_RESIDUAL_ERROR:\r\ncase IDRP_PATH_ATTR_TYPE_EXPENSE:\r\ncase IDRP_PATH_ATTR_TYPE_HIERARCHICALRECORDING:\r\ncase IDRP_PATH_ATTR_TYPE_RD_HOP_COUNT:\r\ncase IDRP_PATH_ATTR_TYPE_CAPACITY:\r\ncase IDRP_PATH_ATTR_TYPE_PRIORITY:\r\nbreak;\r\ncase IDRP_PATH_ATTR_TYPE_LOCALLY_DEFINED_QOS:\r\nlength_indicator_guint8 = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(\r\ntree,\r\nhf_idrp_open_rib_attr_locally_defined_qos_nsap,\r\ntvb,\r\noffset,\r\nlength_indicator_guint8,\r\nENC_NA);\r\noffset += length_indicator_guint8;\r\nlength_indicator_guint8 = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(\r\ntree,\r\nhf_idrp_open_rib_attr_locally_defined_qos_value,\r\ntvb,\r\noffset,\r\nlength_indicator_guint8,\r\nENC_NA);\r\noffset += length_indicator_guint8;\r\nlength_indicator_guint8 = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(\r\ntree,\r\nhf_idrp_open_rib_attr_locally_defined_qos_metric,\r\ntvb,\r\noffset,\r\nlength_indicator_guint8,\r\nENC_NA);\r\noffset += length_indicator_guint8;\r\nbreak;\r\ncase IDRP_PATH_ATTR_TYPE_SECURITY:\r\noffset += 2;\r\nlength_indicator_guint8 = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(\r\ntree,\r\nhf_idrp_open_rib_attr_security_reg_id,\r\ntvb,\r\noffset,\r\nlength_indicator_guint8,\r\nENC_NA);\r\noffset += length_indicator_guint8;\r\nlength_indicator_guint8 = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(\r\ntree,\r\nhf_idrp_open_rib_attr_security_info,\r\ntvb,\r\noffset,\r\nlength_indicator_guint8,\r\nENC_NA);\r\noffset += length_indicator_guint8;\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\n}\r\nnumber_of_rdcs = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_idrp_open_number_of_confederations, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nfor (i = number_of_rdcs; i > 0; i--) {\r\nlength_indicator_guint8 = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_idrp_open_confederation, tvb,\r\noffset, length_indicator_guint8, ENC_NA);\r\noffset += length_indicator_guint8;\r\n}\r\nproto_tree_add_item(tree, hf_idrp_open_authentication_code, tvb, offset, 1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_idrp_open_authentication_data, tvb, offset,\r\ntvb_reported_length_remaining(tvb, offset), ENC_NA);\r\noffset += tvb_reported_length_remaining(tvb, offset);\r\nreturn offset;\r\n}\r\nstatic int dissect_BISPDU_UPDATE(tvbuff_t * tvb, int offset, proto_tree * tree)\r\n{\r\nguint16 nb_unfeasible_routes;\r\nguint16 path_attrs_len;\r\nint path_attrs_start_offset;\r\nguint8 path_attr_type;\r\nguint16 path_attr_len;\r\nint start_offset;\r\nguint16 rdi_len;\r\nguint8 proto_len;\r\nguint16 net_len;\r\nint path_segment_rdi_offset;\r\nguint16 length_indicator_guint16;\r\nguint8 length_indicator_guint8;\r\nguint8 nb_of_snpa;\r\nguint8 dist_list_count;\r\nint i;\r\nnb_unfeasible_routes = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_item(tree, hf_idrp_update_number_of_unfeasible_routes,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nfor (i = nb_unfeasible_routes; i > 0; i--) {\r\nproto_tree_add_item(tree, hf_idrp_update_withdrawn_route, tvb, offset,\r\n4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\n}\r\npath_attrs_len = tvb_get_ntohs(tvb, offset);\r\noffset += 2;\r\npath_attrs_start_offset = offset;\r\nwhile (offset < (path_attrs_start_offset + path_attrs_len)) {\r\nproto_tree_add_item(tree, hf_idrp_update_path_attr_flag, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\npath_attr_type = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_idrp_update_path_attr_type, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\npath_attr_len = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_item(tree, hf_idrp_update_path_attr_length, tvb,\r\noffset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nswitch (path_attr_type) {\r\ncase IDRP_PATH_ATTR_TYPE_ROUTE_SEPARATOR:\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_route_separator_id,\r\ntvb,\r\noffset,\r\n4,\r\nENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_route_separator_localpref,\r\ntvb,\r\noffset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset ++ ;\r\nbreak;\r\ncase IDRP_PATH_ATTR_TYPE_EXT_INFO:\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_ext_info,\r\ntvb,\r\noffset,\r\n0,\r\nENC_BIG_ENDIAN);\r\nbreak;\r\ncase IDRP_PATH_ATTR_TYPE_RD_PATH:\r\nstart_offset = offset;\r\nwhile (offset < (start_offset + path_attr_len)) {\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_rd_path_type,\r\ntvb,\r\noffset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nlength_indicator_guint16 = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_rd_path_segment_length,\r\ntvb,\r\noffset,\r\n2,\r\nENC_BIG_ENDIAN);\r\noffset += 2;\r\npath_segment_rdi_offset = offset;\r\nwhile (offset < (path_segment_rdi_offset + length_indicator_guint16)) {\r\nlength_indicator_guint8 = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_rd_path_rdi,\r\ntvb,\r\noffset,\r\nlength_indicator_guint8,\r\nENC_NA);\r\noffset += length_indicator_guint8;\r\n}\r\n}\r\nbreak;\r\ncase IDRP_PATH_ATTR_TYPE_NEXT_HOP:\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_next_hop_idrp_server,\r\ntvb,\r\noffset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nstart_offset = offset;\r\nwhile (offset < (start_offset + path_attr_len)) {\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_next_hop_proto_type,\r\ntvb,\r\noffset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nlength_indicator_guint8 = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_next_hop_proto,\r\ntvb,\r\noffset,\r\nlength_indicator_guint8,\r\nENC_ASCII | ENC_NA);\r\noffset += length_indicator_guint8;\r\nlength_indicator_guint8 = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_next_hop_rdi,\r\ntvb,\r\noffset,\r\nlength_indicator_guint8,\r\nENC_NA);\r\noffset += length_indicator_guint8;\r\nnb_of_snpa = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_next_hop_nb_snpa,\r\ntvb,\r\noffset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nfor (i = nb_of_snpa; i > 0; i--) {\r\nlength_indicator_guint8 =\r\n(tvb_get_guint8(tvb, offset) + 1) / 2;\r\noffset += 1;\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_next_hop_snpa,\r\ntvb,\r\noffset,\r\nlength_indicator_guint8 ,\r\nENC_NA);\r\noffset += length_indicator_guint8;\r\n}\r\n}\r\nbreak;\r\ncase IDRP_PATH_ATTR_TYPE_DIST_LIST_EXCL:\r\ndist_list_count = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_dist_list_excl_nb_rdi,\r\ntvb,\r\noffset,\r\n1 ,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nfor (i = dist_list_count; i > 0; i--) {\r\nlength_indicator_guint8 = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_dist_list_excl_rdi ,\r\ntvb,\r\noffset,\r\nlength_indicator_guint8 ,\r\nENC_NA);\r\noffset += length_indicator_guint8;\r\n}\r\nbreak;\r\ncase IDRP_PATH_ATTR_TYPE_DIST_LIST_INCL:\r\ndist_list_count = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_dist_list_incl_nb_rdi,\r\ntvb,\r\noffset,\r\n1 ,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nfor (i = dist_list_count; i > 0; i--) {\r\nlength_indicator_guint8 = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_dist_list_incl_rdi ,\r\ntvb,\r\noffset,\r\nlength_indicator_guint8 ,\r\nENC_NA);\r\noffset += length_indicator_guint8;\r\n}\r\nbreak;\r\ncase IDRP_PATH_ATTR_TYPE_MULTI_EXIT_DISC:\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_multi_exit_disc ,\r\ntvb,\r\noffset,\r\n1 ,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase IDRP_PATH_ATTR_TYPE_TRANSIT_DELAY:\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_transit_delay ,\r\ntvb,\r\noffset,\r\n2 ,\r\nENC_BIG_ENDIAN);\r\noffset += 2;\r\nbreak;\r\ncase IDRP_PATH_ATTR_TYPE_RESIDUAL_ERROR:\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_residual_error ,\r\ntvb,\r\noffset,\r\n4 ,\r\nENC_BIG_ENDIAN);\r\noffset += 4;\r\nbreak;\r\ncase IDRP_PATH_ATTR_TYPE_EXPENSE:\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_expense ,\r\ntvb,\r\noffset,\r\n2 ,\r\nENC_BIG_ENDIAN);\r\noffset += 2;\r\nbreak;\r\ncase IDRP_PATH_ATTR_TYPE_LOCALLY_DEFINED_QOS:\r\nlength_indicator_guint8 = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_locally_defined_qos_nsap ,\r\ntvb,\r\noffset,\r\nlength_indicator_guint8 ,\r\nENC_NA);\r\noffset += length_indicator_guint8;\r\nlength_indicator_guint8 = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_locally_defined_qos_value,\r\ntvb,\r\noffset,\r\nlength_indicator_guint8 ,\r\nENC_NA);\r\noffset += length_indicator_guint8;\r\nlength_indicator_guint8 = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_locally_defined_qos_metric,\r\ntvb,\r\noffset,\r\nlength_indicator_guint8 ,\r\nENC_NA);\r\noffset += length_indicator_guint8;\r\nbreak;\r\ncase IDRP_PATH_ATTR_TYPE_HIERARCHICALRECORDING:\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_hierarchicaldecoding,\r\ntvb,\r\noffset,\r\n1 ,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase IDRP_PATH_ATTR_TYPE_RD_HOP_COUNT:\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_rd_hop_count,\r\ntvb,\r\noffset,\r\n1 ,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase IDRP_PATH_ATTR_TYPE_SECURITY:\r\nlength_indicator_guint8 = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_security_reg_id,\r\ntvb,\r\noffset,\r\nlength_indicator_guint8 ,\r\nENC_NA);\r\noffset += length_indicator_guint8;\r\nlength_indicator_guint8 = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_security_info,\r\ntvb,\r\noffset,\r\nlength_indicator_guint8,\r\nENC_NA);\r\noffset += length_indicator_guint8;\r\nbreak;\r\ncase IDRP_PATH_ATTR_TYPE_CAPACITY:\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_capacity,\r\ntvb,\r\noffset,\r\n1 ,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase IDRP_PATH_ATTR_TYPE_PRIORITY:\r\nproto_tree_add_item(tree,\r\nhf_idrp_update_path_attr_priority,\r\ntvb,\r\noffset,\r\n1 ,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\nproto_tree_add_item(tree, hf_idrp_update_nlri_proto_type, tvb, offset,\r\n1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_len = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_idrp_update_nlri_proto_id, tvb, offset,\r\nproto_len, ENC_NA);\r\noffset += proto_len;\r\nnet_len = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_item(tree, hf_idrp_update_nlri_addr_length, tvb, offset,\r\n2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nstart_offset = offset;\r\nwhile (offset < (start_offset + net_len)) {\r\nrdi_len = tvb_get_guint8(tvb, offset) / 8;\r\nproto_tree_add_item(tree, hf_idrp_update_nlri_addr_info_nb_bits, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_idrp_update_nlri_addr_info, tvb,\r\noffset, rdi_len, ENC_NA);\r\noffset += rdi_len;\r\n}\r\nreturn offset;\r\n}\r\nstatic int dissect_BISPDU_ERROR(tvbuff_t * tvb, int offset, proto_tree * tree)\r\n{\r\nguint8 error_code = 0;\r\ngint data_length;\r\nerror_code = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_idrp_error_code, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nswitch (error_code) {\r\ncase IDRP_ERROR_OPEN:\r\nproto_tree_add_item(tree, hf_idrp_error_open_subcode, tvb, offset, 1,\r\nENC_BIG_ENDIAN);\r\nbreak;\r\ncase IDRP_ERROR_UPDATE:\r\nproto_tree_add_item(tree, hf_idrp_error_update_subcode, tvb, offset, 1,\r\nENC_BIG_ENDIAN);\r\nbreak;\r\ncase IDRP_ERROR_HOLD_TIMER:\r\nproto_tree_add_item(tree, hf_idrp_error_hold_timer_subcode, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase IDRP_ERROR_FSM:\r\nproto_tree_add_item(tree, hf_idrp_error_fsm_subcode, tvb, offset, 1,\r\nENC_BIG_ENDIAN);\r\nbreak;\r\ncase IDRP_ERROR_RIB_REFRESH:\r\nproto_tree_add_item(tree, hf_idrp_error_rib_refresh_subcode, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\noffset += 1;\r\ndata_length = tvb_reported_length_remaining(tvb, offset);\r\nif (data_length>0) {\r\nproto_tree_add_item(tree, hf_idrp_error_data, tvb, offset, data_length,\r\nENC_NA);\r\noffset += data_length;\r\n}\r\nreturn offset;\r\n}\r\nstatic int dissect_BISPDU_RIB_REFRESH(tvbuff_t * tvb, packet_info *pinfo, int offset, proto_tree * tree)\r\n{\r\nproto_tree *sub_tree;\r\nproto_item *sub_item;\r\nguint8 number_of_non_empty_rib_attributes;\r\nguint8 number_of_distinguishing_attributes;\r\nguint8 rib_attribute_type;\r\nguint8 length_indicator_guint8;\r\nint i;\r\nint j;\r\nproto_tree_add_item(tree, hf_idrp_rib_refresh_opcode, tvb, offset, 1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nsub_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_idrp_sub, &sub_item, "Path Attributes");\r\nnumber_of_non_empty_rib_attributes = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nif (!number_of_non_empty_rib_attributes)\r\nexpert_add_info(pinfo, sub_item, &ei_idrp_no_path_attributes);\r\nfor (i = number_of_non_empty_rib_attributes; i > 0; i--) {\r\nnumber_of_distinguishing_attributes = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nfor (j = number_of_distinguishing_attributes; j > 0; j--) {\r\nrib_attribute_type = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nswitch (rib_attribute_type) {\r\ncase IDRP_PATH_ATTR_TYPE_ROUTE_SEPARATOR:\r\ncase IDRP_PATH_ATTR_TYPE_EXT_INFO:\r\ncase IDRP_PATH_ATTR_TYPE_RD_PATH:\r\ncase IDRP_PATH_ATTR_TYPE_NEXT_HOP:\r\ncase IDRP_PATH_ATTR_TYPE_DIST_LIST_EXCL:\r\ncase IDRP_PATH_ATTR_TYPE_DIST_LIST_INCL:\r\ncase IDRP_PATH_ATTR_TYPE_MULTI_EXIT_DISC:\r\ncase IDRP_PATH_ATTR_TYPE_RESIDUAL_ERROR:\r\ncase IDRP_PATH_ATTR_TYPE_EXPENSE:\r\ncase IDRP_PATH_ATTR_TYPE_HIERARCHICALRECORDING:\r\ncase IDRP_PATH_ATTR_TYPE_RD_HOP_COUNT:\r\ncase IDRP_PATH_ATTR_TYPE_CAPACITY:\r\ncase IDRP_PATH_ATTR_TYPE_PRIORITY:\r\nbreak;\r\ncase IDRP_PATH_ATTR_TYPE_LOCALLY_DEFINED_QOS:\r\nlength_indicator_guint8 = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(\r\nsub_tree,\r\nhf_idrp_rib_refresh_rib_attr_locally_defined_qos_nsap,\r\ntvb,\r\noffset,\r\nlength_indicator_guint8,\r\nENC_NA);\r\noffset += length_indicator_guint8;\r\nlength_indicator_guint8 = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(\r\nsub_tree,\r\nhf_idrp_rib_refresh_rib_attr_locally_defined_qos_value,\r\ntvb,\r\noffset,\r\nlength_indicator_guint8,\r\nENC_NA);\r\noffset += length_indicator_guint8;\r\nlength_indicator_guint8 = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(\r\nsub_tree,\r\nhf_idrp_rib_refresh_rib_attr_locally_defined_qos_metric,\r\ntvb,\r\noffset,\r\nlength_indicator_guint8,\r\nENC_NA);\r\noffset += length_indicator_guint8;\r\nbreak;\r\ncase IDRP_PATH_ATTR_TYPE_SECURITY:\r\noffset += 2;\r\nlength_indicator_guint8 = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(\r\nsub_tree,\r\nhf_idrp_rib_refresh_rib_attr_security_reg_id,\r\ntvb,\r\noffset,\r\nlength_indicator_guint8,\r\nENC_NA);\r\noffset += length_indicator_guint8;\r\nlength_indicator_guint8 = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(\r\nsub_tree,\r\nhf_idrp_rib_refresh_rib_attr_security_info,\r\ntvb,\r\noffset,\r\nlength_indicator_guint8,\r\nENC_NA);\r\noffset += length_indicator_guint8;\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_idrp(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data _U_)\r\n{\r\nproto_item *ti;\r\nproto_tree *idrp_tree;\r\nguint8 pdu_type;\r\ngint offset = 0;\r\nif (tvb_get_guint8(tvb, offset) != NLPID_ISO10747_IDRP)\r\nreturn 0;\r\noffset += 1;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "IDRP");\r\ncol_clear(pinfo->cinfo, COL_INFO);\r\nti = proto_tree_add_item(tree, proto_idrp, tvb, 0, -1, ENC_NA);\r\nidrp_tree = proto_item_add_subtree(ti, ett_idrp);\r\nproto_tree_add_item(idrp_tree, hf_idrp_li,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\npdu_type = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(idrp_tree, hf_idrp_type,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(idrp_tree, hf_idrp_sequence,\r\ntvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(idrp_tree, hf_idrp_ack,\r\ntvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(idrp_tree, hf_idrp_credit_offered,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(idrp_tree, hf_idrp_credit_avail,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(idrp_tree, hf_idrp_validation_pattern,\r\ntvb, offset, 16, ENC_NA);\r\noffset += 16;\r\nswitch (pdu_type) {\r\ncase IDRP_TYPE_OPEN:\r\noffset = dissect_BISPDU_OPEN(tvb, offset, idrp_tree);\r\nbreak;\r\ncase IDRP_TYPE_UPDATE:\r\noffset = dissect_BISPDU_UPDATE(tvb, offset, idrp_tree);\r\nbreak;\r\ncase IDRP_TYPE_ERROR:\r\noffset = dissect_BISPDU_ERROR(tvb, offset, idrp_tree);\r\nbreak;\r\ncase IDRP_TYPE_KEEPALIVE:\r\noffset += 30;\r\nbreak;\r\ncase IDRP_TYPE_CEASE:\r\noffset += 30;\r\nbreak;\r\ncase IDRP_TYPE_RIB_REFRESH:\r\noffset = dissect_BISPDU_RIB_REFRESH(tvb, pinfo, offset, idrp_tree);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s",\r\nval_to_str(pdu_type, idrp_pdu_types, "Unknown (%u)"));\r\nreturn offset;\r\n}\r\nvoid proto_register_idrp(void)\r\n{\r\nstatic hf_register_info hf_idrp[] = {\r\n{&hf_idrp_li,\r\n{"BISPDU Length", "idrp.li", FT_UINT16, BASE_DEC, NULL, 0x0,\r\n"BISPDU Length Indicator, length of this PDU", HFILL}},\r\n{&hf_idrp_type,\r\n{"BISPDU Type", "idrp.type", FT_UINT8, BASE_DEC,\r\nVALS(idrp_pdu_types), 0xff, NULL, HFILL}},\r\n{&hf_idrp_sequence,\r\n{"Sequence Number", "idrp.seq", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Sequence number, Sequence number of current BISPDU ", HFILL}},\r\n{&hf_idrp_ack,\r\n{"Acknowledgment number", "idrp.ack", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Acknowledgment number, Sequence number of the PDU that the sender last received correctly and in sequence number order",\r\nHFILL}},\r\n{&hf_idrp_credit_offered,\r\n{"Credits Offered", "idrp.credits-offered", FT_UINT8, BASE_DEC,\r\nNULL, 0,\r\n"Number of additional BISPDUs that the sender is willing to accept from the remote BIS",\r\nHFILL}},\r\n{&hf_idrp_credit_avail,\r\n{"Credits Available", "idrp.credits-avail", FT_UINT8, BASE_DEC,\r\nNULL, 0,\r\n"Number of additional BISPDUs that the sender is able to send to the remote BIS",\r\nHFILL}},\r\n{&hf_idrp_validation_pattern,\r\n{"Validation", "idrp.validation", FT_BYTES, BASE_NONE,\r\nNULL, 0,\r\n"16-octet field which provides a validation function for the BISPDU",\r\nHFILL}},\r\n{&hf_idrp_open_version,\r\n{"Version", "idrp.open.version", FT_UINT8, BASE_DEC,\r\nNULL, 0, "Version number of the protocol.", HFILL}},\r\n{&hf_idrp_open_hold_time,\r\n{"Hold Time", "idrp.open.hold-time", FT_UINT16, BASE_DEC,\r\nNULL, 0, "Max number of seconds to remain in the ESTABLISHED state",\r\nHFILL}},\r\n{&hf_idrp_open_max_pdu_size,\r\n{"Max PDU Size", "idrp.open.max-pdu-size", FT_UINT16, BASE_DEC,\r\nNULL, 0,\r\n"Maximum number of octets that this BIS will accept in an incoming UPDATE PDU, IDRP ERROR PDU, or RIB REFRESH PDU",\r\nHFILL}},\r\n{&hf_idrp_open_src_rdi,\r\n{"Source RDI", "idrp.open.src-rdi", FT_BYTES, BASE_NONE,\r\nNULL, 0,\r\n"RDI of the routing domain in which the BIS that is sending this BISPDU is located",\r\nHFILL}},\r\n{&hf_idrp_open_rib_attr_locally_defined_qos_nsap,\r\n{"Rib Attribute Value Locally Defined Qos NSAP",\r\n"idrp.open.rib-attr.locally-defined-qos.nsap", FT_BYTES, BASE_NONE,\r\nNULL, 0, "Locally Defined Qos NSAP" ,\r\nHFILL}},\r\n{&hf_idrp_open_rib_attr_locally_defined_qos_value,\r\n{"Rib Attribute Value Locally Defined Qos",\r\n"idrp.open.rib-attr.locally-defined-qos.qos", FT_BYTES, BASE_NONE,\r\nNULL, 0, "Locally Defined Qos Value" ,\r\nHFILL}},\r\n{&hf_idrp_open_rib_attr_locally_defined_qos_metric,\r\n{"Rib Attribute Value Locally Defined Qos Metric",\r\n"idrp.open.rib-attr.locally-defined-qos.metric", FT_BYTES, BASE_NONE,\r\nNULL, 0, "Locally Defined Metric" ,\r\nHFILL}},\r\n{&hf_idrp_open_rib_attr_security_reg_id,\r\n{"Rib Attribute Value Security Registration ID",\r\n"idrp.open.rib-attr.security.reg-id", FT_BYTES, BASE_NONE,\r\nNULL, 0, "Identifies the Security Authority" ,\r\nHFILL}},\r\n{&hf_idrp_open_rib_attr_security_info,\r\n{"Rib Attribute Value Security Registration ID",\r\n"idrp.open.rib-attr.security.info", FT_BYTES, BASE_NONE,\r\nNULL, 0, "Additional security related information" ,\r\nHFILL}},\r\n{&hf_idrp_open_number_of_confederations,\r\n{"Number of Routing Confederations",\r\n"idrp.open.number-of-confederations", FT_UINT8, BASE_DEC,\r\nNULL, 0,\r\n"Number of Routing Domain Identifiers (Routing Domain Confederation) that this BIS is a member of",\r\nHFILL}},\r\n{&hf_idrp_open_confederation,\r\n{"Routing Confederation", "idrp.open.confederation", FT_BYTES,\r\nBASE_NONE,\r\nNULL, 0,\r\n"Routing Domain Identifier of Routing Domain Confederation that this BIS is a member of",\r\nHFILL}},\r\n{&hf_idrp_open_authentication_code,\r\n{"Authentication Code", "idrp.open.authentication-code", FT_UINT8,\r\nBASE_DEC,\r\nVALS(idrp_pdu_open_authentication_codes), 0,\r\n"Indicates the authentication mechanism being used",\r\nHFILL}},\r\n{&hf_idrp_open_authentication_data,\r\n{"Authentication Data", "idrp.open.authentication-data", FT_BYTES,\r\nBASE_NONE,\r\nNULL, 0, "Datat used for optional authentication of a peer BIS", HFILL}},\r\n{&hf_idrp_update_number_of_unfeasible_routes,\r\n{"Number of Unfeasible Routes",\r\n"idrp.update.number-of-unfeasible-routes", FT_UINT16, BASE_DEC,\r\nNULL, 0,\r\n"Number of RDIs that are included in the subsequent withdrawn routes field",\r\nHFILL}},\r\n{&hf_idrp_update_withdrawn_route,\r\n{"Unfeasible Route", "idrp.update.unfeasible-route", FT_UINT32,\r\nBASE_DEC,\r\nNULL, 0,\r\n"Route-ID for the route that id being withdrawn from service",\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_flag,\r\n{"Path Attribute Flag", "idrp.update.path-attribute-flag", FT_UINT8,\r\nBASE_HEX,\r\nVALS(idrp_path_attr_flags), 0, NULL, HFILL}},\r\n{&hf_idrp_update_path_attr_type,\r\n{"Path Attribute Type", "idrp.update.path-attribute-type", FT_UINT8,\r\nBASE_DEC,\r\nVALS(path_attr_types), 0, NULL, HFILL}},\r\n{&hf_idrp_update_path_attr_length,\r\n{"Path Attribute Length", "idrp.update.path-attribute-length", FT_UINT16,\r\nBASE_DEC,\r\nNULL, 0, NULL, HFILL}},\r\n{&hf_idrp_update_path_attr_route_separator_id,\r\n{"Path Attribute Value Route Separator Id",\r\n"idrp.update.path-attr.route-separator.id", FT_UINT32, BASE_DEC,\r\nNULL, 0,",Route identifier for the advertised route",\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_route_separator_localpref,\r\n{"Path Attribute Value Route Separator Local Pref",\r\n"idrp.update.path-attr.route-separator.local-pref", FT_UINT8, BASE_DEC,\r\nNULL, 0,"Contains the local preference value for route",\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_ext_info,\r\n{"Path Attribute Value External Info",\r\n"idrp.update.path-attr.ext-info", FT_BOOLEAN, 8,\r\nNULL, 0,"Flag indicates if routes have been discovered by means of IDRP",\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_rd_path_type,\r\n{"Path Attribute Value RD Path Segment Type",\r\n"idrp.update.path-attr.rd-path.segment-type", FT_UINT8, BASE_HEX,\r\nVALS(path_rd_segment_types), 0, NULL,\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_rd_path_segment_length,\r\n{"Path Attribute Value RD Path Segment Length",\r\n"idrp.update.path-attr.rd-path.segment-length", FT_UINT16, BASE_DEC,\r\nNULL, 0, NULL,\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_rd_path_rdi,\r\n{"Path Attribute Value RD Path Segment RDI",\r\n"idrp.update.path-attr.rd-path.segment-rdi", FT_BYTES, BASE_NONE,\r\nNULL, 0,"RD Path Segment Routing Identifier or Confederation" ,\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_next_hop_idrp_server,\r\n{"Path Attribute Value Next Hop Idrp Server",\r\n"idrp.update.path-attr.next-hop.idrp-server", FT_UINT8, BASE_DEC,\r\nNULL, 0, "Permit a BIS to advertise a different or local BISs NET" ,\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_next_hop_proto_type,\r\n{"Path Attribute Value Next Hop Segment Protocol Type",\r\n"idrp.update.path-attr.next-hop.segment-protp-type", FT_UINT8, BASE_DEC,\r\nVALS(idrp_proto_type), 0, NULL ,\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_next_hop_proto,\r\n{"Path Attribute Value Next Hop Segment Protocol",\r\n"idrp.update.path-attr.next-hop.segment-proto", FT_UINT8, BASE_DEC,\r\nNULL, 0, NULL ,\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_next_hop_rdi,\r\n{"Path Attribute Value Next Hop RDI",\r\n"idrp.update.path-attr.next-hop.rdi", FT_BYTES, BASE_NONE,\r\nNULL, 0, "NET to advertise as next hop segment" ,\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_next_hop_nb_snpa,\r\n{"Path Attribute Value Next Hop Number of SNPA",\r\n"idrp.update.path-attr.next-hop.number-snpa", FT_UINT8, BASE_DEC,\r\nNULL, 0, "Number of SNPA's on next hop segment" ,\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_next_hop_snpa,\r\n{"Path Attribute Value Next Hop SNPA",\r\n"idrp.update.path-attr.next-hop.snpa", FT_BYTES, BASE_NONE,\r\nNULL, 0, "SNPA on next hop segment" ,\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_dist_list_incl_nb_rdi,\r\n{"Path Attribute Value Dist List Incl Number of RDIs",\r\n"idrp.update.path-attr.dist-list-incl.number-rdi", FT_UINT8, BASE_DEC,\r\nNULL, 0, "Number of RDIs which NLRI information may be distributed" ,\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_dist_list_incl_rdi,\r\n{"Path Attribute Value Dist List Incl RDI",\r\n"idrp.update.path-attr.dist-list-incl.rdi", FT_BYTES, BASE_NONE,\r\nNULL, 0, "RDI which NLRI information may be distributed" ,\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_dist_list_excl_nb_rdi,\r\n{"Path Attribute Value Dist List Excl Number of RDIs",\r\n"idrp.update.path-attr.dist-list-excl.number-rdi", FT_UINT8, BASE_DEC,\r\nNULL, 0, "Number of RDIs which NLRI information may not be distributed" ,\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_dist_list_excl_rdi,\r\n{"Path Attribute Value Dist List Excl RDI",\r\n"idrp.update.path-attr.dist-list-excl.rdi", FT_BYTES, BASE_NONE,\r\nNULL, 0, "RDI which NLRI information may be distributed" ,\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_multi_exit_disc,\r\n{"Path Attribute Value Multi Exit Disc",\r\n"idrp.update.path-attr.multi-exit-disc", FT_UINT8, BASE_DEC,\r\nNULL, 0, "Number of exit points to an adjacent domain" ,\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_transit_delay,\r\n{"Path Attribute Value Transit Delay",\r\n"idrp.update.path-attr.transit-delay", FT_UINT16, BASE_DEC,\r\nNULL, 0, "Transit Delay" ,\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_residual_error,\r\n{"Path Attribute Value Residual Error",\r\n"idrp.update.path-attr.residual-error", FT_UINT32, BASE_DEC,\r\nNULL, 0, "Residual error probability to destination" ,\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_expense,\r\n{"Path Attribute Value Expense",\r\n"idrp.update.path-attr.expense", FT_UINT16, BASE_DEC,\r\nNULL, 0, "Expense to destination" ,\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_locally_defined_qos_nsap,\r\n{"Path Attribute Value Locally Defined Qos NSAP",\r\n"idrp.update.path-attr.locally-defined-qos.nsap", FT_BYTES, BASE_NONE,\r\nNULL, 0, "Locally Defined Qos NSAP" ,\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_locally_defined_qos_value,\r\n{"Path Attribute Value Locally Defined Qos",\r\n"idrp.update.path-attr.locally-defined-qos.qos", FT_BYTES, BASE_NONE,\r\nNULL, 0, "Locally Defined Qos Value" ,\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_locally_defined_qos_metric,\r\n{"Path Attribute Value Locally Defined Qos Metric",\r\n"idrp.update.path-attr.locally-defined-qos.metric", FT_BYTES, BASE_NONE,\r\nNULL, 0, "Locally Defined Metric" ,\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_hierarchicaldecoding,\r\n{"Path Attribute Value Hierarchical Decoding",\r\n"idrp.update.path-attr.hierarchical-decoding", FT_UINT8, BASE_HEX,\r\nNULL, 0, "Controls the transitivity of NPDUs through the confederation" ,\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_rd_hop_count,\r\n{"Path Attribute Value RD Hop Count",\r\n"idrp.update.path-attr.rd-hop-count", FT_UINT8, BASE_DEC,\r\nNULL, 0, "Maximum Hop Count for this Routing Information to travel" ,\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_security_reg_id,\r\n{"Path Attribute Value Security Registration ID",\r\n"idrp.update.path-attr.security.reg-id", FT_BYTES, BASE_NONE,\r\nNULL, 0, "Identifies the Security Authority" ,\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_security_info,\r\n{"Path Attribute Value Security Registration ID",\r\n"idrp.update.path-attr.security.info", FT_BYTES, BASE_NONE,\r\nNULL, 0, "Additional security related information" ,\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_capacity,\r\n{"Path Attribute Value Capacity",\r\n"idrp.update.path-attr.capacity", FT_UINT8, BASE_DEC,\r\nNULL, 0, "Capacity of the RD_PATH for handling traffic" ,\r\nHFILL}},\r\n{&hf_idrp_update_path_attr_priority,\r\n{"Path Attribute Value Capacity",\r\n"idrp.update.path-attr.capacity", FT_UINT8, BASE_DEC,\r\nNULL, 0, "Capacity of the RD_PATH for handling traffic" ,\r\nHFILL}},\r\n{&hf_idrp_update_nlri_proto_type,\r\n{"NLRI Protocol Type", "idrp.update.nlri.proto-type", FT_UINT8,\r\nBASE_DEC,\r\nVALS(idrp_proto_type), 0, NULL, HFILL}},\r\n{&hf_idrp_update_nlri_proto_id,\r\n{"NLRI Protocol Identity", "idrp.update.nlri.proto-id", FT_BYTES,\r\nBASE_NONE,\r\nNULL, 0,\r\n"Identity of the protocol associated with the NLRI address information",\r\nHFILL}},\r\n{&hf_idrp_update_nlri_addr_length,\r\n{"NLRI Address Length",\r\n"idrp.update.nlri.addr-length.", FT_UINT16, BASE_DEC,\r\nNULL, 0, NULL ,\r\nHFILL}},\r\n{&hf_idrp_update_nlri_addr_info_nb_bits,\r\n{"NLRI Address Info Bits",\r\n"idrp.update.nlri.addr-info-bits.", FT_UINT8, BASE_DEC,\r\nNULL, 0, NULL ,\r\nHFILL}},\r\n{&hf_idrp_update_nlri_addr_info,\r\n{"NLRI Address Info", "idrp.update.nlri.addr-info", FT_BYTES,\r\nBASE_NONE,\r\nNULL, 0, "Network Layer Reachability Information Protocol", HFILL}},\r\n{&hf_idrp_error_code,\r\n{"Error Code", "idrp.error.code", FT_UINT8, BASE_DEC,\r\nVALS(idrp_error_codes), 0,\r\nNULL, HFILL}},\r\n{&hf_idrp_error_open_subcode,\r\n{"Error Subcode (Open Message)", "idrp.error.subcode", FT_UINT8,\r\nBASE_DEC, VALS(idrp_error_open_subcodes),\r\n0, NULL, HFILL}},\r\n{&hf_idrp_error_update_subcode,\r\n{"Error Subcode (Update Message)", "idrp.error.subcode", FT_UINT8,\r\nBASE_DEC, VALS(idrp_error_update_subcodes),\r\n0, NULL, HFILL}},\r\n{&hf_idrp_error_hold_timer_subcode,\r\n{"Error Subcode (Hold Timer)", "idrp.error.subcode", FT_UINT8,\r\nBASE_DEC, VALS(idrp_error_hold_timer_subcodes),\r\n0, NULL, HFILL}},\r\n{&hf_idrp_error_fsm_subcode,\r\n{"Error Subcode (Fsm State)", "idrp.error.subcode", FT_UINT8,\r\nBASE_DEC, VALS(idrp_error_fsm_subcodes),\r\n0, NULL, HFILL}},\r\n{&hf_idrp_error_rib_refresh_subcode,\r\n{"Error Subcode (Rib-Refresh Message)", "idrp.error.subcode",\r\nFT_UINT8, BASE_DEC, VALS(idrp_error_rib_refresh_subcodes),\r\n0xff, NULL, HFILL}},\r\n{&hf_idrp_error_data,\r\n{"Error Data", "idrp.error.data", FT_BYTES, BASE_NONE, NULL, 0,\r\n"Diagnosis data that depends upon the error code and error subcode",\r\nHFILL}},\r\n{&hf_idrp_rib_refresh_opcode,\r\n{"Rib Refresh opcode", "idrp.rib-refresh.opcode", FT_UINT8, BASE_DEC,\r\nVALS(idrp_error_rib_refresh_subcodes),\r\n0xff, NULL, HFILL}},\r\n{&hf_idrp_rib_refresh_rib_attr_locally_defined_qos_nsap,\r\n{"Rib Attribute Value Locally Defined Qos NSAP",\r\n"idrp.rib-refresh.rib-attr.locally-defined-qos.nsap",\r\nFT_BYTES, BASE_NONE,\r\nNULL, 0, "Locally Defined Qos NSAP" ,\r\nHFILL}},\r\n{&hf_idrp_rib_refresh_rib_attr_locally_defined_qos_value,\r\n{"Rib Attribute Value Locally Defined Qos",\r\n"idrp.rib-refresh.rib-attr.locally-defined-qos.qos",\r\nFT_BYTES, BASE_NONE,\r\nNULL, 0, "Locally Defined Qos Value" ,\r\nHFILL}},\r\n{&hf_idrp_rib_refresh_rib_attr_locally_defined_qos_metric,\r\n{"Rib Attribute Value Locally Defined Qos Metric",\r\n"idrp.rib-refresh.rib-attr.locally-defined-qos.metric",\r\nFT_BYTES, BASE_NONE,\r\nNULL, 0, "Locally Defined Metric" ,\r\nHFILL}},\r\n{&hf_idrp_rib_refresh_rib_attr_security_reg_id,\r\n{"Rib Attribute Value Security Registration ID",\r\n"idrp.rib-refresh.rib-attr.security.reg-id", FT_BYTES, BASE_NONE,\r\nNULL, 0, "Identifies the Security Authority" ,\r\nHFILL}},\r\n{&hf_idrp_rib_refresh_rib_attr_security_info,\r\n{"Rib Attribute Value Security Registration ID",\r\n"idrp.rib-refresh.rib-attr.security.info", FT_BYTES, BASE_NONE,\r\nNULL, 0, "Additional security related information" ,\r\nHFILL}},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_idrp,\r\n&ett_idrp_sub\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_idrp_no_path_attributes, { "idrp.no_path_attributes", PI_PROTOCOL, PI_NOTE, "No path attributes", EXPFILL }},\r\n};\r\nexpert_module_t* expert_idrp;\r\nproto_idrp = proto_register_protocol(IDRP_PROTO, "IDRP", "idrp");\r\nproto_register_field_array(proto_idrp, hf_idrp, array_length(hf_idrp));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_idrp = expert_register_protocol(proto_idrp);\r\nexpert_register_field_array(expert_idrp, ei, array_length(ei));\r\nregister_dissector("idrp", dissect_idrp, proto_idrp);\r\n}
