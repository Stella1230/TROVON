static inline ctrl_ref_vals\r\nget_ctrl_ref_vals(guint16 ctrl_val_type)\r\n{\r\nctrl_ref_vals ret;\r\nswitch(ctrl_val_type) {\r\ncase AEM_CONTROL_LINEAR_INT8:\r\ncase AEM_CONTROL_SELECTOR_INT8:\r\ncase AEM_CONTROL_ARRAY_INT8:\r\nret.hf = hf_aem_ctrl_int8;\r\nret.size = 1;\r\nbreak;\r\ncase AEM_CONTROL_LINEAR_UINT8:\r\ncase AEM_CONTROL_SELECTOR_UINT8:\r\ncase AEM_CONTROL_ARRAY_UINT8:\r\nret.hf = hf_aem_ctrl_uint8;\r\nret.size = 1;\r\nbreak;\r\ncase AEM_CONTROL_LINEAR_INT16:\r\ncase AEM_CONTROL_SELECTOR_INT16:\r\ncase AEM_CONTROL_ARRAY_INT16:\r\nret.hf = hf_aem_ctrl_int16;\r\nret.size = 2;\r\nbreak;\r\ncase AEM_CONTROL_LINEAR_UINT16:\r\ncase AEM_CONTROL_SELECTOR_UINT16:\r\ncase AEM_CONTROL_ARRAY_UINT16:\r\nret.hf = hf_aem_ctrl_uint16;\r\nret.size = 2;\r\nbreak;\r\ncase AEM_CONTROL_LINEAR_INT32:\r\ncase AEM_CONTROL_SELECTOR_INT32:\r\ncase AEM_CONTROL_ARRAY_INT32:\r\nret.hf = hf_aem_ctrl_int32;\r\nret.size = 4;\r\nbreak;\r\ncase AEM_CONTROL_LINEAR_UINT32:\r\ncase AEM_CONTROL_SELECTOR_UINT32:\r\ncase AEM_CONTROL_ARRAY_UINT32:\r\nret.hf = hf_aem_ctrl_uint32;\r\nret.size = 4;\r\nbreak;\r\ncase AEM_CONTROL_LINEAR_FLOAT:\r\ncase AEM_CONTROL_SELECTOR_FLOAT:\r\ncase AEM_CONTROL_ARRAY_FLOAT:\r\nret.hf = hf_aem_ctrl_float;\r\nret.size = 4;\r\nbreak;\r\ncase AEM_CONTROL_LINEAR_INT64:\r\ncase AEM_CONTROL_SELECTOR_INT64:\r\ncase AEM_CONTROL_ARRAY_INT64:\r\nret.hf = hf_aem_ctrl_int64;\r\nret.size = 8;\r\nbreak;\r\ncase AEM_CONTROL_LINEAR_UINT64:\r\ncase AEM_CONTROL_SELECTOR_UINT64:\r\ncase AEM_CONTROL_ARRAY_UINT64:\r\nret.hf = hf_aem_ctrl_uint64;\r\nret.size = 8;\r\nbreak;\r\ncase AEM_CONTROL_LINEAR_DOUBLE:\r\ncase AEM_CONTROL_SELECTOR_DOUBLE:\r\ncase AEM_CONTROL_ARRAY_DOUBLE:\r\nret.hf = hf_aem_ctrl_double;\r\nret.size = 8;\r\nbreak;\r\ncase AEM_CONTROL_BODE_PLOT:\r\nret.hf = -1;\r\nret.size = 12;\r\nbreak;\r\ndefault:\r\nret.size = 0;\r\nret.hf = -1;\r\nbreak;\r\n}\r\nreturn ret;\r\n}\r\nstatic void\r\ndissect_17221_stream_format(tvbuff_t *tvb, proto_tree *tree)\r\n{\r\nproto_item *stream_tree;\r\nproto_item *stream_ti;\r\nguint8 version;\r\nguint8 subtype;\r\nguint8 sf;\r\nguint8 fmt;\r\nguint8 fdf_evt;\r\nstream_ti = proto_tree_add_item(tree, hf_aem_stream_format, tvb,\r\n0, 8, ENC_NA);\r\nstream_tree = proto_item_add_subtree(stream_ti, ett_aem_stream_format);\r\nversion = tvb_get_guint8(tvb, 0) & AEM_MASK_SF_VERSION;\r\nproto_tree_add_item(stream_tree, hf_aem_sf_version, tvb,\r\nAEM_OFFSET_SF_VERSION, 1, ENC_BIG_ENDIAN);\r\nif (version == 0) {\r\nsubtype = tvb_get_guint8(tvb, AEM_OFFSET_SF_SUBTYPE) & AEM_MASK_SF_SUBTYPE;\r\nproto_tree_add_item(stream_tree, hf_aem_sf_subtype, tvb,\r\nAEM_OFFSET_SF_SUBTYPE, 1, ENC_BIG_ENDIAN);\r\nswitch(subtype) {\r\ncase IEC_61883_IIDC_SUBTYPE:\r\nsf = tvb_get_guint8(tvb, 1) & AEM_MASK_SF;\r\nproto_tree_add_item(stream_tree, hf_aem_sf, tvb,\r\nAEM_OFFSET_SF, 1, ENC_BIG_ENDIAN);\r\nif (sf == 0) {\r\nproto_tree_add_item(stream_tree, hf_aem_iidc_format, tvb,\r\nAEM_OFFSET_IIDC_FORMAT, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(stream_tree, hf_aem_iidc_mode, tvb,\r\nAEM_OFFSET_IIDC_MODE, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(stream_tree, hf_aem_iidc_rate, tvb,\r\nAEM_OFFSET_IIDC_RATE, 1, ENC_BIG_ENDIAN);\r\n} else {\r\nproto_tree_add_item(stream_tree, hf_aem_fmt, tvb,\r\nAEM_OFFSET_FMT, 1, ENC_BIG_ENDIAN);\r\nfmt = tvb_get_guint8(tvb, AEM_OFFSET_FMT) & 0x7F;\r\nif (fmt == 0x20) {\r\nproto_tree_add_item(stream_tree, hf_aem_fdf_evt, tvb,\r\nAEM_OFFSET_FDF_EVT, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(stream_tree, hf_aem_fdf_sfc, tvb,\r\nAEM_OFFSET_FDF_SFC, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(stream_tree, hf_aem_dbs, tvb,\r\nAEM_OFFSET_DBS, 1, ENC_BIG_ENDIAN);\r\nfdf_evt = tvb_get_guint8(tvb, AEM_OFFSET_FDF_EVT) & AEM_MASK_FDF_EVT;\r\nproto_tree_add_item(stream_tree, hf_aem_b_flag, tvb,\r\nAEM_OFFSET_B, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(stream_tree, hf_aem_nb_flag, tvb,\r\nAEM_OFFSET_NB, 1, ENC_BIG_ENDIAN);\r\nif (fdf_evt == 0x00) {\r\nproto_tree_add_item(stream_tree, hf_aem_label_iec_60958_cnt, tvb,\r\nAEM_OFFSET_LABEL_IEC_60958_CNT, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(stream_tree, hf_aem_label_mbla_cnt, tvb,\r\nAEM_OFFSET_LABEL_MBLA_CNT, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(stream_tree, hf_aem_label_midi_cnt, tvb,\r\nAEM_OFFSET_LABEL_MIDI_CNT, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(stream_tree, hf_aem_label_smpte_cnt, tvb,\r\nAEM_OFFSET_LABEL_SMPTE_CNT, 1, ENC_BIG_ENDIAN);\r\n}\r\n} else if (fmt == 0x01) {\r\nproto_tree_add_item(stream_tree, hf_aem_video_mode, tvb,\r\nAEM_OFFSET_VIDEO_MODE, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(stream_tree, hf_aem_compress_mode, tvb,\r\nAEM_OFFSET_COMPRESS_MODE, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(stream_tree, hf_aem_color_space, tvb,\r\nAEM_OFFSET_COLOR_SPACE, 1, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nbreak;\r\ncase MMA_SUBTYPE:\r\nbreak;\r\ncase AVTP_AUDIO_SUBTYPE:\r\nbreak;\r\ncase AVTP_VIDEO_SUBTYPE:\r\nbreak;\r\ncase EXPERIMENTAL_SUBTYPE:\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\n}\r\nstatic void\r\ndissect_17221_video_format(tvbuff_t *tvb, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_aecp_video_format, tvb,\r\n0, 4, ENC_NA);\r\n}\r\nstatic void\r\ndissect_17221_video_aspect_ratio(tvbuff_t *tvb, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_aecp_video_format, tvb,\r\n0, 2, ENC_NA);\r\n}\r\nstatic void\r\ndissect_17221_video_frame_size(tvbuff_t *tvb, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_aecp_video_format, tvb,\r\n0, 4, ENC_NA);\r\n}\r\nstatic void\r\ndissect_17221_sensor_format(tvbuff_t *tvb, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_aecp_video_format, tvb,\r\n0, 8, ENC_NA);\r\n}\r\nstatic void\r\ndissect_17221_ctrl_val(tvbuff_t *tvb, proto_tree *tree, guint16 num_ctrl_vals, guint16 ctrl_val_type,\r\nguint16 ctrl_offset)\r\n{\r\nproto_item *ctrl_item;\r\nproto_item *ctrl_subtree;\r\nint i;\r\nguint32 bin_blob_size;\r\ngint string_length;\r\nctrl_ref_vals ref;\r\nctrl_item = proto_tree_add_item(tree, hf_aem_ctrl_vals, tvb,\r\n0, 0, ENC_NA);\r\nctrl_subtree = proto_item_add_subtree(ctrl_item, ett_aem_ctrl_vals);\r\nref = get_ctrl_ref_vals(ctrl_val_type);\r\nif (ctrl_val_type < 0xa) {\r\nfor(i = 0; i < num_ctrl_vals; ++i) {\r\nproto_tree_add_item(ctrl_subtree, ref.hf, tvb,\r\nctrl_offset, ref.size, ENC_BIG_ENDIAN);\r\nctrl_offset += ref.size;\r\nproto_tree_add_item(ctrl_subtree, ref.hf, tvb,\r\nctrl_offset, ref.size, ENC_BIG_ENDIAN);\r\nctrl_offset += ref.size;\r\nproto_tree_add_item(ctrl_subtree, ref.hf, tvb,\r\nctrl_offset, ref.size, ENC_BIG_ENDIAN);\r\nctrl_offset += ref.size;\r\nproto_tree_add_item(ctrl_subtree, ref.hf, tvb,\r\nctrl_offset, ref.size, ENC_BIG_ENDIAN);\r\nctrl_offset += ref.size;\r\nproto_tree_add_item(ctrl_subtree, ref.hf, tvb,\r\nctrl_offset, ref.size, ENC_BIG_ENDIAN);\r\nctrl_offset += ref.size;\r\nproto_tree_add_item(ctrl_subtree, hf_aem_unit, tvb,\r\nctrl_offset, 2, ENC_BIG_ENDIAN);\r\nctrl_offset += 2;\r\nproto_tree_add_item(ctrl_subtree, hf_aem_string_ref, tvb,\r\nctrl_offset, 2, ENC_BIG_ENDIAN);\r\nctrl_offset += 2;\r\n}\r\n} else if (ctrl_val_type > 0x9 && ctrl_val_type < 0x14) {\r\nproto_tree_add_item(ctrl_subtree, ref.hf, tvb,\r\nctrl_offset, ref.size, ENC_BIG_ENDIAN);\r\nctrl_offset += 2;\r\nproto_tree_add_item(ctrl_subtree, ref.hf, tvb,\r\nctrl_offset, ref.size, ENC_BIG_ENDIAN);\r\nctrl_offset += 2;\r\nfor(i = 0; i < num_ctrl_vals; ++i) {\r\nproto_tree_add_item(ctrl_subtree, ref.hf, tvb,\r\nctrl_offset, ref.size, ENC_BIG_ENDIAN);\r\nctrl_offset += 2;\r\n}\r\nproto_tree_add_item(ctrl_subtree, hf_aem_unit, tvb,\r\nctrl_offset, 2, ENC_BIG_ENDIAN);\r\n} else if (ctrl_val_type == 0x14) {\r\ntvb_get_const_stringz(tvb, ctrl_offset, &string_length);\r\nproto_tree_add_item(ctrl_subtree, hf_aem_string, tvb,\r\nctrl_offset, string_length, ENC_ASCII|ENC_NA);\r\n} else if (ctrl_val_type == 0x15) {\r\nfor(i = 0; i < 12 + (num_ctrl_vals * 3); ++i) {\r\nproto_tree_add_item(ctrl_subtree, hf_aem_ctrl_float, tvb,\r\nctrl_offset, 4, ENC_BIG_ENDIAN);\r\nctrl_offset += 4;\r\n}\r\n} else if (ctrl_val_type > 0x15 && ctrl_val_type < 0x1f) {\r\n} else if (ctrl_val_type == 0xfffe) {\r\nproto_tree_add_item(ctrl_subtree, hf_aem_guid, tvb,\r\nctrl_offset, 8, ENC_BIG_ENDIAN);\r\nctrl_offset += 8;\r\nbin_blob_size = tvb_get_ntohl(tvb, ctrl_offset);\r\nproto_tree_add_item(ctrl_subtree, hf_aem_blob_size, tvb,\r\nctrl_offset, 4, ENC_BIG_ENDIAN);\r\nctrl_offset += 4;\r\nproto_tree_add_item(ctrl_subtree, hf_aem_binary_blob, tvb,\r\nctrl_offset, bin_blob_size, ENC_NA);\r\n}\r\n}\r\nstatic void\r\ndissect_17221_aem(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nguint16 desc_type;\r\nguint16 ctrl_val_type;\r\nguint16 num_ctrl_vals;\r\ntvbuff_t *next_tvb;\r\nint i;\r\nproto_item *mr_subtree;\r\nproto_item *mr_item;\r\nguint32 mr_offset;\r\nguint16 mr_counter;\r\ngfloat frequency;\r\ngint freq_mult;\r\ngint base_freq;\r\nproto_item *aem_tree;\r\nproto_item *desc_ti;\r\ndesc_type = tvb_get_ntohs(tvb, 0);\r\ndesc_ti = proto_tree_add_item(tree, hf_aecp_descriptor_type, tvb,\r\nAEM_OFFSET_DESCRIPTOR_TYPE, 2, ENC_BIG_ENDIAN);\r\naem_tree = proto_item_add_subtree(desc_ti, ett_aem_descriptor);\r\nproto_tree_add_item(aem_tree, hf_aecp_descriptor_index, tvb,\r\nAEM_OFFSET_DESCRIPTOR_ID, 2, ENC_BIG_ENDIAN);\r\nswitch(desc_type) {\r\ncase AEM_DESCRIPTOR_ENTITY:\r\nproto_tree_add_item(aem_tree, hf_aem_entity_id, tvb,\r\nENTITY_OFFSET_ENTITY_GUID, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_entity_model_id, tvb,\r\nENTITY_OFFSET_ENTITY_MODEL_ID, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_entity_cap, tvb,\r\nENTITY_OFFSET_ENTITY_CAPABILITIES, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_entity_cap_efu_mode, tvb,\r\nENTITY_OFFSET_ENTITY_CAPABILITIES, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_entity_cap_address_access_supported, tvb,\r\nENTITY_OFFSET_ENTITY_CAPABILITIES, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_entity_cap_gateway_entity, tvb,\r\nENTITY_OFFSET_ENTITY_CAPABILITIES, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_entity_cap_aem_supported, tvb,\r\nENTITY_OFFSET_ENTITY_CAPABILITIES, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_entity_cap_legacy_avc, tvb,\r\nENTITY_OFFSET_ENTITY_CAPABILITIES, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_entity_cap_assoc_id_support, tvb,\r\nENTITY_OFFSET_ENTITY_CAPABILITIES, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_entity_cap_assoc_id_valid, tvb,\r\nENTITY_OFFSET_ENTITY_CAPABILITIES, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_entity_cap_vendor_unique, tvb,\r\nENTITY_OFFSET_ENTITY_CAPABILITIES, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_entity_cap_class_a_supported, tvb,\r\nENTITY_OFFSET_ENTITY_CAPABILITIES, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_entity_cap_class_b_supported, tvb,\r\nENTITY_OFFSET_ENTITY_CAPABILITIES, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_entity_cap_gptp_supported, tvb,\r\nENTITY_OFFSET_ENTITY_CAPABILITIES, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_talker_stream_srcs, tvb,\r\nENTITY_OFFSET_TALKER_STREAM_SOURCES, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_talker_cap, tvb,\r\nENTITY_OFFSET_TALKER_CAPABILITIES, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_talk_cap_implement, tvb,\r\nENTITY_OFFSET_TALKER_CAPABILITIES, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_talk_cap_other_src, tvb,\r\nENTITY_OFFSET_TALKER_CAPABILITIES, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_talk_cap_control_src, tvb,\r\nENTITY_OFFSET_TALKER_CAPABILITIES, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_talk_cap_media_clk_src, tvb,\r\nENTITY_OFFSET_TALKER_CAPABILITIES, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_talk_cap_smpte_src, tvb,\r\nENTITY_OFFSET_TALKER_CAPABILITIES, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_talk_cap_midi_src, tvb,\r\nENTITY_OFFSET_TALKER_CAPABILITIES, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_talk_cap_audio_src, tvb,\r\nENTITY_OFFSET_TALKER_CAPABILITIES, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_talk_cap_video_src, tvb,\r\nENTITY_OFFSET_TALKER_CAPABILITIES, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_listener_stream_sinks, tvb,\r\nENTITY_OFFSET_LISTENER_STREAM_SINKS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_listener_cap, tvb,\r\nENTITY_OFFSET_LISTENER_CAPABILITIES, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_list_cap_implement, tvb,\r\nENTITY_OFFSET_LISTENER_CAPABILITIES, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_list_cap_other_sink, tvb,\r\nENTITY_OFFSET_LISTENER_CAPABILITIES, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_list_cap_control_sink, tvb,\r\nENTITY_OFFSET_LISTENER_CAPABILITIES, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_list_cap_media_clk_sink, tvb,\r\nENTITY_OFFSET_LISTENER_CAPABILITIES, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_list_cap_smpte_sink, tvb,\r\nENTITY_OFFSET_LISTENER_CAPABILITIES, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_list_cap_midi_sink, tvb,\r\nENTITY_OFFSET_LISTENER_CAPABILITIES, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_list_cap_audio_sink, tvb,\r\nENTITY_OFFSET_LISTENER_CAPABILITIES, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_list_cap_video_sink, tvb,\r\nENTITY_OFFSET_LISTENER_CAPABILITIES, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_controller_cap, tvb,\r\nENTITY_OFFSET_CONTROLLER_CAPABILITIES, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_cont_cap_implement, tvb,\r\nENTITY_OFFSET_CONTROLLER_CAPABILITIES, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_cont_cap_layer3_proxy, tvb,\r\nENTITY_OFFSET_CONTROLLER_CAPABILITIES, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_adp_avail_index, tvb,\r\nENTITY_OFFSET_AVAILABLE_INDEX, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aecp_association_id, tvb,\r\nENTITY_OFFSET_ASSOCIATION_ID, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_entity_name, tvb,\r\nENTITY_OFFSET_ENTITY_NAME, 64, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(aem_tree, hf_aem_vendor_name_string, tvb,\r\nENTITY_OFFSET_VENDOR_NAME_STRING, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_model_name_string, tvb,\r\nENTITY_OFFSET_MODEL_NAME_STRING, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_firmware_version, tvb,\r\nENTITY_OFFSET_FIRMWARE_VERSION, 64, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(aem_tree, hf_aem_group_name, tvb,\r\nENTITY_OFFSET_GROUP_NAME, 64, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(aem_tree, hf_aem_serial_number, tvb,\r\nENTITY_OFFSET_SERIAL_NUMBER, 64, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(aem_tree, hf_aem_configurations_count, tvb,\r\nENTITY_OFFSET_CONFIGURATIONS_COUNT, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_current_configuration, tvb,\r\nENTITY_OFFSET_CURRENT_CONFIGURATION, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AEM_DESCRIPTOR_CONFIGURATION:\r\nproto_tree_add_item(aem_tree, hf_aem_configuration_name, tvb,\r\nCONFIGURATION_OFFSET_OBJECT_NAME, 64, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(aem_tree, hf_aem_configuration_name_string, tvb,\r\nCONFIGURATION_OFFSET_LOCALIZED_DESCRIPTION, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_descriptor_counts_count, tvb,\r\nCONFIGURATION_OFFSET_DESCRIPTOR_COUNTS_COUNT, 2, ENC_BIG_ENDIAN);\r\nmr_item = proto_tree_add_item(aem_tree, hf_aem_descriptor_counts_offset, tvb,\r\nCONFIGURATION_OFFSET_DESCRIPTOR_COUNTS_OFFSET, 2, ENC_BIG_ENDIAN);\r\nmr_counter = tvb_get_ntohs(tvb, CONFIGURATION_OFFSET_DESCRIPTOR_COUNTS_COUNT);\r\nmr_subtree = proto_item_add_subtree(mr_item, ett_aem_desc_counts);\r\nmr_offset = CONFIGURATION_OFFSET_DESCRIPTOR_COUNTS;\r\nfor(i = 0; i < mr_counter; ++i)\r\n{\r\nproto_tree_add_item(mr_subtree, hf_aecp_descriptor_type, tvb, mr_offset, 2, ENC_BIG_ENDIAN);\r\nmr_offset += 2;\r\nproto_tree_add_item(mr_subtree, hf_aem_count, tvb, mr_offset, 2, ENC_BIG_ENDIAN);\r\nmr_offset += 2;\r\n}\r\nbreak;\r\ncase AEM_DESCRIPTOR_AUDIO_UNIT:\r\nproto_tree_add_item(aem_tree, hf_aem_object_name, tvb,\r\nAUDIO_UNIT_OFFSET_OBJECT_NAME, 64, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(aem_tree, hf_aem_localized_description, tvb,\r\nAUDIO_UNIT_OFFSET_LOCALIZED_DESCRIPTION, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_clock_domain_id, tvb,\r\nAUDIO_UNIT_OFFSET_CLOCK_DOMAIN_INDEX, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_of_stream_input_ports, tvb,\r\nAUDIO_UNIT_OFFSET_NUMBER_OF_STREAM_INPUT_PORTS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_stream_input_port, tvb,\r\nAUDIO_UNIT_OFFSET_BASE_STREAM_INPUT_PORT, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_of_stream_output_ports, tvb,\r\nAUDIO_UNIT_OFFSET_NUMBER_OF_STREAM_OUTPUT_PORTS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_stream_output_port, tvb,\r\nAUDIO_UNIT_OFFSET_BASE_STREAM_OUTPUT_PORT, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_of_external_input_ports, tvb,\r\nAUDIO_UNIT_OFFSET_NUMBER_OF_EXTERNAL_INPUT_PORTS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_external_input_port, tvb,\r\nAUDIO_UNIT_OFFSET_BASE_EXTERNAL_INPUT_PORT, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_of_external_output_ports, tvb,\r\nAUDIO_UNIT_OFFSET_NUMBER_OF_EXTERNAL_OUTPUT_PORTS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_external_output_port, tvb,\r\nAUDIO_UNIT_OFFSET_BASE_EXTERNAL_OUTPUT_PORT, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_of_internal_input_ports, tvb,\r\nAUDIO_UNIT_OFFSET_NUMBER_OF_INTERNAL_INPUT_PORTS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_internal_input_port, tvb,\r\nAUDIO_UNIT_OFFSET_BASE_INTERNAL_INPUT_PORT, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_of_internal_output_ports, tvb,\r\nAUDIO_UNIT_OFFSET_NUMBER_OF_INTERNAL_OUTPUT_PORTS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_internal_output_port, tvb,\r\nAUDIO_UNIT_OFFSET_BASE_INTERNAL_OUTPUT_PORT, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_of_controls, tvb,\r\nAUDIO_UNIT_OFFSET_NUMBER_OF_CONTROLS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_control, tvb,\r\nAUDIO_UNIT_OFFSET_BASE_CONTROL, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_signal_selectors, tvb,\r\nAUDIO_UNIT_OFFSET_NUMBER_SIGNAL_SELECTORS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_signal_selector, tvb,\r\nAUDIO_UNIT_OFFSET_BASE_SIGNAL_SELECTOR, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_mixers, tvb,\r\nAUDIO_UNIT_OFFSET_NUMBER_MIXERS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_mixer, tvb,\r\nAUDIO_UNIT_OFFSET_BASE_MIXER, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_matrices, tvb,\r\nAUDIO_UNIT_OFFSET_NUMBER_MATRICES, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_matrix, tvb,\r\nAUDIO_UNIT_OFFSET_BASE_MATRIX, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_splitters, tvb,\r\nAUDIO_UNIT_OFFSET_NUMBER_SPLITTERS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_splitter, tvb,\r\nAUDIO_UNIT_OFFSET_BASE_SPLITTER, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_combiners, tvb,\r\nAUDIO_UNIT_OFFSET_NUMBER_COMBINERS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_combiner, tvb,\r\nAUDIO_UNIT_OFFSET_BASE_COMBINER, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_demultiplexers, tvb,\r\nAUDIO_UNIT_OFFSET_NUMBER_DEMULTIPLEXERS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_demultiplexer, tvb,\r\nAUDIO_UNIT_OFFSET_BASE_DEMULTIPLEXER, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_multiplexers, tvb,\r\nAUDIO_UNIT_OFFSET_NUMBER_MULTIPLEXERS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_multiplexer, tvb,\r\nAUDIO_UNIT_OFFSET_BASE_MULTIPLEXER, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_transcoders, tvb,\r\nAUDIO_UNIT_OFFSET_NUMBER_TRANSCODERS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_transcoder, tvb,\r\nAUDIO_UNIT_OFFSET_BASE_TRANSCODER, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_control_blocks, tvb,\r\nAUDIO_UNIT_OFFSET_NUMBER_CONTROL_BLOCKS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_control_block, tvb,\r\nAUDIO_UNIT_OFFSET_BASE_CONTROL_BLOCK, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_current_sample_rate, tvb,\r\nAUDIO_UNIT_OFFSET_CURRENT_SAMPLE_RATE, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_sample_rates_offset, tvb,\r\nAUDIO_UNIT_OFFSET_SAMPLE_RATES_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_sample_rates_count, tvb,\r\nAUDIO_UNIT_OFFSET_SAMPLE_RATES_COUNT, 2, ENC_BIG_ENDIAN);\r\nmr_offset = tvb_get_ntohs(tvb, AUDIO_UNIT_OFFSET_SAMPLE_RATES_OFFSET);\r\nmr_counter = tvb_get_ntohs(tvb, AUDIO_UNIT_OFFSET_SAMPLE_RATES_COUNT);\r\nmr_item = proto_tree_add_item(aem_tree, hf_aem_sample_rates, tvb,\r\nmr_offset, mr_counter * 4, ENC_NA);\r\nmr_subtree = proto_item_add_subtree(mr_item, ett_aem_sample_rates);\r\nfor(i = 0; i < mr_counter; ++i) {\r\nproto_tree_add_item(mr_subtree, hf_aem_pull_field, tvb,\r\nmr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(mr_subtree, hf_aem_base_frequency, tvb,\r\nmr_offset, 4, ENC_BIG_ENDIAN);\r\nbase_freq = tvb_get_ntohl(tvb, mr_offset);\r\nfreq_mult = base_freq;\r\nfreq_mult &= 0xe0000000;\r\nfreq_mult = freq_mult >> 29;\r\nbase_freq &= 0x1fffffff;\r\nfrequency = freq_mult == 0 ? 1 :\r\nfreq_mult == 1 ? 1 / (gfloat)1.001 :\r\nfreq_mult == 2 ? (gfloat)1.001 :\r\nfreq_mult == 3 ? 24 / 25 :\r\nfreq_mult == 4 ? 54 / 24 : 0;\r\nfrequency *= base_freq;\r\nproto_tree_add_float(mr_subtree, hf_aem_frequency, tvb, mr_offset, 4, frequency);\r\nmr_offset += 4;\r\n}\r\nbreak;\r\ncase AEM_DESCRIPTOR_VIDEO_UNIT:\r\ncase AEM_DESCRIPTOR_SENSOR_UNIT:\r\nproto_tree_add_item(aem_tree, hf_aem_object_name, tvb,\r\nVIDEO_UNIT_OFFSET_OBJECT_NAME, 64, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(aem_tree, hf_aem_localized_description, tvb,\r\nVIDEO_UNIT_OFFSET_LOCALIZED_DESCRIPTION, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_clock_domain_id, tvb,\r\nAUDIO_UNIT_OFFSET_CLOCK_DOMAIN_INDEX, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_of_stream_input_ports, tvb,\r\nVIDEO_UNIT_OFFSET_NUMBER_OF_STREAM_INPUT_PORTS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_stream_input_port, tvb,\r\nVIDEO_UNIT_OFFSET_BASE_STREAM_INPUT_PORT, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_of_stream_output_ports, tvb,\r\nVIDEO_UNIT_OFFSET_NUMBER_OF_STREAM_OUTPUT_PORTS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_stream_output_port, tvb,\r\nVIDEO_UNIT_OFFSET_BASE_STREAM_OUTPUT_PORT, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_of_external_input_ports, tvb,\r\nVIDEO_UNIT_OFFSET_NUMBER_OF_EXTERNAL_INPUT_PORTS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_external_input_port, tvb,\r\nVIDEO_UNIT_OFFSET_BASE_EXTERNAL_INPUT_PORT, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_of_external_output_ports, tvb,\r\nVIDEO_UNIT_OFFSET_NUMBER_OF_EXTERNAL_OUTPUT_PORTS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_external_output_port, tvb,\r\nVIDEO_UNIT_OFFSET_BASE_EXTERNAL_OUTPUT_PORT, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_of_internal_input_ports, tvb,\r\nVIDEO_UNIT_OFFSET_NUMBER_OF_INTERNAL_INPUT_PORTS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_internal_input_port, tvb,\r\nVIDEO_UNIT_OFFSET_BASE_INTERNAL_INPUT_PORT, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_of_internal_output_ports, tvb,\r\nVIDEO_UNIT_OFFSET_NUMBER_OF_INTERNAL_OUTPUT_PORTS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_internal_output_port, tvb,\r\nVIDEO_UNIT_OFFSET_BASE_INTERNAL_OUTPUT_PORT, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_of_controls, tvb,\r\nVIDEO_UNIT_OFFSET_NUMBER_OF_CONTROLS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_control, tvb,\r\nVIDEO_UNIT_OFFSET_BASE_CONTROL, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_signal_selectors, tvb,\r\nVIDEO_UNIT_OFFSET_NUMBER_SIGNAL_SELECTORS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_signal_selector, tvb,\r\nVIDEO_UNIT_OFFSET_BASE_SIGNAL_SELECTOR, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_mixers, tvb,\r\nVIDEO_UNIT_OFFSET_NUMBER_MIXERS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_mixer, tvb,\r\nVIDEO_UNIT_OFFSET_BASE_MIXER, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_matrices, tvb,\r\nVIDEO_UNIT_OFFSET_NUMBER_MATRICES, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_matrix, tvb,\r\nVIDEO_UNIT_OFFSET_BASE_MATRIX, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_splitters, tvb,\r\nVIDEO_UNIT_OFFSET_NUMBER_SPLITTERS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_splitter, tvb,\r\nVIDEO_UNIT_OFFSET_BASE_SPLITTER, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_combiners, tvb,\r\nVIDEO_UNIT_OFFSET_NUMBER_COMBINERS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_combiner, tvb,\r\nVIDEO_UNIT_OFFSET_BASE_COMBINER, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_demultiplexers, tvb,\r\nVIDEO_UNIT_OFFSET_NUMBER_DEMULTIPLEXERS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_demultiplexer, tvb,\r\nVIDEO_UNIT_OFFSET_BASE_DEMULTIPLEXER, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_multiplexers, tvb,\r\nVIDEO_UNIT_OFFSET_NUMBER_MULTIPLEXERS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_multiplexer, tvb,\r\nVIDEO_UNIT_OFFSET_BASE_MULTIPLEXER, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_transcoders, tvb,\r\nVIDEO_UNIT_OFFSET_NUMBER_TRANSCODERS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_transcoder, tvb,\r\nVIDEO_UNIT_OFFSET_BASE_TRANSCODER, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_control_blocks, tvb,\r\nVIDEO_UNIT_OFFSET_NUMBER_CONTROL_BLOCKS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_control_block, tvb,\r\nVIDEO_UNIT_OFFSET_BASE_CONTROL_BLOCK, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AEM_DESCRIPTOR_STREAM_INPUT:\r\ncase AEM_DESCRIPTOR_STREAM_OUTPUT:\r\nproto_tree_add_item(aem_tree, hf_aem_stream_name, tvb,\r\nSTREAM_OFFSET_OBJECT_NAME, 64, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(aem_tree, hf_aem_stream_name_string, tvb,\r\nSTREAM_OFFSET_LOCALIZED_DESCRIPTION, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_clock_domain_id, tvb,\r\nSTREAM_OFFSET_CLOCK_DOMAIN_INDEX, 2, ENC_BIG_ENDIAN);\r\nmr_item = proto_tree_add_item(aem_tree, hf_aem_stream_flags, tvb,\r\nSTREAM_OFFSET_STREAM_FLAGS, 2, ENC_BIG_ENDIAN);\r\nmr_subtree = proto_item_add_subtree(mr_item, ett_aem_stream_flags);\r\nproto_tree_add_item(mr_subtree, hf_aem_flags_clock_sync_source, tvb,\r\nSTREAM_OFFSET_STREAM_FLAGS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(mr_subtree, hf_aem_flags_class_a, tvb,\r\nSTREAM_OFFSET_STREAM_FLAGS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(mr_subtree, hf_aem_flags_class_b, tvb,\r\nSTREAM_OFFSET_STREAM_FLAGS, 2, ENC_BIG_ENDIAN);\r\nnext_tvb = tvb_new_subset_length(tvb, STREAM_OFFSET_CURRENT_FORMAT, 8);\r\ndissect_17221_stream_format(next_tvb, aem_tree);\r\nproto_tree_add_item(aem_tree, hf_aem_formats_offset, tvb,\r\nSTREAM_OFFSET_FORMATS_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_of_formats, tvb,\r\nSTREAM_OFFSET_NUMBER_OF_FORMATS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_backup_talker_guid_0, tvb,\r\nSTREAM_OFFSET_BACKUP_TALKER_GUID_0, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_backup_talker_unique_0, tvb,\r\nSTREAM_OFFSET_BACKUP_TALKER_UNIQUE_0, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_backup_talker_guid_1, tvb,\r\nSTREAM_OFFSET_BACKUP_TALKER_GUID_1, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_backup_talker_unique_1, tvb,\r\nSTREAM_OFFSET_BACKUP_TALKER_UNIQUE_1, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_backup_talker_guid_2, tvb,\r\nSTREAM_OFFSET_BACKUP_TALKER_GUID_2, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_backup_talker_unique_2, tvb,\r\nSTREAM_OFFSET_BACKUP_TALKER_UNIQUE_2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_backedup_talker_guid, tvb,\r\nSTREAM_OFFSET_BACKEDUP_TALKER_GUID, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_backedup_talker_unique, tvb,\r\nSTREAM_OFFSET_BACKEDUP_TALKER_UNIQUE_ID, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_avb_interface_id, tvb,\r\nSTREAM_OFFSET_AVB_INTERFACE_ID, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_buffer_length, tvb,\r\nSTREAM_OFFSET_BUFFER_LENGTH, 2, ENC_BIG_ENDIAN);\r\nmr_offset = tvb_get_ntohs(tvb, STREAM_OFFSET_FORMATS_OFFSET);\r\nmr_counter = tvb_get_ntohs(tvb, STREAM_OFFSET_NUMBER_OF_FORMATS);\r\nmr_item = proto_tree_add_item(aem_tree, hf_aem_stream_formats, tvb,\r\nmr_offset, mr_counter * 8, ENC_NA);\r\nmr_subtree = proto_item_add_subtree(mr_item, ett_aem_stream_formats);\r\nfor(i = 0; i < mr_counter; ++i) {\r\nnext_tvb = tvb_new_subset_length(tvb, mr_offset, 8);\r\ndissect_17221_stream_format(next_tvb, mr_subtree);\r\nmr_offset += 8;\r\n}\r\nbreak;\r\ncase AEM_DESCRIPTOR_JACK_INPUT:\r\ncase AEM_DESCRIPTOR_JACK_OUTPUT:\r\nproto_tree_add_item(aem_tree, hf_aem_jack_name, tvb,\r\nJACK_OFFSET_OBJECT_NAME, 64, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(aem_tree, hf_aem_jack_name_string, tvb,\r\nJACK_OFFSET_LOCALIZED_DESCRIPTION, 2, ENC_BIG_ENDIAN);\r\nmr_item = proto_tree_add_item(aem_tree, hf_aem_jack_flags, tvb,\r\nJACK_OFFSET_JACK_FLAGS, 2, ENC_BIG_ENDIAN);\r\nmr_subtree = proto_item_add_subtree(mr_item, ett_aem_jack_flags);\r\nproto_tree_add_item(mr_subtree, hf_aem_flags_captive, tvb,\r\nJACK_OFFSET_JACK_FLAGS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(mr_subtree, hf_aem_flags_clock_sync_source, tvb,\r\nJACK_OFFSET_JACK_FLAGS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_jack_type, tvb,\r\nJACK_OFFSET_JACK_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_of_controls, tvb,\r\nJACK_OFFSET_JACK_NUMBER_OF_CONTROLS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_control, tvb,\r\nJACK_OFFSET_JACK_BASE_CONTROL, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AEM_DESCRIPTOR_STREAM_PORT_INPUT:\r\ncase AEM_DESCRIPTOR_STREAM_PORT_OUTPUT:\r\nproto_tree_add_item(aem_tree, hf_aem_clock_domain_id, tvb,\r\nSTREAM_PORT_OFFSET_CLOCK_DOMAIN_INDEX, 2, ENC_BIG_ENDIAN);\r\nmr_item = proto_tree_add_item(aem_tree, hf_aem_port_flags, tvb,\r\nSTREAM_PORT_OFFSET_PORT_FLAGS, 2, ENC_BIG_ENDIAN);\r\nmr_subtree = proto_item_add_subtree(mr_item, ett_aem_port_flags);\r\nproto_tree_add_item(mr_subtree, hf_aem_flags_clock_sync_source, tvb,\r\nSTREAM_PORT_OFFSET_PORT_FLAGS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(mr_subtree, hf_aem_flags_async_sample_rate_conv, tvb,\r\nSTREAM_PORT_OFFSET_PORT_FLAGS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(mr_subtree, hf_aem_flags_sync_sample_rate_conv, tvb,\r\nSTREAM_PORT_OFFSET_PORT_FLAGS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_of_controls, tvb,\r\nSTREAM_PORT_OFFSET_NUMBER_OF_CONTROLS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_control, tvb,\r\nSTREAM_PORT_OFFSET_BASE_CONTROL, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_of_clusters, tvb,\r\nSTREAM_PORT_OFFSET_NUMBER_OF_CLUSTERS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_cluster, tvb,\r\nSTREAM_PORT_OFFSET_BASE_CLUSTER, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_audio_maps, tvb,\r\nSTREAM_PORT_OFFSET_NUMBER_AUDIO_MAPS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_audio_map, tvb,\r\nSTREAM_PORT_OFFSET_BASE_AUDIO_MAP, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AEM_DESCRIPTOR_EXTERNAL_PORT_INPUT:\r\ncase AEM_DESCRIPTOR_EXTERNAL_PORT_OUTPUT:\r\nproto_tree_add_item(aem_tree, hf_aem_clock_domain_id, tvb,\r\nEXTERNAL_PORT_OFFSET_CLOCK_DOMAIN_INDEX, 2, ENC_BIG_ENDIAN);\r\nmr_item = proto_tree_add_item(aem_tree, hf_aem_port_flags, tvb,\r\nEXTERNAL_PORT_OFFSET_PORT_FLAGS, 2, ENC_BIG_ENDIAN);\r\nmr_subtree = proto_item_add_subtree(mr_item, ett_aem_port_flags);\r\nproto_tree_add_item(mr_subtree, hf_aem_flags_clock_sync_source, tvb,\r\nEXTERNAL_PORT_OFFSET_PORT_FLAGS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(mr_subtree, hf_aem_flags_async_sample_rate_conv, tvb,\r\nEXTERNAL_PORT_OFFSET_PORT_FLAGS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(mr_subtree, hf_aem_flags_sync_sample_rate_conv, tvb,\r\nEXTERNAL_PORT_OFFSET_PORT_FLAGS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_of_controls, tvb,\r\nEXTERNAL_PORT_OFFSET_NUMBER_OF_CONTROLS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_control, tvb,\r\nEXTERNAL_PORT_OFFSET_BASE_CONTROL, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_signal_type, tvb,\r\nEXTERNAL_PORT_OFFSET_SIGNAL_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_signal_index, tvb,\r\nEXTERNAL_PORT_OFFSET_SIGNAL_INDEX, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_signal_output, tvb,\r\nEXTERNAL_PORT_OFFSET_SIGNAL_OUTPUT, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_block_latency, tvb,\r\nEXTERNAL_PORT_OFFSET_BLOCK_LATENCY, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_jack_id, tvb,\r\nEXTERNAL_PORT_OFFSET_JACK_INDEX, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AEM_DESCRIPTOR_INTERNAL_PORT_INPUT:\r\ncase AEM_DESCRIPTOR_INTERNAL_PORT_OUTPUT:\r\nproto_tree_add_item(aem_tree, hf_aem_clock_domain_id, tvb,\r\nINTERNAL_PORT_OFFSET_CLOCK_DOMAIN_INDEX, 2, ENC_BIG_ENDIAN);\r\nmr_item = proto_tree_add_item(aem_tree, hf_aem_port_flags, tvb,\r\nINTERNAL_PORT_OFFSET_PORT_FLAGS, 2, ENC_BIG_ENDIAN);\r\nmr_subtree = proto_item_add_subtree(mr_item, ett_aem_port_flags);\r\nproto_tree_add_item(mr_subtree, hf_aem_flags_clock_sync_source, tvb,\r\nINTERNAL_PORT_OFFSET_PORT_FLAGS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(mr_subtree, hf_aem_flags_async_sample_rate_conv, tvb,\r\nINTERNAL_PORT_OFFSET_PORT_FLAGS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(mr_subtree, hf_aem_flags_sync_sample_rate_conv, tvb,\r\nINTERNAL_PORT_OFFSET_PORT_FLAGS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_of_controls, tvb,\r\nINTERNAL_PORT_OFFSET_NUMBER_OF_CONTROLS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_control, tvb,\r\nINTERNAL_PORT_OFFSET_BASE_CONTROL, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_signal_type, tvb,\r\nINTERNAL_PORT_OFFSET_SIGNAL_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_signal_index, tvb,\r\nINTERNAL_PORT_OFFSET_SIGNAL_INDEX, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_signal_output, tvb,\r\nINTERNAL_PORT_OFFSET_SIGNAL_OUTPUT, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_block_latency, tvb,\r\nINTERNAL_PORT_OFFSET_BLOCK_LATENCY, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_jack_id, tvb,\r\nINTERNAL_PORT_OFFSET_INTERNAL_INDEX, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AEM_DESCRIPTOR_AVB_INTERFACE:\r\nproto_tree_add_item(aem_tree, hf_aem_interface_name, tvb,\r\nAVB_INTERFACE_OFFSET_OBJECT_NAME, 64, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(aem_tree, hf_aem_interface_name_string, tvb,\r\nAVB_INTERFACE_OFFSET_LOCALIZED_DESCRIPTION, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aecp_mac_address, tvb,\r\nAVB_INTERFACE_OFFSET_MAC_ADDRESS, 6, ENC_NA);\r\nproto_tree_add_item(aem_tree, hf_aem_avb_interface_flags, tvb,\r\nAVB_INTERFACE_OFFSET_INTERFACE_FLAGS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_avb_clock_identity, tvb,\r\nAVB_INTERFACE_OFFSET_CLOCK_IDENTITY, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_avb_priority1, tvb,\r\nAVB_INTERFACE_OFFSET_PRIORITY1, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_avb_clock_class, tvb,\r\nAVB_INTERFACE_OFFSET_CLOCK_CLASS, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_avb_offset_scaled_log_variance, tvb,\r\nAVB_INTERFACE_OFFSET_OFFSET_SCALED_LOG_VARIANCE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_avb_clock_accuracy, tvb,\r\nAVB_INTERFACE_OFFSET_CLOCK_ACCURACY, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_avb_priority2, tvb,\r\nAVB_INTERFACE_OFFSET_PRIORITY2, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_avb_domain_number, tvb,\r\nAVB_INTERFACE_OFFSET_DOMAIN_NUMBER, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_avb_log_sync_interval, tvb,\r\nAVB_INTERFACE_OFFSET_LOG_SYNC_INTERVAL, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AEM_DESCRIPTOR_CLOCK_SOURCE:\r\nproto_tree_add_item(aem_tree, hf_aem_clock_source_name, tvb,\r\nCLOCK_SOURCE_OFFSET_OBJECT_NAME, 64, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(aem_tree, hf_aem_clock_source_name_string, tvb,\r\nCLOCK_SOURCE_OFFSET_LOCALIZED_DESCRIPTION, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_clock_source_flags, tvb,\r\nCLOCK_SOURCE_OFFSET_CLOCK_SOURCE_FLAGS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_clock_source_type, tvb,\r\nCLOCK_SOURCE_OFFSET_CLOCK_SOURCE_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aecp_clock_source_id, tvb,\r\nCLOCK_SOURCE_OFFSET_CLOCK_SOURCE_IDENTIFIER, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_clock_source_location_type, tvb,\r\nCLOCK_SOURCE_OFFSET_CLOCK_SOURCE_LOCATION_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_clock_source_location_id, tvb,\r\nCLOCK_SOURCE_OFFSET_CLOCK_SOURCE_LOCATION_INDEX, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AEM_DESCRIPTOR_AUDIO_MAP:\r\nproto_tree_add_item(aem_tree, hf_aem_mappings_offset, tvb,\r\nAUDIO_MAP_OFFSET_MAPPINGS_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_of_mappings, tvb,\r\nAUDIO_MAP_OFFSET_NUMBER_OF_MAPPINGS, 2, ENC_BIG_ENDIAN);\r\nmr_item = proto_tree_add_item(aem_tree, hf_aem_mappings, tvb,\r\n0, 0, ENC_NA);\r\nmr_subtree = proto_item_add_subtree(mr_item, ett_aem_mappings);\r\nmr_offset = tvb_get_ntohs(tvb, AUDIO_MAP_OFFSET_MAPPINGS_OFFSET);\r\nmr_counter = tvb_get_ntohs(tvb, AUDIO_MAP_OFFSET_NUMBER_OF_MAPPINGS);\r\nproto_item_set_len(mr_item, mr_counter * 8);\r\nfor(i = 0; i < mr_counter; i++) {\r\nproto_tree_add_item(mr_subtree, hf_aem_mapping_stream_index, tvb,\r\nmr_offset, 2, ENC_BIG_ENDIAN);\r\nmr_offset += 2;\r\nproto_tree_add_item(mr_subtree, hf_aem_mapping_stream_channel, tvb,\r\nmr_offset, 2, ENC_BIG_ENDIAN);\r\nmr_offset += 2;\r\nproto_tree_add_item(mr_subtree, hf_aem_mapping_cluster_offset, tvb,\r\nmr_offset, 2, ENC_BIG_ENDIAN);\r\nmr_offset += 2;\r\nproto_tree_add_item(mr_subtree, hf_aem_mapping_cluster_channel, tvb,\r\nmr_offset, 2, ENC_BIG_ENDIAN);\r\nmr_offset += 2;\r\n}\r\nbreak;\r\ncase AEM_DESCRIPTOR_AUDIO_CLUSTER:\r\nproto_tree_add_item(aem_tree, hf_aem_configuration_name, tvb,\r\nAUDIO_CLUSTER_OFFSET_OBJECT_NAME, 64, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(aem_tree, hf_aem_configuration_name_string, tvb,\r\nAUDIO_CLUSTER_OFFSET_LOCALIZED_DESCRIPTION, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_signal_type, tvb,\r\nAUDIO_CLUSTER_OFFSET_SIGNAL_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_signal_index, tvb,\r\nAUDIO_CLUSTER_OFFSET_SIGNAL_ID, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_signal_output, tvb,\r\nAUDIO_CLUSTER_OFFSET_SIGNAL_OUTPUT, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_path_latency, tvb,\r\nAUDIO_CLUSTER_OFFSET_PATH_LATENCY, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_block_latency, tvb,\r\nAUDIO_CLUSTER_OFFSET_BLOCK_LATENCY, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_channel_count, tvb,\r\nAUDIO_CLUSTER_OFFSET_CHANNEL_COUNT, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_am824_label, tvb,\r\nAUDIO_CLUSTER_OFFSET_FORMAT, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AEM_DESCRIPTOR_CONTROL:\r\nproto_tree_add_item(aem_tree, hf_aem_object_name, tvb,\r\nCONTROL_OFFSET_OBJECT_NAME, 64, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(aem_tree, hf_aem_localized_description, tvb,\r\nCONTROL_OFFSET_LOCALIZED_DESCRIPTION, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_block_latency, tvb,\r\nCONTROL_OFFSET_BLOCK_LATENCY, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_control_latency, tvb,\r\nCONTROL_OFFSET_CONTROL_LATENCY, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_control_domain, tvb,\r\nCONTROL_OFFSET_CONTROL_DOMAIN, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_control_value_type, tvb,\r\nCONTROL_OFFSET_CONTROL_VALUE_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_control_type, tvb,\r\nCONTROL_OFFSET_CONTROL_TYPE, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_reset_time, tvb,\r\nCONTROL_OFFSET_RESET_TIME, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_values_offset, tvb,\r\nCONTROL_OFFSET_VALUES_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_of_values, tvb,\r\nCONTROL_OFFSET_NUMBER_OF_VALUES, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_signal_type, tvb,\r\nCONTROL_OFFSET_SIGNAL_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_signal_index, tvb,\r\nCONTROL_OFFSET_SIGNAL_INDEX, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_signal_output, tvb,\r\nCONTROL_OFFSET_SIGNAL_OUTPUT, 2, ENC_BIG_ENDIAN);\r\nctrl_val_type = tvb_get_ntohs(tvb, CONTROL_OFFSET_CONTROL_VALUE_TYPE);\r\nnum_ctrl_vals = tvb_get_ntohs(tvb, CONTROL_OFFSET_NUMBER_OF_VALUES);\r\nmr_offset = tvb_get_ntohs(tvb, CONTROL_OFFSET_VALUES_OFFSET);\r\ndissect_17221_ctrl_val(tvb, aem_tree, num_ctrl_vals, ctrl_val_type,\r\nmr_offset);\r\nbreak;\r\ncase AEM_DESCRIPTOR_SIGNAL_SELECTOR:\r\nproto_tree_add_item(aem_tree, hf_aem_object_name, tvb,\r\nSIGNAL_SELECTOR_OFFSET_OBJECT_NAME, 64, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(aem_tree, hf_aem_localized_description, tvb,\r\nSIGNAL_SELECTOR_OFFSET_LOCALIZED_DESCRIPTION, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_block_latency, tvb,\r\nSIGNAL_SELECTOR_OFFSET_BLOCK_LATENCY, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_control_latency, tvb,\r\nSIGNAL_SELECTOR_OFFSET_CONTROL_LATENCY, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_control_domain, tvb,\r\nSIGNAL_SELECTOR_OFFSET_CONTROL_DOMAIN, 2, ENC_BIG_ENDIAN);\r\n#if 0\r\nproto_tree_add_item(aem_tree, hf_aem_control_location_type, tvb,\r\nAEM_OFFSET_CONTROL_LOCATION_TYPE_SIGS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_control_location_id, tvb,\r\nAEM_OFFSET_CONTROL_LOCATION_ID_SIGS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_control_domain, tvb,\r\nAEM_OFFSET_CONTROL_DOMAIN_SIGS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_object_name, tvb,\r\nAEM_OFFSET_CONTROL_NAME_SIGS, 64, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(aem_tree, hf_aem_localized_description, tvb,\r\nAEM_OFFSET_CONTROL_NAME_STRING_SIGS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_sources_offset, tvb,\r\nAEM_OFFSET_SOURCES_OFFSET_SIGS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_of_sources, tvb,\r\nAEM_OFFSET_NUMBER_OF_SOURCES_SIGS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_current_signal_type, tvb,\r\nAEM_OFFSET_CURRENT_SOURCE_TYPE_SIGS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_current_signal_index, tvb,\r\nAEM_OFFSET_CURRENT_SOURCE_ID_SIGS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_default_signal_type, tvb,\r\nAEM_OFFSET_DEFAULT_SOURCE_TYPE_SIGS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_default_signal_index, tvb,\r\nAEM_OFFSET_DEFAULT_SOURCE_ID_SIGS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_block_latency, tvb,\r\nSIGNAL_SELECTOR_OFFSET_BLOCK_LATENCY, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_control_latency, tvb,\r\nSIGNAL_SELECTOR_OFFSET_CONTROL_LATENCY, 4, ENC_BIG_ENDIAN);\r\nmr_item = proto_tree_add_item(aem_tree, hf_aem_sources, tvb,\r\n0, 0, ENC_NA);\r\nmr_subtree = proto_item_add_subtree(mr_item, ett_aem_sources);\r\nmr_counter = tvb_get_ntohs(tvb, AEM_OFFSET_NUMBER_OF_SOURCES_SIGS);\r\nmr_offset = SIGNAL_SELECTOR_OFFSET_SOURCES;\r\nproto_item_set_len(mr_item, mr_counter * 4);\r\nfor(i = 0; i < mr_counter; ++i) {\r\nproto_tree_add_item(mr_subtree, hf_aem_signal_type, tvb,\r\nmr_offset, 2, ENC_BIG_ENDIAN);\r\nmr_offset += 2;\r\nproto_tree_add_item(mr_subtree, hf_aem_signal_index, tvb,\r\nmr_offset, 2, ENC_BIG_ENDIAN);\r\nmr_offset += 2;\r\n}\r\n#endif\r\nbreak;\r\ncase AEM_DESCRIPTOR_MIXER:\r\nproto_tree_add_item(aem_tree, hf_aem_object_name, tvb,\r\nMIXER_OFFSET_OBJECT_NAME, 64, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(aem_tree, hf_aem_localized_description, tvb,\r\nMIXER_OFFSET_LOCALIZED_DESCRIPTION, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_block_latency, tvb,\r\nMIXER_OFFSET_BLOCK_LATENCY, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_control_latency, tvb,\r\nMIXER_OFFSET_CONTROL_LATENCY, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_control_domain, tvb,\r\nMIXER_OFFSET_CONTROL_DOMAIN, 2, ENC_BIG_ENDIAN);\r\n#if 0\r\nproto_tree_add_item(aem_tree, hf_aem_control_location_type, tvb,\r\nAEM_OFFSET_CONTROL_LOCATION_TYPE_MXR, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_control_location_id, tvb,\r\nAEM_OFFSET_CONTROL_LOCATION_ID_MXR, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_control_value_type, tvb,\r\nAEM_OFFSET_CONTROL_VALUE_TYPE_MXR, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_control_domain, tvb,\r\nAEM_OFFSET_CONTROL_DOMAIN_MXR, 2 ,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_object_name, tvb,\r\nAEM_OFFSET_CONTROL_NAME_MXR, 64, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(aem_tree, hf_aem_localized_description, tvb,\r\nAEM_OFFSET_CONTROL_NAME_STRING_MXR, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_sources_offset, tvb,\r\nAEM_OFFSET_SOURCES_OFFSET_MXR, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_number_of_sources, tvb,\r\nAEM_OFFSET_NUMBER_OF_SOURCES_MXR, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_value_offset, tvb,\r\nAEM_OFFSET_VALUE_OFFSET_MXR, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_block_latency, tvb,\r\nMIXER_OFFSET_BLOCK_LATENCY, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_control_latency, tvb,\r\nMIXER_OFFSET_CONTROL_LATENCY, 4, ENC_BIG_ENDIAN);\r\nmr_item = proto_tree_add_item(aem_tree, hf_aem_sources, tvb,\r\n0, 0, ENC_NA);\r\nmr_subtree = proto_item_add_subtree(mr_item, ett_aem_sources);\r\nmr_counter = tvb_get_ntohs(tvb, AEM_OFFSET_NUMBER_OF_SOURCES_MXR);\r\nmr_offset = MIXER_OFFSET_SOURCES;\r\nproto_item_set_len(mr_item, mr_counter * 4);\r\nfor(i = 0; i < mr_counter; ++i) {\r\nproto_tree_add_item(mr_subtree, hf_aem_signal_type, tvb,\r\nmr_offset, 2, ENC_BIG_ENDIAN);\r\nmr_offset += 2;\r\nproto_tree_add_item(mr_subtree, hf_aem_signal_index, tvb,\r\nmr_offset, 2, ENC_BIG_ENDIAN);\r\nmr_offset += 2;\r\n}\r\nctrl_val_type = tvb_get_ntohs(tvb, AEM_OFFSET_CONTROL_VALUE_TYPE_MXR);\r\nnum_ctrl_vals = 1;\r\ndissect_17221_ctrl_val(tvb, aem_tree, num_ctrl_vals, ctrl_val_type,\r\nMIXER_OFFSET_SOURCES + (tvb_get_ntohs(tvb, AEM_OFFSET_NUMBER_OF_SOURCES_MXR) * 4));\r\n#endif\r\nbreak;\r\ncase AEM_DESCRIPTOR_MATRIX:\r\nproto_tree_add_item(aem_tree, hf_aem_object_name, tvb,\r\nMATRIX_OFFSET_OBJECT_NAME, 64, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(aem_tree, hf_aem_localized_description, tvb,\r\nMATRIX_OFFSET_LOCALIZED_DESCRIPTION, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_block_latency, tvb,\r\nMATRIX_OFFSET_BLOCK_LATENCY, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_control_latency, tvb,\r\nMATRIX_OFFSET_CONTROL_LATENCY, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_control_domain, tvb,\r\nMATRIX_OFFSET_CONTROL_DOMAIN, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AEM_DESCRIPTOR_LOCALE:\r\nproto_tree_add_item(aem_tree, hf_aem_locale_identifier, tvb,\r\nLOCALE_OFFSET_LOCALE_IDENTIFIER, 64, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(aem_tree, hf_aem_number_of_strings, tvb,\r\nLOCALE_OFFSET_NUMBER_OF_STRINGS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_base_strings, tvb,\r\nLOCALE_OFFSET_BASE_STRINGS, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AEM_DESCRIPTOR_STRINGS:\r\nmr_offset = STRINGS_OFFSET_STRING0;\r\nfor(i = 0; i < 7; ++i) {\r\nproto_tree_add_item(aem_tree, hf_aem_string, tvb,\r\nmr_offset, 64, ENC_ASCII|ENC_NA);\r\nmr_offset += 64;\r\n}\r\nbreak;\r\ncase AEM_DESCRIPTOR_MATRIX_SIGNAL:\r\nproto_tree_add_item(aem_tree, hf_aem_signals_count, tvb,\r\nMATRIX_SIGNAL_OFFSET_SIGNALS_COUNT, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_signals_offset, tvb,\r\nMATRIX_SIGNAL_OFFSET_SIGNALS_OFFSET, 2, ENC_BIG_ENDIAN);\r\nmr_item = proto_tree_add_item(aem_tree, hf_aem_sources, tvb,\r\n0, 0, ENC_NA);\r\nmr_subtree = proto_item_add_subtree(mr_item, ett_aem_sources);\r\nmr_counter = tvb_get_ntohs(tvb, MATRIX_SIGNAL_OFFSET_SIGNALS_COUNT);\r\nmr_offset = MATRIX_SIGNAL_OFFSET_SIGNALS_OFFSET;\r\nproto_item_set_len(mr_item, mr_counter * 4);\r\nfor(i = 0; i < mr_counter; ++i)\r\n{\r\nproto_tree_add_item(mr_subtree, hf_aem_signal_type, tvb,\r\nmr_offset, 2, ENC_BIG_ENDIAN);\r\nmr_offset += 2;\r\nproto_tree_add_item(mr_subtree, hf_aem_signal_index, tvb,\r\nmr_offset, 2, ENC_BIG_ENDIAN);\r\nmr_offset += 2;\r\n}\r\nbreak;\r\ncase AEM_DESCRIPTOR_MEMORY_OBJECT:\r\nproto_tree_add_item(aem_tree, hf_aem_memory_object_type, tvb,\r\nMEMORY_OBJECT_OFFSET_MEMORY_OBJECT_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_target_descriptor_type, tvb,\r\nMEMORY_OBJECT_OFFSET_TARGET_DESCRIPTOR_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_target_descriptor_id, tvb,\r\nMEMORY_OBJECT_OFFSET_TARGET_DESCRIPTOR_INDEX, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_object_name, tvb,\r\nMEMORY_OBJECT_OFFSET_OBJECT_NAME, 64, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(aem_tree, hf_aem_localized_description, tvb,\r\nMEMORY_OBJECT_OFFSET_LOCALIZED_DESCRIPTION, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_start_address, tvb,\r\nMEMORY_OBJECT_OFFSET_START_ADDRESS, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_length, tvb,\r\nMEMORY_OBJECT_OFFSET_LENGTH, 8, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AEM_DESCRIPTOR_CLOCK_DOMAIN:\r\nproto_tree_add_item(aem_tree, hf_aem_object_name, tvb,\r\nCLOCK_DOMAIN_OFFSET_OBJECT_NAME, 64, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(aem_tree, hf_aem_localized_description, tvb,\r\nCLOCK_DOMAIN_OFFSET_LOCALIZED_DESCRIPTION, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_clock_source_index, tvb,\r\nCLOCK_DOMAIN_OFFSET_CLOCK_SOURCE_INDEX, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_clock_sources_offset, tvb,\r\nCLOCK_DOMAIN_OFFSET_CLOCK_SOURCES_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aem_tree, hf_aem_clock_sources_count, tvb,\r\nCLOCK_DOMAIN_OFFSET_CLOCK_SOURCES_COUNT, 2, ENC_BIG_ENDIAN);\r\nmr_counter = tvb_get_ntohs(tvb, CLOCK_DOMAIN_OFFSET_CLOCK_SOURCES_COUNT);\r\nmr_offset = tvb_get_ntohs(tvb, CLOCK_DOMAIN_OFFSET_CLOCK_SOURCES_OFFSET);\r\nmr_item = proto_tree_add_item(aem_tree, hf_aem_clock_sources_array, tvb,\r\nmr_offset, mr_counter * 2, ENC_NA);\r\nmr_subtree = proto_item_add_subtree(mr_item, ett_aem_clock_sources);\r\nfor(i = 0; i < mr_counter; ++i)\r\n{\r\nproto_tree_add_item(mr_subtree, hf_aem_clock_sources, tvb,\r\nmr_offset, 2, ENC_BIG_ENDIAN);\r\nmr_offset += 2;\r\n}\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(aem_tree, hf_aem_unknown_descriptor, tvb,\r\n4, tvb_captured_length(tvb) - 4, ENC_NA);\r\nbreak;\r\n}\r\n}\r\nstatic void\r\ndissect_17221_aecp(tvbuff_t *tvb, packet_info *pinfo, proto_tree *aecp_tree)\r\n{\r\nguint16 c_type;\r\nguint16 mess_status;\r\nguint16 mess_type;\r\nguint16 mr_counter;\r\nguint32 mr_offset;\r\nproto_item *mr_subtree;\r\nproto_item *mr_item;\r\nint i;\r\ntvbuff_t *next_tvb;\r\nproto_tree *flags_tree;\r\nproto_item *flags_ti;\r\nproto_tree_add_item(aecp_tree, hf_aecp_message_type, tvb,\r\nAECP_OFFSET_VERSION, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_status_code, tvb,\r\nAECP_OFFSET_STATUS_CODE, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_cd_length, tvb,\r\nAECP_OFFSET_CD_LENGTH, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_target_guid, tvb,\r\nAECP_OFFSET_TARGET_GUID, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_controller_guid, tvb,\r\nAECP_OFFSET_CONTROLLER_GUID, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_sequence_id, tvb,\r\nAECP_OFFSET_SEQUENCE_ID, 2, ENC_BIG_ENDIAN);\r\nmess_type = tvb_get_ntohs(tvb, 0) & AECP_MSG_TYPE_MASK;\r\nif ((mess_type == AECP_AEM_COMMAND_MESSAGE) || (mess_type == AECP_AEM_RESPONSE_MESSAGE))\r\n{\r\nproto_tree_add_item(aecp_tree, hf_aecp_u_flag, tvb,\r\nAECP_OFFSET_U_FLAG, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_command_type, tvb,\r\nAECP_OFFSET_COMMAND_TYPE, 2, ENC_BIG_ENDIAN);\r\nc_type = tvb_get_ntohs(tvb, AECP_OFFSET_COMMAND_TYPE) & AECP_COMMAND_TYPE_MASK;\r\nmess_status = tvb_get_ntohs(tvb, 2) & 0xF800;\r\nswitch(c_type) {\r\ncase AECP_COMMAND_ACQUIRE_ENTITY:\r\nflags_ti = proto_tree_add_item(aecp_tree, hf_aecp_flags_32, tvb,\r\nAECP_OFFSET_ACQUIRE_ENTITY_FLAGS, 4, ENC_BIG_ENDIAN);\r\nflags_tree = proto_item_add_subtree(flags_ti, ett_acmp_flags);\r\nproto_tree_add_item(flags_tree, hf_aecp_persistent_flag, tvb,\r\nAECP_OFFSET_ACQUIRE_ENTITY_FLAGS, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_release_flag, tvb,\r\nAECP_OFFSET_ACQUIRE_ENTITY_FLAGS, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_owner_guid, tvb,\r\nAECP_OFFSET_ACQUIRE_ENTITY_OWNER_GUID, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_type, tvb,\r\nAECP_OFFSET_ACQUIRE_ENTITY_DESCRIPTOR_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_index, tvb,\r\nAECP_OFFSET_ACQUIRE_ENTITY_DESCRIPTOR_INDEX, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AECP_COMMAND_LOCK_ENTITY:\r\nproto_tree_add_item(aecp_tree, hf_aecp_unlock_flag, tvb,\r\nAECP_OFFSET_LOCK_ENTITY_FLAGS, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_locked_guid, tvb,\r\nAECP_OFFSET_LOCK_ENTITY_LOCKED_GUID, 8, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AECP_COMMAND_READ_DESCRIPTOR:\r\nproto_tree_add_item(aecp_tree, hf_aecp_configuration, tvb,\r\nAECP_OFFSET_DESCRIPTOR_CONFIGURATION_INDEX, 2, ENC_BIG_ENDIAN);\r\nif ((mess_type == AECP_AEM_COMMAND_MESSAGE)||(mess_status != 0))\r\n{\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_type, tvb,\r\nAECP_OFFSET_DESCRIPTOR_DESCRIPTOR_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_index, tvb,\r\nAECP_OFFSET_DESCRIPTOR_DESCRIPTOR_INDEX, 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nnext_tvb = tvb_new_subset_remaining(tvb, AECP_OFFSET_DESCRIPTOR_DESCRIPTOR);\r\ndissect_17221_aem(next_tvb, pinfo, aecp_tree);\r\n}\r\nbreak;\r\ncase AECP_COMMAND_WRITE_DESCRIPTOR:\r\nproto_tree_add_item(aecp_tree, hf_aecp_configuration, tvb,\r\nAECP_OFFSET_DESCRIPTOR_CONFIGURATION_INDEX, 2, ENC_BIG_ENDIAN);\r\nnext_tvb = tvb_new_subset_remaining(tvb, AECP_OFFSET_DESCRIPTOR_DESCRIPTOR);\r\ndissect_17221_aem(next_tvb, pinfo, aecp_tree);\r\nbreak;\r\ncase AECP_COMMAND_SET_CONFIGURATION:\r\ncase AECP_COMMAND_GET_CONFIGURATION:\r\nproto_tree_add_item(aecp_tree, hf_aecp_configuration,\r\ntvb, AECP_OFFSET_CONFIGURATION_CONFIGURATION_INDEX, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AECP_COMMAND_SET_STREAM_FORMAT:\r\ncase AECP_COMMAND_GET_STREAM_FORMAT:\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_type, tvb,\r\nAECP_OFFSET_STREAM_FORMAT_DESCRIPTOR_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_index, tvb,\r\nAECP_OFFSET_STREAM_FORMAT_DESCRIPTOR_INDEX, 2, ENC_BIG_ENDIAN);\r\nif ((mess_type != AECP_AEM_COMMAND_MESSAGE)||(c_type == AECP_COMMAND_SET_STREAM_FORMAT))\r\n{\r\nnext_tvb = tvb_new_subset_length(tvb, AECP_OFFSET_STREAM_FORMAT_STREAM_FORMAT, 8);\r\ndissect_17221_stream_format(next_tvb, aecp_tree);\r\n}\r\nbreak;\r\ncase AECP_COMMAND_SET_VIDEO_FORMAT:\r\ncase AECP_COMMAND_GET_VIDEO_FORMAT:\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_type, tvb,\r\nAECP_OFFSET_VIDEO_FORMAT_DESCRIPTOR_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_index, tvb,\r\nAECP_OFFSET_VIDEO_FORMAT_DESCRIPTOR_INDEX, 2, ENC_BIG_ENDIAN);\r\nif ((mess_type != AECP_AEM_COMMAND_MESSAGE)||(c_type == AECP_COMMAND_SET_VIDEO_FORMAT))\r\n{\r\nnext_tvb = tvb_new_subset_length(tvb, AECP_OFFSET_VIDEO_FORMAT_FORMAT_SPECIFIC, 4);\r\ndissect_17221_video_format(next_tvb, aecp_tree);\r\nnext_tvb = tvb_new_subset_length(tvb, AECP_OFFSET_VIDEO_FORMAT_ASPECT_RATIO, 2);\r\ndissect_17221_video_aspect_ratio(next_tvb, aecp_tree);\r\nproto_tree_add_item(aecp_tree, hf_aem_color_space, tvb,\r\nAECP_OFFSET_VIDEO_FORMAT_COLOR_SPACE, 2, ENC_BIG_ENDIAN);\r\nnext_tvb = tvb_new_subset_length(tvb, AECP_OFFSET_VIDEO_FORMAT_FRAME_SIZE, 4);\r\ndissect_17221_video_frame_size(next_tvb, aecp_tree);\r\n}\r\nbreak;\r\ncase AECP_COMMAND_SET_SENSOR_FORMAT:\r\ncase AECP_COMMAND_GET_SENSOR_FORMAT:\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_type, tvb,\r\nAECP_OFFSET_SENSOR_FORMAT_DESCRIPTOR_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_index, tvb,\r\nAECP_OFFSET_SENSOR_FORMAT_DESCRIPTOR_INDEX, 2, ENC_BIG_ENDIAN);\r\nif ((mess_type != AECP_AEM_COMMAND_MESSAGE)||(c_type == AECP_COMMAND_SET_SENSOR_FORMAT))\r\n{\r\nnext_tvb = tvb_new_subset_length(tvb, AECP_OFFSET_SENSOR_FORMAT_SENSOR_FORMAT, 8);\r\ndissect_17221_sensor_format(next_tvb, aecp_tree);\r\n}\r\nbreak;\r\ncase AECP_COMMAND_SET_STREAM_INFO:\r\ncase AECP_COMMAND_GET_STREAM_INFO:\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_type, tvb,\r\nAECP_OFFSET_STREAM_INFO_DESCRIPTOR_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_index, tvb,\r\nAECP_OFFSET_STREAM_INFO_DESCRIPTOR_INDEX, 2, ENC_BIG_ENDIAN);\r\nif ((mess_type == AECP_AEM_RESPONSE_MESSAGE) || (c_type == AECP_COMMAND_SET_STREAM_INFO)) {\r\nproto_tree_add_item(aecp_tree, hf_acmp_flags_class_b, tvb,\r\nAECP_OFFSET_STREAM_INFO_FLAGS, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_acmp_flags_fast_connect, tvb,\r\nAECP_OFFSET_STREAM_INFO_FLAGS, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_acmp_flags_saved_state, tvb,\r\nAECP_OFFSET_STREAM_INFO_FLAGS, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_acmp_flags_streaming_wait, tvb,\r\nAECP_OFFSET_STREAM_INFO_FLAGS, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_acmp_flags_supports_encrypted, tvb,\r\nAECP_OFFSET_STREAM_INFO_FLAGS, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_acmp_flags_encrypted_pdu, tvb,\r\nAECP_OFFSET_STREAM_INFO_FLAGS, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_acmp_flags_talker_failed, tvb,\r\nAECP_OFFSET_STREAM_INFO_FLAGS, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_vlan_id_valid_flag, tvb,\r\nAECP_OFFSET_STREAM_INFO_FLAGS, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_connected_flag, tvb,\r\nAECP_OFFSET_STREAM_INFO_FLAGS, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_msrp_failure_valid_flag, tvb,\r\nAECP_OFFSET_STREAM_INFO_FLAGS, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_dest_mac_valid_flag, tvb,\r\nAECP_OFFSET_STREAM_INFO_FLAGS, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_msrp_acc_lat_valid_flag, tvb,\r\nAECP_OFFSET_STREAM_INFO_FLAGS, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_id_valid_flag, tvb,\r\nAECP_OFFSET_STREAM_INFO_FLAGS, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_format_valid_flag, tvb,\r\nAECP_OFFSET_STREAM_INFO_FLAGS, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_format, tvb,\r\nAECP_OFFSET_STREAM_INFO_STREAM_FORMAT, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_acmp_stream_id, tvb,\r\nAECP_OFFSET_STREAM_INFO_STREAM_ID, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_msrp_accumulated_latency, tvb,\r\nAECP_OFFSET_STREAM_INFO_MSRP_ACCUMULATED_LATENCY, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_acmp_stream_dest_mac, tvb,\r\nAECP_OFFSET_STREAM_INFO_STREAM_DEST_MAC, 6, ENC_NA);\r\nproto_tree_add_item(aecp_tree, hf_aecp_msrp_failure_code, tvb,\r\nAECP_OFFSET_STREAM_INFO_MSRP_FAILURE_CODE, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_msrp_failure_bridge_id, tvb,\r\nAECP_OFFSET_STREAM_INFO_MSRP_FAILURE_BRIDGE_ID, 8, ENC_NA);\r\n}\r\nbreak;\r\ncase AECP_COMMAND_SET_NAME:\r\ncase AECP_COMMAND_GET_NAME:\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_type, tvb,\r\nAECP_OFFSET_NAME_DESCRIPTOR_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_index, tvb,\r\nAECP_OFFSET_NAME_DESCRIPTOR_INDEX, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_name_index, tvb,\r\nAECP_OFFSET_NAME_NAME_INDEX, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_configuration_index, tvb,\r\nAECP_OFFSET_NAME_CONFIGURATION_INDEX, 2, ENC_BIG_ENDIAN);\r\nif ((mess_type == AECP_AEM_RESPONSE_MESSAGE) || (c_type == AECP_COMMAND_SET_NAME)) {\r\nproto_tree_add_item(aecp_tree, hf_aecp_name, tvb,\r\nAECP_OFFSET_NAME_NAME, 64, ENC_ASCII|ENC_NA);\r\n}\r\nbreak;\r\ncase AECP_COMMAND_SET_ASSOCIATION_ID:\r\ncase AECP_COMMAND_GET_ASSOCIATION_ID:\r\nproto_tree_add_item(aecp_tree, hf_aecp_association_id, tvb,\r\nAECP_OFFSET_ASSOCIATION_ID_ASSOCIATION_ID, 8, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AECP_COMMAND_SET_SAMPLING_RATE:\r\ncase AECP_COMMAND_GET_SAMPLING_RATE:\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_type, tvb,\r\nAECP_OFFSET_SAMPLING_RATE_DESCRIPTOR_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_index, tvb,\r\nAECP_OFFSET_SAMPLING_RATE_DESCRIPTOR_INDEX, 2, ENC_BIG_ENDIAN);\r\nif ((mess_type == AECP_AEM_RESPONSE_MESSAGE) || (c_type == AECP_COMMAND_SET_SAMPLING_RATE)) {\r\nproto_tree_add_item(aecp_tree,hf_aecp_sampling_rate_pull , tvb,\r\nAECP_OFFSET_SAMPLING_RATE_SAMPLING_RATE, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_sampling_rate_base_frequency, tvb,\r\nAECP_OFFSET_SAMPLING_RATE_SAMPLING_RATE, 4, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase AECP_COMMAND_SET_CLOCK_SOURCE:\r\ncase AECP_COMMAND_GET_CLOCK_SOURCE:\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_type, tvb,\r\nAECP_OFFSET_CLOCK_SOURCE_DESCRIPTOR_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_index, tvb,\r\nAECP_OFFSET_CLOCK_SOURCE_DESCRIPTOR_INDEX, 2, ENC_BIG_ENDIAN);\r\nif ((mess_type == AECP_AEM_RESPONSE_MESSAGE) || (c_type == AECP_COMMAND_SET_CLOCK_SOURCE)) {\r\nproto_tree_add_item(aecp_tree, hf_aem_clock_source_id, tvb,\r\nAECP_OFFSET_CLOCK_SOURCE_CLOCK_SOURCE_INDEX, 2, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase AECP_COMMAND_SET_CONTROL_VALUE:\r\ncase AECP_COMMAND_GET_CONTROL_VALUE:\r\ncase AECP_COMMAND_SET_MIXER:\r\ncase AECP_COMMAND_GET_MIXER:\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_type, tvb,\r\nAECP_OFFSET_CONTROL_DESCRIPTOR_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_index, tvb,\r\nAECP_OFFSET_CONTROL_DESCRIPTOR_INDEX, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AECP_COMMAND_INCREMENT_CONTROL:\r\ncase AECP_COMMAND_DECREMENT_CONTROL:\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_type, tvb,\r\nAECP_OFFSET_INCDEC_CONTROL_DESCRIPTOR_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_index, tvb,\r\nAECP_OFFSET_INCDEC_CONTROL_DESCRIPTOR_INDEX, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AECP_COMMAND_SET_SIGNAL_SELECTOR:\r\ncase AECP_COMMAND_GET_SIGNAL_SELECTOR:\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_type, tvb,\r\nAECP_OFFSET_SIGNAL_SELECTOR_DESCRIPTOR_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_index, tvb,\r\nAECP_OFFSET_SIGNAL_SELECTOR_DESCRIPTOR_INDEX, 2, ENC_BIG_ENDIAN);\r\nif ((mess_type == AECP_AEM_RESPONSE_MESSAGE) || (c_type == AECP_COMMAND_SET_SIGNAL_SELECTOR)) {\r\nproto_tree_add_item(aecp_tree, hf_aecp_signal_type, tvb,\r\nAECP_OFFSET_SIGNAL_SELECTOR_SIGNAL_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_signal_index, tvb,\r\nAECP_OFFSET_SIGNAL_SELECTOR_SIGNAL_INDEX, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_signal_output, tvb,\r\nAECP_OFFSET_SIGNAL_SELECTOR_SIGNAL_OUTPUT, 2, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase AECP_COMMAND_GET_MATRIX:\r\ncase AECP_COMMAND_SET_MATRIX:\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_type, tvb,\r\nAECP_OFFSET_MATRIX_DESCRIPTOR_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_index, tvb,\r\nAECP_OFFSET_MATRIX_DESCRIPTOR_INDEX, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_matrix_column, tvb,\r\nAECP_OFFSET_MATRIX_MATRIX_COLUMN, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_matrix_row, tvb,\r\nAECP_OFFSET_MATRIX_MATRIX_ROW, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_matrix_region_width, tvb,\r\nAECP_OFFSET_MATRIX_REGION_WIDTH, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_matrix_region_height, tvb, AECP_OFFSET_MATRIX_REGION_HEIGHT, 2, ENC_BIG_ENDIAN); proto_tree_add_item(aecp_tree, hf_aecp_matrix_rep, tvb,\r\nAECP_OFFSET_MATRIX_REP, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_matrix_direction, tvb,\r\nAECP_OFFSET_MATRIX_DIRECTION, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_matrix_value_count, tvb,\r\nAECP_OFFSET_MATRIX_VALUE_COUNT, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_matrix_item_offset, tvb,\r\nAECP_OFFSET_MATRIX_ITEM_OFFSET, 2, ENC_BIG_ENDIAN);\r\nif ((mess_type == AECP_AEM_RESPONSE_MESSAGE) || (c_type == AECP_COMMAND_GET_MATRIX)) {\r\n}\r\nbreak;\r\ncase AECP_COMMAND_START_STREAMING:\r\ncase AECP_COMMAND_STOP_STREAMING:\r\ncase AECP_COMMAND_REBOOT:\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_type, tvb,\r\nAECP_OFFSET_STREAMING_DESCRIPTOR_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_index, tvb,\r\nAECP_OFFSET_STREAMING_DESCRIPTOR_INDEX, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AECP_COMMAND_REGISTER_UNSOL_NOTIFICATION:\r\ncase AECP_COMMAND_DEREGISTER_UNSOL_NOTIFICATION:\r\nbreak;\r\ncase AECP_COMMAND_IDENTIFY_NOTIFICATION:\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_type, tvb,\r\nAECP_OFFSET_IDENTIFY_NOTIFICATION_DESCRIPTOR_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_index, tvb,\r\nAECP_OFFSET_IDENTIFY_NOTIFICATION_DESCRIPTOR_INDEX, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AECP_COMMAND_GET_AVB_INFO:\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_type, tvb,\r\nAECP_OFFSET_AVB_INFO_DESCRIPTOR_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_index, tvb,\r\nAECP_OFFSET_AVB_INFO_DESCRIPTOR_INDEX, 2, ENC_BIG_ENDIAN);\r\nif (mess_type == AECP_AEM_RESPONSE_MESSAGE) {\r\nproto_tree_add_item(aecp_tree, hf_aecp_avb_info_ptp_grandmaster_id, tvb,\r\nAECP_OFFSET_AVB_INFO_AS_GRANDMASTER_ID, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_avb_info_propegation_delay, tvb,\r\nAECP_OFFSET_AVB_INFO_PROPAGATION_DELAY, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_avb_info_gptp_domain_number, tvb,\r\nAECP_OFFSET_AVB_INFO_AS_DOMAIN_NUMBER, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_as_capable_flag, tvb,\r\nAECP_OFFSET_AVB_INFO_FLAGS, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_gptp_enabled_flag, tvb,\r\nAECP_OFFSET_AVB_INFO_FLAGS, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_srp_enabled_flag, tvb,\r\nAECP_OFFSET_AVB_INFO_FLAGS, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_avb_info_msrp_mappings_count, tvb,\r\nAECP_OFFSET_AVB_INFO_MSRP_MAPPINGS_COUNT, 2, ENC_BIG_ENDIAN);\r\nmr_item = proto_tree_add_item(aecp_tree, hf_aecp_avb_info_msrp_mappings, tvb,\r\n0, 0, ENC_NA);\r\nmr_subtree = proto_item_add_subtree(mr_item, ett_aecp_get_avb_info_msrp_mappings);\r\nmr_counter = tvb_get_ntohs(tvb, AECP_OFFSET_AVB_INFO_MSRP_MAPPINGS_COUNT);\r\nmr_offset = AECP_OFFSET_AVB_INFO_MSRP_MAPPINGS;\r\nfor (i = 0; i < mr_counter; i++) {\r\nproto_tree_add_item(mr_subtree, hf_aecp_avb_info_msrp_mapping_traffic_class, tvb,\r\nmr_offset, 1, ENC_BIG_ENDIAN);\r\nmr_offset += 1;\r\nproto_tree_add_item(mr_subtree, hf_aecp_avb_info_msrp_mapping_priority, tvb,\r\nmr_offset, 1, ENC_BIG_ENDIAN);\r\nmr_offset += 1;\r\nproto_tree_add_item(mr_subtree, hf_aecp_get_avb_info_msrp_vlan_id, tvb,\r\nmr_offset, 2, ENC_BIG_ENDIAN);\r\nmr_offset += 2;\r\n}\r\n}\r\nbreak;\r\ncase AECP_COMMAND_GET_AS_PATH:\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_index, tvb,\r\nAECP_OFFSET_AS_PATH_DESCRIPTOR_INDEX, 2, ENC_BIG_ENDIAN);\r\nif (mess_type == AECP_AEM_RESPONSE_MESSAGE) {\r\nproto_tree_add_item(aecp_tree, hf_aecp_as_path_count, tvb,\r\nAECP_OFFSET_AS_PATH_COUNT, 2, ENC_BIG_ENDIAN);\r\nmr_item = proto_tree_add_item(aecp_tree, hf_aecp_as_path_sequences, tvb,\r\n0, 0, ENC_NA);\r\nmr_subtree = proto_item_add_subtree(mr_item, ett_aecp_get_as_path_sequences);\r\nmr_counter = tvb_get_ntohs(tvb, AECP_OFFSET_AS_PATH_COUNT);\r\nmr_offset = AECP_OFFSET_AS_PATH_PATH_SEQUENCE;\r\nfor (i = 0; i < mr_counter; i++) {\r\nproto_tree_add_item(mr_subtree, hf_aecp_get_as_info_clock_id, tvb,\r\nmr_offset, 8, ENC_BIG_ENDIAN);\r\nmr_offset += 8;\r\n}\r\n}\r\nbreak;\r\ncase AECP_COMMAND_GET_COUNTERS:\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_type, tvb,\r\nAECP_OFFSET_COUNTERS_DESCRIPTOR_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_index, tvb,\r\nAECP_OFFSET_COUNTERS_DESCRIPTOR_INDEX, 2, ENC_BIG_ENDIAN);\r\nif (mess_type == AECP_AEM_RESPONSE_MESSAGE) {\r\nproto_tree_add_item(aecp_tree, hf_aecp_flags_32, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nswitch (tvb_get_ntohs(tvb, AECP_OFFSET_COUNTERS_DESCRIPTOR_TYPE)) {\r\ncase AEM_DESCRIPTOR_ENTITY:\r\nbreak;\r\ncase AEM_DESCRIPTOR_AVB_INTERFACE:\r\nproto_tree_add_item(aecp_tree, hf_aecp_avb_interface_link_up_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_avb_interface_link_down_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_avb_interface_packets_tx_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_avb_interface_packets_rx_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_avb_interface_rx_crc_error_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_avb_interface_gptp_gm_changed_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AEM_DESCRIPTOR_CLOCK_DOMAIN:\r\nproto_tree_add_item(aecp_tree, hf_aecp_clock_domain_locked_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_clock_domain_unlocked_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AEM_DESCRIPTOR_STREAM_INPUT:\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_input_media_locked_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_input_media_unlocked_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_input_stream_reset_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_input_seq_num_mismatch_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_input_media_reset_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_input_timestamp_uncertain_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_input_timestamp_valid_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_input_timestamp_not_valid_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_input_unsupported_format_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_input_late_timestamp_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_input_early_timestamp_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_input_packets_tx_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_input_packets_rx_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nproto_tree_add_item(aecp_tree, hf_aecp_entity_specific1_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_entity_specific2_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_entity_specific3_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_entity_specific4_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_entity_specific5_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_entity_specific6_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_entity_specific7_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_entity_specific8_valid, tvb,\r\nAECP_OFFSET_COUNTERS_VALID, 4, ENC_BIG_ENDIAN);\r\nswitch (tvb_get_ntohs(tvb, AECP_OFFSET_COUNTERS_DESCRIPTOR_TYPE)) {\r\ncase AEM_DESCRIPTOR_ENTITY:\r\nbreak;\r\ncase AEM_DESCRIPTOR_AVB_INTERFACE:\r\nproto_tree_add_item(aecp_tree, hf_aecp_avb_interface_link_up, tvb,\r\nAECP_OFFSET_COUNTERS_AVB_INTERFACE_LINK_UP, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_avb_interface_link_down, tvb,\r\nAECP_OFFSET_COUNTERS_AVB_INTERFACE_LINK_DOWN, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_avb_interface_packets_tx, tvb,\r\nAECP_OFFSET_COUNTERS_AVB_INTERFACE_PACKETS_TX, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_avb_interface_packets_rx, tvb,\r\nAECP_OFFSET_COUNTERS_AVB_INTERFACE_PACKETS_RX, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_avb_interface_rx_crc_error, tvb,\r\nAECP_OFFSET_COUNTERS_AVB_INTERFACE_RX_CRC_ERROR, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_avb_interface_gptp_gm_changed, tvb,\r\nAECP_OFFSET_COUNTERS_AVB_INTERFACE_GPTP_GM_CHANGED, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AEM_DESCRIPTOR_CLOCK_DOMAIN:\r\nproto_tree_add_item(aecp_tree, hf_aecp_clock_domain_locked, tvb,\r\nAECP_OFFSET_COUNTERS_CLOCK_DOMAIN_LOCKED, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_clock_domain_unlocked, tvb,\r\nAECP_OFFSET_COUNTERS_CLOCK_DOMAIN_UNLOCKED, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AEM_DESCRIPTOR_STREAM_INPUT:\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_input_media_locked, tvb,\r\nAECP_OFFSET_COUNTERS_STREAM_INPUT_MEDIA_LOCKED, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_input_media_unlocked, tvb,\r\nAECP_OFFSET_COUNTERS_STREAM_INPUT_MEDIA_UNLOCKED, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_input_stream_reset, tvb,\r\nAECP_OFFSET_COUNTERS_STREAM_INPUT_STREAM_RESET, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_input_seq_num_mismatch, tvb,\r\nAECP_OFFSET_COUNTERS_STREAM_INPUT_SEQ_NUM_MISMATCH, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_input_media_reset, tvb,\r\nAECP_OFFSET_COUNTERS_STREAM_INPUT_MEDIA_RESET, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_input_timestamp_uncertain, tvb,\r\nAECP_OFFSET_COUNTERS_STREAM_INPUT_TIMESTAMP_UNCERTAIN, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_input_timestamp_valid, tvb,\r\nAECP_OFFSET_COUNTERS_STREAM_INPUT_TIMESTAMP_VALID, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_input_timestamp_not_valid, tvb,\r\nAECP_OFFSET_COUNTERS_STREAM_INPUT_TIMESTAMP_NOT_VALID, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_input_unsupported_format, tvb,\r\nAECP_OFFSET_COUNTERS_STREAM_INPUT_UNSUPPORTED_FORMAT, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_input_late_timestamp, tvb,\r\nAECP_OFFSET_COUNTERS_STREAM_INPUT_LATE_TIMESTAMP, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_input_early_timestamp, tvb,\r\nAECP_OFFSET_COUNTERS_STREAM_INPUT_EARLY_TIMESTAMP, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_input_packets_tx, tvb,\r\nAECP_OFFSET_COUNTERS_STREAM_INPUT_PACKETS_TX, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_stream_input_packets_rx, tvb,\r\nAECP_OFFSET_COUNTERS_STREAM_INPUT_PACKETS_RX, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nproto_tree_add_item(aecp_tree, hf_aecp_entity_specific1, tvb,\r\nAECP_OFFSET_COUNTERS_ENTITY_SPECIFIC_1, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_entity_specific2, tvb,\r\nAECP_OFFSET_COUNTERS_ENTITY_SPECIFIC_2, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_entity_specific3, tvb,\r\nAECP_OFFSET_COUNTERS_ENTITY_SPECIFIC_3, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_entity_specific4, tvb,\r\nAECP_OFFSET_COUNTERS_ENTITY_SPECIFIC_4, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_entity_specific5, tvb,\r\nAECP_OFFSET_COUNTERS_ENTITY_SPECIFIC_5, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_entity_specific6, tvb,\r\nAECP_OFFSET_COUNTERS_ENTITY_SPECIFIC_6, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_entity_specific7, tvb,\r\nAECP_OFFSET_COUNTERS_ENTITY_SPECIFIC_7, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_entity_specific8, tvb,\r\nAECP_OFFSET_COUNTERS_ENTITY_SPECIFIC_8, 4, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase AECP_COMMAND_GET_AUDIO_MAP:\r\ncase AECP_COMMAND_GET_VIDEO_MAP:\r\ncase AECP_COMMAND_GET_SENSOR_MAP:\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_type, tvb,\r\nAECP_OFFSET_MAP_DESCRIPTOR_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_index, tvb,\r\nAECP_OFFSET_MAP_DESCRIPTOR_INDEX, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_map_index, tvb,\r\nAECP_OFFSET_MAP_MAP_INDEX, 2, ENC_BIG_ENDIAN);\r\nif (mess_type == AECP_AEM_RESPONSE_MESSAGE) {\r\nproto_tree_add_item(aecp_tree, hf_aecp_number_of_maps, tvb,\r\nAECP_OFFSET_MAP_NUMBER_OF_MAPS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_number_of_maps, tvb,\r\nAECP_OFFSET_MAP_NUMBER_OF_MAPPINGS, 2, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase AECP_COMMAND_ADD_AUDIO_MAPPINGS:\r\ncase AECP_COMMAND_REMOVE_AUDIO_MAPPINGS:\r\ncase AECP_COMMAND_ADD_VIDEO_MAPPINGS:\r\ncase AECP_COMMAND_REMOVE_VIDEO_MAPPINGS:\r\ncase AECP_COMMAND_ADD_SENSOR_MAPPINGS:\r\ncase AECP_COMMAND_REMOVE_SENSOR_MAPPINGS:\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_type, tvb,\r\nAECP_OFFSET_ADDREM_MAP_DESCRIPTOR_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_index, tvb,\r\nAECP_OFFSET_ADDREM_MAP_DESCRIPTOR_INDEX, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_number_of_maps, tvb,\r\nAECP_OFFSET_ADDREM_MAP_NUMBER_OF_MAPPINGS, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AECP_COMMAND_START_OPERATION:\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_type, tvb,\r\nAECP_OFFSET_START_OPERATION_DESCRIPTOR_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_index, tvb,\r\nAECP_OFFSET_START_OPERATION_DESCRIPTOR_INDEX, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_operation_id, tvb,\r\nAECP_OFFSET_START_OPERATION_OPERATION_ID, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_operation_type, tvb,\r\nAECP_OFFSET_START_OPERATION_OPERATION_TYPE, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AECP_COMMAND_ABORT_OPERATION:\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_type, tvb,\r\nAECP_OFFSET_ABORT_OPERATION_DESCRIPTOR_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_index, tvb,\r\nAECP_OFFSET_ABORT_OPERATION_DESCRIPTOR_INDEX, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_operation_id, tvb,\r\nAECP_OFFSET_ABORT_OPERATION_OPERATION_ID, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AECP_COMMAND_OPERATION_STATUS:\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_type, tvb,\r\nAECP_OFFSET_OPERATION_STATUS_DESCRIPTOR_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_index, tvb,\r\nAECP_OFFSET_OPERATION_STATUS_DESCRIPTOR_INDEX, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_operation_id, tvb,\r\nAECP_OFFSET_OPERATION_STATUS_OPERATION_ID, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_percent_complete, tvb,\r\nAECP_OFFSET_OPERATION_STATUS_PERCENT_COMPLETE, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AECP_COMMAND_AUTH_ADD_KEY:\r\ncase AECP_COMMAND_AUTH_DELETE_KEY:\r\ncase AECP_COMMAND_AUTH_GET_KEY:\r\nproto_tree_add_item(aecp_tree, hf_aecp_key_eui, tvb,\r\nAECP_OFFSET_AUTH_KEY_KEY_EUI, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_key_type, tvb,\r\nAECP_OFFSET_AUTH_KEY_KEY_TYPE, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_key_length, tvb,\r\nAECP_OFFSET_AUTH_KEY_KEY_LENGTH, 2, ENC_BIG_ENDIAN);\r\nif (((mess_type == AECP_AEM_RESPONSE_MESSAGE) && (c_type == AECP_COMMAND_AUTH_GET_KEY)) ||\r\n((mess_type == AECP_AEM_COMMAND_MESSAGE) && (c_type == AECP_COMMAND_AUTH_ADD_KEY))) {\r\nmr_counter = tvb_get_ntohs(tvb, AECP_OFFSET_AUTH_KEY_KEY_LENGTH) & AECP_KEY_LENGTH_MASK;\r\nproto_tree_add_item(aecp_tree, hf_aecp_key, tvb,\r\nAECP_OFFSET_AUTH_KEY_KEY, mr_counter, ENC_NA);\r\n}\r\nbreak;\r\ncase AECP_COMMAND_AUTH_GET_KEY_LIST:\r\nproto_tree_add_item(aecp_tree, hf_aecp_keychain_id_small, tvb,\r\nAECP_OFFSET_AUTH_GET_KEY_LIST_KEYCHAIN_ID, 1, ENC_BIG_ENDIAN);\r\nif (mess_type == AECP_AEM_RESPONSE_MESSAGE) {\r\nproto_tree_add_item(aecp_tree, hf_aecp_keychain_id_small, tvb,\r\nAECP_OFFSET_AUTH_GET_KEY_LIST_NUMBER_OF_KEYS, 1, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase AECP_COMMAND_AUTH_ADD_KEY_TO_CHAIN:\r\ncase AECP_COMMAND_AUTH_DELETE_KEY_FROM_CHAIN:\r\nproto_tree_add_item(aecp_tree, hf_aecp_keychain_id, tvb,\r\nAECP_OFFSET_AUTH_KEYCHAIN_KEYCHAIN_ID, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_key_eui, tvb,\r\nAECP_OFFSET_AUTH_KEYCHAIN_KEY_EUI, 8, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AECP_COMMAND_AUTH_GET_KEYCHAIN_LIST:\r\nproto_tree_add_item(aecp_tree, hf_aecp_keychain_id, tvb,\r\nAECP_OFFSET_AUTH_GET_KEYCHAIN_LIST_KEYCHAIN_ID, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_keychain_list_index, tvb,\r\nAECP_OFFSET_AUTH_GET_KEYCHAIN_LIST_LIST_INDEX, 2, ENC_BIG_ENDIAN);\r\nif (mess_type == AECP_AEM_RESPONSE_MESSAGE) {\r\nproto_tree_add_item(aecp_tree, hf_aecp_keychain_number_of_lists, tvb,\r\nAECP_OFFSET_AUTH_GET_KEYCHAIN_LIST_NUMBER_OF_LISTS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_keychain_number_of_keys, tvb,\r\nAECP_OFFSET_AUTH_GET_KEYCHAIN_LIST_NUMBER_OF_KEYS, 2, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase AECP_COMMAND_AUTH_GET_IDENTITY:\r\nproto_tree_add_item(aecp_tree, hf_aecp_key_eui, tvb,\r\nAECP_OFFSET_AUTH_GET_IDENTITY_KEY_GUID, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_key_signature, tvb,\r\nAECP_OFFSET_AUTH_GET_IDENTITY_SIGNATURE, 28, ENC_NA);\r\nbreak;\r\ncase AECP_COMMAND_AUTH_ADD_TOKEN:\r\nif (mess_type == AECP_AEM_COMMAND_MESSAGE) {\r\nguint32 token_length = tvb_get_ntohl(tvb, AECP_OFFSET_AUTH_TOKEN_TOKEN_LENGTH);\r\nproto_tree_add_item(aecp_tree, hf_aecp_key_length, tvb,\r\nAECP_OFFSET_AUTH_TOKEN_TOKEN_LENGTH, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_key_signature, tvb,\r\nAECP_OFFSET_AUTH_TOKEN_AUTHENTICATION_TOKEN, token_length, ENC_NA);\r\n}\r\nbreak;\r\ncase AECP_COMMAND_AUTH_DELETE_TOKEN:\r\nbreak;\r\ncase AECP_COMMAND_AUTHENTICATE:\r\ncase AECP_COMMAND_DEAUTHENTICATE:\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_type, tvb,\r\nAECP_OFFSET_AUTHENTICATE_DESCRIPTOR_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_index, tvb,\r\nAECP_OFFSET_AUTHENTICATE_DESCRIPTOR_INDEX, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_token_length, tvb,\r\nAECP_OFFSET_AUTHENTICATE_TOKEN_LENGTH, 2, ENC_BIG_ENDIAN);\r\nmr_counter = tvb_get_ntohs(tvb, AECP_OFFSET_AUTHENTICATE_TOKEN_LENGTH)\r\n& AECP_TOKEN_LENGTH_MASK;\r\nproto_tree_add_item(aecp_tree, hf_aecp_auth_token, tvb,\r\nAECP_OFFSET_AUTHENTICATE_AUTH_TOKEN, mr_counter, ENC_NA);\r\nbreak;\r\ncase AECP_COMMAND_ENABLE_TRANSPORT_SECURITY:\r\nproto_tree_add_item(aecp_tree, hf_aecp_key_eui, tvb,\r\nAECP_OFFSET_TRANSPORT_SECURITY_KEY_EUI, 8, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AECP_COMMAND_DISABLE_TRANSPORT_SECURITY:\r\nbreak;\r\ncase AECP_COMMAND_ENABLE_STREAM_ENCRYPTION:\r\ncase AECP_COMMAND_DISABLE_STREAM_ENCRYPTION:\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_type, tvb,\r\nAECP_OFFSET_STREAM_ENCRYPTION_DESCRIPTOR_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_index, tvb,\r\nAECP_OFFSET_STREAM_ENCRYPTION_DESCRIPTOR_INDEX, 2, ENC_BIG_ENDIAN);\r\nif (c_type == AECP_COMMAND_ENABLE_STREAM_ENCRYPTION) {\r\nproto_tree_add_item(aecp_tree, hf_aecp_key_eui, tvb,\r\nAECP_OFFSET_STREAM_ENCRYPTION_KEY_EUI, 8, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase AECP_COMMAND_SET_STREAM_BACKUP:\r\ncase AECP_COMMAND_GET_STREAM_BACKUP:\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_type, tvb,\r\nAECP_OFFSET_STREAM_BACKUP_DESCRIPTOR_TYPE, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_descriptor_index, tvb,\r\nAECP_OFFSET_STREAM_BACKUP_DESCRIPTOR_INDEX, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_backup_talker_entity_id_0, tvb,\r\nAECP_OFFSET_STREAM_BACKUP_TALKER_ENTITY_ID_0, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_backup_talker_unique_id_0, tvb,\r\nAECP_OFFSET_STREAM_BACKUP_TALKER_UNIQUE_ID_0, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_backup_talker_entity_id_1, tvb,\r\nAECP_OFFSET_STREAM_BACKUP_TALKER_ENTITY_ID_1, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_backup_talker_unique_id_1, tvb,\r\nAECP_OFFSET_STREAM_BACKUP_TALKER_UNIQUE_ID_1, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_backup_talker_entity_id_2, tvb,\r\nAECP_OFFSET_STREAM_BACKUP_TALKER_ENTITY_ID_2, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_backup_talker_unique_id_2, tvb,\r\nAECP_OFFSET_STREAM_BACKUP_TALKER_UNIQUE_ID_2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_backedup_talker_entity_id, tvb,\r\nAECP_OFFSET_STREAM_BACKEDUP_TALKER_ENTITY_ID, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_backedup_talker_unique_id, tvb,\r\nAECP_OFFSET_STREAM_BACKEDUP_TALKER_UNIQUE_ID, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase AECP_COMMAND_CONTROLLER_AVAILABLE:\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\nelse if ((mess_type == AECP_ADDRESS_ACCESS_COMMAND_MESSAGE) || (mess_type == AECP_ADDRESS_ACCESS_RESPONSE_MESSAGE))\r\n{\r\nproto_tree_add_item(aecp_tree, hf_aecp_aa_count, tvb,\r\nAECP_AA_OFFSET_COUNT, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_aa_tlv_mode, tvb,\r\nAECP_AA_OFFSET_TLVS_START, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_aa_tlv_length, tvb,\r\nAECP_AA_OFFSET_TLVS_START, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aecp_tree, hf_aecp_aa_tlv_address, tvb,\r\nAECP_AA_OFFSET_TLVS_START+2, 8, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_17221_adp(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *adp_tree)\r\n{\r\nproto_item *ent_cap_ti;\r\nproto_item *talk_cap_ti;\r\nproto_item *list_cap_ti;\r\nproto_item *cont_cap_ti;\r\nproto_tree *ent_cap_flags_tree;\r\nproto_tree *talk_cap_flags_tree;\r\nproto_tree *list_cap_flags_tree;\r\nproto_tree *cont_cap_flags_tree;\r\nproto_tree_add_item(adp_tree, hf_adp_message_type, tvb, ADP_VERSION_OFFSET, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(adp_tree, hf_adp_valid_time, tvb, ADP_VALID_TIME_OFFSET, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(adp_tree, hf_adp_cd_length, tvb, ADP_CD_LENGTH_OFFSET, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(adp_tree, hf_adp_entity_id, tvb, ADP_ENTITY_ID_OFFSET, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(adp_tree, hf_adp_entity_model_id, tvb, ADP_ENTITY_MODEL_ID_OFFSET, 8, ENC_BIG_ENDIAN);\r\nent_cap_ti = proto_tree_add_item(adp_tree, hf_adp_entity_cap, tvb, ADP_ENTITY_CAP_OFFSET, 4, ENC_BIG_ENDIAN);\r\nent_cap_flags_tree = proto_item_add_subtree(ent_cap_ti, ett_adp_ent_cap);\r\nproto_tree_add_item(ent_cap_flags_tree,\r\nhf_adp_entity_cap_efu_mode, tvb, ADP_ENTITY_CAP_OFFSET, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ent_cap_flags_tree,\r\nhf_adp_entity_cap_address_access_supported, tvb, ADP_ENTITY_CAP_OFFSET, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ent_cap_flags_tree,\r\nhf_adp_entity_cap_gateway_entity, tvb, ADP_ENTITY_CAP_OFFSET, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ent_cap_flags_tree,\r\nhf_adp_entity_cap_aem_supported, tvb, ADP_ENTITY_CAP_OFFSET, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ent_cap_flags_tree,\r\nhf_adp_entity_cap_legacy_avc, tvb, ADP_ENTITY_CAP_OFFSET, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ent_cap_flags_tree,\r\nhf_adp_entity_cap_assoc_id_support, tvb, ADP_ENTITY_CAP_OFFSET, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ent_cap_flags_tree,\r\nhf_adp_entity_cap_assoc_id_valid, tvb, ADP_ENTITY_CAP_OFFSET, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ent_cap_flags_tree,\r\nhf_adp_entity_cap_vendor_unique, tvb, ADP_ENTITY_CAP_OFFSET, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ent_cap_flags_tree,\r\nhf_adp_entity_cap_class_a_supported, tvb, ADP_ENTITY_CAP_OFFSET, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ent_cap_flags_tree,\r\nhf_adp_entity_cap_class_b_supported, tvb, ADP_ENTITY_CAP_OFFSET, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ent_cap_flags_tree,\r\nhf_adp_entity_cap_gptp_supported, tvb, ADP_ENTITY_CAP_OFFSET, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(adp_tree, hf_adp_talker_stream_srcs, tvb, ADP_TALKER_STREAM_SRCS_OFFSET, 2, ENC_BIG_ENDIAN);\r\ntalk_cap_ti = proto_tree_add_item(adp_tree, hf_adp_talker_cap, tvb, ADP_TALKER_CAP_OFFSET, 2, ENC_BIG_ENDIAN);\r\ntalk_cap_flags_tree = proto_item_add_subtree(talk_cap_ti, ett_adp_talk_cap);\r\nproto_tree_add_item(talk_cap_flags_tree,\r\nhf_adp_talk_cap_implement, tvb, ADP_TALKER_CAP_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(talk_cap_flags_tree,\r\nhf_adp_talk_cap_other_src, tvb, ADP_TALKER_CAP_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(talk_cap_flags_tree,\r\nhf_adp_talk_cap_control_src, tvb, ADP_TALKER_CAP_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(talk_cap_flags_tree,\r\nhf_adp_talk_cap_media_clk_src, tvb, ADP_TALKER_CAP_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(talk_cap_flags_tree,\r\nhf_adp_talk_cap_smpte_src, tvb, ADP_TALKER_CAP_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(talk_cap_flags_tree,\r\nhf_adp_talk_cap_midi_src, tvb, ADP_TALKER_CAP_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(talk_cap_flags_tree,\r\nhf_adp_talk_cap_audio_src, tvb, ADP_TALKER_CAP_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(talk_cap_flags_tree,\r\nhf_adp_talk_cap_video_src, tvb, ADP_TALKER_CAP_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(adp_tree, hf_adp_listener_stream_sinks,\r\ntvb, ADP_LISTENER_STREAM_SINKS_OFFSET, 2, ENC_BIG_ENDIAN);\r\nlist_cap_ti = proto_tree_add_item(adp_tree, hf_adp_listener_cap, tvb, ADP_LISTENER_CAP_OFFSET, 2, ENC_BIG_ENDIAN);\r\nlist_cap_flags_tree = proto_item_add_subtree(list_cap_ti, ett_adp_list_cap);\r\nproto_tree_add_item(list_cap_flags_tree,\r\nhf_adp_list_cap_implement, tvb, ADP_LISTENER_CAP_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(list_cap_flags_tree,\r\nhf_adp_list_cap_other_sink, tvb, ADP_LISTENER_CAP_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(list_cap_flags_tree,\r\nhf_adp_list_cap_control_sink, tvb, ADP_LISTENER_CAP_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(list_cap_flags_tree,\r\nhf_adp_list_cap_media_clk_sink, tvb, ADP_LISTENER_CAP_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(list_cap_flags_tree,\r\nhf_adp_list_cap_smpte_sink, tvb, ADP_LISTENER_CAP_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(list_cap_flags_tree,\r\nhf_adp_list_cap_midi_sink, tvb, ADP_LISTENER_CAP_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(list_cap_flags_tree,\r\nhf_adp_list_cap_audio_sink, tvb, ADP_LISTENER_CAP_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(list_cap_flags_tree,\r\nhf_adp_list_cap_video_sink, tvb, ADP_LISTENER_CAP_OFFSET, 2, ENC_BIG_ENDIAN);\r\ncont_cap_ti = proto_tree_add_item(adp_tree, hf_adp_controller_cap, tvb, ADP_CONTROLLER_CAP_OFFSET, 4, ENC_BIG_ENDIAN);\r\ncont_cap_flags_tree = proto_item_add_subtree(cont_cap_ti, ett_adp_cont_cap);\r\nproto_tree_add_item(cont_cap_flags_tree,\r\nhf_adp_cont_cap_implement, tvb, ADP_CONTROLLER_CAP_OFFSET, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cont_cap_flags_tree,\r\nhf_adp_cont_cap_layer3_proxy, tvb, ADP_CONTROLLER_CAP_OFFSET, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(adp_tree, hf_adp_avail_index, tvb, ADP_AVAIL_INDEX_OFFSET, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(adp_tree, hf_adp_gptp_gm_id, tvb, ADP_AS_GM_ID_OFFSET, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(adp_tree, hf_adp_assoc_id, tvb, ADP_ASSOC_ID_OFFSET, 8, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_17221_acmp(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *acmp_tree)\r\n{\r\nproto_item *flags_ti;\r\nproto_tree *flags_tree;\r\nproto_tree_add_item(acmp_tree, hf_acmp_message_type, tvb, ACMP_VERSION_OFFSET, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(acmp_tree, hf_acmp_status_field, tvb, ACMP_STATUS_FIELD_OFFSET, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(acmp_tree, hf_acmp_cd_length, tvb, ACMP_CD_LENGTH_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(acmp_tree, hf_acmp_stream_id, tvb, ACMP_STREAM_ID_OFFSET, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(acmp_tree, hf_acmp_controller_guid, tvb, ACMP_CONTROLLER_GUID_OFFSET, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(acmp_tree, hf_acmp_talker_guid, tvb, ACMP_TALKER_GUID_OFFSET, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(acmp_tree, hf_acmp_listener_guid, tvb, ACMP_LISTENER_GUID_OFFSET, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(acmp_tree, hf_acmp_talker_unique_id, tvb, ACMP_TALKER_UNIQUE_ID_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(acmp_tree, hf_acmp_listener_unique_id, tvb, ACMP_LISTENER_UNIQUE_ID_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(acmp_tree, hf_acmp_stream_dest_mac, tvb, ACMP_DEST_MAC_OFFSET, 6, ENC_NA);\r\nproto_tree_add_item(acmp_tree, hf_acmp_connection_count, tvb, ACMP_CONNECTION_COUNT_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(acmp_tree, hf_acmp_sequence_id, tvb, ACMP_SEQUENCE_ID_OFFSET, 2, ENC_BIG_ENDIAN);\r\nflags_ti = proto_tree_add_item(acmp_tree, hf_acmp_flags, tvb, ACMP_FLAGS_OFFSET, 2, ENC_BIG_ENDIAN);\r\nflags_tree = proto_item_add_subtree(flags_ti, ett_acmp_flags);\r\nproto_tree_add_item(flags_tree, hf_acmp_flags_class_b, tvb, ACMP_FLAGS_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(flags_tree, hf_acmp_flags_fast_connect, tvb, ACMP_FLAGS_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(flags_tree, hf_acmp_flags_saved_state, tvb, ACMP_FLAGS_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(flags_tree, hf_acmp_flags_streaming_wait, tvb, ACMP_FLAGS_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(flags_tree, hf_acmp_flags_supports_encrypted, tvb, ACMP_FLAGS_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(flags_tree, hf_acmp_flags_encrypted_pdu, tvb, ACMP_FLAGS_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(flags_tree, hf_acmp_flags_talker_failed, tvb, ACMP_FLAGS_OFFSET, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(acmp_tree, hf_acmp_vlan_id, tvb, ACMP_VLAN_ID_OFFSET, 2, ENC_BIG_ENDIAN);\r\n}\r\nstatic int\r\ndissect_17221(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nguint8 subtype = 0;\r\nproto_item *ieee17221_item;\r\nproto_tree *ieee17221_tree;\r\nsubtype = tvb_get_guint8(tvb, 0);\r\nsubtype &= 0x7F;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "IEEE1722-1");\r\nieee17221_item = proto_tree_add_item(tree, proto_17221, tvb, 0, -1, ENC_NA);\r\nieee17221_tree = proto_item_add_subtree(ieee17221_item, ett_17221);\r\nswitch (subtype)\r\n{\r\ncase 0x7A:\r\n{\r\ncol_set_str(pinfo->cinfo, COL_INFO, "AVDECC Discovery Protocol");\r\nif (tree)\r\ndissect_17221_adp(tvb, pinfo, ieee17221_tree);\r\nbreak;\r\n}\r\ncase 0x7B:\r\n{\r\ncol_set_str(pinfo->cinfo, COL_INFO, "AVDECC Enumeration and Control Protocol");\r\nif (tree)\r\ndissect_17221_aecp(tvb, pinfo, ieee17221_tree);\r\nbreak;\r\n}\r\ncase 0x7C:\r\n{\r\ncol_set_str(pinfo->cinfo, COL_INFO, "AVDECC Connection Management Protocol");\r\nif (tree)\r\ndissect_17221_acmp(tvb, pinfo, ieee17221_tree);\r\nbreak;\r\n}\r\ndefault:\r\n{\r\ncol_set_str(pinfo->cinfo, COL_INFO, "1722.1 Unknown");\r\nreturn 0;\r\n}\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_17221(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_adp_message_type,\r\n{ "Message Type", "ieee17221.message_type",\r\nFT_UINT8, BASE_DEC, VALS(adp_message_type_vals), ADP_MSG_TYPE_MASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_valid_time,\r\n{ "Valid Time", "ieee17221.valid_time",\r\nFT_UINT8, BASE_DEC, NULL, ADP_VALID_TIME_MASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_cd_length,\r\n{ "Control Data Length", "ieee17221.control_data_length",\r\nFT_UINT16, BASE_DEC, NULL, ADP_CD_LENGTH_MASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_entity_id,\r\n{ "Entity ID", "ieee17221.entity_id",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_adp_entity_model_id,\r\n{ "Entity Model ID", "ieee17221.entity_model_id",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_adp_entity_cap,\r\n{ "Entity Capabilities", "ieee17221.entity_capabilities",\r\nFT_UINT32, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_adp_entity_cap_efu_mode,\r\n{ "EFU_MODE", "ieee17221.entity_capabilities.efu_mode",\r\nFT_BOOLEAN, 32, NULL, ADP_EFU_MODE_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_entity_cap_address_access_supported,\r\n{ "ADDRESS_ACCESS", "ieee17221.entity_capabilities.address_access",\r\nFT_BOOLEAN, 32, NULL, ADP_ADDRESS_ACCESS_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_entity_cap_gateway_entity,\r\n{ "GATEWAY_ENTITY", "ieee17221.entity_capabilities.gateway_entity",\r\nFT_BOOLEAN, 32, NULL, ADP_GATEWAY_ENTITY_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_entity_cap_aem_supported,\r\n{ "AEM", "ieee17221.entity_capabilities.aem_supported",\r\nFT_BOOLEAN, 32, NULL, ADP_AEM_SUPPORTED_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_entity_cap_legacy_avc,\r\n{ "LEGACY_AVC", "ieee17221.entity_capabilities.legacy_avc",\r\nFT_BOOLEAN, 32, NULL, ADP_LEGACY_AVC_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_entity_cap_assoc_id_support,\r\n{ "ASSOCIATION_ID_SUPPORTED", "ieee17221.entity_capabilities.association_id_supported",\r\nFT_BOOLEAN, 32, NULL, ADP_ASSOC_ID_SUPPORT_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_entity_cap_assoc_id_valid,\r\n{ "ASSOCIATION_ID_VALID", "ieee17221.entity_capabilities.association_id_valid",\r\nFT_BOOLEAN, 32, NULL, ADP_ASSOC_ID_VALID_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_entity_cap_vendor_unique,\r\n{ "VENDOR_UNIQUE", "ieee17221.entity_capabilities.vendor_unique",\r\nFT_BOOLEAN, 32, NULL, ADP_VENDOR_UNIQUE_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_entity_cap_class_a_supported,\r\n{ "CLASS_A", "ieee17221.entity_capabilities.class_a",\r\nFT_BOOLEAN, 32, NULL, ADP_CLASS_A_SUPPORTED_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_entity_cap_class_b_supported,\r\n{ "CLASS_B", "ieee17221.entity_capabilities.class_b",\r\nFT_BOOLEAN, 32, NULL, ADP_CLASS_B_SUPPORTED_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_entity_cap_gptp_supported,\r\n{ "gPTP Supported", "ieee17221.entity_capabilities.gptp_supported",\r\nFT_BOOLEAN, 32, NULL, ADP_AS_SUPPORTED_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_talker_stream_srcs,\r\n{ "Talker Stream Sources", "ieee17221.talker_stream_sources",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_adp_talker_cap,\r\n{ "Talker Capabilities", "ieee17221.talker_capabilities",\r\nFT_UINT16, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_adp_talk_cap_implement,\r\n{ "IMPLEMENTED", "ieee17221.talker_capabilities.implemented",\r\nFT_BOOLEAN, 16, NULL, ADP_TALK_IMPLEMENTED_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_talk_cap_other_src,\r\n{ "OTHER_SOURCE", "ieee17221.talker_capabilities.other_source",\r\nFT_BOOLEAN, 16, NULL, ADP_TALK_OTHER_SRC_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_talk_cap_control_src,\r\n{ "CONTROL_SOURCE", "ieee17221.talker_capabilities.control_source",\r\nFT_BOOLEAN, 16, NULL, ADP_TALK_CONTROL_SRC_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_talk_cap_media_clk_src,\r\n{ "MEDIA_CLOCK_SOURCE", "ieee17221.talker_capabilities.media_clock_source",\r\nFT_BOOLEAN, 16, NULL, ADP_TALK_MEDIA_CLK_SRC_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_talk_cap_smpte_src,\r\n{ "SMPTE_SOURCE", "ieee17221.talker_capabilities.smpte_source",\r\nFT_BOOLEAN, 16, NULL, ADP_TALK_SMPTE_SRC_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_talk_cap_midi_src,\r\n{ "MIDI_SOURCE", "ieee17221.talker_capabilities.midi_source",\r\nFT_BOOLEAN, 16, NULL, ADP_TALK_MIDI_SRC_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_talk_cap_audio_src,\r\n{ "AUDIO_SOURCE", "ieee17221.talker_capabilities.audio_source",\r\nFT_BOOLEAN, 16, NULL, ADP_TALK_AUDIO_SRC_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_talk_cap_video_src,\r\n{ "VIDEO_SOURCE", "ieee17221.talker_capabilities.video_source",\r\nFT_BOOLEAN, 16, NULL, ADP_TALK_VIDEO_SRC_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_listener_stream_sinks,\r\n{ "Listener Stream Sinks", "ieee17221.listener_stream_sinks",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_adp_listener_cap,\r\n{ "Listener Capabilities", "ieee17221.listener_capabilities",\r\nFT_UINT16, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_adp_list_cap_implement,\r\n{ "IMPLEMENTED", "ieee17221.listener_capabilities.implemented",\r\nFT_BOOLEAN, 16, NULL, ADP_LIST_IMPLEMENTED_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_list_cap_other_sink,\r\n{ "OTHER_SINK", "ieee17221.listener_capabilities.other_source",\r\nFT_BOOLEAN, 16, NULL, ADP_LIST_OTHER_SINK_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_list_cap_control_sink,\r\n{ "CONTROL_SINK", "ieee17221.listener_capabilities.control_source",\r\nFT_BOOLEAN, 16, NULL, ADP_LIST_CONTROL_SINK_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_list_cap_media_clk_sink,\r\n{ "MEDIA_CLOCK_SINK", "ieee17221.listener_capabilities.media_clock_source",\r\nFT_BOOLEAN, 16, NULL, ADP_LIST_MEDIA_CLK_SINK_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_list_cap_smpte_sink,\r\n{ "SMPTE_SINK", "ieee17221.listener_capabilities.smpte_source",\r\nFT_BOOLEAN, 16, NULL, ADP_LIST_SMPTE_SINK_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_list_cap_midi_sink,\r\n{ "MIDI_SINK", "ieee17221.listener_capabilities.midi_source",\r\nFT_BOOLEAN, 16, NULL, ADP_LIST_MIDI_SINK_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_list_cap_audio_sink,\r\n{ "AUDIO_SINK", "ieee17221.listener_capabilities.audio_source",\r\nFT_BOOLEAN, 16, NULL, ADP_LIST_AUDIO_SINK_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_list_cap_video_sink,\r\n{ "VIDEO_SINK", "ieee17221.listener_capabilities.video_source",\r\nFT_BOOLEAN, 16, NULL, ADP_LIST_VIDEO_SINK_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_controller_cap,\r\n{ "Controller Capabilities", "ieee17221.controller_capabilities",\r\nFT_UINT32, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_adp_cont_cap_implement,\r\n{ "IMPLEMENTED", "ieee17221.controller_capabilities.implemented",\r\nFT_BOOLEAN, 16, NULL, ADP_CONT_IMPLEMENTED_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_cont_cap_layer3_proxy,\r\n{ "LAYER3_PROXY", "ieee17221.controller_capabilities.layer3_proxy",\r\nFT_BOOLEAN, 16, NULL, ADP_CONT_LAYER3_PROXY_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_avail_index,\r\n{ "Available Index", "ieee17221.available_index",\r\nFT_UINT32, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_adp_gptp_gm_id,\r\n{ "gPTP Grandmaster ID", "ieee17221.gptp_grandmaster_id",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_adp_def_aud_format,\r\n{ "Default Audio Format", "ieee17221.default_audio_format",\r\nFT_UINT32, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n#endif\r\n#if 0\r\n{ &hf_adp_def_aud_sample_rates,\r\n{ "Sample Rates", "ieee17221.default_audio_format.sample_rates",\r\nFT_UINT8, BASE_HEX, NULL, ADP_DEF_AUDIO_SAMPLE_RATES_MASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_samp_rate_44k1,\r\n{ "44.1kHz", "ieee17221.default_audio_format.sample_rates.44k1",\r\nFT_BOOLEAN, 8, NULL, ADP_SAMP_RATE_44K1_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_samp_rate_48k,\r\n{ "48kHz", "ieee17221.default_audio_format.sample_rates.48k",\r\nFT_BOOLEAN, 8, NULL, ADP_SAMP_RATE_48K_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_samp_rate_88k2,\r\n{ "88.2kHz", "ieee17221.default_audio_format.sample_rates.88k2",\r\nFT_BOOLEAN, 8, NULL, ADP_SAMP_RATE_88K2_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_samp_rate_96k,\r\n{ "96kHz", "ieee17221.default_audio_format.sample_rates.96k",\r\nFT_BOOLEAN, 8, NULL, ADP_SAMP_RATE_96K_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_samp_rate_176k4,\r\n{ "176.4kHz", "ieee17221.default_audio_format.sample_rates.176k4",\r\nFT_BOOLEAN, 8, NULL, ADP_SAMP_RATE_176K4_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_samp_rate_192k,\r\n{ "192kHz", "ieee17221.default_audio_format.sample_rates.192k",\r\nFT_BOOLEAN, 8, NULL, ADP_SAMP_RATE_192K_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_def_aud_max_chan,\r\n{ "Max Channels", "ieee17221.default_audio_format.max_channels",\r\nFT_UINT16, BASE_DEC, NULL, ADP_DEF_AUDIO_MAX_CHANS_MASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_def_aud_saf_flag,\r\n{ "saf", "ieee17221.default_audio_format.saf",\r\nFT_BOOLEAN, 16, NULL, ADP_DEF_AUDIO_SAF_MASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_def_aud_float_flag,\r\n{ "float", "ieee17221.default_audio_format.float",\r\nFT_BOOLEAN, 16, NULL, ADP_DEF_AUDIO_FLOAT_MASK, NULL, HFILL }\r\n},\r\n{ &hf_adp_def_aud_chan_formats,\r\n{ "Channel Formats", "ieee17221.default_audio_format.channel_formats",\r\nFT_UINT16, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_adp_chan_format_mono,\r\n{ "MONO", "ieee17221.default_audio_format.channel_formats.mono",\r\nFT_BOOLEAN, 16, NULL, ADP_CHAN_FORMAT_MONO, NULL, HFILL }\r\n},\r\n{ &hf_adp_chan_format_2ch,\r\n{ "2_CH", "ieee17221.default_audio_format.channel_formats.2_ch",\r\nFT_BOOLEAN, 16, NULL, ADP_CHAN_FORMAT_2CH, NULL, HFILL }\r\n},\r\n{ &hf_adp_chan_format_3ch,\r\n{ "3_CH", "ieee17221.default_audio_format.channel_formats.3_ch",\r\nFT_BOOLEAN, 16, NULL, ADP_CHAN_FORMAT_3CH, NULL, HFILL }\r\n},\r\n{ &hf_adp_chan_format_4ch,\r\n{ "4_CH", "ieee17221.default_audio_format.channel_formats.4_ch",\r\nFT_BOOLEAN, 16, NULL, ADP_CHAN_FORMAT_4CH, NULL, HFILL }\r\n},\r\n{ &hf_adp_chan_format_5ch,\r\n{ "5_CH", "ieee17221.default_audio_format.channel_formats.5_ch",\r\nFT_BOOLEAN, 16, NULL, ADP_CHAN_FORMAT_5CH, NULL, HFILL }\r\n},\r\n{ &hf_adp_chan_format_6ch,\r\n{ "6_CH", "ieee17221.default_audio_format.channel_formats.6_ch",\r\nFT_BOOLEAN, 16, NULL, ADP_CHAN_FORMAT_6CH, NULL, HFILL }\r\n},\r\n{ &hf_adp_chan_format_7ch,\r\n{ "7_CH", "ieee17221.default_audio_format.channel_formats.7_ch",\r\nFT_BOOLEAN, 16, NULL, ADP_CHAN_FORMAT_7CH, NULL, HFILL }\r\n},\r\n{ &hf_adp_chan_format_8ch,\r\n{ "8_CH", "ieee17221.default_audio_format.channel_formats.8_ch",\r\nFT_BOOLEAN, 16, NULL, ADP_CHAN_FORMAT_8CH, NULL, HFILL }\r\n},\r\n{ &hf_adp_chan_format_10ch,\r\n{ "10_CH", "ieee17221.default_audio_format.channel_formats.10_ch",\r\nFT_BOOLEAN, 16, NULL, ADP_CHAN_FORMAT_10CH, NULL, HFILL }\r\n},\r\n{ &hf_adp_chan_format_12ch,\r\n{ "12_CH", "ieee17221.default_audio_format.channel_formats.12_ch",\r\nFT_BOOLEAN, 16, NULL, ADP_CHAN_FORMAT_12CH, NULL, HFILL }\r\n},\r\n{ &hf_adp_chan_format_14ch,\r\n{ "14_CH", "ieee17221.default_audio_format.channel_formats.14_ch",\r\nFT_BOOLEAN, 16, NULL, ADP_CHAN_FORMAT_14CH, NULL, HFILL }\r\n},\r\n{ &hf_adp_chan_format_16ch,\r\n{ "16_CH", "ieee17221.default_audio_format.channel_formats.16_ch",\r\nFT_BOOLEAN, 16, NULL, ADP_CHAN_FORMAT_16CH, NULL, HFILL }\r\n},\r\n{ &hf_adp_chan_format_18ch,\r\n{ "18_CH", "ieee17221.default_audio_format.channel_formats.18_ch",\r\nFT_BOOLEAN, 16, NULL, ADP_CHAN_FORMAT_18CH, NULL, HFILL }\r\n},\r\n{ &hf_adp_chan_format_20ch,\r\n{ "20_CH", "ieee17221.default_audio_format.channel_formats.20_ch",\r\nFT_BOOLEAN, 16, NULL, ADP_CHAN_FORMAT_20CH, NULL, HFILL }\r\n},\r\n{ &hf_adp_chan_format_22ch,\r\n{ "22_CH", "ieee17221.default_audio_format.channel_formats.22_ch",\r\nFT_BOOLEAN, 16, NULL, ADP_CHAN_FORMAT_22CH, NULL, HFILL }\r\n},\r\n{ &hf_adp_chan_format_24ch,\r\n{ "24_CH", "ieee17221.default_audio_format.channel_formats.24_ch",\r\nFT_BOOLEAN, 16, NULL, ADP_CHAN_FORMAT_24CH, NULL, HFILL }\r\n},\r\n#endif\r\n#if 0\r\n{ &hf_adp_def_vid_format,\r\n{ "Default Video Format", "ieee17221.default_video_format",\r\nFT_UINT32, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_adp_assoc_id,\r\n{ "Association ID", "ieee17221.association_id",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_adp_entity_type,\r\n{ "Entity Type", "ieee17221.entity_type",\r\nFT_UINT32, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_acmp_message_type,\r\n{ "Message Type", "ieee17221.message_type",\r\nFT_UINT8, BASE_DEC, VALS(acmp_message_type_vals), ACMP_MSG_TYPE_MASK, NULL, HFILL }\r\n},\r\n{ &hf_acmp_status_field,\r\n{ "Status Field", "ieee17221.status_field",\r\nFT_UINT8, BASE_DEC, VALS(acmp_status_field_vals), ACMP_STATUS_FIELD_MASK, NULL, HFILL }\r\n},\r\n{ &hf_acmp_cd_length,\r\n{ "Control Data Length", "ieee17221.control_data_length",\r\nFT_UINT16, BASE_DEC, NULL, ACMP_CD_LENGTH_MASK, NULL, HFILL }\r\n},\r\n{ &hf_acmp_stream_id,\r\n{ "Stream ID", "ieee17221.stream_id",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_acmp_controller_guid,\r\n{ "Controller GUID", "ieee17221.controller_guid",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_acmp_talker_guid,\r\n{ "Talker GUID", "ieee17221.talker_guid",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_acmp_listener_guid,\r\n{ "Listener GUID", "ieee17221.listener_guid",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_acmp_talker_unique_id,\r\n{ "Talker Unique ID", "ieee17221.talker_unique_id",\r\nFT_UINT16, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_acmp_listener_unique_id,\r\n{ "Listener Unique ID", "ieee17221.listener_unique_id",\r\nFT_UINT16, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_acmp_stream_dest_mac,\r\n{ "Destination MAC address", "ieee17221.dest_mac",\r\nFT_ETHER, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_acmp_connection_count,\r\n{ "Connection Count", "ieee17221.connection_count",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_acmp_sequence_id,\r\n{ "Sequence ID", "ieee17221.sequence_id",\r\nFT_UINT16, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_acmp_flags,\r\n{ "Flags", "ieee17221.flags",\r\nFT_UINT16, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_acmp_flags_class_b,\r\n{ "CLASS_B", "ieee17221.flags.class_b",\r\nFT_BOOLEAN, 16, NULL, ACMP_FLAG_CLASS_B_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_acmp_flags_fast_connect,\r\n{ "FAST_CONNECT", "ieee17221.flags.fast_connect",\r\nFT_BOOLEAN, 16, NULL, ACMP_FLAG_FAST_CONNECT_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_acmp_flags_saved_state,\r\n{ "SAVED_STATE", "ieee17221.flags.saved_state",\r\nFT_BOOLEAN, 16, NULL, ACMP_FLAG_SAVED_STATE_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_acmp_flags_streaming_wait,\r\n{ "STREAMING_WAIT", "ieee17221.flags.streaming_wait",\r\nFT_BOOLEAN, 16, NULL, ACMP_FLAG_STREAMING_WAIT_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_acmp_flags_supports_encrypted,\r\n{ "SUPPORTS_ENCRYPTED", "ieee17221.flags.supports_encrypted",\r\nFT_BOOLEAN, 16, NULL, ACMP_FLAG_SUPPORTS_ENCRYPTED_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_acmp_flags_encrypted_pdu,\r\n{ "ENCRYPTED_PDU", "ieee17221.flags.encrypted_pdu",\r\nFT_BOOLEAN, 16, NULL, ACMP_FLAG_ENCRYPTED_PDU_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_acmp_flags_talker_failed,\r\n{ "TALKER_FAILED", "ieee17221.flags.talker_failed",\r\nFT_BOOLEAN, 16, NULL, ACMP_FLAG_TALKER_FAILED_BITMASK, NULL, HFILL }\r\n},\r\n{ &hf_acmp_vlan_id,\r\n{ "Stream VLAN Id", "ieee17221.vlan_id",\r\nFT_UINT16, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_message_type,\r\n{ "Message Type", "ieee17221.message_type",\r\nFT_UINT8, BASE_DEC, VALS(aecp_message_type_vals), AECP_MSG_TYPE_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_cd_length,\r\n{ "Control Data Length", "ieee17221.control_data_length",\r\nFT_UINT16, BASE_DEC, NULL, AECP_CD_LENGTH_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_target_guid,\r\n{ "Target GUID", "ieee17221.target_guid",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_controller_guid,\r\n{ "Controller GUID", "ieee17221.controller_guid",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_sequence_id,\r\n{ "Sequence ID", "ieee17221.sequence_id",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_u_flag,\r\n{ "U Flag", "ieee17221.u_flag",\r\nFT_BOOLEAN, 8, NULL, AECP_U_FLAG_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_command_type,\r\n{ "Command Type", "ieee17221.command_type",\r\nFT_UINT16, BASE_HEX, VALS(aecp_command_type_vals), AECP_COMMAND_TYPE_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_aa_count,\r\n{ "Count", "ieee17221.count",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_aa_tlv_mode,\r\n{ "Tlv Mode", "ieee17221.tlv_mode",\r\nFT_UINT8, BASE_DEC, NULL, 0xF0, NULL, HFILL }\r\n},\r\n{ &hf_aecp_aa_tlv_length,\r\n{ "Tlv Length", "ieee17221.tlv_length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0FFF, NULL, HFILL }\r\n},\r\n{ &hf_aecp_aa_tlv_address,\r\n{ "Tlv Address", "ieee17221.tlv_address",\r\nFT_UINT64, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_aecp_descriptor_type,\r\n{ "Descriptor Type", "ieee17221.descriptor_type",\r\nFT_UINT16, BASE_HEX, VALS(aem_descriptor_type_vals), 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_descriptor_index,\r\n{"Descriptor Index", "ieee17221.descriptor_index",\r\nFT_UINT16, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_unlock_flag,\r\n{ "UNLOCK Flag", "ieee17221.flags.unlock",\r\nFT_BOOLEAN, 8, NULL, AECP_UNLOCK_FLAG_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_locked_guid,\r\n{ "Locked GUID", "ieee17221.locked_guid",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL}\r\n},\r\n{ &hf_aecp_configuration,\r\n{ "Configuration", "ieee17221.configuration",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_persistent_flag,\r\n{ "Persistent Flag", "ieee17221.flags.persistent",\r\nFT_BOOLEAN, 32, NULL, AECP_PERSISTENT_FLAG_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_release_flag,\r\n{ "Release Flag", "ieee17221.flags.release",\r\nFT_BOOLEAN, 32, NULL, AECP_RELEASE_FLAG_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_owner_guid,\r\n{ "Owner GUID", "ieee17221.owner_guid",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_clock_source_id,\r\n{ "Clock Source ID", "ieee17221.clock_source_id64",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_format,\r\n{"Stream Format", "ieee17221.stream_format64",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_signal_type,\r\n{"Signal Type", "ieee17221.signal_type",\r\nFT_UINT16, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_signal_index,\r\n{"Signal Index", "ieee17221.signal_index",\r\nFT_UINT16, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_signal_output,\r\n{"Signal Output", "ieee17221.signal_output",\r\nFT_UINT16, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_matrix_column,\r\n{"Matrix Column", "ieee17221.matrix_column",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_matrix_row,\r\n{"Matrix Row", "ieee17221.matrix_row",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_matrix_region_width,\r\n{"Region Width", "ieee17221.matrix_region_width",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_matrix_region_height,\r\n{"Region Height", "ieee17221.matrix_region_height",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_matrix_rep,\r\n{"Rep", "ieee17221.matrix_rep",\r\nFT_BOOLEAN, 8, NULL, AECP_MATRIX_REP_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_matrix_direction,\r\n{"Direction", "ieee17221.matrix_direction",\r\nFT_UINT8, BASE_DEC, VALS(aecp_direction_type_vals), AECP_MATRIX_DIRECTION_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_matrix_value_count,\r\n{"Value Count", "ieee17221.matrix_value_count",\r\nFT_UINT16, BASE_DEC, NULL, AECP_MATRIX_VALUE_COUNT_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_matrix_item_offset,\r\n{"Item Offset", "ieee17221.matrix_item_offset",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_aecp_matrix_affected_item_count,\r\n{"Affected Item Count", "ieee17221.matrix_affected_item_count",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_aecp_avb_info_ptp_grandmaster_id,\r\n{"gPTP Grandmaster ID", "ieee17221.avb_info_gptp_grandmaster_id",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_avb_info_propegation_delay,\r\n{"Propagation Delay", "ieee17221.avb_info_propagation_delay",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_avb_info_gptp_domain_number,\r\n{"gPTP Domain Number", "ieee17221.avb_info_gptp_domain_number",\r\nFT_UINT8, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_aecp_avb_info_flags,\r\n{"Flags", "ieee17221.avbinfo_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_aecp_as_capable_flag,\r\n{ "AS Capable Flag", "ieee17221.as_capable_flag",\r\nFT_BOOLEAN, 8, NULL, AECP_AS_CAPABLE_FLAG_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_gptp_enabled_flag,\r\n{ "gPTP Enabled Flag", "ieee17221.gptp_enabled_flag",\r\nFT_BOOLEAN, 8, NULL, AECP_GPTP_ENABLED_FLAG_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_srp_enabled_flag,\r\n{ "SRP Enabled Flag", "ieee17221.srp_enabled_flag",\r\nFT_BOOLEAN, 8, NULL, AECP_SRP_ENABLED_FLAG_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_avb_info_msrp_mappings_count,\r\n{"MSRP Mappings Count", "ieee17221.msrp_mappings_count",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_avb_info_msrp_mappings,\r\n{"MSRP Mappings", "ieee17221.msrp_mappings",\r\nFT_NONE, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_avb_info_msrp_mapping_traffic_class,\r\n{"MSRP Mapping Traffic Class", "ieee17221.msrp_mapping_traffic_class",\r\nFT_UINT8, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_avb_info_msrp_mapping_priority,\r\n{"MSRP Mapping Priority", "ieee17221.msrp_mapping_priority",\r\nFT_UINT8, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_get_avb_info_msrp_vlan_id,\r\n{"MSRP VLAN ID", "ieee17221.msrp_vlan_id",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_map_index,\r\n{"Map Index", "ieee17221.map_index",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_number_of_maps,\r\n{"Number of Maps", "ieee17221.number_of_maps",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_msrp_accumulated_latency,\r\n{"MSRP Accumulated Latency", "ieee17221.msrp_accumulated_latency",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_msrp_failure_code,\r\n{"MSRP Failure Code", "ieee17221.msrp_failure_code",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_msrp_failure_bridge_id,\r\n{"MSRP Failure Bridge ID", "ieee17221.msrp_failure_bridge_id",\r\nFT_BYTES, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_aecp_stream_vlan_id,\r\n{"Stream VLAN ID", "ieee17221.stream_vlan_id",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_aecp_stream_vlan_id_valid_flag,\r\n{"Stream VLAN ID Valid Flag", "ieee17221.flags.stream_vlan_id_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_STREAM_VLAN_ID_VALID_FLAG_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_connected_flag,\r\n{"Connected Flag", "ieee17221.flags.connected",\r\nFT_BOOLEAN, 32, NULL, AECP_CONNECTED_FLAG_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_msrp_failure_valid_flag,\r\n{"MSRP Failure Valid Flag", "ieee17221.flags.msrp_failure_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_MSRP_FAILURE_VALID_FLAG_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_dest_mac_valid_flag,\r\n{"Dest MAC Valid Flag", "ieee17221.flags.dest_mac_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_DEST_MAC_VALID_FLAG_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_msrp_acc_lat_valid_flag,\r\n{"MSRP Accumulated Latency Field Valid Flag", "ieee17221.flags.msrp_acc_lat_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_MSRP_ACC_LAT_VALID_FLAG_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_id_valid_flag,\r\n{"Stream ID Valid Flag", "ieee17221.flags.stream_id_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_STREAM_ID_VALID_FLAG_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_format_valid_flag,\r\n{"Stream Format Valid Flag", "ieee17221.flags.stream_format_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_STREAM_FORMAT_VALID_FLAG_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_name_index,\r\n{"Name Index", "ieee17221.name_index",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_configuration_index,\r\n{"Configuration Index", "ieee17221.configuration_index",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_name,\r\n{"Name", "ieee17221.name",\r\nFT_STRING, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_association_id,\r\n{"Association ID", "ieee17221.association_id",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_as_path_count,\r\n{"Count", "ieee17221.as_path_count",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_as_path_sequences,\r\n{"Path Sequence", "ieee17221.as_path_sequences",\r\nFT_NONE, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_get_as_info_clock_id,\r\n{ "ClockId", "ieee17221.get_as_info_clock_id",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_keychain_id,\r\n{"Keychain ID", "ieee17221.keychain_id",\r\nFT_UINT8, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_keychain_id_small,\r\n{"Keychain ID", "ieee17221.keychain_id_small",\r\nFT_UINT8, BASE_HEX, VALS(aecp_keychain_id_type_vals), AECP_KEYCHAIN_ID_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_key_type,\r\n{"Key Type", "ieee17221.key_type",\r\nFT_UINT8, BASE_HEX, VALS(aecp_key_type_type_vals), AECP_KEYTYPE_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_key_signature,\r\n{"Key Signature", "ieee17221.key_signature",\r\nFT_BYTES, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_aecp_key_number,\r\n{"Key ID", "ieee17221.key_id",\r\nFT_UINT16, BASE_HEX, NULL, AECP_KEY_NUMBER_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_continued_flag,\r\n{"Continued", "ieee17221.continued",\r\nFT_BOOLEAN, 8, NULL, AECP_CONTINUED_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_key_part,\r\n{"Key Part", "ieee17221.key_part",\r\nFT_UINT8, BASE_DEC, NULL, AECP_KEY_PART_MASK, NULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_aecp_key_length,\r\n{"Key Length", "ieee17221.key_length",\r\nFT_UINT16, BASE_DEC, NULL, AECP_KEY_LENGTH_MASK, NULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_aecp_private_key_read_flag,\r\n{"Private Key Read Flag", "ieee17221.flags.private_key_read",\r\nFT_BOOLEAN, 32, NULL, AECP_PRIVATE_KEY_READ_FLAG_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_private_key_write_flag,\r\n{"Private Key Write Flag", "ieee17221.flags.private_key_write",\r\nFT_BOOLEAN, 32, NULL, AECP_PRIVATE_KEY_WRITE_FLAG_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_public_key_write_flag,\r\n{"Public Key Write Flag", "ieee17221.flags.public_key_write",\r\nFT_BOOLEAN, 32, NULL, AECP_PUBLIC_KEY_WRITE_FLAG_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_control_admin_flag,\r\n{"Control Admin Flag", "ieee17221.flags.control_admin",\r\nFT_BOOLEAN, 32, NULL, AECP_CONTROL_ADMIN_FLAG_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_mem_obj_admin_flag,\r\n{"Memory Object Admin", "ieee17221.mem_obj_admin",\r\nFT_BOOLEAN, 32, NULL, AECP_MEM_OBJ_ADMIN_FLAG_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_mem_obj_settings_flag,\r\n{"Memory Object Settings", "ieee17221.mem_obj_settings",\r\nFT_BOOLEAN, 32, NULL, AECP_MEM_OBJ_SETTINGS_FLAG_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_control_user_l1,\r\n{"Control User L1 flag", "ieee17221.flags.control_user_l1",\r\nFT_BOOLEAN, 32, NULL, AECP_CONTROL_USER_L1_FLAG_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_control_user_l2,\r\n{"Control User L2 flag", "ieee17221.flags.control_user_l2",\r\nFT_BOOLEAN, 32, NULL, AECP_CONTROL_USER_L2_FLAG_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_control_user_l3,\r\n{"Control User L3 flag", "ieee17221.flags.control_user_l3",\r\nFT_BOOLEAN, 32, NULL, AECP_CONTROL_USER_L3_FLAG_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_control_user_l4,\r\n{"Control User L4 flag", "ieee17221.flags.control_user_l4",\r\nFT_BOOLEAN, 32, NULL, AECP_CONTROL_USER_L4_FLAG_MASK, NULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_aecp_keychain_list_index,\r\n{"Keychain List Index", "ieee17221.keychain_list_index",\r\nFT_UINT16, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_keychain_number_of_keys,\r\n{"Keychain Number of Keys", "ieee17221.keychain_number_of_keys",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_keychain_number_of_lists,\r\n{"Keychain Number of Lists", "ieee17221.keychain_number_of_lists",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_key_eui,\r\n{"Key EUI", "ieee17221.key_eui",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_token_length,\r\n{"Token Length", "ieee17221.token_length",\r\nFT_UINT16, BASE_DEC, NULL, AECP_TOKEN_LENGTH_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_key,\r\n{"Key", "ieee17221.key",\r\nFT_BYTES, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_auth_token,\r\n{"Auth Token", "ieee17221.auth_token",\r\nFT_BYTES, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_flags_32,\r\n{"Flags", "ieee17221.flags",\r\nFT_UINT32, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_avb_interface_link_up_valid,\r\n{"Link Up Valid", "ieee17221.flags.link_up_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_LINK_UP, NULL, HFILL }\r\n},\r\n{ &hf_aecp_avb_interface_link_down_valid,\r\n{"Link Down Valid", "ieee17221.flags.link_up_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_LINK_DOWN, NULL, HFILL }\r\n},\r\n{ &hf_aecp_avb_interface_packets_tx_valid,\r\n{"Packets TX Valid", "ieee17221.flags.packets_tx_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_PACKETS_TX, NULL, HFILL }\r\n},\r\n{ &hf_aecp_avb_interface_packets_rx_valid,\r\n{"Packets RX Valid", "ieee17221.flags.packets_rx_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_PACKETS_RX, NULL, HFILL }\r\n},\r\n{ &hf_aecp_avb_interface_rx_crc_error_valid,\r\n{"RX CRC Error Valid", "ieee17221.flags.rx_crc_error_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_RX_CRC_ERROR, NULL, HFILL }\r\n},\r\n{ &hf_aecp_avb_interface_gptp_gm_changed_valid,\r\n{"GPTP GM Changed Valid", "ieee17221.flags.gptp_gm_changed_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_GPTP_GM_CHANGED, NULL, HFILL }\r\n},\r\n{ &hf_aecp_clock_domain_unlocked_valid,\r\n{"Clock Domain Unlocked Valid", "ieee17221.flags.clock_domain_unlocked_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_CLOCK_DOMAIN_UNLOCKED, NULL, HFILL }\r\n},\r\n{ &hf_aecp_clock_domain_locked_valid,\r\n{"Clock_Domain Locked Valid", "ieee17221.flags.clock_domain_locked_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_CLOCK_DOMAIN_LOCKED, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_input_media_unlocked_valid,\r\n{"Media Unlocked Valid", "ieee17221.flags.media_unlocked_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_MEDIA_UNLOCKED, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_input_media_locked_valid,\r\n{"Media Locked Valid", "ieee17221.flags.media_locked_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_MEDIA_LOCKED, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_input_stream_reset_valid,\r\n{"Stream Reset Valid", "ieee17221.flags.stream_reset_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_STREAM_RESET, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_input_seq_num_mismatch_valid,\r\n{"Seq Num Mismatch Valid", "ieee17221.flags.seq_num_mismatch_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_SEQ_NUM_MISMATCH, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_input_media_reset_valid,\r\n{"Media Reset Valid", "ieee17221.flags.media_reset_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_MEDIA_RESET, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_input_timestamp_uncertain_valid,\r\n{"Timestamp Uncertain Valid", "ieee17221.flags.timestamp_uncertain_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_TIMESTAMP_UNCERTAIN, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_input_timestamp_valid_valid,\r\n{"Timestamp Valid Valid", "ieee17221.flags.timestamp_valid_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_TIMESTAMP_VALID, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_input_timestamp_not_valid_valid,\r\n{"Timestamp Not Valid Valid", "ieee17221.flags.timestamp_not_valid_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_TIMESTAMP_NOT_VALID, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_input_unsupported_format_valid,\r\n{"Unsupported Format Valid", "ieee17221.flags.unsupported_format_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_UNSUPPORTED_FORMAT, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_input_late_timestamp_valid,\r\n{"Late Timestamp Valid", "ieee17221.flags.late_timestamp_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_LATE_TIMESTAMP, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_input_early_timestamp_valid,\r\n{"Early Timestamp Valid", "ieee17221.flags.early_timestamp_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_EARLY_TIMESTAMP, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_input_packets_tx_valid,\r\n{"Stream Packets TX Valid", "ieee17221.flags.stream_packets_tx_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_STREAM_PACKETS_TX, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_input_packets_rx_valid,\r\n{"Stream Packets RX Valid", "ieee17221.flags.stream_packets_rx_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_STREAM_PACKETS_RX, NULL, HFILL }\r\n},\r\n{ &hf_aecp_entity_specific1_valid,\r\n{"Entity Specific 1", "ieee17221.flags.entity_specific1_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_ENTITY_SPECIFIC_1, NULL, HFILL }\r\n},\r\n{ &hf_aecp_entity_specific2_valid,\r\n{"Entity Specific 2", "ieee17221.flags.entity_specific2_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_ENTITY_SPECIFIC_2, NULL, HFILL }\r\n},\r\n{ &hf_aecp_entity_specific3_valid,\r\n{"Entity Specific 3", "ieee17221.flags.entity_specific3_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_ENTITY_SPECIFIC_3, NULL, HFILL }\r\n},\r\n{ &hf_aecp_entity_specific4_valid,\r\n{"Entity Specific 4", "ieee17221.flags.entity_specific4_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_ENTITY_SPECIFIC_4, NULL, HFILL }\r\n},\r\n{ &hf_aecp_entity_specific5_valid,\r\n{"Entity Specific 5", "ieee17221.flags.entity_specific5_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_ENTITY_SPECIFIC_5, NULL, HFILL }\r\n},\r\n{ &hf_aecp_entity_specific6_valid,\r\n{"Entity Specific 6", "ieee17221.flags.entity_specific6_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_ENTITY_SPECIFIC_6, NULL, HFILL }\r\n},\r\n{ &hf_aecp_entity_specific7_valid,\r\n{"Entity Specific 7", "ieee17221.flags.entity_specific7_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_ENTITY_SPECIFIC_7, NULL, HFILL }\r\n},\r\n{ &hf_aecp_entity_specific8_valid,\r\n{"Entity Specific 8", "ieee17221.flags.entity_specific8_valid",\r\nFT_BOOLEAN, 32, NULL, AECP_COUNTERS_VALID_ENTITY_SPECIFIC_8, NULL, HFILL }\r\n},\r\n{ &hf_aecp_avb_interface_link_up,\r\n{"Link Up", "ieee17221.link_up",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_avb_interface_link_down,\r\n{"Link Down", "ieee17221.link_down",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_avb_interface_packets_tx,\r\n{"Frames TX", "ieee17221.frames_tx",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_avb_interface_packets_rx,\r\n{"Frames RX", "ieee17221.frames_rx",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_avb_interface_rx_crc_error,\r\n{"RX CRC Error", "ieee17221.rx_crc_error",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_avb_interface_gptp_gm_changed,\r\n{"GPTP GM Changed", "ieee17221.gptp_gm_changed",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_clock_domain_unlocked,\r\n{"Clock Domain Unlocked", "ieee17221.clock_domain_unlocked",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_clock_domain_locked,\r\n{"Clock_Domain Locked", "ieee17221.clock_domain_locked",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_input_media_unlocked,\r\n{"Media Unlocked", "ieee17221.media_unlocked",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_input_media_locked,\r\n{"Media Locked", "ieee17221.media_locked",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_input_stream_reset,\r\n{"Stream Reset", "ieee17221.stream_reset",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_input_seq_num_mismatch,\r\n{"Seq Num Mismatch", "ieee17221.seq_num_mismatch",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_input_media_reset,\r\n{"Media Reset", "ieee17221.media_reset",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_input_timestamp_uncertain,\r\n{"Timestamp Uncertain", "ieee17221.timestamp_uncertain",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_input_timestamp_valid,\r\n{"Timestamp Valid", "ieee17221.timestamp",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_input_timestamp_not_valid,\r\n{"Timestamp Not Valid", "ieee17221.timestamp_not",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_input_unsupported_format,\r\n{"Unsupported Format", "ieee17221.unsupported_format",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_input_late_timestamp,\r\n{"Late Timestamp", "ieee17221.late_timestamp",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_input_early_timestamp,\r\n{"Early Timestamp", "ieee17221.early_timestamp",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_input_packets_tx,\r\n{"Stream Packets TX", "ieee17221.stream_packets_tx",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_stream_input_packets_rx,\r\n{"Stream Packets RX", "ieee17221.stream_packets_rx",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_entity_specific1,\r\n{"Entity Specific 1", "ieee17221.entity_specific1",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_entity_specific2,\r\n{"Entity Specific 2", "ieee17221.entity_specific2",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_entity_specific3,\r\n{"Entity Specific 3", "ieee17221.entity_specific3",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_entity_specific4,\r\n{"Entity Specific 4", "ieee17221.entity_specific4",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_entity_specific5,\r\n{"Entity Specific 5", "ieee17221.entity_specific5",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_entity_specific6,\r\n{"Entity Specific 6", "ieee17221.entity_specific6",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_entity_specific7,\r\n{"Entity Specific 7", "ieee17221.entity_specific7",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_entity_specific8,\r\n{"Entity Specific 8", "ieee17221.entity_specific8",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_aecp_media_format,\r\n{"Media Format", "ieee17221.media_format",\r\nFT_BYTES, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_aecp_video_format,\r\n{"Video Format", "ieee17221.video_format",\r\nFT_BYTES, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_sampling_rate_pull,\r\n{ "Sampling Rate Pull Value", "ieee17221.sampling_rate_pull",\r\nFT_UINT32, BASE_HEX, VALS(aecp_sampling_rate_pull_field_vals), AECP_SAMPLING_RATE_PULL_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_sampling_rate_base_frequency,\r\n{"Sampling Rate Base Frequency", "ieee17221.sampling_rate_base_frequency",\r\nFT_UINT32, BASE_DEC, NULL, AECP_SAMPLING_RATE_BASE_FREQ_MASK, NULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_aecp_address_type,\r\n{"Address Type", "ieee17221.address_type",\r\nFT_UINT16, BASE_HEX, VALS(aecp_address_type_vals), 0x00, NULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_aecp_mac_address,\r\n{ "MAC address", "ieee17221.mac_address",\r\nFT_ETHER, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_aecp_ipv4_address,\r\n{"IPV4 Address", "ieee17221.ipv4_address",\r\nFT_IPv4, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_ipv6_address,\r\n{"IPv6 Address", "ieee17221.ipv6_address",\r\nFT_IPv6, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n#endif\r\n#if 0\r\n{ &hf_aecp_query_period,\r\n{"Query Period (ms)", "ieee17221.query_period",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_query_limit,\r\n{"Query Limit", "ieee17221.query_limit",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_query_type,\r\n{"Query Type", "ieee17221.query_type",\r\nFT_UINT16, BASE_HEX, VALS(aecp_command_type_vals), 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_query_id,\r\n{"Query ID", "ieee17221.query_id",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n#endif\r\n#if 0\r\n{ &hf_aecp_count,\r\n{"Count", "ieee17221.count",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_descriptors,\r\n{"Descriptors Array", "ieee17221.descriptors",\r\nFT_BYTES, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_values_count,\r\n{"Values Count", "ieee17221.values_count",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_aecp_operation_id,\r\n{"Operation ID", "ieee17221.operation_id",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_operation_type,\r\n{"Operation Type", "ieee17221.operation_type",\r\nFT_UINT16, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_percent_complete,\r\n{"Percent Complete", "ieee17221.percent_complete",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_entity_id,\r\n{"Entity ID", "ieee17221.entity_id",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_entity_model_id,\r\n{"Entity Model ID", "ieee17221.entity_model_id",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_entity_name,\r\n{"Entity Name", "ieee17221.entity_name",\r\nFT_STRING, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_vendor_name_string,\r\n{"Vendor Name String (ptr)", "ieee17221.vendor_name_string",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_model_name_string,\r\n{"Model Name String (ptr)", "ieee17221.model_name_string",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_firmware_version,\r\n{"Firmware Version", "ieee17221.firmware_version",\r\nFT_STRING, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_group_name,\r\n{"Group Name", "ieee17221.group_name",\r\nFT_STRING, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_serial_number,\r\n{"Serial Number", "ieee17221.serial_number",\r\nFT_STRING, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_configurations_count,\r\n{"Configurations Count", "ieee17221.configurations_count",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_current_configuration,\r\n{"Current Configuration", "ieee17221.current_configuration",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_configuration_name,\r\n{"Object Name", "ieee17221.configuration_name",\r\nFT_STRING, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_configuration_name_string,\r\n{"Localized Description", "ieee17221.configuration_name_string",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_descriptor_counts_count,\r\n{"Descriptor Counts Count", "ieee17221.descriptor_counts_count",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_descriptor_counts_offset,\r\n{"Descriptor Counts Offset", "ieee17221.descriptor_counts_offset",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_count,\r\n{"Count", "ieee17221.count",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_number_of_stream_input_ports,\r\n{"Number Of Stream Input Ports", "ieee17221.number_of_stream_input_ports",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_base_stream_input_port,\r\n{"Base Stream Input Port", "ieee17221.base_stream_input_port",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_number_of_stream_output_ports,\r\n{"Number Of Stream Output Ports", "ieee17221.number_of_stream_output_ports",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_base_stream_output_port,\r\n{"Base Stream Output Port", "ieee17221.base_stream_output_port",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_number_of_external_input_ports,\r\n{"Number Of External Input Ports", "ieee17221.number_of_external_input_ports",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_base_external_input_port,\r\n{"Base External Input Port", "ieee17221.base_external_input_port",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_number_of_external_output_ports,\r\n{"Number Of External Output Ports", "ieee17221.number_of_external_output_ports",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_base_external_output_port,\r\n{"Base External Output Port", "ieee17221.base_external_output_port",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_number_of_internal_input_ports,\r\n{"Number Of Internal Input Ports", "ieee17221.number_of_internal_input_ports",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_base_internal_input_port,\r\n{"Base Internal Input Port", "ieee17221.base_internal_input_port",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_number_of_internal_output_ports,\r\n{"Number Of Internal Output Ports", "ieee17221.number_of_internal_output_ports",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_base_internal_output_port,\r\n{"Base Internal Output Port", "ieee17221.base_internal_output_port",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_clock_source_id,\r\n{"Clock Source ID", "ieee17221.clock_source_id",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_clock_domain_id,\r\n{"Clock Domain ID", "ieee17221.clock_domain_id",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_clock_sources_offset,\r\n{"Clock Sources Offset", "ieee17221.clock_sources_offset",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_clock_source_index,\r\n{"Clock Source Index", "ieee17221.clock_source_index",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_clock_sources_count,\r\n{"Clock Sources Count", "ieee17221.clock_sources_count",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_clock_sources,\r\n{"Clock Sources", "ieee17221.clock_sources",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_clock_sources_array,\r\n{"Clock Sources Array", "ieee17221.clock_sources_array",\r\nFT_NONE, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_number_of_controls,\r\n{"Number Of Controls", "ieee17221.number_of_controls",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_base_control,\r\n{"Base Control", "ieee17221.base_control",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_number_control_blocks,\r\n{"Number Of Control Blocks", "ieee17221.number_of_control_blocks",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_base_control_block,\r\n{"Base Control Block", "ieee17221.base_control_block",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_object_name,\r\n{"Object Name", "ieee17221.object_name",\r\nFT_STRING, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_localized_description,\r\n{"Localized Description", "ieee17221.localized_description",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_current_sample_rate,\r\n{"Current Sample Rate", "ieee17221.current_sample_rate",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_number_signal_selectors,\r\n{"Number of Signal Selectors", "ieee17221.num_signal_selectors",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_base_signal_selector,\r\n{"Base Signal Selector", "ieee17221.base_signal_selector",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_number_mixers,\r\n{"Number of Mixers", "ieee17221.num_mixers",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_base_mixer,\r\n{"Base Mixer", "ieee17221.base_mixer",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_number_matrices,\r\n{"Number of Matrices", "ieee17221.num_matrices",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_base_matrix,\r\n{"Base Matrix", "ieee17221.base_matrix",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_number_splitters,\r\n{"Number of Splitters", "ieee17221.num_splitters",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_base_splitter,\r\n{"Base Splitter", "ieee17221.base_splitter",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_number_combiners,\r\n{"Number of Combiners", "ieee17221.num_combiners",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_base_combiner,\r\n{"Base Combiner", "ieee17221.base_combiner",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_number_demultiplexers,\r\n{"Number of Demultiplexers", "ieee17221.num_demultiplexer",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_base_demultiplexer,\r\n{"Base Demultiplexer", "ieee17221.base_demultiplexer",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_number_multiplexers,\r\n{"Number of Multiplexers", "ieee17221.num_multiplexers",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_base_multiplexer,\r\n{"Base Multiplexer", "ieee17221.base_multiplexer",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_number_transcoders,\r\n{"Number of Transcoders", "ieee17221.num_transcoders",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_base_transcoder,\r\n{"Base Transcoder", "ieee17221.base_transcoder",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_sample_rates_offset,\r\n{"Sample Rates Offset", "ieee17221.sample_rates_offset",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_sample_rates_count,\r\n{"Sample Rates Count", "ieee17221.sample_rates_count",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_sample_rates,\r\n{"Sample Rates", "ieee17221.sample_rates",\r\nFT_NONE, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_base_frequency,\r\n{"Base Frequency", "ieee17221.base_frequency",\r\nFT_UINT32, BASE_DEC, NULL, AEM_BASE_FREQUENCY_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aem_pull_field,\r\n{"Pull Field (frequency multiplier)", "ieee17221.pull_field",\r\nFT_UINT8, BASE_HEX, VALS(aem_frequency_multiplier_type_vals), AEM_PULL_FIELD_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aem_stream_name,\r\n{"Object Name", "ieee17221.stream_name",\r\nFT_STRING, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_stream_name_string,\r\n{"Localized Description", "ieee17221.stream_name_string",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_stream_flags,\r\n{"Stream Flags", "ieee17221.stream_flags",\r\nFT_UINT16, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_flags_clock_sync_source,\r\n{"Clock Sync Source Flag", "ieee17221.flags.clock_sync_source",\r\nFT_BOOLEAN, 16, NULL, AEM_CLOCK_SYNC_SOURCE_FLAG_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aem_flags_class_a,\r\n{"Class A Flag", "ieee17221.flags.class_a",\r\nFT_BOOLEAN, 16, NULL, AEM_CLASS_A_FLAG_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aem_flags_class_b,\r\n{"Class B Flag", "ieee17221.flags.class_b",\r\nFT_BOOLEAN, 16, NULL, AEM_CLASS_B_FLAG_MASK, NULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_aem_stream_channels,\r\n{"Stream Channels", "ieee17221.stream_channels",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_aem_formats_offset,\r\n{"Formats Offset", "ieee17221.formats_offset",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_number_of_formats,\r\n{"Number Of Formats", "ieee17221.number_of_formats",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_backup_talker_guid_0,\r\n{"Primary Backup Talker GUID", "ieee17221.backup_talker_guid_0",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_backup_talker_unique_0,\r\n{"Primary Backup Talker Unique ID", "ieee17221.backup_talker_unique_0",\r\nFT_UINT16, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_backup_talker_guid_1,\r\n{"Secondary Backup Talker GUID", "ieee17221.backup_talker_guid_1",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_backup_talker_unique_1,\r\n{"Secondary Backup Talker Unique ID", "ieee17221.backup_talker_unique_1",\r\nFT_UINT16, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_backup_talker_guid_2,\r\n{"Tertiary Backup Talker GUID", "ieee17221.backup_talker_guid_2",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_backup_talker_unique_2,\r\n{"Tertiary Backup Talker Unique ID", "ieee17221.backup_talker_unique_2",\r\nFT_UINT16, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_backedup_talker_guid,\r\n{"Backedup Talker GUID", "ieee17221.backedup_talker_guid",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_backedup_talker_unique,\r\n{"Backedup Talker Unique ID", "ieee17221.backedup_talker_unique",\r\nFT_UINT16, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_avb_interface_id,\r\n{"AVB Interface ID", "ieee17221.avb_interface_id",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_buffer_length,\r\n{"Buffer Length", "ieee17221.buffer_length",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_stream_formats,\r\n{"Stream Formats Array", "ieee17221.stream_formats",\r\nFT_NONE, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_jack_name,\r\n{"Object Name", "ieee17221.jack_name",\r\nFT_STRING, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_jack_name_string,\r\n{"Localized Description", "ieee17221.jack_name_string",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_interface_name,\r\n{"Interface Name", "ieee17221.interface_name",\r\nFT_STRING, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_interface_name_string,\r\n{"Interface Name String", "ieee17221.interface_name_string",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_jack_flags,\r\n{"Jack Flags", "ieee17221.jack_flags",\r\nFT_UINT16, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_flags_captive,\r\n{"Captive Flag", "ieee17221.flags.captive",\r\nFT_BOOLEAN, 16, NULL, AEM_CAPTIVE_FLAG_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aem_jack_type,\r\n{"Jack Type", "ieee17221.jack_type",\r\nFT_UINT16, BASE_HEX, VALS(aem_jack_type_vals), 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_port_flags,\r\n{"Port Flags", "ieee17221.port_flags",\r\nFT_UINT16, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_flags_async_sample_rate_conv,\r\n{"Asynchronous Sample Rate Converter Flag", "ieee17221.flags.async_sample_rate_conv",\r\nFT_BOOLEAN, 16, NULL, AEM_ASYNC_SAMPLE_RATE_CONV_FLAG_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aem_flags_sync_sample_rate_conv,\r\n{"Synchronous Sample Rate Converter Flag", "ieee17221.flags.sync_sample_rate_conv",\r\nFT_BOOLEAN, 16, NULL, AEM_SYNC_SAMPLE_RATE_CONV_FLAG_MASK, NULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_aem_audio_channels,\r\n{"Audio Channels", "ieee17221.audio_channels",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_aem_number_of_clusters,\r\n{"Number of Clusters", "ieee17221.number_of_clusters",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_base_cluster,\r\n{"Base Cluster", "ieee17221.base_cluster",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_base_audio_map,\r\n{"Base Audio Map", "ieee17221.base_audio_map",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_number_audio_maps,\r\n{"Number of Audio Maps", "ieee17221.num_audio_maps",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_aem_stream_id,\r\n{"Stream Descriptor ID", "ieee17221.stream_descriptor_id",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_formats_count,\r\n{"Formats Count", "ieee17221.formats_count",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_aem_jack_id,\r\n{"Jack ID", "ieee17221.jack_id",\r\nFT_UINT16, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_aem_internal_id,\r\n{"Internal ID", "ieee17221.internal_id",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_aem_avb_interface_flags,\r\n{"Interface Flags", "ieee17221.interface_flags",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_avb_clock_identity,\r\n{"Clock Identity", "ieee17221.clock_identity",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_avb_priority1,\r\n{"Priority1", "ieee17221.priority1",\r\nFT_UINT8, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_avb_clock_class,\r\n{"Clock Class", "ieee17221.clock_class",\r\nFT_UINT8, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_avb_offset_scaled_log_variance,\r\n{"Scaled Log Variance", "ieee17221.offset_scaled_log_variance",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_avb_clock_accuracy,\r\n{"Clock Accuracy", "ieee17221.clock_accuracy",\r\nFT_UINT8, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_avb_priority2,\r\n{"Priority2", "ieee17221.priority2",\r\nFT_UINT8, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_avb_domain_number,\r\n{"Domain Number", "ieee17221.domain_number",\r\nFT_UINT8, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_avb_log_sync_interval,\r\n{"Log sync Interval", "ieee17221.log_sync_interval",\r\nFT_INT8, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_aem_avb_propagation_delay,\r\n{"Propagation Delay", "ieee17221.propagation_delay",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_aem_clock_source_name,\r\n{"Object Name", "ieee17221.clock_source_name",\r\nFT_STRING, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_clock_source_name_string,\r\n{"Localized Description", "ieee17221.clock_source_name_string",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_clock_source_flags,\r\n{"Clock Source Flags", "ieee17221.clock_source_flags",\r\nFT_UINT16, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_clock_source_type,\r\n{"Clock Source Type", "ieee17221.clock_source_type",\r\nFT_UINT16, BASE_HEX, VALS(aem_clock_source_type_vals), 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_clock_source_location_type,\r\n{"Clock Source Location Type", "ieee17221.clock_source_location_type",\r\nFT_UINT16, BASE_HEX, VALS(aem_descriptor_type_vals), 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_clock_source_location_id,\r\n{"Clock Source Location ID", "ieee17221.clock_source_location_id",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_mappings_offset,\r\n{"Mappings Offset", "ieee17221.mappings_offset",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_number_of_mappings,\r\n{"Number of Mappings", "ieee17221.number_of_mappings",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_mappings,\r\n{"Mappings", "ieee17221.mappings",\r\nFT_NONE, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_mapping_stream_index,\r\n{"Mapping Stream Index", "ieee17221.mapping_stream_index",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_mapping_stream_channel,\r\n{"Mapping Stream Channel", "ieee17221.mapping_stream_channel",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_mapping_cluster_offset,\r\n{"Mapping Cluster Offset", "ieee17221.mapping_cluster_offset",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_mapping_cluster_channel,\r\n{"Mapping Cluster Channel", "ieee17221.mapping_cluster_channel",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_channel_count,\r\n{"Channel Count", "ieee17221.channel_count",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_path_latency,\r\n{"Path Latency", "ieee17221.path_latency",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_am824_label,\r\n{"AM824 Label", "ieee17221.am824_label",\r\nFT_UINT8, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_aem_cluster_name,\r\n{"Cluster Name", "ieee17221.cluster_name",\r\nFT_STRING, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_cluster_name_string,\r\n{"Cluster Name String", "ieee17221.cluster_name_string",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_aem_control_type,\r\n{"Control Type", "ieee17221.control_type",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_aem_control_location_type,\r\n{"Control Location Type", "ieee17221.control_location_type",\r\nFT_UINT16, BASE_HEX, VALS(aem_descriptor_type_vals), 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_control_location_id,\r\n{"Control Location ID", "ieee17221.control_location_id",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_aem_control_value_type,\r\n{"Control Value Type", "ieee17221.control_value_type",\r\nFT_UINT16, BASE_HEX, VALS(aem_control_value_type_vals), 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_control_domain,\r\n{"Control Domain", "ieee17221.control_domain",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_values_offset,\r\n{"Values Offset", "ieee17221.values_offset",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_number_of_values,\r\n{"Number Of Values", "ieee17221.number_of_values",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_control_latency,\r\n{"Control Latency", "ieee17221.control_latency",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_aem_sources_offset,\r\n{"Sources Offset", "ieee17221.sources_offset",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_current_signal_type,\r\n{"Current Signal Type", "ieee17221.current_signal_type",\r\nFT_UINT16, BASE_HEX, VALS(aem_descriptor_type_vals), 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_current_signal_id,\r\n{"Current Signal ID", "ieee17221.current_signal_id",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_default_signal_type,\r\n{"Default Signal Type", "ieee17221.default_signal_type",\r\nFT_UINT16, BASE_HEX, VALS(aem_descriptor_type_vals), 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_default_signal_id,\r\n{"Default Signal ID", "ieee17221.default_signal_id",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_aem_block_latency,\r\n{"Block Latency", "ieee17221.block_latency",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_reset_time,\r\n{"Reset Time", "ieee17221.reset_time",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_signal_type,\r\n{"Signal Type", "ieee17221.signal_type",\r\nFT_UINT16, BASE_HEX, VALS(aem_descriptor_type_vals), 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_signal_index,\r\n{"Signal Index", "ieee17221.signal_index",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_signal_output,\r\n{"Signal Output", "ieee17221.signal_output",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_aem_number_of_sources,\r\n{"Number of Sources", "ieee17221.number_of_sources",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_value_offset,\r\n{"Value Offset", "ieee17221.value_offset",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_width,\r\n{"Width", "ieee17221.width",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_height,\r\n{"Height", "ieee17221.height",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_base_source,\r\n{"Base Source", "ieee17221.base_source",\r\nFT_UINT16, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_number_destinations,\r\n{"Number of Destinations", "ieee17221.num_destinations",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_base_destination,\r\n{"Base Destination", "ieee17221.base_destination",\r\nFT_UINT16, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_aem_locale_identifier,\r\n{"Locale Identifier", "ieee17221.locale_identifier",\r\nFT_STRING, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_number_of_strings,\r\n{"Number of Strings", "ieee17221.number_of_strings",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_base_strings,\r\n{"Base Strings", "ieee17221.base_strings",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_string,\r\n{"String", "ieee17221.string",\r\nFT_STRING, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_signals_count,\r\n{"Signals Count", "ieee17221.signals_count",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_signals_offset,\r\n{"Signals Offset", "ieee17221.signals_offset",\r\nFT_UINT16, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_memory_object_type,\r\n{"Memory Object Type", "ieee17221.memory_object_type",\r\nFT_UINT16, BASE_HEX, VALS(aem_memory_object_type_vals), 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_target_descriptor_type,\r\n{"Target Descriptor Type", "ieee17221.target_descriptor_type",\r\nFT_UINT16, BASE_HEX, VALS(aem_descriptor_type_vals), 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_target_descriptor_id,\r\n{"Target Descriptor ID", "ieee17221.target_descriptor_id",\r\nFT_UINT16, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_start_address,\r\n{"Start Address", "ieee17221.start_address",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_length,\r\n{"Length", "ieee17221.length",\r\nFT_UINT64, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_ctrl_int8,\r\n{"Control INT8", "ieee17221.ctrl_int8",\r\nFT_INT8, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_ctrl_uint8,\r\n{"Control UINT8", "ieee17221.ctrl_uint8",\r\nFT_UINT8, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_ctrl_int16,\r\n{"Control INT16", "ieee17221.ctrl_int16",\r\nFT_INT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_ctrl_uint16,\r\n{"Control UINT16", "ieee17221.ctrl_uint16",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_ctrl_int32,\r\n{"Control INT32", "ieee17221.ctrl_int32",\r\nFT_INT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_ctrl_uint32,\r\n{"Control UINT32", "ieee17221.ctrl_uint32",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_ctrl_int64,\r\n{"Control INT64", "ieee17221.ctrl_int64",\r\nFT_INT64, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_ctrl_uint64,\r\n{"Control UINT64", "ieee17221.ctrl_uint64",\r\nFT_UINT64, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_ctrl_float,\r\n{"Control FLOAT", "ieee17221.ctrl_float",\r\nFT_FLOAT, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_ctrl_double,\r\n{"Control DOUBLE", "ieee17221.ctrl_double",\r\nFT_DOUBLE, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_ctrl_vals,\r\n{"Control Values", "ieee17221.ctrl_vals",\r\nFT_NONE, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_unit,\r\n{"Control Value Units", "ieee17221.units",\r\nFT_UINT16, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_string_ref,\r\n{"String Reference", "ieee17221.string_ref",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_guid,\r\n{"GUID", "ieee17221.guid",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_blob_size,\r\n{"Blob Size", "ieee17221.blob_size",\r\nFT_UINT32, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_binary_blob,\r\n{"Binary Blob", "ieee17221.binary_blob",\r\nFT_BYTES, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_sources,\r\n{"Sources", "ieee17221.sources",\r\nFT_NONE, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_unknown_descriptor,\r\n{"Unknown or Malformed Descriptor", "ieee17221.unknown_descriptor",\r\nFT_BYTES, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_frequency,\r\n{"Frequency", "ieee17221.frequency",\r\nFT_FLOAT, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_aem_oui24,\r\n{"OUI-24", "ieee17221.oui24",\r\nFT_UINT24, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_mfd_type,\r\n{"MFD Type", "ieee17221.mfd_type",\r\nFT_UINT8, BASE_HEX, VALS(aem_mfd_type_vals), 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_div,\r\n{"Div Flag", "ieee17221.div",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_interlace,\r\n{"Interlace Flag", "ieee17221.interlace",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_channels,\r\n{"Video Channel Count", "ieee17221.channels",\r\nFT_UINT8, BASE_DEC, NULL, AEM_MASK_CHANNELS, NULL, HFILL }\r\n},\r\n{ &hf_aem_color_format,\r\n{"Color Format", "ieee17221.color_format",\r\nFT_UINT16, BASE_HEX, VALS(aem_color_format_type_vals), AEM_MASK_COLOR_FORMAT, NULL, HFILL }\r\n},\r\n{ &hf_aem_bpp,\r\n{"Bits Per Pixel", "ieee17221.bpp",\r\nFT_UINT8, BASE_DEC, NULL, AEM_MASK_BPP, NULL, HFILL }\r\n},\r\n{ &hf_aem_aspect_x,\r\n{"Aspect X", "ieee17221.aspect_x",\r\nFT_UINT8, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_aspect_y,\r\n{"Aspect Y", "ieee17221.aspect_y",\r\nFT_UINT8, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_frame_rate,\r\n{"Frame Rate", "ieee17221.frame_rate",\r\nFT_UINT8, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_comp1,\r\n{"Comp 1", "ieee17221.comp1",\r\nFT_UINT16, BASE_DEC, NULL, AEM_MASK_COMP1, NULL, HFILL }\r\n},\r\n{ &hf_aem_comp2,\r\n{"Comp 2", "ieee17221.comp2",\r\nFT_UINT8, BASE_DEC, NULL, AEM_MASK_COMP2, NULL, HFILL }\r\n},\r\n{ &hf_aem_comp3,\r\n{"Comp 3", "ieee17221.comp3",\r\nFT_UINT16, BASE_DEC, NULL, AEM_MASK_COMP3, NULL, HFILL }\r\n},\r\n{ &hf_aem_comp4,\r\n{"Comp 4", "ieee17221.comp4",\r\nFT_UINT8, BASE_DEC, NULL, AEM_MASK_COMP4, NULL, HFILL }\r\n},\r\n{ &hf_aem_mf_width,\r\n{"Width", "ieee17221.width",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_mf_height,\r\n{"Height", "ieee17221.height",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_cs_eui64,\r\n{"CS EUI64", "ieee17221.cs_eui64",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_aem_stream_format,\r\n{"Stream Format", "ieee17221.stream_format",\r\nFT_NONE, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_sf_version,\r\n{"Version", "ieee17221.sf_version",\r\nFT_UINT8, BASE_HEX, NULL, AEM_MASK_SF_VERSION, NULL, HFILL }\r\n},\r\n{ &hf_aem_sf_subtype,\r\n{"Subtype", "ieee17221.sf_subtype",\r\nFT_UINT8, BASE_HEX, NULL, AEM_MASK_SF_SUBTYPE, NULL, HFILL }\r\n},\r\n{ &hf_aem_sf,\r\n{"SF", "ieee17221.sf",\r\nFT_BOOLEAN, 8, NULL, AEM_MASK_SF, NULL, HFILL }\r\n},\r\n{ &hf_aem_iidc_format,\r\n{"IIDC Format", "ieee17221.iidc_format",\r\nFT_UINT8, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_iidc_mode,\r\n{"IIDC Mode", "ieee17221.iidc_mode",\r\nFT_UINT8, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_iidc_rate,\r\n{"IIDC Rate", "ieee17221.iidc_rate",\r\nFT_UINT8, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_fmt,\r\n{"FMT", "ieee17221.fmt",\r\nFT_UINT8, BASE_HEX, NULL, AEM_MASK_FMT, NULL, HFILL }\r\n},\r\n{ &hf_aem_fdf_evt,\r\n{"FDF EVT", "ieee17221.fdf_evt",\r\nFT_UINT8, BASE_HEX, NULL, AEM_MASK_FDF_EVT, NULL, HFILL }\r\n},\r\n{ &hf_aem_fdf_sfc,\r\n{"FDF SFC", "ieee17221.fdf_sfc",\r\nFT_UINT8, BASE_HEX, NULL, AEM_MASK_FDF_SFC, NULL, HFILL }\r\n},\r\n{ &hf_aem_dbs,\r\n{"DBS", "ieee17221.dbs",\r\nFT_UINT8, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_b_flag,\r\n{"Blocking Flag", "ieee17221.flags.b",\r\nFT_BOOLEAN, 8, NULL, AEM_MASK_B, NULL, HFILL }\r\n},\r\n{ &hf_aem_nb_flag,\r\n{"NonBlocking Flag", "ieee17221.flags.nb",\r\nFT_BOOLEAN, 8, NULL, AEM_MASK_NB, NULL, HFILL }\r\n},\r\n{ &hf_aem_label_iec_60958_cnt,\r\n{"Label IEC 60958 Count", "ieee17221.label_iec_60958_cnt",\r\nFT_UINT8, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_label_mbla_cnt,\r\n{"Label Multi-Bit Linear Audio Count", "ieee17221.label_mbla_cnt",\r\nFT_UINT8, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_label_midi_cnt,\r\n{"Label Midi Slot Count", "ieee17221.label_midi_cnt",\r\nFT_UINT8, BASE_DEC, NULL, AEM_MASK_LABEL_MIDI_CNT, NULL, HFILL }\r\n},\r\n{ &hf_aem_label_smpte_cnt,\r\n{"Label SMPTE Slot Count", "ieee17221.label_smpte_cnt",\r\nFT_UINT8, BASE_DEC, NULL, AEM_MASK_LABEL_SMPTE_CNT, NULL, HFILL }\r\n},\r\n{ &hf_aem_video_mode,\r\n{"Video Mode", "ieee17221.video_mode",\r\nFT_UINT8, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_compress_mode,\r\n{"Compress Mode", "ieee17221.compress_mode",\r\nFT_UINT8, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aem_color_space,\r\n{"Color Space", "ieee17221.color_space",\r\nFT_UINT8, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_aecp_values,\r\n{"Values", "ieee17221.values",\r\nFT_BYTES, BASE_NONE, NULL, 0x00, NULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_aecp_status_code,\r\n{"Status", "ieee17221.status",\r\nFT_UINT8, BASE_HEX, VALS(aem_status_type_vals), AECP_STATUS_CODE_MASK, NULL, HFILL }\r\n},\r\n{ &hf_aecp_backup_talker_entity_id_0,\r\n{"Backup Talker Entity ID 0", "ieee17221.backup_talker_entity_id_0",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_backup_talker_unique_id_0,\r\n{"Backup Talker Unique ID 0", "ieee17221.backup_talker_unique_id_0",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_backup_talker_entity_id_1,\r\n{"Backup Talker Entity ID 1", "ieee17221.backup_talker_entity_id_1",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_backup_talker_unique_id_1,\r\n{"Backup Talker Unique ID 1", "ieee17221.backup_talker_unique_id_1",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_backup_talker_entity_id_2,\r\n{"Backup Talker Entity ID 2", "ieee17221.backup_talker_entity_id_2",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_backup_talker_unique_id_2,\r\n{"Backup Talker Unique ID 2", "ieee17221.backup_talker_unique_id_2",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_backedup_talker_entity_id,\r\n{"Backed up Talker Entity ID", "ieee17221.backedup_talker_entity_id",\r\nFT_UINT64, BASE_HEX, NULL, 0x00, NULL, HFILL }\r\n},\r\n{ &hf_aecp_backedup_talker_unique_id,\r\n{"Backedup Talker Unique ID", "ieee17221.backedup_talker_unique_id",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL }\r\n}\r\n};\r\nstatic gint *ett[] = {\r\n&ett_17221,\r\n&ett_adp_ent_cap,\r\n&ett_adp_talk_cap,\r\n&ett_adp_list_cap,\r\n&ett_adp_cont_cap,\r\n&ett_adp_samp_rates,\r\n&ett_adp_chan_format,\r\n&ett_acmp_flags,\r\n&ett_aem_desc_counts,\r\n&ett_aem_descriptor,\r\n&ett_aem_sample_rates,\r\n&ett_aem_stream_flags,\r\n&ett_aem_clock_sources,\r\n&ett_aem_stream_formats,\r\n&ett_aem_jack_flags,\r\n&ett_aem_port_flags,\r\n&ett_aecp_get_avb_info_msrp_mappings,\r\n&ett_aecp_get_as_path_sequences,\r\n&ett_aem_clock_source_flags,\r\n&ett_aem_mappings,\r\n&ett_aem_ctrl_vals,\r\n&ett_aem_sources,\r\n&ett_aecp_descriptors,\r\n&ett_aecp_flags_32,\r\n&ett_aem_stream_format,\r\n};\r\nproto_17221 = proto_register_protocol("IEEE 1722.1 Protocol", "IEEE1722.1", "ieee17221");\r\nproto_register_field_array(proto_17221, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid\r\nproto_reg_handoff_17221(void)\r\n{\r\ndissector_handle_t avb17221_handle;\r\navb17221_handle = create_dissector_handle(dissect_17221, proto_17221);\r\ndissector_add_uint("ieee1722.subtype", 0x7A, avb17221_handle);\r\ndissector_add_uint("ieee1722.subtype", 0x7B, avb17221_handle);\r\ndissector_add_uint("ieee1722.subtype", 0x7C, avb17221_handle);\r\n}
