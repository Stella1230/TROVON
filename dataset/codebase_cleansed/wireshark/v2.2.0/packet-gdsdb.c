static int dword_align(int length)\r\n{\r\nreturn (length + (4-(length&3)));\r\n}\r\nstatic int add_uint_string(proto_tree *tree, int hf_string, tvbuff_t *tvb, int offset)\r\n{\r\nproto_item* ti;\r\nint length;\r\nti = proto_tree_add_item(tree, hf_string, tvb,\r\noffset, 4, ENC_ASCII|ENC_BIG_ENDIAN);\r\nlength = dword_align(tvb_get_ntohl(tvb, offset))+4;\r\nproto_item_set_len(ti, length);\r\nreturn offset + length;\r\n}\r\nstatic int add_byte_array(proto_tree *tree, int hf_len, int hf_byte, tvbuff_t *tvb, int offset)\r\n{\r\nproto_item* ti;\r\nguint32 length;\r\nproto_tree_add_item_ret_uint(tree, hf_len, tvb,\r\noffset, 4, ENC_BIG_ENDIAN, &length);\r\noffset += 4;\r\nif (length > 0)\r\n{\r\nti = proto_tree_add_item(tree, hf_byte, tvb,\r\noffset, length, ENC_NA);\r\nlength = dword_align(length);\r\nproto_item_set_len(ti, length);\r\n}\r\nreturn offset + length;\r\n}\r\nstatic int\r\ngdsdb_dummy(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree _U_, int offset _U_)\r\n{\r\nreturn tvb_reported_length(tvb);\r\n}\r\nstatic int\r\ngdsdb_connect(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, int offset)\r\n{\r\nint count, file_size, total_length = 16;\r\nint i, length = tvb_reported_length_remaining(tvb, offset);\r\nproto_item *ti;\r\nproto_tree *pref_tree;\r\nif (length < total_length)\r\nreturn -1;\r\nfile_size = tvb_get_ntohl(tvb, offset+12);\r\ntotal_length += 4+dword_align(file_size);\r\nif (length < total_length+4)\r\nreturn -1;\r\ncount = tvb_get_ntohl(tvb, offset+total_length-4);\r\ntotal_length += (4+(count*20));\r\nif (length < total_length)\r\nreturn -1;\r\nproto_tree_add_item(tree, hf_gdsdb_connect_operation, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_gdsdb_connect_version, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_gdsdb_connect_client, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\noffset = add_uint_string(tree, hf_gdsdb_connect_filename, tvb, offset);\r\nproto_tree_add_item(tree, hf_gdsdb_connect_count, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ": %s", tvb_format_text(tvb, offset+4, tvb_get_ntohl(tvb, offset)));\r\noffset = add_uint_string(tree, hf_gdsdb_connect_userid, tvb, offset);\r\nfor(i=0;i<count;i++){\r\nti = proto_tree_add_item(tree, hf_gdsdb_connect_pref, tvb, offset, 20, ENC_NA);\r\npref_tree = proto_item_add_subtree(ti, ett_gdsdb_connect_pref);\r\nproto_tree_add_item(pref_tree, hf_gdsdb_connect_pref_version,\r\ntvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(pref_tree, hf_gdsdb_connect_pref_architecture,\r\ntvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(pref_tree, hf_gdsdb_connect_pref_mintype,\r\ntvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(pref_tree, hf_gdsdb_connect_pref_maxtype,\r\ntvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(pref_tree, hf_gdsdb_connect_pref_weight,\r\ntvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ngdsdb_accept(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nif (tvb_reported_length_remaining(tvb, offset) < 12) {\r\nreturn -1;\r\n}\r\nproto_tree_add_item(tree, hf_gdsdb_accept_version, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_gdsdb_accept_architecture, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_gdsdb_accept_proto_min_type, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\ngdsdb_request(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nif (tvb_reported_length_remaining(tvb, offset) < 16) {\r\nreturn -1;\r\n}\r\nproto_tree_add_item(tree, hf_gdsdb_request_type, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_gdsdb_request_object, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_gdsdb_request_partner, tvb, offset, 8, ENC_BIG_ENDIAN);\r\noffset += 8;\r\nreturn offset;\r\n}\r\nstatic int\r\ngdsdb_attach(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, int offset)\r\n{\r\nint total_length = 12;\r\nint size, length = tvb_reported_length_remaining(tvb, offset);\r\nif (length < total_length) {\r\nreturn -1;\r\n}\r\nsize = tvb_get_ntohl(tvb, offset+4);\r\ntotal_length += dword_align(size);\r\nif (length < total_length)\r\nreturn -1;\r\nsize = tvb_get_ntohl(tvb, offset+total_length-4);\r\ntotal_length += dword_align(size);\r\nif (length < total_length)\r\nreturn -1;\r\nproto_tree_add_item(tree, hf_gdsdb_attach_database_object_id, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ": %s", tvb_format_text(tvb, offset+4, tvb_get_ntohl(tvb, offset)));\r\noffset = add_uint_string(tree, hf_gdsdb_attach_database_path, tvb, offset);\r\noffset = add_uint_string(tree, hf_gdsdb_attach_database_param_buf, tvb, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ngdsdb_compile(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nint total_length = 8;\r\nint size, length = tvb_reported_length_remaining(tvb, offset);\r\nif (length < total_length) {\r\nreturn -1;\r\n}\r\nsize = tvb_get_ntohl(tvb, offset+4);\r\ntotal_length += dword_align(size);\r\nif (length < total_length)\r\nreturn -1;\r\nproto_tree_add_item(tree, hf_gdsdb_compile_database, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\noffset = add_uint_string(tree, hf_gdsdb_compile_blr, tvb, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ngdsdb_receive(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nif (tvb_reported_length_remaining(tvb, offset) < 20) {\r\nreturn -1;\r\n}\r\nproto_tree_add_item(tree, hf_gdsdb_receive_request, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_gdsdb_receive_incarnation, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_gdsdb_receive_transaction, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_gdsdb_receive_msgnr, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_gdsdb_receive_messages, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nwhile (tvb_reported_length_remaining(tvb, offset) >= 12) {\r\nproto_tree_add_item(tree, hf_gdsdb_receive_direction,\r\ntvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_gdsdb_receive_offset,\r\ntvb, offset, 8, ENC_BIG_ENDIAN);\r\noffset += 8;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ngdsdb_send(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nif (tvb_reported_length_remaining(tvb, offset) < 20) {\r\nreturn -1;\r\n}\r\nproto_tree_add_item(tree, hf_gdsdb_send_request, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_gdsdb_send_incarnation, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_gdsdb_send_transaction, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_gdsdb_send_msgnr, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_gdsdb_send_messages, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\ngdsdb_status_vector(proto_tree *tree, tvbuff_t *tvb, int offset)\r\n{\r\nguint32 arg;\r\nwhile (tvb_reported_length_remaining(tvb, offset) >= 4)\r\n{\r\nproto_tree_add_item_ret_uint(tree, hf_gdsdb_status_vector_arg, tvb,\r\noffset, 4, ENC_BIG_ENDIAN, &arg);\r\noffset += 4;\r\nif (arg == 0)\r\nbreak;\r\nswitch(arg)\r\n{\r\ncase arg_gds:\r\ndefault:\r\nproto_tree_add_item(tree, hf_gdsdb_status_vector_error_code, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nbreak;\r\ncase arg_number:\r\nproto_tree_add_item(tree, hf_gdsdb_status_vector_number, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nbreak;\r\ncase arg_string:\r\ncase arg_interpreted:\r\noffset = add_uint_string(tree, hf_gdsdb_status_vector_string, tvb, offset);\r\nbreak;\r\ncase arg_sql_state:\r\noffset = add_uint_string(tree, hf_gdsdb_status_vector_sql_state, tvb, offset);\r\nbreak;\r\n}\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ngdsdb_response(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nint total_length = 16;\r\nint length = tvb_reported_length_remaining(tvb, offset);\r\nguint32 size_length;\r\nif (length < total_length) {\r\nreturn -1;\r\n}\r\ntotal_length += dword_align(tvb_get_ntohl(tvb, offset+12));\r\nif (length < total_length) {\r\nreturn -1;\r\n}\r\nproto_tree_add_item(tree, hf_gdsdb_response_object, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_gdsdb_response_blobid, tvb,\r\noffset, 8, ENC_BIG_ENDIAN);\r\noffset += 8;\r\nproto_tree_add_item_ret_uint(tree, hf_gdsdb_response_datasize, tvb,\r\noffset, 4, ENC_BIG_ENDIAN, &size_length);\r\noffset += 4;\r\nif (size_length > 0)\r\nproto_tree_add_item(tree, hf_gdsdb_response_data, tvb, offset, size_length, ENC_NA);\r\noffset += size_length;\r\nreturn gdsdb_status_vector(tree, tvb, offset);\r\n}\r\nstatic int\r\ngdsdb_transact(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nif (tvb_reported_length_remaining(tvb, offset) < 8) {\r\nreturn -1;\r\n}\r\nproto_tree_add_item(tree, hf_gdsdb_transact_database, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_gdsdb_transact_transaction, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\ngdsdb_transact_response(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nif (tvb_reported_length_remaining(tvb, offset) < 4) {\r\nreturn -1;\r\n}\r\nproto_tree_add_item(tree, hf_gdsdb_transactresponse_messages,\r\ntvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\ngdsdb_open_blob2(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nint total_length = 12;\r\nint length = tvb_reported_length_remaining(tvb, offset);\r\nif (length < total_length) {\r\nreturn -1;\r\n}\r\ntotal_length += dword_align(tvb_get_ntohl(tvb, offset));\r\nif (length < total_length) {\r\nreturn -1;\r\n}\r\noffset = add_uint_string(tree, hf_gdsdb_openblob2_bpb, tvb, offset);\r\nproto_tree_add_item(tree, hf_gdsdb_openblob_transaction, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_gdsdb_openblob_id, tvb, offset,\r\n8, ENC_BIG_ENDIAN);\r\noffset += 8;\r\nreturn offset;\r\n}\r\nstatic int\r\ngdsdb_open_blob(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nif (tvb_reported_length_remaining(tvb, offset) < 8) {\r\nreturn -1;\r\n}\r\nproto_tree_add_item(tree, hf_gdsdb_openblob_transaction, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_gdsdb_openblob_id, tvb, offset,\r\n8, ENC_BIG_ENDIAN);\r\noffset += 8;\r\nreturn offset;\r\n}\r\nstatic int\r\ngdsdb_segment(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nif (tvb_reported_length_remaining(tvb, offset) < 12)\r\nreturn -1;\r\nif (tree) {\r\n}\r\nreturn tvb_reported_length(tvb);\r\n}\r\nstatic int\r\ngdsdb_seek_blob(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nif (tvb_reported_length_remaining(tvb, offset) < 12)\r\nreturn -1;\r\nif (tree) {\r\n}\r\nreturn tvb_reported_length(tvb);\r\n}\r\nstatic int\r\ngdsdb_reconnect(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nint total_length = 8;\r\nint length = tvb_reported_length_remaining(tvb, offset);\r\nif (length < total_length) {\r\nreturn -1;\r\n}\r\ntotal_length += dword_align(tvb_get_ntohl(tvb, offset+4));\r\nif (length < total_length) {\r\nreturn -1;\r\n}\r\nproto_tree_add_item(tree, hf_gdsdb_reconnect_handle, tvb, offset,\r\n4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\noffset = add_byte_array(tree, hf_gdsdb_reconnect_database_size, hf_gdsdb_reconnect_database, tvb, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ngdsdb_info(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nguint opcode;\r\nint total_length = 16;\r\nint length = tvb_reported_length_remaining(tvb, offset);\r\nif (length < total_length) {\r\nreturn -1;\r\n}\r\nopcode = tvb_get_ntohl(tvb, offset-4);\r\ntotal_length += dword_align(tvb_get_ntohl(tvb, offset+8));\r\nif (length < total_length) {\r\nreturn -1;\r\n}\r\nif(opcode == op_service_info) {\r\ntotal_length += dword_align(tvb_get_ntohl(tvb, offset+total_length-8));\r\nif (length < total_length) {\r\nreturn -1;\r\n}\r\n}\r\nproto_tree_add_item(tree, hf_gdsdb_info_object, tvb, offset,\r\n4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_gdsdb_info_incarnation, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\noffset = add_uint_string(tree, hf_gdsdb_info_items, tvb, offset);\r\nif(opcode == op_service_info) {\r\noffset = add_uint_string(tree, hf_gdsdb_info_recv_items, tvb, offset);\r\n}\r\nproto_tree_add_item(tree, hf_gdsdb_info_buffer_length, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\ngdsdb_service_start(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nif (tvb_reported_length_remaining(tvb, offset) < 16)\r\nreturn -1;\r\nif (tree) {\r\n}\r\nreturn tvb_reported_length(tvb);\r\n}\r\nstatic int\r\ngdsdb_release(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nif (tvb_reported_length_remaining(tvb, offset) < 4)\r\nreturn -1;\r\nproto_tree_add_item(tree, hf_gdsdb_release_object, tvb, offset,\r\n4, ENC_BIG_ENDIAN);\r\nreturn tvb_reported_length(tvb);\r\n}\r\nstatic int\r\ngdsdb_event(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nif (tvb_reported_length_remaining(tvb, offset) < 20)\r\nreturn -1;\r\nif (tree) {\r\n}\r\nreturn tvb_reported_length(tvb);\r\n}\r\nstatic int\r\ngdsdb_cancel_events(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nif (tvb_reported_length_remaining(tvb, offset) < 8)\r\nreturn -1;\r\nif (tree) {\r\n}\r\nreturn tvb_reported_length(tvb);\r\n}\r\nstatic int\r\ngdsdb_ddl(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nif (tvb_reported_length_remaining(tvb, offset) < 12)\r\nreturn -1;\r\nif (tree) {\r\n}\r\nreturn tvb_reported_length(tvb);\r\n}\r\nstatic int\r\ngdsdb_slice(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nif (tvb_reported_length_remaining(tvb, offset) < 20)\r\nreturn -1;\r\nif (tree) {\r\n}\r\nreturn tvb_reported_length(tvb);\r\n}\r\nstatic int\r\ngdsdb_slice_response(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nif (tvb_reported_length_remaining(tvb, offset) < 4)\r\nreturn -1;\r\nif (tree) {\r\n}\r\nreturn tvb_reported_length(tvb);\r\n}\r\nstatic int\r\ngdsdb_execute(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nif (tvb_reported_length_remaining(tvb, offset) < 16)\r\nreturn -1;\r\nproto_tree_add_item(tree, hf_gdsdb_execute_statement, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_gdsdb_execute_transaction, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_gdsdb_execute_message_number, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_gdsdb_execute_messages, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\nreturn tvb_reported_length(tvb);\r\n}\r\nstatic int\r\ngdsdb_exec_immediate2(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nif (tvb_reported_length_remaining(tvb, offset) < 40)\r\nreturn -1;\r\nif (tree) {\r\n}\r\nreturn tvb_reported_length(tvb);\r\n}\r\nstatic int\r\ngdsdb_prepare(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, int offset)\r\n{\r\nint total_length = 20;\r\nint length = tvb_reported_length_remaining(tvb, offset);\r\nif (length < total_length) {\r\nreturn -1;\r\n}\r\ntotal_length += dword_align(tvb_get_ntohl(tvb, offset+12));\r\nif (length < total_length) {\r\nreturn -1;\r\n}\r\nproto_tree_add_item(tree, hf_gdsdb_prepare_transaction, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_gdsdb_prepare_statement, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_gdsdb_prepare_dialect, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ": %s", tvb_format_text(tvb, offset+4, tvb_get_ntohl(tvb, offset)));\r\noffset = add_uint_string(tree, hf_gdsdb_prepare_querystr, tvb, offset);\r\nproto_tree_add_item(tree, hf_gdsdb_prepare_bufferlength, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\ngdsdb_fetch(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nif (tvb_reported_length_remaining(tvb, offset) < 12) {\r\nreturn -1;\r\n}\r\nif (tree) {\r\n}\r\nreturn tvb_reported_length(tvb);\r\n}\r\nstatic int\r\ngdsdb_fetch_response(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nif (tvb_reported_length_remaining(tvb, offset) < 8) {\r\nreturn -1;\r\n}\r\nif (tree) {\r\n}\r\nreturn tvb_reported_length(tvb);\r\n}\r\nstatic int\r\ngdsdb_free_statement(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nif (tvb_reported_length_remaining(tvb, offset) < 8) {\r\nreturn -1;\r\n}\r\nproto_tree_add_item(tree, hf_gdsdb_free_statement, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_gdsdb_free_option, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\ngdsdb_insert(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nif (tvb_reported_length_remaining(tvb, offset) < 12) {\r\nreturn -1;\r\n}\r\nif (tree) {\r\n}\r\nreturn tvb_reported_length(tvb);\r\n}\r\nstatic int\r\ngdsdb_cursor(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nif (tvb_reported_length_remaining(tvb, offset) < 12) {\r\nreturn -1;\r\n}\r\nif (tree) {\r\n}\r\nreturn tvb_reported_length(tvb);\r\n}\r\nstatic int\r\ngdsdb_sql_response(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nif (tvb_reported_length_remaining(tvb, offset) < 4) {\r\nreturn -1;\r\n}\r\nif (tree) {\r\n}\r\nreturn tvb_reported_length(tvb);\r\n}\r\nstatic int\r\ndissect_gdsdb(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data _U_)\r\n{\r\nproto_item *ti;\r\nproto_tree *gdsdb_tree;\r\nguint opcode;\r\nint offset = 0;\r\nif (tvb_reported_length(tvb) < 4)\r\nreturn 0;\r\nopcode = tvb_get_ntohl(tvb, offset);\r\nif(opcode >= op_max)\r\nreturn 0;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "GDS DB");\r\ncol_clear(pinfo->cinfo, COL_INFO);\r\nwhile (tvb_reported_length_remaining(tvb, offset) >= 4)\r\n{\r\nopcode = tvb_get_ntohl(tvb, offset);\r\nif(opcode >= op_max)\r\nreturn 0;\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, ", ",\r\nval_to_str(opcode, gdsdb_opcode, "Unknown opcode %u"));\r\nti = proto_tree_add_item(tree, proto_gdsdb, tvb, offset, -1, ENC_NA);\r\ngdsdb_tree = proto_item_add_subtree(ti, ett_gdsdb);\r\nproto_tree_add_item(gdsdb_tree, hf_gdsdb_opcode, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset = gdsdb_handle_opcode[opcode](tvb, pinfo, gdsdb_tree, offset+4);\r\nif (offset < 0)\r\n{\r\npinfo->desegment_len = DESEGMENT_ONE_MORE_SEGMENT;\r\nreturn -1;\r\n}\r\n}\r\nreturn offset;\r\n}\r\nvoid\r\nproto_register_gdsdb(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_gdsdb_opcode,\r\n{ "Opcode", "gdsdb.opcode",\r\nFT_UINT32, BASE_DEC, VALS(gdsdb_opcode), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_connect_operation,\r\n{ "Operation", "gdsdb.connect.operation",\r\nFT_UINT32, BASE_DEC, VALS(gdsdb_opcode), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_connect_version,\r\n{ "Version", "gdsdb.connect.version",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_connect_client,\r\n{ "Client Architecture", "gdsdb.connect.client",\r\nFT_UINT32, BASE_DEC, VALS(gdsdb_architectures), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_connect_filename,\r\n{ "Filename", "gdsdb.connect.filename",\r\nFT_UINT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_connect_count,\r\n{ "Version option count", "gdsdb.connect.count",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_connect_userid,\r\n{ "User ID", "gdsdb.connect.userid",\r\nFT_UINT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_connect_pref,\r\n{ "Preferred version", "gdsdb.connect.pref",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_connect_pref_version,\r\n{ "Version", "gdsdb.connect.pref.version",\r\nFT_INT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_connect_pref_architecture,\r\n{ "Architecture", "gdsdb.connect.pref.arch",\r\nFT_UINT32, BASE_DEC, VALS(gdsdb_architectures), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_connect_pref_mintype,\r\n{ "Minimum type", "gdsdb.connect.pref.mintype",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_connect_pref_maxtype,\r\n{ "Maximum type", "gdsdb.connect.pref.maxtype",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_connect_pref_weight,\r\n{ "Preference weight", "gdsdb.connect.pref.weight",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_accept_version,\r\n{ "Version", "gdsdb.accept.version",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_accept_architecture,\r\n{ "Architecture", "gdsdb.accept.arch",\r\nFT_UINT32, BASE_DEC, VALS(gdsdb_architectures), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_accept_proto_min_type,\r\n{ "Protocol Minimum Type", "gdsdb.accept.proto_min_type",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_request_type,\r\n{ "Type", "gdsdb.connect.type",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_request_object,\r\n{ "Object", "gdsdb.connect.object",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_request_partner,\r\n{ "Partner", "gdsdb.connect.partner",\r\nFT_UINT64, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_attach_database_object_id,\r\n{ "Database ObjectID", "gdsdb.attach.database_object_id",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_attach_database_path,\r\n{ "Database Path", "gdsdb.attach.database_path",\r\nFT_UINT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_attach_database_param_buf,\r\n{ "Database Parameter Buffers", "gdsdb.attach.database_param_buf",\r\nFT_UINT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_compile_database,\r\n{ "Database", "gdsdb.compile.filename",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_compile_blr,\r\n{ "BLR", "gdsdb.compile.blr",\r\nFT_UINT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_receive_request,\r\n{ "Request", "gdsdb.receive.request",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_receive_incarnation,\r\n{ "Incarnation", "gdsdb.receive.incarnation",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_receive_transaction,\r\n{ "Transaction", "gdsdb.receive.transaction",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_receive_msgnr,\r\n{ "Message number", "gdsdb.receive.msgnr",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_receive_messages,\r\n{ "Message Count", "gdsdb.receive.msgcount",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_receive_direction,\r\n{ "Scroll direction", "gdsdb.receive.direction",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_receive_offset,\r\n{ "Scroll offset", "gdsdb.receive.offset",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_send_request,\r\n{ "Send request", "gdsdb.send.request",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_send_incarnation,\r\n{ "Send request", "gdsdb.send.incarnation",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_send_transaction,\r\n{ "Send request", "gdsdb.send.transaction",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_send_msgnr,\r\n{ "Send request", "gdsdb.send.msgnr",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_send_messages,\r\n{ "Send request", "gdsdb.send.messages",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_response_object,\r\n{ "Response object", "gdsdb.response.object",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_response_blobid,\r\n{ "Blob ID", "gdsdb.response.blobid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_response_datasize,\r\n{ "Data size", "gdsdb.response.datasize",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_response_data,\r\n{ "Data", "gdsdb.response.data",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_status_vector_arg,\r\n{ "Argument", "gdsdb.status_vector.arg",\r\nFT_UINT32, BASE_DEC, VALS(gdsdb_arg_types), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_status_vector_error_code,\r\n{ "Error code", "gdsdb.status_vector.error_code",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_status_vector_number,\r\n{ "Number", "gdsdb.status_vector.number",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_status_vector_string,\r\n{ "String", "gdsdb.status_vector.string",\r\nFT_UINT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_status_vector_sql_state,\r\n{ "SQL State", "gdsdb.status_vector.sql_state",\r\nFT_UINT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_transact_database,\r\n{ "Database", "gdsdb.transact.database",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_transact_transaction,\r\n{ "Database", "gdsdb.transact.transaction",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_gdsdb_transact_messages,\r\n{ "Messages", "gdsdb.transact.messages",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_gdsdb_transactresponse_messages,\r\n{ "Messages", "gdsdb.transactresponse.messages",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_openblob2_bpb,\r\n{ "Blob parameter block", "gdsdb.openblob2.bpb",\r\nFT_UINT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_openblob_transaction,\r\n{ "Transaction", "gdsdb.openblob2.transaction",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_openblob_id,\r\n{ "ID", "gdsdb.openblob.id",\r\nFT_UINT64, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_gdsdb_segment_blob,\r\n{ "Blob", "gdsdb.segment.blob",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_segment_length,\r\n{ "Length", "gdsdb.segment.length",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_segment_segment,\r\n{ "Segment", "gdsdb.segment.segment",\r\nFT_UINT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_seekblob_blob,\r\n{ "Blob", "gdsdb.seekblob.blob",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_seekblob_mode,\r\n{ "Mode", "gdsdb.seekblob.mode",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_gdsdb_reconnect_handle,\r\n{ "Handle", "gdsdb.reconnect.handle",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_reconnect_database_size,\r\n{ "Database size", "gdsdb.reconnect.database_size",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_reconnect_database,\r\n{ "Database", "gdsdb.reconnect.database",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_info_object,\r\n{ "Object", "gdsdb.info.object",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_info_incarnation,\r\n{ "Incarnation", "gdsdb.info.incarnation",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_info_items,\r\n{ "Items", "gdsdb.info.items",\r\nFT_UINT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_info_recv_items,\r\n{ "Items", "gdsdb.info.recv_items",\r\nFT_UINT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_info_buffer_length,\r\n{ "Buffer length", "gdsdb.info.bufferlength",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_release_object,\r\n{ "Object", "gdsdb.release.object",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_gdsdb_prepare2_transaction,\r\n{ "Transaction", "gdsdb.prepare2.transaction",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_event_database,\r\n{ "Database", "gdsdb.event.database",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_event_items,\r\n{ "Event description block", "gdsdb.event.items",\r\nFT_UINT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_event_ast,\r\n{ "ast routine", "gdsdb.event.ast",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_event_arg,\r\n{ "Argument to ast routine", "gdsdb.event.arg",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_event_rid,\r\n{ "ID", "gdsdb.event.id",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_ddl_database,\r\n{ "Database", "gdsdb.ddl.database",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_ddl_transaction,\r\n{ "Transaction", "gdsdb.ddl.transaction",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_ddl_blr,\r\n{ "BLR", "gdsdb.ddl.blr",\r\nFT_UINT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_slice_transaction,\r\n{ "Transaction", "gdsdb.slice.transaction",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_slice_id,\r\n{ "ID", "gdsdb.slice.id",\r\nFT_UINT64, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_slice_sdl,\r\n{ "Slice description language", "gdsdb.slice.sdl",\r\nFT_UINT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_slice_parameters,\r\n{ "Parameters", "gdsdb.slice.parameters",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_sliceresponse_length,\r\n{ "Length", "gdsdb.sliceresponse.length",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_gdsdb_execute_statement,\r\n{ "Statement", "gdsdb.execute.statement",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_execute_transaction,\r\n{ "Transaction", "gdsdb.execute.transaction",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_execute_message_number,\r\n{ "Message number", "gdsdb.execute.messagenumber",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_execute_messages,\r\n{ "Number of messages", "gdsdb.execute.messages",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_gdsdb_execute_outblr,\r\n{ "Output BLR", "gdsdb.execute.outblr",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_execute_outmsgnr,\r\n{ "Output Message number", "gdsdb.execute.outmsgnr",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_prepare2_blr,\r\n{ "BLR", "gdsdb.prepare.blr",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_prepare2_number,\r\n{ "Message number", "gdsdb.prepare2.messagenumber",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_prepare2_messages,\r\n{ "Number of messages", "gdsdb.prepare2.messages",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_prepare2_outblr,\r\n{ "Output BLR", "gdsdb.prepare2.outblr",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_prepare2_outmsgnr,\r\n{ "Output Message number", "gdsdb.prepare2.outmsgnr",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_gdsdb_prepare_transaction,\r\n{ "Prepare, Transaction", "gdsdb.prepare.transaction",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_prepare_statement,\r\n{ "Prepare, Statement", "gdsdb.prepare.statement",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_prepare_dialect,\r\n{ "Prepare, Dialect", "gdsdb.prepare.dialect",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_prepare_querystr,\r\n{ "Prepare, Query", "gdsdb.prepare.querystr",\r\nFT_UINT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_prepare_bufferlength,\r\n{ "Prepare, Bufferlength", "gdsdb.prepare.bufferlen",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_gdsdb_fetch_statement,\r\n{ "Statement", "gdsdb.fetch.statement",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_fetch_message_number,\r\n{ "Message number", "gdsdb.fetch.messagenr",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_fetch_messages,\r\n{ "Number of messages", "gdsdb.fetch.messages",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_fetchresponse_status,\r\n{ "Status", "gdsdb.fetchresponse.status",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_fetchresponse_messages,\r\n{ "Number of messages", "gdsdb.fetchresponse.messages",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_gdsdb_free_statement,\r\n{ "Statement", "gdsdb.fetchresponse.statement",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_free_option,\r\n{ "Option", "gdsdb.fetchresponse.option",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_gdsdb_insert_statement,\r\n{ "Statement", "gdsdb.insert.statement",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_insert_message_number,\r\n{ "Message number", "gdsdb.insert.messagenr",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_insert_messages,\r\n{ "Number of messages", "gdsdb.insert.messages",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_cursor_statement,\r\n{ "Statement", "gdsdb.cursor.statement",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_cursor_type,\r\n{ "Type", "gdsdb.cursor.type",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gdsdb_sqlresponse_messages,\r\n{ "SQL Response, Message Count", "gdsdb.sqlresponse.msgcount",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n}\r\n#endif\r\n};\r\nstatic gint *ett[] = {\r\n&ett_gdsdb,\r\n&ett_gdsdb_connect_pref\r\n};\r\nproto_gdsdb = proto_register_protocol(\r\n"Firebird SQL Database Remote Protocol",\r\n"FB/IB GDS DB", "gdsdb");\r\nproto_register_field_array(proto_gdsdb, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid\r\nproto_reg_handoff_gdsdb(void)\r\n{\r\ndissector_handle_t gdsdb_handle;\r\ngdsdb_handle = create_dissector_handle(dissect_gdsdb,\r\nproto_gdsdb);\r\ndissector_add_uint("tcp.port", TCP_PORT, gdsdb_handle);\r\n}
