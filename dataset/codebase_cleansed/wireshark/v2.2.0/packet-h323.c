gef_ctx_t* gef_ctx_alloc(gef_ctx_t *parent, const gchar *type) {\r\ngef_ctx_t *gefx;\r\ngefx = wmem_new0(wmem_packet_scope(), gef_ctx_t);\r\ngefx->signature = GEF_CTX_SIGNATURE;\r\ngefx->parent = parent;\r\ngefx->type = type;\r\nreturn gefx;\r\n}\r\ngboolean gef_ctx_check_signature(gef_ctx_t *gefx) {\r\nreturn gefx && (gefx->signature == GEF_CTX_SIGNATURE);\r\n}\r\ngef_ctx_t* gef_ctx_get(void *ptr) {\r\ngef_ctx_t *gefx = (gef_ctx_t*)ptr;\r\nasn1_ctx_t *actx = (asn1_ctx_t*)ptr;\r\nif (!asn1_ctx_check_signature(actx))\r\nactx = NULL;\r\nif (actx)\r\ngefx = (gef_ctx_t *)actx->private_data;\r\nif (!gef_ctx_check_signature(gefx))\r\ngefx = NULL;\r\nreturn gefx;\r\n}\r\nvoid gef_ctx_update_key(gef_ctx_t *gefx) {\r\nconst gchar *parent_key;\r\nif (!gefx) return;\r\nparent_key = (gefx->parent) ? gefx->parent->key : NULL;\r\ngefx->key = wmem_strdup_printf(wmem_packet_scope(),\r\n"%s%s"\r\n"%s%s%s"\r\n"%s%s" ,\r\n(parent_key) ? parent_key : "", (parent_key) ? "/" : "",\r\n(gefx->type) ? gefx->type : "", (gefx->type && (gefx->id || gefx->subid)) ? "/" : "", (gefx->id) ? gefx->id : "",\r\n(gefx->subid) ? "-" : "", (gefx->subid) ? gefx->subid : ""\r\n);\r\n}\r\nstatic int\r\ndissect_h323_OCTET_STRING(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_octet_string(tvb, offset, actx, tree, hf_index,\r\nNO_BOUND, NO_BOUND, FALSE, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h323_T_messageContent(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_sequence_of(tvb, offset, actx, tree, hf_index,\r\nett_h323_T_messageContent, T_messageContent_sequence_of);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h323_NULL(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_null(tvb, offset, actx, tree, hf_index);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h323_RasTunnelledSignallingMessage(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,\r\nett_h323_RasTunnelledSignallingMessage, RasTunnelledSignallingMessage_sequence);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h323_INTEGER_1_256(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,\r\n1U, 256U, NULL, FALSE);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h323_BackupCallSignalAddresses_item(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_choice(tvb, offset, actx, tree, hf_index,\r\nett_h323_BackupCallSignalAddresses_item, BackupCallSignalAddresses_item_choice,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h323_BackupCallSignalAddresses(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_sequence_of(tvb, offset, actx, tree, hf_index,\r\nett_h323_BackupCallSignalAddresses, BackupCallSignalAddresses_sequence_of);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h323_Rrq_RD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,\r\nett_h323_Rrq_RD, Rrq_RD_sequence);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h323_INTEGER_1_65535(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,\r\n1U, 65535U, NULL, FALSE);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h323_Rcf_RD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,\r\nett_h323_Rcf_RD, Rcf_RD_sequence);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h323_GloballyUniqueIdentifier(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_h225_GloballyUniqueID(tvb, offset, actx, tree, hf_index);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h323_Setup_RD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,\r\nett_h323_Setup_RD, Setup_RD_sequence);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h323_Connect_RD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,\r\nett_h323_Connect_RD, Connect_RD_sequence);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h323_T_fastStart(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_sequence_of(tvb, offset, actx, tree, hf_index,\r\nett_h323_T_fastStart, T_fastStart_sequence_of);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h323_Status_RD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,\r\nett_h323_Status_RD, Status_RD_sequence);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h323_StatusInquiry_RD(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,\r\nett_h323_StatusInquiry_RD, StatusInquiry_RD_sequence);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h323_T_robustnessData(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_choice(tvb, offset, actx, tree, hf_index,\r\nett_h323_T_robustnessData, T_robustnessData_choice,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h323_RobustnessData(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,\r\nett_h323_RobustnessData, RobustnessData_sequence);\r\nreturn offset;\r\n}\r\nstatic int dissect_RasTunnelledSignallingMessage_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_PER, TRUE, pinfo);\r\noffset = dissect_h323_RasTunnelledSignallingMessage(tvb, offset, &asn1_ctx, tree, hf_h323_RasTunnelledSignallingMessage_PDU);\r\noffset += 7; offset >>= 3;\r\nreturn offset;\r\n}\r\nstatic int dissect_RobustnessData_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_PER, TRUE, pinfo);\r\noffset = dissect_h323_RobustnessData(tvb, offset, &asn1_ctx, tree, hf_h323_RobustnessData_PDU);\r\noffset += 7; offset >>= 3;\r\nreturn offset;\r\n}\r\nvoid proto_register_h323(void) {\r\nstatic hf_register_info hf[] = {\r\n#line 1 "./asn1/h323/packet-h323-hfarr.c"\r\n{ &hf_h323_RasTunnelledSignallingMessage_PDU,\r\n{ "RasTunnelledSignallingMessage", "h323.RasTunnelledSignallingMessage_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_h323_RobustnessData_PDU,\r\n{ "RobustnessData", "h323.RobustnessData_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_h323_tunnelledProtocolID,\r\n{ "tunnelledProtocolID", "h323.tunnelledProtocolID_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"TunnelledProtocol", HFILL }},\r\n{ &hf_h323_messageContent,\r\n{ "messageContent", "h323.messageContent",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_h323_messageContent_item,\r\n{ "messageContent item", "h323.messageContent_item",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"OCTET_STRING", HFILL }},\r\n{ &hf_h323_tunnellingRequired,\r\n{ "tunnellingRequired", "h323.tunnellingRequired_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_h323_nonStandardData,\r\n{ "nonStandardData", "h323.nonStandardData_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"NonStandardParameter", HFILL }},\r\n{ &hf_h323_versionID,\r\n{ "versionID", "h323.versionID",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"INTEGER_1_256", HFILL }},\r\n{ &hf_h323_robustnessData,\r\n{ "robustnessData", "h323.robustnessData",\r\nFT_UINT32, BASE_DEC, VALS(h323_T_robustnessData_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_h323_rrqData,\r\n{ "rrqData", "h323.rrqData_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"Rrq_RD", HFILL }},\r\n{ &hf_h323_rcfData,\r\n{ "rcfData", "h323.rcfData_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"Rcf_RD", HFILL }},\r\n{ &hf_h323_setupData,\r\n{ "setupData", "h323.setupData_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"Setup_RD", HFILL }},\r\n{ &hf_h323_connectData,\r\n{ "connectData", "h323.connectData_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"Connect_RD", HFILL }},\r\n{ &hf_h323_statusData,\r\n{ "statusData", "h323.statusData_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"Status_RD", HFILL }},\r\n{ &hf_h323_statusInquiryData,\r\n{ "statusInquiryData", "h323.statusInquiryData_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"StatusInquiry_RD", HFILL }},\r\n{ &hf_h323_BackupCallSignalAddresses_item,\r\n{ "BackupCallSignalAddresses item", "h323.BackupCallSignalAddresses_item",\r\nFT_UINT32, BASE_DEC, VALS(h323_BackupCallSignalAddresses_item_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_h323_tcp,\r\n{ "tcp", "h323.tcp",\r\nFT_UINT32, BASE_DEC, VALS(h225_TransportAddress_vals), 0,\r\n"TransportAddress", HFILL }},\r\n{ &hf_h323_alternateTransport,\r\n{ "alternateTransport", "h323.alternateTransport_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"AlternateTransportAddresses", HFILL }},\r\n{ &hf_h323_backupCallSignalAddresses,\r\n{ "backupCallSignalAddresses", "h323.backupCallSignalAddresses",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_h323_hasSharedRepository,\r\n{ "hasSharedRepository", "h323.hasSharedRepository_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_h323_irrFrequency,\r\n{ "irrFrequency", "h323.irrFrequency",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"INTEGER_1_65535", HFILL }},\r\n{ &hf_h323_endpointGuid,\r\n{ "endpointGuid", "h323.endpointGuid",\r\nFT_GUID, BASE_NONE, NULL, 0,\r\n"GloballyUniqueIdentifier", HFILL }},\r\n{ &hf_h323_h245Address,\r\n{ "h245Address", "h323.h245Address",\r\nFT_UINT32, BASE_DEC, VALS(h225_TransportAddress_vals), 0,\r\n"TransportAddress", HFILL }},\r\n{ &hf_h323_fastStart,\r\n{ "fastStart", "h323.fastStart",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_h323_fastStart_item,\r\n{ "fastStart item", "h323.fastStart_item",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"OCTET_STRING", HFILL }},\r\n{ &hf_h323_resetH245,\r\n{ "resetH245", "h323.resetH245_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_h323_timeToLive,\r\n{ "timeToLive", "h323.timeToLive",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_h323_includeFastStart,\r\n{ "includeFastStart", "h323.includeFastStart_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n#line 102 "./asn1/h323/packet-h323-template.c"\r\n};\r\nstatic gint *ett[] = {\r\n#line 1 "./asn1/h323/packet-h323-ettarr.c"\r\n&ett_h323_RasTunnelledSignallingMessage,\r\n&ett_h323_T_messageContent,\r\n&ett_h323_RobustnessData,\r\n&ett_h323_T_robustnessData,\r\n&ett_h323_BackupCallSignalAddresses,\r\n&ett_h323_BackupCallSignalAddresses_item,\r\n&ett_h323_Rrq_RD,\r\n&ett_h323_Rcf_RD,\r\n&ett_h323_Setup_RD,\r\n&ett_h323_Connect_RD,\r\n&ett_h323_Status_RD,\r\n&ett_h323_T_fastStart,\r\n&ett_h323_StatusInquiry_RD,\r\n#line 107 "./asn1/h323/packet-h323-template.c"\r\n};\r\nproto_h323 = proto_register_protocol(PNAME, PSNAME, PFNAME);\r\nproto_register_field_array(proto_h323, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid proto_reg_handoff_h323(void)\r\n{\r\ndissector_handle_t q931_handle;\r\nq931_handle = find_dissector("q931");\r\ndissector_add_string("h225.tp", "1.3.12.9", q931_handle);\r\ndissector_add_string("h225.gef.content", "GenericData/1000/1",\r\ncreate_dissector_handle(dissect_RasTunnelledSignallingMessage_PDU, proto_h323));\r\ndissector_add_string("h225.gef.content", "GenericData/1/1",\r\ncreate_dissector_handle(dissect_RobustnessData_PDU, proto_h323));\r\n}
