static int dissect_aim_sst_buddy_down_req (tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nint offset = dissect_aim_buddyname(tvb, pinfo, 0, tree);\r\nguint8 md5_size;\r\nproto_tree_add_item(tree, hf_aim_sst_unknown, tvb, offset, 4, ENC_NA);\r\noffset+=4;\r\nproto_tree_add_item(tree, hf_aim_sst_md5_hash_size, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nmd5_size = tvb_get_guint8(tvb, offset);\r\noffset++;\r\nproto_tree_add_item(tree, hf_aim_sst_md5_hash, tvb, offset, md5_size, ENC_NA);\r\noffset+=md5_size;\r\nreturn offset;\r\n}\r\nstatic int dissect_aim_sst_buddy_down_repl (tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nint offset = dissect_aim_buddyname(tvb, pinfo, 0, tree);\r\nguint8 md5_size;\r\nguint16 icon_size;\r\nproto_tree_add_item(tree, hf_aim_sst_unknown, tvb, offset, 3, ENC_NA);\r\noffset+=3;\r\nproto_tree_add_item(tree, hf_aim_sst_md5_hash_size, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nmd5_size = tvb_get_guint8(tvb, offset);\r\noffset++;\r\nproto_tree_add_item(tree, hf_aim_sst_md5_hash, tvb, offset, md5_size, ENC_NA);\r\noffset+=md5_size;\r\nproto_tree_add_item(tree, hf_aim_sst_icon_size, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nicon_size = tvb_get_ntohs(tvb, offset);\r\noffset+=2;\r\nif (icon_size)\r\n{\r\nproto_tree_add_item(tree, hf_aim_sst_icon, tvb, offset, icon_size, ENC_NA);\r\n}\r\noffset+=icon_size;\r\nreturn offset;\r\n}\r\nstatic int dissect_aim_sst_buddy_up_repl (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nint offset = 0;\r\nguint8 md5_size;\r\nproto_tree_add_item(tree, hf_aim_sst_unknown, tvb, offset, 4, ENC_NA);\r\noffset+=4;\r\nproto_tree_add_item(tree, hf_aim_sst_md5_hash_size, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nmd5_size = tvb_get_guint8(tvb, offset);\r\noffset++;\r\nproto_tree_add_item(tree, hf_aim_sst_md5_hash, tvb, offset, md5_size, ENC_NA);\r\noffset+=md5_size;\r\nreturn offset;\r\n}\r\nstatic int dissect_aim_sst_buddy_up_req (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nint offset = 0;\r\nguint16 icon_size;\r\nproto_tree_add_item(tree, hf_aim_sst_ref_num, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset+=2;\r\nproto_tree_add_item(tree, hf_aim_sst_icon_size, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nicon_size = tvb_get_ntohs(tvb, offset);\r\noffset+=2;\r\nif (icon_size)\r\n{\r\nproto_tree_add_item(tree, hf_aim_sst_icon, tvb, offset, icon_size, ENC_NA);\r\n}\r\noffset+=icon_size;\r\nreturn offset;\r\n}\r\nvoid\r\nproto_register_aim_sst(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_aim_sst_md5_hash,\r\n{ "MD5 Hash", "aim_sst.md5", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL },\r\n},\r\n{ &hf_aim_sst_md5_hash_size,\r\n{ "MD5 Hash Size", "aim_sst.md5.size", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL },\r\n},\r\n{ &hf_aim_sst_unknown,\r\n{ "Unknown Data", "aim_sst.unknown", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL },\r\n},\r\n{ &hf_aim_sst_ref_num,\r\n{ "Reference Number", "aim_sst.ref_num", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL },\r\n},\r\n{ &hf_aim_sst_icon_size,\r\n{ "Icon Size", "aim_sst.icon_size", FT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL },\r\n},\r\n{ &hf_aim_sst_icon,\r\n{ "Icon", "aim_sst.icon", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL },\r\n},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_aim_sst,\r\n};\r\nproto_aim_sst = proto_register_protocol("AIM Server Side Themes", "AIM SST", "aim_sst");\r\nproto_register_field_array(proto_aim_sst, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid\r\nproto_reg_handoff_aim_sst(void)\r\n{\r\naim_init_family(proto_aim_sst, ett_aim_sst, FAMILY_SST, aim_fnac_family_sst);\r\n}
