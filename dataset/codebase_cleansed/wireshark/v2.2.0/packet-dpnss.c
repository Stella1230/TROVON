static int\r\ndissect_dpnss_sic(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nguint8 octet, type_of_data;\r\noctet = tvb_get_guint8(tvb,offset);\r\ntype_of_data = (octet & 0x70)>>4;\r\nproto_tree_add_item(tree, hf_dpnss_ext_bit, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_dpnss_sic_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nswitch (type_of_data) {\r\ncase 1:\r\nproto_tree_add_item(tree, hf_dpnss_sic_details_for_speech, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 2:\r\nproto_tree_add_item(tree, hf_dpnss_sic_details_for_data1, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 3:\r\nproto_tree_add_item(tree, hf_dpnss_sic_details_for_data2, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\noffset++;\r\nif ((octet&0x80)==0x80) {\r\noctet = tvb_get_guint8(tvb,offset);\r\ntype_of_data = octet&0x3;\r\nproto_tree_add_item(tree, hf_dpnss_ext_bit_notall, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nswitch (type_of_data) {\r\ncase 3:\r\ncase 4:\r\nproto_tree_add_item(tree, hf_dpnss_sic_oct2_net_ind_clk, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_dpnss_sic_oct2_sync_data_format, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_dpnss_sic_oct2_sync_byte_timing, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 5:\r\ncase 6:\r\ncase 7:\r\nproto_tree_add_item(tree, hf_dpnss_sic_oct2_async_flow_ctrl, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_dpnss_sic_oct2_async_data, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nproto_tree_add_item(tree, hf_dpnss_sic_oct2_duplex, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_dpnss_sic_oct2_data_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\n}\r\nreturn offset;\r\n}\r\nstatic void\r\ndissect_dpnns_sup_str_par(tvbuff_t *tvb, proto_tree * tree, int par_type_num, int par_start_offset, int par_end_offset)\r\n{\r\nint par_len;\r\ngchar * par_data;\r\npar_len = par_end_offset - par_start_offset;\r\nif (par_len==0) {\r\npar_type_num = DPNSS_NONE;\r\n}\r\nswitch (par_type_num) {\r\ncase DPNSS_NONE:\r\nproto_tree_add_string(tree, hf_dpnss_parameter, tvb, par_start_offset, par_len, "None");\r\nbreak;\r\ncase DPNSS_A_B_PARTY_ADDR:\r\nproto_tree_add_item(tree, hf_dpnss_a_b_party_addr, tvb, par_start_offset, par_len, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase DPNSS_CALL_INDEX:\r\nproto_tree_add_item(tree, hf_dpnss_call_idx, tvb, par_start_offset, par_len, ENC_ASCII|ENC_NA);\r\nbreak;\r\ndefault:\r\npar_data = tvb_format_text(tvb,par_start_offset, par_len);\r\nproto_tree_add_string_format(tree, hf_dpnss_parameter, tvb, par_start_offset, par_len, par_data, "Parameter %s: %s",\r\nval_to_str(par_type_num, dpnss_sup_serv_par_str_vals, "Unknown (%d)" ), par_data);\r\nbreak;\r\n}\r\n}\r\nstatic int\r\ndissect_dpnss_sup_info_str(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, gint offset)\r\n{\r\nproto_tree *sup_str_tree;\r\ngint start_offset, hash_offset, tvb_end_offset, sup_inf_str_end_offset, str_no;\r\ngint par_start_offset, par_end_offset, number_of_found_par;\r\ngint sup_inf_str_len, par_type_num;\r\nguint sup_str_num;\r\nguint8 octet;\r\ngboolean last_string = FALSE;\r\ngboolean has_par;\r\ntvb_end_offset = tvb_reported_length(tvb);\r\nstr_no = 1;\r\nwhile ((offset<tvb_end_offset)&&(last_string == FALSE)) {\r\noctet = tvb_get_guint8(tvb,offset);\r\nif (octet == '*') {\r\nstart_offset = offset;\r\nhas_par = TRUE;\r\nnumber_of_found_par = 0;\r\noffset++;\r\nhash_offset = tvb_find_guint8(tvb, offset, -1, '#');\r\nsup_str_tree = proto_tree_add_subtree_format(tree, tvb, start_offset, hash_offset-start_offset+1,\r\nett_dpnss_sup_str, NULL, "Supplementary Information %u: %s",str_no,\r\ntvb_format_text(tvb,start_offset,hash_offset-start_offset+1));\r\nsup_inf_str_end_offset = tvb_find_guint8(tvb, offset, hash_offset-offset, '*');\r\nif (sup_inf_str_end_offset==-1) {\r\nhas_par = FALSE;\r\nsup_inf_str_end_offset = hash_offset;\r\n}\r\nsup_inf_str_len = sup_inf_str_end_offset - offset;\r\nsup_str_num = atoi(tvb_format_text(tvb, offset, sup_inf_str_len));\r\nif ((sup_str_num != 0) && (sup_str_num < array_length(dpnns_sup_serv_set))) {\r\nproto_tree_add_string(sup_str_tree, hf_dpnss_sup_str, tvb, offset, sup_inf_str_len,\r\ndpnns_sup_serv_set[sup_str_num].compact_name);\r\noffset = sup_inf_str_end_offset+1;\r\nwhile (has_par) {\r\nnumber_of_found_par++;\r\npar_start_offset = offset;\r\npar_end_offset = tvb_find_guint8(tvb, offset, -1, '*');\r\nif (par_end_offset == -1) {\r\npar_end_offset = hash_offset;\r\nhas_par = FALSE;\r\n}\r\nswitch (number_of_found_par) {\r\ncase 1:\r\npar_type_num = dpnns_sup_serv_set[sup_str_num].par1_num;\r\ndissect_dpnns_sup_str_par(tvb,sup_str_tree, par_type_num, par_start_offset, par_end_offset);\r\nbreak;\r\ncase 2:\r\npar_type_num = dpnns_sup_serv_set[sup_str_num].par2_num;\r\ndissect_dpnns_sup_str_par(tvb,sup_str_tree, par_type_num, par_start_offset, par_end_offset);\r\nbreak;\r\ncase 3:\r\npar_type_num = dpnns_sup_serv_set[sup_str_num].par3_num;\r\ndissect_dpnns_sup_str_par(tvb,sup_str_tree, par_type_num, par_start_offset, par_end_offset);\r\nbreak;\r\ncase 4:\r\npar_type_num = dpnns_sup_serv_set[sup_str_num].par4_num;\r\ndissect_dpnns_sup_str_par(tvb,sup_str_tree, par_type_num, par_start_offset, par_end_offset);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\noffset = par_end_offset+1;\r\n}\r\n}\r\noffset = hash_offset+1;\r\nstr_no++;\r\n} else {\r\nlast_string = TRUE;\r\nproto_tree_add_item(tree, hf_dpnss_dest_addr, tvb, offset, -1, ENC_ASCII|ENC_NA);\r\n}\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dpnss_LbL_msg(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nproto_item *ind_field_item;\r\nproto_tree *sic_field_tree, *ind_field_tree;\r\nint offset = 0;\r\nint tvb_end_offset;\r\nguint8 octet;\r\ntvb_end_offset = tvb_reported_length(tvb);\r\nproto_tree_add_item(tree, hf_dpnss_LbL_msg_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noctet = tvb_get_guint8(tvb,offset)&0x0f;\r\noffset++;\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "%s ",\r\nval_to_str(octet, dpnss_LbL_msg_short_type_vals, "Unknown (%d)" ));\r\nif (tree) {\r\nswitch (octet) {\r\ncase DPNSS_LbL_MSG_LLM_C:\r\ncase DPNSS_LbL_MSG_LLM_I:\r\nind_field_item = proto_tree_add_item(tree, hf_dpnss_indication_field, tvb, offset, -1, ENC_NA|ENC_ASCII);\r\nind_field_tree = proto_item_add_subtree(ind_field_item, ett_dpnss_ind_field);\r\noffset = dissect_dpnss_sup_info_str(tvb, pinfo, ind_field_tree, offset);\r\nbreak;\r\ncase DPNSS_LbL_MSG_LLRM:\r\nproto_tree_add_item(tree, hf_dpnss_rejection_cause, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nif (tvb_end_offset>offset) {\r\nind_field_item = proto_tree_add_item(tree, hf_dpnss_indication_field, tvb, offset, -1, ENC_NA|ENC_ASCII);\r\nind_field_tree = proto_item_add_subtree(ind_field_item, ett_dpnss_ind_field);\r\noffset = dissect_dpnss_sup_info_str(tvb, pinfo, ind_field_tree, offset);\r\n}\r\nbreak;\r\ncase DPNSS_LbL_MSG_SM:\r\nsic_field_tree = proto_tree_add_subtree(tree, tvb, offset, -1, ett_dpnss_sic_field, NULL, "Service Indicator Code");\r\noffset =dissect_dpnss_sic(tvb, pinfo, sic_field_tree, offset);\r\nind_field_item = proto_tree_add_item(tree, hf_dpnss_indication_field, tvb, offset, -1, ENC_NA|ENC_ASCII);\r\nind_field_tree = proto_item_add_subtree(ind_field_item, ett_dpnss_ind_field);\r\noffset = dissect_dpnss_sup_info_str(tvb, pinfo, ind_field_tree, offset);\r\nbreak;\r\ncase DPNSS_LbL_MSG_LMM:\r\nproto_tree_add_item(tree, hf_dpnss_maintenance_action, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nind_field_item = proto_tree_add_item(tree, hf_dpnss_indication_field, tvb, offset, -1, ENC_NA|ENC_ASCII);\r\nind_field_tree = proto_item_add_subtree(ind_field_item, ett_dpnss_ind_field);\r\noffset = dissect_dpnss_sup_info_str(tvb, pinfo, ind_field_tree, offset);\r\nbreak;\r\ncase DPNSS_LbL_MSG_LMRM:\r\nproto_tree_add_item(tree, hf_dpnss_clearing_cause, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nind_field_item = proto_tree_add_item(tree, hf_dpnss_indication_field, tvb, offset, -1, ENC_NA|ENC_ASCII);\r\nind_field_tree = proto_item_add_subtree(ind_field_item, ett_dpnss_ind_field);\r\noffset = dissect_dpnss_sup_info_str(tvb, pinfo, ind_field_tree, offset);\r\nbreak;\r\ndefault:\r\nproto_tree_add_expert(tree, pinfo, &ei_dpnss_not_supported_yet, tvb, offset, -1);\r\nbreak;\r\n}\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dpnss_e2e_msg(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nproto_item *sel_field_item, *ind_field_item;\r\nproto_tree *sel_field_tree, *sic_field_tree, *ind_field_tree;\r\nint offset = 0;\r\nint tvb_end_offset;\r\nguint8 octet;\r\ntvb_end_offset = tvb_reported_length(tvb);\r\nproto_tree_add_item(tree, hf_dpnss_e2e_msg_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noctet = tvb_get_guint8(tvb,offset)&0x0f;\r\noffset++;\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "%s ",\r\nval_to_str(octet, dpnss_e2e_msg_short_type_vals, "Unknown (%d)" ));\r\nif (tree) {\r\nswitch (octet) {\r\ncase DPNSS_E2E_MSG_EEM_C:\r\ncase DPNSS_E2E_MSG_EEM_I:\r\nind_field_item = proto_tree_add_item(tree, hf_dpnss_indication_field, tvb, offset, -1, ENC_NA|ENC_ASCII);\r\nind_field_tree = proto_item_add_subtree(ind_field_item, ett_dpnss_ind_field);\r\noffset = dissect_dpnss_sup_info_str(tvb, pinfo, ind_field_tree, offset);\r\nbreak;\r\ncase DPNSS_E2E_MSG_SCRM:\r\ncase DPNSS_E2E_MSG_SCIM:\r\nproto_tree_add_item(tree, hf_dpnss_clearing_cause, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nif (tvb_end_offset>offset) {\r\nind_field_item = proto_tree_add_item(tree, hf_dpnss_indication_field, tvb, offset, -1, ENC_NA|ENC_ASCII);\r\nind_field_tree = proto_item_add_subtree(ind_field_item, ett_dpnss_ind_field);\r\noffset = dissect_dpnss_sup_info_str(tvb, pinfo, ind_field_tree, offset);\r\n}\r\nbreak;\r\ncase DPNSS_E2E_MSG_ERM_C:\r\ncase DPNSS_E2E_MSG_ERM_I:\r\nsic_field_tree = proto_tree_add_subtree(tree, tvb, offset, -1, ett_dpnss_sic_field, NULL, "Service Indicator Code");\r\noffset =dissect_dpnss_sic(tvb, pinfo, sic_field_tree, offset);\r\nsel_field_item = proto_tree_add_item(tree, hf_dpnss_selection_field, tvb, offset, -1, ENC_NA|ENC_ASCII);\r\nsel_field_tree = proto_item_add_subtree(sel_field_item, ett_dpnss_sel_field);\r\noffset = dissect_dpnss_sup_info_str(tvb, pinfo, sel_field_tree, offset);\r\nbreak;\r\ncase DPNSS_E2E_MSG_NSIM:\r\noctet = tvb_get_guint8(tvb,offset);\r\nproto_tree_add_item(tree, hf_dpnss_ext_bit, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_dpnss_man_code, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_dpnss_subcode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nif ((octet&0x80)==0x80) {\r\noffset++;\r\n}\r\nproto_tree_add_item(tree, hf_dpnss_user_information, tvb, offset, -1, ENC_NA);\r\nbreak;\r\ndefault:\r\nproto_tree_add_expert(tree, pinfo, &ei_dpnss_not_supported_yet, tvb, offset, -1);\r\nbreak;\r\n}\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dpnss_cc_msg(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nproto_item *sel_field_item, *ind_field_item;\r\nproto_tree *sel_field_tree, *sic_field_tree, *ind_field_tree;\r\nint offset = 0;\r\nint tvb_end_offset;\r\nguint8 octet;\r\ntvb_end_offset = tvb_reported_length(tvb);\r\nproto_tree_add_item(tree, hf_dpnss_cc_msg_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noctet = tvb_get_guint8(tvb,offset)&0x0f;\r\noffset++;\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "%s ",\r\nval_to_str(octet, dpnss_cc_msg_short_type_vals, "Unknown (%d)" ));\r\nif (tree) {\r\nswitch (octet) {\r\ncase DPNSS_CC_MSG_ISRM_C:\r\ncase DPNSS_CC_MSG_ISRM_I:\r\ncase DPNSS_CC_MSG_RM_C:\r\ncase DPNSS_CC_MSG_RM_I:\r\nsic_field_tree = proto_tree_add_subtree(tree, tvb, offset, -1, ett_dpnss_sic_field, NULL, "Service Indicator Code");\r\noffset =dissect_dpnss_sic(tvb, pinfo, sic_field_tree, offset);\r\nsel_field_item = proto_tree_add_item(tree, hf_dpnss_selection_field, tvb, offset, -1, ENC_NA|ENC_ASCII);\r\nsel_field_tree = proto_item_add_subtree(sel_field_item, ett_dpnss_sel_field);\r\noffset = dissect_dpnss_sup_info_str(tvb, pinfo, sel_field_tree, offset);\r\nbreak;\r\ncase DPNSS_CC_MSG_CCM:\r\nif (tvb_end_offset>offset) {\r\nind_field_item = proto_tree_add_item(tree, hf_dpnss_indication_field, tvb, offset, -1, ENC_NA|ENC_ASCII);\r\nind_field_tree = proto_item_add_subtree(ind_field_item, ett_dpnss_ind_field);\r\noffset = dissect_dpnss_sup_info_str(tvb, pinfo, ind_field_tree, offset);\r\n}\r\nbreak;\r\ncase DPNSS_CC_MSG_NIM:\r\ncase DPNSS_CC_MSG_NAM:\r\nind_field_item = proto_tree_add_item(tree, hf_dpnss_indication_field, tvb, offset, -1, ENC_NA|ENC_ASCII);\r\nind_field_tree = proto_item_add_subtree(ind_field_item, ett_dpnss_ind_field);\r\noffset = dissect_dpnss_sup_info_str(tvb, pinfo, ind_field_tree, offset);\r\nbreak;\r\ncase DPNSS_CC_MSG_CRM:\r\nproto_tree_add_item(tree, hf_dpnss_clearing_cause, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nif (tvb_end_offset>offset) {\r\nind_field_item = proto_tree_add_item(tree, hf_dpnss_indication_field, tvb, offset, -1, ENC_NA|ENC_ASCII);\r\nind_field_tree = proto_item_add_subtree(ind_field_item, ett_dpnss_ind_field);\r\noffset = dissect_dpnss_sup_info_str(tvb, pinfo, ind_field_tree, offset);\r\n}\r\nbreak;\r\ncase DPNSS_CC_MSG_RRM:\r\nproto_tree_add_item(tree, hf_dpnss_rejection_cause, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nif (tvb_end_offset>offset) {\r\nind_field_item = proto_tree_add_item(tree, hf_dpnss_indication_field, tvb, offset, -1, ENC_NA|ENC_ASCII);\r\nind_field_tree = proto_item_add_subtree(ind_field_item, ett_dpnss_ind_field);\r\noffset = dissect_dpnss_sup_info_str(tvb, pinfo, ind_field_tree, offset);\r\n}\r\nbreak;\r\ncase DPNSS_CC_MSG_SSRM_I:\r\nsel_field_item = proto_tree_add_item(tree, hf_dpnss_selection_field, tvb, offset, -1, ENC_NA|ENC_ASCII);\r\nsel_field_tree = proto_item_add_subtree(sel_field_item, ett_dpnss_sel_field);\r\noffset = dissect_dpnss_sup_info_str(tvb, pinfo, sel_field_tree, offset);\r\nbreak;\r\ncase DPNSS_CC_MSG_SSRM_C:\r\nif (tvb_end_offset>offset) {\r\nsel_field_item = proto_tree_add_item(tree, hf_dpnss_selection_field, tvb, offset, -1, ENC_NA|ENC_ASCII);\r\nsel_field_tree = proto_item_add_subtree(sel_field_item, ett_dpnss_sel_field);\r\noffset = dissect_dpnss_sup_info_str(tvb, pinfo, sel_field_tree, offset);\r\n}\r\nbreak;\r\ncase DPNSS_CC_MSG_CS:\r\ncase DPNSS_CC_MSG_CA:\r\ndefault:\r\nproto_tree_add_expert_format(tree, pinfo, &ei_dpnss_not_supported_yet, tvb, offset, -1, "Unknown or Dissection of this message not supported yet");\r\nbreak;\r\n}\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dpnss(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\nproto_item *item, *group_item;\r\nproto_tree *dpnss_tree;\r\nguint8 octet;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "DPNSS");\r\nitem = proto_tree_add_item(tree, proto_dpnss, tvb, 0, -1, ENC_NA);\r\ndpnss_tree = proto_item_add_subtree(item, ett_dpnss);\r\ngroup_item = proto_tree_add_item(dpnss_tree, hf_dpnss_msg_grp_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noctet = tvb_get_guint8(tvb,offset)>>4;\r\nswitch (octet) {\r\ncase DPNNS_MESSAGE_GROUP_CC:\r\ndissect_dpnss_cc_msg(tvb, pinfo, dpnss_tree);\r\nbreak;\r\ncase DPNNS_MESSAGE_GROUP_E2E:\r\ndissect_dpnss_e2e_msg(tvb, pinfo, dpnss_tree);\r\nbreak;\r\ncase DPNNS_MESSAGE_GROUP_LbL:\r\ndissect_dpnss_LbL_msg(tvb, pinfo, dpnss_tree);\r\nbreak;\r\ndefault:\r\nexpert_add_info(pinfo, group_item, &ei_dpnss_msg_grp_id);\r\nbreak;\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_dpnss(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_dpnss_msg_grp_id,\r\n{ "Message Group Identifier", "dpnss.msg_grp_id",\r\nFT_UINT8, BASE_DEC, VALS(dpnss_msg_grp_id_vals), 0xf0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_dpnss_cc_msg_type,\r\n{ "Call Control Message Type", "dpnss.cc_msg_type",\r\nFT_UINT8, BASE_DEC, VALS(dpnss_cc_msg_type_vals), 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_dpnss_e2e_msg_type,\r\n{ "END-TO-END Message Type", "dpnss.e2e_msg_type",\r\nFT_UINT8, BASE_DEC, VALS(dpnss_e2e_msg_type_vals), 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_dpnss_LbL_msg_type,\r\n{ "LINK-BY-LINK Message Type", "dpnss.lbl_msg_type",\r\nFT_UINT8, BASE_DEC, VALS(dpnss_LbL_msg_type_vals), 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_dpnss_ext_bit,\r\n{ "Extension bit", "dpnss.ext_bit",\r\nFT_BOOLEAN, 8, TFS(&dpnss_ext_bit_vals), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_dpnss_ext_bit_notall,\r\n{ "Extension bit", "dpnss.ext_bit_notall",\r\nFT_BOOLEAN, 8, TFS(&dpnss_ext_bit_no_ext_vals), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_dpnss_sic_type,\r\n{ "Type of data", "dpnss.sic_type",\r\nFT_UINT8, BASE_DEC, VALS(dpnss_sic_type_type_vals), 0x70,\r\nNULL, HFILL }\r\n},\r\n{ &hf_dpnss_sic_details_for_speech,\r\n{ "Details for Speech", "dpnss.sic_details_for_speech",\r\nFT_UINT8, BASE_DEC, VALS(dpnss_sic_details_for_speech_vals), 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_dpnss_sic_details_for_data1,\r\n{ "Data Rates", "dpnss.sic_details_for_data1",\r\nFT_UINT8, BASE_DEC, VALS(dpnss_sic_details_for_data_rates1_vals), 0x0f,\r\n"Type of Data (010) : Data Rates", HFILL }\r\n},\r\n{ &hf_dpnss_sic_details_for_data2,\r\n{ "Data Rates", "dpnss.sic_details_data2",\r\nFT_UINT8, BASE_DEC, VALS(dpnss_sic_details_for_data_rates2_vals), 0x0f,\r\n"Type of Data (011) : Data Rates", HFILL }\r\n},\r\n{ &hf_dpnss_dest_addr,\r\n{ "Destination Address", "dpnss.dest_addr",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_dpnss_sic_oct2_data_type,\r\n{ "Data Type", "dpnss.sic_oct2_data_type",\r\nFT_UINT8, BASE_DEC, VALS(dpnss_sic_oct2_data_type_vals), 0x03,\r\nNULL, HFILL }\r\n},\r\n{ &hf_dpnss_sic_oct2_duplex,\r\n{ "Data Type", "dpnss.sic_oct2_duplex",\r\nFT_BOOLEAN, 8, TFS(&dpnss_duplex_vals), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_dpnss_sic_oct2_net_ind_clk,\r\n{ "Network Independent Clock", "dpnss.sic_oct2_net_ind_clk",\r\nFT_BOOLEAN, 8, TFS(&dpnss_sic_oct2_net_ind_clk_vals), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_dpnss_sic_oct2_sync_data_format,\r\n{ "Data Format", "dpnss.sic_oct2_sync_data_format",\r\nFT_BOOLEAN, 8, TFS(&dpnss_sic_oct2_sync_data_format_vals), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_dpnss_sic_oct2_sync_byte_timing,\r\n{ "Byte Timing", "dpnss.sic_oct2_sync_byte_timing",\r\nFT_BOOLEAN, 8, TFS(&dpnss_provided_vals), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_dpnss_sic_oct2_async_data,\r\n{ "Data Format", "dpnss.sic_oct2_async_data",\r\nFT_UINT8, BASE_DEC, VALS(dpnss_sic_oct2_async_data_type_vals), 0x30,\r\nNULL, HFILL }\r\n},\r\n{ &hf_dpnss_sic_oct2_async_flow_ctrl,\r\n{ "Flow Control", "dpnss.sic_oct2_async_flow_ctrl",\r\nFT_BOOLEAN, 8, TFS(&dpnss_flow_control_vals), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_dpnss_clearing_cause,\r\n{ "Clearing Cause", "dpnss.clearing_cause",\r\nFT_UINT8, BASE_DEC, VALS(dpnss_clearing_cause_code_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_dpnss_rejection_cause,\r\n{ "Rejection Cause", "dpnss.rejection_cause",\r\nFT_UINT8, BASE_DEC, VALS(dpnss_clearing_cause_code_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_dpnss_man_code,\r\n{ "Manufacturer Code", "dpnss.man_code",\r\nFT_UINT8, BASE_DEC, VALS(dpnss_man_code_vals), 0x3c,\r\nNULL, HFILL }\r\n},\r\n{ &hf_dpnss_subcode,\r\n{ "Subcode", "dpnss.subcode",\r\nFT_UINT8, BASE_DEC, NULL, 0x03,\r\nNULL, HFILL }\r\n},\r\n{ &hf_dpnss_maintenance_action,\r\n{ "Maintenance action", "dpnss.maint_act",\r\nFT_UINT8, BASE_DEC, VALS(dpnss_maintenance_actions_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_dpnss_a_b_party_addr,\r\n{ "A/B party Address", "dpnss.a_b_party_addr",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_dpnss_call_idx,\r\n{ "Call Index", "dpnss.call_idx",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_dpnss_indication_field, { "Indication Field", "dpnss.indication_field", FT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_dpnss_selection_field, { "Selection Field", "dpnss.selection_field", FT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_dpnss_user_information, { "User Information", "dpnss.user_information", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_dpnss_sup_str, { "Sup str", "dpnss.sup_str", FT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_dpnss_parameter, { "Parameter", "dpnss.parameter", FT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_dpnss,\r\n&ett_dpnss_sel_field,\r\n&ett_dpnss_sic_field,\r\n&ett_dpnss_ind_field,\r\n&ett_dpnss_sup_str,\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_dpnss_not_supported_yet, { "dpnss.not_supported_yet", PI_UNDECODED, PI_WARN, "Dissection of this message not supported yet", EXPFILL }},\r\n{ &ei_dpnss_msg_grp_id, { "dpnss.msg_grp_id.unknown", PI_PROTOCOL, PI_WARN, "Unknown Message Group", EXPFILL }},\r\n};\r\nexpert_module_t* expert_dpnss;\r\nproto_dpnss = proto_register_protocol("Digital Private Signalling System No 1","DPNSS", "dpnss");\r\nregister_dissector("dpnss", dissect_dpnss, proto_dpnss);\r\nproto_register_field_array(proto_dpnss, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_dpnss = expert_register_protocol(proto_dpnss);\r\nexpert_register_field_array(expert_dpnss, ei, array_length(ei));\r\n}
