static int dissect_mac_header_type_2_decoder(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\ngint tvb_len, offset = 0;\r\nguint cii_bit, first_byte, fb_type, mimo_type;\r\nproto_item *parent_item = NULL;\r\nproto_item *ti = NULL;\r\nproto_tree *ti_tree = NULL;\r\n{\r\ntvb_len = tvb_reported_length(tvb);\r\nti = proto_tree_add_protocol_format(tree, proto_mac_header_type_2_decoder, tvb, offset, tvb_len, "Mac Type II Header (6 bytes)");\r\nti_tree = proto_item_add_subtree(ti, ett_mac_header_type_2_decoder);\r\nif(tvb_len < WIMAX_MAC_HEADER_SIZE)\r\n{\r\nproto_tree_add_protocol_format(ti_tree, proto_mac_header_type_2_decoder, tvb, offset, tvb_len, "Error: the size of Mac Header Type II tvb is too small! (%u bytes)", tvb_len);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_value_bytes, tvb, offset, tvb_len, ENC_NA);\r\nreturn tvb_captured_length(tvb);\r\n}\r\n#ifdef DEBUG\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, NULL, "MAC Signaling Header Type II");\r\n#endif\r\nparent_item = proto_tree_get_parent(tree);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_ht, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_ec, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cii, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_fb_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nfirst_byte = tvb_get_guint8(tvb, offset);\r\ncii_bit = ((first_byte & WIMAX_MAC_HEADER_TYPE_2_CII)?1:0);\r\nif(!(first_byte & WIMAX_MAC_HEADER_TYPE_2_TYPE))\r\n{\r\nfb_type = (first_byte & WIMAX_MAC_HEADER_TYPE_2_FB_TYPE);\r\nif(fb_type < TYPE_II_FB_TYPE_MAX)\r\n{\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, NULL, type2_fb_type_abbrv[fb_type]);\r\n}\r\nelse\r\n{\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, NULL, "Unknown type 2 fb type");\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_value_bytes, tvb, offset, tvb_len, ENC_NA);\r\nreturn tvb_captured_length(tvb);\r\n}\r\noffset++;\r\nproto_item_append_text(parent_item, "%s", type2_fb_type_abbrv[fb_type]);\r\nswitch (fb_type)\r\n{\r\ncase CQI_MIMO_FB:\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cqi_fb_type, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cqi_payload, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cqi_rsv, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nif(cii_bit)\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cid, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_no_cid, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase DL_AVG_CINR:\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_dl_ave_cinr, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_dl_ave_rsv, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nif(cii_bit)\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cid, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_no_cid, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase MIMO_COEF_FB:\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_mimo_coef_ni, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_mimo_coef_ai, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_mimo_coef, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_mimo_coef_rsv, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nif(cii_bit)\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cid, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_no_cid, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase PREF_DL_CHAN_DIUC_FB:\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_dl_chan_diuc, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_dl_chan_dcd, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_dl_chan_rsv, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nif(cii_bit)\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cid, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_no_cid, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase UL_TX_PWR:\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_ul_tx_pwr, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_ul_tx_pwr_rsv, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nif(cii_bit)\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cid, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_no_cid, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase PHY_CHAN_FB:\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_phy_diuc, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_phy_ul_tx_pwr, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_phy_ul_hdrm, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_phy_rsv, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nif(cii_bit)\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cid, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_no_cid, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase AMC_BAND_BITMAP:\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_amc_bitmap, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_amc_cqi_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_amc_cqi_2, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_amc_cqi_3, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_amc_cqi_4, tvb, offset, 2, ENC_BIG_ENDIAN);\r\n#if 0\r\nif(cii_bit)\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cid, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_no_cid, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\n}\r\n#endif\r\nbreak;\r\ncase SHORT_PRECODE_FB:\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_life_span, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_life_span_rsv, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nif(cii_bit)\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cid, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_no_cid, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase MULTI_TYPES_FB:\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_mt_num_fb_types, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_mt_occu_fb_type, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_mt_fb_contents, tvb, offset, 4, ENC_BIG_ENDIAN);\r\n#if 0\r\nif(cii_bit)\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cid, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_no_cid, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\n}\r\n#endif\r\nbreak;\r\ncase LONG_PRECODE_FB:\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_lt_id_fb, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_lt_rank, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_lt_fec_qam, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_lt_rsv, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nif(cii_bit)\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cid, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_no_cid, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase COMB_DL_AVG_CINR:\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_comb_dl_ave, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_comb_dl_rsv, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nif(cii_bit)\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cid, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_no_cid, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase MIMO_CHAN_FB:\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_mimo_diuc, tvb, (offset+1), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_mimo_pbwi, tvb, (offset+1), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_mimo_slpb, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nif(cii_bit)\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_mimo_bpri_cid, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_mimo_cid, tvb, offset, 3, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_mimo_bpri, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_mimo_cti, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_mimo_ai_0, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_mimo_ai_1, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_mimo_ai_2, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_mimo_ai_3, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_mimo_mi, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_mimo_ct, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_mimo_cqi, tvb, offset, 3, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase CINR_FB:\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cinr_mean, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cinr_devi, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nif(cii_bit)\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cid, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_no_cid, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase CL_MIMO_FB:\r\nmimo_type = ((tvb_get_guint8(tvb, offset) & 0xC0) >> 6);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cl_mimo_type, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nif(mimo_type == 1)\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cl_mimo_streams, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cl_mimo_ant_sel, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cl_mimo_cqi_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cl_mimo_rsv_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nelse if(mimo_type == 2)\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cl_mimo_streams, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cl_mimo_codebook_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cl_mimo_cqi_2, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cl_mimo_rsv_2, tvb, offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cl_mimo_ant_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cl_mimo_cqi, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cl_mimo_rsv, tvb, offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nif(cii_bit)\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_cid, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_no_cid, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nproto_tree_add_item(ti_tree, hf_mac_header_type_2_hcs, tvb, (offset+4), 1, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, NULL, "Error - Undefined Type");\r\n}\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid proto_register_mac_header_type_2(void)\r\n{\r\nstatic hf_register_info hf[] =\r\n{\r\n{\r\n&hf_mac_header_type_2_value_bytes,\r\n{\r\n"Values", "wmx.type2ValueBytes",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_ht,\r\n{\r\n"MAC Header Type", "wmx.type2Ht",\r\nFT_UINT8, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_HT,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_ec,\r\n{\r\n"MAC Encryption Control", "wmx.type2Ec",\r\nFT_UINT8, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_EC,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_type,\r\n{\r\n"MAC Sub-Type", "wmx.type2Type",\r\nFT_UINT8, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_TYPE,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_cii,\r\n{\r\n"CID Inclusion Indication", "wmx.type2Cii",\r\nFT_UINT8, BASE_DEC, VALS(cii_msgs), WIMAX_MAC_HEADER_TYPE_2_CII,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_fb_type,\r\n{\r\n"Feedback Type", "wmx.type2FbType",\r\nFT_UINT8, BASE_DEC, VALS(fb_types), WIMAX_MAC_HEADER_TYPE_2_FB_TYPE,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_cqi_fb_type,\r\n{\r\n"Mimo Feedback Type", "wmx.type2MimoFbType",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_CQI_FB_TYPE,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_cqi_payload,\r\n{\r\n"CQI and Mimo Feedback Payload", "wmx.type2MimoFbPayload",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_CQI_PAYLOAD,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_cqi_rsv,\r\n{\r\n"Reserved", "wmx.type2MimoFbRsv",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_CQI_RSV,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_dl_ave_cinr,\r\n{\r\n"DL Average CINR", "wmx.type2DlAveCinr",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_DL_AVE_CINR,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_dl_ave_rsv,\r\n{\r\n"Reserved", "wmx.type2DlAveRsv",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_DL_AVE_RSV,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_mimo_coef_ni,\r\n{\r\n"Number of Index", "wmx.type2MimoCoefNi",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_MIMO_COEF_NI,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_mimo_coef_ai,\r\n{\r\n"Occurrences of Antenna Index", "wmx.type2MimoCoefAi",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_MIMO_COEF_AI,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_mimo_coef,\r\n{\r\n"MIMO Coefficients", "wmx.type2MimoCoef",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_MIMO_COEF,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_mimo_coef_rsv,\r\n{\r\n"Reserved", "wmx.type2MimoCoefRsv",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_MIMO_COEF_RSV,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_dl_chan_diuc,\r\n{\r\n"Preferred DIUC", "wmx.type2DlChanDiuc",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_DL_CHAN_DIUC,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_dl_chan_dcd,\r\n{\r\n"DCD Change Count", "wmx.type2DlChanDcd",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_DL_CHAN_DCD,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_dl_chan_rsv,\r\n{\r\n"Reserved", "wmx.type2DlChanRsv",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_DL_CHAN_RSV,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_ul_tx_pwr,\r\n{\r\n"UL TX Power", "wmx.type2UlTxPwr",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_UL_TX_PWR,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_ul_tx_pwr_rsv,\r\n{\r\n"Reserved", "wmx.type2UlTxPwrRsv",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_UL_TX_PWR_RSV,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_phy_diuc,\r\n{\r\n"Preferred DIUC Index", "wmx.type2PhyDiuc",\r\nFT_UINT24, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_PHY_DIUC,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_phy_ul_tx_pwr,\r\n{\r\n"UL TX Power", "wmx.type2PhyUlTxPwr",\r\nFT_UINT24, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_PHY_UL_TX_PWR,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_phy_ul_hdrm,\r\n{\r\n"UL Headroom", "wmx.type2PhyHdRm",\r\nFT_UINT24, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_PHY_UL_HDRM,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_phy_rsv,\r\n{\r\n"Reserved", "wmx.type2PhyRsv",\r\nFT_UINT24, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_PHY_RSV,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_amc_bitmap,\r\n{\r\n"AMC Band Indication Bitmap", "wmx.type2AmcBitmap",\r\nFT_UINT32, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_AMC_BITMAP,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_amc_cqi_1,\r\n{\r\n"CQI 1", "wmx.type2AmcCqi1",\r\nFT_UINT32, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_AMC_CQI_1,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_amc_cqi_2,\r\n{\r\n"CQI 2", "wmx.type2AmcCqi2",\r\nFT_UINT32, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_AMC_CQI_2,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_amc_cqi_3,\r\n{\r\n"CQI 3", "wmx.type2AmcCqi3",\r\nFT_UINT32, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_AMC_CQI_3,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_amc_cqi_4,\r\n{\r\n"CQI 4", "wmx.type2AmcCqi4",\r\nFT_UINT32, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_AMC_CQI_4,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_life_span,\r\n{\r\n"Life Span of Short-term", "wmx.type2LifeSpan",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_LIFE_SPAN,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_life_span_rsv,\r\n{\r\n"Reserved", "wmx.type2LifeSpanRsv",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_LIFE_SPAN_RSV,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_mt_num_fb_types,\r\n{\r\n"Number of Feedback Types", "wmx.type2MtNumFbTypes",\r\nFT_UINT32, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_MT_NUM_FB_TYPES,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_mt_occu_fb_type,\r\n{\r\n"Occurrences of Feedback Type", "wmx.type2MtOccuFbType",\r\nFT_UINT32, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_MT_OCCU_FB_TYPE,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_mt_fb_contents,\r\n{\r\n"Number of Feedback Types", "wmx.type2MtNumFbTypes",\r\nFT_UINT32, BASE_HEX, NULL, WIMAX_MAC_HEADER_TYPE_2_MT_FB_CONTENTS,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_lt_id_fb,\r\n{\r\n"Long-term Feedback Index", "wmx.type2LtFbId",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_LT_ID_FB,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_lt_rank,\r\n{\r\n"Rank of Precoding Codebook", "wmx.type2LtRank",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_LT_RANK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_lt_fec_qam,\r\n{\r\n"FEC and QAM", "wmx.type2LtFecQam",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_LT_FEC_QAM,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_lt_rsv,\r\n{\r\n"Reserved", "wmx.type2LtFbId",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_LT_RSV,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_comb_dl_ave,\r\n{\r\n"Combined DL Average CINR of Active BSs", "wmx.type2CombDlAve",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_COMB_DL_AVE,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_comb_dl_rsv,\r\n{\r\n"Reserved", "wmx.type2CombDlRsv",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_COMB_DL_RSV,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_mimo_diuc,\r\n{\r\n"Preferred DIUC Index", "wmx.type2MimoDiuc",\r\nFT_UINT8, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_DIUC,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_mimo_pbwi,\r\n{\r\n"Preferred Bandwidth Index", "wmx.type2MimoPbwi",\r\nFT_UINT8, BASE_DEC, VALS(pbwi_table), WIMAX_MAC_HEADER_TYPE_2_PBWI,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_mimo_slpb,\r\n{\r\n"Starting Location of Preferred Bandwidth", "wmx.type2MimoSlpb",\r\nFT_UINT24, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_SLPB,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_mimo_bpri_cid,\r\n{\r\n"Burst Profile Ranking Indicator with CID", "wmx.type2MimoBpriCid",\r\nFT_UINT24, BASE_HEX, VALS(bpri_table), WIMAX_MAC_HEADER_TYPE_2_PBRI_CID,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_mimo_cid,\r\n{\r\n"Connection ID", "wmx.type2MimoCid",\r\nFT_UINT24, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_CID,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_mimo_bpri,\r\n{\r\n"Burst Profile Ranking Indicator without CID", "wmx.type2MimoBpri",\r\nFT_UINT24, BASE_HEX, VALS(bpri_table), WIMAX_MAC_HEADER_TYPE_2_PBRI,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_mimo_cti,\r\n{\r\n"Coherent Time Index", "wmx.type2MimoCti",\r\nFT_UINT24, BASE_HEX, VALS(cti_table), WIMAX_MAC_HEADER_TYPE_2_CTI,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_mimo_ai_0,\r\n{\r\n"Antenna 0 Indication", "wmx.type2MimoAi",\r\nFT_UINT24, BASE_HEX, VALS(ai_msgs), WIMAX_MAC_HEADER_TYPE_2_AI_0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_mimo_ai_1,\r\n{\r\n"Antenna 1 Indication", "wmx.type2MimoAi",\r\nFT_UINT24, BASE_HEX, VALS(ai_msgs), WIMAX_MAC_HEADER_TYPE_2_AI_1,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_mimo_ai_2,\r\n{\r\n"Antenna 2 Indication", "wmx.type2MimoAi",\r\nFT_UINT24, BASE_HEX, VALS(ai_msgs), WIMAX_MAC_HEADER_TYPE_2_AI_2,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_mimo_ai_3,\r\n{\r\n"Antenna 3 Indication", "wmx.type2MimoAi",\r\nFT_UINT24, BASE_HEX, VALS(ai_msgs), WIMAX_MAC_HEADER_TYPE_2_AI_3,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_mimo_mi,\r\n{\r\n"MS Matrix Indicator", "wmx.type2MimoMi",\r\nFT_UINT24, BASE_HEX, VALS(mi_table), WIMAX_MAC_HEADER_TYPE_2_MI,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_mimo_ct,\r\n{\r\n"CQI Type", "wmx.type2MimoCt",\r\nFT_UINT24, BASE_HEX, VALS(ct_msgs), WIMAX_MAC_HEADER_TYPE_2_CT,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_mimo_cqi,\r\n{\r\n"CQI Feedback", "wmx.type2MimoCqi",\r\nFT_UINT24, BASE_HEX, NULL, WIMAX_MAC_HEADER_TYPE_2_CQI,\r\nNULL, HFILL\r\n}\r\n},\r\n{ &hf_mac_header_type_2_cinr_mean,\r\n{\r\n"CINR Mean", "wmx.type2CinrMean",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_cinr_devi,\r\n{\r\n"CINR Standard Deviation", "wmx.type2CinrDevi",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_cl_mimo_type,\r\n{\r\n"Closed-Loop MIMO Type", "wmx.type2ClMimoType",\r\nFT_UINT16, BASE_HEX, NULL, WIMAX_MAC_HEADER_TYPE_2_CL_MIMO_TYPE,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_cl_mimo_ant_id,\r\n{\r\n"Antenna Grouping Index", "wmx.type2ClMimoAntId",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_CL_MIMO_ANT_ID,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_cl_mimo_cqi,\r\n{\r\n"Average CQI", "wmx.type2ClMimoCqi",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_CL_MIMO_CQI,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_cl_mimo_cqi_1,\r\n{\r\n"Average CQI", "wmx.type2ClMimoCqi",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_CL_MIMO_CQI_1,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_cl_mimo_cqi_2,\r\n{\r\n"Average CQI", "wmx.type2ClMimoCqi",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_CL_MIMO_CQI_2,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_cl_mimo_rsv,\r\n{\r\n"Reserved", "wmx.type2ClMimoRsv",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_CL_MIMO_RSV,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_cl_mimo_rsv_1,\r\n{\r\n"Reserved", "wmx.type2ClMimoRsv",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_CL_MIMO_RSV_1,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_cl_mimo_rsv_2,\r\n{\r\n"Reserved", "wmx.type2ClMimoRsv",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_CL_MIMO_RSV_2,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_cl_mimo_streams,\r\n{\r\n"Number of Streams", "wmx.type2ClMimoStreams",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_CL_MIMO_STREAMS,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_cl_mimo_ant_sel,\r\n{\r\n"Antenna Selection Option Index", "wmx.type2ClMimoAntSel",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_CL_MIMO_ANT_SEL,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_cl_mimo_codebook_id,\r\n{\r\n"Codebook Index", "wmx.type2ClMimoCodeBkId",\r\nFT_UINT16, BASE_DEC, NULL, WIMAX_MAC_HEADER_TYPE_2_CL_MIMO_CODEBOOK_ID,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_cid,\r\n{\r\n"Connection ID", "wmx.type2Cid",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_no_cid,\r\n{\r\n"Reserved", "wmx.type2NoCid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_header_type_2_hcs,\r\n{\r\n"Header Check Sequence", "wmx.type2Hcs",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL\r\n}\r\n}\r\n};\r\nstatic gint *ett[] =\r\n{\r\n&ett_mac_header_type_2_decoder,\r\n};\r\nproto_mac_header_type_2_decoder = proto_mac_header_generic_decoder;\r\nproto_register_field_array(proto_mac_header_type_2_decoder, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nregister_dissector("mac_header_type_2_handler", dissect_mac_header_type_2_decoder, proto_mac_header_type_2_decoder);\r\n}
