static int\r\ndissect_mrcpv2_common(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nproto_item *ti;\r\nproto_tree *mrcpv2_tree;\r\ngint next_offset, linelen;\r\ngint tvb_len;\r\ngint pdu_size;\r\ngint offset;\r\ngint value_offset;\r\ngint str_len;\r\ngchar *header_name;\r\ngchar *header_value;\r\nLINE_TYPE line_type = UNKNOWN_LINE;\r\nHEADER_TYPE header_type;\r\ngint colon_offset;\r\ngint content_length;\r\nconst value_string *p = NULL;\r\nproto_item *line_item = NULL;\r\nproto_item *request_line_item = NULL;\r\nproto_item *response_line_item = NULL;\r\nproto_item *event_line_item = NULL;\r\nproto_item *status_code_item = NULL;\r\ngint sp_start;\r\ngint sp_end;\r\nguint8 *field1;\r\nguint8 *field2;\r\nguint8 *field3;\r\nguint8 *field4;\r\nguint8 *field5 = NULL;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "MRCPv2");\r\noffset = 0;\r\ntvb_len = tvb_reported_length(tvb);\r\nti = proto_tree_add_item(tree, proto_mrcpv2, tvb, 0, -1, ENC_UTF_8);\r\nmrcpv2_tree = proto_item_add_subtree(ti, ett_mrcpv2);\r\nlinelen = tvb_find_line_end(tvb, offset, -1, &next_offset, FALSE);\r\nsp_end = tvb_find_guint8(tvb, 0, linelen, ' ');\r\nif ((sp_end == -1) || (sp_end > tvb_len) || (sp_end > linelen))\r\nreturn -1;\r\nfield1 = tvb_get_string_enc(wmem_packet_scope(), tvb, 0, sp_end, ENC_ASCII);\r\nsp_start = sp_end + 1;\r\nsp_end = tvb_find_guint8(tvb, sp_start, linelen - sp_start, ' ');\r\nif ((sp_end == -1) || (sp_end > tvb_len) || (sp_end > linelen))\r\nreturn -1;\r\nfield2 = tvb_get_string_enc(wmem_packet_scope(), tvb, sp_start, sp_end - sp_start, ENC_ASCII);\r\nsp_start = sp_end + 1;\r\nsp_end = tvb_find_guint8(tvb, sp_start, linelen - sp_start, ' ');\r\nif ((sp_end == -1) || (sp_end > tvb_len) || (sp_end > linelen))\r\nreturn -1;\r\nfield3 = tvb_get_string_enc(wmem_packet_scope(), tvb, sp_start, sp_end - sp_start, ENC_ASCII);\r\nsp_start = sp_end + 1;\r\nsp_end = tvb_find_guint8(tvb, sp_start, linelen - sp_start, ' ');\r\nif (sp_end == -1)\r\n{\r\nfield4 = tvb_get_string_enc(wmem_packet_scope(), tvb, sp_start, linelen - sp_start, ENC_ASCII);\r\nline_type = REQUEST_LINE;\r\n}\r\nelse\r\n{\r\nif ((sp_end > tvb_len) || (sp_end > linelen))\r\nreturn -1;\r\nfield4 = tvb_get_string_enc(wmem_packet_scope(), tvb, sp_start, sp_end - sp_start, ENC_ASCII);\r\nif (g_ascii_isdigit(field3[0]))\r\nline_type = RESPONSE_LINE;\r\nelse\r\nline_type = EVENT_LINE;\r\nsp_start = sp_end + 1;\r\nsp_end = linelen;\r\nif ((sp_end > tvb_len) || (sp_end > linelen))\r\nreturn -1;\r\nfield5 = tvb_get_string_enc(wmem_packet_scope(), tvb, sp_start, sp_end - sp_start, ENC_ASCII);\r\n}\r\npdu_size = atoi(field2);\r\nif (pdu_size > tvb_len)\r\nreturn -1;\r\nswitch(line_type){\r\ncase REQUEST_LINE:\r\n{\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Request: ");\r\nline_item = proto_tree_add_item(mrcpv2_tree, hf_mrcpv2_Request_Line, tvb, offset, linelen, ENC_UTF_8|ENC_NA);\r\nrequest_line_item = proto_item_add_subtree(line_item, ett_Request_Line);\r\nstr_len = (gint)strlen(field1);\r\nproto_tree_add_item(request_line_item, hf_mrcpv2_version, tvb, offset, str_len, ENC_UTF_8|ENC_NA);\r\noffset += str_len + 1;\r\nstr_len = (gint)strlen(field2);\r\nproto_tree_add_item(request_line_item, hf_mrcpv2_message_length, tvb, offset, str_len, ENC_UTF_8|ENC_NA);\r\noffset += str_len + 1;\r\ncol_append_str(pinfo->cinfo, COL_INFO, field3);\r\nstr_len = (gint)strlen(field3);\r\nproto_tree_add_item(request_line_item, hf_mrcpv2_Method, tvb, offset, str_len, ENC_UTF_8|ENC_NA);\r\noffset += str_len + 1;\r\nstr_len = (gint)strlen(field4);\r\nproto_tree_add_item(request_line_item, hf_mrcpv2_request_id, tvb, offset, str_len, ENC_UTF_8|ENC_NA);\r\n}\r\nbreak;\r\ncase RESPONSE_LINE:\r\n{\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Response: ");\r\nline_item = proto_tree_add_item(mrcpv2_tree, hf_mrcpv2_Response_Line, tvb, offset, linelen, ENC_UTF_8|ENC_NA);\r\nresponse_line_item = proto_item_add_subtree(line_item, ett_Response_Line);\r\nstr_len = (gint)strlen(field1);\r\nproto_tree_add_item(response_line_item, hf_mrcpv2_version, tvb, offset, str_len, ENC_UTF_8|ENC_NA);\r\noffset += str_len + 1;\r\nstr_len = (gint)strlen(field2);\r\nproto_tree_add_item(response_line_item, hf_mrcpv2_message_length, tvb, offset, str_len, ENC_UTF_8|ENC_NA);\r\noffset += str_len + 1;\r\nstr_len = (gint)strlen(field3);\r\nproto_tree_add_item(response_line_item, hf_mrcpv2_request_id, tvb, offset, str_len, ENC_UTF_8|ENC_NA);\r\noffset += str_len + 1;\r\nstr_len = (gint)strlen(field4);\r\nstatus_code_item = proto_tree_add_item(response_line_item, hf_mrcpv2_status_code, tvb, offset,\r\nstr_len, ENC_UTF_8|ENC_NA);\r\nproto_item_append_text(status_code_item, " %s", str_to_str(field4, status_code_vals, "Unknown Status Code"));\r\noffset += str_len + 1;\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "(%s) %s", field4, field5);\r\nstr_len = (gint)strlen(field5);\r\nproto_tree_add_item(response_line_item, hf_mrcpv2_request_state, tvb, offset, str_len, ENC_UTF_8|ENC_NA);\r\n}\r\nbreak;\r\ncase EVENT_LINE:\r\n{\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Event: ");\r\nline_item = proto_tree_add_item(mrcpv2_tree, hf_mrcpv2_Event_Line, tvb, offset, linelen, ENC_UTF_8|ENC_NA);\r\nevent_line_item = proto_item_add_subtree(line_item, ett_Event_Line);\r\nstr_len = (gint)strlen(field1);\r\nproto_tree_add_item(event_line_item, hf_mrcpv2_version, tvb, offset, str_len, ENC_UTF_8|ENC_NA);\r\noffset += str_len + 1;\r\nstr_len = (gint)strlen(field2);\r\nproto_tree_add_item(event_line_item, hf_mrcpv2_message_length, tvb, offset, str_len, ENC_UTF_8|ENC_NA);\r\noffset += str_len + 1;\r\ncol_append_str(pinfo->cinfo, COL_INFO, field3);\r\nstr_len = (gint)strlen(field3);\r\nproto_tree_add_item(event_line_item, hf_mrcpv2_Event, tvb, offset, str_len, ENC_UTF_8|ENC_NA);\r\noffset += str_len + 1;\r\nstr_len = (gint)strlen(field4);\r\nproto_tree_add_item(event_line_item, hf_mrcpv2_request_id, tvb, offset, str_len, ENC_UTF_8|ENC_NA);\r\noffset += str_len + 1;\r\nstr_len = (gint)strlen(field5);\r\nproto_tree_add_item(event_line_item, hf_mrcpv2_request_state, tvb, offset, str_len, ENC_UTF_8|ENC_NA);\r\n}\r\nbreak;\r\ndefault:\r\n{\r\ncol_set_str(pinfo->cinfo, COL_INFO, "UNKNOWN message");\r\nproto_tree_add_item(mrcpv2_tree, hf_mrcpv2_Unknown_Message, tvb, offset, tvb_len, ENC_UTF_8|ENC_NA);\r\nreturn tvb_len;\r\n}\r\n}\r\nif (tree) {\r\ncontent_length = 0;\r\nwhile (tvb_offset_exists(tvb, next_offset))\r\n{\r\noffset = next_offset;\r\nlinelen = tvb_find_line_end(tvb, offset, -1, &next_offset, FALSE);\r\nif (linelen == 0)\r\n{\r\nif (content_length > 0)\r\n{\r\noffset += 2;\r\nproto_tree_add_item(mrcpv2_tree, hf_mrcpv2_Data, tvb, offset, tvb_len - offset, ENC_ASCII|ENC_NA);\r\nnext_offset = tvb_len;\r\n}\r\ncontinue;\r\n}\r\ncolon_offset = tvb_find_guint8(tvb, offset, linelen, ':');\r\nif (colon_offset == -1)\r\n{\r\nproto_tree_add_item(mrcpv2_tree, hf_mrcpv2_Unknown_Header, tvb, offset, linelen, ENC_UTF_8|ENC_NA);\r\ncontinue;\r\n}\r\nheader_name = tvb_get_string_enc(wmem_packet_scope(), tvb, offset, colon_offset - offset, ENC_ASCII);\r\nascii_strdown_inplace(header_name);\r\nvalue_offset = tvb_skip_wsp(tvb, colon_offset + 1, offset + linelen - (colon_offset + 1));\r\nheader_value = tvb_get_string_enc(wmem_packet_scope(), tvb, value_offset, offset + linelen - value_offset, ENC_ASCII);\r\nheader_type = UNKNOWN;\r\nfor (p = header_type_vals; p->strptr != NULL; ++p)\r\n{\r\nif (strncmp(p->strptr, header_name, strlen(p->strptr)) == 0)\r\n{\r\nheader_type = (HEADER_TYPE)p->value;\r\nbreak;\r\n}\r\n}\r\nswitch (header_type)\r\n{\r\ncase ABORT_MODEL:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Abort_Model, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase ABORT_PHRASE_ENROLLMENT:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Abort_Phrase_Enrollment, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase ABORT_VERIFICATION:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Abort_Verification, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase ACCEPT:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Accept, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase ACCEPT_CHARSET:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Accept_Charset, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase ACTIVE_REQUEST_ID_LIST:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Active_Request_Id_List, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase ADAPT_MODEL:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Adapt_Model, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase AUDIO_FETCH_HINT:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Audio_Fetch_Hint, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase CACHE_CONTROL:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Cache_Control, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase CANCEL_IF_QUEUE:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Cancel_If_Queue, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase CAPTURE_ON_SPEECH:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Capture_On_Speech, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase CHANNEL_IDENTIFIER:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Channel_Identifier, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase CLASH_THRESHOLD:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Clash_Threshold, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase CLEAR_DTMF_BUFFER:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Clear_Dtmf_Buffer, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase COMPLETION_CAUSE:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Completion_Cause, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase COMPLETION_REASON:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Completion_Reason, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase CONFIDENCE_THRESHOLD:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Confidence_Threshold, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase CONFUSABLE_PHRASES_URI:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Confusable_Phrases_URI, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase CONSISTENCY_THRESHOLD:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Consistency_Threshold, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase CONTENT_BASE:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Content_Base, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase CONTENT_ENCODING:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Content_Encoding, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase CONTENT_ID:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Content_ID, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase CONTENT_LENGTH:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Content_Length, tvb, offset, linelen, header_value);\r\ncontent_length = atoi(header_value);\r\nbreak;\r\ncase CONTENT_LOCATION:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Content_Location, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase CONTENT_TYPE:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Content_Type, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase DTMF_BUFFER_TIME:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Dtmf_Buffer_Time, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase DTMF_INTERDIGIT_TIMEOUT:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Dtmf_Interdigit_Timeout, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase DTMF_TERM_CHAR:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Dtmf_Term_Char, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase DTMF_TERM_TIMEOUT:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Dtmf_Term_Timeout, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase EARLY_NO_MATCH:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Early_No_Match, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase ENROLL_UTTERANCE:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Enroll_Utterance, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase FAILED_URI:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Failed_URI, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase FAILED_URI_CAUSE:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Failed_URI_Cause, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase FETCH_HINT:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Fetch_Hint, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase FETCH_TIMEOUT:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Fetch_Timeout, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase FINAL_SILENCE:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Final_Silence, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase HOTWORD_MAX_DURATION:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Hotword_Max_Duration, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase HOTWORD_MIN_DURATION:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Hotword_Min_Duration, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase INPUT_TYPE:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Input_Type, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase INPUT_WAVEFORM_URI:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Input_Waveform_URI, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase INTERPRET_TEXT:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Interpret_Text, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase JUMP_SIZE:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Jump_Size, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase KILL_ON_BARGE_IN:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Kill_On_Barge_In, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase LEXICON_SEARCH_ORDER:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Lexicon_Search_Order, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase LOAD_LEXICON:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Load_Lexicon, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase LOGGING_TAG:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Logging_Tag, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase MAX_TIME:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Max_Time, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase MEDIA_TYPE:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Media_Type, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase MIN_VERIFICATION_SCORE:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Min_Verification_Score, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase N_BEST_LIST_LENGTH:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_N_Best_List_Length, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase NEW_AUDIO_CHANNEL:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_New_Audio_Channel, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase NEW_PHRASE_ID:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_New_Phrase_ID, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase NO_INPUT_TIMEOUT:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_No_Input_Timeout, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase NUM_MAX_VERIFICATION_PHRASES:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Num_Max_Verification_Phrases, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase NUM_MIN_CONSISTENT_PRONUNCIATIONS:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Num_Min_Consistent_Pronunciations, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase NUM_MIN_VERIFICATION_PHRASES:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Num_Min_Verification_Phrases, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase PERSONAL_GRAMMAR_URI:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Personal_Grammar_URI, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase PHRASE_ID:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Phrase_ID, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase PHRASE_NL:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Phrase_NL, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase PROSODY_CONTOUR:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Prosody_Contour, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase PROSODY_DURATION:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Prosody_Duration, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase PROSODY_PITCH:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Prosody_Pitch, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase PROSODY_RANGE:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Prosody_Range, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase PROSODY_RATE:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Prosody_Rate, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase PROSODY_VOLUME:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Prosody_Volume, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase PROXY_SYNC_ID:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Proxy_Sync_Id, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase RECOGNITION_MODE:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Recognition_Mode, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase RECOGNITION_TIMEOUT:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Recognition_Timeout, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase RECOGNIZER_CONTEXT_BLOCK:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Recognizer_Context_Block, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase RECORD_URI:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Record_URI, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase REPOSITORY_URI:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Repository_URI, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase SAVE_BEST_WAVEFORM:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Save_Best_Waveform, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase SAVE_WAVEFORM:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Save_Waveform, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase SENSITIVITY_LEVEL:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Sensitivity_Level, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase SET_COOKIE:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Set_Cookie, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase SPEAK_LENGTH:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Speak_Length, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase SPEAK_RESTART:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Speak_Restart, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase SPEAKER_PROFILE:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Speaker_Profile, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase SPEECH_COMPLETE_TIMEOUT:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Speech_Complete_Timeout, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase SPEECH_INCOMPLETE_TIMEOUT:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Speech_Incomplete_Timeout, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase SPEECH_LANGUAGE:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Speech_Language, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase SPEECH_MARKER:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Speech_Marker, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase SPEED_VS_ACCURACY:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Speed_Vs_Accuracy, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase START_INPUT_TIMERS:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Start_Input_Timers, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase TRIM_LENGTH:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Trim_Length, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase VENDOR_SPECIFIC_PARAMETERS:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Vendor_Specific_Parameters, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase VER_BUFFER_UTTERANCE:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Ver_Buffer_Utterance, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase VERIFICATION_MODE:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Verification_Mode, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase VOICE_AGE:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Voice_Age, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase VOICE_GENDER:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Voice_Gender, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase VOICE_NAME:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Voice_Name, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase VOICE_VARIANT:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Voice_Variant, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase VOICEPRINT_EXISTS:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Voiceprint_Exists, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase VOICEPRINT_IDENTIFIER:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Voiceprint_Identifier, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase WAVEFORM_URI:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Waveform_URI, tvb, offset, linelen, header_value);\r\nbreak;\r\ncase WEIGHT:\r\nproto_tree_add_string(mrcpv2_tree, hf_mrcpv2_Weight, tvb, offset, linelen, header_value);\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(mrcpv2_tree, hf_mrcpv2_Unknown_Header, tvb, offset, linelen, ENC_UTF_8|ENC_NA);\r\nbreak;\r\n}\r\n}\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic guint\r\nget_mrcpv2_pdu_len(packet_info *pinfo _U_, tvbuff_t *tvb, int offset, void *data _U_)\r\n{\r\ngint len_start;\r\ngint len_end;\r\nguint8 *msg_len;\r\nguint num_msg_len;\r\nlen_start = tvb_find_guint8(tvb, offset, MRCPV2_MIN_PDU_LEN, ' ');\r\nif (len_start == -1)\r\nreturn 0;\r\nlen_start += 1;\r\nlen_end = tvb_find_guint8(tvb, len_start, MRCPV2_MIN_PDU_LEN - len_start, ' ');\r\nif (len_end == -1)\r\nmsg_len = tvb_get_string_enc(wmem_packet_scope(), tvb, len_start, MRCPV2_MIN_PDU_LEN - len_start, ENC_ASCII);\r\nelse\r\nmsg_len = tvb_get_string_enc(wmem_packet_scope(), tvb, len_start, len_end - len_start, ENC_ASCII);\r\nnum_msg_len = atoi(msg_len);\r\nreturn num_msg_len;\r\n}\r\nstatic int\r\ndissect_mrcpv2_tcp_pdu(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nreturn dissect_mrcpv2_common(tvb, pinfo, tree);\r\n}\r\nstatic int\r\ndissect_mrcpv2_tcp(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data)\r\n{\r\ngint len;\r\ngint value_size;\r\nguint8 *version;\r\nguint8 *major;\r\nguint8 *minor;\r\ngint slash_offset;\r\ngint dot_offset;\r\ngint sp_offset;\r\nint value;\r\nlen = tvb_captured_length(tvb);\r\nif (len < MRCPV2_MIN_LENGTH)\r\nreturn 0;\r\nslash_offset = tvb_find_guint8(tvb, 0, MRCPV2_MIN_LENGTH, '/');\r\nif (slash_offset != 4)\r\nreturn 0;\r\nversion = tvb_get_string_enc(wmem_packet_scope(), tvb, 0, slash_offset, ENC_ASCII);\r\nif (strcmp(version, "MRCP") != 0)\r\nreturn 0;\r\ndot_offset = tvb_find_guint8(tvb, slash_offset + 1, MRCPV2_MIN_LENGTH - slash_offset - 1, '.');\r\nif (dot_offset == -1)\r\nreturn 0;\r\nvalue_size = dot_offset - slash_offset - 1;\r\nif ((value_size != 1) && (value_size != 2))\r\nreturn 0;\r\nmajor = tvb_get_string_enc(wmem_packet_scope(), tvb, slash_offset + 1, dot_offset - 1, ENC_ASCII);\r\nvalue = atoi(major);\r\nif (value != 2)\r\nreturn 0;\r\nsp_offset = tvb_find_guint8(tvb, dot_offset + 1, MRCPV2_MIN_LENGTH - dot_offset - 1, ' ');\r\nif (sp_offset == -1)\r\n{\r\nminor = tvb_get_string_enc(wmem_packet_scope(), tvb, dot_offset + 1, MRCPV2_MIN_LENGTH - dot_offset - 1, ENC_ASCII);\r\nlen = MRCPV2_MIN_LENGTH;\r\n}\r\nelse\r\n{\r\nminor = tvb_get_string_enc(wmem_packet_scope(), tvb, dot_offset + 1, MRCPV2_MIN_LENGTH - sp_offset - 1, ENC_ASCII);\r\nlen = sp_offset;\r\n}\r\nvalue = atoi(minor);\r\nif (value != 0)\r\nreturn 0;\r\ntcp_dissect_pdus(tvb, pinfo, tree, TRUE, MRCPV2_MIN_PDU_LEN,\r\nget_mrcpv2_pdu_len,\r\ndissect_mrcpv2_tcp_pdu, data);\r\nreturn len;\r\n}\r\nvoid\r\nproto_register_mrcpv2(void)\r\n{\r\nmodule_t *mrcpv2_module;\r\nstatic hf_register_info hf[] = {\r\n{ &hf_mrcpv2_Request_Line,\r\n{ "Request-Line", "mrcpv2.Request-Line",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_mrcpv2_Response_Line,\r\n{ "Response-Line", "mrcpv2.Response-Line",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_mrcpv2_Event_Line,\r\n{ "Event-Line", "mrcpv2.Event-Line",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_mrcpv2_Unknown_Message,\r\n{ "Unknown Message", "mrcpv2.Unknown-Message",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_mrcpv2_Unknown_Header,\r\n{ "Unknown Header", "mrcpv2.Unknown-Header",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_mrcpv2_Data,\r\n{ "Message data", "mrcpv2.Data",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_mrcpv2_Method,\r\n{ "Method", "mrcpv2.Method",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_mrcpv2_Event,\r\n{ "Event", "mrcpv2.Event",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_mrcpv2_version,\r\n{ "Version", "mrcpv2.Version",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_mrcpv2_message_length,\r\n{ "Message Length", "mrcpv2.msg_len",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_mrcpv2_request_id,\r\n{ "Request ID", "mrcpv2.reqID",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_mrcpv2_status_code,\r\n{ "Status Code", "mrcpv2.status_code",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_mrcpv2_request_state,\r\n{ "Request State", "mrcpv2.request_state",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_mrcpv2_Abort_Model,\r\n{ "Abort-Model", "mrcpv2.Abort-Model",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Abort_Phrase_Enrollment,\r\n{ "Abort-Phrase-Enrollment", "mrcpv2.Abort-Phrase-Enrollment",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Abort_Verification,\r\n{ "Abort-Verification", "mrcpv2.Abort-Verification",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Accept,\r\n{ "Accept", "mrcpv2.Accept",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Accept_Charset,\r\n{ "Accept-Charset", "mrcpv2.Accept-Charset",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Active_Request_Id_List,\r\n{ "Active-Request-Id-List", "mrcpv2.Active-Request-Id-List",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Adapt_Model,\r\n{ "Adapt-Model", "mrcpv2.Adapt-Model",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Audio_Fetch_Hint,\r\n{ "Audio-Fetch-Hint", "mrcpv2.Audio-Fetch-Hint",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Cache_Control,\r\n{ "Cache-Control", "mrcpv2.Cache-Control",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Cancel_If_Queue,\r\n{ "Cancel-If-Queue", "mrcpv2.Cancel-If-Queue",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Capture_On_Speech,\r\n{ "Capture-On-Speech", "mrcpv2.Capture-On-Speech",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Channel_Identifier,\r\n{ "Channel-Identifier", "mrcpv2.Channel-Identifier",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Clash_Threshold,\r\n{ "Clash-Threshold", "mrcpv2.Clash-Threshold",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Clear_Dtmf_Buffer,\r\n{ "Clear-Dtmf-Buffer", "mrcpv2.Clear-Dtmf-Buffer",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Completion_Cause,\r\n{ "Completion-Cause", "mrcpv2.Completion-Cause",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Completion_Reason,\r\n{ "Completion-Reason", "mrcpv2.Completion-Reason",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Confidence_Threshold,\r\n{ "Confidence-Threshold", "mrcpv2.Confidence-Threshold",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Confusable_Phrases_URI,\r\n{ "Confusable-Phrases-URI", "mrcpv2.Confusable-Phrases-URI",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Consistency_Threshold,\r\n{ "Consistency-Threshold", "mrcpv2.Consistency-Threshold",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Content_Base,\r\n{ "Content-Base", "mrcpv2.Content-Base",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Content_Encoding,\r\n{ "Content-Encoding", "mrcpv2.Content-Encoding",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Content_ID,\r\n{ "Content-ID", "mrcpv2.Content-ID",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Content_Length,\r\n{ "Content-Length", "mrcpv2.Content-Length",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Content_Location,\r\n{ "Content-Location", "mrcpv2.Content-Location",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Content_Type,\r\n{ "Content-Type", "mrcpv2.Content-Type",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Dtmf_Buffer_Time,\r\n{ "Dtmf-Buffer-Time", "mrcpv2.Dtmf-Buffer-Time",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Dtmf_Interdigit_Timeout,\r\n{ "Dtmf-Interdigit-Timeout", "mrcpv2.Dtmf-Interdigit-Timeout",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Dtmf_Term_Char,\r\n{ "Dtmf-Term-Char", "mrcpv2.Dtmf-Term-Char",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Dtmf_Term_Timeout,\r\n{ "Dtmf-Term-Timeout", "mrcpv2.Dtmf-Term-Timeout",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Early_No_Match,\r\n{ "Early-No-Match", "mrcpv2.Early-No-Match",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Enroll_Utterance,\r\n{ "Enroll-Utterance", "mrcpv2.Enroll-Utterance",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Failed_URI,\r\n{ "Failed-URI", "mrcpv2.Failed-URI",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Failed_URI_Cause,\r\n{ "Failed-URI-Cause", "mrcpv2.Failed-URI-Cause",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Fetch_Hint,\r\n{ "Fetch-Hint", "mrcpv2.Fetch-Hint",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Fetch_Timeout,\r\n{ "Fetch-Timeout", "mrcpv2.Fetch-Timeout",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Final_Silence,\r\n{ "Final-Silence", "mrcpv2.Final-Silence",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Hotword_Max_Duration,\r\n{ "Hotword-Max-Duration", "mrcpv2.Hotword-Max-Duration",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Hotword_Min_Duration,\r\n{ "Hotword-Min-Duration", "mrcpv2.Hotword-Min-Duration",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Input_Type,\r\n{ "Input-Type", "mrcpv2.Input-Type",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Input_Waveform_URI,\r\n{ "Input-Waveform-URI", "mrcpv2.Input-Waveform-URI",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Interpret_Text,\r\n{ "Interpret-Text", "mrcpv2.Interpret-Text",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Jump_Size,\r\n{ "Jump-Size", "mrcpv2.Jump-Size",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Kill_On_Barge_In,\r\n{ "Kill-On-Barge-In", "mrcpv2.Kill-On-Barge-In",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Lexicon_Search_Order,\r\n{ "Lexicon-Search-Order", "mrcpv2.Lexicon-Search-Order",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Load_Lexicon,\r\n{ "Load-Lexicon", "mrcpv2.Load-Lexicon",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Logging_Tag,\r\n{ "Logging-Tag", "mrcpv2.Logging-Tag",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Max_Time,\r\n{ "Max-Time", "mrcpv2.Max-Time",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Media_Type,\r\n{ "Media-Type", "mrcpv2.Media-Type",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Min_Verification_Score,\r\n{ "Min-Verification-Score", "mrcpv2.Min-Verification-Score",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_N_Best_List_Length,\r\n{ "N-Best-List-Length", "mrcpv2.N-Best-List-Length",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_New_Audio_Channel,\r\n{ "New-Audio-Channel", "mrcpv2.New-Audio-Channel",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_New_Phrase_ID,\r\n{ "New-Phrase-ID", "mrcpv2.New-Phrase-ID",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_No_Input_Timeout,\r\n{ "No-Input-Timeout", "mrcpv2.No-Input-Timeout",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Num_Max_Verification_Phrases,\r\n{ "Num-Max-Verification-Phrases", "mrcpv2.Num-Max-Verification-Phrases",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Num_Min_Consistent_Pronunciations,\r\n{ "Num-Min-Consistent-Pronunciations", "mrcpv2.Num-Min-Consistent-Pronunciations",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Num_Min_Verification_Phrases,\r\n{ "Num-Min-Verification-Phrases", "mrcpv2.Num-Min-Verification-Phrases",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Personal_Grammar_URI,\r\n{ "Personal-Grammar-URI", "mrcpv2.Personal-Grammar-URI",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Phrase_ID,\r\n{ "Phrase-ID", "mrcpv2.Phrase-ID",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Phrase_NL,\r\n{ "Phrase-NL", "mrcpv2.Phrase-NL",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Prosody_Contour,\r\n{ "Prosody-Contour", "mrcpv2.Prosody-Contour",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Prosody_Duration,\r\n{ "Prosody-Duration", "mrcpv2.Prosody-Duration",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Prosody_Pitch,\r\n{ "Prosody-Pitch", "mrcpv2.Prosody-Pitch",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Prosody_Range,\r\n{ "Prosody-Range", "mrcpv2.Prosody-Range",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Prosody_Rate,\r\n{ "Prosody-Rate", "mrcpv2.Prosody-Rate",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Prosody_Volume,\r\n{ "Prosody-Volume", "mrcpv2.Prosody-Volume",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Proxy_Sync_Id,\r\n{ "Proxy-Sync-Id", "mrcpv2.Proxy-Sync-Id",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Recognition_Mode,\r\n{ "Recognition-Mode", "mrcpv2.Recognition-Mode",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Recognition_Timeout,\r\n{ "Recognition-Timeout", "mrcpv2.Recognition-Timeout",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Recognizer_Context_Block,\r\n{ "Recognizer-Context-Block", "mrcpv2.Recognizer-Context-Block",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Record_URI,\r\n{ "Record-URI", "mrcpv2.Record-URI",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Repository_URI,\r\n{ "Repository-URI", "mrcpv2.Repository-URI",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Save_Best_Waveform,\r\n{ "Save-Best-Waveform", "mrcpv2.Save-Best-Waveform",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Save_Waveform,\r\n{ "Save-Waveform", "mrcpv2.Save-Waveform",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Sensitivity_Level,\r\n{ "Sensitivity-Level", "mrcpv2.Sensitivity-Level",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Set_Cookie,\r\n{ "Set-Cookie", "mrcpv2.Set-Cookie",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Speak_Length,\r\n{ "Speak-Length", "mrcpv2.Speak-Length",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Speak_Restart,\r\n{ "Speak-Restart", "mrcpv2.Speak-Restart",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Speaker_Profile,\r\n{ "Speaker-Profile", "mrcpv2.Speaker-Profile",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Speech_Complete_Timeout,\r\n{ "Speech-Complete-Timeout", "mrcpv2.Speech-Complete-Timeout",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Speech_Incomplete_Timeout,\r\n{ "Speech-Incomplete-Timeout", "mrcpv2.Speech-Incomplete-Timeout",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Speech_Language,\r\n{ "Speech-Language", "mrcpv2.Speech-Language",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Speech_Marker,\r\n{ "Speech-Marker", "mrcpv2.Speech-Marker",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Speed_Vs_Accuracy,\r\n{ "Speed-Vs-Accuracy", "mrcpv2.Speed-Vs-Accuracy",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Start_Input_Timers,\r\n{ "Start-Input-Timers", "mrcpv2.Start-Input-Timers",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Trim_Length,\r\n{ "Trim-Length", "mrcpv2.Trim-Length",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Vendor_Specific_Parameters,\r\n{ "Vendor-Specific-Parameters", "mrcpv2.Vendor-Specific-Parameters",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Ver_Buffer_Utterance,\r\n{ "Ver-Buffer-Utterance", "mrcpv2.Ver-Buffer-Utterance",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Verification_Mode,\r\n{ "Verification-Mode", "mrcpv2.Verification-Mode",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Voice_Age,\r\n{ "Voice-Age", "mrcpv2.Voice-Age",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Voice_Gender,\r\n{ "Voice-Gender", "mrcpv2.Voice-Gender",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Voice_Name,\r\n{ "Voice-Name", "mrcpv2.Voice-Name",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Voice_Variant,\r\n{ "Voice-Variant", "mrcpv2.Voice-Variant",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Voiceprint_Exists,\r\n{ "Voiceprint-Exists", "mrcpv2.Voiceprint-Exists",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Voiceprint_Identifier,\r\n{ "Voiceprint-Identifier", "mrcpv2.Voiceprint-Identifier",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Waveform_URI,\r\n{ "Waveform-URI", "mrcpv2.Waveform-URI",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n},\r\n{ &hf_mrcpv2_Weight,\r\n{ "Weight", "mrcpv2.Weight",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL },\r\n}\r\n};\r\nstatic gint *ett[] = {\r\n&ett_mrcpv2,\r\n&ett_Request_Line,\r\n&ett_Response_Line,\r\n&ett_Event_Line,\r\n&ett_Status_Code\r\n};\r\nrange_convert_str(&global_mrcpv2_tcp_range, TCP_DEFAULT_RANGE, 65535);\r\nproto_mrcpv2 = proto_register_protocol(\r\n"Media Resource Control Protocol Version 2 (MRCPv2)",\r\n"MRCPv2",\r\n"mrcpv2");\r\nproto_register_field_array(proto_mrcpv2, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nmrcpv2_module = prefs_register_protocol(proto_mrcpv2, proto_reg_handoff_mrcpv2);\r\nprefs_register_obsolete_preference(mrcpv2_module, "tcp.port");\r\nprefs_register_range_preference(mrcpv2_module, "tcp.port_range", "MRCPv2 TCP Port",\r\n"MRCPv2 TCP Ports Range",\r\n&global_mrcpv2_tcp_range, 65535);\r\n}\r\nvoid\r\nproto_reg_handoff_mrcpv2(void)\r\n{\r\nstatic gboolean initialized = FALSE;\r\nstatic dissector_handle_t mrcpv2_handle;\r\nstatic range_t *mrcpv2_tcp_range = NULL;\r\nif (!initialized) {\r\nmrcpv2_handle = create_dissector_handle(dissect_mrcpv2_tcp, proto_mrcpv2);\r\ninitialized = TRUE;\r\n} else {\r\ndissector_delete_uint_range ("tcp.port", mrcpv2_tcp_range, mrcpv2_handle);\r\ng_free (mrcpv2_tcp_range);\r\n}\r\nmrcpv2_tcp_range = range_copy (global_mrcpv2_tcp_range);\r\ndissector_add_uint_range ("tcp.port", mrcpv2_tcp_range, mrcpv2_handle);\r\n}
