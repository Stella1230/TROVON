static gint dissect_image_leader(proto_tree *gvsp_tree, tvbuff_t *tvb, packet_info *pinfo _U_, gint offset)\r\n{\r\nproto_tree_add_bitmask(gvsp_tree, tvb, offset, hf_gvsp_fieldinfo,\r\nett_gvsp_fieldinfo, fieldinfo_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_payloadtype, tvb, offset + 2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_timestamp, tvb, offset + 4, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(gvsp_tree, tvb, offset + 12, hf_gvsp_pixelformat, ett_gvsp_pixelformat,\r\npixelformat_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_sizex, tvb, offset + 16, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_sizey, tvb, offset + 20, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_offsetx, tvb, offset + 24, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_offsety, tvb, offset + 28, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_paddingx, tvb, offset + 32, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_paddingy, tvb, offset + 34, 2, ENC_BIG_ENDIAN);\r\nreturn 36;\r\n}\r\nstatic gint dissect_image_trailer(proto_tree *gvsp_tree, tvbuff_t *tvb, packet_info *pinfo _U_, gint offset)\r\n{\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_payloadtype, tvb, offset + 2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_sizey, tvb, offset + 4, 4, ENC_BIG_ENDIAN);\r\nreturn 8;\r\n}\r\nstatic gint dissect_raw_data_leader(proto_tree *gvsp_tree, tvbuff_t *tvb, packet_info *pinfo _U_, gint offset)\r\n{\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_payloadtype, tvb, offset + 2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_timestamp, tvb, offset + 4, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_payloaddatasize, tvb, offset + 12, 8, ENC_BIG_ENDIAN);\r\nreturn 20;\r\n}\r\nstatic gint dissect_file_leader(proto_tree *gvsp_tree, tvbuff_t *tvb, packet_info *pinfo _U_, gint offset)\r\n{\r\nguint file_length = 0;\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_payloadtype, tvb, offset + 2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_timestamp, tvb, offset + 4, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_payloaddatasize, tvb, offset + 12, 8, ENC_BIG_ENDIAN);\r\nfile_length = tvb_strsize(tvb, offset + 20);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_filename, tvb, offset + 20, file_length, ENC_ASCII|ENC_NA);\r\nif (20 + file_length > G_MAXINT)\r\nreturn -1;\r\nreturn (gint)(20 + file_length);\r\n}\r\nstatic gint dissect_chunk_data_leader(proto_tree *gvsp_tree, tvbuff_t *tvb, packet_info *pinfo _U_, gint offset)\r\n{\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_payloadtype, tvb, offset + 2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_timestamp, tvb, offset + 4, 8, ENC_BIG_ENDIAN);\r\nreturn 12;\r\n}\r\nstatic gint dissect_chunk_data_trailer(proto_tree *gvsp_tree, tvbuff_t *tvb, packet_info *pinfo _U_, gint offset)\r\n{\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_payloadtype, tvb, offset + 2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_payloadlength, tvb, offset + 4, 4, ENC_BIG_ENDIAN);\r\nreturn 8;\r\n}\r\nstatic gint dissect_extended_chunk_data_leader(proto_tree *gvsp_tree, tvbuff_t *tvb, packet_info *pinfo _U_, gint offset)\r\n{\r\nproto_tree_add_bitmask(gvsp_tree, tvb, offset, hf_gvsp_fieldinfo,\r\nett_gvsp_fieldinfo, fieldinfo_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_genericflags, tvb, offset + 1, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_payloadtype, tvb, offset + 2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_timestamp, tvb, offset + 4, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(gvsp_tree, tvb, offset + 12, hf_gvsp_pixelformat, ett_gvsp_pixelformat,\r\npixelformat_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_sizex, tvb, offset + 16, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_sizey, tvb, offset + 20, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_offsetx, tvb, offset + 24, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_offsety, tvb, offset + 28, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_paddingx, tvb, offset + 32, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_paddingy, tvb, offset + 34, 2, ENC_BIG_ENDIAN);\r\nreturn 36;\r\n}\r\nstatic gint dissect_extended_chunk_data_trailer(proto_tree *gvsp_tree, tvbuff_t *tvb, packet_info *pinfo _U_, gint offset)\r\n{\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_payloadtype, tvb, offset + 2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_payloadlength, tvb, offset + 4, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_sizey, tvb, offset + 8, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_chunklayoutidex, tvb, offset + 12, 4, ENC_BIG_ENDIAN);\r\nreturn 16;\r\n}\r\nstatic gint dissect_jpeg_leader(proto_tree *gvsp_tree, tvbuff_t *tvb, packet_info *pinfo _U_, gint offset)\r\n{\r\nproto_tree_add_bitmask(gvsp_tree, tvb, offset, hf_gvsp_fieldinfo,\r\nett_gvsp_fieldinfo, fieldinfo_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_genericflags, tvb, offset + 1, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_payloadtype, tvb, offset + 2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_timestamp, tvb, offset + 4, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_payloaddatasize, tvb, offset + 12, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_timestamptickfrequency, tvb, offset + 20, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_dataformat, tvb, offset + 28, 4, ENC_BIG_ENDIAN);\r\nreturn 32;\r\n}\r\nstatic gint dissect_h264_leader(proto_tree *gvsp_tree, tvbuff_t *tvb, packet_info *pinfo _U_, gint offset)\r\n{\r\nproto_tree_add_bitmask(gvsp_tree, tvb, offset, hf_gvsp_fieldinfo,\r\nett_gvsp_fieldinfo, fieldinfo_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_payloadtype, tvb, offset + 2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_payloaddatasize, tvb, offset + 4, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_packetizationmode, tvb, offset + 13, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_packetsize, tvb, offset + 14, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_profileidc, tvb, offset + 17, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(gvsp_tree, tvb, offset + 18, hf_gvsp_cs, ett_gvsp_cs,\r\ncs_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_levelidc, tvb, offset + 19, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_sropinterleavingdepth, tvb, offset + 20, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_sropmaxdondiff, tvb, offset + 22, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_sropdeintbufreq, tvb, offset + 24, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_sropinitbuftime, tvb, offset + 28, 4, ENC_BIG_ENDIAN);\r\nreturn 32;\r\n}\r\nstatic gint dissect_multizone_image_leader(proto_tree *gvsp_tree, tvbuff_t *tvb, packet_info *pinfo _U_, gint offset)\r\n{\r\nproto_tree_add_bitmask(gvsp_tree, tvb, offset, hf_gvsp_fieldinfo,\r\nett_gvsp_fieldinfo, fieldinfo_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_payloadtype, tvb, offset + 2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_timestamp, tvb, offset + 4, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(gvsp_tree, tvb, offset + 12, hf_gvsp_sc_zone_direction,\r\nett_gvsp_sc_zone_direction, sc_zone_direction_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(gvsp_tree, tvb, offset + 16, hf_gvsp_pixelformat, ett_gvsp_pixelformat,\r\npixelformat_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_sizex, tvb, offset + 20, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_sizey, tvb, offset + 24, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_offsetx, tvb, offset + 28, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_offsety, tvb, offset + 32, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_paddingx, tvb, offset + 36, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_paddingy, tvb, offset + 38, 2, ENC_BIG_ENDIAN);\r\nreturn 40;\r\n}\r\nstatic gint dissect_generic_trailer(proto_tree *gvsp_tree, tvbuff_t *tvb, packet_info *pinfo _U_, gint offset)\r\n{\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_payloadtype, tvb, offset + 2, 2, ENC_BIG_ENDIAN);\r\nreturn 4;\r\n}\r\nstatic gint dissect_extra_chunk_info(proto_tree *gvsp_tree, tvbuff_t *tvb, packet_info *pinfo _U_, gint offset)\r\n{\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_chunkdatapayloadlengthex, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_chunklayoutidex, tvb, offset + 4, 4, ENC_BIG_ENDIAN);\r\nreturn 8;\r\n}\r\nstatic gboolean status_with_payload(gvsp_packet_info *info){\r\nreturn info->status == GEV_STATUS_SUCCESS || ( info->enhanced && info->status == GEV_STATUS_PACKET_RESEND);\r\n}\r\nstatic void dissect_packet_payload(proto_tree *gvsp_tree, tvbuff_t *tvb, packet_info *pinfo _U_, gint offset, gvsp_packet_info *info)\r\n{\r\nif (status_with_payload(info) && tvb_reported_length_remaining(tvb, offset))\r\n{\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_payloaddata, tvb, offset, -1, ENC_NA);\r\n}\r\n}\r\nstatic void dissect_packet_payload_h264(proto_tree *gvsp_tree, tvbuff_t *tvb, packet_info *pinfo _U_, gint offset, gvsp_packet_info *info)\r\n{\r\nif (status_with_payload(info) && tvb_reported_length_remaining(tvb, offset))\r\n{\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_timestamp, tvb, offset, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_payloaddata, tvb, offset + 8, -1, ENC_NA);\r\n}\r\n}\r\nstatic void dissect_packet_payload_multizone(proto_tree *gvsp_tree, tvbuff_t *tvb, packet_info *pinfo _U_, gint offset, gvsp_packet_info *info)\r\n{\r\nif (status_with_payload(info) && tvb_reported_length_remaining(tvb, offset))\r\n{\r\nproto_tree_add_bitmask(gvsp_tree, tvb, offset + 1, hf_gvsp_zoneinfo,\r\nett_gvsp_zoneinfo, zoneinfo_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_addressoffsethigh, tvb, offset + 2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_addressoffsetlow, tvb, offset + 4, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_payloaddata, tvb, offset + 8, -1, ENC_NA);\r\n}\r\n}\r\nstatic void dissect_packet_all_in(proto_tree *gvsp_tree, tvbuff_t *tvb, gint offset, packet_info *pinfo, gvsp_packet_info *info)\r\n{\r\ngint ret;\r\nswitch (info->payloadtype)\r\n{\r\ncase GVSP_PAYLOAD_IMAGE:\r\noffset += dissect_image_leader(gvsp_tree, tvb, pinfo, offset);\r\noffset += dissect_image_trailer(gvsp_tree, tvb, pinfo, offset);\r\nif (info->chunk != 0)\r\n{\r\noffset += dissect_extra_chunk_info(gvsp_tree, tvb, pinfo, offset);\r\n}\r\ndissect_packet_payload(gvsp_tree, tvb, pinfo, offset, info);\r\nbreak;\r\ncase GVSP_PAYLOAD_RAWDATA:\r\noffset += dissect_raw_data_leader(gvsp_tree, tvb, pinfo, offset);\r\noffset += dissect_generic_trailer(gvsp_tree, tvb, pinfo, offset);\r\nif (info->chunk != 0)\r\n{\r\noffset += dissect_extra_chunk_info(gvsp_tree, tvb, pinfo, offset);\r\n}\r\ndissect_packet_payload(gvsp_tree, tvb, pinfo, offset, info);\r\nbreak;\r\ncase GVSP_PAYLOAD_FILE:\r\nret = dissect_file_leader(gvsp_tree, tvb, pinfo, offset);\r\nif (ret < 0)\r\nbreak;\r\noffset += ret;\r\noffset += dissect_generic_trailer(gvsp_tree, tvb, pinfo, offset);\r\nif (info->chunk != 0)\r\n{\r\noffset += dissect_extra_chunk_info(gvsp_tree, tvb, pinfo, offset);\r\n}\r\ndissect_packet_payload(gvsp_tree, tvb, pinfo, offset, info);\r\nbreak;\r\ncase GVSP_PAYLOAD_CHUNKDATA:\r\noffset += dissect_chunk_data_leader(gvsp_tree, tvb, pinfo, offset);\r\noffset += dissect_chunk_data_trailer(gvsp_tree, tvb, pinfo, offset);\r\nif (info->chunk != 0)\r\n{\r\noffset += dissect_extra_chunk_info(gvsp_tree, tvb, pinfo, offset);\r\n}\r\ndissect_packet_payload(gvsp_tree, tvb, pinfo, offset, info);\r\nbreak;\r\ncase GVSP_PAYLOAD_EXTENDEDCHUNKDATA:\r\noffset += dissect_extended_chunk_data_leader(gvsp_tree, tvb, pinfo, offset);\r\noffset += dissect_extended_chunk_data_trailer(gvsp_tree, tvb, pinfo, offset);\r\nif (info->chunk != 0)\r\n{\r\noffset += dissect_extra_chunk_info(gvsp_tree, tvb, pinfo, offset);\r\n}\r\ndissect_packet_payload(gvsp_tree, tvb, pinfo, offset, info);\r\nbreak;\r\ncase GVSP_PAYLOAD_JPEG:\r\ncase GVSP_PAYLOAD_JPEG2000:\r\noffset += dissect_jpeg_leader(gvsp_tree, tvb, pinfo, offset);\r\noffset += dissect_generic_trailer(gvsp_tree, tvb, pinfo, offset);\r\nif (info->chunk != 0)\r\n{\r\noffset += dissect_extra_chunk_info(gvsp_tree, tvb, pinfo, offset);\r\n}\r\ndissect_packet_payload(gvsp_tree, tvb, pinfo, offset, info);\r\nbreak;\r\ncase GVSP_PAYLOAD_H264:\r\noffset += dissect_h264_leader(gvsp_tree, tvb, pinfo, offset);\r\noffset += dissect_generic_trailer(gvsp_tree, tvb, pinfo, offset);\r\nif (info->chunk != 0)\r\n{\r\noffset += dissect_extra_chunk_info(gvsp_tree, tvb, pinfo, offset);\r\n}\r\ndissect_packet_payload_h264(gvsp_tree, tvb, pinfo, offset, info);\r\nbreak;\r\ncase GVSP_PAYLOAD_MULTIZONEIMAGE:\r\noffset += dissect_multizone_image_leader(gvsp_tree, tvb, pinfo, offset);\r\noffset += dissect_image_trailer(gvsp_tree, tvb, pinfo, offset);\r\nif (info->chunk != 0)\r\n{\r\noffset += dissect_extra_chunk_info(gvsp_tree, tvb, pinfo, offset);\r\n}\r\ndissect_packet_payload_multizone(gvsp_tree, tvb, pinfo, offset, info);\r\nbreak;\r\n}\r\n}\r\nstatic void dissect_packet_leader(proto_tree *gvsp_tree, tvbuff_t *tvb, gint offset, packet_info *pinfo, gvsp_packet_info *info)\r\n{\r\nswitch (info->payloadtype)\r\n{\r\ncase GVSP_PAYLOAD_IMAGE:\r\ndissect_image_leader(gvsp_tree, tvb, pinfo, offset);\r\nbreak;\r\ncase GVSP_PAYLOAD_RAWDATA:\r\ndissect_raw_data_leader(gvsp_tree, tvb, pinfo, offset);\r\nbreak;\r\ncase GVSP_PAYLOAD_FILE:\r\ndissect_file_leader(gvsp_tree, tvb, pinfo, offset);\r\nbreak;\r\ncase GVSP_PAYLOAD_CHUNKDATA:\r\ndissect_chunk_data_leader(gvsp_tree, tvb, pinfo, offset);\r\nbreak;\r\ncase GVSP_PAYLOAD_EXTENDEDCHUNKDATA:\r\ndissect_extended_chunk_data_leader(gvsp_tree, tvb, pinfo, offset);\r\nbreak;\r\ncase GVSP_PAYLOAD_JPEG:\r\ncase GVSP_PAYLOAD_JPEG2000:\r\ndissect_jpeg_leader(gvsp_tree, tvb, pinfo, offset);\r\nbreak;\r\ncase GVSP_PAYLOAD_H264:\r\ndissect_h264_leader(gvsp_tree, tvb, pinfo, offset);\r\nbreak;\r\ncase GVSP_PAYLOAD_MULTIZONEIMAGE:\r\ndissect_multizone_image_leader(gvsp_tree, tvb, pinfo, offset);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\nstatic void dissect_packet_trailer(proto_tree *gvsp_tree, tvbuff_t *tvb, gint offset, packet_info *pinfo, gvsp_packet_info *info)\r\n{\r\nswitch (info->payloadtype)\r\n{\r\ncase GVSP_PAYLOAD_IMAGE:\r\ncase GVSP_PAYLOAD_MULTIZONEIMAGE:\r\noffset += dissect_image_trailer(gvsp_tree, tvb, pinfo, offset);\r\nbreak;\r\ncase GVSP_PAYLOAD_CHUNKDATA:\r\noffset += dissect_chunk_data_trailer(gvsp_tree, tvb, pinfo, offset);\r\nbreak;\r\ncase GVSP_PAYLOAD_EXTENDEDCHUNKDATA:\r\noffset += dissect_extended_chunk_data_trailer(gvsp_tree, tvb, pinfo, offset);\r\nbreak;\r\ncase GVSP_PAYLOAD_RAWDATA:\r\ncase GVSP_PAYLOAD_FILE:\r\ncase GVSP_PAYLOAD_JPEG:\r\ncase GVSP_PAYLOAD_JPEG2000:\r\ncase GVSP_PAYLOAD_H264:\r\noffset += dissect_generic_trailer(gvsp_tree, tvb, pinfo, offset);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nif (info->chunk != 0)\r\n{\r\ndissect_extra_chunk_info(gvsp_tree, tvb, pinfo, offset);\r\n}\r\n}\r\nstatic int dissect_gvsp(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data _U_)\r\n{\r\nproto_item *ti = NULL;\r\ngint offset = 0;\r\nproto_tree *gvsp_tree = NULL;\r\ngvsp_packet_info info;\r\nif ((tvb_reported_length(tvb) < GVSP_MIN_PACKET_SIZE) ||\r\n(tvb_captured_length(tvb) < 5))\r\n{\r\nreturn 0;\r\n}\r\nmemset(&info, 0x00, sizeof(info));\r\ninfo.format = tvb_get_guint8(tvb, 4);\r\nif ((info.format & 0x80) && tvb_reported_length(tvb) < GVSP_V2_MIN_PACKET_SIZE)\r\n{\r\nreturn 0;\r\n}\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "GVSP");\r\ncol_clear(pinfo->cinfo, COL_INFO);\r\nti = proto_tree_add_item(tree, proto_gvsp, tvb, offset, -1, ENC_NA);\r\ngvsp_tree = proto_item_add_subtree(ti, ett_gvsp);\r\ninfo.enhanced = info.format & 0x80;\r\ninfo.format &= 0x7F;\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s ", val_to_str(info.format, formatnames, "Unknown Format (0x%x)"));\r\ninfo.status = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_status, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nif (info.enhanced == 0)\r\n{\r\ninfo.blockid = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_blockid16, tvb, offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nguint8 flags;\r\nflags = tvb_get_guint8(tvb, offset + 1);\r\ninfo.flag_resendrangeerror = flags & 0x04;\r\ninfo.flag_previousblockdropped = flags & 0x02;\r\ninfo.flag_packetresend = flags & 0x01;\r\nproto_tree_add_bitmask(gvsp_tree, tvb, offset, hf_gvsp_flags,\r\nett_gvsp_flags, flags_fields, ENC_BIG_ENDIAN);\r\n}\r\noffset += 2;\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_format, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nif (info.enhanced == 0)\r\n{\r\ninfo.packetid = tvb_get_ntohl(tvb, offset - 1);\r\ninfo.packetid &= 0x00FFFFFF;\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_packetid24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\n}\r\noffset += 3;\r\nif (info.enhanced != 0)\r\n{\r\ninfo.blockid = tvb_get_ntoh64(tvb, offset);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_blockid64, tvb, offset, 8, ENC_BIG_ENDIAN);\r\noffset += 8;\r\ninfo.packetid = tvb_get_ntohl(tvb, offset);\r\nproto_tree_add_item(gvsp_tree, hf_gvsp_packetid32, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\n}\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "[Block ID: %" G_GINT64_MODIFIER "u Packet ID: %d] ", (guint64)info.blockid, info.packetid);\r\nif (info.flag_resendrangeerror != 0)\r\n{\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "[RANGE_ERROR] ");\r\n}\r\nif (info.flag_previousblockdropped != 0)\r\n{\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "[BLOCK_DROPPED] ");\r\n}\r\nif (info.flag_packetresend != 0)\r\n{\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "[PACKET_RESEND] ");\r\n}\r\nswitch (info.format)\r\n{\r\ncase GVSP_PACKET_PAYLOAD:\r\ndissect_packet_payload(gvsp_tree, tvb, pinfo, offset, &info);\r\nreturn tvb_captured_length(tvb);\r\ncase GVSP_PACKET_PAYLOAD_H264:\r\ndissect_packet_payload_h264(gvsp_tree, tvb, pinfo, offset, &info);\r\nreturn tvb_captured_length(tvb);\r\ncase GVSP_PACKET_PAYLOAD_MULTIZONE:\r\ndissect_packet_payload_multizone(gvsp_tree, tvb, pinfo, offset, &info);\r\nreturn tvb_captured_length(tvb);\r\ndefault:\r\nbreak;\r\n}\r\nif (tvb_captured_length_remaining(tvb, offset) >= 2)\r\n{\r\ninfo.payloadtype = tvb_get_ntohs(tvb, offset + 2);\r\n}\r\ninfo.chunk = info.payloadtype & 0x4000;\r\ninfo.payloadtype &= 0x3FFF;\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s ", val_to_str_ext(info.payloadtype, &payloadtypenames_ext, "Unknown Payload Type (0x%x)"));\r\nswitch (info.format)\r\n{\r\ncase GVSP_PACKET_ALLIN:\r\ndissect_packet_all_in(gvsp_tree, tvb, offset, pinfo, &info);\r\nbreak;\r\ncase GVSP_PACKET_LEADER:\r\ndissect_packet_leader(gvsp_tree, tvb, offset, pinfo, &info);\r\nbreak;\r\ncase GVSP_PACKET_TRAILER:\r\ndissect_packet_trailer(gvsp_tree, tvb, offset, pinfo, &info);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic gboolean dissect_gvsp_heur(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data)\r\n{\r\nconversation_t *conversation = NULL;\r\nguint16 status_code = 0;\r\nguint8 format = 0;\r\nif ((tvb_reported_length(tvb) < GVSP_MIN_PACKET_SIZE) ||\r\n(tvb_captured_length(tvb) < 5))\r\n{\r\nreturn FALSE;\r\n}\r\nformat = tvb_get_guint8(tvb, 4);\r\nif ((format & 0x80) && tvb_reported_length(tvb) < GVSP_V2_MIN_PACKET_SIZE)\r\n{\r\nreturn FALSE;\r\n}\r\nstatus_code = tvb_get_ntohs(tvb, 0);\r\nif (status_code == 0x0000 ||\r\nstatus_code == 0x0100 ||\r\n(status_code >= 0x8001 && status_code <= 0x8016) ||\r\nstatus_code == 0x8FFF)\r\n{\r\nformat &= 0x7F;\r\nif (format >= 1 && format <= 6)\r\n{\r\nconversation = find_or_create_conversation(pinfo);\r\nconversation_set_dissector(conversation, gvsp_handle);\r\ndissect_gvsp(tvb, pinfo, tree, data);\r\nreturn TRUE;\r\n}\r\n}\r\nreturn FALSE;\r\n}\r\nvoid proto_register_gvsp(void)\r\n{\r\nmodule_t *gvsp_module;\r\nstatic hf_register_info hfgvsp[] =\r\n{\r\n{& hf_gvsp_status,\r\n{ "Status", "gvsp.status",\r\nFT_UINT16, BASE_HEX|BASE_EXT_STRING, &statusnames_ext, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_blockid16,\r\n{ "Block ID (16 bits)", "gvsp.blockid16",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_flags,\r\n{ "Flags", "gvsp.flags",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_flagdevicespecific0,\r\n{ "Flag Device Specific 0", "gvsp.flag.devicespecific0",\r\nFT_UINT16, BASE_HEX, NULL, 0x8000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_flagdevicespecific1,\r\n{ "Flag Device Specific 1", "gvsp.flag.devicespecific1",\r\nFT_UINT16, BASE_HEX, NULL, 0x4000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_flagdevicespecific2,\r\n{ "Flag Device Specific 2", "gvsp.flag.devicespecific2",\r\nFT_UINT16, BASE_HEX, NULL, 0x2000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_flagdevicespecific3,\r\n{ "Flag Device Specific 3", "gvsp.flag.devicespecific3",\r\nFT_UINT16, BASE_HEX, NULL, 0x1000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_flagdevicespecific4,\r\n{ "Flag Device Specific 4", "gvsp.flag.devicespecific4",\r\nFT_UINT16, BASE_HEX, NULL, 0x0800,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_flagdevicespecific5,\r\n{ "Flag Device Specific 5", "gvsp.flag.devicespecific5",\r\nFT_UINT16, BASE_HEX, NULL, 0x0400,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_flagdevicespecific6,\r\n{ "Flag Device Specific 6", "gvsp.flag.devicespecific6",\r\nFT_UINT16, BASE_HEX, NULL, 0x0200,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_flagdevicespecific7,\r\n{ "Flag Device Specific 7", "gvsp.flag.devicespecific7",\r\nFT_UINT16, BASE_HEX, NULL, 0x0100,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_flagresendrangeerror,\r\n{ "Flag Resend Range Error 7", "gvsp.flag.resendrangeerror",\r\nFT_UINT16, BASE_HEX, NULL, 0x0004,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_flagpreviousblockdropped,\r\n{ "Flag Previous Block Dropped", "gvsp.flag.previousblockdropped",\r\nFT_UINT16, BASE_HEX, NULL, 0x0002,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_flagpacketresend,\r\n{ "Flag Packet Resend", "gvsp.flag.packetresend",\r\nFT_UINT16, BASE_HEX, NULL, 0x0001,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_format,\r\n{ "Format", "gvsp.format",\r\nFT_UINT8, BASE_HEX, VALS(formatnames), 0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_packetid24,\r\n{ "Packet ID (24 bits)", "gvsp.packetid24",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_blockid64,\r\n{ "Block ID (64 bits v2.0)", "gvsp.blockid64",\r\nFT_UINT64, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_packetid32,\r\n{ "Packet ID (32 bits v2.0)", "gvsp.packetid32",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_payloadtype,\r\n{ "Payload Type", "gvsp.payloadtype",\r\nFT_UINT16, BASE_HEX|BASE_EXT_STRING, &payloadtypenames_ext, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_payloaddata,\r\n{ "Payload Data", "gvsp.payloaddata",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_timestamp,\r\n{ "Timestamp", "gvsp.timestamp",\r\nFT_UINT64, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_pixelformat,\r\n{ "Pixel Format", "gvsp.pixel",\r\nFT_UINT32, BASE_HEX|BASE_EXT_STRING, &pixeltypenames_ext, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sizex,\r\n{ "Size X", "gvsp.sizex",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sizey,\r\n{ "Size Y", "gvsp.sizey",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_offsetx,\r\n{ "Offset X", "gvsp.offsetx",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_offsety,\r\n{ "Offset Y", "gvsp.offsety",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_paddingx,\r\n{ "Padding X", "gvsp.paddingx",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_paddingy,\r\n{ "Padding Y", "gvsp.paddingy",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_payloaddatasize,\r\n{ "Payload Data Size", "gvsp.payloaddatasize",\r\nFT_UINT64, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_pixelcolor,\r\n{ "Monochrome or Color", "gvsp.pixel.color",\r\nFT_UINT32, BASE_HEX, VALS(colornames), 0xFF000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_pixeloccupy,\r\n{ "Occupy Bits", "gvsp.pixel.occupy",\r\nFT_UINT32, BASE_DEC, NULL, 0x00FF0000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_pixelid,\r\n{ "ID", "gvsp.pixel.id",\r\nFT_UINT32, BASE_HEX, NULL, 0x0000FFFF,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_filename,\r\n{ "ID", "gvsp.filename",\r\nFT_STRINGZ, BASE_NONE, NULL, 0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_payloadlength,\r\n{ "Payload Length", "gvsp.payloadlength",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_fieldinfo,\r\n{ "Field Info", "gvsp.fieldinfo",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_fieldid,\r\n{ "Field ID", "gvsp.fieldid",\r\nFT_UINT8, BASE_HEX, NULL, 0xF0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_fieldcount,\r\n{ "Field Count", "gvsp.fieldcount",\r\nFT_UINT8, BASE_HEX, NULL, 0x0F,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_genericflags,\r\n{ "Generic Flag", "gvsp.genericflag",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_timestamptickfrequency ,\r\n{ "Timestamp Tick Frequency", "gvsp.timestamptickfrequency",\r\nFT_UINT64, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_dataformat,\r\n{ "Data Format", "gvsp.dataformat",\r\nFT_UINT32, BASE_HEX, NULL, 0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_packetizationmode,\r\n{ "packetization_mode", "gvsp.packetizationmode",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_packetsize,\r\n{ "packet_size", "gvsp.packetsize",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_profileidc,\r\n{ "profile_idc", "gvsp.profileidc",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_cs,\r\n{ "cs", "gvsp.cs",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_cs0,\r\n{ "cs0", "gvsp.cs0",\r\nFT_UINT8, BASE_HEX, NULL, 0x80,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_cs1,\r\n{ "cs1", "gvsp.cs1",\r\nFT_UINT8, BASE_HEX, NULL, 0x40,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_cs2,\r\n{ "cs2", "gvsp.cs2",\r\nFT_UINT8, BASE_HEX, NULL, 0x20,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_cs3,\r\n{ "cs3", "gvsp.cs3",\r\nFT_UINT8, BASE_HEX, NULL, 0x10,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_levelidc,\r\n{ "level_idc", "gvsp.levelidc",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sropinterleavingdepth,\r\n{ "srop_interlaving_depth", "gvsp.sropinterleavingdepth",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sropmaxdondiff,\r\n{ "srop_max_don_diff", "gvsp.sropmaxdondiff",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sropdeintbufreq,\r\n{ "srop_deint_buf_req", "gvsp.sropdeintbufreq",\r\nFT_UINT32, BASE_HEX, NULL, 0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sropinitbuftime,\r\n{ "srop_init_buf_time", "gvsp.sropinitbuftime",\r\nFT_UINT32, BASE_HEX, NULL, 0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_zoneinfo,\r\n{ "Zone Info", "gvsp.zoneinfo",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_zoneid,\r\n{ "Zone ID", "gvsp.zoneid",\r\nFT_UINT8, BASE_HEX, NULL, 0x3E,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_endofzone,\r\n{ "End of Zone", "gvsp.endofzone",\r\nFT_UINT8, BASE_HEX, NULL, 0x01,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_addressoffsethigh,\r\n{ "Address Offset High", "gvsp.addressoffsethigh",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_addressoffsetlow,\r\n{ "Address Offset Low", "gvsp.addressoffsetlow",\r\nFT_UINT32, BASE_HEX, NULL, 0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone_direction,\r\n{ "Zone Directions Mask", "gvsp.zonedirection",\r\nFT_UINT32, BASE_HEX, NULL, 0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone0_direction,\r\n{ "Zone 0 Direction", "gvsp.zone0direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x80000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone1_direction,\r\n{ "Zone 1 Direction", "gvsp.zone1direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x40000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone2_direction,\r\n{ "Zone 2 Direction", "gvsp.zone2direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x20000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone3_direction,\r\n{ "Zone 3 Direction", "gvsp.zone3direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x10000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone4_direction,\r\n{ "Zone 4 Direction", "gvsp.zone4direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x08000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone5_direction,\r\n{ "Zone 5 Direction", "gvsp.zone5direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x04000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone6_direction,\r\n{ "Zone 6 Direction", "gvsp.zone6direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x02000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone7_direction,\r\n{ "Zone 7 Direction", "gvsp.zone7direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x01000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone8_direction,\r\n{ "Zone 8 Direction", "gvsp.zone8direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00800000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone9_direction,\r\n{ "Zone 9 Direction", "gvsp.zone9direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00400000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone10_direction,\r\n{ "Zone 10 Direction", "gvsp.zone10direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00200000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone11_direction,\r\n{ "Zone 11 Direction", "gvsp.zone1direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00100000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone12_direction,\r\n{ "Zone 12 Direction", "gvsp.zone12direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00080000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone13_direction,\r\n{ "Zone 13 Direction", "gvsp.zone13direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00040000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone14_direction,\r\n{ "Zone 14 Direction", "gvsp.zone14direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00020000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone15_direction,\r\n{ "Zone 15 Direction", "gvsp.zone15direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00010000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone16_direction,\r\n{ "Zone 16 Direction", "gvsp.zone16direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00008000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone17_direction,\r\n{ "Zone 17 Direction", "gvsp.zone17direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00004000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone18_direction,\r\n{ "Zone 18 Direction", "gvsp.zone18direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00002000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone19_direction,\r\n{ "Zone 19 Direction", "gvsp.zone19direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00001000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone20_direction,\r\n{ "Zone 20 Direction", "gvsp.zone20direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00000800,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone21_direction,\r\n{ "Zone 21 Direction", "gvsp.zone21direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00000400,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone22_direction,\r\n{ "Zone 22 Direction", "gvsp.zone22direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00000200,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone23_direction,\r\n{ "Zone 23 Direction", "gvsp.zone23direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00000100,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone24_direction,\r\n{ "Zone 24 Direction", "gvsp.zone24direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00000080,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone25_direction,\r\n{ "Zone 25 Direction", "gvsp.zone25direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00000040,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone26_direction,\r\n{ "Zone 26 Direction", "gvsp.zone26direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00000020,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone27_direction,\r\n{ "Zone 27 Direction", "gvsp.zone27direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00000010,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone28_direction,\r\n{ "Zone 28 Direction", "gvsp.zone28direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00000008,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone29_direction,\r\n{ "Zone 29 Direction", "gvsp.zone29direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00000004,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone30_direction,\r\n{ "Zone 30 Direction", "gvsp.zone30direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00000002,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_sc_zone31_direction,\r\n{ "Zone 31 Direction", "gvsp.zone31direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00000001,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_chunkdatapayloadlengthex,\r\n{ "Chunk Data Payload Length", "gvsp.chunkdatapayloadlengthex",\r\nFT_UINT32, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvsp_chunklayoutidex,\r\n{ "Chunk Layout ID", "gvsp.chunklayoutidex",\r\nFT_UINT32, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_gvsp,\r\n&ett_gvsp_flags,\r\n&ett_gvsp_header,\r\n&ett_gvsp_payload,\r\n&ett_gvsp_trailer,\r\n&ett_gvsp_pixelformat,\r\n&ett_gvsp_fieldinfo,\r\n&ett_gvsp_cs,\r\n&ett_gvsp_sc_zone_direction,\r\n&ett_gvsp_zoneinfo\r\n};\r\nproto_gvsp = proto_register_protocol("GigE Vision Streaming Protocol", "GVSP", "gvsp");\r\ngvsp_handle = register_dissector("gvsp", dissect_gvsp, proto_gvsp);\r\nproto_register_field_array(proto_gvsp, hfgvsp, array_length(hfgvsp));\r\nproto_register_subtree_array(ett, array_length(ett));\r\ngvsp_module = prefs_register_protocol(proto_gvsp, proto_reg_handoff_gvsp);\r\nprefs_register_obsolete_preference(gvsp_module, "enable_heuristic");\r\n}\r\nvoid proto_reg_handoff_gvsp(void)\r\n{\r\nstatic gboolean initialized = FALSE;\r\nif (!initialized) {\r\ndissector_add_for_decode_as("udp.port", gvsp_handle);\r\nheur_dissector_add("udp", dissect_gvsp_heur, "GigE Vision over UDP", "gvsp_udp", proto_gvsp, HEURISTIC_ENABLE);\r\ninitialized = TRUE;\r\n}\r\n}
