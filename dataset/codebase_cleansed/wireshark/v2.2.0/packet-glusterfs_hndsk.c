static int\r\ngluster_hndsk_setvolume_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_gluster_hndsk_dict,\r\noffset);\r\nreturn offset;\r\n}\r\nstatic int\r\ngluster_hndsk_setvolume_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nreturn gluster_rpc_dissect_dict(tree, tvb, hf_gluster_hndsk_dict, 0);\r\n}\r\nstatic int\r\ngluster_hndsk_2_setvolume_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_gluster_hndsk_dict,\r\noffset);\r\nreturn offset;\r\n}\r\nstatic int\r\ngluster_hndsk_2_setvolume_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nreturn gluster_rpc_dissect_dict(tree, tvb, hf_gluster_hndsk_dict, 0);\r\n}\r\nstatic int\r\ngluster_hndsk_2_getspec_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = dissect_rpc_string(tvb, tree, hf_gluster_hndsk_spec, offset,\r\nNULL);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_gluster_hndsk_dict,\r\noffset);\r\nreturn offset;\r\n}\r\nstatic int\r\ngluster_hndsk_2_getspec_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\nproto_tree_add_item(tree, hf_gluster_hndsk_flags, tvb, offset,\r\n4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\noffset = dissect_rpc_string(tvb, tree, hf_gluster_hndsk_key, offset,\r\nNULL);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_gluster_hndsk_dict,\r\noffset);\r\nreturn offset;\r\n}\r\nstatic int\r\ngluster_hndsk_2_set_lk_ver_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = dissect_rpc_uint32(tvb, tree,hf_gluster_hndsk_lk_ver, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ngluster_hndsk_2_set_lk_ver_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_string(tvb, tree, hf_gluster_hndsk_uid, offset,\r\nNULL);\r\noffset = dissect_rpc_uint32(tvb, tree,hf_gluster_hndsk_lk_ver, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ngluster_hndsk_2_event_notify_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_uint32(tvb, tree, hf_gluster_hndsk_event_op,\r\noffset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_gluster_hndsk_dict,\r\noffset);\r\nreturn offset;\r\n}\r\nstatic int\r\ngluster_hndsk_2_event_notify_reply(tvbuff_t *tvb,\r\npacket_info *pinfo, proto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_gluster_hndsk_dict,\r\noffset);\r\nreturn offset;\r\n}\r\nstatic int\r\ngluster_cbk_cache_invalidation_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_string(tvb, tree, hf_gluster_cbk_gfid, offset, NULL);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_gluster_cbk_upcall_event_type, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_gluster_cbk_ci_flags, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_gluster_cbk_ci_expire_time_attr, offset);\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb,\r\nhf_gluster_cbk_ci_stat, offset);\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb,\r\nhf_gluster_cbk_ci_parent_stat, offset);\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb,\r\nhf_gluster_cbk_ci_oldparent_stat, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_gluster_cbk_xdata, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ngluster_hndsk_dissect_common_reply(tvbuff_t *tvb,\r\npacket_info *pinfo, proto_tree *tree, void* data)\r\n{\r\nreturn gluster_dissect_common_reply(tvb, 0, pinfo, tree, data);\r\n}\r\nvoid\r\nproto_register_gluster_hndsk(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_gluster_hndsk_proc,\r\n{ "GlusterFS Handshake", "glusterfs.hndsk.proc",\r\nFT_UINT32, BASE_DEC,\r\nVALS(gluster_hndsk_proc_vals), 0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_hndsk_dict,\r\n{ "Dict", "glusterfs.hndsk.dict", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_hndsk_event_op,\r\n{ "Event Op", "glusterfs.hndsk.event_notify_op",\r\nFT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_hndsk_key,\r\n{ "Key", "glusterfs.hndsk.getspec.key", FT_STRING,\r\nBASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_hndsk_spec,\r\n{ "Spec", "glusterfs.hndsk.getspec", FT_STRING,\r\nBASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_hndsk_uid,\r\n{ "Name", "glusterfs.hndsk.uid", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_hndsk_lk_ver,\r\n{ "Event Op", "glusterfs.hndsk.lk_ver", FT_UINT32,\r\nBASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_hndsk_flags,\r\n{ "Flags", "glusterfs.hndsk.flags", FT_UINT32, BASE_OCT,\r\nNULL, 0, NULL, HFILL }\r\n}\r\n};\r\nstatic gint *ett[] = {\r\n&ett_gluster_hndsk\r\n};\r\nproto_gluster_hndsk = proto_register_protocol("GlusterFS Handshake",\r\n"GlusterFS Handshake",\r\n"glusterfs.hndsk");\r\nproto_register_subtree_array(ett, array_length(ett));\r\nproto_register_field_array(proto_gluster_hndsk, hf, array_length(hf));\r\n}\r\nvoid\r\nproto_reg_handoff_gluster_hndsk(void)\r\n{\r\nrpc_init_prog(proto_gluster_hndsk, GLUSTER_HNDSK_PROGRAM,\r\nett_gluster_hndsk,\r\nG_N_ELEMENTS(gluster_hndsk_vers_info), gluster_hndsk_vers_info);\r\n}\r\nvoid\r\nproto_register_gluster_cbk(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_gluster_cbk_proc,\r\n{ "GlusterFS Callback", "glusterfs.cbk.proc",\r\nFT_UINT32, BASE_DEC,\r\nVALS(gluster_cbk_proc_vals), 0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_cbk_gfid,\r\n{ "GFID", "glusterfs.cbk.gfid", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_cbk_upcall_event_type,\r\n{ "Event Type", "glusterfs.cbk.upcall.event_type", FT_UINT32, BASE_DEC | BASE_EXT_STRING,\r\n&gluster_cbk_upcall_event_type_ext, 0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_cbk_ci_flags,\r\n{ "Flags", "glusterfs.cbk.cache_invalidation.flags", FT_UINT32, BASE_DEC_HEX,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_cbk_ci_expire_time_attr,\r\n{ "Expire Time Attr", "glusterfs.cbk.cache_invalidation.expire_time_attr",\r\nFT_UINT32, BASE_OCT, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_cbk_ci_stat,\r\n{ "Stat", "glusterfs.cbk.cache_invalidation.stat", FT_NONE, BASE_NONE, NULL,\r\n0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_cbk_ci_parent_stat,\r\n{ "Parent Stat", "glusterfs.cbk.cache_invalidation.parent.stat", FT_NONE, BASE_NONE, NULL,\r\n0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_cbk_ci_oldparent_stat,\r\n{ "Old Parent Stat", "glusterfs.cbk.cache_invalidation.oldparent.stat",\r\nFT_NONE, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_cbk_xdata,\r\n{ "Xdata", "glusterfs.cbk.xdata", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_gluster_cbk\r\n};\r\nproto_gluster_cbk = proto_register_protocol("GlusterFS Callback",\r\n"GlusterFS Callback", "glusterfs.cbk");\r\nproto_register_subtree_array(ett, array_length(ett));\r\nproto_register_field_array(proto_gluster_cbk, hf, array_length(hf));\r\n}\r\nvoid\r\nproto_reg_handoff_gluster_cbk(void)\r\n{\r\nrpc_init_prog(proto_gluster_cbk, GLUSTER_CBK_PROGRAM, ett_gluster_cbk,\r\nG_N_ELEMENTS(gluster_cbk_vers_info), gluster_cbk_vers_info);\r\n}
