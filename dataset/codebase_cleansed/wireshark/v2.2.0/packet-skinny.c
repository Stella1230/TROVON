static guint\r\nget_skinny_pdu_len(packet_info *pinfo _U_, tvbuff_t *tvb, int offset, void *data _U_)\r\n{\r\nguint32 hdr_data_length;\r\nhdr_data_length = tvb_get_letohl(tvb, offset);\r\nreturn hdr_data_length + 8;\r\n}\r\nstatic void\r\ndissect_skinny_xml(ptvcursor_t *cursor, int hfindex, packet_info *pinfo, guint32 length, guint32 maxlength)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *subtree = NULL;\r\ndissector_handle_t handle = NULL;\r\nproto_tree *tree = ptvcursor_tree(cursor);\r\nguint32 offset = ptvcursor_current_offset(cursor);\r\ntvbuff_t *tvb = ptvcursor_tvbuff(cursor);\r\ntvbuff_t *next_tvb;\r\nif (length == 0) {\r\nlength = tvb_strnlen(tvb, offset, -1);\r\n}\r\nif (length >= maxlength) {\r\nlength = maxlength;\r\n}\r\nptvcursor_add_no_advance(cursor, hfindex, length, ENC_ASCII|ENC_NA);\r\nitem = proto_tree_add_item(tree, hf_skinny_xmlData, tvb, offset, length, ENC_ASCII|ENC_NA);\r\nsubtree = proto_item_add_subtree(item, 0);\r\nnext_tvb = tvb_new_subset(tvb, offset, length, -1);\r\nhandle = dissector_get_string_handle(media_type_dissector_table, "text/xml");\r\nif (handle != NULL) {\r\ncall_dissector(handle, next_tvb, pinfo, subtree);\r\n}\r\nptvcursor_advance(cursor, maxlength);\r\n}\r\nstatic void\r\ndissect_skinny_ipv4or6(ptvcursor_t *cursor, int hfindex_ipv4, int hfindex_ipv6, packet_info *pinfo)\r\n{\r\naddress src_addr;\r\nguint32 ipversion = 0;\r\nguint32 offset = ptvcursor_current_offset(cursor);\r\ntvbuff_t *tvb = ptvcursor_tvbuff(cursor);\r\nguint32 hdr_version = tvb_get_letohl(tvb, 4);\r\ngboolean is_video = FALSE;\r\nif (hdr_version >= V17_MSG_TYPE) {\r\nipversion = tvb_get_letohl(tvb, offset);\r\nptvcursor_add(cursor, hf_skinny_ipv4or6, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nif (ipversion == IPADDRTYPE_IPV4) {\r\nguint32 ip_address;\r\nsrc_addr.type = AT_IPv4;\r\nsrc_addr.len = 4;\r\nsrc_addr.data = (guint8 *)&ip_address;\r\nip_address = tvb_get_ipv4(tvb, offset);\r\nrtp_add_address(pinfo, &src_addr, tvb_get_letohl(tvb, offset), 0, "Skinny", pinfo->num, is_video, NULL);\r\nptvcursor_add(cursor, hfindex_ipv4, 4, ENC_BIG_ENDIAN);\r\nif (hdr_version >= V17_MSG_TYPE) {\r\nptvcursor_advance(cursor, 12);\r\n}\r\n} else if (ipversion == IPADDRTYPE_IPV6 || ipversion == IPADDRTYPE_IPV4_V6) {\r\nstruct e_in6_addr IPv6;\r\nsrc_addr.type = AT_IPv6;\r\nsrc_addr.len = 16;\r\nsrc_addr.data = (guint8 *)&IPv6;\r\ntvb_get_ipv6(tvb, offset, &IPv6);\r\nrtp_add_address(pinfo, &src_addr, tvb_get_letohl(tvb, offset), 0, "Skinny", pinfo->num, is_video, NULL);\r\nptvcursor_add(cursor, hfindex_ipv6, 16, ENC_NA);\r\n} else {\r\nptvcursor_advance(cursor, 16);\r\n}\r\n}\r\nstatic void\r\ndissect_skinny_displayLabel(ptvcursor_t *cursor, int hfindex, gint length)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = ptvcursor_tree(cursor);\r\nguint32 offset = ptvcursor_current_offset(cursor);\r\ntvbuff_t *tvb = ptvcursor_tvbuff(cursor);\r\nwmem_strbuf_t *wmem_new = NULL;\r\ngchar *disp_string = NULL;\r\nconst gchar *replacestr = NULL;\r\ngboolean show_replaced_str = FALSE;\r\ngint x = 0;\r\nif (length == 0) {\r\nlength = tvb_strnlen(tvb, offset, -1);\r\nif (length == -1) {\r\nlength = tvb_captured_length_remaining(tvb, offset);\r\n}\r\n}\r\nitem = proto_tree_add_item(tree, hfindex, tvb, offset, length, ENC_ASCII | ENC_NA);\r\nwmem_new = wmem_strbuf_sized_new(wmem_packet_scope(), length + 1, 0);\r\ndisp_string = (gchar*) wmem_alloc(wmem_packet_scope(), length + 1);\r\ndisp_string[length] = '\0';\r\ntvb_memcpy(tvb, (void*)disp_string, offset, length);\r\nfor (x = 0; x < length && disp_string[x] != '\0'; x++) {\r\nreplacestr = NULL;\r\nif (x + 1 < length) {\r\nif (disp_string[x] == '\36') {\r\nreplacestr = try_val_to_str_ext(disp_string[x + 1], &DisplayLabels_36_ext);\r\n} else if (disp_string[x] == '\200') {\r\nreplacestr = try_val_to_str_ext(disp_string[x + 1], &DisplayLabels_200_ext);\r\n}\r\n}\r\nif (replacestr) {\r\nx++;\r\nwmem_strbuf_append(wmem_new, replacestr);\r\nshow_replaced_str = TRUE;\r\n} else {\r\nwmem_strbuf_append_c(wmem_new, disp_string[x]);\r\n}\r\n}\r\nif (show_replaced_str) {\r\nproto_item_append_text(item, " => \"%s\"" , wmem_strbuf_get_str(wmem_new));\r\n}\r\nptvcursor_advance(cursor, length);\r\n}\r\nstatic void\r\nhandle_RegisterMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 hdr_data_length = tvb_get_letohl(ptvcursor_tvbuff(cursor), 0);\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "sid");\r\nptvcursor_add(cursor, hf_skinny_DeviceName, 16, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_reserved_for_future_use, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_instance, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_add(cursor, hf_skinny_stationIpAddr, 4, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_deviceType, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxStreams, 4, ENC_LITTLE_ENDIAN);\r\nif (hdr_data_length > 52) {\r\nptvcursor_add(cursor, hf_skinny_activeStreams, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_protocolVer, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_unknown, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "PhoneFeatures");\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_Bit1, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_Bit2, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_Bit3, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_Bit4, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_UTF8, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_Bit6, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_Bit7, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_DynamicMessages, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_Bit9, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_RFC2833, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_Bit11, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_Bit12, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_Bit13, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_Bit14, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_Bit15, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_Abbreviated_Dial, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_advance(cursor, 2);\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_add(cursor, hf_skinny_maxConferences, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nif (hdr_data_length > 100) {\r\nptvcursor_add(cursor, hf_skinny_activeConferences, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_macAddress, 6, ENC_NA);\r\nptvcursor_advance(cursor, 12 - 6);\r\nptvcursor_add(cursor, hf_skinny_ipV4AddressScope, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxNumberOfLines, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_stationIpV6Addr, 16, ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_ipV6AddressScope, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_firmwareLoadName, 32, ENC_ASCII|ENC_NA);\r\n}\r\nif (hdr_data_length > 191) {\r\nptvcursor_add(cursor, hf_skinny_configVersionStamp, 48, ENC_ASCII|ENC_NA);\r\n}\r\n}\r\nstatic void\r\nhandle_IpPortMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_rtpMediaPort, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_KeypadButtonMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 hdr_data_length = tvb_get_letohl(ptvcursor_tvbuff(cursor), 0);\r\nptvcursor_add(cursor, hf_skinny_kpButton, 4, ENC_LITTLE_ENDIAN);\r\nif (hdr_data_length > 8) {\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\nhandle_EnblocCallMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 hdr_data_length = tvb_get_letohl(ptvcursor_tvbuff(cursor), 0);\r\nguint32 hdr_version = tvb_get_letohl(ptvcursor_tvbuff(cursor), 4);\r\nguint32 VariableDirnumSize = (hdr_version >= V18_MSG_TYPE) ? 25 : 24;\r\nsi->calledParty = g_strdup(tvb_format_stringzpad(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), VariableDirnumSize));\r\nptvcursor_add(cursor, hf_skinny_calledParty, VariableDirnumSize, ENC_ASCII|ENC_NA);\r\nif (hdr_data_length > 28) {\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\nhandle_StimulusMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_stimulus, 4, ENC_LITTLE_ENDIAN);\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_stimulusStatus, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_OffHookMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 hdr_data_length = tvb_get_letohl(ptvcursor_tvbuff(cursor), 0);\r\nif (hdr_data_length > 4) {\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\nhandle_OnHookMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 hdr_data_length = tvb_get_letohl(ptvcursor_tvbuff(cursor), 0);\r\nif (hdr_data_length > 4) {\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\nhandle_HookFlashMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_ForwardStatReqMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_lineNumber, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_SpeedDialStatReqMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_speedDialNumber, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_LineStatReqMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_lineNumber, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_CapabilitiesRes(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 capCount = 0;\r\nguint32 payloadCapability = 0;\r\ncapCount = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_capCount, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nguint32 counter_1 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "caps [ref: capCount = %d, max:18]", capCount);\r\nfor (counter_1 = 0; counter_1 < 18; counter_1++) {\r\nif (counter_1 < capCount) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "caps [%d / %d]", counter_1 + 1, capCount);\r\npayloadCapability = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_payloadCapability, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxFramesPerPacket, 4, ENC_LITTLE_ENDIAN);\r\nif (payloadCapability == MEDIA_PAYLOAD_G7231) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadCapability is Media_Payload_G7231");\r\nptvcursor_add(cursor, hf_skinny_g723BitRate, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 4);\r\n} else if (payloadCapability == MEDIA_PAYLOAD_V150_LC_MODEMRELAY) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadCapability is Media_Payload_v150_LC_ModemRelay");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "modemRelay");\r\nptvcursor_add(cursor, hf_skinny_capAndVer, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_modAnd2833, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n} else if (payloadCapability == MEDIA_PAYLOAD_V150_LC_SPRT) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadCapability is Media_Payload_v150_LC_SPRT");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "sprtPayload");\r\nptvcursor_add(cursor, hf_skinny_chan0MaxPayload, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_chan2MaxPayload, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_chan3MaxPayload, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_chan2MaxWindow, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n} else if (payloadCapability == MEDIA_PAYLOAD_V150_LC_SSE) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadCapability is Media_Payload_v150_LC_SSE");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "sse");\r\nptvcursor_add(cursor, hf_skinny_standard, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_vendor, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n} else {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "any payloadCapability");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "codecParams");\r\nptvcursor_add(cursor, hf_skinny_codecMode, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_dynamicPayload, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_codecParam1, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_codecParam2, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 4);\r\n}\r\n} else {\r\nptvcursor_advance(cursor, 16);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nstatic void\r\nhandle_AlarmMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_alarmSeverity, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_text, 80, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_parm1, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_parm2, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_MulticastMediaReceptionAckMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_receptionStatus, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruPartyID, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_OpenReceiveChannelAckMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 hdr_data_length = tvb_get_letohl(ptvcursor_tvbuff(cursor), 0);\r\nsi->openreceiveStatus = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_openReceiveChannelStatus, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_ipv4or6(cursor, hf_skinny_ipAddr_ipv4, hf_skinny_ipAddr_ipv6, pinfo);\r\nptvcursor_add(cursor, hf_skinny_portNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruPartyID, 4, ENC_LITTLE_ENDIAN);\r\nif (hdr_data_length > 20) {\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\nhandle_ConnectionStatisticsResMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 hdr_data_length = tvb_get_letohl(ptvcursor_tvbuff(cursor), 0);\r\nguint32 hdr_version = tvb_get_letohl(ptvcursor_tvbuff(cursor), 4);\r\nguint32 VariableDirnumSize = (hdr_version >= V18_MSG_TYPE) ? 25 : 24;\r\nguint32 dataSize = 0;\r\nptvcursor_add(cursor, hf_skinny_directoryNum, VariableDirnumSize, ENC_ASCII|ENC_NA);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_statsProcessingMode, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_numberPacketsSent, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_numberOctetsSent, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_numberPacketsReceived, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_numberOctetsReceived, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_numberPacketsLost, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_jitter, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_latency, 4, ENC_LITTLE_ENDIAN);\r\nif (hdr_data_length > 64) {\r\ndataSize = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_dataSize, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_data, dataSize, ENC_ASCII|ENC_NA);\r\n}\r\n}\r\nstatic void\r\nhandle_OffHookWithCgpnMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 hdr_version = tvb_get_letohl(ptvcursor_tvbuff(cursor), 4);\r\nguint32 VariableDirnumSize = (hdr_version >= V18_MSG_TYPE) ? 25 : 24;\r\nptvcursor_add(cursor, hf_skinny_callingPartyNumber, VariableDirnumSize, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_cgpnVoiceMailbox, VariableDirnumSize, ENC_ASCII|ENC_NA);\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_SoftKeyEventMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_softKeyEvent, 4, ENC_LITTLE_ENDIAN);\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_UnregisterMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 hdr_data_length = tvb_get_letohl(ptvcursor_tvbuff(cursor), 0);\r\nif (hdr_data_length > 12) {\r\nptvcursor_add(cursor, hf_skinny_unRegReasonCode, 4, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\nhandle_RegisterTokenReq(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "sid");\r\nptvcursor_add(cursor, hf_skinny_DeviceName, 16, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_reserved_for_future_use, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_instance, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_add(cursor, hf_skinny_stationIpAddr, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_deviceType, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_ipv4or6(cursor, hf_skinny_stationIpV6Addr_ipv4, hf_skinny_stationIpV6Addr_ipv6, pinfo);\r\n}\r\nstatic void\r\nhandle_MediaTransmissionFailureMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruPartyID, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_ipv4or6(cursor, hf_skinny_remoteIpAddr_ipv4, hf_skinny_remoteIpAddr_ipv6, pinfo);\r\nptvcursor_add(cursor, hf_skinny_remotePortNumber, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_HeadsetStatusMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_headsetStatus, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_MediaResourceNotificationMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_deviceType, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_numberOfInServiceStreams, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxStreamsPerConf, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_numberOfOutOfServiceStreams, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_RegisterAvailableLinesMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_maxNumOfAvailLines, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_DeviceToUserDataMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 dataLength = 0;\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "deviceToUserData");\r\nptvcursor_add(cursor, hf_skinny_applicationID, 4, ENC_LITTLE_ENDIAN);\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_transactionID, 4, ENC_LITTLE_ENDIAN);\r\ndataLength = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_dataLength, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_xml(cursor, hf_skinny_xmldata, pinfo, dataLength, 2000);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nstatic void\r\nhandle_DeviceToUserDataResponseMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 dataLength = 0;\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "deviceToUserData");\r\nptvcursor_add(cursor, hf_skinny_applicationID, 4, ENC_LITTLE_ENDIAN);\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_transactionID, 4, ENC_LITTLE_ENDIAN);\r\ndataLength = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_dataLength, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_xml(cursor, hf_skinny_xmldata, pinfo, dataLength, 2000);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nstatic void\r\nhandle_UpdateCapabilitiesMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 audioCapCount = 0;\r\nguint32 videoCapCount = 0;\r\nguint32 dataCapCount = 0;\r\nguint32 customPictureFormatCount = 0;\r\nguint32 serviceResourceCount = 0;\r\nguint32 layoutCount = 0;\r\nguint32 payloadCapability = 0;\r\nguint32 levelPreferenceCount = 0;\r\naudioCapCount = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_audioCapCount, 4, ENC_LITTLE_ENDIAN);\r\nvideoCapCount = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_videoCapCount, 4, ENC_LITTLE_ENDIAN);\r\ndataCapCount = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_dataCapCount, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_RTPPayloadFormat, 4, ENC_LITTLE_ENDIAN);\r\ncustomPictureFormatCount = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_customPictureFormatCount, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nguint32 counter_1 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "customPictureFormat [ref: customPictureFormatCount = %d, max:6]", customPictureFormatCount);\r\nfor (counter_1 = 0; counter_1 < 6; counter_1++) {\r\nif (counter_1 < customPictureFormatCount) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "customPictureFormat [%d / %d]", counter_1 + 1, customPictureFormatCount);\r\nptvcursor_add(cursor, hf_skinny_pictureWidth, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_pictureHeight, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_pixelAspectRatio, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_clockConversionCode, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_clockDivisor, 4, ENC_LITTLE_ENDIAN);\r\n} else {\r\nptvcursor_advance(cursor, 20);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "confResources");\r\nptvcursor_add(cursor, hf_skinny_activeStreamsOnRegistration, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxBW, 4, ENC_LITTLE_ENDIAN);\r\nserviceResourceCount = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_serviceResourceCount, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nguint32 counter_2 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "serviceResource [ref: serviceResourceCount = %d, max:4]", serviceResourceCount);\r\nfor (counter_2 = 0; counter_2 < 4; counter_2++) {\r\nif (counter_2 < serviceResourceCount) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "serviceResource [%d / %d]", counter_2 + 1, serviceResourceCount);\r\nlayoutCount = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_layoutCount, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nguint32 counter_5 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "layouts [ref: layoutCount = %d, max:5]", layoutCount);\r\nfor (counter_5 = 0; counter_5 < 5; counter_5++) {\r\nif (counter_5 < layoutCount) {\r\nptvcursor_add(cursor, hf_skinny_layouts, 4, ENC_LITTLE_ENDIAN);\r\n} else {\r\nptvcursor_advance(cursor, 4);\r\n}\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_add(cursor, hf_skinny_serviceNum, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxStreams, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxConferences, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_activeConferenceOnRegistration, 4, ENC_LITTLE_ENDIAN);\r\n} else {\r\nptvcursor_advance(cursor, 24);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n{\r\nguint32 counter_1 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "audiocaps [ref: audioCapCount = %d, max:18]", audioCapCount);\r\nfor (counter_1 = 0; counter_1 < 18; counter_1++) {\r\nif (counter_1 < audioCapCount) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "audiocaps [%d / %d]", counter_1 + 1, audioCapCount);\r\npayloadCapability = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_payloadCapability, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxFramesPerPacket, 4, ENC_LITTLE_ENDIAN);\r\nif (payloadCapability == MEDIA_PAYLOAD_G7231) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadCapability is Media_Payload_G7231");\r\nptvcursor_add(cursor, hf_skinny_g723BitRate, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 4);\r\n} else if (payloadCapability == MEDIA_PAYLOAD_V150_LC_MODEMRELAY) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadCapability is Media_Payload_v150_LC_ModemRelay");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "modemRelay");\r\nptvcursor_add(cursor, hf_skinny_capAndVer, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_modAnd2833, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n} else if (payloadCapability == MEDIA_PAYLOAD_V150_LC_SPRT) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadCapability is Media_Payload_v150_LC_SPRT");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "sprtPayload");\r\nptvcursor_add(cursor, hf_skinny_chan0MaxPayload, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_chan2MaxPayload, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_chan3MaxPayload, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_chan2MaxWindow, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n} else if (payloadCapability == MEDIA_PAYLOAD_V150_LC_SSE) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadCapability is Media_Payload_v150_LC_SSE");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "sse");\r\nptvcursor_add(cursor, hf_skinny_standard, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_vendor, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n} else {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "any payloadCapability");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "codecParams");\r\nptvcursor_add(cursor, hf_skinny_codecMode, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_dynamicPayload, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_codecParam1, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_codecParam2, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 4);\r\n}\r\n} else {\r\nptvcursor_advance(cursor, 16);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n{\r\nguint32 counter_1 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "vidCaps [ref: videoCapCount = %d, max:10]", videoCapCount);\r\nfor (counter_1 = 0; counter_1 < 10; counter_1++) {\r\nif (counter_1 < videoCapCount) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "vidCaps [%d / %d]", counter_1 + 1, videoCapCount);\r\npayloadCapability = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_payloadCapability, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_videoCapabilityDirection, 4, ENC_LITTLE_ENDIAN);\r\nlevelPreferenceCount = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_levelPreferenceCount, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nguint32 counter_4 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "levelPreference [ref: levelPreferenceCount = %d, max:4]", levelPreferenceCount);\r\nfor (counter_4 = 0; counter_4 < 4; counter_4++) {\r\nif (counter_4 < levelPreferenceCount) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "levelPreference [%d / %d]", counter_4 + 1, levelPreferenceCount);\r\nptvcursor_add(cursor, hf_skinny_transmitPreference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_format, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxBitRate, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_minBitRate, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_MPI, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_serviceNumber, 4, ENC_LITTLE_ENDIAN);\r\n} else {\r\nptvcursor_advance(cursor, 24);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nif (payloadCapability == MEDIA_PAYLOAD_H261) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadCapability is Media_Payload_H261");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "h261VideoCapability");\r\nptvcursor_add(cursor, hf_skinny_temporalSpatialTradeOffCapability, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_stillImageTransmission, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n} else if (payloadCapability == MEDIA_PAYLOAD_H263) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadCapability is Media_Payload_H263");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "h263VideoCapability");\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "h263_capability_bitfield");\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit1, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit2, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit3, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit4, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit5, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit6, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit7, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit8, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit9, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit10, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit11, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit12, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit13, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit14, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit15, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit16, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit17, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit18, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit19, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit20, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit21, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit22, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit23, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit24, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit25, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit26, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit27, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit28, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit29, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit30, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit31, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit32, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_advance(cursor, 4);\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_add(cursor, hf_skinny_annexNandWFutureUse, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n} else if (payloadCapability == MEDIA_PAYLOAD_VIEO) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadCapability is Media_Payload_Vieo");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "vieoVideoCapability");\r\nptvcursor_add(cursor, hf_skinny_modelNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_bandwidth, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n} else {\r\nptvcursor_advance(cursor, 44);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n{\r\nguint32 counter_1 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "dataCaps [ref: dataCapCount = %d, max:5]", dataCapCount);\r\nfor (counter_1 = 0; counter_1 < 5; counter_1++) {\r\nif (counter_1 < dataCapCount) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "dataCaps [%d / %d]", counter_1 + 1, dataCapCount);\r\nptvcursor_add(cursor, hf_skinny_payloadCapability, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_dataCapabilityDirection, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_protocolDependentData, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxBitRate, 4, ENC_LITTLE_ENDIAN);\r\n} else {\r\nptvcursor_advance(cursor, 16);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nstatic void\r\nhandle_OpenMultiMediaReceiveChannelAckMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_multimediaOpenReceiveChannelStatus, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_ipv4or6(cursor, hf_skinny_ipAddr_ipv4, hf_skinny_ipAddr_ipv6, pinfo);\r\nptvcursor_add(cursor, hf_skinny_portNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruPartyID, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_ClearConferenceMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_serviceNum, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_ServiceURLStatReqMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_serviceURLIndex, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_FeatureStatReqMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 hdr_data_length = tvb_get_letohl(ptvcursor_tvbuff(cursor), 0);\r\nptvcursor_add(cursor, hf_skinny_featureIndex, 4, ENC_LITTLE_ENDIAN);\r\nif (hdr_data_length > 16) {\r\nptvcursor_add(cursor, hf_skinny_featureCapabilities, 4, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\nhandle_CreateConferenceResMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 dataLength = 0;\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_result, 4, ENC_LITTLE_ENDIAN);\r\ndataLength = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_dataLength, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruData, dataLength, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void\r\nhandle_DeleteConferenceResMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_delete_conf_result, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_ModifyConferenceResMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 dataLength = 0;\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_modify_conf_result, 4, ENC_LITTLE_ENDIAN);\r\ndataLength = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_dataLength, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruData, dataLength, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void\r\nhandle_AddParticipantResMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_add_participant_result, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_bridgeParticipantId, 257, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void\r\nhandle_AuditConferenceResMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 numberOfEntries = 0;\r\nptvcursor_add(cursor, hf_skinny_last, 4, ENC_LITTLE_ENDIAN);\r\nnumberOfEntries = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_numberOfEntries, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nguint32 counter_1 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "conferenceEntry [ref: numberOfEntries = %d, max:32]", numberOfEntries);\r\nfor (counter_1 = 0; counter_1 < 32; counter_1++) {\r\nif (counter_1 < numberOfEntries) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "conferenceEntry [%d / %d]", counter_1 + 1, numberOfEntries);\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_resourceType, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_numberOfReservedParticipants, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_numberOfActiveParticipants, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_appID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_appConfID, 32, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_appData, 24, ENC_ASCII|ENC_NA);\r\n} else {\r\nptvcursor_advance(cursor, 76);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nstatic void\r\nhandle_AuditParticipantResMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 numberOfEntries = 0;\r\nptvcursor_add(cursor, hf_skinny_audit_participant_result, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_last, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nnumberOfEntries = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_numberOfEntries, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nguint32 counter_1 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "participantEntry [ref: numberOfEntries = %d, max:256]", numberOfEntries);\r\nfor (counter_1 = 0; counter_1 < 256; counter_1++) {\r\nif (counter_1 < numberOfEntries) {\r\nptvcursor_add(cursor, hf_skinny_participantEntry, 4, ENC_LITTLE_ENDIAN);\r\n} else {\r\nptvcursor_advance(cursor, 4);\r\n}\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nstatic void\r\nhandle_DeviceToUserDataMessageVersion1(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 dataLength = 0;\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "deviceToUserDataVersion1");\r\nptvcursor_add(cursor, hf_skinny_applicationID, 4, ENC_LITTLE_ENDIAN);\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_transactionID, 4, ENC_LITTLE_ENDIAN);\r\ndataLength = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_dataLength, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_sequenceFlag, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_displayPriority, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_appInstanceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_routingID, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_xml(cursor, hf_skinny_xmldata, pinfo, dataLength, 2000);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nstatic void\r\nhandle_DeviceToUserDataResponseMessageVersion1(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 dataLength = 0;\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "deviceToUserDataVersion1");\r\nptvcursor_add(cursor, hf_skinny_applicationID, 4, ENC_LITTLE_ENDIAN);\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_transactionID, 4, ENC_LITTLE_ENDIAN);\r\ndataLength = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_dataLength, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_sequenceFlag, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_displayPriority, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_appInstanceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_routingID, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_xml(cursor, hf_skinny_xmldata, pinfo, dataLength, 2000);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nstatic void\r\nhandle_UpdateCapabilitiesV2Message(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 audioCapCount = 0;\r\nguint32 videoCapCount = 0;\r\nguint32 dataCapCount = 0;\r\nguint32 customPictureFormatCount = 0;\r\nguint32 serviceResourceCount = 0;\r\nguint32 layoutCount = 0;\r\nguint32 payloadCapability = 0;\r\nguint32 levelPreferenceCount = 0;\r\naudioCapCount = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_audioCapCount, 4, ENC_LITTLE_ENDIAN);\r\nvideoCapCount = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_videoCapCount, 4, ENC_LITTLE_ENDIAN);\r\ndataCapCount = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_dataCapCount, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_RTPPayloadFormat, 4, ENC_LITTLE_ENDIAN);\r\ncustomPictureFormatCount = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_customPictureFormatCount, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nguint32 counter_1 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "customPictureFormat [ref: customPictureFormatCount = %d, max:6]", customPictureFormatCount);\r\nfor (counter_1 = 0; counter_1 < 6; counter_1++) {\r\nif (counter_1 < customPictureFormatCount) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "customPictureFormat [%d / %d]", counter_1 + 1, customPictureFormatCount);\r\nptvcursor_add(cursor, hf_skinny_pictureWidth, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_pictureHeight, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_pixelAspectRatio, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_clockConversionCode, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_clockDivisor, 4, ENC_LITTLE_ENDIAN);\r\n} else {\r\nptvcursor_advance(cursor, 20);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "confResources");\r\nptvcursor_add(cursor, hf_skinny_activeStreamsOnRegistration, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxBW, 4, ENC_LITTLE_ENDIAN);\r\nserviceResourceCount = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_serviceResourceCount, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nguint32 counter_2 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "serviceResource [ref: serviceResourceCount = %d, max:4]", serviceResourceCount);\r\nfor (counter_2 = 0; counter_2 < 4; counter_2++) {\r\nif (counter_2 < serviceResourceCount) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "serviceResource [%d / %d]", counter_2 + 1, serviceResourceCount);\r\nlayoutCount = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_layoutCount, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nguint32 counter_5 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "layouts [ref: layoutCount = %d, max:5]", layoutCount);\r\nfor (counter_5 = 0; counter_5 < 5; counter_5++) {\r\nif (counter_5 < layoutCount) {\r\nptvcursor_add(cursor, hf_skinny_layouts, 4, ENC_LITTLE_ENDIAN);\r\n} else {\r\nptvcursor_advance(cursor, 4);\r\n}\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_add(cursor, hf_skinny_serviceNum, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxStreams, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxConferences, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_activeConferenceOnRegistration, 4, ENC_LITTLE_ENDIAN);\r\n} else {\r\nptvcursor_advance(cursor, 24);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n{\r\nguint32 counter_1 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "audiocaps [ref: audioCapCount = %d, max:18]", audioCapCount);\r\nfor (counter_1 = 0; counter_1 < 18; counter_1++) {\r\nif (counter_1 < audioCapCount) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "audiocaps [%d / %d]", counter_1 + 1, audioCapCount);\r\npayloadCapability = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_payloadCapability, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxFramesPerPacket, 4, ENC_LITTLE_ENDIAN);\r\nif (payloadCapability == MEDIA_PAYLOAD_G7231) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadCapability is Media_Payload_G7231");\r\nptvcursor_add(cursor, hf_skinny_g723BitRate, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 4);\r\n} else if (payloadCapability == MEDIA_PAYLOAD_V150_LC_MODEMRELAY) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadCapability is Media_Payload_v150_LC_ModemRelay");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "modemRelay");\r\nptvcursor_add(cursor, hf_skinny_capAndVer, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_modAnd2833, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n} else if (payloadCapability == MEDIA_PAYLOAD_V150_LC_SPRT) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadCapability is Media_Payload_v150_LC_SPRT");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "sprtPayload");\r\nptvcursor_add(cursor, hf_skinny_chan0MaxPayload, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_chan2MaxPayload, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_chan3MaxPayload, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_chan2MaxWindow, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n} else if (payloadCapability == MEDIA_PAYLOAD_V150_LC_SSE) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadCapability is Media_Payload_v150_LC_SSE");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "sse");\r\nptvcursor_add(cursor, hf_skinny_standard, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_vendor, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n} else {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "any payloadCapability");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "codecParams");\r\nptvcursor_add(cursor, hf_skinny_codecMode, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_dynamicPayload, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_codecParam1, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_codecParam2, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 4);\r\n}\r\n} else {\r\nptvcursor_advance(cursor, 16);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n{\r\nguint32 counter_1 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "vidCaps [ref: videoCapCount = %d, max:10]", videoCapCount);\r\nfor (counter_1 = 0; counter_1 < 10; counter_1++) {\r\nif (counter_1 < videoCapCount) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "vidCaps [%d / %d]", counter_1 + 1, videoCapCount);\r\npayloadCapability = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_payloadCapability, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_videoCapabilityDirection, 4, ENC_LITTLE_ENDIAN);\r\nlevelPreferenceCount = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_levelPreferenceCount, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nguint32 counter_4 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "levelPreference [ref: levelPreferenceCount = %d, max:4]", levelPreferenceCount);\r\nfor (counter_4 = 0; counter_4 < 4; counter_4++) {\r\nif (counter_4 < levelPreferenceCount) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "levelPreference [%d / %d]", counter_4 + 1, levelPreferenceCount);\r\nptvcursor_add(cursor, hf_skinny_transmitPreference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_format, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxBitRate, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_minBitRate, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_MPI, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_serviceNumber, 4, ENC_LITTLE_ENDIAN);\r\n} else {\r\nptvcursor_advance(cursor, 24);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nif (payloadCapability == MEDIA_PAYLOAD_H261) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadCapability is Media_Payload_H261");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "h261VideoCapability");\r\nptvcursor_add(cursor, hf_skinny_temporalSpatialTradeOffCapability, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_stillImageTransmission, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 16);\r\n} else if (payloadCapability == MEDIA_PAYLOAD_H263) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadCapability is Media_Payload_H263");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "h263VideoCapability");\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "h263_capability_bitfield");\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit1, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit2, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit3, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit4, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit5, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit6, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit7, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit8, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit9, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit10, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit11, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit12, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit13, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit14, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit15, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit16, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit17, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit18, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit19, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit20, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit21, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit22, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit23, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit24, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit25, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit26, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit27, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit28, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit29, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit30, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit31, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit32, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_advance(cursor, 4);\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_add(cursor, hf_skinny_annexNandWFutureUse, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 16);\r\n} else if (payloadCapability == MEDIA_PAYLOAD_H264) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadCapability is Media_Payload_H264");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "h264VideoCapability");\r\nptvcursor_add(cursor, hf_skinny_profile, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_level, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_customMaxMBPS, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_customMaxFS, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_customMaxDPB, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_customMaxBRandCPB, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n} else if (payloadCapability == MEDIA_PAYLOAD_VIEO) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadCapability is Media_Payload_Vieo");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "vieoVideoCapability");\r\nptvcursor_add(cursor, hf_skinny_modelNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_bandwidth, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 16);\r\n}\r\n} else {\r\nptvcursor_advance(cursor, 60);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n{\r\nguint32 counter_1 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "dataCaps [ref: dataCapCount = %d, max:5]", dataCapCount);\r\nfor (counter_1 = 0; counter_1 < 5; counter_1++) {\r\nif (counter_1 < dataCapCount) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "dataCaps [%d / %d]", counter_1 + 1, dataCapCount);\r\nptvcursor_add(cursor, hf_skinny_payloadCapability, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_dataCapabilityDirection, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_protocolDependentData, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxBitRate, 4, ENC_LITTLE_ENDIAN);\r\n} else {\r\nptvcursor_advance(cursor, 16);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nstatic void\r\nhandle_UpdateCapabilitiesV3Message(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 audioCapCount = 0;\r\nguint32 videoCapCount = 0;\r\nguint32 dataCapCount = 0;\r\nguint32 customPictureFormatCount = 0;\r\nguint32 serviceResourceCount = 0;\r\nguint32 layoutCount = 0;\r\nguint32 payloadCapability = 0;\r\nguint32 hdr_version = tvb_get_letohl(ptvcursor_tvbuff(cursor), 4);\r\nguint32 levelPreferenceCount = 0;\r\naudioCapCount = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_audioCapCount, 4, ENC_LITTLE_ENDIAN);\r\nvideoCapCount = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_videoCapCount, 4, ENC_LITTLE_ENDIAN);\r\ndataCapCount = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_dataCapCount, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_RTPPayloadFormat, 4, ENC_LITTLE_ENDIAN);\r\ncustomPictureFormatCount = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_customPictureFormatCount, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nguint32 counter_1 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "customPictureFormat [ref: customPictureFormatCount = %d, max:customPictureFormatCount]", customPictureFormatCount);\r\nfor (counter_1 = 0; counter_1 < customPictureFormatCount; counter_1++) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "customPictureFormat [%d / %d]", counter_1 + 1, customPictureFormatCount);\r\nptvcursor_add(cursor, hf_skinny_pictureWidth, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_pictureHeight, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_pixelAspectRatio, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_clockConversionCode, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_clockDivisor, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "confResources");\r\nptvcursor_add(cursor, hf_skinny_activeStreamsOnRegistration, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxBW, 4, ENC_LITTLE_ENDIAN);\r\nserviceResourceCount = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_serviceResourceCount, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nguint32 counter_2 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "serviceResource [ref: serviceResourceCount = %d, max:serviceResourceCount]", serviceResourceCount);\r\nfor (counter_2 = 0; counter_2 < serviceResourceCount; counter_2++) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "serviceResource [%d / %d]", counter_2 + 1, serviceResourceCount);\r\nlayoutCount = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_layoutCount, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nguint32 counter_4 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "layouts [ref: layoutCount = %d, max:layoutCount]", layoutCount);\r\nfor (counter_4 = 0; counter_4 < layoutCount; counter_4++) {\r\nptvcursor_add(cursor, hf_skinny_layouts, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_add(cursor, hf_skinny_serviceNum, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxStreams, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxConferences, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_activeConferenceOnRegistration, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n{\r\nguint32 counter_1 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "audiocaps [ref: audioCapCount = %d, max:audioCapCount]", audioCapCount);\r\nfor (counter_1 = 0; counter_1 < audioCapCount; counter_1++) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "audiocaps [%d / %d]", counter_1 + 1, audioCapCount);\r\npayloadCapability = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_payloadCapability, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxFramesPerPacket, 4, ENC_LITTLE_ENDIAN);\r\nif (payloadCapability == MEDIA_PAYLOAD_G7231) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadCapability is Media_Payload_G7231");\r\nptvcursor_add(cursor, hf_skinny_g723BitRate, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 4);\r\n} else if (payloadCapability == MEDIA_PAYLOAD_V150_LC_MODEMRELAY) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadCapability is Media_Payload_v150_LC_ModemRelay");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "modemRelay");\r\nptvcursor_add(cursor, hf_skinny_capAndVer, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_modAnd2833, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n} else if (payloadCapability == MEDIA_PAYLOAD_V150_LC_SPRT) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadCapability is Media_Payload_v150_LC_SPRT");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "sprtPayload");\r\nptvcursor_add(cursor, hf_skinny_chan0MaxPayload, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_chan2MaxPayload, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_chan3MaxPayload, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_chan2MaxWindow, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n} else if (payloadCapability == MEDIA_PAYLOAD_V150_LC_SSE) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadCapability is Media_Payload_v150_LC_SSE");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "sse");\r\nptvcursor_add(cursor, hf_skinny_standard, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_vendor, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n} else {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "any payloadCapability");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "codecParams");\r\nptvcursor_add(cursor, hf_skinny_codecMode, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_dynamicPayload, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_codecParam1, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_codecParam2, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 4);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n{\r\nguint32 counter_1 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "vidCaps [ref: videoCapCount = %d, max:videoCapCount]", videoCapCount);\r\nfor (counter_1 = 0; counter_1 < videoCapCount; counter_1++) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "vidCaps [%d / %d]", counter_1 + 1, videoCapCount);\r\npayloadCapability = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_payloadCapability, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_videoCapabilityDirection, 4, ENC_LITTLE_ENDIAN);\r\nlevelPreferenceCount = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_levelPreferenceCount, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nguint32 counter_3 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "levelPreference [ref: levelPreferenceCount = %d, max:levelPreferenceCount]", levelPreferenceCount);\r\nfor (counter_3 = 0; counter_3 < levelPreferenceCount; counter_3++) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "levelPreference [%d / %d]", counter_3 + 1, levelPreferenceCount);\r\nptvcursor_add(cursor, hf_skinny_transmitPreference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_format, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxBitRate, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_minBitRate, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_MPI, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_serviceNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_add(cursor, hf_skinny_encryptionCapability, 4, ENC_LITTLE_ENDIAN);\r\nif (payloadCapability == MEDIA_PAYLOAD_H261) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadCapability is Media_Payload_H261");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "h261VideoCapability");\r\nptvcursor_add(cursor, hf_skinny_temporalSpatialTradeOffCapability, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_stillImageTransmission, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 16);\r\n} else if (payloadCapability == MEDIA_PAYLOAD_H263) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadCapability is Media_Payload_H263");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "h263VideoCapability");\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "h263_capability_bitfield");\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit1, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit2, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit3, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit4, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit5, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit6, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit7, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit8, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit9, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit10, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit11, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit12, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit13, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit14, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit15, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit16, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit17, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit18, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit19, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit20, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit21, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit22, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit23, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit24, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit25, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit26, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit27, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit28, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit29, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit30, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit31, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit32, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_advance(cursor, 4);\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_add(cursor, hf_skinny_annexNandWFutureUse, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 16);\r\n} else if (payloadCapability == MEDIA_PAYLOAD_H264) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadCapability is Media_Payload_H264");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "h264VideoCapability");\r\nptvcursor_add(cursor, hf_skinny_profile, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_level, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_customMaxMBPS, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_customMaxFS, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_customMaxDPB, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_customMaxBRandCPB, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n} else if (payloadCapability == MEDIA_PAYLOAD_VIEO) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadCapability is Media_Payload_Vieo");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "vieoVideoCapability");\r\nptvcursor_add(cursor, hf_skinny_modelNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_bandwidth, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 16);\r\n}\r\nptvcursor_add(cursor, hf_skinny_ipAddressingMode, 4, ENC_LITTLE_ENDIAN);\r\nif (hdr_version >= V16_MSG_TYPE) {\r\nptvcursor_add(cursor, hf_skinny_ipAddressingMode, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n{\r\nguint32 counter_1 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "dataCaps [ref: dataCapCount = %d, max:dataCapCount]", dataCapCount);\r\nfor (counter_1 = 0; counter_1 < dataCapCount; counter_1++) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "dataCaps [%d / %d]", counter_1 + 1, dataCapCount);\r\nptvcursor_add(cursor, hf_skinny_payloadCapability, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_dataCapabilityDirection, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_protocolDependentData, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxBitRate, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_encryptionCapability, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nstatic void\r\nhandle_PortResMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 hdr_version = tvb_get_letohl(ptvcursor_tvbuff(cursor), 4);\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruPartyID, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_ipv4or6(cursor, hf_skinny_ipAddr_ipv4, hf_skinny_ipAddr_ipv6, pinfo);\r\nptvcursor_add(cursor, hf_skinny_portNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_RTCPPortNumber, 4, ENC_LITTLE_ENDIAN);\r\nif (hdr_version >= V19_MSG_TYPE) {\r\nptvcursor_add(cursor, hf_skinny_mediaType, 4, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\nhandle_QoSResvNotifyMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruPartyID, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_ipv4or6(cursor, hf_skinny_remoteIpAddr_ipv4, hf_skinny_remoteIpAddr_ipv6, pinfo);\r\nptvcursor_add(cursor, hf_skinny_remotePortNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_direction, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_QoSErrorNotifyMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruPartyID, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_ipv4or6(cursor, hf_skinny_remoteIpAddr_ipv4, hf_skinny_remoteIpAddr_ipv6, pinfo);\r\nptvcursor_add(cursor, hf_skinny_remotePortNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_direction, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_errorCode, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_failureNodeIpAddr, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_rsvpErrorCode, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_rsvpErrorSubCodeVal, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_rsvpErrorFlag, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_SubscriptionStatReqMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_transactionID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_subcriptionFeatureID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_timer, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_subscriptionID, 64, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void\r\nhandle_MediaPathEventMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_mediaPathID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_mediaPathEvent, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_MediaPathCapabilityMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_mediaPathID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_mediaPathCapabilities, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_MwiNotificationMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_mwiTargetNumber, 25, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_mwiControlNumber, 25, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_areMessagesWaiting, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "totalVmCounts");\r\nptvcursor_add(cursor, hf_skinny_numNewMsgs, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_numOldMsgs, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "priorityVmCounts");\r\nptvcursor_add(cursor, hf_skinny_numNewMsgs, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_numOldMsgs, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "totalFaxCounts");\r\nptvcursor_add(cursor, hf_skinny_numNewMsgs, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_numOldMsgs, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "priorityFaxCounts");\r\nptvcursor_add(cursor, hf_skinny_numNewMsgs, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_numOldMsgs, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nstatic void\r\nhandle_RegisterAckMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_keepAliveInterval, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_dateTemplate, 6, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_alignmentPadding, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_secondaryKeepAliveInterval, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxProtocolVer, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_unknown, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "PhoneFeatures");\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_Bit1, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_Bit2, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_Bit3, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_Bit4, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_UTF8, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_Bit6, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_Bit7, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_DynamicMessages, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_Bit9, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_RFC2833, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_Bit11, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_Bit12, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_Bit13, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_Bit14, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_Bit15, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_PhoneFeatures_Abbreviated_Dial, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_advance(cursor, 2);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nstatic void\r\nhandle_StartToneMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_tone, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_tone_output_direction, 4, ENC_LITTLE_ENDIAN);\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_StopToneMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 hdr_version = tvb_get_letohl(ptvcursor_tvbuff(cursor), 4);\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nif (hdr_version >= V11_MSG_TYPE) {\r\nptvcursor_add(cursor, hf_skinny_tone, 4, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\nhandle_SetRingerMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_ringMode, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_ringDuration, 4, ENC_LITTLE_ENDIAN);\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_SetLampMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_stimulus, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_stimulusInstance, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_lampMode, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_SetSpeakerModeMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_speakerMode, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_SetMicroModeMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_micMode, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_StartMediaTransmissionMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 hdr_version = tvb_get_letohl(ptvcursor_tvbuff(cursor), 4);\r\nguint32 compressionType = 0;\r\nguint16 keylen = 0;\r\nguint16 saltlen = 0;\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruPartyID, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_ipv4or6(cursor, hf_skinny_remoteIpAddr_ipv4, hf_skinny_remoteIpAddr_ipv6, pinfo);\r\nptvcursor_add(cursor, hf_skinny_remotePortNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_millisecondPacketSize, 4, ENC_LITTLE_ENDIAN);\r\ncompressionType = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_compressionType, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "qualifierOut");\r\nptvcursor_add(cursor, hf_skinny_precedenceValue, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_ssValue, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxFramesPerPacket, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_padding, 2, ENC_LITTLE_ENDIAN);\r\nif (hdr_version <= V10_MSG_TYPE) {\r\nptvcursor_add(cursor, hf_skinny_g723BitRate, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nif (hdr_version >= V11_MSG_TYPE) {\r\nif (compressionType == MEDIA_PAYLOAD_G7231) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "compressionType is Media_Payload_G7231");\r\nptvcursor_add(cursor, hf_skinny_g723BitRate, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n} else {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "any compressionType");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "codecParams");\r\nptvcursor_add(cursor, hf_skinny_codecMode, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_dynamicPayload, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_codecParam1, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_codecParam2, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "mTxMediaEncryptionKeyInfo");\r\nptvcursor_add(cursor, hf_skinny_algorithmID, 4, ENC_LITTLE_ENDIAN);\r\nkeylen = tvb_get_letohs(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_keylen, 2, ENC_LITTLE_ENDIAN);\r\nsaltlen = tvb_get_letohs(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_saltlen, 2, ENC_LITTLE_ENDIAN);\r\n{\r\nguint32 counter_2 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "key [ref: keylen = %d, max:16]", keylen);\r\nfor (counter_2 = 0; counter_2 < 16; counter_2++) {\r\nif (counter_2 < keylen) {\r\nptvcursor_add(cursor, hf_skinny_key, 1, ENC_LITTLE_ENDIAN);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n{\r\nguint32 counter_2 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "salt [ref: saltlen = %d, max:16]", saltlen);\r\nfor (counter_2 = 0; counter_2 < 16; counter_2++) {\r\nif (counter_2 < saltlen) {\r\nptvcursor_add(cursor, hf_skinny_salt, 1, ENC_LITTLE_ENDIAN);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_add(cursor, hf_skinny_isMKIPresent, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_keyDerivationRate, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_add(cursor, hf_skinny_streamPassThroughID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_associatedStreamID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_RFC2833PayloadType, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_dtmfType, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_mixingMode, 4, ENC_LITTLE_ENDIAN);\r\nif (hdr_version >= V15_MSG_TYPE) {\r\nptvcursor_add(cursor, hf_skinny_partyDirection, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nif (hdr_version >= V21_MSG_TYPE) {\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "latentCapsInfo");\r\nptvcursor_add(cursor, hf_skinny_active, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "modemRelay");\r\nptvcursor_add(cursor, hf_skinny_capAndVer, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_modAnd2833, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "sprtPayload");\r\nptvcursor_add(cursor, hf_skinny_chan0MaxPayload, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_chan2MaxPayload, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_chan3MaxPayload, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_chan2MaxWindow, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "sse");\r\nptvcursor_add(cursor, hf_skinny_standard, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_vendor, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadParam");\r\nptvcursor_add(cursor, hf_skinny_nse, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_rfc2833, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_sse, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_v150sprt, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_noaudio, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_FutureUse1, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_FutureUse2, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_FutureUse3, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\n}\r\nstatic void\r\nhandle_StopMediaTransmissionMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruPartyID, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_portHandlingFlag, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_CallInfoMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_callingPartyName, 40, ENC_ASCII|ENC_NA);\r\nsi->callingParty = g_strdup(tvb_format_stringzpad(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), 24));\r\nptvcursor_add(cursor, hf_skinny_callingParty, 24, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_calledPartyName, 40, ENC_ASCII|ENC_NA);\r\nsi->calledParty = g_strdup(tvb_format_stringzpad(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), 24));\r\nptvcursor_add(cursor, hf_skinny_calledParty, 24, ENC_ASCII|ENC_NA);\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_callType, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_originalCalledPartyName, 40, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_originalCalledParty, 24, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_lastRedirectingPartyName, 40, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_lastRedirectingParty, 24, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_originalCdpnRedirectReason, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_lastRedirectingReason, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_cgpnVoiceMailbox, 24, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_cdpnVoiceMailbox, 24, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_originalCdpnVoiceMailbox, 24, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_lastRedirectingVoiceMailbox, 24, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_callInstance, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_callSecurityStatus, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "partyPIRestrictionBits");\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_CallingPartyName, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_CallingPartyNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_CallingParty, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_CalledPartyName, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_CalledPartyNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_CalledParty, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_OriginalCalledPartyName, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_OriginalCalledPartyNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_OriginalCalledParty, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_LastRedirectPartyName, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_LastRedirectPartyNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_LastRedirectParty, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_BitsReserved, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_advance(cursor, 4);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nstatic void\r\nhandle_ForwardStatMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 hdr_version = tvb_get_letohl(ptvcursor_tvbuff(cursor), 4);\r\nguint32 VariableDirnumSize = (hdr_version >= V18_MSG_TYPE) ? 25 : 24;\r\nptvcursor_add(cursor, hf_skinny_activeForward, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_lineNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_forwardAllActive, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_forwardAllDirnum, VariableDirnumSize, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_forwardBusyActive, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_forwardBusyDirnum, VariableDirnumSize, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_forwardNoAnswerActive, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_forwardNoAnswerlDirnum, VariableDirnumSize, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void\r\nhandle_SpeedDialStatMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_speedDialNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_speedDialDirNumber, 24, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_speedDialDisplayName, 40, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void\r\nhandle_LineStatMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_lineNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_lineDirNumber, 24, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_lineFullyQualifiedDisplayName, 40, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_lineTextLabel, 40, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_lineDisplayOptions, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_ConfigStatMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "sid");\r\nptvcursor_add(cursor, hf_skinny_DeviceName, 16, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_reserved_for_future_use, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_instance, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_add(cursor, hf_skinny_userName, 40, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_serverName, 40, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_numberOfLines, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_numberOfSpeedDials, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_DefineTimeDate(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "timeDataInfo");\r\nptvcursor_add(cursor, hf_skinny_wYear, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_wMonth, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_wDayOfWeek, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_wDay, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_wHour, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_wMinute, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_wSecond, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_wMilliseconds, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_add(cursor, hf_skinny_systemTime, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_StartSessionTransmissionMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\ndissect_skinny_ipv4or6(cursor, hf_skinny_remoteIpAddr_ipv4, hf_skinny_remoteIpAddr_ipv6, pinfo);\r\nptvcursor_add(cursor, hf_skinny_sessionType, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_StopSessionTransmissionMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\ndissect_skinny_ipv4or6(cursor, hf_skinny_remoteIpAddr_ipv4, hf_skinny_remoteIpAddr_ipv6, pinfo);\r\nptvcursor_add(cursor, hf_skinny_sessionType, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_ButtonTemplateMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 totalButtonCount = 0;\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "buttonTemplate");\r\nptvcursor_add(cursor, hf_skinny_buttonOffset, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_buttonCount, 4, ENC_LITTLE_ENDIAN);\r\ntotalButtonCount = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_totalButtonCount, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nguint32 counter_2 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "definition [ref: totalButtonCount = %d, max:42]", totalButtonCount);\r\nfor (counter_2 = 0; counter_2 < 42; counter_2++) {\r\nif (counter_2 < totalButtonCount) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "definition [%d / %d]", counter_2 + 1, totalButtonCount);\r\nptvcursor_add(cursor, hf_skinny_instanceNumber, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_buttonDefinition, 1, ENC_LITTLE_ENDIAN);\r\n} else {\r\nptvcursor_advance(cursor, 2);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nstatic void\r\nhandle_VersionMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_version, 16, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void\r\nhandle_DisplayTextMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_text, 32, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void\r\nhandle_RegisterRejectMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_text, 32, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void\r\nhandle_ServerResMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 hdr_data_length = tvb_get_letohl(ptvcursor_tvbuff(cursor), 0);\r\n{\r\nguint32 counter_1 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "server [max:5]");\r\nfor (counter_1 = 0; counter_1 < 5; counter_1++) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "server [%d / %d]", counter_1 + 1, 5);\r\nptvcursor_add(cursor, hf_skinny_ServerName, 48, ENC_ASCII|ENC_NA);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n{\r\nguint32 counter_1 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "serverTcpListenPort [max:5]");\r\nfor (counter_1 = 0; counter_1 < 5; counter_1++) {\r\nptvcursor_add(cursor, hf_skinny_serverTcpListenPort, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nif (hdr_data_length < 293) {\r\n{\r\nguint32 counter_2 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "serverIpAddr [max:5]");\r\nfor (counter_2 = 0; counter_2 < 5; counter_2++) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "serverIpAddr [%d / %d]", counter_2 + 1, 5);\r\nptvcursor_add(cursor, hf_skinny_stationIpAddr, 4, ENC_BIG_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nif (hdr_data_length > 292) {\r\n{\r\nguint32 counter_2 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "serverIpAddr [max:5]");\r\nfor (counter_2 = 0; counter_2 < 5; counter_2++) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "serverIpAddr [%d / %d]", counter_2 + 1, 5);\r\ndissect_skinny_ipv4or6(cursor, hf_skinny_stationIpAddr_ipv4, hf_skinny_stationIpAddr_ipv6, pinfo);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\n}\r\nstatic void\r\nhandle_Reset(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_resetType, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_StartMulticastMediaReceptionMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 compressionType = 0;\r\nguint32 hdr_version = tvb_get_letohl(ptvcursor_tvbuff(cursor), 4);\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruPartyID, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_ipv4or6(cursor, hf_skinny_multicastIpAddr_ipv4, hf_skinny_multicastIpAddr_ipv6, pinfo);\r\nptvcursor_add(cursor, hf_skinny_multicastPortNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_millisecondPacketSize, 4, ENC_LITTLE_ENDIAN);\r\ncompressionType = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_compressionType, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "qualifierIn");\r\nptvcursor_add(cursor, hf_skinny_ecValue, 4, ENC_LITTLE_ENDIAN);\r\nif (hdr_version <= V10_MSG_TYPE) {\r\nptvcursor_add(cursor, hf_skinny_g723BitRate, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nif (hdr_version >= V11_MSG_TYPE) {\r\nif (compressionType == MEDIA_PAYLOAD_G7231) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "compressionType is Media_Payload_G7231");\r\nptvcursor_add(cursor, hf_skinny_g723BitRate, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n} else {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "any compressionType");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "codecParams");\r\nptvcursor_add(cursor, hf_skinny_codecMode, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_dynamicPayload, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_codecParam1, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_codecParam2, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_StartMulticastMediaTransmissionMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 compressionType = 0;\r\nguint32 hdr_version = tvb_get_letohl(ptvcursor_tvbuff(cursor), 4);\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruPartyID, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_ipv4or6(cursor, hf_skinny_multicastIpAddr_ipv4, hf_skinny_multicastIpAddr_ipv6, pinfo);\r\nptvcursor_add(cursor, hf_skinny_multicastPortNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_millisecondPacketSize, 4, ENC_LITTLE_ENDIAN);\r\ncompressionType = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_compressionType, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "qualifierOut");\r\nptvcursor_add(cursor, hf_skinny_precedenceValue, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_ssValue, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxFramesPerPacket, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_padding, 2, ENC_LITTLE_ENDIAN);\r\nif (hdr_version <= V10_MSG_TYPE) {\r\nptvcursor_add(cursor, hf_skinny_g723BitRate, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nif (hdr_version >= V11_MSG_TYPE) {\r\nif (compressionType == MEDIA_PAYLOAD_G7231) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "compressionType is Media_Payload_G7231");\r\nptvcursor_add(cursor, hf_skinny_g723BitRate, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n} else {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "any compressionType");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "codecParams");\r\nptvcursor_add(cursor, hf_skinny_codecMode, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_dynamicPayload, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_codecParam1, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_codecParam2, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_StopMulticastMediaReceptionMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruPartyID, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_StopMulticastMediaTransmissionMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruPartyID, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_OpenReceiveChannelMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 hdr_data_length = tvb_get_letohl(ptvcursor_tvbuff(cursor), 0);\r\nguint32 compressionType = 0;\r\nguint32 hdr_version = tvb_get_letohl(ptvcursor_tvbuff(cursor), 4);\r\nguint16 keylen = 0;\r\nguint16 saltlen = 0;\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruPartyID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_millisecondPacketSize, 4, ENC_LITTLE_ENDIAN);\r\ncompressionType = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_compressionType, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "qualifierIn");\r\nptvcursor_add(cursor, hf_skinny_ecValue, 4, ENC_LITTLE_ENDIAN);\r\nif (hdr_version <= V10_MSG_TYPE) {\r\nptvcursor_add(cursor, hf_skinny_g723BitRate, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nif (hdr_version >= V11_MSG_TYPE) {\r\nif (compressionType == MEDIA_PAYLOAD_G7231) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "compressionType is Media_Payload_G7231");\r\nptvcursor_add(cursor, hf_skinny_g723BitRate, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n} else {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "any compressionType");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "codecParams");\r\nptvcursor_add(cursor, hf_skinny_codecMode, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_dynamicPayload, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_codecParam1, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_codecParam2, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "mRxMediaEncryptionKeyInfo");\r\nptvcursor_add(cursor, hf_skinny_algorithmID, 4, ENC_LITTLE_ENDIAN);\r\nkeylen = tvb_get_letohs(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_keylen, 2, ENC_LITTLE_ENDIAN);\r\nsaltlen = tvb_get_letohs(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_saltlen, 2, ENC_LITTLE_ENDIAN);\r\n{\r\nguint32 counter_2 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "key [ref: keylen = %d, max:16]", keylen);\r\nfor (counter_2 = 0; counter_2 < 16; counter_2++) {\r\nif (counter_2 < keylen) {\r\nptvcursor_add(cursor, hf_skinny_key, 1, ENC_LITTLE_ENDIAN);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n{\r\nguint32 counter_2 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "salt [ref: saltlen = %d, max:16]", saltlen);\r\nfor (counter_2 = 0; counter_2 < 16; counter_2++) {\r\nif (counter_2 < saltlen) {\r\nptvcursor_add(cursor, hf_skinny_salt, 1, ENC_LITTLE_ENDIAN);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_add(cursor, hf_skinny_isMKIPresent, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_keyDerivationRate, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_add(cursor, hf_skinny_streamPassThroughID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_associatedStreamID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_RFC2833PayloadType, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_dtmfType, 4, ENC_LITTLE_ENDIAN);\r\nif (hdr_version >= V11_MSG_TYPE) {\r\nptvcursor_add(cursor, hf_skinny_mixingMode, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_partyDirection, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_ipv4or6(cursor, hf_skinny_sourceIpAddr_ipv4, hf_skinny_sourceIpAddr_ipv6, pinfo);\r\nptvcursor_add(cursor, hf_skinny_sourcePortNumber, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nif (hdr_version >= V16_MSG_TYPE) {\r\nptvcursor_add(cursor, hf_skinny_requestedIpAddrType, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nif (hdr_version >= V17_MSG_TYPE) {\r\nif (hdr_data_length > 132) {\r\nptvcursor_add(cursor, hf_skinny_audioLevelAdjustment, 4, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nif (hdr_version >= V21_MSG_TYPE) {\r\nif (hdr_data_length > 132) {\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "latentCapsInfo");\r\nptvcursor_add(cursor, hf_skinny_active, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "modemRelay");\r\nptvcursor_add(cursor, hf_skinny_capAndVer, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_modAnd2833, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "sprtPayload");\r\nptvcursor_add(cursor, hf_skinny_chan0MaxPayload, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_chan2MaxPayload, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_chan3MaxPayload, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_chan2MaxWindow, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "sse");\r\nptvcursor_add(cursor, hf_skinny_standard, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_vendor, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadParam");\r\nptvcursor_add(cursor, hf_skinny_nse, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_rfc2833, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_sse, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_v150sprt, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_noaudio, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_FutureUse1, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_FutureUse2, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_FutureUse3, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\n}\r\n}\r\nstatic void\r\nhandle_CloseReceiveChannelMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruPartyID, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_portHandlingFlag, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_ConnectionStatisticsReqMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 hdr_version = tvb_get_letohl(ptvcursor_tvbuff(cursor), 4);\r\nguint32 VariableDirnumSize = (hdr_version >= V18_MSG_TYPE) ? 25 : 24;\r\nptvcursor_add(cursor, hf_skinny_directoryNum, VariableDirnumSize, ENC_ASCII|ENC_NA);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_statsProcessingMode, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_SoftKeyTemplateResMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 totalSoftKeyCount = 0;\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "softKeyTemplate");\r\nptvcursor_add(cursor, hf_skinny_softKeyOffset, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_softKeyCount, 4, ENC_LITTLE_ENDIAN);\r\ntotalSoftKeyCount = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_totalSoftKeyCount, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nguint32 counter_2 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "definition [ref: totalSoftKeyCount = %d, max:32]", totalSoftKeyCount);\r\nfor (counter_2 = 0; counter_2 < 32; counter_2++) {\r\nif (counter_2 < totalSoftKeyCount) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "definition [%d / %d]", counter_2 + 1, totalSoftKeyCount);\r\ndissect_skinny_displayLabel(cursor, hf_skinny_softKeyLabel, 16);\r\nptvcursor_add(cursor, hf_skinny_softKeyEvent, 4, ENC_LITTLE_ENDIAN);\r\n} else {\r\nptvcursor_advance(cursor, 20);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nstatic void\r\nhandle_SoftKeySetResMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 totalSoftKeySetCount = 0;\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "softKeySets");\r\nptvcursor_add(cursor, hf_skinny_softKeySetOffset, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_softKeySetCount, 4, ENC_LITTLE_ENDIAN);\r\ntotalSoftKeySetCount = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_totalSoftKeySetCount, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nguint32 counter_2 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "definition [ref: totalSoftKeySetCount = %d, max:16]", totalSoftKeySetCount);\r\nfor (counter_2 = 0; counter_2 < 16; counter_2++) {\r\nif (counter_2 < totalSoftKeySetCount) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "definition [%d / %d]", counter_2 + 1, totalSoftKeySetCount);\r\n{\r\nguint32 counter_5 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "softKeyTemplateIndex [max:16]");\r\nfor (counter_5 = 0; counter_5 < 16; counter_5++) {\r\nptvcursor_add(cursor, hf_skinny_softKeyTemplateIndex, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n{\r\nguint32 counter_5 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "softKeyInfoIndex [max:16]");\r\nfor (counter_5 = 0; counter_5 < 16; counter_5++) {\r\nptvcursor_add(cursor, hf_skinny_softKeyInfoIndex, 2, ENC_LITTLE_ENDIAN);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n} else {\r\nptvcursor_advance(cursor, 3);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nstatic void\r\nhandle_SelectSoftKeysMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_softKeySetIndex, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "validKeyMask");\r\nptvcursor_add_no_advance(cursor, hf_skinny_SoftKeyMask_SoftKey1, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_SoftKeyMask_SoftKey2, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_SoftKeyMask_SoftKey3, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_SoftKeyMask_SoftKey4, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_SoftKeyMask_SoftKey5, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_SoftKeyMask_SoftKey6, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_SoftKeyMask_SoftKey7, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_SoftKeyMask_SoftKey8, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_SoftKeyMask_SoftKey9, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_SoftKeyMask_SoftKey10, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_SoftKeyMask_SoftKey11, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_SoftKeyMask_SoftKey12, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_SoftKeyMask_SoftKey13, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_SoftKeyMask_SoftKey14, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_SoftKeyMask_SoftKey15, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_SoftKeyMask_SoftKey16, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_advance(cursor, 4);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nstatic void\r\nhandle_CallStateMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nsi->callState = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callState, 4, ENC_LITTLE_ENDIAN);\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_privacy, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "precedence");\r\nptvcursor_add(cursor, hf_skinny_precedenceLevel, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_precedenceDomain, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nstatic void\r\nhandle_DisplayPromptStatusMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_timeOutValue, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_displayLabel(cursor, hf_skinny_promptStatus, 32);\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_ClearPromptStatusMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_DisplayNotifyMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_timeOutValue, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_displayLabel(cursor, hf_skinny_notify, 32);\r\n}\r\nstatic void\r\nhandle_ActivateCallPlaneMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_UnregisterAckMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_status, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_BackSpaceReqMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_RegisterTokenReject(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_waitTimeBeforeNextReq, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_StartMediaFailureDetectionMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 compressionType = 0;\r\nguint32 hdr_version = tvb_get_letohl(ptvcursor_tvbuff(cursor), 4);\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruPartyID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_millisecondPacketSize, 4, ENC_LITTLE_ENDIAN);\r\ncompressionType = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_compressionType, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "qualifierIn");\r\nptvcursor_add(cursor, hf_skinny_ecValue, 4, ENC_LITTLE_ENDIAN);\r\nif (hdr_version <= V10_MSG_TYPE) {\r\nptvcursor_add(cursor, hf_skinny_g723BitRate, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nif (hdr_version >= V11_MSG_TYPE) {\r\nif (compressionType == MEDIA_PAYLOAD_G7231) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "compressionType is Media_Payload_G7231");\r\nptvcursor_add(cursor, hf_skinny_g723BitRate, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n} else {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "any compressionType");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "codecParams");\r\nptvcursor_add(cursor, hf_skinny_codecMode, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_dynamicPayload, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_codecParam1, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_codecParam2, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_DialedNumberMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 hdr_version = tvb_get_letohl(ptvcursor_tvbuff(cursor), 4);\r\nguint32 VariableDirnumSize = (hdr_version >= V18_MSG_TYPE) ? 25 : 24;\r\nptvcursor_add(cursor, hf_skinny_dialedNumber, VariableDirnumSize, ENC_ASCII|ENC_NA);\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_UserToDeviceDataMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 dataLength = 0;\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "userToDeviceData");\r\nptvcursor_add(cursor, hf_skinny_applicationID, 4, ENC_LITTLE_ENDIAN);\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_transactionID, 4, ENC_LITTLE_ENDIAN);\r\ndataLength = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_dataLength, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_xml(cursor, hf_skinny_xmldata, pinfo, dataLength, 2000);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nstatic void\r\nhandle_FeatureStatMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_featureIndex, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_featureID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_featureTextLabel, 40, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_featureStatus, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_DisplayPriNotifyMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_timeOutValue, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_priority, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_displayLabel(cursor, hf_skinny_notify, 32);\r\n}\r\nstatic void\r\nhandle_ClearPriNotifyMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_priority, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_StartAnnouncementMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\n{\r\nguint32 counter_1 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "AnnList [max:32]");\r\nfor (counter_1 = 0; counter_1 < 32; counter_1++) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "AnnList [%d / %d]", counter_1 + 1, 32);\r\nptvcursor_add(cursor, hf_skinny_locale, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_country, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_toneAnnouncement, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_add(cursor, hf_skinny_annAckReq, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nguint32 counter_1 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "matrixConfPartyID [max:16]");\r\nfor (counter_1 = 0; counter_1 < 16; counter_1++) {\r\nptvcursor_add(cursor, hf_skinny_matrixConfPartyID, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_add(cursor, hf_skinny_hearingConfPartyMask, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_annPlayMode, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_StopAnnouncementMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_AnnouncementFinishMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_annStatus, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_NotifyDtmfToneMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_tone, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passthruPartyID, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_SendDtmfToneMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_tone, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passthruPartyID, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_SubscribeDtmfPayloadReqMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_payloadDtmf, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passthruPartyID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_dtmfType, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_SubscribeDtmfPayloadResMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_payloadDtmf, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passthruPartyID, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_SubscribeDtmfPayloadErrMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_payloadDtmf, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passthruPartyID, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_UnSubscribeDtmfPayloadReqMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_payloadDtmf, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passthruPartyID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_dtmfType, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_UnSubscribeDtmfPayloadResMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_payloadDtmf, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passthruPartyID, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_UnSubscribeDtmfPayloadErrMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_payloadDtmf, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passthruPartyID, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_ServiceURLStatMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_serviceURLIndex, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_serviceURL, 256, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_serviceURLDisplayName, 40, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void\r\nhandle_CallSelectStatMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_callSelectStat, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_OpenMultiMediaReceiveChannelMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 hdr_version = tvb_get_letohl(ptvcursor_tvbuff(cursor), 4);\r\nguint32 compressionType = 0;\r\nguint32 payloadType = 0;\r\nguint32 pictureFormatCount = 0;\r\nguint16 keylen = 0;\r\nguint16 saltlen = 0;\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruPartyID, 4, ENC_LITTLE_ENDIAN);\r\ncompressionType = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_compressionType, 4, ENC_LITTLE_ENDIAN);\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadType");\r\nptvcursor_add(cursor, hf_skinny_payload_rfc_number, 4, ENC_LITTLE_ENDIAN);\r\npayloadType = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_payloadType, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_add(cursor, hf_skinny_isConferenceCreator, 4, ENC_LITTLE_ENDIAN);\r\nif (payloadType <= MEDIA_PAYLOAD_AMR_WB) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadType <= Media_Payload_AMR_WB");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "audioParameters");\r\nptvcursor_add(cursor, hf_skinny_millisecondPacketSize, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "qualifierIn");\r\nptvcursor_add(cursor, hf_skinny_ecValue, 4, ENC_LITTLE_ENDIAN);\r\nif (hdr_version <= V10_MSG_TYPE) {\r\nptvcursor_add(cursor, hf_skinny_g723BitRate, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nif (hdr_version >= V11_MSG_TYPE) {\r\nif (compressionType == MEDIA_PAYLOAD_G7231) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "compressionType is Media_Payload_G7231");\r\nptvcursor_add(cursor, hf_skinny_g723BitRate, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n} else {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "any compressionType");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "codecParams");\r\nptvcursor_add(cursor, hf_skinny_codecMode, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_dynamicPayload, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_codecParam1, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_codecParam2, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 28);\r\n} else if (payloadType >= MEDIA_PAYLOAD_H261 && payloadType <= MEDIA_PAYLOAD_H264_FEC) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "Media_Payload_H261 <= payloadType <= Media_Payload_H264_FEC");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "vidParameters");\r\nptvcursor_add(cursor, hf_skinny_bitRate, 4, ENC_LITTLE_ENDIAN);\r\npictureFormatCount = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_pictureFormatCount, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nguint32 counter_3 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "pictureFormat [ref: pictureFormatCount = %d, max:5]", pictureFormatCount);\r\nfor (counter_3 = 0; counter_3 < 5; counter_3++) {\r\nif (counter_3 < pictureFormatCount) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "pictureFormat [%d / %d]", counter_3 + 1, pictureFormatCount);\r\nptvcursor_add(cursor, hf_skinny_format, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_MPI, 4, ENC_LITTLE_ENDIAN);\r\n} else {\r\nptvcursor_advance(cursor, 8);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_add(cursor, hf_skinny_confServiceNum, 4, ENC_LITTLE_ENDIAN);\r\nif (payloadType == MEDIA_PAYLOAD_H261) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadType is Media_Payload_H261");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "h261VideoCapability");\r\nptvcursor_add(cursor, hf_skinny_temporalSpatialTradeOffCapability, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_stillImageTransmission, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 16);\r\n} else if (payloadType == MEDIA_PAYLOAD_H263) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadType is Media_Payload_H263");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "h263VideoCapability");\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "h263_capability_bitfield");\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit1, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit2, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit3, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit4, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit5, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit6, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit7, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit8, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit9, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit10, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit11, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit12, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit13, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit14, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit15, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit16, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit17, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit18, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit19, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit20, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit21, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit22, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit23, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit24, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit25, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit26, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit27, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit28, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit29, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit30, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit31, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit32, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_advance(cursor, 4);\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_add(cursor, hf_skinny_annexNandWFutureUse, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 16);\r\n} else if (payloadType == MEDIA_PAYLOAD_H264) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadType is Media_Payload_H264");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "h264VideoCapability");\r\nptvcursor_add(cursor, hf_skinny_profile, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_level, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_customMaxMBPS, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_customMaxFS, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_customMaxDPB, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_customMaxBRandCPB, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n} else if (payloadType == MEDIA_PAYLOAD_VIEO) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadType is Media_Payload_Vieo");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "vieoVideoCapability");\r\nptvcursor_add(cursor, hf_skinny_modelNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_bandwidth, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 16);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n} else if (payloadType >= MEDIA_PAYLOAD_CLEAR_CHAN) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadType >= Media_Payload_Clear_Chan");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "dataParameters");\r\nptvcursor_add(cursor, hf_skinny_protocolDependentData, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxBitRate, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 36);\r\n}\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "mRxMediaEncryptionKeyInfo");\r\nptvcursor_add(cursor, hf_skinny_algorithmID, 4, ENC_LITTLE_ENDIAN);\r\nkeylen = tvb_get_letohs(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_keylen, 2, ENC_LITTLE_ENDIAN);\r\nsaltlen = tvb_get_letohs(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_saltlen, 2, ENC_LITTLE_ENDIAN);\r\n{\r\nguint32 counter_2 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "key [ref: keylen = %d, max:16]", keylen);\r\nfor (counter_2 = 0; counter_2 < 16; counter_2++) {\r\nif (counter_2 < keylen) {\r\nptvcursor_add(cursor, hf_skinny_key, 1, ENC_LITTLE_ENDIAN);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n{\r\nguint32 counter_2 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "salt [ref: saltlen = %d, max:16]", saltlen);\r\nfor (counter_2 = 0; counter_2 < 16; counter_2++) {\r\nif (counter_2 < saltlen) {\r\nptvcursor_add(cursor, hf_skinny_salt, 1, ENC_LITTLE_ENDIAN);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_add(cursor, hf_skinny_isMKIPresent, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_keyDerivationRate, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_add(cursor, hf_skinny_streamPassThroughID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_associatedStreamID, 4, ENC_LITTLE_ENDIAN);\r\nif (hdr_version >= V11_MSG_TYPE) {\r\ndissect_skinny_ipv4or6(cursor, hf_skinny_sourceIpAddr_ipv4, hf_skinny_sourceIpAddr_ipv6, pinfo);\r\nptvcursor_add(cursor, hf_skinny_sourcePortNumber, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nif (hdr_version >= V16_MSG_TYPE) {\r\nptvcursor_add(cursor, hf_skinny_requestedIpAddrType, 4, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\nhandle_StartMultiMediaTransmissionMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 compressionType = 0;\r\nguint32 payloadType = 0;\r\nguint32 hdr_version = tvb_get_letohl(ptvcursor_tvbuff(cursor), 4);\r\nguint32 pictureFormatCount = 0;\r\nguint16 keylen = 0;\r\nguint16 saltlen = 0;\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passthruPartyID, 4, ENC_LITTLE_ENDIAN);\r\ncompressionType = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_compressionType, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_ipv4or6(cursor, hf_skinny_remoteIpAddr_ipv4, hf_skinny_remoteIpAddr_ipv6, pinfo);\r\nptvcursor_add(cursor, hf_skinny_remotePortNumber, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadType");\r\nptvcursor_add(cursor, hf_skinny_payload_rfc_number, 4, ENC_LITTLE_ENDIAN);\r\npayloadType = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_payloadType, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_add(cursor, hf_skinny_DSCPValue, 4, ENC_LITTLE_ENDIAN);\r\nif (payloadType <= MEDIA_PAYLOAD_AMR_WB) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadType <= Media_Payload_AMR_WB");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "audioParameters");\r\nptvcursor_add(cursor, hf_skinny_millisecondPacketSize, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "qualifierIn");\r\nptvcursor_add(cursor, hf_skinny_ecValue, 4, ENC_LITTLE_ENDIAN);\r\nif (hdr_version <= V10_MSG_TYPE) {\r\nptvcursor_add(cursor, hf_skinny_g723BitRate, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nif (hdr_version >= V11_MSG_TYPE) {\r\nif (compressionType == MEDIA_PAYLOAD_G7231) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "compressionType is Media_Payload_G7231");\r\nptvcursor_add(cursor, hf_skinny_g723BitRate, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n} else {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "any compressionType");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "codecParams");\r\nptvcursor_add(cursor, hf_skinny_codecMode, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_dynamicPayload, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_codecParam1, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_codecParam2, 1, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 28);\r\n} else if (payloadType >= MEDIA_PAYLOAD_H261 && payloadType <= MEDIA_PAYLOAD_H264_FEC) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "Media_Payload_H261 <= payloadType <= Media_Payload_H264_FEC");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "vidParameters");\r\nptvcursor_add(cursor, hf_skinny_bitRate, 4, ENC_LITTLE_ENDIAN);\r\npictureFormatCount = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_pictureFormatCount, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nguint32 counter_3 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "pictureFormat [ref: pictureFormatCount = %d, max:5]", pictureFormatCount);\r\nfor (counter_3 = 0; counter_3 < 5; counter_3++) {\r\nif (counter_3 < pictureFormatCount) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "pictureFormat [%d / %d]", counter_3 + 1, pictureFormatCount);\r\nptvcursor_add(cursor, hf_skinny_format, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_MPI, 4, ENC_LITTLE_ENDIAN);\r\n} else {\r\nptvcursor_advance(cursor, 8);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_add(cursor, hf_skinny_confServiceNum, 4, ENC_LITTLE_ENDIAN);\r\nif (payloadType == MEDIA_PAYLOAD_H261) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadType is Media_Payload_H261");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "h261VideoCapability");\r\nptvcursor_add(cursor, hf_skinny_temporalSpatialTradeOffCapability, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_stillImageTransmission, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 16);\r\n} else if (payloadType == MEDIA_PAYLOAD_H263) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadType is Media_Payload_H263");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "h263VideoCapability");\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "h263_capability_bitfield");\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit1, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit2, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit3, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit4, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit5, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit6, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit7, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit8, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit9, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit10, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit11, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit12, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit13, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit14, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit15, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit16, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit17, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit18, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit19, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit20, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit21, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit22, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit23, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit24, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit25, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit26, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit27, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit28, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit29, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit30, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit31, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_Generic_Bitfield_Bit32, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_advance(cursor, 4);\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_add(cursor, hf_skinny_annexNandWFutureUse, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 16);\r\n} else if (payloadType == MEDIA_PAYLOAD_H264) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadType is Media_Payload_H264");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "h264VideoCapability");\r\nptvcursor_add(cursor, hf_skinny_profile, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_level, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_customMaxMBPS, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_customMaxFS, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_customMaxDPB, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_customMaxBRandCPB, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n} else if (payloadType == MEDIA_PAYLOAD_VIEO) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadType is Media_Payload_Vieo");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "vieoVideoCapability");\r\nptvcursor_add(cursor, hf_skinny_modelNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_bandwidth, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 16);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n} else if (payloadType >= MEDIA_PAYLOAD_CLEAR_CHAN) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "payloadType >= Media_Payload_Clear_Chan");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "dataParameters");\r\nptvcursor_add(cursor, hf_skinny_protocolDependentData, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxBitRate, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 36);\r\n}\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "mTxMediaEncryptionKeyInfo");\r\nptvcursor_add(cursor, hf_skinny_algorithmID, 4, ENC_LITTLE_ENDIAN);\r\nkeylen = tvb_get_letohs(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_keylen, 2, ENC_LITTLE_ENDIAN);\r\nsaltlen = tvb_get_letohs(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_saltlen, 2, ENC_LITTLE_ENDIAN);\r\n{\r\nguint32 counter_2 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "key [ref: keylen = %d, max:16]", keylen);\r\nfor (counter_2 = 0; counter_2 < 16; counter_2++) {\r\nif (counter_2 < keylen) {\r\nptvcursor_add(cursor, hf_skinny_key, 1, ENC_LITTLE_ENDIAN);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n{\r\nguint32 counter_2 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "salt [ref: saltlen = %d, max:16]", saltlen);\r\nfor (counter_2 = 0; counter_2 < 16; counter_2++) {\r\nif (counter_2 < saltlen) {\r\nptvcursor_add(cursor, hf_skinny_salt, 1, ENC_LITTLE_ENDIAN);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_add(cursor, hf_skinny_isMKIPresent, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_keyDerivationRate, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_add(cursor, hf_skinny_streamPassThroughID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_associatedStreamID, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_StopMultiMediaTransmissionMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruPartyID, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_portHandlingFlag, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_MiscellaneousCommandMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 command = 0;\r\nguint32 recoveryReferencePictureCount = 0;\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passthruPartyID, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\ncommand = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_command, 4, ENC_LITTLE_ENDIAN);\r\nif (command == MISCCOMMANDTYPE_VIDEOFASTUPDATEPICTURE) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "command is MiscCommandType_videoFastUpdatePicture");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "videoFastUpdatePicture");\r\nptvcursor_add(cursor, hf_skinny_firstGOB, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_numberOfGOBs, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 8);\r\n} else if (command == MISCCOMMANDTYPE_VIDEOFASTUPDATEGOB) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "command is MiscCommandType_videoFastUpdateGOB");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "videoFastUpdateGOB");\r\nptvcursor_add(cursor, hf_skinny_firstGOB, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_numberOfGOBs, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 8);\r\n} else if (command == MISCCOMMANDTYPE_VIDEOFASTUPDATEMB) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "command is MiscCommandType_videoFastUpdateMB");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "videoFastUpdateMB");\r\nptvcursor_add(cursor, hf_skinny_firstGOB, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_firstMB, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_numberOfMBs, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 4);\r\n} else if (command == MISCCOMMANDTYPE_LOSTPICTURE) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "command is MiscCommandType_lostPicture");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "lostPicture");\r\nptvcursor_add(cursor, hf_skinny_pictureNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_longTermPictureIndex, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 8);\r\n} else if (command == MISCCOMMANDTYPE_LOSTPARTIALPICTURE) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "command is MiscCommandType_lostPartialPicture");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "lostPartialPicture");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "pictureReference");\r\nptvcursor_add(cursor, hf_skinny_pictureNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_longTermPictureIndex, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_add(cursor, hf_skinny_firstMB, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_numberOfMBs, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n} else if (command == MISCCOMMANDTYPE_RECOVERYREFERENCEPICTURE) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "command is MiscCommandType_recoveryReferencePicture");\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "recoveryReferencePictureValue");\r\nrecoveryReferencePictureCount = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_recoveryReferencePictureCount, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nguint32 counter_3 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "recoveryReferencePicture [ref: recoveryReferencePictureCount = %d, max:4]", recoveryReferencePictureCount);\r\nfor (counter_3 = 0; counter_3 < 4; counter_3++) {\r\nif (counter_3 < recoveryReferencePictureCount) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "recoveryReferencePicture [%d / %d]", counter_3 + 1, recoveryReferencePictureCount);\r\nptvcursor_add(cursor, hf_skinny_pictureNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_longTermPictureIndex, 4, ENC_LITTLE_ENDIAN);\r\n} else {\r\nptvcursor_advance(cursor, 8);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 4);\r\n} else if (command == MISCCOMMANDTYPE_TEMPORALSPATIALTRADEOFF) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "command is MiscCommandType_temporalSpatialTradeOff");\r\nptvcursor_add(cursor, hf_skinny_temporalSpatialTradeOff, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 12);\r\n} else {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "any command");\r\nptvcursor_add(cursor, hf_skinny_none, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_advance(cursor, 12);\r\n}\r\n}\r\nstatic void\r\nhandle_FlowControlCommandMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passthruPartyID, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maximumBitRate, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_CloseMultiMediaReceiveChannelMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruPartyID, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_portHandlingFlag, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_CreateConferenceReqMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 dataLength = 0;\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_numberOfReservedParticipants, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_resourceType, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_appID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_appConfID, 32, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_appData, 24, ENC_ASCII|ENC_NA);\r\ndataLength = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_dataLength, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruData, dataLength, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void\r\nhandle_DeleteConferenceReqMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_ModifyConferenceReqMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 dataLength = 0;\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_numberOfReservedParticipants, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_appID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_appConfID, 32, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_appData, 24, ENC_ASCII|ENC_NA);\r\ndataLength = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_dataLength, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruData, dataLength, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void\r\nhandle_AddParticipantReqMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "partyPIRestrictionBits");\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_CallingPartyName, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_CallingPartyNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_CallingParty, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_CalledPartyName, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_CalledPartyNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_CalledParty, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_OriginalCalledPartyName, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_OriginalCalledPartyNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_OriginalCalledParty, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_LastRedirectPartyName, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_LastRedirectPartyNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_LastRedirectParty, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_BitsReserved, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_advance(cursor, 4);\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_add(cursor, hf_skinny_participantName, 40, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_participantNumber, 24, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_conferenceName, 32, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void\r\nhandle_DropParticipantReqMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_AuditParticipantReqMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_ChangeParticipantReqMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "partyPIRestrictionBits");\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_CallingPartyName, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_CallingPartyNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_CallingParty, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_CalledPartyName, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_CalledPartyNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_CalledParty, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_OriginalCalledPartyName, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_OriginalCalledPartyNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_OriginalCalledParty, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_LastRedirectPartyName, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_LastRedirectPartyNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_LastRedirectParty, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_BitsReserved, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_advance(cursor, 4);\r\nptvcursor_pop_subtree(cursor);\r\nptvcursor_add(cursor, hf_skinny_participantName, 40, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_participantNumber, 24, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_conferenceName, 32, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void\r\nhandle_UserToDeviceDataMessageVersion1(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 dataLength = 0;\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "userToDeviceDataVersion1");\r\nptvcursor_add(cursor, hf_skinny_applicationID, 4, ENC_LITTLE_ENDIAN);\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_transactionID, 4, ENC_LITTLE_ENDIAN);\r\ndataLength = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_dataLength, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_sequenceFlag, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_displayPriority, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_appInstanceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_routingID, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_xml(cursor, hf_skinny_xmldata, pinfo, dataLength, 2000);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nstatic void\r\nhandle_VideoDisplayCommandMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_layoutID, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_FlowControlNotifyMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passthruPartyID, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maximumBitRate, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_ConfigStatV2Message(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 DeviceName_len = 0;\r\nguint32 userName_len = 0;\r\nguint32 serverName_len = 0;\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "sid");\r\nDeviceName_len = tvb_strnlen(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), -1)+1;\r\nif (DeviceName_len > 1) {\r\nptvcursor_add(cursor, hf_skinny_DeviceName, DeviceName_len, ENC_ASCII|ENC_NA);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\nptvcursor_add(cursor, hf_skinny_reserved_for_future_use, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_instance, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_add(cursor, hf_skinny_numberOfLines, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_numberOfSpeedDials, 4, ENC_LITTLE_ENDIAN);\r\nuserName_len = tvb_strnlen(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), -1)+1;\r\nif (userName_len > 1) {\r\nptvcursor_add(cursor, hf_skinny_userName, userName_len, ENC_ASCII|ENC_NA);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\nserverName_len = tvb_strnlen(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), -1)+1;\r\nif (serverName_len > 1) {\r\nptvcursor_add(cursor, hf_skinny_serverName, serverName_len, ENC_ASCII|ENC_NA);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\n}\r\nstatic void\r\nhandle_DisplayNotifyV2Message(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_timeOutValue, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_displayLabel(cursor, hf_skinny_notify, 0);\r\n}\r\nstatic void\r\nhandle_DisplayPriNotifyV2Message(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_timeOutValue, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_priority, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_displayLabel(cursor, hf_skinny_notify, 0);\r\n}\r\nstatic void\r\nhandle_DisplayPromptStatusV2Message(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_timeOutValue, 4, ENC_LITTLE_ENDIAN);\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_displayLabel(cursor, hf_skinny_promptStatus, 0);\r\n}\r\nstatic void\r\nhandle_FeatureStatV2Message(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 featureTextLabel_len = 0;\r\nptvcursor_add(cursor, hf_skinny_featureIndex, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_featureID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_featureStatus, 4, ENC_LITTLE_ENDIAN);\r\nfeatureTextLabel_len = tvb_strnlen(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), -1)+1;\r\nif (featureTextLabel_len > 1) {\r\nptvcursor_add(cursor, hf_skinny_featureTextLabel, featureTextLabel_len, ENC_ASCII|ENC_NA);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\n}\r\nstatic void\r\nhandle_LineStatV2Message(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 lineDirNumber_len = 0;\r\nguint32 lineFullyQualifiedDisplayName_len = 0;\r\nguint32 lineTextLabel_len = 0;\r\nptvcursor_add(cursor, hf_skinny_lineNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "lineType");\r\nptvcursor_add_no_advance(cursor, hf_skinny_OrigDialed, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RedirDialed, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_CallingPartyNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_CallingPartyName, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_advance(cursor, 4);\r\nptvcursor_pop_subtree(cursor);\r\nlineDirNumber_len = tvb_strnlen(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), -1)+1;\r\nif (lineDirNumber_len > 1) {\r\nptvcursor_add(cursor, hf_skinny_lineDirNumber, lineDirNumber_len, ENC_ASCII|ENC_NA);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\nlineFullyQualifiedDisplayName_len = tvb_strnlen(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), -1)+1;\r\nif (lineFullyQualifiedDisplayName_len > 1) {\r\nptvcursor_add(cursor, hf_skinny_lineFullyQualifiedDisplayName, lineFullyQualifiedDisplayName_len, ENC_ASCII|ENC_NA);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\nlineTextLabel_len = tvb_strnlen(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), -1)+1;\r\nif (lineTextLabel_len > 1) {\r\nptvcursor_add(cursor, hf_skinny_lineTextLabel, lineTextLabel_len, ENC_ASCII|ENC_NA);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\n}\r\nstatic void\r\nhandle_ServiceURLStatV2Message(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_serviceURLIndex, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_SpeedDialStatV2Message(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 speedDialDirNumber_len = 0;\r\nguint32 speedDialDisplayName_len = 0;\r\nptvcursor_add(cursor, hf_skinny_speedDialNumber, 4, ENC_LITTLE_ENDIAN);\r\nspeedDialDirNumber_len = tvb_strnlen(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), -1)+1;\r\nif (speedDialDirNumber_len > 1) {\r\nptvcursor_add(cursor, hf_skinny_speedDialDirNumber, speedDialDirNumber_len, ENC_ASCII|ENC_NA);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\nspeedDialDisplayName_len = tvb_strnlen(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), -1)+1;\r\nif (speedDialDisplayName_len > 1) {\r\nptvcursor_add(cursor, hf_skinny_speedDialDisplayName, speedDialDisplayName_len, ENC_ASCII|ENC_NA);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\n}\r\nstatic void\r\nhandle_CallInfoV2Message(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 hdr_version = tvb_get_letohl(ptvcursor_tvbuff(cursor), 4);\r\nguint32 callingParty_len = 0;\r\nguint32 AlternateCallingParty_len = 0;\r\nguint32 calledParty_len = 0;\r\nguint32 originalCalledParty_len = 0;\r\nguint32 lastRedirectingParty_len = 0;\r\nguint32 cgpnVoiceMailbox_len = 0;\r\nguint32 cdpnVoiceMailbox_len = 0;\r\nguint32 originalCdpnVoiceMailbox_len = 0;\r\nguint32 lastRedirectingVoiceMailbox_len = 0;\r\nguint32 callingPartyName_len = 0;\r\nguint32 calledPartyName_len = 0;\r\nguint32 originalCalledPartyName_len = 0;\r\nguint32 lastRedirectingPartyName_len = 0;\r\nguint32 HuntPilotNumber_len = 0;\r\nguint32 HuntPilotName_len = 0;\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_callType, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_originalCdpnRedirectReason, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_lastRedirectingReason, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_callInstance, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_callSecurityStatus, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "partyPIRestrictionBits");\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_CallingPartyName, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_CallingPartyNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_CallingParty, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_CalledPartyName, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_CalledPartyNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_CalledParty, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_OriginalCalledPartyName, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_OriginalCalledPartyNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_OriginalCalledParty, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_LastRedirectPartyName, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_LastRedirectPartyNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_LastRedirectParty, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_skinny_RestrictInformationType_BitsReserved, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_advance(cursor, 4);\r\nptvcursor_pop_subtree(cursor);\r\ncallingParty_len = tvb_strnlen(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), -1)+1;\r\nif (callingParty_len > 1) {\r\nsi->callingParty = g_strdup(tvb_format_stringzpad(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), callingParty_len));\r\nptvcursor_add(cursor, hf_skinny_callingParty, callingParty_len, ENC_ASCII|ENC_NA);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\nAlternateCallingParty_len = tvb_strnlen(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), -1)+1;\r\nif (AlternateCallingParty_len > 1) {\r\nptvcursor_add(cursor, hf_skinny_AlternateCallingParty, AlternateCallingParty_len, ENC_ASCII|ENC_NA);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\ncalledParty_len = tvb_strnlen(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), -1)+1;\r\nif (calledParty_len > 1) {\r\nsi->calledParty = g_strdup(tvb_format_stringzpad(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), calledParty_len));\r\nptvcursor_add(cursor, hf_skinny_calledParty, calledParty_len, ENC_ASCII|ENC_NA);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\noriginalCalledParty_len = tvb_strnlen(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), -1)+1;\r\nif (originalCalledParty_len > 1) {\r\nptvcursor_add(cursor, hf_skinny_originalCalledParty, originalCalledParty_len, ENC_ASCII|ENC_NA);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\nlastRedirectingParty_len = tvb_strnlen(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), -1)+1;\r\nif (lastRedirectingParty_len > 1) {\r\nptvcursor_add(cursor, hf_skinny_lastRedirectingParty, lastRedirectingParty_len, ENC_ASCII|ENC_NA);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\ncgpnVoiceMailbox_len = tvb_strnlen(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), -1)+1;\r\nif (cgpnVoiceMailbox_len > 1) {\r\nptvcursor_add(cursor, hf_skinny_cgpnVoiceMailbox, cgpnVoiceMailbox_len, ENC_ASCII|ENC_NA);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\ncdpnVoiceMailbox_len = tvb_strnlen(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), -1)+1;\r\nif (cdpnVoiceMailbox_len > 1) {\r\nptvcursor_add(cursor, hf_skinny_cdpnVoiceMailbox, cdpnVoiceMailbox_len, ENC_ASCII|ENC_NA);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\noriginalCdpnVoiceMailbox_len = tvb_strnlen(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), -1)+1;\r\nif (originalCdpnVoiceMailbox_len > 1) {\r\nptvcursor_add(cursor, hf_skinny_originalCdpnVoiceMailbox, originalCdpnVoiceMailbox_len, ENC_ASCII|ENC_NA);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\nlastRedirectingVoiceMailbox_len = tvb_strnlen(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), -1)+1;\r\nif (lastRedirectingVoiceMailbox_len > 1) {\r\nptvcursor_add(cursor, hf_skinny_lastRedirectingVoiceMailbox, lastRedirectingVoiceMailbox_len, ENC_ASCII|ENC_NA);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\ncallingPartyName_len = tvb_strnlen(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), -1)+1;\r\nif (callingPartyName_len > 1) {\r\nptvcursor_add(cursor, hf_skinny_callingPartyName, callingPartyName_len, ENC_ASCII|ENC_NA);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\ncalledPartyName_len = tvb_strnlen(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), -1)+1;\r\nif (calledPartyName_len > 1) {\r\nptvcursor_add(cursor, hf_skinny_calledPartyName, calledPartyName_len, ENC_ASCII|ENC_NA);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\noriginalCalledPartyName_len = tvb_strnlen(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), -1)+1;\r\nif (originalCalledPartyName_len > 1) {\r\nptvcursor_add(cursor, hf_skinny_originalCalledPartyName, originalCalledPartyName_len, ENC_ASCII|ENC_NA);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\nlastRedirectingPartyName_len = tvb_strnlen(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), -1)+1;\r\nif (lastRedirectingPartyName_len > 1) {\r\nptvcursor_add(cursor, hf_skinny_lastRedirectingPartyName, lastRedirectingPartyName_len, ENC_ASCII|ENC_NA);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\nif (hdr_version >= V17_MSG_TYPE) {\r\nHuntPilotNumber_len = tvb_strnlen(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), -1)+1;\r\nif (HuntPilotNumber_len > 1) {\r\nptvcursor_add(cursor, hf_skinny_HuntPilotNumber, HuntPilotNumber_len, ENC_ASCII|ENC_NA);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\nHuntPilotName_len = tvb_strnlen(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor), -1)+1;\r\nif (HuntPilotName_len > 1) {\r\nptvcursor_add(cursor, hf_skinny_HuntPilotName, HuntPilotName_len, ENC_ASCII|ENC_NA);\r\n} else {\r\nptvcursor_advance(cursor, 1);\r\n}\r\n}\r\n}\r\nstatic void\r\nhandle_PortReqMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruPartyID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_mediaTransportType, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_ipAddressType, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_mediaType, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_PortCloseMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruPartyID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_mediaType, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_QoSListenMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruPartyID, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_ipv4or6(cursor, hf_skinny_remoteIpAddr_ipv4, hf_skinny_remoteIpAddr_ipv6, pinfo);\r\nptvcursor_add(cursor, hf_skinny_remotePortNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_resvStyle, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxRetryNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_retryTimer, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_confirmRequired, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_preemptionPriority, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_defendingPriority, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_compressionType, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_averageBitRate, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_burstSize, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_peakRate, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "appID");\r\nptvcursor_add(cursor, hf_skinny_vendorID, 32, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_version, 16, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_appName, 32, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_subAppID, 32, ENC_ASCII|ENC_NA);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nstatic void\r\nhandle_QoSPathMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruPartyID, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_ipv4or6(cursor, hf_skinny_remoteIpAddr_ipv4, hf_skinny_remoteIpAddr_ipv6, pinfo);\r\nptvcursor_add(cursor, hf_skinny_remotePortNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_resvStyle, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxRetryNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_retryTimer, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_preemptionPriority, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_defendingPriority, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_compressionType, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_averageBitRate, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_burstSize, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_peakRate, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "appID");\r\nptvcursor_add(cursor, hf_skinny_vendorID, 32, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_version, 16, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_appName, 32, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_subAppID, 32, ENC_ASCII|ENC_NA);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nstatic void\r\nhandle_QoSTeardownMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruPartyID, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_ipv4or6(cursor, hf_skinny_remoteIpAddr_ipv4, hf_skinny_remoteIpAddr_ipv6, pinfo);\r\nptvcursor_add(cursor, hf_skinny_remotePortNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_direction, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_UpdateDSCPMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruPartyID, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_ipv4or6(cursor, hf_skinny_remoteIpAddr_ipv4, hf_skinny_remoteIpAddr_ipv6, pinfo);\r\nptvcursor_add(cursor, hf_skinny_remotePortNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_DSCPValue, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_QoSModifyMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruPartyID, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_ipv4or6(cursor, hf_skinny_remoteIpAddr_ipv4, hf_skinny_remoteIpAddr_ipv6, pinfo);\r\nptvcursor_add(cursor, hf_skinny_remotePortNumber, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_direction, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_compressionType, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_averageBitRate, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_burstSize, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_peakRate, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "appID");\r\nptvcursor_add(cursor, hf_skinny_vendorID, 32, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_version, 16, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_appName, 32, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_subAppID, 32, ENC_ASCII|ENC_NA);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nstatic void\r\nhandle_SubscriptionStatMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_transactionID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_subscriptionoFeatureID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_timer, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_cause, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_NotificationMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_transactionID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_subscriptionFeatureID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_status, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_text, 97, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void\r\nhandle_StartMediaTransmissionAckMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruPartyID, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_ipv4or6(cursor, hf_skinny_transmitIpAddr_ipv4, hf_skinny_transmitIpAddr_ipv6, pinfo);\r\nptvcursor_add(cursor, hf_skinny_transmitPort, 4, ENC_LITTLE_ENDIAN);\r\nsi->startmediatransmisionStatus = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_startMediaTransmissionStatus, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_StartMultiMediaTransmissionAckMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_conferenceID, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_passThruPartyID, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\ndissect_skinny_ipv4or6(cursor, hf_skinny_transmitIpAddr_ipv4, hf_skinny_transmitIpAddr_ipv6, pinfo);\r\nptvcursor_add(cursor, hf_skinny_transmitPort, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_resultCode, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_CallHistoryInfoMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_callHistoryDisposition, 4, ENC_LITTLE_ENDIAN);\r\nsi->lineId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineInstance, 4, ENC_LITTLE_ENDIAN);\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_LocationInfoMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_locationInfo, 2401, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void\r\nhandle_MwiResponseMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_mwiTargetNumber, 25, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_mwi_notification_result, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_AddOnDeviceCapabilitiesMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_unknown1_0159, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_unknown2_0159, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_unknown3_0159, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_unknownString_0159, 152, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void\r\nhandle_EnhancedAlarmMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\ndissect_skinny_xml(cursor, hf_skinny_alarmInfo, pinfo, 0, 2048);\r\n}\r\nstatic void\r\nhandle_CallCountRespMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nguint32 lineDataEntries = 0;\r\nptvcursor_add(cursor, hf_skinny_totalNumOfConfiguredLines, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_startingLineInstance, 4, ENC_LITTLE_ENDIAN);\r\nlineDataEntries = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_lineDataEntries, 4, ENC_LITTLE_ENDIAN);\r\n{\r\nguint32 counter_1 = 0;\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "lineData [ref: lineDataEntries = %d, max:42]", lineDataEntries);\r\nfor (counter_1 = 0; counter_1 < 42; counter_1++) {\r\nif (counter_1 < lineDataEntries) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "lineData [%d / %d]", counter_1 + 1, lineDataEntries);\r\nptvcursor_add(cursor, hf_skinny_maxNumCalls, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_busyTrigger, 2, ENC_LITTLE_ENDIAN);\r\n} else {\r\nptvcursor_advance(cursor, 4);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\n}\r\nstatic void\r\nhandle_RecordingStatusMessage(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nsi->callId = tvb_get_letohl(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_skinny_callReference, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_recording_status, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_SPCPRegisterTokenReq(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\n{\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH, ett_skinny_tree, "sid");\r\nptvcursor_add(cursor, hf_skinny_DeviceName, 16, ENC_ASCII|ENC_NA);\r\nptvcursor_add(cursor, hf_skinny_reserved_for_future_use, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_instance, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nptvcursor_add(cursor, hf_skinny_stationIpAddr, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_deviceType, 4, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_skinny_maxStreams, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_SPCPRegisterTokenAck(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_features, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nhandle_SPCPRegisterTokenReject(ptvcursor_t *cursor, packet_info * pinfo _U_)\r\n{\r\nptvcursor_add(cursor, hf_skinny_waitTimeBeforeNextReq, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic int dissect_skinny_pdu(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nguint offset = 0;\r\nptvcursor_t* cursor;\r\nguint32 hdr_data_length;\r\nguint32 hdr_version;\r\nguint32 data_messageid;\r\nguint16 i;\r\nproto_tree *skinny_tree = NULL;\r\nproto_item *ti = NULL;\r\nhdr_data_length = tvb_get_letohl(tvb, 0);\r\nhdr_version = tvb_get_letohl(tvb, 4);\r\ndata_messageid = tvb_get_letohl(tvb, 8);\r\npi_current++;\r\nif (pi_current == MAX_SKINNY_MESSAGES_IN_PACKET)\r\n{\r\npi_current = 0;\r\n}\r\nsi = &pi_arr[pi_current];\r\nsi->messId = data_messageid;\r\nsi->messageName = val_to_str_ext(data_messageid, &message_id_ext, "0x%08X (Unknown)");\r\nsi->callId = 0;\r\nsi->lineId = 0;\r\nsi->passThruId = 0;\r\nsi->callState = 0;\r\ng_free(si->callingParty);\r\nsi->callingParty = NULL;\r\ng_free(si->calledParty);\r\nsi->calledParty = NULL;\r\nsi->openreceiveStatus = 0;\r\nsi->startmediatransmisionStatus = 0;\r\nif (tree) {\r\nti = proto_tree_add_item(tree, proto_skinny, tvb, offset, hdr_data_length+8, ENC_NA);\r\nskinny_tree = proto_item_add_subtree(ti, ett_skinny);\r\nproto_tree_add_uint(skinny_tree, hf_skinny_data_length, tvb, offset, 4, hdr_data_length);\r\nproto_tree_add_uint(skinny_tree, hf_skinny_hdr_version, tvb, offset+4, 4, hdr_version);\r\n}\r\ncol_add_fstr(pinfo->cinfo, COL_INFO,"%s ", si->messageName);\r\ncol_set_fence(pinfo->cinfo, COL_INFO);\r\nproto_tree_add_uint(skinny_tree, hf_skinny_messageId, tvb,offset+8, 4, data_messageid );\r\noffset += 12;\r\ncursor = ptvcursor_new(skinny_tree, tvb, offset);\r\nfor (i = 0; i < sizeof(skinny_opcode2handler)/sizeof(struct opcode2handler) ; i++) {\r\nif (skinny_opcode2handler[i].opcode == data_messageid && skinny_opcode2handler[i].handler) {\r\nskinny_opcode2handler[i].handler(cursor, pinfo);\r\n}\r\n}\r\nptvcursor_free(cursor);\r\ntap_queue_packet(skinny_tap, pinfo, si);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic int\r\ndissect_skinny(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data)\r\n{\r\nguint32 hdr_data_length;\r\nguint32 hdr_version;\r\nif (tvb_captured_length(tvb) < 8)\r\n{\r\nreturn 0;\r\n}\r\nhdr_data_length = tvb_get_letohl(tvb, 0);\r\nhdr_version = tvb_get_letohl(tvb, 4);\r\nif (\r\n(hdr_data_length < 4) ||\r\n((hdr_version != BASIC_MSG_TYPE) &&\r\n(hdr_version != V10_MSG_TYPE) &&\r\n(hdr_version != V11_MSG_TYPE) &&\r\n(hdr_version != V15_MSG_TYPE) &&\r\n(hdr_version != V16_MSG_TYPE) &&\r\n(hdr_version != V17_MSG_TYPE) &&\r\n(hdr_version != V18_MSG_TYPE) &&\r\n(hdr_version != V19_MSG_TYPE) &&\r\n(hdr_version != V20_MSG_TYPE) &&\r\n(hdr_version != V21_MSG_TYPE) &&\r\n(hdr_version != V22_MSG_TYPE))\r\n)\r\n{\r\nreturn 0;\r\n}\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "SKINNY");\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Skinny Client Control Protocol");\r\ntcp_dissect_pdus(tvb, pinfo, tree, skinny_desegment, 4, get_skinny_pdu_len, dissect_skinny_pdu, data);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_skinny(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_skinny_data_length,\r\n{\r\n"Data length", "skinny.data_length", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Number of bytes in the data portion.", HFILL }},\r\n{ &hf_skinny_hdr_version,\r\n{\r\n"Header version", "skinny.hdr_version", FT_UINT32, BASE_HEX, VALS(header_version), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_messageId,\r\n{\r\n"Message ID", "skinny.messageId", FT_UINT32, BASE_DEC|BASE_EXT_STRING, &message_id_ext, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_xmlData,\r\n{\r\n"XML data", "skinny.xmlData", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_ipv4or6,\r\n{\r\n"IPv4or6", "skinny.ipv4or6", FT_UINT32, BASE_DEC|BASE_EXT_STRING, &IpAddrType_ext, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_CallingPartyName,\r\n{\r\n"CallingName", "skinny.CallingPartyName", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0008,\r\nNULL, HFILL }},\r\n{ &hf_skinny_CallingPartyNumber,\r\n{\r\n"CallingNum", "skinny.CallingPartyNumber", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0004,\r\nNULL, HFILL }},\r\n{ &hf_skinny_DSCPValue,\r\n{\r\n"DSCPValue", "skinny.DSCPValue", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_FutureUse1,\r\n{\r\n"FutureUse1", "skinny.FutureUse1", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_FutureUse2,\r\n{\r\n"FutureUse2", "skinny.FutureUse2", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_FutureUse3,\r\n{\r\n"FutureUse3", "skinny.FutureUse3", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit1,\r\n{\r\n"Bit1", "skinny.Generic.Bitfield.Bit1", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0001,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit10,\r\n{\r\n"Bit10", "skinny.Generic.Bitfield.Bit10", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0200,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit11,\r\n{\r\n"Bit11", "skinny.Generic.Bitfield.Bit11", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0400,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit12,\r\n{\r\n"Bit12", "skinny.Generic.Bitfield.Bit12", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0800,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit13,\r\n{\r\n"Bit13", "skinny.Generic.Bitfield.Bit13", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x1000,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit14,\r\n{\r\n"Bit14", "skinny.Generic.Bitfield.Bit14", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x2000,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit15,\r\n{\r\n"Bit14", "skinny.Generic.Bitfield.Bit15", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x4000,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit16,\r\n{\r\n"Bit15", "skinny.Generic.Bitfield.Bit16", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x8000,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit17,\r\n{\r\n"Bit17", "skinny.Generic.Bitfield.Bit17", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x10000,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit18,\r\n{\r\n"Bit18", "skinny.Generic.Bitfield.Bit18", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x20000,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit19,\r\n{\r\n"Bit19", "skinny.Generic.Bitfield.Bit19", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x40000,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit2,\r\n{\r\n"Bit2", "skinny.Generic.Bitfield.Bit2", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0002,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit20,\r\n{\r\n"Bit20", "skinny.Generic.Bitfield.Bit20", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x80000,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit21,\r\n{\r\n"Bit21", "skinny.Generic.Bitfield.Bit21", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x100000,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit22,\r\n{\r\n"Bit22", "skinny.Generic.Bitfield.Bit22", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x200000,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit23,\r\n{\r\n"Bit23", "skinny.Generic.Bitfield.Bit23", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x400000,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit24,\r\n{\r\n"Bit24", "skinny.Generic.Bitfield.Bit24", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x800000,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit25,\r\n{\r\n"Bit25", "skinny.Generic.Bitfield.Bit25", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x1000000,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit26,\r\n{\r\n"Bit26", "skinny.Generic.Bitfield.Bit26", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x2000000,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit27,\r\n{\r\n"Bit27", "skinny.Generic.Bitfield.Bit27", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x4000000,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit28,\r\n{\r\n"Bit28", "skinny.Generic.Bitfield.Bit28", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x8000000,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit29,\r\n{\r\n"Bit29", "skinny.Generic.Bitfield.Bit29", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x10000000,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit3,\r\n{\r\n"Bit3", "skinny.Generic.Bitfield.Bit3", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0004,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit30,\r\n{\r\n"Bit30", "skinny.Generic.Bitfield.Bit30", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x20000000,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit31,\r\n{\r\n"Bit31", "skinny.Generic.Bitfield.Bit31", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x40000000,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit32,\r\n{\r\n"Bit32", "skinny.Generic.Bitfield.Bit32", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x80000000,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit4,\r\n{\r\n"Bit4", "skinny.Generic.Bitfield.Bit4", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0008,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit5,\r\n{\r\n"Bit5", "skinny.Generic.Bitfield.Bit5", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0010,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit6,\r\n{\r\n"Bit6", "skinny.Generic.Bitfield.Bit6", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0020,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit7,\r\n{\r\n"Bit7", "skinny.Generic.Bitfield.Bit7", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0040,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit8,\r\n{\r\n"Bit8", "skinny.Generic.Bitfield.Bit8", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0080,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_Generic_Bitfield_Bit9,\r\n{\r\n"Bit9", "skinny.Generic.Bitfield.Bit9", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0100,\r\n"H263 Capability BitField", HFILL }},\r\n{ &hf_skinny_MPI,\r\n{\r\n"MPI", "skinny.MPI", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_OrigDialed,\r\n{\r\n"Originaly Dialed", "skinny.OrigDialed", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0001,\r\nNULL, HFILL }},\r\n{ &hf_skinny_PhoneFeatures_Abbreviated_Dial,\r\n{\r\n"AbbrevDial", "skinny.PhoneFeatures.Abbreviated.Dial", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x8000,\r\n"Features this device supports", HFILL }},\r\n{ &hf_skinny_PhoneFeatures_Bit1,\r\n{\r\n"Bit1", "skinny.PhoneFeatures.Bit1", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0001,\r\n"Features this device supports", HFILL }},\r\n{ &hf_skinny_PhoneFeatures_Bit11,\r\n{\r\n"Bit11", "skinny.PhoneFeatures.Bit11", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0400,\r\n"Features this device supports", HFILL }},\r\n{ &hf_skinny_PhoneFeatures_Bit12,\r\n{\r\n"Bit12", "skinny.PhoneFeatures.Bit12", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0800,\r\n"Features this device supports", HFILL }},\r\n{ &hf_skinny_PhoneFeatures_Bit13,\r\n{\r\n"Bit13", "skinny.PhoneFeatures.Bit13", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x1000,\r\n"Features this device supports", HFILL }},\r\n{ &hf_skinny_PhoneFeatures_Bit14,\r\n{\r\n"Bit14", "skinny.PhoneFeatures.Bit14", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x2000,\r\n"Features this device supports", HFILL }},\r\n{ &hf_skinny_PhoneFeatures_Bit15,\r\n{\r\n"Bit15", "skinny.PhoneFeatures.Bit15", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x4000,\r\n"Features this device supports", HFILL }},\r\n{ &hf_skinny_PhoneFeatures_Bit2,\r\n{\r\n"Bit2", "skinny.PhoneFeatures.Bit2", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0002,\r\n"Features this device supports", HFILL }},\r\n{ &hf_skinny_PhoneFeatures_Bit3,\r\n{\r\n"Bit3", "skinny.PhoneFeatures.Bit3", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0004,\r\n"Features this device supports", HFILL }},\r\n{ &hf_skinny_PhoneFeatures_Bit4,\r\n{\r\n"Bit4", "skinny.PhoneFeatures.Bit4", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0008,\r\n"Features this device supports", HFILL }},\r\n{ &hf_skinny_PhoneFeatures_Bit6,\r\n{\r\n"Bit6", "skinny.PhoneFeatures.Bit6", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0020,\r\n"Features this device supports", HFILL }},\r\n{ &hf_skinny_PhoneFeatures_Bit7,\r\n{\r\n"Bit7", "skinny.PhoneFeatures.Bit7", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0040,\r\n"Features this device supports", HFILL }},\r\n{ &hf_skinny_PhoneFeatures_Bit9,\r\n{\r\n"Bit9", "skinny.PhoneFeatures.Bit9", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0100,\r\n"Features this device supports", HFILL }},\r\n{ &hf_skinny_PhoneFeatures_DynamicMessages,\r\n{\r\n"DynamicMessages", "skinny.PhoneFeatures.DynamicMessages", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0080,\r\n"Features this device supports", HFILL }},\r\n{ &hf_skinny_PhoneFeatures_RFC2833,\r\n{\r\n"RFC2833", "skinny.PhoneFeatures.RFC2833", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0200,\r\n"Features this device supports", HFILL }},\r\n{ &hf_skinny_PhoneFeatures_UTF8,\r\n{\r\n"UTF8Bit5", "skinny.PhoneFeatures.UTF8", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0010,\r\n"Features this device supports", HFILL }},\r\n{ &hf_skinny_RFC2833PayloadType,\r\n{\r\n"RFC2833PayloadType", "skinny.RFC2833PayloadType", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_RTCPPortNumber,\r\n{\r\n"RTCPPortNumber", "skinny.RTCPPortNumber", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_RTPPayloadFormat,\r\n{\r\n"RTPPayloadFormat", "skinny.RTPPayloadFormat", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_RedirDialed,\r\n{\r\n"Redirected Dialed", "skinny.RedirDialed", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0002,\r\nNULL, HFILL }},\r\n{ &hf_skinny_RestrictInformationType_BitsReserved,\r\n{\r\n"BitsReserved", "skinny.RestrictInformationType.BitsReserved", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0xffffff00,\r\nNULL, HFILL }},\r\n{ &hf_skinny_RestrictInformationType_CalledParty,\r\n{\r\n"CalledParty", "skinny.RestrictInformationType.CalledParty", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x000c,\r\nNULL, HFILL }},\r\n{ &hf_skinny_RestrictInformationType_CalledPartyName,\r\n{\r\n"CalledPartyName", "skinny.RestrictInformationType.CalledPartyName", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0004,\r\nNULL, HFILL }},\r\n{ &hf_skinny_RestrictInformationType_CalledPartyNumber,\r\n{\r\n"CalledPartyNumber", "skinny.RestrictInformationType.CalledPartyNumber", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0008,\r\nNULL, HFILL }},\r\n{ &hf_skinny_RestrictInformationType_CallingParty,\r\n{\r\n"CallingParty", "skinny.RestrictInformationType.CallingParty", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0003,\r\nNULL, HFILL }},\r\n{ &hf_skinny_RestrictInformationType_CallingPartyName,\r\n{\r\n"CallingPartyName", "skinny.RestrictInformationType.CallingPartyName", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0001,\r\nNULL, HFILL }},\r\n{ &hf_skinny_RestrictInformationType_CallingPartyNumber,\r\n{\r\n"CallingPartyNumber", "skinny.RestrictInformationType.CallingPartyNumber", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0002,\r\nNULL, HFILL }},\r\n{ &hf_skinny_RestrictInformationType_LastRedirectParty,\r\n{\r\n"LastRedirectParty", "skinny.RestrictInformationType.LastRedirectParty", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x00c0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_RestrictInformationType_LastRedirectPartyName,\r\n{\r\n"LastRedirectPartyName", "skinny.RestrictInformationType.LastRedirectPartyName", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0040,\r\nNULL, HFILL }},\r\n{ &hf_skinny_RestrictInformationType_LastRedirectPartyNumber,\r\n{\r\n"LastRedirectPartyNumber", "skinny.RestrictInformationType.LastRedirectPartyNumber", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0080,\r\nNULL, HFILL }},\r\n{ &hf_skinny_RestrictInformationType_OriginalCalledParty,\r\n{\r\n"OriginalCalledParty", "skinny.RestrictInformationType.OriginalCalledParty", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0030,\r\nNULL, HFILL }},\r\n{ &hf_skinny_RestrictInformationType_OriginalCalledPartyName,\r\n{\r\n"OriginalCalledPartyName", "skinny.RestrictInformationType.OriginalCalledPartyName", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0010,\r\nNULL, HFILL }},\r\n{ &hf_skinny_RestrictInformationType_OriginalCalledPartyNumber,\r\n{\r\n"OriginalCalledPartyNumber", "skinny.RestrictInformationType.OriginalCalledPartyNumber", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0020,\r\nNULL, HFILL }},\r\n{ &hf_skinny_SoftKeyMask_SoftKey1,\r\n{\r\n"SoftKey1", "skinny.SoftKeyMask.SoftKey1", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0001,\r\nNULL, HFILL }},\r\n{ &hf_skinny_SoftKeyMask_SoftKey10,\r\n{\r\n"SoftKey10", "skinny.SoftKeyMask.SoftKey10", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0200,\r\nNULL, HFILL }},\r\n{ &hf_skinny_SoftKeyMask_SoftKey11,\r\n{\r\n"SoftKey11", "skinny.SoftKeyMask.SoftKey11", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0400,\r\nNULL, HFILL }},\r\n{ &hf_skinny_SoftKeyMask_SoftKey12,\r\n{\r\n"SoftKey12", "skinny.SoftKeyMask.SoftKey12", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0800,\r\nNULL, HFILL }},\r\n{ &hf_skinny_SoftKeyMask_SoftKey13,\r\n{\r\n"SoftKey13", "skinny.SoftKeyMask.SoftKey13", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x1000,\r\nNULL, HFILL }},\r\n{ &hf_skinny_SoftKeyMask_SoftKey14,\r\n{\r\n"SoftKey14", "skinny.SoftKeyMask.SoftKey14", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x2000,\r\nNULL, HFILL }},\r\n{ &hf_skinny_SoftKeyMask_SoftKey15,\r\n{\r\n"SoftKey15", "skinny.SoftKeyMask.SoftKey15", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x4000,\r\nNULL, HFILL }},\r\n{ &hf_skinny_SoftKeyMask_SoftKey16,\r\n{\r\n"SoftKey16", "skinny.SoftKeyMask.SoftKey16", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x8000,\r\nNULL, HFILL }},\r\n{ &hf_skinny_SoftKeyMask_SoftKey2,\r\n{\r\n"SoftKey2", "skinny.SoftKeyMask.SoftKey2", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0002,\r\nNULL, HFILL }},\r\n{ &hf_skinny_SoftKeyMask_SoftKey3,\r\n{\r\n"SoftKey3", "skinny.SoftKeyMask.SoftKey3", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0004,\r\nNULL, HFILL }},\r\n{ &hf_skinny_SoftKeyMask_SoftKey4,\r\n{\r\n"SoftKey4", "skinny.SoftKeyMask.SoftKey4", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0008,\r\nNULL, HFILL }},\r\n{ &hf_skinny_SoftKeyMask_SoftKey5,\r\n{\r\n"SoftKey5", "skinny.SoftKeyMask.SoftKey5", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0010,\r\nNULL, HFILL }},\r\n{ &hf_skinny_SoftKeyMask_SoftKey6,\r\n{\r\n"SoftKey6", "skinny.SoftKeyMask.SoftKey6", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0020,\r\nNULL, HFILL }},\r\n{ &hf_skinny_SoftKeyMask_SoftKey7,\r\n{\r\n"SoftKey7", "skinny.SoftKeyMask.SoftKey7", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0040,\r\nNULL, HFILL }},\r\n{ &hf_skinny_SoftKeyMask_SoftKey8,\r\n{\r\n"SoftKey8", "skinny.SoftKeyMask.SoftKey8", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0080,\r\nNULL, HFILL }},\r\n{ &hf_skinny_SoftKeyMask_SoftKey9,\r\n{\r\n"SoftKey9", "skinny.SoftKeyMask.SoftKey9", FT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0100,\r\nNULL, HFILL }},\r\n{ &hf_skinny_active,\r\n{\r\n"active", "skinny.active", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_activeConferenceOnRegistration,\r\n{\r\n"Active Conference", "skinny.activeConferenceOnRegistration", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Active conference at Registration", HFILL }},\r\n{ &hf_skinny_activeConferences,\r\n{\r\n"Active Conferences", "skinny.activeConferences", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Active Conferences at Registration", HFILL }},\r\n{ &hf_skinny_activeForward,\r\n{\r\n"activeForward", "skinny.activeForward", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_activeStreams,\r\n{\r\n"Active RTP Streams", "skinny.activeStreams", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Active RTP Streams at Registration", HFILL }},\r\n{ &hf_skinny_activeStreamsOnRegistration,\r\n{\r\n"activeStreamsOnRegistration", "skinny.activeStreamsOnRegistration", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_alarmInfo,\r\n{\r\n"alarmInfo", "skinny.alarmInfo", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_alignmentPadding,\r\n{\r\n"alignmentPadding", "skinny.alignmentPadding", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_annexNandWFutureUse,\r\n{\r\n"annexNandWFutureUse", "skinny.annexNandWFutureUse", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_appID,\r\n{\r\n"appID", "skinny.appID", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_appInstanceID,\r\n{\r\n"appInstanceID", "skinny.appInstanceID", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_applicationID,\r\n{\r\n"applicationID", "skinny.applicationID", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_areMessagesWaiting,\r\n{\r\n"areMessagesWaiting", "skinny.areMessagesWaiting", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_associatedStreamID,\r\n{\r\n"associatedStreamID", "skinny.associatedStreamID", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_audioCapCount,\r\n{\r\n"audioCapCount", "skinny.audioCapCount", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_audioLevelAdjustment,\r\n{\r\n"audioLevelAdjustment", "skinny.audioLevelAdjustment", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_averageBitRate,\r\n{\r\n"averageBitRate", "skinny.averageBitRate", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_bandwidth,\r\n{\r\n"bandwidth", "skinny.bandwidth", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_bitRate,\r\n{\r\n"bitRate", "skinny.bitRate", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_burstSize,\r\n{\r\n"burstSize", "skinny.burstSize", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_busyTrigger,\r\n{\r\n"busyTrigger", "skinny.busyTrigger", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_buttonCount,\r\n{\r\n"buttonCount", "skinny.buttonCount", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_buttonOffset,\r\n{\r\n"buttonOffset", "skinny.buttonOffset", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_callInstance,\r\n{\r\n"callInstance", "skinny.callInstance", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"CallId", HFILL }},\r\n{ &hf_skinny_callReference,\r\n{\r\n"callReference", "skinny.callReference", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"CallId", HFILL }},\r\n{ &hf_skinny_callSelectStat,\r\n{\r\n"callSelectStat", "skinny.callSelectStat", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_capAndVer,\r\n{\r\n"capAndVer", "skinny.capAndVer", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_capCount,\r\n{\r\n"capCount", "skinny.capCount", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_chan0MaxPayload,\r\n{\r\n"chan0MaxPayload", "skinny.chan0MaxPayload", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_chan2MaxPayload,\r\n{\r\n"chan2MaxPayload", "skinny.chan2MaxPayload", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_chan2MaxWindow,\r\n{\r\n"chan2MaxWindow", "skinny.chan2MaxWindow", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_chan3MaxPayload,\r\n{\r\n"chan3MaxPayload", "skinny.chan3MaxPayload", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_clockConversionCode,\r\n{\r\n"clockConversionCode", "skinny.clockConversionCode", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_clockDivisor,\r\n{\r\n"clockDivisor", "skinny.clockDivisor", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_codecMode,\r\n{\r\n"codecMode", "skinny.codecMode", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_codecParam1,\r\n{\r\n"codecParam1", "skinny.codecParam1", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_codecParam2,\r\n{\r\n"codecParam2", "skinny.codecParam2", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_confServiceNum,\r\n{\r\n"confServiceNum", "skinny.confServiceNum", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_conferenceID,\r\n{\r\n"conferenceID", "skinny.conferenceID", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Conference ID", HFILL }},\r\n{ &hf_skinny_confirmRequired,\r\n{\r\n"confirmRequired", "skinny.confirmRequired", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_country,\r\n{\r\n"country", "skinny.country", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_customMaxBRandCPB,\r\n{\r\n"customMaxBRandCPB", "skinny.customMaxBRandCPB", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_customMaxDPB,\r\n{\r\n"customMaxDPB", "skinny.customMaxDPB", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_customMaxFS,\r\n{\r\n"customMaxFS", "skinny.customMaxFS", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_customMaxMBPS,\r\n{\r\n"customMaxMBPS", "skinny.customMaxMBPS", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_customPictureFormatCount,\r\n{\r\n"customPictureFormatCount", "skinny.customPictureFormatCount", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_dataCapCount,\r\n{\r\n"dataCapCount", "skinny.dataCapCount", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_dataLength,\r\n{\r\n"dataLength", "skinny.dataLength", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_dataSize,\r\n{\r\n"dataSize", "skinny.dataSize", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Data Size", HFILL }},\r\n{ &hf_skinny_defendingPriority,\r\n{\r\n"defendingPriority", "skinny.defendingPriority", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_displayPriority,\r\n{\r\n"displayPriority", "skinny.displayPriority", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_dtmfType,\r\n{\r\n"dtmfType", "skinny.dtmfType", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_dynamicPayload,\r\n{\r\n"dynamicPayload", "skinny.dynamicPayload", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_failureNodeIpAddr,\r\n{\r\n"failureNodeIpAddr", "skinny.failureNodeIpAddr", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_featureCapabilities,\r\n{\r\n"featureCapabilities", "skinny.featureCapabilities", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_featureIndex,\r\n{\r\n"featureIndex", "skinny.featureIndex", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_featureStatus,\r\n{\r\n"featureStatus", "skinny.featureStatus", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_features,\r\n{\r\n"features", "skinny.features", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_firstGOB,\r\n{\r\n"firstGOB", "skinny.firstGOB", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_firstMB,\r\n{\r\n"firstMB", "skinny.firstMB", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_format,\r\n{\r\n"format", "skinny.format", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_forwardAllActive,\r\n{\r\n"forwardAllActive", "skinny.forwardAllActive", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_forwardBusyActive,\r\n{\r\n"forwardBusyActive", "skinny.forwardBusyActive", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_forwardNoAnswerActive,\r\n{\r\n"forwardNoAnswerActive", "skinny.forwardNoAnswerActive", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_hearingConfPartyMask,\r\n{\r\n"hearingConfPartyMask", "skinny.hearingConfPartyMask", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_instance,\r\n{\r\n"instance", "skinny.instance", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Device Instance", HFILL }},\r\n{ &hf_skinny_instanceNumber,\r\n{\r\n"instanceNumber", "skinny.instanceNumber", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_ipAddr_ipv4,\r\n{\r\n"ipAddr IPv4 Address", "skinny.ipAddr.ipv4", FT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_ipAddr_ipv6,\r\n{\r\n"ipAddr IPv6 Address", "skinny.ipAddr.ipv6", FT_IPv6, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_ipV4AddressScope,\r\n{\r\n"ipV4AddressScope", "skinny.ipV4AddressScope", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"IPv4 Address Scope", HFILL }},\r\n{ &hf_skinny_ipV6AddressScope,\r\n{\r\n"ipV6AddressScope", "skinny.ipV6AddressScope", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"IPv6 Address Scope", HFILL }},\r\n{ &hf_skinny_isConferenceCreator,\r\n{\r\n"isConferenceCreator", "skinny.isConferenceCreator", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_isMKIPresent,\r\n{\r\n"isMKIPresent", "skinny.isMKIPresent", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_jitter,\r\n{\r\n"jitter", "skinny.jitter", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Amount of Jitter", HFILL }},\r\n{ &hf_skinny_keepAliveInterval,\r\n{\r\n"keepAliveInterval", "skinny.keepAliveInterval", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_key,\r\n{\r\n"key", "skinny.key", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_keyDerivationRate,\r\n{\r\n"keyDerivationRate", "skinny.keyDerivationRate", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_keylen,\r\n{\r\n"keylen", "skinny.keylen", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_last,\r\n{\r\n"last", "skinny.last", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_lastRedirectingReason,\r\n{\r\n"lastRedirectingReason", "skinny.lastRedirectingReason", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Last Redirecting Reason", HFILL }},\r\n{ &hf_skinny_latency,\r\n{\r\n"latency", "skinny.latency", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Amount of Latency", HFILL }},\r\n{ &hf_skinny_layoutCount,\r\n{\r\n"layoutCount", "skinny.layoutCount", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_layoutID,\r\n{\r\n"layoutID", "skinny.layoutID", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_level,\r\n{\r\n"level", "skinny.level", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_levelPreferenceCount,\r\n{\r\n"levelPreferenceCount", "skinny.levelPreferenceCount", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_lineDataEntries,\r\n{\r\n"lineDataEntries", "skinny.lineDataEntries", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Number of Line Data Entries", HFILL }},\r\n{ &hf_skinny_lineDisplayOptions,\r\n{\r\n"lineDisplayOptions", "skinny.lineDisplayOptions", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_lineInstance,\r\n{\r\n"lineInstance", "skinny.lineInstance", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"LineId", HFILL }},\r\n{ &hf_skinny_lineNumber,\r\n{\r\n"lineNumber", "skinny.lineNumber", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_locale,\r\n{\r\n"locale", "skinny.locale", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_longTermPictureIndex,\r\n{\r\n"longTermPictureIndex", "skinny.longTermPictureIndex", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_macAddress,\r\n{\r\n"Mac Address", "skinny.macAddress", FT_ETHER, BASE_NONE, NULL, 0x0,\r\n"Ethernet/Mac Address", HFILL }},\r\n{ &hf_skinny_matrixConfPartyID,\r\n{\r\n"matrixConfPartyID", "skinny.matrixConfPartyID", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_maxBW,\r\n{\r\n"maxBW", "skinny.maxBW", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_maxBitRate,\r\n{\r\n"maxBitRate", "skinny.maxBitRate", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_maxConferences,\r\n{\r\n"Maximum Number of Concurrent Conferences", "skinny.maxConferences", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Indicates the maximum number of simultansous Conferences, which this client/appliance can handle", HFILL }},\r\n{ &hf_skinny_maxFramesPerPacket,\r\n{\r\n"maxFramesPerPacket", "skinny.maxFramesPerPacket", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_maxNumCalls,\r\n{\r\n"maxNumCalls", "skinny.maxNumCalls", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_maxNumOfAvailLines,\r\n{\r\n"maxNumOfAvailLines", "skinny.maxNumOfAvailLines", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_maxNumberOfLines,\r\n{\r\n"maxNumberOfLines", "skinny.maxNumberOfLines", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Maximum number of lines", HFILL }},\r\n{ &hf_skinny_maxProtocolVer,\r\n{\r\n"maxProtocolVer", "skinny.maxProtocolVer", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_maxRetryNumber,\r\n{\r\n"maxRetryNumber", "skinny.maxRetryNumber", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_maxStreams,\r\n{\r\n"Maximum Number of Concurrent RTP Streams", "skinny.maxStreams", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Indicates the maximum number of simultansous RTP duplex streams, which this client/appliance can handle.", HFILL }},\r\n{ &hf_skinny_maxStreamsPerConf,\r\n{\r\n"maxStreamsPerConf", "skinny.maxStreamsPerConf", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_maximumBitRate,\r\n{\r\n"maximumBitRate", "skinny.maximumBitRate", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_millisecondPacketSize,\r\n{\r\n"millisecondPacketSize", "skinny.millisecondPacketSize", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_minBitRate,\r\n{\r\n"minBitRate", "skinny.minBitRate", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_mixingMode,\r\n{\r\n"mixingMode", "skinny.mixingMode", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_modAnd2833,\r\n{\r\n"modAnd2833", "skinny.modAnd2833", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_modelNumber,\r\n{\r\n"modelNumber", "skinny.modelNumber", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_multicastIpAddr_ipv4,\r\n{\r\n"multicastIpAddr IPv4 Address", "skinny.multicastIpAddr.ipv4", FT_IPv4, BASE_NONE, NULL, 0x0,\r\n"ipaddress in big endian", HFILL }},\r\n{ &hf_skinny_multicastIpAddr_ipv6,\r\n{\r\n"multicastIpAddr IPv6 Address", "skinny.multicastIpAddr.ipv6", FT_IPv6, BASE_NONE, NULL, 0x0,\r\n"ipaddress in big endian", HFILL }},\r\n{ &hf_skinny_multicastPortNumber,\r\n{\r\n"multicastPortNumber", "skinny.multicastPortNumber", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_noaudio,\r\n{\r\n"noaudio", "skinny.noaudio", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_none,\r\n{\r\n"none", "skinny.none", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_nse,\r\n{\r\n"nse", "skinny.nse", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_numNewMsgs,\r\n{\r\n"numNewMsgs", "skinny.numNewMsgs", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_numOldMsgs,\r\n{\r\n"numOldMsgs", "skinny.numOldMsgs", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_numberOctetsReceived,\r\n{\r\n"numberOctetsReceived", "skinny.numberOctetsReceived", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Number of Octets Received", HFILL }},\r\n{ &hf_skinny_numberOctetsSent,\r\n{\r\n"numberOctetsSent", "skinny.numberOctetsSent", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Number of Octets Sent", HFILL }},\r\n{ &hf_skinny_numberOfActiveParticipants,\r\n{\r\n"numberOfActiveParticipants", "skinny.numberOfActiveParticipants", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_numberOfEntries,\r\n{\r\n"numberOfEntries", "skinny.numberOfEntries", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_numberOfGOBs,\r\n{\r\n"numberOfGOBs", "skinny.numberOfGOBs", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_numberOfInServiceStreams,\r\n{\r\n"numberOfInServiceStreams", "skinny.numberOfInServiceStreams", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_numberOfLines,\r\n{\r\n"numberOfLines", "skinny.numberOfLines", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_numberOfMBs,\r\n{\r\n"numberOfMBs", "skinny.numberOfMBs", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_numberOfOutOfServiceStreams,\r\n{\r\n"numberOfOutOfServiceStreams", "skinny.numberOfOutOfServiceStreams", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_numberOfReservedParticipants,\r\n{\r\n"numberOfReservedParticipants", "skinny.numberOfReservedParticipants", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_numberOfSpeedDials,\r\n{\r\n"numberOfSpeedDials", "skinny.numberOfSpeedDials", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_numberPacketsLost,\r\n{\r\n"numberPacketsLost", "skinny.numberPacketsLost", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Number of Packets Lost", HFILL }},\r\n{ &hf_skinny_numberPacketsReceived,\r\n{\r\n"numberPacketsReceived", "skinny.numberPacketsReceived", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Number of Packets Received", HFILL }},\r\n{ &hf_skinny_numberPacketsSent,\r\n{\r\n"numberPacketsSent", "skinny.numberPacketsSent", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Number of Packets Sent", HFILL }},\r\n{ &hf_skinny_originalCdpnRedirectReason,\r\n{\r\n"originalCdpnRedirectReason", "skinny.originalCdpnRedirectReason", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Original Called Party Redirect Reason", HFILL }},\r\n{ &hf_skinny_padding,\r\n{\r\n"padding", "skinny.padding", FT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Unused/Padding", HFILL }},\r\n{ &hf_skinny_parm1,\r\n{\r\n"parm1", "skinny.parm1", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_parm2,\r\n{\r\n"parm2", "skinny.parm2", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_participantEntry,\r\n{\r\n"participantEntry", "skinny.participantEntry", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_partyDirection,\r\n{\r\n"partyDirection", "skinny.partyDirection", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_passThruPartyID,\r\n{\r\n"passThruPartyID", "skinny.passThruPartyID", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"PassThrough PartyId", HFILL }},\r\n{ &hf_skinny_passthruPartyID,\r\n{\r\n"passthruPartyID", "skinny.passthruPartyID", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_payloadDtmf,\r\n{\r\n"payloadDtmf", "skinny.payloadDtmf", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_payloadType,\r\n{\r\n"payloadType", "skinny.payloadType", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_payload_rfc_number,\r\n{\r\n"payload_rfc_number", "skinny.payload.rfc.number", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_peakRate,\r\n{\r\n"peakRate", "skinny.peakRate", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_pictureFormatCount,\r\n{\r\n"pictureFormatCount", "skinny.pictureFormatCount", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_pictureHeight,\r\n{\r\n"pictureHeight", "skinny.pictureHeight", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_pictureNumber,\r\n{\r\n"pictureNumber", "skinny.pictureNumber", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_pictureWidth,\r\n{\r\n"pictureWidth", "skinny.pictureWidth", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_pixelAspectRatio,\r\n{\r\n"pixelAspectRatio", "skinny.pixelAspectRatio", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_portNumber,\r\n{\r\n"portNumber", "skinny.portNumber", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_precedenceDomain,\r\n{\r\n"precedenceDomain", "skinny.precedenceDomain", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Precedence Domain", HFILL }},\r\n{ &hf_skinny_precedenceLevel,\r\n{\r\n"precedenceLevel", "skinny.precedenceLevel", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Precedence Level, MLPP priorities", HFILL }},\r\n{ &hf_skinny_precedenceValue,\r\n{\r\n"precedenceValue", "skinny.precedenceValue", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_preemptionPriority,\r\n{\r\n"preemptionPriority", "skinny.preemptionPriority", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_priority,\r\n{\r\n"priority", "skinny.priority", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_profile,\r\n{\r\n"profile", "skinny.profile", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_protocolDependentData,\r\n{\r\n"protocolDependentData", "skinny.protocolDependentData", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_protocolVer,\r\n{\r\n"Protocol Version", "skinny.protocolVer", FT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Maximum Supported Protocol Version", HFILL }},\r\n{ &hf_skinny_recoveryReferencePictureCount,\r\n{\r\n"recoveryReferencePictureCount", "skinny.recoveryReferencePictureCount", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_remoteIpAddr_ipv4,\r\n{\r\n"remoteIpAddr IPv4 Address", "skinny.remoteIpAddr.ipv4", FT_IPv4, BASE_NONE, NULL, 0x0,\r\n"ipaddress in big endian", HFILL }},\r\n{ &hf_skinny_remoteIpAddr_ipv6,\r\n{\r\n"remoteIpAddr IPv6 Address", "skinny.remoteIpAddr.ipv6", FT_IPv6, BASE_NONE, NULL, 0x0,\r\n"ipaddress in big endian", HFILL }},\r\n{ &hf_skinny_remotePortNumber,\r\n{\r\n"remotePortNumber", "skinny.remotePortNumber", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_reserved_for_future_use,\r\n{\r\n"reserved_for_future_use", "skinny.reserved.for.future.use", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"User Id", HFILL }},\r\n{ &hf_skinny_retryTimer,\r\n{\r\n"retryTimer", "skinny.retryTimer", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_rfc2833,\r\n{\r\n"rfc2833", "skinny.rfc2833", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_routingID,\r\n{\r\n"routingID", "skinny.routingID", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_rsvpErrorFlag,\r\n{\r\n"rsvpErrorFlag", "skinny.rsvpErrorFlag", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_rsvpErrorSubCodeVal,\r\n{\r\n"rsvpErrorSubCodeVal", "skinny.rsvpErrorSubCodeVal", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_rtpMediaPort,\r\n{\r\n"rtpMediaPort", "skinny.rtpMediaPort", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"RTP Media Port", HFILL }},\r\n{ &hf_skinny_salt,\r\n{\r\n"salt", "skinny.salt", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_saltlen,\r\n{\r\n"saltlen", "skinny.saltlen", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_secondaryKeepAliveInterval,\r\n{\r\n"secondaryKeepAliveInterval", "skinny.secondaryKeepAliveInterval", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_serverTcpListenPort,\r\n{\r\n"serverTcpListenPort", "skinny.serverTcpListenPort", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_serviceNum,\r\n{\r\n"serviceNum", "skinny.serviceNum", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_serviceNumber,\r\n{\r\n"serviceNumber", "skinny.serviceNumber", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_serviceResourceCount,\r\n{\r\n"serviceResourceCount", "skinny.serviceResourceCount", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_serviceURLIndex,\r\n{\r\n"serviceURLIndex", "skinny.serviceURLIndex", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_softKeyCount,\r\n{\r\n"softKeyCount", "skinny.softKeyCount", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_softKeyOffset,\r\n{\r\n"softKeyOffset", "skinny.softKeyOffset", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_softKeySetCount,\r\n{\r\n"softKeySetCount", "skinny.softKeySetCount", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_softKeySetOffset,\r\n{\r\n"softKeySetOffset", "skinny.softKeySetOffset", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_sourceIpAddr_ipv4,\r\n{\r\n"sourceIpAddr IPv4 Address", "skinny.sourceIpAddr.ipv4", FT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_sourceIpAddr_ipv6,\r\n{\r\n"sourceIpAddr IPv6 Address", "skinny.sourceIpAddr.ipv6", FT_IPv6, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_sourcePortNumber,\r\n{\r\n"sourcePortNumber", "skinny.sourcePortNumber", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_speedDialNumber,\r\n{\r\n"speedDialNumber", "skinny.speedDialNumber", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_sse,\r\n{\r\n"sse", "skinny.sse", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_standard,\r\n{\r\n"standard", "skinny.standard", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_startingLineInstance,\r\n{\r\n"startingLineInstance", "skinny.startingLineInstance", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Starting Line Instance", HFILL }},\r\n{ &hf_skinny_stationIpAddr,\r\n{\r\n"stationIpAddr", "skinny.stationIpAddr", FT_IPv4, BASE_NONE, NULL, 0x0,\r\n"IPv4 Address", HFILL }},\r\n{ &hf_skinny_stationIpAddr_ipv4,\r\n{\r\n"stationIpAddr IPv4 Address", "skinny.stationIpAddr.ipv4", FT_IPv4, BASE_NONE, NULL, 0x0,\r\n"ipaddress in big endian", HFILL }},\r\n{ &hf_skinny_stationIpAddr_ipv6,\r\n{\r\n"stationIpAddr IPv6 Address", "skinny.stationIpAddr.ipv6", FT_IPv6, BASE_NONE, NULL, 0x0,\r\n"ipaddress in big endian", HFILL }},\r\n{ &hf_skinny_stationIpV6Addr,\r\n{\r\n"stationIpV6Addr", "skinny.stationIpV6Addr", FT_IPv6, BASE_NONE, NULL, 0x0,\r\n"IPv6 Address", HFILL }},\r\n{ &hf_skinny_stationIpV6Addr_ipv4,\r\n{\r\n"stationIpV6Addr IPv4 Address", "skinny.stationIpV6Addr.ipv4", FT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_stationIpV6Addr_ipv6,\r\n{\r\n"stationIpV6Addr IPv6 Address", "skinny.stationIpV6Addr.ipv6", FT_IPv6, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_stillImageTransmission,\r\n{\r\n"stillImageTransmission", "skinny.stillImageTransmission", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Still Image Transmission", HFILL }},\r\n{ &hf_skinny_stimulusInstance,\r\n{\r\n"stimulusInstance", "skinny.stimulusInstance", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_stimulusStatus,\r\n{\r\n"stimulusStatus", "skinny.stimulusStatus", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Stimulus Status", HFILL }},\r\n{ &hf_skinny_streamPassThroughID,\r\n{\r\n"streamPassThroughID", "skinny.streamPassThroughID", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_systemTime,\r\n{\r\n"systemTime", "skinny.systemTime", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_temporalSpatialTradeOff,\r\n{\r\n"temporalSpatialTradeOff", "skinny.temporalSpatialTradeOff", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_temporalSpatialTradeOffCapability,\r\n{\r\n"temporalSpatialTradeOffCapability", "skinny.temporalSpatialTradeOffCapability", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Temporal spatial trade off capability", HFILL }},\r\n{ &hf_skinny_timeOutValue,\r\n{\r\n"timeOutValue", "skinny.timeOutValue", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_timer,\r\n{\r\n"timer", "skinny.timer", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_totalButtonCount,\r\n{\r\n"totalButtonCount", "skinny.totalButtonCount", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_totalNumOfConfiguredLines,\r\n{\r\n"totalNumOfConfiguredLines", "skinny.totalNumOfConfiguredLines", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Total Number of Configured Lines", HFILL }},\r\n{ &hf_skinny_totalSoftKeyCount,\r\n{\r\n"totalSoftKeyCount", "skinny.totalSoftKeyCount", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_totalSoftKeySetCount,\r\n{\r\n"totalSoftKeySetCount", "skinny.totalSoftKeySetCount", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_transactionID,\r\n{\r\n"transactionID", "skinny.transactionID", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_transmitIpAddr_ipv4,\r\n{\r\n"transmitIpAddr IPv4 Address", "skinny.transmitIpAddr.ipv4", FT_IPv4, BASE_NONE, NULL, 0x0,\r\n"ipaddress in big endian", HFILL }},\r\n{ &hf_skinny_transmitIpAddr_ipv6,\r\n{\r\n"transmitIpAddr IPv6 Address", "skinny.transmitIpAddr.ipv6", FT_IPv6, BASE_NONE, NULL, 0x0,\r\n"ipaddress in big endian", HFILL }},\r\n{ &hf_skinny_transmitPort,\r\n{\r\n"transmitPort", "skinny.transmitPort", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_transmitPreference,\r\n{\r\n"transmitPreference", "skinny.transmitPreference", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_unknown,\r\n{\r\n"unknown", "skinny.unknown", FT_UINT8, BASE_DEC, NULL, 0x0,\r\n"unknown (Part of ProtocolVer)", HFILL }},\r\n{ &hf_skinny_unknown1_0159,\r\n{\r\n"unknown1_0159", "skinny.unknown1.0159", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_unknown2_0159,\r\n{\r\n"unknown2_0159", "skinny.unknown2.0159", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_unknown3_0159,\r\n{\r\n"unknown3_0159", "skinny.unknown3.0159", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_v150sprt,\r\n{\r\n"v150sprt", "skinny.v150sprt", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_vendor,\r\n{\r\n"vendor", "skinny.vendor", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_videoCapCount,\r\n{\r\n"videoCapCount", "skinny.videoCapCount", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_wDay,\r\n{\r\n"wDay", "skinny.wDay", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_wDayOfWeek,\r\n{\r\n"wDayOfWeek", "skinny.wDayOfWeek", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_wHour,\r\n{\r\n"wHour", "skinny.wHour", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_wMilliseconds,\r\n{\r\n"wMilliseconds", "skinny.wMilliseconds", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_wMinute,\r\n{\r\n"wMinute", "skinny.wMinute", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_wMonth,\r\n{\r\n"wMonth", "skinny.wMonth", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_wSecond,\r\n{\r\n"wSecond", "skinny.wSecond", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_wYear,\r\n{\r\n"wYear", "skinny.wYear", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_waitTimeBeforeNextReq,\r\n{\r\n"waitTimeBeforeNextReq", "skinny.waitTimeBeforeNextReq", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_skinny_xmldata,\r\n{\r\n"xmldata", "skinny.xmldata", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_AlternateCallingParty,\r\n{\r\n"AlternateCallingParty", "skinny.AlternateCallingParty", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"Alternate Calling Party Number", HFILL }},\r\n{&hf_skinny_DeviceName,\r\n{\r\n"DeviceName", "skinny.DeviceName", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"Device Name", HFILL }},\r\n{&hf_skinny_HuntPilotName,\r\n{\r\n"HuntPilotName", "skinny.HuntPilotName", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_HuntPilotNumber,\r\n{\r\n"HuntPilotNumber", "skinny.HuntPilotNumber", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_ServerName,\r\n{\r\n"ServerName", "skinny.ServerName", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_add_participant_result,\r\n{\r\n"add_participant_result", "skinny.add.participant.result", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &AddParticipantResult_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_alarmSeverity,\r\n{\r\n"alarmSeverity", "skinny.alarmSeverity", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &DeviceAlarmSeverity_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_algorithmID,\r\n{\r\n"algorithmID", "skinny.algorithmID", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &MediaEncryptionAlgorithmType_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_annAckReq,\r\n{\r\n"annAckReq", "skinny.annAckReq", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &EndOfAnnAck_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_annPlayMode,\r\n{\r\n"annPlayMode", "skinny.annPlayMode", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &AnnPlayMode_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_annStatus,\r\n{\r\n"annStatus", "skinny.annStatus", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &PlayAnnStatus_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_appConfID,\r\n{\r\n"appConfID", "skinny.appConfID", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_appData,\r\n{\r\n"appData", "skinny.appData", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_appName,\r\n{\r\n"appName", "skinny.appName", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_audit_participant_result,\r\n{\r\n"audit_participant_result", "skinny.audit.participant.result", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &AuditParticipantResult_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_bridgeParticipantId,\r\n{\r\n"bridgeParticipantId", "skinny.bridgeParticipantId", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_buttonDefinition,\r\n{\r\n"buttonDefinition", "skinny.buttonDefinition", FT_UINT8, BASE_HEX | BASE_EXT_STRING, &ButtonType_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_callHistoryDisposition,\r\n{\r\n"callHistoryDisposition", "skinny.callHistoryDisposition", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &CallHistoryDisposition_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_callSecurityStatus,\r\n{\r\n"callSecurityStatus", "skinny.callSecurityStatus", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &CallSecurityStatusType_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_callState,\r\n{\r\n"callState", "skinny.callState", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &DCallState_ext, 0x0,\r\n"CallState", HFILL }},\r\n{&hf_skinny_callType,\r\n{\r\n"callType", "skinny.callType", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &CallType_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_calledParty,\r\n{\r\n"calledParty", "skinny.calledParty", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"CalledPartyNumber", HFILL }},\r\n{&hf_skinny_calledPartyName,\r\n{\r\n"calledPartyName", "skinny.calledPartyName", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"Called Party Name", HFILL }},\r\n{&hf_skinny_callingParty,\r\n{\r\n"callingParty", "skinny.callingParty", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"Calling Party Number", HFILL }},\r\n{&hf_skinny_callingPartyName,\r\n{\r\n"callingPartyName", "skinny.callingPartyName", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"Calling Party Name", HFILL }},\r\n{&hf_skinny_callingPartyNumber,\r\n{\r\n"callingPartyNumber", "skinny.callingPartyNumber", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"Calling Party Number", HFILL }},\r\n{&hf_skinny_cause,\r\n{\r\n"cause", "skinny.cause", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &SubscribeCause_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_cdpnVoiceMailbox,\r\n{\r\n"cdpnVoiceMailbox", "skinny.cdpnVoiceMailbox", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"Called Party Voicemail Box Number", HFILL }},\r\n{&hf_skinny_cgpnVoiceMailbox,\r\n{\r\n"cgpnVoiceMailbox", "skinny.cgpnVoiceMailbox", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"Calling Party Voicemail Box Number", HFILL }},\r\n{&hf_skinny_command,\r\n{\r\n"command", "skinny.command", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &MiscCommandType_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_compressionType,\r\n{\r\n"compressionType", "skinny.compressionType", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &Media_PayloadType_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_conferenceName,\r\n{\r\n"conferenceName", "skinny.conferenceName", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_configVersionStamp,\r\n{\r\n"configVersionStamp", "skinny.configVersionStamp", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_data,\r\n{\r\n"Statistics", "skinny.data", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"variable field size (max: 600]", HFILL }},\r\n{&hf_skinny_dataCapabilityDirection,\r\n{\r\n"dataCapabilityDirection", "skinny.dataCapabilityDirection", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &TransmitOrReceive_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_dateTemplate,\r\n{\r\n"dateTemplate", "skinny.dateTemplate", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_delete_conf_result,\r\n{\r\n"delete_conf_result", "skinny.delete.conf.result", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &DeleteConfResult_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_deviceType,\r\n{\r\n"Device Type", "skinny.deviceType", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &DeviceType_ext, 0x0,\r\n"Device Type of this phone / appliance", HFILL }},\r\n{&hf_skinny_dialedNumber,\r\n{\r\n"dialedNumber", "skinny.dialedNumber", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_direction,\r\n{\r\n"direction", "skinny.direction", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &RSVPDirection_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_directoryNum,\r\n{\r\n"directoryNum", "skinny.directoryNum", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"Directory Number", HFILL }},\r\n{&hf_skinny_ecValue,\r\n{\r\n"ecValue", "skinny.ecValue", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &Media_EchoCancellation_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_encryptionCapability,\r\n{\r\n"encryptionCapability", "skinny.encryptionCapability", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &Media_Encryption_Capability_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_errorCode,\r\n{\r\n"errorCode", "skinny.errorCode", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &QoSErrorCode_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_featureID,\r\n{\r\n"featureID", "skinny.featureID", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &ButtonType_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_featureTextLabel,\r\n{\r\n"featureTextLabel", "skinny.featureTextLabel", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_firmwareLoadName,\r\n{\r\n"firmwareLoadName", "skinny.firmwareLoadName", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"Firmware Load Name", HFILL }},\r\n{&hf_skinny_forwardAllDirnum,\r\n{\r\n"forwardAllDirnum", "skinny.forwardAllDirnum", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_forwardBusyDirnum,\r\n{\r\n"forwardBusyDirnum", "skinny.forwardBusyDirnum", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_forwardNoAnswerlDirnum,\r\n{\r\n"forwardNoAnswerlDirnum", "skinny.forwardNoAnswerlDirnum", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_g723BitRate,\r\n{\r\n"g723BitRate", "skinny.g723BitRate", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &Media_G723BitRate_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_headsetStatus,\r\n{\r\n"headsetStatus", "skinny.headsetStatus", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &HeadsetMode_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_ipAddressType,\r\n{\r\n"ipAddressType", "skinny.ipAddressType", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &IpAddrType_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_ipAddressingMode,\r\n{\r\n"ipAddressingMode", "skinny.ipAddressingMode", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &IpAddrMode_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_kpButton,\r\n{\r\n"kpButton", "skinny.kpButton", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &KeyPadButton_ext, 0x0,\r\n"KeyPad Button which was Pressed", HFILL }},\r\n{&hf_skinny_lampMode,\r\n{\r\n"lampMode", "skinny.lampMode", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &LampMode_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_lastRedirectingParty,\r\n{\r\n"lastRedirectingParty", "skinny.lastRedirectingParty", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"Last Redirecting Party Number", HFILL }},\r\n{&hf_skinny_lastRedirectingPartyName,\r\n{\r\n"lastRedirectingPartyName", "skinny.lastRedirectingPartyName", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"Last Redirecting Party Name", HFILL }},\r\n{&hf_skinny_lastRedirectingVoiceMailbox,\r\n{\r\n"lastRedirectingVoiceMailbox", "skinny.lastRedirectingVoiceMailbox", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"Last Redirecting Parties Voicemail Box Number", HFILL }},\r\n{&hf_skinny_layouts,\r\n{\r\n"layouts", "skinny.layouts", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &Layout_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_lineDirNumber,\r\n{\r\n"lineDirNumber", "skinny.lineDirNumber", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_lineFullyQualifiedDisplayName,\r\n{\r\n"lineFullyQualifiedDisplayName", "skinny.lineFullyQualifiedDisplayName", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_lineTextLabel,\r\n{\r\n"lineTextLabel", "skinny.lineTextLabel", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_locationInfo,\r\n{\r\n"locationInfo", "skinny.locationInfo", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_mediaPathCapabilities,\r\n{\r\n"mediaPathCapabilities", "skinny.mediaPathCapabilities", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &MediaPathCapabilities_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_mediaPathEvent,\r\n{\r\n"mediaPathEvent", "skinny.mediaPathEvent", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &MediaPathEvent_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_mediaPathID,\r\n{\r\n"mediaPathID", "skinny.mediaPathID", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &MediaPathID_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_mediaTransportType,\r\n{\r\n"mediaTransportType", "skinny.mediaTransportType", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &MediaTransportType_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_mediaType,\r\n{\r\n"mediaType", "skinny.mediaType", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &MediaType_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_micMode,\r\n{\r\n"micMode", "skinny.micMode", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &MicrophoneMode_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_modify_conf_result,\r\n{\r\n"modify_conf_result", "skinny.modify.conf.result", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &ModifyConfResult_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_multimediaOpenReceiveChannelStatus,\r\n{\r\n"multimediaOpenReceiveChannelStatus", "skinny.multimediaOpenReceiveChannelStatus", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &OpenReceiveChanStatus_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_mwiControlNumber,\r\n{\r\n"mwiControlNumber", "skinny.mwiControlNumber", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_mwiTargetNumber,\r\n{\r\n"mwiTargetNumber", "skinny.mwiTargetNumber", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_mwi_notification_result,\r\n{\r\n"mwi_notification_result", "skinny.mwi.notification.result", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &MwiNotificationResult_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_notify,\r\n{\r\n"notify", "skinny.notify", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_openReceiveChannelStatus,\r\n{\r\n"openReceiveChannelStatus", "skinny.openReceiveChannelStatus", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &MediaStatus_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_originalCalledParty,\r\n{\r\n"originalCalledParty", "skinny.originalCalledParty", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"Original Called Party Number", HFILL }},\r\n{&hf_skinny_originalCalledPartyName,\r\n{\r\n"originalCalledPartyName", "skinny.originalCalledPartyName", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"Original Called Party Name", HFILL }},\r\n{&hf_skinny_originalCdpnVoiceMailbox,\r\n{\r\n"originalCdpnVoiceMailbox", "skinny.originalCdpnVoiceMailbox", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"Original Called Party Voicemail Box Number", HFILL }},\r\n{&hf_skinny_participantName,\r\n{\r\n"participantName", "skinny.participantName", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_participantNumber,\r\n{\r\n"participantNumber", "skinny.participantNumber", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_passThruData,\r\n{\r\n"passThruData", "skinny.passThruData", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"variable field size (max: 2000]", HFILL }},\r\n{&hf_skinny_payloadCapability,\r\n{\r\n"payloadCapability", "skinny.payloadCapability", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &Media_PayloadType_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_portHandlingFlag,\r\n{\r\n"portHandlingFlag", "skinny.portHandlingFlag", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &PortHandling_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_privacy,\r\n{\r\n"privacy", "skinny.privacy", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &CallPrivacy_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_promptStatus,\r\n{\r\n"promptStatus", "skinny.promptStatus", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_receptionStatus,\r\n{\r\n"receptionStatus", "skinny.receptionStatus", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &MulticastMediaReceptionStatus_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_recording_status,\r\n{\r\n"recording_status", "skinny.recording.status", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &RecordingStatus_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_requestedIpAddrType,\r\n{\r\n"requestedIpAddrType", "skinny.requestedIpAddrType", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &IpAddrType_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_resetType,\r\n{\r\n"resetType", "skinny.resetType", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &DeviceResetType_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_resourceType,\r\n{\r\n"resourceType", "skinny.resourceType", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &ResourceType_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_result,\r\n{\r\n"result", "skinny.result", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &CreateConfResult_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_resultCode,\r\n{\r\n"resultCode", "skinny.resultCode", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &MediaStatus_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_resvStyle,\r\n{\r\n"resvStyle", "skinny.resvStyle", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &ResvStyle_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_ringDuration,\r\n{\r\n"ringDuration", "skinny.ringDuration", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &RingDuration_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_ringMode,\r\n{\r\n"ringMode", "skinny.ringMode", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &RingMode_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_rsvpErrorCode,\r\n{\r\n"rsvpErrorCode", "skinny.rsvpErrorCode", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &RSVPErrorCode_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_sequenceFlag,\r\n{\r\n"sequenceFlag", "skinny.sequenceFlag", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &SequenceFlag_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_serverName,\r\n{\r\n"serverName", "skinny.serverName", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_serviceURL,\r\n{\r\n"serviceURL", "skinny.serviceURL", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_serviceURLDisplayName,\r\n{\r\n"serviceURLDisplayName", "skinny.serviceURLDisplayName", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_sessionType,\r\n{\r\n"sessionType", "skinny.sessionType", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &SessionType_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_softKeyEvent,\r\n{\r\n"softKeyEvent", "skinny.softKeyEvent", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &SoftKeyEvent_ext, 0x0,\r\n"SoftKey Event", HFILL }},\r\n{&hf_skinny_softKeyInfoIndex,\r\n{\r\n"softKeyInfoIndex", "skinny.softKeyInfoIndex", FT_UINT16, BASE_HEX | BASE_EXT_STRING, &SoftKeyInfoIndex_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_softKeyLabel,\r\n{\r\n"softKeyLabel", "skinny.softKeyLabel", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_softKeySetIndex,\r\n{\r\n"softKeySetIndex", "skinny.softKeySetIndex", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &SoftKeySet_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_softKeyTemplateIndex,\r\n{\r\n"softKeyTemplateIndex", "skinny.softKeyTemplateIndex", FT_UINT8, BASE_HEX | BASE_EXT_STRING, &SoftKeyTemplateIndex_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_speakerMode,\r\n{\r\n"speakerMode", "skinny.speakerMode", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &SpeakerMode_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_speedDialDirNumber,\r\n{\r\n"speedDialDirNumber", "skinny.speedDialDirNumber", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_speedDialDisplayName,\r\n{\r\n"speedDialDisplayName", "skinny.speedDialDisplayName", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_ssValue,\r\n{\r\n"ssValue", "skinny.ssValue", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &Media_SilenceSuppression_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_startMediaTransmissionStatus,\r\n{\r\n"startMediaTransmissionStatus", "skinny.startMediaTransmissionStatus", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &MediaStatus_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_statsProcessingMode,\r\n{\r\n"Stats Processing Mode", "skinny.statsProcessingMode", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &StatsProcessingType_ext, 0x0,\r\n"What do do after you send the stats", HFILL }},\r\n{&hf_skinny_status,\r\n{\r\n"status", "skinny.status", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &DeviceUnregisterStatus_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_stimulus,\r\n{\r\n"stimulus", "skinny.stimulus", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &DeviceStimulus_ext, 0x0,\r\n"Device Stimulus", HFILL }},\r\n{&hf_skinny_subAppID,\r\n{\r\n"subAppID", "skinny.subAppID", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_subcriptionFeatureID,\r\n{\r\n"subcriptionFeatureID", "skinny.subcriptionFeatureID", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &SubscriptionFeatureID_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_subscriptionFeatureID,\r\n{\r\n"subscriptionFeatureID", "skinny.subscriptionFeatureID", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &SubscriptionFeatureID_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_subscriptionID,\r\n{\r\n"subscriptionID", "skinny.subscriptionID", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_subscriptionoFeatureID,\r\n{\r\n"subscriptionoFeatureID", "skinny.subscriptionoFeatureID", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &SubscriptionFeatureID_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_text,\r\n{\r\n"text", "skinny.text", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_tone,\r\n{\r\n"tone", "skinny.tone", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &DeviceTone_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_toneAnnouncement,\r\n{\r\n"toneAnnouncement", "skinny.toneAnnouncement", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &DeviceTone_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_tone_output_direction,\r\n{\r\n"tone_output_direction", "skinny.tone.output.direction", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &ToneOutputDirection_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_unRegReasonCode,\r\n{\r\n"unRegReasonCode", "skinny.unRegReasonCode", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &UnRegReasonCode_ext, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_unknownString_0159,\r\n{\r\n"unknownString_0159", "skinny.unknownString.0159", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_userName,\r\n{\r\n"userName", "skinny.userName", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_vendorID,\r\n{\r\n"vendorID", "skinny.vendorID", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_version,\r\n{\r\n"version", "skinny.version", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{&hf_skinny_videoCapabilityDirection,\r\n{\r\n"videoCapabilityDirection", "skinny.videoCapabilityDirection", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &TransmitOrReceive_ext, 0x0,\r\nNULL, HFILL }},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_skinny,\r\n&ett_skinny_tree,\r\n};\r\nmodule_t *skinny_module;\r\nproto_skinny = proto_register_protocol("Skinny Client Control Protocol",\r\n"SKINNY", "skinny");\r\nproto_register_field_array(proto_skinny, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nskinny_module = prefs_register_protocol(proto_skinny, NULL);\r\nprefs_register_bool_preference(skinny_module, "desegment",\r\n"Reassemble SCCP messages spanning multiple TCP segments",\r\n"Whether the SCCP dissector should reassemble messages spanning multiple TCP segments."\r\n" To use this option, you must also enable"\r\n" \"Allow subdissectors to reassemble TCP streams\" in the TCP protocol settings.",\r\n&skinny_desegment);\r\nskinny_handle = register_dissector("skinny", dissect_skinny, proto_skinny);\r\nskinny_tap = register_tap("skinny");\r\n}\r\nvoid\r\nproto_reg_handoff_skinny(void)\r\n{\r\nmedia_type_dissector_table = find_dissector_table("media_type");\r\ndissector_add_uint("tcp.port", TCP_PORT_SKINNY, skinny_handle);\r\nssl_dissector_add(SSL_PORT_SKINNY, skinny_handle);\r\n}
