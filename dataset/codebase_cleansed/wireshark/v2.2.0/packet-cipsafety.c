void\r\ndissect_unid(tvbuff_t *tvb, packet_info *pinfo, int offset, proto_item *pi,\r\nconst char* ssn_name, int hf_ssn_timestamp,\r\nint hf_ssn_date, int hf_ssn_time, int hf_macid, gint ett, gint ett_ssn)\r\n{\r\nproto_tree *tree, *ssn_tree;\r\ntree = proto_item_add_subtree(pi, ett);\r\nssn_tree = proto_tree_add_subtree(tree, tvb, offset, 6, ett_ssn, NULL, ssn_name);\r\ndissect_cipsafety_ssn(ssn_tree, tvb, pinfo, offset, hf_ssn_timestamp, hf_ssn_date, hf_ssn_time);\r\nproto_tree_add_item(tree, hf_macid, tvb, offset+6, 4, ENC_LITTLE_ENDIAN);\r\n}\r\nvoid dissect_cipsafety_ssn(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo _U_, int offset,\r\nint hf_real_datetime, int hf_date, int hf_time)\r\n{\r\nguint16 date;\r\ndate = tvb_get_letohs( tvb, offset);\r\nif ((date >= 11688) && (date <= 65534))\r\n{\r\ndissect_cip_date_and_time(tree, tvb, offset, hf_real_datetime);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_date, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_time, tvb, offset+2, 4, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_cip_s_supervisor_data( proto_tree *item_tree,\r\ntvbuff_t *tvb, int offset, int item_length, packet_info *pinfo )\r\n{\r\nproto_item *pi, *rrsc_item;\r\nproto_tree *rrsc_tree, *cmd_data_tree, *bitmap_tree;\r\nint req_path_size;\r\nint temp_data;\r\nguint8 service, gen_status, add_stat_size;\r\ncip_req_info_t* preq_info;\r\ncip_simple_request_info_t req_data;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "CIPS Supervisor");\r\nservice = tvb_get_guint8( tvb, offset );\r\nrrsc_tree = proto_tree_add_subtree( item_tree, tvb, offset, 1, ett_ssupervisor_rrsc, &rrsc_item, "Service: " );\r\nproto_tree_add_item( rrsc_tree, hf_cip_reqrsp, tvb, offset, 1, ENC_LITTLE_ENDIAN );\r\nproto_item_append_text( rrsc_item, "%s (%s)",\r\nval_to_str( ( service & 0x7F ), cip_sc_vals_ssupervisor , "Unknown Service (0x%02x)"),\r\nval_to_str_const( ( service & 0x80 )>>7, cip_sc_rr, "") );\r\nproto_tree_add_item(rrsc_tree, hf_cip_ssupervisor_sc, tvb, offset, 1, ENC_LITTLE_ENDIAN );\r\npreq_info = (cip_req_info_t*)p_get_proto_data(wmem_file_scope(), pinfo, proto_cip, 0);\r\nif ((preq_info != NULL) &&\r\n(preq_info->ciaData != NULL))\r\n{\r\nmemcpy(&req_data, preq_info->ciaData, sizeof(cip_simple_request_info_t));\r\n}\r\nelse\r\n{\r\nreq_data.iClass = (guint32)-1;\r\nreq_data.iInstance = (guint32)-1;\r\nreq_data.iAttribute = (guint32)-1;\r\nreq_data.iMember = (guint32)-1;\r\n}\r\nif(service & 0x80 )\r\n{\r\ngen_status = tvb_get_guint8( tvb, offset+2 );\r\nadd_stat_size = tvb_get_guint8( tvb, offset+3 ) * 2;\r\nif( ( item_length-4-add_stat_size ) != 0 )\r\n{\r\ncmd_data_tree = proto_tree_add_subtree( item_tree, tvb, offset+4+add_stat_size,\r\nitem_length-4-add_stat_size, ett_ssupervisor_cmd_data, NULL, "Command Specific Data" );\r\nif( gen_status == CI_GRC_SUCCESS || gen_status == CI_GRC_SERVICE_ERROR )\r\n{\r\nswitch (service & 0x7F)\r\n{\r\ncase SC_SSUPER_VALIDATE_CONFIGURATION:\r\nproto_tree_add_item(cmd_data_tree, hf_cip_ssupervisor_validate_configuration_sccrc,\r\ntvb, offset+4+add_stat_size, 4, ENC_LITTLE_ENDIAN);\r\ndissect_cipsafety_ssn(cmd_data_tree,\r\ntvb, pinfo, offset+4+add_stat_size+4,\r\nhf_cip_ssupervisor_validate_configuration_scts_timestamp,\r\nhf_cip_ssupervisor_validate_configuration_scts_date,\r\nhf_cip_ssupervisor_validate_configuration_scts_time);\r\nbreak;\r\n}\r\n}\r\nelse if ((gen_status == 0xD0) && ((service & 0x7F) == SC_SSUPER_VALIDATE_CONFIGURATION))\r\n{\r\nif (add_stat_size > 0)\r\n{\r\nproto_tree_add_item(cmd_data_tree, hf_cip_ssupervisor_validate_configuration_ext_error,\r\ntvb, offset+4, 2, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(cmd_data_tree, hf_cip_data,\r\ntvb, offset+4+add_stat_size, item_length-4-add_stat_size, ENC_NA);\r\n}\r\n}\r\n}\r\nelse\r\n{\r\nreq_path_size = tvb_get_guint8( tvb, offset+1 )*2;\r\nif( (item_length-req_path_size-2) != 0 )\r\n{\r\ncmd_data_tree = proto_tree_add_subtree( item_tree, tvb, offset+2+req_path_size, item_length-req_path_size-2,\r\nett_ssupervisor_cmd_data, NULL, "Command Specific Data" );\r\nswitch (service)\r\n{\r\ncase SC_SSUPER_RECOVER:\r\nproto_tree_add_item(cmd_data_tree, hf_cip_ssupervisor_recover_data,\r\ntvb, offset+2+req_path_size, item_length-req_path_size-2, ENC_NA);\r\nbreak;\r\ncase SC_SSUPER_PERFORM_DIAGNOSTICS:\r\nproto_tree_add_item(cmd_data_tree, hf_cip_ssupervisor_perform_diag_data,\r\ntvb, offset+2+req_path_size, item_length-req_path_size-2, ENC_NA);\r\nbreak;\r\ncase SC_SSUPER_CONFIGURE_REQUEST:\r\nproto_tree_add_item(cmd_data_tree, hf_cip_ssupervisor_configure_request_password,\r\ntvb, offset+2+req_path_size, 16, ENC_NA);\r\npi = proto_tree_add_item(cmd_data_tree, hf_cip_ssupervisor_configure_request_tunid,\r\ntvb, offset+2+req_path_size+16, 10, ENC_NA);\r\ndissect_unid(tvb, pinfo, offset+2+req_path_size+16, pi, "TUNID SSN",\r\nhf_cip_ssupervisor_configure_request_tunid_ssn_timestamp,\r\nhf_cip_ssupervisor_configure_request_tunid_ssn_date,\r\nhf_cip_ssupervisor_configure_request_tunid_ssn_time,\r\nhf_cip_ssupervisor_configure_request_tunid_macid,\r\nett_ssupervisor_configure_request_tunid,\r\nett_ssupervisor_configure_request_tunid_ssn);\r\npi = proto_tree_add_item(cmd_data_tree, hf_cip_ssupervisor_configure_request_ounid,\r\ntvb, offset+2+req_path_size+26, 10, ENC_NA);\r\ndissect_unid(tvb, pinfo, offset+2+req_path_size+16, pi, "OUNID SSN",\r\nhf_cip_ssupervisor_configure_request_ounid_ssn_timestamp,\r\nhf_cip_ssupervisor_configure_request_ounid_ssn_date,\r\nhf_cip_ssupervisor_configure_request_ounid_ssn_time,\r\nhf_cip_ssupervisor_configure_request_ounid_macid,\r\nett_ssupervisor_configure_request_ounid,\r\nett_ssupervisor_configure_request_ounid_ssn);\r\nbreak;\r\ncase SC_SSUPER_VALIDATE_CONFIGURATION:\r\nproto_tree_add_item(cmd_data_tree, hf_cip_ssupervisor_validate_configuration_sccrc,\r\ntvb, offset+2+req_path_size, 4, ENC_LITTLE_ENDIAN);\r\ndissect_cipsafety_ssn(cmd_data_tree, tvb, pinfo, offset+2+req_path_size+4,\r\nhf_cip_ssupervisor_validate_configuration_scts_timestamp,\r\nhf_cip_ssupervisor_validate_configuration_scts_date,\r\nhf_cip_ssupervisor_validate_configuration_scts_time);\r\nbreak;\r\ncase SC_SSUPER_SET_PASSWORD:\r\nproto_tree_add_item(cmd_data_tree, hf_cip_ssupervisor_set_password_current_password,\r\ntvb, offset+2+req_path_size, 16, ENC_NA);\r\nproto_tree_add_item(cmd_data_tree, hf_cip_ssupervisor_set_password_new_password,\r\ntvb, offset+2+req_path_size+16, 16, ENC_NA);\r\nbreak;\r\ncase SC_SSUPER_CONFIGURATION_LOCK:\r\nproto_tree_add_item(cmd_data_tree, hf_cip_ssupervisor_configure_lock_value,\r\ntvb, offset+2+req_path_size+1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cmd_data_tree, hf_cip_ssupervisor_configure_lock_password,\r\ntvb, offset+2+req_path_size+1, 16, ENC_NA);\r\npi = proto_tree_add_item(cmd_data_tree, hf_cip_ssupervisor_configure_lock_tunid,\r\ntvb, offset+2+req_path_size+17, 10, ENC_NA);\r\ndissect_unid(tvb, pinfo, offset+2+req_path_size+17, pi, "TUNID SSN",\r\nhf_cip_ssupervisor_configure_lock_tunid_ssn_timestamp,\r\nhf_cip_ssupervisor_configure_lock_tunid_ssn_date,\r\nhf_cip_ssupervisor_configure_lock_tunid_ssn_time,\r\nhf_cip_ssupervisor_configure_lock_tunid_macid,\r\nett_ssupervisor_configure_lock_tunid,\r\nett_ssupervisor_configure_lock_tunid_ssn);\r\nbreak;\r\ncase SC_SSUPER_MODE_CHANGE:\r\nproto_tree_add_item(cmd_data_tree, hf_cip_ssupervisor_mode_change_value,\r\ntvb, offset+2+req_path_size+1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cmd_data_tree, hf_cip_ssupervisor_mode_change_password,\r\ntvb, offset+2+req_path_size+1, 16, ENC_NA);\r\nbreak;\r\ncase SC_SSUPER_SAFETY_RESET:\r\nproto_tree_add_item(cmd_data_tree, hf_cip_ssupervisor_reset_type,\r\ntvb, offset+2+req_path_size+1, 1, ENC_LITTLE_ENDIAN);\r\ntemp_data = tvb_get_guint8( tvb, offset+2+req_path_size+1 );\r\nproto_tree_add_item(cmd_data_tree, hf_cip_ssupervisor_reset_password,\r\ntvb, offset+2+req_path_size+1, 16, ENC_NA);\r\npi = proto_tree_add_item(cmd_data_tree, hf_cip_ssupervisor_reset_tunid,\r\ntvb, offset+2+req_path_size+17, 10, ENC_NA);\r\ndissect_unid(tvb, pinfo, offset+2+req_path_size+17, pi, "TUNID SSN",\r\nhf_cip_ssupervisor_reset_tunid_tunid_ssn_timestamp,\r\nhf_cip_ssupervisor_reset_tunid_tunid_ssn_date,\r\nhf_cip_ssupervisor_reset_tunid_tunid_ssn_time,\r\nhf_cip_ssupervisor_reset_tunid_macid,\r\nett_ssupervisor_reset_tunid,\r\nett_ssupervisor_reset_tunid_ssn);\r\nif (temp_data == 2)\r\n{\r\npi = proto_tree_add_item(cmd_data_tree, hf_cip_ssupervisor_reset_attr_bitmap,\r\ntvb, offset+2+req_path_size+27, 1, ENC_LITTLE_ENDIAN);\r\nbitmap_tree = proto_item_add_subtree(pi, ett_cip_ssupervisor_reset_attr_bitmap);\r\nproto_tree_add_item(bitmap_tree, hf_cip_ssupervisor_reset_attr_bitmap_macid,\r\ntvb, offset+2+req_path_size+27, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(bitmap_tree, hf_cip_ssupervisor_reset_attr_bitmap_baudrate,\r\ntvb, offset+2+req_path_size+27, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(bitmap_tree, hf_cip_ssupervisor_reset_attr_bitmap_tunid,\r\ntvb, offset+2+req_path_size+27, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(bitmap_tree, hf_cip_ssupervisor_reset_attr_bitmap_password,\r\ntvb, offset+2+req_path_size+27, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(bitmap_tree, hf_cip_ssupervisor_reset_attr_bitmap_cfunid,\r\ntvb, offset+2+req_path_size+27, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(bitmap_tree, hf_cip_ssupervisor_reset_attr_bitmap_ocpunid,\r\ntvb, offset+2+req_path_size+27, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(bitmap_tree, hf_cip_ssupervisor_reset_attr_bitmap_reserved,\r\ntvb, offset+2+req_path_size+27, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(bitmap_tree, hf_cip_ssupervisor_reset_attr_bitmap_extended,\r\ntvb, offset+2+req_path_size+27, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nbreak;\r\ncase SC_SSUPER_RESET_PASSWORD:\r\nproto_tree_add_item(cmd_data_tree, hf_cip_ssupervisor_reset_password_data_size,\r\ntvb, offset+2+req_path_size, 1, ENC_LITTLE_ENDIAN);\r\ntemp_data = tvb_get_guint8(tvb, offset+2+req_path_size);\r\nproto_tree_add_item(cmd_data_tree, hf_cip_ssupervisor_reset_password_data,\r\ntvb, offset+2+req_path_size+1, temp_data, ENC_NA);\r\nbreak;\r\ncase SC_SSUPER_PROPOSE_TUNID:\r\npi = proto_tree_add_item(cmd_data_tree, hf_cip_ssupervisor_propose_tunid_tunid,\r\ntvb, offset+2+req_path_size, 10, ENC_NA);\r\ndissect_unid(tvb, pinfo, offset+2+req_path_size, pi, "TUNID SSN",\r\nhf_cip_ssupervisor_propose_tunid_tunid_ssn_timestamp,\r\nhf_cip_ssupervisor_propose_tunid_tunid_ssn_date,\r\nhf_cip_ssupervisor_propose_tunid_tunid_ssn_time,\r\nhf_cip_ssupervisor_propose_tunid_tunid_macid,\r\nett_ssupervisor_propose_tunid,\r\nett_ssupervisor_propose_tunid_ssn);\r\nbreak;\r\ncase SC_SSUPER_APPLY_TUNID:\r\npi = proto_tree_add_item(cmd_data_tree, hf_cip_ssupervisor_apply_tunid_tunid,\r\ntvb, offset+2+req_path_size, 10, ENC_NA);\r\ndissect_unid(tvb, pinfo, offset+2+req_path_size, pi, "TUNID SSN",\r\nhf_cip_ssupervisor_apply_tunid_tunid_ssn_timestamp,\r\nhf_cip_ssupervisor_apply_tunid_tunid_ssn_date,\r\nhf_cip_ssupervisor_apply_tunid_tunid_ssn_time,\r\nhf_cip_ssupervisor_apply_tunid_tunid_macid,\r\nett_ssupervisor_apply_tunid,\r\nett_ssupervisor_apply_tunid_ssn);\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(cmd_data_tree, hf_cip_data,\r\ntvb, offset+2+req_path_size, item_length-req_path_size-2, ENC_NA);\r\n}\r\n}\r\n}\r\nadd_cip_service_to_info_column(pinfo, service, cip_sc_vals_ssupervisor);\r\n}\r\nstatic int\r\ndissect_cip_class_s_supervisor(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data _U_)\r\n{\r\nproto_item *ti;\r\nproto_tree *class_tree;\r\nti = proto_tree_add_item(tree, proto_cip_class_s_supervisor, tvb, 0, -1, ENC_NA);\r\nclass_tree = proto_item_add_subtree( ti, ett_cip_class_s_supervisor );\r\ndissect_cip_s_supervisor_data( class_tree, tvb, 0, tvb_reported_length(tvb), pinfo );\r\nreturn tvb_reported_length(tvb);\r\n}\r\nstatic int dissect_s_supervisor_exception_detail(proto_tree *tree, proto_item *item, tvbuff_t *tvb, int offset, int hf_size, int hf_data)\r\n{\r\nint size;\r\nproto_tree_add_item(tree, hf_size, tvb, offset, 1, ENC_LITTLE_ENDIAN );\r\nsize = tvb_get_guint8( tvb, offset);\r\nproto_tree_add_item(tree, hf_data, tvb, offset+1, size, ENC_NA );\r\nproto_item_set_len(item, size+1);\r\nreturn size+1;\r\n}\r\nstatic int dissect_s_supervisor_exception_detail_alarm(packet_info *pinfo, proto_tree *tree, proto_item *item, tvbuff_t *tvb,\r\nint offset, int total_len)\r\n{\r\nproto_item *pi;\r\nproto_tree *item_tree;\r\nint total_size = 0, size;\r\nitem_tree = proto_tree_add_subtree(tree, tvb, offset, 1, ett_exception_detail_alarm_common, &pi, "Common Exception Detail");\r\nsize = dissect_s_supervisor_exception_detail(item_tree, pi, tvb, offset,\r\nhf_cip_ssupervisor_exception_detail_alarm_ced_size,\r\nhf_cip_ssupervisor_exception_detail_alarm_ced_detail);\r\nif (size == 0)\r\n{\r\nexpert_add_info(pinfo, item, &ei_mal_ssupervisor_exception_detail_alarm_ced);\r\nreturn total_len;\r\n}\r\ntotal_size += size;\r\nitem_tree = proto_tree_add_subtree(tree, tvb, offset, 1, ett_exception_detail_alarm_device, &pi, "Device Exception Detail");\r\nsize = dissect_s_supervisor_exception_detail(item_tree, pi, tvb, offset,\r\nhf_cip_ssupervisor_exception_detail_alarm_ded_size,\r\nhf_cip_ssupervisor_exception_detail_alarm_ded_detail);\r\nif (size == 0)\r\n{\r\nexpert_add_info(pinfo, item, &ei_mal_ssupervisor_exception_detail_alarm_ded);\r\nreturn total_len;\r\n}\r\ntotal_size += size;\r\nitem_tree = proto_tree_add_subtree(tree, tvb, offset, 1, ett_exception_detail_alarm_manufacturer, &pi, "Manufacturer Exception Detail");\r\nsize = dissect_s_supervisor_exception_detail(item_tree, pi, tvb, offset,\r\nhf_cip_ssupervisor_exception_detail_alarm_med_size,\r\nhf_cip_ssupervisor_exception_detail_alarm_med_detail);\r\nif (size == 0)\r\n{\r\nexpert_add_info(pinfo, item, &ei_mal_ssupervisor_exception_detail_alarm_med);\r\nreturn total_len;\r\n}\r\ntotal_size += size;\r\nreturn total_size;\r\n}\r\nstatic int dissect_s_supervisor_exception_detail_warning(packet_info *pinfo, proto_tree *tree, proto_item *item,\r\ntvbuff_t *tvb, int offset, int total_len)\r\n{\r\nproto_item *pi;\r\nproto_tree *item_tree;\r\nint total_size = 0, size;\r\nitem_tree = proto_tree_add_subtree(tree, tvb, offset, 1, ett_exception_detail_warning_common, &pi, "Common Exception Detail");\r\nsize = dissect_s_supervisor_exception_detail(item_tree, pi, tvb, offset,\r\nhf_cip_ssupervisor_exception_detail_warning_ced_size,\r\nhf_cip_ssupervisor_exception_detail_warning_ced_detail);\r\nif (size == 0)\r\n{\r\nexpert_add_info(pinfo, item, &ei_mal_ssupervisor_detail_warning_ced);\r\nreturn total_len;\r\n}\r\ntotal_size += size;\r\nitem_tree = proto_tree_add_subtree(tree, tvb, offset, 1, ett_exception_detail_warning_device, &pi, "Device Exception Detail");\r\nsize = dissect_s_supervisor_exception_detail(item_tree, pi, tvb, offset,\r\nhf_cip_ssupervisor_exception_detail_warning_ded_size,\r\nhf_cip_ssupervisor_exception_detail_warning_ded_detail);\r\nif (size == 0)\r\n{\r\nexpert_add_info(pinfo, item, &ei_mal_ssupervisor_detail_warning_ded);\r\nreturn total_len;\r\n}\r\ntotal_size += size;\r\nitem_tree = proto_tree_add_subtree(tree, tvb, offset, 1, ett_exception_detail_warning_manufacturer, &pi, "Manufacturer Exception Detail");\r\nsize = dissect_s_supervisor_exception_detail(item_tree, pi, tvb, offset,\r\nhf_cip_ssupervisor_exception_detail_warning_med_size,\r\nhf_cip_ssupervisor_exception_detail_warning_med_detail);\r\nif (size == 0)\r\n{\r\nexpert_add_info(pinfo, item, &ei_mal_ssupervisor_detail_warning_med);\r\nreturn total_len;\r\n}\r\ntotal_size += size;\r\nreturn total_size;\r\n}\r\nstatic int dissect_s_supervisor_configuration_unid(packet_info *pinfo, proto_tree *tree _U_, proto_item *item,\r\ntvbuff_t *tvb, int offset, int total_len)\r\n{\r\nif (total_len < 10)\r\n{\r\nexpert_add_info(pinfo, item, &ei_mal_ssupervisor_configuration_unid);\r\nreturn total_len;\r\n}\r\ndissect_unid(tvb, pinfo, offset, item, "CFUNID SSN",\r\nhf_cip_ssupervisor_configuration_unid_ssn_timestamp,\r\nhf_cip_ssupervisor_configuration_unid_ssn_date,\r\nhf_cip_ssupervisor_configuration_unid_ssn_time,\r\nhf_cip_ssupervisor_configuration_unid_macid,\r\nett_ssupervisor_configuration_unid,\r\nett_ssupervisor_configuration_unid_ssn);\r\nreturn 10;\r\n}\r\nstatic int dissect_s_supervisor_safety_configuration_id(packet_info *pinfo, proto_tree *tree _U_, proto_item *item,\r\ntvbuff_t *tvb, int offset, int total_len)\r\n{\r\nif (total_len < 10)\r\n{\r\nexpert_add_info(pinfo, item, &ei_mal_ssupervisor_safety_configuration_id);\r\nreturn total_len;\r\n}\r\ndissect_unid(tvb, pinfo, offset, item, "SCID SSN",\r\nhf_cip_ssupervisor_safety_configuration_id_ssn_timestamp,\r\nhf_cip_ssupervisor_safety_configuration_id_ssn_date,\r\nhf_cip_ssupervisor_safety_configuration_id_ssn_time,\r\nhf_cip_ssupervisor_safety_configuration_id_macid,\r\nett_ssupervisor_safety_configuration_id,\r\nett_ssupervisor_safety_configuration_id_ssn);\r\nreturn 10;\r\n}\r\nstatic int dissect_s_supervisor_target_unid(packet_info *pinfo, proto_tree *tree _U_, proto_item *item,\r\ntvbuff_t *tvb, int offset, int total_len)\r\n{\r\nif (total_len < 10)\r\n{\r\nexpert_add_info(pinfo, item, &ei_mal_ssupervisor_target_unid);\r\nreturn total_len;\r\n}\r\ndissect_unid(tvb, pinfo, offset, item, "TUNID SSN",\r\nhf_cip_ssupervisor_target_unid_ssn_timestamp,\r\nhf_cip_ssupervisor_target_unid_ssn_date,\r\nhf_cip_ssupervisor_target_unid_ssn_time,\r\nhf_cip_ssupervisor_target_unid_macid,\r\nett_ssupervisor_target_unid,\r\nett_ssupervisor_target_unid_ssn);\r\nreturn 10;\r\n}\r\nstatic int dissect_s_supervisor_output_connection_point_owners(packet_info *pinfo, proto_tree *tree, proto_item *item,\r\ntvbuff_t *tvb, int offset, int total_len)\r\n{\r\nguint16 i, num_entries;\r\nproto_item *entry_item, *app_path_item;\r\nproto_tree *entry_tree, *epath_tree;\r\nint attr_len = 0, app_path_size;\r\nif (total_len < 2)\r\n{\r\nexpert_add_info(pinfo, item, &ei_mal_ssupervisor_cp_owners);\r\nreturn total_len;\r\n}\r\nentry_item = proto_tree_add_item(tree, hf_cip_ssupervisor_cp_owners_num_entries,\r\ntvb, offset, 2, ENC_LITTLE_ENDIAN );\r\nnum_entries = tvb_get_letohs(tvb, offset);\r\nattr_len += 2;\r\nif (num_entries > 0)\r\n{\r\nentry_tree = proto_item_add_subtree(entry_item, ett_ssupervisor_output_cp_owners);\r\nfor (i = 0; i < num_entries; i++)\r\n{\r\nif (total_len < attr_len+11)\r\n{\r\nexpert_add_info(pinfo, item, &ei_mal_ssupervisor_cp_owners_entry);\r\nreturn total_len;\r\n}\r\ndissect_unid(tvb, pinfo, offset+attr_len, entry_item, "OCPUNID SSN",\r\nhf_cip_ssupervisor_output_cp_owners_ocpunid_ssn_timestamp,\r\nhf_cip_ssupervisor_output_cp_owners_ocpunid_ssn_date,\r\nhf_cip_ssupervisor_output_cp_owners_ocpunid_ssn_time,\r\nhf_cip_ssupervisor_output_cp_owners_ocpunid_macid,\r\nett_ssupervisor_output_cp_owners_ocpunid,\r\nett_ssupervisor_output_cp_owners_ocpunid_ssn);\r\nattr_len += 10;\r\nproto_tree_add_item(entry_tree, hf_cip_ssupervisor_cp_owners_app_path_size,\r\ntvb, offset+attr_len, 1, ENC_LITTLE_ENDIAN );\r\napp_path_size = tvb_get_guint8( tvb, offset+attr_len);\r\nattr_len += 1;\r\nif (total_len < attr_len+app_path_size)\r\n{\r\nexpert_add_info(pinfo, item, &ei_mal_ssupervisor_cp_owners_app_path_size);\r\nreturn total_len;\r\n}\r\nepath_tree = proto_tree_add_subtree(entry_tree,\r\ntvb, offset+attr_len, app_path_size, ett_path, &app_path_item, "Application Resource: ");\r\ndissect_epath(tvb, pinfo, epath_tree, app_path_item, offset+attr_len, app_path_size, FALSE, TRUE, NULL, NULL, NO_DISPLAY, NULL, FALSE);\r\nattr_len += app_path_size;\r\n}\r\n}\r\nreturn attr_len;\r\n}\r\nstatic int dissect_s_supervisor_proposed_tunid(packet_info *pinfo, proto_tree *tree _U_, proto_item *item,\r\ntvbuff_t *tvb, int offset, int total_len)\r\n{\r\nif (total_len < 10)\r\n{\r\nexpert_add_info(pinfo, item, &ei_mal_ssupervisor_proposed_tunid);\r\nreturn total_len;\r\n}\r\ndissect_unid(tvb, pinfo, offset, item, "Proposed TUNID SSN",\r\nhf_cip_ssupervisor_proposed_tunid_ssn_timestamp,\r\nhf_cip_ssupervisor_proposed_tunid_ssn_date,\r\nhf_cip_ssupervisor_proposed_tunid_ssn_time,\r\nhf_cip_ssupervisor_proposed_tunid_macid,\r\nett_ssupervisor_proposed_tunid,\r\nett_ssupervisor_proposed_tunid_ssn);\r\nreturn 10;\r\n}\r\nstatic int dissect_s_validator_type(packet_info *pinfo, proto_tree *tree, proto_item *item, tvbuff_t *tvb,\r\nint offset, int total_len)\r\n{\r\nproto_item *pi;\r\nproto_tree *item_tree;\r\nif (total_len < 1)\r\n{\r\nexpert_add_info(pinfo, item, &ei_mal_svalidator_type);\r\nreturn total_len;\r\n}\r\npi = proto_tree_add_item(tree, hf_cip_svalidator_type, tvb, offset, 1, ENC_LITTLE_ENDIAN );\r\nitem_tree = proto_item_add_subtree(pi, ett_svalidator_type);\r\nproto_tree_add_item(item_tree, hf_cip_svalidator_type_pc, tvb, offset, 1, ENC_LITTLE_ENDIAN );\r\nproto_tree_add_item(item_tree, hf_cip_svalidator_type_conn_type, tvb, offset, 1, ENC_LITTLE_ENDIAN );\r\nreturn 1;\r\n}\r\nstatic int dissect_s_validator_time_coord_msg_min_mult(packet_info *pinfo, proto_tree *tree, proto_item *item,\r\ntvbuff_t *tvb, int offset, int total_len)\r\n{\r\nint i, size;\r\nproto_tree_add_item(tree, hf_cip_svalidator_time_coord_msg_min_mult_size,\r\ntvb, offset, 1, ENC_LITTLE_ENDIAN );\r\nsize = tvb_get_guint8( tvb, offset )*2;\r\nif (total_len < size+1)\r\n{\r\nexpert_add_info(pinfo, item, &ei_mal_svalidator_time_coord_msg_min_mult);\r\nreturn total_len;\r\n}\r\nfor (i = 0; i < size; i+=2)\r\n{\r\nproto_tree_add_item(tree, hf_cip_svalidator_time_coord_msg_min_mult_item,\r\ntvb, offset+1+i, 2, ENC_LITTLE_ENDIAN );\r\n}\r\nreturn (size+1);\r\n}\r\nstatic int dissect_s_validator_network_time_multiplier(packet_info *pinfo, proto_tree *tree, proto_item *item,\r\ntvbuff_t *tvb, int offset, int total_len)\r\n{\r\nint i, size;\r\nproto_tree_add_item(tree, hf_cip_svalidator_network_time_multiplier_size,\r\ntvb, offset, 1, ENC_LITTLE_ENDIAN );\r\nsize = tvb_get_guint8( tvb, offset )*2;\r\nif (total_len < size+1)\r\n{\r\nexpert_add_info(pinfo, item, &ei_mal_svalidator_network_time_multiplier);\r\nreturn total_len;\r\n}\r\nfor (i = 0; i < size; i+=2)\r\n{\r\nproto_tree_add_item(tree, hf_cip_svalidator_network_time_multiplier_item,\r\ntvb, offset+1+i, 2, ENC_LITTLE_ENDIAN );\r\n}\r\nreturn (size+1);\r\n}\r\nstatic int dissect_s_validator_timeout_multiplier(packet_info *pinfo, proto_tree *tree, proto_item *item, tvbuff_t *tvb,\r\nint offset, int total_len)\r\n{\r\nint i, size;\r\nproto_tree_add_item(tree, hf_cip_svalidator_timeout_multiplier_size,\r\ntvb, offset, 1, ENC_LITTLE_ENDIAN );\r\nsize = tvb_get_guint8( tvb, offset );\r\nif (total_len < size+1)\r\n{\r\nexpert_add_info(pinfo, item, &ei_mal_svalidator_timeout_multiplier);\r\nreturn total_len;\r\n}\r\nfor (i = 0; i < size; i++)\r\n{\r\nproto_tree_add_item(tree, hf_cip_svalidator_timeout_multiplier_item,\r\ntvb, offset+1+i, 1, ENC_LITTLE_ENDIAN );\r\n}\r\nreturn (size+1);\r\n}\r\nstatic int dissect_s_validator_coordination_conn_inst(packet_info *pinfo, proto_tree *tree, proto_item *item,\r\ntvbuff_t *tvb, int offset, int total_len)\r\n{\r\nint i, size;\r\nproto_tree_add_item(tree, hf_cip_svalidator_coordination_conn_inst_size,\r\ntvb, offset, 1, ENC_LITTLE_ENDIAN );\r\nsize = tvb_get_guint8( tvb, offset )*2;\r\nif (total_len < size+1)\r\n{\r\nexpert_add_info(pinfo, item, &ei_mal_svalidator_coordination_conn_inst);\r\nreturn total_len;\r\n}\r\nfor (i = 0; i < size; i+=2)\r\n{\r\nproto_tree_add_item(tree, hf_cip_svalidator_coordination_conn_inst_item,\r\ntvb, offset+1+i, 2, ENC_LITTLE_ENDIAN );\r\n}\r\nreturn (size+1);\r\n}\r\nstatic int dissect_s_validator_app_data_path(packet_info *pinfo, proto_tree *tree,\r\nproto_item *item _U_, tvbuff_t *tvb, int offset, int total_len)\r\n{\r\nproto_item* pi;\r\nproto_tree* epath_tree = proto_tree_add_subtree(tree, NULL, 0, 0, ett_path, &pi, "Application Data Path: ");\r\ndissect_epath(tvb, pinfo, epath_tree, pi, offset, total_len, FALSE, FALSE, NULL, NULL, NO_DISPLAY, NULL, FALSE);\r\nreturn total_len;\r\n}\r\nstatic int dissect_s_validator_prod_cons_fault_count(packet_info *pinfo, proto_tree *tree, proto_item *item,\r\ntvbuff_t *tvb, int offset, int total_len)\r\n{\r\nint i, size;\r\nproto_tree_add_item(tree, hf_cip_svalidator_prod_cons_fault_count_size,\r\ntvb, offset, 1, ENC_LITTLE_ENDIAN );\r\nsize = tvb_get_guint8( tvb, offset );\r\nif (total_len < size+1)\r\n{\r\nexpert_add_info(pinfo, item, &ei_mal_svalidator_prod_cons_fault_count);\r\nreturn total_len;\r\n}\r\nfor (i = 0; i < size; i++)\r\n{\r\nproto_tree_add_item(tree, hf_cip_svalidator_prod_cons_fault_count_item,\r\ntvb, offset+1+i, 1, ENC_LITTLE_ENDIAN );\r\n}\r\nreturn (size+1);\r\n}\r\nstatic void\r\ndissect_cip_s_validator_data( proto_tree *item_tree,\r\ntvbuff_t *tvb, int offset, int item_length, packet_info *pinfo )\r\n{\r\nproto_item *pi, *rrsc_item;\r\nproto_tree *rrsc_tree, *cmd_data_tree;\r\nint req_path_size;\r\nguint8 service, gen_status, add_stat_size;\r\ncip_req_info_t* preq_info;\r\ncip_simple_request_info_t req_data;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "CIPS Validator");\r\nservice = tvb_get_guint8( tvb, offset );\r\nrrsc_tree = proto_tree_add_subtree( item_tree, tvb, offset, 1, ett_svalidator_rrsc, &rrsc_item, "Service: " );\r\nproto_tree_add_item( rrsc_tree, hf_cip_reqrsp, tvb, offset, 1, ENC_LITTLE_ENDIAN );\r\nproto_item_append_text( rrsc_item, "%s (%s)",\r\nval_to_str( ( service & 0x7F ),\r\ncip_sc_vals_svalidator , "Unknown Service (0x%02x)"),\r\nval_to_str_const( ( service & 0x80 )>>7,\r\ncip_sc_rr, "") );\r\nproto_tree_add_item(rrsc_tree, hf_cip_svalidator_sc, tvb, offset, 1, ENC_LITTLE_ENDIAN );\r\npreq_info = (cip_req_info_t*)p_get_proto_data(wmem_file_scope(), pinfo, proto_cip, 0);\r\nif ((preq_info != NULL) &&\r\n(preq_info->ciaData != NULL))\r\n{\r\nmemcpy(&req_data, preq_info->ciaData, sizeof(cip_simple_request_info_t));\r\n}\r\nelse\r\n{\r\nreq_data.iClass = (guint32)-1;\r\nreq_data.iInstance = (guint32)-1;\r\nreq_data.iAttribute = (guint32)-1;\r\nreq_data.iMember = (guint32)-1;\r\n}\r\nif(service & 0x80 )\r\n{\r\ngen_status = tvb_get_guint8( tvb, offset+2 );\r\nadd_stat_size = tvb_get_guint8( tvb, offset+3 ) * 2;\r\nif( ( item_length-4-add_stat_size ) != 0 )\r\n{\r\ncmd_data_tree = proto_tree_add_subtree( item_tree, tvb, offset+4+add_stat_size, item_length-4-add_stat_size,\r\nett_ssupervisor_cmd_data, &pi, "Command Specific Data" );\r\nif( gen_status == CI_GRC_SUCCESS || gen_status == CI_GRC_SERVICE_ERROR )\r\n{\r\nif (((service & 0x7F) == SC_GET_ATT_ALL) &&\r\n(req_data.iInstance != (guint32)-1) &&\r\n(req_data.iInstance != 0))\r\n{\r\ndissect_cip_get_attribute_all_rsp(tvb, pinfo, cmd_data_tree, offset + 4 + add_stat_size, &req_data);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(cmd_data_tree, hf_cip_data,\r\ntvb, offset+4+add_stat_size, item_length-4-add_stat_size, ENC_NA);\r\n}\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(cmd_data_tree, hf_cip_data,\r\ntvb, offset+4+add_stat_size, item_length-4-add_stat_size, ENC_NA);\r\n}\r\n}\r\n}\r\nelse\r\n{\r\nreq_path_size = tvb_get_guint8( tvb, offset+1 )*2;\r\nif( (item_length-req_path_size-2) != 0 )\r\n{\r\ncmd_data_tree = proto_tree_add_subtree( item_tree, tvb, offset+2+req_path_size, item_length-req_path_size-2,\r\nett_ssupervisor_cmd_data, NULL, "Command Specific Data" );\r\nproto_tree_add_item(cmd_data_tree, hf_cip_data,\r\ntvb, offset+2+req_path_size, item_length-req_path_size-2, ENC_NA);\r\n}\r\n}\r\nadd_cip_service_to_info_column(pinfo, service, cip_sc_vals_svalidator);\r\n}\r\nstatic int\r\ndissect_cip_class_s_validator(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data _U_)\r\n{\r\nproto_item *ti;\r\nproto_tree *class_tree;\r\nti = proto_tree_add_item(tree, proto_cip_class_s_validator, tvb, 0, -1, ENC_NA);\r\nclass_tree = proto_item_add_subtree( ti, ett_cip_class_s_validator );\r\ndissect_cip_s_validator_data( class_tree, tvb, 0, tvb_reported_length(tvb), pinfo );\r\nreturn tvb_reported_length(tvb);\r\n}\r\nstatic gboolean\r\ndissect_class_svalidator_heur(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data _U_)\r\n{\r\nunsigned char service, service_code, ioilen, segment;\r\ncip_req_info_t* preq_info;\r\nguint32 classid = 0;\r\nint offset = 0;\r\nservice = tvb_get_guint8( tvb, offset );\r\nservice_code = service & 0x7F;\r\nif (service_code == SC_GET_ATT_ALL)\r\n{\r\nif (service & 0x80)\r\n{\r\npreq_info = (cip_req_info_t*)p_get_proto_data(wmem_file_scope(), pinfo, proto_cip, 0);\r\nif ((preq_info != NULL) &&\r\n(preq_info->dissector == dissector_get_uint_handle( subdissector_class_table, CI_CLS_SAFETY_VALIDATOR)))\r\n{\r\ncall_dissector(preq_info->dissector, tvb, pinfo, tree);\r\nreturn TRUE;\r\n}\r\n}\r\nelse\r\n{\r\nioilen = tvb_get_guint8( tvb, offset + 1 );\r\nif (ioilen > 1)\r\n{\r\nsegment = tvb_get_guint8( tvb, offset + 2 );\r\nif (((segment & CI_SEGMENT_TYPE_MASK) == CI_LOGICAL_SEGMENT) &&\r\n((segment & CI_LOGICAL_SEG_TYPE_MASK) == CI_LOGICAL_SEG_CLASS_ID))\r\n{\r\nswitch ( segment & CI_LOGICAL_SEG_FORMAT_MASK )\r\n{\r\ncase CI_LOGICAL_SEG_8_BIT:\r\nclassid = tvb_get_guint8( tvb, offset + 3 );\r\nbreak;\r\ncase CI_LOGICAL_SEG_16_BIT:\r\nif ( ioilen >= 2 )\r\nclassid = tvb_get_letohs( tvb, offset + 4 );\r\nbreak;\r\ncase CI_LOGICAL_SEG_32_BIT:\r\nif ( ioilen >= 3 )\r\nclassid = tvb_get_letohl( tvb, offset + 4 );\r\nbreak;\r\n}\r\n}\r\n}\r\nif (classid == CI_CLS_SAFETY_VALIDATOR)\r\n{\r\ncall_dissector(cip_class_s_validator_handle, tvb, pinfo, tree );\r\nreturn TRUE;\r\n}\r\n}\r\n}\r\nreturn FALSE;\r\n}\r\nstatic void\r\ndissect_mode_byte( proto_tree *tree, tvbuff_t *tvb, int offset, packet_info *pinfo)\r\n{\r\nproto_item *mode_item, *run_idle_item, *tbd_item, *tbd2_item;\r\nproto_tree *mode_tree;\r\nguint8 mode_byte;\r\nmode_byte = tvb_get_guint8(tvb, offset);\r\nmode_item = proto_tree_add_item(tree, hf_cipsafety_mode_byte, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\nmode_tree = proto_item_add_subtree( mode_item, ett_cipsafety_mode_byte);\r\nproto_tree_add_item(mode_tree, hf_cipsafety_mode_byte_ping_count, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(mode_tree, hf_cipsafety_mode_byte_not_tbd, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(mode_tree, hf_cipsafety_mode_byte_tbd_2_copy, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(mode_tree, hf_cipsafety_mode_byte_not_run_idle, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\ntbd_item = proto_tree_add_item(mode_tree, hf_cipsafety_mode_byte_tbd, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\ntbd2_item = proto_tree_add_item(mode_tree, hf_cipsafety_mode_byte_tbd_2_bit, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\nrun_idle_item = proto_tree_add_item(mode_tree, hf_cipsafety_mode_byte_run_idle, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\nif ((((mode_byte & 0x20) >> 5) & 0x01) == (((mode_byte & 0x04) >> 2) & 0x01))\r\nexpert_add_info(pinfo, tbd_item, &ei_cipsafety_tbd2_not_complemented);\r\nif ((((mode_byte & 0x40) >> 6) & 0x01) != (((mode_byte & 0x08) >> 3) & 0x01))\r\nexpert_add_info(pinfo, tbd2_item, &ei_cipsafety_tbd_not_copied);\r\nif ((((mode_byte & 0x80) >> 7) & 0x01) == (((mode_byte & 0x10) >> 4) & 0x01))\r\nexpert_add_info(pinfo, run_idle_item, &ei_cipsafety_run_idle_not_complemented);\r\n}\r\nstatic void\r\ndissect_ack_byte( proto_tree *tree, tvbuff_t *tvb, int offset, packet_info *pinfo _U_)\r\n{\r\nproto_item *ack_item;\r\nproto_tree *ack_tree;\r\n#if 0\r\nguint8 ack_byte;\r\nack_byte = tvb_get_guint8(tvb, offset);\r\n#endif\r\nif (!tree)\r\nreturn;\r\nack_item = proto_tree_add_item(tree, hf_cipsafety_ack_byte, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\nack_tree = proto_item_add_subtree( ack_item, ett_cipsafety_ack_byte);\r\nproto_tree_add_item(ack_tree, hf_cipsafety_ack_byte_ping_count_reply, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(ack_tree, hf_cipsafety_ack_byte_reserved1, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(ack_tree, hf_cipsafety_ack_byte_ping_response, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(ack_tree, hf_cipsafety_ack_byte_reserved2, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(ack_tree, hf_cipsafety_ack_byte_parity_even, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_mcast_byte( proto_tree *tree, tvbuff_t *tvb, int offset, packet_info *pinfo _U_)\r\n{\r\nproto_item *mcast_item;\r\nproto_tree *mcast_tree;\r\n#if 0\r\nguint8 mcast_byte;\r\nmcast_byte = tvb_get_guint8(tvb, offset);\r\n#endif\r\nmcast_item = proto_tree_add_item(tree, hf_cipsafety_mcast_byte, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\nmcast_tree = proto_item_add_subtree( mcast_item, ett_cipsafety_mcast_byte);\r\nproto_tree_add_item(mcast_tree, hf_cipsafety_mcast_byte_consumer_num, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(mcast_tree, hf_cipsafety_mcast_byte_reserved1, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(mcast_tree, hf_cipsafety_mcast_byte_mai, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(mcast_tree, hf_cipsafety_mcast_byte_reserved2, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(mcast_tree, hf_cipsafety_mcast_byte_parity_even, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_cip_safety_data( proto_tree *tree, proto_item *item, tvbuff_t *tvb, int item_length, packet_info *pinfo)\r\n{\r\nint base_length, io_data_size;\r\ngboolean multicast = (((pntoh32(pinfo->dst.data)) & 0xf0000000) == 0xe0000000);\r\ngboolean server_dir = FALSE;\r\nenum enip_connid_type conn_type = ECIDT_UNKNOWN;\r\nenum cip_safety_format_type format = CIP_SAFETY_BASE_FORMAT;\r\ncip_safety_info_t* safety_info = (cip_safety_info_t*)p_get_proto_data(wmem_file_scope(), pinfo, proto_cipsafety, 0 );\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "CIP Safety");\r\nif (safety_info != NULL)\r\n{\r\nconn_type = safety_info->conn_type;\r\nformat = safety_info->format;\r\nserver_dir = safety_info->server_dir;\r\n}\r\nbase_length = multicast ? 12 : 6;\r\nif (((conn_type == ECIDT_O2T) && (server_dir == FALSE)) ||\r\n((conn_type == ECIDT_T2O) && (server_dir == TRUE)))\r\n{\r\ndissect_ack_byte(tree, tvb, 0, pinfo);\r\nproto_tree_add_item(tree, hf_cipsafety_consumer_time_value, tvb, 1, 2, ENC_LITTLE_ENDIAN);\r\nswitch (format)\r\n{\r\ncase CIP_SAFETY_BASE_FORMAT:\r\nproto_tree_add_item(tree, hf_cipsafety_ack_byte2, tvb, 3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_cipsafety_crc_s3, tvb, 4, 2, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase CIP_SAFETY_EXTENDED_FORMAT:\r\nproto_tree_add_item(tree, hf_cipsafety_crc_s5_0, tvb, 3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_cipsafety_crc_s5_1, tvb, 4, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_cipsafety_crc_s5_2, tvb, 5, 1, ENC_LITTLE_ENDIAN);\r\nbreak;\r\n}\r\n}\r\nelse if (((conn_type == ECIDT_O2T) && (server_dir == TRUE)) ||\r\n((conn_type == ECIDT_T2O) && (server_dir == FALSE)))\r\n{\r\nswitch (format)\r\n{\r\ncase CIP_SAFETY_BASE_FORMAT:\r\nif (item_length-base_length <= 2)\r\n{\r\nproto_tree_add_item(tree, hf_cipsafety_data, tvb, 0, item_length-base_length, ENC_NA);\r\ndissect_mode_byte(tree, tvb, item_length-base_length, pinfo);\r\nproto_tree_add_item(tree, hf_cipsafety_crc_s1, tvb, item_length-base_length+1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_cipsafety_crc_s2, tvb, item_length-base_length+2, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_cipsafety_timestamp, tvb, item_length-base_length+3, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_cipsafety_crc_s1, tvb, item_length-base_length+5, 1, ENC_LITTLE_ENDIAN);\r\nif (multicast)\r\n{\r\ndissect_mcast_byte(tree, tvb, item_length-6, pinfo);\r\nproto_tree_add_item(tree, hf_cipsafety_time_correction, tvb, item_length-5, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_cipsafety_mcast_byte2, tvb, item_length-3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_cipsafety_crc_s3, tvb, item_length-2, 2, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nelse\r\n{\r\nif (item_length%2 == 1)\r\n{\r\nexpert_add_info(pinfo, item, &ei_mal_io);\r\nreturn;\r\n}\r\nio_data_size = multicast ? ((item_length-14)/2) : ((item_length-8)/2);\r\nproto_tree_add_item(tree, hf_cipsafety_data, tvb, 0, io_data_size, ENC_NA);\r\ndissect_mode_byte(tree, tvb, io_data_size, pinfo);\r\nproto_tree_add_item(tree, hf_cipsafety_crc_s3, tvb, io_data_size+1, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_cipsafety_complement_data, tvb, io_data_size+3, io_data_size, ENC_NA);\r\nproto_tree_add_item(tree, hf_cipsafety_crc_s3, tvb, (io_data_size*2)+3, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_cipsafety_timestamp, tvb, (io_data_size*2)+5, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_cipsafety_crc_s1, tvb, (io_data_size*2)+7, 1, ENC_LITTLE_ENDIAN);\r\nif (multicast)\r\n{\r\ndissect_mcast_byte(tree, tvb, (io_data_size*2)+5, pinfo);\r\nproto_tree_add_item(tree, hf_cipsafety_time_correction, tvb, (io_data_size*2)+6, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_cipsafety_mcast_byte2, tvb, (io_data_size*2)+8, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_cipsafety_crc_s3, tvb, (io_data_size*2)+9, 2, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nbreak;\r\ncase CIP_SAFETY_EXTENDED_FORMAT:\r\nif (item_length-base_length <= 2)\r\n{\r\nproto_tree_add_item(tree, hf_cipsafety_data, tvb, 0, item_length-base_length, ENC_NA);\r\ndissect_mode_byte(tree, tvb, item_length-base_length, pinfo);\r\nproto_tree_add_item(tree, hf_cipsafety_crc_s5_0, tvb, item_length-base_length+1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_cipsafety_crc_s5_1, tvb, item_length-base_length+2, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_cipsafety_timestamp, tvb, item_length-base_length+3, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_cipsafety_crc_s5_2, tvb, item_length-base_length+5, 1, ENC_LITTLE_ENDIAN);\r\nif (multicast)\r\n{\r\ndissect_mcast_byte(tree, tvb, item_length-6, pinfo);\r\nproto_tree_add_item(tree, hf_cipsafety_time_correction, tvb, item_length-5, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_cipsafety_crc_s5_0, tvb, item_length-3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_cipsafety_crc_s5_1, tvb, item_length-2, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_cipsafety_crc_s5_2, tvb, item_length-1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nelse\r\n{\r\nif (item_length%2 == 1)\r\n{\r\nexpert_add_info(pinfo, item, &ei_mal_io);\r\nreturn;\r\n}\r\nio_data_size = multicast ? ((item_length-14)/2) : ((item_length-8)/2);\r\nproto_tree_add_item(tree, hf_cipsafety_data, tvb, 0, io_data_size, ENC_NA);\r\ndissect_mode_byte(tree, tvb, io_data_size, pinfo);\r\nproto_tree_add_item(tree, hf_cipsafety_crc_s3, tvb, io_data_size+1, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_cipsafety_complement_data, tvb, io_data_size+3, io_data_size, ENC_NA);\r\nproto_tree_add_item(tree, hf_cipsafety_crc_s5_0, tvb, (io_data_size*2)+3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_cipsafety_crc_s5_1, tvb, (io_data_size*2)+4, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_cipsafety_timestamp, tvb, (io_data_size*2)+5, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_cipsafety_crc_s5_2, tvb, (io_data_size*2)+7, 1, ENC_LITTLE_ENDIAN);\r\nif (multicast)\r\n{\r\ndissect_mcast_byte(tree, tvb, (io_data_size*2)+8, pinfo);\r\nproto_tree_add_item(tree, hf_cipsafety_time_correction, tvb, (io_data_size*2)+9, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_cipsafety_crc_s5_0, tvb, (io_data_size*2)+11, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_cipsafety_crc_s5_1, tvb, (io_data_size*2)+12, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_cipsafety_crc_s5_2, tvb, (io_data_size*2)+13, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nbreak;\r\n}\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_cipsafety_data, tvb, 0, item_length, ENC_NA);\r\n}\r\n}\r\nstatic int\r\ndissect_cipsafety(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nproto_item *ti;\r\nproto_tree *safety_tree;\r\nti = proto_tree_add_item(tree, proto_cipsafety, tvb, 0, -1, ENC_NA);\r\nsafety_tree = proto_item_add_subtree( ti, ett_cip_safety);\r\ndissect_cip_safety_data(safety_tree, ti, tvb, tvb_reported_length(tvb), pinfo );\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic int dissect_sercosiii_link_error_count_p1p2(packet_info *pinfo, proto_tree *tree, proto_item *item, tvbuff_t *tvb,\r\nint offset, int total_len)\r\n{\r\nif (total_len < 4)\r\n{\r\nexpert_add_info(pinfo, item, &ei_mal_sercosiii_link_error_count_p1p2);\r\nreturn total_len;\r\n}\r\nproto_tree_add_item(tree, hf_cip_sercosiii_link_error_count_p1, tvb, offset, 2, ENC_LITTLE_ENDIAN );\r\nproto_tree_add_item(tree, hf_cip_sercosiii_link_error_count_p2, tvb, offset+2, 2, ENC_LITTLE_ENDIAN );\r\nreturn 4;\r\n}\r\nvoid\r\nproto_register_cipsafety(void)\r\n{\r\nstatic hf_register_info hf[] =\r\n{\r\n{ &hf_cip_reqrsp,\r\n{ "Request/Response", "cip.rr",\r\nFT_UINT8, BASE_HEX, VALS(cip_sc_rr), 0x80, "Request or Response message", HFILL }\r\n},\r\n{ &hf_cip_data,\r\n{ "Data", "cip.data",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_data,\r\n{ "Data", "enip.connection_transport_data",\r\nFT_BYTES, BASE_NONE, NULL, 0, "Connection Transport Data", HFILL }\r\n},\r\n{ &hf_cipsafety_mode_byte,\r\n{ "Mode Byte", "cipsafety.mode_byte",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_mode_byte_ping_count,\r\n{ "Ping Count", "cipsafety.mode_byte.ping_count",\r\nFT_UINT8, BASE_DEC, NULL, 0x03, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_mode_byte_not_tbd,\r\n{ "Not TBD Bit", "cipsafety.mode_byte.not_tbd",\r\nFT_BOOLEAN, 8, NULL, 0x04, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_mode_byte_tbd_2_copy,\r\n{ "TBD 2 Bit Copy", "cipsafety.mode_byte.tbd_2_copy",\r\nFT_BOOLEAN, 8, NULL, 0x08, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_mode_byte_not_run_idle,\r\n{ "Not Run/Idle", "cipsafety.mode_byte.not_run_idle",\r\nFT_BOOLEAN, 8, NULL, 0x10, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_mode_byte_tbd,\r\n{ "TBD Bit", "cipsafety.mode_byte.tbd",\r\nFT_BOOLEAN, 8, NULL, 0x20, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_mode_byte_tbd_2_bit,\r\n{ "TBD 2 Bit", "cipsafety.mode_byte.tbd_2_bit",\r\nFT_BOOLEAN, 8, NULL, 0x40, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_mode_byte_run_idle,\r\n{ "Run/Idle", "cipsafety.mode_byte.run_idle",\r\nFT_BOOLEAN, 8, NULL, 0x80, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_crc_s1,\r\n{ "CRC S1", "cipsafety.crc_s1",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_crc_s2,\r\n{ "CRC S2", "cipsafety.crc_s2",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_crc_s3,\r\n{ "CRC S3", "cipsafety.crc_s3",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_timestamp,\r\n{ "Timestamp", "cipsafety.timestamp",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_ack_byte,\r\n{ "ACK Byte", "cipsafety.ack_byte",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_ack_byte_ping_count_reply,\r\n{ "Ping Count Reply", "cipsafety.ack_byte.ping_count_reply",\r\nFT_UINT8, BASE_HEX, NULL, 0x03, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_ack_byte_reserved1,\r\n{ "Reserved", "cipsafety.ack_byte.reserved1",\r\nFT_UINT8, BASE_HEX, NULL, 0x04, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_ack_byte_ping_response,\r\n{ "Ping Response", "cipsafety.ack_byte.ping_response",\r\nFT_BOOLEAN, 8, NULL, 0x08, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_ack_byte_reserved2,\r\n{ "Reserved", "cipsafety.ack_byte.reserved2",\r\nFT_UINT8, BASE_HEX, NULL, 0x70, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_ack_byte_parity_even,\r\n{ "Parity Even", "cipsafety.ack_byte.parity_even",\r\nFT_BOOLEAN, 8, NULL, 0x80, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_ack_byte2,\r\n{ "ACK Byte 2", "cipsafety.ack_byte2",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_consumer_time_value,\r\n{ "Consumer Time Value", "cipsafety.consumer_time_value",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_mcast_byte,\r\n{ "MCAST Byte", "cipsafety.mcast_byte",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_mcast_byte_consumer_num,\r\n{ "Consumer #", "cipsafety.mcast_byte.consumer_num",\r\nFT_UINT8, BASE_HEX, NULL, 0x0F, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_mcast_byte_reserved1,\r\n{ "Reserved", "cipsafety.mcast_byte.reserved1",\r\nFT_UINT8, BASE_HEX, NULL, 0x10, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_mcast_byte_mai,\r\n{ "Multicast Active/Idle", "cipsafety.mcast_byte.active_idle",\r\nFT_BOOLEAN, 8, TFS(&cip_safety_vals_active_idle), 0x20, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_mcast_byte_reserved2,\r\n{ "Reserved", "cipsafety.mcast_byte.reserved2",\r\nFT_UINT8, BASE_HEX, NULL, 0x40, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_mcast_byte_parity_even,\r\n{ "Parity Even", "cipsafety.mcast_byte.parity_even",\r\nFT_BOOLEAN, 8, NULL, 0x80, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_mcast_byte2,\r\n{ "MCAST Byte 2", "cipsafety.mcast_byte2",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_time_correction,\r\n{ "Time Correction", "cipsafety.time_correction",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_crc_s5_0,\r\n{ "CRC S5_0", "cipsafety.crc_s5_0",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_crc_s5_1,\r\n{ "CRC S5_1", "cipsafety.crc_s5_1",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_crc_s5_2,\r\n{ "CRC S5_2", "cipsafety.crc_s5_2",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cipsafety_complement_data,\r\n{ "Complement Data", "cipsafety.complement_data",\r\nFT_BYTES, BASE_NONE, NULL, 0, "Connection Transport Data", HFILL }\r\n},\r\n{ &hf_cip_sercosiii_link_snn,\r\n{ "Data", "cipsafety.sercosiii_link.snn",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_sercosiii_link_communication_cycle_time,\r\n{ "Communication Cycle Time", "cipsafety.sercosiii_link.communication_cycle_time",\r\nFT_INT32, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_sercosiii_link_interface_status,\r\n{ "Communication Cycle Time", "cipsafety.sercosiii_link.interface_status",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_sercosiii_link_error_count_mstps,\r\n{ "Error Counter MST-P/S", "cipsafety.sercosiii_link.error_count_mstps",\r\nFT_INT16, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_sercosiii_link_error_count_p1,\r\n{ "Error Count Port 1", "cipsafety.sercosiii_link.error_count_p1",\r\nFT_INT16, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_sercosiii_link_error_count_p2,\r\n{ "Error Count Port 2", "cipsafety.sercosiii_link.error_count_p2",\r\nFT_INT16, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_sercosiii_link_sercos_address,\r\n{ "SERCOS Address", "cipsafety.sercosiii_link.sercos_address",\r\nFT_INT16, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n};\r\nstatic hf_register_info hf_ssupervisor[] = {\r\n{ &hf_cip_ssupervisor_sc,\r\n{ "Service", "cipsafety.ssupervisor.sc",\r\nFT_UINT8, BASE_HEX, VALS(cip_sc_vals_ssupervisor), 0x7F, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_recover_data,\r\n{ "Data", "cipsafety.ssupervisor.recover.data",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_perform_diag_data,\r\n{ "Data", "cipsafety.ssupervisor.perform_diag.data",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_configure_request_password,\r\n{ "Password", "cipsafety.ssupervisor.configure_request.password",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_configure_request_tunid,\r\n{ "Target UNID", "cipsafety.ssupervisor.configure_request.tunid",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_configure_request_tunid_ssn_timestamp,\r\n{ "TUNID SSN Timestamp", "cipsafety.ssupervisor.configure_request.tunid.ssn.timestamp",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_UTC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_configure_request_tunid_ssn_date,\r\n{ "TUNID SSN (Manual) Date", "cipsafety.ssupervisor.configure_request.tunid.ssn.date",\r\nFT_UINT16, BASE_HEX, VALS(cipsafety_ssn_date_vals), 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_configure_request_tunid_ssn_time,\r\n{ "TUNID SSN (Manual) Time", "cipsafety.ssupervisor.configure_request.tunid.ssn.time",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_configure_request_tunid_macid,\r\n{ "MAC ID", "cipsafety.ssupervisor.configure_request.tunid.macid",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_configure_request_ounid,\r\n{ "Originator UNID", "cipsafety.ssupervisor.configure_request.ounid",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_configure_request_ounid_ssn_timestamp,\r\n{ "OUNID SSN Timestamp", "cipsafety.ssupervisor.configure_request.ounid.ssn.timestamp",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_UTC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_configure_request_ounid_ssn_date,\r\n{ "OUNID SSN (Manual) Date", "cipsafety.ssupervisor.configure_request.ounid.ssn.date",\r\nFT_UINT16, BASE_HEX, VALS(cipsafety_ssn_date_vals), 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_configure_request_ounid_ssn_time,\r\n{ "OUNID SSN (Manual) Time", "cipsafety.ssupervisor.configure_request.ounid.ssn.time",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_configure_request_ounid_macid,\r\n{ "MAC ID", "cipsafety.ssupervisor.configure_request.ounid.macid",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_validate_configuration_sccrc,\r\n{ "SCCRC", "cipsafety.ssupervisor.validate_configuration.sccrc",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_validate_configuration_scts_timestamp,\r\n{ "SCTS (Timestamp)", "cipsafety.ssupervisor.validate_configuration.scts.timestamp",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_UTC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_validate_configuration_scts_date,\r\n{ "SCTS (Manual) Date", "cipsafety.ssupervisor.validate_configuration.scts.date",\r\nFT_UINT16, BASE_HEX, VALS(cipsafety_ssn_date_vals), 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_validate_configuration_scts_time,\r\n{ "SCTS (Manual) Time", "cipsafety.ssupervisor.validate_configuration.scts.time",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_validate_configuration_ext_error,\r\n{ "Extended Error", "cipsafety.ssupervisor.validate_configuration.ext_error",\r\nFT_UINT16, BASE_DEC, VALS(cip_ssupervisor_validate_configuration_ext_error_vals), 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_set_password_current_password,\r\n{ "Current Password", "cipsafety.ssupervisor.set_password.current_pass",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_set_password_new_password,\r\n{ "New Password", "cipsafety.ssupervisor.set_password.new_pass",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_configure_lock_value,\r\n{ "Lock Value", "cipsafety.ssupervisor.configure_lock.lock",\r\nFT_UINT8, BASE_DEC, VALS(cip_ssupervisor_lock_vals), 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_configure_lock_password,\r\n{ "Password", "cipsafety.ssupervisor.configure_lock.password",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_configure_lock_tunid,\r\n{ "Target UNID", "cipsafety.ssupervisor.configure_lock.tunid",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_configure_lock_tunid_ssn_timestamp,\r\n{ "TUNID SSN Timestamp", "cipsafety.ssupervisor.configure_lock.tunid.ssn.timestamp",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_UTC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_configure_lock_tunid_ssn_date,\r\n{ "TUNID SSN (Manual) Date", "cipsafety.ssupervisor.configure_lock.tunid.ssn.date",\r\nFT_UINT16, BASE_HEX, VALS(cipsafety_ssn_date_vals), 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_configure_lock_tunid_ssn_time,\r\n{ "TUNID SSN (Manual) Time", "cipsafety.ssupervisor.configure_lock.tunid.ssn.time",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_configure_lock_tunid_macid,\r\n{ "MAC ID", "cipsafety.ssupervisor.configure_lock.tunid.macid",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_mode_change_value,\r\n{ "Value", "cipsafety.ssupervisor.mode_change.value",\r\nFT_UINT8, BASE_DEC, VALS(cip_ssupervisor_change_mode_vals), 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_mode_change_password,\r\n{ "Password", "cipsafety.ssupervisor.mode_change.password",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_reset_type,\r\n{ "Reset Type", "cipsafety.ssupervisor.reset.type",\r\nFT_UINT8, BASE_DEC, VALS(cip_reset_type_vals), 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_reset_password,\r\n{ "Password", "cipsafety.ssupervisor.reset.password",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_reset_tunid,\r\n{ "Target UNID", "cipsafety.ssupervisor.reset.tunid",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_reset_tunid_tunid_ssn_timestamp,\r\n{ "TUNID SSN Timestamp", "cipsafety.ssupervisor.reset.tunid.ssn.timestamp",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_UTC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_reset_tunid_tunid_ssn_date,\r\n{ "TUNID SSN (Manual) Date", "cipsafety.ssupervisor.reset.tunid.ssn.date",\r\nFT_UINT16, BASE_HEX, VALS(cipsafety_ssn_date_vals), 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_reset_tunid_tunid_ssn_time,\r\n{ "TUNID SSN (Manual) Time", "cipsafety.ssupervisor.reset.tunid.ssn.time",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_reset_tunid_macid,\r\n{ "MAC ID", "cipsafety.ssupervisor.reset.tunid.macid",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_reset_attr_bitmap,\r\n{ "Attribute Bit Map", "cipsafety.ssupervisor.reset.attr_bitmap",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_reset_attr_bitmap_macid,\r\n{ "Preserve MacID", "cipsafety.ssupervisor.reset.attr_bitmap.macid",\r\nFT_BOOLEAN, 8, TFS(&tfs_true_false), 0x01, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_reset_attr_bitmap_baudrate,\r\n{ "Preserve Baud Rate", "cipsafety.ssupervisor.reset.attr_bitmap.baudrate",\r\nFT_BOOLEAN, 8, TFS(&tfs_true_false), 0x02, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_reset_attr_bitmap_tunid,\r\n{ "Preserve TUNID", "cipsafety.ssupervisor.reset.attr_bitmap.tunid",\r\nFT_BOOLEAN, 8, TFS(&tfs_true_false), 0x04, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_reset_attr_bitmap_password,\r\n{ "Preserve Password", "cipsafety.ssupervisor.reset.attr_bitmap.password",\r\nFT_BOOLEAN, 8, TFS(&tfs_true_false), 0x08, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_reset_attr_bitmap_cfunid,\r\n{ "Preserve CFUNID", "cipsafety.ssupervisor.reset.attr_bitmap.cfunid",\r\nFT_BOOLEAN, 8, TFS(&tfs_true_false), 0x10, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_reset_attr_bitmap_ocpunid,\r\n{ "Preserve OPCUNID", "cipsafety.ssupervisor.reset.attr_bitmap.ocpunid",\r\nFT_BOOLEAN, 8, TFS(&tfs_true_false), 0x20, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_reset_attr_bitmap_reserved,\r\n{ "Reserved", "cipsafety.ssupervisor.reset.attr_bitmap.reserved",\r\nFT_BOOLEAN, 8, TFS(&tfs_true_false), 0x40, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_reset_attr_bitmap_extended,\r\n{ "Use Extended Map", "cipsafety.ssupervisor.reset.attr_bitmap.extended",\r\nFT_BOOLEAN, 8, TFS(&tfs_true_false), 0x80, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_reset_password_data_size,\r\n{ "Data Size", "cipsafety.ssupervisor.reset_password.data_size",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_reset_password_data,\r\n{ "Password Data", "cipsafety.ssupervisor.reset_password.password_data",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_propose_tunid_tunid,\r\n{ "Target UNID", "cipsafety.ssupervisor.propose_tunid.tunid",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_propose_tunid_tunid_ssn_timestamp,\r\n{ "TUNID SSN Timestamp", "cipsafety.ssupervisor.propose_tunid.tunid.ssn.timestamp",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_UTC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_propose_tunid_tunid_ssn_date,\r\n{ "TUNID SSN (Manual) Date", "cipsafety.ssupervisor.propose_tunid.tunid.ssn.date",\r\nFT_UINT16, BASE_HEX, VALS(cipsafety_ssn_date_vals), 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_propose_tunid_tunid_ssn_time,\r\n{ "TUNID SSN (Manual) Time", "cipsafety.ssupervisor.propose_tunid.tunid.ssn.time",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_propose_tunid_tunid_macid,\r\n{ "MAC ID", "cipsafety.ssupervisor.propose_tunid.tunid.macid",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_apply_tunid_tunid,\r\n{ "Target UNID", "cipsafety.ssupervisor.apply_tunid.tunid",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_apply_tunid_tunid_ssn_timestamp,\r\n{ "TUNID SSN Timestamp", "cipsafety.ssupervisor.apply_tunid.tunid.ssn.timestamp",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_UTC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_apply_tunid_tunid_ssn_date,\r\n{ "TUNID SSN (Manual) Date", "cipsafety.ssupervisor.apply_tunid.tunid.ssn.date",\r\nFT_UINT16, BASE_HEX, VALS(cipsafety_ssn_date_vals), 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_apply_tunid_tunid_ssn_time,\r\n{ "TUNID SSN (Manual) Time", "cipsafety.ssupervisor.apply_tunid.tunid.ssn.time",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_apply_tunid_tunid_macid,\r\n{ "MAC ID", "cipsafety.ssupervisor.apply_tunid.tunid.macid",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_class_subclass,\r\n{ "Subclass", "cipsafety.ssupervisor.class_subclass",\r\nFT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_num_attr,\r\n{ "Number of Attributes", "cipsafety.ssupervisor.num_attr",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_attr_list,\r\n{ "Attributes List Item", "cipsafety.ssupervisor.attr_item",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_manufacture_name,\r\n{ "Manufacturer Name", "cipsafety.ssupervisor.manufacture_name",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_manufacture_model_number,\r\n{ "Manufacturer Model Number", "cipsafety.ssupervisor.manufacture_model_number",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_sw_rev_level,\r\n{ "Software Revision Level", "cipsafety.ssupervisor.sw_rev_level",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_hw_rev_level,\r\n{ "Hardware Revision Level", "cipsafety.ssupervisor.hw_rev_level",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_manufacture_serial_number,\r\n{ "Manufacturer Serial Number", "cipsafety.ssupervisor.manufacture_serial_number",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_device_config,\r\n{ "Device Configuration", "cipsafety.ssupervisor.device_config",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_device_status,\r\n{ "Device Status", "cipsafety.ssupervisor.device_status",\r\nFT_UINT8, BASE_DEC, VALS(cip_ssupervisor_device_status_type_vals), 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_exception_status,\r\n{ "Exception Status", "cipsafety.ssupervisor.exception_status",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_exception_detail_alarm_ced_size,\r\n{ "Common Exeception Detail Size", "cipsafety.ssupervisor.exception_detail_alarm.ced.size",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_exception_detail_alarm_ced_detail,\r\n{ "Common Exeception Detail Data", "cipsafety.ssupervisor.exception_detail_alarm.ced.detail",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_exception_detail_alarm_ded_size,\r\n{ "Device Exeception Detail Size", "cipsafety.ssupervisor.exception_detail_alarm.ded.size",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_exception_detail_alarm_ded_detail,\r\n{ "Device Exeception Detail Data", "cipsafety.ssupervisor.exception_detail_alarm.ded.detail",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_exception_detail_alarm_med_size,\r\n{ "Manufacturer Exeception Detail Size", "cipsafety.ssupervisor.exception_detail_alarm.med.size",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_exception_detail_alarm_med_detail,\r\n{ "Manufacturer Exeception Detail Data", "cipsafety.ssupervisor.exception_detail_alarm.med.detail",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_exception_detail_warning_ced_size,\r\n{ "Common Exeception Detail Size", "cipsafety.ssupervisor.exception_detail_warning.ced.size",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_exception_detail_warning_ced_detail,\r\n{ "Common Exeception Detail Data", "cipsafety.ssupervisor.exception_detail_warning.ced.detail",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_exception_detail_warning_ded_size,\r\n{ "Device Exeception Detail Size", "cipsafety.ssupervisor.exception_detail_warning.ded.size",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_exception_detail_warning_ded_detail,\r\n{ "Device Exeception Detail Data", "cipsafety.ssupervisor.exception_detail_warning.ded.detail",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_exception_detail_warning_med_size,\r\n{ "Manufacturer Exeception Detail Size", "cipsafety.ssupervisor.exception_detail_warning.med.size",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_exception_detail_warning_med_detail,\r\n{ "Manufacturer Exeception Detail Data", "cipsafety.ssupervisor.exception_detail_warning.med.detail",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_alarm_enable,\r\n{ "Exception Detail Alarm", "cipsafety.ssupervisor.alarm_enable",\r\nFT_BOOLEAN, BASE_NONE, TFS(&tfs_true_false), 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_warning_enable,\r\n{ "Exception Detail Warning", "cipsafety.ssupervisor.warning_enable",\r\nFT_BOOLEAN, BASE_NONE, TFS(&tfs_true_false), 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_time,\r\n{ "Time", "cipsafety.ssupervisor.time",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_UTC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_clock_power_cycle_behavior,\r\n{ "Clock Power Cycle Behavior", "cipsafety.ssupervisor.clock_power_cycle_behavior",\r\nFT_UINT8, BASE_DEC, VALS(cip_ssupervisor_clock_power_cycle_type_vals), 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_last_maintenance_date,\r\n{ "Last Maintenance Date", "cipsafety.ssupervisor.last_maintenance_date",\r\nFT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_next_scheduled_maintenance_date,\r\n{ "Next Scheduled Maintenance Date", "cipsafety.ssupervisor.next_scheduled_maintenance_date",\r\nFT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_scheduled_maintenance_expiration_timer,\r\n{ "Scheduled Maintenance Expiration Timer", "cipsafety.ssupervisor.scheduled_maintenance_expiration_timer",\r\nFT_INT16, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_scheduled_maintenance_expiration_warning_enable,\r\n{ "Scheduled Maintenance Expiration Warning Enable", "cipsafety.ssupervisor.scheduled_maintenance_expiration_warning",\r\nFT_BOOLEAN, BASE_NONE, TFS(&tfs_enabled_disabled), 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_run_hours,\r\n{ "Run Hours", "cipsafety.ssupervisor.run_hours",\r\nFT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_configuration_lock,\r\n{ "Configuration Lock", "cipsafety.ssupervisor.configuration_lock",\r\nFT_UINT8, BASE_DEC, VALS(cip_ssupervisor_lock_vals), 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_configuration_unid_ssn_timestamp,\r\n{ "Configuration UNID SSN Timestamp", "cipsafety.ssupervisor.configuration_unid.ssn.timestamp",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_UTC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_configuration_unid_ssn_date,\r\n{ "Configuration UNID SSN (Manual) Date", "cipsafety.ssupervisor.configuration_unid.ssn.date",\r\nFT_UINT16, BASE_HEX, VALS(cipsafety_ssn_date_vals), 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_configuration_unid_ssn_time,\r\n{ "Configuration UNID SSN (Manual) Time", "cipsafety.ssupervisor.configuration_unid.ssn.time",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_configuration_unid_macid,\r\n{ "Configuration UNID MAC ID", "cipsafety.ssupervisor.configuration_unid.macid",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_safety_configuration_id_ssn_timestamp,\r\n{ "Safety Configuration ID SSN Timestamp", "cipsafety.ssupervisor.safety_configuration_id.ssn.timestamp",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_UTC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_safety_configuration_id_ssn_date,\r\n{ "Safety Configuration ID SSN (Manual) Date", "cipsafety.ssupervisor.safety_configuration_id.ssn.date",\r\nFT_UINT16, BASE_HEX, VALS(cipsafety_ssn_date_vals), 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_safety_configuration_id_ssn_time,\r\n{ "Safety Configuration ID SSN (Manual) Time", "cipsafety.ssupervisor.safety_configuration_id.ssn.time",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_safety_configuration_id_macid,\r\n{ "Safety Configuration ID MAC ID", "cipsafety.ssupervisor.safety_configuration_id.macid",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_target_unid_ssn_timestamp,\r\n{ "Target UNID SSN Timestamp", "cipsafety.ssupervisor.target_unid.ssn.timestamp",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_UTC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_target_unid_ssn_date,\r\n{ "Target UNID SSN (Manual) Date", "cipsafety.ssupervisor.target_unid.ssn.date",\r\nFT_UINT16, BASE_HEX, VALS(cipsafety_ssn_date_vals), 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_target_unid_ssn_time,\r\n{ "Target UNID SSN (Manual) Time", "cipsafety.ssupervisor.target_unid.ssn.time",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_target_unid_macid,\r\n{ "Target UNID MAC ID", "cipsafety.ssupervisor.target_unid.macid",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_cp_owners_num_entries,\r\n{ "Number of Array Entries", "cipsafety.ssupervisor.cp_owners.num_entries",\r\nFT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_output_cp_owners_ocpunid_ssn_timestamp,\r\n{ "OCPUNID SSN Timestamp", "cipsafety.ssupervisor.cp_owners.ssn.timestamp",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_UTC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_output_cp_owners_ocpunid_ssn_date,\r\n{ "OCPUNID SSN (Manual) Date", "cipsafety.ssupervisor.cp_owners.ssn.date",\r\nFT_UINT16, BASE_HEX, VALS(cipsafety_ssn_date_vals), 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_output_cp_owners_ocpunid_ssn_time,\r\n{ "OCPUNID SSN (Manual) Time", "cipsafety.ssupervisor.cp_owners.ssn.time",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_output_cp_owners_ocpunid_macid,\r\n{ "OCPUNID MAC ID", "cipsafety.ssupervisor.cp_owners.ocpunid.macid",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_cp_owners_app_path_size,\r\n{ "EPATH Size", "cipsafety.ssupervisor.cp_owners.epath_size",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_proposed_tunid_ssn_timestamp,\r\n{ "Proposed TUNID SSN Timestamp", "cipsafety.ssupervisor.proposed_tunid.ssn.timestamp",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_UTC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_proposed_tunid_ssn_date,\r\n{ "Proposed TUNID SSN (Manual) Date", "cipsafety.ssupervisor.proposed_tunid.ssn.date",\r\nFT_UINT16, BASE_HEX, VALS(cipsafety_ssn_date_vals), 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_proposed_tunid_ssn_time,\r\n{ "Proposed TUNID SSN (Manual) Time", "cipsafety.ssupervisor.proposed_tunid.ssn.time",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_proposed_tunid_macid,\r\n{ "Proposed TUNID MAC ID", "cipsafety.ssupervisor.proposed_tunid.macid",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_ssupervisor_instance_subclass,\r\n{ "Subclass", "cipsafety.ssupervisor.instance_subclass",\r\nFT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }\r\n}\r\n};\r\nstatic hf_register_info hf_svalidator[] = {\r\n{ &hf_cip_svalidator_sc,\r\n{ "Service", "cipsafety.svalidator.sc",\r\nFT_UINT8, BASE_HEX, VALS(cip_sc_vals_svalidator), 0x7F, NULL, HFILL }\r\n},\r\n{ &hf_cip_svalidator_sconn_fault_count,\r\n{ "Safety Connection Fault Count", "cipsafety.svalidator.sconn_fault_count",\r\nFT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_svalidator_state,\r\n{ "Safety Validator State", "cipsafety.svalidator.state",\r\nFT_UINT8, BASE_DEC, VALS(cip_svalidator_state_vals), 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_svalidator_type,\r\n{ "Safety Validator Type", "cipsafety.svalidator.type",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_svalidator_type_pc,\r\n{ "Producer/Consumer", "cipsafety.svalidator.type.pc",\r\nFT_UINT8, BASE_HEX, VALS(cip_svalidator_type_pc_vals), 0x80, NULL, HFILL }\r\n},\r\n{ &hf_cip_svalidator_type_conn_type,\r\n{ "Safety Connection Type", "cipsafety.svalidator.type.conn_type",\r\nFT_UINT8, BASE_DEC, VALS(cip_svalidator_type_conn_type_vals), 0x7F, NULL, HFILL }\r\n},\r\n{ &hf_cip_svalidator_ping_eri,\r\n{ "Ping Interval EPI Multipler", "cipsafety.svalidator.ping_eri",\r\nFT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_svalidator_time_coord_msg_min_mult_size,\r\n{ "Time Coord Msg Min Multiplier Size", "cipsafety.svalidator.time_coord_msg_min_mult.size",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_svalidator_time_coord_msg_min_mult_item,\r\n{ "Time Coord Msg Min Multiplier Item", "cipsafety.svalidator.time_coord_msg_min_mult.item",\r\nFT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_svalidator_network_time_multiplier_size,\r\n{ "Network Time Expectation Multipler Size", "cipsafety.svalidator.network_time_multiplier.size",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_svalidator_network_time_multiplier_item,\r\n{ "Network Time Expectation Multipler Item", "cipsafety.svalidator.network_time_multiplier.item",\r\nFT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_svalidator_timeout_multiplier_size,\r\n{ "Timeout Multiplier Size", "cipsafety.svalidator.timeout_multiplier.size",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_svalidator_timeout_multiplier_item,\r\n{ "Timeout Multiplier Item", "cipsafety.svalidator.timeout_multiplier.item",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_svalidator_max_consumer_num,\r\n{ "Max Consumer Number", "cipsafety.svalidator.max_consumer_num",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_svalidator_data_conn_inst,\r\n{ "Data Connection Instance", "cipsafety.svalidator.data_conn_inst",\r\nFT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_svalidator_coordination_conn_inst_size,\r\n{ "Coordination Connection Instance Size", "cipsafety.svalidator.coordination_conn_inst.size",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_svalidator_coordination_conn_inst_item,\r\n{ "Coordination Connection Instance Item", "cipsafety.svalidator.coordination_conn_inst.item",\r\nFT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_svalidator_correction_conn_inst,\r\n{ "Correction Connection Instance", "cipsafety.svalidator.correction_conn_inst",\r\nFT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_svalidator_cco_binding,\r\n{ "CCO Binding", "cipsafety.svalidator.cco_binding",\r\nFT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_svalidator_max_data_age,\r\n{ "Max Data Age", "cipsafety.svalidator.max_data_age",\r\nFT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_svalidator_error_code,\r\n{ "Error Code", "cipsafety.svalidator.error_code",\r\nFT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_svalidator_prod_cons_fault_count_size,\r\n{ "Producer/Consumer Counter Size", "cipsafety.svalidator.prod_cons_fault_count.size",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_cip_svalidator_prod_cons_fault_count_item,\r\n{ "Producer/Consumer Counter Item", "cipsafety.svalidator.prod_cons_fault_count.item",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }\r\n}\r\n};\r\nstatic gint *ett[] = {\r\n&ett_cip_safety,\r\n&ett_path,\r\n&ett_cipsafety_mode_byte,\r\n&ett_cipsafety_ack_byte,\r\n&ett_cipsafety_mcast_byte\r\n};\r\nstatic gint *ett_ssupervisor[] = {\r\n&ett_cip_class_s_supervisor,\r\n&ett_ssupervisor_rrsc,\r\n&ett_ssupervisor_cmd_data,\r\n&ett_ssupervisor_propose_tunid,\r\n&ett_ssupervisor_propose_tunid_ssn,\r\n&ett_ssupervisor_configure_request_tunid,\r\n&ett_ssupervisor_configure_request_tunid_ssn,\r\n&ett_ssupervisor_configure_request_ounid,\r\n&ett_ssupervisor_configure_request_ounid_ssn,\r\n&ett_ssupervisor_configure_lock_tunid,\r\n&ett_ssupervisor_configure_lock_tunid_ssn,\r\n&ett_ssupervisor_reset_tunid,\r\n&ett_ssupervisor_reset_tunid_ssn,\r\n&ett_ssupervisor_apply_tunid,\r\n&ett_ssupervisor_apply_tunid_ssn,\r\n&ett_exception_detail_alarm_common,\r\n&ett_exception_detail_alarm_device,\r\n&ett_exception_detail_alarm_manufacturer,\r\n&ett_exception_detail_warning_common,\r\n&ett_exception_detail_warning_device,\r\n&ett_exception_detail_warning_manufacturer,\r\n&ett_ssupervisor_configuration_unid,\r\n&ett_ssupervisor_configuration_unid_ssn,\r\n&ett_ssupervisor_safety_configuration_id,\r\n&ett_ssupervisor_safety_configuration_id_ssn,\r\n&ett_ssupervisor_target_unid,\r\n&ett_ssupervisor_target_unid_ssn,\r\n&ett_ssupervisor_output_cp_owners,\r\n&ett_ssupervisor_output_cp_owners_ocpunid,\r\n&ett_ssupervisor_output_cp_owners_ocpunid_ssn,\r\n&ett_ssupervisor_proposed_tunid,\r\n&ett_ssupervisor_proposed_tunid_ssn,\r\n&ett_cip_ssupervisor_reset_attr_bitmap\r\n};\r\nstatic gint *ett_svalidator[] = {\r\n&ett_cip_class_s_validator,\r\n&ett_svalidator_rrsc,\r\n&ett_svalidator_cmd_data,\r\n&ett_svalidator_type\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_cipsafety_tbd2_not_complemented, { "cipsafety.tbd2_not_complemented", PI_PROTOCOL, PI_WARN, "TBD_2_bit not complemented", EXPFILL }},\r\n{ &ei_cipsafety_tbd_not_copied, { "cipsafety.tbd_not_copied", PI_PROTOCOL, PI_WARN, "TBD bit not copied", EXPFILL }},\r\n{ &ei_cipsafety_run_idle_not_complemented, { "cipsafety.run_idle_not_complemented", PI_PROTOCOL, PI_WARN, "Run/Idle bit not complemented", EXPFILL }},\r\n{ &ei_mal_io, { "cipsafety.malformed.io", PI_MALFORMED, PI_ERROR, "Malformed CIP Safety I/O packet", EXPFILL }},\r\n{ &ei_mal_sercosiii_link_error_count_p1p2, { "cipsafety.malformed.sercosiii_link.error_count_p1p2", PI_MALFORMED, PI_ERROR, "Malformed SERCOS III Attribute 5", EXPFILL }},\r\n};\r\nstatic ei_register_info ei_ssupervisor[] = {\r\n{ &ei_mal_ssupervisor_exception_detail_alarm_ced, { "cipsafety.ssupervisor.malformed.exception_detail_alarm.ced", PI_MALFORMED, PI_ERROR,\r\n"Malformed Safety Supervisor Exception Detail Alarm (Common Exception Detail)", EXPFILL }},\r\n{ &ei_mal_ssupervisor_exception_detail_alarm_ded, { "cipsafety.ssupervisor.malformed.exception_detail_alarm.ded", PI_MALFORMED, PI_ERROR,\r\n"Malformed Safety Supervisor Exception Detail Alarm (Device Exception Detail)", EXPFILL }},\r\n{ &ei_mal_ssupervisor_exception_detail_alarm_med, { "cipsafety.ssupervisor.malformed.exception_detail_alarm.med", PI_MALFORMED, PI_ERROR,\r\n"Malformed Safety Supervisor Exception Detail Alarm (Manufacturer Exception Detail)", EXPFILL }},\r\n{ &ei_mal_ssupervisor_detail_warning_ced, { "cipsafety.ssupervisor.malformed.detail_warning.ced", PI_MALFORMED, PI_ERROR,\r\n"Malformed Safety Supervisor Exception Detail Warning (Common Exception Detail)", EXPFILL }},\r\n{ &ei_mal_ssupervisor_detail_warning_ded, { "cipsafety.ssupervisor.malformed.detail_warning.ded", PI_MALFORMED, PI_ERROR,\r\n"Malformed Safety Supervisor Exception Detail Warning (Device Exception Detail)", EXPFILL }},\r\n{ &ei_mal_ssupervisor_detail_warning_med, { "cipsafety.ssupervisor.malformed.detail_warning.med", PI_MALFORMED, PI_ERROR,\r\n"Malformed Safety Supervisor Exception Detail Warning (Manufacturer Exception Detail)", EXPFILL }},\r\n{ &ei_mal_ssupervisor_configuration_unid, { "cipsafety.ssupervisor.malformed.configuration_unid", PI_MALFORMED, PI_ERROR,\r\n"Malformed Safety Supervisor Configuration UNID", EXPFILL }},\r\n{ &ei_mal_ssupervisor_safety_configuration_id, { "cipsafety.ssupervisor.malformed.safety_configuration_id", PI_MALFORMED, PI_ERROR,\r\n"Malformed Safety Supervisor Safety Configuration Identifier", EXPFILL }},\r\n{ &ei_mal_ssupervisor_target_unid, { "cipsafety.ssupervisor.malformed.target_unid", PI_MALFORMED, PI_ERROR,\r\n"Malformed Safety Supervisor Target UNID", EXPFILL }},\r\n{ &ei_mal_ssupervisor_cp_owners, { "cipsafety.ssupervisor.malformed.cp_owners", PI_MALFORMED, PI_ERROR,\r\n"Malformed Safety Supervisor Output Connection Point Owners", EXPFILL }},\r\n{ &ei_mal_ssupervisor_cp_owners_entry, { "cipsafety.ssupervisor.malformed.cp_owners.entry", PI_MALFORMED, PI_ERROR,\r\n"Malformed Safety Supervisor Output Connection Point Owners (UNID)", EXPFILL }},\r\n{ &ei_mal_ssupervisor_cp_owners_app_path_size, { "cipsafety.ssupervisor.malformed.cp_owners.app_path_size", PI_MALFORMED, PI_ERROR,\r\n"Malformed Safety Supervisor Output Connection Point Owners (EPATH)", EXPFILL }},\r\n{ &ei_mal_ssupervisor_proposed_tunid, { "cipsafety.ssupervisor.malformed.proposed_tunid", PI_MALFORMED, PI_ERROR,\r\n"Malformed Safety Supervisor Proposed TUNID", EXPFILL }},\r\n};\r\nstatic ei_register_info ei_svalidator[] = {\r\n{ &ei_mal_svalidator_type, { "cipsafety.ssupervisor.malformed.svalidator.type", PI_MALFORMED, PI_ERROR,\r\n"Malformed Safety Validator Type", EXPFILL }},\r\n{ &ei_mal_svalidator_time_coord_msg_min_mult, { "cipsafety.ssupervisor.malformed.svalidator.time_coord_msg_min_mult", PI_MALFORMED, PI_ERROR,\r\n"Malformed Safety Validator Time Coord Msg Min Multiplier", EXPFILL }},\r\n{ &ei_mal_svalidator_network_time_multiplier, { "cipsafety.ssupervisor.malformed.svalidator.network_time_multiplier", PI_MALFORMED, PI_ERROR,\r\n"Malformed Safety Validator Network Time Expectation Multiplier", EXPFILL }},\r\n{ &ei_mal_svalidator_timeout_multiplier, { "cipsafety.ssupervisor.malformed.svalidator.timeout_multiplier", PI_MALFORMED, PI_ERROR,\r\n"Malformed Safety Validator Timeout Multiplier", EXPFILL }},\r\n{ &ei_mal_svalidator_coordination_conn_inst, { "cipsafety.ssupervisor.malformed.svalidator.coordination_conn_inst", PI_MALFORMED, PI_ERROR,\r\n"Malformed Safety Validator Coordination Connection Instance", EXPFILL }},\r\n{ &ei_mal_svalidator_prod_cons_fault_count, { "cipsafety.ssupervisor.malformed.svalidator.prod_cons_fault_count", PI_MALFORMED, PI_ERROR,\r\n"Malformed Safety Validator Produce/Consume Fault Counters", EXPFILL }},\r\n};\r\nexpert_module_t* expert_cip_safety;\r\nexpert_module_t* expert_cip_class_s_supervisor;\r\nexpert_module_t* expert_cip_class_s_validator;\r\nproto_cipsafety = proto_register_protocol("Common Industrial Protocol, Safety", "CIP Safety", "cipsafety");\r\nproto_register_field_array(proto_cipsafety, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_cip_safety = expert_register_protocol(proto_cipsafety);\r\nexpert_register_field_array(expert_cip_safety, ei, array_length(ei));\r\ncipsafety_handle = register_dissector( "cipsafety", dissect_cipsafety, proto_cipsafety);\r\nproto_cip_class_s_supervisor = proto_register_protocol("CIP Safety Supervisor",\r\n"CIPSSupervisor", "cipssupervisor");\r\nproto_register_field_array(proto_cip_class_s_supervisor, hf_ssupervisor, array_length(hf_ssupervisor));\r\nproto_register_subtree_array(ett_ssupervisor, array_length(ett_ssupervisor));\r\nexpert_cip_class_s_supervisor = expert_register_protocol(proto_cip_class_s_supervisor);\r\nexpert_register_field_array(expert_cip_class_s_supervisor, ei_ssupervisor, array_length(ei_ssupervisor));\r\nproto_cip_class_s_validator = proto_register_protocol("CIP Safety Validator",\r\n"CIPSValidator", "cipsvalidator");\r\nproto_register_field_array(proto_cip_class_s_validator, hf_svalidator, array_length(hf_svalidator));\r\nproto_register_subtree_array(ett_svalidator, array_length(ett_svalidator));\r\nexpert_cip_class_s_validator = expert_register_protocol(proto_cip_class_s_validator);\r\nexpert_register_field_array(expert_cip_class_s_validator, ei_svalidator, array_length(ei_svalidator));\r\n}\r\nvoid\r\nproto_reg_handoff_cipsafety(void)\r\n{\r\ndissector_handle_t cip_class_s_supervisor_handle;\r\ncip_class_s_supervisor_handle = create_dissector_handle( dissect_cip_class_s_supervisor, proto_cip_class_s_supervisor );\r\ndissector_add_uint( "cip.class.iface", CI_CLS_SAFETY_SUPERVISOR, cip_class_s_supervisor_handle );\r\ncip_class_s_validator_handle = create_dissector_handle( dissect_cip_class_s_validator, proto_cip_class_s_validator );\r\ndissector_add_uint( "cip.class.iface", CI_CLS_SAFETY_VALIDATOR, cip_class_s_validator_handle );\r\nheur_dissector_add("cip.sc", dissect_class_svalidator_heur, "CIP Safety Validator", "s_validator_cip", proto_cip_class_s_validator, HEURISTIC_ENABLE);\r\ndissector_add_for_decode_as("enip.io", cipsafety_handle );\r\nproto_cip = proto_get_id_by_filter_name( "cip" );\r\nsubdissector_class_table = find_dissector_table("cip.class.iface");\r\n}
