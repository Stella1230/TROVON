static gint16 dissect_mih_list(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree, gint16 (*base_dissect)(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree))\r\n{\r\nguint8 i = 0;\r\nguint8 list_len = tvb_get_guint8(tvb, offset);\r\noffset ++;\r\nfor(i=0; i < list_len; i++)\r\noffset = base_dissect(tvb, offset, tlv_tree);\r\nreturn (offset);\r\n}\r\nstatic gint16 dissect_ip_addr(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree)\r\n{\r\nguint16 addr_type = tvb_get_ntohs(tvb, offset);\r\nguint8 len = 0;\r\nif(addr_type == 1 )\r\n{\r\nlen = tvb_get_guint8(tvb, offset + 3);\r\nproto_tree_add_item(tlv_tree, hf_ipv4_addr, tvb, offset+2, len, ENC_BIG_ENDIAN);\r\nreturn (offset+3+len);\r\n}\r\nif(addr_type == 2)\r\n{\r\nlen = tvb_get_guint8(tvb, offset + 3);\r\nproto_tree_add_item(tlv_tree,hf_ipv6_addr, tvb, offset+2, len, ENC_NA);\r\nreturn (offset+3+len);\r\n}\r\nelse\r\n{\r\nlen = tvb_get_guint8(tvb, offset + 3);\r\nreturn (offset+3+len);\r\n}\r\n}\r\nstatic gint16 dissect_qos_val(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree)\r\n{\r\nproto_tree_add_item(tlv_tree, hf_cos_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++ ;\r\nproto_tree_add_item(tlv_tree, hf_cos_value, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nreturn (offset);\r\n}\r\nstatic gint16 dissect_link_addr(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree )\r\n{\r\nguint8 link_addr_choice = tvb_get_guint8(tvb, offset);\r\nguint8 len = 0;\r\nproto_tree_add_item(tlv_tree, hf_link_addr_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nswitch (link_addr_choice)\r\n{\r\ncase 0 :\r\nproto_tree_add_item(tlv_tree, hf_link_transport_addr_type, tvb, offset+1, 2, ENC_BIG_ENDIAN);\r\nif(tvb_get_ntohs(tvb, offset+1) == 0x06)\r\nproto_tree_add_item(tlv_tree, hf_mac_addr, tvb, offset+4, tvb_get_guint8(tvb, offset+3), ENC_NA);\r\nreturn (offset + 10);\r\ncase 1 :\r\nproto_tree_add_item(tlv_tree, hf_plmn_id, tvb, offset+1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_tree, hf_cell_id, tvb, offset+4, 4, ENC_BIG_ENDIAN);\r\nreturn (offset + 8);\r\ncase 2 :\r\nproto_tree_add_item(tlv_tree, hf_plmn_id, tvb, offset+1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_tree, hf_location_area_id, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_tree, hf_ci, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\nreturn (offset + 8);\r\ncase 3 :\r\ncase 4 :\r\ncase 5 :\r\nlen = tvb_get_guint8(tvb, offset+1);\r\nproto_tree_add_item(tlv_tree, hf_link_addr_string, tvb, offset+2, len, ENC_ASCII|ENC_NA);\r\nreturn (offset + 2 + len);\r\n}\r\nreturn 0;\r\n}\r\nstatic gint16 dissect_tsp_container(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree)\r\n{\r\nguint8 len = 0;\r\nif(tvb_get_guint8(tvb, offset) == 1)\r\n{\r\nproto_tree_add_item(tlv_tree, hf_predef_cfg_id, tvb, offset+1, 1, ENC_BIG_ENDIAN);\r\nreturn (offset + 2);\r\n}\r\nelse if(tvb_get_guint8(tvb, offset) == 2)\r\n{\r\nlen = tvb_get_guint8(tvb, offset+1);\r\nproto_tree_add_item(tlv_tree, hf_tsp_carrier, tvb, offset+2, len, ENC_ASCII|ENC_NA);\r\nreturn (offset + len + 2);\r\n}\r\nelse\r\nreturn (offset + 1);\r\n}\r\nstatic gint16 dissect_iq_rdf_data(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree)\r\n{\r\nguint8 len = 0;\r\nif(tvb_get_guint8(tvb, offset))\r\n{\r\nlen = tvb_get_guint8(tvb, offset+1);\r\nproto_tree_add_item(tlv_tree, hf_rdf_mime_type, tvb, offset+2, len, ENC_ASCII|ENC_NA);\r\noffset += len + 1;\r\n}\r\noffset++;\r\nlen = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tlv_tree, hf_rdf_data, tvb, offset+1, len, ENC_ASCII|ENC_NA);\r\nreturn (offset+len+1);\r\n}\r\nstatic gint16 dissect_qos_list(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree)\r\n{\r\nproto_tree *subtree;\r\nproto_tree_add_item(tlv_tree, hf_num_cos, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nsubtree = proto_tree_add_subtree(tlv_tree, tvb, offset, 1, ett_min_pk_tx_delay, NULL, "MIN_PK_TX_DELAY");\r\noffset = dissect_mih_list(tvb, offset, subtree, dissect_qos_val);\r\nsubtree = proto_tree_add_subtree(tlv_tree, tvb, offset, 1, ett_avg_pk_tx_delay, NULL, "AVG_PK_TX_DELAY");\r\noffset = dissect_mih_list(tvb, offset, subtree, dissect_qos_val);\r\nsubtree = proto_tree_add_subtree(tlv_tree, tvb, offset, 1, ett_max_pk_tx_delay, NULL, "MAX_PK_TX_DELAY");\r\noffset = dissect_mih_list(tvb, offset, subtree, dissect_qos_val);\r\nsubtree = proto_tree_add_subtree(tlv_tree, tvb, offset, 1, ett_pk_delay_jitter, NULL, "PK_DELAY_JITTER");\r\noffset = dissect_mih_list(tvb, offset, subtree, dissect_qos_val);\r\nsubtree = proto_tree_add_subtree(tlv_tree, tvb, offset, 1, ett_pk_loss_rate, NULL, "PK_LOSS_RATE");\r\noffset = dissect_mih_list(tvb, offset, subtree, dissect_qos_val);\r\nreturn (offset);\r\n}\r\nstatic gint16 dissect_dev_states(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree)\r\n{\r\nguint8 len = 0;\r\nproto_tree *sub_tree = NULL;\r\nsub_tree = proto_tree_add_item(tlv_tree, hf_dev_states_resp, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nif(tvb_get_guint8(tvb, offset))\r\n{\r\noffset++;\r\nproto_tree_add_item(sub_tree, hf_dev_batt_level, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nreturn (offset+1);\r\n}\r\nelse\r\n{\r\noffset++;\r\nlen = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(sub_tree, hf_dev_info, tvb, offset+1, len, ENC_ASCII|ENC_NA);\r\nreturn (offset + len + 1);\r\n}\r\n}\r\nstatic gint16 dissect_net_type(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree)\r\n{\r\nguint8 len = 0;\r\nguint8 type = 0;\r\nif(!tvb_get_guint8(tvb, offset))\r\n{\r\ntype = tvb_get_guint8(tvb, offset+1);\r\nproto_tree_add_item(tlv_tree, hf_link_type, tvb, offset+1, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\noffset += 1;\r\nif(!tvb_get_guint8(tvb, offset))\r\n{\r\nswitch (type)\r\n{\r\ncase 15 :\r\nproto_tree_add_bitmask(tlv_tree, tvb, offset+1, hf_link_subtype_eth, ett_subtype_eth_bitmap, subtype_eth_fields, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 18 :\r\nproto_tree_add_bitmask(tlv_tree, tvb, offset+1, hf_link_subtype_wireless_other, ett_subtype_wireless_other_bitmap, subtype_wireless_other_fields, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 19 :\r\nproto_tree_add_bitmask(tlv_tree, tvb, offset+1, hf_link_subtype_ieee80211, ett_subtype_ieee80211_bitmap, subtype_ieee80211_fields, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 23 :\r\nproto_tree_add_bitmask(tlv_tree, tvb, offset+1, hf_link_subtype_umts, ett_subtype_umts_bitmap, subtype_umts_fields, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 24 :\r\nproto_tree_add_bitmask(tlv_tree, tvb, offset+1, hf_link_subtype_cdma2000, ett_subtype_cdma2000_bitmap, subtype_cdma2000_fields, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 27 :\r\nproto_tree_add_bitmask(tlv_tree, tvb, offset+1, hf_link_subtype_ieee80216, ett_subtype_ieee80216_bitmap, subtype_ieee80216_fields, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault :\r\nproto_item_append_text(tlv_tree, "N/A");\r\n}\r\noffset += 8;\r\n}\r\noffset += 1;\r\nif(!tvb_get_guint8(tvb, offset))\r\n{\r\nlen = tvb_get_guint8(tvb, offset+1);\r\nproto_tree_add_item(tlv_tree, hf_link_type_ext, tvb, offset+2, len, ENC_ASCII|ENC_NA);\r\noffset += len + 2;\r\n}\r\nreturn (offset);\r\n}\r\nstatic gint16 dissect_net_type_addr(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree)\r\n{\r\noffset = dissect_net_type(tvb, offset, tlv_tree);\r\noffset = dissect_link_addr(tvb, offset, tlv_tree);\r\nreturn (offset) ;\r\n}\r\nstatic gint16 dissect_mbb_ho_supp(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree)\r\n{\r\noffset = dissect_net_type(tvb, offset, tlv_tree);\r\noffset = dissect_net_type(tvb, offset, tlv_tree);\r\nproto_tree_add_item(tlv_tree, hf_mbb_ho_supp, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn (offset);\r\n}\r\nstatic gint16 dissect_tgt_net_info(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree)\r\n{\r\nguint8 len = 0;\r\nif(!tvb_get_guint8(tvb, offset))\r\n{\r\noffset +=1;\r\nlen = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tlv_tree, hf_network_id, tvb, offset+1, len, ENC_ASCII|ENC_NA);\r\noffset += len + 2;\r\nif(!tvb_get_guint8(tvb, offset))\r\n{\r\noffset +=1;\r\nlen = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tlv_tree, hf_net_aux_id, tvb, offset+1, len, ENC_ASCII|ENC_NA);\r\nreturn (offset + 1);\r\n}\r\nreturn (offset + 2);\r\n}\r\nelse\r\n{\r\noffset +=1;\r\noffset = dissect_link_addr(tvb, offset, tlv_tree);\r\nreturn (offset);\r\n}\r\n}\r\nstatic gint16 dissect_link_id(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree)\r\n{\r\ngint16 next_offset = 0;\r\nproto_tree_add_item(tlv_tree, hf_link_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nnext_offset = dissect_link_addr(tvb, offset+1, tlv_tree);\r\nreturn (next_offset);\r\n}\r\nstatic gint16 dissect_link_poa(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree)\r\n{\r\noffset = dissect_link_id(tvb, offset, tlv_tree);\r\noffset = dissect_mih_list(tvb, offset, tlv_tree, dissect_link_addr);\r\nreturn (offset);\r\n}\r\nstatic gint16 dissect_rq_result(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree)\r\n{\r\nproto_tree *subtree;\r\nsubtree = proto_tree_add_subtree(tlv_tree, tvb, offset, 1, ett_list_prefer_link, NULL, "List of preferred links");\r\noffset = dissect_link_poa(tvb, offset, subtree);\r\noffset = dissect_qos_list(tvb, offset, tlv_tree);\r\noffset++;\r\nswitch(tvb_get_guint8(tvb, offset-1))\r\n{\r\ncase 1:\r\nproto_tree_add_item(tlv_tree, hf_ip_methods_supported, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nbreak;\r\ncase 2:\r\nproto_tree_add_bitmask(tlv_tree, tvb, offset, hf_cfg_mthds, ett_cfg_mtd_bitmap, cfg_fields, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nbreak;\r\n}\r\noffset++;\r\nswitch(tvb_get_guint8(tvb, offset-1))\r\n{\r\ncase 1:\r\nproto_tree_add_item(tlv_tree, hf_ip_dhcp_services, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nbreak;\r\ncase 2: subtree = proto_tree_add_subtree(tlv_tree, tvb, offset, 1, ett_ip_dhcp_server, NULL, "IP DHCP server");\r\noffset = dissect_ip_addr(tvb, offset, subtree);\r\nbreak;\r\n}\r\noffset++;\r\nswitch(tvb_get_guint8(tvb, offset-1))\r\n{\r\ncase 1:\r\nproto_tree_add_item(tlv_tree, hf_fn_agent, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nbreak;\r\ncase 2: subtree = proto_tree_add_subtree(tlv_tree, tvb, offset, 1, ett_fn_agent, NULL, "FN Agent");\r\noffset = dissect_ip_addr(tvb, offset, subtree);\r\nbreak;\r\n}\r\noffset++;\r\nswitch(tvb_get_guint8(tvb, offset-1))\r\n{\r\ncase 1:\r\nproto_tree_add_item(tlv_tree, hf_access_router, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nbreak;\r\ncase 2: subtree = proto_tree_add_subtree(tlv_tree, tvb, offset, 1, ett_access_router, NULL, "Access Router");\r\noffset = dissect_ip_addr(tvb, offset, subtree);\r\nbreak;\r\n}\r\nreturn (offset+1);\r\n}\r\nstatic gint16 dissect_link_det_info(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree)\r\n{\r\nguint8 len = 0;\r\noffset = dissect_link_id(tvb, offset, tlv_tree);\r\nif(tvb_get_guint8(tvb, offset))\r\n{\r\noffset++;\r\noffset = dissect_link_addr(tvb, offset, tlv_tree);\r\noffset --;\r\n}\r\noffset++;\r\nlen = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tlv_tree, hf_network_id, tvb, offset+1, len, ENC_ASCII|ENC_NA);\r\noffset += len + 1;\r\nlen = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tlv_tree, hf_net_aux_id, tvb, offset+1, len, ENC_ASCII|ENC_NA);\r\noffset += len + 1;\r\nif(tvb_get_guint8(tvb, offset))\r\nproto_tree_add_item(tlv_tree, hf_sig_strength_per, tvb, offset+1, 1, ENC_BIG_ENDIAN);\r\nelse\r\nproto_tree_add_item(tlv_tree, hf_sig_strength_dbm, tvb, offset+1, 1, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tlv_tree, hf_sinr, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tlv_tree, hf_link_data_rate, tvb, offset,4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_bitmask(tlv_tree, tvb, offset, hf_mihcap, ett_mihcap_bitmap, mihcap_fields, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_bitmask(tlv_tree, tvb, offset, hf_net_caps, ett_net_caps_bitmap, net_caps_fields, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nreturn (offset);\r\n}\r\nstatic gint16 dissect_link_scan_rsp(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree)\r\n{\r\nguint8 len = 0;\r\noffset = dissect_link_addr(tvb, offset, tlv_tree);\r\nlen = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tlv_tree, hf_network_id, tvb, offset+1, len, ENC_ASCII|ENC_NA);\r\noffset = offset + len + 1;\r\nif(tvb_get_guint8(tvb, offset))\r\nproto_tree_add_item(tlv_tree, hf_sig_strength_per, tvb, offset+1, 1, ENC_BIG_ENDIAN);\r\nelse\r\nproto_tree_add_item(tlv_tree, hf_sig_strength_dbm, tvb, offset+1, 1, ENC_BIG_ENDIAN);\r\nreturn offset+2;\r\n}\r\nstatic gint16 dissect_link_action_rsp(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree)\r\n{\r\noffset = dissect_link_id(tvb, offset, tlv_tree);\r\nproto_tree_add_item(tlv_tree, hf_link_ac_result, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nif(tvb_get_guint8(tvb, offset))\r\n{\r\noffset = dissect_mih_list(tvb, offset+1, tlv_tree, dissect_link_scan_rsp);\r\nreturn offset;\r\n}\r\nelse\r\nreturn (offset+1);\r\n}\r\nstatic gint16 dissect_link_action_req(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree)\r\n{\r\noffset = dissect_link_id(tvb, offset, tlv_tree);\r\nif(tvb_get_guint8(tvb, offset))\r\n{\r\noffset = dissect_link_addr(tvb, offset+1, tlv_tree);\r\n}\r\nelse\r\n{\r\noffset++;\r\n}\r\nproto_tree_add_item(tlv_tree, hf_link_ac_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_bitmask(tlv_tree, tvb, offset, hf_link_ac_attr, ett_ac_attr_bitmap, ac_attr_fields, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(tlv_tree, hf_link_ac_ext_time, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nreturn (offset+2);\r\n}\r\nstatic gint16 dissect_link_states_rsp(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree)\r\n{\r\nif(!tvb_get_guint8(tvb, offset))\r\n{\r\nproto_tree_add_item(tlv_tree, hf_op_mode, tvb, offset+1, 1, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tlv_tree, hf_channel_id, tvb, offset+1, 2, ENC_BIG_ENDIAN);\r\noffset += 3;\r\n}\r\nreturn (offset);\r\n}\r\nstatic gint16 dissect_link_param_type(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree)\r\n{\r\nguint8 type = tvb_get_guint8(tvb, offset);\r\noffset++;\r\nswitch (type)\r\n{\r\ncase 0 :\r\nproto_tree_add_item(tlv_tree, hf_link_param_gen, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 1 :\r\nproto_tree_add_item(tlv_tree, hf_link_param_qos, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 2 :\r\nproto_tree_add_item(tlv_tree, hf_link_param_gg, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 3 :\r\nproto_tree_add_item(tlv_tree, hf_link_param_edge, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 4 :\r\nproto_tree_add_item(tlv_tree, hf_link_param_eth, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 5 :\r\nproto_tree_add_item(tlv_tree, hf_link_param_802_11, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 6 :\r\nproto_tree_add_item(tlv_tree, hf_link_param_c2k, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 7 :\r\nproto_tree_add_item(tlv_tree, hf_link_param_fdd, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 8 :\r\nproto_tree_add_item(tlv_tree, hf_link_param_hrpd, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 9 :\r\nproto_tree_add_item(tlv_tree, hf_link_param_802_16, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 10 :\r\nproto_tree_add_item(tlv_tree, hf_link_param_802_20, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 11 :\r\nproto_tree_add_item(tlv_tree, hf_link_param_802_22, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\nreturn (offset+1);\r\n}\r\nstatic void dissect_link_status_req(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree)\r\n{\r\nproto_tree *subtree;\r\nguint16 temp = tvb_get_ntohs(tvb, offset);\r\nif(!temp)\r\n{\r\nsubtree = proto_tree_add_subtree(tlv_tree, tvb, offset, 3, ett_link_states_req, NULL, "LINK_STATES_REQ: ");\r\nproto_tree_add_item(subtree, hf_op_mode, tvb, offset+2, 1, ENC_BIG_ENDIAN);\r\noffset+=3;\r\n}\r\nelse\r\n{\r\nsubtree = proto_tree_add_subtree(tlv_tree, tvb, offset, 4, ett_link_states_req, NULL, "LINK_STATES_REQ: ");\r\nproto_tree_add_item(subtree, hf_channel_id, tvb, offset+2, 2, ENC_BIG_ENDIAN);\r\noffset+=4;\r\n}\r\noffset = dissect_mih_list(tvb, offset, tlv_tree, dissect_link_param_type);\r\ntemp = tvb_get_ntohs(tvb, offset);\r\nsubtree = proto_tree_add_subtree(tlv_tree, tvb, offset, 3, ett_link_desc_req, NULL, "LINK_DESC_REQ");\r\noffset+=2;\r\nif(!temp)\r\nproto_tree_add_item(subtree, hf_num_cos, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nelse\r\nproto_tree_add_item(subtree, hf_num_queue, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic gint16 dissect_link_cfg_status(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree)\r\n{\r\noffset = dissect_link_param_type(tvb, offset, tlv_tree);\r\nproto_tree_add_item(tlv_tree, hf_threshold_val, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tlv_tree, hf_threshold_x_dir, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset ++;\r\nproto_tree_add_item(tlv_tree, hf_config_status, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nreturn (offset+1);\r\n}\r\nstatic gint16 dissect_link_param(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree)\r\n{\r\noffset = dissect_link_param_type(tvb, offset, tlv_tree);\r\nif(!tvb_get_guint8(tvb, offset))\r\n{\r\noffset ++;\r\nproto_tree_add_item(tlv_tree, hf_link_param_value, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\nelse\r\n{\r\nproto_tree *subtree;\r\noffset ++;\r\nswitch(tvb_get_guint8(tvb, offset))\r\n{\r\ncase 0:\r\nproto_tree_add_item(tlv_tree, hf_num_cos, tvb, offset+1, 1, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nbreak;\r\ncase 1:\r\nsubtree = proto_tree_add_subtree(tlv_tree, tvb, offset+1, 1, ett_min_pk_tx_delay, NULL, "MIN_PK_TX_DELAY");\r\noffset = dissect_mih_list(tvb, offset+1, subtree, dissect_qos_val);\r\nbreak;\r\ncase 2:\r\nsubtree = proto_tree_add_subtree(tlv_tree, tvb, offset+1, 1, ett_avg_pk_tx_delay, NULL, "AVG_PK_TX_DELAY");\r\noffset = dissect_mih_list(tvb, offset+1, subtree, dissect_qos_val);\r\nbreak;\r\ncase 3:\r\nsubtree = proto_tree_add_subtree(tlv_tree, tvb, offset+1, 1, ett_max_pk_tx_delay, NULL, "MAX_PK_TX_DELAY");\r\noffset = dissect_mih_list(tvb, offset+1, subtree, dissect_qos_val);\r\nbreak;\r\ncase 4:\r\nsubtree = proto_tree_add_subtree(tlv_tree, tvb, offset+1, 1, ett_pk_delay_jitter, NULL, "PK_DELAY_JITTER");\r\noffset = dissect_mih_list(tvb, offset+1, subtree, dissect_qos_val);\r\nbreak;\r\ncase 5:\r\nsubtree = proto_tree_add_subtree(tlv_tree, tvb, offset+1, 1, ett_pk_loss_rate, NULL, "PK_LOSS_RATE");\r\noffset = dissect_mih_list(tvb, offset+1, subtree, dissect_qos_val);\r\nbreak;\r\n}\r\n}\r\nreturn offset;\r\n}\r\nstatic gint16 dissect_link_param_rpt(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree)\r\n{\r\noffset = dissect_link_param(tvb, offset, tlv_tree);\r\nif(tvb_get_guint8(tvb, offset))\r\n{\r\noffset++;\r\nproto_tree_add_item(tlv_tree, hf_threshold_val, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tlv_tree, hf_threshold_x_dir, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nreturn (offset+1);\r\n}\r\nelse\r\nreturn (offset+1);\r\n}\r\nstatic gint16 dissect_link_desc_rsp(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree)\r\n{\r\nif(!tvb_get_guint8(tvb, offset))\r\nproto_tree_add_item(tlv_tree, hf_num_cos, tvb, offset+1, 1, ENC_BIG_ENDIAN);\r\nelse\r\nproto_tree_add_item(tlv_tree, hf_num_queue, tvb, offset+1, 1, ENC_BIG_ENDIAN);\r\nreturn (offset+2);\r\n}\r\nstatic gint16 dissect_status_list(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree)\r\n{\r\noffset = dissect_link_id(tvb, offset, tlv_tree);\r\noffset = dissect_mih_list(tvb, offset, tlv_tree, dissect_link_states_rsp);\r\noffset = dissect_mih_list(tvb, offset, tlv_tree, dissect_link_param);\r\noffset = dissect_mih_list(tvb, offset, tlv_tree, dissect_link_desc_rsp);\r\nreturn offset;\r\n}\r\nstatic gint16 dissect_link_det_cfg(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree)\r\n{\r\nguint8 len = 0;\r\nif(tvb_get_guint8(tvb, offset))\r\n{\r\nlen = tvb_get_guint8(tvb, offset+1);\r\nproto_tree_add_item(tlv_tree, hf_network_id, tvb, offset+2, len, ENC_ASCII|ENC_NA);\r\noffset += len + 1;\r\n}\r\noffset++;\r\nif(tvb_get_guint8(tvb, offset))\r\n{\r\nif(tvb_get_guint8(tvb, offset+1))\r\nproto_tree_add_item(tlv_tree, hf_sig_strength_per, tvb, offset+2, 1, ENC_BIG_ENDIAN);\r\nelse\r\nproto_tree_add_item(tlv_tree, hf_sig_strength_dbm, tvb, offset+2, 1, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\noffset++;\r\nif(tvb_get_guint8(tvb, offset))\r\n{\r\nproto_tree_add_item(tlv_tree, hf_link_data_rate, tvb, offset+1,4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\n}\r\nreturn (offset+1);\r\n}\r\nstatic gint16 dissect_link_cfg_param(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree)\r\n{\r\noffset = dissect_link_param_type(tvb, offset, tlv_tree);\r\nif(tvb_get_guint8(tvb, offset))\r\n{\r\nproto_tree_add_item(tlv_tree, hf_time_interval, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\noffset++;\r\nproto_tree_add_item(tlv_tree, hf_threshold_action, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(tlv_tree, hf_threshold_val, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tlv_tree, hf_threshold_x_dir, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nreturn (offset+1) ;\r\n}\r\nstatic gint16 dissect_mih_evt_cfg_info(tvbuff_t *tvb, gint16 offset, proto_tree *tlv_tree)\r\n{\r\noffset = dissect_mih_list(tvb, offset, tlv_tree, dissect_link_det_cfg);\r\noffset = dissect_mih_list(tvb, offset, tlv_tree, dissect_link_cfg_param);\r\nreturn offset;\r\n}\r\nstatic void dissect_mih_tlv(tvbuff_t *tvb,int offset, proto_tree *tlv_tree, guint8 type, guint32 length)\r\n{\r\nguint8 mihf_id_len = 0;\r\nchar mihf_id_first_char = 0;\r\nguint8 i = 0;\r\nguint8 len = 0;\r\ntvbuff_t *volatile tvb_mihf_id = NULL;\r\ntvbuff_t* tvb_temp = NULL;\r\nvolatile gboolean composite_error = FALSE;\r\nswitch (type)\r\n{\r\ncase SRC_MIHF_ID :\r\ncase DEST_MIHF_ID :\r\ncase MN_MIHF_ID :\r\nmihf_id_len = tvb_get_guint8(tvb, offset);\r\nmihf_id_first_char = (char)tvb_get_guint8(tvb, offset+1);\r\nif(mihf_id_first_char!='\\')\r\nproto_tree_add_item(tlv_tree, hf_mihf_id, tvb, offset+1, mihf_id_len, ENC_ASCII|ENC_NA);\r\nelse\r\n{\r\nif(mihf_id_len<tvb_reported_length_remaining(tvb,0) && (mihf_id_len==12 || mihf_id_len==64 || mihf_id_len==128))\r\n{\r\ntvb_mihf_id = tvb_new_composite();\r\nfor(i=0; i < mihf_id_len/2; i++)\r\n{\r\ntvb_temp = tvb_new_subset_length(tvb, offset + 2 + 2*i, 1);\r\ntvb_composite_append(tvb_mihf_id, tvb_temp);\r\n}\r\nTRY\r\n{\r\ntvb_composite_finalize(tvb_mihf_id);\r\n}\r\nCATCH_ALL\r\n{\r\ncomposite_error = TRUE;\r\n}\r\nENDTRY;\r\nif(!composite_error)\r\n{\r\nswitch(mihf_id_len)\r\n{\r\ncase 12:\r\nproto_tree_add_item(tlv_tree, hf_mihf_id_mac, tvb_mihf_id, 0, mihf_id_len/2, ENC_NA);\r\nbreak;\r\ncase 64:\r\nproto_tree_add_item(tlv_tree, hf_mihf_id_ipv4, tvb_mihf_id, 0, mihf_id_len/2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 128:\r\nproto_tree_add_item(tlv_tree, hf_mihf_id_ipv6, tvb_mihf_id, 0, mihf_id_len/2, ENC_NA);\r\nbreak;\r\n}\r\n}\r\nelse\r\ntvb_free(tvb_mihf_id);\r\n}\r\n}\r\nbreak;\r\ncase STATUS :\r\nproto_tree_add_item(tlv_tree, hf_status, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LINK_TYPE :\r\nproto_tree_add_item(tlv_tree, hf_link_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase MIH_EVT_LIST :\r\nproto_tree_add_bitmask(tlv_tree, tvb, offset, hf_event_list, ett_event_bitmap, event_fields, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase MIH_CMD_LIST :\r\nproto_tree_add_bitmask(tlv_tree, tvb, offset, hf_cmd_list, ett_cmd_bitmap, cmd_fields, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase MIH_IQ_TYPE_LIST :\r\nproto_tree_add_bitmask(tlv_tree, tvb, offset, hf_iq_list, ett_iq_type_bitmap, iq_type_fields, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase MIH_TRANS_LIST :\r\nproto_tree_add_bitmask(tlv_tree, tvb, offset, hf_trans_list, ett_trans_list_bitmap, trans_fields, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LINK_ADDR_LIST :\r\ndissect_mih_list(tvb, offset, tlv_tree, dissect_net_type_addr);\r\nbreak;\r\ncase MBB_HO_SUPP_LIST :\r\ndissect_mih_list(tvb, offset, tlv_tree, dissect_mbb_ho_supp);\r\nbreak;\r\ncase REG_REQUEST_CODE :\r\nproto_tree_add_item(tlv_tree, hf_reg_request_code, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase VALID_TIME_INTR :\r\nproto_tree_add_item(tlv_tree, hf_valid_time_interval, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LINK_ID :\r\ncase NEW_LINK_ID :\r\ncase MN_LINK_ID :\r\ndissect_link_id(tvb, offset, tlv_tree);\r\nbreak;\r\ncase OLD_ACCESS_ROUTER :\r\ncase NEW_ACCESS_ROUTER :\r\ncase POA_LINK_ADDR :\r\ndissect_link_addr(tvb, offset, tlv_tree);\r\nbreak;\r\ncase IP_RENEWAL_FLAG :\r\nproto_tree_add_item(tlv_tree, hf_ip_renewal, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase IP_MOB_MGMT :\r\nproto_tree_add_bitmask(tlv_tree, tvb, offset, hf_mob_list, ett_mob_mgt_bitmap, mob_fields, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase IP_CFG_MTHDS :\r\nproto_tree_add_bitmask(tlv_tree, tvb, offset, hf_cfg_mthds, ett_cfg_mtd_bitmap, cfg_fields, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LINK_DN_REASON :\r\nproto_tree_add_item(tlv_tree, hf_link_dn_reason, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase TIMER_INTERVAL :\r\nproto_tree_add_item(tlv_tree, hf_time_interval, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LINK_GOING_DN_REASON :\r\nproto_tree_add_item(tlv_tree, hf_link_gdn_reason, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LINK_PARAM_RPT_LIST :\r\ndissect_mih_list(tvb, offset, tlv_tree, dissect_link_param_rpt);\r\nbreak;\r\ncase DEV_STATES_REQ :\r\nproto_tree_add_bitmask(tlv_tree, tvb, offset, hf_dev_states_req, ett_dev_states_bitmap, dev_states_fields, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LINK_ID_LIST :\r\ndissect_mih_list(tvb, offset, tlv_tree, dissect_link_id);\r\nbreak;\r\ncase DEV_STATES_RSP_LIST :\r\ndissect_mih_list(tvb, offset, tlv_tree, dissect_dev_states);\r\nbreak;\r\ncase STATUS_REQ_SET :\r\ndissect_link_status_req(tvb, offset, tlv_tree);\r\nbreak;\r\ncase STATUS_RSP_LIST :\r\ndissect_mih_list(tvb, offset, tlv_tree, dissect_status_list);\r\nbreak;\r\ncase CFG_REQ_LIST :\r\ndissect_mih_list(tvb, offset, tlv_tree, dissect_link_cfg_param);\r\nbreak;\r\ncase CFG_RSP_LIST :\r\ndissect_mih_list(tvb, offset, tlv_tree, dissect_link_cfg_status);\r\nbreak;\r\ncase LINK_POA_LIST :\r\ndissect_mih_list(tvb, offset, tlv_tree, dissect_link_poa);\r\nbreak;\r\ncase PREF_LINK_LIST :\r\ndissect_mih_list(tvb, offset, tlv_tree, dissect_rq_result);\r\nbreak;\r\ncase HO_REQ_QUERY_LIST :\r\ndissect_qos_list(tvb, offset, tlv_tree);\r\nbreak;\r\ncase HO_STATUS:\r\nproto_tree_add_item(tlv_tree, hf_ho_status, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase ACCESS_ROUTER_ADDR :\r\ncase DHCP_SER_ADDR :\r\ncase FA_ADDR :\r\ndissect_ip_addr(tvb, offset, tlv_tree);\r\nbreak;\r\ncase LINK_ACTION_REQ_LIST :\r\ndissect_mih_list(tvb, offset, tlv_tree, dissect_link_action_req);\r\nbreak;\r\ncase LINK_ACTION_RSP_LIST :\r\ndissect_mih_list(tvb, offset, tlv_tree, dissect_link_action_rsp);\r\nbreak;\r\ncase HO_RESULT :\r\nproto_tree_add_item(tlv_tree, hf_status, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LINK_RES_STATUS :\r\nproto_tree_add_item(tlv_tree, hf_link_res_status, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase RES_RETENTION_STATUS :\r\nproto_tree_add_item(tlv_tree, hf_res_retention_status, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase IQ_RDF_SCHEMA_URL :\r\nproto_tree_add_item(tlv_tree, hf_iq_rdf_sch_url, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase Q_RES_RPT_FLAG :\r\nproto_tree_add_item(tlv_tree, hf_res_rpt_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase UNAUTH_INFO_REQ :\r\nproto_tree_add_item(tlv_tree, hf_unauth_info_req, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase IQ_BIN_DATA_LIST :\r\nproto_tree_add_item(tlv_tree, hf_iq_bin_data_x, tvb, offset, length, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase IQ_RDF_DATA_LIST :\r\ncase IR_RDF_DATA_LIST :\r\ncase IR_RDF_SCHM_LIST :\r\ndissect_mih_list(tvb, offset, tlv_tree, dissect_iq_rdf_data);\r\nbreak;\r\ncase IQ_RDF_SCHM_LIST :\r\nfor(i=0; i < tvb_get_guint8(tvb, offset); i++)\r\n{\r\nlen = tvb_get_guint8(tvb, offset+1);\r\nproto_tree_add_item(tlv_tree, hf_rdf_sch, tvb, offset+2, len, ENC_ASCII|ENC_NA);\r\noffset += len;\r\n}\r\nbreak;\r\ncase MAX_RSP_SIZE :\r\nproto_tree_add_item(tlv_tree, hf_max_resp_size, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase IR_BIN_DATA_LIST :\r\nproto_tree_add_item(tlv_tree, hf_ir_bin_data, tvb, offset, length, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase IR_SCHM_URL_LIST :\r\nfor(i=0; i < tvb_get_guint8(tvb, offset); i++)\r\n{\r\nlen = tvb_get_guint8(tvb, offset+1);\r\nproto_tree_add_item(tlv_tree, hf_rdf_sch_url, tvb, offset+2, len, ENC_ASCII|ENC_NA);\r\noffset += len;\r\n}\r\nbreak;\r\ncase EVT_CFG_INFO_LIST :\r\ndissect_mih_list(tvb, offset, tlv_tree, dissect_mih_evt_cfg_info);\r\nbreak;\r\ncase TGT_NET_INFO :\r\ndissect_tgt_net_info(tvb, offset, tlv_tree);\r\nbreak;\r\ncase TGT_NET_INFO_LIST :\r\ndissect_mih_list(tvb, offset, tlv_tree, dissect_tgt_net_info);\r\nbreak;\r\ncase ASGN_RES_SET :\r\noffset = dissect_qos_list(tvb, offset, tlv_tree);\r\ndissect_tsp_container(tvb, offset, tlv_tree);\r\nbreak;\r\ncase LINK_DET_INFO_LIST :\r\ndissect_mih_list(tvb, offset, tlv_tree, dissect_link_det_info);\r\nbreak;\r\ncase NET_TYPE :\r\ndissect_net_type(tvb, offset, tlv_tree);\r\nbreak;\r\ncase REQ_RES_SET :\r\noffset = dissect_qos_list(tvb, offset, tlv_tree);\r\noffset = dissect_tsp_container(tvb, offset, tlv_tree);\r\nproto_tree_add_item(tlv_tree, hf_ho_reason, tvb, offset, 1, ENC_BIG_ENDIAN );\r\nbreak;\r\ncase VEND_SPECIFIC_TLV :\r\nproto_tree_add_item(tlv_tree, hf_vendor_specific_tlv, tvb, offset, length, ENC_ASCII|ENC_NA);\r\nbreak;\r\ndefault :\r\nif(type > 63 && type < 100)\r\nproto_tree_add_item(tlv_tree, hf_reserved_tlv, tvb, offset, length, ENC_ASCII|ENC_NA);\r\nelse if(type > 100 && type < 255)\r\nproto_tree_add_item(tlv_tree, hf_experimental_tlv, tvb, offset, length, ENC_ASCII|ENC_NA);\r\nelse\r\nproto_tree_add_item(tlv_tree, hf_unknown_tlv, tvb, offset, length, ENC_ASCII|ENC_NA);\r\n}\r\nreturn;\r\n}\r\nstatic int dissect_mih(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nproto_item *ti = NULL;\r\nint offset = 0;\r\nproto_item *item = NULL;\r\nproto_tree *mih_tree = NULL;\r\nproto_tree *ver_flags_tree = NULL;\r\nguint8 serviceid = 0;\r\nguint8 opcode = 0;\r\nguint8 service = 0;\r\nguint16 action = 0;\r\ngint32 payload_length = 0;\r\nguint64 len = 0;\r\nguint8 len_of_len = 0;\r\nguint8 type = 0;\r\nproto_tree *mid_tree = NULL;\r\nproto_tree *tlv_tree = NULL;\r\nguint8 fragment = 0;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "MIH");\r\ncol_clear(pinfo->cinfo,COL_INFO);\r\nti = proto_tree_add_item(tree, proto_mih, tvb, 0, -1, ENC_NA);\r\nmih_tree = proto_item_add_subtree(ti, ett_mih);\r\nif(mih_tree)\r\n{\r\nitem = proto_tree_add_item(mih_tree, hf_mih_version, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nver_flags_tree = proto_item_add_subtree(item, ett_ver_flags);\r\nproto_tree_add_item(ver_flags_tree, hf_mih_version, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ver_flags_tree, hf_mih_ack_req, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ver_flags_tree, hf_mih_ack_resp, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ver_flags_tree, hf_mih_uir, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ver_flags_tree, hf_mih_more_frag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nfragment = tvb_get_guint8(tvb, offset);\r\nfragment = fragment << 7;\r\noffset += 1;\r\nif(mih_tree)\r\n{\r\nproto_tree_add_item(mih_tree, hf_mih_frag_no, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nitem = proto_tree_add_item(mih_tree, hf_mih_mid, tvb, offset + 1, 2, ENC_BIG_ENDIAN);\r\n}\r\nfragment = fragment + (tvb_get_guint8(tvb, offset)>>1);\r\noffset += 1;\r\nmid_tree = proto_item_add_subtree(item, ett_mid);\r\nserviceid = tvb_get_guint8(tvb, offset);\r\nserviceid = serviceid & 0xF0;\r\nserviceid >>= 4;\r\nproto_tree_add_item(mid_tree, hf_mih_service_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s ", val_to_str(serviceid, servicevalues, "Unknown"));\r\nopcode = tvb_get_guint8(tvb, offset);\r\nopcode = opcode & 0x0C;\r\nopcode >>= 2;\r\nif(mid_tree)\r\nproto_tree_add_item(mid_tree, hf_mih_opcode, tvb, offset, 2, ENC_BIG_ENDIAN);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s ", val_to_str(opcode, opcodevalues, "Unknown"));\r\nservice = tvb_get_guint8(tvb, offset);\r\nservice = service & 0xF0;\r\nservice >>= 4;\r\naction = tvb_get_ntohs(tvb, offset);\r\naction = action & 0x03FF;\r\nswitch (service)\r\n{\r\ncase 1 :\r\nproto_tree_add_item(mid_tree, hf_mih_serv_actionid, tvb, offset, 2, ENC_BIG_ENDIAN);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "\"%s\"", val_to_str(action, serv_act_id_values, "Unknown"));\r\nbreak;\r\ncase 2 :\r\nproto_tree_add_item(mid_tree, hf_mih_event_actionid, tvb, offset, 2, ENC_BIG_ENDIAN);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "\"%s\"", val_to_str(action, event_act_id_values, "Unknown"));\r\nbreak;\r\ncase 3 :\r\nproto_tree_add_item(mid_tree, hf_mih_command_actionid, tvb, offset, 2, ENC_BIG_ENDIAN);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "\"%s\"", val_to_str(action, command_act_id_values, "Unknown"));\r\nbreak;\r\ncase 4 :\r\nproto_tree_add_item(mid_tree, hf_mih_info_actionid, tvb, offset, 2, ENC_BIG_ENDIAN);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "\"%s\"", val_to_str(action, info_act_id_values, "Unknown"));\r\nbreak;\r\n}\r\noffset += 2;\r\nif(mih_tree)\r\n{\r\nproto_tree_add_item(mih_tree, hf_mih_tid, tvb, offset, 2, ENC_BIG_ENDIAN );\r\nproto_tree_add_item(mih_tree, hf_mih_pay_len, tvb, offset + 2, 2, ENC_BIG_ENDIAN );\r\n}\r\noffset += 2;\r\npayload_length = tvb_get_ntohs(tvb, offset);\r\noffset += 2;\r\nwhile(payload_length > 0 && fragment==0)\r\n{\r\nlen = tvb_get_guint8(tvb, offset+1);\r\nif(len > 128)\r\n{\r\nlen_of_len = (guint8)len - 128;\r\nswitch (len_of_len)\r\n{\r\ncase 1:\r\nlen = tvb_get_guint8(tvb, offset+2);\r\nbreak;\r\ncase 2:\r\nlen = tvb_get_ntohs(tvb, offset+2);\r\nbreak;\r\ncase 3:\r\nlen = tvb_get_ntoh24(tvb, offset+2);\r\nbreak;\r\ncase 4:\r\nlen = tvb_get_ntohl(tvb, offset+2);\r\nbreak;\r\ncase 5:\r\nlen = tvb_get_ntoh40(tvb, offset+2);\r\nbreak;\r\ncase 6:\r\nlen = tvb_get_ntoh48(tvb, offset+2);\r\nbreak;\r\ncase 7:\r\nlen = tvb_get_ntoh56(tvb, offset+2);\r\nbreak;\r\ncase 8:\r\nlen = tvb_get_ntoh64(tvb, offset+2);\r\n}\r\nlen_of_len++;\r\nlen = 128 + len;\r\n}\r\nelse\r\nlen_of_len = 1;\r\nif(len <= (guint64)payload_length)\r\n{\r\ntlv_tree = proto_tree_add_subtree_format(mih_tree, tvb, offset, 1 + len_of_len + (guint32)len, ett_tlv, NULL,\r\n"MIH TLV : %s", val_to_str(tvb_get_guint8(tvb, offset), typevaluenames, "UNKNOWN"));\r\nif(tlv_tree)\r\n{\r\nproto_tree_add_item(tlv_tree, hf_mih_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ntype = tvb_get_guint8(tvb, offset);\r\nif(len_of_len == 1)\r\n{\r\nproto_tree_add_item(tlv_tree, hf_mih_type_length, tvb, offset+1, len_of_len, ENC_BIG_ENDIAN);\r\n}\r\nelse if(len_of_len>1 && len_of_len<=5)\r\n{\r\nproto_tree_add_item(tlv_tree, hf_mih_type_length_ext, tvb, offset+2, len_of_len-1, ENC_BIG_ENDIAN);\r\n}\r\n}\r\noffset += 1 + len_of_len;\r\nif(len < (G_GUINT64_CONSTANT(1) << 32)){\r\ndissect_mih_tlv(tvb, offset, tlv_tree, type, (guint32)len);\r\noffset += (guint32)len;\r\npayload_length -= (1 + len_of_len + (guint32)len);\r\n}else{\r\nreturn offset;\r\n}\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(mih_tree, hf_fragmented_tlv, tvb, offset, -1, ENC_NA);\r\npayload_length = 0;\r\n}\r\n}\r\nif(fragment!=0)\r\nproto_tree_add_item(mih_tree, hf_fragmented_tlv, tvb, offset, -1, ENC_NA);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid proto_register_mih(void)\r\n{\r\nstatic hf_register_info hf[] =\r\n{\r\n{\r\n&hf_mih_version,\r\n{\r\n"MIH Version",\r\n"mih.version",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\nVERSION_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mih_ack_req,\r\n{\r\n"MIH ACK-Req",\r\n"mih.acq_req",\r\nFT_BOOLEAN,\r\n8,\r\nNULL,\r\nACKREQ_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mih_ack_resp,\r\n{\r\n"MIH ACK-Resp",\r\n"mih.acq_resp",\r\nFT_BOOLEAN,\r\n8,\r\nNULL,\r\nACKRESP_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mih_uir,\r\n{\r\n"MIH Unauthenticated info request",\r\n"mih.uir",\r\nFT_BOOLEAN,\r\n8,\r\nNULL,\r\nUIR_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mih_more_frag,\r\n{\r\n"MIH more fragment",\r\n"mih.more_frag",\r\nFT_BOOLEAN,\r\n8,\r\nNULL,\r\nMORE_FRAG_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mih_frag_no,\r\n{\r\n"Fragment No",\r\n"mih.frag_no",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\nFRAG_NO_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mih_mid,\r\n{\r\n"MIH message ID",\r\n"mih.mid",\r\nFT_UINT16,\r\nBASE_HEX,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mih_service_id,\r\n{\r\n"Service ID",\r\n"mih.service_id",\r\nFT_UINT16,\r\nBASE_HEX,\r\nVALS(servicevalues),\r\nSID_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mih_opcode,\r\n{\r\n"Opcode",\r\n"mih.opcode",\r\nFT_UINT16,\r\nBASE_HEX,\r\nVALS(opcodevalues),\r\nOPCODE_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mih_serv_actionid,\r\n{\r\n"Action ID",\r\n"mih.action_id",\r\nFT_UINT16,\r\nBASE_HEX,\r\nVALS(serv_act_id_values),\r\nAID_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mih_event_actionid,\r\n{\r\n"Action ID",\r\n"mih.action_id",\r\nFT_UINT16,\r\nBASE_HEX,\r\nVALS(event_act_id_values),\r\nAID_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mih_command_actionid,\r\n{\r\n"Action ID",\r\n"mih.action_id",\r\nFT_UINT16,\r\nBASE_HEX,\r\nVALS(command_act_id_values),\r\nAID_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mih_info_actionid,\r\n{\r\n"Action ID",\r\n"mih.action_id",\r\nFT_UINT16,\r\nBASE_HEX,\r\nVALS(info_act_id_values),\r\nAID_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mih_tid,\r\n{\r\n"TID",\r\n"mih.tid",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\nTRANS_ID_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mih_pay_len,\r\n{\r\n"Payload length",\r\n"mih.pay_len",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mih_type,\r\n{\r\n"MIH TLV type",\r\n"mih.tlv_type",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(typevaluenames),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mih_type_length,\r\n{\r\n"MIH TLV length",\r\n"mih.tlv_length",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mih_type_length_ext,\r\n{\r\n"MIH TLV length",\r\n"mih.tlv_length_ext",\r\nFT_UINT64,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mihf_id,\r\n{\r\n"MIHF_ID",\r\n"mih.mihf_id",\r\nFT_STRING,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mihf_id_mac,\r\n{\r\n"MIHF_ID",\r\n"mih.mihf_id.mac",\r\nFT_ETHER,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mihf_id_ipv4,\r\n{\r\n"MIHF_ID",\r\n"mih.mihf_id.ipv4",\r\nFT_IPv4,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mihf_id_ipv6,\r\n{\r\n"MIHF_ID",\r\n"mih.mihf_id.ipv6",\r\nFT_IPv6,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_status,\r\n{\r\n"STATUS",\r\n"mih.status",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(status_types),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_ip_methods_supported,\r\n{\r\n"IP methods supported",\r\n"mih.ip_methods_supported",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(boolean_types),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_ip_dhcp_services,\r\n{\r\n"IP DHCP services",\r\n"mih.ip_dhcp_services",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(boolean_types),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_fn_agent,\r\n{\r\n"FN Agent",\r\n"mih.fn_agent",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(boolean_types),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_access_router,\r\n{\r\n"Access Router",\r\n"mih.access_router",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(boolean_types),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_type,\r\n{\r\n"Link Type",\r\n"mih.link_type",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(link_type_vals),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_eth,\r\n{\r\n"Ethernet - IEEE802.3 Subtype",\r\n"mih.link_subtype_eth",\r\nFT_UINT32,\r\nBASE_HEX,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_eth_10m,\r\n{\r\n"Ethernet 10 Mb",\r\n"mih.link_subtype_eth.10mb",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x0001,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_eth_100m,\r\n{\r\n"Ethernet 100 Mb",\r\n"mih.link_subtype_eth.100mb",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x0002,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_eth_1000m,\r\n{\r\n"Ethernet 1000 Mb",\r\n"mih.link_subtype_eth.1000mb",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x0004,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_wireless_other,\r\n{\r\n"Wireless Other Subtype",\r\n"mih.link_subtype_wireless_other",\r\nFT_UINT32,\r\nBASE_HEX,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_wireless_other_dvb,\r\n{\r\n"DVB",\r\n"mih.link_subtype_wireless_other.dvb",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x0001,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_wireless_other_tdmb,\r\n{\r\n"T-DVB",\r\n"mih.link_subtype_wireless_other.tdmb",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x0002,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_wireless_other_atsc,\r\n{\r\n"ATSC-M/H",\r\n"mih.link_subtype_wireless_other.atsc",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x0004,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_ieee80211,\r\n{\r\n"Wireless - IEEE 802.11 Subtype",\r\n"mih.link_subtype_ieee80211",\r\nFT_UINT32,\r\nBASE_HEX,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_ieee80211_24,\r\n{\r\n"2.4 GHz",\r\n"mih.link_subtype_ieee80211.2_4ghz",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x0001,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_ieee80211_5,\r\n{\r\n"5 GHz",\r\n"mih.link_subtype_ieee80211.5ghz",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x0002,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_ieee80211_49,\r\n{\r\n"4.9 GHz",\r\n"mih.link_subtype_ieee80211.4_9ghz",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x0004,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_ieee80211_365,\r\n{\r\n"3.65 GHz",\r\n"mih.link_subtype_ieee80211.3_65ghz",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x0008,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_ieee80211_316,\r\n{\r\n"316 THz",\r\n"mih.link_subtype_ieee80211.316thz",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x0010,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_umts,\r\n{\r\n"Wireless - UMTS Subtype",\r\n"mih.link_subtype_umts",\r\nFT_UINT32,\r\nBASE_HEX,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_umts_99,\r\n{\r\n"Rel-99",\r\n"mih.link_subtype_umts.rel99",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x0001,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_umts_4,\r\n{\r\n"Rel-4",\r\n"mih.link_subtype_umts.rel4",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x0002,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_umts_5,\r\n{\r\n"Rel-5 (w/HSDPA)",\r\n"mih.link_subtype_umts.rel5",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x0004,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_umts_6,\r\n{\r\n"Rel-6 (w/ HSUPA)",\r\n"mih.link_subtype_umts.rel6",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x0008,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_umts_7,\r\n{\r\n"Rel-7 (MIMO/OFDM)",\r\n"mih.link_subtype_umts.rel7",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x0010,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_umts_8,\r\n{\r\n"Rel-8",\r\n"mih.link_subtype_umts.rel8",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x0020,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_cdma2000,\r\n{\r\n"Wireless - cdma2000-HRPD",\r\n"mih.link_subtype_cdma2000",\r\nFT_UINT32,\r\nBASE_HEX,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_cdma2000_0,\r\n{\r\n"Rev-0",\r\n"mih.link_subtype_cdma2000.rev0",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x0001,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_cdma2000_a,\r\n{\r\n"Rev-A",\r\n"mih.link_subtype_cdma2000.reva",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x0002,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_cdma2000_b,\r\n{\r\n"Rev-B",\r\n"mih.link_subtype_cdma2000.revb",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x0004,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_cdma2000_c,\r\n{\r\n"Rev-C",\r\n"mih.link_subtype_cdma2000.revc",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x0008,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_ieee80216,\r\n{\r\n"Wireless - IEEE 802.16",\r\n"mih.link_subtype_ieee80216",\r\nFT_UINT32,\r\nBASE_HEX,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_ieee80216_25,\r\n{\r\n"2.5 GHz",\r\n"mih.link_subtype_ieee80216.2_5ghz",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x0001,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_subtype_ieee80216_35,\r\n{\r\n"3.5 GHz",\r\n"mih.link_subtype_ieee80216.3_5ghz",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x0002,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_type_ext,\r\n{\r\n"LINK_TYPE_EXT",\r\n"mih.link_type_ext",\r\nFT_STRING,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_ipv4_addr,\r\n{\r\n"IP Address",\r\n"mih.ipv4_addr",\r\nFT_IPv4,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_ipv6_addr,\r\n{\r\n"IP Address",\r\n"mih.ipv6_addr",\r\nFT_IPv6,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_dn_reason,\r\n{\r\n"LINK Down Reason",\r\n"mih.link_dn_reason",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(link_dn_reason_vals),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_gdn_reason,\r\n{\r\n"LINK Going Down Reason",\r\n"mih.link_gdn_reason",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(link_gdn_reason_vals),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mac_addr,\r\n{\r\n"MAC ADDRESS",\r\n"mih.mac_addr",\r\nFT_ETHER,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_param_gen,\r\n{\r\n"LINK_PARAM",\r\n"mih.link_param_gen",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(link_param_gen_vals),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_param_qos,\r\n{\r\n"LINK_PARAM",\r\n"mih.link_param_qos",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(link_param_qos_vals),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_param_gg,\r\n{\r\n"LINK_PARAM",\r\n"mih.link_param_gg",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(link_param_gg_vals),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_param_edge,\r\n{\r\n"LINK_PARAM",\r\n"mih.link_param_edge",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_param_eth,\r\n{\r\n"LINK_PARAM",\r\n"mih.link_param_eth",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_param_802_11,\r\n{\r\n"LINK_PARAM",\r\n"mih.link_param_802_11",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(link_param_802_11_vals),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_param_c2k,\r\n{\r\n"LINK_PARAM",\r\n"mih.link_param_c2k",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(link_param_c2k_hrpd_vals),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_param_fdd,\r\n{\r\n"LINK_PARAM",\r\n"mih.link_param_fdd",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(link_param_fdd_vals),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_param_hrpd,\r\n{\r\n"LINK_PARAM",\r\n"mih.link_param_hrpd",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(link_param_c2k_hrpd_vals),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_param_802_16,\r\n{\r\n"LINK_PARAM",\r\n"mih.link_param_802_16",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_param_802_20,\r\n{\r\n"LINK_PARAM",\r\n"mih.link_param_802_20",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_param_802_22,\r\n{\r\n"LINK_PARAM",\r\n"mih.link_param_802_22",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_param_value,\r\n{\r\n"LINK_VALUE",\r\n"mih.link_param_value",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_op_mode,\r\n{\r\n"OP_MODE",\r\n"mih.op_mode",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(op_mode_vals),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_ac_type,\r\n{\r\n"LINK_AC_TYPE",\r\n"mih.link_ac_type",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(link_ac_type_vals),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_ac_ext_time,\r\n{\r\n"LINK_AC_ext_time",\r\n"mih.link_ac_ext_time",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_ac_result,\r\n{\r\n"LINK_AC_RESULT",\r\n"mih.link_ac_result",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(link_ac_result_vals),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_ho_reason,\r\n{\r\n"HO CAUSE",\r\n"mih.ho_reason",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(link_dn_reason_vals),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_ho_status,\r\n{\r\n"HO STATUS",\r\n"mih.ho_status",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(ho_status_vals),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mbb_ho_supp,\r\n{\r\n"MBB HO SUPP",\r\n"mih.mbb_ho_supp",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(mbb_ho_supp_vals),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_reg_request_code,\r\n{\r\n"REGISTER REQUEST CODE",\r\n"mih.reg_request_code",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(reg_request_code_vals),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_ip_renewal,\r\n{\r\n"IP RENEWAL FLAG",\r\n"mih.ip_renewal",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(ip_renewal_vals),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_dev_states_resp,\r\n{\r\n"SUPPORTED TRANSPORTS",\r\n"mih.dev_states_resp",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(dev_states_req_vals),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_dev_batt_level,\r\n{\r\n"Battery Level",\r\n"mih.dev_states_resp.batt_level",\r\nFT_INT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_dev_info,\r\n{\r\n"Device Info",\r\n"mih.dev_states_resp.dev_info",\r\nFT_STRING,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_max_resp_size,\r\n{\r\n"Maximum Response Size",\r\n"mih.max_resp_size",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_time_interval,\r\n{\r\n"Time Interval",\r\n"mih.time_interval",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_valid_time_interval,\r\n{\r\n"Valid Time Interval",\r\n"mih.valid_time_interval",\r\nFT_UINT32,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_tsp_carrier,\r\n{\r\n"TSP Carrier",\r\n"mih.tsp_carrier",\r\nFT_STRING,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_addr_type,\r\n{\r\n"Link Address Type",\r\n"mih.link_addr_type",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(link_addr_types),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_transport_addr_type,\r\n{\r\n"Link Transport Address Type",\r\n"mih.link_transport_addr_type",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_addr_string,\r\n{\r\n"Link Address String",\r\n"mih.link_addr_string",\r\nFT_STRING,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_cell_id,\r\n{\r\n"3G Cell ID",\r\n"mih.cell_id",\r\nFT_UINT32,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_ci,\r\n{\r\n"2G Cell ID",\r\n"mih.ci",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_plmn_id,\r\n{\r\n"Public Land Mobile Network (PLMN) ID",\r\n"mih.plmn_id",\r\nFT_UINT24,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_location_area_id,\r\n{\r\n"Location Area Code (LAC)",\r\n"mih.lac",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_threshold_val,\r\n{\r\n"Threshold Value",\r\n"mih.threshold_val",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_threshold_x_dir,\r\n{\r\n"Threshold Direction",\r\n"mih.threshold_x_dir",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(threshold_x_dir_vals),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_threshold_action,\r\n{\r\n"Threshold Action",\r\n"mih.threshold_action",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(threshold_action_vals),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_config_status,\r\n{\r\n"Config Status",\r\n"mih.config_status",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(boolean_types),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_num_cos,\r\n{\r\n"Number of differentiable classes",\r\n"mih.num_cos",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_num_queue,\r\n{\r\n"Number of transmit queues supported",\r\n"mih.num_queue",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_channel_id,\r\n{\r\n"Channel ID",\r\n"mih.channel_id",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_predef_cfg_id,\r\n{\r\n"Pre-defined Configuration Identifier",\r\n"mih.predef_cfg_id",\r\nFT_INT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_network_id,\r\n{\r\n"Network ID",\r\n"mih.network_id",\r\nFT_STRING,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_net_aux_id,\r\n{\r\n"Auxiliary Network ID",\r\n"mih.net_aux_id",\r\nFT_STRING,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sig_strength_dbm,\r\n{\r\n"Signal Strength (dBm)",\r\n"mih.sig_strength",\r\nFT_INT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sig_strength_per,\r\n{\r\n"Signal Strength (%)",\r\n"mih.sig_strength",\r\nFT_INT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_cos_id,\r\n{\r\n"Class of Service ID",\r\n"mih.cos_id",\r\nFT_INT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_cos_value,\r\n{\r\n"Class of Service Value",\r\n"mih.cos_value",\r\nFT_INT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sinr,\r\n{\r\n"SINR",\r\n"mih.sinr",\r\nFT_INT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_data_rate,\r\n{\r\n"Link Data Rate (kb/s)",\r\n"mih.link_data_rate",\r\nFT_UINT32,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rdf_data,\r\n{\r\n"RDF data",\r\n"mih.rdf_data",\r\nFT_STRING,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rdf_mime_type,\r\n{\r\n"RDF data",\r\n"mih.rdf_mime_type",\r\nFT_STRING,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_res_status,\r\n{\r\n"Resource Status",\r\n"mih.res_status",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(boolean_types),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_res_retention_status,\r\n{\r\n"Info query RDF schema URL",\r\n"mih.res_retention_status",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(boolean_types),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_res_rpt_flag,\r\n{\r\n"Query resource report flag",\r\n"mih.res_rpt_flag",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(boolean_types),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_unauth_info_req,\r\n{\r\n"Unauthenticated information request",\r\n"mih.unauth_info_req",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(boolean_types),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rdf_sch,\r\n{\r\n"RDF Schema",\r\n"mih.rdf_sch",\r\nFT_STRING,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rdf_sch_url,\r\n{\r\n"RDF Schema URL",\r\n"mih.rdf_sch_url",\r\nFT_STRING,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_ir_bin_data,\r\n{\r\n"IR Binary Data",\r\n"mih.ir_bin_data",\r\nFT_STRING,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_bin_data_x,\r\n{\r\n"IQ Binary Data",\r\n"mih.iq_bin_data",\r\nFT_STRING,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_vendor_specific_tlv,\r\n{\r\n"Vendor Specific TLV",\r\n"mih.vendor_specific_tlv",\r\nFT_STRING,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_reserved_tlv,\r\n{\r\n"Reserved TLV",\r\n"mih.reserved_tlv",\r\nFT_STRING,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_experimental_tlv,\r\n{\r\n"Experimental TLV",\r\n"mih.experimental_tlv",\r\nFT_STRING,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_unknown_tlv,\r\n{\r\n"UNKNOWN TLV",\r\n"mih.unknown_tlv",\r\nFT_STRING,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_fragmented_tlv,\r\n{\r\n"FRAGMENTED TLV",\r\n"mih.fragmented_tlv",\r\nFT_BYTES,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_event_list,\r\n{\r\n"List of Events",\r\n"mih.event_list",\r\nFT_UINT32,\r\nBASE_HEX,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_event_link_detect,\r\n{\r\n"MIH LINK Detected",\r\n"mih.event_list.link_detect",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nLINK_DETECT_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_event_link_up,\r\n{\r\n"MIH LINK UP",\r\n"mih.event_list.link_up",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nLINK_UP_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_event_link_dn,\r\n{\r\n"MIH LINK DOWN",\r\n"mih.event_list.link_down",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nLINK_DOWN_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_event_link_param,\r\n{\r\n"MIH LINK Parameters Report",\r\n"mih.event_list.link_param_rpt",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nLINK_PARAM_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_event_link_gd,\r\n{\r\n"MIH LINK Going Down",\r\n"mih.event_list.link_gd",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nLINK_GD_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_event_ho_imm,\r\n{\r\n"Link Handover Imminent",\r\n"mih.event_list.link_ho_imm",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nLINK_HO_IMM_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_event_ho_comp,\r\n{\r\n"MIH LINK Handover Complete",\r\n"mih.event_list.link_ho_comp",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nLINK_HO_COMP_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_event_pdu_tx_stat,\r\n{\r\n"MIH LINK PDU Transmit Status",\r\n"mih.event_list.link_pdu_tx_stat",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nLINK_PDU_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_cmd_list,\r\n{\r\n"List of Commands",\r\n"mih.command_list",\r\nFT_UINT32,\r\nBASE_HEX,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_cmd_event_subs,\r\n{\r\n"MIH LINK Event Subscribe",\r\n"mih.cmd_list.evt_subs",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nCMD_EVT_SUBS_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_cmd_event_unsub,\r\n{\r\n"Link Event Unsubscribe",\r\n"mih.cmd_list.evt_unsubs",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nCMD_EVT_UNSUBS_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_cmd_get_param,\r\n{\r\n"MIH LINK Get Parameters",\r\n"mih.cmd_list.evt_get_param",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nCMD_GET_PARA_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_cmd_con_thres,\r\n{\r\n"Link Configure Thresholds",\r\n"mih.cmd_list.evt_conf_th",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nCMD_CONF_TH_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_cmd_link_action,\r\n{\r\n"MIH LINK Action",\r\n"mih.cmd_list.evt_link_action",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nCMD_LINK_AC_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_list,\r\n{\r\n"List of of IS query types",\r\n"mih.iq_type_list",\r\nFT_UINT32,\r\nBASE_HEX,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_bin_data,\r\n{\r\n"Binary data",\r\n"mih.iq_type_list.bin_data",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_BIN_DATA_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_rdf_data,\r\n{\r\n"RDF data",\r\n"mih.iq_type_list.rdf_data",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_RDF_DATA_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_rdf_sch_url,\r\n{\r\n"RDF schema URL",\r\n"mih.iq_type_list.rdf_sch_u",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_RDF_SCH_U_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_rdf_sch,\r\n{\r\n"RDF schema",\r\n"mih.iq_type_list.rdf_sch",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_RDF_SCH_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_net_type,\r\n{\r\n"IE_NETWORK_TYPE",\r\n"mih.iq_type_list.ie_net_type",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_IE_NET_TYPE_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_op_id,\r\n{\r\n"IE_OPERATOR_ID",\r\n"mih.iq_type_list.ie_op_id",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_IE_OP_ID_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_serv_pro_id,\r\n{\r\n"IE_SERVICE_PROVIDER_ID",\r\n"mih.iq_type_list.ie_serv_id",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_SERV_ID_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_country_code,\r\n{\r\n"IE_COUNTRY_CODE",\r\n"mih.iq_type_list.ie_country_code",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_IE_COUN_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_net_id,\r\n{\r\n"IE_NETWORK_ID",\r\n"mih.iq_type_list.ie_net_id",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_NET_ID_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_net_aux_id,\r\n{\r\n"IE_NETWORK_AUX_ID",\r\n"mih.iq_type_list.net_aux_id",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_NET_AUX_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_roam_part,\r\n{\r\n"IE_ROAMING_PARTNERS",\r\n"mih.iq_type_list.ie_roam_part",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_IE_ROAM_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_cost,\r\n{\r\n"IE_COST",\r\n"mih.iq_type_list.ie_cost",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_IE_COST_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_net_qos,\r\n{\r\n"IE_NETWORK_QOS",\r\n"mih.iq_type_list.ie_net_qos",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_IE_QOS_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_net_dat_rt,\r\n{\r\n"IE_NETWORK_DATA_RATE",\r\n"mih.iq_type_list.ie_net_dat_rt",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_IE_DATA_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_net_reg_dom,\r\n{\r\n"IE_NET_REGULT_DOMAIN",\r\n"mih.iq_type_list.ie_net_reg_dom",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_IE_REGDOM_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_freq_bands,\r\n{\r\n"IE_NET_FREQUENCY_BANDS",\r\n"mih.iq_type_list.ie_net_freq",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_IE_FREQ_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_ip_cfg_mthds,\r\n{\r\n"IE_NET_IP_CFG_METHODS",\r\n"mih.iq_type_list.ie_net_ip_cfg",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_IE_IP_CFG_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_net_cap,\r\n{\r\n"IE_NET_CAPABILITIES",\r\n"mih.iq_type_list.ie_net_cap",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_IE_CAP_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_supp_lcp,\r\n{\r\n"IE_NET_SUPPORTED_LCP",\r\n"mih.iq_type_list.ie_net_sup_lcp",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_IE_SUP_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_net_mob_mg,\r\n{\r\n"IE_NET_MOB_MGMT_PROT",\r\n"mih.iq_type_list.ie_net_mob_mg",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_IE_MOB_MG_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_net_emserv,\r\n{\r\n"IE_NET_EMSERV_PROXY",\r\n"mih.iq_type_list.ie_net_emer_serv",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_IE_EM_SERV_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_net_ims_pcscf,\r\n{\r\n"IE_NET_IMS_PROXY_CSCF",\r\n"mih.iq_type_list.ie_net_ims_pcscf",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_IE_IMS_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_net_mob_net,\r\n{\r\n"IE_NET_MOBILE_NETWORK",\r\n"mih.iq_type_list.ie_net_mob_net",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_IE_MOB_NET_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_link_addr,\r\n{\r\n"IE_POA_LINK_ADDR",\r\n"mih.iq_type_list.ie_poa_link",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_IE_POA_ADDR_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_poa_loc,\r\n{\r\n"IE_POA_LOCATION",\r\n"mih.iq_type_list.ie_poa_loc",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_IE_POA_LOC_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_poa_chan_range,\r\n{\r\n"IE_POA_CHANNEL_RANGE",\r\n"mih.iq_type_list.ie_poa_chan_rg",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_IE_POA_CHAN_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_poa_sys_info,\r\n{\r\n"IE_POA_SYSTEM_INFO",\r\n"mih.iq_type_list.ie_poa_syst_info",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_IE_POA_SYS_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_poa_sub_info,\r\n{\r\n"IE_POA_SUBNET_INFO",\r\n"mih.iq_type_list.ie_poa_sub_info",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_IE_POA_SUB_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_iq_poa_ip,\r\n{\r\n"IE_POA_IP_ADDR",\r\n"mih.iq_type_list.ie_poa_ip",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIQ_IE_POA_IP_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mob_list,\r\n{\r\n"List of supported mobility management protocols",\r\n"mih.mob_list",\r\nFT_UINT16,\r\nBASE_HEX,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mob_mip4,\r\n{\r\n"Mobile IPv4",\r\n"mih.mob_list.mip4",\r\nFT_BOOLEAN,\r\n16,\r\nNULL,\r\nMOB_MIP4_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mob_mip4_reg,\r\n{\r\n"Mobile IPv4 Regional Registration",\r\n"mih.mob_list.mip4_reg",\r\nFT_BOOLEAN,\r\n16,\r\nNULL,\r\nMOB_MIP4_REG_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mob_mip6,\r\n{\r\n"Mobile IPv6",\r\n"mih.mob_list.mip6",\r\nFT_BOOLEAN,\r\n16,\r\nNULL,\r\nMOB_MIP6_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mob_hmip6,\r\n{\r\n"Hierarchical Mobile IPv6",\r\n"mih.mob_list.hmip6",\r\nFT_BOOLEAN,\r\n16,\r\nNULL,\r\nMOB_HMIP6_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mob_low_lat,\r\n{\r\n"Low Latency Handoffs",\r\n"mih.mob_list.low_lat",\r\nFT_BOOLEAN,\r\n16,\r\nNULL,\r\nMOB_LOW_LAT_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mob_fmip6,\r\n{\r\n"Mobile IPv6 Fast Handovers",\r\n"mih.mob_list.fmip6",\r\nFT_BOOLEAN,\r\n16,\r\nNULL,\r\nMOB_FMIP6_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mob_ike_multi,\r\n{\r\n"IKEv2 Mobility and Multihoming Protocol",\r\n"mih.mob_list.ike_multi",\r\nFT_BOOLEAN,\r\n16,\r\nNULL,\r\nMOB_IKE_MULTI_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_cfg_mthds,\r\n{\r\n"A set of IP configuration methods",\r\n"mih.cfg_mthds",\r\nFT_UINT32,\r\nBASE_HEX,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_cfg_ip4_stat,\r\n{\r\n"IPv4 static configuration",\r\n"mih.ip_cfg_mthds.static",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIP_CFG_STAT_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_cfg_dhcp4,\r\n{\r\n"DHCPv4",\r\n"mih.ip_cfg_mthds.dhcp4",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIP_CFG_DHCP4_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_cfg_mip_fa,\r\n{\r\n"Mobile IPv4 with foreign agent",\r\n"mih.ip_cfg_mthds.mip4_fa",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIP_CFG_MIP4_FA_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_cfg_mip_wo_fa,\r\n{\r\n"Mobile IPv4 without FA",\r\n"mih.ip_cfg_mthds.mip4_wo_fa",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIP_CFG_MIP4_NFA_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_cfg_ip6_sac,\r\n{\r\n"IPv6 stateless address configuration",\r\n"mih.ip_cfg_mthds.ip6_state_less",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIP_CFG_IP6_SL_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_cfg_dhcp6,\r\n{\r\n"DHCPv6",\r\n"mih.ip_cfg_mthds.dhcp6",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIP_CFG_DHCP6_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_cfg_ip6_manual,\r\n{\r\n"IPv6 manual configuration",\r\n"mih.ip_cfg_mthds.ip6_manual",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\nIP_CFG_IP6_MAN_MASK,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_trans_list,\r\n{\r\n"Supported Transports",\r\n"mih.trans_list",\r\nFT_UINT16,\r\nBASE_HEX,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_trans_udp,\r\n{\r\n"UDP",\r\n"mih.trans_list.udp",\r\nFT_BOOLEAN,\r\n16,\r\nNULL,\r\n0x8000,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_trans_tcp,\r\n{\r\n"TCP",\r\n"mih.trans_list.tcp",\r\nFT_BOOLEAN,\r\n16,\r\nNULL,\r\n0x4000,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_dev_states_req,\r\n{\r\n"Device Status Request",\r\n"mih.dev_states_req",\r\nFT_UINT16,\r\nBASE_HEX,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_dev_states_req_dev_info,\r\n{\r\n"Device Info",\r\n"mih.dev_states_req.dev_info",\r\nFT_BOOLEAN,\r\n16,\r\nNULL,\r\n0x8000,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_dev_states_req_batt_lvl,\r\n{\r\n"Battery Level",\r\n"mih.dev_states_req.batt_level",\r\nFT_BOOLEAN,\r\n16,\r\nNULL,\r\n0x4000,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mihcap,\r\n{\r\n"Supported MIH Capability",\r\n"mih.mihcap",\r\nFT_UINT8,\r\nBASE_HEX,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mihcap_es,\r\n{\r\n"Event Service (ES)",\r\n"mih.mihcap.event_service",\r\nFT_BOOLEAN,\r\n8,\r\nNULL,\r\n0x80,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mihcap_cs,\r\n{\r\n"Command Service (CS)",\r\n"mih.mihcap.command_service",\r\nFT_BOOLEAN,\r\n8,\r\nNULL,\r\n0x40,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_mihcap_is,\r\n{\r\n"Information Service (IS)",\r\n"mih.mihcap.information_service",\r\nFT_BOOLEAN,\r\n8,\r\nNULL,\r\n0x20,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_net_caps,\r\n{\r\n"High Level Network Capability",\r\n"mih.net_caps",\r\nFT_UINT32,\r\nBASE_HEX,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_net_caps_sec,\r\n{\r\n"Security",\r\n"mih.net_caps.sec",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x80000000,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_net_caps_qos0,\r\n{\r\n"QoS Class 0",\r\n"mih.net_caps.qos0",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x40000000,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_net_caps_qos1,\r\n{\r\n"QoS Class 1",\r\n"mih.net_caps.qos1",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x20000000,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_net_caps_qos2,\r\n{\r\n"QoS Class 2",\r\n"mih.net_caps.qos2",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x10000000,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_net_caps_qos3,\r\n{\r\n"QoS Class 3",\r\n"mih.net_caps.qos3",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x08000000,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_net_caps_qos4,\r\n{\r\n"QoS Class 4",\r\n"mih.net_caps.qos4",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x04000000,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_net_caps_qos5,\r\n{\r\n"QoS Class 5",\r\n"mih.net_caps.qos5",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x02000000,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_net_caps_ia,\r\n{\r\n"Internet Access",\r\n"mih.net_caps.internet_access",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x01000000,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_net_caps_es,\r\n{\r\n"Emergency Services",\r\n"mih.net_caps.emergency_services",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x00800000,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_net_caps_mihcap,\r\n{\r\n"MIH Capability",\r\n"mih.net_caps.mihcap",\r\nFT_BOOLEAN,\r\n32,\r\nNULL,\r\n0x00400000,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_ac_attr,\r\n{\r\n"Link Action Attribute",\r\n"mih.link_ac_attr",\r\nFT_UINT8,\r\nBASE_HEX,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_ac_attr_link_scan,\r\n{\r\n"Link_Scan",\r\n"mih.link_ac_attr.link_scan",\r\nFT_BOOLEAN,\r\n8,\r\nNULL,\r\n0x80,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_ac_attr_link_res_retain,\r\n{\r\n"Link Resource Retain",\r\n"mih.link_ac_attr.link_res_retain",\r\nFT_BOOLEAN,\r\n8,\r\nNULL,\r\n0x40,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_link_ac_attr_data_fwd_req,\r\n{\r\n"Forward Data Request",\r\n"mih.link_ac_attr.data_fwd_req",\r\nFT_BOOLEAN,\r\n8,\r\nNULL,\r\n0x20,\r\nNULL, HFILL\r\n}\r\n}\r\n};\r\nstatic gint *ett[] =\r\n{\r\n&ett_mih,\r\n&ett_ver_flags,\r\n&ett_mid,\r\n&ett_tlv,\r\n&ett_cmd_bitmap,\r\n&ett_event_bitmap,\r\n&ett_mob_mgt_bitmap,\r\n&ett_cfg_mtd_bitmap,\r\n&ett_iq_type_bitmap,\r\n&ett_trans_list_bitmap,\r\n&ett_dev_states_bitmap,\r\n&ett_mihcap_bitmap,\r\n&ett_net_caps_bitmap,\r\n&ett_ac_attr_bitmap,\r\n&ett_subtype_eth_bitmap,\r\n&ett_subtype_wireless_other_bitmap,\r\n&ett_subtype_ieee80211_bitmap,\r\n&ett_subtype_umts_bitmap,\r\n&ett_subtype_cdma2000_bitmap,\r\n&ett_subtype_ieee80216_bitmap,\r\n&ett_min_pk_tx_delay,\r\n&ett_avg_pk_tx_delay,\r\n&ett_max_pk_tx_delay,\r\n&ett_pk_delay_jitter,\r\n&ett_pk_loss_rate,\r\n&ett_list_prefer_link,\r\n&ett_ip_dhcp_server,\r\n&ett_fn_agent,\r\n&ett_access_router,\r\n&ett_link_states_req,\r\n&ett_link_desc_req,\r\n};\r\nproto_mih = proto_register_protocol("Media-Independent Handover", "MIH", "mih");\r\nproto_register_field_array(proto_mih, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid proto_reg_handoff_mih(void)\r\n{\r\ndissector_handle_t mih_handle;\r\nmih_handle = create_dissector_handle(dissect_mih, proto_mih);\r\ndissector_add_uint("udp.port", MIH_PORT, mih_handle);\r\ndissector_add_uint("tcp.port", MIH_PORT, mih_handle);\r\ndissector_add_uint("ethertype", ETHERTYPE_MIH, mih_handle);\r\n}
