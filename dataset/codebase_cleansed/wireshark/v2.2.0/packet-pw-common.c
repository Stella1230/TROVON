void pwc_item_append_cw(proto_item* item, const guint32 cw, const gboolean append_text)\r\n{\r\nif (item != NULL)\r\n{\r\nif (append_text)\r\n{\r\nproto_item_append_text(item, ", CW");\r\n}\r\nproto_item_append_text(item, ": 0x%.8" G_GINT32_MODIFIER "x", cw);\r\n}\r\nreturn;\r\n}\r\nvoid pwc_item_append_text_n_items(proto_item* item, const int n, const char * const item_text)\r\n{\r\nif (item != NULL)\r\n{\r\nif (n >=0)\r\n{\r\nproto_item_append_text(item, ", %d %s%s", n, item_text, plurality(n,"","s"));\r\n}\r\n}\r\nreturn;\r\n}\r\nstatic\r\nint dissect_pw_padding(tvbuff_t * tvb, packet_info * pinfo, proto_tree * tree, void* data _U_)\r\n{\r\ngint size;\r\nproto_item* item;\r\nproto_tree* tree_p;\r\nsize = tvb_reported_length_remaining(tvb, 0);\r\nitem = proto_tree_add_item(tree, proto_pw_padding, tvb, 0, -1, ENC_NA);\r\npwc_item_append_text_n_items(item,size,"byte");\r\ntree_p = proto_item_add_subtree(item, ett);\r\ncall_data_dissector(tvb, pinfo, tree_p);\r\nitem = proto_tree_add_int(tree_p, hf_padding_len, tvb, 0, 0, size);\r\nPROTO_ITEM_SET_HIDDEN(item);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid proto_register_pw_padding(void)\r\n{\r\nstatic hf_register_info hfpadding[] = {\r\n{&hf_padding_len ,{"Length" ,"pw.padding.len"\r\n,FT_INT32 ,BASE_DEC ,NULL ,0\r\n,NULL ,HFILL }}\r\n};\r\nstatic gint *ett_array[] = {\r\n&ett\r\n};\r\nproto_pw_padding = proto_register_protocol("Pseudowire Padding","PW Padding","pw.padding");\r\nproto_register_field_array(proto_pw_padding, hfpadding, array_length(hfpadding));\r\nproto_register_subtree_array(ett_array, array_length(ett_array));\r\nregister_dissector("pw_padding", dissect_pw_padding, proto_pw_padding);\r\n}
