static int\r\nalign_4(tvbuff_t *tvb, int aoffset)\r\n{\r\nif(tvb_captured_length_remaining(tvb, aoffset) > 4 )\r\n{\r\nreturn (aoffset%4);\r\n}\r\nreturn 0;\r\n}\r\nstatic int\r\nndps_string(tvbuff_t* tvb, int hfinfo, proto_tree *ndps_tree, int offset, char **stringval)\r\n{\r\nint foffset = offset;\r\nguint32 str_length;\r\nchar *string;\r\nstr_length = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif(str_length == 0)\r\n{\r\nproto_tree_add_string(ndps_tree, hfinfo, tvb, offset, 4, "<Not Specified>");\r\nif (stringval != NULL)\r\n*stringval = wmem_strdup(wmem_packet_scope(), "");\r\nreturn foffset;\r\n}\r\nif (str_length <= 2 || (str_length & 0x01) || tvb_get_guint8(tvb, foffset + 1) != 0) {\r\nstring = tvb_get_string_enc(wmem_packet_scope(), tvb, foffset, str_length, ENC_ASCII|ENC_NA); ;\r\n} else {\r\nstring = tvb_get_string_enc(wmem_packet_scope(), tvb, foffset, str_length, ENC_UTF_16|ENC_LITTLE_ENDIAN);\r\n}\r\nfoffset += str_length;\r\nproto_tree_add_string(ndps_tree, hfinfo, tvb, offset, str_length + 4, string);\r\nfoffset += align_4(tvb, foffset);\r\nif (stringval != NULL)\r\n*stringval = string;\r\nreturn foffset;\r\n}\r\nstatic int\r\nobjectidentifier(tvbuff_t* tvb, proto_tree *ndps_tree, int foffset)\r\n{\r\nguint32 length;\r\nconst char *label=NULL;\r\nguint32 label_value=0;\r\nproto_tree *atree;\r\nproto_item *aitem;\r\ngboolean found=TRUE;\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nif (length==0)\r\n{\r\nreturn foffset;\r\n}\r\nif (ndps_show_oids)\r\n{\r\nproto_tree_add_uint(ndps_tree, hf_oid_struct_size, tvb, foffset, 4, length);\r\n}\r\nfoffset += 4;\r\nswitch (length)\r\n{\r\ncase 9:\r\nlabel_value = tvb_get_ntohl(tvb, foffset+5);\r\nlabel = try_val_to_str(label_value, object_ids_7);\r\nif (label==NULL)\r\n{\r\nlabel = wmem_strdup(wmem_packet_scope(), "Unknown ID");\r\nfound=FALSE;\r\n}\r\naitem = proto_tree_add_uint_format(ndps_tree, hf_ndps_object_ids_7, tvb, foffset, length, label_value, "%s", label);\r\nbreak;\r\ncase 10:\r\nlabel_value = tvb_get_ntohl(tvb, foffset+6);\r\nlabel = try_val_to_str(label_value, object_ids_8);\r\nif (label==NULL)\r\n{\r\nlabel = wmem_strdup(wmem_packet_scope(), "Unknown ID");\r\nfound=FALSE;\r\n}\r\naitem = proto_tree_add_uint_format(ndps_tree, hf_ndps_object_ids_8, tvb, foffset, length, label_value, "%s", label);\r\nbreak;\r\ncase 11:\r\nlabel_value = tvb_get_ntohl(tvb, foffset+7);\r\nlabel = try_val_to_str(label_value, object_ids_9);\r\nif (label==NULL)\r\n{\r\nlabel = wmem_strdup(wmem_packet_scope(), "Unknown ID");\r\nfound=FALSE;\r\n}\r\naitem = proto_tree_add_uint_format(ndps_tree, hf_ndps_object_ids_9, tvb, foffset, length, label_value, "%s", label);\r\nbreak;\r\ncase 12:\r\nlabel_value = tvb_get_ntohl(tvb, foffset+8);\r\nlabel = try_val_to_str(label_value, object_ids_10);\r\nif (label==NULL)\r\n{\r\nlabel = wmem_strdup(wmem_packet_scope(), "Unknown ID");\r\nfound=FALSE;\r\n}\r\naitem = proto_tree_add_uint_format(ndps_tree, hf_ndps_object_ids_10, tvb, foffset, length, label_value, "%s", label);\r\nbreak;\r\ncase 13:\r\nlabel_value = tvb_get_ntohl(tvb, foffset+9);\r\nlabel = try_val_to_str(label_value, object_ids_11);\r\nif (label==NULL)\r\n{\r\nlabel = wmem_strdup(wmem_packet_scope(), "Unknown ID");\r\nfound=FALSE;\r\n}\r\naitem = proto_tree_add_uint_format(ndps_tree, hf_ndps_object_ids_11, tvb, foffset, length, label_value, "%s", label);\r\nbreak;\r\ncase 14:\r\nlabel_value = tvb_get_ntohl(tvb, foffset+10);\r\nlabel = try_val_to_str(label_value, object_ids_12);\r\nif (label==NULL)\r\n{\r\nlabel = wmem_strdup(wmem_packet_scope(), "Unknown ID");\r\nfound=FALSE;\r\n}\r\naitem = proto_tree_add_uint_format(ndps_tree, hf_ndps_object_ids_12, tvb, foffset, length, label_value, "%s", label);\r\nbreak;\r\ncase 15:\r\nlabel_value = tvb_get_ntohl(tvb, foffset+11);\r\nlabel = try_val_to_str(label_value, object_ids_13);\r\nif (label==NULL)\r\n{\r\nlabel = wmem_strdup(wmem_packet_scope(), "Unknown ID");\r\nfound=FALSE;\r\n}\r\naitem = proto_tree_add_uint_format(ndps_tree, hf_ndps_object_ids_13, tvb, foffset, length, label_value, "%s", label);\r\nbreak;\r\ncase 16:\r\nlabel_value = tvb_get_ntohl(tvb, foffset+12);\r\nlabel = try_val_to_str(label_value, object_ids_14);\r\nif (label==NULL)\r\n{\r\nlabel = wmem_strdup(wmem_packet_scope(), "Unknown ID");\r\nfound=FALSE;\r\n}\r\naitem = proto_tree_add_uint_format(ndps_tree, hf_ndps_object_ids_14, tvb, foffset, length, label_value, "%s", label);\r\nbreak;\r\ncase 17:\r\nlabel_value = tvb_get_ntohl(tvb, foffset+13);\r\nlabel = try_val_to_str(label_value, object_ids_15);\r\nif (label==NULL)\r\n{\r\nlabel = wmem_strdup(wmem_packet_scope(), "Unknown ID");\r\nfound=FALSE;\r\n}\r\naitem = proto_tree_add_uint_format(ndps_tree, hf_ndps_object_ids_15, tvb, foffset, length, label_value, "%s", label);\r\nbreak;\r\ncase 18:\r\nlabel_value = tvb_get_ntohl(tvb, foffset+14);\r\nlabel = try_val_to_str(label_value, object_ids_16);\r\nif (label==NULL)\r\n{\r\nlabel = wmem_strdup(wmem_packet_scope(), "Unknown ID");\r\nfound=FALSE;\r\n}\r\naitem = proto_tree_add_uint_format(ndps_tree, hf_ndps_object_ids_16, tvb, foffset, length, label_value, "%s", label);\r\nbreak;\r\ndefault:\r\naitem = proto_tree_add_uint_format(ndps_tree, hf_ndps_object_ids_7, tvb, foffset, length, 1, "Unknown ID");\r\nfound=FALSE;\r\nbreak;\r\n}\r\nif (!found)\r\n{\r\nlabel_value = 1;\r\nlabel = try_val_to_str(label_value, object_ids_7);\r\n}\r\nif (ndps_show_oids)\r\n{\r\natree = proto_item_add_subtree(aitem, ett_ndps);\r\nproto_tree_add_item(atree, hf_oid_asn1_type, tvb, foffset, 1, ENC_BIG_ENDIAN);\r\nfoffset += 1;\r\nlength = tvb_get_guint8(tvb, foffset);\r\nfoffset += 1;\r\nproto_tree_add_item(atree, hf_ndps_oid, tvb, foffset, length, ENC_NA);\r\nfoffset += length;\r\n}\r\nelse\r\n{\r\nif (!found)\r\n{\r\ntvb_ensure_bytes_exist(tvb, foffset, length);\r\nfoffset += length;\r\n}\r\nelse\r\n{\r\nfoffset += 1;\r\nlength = tvb_get_guint8(tvb, foffset);\r\nfoffset += 1;\r\ntvb_ensure_bytes_exist(tvb, foffset, length);\r\nfoffset += length;\r\n}\r\n}\r\nglobal_attribute_name = label;\r\nreturn foffset+(length%2);\r\n}\r\nstatic int\r\nname_or_id(tvbuff_t* tvb, proto_tree *ndps_tree, int foffset)\r\n{\r\nguint32 name_or_id_val;\r\nname_or_id_val = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_nameorid, tvb, foffset, 4, name_or_id_val);\r\nfoffset += 4;\r\nswitch (name_or_id_val)\r\n{\r\ncase 1:\r\nfoffset = objectidentifier(tvb, ndps_tree, foffset);\r\nbreak;\r\ncase 2:\r\nfoffset = ndps_string(tvb, hf_ndps_local_object_name, ndps_tree, foffset, NULL);\r\nbreak;\r\n}\r\nfoffset += align_4(tvb, foffset);\r\nreturn foffset;\r\n}\r\nstatic int\r\nqualifiedname(tvbuff_t* tvb, proto_tree *ndps_tree, int foffset)\r\n{\r\nguint32 qualified_name_type=0;\r\nqualified_name_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_qualified_name, tvb, foffset, 4, qualified_name_type);\r\nfoffset += 4;\r\nif (qualified_name_type != 0) {\r\nif (qualified_name_type == 1) {\r\nfoffset = ndps_string(tvb, hf_ndps_printer_name, ndps_tree, foffset, NULL);\r\n}\r\nelse\r\n{\r\nfoffset = ndps_string(tvb, hf_ndps_pa_name, ndps_tree, foffset, NULL);\r\nfoffset = ndps_string(tvb, hf_ndps_tree, ndps_tree, foffset, NULL);\r\n}\r\n}\r\nreturn foffset;\r\n}\r\nstatic int\r\nobjectidentification(tvbuff_t* tvb, proto_tree *ndps_tree, int foffset)\r\n{\r\nguint32 object_type=0;\r\nproto_tree *atree;\r\nproto_item *aitem;\r\nobject_type = tvb_get_ntohl(tvb, foffset);\r\naitem = proto_tree_add_item(ndps_tree, hf_obj_id_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\natree = proto_item_add_subtree(aitem, ett_ndps);\r\nfoffset += 4;\r\nswitch(object_type)\r\n{\r\ncase 0:\r\nfoffset = ndps_string(tvb, hf_ndps_printer_name, atree, foffset, NULL);\r\nproto_tree_add_item(atree, hf_ndps_object, tvb, foffset,\r\n4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 1:\r\nfoffset = ndps_string(tvb, hf_ndps_printer_name, atree, foffset, NULL);\r\nproto_tree_add_item(atree, hf_ndps_document_number, tvb, foffset,\r\n4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 2:\r\nfoffset = objectidentifier(tvb, atree, foffset);\r\nbreak;\r\ncase 3:\r\nfoffset = ndps_string(tvb, hf_object_name, atree, foffset, NULL);\r\nif (foffset > tvb_captured_length_remaining(tvb, foffset)) {\r\nreturn foffset;\r\n}\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nbreak;\r\ncase 4:\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nbreak;\r\ncase 5:\r\nfoffset = ndps_string(tvb, hf_object_name, atree, foffset, NULL);\r\nbreak;\r\ncase 6:\r\nfoffset = ndps_string(tvb, hf_ndps_printer_name, atree, foffset, NULL);\r\nbreak;\r\ncase 7:\r\nfoffset = qualifiedname(tvb, ndps_tree, foffset);\r\nbreak;\r\ncase 8:\r\nfoffset = ndps_string(tvb, hf_object_name, atree, foffset, NULL);\r\nfoffset = objectidentifier(tvb, atree, foffset);\r\nproto_tree_add_item(atree, hf_ndps_event_type, tvb, foffset,\r\n4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\ndefault:\r\nbreak;\r\n}\r\nreturn foffset;\r\n}\r\nstatic int\r\nprint_address(tvbuff_t* tvb, proto_tree *ndps_tree, int foffset)\r\n{\r\nguint32 addr_type=0;\r\nguint32 addr_len=0;\r\naddr_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_address, tvb, foffset, 4, addr_type);\r\nfoffset += 4;\r\naddr_len = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_item(ndps_tree, hf_address_len, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nswitch(addr_type)\r\n{\r\ncase 0x00000000:\r\nproto_tree_add_item(ndps_tree, hf_ndps_net, tvb, foffset, 4, ENC_NA);\r\nproto_tree_add_item(ndps_tree, hf_ndps_node, tvb, foffset+4, 6, ENC_NA);\r\nproto_tree_add_item(ndps_tree, hf_ndps_socket, tvb, foffset+10, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x00000001:\r\nproto_tree_add_item(ndps_tree, hf_ndps_port, tvb, foffset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ndps_tree, hf_ndps_ip, tvb, foffset+2, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\ntvb_ensure_bytes_exist(tvb, foffset, addr_len);\r\nfoffset += addr_len;\r\nreturn foffset+(addr_len%4);\r\n}\r\nstatic int\r\naddress_item(tvbuff_t* tvb, proto_tree *ndps_tree, int foffset)\r\n{\r\nguint32 addr_type=0;\r\naddr_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_address_type, tvb, foffset, 4, addr_type);\r\nfoffset += 4;\r\nswitch(addr_type)\r\n{\r\ncase 0:\r\ncase 1:\r\ncase 2:\r\ncase 3:\r\ncase 4:\r\ncase 5:\r\ncase 6:\r\ncase 7:\r\nfoffset = qualifiedname(tvb, ndps_tree, foffset);\r\nbreak;\r\ncase 8:\r\ncase 9:\r\ncase 10:\r\ncase 11:\r\ncase 12:\r\nfoffset = ndps_string(tvb, hf_object_name, ndps_tree, foffset, NULL);\r\nbreak;\r\ncase 13:\r\nproto_tree_add_item(ndps_tree, hf_ndps_attrib_boolean, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 14:\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 15:\r\nfoffset = print_address(tvb, ndps_tree, foffset);\r\nbreak;\r\ncase 16:\r\ncase 17:\r\ndefault:\r\nfoffset = ndps_string(tvb, hf_object_name, ndps_tree, foffset, NULL);\r\nbreak;\r\n}\r\nreturn foffset;\r\n}\r\nstatic int\r\ncredentials(tvbuff_t* tvb, packet_info *pinfo, proto_tree *ndps_tree, int foffset)\r\n{\r\nguint32 cred_type=0;\r\nguint32 length=0;\r\nguint32 number_of_items;\r\nguint32 ii;\r\nproto_tree *atree;\r\nproto_item *aitem, *expert_item;\r\ncred_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_item(ndps_tree, hf_ndps_cred_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nswitch (cred_type)\r\n{\r\ncase 0:\r\nfoffset = ndps_string(tvb, hf_ndps_user_name, ndps_tree, foffset, NULL);\r\nnumber_of_items=tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_num_passwords, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Password %d", ii+1);\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length!=0)\r\n{\r\nproto_tree_add_item(atree, hf_ndps_password, tvb, foffset, length, ENC_NA);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset += length;\r\n}\r\nbreak;\r\ncase 1:\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length!=0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_certified, tvb, foffset, length, ENC_NA);\r\n}\r\nfoffset += length;\r\nbreak;\r\ncase 2:\r\nfoffset = ndps_string(tvb, hf_ndps_server_name, ndps_tree, foffset, NULL);\r\nfoffset += 2;\r\nproto_tree_add_item(ndps_tree, hf_ndps_connection, tvb, foffset, 2, ENC_BIG_ENDIAN);\r\nfoffset += 2;\r\nbreak;\r\ncase 3:\r\nlength=tvb_get_ntohl(tvb, foffset);\r\nfoffset = ndps_string(tvb, hf_ndps_server_name, ndps_tree, foffset, NULL);\r\nif (length == 0)\r\n{\r\nfoffset += 2;\r\n}\r\nif (tvb_get_ntohs(tvb, foffset)==0)\r\n{\r\nfoffset+=2;\r\nif (tvb_get_ntohs(tvb, foffset)==0)\r\n{\r\nfoffset += 2;\r\n}\r\n}\r\nproto_tree_add_item(ndps_tree, hf_ndps_connection, tvb, foffset, 2, ENC_BIG_ENDIAN);\r\nfoffset += 2;\r\nfoffset = ndps_string(tvb, hf_ndps_user_name, ndps_tree, foffset, NULL);\r\nbreak;\r\ncase 4:\r\nfoffset = ndps_string(tvb, hf_ndps_server_name, ndps_tree, foffset, NULL);\r\nfoffset += 2;\r\nproto_tree_add_item(ndps_tree, hf_ndps_connection, tvb, foffset, 2, ENC_BIG_ENDIAN);\r\nfoffset += 2;\r\nfoffset = ndps_string(tvb, hf_ndps_user_name, ndps_tree, foffset, NULL);\r\nfoffset += 8;\r\nproto_tree_add_item(ndps_tree, hf_ndps_item_count, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = ndps_string(tvb, hf_ndps_pa_name, ndps_tree, foffset, NULL);\r\nfoffset = ndps_string(tvb, hf_ndps_tree, ndps_tree, foffset, NULL);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nreturn foffset;\r\n}\r\nstatic int\r\nevent_object_set(tvbuff_t* tvb, packet_info *pinfo, proto_tree *ndps_tree, int foffset)\r\n{\r\nguint32 number_of_items;\r\nguint32 number_of_items2;\r\nguint32 ii;\r\nguint32 jj;\r\nguint32 object_identifier;\r\nproto_tree *atree, *btree, *ctree;\r\nproto_item *aitem, *bitem, *citem, *expert_item;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Event");\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_num_events, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &bitem, "Event %u", ii+1);\r\nproto_tree_add_item(btree, hf_ndps_event_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = objectidentifier(tvb, btree, foffset);\r\nfoffset += align_4(tvb, foffset);\r\nfoffset = objectidentification(tvb, btree, foffset);\r\nfoffset += align_4(tvb, foffset);\r\nproto_tree_add_item(btree, hf_ndps_object_op, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nobject_identifier = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(btree, hf_ndps_event_object_identifier, tvb, foffset, 4, object_identifier);\r\nfoffset += 4;\r\nswitch (object_identifier)\r\n{\r\ncase 1:\r\nfoffset = objectidentifier(tvb, btree, foffset);\r\nfoffset += align_4(tvb, foffset);\r\nbreak;\r\ncase 2:\r\nnumber_of_items2 = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(btree, hf_ndps_item_count, tvb, foffset, 4, number_of_items2);\r\nfoffset += 4;\r\nfor (jj = 0; jj < number_of_items2; jj++ )\r\n{\r\nif (jj >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nctree = proto_tree_add_subtree_format(btree, tvb, foffset, -1, ett_ndps, &citem, "Item %u", jj+1);\r\nfoffset = objectidentifier(tvb, ctree, foffset);\r\nfoffset += align_4(tvb, foffset);\r\nproto_item_set_end(citem, tvb, foffset);\r\n}\r\nbreak;\r\n}\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nreturn foffset;\r\n}\r\nstatic int\r\ncardinal_seq(tvbuff_t* tvb, packet_info* pinfo, proto_tree *ndps_tree, int foffset)\r\n{\r\nguint32 number_of_items;\r\nguint32 length;\r\nguint32 ii;\r\nproto_tree *atree;\r\nproto_item *aitem, *expert_item;\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_item_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Cardinal %u", ii+1);\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length==4)\r\n{\r\nproto_tree_add_item(atree, hf_ndps_attribute_value, tvb, foffset, length, ENC_BIG_ENDIAN);\r\n}\r\ntvb_ensure_bytes_exist(tvb, foffset, length+length%2);\r\nfoffset += length;\r\nfoffset += (length%2);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nreturn foffset;\r\n}\r\nstatic int\r\nserver_entry(tvbuff_t* tvb, packet_info* pinfo, proto_tree *ndps_tree, int foffset)\r\n{\r\nchar *server_name;\r\nguint32 number_of_items;\r\nguint32 ii;\r\nguint32 data_type;\r\nproto_tree *atree, *btree;\r\nproto_item *aitem, *bitem, *expert_item;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Server Info");\r\nfoffset = ndps_string(tvb, hf_ndps_server_name, ndps_tree, foffset, &server_name);\r\nproto_item_append_text(aitem, ": %s", format_text(server_name, strlen(server_name)));\r\nproto_tree_add_item(atree, hf_ndps_server_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = print_address(tvb, atree, foffset);\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_num_servers, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Info %u", ii+1);\r\ndata_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_item(btree, hf_ndps_data_item_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nswitch (data_type)\r\n{\r\ncase 0:\r\nproto_tree_add_item(btree, hf_info_int, tvb, foffset, 1, ENC_BIG_ENDIAN);\r\nfoffset++;\r\nbreak;\r\ncase 1:\r\nproto_tree_add_item(btree, hf_info_int16, tvb, foffset, 2, ENC_BIG_ENDIAN);\r\nfoffset += 2;\r\nbreak;\r\ncase 2:\r\nproto_tree_add_item(btree, hf_info_int32, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 3:\r\nproto_tree_add_item(btree, hf_info_boolean, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 4:\r\ncase 5:\r\nfoffset = ndps_string(tvb, hf_info_string, btree, foffset, NULL);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nreturn foffset;\r\n}\r\nstatic int\r\nattribute_value(tvbuff_t* tvb, packet_info* pinfo, proto_tree *ndps_tree, int foffset)\r\n{\r\nguint32 ii;\r\nguint32 jj;\r\nguint32 number_of_items;\r\nguint32 number_of_items2;\r\nguint32 attribute_type;\r\nguint32 integer_or_oid;\r\nguint32 event_object_type;\r\nguint32 ignored_type;\r\nguint32 resource_type;\r\nguint32 identifier_type;\r\nguint32 criterion_type;\r\nguint32 card_enum_time;\r\nguint32 media_type;\r\nguint32 doc_content;\r\nguint32 page_size;\r\nguint32 medium_size;\r\nguint32 numbers_up;\r\nguint32 colorant_set;\r\nguint32 length;\r\nguint32 dimension;\r\nguint32 location;\r\nguint32 cardinal;\r\nconst char *label;\r\nguint32 label_value;\r\nproto_tree *atree, *btree;\r\nproto_item *aitem, *bitem, *expert_item;\r\nif (global_attribute_name==NULL)\r\n{\r\nlabel_value = 1;\r\nlabel = try_val_to_str(label_value, object_ids_7);\r\nglobal_attribute_name = label;\r\n}\r\nattribute_type = tvb_get_ntohl(tvb, foffset);\r\nif (ndps_show_oids)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_obj_attribute_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\n}\r\nfoffset += 4;\r\nswitch(attribute_type)\r\n{\r\ncase 0:\r\nproto_tree_add_item(ndps_tree, hf_ndps_data, tvb, foffset+4, tvb_get_ntohl(tvb, foffset), ENC_NA);\r\nbreak;\r\ncase 1:\r\ncase 2:\r\ncase 3:\r\ncase 6:\r\ncase 40:\r\ncase 50:\r\ncase 58:\r\ncase 102:\r\ncase 103:\r\ncase 108:\r\nfoffset = ndps_string(tvb, hf_object_name, ndps_tree, foffset, NULL);\r\nbreak;\r\ncase 4:\r\ncase 5:\r\ncase 38:\r\nfoffset = name_or_id(tvb, ndps_tree, foffset);\r\nbreak;\r\ncase 39:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_item_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Item %d", ii+1);\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 7:\r\ncase 79:\r\nfoffset = ndps_string(tvb, hf_object_name, ndps_tree, foffset, NULL);\r\nfoffset = name_or_id(tvb, ndps_tree, foffset);\r\nbreak;\r\ncase 8:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_item_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Name %u", ii+1);\r\nfoffset = ndps_string(tvb, hf_object_name, atree, foffset, NULL);\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 9:\r\ncase 10:\r\ncase 11:\r\ncase 13:\r\ncase 15:\r\ncase 18:\r\ncase 19:\r\ncase 35:\r\ncase 57:\r\ncase 72:\r\ncase 95:\r\nif (global_attribute_name != NULL &&\r\nstrcmp(global_attribute_name,"(Novell) Attribute PRINTER SECURITY LEVEL")==0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_print_security, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\nbreak;\r\ncase 12:\r\ncase 14:\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length==4)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_info_int32, tvb, foffset, length, ENC_BIG_ENDIAN);\r\n}\r\ntvb_ensure_bytes_exist(tvb, foffset, length);\r\nfoffset += length;\r\nbreak;\r\ncase 16:\r\ncase 17:\r\nproto_tree_add_item(ndps_tree, hf_ndps_lower_range, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_upper_range, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 20:\r\ncase 22:\r\ncase 24:\r\ncase 31:\r\ncase 29:\r\nproto_tree_add_item(ndps_tree, hf_ndps_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nbreak;\r\ncase 21:\r\ncase 23:\r\ncase 30:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_item_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Item %u", ii+1);\r\nproto_tree_add_item(atree, hf_ndps_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 25:\r\ncase 26:\r\ncase 32:\r\ncase 33:\r\nproto_tree_add_item(ndps_tree, hf_ndps_lower_range_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nproto_tree_add_item(ndps_tree, hf_ndps_upper_range_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nbreak;\r\ncase 27:\r\nproto_tree_add_item(ndps_tree, hf_ndps_lower_range_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nbreak;\r\ncase 28:\r\nproto_tree_add_item(ndps_tree, hf_ndps_upper_range_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nbreak;\r\ncase 34:\r\nproto_tree_add_item(ndps_tree, hf_ndps_attrib_boolean, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 36:\r\nfoffset = objectidentifier(tvb, ndps_tree, foffset);\r\nbreak;\r\ncase 37:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_num_objects, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Object %d", ii+1);\r\nfoffset = objectidentifier(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 41:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_num_names, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Name %u", ii+1);\r\nfoffset = ndps_string(tvb, hf_object_name, atree, foffset, NULL);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 42:\r\nproto_tree_add_item(ndps_tree, hf_ndps_realization, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 43:\r\nproto_tree_add_item(ndps_tree, hf_ndps_xdimension_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nproto_tree_add_item(ndps_tree, hf_ndps_ydimension_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nbreak;\r\ncase 44:\r\ndimension = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_dim_value, tvb, foffset, 4, dimension);\r\nfoffset += 4;\r\nif (dimension == 0) {\r\nproto_tree_add_item(ndps_tree, hf_ndps_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\n}\r\nelse\r\n{\r\nfoffset = name_or_id(tvb, ndps_tree, foffset);\r\n}\r\nproto_tree_add_item(ndps_tree, hf_ndps_dim_flag, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nbreak;\r\ncase 45:\r\ndimension = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_xydim_value, tvb, foffset, 4, dimension);\r\nfoffset += 4;\r\nif (dimension == 1) {\r\nfoffset = name_or_id(tvb, ndps_tree, foffset);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_xdimension_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nproto_tree_add_item(ndps_tree, hf_ndps_ydimension_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\n}\r\nproto_tree_add_item(ndps_tree, hf_ndps_dim_flag, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nbreak;\r\ncase 46:\r\nlocation = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_location_value, tvb, foffset, 4, location);\r\nfoffset += 4;\r\nif (location == 0) {\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_num_locations, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Location %u", ii+1);\r\nproto_tree_add_item(atree, hf_ndps_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\n}\r\nelse\r\n{\r\nfoffset = name_or_id(tvb, ndps_tree, foffset);\r\n}\r\nproto_tree_add_item(ndps_tree, hf_ndps_dim_flag, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nbreak;\r\ncase 47:\r\nproto_tree_add_item(ndps_tree, hf_ndps_xmin_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nproto_tree_add_item(ndps_tree, hf_ndps_xmax_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nproto_tree_add_item(ndps_tree, hf_ndps_ymin_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nproto_tree_add_item(ndps_tree, hf_ndps_ymax_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nbreak;\r\ncase 48:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_num_areas, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Area %u", ii+1);\r\nproto_tree_add_item(atree, hf_ndps_xmin_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nproto_tree_add_item(atree, hf_ndps_xmax_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nproto_tree_add_item(atree, hf_ndps_ymin_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nproto_tree_add_item(atree, hf_ndps_ymax_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 49:\r\nproto_tree_add_item(ndps_tree, hf_ndps_edge_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 51:\r\ncardinal = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_cardinal_or_oid, tvb, foffset, 4, cardinal);\r\nfoffset += 4;\r\nif (cardinal==0) {\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\nelse\r\n{\r\nfoffset = objectidentifier(tvb, ndps_tree, foffset);\r\n}\r\nbreak;\r\ncase 52:\r\nfoffset = objectidentifier(tvb, ndps_tree, foffset);\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 53:\r\ncardinal = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_cardinal_name_or_oid, tvb, foffset, 4, cardinal);\r\nfoffset += 4;\r\nif (cardinal==0) {\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\nelse\r\n{\r\nfoffset = name_or_id(tvb, ndps_tree, foffset);\r\n}\r\nbreak;\r\ncase 54:\r\ninteger_or_oid = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_integer_or_oid, tvb, foffset, 4, integer_or_oid);\r\nfoffset += 4;\r\nif (integer_or_oid==0) {\r\nfoffset = objectidentifier(tvb, ndps_tree, foffset);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\nbreak;\r\ncase 55:\r\nproto_tree_add_item(ndps_tree, hf_ndps_profile_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_persistence, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = qualifiedname(tvb, ndps_tree, foffset);\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length==4)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_value, tvb, foffset, length, ENC_BIG_ENDIAN);\r\n}\r\nfoffset += length;\r\nproto_tree_add_item(ndps_tree, hf_ndps_language_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = name_or_id(tvb, ndps_tree, foffset);\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_num_address_items, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Address Item %u", ii+1);\r\nfoffset = address_item(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_num_events, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Event %u", ii+1);\r\nproto_tree_add_item(atree, hf_ndps_event_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = objectidentifier(tvb, atree, foffset);\r\nfoffset += align_4(tvb, foffset);\r\nfoffset = objectidentification(tvb, atree, foffset);\r\nproto_tree_add_item(atree, hf_ndps_object_op, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nevent_object_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(atree, hf_ndps_event_object_identifier, tvb, foffset, 4, event_object_type);\r\nfoffset += 4;\r\nswitch (event_object_type)\r\n{\r\ncase 2:\r\nnumber_of_items2 = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_num_objects, tvb, foffset, 4, number_of_items2);\r\nfoffset += 4;\r\nfor (jj = 0; jj < number_of_items2; jj++ )\r\n{\r\nif (jj >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nfoffset = objectidentifier(tvb, atree, foffset);\r\n}\r\nfoffset += 4;\r\nbreak;\r\ncase 1:\r\nfoffset = objectidentifier(tvb, atree, foffset);\r\nbreak;\r\ncase 0:\r\nnumber_of_items2 = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_num_objects, tvb, foffset, 4, number_of_items2);\r\nfoffset += 4;\r\nfor (jj = 0; jj < number_of_items2; jj++ )\r\n{\r\nif (jj >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Object %u", jj+1);\r\nfoffset = objectidentifier(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nbreak;\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 56:\r\ncase 63:\r\ncase 66:\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nndps_string(tvb, hf_info_string, ndps_tree, foffset, NULL);\r\nfoffset += length+2;\r\nfoffset += align_4(tvb, foffset);\r\nbreak;\r\ncase 59:\r\nproto_tree_add_item(ndps_tree, hf_ndps_delivery_add_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nevent_object_type = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nswitch(event_object_type)\r\n{\r\ncase 0:\r\ncase 1:\r\ncase 2:\r\ncase 3:\r\nfoffset = ndps_string(tvb, hf_info_string, ndps_tree, foffset, NULL);\r\nbreak;\r\ncase 4:\r\nfoffset = ndps_string(tvb, hf_object_name, ndps_tree, foffset, NULL);\r\nfoffset = name_or_id(tvb, ndps_tree, foffset);\r\nbreak;\r\ncase 5:\r\ncase 6:\r\nfoffset = objectidentifier(tvb, ndps_tree, foffset);\r\nfoffset = qualifiedname(tvb, ndps_tree, foffset);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nbreak;\r\ncase 60:\r\nfoffset = objectidentification(tvb, ndps_tree, foffset);\r\nbreak;\r\ncase 61:\r\nfoffset = objectidentifier(tvb, ndps_tree, foffset);\r\nfoffset = name_or_id(tvb, ndps_tree, foffset);\r\nfoffset = address_item(tvb, ndps_tree, foffset);\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = name_or_id(tvb, ndps_tree, foffset);\r\nbreak;\r\ncase 62:\r\nfoffset = objectidentifier(tvb, ndps_tree, foffset);\r\ncriterion_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_criterion_type, tvb, foffset, 4, criterion_type);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 64:\r\nfoffset = objectidentifier(tvb, ndps_tree, foffset);\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 65:\r\nfoffset = objectidentifier(tvb, ndps_tree, foffset);\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_num_job_categories, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Job %u", ii+1);\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length==4)\r\n{\r\nproto_tree_add_item(atree, hf_ndps_attribute_value, tvb, foffset, length, ENC_BIG_ENDIAN);\r\n}\r\ntvb_ensure_bytes_exist(tvb, foffset, length+length%2);\r\nfoffset += length;\r\nfoffset += (length%2);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 67:\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = objectidentifier(tvb, ndps_tree, foffset);\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_num_ignored_attributes, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Ignored Attribute %u", ii+1);\r\nignored_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(atree, hf_ndps_ignored_type, tvb, foffset, 4, ignored_type);\r\nfoffset += 4;\r\nif (ignored_type == 38)\r\n{\r\nfoffset = name_or_id(tvb, atree, foffset);\r\n}\r\nelse\r\n{\r\nfoffset = objectidentifier(tvb, atree, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 68:\r\nresource_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_resource_type, tvb, foffset, 4, resource_type);\r\nfoffset += 4;\r\nif (resource_type == 0)\r\n{\r\nfoffset = name_or_id(tvb, ndps_tree, foffset);\r\n}\r\nelse\r\n{\r\nfoffset = ndps_string(tvb, hf_ndps_tree, ndps_tree, foffset, NULL);\r\n}\r\nbreak;\r\ncase 69:\r\nfoffset = name_or_id(tvb, ndps_tree, foffset);\r\nfoffset = name_or_id(tvb, ndps_tree, foffset);\r\nbreak;\r\ncase 70:\r\nfoffset = ndps_string(tvb, hf_ndps_tree, ndps_tree, foffset, NULL);\r\nfoffset = ndps_string(tvb, hf_ndps_tree, ndps_tree, foffset, NULL);\r\nbreak;\r\ncase 71:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_num_resources, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Resource %u", ii+1);\r\nresource_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(atree, hf_ndps_resource_type, tvb, foffset, 4, resource_type);\r\nfoffset += 4;\r\nif (resource_type == 0)\r\n{\r\nfoffset = name_or_id(tvb, atree, foffset);\r\n}\r\nelse\r\n{\r\nfoffset = ndps_string(tvb, hf_ndps_tree, atree, foffset, NULL);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 73:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_num_page_selects, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Page Select %u", ii+1);\r\nproto_tree_add_item(atree, hf_ndps_page_flag, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nidentifier_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(atree, hf_ndps_identifier_type, tvb, foffset, 4, identifier_type);\r\nfoffset += 4;\r\nif (identifier_type == 0)\r\n{\r\nproto_tree_add_item(atree, hf_ndps_attribute_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\nif (identifier_type == 1)\r\n{\r\nfoffset = ndps_string(tvb, hf_ndps_tree, atree, foffset, NULL);\r\n}\r\nif (identifier_type == 2)\r\n{\r\nfoffset = name_or_id(tvb, atree, foffset);\r\n}\r\nproto_tree_add_item(atree, hf_ndps_page_flag, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nidentifier_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(atree, hf_ndps_identifier_type, tvb, foffset, 4, identifier_type);\r\nfoffset += 4;\r\nif (identifier_type == 0)\r\n{\r\nproto_tree_add_item(atree, hf_ndps_attribute_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\nif (identifier_type == 1)\r\n{\r\nfoffset = ndps_string(tvb, hf_ndps_tree, atree, foffset, NULL);\r\n}\r\nif (identifier_type == 2)\r\n{\r\nfoffset = name_or_id(tvb, atree, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 74:\r\nmedia_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_media_type, tvb, foffset, 4, media_type);\r\nfoffset += 4;\r\nif (media_type == 0)\r\n{\r\nfoffset = name_or_id(tvb, ndps_tree, foffset);\r\n}\r\nelse\r\n{\r\nfoffset = ndps_string(tvb, hf_ndps_tree, ndps_tree, foffset, NULL);\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_item_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Item %u", ii+1);\r\nproto_tree_add_item(atree, hf_ndps_page_flag, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nidentifier_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(atree, hf_ndps_identifier_type, tvb, foffset, 4, identifier_type);\r\nfoffset += 4;\r\nif (identifier_type == 0)\r\n{\r\nproto_tree_add_item(atree, hf_ndps_attribute_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\nif (identifier_type == 1)\r\n{\r\nfoffset = ndps_string(tvb, hf_ndps_tree, atree, foffset, NULL);\r\n}\r\nif (identifier_type == 2)\r\n{\r\nfoffset = name_or_id(tvb, atree, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\n}\r\nbreak;\r\ncase 75:\r\ndoc_content = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_doc_content, tvb, foffset, 4, doc_content);\r\nfoffset += 4;\r\nif (doc_content == 0)\r\n{\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length!=0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_octet_string, tvb, foffset, length, ENC_NA);\r\n}\r\nfoffset += length;\r\nfoffset += (length%2);\r\n}\r\nelse\r\n{\r\nfoffset = ndps_string(tvb, hf_object_name, ndps_tree, foffset, NULL);\r\nfoffset = name_or_id(tvb, ndps_tree, foffset);\r\n}\r\nbreak;\r\ncase 76:\r\npage_size = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_page_size, tvb, foffset, 4, page_size);\r\nfoffset += 4;\r\nif (page_size == 0)\r\n{\r\nfoffset = objectidentifier(tvb, ndps_tree, foffset);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_xdimension_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nproto_tree_add_item(ndps_tree, hf_ndps_ydimension_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\n}\r\nbreak;\r\ncase 77:\r\nproto_tree_add_item(ndps_tree, hf_ndps_direction, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 78:\r\nproto_tree_add_item(ndps_tree, hf_ndps_page_order, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 80:\r\nfoffset = name_or_id(tvb, ndps_tree, foffset);\r\nmedium_size = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_medium_size, tvb, foffset, 4, medium_size);\r\nfoffset += 4;\r\nif (medium_size == 0)\r\n{\r\npage_size = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_page_size, tvb, foffset, 4, page_size);\r\nfoffset += 4;\r\nif (page_size == 0)\r\n{\r\nfoffset = objectidentifier(tvb, ndps_tree, foffset);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_xdimension_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nproto_tree_add_item(ndps_tree, hf_ndps_ydimension_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\n}\r\nproto_tree_add_item(ndps_tree, hf_ndps_long_edge_feeds, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_xmin_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nproto_tree_add_item(ndps_tree, hf_ndps_xmax_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nproto_tree_add_item(ndps_tree, hf_ndps_ymin_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nproto_tree_add_item(ndps_tree, hf_ndps_ymax_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_lower_range_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nproto_tree_add_item(ndps_tree, hf_ndps_upper_range_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nproto_tree_add_item(ndps_tree, hf_ndps_inc_across_feed, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nproto_tree_add_item(ndps_tree, hf_ndps_lower_range_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nproto_tree_add_item(ndps_tree, hf_ndps_upper_range_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nproto_tree_add_item(ndps_tree, hf_ndps_size_inc_in_feed, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nproto_tree_add_item(ndps_tree, hf_ndps_long_edge_feeds, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_xmin_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nproto_tree_add_item(ndps_tree, hf_ndps_xmax_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nproto_tree_add_item(ndps_tree, hf_ndps_ymin_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nproto_tree_add_item(ndps_tree, hf_ndps_ymax_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\n}\r\nbreak;\r\ncase 81:\r\nfoffset = name_or_id(tvb, ndps_tree, foffset);\r\nfoffset = name_or_id(tvb, ndps_tree, foffset);\r\nbreak;\r\ncase 82:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_num_page_informations, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Page Information %u", ii+1);\r\nproto_tree_add_item(atree, hf_ndps_page_order, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(atree, hf_ndps_page_orientation, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 83:\r\nproto_tree_add_item(ndps_tree, hf_ndps_identifier_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 84:\r\nfoffset = objectidentifier(tvb, ndps_tree, foffset);\r\nproto_tree_add_item(ndps_tree, hf_ndps_lower_range, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_upper_range, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 85:\r\nfoffset = objectidentifier(tvb, ndps_tree, foffset);\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_num_categories, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Category %u", ii+1);\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length==4)\r\n{\r\nproto_tree_add_item(atree, hf_ndps_attribute_value, tvb, foffset, length, ENC_BIG_ENDIAN);\r\n}\r\nfoffset += length;\r\nfoffset += (length%2);\r\n}\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_num_values, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Value %d", ii+1);\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length==4)\r\n{\r\nproto_tree_add_item(atree, hf_ndps_attribute_value, tvb, foffset, length, ENC_BIG_ENDIAN);\r\n}\r\ntvb_ensure_bytes_exist(tvb, foffset, length+length%2);\r\nfoffset += length;\r\nfoffset += (length%2);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 86:\r\nnumbers_up=tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_numbers_up, tvb, foffset, 4, numbers_up);\r\nfoffset += 4;\r\nswitch(numbers_up)\r\n{\r\ncase 0:\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 1:\r\nfoffset = name_or_id(tvb, ndps_tree, foffset);\r\nbreak;\r\ncase 2:\r\nproto_tree_add_item(ndps_tree, hf_ndps_lower_range, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_upper_range, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nbreak;\r\ncase 87:\r\ncase 88:\r\nfoffset = ndps_string(tvb, hf_object_name, ndps_tree, foffset, NULL);\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 89:\r\nfoffset = ndps_string(tvb, hf_object_name, ndps_tree, foffset, NULL);\r\nfoffset = qualifiedname(tvb, ndps_tree, foffset);\r\nbreak;\r\ncase 90:\r\nfoffset = ndps_string(tvb, hf_object_name, ndps_tree, foffset, NULL);\r\nproto_tree_add_item(ndps_tree, hf_level, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_interval, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 91:\r\nproto_tree_add_item(ndps_tree, hf_ndps_address, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length!=0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_add_bytes, tvb, foffset, 4, ENC_NA);\r\n}\r\nfoffset += length;\r\nbreak;\r\ncase 92:\r\ndimension = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_xydim_value, tvb, foffset, 4, dimension);\r\nfoffset += 4;\r\nswitch (dimension)\r\n{\r\ncase 1:\r\nfoffset = name_or_id(tvb, ndps_tree, foffset);\r\nbreak;\r\ncase 0:\r\nproto_tree_add_item(ndps_tree, hf_ndps_xdimension_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nproto_tree_add_item(ndps_tree, hf_ndps_ydimension_n64, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(ndps_tree, hf_ndps_xdimension, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_ydimension, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\n}\r\nbreak;\r\ncase 93:\r\nfoffset = name_or_id(tvb, ndps_tree, foffset);\r\nproto_tree_add_item(ndps_tree, hf_ndps_xdimension, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_ydimension, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 94:\r\nfoffset += 4;\r\nfoffset = name_or_id(tvb, ndps_tree, foffset);\r\nproto_tree_add_item(ndps_tree, hf_ndps_state_severity, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_training, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = objectidentifier(tvb, ndps_tree, foffset);\r\nfoffset += align_4(tvb, foffset);\r\nfoffset = objectidentification(tvb, ndps_tree, foffset);\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4*number_of_items;\r\nfoffset = name_or_id(tvb, ndps_tree, foffset);\r\nbreak;\r\ncase 96:\r\nfoffset = qualifiedname(tvb, ndps_tree, foffset);\r\nbreak;\r\ncase 97:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_num_names, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Name %u", ii+1);\r\nfoffset = qualifiedname(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 98:\r\ncolorant_set = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_item(ndps_tree, hf_ndps_colorant_set, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nif (colorant_set==0)\r\n{\r\nfoffset = name_or_id(tvb, ndps_tree, foffset);\r\n}\r\nelse\r\n{\r\nfoffset = objectidentifier(tvb, ndps_tree, foffset);\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_num_colorants, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Colorant %u", ii+1);\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\n}\r\nbreak;\r\ncase 99:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_printer_def_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Printer %u", ii+1);\r\nfoffset = ndps_string(tvb, hf_ndps_printer_type, atree, foffset, NULL);\r\nfoffset = ndps_string(tvb, hf_ndps_printer_manuf, atree, foffset, NULL);\r\nfoffset = ndps_string(tvb, hf_ndps_inf_file_name, atree, foffset, NULL);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nproto_tree_add_item(ndps_tree, hf_os_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 100:\r\nfoffset = ndps_string(tvb, hf_ndps_pa_name, ndps_tree, foffset, NULL);\r\nfoffset = objectidentifier(tvb, ndps_tree, foffset);\r\nproto_tree_add_item(ndps_tree, hf_ndps_event_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 101:\r\nfoffset = qualifiedname(tvb, ndps_tree, foffset);\r\nfoffset = qualifiedname(tvb, ndps_tree, foffset);\r\nbreak;\r\ncase 104:\r\ncard_enum_time = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_item(ndps_tree, hf_ndps_card_enum_time, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nswitch (card_enum_time)\r\n{\r\ncase 0:\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 1:\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\n}\r\nbreak;\r\ncase 105:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_num_objects, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Object %u", ii+1);\r\nfoffset = ndps_string(tvb, hf_ndps_pa_name, atree, foffset, NULL);\r\nproto_tree_add_item(atree, hf_ndps_attribute_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 106:\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length!=0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_octet_string, tvb, foffset, length, ENC_NA);\r\n}\r\nfoffset += length;\r\nfoffset += (length%2);\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length!=0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_octet_string, tvb, foffset, length, ENC_NA);\r\n}\r\nfoffset += length;\r\nfoffset += (length%2);\r\nbreak;\r\ncase 107:\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length!=0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_octet_string, tvb, foffset, length, ENC_NA);\r\n}\r\nfoffset += length;\r\nfoffset += (length%2);\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 109:\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_persistence, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = qualifiedname(tvb, ndps_tree, foffset);\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length!=0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_octet_string, tvb, foffset, length, ENC_NA);\r\n}\r\nfoffset += length;\r\nfoffset += (length%2);\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = name_or_id(tvb, ndps_tree, foffset);\r\nproto_tree_add_item(ndps_tree, hf_ndps_delivery_add_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nevent_object_type = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nswitch(event_object_type)\r\n{\r\ncase 0:\r\ncase 1:\r\ncase 2:\r\nfoffset = ndps_string(tvb, hf_ndps_tree, ndps_tree, foffset, NULL);\r\nbreak;\r\ncase 3:\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length!=0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_octet_string, tvb, foffset, length, ENC_NA);\r\n}\r\nfoffset += length;\r\nfoffset += (length%2);\r\nbreak;\r\ncase 4:\r\nfoffset = ndps_string(tvb, hf_object_name, ndps_tree, foffset, NULL);\r\nfoffset = name_or_id(tvb, ndps_tree, foffset);\r\nbreak;\r\ncase 5:\r\ncase 6:\r\nfoffset = objectidentifier(tvb, ndps_tree, foffset);\r\nfoffset = qualifiedname(tvb, ndps_tree, foffset);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_num_events, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Event %u", ii+1);\r\nfoffset = ndps_string(tvb, hf_object_name, atree, foffset, NULL);\r\nfoffset = objectidentifier(tvb, atree, foffset);\r\nproto_tree_add_item(atree, hf_ndps_event_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nfoffset = objectidentifier(tvb, ndps_tree, foffset);\r\nfoffset = qualifiedname(tvb, ndps_tree, foffset);\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_num_objects, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Object %u", ii+1);\r\nfoffset = objectidentifier(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = ndps_string(tvb, hf_ndps_pa_name, ndps_tree, foffset, NULL);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nreturn foffset;\r\n}\r\nstatic int\r\ncommonarguments(tvbuff_t* tvb, packet_info* pinfo, proto_tree *ndps_tree, int foffset)\r\n{\r\nguint32 number_of_items;\r\nguint32 ii;\r\nproto_tree *atree, *btree;\r\nproto_item *aitem, *bitem, *expert_item;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Common Arguments");\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_num_args, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Argument %u", ii+1);\r\nfoffset = attribute_value(tvb, pinfo, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nreturn foffset;\r\n}\r\nstatic int\r\nres_add_input_data(tvbuff_t* tvb, proto_tree *ndps_tree, int foffset)\r\n{\r\nguint32 resource_type=0;\r\nresource_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_res_type, tvb, foffset, 4, resource_type);\r\nfoffset += 4;\r\nswitch (resource_type)\r\n{\r\ncase 0:\r\nproto_tree_add_item(ndps_tree, hf_os_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = ndps_string(tvb, hf_ndps_prn_dir_name, ndps_tree, foffset, NULL);\r\nfoffset = ndps_string(tvb, hf_ndps_prn_file_name, ndps_tree, foffset, NULL);\r\nbreak;\r\ncase 1:\r\nfoffset = ndps_string(tvb, hf_ndps_vendor_dir, ndps_tree, foffset, NULL);\r\nfoffset = ndps_string(tvb, hf_ndps_prn_file_name, ndps_tree, foffset, NULL);\r\nbreak;\r\ncase 2:\r\nfoffset = ndps_string(tvb, hf_ndps_banner_name, ndps_tree, foffset, NULL);\r\nbreak;\r\ncase 3:\r\nproto_tree_add_item(ndps_tree, hf_os_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_font_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = ndps_string(tvb, hf_ndps_prn_file_name, ndps_tree, foffset, NULL);\r\nbreak;\r\ncase 4:\r\ncase 5:\r\nproto_tree_add_item(ndps_tree, hf_os_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = ndps_string(tvb, hf_ndps_prn_dir_name, ndps_tree, foffset, NULL);\r\nproto_tree_add_item(ndps_tree, hf_archive_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nreturn foffset;\r\n}\r\nstatic gint\r\nndps_equal(gconstpointer v, gconstpointer v2)\r\n{\r\nconst ndps_req_hash_key *val1 = (const ndps_req_hash_key*)v;\r\nconst ndps_req_hash_key *val2 = (const ndps_req_hash_key*)v2;\r\nif (val1->conversation == val2->conversation &&\r\nval1->ndps_xport == val2->ndps_xport ) {\r\nreturn 1;\r\n}\r\nreturn 0;\r\n}\r\nstatic guint\r\nndps_hash(gconstpointer v)\r\n{\r\nconst ndps_req_hash_key *ndps_key = (const ndps_req_hash_key*)v;\r\nreturn GPOINTER_TO_UINT(ndps_key->conversation) + ndps_key->ndps_xport;\r\n}\r\nstatic void\r\nndps_init_protocol(void)\r\n{\r\nreassembly_table_init(&ndps_reassembly_table,\r\n&addresses_reassembly_table_functions);\r\nndps_req_hash = g_hash_table_new(ndps_hash, ndps_equal);\r\n}\r\nstatic void\r\nndps_cleanup_protocol(void)\r\n{\r\nreassembly_table_destroy(&ndps_reassembly_table);\r\n}\r\nstatic void\r\nndps_postseq_cleanup(void)\r\n{\r\nif (ndps_req_hash) {\r\ng_hash_table_destroy(ndps_req_hash);\r\nndps_req_hash = NULL;\r\n}\r\n}\r\nstatic ndps_req_hash_value*\r\nndps_hash_insert(conversation_t *conversation, guint32 ndps_xport)\r\n{\r\nndps_req_hash_key *request_key;\r\nndps_req_hash_value *request_value;\r\nrequest_key = wmem_new(wmem_file_scope(), ndps_req_hash_key);\r\nrequest_key->conversation = conversation;\r\nrequest_key->ndps_xport = ndps_xport;\r\nrequest_value = wmem_new(wmem_file_scope(), ndps_req_hash_value);\r\nrequest_value->ndps_prog = 0;\r\nrequest_value->ndps_func = 0;\r\nrequest_value->ndps_frame_num = 0;\r\nrequest_value->ndps_frag = FALSE;\r\nrequest_value->ndps_end_frag = 0;\r\ng_hash_table_insert(ndps_req_hash, request_key, request_value);\r\nreturn request_value;\r\n}\r\nstatic ndps_req_hash_value*\r\nndps_hash_lookup(conversation_t *conversation, guint32 ndps_xport)\r\n{\r\nndps_req_hash_key request_key;\r\nrequest_key.conversation = conversation;\r\nrequest_key.ndps_xport = ndps_xport;\r\nreturn (ndps_req_hash_value *)g_hash_table_lookup(ndps_req_hash, &request_key);\r\n}\r\nstatic void\r\ndissect_ndps(tvbuff_t *tvb, packet_info *pinfo, proto_tree *ndps_tree)\r\n{\r\nguint32 ndps_xid;\r\nguint32 ndps_prog;\r\nguint32 ndps_packet_type;\r\nint foffset;\r\nguint32 ndps_hfname;\r\nguint32 ndps_func;\r\nconst char *ndps_program_string;\r\nconst char *ndps_func_string;\r\nndps_packet_type = tvb_get_ntohl(tvb, 8);\r\nif (ndps_packet_type != 0 && ndps_packet_type != 1) {\r\ncol_set_str(pinfo->cinfo, COL_INFO, "(Continuation Data)");\r\nproto_tree_add_bytes_format(ndps_tree, hf_ndps_data, tvb, 0, -1, NULL, "Data - (%d Bytes)", tvb_reported_length(tvb));\r\nreturn;\r\n}\r\nfoffset = 0;\r\nproto_tree_add_item(ndps_tree, hf_ndps_record_mark, tvb,\r\nfoffset, 2, ENC_BIG_ENDIAN);\r\nfoffset += 2;\r\nproto_tree_add_item(ndps_tree, hf_ndps_length, tvb,\r\nfoffset, 2, ENC_BIG_ENDIAN);\r\nfoffset += 2;\r\nndps_xid = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_xid, tvb, foffset, 4, ndps_xid);\r\nfoffset += 4;\r\nndps_packet_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_packet_type, tvb, foffset, 4, ndps_packet_type);\r\nfoffset += 4;\r\nif(ndps_packet_type == 0x00000001)\r\n{\r\ncol_set_str(pinfo->cinfo, COL_INFO, "R NDPS ");\r\nproto_tree_add_item(ndps_tree, hf_ndps_rpc_accept, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nif (tvb_get_ntohl(tvb, foffset)==0) {\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_auth_null, tvb, foffset, 8, ENC_NA);\r\nfoffset += 8;\r\n}\r\nelse\r\n{\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_rpc_rej_stat, tvb, foffset+4, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\ndissect_ndps_reply(tvb, pinfo, ndps_tree, foffset);\r\n}\r\nelse\r\n{\r\ncol_set_str(pinfo->cinfo, COL_INFO, "C NDPS ");\r\nproto_tree_add_item(ndps_tree, hf_ndps_rpc_version, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nndps_prog = tvb_get_ntohl(tvb, foffset);\r\nndps_program_string = try_val_to_str(ndps_prog, spx_ndps_program_vals);\r\nif( ndps_program_string != NULL)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_spx_ndps_program, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\ncol_append_str(pinfo->cinfo, COL_INFO, (const gchar*) ndps_program_string);\r\ncol_append_str(pinfo->cinfo, COL_INFO, ", ");\r\nproto_tree_add_item(ndps_tree, hf_spx_ndps_version, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nndps_func = tvb_get_ntohl(tvb, foffset);\r\nswitch(ndps_prog)\r\n{\r\ncase 0x060976:\r\nndps_hfname = hf_spx_ndps_func_print;\r\nndps_func_string = try_val_to_str_ext(ndps_func, &spx_ndps_print_func_vals_ext);\r\nbreak;\r\ncase 0x060977:\r\nndps_hfname = hf_spx_ndps_func_broker;\r\nndps_func_string = try_val_to_str_ext(ndps_func, &spx_ndps_broker_func_vals_ext);\r\nbreak;\r\ncase 0x060978:\r\nndps_hfname = hf_spx_ndps_func_registry;\r\nndps_func_string = try_val_to_str_ext(ndps_func, &spx_ndps_registry_func_vals_ext);\r\nbreak;\r\ncase 0x060979:\r\nndps_hfname = hf_spx_ndps_func_notify;\r\nndps_func_string = try_val_to_str_ext(ndps_func, &spx_ndps_notify_func_vals_ext);\r\nbreak;\r\ncase 0x06097a:\r\nndps_hfname = hf_spx_ndps_func_resman;\r\nndps_func_string = try_val_to_str_ext(ndps_func, &spx_ndps_resman_func_vals_ext);\r\nbreak;\r\ncase 0x06097b:\r\nndps_hfname = hf_spx_ndps_func_delivery;\r\nndps_func_string = try_val_to_str(ndps_func, spx_ndps_deliver_func_vals);\r\nbreak;\r\ndefault:\r\nndps_hfname = 0;\r\nndps_func_string = NULL;\r\nbreak;\r\n}\r\nif(ndps_hfname != 0)\r\n{\r\nproto_tree_add_item(ndps_tree, ndps_hfname, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nif (ndps_func_string != NULL)\r\n{\r\ncol_append_str(pinfo->cinfo, COL_INFO, (const gchar*) ndps_func_string);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_auth_null, tvb, foffset, 16, ENC_NA);\r\nfoffset+=16;\r\ndissect_ndps_request(tvb, pinfo, ndps_tree, ndps_prog, ndps_func, foffset);\r\n}\r\n}\r\n}\r\n}\r\n}\r\nstatic guint\r\nget_ndps_pdu_len(packet_info *pinfo _U_, tvbuff_t *tvb, int offset, void *data _U_)\r\n{\r\nreturn tvb_get_ntohs(tvb, offset +2) + 4;\r\n}\r\nstatic int\r\ndissect_ndps_pdu(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nproto_tree *ndps_tree;\r\nproto_item *ti;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "NDPS");\r\ncol_clear(pinfo->cinfo, COL_INFO);\r\nti = proto_tree_add_item(tree, proto_ndps, tvb, 0, -1, ENC_NA);\r\nndps_tree = proto_item_add_subtree(ti, ett_ndps);\r\ndissect_ndps(tvb, pinfo, ndps_tree);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic void\r\nndps_defrag(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, spx_info *spx_info_p)\r\n{\r\nguint len=0;\r\ntvbuff_t *next_tvb = NULL;\r\nfragment_head *fd_head;\r\nndps_req_hash_value *request_value = NULL;\r\nconversation_t *conversation;\r\nif (!ndps_defragment) {\r\ndissect_ndps(tvb, pinfo, tree);\r\nreturn;\r\n}\r\nif (!pinfo->fd->flags.visited)\r\n{\r\nconversation = find_conversation(pinfo->num, &pinfo->src, &pinfo->dst,\r\nPT_NCP, (guint32) pinfo->srcport, (guint32) pinfo->srcport, 0);\r\nif (conversation == NULL)\r\n{\r\nconversation = conversation_new(pinfo->num, &pinfo->src, &pinfo->dst,\r\nPT_NCP, (guint32) pinfo->srcport, (guint32) pinfo->srcport, 0);\r\n}\r\nrequest_value = ndps_hash_lookup(conversation, (guint32) pinfo->srcport);\r\nif (request_value == NULL)\r\n{\r\nrequest_value = ndps_hash_insert(conversation, (guint32) pinfo->srcport);\r\n}\r\np_add_proto_data(wmem_file_scope(), pinfo, proto_ndps, 0, (void*) request_value);\r\n}\r\nelse\r\n{\r\nrequest_value = (ndps_req_hash_value *)p_get_proto_data(wmem_file_scope(), pinfo, proto_ndps, 0);\r\n}\r\nif (!request_value)\r\n{\r\ndissect_ndps(tvb, pinfo, tree);\r\nreturn;\r\n}\r\nif (!spx_info_p->eom) {\r\nrequest_value->ndps_frag = TRUE;\r\n}\r\nif (request_value->ndps_frag || (request_value->ndps_end_frag == pinfo->num))\r\n{\r\ntid = (pinfo->srcport+pinfo->destport);\r\nlen = tvb_reported_length(tvb);\r\nif (tvb_captured_length(tvb) >= len)\r\n{\r\nfd_head = fragment_add_seq_next(&ndps_reassembly_table, tvb, 0, pinfo, tid, NULL, len, !spx_info_p->eom);\r\nif (fd_head != NULL)\r\n{\r\nif (fd_head->next != NULL && spx_info_p->eom)\r\n{\r\nproto_item *frag_tree_item;\r\nnext_tvb = tvb_new_chain(tvb, fd_head->tvb_data);\r\nadd_new_data_source(pinfo,\r\nnext_tvb,\r\n"Reassembled NDPS");\r\nif (tree)\r\n{\r\nshow_fragment_seq_tree(fd_head,\r\n&ndps_frag_items,\r\ntree, pinfo,\r\nnext_tvb, &frag_tree_item);\r\ntid++;\r\n}\r\nrequest_value->ndps_end_frag = pinfo->num;\r\n}\r\nelse\r\n{\r\nnext_tvb = tvb_new_subset_remaining(tvb, 0);\r\nif (!spx_info_p->eom)\r\n{\r\ncol_append_str(pinfo->cinfo, COL_INFO, "[NDPS Fragment]");\r\n}\r\n}\r\n}\r\nelse\r\n{\r\nif (!spx_info_p->eom)\r\n{\r\ncol_append_str(pinfo->cinfo, COL_INFO, "[NDPS Fragment]");\r\n}\r\nnext_tvb = NULL;\r\n}\r\n}\r\nelse\r\n{\r\nnext_tvb = tvb_new_subset_remaining(tvb, 0);\r\n}\r\nif (next_tvb == NULL)\r\n{\r\nnext_tvb = tvb_new_subset_remaining (tvb, 0);\r\ncall_data_dissector(next_tvb, pinfo, tree);\r\n}\r\nelse\r\n{\r\nif (spx_info_p->eom) {\r\nrequest_value->ndps_frag = FALSE;\r\ndissect_ndps(next_tvb, pinfo, tree);\r\n}\r\n}\r\n}\r\nelse\r\n{\r\nrequest_value->ndps_frag = FALSE;\r\ndissect_ndps(tvb, pinfo, tree);\r\n}\r\n}\r\nstatic int\r\ndissect_ndps_tcp(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data)\r\n{\r\ntcp_dissect_pdus(tvb, pinfo, tree, ndps_desegment, 4, get_ndps_pdu_len, dissect_ndps_pdu, data);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic int\r\ndissect_ndps_ipx(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data)\r\n{\r\nproto_tree *ndps_tree;\r\nproto_item *ti;\r\nif (data == NULL)\r\nreturn 0;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "NDPS");\r\ncol_clear(pinfo->cinfo, COL_INFO);\r\nti = proto_tree_add_item(tree, proto_ndps, tvb, 0, -1, ENC_NA);\r\nndps_tree = proto_item_add_subtree(ti, ett_ndps);\r\nndps_defrag(tvb, pinfo, ndps_tree, (spx_info*)data);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic int\r\ndissect_ndps_request(tvbuff_t *tvb, packet_info *pinfo, proto_tree *ndps_tree, guint32 ndps_prog, guint32 ndps_func, int foffset)\r\n{\r\nndps_req_hash_value *request_value = NULL;\r\nconversation_t *conversation;\r\nguint32 ii;\r\nguint32 jj;\r\nguint32 field_len;\r\nguint32 cred_type;\r\nguint32 resource_type;\r\nguint32 filter_type;\r\nguint32 print_type;\r\nguint32 length;\r\nguint32 number_of_items;\r\nguint32 number_of_items2;\r\nguint32 doc_content;\r\nguint32 list_attr_op;\r\nguint32 scope;\r\nguint32 job_type;\r\ngboolean supplier_flag;\r\ngboolean language_flag;\r\ngboolean method_flag;\r\ngboolean delivery_address_flag;\r\nguint32 profiles_type;\r\nguint32 profiles_choice_type;\r\nguint32 integer_type_flag;\r\nguint32 local_servers_type;\r\ngint length_remaining;\r\nproto_tree *atree, *btree, *ctree, *dtree;\r\nproto_item *aitem, *bitem, *citem, *ditem, *expert_item;\r\nif (!pinfo->fd->flags.visited)\r\n{\r\nconversation = find_conversation(pinfo->num, &pinfo->src, &pinfo->dst,\r\nPT_NCP, (guint32) pinfo->srcport, (guint32) pinfo->srcport, 0);\r\nif (conversation == NULL)\r\n{\r\nconversation = conversation_new(pinfo->num, &pinfo->src, &pinfo->dst,\r\nPT_NCP, (guint32) pinfo->srcport, (guint32) pinfo->srcport, 0);\r\n}\r\nrequest_value = ndps_hash_insert(conversation, (guint32) pinfo->srcport);\r\nrequest_value->ndps_prog = ndps_prog;\r\nrequest_value->ndps_func = ndps_func;\r\nrequest_value->ndps_frame_num = pinfo->num;\r\n}\r\nswitch(ndps_prog)\r\n{\r\ncase 0x060976:\r\nswitch(ndps_func)\r\n{\r\ncase 0x00000001:\r\nfoffset = credentials(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000002:\r\nfoffset = credentials(tvb, pinfo, ndps_tree, foffset);\r\nproto_tree_add_item(ndps_tree, hf_ndps_retrieve_restrictions, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nnumber_of_items=tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_bind_security_option_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Security %u", ii+1);\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nif (length==4)\r\n{\r\nproto_tree_add_uint(atree, hf_bind_security, tvb, foffset, 4, length);\r\n}\r\nfoffset += 4;\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nfoffset = qualifiedname(tvb, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000003:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset,\r\n4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x00000004:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nprint_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_print_arg, tvb, foffset, 4, print_type);\r\nfoffset += 4;\r\nswitch (print_type)\r\n{\r\ncase 0:\r\nfoffset = ndps_string(tvb, hf_ndps_pa_name, ndps_tree, foffset, NULL);\r\nproto_tree_add_item(ndps_tree, hf_sub_complete, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Transfer Method");\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_num_objects, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Attribute %u", ii+1);\r\nfoffset = objectidentifier(tvb, btree, foffset);\r\nnumber_of_items2 = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(btree, hf_ndps_num_attributes, tvb, foffset, 4, number_of_items2);\r\nfoffset += 4;\r\nfor (jj = 0; jj < number_of_items2; jj++ )\r\n{\r\nif (jj >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nctree = proto_tree_add_subtree_format(btree, tvb, foffset, -1, ett_ndps, &citem, "Value %u", jj+1);\r\nfoffset = attribute_value(tvb, pinfo, ctree, foffset);\r\nproto_item_set_end(citem, tvb, foffset);\r\n}\r\nproto_tree_add_item(btree, hf_ndps_qualifier, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Document Content");\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_num_objects, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Type %u", ii+1);\r\nfoffset = objectidentifier(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nfoffset += align_4(tvb, foffset);\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(atree, hf_ndps_num_objects, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\ndoc_content = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_doc_content, tvb, foffset, 4, doc_content);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Value %u", ii+1);\r\nif (doc_content==0)\r\n{\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(btree, hf_ndps_included_doc_len, tvb, foffset, 4, length);\r\nfoffset += 4;\r\nlength_remaining = tvb_reported_length_remaining(tvb, foffset);\r\nif (length_remaining == -1 || length > (guint32) length_remaining)\r\n{\r\nproto_tree_add_item(btree, hf_ndps_data, tvb, foffset, -1, ENC_NA);\r\nreturn foffset;\r\n}\r\nif (length==4)\r\n{\r\nproto_tree_add_item(btree, hf_ndps_included_doc, tvb, foffset, length, ENC_NA);\r\n}\r\nfoffset += length;\r\nfoffset += (length%2);\r\n}\r\nelse\r\n{\r\nfoffset = ndps_string(tvb, hf_ndps_ref_name, btree, foffset, NULL);\r\nfoffset = name_or_id(tvb, btree, foffset);\r\n}\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset += 4;\r\nif (align_4(tvb, foffset)>0) {\r\nfoffset += align_4(tvb, foffset);\r\n}\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Document Type");\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_num_objects, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Attribute %u", ii+1);\r\nfoffset = objectidentifier(tvb, btree, foffset);\r\nnumber_of_items2 = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(btree, hf_ndps_num_attributes, tvb, foffset, 4, number_of_items2);\r\nfoffset += 4;\r\nfor (jj = 0; jj < number_of_items2; jj++ )\r\n{\r\nif (jj >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nctree = proto_tree_add_subtree_format(btree, tvb, foffset, -1, ett_ndps, &citem, "Value %u", jj+1);\r\nfoffset = attribute_value(tvb, pinfo, ctree, foffset);\r\nproto_item_set_end(citem, tvb, foffset);\r\n}\r\nproto_tree_add_item(btree, hf_ndps_qualifier, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Document Attributes");\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_num_attributes, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Attribute %u", ii+1);\r\nfoffset = attribute_value(tvb, pinfo, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 1:\r\nfoffset = ndps_string(tvb, hf_ndps_pa_name, ndps_tree, foffset, NULL);\r\nproto_tree_add_item(ndps_tree, hf_local_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_sub_complete, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Transfer Method");\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_num_transfer_methods, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Method %u", ii+1);\r\nfoffset = objectidentifier(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_tree_add_item(ndps_tree, hf_doc_content, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Document Type");\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_num_doc_types, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Type %u", ii+1);\r\nfoffset = objectidentifier(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nfoffset += align_4(tvb, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Document Attributes");\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_num_attributes, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Attribute %u", ii+1);\r\nfoffset = attribute_value(tvb, pinfo, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nbreak;\r\ncase 2:\r\nfoffset = ndps_string(tvb, hf_ndps_pa_name, ndps_tree, foffset, NULL);\r\nproto_tree_add_item(ndps_tree, hf_local_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nbreak;\r\ncase 0x00000005:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = ndps_string(tvb, hf_ndps_pa_name, ndps_tree, foffset, NULL);\r\nproto_tree_add_item(ndps_tree, hf_local_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_document_number, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Job Modifications");\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_num_attributes, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Modification %u", ii+1);\r\nfoffset = attribute_value(tvb, pinfo, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Document Modifications");\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_num_attributes, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Modification %u", ii+1);\r\nfoffset = attribute_value(tvb, pinfo, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nbreak;\r\ncase 0x00000006:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = ndps_string(tvb, hf_ndps_pa_name, ndps_tree, foffset, NULL);\r\nproto_tree_add_item(ndps_tree, hf_local_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_document_number, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_item_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Cancel Message");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Retention Period");\r\nproto_tree_add_item(atree, hf_ndps_status_flags, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(atree, hf_ndps_attribute_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(aitem, tvb, foffset);\r\nbreak;\r\ncase 0x00000007:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nlist_attr_op = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_attrs_arg, tvb, foffset, 4, list_attr_op);\r\nfoffset += 4;\r\nif (list_attr_op==0)\r\n{\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_context_len, tvb, foffset, 4, length);\r\nfoffset += 4;\r\nif (length!=0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_context, tvb, foffset, length, ENC_NA);\r\n}\r\nfoffset += length;\r\nfoffset += (length%2);\r\nproto_tree_add_item(ndps_tree, hf_ndps_abort_flag, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_num_attributes, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Attribute %u", ii+1);\r\nfoffset = attribute_value(tvb, pinfo, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\n}\r\nelse\r\n{\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Object Class");\r\nfoffset = objectidentifier(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset += 4;\r\nfoffset += align_4(tvb, foffset);\r\nscope = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_scope, tvb, foffset, 4, scope);\r\nfoffset += 4;\r\nif (scope!=0)\r\n{\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Selector Option");\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_num_options, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Option %u", ii+1);\r\nfoffset = objectidentification(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset += align_4(tvb, foffset);\r\nfilter_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_filter, tvb, foffset, 4, filter_type);\r\nfoffset += 4;\r\n#if 0\r\nif (filter_type == 0 || filter_type == 3 )\r\n{\r\nfoffset = filteritem(tvb, ndps_tree, foffset);\r\n}\r\nelse\r\n{\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Filter Items");\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_item_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nfoffset = filteritem(tvb, ndps_tree, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\n#endif\r\nproto_tree_add_item(ndps_tree, hf_ndps_time_limit, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_count_limit, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Requested Attributes");\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_num_objects, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Attribute %u", ii+1);\r\nfoffset = objectidentifier(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nif (number_of_items == 0)\r\n{\r\nbreak;\r\n}\r\nproto_tree_add_item(ndps_tree, hf_ndps_operator, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = commonarguments(tvb, pinfo, ndps_tree, foffset);\r\n}\r\nbreak;\r\ncase 0x00000008:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Job ID");\r\nfoffset = ndps_string(tvb, hf_ndps_pa_name, atree, foffset, NULL);\r\nproto_tree_add_item(atree, hf_local_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Message Option");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = commonarguments(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000009:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\njob_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_interrupt_job_type, tvb, foffset, 4, job_type);\r\nfoffset += 4;\r\nif (job_type==0)\r\n{\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Job ID");\r\nfoffset = ndps_string(tvb, hf_ndps_pa_name, atree, foffset, NULL);\r\nproto_tree_add_item(atree, hf_local_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nelse\r\n{\r\nfoffset = ndps_string(tvb, hf_ndps_pa_name, ndps_tree, foffset, NULL);\r\n}\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Interrupt Message Option");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Interrupting Job");\r\nfoffset = ndps_string(tvb, hf_ndps_pa_name, atree, foffset, NULL);\r\nproto_tree_add_item(atree, hf_local_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = commonarguments(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x0000000a:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\njob_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_pause_job_type, tvb, foffset, 4, job_type);\r\nfoffset += 4;\r\nif (job_type==0)\r\n{\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Job ID");\r\nfoffset = ndps_string(tvb, hf_ndps_pa_name, atree, foffset, NULL);\r\nproto_tree_add_item(atree, hf_local_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nelse\r\n{\r\nfoffset = ndps_string(tvb, hf_ndps_pa_name, ndps_tree, foffset, NULL);\r\n}\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Pause Message Option");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = commonarguments(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x0000000b:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Job ID");\r\nfoffset = ndps_string(tvb, hf_ndps_pa_name, atree, foffset, NULL);\r\nproto_tree_add_item(atree, hf_local_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Resume Message Option");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = commonarguments(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x0000000c:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Clean Message Option");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = commonarguments(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x0000000d:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Object Class");\r\nfoffset = objectidentifier(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Object ID");\r\nfoffset = objectidentification(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nproto_tree_add_item(ndps_tree, hf_ndps_force, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Reference Object Option");\r\nfoffset = objectidentification(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Object Attribute");\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_num_attributes, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Attribute %u", ii+1);\r\nfoffset = attribute_value(tvb, pinfo, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = commonarguments(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x0000000e:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Object Class");\r\nfoffset = objectidentifier(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Object ID");\r\nfoffset = objectidentification(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = commonarguments(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x0000000f:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Disable PA Message Option");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = commonarguments(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000010:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Enable PA Message Option");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = commonarguments(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000011:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = qualifiedname(tvb, ndps_tree, foffset);\r\nfoffset = address_item(tvb, ndps_tree, foffset);\r\nproto_tree_add_item(ndps_tree, hf_resubmit_op_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Resubmit Job");\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_item_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, -1, ett_ndps, &bitem, "Job ID");\r\nfoffset = ndps_string(tvb, hf_ndps_pa_name, btree, foffset, NULL);\r\nproto_tree_add_item(btree, hf_local_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(bitem, tvb, foffset);\r\nproto_tree_add_item(atree, hf_ndps_document_number, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, -1, ett_ndps, &bitem, "Job Attributes");\r\nnumber_of_items2 = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(btree, hf_ndps_num_attributes, tvb, foffset, 4, number_of_items2);\r\nfoffset += 4;\r\nfor (jj = 0; jj < number_of_items2; jj++ )\r\n{\r\nif (jj >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nctree = proto_tree_add_subtree_format(btree, tvb, foffset, -1, ett_ndps, &citem, "Attribute %u", jj+1);\r\nfoffset = attribute_value(tvb, pinfo, ctree, foffset);\r\nproto_item_set_end(citem, tvb, foffset);\r\n}\r\nproto_item_set_end(bitem, tvb, foffset);\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, -1, ett_ndps, &bitem, "Document Attributes");\r\nnumber_of_items2 = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(btree, hf_ndps_num_attributes, tvb, foffset, 4, number_of_items2);\r\nfoffset += 4;\r\nfor (jj = 0; jj < number_of_items2; jj++ )\r\n{\r\nif (jj >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nctree = proto_tree_add_subtree_format(btree, tvb, foffset, -1, ett_ndps, &citem, "Attribute %u", jj+1);\r\nfoffset = attribute_value(tvb, pinfo, ctree, foffset);\r\nproto_item_set_end(citem, tvb, foffset);\r\n}\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Resubmit Message Option");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = commonarguments(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000012:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Object Class");\r\nfoffset = objectidentifier(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Object ID");\r\nfoffset = objectidentification(tvb, atree, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Attribute Modifications");\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_num_attributes, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Modification `%d", ii+1);\r\nfoffset = attribute_value(tvb, pinfo, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = commonarguments(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000013:\r\ncase 0x0000001e:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_shutdown_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = ndps_string(tvb, hf_ndps_pa_name, ndps_tree, foffset, NULL);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Shutdown Message Option");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = commonarguments(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000014:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = ndps_string(tvb, hf_ndps_pa_name, ndps_tree, foffset, NULL);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Startup Message Option");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = commonarguments(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000015:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Job Identification");\r\nfoffset = ndps_string(tvb, hf_ndps_pa_name, atree, foffset, NULL);\r\nproto_tree_add_item(atree, hf_local_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Reference Job ID");\r\nfoffset = ndps_string(tvb, hf_ndps_pa_name, atree, foffset, NULL);\r\nproto_tree_add_item(atree, hf_local_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = commonarguments(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000016:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Pause Message Option");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = commonarguments(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000017:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Resume Message Option");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = commonarguments(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000018:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_get_status_flag, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_data, tvb, foffset+4, tvb_get_ntohl(tvb, foffset), ENC_NA);\r\nbreak;\r\ncase 0x00000019:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Operation ID");\r\nfoffset = objectidentifier(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = commonarguments(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x0000001a:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_profile_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_persistence, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = qualifiedname(tvb, ndps_tree, foffset);\r\nfoffset = ndps_string(tvb, hf_ndps_supplier_name, ndps_tree, foffset, NULL);\r\nproto_tree_add_item(ndps_tree, hf_ndps_language_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Method ID");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nfoffset += align_4(tvb, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Delivery Address");\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_delivery_add_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Address %u", ii+1);\r\nfoffset = address_item(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = event_object_set(tvb, pinfo, ndps_tree, foffset);\r\nfoffset = qualifiedname(tvb, ndps_tree, foffset);\r\nbreak;\r\ncase 0x0000001b:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_profile_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 0x0000001c:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_profile_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item_ret_uint(ndps_tree, hf_ndps_supplier_flag, tvb, foffset, 4, ENC_BIG_ENDIAN, &supplier_flag);\r\nfoffset += 4;\r\nif (supplier_flag)\r\n{\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Supplier ID");\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length==4)\r\n{\r\nproto_tree_add_item(atree, hf_ndps_attribute_value, tvb, foffset, length, ENC_BIG_ENDIAN);\r\n}\r\ntvb_ensure_bytes_exist(tvb, foffset, length);\r\nfoffset += length;\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nproto_tree_add_item_ret_uint(ndps_tree, hf_ndps_language_flag, tvb, foffset, 4, ENC_BIG_ENDIAN, &language_flag);\r\nfoffset += 4;\r\nif (language_flag)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_language_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\nproto_tree_add_item_ret_uint(ndps_tree, hf_ndps_method_flag, tvb, foffset, 4, ENC_BIG_ENDIAN, &method_flag);\r\nfoffset += 4;\r\nif (method_flag)\r\n{\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Method ID");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nproto_tree_add_item_ret_uint(ndps_tree, hf_ndps_delivery_address_flag, tvb, foffset, 4, ENC_BIG_ENDIAN, &delivery_address_flag);\r\nfoffset += 4;\r\nif (delivery_address_flag)\r\n{\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Delivery Address");\r\nfoffset = print_address(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nfoffset = event_object_set(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x0000001d:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nprofiles_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_list_profiles_type, tvb, foffset, 4, profiles_type);\r\nfoffset += 4;\r\nif (profiles_type==0)\r\n{\r\nfoffset = qualifiedname(tvb, ndps_tree, foffset);\r\nprofiles_choice_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_list_profiles_choice_type, tvb, foffset, 4, profiles_choice_type);\r\nfoffset += 4;\r\nif (profiles_choice_type==0)\r\n{\r\nfoffset = cardinal_seq(tvb, pinfo, ndps_tree, foffset);\r\n}\r\nelse\r\n{\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Consumer");\r\nfoffset = qualifiedname(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Method ID");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_tree_add_item(atree, hf_ndps_language_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nproto_tree_add_item(ndps_tree, hf_ndps_list_profiles_result_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\ninteger_type_flag = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_integer_type_flag, tvb, foffset, 4, integer_type_flag);\r\nfoffset += 4;\r\nif (integer_type_flag!=0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_integer_type_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\n}\r\nelse\r\n{\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_context_len, tvb, foffset, 4, length);\r\nfoffset += 4;\r\nif (length!=0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_context, tvb, foffset, length, ENC_NA);\r\n}\r\nfoffset += length;\r\nfoffset += (length%2);\r\nproto_tree_add_item(ndps_tree, hf_ndps_abort_flag, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\nbreak;\r\ncase 0x0000001f:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Cancel Shutdown Message Option");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = commonarguments(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000020:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_ds_info_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = ndps_string(tvb, hf_ndps_printer_name, ndps_tree, foffset, NULL);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "DS Object Name");\r\nfoffset = qualifiedname(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nbreak;\r\ncase 0x00000021:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Clean Message Option");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = commonarguments(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000022:\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length!=0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_guid, tvb, foffset, length, ENC_NA);\r\n}\r\nfoffset += length;\r\nbreak;\r\ncase 0x00000023:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_profile_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_persistence, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Consumer Name");\r\nfoffset = qualifiedname(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = ndps_string(tvb, hf_ndps_supplier_name, ndps_tree, foffset, NULL);\r\nproto_tree_add_item(ndps_tree, hf_ndps_language_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Method ID");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nfoffset += align_4(tvb, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Delivery Address");\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_delivery_add_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Address %u", ii+1);\r\nfoffset = address_item(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = event_object_set(tvb, pinfo, ndps_tree, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Account");\r\nfoffset = qualifiedname(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Notify Attributes");\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_num_attributes, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Attribute %u", ii+1);\r\nfoffset = objectidentifier(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nproto_tree_add_item(ndps_tree, hf_notify_time_interval, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_notify_sequence_number, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_notify_lease_exp_time, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = ndps_string(tvb, hf_notify_printer_uri, ndps_tree, foffset, NULL);\r\nbreak;\r\ncase 0x00000024:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nprofiles_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_list_profiles_type, tvb, foffset, 4, profiles_type);\r\nfoffset += 4;\r\nif (profiles_type==0)\r\n{\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Supplier Alias");\r\nfoffset = qualifiedname(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nprofiles_choice_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_list_profiles_choice_type, tvb, foffset, 4, profiles_choice_type);\r\nfoffset += 4;\r\nif (profiles_choice_type==0)\r\n{\r\nfoffset = cardinal_seq(tvb, pinfo, ndps_tree, foffset);\r\n}\r\nelse\r\n{\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Consumer");\r\nfoffset = qualifiedname(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Method ID");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nproto_tree_add_item(ndps_tree, hf_ndps_language_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\nproto_tree_add_item(ndps_tree, hf_ndps_list_profiles_result_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\ninteger_type_flag = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_integer_type_flag, tvb, foffset, 4, integer_type_flag);\r\nfoffset += 4;\r\nif (integer_type_flag!=0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_integer_type_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\n}\r\nelse\r\n{\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_context_len, tvb, foffset, 4, length);\r\nfoffset += 4;\r\nif (length!=0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_context, tvb, foffset, length, ENC_NA);\r\n}\r\nfoffset += length;\r\nfoffset += (length%2);\r\nproto_tree_add_item(ndps_tree, hf_ndps_abort_flag, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nbreak;\r\ncase 0x060977:\r\nswitch(ndps_func)\r\n{\r\ncase 0x00000001:\r\nfoffset = credentials(tvb, pinfo, ndps_tree, foffset);\r\nproto_tree_add_item(ndps_tree, hf_ndps_retrieve_restrictions, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nnumber_of_items=tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_bind_security_option_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Security %u", ii+1);\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length==4)\r\n{\r\nproto_tree_add_item(atree, hf_bind_security, tvb, foffset, length, ENC_BIG_ENDIAN);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 0x00000002:\r\nbreak;\r\ncase 0x00000003:\r\nproto_tree_add_item(ndps_tree, hf_ndps_list_services_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 0x00000004:\r\nproto_tree_add_item(ndps_tree, hf_ndps_service_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Parameters");\r\nnumber_of_items=tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_item_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length!=0)\r\n{\r\nproto_tree_add_item(atree, hf_ndps_item_bytes, tvb, foffset, length, ENC_NA);\r\n}\r\nfoffset += length;\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nbreak;\r\ncase 0x00000005:\r\nproto_tree_add_item(ndps_tree, hf_ndps_list_services_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 0x00000006:\r\ncase 0x00000007:\r\ncase 0x00000008:\r\ndefault:\r\nbreak;\r\n}\r\nbreak;\r\ncase 0x060978:\r\nswitch(ndps_func)\r\n{\r\ncase 0x00000001:\r\nfoffset = credentials(tvb, pinfo, ndps_tree, foffset);\r\nproto_tree_add_item(ndps_tree, hf_ndps_retrieve_restrictions, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nnumber_of_items=tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_bind_security_option_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Security %d", ii+1);\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length==4)\r\n{\r\nproto_tree_add_item(atree, hf_bind_security, tvb, foffset, length, ENC_BIG_ENDIAN);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 0x00000002:\r\nbreak;\r\ncase 0x00000003:\r\nfoffset = server_entry(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000004:\r\ncase 0x00000006:\r\ncase 0x0000000b:\r\ncase 0x0000000c:\r\nbreak;\r\ncase 0x00000005:\r\nfoffset = ndps_string(tvb, hf_ndps_registry_name, ndps_tree, foffset, NULL);\r\nfoffset = print_address(tvb, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000007:\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Add");\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_item_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Entry %u", ii+1);\r\nfoffset = server_entry(tvb, pinfo, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Remove");\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_item_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Entry %u", ii+1);\r\nfoffset = server_entry(tvb, pinfo, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nbreak;\r\ncase 0x00000008:\r\ncase 0x00000009:\r\ncase 0x0000000a:\r\nlocal_servers_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_list_local_servers_type, tvb, foffset, 4, local_servers_type);\r\nfoffset += 4;\r\nif (local_servers_type==0)\r\n{\r\ninteger_type_flag = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_integer_type_flag, tvb, foffset, 4, integer_type_flag);\r\nfoffset += 4;\r\nif (integer_type_flag!=0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_integer_type_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\n}\r\nelse\r\n{\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_context_len, tvb, foffset, 4, length);\r\nfoffset += 4;\r\nif (length!=0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_context, tvb, foffset, length, ENC_NA);\r\n}\r\nfoffset += length;\r\nfoffset += (length%2);\r\nproto_tree_add_item(ndps_tree, hf_ndps_abort_flag, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nbreak;\r\ncase 0x060979:\r\nswitch(ndps_func)\r\n{\r\ncase 0x00000001:\r\nfoffset = credentials(tvb, pinfo, ndps_tree, foffset);\r\nproto_tree_add_item(ndps_tree, hf_ndps_retrieve_restrictions, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nnumber_of_items=tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_item_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Security %d", ii+1);\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length==4)\r\n{\r\nproto_tree_add_item(atree, hf_bind_security, tvb, foffset, length, ENC_BIG_ENDIAN);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 0x00000002:\r\ncase 0x0000000a:\r\ncase 0x00000010:\r\ncase 0x00000011:\r\nbreak;\r\ncase 0x00000003:\r\nfoffset = ndps_string(tvb, hf_ndps_supplier_name, ndps_tree, foffset, NULL);\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_item_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Supplier Alias %u", ii+1);\r\nfoffset = qualifiedname(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 0x00000004:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 0x00000005:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Supplier Alias");\r\nfoffset = qualifiedname(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nproto_tree_add_item(ndps_tree, hf_ndps_profile_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_persistence, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Consumer Name");\r\nfoffset = qualifiedname(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length==4)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_value, tvb, foffset, length, ENC_BIG_ENDIAN);\r\n}\r\nfoffset += length;\r\nproto_tree_add_item(ndps_tree, hf_ndps_language_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Method ID");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_delivery_add_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Delivery Addresses");\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, aitem, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Address %d", ii+1);\r\nfoffset = address_item(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = event_object_set(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000006:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_profile_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 0x00000007:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_profile_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item_ret_uint(ndps_tree, hf_ndps_supplier_flag, tvb, foffset, 4, ENC_BIG_ENDIAN, &supplier_flag);\r\nfoffset += 4;\r\nif (supplier_flag)\r\n{\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Supplier ID");\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length==4)\r\n{\r\nproto_tree_add_item(atree, hf_ndps_attribute_value, tvb, foffset, length, ENC_BIG_ENDIAN);\r\n}\r\ntvb_ensure_bytes_exist(tvb, foffset, length);\r\nfoffset += length;\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nproto_tree_add_item_ret_uint(ndps_tree, hf_ndps_language_flag, tvb, foffset, 4, ENC_BIG_ENDIAN, &language_flag);\r\nfoffset += 4;\r\nif (language_flag)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_language_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\nproto_tree_add_item_ret_uint(ndps_tree, hf_ndps_method_flag, tvb, foffset, 4, ENC_BIG_ENDIAN, &method_flag);\r\nfoffset += 4;\r\nif (method_flag)\r\n{\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Method ID");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nproto_tree_add_item_ret_uint(ndps_tree, hf_ndps_delivery_address_flag, tvb, foffset, 4, ENC_BIG_ENDIAN, &delivery_address_flag);\r\nfoffset += 4;\r\nif (delivery_address_flag)\r\n{\r\nfoffset = print_address(tvb, ndps_tree, foffset);\r\n}\r\nfoffset = event_object_set(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000008:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nprofiles_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_list_profiles_type, tvb, foffset, 4, profiles_type);\r\nfoffset += 4;\r\nif (profiles_type==0)\r\n{\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Supplier Alias");\r\nfoffset = qualifiedname(tvb, atree, foffset);\r\nprofiles_choice_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(atree, hf_ndps_list_profiles_choice_type, tvb, foffset, 4, profiles_choice_type);\r\nfoffset += 4;\r\nproto_item_set_end(aitem, tvb, foffset);\r\nif (profiles_choice_type==0)\r\n{\r\nfoffset = cardinal_seq(tvb, pinfo, ndps_tree, foffset);\r\n}\r\nelse\r\n{\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Consumer");\r\nfoffset = qualifiedname(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Method ID");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_tree_add_item(atree, hf_ndps_language_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nproto_tree_add_item(ndps_tree, hf_ndps_list_profiles_result_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\ninteger_type_flag = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_integer_type_flag, tvb, foffset, 4, integer_type_flag);\r\nfoffset += 4;\r\nif (integer_type_flag!=0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_integer_type_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\n}\r\nelse\r\n{\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_context_len, tvb, foffset, 4, length);\r\nfoffset += 4;\r\nif (length!=0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_context, tvb, foffset, length, ENC_NA);\r\n}\r\nfoffset += length;\r\nfoffset += (length%2);\r\nproto_tree_add_item(ndps_tree, hf_ndps_abort_flag, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\nbreak;\r\ncase 0x00000009:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_item_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Event Items");\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, aitem, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Item %d", ii+1);\r\nproto_tree_add_item(btree, hf_ndps_event_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nctree = proto_tree_add_subtree(btree, tvb, foffset, -1, ett_ndps, &citem, "Containing Class");\r\nfoffset = objectidentifier(tvb, ctree, foffset);\r\nproto_item_set_end(citem, tvb, foffset);\r\nctree = proto_tree_add_subtree(btree, tvb, foffset, -1, ett_ndps, &citem, "Containing Object");\r\nfoffset = objectidentification(tvb, ctree, foffset);\r\nproto_item_set_end(citem, tvb, foffset);\r\nctree = proto_tree_add_subtree(btree, tvb, foffset, -1, ett_ndps, &citem, "Filter Class");\r\nfoffset = objectidentifier(tvb, ctree, foffset);\r\nctree = proto_tree_add_subtree(btree, tvb, foffset, -1, ett_ndps, &citem, "Object Class");\r\nfoffset = objectidentifier(tvb, ctree, foffset);\r\nproto_item_set_end(citem, tvb, foffset);\r\nctree = proto_tree_add_subtree(btree, tvb, foffset, -1, ett_ndps, &citem, "Object ID");\r\nfoffset = objectidentification(tvb, ctree, foffset);\r\nproto_item_set_end(citem, tvb, foffset);\r\nctree = proto_tree_add_subtree(btree, tvb, foffset, -1, ett_ndps, &citem, "Event Object ID");\r\nfoffset = objectidentifier(tvb, ctree, foffset);\r\nproto_item_set_end(citem, tvb, foffset);\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(btree, hf_ndps_num_attributes, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nctree = proto_tree_add_subtree(btree, tvb, foffset, -1, ett_ndps, &citem, "Attribute Modifications");\r\nfor (jj = 0; jj < number_of_items; jj++ )\r\n{\r\nif (jj >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, citem, &ei_ndps_truncated);\r\nbreak;\r\n}\r\ndtree = proto_tree_add_subtree_format(ctree, tvb, foffset, -1, ett_ndps, &ditem, "Modification %d", jj+1);\r\nfoffset = attribute_value(tvb, pinfo, dtree, foffset);\r\nproto_item_set_end(ditem, tvb, foffset);\r\n}\r\nproto_item_set_end(citem, tvb, foffset);\r\nfoffset = ndps_string(tvb, hf_ndps_message, btree, foffset, NULL);\r\nproto_tree_add_item(btree, hf_time, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nbreak;\r\ncase 0x0000000b:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_num_destinations, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Destination %d", ii+1);\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, -1, ett_ndps, &bitem, "Method ID");\r\nfoffset = name_or_id(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\nproto_tree_add_item(atree, hf_address_len, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = print_address(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nfoffset = ndps_string(tvb, hf_ndps_supplier_name, ndps_tree, foffset, NULL);\r\nproto_tree_add_item(ndps_tree, hf_ndps_event_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Containing Class");\r\nfoffset = objectidentifier(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Containing Object");\r\nfoffset = objectidentification(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Filter Class");\r\nfoffset = objectidentifier(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Object Class");\r\nfoffset = objectidentifier(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Object ID");\r\nfoffset = objectidentification(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Event Object ID");\r\nfoffset = objectidentifier(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_num_attributes, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Attributes");\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, aitem, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Attribute %d", ii+1);\r\nfoffset = attribute_value(tvb, pinfo, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = ndps_string(tvb, hf_ndps_message, ndps_tree, foffset, NULL);\r\nproto_tree_add_item(ndps_tree, hf_time, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Account");\r\nfoffset = qualifiedname(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nbreak;\r\ncase 0x0000000c:\r\nfoffset = ndps_string(tvb, hf_ndps_file_name, ndps_tree, foffset, NULL);\r\nbreak;\r\ncase 0x0000000d:\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Method ID");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nbreak;\r\ncase 0x0000000e:\r\ncred_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_item(ndps_tree, hf_delivery_method_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nswitch (cred_type)\r\n{\r\ncase 0:\r\ninteger_type_flag = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_integer_type_flag, tvb, foffset, 4, integer_type_flag);\r\nfoffset += 4;\r\nif (integer_type_flag!=0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_integer_type_value, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\nproto_tree_add_item(ndps_tree, hf_ndps_language_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 1:\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_context_len, tvb, foffset, 4, length);\r\nfoffset += 4;\r\nif (length!=0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_context, tvb, foffset, length, ENC_NA);\r\n}\r\nfoffset += length;\r\nfoffset += (length%2);\r\nproto_tree_add_item(ndps_tree, hf_ndps_abort_flag, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nbreak;\r\ncase 0x0000000f:\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Method ID");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nproto_tree_add_item(ndps_tree, hf_ndps_language_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nbreak;\r\ncase 0x06097a:\r\nswitch(ndps_func)\r\n{\r\ncase 0x00000001:\r\nfoffset = credentials(tvb, pinfo, ndps_tree, foffset);\r\nproto_tree_add_item(ndps_tree, hf_ndps_retrieve_restrictions, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nnumber_of_items=tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_bind_security_option_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Security %d", ii+1);\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length==4)\r\n{\r\nproto_tree_add_item(atree, hf_bind_security, tvb, foffset, length, ENC_BIG_ENDIAN);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 0x00000002:\r\ncase 0x00000008:\r\ncase 0x00000009:\r\nbreak;\r\ncase 0x00000003:\r\nproto_tree_add_item(ndps_tree, hf_packet_count, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_last_packet_flag, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_file_timestamp, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = res_add_input_data(tvb, ndps_tree, foffset);\r\nnumber_of_items=tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_item_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Item %d", ii+1);\r\nlength=tvb_get_ntohl(tvb, foffset);\r\nlength_remaining = tvb_reported_length_remaining(tvb, foffset);\r\nif(length_remaining == -1 || (guint32) length_remaining < length)\r\n{\r\nreturn foffset;\r\n}\r\nproto_tree_add_item(atree, hf_ndps_item_ptr, tvb, foffset, length, ENC_NA);\r\nfoffset += length;\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 0x00000004:\r\nfoffset = res_add_input_data(tvb, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000005:\r\nproto_tree_add_item(ndps_tree, hf_ndps_max_items, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_status_flags, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_resource_list_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nresource_type = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nswitch (resource_type)\r\n{\r\ncase 0:\r\nproto_tree_add_item(ndps_tree, hf_os_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 1:\r\ncase 2:\r\nfoffset = ndps_string(tvb, hf_ndps_vendor_dir, ndps_tree, foffset, NULL);\r\nbreak;\r\ncase 3:\r\nproto_tree_add_item(ndps_tree, hf_banner_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 4:\r\nproto_tree_add_item(ndps_tree, hf_font_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_os_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 5:\r\ncase 12:\r\ncase 9:\r\nproto_tree_add_item(ndps_tree, hf_os_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = ndps_string(tvb, hf_ndps_printer_type, ndps_tree, foffset, NULL);\r\nfoffset = ndps_string(tvb, hf_ndps_printer_manuf, ndps_tree, foffset, NULL);\r\nfoffset = ndps_string(tvb, hf_ndps_inf_file_name, ndps_tree, foffset, NULL);\r\nfield_len = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_printer_id, tvb, foffset, field_len, ENC_NA);\r\nbreak;\r\ncase 6:\r\ncase 10:\r\nfoffset = ndps_string(tvb, hf_ndps_vendor_dir, ndps_tree, foffset, NULL);\r\nfoffset += 4;\r\nfoffset = ndps_string(tvb, hf_ndps_printer_type, ndps_tree, foffset, NULL);\r\nfoffset = ndps_string(tvb, hf_ndps_printer_manuf, ndps_tree, foffset, NULL);\r\nfoffset = ndps_string(tvb, hf_ndps_inf_file_name, ndps_tree, foffset, NULL);\r\nfield_len = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_printer_id, tvb, foffset, field_len, ENC_NA);\r\nbreak;\r\ncase 7:\r\nproto_tree_add_item(ndps_tree, hf_os_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_font_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = ndps_string(tvb, hf_ndps_font_name, ndps_tree, foffset, NULL);\r\nbreak;\r\ncase 8:\r\ncase 11:\r\ncase 13:\r\nfoffset = ndps_string(tvb, hf_ndps_printer_manuf, ndps_tree, foffset, NULL);\r\nfoffset = ndps_string(tvb, hf_ndps_printer_type, ndps_tree, foffset, NULL);\r\nfoffset = ndps_string(tvb, hf_ndps_inf_file_name, ndps_tree, foffset, NULL);\r\nbreak;\r\ncase 14:\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nbreak;\r\ncase 0x00000006:\r\nproto_tree_add_item(ndps_tree, hf_get_status_flag, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_res_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nresource_type = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nswitch (resource_type)\r\n{\r\ncase 0:\r\nproto_tree_add_item(ndps_tree, hf_os_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = ndps_string(tvb, hf_ndps_prn_dir_name, ndps_tree, foffset, NULL);\r\nfoffset = ndps_string(tvb, hf_ndps_prn_file_name, ndps_tree, foffset, NULL);\r\nbreak;\r\ncase 1:\r\nfoffset = ndps_string(tvb, hf_ndps_vendor_dir, ndps_tree, foffset, NULL);\r\nfoffset = ndps_string(tvb, hf_ndps_prn_file_name, ndps_tree, foffset, NULL);\r\nbreak;\r\ncase 2:\r\nfoffset = ndps_string(tvb, hf_ndps_banner_name, ndps_tree, foffset, NULL);\r\nbreak;\r\ncase 3:\r\nproto_tree_add_item(ndps_tree, hf_os_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_font_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = ndps_string(tvb, hf_ndps_prn_file_name, ndps_tree, foffset, NULL);\r\nbreak;\r\ncase 4:\r\ncase 5:\r\nproto_tree_add_item(ndps_tree, hf_os_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = ndps_string(tvb, hf_ndps_prn_dir_name, ndps_tree, foffset, NULL);\r\nproto_tree_add_item(ndps_tree, hf_archive_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nbreak;\r\ncase 0x00000007:\r\nproto_tree_add_item(ndps_tree, hf_ndps_status_flags, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = res_add_input_data(tvb, ndps_tree, foffset);\r\nbreak;\r\ncase 0x0000000a:\r\nproto_tree_add_item(ndps_tree, hf_ndps_language_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nbreak;\r\ncase 0x06097b:\r\nswitch(ndps_func)\r\n{\r\ncase 0x00000001:\r\nfoffset = credentials(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000002:\r\nbreak;\r\ncase 0x00000003:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_item_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Item %d", ii+1);\r\nproto_tree_add_item(atree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, -1, ett_ndps, &bitem, "Supplier ID");\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length==4)\r\n{\r\nproto_tree_add_item(btree, hf_ndps_attribute_value, tvb, foffset, length, ENC_BIG_ENDIAN);\r\n}\r\nfoffset += length;\r\nproto_tree_add_item(btree, hf_ndps_event_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(bitem, tvb, foffset);\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, -1, ett_ndps, &bitem, "Containing Class");\r\nfoffset = objectidentifier(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, -1, ett_ndps, &bitem, "Containing Object");\r\nfoffset = objectidentification(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, -1, ett_ndps, &bitem, "Filter Class");\r\nfoffset = objectidentifier(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, -1, ett_ndps, &bitem, "Object Class");\r\nfoffset = objectidentifier(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, -1, ett_ndps, &bitem, "Object ID");\r\nfoffset = objectidentification(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, -1, ett_ndps, &bitem, "Event Object ID");\r\nfoffset = objectidentifier(tvb, btree, foffset);\r\nfoffset = attribute_value(tvb, pinfo, atree, foffset);\r\nfoffset = ndps_string(tvb, hf_ndps_message, atree, foffset, NULL);\r\nproto_tree_add_item(atree, hf_time, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(bitem, tvb, foffset);\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, -1, ett_ndps, &bitem, "Account");\r\nfoffset = qualifiedname(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 0x00000004:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_num_objects, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Object %d", ii+1);\r\nproto_tree_add_item(atree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, -1, ett_ndps, &bitem, "Supplier ID");\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length==4)\r\n{\r\nproto_tree_add_item(btree, hf_ndps_attribute_value, tvb, foffset, length, ENC_BIG_ENDIAN);\r\n}\r\nfoffset += length;\r\nproto_tree_add_item(atree, hf_ndps_event_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(bitem, tvb, foffset);\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, -1, ett_ndps, &bitem, "Containing Class");\r\nfoffset = objectidentifier(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, -1, ett_ndps, &bitem, "Containing Object");\r\nfoffset = objectidentification(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, -1, ett_ndps, &bitem, "Filter Class");\r\nfoffset = objectidentifier(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, -1, ett_ndps, &bitem, "Object Class");\r\nfoffset = objectidentifier(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, -1, ett_ndps, &bitem, "Object ID");\r\nfoffset = objectidentification(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, -1, ett_ndps, &bitem, "Event Object ID");\r\nfoffset = objectidentifier(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\nnumber_of_items2 = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(atree, hf_ndps_num_attributes, tvb, foffset, 4, number_of_items2);\r\nfoffset += 4;\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, -1, ett_ndps, &bitem, "Attribute");\r\nfor (jj = 0; jj < number_of_items2; jj++ )\r\n{\r\nif (jj >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, bitem, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nfoffset = attribute_value(tvb, pinfo, btree, foffset);\r\n}\r\nproto_item_set_end(bitem, tvb, foffset);\r\nfoffset = ndps_string(tvb, hf_ndps_message, atree, foffset, NULL);\r\nproto_tree_add_item(atree, hf_time, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, -1, ett_ndps, &bitem, "Account");\r\nfoffset = qualifiedname(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nreturn foffset;\r\n}\r\nstatic int\r\nndps_error(tvbuff_t *tvb, packet_info *pinfo, proto_tree *ndps_tree, int foffset)\r\n{\r\nguint32 number_of_items;\r\nguint32 ndps_problem_type;\r\nguint32 problem_type;\r\nguint32 ii;\r\nproto_tree *atree;\r\nproto_item *aitem;\r\nproto_tree *btree;\r\nproto_item *bitem;\r\nproto_item *expert_item;\r\nndps_problem_type = tvb_get_ntohl(tvb, foffset);\r\ncol_set_str(pinfo->cinfo, COL_INFO, "R NDPS - Error");\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_problem_type, tvb, foffset, 4, ndps_problem_type);\r\nexpert_add_info_format(pinfo, expert_item, &ei_ndps_problem_type, "Fault: %s", val_to_str(ndps_problem_type, error_type_enum, "Unknown NDPS Error (0x%08x)"));\r\nfoffset += 4;\r\nswitch(ndps_problem_type)\r\n{\r\ncase 0:\r\nproblem_type = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_problem_type, tvb, foffset, 4, problem_type);\r\nfoffset += 4;\r\nif (problem_type==0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_security_problem_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\nelse\r\n{\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Extended Error");\r\nfoffset = objectidentifier(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Message");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nbreak;\r\ncase 1:\r\nproto_tree_add_item(ndps_tree, hf_problem_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nif (tvb_get_ntohl(tvb, foffset-4)==0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_service_problem_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\nelse\r\n{\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Extended Error");\r\nfoffset = objectidentifier(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nfoffset = objectidentification(tvb, ndps_tree, foffset);\r\nfoffset = attribute_value(tvb, pinfo, ndps_tree, foffset);\r\nproto_tree_add_item(ndps_tree, hf_ndps_lib_error, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_other_error, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_other_error_2, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nif (tvb_reported_length_remaining(tvb, foffset) >= 4) {\r\nfoffset = ndps_string(tvb, hf_ndps_other_error_string, ndps_tree, foffset, NULL);\r\n}\r\nbreak;\r\ncase 2:\r\nproto_tree_add_item(ndps_tree, hf_problem_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nif (tvb_get_ntohl(tvb, foffset-4)==0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_access_problem_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\nelse\r\n{\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Extended Error");\r\nfoffset = objectidentifier(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nfoffset = objectidentification(tvb, ndps_tree, foffset);\r\nbreak;\r\ncase 3:\r\nproto_tree_add_item(ndps_tree, hf_problem_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nif (tvb_get_ntohl(tvb, foffset-4)==0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_printer_problem_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\nelse\r\n{\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Extended Error");\r\nfoffset = objectidentifier(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nfoffset = objectidentification(tvb, ndps_tree, foffset);\r\nbreak;\r\ncase 4:\r\nproto_tree_add_item(ndps_tree, hf_problem_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nif (tvb_get_ntohl(tvb, foffset-4)==0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_selection_problem_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\nelse\r\n{\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Extended Error");\r\nfoffset = objectidentifier(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nfoffset = objectidentification(tvb, ndps_tree, foffset);\r\nfoffset = attribute_value(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 5:\r\nproto_tree_add_item(ndps_tree, hf_problem_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nif (tvb_get_ntohl(tvb, foffset-4)==0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_doc_access_problem_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset = objectidentifier(tvb, ndps_tree, foffset);\r\n}\r\nelse\r\n{\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Extended Error");\r\nfoffset = objectidentifier(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nfoffset = objectidentification(tvb, ndps_tree, foffset);\r\nbreak;\r\ncase 6:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_num_attributes, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Item %d", ii+1);\r\nproto_tree_add_item(atree, hf_problem_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nif (tvb_get_ntohl(tvb, foffset-4)==0)\r\n{\r\nproto_tree_add_item(atree, hf_attribute_problem_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\nelse\r\n{\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, -1, ett_ndps, &bitem, "Extended Error");\r\nfoffset = objectidentifier(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nfoffset = attribute_value(tvb, pinfo, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 7:\r\nproto_tree_add_item(ndps_tree, hf_problem_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nif (tvb_get_ntohl(tvb, foffset-4)==0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_update_problem_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\nelse\r\n{\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Extended Error");\r\nfoffset = objectidentifier(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nfoffset = objectidentification(tvb, ndps_tree, foffset);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nreturn foffset;\r\n}\r\nstatic int\r\nreturn_code(tvbuff_t *tvb, packet_info *pinfo, proto_tree *ndps_tree, int foffset)\r\n{\r\nguint32 expert_status;\r\nproto_item *expert_item;\r\nexpert_status = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_item(ndps_tree, hf_ndps_return_code, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nif (expert_status != 0) {\r\nexpert_add_info_format(pinfo, expert_item, &ei_ndps_return_code, "Fault: %s",\r\nval_to_str_ext(expert_status, &ndps_error_types_ext, "Unknown NDPS Error (0x%08x)"));\r\n}\r\nfoffset += 4;\r\nif (tvb_get_ntohl(tvb, foffset-4) != 0)\r\ncol_set_str(pinfo->cinfo, COL_INFO, "R NDPS - Error");\r\nif (tvb_get_ntohl(tvb, foffset-4) == 0)\r\n{\r\nreturn foffset;\r\n}\r\nproto_tree_add_item(ndps_tree, hf_ndps_ext_error, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nreturn foffset;\r\n}\r\nstatic int\r\ndissect_ndps_reply(tvbuff_t *tvb, packet_info *pinfo, proto_tree *ndps_tree, int foffset)\r\n{\r\nconversation_t *conversation = NULL;\r\nndps_req_hash_value *request_value = NULL;\r\nproto_tree *atree;\r\nproto_item *aitem;\r\nproto_tree *btree;\r\nproto_item *bitem;\r\nproto_tree *ctree;\r\nproto_item *citem;\r\nproto_tree *dtree;\r\nproto_item *ditem;\r\nguint32 ii;\r\nguint32 jj;\r\nguint32 kk;\r\nguint32 number_of_items=0;\r\nguint32 number_of_items2=0;\r\nguint32 number_of_items3=0;\r\nguint32 length=0;\r\nguint32 ndps_func=0;\r\nguint32 ndps_prog=0;\r\nguint32 error_val=0;\r\nguint32 resource_type=0;\r\ngint length_remaining;\r\nproto_item *expert_item;\r\nguint32 expert_status;\r\nif (!pinfo->fd->flags.visited) {\r\nconversation = find_conversation(pinfo->num, &pinfo->src, &pinfo->dst,\r\nPT_NCP, (guint32) pinfo->destport, (guint32) pinfo->destport, 0);\r\nif (conversation != NULL) {\r\nrequest_value = ndps_hash_lookup(conversation, (guint32) pinfo->destport);\r\np_add_proto_data(wmem_file_scope(), pinfo, proto_ndps, 0, (void*) request_value);\r\n}\r\n}\r\nelse {\r\nrequest_value = (ndps_req_hash_value *)p_get_proto_data(wmem_file_scope(), pinfo, proto_ndps, 0);\r\n}\r\nif (request_value) {\r\nndps_prog = request_value->ndps_prog;\r\nndps_func = request_value->ndps_func;\r\nproto_tree_add_uint_format(ndps_tree, hf_ndps_reqframe, tvb, 0,\r\n0, request_value->ndps_frame_num,\r\n"Response to Request in Frame Number: %u",\r\nrequest_value->ndps_frame_num);\r\n}\r\nif (tvb_reported_length_remaining(tvb, foffset) < 12 && tvb_get_ntohl(tvb, foffset) == 0)\r\n{\r\nproto_tree_add_uint(ndps_tree, hf_ndps_error_val, tvb, foffset, 4, error_val);\r\ncol_append_str(pinfo->cinfo, COL_INFO, "- Ok");\r\nreturn foffset;\r\n}\r\nif(ndps_func == 1 || ndps_func == 2)\r\n{\r\nexpert_item = proto_tree_add_item(ndps_tree, hf_ndps_rpc_acc_stat, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nexpert_status = tvb_get_ntohl(tvb, foffset);\r\nif (expert_status != 0) {\r\nexpert_add_info_format(pinfo, expert_item, &ei_ndps_rpc_acc_stat, "Fault: %s", val_to_str(expert_status, accept_stat, "Unknown NDPS Error (0x%08x)"));\r\n}\r\nfoffset += 4;\r\nif (tvb_reported_length_remaining(tvb,foffset) < 4 ) {\r\ncol_append_str(pinfo->cinfo, COL_INFO, "- Error");\r\nreturn foffset;\r\n}\r\nproto_tree_add_item(ndps_tree, hf_ndps_rpc_acc_results, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nif (tvb_reported_length_remaining(tvb,foffset) < 4) {\r\ncol_append_str(pinfo->cinfo, COL_INFO, "- Error");\r\nreturn foffset;\r\n}\r\n}\r\nerror_val = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_error_val, tvb, foffset, 4, error_val);\r\nfoffset += 4;\r\nif (try_val_to_str_ext(tvb_get_ntohl(tvb, foffset), &ndps_error_types_ext) && tvb_reported_length_remaining(tvb,foffset) < 8 && (tvb_get_ntohl(tvb, foffset)!=0))\r\n{\r\nexpert_status = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_item(ndps_tree, hf_ndps_return_code, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nexpert_add_info_format(pinfo, expert_item, &ei_ndps_return_code, "Fault: %s", val_to_str_ext(expert_status, &ndps_error_types_ext, "Unknown NDPS Error (0x%08x)"));\r\ncol_append_str(pinfo->cinfo, COL_INFO, "- Error");\r\nreturn foffset;\r\n}\r\ncol_append_str(pinfo->cinfo, COL_INFO, "- Ok");\r\nswitch(ndps_prog)\r\n{\r\ncase 0x060976:\r\nswitch(ndps_func)\r\n{\r\ncase 0x00000001:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nif(error_val != 0)\r\n{\r\nfoffset = ndps_error(tvb, pinfo, ndps_tree, foffset);\r\nif(tvb_reported_length_remaining(tvb, foffset) < 4)\r\n{\r\nbreak;\r\n}\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "PSM Name");\r\nfoffset = qualifiedname(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nbreak;\r\ncase 0x00000002:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nif(error_val != 0)\r\n{\r\nfoffset = ndps_error(tvb, pinfo, ndps_tree, foffset);\r\nif(tvb_reported_length_remaining(tvb, foffset) < 4)\r\n{\r\nbreak;\r\n}\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\n}\r\nfoffset = ndps_string(tvb, hf_ndps_pa_name, ndps_tree, foffset, NULL);\r\nbreak;\r\ncase 0x00000003:\r\nbreak;\r\ncase 0x00000004:\r\nfoffset = ndps_string(tvb, hf_ndps_pa_name, ndps_tree, foffset, NULL);\r\nproto_tree_add_item(ndps_tree, hf_local_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nif(error_val != 0)\r\n{\r\nfoffset = ndps_error(tvb, pinfo, ndps_tree, foffset);\r\n}\r\nbreak;\r\ncase 0x00000005:\r\ncase 0x00000006:\r\ncase 0x00000008:\r\ncase 0x0000000b:\r\ncase 0x0000000d:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_num_attributes, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Object Attribute Set");\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, aitem, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Attribute %d", ii+1);\r\nfoffset = attribute_value(tvb, pinfo, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nif(error_val != 0)\r\n{\r\nfoffset = ndps_error(tvb, pinfo, ndps_tree, foffset);\r\n}\r\nbreak;\r\ncase 0x00000007:\r\nproto_tree_add_item(ndps_tree, hf_answer_time, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Continuation Option");\r\nnumber_of_items=tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_num_options, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Option %d", ii+1);\r\nlength=tvb_get_ntohl(tvb, foffset);\r\nlength_remaining = tvb_reported_length_remaining(tvb, foffset);\r\nif(length_remaining == -1 || (guint32) length_remaining < length)\r\n{\r\nreturn foffset;\r\n}\r\nproto_tree_add_item(btree, hf_ndps_item_ptr, tvb, foffset, length, ENC_NA);\r\nfoffset += length;\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Limit Encountered Option");\r\nproto_tree_add_item(atree, hf_ndps_len, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(atree, hf_ndps_limit_enc, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Object Results Set");\r\nnumber_of_items=tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_num_results, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Results: (%d)", ii+1);\r\nif (ii>0) {\r\nfoffset += 2;\r\n}\r\nfoffset = objectidentification(tvb, btree, foffset);\r\nnumber_of_items2 = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(btree, hf_ndps_num_objects, tvb, foffset, 4, number_of_items2);\r\nfoffset += 4;\r\nfor (jj = 0; jj < number_of_items2; jj++ )\r\n{\r\nif (jj >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nctree = proto_tree_add_subtree_format(btree, tvb, foffset, -1, ett_ndps, &citem, "Object: (%d)", jj+1);\r\nfoffset = objectidentifier(tvb, ctree, foffset);\r\nfoffset += align_4(tvb, foffset);\r\nnumber_of_items3 = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ctree, hf_ndps_num_values, tvb, foffset, 4, number_of_items3);\r\nfoffset += 4;\r\nfor (kk = 0; kk < number_of_items3; kk++ )\r\n{\r\nif (kk >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\ndtree = proto_tree_add_subtree_format(ctree, tvb, foffset, -1, ett_ndps, &ditem, "Value: (%d)", kk+1);\r\nfoffset = attribute_value(tvb, pinfo, dtree, foffset);\r\nproto_item_set_end(ditem, tvb, foffset);\r\n}\r\nproto_tree_add_item(ctree, hf_ndps_qualifier, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset += align_4(tvb, foffset);\r\nproto_item_set_end(citem, tvb, foffset);\r\n}\r\nfoffset = objectidentifier(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nif(error_val != 0)\r\n{\r\nfoffset = ndps_error(tvb, pinfo, ndps_tree, foffset);\r\n}\r\nbreak;\r\ncase 0x00000009:\r\ncase 0x0000000a:\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Job ID");\r\nfoffset = ndps_string(tvb, hf_ndps_pa_name, atree, foffset, NULL);\r\nproto_tree_add_item(atree, hf_local_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(aitem, tvb, foffset);\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_num_attributes, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Object Attribute Set");\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, aitem, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Attribute %d", ii+1);\r\nfoffset = attribute_value(tvb, pinfo, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nif(error_val != 0)\r\n{\r\nfoffset = ndps_error(tvb, pinfo, ndps_tree, foffset);\r\n}\r\nbreak;\r\ncase 0x0000000c:\r\ncase 0x0000000e:\r\ncase 0x0000000f:\r\ncase 0x00000010:\r\ncase 0x00000012:\r\ncase 0x00000013:\r\ncase 0x00000014:\r\ncase 0x00000018:\r\ncase 0x00000019:\r\ncase 0x0000001b:\r\ncase 0x0000001c:\r\ncase 0x0000001e:\r\ncase 0x0000001f:\r\ncase 0x00000020:\r\ncase 0x00000021:\r\nif(error_val != 0)\r\n{\r\nfoffset = ndps_error(tvb, pinfo, ndps_tree, foffset);\r\n}\r\nbreak;\r\ncase 0x00000011:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_num_jobs, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Resubmit Job");\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, aitem, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Job %d", ii+1);\r\nctree = proto_tree_add_subtree(btree, tvb, foffset, -1, ett_ndps, &citem, "Old Job");\r\nfoffset = ndps_string(tvb, hf_ndps_pa_name, ctree, foffset, NULL);\r\nproto_tree_add_item(ctree, hf_local_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(citem, tvb, foffset);\r\nctree = proto_tree_add_subtree(btree, tvb, foffset, -1, ett_ndps, &citem, "New Job");\r\nfoffset = ndps_string(tvb, hf_ndps_pa_name, ctree, foffset, NULL);\r\nproto_tree_add_item(ctree, hf_local_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(citem, tvb, foffset);\r\nnumber_of_items2 = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ctree, hf_ndps_num_attributes, tvb, foffset, 4, number_of_items2);\r\nfoffset += 4;\r\nctree = proto_tree_add_subtree(btree, tvb, foffset, -1, ett_ndps, &citem, "Job Status");\r\nfor (jj = 0; jj < number_of_items2; jj++ )\r\n{\r\nif (jj >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, citem, &ei_ndps_truncated);\r\nbreak;\r\n}\r\ndtree = proto_tree_add_subtree_format(ctree, tvb, foffset, -1, ett_ndps, &ditem, "Object %d", jj+1);\r\nfoffset = attribute_value(tvb, pinfo, dtree, foffset);\r\nproto_item_set_end(ditem, tvb, foffset);\r\n}\r\nproto_item_set_end(citem, tvb, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nif(error_val != 0)\r\n{\r\nfoffset = ndps_error(tvb, pinfo, ndps_tree, foffset);\r\n}\r\nbreak;\r\ncase 0x00000015:\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Job Status");\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_num_attributes, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Object %d", ii+1);\r\nfoffset = attribute_value(tvb, pinfo, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nif(error_val != 0)\r\n{\r\nfoffset = ndps_error(tvb, pinfo, ndps_tree, foffset);\r\n}\r\nbreak;\r\ncase 0x00000016:\r\ncase 0x00000017:\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Printer Status");\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_item_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Object %d", ii+1);\r\nfoffset = attribute_value(tvb, pinfo, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nif(error_val != 0)\r\n{\r\nfoffset = ndps_error(tvb, pinfo, ndps_tree, foffset);\r\n}\r\nbreak;\r\ncase 0x0000001a:\r\nproto_tree_add_item(ndps_tree, hf_ndps_profile_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nif(error_val != 0)\r\n{\r\nfoffset = ndps_error(tvb, pinfo, ndps_tree, foffset);\r\n}\r\nbreak;\r\ncase 0x0000001d:\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length==4)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_value, tvb, foffset, length, ENC_BIG_ENDIAN);\r\n}\r\nfoffset += length;\r\nproto_tree_add_item(ndps_tree, hf_ndps_profile_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_persistence, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Consumer Name");\r\nfoffset = qualifiedname(tvb, atree, foffset);\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length==4)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_value, tvb, foffset, length, ENC_BIG_ENDIAN);\r\n}\r\nfoffset += length;\r\nproto_tree_add_item(ndps_tree, hf_ndps_language_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Method ID");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Delivery Addresses");\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_delivery_add_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Address %d", ii+1);\r\nfoffset = address_item(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = event_object_set(tvb, pinfo, ndps_tree, foffset);\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length!=0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_continuation_option, tvb, foffset, length, ENC_NA);\r\n}\r\nfoffset += length;\r\nif(error_val != 0)\r\n{\r\nfoffset = ndps_error(tvb, pinfo, ndps_tree, foffset);\r\n}\r\nbreak;\r\ncase 0x00000022:\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "NDS Printer Name");\r\nfoffset = qualifiedname(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nif(error_val != 0)\r\n{\r\nfoffset = ndps_error(tvb, pinfo, ndps_tree, foffset);\r\n}\r\nbreak;\r\ncase 0x00000023:\r\nproto_tree_add_item(ndps_tree, hf_ndps_profile_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_notify_lease_exp_time, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nif(error_val != 0)\r\n{\r\nfoffset = ndps_error(tvb, pinfo, ndps_tree, foffset);\r\n}\r\nbreak;\r\ncase 0x00000024:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_num_events, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Event %d", ii+1);\r\nproto_tree_add_item(atree, hf_ndps_profile_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(atree, hf_ndps_persistence, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, -1, ett_ndps, &bitem, "Consumer Name");\r\nfoffset = qualifiedname(tvb, btree, foffset);\r\nfoffset = ndps_string(tvb, hf_ndps_supplier_name, atree, foffset, NULL);\r\nproto_tree_add_item(atree, hf_ndps_language_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(bitem, tvb, foffset);\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, -1, ett_ndps, &bitem, "Method ID");\r\nfoffset = name_or_id(tvb, btree, foffset);\r\nfoffset += align_4(tvb, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\nnumber_of_items2 = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(atree, hf_ndps_delivery_add_count, tvb, foffset, 4, number_of_items2);\r\nfoffset += 4;\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, -1, ett_ndps, &bitem, "Delivery Addresses");\r\nfor (jj = 0; jj < number_of_items2; jj++ )\r\n{\r\nif (jj >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, bitem, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nctree = proto_tree_add_subtree_format(btree, tvb, foffset, -1, ett_ndps, &citem, "Address %d", ii+1);\r\nfoffset = address_item(tvb, ctree, foffset);\r\nproto_item_set_end(citem, tvb, foffset);\r\n}\r\nproto_item_set_end(bitem, tvb, foffset);\r\nfoffset = event_object_set(tvb, pinfo, atree, foffset);\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, -1, ett_ndps, &bitem, "Account");\r\nfoffset = qualifiedname(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, -1, ett_ndps, &bitem, "Notify Attributes");\r\nnumber_of_items2 = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(btree, hf_ndps_num_attributes, tvb, foffset, 4, number_of_items2);\r\nfoffset += 4;\r\nfor (jj = 0; jj < number_of_items2; jj++ )\r\n{\r\nif (jj >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nctree = proto_tree_add_subtree_format(btree, tvb, foffset, -1, ett_ndps, &citem, "Attribute %d", ii+1);\r\nfoffset = objectidentifier(tvb, ctree, foffset);\r\nproto_item_set_end(citem, tvb, foffset);\r\n}\r\nproto_item_set_end(bitem, tvb, foffset);\r\nproto_tree_add_item(atree, hf_notify_time_interval, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(atree, hf_notify_sequence_number, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(atree, hf_notify_lease_exp_time, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = ndps_string(tvb, hf_notify_printer_uri, atree, foffset, NULL);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length!=0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_continuation_option, tvb, foffset, length, ENC_NA);\r\n}\r\nfoffset += length;\r\nif(error_val != 0)\r\n{\r\nfoffset = ndps_error(tvb, pinfo, ndps_tree, foffset);\r\n}\r\n}\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nbreak;\r\ncase 0x060977:\r\nswitch(ndps_func)\r\n{\r\ncase 0x00000001:\r\ncase 0x00000002:\r\ncase 0x00000004:\r\ncase 0x00000005:\r\ncase 0x00000006:\r\nfoffset = return_code(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000003:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_num_services, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Service %d", ii+1);\r\nproto_tree_add_item(atree, hf_ndps_service_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(atree, hf_ndps_service_enabled, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nfoffset = return_code(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000007:\r\nproto_tree_add_item(ndps_tree, hf_ndps_item_count, tvb, foffset,\r\n4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = ndps_string(tvb, hf_ndps_broker_name, ndps_tree, foffset, NULL);\r\nfoffset = ndps_string(tvb, hf_ndps_tree, ndps_tree, foffset, NULL);\r\nfoffset = return_code(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000008:\r\ndefault:\r\nbreak;\r\n}\r\nbreak;\r\ncase 0x060978:\r\nswitch(ndps_func)\r\n{\r\ncase 0x00000001:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_num_attributes, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Attribute %d", ii+1);\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length!=0)\r\n{\r\nproto_tree_add_item(atree, hf_ndps_attribute_set, tvb, foffset, length, ENC_NA);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 0x00000002:\r\nbreak;\r\ncase 0x00000003:\r\ncase 0x00000004:\r\ncase 0x00000005:\r\ncase 0x00000006:\r\ncase 0x00000007:\r\nfoffset = return_code(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000008:\r\ncase 0x00000009:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_item_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Item %d", ii+1);\r\nfoffset = server_entry(tvb, pinfo, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length!=0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_continuation_option, tvb, foffset, length, ENC_NA);\r\n}\r\nfoffset += length;\r\nfoffset = return_code(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x0000000a:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_item(ndps_tree, hf_ndps_item_count, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\naitem = proto_tree_add_item(ndps_tree, hf_ndps_client_server_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\natree = proto_item_add_subtree(aitem, ett_ndps);\r\nfoffset += 4;\r\nfoffset = ndps_string(tvb, hf_ndps_registry_name, atree, foffset, NULL);\r\nfoffset = print_address(tvb, atree, foffset);\r\n}\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length!=0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_continuation_option, tvb, foffset, length, ENC_NA);\r\n}\r\nfoffset += length;\r\nfoffset = return_code(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x0000000b:\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "NDS Printer Name");\r\nfoffset = qualifiedname(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = return_code(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x0000000c:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_time, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = return_code(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nbreak;\r\ncase 0x060979:\r\nswitch(ndps_func)\r\n{\r\ncase 0x00000001:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_num_attributes, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Attribute %d", ii+1);\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length!=0)\r\n{\r\nproto_tree_add_item(atree, hf_ndps_attribute_set, tvb, foffset, length, ENC_NA);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 0x00000002:\r\nbreak;\r\ncase 0x00000003:\r\nproto_tree_add_item(ndps_tree, hf_ndps_session, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = event_object_set(tvb, pinfo, ndps_tree, foffset);\r\nfoffset = return_code(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000004:\r\ncase 0x0000000b:\r\ncase 0x0000000d:\r\nfoffset = return_code(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000005:\r\nproto_tree_add_item(ndps_tree, hf_ndps_profile_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = event_object_set(tvb, pinfo, ndps_tree, foffset);\r\nfoffset = return_code(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000006:\r\ncase 0x00000007:\r\ncase 0x00000009:\r\nfoffset = event_object_set(tvb, pinfo, ndps_tree, foffset);\r\nfoffset = return_code(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000008:\r\nproto_tree_add_item(ndps_tree, hf_ndps_len, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_profile_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_persistence, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Consumer Name");\r\nfoffset = qualifiedname(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length==4)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_value, tvb, foffset, length, ENC_BIG_ENDIAN);\r\n}\r\nfoffset += length;\r\nproto_tree_add_item(ndps_tree, hf_ndps_language_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Method ID");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Delivery Addresses");\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_delivery_add_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Address %d", ii+1);\r\nfoffset = address_item(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = event_object_set(tvb, pinfo, ndps_tree, foffset);\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length!=0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_continuation_option, tvb, foffset, length, ENC_NA);\r\n}\r\nfoffset += length;\r\nfoffset = return_code(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x0000000a:\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length==4)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_language_id, tvb, foffset, length, ENC_BIG_ENDIAN);\r\n}\r\nfoffset += length;\r\nfoffset = return_code(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x0000000c:\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Method ID");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = return_code(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x0000000e:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_delivery_method_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Method %d", ii+1);\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Method ID");\r\nfoffset = name_or_id(tvb, btree, foffset);\r\nfoffset += align_4(tvb, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\nfoffset = ndps_string(tvb, hf_ndps_method_name, atree, foffset, NULL);\r\nfoffset = ndps_string(tvb, hf_ndps_method_ver, atree, foffset, NULL);\r\nfoffset = ndps_string(tvb, hf_ndps_file_name, atree, foffset, NULL);\r\nproto_tree_add_item(atree, hf_ndps_admin_submit, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nfoffset = return_code(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x0000000f:\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Method ID");\r\nfoffset = name_or_id(tvb, atree, foffset);\r\nfoffset = ndps_string(tvb, hf_ndps_method_name, atree, foffset, NULL);\r\nfoffset = ndps_string(tvb, hf_ndps_method_ver, atree, foffset, NULL);\r\nfoffset = ndps_string(tvb, hf_ndps_file_name, atree, foffset, NULL);\r\nproto_tree_add_item(atree, hf_ndps_admin_submit, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(aitem, tvb, foffset);\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_delivery_add_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Delivery Addresses");\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, aitem, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Address %d", ii+1);\r\nfoffset = address_item(tvb, btree, foffset);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nfoffset = return_code(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000010:\r\nproto_tree_add_item(ndps_tree, hf_ndps_item_count, tvb, foffset,\r\n4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = ndps_string(tvb, hf_ndps_broker_name, ndps_tree, foffset, NULL);\r\nfoffset = ndps_string(tvb, hf_ndps_tree, ndps_tree, foffset, NULL);\r\nfoffset = return_code(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000011:\r\nproto_tree_add_item(ndps_tree, hf_ndps_get_session_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_time, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = return_code(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nbreak;\r\ncase 0x06097a:\r\nswitch(ndps_func)\r\n{\r\ncase 0x00000001:\r\nlength = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nif (length!=0)\r\n{\r\nproto_tree_add_item(ndps_tree, hf_ndps_attribute_set, tvb, foffset, length, ENC_NA);\r\n}\r\nbreak;\r\ncase 0x00000002:\r\nbreak;\r\ncase 0x00000003:\r\ncase 0x00000004:\r\nfoffset = return_code(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x00000005:\r\nproto_tree_add_item(ndps_tree, hf_ndps_return_code, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nif (tvb_get_ntohl(tvb, foffset-4) != 0)\r\ncol_set_str(pinfo->cinfo, COL_INFO, "R NDPS - Error");\r\nif (tvb_get_ntohl(tvb, foffset-4) != 0)\r\n{\r\nbreak;\r\n}\r\nproto_tree_add_item(ndps_tree, hf_ndps_status_flags, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_resource_list_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nresource_type = tvb_get_ntohl(tvb, foffset);\r\nfoffset += 4;\r\nswitch (resource_type)\r\n{\r\ncase 0:\r\ncase 1:\r\ncase 2:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_printer_def_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Definition %d", ii+1);\r\nif (tvb_get_ntohl(tvb, foffset)==0) {\r\nfoffset += 2;\r\n}\r\nfoffset += 4;\r\nfoffset = ndps_string(tvb, hf_ndps_printer_manuf, atree, foffset, NULL);\r\nif (tvb_get_ntohl(tvb, foffset)==0) {\r\nfoffset += 2;\r\n}\r\nfoffset += 4;\r\nfoffset = ndps_string(tvb, hf_ndps_printer_type, atree, foffset, NULL);\r\nif (tvb_get_ntohl(tvb, foffset)==0) {\r\nfoffset += 2;\r\n}\r\nfoffset += 4;\r\nfoffset = ndps_string(tvb, hf_ndps_inf_file_name, atree, foffset, NULL);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 3:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_item_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Banner %d", ii+1);\r\nfoffset = ndps_string(tvb, hf_ndps_banner_name, atree, foffset, NULL);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 4:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_font_type_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Font %d", ii+1);\r\nfoffset = ndps_string(tvb, hf_font_type_name, atree, foffset, NULL);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 7:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_font_file_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Font File %d", ii+1);\r\nfoffset = ndps_string(tvb, hf_font_file_name, atree, foffset, NULL);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 5:\r\ncase 12:\r\ncase 9:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_printer_def_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "File %d", ii+1);\r\nfoffset = ndps_string(tvb, hf_ndps_prn_file_name, atree, foffset, NULL);\r\nfoffset = ndps_string(tvb, hf_ndps_prn_dir_name, atree, foffset, NULL);\r\nfoffset = ndps_string(tvb, hf_ndps_inf_file_name, atree, foffset, NULL);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 6:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_printer_def_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Definition %d", ii+1);\r\nfoffset = ndps_string(tvb, hf_ndps_prn_file_name, atree, foffset, NULL);\r\nfoffset = ndps_string(tvb, hf_ndps_prn_dir_name, atree, foffset, NULL);\r\nfoffset = ndps_string(tvb, hf_ndps_inf_file_name, atree, foffset, NULL);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_item_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Item %d", ii+1);\r\nfoffset = ndps_string(tvb, hf_ndps_def_file_name, atree, foffset, NULL);\r\nnumber_of_items2 = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(atree, hf_ndps_num_win31_keys, tvb, foffset, 4, number_of_items2);\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, 4, ett_ndps, &bitem, "Windows 3.1 Keys");\r\nfoffset += 4;\r\nfor (jj = 0; jj < number_of_items2; jj++ )\r\n{\r\nif (jj >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, bitem, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nfoffset = ndps_string(tvb, hf_ndps_windows_key, btree, foffset, NULL);\r\n}\r\nproto_item_set_end(bitem, tvb, foffset);\r\nnumber_of_items2 = tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(atree, hf_ndps_num_win95_keys, tvb, foffset, 4, number_of_items2);\r\nbtree = proto_tree_add_subtree(atree, tvb, foffset, 4, ett_ndps, &bitem, "Windows 95 Keys");\r\nfoffset += 4;\r\nfor (jj = 0; jj < number_of_items2; jj++ )\r\n{\r\nif (jj >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, bitem, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nfoffset = ndps_string(tvb, hf_ndps_windows_key, btree, foffset, NULL);\r\n}\r\nproto_item_set_end(bitem, tvb, foffset);\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 10:\r\nfoffset = ndps_string(tvb, hf_ndps_def_file_name, ndps_tree, foffset, NULL);\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_os_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "OS %d", ii+1);\r\nproto_tree_add_item(atree, hf_os_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nnumber_of_items2 = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(atree, hf_ndps_num_windows_keys, tvb, foffset, 4, number_of_items2);\r\nfoffset += 4;\r\nfor (jj = 0; jj < number_of_items2; jj++ )\r\n{\r\nif (jj >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Key %d", jj+1);\r\nfoffset = ndps_string(tvb, hf_ndps_windows_key, btree, foffset, NULL);\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 8:\r\ncase 11:\r\ncase 13:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_printer_type_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Type %d", ii+1);\r\nfoffset = ndps_string(tvb, hf_ndps_printer_manuf, atree, foffset, NULL);\r\nfoffset = ndps_string(tvb, hf_ndps_printer_type, atree, foffset, NULL);\r\nfoffset = ndps_string(tvb, hf_ndps_prn_file_name, atree, foffset, NULL);\r\nfoffset = ndps_string(tvb, hf_ndps_prn_dir_name, atree, foffset, NULL);\r\nproto_tree_add_item(atree, hf_archive_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(atree, hf_archive_file_size, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ncase 14:\r\nnumber_of_items = tvb_get_ntohl(tvb, foffset);\r\nexpert_item = proto_tree_add_uint(ndps_tree, hf_ndps_language_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, expert_item, &ei_ndps_truncated);\r\nbreak;\r\n}\r\natree = proto_tree_add_subtree_format(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Language %d", ii+1);\r\nproto_tree_add_item(atree, hf_ndps_language_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_item_set_end(aitem, tvb, foffset);\r\n}\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nbreak;\r\ncase 0x00000006:\r\nproto_tree_add_item(ndps_tree, hf_ndps_return_code, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nif (tvb_get_ntohl(tvb, foffset-4) != 0)\r\ncol_set_str(pinfo->cinfo, COL_INFO, "R NDPS - Error");\r\nif (tvb_get_ntohl(tvb, foffset-4) != 0)\r\n{\r\nbreak;\r\n}\r\nproto_tree_add_item(ndps_tree, hf_get_status_flag, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_file_timestamp, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_ndps_data, tvb, foffset, -1, ENC_NA);\r\nbreak;\r\ncase 0x00000007:\r\nproto_tree_add_item(ndps_tree, hf_ndps_return_code, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nif (tvb_get_ntohl(tvb, foffset-4) != 0)\r\ncol_set_str(pinfo->cinfo, COL_INFO, "R NDPS - Error");\r\nif (tvb_get_ntohl(tvb, foffset-4) != 0)\r\n{\r\nbreak;\r\n}\r\nproto_tree_add_item(ndps_tree, hf_file_timestamp, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ncase 0x00000008:\r\nfoffset = qualifiedname(tvb, ndps_tree, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_error_val, tvb, foffset, 4, error_val);\r\nfoffset += 4;\r\nbreak;\r\ncase 0x00000009:\r\nproto_tree_add_item(ndps_tree, hf_ndps_get_resman_session_type, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ndps_tree, hf_time, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nfoffset = return_code(tvb, pinfo, ndps_tree, foffset);\r\nbreak;\r\ncase 0x0000000a:\r\nproto_tree_add_item(ndps_tree, hf_ndps_return_code, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nif (tvb_get_ntohl(tvb, foffset-4) != 0)\r\ncol_set_str(pinfo->cinfo, COL_INFO, "R NDPS - Error");\r\nif (tvb_get_ntohl(tvb, foffset-4) != 0)\r\n{\r\nbreak;\r\n}\r\nproto_tree_add_item(ndps_tree, hf_ndps_language_id, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nbreak;\r\ncase 0x06097b:\r\nswitch(ndps_func)\r\n{\r\ncase 0x00000001:\r\nproto_tree_add_item(ndps_tree, hf_ndps_return_code, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nif (tvb_get_ntohl(tvb, foffset-4) != 0)\r\ncol_set_str(pinfo->cinfo, COL_INFO, "R NDPS - Error");\r\nbreak;\r\ncase 0x00000002:\r\nbreak;\r\ncase 0x00000003:\r\ncase 0x00000004:\r\nproto_tree_add_item(ndps_tree, hf_ndps_return_code, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nif (tvb_get_ntohl(tvb, foffset-4) != 0)\r\ncol_set_str(pinfo->cinfo, COL_INFO, "R NDPS - Error");\r\nif (tvb_get_ntohl(tvb, foffset-4) != 0)\r\n{\r\nbreak;\r\n}\r\nnumber_of_items=tvb_get_ntohl(tvb, foffset);\r\nproto_tree_add_uint(ndps_tree, hf_ndps_item_count, tvb, foffset, 4, number_of_items);\r\nfoffset += 4;\r\natree = proto_tree_add_subtree(ndps_tree, tvb, foffset, -1, ett_ndps, &aitem, "Failed Items");\r\nfor (ii = 0; ii < number_of_items; ii++ )\r\n{\r\nif (ii >= NDPS_MAX_ITEMS) {\r\nexpert_add_info(pinfo, aitem, &ei_ndps_truncated);\r\nbreak;\r\n}\r\nbtree = proto_tree_add_subtree_format(atree, tvb, foffset, -1, ett_ndps, &bitem, "Item %d", ii+1);\r\nlength=tvb_get_ntohl(tvb, foffset);\r\nlength_remaining = tvb_reported_length_remaining(tvb, foffset);\r\nif(length_remaining == -1 || (guint32) length_remaining < length)\r\n{\r\nreturn foffset;\r\n}\r\nproto_tree_add_item(btree, hf_ndps_item_ptr, tvb, foffset, length, ENC_NA);\r\nfoffset += length;\r\nproto_item_set_end(bitem, tvb, foffset);\r\n}\r\nproto_item_set_end(aitem, tvb, foffset);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nreturn foffset;\r\n}\r\nvoid\r\nproto_register_ndps(void)\r\n{\r\nstatic hf_register_info hf_ndps[] = {\r\n{ &hf_ndps_record_mark,\r\n{ "Record Mark", "ndps.record_mark", FT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_packet_type,\r\n{ "Packet Type", "ndps.packet_type",\r\nFT_UINT32, BASE_HEX, VALS(ndps_packet_types), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_length,\r\n{ "Record Length", "ndps.record_length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_xid,\r\n{ "Exchange ID", "ndps.xid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_rpc_version,\r\n{ "RPC Version", "ndps.rpc_version",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_spx_ndps_program,\r\n{ "NDPS Program Number", "spx.ndps_program",\r\nFT_UINT32, BASE_HEX, VALS(spx_ndps_program_vals), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_spx_ndps_version,\r\n{ "Program Version", "spx.ndps_version",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n#if 0\r\n{ &hf_ndps_error,\r\n{ "NDPS Error", "spx.ndps_error",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n#endif\r\n{ &hf_ndps_other_error_string,\r\n{ "Extended Error String", "ndps.ext_err_string",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_spx_ndps_func_print,\r\n{ "Print Program", "spx.ndps_func_print",\r\nFT_UINT32, BASE_HEX | BASE_EXT_STRING, &spx_ndps_print_func_vals_ext, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_spx_ndps_func_notify,\r\n{ "Notify Program", "spx.ndps_func_notify",\r\nFT_UINT32, BASE_HEX | BASE_EXT_STRING, &spx_ndps_notify_func_vals_ext, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_spx_ndps_func_delivery,\r\n{ "Delivery Program", "spx.ndps_func_delivery",\r\nFT_UINT32, BASE_HEX, VALS(spx_ndps_deliver_func_vals), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_spx_ndps_func_registry,\r\n{ "Registry Program", "spx.ndps_func_registry",\r\nFT_UINT32, BASE_HEX | BASE_EXT_STRING, &spx_ndps_registry_func_vals_ext, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_spx_ndps_func_resman,\r\n{ "ResMan Program", "spx.ndps_func_resman",\r\nFT_UINT32, BASE_HEX | BASE_EXT_STRING, &spx_ndps_resman_func_vals_ext, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_spx_ndps_func_broker,\r\n{ "Broker Program", "spx.ndps_func_broker",\r\nFT_UINT32, BASE_HEX | BASE_EXT_STRING, &spx_ndps_broker_func_vals_ext, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_num_objects,\r\n{ "Number of Objects", "ndps.num_objects",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_num_attributes,\r\n{ "Number of Attributes", "ndps.num_attributes",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n#if 0\r\n{ &hf_ndps_sbuffer,\r\n{ "Server", "ndps.sbuffer",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n#endif\r\n#if 0\r\n{ &hf_ndps_rbuffer,\r\n{ "Connection", "ndps.rbuffer",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n#endif\r\n{ &hf_ndps_user_name,\r\n{ "Trustee Name", "ndps.user_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_broker_name,\r\n{ "Broker Name", "ndps.broker_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_num_results,\r\n{ "Number of Results", "ndps.num_results",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_num_options,\r\n{ "Number of Options", "ndps.num_options",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_num_jobs,\r\n{ "Number of Jobs", "ndps.num_jobs",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_pa_name,\r\n{ "Printer Name", "ndps.pa_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_tree,\r\n{ "Tree", "ndps.tree",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_reqframe,\r\n{ "Request Frame", "ndps.reqframe",\r\nFT_FRAMENUM, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_error_val,\r\n{ "Return Status", "ndps.error_val",\r\nFT_UINT32, BASE_HEX | BASE_EXT_STRING, &ndps_error_types_ext, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_object,\r\n{ "Object ID", "ndps.object",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_cred_type,\r\n{ "Credential Type", "ndps.cred_type",\r\nFT_UINT32, BASE_HEX, VALS(ndps_credential_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_server_name,\r\n{ "Server Name", "ndps.server_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_connection,\r\n{ "Connection", "ndps.connection",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_ext_error,\r\n{ "Extended Error Code", "ndps.ext_error",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_auth_null,\r\n{ "Auth Null", "ndps.auth_null",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_rpc_accept,\r\n{ "RPC Accept or Deny", "ndps.rpc_acc",\r\nFT_UINT32, BASE_HEX, VALS(true_false), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_rpc_acc_stat,\r\n{ "RPC Accept Status", "ndps.rpc_acc_stat",\r\nFT_UINT32, BASE_HEX, VALS(accept_stat), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_rpc_rej_stat,\r\n{ "RPC Reject Status", "ndps.rpc_rej_stat",\r\nFT_UINT32, BASE_HEX, VALS(reject_stat), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_rpc_acc_results,\r\n{ "RPC Accept Results", "ndps.rpc_acc_res",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_problem_type,\r\n{ "Problem Type", "ndps.rpc_prob_type",\r\nFT_UINT32, BASE_HEX, VALS(error_type_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_security_problem_type,\r\n{ "Security Problem", "ndps.rpc_sec_prob",\r\nFT_UINT32, BASE_HEX, VALS(security_problem_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_service_problem_type,\r\n{ "Service Problem", "ndps.rpc_serv_prob",\r\nFT_UINT32, BASE_HEX | BASE_EXT_STRING, &service_problem_enum_ext, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_access_problem_type,\r\n{ "Access Problem", "ndps.rpc_acc_prob",\r\nFT_UINT32, BASE_HEX, VALS(access_problem_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_printer_problem_type,\r\n{ "Printer Problem", "ndps.rpc_print_prob",\r\nFT_UINT32, BASE_HEX, VALS(printer_problem_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_selection_problem_type,\r\n{ "Selection Problem", "ndps.rpc_sel_prob",\r\nFT_UINT32, BASE_HEX, VALS(selection_problem_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_doc_access_problem_type,\r\n{ "Document Access Problem", "ndps.rpc_doc_acc_prob",\r\nFT_UINT32, BASE_HEX, VALS(doc_access_problem_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_attribute_problem_type,\r\n{ "Attribute Problem", "ndps.rpc_attr_prob",\r\nFT_UINT32, BASE_HEX | BASE_EXT_STRING, &attribute_problem_enum_ext, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_update_problem_type,\r\n{ "Update Problem", "ndps.rpc_update_prob",\r\nFT_UINT32, BASE_HEX, VALS(update_problem_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_obj_id_type,\r\n{ "Object ID Type", "ndps.rpc_obj_id_type",\r\nFT_UINT32, BASE_HEX, VALS(obj_identification_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_oid_struct_size,\r\n{ "OID Struct Size", "ndps.rpc_oid_struct_size",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_object_name,\r\n{ "Object Name", "ndps.object_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_document_number,\r\n{ "Document Number", "ndps.doc_num",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_doc_content,\r\n{ "Document Content", "ndps.doc_content",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_nameorid,\r\n{ "Name or ID Type", "ndps.nameorid",\r\nFT_UINT32, BASE_HEX, VALS(nameorid_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_local_object_name,\r\n{ "Local Object Name", "ndps.loc_object_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_printer_name,\r\n{ "Printer Name", "ndps.printer_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_qualified_name,\r\n{ "Qualified Name Type", "ndps.qual_name_type",\r\nFT_UINT32, BASE_HEX, VALS(qualified_name_enum), 0x0,\r\nNULL, HFILL }},\r\n#if 0\r\n{ &hf_ndps_qualified_name2,\r\n{ "Qualified Name Type", "ndps.qual_name_type2",\r\nFT_UINT32, BASE_HEX, VALS(qualified_name_enum2), 0x0,\r\nNULL, HFILL }},\r\n#endif\r\n{ &hf_ndps_item_count,\r\n{ "Number of Items", "ndps.item_count",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_num_passwords,\r\n{ "Number of Passwords", "ndps.num_passwords",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_num_servers,\r\n{ "Number of Servers", "ndps.num_servers",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_num_locations,\r\n{ "Number of Locations", "ndps.num_locations",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_num_areas,\r\n{ "Number of Areas", "ndps.num_areas",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_num_address_items,\r\n{ "Number of Address Items", "ndps.num_address_items",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_num_job_categories,\r\n{ "Number of Job Categories", "ndps.num_job_categories",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_num_page_selects,\r\n{ "Number of Page Select Items", "ndps.num_page_selects",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_num_page_informations,\r\n{ "Number of Page Information Items", "ndps.num_page_informations",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_num_names,\r\n{ "Number of Names", "ndps.num_names",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_num_categories,\r\n{ "Number of Categories", "ndps.num_categories",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_num_colorants,\r\n{ "Number of Colorants", "ndps.num_colorants",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_num_events,\r\n{ "Number of Events", "ndps.num_events",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_num_args,\r\n{ "Number of Arguments", "ndps.num_argss",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_num_transfer_methods,\r\n{ "Number of Transfer Methods", "ndps.num_transfer_methods",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_num_doc_types,\r\n{ "Number of Document Types", "ndps.num_doc_types",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_num_destinations,\r\n{ "Number of Destinations", "ndps.num_destinations",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_qualifier,\r\n{ "Qualifier", "ndps.qual",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_lib_error,\r\n{ "Library Error", "ndps.lib_error",\r\nFT_UINT32, BASE_HEX | BASE_EXT_STRING, &ndps_error_types_ext, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_other_error,\r\n{ "Other Error", "ndps.other_error",\r\nFT_UINT32, BASE_HEX | BASE_EXT_STRING, &ndps_error_types_ext, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_other_error_2,\r\n{ "Other Error 2", "ndps.other_error_2",\r\nFT_UINT32, BASE_HEX | BASE_EXT_STRING, &ndps_error_types_ext, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_session,\r\n{ "Session Handle", "ndps.session",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_abort_flag,\r\n{ "Abort?", "ndps.abort",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_obj_attribute_type,\r\n{ "Value Syntax", "ndps.attrib_type",\r\nFT_UINT32, BASE_HEX | BASE_EXT_STRING, &ndps_attribute_enum_ext, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_attribute_value,\r\n{ "Value", "ndps.attribue_value",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_lower_range,\r\n{ "Lower Range", "ndps.lower_range",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_upper_range,\r\n{ "Upper Range", "ndps.upper_range",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_n64,\r\n{ "Value", "ndps.n64",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_lower_range_n64,\r\n{ "Lower Range", "ndps.lower_range_n64",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_upper_range_n64,\r\n{ "Upper Range", "ndps.upper_range_n64",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_attrib_boolean,\r\n{ "Value?", "ndps.attrib_boolean",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_realization,\r\n{ "Realization Type", "ndps.realization",\r\nFT_UINT32, BASE_HEX, VALS(ndps_realization_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_xdimension_n64,\r\n{ "X Dimension", "ndps.xdimension_n64",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_ydimension_n64,\r\n{ "Y Dimension", "ndps.ydimension_n64",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_dim_value,\r\n{ "Dimension Value Type", "ndps.dim_value",\r\nFT_UINT32, BASE_HEX, VALS(ndps_dim_value_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_dim_flag,\r\n{ "Dimension Flag", "ndps.dim_falg",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_xydim_value,\r\n{ "XY Dimension Value Type", "ndps.xydim_value",\r\nFT_UINT32, BASE_HEX, VALS(ndps_xydim_value_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_location_value,\r\n{ "Location Value Type", "ndps.location_value",\r\nFT_UINT32, BASE_HEX, VALS(ndps_location_value_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_xmin_n64,\r\n{ "Minimum X Dimension", "ndps.xmin_n64",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_xmax_n64,\r\n{ "Maximum X Dimension", "ndps.xmax_n64",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_ymin_n64,\r\n{ "Minimum Y Dimension", "ndps.ymin_n64",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_ymax_n64,\r\n{ "Maximum Y Dimension", "ndps.ymax_n64",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_edge_value,\r\n{ "Edge Value", "ndps.edge_value",\r\nFT_UINT32, BASE_HEX, VALS(ndps_edge_value_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_cardinal_or_oid,\r\n{ "Cardinal or OID", "ndps.car_or_oid",\r\nFT_UINT32, BASE_HEX, VALS(ndps_card_or_oid_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_cardinal_name_or_oid,\r\n{ "Cardinal Name or OID", "ndps.car_name_or_oid",\r\nFT_UINT32, BASE_HEX, VALS(ndps_card_name_or_oid_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_integer_or_oid,\r\n{ "Integer or OID", "ndps.integer_or_oid",\r\nFT_UINT32, BASE_HEX, VALS(ndps_integer_or_oid_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_profile_id,\r\n{ "Profile ID", "ndps.profile_id",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_persistence,\r\n{ "Persistence", "ndps.persistence",\r\nFT_UINT32, BASE_HEX, VALS(ndps_persistence_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_language_count,\r\n{ "Number of Languages", "ndps.language_count",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_language_id,\r\n{ "Language ID", "ndps.lang_id",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_address_type,\r\n{ "Address Type", "ndps.address_type",\r\nFT_UINT32, BASE_HEX | BASE_EXT_STRING, &ndps_address_type_enum_ext, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_address,\r\n{ "Address", "ndps.address",\r\nFT_UINT32, BASE_HEX, VALS(ndps_address_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_add_bytes,\r\n{ "Address Bytes", "ndps.add_bytes",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_event_type,\r\n{ "Event Type", "ndps.event_type",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_event_object_identifier,\r\n{ "Event Object Type", "ndps.event_object_identifier",\r\nFT_UINT32, BASE_HEX, VALS(ndps_event_object_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_octet_string,\r\n{ "Octet String", "ndps.octet_string",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_scope,\r\n{ "Scope", "ndps.scope",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_address_len,\r\n{ "Address Length", "ndps.addr_len",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_net,\r\n{ "IPX Network", "ndps.net",\r\nFT_IPXNET, BASE_NONE, NULL, 0x0,\r\n"Scope", HFILL }},\r\n{ &hf_ndps_node,\r\n{ "Node", "ndps.node",\r\nFT_ETHER, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_socket,\r\n{ "IPX Socket", "ndps.socket",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_port,\r\n{ "IP Port", "ndps.port",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_ip,\r\n{ "IP Address", "ndps.ip",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_server_type,\r\n{ "NDPS Server Type", "ndps.server_type",\r\nFT_UINT32, BASE_HEX, VALS(ndps_server_type_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_num_services,\r\n{ "Number of Services", "ndps.num_services",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_service_type,\r\n{ "NDPS Service Type", "ndps.service_type",\r\nFT_UINT32, BASE_HEX, VALS(ndps_service_type_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_service_enabled,\r\n{ "Service Enabled?", "ndps.service_enabled",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_method_name,\r\n{ "Method Name", "ndps.method_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_method_ver,\r\n{ "Method Version", "ndps.method_ver",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_file_name,\r\n{ "File Name", "ndps.file_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_admin_submit,\r\n{ "Admin Submit Flag?", "ndps.admin_submit_flag",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_oid,\r\n{ "Object ID", "ndps.oid",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_object_op,\r\n{ "Operation", "ndps.object_op",\r\nFT_UINT32, BASE_HEX, VALS(ndps_object_op_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_answer_time,\r\n{ "Answer Time", "ndps.answer_time",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_oid_asn1_type,\r\n{ "ASN.1 Type", "ndps.asn1_type",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_item_ptr,\r\n{ "Item Pointer", "ndps.item_ptr",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_len,\r\n{ "Length", "ndps.len",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_limit_enc,\r\n{ "Limit Encountered", "ndps.limit_enc",\r\nFT_UINT32, BASE_HEX, VALS(ndps_limit_enc_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_delivery_add_count,\r\n{ "Number of Delivery Addresses", "ndps.delivery_add_count",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_delivery_add_type,\r\n{ "Delivery Address Type", "ndps.delivery_add_type",\r\nFT_UINT32, BASE_HEX, VALS(ndps_delivery_add_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_criterion_type,\r\n{ "Criterion Type", "ndps.criterion_type",\r\nFT_UINT32, BASE_HEX | BASE_EXT_STRING, &ndps_attribute_enum_ext, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_num_ignored_attributes,\r\n{ "Number of Ignored Attributes", "ndps.num_ignored_attributes",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_ignored_type,\r\n{ "Ignored Type", "ndps.ignored_type",\r\nFT_UINT32, BASE_HEX | BASE_EXT_STRING, &ndps_attribute_enum_ext, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_num_resources,\r\n{ "Number of Resources", "ndps.num_resources",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_resource_type,\r\n{ "Resource Type", "ndps.resource_type",\r\nFT_UINT32, BASE_HEX, VALS(ndps_resource_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_identifier_type,\r\n{ "Identifier Type", "ndps.identifier_type",\r\nFT_UINT32, BASE_HEX, VALS(ndps_identifier_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_page_flag,\r\n{ "Page Flag", "ndps.page_flag",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_media_type,\r\n{ "Media Type", "ndps.media_type",\r\nFT_UINT32, BASE_HEX, VALS(ndps_media_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_page_size,\r\n{ "Page Size", "ndps.page_size",\r\nFT_UINT32, BASE_HEX, VALS(ndps_page_size_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_direction,\r\n{ "Direction", "ndps.direction",\r\nFT_UINT32, BASE_HEX | BASE_EXT_STRING, &ndps_pres_direction_enum_ext, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_page_order,\r\n{ "Page Order", "ndps.page_order",\r\nFT_UINT32, BASE_HEX, VALS(ndps_page_order_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_medium_size,\r\n{ "Medium Size", "ndps.medium_size",\r\nFT_UINT32, BASE_HEX, VALS(ndps_medium_size_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_long_edge_feeds,\r\n{ "Long Edge Feeds?", "ndps.long_edge_feeds",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_inc_across_feed,\r\n{ "Increment Across Feed", "ndps.inc_across_feed",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_size_inc_in_feed,\r\n{ "Size Increment in Feed", "ndps.size_inc_in_feed",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_page_orientation,\r\n{ "Page Orientation", "ndps.page_orientation",\r\nFT_UINT32, BASE_HEX, VALS(ndps_page_orientation_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_numbers_up,\r\n{ "Numbers Up", "ndps.numbers_up",\r\nFT_UINT32, BASE_HEX, VALS(ndps_numbers_up_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_xdimension,\r\n{ "X Dimension", "ndps.xdimension",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_ydimension,\r\n{ "Y Dimension", "ndps.ydimension",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_state_severity,\r\n{ "State Severity", "ndps.state_severity",\r\nFT_UINT32, BASE_HEX, VALS(ndps_state_severity_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_training,\r\n{ "Training", "ndps.training",\r\nFT_UINT32, BASE_HEX, VALS(ndps_training_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_colorant_set,\r\n{ "Colorant Set", "ndps.colorant_set",\r\nFT_UINT32, BASE_HEX, VALS(ndps_colorant_set_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_card_enum_time,\r\n{ "Cardinal, Enum, or Time", "ndps.card_enum_time",\r\nFT_UINT32, BASE_HEX, VALS(ndps_card_enum_time_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_attrs_arg,\r\n{ "List Attribute Operation", "ndps.attrs_arg",\r\nFT_UINT32, BASE_HEX, VALS(ndps_attrs_arg_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_context_len,\r\n{ "Context Length", "ndps.context_len",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_context,\r\n{ "Context", "ndps.context",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_filter,\r\n{ "Filter Type", "ndps.filter",\r\nFT_UINT32, BASE_HEX, VALS(ndps_filter_enum), 0x0,\r\nNULL, HFILL }},\r\n#if 0\r\n{ &hf_ndps_item_filter,\r\n{ "Filter Item Operation", "ndps.filter_item",\r\nFT_UINT32, BASE_HEX, VALS(ndps_filter_item_enum), 0x0,\r\nNULL, HFILL }},\r\n#endif\r\n#if 0\r\n{ &hf_ndps_substring_match,\r\n{ "Substring Match", "ndps.substring_match",\r\nFT_UINT32, BASE_HEX, VALS(ndps_match_criteria_enum), 0x0,\r\nNULL, HFILL }},\r\n#endif\r\n{ &hf_ndps_time_limit,\r\n{ "Time Limit", "ndps.time_limit",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_count_limit,\r\n{ "Count Limit", "ndps.count_limit",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_operator,\r\n{ "Operator Type", "ndps.operator",\r\nFT_UINT32, BASE_DEC, VALS(ndps_operator_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_password,\r\n{ "Password", "ndps.password",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_retrieve_restrictions,\r\n{ "Retrieve Restrictions", "ndps.ret_restrict",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_bind_security_option_count,\r\n{ "Number of Bind Security Options", "ndps.bind_security_count",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_bind_security,\r\n{ "Bind Security Options", "ndps.bind_security",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_max_items,\r\n{ "Maximum Items in List", "ndps.max_items",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_status_flags,\r\n{ "Status Flag", "ndps.status_flags",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_resource_list_type,\r\n{ "Resource Type", "ndps.resource_type",\r\nFT_UINT32, BASE_DEC | BASE_EXT_STRING, &ndps_resource_type_enum_ext, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_os_count,\r\n{ "Number of OSes", "ndps.os_count",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_os_type,\r\n{ "OS Type", "ndps.os_type",\r\nFT_UINT32, BASE_DEC | BASE_EXT_STRING, &ndps_os_type_enum_ext, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_printer_type_count,\r\n{ "Number of Printer Types", "ndps.printer_type_count",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_printer_type,\r\n{ "Printer Type", "ndps.prn_type",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_printer_manuf,\r\n{ "Printer Manufacturer", "ndps.prn_manuf",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_inf_file_name,\r\n{ "INF File Name", "ndps.inf_file_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_vendor_dir,\r\n{ "Vendor Directory", "ndps.vendor_dir",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_banner_type,\r\n{ "Banner Type", "ndps.banner_type",\r\nFT_UINT32, BASE_DEC, VALS(ndps_banner_type_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_font_type,\r\n{ "Font Type", "ndps.font_type",\r\nFT_UINT32, BASE_DEC, VALS(ndps_font_type_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_printer_id,\r\n{ "Printer ID", "ndps.printer_id",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_font_name,\r\n{ "Font Name", "ndps.font_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_return_code,\r\n{ "Return Code", "ndps.ret_code",\r\nFT_UINT32, BASE_HEX | BASE_EXT_STRING, &ndps_error_types_ext, 0x0,\r\nNULL, HFILL }},\r\n#if 0\r\n{ &hf_ndps_banner_count,\r\n{ "Number of Banners", "ndps.banner_count",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n#endif\r\n{ &hf_ndps_banner_name,\r\n{ "Banner Name", "ndps.banner_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_font_type_count,\r\n{ "Number of Font Types", "ndps.font_type_count",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_font_type_name,\r\n{ "Font Type Name", "ndps.font_type_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_font_file_count,\r\n{ "Number of Font Files", "ndps.font_file_count",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_font_file_name,\r\n{ "Font File Name", "ndps.font_file_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_printer_def_count,\r\n{ "Number of Printer Definitions", "ndps.printer_def_count",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_prn_file_name,\r\n{ "Printer File Name", "ndps.print_file_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_prn_dir_name,\r\n{ "Printer Directory Name", "ndps.print_dir_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_def_file_name,\r\n{ "Printer Definition Name", "ndps.print_def_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_num_win31_keys,\r\n{ "Number of Windows 3.1 Keys", "ndps.num_win31_keys",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_num_win95_keys,\r\n{ "Number of Windows 95 Keys", "ndps.num_win95_keys",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_num_windows_keys,\r\n{ "Number of Windows Keys", "ndps.num_windows_keys",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_windows_key,\r\n{ "Windows Key", "ndps.windows_key",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_archive_type,\r\n{ "Archive Type", "ndps.archive_type",\r\nFT_UINT32, BASE_DEC, VALS(ndps_archive_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_archive_file_size,\r\n{ "Archive File Size", "ndps.archive_size",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_segment_overlap,\r\n{ "Segment overlap", "ndps.segment.overlap", FT_BOOLEAN, BASE_NONE,\r\nNULL, 0x0, "Segment overlaps with other segments", HFILL }},\r\n{ &hf_ndps_segment_overlap_conflict,\r\n{ "Conflicting data in segment overlap", "ndps.segment.overlap.conflict",\r\nFT_BOOLEAN, BASE_NONE,\r\nNULL, 0x0, "Overlapping segments contained conflicting data", HFILL }},\r\n{ &hf_ndps_segment_multiple_tails,\r\n{ "Multiple tail segments found", "ndps.segment.multipletails",\r\nFT_BOOLEAN, BASE_NONE,\r\nNULL, 0x0, "Several tails were found when desegmenting the packet", HFILL }},\r\n{ &hf_ndps_segment_too_long_segment,\r\n{ "Segment too long", "ndps.segment.toolongsegment", FT_BOOLEAN, BASE_NONE,\r\nNULL, 0x0, "Segment contained data past end of packet", HFILL }},\r\n{ &hf_ndps_segment_error,\r\n{"Desegmentation error", "ndps.segment.error", FT_FRAMENUM, BASE_NONE,\r\nNULL, 0x0, "Desegmentation error due to illegal segments", HFILL }},\r\n{ &hf_ndps_segment_count,\r\n{"Segment count", "ndps.segment.count", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL }},\r\n{ &hf_ndps_reassembled_length,\r\n{"Reassembled NDPS length", "ndps.reassembled.length", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, "The total length of the reassembled payload", HFILL }},\r\n{ &hf_ndps_segment,\r\n{ "NDPS Fragment", "ndps.fragment", FT_FRAMENUM, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL }},\r\n{ &hf_ndps_segments,\r\n{ "NDPS Fragments", "ndps.fragments", FT_NONE, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL }},\r\n{ &hf_ndps_data,\r\n{ "Data", "ndps.data", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL }},\r\n{ &hf_get_status_flag,\r\n{ "Get Status Flag", "ndps.get_status_flags",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_res_type,\r\n{ "Resource Type", "ndps.res_type",\r\nFT_UINT32, BASE_DEC, VALS(ndps_res_type_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_file_timestamp,\r\n{ "File Time Stamp", "ndps.file_time_stamp",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_print_arg,\r\n{ "Print Type", "ndps.print_arg",\r\nFT_UINT32, BASE_DEC, VALS(ndps_print_arg_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_sub_complete,\r\n{ "Submission Complete?", "ndps.sub_complete", FT_BOOLEAN, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL }},\r\n{ &hf_doc_content,\r\n{ "Document Content", "ndps.doc_content",\r\nFT_UINT32, BASE_DEC, VALS(ndps_doc_content_enum), 0x0,\r\nNULL, HFILL }},\r\n#if 0\r\n{ &hf_ndps_doc_name,\r\n{ "Document Name", "ndps.doc_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n#endif\r\n{ &hf_local_id,\r\n{ "Local ID", "ndps.local_id",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_included_doc_len,\r\n{ "Included Document Length", "ndps.included_doc_len",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_included_doc,\r\n{ "Included Document", "ndps.included_doc",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_ref_name,\r\n{ "Referenced Document Name", "ndps.ref_doc_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_interrupt_job_type,\r\n{ "Interrupt Job Identifier", "ndps.interrupt_job_type",\r\nFT_UINT32, BASE_DEC, VALS(ndps_interrupt_job_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_pause_job_type,\r\n{ "Pause Job Identifier", "ndps.pause_job_type",\r\nFT_UINT32, BASE_DEC, VALS(ndps_pause_job_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_force,\r\n{ "Force?", "ndps.force",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_resubmit_op_type,\r\n{ "Resubmit Operation Type", "ndps.resubmit_op_type",\r\nFT_UINT32, BASE_DEC, VALS(ndps_resubmit_op_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_shutdown_type,\r\n{ "Shutdown Type", "ndps.shutdown_type",\r\nFT_UINT32, BASE_DEC, VALS(ndps_shutdown_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_supplier_flag,\r\n{ "Supplier Data?", "ndps.supplier_flag",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_language_flag,\r\n{ "Language Data?", "ndps.language_flag",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_method_flag,\r\n{ "Method Data?", "ndps.method_flag",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_delivery_address_flag,\r\n{ "Delivery Address Data?", "ndps.delivery_flag",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_list_profiles_type,\r\n{ "List Profiles Type", "ndps.list_profiles_type",\r\nFT_UINT32, BASE_HEX, VALS(ndps_attrs_arg_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_list_profiles_choice_type,\r\n{ "List Profiles Choice Type", "ndps.list_profiles_choice_type",\r\nFT_UINT32, BASE_HEX, VALS(ndps_list_profiles_choice_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_list_profiles_result_type,\r\n{ "List Profiles Result Type", "ndps.list_profiles_result_type",\r\nFT_UINT32, BASE_HEX, VALS(ndps_list_profiles_result_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_integer_type_flag,\r\n{ "Integer Type Flag", "ndps.integer_type_flag",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_integer_type_value,\r\n{ "Integer Type Value", "ndps.integer_type_value",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_continuation_option,\r\n{ "Continuation Option", "ndps.continuation_option",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_ds_info_type,\r\n{ "DS Info Type", "ndps.ds_info_type",\r\nFT_UINT32, BASE_HEX, VALS(ndps_ds_info_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_guid,\r\n{ "GUID", "ndps.guid",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_list_services_type,\r\n{ "Services Type", "ndps.list_services_type",\r\nFT_UINT32, BASE_HEX, VALS(ndps_list_services_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_item_bytes,\r\n{ "Item Ptr", "ndps.item_bytes",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_certified,\r\n{ "Certified", "ndps.certified",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_attribute_set,\r\n{ "Attribute Set", "ndps.attribute_set",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_data_item_type,\r\n{ "Item Type", "ndps.data_item_type",\r\nFT_UINT32, BASE_HEX, VALS(ndps_data_item_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_info_int,\r\n{ "Integer Value", "ndps.info_int",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_info_int16,\r\n{ "16 Bit Integer Value", "ndps.info_int16",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_info_int32,\r\n{ "32 Bit Integer Value", "ndps.info_int32",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_info_boolean,\r\n{ "Boolean Value", "ndps.info_boolean",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_info_string,\r\n{ "String Value", "ndps.info_string",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n#if 0\r\n{ &hf_info_bytes,\r\n{ "Byte Value", "ndps.info_bytes",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n#endif\r\n{ &hf_ndps_list_local_servers_type,\r\n{ "Server Type", "ndps.list_local_server_type",\r\nFT_UINT32, BASE_HEX, VALS(ndps_list_local_servers_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_registry_name,\r\n{ "Registry Name", "ndps.registry_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_client_server_type,\r\n{ "Client/Server Type", "ndps.client_server_type",\r\nFT_UINT32, BASE_HEX, VALS(ndps_client_server_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_session_type,\r\n{ "Session Type", "ndps.session_type",\r\nFT_UINT32, BASE_HEX, VALS(ndps_session_type_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_time,\r\n{ "Time", "ndps.time",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_supplier_name,\r\n{ "Supplier Name", "ndps.supplier_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_message,\r\n{ "Message", "ndps.message",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_delivery_method_count,\r\n{ "Number of Delivery Methods", "ndps.delivery_method_count",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_delivery_method_type,\r\n{ "Delivery Method Type", "ndps.delivery_method_type",\r\nFT_UINT32, BASE_HEX, VALS(ndps_delivery_method_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_get_session_type,\r\n{ "Session Type", "ndps.get_session_type",\r\nFT_UINT32, BASE_HEX, VALS(ndps_get_session_type_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_packet_count,\r\n{ "Packet Count", "ndps.packet_count",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_last_packet_flag,\r\n{ "Last Packet Flag", "ndps.last_packet_flag",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_get_resman_session_type,\r\n{ "Session Type", "ndps.get_resman_session_type",\r\nFT_UINT32, BASE_HEX, VALS(ndps_get_resman_session_type_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_problem_type,\r\n{ "Problem Type", "ndps.problem_type",\r\nFT_UINT32, BASE_HEX, VALS(problem_type_enum), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_num_values,\r\n{ "Number of Values", "ndps.num_values",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_ndps_object_ids_7,\r\n{ "Object ID Definition", "ndps.objectid_def7",\r\nFT_UINT32, BASE_DEC, NULL,\r\n0x0, NULL, HFILL }},\r\n{ &hf_ndps_object_ids_8,\r\n{ "Object ID Definition", "ndps.objectid_def8",\r\nFT_UINT32, BASE_DEC, NULL,\r\n0x0, NULL, HFILL }},\r\n{ &hf_ndps_object_ids_9,\r\n{ "Object ID Definition", "ndps.objectid_def9",\r\nFT_UINT32, BASE_DEC, NULL,\r\n0x0, NULL, HFILL }},\r\n{ &hf_ndps_object_ids_10,\r\n{ "Object ID Definition", "ndps.objectid_def10",\r\nFT_UINT32, BASE_DEC, NULL,\r\n0x0, NULL, HFILL }},\r\n{ &hf_ndps_object_ids_11,\r\n{ "Object ID Definition", "ndps.objectid_def11",\r\nFT_UINT32, BASE_DEC, NULL,\r\n0x0, NULL, HFILL }},\r\n{ &hf_ndps_object_ids_12,\r\n{ "Object ID Definition", "ndps.objectid_def12",\r\nFT_UINT32, BASE_DEC, NULL,\r\n0x0, NULL, HFILL }},\r\n{ &hf_ndps_object_ids_13,\r\n{ "Object ID Definition", "ndps.objectid_def13",\r\nFT_UINT32, BASE_DEC, NULL,\r\n0x0, NULL, HFILL }},\r\n{ &hf_ndps_object_ids_14,\r\n{ "Object ID Definition", "ndps.objectid_def14",\r\nFT_UINT32, BASE_DEC, NULL,\r\n0x0, NULL, HFILL }},\r\n{ &hf_ndps_object_ids_15,\r\n{ "Object ID Definition", "ndps.objectid_def15",\r\nFT_UINT32, BASE_DEC, NULL,\r\n0x0, NULL, HFILL }},\r\n{ &hf_ndps_object_ids_16,\r\n{ "Object ID Definition", "ndps.objectid_def16",\r\nFT_UINT32, BASE_DEC, NULL,\r\n0x0, NULL, HFILL }},\r\n#if 0\r\n{ &hf_ndps_attribute_time,\r\n{ "Time", "ndps.attribute_time",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_LOCAL, NULL, 0x0,\r\nNULL, HFILL }},\r\n#endif\r\n{ &hf_print_security,\r\n{ "Printer Security", "ndps.print_security",\r\nFT_UINT32, BASE_HEX, VALS(ndps_print_security), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_notify_time_interval,\r\n{ "Notify Time Interval", "ndps.notify_time_interval",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_notify_sequence_number,\r\n{ "Notify Sequence Number", "ndps.notify_seq_number",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_notify_lease_exp_time,\r\n{ "Notify Lease Expiration Time", "ndps.notify_lease_exp_time",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_notify_printer_uri,\r\n{ "Notify Printer URI", "ndps.notify_printer_uri",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_level,\r\n{ "Level", "ndps.level",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_interval,\r\n{ "Interval", "ndps.interval",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_ndps,\r\n&ett_ndps_segments,\r\n&ett_ndps_segment,\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_ndps_problem_type, { "ndps.problem_type.expert", PI_RESPONSE_CODE, PI_NOTE, "Fault", EXPFILL }},\r\n{ &ei_ndps_return_code, { "ndps.return_code.expert", PI_RESPONSE_CODE, PI_NOTE, "Fault", EXPFILL }},\r\n{ &ei_ndps_rpc_acc_stat, { "ndps.rpc_acc_stat.expert", PI_RESPONSE_CODE, PI_NOTE, "Fault", EXPFILL }},\r\n{ &ei_ndps_truncated, { "ndps.truncated", PI_PROTOCOL, PI_WARN, "Truncated", EXPFILL }},\r\n};\r\nmodule_t *ndps_module;\r\nexpert_module_t* expert_ndps;\r\nproto_ndps = proto_register_protocol("Novell Distributed Print System", "NDPS", "ndps");\r\nproto_register_field_array(proto_ndps, hf_ndps, array_length(hf_ndps));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_ndps = expert_register_protocol(proto_ndps);\r\nexpert_register_field_array(expert_ndps, ei, array_length(ei));\r\nndps_module = prefs_register_protocol(proto_ndps, NULL);\r\nprefs_register_bool_preference(ndps_module, "desegment_tcp",\r\n"Reassemble NDPS messages spanning multiple TCP segments",\r\n"Whether the NDPS dissector should reassemble messages spanning multiple TCP segments."\r\n" To use this option, you must also enable \"Allow subdissectors to reassemble TCP streams\" in the TCP protocol settings.",\r\n&ndps_desegment);\r\nprefs_register_bool_preference(ndps_module, "desegment_spx",\r\n"Reassemble fragmented NDPS messages spanning multiple SPX packets",\r\n"Whether the NDPS dissector should reassemble fragmented NDPS messages spanning multiple SPX packets",\r\n&ndps_defragment);\r\nprefs_register_bool_preference(ndps_module, "show_oid",\r\n"Display NDPS Details",\r\n"Whether or not the NDPS dissector should show object id's and other details",\r\n&ndps_show_oids);\r\nregister_init_routine(&ndps_init_protocol);\r\nregister_cleanup_routine(&ndps_cleanup_protocol);\r\nregister_postseq_cleanup_routine(&ndps_postseq_cleanup);\r\n}\r\nvoid\r\nproto_reg_handoff_ndps(void)\r\n{\r\ndissector_handle_t ndps_handle, ndps_tcp_handle;\r\nndps_handle = create_dissector_handle(dissect_ndps_ipx, proto_ndps);\r\nndps_tcp_handle = create_dissector_handle(dissect_ndps_tcp, proto_ndps);\r\ndissector_add_uint("spx.socket", SPX_SOCKET_PA, ndps_handle);\r\ndissector_add_uint("spx.socket", SPX_SOCKET_BROKER, ndps_handle);\r\ndissector_add_uint("spx.socket", SPX_SOCKET_SRS, ndps_handle);\r\ndissector_add_uint("spx.socket", SPX_SOCKET_ENS, ndps_handle);\r\ndissector_add_uint("spx.socket", SPX_SOCKET_RMS, ndps_handle);\r\ndissector_add_uint("spx.socket", SPX_SOCKET_NOTIFY_LISTENER, ndps_handle);\r\ndissector_add_uint("tcp.port", TCP_PORT_PA, ndps_tcp_handle);\r\ndissector_add_uint("tcp.port", TCP_PORT_BROKER, ndps_tcp_handle);\r\ndissector_add_uint("tcp.port", TCP_PORT_SRS, ndps_tcp_handle);\r\ndissector_add_uint("tcp.port", TCP_PORT_ENS, ndps_tcp_handle);\r\ndissector_add_uint("tcp.port", TCP_PORT_RMS, ndps_tcp_handle);\r\ndissector_add_uint("tcp.port", TCP_PORT_NOTIFY_LISTENER, ndps_tcp_handle);\r\n}
