static itl_nexus_t *\r\nget_itl_nexus(packet_info *pinfo)\r\n{\r\nitl_nexus_t *itl = NULL;\r\nif (!(itl = (itl_nexus_t *)wmem_tree_lookup32_le(rsvd_conv_data->itl, pinfo->num))) {\r\nitl = wmem_new(wmem_file_scope(), itl_nexus_t);\r\nitl->cmdset = 0xff;\r\nitl->conversation = rsvd_conv_data->conversation;\r\nwmem_tree_insert32(rsvd_conv_data->itl, pinfo->num, itl);\r\n}\r\nreturn itl;\r\n}\r\nstatic int\r\ndissect_RSVD_GET_FILE_INFO(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *parent_tree, int offset, gint16 len, gboolean request)\r\n{\r\nif (!request) {\r\nproto_tree *gfi_sub_tree;\r\nproto_item *gfi_sub_item _U_;\r\ngfi_sub_tree = proto_tree_add_subtree(parent_tree, tvb, offset, len, ett_svhdx_tunnel_op_header, &gfi_sub_item, "RSVD_TUNNEL_GET_FILE_INFO_RESPONSE");\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_file_info_server_version, tvb, offset, 4, ENC_LITTLE_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_file_info_sector_size, tvb, offset, 4, ENC_LITTLE_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_file_info_physical_sector_size, tvb, offset, 4, ENC_LITTLE_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_file_info_reserved, tvb, offset, 4, ENC_LITTLE_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_file_info_virtual_size, tvb, offset, 8, ENC_LITTLE_ENDIAN);\r\noffset += 8;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_RSVD_TUNNEL_SCSI(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *parent_tree, int offset, gint16 len, gboolean request, guint64 request_id)\r\n{\r\nproto_tree *sub_tree;\r\nproto_item *sub_item;\r\nguint32 cdb_length;\r\nguint32 data_transfer_length;\r\nguint32 sense_info_ex_length;\r\nconversation_t *conversation;\r\nconversation = find_or_create_conversation(pinfo);\r\nrsvd_conv_data = (rsvd_conv_data_t *)conversation_get_proto_data(conversation, proto_rsvd);\r\nif (!rsvd_conv_data) {\r\nrsvd_conv_data = wmem_new(wmem_file_scope(), rsvd_conv_data_t);\r\nrsvd_conv_data->tasks = wmem_map_new(wmem_file_scope(),\r\nwmem_int64_hash,\r\ng_int64_equal);\r\nrsvd_conv_data->itl = wmem_tree_new(wmem_file_scope());\r\nrsvd_conv_data->conversation = conversation;\r\nconversation_add_proto_data(conversation, proto_rsvd, rsvd_conv_data);\r\n}\r\nrsvd_conv_data->task = NULL;\r\nif (!pinfo->fd->flags.visited) {\r\nguint64 *key_copy = wmem_new(wmem_file_scope(), guint64);\r\n*key_copy = request_id;\r\nrsvd_conv_data->task = wmem_new(wmem_file_scope(), rsvd_task_data_t);\r\nrsvd_conv_data->task->request_frame=pinfo->num;\r\nrsvd_conv_data->task->response_frame=0;\r\nrsvd_conv_data->task->itlq = NULL;\r\nwmem_map_insert(rsvd_conv_data->tasks, (const void *)key_copy,\r\nrsvd_conv_data->task);\r\n} else {\r\nrsvd_conv_data->task = (rsvd_task_data_t *)wmem_map_lookup(rsvd_conv_data->tasks, (const void *)&request_id);\r\n}\r\nsub_tree = proto_tree_add_subtree_format(parent_tree, tvb, offset, len, ett_svhdx_tunnel_scsi_request, &sub_item, "SVHDX_TUNNEL_SCSI_%s", (request ? "REQUEST" : "RESPONSE"));\r\nif (request) {\r\ntvbuff_t *scsi_cdb = NULL;\r\nproto_tree_add_item(sub_tree, hf_svhdx_tunnel_scsi_length, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(sub_tree, hf_svhdx_tunnel_scsi_reserved1, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\noffset += 2;\r\ncdb_length = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(sub_tree, hf_svhdx_tunnel_scsi_cdb_length, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sub_tree, hf_svhdx_tunnel_scsi_sense_info_ex_length, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sub_tree, hf_svhdx_tunnel_scsi_data_in, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sub_tree, hf_svhdx_tunnel_scsi_reserved2, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sub_tree, hf_svhdx_tunnel_scsi_srb_flags, tvb, offset, 4, ENC_LITTLE_ENDIAN);\r\noffset += 4;\r\ndata_transfer_length = tvb_get_letohl(tvb, offset);\r\nproto_tree_add_item(sub_tree, hf_svhdx_tunnel_scsi_data_transfer_length, tvb, offset, 4, ENC_LITTLE_ENDIAN);\r\noffset += 4;\r\nscsi_cdb = tvb_new_subset(tvb,\r\noffset,\r\ncdb_length,\r\ntvb_reported_length_remaining(tvb, offset));\r\nproto_tree_add_item(sub_tree, hf_svhdx_tunnel_scsi_cdb, tvb, offset, cdb_length, ENC_NA);\r\noffset += cdb_length;\r\nproto_tree_add_item(sub_tree, hf_svhdx_tunnel_scsi_reserved3, tvb, offset, 4, ENC_LITTLE_ENDIAN);\r\noffset += 4;\r\nif (data_transfer_length) {\r\nproto_tree_add_item(sub_tree, hf_svhdx_tunnel_scsi_data, tvb, offset, data_transfer_length, ENC_NA);\r\noffset += data_transfer_length;\r\n}\r\nif (rsvd_conv_data->task && !rsvd_conv_data->task->itlq) {\r\nrsvd_conv_data->task->itlq = wmem_new(wmem_file_scope(),\r\nitlq_nexus_t);\r\nrsvd_conv_data->task->itlq->first_exchange_frame = pinfo->num;\r\nrsvd_conv_data->task->itlq->last_exchange_frame = 0;\r\nrsvd_conv_data->task->itlq->lun = 0xffff;\r\nrsvd_conv_data->task->itlq->scsi_opcode = 0xffff;\r\nrsvd_conv_data->task->itlq->task_flags = 0;\r\nrsvd_conv_data->task->itlq->data_length = 0;\r\nrsvd_conv_data->task->itlq->bidir_data_length = 0;\r\nrsvd_conv_data->task->itlq->flags = 0;\r\nrsvd_conv_data->task->itlq->alloc_len = 0;\r\nrsvd_conv_data->task->itlq->fc_time = pinfo->abs_ts;\r\nrsvd_conv_data->task->itlq->extra_data = NULL;\r\n}\r\nif (rsvd_conv_data->task && rsvd_conv_data->task->itlq) {\r\ndissect_scsi_cdb(scsi_cdb, pinfo, top_tree, SCSI_DEV_SMC, rsvd_conv_data->task->itlq, get_itl_nexus(pinfo));\r\n}\r\n} else {\r\nguint8 scsi_status = 0;\r\nproto_tree_add_item(sub_tree, hf_svhdx_tunnel_scsi_length, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(sub_tree, hf_svhdx_tunnel_scsi_auto_generated_sense, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bits_item(sub_tree, hf_svhdx_tunnel_scsi_srb_status, tvb, offset * 8 + 1, 7, ENC_BIG_ENDIAN);\r\noffset++;\r\nscsi_status = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(sub_tree, hf_svhdx_tunnel_scsi_status, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sub_tree, hf_svhdx_tunnel_scsi_cdb_length, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset++;\r\nsense_info_ex_length = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(sub_tree, hf_svhdx_tunnel_scsi_sense_info_ex_length, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sub_tree, hf_svhdx_tunnel_scsi_data_in, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sub_tree, hf_svhdx_tunnel_scsi_reserved2, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sub_tree, hf_svhdx_tunnel_scsi_srb_flags, tvb, offset, 4, ENC_LITTLE_ENDIAN);\r\noffset += 4;\r\ndata_transfer_length = tvb_get_letohl(tvb, offset);\r\nproto_tree_add_item(sub_tree, hf_svhdx_tunnel_scsi_data_transfer_length, tvb, offset, 4, ENC_LITTLE_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(sub_tree, hf_svhdx_tunnel_scsi_sense_data_ex, tvb, offset, sense_info_ex_length, ENC_NA);\r\noffset += sense_info_ex_length;\r\nif (data_transfer_length) {\r\ntvbuff_t *data_tvb = NULL;\r\nint tvb_len, tvb_rlen;\r\ntvb_len = tvb_captured_length_remaining(tvb, offset);\r\nif (tvb_len > (int)data_transfer_length)\r\ntvb_len = data_transfer_length;\r\ntvb_rlen = tvb_reported_length_remaining(tvb, offset);\r\nif (tvb_rlen > (int)data_transfer_length)\r\ntvb_rlen = data_transfer_length;\r\ndata_tvb = tvb_new_subset(tvb, offset, tvb_len, tvb_rlen);\r\nif (rsvd_conv_data->task && rsvd_conv_data->task->itlq) {\r\nrsvd_conv_data->task->itlq->task_flags = SCSI_DATA_READ |\r\nSCSI_DATA_WRITE;\r\nrsvd_conv_data->task->itlq->data_length = data_transfer_length;\r\nrsvd_conv_data->task->itlq->bidir_data_length = data_transfer_length;\r\ndissect_scsi_payload(data_tvb, pinfo, top_tree, request,\r\nrsvd_conv_data->task->itlq,\r\nget_itl_nexus(pinfo), 0);\r\n}\r\nproto_tree_add_item(sub_tree, hf_svhdx_tunnel_scsi_data, tvb, offset, data_transfer_length, ENC_NA);\r\noffset += data_transfer_length;\r\n}\r\nif (rsvd_conv_data->task && rsvd_conv_data->task->itlq) {\r\ndissect_scsi_rsp(tvb, pinfo, top_tree, rsvd_conv_data->task->itlq, get_itl_nexus(pinfo), scsi_status);\r\n}\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_RSVD_SRB_STATUS(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *parent_tree, int offset, gint16 len, gboolean request)\r\n{\r\nif (request) {\r\nproto_tree *gfi_sub_tree _U_;\r\nproto_item *gfi_sub_item _U_;\r\ngfi_sub_tree = proto_tree_add_subtree(parent_tree, tvb, offset, len, ett_svhdx_tunnel_op_header, &gfi_sub_item, "RSVD_TUNNEL_SRB_STATUS_REQUEST");\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_srb_status_status_key, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_srb_status_reserved, tvb, offset, 1, ENC_NA);\r\noffset += 27;\r\n} else {\r\nproto_tree *gfi_sub_tree _U_;\r\nproto_item *gfi_sub_item _U_;\r\nguint8 sense_info_length;\r\ngfi_sub_tree = proto_tree_add_subtree(parent_tree, tvb, offset, len, ett_svhdx_tunnel_op_header, &gfi_sub_item, "RSVD_TUNNEL_SRB_STATUS_RESPONSE");\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_srb_status_status_key, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_srb_status_sense_info_auto_generated, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bits_item(gfi_sub_tree, hf_svhdx_tunnel_srb_status_srb_status, tvb, offset * 8 + 1, 7, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_srb_status_scsi_status, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset += 1;\r\nsense_info_length = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_srb_status_sense_info_ex_length, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_srb_status_sense_data_ex, tvb, offset, sense_info_length, ENC_NA);\r\noffset += sense_info_length;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_RSVD_GET_DISK_INFO(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *parent_tree, int offset, gint16 len, gboolean request)\r\n{\r\nif (request) {\r\nproto_tree *gfi_sub_tree _U_;\r\nproto_item *gfi_sub_item _U_;\r\ngfi_sub_tree = proto_tree_add_subtree(parent_tree, tvb, offset, len, ett_svhdx_tunnel_op_header, &gfi_sub_item, "RSVD_TUNNEL_GET_DISK_INFO_REQUEST");\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_disk_info_reserved1, tvb, offset, 8, ENC_LITTLE_ENDIAN);\r\noffset += 8;\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_disk_info_blocksize, tvb, offset, 4, ENC_LITTLE_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_disk_info_linkage_id, tvb, offset, 16, ENC_NA);\r\noffset += 16;\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_disk_info_is_mounted, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_disk_info_is_4k_aligned, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_disk_info_reserved, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_disk_info_file_size, tvb, offset, 8, ENC_LITTLE_ENDIAN);\r\noffset += 8;\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_disk_info_virtual_disk_id, tvb, offset, 16, ENC_NA);\r\noffset += 16;\r\n} else {\r\nproto_tree *gfi_sub_tree _U_;\r\nproto_item *gfi_sub_item _U_;\r\ngfi_sub_tree = proto_tree_add_subtree(parent_tree, tvb, offset, len, ett_svhdx_tunnel_op_header, &gfi_sub_item, "RSVD_TUNNEL_GET_DISK_INFO_RESPONSE");\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_disk_info_disk_type, tvb, offset, 4, ENC_LITTLE_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_disk_info_disk_format, tvb, offset, 4, ENC_LITTLE_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_disk_info_blocksize, tvb, offset, 4, ENC_LITTLE_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_disk_info_linkage_id, tvb, offset, 16, ENC_NA);\r\noffset += 16;\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_disk_info_is_mounted, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_disk_info_is_4k_aligned, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_disk_info_reserved, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_disk_info_file_size, tvb, offset, 8, ENC_LITTLE_ENDIAN);\r\noffset += 8;\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_disk_info_virtual_disk_id, tvb, offset, 16, ENC_NA);\r\noffset += 16;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_RSVD_VALIDATE_DISK(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *parent_tree, int offset, gint16 len, gboolean request)\r\n{\r\nif (request) {\r\nproto_tree *gfi_sub_tree _U_;\r\nproto_item *gfi_sub_item _U_;\r\ngfi_sub_tree = proto_tree_add_subtree(parent_tree, tvb, offset, len, ett_svhdx_tunnel_op_header, &gfi_sub_item, "RSVD_TUNNEL_VALIDATE_DISK_REQUEST");\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_validate_disk_reserved, tvb, offset, 56, ENC_NA);\r\noffset += 56;\r\n} else {\r\nproto_tree *gfi_sub_tree _U_;\r\nproto_item *gfi_sub_item _U_;\r\ngfi_sub_tree = proto_tree_add_subtree(parent_tree, tvb, offset, len, ett_svhdx_tunnel_op_header, &gfi_sub_item, "RSVD_TUNNEL_VALIDATE_DISK_RESPONSE");\r\nproto_tree_add_item(gfi_sub_tree, hf_svhdx_tunnel_validate_disk_is_valid_disk, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsvd(tvbuff_t *tvb, packet_info *pinfo, proto_tree *parent_tree, void *data)\r\n{\r\nguint32 header_bytes = 0;\r\nguint proto_id = 0;\r\nguint proto_version = 0;\r\nguint operation_code = 0;\r\nproto_item *ti;\r\nproto_tree *rsvd_tree;\r\nproto_item *sub_item;\r\nproto_tree *sub_tree;\r\nguint offset = 0;\r\nguint16 len;\r\nguint64 request_id = 0;\r\ngboolean request = *(gboolean *)data;\r\ntop_tree = parent_tree;\r\nlen = tvb_reported_length(tvb);\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "RSVD");\r\ncol_clear(pinfo->cinfo, COL_INFO);\r\nheader_bytes = tvb_get_letohl(tvb, 0);\r\nproto_id = header_bytes >> 24;\r\nproto_version = (header_bytes >> 12) & 0x0FFF;\r\noperation_code = header_bytes & 0x0FFF;\r\nti = proto_tree_add_item(parent_tree, proto_rsvd, tvb, offset, -1, ENC_NA);\r\nrsvd_tree = proto_item_add_subtree(ti, ett_rsvd);\r\nsub_tree = proto_tree_add_subtree(rsvd_tree, tvb, offset, len, ett_svhdx_tunnel_op_header, &sub_item, "SVHDX_TUNNEL_OPERATION_HEADER");\r\nproto_tree_add_uint(sub_tree, hf_svhdx_protocol_id, tvb, offset, 4, proto_id);\r\nproto_tree_add_uint(sub_tree, hf_svhdx_protocol_version, tvb, offset, 4, proto_version);\r\nproto_tree_add_uint(sub_tree, hf_svhdx_operation_code, tvb, offset, 4, operation_code);\r\noffset += 4;\r\nproto_tree_add_item(sub_tree, hf_svhdx_status, tvb, offset, 4, ENC_LITTLE_ENDIAN);\r\noffset += 4;\r\nrequest_id = tvb_get_ntoh64(tvb, offset);\r\nproto_tree_add_item(sub_tree, hf_svhdx_request_id, tvb, offset, 8, ENC_LITTLE_ENDIAN);\r\noffset += 8;\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s %s",\r\nval_to_str(operation_code,\r\nrsvd_operation_code_vals,\r\n"Unknown Operation Code (0x%03X)"),\r\nrequest ? "Request" : "Response");\r\nproto_item_append_text(ti, ", %s %s",\r\nval_to_str(operation_code,\r\nrsvd_operation_code_vals,\r\n"Unknown Operation Code (0x%03X)"),\r\nrequest ? "Request" : "Response");\r\nswitch (operation_code) {\r\ncase 0x001:\r\noffset += dissect_RSVD_GET_FILE_INFO(tvb, pinfo, rsvd_tree, offset, len - offset, request);\r\nbreak;\r\ncase 0x002:\r\noffset += dissect_RSVD_TUNNEL_SCSI(tvb, pinfo, rsvd_tree, offset, len - offset, request, request_id);\r\nbreak;\r\ncase 0x003:\r\nbreak;\r\ncase 0x004:\r\noffset += dissect_RSVD_SRB_STATUS(tvb, pinfo, rsvd_tree, offset, len - offset, request);\r\nbreak;\r\ncase 0x005:\r\noffset += dissect_RSVD_GET_DISK_INFO(tvb, pinfo, rsvd_tree, offset, len - offset, request);\r\nbreak;\r\ncase 0x006:\r\noffset += dissect_RSVD_VALIDATE_DISK(tvb, pinfo, rsvd_tree, offset, len - offset, request);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nreturn offset;\r\n}\r\nvoid\r\nproto_register_rsvd(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_svhdx_protocol_id,\r\n{ "ProtocolId", "rsvd.svhdx_protocol_id", FT_UINT8, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_protocol_version,\r\n{ "ProtocolVersion", "rsvd.svhdx_protocol_version", FT_UINT16, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_operation_code,\r\n{ "OperationCode", "rsvd.svhdx_operation_code", FT_UINT16, BASE_HEX,\r\nVALS(rsvd_operation_code_vals), 0, "Operation Code", HFILL }},\r\n{ &hf_svhdx_status,\r\n{ "Status", "rsvd.svhdx_status", FT_UINT32, BASE_HEX,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_request_id,\r\n{ "RequestId", "rsvd.svhdx_request_id", FT_UINT64, BASE_HEX,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_scsi_length,\r\n{ "Length", "rsvd.svhdx_length", FT_UINT16, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_scsi_reserved1,\r\n{ "Reserved1", "rsvd.svhdx_scsi_reserved1", FT_UINT16, BASE_HEX,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_scsi_cdb_length,\r\n{ "CDBLength", "rsvd.svhdx_scsi_cdb_length", FT_UINT8, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_scsi_sense_info_ex_length,\r\n{ "SenseInfoExLength", "rsvd.svhdx_scsi_sense_info_ex_length", FT_UINT8, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_scsi_data_in,\r\n{ "DataIn", "rsvd.svhdx_scsi_data_in", FT_BOOLEAN, 8,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_scsi_reserved2,\r\n{ "Reserved2", "rsvd.svhdx_scsi_reserved2", FT_UINT8, BASE_HEX,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_scsi_srb_flags,\r\n{ "SRBFlags", "rsvd.svhdx_scsi_srbflags", FT_UINT32, BASE_HEX,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_scsi_data_transfer_length,\r\n{ "DataTransferLength", "rsvd.svhdx_scsi_data_transfer_length", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_scsi_reserved3,\r\n{ "Reserved3", "rsvd.svhdx_scsi_reserved3", FT_UINT32, BASE_HEX,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_scsi_cdb,\r\n{ "CDB", "rsvd.svhdx_scsi_cdb", FT_BYTES, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_scsi_data,\r\n{"Data", "rsvd.svhdx_scsi_data", FT_BYTES, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_scsi_auto_generated_sense,\r\n{"AutoGeneratedSenseInfo", "rsvd.svhdx_auto_generated_sense_info", FT_UINT8, BASE_HEX,\r\nVALS(rsvd_sense_info_vals), 0x80, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_scsi_srb_status,\r\n{ "SrbStatus", "rsvd.svhdx_srb_status", FT_UINT8, BASE_HEX,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_scsi_status,\r\n{ "ScsiStatus", "rsvd.svhdx_scsi_status", FT_UINT8, BASE_HEX,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_scsi_sense_data_ex,\r\n{ "SenseDataEx", "rsvd.svhdx_scsi_sense_data_ex", FT_BYTES, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_file_info_server_version,\r\n{ "ServerVersion", "rsvd.svhdx_file_info_server_version", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_file_info_sector_size,\r\n{ "SectorSize", "rsvd.svhdx_file_info_sector_size", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_file_info_physical_sector_size,\r\n{ "PhysicalSectorSize", "rsvd.svhdx_file_info_physical_sector_size", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_file_info_reserved,\r\n{ "Reserved", "rsvd.svhdx_file_info_reserved", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_file_info_virtual_size,\r\n{ "VirtualSize", "rsvd.svhdx_file_info_virtual_size", FT_UINT64, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_disk_info_reserved1,\r\n{ "Reserved1", "rsvd.svhdx_disk_info_reserved1", FT_UINT64, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_disk_info_blocksize,\r\n{ "BlockSize", "rsvd.svhdx_disk_info_blocksize", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_disk_info_linkage_id,\r\n{ "LinkageID", "rsvd.svhdx_disk_info_linkage_id", FT_BYTES, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_disk_info_disk_type,\r\n{ "DiskType", "rsvd.svhdx_disk_info_disk_type", FT_UINT16, BASE_HEX,\r\nVALS(rsvd_disk_type_vals), 0, "Disk Type", HFILL }},\r\n{ &hf_svhdx_tunnel_disk_info_disk_format,\r\n{ "DiskFormat", "rsvd.svhdx_disk_info_disk_format", FT_UINT16, BASE_HEX,\r\nVALS(rsvd_disk_format_vals), 0, "Disk Format", HFILL }},\r\n{ &hf_svhdx_tunnel_disk_info_is_mounted,\r\n{ "IsMounted", "rsvd.svhdx_tunnel_disk_info_is_mounted", FT_UINT8, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_disk_info_is_4k_aligned,\r\n{ "Is4KAligned", "rsvd.svhdx_tunnel_disk_info_is_4k_aligned", FT_UINT8, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_disk_info_reserved,\r\n{ "Reserved", "rsvd.svhdx_disk_info_reserved", FT_UINT16, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_disk_info_file_size,\r\n{ "FileSize", "rsvd.svhdx_disk_info_file_size", FT_UINT64, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_disk_info_virtual_disk_id,\r\n{ "VirtualDiskId", "rsvd.svhdx_disk_info_virtual_disk_id", FT_BYTES, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_validate_disk_reserved,\r\n{ "Reserved", "rsvd.svhdx_tunnel_validate_disk_reserved", FT_BYTES, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_validate_disk_is_valid_disk,\r\n{ "IsValidDisk", "rsvd.svhdx_validate_disk_is_valid_disk", FT_BYTES, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_srb_status_status_key,\r\n{ "StatusKey", "rsvd.svhdx_srb_status_key", FT_UINT8, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_srb_status_reserved,\r\n{ "Reserved", "rsvd.svhdx_srb_status_reserved", FT_BYTES, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_srb_status_sense_info_auto_generated,\r\n{ "SenseInfoAutoGenerated", "rsvd.svhdx_sense_info_auto_generated", FT_UINT8, BASE_HEX,\r\nVALS(rsvd_sense_info_vals), 0x80, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_srb_status_srb_status,\r\n{ "SrbStatus", "rsvd.svhdx_srb_status_srb_status", FT_UINT8, BASE_HEX,\r\nNULL, 0x7f, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_srb_status_scsi_status,\r\n{ "SrbStatus", "rsvd.svhdx_srb_status_scsi_status", FT_UINT8, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_srb_status_sense_info_ex_length,\r\n{ "SenseInfoExLength", "rsvd.svhdx_srb_status_sense_info_ex_length", FT_UINT8, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_svhdx_tunnel_srb_status_sense_data_ex,\r\n{ "Reserved", "rsvd.svhdx_srb_status_sense_data_ex", FT_BYTES, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_rsvd,\r\n&ett_svhdx_tunnel_op_header,\r\n&ett_svhdx_tunnel_scsi_request,\r\n&ett_svhdx_tunnel_file_info_response\r\n};\r\nproto_rsvd = proto_register_protocol("Remote Shared Virtual Disk",\r\n"RSVD", "rsvd");\r\nregister_dissector("rsvd", dissect_rsvd, proto_rsvd);\r\nproto_register_field_array(proto_rsvd, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}
