static void\r\ndissect_serialnumber (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree, int hf_index)\r\n{\r\nproto_item *sn_item;\r\nproto_tree *sn_tree;\r\nconst gchar *s;\r\ntvb_ensure_bytes_exist (tvb, start_offset, 16);\r\nif (!tree)\r\nreturn;\r\nsn_item = proto_tree_add_item (tree, hf_index, tvb, start_offset, 16, ENC_ASCII|ENC_NA);\r\nsn_tree = proto_item_add_subtree (sn_item, ett_r3serialnumber);\r\ns = tvb_get_string_enc (wmem_packet_scope(), tvb, start_offset + 0, 2, ENC_ASCII|ENC_NA);\r\nproto_tree_add_string_format_value(sn_tree, hf_r3_sn_manufacturer, tvb, start_offset + 0, 2, s, "%s (%s)", s, str_to_str (s, r3_snmanufacturernames, "[Unknown]"));\r\ns = tvb_get_string_enc (wmem_packet_scope(), tvb, start_offset + 2, 1, ENC_ASCII|ENC_NA);\r\nproto_tree_add_string_format_value(sn_tree, hf_r3_sn_year, tvb, start_offset + 2, 1, s, "%s (%s)", s, str_to_str (s, r3_snyearnames, "[Unknown]"));\r\nproto_tree_add_item(sn_tree, hf_r3_sn_week, tvb, start_offset + 3, 2, ENC_ASCII|ENC_NA);\r\ns = tvb_get_string_enc (wmem_packet_scope(), tvb, start_offset + 5, 1, ENC_ASCII|ENC_NA);\r\nproto_tree_add_string_format_value(sn_tree, hf_r3_sn_model, tvb, start_offset + 5, 1, s, "%s (%s)", s, str_to_str (s, r3_snmodelnames, "[Unknown]"));\r\nproto_tree_add_item(sn_tree, hf_r3_sn_sequence, tvb, start_offset + 6, 4, ENC_ASCII|ENC_NA);\r\ns = tvb_get_string_enc (wmem_packet_scope(), tvb, start_offset + 10, 1, ENC_ASCII|ENC_NA);\r\nproto_tree_add_string_format_value(sn_tree, hf_r3_sn_group, tvb, start_offset + 10, 1, s, "%s (%s)", s, str_to_str (s, r3_sngroupnames, "[Unknown]"));\r\ns = tvb_get_string_enc (wmem_packet_scope(), tvb, start_offset + 11, 1, ENC_ASCII|ENC_NA);\r\nproto_tree_add_string_format_value(sn_tree, hf_r3_sn_nid, tvb, start_offset + 11, 1, s, "%s (%s)", s, str_to_str (s, r3_snnidnames, "[Unknown]"));\r\ns = tvb_get_string_enc (wmem_packet_scope(), tvb, start_offset + 12, 2, ENC_ASCII|ENC_NA);\r\nproto_tree_add_string_format_value(sn_tree, hf_r3_sn_hid, tvb, start_offset + 12, 2, s, "%s (%s)", s, str_to_str (s, r3_snhidnames, "[Unknown]"));\r\ns = tvb_get_string_enc (wmem_packet_scope(), tvb, start_offset + 14, 1, ENC_ASCII|ENC_NA);\r\nproto_tree_add_string_format_value(sn_tree, hf_r3_sn_power_supply, tvb, start_offset + 14, 1, s, "%s (%s)", s, str_to_str (s, r3_snpowersupplynames, "[Unknown]"));\r\ns = tvb_get_string_enc (wmem_packet_scope(), tvb, start_offset + 15, 1, ENC_ASCII|ENC_NA);\r\nproto_tree_add_string_format_value(sn_tree, hf_r3_sn_mortise, tvb, start_offset + 15, 1, s, "%s (%s)", s, str_to_str (s, r3_snmortisenames, "[Unknown]"));\r\n}\r\nstatic void\r\ndissect_r3_upstreamfields (tvbuff_t *tvb, guint32 start_offset, guint32 length, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint32 offset = 0;\r\nDISSECTOR_ASSERT(start_offset == 0);\r\nwhile (offset < tvb_reported_length (tvb))\r\n{\r\nguint32 fieldLength = tvb_get_guint8 (tvb, offset + 0);\r\nguint32 fieldType = tvb_get_guint8 (tvb, offset + 1);\r\nguint32 dataLength = fieldLength - 2;\r\nproto_item *upstreamfield_item;\r\nproto_item *upstreamfield_length;\r\nproto_tree *upstreamfield_tree;\r\nconst gchar *usfn;\r\nusfn = val_to_str_ext_const (fieldType, &r3_upstreamfieldnames_ext, "[Unknown Field]");\r\nupstreamfield_item = proto_tree_add_none_format (tree, hf_r3_upstreamfield, tvb, offset + 0, fieldLength, "Upstream Field: %s (%u)", usfn, fieldType);\r\nupstreamfield_tree = proto_item_add_subtree (upstreamfield_item, ett_r3upstreamfield);\r\nupstreamfield_length = proto_tree_add_item (upstreamfield_tree, hf_r3_upstreamfieldlength, tvb, offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (upstreamfield_tree, hf_r3_upstreamfieldtype, tvb, offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nif (fieldLength < 2)\r\n{\r\ndataLength = 0;\r\nexpert_add_info_format(pinfo, upstreamfield_length, &ei_r3_malformed_length, "Malformed length value -- all fields are at least 2 octets.");\r\n}\r\noffset += 2;\r\nswitch (fieldType)\r\n{\r\ncase UPSTREAMFIELD_NOTUSED :\r\ncase UPSTREAMFIELD_PRIMARYPIN :\r\ncase UPSTREAMFIELD_AUXPIN :\r\ncase UPSTREAMFIELD_ACCESSALWAYS :\r\ncase UPSTREAMFIELD_CACHED :\r\ncase UPSTREAMFIELD_ENTRYDEVICE :\r\ncase UPSTREAMFIELD_PPMIFIELDTYPE :\r\ncase UPSTREAMFIELD_RESPONSEWINDOW :\r\ncase UPSTREAMFIELD_USERTYPE :\r\ncase UPSTREAMFIELD_PRIMARYFIELDTYPE :\r\ncase UPSTREAMFIELD_AUXFIELDTYPE :\r\ncase UPSTREAMFIELD_ACCESSMODE :\r\ncase UPSTREAMFIELD_USECOUNT :\r\ncase UPSTREAMFIELD_EXCEPTIONGROUP :\r\ncase UPSTREAMFIELD_NAR :\r\ncase UPSTREAMFIELD_SEQUENCENUMBER :\r\ncase UPSTREAMFIELD_USERNUMBER :\r\ncase UPSTREAMFIELD_EVENTLOGRECORDCOUNT :\r\ncase UPSTREAMFIELD_DECLINEDRECORDCOUNT :\r\ncase UPSTREAMFIELD_ALARMRECORDCOUNT :\r\nproto_tree_add_item (upstreamfield_tree, hf_r3_upstreamfieldarray [fieldType], tvb, offset, dataLength, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase UPSTREAMFIELD_PIN :\r\ncase UPSTREAMFIELD_VERSION :\r\ncase UPSTREAMFIELD_AUXCTLRVERSION :\r\nproto_tree_add_item (upstreamfield_tree, hf_r3_upstreamfieldarray [fieldType], tvb, offset, dataLength, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase UPSTREAMFIELD_SERIALNUMBER :\r\n{\r\ntvbuff_t *sn_tvb = tvb_new_subset_length (tvb, offset, dataLength);\r\ndissect_serialnumber (sn_tvb, 0, length, pinfo, upstreamfield_tree, hf_r3_upstreamfieldarray [fieldType]);\r\n}\r\nbreak;\r\ncase UPSTREAMFIELD_EVENTLOGRECORD :\r\n{\r\nif (dataLength != 9)\r\n{\r\nexpert_add_info_format(pinfo, upstreamfield_length, &ei_r3_malformed_length, "Malformed event log field -- expected 9 octets");\r\n}\r\nelse\r\n{\r\nproto_tree *eventlog_tree;\r\nif (!upstreamfield_tree)\r\nbreak;\r\neventlog_tree = proto_tree_add_subtree(upstreamfield_tree, tvb, offset, 9, ett_r3eventlogrecord, NULL, "Event Log Record");\r\nproto_tree_add_item (eventlog_tree, hf_r3_eventlog_year, tvb, offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (eventlog_tree, hf_r3_eventlog_month, tvb, offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (eventlog_tree, hf_r3_eventlog_day, tvb, offset + 2, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (eventlog_tree, hf_r3_eventlog_hour, tvb, offset + 3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (eventlog_tree, hf_r3_eventlog_minute, tvb, offset + 4, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (eventlog_tree, hf_r3_eventlog_second, tvb, offset + 5, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (eventlog_tree, hf_r3_eventlog_usernumber, tvb, offset + 6, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (eventlog_tree, hf_r3_eventlog_event, tvb, offset + 8, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nbreak;\r\ncase UPSTREAMFIELD_DATETIME :\r\n{\r\nif (dataLength != 8)\r\n{\r\nexpert_add_info_format(pinfo, upstreamfield_length, &ei_r3_malformed_length, "Malformed date/time field -- expected 8 octets");\r\n}\r\nelse\r\n{\r\nproto_tree *datetime_tree;\r\nif (!upstreamfield_tree)\r\nbreak;\r\ndatetime_tree = proto_tree_add_subtree_format(upstreamfield_tree, tvb, offset, 8, ett_r3datetime, NULL,\r\n"Date/Time: %02u/%02u/%02u-%u %02u:%02u:%02u %u",\r\ntvb_get_guint8 (tvb, offset + 0), tvb_get_guint8 (tvb, offset + 1), tvb_get_guint8 (tvb, offset + 2), tvb_get_guint8 (tvb, offset + 3),\r\ntvb_get_guint8 (tvb, offset + 4), tvb_get_guint8 (tvb, offset + 5), tvb_get_guint8 (tvb, offset + 6), tvb_get_guint8 (tvb, offset + 7));\r\nproto_tree_add_item (datetime_tree, hf_r3_datetime_year, tvb, offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (datetime_tree, hf_r3_datetime_month, tvb, offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (datetime_tree, hf_r3_datetime_day, tvb, offset + 2, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (datetime_tree, hf_r3_datetime_dow, tvb, offset + 3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (datetime_tree, hf_r3_datetime_hours, tvb, offset + 4, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (datetime_tree, hf_r3_datetime_minutes, tvb, offset + 5, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (datetime_tree, hf_r3_datetime_seconds, tvb, offset + 6, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (datetime_tree, hf_r3_datetime_dst, tvb, offset + 7, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nbreak;\r\ncase UPSTREAMFIELD_DECLINEDRECORD :\r\n{\r\nif (dataLength != 49)\r\n{\r\nexpert_add_info_format(pinfo, upstreamfield_length, &ei_r3_malformed_length, "Malformed declined log field -- expected 49 octets");\r\n}\r\nelse\r\n{\r\nproto_tree *declinedlog_tree;\r\nguint8 cred1type;\r\nguint8 cred2type;\r\nif (!upstreamfield_tree)\r\nbreak;\r\ndeclinedlog_tree = proto_tree_add_subtree(upstreamfield_tree, tvb, offset, 49, ett_r3declinedlogrecord, NULL, "Declined Log Record");\r\nproto_tree_add_item (declinedlog_tree, hf_r3_declinedlog_year, tvb, offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (declinedlog_tree, hf_r3_declinedlog_month, tvb, offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (declinedlog_tree, hf_r3_declinedlog_day, tvb, offset + 2, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (declinedlog_tree, hf_r3_declinedlog_hour, tvb, offset + 3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (declinedlog_tree, hf_r3_declinedlog_minute, tvb, offset + 4, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (declinedlog_tree, hf_r3_declinedlog_second, tvb, offset + 5, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (declinedlog_tree, hf_r3_declinedlog_usernumber, tvb, offset + 6, 2, ENC_LITTLE_ENDIAN);\r\ncred1type = tvb_get_guint8 (tvb, offset + 8) & 0x07;\r\ncred2type = (tvb_get_guint8 (tvb, offset + 8) & 0x38) >> 3;\r\nproto_tree_add_uint (declinedlog_tree, hf_r3_declinedlog_cred1type, tvb, offset, 1, cred1type);\r\nproto_tree_add_uint (declinedlog_tree, hf_r3_declinedlog_cred2type, tvb, offset, 1, cred2type);\r\nproto_tree_add_item (declinedlog_tree, hf_r3_declinedlog_cred1, tvb, offset + 9, 19, ENC_NA);\r\nproto_tree_add_item (declinedlog_tree, hf_r3_declinedlog_cred2, tvb, offset + 28, 19, ENC_NA);\r\n}\r\n}\r\nbreak;\r\ncase UPSTREAMFIELD_EXPIREON :\r\n{\r\nif (dataLength != 3)\r\n{\r\nexpert_add_info_format(pinfo, upstreamfield_length, &ei_r3_malformed_length, "Malformed expiration field -- expected 3 octets");\r\n}\r\nelse\r\n{\r\nproto_tree *expireon_tree;\r\nif (!upstreamfield_tree)\r\nbreak;\r\nexpireon_tree = proto_tree_add_subtree_format(upstreamfield_tree, tvb, offset, 3, ett_r3expireon, NULL,\r\n"Expire YY/MM/DD: %02u/%02u/%02u",\r\ntvb_get_guint8 (tvb, offset + 2), tvb_get_guint8 (tvb, offset + 0), tvb_get_guint8 (tvb, offset + 1));\r\nproto_tree_add_item (expireon_tree, hf_r3_expireon_month, tvb, offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (expireon_tree, hf_r3_expireon_day, tvb, offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (expireon_tree, hf_r3_expireon_year, tvb, offset + 2, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nbreak;\r\ncase UPSTREAMFIELD_TIMEZONE :\r\n{\r\nif (dataLength != 4)\r\n{\r\nexpert_add_info_format(pinfo, upstreamfield_length, &ei_r3_malformed_length, "Malformed timezone field -- expected 4 octets");\r\n}\r\nelse\r\n{\r\nproto_tree_add_bitmask(upstreamfield_tree, tvb, offset, hf_r3_upstreamfieldarray[fieldType], ett_r3timezone, r3_timezonearray, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nbreak;\r\ncase UPSTREAMFIELD_ALARMRECORD :\r\n{\r\nif (dataLength != 9)\r\n{\r\nexpert_add_info_format(pinfo, upstreamfield_length, &ei_r3_malformed_length, "Malformed alarm log field -- expected 9 octets");\r\n}\r\nelse\r\n{\r\nproto_tree *alarmlog_tree;\r\nif (!upstreamfield_tree)\r\nbreak;\r\nalarmlog_tree = proto_tree_add_subtree(upstreamfield_tree, tvb, offset, 9, ett_r3alarmlogrecord, NULL, "Alarm Record");\r\nproto_tree_add_item (alarmlog_tree, hf_r3_alarmlog_year, tvb, offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (alarmlog_tree, hf_r3_alarmlog_month, tvb, offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (alarmlog_tree, hf_r3_alarmlog_day, tvb, offset + 2, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (alarmlog_tree, hf_r3_alarmlog_hour, tvb, offset + 3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (alarmlog_tree, hf_r3_alarmlog_minute, tvb, offset + 4, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (alarmlog_tree, hf_r3_alarmlog_second, tvb, offset + 5, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (alarmlog_tree, hf_r3_alarmlog_id, tvb, offset + 6, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (alarmlog_tree, hf_r3_alarmlog_usernumber, tvb, offset + 7, 2, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nbreak;\r\ndefault :\r\nproto_tree_add_none_format (upstreamfield_tree, hf_r3_upstreamfielderror, tvb, offset, dataLength, "Unknown Field Type");\r\nbreak;\r\n}\r\noffset += dataLength;\r\n}\r\n}\r\nstatic void\r\ndissect_r3_upstreamcommand_reserved (tvbuff_t *tvb, guint32 start_offset, guint32 length, packet_info *pinfo, proto_tree *tree)\r\n{\r\nproto_tree_add_expert(tree, pinfo, &ei_r3_reserved_upstream_command_value, tvb, start_offset, length);\r\n}\r\nstatic void\r\ndissect_r3_upstreamcommand_debugmsg (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree *debugmsg_tree;\r\nif (!tree)\r\nreturn;\r\nDISSECTOR_ASSERT(start_offset == 0);\r\ndebugmsg_tree = proto_tree_add_subtree(tree, tvb, 0, -1, ett_r3debugmsg, NULL, "Debug message");\r\nproto_tree_add_item (debugmsg_tree, hf_r3_debugmsg, tvb, 1, -1, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void\r\ndissect_r3_upstreamcommand_queryversion (tvbuff_t *tvb, guint32 start_offset, guint32 length, packet_info *pinfo, proto_tree *tree)\r\n{\r\ndissect_r3_upstreamfields (tvb, start_offset, length, pinfo, tree);\r\n}\r\nstatic void\r\ndissect_r3_upstreamcommand_querydatetime (tvbuff_t *tvb, guint32 start_offset, guint32 length, packet_info *pinfo, proto_tree *tree)\r\n{\r\ndissect_r3_upstreamfields (tvb, start_offset, length, pinfo, tree);\r\n}\r\nstatic void\r\ndissect_r3_upstreamcommand_queryserialnumber (tvbuff_t *tvb, guint32 start_offset, guint32 length, packet_info *pinfo, proto_tree *tree)\r\n{\r\ndissect_r3_upstreamfields (tvb, start_offset, length, pinfo, tree);\r\n}\r\nstatic void\r\ndissect_r3_upstreamcommand_dumpeventlog (tvbuff_t *tvb, guint32 start_offset, guint32 length, packet_info *pinfo, proto_tree *tree)\r\n{\r\nDISSECTOR_ASSERT(start_offset == 0);\r\ntvb_ensure_bytes_exist (tvb, 0, 11);\r\nif (length != 11)\r\n{\r\nexpert_add_info_format(pinfo, proto_tree_get_parent (tree), &ei_r3_malformed_length, "Malformed event log record -- expected 10 octets");\r\n}\r\nelse\r\n{\r\nproto_tree *eventlog_tree;\r\nconst gchar *en;\r\nif (!tree)\r\nreturn;\r\nen = val_to_str_ext_const (tvb_get_guint8 (tvb, 10), &r3_eventnames_ext, "[Unknown Event]");\r\neventlog_tree = proto_tree_add_subtree_format(tree, tvb, start_offset, 10, ett_r3eventlogrecord, NULL,\r\n"Event Log Record %u (%s)", tvb_get_letohs (tvb, 0), en);\r\nproto_tree_add_item (eventlog_tree, hf_r3_eventlog_recordnumber, tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (eventlog_tree, hf_r3_eventlog_year, tvb, 2, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (eventlog_tree, hf_r3_eventlog_month, tvb, 3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (eventlog_tree, hf_r3_eventlog_day, tvb, 4, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (eventlog_tree, hf_r3_eventlog_hour, tvb, 5, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (eventlog_tree, hf_r3_eventlog_minute, tvb, 6, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (eventlog_tree, hf_r3_eventlog_second, tvb, 7, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (eventlog_tree, hf_r3_eventlog_usernumber, tvb, 8, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (eventlog_tree, hf_r3_eventlog_event, tvb, 10, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_upstreamcommand_dumpnvram (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nDISSECTOR_ASSERT(start_offset == 0);\r\ntvb_ensure_bytes_exist (tvb, 0, 3);\r\nif (!tree)\r\nreturn;\r\nproto_tree_add_item (tree, hf_r3_nvramdump_record, tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_nvramdump_length, tvb, 2, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_nvramdump_data, tvb, 3, tvb_get_guint8 (tvb, 2), ENC_NA);\r\n}\r\nstatic void\r\ndissect_r3_upstreamcommand_rmtquthrequest (tvbuff_t *tvb, guint32 start_offset, guint32 length, packet_info *pinfo, proto_tree *tree)\r\n{\r\ndissect_r3_upstreamfields (tvb, start_offset, length, pinfo, tree);\r\n}\r\nstatic void\r\ndissect_r3_upstreamcommand_retrieveuser (tvbuff_t *tvb, guint32 start_offset, guint32 length, packet_info *pinfo, proto_tree *tree)\r\n{\r\ndissect_r3_upstreamfields (tvb, start_offset, length, pinfo, tree);\r\n}\r\nstatic void\r\ndissect_r3_upstreamcommand_queryconfig (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint32 offset = 0;\r\nDISSECTOR_ASSERT(start_offset == 0);\r\nif (!tree)\r\nreturn;\r\nwhile (offset < tvb_reported_length (tvb))\r\n{\r\nproto_item *pi;\r\nproto_tree *upstreamfield_tree;\r\nconst gchar *ci;\r\nguint8 item_length;\r\nci = val_to_str_ext_const (tvb_get_guint8 (tvb, offset + 1), &r3_configitemnames_ext, "[Unknown Configuration Item]");\r\nitem_length = tvb_get_guint8 (tvb, offset + 0);\r\nupstreamfield_tree = proto_tree_add_subtree_format(tree, tvb, offset + 0, item_length, ett_r3upstreamfield, NULL,\r\n"Config Field: %s (%u)", ci, tvb_get_guint8 (tvb, offset + 1));\r\npi = proto_tree_add_item (upstreamfield_tree, hf_r3_configitemlength, tvb, offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nif (item_length == 0) {\r\nexpert_add_info_format(pinfo, pi, &ei_r3_malformed_length, "Invalid item length");\r\nreturn;\r\n}\r\nproto_tree_add_item (upstreamfield_tree, hf_r3_configitem, tvb, offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (upstreamfield_tree, hf_r3_configitemtype, tvb, offset + 2, 1, ENC_LITTLE_ENDIAN);\r\nswitch (tvb_get_guint8 (tvb, offset + 2))\r\n{\r\ncase CONFIGTYPE_NONE :\r\nproto_tree_add_item (upstreamfield_tree, hf_r3_configitemdata, tvb, offset + 3, item_length - 3, ENC_NA);\r\nbreak;\r\ncase CONFIGTYPE_BOOL :\r\nproto_tree_add_item (upstreamfield_tree, hf_r3_configitemdata_bool, tvb, offset + 3, 1, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase CONFIGTYPE_8 :\r\nproto_tree_add_item (upstreamfield_tree, hf_r3_configitemdata_8, tvb, offset + 3, 1, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase CONFIGTYPE_16 :\r\nproto_tree_add_item (upstreamfield_tree, hf_r3_configitemdata_16, tvb, offset + 3, 2, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase CONFIGTYPE_32 :\r\nproto_tree_add_item (upstreamfield_tree, hf_r3_configitemdata_32, tvb, offset + 3, 4, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase CONFIGTYPE_STRING :\r\nproto_tree_add_item (upstreamfield_tree, hf_r3_configitemdata_string, tvb, offset + 3, item_length - 3, ENC_ASCII|ENC_NA);\r\nbreak;\r\ndefault :\r\nproto_tree_add_none_format (upstreamfield_tree, hf_r3_upstreamfielderror, tvb, offset + 3, item_length - 3, "Unknown Field Type");\r\nbreak;\r\n}\r\noffset += item_length;\r\n}\r\n}\r\nstatic void\r\ndissect_r3_upstreamcommand_rmteventlogrecord (tvbuff_t *tvb, guint32 start_offset, guint32 length, packet_info *pinfo, proto_tree *tree)\r\n{\r\ndissect_r3_upstreamfields (tvb, start_offset, length, pinfo, tree);\r\n}\r\nstatic void\r\ndissect_r3_upstreamcommand_dpac (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nDISSECTOR_ASSERT(start_offset == 0);\r\nproto_tree_add_item (tree, hf_r3_dpacreply_stuff, tvb, 2, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_dpacreply_length, tvb, 3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_dpacreply_reply, tvb, 4, -1, ENC_NA);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_upstreamcommand_notify (tvbuff_t *tvb, guint32 start_offset, guint32 length, packet_info *pinfo, proto_tree *tree)\r\n{\r\ndissect_r3_upstreamfields (tvb, start_offset, length, pinfo, tree);\r\n}\r\nstatic void\r\ndissect_r3_upstreamcommand_mfg (tvbuff_t *tvb, guint32 start_offset, guint32 length, packet_info *pinfo, proto_tree *tree)\r\n{\r\nproto_tree *mfg_tree = NULL;\r\nguint8 mfg_fld;\r\ntvbuff_t *mfg_tvb;\r\nproto_item *mfg_item;\r\nconst gchar *cn;\r\nDISSECTOR_ASSERT(start_offset == 0);\r\nmfg_tvb = tvb_new_subset_remaining (tvb, 2);\r\nmfg_fld = tvb_get_guint8 (tvb, 1);\r\ncn = val_to_str_ext_const (mfg_fld, &r3_mfgfieldnames_ext, "[Unknown Mfg Field]");\r\nproto_tree_add_item (tree, hf_r3_mfgfield_length, tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nmfg_tree = proto_tree_add_subtree_format(tree, tvb, 1, -1, ett_r3commandmfg, &mfg_item,\r\n"Upstream Manufacturing Field: %s (%u)", cn, mfg_fld);\r\nproto_tree_add_item (mfg_tree, hf_r3_mfgfield, tvb, 1, 1, ENC_LITTLE_ENDIAN);\r\nif (mfg_fld >= MFGFIELD_LAST)\r\n{\r\nexpert_add_info(pinfo, mfg_item, &ei_r3_mfgfield);\r\n}\r\nelse if (r3upstreammfgfield_dissect [mfg_fld])\r\n(*r3upstreammfgfield_dissect [mfg_fld]) (mfg_tvb, 0, length, pinfo, mfg_tree);\r\n}\r\nstatic void\r\ndissect_r3_upstreamcommand_eventlogwarning (tvbuff_t *tvb, guint32 start_offset, guint32 length, packet_info *pinfo, proto_tree *tree)\r\n{\r\ndissect_r3_upstreamfields (tvb, start_offset, length, pinfo, tree);\r\n}\r\nstatic void\r\ndissect_r3_upstreamcommand_dumpnvramrle (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (!tree)\r\nreturn;\r\nDISSECTOR_ASSERT(start_offset == 0);\r\nproto_tree_add_item (tree, hf_r3_nvramdumprle_record, tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_nvramdumprle_length, tvb, 3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_nvramdumprle_data, tvb, 4, tvb_get_guint8 (tvb, 3), ENC_NA);\r\n}\r\nstatic void\r\ndissect_r3_upstreamcommand_rmtdeclinedrecord (tvbuff_t *tvb, guint32 start_offset, guint32 length, packet_info *pinfo, proto_tree *tree)\r\n{\r\ndissect_r3_upstreamfields (tvb, start_offset, length, pinfo, tree);\r\n}\r\nstatic void\r\ndissect_r3_upstreamcommand_declinedwarning (tvbuff_t *tvb, guint32 start_offset, guint32 length, packet_info *pinfo, proto_tree *tree)\r\n{\r\ndissect_r3_upstreamfields (tvb, start_offset, length, pinfo, tree);\r\n}\r\nstatic void\r\ndissect_r3_upstreamcommand_dumpdeclinedlog (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree *declinedlog_tree;\r\nguint8 cred1type;\r\nguint8 cred2type;\r\nif (!tree)\r\nreturn;\r\nDISSECTOR_ASSERT(start_offset == 0);\r\ndeclinedlog_tree = proto_tree_add_subtree_format(tree, tvb, start_offset, 49,\r\nett_r3declinedlogrecord, NULL, "Declined Log Record %u", tvb_get_letohs (tvb, 0));\r\nproto_tree_add_item (declinedlog_tree, hf_r3_declinedlog_recordnumber, tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (declinedlog_tree, hf_r3_declinedlog_year, tvb, 2, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (declinedlog_tree, hf_r3_declinedlog_month, tvb, 3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (declinedlog_tree, hf_r3_declinedlog_day, tvb, 4, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (declinedlog_tree, hf_r3_declinedlog_hour, tvb, 5, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (declinedlog_tree, hf_r3_declinedlog_minute, tvb, 6, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (declinedlog_tree, hf_r3_declinedlog_second, tvb, 7, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (declinedlog_tree, hf_r3_declinedlog_usernumber, tvb, 8, 2, ENC_LITTLE_ENDIAN);\r\ncred1type = tvb_get_guint8 (tvb, 10) & 0x07;\r\ncred2type = (tvb_get_guint8 (tvb, 10) & 0x38) >> 3;\r\nproto_tree_add_uint (declinedlog_tree, hf_r3_declinedlog_cred1type, tvb, 10, 1, cred1type);\r\nproto_tree_add_uint (declinedlog_tree, hf_r3_declinedlog_cred2type, tvb, 10, 1, cred2type);\r\nproto_tree_add_item (declinedlog_tree, hf_r3_declinedlog_cred1, tvb, 11, 19, ENC_NA);\r\nproto_tree_add_item (declinedlog_tree, hf_r3_declinedlog_cred2, tvb, 30, 19, ENC_NA);\r\n}\r\nstatic void\r\ndissect_r3_upstreamcommand_rmtalarmrecord (tvbuff_t *tvb, guint32 start_offset, guint32 length, packet_info *pinfo, proto_tree *tree)\r\n{\r\ndissect_r3_upstreamfields (tvb, start_offset, length, pinfo, tree);\r\n}\r\nstatic void\r\ndissect_r3_upstreamcommand_alarmwarning (tvbuff_t *tvb, guint32 start_offset, guint32 length, packet_info *pinfo, proto_tree *tree)\r\n{\r\ndissect_r3_upstreamfields (tvb, start_offset, length, pinfo, tree);\r\n}\r\nstatic void\r\ndissect_r3_upstreamcommand_dumpalarmlog (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree *alarmlog_tree;\r\nif (!tree)\r\nreturn;\r\nDISSECTOR_ASSERT(start_offset == 0);\r\nalarmlog_tree = proto_tree_add_subtree_format(tree, tvb, start_offset, 9,\r\nett_r3alarmlogrecord, NULL, "Alarm Log Record %u", tvb_get_letohs (tvb, 0));\r\nproto_tree_add_item (alarmlog_tree, hf_r3_alarmlog_recordnumber, tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (alarmlog_tree, hf_r3_alarmlog_year, tvb, 2, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (alarmlog_tree, hf_r3_alarmlog_month, tvb, 3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (alarmlog_tree, hf_r3_alarmlog_day, tvb, 4, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (alarmlog_tree, hf_r3_alarmlog_hour, tvb, 5, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (alarmlog_tree, hf_r3_alarmlog_minute, tvb, 6, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (alarmlog_tree, hf_r3_alarmlog_second, tvb, 7, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (alarmlog_tree, hf_r3_alarmlog_id, tvb, 8, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (alarmlog_tree, hf_r3_alarmlog_usernumber, tvb, 9, 2, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_upstreamcommand_connectscheduler (tvbuff_t *tvb, guint32 start_offset, guint32 length, packet_info *pinfo, proto_tree *tree)\r\n{\r\ndissect_r3_upstreamfields (tvb, start_offset, length, pinfo, tree);\r\n}\r\nstatic void\r\ndissect_r3_upstreamcommand_connectcommuser (tvbuff_t *tvb, guint32 start_offset, guint32 length, packet_info *pinfo, proto_tree *tree)\r\n{\r\ndissect_r3_upstreamfields (tvb, start_offset, length, pinfo, tree);\r\n}\r\nstatic void\r\ndissect_r3_upstreamcommand_commandalarm (tvbuff_t *tvb, guint32 start_offset, guint32 length, packet_info *pinfo, proto_tree *tree)\r\n{\r\ndissect_r3_upstreamfields (tvb, start_offset, length, pinfo, tree);\r\n}\r\nstatic void\r\ndissect_r3_upstreamcommand_dumpdebuglog (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree *debuglog_tree;\r\nif (!tree)\r\nreturn;\r\nDISSECTOR_ASSERT(start_offset == 0);\r\ndebuglog_tree = proto_tree_add_subtree_format(tree, tvb, start_offset, 8,\r\nett_r3debuglogrecord, NULL, "Debug Log Record %u", tvb_get_letohs (tvb, 0));\r\nproto_tree_add_item (debuglog_tree, hf_r3_debuglog_recordnumber, tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (debuglog_tree, hf_r3_debuglog_flags, tvb, 2, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (debuglog_tree, hf_r3_debuglog_tick, tvb, 6, 2, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_upstreammfgfield_iopins (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo, proto_tree *tree)\r\n{\r\ngint len;\r\nDISSECTOR_ASSERT(start_offset == 0);\r\nlen = MAX(0, tvb_reported_length_remaining(tvb, start_offset));\r\nif (len % 3 != 0)\r\n{\r\nexpert_add_info_format(pinfo, proto_tree_get_parent (tree), &ei_r3_malformed_length, "IOPINS data length not modulo 3 == 0");\r\n}\r\nelse\r\n{\r\nchar portname = 'A';\r\ngint i;\r\nif (!tree)\r\nreturn;\r\nfor (i = 0; i < len; i += 3, portname++)\r\n{\r\nproto_tree *port_tree = proto_tree_add_subtree_format(tree, tvb, i, 3, ett_r3iopins, NULL,\r\n"Port %c Configuration", (portname == 'I') ? ++portname : portname);\r\nproto_tree_add_item (port_tree, hf_r3_iopins_lat, tvb, i + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (port_tree, hf_r3_iopins_port, tvb, i + 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (port_tree, hf_r3_iopins_tris, tvb, i + 2, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\n}\r\nstatic void\r\ndissect_r3_upstreammfgfield_adcs (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint len;\r\nguint32 i;\r\nif (!tree)\r\nreturn;\r\nDISSECTOR_ASSERT(start_offset == 0);\r\nlen = tvb_reported_length(tvb);\r\nfor (i = 0; i < MIN(len,8); i++)\r\n{\r\nproto_item *item = proto_tree_add_item (tree, hf_r3_adc [i], tvb, i, 1, ENC_LITTLE_ENDIAN);\r\nproto_item_append_text (item, " (%.2f Volts)", (float) tvb_get_guint8 (tvb, i) * 0.04154);\r\n}\r\nif (len > 8)\r\n{\r\nexpert_add_info(pinfo, proto_tree_get_parent (tree), &ei_r3_mfgfield_too_many_adc_values);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_upstreammfgfield_hardwareid (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (!tree)\r\nreturn;\r\nDISSECTOR_ASSERT(start_offset == 0);\r\nproto_tree_add_item (tree, hf_r3_hardwareid_board, tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_hardwareid_cpuid, tvb, 1, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_hardwareid_cpurev, tvb, 3, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_upstreammfgfield_checkpointlog (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree *cpl_tree;\r\nguint counter;\r\ngint len;\r\ngint i;\r\nif (!tree)\r\nreturn;\r\nDISSECTOR_ASSERT(start_offset == 0);\r\nlen = tvb_reported_length_remaining (tvb, 1);\r\nproto_tree_add_item (tree, hf_r3_checkpointlog_entryptr, tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\ncpl_tree = proto_tree_add_subtree(tree, tvb, 1, -1, ett_r3checkpointlog, NULL, "Checkpoint Log");\r\ncounter = 0;\r\nfor (i = 0; i < len; i += 2, counter++)\r\n{\r\nguint rcon = tvb_get_guint8 (tvb, i + 0);\r\nguint cp = tvb_get_guint8 (tvb, i + 1);\r\nproto_item *cpe_item;\r\nproto_tree *cpe_tree;\r\nguint resettype;\r\nconst gchar *desc;\r\nstatic const gchar *resets [] = { "Stack underflow", "Stack overflow", "Power-On",\r\n"Software", "Brown-out", "MCLR in sleep", "WDT",\r\n"Normal", "[Unknown Reset Type]" };\r\ncpe_tree = proto_tree_add_subtree_format(cpl_tree, tvb, i + 0, 2, ett_r3checkpointlogentry, &cpe_item,\r\n"Checkpoint Log Entry %u", counter);\r\ndesc = val_to_str_ext_const (cp, &r3_checkpointnames_ext, "[Unknown Checkpoint]");\r\nif (rcon == 0xff)\r\nresettype = 8;\r\nelse\r\n{\r\nrcon &= 0x1f;\r\nif (rcon == 0x1c)\r\nresettype = 2;\r\nelse if ((rcon & 0x10) == 0x00)\r\nresettype = 3;\r\nelse if ((rcon & 0x1d) == 0x1c)\r\nresettype = 4;\r\nelse if ((rcon & 0x0c) == 0x08)\r\nresettype = 5;\r\nelse if ((rcon & 0x0c) == 0x04)\r\nresettype = 6;\r\nelse\r\nresettype = 7;\r\n}\r\nproto_item_append_text (cpe_item, " (%s, %s)", resets [resettype], desc);\r\nproto_item_append_text (\r\nproto_tree_add_item (cpe_tree, hf_r3_checkpointlog_rcon, tvb, i + 0, 1, ENC_LITTLE_ENDIAN),\r\n" (%s)", resets [resettype]);\r\nproto_item_append_text (\r\nproto_tree_add_item (cpe_tree, hf_r3_checkpointlog_checkpoint, tvb, i + 1, 1, ENC_LITTLE_ENDIAN),\r\n" (%s)", desc);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_upstreammfgfield_cpuregisters (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree *tmp_tree [19];\r\nproto_tree *cr_tree;\r\nif (!tree)\r\nreturn;\r\nDISSECTOR_ASSERT(start_offset == 0);\r\ncr_tree = proto_tree_add_subtree(tree, tvb, start_offset, -1, ett_r3cpuregisters, NULL, "CPU Registers");\r\ntmp_tree [ 0] = proto_item_add_subtree (proto_tree_add_item (cr_tree, hf_r3_cpuregisters_intcon, tvb, 0, 1, ENC_LITTLE_ENDIAN), ett_r3cpuregister);\r\ntmp_tree [ 1] = proto_item_add_subtree (proto_tree_add_item (cr_tree, hf_r3_cpuregisters_intcon2, tvb, 1, 1, ENC_LITTLE_ENDIAN), ett_r3cpuregister);\r\ntmp_tree [ 2] = proto_item_add_subtree (proto_tree_add_item (cr_tree, hf_r3_cpuregisters_intcon3, tvb, 2, 1, ENC_LITTLE_ENDIAN), ett_r3cpuregister);\r\ntmp_tree [ 3] = proto_item_add_subtree (proto_tree_add_item (cr_tree, hf_r3_cpuregisters_pir1, tvb, 3, 1, ENC_LITTLE_ENDIAN), ett_r3cpuregister);\r\ntmp_tree [ 4] = proto_item_add_subtree (proto_tree_add_item (cr_tree, hf_r3_cpuregisters_pir2, tvb, 4, 1, ENC_LITTLE_ENDIAN), ett_r3cpuregister);\r\ntmp_tree [ 5] = proto_item_add_subtree (proto_tree_add_item (cr_tree, hf_r3_cpuregisters_pir3, tvb, 5, 1, ENC_LITTLE_ENDIAN), ett_r3cpuregister);\r\ntmp_tree [ 6] = proto_item_add_subtree (proto_tree_add_item (cr_tree, hf_r3_cpuregisters_pie1, tvb, 6, 1, ENC_LITTLE_ENDIAN), ett_r3cpuregister);\r\ntmp_tree [ 7] = proto_item_add_subtree (proto_tree_add_item (cr_tree, hf_r3_cpuregisters_pie2, tvb, 7, 1, ENC_LITTLE_ENDIAN), ett_r3cpuregister);\r\ntmp_tree [ 8] = proto_item_add_subtree (proto_tree_add_item (cr_tree, hf_r3_cpuregisters_pie3, tvb, 8, 1, ENC_LITTLE_ENDIAN), ett_r3cpuregister);\r\ntmp_tree [ 9] = proto_item_add_subtree (proto_tree_add_item (cr_tree, hf_r3_cpuregisters_ipr1, tvb, 9, 1, ENC_LITTLE_ENDIAN), ett_r3cpuregister);\r\ntmp_tree [10] = proto_item_add_subtree (proto_tree_add_item (cr_tree, hf_r3_cpuregisters_ipr2, tvb, 10, 1, ENC_LITTLE_ENDIAN), ett_r3cpuregister);\r\ntmp_tree [11] = proto_item_add_subtree (proto_tree_add_item (cr_tree, hf_r3_cpuregisters_ipr3, tvb, 11, 1, ENC_LITTLE_ENDIAN), ett_r3cpuregister);\r\ntmp_tree [12] = proto_item_add_subtree (proto_tree_add_item (cr_tree, hf_r3_cpuregisters_rcon, tvb, 12, 1, ENC_LITTLE_ENDIAN), ett_r3cpuregister);\r\ntmp_tree [13] = proto_item_add_subtree (proto_tree_add_item (cr_tree, hf_r3_cpuregisters_osccon, tvb, 13, 1, ENC_LITTLE_ENDIAN), ett_r3cpuregister);\r\ntmp_tree [14] = proto_item_add_subtree (proto_tree_add_item (cr_tree, hf_r3_cpuregisters_rcsta, tvb, 14, 1, ENC_LITTLE_ENDIAN), ett_r3cpuregister);\r\ntmp_tree [15] = proto_item_add_subtree (proto_tree_add_item (cr_tree, hf_r3_cpuregisters_txsta, tvb, 15, 1, ENC_LITTLE_ENDIAN), ett_r3cpuregister);\r\ntmp_tree [16] = proto_item_add_subtree (proto_tree_add_item (cr_tree, hf_r3_cpuregisters_rcsta2, tvb, 16, 1, ENC_LITTLE_ENDIAN), ett_r3cpuregister);\r\ntmp_tree [17] = proto_item_add_subtree (proto_tree_add_item (cr_tree, hf_r3_cpuregisters_txsta2, tvb, 17, 1, ENC_LITTLE_ENDIAN), ett_r3cpuregister);\r\ntmp_tree [18] = proto_item_add_subtree (proto_tree_add_item (cr_tree, hf_r3_cpuregisters_wdtcon, tvb, 18, 1, ENC_LITTLE_ENDIAN), ett_r3cpuregister);\r\nproto_tree_add_item (tmp_tree [ 0], hf_r3_cpuregisters_intcon_rbif, tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 0], hf_r3_cpuregisters_intcon_int0if, tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 0], hf_r3_cpuregisters_intcon_tmr0if, tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 0], hf_r3_cpuregisters_intcon_rbie, tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 0], hf_r3_cpuregisters_intcon_int0ie, tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 0], hf_r3_cpuregisters_intcon_tmr0ie, tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 0], hf_r3_cpuregisters_intcon_giel, tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 0], hf_r3_cpuregisters_intcon_gieh, tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 1], hf_r3_cpuregisters_intcon2_rbip, tvb, 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 1], hf_r3_cpuregisters_intcon2_int3ip, tvb, 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 1], hf_r3_cpuregisters_intcon2_tmr0ip, tvb, 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 1], hf_r3_cpuregisters_intcon2_intedg3, tvb, 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 1], hf_r3_cpuregisters_intcon2_intedg2, tvb, 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 1], hf_r3_cpuregisters_intcon2_intedg1, tvb, 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 1], hf_r3_cpuregisters_intcon2_intedg0, tvb, 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 1], hf_r3_cpuregisters_intcon2_rbpu, tvb, 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 2], hf_r3_cpuregisters_intcon3_int1if, tvb, 2, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 2], hf_r3_cpuregisters_intcon3_int2if, tvb, 2, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 2], hf_r3_cpuregisters_intcon3_int3if, tvb, 2, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 2], hf_r3_cpuregisters_intcon3_int1ie, tvb, 2, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 2], hf_r3_cpuregisters_intcon3_int2ie, tvb, 2, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 2], hf_r3_cpuregisters_intcon3_int3ie, tvb, 2, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 2], hf_r3_cpuregisters_intcon3_int1ip, tvb, 2, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 2], hf_r3_cpuregisters_intcon3_int2ip, tvb, 2, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 3], hf_r3_cpuregisters_pir1_tmr1if, tvb, 3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 3], hf_r3_cpuregisters_pir1_tmr2if, tvb, 3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 3], hf_r3_cpuregisters_pir1_ccp1if, tvb, 3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 3], hf_r3_cpuregisters_pir1_ssp1if, tvb, 3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 3], hf_r3_cpuregisters_pir1_tx1if, tvb, 3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 3], hf_r3_cpuregisters_pir1_rc1if, tvb, 3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 3], hf_r3_cpuregisters_pir1_adif, tvb, 3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 3], hf_r3_cpuregisters_pir1_pspif, tvb, 3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 4], hf_r3_cpuregisters_pir2_ccp2if, tvb, 4, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 4], hf_r3_cpuregisters_pir2_tmr3if, tvb, 4, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 4], hf_r3_cpuregisters_pir2_hlvdif, tvb, 4, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 4], hf_r3_cpuregisters_pir2_bcl1if, tvb, 4, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 4], hf_r3_cpuregisters_pir2_eeif, tvb, 4, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 4], hf_r3_cpuregisters_pir2_unused5, tvb, 4, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 4], hf_r3_cpuregisters_pir2_cmif, tvb, 4, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 4], hf_r3_cpuregisters_pir2_oscfif, tvb, 4, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 5], hf_r3_cpuregisters_pir3_ccp3if, tvb, 5, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 5], hf_r3_cpuregisters_pir3_ccp4if, tvb, 5, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 5], hf_r3_cpuregisters_pir3_ccp5if, tvb, 5, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 5], hf_r3_cpuregisters_pir3_tmr4if, tvb, 5, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 5], hf_r3_cpuregisters_pir3_tx2if, tvb, 5, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 5], hf_r3_cpuregisters_pir3_rc2if, tvb, 5, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 5], hf_r3_cpuregisters_pir3_bcl2if, tvb, 5, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 5], hf_r3_cpuregisters_pir3_ssp2if, tvb, 5, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 6], hf_r3_cpuregisters_pie1_tmr1ie, tvb, 6, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 6], hf_r3_cpuregisters_pie1_tmr2ie, tvb, 6, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 6], hf_r3_cpuregisters_pie1_ccp1ie, tvb, 6, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 6], hf_r3_cpuregisters_pie1_ssp1ie, tvb, 6, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 6], hf_r3_cpuregisters_pie1_tx1ie, tvb, 6, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 6], hf_r3_cpuregisters_pie1_rc1ie, tvb, 6, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 6], hf_r3_cpuregisters_pie1_adie, tvb, 6, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 6], hf_r3_cpuregisters_pie1_pspie, tvb, 6, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 7], hf_r3_cpuregisters_pie2_oscfie, tvb, 7, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 7], hf_r3_cpuregisters_pie2_cmie, tvb, 7, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 7], hf_r3_cpuregisters_pie2_unused2, tvb, 7, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 7], hf_r3_cpuregisters_pie2_eeie, tvb, 7, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 7], hf_r3_cpuregisters_pie2_bcl1ie, tvb, 7, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 7], hf_r3_cpuregisters_pie2_hlvdie, tvb, 7, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 7], hf_r3_cpuregisters_pie2_tmr3ie, tvb, 7, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 7], hf_r3_cpuregisters_pie2_ccp2ie, tvb, 7, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 8], hf_r3_cpuregisters_pie3_ccp3ie, tvb, 8, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 8], hf_r3_cpuregisters_pie3_ccp4ie, tvb, 8, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 8], hf_r3_cpuregisters_pie3_ccp5ie, tvb, 8, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 8], hf_r3_cpuregisters_pie3_tmr4ie, tvb, 8, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 8], hf_r3_cpuregisters_pie3_tx2ie, tvb, 8, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 8], hf_r3_cpuregisters_pie3_rc2ie, tvb, 8, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 8], hf_r3_cpuregisters_pie3_bcl2ie, tvb, 8, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 8], hf_r3_cpuregisters_pie3_ssp2ie, tvb, 8, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 9], hf_r3_cpuregisters_ipr1_tmr1ip, tvb, 9, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 9], hf_r3_cpuregisters_ipr1_tmr2ip, tvb, 9, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 9], hf_r3_cpuregisters_ipr1_ccp1ip, tvb, 9, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 9], hf_r3_cpuregisters_ipr1_ssp1ip, tvb, 9, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 9], hf_r3_cpuregisters_ipr1_tx1ip, tvb, 9, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 9], hf_r3_cpuregisters_ipr1_rc1ip, tvb, 9, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 9], hf_r3_cpuregisters_ipr1_adip, tvb, 9, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [ 9], hf_r3_cpuregisters_ipr1_pspip, tvb, 9, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [10], hf_r3_cpuregisters_ipr2_ccp2ip, tvb, 10, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [10], hf_r3_cpuregisters_ipr2_tmr3ip, tvb, 10, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [10], hf_r3_cpuregisters_ipr2_hlvdip, tvb, 10, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [10], hf_r3_cpuregisters_ipr2_bcl1ip, tvb, 10, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [10], hf_r3_cpuregisters_ipr2_eeip, tvb, 10, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [10], hf_r3_cpuregisters_ipr2_unused5, tvb, 10, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [10], hf_r3_cpuregisters_ipr2_cmip, tvb, 10, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [10], hf_r3_cpuregisters_ipr2_oscfip, tvb, 10, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [11], hf_r3_cpuregisters_ipr3_ccp2ip, tvb, 11, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [11], hf_r3_cpuregisters_ipr3_ccp4ip, tvb, 11, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [11], hf_r3_cpuregisters_ipr3_ccp5ip, tvb, 11, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [11], hf_r3_cpuregisters_ipr3_tmr4ip, tvb, 11, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [11], hf_r3_cpuregisters_ipr3_tx2ip, tvb, 11, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [11], hf_r3_cpuregisters_ipr3_rc2ip, tvb, 11, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [11], hf_r3_cpuregisters_ipr3_bcl2ip, tvb, 11, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [11], hf_r3_cpuregisters_ipr3_ssp2ip, tvb, 11, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [12], hf_r3_cpuregisters_rcon_bor, tvb, 12, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [12], hf_r3_cpuregisters_rcon_por, tvb, 12, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [12], hf_r3_cpuregisters_rcon_pd, tvb, 12, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [12], hf_r3_cpuregisters_rcon_to, tvb, 12, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [12], hf_r3_cpuregisters_rcon_unused4, tvb, 12, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [12], hf_r3_cpuregisters_rcon_ri, tvb, 12, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [12], hf_r3_cpuregisters_rcon_sboren, tvb, 12, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [12], hf_r3_cpuregisters_rcon_ipen, tvb, 12, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [13], hf_r3_cpuregisters_osccon_scs0, tvb, 13, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [13], hf_r3_cpuregisters_osccon_scs1, tvb, 13, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [13], hf_r3_cpuregisters_osccon_iofs, tvb, 13, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [13], hf_r3_cpuregisters_osccon_osts, tvb, 13, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [13], hf_r3_cpuregisters_osccon_ircf0, tvb, 13, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [13], hf_r3_cpuregisters_osccon_ircf1, tvb, 13, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [13], hf_r3_cpuregisters_osccon_ircf2, tvb, 13, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [13], hf_r3_cpuregisters_osccon_idlen, tvb, 13, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [14], hf_r3_cpuregisters_rcsta_rx9d, tvb, 14, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [14], hf_r3_cpuregisters_rcsta_oerr, tvb, 14, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [14], hf_r3_cpuregisters_rcsta_ferr, tvb, 14, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [14], hf_r3_cpuregisters_rcsta_adden, tvb, 14, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [14], hf_r3_cpuregisters_rcsta_cren, tvb, 14, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [14], hf_r3_cpuregisters_rcsta_sren, tvb, 14, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [14], hf_r3_cpuregisters_rcsta_rx9, tvb, 14, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [14], hf_r3_cpuregisters_rcsta_spen, tvb, 14, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [15], hf_r3_cpuregisters_txsta_tx9d, tvb, 15, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [15], hf_r3_cpuregisters_txsta_trmt, tvb, 15, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [15], hf_r3_cpuregisters_txsta_brgh, tvb, 15, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [15], hf_r3_cpuregisters_txsta_sendb, tvb, 15, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [15], hf_r3_cpuregisters_txsta_sync, tvb, 15, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [15], hf_r3_cpuregisters_txsta_txen, tvb, 15, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [15], hf_r3_cpuregisters_txsta_tx9, tvb, 15, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [15], hf_r3_cpuregisters_txsta_csrc, tvb, 15, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [16], hf_r3_cpuregisters_rcsta2_rx9d, tvb, 16, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [16], hf_r3_cpuregisters_rcsta2_oerr, tvb, 16, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [16], hf_r3_cpuregisters_rcsta2_ferr, tvb, 16, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [16], hf_r3_cpuregisters_rcsta2_adden, tvb, 16, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [16], hf_r3_cpuregisters_rcsta2_cren, tvb, 16, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [16], hf_r3_cpuregisters_rcsta2_sren, tvb, 16, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [16], hf_r3_cpuregisters_rcsta2_rx9, tvb, 16, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [16], hf_r3_cpuregisters_rcsta2_spen, tvb, 16, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [17], hf_r3_cpuregisters_txsta2_tx9d, tvb, 17, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [17], hf_r3_cpuregisters_txsta2_trmt, tvb, 17, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [17], hf_r3_cpuregisters_txsta2_brgh, tvb, 17, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [17], hf_r3_cpuregisters_txsta2_sendb, tvb, 17, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [17], hf_r3_cpuregisters_txsta2_sync, tvb, 17, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [17], hf_r3_cpuregisters_txsta2_txen, tvb, 17, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [17], hf_r3_cpuregisters_txsta2_tx9, tvb, 17, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [17], hf_r3_cpuregisters_txsta2_csrc, tvb, 17, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [18], hf_r3_cpuregisters_wdtcon_swdten, tvb, 18, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [18], hf_r3_cpuregisters_wdtcon_unused1, tvb, 18, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [18], hf_r3_cpuregisters_wdtcon_unused2, tvb, 18, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [18], hf_r3_cpuregisters_wdtcon_unused3, tvb, 18, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [18], hf_r3_cpuregisters_wdtcon_unused4, tvb, 18, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [18], hf_r3_cpuregisters_wdtcon_unused5, tvb, 18, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [18], hf_r3_cpuregisters_wdtcon_unused6, tvb, 18, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree [18], hf_r3_cpuregisters_wdtcon_unused7, tvb, 18, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_upstreammfgfield_taskflags (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\ngint len;\r\ngint i;\r\nproto_tree *tfg_tree;\r\nDISSECTOR_ASSERT(start_offset == 0);\r\nlen = MAX(0, tvb_reported_length_remaining (tvb, 0));\r\ntfg_tree = proto_tree_add_subtree_format(tree, tvb, 0, -1, ett_r3taskflags, NULL,\r\n"Task Flags (%u tasks)", len / 5);\r\nfor (i = 0; i < len; i += 5)\r\n{\r\nproto_tree *tf_tree = proto_tree_add_subtree_format(tfg_tree, tvb, i, 5,\r\nett_r3taskflagsentry, NULL,\r\n"Task Flags (%2d: 0x%06x)",\r\ntvb_get_guint8 (tvb, i + 0),\r\ntvb_get_letohl (tvb, i + 1));\r\nproto_tree_add_item (tf_tree, hf_r3_taskflags_taskid, tvb, i + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tf_tree, hf_r3_taskflags_flags, tvb, i + 1, 4, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_upstreammfgfield_timerchain (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\ngint len;\r\ngint i;\r\nif (!tree)\r\nreturn;\r\nDISSECTOR_ASSERT(start_offset == 0);\r\nlen = tvb_reported_length_remaining (tvb, 3);\r\nproto_tree_add_item (tree, hf_r3_timerchain_newtick, tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_timerchain_currentboundary, tvb, 2, 1, ENC_LITTLE_ENDIAN);\r\nfor (i = 0; i < len; i += 12)\r\n{\r\nproto_tree *tc_tree = proto_tree_add_subtree(tree, tvb, 3 + i, 12, ett_r3timerchain, NULL, "Timer Chain Entry");\r\nproto_tree_add_item (tc_tree, hf_r3_timerchain_tasktag, tvb, 3 + i + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tc_tree, hf_r3_timerchain_address, tvb, 3 + i + 1, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tc_tree, hf_r3_timerchain_reload, tvb, 3 + i + 3, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tc_tree, hf_r3_timerchain_boundary, tvb, 3 + i + 5, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tc_tree, hf_r3_timerchain_count, tvb, 3 + i + 6, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tc_tree, hf_r3_timerchain_flags, tvb, 3 + i + 8, 4, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_upstreammfgfield_peekpoke (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo, proto_tree *tree)\r\n{\r\ngint i;\r\ngint len;\r\nDISSECTOR_ASSERT(start_offset == 0);\r\nlen = tvb_reported_length_remaining (tvb, 0);\r\nfor (i = 0; i < len; i += 3)\r\n{\r\nproto_item *peekpoke_item;\r\nproto_item *peekpoke_op_item;\r\nproto_tree *peekpoke_tree;\r\npeekpoke_tree = proto_tree_add_subtree(tree, tvb, i, 3, ett_r3peekpoke, &peekpoke_item, "");\r\npeekpoke_op_item = proto_tree_add_item (peekpoke_tree, hf_r3_peekpoke_operation, tvb, i + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (peekpoke_tree, hf_r3_peekpoke_address, tvb, i + 1, 2, ENC_LITTLE_ENDIAN);\r\nswitch (tvb_get_guint8 (tvb, i + 0))\r\n{\r\ncase PEEKPOKE_READU8 :\r\nif (peekpoke_tree)\r\n{\r\nproto_item_append_text (peekpoke_item, "Read (8 Bits @ 0x%04x = 0x%02x)",\r\ntvb_get_letohs (tvb, i + 1),\r\ntvb_get_guint8 (tvb, i + 3));\r\nproto_item_set_len (peekpoke_item, 4);\r\nproto_tree_add_item (peekpoke_tree, hf_r3_peekpoke_poke8, tvb, i + 3, 1, ENC_LITTLE_ENDIAN);\r\n}\r\ni += 1;\r\nbreak;\r\ncase PEEKPOKE_READU16 :\r\nif (peekpoke_tree)\r\n{\r\nproto_item_append_text (peekpoke_item, "Read (16 Bits @ 0x%04x = 0x%04x)",\r\ntvb_get_letohs (tvb, i + 1),\r\ntvb_get_letohs (tvb, i + 3));\r\nproto_item_set_len (peekpoke_item, 5);\r\nproto_tree_add_item (peekpoke_tree, hf_r3_peekpoke_poke16, tvb, i + 3, 2, ENC_LITTLE_ENDIAN);\r\n}\r\ni += 2;\r\nbreak;\r\ncase PEEKPOKE_READU24 :\r\nif (peekpoke_tree)\r\n{\r\nproto_item_append_text (peekpoke_item, "Read (24 Bits @ 0x%04x = 0x%06x)",\r\ntvb_get_letohs (tvb, i + 1),\r\ntvb_get_letoh24 (tvb, i + 3));\r\nproto_item_set_len (peekpoke_item, 6);\r\nproto_tree_add_item (peekpoke_tree, hf_r3_peekpoke_poke24, tvb, i + 3, 3, ENC_LITTLE_ENDIAN);\r\n}\r\ni += 3;\r\nbreak;\r\ncase PEEKPOKE_READU32 :\r\nif (peekpoke_tree)\r\n{\r\nproto_item_append_text (peekpoke_item, "Read (32 Bits @ 0x%04x = 0x%08x)",\r\ntvb_get_letohs (tvb, i + 1),\r\ntvb_get_letohl (tvb, i + 3));\r\nproto_item_set_len (peekpoke_item, 7);\r\nproto_tree_add_item (peekpoke_tree, hf_r3_peekpoke_poke32, tvb, i + 3, 4, ENC_LITTLE_ENDIAN);\r\n}\r\ni += 4;\r\nbreak;\r\ncase PEEKPOKE_READSTRING :\r\nif (peekpoke_tree)\r\n{\r\nproto_item_append_text (peekpoke_item, "Read (%u Bytes @ 0x%04x)",\r\ntvb_get_guint8 (tvb, i + 3),\r\ntvb_get_letohs (tvb, i + 1));\r\nproto_item_set_len (peekpoke_item, 3 + 1 + tvb_get_guint8 (tvb, i + 3));\r\nproto_tree_add_item (peekpoke_tree, hf_r3_peekpoke_length, tvb, i + 3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (peekpoke_tree, hf_r3_peekpoke_pokestring, tvb, i + 4, tvb_get_guint8 (tvb, i + 3), ENC_NA);\r\n}\r\ni += tvb_get_guint8 (tvb, i + 3) + 1;\r\nbreak;\r\ndefault :\r\nexpert_add_info(pinfo, peekpoke_op_item, &ei_r3_peekpoke_operation);\r\nreturn;\r\n}\r\n}\r\n}\r\nstatic void\r\ndissect_r3_upstreammfgfield_lockstate (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nstatic const int * r3_lockstate_flags[] = {\r\n&hf_r3_lockstate_passage,\r\n&hf_r3_lockstate_panic,\r\n&hf_r3_lockstate_lockout,\r\n&hf_r3_lockstate_relock,\r\n&hf_r3_lockstate_autoopen,\r\n&hf_r3_lockstate_nextauto,\r\n&hf_r3_lockstate_lockstate,\r\n&hf_r3_lockstate_wantstate,\r\n&hf_r3_lockstate_remote,\r\n&hf_r3_lockstate_update,\r\n&hf_r3_lockstate_exceptionspresent,\r\n&hf_r3_lockstate_exceptionsactive,\r\n&hf_r3_lockstate_timezonespresent,\r\n&hf_r3_lockstate_timezonesactive,\r\n&hf_r3_lockstate_autounlockspresent,\r\n&hf_r3_lockstate_autounlocksactive,\r\n&hf_r3_lockstate_uapmspresent,\r\n&hf_r3_lockstate_uapmsactive,\r\n&hf_r3_lockstate_uapmrelockspresent,\r\n&hf_r3_lockstate_uapmreslocksactive,\r\n&hf_r3_lockstate_nvramprotect,\r\n&hf_r3_lockstate_nvramchecksum,\r\nNULL\r\n};\r\nDISSECTOR_ASSERT(start_offset == 0);\r\nproto_tree_add_bitmask(tree, tvb, start_offset, hf_r3_lockstate, ett_r3lockstate, r3_lockstate_flags, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_upstreammfgfield_capabilities (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo, proto_tree *tree)\r\n{\r\nproto_tree *cf_tree;\r\ngint len;\r\nguint items;\r\nguint octets;\r\ngint i;\r\nguint8 step;\r\nDISSECTOR_ASSERT(start_offset == 0);\r\nlen = MAX(0, tvb_reported_length_remaining (tvb, 0));\r\nitems = 0;\r\ni = 0;\r\nwhile (i < len)\r\n{\r\nitems++;\r\noctets = tvb_get_guint8 (tvb, i);\r\nif (!octets)\r\n{\r\nproto_tree_add_expert_format(tree, pinfo, &ei_r3_malformed_length, tvb, 0, len, "Capabilities could not be decoded because length of 0 encountered");\r\nreturn;\r\n}\r\ni += octets;\r\n}\r\nif (!tree)\r\nreturn;\r\ncf_tree = proto_tree_add_subtree_format(tree, tvb, 0, len, ett_r3capabilities, NULL, "Capabilities (%u items)", items);\r\ni = 0;\r\nwhile (i<len && (step=tvb_get_guint8(tvb, i))>0)\r\n{\r\nproto_item *tmp_item = proto_tree_add_item (cf_tree, hf_r3_capabilities, tvb, i, tvb_get_guint8 (tvb, i), ENC_NA);\r\nproto_tree *tmp_tree = proto_item_add_subtree (tmp_item, ett_r3capabilities);\r\nconst gchar *fn;\r\nfn = val_to_str_ext_const (tvb_get_guint8 (tvb, i + 1), &r3_capabilitiesnames_ext, "[Unknown Field Name]");\r\nproto_item_append_text (tmp_item, " (%s, %u)", fn, tvb_get_letohs (tvb, i + 2));\r\nproto_tree_add_item (tmp_tree, hf_r3_capabilities_length, tvb, i + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree, hf_r3_capabilities_type, tvb, i + 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tmp_tree, hf_r3_capabilities_value, tvb, i + 2, 2, ENC_LITTLE_ENDIAN);\r\ni += step;\r\n}\r\n}\r\nstatic void\r\ndissect_r3_upstreammfgfield_dumpm41t81 (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo, proto_tree *tree)\r\n{\r\nDISSECTOR_ASSERT(start_offset == 0);\r\nif (tvb_reported_length_remaining (tvb, 0) != 20)\r\n{\r\nexpert_add_info_format(pinfo, proto_tree_get_parent (tree), &ei_r3_malformed_length, "Length of M41T81 RTC register dump not 20 octets");\r\n}\r\nelse\r\n{\r\nproto_tree *rtc_tree;\r\nproto_tree *tmp_tree [20];\r\nguint offset_in_bits;\r\nif (!tree)\r\nreturn;\r\nrtc_tree = proto_tree_add_subtree(tree, tvb, 0, -1, ett_r3m41t81registers, NULL, "M41T81 RTC Registers");\r\ntmp_tree [ 0] = proto_item_add_subtree (proto_tree_add_item (rtc_tree, hf_r3_dumpm41t81_reg00, tvb, 0, 1, ENC_LITTLE_ENDIAN), ett_r3m41t81register);\r\ntmp_tree [ 1] = proto_item_add_subtree (proto_tree_add_item (rtc_tree, hf_r3_dumpm41t81_reg01, tvb, 1, 1, ENC_LITTLE_ENDIAN), ett_r3m41t81register);\r\ntmp_tree [ 2] = proto_item_add_subtree (proto_tree_add_item (rtc_tree, hf_r3_dumpm41t81_reg02, tvb, 2, 1, ENC_LITTLE_ENDIAN), ett_r3m41t81register);\r\ntmp_tree [ 3] = proto_item_add_subtree (proto_tree_add_item (rtc_tree, hf_r3_dumpm41t81_reg03, tvb, 3, 1, ENC_LITTLE_ENDIAN), ett_r3m41t81register);\r\ntmp_tree [ 4] = proto_item_add_subtree (proto_tree_add_item (rtc_tree, hf_r3_dumpm41t81_reg04, tvb, 4, 1, ENC_LITTLE_ENDIAN), ett_r3m41t81register);\r\ntmp_tree [ 5] = proto_item_add_subtree (proto_tree_add_item (rtc_tree, hf_r3_dumpm41t81_reg05, tvb, 5, 1, ENC_LITTLE_ENDIAN), ett_r3m41t81register);\r\ntmp_tree [ 6] = proto_item_add_subtree (proto_tree_add_item (rtc_tree, hf_r3_dumpm41t81_reg06, tvb, 6, 1, ENC_LITTLE_ENDIAN), ett_r3m41t81register);\r\ntmp_tree [ 7] = proto_item_add_subtree (proto_tree_add_item (rtc_tree, hf_r3_dumpm41t81_reg07, tvb, 7, 1, ENC_LITTLE_ENDIAN), ett_r3m41t81register);\r\ntmp_tree [ 8] = proto_item_add_subtree (proto_tree_add_item (rtc_tree, hf_r3_dumpm41t81_reg08, tvb, 8, 1, ENC_LITTLE_ENDIAN), ett_r3m41t81register);\r\ntmp_tree [ 9] = proto_item_add_subtree (proto_tree_add_item (rtc_tree, hf_r3_dumpm41t81_reg09, tvb, 9, 1, ENC_LITTLE_ENDIAN), ett_r3m41t81register);\r\ntmp_tree [10] = proto_item_add_subtree (proto_tree_add_item (rtc_tree, hf_r3_dumpm41t81_reg0a, tvb, 10, 1, ENC_LITTLE_ENDIAN), ett_r3m41t81register);\r\ntmp_tree [11] = proto_item_add_subtree (proto_tree_add_item (rtc_tree, hf_r3_dumpm41t81_reg0b, tvb, 11, 1, ENC_LITTLE_ENDIAN), ett_r3m41t81register);\r\ntmp_tree [12] = proto_item_add_subtree (proto_tree_add_item (rtc_tree, hf_r3_dumpm41t81_reg0c, tvb, 12, 1, ENC_LITTLE_ENDIAN), ett_r3m41t81register);\r\ntmp_tree [13] = proto_item_add_subtree (proto_tree_add_item (rtc_tree, hf_r3_dumpm41t81_reg0d, tvb, 13, 1, ENC_LITTLE_ENDIAN), ett_r3m41t81register);\r\ntmp_tree [14] = proto_item_add_subtree (proto_tree_add_item (rtc_tree, hf_r3_dumpm41t81_reg0e, tvb, 14, 1, ENC_LITTLE_ENDIAN), ett_r3m41t81register);\r\ntmp_tree [15] = proto_item_add_subtree (proto_tree_add_item (rtc_tree, hf_r3_dumpm41t81_reg0f, tvb, 15, 1, ENC_LITTLE_ENDIAN), ett_r3m41t81register);\r\ntmp_tree [16] = proto_item_add_subtree (proto_tree_add_item (rtc_tree, hf_r3_dumpm41t81_reg10, tvb, 16, 1, ENC_LITTLE_ENDIAN), ett_r3m41t81register);\r\ntmp_tree [17] = proto_item_add_subtree (proto_tree_add_item (rtc_tree, hf_r3_dumpm41t81_reg11, tvb, 17, 1, ENC_LITTLE_ENDIAN), ett_r3m41t81register);\r\ntmp_tree [18] = proto_item_add_subtree (proto_tree_add_item (rtc_tree, hf_r3_dumpm41t81_reg12, tvb, 18, 1, ENC_LITTLE_ENDIAN), ett_r3m41t81register);\r\ntmp_tree [19] = proto_item_add_subtree (proto_tree_add_item (rtc_tree, hf_r3_dumpm41t81_reg13, tvb, 19, 1, ENC_LITTLE_ENDIAN), ett_r3m41t81register);\r\noffset_in_bits = 0 * 8;\r\nproto_tree_add_bits_item (tmp_tree [ 0], hf_r3_dumpm41t81_reg00_sec1, tvb, offset_in_bits, 4, ENC_LITTLE_ENDIAN); offset_in_bits += 4;\r\nproto_tree_add_bits_item (tmp_tree [ 0], hf_r3_dumpm41t81_reg00_sec01, tvb, offset_in_bits, 4, ENC_LITTLE_ENDIAN); offset_in_bits += 4;\r\nproto_tree_add_bits_item (tmp_tree [ 1], hf_r3_dumpm41t81_reg01_st, tvb, offset_in_bits, 1, ENC_LITTLE_ENDIAN); offset_in_bits += 1;\r\nproto_tree_add_bits_item (tmp_tree [ 1], hf_r3_dumpm41t81_reg01_10sec, tvb, offset_in_bits, 3, ENC_LITTLE_ENDIAN); offset_in_bits += 3;\r\nproto_tree_add_bits_item (tmp_tree [ 1], hf_r3_dumpm41t81_reg01_1sec, tvb, offset_in_bits, 4, ENC_LITTLE_ENDIAN); offset_in_bits += 4;\r\nproto_tree_add_bits_item (tmp_tree [ 2], hf_r3_dumpm41t81_reg02_notused, tvb, offset_in_bits, 1, ENC_LITTLE_ENDIAN); offset_in_bits += 1;\r\nproto_tree_add_bits_item (tmp_tree [ 2], hf_r3_dumpm41t81_reg02_10min, tvb, offset_in_bits, 3, ENC_LITTLE_ENDIAN); offset_in_bits += 3;\r\nproto_tree_add_bits_item (tmp_tree [ 2], hf_r3_dumpm41t81_reg02_1min, tvb, offset_in_bits, 4, ENC_LITTLE_ENDIAN); offset_in_bits += 4;\r\nproto_tree_add_bits_item (tmp_tree [ 3], hf_r3_dumpm41t81_reg03_cbe, tvb, offset_in_bits, 1, ENC_LITTLE_ENDIAN); offset_in_bits += 1;\r\nproto_tree_add_bits_item (tmp_tree [ 3], hf_r3_dumpm41t81_reg03_cb, tvb, offset_in_bits, 1, ENC_LITTLE_ENDIAN); offset_in_bits += 1;\r\nproto_tree_add_bits_item (tmp_tree [ 3], hf_r3_dumpm41t81_reg03_10hour, tvb, offset_in_bits, 2, ENC_LITTLE_ENDIAN); offset_in_bits += 2;\r\nproto_tree_add_bits_item (tmp_tree [ 3], hf_r3_dumpm41t81_reg03_1hour, tvb, offset_in_bits, 4, ENC_LITTLE_ENDIAN); offset_in_bits += 4;\r\nproto_tree_add_bits_item (tmp_tree [ 4], hf_r3_dumpm41t81_reg04_notused, tvb, offset_in_bits, 5, ENC_LITTLE_ENDIAN); offset_in_bits += 5;\r\nproto_tree_add_bits_item (tmp_tree [ 4], hf_r3_dumpm41t81_reg04_dow, tvb, offset_in_bits, 3, ENC_LITTLE_ENDIAN); offset_in_bits += 3;\r\nproto_tree_add_bits_item (tmp_tree [ 5], hf_r3_dumpm41t81_reg05_notused, tvb, offset_in_bits, 2, ENC_LITTLE_ENDIAN); offset_in_bits += 2;\r\nproto_tree_add_bits_item (tmp_tree [ 5], hf_r3_dumpm41t81_reg05_10day, tvb, offset_in_bits, 2, ENC_LITTLE_ENDIAN); offset_in_bits += 2;\r\nproto_tree_add_bits_item (tmp_tree [ 5], hf_r3_dumpm41t81_reg05_1day, tvb, offset_in_bits, 4, ENC_LITTLE_ENDIAN); offset_in_bits += 4;\r\nproto_tree_add_bits_item (tmp_tree [ 6], hf_r3_dumpm41t81_reg06_notused, tvb, offset_in_bits, 3, ENC_LITTLE_ENDIAN); offset_in_bits += 3;\r\nproto_tree_add_bits_item (tmp_tree [ 6], hf_r3_dumpm41t81_reg06_10month, tvb, offset_in_bits, 1, ENC_LITTLE_ENDIAN); offset_in_bits += 1;\r\nproto_tree_add_bits_item (tmp_tree [ 6], hf_r3_dumpm41t81_reg06_1month, tvb, offset_in_bits, 4, ENC_LITTLE_ENDIAN); offset_in_bits += 4;\r\nproto_tree_add_bits_item (tmp_tree [ 7], hf_r3_dumpm41t81_reg07_10year, tvb, offset_in_bits, 4, ENC_LITTLE_ENDIAN); offset_in_bits += 4;\r\nproto_tree_add_bits_item (tmp_tree [ 7], hf_r3_dumpm41t81_reg07_1year, tvb, offset_in_bits, 4, ENC_LITTLE_ENDIAN); offset_in_bits += 4;\r\nproto_tree_add_bits_item (tmp_tree [ 8], hf_r3_dumpm41t81_reg08_out, tvb, offset_in_bits, 1, ENC_LITTLE_ENDIAN); offset_in_bits += 1;\r\nproto_tree_add_bits_item (tmp_tree [ 8], hf_r3_dumpm41t81_reg08_ft, tvb, offset_in_bits, 1, ENC_LITTLE_ENDIAN); offset_in_bits += 1;\r\nproto_tree_add_bits_item (tmp_tree [ 8], hf_r3_dumpm41t81_reg08_s, tvb, offset_in_bits, 1, ENC_LITTLE_ENDIAN); offset_in_bits += 1;\r\nproto_tree_add_bits_item (tmp_tree [ 8], hf_r3_dumpm41t81_reg08_cal, tvb, offset_in_bits, 5, ENC_LITTLE_ENDIAN); offset_in_bits += 5;\r\nproto_tree_add_bits_item (tmp_tree [ 9], hf_r3_dumpm41t81_reg09_notused, tvb, offset_in_bits, 1, ENC_LITTLE_ENDIAN); offset_in_bits += 1;\r\nproto_tree_add_bits_item (tmp_tree [ 9], hf_r3_dumpm41t81_reg09_bmb, tvb, offset_in_bits, 5, ENC_LITTLE_ENDIAN); offset_in_bits += 5;\r\nproto_tree_add_bits_item (tmp_tree [ 9], hf_r3_dumpm41t81_reg09_rb, tvb, offset_in_bits, 2, ENC_LITTLE_ENDIAN); offset_in_bits += 2;\r\nproto_tree_add_bits_item (tmp_tree [10], hf_r3_dumpm41t81_reg0a_afe, tvb, offset_in_bits, 1, ENC_LITTLE_ENDIAN); offset_in_bits += 1;\r\nproto_tree_add_bits_item (tmp_tree [10], hf_r3_dumpm41t81_reg0a_sqwe, tvb, offset_in_bits, 1, ENC_LITTLE_ENDIAN); offset_in_bits += 1;\r\nproto_tree_add_bits_item (tmp_tree [10], hf_r3_dumpm41t81_reg0a_abe, tvb, offset_in_bits, 1, ENC_LITTLE_ENDIAN); offset_in_bits += 1;\r\nproto_tree_add_bits_item (tmp_tree [10], hf_r3_dumpm41t81_reg0a_10monthalm, tvb, offset_in_bits, 1, ENC_LITTLE_ENDIAN); offset_in_bits += 1;\r\nproto_tree_add_bits_item (tmp_tree [10], hf_r3_dumpm41t81_reg0a_1monthalm, tvb, offset_in_bits, 4, ENC_LITTLE_ENDIAN); offset_in_bits += 4;\r\nproto_tree_add_bits_item (tmp_tree [11], hf_r3_dumpm41t81_reg0b_rpt5, tvb, offset_in_bits, 1, ENC_LITTLE_ENDIAN); offset_in_bits += 1;\r\nproto_tree_add_bits_item (tmp_tree [11], hf_r3_dumpm41t81_reg0b_rpt4, tvb, offset_in_bits, 1, ENC_LITTLE_ENDIAN); offset_in_bits += 1;\r\nproto_tree_add_bits_item (tmp_tree [11], hf_r3_dumpm41t81_reg0b_10dayalm, tvb, offset_in_bits, 2, ENC_LITTLE_ENDIAN); offset_in_bits += 2;\r\nproto_tree_add_bits_item (tmp_tree [11], hf_r3_dumpm41t81_reg0b_1dayalm, tvb, offset_in_bits, 4, ENC_LITTLE_ENDIAN); offset_in_bits += 4;\r\nproto_tree_add_bits_item (tmp_tree [12], hf_r3_dumpm41t81_reg0c_rpt3, tvb, offset_in_bits, 1, ENC_LITTLE_ENDIAN); offset_in_bits += 1;\r\nproto_tree_add_bits_item (tmp_tree [12], hf_r3_dumpm41t81_reg0c_ht, tvb, offset_in_bits, 1, ENC_LITTLE_ENDIAN); offset_in_bits += 1;\r\nproto_tree_add_bits_item (tmp_tree [12], hf_r3_dumpm41t81_reg0c_10houralm, tvb, offset_in_bits, 2, ENC_LITTLE_ENDIAN); offset_in_bits += 2;\r\nproto_tree_add_bits_item (tmp_tree [12], hf_r3_dumpm41t81_reg0c_1houralm, tvb, offset_in_bits, 4, ENC_LITTLE_ENDIAN); offset_in_bits += 4;\r\nproto_tree_add_bits_item (tmp_tree [13], hf_r3_dumpm41t81_reg0d_rpt2, tvb, offset_in_bits, 1, ENC_LITTLE_ENDIAN); offset_in_bits += 1;\r\nproto_tree_add_bits_item (tmp_tree [13], hf_r3_dumpm41t81_reg0d_10minalm, tvb, offset_in_bits, 3, ENC_LITTLE_ENDIAN); offset_in_bits += 3;\r\nproto_tree_add_bits_item (tmp_tree [13], hf_r3_dumpm41t81_reg0d_1minalm, tvb, offset_in_bits, 4, ENC_LITTLE_ENDIAN); offset_in_bits += 4;\r\nproto_tree_add_bits_item (tmp_tree [14], hf_r3_dumpm41t81_reg0e_rpt1, tvb, offset_in_bits, 1, ENC_LITTLE_ENDIAN); offset_in_bits += 1;\r\nproto_tree_add_bits_item (tmp_tree [14], hf_r3_dumpm41t81_reg0e_10secalm, tvb, offset_in_bits, 3, ENC_LITTLE_ENDIAN); offset_in_bits += 3;\r\nproto_tree_add_bits_item (tmp_tree [14], hf_r3_dumpm41t81_reg0e_1secalm, tvb, offset_in_bits, 4, ENC_LITTLE_ENDIAN); offset_in_bits += 4;\r\nproto_tree_add_bits_item (tmp_tree [15], hf_r3_dumpm41t81_reg0f_wdf, tvb, offset_in_bits, 1, ENC_LITTLE_ENDIAN); offset_in_bits += 1;\r\nproto_tree_add_bits_item (tmp_tree [15], hf_r3_dumpm41t81_reg0f_af, tvb, offset_in_bits, 1, ENC_LITTLE_ENDIAN); offset_in_bits += 1;\r\nproto_tree_add_bits_item (tmp_tree [15], hf_r3_dumpm41t81_reg0f_notused, tvb, offset_in_bits, 6, ENC_LITTLE_ENDIAN); offset_in_bits += 6;\r\nproto_tree_add_bits_item (tmp_tree [16], hf_r3_dumpm41t81_reg10_notused, tvb, offset_in_bits, 8, ENC_LITTLE_ENDIAN); offset_in_bits += 8;\r\nproto_tree_add_bits_item (tmp_tree [17], hf_r3_dumpm41t81_reg11_notused, tvb, offset_in_bits, 8, ENC_LITTLE_ENDIAN); offset_in_bits += 8;\r\nproto_tree_add_bits_item (tmp_tree [18], hf_r3_dumpm41t81_reg12_notused, tvb, offset_in_bits, 8, ENC_LITTLE_ENDIAN); offset_in_bits += 8;\r\nproto_tree_add_bits_item (tmp_tree [19], hf_r3_dumpm41t81_reg13_rs, tvb, offset_in_bits - 8, 4, ENC_LITTLE_ENDIAN); offset_in_bits += 4;\r\nproto_tree_add_bits_item (tmp_tree [19], hf_r3_dumpm41t81_reg13_notused, tvb, offset_in_bits - 8, 4, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_upstreammfgfield_nvramchecksumvalue (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nDISSECTOR_ASSERT(start_offset == 0);\r\nproto_tree_add_item (tree, hf_r3_nvramchecksumvalue, tvb, 0, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_nvramchecksumvalue_fixup, tvb, 4, 4, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_upstreammfgfield_checksumresults (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo, proto_tree *tree)\r\n{\r\ngint len;\r\nDISSECTOR_ASSERT(start_offset == 0);\r\nlen = MAX(0, tvb_reported_length_remaining(tvb, 0));\r\nif (len % 3 != 0)\r\n{\r\nexpert_add_info_format(pinfo, proto_tree_get_parent (tree), &ei_r3_malformed_length, "Checksum results data length not modulo 3 == 0");\r\n}\r\nelse\r\n{\r\nproto_tree *cksum_tree;\r\nguint32 error = FALSE;\r\ngint i;\r\nguint8 step;\r\nif (!tree)\r\nreturn;\r\ni = 0;\r\nwhile (i<len && (step=tvb_get_guint8(tvb, i))>0)\r\n{\r\nerror |= tvb_get_guint8 (tvb, i + 2);\r\ni += step;\r\n}\r\ncksum_tree = proto_tree_add_subtree_format(tree, tvb, 0, len, ett_r3checksumresults, NULL,\r\n"Checksum Results (%s)", error ? "Error" : "No Errors");\r\ni = 0;\r\nwhile (i<len && (step=tvb_get_guint8(tvb, i))>0)\r\n{\r\nproto_item *res_item = proto_tree_add_item (cksum_tree, hf_r3_checksumresults,\r\ntvb,\r\ni,\r\ntvb_get_guint8 (tvb, i),\r\nENC_NA);\r\nproto_tree *res_tree = proto_item_add_subtree (res_item, ett_r3checksumresultsfield);\r\nconst gchar *fn;\r\nfn = val_to_str_ext_const (tvb_get_guint8 (tvb, i + 1), &r3_checksumresultnames_ext, "[Unknown Field Name]");\r\nproto_item_append_text (res_item, " %s (%s)", fn, tvb_get_guint8 (tvb, i + 2) ? "Error" : "No Error");\r\nproto_tree_add_item (res_tree, hf_r3_checksumresults_length, tvb, i + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (res_tree, hf_r3_checksumresults_field, tvb, i + 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (res_tree, hf_r3_checksumresults_state, tvb, i + 2, 1, ENC_LITTLE_ENDIAN);\r\ni += step;\r\n}\r\n}\r\n}\r\nstatic void\r\ndissect_r3_upstreammfgfield_mortisestatelog (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\ngint len;\r\ngint i;\r\nif (!tree)\r\nreturn;\r\nDISSECTOR_ASSERT(start_offset == 0);\r\nlen = tvb_reported_length_remaining (tvb, 3);\r\nproto_tree_add_item (tree, hf_r3_mortisestatelog_pointer, tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_mortisestatelog_mortisetype, tvb, 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_mortisestatelog_waiting, tvb, 2, 1, ENC_LITTLE_ENDIAN);\r\nfor (i = 0; i < len; i += 3)\r\n{\r\nguint state = tvb_get_guint8 (tvb, 3 + i + 0);\r\nguint last = tvb_get_guint8 (tvb, 3 + i + 1);\r\nguint event = tvb_get_guint8 (tvb, 3 + i + 2);\r\nproto_tree *ms_tree = proto_tree_add_subtree_format(tree, tvb, 3 + i, 3, ett_r3mortisestatelog, NULL,\r\n"State Log Entry %2d (State=0x%02x, Last=0x%02x, Event=%s (0x%02x))",\r\ni / 3,\r\nstate,\r\nlast,\r\nval_to_str_ext_const (event, &r3_mortiseeventnames_ext, "[Unknown]"),\r\nevent);\r\nproto_tree_add_item (ms_tree, hf_r3_mortisestatelog_state, tvb, 3 + i + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (ms_tree, hf_r3_mortisestatelog_last, tvb, 3 + i + 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (ms_tree, hf_r3_mortisestatelog_event, tvb, 3 + i + 2, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_upstreammfgfield_mortisepins (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree *iopins_tree;\r\nif (!tree)\r\nreturn;\r\nDISSECTOR_ASSERT(start_offset == 0);\r\niopins_tree = proto_tree_add_subtree_format(tree, tvb, 0, 1, ett_r3iopins, NULL,\r\n"Mortise Pin States (0x%02x)", tvb_get_guint8 (tvb, 0));\r\nproto_tree_add_item (iopins_tree, hf_r3_mortisepins_s1, tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (iopins_tree, hf_r3_mortisepins_s2, tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (iopins_tree, hf_r3_mortisepins_s3, tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (iopins_tree, hf_r3_mortisepins_s4, tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_upstreammfgfield_keypadchar (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (!tree)\r\nreturn;\r\nDISSECTOR_ASSERT(start_offset == 0);\r\nproto_item_append_text (\r\nproto_tree_add_item (tree, hf_r3_testkeypad, tvb, 0, 1, ENC_LITTLE_ENDIAN),\r\n" ('%c')", tvb_get_guint8 (tvb, 0));\r\n}\r\nstatic void\r\ndissect_r3_upstreammfgfield_magcard (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nDISSECTOR_ASSERT(start_offset == 0);\r\nproto_tree_add_item (tree, hf_r3_testmagcard, tvb, 0, -1, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void\r\ndissect_r3_upstreammfgfield_proxcard (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nDISSECTOR_ASSERT(start_offset == 0);\r\nproto_tree_add_item (tree, hf_r3_testproxcard, tvb, 0, -1, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void\r\ndissect_r3_response_singlebyte (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_responsetype, tvb, start_offset + 2, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_responsetocommand, tvb, start_offset + 3, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_response_hasdata (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint32 commandPacketLen;\r\nguint8 upstreamCmd;\r\nDISSECTOR_ASSERT(start_offset == 0);\r\ntvb_ensure_bytes_exist (tvb, 0, 4);\r\ncommandPacketLen = tvb_get_guint8 (tvb, 0);\r\nupstreamCmd = tvb_get_guint8 (tvb, 3);\r\nif (tvb_get_guint8 (tvb, 1) != CMD_RESPONSE)\r\nexpert_add_info(pinfo, proto_tree_get_parent (tree), &ei_r3_response_hasdata_octet_1);\r\nelse if (tvb_get_guint8 (tvb, 2) != RESPONSETYPE_HASDATA)\r\nexpert_add_info(pinfo, proto_tree_get_parent (tree), &ei_r3_response_hasdata_octet_2);\r\nelse if (upstreamCmd >= UPSTREAMCOMMAND_LAST)\r\nexpert_add_info(pinfo, proto_tree_get_parent (tree), &ei_r3_response_hasdata_octet_3);\r\nelse\r\n{\r\nproto_tree *upstreamcommand_tree = NULL;\r\ntvbuff_t *upstreamcommand_tvb;\r\nif (tree)\r\n{\r\nconst gchar *ct;\r\nct = val_to_str_ext_const (upstreamCmd, &r3_upstreamcommandnames_ext, "[Unknown Command Type]");\r\nproto_tree_add_item (tree, hf_r3_responsetype, tvb, 2, 1, ENC_LITTLE_ENDIAN);\r\nupstreamcommand_tree = proto_tree_add_subtree_format(tree, tvb, 3, -1, ett_r3upstreamcommand, NULL,\r\n"Upstream Command: %s (%u)", ct, upstreamCmd);\r\nproto_tree_add_item (upstreamcommand_tree, hf_r3_upstreamcommand, tvb, 3, 1, ENC_LITTLE_ENDIAN);\r\n}\r\ntvb_ensure_bytes_exist (tvb, 0, commandPacketLen - 4);\r\nupstreamcommand_tvb = tvb_new_subset_length (tvb, 4, commandPacketLen - 4);\r\nif (r3upstreamcommand_dissect [upstreamCmd])\r\n(*r3upstreamcommand_dissect [upstreamCmd]) (upstreamcommand_tvb, 0, commandPacketLen - 4, pinfo, upstreamcommand_tree);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmd_response (tvbuff_t *tvb, guint32 start_offset, guint32 length, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint8 responseLen = tvb_get_guint8 (tvb, start_offset + 0);\r\nresponseType_e responseType = (responseType_e)tvb_get_guint8 (tvb, start_offset + 2);\r\ntvbuff_t *payload_tvb = tvb_new_subset_length (tvb, start_offset, responseLen);\r\nif (tree)\r\n{\r\nconst gchar *rt;\r\nrt = val_to_str_ext_const (responseType, &r3_responsetypenames_ext, "[Unknown Response Type]");\r\nproto_item_set_text (proto_tree_get_parent (tree), "Response Packet: %s (%u)", rt, responseType);\r\nproto_tree_add_item (tree, hf_r3_responselength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_responsecommand, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nif (responseType >= RESPONSETYPE_LAST)\r\n{\r\nexpert_add_info(pinfo, proto_tree_get_parent (tree), &ei_r3_response_hasdata_octet_3);\r\n}\r\nelse if (r3response_dissect [responseType])\r\n(*r3response_dissect [responseType]) (payload_tvb, 0, length, pinfo, tree);\r\n}\r\nstatic void\r\ndissect_r3_cmd_handshake (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmd_killsession (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmd_queryserialnumber (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmd_queryversion (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmd_setdatetime (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree *dt_tree;\r\nguint8 cmdLen;\r\ntvbuff_t *payload_tvb;\r\nif (!tree)\r\nreturn;\r\ncmdLen = tvb_get_guint8 (tvb, start_offset + 0);\r\npayload_tvb = tvb_new_subset_length (tvb, start_offset + 2, cmdLen - 2);\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\ndt_tree = proto_tree_add_subtree_format (tree, payload_tvb, 0, -1, ett_r3setdatetime, NULL,\r\n"Set Date/Time (%02u/%02u/%02u-%u %02u:%02u:%02u)",\r\ntvb_get_guint8 (payload_tvb, 0),\r\ntvb_get_guint8 (payload_tvb, 1),\r\ntvb_get_guint8 (payload_tvb, 2),\r\ntvb_get_guint8 (payload_tvb, 3),\r\ntvb_get_guint8 (payload_tvb, 4),\r\ntvb_get_guint8 (payload_tvb, 5),\r\ntvb_get_guint8 (payload_tvb, 6));\r\nproto_tree_add_item (dt_tree, hf_r3_setdate_year, payload_tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (dt_tree, hf_r3_setdate_month, payload_tvb, 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (dt_tree, hf_r3_setdate_day, payload_tvb, 2, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (dt_tree, hf_r3_setdate_dow, payload_tvb, 3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (dt_tree, hf_r3_setdate_hours, payload_tvb, 4, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (dt_tree, hf_r3_setdate_minutes, payload_tvb, 5, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (dt_tree, hf_r3_setdate_seconds, payload_tvb, 6, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_cmd_querydatetime (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmd_setconfig (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint cmdLen;\r\ntvbuff_t *payload_tvb;\r\nguint32 offset = 0;\r\nif (!tree)\r\nreturn;\r\ncmdLen = tvb_get_guint8 (tvb, start_offset + 0);\r\npayload_tvb = tvb_new_subset_length (tvb, start_offset + 2, cmdLen - 2);\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nwhile (offset < (cmdLen - 2))\r\n{\r\nproto_item *sc_item;\r\nproto_tree *sc_tree;\r\nconst gchar *ci;\r\nguint8 configItem;\r\nguint8 item_length;\r\nconfigItem = tvb_get_guint8 (payload_tvb, offset + 1);\r\nci = val_to_str_ext_const (\r\nconfigItem,\r\n&r3_configitemnames_ext,\r\n"[Unknown Configuration Item]");\r\nitem_length = tvb_get_guint8 (payload_tvb, offset + 0);\r\nsc_tree = proto_tree_add_subtree_format(tree, payload_tvb, offset + 0, item_length,\r\nett_r3upstreamfield, NULL, "Config Field: %s (%u)", ci, configItem);\r\nsc_item = proto_tree_add_item (sc_tree, hf_r3_configitemlength, payload_tvb, offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (sc_tree, hf_r3_configitem, payload_tvb, offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nif (item_length == 0) {\r\nexpert_add_info_format(pinfo, sc_item, &ei_r3_malformed_length, "Invalid item length");\r\nreturn;\r\n}\r\nif (configItem < array_length (configMap))\r\n{\r\nswitch (configMap [configItem])\r\n{\r\ncase CONFIGTYPE_NONE :\r\nproto_tree_add_item (sc_tree, hf_r3_configitemdata, payload_tvb, offset + 2, item_length - 3, ENC_NA);\r\nbreak;\r\ncase CONFIGTYPE_BOOL :\r\nproto_tree_add_item (sc_tree, hf_r3_configitemdata_bool, payload_tvb, offset + 2, 1, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase CONFIGTYPE_8 :\r\nproto_tree_add_item (sc_tree, hf_r3_configitemdata_8, payload_tvb, offset + 2, 1, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase CONFIGTYPE_16 :\r\nproto_tree_add_item (sc_tree, hf_r3_configitemdata_16, payload_tvb, offset + 2, 2, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase CONFIGTYPE_32 :\r\nproto_tree_add_item (sc_tree, hf_r3_configitemdata_32, payload_tvb, offset + 2, 4, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase CONFIGTYPE_STRING :\r\nproto_tree_add_item (sc_tree, hf_r3_configitemdata_string, payload_tvb, offset + 2,\r\nitem_length - 2, ENC_ASCII|ENC_NA);\r\nbreak;\r\ndefault :\r\nproto_tree_add_none_format (sc_tree, hf_r3_upstreamfielderror, payload_tvb, offset + 2,\r\nitem_length - 2, "Unknown Field Type");\r\nbreak;\r\n}\r\n}\r\nelse {\r\nproto_tree_add_none_format (sc_tree, hf_r3_upstreamfielderror, payload_tvb, offset + 2,\r\nitem_length - 2, "Unknown Field Type");\r\n}\r\noffset += item_length;\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmd_getconfig (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_item *config_item;\r\nproto_tree *config_tree;\r\nguint32 cmdLen;\r\nguint32 i;\r\nif (!tree)\r\nreturn;\r\ncmdLen = tvb_get_guint8 (tvb, start_offset + 0);\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nconfig_item = proto_tree_add_item (tree, hf_r3_configitems, tvb, start_offset + 2, cmdLen - 2, ENC_NA);\r\nconfig_tree = proto_item_add_subtree (config_item, ett_r3configitem);\r\nfor (i = 2; i < cmdLen; i++)\r\nproto_tree_add_item (config_tree, hf_r3_configitem, tvb, start_offset + i, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_cmd_manageuser (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint8 cmdLen = tvb_get_guint8 (tvb, start_offset + 0);\r\ntvbuff_t *payload_tvb = tvb_new_subset_length (tvb, start_offset + 2, cmdLen - 2);\r\nguint32 offset = 0;\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nwhile (offset < tvb_reported_length (payload_tvb))\r\n{\r\nguint32 paramLength = tvb_get_guint8 (payload_tvb, offset + 0);\r\nguint32 paramType = tvb_get_guint8 (payload_tvb, offset + 1);\r\nguint32 dataLength = paramLength - 2;\r\nproto_tree *mu_tree = NULL;\r\nproto_item *len_field = NULL;\r\nif (tree)\r\n{\r\nconst gchar *auptn;\r\nauptn = val_to_str_ext_const (paramType, &r3_adduserparamtypenames_ext, "[Unknown Field]");\r\nmu_tree = proto_item_add_subtree (\r\nproto_tree_add_none_format (tree, hf_r3_adduserparamtype, payload_tvb, offset + 0, paramLength,\r\n"Manage User Field: %s (%u)", auptn, paramType), ett_r3manageuser);\r\nlen_field = proto_tree_add_item (mu_tree, hf_r3_adduserparamtypelength, payload_tvb, offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (mu_tree, hf_r3_adduserparamtypetype, payload_tvb, offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nif (paramLength < 2)\r\n{\r\ndataLength = 0;\r\nexpert_add_info_format(pinfo, len_field, &ei_r3_malformed_length, "Malformed length value -- all fields are at least 2 octets.");\r\n}\r\noffset += 2;\r\nswitch (paramType)\r\n{\r\ncase ADDUSERPARAMTYPE_DISPOSITION :\r\ncase ADDUSERPARAMTYPE_ACCESSALWAYS :\r\ncase ADDUSERPARAMTYPE_ACCESSMODE :\r\ncase ADDUSERPARAMTYPE_CACHED :\r\ncase ADDUSERPARAMTYPE_USERTYPE :\r\ncase ADDUSERPARAMTYPE_PRIMARYFIELDTYPE :\r\ncase ADDUSERPARAMTYPE_AUXFIELDTYPE :\r\ncase ADDUSERPARAMTYPE_USECOUNT :\r\ncase ADDUSERPARAMTYPE_EXCEPTIONGROUP :\r\nif (dataLength != 1)\r\n{\r\nexpert_add_info_format(pinfo, proto_tree_get_parent (mu_tree), &ei_r3_malformed_length, "Malformed field -- expected 1 octet");\r\n}\r\nelse\r\nproto_tree_add_item (mu_tree, hf_r3_adduserparamtypearray [paramType], payload_tvb, offset, dataLength, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase ADDUSERPARAMTYPE_USERNO :\r\nif (dataLength != 2)\r\n{\r\nexpert_add_info_format(pinfo, proto_tree_get_parent (mu_tree), &ei_r3_malformed_length, "Malformed field -- expected 2 octets");\r\n}\r\nelse\r\nproto_tree_add_item (mu_tree, hf_r3_adduserparamtypearray [paramType], payload_tvb, offset, dataLength, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase ADDUSERPARAMTYPE_PRIMARYFIELD :\r\ncase ADDUSERPARAMTYPE_AUXFIELD :\r\nproto_tree_add_item (mu_tree, hf_r3_adduserparamtypearray [paramType], payload_tvb, offset, dataLength, ENC_NA);\r\nbreak;\r\ncase ADDUSERPARAMTYPE_EXPIREON :\r\n{\r\nif (dataLength != 3)\r\n{\r\nexpert_add_info_format(pinfo, proto_tree_get_parent (mu_tree), &ei_r3_malformed_length, "Malformed expiration field -- expected 3 octets");\r\n}\r\nelse\r\n{\r\nproto_tree *expireon_tree;\r\nif (!tree)\r\nbreak;\r\nexpireon_tree = proto_tree_add_subtree_format(mu_tree, payload_tvb, offset, 3,\r\nett_r3expireon, NULL,\r\n"Expire YY/MM/DD: %02u/%02u/%02u",\r\ntvb_get_guint8 (payload_tvb, offset + 2),\r\ntvb_get_guint8 (payload_tvb, offset + 0),\r\ntvb_get_guint8 (payload_tvb, offset + 1));\r\nproto_tree_add_item (expireon_tree, hf_r3_expireon_month, payload_tvb, offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (expireon_tree, hf_r3_expireon_day, payload_tvb, offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (expireon_tree, hf_r3_expireon_year, payload_tvb, offset + 2, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nbreak;\r\ncase ADDUSERPARAMTYPE_TIMEZONE :\r\n{\r\nif (dataLength != 4)\r\n{\r\nexpert_add_info_format(pinfo, proto_tree_get_parent (mu_tree), &ei_r3_malformed_length, "Malformed timezone field -- expected 4 octets");\r\n}\r\nelse\r\n{\r\nproto_tree_add_bitmask(mu_tree, payload_tvb, offset, hf_r3_adduserparamtypearray[paramType], ett_r3timezone, r3_timezonearray, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nbreak;\r\ndefault :\r\nproto_tree_add_string (mu_tree, hf_r3_upstreamfielderror, payload_tvb, offset, dataLength, "Unknown Field Type");\r\nbreak;\r\n}\r\noffset += dataLength;\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmd_deleteusers (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nguint8 cmdLen;\r\ntvbuff_t *payload_tvb;\r\nif (!tree)\r\nreturn;\r\ncmdLen = tvb_get_guint8 (tvb, start_offset + 0);\r\npayload_tvb = tvb_new_subset_length (tvb, start_offset + 2, cmdLen - 2);\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_deleteusers, payload_tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_cmd_defineexception (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree *startdate_tree;\r\nproto_tree *enddate_tree;\r\nguint8 cmdLen;\r\ntvbuff_t *payload_tvb;\r\nif (!tree)\r\nreturn;\r\ncmdLen = tvb_get_guint8 (tvb, start_offset + 0);\r\npayload_tvb = tvb_new_subset_length (tvb, start_offset + 2, cmdLen - 2);\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_defineexception_number, payload_tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nstartdate_tree = proto_tree_add_subtree_format(tree, payload_tvb, 1, 4,\r\nett_r3defineexceptionstartdate, NULL,\r\n"Start MM/DD HH:MM (%02u/%02u %02u:%02u)",\r\ntvb_get_guint8 (payload_tvb, 1),\r\ntvb_get_guint8 (payload_tvb, 2),\r\ntvb_get_guint8 (payload_tvb, 3),\r\ntvb_get_guint8 (payload_tvb, 4));\r\nproto_tree_add_item (startdate_tree, hf_r3_defineexception_startdate_month, payload_tvb, 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (startdate_tree, hf_r3_defineexception_startdate_day, payload_tvb, 2, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (startdate_tree, hf_r3_defineexception_startdate_hours, payload_tvb, 3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (startdate_tree, hf_r3_defineexception_startdate_minutes, payload_tvb, 4, 1, ENC_LITTLE_ENDIAN);\r\nenddate_tree = proto_tree_add_subtree_format(tree, payload_tvb, 5, 4,\r\nett_r3defineexceptionenddate, NULL,\r\n"End MM/DD HH:MM (%02u/%02u %02u:%02u)",\r\ntvb_get_guint8 (payload_tvb, 5),\r\ntvb_get_guint8 (payload_tvb, 6),\r\ntvb_get_guint8 (payload_tvb, 7),\r\ntvb_get_guint8 (payload_tvb, 8));\r\nproto_tree_add_item (enddate_tree, hf_r3_defineexception_enddate_month, payload_tvb, 5, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (enddate_tree, hf_r3_defineexception_enddate_day, payload_tvb, 6, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (enddate_tree, hf_r3_defineexception_enddate_hours, payload_tvb, 7, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (enddate_tree, hf_r3_defineexception_enddate_minutes, payload_tvb, 8, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_cmd_defineexceptiongroup (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree *bits_tree;\r\nguint cmdLen;\r\ntvbuff_t *payload_tvb;\r\nguint32 i;\r\nguint32 bit = 0;\r\nif (!tree)\r\nreturn;\r\ncmdLen = tvb_get_guint8 (tvb, start_offset + 0);\r\npayload_tvb = tvb_new_subset_length (tvb, start_offset + 2, cmdLen - 2);\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_defineexceptiongroup_number, payload_tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nbits_tree = proto_tree_add_subtree(tree, payload_tvb, 1, -1, ett_r3defineexceptiongroupbits, NULL, "Exception Group Bit Field");\r\nfor (i = 1; i < (cmdLen - 2); i++)\r\n{\r\nguint32 j;\r\nguint8 byte = tvb_get_guint8 (payload_tvb, i);\r\nfor (j = 0; j < 8; j++)\r\nproto_tree_add_none_format (bits_tree, hf_r3_defineexceptiongroup_bits, payload_tvb, i, 1,\r\n"Exception Group %2d: %s", bit++, (byte & (1 << j)) ? "Enabled" : "Disabled");\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmd_definecalendar (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nguint8 cmdLen;\r\ntvbuff_t *payload_tvb;\r\nconst gchar *mn;\r\nguint32 i;\r\nif (!tree)\r\nreturn;\r\ncmdLen = tvb_get_guint8 (tvb, start_offset + 0);\r\npayload_tvb = tvb_new_subset_length (tvb, start_offset + 2, cmdLen - 2);\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_definecalendar_number, payload_tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nfor (i = 0; i < 12; i++)\r\n{\r\nguint32 daymap = tvb_get_letohl (payload_tvb, (i * 4) + 1);\r\nproto_tree *calendar_tree = proto_tree_add_subtree_format(tree, payload_tvb, (i * 4) + 1, 4,\r\nett_r3definecalendarmonth [i + 1], NULL,\r\n"Calendar Bit Field - %s (0x%08x)",\r\n(mn = val_to_str_ext_const (i + 1, &r3_monthnames_ext, "[Unknown Month]")),\r\ndaymap);\r\nguint32 j;\r\nfor (j = 0; j < 31; j++)\r\nproto_tree_add_none_format (calendar_tree, hf_r3_definecalendar_bits, payload_tvb, (i * 4) + 1, 4,\r\n"%s Of %s: %s",\r\nval_to_str_ext_const (j + 1, &r3_monthdaynames_ext, "[Unknown Day]"),\r\nmn,\r\n(daymap & (1 << j)) ? "Enabled" : "Disabled");\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmd_definetimezone (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree *starttime_tree;\r\nproto_tree *endtime_tree;\r\nguint8 cmdLen;\r\ntvbuff_t *payload_tvb;\r\nguint8 tzmode;\r\nif (!tree)\r\nreturn;\r\ncmdLen = tvb_get_guint8 (tvb, start_offset + 0);\r\npayload_tvb = tvb_new_subset_length (tvb, start_offset + 2, cmdLen - 2);\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_definetimezone_number, payload_tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nstarttime_tree = proto_tree_add_subtree_format(tree, payload_tvb, 1, 2,\r\nett_r3definetimezonestarttime, NULL,\r\n"Start HH:MM (%02u:%02u)",\r\ntvb_get_guint8 (payload_tvb, 1),\r\ntvb_get_guint8 (payload_tvb, 2));\r\nproto_tree_add_item (starttime_tree, hf_r3_definetimezone_starttime_hours, payload_tvb, 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (starttime_tree, hf_r3_definetimezone_starttime_minutes, payload_tvb, 2, 1, ENC_LITTLE_ENDIAN);\r\nendtime_tree = proto_tree_add_subtree_format(tree, payload_tvb, 3, 2,\r\nett_r3definetimezoneendtime, NULL,\r\n"End HH:MM (%02u:%02u)",\r\ntvb_get_guint8 (payload_tvb, 3),\r\ntvb_get_guint8 (payload_tvb, 4));\r\nproto_tree_add_item (endtime_tree, hf_r3_definetimezone_endtime_hours, payload_tvb, 3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (endtime_tree, hf_r3_definetimezone_endtime_minutes, payload_tvb, 4, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_bitmask(tree, payload_tvb, 5, hf_r3_definetimezone_daymap, ett_r3definetimezonedaymap, r3_definetimezone_daymap, ENC_NA);\r\nproto_tree_add_item (tree, hf_r3_definetimezone_exceptiongroup, payload_tvb, 6, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_uint (tree, hf_r3_definetimezone_mode, payload_tvb, 7, 1,\r\n(tzmode = tvb_get_guint8 (payload_tvb, 7)) & 0x0f);\r\nproto_tree_add_none_format (tree, hf_r3_definetimezone_calendar, payload_tvb, 7, 1,\r\n"Access Always: %s", (tzmode & 0x10) ? "True" : "False");\r\n}\r\nstatic void\r\ndissect_r3_cmd_rmtauthretry (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nguint8 cmdLen;\r\ntvbuff_t *payload_tvb;\r\nif (!tree)\r\nreturn;\r\ncmdLen = tvb_get_guint8 (tvb, start_offset + 0);\r\npayload_tvb = tvb_new_subset_length (tvb, start_offset + 2, cmdLen - 2);\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_rmtauthretry_sequence, payload_tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_rmtauthretry_retry, payload_tvb, 2, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_cmd_filters (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree *filter_tree;\r\nguint8 cmdLen;\r\ntvbuff_t *payload_tvb;\r\nguint32 i;\r\nif (!tree)\r\nreturn;\r\ncmdLen = tvb_get_guint8 (tvb, start_offset + 0);\r\npayload_tvb = tvb_new_subset_length (tvb, start_offset + 2, cmdLen - 2);\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_filter_type, payload_tvb, 1, 1, ENC_LITTLE_ENDIAN);\r\nfilter_tree = proto_tree_add_subtree_format(tree, payload_tvb, 2, -1, ett_r3filters, NULL,\r\n"Filters (%u specified)", tvb_get_guint8 (payload_tvb, 0));\r\nfor (i = 0; i < tvb_get_guint8 (payload_tvb, 0); i++)\r\nproto_tree_add_item (filter_tree, hf_r3_filter_list, payload_tvb, i + 2, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_cmd_alarmconfigure (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo, proto_tree *tree)\r\n{\r\nproto_item *alarm_item;\r\nproto_tree *alarm_tree;\r\nguint cmdLen;\r\ntvbuff_t *payload_tvb;\r\nguint32 offset = 0;\r\nguint32 alarms = 0;\r\nif (!tree)\r\nreturn;\r\ncmdLen = tvb_get_guint8 (tvb, start_offset + 0);\r\npayload_tvb = tvb_new_subset_length (tvb, start_offset + 2, cmdLen - 2);\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nalarm_tree = proto_tree_add_subtree(tree, payload_tvb, 0, -1, ett_r3alarmlist, &alarm_item, "Alarm List (0 items)");\r\nwhile (offset < (cmdLen - 2))\r\n{\r\nproto_item *pi;\r\nproto_tree *alarmcfg_tree;\r\nconst gchar *ai;\r\nconst gchar *as;\r\nguint32 alarm_len;\r\nif (!(ai = try_val_to_str_ext (tvb_get_guint8 (payload_tvb, offset + 1), &r3_alarmidnames_ext)))\r\n{\r\nai = "[Unknown Alarm ID]";\r\nas = "N/A";\r\n}\r\nelse\r\nas = (tvb_get_guint8 (payload_tvb, offset + 2) & 0xfe) ?\r\n"Error" : (tvb_get_guint8 (payload_tvb, offset + 2) & 0x01) ? "Enabled" : "Disabled";\r\nalarmcfg_tree = proto_tree_add_subtree_format(alarm_tree, payload_tvb, offset, tvb_get_guint8 (payload_tvb, offset),\r\nett_r3alarmcfg, NULL, "Alarm Item (%s, %s)", ai, as);\r\nalarm_len = tvb_get_guint8 (payload_tvb, offset + 0);\r\npi = proto_tree_add_item (alarmcfg_tree, hf_r3_alarm_length, payload_tvb, offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nif (alarm_len == 0) {\r\nexpert_add_info_format (pinfo, pi, &ei_r3_malformed_length,\r\n"Alarm length equal to 0. Payload could be partially decoded");\r\nbreak;\r\n}\r\nproto_tree_add_item (alarmcfg_tree, hf_r3_alarm_id, payload_tvb, offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (alarmcfg_tree, hf_r3_alarm_state, payload_tvb, offset + 2, 1, ENC_LITTLE_ENDIAN);\r\nalarms++;\r\noffset += alarm_len;\r\n}\r\nif (alarms)\r\nproto_item_set_text (alarm_item, "Alarm List (%d items)", alarms);\r\n}\r\nstatic void\r\ndissect_r3_cmd_eventlogdump (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree *starttime_tree;\r\nproto_tree *endtime_tree;\r\nguint8 cmdLen;\r\ntvbuff_t *payload_tvb;\r\nif (!tree)\r\nreturn;\r\ncmdLen = tvb_get_guint8 (tvb, start_offset + 0);\r\npayload_tvb = tvb_new_subset_length (tvb, start_offset + 2, cmdLen - 2);\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nstarttime_tree = proto_tree_add_subtree_format(tree, payload_tvb, 0, 5,\r\nett_r3eventlogdumpstarttime, NULL,\r\n"Start YY/MM/DD HH:MM (%02u/%02u/%02u %02u:%02u)",\r\ntvb_get_guint8 (payload_tvb, 0),\r\ntvb_get_guint8 (payload_tvb, 1),\r\ntvb_get_guint8 (payload_tvb, 2),\r\ntvb_get_guint8 (payload_tvb, 3),\r\ntvb_get_guint8 (payload_tvb, 4));\r\nproto_tree_add_item (starttime_tree, hf_r3_eventlogdump_starttime_year, payload_tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (starttime_tree, hf_r3_eventlogdump_starttime_month, payload_tvb, 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (starttime_tree, hf_r3_eventlogdump_starttime_day, payload_tvb, 2, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (starttime_tree, hf_r3_eventlogdump_starttime_hours, payload_tvb, 3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (starttime_tree, hf_r3_eventlogdump_starttime_minutes, payload_tvb, 4, 1, ENC_LITTLE_ENDIAN);\r\nendtime_tree = proto_tree_add_subtree_format(tree, payload_tvb, 5, 5,\r\nett_r3eventlogdumpendtime, NULL,\r\n"End YY/MM/DD HH:MM (%02u/%02u/%02u %02u:%02u)",\r\ntvb_get_guint8 (payload_tvb, 5),\r\ntvb_get_guint8 (payload_tvb, 6),\r\ntvb_get_guint8 (payload_tvb, 7),\r\ntvb_get_guint8 (payload_tvb, 8),\r\ntvb_get_guint8 (payload_tvb, 9));\r\nproto_tree_add_item (endtime_tree, hf_r3_eventlogdump_endtime_year, payload_tvb, 5, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (endtime_tree, hf_r3_eventlogdump_endtime_month, payload_tvb, 6, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (endtime_tree, hf_r3_eventlogdump_endtime_day, payload_tvb, 7, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (endtime_tree, hf_r3_eventlogdump_endtime_hours, payload_tvb, 8, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (endtime_tree, hf_r3_eventlogdump_endtime_minutes, payload_tvb, 9, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_eventlogdump_user, payload_tvb, 10, 2, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_cmd_declinedlogdump (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree *starttime_tree;\r\nproto_tree *endtime_tree;\r\nguint8 cmdLen;\r\ntvbuff_t *payload_tvb;\r\nif (!tree)\r\nreturn;\r\ncmdLen = tvb_get_guint8 (tvb, start_offset + 0);\r\npayload_tvb = tvb_new_subset_length (tvb, start_offset + 2, cmdLen - 2);\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nstarttime_tree = proto_tree_add_subtree_format(tree, payload_tvb, 0, 5,\r\nett_r3declinedlogdumpstarttime, NULL,\r\n"Start YY/MM/DD HH:MM (%02u/%02u/%02u %02u:%02u)",\r\ntvb_get_guint8 (payload_tvb, 0),\r\ntvb_get_guint8 (payload_tvb, 1),\r\ntvb_get_guint8 (payload_tvb, 2),\r\ntvb_get_guint8 (payload_tvb, 3),\r\ntvb_get_guint8 (payload_tvb, 4));\r\nproto_tree_add_item (starttime_tree, hf_r3_declinedlogdump_starttime_year, payload_tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (starttime_tree, hf_r3_declinedlogdump_starttime_month, payload_tvb, 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (starttime_tree, hf_r3_declinedlogdump_starttime_day, payload_tvb, 2, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (starttime_tree, hf_r3_declinedlogdump_starttime_hours, payload_tvb, 3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (starttime_tree, hf_r3_declinedlogdump_starttime_minutes, payload_tvb, 4, 1, ENC_LITTLE_ENDIAN);\r\nendtime_tree = proto_tree_add_subtree_format(tree, payload_tvb, 5, 5,\r\nett_r3declinedlogdumpendtime, NULL,\r\n"End YY/MM/DD HH:MM (%02u/%02u/%02u %02u:%02u)",\r\ntvb_get_guint8 (payload_tvb, 5),\r\ntvb_get_guint8 (payload_tvb, 6),\r\ntvb_get_guint8 (payload_tvb, 7),\r\ntvb_get_guint8 (payload_tvb, 8),\r\ntvb_get_guint8 (payload_tvb, 9));\r\nproto_tree_add_item (endtime_tree, hf_r3_declinedlogdump_endtime_year, payload_tvb, 5, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (endtime_tree, hf_r3_declinedlogdump_endtime_month, payload_tvb, 6, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (endtime_tree, hf_r3_declinedlogdump_endtime_day, payload_tvb, 7, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (endtime_tree, hf_r3_declinedlogdump_endtime_hours, payload_tvb, 8, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (endtime_tree, hf_r3_declinedlogdump_endtime_minutes, payload_tvb, 9, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_cmd_alarmlogdump (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree *starttime_tree;\r\nproto_tree *endtime_tree;\r\nguint8 cmdLen;\r\ntvbuff_t *payload_tvb;\r\nif (!tree)\r\nreturn;\r\ncmdLen = tvb_get_guint8 (tvb, start_offset + 0);\r\npayload_tvb = tvb_new_subset_length (tvb, start_offset + 2, cmdLen - 2);\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nstarttime_tree = proto_tree_add_subtree_format(tree, payload_tvb, 0, 5,\r\nett_r3alarmlogdumpstarttime, NULL,\r\n"Start YY/MM/DD HH:MM (%02u/%02u/%02u %02u:%02u)",\r\ntvb_get_guint8 (payload_tvb, 0),\r\ntvb_get_guint8 (payload_tvb, 1),\r\ntvb_get_guint8 (payload_tvb, 2),\r\ntvb_get_guint8 (payload_tvb, 3),\r\ntvb_get_guint8 (payload_tvb, 4));\r\nproto_tree_add_item (starttime_tree, hf_r3_alarmlogdump_starttime_year, payload_tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (starttime_tree, hf_r3_alarmlogdump_starttime_month, payload_tvb, 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (starttime_tree, hf_r3_alarmlogdump_starttime_day, payload_tvb, 2, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (starttime_tree, hf_r3_alarmlogdump_starttime_hours, payload_tvb, 3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (starttime_tree, hf_r3_alarmlogdump_starttime_minutes, payload_tvb, 4, 1, ENC_LITTLE_ENDIAN);\r\nendtime_tree = proto_tree_add_subtree_format(tree, payload_tvb, 5, 5,\r\nett_r3alarmlogdumpendtime, NULL,\r\n"End YY/MM/DD HH:MM (%02u/%02u/%02u %02u:%02u)",\r\ntvb_get_guint8 (payload_tvb, 5),\r\ntvb_get_guint8 (payload_tvb, 6),\r\ntvb_get_guint8 (payload_tvb, 7),\r\ntvb_get_guint8 (payload_tvb, 8),\r\ntvb_get_guint8 (payload_tvb, 9));\r\nproto_tree_add_item (endtime_tree, hf_r3_alarmlogdump_endtime_year, payload_tvb, 5, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (endtime_tree, hf_r3_alarmlogdump_endtime_month, payload_tvb, 6, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (endtime_tree, hf_r3_alarmlogdump_endtime_day, payload_tvb, 7, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (endtime_tree, hf_r3_alarmlogdump_endtime_hours, payload_tvb, 8, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (endtime_tree, hf_r3_alarmlogdump_endtime_minutes, payload_tvb, 9, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_cmd_downloadfirmware (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo, proto_tree *tree)\r\n{\r\nproto_item *dlfw_item = NULL;\r\nproto_item *dlfw_action_item = NULL;\r\nproto_tree *dlfw_tree = NULL;\r\nguint8 cmdLen;\r\ntvbuff_t *payload_tvb;\r\nguint32 packetCRC;\r\nguint32 calculatedCRC;\r\ncmdLen = tvb_get_guint8 (tvb, start_offset + 0);\r\npayload_tvb = tvb_new_subset_length (tvb, start_offset + 2, cmdLen - 2);\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\ndlfw_tree = proto_tree_add_subtree_format(tree, payload_tvb, 0, -1, ett_r3downloadfirmware, &dlfw_item,\r\n"Download Record (Record #%u, ", tvb_get_letohs (payload_tvb, 2));\r\nproto_tree_add_item (dlfw_tree, hf_r3_firmwaredownload_length, payload_tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (dlfw_tree, hf_r3_firmwaredownload_record, payload_tvb, 2, 2, ENC_LITTLE_ENDIAN);\r\ndlfw_action_item = proto_tree_add_item (dlfw_tree, hf_r3_firmwaredownload_action, payload_tvb, 4, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nswitch (tvb_get_guint8 (payload_tvb, 4))\r\n{\r\ncase DOWNLOADFIRMWARE_START :\r\nif (!dlfw_tree)\r\nbreak;\r\nproto_item_append_text (dlfw_item, "DOWNLOADFIRMWARE_START)");\r\nproto_tree_add_item (dlfw_tree, hf_r3_firmwaredownload_timeout, payload_tvb, 5, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (dlfw_tree, hf_r3_firmwaredownload_nvram, payload_tvb, 6, 1, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase DOWNLOADFIRMWARE_DATA :\r\nif (!dlfw_tree)\r\nbreak;\r\nproto_item_append_text (dlfw_item, "DOWNLOADFIRMWARE_DATA, Address 0x%08x, %u Bytes)",\r\ntvb_get_letohl (payload_tvb, 5), tvb_get_guint8 (payload_tvb, 9));\r\nproto_tree_add_item (dlfw_tree, hf_r3_firmwaredownload_address, payload_tvb, 5, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (dlfw_tree, hf_r3_firmwaredownload_bytes, payload_tvb, 9, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (dlfw_tree, hf_r3_firmwaredownload_data, payload_tvb, 10,\r\ntvb_get_guint8 (payload_tvb, 9), ENC_NA);\r\nbreak;\r\ncase DOWNLOADFIRMWARE_COMPLETE :\r\nif (!dlfw_tree)\r\nbreak;\r\nproto_item_append_text (dlfw_item, "DOWNLOADFIRMWARE_COMPLETE)");\r\nbreak;\r\ncase DOWNLOADFIRMWARE_ABORT :\r\nif (!dlfw_tree)\r\nbreak;\r\nproto_item_append_text (dlfw_item, "DOWNLOADFIRMWARE_ABORT)");\r\nbreak;\r\ncase DOWNLOADFIRMWARE_RESET :\r\nif (!dlfw_tree)\r\nbreak;\r\nproto_item_append_text (dlfw_item, "DOWNLOADFIRMWARE_RESET)");\r\nbreak;\r\ndefault :\r\nexpert_add_info(pinfo, dlfw_action_item, &ei_r3_firmwaredownload_action);\r\nreturn;\r\n}\r\nif (!dlfw_tree)\r\nreturn;\r\npacketCRC = tvb_get_letohs (payload_tvb, cmdLen - 2 - 2);\r\nif ((calculatedCRC = crc16_r3_ccitt_tvb(payload_tvb, 0, cmdLen - 2 - 2)) == packetCRC)\r\nproto_tree_add_uint_format_value(dlfw_tree, hf_r3_firmwaredownload_crc, payload_tvb,\r\ncmdLen - 2 - 2, 2,\r\npacketCRC, "0x%04x (correct)", packetCRC);\r\nelse\r\n{\r\nproto_item *tmp_item;\r\nproto_tree_add_uint_format_value(dlfw_tree, hf_r3_firmwaredownload_crc, payload_tvb,\r\ncmdLen - 2 - 2, 2,\r\npacketCRC, "0x%04x (incorrect, should be 0x%04x)", calculatedCRC, packetCRC);\r\ntmp_item = proto_tree_add_boolean (dlfw_tree, hf_r3_firmwaredownload_crc_bad, payload_tvb,\r\ncmdLen - 2 - 2, 2, TRUE);\r\nPROTO_ITEM_SET_GENERATED (tmp_item);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmd_downloadfirmwaretimeout (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint8 cmdLen;\r\ntvbuff_t *payload_tvb;\r\nif (tree)\r\n{\r\ncmdLen = tvb_get_guint8 (tvb, start_offset + 0);\r\npayload_tvb = tvb_new_subset_length (tvb, start_offset + 2, cmdLen - 2);\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commanddata, payload_tvb, 0, -1, ENC_NA);\r\n}\r\nexpert_add_info(pinfo, proto_tree_get_parent (tree), &ei_r3_cmd_downloadfirmwaretimeout);\r\n}\r\nstatic void\r\ndissect_r3_cmd_powertableselection (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nguint8 cmdLen;\r\ntvbuff_t *payload_tvb;\r\nif (!tree)\r\nreturn;\r\ncmdLen = tvb_get_guint8 (tvb, start_offset + 0);\r\npayload_tvb = tvb_new_subset_length (tvb, start_offset + 2, cmdLen - 2);\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_powertableselection, payload_tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_cmd_clearnvram (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, start_offset + 2, hf_r3_nvramclearoptions,\r\nett_r3clearnvram, r3_nvramclearoptions, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_cmd_dpac (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nguint8 cmdLen;\r\ntvbuff_t *payload_tvb;\r\nif (!tree)\r\nreturn;\r\ncmdLen = tvb_get_guint8 (tvb, start_offset + 0);\r\npayload_tvb = tvb_new_subset_length (tvb, start_offset + 2, cmdLen - 2);\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_dpac_action, payload_tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_dpac_waittime, payload_tvb, 1, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_dpac_command, payload_tvb, 3, -1, ENC_NA);\r\n}\r\nstatic void\r\ndissect_r3_cmd_selftest (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmd_reset (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmd_logwrite (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nguint8 cmdLen;\r\ntvbuff_t *payload_tvb;\r\nif (!tree)\r\nreturn;\r\ncmdLen = tvb_get_guint8 (tvb, start_offset + 0);\r\npayload_tvb = tvb_new_subset_length (tvb, start_offset + 2, cmdLen - 2);\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_writeeventlog_user, payload_tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_writeeventlog_event, payload_tvb, 2, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_cmd_mfgcommand (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nmfgCommandFlag = TRUE;\r\n}\r\nstatic void\r\ndissect_r3_cmd_nvrambackup (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmd_extendedresponse (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandlength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_command, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_setserialnumber (tvbuff_t *tvb, guint32 start_offset, guint32 length, packet_info *pinfo, proto_tree *tree)\r\n{\r\ntvbuff_t *sn_tvb = tvb_new_subset_length (tvb, start_offset + 2, 16);\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\ndissect_serialnumber (sn_tvb, 0, length, pinfo, tree, hf_r3_mfgsetserialnumber);\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_setcryptkey (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_mfgsetcryptkey, tvb, start_offset + 2, -1, ENC_NA);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_dumpnvram (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_mfgdumpnvram, tvb, start_offset + 2, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_terminal (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_remoteunlock (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_mfgremoteunlock, tvb, start_offset + 2, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_auxctlrversion (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_iopins (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_adcs (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_hardwareid (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_checkpointlogdump (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_checkpointlogclear (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_readregisters (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_forceoptions (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo, proto_tree *tree)\r\n{\r\ngint i;\r\ngint len;\r\nguint8 step;\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nstart_offset += 2;\r\nlen = tvb_reported_length_remaining (tvb, start_offset);\r\ni = 0;\r\nwhile (i<len && (step=tvb_get_guint8(tvb, start_offset + i))>0)\r\n{\r\nproto_tree *force_tree = proto_tree_add_subtree_format(tree, tvb, start_offset + i, tvb_get_guint8 (tvb, start_offset + i),\r\nett_r3forceoptions, NULL,\r\n"Force Option %s (%u)",\r\nval_to_str_ext_const (\r\ntvb_get_guint8 (tvb, start_offset + i + 1),\r\n&r3_forceitemnames_ext, "[Unknown]"),\r\ntvb_get_guint8 (tvb, start_offset + i + 1));\r\nproto_item *force_item_item;\r\nproto_tree_add_item (force_tree, hf_r3_forceoptions_length, tvb, start_offset + i + 0, 1, ENC_LITTLE_ENDIAN);\r\nforce_item_item = proto_tree_add_item (force_tree, hf_r3_forceoptions_item, tvb, start_offset + i + 1, 1, ENC_LITTLE_ENDIAN);\r\nswitch (tvb_get_guint8 (tvb, start_offset + i) - 2)\r\n{\r\ncase 1 : proto_tree_add_item (force_tree, hf_r3_forceoptions_state_8, tvb, start_offset + i + 2, 1, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase 2 : proto_tree_add_item (force_tree, hf_r3_forceoptions_state_16, tvb, start_offset + i + 2, 2, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase 3 : proto_tree_add_item (force_tree, hf_r3_forceoptions_state_24, tvb, start_offset + i + 2, 3, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase 4 : proto_tree_add_item (force_tree, hf_r3_forceoptions_state_32, tvb, start_offset + i + 2, 4, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ndefault :\r\nexpert_add_info_format(pinfo, force_item_item, &ei_r3_malformed_length, "Invalid length for Forceoptions State entry");\r\nreturn;\r\nbreak;\r\n}\r\ni += step;\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_commuser (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_dumpkeypad (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_batterycheck (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_ramrefresh (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_taskflags (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_timerchain (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_peekpoke (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo, proto_tree *tree)\r\n{\r\ngint i;\r\ngint len;\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nstart_offset += 2;\r\nlen = tvb_reported_length_remaining (tvb, start_offset);\r\nfor (i = 0; i < len; i += 3)\r\n{\r\nproto_item *peekpoke_item;\r\nproto_item *peekpoke_op_item;\r\nproto_tree *peekpoke_tree;\r\npeekpoke_tree = proto_tree_add_subtree(tree, tvb, start_offset + i, 3, ett_r3peekpoke, &peekpoke_item, "");\r\npeekpoke_op_item = proto_tree_add_item (peekpoke_tree, hf_r3_peekpoke_operation, tvb, start_offset + i + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (peekpoke_tree, hf_r3_peekpoke_address, tvb, start_offset + i + 1, 2, ENC_LITTLE_ENDIAN);\r\nswitch (tvb_get_guint8 (tvb, start_offset + i + 0))\r\n{\r\ncase PEEKPOKE_READU8 :\r\nproto_item_append_text (peekpoke_item, "Read (8 Bits @ 0x%04x)", tvb_get_letohs (tvb, start_offset + i + 1));\r\nbreak;\r\ncase PEEKPOKE_READU16 :\r\nproto_item_append_text (peekpoke_item, "Read (16 Bits @ 0x%04x)", tvb_get_letohs (tvb, start_offset + i + 1));\r\nbreak;\r\ncase PEEKPOKE_READU24 :\r\nproto_item_append_text (peekpoke_item, "Read (24 Bits @ 0x%04x)", tvb_get_letohs (tvb, start_offset + i + 1));\r\nbreak;\r\ncase PEEKPOKE_READU32 :\r\nproto_item_append_text (peekpoke_item, "Read (32 Bits @ 0x%04x)", tvb_get_letohs (tvb, start_offset + i + 1));\r\nbreak;\r\ncase PEEKPOKE_READSTRING :\r\nproto_item_append_text (peekpoke_item,\r\n"Read (%d Bytes @ 0x%04x)",\r\ntvb_get_guint8 (tvb, start_offset + i + 3),\r\ntvb_get_letohs (tvb, start_offset + i + 1));\r\nproto_item_set_len (peekpoke_item, 4);\r\nproto_tree_add_item (peekpoke_tree, hf_r3_peekpoke_length, tvb, start_offset + i + 3, 1, ENC_LITTLE_ENDIAN);\r\ni += 1;\r\nbreak;\r\ncase PEEKPOKE_WRITEU8 :\r\nproto_item_append_text (peekpoke_item,\r\n"Write (8 Bits: 0x%02x @ 0x%04x)",\r\ntvb_get_guint8 (tvb, start_offset + i + 3),\r\ntvb_get_letohs (tvb, start_offset + i + 1));\r\nproto_item_set_len (peekpoke_item, 4);\r\nproto_tree_add_item (peekpoke_tree, hf_r3_peekpoke_poke8, tvb, start_offset + i + 3, 1, ENC_LITTLE_ENDIAN);\r\ni += 1;\r\nbreak;\r\ncase PEEKPOKE_WRITEU16 :\r\nproto_item_append_text (peekpoke_item,\r\n"Write (16 Bits: 0x%04x @ 0x%04x)",\r\ntvb_get_letohs (tvb, start_offset + i + 3),\r\ntvb_get_letohs (tvb, start_offset + i + 1));\r\nproto_item_set_len (peekpoke_item, 5);\r\nproto_tree_add_item (peekpoke_tree, hf_r3_peekpoke_poke16, tvb, start_offset + i + 3, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\nbreak;\r\ncase PEEKPOKE_WRITEU24 :\r\nproto_item_append_text (peekpoke_item,\r\n"Write (24 Bits: 0x%06x @ 0x%04x)",\r\ntvb_get_letoh24 (tvb, start_offset + i + 3),\r\ntvb_get_letohs (tvb, start_offset + i + 1));\r\nproto_item_set_len (peekpoke_item, 6);\r\nproto_tree_add_item (peekpoke_tree, hf_r3_peekpoke_poke24, tvb, start_offset + i + 3, 3, ENC_LITTLE_ENDIAN);\r\ni += 3;\r\nbreak;\r\ncase PEEKPOKE_WRITEU32 :\r\nproto_item_append_text (peekpoke_item,\r\n"Write (32 Bits: 0x%08x @ 0x%04x)",\r\ntvb_get_letohl (tvb, start_offset + i + 3),\r\ntvb_get_letohs (tvb, start_offset + i + 1));\r\nproto_item_set_len (peekpoke_item, 7);\r\nproto_tree_add_item (peekpoke_tree, hf_r3_peekpoke_poke32, tvb, start_offset + i + 3, 4, ENC_LITTLE_ENDIAN);\r\ni += 4;\r\nbreak;\r\ncase PEEKPOKE_WRITESTRING :\r\nproto_item_append_text (peekpoke_item,\r\n"Write (%d Bytes @ 0x%04x)",\r\ntvb_get_guint8 (tvb, start_offset + i + 3),\r\ntvb_get_letohs (tvb, start_offset + i + 1));\r\nproto_item_set_len (peekpoke_item, 3 + 1 + tvb_get_guint8 (tvb, start_offset + i + 3));\r\nproto_tree_add_item (peekpoke_tree, hf_r3_peekpoke_length, tvb, start_offset + i + 3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (peekpoke_tree, hf_r3_peekpoke_pokestring, tvb, start_offset + i + 4,\r\ntvb_get_guint8 (tvb, start_offset + i + 3), ENC_NA);\r\ni += tvb_get_guint8 (tvb, start_offset + i + 3) + 1;\r\nbreak;\r\ndefault :\r\nexpert_add_info_format(pinfo, peekpoke_op_item, &ei_r3_peekpoke_operation, "Unknown Mfg peekpoke operation value");\r\nreturn;\r\n}\r\n}\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_lockstate (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_capabilities (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_dumpm41t81 (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_debuglogdump (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_debuglogclear (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_testwdt (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_querycksum (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_validatechecksums (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_rebuildlrucache (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_tzupdate (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_testpreserve (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_mfgtestpreserve, tvb, start_offset + 2, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_mortisestatelogdump (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_mortisestatelogclear (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_mortisepins (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\ndissect_r3_cmdmfg_haltandcatchfire (tvbuff_t *tvb, guint32 start_offset, guint32 length _U_, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item (tree, hf_r3_commandmfglength, tvb, start_offset + 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (tree, hf_r3_commandmfg, tvb, start_offset + 1, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic gint\r\ndissect_r3_command (tvbuff_t *tvb, guint32 start_offset, guint32 length, packet_info *pinfo, proto_tree *r3_tree)\r\n{\r\nproto_item *cmd_item;\r\nproto_tree *cmd_tree;\r\nconst gchar *cn;\r\nguint8 cmdLen;\r\nguint8 cmd;\r\ntvb_ensure_bytes_exist (tvb, start_offset, 2);\r\ncmdLen = tvb_get_guint8 (tvb, start_offset + 0);\r\ncmd = tvb_get_guint8 (tvb, start_offset + 1);\r\nif (!mfgCommandFlag)\r\ncn = val_to_str_ext_const (cmd, &r3_cmdnames_ext, "[Unknown Command]");\r\nelse\r\ncn = val_to_str_ext_const (cmd, &r3_cmdmfgnames_ext, "[Unknown Mfg Command]");\r\ncmd_tree = proto_tree_add_subtree_format(r3_tree, tvb, start_offset, cmdLen,\r\nett_r3cmd, &cmd_item, "Command Packet: %s (%d)", cn, cmd);\r\nif (!mfgCommandFlag)\r\n{\r\nif (cmd >= CMD_LAST)\r\nexpert_add_info(pinfo, cmd_item, &ei_r3_unknown_command_value);\r\nelse if (r3command_dissect [cmd])\r\n(*r3command_dissect [cmd]) (tvb, start_offset, length, pinfo, cmd_tree);\r\n}\r\nelse\r\n{\r\nmfgCommandFlag = FALSE;\r\nif (cmd >= CMDMFG_LAST)\r\n{\r\nexpert_add_info_format(pinfo, proto_tree_get_parent (cmd_tree), &ei_r3_unknown_command_value, "Unknown manufacturing command value");\r\n}\r\nelse if (r3commandmfg_dissect [cmd])\r\n(*r3commandmfg_dissect [cmd]) (tvb, start_offset, length, pinfo, cmd_tree);\r\n}\r\nreturn tvb_get_guint8 (tvb, start_offset + 0);\r\n}\r\nstatic int\r\ndissect_r3_packet (tvbuff_t *tvb, packet_info *pinfo, proto_tree *r3_tree)\r\n{\r\nproto_item *payload_item = NULL;\r\nproto_tree *payload_tree = NULL;\r\nguint offset = 0;\r\nguint32 packetLen;\r\nguint octConsumed;\r\nif (tvb_strneql (tvb, 0, "~~~ds", 5) == 0)\r\n{\r\nif (r3_tree)\r\nproto_tree_add_item (r3_tree, hf_r3_tildex3ds, tvb, 0, -1, ENC_ASCII|ENC_NA);\r\nreturn 5;\r\n}\r\nif (r3_tree)\r\n{\r\nproto_item *header_item = proto_tree_add_item (r3_tree, hf_r3_header, tvb, 0, 5, ENC_NA);\r\nproto_tree *header_tree = proto_item_add_subtree (header_item, ett_r3header);\r\nproto_tree_add_item (header_tree, hf_r3_sigil, tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (header_tree, hf_r3_address, tvb, 1, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (header_tree, hf_r3_packetnumber, tvb, 2, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (header_tree, hf_r3_packetlength, tvb, 3, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item (header_tree, hf_r3_encryption, tvb, 4, 1, ENC_LITTLE_ENDIAN);\r\n}\r\npacketLen = tvb_get_guint8 (tvb, 3);\r\nif (r3_tree)\r\n{\r\npayload_item = proto_tree_add_item (r3_tree, hf_r3_payload, tvb, 5, -1, ENC_NA);\r\npayload_tree = proto_item_add_subtree (payload_item, ett_r3payload);\r\n}\r\noffset = 5;\r\nmfgCommandFlag = FALSE;\r\nwhile (offset < (packetLen - 3))\r\n{\r\noctConsumed = dissect_r3_command (tvb, offset, 0, pinfo, payload_tree);\r\nif(octConsumed == 0)\r\n{\r\nexpert_add_info_format(pinfo, proto_tree_get_parent (payload_tree), &ei_r3_malformed_length,\r\n"Command length equal to 0. Payload could be partially decoded");\r\noffset = tvb_reported_length (tvb) - 3;\r\nbreak;\r\n}\r\noffset += octConsumed;\r\n}\r\nif (r3_tree)\r\n{\r\nproto_item *tail_item = proto_tree_add_item (r3_tree, hf_r3_tail, tvb, offset, 3, ENC_NA);\r\nproto_tree *tail_tree = proto_item_add_subtree (tail_item, ett_r3tail);\r\nguint32 packetCRC = tvb_get_letohs (tvb, offset);\r\nguint32 packetXor = tvb_get_guint8 (tvb, offset + 2);\r\nguint32 calculatedCRC;\r\nif ((calculatedCRC = crc16_r3_ccitt_tvb(tvb, 1, packetLen - 3)) == packetCRC)\r\nproto_tree_add_uint_format_value(tail_tree, hf_r3_crc, tvb, offset, 2, packetCRC, "0x%04x (correct)", packetCRC);\r\nelse\r\n{\r\nproto_item *tmp_item;\r\nproto_tree_add_uint_format_value(tail_tree, hf_r3_crc, tvb, offset, 2, packetCRC,\r\n"0x%04x (incorrect, should be 0x%04x)", calculatedCRC, packetCRC);\r\ntmp_item = proto_tree_add_boolean (tail_tree, hf_r3_crc_bad, tvb, offset, 2, TRUE);\r\nPROTO_ITEM_SET_GENERATED (tmp_item);\r\n}\r\nif ((packetLen ^ 0xff) == packetXor)\r\nproto_tree_add_uint_format_value(tail_tree, hf_r3_xor, tvb, offset + 2, 1, packetXor,\r\n"0x%02x (correct)", packetXor);\r\nelse\r\n{\r\nproto_item *tmp_item;\r\nproto_tree_add_uint_format_value(tail_tree, hf_r3_xor, tvb, offset + 7, 1, packetXor,\r\n"0x%02x (incorrect, should be 0x%02x)", packetXor, packetLen ^ 0xff);\r\ntmp_item = proto_tree_add_boolean (tail_tree, hf_r3_xor_bad, tvb, offset + 7, 1, TRUE);\r\nPROTO_ITEM_SET_GENERATED (tmp_item);\r\n}\r\n}\r\noffset += 3;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_r3_message (tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nproto_tree *r3_tree = NULL;\r\ncol_set_str (pinfo->cinfo, COL_PROTOCOL, "R3");\r\ncol_clear (pinfo->cinfo, COL_INFO);\r\nif (tree)\r\n{\r\nproto_item *r3_item;\r\nr3_item = proto_tree_add_item (tree, proto_r3, tvb, 0, -1, ENC_NA);\r\nr3_tree = proto_item_add_subtree (r3_item, ett_r3);\r\n}\r\ndissect_r3_packet (tvb, pinfo, r3_tree);\r\nreturn tvb_reported_length(tvb);\r\n}\r\nstatic guint\r\nget_r3_message_len (packet_info *pinfo _U_, tvbuff_t *tvb, int offset, void *data _U_)\r\n{\r\nreturn (guint) tvb_get_guint8 (tvb, offset + 3) + 1;\r\n}\r\nstatic int\r\ndissect_r3 (tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data)\r\n{\r\ntcp_dissect_pdus (tvb, pinfo, tree, TRUE, 4, get_r3_message_len, dissect_r3_message, data);\r\nreturn tvb_reported_length(tvb);\r\n}\r\nvoid proto_register_r3 (void)\r\n{\r\nstatic hf_register_info hf [] =\r\n{\r\n{ &hf_r3_tildex3ds,\r\n{ "DPAC Attention", "r3.dpac_attention",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_header,\r\n{ "Header", "r3.header",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_payload,\r\n{ "Payload", "r3.payload",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_tail,\r\n{ "Tail", "r3.tail",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_sigil,\r\n{ "Sigil", "r3.sigil",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_address,\r\n{ "Address", "r3.address",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_packetnumber,\r\n{ "Packet Number", "r3.packetnumber",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_packetlength,\r\n{ "Packet Length", "r3.packetlength",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_encryption,\r\n{ "Crypt Type", "r3.encryption",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_encryptionschemenames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_crc,\r\n{ "CRC", "r3.crc",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_crc_bad,\r\n{ "Bad CRC", "r3.crc_bad",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_xor,\r\n{ "XOR", "r3.xor",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_xor_bad,\r\n{ "Bad XOR", "r3.xor_bad",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_commandlength,\r\n{ "Command Length", "r3.command.length",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_command,\r\n{ "Command", "r3.command.command",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_cmdnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_commanddata,\r\n{ "Command Data", "r3.command.data",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_commandmfglength,\r\n{ "Mfg Command Length", "r3.commandmfg.length",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_commandmfg,\r\n{ "Mfg Command", "r3.commandmfg.command",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_cmdmfgnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_r3_commandmfgdata,\r\n{ "Mfg Command Data", "r3.commandmfg.data",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_r3_responselength,\r\n{ "Response Length", "r3.response.length",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_responsecommand,\r\n{ "Response Command", "r3.response.command",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_cmdnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_responsetype,\r\n{ "Response Type", "r3.response.responsetype",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_responsetypenames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_responsetocommand,\r\n{ "Response To Command", "r3.response.to_command",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_cmdnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_r3_responsedata,\r\n{ "Response Data", "r3.response.data",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_r3_upstreamcommand,\r\n{ "Upstream Command", "r3.upstreamcommand.command",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_upstreamcommandnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfield,\r\n{ "Upstream Field", "r3.upstreamfield",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldlength,\r\n{ "Field Length", "r3.upstreamfield.length",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldtype,\r\n{ "Field Type", "r3.upstreamfield.type",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_upstreamfieldnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_r3_upstreamfielddatalen,\r\n{ "Data Length", "r3.upstreamfield.datalen",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_r3_upstreamfielderror,\r\n{ "Error", "r3.upstreamfield.error",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_SERIALNUMBER],\r\n{ "Serial Number", "r3.upstreamfield.serialnumber",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_NAR],\r\n{ "Next Available Record", "r3.upstreamfield.nar",\r\nFT_UINT16, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_ENTRYDEVICE],\r\n{ "Entry Device", "r3.upstreamfield.entrydevice",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_ppmisourcenames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_PPMIFIELDTYPE],\r\n{ "PPMI Field Type", "r3.upstreamfield.ppmifieldtype",\r\nFT_UINT8, BASE_HEX_DEC|BASE_EXT_STRING, &r3_ppmisourcenames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_PIN],\r\n{ "PIN", "r3.upstreamfield.pin",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_SEQUENCENUMBER],\r\n{ "Sequence Number", "r3.upstreamfield.sequencenumber",\r\nFT_UINT16, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_RESPONSEWINDOW],\r\n{ "Response Window", "r3.upstreamfield.responsewindow",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_USERNUMBER],\r\n{ "User Number", "r3.upstreamfield.usernumber",\r\nFT_UINT16, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_VERSION],\r\n{ "Version", "r3.upstreamfield.version",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_EVENTLOGRECORD],\r\n{ "Event Log Record", "r3.upstreamfield.eventlogrecord",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_DATETIME],\r\n{ "Date/Time", "r3.upstreamfield.datetime",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_EVENTLOGRECORDCOUNT],\r\n{ "Event Log Record Count", "r3.upstreamfield.eventlogrecordcount",\r\nFT_UINT16, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_DECLINEDRECORDCOUNT],\r\n{ "Declined Log Record", "r3.upstreamfield.declinedlogrecord",\r\nFT_UINT16, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_DECLINEDRECORD],\r\n{ "Declined Log", "r3.upstreamfield.declinedlog",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_USERTYPE],\r\n{ "User Type", "r3.upstreamfield.usertype",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_usertypenames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_ACCESSALWAYS],\r\n{ "Access Always", "r3.upstreamfield.accessalways",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_CACHED],\r\n{ "Cached", "r3.upstreamfield.cached",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_PRIMARYFIELDTYPE],\r\n{ "Primary Field Type", "r3.upstreamfield.primaryfieldtype",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_ppmisourcenames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_AUXFIELDTYPE],\r\n{ "Aux Field Type", "r3.upstreamfield.auxfieldtype",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_ppmisourcenames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_ACCESSMODE],\r\n{ "Access Mode", "r3.upstreamfield.accessmode",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_accessmodenames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_EXPIREON],\r\n{ "Expire On", "r3.upstreamfield.expireon",\r\nFT_UINT24, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_USECOUNT],\r\n{ "Use Count", "r3.upstreamfield.usecount",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_TIMEZONE],\r\n{ "Timezone", "r3.upstreamfield.timezone",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_EXCEPTIONGROUP],\r\n{ "Exception Group", "r3.upstreamfield.exceptiongroup",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_PRIMARYPIN],\r\n{ "Primary PIN", "r3.upstreamfield.primarypin",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_AUXPIN],\r\n{ "Aux PIN", "r3.upstreamfield.auxpin",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_ALARMRECORDCOUNT],\r\n{ "Alarm Record Count", "r3.upstreamfield.alarmrecordcount",\r\nFT_UINT16, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_ALARMRECORD],\r\n{ "Alarm Record", "r3.upstreamfield.alarmrecord",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_upstreamfieldarray [UPSTREAMFIELD_AUXCTLRVERSION],\r\n{ "Aux Controller Version", "r3.upstreamfield.auxctlrversion",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_configitems,\r\n{ "Configuration Item List", "r3.configitems",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_configitem,\r\n{ "Configuration Item", "r3.configitem",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_configitemnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_r3_configfield,\r\n{ "Config Field", "r3.configfield",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_r3_configitemlength,\r\n{ "Configuration Item Length", "r3.configitem.length",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_configitemtype,\r\n{ "Configuration Item Type", "r3.configitem.type",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_configtypenames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_configitemdata,\r\n{ "Configuration Item Data", "r3.configitem.data",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_configitemdata_bool,\r\n{ "Configuration Item Boolean", "r3.configitem.data_boolean",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_configitemdata_8,\r\n{ "Configuration Item 8-bit", "r3.configitem.data_8",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_configitemdata_16,\r\n{ "Configuration Item 16-bit", "r3.configitem.data_16",\r\nFT_UINT16, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_configitemdata_32,\r\n{ "Configuration Item 32-bit", "r3.configitem.data_32",\r\nFT_UINT32, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_configitemdata_string,\r\n{ "Configuration Item String", "r3.configitem.data_string",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray0,\r\n{ "Timezone 0", "r3.timezone.0",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x00000001,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray1,\r\n{ "Timezone 1", "r3.timezone.1",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x00000002,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray2,\r\n{ "Timezone 2", "r3.timezone.2",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x00000004,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray3,\r\n{ "Timezone 3", "r3.timezone.3",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x00000008,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray4,\r\n{ "Timezone 4", "r3.timezone.4",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x00000010,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray5,\r\n{ "Timezone 5", "r3.timezone.5",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x00000020,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray6,\r\n{ "Timezone 6", "r3.timezone.6",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x00000040,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray7,\r\n{ "Timezone 7", "r3.timezone.7",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x00000080,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray8,\r\n{ "Timezone 8", "r3.timezone.8",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x00000100,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray9,\r\n{ "Timezone 9", "r3.timezone.9",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x00000200,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray10,\r\n{ "Timezone 10", "r3.timezone.10",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x00000400,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray11,\r\n{ "Timezone 11", "r3.timezone.11",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x00000800,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray12,\r\n{ "Timezone 12", "r3.timezone.12",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x00001000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray13,\r\n{ "Timezone 13", "r3.timezone.13",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x00002000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray14,\r\n{ "Timezone 14", "r3.timezone.14",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x00004000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray15,\r\n{ "Timezone 15", "r3.timezone.15",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x00008000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray16,\r\n{ "Timezone 16", "r3.timezone.16",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x00010000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray17,\r\n{ "Timezone 17", "r3.timezone.17",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x00020000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray18,\r\n{ "Timezone 18", "r3.timezone.18",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x00040000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray19,\r\n{ "Timezone 19", "r3.timezone.19",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x00080000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray20,\r\n{ "Timezone 20", "r3.timezone.20",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x00100000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray21,\r\n{ "Timezone 21", "r3.timezone.21",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x00200000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray22,\r\n{ "Timezone 22", "r3.timezone.22",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x00400000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray23,\r\n{ "Timezone 23", "r3.timezone.23",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x00800000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray24,\r\n{ "Timezone 24", "r3.timezone.24",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x01000000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray25,\r\n{ "Timezone 25", "r3.timezone.25",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x02000000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray26,\r\n{ "Timezone 26", "r3.timezone.26",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x04000000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray27,\r\n{ "Timezone 27", "r3.timezone.27",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x08000000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray28,\r\n{ "Timezone 28", "r3.timezone.28",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x10000000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray29,\r\n{ "Timezone 29", "r3.timezone.29",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x20000000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray30,\r\n{ "Timezone 30", "r3.timezone.30",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x40000000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timezonearray31,\r\n{ "Timezone 31", "r3.timezone.31",\r\nFT_BOOLEAN, 32, TFS (&tfs_enabled_disabled), 0x80000000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_expireon_year,\r\n{ "Expiration Year", "r3.expireon.year",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_expireon_month,\r\n{ "Expiration Month", "r3.expireon.month",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_monthnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_expireon_day,\r\n{ "Expiration Day", "r3.expireon.day",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_datetime_year,\r\n{ "Date/Time Year", "r3.datetime.year",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_datetime_month,\r\n{ "Date/Time Month", "r3.datetime.month",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_monthnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_datetime_day,\r\n{ "Date/Time Day", "r3.datetime.day",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_datetime_dow,\r\n{ "Date/Time DOW", "r3.datetime.dow",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_daynames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_datetime_hours,\r\n{ "Date/Time Hours", "r3.datetime.hours",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_datetime_minutes,\r\n{ "Date/Time Minutes", "r3.datetime.minutes",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_datetime_seconds,\r\n{ "Date/Time Seconds", "r3.datetime.seconds",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_datetime_dst,\r\n{ "Date/Time DST", "r3.datetime.dst",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_eventlog_recordnumber,\r\n{ "Record Number", "r3.eventlog.recordnumber",\r\nFT_UINT16, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_eventlog_year,\r\n{ "Year", "r3.eventlog.year",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_eventlog_month,\r\n{ "Month", "r3.eventlog.month",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_monthnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_eventlog_day,\r\n{ "Day", "r3.eventlog.day",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_eventlog_hour,\r\n{ "Hours", "r3.eventlog.hours",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_eventlog_minute,\r\n{ "Minutes", "r3.eventlog.minutes",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_eventlog_second,\r\n{ "Seconds", "r3.eventlog.seconds",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_eventlog_usernumber,\r\n{ "User Number", "r3.eventlog.usernumber",\r\nFT_UINT16, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_eventlog_event,\r\n{ "ID", "r3.eventlog.id",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_eventnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_declinedlog_recordnumber,\r\n{ "Record Number", "r3.declinedlog.recordnumber",\r\nFT_UINT16, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_declinedlog_year,\r\n{ "Year", "r3.declinedlog.year",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_declinedlog_month,\r\n{ "Month", "r3.declinedlog.month",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_monthnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_declinedlog_day,\r\n{ "Day", "r3.declinedlog.day",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_declinedlog_hour,\r\n{ "Hours", "r3.declinedlog.hours",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_declinedlog_minute,\r\n{ "Minutes", "r3.declinedlog.minutes",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_declinedlog_second,\r\n{ "Seconds", "r3.declinedlog.seconds",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_declinedlog_usernumber,\r\n{ "User Number", "r3.declinedlog.usernumber",\r\nFT_UINT16, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_declinedlog_cred1type,\r\n{ "Credential 1 Type", "r3.declinedlog.cred1type",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_fieldtypenames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_declinedlog_cred2type,\r\n{ "Credential 2 Type", "r3.declinedlog.cred2type",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_fieldtypenames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_declinedlog_cred1,\r\n{ "Credential 1", "r3.declinedlog.cred1",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_declinedlog_cred2,\r\n{ "Credential 2", "r3.declinedlog.cred2",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_alarmlog_recordnumber,\r\n{ "Record Number", "r3.alarmlog.recordnumber",\r\nFT_UINT16, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_alarmlog_year,\r\n{ "Year", "r3.alarmlog.year",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_alarmlog_month,\r\n{ "Month", "r3.alarmlog.month",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_monthnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_alarmlog_day,\r\n{ "Day", "r3.alarmlog.day",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_alarmlog_hour,\r\n{ "Hours", "r3.alarmlog.hours",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_alarmlog_minute,\r\n{ "Minutes", "r3.alarmlog.minutes",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_alarmlog_second,\r\n{ "Seconds", "r3.alarmlog.seconds",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_alarmlog_id,\r\n{ "ID", "r3.alarmlog.id",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_alarmidnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_alarmlog_usernumber,\r\n{ "User Number", "r3.alarmlog.usernumber",\r\nFT_UINT16, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_debugmsg,\r\n{ "Debug Message", "r3.debug",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_setdate_year,\r\n{ "Year", "r3.setdate.year",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_setdate_month,\r\n{ "Month", "r3.setdate.month",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_monthnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_setdate_day,\r\n{ "Day", "r3.setdate.day",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_setdate_dow,\r\n{ "Day-Of-Week", "r3.setdate.dow",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_daynames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_setdate_hours,\r\n{ "Hours", "r3.setdate.hours",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_setdate_minutes,\r\n{ "Minutes", "r3.setdate.minutes",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_setdate_seconds,\r\n{ "Seconds", "r3.setdate.seconds",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_deleteusers,\r\n{ "Delete Users", "r3.deleteusers",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_deleteusersnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_defineexception_number,\r\n{ "Exception Number", "r3.defineexception.number",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_defineexception_startdate_month,\r\n{ "Start Month", "r3.defineexception.start.month",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_monthnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_defineexception_startdate_day,\r\n{ "Start Day", "r3.defineexception.start.day",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_defineexception_startdate_hours,\r\n{ "Start Hours", "r3.defineexception.start.hours",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_defineexception_startdate_minutes,\r\n{ "Start Minutes", "r3.defineexception.start.minutes",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_defineexception_enddate_month,\r\n{ "End Month", "r3.defineexception.end.month",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_monthnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_defineexception_enddate_day,\r\n{ "End Day", "r3.defineexception.end.day",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_defineexception_enddate_hours,\r\n{ "End Hours", "r3.defineexception.end.hours",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_defineexception_enddate_minutes,\r\n{ "End Minutes", "r3.defineexception.end.minutes",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_defineexceptiongroup_number,\r\n{ "Define Exception Group Number", "r3.defineexceptiongroup.number",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_defineexceptiongroup_bits,\r\n{ "Define Exception Group Bit Field", "r3.defineexceptiongroup.field",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_definecalendar_number,\r\n{ "Define Calendar Number", "r3.definecalendar.number",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_definecalendar_bits,\r\n{ "Define Calendar Bit Field", "r3.definecalendar.field",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_definetimezone_number,\r\n{ "Timezone Number", "r3.definetimezone.number",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_definetimezone_starttime_hours,\r\n{ "Start Hours", "r3.definetimezone.start.hours",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_definetimezone_starttime_minutes,\r\n{ "Start Minutes", "r3.definetimezone.start.minutes",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_definetimezone_endtime_hours,\r\n{ "End Hours", "r3.definetimezone.end.hours",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_definetimezone_endtime_minutes,\r\n{ "End Minutes", "r3.definetimezone.end.minutes",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_definetimezone_daymap,\r\n{ "Day Map", "r3.definetimezone.daymap",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_definetimezone_daymap0,\r\n{ "Sunday", "r3.definetimezone.daymap.sunday",\r\nFT_BOOLEAN, 8, TFS (&tfs_enabled_disabled), 0x00000001,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_definetimezone_daymap1,\r\n{ "Monday", "r3.definetimezone.daymap.monday",\r\nFT_BOOLEAN, 8, TFS (&tfs_enabled_disabled), 0x00000002,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_definetimezone_daymap2,\r\n{ "Tuesday", "r3.definetimezone.daymap.tuesday",\r\nFT_BOOLEAN, 8, TFS (&tfs_enabled_disabled), 0x00000004,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_definetimezone_daymap3,\r\n{ "Wednesday", "r3.definetimezone.daymap.wednesday",\r\nFT_BOOLEAN, 8, TFS (&tfs_enabled_disabled), 0x00000008,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_definetimezone_daymap4,\r\n{ "Thursday", "r3.definetimezone.daymap.thursday",\r\nFT_BOOLEAN, 8, TFS (&tfs_enabled_disabled), 0x00000010,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_definetimezone_daymap5,\r\n{ "Friday", "r3.definetimezone.daymap.friday",\r\nFT_BOOLEAN, 8, TFS (&tfs_enabled_disabled), 0x00000020,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_definetimezone_daymap6,\r\n{ "Saturday", "r3.definetimezone.daymap.saturday",\r\nFT_BOOLEAN, 8, TFS (&tfs_enabled_disabled), 0x00000040,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_definetimezone_exceptiongroup,\r\n{ "Exception Group", "r3.definetimezone.exceptiongroup",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_definetimezone_mode,\r\n{ "Mode", "r3.definetimezone.mode",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_timezonemodenames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_definetimezone_calendar,\r\n{ "Calendar", "r3.definetimezone.calendar",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_rmtauthretry_sequence,\r\n{ "Remote Auth Retry Sequence", "r3.rmtauthretry.sequence",\r\nFT_UINT16, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_rmtauthretry_retry,\r\n{ "Remote Auth Retry Mode", "r3.rmtauthretry.mode",\r\nFT_BOOLEAN, BASE_NONE, TFS (&tfs_rmtauthretry_flags), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_eventlogdump_starttime_year,\r\n{ "Start Year", "r3.eventlogdump.start.year",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_eventlogdump_starttime_month,\r\n{ "Start Month", "r3.eventlogdump.start.month",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_monthnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_eventlogdump_starttime_day,\r\n{ "Start Day", "r3.eventlogdump.start.day",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_eventlogdump_starttime_hours,\r\n{ "Start Hours", "r3.eventlogdump.start.hours",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_eventlogdump_starttime_minutes,\r\n{ "Start Minutes", "r3.eventlogdump.start.minutes",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_eventlogdump_endtime_year,\r\n{ "End Year", "r3.eventlogdump.end.year",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_eventlogdump_endtime_month,\r\n{ "End Month", "r3.eventlogdump.end.month",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_monthnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_eventlogdump_endtime_day,\r\n{ "End Day", "r3.eventlogdump.end.day",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_eventlogdump_endtime_hours,\r\n{ "End Hours", "r3.eventlogdump.end.hours",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_eventlogdump_endtime_minutes,\r\n{ "End Minutes", "r3.eventlogdump.end.minutes",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_eventlogdump_user,\r\n{ "Filter User", "r3.eventlogdump.user",\r\nFT_UINT16, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_declinedlogdump_starttime_year,\r\n{ "Start Year", "r3.declinedlogdump.start.year",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_declinedlogdump_starttime_month,\r\n{ "Start Month", "r3.declinedlogdump.start.month",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_monthnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_declinedlogdump_starttime_day,\r\n{ "Start Day", "r3.declinedlogdump.start.day",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_declinedlogdump_starttime_hours,\r\n{ "Start Hours", "r3.declinedlogdump.start.hours",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_declinedlogdump_starttime_minutes,\r\n{ "Start Minutes", "r3.declinedlogdump.start.minutes",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_declinedlogdump_endtime_year,\r\n{ "End Year", "r3.declinedlogdump.end.year",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_declinedlogdump_endtime_month,\r\n{ "End Month", "r3.declinedlogdump.end.month",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_monthnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_declinedlogdump_endtime_day,\r\n{ "End Day", "r3.declinedlogdump.end.day",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_declinedlogdump_endtime_hours,\r\n{ "End Hours", "r3.declinedlogdump.end.hours",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_declinedlogdump_endtime_minutes,\r\n{ "End Minutes", "r3.declinedlogdump.end.minutes",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_alarmlogdump_starttime_year,\r\n{ "Start Year", "r3.alarmlogdump.start.year",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_alarmlogdump_starttime_month,\r\n{ "Start Month", "r3.alarmlogdump.start.month",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_monthnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_alarmlogdump_starttime_day,\r\n{ "Start Day", "r3.alarmlogdump.start.day",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_alarmlogdump_starttime_hours,\r\n{ "Start Hours", "r3.alarmlogdump.start.hours",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_alarmlogdump_starttime_minutes,\r\n{ "Start Minutes", "r3.alarmlogdump.start.minutes",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_alarmlogdump_endtime_year,\r\n{ "End Year", "r3.alarmlogdump.end.year",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_alarmlogdump_endtime_month,\r\n{ "End Month", "r3.alarmlogdump.end.month",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_monthnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_alarmlogdump_endtime_day,\r\n{ "End Day", "r3.alarmlogdump.end.day",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_alarmlogdump_endtime_hours,\r\n{ "End Hours", "r3.alarmlogdump.end.hours",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_alarmlogdump_endtime_minutes,\r\n{ "End Minutes", "r3.alarmlogdump.end.minutes",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_nvramclearoptions,\r\n{ "NVRAM Clean Options", "r3.nvramclear",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_nvramclearoptions0,\r\n{ "NVRAMCLEAROPTIONS_CFGINSTALLER", "r3.nvramclear.cfginstaller",\r\nFT_BOOLEAN, 16, TFS (&tfs_enabled_disabled), 0x00000001,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_nvramclearoptions1,\r\n{ "NVRAMCLEAROPTIONS_CFGADMIN", "r3.nvramclear.cfgadmin",\r\nFT_BOOLEAN, 16, TFS (&tfs_enabled_disabled), 0x00000002,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_nvramclearoptions2,\r\n{ "NVRAMCLEAROPTIONS_EXCEPTIONS", "r3.nvramclear.exceptions",\r\nFT_BOOLEAN, 16, TFS (&tfs_enabled_disabled), 0x00000004,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_nvramclearoptions3,\r\n{ "NVRAMCLEAROPTIONS_EXCEPTIONGROUPS", "r3.nvramclear.exceptiongroups",\r\nFT_BOOLEAN, 16, TFS (&tfs_enabled_disabled), 0x00000008,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_nvramclearoptions4,\r\n{ "NVRAMCLEAROPTIONS_CALENDARS", "r3.nvramclear.calendars",\r\nFT_BOOLEAN, 16, TFS (&tfs_enabled_disabled), 0x00000010,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_nvramclearoptions5,\r\n{ "NVRAMCLEAROPTIONS_TIMEZONES", "r3.nvramclear.timezones",\r\nFT_BOOLEAN, 16, TFS (&tfs_enabled_disabled), 0x00000020,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_nvramclearoptions6,\r\n{ "NVRAMCLEAROPTIONS_FILTERS", "r3.nvramclear.filters",\r\nFT_BOOLEAN, 16, TFS (&tfs_enabled_disabled), 0x00000040,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_nvramclearoptions7,\r\n{ "NVRAMCLEAROPTIONS_EVENTLOG", "r3.nvramclear.eventlog",\r\nFT_BOOLEAN, 16, TFS (&tfs_enabled_disabled), 0x00000080,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_nvramclearoptions8,\r\n{ "NVRAMCLEAROPTIONS_USERDATA", "r3.nvramclear.userdata",\r\nFT_BOOLEAN, 16, TFS (&tfs_enabled_disabled), 0x00000100,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_nvramclearoptions9,\r\n{ "NVRAMCLEAROPTIONS_DECLINEDLOG", "r3.nvramclear.declinedlog",\r\nFT_BOOLEAN, 16, TFS (&tfs_enabled_disabled), 0x00000200,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_nvramclearoptions10,\r\n{ "NVRAMCLEAROPTIONS_ALARMLOG", "r3.nvramclear.alarmlog",\r\nFT_BOOLEAN, 16, TFS (&tfs_enabled_disabled), 0x00000400,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_nvramclearoptions11,\r\n{ "NVRAMCLEAROPTIONS_LRUCACHE", "r3.nvramclear.lrucache",\r\nFT_BOOLEAN, 16, TFS (&tfs_enabled_disabled), 0x00000800,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_nvramclearoptions12,\r\n{ "NVRAMCLEAROPTIONS_DBHASH", "r3.nvramclear.dbhash",\r\nFT_BOOLEAN, 16, TFS (&tfs_enabled_disabled), 0x00001000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_nvramclearoptions13,\r\n{ "NVRAMCLEAROPTIONS_CFGSYSTEM", "r3.nvramclear.cfgsystem",\r\nFT_BOOLEAN, 16, TFS (&tfs_enabled_disabled), 0x00002000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_nvramclearoptions14,\r\n{ "NVRAMCLEAROPTIONS_UNUSED", "r3.nvramclear.unused",\r\nFT_BOOLEAN, 16, TFS (&tfs_enabled_disabled), 0x00004000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_nvramclearoptions15,\r\n{ "NVRAMCLEAROPTIONS_USEBACKUP", "r3.nvramclear.usebackup",\r\nFT_BOOLEAN, 16, TFS (&tfs_enabled_disabled), 0x00008000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_writeeventlog_user,\r\n{ "User", "r3.writeeventlog.user",\r\nFT_UINT16, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_writeeventlog_event,\r\n{ "Event", "r3.writeeventlog.event",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_eventnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_powertableselection,\r\n{ "Table", "r3.powertableselection",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_powertablenames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_filter_type,\r\n{ "Type", "r3.filter.type",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_filtertypenames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_filter_list,\r\n{ "Event", "r3.filter.event",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_filtereventnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_alarm_length,\r\n{ "Length", "r3.alarm.length",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_alarm_id,\r\n{ "ID", "r3.alarm.id",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_alarmidnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_alarm_state,\r\n{ "State", "r3.alarm.state",\r\nFT_BOOLEAN, BASE_NONE, TFS (&tfs_enabled_disabled), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dpac_action,\r\n{ "Dpac Action", "r3.dpac.action",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dpac_waittime,\r\n{ "Dpac Waittime", "r3.dpac.waittime",\r\nFT_UINT16, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dpac_command,\r\n{ "Dpac Command", "r3.dpac.command",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dpacreply_stuff,\r\n{ "Dpac Reply Stuff", "r3.dpacreply.stuff",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dpacreply_length,\r\n{ "Dpac Reply Length", "r3.dpacreply.length",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dpacreply_reply,\r\n{ "Dpac Reply", "r3.dpacreply.reply",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_mfgfield_length,\r\n{ "Field Length", "r3.mfgfield.length",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_mfgfield,\r\n{ "Field", "r3.mfgfield.field",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_mfgfieldnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_r3_mfgfield_data,\r\n{ "Field Data", "r3.mfgfield.data",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_r3_mfgsetserialnumber,\r\n{ "Serial Number", "r3.mfgsetserialnumber",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_mfgsetcryptkey,\r\n{ "Crypt Key", "r3.mfgsetcryptkey",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_mfgdumpnvram,\r\n{ "NVRAM Section", "r3.mfgnvramdump",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_mfgnvramdumpnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_mfgremoteunlock,\r\n{ "Remote Unlock", "r3.mfgremoteunlock",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_mfgremoteunlocknames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_mfgtestpreserve,\r\n{ "Preserve Mode", "r3.mfgtestpreserve",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_mfgtestpreservenames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_adc [0],\r\n{ "ADC 0", "r3.adc.0",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_adc [1],\r\n{ "ADC 1", "r3.adc.1",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_adc [2],\r\n{ "ADC 2", "r3.adc.2",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_adc [3],\r\n{ "ADC 3", "r3.adc.3",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_adc [4],\r\n{ "ADC 4", "r3.adc.4",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_adc [5],\r\n{ "ADC 5", "r3.adc.5",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_adc [6],\r\n{ "ADC 6", "r3.adc.6",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_adc [7],\r\n{ "ADC 7", "r3.adc.7",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_hardwareid_board,\r\n{ "Board ID", "r3.hardwareid.board",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_hardwareid_cpuid,\r\n{ "CPU ID", "r3.hardwareid.cpuid",\r\nFT_UINT16, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_hardwareid_cpurev,\r\n{ "CPU Rev", "r3.hardwareid.cpurev",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_testkeypad,\r\n{ "Keypad Char", "r3.test.keypad",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_testmagcard,\r\n{ "Mag Card", "r3.test.magcard",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_testproxcard,\r\n{ "Prox Card", "r3.test.proxcard",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_nvramdump_record,\r\n{ "Record Number", "r3.nvramdump.record",\r\nFT_UINT16, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_nvramdump_length,\r\n{ "Record Length", "r3.nvramdump.length",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_nvramdump_data,\r\n{ "Record Data", "r3.nvramdump.data",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_nvramdumprle_record,\r\n{ "Record Number", "r3.nvramdumprle.record",\r\nFT_UINT24, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_nvramdumprle_length,\r\n{ "Record Length", "r3.nvramdumprle.length",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_nvramdumprle_data,\r\n{ "Record Data", "r3.nvramdumprle.data",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_iopins_lat,\r\n{ "LAT", "r3.iopins.lat",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_iopins_port,\r\n{ "PORT", "r3.iopins.port",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_iopins_tris,\r\n{ "TRIS", "r3.iopins.tris",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_mortisepins_s1,\r\n{ "Mortise Pin S1", "r3.mortisepins.s1",\r\nFT_BOOLEAN, 8, TFS (&tfs_mortisepins_flags), 0x00000001,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_mortisepins_s2,\r\n{ "Mortise Pin S2", "r3.mortisepins.s2",\r\nFT_BOOLEAN, 8, TFS (&tfs_mortisepins_flags), 0x00000002,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_mortisepins_s3,\r\n{ "Mortise Pin S3", "r3.mortisepins.s3",\r\nFT_BOOLEAN, 8, TFS (&tfs_mortisepins_flags), 0x00000004,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_mortisepins_s4,\r\n{ "Mortise Pin S4", "r3.mortisepins.s4",\r\nFT_BOOLEAN, 8, TFS (&tfs_mortisepins_flags), 0x00000008,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_checksumresults ,\r\n{ "Checksum Results", "r3.checksumresults",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_checksumresults_field,\r\n{ "Field", "r3.checksumresults.field",\r\nFT_UINT8, BASE_HEX|BASE_EXT_STRING, & r3_checksumresultnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_checksumresults_length,\r\n{ "Length", "r3.checksumresults.length",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_checksumresults_state,\r\n{ "State", "r3.checksumresults.state",\r\nFT_BOOLEAN, BASE_NONE, TFS (&tfs_errornoerror_flags), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_forceoptions_item,\r\n{ "Item", "r3.forceoptions.item",\r\nFT_UINT8, BASE_HEX_DEC|BASE_EXT_STRING, &r3_forceitemnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_forceoptions_length,\r\n{ "Length", "r3.forceoptions.length",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_forceoptions_state_8,\r\n{ "State", "r3.forceoptions.state",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_forceoptions_state_16,\r\n{ "State", "r3.forceoptions.state",\r\nFT_UINT16, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_forceoptions_state_24,\r\n{ "State", "r3.forceoptions.state",\r\nFT_UINT24, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_forceoptions_state_32,\r\n{ "State", "r3.forceoptions.state",\r\nFT_UINT32, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_peekpoke_operation,\r\n{ "Operation", "r3.peekpoke.operation",\r\nFT_UINT8, BASE_HEX_DEC|BASE_EXT_STRING, &r3_peekpokenames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_peekpoke_address,\r\n{ "Address", "r3.peekpoke.address",\r\nFT_UINT16, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_peekpoke_length,\r\n{ "Length", "r3.peekpoke.length",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_peekpoke_poke8,\r\n{ "8 Bit Value", "r3.peekpoke.poke8",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_peekpoke_poke16,\r\n{ "16 Bit Value", "r3.peekpoke.poke16",\r\nFT_UINT16, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_peekpoke_poke24,\r\n{ "24 Bit Value", "r3.peekpoke.poke24",\r\nFT_UINT24, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_peekpoke_poke32,\r\n{ "32 Bit Value", "r3.peekpoke.poke32",\r\nFT_UINT32, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_peekpoke_pokestring,\r\n{ "String Value", "r3.peekpoke.pokestring",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_firmwaredownload_length,\r\n{ "Length", "r3.firmwaredownload.length",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_firmwaredownload_record,\r\n{ "Record Number", "r3.firmwaredownload.record",\r\nFT_UINT16, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_firmwaredownload_action,\r\n{ "Action", "r3.firmwaredownload.action",\r\nFT_UINT8, BASE_HEX_DEC|BASE_EXT_STRING, &r3_downloadfirmwarenames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_firmwaredownload_timeout,\r\n{ "Timeout", "r3.firmwaredownload.timeout",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_firmwaredownload_nvram,\r\n{ "NVRAM", "r3.firmwaredownload.nvram",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_firmwaredownload_address,\r\n{ "Address", "r3.firmwaredownload.address",\r\nFT_UINT32, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_firmwaredownload_bytes,\r\n{ "Bytes", "r3.firmwaredownload.bytes",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_firmwaredownload_data,\r\n{ "Data", "r3.firmwaredownload.data",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_firmwaredownload_crc,\r\n{ "CRC", "r3.firmwaredownload.crc",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_firmwaredownload_crc_bad,\r\n{ "Bad CRC", "r3.firmwaredownload.crc_bad",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_nvramchecksumvalue,\r\n{ "Value", "r3.nvramchecksum.value",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_nvramchecksumvalue_fixup,\r\n{ "Fixup", "r3.nvramchecksum.fixup",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_capabilities,\r\n{ "Capability", "r3.capabilities",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_capabilities_length,\r\n{ "Length", "r3.capabilities.length",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_capabilities_type,\r\n{ "Type", "r3.capabilities.type",\r\nFT_UINT8, BASE_HEX_DEC|BASE_EXT_STRING, &r3_capabilitiesnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_capabilities_value,\r\n{ "Value", "r3.capabilities.value",\r\nFT_UINT16, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_lockstate,\r\n{ "Lock State", "r3.lockstate",\r\nFT_UINT24, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_lockstate_passage,\r\n{ "Passage", "r3.lockstate.passage",\r\nFT_BOOLEAN, 24, NULL, 0x00000001,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_lockstate_panic,\r\n{ "Panic", "r3.lockstate.panic",\r\nFT_BOOLEAN, 24, NULL, 0x00000002,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_lockstate_lockout,\r\n{ "Lockout", "r3.lockstate.lockout",\r\nFT_BOOLEAN, 24, NULL, 0x00000004,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_lockstate_relock,\r\n{ "Relock", "r3.lockstate.relock",\r\nFT_BOOLEAN, 24, NULL, 0x00000008,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_lockstate_autoopen,\r\n{ "Auto Open", "r3.lockstate.autoopen",\r\nFT_BOOLEAN, 24, NULL, 0x00000010,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_lockstate_nextauto,\r\n{ "Next Auto", "r3.lockstate.nextauto",\r\nFT_BOOLEAN, 24, NULL, 0x00000020,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_lockstate_lockstate,\r\n{ "Lock State", "r3.lockstate.lockstate",\r\nFT_BOOLEAN, 24, NULL, 0x00000040,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_lockstate_wantstate,\r\n{ "Want State", "r3.lockstate.wantstate",\r\nFT_BOOLEAN, 24, NULL, 0x00000080,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_lockstate_remote,\r\n{ "Remote", "r3.lockstate.remote",\r\nFT_BOOLEAN, 24, NULL, 0x00000100,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_lockstate_update,\r\n{ "Update", "r3.lockstate.update",\r\nFT_BOOLEAN, 24, NULL, 0x00000200,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_lockstate_exceptionspresent,\r\n{ "Exceptions Present", "r3.lockstate.exceptionspresent",\r\nFT_BOOLEAN, 24, NULL, 0x00000400,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_lockstate_exceptionsactive,\r\n{ "Exceptions Active", "r3.lockstate.exceptionsactive",\r\nFT_BOOLEAN, 24, NULL, 0x00000800,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_lockstate_timezonespresent,\r\n{ "Timezones Presents", "r3.lockstate.timezonespresent",\r\nFT_BOOLEAN, 24, NULL, 0x00001000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_lockstate_timezonesactive,\r\n{ "Timezones Active", "r3.lockstate.timezonesactive",\r\nFT_BOOLEAN, 24, NULL, 0x00002000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_lockstate_autounlockspresent,\r\n{ "Auto Unlocks Present", "r3.lockstate.autounlockspresent",\r\nFT_BOOLEAN, 24, NULL, 0x00004000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_lockstate_autounlocksactive,\r\n{ "Auto Unlocks Active", "r3.lockstate.autounlocksactive",\r\nFT_BOOLEAN, 24, NULL, 0x00008000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_lockstate_uapmspresent,\r\n{ "UAPMs Present", "r3.lockstate.uapmspresent",\r\nFT_BOOLEAN, 24, NULL, 0x00010000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_lockstate_uapmsactive,\r\n{ "UAPMs Active", "r3.lockstate.uapmsactive",\r\nFT_BOOLEAN, 24, NULL, 0x00020000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_lockstate_uapmrelockspresent,\r\n{ "UAPM Relocks Present", "r3.lockstate.uapmrelockspresent",\r\nFT_BOOLEAN, 24, NULL, 0x00040000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_lockstate_uapmreslocksactive,\r\n{ "UAPM Relocks Active", "r3.lockstate.uapmreslocksactive",\r\nFT_BOOLEAN, 24, NULL, 0x00080000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_lockstate_nvramprotect,\r\n{ "NVRAM Protect", "r3.lockstate.nvramprotect",\r\nFT_BOOLEAN, 24, NULL, 0x00100000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_lockstate_nvramchecksum,\r\n{ "MVRAM Checksum", "r3.lockstate.nvramchecksum",\r\nFT_BOOLEAN, 24, NULL, 0x00200000,\r\nNULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_r3_mortisestatelog,\r\n{ "Mortise State Log", "r3.mortisestatelog",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_r3_mortisestatelog_pointer,\r\n{ "Event Pointer", "r3.mortisestatelog.pointer",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_mortisestatelog_mortisetype,\r\n{ "Mortise Type", "r3.mortisestatelog.mortisetype",\r\nFT_UINT8, BASE_HEX_DEC|BASE_EXT_STRING, &r3_mortisetypenames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_mortisestatelog_waiting,\r\n{ "Waiting For Door Closed", "r3.mortisestatelog.waiting",\r\nFT_BOOLEAN, BASE_NONE, TFS (&tfs_true_false ), 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_mortisestatelog_state,\r\n{ "State", "r3.mortisestatelog.state",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_mortisestatelog_last,\r\n{ "Last State", "r3.mortisestatelog.laststate",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_mortisestatelog_event,\r\n{ "Event", "r3.mortisestatelog.event",\r\nFT_UINT8, BASE_HEX_DEC|BASE_EXT_STRING, &r3_mortiseeventnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timerchain_newtick,\r\n{ "New Tick", "r3.timerchain.newtick",\r\nFT_UINT16, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timerchain_currentboundary,\r\n{ "Current Boundary", "r3.timerchain.currentboundary",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timerchain_tasktag,\r\n{ "Task Tag", "r3.timerchain.tasktag",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timerchain_address,\r\n{ "Address", "r3.timerchain.address",\r\nFT_UINT16, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timerchain_reload,\r\n{ "Reload", "r3.timerchain.reload",\r\nFT_UINT16, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timerchain_boundary,\r\n{ "Boundary", "r3.timerchain.boundary",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timerchain_count,\r\n{ "Count", "r3.timerchain.count",\r\nFT_UINT16, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_timerchain_flags,\r\n{ "Flags", "r3.timerchain.flags",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_taskflags_taskid,\r\n{ "Task ID", "r3.taskflags.taskid",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_taskflags_flags,\r\n{ "Flags", "r3.taskflags.flags",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_checkpointlog_entryptr,\r\n{ "Entry Pointer", "r3.checkpointlog.entrypointer",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_checkpointlog_rcon,\r\n{ "RCON", "r3.checkpointlog.rcon",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_checkpointlog_checkpoint,\r\n{ "Checkpoint", "r3.checkpointlog.checkpoint",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_intcon,\r\n{ "INTCON", "r3.cpuregisters.intcon",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_intcon2,\r\n{ "INTCON2", "r3.cpuregisters.intcon2",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_intcon3,\r\n{ "INTCON3", "r3.cpuregisters.intcon3",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pir1,\r\n{ "PIR1", "r3.cpuregisters.pir1",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pir2,\r\n{ "PIR2", "r3.cpuregisters.pir2",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pir3,\r\n{ "PIR3", "r3.cpuregisters.pir3",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pie1,\r\n{ "PIE1", "r3.cpuregisters.pie1",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pie2,\r\n{ "PIE2", "r3.cpuregisters.pie2",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pie3,\r\n{ "PIE3", "r3.cpuregisters.pie3",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_ipr1,\r\n{ "IPR1", "r3.cpuregisters.ipr1",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_ipr2,\r\n{ "IPR2", "r3.cpuregisters.ipr2",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_ipr3,\r\n{ "IPR3", "r3.cpuregisters.ipr3",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_rcon,\r\n{ "RCON", "r3.cpuregisters.rcon",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_osccon,\r\n{ "OSCCON", "r3.cpuregisters.osccon",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_rcsta,\r\n{ "RCSTA", "r3.cpuregisters.rcsta",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_txsta,\r\n{ "TXSTA", "r3.cpuregisters.txsta",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_rcsta2,\r\n{ "RCSTA2", "r3.cpuregisters.rcsta2",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_txsta2,\r\n{ "TXSTA2", "r3.cpuregisters.txsta2",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_wdtcon,\r\n{ "WDTCON", "r3.cpuregisters.wdtcon",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_intcon_rbif,\r\n{ "INTCON.RBIF", "r3.cpuregisters.intcon.rbif",\r\nFT_BOOLEAN, 8, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_intcon_int0if,\r\n{ "INTCON.INT0IF", "r3.cpuregisters.intcon.int0if",\r\nFT_BOOLEAN, 8, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_intcon_tmr0if,\r\n{ "INTCON.TMR0IF", "r3.cpuregisters.intcon.tmr0if",\r\nFT_BOOLEAN, 8, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_intcon_rbie,\r\n{ "INTCON.RBIE", "r3.cpuregisters.intcon.rbie",\r\nFT_BOOLEAN, 8, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_intcon_int0ie,\r\n{ "INTCON.INT0IE", "r3.cpuregisters.intcon.int0ie",\r\nFT_BOOLEAN, 8, NULL, 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_intcon_tmr0ie,\r\n{ "INTCON.TMR0IE", "r3.cpuregisters.intcon.tmr0ie",\r\nFT_BOOLEAN, 8, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_intcon_giel,\r\n{ "INTCON.GIEL", "r3.cpuregisters.intcon.giel",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_intcon_gieh,\r\n{ "INTCON.GIEH", "r3.cpuregisters.intcon.gieh",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_intcon2_rbip,\r\n{ "INTCON2.RBIP", "r3_cpuregisters_intcon2_rbip",\r\nFT_BOOLEAN, 8, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_intcon2_int3ip,\r\n{ "INTCON2.INT3IP", "r3_cpuregisters_intcon2_int3ip",\r\nFT_BOOLEAN, 8, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_intcon2_tmr0ip,\r\n{ "INTCON2.TMR0IP", "r3_cpuregisters_intcon2_tmr0ip",\r\nFT_BOOLEAN, 8, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_intcon2_intedg3,\r\n{ "INTCON2.INTEDG3", "r3_cpuregisters_intcon2_intedg3",\r\nFT_BOOLEAN, 8, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_intcon2_intedg2,\r\n{ "INTCON2.INTEDG2", "r3_cpuregisters_intcon2_intedg2",\r\nFT_BOOLEAN, 8, NULL, 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_intcon2_intedg1,\r\n{ "INTCON2.INTEDG1", "r3_cpuregisters_intcon2_intedg1",\r\nFT_BOOLEAN, 8, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_intcon2_intedg0,\r\n{ "INTCON2.INTEDG0", "r3_cpuregisters_intcon2_intedg0",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_intcon2_rbpu,\r\n{ "INTCON2.RBPU", "r3_cpuregisters_intcon2_rbpu",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_intcon3_int1if,\r\n{ "INTCON3.INT1IF", "r3.cpuregisters.intcon3.int1if",\r\nFT_BOOLEAN, 8, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_intcon3_int2if,\r\n{ "INTCON3.INT2IF", "r3.cpuregisters.intcon3.int2if",\r\nFT_BOOLEAN, 8, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_intcon3_int3if,\r\n{ "INTCON3.INT3IF", "r3.cpuregisters.intcon3.int3if",\r\nFT_BOOLEAN, 8, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_intcon3_int1ie,\r\n{ "INTCON3.INT1IE", "r3.cpuregisters.intcon3.int1ie",\r\nFT_BOOLEAN, 8, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_intcon3_int2ie,\r\n{ "INTCON3.INT2IE", "r3.cpuregisters.intcon3.int2ie",\r\nFT_BOOLEAN, 8, NULL, 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_intcon3_int3ie,\r\n{ "INTCON3.INT3IE", "r3.cpuregisters.intcon3.int3ie",\r\nFT_BOOLEAN, 8, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_intcon3_int1ip,\r\n{ "INTCON3.INT1IP", "r3.cpuregisters.intcon3.int1ip",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_intcon3_int2ip,\r\n{ "INTCON3.INT2IP", "r3.cpuregisters.intcon3.int2ip",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pir1_tmr1if,\r\n{ "PIR1.TMR1IF", "r3.cpuregisters.pir1.tmr1if",\r\nFT_BOOLEAN, 8, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pir1_tmr2if,\r\n{ "PIR1.TMR2IF", "r3.cpuregisters.pir1.tmr2if",\r\nFT_BOOLEAN, 8, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pir1_ccp1if,\r\n{ "PIR1.CCP1IF", "r3.cpuregisters.pir1.ccp1if",\r\nFT_BOOLEAN, 8, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pir1_ssp1if,\r\n{ "PIR1.SSP1IF", "r3.cpuregisters.pir1.ssp1if",\r\nFT_BOOLEAN, 8, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pir1_tx1if,\r\n{ "PIR1.TX1IF", "r3.cpuregisters.pir1.tx1if",\r\nFT_BOOLEAN, 8, NULL, 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pir1_rc1if,\r\n{ "PIR1.RC1IF", "r3.cpuregisters.pir1.rc1if",\r\nFT_BOOLEAN, 8, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pir1_adif,\r\n{ "PIR1.ADIF", "r3.cpuregisters.pir1.adif",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pir1_pspif,\r\n{ "PIR1.PSPIF", "r3.cpuregisters.pir1.pspif",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pir2_ccp2if,\r\n{ "PIR2.CCP2IF", "r3.cpuregisters.pir2.ccp2if",\r\nFT_BOOLEAN, 8, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pir2_tmr3if,\r\n{ "PIR2.TMR3IF", "r3.cpuregisters.pir2.tmr3if",\r\nFT_BOOLEAN, 8, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pir2_hlvdif,\r\n{ "PIR2.HLVDIF", "r3.cpuregisters.pir2.hlvdif",\r\nFT_BOOLEAN, 8, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pir2_bcl1if,\r\n{ "PIR2.BCL1IF", "r3.cpuregisters.pir2.bcl1if",\r\nFT_BOOLEAN, 8, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pir2_eeif,\r\n{ "PIR2.EEIF", "r3.cpuregisters.pir2.eeif",\r\nFT_BOOLEAN, 8, NULL, 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pir2_unused5,\r\n{ "PIR2.UNUSED5", "r3.cpuregisters.pir2.unused5",\r\nFT_BOOLEAN, 8, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pir2_cmif,\r\n{ "PIR2.CMIF", "r3.cpuregisters.pir2.cmif",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pir2_oscfif,\r\n{ "PIR2.OSCFIF", "r3.cpuregisters.pir2.oscfif",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pir3_ccp3if,\r\n{ "PIR3.CCP3IF", "r3.cpuregisters.pir3.ccp3if",\r\nFT_BOOLEAN, 8, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pir3_ccp4if,\r\n{ "PIR3.CCP4IF", "r3.cpuregisters.pir3.ccp4if",\r\nFT_BOOLEAN, 8, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pir3_ccp5if,\r\n{ "PIR3.CCP5IF", "r3.cpuregisters.pir3.ccp5if",\r\nFT_BOOLEAN, 8, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pir3_tmr4if,\r\n{ "PIR3.TMR4IF", "r3.cpuregisters.pir3.tmr4if",\r\nFT_BOOLEAN, 8, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pir3_tx2if,\r\n{ "PIR3.TX2IF", "r3.cpuregisters.pir3.tx2if",\r\nFT_BOOLEAN, 8, NULL, 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pir3_rc2if,\r\n{ "PIR3.RC2IF", "r3.cpuregisters.pir3.rc2if",\r\nFT_BOOLEAN, 8, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pir3_bcl2if,\r\n{ "PIR3.BCL2IF", "r3.cpuregisters.pir3.bcl2if",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pir3_ssp2if,\r\n{ "PIR3.SSP2IF", "r3.cpuregisters.pir3.ssp2if",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pie1_tmr1ie,\r\n{ "PIE1.TMR1IE", "r3.cpuregisters.pie1.tmr1ie",\r\nFT_BOOLEAN, 8, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pie1_tmr2ie,\r\n{ "PIE1.TMR2IE", "r3.cpuregisters.pie1.tmr2ie",\r\nFT_BOOLEAN, 8, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pie1_ccp1ie,\r\n{ "PIE1.CCP1IE", "r3.cpuregisters.pie1.ccp1ie",\r\nFT_BOOLEAN, 8, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pie1_ssp1ie,\r\n{ "PIE1.SSP1IE", "r3.cpuregisters.pie1.ssp1ie",\r\nFT_BOOLEAN, 8, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pie1_tx1ie,\r\n{ "PIE1.TX1IE", "r3.cpuregisters.pie1.tx1ie",\r\nFT_BOOLEAN, 8, NULL, 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pie1_rc1ie,\r\n{ "PIE1.RC1IE", "r3.cpuregisters.pie1.rc1ie",\r\nFT_BOOLEAN, 8, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pie1_adie,\r\n{ "PIE1.ADIE", "r3.cpuregisters.pie1.adie",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pie1_pspie,\r\n{ "PIE1.PSPIE", "r3.cpuregisters.pie1.pspie",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pie2_oscfie,\r\n{ "PIE2.OSCFIE", "r3.cpuregisters.pie2.oscfie",\r\nFT_BOOLEAN, 8, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pie2_cmie,\r\n{ "PIE2.CMIE", "r3.cpuregisters.pie2.cmie",\r\nFT_BOOLEAN, 8, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pie2_unused2,\r\n{ "PIE2.UNUSED2", "r3.cpuregisters.pie2.unused2",\r\nFT_BOOLEAN, 8, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pie2_eeie,\r\n{ "PIE2.EEIE", "r3.cpuregisters.pie2.eeie",\r\nFT_BOOLEAN, 8, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pie2_bcl1ie,\r\n{ "PIE2.BCL1IE", "r3.cpuregisters.pie2.bcl1ie",\r\nFT_BOOLEAN, 8, NULL, 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pie2_hlvdie,\r\n{ "PIE2.HLVDIE", "r3.cpuregisters.pie2.hlvdie",\r\nFT_BOOLEAN, 8, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pie2_tmr3ie,\r\n{ "PIE2.TMR3IE", "r3.cpuregisters.pie2.tmr3ie",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pie2_ccp2ie,\r\n{ "PIE2.CCP2IE", "r3.cpuregisters.pie2.ccp2ie",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pie3_ccp3ie,\r\n{ "PIE3.CCP3IE", "r3.cpuregisters.pie3.ccp3ie",\r\nFT_BOOLEAN, 8, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pie3_ccp4ie,\r\n{ "PIE3.CCP4IE", "r3.cpuregisters.pie3.ccp4ie",\r\nFT_BOOLEAN, 8, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pie3_ccp5ie,\r\n{ "PIE3.CCP5IE", "r3.cpuregisters.pie3.ccp5ie",\r\nFT_BOOLEAN, 8, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pie3_tmr4ie,\r\n{ "PIE3.TMR4IE", "r3.cpuregisters.pie3.tmr4ie",\r\nFT_BOOLEAN, 8, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pie3_tx2ie,\r\n{ "PIE3.TX2IE", "r3.cpuregisters.pie3.tx2ie",\r\nFT_BOOLEAN, 8, NULL, 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pie3_rc2ie,\r\n{ "PIE3.RC2IE", "r3.cpuregisters.pie3.rc2ie",\r\nFT_BOOLEAN, 8, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pie3_bcl2ie,\r\n{ "PIE3.BCL2IE", "r3.cpuregisters.pie3.bcl2ie",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_pie3_ssp2ie,\r\n{ "PIE3.SSP2IE", "r3.cpuregisters.pie3.ssp2ie",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_ipr1_tmr1ip,\r\n{ "IPR1.TMR1IP", "r3.cpuregisters.ipr1.tmr1ip",\r\nFT_BOOLEAN, 8, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_ipr1_tmr2ip,\r\n{ "IPR1.TMR2IP", "r3.cpuregisters.ipr1.tmr2ip",\r\nFT_BOOLEAN, 8, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_ipr1_ccp1ip,\r\n{ "IPR1.CCP1IP", "r3.cpuregisters.ipr1.ccp1ip",\r\nFT_BOOLEAN, 8, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_ipr1_ssp1ip,\r\n{ "IPR1.SSP1IP", "r3.cpuregisters.ipr1.ssp1ip",\r\nFT_BOOLEAN, 8, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_ipr1_tx1ip,\r\n{ "IPR1.TX1IP", "r3.cpuregisters.ipr1.tx1ip",\r\nFT_BOOLEAN, 8, NULL, 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_ipr1_rc1ip,\r\n{ "IPR1.RC1IP", "r3.cpuregisters.ipr1.rc1ip",\r\nFT_BOOLEAN, 8, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_ipr1_adip,\r\n{ "IPR1.ADIP", "r3.cpuregisters.ipr1.adip",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_ipr1_pspip,\r\n{ "IPR1.PSPIP", "r3.cpuregisters.ipr1.pspip",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_ipr2_ccp2ip,\r\n{ "IPR2.CCP2IP", "r3.cpuregisters.ipr2.ccp2ip",\r\nFT_BOOLEAN, 8, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_ipr2_tmr3ip,\r\n{ "IPR2.TMR3IP", "r3.cpuregisters.ipr2.tmr3ip",\r\nFT_BOOLEAN, 8, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_ipr2_hlvdip,\r\n{ "IPR2.HLVDIP", "r3.cpuregisters.ipr2.hlvdip",\r\nFT_BOOLEAN, 8, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_ipr2_bcl1ip,\r\n{ "IPR2.BCL1IP", "r3.cpuregisters.ipr2.bcl1ip",\r\nFT_BOOLEAN, 8, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_ipr2_eeip,\r\n{ "IPR2.EEIP", "r3.cpuregisters.ipr2.eeip",\r\nFT_BOOLEAN, 8, NULL, 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_ipr2_unused5,\r\n{ "IPR2.UNUSED5", "r3.cpuregisters.ipr2.unused5",\r\nFT_BOOLEAN, 8, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_ipr2_cmip,\r\n{ "IPR2.CMIP", "r3.cpuregisters.ipr2.cmip",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_ipr2_oscfip,\r\n{ "IPR2.OSCFIP", "r3.cpuregisters.ipr2.oscfip",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_ipr3_ccp2ip,\r\n{ "IPR3.CCP2IP", "r3.cpuregisters.ipr3.ccp2ip",\r\nFT_BOOLEAN, 8, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_ipr3_ccp4ip,\r\n{ "IPR3.CCP4IP", "r3.cpuregisters.ipr3.ccp4ip",\r\nFT_BOOLEAN, 8, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_ipr3_ccp5ip,\r\n{ "IPR3.CCP5IP", "r3.cpuregisters.ipr3.ccp5ip",\r\nFT_BOOLEAN, 8, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_ipr3_tmr4ip,\r\n{ "IPR3.TMR4IP", "r3.cpuregisters.ipr3.tmr4ip",\r\nFT_BOOLEAN, 8, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_ipr3_tx2ip,\r\n{ "IPR3.TX2IP", "r3.cpuregisters.ipr3.tx2ip",\r\nFT_BOOLEAN, 8, NULL, 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_ipr3_rc2ip,\r\n{ "IPR3.RC2IP", "r3.cpuregisters.ipr3.rc2ip",\r\nFT_BOOLEAN, 8, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_ipr3_bcl2ip,\r\n{ "IPR3.BCL2IP", "r3.cpuregisters.ipr3.bcl2ip",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_ipr3_ssp2ip,\r\n{ "IPR3.SSP2IP", "r3.cpuregisters.ipr3.ssp2ip",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_rcon_bor,\r\n{ "RCON./BOR", "r3.cpuregisters.rcon.bor",\r\nFT_BOOLEAN, 8, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_rcon_por,\r\n{ "RCON./POR", "r3.cpuregisters.rcon.por",\r\nFT_BOOLEAN, 8, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_rcon_pd,\r\n{ "RCON./PD", "r3.cpuregisters.rcon.pd",\r\nFT_BOOLEAN, 8, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_rcon_to,\r\n{ "RCON./TO", "r3.cpuregisters.rcon.to",\r\nFT_BOOLEAN, 8, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_rcon_unused4,\r\n{ "RCON.UNUSED4", "r3.cpuregisters.rcon.unused4",\r\nFT_BOOLEAN, 8, NULL, 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_rcon_ri,\r\n{ "RCON./RI", "r3.cpuregisters.rcon.ri",\r\nFT_BOOLEAN, 8, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_rcon_sboren,\r\n{ "RCON.SBOREN", "r3.cpuregisters.rcon.sboren",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_rcon_ipen,\r\n{ "RCON.IPEN", "r3.cpuregisters.rcon.ipen",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_osccon_scs0,\r\n{ "OSCCON.SCS0", "r3.cpuregisters.osccon.scs0",\r\nFT_BOOLEAN, 8, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_osccon_scs1,\r\n{ "OSCCON.SCS1", "r3.cpuregisters.osccon.scs1",\r\nFT_BOOLEAN, 8, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_osccon_iofs,\r\n{ "OSCCON.IOFS", "r3.cpuregisters.osccon.iofs",\r\nFT_BOOLEAN, 8, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_osccon_osts,\r\n{ "OSCCON.OSTS", "r3.cpuregisters.osccon.osts",\r\nFT_BOOLEAN, 8, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_osccon_ircf0,\r\n{ "OSCCON.IRCF0", "r3.cpuregisters.osccon.ircf0",\r\nFT_BOOLEAN, 8, NULL, 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_osccon_ircf1,\r\n{ "OSCCON.IRCF1", "r3.cpuregisters.osccon.ircf1",\r\nFT_BOOLEAN, 8, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_osccon_ircf2,\r\n{ "OSCCON.IRCF2", "r3.cpuregisters.osccon.ircf2",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_osccon_idlen,\r\n{ "OSCCON.IDLEN", "r3.cpuregisters.osccon.idlen",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_rcsta_rx9d,\r\n{ "RCSTA.RX9D", "r3.cpuregisters.rcsta.rx9d",\r\nFT_BOOLEAN, 8, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_rcsta_oerr,\r\n{ "RCSTA.OERR", "r3.cpuregisters.rcsta.oerr",\r\nFT_BOOLEAN, 8, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_rcsta_ferr,\r\n{ "RCSTA.FERR", "r3.cpuregisters.rcsta.ferr",\r\nFT_BOOLEAN, 8, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_rcsta_adden,\r\n{ "RCSTA.ADDEN", "r3.cpuregisters.rcsta.adden",\r\nFT_BOOLEAN, 8, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_rcsta_cren,\r\n{ "RCSTA.CREN", "r3.cpuregisters.rcsta.cren",\r\nFT_BOOLEAN, 8, NULL, 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_rcsta_sren,\r\n{ "RCSTA.SREN", "r3.cpuregisters.rcsta.sren",\r\nFT_BOOLEAN, 8, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_rcsta_rx9,\r\n{ "RCSTA.RX9", "r3.cpuregisters.rcsta.rx9",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_rcsta_spen,\r\n{ "RCSTA.SPEN", "r3.cpuregisters.rcsta.spen",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_txsta_tx9d,\r\n{ "TXSTA.TX9D", "r3.cpuregisters.txsta.tx9d",\r\nFT_BOOLEAN, 8, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_txsta_trmt,\r\n{ "TXSTA.TRMT", "r3.cpuregisters.txsta.trmt",\r\nFT_BOOLEAN, 8, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_txsta_brgh,\r\n{ "TXSTA.BRGH", "r3.cpuregisters.txsta.brgh",\r\nFT_BOOLEAN, 8, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_txsta_sendb,\r\n{ "TXSTA.SENDB", "r3.cpuregisters.txsta.sendb",\r\nFT_BOOLEAN, 8, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_txsta_sync,\r\n{ "TXSTA.SYNC", "r3.cpuregisters.txsta.sync",\r\nFT_BOOLEAN, 8, NULL, 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_txsta_txen,\r\n{ "TXSTA.TXEN", "r3.cpuregisters.txsta.txen",\r\nFT_BOOLEAN, 8, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_txsta_tx9,\r\n{ "TXSTA.TX9", "r3.cpuregisters.txsta.tx9",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_txsta_csrc,\r\n{ "TXSTA.CSRC", "r3.cpuregisters.txsta.csrc",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_rcsta2_rx9d,\r\n{ "RCSTA2.RX9D", "r3.cpuregisters.rcsta2.rx9d",\r\nFT_BOOLEAN, 8, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_rcsta2_oerr,\r\n{ "RCSTA2.OERR", "r3.cpuregisters.rcsta2.oerr",\r\nFT_BOOLEAN, 8, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_rcsta2_ferr,\r\n{ "RCSTA2.FERR", "r3.cpuregisters.rcsta2.ferr",\r\nFT_BOOLEAN, 8, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_rcsta2_adden,\r\n{ "RCSTA2.ADDEN", "r3.cpuregisters.rcsta2.adden",\r\nFT_BOOLEAN, 8, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_rcsta2_cren,\r\n{ "RCSTA2.CREN", "r3.cpuregisters.rcsta2.cren",\r\nFT_BOOLEAN, 8, NULL, 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_rcsta2_sren,\r\n{ "RCSTA2.SREN", "r3.cpuregisters.rcsta2.sren",\r\nFT_BOOLEAN, 8, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_rcsta2_rx9,\r\n{ "RCSTA2.RX9", "r3.cpuregisters.rcsta2.rx9",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_rcsta2_spen,\r\n{ "RCSTA2.SPEN", "r3.cpuregisters.rcsta2.spen",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_txsta2_tx9d,\r\n{ "TXSTA2.TX9D", "r3.cpuregisters.txsta2.tx9d",\r\nFT_BOOLEAN, 8, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_txsta2_trmt,\r\n{ "TXSTA2.TRMT", "r3.cpuregisters.txsta2.trmt",\r\nFT_BOOLEAN, 8, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_txsta2_brgh,\r\n{ "TXSTA2.BRGH", "r3.cpuregisters.txsta2.brgh",\r\nFT_BOOLEAN, 8, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_txsta2_sendb,\r\n{ "TXSTA2.SENDB", "r3.cpuregisters.txsta2.sendb",\r\nFT_BOOLEAN, 8, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_txsta2_sync,\r\n{ "TXSTA2.SYNC", "r3.cpuregisters.txsta2.sync",\r\nFT_BOOLEAN, 8, NULL, 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_txsta2_txen,\r\n{ "TXSTA2.TXEN", "r3.cpuregisters.txsta2.txen",\r\nFT_BOOLEAN, 8, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_txsta2_tx9,\r\n{ "TXSTA2.TX9", "r3.cpuregisters.txsta2.tx9",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_txsta2_csrc,\r\n{ "TXSTA2.CSRC", "r3.cpuregisters.txsta2.csrc",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_wdtcon_swdten,\r\n{ "WDTCON.SWDTEN", "r3.cpuregisters.wdtcon.swdten",\r\nFT_BOOLEAN, 8, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_wdtcon_unused1,\r\n{ "WDTCON.UNUSED1", "r3.cpuregisters.wdtcon.unused1",\r\nFT_BOOLEAN, 8, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_wdtcon_unused2,\r\n{ "WDTCON.UNUSED2", "r3.cpuregisters.wdtcon.unused2",\r\nFT_BOOLEAN, 8, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_wdtcon_unused3,\r\n{ "WDTCON.UNUSED3", "r3.cpuregisters.wdtcon.unused3",\r\nFT_BOOLEAN, 8, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_wdtcon_unused4,\r\n{ "WDTCON.UNUSED4", "r3.cpuregisters.wdtcon.unused4",\r\nFT_BOOLEAN, 8, NULL, 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_wdtcon_unused5,\r\n{ "WDTCON.UNUSED5", "r3.cpuregisters.wdtcon.unused5",\r\nFT_BOOLEAN, 8, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_wdtcon_unused6,\r\n{ "WDTCON.UNUSED6", "r3.cpuregisters.wdtcon.unused6",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_cpuregisters_wdtcon_unused7,\r\n{ "WDTCON.UNUSED7", "r3.cpuregisters.wdtcon.unused7",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg00,\r\n{ "REG 0x00", "r3.m41t81.reg00",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg01,\r\n{ "REG 0x01", "r3.m41t81.reg01",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg02,\r\n{ "REG 0x02", "r3.m41t81.reg02",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg03,\r\n{ "REG 0x03", "r3.m41t81.reg03",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg04,\r\n{ "REG 0x04", "r3.m41t81.reg04",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg05,\r\n{ "REG 0x05", "r3.m41t81.reg05",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg06,\r\n{ "REG 0x06", "r3.m41t81.reg06",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg07,\r\n{ "REG 0x07", "r3.m41t81.reg07",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg08,\r\n{ "REG 0x08", "r3.m41t81.reg08",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg09,\r\n{ "REG 0x09", "r3.m41t81.reg09",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg0a,\r\n{ "REG 0x0a", "r3.m41t81.reg0a",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg0b,\r\n{ "REG 0x0b", "r3.m41t81.reg0b",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg0c,\r\n{ "REG 0x0c", "r3.m41t81.reg0c",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg0d,\r\n{ "REG 0x0d", "r3.m41t81.reg0d",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg0e,\r\n{ "REG 0x0e", "r3.m41t81.reg0e",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg0f,\r\n{ "REG 0x0f", "r3.m41t81.reg0f",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg10,\r\n{ "REG 0x10", "r3.m41t81.reg10",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg11,\r\n{ "REG 0x11", "r3.m41t81.reg11",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg12,\r\n{ "REG 0x12", "r3.m41t81.reg12",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg13,\r\n{ "REG 0x13", "r3.m41t81.reg13",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg00_sec1,\r\n{ ".1 Seconds", "r3.m41t81.reg00.sec1",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg00_sec01,\r\n{ ".01 Seconds", "r3.m41t81.reg00.sec01",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg01_st,\r\n{ "ST", "r3.m41t81.reg01.st",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg01_10sec,\r\n{ "10 Seconds", "r3.m41t81.reg01.10sec",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg01_1sec,\r\n{ "1 Seconds", "r3.m41t81.reg01.1sec",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg02_notused,\r\n{ "(not used)", "r3.m41t81.reg02.notused",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg02_10min,\r\n{ "10 Minutes", "r3.m41t81.reg02.10min",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg02_1min,\r\n{ "1 Minutes", "r3.m41t81.reg02.1min",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg03_cbe,\r\n{ "CBE", "r3.m41t81.reg03.cbe",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg03_cb,\r\n{ "CB", "r3.m41t81.reg03.cb",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg03_10hour,\r\n{ "10 Hours", "r3.m41t81.reg03.10hour",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg03_1hour,\r\n{ "1 Hours", "r3.m41t81.reg03.1hour",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg04_notused,\r\n{ "(not used)", "r3.m41t81.reg04.notused",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg04_dow,\r\n{ "DOW", "r3.m41t81.reg04.dow",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg05_notused,\r\n{ "(not used)", "r3.m41t81.reg05.notused",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg05_10day,\r\n{ "10 Day", "r3.m41t81.reg05.10day",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg05_1day,\r\n{ "1 Day", "r3.m41t81.reg05.1day",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg06_notused,\r\n{ "(not used)", "r3.m41t81.reg06.notused",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg06_10month,\r\n{ "10 Month", "r3.m41t81.reg06.10month",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg06_1month,\r\n{ "1 Month", "r3.m41t81.reg06.1month",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg07_10year,\r\n{ "10 Year", "r3.m41t81.reg07.10year",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg07_1year,\r\n{ "1 Year", "r3.m41t81.reg07.1year",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg08_out,\r\n{ "OUT", "r3.m41t81.reg08.out",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg08_ft,\r\n{ "FT", "r3.m41t81.reg08.ft",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg08_s,\r\n{ "S", "r3.m41t81.reg08.s",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg08_cal,\r\n{ "CAL", "r3.m41t81.reg08.cal",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg09_notused,\r\n{ "(not used)", "r3.m41t81.reg09.notused",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg09_bmb,\r\n{ "BMB", "r3.m41t81.reg09.bmb",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg09_rb,\r\n{ "RB", "r3.m41t81.reg09.rb",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg0a_afe,\r\n{ "AFE", "r3.m41t81.reg0a.afe",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg0a_sqwe,\r\n{ "SQWE", "r3.m41t81.reg0a.sqwe",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg0a_abe,\r\n{ "ABE", "r3.m41t81.reg0a.abe",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg0a_10monthalm,\r\n{ "10 Month Alarm", "r3.m41t81.reg0a.10monthalm",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg0a_1monthalm,\r\n{ "1 Month Alarm", "r3.m41t81.reg0a.1monthalm",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg0b_rpt5,\r\n{ "RPT5", "r3.m41t81.reg0b.rpt5",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg0b_rpt4,\r\n{ "RPT4", "r3.m41t81.reg0b.rpt4",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg0b_10dayalm,\r\n{ "10 Day Alarm", "r3.m41t81.reg0b.10dayalm",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg0b_1dayalm,\r\n{ "1 Day Alarm", "r3.m41t81.reg0b.1dayalm",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg0c_rpt3,\r\n{ "RPT3", "r3.m41t81.reg0c.rpt3",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg0c_ht,\r\n{ "HT", "r3.m41t81.reg0c.ht",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg0c_10houralm,\r\n{ "10 Hour Alarm", "r3.m41t81.reg0c.10houralm",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg0c_1houralm,\r\n{ "1 Hour Alarm", "r3.m41t81.reg0c.1houralm",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg0d_rpt2,\r\n{ "RPT2", "r3.m41t81.reg0d.rpt2",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg0d_10minalm,\r\n{ "10 Min Alarm", "r3.m41t81.reg0d.10minalm",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg0d_1minalm,\r\n{ "1 Min Alarm", "r3.m41t81.reg0d.1minalm",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg0e_rpt1,\r\n{ "RPT1", "r3.m41t81.reg0e.rpt1",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg0e_10secalm,\r\n{ "10 Sec Alarm", "r3.m41t81.reg0e.10secalm",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg0e_1secalm,\r\n{ "1 Sec Alarm", "r3.m41t81.reg0e.1secalm",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg0f_wdf,\r\n{ "WDF", "r3.m41t81.reg0f.wdf",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg0f_af,\r\n{ "AF", "r3.m41t81.reg0f.af",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg0f_notused,\r\n{ "(not used)", "r3.m41t81.reg0f.notused",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg10_notused,\r\n{ "(not used)", "r3.m41t81.reg10.notused",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg11_notused,\r\n{ "(not used)", "r3.m41t81.reg11.notused",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg12_notused,\r\n{ "(not used)", "r3.m41t81.reg12.notused",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg13_rs,\r\n{ "RS", "r3.m41t81.reg13.rs",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_dumpm41t81_reg13_notused,\r\n{ "(not used)", "r3.m41t81.reg13.notused",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_sn_manufacturer,\r\n{ "Manufacturer", "r3.sn.manufacturer",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_sn_year,\r\n{ "Year", "r3.sn.year",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_sn_week,\r\n{ "Week", "r3.sn.week",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_sn_model,\r\n{ "Model", "r3.sn.model",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_sn_sequence,\r\n{ "Sequence", "r3.sn.sequence",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_sn_group,\r\n{ "Group", "r3.sn.group",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_sn_nid,\r\n{ "NID", "r3.sn.nid",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_sn_hid,\r\n{ "HID", "r3.sn.hid",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_sn_power_supply,\r\n{ "Power Supply", "r3.sn.power_supply",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_sn_mortise,\r\n{ "Mortise", "r3.sn.mortise",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_debuglog_recordnumber,\r\n{ "Record Number", "r3.debuglog.recordnumber",\r\nFT_UINT16, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_debuglog_flags,\r\n{ "Flags", "r3.debuglog.flags",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_debuglog_tick,\r\n{ "Tick", "r3.debuglog.tick",\r\nFT_UINT16, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_adduserparamtype,\r\n{ "Upstream Field", "r3.manageuser",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_adduserparamtypelength,\r\n{ "Field Length", "r3.manageuser.length",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_adduserparamtypetype,\r\n{ "Field Type", "r3.manageuser.type",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_adduserparamtypenames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_r3_adduserparamtypedatalen,\r\n{ "Data Length", "r3.manageuser.datalen",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_adduserparamtypeerror,\r\n{ "Error", "r3.manageuser.error",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_r3_adduserparamtypearray [ADDUSERPARAMTYPE_DISPOSITION],\r\n{ "Disposition", "r3.manageuser.disposition",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_dispositionnames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_adduserparamtypearray [ADDUSERPARAMTYPE_USERNO],\r\n{ "User Number", "r3.manageuser.usernumber",\r\nFT_UINT16, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_adduserparamtypearray [ADDUSERPARAMTYPE_ACCESSALWAYS],\r\n{ "Access Always", "r3.manageuser.accessalways",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_adduserparamtypearray [ADDUSERPARAMTYPE_ACCESSMODE],\r\n{ "Access Mode", "r3.manageuser.accessmode",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_accessmodenames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_adduserparamtypearray [ADDUSERPARAMTYPE_CACHED],\r\n{ "Cached", "r3.manageuser.cached",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_adduserparamtypearray [ADDUSERPARAMTYPE_USERTYPE],\r\n{ "User Type", "r3.manageuser.usertype",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_usertypenames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_adduserparamtypearray [ADDUSERPARAMTYPE_PRIMARYFIELD],\r\n{ "Primary Field", "r3.manageuser.primaryfield",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_adduserparamtypearray [ADDUSERPARAMTYPE_PRIMARYFIELDTYPE],\r\n{ "Primary Field Type", "r3.manageuser.primaryfieldtype",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_ppmisourcenames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_adduserparamtypearray [ADDUSERPARAMTYPE_AUXFIELD],\r\n{ "Aux Field", "r3.manageuser.auxfield",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_adduserparamtypearray [ADDUSERPARAMTYPE_AUXFIELDTYPE],\r\n{ "Aux Field Type", "r3.manageuser.auxfieldtype",\r\nFT_UINT8, BASE_DEC_HEX|BASE_EXT_STRING, &r3_ppmisourcenames_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_adduserparamtypearray [ADDUSERPARAMTYPE_USECOUNT],\r\n{ "Use Count", "r3.manageuser.usecount",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_adduserparamtypearray [ADDUSERPARAMTYPE_EXCEPTIONGROUP],\r\n{ "Exception Group", "r3.manageuser.exceptiongroup",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_adduserparamtypearray [ADDUSERPARAMTYPE_EXPIREON],\r\n{ "Expire On", "r3.manageuser.expireon",\r\nFT_UINT24, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_r3_adduserparamtypearray [ADDUSERPARAMTYPE_TIMEZONE],\r\n{ "Timezone", "r3.manageuser.timezone",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n}\r\n};\r\nstatic gint *ett [] =\r\n{\r\n&ett_r3,\r\n&ett_r3header,\r\n&ett_r3tail,\r\n&ett_r3payload,\r\n&ett_r3cmd,\r\n&ett_r3configitem,\r\n&ett_r3upstreamcommand,\r\n&ett_r3upstreamfield,\r\n&ett_r3timezone,\r\n&ett_r3expireon,\r\n&ett_r3datetime,\r\n&ett_r3eventlogrecord,\r\n&ett_r3declinedlogrecord,\r\n&ett_r3alarmlogrecord,\r\n&ett_r3debugmsg,\r\n&ett_r3defineexceptionstartdate,\r\n&ett_r3defineexceptionenddate,\r\n&ett_r3defineexceptiongroupbits,\r\n&ett_r3definecalendarmonth [1],\r\n&ett_r3definecalendarmonth [2],\r\n&ett_r3definecalendarmonth [3],\r\n&ett_r3definecalendarmonth [4],\r\n&ett_r3definecalendarmonth [5],\r\n&ett_r3definecalendarmonth [6],\r\n&ett_r3definecalendarmonth [7],\r\n&ett_r3definecalendarmonth [8],\r\n&ett_r3definecalendarmonth [9],\r\n&ett_r3definecalendarmonth [10],\r\n&ett_r3definecalendarmonth [11],\r\n&ett_r3definecalendarmonth [12],\r\n&ett_r3definetimezonestarttime,\r\n&ett_r3definetimezoneendtime,\r\n&ett_r3definetimezonedaymap,\r\n&ett_r3eventlogdumpstarttime,\r\n&ett_r3eventlogdumpendtime,\r\n&ett_r3declinedlogdumpstarttime,\r\n&ett_r3declinedlogdumpendtime,\r\n&ett_r3alarmlogdumpstarttime,\r\n&ett_r3alarmlogdumpendtime,\r\n&ett_r3clearnvram,\r\n&ett_r3filters,\r\n&ett_r3alarmlist,\r\n&ett_r3alarmcfg,\r\n&ett_r3commandmfg,\r\n&ett_r3serialnumber,\r\n&ett_r3iopins,\r\n&ett_r3checksumresults,\r\n&ett_r3checksumresultsfield,\r\n&ett_r3forceoptions,\r\n&ett_r3peekpoke,\r\n&ett_r3downloadfirmware,\r\n&ett_r3capabilities,\r\n&ett_r3lockstate,\r\n&ett_r3mortisestatelog,\r\n&ett_r3timerchain,\r\n&ett_r3taskflags,\r\n&ett_r3taskflagsentry,\r\n&ett_r3checkpointlog,\r\n&ett_r3checkpointlogentry,\r\n&ett_r3cpuregisters,\r\n&ett_r3cpuregister,\r\n&ett_r3m41t81registers,\r\n&ett_r3m41t81register,\r\n&ett_r3debuglogrecord,\r\n&ett_r3setdatetime,\r\n&ett_r3manageuser\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_r3_malformed_length, { "r3.malformed_length", PI_MALFORMED, PI_ERROR, "Malformed length", EXPFILL }},\r\n{ &ei_r3_reserved_upstream_command_value, { "r3.reserved_upstream_command_value", PI_UNDECODED, PI_WARN, "\"Reserved\" Upstream Command value", EXPFILL }},\r\n{ &ei_r3_mfgfield, { "r3.mfgfield.field.unknown", PI_UNDECODED, PI_WARN, "Unknown manufacturing command value", EXPFILL }},\r\n{ &ei_r3_mfgfield_too_many_adc_values, { "r3.mfgfield.too_many_adc_values", PI_PROTOCOL, PI_WARN, "MFG Field: too many adc values", EXPFILL }},\r\n{ &ei_r3_peekpoke_operation, { "r3.peekpoke.operation.unknown", PI_UNDECODED, PI_WARN, "Unknown peekpoke operation value", EXPFILL }},\r\n{ &ei_r3_response_hasdata_octet_1, { "r3.response_hasdata.octet_1_not_cmd_response", PI_PROTOCOL, PI_WARN, "Octet 1 not CMD_RESPONSE", EXPFILL }},\r\n{ &ei_r3_response_hasdata_octet_2, { "r3.response_hasdata.octet_2_not_response_hasdata", PI_PROTOCOL, PI_WARN, "Octet 2 not RESPONSE_HASDATA", EXPFILL }},\r\n{ &ei_r3_response_hasdata_octet_3, { "r3.response_hasdata.octet_3_ge_upstreamcommand_last", PI_PROTOCOL, PI_WARN, "Octet 3 >= UPSTREAMCOMMAND_LAST", EXPFILL }},\r\n{ &ei_r3_firmwaredownload_action, { "r3.firmwaredownload.action.unknown", PI_PROTOCOL, PI_WARN, "Unknown Firmware download action", EXPFILL }},\r\n{ &ei_r3_cmd_downloadfirmwaretimeout, { "r3.command.downloadfirmwaretimeout", PI_UNDECODED, PI_WARN, "Download Firmware Timeout", EXPFILL }},\r\n{ &ei_r3_unknown_command_value, { "r3.command.unknown", PI_UNDECODED, PI_WARN, "Unknown command value", EXPFILL }},\r\n};\r\nexpert_module_t* expert_r3;\r\nproto_r3 = proto_register_protocol ("Assa Abloy R3", "R3", "r3");\r\nregister_dissector ("r3", dissect_r3, proto_r3);\r\nproto_register_field_array (proto_r3, hf, array_length (hf));\r\nproto_register_subtree_array (ett, array_length (ett));\r\nexpert_r3 = expert_register_protocol(proto_r3);\r\nexpert_register_field_array(expert_r3, ei, array_length(ei));\r\n}\r\nvoid proto_reg_handoff_r3 (void)\r\n{\r\ndissector_handle_t r3_handle = find_dissector ("r3");\r\ndissector_add_uint ("tcp.port", 2571, r3_handle);\r\ndissector_add_uint ("tcp.port", 8023, r3_handle);\r\n}
