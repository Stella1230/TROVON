static void\r\ndissect_wfd_subelem_device_info(proto_tree *tree, tvbuff_t *tvb, int offset)\r\n{\r\nproto_tree_add_item(tree, hf_wfd_subelem_dev_info_type,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_wfd_subelem_dev_info_coupled_sink_source,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_wfd_subelem_dev_info_coupled_sink_sink,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_wfd_subelem_dev_info_available,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_wfd_subelem_dev_info_wsd,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_wfd_subelem_dev_info_pc,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_wfd_subelem_dev_info_content_protection,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_wfd_subelem_dev_info_time_sync,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_wfd_subelem_dev_info_audio_unsupp_pri_sink,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_wfd_subelem_dev_info_audio_only_supp_source,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_wfd_subelem_dev_info_tdls_persistent_group,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,\r\nhf_wfd_subelem_dev_info_tdls_persistent_group_reinvoke,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_wfd_subelem_dev_info_reserved,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_wfd_subelem_dev_info_control_port,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_wfd_subelem_dev_info_max_throughput,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_wfd_subelem_associated_bssid(packet_info *pinfo, proto_tree *tree,\r\ntvbuff_t *tvb, int offset, int len)\r\n{\r\nif (len < 6) {\r\nexpert_add_info_format(pinfo, tree, &ei_wfd_subelem_len_invalid, "Too short Wi-Fi Display Associated BSSID");\r\nreturn;\r\n}\r\nproto_tree_add_item(tree, hf_wfd_subelem_assoc_bssid, tvb, offset, 6, ENC_NA);\r\n}\r\nstatic void\r\ndissect_wfd_subelem_coupled_sink(packet_info *pinfo, proto_tree *tree,\r\ntvbuff_t *tvb, int offset, int len)\r\n{\r\nif (len < 1) {\r\nexpert_add_info_format(pinfo, tree, &ei_wfd_subelem_len_invalid, "Too short Wi-Fi Display Coupled Sink");\r\nreturn;\r\n}\r\nproto_tree_add_item(tree, hf_wfd_subelem_coupled_sink_status_bitmap,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_wfd_subelem_coupled_sink_reserved,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\nif (len < 1 + 6) {\r\nexpert_add_info_format(pinfo, tree, &ei_wfd_subelem_len_invalid, "Too short Wi-Fi Display Coupled Sink");\r\nreturn;\r\n}\r\nproto_tree_add_item(tree, hf_wfd_subelem_coupled_sink_mac_addr, tvb,\r\noffset + 1, 6, ENC_NA);\r\n}\r\nstatic void\r\ndissect_wfd_subelem_session_info(packet_info *pinfo, proto_tree *tree,\r\ntvbuff_t *tvb, int offset, guint16 len)\r\n{\r\nint end = offset + len, next;\r\nproto_item *item;\r\nproto_tree *descr;\r\nwhile (offset < end) {\r\nguint8 dlen = tvb_get_guint8(tvb, offset);\r\nnext = offset + 1 + dlen;\r\ndescr = proto_tree_add_subtree(tree, tvb, offset, 1 + dlen,\r\nett_wfd_dev_info_descr, &item, "WFD Device Info Descriptor");\r\nif (offset + 1 + dlen > end || dlen < 23) {\r\nexpert_add_info(pinfo, item, &ei_wfd_subelem_session_descr_invalid);\r\nbreak;\r\n}\r\nproto_tree_add_item(descr, hf_wfd_subelem_session_descr_len,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(descr, hf_wfd_subelem_session_dev_addr, tvb, offset, 6,\r\nENC_NA);\r\nproto_item_append_text(descr, ": %s", tvb_ether_to_str(tvb, offset));\r\noffset += 6;\r\nproto_tree_add_item(descr, hf_wfd_subelem_session_assoc_bssid,\r\ntvb, offset, 6, ENC_NA);\r\noffset += 6;\r\nproto_tree_add_item(descr, hf_wfd_subelem_session_dev_info_type,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(descr,\r\nhf_wfd_subelem_session_dev_info_coupled_sink_source,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(descr,\r\nhf_wfd_subelem_session_dev_info_coupled_sink_sink,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(descr, hf_wfd_subelem_session_dev_info_available,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(descr, hf_wfd_subelem_session_dev_info_wsd,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(descr, hf_wfd_subelem_session_dev_info_pc,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(descr,\r\nhf_wfd_subelem_session_dev_info_content_protection,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(descr, hf_wfd_subelem_session_dev_info_time_sync,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,\r\nhf_wfd_subelem_session_dev_info_audio_unsupp_pri_sink,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,\r\nhf_wfd_subelem_session_dev_info_audio_only_supp_source,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,\r\nhf_wfd_subelem_session_dev_info_tdls_persistent_group,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,\r\nhf_wfd_subelem_session_dev_info_tdls_persistent_group_reinvoke,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,\r\nhf_wfd_subelem_session_dev_info_reserved,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(descr, hf_wfd_subelem_session_dev_info_max_throughput,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(descr,\r\nhf_wfd_subelem_session_coupled_sink_status_bitmap,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(descr,\r\nhf_wfd_subelem_session_coupled_sink_reserved,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(descr, hf_wfd_subelem_session_coupled_sink_addr,\r\ntvb, offset, 6, ENC_NA);\r\noffset += 6;\r\nif (offset < next) {\r\nproto_tree_add_item(descr, hf_wfd_subelem_session_extra_info, tvb, offset, next - offset, ENC_NA);\r\n}\r\noffset = next;\r\n}\r\n}\r\nstatic void\r\ndissect_wfd_subelem_ext_capab(packet_info *pinfo, proto_tree *tree,\r\ntvbuff_t *tvb, int offset, int len)\r\n{\r\nif (len<2) {\r\nexpert_add_info_format(pinfo, tree, &ei_wfd_subelem_len_invalid,\r\n"Too short Wi-Fi Display Extended Capability");\r\nreturn;\r\n}\r\nproto_tree_add_item(tree, hf_wfd_subelem_ext_capab,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_wfd_subelem_ext_capab_uibc,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_wfd_subelem_ext_capab_i2c_read_write,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_wfd_subelem_ext_capab_preferred_display_mode,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_wfd_subelem_ext_capab_standby_resume_control,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_wfd_subelem_ext_capab_tdls_persistent,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_wfd_subelem_ext_capab_tdls_persistent_bssid,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_wfd_subelem_ext_capab_reserved,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_wfd_subelem_alt_mac_addr(packet_info *pinfo, proto_tree *tree,\r\ntvbuff_t *tvb, int offset, int len)\r\n{\r\nif (len<6) {\r\nexpert_add_info_format(pinfo, tree, &ei_wfd_subelem_len_invalid,\r\n"Too short Wi-Fi Display Alternative MAC Address");\r\nreturn;\r\n}\r\nproto_tree_add_item(tree, hf_wfd_subelem_alt_mac_addr,\r\ntvb, offset, 6, ENC_NA);\r\n}\r\nvoid dissect_wifi_display_ie(packet_info *pinfo, proto_tree *tree,\r\ntvbuff_t *tvb, int offset, gint size)\r\n{\r\nint end = offset + size;\r\nguint8 id;\r\nguint16 len;\r\nproto_tree *wfd_tree;\r\nproto_item *subelem;\r\nwhile (offset < end) {\r\nif (end - offset < 2) {\r\nexpert_add_info_format(pinfo, tree, &ei_wfd_subelem_len_invalid, "Packet too short for Wi-Fi Display subelement");\r\nbreak;\r\n}\r\nid = tvb_get_guint8(tvb, offset);\r\nlen = tvb_get_ntohs(tvb, offset + 1);\r\nwfd_tree = proto_tree_add_subtree(tree, tvb, offset, 3 + len,\r\nett_wfd_subelem, &subelem,\r\nval_to_str(id, wfd_subelem_ids,\r\n"Unknown subelement ID (%u)"));\r\nif (offset + 3 + len > end) {\r\nexpert_add_info_format(pinfo, subelem, &ei_wfd_subelem_len_invalid, "Packet too short for Wi-Fi Display subelement payload");\r\n}\r\nproto_tree_add_item(wfd_tree, hf_wfd_subelem_id, tvb, offset, 1,\r\nENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(wfd_tree, hf_wfd_subelem_len, tvb, offset, 2,\r\nENC_BIG_ENDIAN);\r\noffset += 2;\r\nswitch (id) {\r\ncase WFD_SUBELEM_DEVICE_INFO:\r\ndissect_wfd_subelem_device_info(wfd_tree, tvb, offset);\r\nbreak;\r\ncase WFD_SUBELEM_ASSOCIATED_BSSID:\r\ndissect_wfd_subelem_associated_bssid(pinfo, wfd_tree, tvb, offset, len);\r\nbreak;\r\ncase WFD_SUBELEM_COUPLED_SINK:\r\ndissect_wfd_subelem_coupled_sink(pinfo, wfd_tree, tvb, offset, len);\r\nbreak;\r\ncase WFD_SUBELEM_SESSION_INFO:\r\ndissect_wfd_subelem_session_info(pinfo, wfd_tree, tvb, offset, len);\r\nbreak;\r\ncase WFD_SUBELEM_EXT_CAPAB:\r\ndissect_wfd_subelem_ext_capab(pinfo, wfd_tree, tvb, offset, len);\r\nbreak;\r\ncase WFD_SUBELEM_ALT_MAC_ADDR:\r\ndissect_wfd_subelem_alt_mac_addr(pinfo, wfd_tree, tvb, offset, len);\r\nbreak;\r\ndefault:\r\nexpert_add_info(pinfo, subelem, &ei_wfd_subelem_id);\r\nbreak;\r\n}\r\noffset += len;\r\n}\r\n}\r\nvoid\r\nproto_register_wifi_display(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_wfd_subelem_id,\r\n{ "Subelement ID", "wifi_display.subelem.id",\r\nFT_UINT8, BASE_DEC, VALS(wfd_subelem_ids), 0, NULL, HFILL }},\r\n{ &hf_wfd_subelem_len,\r\n{ "Length", "wifi_display.subelem.length",\r\nFT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_wfd_subelem_dev_info_type,\r\n{ "Device type", "wifi_display.subelem.dev_info.type",\r\nFT_UINT16, BASE_DEC, VALS(wfd_dev_info_types), 0x0003, NULL, HFILL }},\r\n{ &hf_wfd_subelem_dev_info_coupled_sink_source,\r\n{ "Coupled sink operation supported by WFD source",\r\n"wifi_display.subelem.dev_info.coupled_sink_by_source",\r\nFT_BOOLEAN, 16, NULL, 0x0004, NULL, HFILL }},\r\n{ &hf_wfd_subelem_dev_info_coupled_sink_sink,\r\n{ "Coupled sink operation supported by WFD sink",\r\n"wifi_display.subelem.dev_info.coupled_sink_by_sink",\r\nFT_BOOLEAN, 16, NULL, 0x0008, NULL, HFILL }},\r\n{ &hf_wfd_subelem_dev_info_available,\r\n{ "Available for WFD Session", "wifi_display.subelem.dev_info.available",\r\nFT_UINT16, BASE_DEC, VALS(wfd_dev_info_avail), 0x0030, NULL, HFILL }},\r\n{ &hf_wfd_subelem_dev_info_wsd,\r\n{ "WFD Service Discovery", "wifi_display.subelem.dev_info.wsd",\r\nFT_BOOLEAN, 16, NULL, 0x0040, NULL, HFILL }},\r\n{ &hf_wfd_subelem_dev_info_pc,\r\n{ "Preferred Connectivity", "wifi_display.subelem.dev_info.pc",\r\nFT_UINT16, BASE_DEC, VALS(wfd_dev_info_pc), 0x0080, NULL, HFILL }},\r\n{ &hf_wfd_subelem_dev_info_content_protection,\r\n{ "Content Protection using HDCP2.0",\r\n"wifi_display.subelem.dev_info.content_protection",\r\nFT_BOOLEAN, 16, NULL, 0x0100, NULL, HFILL }},\r\n{ &hf_wfd_subelem_dev_info_time_sync,\r\n{ "Time Synchronization using 802.1AS",\r\n"wifi_display.subelem.dev_info.time_sync",\r\nFT_BOOLEAN, 16, NULL, 0x0200, NULL, HFILL }},\r\n{ &hf_wfd_subelem_dev_info_audio_unsupp_pri_sink,\r\n{ "Audio un-supported at Primary sink",\r\n"wifi_display.subelem.session.audio_unsupp_pri_sink",\r\nFT_BOOLEAN, 16, NULL, 0x0400, NULL, HFILL }},\r\n{ &hf_wfd_subelem_dev_info_audio_only_supp_source,\r\n{ "Audio only support af WFD source",\r\n"wifi_display.subelem.session.audio_only_supp_source",\r\nFT_BOOLEAN, 16, NULL, 0x0800, NULL, HFILL }},\r\n{ &hf_wfd_subelem_dev_info_tdls_persistent_group,\r\n{ "TDLS Persistent Group",\r\n"wifi_display.subelem.session.tdls_persistent_group",\r\nFT_BOOLEAN, 16, NULL, 0x1000, NULL, HFILL }},\r\n{ &hf_wfd_subelem_dev_info_tdls_persistent_group_reinvoke,\r\n{ "TDLS Persistent Group Re-invoke",\r\n"wifi_display.subelem.session.tdls_persistent_group_reinvoke",\r\nFT_BOOLEAN, 16, NULL, 0x2000, NULL, HFILL }},\r\n{ &hf_wfd_subelem_dev_info_reserved,\r\n{ "Reserved", "wifi_display.subelem.session.reserved",\r\nFT_UINT16, BASE_DEC, NULL, 0xc000, NULL, HFILL }},\r\n{ &hf_wfd_subelem_dev_info_control_port,\r\n{ "Session Management Control Port",\r\n"wifi_display.subelem.dev_info.control_port",\r\nFT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_wfd_subelem_dev_info_max_throughput,\r\n{ "WFD Device Maximum Throughput (Mbps)",\r\n"wifi_display.subelem.dev_info.max_throughput",\r\nFT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_wfd_subelem_assoc_bssid,\r\n{ "Associated BSSID", "wifi_display.subelem.assoc_bssid.bssid",\r\nFT_ETHER, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_wfd_subelem_coupled_sink_status_bitmap,\r\n{ "Coupled Sink Status bitmap",\r\n"wifi_display.subelem.coupled_sink.status",\r\nFT_UINT8, BASE_DEC, VALS(wfd_coupled_sink_status_bitmap), 0x03,\r\nNULL, HFILL }},\r\n{ &hf_wfd_subelem_coupled_sink_reserved,\r\n{ "Reserved", "wifi_display.subelem.coupled_sink.reserved",\r\nFT_UINT8, BASE_DEC, NULL, 0xfc, NULL, HFILL }},\r\n{ &hf_wfd_subelem_coupled_sink_mac_addr,\r\n{ "Coupled Sink MAC Address",\r\n"wifi_display.subelem.coupled_sink.mac_addr",\r\nFT_ETHER, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_wfd_subelem_session_descr_len,\r\n{ "Descriptor length",\r\n"wifi_display.subelem.session.descr_len",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_wfd_subelem_session_dev_addr,\r\n{ "Device address",\r\n"wifi_display.subelem.session.device_address",\r\nFT_ETHER, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_wfd_subelem_session_assoc_bssid,\r\n{ "Associated BSSID",\r\n"wifi_display.subelem.session.associated_bssid",\r\nFT_ETHER, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_wfd_subelem_session_dev_info_type,\r\n{ "Device type", "wifi_display.subelem.session.type",\r\nFT_UINT16, BASE_DEC, VALS(wfd_dev_info_types), 0x0003, NULL, HFILL }},\r\n{ &hf_wfd_subelem_session_dev_info_coupled_sink_source,\r\n{ "Coupled sink operation supported by WFD source",\r\n"wifi_display.subelem.session.coupled_sink_by_source",\r\nFT_BOOLEAN, 16, NULL, 0x0004, NULL, HFILL }},\r\n{ &hf_wfd_subelem_session_dev_info_coupled_sink_sink,\r\n{ "Coupled sink operation supported by WFD sink",\r\n"wifi_display.subelem.session.coupled_sink_by_sink",\r\nFT_BOOLEAN, 16, NULL, 0x0008, NULL, HFILL }},\r\n{ &hf_wfd_subelem_session_dev_info_available,\r\n{ "Available for WFD Session", "wifi_display.subelem.session.available",\r\nFT_UINT16, BASE_DEC, VALS(wfd_dev_info_avail), 0x0030, NULL, HFILL }},\r\n{ &hf_wfd_subelem_session_dev_info_wsd,\r\n{ "WFD Service Discovery", "wifi_display.subelem.session.wsd",\r\nFT_BOOLEAN, 16, NULL, 0x0040, NULL, HFILL }},\r\n{ &hf_wfd_subelem_session_dev_info_pc,\r\n{ "Preferred Connectivity", "wifi_display.subelem.session.pc",\r\nFT_UINT16, BASE_DEC, VALS(wfd_dev_info_pc), 0x0080, NULL, HFILL }},\r\n{ &hf_wfd_subelem_session_dev_info_content_protection,\r\n{ "Content Protection using HDCP2.0",\r\n"wifi_display.subelem.session.content_protection",\r\nFT_BOOLEAN, 16, NULL, 0x0100, NULL, HFILL }},\r\n{ &hf_wfd_subelem_session_dev_info_time_sync,\r\n{ "Time Synchronization using 802.1AS",\r\n"wifi_display.subelem.session.time_sync",\r\nFT_BOOLEAN, 16, NULL, 0x0200, NULL, HFILL }},\r\n{ &hf_wfd_subelem_session_dev_info_audio_unsupp_pri_sink,\r\n{ "Audio un-supported at Primary sink",\r\n"wifi_display.subelem.session.audio_unsupp_pri_sink",\r\nFT_BOOLEAN, 16, NULL, 0x0400, NULL, HFILL }},\r\n{ &hf_wfd_subelem_session_dev_info_audio_only_supp_source,\r\n{ "Audio only support af WFD source",\r\n"wifi_display.subelem.session.audio_only_supp_source",\r\nFT_BOOLEAN, 16, NULL, 0x0800, NULL, HFILL }},\r\n{ &hf_wfd_subelem_session_dev_info_tdls_persistent_group,\r\n{ "TDLS Persistent Group",\r\n"wifi_display.subelem.session.tdls_persistent_group",\r\nFT_BOOLEAN, 16, NULL, 0x1000, NULL, HFILL }},\r\n{ &hf_wfd_subelem_session_dev_info_tdls_persistent_group_reinvoke,\r\n{ "TDLS Persistent Group Re-invoke",\r\n"wifi_display.subelem.session.tdls_persistent_group_reinvoke",\r\nFT_BOOLEAN, 16, NULL, 0x2000, NULL, HFILL }},\r\n{ &hf_wfd_subelem_session_dev_info_reserved,\r\n{ "Reserved", "wifi_display.subelem.session.reserved",\r\nFT_UINT16, BASE_DEC, NULL, 0xc000, NULL, HFILL }},\r\n{ &hf_wfd_subelem_session_dev_info_max_throughput,\r\n{ "WFD Device Maximum Throughput (Mbps)",\r\n"wifi_display.subelem.session.max_throughput",\r\nFT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_wfd_subelem_session_coupled_sink_status_bitmap,\r\n{ "Coupled Sink Status bitmap",\r\n"wifi_display.subelem.session.coupled_sink_status",\r\nFT_UINT8, BASE_DEC, VALS(wfd_coupled_sink_status_bitmap), 0x03,\r\nNULL, HFILL }},\r\n{ &hf_wfd_subelem_session_coupled_sink_reserved,\r\n{ "Reserved", "wifi_display.subelem.session.coupled_sink.reserved",\r\nFT_UINT8, BASE_DEC, NULL, 0xfc, NULL, HFILL }},\r\n{ &hf_wfd_subelem_session_coupled_sink_addr,\r\n{ "Coupled peer sink address",\r\n"wifi_display.subelem.session.coupled_peer_sink_addr",\r\nFT_ETHER, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_wfd_subelem_session_extra_info,\r\n{ "Extra info in the end of descriptor",\r\n"wifi_display.subelem.session.extra_info",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_wfd_subelem_ext_capab,\r\n{ "WFD Extended Capability Bitmap",\r\n"wifi_display.subelem.ext_capab",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_wfd_subelem_ext_capab_uibc,\r\n{ "User Input Back Channel(UIBC)",\r\n"wifi_display.subelem.ext_capab.uibc",\r\nFT_BOOLEAN, 16, TFS (&tfs_supported_not_supported), 0x0001, NULL, HFILL }},\r\n{ &hf_wfd_subelem_ext_capab_i2c_read_write,\r\n{ "I2C Read/Write",\r\n"wifi_display.subelem.ext_capab.i2c_read_write",\r\nFT_BOOLEAN, 16, TFS (&tfs_supported_not_supported), 0x0002, NULL, HFILL }},\r\n{ &hf_wfd_subelem_ext_capab_preferred_display_mode,\r\n{ "Preferred Display Mode",\r\n"wifi_display.subelem.ext_capab.preferred_display_mode",\r\nFT_BOOLEAN, 16, TFS (&tfs_supported_not_supported), 0x0004, NULL, HFILL }},\r\n{ &hf_wfd_subelem_ext_capab_standby_resume_control,\r\n{ "Standby and Resume Control",\r\n"wifi_display.subelem.ext_capab.standby_resume_control",\r\nFT_BOOLEAN, 16, TFS (&tfs_supported_not_supported), 0x008, NULL, HFILL }},\r\n{ &hf_wfd_subelem_ext_capab_tdls_persistent,\r\n{ "TDLS Persistent",\r\n"wifi_display.subelem.ext_capab.tdls_persistent",\r\nFT_BOOLEAN, 16, TFS (&tfs_supported_not_supported), 0x0010, NULL, HFILL }},\r\n{ &hf_wfd_subelem_ext_capab_tdls_persistent_bssid,\r\n{ "TDLS Persistent BSSID",\r\n"wifi_display.subelem.ext_capab.tdls_persistent_bssid",\r\nFT_BOOLEAN, 16, TFS (&tfs_supported_not_supported), 0x0020, NULL, HFILL }},\r\n{ &hf_wfd_subelem_ext_capab_reserved,\r\n{ "Reserved", "wifi_display.subelem.ext_capab.reserved",\r\nFT_UINT16, BASE_HEX, NULL, 0xffc0, NULL, HFILL }},\r\n{ &hf_wfd_subelem_alt_mac_addr,\r\n{ "Alternative MAC Address", "wifi_display.subelem.alt_mac_addr",\r\nFT_ETHER, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_wfd_subelem,\r\n&ett_wfd_dev_info_descr\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_wfd_subelem_len_invalid, { "wifi_display.subelem.length.invalid", PI_MALFORMED, PI_ERROR, "Subelement length invalid", EXPFILL }},\r\n{ &ei_wfd_subelem_session_descr_invalid, { "wifi_display.subelem.session.descr_invalid", PI_MALFORMED, PI_ERROR, "Invalid WFD Device Info Descriptor", EXPFILL }},\r\n{ &ei_wfd_subelem_id, { "wifi_display.subelem.id.unknown", PI_PROTOCOL, PI_WARN, "Unknown subelement payload", EXPFILL }},\r\n};\r\nexpert_module_t* expert_wifi_display;\r\nproto_wifi_display = proto_register_protocol("Wi-Fi Display", "WFD", "wifi_display");\r\nproto_register_field_array(proto_wifi_display, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_wifi_display = expert_register_protocol(proto_wifi_display);\r\nexpert_register_field_array(expert_wifi_display, ei, array_length(ei));\r\n}
