static void capwap_reassemble_init(void)\r\n{\r\nreassembly_table_init(&capwap_reassembly_table,\r\n&addresses_reassembly_table_functions);\r\n}\r\nstatic void capwap_reassemble_cleanup(void)\r\n{\r\nreassembly_table_destroy(&capwap_reassembly_table);\r\n}\r\nstatic void\r\ndissect_capwap_data_message_bindings_ieee80211(tvbuff_t *tvb, proto_tree *data_message_binding_tree, guint offset, packet_info *pinfo)\r\n{\r\nproto_item *data_message_binding_item, *ti;\r\nproto_tree *sub_data_message_binding_tree;\r\nif (global_capwap_data_udp_port == pinfo->destport)\r\n{\r\nguint16 data_rate;\r\ndata_message_binding_item = proto_tree_add_item(data_message_binding_tree, hf_capwap_header_wireless_data_ieee80211_fi, tvb, offset, 4, ENC_NA);\r\nsub_data_message_binding_tree = proto_item_add_subtree(data_message_binding_item, ett_capwap_data_message_bindings_ieee80211);\r\nproto_tree_add_item(sub_data_message_binding_tree, hf_capwap_header_wireless_data_ieee80211_fi_rssi, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_data_message_binding_tree, hf_capwap_header_wireless_data_ieee80211_fi_snr, tvb, offset+1, 1, ENC_BIG_ENDIAN);\r\nti = proto_tree_add_item(sub_data_message_binding_tree, hf_capwap_header_wireless_data_ieee80211_fi_data_rate, tvb, offset+2, 2, ENC_BIG_ENDIAN);\r\ndata_rate = tvb_get_ntohs(tvb, offset+2);\r\nproto_item_append_text(ti, " (%.1f Mb/s)", ((float)data_rate / 10));\r\n}\r\nelse\r\n{\r\ndata_message_binding_item = proto_tree_add_item(data_message_binding_tree, hf_capwap_header_wireless_data_ieee80211_dest_wlan,tvb, offset, 4, ENC_NA);\r\nsub_data_message_binding_tree = proto_item_add_subtree(data_message_binding_item, ett_capwap_data_message_bindings_ieee80211);\r\nproto_tree_add_item(sub_data_message_binding_tree, hf_capwap_header_wireless_data_ieee80211_dw_wlan_id_bitmap, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_data_message_binding_tree, hf_capwap_header_wireless_data_ieee80211_dw_reserved, tvb, offset+2, 2, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_capwap_encryption_capabilities(tvbuff_t *tvb, proto_tree *encryption_capabilities_tree, guint offset)\r\n{\r\nproto_item *encryption_capabilities_item;\r\nproto_tree *sub_encryption_capabilities_tree;\r\nencryption_capabilities_item = proto_tree_add_item(encryption_capabilities_tree, hf_capwap_msg_element_type_wtp_descriptor_encrypt, tvb, offset, 3, ENC_NA);\r\nsub_encryption_capabilities_tree = proto_item_add_subtree(encryption_capabilities_item, ett_capwap_encryption_capability);\r\nproto_tree_add_item(sub_encryption_capabilities_tree, hf_capwap_msg_element_type_wtp_descriptor_encrypt_reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (sub_encryption_capabilities_tree, hf_capwap_msg_element_type_wtp_descriptor_encrypt_wbid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_append_text(encryption_capabilities_item, ": (WBID %d)",tvb_get_guint8(tvb, offset) & 0x1F);\r\nproto_tree_add_item(sub_encryption_capabilities_tree, hf_capwap_msg_element_type_wtp_descriptor_encrypt_capabilities, tvb, offset+1, 2, ENC_BIG_ENDIAN);\r\nproto_item_append_text(encryption_capabilities_item, " %d",tvb_get_ntohs(tvb, offset+1));\r\n}\r\nstatic int\r\ndissect_capwap_ac_information(tvbuff_t *tvb, proto_tree *ac_information_type_tree, guint offset)\r\n{\r\nguint optlen,ac_information_type = 0;\r\nproto_item *ac_information_type_item;\r\nproto_tree *sub_ac_information_type_tree;\r\nac_information_type = tvb_get_ntohs(tvb, offset+4);\r\noptlen = tvb_get_ntohs(tvb, offset+6);\r\nac_information_type_item = proto_tree_add_item(ac_information_type_tree, hf_capwap_msg_element_type_ac_information, tvb, offset, 4+2+2+optlen, ENC_NA );\r\nproto_item_append_text(ac_information_type_item,": (t=%d,l=%d) %s", ac_information_type, optlen, val_to_str(ac_information_type,ac_information_type_vals,"Unknown AC Information Type (%02d)") );\r\nsub_ac_information_type_tree = proto_item_add_subtree(ac_information_type_item, ett_capwap_ac_information);\r\nproto_tree_add_item(sub_ac_information_type_tree, hf_capwap_msg_element_type_ac_information_vendor, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_ac_information_type_tree, hf_capwap_msg_element_type_ac_information_type, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_ac_information_type_tree, hf_capwap_msg_element_type_ac_information_length, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_ac_information_type_tree, hf_capwap_msg_element_type_ac_information_value, tvb, offset+8, optlen, ENC_NA);\r\nswitch (ac_information_type) {\r\ncase AC_INFORMATION_HARDWARE_VERSION:\r\nproto_tree_add_item(sub_ac_information_type_tree, hf_capwap_msg_element_type_ac_information_hardware_version, tvb, offset+8, optlen, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase AC_INFORMATION_SOFTWARE_VERSION:\r\nproto_tree_add_item(sub_ac_information_type_tree, hf_capwap_msg_element_type_ac_information_software_version, tvb, offset+8, optlen, ENC_ASCII|ENC_NA);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nreturn 4+2+2+optlen;\r\n}\r\nstatic int\r\ndissect_capwap_wtp_descriptor(tvbuff_t *tvb, proto_tree *wtp_descriptor_type_tree, guint offset)\r\n{\r\nguint optlen,wtp_descriptor_type = 0;\r\nproto_item *wtp_descriptor_type_item;\r\nproto_tree *sub_wtp_descriptor_type_tree;\r\nwtp_descriptor_type = tvb_get_ntohs(tvb, offset+4);\r\noptlen = tvb_get_ntohs(tvb, offset+6);\r\nwtp_descriptor_type_item = proto_tree_add_item(wtp_descriptor_type_tree, hf_capwap_msg_element_type_wtp_descriptor, tvb, offset, 4+2+2+optlen, ENC_NA);\r\nproto_item_append_text(wtp_descriptor_type_item, ": (t=%d,l=%d) %s", wtp_descriptor_type, optlen, val_to_str(wtp_descriptor_type,wtp_descriptor_type_vals,"Unknown WTP Descriptor Type (%02d)") );\r\nsub_wtp_descriptor_type_tree = proto_item_add_subtree(wtp_descriptor_type_item, ett_capwap_wtp_descriptor);\r\nproto_tree_add_item(sub_wtp_descriptor_type_tree, hf_capwap_msg_element_type_wtp_descriptor_vendor, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_wtp_descriptor_type_tree, hf_capwap_msg_element_type_wtp_descriptor_type, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_wtp_descriptor_type_tree, hf_capwap_msg_element_type_wtp_descriptor_length, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_wtp_descriptor_type_tree, hf_capwap_msg_element_type_wtp_descriptor_value, tvb, offset+8, optlen, ENC_NA);\r\nswitch (wtp_descriptor_type) {\r\ncase WTP_DESCRIPTOR_HARDWARE_VERSION:\r\nproto_tree_add_item(sub_wtp_descriptor_type_tree, hf_capwap_msg_element_type_wtp_descriptor_hardware_version, tvb, offset+8, optlen, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase WTP_DESCRIPTOR_ACTIVE_SOFTWARE_VERSION:\r\nproto_tree_add_item(sub_wtp_descriptor_type_tree, hf_capwap_msg_element_type_wtp_descriptor_active_software_version, tvb, offset+8, optlen, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase WTP_DESCRIPTOR_BOOT_VERSION:\r\nproto_tree_add_item(sub_wtp_descriptor_type_tree, hf_capwap_msg_element_type_wtp_descriptor_boot_version, tvb, offset+8, optlen, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase WTP_DESCRIPTOR_OTHER_SOFTWARE_VERSION:\r\nproto_tree_add_item(sub_wtp_descriptor_type_tree, hf_capwap_msg_element_type_wtp_descriptor_other_software_version, tvb, offset+8, optlen, ENC_ASCII|ENC_NA);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nreturn 4+2+2+optlen;\r\n}\r\nstatic int\r\ndissect_capwap_board_data(tvbuff_t *tvb, proto_tree *board_data_type_tree, guint offset)\r\n{\r\nguint optlen,board_data_type = 0;\r\nproto_item *board_data_type_item;\r\nproto_tree *sub_board_data_type_tree;\r\nboard_data_type = tvb_get_ntohs(tvb, offset);\r\noptlen = tvb_get_ntohs(tvb, offset+2);\r\nboard_data_type_item = proto_tree_add_item(board_data_type_tree, hf_capwap_msg_element_type_wtp_board_data, tvb, offset, 2+2+optlen, ENC_NA );\r\nproto_item_append_text(board_data_type_item, ": (t=%d,l=%d) %s", board_data_type, optlen, val_to_str(board_data_type,board_data_type_vals,"Unknown Board Data Type (%02d)") );\r\nsub_board_data_type_tree = proto_item_add_subtree(board_data_type_item, ett_capwap_board_data);\r\nproto_tree_add_item(sub_board_data_type_tree, hf_capwap_msg_element_type_wtp_board_data_type, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_board_data_type_tree, hf_capwap_msg_element_type_wtp_board_data_length, tvb, offset+2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_board_data_type_tree, hf_capwap_msg_element_type_wtp_board_data_value, tvb, offset+4, optlen, ENC_NA);\r\nswitch (board_data_type) {\r\ncase BOARD_DATA_WTP_MODEL_NUMBER:\r\nproto_tree_add_item(sub_board_data_type_tree, hf_capwap_msg_element_type_wtp_board_data_wtp_model_number, tvb, offset+4, optlen, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase BOARD_DATA_WTP_SERIAL_NUMBER:\r\nproto_tree_add_item(sub_board_data_type_tree, hf_capwap_msg_element_type_wtp_board_data_wtp_serial_number, tvb, offset+4, optlen, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase BOARD_DATA_BOARD_ID:\r\nproto_tree_add_item(sub_board_data_type_tree, hf_capwap_msg_element_type_wtp_board_data_wtp_board_id, tvb, offset+4, optlen, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase BOARD_DATA_BOARD_REVISION:\r\nproto_tree_add_item(sub_board_data_type_tree, hf_capwap_msg_element_type_wtp_board_data_wtp_board_revision, tvb, offset+4, optlen, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase BOARD_DATA_BASE_MAC_ADDRESS:\r\nproto_tree_add_item(sub_board_data_type_tree, hf_capwap_msg_element_type_wtp_board_data_base_mac_address, tvb, offset+4, 6, ENC_NA);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nreturn 2+2+optlen;\r\n}\r\nstatic int\r\ndissect_capwap_message_element_vendor_fortinet_type(tvbuff_t *tvb, proto_tree *sub_msg_element_type_tree, guint offset, packet_info *pinfo, guint optlen, proto_item *msg_element_type_item)\r\n{\r\nguint element_id, i;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_element_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nelement_id = tvb_get_ntohs(tvb, offset);\r\nproto_item_append_text(msg_element_type_item, ": Fortinet %s", val_to_str(element_id, fortinet_element_id_vals,"Unknown Vendor Specific Element Type (%02d)") );\r\noffset += 2;\r\noptlen -= 6;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_value, tvb, offset, optlen, ENC_NA);\r\nswitch(element_id){\r\ncase VSP_FORTINET_AP_SCAN:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_ap_scan_rid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_ap_scan_bgscan_intv, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_ap_scan_bgscan_idle, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_ap_scan_bgscan_rpt_intv, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_ap_scan_fgscan_rpt_intv, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nbreak;\r\ncase VSP_FORTINET_PASSIVE:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_passive_rid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_passive, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase VSP_FORTINET_DAEMON_RST:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_daemon_rst, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase VSP_FORTINET_MAC:{\r\nguint mac_length;\r\nproto_item *ti;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_mac_rid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_mac_wid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nti =proto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_mac_len, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nmac_length = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nif(mac_length %6 != 0)\r\n{\r\nexpert_add_info(pinfo, ti, &ei_capwap_fortinet_mac_len );\r\nbreak;\r\n}\r\nfor(i = 0; i < mac_length/6; i++){\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_mac, tvb, offset, 6, ENC_NA);\r\noffset += 6;\r\n}\r\n}\r\nbreak;\r\ncase VSP_FORTINET_WTP_ALLOW:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_wtp_allow_sn, tvb, offset, optlen-1, ENC_ASCII|ENC_NA);\r\noffset += optlen - 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_wtp_allow_allow, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase VSP_FORTINET_WBH_STA:{\r\nguint mac_length;\r\nproto_item *ti;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_wbh_sta_rid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nti = proto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_wbh_sta_len, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nmac_length = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nif(mac_length %6 != 0)\r\n{\r\nexpert_add_info(pinfo, ti, &ei_capwap_fortinet_mac_len );\r\nbreak;\r\n}\r\nfor(i = 0; i < mac_length/6; i++){\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_wbh_sta_mac, tvb, offset, 6, ENC_NA);\r\noffset += 6;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_wbh_sta_bssid, tvb, offset, 6, ENC_NA);\r\noffset += 6;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_wbh_sta_mhc, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\nbreak;\r\ncase VSP_FORTINET_HTCAP:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_htcap_rid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_htcap_mcs, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_htcap_gi, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_htcap_bw, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase VSP_FORTINET_MGMT_VAP:{\r\nguint16 sn_length;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_mvap_sn_length, tvb, offset, 2, ENC_NA);\r\nsn_length = tvb_get_ntohs(tvb, offset);\r\noffset += 2;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_mvap_sn, tvb, offset, sn_length, ENC_ASCII|ENC_NA);\r\noffset += sn_length;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_mvap_unknown, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_mvap_unknown, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_mvap_age, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_mvap_period, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_mvap_vfid, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nbreak;\r\n}\r\ncase VSP_FORTINET_MODE:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_mode_rid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_mode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase VSP_FORTINET_COEXT:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_coext_rid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_coext, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase VSP_FORTINET_AMSDU:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_amsdu_rid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_amsdu, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase VSP_FORTINET_PS_OPT:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_ps_opt_rid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_ps_opt, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase VSP_FORTINET_PURE:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_pure_rid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_pure, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase VSP_FORTINET_EBP_TAG:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_ebptag_ebp, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_ebptag_tag, tvb, offset, 6, ENC_NA);\r\noffset += 6;\r\nbreak;\r\ncase VSP_FORTINET_TELNET_ENABLE:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_telnet_enable, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nbreak;\r\ncase VSP_FORTINET_ADMIN_PASSWD:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_admin_passwd, tvb, offset, optlen, ENC_ASCII|ENC_NA);\r\noffset += optlen;\r\nbreak;\r\ncase VSP_FORTINET_REGCODE:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_regcode, tvb, offset, 3, ENC_ASCII|ENC_NA);\r\noffset += 3;\r\nbreak;\r\ncase VSP_FORTINET_COUNTRYCODE:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_countrycode_rid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_countrycode_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_countrycode_string, tvb, offset, 3, ENC_ASCII|ENC_NA);\r\noffset += 3;\r\nbreak;\r\ncase VSP_FORTINET_STA_SCAN:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_sta_scan_rid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_sta_scan, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nbreak;\r\ncase VSP_FORTINET_FHO:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_fho_rid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_fho, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase VSP_FORTINET_APHO:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_apho_rid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_apho, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase VSP_FORTINET_STA_LOCATE:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_sta_locate_rid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_sta_locate_enable, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_sta_locate_interval, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nbreak;\r\ncase VSP_FORTINET_SPECTRUM_ANALYSIS:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_sa_rid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\noptlen -= 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_sa_enable, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\noptlen -= 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_sa_ssid, tvb, offset, optlen, ENC_ASCII|ENC_NA);\r\noffset += optlen;\r\nbreak;\r\ncase VSP_FORTINET_DARRP_CFG:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_darrp_cfg_rid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_darrp_cfg_enable, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_darrp_cfg_interval, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase VSP_FORTINET_AP_SUPPRESS_LIST:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_ap_suppress_list_ver, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_ap_suppress_list_op, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_ap_suppress_list_rid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_ap_suppress_list_len, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase VSP_FORTINET_WDS:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_wds_rid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_wds_wid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_wds_enable, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase VSP_FORTINET_VAP_VLAN_TAG:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_vap_vlan_tag_rid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_vap_vlan_tag_wid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_vap_vlan_tag, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nbreak;\r\ncase VSP_FORTINET_VAP_BITMAP:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_vap_bitmap_rid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_vap_bitmap, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nbreak;\r\ncase VSP_FORTINET_MCAST_RATE:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_mcast_rate_rid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_mcast_rate_wid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_mcast_rate, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nbreak;\r\ncase VSP_FORTINET_CFG:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_cfg_rid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_cfg_wid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_cfg_ip, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_cfg_mask, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nbreak;\r\ncase VSP_FORTINET_SPLIT_TUN_CFG:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_split_tun_cfg_enable_local_subnet, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_split_tun_cfg_cnt, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase VSP_FORTINET_MGMT_VLAN_TAG:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_mgmt_vlan_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nbreak;\r\ncase VSP_FORTINET_VAP_PSK_PASSWD:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_vap_psk_passwd_rid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\noptlen -= 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_vap_psk_passwd_wid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\noptlen -= 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_vap_psk_passwd_key, tvb, offset, optlen, ENC_ASCII|ENC_NA);\r\noffset += optlen;\r\nbreak;\r\ncase VSP_FORTINET_MESH_ETH_BRIDGE_ENABLE:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_mesh_eth_bridge_enable, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase VSP_FORTINET_MESH_ETH_BRIDGE_TYPE:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_mesh_eth_bridge_type, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nbreak;\r\ncase VSP_FORTINET_WTP_CAP:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_wtp_cap, tvb, offset, optlen, ENC_NA);\r\noffset += optlen;\r\nbreak;\r\ncase VSP_FORTINET_TXPWR:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_txpwr_rid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_txpwr, tvb, offset, 2, ENC_NA);\r\noffset += 2;\r\nbreak;\r\ncase VSP_FORTINET_WIDS_ENABLE:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_wids_enable_rid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_wids_enable, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nbreak;\r\ncase 146:\r\ncase 152:\r\ncase 153:\r\ncase 163:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_unknown_rid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\noptlen -= 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_unknown_wid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\noptlen -= 1;\r\nexpert_add_info_format(pinfo, msg_element_type_item, &ei_capwap_message_element_fortinet_type,\r\n"Dissector for CAPWAP Vendor Specific (Fortinet) Message Element"\r\n" (%d) type not implemented (VAP Stuff..)", element_id);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_unknown, tvb, offset, optlen, ENC_NA);\r\noffset += optlen;\r\nbreak;\r\ncase 65:\r\ncase 170:\r\ncase 171:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_unknown_rid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\noptlen -= 1;\r\nexpert_add_info_format(pinfo, msg_element_type_item, &ei_capwap_message_element_fortinet_type,\r\n"Dissector for CAPWAP Vendor Specific (Fortinet) Message Element"\r\n" (%d) type not implemented (VAP Stuff..)", element_id);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_unknown, tvb, offset, optlen, ENC_NA);\r\noffset += optlen;\r\nbreak;\r\ndefault:\r\nexpert_add_info_format(pinfo, msg_element_type_item, &ei_capwap_message_element_fortinet_type,\r\n"Dissector for CAPWAP Vendor Specific (Fortinet) Message Element"\r\n" (%d) type not implemented", element_id);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_fortinet_unknown, tvb, offset, optlen, ENC_NA);\r\noffset += optlen;\r\nbreak;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_capwap_message_element_vendor_cisco_type(tvbuff_t *tvb, proto_tree *sub_msg_element_type_tree, guint offset, packet_info *pinfo, guint optlen, proto_item *msg_element_type_item)\r\n{\r\nguint element_id;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_element_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nelement_id = tvb_get_ntohs(tvb, offset);\r\nproto_item_append_text(msg_element_type_item, ": Cisco %s", val_to_str(element_id, cisco_element_id_vals,"Unknown Vendor Specific Element Type (%02d)") );\r\noffset += 2;\r\noptlen -= 6;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_value, tvb, offset, optlen, ENC_NA);\r\nswitch(element_id){\r\ncase VSP_CISCO_MWAR_ADDR:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_mwar_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_mwar_addr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nbreak;\r\ncase VSP_CISCO_RAD_NAME:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_rad_name, tvb, offset, optlen, ENC_ASCII|ENC_NA);\r\noffset += optlen;\r\nbreak;\r\ncase VSP_CISCO_MWAR:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_mwar_type, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_mwar_hardware, tvb, offset, 4, ENC_ASCII|ENC_NA);\r\noffset += 4;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_mwar_software, tvb, offset, 4, ENC_ASCII|ENC_NA);\r\noffset += 4;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_mwar_active_ms, tvb, offset, 2, ENC_NA);\r\noffset += 2;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_mwar_supported_ms, tvb, offset, 2, ENC_NA);\r\noffset += 2;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_mwar_active_rad, tvb, offset, 2, ENC_NA);\r\noffset += 2;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_mwar_supported_rad, tvb, offset, 2, ENC_NA);\r\noffset += 2;\r\nbreak;\r\ncase VSP_CISCO_AP_MODE_AND_TYPE:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_ap_mode_and_type_mode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_ap_mode_and_type_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase VSP_CISCO_AP_STATIC_IP_ADDR:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_ap_static_ip_addr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_ap_static_ip_netmask, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_ap_static_ip_gateway, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_ap_static_ip_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_ap_static_ip_reserved, tvb, offset, 4, ENC_NA);\r\noffset += 4;\r\nbreak;\r\ncase VSP_CISCO_AP_UPTIME:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_ap_uptime_current, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_ap_uptime_last, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nbreak;\r\ncase VSP_CISCO_AP_GROUP_NAME:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_ap_group_name, tvb, offset, optlen, ENC_ASCII|ENC_NA);\r\noffset += optlen;\r\nbreak;\r\ncase VSP_CISCO_SPAM_AP_LED_STATE:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_spam_ap_led_state, tvb, offset, 2, ENC_NA);\r\noffset += 2;\r\nbreak;\r\ncase VSP_CISCO_AP_TIMESYNC:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_ap_timesync, tvb, offset, 4, ENC_NA);\r\noffset += 4;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_ap_timesync_type, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\nbreak;\r\ncase VSP_CISCO_BOARD_DATA_OPTIONS:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_board_data_options_ant_type, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_board_data_options_flex_connect, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_board_data_options_ap_type, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_board_data_options_join_priority, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\nbreak;\r\ncase VSP_CISCO_MWAR_TYPE:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_mwar_type, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\nbreak;\r\ndefault:\r\nexpert_add_info_format(pinfo, msg_element_type_item, &ei_capwap_message_element_cisco_type,\r\n"Dissector for CAPWAP Vendor Specific (Cisco) Message Element"\r\n" (%d) type not implemented", element_id);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_cisco_unknown, tvb, offset, optlen, ENC_NA);\r\noffset += optlen;\r\nbreak;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_capwap_message_element_type(tvbuff_t *tvb, proto_tree *msg_element_type_tree, guint offset, packet_info *pinfo)\r\n{\r\nguint optlen, offset_end, number_encrypt, i, msg_element_type = 0;\r\nproto_item *msg_element_type_item, *msg_element_type_item_flag, *ti_len, *ti_type;\r\nproto_tree *sub_msg_element_type_tree, *sub_msg_element_type_flag_tree;\r\nmsg_element_type = tvb_get_ntohs(tvb, offset);\r\noptlen = tvb_get_ntohs(tvb, offset+2);\r\nmsg_element_type_item = proto_tree_add_item(msg_element_type_tree, hf_capwap_msg_element, tvb, offset, 2+2+optlen, ENC_NA );\r\nproto_item_append_text(msg_element_type_item, ": (t=%d,l=%d) %s", msg_element_type, optlen, val_to_str(msg_element_type,message_element_type_vals,"Unknown Message Element Type (%02d)") );\r\nsub_msg_element_type_tree = proto_item_add_subtree(msg_element_type_item, ett_capwap_message_element_type);\r\nti_type = proto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nti_len = proto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_length, tvb, offset+2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_value, tvb, offset+4, optlen, ENC_NA);\r\nswitch (msg_element_type) {\r\ncase TYPE_AC_DESCRIPTOR:\r\nif (optlen < 12) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"AC Descriptor length %u wrong, must be >= 12", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ac_descriptor_stations, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ac_descriptor_limit, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ac_descriptor_active_wtp, tvb, offset+8, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ac_descriptor_max_wtp, tvb, offset+10, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask_with_flags(sub_msg_element_type_tree, tvb, offset+12,\r\nhf_capwap_msg_element_type_ac_descriptor_security, ett_capwap_ac_descriptor_security_flags, capwap_ac_descriptor_security_flags, ENC_BIG_ENDIAN, BMT_NO_APPEND);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ac_descriptor_rmac_field, tvb, offset+13, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ac_descriptor_reserved, tvb, offset+14, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask_with_flags(sub_msg_element_type_tree, tvb, offset+15,\r\nhf_capwap_msg_element_type_ac_descriptor_dtls_policy, ett_capwap_ac_descriptor_dtls_flags, capwap_ac_descriptor_dtls_flags, ENC_BIG_ENDIAN, BMT_NO_APPEND);\r\noffset_end = offset + optlen -4;\r\noffset += 4 + 12;\r\nwhile (offset < offset_end) {\r\noffset += dissect_capwap_ac_information(tvb, sub_msg_element_type_tree, offset);\r\n}\r\nbreak;\r\ncase TYPE_AC_IPV4_LIST:\r\nif (optlen < 4) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"AC IPv4 List length %u wrong, must be >= 4", optlen);\r\nbreak;\r\n}\r\noffset += 4;\r\nif (optlen%4 == 0)\r\n{\r\nfor (i = 0; i < optlen/4; i++)\r\n{\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ac_ipv4_list, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\n}\r\n}\r\nbreak;\r\ncase TYPE_AC_IPV6_LIST:\r\nif (optlen < 16) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"AC IPv6 List length %u wrong, must be >= 4", optlen);\r\nbreak;\r\n}\r\noffset += 4;\r\nif (optlen%16 == 0)\r\n{\r\nfor (i = 0; i < optlen/16; i++)\r\n{\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ac_ipv6_list, tvb, offset, 16, ENC_NA);\r\noffset += 16;\r\n}\r\n}\r\nbreak;\r\ncase TYPE_AC_NAME:\r\nif (optlen < 1) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"AC Name length %u wrong, must be >= 1", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ac_name, tvb, offset+4, optlen, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase TYPE_AC_NAME_W_PRIORITY:\r\nif (optlen < 2) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"AC Name with Priority length %u wrong, must be >= 2", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ac_name_with_priority, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ac_name, tvb, offset+5, optlen-1, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase TYPE_AC_TIMESTAMP:\r\nif (optlen != 4) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"AC Timestamp length %u wrong, must be = 4", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ac_timestamp, tvb, offset + 4, 4, ENC_TIME_NTP|ENC_BIG_ENDIAN);\r\nbreak;\r\ncase TYPE_ADD_STATION:{\r\nguint8 maclength;\r\nif (optlen < 8) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"Add Station length %u wrong, must be >= 8", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_add_station_radio_id, tvb, offset + 4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_add_station_length, tvb, offset + 5, 1, ENC_BIG_ENDIAN);\r\nmaclength = tvb_get_guint8(tvb, offset+5);\r\nswitch(maclength){\r\ncase 6:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_add_station_mac_eui48, tvb, offset+6, maclength, ENC_NA);\r\nbreak;\r\ncase 8:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_add_station_mac_eui64, tvb, offset+6, maclength, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_add_station_mac_data, tvb, offset+6, maclength, ENC_NA);\r\nbreak;\r\n}\r\nif(optlen -(2 + maclength)) {\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_add_station_vlan_name, tvb, offset+6+maclength, optlen -(2 + maclength), ENC_ASCII|ENC_NA);\r\n}\r\n}\r\nbreak;\r\ncase TYPE_CAPWAP_CONTROL_IPV4_ADDRESS:\r\nif (optlen != 6) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"CAPWAP Control IPv4 Address length %u wrong, must be = 6", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_capwap_control_ipv4, tvb, offset+4, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_capwap_control_wtp_count, tvb, offset+8, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase TYPE_CAPWAP_CONTROL_IPV6_ADDRESS:\r\nif (optlen != 18) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"CAPWAP Control IPv6 Address length %u wrong, must be = 18", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_capwap_control_ipv6, tvb, offset+4, 16, ENC_NA);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_capwap_control_wtp_count, tvb, offset+20, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase TYPE_CAPWAP_TIMERS:\r\nif (optlen != 2) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"CAPWAP Timers length %u wrong, must be = 2", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_capwap_timers_discovery, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_capwap_timers_echo_request, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase TYPE_DECRYPTION_ERROR_REPORT_PERIOD:\r\nif (optlen != 3) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"Decryption Error Report Period length %u wrong, must be = 3", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_decryption_error_report_period_radio_id, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree,hf_capwap_msg_element_type_decryption_error_report_period_interval, tvb, offset+5, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase TYPE_DELETE_STATION:{\r\nguint8 maclength;\r\nif (optlen < 8) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"Delete Station length %u wrong, must be >= 8", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_delete_station_radio_id, tvb, offset + 4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_delete_station_length, tvb, offset + 5, 1, ENC_BIG_ENDIAN);\r\nmaclength = tvb_get_guint8(tvb, offset+5);\r\nswitch(maclength){\r\ncase 6:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_delete_station_mac_eui48, tvb, offset+6, maclength, ENC_NA);\r\nbreak;\r\ncase 8:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_delete_station_mac_eui64, tvb, offset+6, maclength, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_delete_station_mac_data, tvb, offset+6, maclength, ENC_NA);\r\nbreak;\r\n}\r\n}\r\nbreak;\r\ncase TYPE_DISCOVERY_TYPE:\r\nif (optlen != 1) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"Discovery Type length %u wrong, must be = 1", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_discovery_type, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase TYPE_IDLE_TIMEOUT:\r\nif (optlen != 4) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"Idle Timeout length %u wrong, must be = 4", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_idle_timeout, tvb, offset+4, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase TYPE_LOCATION_DATA:\r\nif (optlen < 1) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"Location Data length %u wrong, must be >= 1", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_location_data, tvb, offset+4, optlen, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase TYPE_MAXIMUM_MESSAGE_LENGTH:\r\nif (optlen != 2) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"Maximum Message length %u wrong, must be = 2", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_maximum_message_length, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase TYPE_CAPWAP_LOCAL_IPV4_ADDRESS:\r\nif (optlen != 4) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"CAPWAP Local IPv4 Address length %u wrong, must be = 4", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_capwap_local_ipv4_address, tvb, offset+4, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase TYPE_RADIO_ADMINISTRATIVE_STATE:\r\nif (optlen != 2) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"Radio Administrative State length %u wrong, must be = 2", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_radio_admin_id, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_radio_admin_state, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase TYPE_RADIO_OPERATIONAL_STATE:\r\nif (optlen != 3) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"Radio Operational State length %u wrong, must be = 3", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_radio_op_state_radio_id, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_radio_op_state_radio_state, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_radio_op_state_radio_cause, tvb, offset+6, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase TYPE_RESULT_CODE:\r\nif (optlen != 4) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"Result Code length %u wrong, must be = 4", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_result_code, tvb, offset+4, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase TYPE_SESSION_ID:\r\nif (optlen != 16) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"Session ID length %u wrong, must be = 16", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_session_id, tvb, offset+4, 16, ENC_NA);\r\nbreak;\r\ncase TYPE_STATISTICS_TIMER:\r\nif (optlen != 2) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"Statistics Timer length %u wrong, must be = 2", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_statistics_timer, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase TYPE_VENDOR_SPECIFIC_PAYLOAD:{\r\nguint32 vendor_id;\r\nif (optlen < 7) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"Vendor Specific Payload length %u wrong, must be >= 7", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_vsp_vendor_identifier, tvb, offset+4, 4, ENC_BIG_ENDIAN);\r\nvendor_id = tvb_get_ntohl(tvb, offset+4);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_vsp_vendor_element_id, tvb, offset+8, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_vsp_vendor_data, tvb, offset+10, optlen-6, ENC_NA);\r\nswitch(vendor_id){\r\ncase VENDOR_FORTINET:\r\ndissect_capwap_message_element_vendor_fortinet_type(tvb, sub_msg_element_type_tree, offset+8, pinfo, optlen, msg_element_type_item);\r\nbreak;\r\ncase VENDOR_CISCO_WIFI:\r\ndissect_capwap_message_element_vendor_cisco_type(tvb, sub_msg_element_type_tree, offset+8, pinfo, optlen, msg_element_type_item);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\nbreak;\r\ncase TYPE_WTP_BOARD_DATA:\r\nif (optlen < 14) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"WTP Board Data length %u wrong, must be >= 14", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_wtp_board_data_vendor, tvb, offset+4, 4, ENC_BIG_ENDIAN);\r\noffset += 8;\r\noffset_end = offset + optlen -4;\r\nwhile (offset < offset_end) {\r\noffset += dissect_capwap_board_data(tvb, sub_msg_element_type_tree, offset);\r\n}\r\nbreak;\r\ncase TYPE_WTP_DESCRIPTOR:\r\nif (optlen < 33) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"WTP Descriptor length %u wrong, must be >= 33", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_wtp_descriptor_max_radios, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_wtp_descriptor_radio_in_use, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nif (global_capwap_draft_8_cisco == 0)\r\n{\r\nnumber_encrypt = tvb_get_guint8(tvb,offset+6);\r\nmsg_element_type_item_flag = proto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_wtp_descriptor_number_encrypt, tvb, offset+6, 1, ENC_BIG_ENDIAN);\r\nsub_msg_element_type_flag_tree = proto_item_add_subtree(msg_element_type_item_flag, ett_capwap_encryption_capabilities);\r\nfor (i=0; i < number_encrypt; i++) {\r\ndissect_capwap_encryption_capabilities(tvb, sub_msg_element_type_flag_tree, offset+4+3+i*3);\r\n}\r\noffset_end = offset + optlen -4;\r\noffset += 4 + 3 + number_encrypt * 3;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_wtp_descriptor_encrypt_capabilities, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\noffset_end = offset + optlen -4;\r\noffset += 6 + 2;\r\n}\r\nwhile (offset < offset_end) {\r\noffset += dissect_capwap_wtp_descriptor(tvb, sub_msg_element_type_tree, offset);\r\n}\r\nbreak;\r\ncase TYPE_WTP_FALLBACK:\r\nif (optlen != 1) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"WTP Fallback length %u wrong, must be = 1", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_wtp_fallback, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase TYPE_WTP_FRAME_TUNNEL_MODE:\r\nif (optlen != 1) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"WTP Frame Tunnel Mode length %u wrong, must be = 1", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_bitmask_with_flags(sub_msg_element_type_tree, tvb, offset+4,\r\nhf_capwap_msg_element_type_wtp_frame_tunnel_mode, ett_capwap_wtp_frame_tunnel_mode, capwap_wtp_frame_tunnel_mode_flags, ENC_BIG_ENDIAN, BMT_NO_APPEND);\r\nbreak;\r\ncase TYPE_WTP_MAC_TYPE:\r\nif (optlen != 1) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"WTP MAC Type length %u wrong, must be = 1", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_wtp_mac_type, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase TYPE_WTP_NAME:\r\nif (optlen < 1) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"WTP Name length %u wrong, must be >= 1", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_wtp_name, tvb, offset+4, optlen, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase TYPE_WTP_REBOOT_STATISTICS:\r\nif (optlen != 15) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"WTP Reboot Statistics length %u wrong, must be = 15", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_wtp_reboot_statistics_reboot_count, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_wtp_reboot_statistics_ac_initiated_count, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_wtp_reboot_statistics_link_failure_count, tvb, offset+8, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_wtp_reboot_statistics_sw_failure_count, tvb, offset+10, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_wtp_reboot_statistics_hw_failure_count, tvb, offset+12, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_wtp_reboot_statistics_other_failure_count, tvb, offset+14, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_wtp_reboot_statistics_unknown_failure_count, tvb, offset+16, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_wtp_reboot_statistics_last_failure_type, tvb, offset+18, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase TYPE_CAPWAP_LOCAL_IPV6_ADDRESS:\r\nif (optlen != 16) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"CAPWAP Local IPv6 Address length %u wrong, must be = 16", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_capwap_local_ipv6_address, tvb, offset+4, 16, ENC_NA);\r\nbreak;\r\ncase TYPE_CAPWAP_TRANSPORT_PROTOCOL:\r\nif (optlen != 1) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"CAPWAP Transport Protocol length %u wrong, must be = 1", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_capwap_transport_protocol, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase TYPE_MTU_DISCOVERY_PADDING:\r\nif (optlen < 1) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"MTU Discovery Padding length %u wrong, must be >= 1", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_mtu_discovery_padding, tvb, offset+4, optlen, ENC_NA);\r\nbreak;\r\ncase TYPE_ECN_SUPPORT:\r\nif (optlen != 1) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"ECN Support length %u wrong, must be = 1", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ecn_support, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase IEEE80211_ADD_WLAN:{\r\nguint16 key_length;\r\nif (optlen < 20) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"IEEE80211 Add Wlan length %u wrong, must be >= 20", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_add_wlan_radio_id, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_add_wlan_wlan_id, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask_with_flags(sub_msg_element_type_tree, tvb, offset+6,\r\nhf_capwap_msg_element_type_ieee80211_add_wlan_capability, ett_capwap_ieee80211_add_wlan_capability, ieee80211_add_wlan_capability_flags, ENC_BIG_ENDIAN, BMT_NO_APPEND);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_add_wlan_key_index, tvb, offset+8, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_add_wlan_key_status, tvb, offset+9, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_add_wlan_key_length, tvb, offset+10, 2, ENC_BIG_ENDIAN);\r\nkey_length = tvb_get_ntohs(tvb, offset+10);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_add_wlan_key, tvb, offset+12, key_length, ENC_NA);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_add_wlan_group_tsc, tvb, offset+key_length+12, 6, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_add_wlan_qos, tvb, offset+key_length+18, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_add_wlan_auth_type, tvb, offset+key_length+19, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_add_wlan_mac_mode, tvb, offset+key_length+20, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_add_wlan_tunnel_mode, tvb, offset+key_length+21, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_add_wlan_suppress_ssid, tvb, offset+key_length+22, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_add_wlan_ssid, tvb, offset+key_length+23, optlen-(key_length+23-4), ENC_ASCII|ENC_NA);\r\n}\r\nbreak;\r\ncase IEEE80211_ANTENNA:{\r\nguint8 antenna_count, antenna = 0;\r\nif (optlen < 5) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"IEEE80211 Antenna length %u wrong, must be >= 5", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_antenna_radio_id, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_antenna_diversity, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_antenna_combiner, tvb, offset+6, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_antenna_count, tvb, offset+7, 1, ENC_BIG_ENDIAN);\r\nantenna_count = tvb_get_guint8(tvb, offset+7);\r\nwhile(antenna < antenna_count){\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_antenna_selection, tvb, offset+8+antenna, 1, ENC_BIG_ENDIAN);\r\nantenna += 1;\r\n}\r\n}\r\nbreak;\r\ncase IEEE80211_ASSIGNED_WTP_BSSID:\r\nif (optlen != 8) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"IEEE80211 Assigned WTP BSSID length %u wrong, must be = 8", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_assigned_wtp_bssid_radio_id, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_assigned_wtp_bssid_wlan_id, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_assigned_wtp_bssid_bssid, tvb, offset+6, 6, ENC_NA);\r\nbreak;\r\ncase IEEE80211_DELETE_WLAN:\r\nif (optlen != 2) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"IEEE80211 Delete Wlan length %u wrong, must be = 2", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_delete_wlan_radio_id, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_delete_wlan_wlan_id, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase IEEE80211_DIRECT_SEQUENCE_CONTROL:\r\nif (optlen != 8) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"IEEE80211 Direct Sequence Control length %u wrong, must be = 8", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_direct_sequence_control_radio_id, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_direct_sequence_control_reserved, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_direct_sequence_control_current_channel, tvb, offset+6, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_direct_sequence_control_current_cca, tvb, offset+7, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_direct_sequence_control_energy_detect_threshold, tvb, offset+8, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase IEEE80211_INFORMATION_ELEMENT:\r\nif (optlen < 4) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"IEEE80211 Information Element length %u wrong, must be >= 4", optlen);\r\nbreak;\r\n}\r\noffset += 4;\r\noffset_end = offset + optlen;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_ie_radio_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_ie_wlan_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_bitmask_with_flags(sub_msg_element_type_tree, tvb, offset,\r\nhf_capwap_msg_element_type_ieee80211_ie_flags, ett_capwap_ieee80211_ie_flags, ieee80211_ie_flags, ENC_BIG_ENDIAN, BMT_NO_APPEND);\r\noffset += 1;\r\nwhile (offset < offset_end) {\r\noffset += add_tagged_field(pinfo, sub_msg_element_type_tree, tvb, offset, 0, NULL, 0);\r\n}\r\nbreak;\r\ncase IEEE80211_MAC_OPERATION:\r\nif (optlen != 16) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"IEEE80211 MAC Operation length %u wrong, must be = 16", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_mac_operation_radio_id, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_mac_operation_reserved, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_mac_operation_rts_threshold, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_mac_operation_short_retry, tvb, offset+8, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_mac_operation_long_retry, tvb, offset+9, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_mac_operation_fragmentation_threshold, tvb, offset+10, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_mac_operation_tx_msdu_lifetime, tvb, offset+12, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_mac_operation_rx_msdu_lifetime, tvb, offset+16, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase IEEE80211_MIC_COUNTERMEASURES:\r\nif (optlen != 8) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"IEEE80211 MIC Countermeasures length %u wrong, must be = 8", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_mic_countermeasures_radio_id, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_mic_countermeasures_wlan_id, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_mic_countermeasures_mac_address, tvb, offset+6, 6, ENC_NA);\r\nbreak;\r\ncase IEEE80211_MULTI_DOMAIN_CAPABILITY:\r\nif (optlen != 8) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"IEEE80211 Multi-Domain Capability length %u wrong, must be = 8", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_multi_domain_capability_radio_id, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_multi_domain_capability_reserved, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_multi_domain_capability_first_channel, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_multi_domain_capability_number_of_channels, tvb, offset+8, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_multi_domain_capability_max_tx_power_level, tvb, offset+10, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase IEEE80211_OFDM_CONTROL:\r\nif (optlen != 8) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"IEEE80211 OFDM Control length %u wrong, must be = 8", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_ofdm_control_radio_id, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_ofdm_control_reserved, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_ofdm_control_current_channel, tvb, offset+6, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask_with_flags(sub_msg_element_type_tree, tvb, offset+7, hf_capwap_msg_element_type_ieee80211_ofdm_control_band_support, ett_capwap_ieee80211_ofdm_control_band_support, ieee80211_ofdm_control_band_support_flags, ENC_BIG_ENDIAN, BMT_NO_APPEND);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_ofdm_control_ti_threshold, tvb, offset+8, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase IEEE80211_RATE_SET:\r\nif (optlen < 3) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"IEEE80211 Rate Set length %u wrong, must be >= 3", optlen);\r\nbreak;\r\n}\r\noffset += 4;\r\noffset_end = offset + optlen;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_rate_set_radio_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nwhile (offset < offset_end) {\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_rate_set_rate_set, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\nbreak;\r\ncase IEEE80211_STATION:\r\nif (optlen < 14) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"IEEE80211 Station length %u wrong, must be >= 14", optlen);\r\nbreak;\r\n}\r\noffset_end = offset + 4 + optlen;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_station_radio_id, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_station_association_id, tvb, offset+5, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_station_flags, tvb, offset+7, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_station_mac_address, tvb, offset+8, 6, ENC_NA);\r\nproto_tree_add_bitmask_with_flags(sub_msg_element_type_tree, tvb, offset+14,\r\nhf_capwap_msg_element_type_ieee80211_station_capabilities, ett_capwap_ieee80211_station_capabilities, ieee80211_station_capabilities_flags, ENC_BIG_ENDIAN, BMT_NO_APPEND);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_station_wlan_id, tvb, offset+16, 1, ENC_BIG_ENDIAN);\r\noffset += 17;\r\nwhile (offset < offset_end) {\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_station_supported_rates, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\nbreak;\r\ncase IEEE80211_STATION_SESSION_KEY:\r\nif (optlen < 25) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"IEEE80211 Station Session Key length %u wrong, must be >= 25", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_station_session_key_mac, tvb, offset+4, 6, ENC_NA);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_station_session_key_flags, tvb, offset+10, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_station_session_key_flags_a, tvb, offset+10, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_station_session_key_flags_c, tvb, offset+10, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_station_session_key_pairwire_tsc, tvb, offset+12, 6, ENC_NA);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_station_session_key_pairwire_rsc, tvb, offset+18, 6, ENC_NA);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_station_session_key_key, tvb, offset+24, optlen-24, ENC_NA);\r\nbreak;\r\ncase IEEE80211_SUPPORTED_RATES:\r\nif (optlen < 3) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"IEEE80211 Supported Rates length %u wrong, must be >= 3", optlen);\r\nbreak;\r\n}\r\noffset += 4;\r\noffset_end = offset + optlen;\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_supported_rates_radio_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nwhile (offset < offset_end) {\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_supported_rates_rate, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\nbreak;\r\ncase IEEE80211_TX_POWER:\r\nif (optlen != 4) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"IEEE80211 Tx Power length %u wrong, must be = 4", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_tx_power_radio_id, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_tx_power_reserved, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_tx_power_current_tx_power, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase IEEE80211_TX_POWER_LEVEL:{\r\nguint8 num_levels, level = 0;\r\nif (optlen < 3) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"IEEE80211 Antenna length %u wrong, must be >= 3", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_tx_power_level_radio_id, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_tx_power_level_num_levels, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nnum_levels = tvb_get_guint8(tvb, offset+5);\r\nwhile(level < num_levels){\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_tx_power_level_power_level, tvb, offset+6+(level*2), 2, ENC_BIG_ENDIAN);\r\nlevel += 1;\r\n}\r\n}\r\nbreak;\r\ncase IEEE80211_UPDATE_WLAN:{\r\nguint16 key_length;\r\nif (optlen < 8) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"IEEE80211 Update Wlan length %u wrong, must be >= 8", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_update_wlan_radio_id, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_update_wlan_wlan_id, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask_with_flags(sub_msg_element_type_tree, tvb, offset+6,\r\nhf_capwap_msg_element_type_ieee80211_update_wlan_capability, ett_capwap_ieee80211_update_wlan_capability, ieee80211_update_wlan_capability_flags, ENC_BIG_ENDIAN, BMT_NO_APPEND);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_update_wlan_key_index, tvb, offset+8, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_update_wlan_key_status, tvb, offset+9, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_update_wlan_key_length, tvb, offset+10, 2, ENC_BIG_ENDIAN);\r\nkey_length = tvb_get_ntohs(tvb, offset+10);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_update_wlan_key, tvb, offset+12, key_length, ENC_NA);\r\n}\r\nbreak;\r\ncase IEEE80211_WTP_RADIO_CONFIGURATION:\r\nif (optlen != 16) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"IEEE80211 WTP Radio Configuration length %u wrong, must be = 16", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_wtp_radio_cfg_radio_id, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_wtp_radio_cfg_short_preamble, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_wtp_radio_cfg_num_of_bssids, tvb, offset+6, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_wtp_radio_cfg_dtim_period, tvb, offset+7, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_wtp_radio_cfg_bssid, tvb, offset+8, 6, ENC_NA);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_wtp_radio_cfg_beacon_period, tvb, offset+14, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_wtp_radio_cfg_country_string, tvb, offset+16, 4, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase IEEE80211_WTP_RADIO_INFORMATION:\r\nif (optlen != 5) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"IEEE80211 WTP Radio Information length %u wrong, must be = 5", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_wtp_radio_info_radio_id, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_wtp_radio_info_radio_type_reserved, tvb, offset+5, 3, ENC_NA);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_wtp_radio_info_radio_type_n, tvb, offset+8, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_wtp_radio_info_radio_type_g, tvb, offset+8, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_wtp_radio_info_radio_type_a, tvb, offset+8, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_wtp_radio_info_radio_type_b, tvb, offset+8, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase IEEE80211_SUPPORTED_MAC_PROFILES:{\r\nguint8 num_profiles;\r\nif (optlen < 2) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"IEEE80211 Supported MAC Profiles length %u wrong, must be >= 2", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_supported_mac_profiles_numbers, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nnum_profiles = tvb_get_guint8(tvb ,offset);\r\nwhile(num_profiles){\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_supported_mac_profiles_profile, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nnum_profiles--;\r\n}\r\n}\r\nbreak;\r\ncase IEEE80211_MAC_PROFILE:\r\nif (optlen != 1) {\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_msg_element_length,\r\n"IEEE80211 MAC Profile length %u wrong, must be = 1", optlen);\r\nbreak;\r\n}\r\nproto_tree_add_item(sub_msg_element_type_tree, hf_capwap_msg_element_type_ieee80211_mac_profile, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nexpert_add_info_format(pinfo, ti_type, &ei_capwap_message_element_type,\r\n"Dissector for CAPWAP Message Element"\r\n" (%s) type not implemented, Contact"\r\n" Wireshark developers if you want this supported",\r\nval_to_str(msg_element_type, message_element_type_vals, "(%d)"));\r\nbreak;\r\n}\r\nreturn 2+2+optlen;\r\n}\r\nstatic int\r\ndissect_capwap_message_element(tvbuff_t *tvb, proto_tree *capwap_control_tree, guint offset, packet_info *pinfo)\r\n{\r\nguint plen = 0, offset_end;\r\nproto_item *ti;\r\nproto_tree *capwap_message_element_tree;\r\nti = proto_tree_add_item(capwap_control_tree, hf_capwap_message_element, tvb, offset, tvb_reported_length(tvb) - offset, ENC_NA);\r\ncapwap_message_element_tree = proto_item_add_subtree(ti, ett_capwap_message_element);\r\noffset_end = tvb_reported_length(tvb);\r\nwhile (offset+plen < offset_end) {\r\nplen += dissect_capwap_message_element_type(tvb, capwap_message_element_tree, offset+plen, pinfo);\r\n}\r\nreturn plen;\r\n}\r\nstatic int\r\ndissect_capwap_data_keep_alive(tvbuff_t *tvb, packet_info *pinfo, proto_tree *capwap_data_tree, guint offset)\r\n{\r\nguint16 len;\r\nguint plen = 0, offset_end;\r\nproto_item *ti;\r\nproto_tree *capwap_data_keep_alive_tree;\r\nti = proto_tree_add_item(capwap_data_tree, hf_capwap_data_keep_alive, tvb, offset, tvb_reported_length(tvb), ENC_NA);\r\ncapwap_data_keep_alive_tree = proto_item_add_subtree(ti, ett_capwap_data_keep_alive);\r\nti = proto_tree_add_item(capwap_data_keep_alive_tree, hf_capwap_data_keep_alive_length, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nlen = tvb_get_ntohs(tvb, offset);\r\nif (len != tvb_reported_length(tvb))\r\nexpert_add_info(pinfo, ti, &ei_capwap_data_keep_alive_length);\r\nplen += 2;\r\noffset_end = tvb_reported_length(tvb);\r\nwhile (offset+plen < offset_end) {\r\nplen += dissect_capwap_message_element_type(tvb, capwap_data_keep_alive_tree, offset+plen, pinfo);\r\n}\r\nreturn plen;\r\n}\r\nstatic int\r\ndissect_capwap_control_header(tvbuff_t *tvb, proto_tree *capwap_control_tree, guint offset, packet_info *pinfo)\r\n{\r\nguint plen = 0;\r\nproto_item *ti, *ti_flag;\r\nproto_tree *capwap_control_header_tree;\r\nproto_tree *capwap_control_msg_type_tree;\r\nti = proto_tree_add_item(capwap_control_tree, hf_capwap_control_header, tvb, offset, 8, ENC_NA);\r\ncapwap_control_header_tree = proto_item_add_subtree(ti, ett_capwap_control_header);\r\nti_flag = proto_tree_add_item(capwap_control_header_tree, hf_capwap_control_header_msg_type, tvb, offset, 4, ENC_BIG_ENDIAN);\r\ncapwap_control_msg_type_tree = proto_item_add_subtree(ti_flag, ett_capwap_control_header_msg);\r\nproto_tree_add_item(capwap_control_msg_type_tree, hf_capwap_control_header_msg_type_enterprise_nbr, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(capwap_control_msg_type_tree, hf_capwap_control_header_msg_type_enterprise_specific, tvb, offset, 4, ENC_BIG_ENDIAN);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " - %s",val_to_str(tvb_get_ntohl(tvb, offset),message_type,"Unknown Message Type (0x%x)"));\r\nplen += 4;\r\nproto_tree_add_item(capwap_control_header_tree, hf_capwap_control_header_seq_number, tvb, offset+plen, 1, ENC_BIG_ENDIAN);\r\nplen += 1;\r\nproto_tree_add_item(capwap_control_header_tree, hf_capwap_control_header_msg_element_length, tvb, offset+plen, 2, ENC_BIG_ENDIAN);\r\nplen += 2;\r\nproto_tree_add_item(capwap_control_header_tree, hf_capwap_control_header_flags, tvb, offset+plen, 1, ENC_BIG_ENDIAN);\r\nplen += 1;\r\nreturn plen;\r\n}\r\nstatic int\r\ndissect_capwap_header(tvbuff_t *tvb, proto_tree *capwap_control_tree, guint offset, packet_info *pinfo, guint8 *payload_type, guint8 *payload_wbid, gboolean *fragment_is, gboolean *fragment_more, guint32 *fragment_id, guint32 *fragment_offset)\r\n{\r\nguint plen = 0, hlen = 0;\r\nproto_item *ti, *ti_flag, *ti_len;\r\nproto_tree *capwap_header_tree;\r\nproto_tree *capwap_header_flags_tree;\r\nguint flags = 0;\r\nguint8 maclength, wirelesslength;\r\nguint align = 0;\r\nhlen = tvb_get_bits8(tvb, (offset+plen)*8, 5)*4-1;\r\nti = proto_tree_add_item(capwap_control_tree, hf_capwap_header, tvb, offset+plen, hlen, ENC_NA);\r\ncapwap_header_tree = proto_item_add_subtree(ti, ett_capwap_header);\r\nti_len = proto_tree_add_item(capwap_header_tree, hf_capwap_header_hlen, tvb, offset+plen, 3, ENC_BIG_ENDIAN);\r\nproto_item_append_text(ti_len, " (%d)",hlen+1);\r\nproto_tree_add_item(capwap_header_tree, hf_capwap_header_rid, tvb, offset+plen, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(capwap_header_tree, hf_capwap_header_wbid, tvb, offset+plen, 3, ENC_BIG_ENDIAN);\r\n*payload_wbid = tvb_get_bits8(tvb, (offset+plen)*8+10, 5);\r\nflags = tvb_get_bits16(tvb, (offset+plen)*8+15, 9, ENC_BIG_ENDIAN);\r\nti_flag = proto_tree_add_item(capwap_header_tree, hf_capwap_header_flags, tvb, offset+plen, 3, ENC_BIG_ENDIAN);\r\ncapwap_header_flags_tree = proto_item_add_subtree(ti_flag, ett_capwap_header_flags);\r\nproto_tree_add_item(capwap_header_flags_tree, hf_capwap_header_flags_t, tvb, offset+plen, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(capwap_header_flags_tree, hf_capwap_header_flags_f, tvb, offset+plen, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(capwap_header_flags_tree, hf_capwap_header_flags_l, tvb, offset+plen, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(capwap_header_flags_tree, hf_capwap_header_flags_w, tvb, offset+plen, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(capwap_header_flags_tree, hf_capwap_header_flags_m, tvb, offset+plen, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(capwap_header_flags_tree, hf_capwap_header_flags_k, tvb, offset+plen, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(capwap_header_flags_tree, hf_capwap_header_flags_r, tvb, offset+plen, 3, ENC_BIG_ENDIAN);\r\n*fragment_is = ((flags & 0x80) == 0x80) ? TRUE : FALSE;\r\n*fragment_more = ((flags &0x40) == 0x40) ? FALSE : TRUE;\r\nif (flags &0x08 ) {\r\ncol_append_str(pinfo->cinfo, COL_INFO, " Keep-Alive");\r\n*payload_type = 0xff;\r\n} else\r\n*payload_type = tvb_get_bits8(tvb, (offset+plen)*8+15,1);\r\nplen += 3;\r\nproto_tree_add_item(capwap_header_tree, hf_capwap_header_fragment_id, tvb, offset+plen, 2, ENC_BIG_ENDIAN);\r\n*fragment_id = (guint32)tvb_get_ntohs(tvb, offset+plen);\r\nplen += 2;\r\nproto_tree_add_item(capwap_header_tree, hf_capwap_header_fragment_offset, tvb, offset+plen, 2, ENC_BIG_ENDIAN);\r\n*fragment_offset = 8 * (guint32)tvb_get_bits16(tvb, (offset+plen)*8, 13, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(capwap_header_tree, hf_capwap_header_reserved, tvb, offset+plen+1, 1, ENC_BIG_ENDIAN);\r\nplen += 2;\r\nif (flags & 0x10 ) {\r\nmaclength=tvb_get_guint8(tvb, offset+plen);\r\nproto_tree_add_item(capwap_header_tree, hf_capwap_header_mac_length, tvb, offset+plen, 1, ENC_BIG_ENDIAN);\r\nplen += 1;\r\nif (maclength == 6) {\r\nproto_tree_add_item(capwap_header_tree, hf_capwap_header_mac_eui48, tvb, offset+plen, maclength, ENC_NA);\r\n} else if (maclength == 8) {\r\nproto_tree_add_item(capwap_header_tree, hf_capwap_header_mac_eui64, tvb, offset+plen, maclength, ENC_BIG_ENDIAN);\r\n} else {\r\nproto_tree_add_item(capwap_header_tree, hf_capwap_header_mac_data, tvb, offset+plen, maclength, ENC_NA);\r\n}\r\nplen += maclength;\r\nalign = 4-((offset+plen)%4);\r\nif (align != 4)\r\n{\r\nproto_tree_add_item(capwap_header_tree, hf_capwap_header_padding, tvb, offset+plen, align, ENC_NA);\r\nplen += align;\r\n}\r\n}\r\nif (flags & 0x20 ) {\r\nwirelesslength=tvb_get_guint8(tvb, offset+plen);\r\nif (global_capwap_draft_8_cisco == 1)\r\n{\r\nplen += 1;\r\nwirelesslength = 4;\r\n}\r\nproto_tree_add_item(capwap_header_tree, hf_capwap_header_wireless_length, tvb, offset+plen, 1, ENC_BIG_ENDIAN);\r\nplen += 1;\r\nproto_tree_add_item(capwap_header_tree, hf_capwap_header_wireless_data, tvb, offset+plen, wirelesslength, ENC_NA);\r\nif (*payload_wbid == 1)\r\n{\r\ndissect_capwap_data_message_bindings_ieee80211(tvb, capwap_header_tree, offset+plen, pinfo);\r\n}\r\nplen += wirelesslength;\r\nalign = 4-((offset+plen)%4);\r\nif (align != 4)\r\n{\r\nproto_tree_add_item(capwap_header_tree, hf_capwap_header_padding, tvb, offset+plen, align, ENC_NA);\r\nplen += align;\r\n}\r\n}\r\nif ((plen != hlen) && global_capwap_draft_8_cisco == 0)\r\n{\r\nexpert_add_info_format(pinfo, ti_len, &ei_capwap_header_length_bad, "Wrong calculate length (%d) =! header length (%d) ! (May be try to use Cisco Wireless Controller Support Preference ?)", plen, hlen);\r\n}\r\nreturn hlen;\r\n}\r\nstatic int\r\ndissect_capwap_preamble(tvbuff_t *tvb, proto_tree *capwap_control_tree, guint offset, guint8 *type_header)\r\n{\r\nguint plen = 0;\r\nproto_item *ti;\r\nproto_tree *capwap_preamble_tree;\r\nti = proto_tree_add_item(capwap_control_tree, hf_capwap_preamble, tvb, offset+plen, -1, ENC_NA);\r\ncapwap_preamble_tree = proto_item_add_subtree(ti, ett_capwap_preamble);\r\nproto_tree_add_item(capwap_preamble_tree, hf_capwap_preamble_version, tvb, offset+plen, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(capwap_preamble_tree, hf_capwap_preamble_type, tvb, offset+plen, 1, ENC_BIG_ENDIAN);\r\n*type_header = tvb_get_guint8(tvb, offset+plen) & 0x0F;\r\nplen++;\r\nif (*type_header == 1) {\r\nproto_tree_add_item(capwap_preamble_tree, hf_capwap_preamble_reserved, tvb, offset+plen, 3, ENC_BIG_ENDIAN);\r\nplen +=3;\r\n}\r\nproto_item_set_len(ti, plen);\r\nreturn plen;\r\n}\r\nstatic int\r\ndissect_capwap_control(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data _U_)\r\n{\r\nproto_item *ti;\r\nproto_tree *capwap_control_tree;\r\nguint offset = 0;\r\ntvbuff_t *next_tvb = NULL;\r\nguint8 type_header;\r\nguint8 payload_type;\r\nguint8 payload_wbid;\r\ngboolean fragment_is;\r\ngboolean fragment_more;\r\nguint32 fragment_id;\r\nguint32 fragment_offset;\r\nfragment_head *frag_msg = NULL;\r\ngboolean save_fragmented;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "CAPWAP-Control");\r\ncol_set_str(pinfo->cinfo, COL_INFO, "CAPWAP-Control");\r\nti = proto_tree_add_item(tree, proto_capwap_control, tvb, 0, -1, ENC_NA);\r\ncapwap_control_tree = proto_item_add_subtree(ti, ett_capwap_control);\r\noffset += dissect_capwap_preamble(tvb, capwap_control_tree, offset, &type_header);\r\nif (type_header == 1) {\r\nnext_tvb = tvb_new_subset_remaining (tvb, offset);\r\ncall_dissector(dtls_handle, next_tvb, pinfo, tree);\r\nreturn offset;\r\n}\r\noffset += dissect_capwap_header(tvb, capwap_control_tree, offset, pinfo, &payload_type, &payload_wbid, &fragment_is, &fragment_more, &fragment_id, &fragment_offset );\r\nsave_fragmented = pinfo->fragmented;\r\nif (global_capwap_reassemble && fragment_is)\r\n{\r\nconst int len_rem = tvb_reported_length_remaining(tvb, offset);\r\nif (len_rem <= 0)\r\nreturn offset;\r\npinfo->fragmented = TRUE;\r\nfrag_msg = fragment_add_check(&capwap_reassembly_table,\r\ntvb, offset, pinfo, fragment_id, NULL,\r\nfragment_offset,\r\nlen_rem,\r\nfragment_more);\r\nnext_tvb = process_reassembled_data(tvb, offset, pinfo,\r\n"Reassembled CAPWAP", frag_msg,\r\n&capwap_frag_items, NULL, tree);\r\nif (next_tvb == NULL)\r\n{\r\nnext_tvb = tvb_new_subset_remaining(tvb, offset);\r\ncall_data_dissector(next_tvb, pinfo, tree);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " (Fragment ID: %u, Fragment Offset: %u)", fragment_id, fragment_offset);\r\n}\r\nelse\r\n{\r\noffset = dissect_capwap_control_header(next_tvb, capwap_control_tree, 0, pinfo);\r\noffset += dissect_capwap_message_element(next_tvb, capwap_control_tree, offset, pinfo);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " (Reassembled, Fragment ID: %u)", fragment_id);\r\n}\r\n}\r\nelse\r\n{\r\noffset += dissect_capwap_control_header(tvb, capwap_control_tree, offset, pinfo);\r\noffset += dissect_capwap_message_element(tvb, capwap_control_tree, offset, pinfo);\r\n}\r\npinfo->fragmented = save_fragmented;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_capwap_data(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nproto_item *ti;\r\nproto_tree *capwap_data_tree;\r\nguint offset = 0;\r\ntvbuff_t *next_tvb;\r\nguint8 type_header;\r\nguint8 payload_type;\r\nguint8 payload_wbid;\r\ngboolean fragment_is;\r\ngboolean fragment_more;\r\nguint32 fragment_id;\r\nguint32 fragment_offset;\r\nfragment_head *frag_msg = NULL;\r\ngboolean save_fragmented;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "CAPWAP-Data");\r\ncol_set_str(pinfo->cinfo, COL_INFO, "CAPWAP-Data");\r\nti = proto_tree_add_item(tree, proto_capwap_data, tvb, 0, -1, ENC_NA);\r\ncapwap_data_tree = proto_item_add_subtree(ti, ett_capwap_data);\r\noffset += dissect_capwap_preamble(tvb, capwap_data_tree, offset, &type_header);\r\nif (type_header == 1) {\r\nnext_tvb = tvb_new_subset_remaining (tvb, offset);\r\ncall_dissector(dtls_handle, next_tvb, pinfo, tree);\r\nreturn tvb_captured_length(tvb);\r\n}\r\noffset += dissect_capwap_header(tvb, capwap_data_tree, offset, pinfo, &payload_type, &payload_wbid, &fragment_is, &fragment_more, &fragment_id, &fragment_offset);\r\nsave_fragmented = pinfo->fragmented;\r\nif (global_capwap_reassemble && fragment_is)\r\n{\r\ngint len_rem = tvb_reported_length_remaining(tvb, offset);\r\nif (len_rem <= 0)\r\nreturn offset;\r\npinfo->fragmented = TRUE;\r\nfrag_msg = fragment_add_check(&capwap_reassembly_table,\r\ntvb, offset, pinfo, fragment_id, NULL,\r\nfragment_offset,\r\nlen_rem,\r\nfragment_more);\r\nnext_tvb = process_reassembled_data(tvb, offset, pinfo,\r\n"Reassembled CAPWAP", frag_msg,\r\n&capwap_frag_items, NULL, tree);\r\nif (next_tvb == NULL)\r\n{\r\nnext_tvb = tvb_new_subset_remaining(tvb, offset);\r\ncall_data_dissector(next_tvb, pinfo, tree);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " (Fragment ID: %u, Fragment Offset: %u)", fragment_id, fragment_offset);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nelse\r\n{\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " (Reassembled, Fragment ID: %u)", fragment_id);\r\n}\r\n}\r\nelse\r\n{\r\nnext_tvb = tvb_new_subset_remaining (tvb, offset);\r\n}\r\nif (payload_type == 0) {\r\ncall_dissector(ieee8023_handle, next_tvb, pinfo, tree);\r\n}\r\nelse if (payload_type == 0xff) {\r\ndissect_capwap_data_keep_alive(next_tvb, pinfo, capwap_data_tree, 0);\r\n}\r\nelse\r\n{\r\nswitch (payload_wbid) {\r\ncase 0:\r\ncall_data_dissector(next_tvb, pinfo, tree);\r\nbreak;\r\ncase 1:\r\ncall_dissector(global_capwap_swap_frame_control ? ieee80211_bsfc_handle : ieee80211_handle, next_tvb, pinfo, tree);\r\nbreak;\r\ndefault:\r\ncall_data_dissector(next_tvb, pinfo, tree);\r\nbreak;\r\n}\r\n}\r\npinfo->fragmented = save_fragmented;\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_capwap_control(void)\r\n{\r\nmodule_t *capwap_module;\r\nstatic hf_register_info hf[] = {\r\n{ &hf_capwap_preamble,\r\n{ "Preamble", "capwap.preamble",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_preamble_version,\r\n{ "Version", "capwap.preamble.version",\r\nFT_UINT8, BASE_DEC, NULL, 0xF0,\r\n"Version of CAPWAP", HFILL }\r\n},\r\n{ &hf_capwap_preamble_type,\r\n{ "Type", "capwap.preamble.type",\r\nFT_UINT8, BASE_DEC, VALS(type_header_vals), 0x0F,\r\n"Type of Payload", HFILL }\r\n},\r\n{ &hf_capwap_preamble_reserved,\r\n{ "Reserved", "capwap.preamble.reserved",\r\nFT_UINT24, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_header,\r\n{ "Header", "capwap.header",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_header_hlen,\r\n{ "Header Length", "capwap.header.length",\r\nFT_UINT24, BASE_DEC, NULL, 0xF80000,\r\n"Length of the CAPWAP transport header in 4-byte words (similar to IP header length)", HFILL }\r\n},\r\n{ &hf_capwap_header_rid,\r\n{ "Radio ID", "capwap.header.rid",\r\nFT_UINT24, BASE_DEC, NULL, 0x07C000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_header_wbid,\r\n{ "Wireless Binding ID", "capwap.header.wbid",\r\nFT_UINT24, BASE_DEC, VALS(type_wbid), 0x003E00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_header_flags,\r\n{ "Header Flags", "capwap.header.flags",\r\nFT_UINT24, BASE_HEX, NULL, 0x0001FF,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_header_flags_t,\r\n{ "Payload Type", "capwap.header.flags.t",\r\nFT_BOOLEAN, 24, TFS(&flag_type_t), 0x0000100,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_header_flags_f,\r\n{ "Fragment", "capwap.header.flags.f",\r\nFT_BOOLEAN, 24, TFS(&flag_type_f), 0x000080,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_header_flags_l,\r\n{ "Last Fragment", "capwap.header.flags.l",\r\nFT_BOOLEAN, 24, TFS(&flag_type_l), 0x000040,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_header_flags_w,\r\n{ "Wireless header", "capwap.header.flags.w",\r\nFT_BOOLEAN, 24, TFS(&flag_type_w), 0x000020,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_header_flags_m,\r\n{ "Radio MAC header", "capwap.header.flags.m",\r\nFT_BOOLEAN, 24, TFS(&flag_type_m), 0x000010,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_header_flags_k,\r\n{ "Keep-Alive", "capwap.header.flags.k",\r\nFT_BOOLEAN, 24, TFS(&flag_type_k), 0x000008,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_header_flags_r,\r\n{ "Reserved", "capwap.header.flags.r",\r\nFT_UINT24, BASE_HEX, 0x0, 0x000007,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_header_fragment_id,\r\n{ "Fragment ID", "capwap.header.fragment.id",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_header_fragment_offset,\r\n{ "Fragment Offset", "capwap.header.fragment.offset",\r\nFT_UINT16, BASE_DEC, NULL, 0xFFF8,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_header_reserved,\r\n{ "Reserved", "capwap.header.fragment.reserved",\r\nFT_UINT16, BASE_DEC, NULL, 0x0007,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_header_mac_length,\r\n{ "MAC length", "capwap.header.mac.length",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_header_mac_eui48,\r\n{ "MAC address", "capwap.header.mac.eui48",\r\nFT_ETHER, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_header_mac_eui64,\r\n{ "MAC address", "capwap.header.mac.eui64",\r\nFT_EUI64, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_header_mac_data,\r\n{ "MAC address", "capwap.header.mac.data",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_header_wireless_length,\r\n{ "Wireless length", "capwap.header.wireless.length",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_header_wireless_data,\r\n{ "Wireless data", "capwap.header.wireless.data",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_header_wireless_data_ieee80211_fi,\r\n{ "Wireless data ieee80211 Frame Info", "capwap.header.wireless.data.ieee80211.fi",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_header_wireless_data_ieee80211_fi_rssi,\r\n{ "Wireless data ieee80211 RSSI (dBm)", "capwap.header.wireless.data.ieee80211.fi.rssi",\r\nFT_INT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_header_wireless_data_ieee80211_fi_snr,\r\n{ "Wireless data ieee80211 SNR (dB)", "capwap.header.wireless.data.ieee80211.fi.snr",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_header_wireless_data_ieee80211_fi_data_rate,\r\n{ "Wireless data ieee80211 Data Rate (Mbps)", "capwap.header.wireless.data.ieee80211.fi.data_rate",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_header_wireless_data_ieee80211_dest_wlan,\r\n{ "Wireless data ieee80211 Destination WLANs", "capwap.header.wireless.data.ieee80211.dw",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_header_wireless_data_ieee80211_dw_wlan_id_bitmap,\r\n{ "Wireless data ieee80211 Destination Wlan Id bitmap",\r\n"capwap.header.wireless.data.ieee80211.dw.wlan_id_bitmap",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_header_wireless_data_ieee80211_dw_reserved,\r\n{ "Wireless data ieee80211 Destination Wlan reserved", "capwap.header.wireless.data.ieee80211.dw.reserved",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_header_padding,\r\n{ "Padding for 4 Byte Alignement", "capwap.header.padding",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_control_header,\r\n{ "Control Header", "capwap.control.header",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_control_header_msg_type,\r\n{ "Message Type", "capwap.control.header.message_type",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_control_header_msg_type_enterprise_nbr,\r\n{ "Message Type (Enterprise Number)", "capwap.control.header.message_type.enterprise_number",\r\nFT_UINT32, BASE_DEC|BASE_EXT_STRING, &sminmpec_values_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_control_header_msg_type_enterprise_specific,\r\n{ "Message Type (Enterprise Specific)", "capwap.control.header.message_type.enterprise_specific",\r\nFT_UINT32, BASE_DEC, VALS(message_type), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_control_header_seq_number,\r\n{ "Sequence Number", "capwap.control.header.sequence_number",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_control_header_msg_element_length,\r\n{ "Message Element Length", "capwap.control.header.message_element_length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_control_header_flags,\r\n{ "Flags", "capwap.control.header.flags",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_message_element,\r\n{ "Message Element", "capwap.message_element",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element,\r\n{ "Type", "capwap.message_element",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type,\r\n{ "Type", "capwap.message_element.type",\r\nFT_UINT16, BASE_DEC, VALS(message_element_type_vals), 0x0,\r\n"CAPWAP Message Element type", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_length,\r\n{ "Length", "capwap.message_element.length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"CAPWAP Message Element length", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_value,\r\n{ "Value", "capwap.message_element.value",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"CAPWAP Message Element value", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ac_descriptor_stations,\r\n{ "Stations", "capwap.control.message_element.ac_descriptor.stations",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ac_descriptor_limit,\r\n{ "Limit Stations", "capwap.control.message_element.ac_descriptor.limit",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ac_descriptor_active_wtp,\r\n{ "Active WTPs", "capwap.control.message_element.ac_descriptor.active_wtp",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ac_descriptor_max_wtp,\r\n{ "Max WTPs", "capwap.control.message_element.ac_descriptor.max_wtp",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ac_descriptor_security,\r\n{ "Security Flags", "capwap.control.message_element.ac_descriptor.security",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ac_descriptor_security_s,\r\n{ "AC supports the pre-shared", "capwap.control.message_element.ac_descriptor.security.s",\r\nFT_BOOLEAN, 8, TFS(&tfs_true_false), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ac_descriptor_security_x,\r\n{ "AC supports X.509 Certificate", "capwap.control.message_element.ac_descriptor.security.x",\r\nFT_BOOLEAN, 8, TFS(&tfs_true_false), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ac_descriptor_security_r,\r\n{ "Reserved", "capwap.control.message_element.ac_descriptor.security.r",\r\nFT_BOOLEAN, 8, TFS(&tfs_set_notset), 0xF9,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ac_descriptor_rmac_field,\r\n{ "R-MAC Field", "capwap.control.message_element.ac_descriptor.rmac_field",\r\nFT_UINT8, BASE_DEC, VALS(rmac_field_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ac_descriptor_reserved,\r\n{ "Reserved", "capwap.control.message_element.ac_descriptor.reserved",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ac_descriptor_dtls_policy,\r\n{ "DTLS Policy Flags", "capwap.control.message_element.ac_descriptor.dtls_policy",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ac_descriptor_dtls_policy_d,\r\n{ "DTLS-Enabled Data Channel Supported", "capwap.control.message_element.ac_descriptor.dtls_policy.d",\r\nFT_BOOLEAN, 8, TFS(&tfs_true_false), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ac_descriptor_dtls_policy_c,\r\n{ "Clear Text Data Channel Supported", "capwap.control.message_element.ac_descriptor.dtls_policy.c",\r\nFT_BOOLEAN, 8, TFS(&tfs_true_false), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ac_descriptor_dtls_policy_r,\r\n{ "Reserved", "capwap.control.message_element.ac_descriptor.dtls_policy.r",\r\nFT_UINT8, BASE_HEX, 0x0, 0xF9,\r\n"Must be zero", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ac_information,\r\n{ "AC Information", "capwap.control.message_element.ac_information",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ac_information_vendor,\r\n{ "AC Information Vendor", "capwap.control.message_element.ac_information.vendor",\r\nFT_UINT32, BASE_DEC|BASE_EXT_STRING, &sminmpec_values_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ac_information_type,\r\n{ "AC Information Type", "capwap.control.message_element.ac_information.type",\r\nFT_UINT16, BASE_DEC, VALS(ac_information_type_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ac_information_length,\r\n{ "AC Information Length", "capwap.control.message_element.ac_information.length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ac_information_value,\r\n{ "AC Information Value", "capwap.control.message_element.ac_information.value",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ac_information_hardware_version,\r\n{ "AC Hardware Version", "capwap.control.message_element.ac_information.hardware_version",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ac_information_software_version,\r\n{ "AC Software Version", "capwap.control.message_element.ac_information.software_version",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ac_ipv4_list,\r\n{ "AC IPv4 List", "capwap.control.message_element.message_element.ac_ipv4_list",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ac_ipv6_list,\r\n{ "AC IPv6 List", "capwap.control.message_element.message_element.ac_ipv6_list",\r\nFT_IPv6, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_capwap_control_ipv4,\r\n{ "CAPWAP Control IP Address", "capwap.control.message_element.message_element.capwap_control_ipv4",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_capwap_control_ipv6,\r\n{ "CAPWAP Control IP Address", "capwap.control.message_element.message_element.capwap_control_ipv6",\r\nFT_IPv6, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_capwap_control_wtp_count,\r\n{ "CAPWAP Control WTP Count", "capwap.control.message_element.capwap_control_wtp_count",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_capwap_timers_discovery,\r\n{ "CAPWAP Timers Discovery (Sec)", "capwap.control.message_element.capwap_timers_discovery",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_capwap_timers_echo_request,\r\n{ "CAPWAP Timers Echo Request (Sec)", "capwap.control.message_element.capwap_timers_echo_request",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_decryption_error_report_period_radio_id,\r\n{ "Decryption Error Report Period Radio ID", "capwap.control.message_element.decryption_error_report_period.radio_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_decryption_error_report_period_interval,\r\n{ "Decryption Error Report Report Interval (Sec)", "capwap.control.message_element.decryption_error_report_period.interval",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_delete_station_radio_id,\r\n{ "Radio ID", "capwap.control.message_element.delete_station.radio_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Representing the radio, whose value is between one (1) and 31", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_delete_station_length,\r\n{ "Mac Length", "capwap.control.message_element.delete_station.length",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"The length of the MAC Address field", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_delete_station_mac_eui48,\r\n{ "MAC address", "capwap.control.message_element.delete_station.mac.eui48",\r\nFT_ETHER, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_delete_station_mac_eui64,\r\n{ "MAC address", "capwap.control.message_element.delete_station.mac.eui64",\r\nFT_EUI64, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_delete_station_mac_data,\r\n{ "MAC address", "capwap.control.message_element.delete_station.mac.data",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ac_name,\r\n{ "AC Name", "capwap.control.message_element.ac_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ac_name_with_priority,\r\n{ "AC Name Priority", "capwap.control.message_element.ac_name_with_priority",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ac_timestamp,\r\n{ "AC Timestamp", "capwap.control.message_element.ac_timestamp",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_LOCAL, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_add_station_radio_id,\r\n{ "Radio ID", "capwap.control.message_element.add_station.radio_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Representing the radio, whose value is between one (1) and 31", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_add_station_length,\r\n{ "Mac Length", "capwap.control.message_element.add_station.length",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"The length of the MAC Address field", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_add_station_mac_eui48,\r\n{ "MAC address", "capwap.control.message_element.add_station.mac.eui48",\r\nFT_ETHER, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_add_station_mac_eui64,\r\n{ "MAC address", "capwap.control.message_element.add_station.mac.eui64",\r\nFT_EUI64, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_add_station_mac_data,\r\n{ "MAC address", "capwap.control.message_element.add_station.mac.data",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_add_station_vlan_name,\r\n{ "Vlan Name", "capwap.control.message_element.add_station.vlan_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\n"Containing the VLAN Name on which the WTP is to locally bridge user data", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_discovery_type,\r\n{ "Discovery Type", "capwap.control.message_element.discovery_type",\r\nFT_UINT8, BASE_DEC, VALS(discovery_type_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_idle_timeout,\r\n{ "Idle Timeout (Sec)", "capwap.control.message_element.idle_timeout",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_location_data,\r\n{ "Location Data", "capwap.control.message_element.location_data",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_maximum_message_length,\r\n{ "Maximum Message Length", "capwap.control.message_element.maximum_message_length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_capwap_local_ipv4_address,\r\n{ "CAPWAP Local IPv4 Address", "capwap.control.message_element.capwap_local_ipv4_address",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\n"The IP address of the sender", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_radio_admin_id,\r\n{ "Radio Administrative ID", "capwap.control.message_element.radio_admin.id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_radio_admin_state,\r\n{ "Radio Administrative State", "capwap.control.message_element.radio_admin.state",\r\nFT_UINT8, BASE_DEC, VALS(radio_admin_state_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_radio_op_state_radio_id,\r\n{ "Radio Operational ID", "capwap.control.message_element.radio_op_state.radio_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_radio_op_state_radio_state,\r\n{ "Radio Operational State", "capwap.control.message_element.radio_op_state.radio_state",\r\nFT_UINT8, BASE_DEC, VALS(radio_op_state_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_radio_op_state_radio_cause,\r\n{ "Radio Operational Cause", "capwap.control.message_element.radio_op_state.radio_cause",\r\nFT_UINT8, BASE_DEC, VALS(radio_op_cause_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_result_code,\r\n{ "Result Code", "capwap.control.message_element.result_code",\r\nFT_UINT32, BASE_DEC, VALS(result_code_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_session_id,\r\n{ "Session ID", "capwap.control.message_element.session_id",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_statistics_timer,\r\n{ "Statistics Timer (Sec)", "capwap.control.message_element.statistics_timer",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_vsp_vendor_identifier,\r\n{ "Vendor Identifier", "capwap.control.message_element.vsp.vendor_identifier",\r\nFT_UINT32, BASE_DEC|BASE_EXT_STRING, &sminmpec_values_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_vsp_vendor_element_id,\r\n{ "Vendor Element ID", "capwap.control.message_element.vsp.vendor_element_id",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_vsp_vendor_data,\r\n{ "Vendor Data", "capwap.control.message_element.vsp.vendor_data",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_board_data,\r\n{ "WTP Board Data", "capwap.control.message_element.wtp_board_data",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_board_data_vendor,\r\n{ "WTP Board Data Vendor", "capwap.control.message_element.wtp_board_data.vendor",\r\nFT_UINT32, BASE_DEC|BASE_EXT_STRING, &sminmpec_values_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_board_data_type,\r\n{ "Board Data Type", "capwap.control.message_element.wtp_board_data.type",\r\nFT_UINT16, BASE_DEC, VALS(board_data_type_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_board_data_length,\r\n{ "Board Data Length", "capwap.control.message_element.wtp_board_data.length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_board_data_value,\r\n{ "Board Data Value", "capwap.control.message_element.wtp_board_data.value",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_board_data_wtp_model_number,\r\n{ "WTP Model Number", "capwap.control.message_element.wtp_board_data.wtp_model_number",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_board_data_wtp_serial_number,\r\n{ "WTP Serial Number", "capwap.control.message_element.wtp_board_data.wtp_serial_number",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_board_data_wtp_board_id,\r\n{ "WTP Board ID", "capwap.control.message_element.wtp_board_data.wtp_board_id",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_board_data_wtp_board_revision,\r\n{ "WTP Board Revision", "capwap.control.message_element.wtp_board_data.wtp_board_revision",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_board_data_base_mac_address,\r\n{ "Base Mac Address", "capwap.control.message_element.wtp_board_data.base_mac_address",\r\nFT_ETHER, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_descriptor_max_radios,\r\n{ "Max Radios", "capwap.control.message_element.wtp_descriptor.max_radios",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_descriptor_radio_in_use,\r\n{ "Radio in use", "capwap.control.message_element.wtp_descriptor.radio_in_use",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_descriptor_number_encrypt,\r\n{ "Encryption Capabilities (Number)", "capwap.control.message_element.wtp_descriptor.number_encrypt",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_descriptor_encrypt,\r\n{ "Encryption Capabilities", "capwap.control.message_element.wtp_descriptor.encrypt",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_descriptor_encrypt_reserved,\r\n{ "Reserved (Encrypt)", "capwap.control.message_element.wtp_descriptor.encrypt_reserved",\r\nFT_UINT8, BASE_DEC, NULL, 0xE0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_descriptor_encrypt_wbid,\r\n{ "Encrypt WBID", "capwap.control.message_element.wtp_descriptor.encrypt_wbid",\r\nFT_UINT8, BASE_DEC, VALS(type_wbid), 0x1F,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_descriptor_encrypt_capabilities,\r\n{ "Encryption Capabilities", "capwap.control.message_element.wtp_descriptor.encrypt_capabilities",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_descriptor,\r\n{ "WTP Descriptor", "capwap.control.message_element.wtp_descriptor",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_descriptor_vendor,\r\n{ "WTP Descriptor Vendor", "capwap.control.message_element.wtp_descriptor.vendor",\r\nFT_UINT32, BASE_DEC|BASE_EXT_STRING, &sminmpec_values_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_descriptor_type,\r\n{ "Descriptor Type", "capwap.control.message_element.wtp_descriptor.type",\r\nFT_UINT16, BASE_DEC, VALS(wtp_descriptor_type_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_descriptor_length,\r\n{ "Descriptor Length", "capwap.control.message_element.wtp_descriptor.length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_descriptor_value,\r\n{ "Descriptor Value", "capwap.control.message_element.wtp_descriptor.value",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_descriptor_hardware_version,\r\n{ "WTP Hardware Version", "capwap.control.message_element.wtp_descriptor.hardware_version",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_descriptor_active_software_version,\r\n{ "WTP Active Software Version", "capwap.control.message_element.wtp_descriptor.active_software_version",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_descriptor_boot_version,\r\n{ "WTP Boot Version", "capwap.control.message_element.wtp_descriptor.boot_version",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_descriptor_other_software_version,\r\n{ "WTP Other Software Version", "capwap.control.message_element.wtp_descriptor.other_software_version",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_fallback,\r\n{ "WTP Fallback", "capwap.control.message_element.wtp_fallback",\r\nFT_UINT8, BASE_DEC, VALS(wtp_fallback_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_frame_tunnel_mode,\r\n{ "WTP Frame Tunnel Mode", "capwap.control.message_element.wtp_frame_tunnel_mode",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_frame_tunnel_mode_n,\r\n{ "Native Frame Tunnel Mode", "capwap.control.message_element.wtp_frame_tunnel_mode.n",\r\nFT_BOOLEAN, 8, TFS(&tfs_true_false), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_frame_tunnel_mode_e,\r\n{ "802.3 Frame Tunnel Mode", "capwap.control.message_element.wtp_frame_tunnel_mode.e",\r\nFT_BOOLEAN, 8, TFS(&tfs_true_false), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_frame_tunnel_mode_l,\r\n{ "Local Bridging", "capwap.control.message_element.wtp_frame_tunnel_mode.l",\r\nFT_BOOLEAN, 8, TFS(&tfs_true_false), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_frame_tunnel_mode_r,\r\n{ "Reserved", "capwap.control.message_element.wtp_frame_tunnel_mode.r",\r\nFT_UINT8, BASE_HEX, 0x0, 0xF1,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_mac_type,\r\n{ "WTP MAC Type", "capwap.control.message_element.wtp_mac_type",\r\nFT_UINT8, BASE_DEC, VALS(wtp_mac_vals), 0x0,\r\n"The MAC mode of operation supported by the WTP", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_name,\r\n{ "WTP Name", "capwap.control.message_element.wtp_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_reboot_statistics_reboot_count,\r\n{ "Reboot Count", "capwap.control.message_element.wtp_reboot_statistics.reboot_count",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"The number of reboots that have occurred due to a WTP crash", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_reboot_statistics_ac_initiated_count,\r\n{ "AC Initiated Count", "capwap.control.message_element.wtp_reboot_statistics.ac_initiated_count",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"The number of reboots that have occurred at the request of a CAPWAP protocol message", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_reboot_statistics_link_failure_count,\r\n{ "Link Failure Count", "capwap.control.message_element.wtp_reboot_statistics.link_failure_count",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"The number of times that a CAPWAP protocol connection with an AC has failed due to link failure", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_reboot_statistics_sw_failure_count,\r\n{ "SW Failure Count", "capwap.control.message_element.wtp_reboot_statistics.sw_failure_count",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"The number of times that a CAPWAP protocol connection with an AC has failed due to software-related reasons", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_reboot_statistics_hw_failure_count,\r\n{ "HW Failure Count", "capwap.control.message_element.wtp_reboot_statistics.hw_failure_count",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"The number of times that a CAPWAP protocol connection with an AC has failed due to hardware-related reasons", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_reboot_statistics_other_failure_count,\r\n{ "Other Failure Count", "capwap.control.message_element.wtp_reboot_statistics.other_failure_count",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"The number of times that a CAPWAP protocol connection with an AC has failed due to known reasons, other than AC initiated, link, SW or HW failure", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_reboot_statistics_unknown_failure_count,\r\n{ "Unknown Failure Count", "capwap.control.message_element.wtp_reboot_statistics.unknown_failure_count",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"The number of times that a CAPWAP protocol connection with an AC has failed for unknown reasons", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_wtp_reboot_statistics_last_failure_type,\r\n{ "Last Failure Type", "capwap.control.message_element.wtp_reboot_statistics.last_failure_type",\r\nFT_UINT8, BASE_DEC, VALS(last_failure_type_vals), 0x0,\r\n"The failure type of the most recent WTP failure", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_capwap_local_ipv6_address,\r\n{ "CAPWAP Local IPv6 Address", "capwap.control.message_element.capwap_local_ipv6_address",\r\nFT_IPv6, BASE_NONE, NULL, 0x0,\r\n"The IP address of the sender", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_capwap_transport_protocol,\r\n{ "CAPWAP Transport Protocol", "capwap.control.message_element.capwap_transport_protocol",\r\nFT_UINT8, BASE_DEC, VALS(capwap_transport_protocol_vals), 0x0,\r\n"The transport to use for the CAPWAP Data channel", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_mtu_discovery_padding,\r\n{ "MTU Discovery Padding", "capwap.control.message_element.mtu_discovery_padding",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"A variable-length pad, filled with the value 0xFF", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ecn_support,\r\n{ "ECN Support", "capwap.control.message_element.ecn_support",\r\nFT_UINT8, BASE_DEC, VALS(ecn_support_vals), 0x0,\r\n"The sender's support for ECN, as defined in [RFC3168]", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_radio_id,\r\n{ "Radio ID", "capwap.control.message_element.ieee80211_add_wlan.radio_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_wlan_id,\r\n{ "WLAN ID", "capwap.control.message_element.ieee80211_add_wlan.wlan_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_capability,\r\n{ "Capability", "capwap.control.message_element.ieee80211_add_wlan.capability",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_capability_e,\r\n{ "ESS", "capwap.control.message_element.ieee80211_add_wlan.capability.e",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x8000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_capability_i,\r\n{ "IBSS", "capwap.control.message_element.ieee80211_add_wlan.capability.i",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x4000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_capability_c,\r\n{ "CF-Pollable", "capwap.control.message_element.ieee80211_add_wlan.capability.c",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x2000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_capability_f,\r\n{ "CF-Poll Request", "capwap.control.message_element.ieee80211_add_wlan.capability.f",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x1000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_capability_p,\r\n{ "Privacy", "capwap.control.message_element.ieee80211_add_wlan.capability.p",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0800,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_capability_s,\r\n{ "Short Preamble", "capwap.control.message_element.ieee80211_add_wlan.capability.s",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0400,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_capability_b,\r\n{ "PBCC", "capwap.control.message_element.ieee80211_add_wlan.capability.b",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0200,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_capability_a,\r\n{ "Channek Agility", "capwap.control.message_element.ieee80211_add_wlan.capability.a",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0100,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_capability_m,\r\n{ "Spectrum Management", "capwap.control.message_element.ieee80211_add_wlan.capability.m",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0080,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_capability_q,\r\n{ "QoS", "capwap.control.message_element.ieee80211_add_wlan.capability.q",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0040,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_capability_t,\r\n{ "Short Slot Time", "capwap.control.message_element.ieee80211_add_wlan.capability.t",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0020,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_capability_d,\r\n{ "APSD", "capwap.control.message_element.ieee80211_add_wlan.capability.d",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0010,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_capability_v,\r\n{ "Reserved", "capwap.control.message_element.ieee80211_add_wlan.capability.v",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0008,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_capability_o,\r\n{ "DSSS-OFDM", "capwap.control.message_element.ieee80211_add_wlan.capability.o",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0004,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_capability_k,\r\n{ "Delayed Block ACK", "capwap.control.message_element.ieee80211_add_wlan.capability.k",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0002,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_capability_l,\r\n{ "Immediate Block ACK", "capwap.control.message_element.ieee80211_add_wlan.capability.l",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0001,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_key_index,\r\n{ "Key-Index", "capwap.control.message_element.ieee80211_add_wlan.key_index",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_key_status,\r\n{ "Key Status", "capwap.control.message_element.ieee80211_add_wlan.key_status",\r\nFT_UINT8, BASE_DEC, VALS(ieee80211_wlan_key_status_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_key_length,\r\n{ "Key Length", "capwap.control.message_element.ieee80211_add_wlan.key_length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_key,\r\n{ "Key", "capwap.control.message_element.ieee80211_add_wlan.key",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_group_tsc,\r\n{ "Group TSC", "capwap.control.message_element.ieee80211_add_wlan.group_tsc",\r\nFT_UINT64, BASE_DEC, NULL, 0x00FFFFFF,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_qos,\r\n{ "QoS", "capwap.control.message_element.ieee80211_add_wlan.qos",\r\nFT_UINT8, BASE_DEC, VALS(ieee80211_add_wlan_qos_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_auth_type,\r\n{ "Auth Type", "capwap.control.message_element.ieee80211_add_wlan.auth_type",\r\nFT_UINT8, BASE_DEC, VALS(ieee80211_add_wlan_auth_type_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_mac_mode,\r\n{ "MAC Mode", "capwap.control.message_element.ieee80211_add_wlan.mac_mode",\r\nFT_UINT8, BASE_DEC, VALS(ieee80211_add_wlan_mac_mode_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_tunnel_mode,\r\n{ "Tunnel Mode", "capwap.control.message_element.ieee80211_add_wlan.tunnel_mode",\r\nFT_UINT8, BASE_DEC, VALS(ieee80211_add_wlan_tunnel_mode_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_suppress_ssid,\r\n{ "Suppress SSID", "capwap.control.message_element.ieee80211_add_wlan.supress_ssid",\r\nFT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_add_wlan_ssid,\r\n{ "SSID", "capwap.control.message_element.ieee80211_add_wlan.ssid",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_antenna_radio_id,\r\n{ "Radio ID", "capwap.control.message_element.ieee80211_antenna.radio_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_antenna_diversity,\r\n{ "Diversity", "capwap.control.message_element.ieee80211_antenna.diversity",\r\nFT_UINT8, BASE_DEC, VALS(ieee80211_antenna_diversity_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_antenna_combiner,\r\n{ "Combiner", "capwap.control.message_element.ieee80211_antenna.combiner",\r\nFT_UINT8, BASE_DEC, VALS(ieee80211_antenna_combiner_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_antenna_count,\r\n{ "Antenna Count", "capwap.control.message_element.ieee80211_antenna.count",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_antenna_selection,\r\n{ "Selection", "capwap.control.message_element.ieee80211_antenna.selection",\r\nFT_UINT8, BASE_DEC, VALS(ieee80211_antenna_selection_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_assigned_wtp_bssid_radio_id,\r\n{ "Radio ID", "capwap.control.message_element.ieee80211_assigned_wtp_bssid.radio_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_assigned_wtp_bssid_wlan_id,\r\n{ "WLAN ID", "capwap.control.message_element.ieee80211_assigned_wtp_bssid.wlan_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_assigned_wtp_bssid_bssid,\r\n{ "BSSID", "capwap.control.message_element.ieee80211_assigned_wtp_bssid.bssid",\r\nFT_ETHER, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_delete_wlan_radio_id,\r\n{ "Radio ID", "capwap.control.message_element.ieee80211_delete_wlan.radio_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_delete_wlan_wlan_id,\r\n{ "WLAN ID", "capwap.control.message_element.ieee80211_delete_wlan.wlan_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_direct_sequence_control_radio_id,\r\n{ "Radio ID", "capwap.control.message_element.ieee80211_direct_sequence_control.radio_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_direct_sequence_control_reserved,\r\n{ "Reserved", "capwap.control.message_element.ieee80211_direct_sequence_control.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_direct_sequence_control_current_channel,\r\n{ "Current Channel", "capwap.control.message_element.ieee80211_direct_sequence_control.current_channel",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_direct_sequence_control_current_cca,\r\n{ "Current CCA", "capwap.control.message_element.ieee80211_direct_sequence_control.current_cca",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_direct_sequence_control_energy_detect_threshold,\r\n{ "Energy Detect Threshold", "capwap.control.message_element.ieee80211_direct_sequence_control.energy_detect_threshold",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_ie_radio_id,\r\n{ "Radio ID", "capwap.control.message_element.ieee80211_ie.radio_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_ie_wlan_id,\r\n{ "WLAN ID", "capwap.control.message_element.ieee80211_ie.radio_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_ie_flags,\r\n{ "Flags", "capwap.control.message_element.ieee80211_ie.flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_ie_flags_b,\r\n{ "Include IE in Beacons", "capwap.control.message_element.ieee80211_ie.flags.b",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\n"When set, the WTP is to include the Information Element in IEEE 802.11 Beacons associated with the WLAN", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_ie_flags_p,\r\n{ "Include IE in Probe Responses", "capwap.control.message_element.ieee80211_ie.flags.p",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\n"When set, the WTP is to include the Information Element in Probe Responses associated with the WLAN", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_ie_flags_rsv,\r\n{ "Reserved", "capwap.control.message_element.ieee80211_ie.flags.rsv",\r\nFT_UINT8, BASE_HEX, NULL, 0x3F,\r\n"Must be Zero", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_mac_operation_radio_id,\r\n{ "Radio ID", "capwap.control.message_element.ieee80211_mac_operation.radio_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_mac_operation_reserved,\r\n{ "Reserved", "capwap.control.message_element.ieee80211_mac_operation.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_mac_operation_rts_threshold,\r\n{ "RTS Threshold", "capwap.control.message_element.ieee80211_mac_operation.rts_threshold",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_mac_operation_short_retry,\r\n{ "Short Retry", "capwap.control.message_element.ieee80211_mac_operation.short_retry",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_mac_operation_long_retry,\r\n{ "Long Retry", "capwap.control.message_element.ieee80211_mac_operation.long_retry",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_mac_operation_fragmentation_threshold,\r\n{ "Fragmentation Threshold", "capwap.control.message_element.ieee80211_mac_operation.fragmentation_threshold",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_mac_operation_tx_msdu_lifetime,\r\n{ "Tx MDSU Lifetime", "capwap.control.message_element.ieee80211_mac_operation.tx_msdu_lifetime",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_mac_operation_rx_msdu_lifetime,\r\n{ "Rx MDSU Lifetime", "capwap.control.message_element.ieee80211_mac_operation.rx_msdu_lifetime",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_mic_countermeasures_radio_id,\r\n{ "Radio ID", "capwap.control.message_element.ieee80211_mic_countermeasures.radio_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_mic_countermeasures_wlan_id,\r\n{ "WLAN ID", "capwap.control.message_element.ieee80211_mic_countermeasures.wlan_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_mic_countermeasures_mac_address,\r\n{ "MAC Address", "capwap.control.message_element.ieee80211_mic_countermeasures.mac_address",\r\nFT_ETHER, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_multi_domain_capability_radio_id,\r\n{ "Radio ID", "capwap.control.message_element.ieee80211_multi_domain_capability.radio_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_multi_domain_capability_reserved,\r\n{ "Reserved", "capwap.control.message_element.ieee80211_multi_domain_capability.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_multi_domain_capability_first_channel,\r\n{ "First Channel", "capwap.control.message_element.ieee80211_multi_domain_capability.first_channel",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_multi_domain_capability_number_of_channels,\r\n{ "Number of Channels", "capwap.control.message_element.ieee80211_multi_domain_capability.number_of_channels",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_multi_domain_capability_max_tx_power_level,\r\n{ "Max TX Power Level", "capwap.control.message_element.ieee80211_multi_domain_capability.max_tx_power_level",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_ofdm_control_radio_id,\r\n{ "Radio ID", "capwap.control.message_element.ieee80211_ofdm_control.radio_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_ofdm_control_reserved,\r\n{ "Reserved", "capwap.control.message_element.ieee80211_ofdm_control.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_ofdm_control_current_channel,\r\n{ "Current Channel", "capwap.control.message_element.ieee80211_ofdm_control.current_channel",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_ofdm_control_band_support,\r\n{ "Band Support", "capwap.control.message_element.ieee80211_ofdm_control.band_support",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_ofdm_control_band_support_bit0,\r\n{ "Operating in the 5.15-5.25 GHz band", "capwap.control.message_element.ieee80211_ofdm_control.band_support.bit0",\r\nFT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_ofdm_control_band_support_bit1,\r\n{ "Operating in the 5.25-5.35 GHz band", "capwap.control.message_element.ieee80211_ofdm_control.band_support.bit1",\r\nFT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_ofdm_control_band_support_bit2,\r\n{ "Operating in the 5.725-5.825 GHz band", "capwap.control.message_element.ieee80211_ofdm_control.band_support.bit2",\r\nFT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_ofdm_control_band_support_bit3,\r\n{ "Operating in the 5.47-5.725 GHz band", "capwap.control.message_element.ieee80211_ofdm_control.band_support.bit3",\r\nFT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_ofdm_control_band_support_bit4,\r\n{ "Operating in the lower Japanese 5.25 GHz band", "capwap.control.message_element.ieee80211_ofdm_control.band_support.bit4",\r\nFT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_ofdm_control_band_support_bit5,\r\n{ "Operating in the l5.03-5.091 GHz band", "capwap.control.message_element.ieee80211_ofdm_control.band_support.bit5",\r\nFT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_ofdm_control_band_support_bit6,\r\n{ "Operating in the l5.03-5.091 GHz band", "capwap.control.message_element.ieee80211_ofdm_control.band_support.bit5",\r\nFT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_ofdm_control_band_support_bit7,\r\n{ "Reserved", "capwap.control.message_element.ieee80211_ofdm_control.band_support.bit7",\r\nFT_UINT8, BASE_HEX, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_ofdm_control_ti_threshold,\r\n{ "TI Threshold", "capwap.control.message_element.ieee80211_mofdm_control.ti_threshold",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_rate_set_radio_id,\r\n{ "Radio ID", "capwap.control.message_element.ieee80211_rate_set.radio_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_rate_set_rate_set,\r\n{ "Rate Set", "capwap.control.message_element.ieee80211_rate_set.rate_set",\r\nFT_UINT8, BASE_HEX|BASE_EXT_STRING, &ieee80211_supported_rates_vals_ext, 0x0,\r\n"In Mbit/sec, (B) for Basic Rates", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_radio_id,\r\n{ "Radio ID", "capwap.control.message_element.ieee80211_station.radio_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_association_id,\r\n{ "Association ID", "capwap.control.message_element.ieee80211_station.association_id",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_flags,\r\n{ "Flags", "capwap.control.message_element.ieee80211_station.flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_mac_address,\r\n{ "MAC Address", "capwap.control.message_element.ieee80211_station.mac_address",\r\nFT_ETHER, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_capabilities,\r\n{ "Capabilities", "capwap.control.message_element.ieee80211_station.capabilities",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_capabilities_e,\r\n{ "ESS", "capwap.control.message_element.ieee80211_station.capabilities.e",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x8000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_capabilities_i,\r\n{ "IBSS", "capwap.control.message_element.ieee80211_station.capabilities.i",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x4000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_capabilities_c,\r\n{ "CF-Pollable", "capwap.control.message_element.ieee80211_station.capabilities.c",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x2000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_capabilities_f,\r\n{ "CF-Poll Request", "capwap.control.message_element.ieee80211_station.capabilities.f",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x1000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_capabilities_p,\r\n{ "Privacy", "capwap.control.message_element.ieee80211_station.capabilities.p",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0800,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_capabilities_s,\r\n{ "Short Preamble", "capwap.control.message_element.ieee80211_station.capabilities.s",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0400,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_capabilities_b,\r\n{ "PBCC", "capwap.control.message_element.ieee80211_station.capabilities.b",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0200,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_capabilities_a,\r\n{ "Channek Agility", "capwap.control.message_element.ieee80211_station.capabilities.a",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0100,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_capabilities_m,\r\n{ "Spectrum Management", "capwap.control.message_element.ieee80211_station.capabilities.m",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0080,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_capabilities_q,\r\n{ "QoS", "capwap.control.message_element.ieee80211_station.capabilities.q",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0040,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_capabilities_t,\r\n{ "Short Slot Time", "capwap.control.message_element.ieee80211_station.capabilities.t",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0020,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_capabilities_d,\r\n{ "APSD", "capwap.control.message_element.ieee80211_station.capabilities.d",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0010,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_capabilities_v,\r\n{ "Reserved", "capwap.control.message_element.ieee80211_station.capabilities.v",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0008,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_capabilities_o,\r\n{ "DSSS-OFDM", "capwap.control.message_element.ieee80211_station.capabilities.o",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0004,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_capabilities_k,\r\n{ "Delayed Block ACK", "capwap.control.message_element.ieee80211_station.capabilities.k",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0002,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_capabilities_l,\r\n{ "Immediate Block ACK", "capwap.control.message_element.ieee80211_station.capabilities.l",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0001,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_wlan_id,\r\n{ "WLAN ID", "capwap.control.message_element.ieee80211_station.wlan_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_supported_rates,\r\n{ "Supported Rates", "capwap.control.message_element.ieee80211_station.supported_rates",\r\nFT_UINT8, BASE_HEX|BASE_EXT_STRING, &ieee80211_supported_rates_vals_ext, 0x0,\r\n"In Mbit/sec, (B) for Basic Rates", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_session_key_mac,\r\n{ "Mac Address", "capwap.control.message_element.ieee80211_station_session_key.mac",\r\nFT_ETHER, BASE_NONE, NULL, 0x0,\r\n"The station's MAC Address", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_session_key_flags,\r\n{ "Flags", "capwap.control.message_element.ieee80211_station_session_key.flags",\r\nFT_UINT16, BASE_DEC, NULL, 0x3FFF,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_session_key_flags_a,\r\n{ "Flag A", "capwap.control.message_element.ieee80211_station_session_key.flags_a",\r\nFT_BOOLEAN, 1, NULL, 0x2000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_session_key_flags_c,\r\n{ "Flag C", "capwap.control.message_element.ieee80211_station_session_key.flags_c",\r\nFT_BOOLEAN, 1, NULL, 0x1000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_session_key_pairwire_tsc,\r\n{ "Pairwise TSC", "capwap.control.message_element.ieee80211_station_session_key.pairwire_tsc",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Transmit Sequence Counter (TSC)", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_session_key_pairwire_rsc,\r\n{ "Pairwise RSC", "capwap.control.message_element.ieee80211_station_session_key.pairwire_rsc",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Receive Sequence Counter (TSC)", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_station_session_key_key,\r\n{ "Key", "capwap.control.message_element.ieee80211_station_session_key.key",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_supported_rates_radio_id,\r\n{ "Radio ID", "capwap.control.message_element.ieee80211_supported_rates.radio_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_supported_rates_rate,\r\n{ "Rates", "capwap.control.message_element.ieee80211_supported_rates.rate",\r\nFT_UINT8, BASE_HEX|BASE_EXT_STRING, &ieee80211_supported_rates_vals_ext, 0x0,\r\n"In Mbit/sec, (B) for Basic Rates", HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_tx_power_radio_id,\r\n{ "Radio ID", "capwap.control.message_element.ieee80211_tx_power.radio_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_tx_power_reserved,\r\n{ "Reserved", "capwap.control.message_element.ieee80211_tx_power.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_tx_power_current_tx_power,\r\n{ "Current Tx Power", "capwap.control.message_element.ieee80211_tx_power.current_tx_power",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_tx_power_level_radio_id,\r\n{ "Radio ID", "capwap.control.message_element.ieee80211_tx_power_level.radio_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_tx_power_level_num_levels,\r\n{ "Num Levels", "capwap.control.message_element.ieee80211_tx_power_level.num_levels",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_tx_power_level_power_level,\r\n{ "Power Level", "capwap.control.message_element.ieee80211_tx_power_level.power_level",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_update_wlan_radio_id,\r\n{ "Radio ID", "capwap.control.message_element.ieee80211_update_wlan.radio_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_update_wlan_wlan_id,\r\n{ "WLAN ID", "capwap.control.message_element.ieee80211_update_wlan.wlan_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_update_wlan_capability,\r\n{ "Capability", "capwap.control.message_element.ieee80211_update_wlan.capability",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_update_wlan_capability_e,\r\n{ "ESS", "capwap.control.message_element.ieee80211_update_wlan.capability.e",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x8000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_update_wlan_capability_i,\r\n{ "IBSS", "capwap.control.message_element.ieee80211_update_wlan.capability.i",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x4000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_update_wlan_capability_c,\r\n{ "CF-Pollable", "capwap.control.message_element.ieee80211_update_wlan.capability.c",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x2000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_update_wlan_capability_f,\r\n{ "CF-Poll Request", "capwap.control.message_element.ieee80211_update_wlan.capability.f",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x1000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_update_wlan_capability_p,\r\n{ "Privacy", "capwap.control.message_element.ieee80211_update_wlan.capability.p",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0800,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_update_wlan_capability_s,\r\n{ "Short Preamble", "capwap.control.message_element.ieee80211_update_wlan.capability.s",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0400,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_update_wlan_capability_b,\r\n{ "PBCC", "capwap.control.message_element.ieee80211_update_wlan.capability.b",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0200,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_update_wlan_capability_a,\r\n{ "Channek Agility", "capwap.control.message_element.ieee80211_update_wlan.capability.a",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0100,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_update_wlan_capability_m,\r\n{ "Spectrum Management", "capwap.control.message_element.ieee80211_update_wlan.capability.m",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0080,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_update_wlan_capability_q,\r\n{ "QoS", "capwap.control.message_element.ieee80211_update_wlan.capability.q",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0040,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_update_wlan_capability_t,\r\n{ "Short Slot Time", "capwap.control.message_element.ieee80211_update_wlan.capability.t",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0020,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_update_wlan_capability_d,\r\n{ "APSD", "capwap.control.message_element.ieee80211_update_wlan.capability.d",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0010,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_update_wlan_capability_v,\r\n{ "Reserved", "capwap.control.message_element.ieee80211_update_wlan.capability.v",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0008,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_update_wlan_capability_o,\r\n{ "DSSS-OFDM", "capwap.control.message_element.ieee80211_update_wlan.capability.o",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0004,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_update_wlan_capability_k,\r\n{ "Delayed Block ACK", "capwap.control.message_element.ieee80211_update_wlan.capability.k",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0002,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_update_wlan_capability_l,\r\n{ "Immediate Block ACK", "capwap.control.message_element.ieee80211_update_wlan.capability.l",\r\nFT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0001,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_update_wlan_key_index,\r\n{ "Key-Index", "capwap.control.message_element.ieee80211_update_wlan.key_index",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_update_wlan_key_status,\r\n{ "Key Status", "capwap.control.message_element.ieee80211_update_wlan.key_status",\r\nFT_UINT8, BASE_DEC, VALS(ieee80211_wlan_key_status_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_update_wlan_key_length,\r\n{ "Key Length", "capwap.control.message_element.ieee80211_update_wlan.key_length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_update_wlan_key,\r\n{ "Key", "capwap.control.message_element.ieee80211_update_wlan.key",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_wtp_radio_cfg_radio_id,\r\n{ "Radio ID", "capwap.control.message_element.ieee80211_wtp_radio_info.cfg_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_wtp_radio_cfg_short_preamble,\r\n{ "Short Preamble", "capwap.control.message_element.ieee80211_wtp_radio_info.short_preamble",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_wtp_radio_cfg_num_of_bssids,\r\n{ "Num of BSSIDs", "capwap.control.message_element.ieee80211_wtp_radio_info.num_of_bssids",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_wtp_radio_cfg_dtim_period,\r\n{ "DTIM Period", "capwap.control.message_element.ieee80211_wtp_radio_info.dtim_period",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_wtp_radio_cfg_bssid,\r\n{ "BSSID", "capwap.control.message_element.ieee80211_wtp_radio_info.bssid",\r\nFT_ETHER, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_wtp_radio_cfg_beacon_period,\r\n{ "Beacon Period", "capwap.control.message_element.ieee80211_wtp_radio_info.beacon_period",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_wtp_radio_cfg_country_string,\r\n{ "Country String", "capwap.control.message_element.ieee80211_wtp_radio_info.country_string",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_wtp_radio_info_radio_id,\r\n{ "Radio ID", "capwap.control.message_element.ieee80211_wtp_radio_info.radio_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_wtp_radio_info_radio_type_reserved,\r\n{ "Radio Type Reserved", "capwap.control.message_element.ieee80211_wtp_info_radio.radio_type_reserved",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_wtp_radio_info_radio_type_n,\r\n{ "Radio Type 802.11n", "capwap.control.message_element.ieee80211_wtp_info_radio.radio_type_n",\r\nFT_BOOLEAN, 4, TFS(&tfs_true_false), 0x0008,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_wtp_radio_info_radio_type_g,\r\n{ "Radio Type 802.11g", "capwap.control.message_element.ieee80211_wtp_info_radio.radio_type_g",\r\nFT_BOOLEAN, 4, TFS(&tfs_true_false), 0x0004,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_wtp_radio_info_radio_type_a,\r\n{ "Radio Type 802.11a", "capwap.control.message_element.ieee80211_wtp_info_radio.radio_type_a",\r\nFT_BOOLEAN, 4, TFS(&tfs_true_false), 0x0002,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_wtp_radio_info_radio_type_b,\r\n{ "Radio Type 802.11b", "capwap.control.message_element.ieee80211_wtp_info_radio.radio_type_b",\r\nFT_BOOLEAN, 4, TFS(&tfs_true_false), 0x0001,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_supported_mac_profiles_numbers,\r\n{ "Numbers Profiles", "capwap.control.message_element.ieee80211_supported_mac_profiles.numbers",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_supported_mac_profiles_profile,\r\n{ "Profile", "capwap.control.message_element.ieee80211_supported_mac_profiles.profile",\r\nFT_UINT8, BASE_DEC, VALS(ieee80211_mac_profile_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_msg_element_type_ieee80211_mac_profile,\r\n{ "Profile", "capwap.control.message_element.ieee80211_mac_profile",\r\nFT_UINT8, BASE_DEC, VALS(ieee80211_mac_profile_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ & hf_capwap_data_keep_alive,\r\n{ "Keep-Alive", "capwap.keep_alive",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ & hf_capwap_data_keep_alive_length,\r\n{ "Message Element Length", "capwap.keep_alive.length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_element_id,\r\n{ "Fortinet Element ID", "capwap.control.fortinet.element_id",\r\nFT_UINT16, BASE_DEC, VALS(fortinet_element_id_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_value,\r\n{ "Fortinet Value", "capwap.control.fortinet.value",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_ap_scan_rid,\r\n{ "Radio ID", "capwap.control.fortinet.ap_scan.rid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_ap_scan_bgscan_intv,\r\n{ "bg scan interval", "capwap.control.fortinet.ap_scan.bgpscan.interval",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_ap_scan_bgscan_idle,\r\n{ "bg scan idle", "capwap.control.fortinet.ap_scan.bgpscan.idle",\r\nFT_UINT24, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_ap_scan_bgscan_rpt_intv,\r\n{ "bg scan rpt interval", "capwap.control.fortinet.ap_scan.bgscan.rpt_interval",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_ap_scan_fgscan_rpt_intv,\r\n{ "fg scan rpt interval", "capwap.control.fortinet.ap_scan.fgscan.rpt_interval",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_passive_rid,\r\n{ "Radio ID", "capwap.control.fortinet.passive.rid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_passive,\r\n{ "Passive", "capwap.control.fortinet.passive",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_daemon_rst,\r\n{ "Daemon RST", "capwap.control.fortinet.daemon_rst",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_mac_rid,\r\n{ "Radio ID", "capwap.control.fortinet.mac.rid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_mac_wid,\r\n{ "WLAN ID", "capwap.control.fortinet.mac.wid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_mac_len,\r\n{ "Length", "capwap.control.fortinet.mac.len",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_mac,\r\n{ "MAC", "capwap.control.fortinet.mac",\r\nFT_ETHER, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_wtp_allow_sn,\r\n{ "Serial Number", "capwap.control.fortinet.wtp_allow.sn",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\n"WTP Serial Number", HFILL }\r\n},\r\n{ &hf_capwap_fortinet_wtp_allow_allow,\r\n{ "Allowed", "capwap.control.fortinet.wtp_allow.allowed",\r\nFT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_wbh_sta_rid,\r\n{ "Radio ID", "capwap.control.fortinet.wbh_sta.rid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_wbh_sta_len,\r\n{ "Length", "capwap.control.fortinet.wbh_sta.length",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_wbh_sta_mac,\r\n{ "STA MAC", "capwap.control.fortinet.wbh_sta.mac",\r\nFT_ETHER, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_wbh_sta_bssid,\r\n{ "BSSID", "capwap.control.fortinet.wbh_sta.bssid",\r\nFT_ETHER, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_wbh_sta_mhc,\r\n{ "MHC", "capwap.control.fortinet.wbh_sta.mhc",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_htcap_rid,\r\n{ "Radio ID", "capwap.control.fortinet.htcap.rid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_htcap_mcs,\r\n{ "MCS", "capwap.control.fortinet.htcap.mcs",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_htcap_gi,\r\n{ "HT Short GI", "capwap.control.fortinet.htcap.mcs.gi",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_htcap_bw,\r\n{ "Bandwidth", "capwap.control.fortinet.htcap.mcs.bw",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"20 or 40Mhz Mode", HFILL }\r\n},\r\n{ &hf_capwap_fortinet_mvap_sn_length,\r\n{ "SN Length", "capwap.control.fortinet.mvap.sn.length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_mvap_sn,\r\n{ "SN", "capwap.control.fortinet.mvap.sn",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_mvap_unknown,\r\n{ "Unknown", "capwap.control.fortinet.mvap.unknown",\r\nFT_UINT32, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_mvap_age,\r\n{ "Age", "capwap.control.fortinet.mvap.age",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_mvap_period,\r\n{ "Period", "capwap.control.fortinet.mvap.period",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_mvap_vfid,\r\n{ "Vfid", "capwap.control.fortinet.mvap.vfid",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_mode_rid,\r\n{ "Radio ID", "capwap.control.fortinet.mode.rid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_mode,\r\n{ "Mode", "capwap.control.fortinet.mode",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_coext_rid,\r\n{ "Radio ID", "capwap.control.fortinet.coext.rid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_coext,\r\n{ "Coext", "capwap.control.fortinet.coext",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_amsdu_rid,\r\n{ "Radio ID", "capwap.control.fortinet.amsdu.rid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_amsdu,\r\n{ "AMSDU", "capwap.control.fortinet.amsdu",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_ps_opt_rid,\r\n{ "Radio ID", "capwap.control.fortinet.ps_opt.rid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_ps_opt,\r\n{ "PS OPT", "capwap.control.fortinet.ps_opt",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_pure_rid,\r\n{ "Radio ID", "capwap.control.fortinet.pure.rid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_pure,\r\n{ "Pure", "capwap.control.fortinet.pure",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_ebptag_ebp,\r\n{ "EBP", "capwap.control.fortinet.ebptag.ebp",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_ebptag_tag,\r\n{ "Tag", "capwap.control.fortinet.ebptag.tag",\r\nFT_ETHER, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_telnet_enable,\r\n{ "Telnet Enable", "capwap.control.fortinet.telnet_enable",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_admin_passwd,\r\n{ "Admin Password", "capwap.control.fortinet.admin_password",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_regcode,\r\n{ "Reg Code", "capwap.control.fortinet.reg_code",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_countrycode_rid,\r\n{ "Radio ID", "capwap.control.fortinet.countrycode.rid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_countrycode_code,\r\n{ "Country Code", "capwap.control.fortinet.countrycode.code",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_countrycode_string,\r\n{ "Country Code", "capwap.control.fortinet.countrycode.string",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_sta_scan_rid,\r\n{ "Radio ID", "capwap.control.fortinet.sta_scan.rid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_sta_scan,\r\n{ "STA Scan", "capwap.control.fortinet.sta_scan",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_fho_rid,\r\n{ "Radio ID", "capwap.control.fortinet.fho.rid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_fho,\r\n{ "FHO", "capwap.control.fortinet.fho",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_apho_rid,\r\n{ "Radio ID", "capwap.control.fortinet.fho.rid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_apho,\r\n{ "APHO", "capwap.control.fortinet.apho",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_sta_locate_rid,\r\n{ "Radio ID", "capwap.control.fortinet.sta_locate.rid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_sta_locate_enable,\r\n{ "Locate Enable", "capwap.control.fortinet.sta_locate.enable",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_sta_locate_interval,\r\n{ "Locate Interval", "capwap.control.fortinet.sta_locate.interval",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_sa_rid,\r\n{ "Radio ID", "capwap.control.fortinet.spectrum_analysis.rid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_sa_enable,\r\n{ "Spectrum Analysis Enable", "capwap.control.fortinet.spectrum_analysis.enable",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_sa_ssid,\r\n{ "SSID", "capwap.control.fortinet.spectrum_analysis.ssid",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_darrp_cfg_rid,\r\n{ "Radio ID", "capwap.control.fortinet.darrp_cfg.rid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_darrp_cfg_enable,\r\n{ "DARRP CFG Enable", "capwap.control.fortinet.darrp_cfg.enable",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_darrp_cfg_interval,\r\n{ "DARRP CFG Interval", "capwap.control.fortinet.darrp_cfg.interval",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_ap_suppress_list_ver,\r\n{ "Ver", "capwap.control.fortinet.ap_suppress_list.ver",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_ap_suppress_list_op,\r\n{ "Op", "capwap.control.fortinet.ap_suppress_list.op",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Operation ?", HFILL }\r\n},\r\n{ &hf_capwap_fortinet_ap_suppress_list_rid,\r\n{ "Radio ID", "capwap.control.fortinet.ap_suppress_list.rid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_ap_suppress_list_len,\r\n{ "Length", "capwap.control.fortinet.ap_suppress_list.length",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_wds_rid,\r\n{ "Radio ID", "capwap.control.fortinet.wds.rid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_wds_wid,\r\n{ "WLAN ID", "capwap.control.fortinet.wds.wid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_wds_enable,\r\n{ "WDS Enable", "capwap.control.fortinet.wds.enable",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_vap_vlan_tag_rid,\r\n{ "Radio ID", "capwap.control.fortinet.vap_vlan_tag.rid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_vap_vlan_tag_wid,\r\n{ "WLAN ID", "capwap.control.fortinet.vap_vlan_tag.wid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_vap_vlan_tag,\r\n{ "Vlan ID", "capwap.control.fortinet.vap_vlan_tag",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_vap_bitmap_rid,\r\n{ "Radio ID", "capwap.control.fortinet.bitmap.rid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_vap_bitmap,\r\n{ "Bitmap", "capwap.control.fortinet.vap_bitmap",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_mcast_rate_rid,\r\n{ "Radio ID", "capwap.control.fortinet.mcast_rate.rid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_mcast_rate_wid,\r\n{ "WLAN ID", "capwap.control.fortinet.mcast_rate.wid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_mcast_rate,\r\n{ "Multicast Rate", "capwap.control.fortinet.mcast_rate",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_cfg_rid,\r\n{ "Radio ID", "capwap.control.fortinet.cfg.rid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_cfg_wid,\r\n{ "WLAN ID", "capwap.control.fortinet.cfg.wid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_cfg_ip,\r\n{ "IP", "capwap.control.fortinet.cfg.ip",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_cfg_mask,\r\n{ "Mask", "capwap.control.fortinet.cfg.mask",\r\nFT_IPv4, BASE_NETMASK, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_split_tun_cfg_enable_local_subnet,\r\n{ "Enable Local Subnet", "capwap.control.fortinet.split_tun_cfg.enable_local_subnet",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_split_tun_cfg_cnt,\r\n{ "CNT", "capwap.control.fortinet.split_tun_cfg.cnt",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_mgmt_vlan_id,\r\n{ "Vlan ID", "capwap.control.fortinet.mgmt_vlan.id",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_vap_psk_passwd_rid,\r\n{ "Radio ID", "capwap.control.fortinet.vap_psk_passwd.rid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_vap_psk_passwd_wid,\r\n{ "WLAN ID", "capwap.control.fortinet.vap_psk_passwd.wid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_vap_psk_passwd_key,\r\n{ "Key", "capwap.control.fortinet.vap_psk_passwd.key",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_mesh_eth_bridge_enable,\r\n{ "Mesh Eth Bridge Enable", "capwap.control.fortinet.mesh_eth_bridge.enable",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_mesh_eth_bridge_type,\r\n{ "Mesh Eth Bridge Type", "capwap.control.fortinet.mesh_eth_bridge.type",\r\nFT_UINT16, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_wtp_cap,\r\n{ "WTP CAP", "capwap.control.fortinet.wtp_cap",\r\nFT_BYTES, SEP_SPACE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_txpwr_rid,\r\n{ "Radio ID", "capwap.control.fortinet.tx_power.rid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_txpwr,\r\n{ "TX Power", "capwap.control.fortinet.tx_power",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"In Pourcentage", HFILL }\r\n},\r\n{ &hf_capwap_fortinet_wids_enable_rid,\r\n{ "Radio ID", "capwap.control.fortinet.wids_enable.rid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_wids_enable,\r\n{ "WIDS Enable", "capwap.control.fortinet.wids_enable.enable",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_unknown_rid,\r\n{ "Radio ID", "capwap.control.fortinet.unknown.rid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_unknown_wid,\r\n{ "WLAN ID", "capwap.control.fortinet.unknown.wid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_fortinet_unknown,\r\n{ "Unknown Data", "capwap.control.fortinet.unknown",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_element_id,\r\n{ "Cisco Element ID", "capwap.control.cisco.element_id",\r\nFT_UINT16, BASE_DEC, VALS(cisco_element_id_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_value,\r\n{ "Cisco Value", "capwap.control.cisco.value",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_mwar_addr,\r\n{ "Address", "capwap.control.cisco.mwar.address",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_rad_name,\r\n{ "RAD (AP) Name", "capwap.control.cisco.rad_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_mwar_type,\r\n{ "Type", "capwap.control.cisco.mwar.type",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_mwar_hardware,\r\n{ "Hardware version", "capwap.control.cisco.mwar.hardware",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_mwar_software,\r\n{ "Software version", "capwap.control.cisco.mwar.software",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_mwar_active_ms,\r\n{ "Active MS", "capwap.control.cisco.mwar.active_ms",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_mwar_supported_ms,\r\n{ "Supported MS", "capwap.control.cisco.mwar.supported_ms",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_mwar_active_rad,\r\n{ "Active RAD", "capwap.control.cisco.mwar.active_rad",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_mwar_supported_rad,\r\n{ "Supported RAD", "capwap.control.cisco.mwar.supported_rad",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_ap_mode_and_type_mode,\r\n{ "Mode", "capwap.control.cisco.ap_mode_and_type.mode",\r\nFT_UINT8, BASE_DEC, VALS(cisco_ap_mode_and_type_mode_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_ap_mode_and_type_type,\r\n{ "Type", "capwap.control.cisco.ap_mode_and_type.type",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_ap_static_ip_addr,\r\n{ "IP Address", "capwap.control.cisco.ap_static_ip.addr",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_ap_static_ip_netmask,\r\n{ "Netmask", "capwap.control.cisco.ap_static_ip.netmask",\r\nFT_IPv4, BASE_NETMASK, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_ap_static_ip_gateway,\r\n{ "Gateway", "capwap.control.cisco.ap_static_ip.gateway",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_ap_static_ip_type,\r\n{ "Type", "capwap.control.cisco.ap_static_ip.type",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_ap_static_ip_reserved,\r\n{ "Reserved", "capwap.control.cisco.ap_static_ip.reserved",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_ap_uptime_current,\r\n{ "AP Uptime Current", "capwap.control.cisco.ap_uptime.current",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_ap_uptime_last,\r\n{ "AP Uptime Last", "capwap.control.cisco.ap_uptime.last",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_ap_group_name,\r\n{ "AP Group Name", "capwap.control.cisco.ap_group_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_spam_ap_led_state,\r\n{ "Led State", "capwap.control.cisco.spam_ap_led_state",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_ap_timesync,\r\n{ "AP TimeSync", "capwap.control.cisco.ap_timesync",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_LOCAL, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_ap_timesync_type,\r\n{ "Type (?)", "capwap.control.cisco.ap_timesync.type",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_board_data_options_ant_type,\r\n{ "Antenna Type", "capwap.control.cisco.board_data_options.ant_type",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_board_data_options_flex_connect,\r\n{ "Flex Connect", "capwap.control.cisco.board_data_options.flex_connect",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_board_data_options_ap_type,\r\n{ "AP Type", "capwap.control.cisco.board_data_options.ap_type",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_board_data_options_join_priority,\r\n{ "Join Priority", "capwap.control.cisco.board_data_options.join_priority",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_capwap_cisco_unknown,\r\n{ "Unknown Data", "capwap.control.cisco.unknown",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_msg_fragments,\r\n{ "Message fragments", "capwap.fragments",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_msg_fragment,\r\n{ "Message fragment", "capwap.fragment",\r\nFT_FRAMENUM, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_msg_fragment_overlap,\r\n{ "Message fragment overlap", "capwap.fragment.overlap",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_msg_fragment_overlap_conflicts,\r\n{ "Message fragment overlapping with conflicting data", "capwap.fragment.overlap.conflicts",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_msg_fragment_multiple_tails,\r\n{ "Message has multiple tail fragments", "capwap.fragment.multiple_tails",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_msg_fragment_too_long_fragment,\r\n{ "Message fragment too long", "capwap.fragment.too_long_fragment",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_msg_fragment_error,\r\n{ "Message defragmentation error", "capwap.fragment.error",\r\nFT_FRAMENUM, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_msg_fragment_count,\r\n{ "Message fragment count", "capwap.fragment.count",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_msg_reassembled_in,\r\n{ "Reassembled in", "capwap.reassembled.in",\r\nFT_FRAMENUM, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_msg_reassembled_length,\r\n{ "Reassembled CAPWAP length", "capwap.reassembled.length",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n}\r\n};\r\nstatic gint *ett[] = {\r\n&ett_capwap,\r\n&ett_capwap_control,\r\n&ett_capwap_data,\r\n&ett_capwap_preamble,\r\n&ett_capwap_header,\r\n&ett_capwap_header_flags,\r\n&ett_capwap_control_header,\r\n&ett_capwap_control_header_msg,\r\n&ett_capwap_data_keep_alive,\r\n&ett_capwap_message_element,\r\n&ett_capwap_data_message_bindings_ieee80211,\r\n&ett_capwap_encryption_capabilities,\r\n&ett_capwap_encryption_capability,\r\n&ett_capwap_ac_information,\r\n&ett_capwap_wtp_descriptor,\r\n&ett_capwap_board_data,\r\n&ett_capwap_message_element_type,\r\n&ett_capwap_ac_descriptor_security_flags,\r\n&ett_capwap_ac_descriptor_dtls_flags,\r\n&ett_capwap_wtp_frame_tunnel_mode,\r\n&ett_capwap_ieee80211_add_wlan_capability,\r\n&ett_capwap_ieee80211_ie_flags,\r\n&ett_capwap_ieee80211_update_wlan_capability,\r\n&ett_capwap_ieee80211_station_capabilities,\r\n&ett_capwap_ieee80211_ofdm_control_band_support,\r\n&ett_msg_fragment,\r\n&ett_msg_fragments\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_capwap_header_length_bad, { "capwap.header.length.bad", PI_MALFORMED, PI_WARN, "Wrong calculate length =! header length", EXPFILL }},\r\n{ &ei_capwap_data_keep_alive_length, { "capwap.keep_alive.length.bad", PI_MALFORMED, PI_WARN, "Invalid Keep Alive length", EXPFILL }},\r\n{ &ei_capwap_msg_element_length, { "capwap.message_element.length.bad", PI_MALFORMED, PI_ERROR, "Bad Message Element length", EXPFILL }},\r\n{ &ei_capwap_message_element_type, { "capwap.message_element.type.undecoded", PI_UNDECODED, PI_NOTE, "Dissector for CAPWAP message element Type not implemented, Contact Wireshark developers if you want this supported", EXPFILL }},\r\n{ &ei_capwap_fortinet_mac_len, { "capwap.control.fortinet.mac.length.bad", PI_MALFORMED, PI_ERROR, "Bad length: Should be a multiple of 6", EXPFILL }},\r\n{ &ei_capwap_message_element_fortinet_type, { "capwap.message_element.type.fortinet.undecoded", PI_UNDECODED, PI_NOTE, "Dissector for CAPWAP message element Fortinet Type not implemented", EXPFILL }},\r\n{ &ei_capwap_message_element_cisco_type, { "capwap.message_element.type.fortinet.undecoded", PI_UNDECODED, PI_NOTE, "Dissector for CAPWAP message element Cisco Type not implemented", EXPFILL }}\r\n};\r\nexpert_module_t* expert_capwap;\r\nproto_capwap_control = proto_register_protocol("Control And Provisioning of Wireless Access Points - Control", "CAPWAP-CONTROL", "capwap");\r\nproto_capwap_data = proto_register_protocol("Control And Provisioning of Wireless Access Points - Data", "CAPWAP-DATA", "capwap.data");\r\nproto_register_field_array(proto_capwap_control, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_capwap = expert_register_protocol(proto_capwap_control);\r\nexpert_register_field_array(expert_capwap, ei, array_length(ei));\r\nregister_init_routine(&capwap_reassemble_init);\r\nregister_cleanup_routine(&capwap_reassemble_cleanup);\r\ncapwap_module = prefs_register_protocol(proto_capwap_control, proto_reg_handoff_capwap);\r\nprefs_register_uint_preference(capwap_module, "udp.port.control", "CAPWAP Control UDP Port",\r\n"Set the port for CAPWAP Control messages (if other than the default of 5246)",\r\n10, &global_capwap_control_udp_port);\r\nprefs_register_uint_preference(capwap_module, "udp.port.data", "CAPWAP Data UDP Port",\r\n"Set the port for CAPWAP Data messages (if other than the default of 5247)",\r\n10, &global_capwap_data_udp_port);\r\nprefs_register_bool_preference(capwap_module, "draft_8_cisco", "Cisco Wireless Controller Support",\r\n"Enable support of Cisco Wireless Controller (based on old 8 draft revision).",\r\n&global_capwap_draft_8_cisco);\r\nprefs_register_bool_preference(capwap_module, "reassemble", "Reassemble fragmented CAPWAP packets",\r\n"Reassemble fragmented CAPWAP packets.",\r\n&global_capwap_reassemble);\r\nprefs_register_bool_preference(capwap_module, "swap_fc", "Swap Frame Control",\r\n"Swap frame control bytes (needed for some APs).",\r\n&global_capwap_swap_frame_control);\r\n}\r\nvoid\r\nproto_reg_handoff_capwap(void)\r\n{\r\nstatic gboolean inited = FALSE;\r\nstatic dissector_handle_t capwap_control_handle, capwap_data_handle;\r\nstatic guint capwap_control_udp_port, capwap_data_udp_port;\r\nif (!inited) {\r\ncapwap_control_handle = create_dissector_handle(dissect_capwap_control, proto_capwap_control);\r\ncapwap_data_handle = create_dissector_handle(dissect_capwap_data, proto_capwap_data);\r\ndtls_handle = find_dissector_add_dependency("dtls", proto_capwap_control);\r\nfind_dissector_add_dependency("dtls", proto_capwap_data);\r\nieee8023_handle = find_dissector_add_dependency("eth_withoutfcs", proto_capwap_data);\r\nieee80211_handle = find_dissector_add_dependency("wlan_withoutfcs", proto_capwap_data);\r\nieee80211_bsfc_handle = find_dissector_add_dependency("wlan_bsfc", proto_capwap_data);\r\ninited = TRUE;\r\n} else {\r\ndissector_delete_uint("udp.port", capwap_control_udp_port, capwap_control_handle);\r\ndissector_delete_uint("udp.port", capwap_data_udp_port, capwap_data_handle);\r\n}\r\ndissector_add_uint("udp.port", global_capwap_control_udp_port, capwap_control_handle);\r\ndissector_add_uint("udp.port", global_capwap_data_udp_port, capwap_data_handle);\r\ncapwap_control_udp_port = global_capwap_control_udp_port;\r\ncapwap_data_udp_port = global_capwap_data_udp_port;\r\n}
