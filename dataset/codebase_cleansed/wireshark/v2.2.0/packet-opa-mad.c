static void cf_opa_mad_swinfo_ar_frequency(gchar *buf, guint16 value)\r\n{\r\ng_snprintf(buf, ITEM_LABEL_LENGTH, "%u ms", 2 ^ (value)*64);\r\n}\r\nstatic void cf_opa_mad_linkspeed(gchar *buf, guint16 value)\r\n{\r\nint len = 0;\r\nif (value & 0x1)\r\nlen = g_snprintf(buf, ITEM_LABEL_LENGTH, "12.5");\r\nif (value & 0x2)\r\nlen += g_snprintf(&buf[len], ITEM_LABEL_LENGTH - len, "%s25.78125", (len ? ", " : ""));\r\nif (len)\r\ng_snprintf(&buf[len], ITEM_LABEL_LENGTH - len, " Gbps");\r\nelse\r\ng_snprintf(buf, ITEM_LABEL_LENGTH, "No State Change");\r\n}\r\nstatic void cf_opa_mad_linkwidth(gchar *buf, guint16 value)\r\n{\r\nint len = 0;\r\nif (value & 0x1)\r\nlen = g_snprintf(buf, ITEM_LABEL_LENGTH, "1X");\r\nif (value & 0x2)\r\nlen += g_snprintf(&buf[len], ITEM_LABEL_LENGTH - len, "%s2X", (len ? ", " : ""));\r\nif (value & 0x4)\r\nlen += g_snprintf(&buf[len], ITEM_LABEL_LENGTH - len, "%s3X", (len ? ", " : ""));\r\nif (value & 0x8)\r\nlen += g_snprintf(&buf[len], ITEM_LABEL_LENGTH - len, "%s4X", (len ? ", " : ""));\r\nif (!len)\r\ng_snprintf(buf, ITEM_LABEL_LENGTH, "No State Change");\r\n}\r\nstatic void cf_opa_mad_portlinkmode(gchar *buf, guint16 value)\r\n{\r\nint len = 0;\r\nif (value & 0x1)\r\nlen = g_snprintf(buf, ITEM_LABEL_LENGTH, "Reserved");\r\nif (value & 0x2)\r\nlen += g_snprintf(&buf[len], ITEM_LABEL_LENGTH - len, "%sEthernet", (len ? ", " : ""));\r\nif (value & 0x4)\r\nlen += g_snprintf(&buf[len], ITEM_LABEL_LENGTH - len, "%sSTL", (len ? ", " : ""));\r\nif (!len)\r\ng_snprintf(buf, ITEM_LABEL_LENGTH, "No State Change");\r\n}\r\nstatic void cf_opa_mad_portltpcrcmode(gchar *buf, guint16 value)\r\n{\r\nint len = 0;\r\nif (value & 0x1)\r\nlen = g_snprintf(buf, ITEM_LABEL_LENGTH, "14-bit");\r\nif (value & 0x2)\r\nlen += g_snprintf(&buf[len], ITEM_LABEL_LENGTH - len, "%s16-bit", (len ? ", " : ""));\r\nif (value & 0x4)\r\nlen += g_snprintf(&buf[len], ITEM_LABEL_LENGTH - len, "%s48-bit overlapping", (len ? ", " : ""));\r\nif (value & 0x8)\r\nlen += g_snprintf(&buf[len], ITEM_LABEL_LENGTH - len, "%s[12,16]-bit per lane", (len ? ", " : ""));\r\nif (len)\r\ng_snprintf(&buf[len], ITEM_LABEL_LENGTH - len, " LTP CRC Mode");\r\nelse\r\ng_snprintf(buf, ITEM_LABEL_LENGTH, "No State Change");\r\n}\r\nstatic void cf_opa_mad_packetformat(gchar *buf, guint16 value)\r\n{\r\nint len = 0;\r\nif (value & 0x1)\r\nlen = g_snprintf(buf, ITEM_LABEL_LENGTH, "8B");\r\nif (value & 0x2)\r\nlen += g_snprintf(&buf[len], ITEM_LABEL_LENGTH - len, "%s9B", (len ? ", " : ""));\r\nif (value & 0x4)\r\nlen += g_snprintf(&buf[len], ITEM_LABEL_LENGTH - len, "%s10B", (len ? ", " : ""));\r\nif (value & 0x8)\r\nlen += g_snprintf(&buf[len], ITEM_LABEL_LENGTH - len, "%s16B", (len ? ", " : ""));\r\nif (len)\r\ng_snprintf(&buf[len], ITEM_LABEL_LENGTH - len, " Format%s", (len > 4 ? "s" : ""));\r\nelse\r\ng_snprintf(buf, ITEM_LABEL_LENGTH, "No State Change");\r\n}\r\nstatic void cf_opa_mad_swcongestionsetting_controlmap(gchar *buf, guint32 value)\r\n{\r\nint len = 0;\r\nif (value & 0x1)\r\nlen = g_snprintf(buf, ITEM_LABEL_LENGTH, "Victim");\r\nif (value & 0x2)\r\nlen += g_snprintf(&buf[len], ITEM_LABEL_LENGTH - len, "%sCredit", (len ? ", " : ""));\r\nif (value & 0x4)\r\nlen += g_snprintf(&buf[len], ITEM_LABEL_LENGTH - len, "%sThresold & PacketSize", (len ? ", " : ""));\r\nif (value & 0x8)\r\nlen += g_snprintf(&buf[len], ITEM_LABEL_LENGTH - len, "%sCS_threshold & CS_ReturnDelay", (len ? ", " : ""));\r\nif (value & 0x10)\r\nlen += g_snprintf(&buf[len], ITEM_LABEL_LENGTH - len, "%sMarking Rate", (len ? ", " : ""));\r\nif (!len)\r\ng_snprintf(buf, ITEM_LABEL_LENGTH, "No Valid Fields");\r\n}\r\nstatic void cf_opa_mad_32b_mask(gchar *buf, guint32 value)\r\n{\r\nint len = 0;\r\nguint32 i, mask;\r\nfor (i = 0, mask = value; mask && i < 32 && len < ITEM_LABEL_LENGTH; i++, mask >>= 1) {\r\nif (mask & 1) {\r\nlen += g_snprintf(&buf[len], ITEM_LABEL_LENGTH - len, "%s%u", (len ? ", " : ""), i);\r\n}\r\n}\r\nif (!len) {\r\ng_snprintf(buf, ITEM_LABEL_LENGTH, " ");\r\n}\r\n}\r\nstatic void cf_opa_mad_computed_pct10(gchar *buf, guint16 value)\r\n{\r\ng_snprintf(buf, ITEM_LABEL_LENGTH, "%u.%01u", value / 10, value % 10);\r\n}\r\nstatic gint parse_MAD_AttributeModifier(proto_tree *MAD_tree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\nproto_tree *AttributeModifier_tree;\r\nproto_item *AttributeModifier_item;\r\ngint local_offset = *offset;\r\nAttributeModifier_item = proto_tree_add_item(MAD_tree, hf_opa_attribute_modifier, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nAttributeModifier_tree = proto_item_add_subtree(AttributeModifier_item, ett_mad_attributemod);\r\nswitch (MAD->MgmtClass) {\r\ncase SUBN_LID_ROUTED:\r\ncase SUBN_DIRECTED_ROUTE:\r\nswitch (MAD->AttributeID) {\r\ncase SM_ATTR_ID_CLASS_PORT_INFO:\r\ncase SM_ATTR_ID_NOTICE:\r\ncase SM_ATTR_ID_NODE_DESCRIPTION:\r\ncase SM_ATTR_ID_NODE_INFO:\r\ncase SM_ATTR_ID_SWITCH_INFO:\r\ncase SM_ATTR_ID_SL_SC_MAPPING_TABLE:\r\ncase SM_ATTR_ID_SC_SL_MAPPING_TABLE:\r\ncase SM_ATTR_ID_SM_INFO:\r\ncase SM_ATTR_ID_CONGESTION_INFO:\r\ncase SM_ATTR_ID_SWITCH_CONGESTION_LOG:\r\ncase SM_ATTR_ID_SWITCH_CONGESTION_SETTING:\r\ncase SM_ATTR_ID_HFI_CONGESTION_LOG:\r\ncase SM_ATTR_ID_HFI_CONGESTION_SETTING:\r\nif (MAD->AttributeModifier)\r\nexpert_add_info(NULL, AttributeModifier_item, &ei_opa_mad_attribute_modifier_error_nonzero);\r\nbreak;\r\ncase SM_ATTR_ID_PORT_INFO:\r\nproto_tree_add_bitmask_list(AttributeModifier_tree, tvb, local_offset, 4, _attribute_modifier_Nps2AP, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase SM_ATTR_ID_PORT_STATE_INFO:\r\nproto_tree_add_bitmask_list(AttributeModifier_tree, tvb, local_offset, 4, _attribute_modifier_NpS2P, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase SM_ATTR_ID_LED_INFO:\r\ncase SM_ATTR_ID_BUFFER_CONTROL_TABLE:\r\nproto_tree_add_bitmask_list(AttributeModifier_tree, tvb, local_offset, 4, _attribute_modifier_NpAP, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase SM_ATTR_ID_PART_TABLE:\r\nproto_tree_add_bitmask_list(AttributeModifier_tree, tvb, local_offset, 4, _attribute_modifier_NbP2B, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase SM_ATTR_ID_SC_SC_MAPPING_TABLE:\r\nproto_tree_add_bitmask_list(AttributeModifier_tree, tvb, local_offset, 4, _attribute_modifier_NbA2B2IE, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase SM_ATTR_ID_VL_ARBITRATION:\r\nproto_tree_add_bitmask_list(AttributeModifier_tree, tvb, local_offset, 4, _attribute_modifier_NpSAP, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase SM_ATTR_ID_LINEAR_FWD_TABLE:\r\ncase SM_ATTR_ID_PORT_GROUP_FWD_TABLE:\r\nproto_tree_add_bitmask_list(AttributeModifier_tree, tvb, local_offset, 4, _attribute_modifier_NbA3B3, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase SM_ATTR_ID_MCAST_FWD_TABLE:\r\nproto_tree_add_bitmask_list(AttributeModifier_tree, tvb, local_offset, 4, _attribute_modifier_NbP3A4B4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase SM_ATTR_ID_CABLE_INFO:\r\nproto_tree_add_bitmask_list(AttributeModifier_tree, tvb, local_offset, 4, _attribute_modifier_A5LP, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase SM_ATTR_ID_AGGREGATE:\r\nproto_tree_add_item(AttributeModifier_tree, hf_opa_attribute_modifier_N2, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase SM_ATTR_ID_SC_VLR_MAPPING_TABLE:\r\ncase SM_ATTR_ID_SC_VLT_MAPPING_TABLE:\r\ncase SM_ATTR_ID_SC_VLNT_MAPPING_TABLE:\r\nproto_tree_add_bitmask_list(AttributeModifier_tree, tvb, local_offset, 4, _attribute_modifier_NbYAP, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase SM_ATTR_ID_SWITCH_PORT_CONGESTION_SETTING:\r\nproto_tree_add_bitmask_list(AttributeModifier_tree, tvb, local_offset, 4, _attribute_modifier_NpP, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase SM_ATTR_ID_HFI_CONGESTION_CONTROL_TABLE:\r\nproto_tree_add_bitmask_list(AttributeModifier_tree, tvb, local_offset, 4, _attribute_modifier_NbP, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase SM_ATTR_ID_PORT_GROUP_TABLE:\r\nproto_tree_add_bitmask_list(AttributeModifier_tree, tvb, local_offset, 4, _attribute_modifier_NbP3A6B5, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nif (MAD->AttributeModifier)\r\nexpert_add_info(NULL, AttributeModifier_item, &ei_opa_mad_attribute_modifier_error_nonzero);\r\nbreak;\r\n}\r\nbreak;\r\ncase PERF:\r\nswitch (MAD->AttributeID) {\r\ncase PM_ATTR_ID_CLASS_PORTINFO:\r\nif (MAD->AttributeModifier)\r\nexpert_add_info(NULL, AttributeModifier_item, &ei_opa_mad_attribute_modifier_error_nonzero);\r\nbreak;\r\ncase PM_ATTR_ID_PORT_STATUS:\r\ncase PM_ATTR_ID_CLEAR_PORT_STATUS:\r\ncase PM_ATTR_ID_DATA_PORT_COUNTERS:\r\ncase PM_ATTR_ID_ERROR_PORT_COUNTERS:\r\nproto_tree_add_item(AttributeModifier_tree, hf_opa_attribute_modifier_NP, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase PM_ATTR_ID_ERROR_INFO:\r\ndefault:\r\nif (MAD->AttributeModifier)\r\nexpert_add_info(NULL, AttributeModifier_item, &ei_opa_mad_attribute_modifier_error_nonzero);\r\nbreak;\r\n}\r\nbreak;\r\ncase PERFADMN:\r\ncase SUBNADMN:\r\ndefault:\r\nif (MAD->AttributeModifier)\r\nexpert_add_info(NULL, AttributeModifier_item, &ei_opa_mad_attribute_modifier_error_nonzero);\r\nbreak;\r\n}\r\nreturn local_offset += 4;\r\n}\r\nstatic gboolean parse_MAD_Common(proto_tree *parentTree, packet_info *pinfo, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *MAD_header_item;\r\nproto_tree *MAD_header_tree;\r\nproto_item *MAD_Status_item;\r\nif (MAD == NULL) {\r\nreturn FALSE;\r\n}\r\nMAD_header_item = proto_tree_add_item(parentTree, hf_opa_mad, tvb, local_offset, 24, ENC_NA);\r\nMAD_header_tree = proto_item_add_subtree(MAD_header_item, ett_mad);\r\nproto_tree_add_item(MAD_header_tree, hf_opa_mad_base_version, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nMAD->BaseVersion = tvb_get_guint8(tvb, local_offset);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MAD_header_tree, hf_opa_mad_mgmt_class, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nMAD->MgmtClass = tvb_get_guint8(tvb, local_offset);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MAD_header_tree, hf_opa_mad_class_version, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nMAD->ClassVersion = tvb_get_guint8(tvb, local_offset);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MAD_header_tree, hf_opa_mad_method, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nMAD->Method = tvb_get_guint8(tvb, local_offset);\r\nlocal_offset += 1;\r\nif (MAD->MgmtClass == SUBN_DIRECTED_ROUTE) {\r\nproto_tree_add_item(MAD_header_tree, hf_opa_mad_status_DR_D, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nMAD_Status_item = proto_tree_add_item(MAD_header_tree, hf_opa_mad_status_DR_status, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nMAD->Status = tvb_get_ntohs(tvb, local_offset);\r\nlocal_offset += 2;\r\nif (MAD->Status & 0x7FFF) {\r\nproto_item_append_text(MAD_header_item, " Error: 0x%04x", MAD->Status & 0x7FFF);\r\nexpert_add_info_format(pinfo, MAD_Status_item, &ei_opa_mad_error,\r\n"Mad Status Error (0x%04x)", MAD->Status & 0x7FFF);\r\n}\r\nproto_tree_add_item(MAD_header_tree, hf_opa_mad_status_DR_Hop_Pointer, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nMAD->HopPointer = tvb_get_guint8(tvb, local_offset);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MAD_header_tree, hf_opa_mad_status_DR_Hop_Count, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nMAD->HopCount = tvb_get_guint8(tvb, local_offset);\r\nlocal_offset += 1;\r\n} else {\r\nMAD_Status_item = proto_tree_add_bitmask(MAD_header_tree, tvb, local_offset,\r\nhf_opa_mad_status, ett_mad_status, _mad_status, ENC_BIG_ENDIAN);\r\nMAD->Status = tvb_get_ntohs(tvb, local_offset);\r\nlocal_offset += 2;\r\nif (MAD->Status) {\r\nproto_item_append_text(MAD_header_item, " Error: 0x%04x", MAD->Status);\r\nexpert_add_info_format(pinfo, MAD_Status_item, &ei_opa_mad_error,\r\n"Mad Status Error (0x%04x)", MAD->Status);\r\n}\r\nproto_tree_add_item(MAD_header_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\n}\r\nproto_tree_add_item(MAD_header_tree, hf_opa_mad_transaction_id, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nMAD->TransactionID = tvb_get_ntoh64(tvb, local_offset);\r\nlocal_offset += 8;\r\nproto_tree_add_item(MAD_header_tree, hf_opa_mad_attribute_id, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nMAD->AttributeID = tvb_get_ntohs(tvb, local_offset);\r\nlocal_offset += 2;\r\nproto_tree_add_item(MAD_header_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nMAD->AttributeModifier = tvb_get_ntohl(tvb, local_offset);\r\n*offset = parse_MAD_AttributeModifier(MAD_header_tree, tvb, &local_offset, MAD);\r\nreturn TRUE;\r\n}\r\nstatic gboolean parse_RMPP(proto_tree *parentTree, packet_info *pinfo, tvbuff_t *tvb, gint *offset, RMPP_t *RMPP)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *RMPP_header_item;\r\nproto_item *RMPP_type_item;\r\nproto_item *RMPP_segment_number_item;\r\nproto_tree *RMPP_header_tree;\r\nRMPP_header_item = proto_tree_add_item(parentTree, hf_opa_rmpp, tvb, local_offset, 12, ENC_NA);\r\nRMPP_header_tree = proto_item_add_subtree(RMPP_header_item, ett_rmpp);\r\nproto_tree_add_item(RMPP_header_tree, hf_opa_rmpp_version, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nRMPP->Version = tvb_get_guint8(tvb, local_offset);\r\nlocal_offset += 1;\r\nRMPP_type_item = proto_tree_add_item(RMPP_header_tree, hf_opa_rmpp_type, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nRMPP->Type = tvb_get_guint8(tvb, local_offset);\r\nlocal_offset += 1;\r\nproto_tree_add_item(RMPP_header_tree, hf_opa_rmpp_r_resp_time, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(RMPP_header_tree, hf_opa_rmpp_flags_last, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(RMPP_header_tree, hf_opa_rmpp_flags_first, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(RMPP_header_tree, hf_opa_rmpp_flags_active, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nRMPP->resptime_flags = tvb_get_guint8(tvb, local_offset);\r\nlocal_offset += 1;\r\nproto_tree_add_item(RMPP_header_tree, hf_opa_rmpp_status, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nRMPP->Status = tvb_get_guint8(tvb, local_offset);\r\nlocal_offset += 1;\r\nif (!(RMPP->resptime_flags & RMPP_FLAG_ACTIVE_MASK) && RMPP->Type == RMPP_ILLEGAL) {\r\nproto_item_set_text(RMPP_header_item, "%s%s", "RMPP (Empty)", " - Reliable Multi-Packet Transaction Protocol");\r\nproto_item_append_text(RMPP_type_item, " %s", "RMPP (Empty)");\r\n} else {\r\nproto_item_set_text(RMPP_header_item, "%s%s", val_to_str(RMPP->Type, RMPP_Packet_Types, "RMPP (Reserved 0x%02x)"), " - Reliable Multi-Packet Transaction Protocol");\r\nproto_item_append_text(RMPP_type_item, " %s", val_to_str(RMPP->Type, RMPP_Packet_Types, "RMPP (Reserved 0x%02x)"));\r\n}\r\nRMPP->PayloadLength = 0;\r\nswitch (RMPP->Type) {\r\ncase RMPP_ILLEGAL:\r\nproto_tree_add_item(RMPP_header_tree, hf_opa_rmpp_data1, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(RMPP_header_tree, hf_opa_rmpp_data2, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nbreak;\r\ncase RMPP_DATA:\r\nRMPP_segment_number_item = proto_tree_add_item(RMPP_header_tree, hf_opa_rmpp_segment_number, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nRMPP->SegmentNumber = tvb_get_ntohl(tvb, local_offset);\r\nif (RMPP->SegmentNumber > 1) {\r\nexpert_add_info_format(pinfo, RMPP_segment_number_item, &ei_opa_rmpp_undecoded,\r\n"Parsing Disabled for RMPP Data Segments greater than 1 (%u)", RMPP->SegmentNumber);\r\n}\r\nlocal_offset += 4;\r\nproto_tree_add_item(RMPP_header_tree, hf_opa_rmpp_payload_length32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nRMPP->PayloadLength = tvb_get_ntohl(tvb, local_offset);\r\nlocal_offset += 4;\r\nbreak;\r\ncase RMPP_ACK:\r\nproto_tree_add_item(RMPP_header_tree, hf_opa_rmpp_segment_number, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(RMPP_header_tree, hf_opa_rmpp_new_window_last, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nbreak;\r\ncase RMPP_STOP:\r\ncase RMPP_ABORT:\r\nproto_tree_add_item(RMPP_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_NA);\r\nlocal_offset += 4;\r\nproto_tree_add_item(RMPP_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_NA);\r\nlocal_offset += 4;\r\nbreak;\r\ndefault:\r\nreturn FALSE;\r\n}\r\n*offset = local_offset;\r\nreturn TRUE;\r\n}\r\nstatic gint parse_NoticeDataDetails(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, guint16 trapNumber)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *DataDetails_header_item;\r\nproto_tree *DataDetails_header_tree;\r\nif (!parentTree)\r\nreturn 0;\r\nDataDetails_header_item = proto_tree_add_item(parentTree, hf_opa_Trap, tvb, local_offset, 64, ENC_NA);\r\nDataDetails_header_tree = proto_item_add_subtree(DataDetails_header_item, ett_datadetails);\r\nproto_item_append_text(DataDetails_header_item, " %u DataDetails", trapNumber);\r\nswitch (trapNumber) {\r\ncase 64:\r\ncase 65:\r\ncase 66:\r\ncase 67:\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_GID, tvb, local_offset, 16, ENC_NA);\r\nlocal_offset += 16;\r\nbreak;\r\ncase 128:\r\ncase 2048:\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_LID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nbreak;\r\ncase 129:\r\ncase 130:\r\ncase 131:\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_LID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_PORTNO, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nbreak;\r\ncase 144:\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_LID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_CAPABILITYMASK, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_CAPABILITYMASK3, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_reserved8, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_144_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_LinkWidthDowngradeEnabledChange, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_LinkSpeecEnabledChange, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_LinkWidthEnabledChange, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_NodeDescriptionChange, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nbreak;\r\ncase 145:\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_SystemImageGUID, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_LID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nbreak;\r\ncase 256:\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_LID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_DRSLID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_Method, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_DRNotice, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_DRPathTruncated, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_DRHopCount, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_AttributeID, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_AttributeModifier, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_MKey, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_DRNoticeReturnPath, tvb, local_offset, 30, ENC_NA);\r\nlocal_offset += 30;\r\nbreak;\r\ncase 257:\r\ncase 258:\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_LID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_LID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_Key, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_SL, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_SL_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_reserved24, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_GID, tvb, local_offset, 16, ENC_NA);\r\nlocal_offset += 16;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_GID, tvb, local_offset, 16, ENC_NA);\r\nlocal_offset += 16;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_reserved8, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_QP, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_reserved8, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_QP, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nbreak;\r\ncase 259:\r\nproto_tree_add_bitmask(DataDetails_header_tree, tvb, local_offset, hf_opa_Trap_DataValid,\r\nett_datadetails_trap259datavalid, _Trap_DataValid, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_PKey, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_LID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_LID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_SL, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_SL_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_reserved24, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_GID, tvb, local_offset, 16, ENC_NA);\r\nlocal_offset += 16;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_GID, tvb, local_offset, 16, ENC_NA);\r\nlocal_offset += 16;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_QP, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_reserved8, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_Trap_QP, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(DataDetails_header_tree, hf_opa_reserved8, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_NoticesAndTraps(proto_tree *parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *NoticesAndTraps_header_item;\r\nproto_tree *NoticesAndTraps_header_tree;\r\ngboolean isGeneric = tvb_get_bits8(tvb, local_offset * 8, 1);\r\nguint16 trapNumber = tvb_get_ntohs(tvb, local_offset + 4);\r\nif (!parentTree)\r\nreturn *offset;\r\nNoticesAndTraps_header_item = proto_tree_add_item(parentTree, hf_opa_Notice, tvb, local_offset, 64, ENC_NA);\r\nproto_item_set_text(NoticesAndTraps_header_item, "%s", val_to_str(trapNumber, Trap_Description, "Unknown or Vendor Specific Trap Number! (0x%02x)"));\r\nNoticesAndTraps_header_tree = proto_item_add_subtree(NoticesAndTraps_header_item, ett_noticestraps);\r\nproto_tree_add_item(NoticesAndTraps_header_tree, hf_opa_Notice_IsGeneric, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(NoticesAndTraps_header_tree, hf_opa_Notice_Type, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nif (isGeneric) {\r\nproto_tree_add_item(NoticesAndTraps_header_tree, hf_opa_Notice_ProducerType, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(NoticesAndTraps_header_tree, hf_opa_Notice_TrapNumber, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\n} else {\r\nproto_tree_add_item(NoticesAndTraps_header_tree, hf_opa_Notice_VendorID, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(NoticesAndTraps_header_tree, hf_opa_Notice_DeviceID, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\n}\r\nproto_tree_add_item(NoticesAndTraps_header_tree, hf_opa_Notice_Toggle, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(NoticesAndTraps_header_tree, hf_opa_Notice_Count, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(NoticesAndTraps_header_tree, hf_opa_Notice_IssuerLID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(NoticesAndTraps_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(NoticesAndTraps_header_tree, hf_opa_Notice_IssuerGID, tvb, local_offset, 16, ENC_NA);\r\nlocal_offset += 16;\r\nparse_NoticeDataDetails(NoticesAndTraps_header_tree, tvb, &local_offset, trapNumber);\r\nlocal_offset += 64;\r\nproto_tree_add_item(NoticesAndTraps_header_tree, hf_opa_Notice_ClassDataDetails, tvb, local_offset, -1, ENC_NA);\r\nreturn local_offset;\r\n}\r\nstatic gint parse_InformInfo(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *InformInfo_header_item;\r\nproto_tree *InformInfo_header_tree;\r\ngboolean isGeneric;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nInformInfo_header_item = proto_tree_add_item(parentTree, hf_opa_InformInfo, tvb, local_offset, 36, ENC_NA);\r\nInformInfo_header_tree = proto_item_add_subtree(InformInfo_header_item, ett_informinfo);\r\nproto_tree_add_item(InformInfo_header_tree, hf_opa_InformInfo_GID, tvb, local_offset, 16, ENC_NA);\r\nlocal_offset += 16;\r\nproto_tree_add_item(InformInfo_header_tree, hf_opa_InformInfo_LIDRangeBegin, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(InformInfo_header_tree, hf_opa_InformInfo_LIDRangeEnd, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nisGeneric = (gboolean)tvb_get_bits8(tvb, local_offset * 8 + 7, 1);\r\nproto_tree_add_item(InformInfo_header_tree, hf_opa_InformInfo_IsGeneric, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(InformInfo_header_tree, hf_opa_InformInfo_Subscribe, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(InformInfo_header_tree, hf_opa_InformInfo_Type, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(InformInfo_header_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nif (isGeneric) {\r\nproto_tree_add_item(InformInfo_header_tree, hf_opa_InformInfo_TrapNumber, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\n} else {\r\nproto_tree_add_item(InformInfo_header_tree, hf_opa_InformInfo_DeviceID, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\n}\r\nproto_tree_add_item(InformInfo_header_tree, hf_opa_InformInfo_QPN, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(InformInfo_header_tree, hf_opa_InformInfo_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(InformInfo_header_tree, hf_opa_InformInfo_RespTimeValue, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nlocal_offset += 1;\r\nproto_tree_add_item(InformInfo_header_tree, hf_opa_reserved8, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nif (isGeneric) {\r\nproto_tree_add_item(InformInfo_header_tree, hf_opa_InformInfo_ProducerType, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\n} else {\r\nproto_tree_add_item(InformInfo_header_tree, hf_opa_InformInfo_VendorID, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_ClassPortInfo(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\nproto_item *ClassPortInfo_item;\r\nproto_tree *ClassPortInfo_tree;\r\nproto_tree *ClassPortInfo_Redirect_tree;\r\nproto_tree *ClassPortInfo_Trap_tree;\r\ngint local_offset = *offset;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nClassPortInfo_item = proto_tree_add_item(parentTree, hf_opa_ClassPortInfo, tvb, local_offset, 80, ENC_NA);\r\nClassPortInfo_tree = proto_item_add_subtree(ClassPortInfo_item, ett_classportinfo);\r\nproto_tree_add_item(ClassPortInfo_tree, hf_opa_ClassPortInfo_BaseVersion, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(ClassPortInfo_tree, hf_opa_ClassPortInfo_ClassVersion, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(ClassPortInfo_tree, hf_opa_ClassPortInfo_CapMask, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(ClassPortInfo_tree, hf_opa_ClassPortInfo_CapMask2, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ClassPortInfo_tree, hf_opa_ClassPortInfo_RespTimeValue, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nClassPortInfo_Redirect_tree = proto_tree_add_subtree(ClassPortInfo_tree, tvb, local_offset, 32,\r\nett_classportinfo_redirect, NULL, "Redirect");\r\nproto_tree_add_item(ClassPortInfo_Redirect_tree, hf_opa_ClassPortInfo_Redirect_GID, tvb, local_offset, 16, ENC_NA);\r\nlocal_offset += 16;\r\nproto_tree_add_item(ClassPortInfo_Redirect_tree, hf_opa_ClassPortInfo_Redirect_TClass, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(ClassPortInfo_Redirect_tree, hf_opa_ClassPortInfo_Redirect_reserved, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ClassPortInfo_Redirect_tree, hf_opa_ClassPortInfo_Redirect_FlowLabel, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(ClassPortInfo_Redirect_tree, hf_opa_ClassPortInfo_Redirect_LID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(ClassPortInfo_Redirect_tree, hf_opa_ClassPortInfo_Redirect_SL, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ClassPortInfo_Redirect_tree, hf_opa_ClassPortInfo_Redirect_reserved2, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(ClassPortInfo_Redirect_tree, hf_opa_ClassPortInfo_Redirect_QP, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(ClassPortInfo_Redirect_tree, hf_opa_ClassPortInfo_Redirect_Q_Key, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nClassPortInfo_Trap_tree = proto_tree_add_subtree(ClassPortInfo_tree, tvb, local_offset, 32,\r\nett_classportinfo_trap, NULL, "Trap");\r\nproto_tree_add_item(ClassPortInfo_Trap_tree, hf_opa_ClassPortInfo_Trap_GID, tvb, local_offset, 16, ENC_NA);\r\nlocal_offset += 16;\r\nproto_tree_add_item(ClassPortInfo_Trap_tree, hf_opa_ClassPortInfo_Trap_TClass, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(ClassPortInfo_Trap_tree, hf_opa_ClassPortInfo_Trap_reserved, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ClassPortInfo_Trap_tree, hf_opa_ClassPortInfo_Trap_FlowLabel, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(ClassPortInfo_Trap_tree, hf_opa_ClassPortInfo_Trap_LID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(ClassPortInfo_Trap_tree, hf_opa_ClassPortInfo_Trap_HopLimit, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(ClassPortInfo_Trap_tree, hf_opa_ClassPortInfo_Trap_QP, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(ClassPortInfo_Trap_tree, hf_opa_ClassPortInfo_Trap_Q_Key, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(ClassPortInfo_Trap_tree, hf_opa_ClassPortInfo_Trap_P_Key, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(ClassPortInfo_Redirect_tree, hf_opa_ClassPortInfo_Redirect_P_Key, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(ClassPortInfo_Trap_tree, hf_opa_ClassPortInfo_Trap_SL, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ClassPortInfo_Trap_tree, hf_opa_ClassPortInfo_Trap_reserved2, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(ClassPortInfo_tree, hf_opa_reserved24, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nreturn local_offset;\r\n}\r\nstatic gint parse_NodeDescription(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_tree *NodeDescription_header_tree = parentTree;\r\nproto_item *NodeDescription_header_item;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nNodeDescription_header_item = proto_tree_add_item(NodeDescription_header_tree, hf_opa_NodeDescription, tvb, local_offset, 64, ENC_NA);\r\nNodeDescription_header_tree = proto_item_add_subtree(NodeDescription_header_item, ett_nodedescription);\r\nproto_tree_add_item(NodeDescription_header_tree, hf_opa_NodeDescription_NodeString, tvb, local_offset, 64, ENC_ASCII | ENC_NA);\r\nlocal_offset += 64;\r\nreturn local_offset;\r\n}\r\nstatic gint parse_NodeInfo(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_tree *NodeInfo_header_tree = parentTree;\r\nproto_item *NodeInfo_header_item;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nNodeInfo_header_item = proto_tree_add_item(NodeInfo_header_tree, hf_opa_NodeInfo, tvb, local_offset, 44, ENC_NA);\r\nNodeInfo_header_tree = proto_item_add_subtree(NodeInfo_header_item, ett_nodeinfo);\r\nproto_tree_add_item(NodeInfo_header_tree, hf_opa_NodeInfo_BaseVersion, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(NodeInfo_header_tree, hf_opa_NodeInfo_ClassVersion, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(NodeInfo_header_tree, hf_opa_NodeInfo_NodeType, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(NodeInfo_header_tree, hf_opa_NodeInfo_NumPorts, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(NodeInfo_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(NodeInfo_header_tree, hf_opa_NodeInfo_SystemImageGUID, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(NodeInfo_header_tree, hf_opa_NodeInfo_NodeGUID, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(NodeInfo_header_tree, hf_opa_NodeInfo_PortGUID, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(NodeInfo_header_tree, hf_opa_NodeInfo_PartitionCap, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(NodeInfo_header_tree, hf_opa_NodeInfo_DeviceID, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(NodeInfo_header_tree, hf_opa_NodeInfo_Revision, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(NodeInfo_header_tree, hf_opa_NodeInfo_LocalPortNum, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(NodeInfo_header_tree, hf_opa_NodeInfo_VendorID, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nreturn local_offset;\r\n}\r\nstatic gint parse_SwitchInfo(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_tree *SwitchInfo_header_tree = parentTree;\r\nproto_item *SwitchInfo_header_item;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nSwitchInfo_header_item = proto_tree_add_item(SwitchInfo_header_tree, hf_opa_SwitchInfo, tvb, local_offset, 84, ENC_NA);\r\nSwitchInfo_header_tree = proto_item_add_subtree(SwitchInfo_header_item, ett_switchinfo);\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_SwitchInfo_LinearFDBCap, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_SwitchInfo_MulticastFDBCap, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_SwitchInfo_LinearFDBTop, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_SwitchInfo_MulticastFDBTop, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_SwitchInfo_CollectiveCap, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_SwitchInfo_CollectiveTop, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_SwitchInfo_IPAddrIPv6, tvb, local_offset, 16, ENC_NA);\r\nlocal_offset += 16;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_SwitchInfo_IPAddrIPv4, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_reserved24, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_SwitchInfo_LifeTimeValue, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_SwitchInfo_PortStateChange, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_SwitchInfo_reserved2, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_SwitchInfo_PartitionEnforcementCap, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_SwitchInfo_PortGroupCap, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_SwitchInfo_PortGroupTop, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_SwitchInfo_SupportedRoutingMode, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_SwitchInfo_EnabledRoutingMode, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_SwitchInfo_reserved3, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_SwitchInfo_EnhancedPortZero, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_SwitchInfo_reserved4, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_SwitchInfo_reserved5, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_SwitchInfo_CollectiveMask, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_SwitchInfo_MulticastMask, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_bitmask_list(SwitchInfo_header_tree, tvb, local_offset, 2,\r\n_SwitchInfo_AdaptiveRouting, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_bitmask(SwitchInfo_header_tree, tvb, local_offset, hf_opa_SwitchInfo_SwitchCapabilityMask,\r\nett_switchinfo_switchcapabilitymask, _SwitchInfo_SwitchCapabilityMask, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_opa_SwitchInfo_CapabilityMaskCollectives, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nreturn local_offset;\r\n}\r\nstatic gint parse_PortInfo(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_tree *PortInfo_header_tree = parentTree,\r\n*PortInfo_VL_tree,\r\n*PortInfo_Link_tree,\r\n*PortInfo_FlitControl_tree,\r\n*PortInfo_NeighborMTU_tree,\r\n*PortInfo_XmitQ_tree;\r\nproto_item * PortInfo_header_item,\r\n*PortInfo_PortWdthSpeedActive_item;\r\nproto_item *temp_item;\r\nguint p, i, Num_ports, Port_num;\r\nguint16 active;\r\nNum_ports = (MAD->AttributeModifier & 0xFF000000) >> 24;\r\nPort_num = (MAD->AttributeModifier & 0x000000FF);\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nfor (p = Port_num; p < (Port_num + Num_ports); p++) {\r\nPortInfo_header_item = proto_tree_add_item(parentTree, hf_opa_PortInfo, tvb, local_offset, 242, ENC_NA);\r\nproto_item_set_text(PortInfo_header_item, "PortInfo on Port %d", p);\r\nPortInfo_header_tree = proto_item_add_subtree(PortInfo_header_item, ett_portinfo);\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_LID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_FlowControlMask, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nPortInfo_VL_tree = proto_tree_add_subtree(PortInfo_header_tree, tvb, local_offset, 8,\r\nett_portinfo_vl, NULL, "VL Info");\r\nproto_tree_add_item(PortInfo_VL_tree, hf_opa_PortInfo_VL_PreemptCap, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortInfo_VL_tree, hf_opa_PortInfo_VL_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_VL_tree, hf_opa_PortInfo_VL_Cap, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortInfo_VL_tree, hf_opa_PortInfo_VL_HighLimit, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PortInfo_VL_tree, hf_opa_PortInfo_VL_PreemptingLimit, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PortInfo_VL_tree, hf_opa_PortInfo_VL_ArbitrationHighCap, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortInfo_VL_tree, hf_opa_PortInfo_VL_ArbitrationLowCap, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_bitmask_list(PortInfo_header_tree, tvb, local_offset, 4, _PortStates, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_PortPhysConfig_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_PortPhysConfig_PortType, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_MultiCollectMask_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_MultiCollectMask_CollectiveMask, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_MultiCollectMask_MulticastMask, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_M_KeyProtectBits, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_S1_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_LMC, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_S2_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_MasterSMSL, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_LinkInitReason, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_PartitionEnforcementInbound, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_PartitionEnforcementOutbound, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_S3_reserved2, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_S4_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_OperationalVL, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_P_Keys_P_Key_8B, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_P_Keys_P_Key_10B, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_M_KeyViolations, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_P_KeyViolations, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_Q_KeyViolations, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_TrapQueuePair_reserved, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_TrapQueuePair, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_SAQueuePair_reserved, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_SAQueuePair, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_NeighborPortNum, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_LinkDownReason, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_NeighborLinkDownReason, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_ClientRegister, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_MulticastPKeyTrapSuppressEnabled, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_Timeout, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nPortInfo_Link_tree = proto_tree_add_subtree(PortInfo_header_tree, tvb, local_offset, 22,\r\nett_portinfo_link, NULL, "Link Info");\r\nproto_tree_add_item(PortInfo_Link_tree, hf_opa_PortInfo_LinkSpeedSupported, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PortInfo_Link_tree, hf_opa_PortInfo_LinkSpeedEnabled, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nactive = tvb_get_ntohs(tvb, local_offset);\r\nPortInfo_PortWdthSpeedActive_item = proto_tree_add_item(PortInfo_Link_tree, hf_opa_PortInfo_LinkSpeedActive, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nif (!active && (MAD->Method == METHOD_GET_RESP || MAD->Method == METHOD_GETTABLE_RESP))\r\nproto_item_set_text(PortInfo_PortWdthSpeedActive_item, "None");\r\nproto_tree_add_item(PortInfo_Link_tree, hf_opa_PortInfo_LinkWidthSupported, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PortInfo_Link_tree, hf_opa_PortInfo_LinkWidthEnabled, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nactive = tvb_get_ntohs(tvb, local_offset);\r\nPortInfo_PortWdthSpeedActive_item = proto_tree_add_item(PortInfo_Link_tree, hf_opa_PortInfo_LinkWidthActive, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nif (!active && (MAD->Method == METHOD_GET_RESP || MAD->Method == METHOD_GETTABLE_RESP))\r\nproto_item_set_text(PortInfo_PortWdthSpeedActive_item, "None");\r\nproto_tree_add_item(PortInfo_Link_tree, hf_opa_PortInfo_LinkWidthDowngrade_Supported, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PortInfo_Link_tree, hf_opa_PortInfo_LinkWidthDowngrade_Enabled, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nactive = tvb_get_ntohs(tvb, local_offset);\r\nPortInfo_PortWdthSpeedActive_item = proto_tree_add_item(PortInfo_Link_tree, hf_opa_PortInfo_LinkWidthDowngrade_TxActive, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nif (!active && (MAD->Method == METHOD_GET_RESP || MAD->Method == METHOD_GETTABLE_RESP))\r\nproto_item_set_text(PortInfo_PortWdthSpeedActive_item, "None");;\r\nactive = tvb_get_ntohs(tvb, local_offset);\r\nPortInfo_PortWdthSpeedActive_item = proto_tree_add_item(PortInfo_Link_tree, hf_opa_PortInfo_LinkWidthDowngrade_RxActive, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nif (!active && (MAD->Method == METHOD_GET_RESP || MAD->Method == METHOD_GETTABLE_RESP))\r\nproto_item_set_text(PortInfo_PortWdthSpeedActive_item, "None");\r\nproto_tree_add_item(PortInfo_Link_tree, hf_opa_PortInfo_PortLinkMode_reserved, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_Link_tree, hf_opa_PortInfo_PortLinkMode_Supported, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_Link_tree, hf_opa_PortInfo_PortLinkMode_Enabled, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_Link_tree, hf_opa_PortInfo_PortLinkMode_Active, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_PortLTPCRCMode_reserved, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_PortLTPCRCMode_Supported, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_PortLTPCRCMode_Enabled, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_PortLTPCRCMode_Active, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_bitmask(PortInfo_header_tree, tvb, local_offset, hf_opa_PortInfo_PortMode,\r\nett_portinfo_portmode, _PortInfo_PortMode, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_PortPacketFormats_Supported, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_PortPacketFormats_Enabled, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nPortInfo_FlitControl_tree = proto_tree_add_subtree(PortInfo_header_tree, tvb, local_offset, 10,\r\nett_portinfo_flitcontrol, NULL, "Flit Control");\r\nproto_tree_add_item(PortInfo_FlitControl_tree, hf_opa_PortInfo_FlitControl_Interleave_reserved, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_FlitControl_tree, hf_opa_PortInfo_FlitControl_Interleave_DistanceSupported, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_FlitControl_tree, hf_opa_PortInfo_FlitControl_Interleave_DistanceEnabled, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_FlitControl_tree, hf_opa_PortInfo_FlitControl_Interleave_MaxNestLevelTxEnabled, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_FlitControl_tree, hf_opa_PortInfo_FlitControl_Interleave_MaxNestLevelRxSupported, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PortInfo_FlitControl_tree, hf_opa_PortInfo_FlitControl_Preemption_MinInitial, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PortInfo_FlitControl_tree, hf_opa_PortInfo_FlitControl_Preemption_MinTail, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PortInfo_FlitControl_tree, hf_opa_PortInfo_FlitControl_Preemption_LargePacketLimit, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortInfo_FlitControl_tree, hf_opa_PortInfo_FlitControl_Preemption_SmallPacketLimit, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortInfo_FlitControl_tree, hf_opa_PortInfo_FlitControl_Preemption_MaxSmallPacketLimit, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortInfo_FlitControl_tree, hf_opa_PortInfo_FlitControl_Preemption_PreemptionLimit, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_bitmask(PortInfo_header_tree, tvb, local_offset, hf_opa_PortInfo_PortErrorAction,\r\nett_portinfo_porterroraction, _PortInfo_PortErrorAction, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_PassThroughControl_EgressPort, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_PassThroughControl_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_PassThroughControl_DRControl, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_M_KeyLeasePeriod, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_BufferUnits_reserved, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_BufferUnits_VL15Init, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_BufferUnits_VL15CreditRate, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_BufferUnits_CreditAck, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_BufferUnits_BufferAlloc, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_MasterSMLID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_M_Key, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_SubnetPrefix, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nPortInfo_NeighborMTU_tree = proto_tree_add_subtree(PortInfo_header_tree, tvb, local_offset, 32 / 2,\r\nett_portinfo_neighbormtu, NULL, "NeighborMTU");\r\nfor (i = 0; i < (32 / 2); i++) {\r\ntemp_item = proto_tree_add_item(PortInfo_NeighborMTU_tree, hf_opa_PortInfo_VL1, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_prepend_text(temp_item, "%3u: ", 2 * i);\r\ntemp_item = proto_tree_add_item(PortInfo_NeighborMTU_tree, hf_opa_PortInfo_VL2, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_item_prepend_text(temp_item, "%3u: ", 2 * i + 1);\r\n}\r\nPortInfo_XmitQ_tree = proto_tree_add_subtree(PortInfo_header_tree, tvb, local_offset, 32,\r\nett_portinfo_xmitq, NULL, "XmitQ");\r\nfor (i = 0; i < 32; i++) {\r\ntemp_item = proto_tree_add_item(PortInfo_XmitQ_tree, hf_opa_PortInfo_XmitQ_VLStallCount, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_prepend_text(temp_item, "%3u: ", i);\r\ntemp_item = proto_tree_add_item(PortInfo_XmitQ_tree, hf_opa_PortInfo_XmitQ_HOQLife, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_item_prepend_text(temp_item, " ");\r\n}\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_IPAddrIPv6, tvb, local_offset, 16, ENC_NA);\r\nlocal_offset += 16;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_IPAddrIPv4, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_NeighborNodeGUID, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_bitmask(PortInfo_header_tree, tvb, local_offset, hf_opa_PortInfo_CapabilityMask,\r\nett_portinfo_capmask, _PortInfo_CapabilityMask, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_bitmask(PortInfo_header_tree, tvb, local_offset, hf_opa_PortInfo_CapabilityMask3,\r\nett_portinfo_capmask3, _PortInfo_CapabilityMask3, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_OverallBufferSpace, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_DiagCode, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_ReplayDepth_BufferDepth, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_ReplayDepth_WireDepth, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_PortNeighborMode_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_PortNeighborMode_MgmtAllowed, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_PortNeighborMode_NeighborFWAuthenBypass, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_PortNeighborMode_NeighborNodeType, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_MTU_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_MTU_Cap, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_Resp_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_Resp_TimeValue, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_PortInfo_LocalPortNum, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nlocal_offset += 8 - (242 % 8);\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_PortStateInfo(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *PortStates_header_item;\r\nproto_tree *PortStates_header_tree;\r\nguint i, Num_ports, Port_num;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nNum_ports = (MAD->AttributeModifier & 0xFF000000) >> 24;\r\nPort_num = (MAD->AttributeModifier & 0x000000FF);\r\nfor (i = Port_num; i < Port_num + Num_ports; i++) {\r\nPortStates_header_item = proto_tree_add_item(parentTree, hf_opa_PortStates, tvb, local_offset, 4, ENC_NA);\r\nproto_item_set_text(PortStates_header_item, "Port Sate Info on Port %d", i);\r\nPortStates_header_tree = proto_item_add_subtree(PortStates_header_item, ett_portstates);\r\nproto_tree_add_bitmask_list(PortStates_header_tree, tvb, local_offset, 4,\r\n_PortStates, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PortStates_header_tree, hf_opa_PortStates_LinkWidthDowngradeTxActive, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PortStates_header_tree, hf_opa_PortStates_LinkWidthDowngradeRxActive, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_P_KeyTable(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *P_KeyTable_header_item;\r\nproto_tree *P_KeyTable_header_tree;\r\nproto_tree *tempBlock_tree;\r\nproto_item *tempItemLow;\r\nproto_item *tempItemHigh;\r\nguint i, b, Num_blocks, Block_num;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nif (MAD->MgmtClass == SUBNADMN) {\r\nNum_blocks = 1;\r\nBlock_num = tvb_get_ntohs(tvb, local_offset - 4);\r\n} else {\r\nNum_blocks = (MAD->AttributeModifier & 0xFF000000) >> 24;\r\nBlock_num = (MAD->AttributeModifier & 0x000007FF);\r\n}\r\nP_KeyTable_header_item = proto_tree_add_item(parentTree, hf_opa_P_KeyTable, tvb, local_offset, 64 * Num_blocks, ENC_NA);\r\nP_KeyTable_header_tree = proto_item_add_subtree(P_KeyTable_header_item, ett_pkeytable);\r\nfor (b = Block_num; b < Block_num + Num_blocks; b++) {\r\ntempBlock_tree = proto_tree_add_subtree_format(P_KeyTable_header_tree, tvb, local_offset, 64,\r\nett_pkeytable_block, NULL, "PKey Table Block %u", b);\r\nfor (i = 0; i < 32; i++) {\r\ntempItemHigh = proto_tree_add_item(tempBlock_tree, hf_opa_P_KeyTable_MembershipType, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\ntempItemLow = proto_tree_add_item(tempBlock_tree, hf_opa_P_KeyTable_P_KeyBase, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_item_prepend_text(tempItemHigh, "%3u: ", i);\r\nproto_item_prepend_text(tempItemLow, " ");\r\n}\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_SLtoSCMappingTable(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *SLtoSCMappingTable_header_item;\r\nproto_tree *SLtoSCMappingTable_header_tree;\r\nproto_item *tempItemHigh;\r\nproto_item *tempItemLow;\r\nguint i;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nSLtoSCMappingTable_header_item = proto_tree_add_item(parentTree, hf_opa_SLtoSCMappingTable, tvb, local_offset, 32, ENC_NA);\r\nSLtoSCMappingTable_header_tree = proto_item_add_subtree(SLtoSCMappingTable_header_item, ett_sltoscmapping);\r\nfor (i = 0; i < 32; i++) {\r\ntempItemHigh = proto_tree_add_item(SLtoSCMappingTable_header_tree, hf_opa_SLtoSCMappingTable_SLtoSC_HighBits, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_prepend_text(tempItemHigh, "%3u: ", i);\r\ntempItemLow = proto_tree_add_item(SLtoSCMappingTable_header_tree, hf_opa_SLtoSCMappingTable_SLtoSC_LowBits, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_prepend_text(tempItemLow, " ");\r\nlocal_offset += 1;\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_SCMappingTable(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *SCtoSCMappingTable_header_item;\r\nproto_tree *SCtoSCMappingTable_header_tree;\r\nproto_item *tempItemHigh;\r\nproto_item *tempItemLow;\r\nproto_tree *tempBlock_tree;\r\nguint i, b, i_block, e_block, Num_blocks, Block_num;\r\ngboolean A, B;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nif (MAD->MgmtClass == SUBNADMN) {\r\nNum_blocks = 1;\r\nA = FALSE;\r\nB = FALSE;\r\ni_block = tvb_get_guint8(tvb, local_offset - 4);\r\ne_block = tvb_get_guint8(tvb, local_offset - 3);\r\nBlock_num = e_block;\r\n} else {\r\nNum_blocks = (MAD->AttributeModifier & 0xFF000000) >> 24;\r\nA = (gboolean)((MAD->AttributeModifier & 0x00020000) >> 17);\r\nB = (gboolean)((MAD->AttributeModifier & 0x00010000) >> 16);\r\ni_block = (MAD->AttributeModifier & 0x0000FF00) >> 8;\r\ne_block = (MAD->AttributeModifier & 0x000000FF);\r\nBlock_num = (B ? i_block : e_block);\r\n}\r\nSCtoSCMappingTable_header_item = proto_tree_add_item(parentTree, hf_opa_SCtoSCMappingTable, tvb, local_offset, 32 * (A ? 1 : Num_blocks), ENC_NA);\r\nSCtoSCMappingTable_header_tree = proto_item_add_subtree(SCtoSCMappingTable_header_item, ett_sctoscmapping);\r\nfor (b = Block_num; b < (Block_num + Num_blocks); b++) {\r\ntempBlock_tree = proto_tree_add_subtree_format(SCtoSCMappingTable_header_tree, tvb, local_offset, 32,\r\nett_sctoscmapping_block, NULL, "SC to SC Mapping Table for InPort %u, OutPort %u", (B ? b : i_block), (B ? e_block : b));\r\nfor (i = 0; i < 32; i++) {\r\ntempItemHigh = proto_tree_add_item(tempBlock_tree, hf_opa_SCtoSCMappingTable_SCtoSC_HighBits, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_prepend_text(tempItemHigh, "%3u: ", i);\r\ntempItemLow = proto_tree_add_item(tempBlock_tree, hf_opa_SCtoSCMappingTable_SCtoSC_LowBits, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_prepend_text(tempItemLow, " ");\r\nlocal_offset += 1;\r\n}\r\nif (A || B)\r\nbreak;\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_SCtoSLMappingTable(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *SCtoSLMappingTable_header_item;\r\nproto_tree *SCtoSLMappingTable_header_tree;\r\nproto_item *tempItemHigh;\r\nproto_item *tempItemLow;\r\nguint i;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nSCtoSLMappingTable_header_item = proto_tree_add_item(parentTree, hf_opa_SCtoSLMappingTable, tvb, local_offset, 32, ENC_NA);\r\nSCtoSLMappingTable_header_tree = proto_item_add_subtree(SCtoSLMappingTable_header_item, ett_sctoslmapping);\r\nfor (i = 0; i < 32; i++) {\r\ntempItemHigh = proto_tree_add_item(SCtoSLMappingTable_header_tree, hf_opa_SCtoSLMappingTable_SCtoSL_HighBits, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_prepend_text(tempItemHigh, "%3u: ", i);\r\ntempItemLow = proto_tree_add_item(SCtoSLMappingTable_header_tree, hf_opa_SCtoSLMappingTable_SCtoSL_LowBits, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_prepend_text(tempItemLow, " ");\r\nlocal_offset += 1;\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_SCtoVLxMappingTable(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *SCtoVLxMappingTable_header_item;\r\nproto_tree *SCtoVLxMappingTable_header_tree;\r\nproto_item *tempItemLow;\r\nproto_item *tempItemHigh;\r\nproto_tree *tempBlock_tree;\r\nguint p, v, Port_num, Num_ports;\r\ngboolean All;\r\nconst gchar *VLx;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nif (MAD->MgmtClass == SUBNADMN) {\r\nNum_ports = 1;\r\nPort_num = tvb_get_guint8(tvb, local_offset - 4);\r\nAll = FALSE;\r\nVLx = val_to_str_const(MAD->AttributeID, SA_SC_VLx, "x");\r\n} else {\r\nNum_ports = (MAD->AttributeModifier & 0xFF000000) >> 24;\r\nAll = (gboolean)((MAD->AttributeModifier & 0x00000100) >> 8);\r\nPort_num = (MAD->AttributeModifier & 0x000000FF);\r\nVLx = val_to_str_const(MAD->AttributeID, SM_SC_VLx, "x");\r\n}\r\nSCtoVLxMappingTable_header_item = proto_tree_add_item(parentTree, hf_opa_SCtoVLxMappingTable, tvb, local_offset, 32 * (All ? 1 : Num_ports), ENC_NA);\r\nproto_item_set_text(SCtoVLxMappingTable_header_item, "SC to VL%s Mapping Table", VLx);\r\nSCtoVLxMappingTable_header_tree = proto_item_add_subtree(SCtoVLxMappingTable_header_item, ett_sctovlxmappingtable);\r\nfor (p = Port_num; p < (Port_num + (All ? 1 : Num_ports)); p++) {\r\ntempBlock_tree = proto_tree_add_subtree_format(SCtoVLxMappingTable_header_tree, tvb, local_offset, 32,\r\nett_sctovlxmappingtable_block, NULL, "SC to VL%s Mapping Table for Port %u", VLx, p);\r\nfor (v = 0; v < 32; v++) {\r\ntempItemHigh = proto_tree_add_item(tempBlock_tree, hf_opa_SCtoVLxMappingTable_SCtoVLx_HighBits, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_prepend_text(tempItemHigh, "%3u: ", v);\r\ntempItemLow = proto_tree_add_item(tempBlock_tree, hf_opa_SCtoVLxMappingTable_SCtoVLx_LowBits, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_prepend_text(tempItemLow, " ");\r\nlocal_offset += 1;\r\n}\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_VLArbitrationTable(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *VLArbitrationTable_header_item;\r\nproto_tree * VLArbitrationTable_header_tree,*VLArbitrationTable_port_tree;\r\nproto_item *tempItemHigh;\r\nproto_item *tempItemLow;\r\nproto_item *tempItem;\r\nguint i, p, Section, Num_ports, Port_num;\r\ngboolean All;\r\nconst gchar *TableType;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nif (MAD->MgmtClass == SUBNADMN) {\r\nNum_ports = 1;\r\nSection = tvb_get_guint8(tvb, local_offset - 3);\r\nPort_num = tvb_get_guint8(tvb, local_offset - 4);\r\nAll = FALSE;\r\n} else {\r\nNum_ports = (MAD->AttributeModifier & 0xFF000000) >> 24;\r\nSection = (MAD->AttributeModifier & 0x00FF0000) >> 16;\r\nAll = (gboolean)((MAD->AttributeModifier & 0x00000100) >> 8);\r\nPort_num = (MAD->AttributeModifier & 0x000000FF);\r\n}\r\nTableType = val_to_str_const(Section, MADAttrModSectionVLarb_short, "Reserved");\r\nVLArbitrationTable_header_item = proto_tree_add_item(parentTree, hf_opa_VLArbitrationTable, tvb, local_offset, 256 * (All ? 1 : Num_ports), ENC_NA);\r\nVLArbitrationTable_header_tree = proto_item_add_subtree(VLArbitrationTable_header_item, ett_vlarbitrationtable);\r\nfor (p = Port_num; p < (Port_num + (All ? 1 : Num_ports)); p++) {\r\nVLArbitrationTable_port_tree = proto_tree_add_subtree_format(VLArbitrationTable_header_tree, tvb, local_offset, 256,\r\nett_vlarbitrationtable_port, NULL, "%s VL Arbitration Table on Port %u", TableType, p);\r\nif (Section < 3) {\r\nfor (i = 0; i < 128; i++) {\r\ntempItemHigh = proto_tree_add_item(VLArbitrationTable_port_tree, hf_opa_VLArbitrationTable_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_prepend_text(tempItemHigh, "%3u: ", i);\r\ntempItemLow = proto_tree_add_item(VLArbitrationTable_port_tree, hf_opa_VLArbitrationTable_VL, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_prepend_text(tempItemLow, " ");\r\nlocal_offset += 1;\r\ntempItem = proto_tree_add_item(VLArbitrationTable_port_tree, hf_opa_VLArbitrationTable_Weight, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_item_prepend_text(tempItem, " ");\r\n}\r\n} else if (Section == 3) {\r\nfor (i = 0; i < 32; i++) {\r\ntempItemLow = proto_tree_add_item(VLArbitrationTable_port_tree, hf_opa_VLArbitrationTable_Matrix, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_item_prepend_text(tempItemLow, "%3u: ", i);\r\n}\r\nlocal_offset += 128;\r\n} else {\r\nlocal_offset += 256;\r\n}\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_LinearForwardingTable(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *LinearForwardingTable_header_item;\r\nproto_tree *LinearForwardingTable_header_tree;\r\nproto_item *tempItemLow;\r\nproto_tree *tempBlock_tree;\r\nguint b, i, Block_num, Num_blocks;\r\ngboolean All;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nif (MAD->MgmtClass == SUBNADMN) {\r\nNum_blocks = 1;\r\nBlock_num = tvb_get_ntohl(tvb, local_offset - 4) & 0x0003FFFF;\r\nAll = FALSE;\r\n} else {\r\nNum_blocks = (MAD->AttributeModifier & 0xFF000000) >> 24;\r\nAll = (gboolean)((MAD->AttributeModifier & 0x00040000) >> 18);\r\nBlock_num = (MAD->AttributeModifier & 0x0003FFFF);\r\n}\r\nLinearForwardingTable_header_item = proto_tree_add_item(parentTree, hf_opa_LinearForwardingTable, tvb, local_offset, 64 * (All ? 1 : Num_blocks), ENC_NA);\r\nLinearForwardingTable_header_tree = proto_item_add_subtree(LinearForwardingTable_header_item, ett_linearforwardingtable);\r\nfor (b = Block_num; b < (Block_num + (All ? 1 : Num_blocks)); b++) {\r\ntempBlock_tree = proto_tree_add_subtree_format(LinearForwardingTable_header_tree, tvb, local_offset, 64,\r\nett_linearforwardingtable_block, NULL, "Linear Forwarding Table Block %u", b);\r\nfor (i = 0; i < 64; i++) {\r\ntempItemLow = proto_tree_add_item(tempBlock_tree, hf_opa_LinearForwardingTable_Port, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_item_prepend_text(tempItemLow, "%3u: ", i);\r\n}\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_MulticastForwardingTable(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *MulticastForwardingTable_header_item;\r\nproto_tree *MulticastForwardingTable_header_tree;\r\nproto_item *tempItemLow;\r\nproto_tree *tempBlock_tree;\r\nguint b, i, Block_num, Num_blocks;\r\ngboolean All;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nif (MAD->MgmtClass == SUBNADMN) {\r\nNum_blocks = 1;\r\nBlock_num = tvb_get_ntohl(tvb, local_offset - 4) & 0x001FFFFF;\r\nAll = FALSE;\r\n} else {\r\nNum_blocks = (MAD->AttributeModifier & 0xFF000000) >> 24;\r\nAll = (gboolean)((MAD->AttributeModifier & 0x00100000) >> 20);\r\nBlock_num = (MAD->AttributeModifier & 0x000FFFFF);\r\n}\r\nMulticastForwardingTable_header_item = proto_tree_add_item(parentTree, hf_opa_MulticastForwardingTable, tvb, local_offset, 64 * (All ? 1 : Num_blocks), ENC_NA);\r\nMulticastForwardingTable_header_tree = proto_item_add_subtree(MulticastForwardingTable_header_item, ett_multicastforwardingtable);\r\nfor (b = Block_num; b < (Block_num + (All ? 1 : Num_blocks)); b++) {\r\ntempBlock_tree = proto_tree_add_subtree_format(MulticastForwardingTable_header_tree, tvb, local_offset, 64,\r\nett_multicastforwardingtable_block, NULL, "Multicast Forwarding Table Block %u", b);\r\nfor (i = 0; i < 8; i++) {\r\ntempItemLow = proto_tree_add_item(tempBlock_tree, hf_opa_MulticastForwardingTable_PortMask, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_item_prepend_text(tempItemLow, "%3u: ", i);\r\n}\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_PortGroupForwardingTable(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *PortGroupForwardingTable_header_item;\r\nproto_tree *PortGroupForwardingTable_header_tree;\r\nproto_item *tempItemLow;\r\nproto_tree *tempBlock_tree;\r\nguint b, i, Block_num, Num_blocks;\r\ngboolean All;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nif (MAD->MgmtClass == SUBNADMN) {\r\nNum_blocks = 1;\r\nAll = FALSE;\r\nBlock_num = tvb_get_ntohl(tvb, local_offset - 4) & 0x0003FFFF;\r\n} else {\r\nNum_blocks = (MAD->AttributeModifier & 0xFF000000) >> 24;\r\nAll = (gboolean)((MAD->AttributeModifier & 0x00040000) >> 18);\r\nBlock_num = (MAD->AttributeModifier & 0x0003FFFF);\r\n}\r\nPortGroupForwardingTable_header_item = proto_tree_add_item(parentTree, hf_opa_PortGroupForwardingTable, tvb, local_offset, 64 * (All ? 1 : Num_blocks), ENC_NA);\r\nPortGroupForwardingTable_header_tree = proto_item_add_subtree(PortGroupForwardingTable_header_item, ett_portgroupforwardingtable);\r\nfor (b = Block_num; b < (Block_num + (All ? 1 : Num_blocks)); b++) {\r\ntempBlock_tree = proto_tree_add_subtree_format(PortGroupForwardingTable_header_tree, tvb, local_offset, 64,\r\nett_portgroupforwardingtable_block, NULL, "Port Group Forwarding Table Block %u", b);\r\nfor (i = 0; i < 64; i++) {\r\ntempItemLow = proto_tree_add_item(tempBlock_tree, hf_opa_PortGroupForwardingTable_Port, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_item_prepend_text(tempItemLow, "%3u: ", i);\r\n}\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_PortGroupTable(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *PortGroupTable_header_item;\r\nproto_tree *PortGroupTable_header_tree;\r\nproto_item *tempItemLow;\r\nproto_tree *tempBlock_tree;\r\nguint b, i, Block_num, Num_blocks;\r\ngboolean All;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nif (MAD->MgmtClass == SUBNADMN) {\r\nNum_blocks = 1;\r\nAll = FALSE;\r\nBlock_num = tvb_get_guint8(tvb, local_offset - 3) & 0x1F;\r\n} else {\r\nNum_blocks = (MAD->AttributeModifier & 0xFF000000) >> 24;\r\nAll = (gboolean)((MAD->AttributeModifier & 0x00000020) >> 5);\r\nBlock_num = (MAD->AttributeModifier & 0x0000001F);\r\n}\r\nPortGroupTable_header_item = proto_tree_add_item(parentTree, hf_opa_PortGroupTable, tvb, local_offset, 64 * (All ? 1 : Num_blocks), ENC_NA);\r\nPortGroupTable_header_tree = proto_item_add_subtree(PortGroupTable_header_item, ett_portgrouptable);\r\nfor (b = Block_num; b < (Block_num + (All ? 1 : Num_blocks)); b++) {\r\ntempBlock_tree = proto_tree_add_subtree_format(PortGroupTable_header_tree, tvb, local_offset, 8 * 8,\r\nett_portgrouptable_block, NULL, "Port Group Table Block %u", b);\r\nfor (i = 0; i < 8; i++) {\r\ntempItemLow = proto_tree_add_item(tempBlock_tree, hf_opa_PortGroupTable_PortMask, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_item_prepend_text(tempItemLow, "%3u: ", i);\r\n}\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_SMInfo(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *SMInfo_header_item;\r\nproto_tree *SMInfo_header_tree;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nSMInfo_header_item = proto_tree_add_item(parentTree, hf_opa_SMInfo, tvb, local_offset, 26, ENC_NA);\r\nSMInfo_header_tree = proto_item_add_subtree(SMInfo_header_item, ett_sminfo);\r\nproto_tree_add_item(SMInfo_header_tree, hf_opa_SMInfo_GUID, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(SMInfo_header_tree, hf_opa_SMInfo_SM_Key, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(SMInfo_header_tree, hf_opa_SMInfo_ActCount, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SMInfo_header_tree, hf_opa_SMInfo_ElapsedTime, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SMInfo_header_tree, hf_opa_SMInfo_Priority, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(SMInfo_header_tree, hf_opa_SMInfo_ElevatedPriority, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(SMInfo_header_tree, hf_opa_SMInfo_InitialPriority, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(SMInfo_header_tree, hf_opa_SMInfo_SMState, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nreturn local_offset;\r\n}\r\nstatic gint parse_LedInfo(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *LedInfo_header_item;\r\nproto_tree *LedInfo_header_tree;\r\nproto_item *tempItemHigh;\r\nproto_item *tempItemLow;\r\nguint p, Port_num, Num_ports;\r\ngboolean All;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nNum_ports = (MAD->AttributeModifier & 0xFF000000) >> 24;\r\nAll = (gboolean)((MAD->AttributeModifier & 0x00000100) >> 8);\r\nPort_num = (MAD->AttributeModifier & 0x000000FF);\r\nLedInfo_header_item = proto_tree_add_item(parentTree, hf_opa_LedInfo, tvb, local_offset, 8 * (All ? 1 : Num_ports), ENC_NA);\r\nLedInfo_header_tree = proto_item_add_subtree(LedInfo_header_item, ett_ledinfo);\r\nfor (p = Port_num; p < (Port_num + (All ? 1 : Num_ports)); p++) {\r\ntempItemHigh = proto_tree_add_item(LedInfo_header_tree, hf_opa_LedInfo_LedMask, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_item_prepend_text(tempItemHigh, "Port %3u: ", p);\r\ntempItemLow = proto_tree_add_item(LedInfo_header_tree, hf_opa_LedInfo_reserved, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_item_prepend_text(tempItemLow, " ");\r\nlocal_offset += 4;\r\nproto_tree_add_item(LedInfo_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_CableInfo(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *CableInfo_header_item;\r\nproto_tree *CableInfo_header_tree;\r\nproto_item *tempItemLow;\r\nguint i, Port_num, Data_Len, start_addr;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nstart_addr = (MAD->AttributeModifier & 0x7FF80000) >> 19;\r\nPort_num = (MAD->AttributeModifier & 0x000000FF);\r\nData_Len = ((MAD->AttributeModifier & 0x0007E000) >> 13) + 1;\r\nCableInfo_header_item = proto_tree_add_item(parentTree, hf_opa_CableInfo, tvb, local_offset, Data_Len, ENC_NA);\r\nproto_item_set_text(CableInfo_header_item, "Cable Info on Port %u", Port_num);\r\nCableInfo_header_tree = proto_item_add_subtree(CableInfo_header_item, ett_cableinfo);\r\nproto_tree_add_item(CableInfo_header_tree, hf_opa_CableInfo_DataStream, tvb, local_offset, Data_Len, ENC_ASCII | ENC_NA);\r\nfor (i = 0; i < Data_Len; i++) {\r\ntempItemLow = proto_tree_add_item(CableInfo_header_tree, hf_opa_CableInfo_Data, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_prepend_text(tempItemLow, "0x%04X: ", i + start_addr);\r\nlocal_offset += 1;\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_BufferControlTable(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *BufferControlTable_header_item;\r\nproto_tree *BufferControlTable_header_tree;\r\nproto_item *tempItemLow;\r\nproto_item *tempItemHigh;\r\nproto_tree *tempBlock_tree;\r\nguint p, i, Port_num, Num_ports;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nNum_ports = (MAD->AttributeModifier & 0xFF000000) >> 24;\r\nPort_num = (MAD->AttributeModifier & 0x000000FF);\r\nBufferControlTable_header_item = proto_tree_add_item(parentTree, hf_opa_BufferControlTable, tvb, local_offset, (4 + 32 * 4) * Num_ports, ENC_NA);\r\nBufferControlTable_header_tree = proto_item_add_subtree(BufferControlTable_header_item, ett_buffercontroltable);\r\nfor (p = Port_num; p < Port_num + Num_ports; p++) {\r\ntempBlock_tree = proto_tree_add_subtree_format(BufferControlTable_header_tree, tvb, local_offset, (4 + 32 * 4),\r\nett_buffercontroltable_port, NULL, "Buffer Control Table Port %u", p);\r\nproto_tree_add_item(tempBlock_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(tempBlock_tree, hf_opa_BufferControlTable_TxOverallSharedLimit, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nfor (i = 0; i < 32; i++) {\r\ntempItemHigh = proto_tree_add_item(tempBlock_tree, hf_opa_BufferControlTable_TxSharedLimit, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\ntempItemLow = proto_tree_add_item(tempBlock_tree, hf_opa_BufferControlTable_TxDedicatedLimit, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_item_prepend_text(tempItemHigh, "VL %2u: ", i);\r\nproto_item_prepend_text(tempItemLow, " ");\r\n}\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_FabricInfoRecord(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *FabricInfoRecord_header_item;\r\nproto_tree *FabricInfoRecord_header_tree;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nFabricInfoRecord_header_item = proto_tree_add_item(parentTree, hf_opa_FabricInfoRecord, tvb, local_offset, 132, ENC_NA);\r\nFabricInfoRecord_header_tree = proto_item_add_subtree(FabricInfoRecord_header_item, ett_fabricinforecord);\r\nproto_tree_add_item(FabricInfoRecord_header_tree, hf_opa_FabricInfoRecord_NumHFIs, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(FabricInfoRecord_header_tree, hf_opa_FabricInfoRecord_NumSwitches, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(FabricInfoRecord_header_tree, hf_opa_FabricInfoRecord_NumInternalHFILinks, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(FabricInfoRecord_header_tree, hf_opa_FabricInfoRecord_NumExternalHFILinks, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(FabricInfoRecord_header_tree, hf_opa_FabricInfoRecord_NumInternalISLs, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(FabricInfoRecord_header_tree, hf_opa_FabricInfoRecord_NumExternalISLs, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(FabricInfoRecord_header_tree, hf_opa_FabricInfoRecord_NumDegradedHFILinks, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(FabricInfoRecord_header_tree, hf_opa_FabricInfoRecord_NumDegradedISLs, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(FabricInfoRecord_header_tree, hf_opa_FabricInfoRecord_NumOmittedHFILinks, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(FabricInfoRecord_header_tree, hf_opa_FabricInfoRecord_NumOmittedISLs, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(FabricInfoRecord_header_tree, hf_opa_FabricInfoRecord_Reserved, tvb, local_offset, 92, ENC_BIG_ENDIAN);\r\nlocal_offset += 92;\r\nreturn local_offset;\r\n}\r\nstatic gint parse_CongestionInfo(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *CongestionInfo_header_item;\r\nproto_tree *CongestionInfo_header_tree;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nCongestionInfo_header_item = proto_tree_add_item(parentTree, hf_opa_CongestionInfo, tvb, local_offset, 4, ENC_NA);\r\nCongestionInfo_header_tree = proto_item_add_subtree(CongestionInfo_header_item, ett_congestioninfo);\r\nproto_tree_add_item(CongestionInfo_header_tree, hf_opa_CongestionInfo_CongestionInfo, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(CongestionInfo_header_tree, hf_opa_CongestionInfo_ControlTableCap, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(CongestionInfo_header_tree, hf_opa_CongestionInfo_CongestionLogLength, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nreturn local_offset;\r\n}\r\nstatic gint parse_SwitchCongestionLog(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *SwitchCongestionLog_header_item;\r\nproto_tree *SwitchCongestionLog_header_tree;\r\nproto_tree *SwitchCongestionLog_Entry_tree;\r\nguint i;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nSwitchCongestionLog_header_item = proto_tree_add_item(parentTree, hf_opa_SwitchCongestionLog, tvb, local_offset, 40 + (96 * 16), ENC_NA);\r\nSwitchCongestionLog_header_tree = proto_item_add_subtree(SwitchCongestionLog_header_item, ett_switchcongestionlog);\r\nproto_tree_add_item(SwitchCongestionLog_header_tree, hf_opa_SwitchCongestionLog_LogType, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(SwitchCongestionLog_header_tree, hf_opa_SwitchCongestionLog_CongestionFlags, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(SwitchCongestionLog_header_tree, hf_opa_SwitchCongestionLog_LogEventsCounter, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(SwitchCongestionLog_header_tree, hf_opa_SwitchCongestionLog_CurrentTimeStamp, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SwitchCongestionLog_header_tree, hf_opa_SwitchCongestionLog_PortMap, tvb, local_offset, 32, ENC_NA);\r\nlocal_offset += 32;\r\nfor (i = 0; i < 96; i++) {\r\nSwitchCongestionLog_Entry_tree = proto_tree_add_subtree_format(SwitchCongestionLog_header_tree, tvb, local_offset, 16,\r\nett_switchcongestionlog_entry, NULL, "Switch Congestion Log Entry %u", i);\r\nproto_tree_add_item(SwitchCongestionLog_Entry_tree, hf_opa_SwitchCongestionLog_SLID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SwitchCongestionLog_Entry_tree, hf_opa_SwitchCongestionLog_DLID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SwitchCongestionLog_Entry_tree, hf_opa_SwitchCongestionLog_SC, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(SwitchCongestionLog_Entry_tree, hf_opa_SwitchCongestionLog_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(SwitchCongestionLog_Entry_tree, hf_opa_reserved24, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(SwitchCongestionLog_Entry_tree, hf_opa_SwitchCongestionLog_TimeStamp, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_SwitchCongestionSetting(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *SwitchCongestionSetting_header_item;\r\nproto_tree *SwitchCongestionSetting_header_tree;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nSwitchCongestionSetting_header_item = proto_tree_add_item(parentTree, hf_opa_SwitchCongestionSetting, tvb, local_offset, 64, ENC_NA);\r\nSwitchCongestionSetting_header_tree = proto_item_add_subtree(SwitchCongestionSetting_header_item, ett_switchcongestionsetting);\r\nproto_tree_add_item(SwitchCongestionSetting_header_tree, hf_opa_SwitchCongestionSetting_Control_Map, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SwitchCongestionSetting_header_tree, hf_opa_SwitchCongestionSetting_Victim_Mask, tvb, local_offset, 32, ENC_NA);\r\nlocal_offset += 32;\r\nproto_tree_add_item(SwitchCongestionSetting_header_tree, hf_opa_SwitchCongestionSetting_Credit_Mask, tvb, local_offset, 32, ENC_NA);\r\nlocal_offset += 32;\r\nproto_tree_add_item(SwitchCongestionSetting_header_tree, hf_opa_SwitchCongestionSetting_Threshold, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(SwitchCongestionSetting_header_tree, hf_opa_SwitchCongestionSetting_reserved1, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(SwitchCongestionSetting_header_tree, hf_opa_SwitchCongestionSetting_Packet_Size, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(SwitchCongestionSetting_header_tree, hf_opa_SwitchCongestionSetting_CS_Threshold, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(SwitchCongestionSetting_header_tree, hf_opa_SwitchCongestionSetting_reserved2, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(SwitchCongestionSetting_header_tree, hf_opa_reserved8, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(SwitchCongestionSetting_header_tree, hf_opa_SwitchCongestionSetting_CS_ReturnDelay, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(SwitchCongestionSetting_header_tree, hf_opa_SwitchCongestionSetting_Marking_Rate, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nreturn local_offset;\r\n}\r\nstatic gint parse_SwitchPortCongestionSetting(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *SwitchPortCongestionSetting_header_item;\r\nproto_tree *SwitchPortCongestionSetting_header_tree;\r\nproto_tree *SwitchPortCongestionSetting_Port_tree;\r\nguint p, Num_ports, Port_num;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nNum_ports = (MAD->AttributeModifier & 0xFF000000) >> 24;\r\nPort_num = (MAD->AttributeModifier & 0x000000FF);\r\nSwitchPortCongestionSetting_header_item = proto_tree_add_item(parentTree, hf_opa_SwitchPortCongestionSetting, tvb, local_offset, 4 * Num_ports, ENC_NA);\r\nSwitchPortCongestionSetting_header_tree = proto_item_add_subtree(SwitchPortCongestionSetting_header_item, ett_switchportcongestionsetting);\r\nfor (p = Port_num; p < Port_num + Num_ports; p++) {\r\nSwitchPortCongestionSetting_Port_tree = proto_tree_add_subtree_format(SwitchPortCongestionSetting_header_tree, tvb, local_offset, 4,\r\nett_switchportcongestionsetting_port, NULL, "Switch Port Congestion Setting on Port %u", p);\r\nproto_tree_add_item(SwitchPortCongestionSetting_Port_tree, hf_opa_SwitchPortCongestionSetting_Valid, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(SwitchPortCongestionSetting_Port_tree, hf_opa_SwitchPortCongestionSetting_Control_Type, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(SwitchPortCongestionSetting_Port_tree, hf_opa_SwitchPortCongestionSetting_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(SwitchPortCongestionSetting_Port_tree, hf_opa_SwitchPortCongestionSetting_Threshold, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(SwitchPortCongestionSetting_Port_tree, hf_opa_SwitchPortCongestionSetting_Packet_Size, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(SwitchPortCongestionSetting_Port_tree, hf_opa_SwitchPortCongestionSetting_Marking_Rate, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_HFICongestionLog(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *HFICongestionLog_header_item;\r\nproto_tree *HFICongestionLog_header_tree;\r\nproto_tree *HFICongestionLog_Entry_tree;\r\nguint i;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nHFICongestionLog_header_item = proto_tree_add_item(parentTree, hf_opa_HFICongestionLog, tvb, local_offset, 12 + (96 * 16), ENC_NA);\r\nHFICongestionLog_header_tree = proto_item_add_subtree(HFICongestionLog_header_item, ett_hficongestionlog);\r\nproto_tree_add_item(HFICongestionLog_header_tree, hf_opa_HFICongestionLog_LogType, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(HFICongestionLog_header_tree, hf_opa_HFICongestionLog_CongestionFlags, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(HFICongestionLog_header_tree, hf_opa_HFICongestionLog_ThresholdEventCounter, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(HFICongestionLog_header_tree, hf_opa_HFICongestionLog_CurrentTimeStamp, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(HFICongestionLog_header_tree, hf_opa_HFICongestionLog_ThresholdCongestionEventMap, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nfor (i = 0; i < 96; i++) {\r\nHFICongestionLog_Entry_tree = proto_tree_add_subtree_format(HFICongestionLog_header_tree, tvb, local_offset, 16,\r\nett_hficongestionlog_entry, NULL, "HFI Congestion Log Entry %u", i);\r\nproto_tree_add_item(HFICongestionLog_Entry_tree, hf_opa_HFICongestionLog_Local_QP_CN_Entry, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(HFICongestionLog_Entry_tree, hf_opa_HFICongestionLog_Remote_QP_Number_CN_Entry, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(HFICongestionLog_Entry_tree, hf_opa_HFICongestionLog_SL_CN_Entry, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(HFICongestionLog_Entry_tree, hf_opa_HFICongestionLog_Service_Type_CN_Entry, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(HFICongestionLog_Entry_tree, hf_opa_reserved8, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(HFICongestionLog_Entry_tree, hf_opa_HFICongestionLog_Remote_LID_CN_Entry, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(HFICongestionLog_Entry_tree, hf_opa_HFICongestionLog_TimeStamp_CN_Entry, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_HFICongestionSetting(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint i;\r\ngint local_offset = *offset;\r\nproto_item *HFICongestionSetting_header_item;\r\nproto_tree *HFICongestionSetting_header_tree;\r\nproto_item *tempItem;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nHFICongestionSetting_header_item = proto_tree_add_item(parentTree, hf_opa_HFICongestionSetting, tvb, local_offset, 6 + 32 * 6, ENC_NA);\r\nHFICongestionSetting_header_tree = proto_item_add_subtree(HFICongestionSetting_header_item, ett_hficongestionsetting);\r\nproto_tree_add_item(HFICongestionSetting_header_tree, hf_opa_HFICongestionSetting_Control_Map, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(HFICongestionSetting_header_tree, hf_opa_HFICongestionSetting_Port_Control, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nfor (i = 0; i < 32; i++) {\r\ntempItem = proto_tree_add_item(HFICongestionSetting_header_tree, hf_opa_HFICongestionSetting_CCTI_Increase, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_prepend_text(tempItem, "%3u: ", i);\r\nlocal_offset += 1;\r\ntempItem = proto_tree_add_item(HFICongestionSetting_header_tree, hf_opa_reserved8, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_prepend_text(tempItem, " ");\r\nlocal_offset += 1;\r\ntempItem = proto_tree_add_item(HFICongestionSetting_header_tree, hf_opa_HFICongestionSetting_CCTI_Timer, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nproto_item_prepend_text(tempItem, " ");\r\nlocal_offset += 2;\r\ntempItem = proto_tree_add_item(HFICongestionSetting_header_tree, hf_opa_HFICongestionSetting_TriggerThreshold, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_prepend_text(tempItem, " ");\r\nlocal_offset += 1;\r\ntempItem = proto_tree_add_item(HFICongestionSetting_header_tree, hf_opa_HFICongestionSetting_CCTI_Min, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_prepend_text(tempItem, " ");\r\nlocal_offset += 1;\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_HFICongestionControlTable(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *HFICongestionControlTable_header_item;\r\nproto_tree *HFICongestionControlTable_header_tree;\r\nproto_item *tempItem;\r\nproto_tree *tempBlock_tree;\r\nguint b, i, Num_blocks, Block_Num;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nif (MAD->MgmtClass == SUBNADMN) {\r\nNum_blocks = 1;\r\nBlock_Num = tvb_get_ntohs(tvb, local_offset - 4);\r\n} else {\r\nNum_blocks = (MAD->AttributeModifier & 0xFF000000) >> 24;\r\nBlock_Num = (MAD->AttributeModifier & 0x000000FF);\r\n}\r\nHFICongestionControlTable_header_item = proto_tree_add_item(parentTree, hf_opa_HFICongestionControlTable, tvb, local_offset, 2 + ((64 * 2) * Num_blocks), ENC_NA);\r\nHFICongestionControlTable_header_tree = proto_item_add_subtree(HFICongestionControlTable_header_item, ett_hficongestioncontroltable);\r\nproto_tree_add_item(HFICongestionControlTable_header_tree, hf_opa_HFICongestionControlTable_CCTI_Limit, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nfor (b = Block_Num; b < Block_Num + Num_blocks; b++) {\r\ntempBlock_tree = proto_tree_add_subtree_format(HFICongestionControlTable_header_tree, tvb, local_offset, 128,\r\nett_hficongestioncontroltable_block, NULL, "HFI Congestion Control Table Block %u", b);\r\nfor (i = 0; i < 64; i++) {\r\ntempItem = proto_tree_add_item(tempBlock_tree, hf_opa_HFICongestionControlTable_CCT_Shift, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nproto_item_prepend_text(tempItem, "%3u: ", i);\r\ntempItem = proto_tree_add_item(tempBlock_tree, hf_opa_HFICongestionControlTable_CCT_Multiplier, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_item_prepend_text(tempItem, " ");\r\n}\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gboolean call_SUBM_Parser(proto_tree *parentTree, tvbuff_t *tvb, guint *offset, MAD_t *MAD, guint16 AttributeID)\r\n{\r\nproto_tree *SUBM_Attribute_header_tree = parentTree;\r\nguint local_offset = *offset;\r\nif (!tvb_bytes_exist(tvb, local_offset, 8))\r\nreturn TRUE;\r\nswitch (AttributeID) {\r\ncase SM_ATTR_ID_CLASS_PORT_INFO:\r\nlocal_offset = parse_ClassPortInfo(SUBM_Attribute_header_tree, tvb, offset, MAD);\r\nbreak;\r\ncase SM_ATTR_ID_NOTICE:\r\nlocal_offset = parse_NoticesAndTraps(SUBM_Attribute_header_tree, tvb, offset);\r\nbreak;\r\ncase SM_ATTR_ID_NODE_DESCRIPTION:\r\nlocal_offset = parse_NodeDescription(SUBM_Attribute_header_tree, tvb, offset, MAD);\r\nbreak;\r\ncase SM_ATTR_ID_NODE_INFO:\r\nlocal_offset = parse_NodeInfo(SUBM_Attribute_header_tree, tvb, offset, MAD);\r\nbreak;\r\ncase SM_ATTR_ID_SWITCH_INFO:\r\nlocal_offset = parse_SwitchInfo(SUBM_Attribute_header_tree, tvb, offset, MAD);\r\nbreak;\r\ncase SM_ATTR_ID_PORT_INFO:\r\nlocal_offset = parse_PortInfo(SUBM_Attribute_header_tree, tvb, offset, MAD);\r\nbreak;\r\ncase SM_ATTR_ID_PART_TABLE:\r\nlocal_offset = parse_P_KeyTable(SUBM_Attribute_header_tree, tvb, offset, MAD);\r\nbreak;\r\ncase SM_ATTR_ID_SL_SC_MAPPING_TABLE:\r\nlocal_offset = parse_SLtoSCMappingTable(SUBM_Attribute_header_tree, tvb, offset, MAD);\r\nbreak;\r\ncase SM_ATTR_ID_VL_ARBITRATION:\r\nlocal_offset = parse_VLArbitrationTable(SUBM_Attribute_header_tree, tvb, offset, MAD);\r\nbreak;\r\ncase SM_ATTR_ID_LINEAR_FWD_TABLE:\r\nlocal_offset = parse_LinearForwardingTable(SUBM_Attribute_header_tree, tvb, offset, MAD);\r\nbreak;\r\ncase SM_ATTR_ID_MCAST_FWD_TABLE:\r\nlocal_offset = parse_MulticastForwardingTable(SUBM_Attribute_header_tree, tvb, offset, MAD);\r\nbreak;\r\ncase SM_ATTR_ID_SM_INFO:\r\nlocal_offset = parse_SMInfo(SUBM_Attribute_header_tree, tvb, offset, MAD);\r\nbreak;\r\ncase SM_ATTR_ID_LED_INFO:\r\nlocal_offset = parse_LedInfo(SUBM_Attribute_header_tree, tvb, offset, MAD);\r\nbreak;\r\ncase SM_ATTR_ID_CABLE_INFO:\r\nlocal_offset = parse_CableInfo(SUBM_Attribute_header_tree, tvb, offset, MAD);\r\nbreak;\r\ncase SM_ATTR_ID_SC_SC_MAPPING_TABLE:\r\nlocal_offset = parse_SCMappingTable(SUBM_Attribute_header_tree, tvb, offset, MAD);\r\nbreak;\r\ncase SM_ATTR_ID_SC_SL_MAPPING_TABLE:\r\nlocal_offset = parse_SCtoSLMappingTable(SUBM_Attribute_header_tree, tvb, offset, MAD);\r\nbreak;\r\ncase SM_ATTR_ID_SC_VLR_MAPPING_TABLE:\r\ncase SM_ATTR_ID_SC_VLT_MAPPING_TABLE:\r\ncase SM_ATTR_ID_SC_VLNT_MAPPING_TABLE:\r\nlocal_offset = parse_SCtoVLxMappingTable(SUBM_Attribute_header_tree, tvb, offset, MAD);\r\nbreak;\r\ncase SM_ATTR_ID_PORT_STATE_INFO:\r\nlocal_offset = parse_PortStateInfo(SUBM_Attribute_header_tree, tvb, offset, MAD);\r\nbreak;\r\ncase SM_ATTR_ID_PORT_GROUP_FWD_TABLE:\r\nlocal_offset = parse_PortGroupForwardingTable(SUBM_Attribute_header_tree, tvb, offset, MAD);\r\nbreak;\r\ncase SM_ATTR_ID_PORT_GROUP_TABLE:\r\nlocal_offset = parse_PortGroupTable(SUBM_Attribute_header_tree, tvb, offset, MAD);\r\nbreak;\r\ncase SM_ATTR_ID_BUFFER_CONTROL_TABLE:\r\nlocal_offset = parse_BufferControlTable(SUBM_Attribute_header_tree, tvb, offset, MAD);\r\nbreak;\r\ncase SM_ATTR_ID_CONGESTION_INFO:\r\nlocal_offset = parse_CongestionInfo(SUBM_Attribute_header_tree, tvb, offset, MAD);\r\nbreak;\r\ncase SM_ATTR_ID_SWITCH_CONGESTION_LOG:\r\nlocal_offset = parse_SwitchCongestionLog(SUBM_Attribute_header_tree, tvb, offset, MAD);\r\nbreak;\r\ncase SM_ATTR_ID_SWITCH_CONGESTION_SETTING:\r\nlocal_offset = parse_SwitchCongestionSetting(SUBM_Attribute_header_tree, tvb, offset, MAD);\r\nbreak;\r\ncase SM_ATTR_ID_SWITCH_PORT_CONGESTION_SETTING:\r\nlocal_offset = parse_SwitchPortCongestionSetting(SUBM_Attribute_header_tree, tvb, offset, MAD);\r\nbreak;\r\ncase SM_ATTR_ID_HFI_CONGESTION_LOG:\r\nlocal_offset = parse_HFICongestionLog(SUBM_Attribute_header_tree, tvb, offset, MAD);\r\nbreak;\r\ncase SM_ATTR_ID_HFI_CONGESTION_SETTING:\r\nlocal_offset = parse_HFICongestionSetting(SUBM_Attribute_header_tree, tvb, offset, MAD);\r\nbreak;\r\ncase SM_ATTR_ID_HFI_CONGESTION_CONTROL_TABLE:\r\nlocal_offset = parse_HFICongestionControlTable(SUBM_Attribute_header_tree, tvb, offset, MAD);\r\nbreak;\r\ndefault:\r\nreturn FALSE;\r\n}\r\n*offset = local_offset;\r\nreturn TRUE;\r\n}\r\nstatic gint parse_Aggregate(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint i;\r\nguint requestLength;\r\ngint numAttributes;\r\ngint local_offset = *offset;\r\ngint saved_offset;\r\nguint16 LocalAttributeID = 0;\r\ngboolean AggregatError = FALSE;\r\nproto_item *Aggregate_header_item;\r\nproto_item *Aggregate_Length_item;\r\nproto_item *Aggregate_Error_item;\r\nproto_tree *Aggregate_header_tree;\r\nif (!parentTree)\r\nreturn *offset;\r\nnumAttributes = MAD->AttributeModifier & 0x000000FF;\r\nfor (i = 0; i < numAttributes; i++) {\r\nrequestLength = (tvb_get_guint8(tvb, local_offset + 3) & 0x7F) * 8;\r\nif (i == numAttributes - 1 && MAD->Method == METHOD_GET) {\r\nAggregate_header_item = proto_tree_add_item(parentTree, hf_opa_Aggregate, tvb, local_offset, 8, ENC_NA);\r\n} else {\r\nAggregate_header_item = proto_tree_add_item(parentTree, hf_opa_Aggregate, tvb, local_offset, requestLength + 8, ENC_NA);\r\n}\r\nAggregate_header_tree = proto_item_add_subtree(Aggregate_header_item, ett_aggregate);\r\nproto_tree_add_item(Aggregate_header_tree, hf_opa_Aggregate_AttributeID, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nLocalAttributeID = tvb_get_ntohs(tvb, local_offset);\r\nlocal_offset += 2;\r\nproto_item_set_text(Aggregate_header_item, "Aggregate %u: %s", i + 1, val_to_str(LocalAttributeID, SUBM_Attributes, "Unknown Attribute Type! (0x%02x)"));\r\nAggregatError = (gboolean)tvb_get_bits(tvb, local_offset*8, 1, ENC_BIG_ENDIAN);\r\nAggregate_Error_item = proto_tree_add_item(Aggregate_header_tree, hf_opa_Aggregate_Error, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nif (AggregatError)\r\nexpert_add_info(NULL, Aggregate_Error_item, &ei_opa_aggregate_error);\r\nAggregate_Length_item = proto_tree_add_item(Aggregate_header_tree, hf_opa_Aggregate_RequestLength, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nproto_item_append_text(Aggregate_Length_item, " (%u Bytes)", requestLength);\r\nlocal_offset += 2;\r\nMAD->AttributeModifier = tvb_get_ntohl(tvb, local_offset);\r\nMAD->AttributeID = LocalAttributeID;\r\nlocal_offset = parse_MAD_AttributeModifier(Aggregate_header_tree, tvb, &local_offset, MAD);\r\nif (i == numAttributes - 1 && MAD->Method == METHOD_GET) {\r\n} else {\r\nsaved_offset = local_offset;\r\ncall_SUBM_Parser(Aggregate_header_tree, tvb, &local_offset, MAD, LocalAttributeID);\r\nif (local_offset != (saved_offset + (gint)requestLength)) {\r\nlocal_offset = saved_offset + (gint)requestLength;\r\n}\r\n}\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gboolean parse_SUBM_Attribute(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nif (MAD->AttributeID == SM_ATTR_ID_AGGREGATE) {\r\n*offset = parse_Aggregate(parentTree, tvb, &local_offset, MAD);\r\nreturn TRUE;\r\n} else\r\nreturn call_SUBM_Parser(parentTree, tvb, offset, MAD, MAD->AttributeID);\r\n}\r\nstatic void label_SUBM_Method(proto_item *SubMItem, MAD_t *MAD, packet_info *pinfo)\r\n{\r\nconst guchar *label = val_to_str_const(MAD->Method, SUBM_Methods, "(Unknown SM Method!)");\r\nproto_item_append_text(SubMItem, " %s", label);\r\ncol_append_str(pinfo->cinfo, COL_INFO, label);\r\n}\r\nstatic void label_SUBM_Attribute(proto_item *SubMItem, MAD_t *MAD, packet_info *pinfo)\r\n{\r\nconst guchar *label = val_to_str_const(MAD->AttributeID, SUBM_Attributes, "Attribute (Unknown SM Attribute!)");\r\nproto_item_append_text(SubMItem, "%s", &label[11]);\r\ncol_append_str(pinfo->cinfo, COL_INFO, &label[11]);\r\n}\r\nstatic void parse_SUBN_LID_ROUTED(proto_tree *parentTree, packet_info *pinfo, tvbuff_t *tvb, gint *offset)\r\n{\r\nMAD_t MAD;\r\ngint local_offset;\r\nproto_item *SM_LID_header_item;\r\nproto_tree *SM_LID_header_tree;\r\nif (!parse_MAD_Common(parentTree, pinfo, tvb, offset, &MAD)) {\r\nreturn;\r\n}\r\nlocal_offset = *offset;\r\nSM_LID_header_item = proto_tree_add_item(parentTree, hf_opa_sm_lid, tvb, local_offset, -1, ENC_NA);\r\nSM_LID_header_tree = proto_item_add_subtree(SM_LID_header_item, ett_sm_lid);\r\nproto_tree_add_item(SM_LID_header_tree, hf_opa_sm_m_key, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nlabel_SUBM_Method(SM_LID_header_item, &MAD, pinfo);\r\nlabel_SUBM_Attribute(SM_LID_header_item, &MAD, pinfo);\r\n*offset = local_offset;\r\nif (!pref_parse_on_mad_status_error && MAD.Status) {\r\nlocal_offset += tvb_captured_length_remaining(tvb, *offset);\r\n} else if (!parse_SUBM_Attribute(SM_LID_header_tree, tvb, &local_offset, &MAD)) {\r\nexpert_add_info_format(pinfo, NULL, &ei_opa_mad_no_attribute_dissector,\r\n"Attribute Dissector Not Implemented (0x%x)", MAD.AttributeID);\r\nlocal_offset += tvb_captured_length_remaining(tvb, *offset);\r\n}\r\n*offset = local_offset;\r\n}\r\nstatic void parse_SUBN_DIRECTED_ROUTE(proto_tree *parentTree, packet_info *pinfo, tvbuff_t *tvb, gint *offset)\r\n{\r\nMAD_t MAD;\r\ngint local_offset;\r\nproto_item *SM_DR_header_item;\r\nproto_tree *SM_DR_header_tree;\r\nif (!parse_MAD_Common(parentTree, pinfo, tvb, offset, &MAD)) {\r\nreturn;\r\n}\r\nlocal_offset = *offset;\r\nSM_DR_header_item = proto_tree_add_item(parentTree, hf_opa_sm_dr, tvb, local_offset, -1, ENC_NA);\r\nSM_DR_header_tree = proto_item_add_subtree(SM_DR_header_item, ett_sm_dr);\r\nproto_tree_add_item(SM_DR_header_item, hf_opa_sm_m_key, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nlabel_SUBM_Method(SM_DR_header_item, &MAD, pinfo);\r\nlabel_SUBM_Attribute(SM_DR_header_item, &MAD, pinfo);\r\nproto_tree_add_item(SM_DR_header_tree, hf_opa_sm_dr_slid, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SM_DR_header_tree, hf_opa_sm_dr_dlid, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SM_DR_header_tree, hf_opa_sm_dr_initial_path, tvb, local_offset, 64, ENC_NA);\r\nlocal_offset += 64;\r\nproto_tree_add_item(SM_DR_header_tree, hf_opa_sm_dr_return_path, tvb, local_offset, 64, ENC_NA);\r\nlocal_offset += 64;\r\nproto_tree_add_item(SM_DR_header_tree, hf_opa_sm_dr_reserved64, tvb, local_offset, 8, ENC_NA);\r\nlocal_offset += 8;\r\n*offset = local_offset;\r\nif (!pref_parse_on_mad_status_error && (MAD.Status & 0x7FFF)) {\r\nlocal_offset += tvb_captured_length_remaining(tvb, *offset);\r\n} else if (!parse_SUBM_Attribute(SM_DR_header_tree, tvb, &local_offset, &MAD)) {\r\nexpert_add_info_format(pinfo, NULL, &ei_opa_mad_no_attribute_dissector,\r\n"Attribute Dissector Not Implemented (0x%x)", MAD.AttributeID);\r\nlocal_offset += tvb_captured_length_remaining(tvb, *offset);\r\nreturn;\r\n}\r\n*offset = local_offset;\r\n}\r\nstatic gint parse_PortInfoRecord(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_tree * PortInfoRecord_LinkDownReason_tree,\r\n*PortInfoRecord_LinkDownReason_Entry_tree;\r\ngint i;\r\nlocal_offset = parse_PortInfo(parentTree, tvb, &local_offset, MAD);\r\nPortInfoRecord_LinkDownReason_tree = proto_tree_add_subtree(parentTree, tvb, local_offset, 8 * 16,\r\nett_portinforecord_linkdownreason, NULL, "Port Info Record LinkDown Reason");\r\nfor (i = 0; i < 8; i++) {\r\nPortInfoRecord_LinkDownReason_Entry_tree = proto_tree_add_subtree_format(PortInfoRecord_LinkDownReason_tree, tvb, local_offset, 16,\r\nett_portinforecord_linkdownreason_entry, NULL, "Link Down Reason Entry %u", i);\r\nproto_tree_add_item(PortInfoRecord_LinkDownReason_Entry_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_NA);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PortInfoRecord_LinkDownReason_Entry_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_NA);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PortInfoRecord_LinkDownReason_Entry_tree, hf_opa_PortInfoRecord_LinkDownReason_NeighborLinkDownReason, tvb, local_offset, 1, ENC_NA);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortInfoRecord_LinkDownReason_Entry_tree, hf_opa_PortInfoRecord_LinkDownReason_LinkDownReason, tvb, local_offset, 1, ENC_NA);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortInfoRecord_LinkDownReason_Entry_tree, hf_opa_PortInfoRecord_LinkDownReason_Timestamp, tvb, local_offset, 8, ENC_NA);\r\nlocal_offset += 8;\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_LinkRecord(proto_tree *parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *LinkRecord_header_item;\r\nproto_tree *LinkRecord_header_tree;\r\nif (!parentTree) {\r\nreturn *offset;\r\n}\r\nLinkRecord_header_item = proto_tree_add_item(parentTree, hf_opa_LinkRecord, tvb, local_offset, 7, ENC_NA);\r\nLinkRecord_header_tree = proto_item_add_subtree(LinkRecord_header_item, ett_linkrecord);\r\nproto_tree_add_item(LinkRecord_header_tree, hf_opa_LinkRecord_ToPort, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(LinkRecord_header_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(LinkRecord_header_tree, hf_opa_LinkRecord_ToLID, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nreturn local_offset;\r\n}\r\nstatic gint parse_ServiceRecord(proto_tree *parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *ServiceRecord_header_item;\r\nproto_tree *ServiceRecord_header_tree;\r\nproto_item *tempData;\r\nif (!parentTree) {\r\nreturn *offset;\r\n}\r\nServiceRecord_header_item = proto_tree_add_item(parentTree, hf_opa_ServiceRecord, tvb, local_offset, 152, ENC_NA);\r\nServiceRecord_header_tree = proto_item_add_subtree(ServiceRecord_header_item, ett_servicerecord);\r\nproto_tree_add_item(ServiceRecord_header_tree, hf_opa_ServiceRecord_ServiceLease, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(ServiceRecord_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(ServiceRecord_header_tree, hf_opa_ServiceRecord_ServiceKey, tvb, local_offset, 16, ENC_NA);\r\nlocal_offset += 16;\r\nproto_tree_add_item(ServiceRecord_header_tree, hf_opa_ServiceRecord_ServiceName, tvb, local_offset, 64, ENC_ASCII | ENC_NA);\r\nlocal_offset += 64;\r\ntempData = proto_tree_add_item(ServiceRecord_header_tree, hf_opa_ServiceRecord_ServiceData, tvb, local_offset, 16, ENC_NA);\r\nlocal_offset += 16;\r\nproto_item_append_text(tempData, "(ServiceData 8.1, 8.16)");\r\ntempData = proto_tree_add_item(ServiceRecord_header_tree, hf_opa_ServiceRecord_ServiceData, tvb, local_offset, 16, ENC_NA);\r\nlocal_offset += 16;\r\nproto_item_append_text(tempData, "(ServiceData 16.1, 16.8)");\r\ntempData = proto_tree_add_item(ServiceRecord_header_tree, hf_opa_ServiceRecord_ServiceData, tvb, local_offset, 16, ENC_NA);\r\nlocal_offset += 16;\r\nproto_item_append_text(tempData, "(ServiceData 32.1, 32.4)");\r\ntempData = proto_tree_add_item(ServiceRecord_header_tree, hf_opa_ServiceRecord_ServiceData, tvb, local_offset, 16, ENC_NA);\r\nlocal_offset += 16;\r\nproto_item_append_text(tempData, "(ServiceData 64.1, 64.2)");\r\nreturn local_offset;\r\n}\r\nstatic gint parse_PathRecord(proto_tree *parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item * PathRecord_header_item,\r\n*PathRecord_DGID_item,\r\n*PathRecord_SGID_item;\r\nproto_tree * PathRecord_header_tree,\r\n*PathRecord_DGID_tree,\r\n*PathRecord_SGID_tree;\r\nif (!parentTree) {\r\nreturn *offset;\r\n}\r\nPathRecord_header_item = proto_tree_add_item(parentTree, hf_opa_PathRecord, tvb, local_offset, 64, ENC_NA);\r\nPathRecord_header_tree = proto_item_add_subtree(PathRecord_header_item, ett_pathrecord);\r\nproto_tree_add_item(PathRecord_header_tree, hf_opa_PathRecord_ServiceID, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nPathRecord_DGID_item = proto_tree_add_item(PathRecord_header_tree, hf_opa_PathRecord_DGID, tvb, local_offset, 16, ENC_NA);\r\nPathRecord_DGID_tree = proto_item_add_subtree(PathRecord_DGID_item, ett_pathrecord_dgid);\r\nproto_tree_add_item(PathRecord_DGID_tree, hf_opa_PathRecord_DGID_L2_8B, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PathRecord_DGID_tree, hf_opa_PathRecord_DGID_L2_10B, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PathRecord_DGID_tree, hf_opa_PathRecord_DGID_L2_9B, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PathRecord_DGID_tree, hf_opa_PathRecord_DGID_L2_16B, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PathRecord_DGID_tree, hf_opa_PathRecord_DGID_L2_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PathRecord_DGID_tree, hf_opa_PathRecord_DGID_LIDLen, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PathRecord_DGID_tree, hf_opa_PathRecord_DGID_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PathRecord_DGID_tree, hf_opa_PathRecord_DGID_SL, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PathRecord_DGID_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PathRecord_DGID_tree, hf_opa_PathRecord_DGID_DLIDHigh, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PathRecord_DGID_tree, hf_opa_PathRecord_DGID_SLIDHigh, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PathRecord_DGID_tree, hf_opa_PathRecord_DGID_DestGUID, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nPathRecord_SGID_item = proto_tree_add_item(PathRecord_header_tree, hf_opa_PathRecord_SGID, tvb, local_offset, 16, ENC_NA);\r\nPathRecord_SGID_tree = proto_item_add_subtree(PathRecord_SGID_item, ett_pathrecord_sgid);\r\nproto_tree_add_item(PathRecord_SGID_tree, hf_opa_PathRecord_SGID_SubnetPrefix, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PathRecord_SGID_tree, hf_opa_PathRecord_SGID_SourceGUID, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PathRecord_header_tree, hf_opa_PathRecord_DLID, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PathRecord_header_tree, hf_opa_PathRecord_SLID, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PathRecord_header_tree, hf_opa_PathRecord_RawTraffic, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PathRecord_header_tree, hf_opa_PathRecord_reserved, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PathRecord_header_tree, hf_opa_PathRecord_FlowLabel, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PathRecord_header_tree, hf_opa_PathRecord_HopLimit, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PathRecord_header_tree, hf_opa_PathRecord_TClass, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PathRecord_header_tree, hf_opa_PathRecord_Reversible, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PathRecord_header_tree, hf_opa_PathRecord_NumbPath, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PathRecord_header_tree, hf_opa_PathRecord_P_Key, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PathRecord_header_tree, hf_opa_PathRecord_QosType, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PathRecord_header_tree, hf_opa_PathRecord_reserved2, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PathRecord_header_tree, hf_opa_PathRecord_QosPriority, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PathRecord_header_tree, hf_opa_PathRecord_SL, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PathRecord_header_tree, hf_opa_PathRecord_MTUSelector, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PathRecord_header_tree, hf_opa_PathRecord_MTU, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PathRecord_header_tree, hf_opa_PathRecord_RateSelector, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PathRecord_header_tree, hf_opa_PathRecord_Rate, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PathRecord_header_tree, hf_opa_PathRecord_PacketLifeTimeSelector, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PathRecord_header_tree, hf_opa_PathRecord_PacketLifeTime, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PathRecord_header_tree, hf_opa_PathRecord_Preference, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PathRecord_header_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PathRecord_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nreturn local_offset;\r\n}\r\nstatic gint parse_MCMemberRecord(proto_tree *parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *MCMemberRecord_header_item;\r\nproto_tree *MCMemberRecord_header_tree;\r\nif (!parentTree) {\r\nreturn *offset;\r\n}\r\nMCMemberRecord_header_item = proto_tree_add_item(parentTree, hf_opa_MCMemberRecord, tvb, local_offset, 24, ENC_NA);\r\nMCMemberRecord_header_tree = proto_item_add_subtree(MCMemberRecord_header_item, ett_mcmemberrecord);\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_opa_MCMemberRecord_Q_Key, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_opa_MCMemberRecord_MTUSelector, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_opa_MCMemberRecord_MTU, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_opa_MCMemberRecord_TClass, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_opa_MCMemberRecord_P_Key, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_opa_MCMemberRecord_RateSelector, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_opa_MCMemberRecord_Rate, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_opa_MCMemberRecord_PacketLifeTimeSelector, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_opa_MCMemberRecord_PacketLifeTime, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_opa_MCMemberRecord_SL, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_opa_MCMemberRecord_reserved, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_opa_MCMemberRecord_HopLimit, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_opa_MCMemberRecord_Scope, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_opa_MCMemberRecord_reserved2, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_opa_MCMemberRecord_JoinSendOnlyMember, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_opa_MCMemberRecord_JoinNonMember, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_opa_MCMemberRecord_JoinFullMember, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_opa_MCMemberRecord_ProxyJoin, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_opa_MCMemberRecord_reserved3, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_opa_MCMemberRecord_MLID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nreturn local_offset;\r\n}\r\nstatic gint parse_TraceRecord(proto_tree *parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *TraceRecord_header_item;\r\nproto_tree *TraceRecord_header_tree;\r\nif (!parentTree) {\r\nreturn *offset;\r\n}\r\nTraceRecord_header_item = proto_tree_add_item(parentTree, hf_opa_TraceRecord, tvb, local_offset, 40, ENC_NA);\r\nTraceRecord_header_tree = proto_item_add_subtree(TraceRecord_header_item, ett_tracerecord);\r\nproto_tree_add_item(TraceRecord_header_tree, hf_opa_TraceRecord_IDGeneration, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(TraceRecord_header_tree, hf_opa_reserved8, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(TraceRecord_header_tree, hf_opa_TraceRecord_NodeType, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(TraceRecord_header_tree, hf_opa_TraceRecord_EntryPort, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(TraceRecord_header_tree, hf_opa_TraceRecord_ExitPort, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(TraceRecord_header_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(TraceRecord_header_tree, hf_opa_TraceRecord_NodeID, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(TraceRecord_header_tree, hf_opa_TraceRecord_ChassisID, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(TraceRecord_header_tree, hf_opa_TraceRecord_EntryPortID, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(TraceRecord_header_tree, hf_opa_TraceRecord_ExitPortID, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nreturn local_offset;\r\n}\r\nstatic gint parse_MultiPathRecord_GID(proto_tree *parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *MultiPathRecord_header_item;\r\nproto_tree *MultiPathRecord_header_tree;\r\nproto_item *SDGID;\r\nguint8 SGIDCount;\r\nguint8 DGIDCount;\r\nguint32 i;\r\nif (!parentTree)\r\nreturn *offset;\r\nSGIDCount = tvb_get_guint8(tvb, local_offset + 14);\r\nDGIDCount = tvb_get_guint8(tvb, local_offset + 15);\r\nMultiPathRecord_header_item = proto_tree_add_item(parentTree, hf_opa_MultiPathRecord, tvb, local_offset, 32 + (SGIDCount + DGIDCount) * 16, ENC_NA);\r\nproto_item_append_text(MultiPathRecord_header_item, " (GID)");\r\nMultiPathRecord_header_tree = proto_item_add_subtree(MultiPathRecord_header_item, ett_multipathrecord_gid);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_reserved, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_FlowLabel, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_HopLimit, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_TClass, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_Reversible, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_NumbPath, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_P_Key, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_QoSType, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_QoSPriority, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_reserved2, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_SL, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_MTUSelector, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_MTU, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_RateSelector, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_Rate, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_PacketLifeTimeSelector, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_PacketLifeTime, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_IndependenceSelector, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_SGIDScope, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_DGIDScope, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_SGIDCount, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_DGIDCount, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_sa_ServiceID, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_L2_8B, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_L2_10B, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_L2_9B, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_L2_16B, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_reserved3, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_reserved24, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nfor (i = 0; i < SGIDCount; i++) {\r\nSDGID = proto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_SGID, tvb, local_offset, 16, ENC_NA);\r\nlocal_offset += 16;\r\nproto_item_prepend_text(SDGID, "%u: ", i);\r\n}\r\nfor (i = 0; i < DGIDCount; i++) {\r\nSDGID = proto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_DGID, tvb, local_offset, 16, ENC_NA);\r\nlocal_offset += 16;\r\nproto_item_prepend_text(SDGID, "%u: ", i);\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_MultiPathRecord_GUID(proto_tree *parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *MultiPathRecord_header_item;\r\nproto_tree *MultiPathRecord_header_tree;\r\nproto_item *SDGUID;\r\nguint16 SGUIDCount;\r\nguint16 DGUIDCount;\r\nguint32 i;\r\nif (!parentTree)\r\nreturn *offset;\r\nSGUIDCount = tvb_get_ntohs(tvb, local_offset + 14);\r\nDGUIDCount = tvb_get_ntohs(tvb, local_offset + 16);\r\nMultiPathRecord_header_item = proto_tree_add_item(parentTree, hf_opa_MultiPathRecord, tvb, local_offset, 40 + (SGUIDCount + DGUIDCount) * 8, ENC_NA);\r\nproto_item_append_text(MultiPathRecord_header_item, " (GUID)");\r\nMultiPathRecord_header_tree = proto_item_add_subtree(MultiPathRecord_header_item, ett_multipathrecord_guid);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_reserved, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_FlowLabel, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_HopLimit, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_TClass, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_Reversible, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_NumbPath, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_P_Key, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_QoSType, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_QoSPriority, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_reserved2, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_SL, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_MTUSelector, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_MTU, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_RateSelector, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_Rate, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_PacketLifeTimeSelector, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_PacketLifeTime, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_IndependenceSelector, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_SGUIDScope, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_DGUIDScope, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_SGUIDCount, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_DGUIDCount, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_L2_8B, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_L2_10B, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_L2_9B, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_L2_16B, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_reserved3, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_reserved8, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_ServiceID, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_SubnetPrefix, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nfor (i = 0; i < SGUIDCount; i++) {\r\nSDGUID = proto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_SGUID, tvb, local_offset, 8, ENC_NA);\r\nlocal_offset += 8;\r\nproto_item_prepend_text(SDGUID, "%u: ", i);\r\n}\r\nfor (i = 0; i < DGUIDCount; i++) {\r\nSDGUID = proto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_DGUID, tvb, local_offset, 8, ENC_NA);\r\nlocal_offset += 8;\r\nproto_item_prepend_text(SDGUID, "%u: ", i);\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_MultiPathRecord_lid(proto_tree *parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *MultiPathRecord_header_item;\r\nproto_tree *MultiPathRecord_header_tree;\r\nproto_item *SDLID;\r\nguint16 SLIDCount;\r\nguint16 DLIDCount;\r\nguint32 i;\r\nif (!parentTree)\r\nreturn *offset;\r\nSLIDCount = tvb_get_ntohs(tvb, local_offset + 14);\r\nDLIDCount = tvb_get_ntohs(tvb, local_offset + 16);\r\nMultiPathRecord_header_item = proto_tree_add_item(parentTree, hf_opa_MultiPathRecord, tvb, local_offset, 40 + (SLIDCount + DLIDCount) * 4, ENC_NA);\r\nMultiPathRecord_header_tree = proto_item_add_subtree(MultiPathRecord_header_item, ett_multipathrecord_lid);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_reserved, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_FlowLabel, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_HopLimit, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_TClass, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_Reversible, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_NumbPath, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_P_Key, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_QoSType, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_QoSPriority, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_reserved2, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_SL, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_MTUSelector, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_MTU, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_RateSelector, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_Rate, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_PacketLifeTimeSelector, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_PacketLifeTime, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_IndependenceSelector, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_SGUIDScope, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_DGUIDScope, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_SLIDCount, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_DLIDCount, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_L2_8B, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_L2_10B, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_L2_9B, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_L2_16B, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_reserved3, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_reserved8, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_ServiceID, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_SubnetPrefix, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nfor (i = 0; i < SLIDCount; i++) {\r\nSDLID = proto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_SLID, tvb, local_offset, 4, ENC_NA);\r\nlocal_offset += 4;\r\nproto_item_prepend_text(SDLID, "%u: ", i);\r\n}\r\nfor (i = 0; i < DLIDCount; i++) {\r\nSDLID = proto_tree_add_item(MultiPathRecord_header_tree, hf_opa_MultiPathRecord_DLID, tvb, local_offset, 4, ENC_NA);\r\nlocal_offset += 4;\r\nproto_item_prepend_text(SDLID, "%u: ", i);\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_CableInfoRecord(proto_tree *parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *CableInfoRecord_header_item;\r\nproto_tree *CableInfoRecord_header_tree;\r\nif (!parentTree)\r\nreturn *offset;\r\nCableInfoRecord_header_item = proto_tree_add_item(parentTree, hf_opa_CableInfoRecord, tvb, local_offset, 72, ENC_NA);\r\nCableInfoRecord_header_tree = proto_item_add_subtree(CableInfoRecord_header_item, ett_cableinforecord);\r\nproto_tree_add_item(CableInfoRecord_header_tree, hf_opa_CableInfoRecord_Lid, tvb, local_offset, 4, ENC_NA);\r\nlocal_offset += 4;\r\nproto_tree_add_item(CableInfoRecord_header_tree, hf_opa_CableInfoRecord_Port, tvb, local_offset, 1, ENC_NA);\r\nlocal_offset += 1;\r\nproto_tree_add_item(CableInfoRecord_header_tree, hf_opa_CableInfoRecord_Length, tvb, local_offset, 1, ENC_NA);\r\nproto_tree_add_item(CableInfoRecord_header_tree, hf_opa_CableInfoRecord_reserved, tvb, local_offset, 1, ENC_NA);\r\nlocal_offset += 1;\r\nproto_tree_add_item(CableInfoRecord_header_tree, hf_opa_CableInfoRecord_Address, tvb, local_offset, 2, ENC_NA);\r\nproto_tree_add_item(CableInfoRecord_header_tree, hf_opa_CableInfoRecord_PortType, tvb, local_offset, 2, ENC_NA);\r\nlocal_offset += 2;\r\nproto_tree_add_item(CableInfoRecord_header_tree, hf_opa_CableInfoRecord_Data, tvb, local_offset, 64, ENC_NA);\r\nlocal_offset += 64;\r\nreturn local_offset;\r\n}\r\nstatic gint parse_ServiceAssociationRecord(proto_tree *parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_tree *ServiceAssociationRecord_header_tree;\r\nif (!parentTree) {\r\nreturn *offset;\r\n}\r\nServiceAssociationRecord_header_tree = parentTree;\r\nproto_tree_add_item(ServiceAssociationRecord_header_tree, hf_opa_ServiceAssociationRecord_ServiceKey, tvb, local_offset, 16, ENC_NA);\r\nlocal_offset += 16;\r\nproto_tree_add_item(ServiceAssociationRecord_header_tree, hf_opa_ServiceAssociationRecord_ServiceName, tvb, local_offset, 64, ENC_ASCII | ENC_NA);\r\nlocal_offset += 64;\r\nreturn local_offset;\r\n}\r\nstatic gint parse_VFInfoRecord(proto_tree *parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *VFInfoRecord_header_item;\r\nproto_tree *VFInfoRecord_header_tree;\r\nif (!parentTree)\r\nreturn *offset;\r\nVFInfoRecord_header_item = proto_tree_add_item(parentTree, hf_opa_VFInfoRecord, tvb, local_offset, 128, ENC_NA);\r\nVFInfoRecord_header_tree = proto_item_add_subtree(VFInfoRecord_header_item, ett_vfinforecord);\r\nproto_tree_add_item(VFInfoRecord_header_tree, hf_opa_VFInfoRecord_vfIndex, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(VFInfoRecord_header_tree, hf_opa_VFInfoRecord_pKey, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(VFInfoRecord_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(VFInfoRecord_header_tree, hf_opa_VFInfoRecord_vfName, tvb, local_offset, 64, ENC_ASCII | ENC_NA);\r\nlocal_offset += 64;\r\nproto_tree_add_item(VFInfoRecord_header_tree, hf_opa_sa_ServiceID, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(VFInfoRecord_header_tree, hf_opa_VFInfoRecord_MGID, tvb, local_offset, 16, ENC_NA);\r\nlocal_offset += 16;\r\nproto_tree_add_item(VFInfoRecord_header_tree, hf_opa_VFInfoRecord_SelectFlags, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(VFInfoRecord_header_tree, hf_opa_VFInfoRecord_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(VFInfoRecord_header_tree, hf_opa_VFInfoRecord_SL, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(VFInfoRecord_header_tree, hf_opa_VFInfoRecord_MTUSpecified, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(VFInfoRecord_header_tree, hf_opa_VFInfoRecord_reserved2, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(VFInfoRecord_header_tree, hf_opa_VFInfoRecord_MTU, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(VFInfoRecord_header_tree, hf_opa_VFInfoRecord_RateSpecified, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(VFInfoRecord_header_tree, hf_opa_VFInfoRecord_reserved4, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(VFInfoRecord_header_tree, hf_opa_VFInfoRecord_Rate, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(VFInfoRecord_header_tree, hf_opa_VFInfoRecord_PktLifeSpecified, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(VFInfoRecord_header_tree, hf_opa_VFInfoRecord_reserved5, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(VFInfoRecord_header_tree, hf_opa_VFInfoRecord_PktLifeTimeInc, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(VFInfoRecord_header_tree, hf_opa_VFInfoRecord_OptionFlags, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(VFInfoRecord_header_tree, hf_opa_VFInfoRecord_BandwidthPercent, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(VFInfoRecord_header_tree, hf_opa_VFInfoRecord_reserved6, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(VFInfoRecord_header_tree, hf_opa_VFInfoRecord_Priority, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(VFInfoRecord_header_tree, hf_opa_VFInfoRecord_RoutingSLs, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(VFInfoRecord_header_tree, hf_opa_VFInfoRecord_reserved7, tvb, local_offset, 24, ENC_NA);\r\nlocal_offset += 24;\r\nreturn local_offset;\r\n}\r\nstatic gint parse_QuarantinedNodeRecord(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *QuarantinedNodeRecord_header_item;\r\nproto_tree *QuarantinedNodeRecord_header_tree;\r\nif (!parentTree || MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE)\r\nreturn *offset;\r\nQuarantinedNodeRecord_header_item = proto_tree_add_item(parentTree, hf_opa_QuarantinedNodeRecord, tvb, local_offset, 213, ENC_NA);\r\nQuarantinedNodeRecord_header_tree = proto_item_add_subtree(QuarantinedNodeRecord_header_item, ett_quarantinednoderecord);\r\nproto_tree_add_item(QuarantinedNodeRecord_header_tree, hf_opa_QuarantinedNodeRecord_TrustedLid, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(QuarantinedNodeRecord_header_tree, hf_opa_QuarantinedNodeRecord_TrustedPortNum, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(QuarantinedNodeRecord_header_tree, hf_opa_reserved24, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(QuarantinedNodeRecord_header_tree, hf_opa_QuarantinedNodeRecord_TrustedNodeGUID, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(QuarantinedNodeRecord_header_tree, hf_opa_QuarantinedNodeRecord_TrustedNeighborNodeGUID, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nlocal_offset = parse_NodeDescription(QuarantinedNodeRecord_header_tree, tvb, &local_offset, MAD);\r\nlocal_offset = parse_NodeInfo(QuarantinedNodeRecord_header_tree, tvb, &local_offset, MAD);\r\nproto_tree_add_item(QuarantinedNodeRecord_header_tree, hf_opa_QuarantinedNodeRecord_QuarantineReasons, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(QuarantinedNodeRecord_header_tree, hf_opa_QuarantinedNodeRecord_ExpectedNodeDesc, tvb, local_offset, 64, ENC_BIG_ENDIAN);\r\nlocal_offset += 64;\r\nproto_tree_add_item(QuarantinedNodeRecord_header_tree, hf_opa_QuarantinedNodeRecord_ExpectedNodeGUID, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(QuarantinedNodeRecord_header_tree, hf_opa_QuarantinedNodeRecord_ExpectedPortGUID, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nreturn local_offset;\r\n}\r\nstatic void parse_RID(proto_tree *SA_header_tree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nif (!SA_header_tree)\r\nreturn;\r\nswitch (MAD->AttributeID) {\r\ncase SA_ATTR_ID_CLASS_PORT_INFO:\r\nbreak;\r\ncase SA_ATTR_ID_NOTICE:\r\nbreak;\r\ncase SA_ATTR_ID_NODE_RECORD:\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_Lid, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nbreak;\r\ncase SA_ATTR_ID_PORTINFO_RECORD:\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_EndportLID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_PortNum, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(SA_header_tree, hf_opa_reserved8, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nbreak;\r\ncase SA_ATTR_ID_SC_MAPTBL_RECORD:\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_Lid, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_InputPortNum, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_OutputPortNum, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nbreak;\r\ncase SA_ATTR_ID_SL2SC_MAPTBL_RECORD:\r\ncase SA_ATTR_ID_SC2SL_MAPTBL_RECORD:\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_Lid, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SA_header_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nbreak;\r\ncase SA_ATTR_ID_SC_VLNT_MAPTBL_RECORD:\r\ncase SA_ATTR_ID_SC_VLT_MAPTBL_RECORD:\r\ncase SA_ATTR_ID_SC_VLR_MAPTBL_RECORD:\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_Lid, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_Port, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nbreak;\r\ncase SA_ATTR_ID_SWITCHINFO_RECORD:\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_Lid, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nbreak;\r\ncase SA_ATTR_ID_LINEAR_FWDTBL_RECORD:\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_Lid, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_reserved14, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_BlockNum_18b, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nbreak;\r\ncase SA_ATTR_ID_MCAST_FWDTBL_RECORD:\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_Lid, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_Position, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_reserved9, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_BlockNum_21b, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nbreak;\r\ncase SA_ATTR_ID_VLARBTABLE_RECORD:\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_Lid, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_OutputPortNum, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_BlockNum_8b, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nbreak;\r\ncase SA_ATTR_ID_SMINFO_RECORD:\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_Lid, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nbreak;\r\ncase SA_ATTR_ID_P_KEY_TABLE_RECORD:\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_Lid, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_BlockNum_16b, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_PortNum, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nbreak;\r\ncase SA_ATTR_ID_INFORM_INFO_RECORD:\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_SubscriberLID, tvb, local_offset, 4, ENC_NA);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_Enum, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nbreak;\r\ncase SA_ATTR_ID_LINK_RECORD:\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_FromLID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_FromPort, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nbreak;\r\ncase SA_ATTR_ID_SERVICE_RECORD:\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_ServiceID, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_ServiceLID, tvb, local_offset, 4, ENC_NA);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_ServiceP_Key, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(SA_header_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_ServiceGID, tvb, local_offset, 16, ENC_NA);\r\nlocal_offset += 16;\r\nbreak;\r\ncase SA_ATTR_ID_PATH_RECORD:\r\nbreak;\r\ncase SA_ATTR_ID_MCMEMBER_RECORD:\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_MGID, tvb, local_offset, 16, ENC_NA);\r\nlocal_offset += 16;\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_PortGID, tvb, local_offset, 16, ENC_NA);\r\nlocal_offset += 16;\r\nbreak;\r\ncase SA_ATTR_ID_TRACE_RECORD:\r\nbreak;\r\ncase SA_ATTR_ID_MULTIPATH_GID_RECORD:\r\nbreak;\r\ncase SA_ATTR_ID_MULTIPATH_GUID_RECORD:\r\nbreak;\r\ncase SA_ATTR_ID_MULTIPATH_LID_RECORD:\r\nbreak;\r\ncase SA_ATTR_ID_CABLE_INFO_RECORD:\r\nbreak;\r\ncase SA_ATTR_ID_VF_INFO_RECORD:\r\nbreak;\r\ncase SA_ATTR_ID_QUARANTINED_NODE_RECORD:\r\nbreak;\r\ncase SA_ATTR_ID_CONGESTION_INFO_RECORD:\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_Lid, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nbreak;\r\ncase SA_ATTR_ID_SWITCH_CONG_RECORD:\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_Lid, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nbreak;\r\ncase SA_ATTR_ID_SWITCH_PORT_CONG_RECORD:\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_Lid, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_Port, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nbreak;\r\ncase SA_ATTR_ID_HFI_CONG_RECORD:\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_Lid, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nbreak;\r\ncase SA_ATTR_ID_HFI_CONG_CTRL_RECORD:\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_Lid, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_BlockNum_16b, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nbreak;\r\ncase SA_ATTR_ID_BUFF_CTRL_TAB_RECORD:\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_Lid, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(SA_header_tree, hf_opa_sa_Port, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nbreak;\r\ncase SA_ATTR_ID_FABRICINFO_RECORD:\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n*offset = local_offset;\r\n}\r\nstatic gboolean parse_SUBA_Attribute(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD, RMPP_t *RMPP, SA_HEADER_t *SA_HEADER)\r\n{\r\nproto_tree *SUBA_Attribute_header_tree = parentTree;\r\nguint local_offset = *offset;\r\nif (RMPP->Type == RMPP_ACK || SA_HEADER->AttributeOffset == 0)\r\nreturn TRUE;\r\nparse_RID(SUBA_Attribute_header_tree, tvb, &local_offset, MAD);\r\nswitch (MAD->AttributeID) {\r\ncase SA_ATTR_ID_CLASS_PORT_INFO:\r\nlocal_offset = parse_ClassPortInfo(SUBA_Attribute_header_tree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase SA_ATTR_ID_NOTICE:\r\nlocal_offset = parse_NoticesAndTraps(SUBA_Attribute_header_tree, tvb, &local_offset);\r\nbreak;\r\ncase SA_ATTR_ID_INFORM_INFO:\r\nlocal_offset = parse_InformInfo(SUBA_Attribute_header_tree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase SA_ATTR_ID_NODE_RECORD:\r\nproto_tree_add_item(SUBA_Attribute_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nlocal_offset = parse_NodeInfo(SUBA_Attribute_header_tree, tvb, &local_offset, MAD);\r\nlocal_offset = parse_NodeDescription(SUBA_Attribute_header_tree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase SA_ATTR_ID_PORTINFO_RECORD:\r\nproto_tree_add_item(SUBA_Attribute_header_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nlocal_offset = parse_PortInfoRecord(SUBA_Attribute_header_tree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase SA_ATTR_ID_SL2SC_MAPTBL_RECORD:\r\nlocal_offset = parse_SLtoSCMappingTable(SUBA_Attribute_header_tree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase SA_ATTR_ID_SC_MAPTBL_RECORD:\r\nlocal_offset = parse_SCMappingTable(SUBA_Attribute_header_tree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase SA_ATTR_ID_SC2SL_MAPTBL_RECORD:\r\nproto_tree_add_item(SUBA_Attribute_header_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nlocal_offset = parse_SCtoSLMappingTable(SUBA_Attribute_header_tree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase SA_ATTR_ID_SC_VLNT_MAPTBL_RECORD:\r\ncase SA_ATTR_ID_SC_VLT_MAPTBL_RECORD:\r\ncase SA_ATTR_ID_SC_VLR_MAPTBL_RECORD:\r\nproto_tree_add_item(SUBA_Attribute_header_tree, hf_opa_reserved24, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nlocal_offset = parse_SCtoVLxMappingTable(SUBA_Attribute_header_tree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase SA_ATTR_ID_SWITCHINFO_RECORD:\r\nproto_tree_add_item(SUBA_Attribute_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nlocal_offset = parse_SwitchInfo(SUBA_Attribute_header_tree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase SA_ATTR_ID_LINEAR_FWDTBL_RECORD:\r\nlocal_offset = parse_LinearForwardingTable(SUBA_Attribute_header_tree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase SA_ATTR_ID_MCAST_FWDTBL_RECORD:\r\nlocal_offset = parse_MulticastForwardingTable(SUBA_Attribute_header_tree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase SA_ATTR_ID_VLARBTABLE_RECORD:\r\nproto_tree_add_item(SUBA_Attribute_header_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nlocal_offset = parse_VLArbitrationTable(SUBA_Attribute_header_tree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase SA_ATTR_ID_SMINFO_RECORD:\r\nproto_tree_add_item(SUBA_Attribute_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nlocal_offset = parse_SMInfo(SUBA_Attribute_header_tree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase SA_ATTR_ID_P_KEY_TABLE_RECORD:\r\nproto_tree_add_item(SUBA_Attribute_header_tree, hf_opa_reserved8, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nlocal_offset = parse_P_KeyTable(SUBA_Attribute_header_tree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase SA_ATTR_ID_INFORM_INFO_RECORD:\r\nproto_tree_add_item(SUBA_Attribute_header_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nlocal_offset = parse_InformInfo(SUBA_Attribute_header_tree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase SA_ATTR_ID_LINK_RECORD:\r\nlocal_offset = parse_LinkRecord(SUBA_Attribute_header_tree, tvb, &local_offset);\r\nbreak;\r\ncase SA_ATTR_ID_SERVICE_RECORD:\r\nlocal_offset = parse_ServiceRecord(SUBA_Attribute_header_tree, tvb, &local_offset);\r\nbreak;\r\ncase SA_ATTR_ID_PATH_RECORD:\r\nlocal_offset = parse_PathRecord(SUBA_Attribute_header_tree, tvb, &local_offset);\r\nbreak;\r\ncase SA_ATTR_ID_MCMEMBER_RECORD:\r\nlocal_offset = parse_MCMemberRecord(SUBA_Attribute_header_tree, tvb, &local_offset);\r\nbreak;\r\ncase SA_ATTR_ID_TRACE_RECORD:\r\nlocal_offset = parse_TraceRecord(SUBA_Attribute_header_tree, tvb, &local_offset);\r\nbreak;\r\ncase SA_ATTR_ID_MULTIPATH_GID_RECORD:\r\nlocal_offset = parse_MultiPathRecord_GID(SUBA_Attribute_header_tree, tvb, &local_offset);\r\nbreak;\r\ncase SA_ATTR_ID_MULTIPATH_GUID_RECORD:\r\nlocal_offset = parse_MultiPathRecord_GUID(SUBA_Attribute_header_tree, tvb, &local_offset);\r\nbreak;\r\ncase SA_ATTR_ID_MULTIPATH_LID_RECORD:\r\nlocal_offset = parse_MultiPathRecord_lid(SUBA_Attribute_header_tree, tvb, &local_offset);\r\nbreak;\r\ncase SA_ATTR_ID_SERVICEASSOCIATION_RECORD:\r\nlocal_offset = parse_ServiceAssociationRecord(SUBA_Attribute_header_tree, tvb, &local_offset);\r\nbreak;\r\ncase SA_ATTR_ID_PGROUP_FWDTBL_RECORD:\r\nlocal_offset = parse_PortGroupForwardingTable(SUBA_Attribute_header_tree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase SA_ATTR_ID_CABLE_INFO_RECORD:\r\nlocal_offset = parse_CableInfoRecord(SUBA_Attribute_header_tree, tvb, &local_offset);\r\nbreak;\r\ncase SA_ATTR_ID_VF_INFO_RECORD:\r\nlocal_offset = parse_VFInfoRecord(SUBA_Attribute_header_tree, tvb, &local_offset);\r\nbreak;\r\ncase SA_ATTR_ID_QUARANTINED_NODE_RECORD:\r\nlocal_offset = parse_QuarantinedNodeRecord(SUBA_Attribute_header_tree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase SA_ATTR_ID_CONGESTION_INFO_RECORD:\r\nproto_tree_add_item(SUBA_Attribute_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nlocal_offset = parse_CongestionInfo(SUBA_Attribute_header_tree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase SA_ATTR_ID_SWITCH_CONG_RECORD:\r\nproto_tree_add_item(SUBA_Attribute_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nlocal_offset = parse_SwitchCongestionSetting(SUBA_Attribute_header_tree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase SA_ATTR_ID_SWITCH_PORT_CONG_RECORD:\r\nproto_tree_add_item(SUBA_Attribute_header_tree, hf_opa_reserved24, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nlocal_offset = parse_SwitchPortCongestionSetting(SUBA_Attribute_header_tree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase SA_ATTR_ID_HFI_CONG_RECORD:\r\nproto_tree_add_item(SUBA_Attribute_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nlocal_offset = parse_HFICongestionSetting(SUBA_Attribute_header_tree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase SA_ATTR_ID_HFI_CONG_CTRL_RECORD:\r\nproto_tree_add_item(SUBA_Attribute_header_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nlocal_offset = parse_HFICongestionControlTable(SUBA_Attribute_header_tree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase SA_ATTR_ID_BUFF_CTRL_TAB_RECORD:\r\nproto_tree_add_item(SUBA_Attribute_header_tree, hf_opa_reserved24, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nlocal_offset = parse_BufferControlTable(SUBA_Attribute_header_tree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase SA_ATTR_ID_FABRICINFO_RECORD:\r\nlocal_offset = parse_FabricInfoRecord(SUBA_Attribute_header_tree, tvb, &local_offset, MAD);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n*offset = local_offset;\r\nreturn TRUE;\r\n}\r\nstatic void label_SUBA_Method(proto_item *SubAItem, MAD_t *MAD, packet_info *pinfo)\r\n{\r\nconst guchar *label = val_to_str_const(MAD->Method, SUBA_Methods, "(Unknown SA Method!)");\r\nproto_item_append_text(SubAItem, " %s", label);\r\ncol_append_str(pinfo->cinfo, COL_INFO, label);\r\n}\r\nstatic void label_SUBA_Attribute(proto_item *SubAItem, MAD_t *MAD, packet_info *pinfo)\r\n{\r\nconst guchar *label = val_to_str_const(MAD->AttributeID, SUBA_Attributes, "Attribute (Unknown SA Attribute!)");\r\nproto_item_append_text(SubAItem, "%s", &label[11]);\r\ncol_append_str(pinfo->cinfo, COL_INFO, &label[11]);\r\n}\r\nstatic gboolean parse_SA_HEADER(proto_tree *parentTree, packet_info *pinfo, tvbuff_t *tvb, gint *offset, MAD_t *MAD, SA_HEADER_t *SA_HEADER)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *SA_HEADER_header_item;\r\nproto_tree *SA_HEADER_header_tree;\r\nSA_HEADER_header_item = proto_tree_add_item(parentTree, hf_opa_sa, tvb, local_offset, 20, ENC_NA);\r\nSA_HEADER_header_tree = proto_item_add_subtree(SA_HEADER_header_item, ett_sa);\r\nSA_HEADER->SM_Key = tvb_get_ntoh64(tvb, local_offset);\r\nproto_tree_add_item(SA_HEADER_header_tree, hf_opa_sa_sm_key, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nSA_HEADER->AttributeOffset = tvb_get_ntohs(tvb, local_offset);\r\nproto_tree_add_item(SA_HEADER_header_tree, hf_opa_sa_attribute_offset, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nSA_HEADER->Reserved = tvb_get_ntohs(tvb, local_offset);\r\nproto_tree_add_item(SA_HEADER_header_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nSA_HEADER->ComponentMask = tvb_get_ntoh64(tvb, local_offset);\r\nproto_tree_add_item(SA_HEADER_header_tree, hf_opa_sa_component_mask, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nlabel_SUBA_Method(SA_HEADER_header_item, MAD, pinfo);\r\nlabel_SUBA_Attribute(SA_HEADER_header_item, MAD, pinfo);\r\n*offset = local_offset;\r\nreturn TRUE;\r\n}\r\nstatic void parse_SUBNADMN(proto_tree *parentTree, packet_info *pinfo, tvbuff_t *tvb, gint *offset)\r\n{\r\nMAD_t MAD;\r\nRMPP_t RMPP;\r\nSA_HEADER_t SA_HEADER;\r\nif (!parse_MAD_Common(parentTree, pinfo, tvb, offset, &MAD)) {\r\nreturn;\r\n}\r\nif (!parse_RMPP(parentTree, pinfo, tvb, offset, &RMPP)) {\r\nreturn;\r\n}\r\nif (!parse_SA_HEADER(parentTree, pinfo, tvb, offset, &MAD, &SA_HEADER)) {\r\nreturn;\r\n}\r\nif ((!pref_parse_on_mad_status_error && MAD.Status) ||\r\nRMPP.Type == RMPP_ACK || SA_HEADER.AttributeOffset == 0 ||\r\n(RMPP.Type == RMPP_DATA && RMPP.SegmentNumber != 1)) {\r\n*offset += tvb_captured_length_remaining(tvb, *offset);\r\nreturn;\r\n}\r\nif (!parse_SUBA_Attribute(parentTree, tvb, offset, &MAD, &RMPP, &SA_HEADER)) {\r\nexpert_add_info_format(pinfo, NULL, &ei_opa_mad_no_attribute_dissector,\r\n"Attribute Dissector Not Implemented (0x%x)", MAD.AttributeID);\r\n*offset += tvb_captured_length_remaining(tvb, *offset);\r\nreturn;\r\n}\r\n}\r\nstatic gint parse_PortStatus(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\nproto_item *PortStatus_header_item;\r\nproto_tree *PortStatus_header_tree;\r\nproto_tree *PortStatus_VL_tree;\r\ngint local_offset = *offset;\r\nguint32 VLSelectMask;\r\nguint i, VLs;\r\nguint32 vlSelMskTmp;\r\nif (!parentTree)\r\nreturn *offset;\r\nVLSelectMask = tvb_get_ntohl(tvb, local_offset + 4);\r\nfor (i = 0, VLs = 0, vlSelMskTmp = VLSelectMask; vlSelMskTmp && i < 32 && vlSelMskTmp; i++, vlSelMskTmp >>= 1) {\r\nVLs = VLs + (vlSelMskTmp & 0x1);\r\n}\r\nif (MAD->Method == METHOD_GET) {\r\nPortStatus_header_item = proto_tree_add_item(parentTree, hf_opa_PortStatus, tvb, local_offset, 8, ENC_NA);\r\n} else if (MAD->Method == METHOD_GET_RESP) {\r\nPortStatus_header_item = proto_tree_add_item(parentTree, hf_opa_PortStatus, tvb, local_offset, 208 + VLs * 112, ENC_NA);\r\n} else {\r\nreturn *offset;\r\n}\r\nPortStatus_header_tree = proto_item_add_subtree(PortStatus_header_item, ett_portstatus);\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_PortNumber, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_reserved24, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_VLSelectMask, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nif (MAD->Method == METHOD_GET)\r\nreturn local_offset;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_PortXmitData, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_PortRcvData, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_PortXmitPkts, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_PortRcvPkts, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_PortMulticastXmitPkts, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_PortMulticastRcvPkts, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_PortXmitWait, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_SwPortCongestion, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_PortRcvFECN, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_PortRcvBECN, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_PortXmitTimeCong, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_PortXmitWastedBW, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_PortXmitWaitData, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_PortRcvBubble, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_PortMarkFECN, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_PortRcvConstraintErrors, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_PortRcvSwitchRelayErrors, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_PortXmitDiscards, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_PortXmitConstraintErrors, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_PortRcvRemotePhysicalErrors, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_LocalLinkIntegrityErrors, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_PortRcvErrors, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_ExcessiveBufferOverruns, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_FMConfigErrors, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_LinkErrorRecovery, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_LinkDowned, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_UncorrectableErrors, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_PortStatus_LinkQualityIndicator, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PortStatus_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nfor (i = 0, vlSelMskTmp = VLSelectMask; vlSelMskTmp && i < 32; i++, vlSelMskTmp >>= 1) {\r\nif (vlSelMskTmp & 0x1) {\r\nPortStatus_VL_tree = proto_tree_add_subtree_format(PortStatus_header_tree, tvb, local_offset, 112,\r\nett_portstatus_vl, NULL, "VL %u", i);\r\nproto_tree_add_item(PortStatus_VL_tree, hf_opa_PortStatus_PortVLXmitData, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_VL_tree, hf_opa_PortStatus_PortVLRcvData, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_VL_tree, hf_opa_PortStatus_PortVLXmitPkts, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_VL_tree, hf_opa_PortStatus_PortVLRcvPkts, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_VL_tree, hf_opa_PortStatus_PortVLXmitWait, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_VL_tree, hf_opa_PortStatus_SwPortVLCongestion, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_VL_tree, hf_opa_PortStatus_PortVLRcvFECN, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_VL_tree, hf_opa_PortStatus_PortVLRcvBECN, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_VL_tree, hf_opa_PortStatus_PortVLXmitTimeCong, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_VL_tree, hf_opa_PortStatus_PortVLXmitWastedBW, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_VL_tree, hf_opa_PortStatus_PortVLXmitWaitData, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_VL_tree, hf_opa_PortStatus_PortVLRcvBubble, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_VL_tree, hf_opa_PortStatus_PortVLMarkFECN, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortStatus_VL_tree, hf_opa_PortStatus_PortVLXmitDiscards, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\n}\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_ClearPortStatus(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\nproto_item *ClearPortStatus_header_item;\r\nproto_tree *ClearPortStatus_header_tree;\r\nproto_item *ClearPortStatus_PortSelectMask_item;\r\ngint local_offset = *offset;\r\nguint64 PortSelectMask[4];\r\nguint64 PortSelectMaskTemp;\r\nguint i, j;\r\nguint PortsOffset = 0;\r\nif (!parentTree)\r\nreturn *offset;\r\nif (MAD->Method == METHOD_SET || MAD->Method == METHOD_GET_RESP) {\r\nClearPortStatus_header_item = proto_tree_add_item(parentTree, hf_opa_ClearPortStatus, tvb, local_offset, 36, ENC_NA);\r\n} else\r\nreturn *offset;\r\nClearPortStatus_header_tree = proto_item_add_subtree(ClearPortStatus_header_item, ett_clearportstatus);\r\nPortSelectMask[0] = tvb_get_ntoh64(tvb, local_offset);\r\nPortSelectMask[1] = tvb_get_ntoh64(tvb, local_offset + 8);\r\nPortSelectMask[2] = tvb_get_ntoh64(tvb, local_offset + 16);\r\nPortSelectMask[3] = tvb_get_ntoh64(tvb, local_offset + 24);\r\nClearPortStatus_PortSelectMask_item = proto_tree_add_item(ClearPortStatus_header_tree, hf_opa_ClearPortStatus_PortSelectMask, tvb, local_offset, 32, ENC_NA);\r\nfor (j = 0; j < 4; j++) {\r\nfor (i = 0, PortSelectMaskTemp = PortSelectMask[3 - j]; i < 64 && (PortSelectMaskTemp); i++, PortSelectMaskTemp >>= (guint64)1) {\r\nif (PortSelectMaskTemp & (guint64)0x1) {\r\nproto_item_append_text(ClearPortStatus_PortSelectMask_item, "%s%u", (PortsOffset ? ", " : " "), (i)+(j * 64));\r\nPortsOffset++;\r\n}\r\n}\r\n}\r\nlocal_offset += 32;\r\nproto_tree_add_bitmask(ClearPortStatus_header_tree, tvb, local_offset,\r\nhf_opa_ClearPortStatus_CounterSelectMask, ett_clearportstatus_counterselectmask,\r\n_ClearPortStatus_CounterSelectMask, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nreturn local_offset;\r\n}\r\nstatic gint parse_DataPortCounters(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\nproto_item *DataPortCounters_header_item;\r\nproto_item *DataPortCounters_PortSelectMask_item;\r\nproto_tree *DataPortCounters_header_tree;\r\nproto_tree *DataPortCounters_Port_tree;\r\nproto_tree *DataPortCounters_VL_tree;\r\ngint local_offset = *offset;\r\nguint32 VLSelectMask, vlSelMskTmp;\r\nguint64 PortSelectMask[4];\r\nguint64 PortSelectMaskTemp;\r\nguint VLs, i, j, p;\r\nguint PortsOffset = 0;\r\nguint Num_Ports = (MAD->AttributeModifier >> 24) & 0xFF;\r\nif (!parentTree)\r\nreturn *offset;\r\nVLSelectMask = tvb_get_ntohl(tvb, local_offset + 32);\r\nfor (i = 0, VLs = 0, vlSelMskTmp = VLSelectMask; vlSelMskTmp && i < 32 && vlSelMskTmp; i++, vlSelMskTmp >>= 1) {\r\nVLs += (vlSelMskTmp & 0x1);\r\n}\r\nif (MAD->Method == METHOD_GET) {\r\nDataPortCounters_header_item = proto_tree_add_item(parentTree, hf_opa_DataPortCounters, tvb, local_offset, 40, ENC_NA);\r\n} else if (MAD->Method == METHOD_GET_RESP) {\r\nDataPortCounters_header_item = proto_tree_add_item(parentTree, hf_opa_DataPortCounters, tvb, local_offset, 40 + Num_Ports * (136 + VLs * 104), ENC_NA);\r\n} else {\r\nreturn *offset;\r\n}\r\nDataPortCounters_header_tree = proto_item_add_subtree(DataPortCounters_header_item, ett_dataportcounters);\r\nPortSelectMask[0] = tvb_get_ntoh64(tvb, local_offset);\r\nPortSelectMask[1] = tvb_get_ntoh64(tvb, local_offset + 8);\r\nPortSelectMask[2] = tvb_get_ntoh64(tvb, local_offset + 16);\r\nPortSelectMask[3] = tvb_get_ntoh64(tvb, local_offset + 24);\r\nDataPortCounters_PortSelectMask_item = proto_tree_add_item(DataPortCounters_header_tree, hf_opa_DataPortCounters_PortSelectMask, tvb, local_offset, 32, ENC_NA);\r\nfor (j = 0; j < 4; j++) {\r\nfor (i = 0, PortSelectMaskTemp = PortSelectMask[3 - j]; i < 64 && (PortSelectMaskTemp); i++, PortSelectMaskTemp >>= (guint64)1) {\r\nif (PortSelectMaskTemp & (guint64)0x1) {\r\nproto_item_append_text(DataPortCounters_PortSelectMask_item, "%s%u", (PortsOffset ? ", " : " "), (i)+(j * 64));\r\nPortsOffset++;\r\n}\r\n}\r\n}\r\nlocal_offset += 32;\r\nproto_tree_add_item(DataPortCounters_header_tree, hf_opa_DataPortCounters_VLSelectMask, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(DataPortCounters_header_tree, hf_opa_DataPortCounters_resolution_reserved, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(DataPortCounters_header_tree, hf_opa_DataPortCounters_LocalLinkIntegrityResolution, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(DataPortCounters_header_tree, hf_opa_DataPortCounters_LinkErrorRecoveryResolution, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nif (MAD->Method == METHOD_GET)\r\nreturn local_offset;\r\nfor (p = 0; p < Num_Ports; p++) {\r\nDataPortCounters_Port_tree = proto_tree_add_subtree_format(DataPortCounters_header_tree, tvb, local_offset, (1 + 3 + 4 + (8 * 16) + VLs * (8 * 13)),\r\nett_dataportcounters_port, NULL, "Port %u", tvb_get_guint8(tvb, local_offset));\r\nproto_tree_add_item(DataPortCounters_Port_tree, hf_opa_DataPortCounters_PortNumber, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(DataPortCounters_Port_tree, hf_opa_reserved24, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(DataPortCounters_Port_tree, hf_opa_DataPortCounters_lqi_reserved, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(DataPortCounters_Port_tree, hf_opa_DataPortCounters_LinkQualityIndicator, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(DataPortCounters_Port_tree, hf_opa_DataPortCounters_PortXmitData, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataPortCounters_Port_tree, hf_opa_DataPortCounters_PortRcvData, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataPortCounters_Port_tree, hf_opa_DataPortCounters_PortXmitPkts, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataPortCounters_Port_tree, hf_opa_DataPortCounters_PortRcvPkts, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataPortCounters_Port_tree, hf_opa_DataPortCounters_PortMulticastXmitPkts, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataPortCounters_Port_tree, hf_opa_DataPortCounters_PortMulticastRcvPkts, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataPortCounters_Port_tree, hf_opa_DataPortCounters_PortXmitWait, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataPortCounters_Port_tree, hf_opa_DataPortCounters_SwPortCongestion, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataPortCounters_Port_tree, hf_opa_DataPortCounters_PortRcvFECN, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataPortCounters_Port_tree, hf_opa_DataPortCounters_PortRcvBECN, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataPortCounters_Port_tree, hf_opa_DataPortCounters_PortXmitTimeCong, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataPortCounters_Port_tree, hf_opa_DataPortCounters_PortXmitWastedBW, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataPortCounters_Port_tree, hf_opa_DataPortCounters_PortXmitWaitData, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataPortCounters_Port_tree, hf_opa_DataPortCounters_PortRcvBubble, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataPortCounters_Port_tree, hf_opa_DataPortCounters_PortMarkFECN, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataPortCounters_Port_tree, hf_opa_DataPortCounters_PortErrorCounterSummary, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nfor (i = 0, vlSelMskTmp = VLSelectMask; vlSelMskTmp && i < 32; i++, vlSelMskTmp >>= 1) {\r\nif (vlSelMskTmp & 0x1) {\r\nDataPortCounters_VL_tree = proto_tree_add_subtree_format(DataPortCounters_Port_tree, tvb, local_offset, 8 * 13,\r\nett_dataportcounters_vl, NULL, "VL %u", i);\r\nproto_tree_add_item(DataPortCounters_VL_tree, hf_opa_DataPortCounters_PortVLXmitData, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataPortCounters_VL_tree, hf_opa_DataPortCounters_PortVLRcvData, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataPortCounters_VL_tree, hf_opa_DataPortCounters_PortVLXmitPkts, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataPortCounters_VL_tree, hf_opa_DataPortCounters_PortVLRcvPkts, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataPortCounters_VL_tree, hf_opa_DataPortCounters_PortVLXmitWait, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataPortCounters_VL_tree, hf_opa_DataPortCounters_SwPortVLCongestion, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataPortCounters_VL_tree, hf_opa_DataPortCounters_PortVLRcvFECN, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataPortCounters_VL_tree, hf_opa_DataPortCounters_PortVLRcvBECN, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataPortCounters_VL_tree, hf_opa_DataPortCounters_PortVLXmitTimeCong, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataPortCounters_VL_tree, hf_opa_DataPortCounters_PortVLXmitWastedBW, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataPortCounters_VL_tree, hf_opa_DataPortCounters_PortVLXmitWaitData, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataPortCounters_VL_tree, hf_opa_DataPortCounters_PortVLRcvBubble, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(DataPortCounters_VL_tree, hf_opa_DataPortCounters_PortVLMarkFECN, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\n}\r\n}\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_ErrorPortCounters(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\nproto_item *ErrorPortCounters_header_item;\r\nproto_item *ErrorPortCounters_PortSelectMask_item;\r\nproto_item *ErrorPortCounters_VL_item;\r\nproto_tree *ErrorPortCounters_header_tree;\r\nproto_tree *ErrorPortCounters_Port_tree;\r\ngint local_offset = *offset;\r\nguint32 VLSelectMask, vlSelMskTmp;\r\nguint64 PortSelectMask[4];\r\nguint64 PortSelectMaskTemp;\r\nguint VLs, i, j, p;\r\nguint PortsOffset = 0;\r\nguint Num_Ports = (MAD->AttributeModifier & 0xFF000000) >> 24;\r\nif (!parentTree)\r\nreturn *offset;\r\nVLSelectMask = tvb_get_ntohl(tvb, local_offset + 32);\r\nfor (i = 0, VLs = 0, vlSelMskTmp = VLSelectMask; vlSelMskTmp && i < 32; i++, vlSelMskTmp >>= 1) {\r\nVLs += (vlSelMskTmp & 0x1);\r\n}\r\nif (MAD->Method == METHOD_GET) {\r\nErrorPortCounters_header_item = proto_tree_add_item(parentTree, hf_opa_ErrorPortCounters, tvb, local_offset, 40, ENC_NA);\r\n} else if (MAD->Method == METHOD_GET_RESP) {\r\nErrorPortCounters_header_item = proto_tree_add_item(parentTree, hf_opa_ErrorPortCounters, tvb, local_offset, 40 + Num_Ports * (96 + VLs * 8), ENC_NA);\r\n} else {\r\nreturn *offset;\r\n}\r\nErrorPortCounters_header_tree = proto_item_add_subtree(ErrorPortCounters_header_item, ett_errorportcounters);\r\nPortSelectMask[0] = tvb_get_ntoh64(tvb, local_offset);\r\nPortSelectMask[1] = tvb_get_ntoh64(tvb, local_offset + 8);\r\nPortSelectMask[2] = tvb_get_ntoh64(tvb, local_offset + 16);\r\nPortSelectMask[3] = tvb_get_ntoh64(tvb, local_offset + 24);\r\nErrorPortCounters_PortSelectMask_item = proto_tree_add_item(ErrorPortCounters_header_tree, hf_opa_ErrorPortCounters_PortSelectMask, tvb, local_offset, 32, ENC_NA);\r\nfor (j = 0; j < 4; j++) {\r\nfor (i = 0, PortSelectMaskTemp = PortSelectMask[3 - j]; i < 64 && (PortSelectMaskTemp); i++, PortSelectMaskTemp >>= (guint64)1) {\r\nif (PortSelectMaskTemp & (guint64)0x1) {\r\nproto_item_append_text(ErrorPortCounters_PortSelectMask_item, "%s%u", (PortsOffset ? ", " : " "), (i)+(j * 64));\r\nPortsOffset++;\r\n}\r\n}\r\n}\r\nlocal_offset += 32;\r\nproto_tree_add_item(ErrorPortCounters_header_tree, hf_opa_ErrorPortCounters_VLSelectMask, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(ErrorPortCounters_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nif (MAD->Method == METHOD_GET)\r\nreturn local_offset;\r\nfor (p = 0; p < Num_Ports; p++) {\r\nErrorPortCounters_Port_tree = proto_tree_add_subtree_format(ErrorPortCounters_header_tree, tvb, local_offset, (96 + VLs * 8),\r\nett_errorportcounters_port, NULL, "Port %u", tvb_get_guint8(tvb, local_offset));\r\nproto_tree_add_item(ErrorPortCounters_Port_tree, hf_opa_ErrorPortCounters_PortNumber, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(ErrorPortCounters_Port_tree, hf_opa_reserved24, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(ErrorPortCounters_Port_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(ErrorPortCounters_Port_tree, hf_opa_ErrorPortCounters_PortRcvConstraintErrors, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(ErrorPortCounters_Port_tree, hf_opa_ErrorPortCounters_PortRcvSwitchRelayErrors, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(ErrorPortCounters_Port_tree, hf_opa_ErrorPortCounters_PortXmitDiscards, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(ErrorPortCounters_Port_tree, hf_opa_ErrorPortCounters_PortXmitConstraintErrors, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(ErrorPortCounters_Port_tree, hf_opa_ErrorPortCounters_PortRcvRemotePhysicalErrors, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(ErrorPortCounters_Port_tree, hf_opa_ErrorPortCounters_LocalLinkIntegrityErrors, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(ErrorPortCounters_Port_tree, hf_opa_ErrorPortCounters_PortRcvErrors, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(ErrorPortCounters_Port_tree, hf_opa_ErrorPortCounters_ExcessiveBufferOverruns, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(ErrorPortCounters_Port_tree, hf_opa_ErrorPortCounters_FMConfigErrors, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(ErrorPortCounters_Port_tree, hf_opa_ErrorPortCounters_LinkErrorRecovery, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(ErrorPortCounters_Port_tree, hf_opa_ErrorPortCounters_LinkDowned, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(ErrorPortCounters_Port_tree, hf_opa_ErrorPortCounters_UncorrectableErrors, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(ErrorPortCounters_Port_tree, hf_opa_reserved24, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(ErrorPortCounters_Port_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nfor (i = 0, vlSelMskTmp = VLSelectMask; vlSelMskTmp && i < 32; i++, vlSelMskTmp >>= 1) {\r\nif (vlSelMskTmp & 0x1) {\r\nErrorPortCounters_VL_item = proto_tree_add_item(ErrorPortCounters_Port_tree, hf_opa_ErrorPortCounters_PortVLXmitDiscards, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_item_prepend_text(ErrorPortCounters_VL_item, "%3u: ", i);\r\n}\r\n}\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_ErrorPortInfo(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\nproto_item *ErrorPortInfo_header_item;\r\nproto_item *ErrorPortInfo_PortSelectMask_item;\r\nproto_tree *ErrorPortInfo_header_tree;\r\nproto_tree *ErrorPortInfo_Port_tree;\r\nproto_tree * PortRcvErrorInfo_tree,\r\n*ExcessiveBufferOverrunInfo_tree,\r\n*PortXmitConstraintErrorInfo_tree,\r\n*PortRcvConstraintErrorInfo_tree,\r\n*PortRcvSwitchRelayErrorInfo_tree,\r\n*UncorrectableErrorInfo_tree,\r\n*FMConfigErrorInfo_tree;\r\ngint local_offset = *offset;\r\nguint64 PortSelectMask[4];\r\nguint64 PortSelectMaskTemp;\r\nguint i, j, p, ErrorCode;\r\nguint PortsOffset = 0;\r\nguint Num_Ports = (MAD->AttributeModifier & 0xFF000000) >> 24;\r\nif (!parentTree)\r\nreturn *offset;\r\nif (MAD->Method == METHOD_GET_RESP) {\r\nErrorPortInfo_header_item = proto_tree_add_item(parentTree, hf_opa_ErrorPortInfo, tvb, local_offset, -1, ENC_NA);\r\n} else if (MAD->Method == METHOD_SET) {\r\nErrorPortInfo_header_item = proto_tree_add_item(parentTree, hf_opa_ErrorPortInfo, tvb, local_offset, 40, ENC_NA);\r\n} else {\r\nErrorPortInfo_header_item = proto_tree_add_item(parentTree, hf_opa_ErrorPortInfo, tvb, local_offset, 32, ENC_NA);\r\n}\r\nErrorPortInfo_header_tree = proto_item_add_subtree(ErrorPortInfo_header_item, ett_errorportinfo);\r\nPortSelectMask[0] = tvb_get_ntoh64(tvb, local_offset);\r\nPortSelectMask[1] = tvb_get_ntoh64(tvb, local_offset + 8);\r\nPortSelectMask[2] = tvb_get_ntoh64(tvb, local_offset + 16);\r\nPortSelectMask[3] = tvb_get_ntoh64(tvb, local_offset + 24);\r\nErrorPortInfo_PortSelectMask_item = proto_tree_add_item(ErrorPortInfo_header_tree, hf_opa_ErrorPortInfo_PortSelectMask, tvb, local_offset, 32, ENC_NA);\r\nfor (j = 0; j < 4; j++) {\r\nfor (i = 0, PortSelectMaskTemp = PortSelectMask[3 - j]; i < 64 && (PortSelectMaskTemp); i++, PortSelectMaskTemp >>= (guint64)1) {\r\nif (PortSelectMaskTemp & (guint64)0x1) {\r\nproto_item_append_text(ErrorPortInfo_PortSelectMask_item, "%s%u", (PortsOffset ? ", " : " "), (i)+(j * 64));\r\nPortsOffset++;\r\n}\r\n}\r\n}\r\nlocal_offset += 32;\r\nif (MAD->Method == METHOD_GET)\r\nreturn local_offset;\r\nproto_tree_add_bitmask_list(ErrorPortInfo_header_tree, tvb, local_offset, 4, _ErrorPortInfo_ErrorInfoSelectMask, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nif (MAD->Method == METHOD_SET\r\n|| (MAD->Method == METHOD_GET_RESP && Num_Ports > 1\r\n&& tvb_reported_length_remaining(tvb, local_offset) < (72 * 2)))\r\nreturn local_offset;\r\nproto_tree_add_item(ErrorPortInfo_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nfor (p = 0; p < Num_Ports; p++) {\r\nErrorPortInfo_Port_tree = proto_tree_add_subtree_format(ErrorPortInfo_header_tree, tvb, local_offset, 72,\r\nett_errorportinfoport, NULL, "Port %u", tvb_get_guint8(tvb, local_offset));\r\nproto_tree_add_item(ErrorPortInfo_Port_tree, hf_opa_ErrorPortInfo_PortNumber, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(ErrorPortInfo_Port_tree, hf_opa_reserved24, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(ErrorPortInfo_Port_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nPortRcvErrorInfo_tree = proto_tree_add_subtree(ErrorPortInfo_Port_tree, tvb, local_offset, 24,\r\nett_errorportinfo_portrcverrorinfo, NULL, "PortRcv Error Info");\r\nproto_tree_add_item(PortRcvErrorInfo_tree, hf_opa_ErrorPortInfo_PortRcvErrorInfo_Status, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortRcvErrorInfo_tree, hf_opa_ErrorPortInfo_PortRcvErrorInfo_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortRcvErrorInfo_tree, hf_opa_ErrorPortInfo_PortRcvErrorInfo_ErrorCode, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nErrorCode = tvb_get_guint8(tvb, local_offset) & 0x0F;\r\nlocal_offset += 1;\r\nif (ErrorCode >= 1 && ErrorCode <= 12) {\r\nproto_tree_add_item(PortRcvErrorInfo_tree, hf_opa_ErrorPortInfo_PortRcvErrorInfo_PacketFlit1, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortRcvErrorInfo_tree, hf_opa_ErrorPortInfo_PortRcvErrorInfo_PacketFlit2, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortRcvErrorInfo_tree, hf_opa_ErrorPortInfo_PortRcvErrorInfo_Flit1Bits, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortRcvErrorInfo_tree, hf_opa_ErrorPortInfo_PortRcvErrorInfo_Flit2Bits, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortRcvErrorInfo_tree, hf_opa_ErrorPortInfo_PortRcvErrorInfo_reserved2, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\n} else if (ErrorCode == 13) {\r\nproto_tree_add_item(PortRcvErrorInfo_tree, hf_opa_ErrorPortInfo_PortRcvErrorInfo_PacketBytes, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PortRcvErrorInfo_tree, hf_opa_ErrorPortInfo_PortRcvErrorInfo_FlitBits, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortRcvErrorInfo_tree, hf_opa_ErrorPortInfo_PortRcvErrorInfo_reserved3, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortRcvErrorInfo_tree, hf_opa_reserved64, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\n} else {\r\nproto_tree_add_item(PortRcvErrorInfo_tree, hf_opa_ErrorPortInfo_PortRcvErrorInfo_reserved4, tvb, local_offset, 17, ENC_NA);\r\nlocal_offset += 17;\r\n}\r\nproto_tree_add_item(PortRcvErrorInfo_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PortRcvErrorInfo_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nExcessiveBufferOverrunInfo_tree = proto_tree_add_subtree(ErrorPortInfo_Port_tree, tvb, local_offset, 8,\r\nett_errorportinfo_excessivebufferoverruninfo, NULL, "ExcessiveBufferOverrun Error Info");\r\nproto_tree_add_item(ExcessiveBufferOverrunInfo_tree, hf_opa_ErrorPortInfo_ExcessiveBufferOverrunErrorInfo_Status, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ExcessiveBufferOverrunInfo_tree, hf_opa_ErrorPortInfo_ExcessiveBufferOverrunErrorInfo_SC, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ExcessiveBufferOverrunInfo_tree, hf_opa_ErrorPortInfo_ExcessiveBufferOverrunErrorInfo_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(ExcessiveBufferOverrunInfo_tree, hf_opa_reserved24, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(ExcessiveBufferOverrunInfo_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nPortXmitConstraintErrorInfo_tree = proto_tree_add_subtree(ErrorPortInfo_Port_tree, tvb, local_offset, 8,\r\nett_errorportinfo_portxmitconstrainterrorinfo, NULL, "PortXmitConstraint Error Info");\r\nproto_tree_add_item(PortXmitConstraintErrorInfo_tree, hf_opa_ErrorPortInfo_PortXmitConstraintErrorInfo_Status, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortXmitConstraintErrorInfo_tree, hf_opa_ErrorPortInfo_PortXmitConstraintErrorInfo_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortXmitConstraintErrorInfo_tree, hf_opa_reserved8, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortXmitConstraintErrorInfo_tree, hf_opa_ErrorPortInfo_PortXmitConstraintErrorInfo_P_Key, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PortXmitConstraintErrorInfo_tree, hf_opa_ErrorPortInfo_PortXmitConstraintErrorInfo_SLID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nPortRcvConstraintErrorInfo_tree = proto_tree_add_subtree(ErrorPortInfo_Port_tree, tvb, local_offset, 8,\r\nett_errorportinfo_portrcvconstrainterrorinfo, NULL, "PortRcvConstraint Error Info");\r\nproto_tree_add_item(PortRcvConstraintErrorInfo_tree, hf_opa_ErrorPortInfo_PortRcvConstraintErrorInfo_Status, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortRcvConstraintErrorInfo_tree, hf_opa_ErrorPortInfo_PortRcvConstraintErrorInfo_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortRcvConstraintErrorInfo_tree, hf_opa_reserved8, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortRcvConstraintErrorInfo_tree, hf_opa_ErrorPortInfo_PortRcvConstraintErrorInfo_P_Key, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PortRcvConstraintErrorInfo_tree, hf_opa_ErrorPortInfo_PortRcvConstraintErrorInfo_SLID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nPortRcvSwitchRelayErrorInfo_tree = proto_tree_add_subtree(ErrorPortInfo_Port_tree, tvb, local_offset, 8,\r\nett_errorportinfo_portrcvswitchrelayerrorinfo, NULL, "PortRcvSwitchRelay Error Info");\r\nproto_tree_add_item(PortRcvSwitchRelayErrorInfo_tree, hf_opa_ErrorPortInfo_PortRcvSwitchRelayErrorInfo_Status, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortRcvSwitchRelayErrorInfo_tree, hf_opa_ErrorPortInfo_PortRcvSwitchRelayErrorInfo_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortRcvSwitchRelayErrorInfo_tree, hf_opa_ErrorPortInfo_PortRcvSwitchRelayErrorInfo_ErrorCode, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nErrorCode = tvb_get_guint8(tvb, local_offset) & 0x0F;\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortRcvSwitchRelayErrorInfo_tree, hf_opa_reserved24, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nswitch (ErrorCode) {\r\ncase 0:\r\nproto_tree_add_item(PortRcvSwitchRelayErrorInfo_tree, hf_opa_ErrorPortInfo_PortRcvSwitchRelayErrorInfo_DLID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nbreak;\r\ncase 2:\r\nproto_tree_add_item(PortRcvSwitchRelayErrorInfo_tree, hf_opa_ErrorPortInfo_PortRcvSwitchRelayErrorInfo_EgressPortNum, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortRcvSwitchRelayErrorInfo_tree, hf_opa_reserved24, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nbreak;\r\ncase 3:\r\nproto_tree_add_item(PortRcvSwitchRelayErrorInfo_tree, hf_opa_ErrorPortInfo_PortRcvSwitchRelayErrorInfo_EgressPortNum, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortRcvSwitchRelayErrorInfo_tree, hf_opa_ErrorPortInfo_PortRcvSwitchRelayErrorInfo_SC, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortRcvSwitchRelayErrorInfo_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(PortRcvSwitchRelayErrorInfo_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nbreak;\r\n}\r\nUncorrectableErrorInfo_tree = proto_tree_add_subtree(ErrorPortInfo_Port_tree, tvb, local_offset, 2,\r\nett_errorportinfo_uncorrectableerrorinfo, NULL, "Uncorrectable Error Info");\r\nproto_tree_add_item(UncorrectableErrorInfo_tree, hf_opa_ErrorPortInfo_UncorrectableErrorInfo_Status, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(UncorrectableErrorInfo_tree, hf_opa_ErrorPortInfo_UncorrectableErrorInfo_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(UncorrectableErrorInfo_tree, hf_opa_ErrorPortInfo_UncorrectableErrorInfo_ErrorCode, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(UncorrectableErrorInfo_tree, hf_opa_reserved8, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nFMConfigErrorInfo_tree = proto_tree_add_subtree(ErrorPortInfo_Port_tree, tvb, local_offset, 6,\r\nett_errorportinfo_fmconfigerrorinfo, NULL, "FMConfig Error Info");\r\nproto_tree_add_item(FMConfigErrorInfo_tree, hf_opa_ErrorPortInfo_FMConfigErrorInfo_Status, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(FMConfigErrorInfo_tree, hf_opa_ErrorPortInfo_FMConfigErrorInfo_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(FMConfigErrorInfo_tree, hf_opa_ErrorPortInfo_FMConfigErrorInfo_ErrorCode, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nErrorCode = tvb_get_guint8(tvb, local_offset) & 0x0F;\r\nlocal_offset += 1;\r\nswitch (ErrorCode) {\r\ncase 0:\r\ncase 1:\r\ncase 2:\r\nproto_tree_add_item(FMConfigErrorInfo_tree, hf_opa_ErrorPortInfo_FMConfigErrorInfo_Distance, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nbreak;\r\ncase 3:\r\ncase 4:\r\ncase 5:\r\nproto_tree_add_item(FMConfigErrorInfo_tree, hf_opa_ErrorPortInfo_FMConfigErrorInfo_VL, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nbreak;\r\ncase 6:\r\nproto_tree_add_item(FMConfigErrorInfo_tree, hf_opa_ErrorPortInfo_FMConfigErrorInfo_BadFlitBits, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nbreak;\r\ncase 7:\r\nproto_tree_add_item(FMConfigErrorInfo_tree, hf_opa_ErrorPortInfo_FMConfigErrorInfo_SC, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(FMConfigErrorInfo_tree, hf_opa_reserved8, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nbreak;\r\n}\r\nproto_tree_add_item(FMConfigErrorInfo_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gboolean parse_PM_Attribute(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\ngint local_offset = *offset;\r\nswitch (MAD->AttributeID) {\r\ncase PA_ATTR_ID_CLASS_PORTINFO:\r\nlocal_offset = parse_ClassPortInfo(parentTree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase PM_ATTR_ID_PORT_STATUS:\r\nlocal_offset = parse_PortStatus(parentTree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase PM_ATTR_ID_CLEAR_PORT_STATUS:\r\nlocal_offset = parse_ClearPortStatus(parentTree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase PM_ATTR_ID_DATA_PORT_COUNTERS:\r\nlocal_offset = parse_DataPortCounters(parentTree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase PM_ATTR_ID_ERROR_PORT_COUNTERS:\r\nlocal_offset = parse_ErrorPortCounters(parentTree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase PM_ATTR_ID_ERROR_INFO:\r\nlocal_offset = parse_ErrorPortInfo(parentTree, tvb, &local_offset, MAD);\r\nbreak;\r\ndefault:\r\nreturn FALSE;\r\n}\r\n*offset = local_offset;\r\nreturn TRUE;\r\n}\r\nstatic void label_PM_Method(proto_item *PMItem, MAD_t *MAD, packet_info *pinfo)\r\n{\r\nconst guchar *label = val_to_str_const(MAD->Method, PM_Methods, "(Unknown Perf Method!)");\r\nproto_item_append_text(PMItem, " %s", label);\r\ncol_append_str(pinfo->cinfo, COL_INFO, label);\r\n}\r\nstatic void label_PM_Attribute(proto_item *PMItem, MAD_t *MAD, packet_info *pinfo)\r\n{\r\nconst guchar *label = val_to_str_const(MAD->AttributeID, PM_Attributes, "Attribute (Unknown Perf Attribute!)");\r\nproto_item_append_text(PMItem, "%s", &label[11]);\r\ncol_append_str(pinfo->cinfo, COL_INFO, &label[11]);\r\n}\r\nstatic void parse_PERF(proto_tree *parentTree, packet_info *pinfo, tvbuff_t *tvb, gint *offset)\r\n{\r\nMAD_t MAD;\r\nproto_item *PM_header_item;\r\nproto_tree *PM_header_tree;\r\nif (!parse_MAD_Common(parentTree, pinfo, tvb, offset, &MAD)) {\r\nreturn;\r\n}\r\nPM_header_item = proto_tree_add_item(parentTree, hf_opa_pm, tvb, *offset, -1, ENC_NA);\r\nPM_header_tree = proto_item_add_subtree(PM_header_item, ett_pm);\r\nlabel_PM_Method(PM_header_item, &MAD, pinfo);\r\nlabel_PM_Attribute(PM_header_item, &MAD, pinfo);\r\nif (!pref_parse_on_mad_status_error && MAD.Status) {\r\n*offset += tvb_captured_length_remaining(tvb, *offset);\r\nreturn;\r\n}\r\nif (!parse_PM_Attribute(PM_header_tree, tvb, offset, &MAD)) {\r\nexpert_add_info_format(pinfo, NULL, &ei_opa_mad_no_attribute_dissector,\r\n"Attribute Dissector Not Implemented (0x%x)", MAD.AttributeID);\r\n*offset += tvb_captured_length_remaining(tvb, *offset);\r\nreturn;\r\n}\r\n}\r\nstatic gint parse_Image(proto_tree *parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\nproto_tree *Image_header_tree = parentTree;\r\ngint local_offset = *offset;\r\nif (!parentTree)\r\nreturn *offset;\r\nproto_tree_add_item(Image_header_tree, hf_opa_ImageID_imageNumber, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(Image_header_tree, hf_opa_ImageID_imageOffset, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(Image_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nreturn local_offset;\r\n}\r\nstatic gint parse_GetGroupList(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD, RMPP_t *RMPP, PA_HEADER_t *PA_HEADER)\r\n{\r\nproto_item *GetGroupList_GroupName_item;\r\nproto_tree *GetGroupList_header_tree;\r\nproto_item *GetGroupList_header_item;\r\ngint local_offset = *offset;\r\nguint i;\r\nguint length = ((RMPP->resptime_flags & RMPP_FLAG_LAST_MASK) ? (RMPP->PayloadLength - 20) % STL_MAX_SA_PA_PAYLOAD : STL_MAX_SA_PA_PAYLOAD);\r\nguint records = (PA_HEADER->AttributeOffset ? length / (PA_HEADER->AttributeOffset * 8) : 0);\r\nif (!parentTree || RMPP->Type != RMPP_DATA ||\r\n(MAD->Method != METHOD_GET_RESP && MAD->Method != METHOD_GETTABLE_RESP)) {\r\nreturn *offset;\r\n}\r\nGetGroupList_header_item = proto_tree_add_item(parentTree, hf_opa_GetGroupList, tvb, local_offset, length, ENC_NA);\r\nGetGroupList_header_tree = proto_item_add_subtree(GetGroupList_header_item, ett_getgrouplist);\r\nproto_tree_add_none_format(GetGroupList_header_tree, hf_opa_GetGroupList, tvb, local_offset, length, "Number of Groups: %u", records);\r\nfor (i = 0; i < records; i++) {\r\nGetGroupList_GroupName_item = proto_tree_add_item(GetGroupList_header_tree, hf_opa_GetGroupList_groupName, tvb, local_offset, 64, ENC_ASCII | ENC_NA);\r\nlocal_offset += 64;\r\nproto_item_prepend_text(GetGroupList_GroupName_item, "%3u: ", i + 1);\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_GetGroupInfo(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD, RMPP_t *RMPP, PA_HEADER_t *PA_HEADER)\r\n{\r\nproto_tree *GetGroupInfo_header_tree;\r\nproto_tree *GetGroupInfo_header_item;\r\nproto_tree *GetGroupInfo_Util_Stats_tree;\r\nproto_item *GetGroupInfo_Util_Stats_Buckets_item;\r\nproto_tree *GetGroupInfo_Util_Stats_Buckets_tree;\r\nproto_item *GetGroupInfo_Util_Stats_Bucket_item;\r\nproto_tree *GetGroupInfo_Error_Summary_tree;\r\nproto_tree *GetGroupInfo_Error_Integrity_Buckets_tree;\r\nproto_tree *GetGroupInfo_Error_Congestion_Buckets_tree;\r\nproto_tree *GetGroupInfo_Error_SmaCongestion_Buckets_tree;\r\nproto_tree *GetGroupInfo_Error_Bubble_Buckets_tree;\r\nproto_tree *GetGroupInfo_Error_Security_Buckets_tree;\r\nproto_tree *GetGroupInfo_Error_Routing_Buckets_tree;\r\nproto_item *GetGroupInfo_Error_Stats_Integrity_Buckets_item;\r\nproto_item *GetGroupInfo_Error_Stats_Congestion_Buckets_item;\r\nproto_item *GetGroupInfo_Error_Stats_SmaCongestion_Buckets_item;\r\nproto_item *GetGroupInfo_Error_Stats_Bubble_Buckets_item;\r\nproto_item *GetGroupInfo_Error_Stats_Security_Buckets_item;\r\nproto_item *GetGroupInfo_Error_Stats_Routing_Buckets_item;\r\nproto_item *GetGroupInfo_Error_Stats_Bucket_item;\r\ngint local_offset = *offset;\r\nguint i, r;\r\nguint length = ((RMPP->resptime_flags & RMPP_FLAG_LAST_MASK) ? (RMPP->PayloadLength - 20) % STL_MAX_SA_PA_PAYLOAD : STL_MAX_SA_PA_PAYLOAD);\r\nguint records = (PA_HEADER->AttributeOffset ? length / (PA_HEADER->AttributeOffset * 8) : 0);\r\nguint util = 100 / PM_UTIL_BUCKETS;\r\nguint err = 100 / (PM_ERR_BUCKETS - 1);\r\nif (!parentTree)\r\nreturn *offset;\r\nif (MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE) {\r\nGetGroupInfo_header_item = proto_tree_add_item(parentTree, hf_opa_GetGroupInfo, tvb, local_offset, 64 + 16, ENC_NA);\r\nproto_item_set_text(GetGroupInfo_header_item, "GroupInfo for %s", tvb_get_string_enc(wmem_file_scope(), tvb, local_offset, 64, ENC_ASCII));\r\nGetGroupInfo_header_tree = proto_item_add_subtree(GetGroupInfo_header_item, ett_getgroupinfo);\r\nproto_tree_add_item(GetGroupInfo_header_tree, hf_opa_GetGroupInfo_groupName, tvb, local_offset, 64, ENC_ASCII | ENC_NA);\r\nlocal_offset += 64;\r\nlocal_offset = parse_Image(GetGroupInfo_header_tree, tvb, &local_offset);\r\nreturn local_offset;\r\n}\r\nfor (r = 0; r < records; r++) {\r\nGetGroupInfo_header_item = proto_tree_add_item(parentTree, hf_opa_GetGroupInfo, tvb, local_offset, 64 + 16, ENC_NA);\r\nproto_item_set_text(GetGroupInfo_header_item, "GroupInfo for %s", tvb_get_string_enc(wmem_file_scope(), tvb, local_offset, 64, ENC_ASCII));\r\nGetGroupInfo_header_tree = proto_item_add_subtree(GetGroupInfo_header_item, ett_getgroupinfo);\r\nproto_tree_add_item(GetGroupInfo_header_tree, hf_opa_GetGroupInfo_groupName, tvb, local_offset, 64, ENC_ASCII | ENC_NA);\r\nlocal_offset += 64;\r\nlocal_offset = parse_Image(GetGroupInfo_header_tree, tvb, &local_offset);\r\nproto_tree_add_item(GetGroupInfo_header_tree, hf_opa_GetGroupInfo_numInternalPorts, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetGroupInfo_header_tree, hf_opa_GetGroupInfo_numExternalPorts, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nGetGroupInfo_Util_Stats_tree = proto_tree_add_subtree(GetGroupInfo_header_tree, tvb, local_offset, 48 + PM_UTIL_BUCKETS * 4,\r\nett_getgroupinfoutilstats, NULL, "Internal Utilization Statistics");\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_totalMBps, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_totalKPps, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_avgMBps, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_minMBps, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_maxMBps, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nGetGroupInfo_Util_Stats_Buckets_item = proto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_numBWBuckets, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nGetGroupInfo_Util_Stats_Buckets_tree = proto_item_add_subtree(GetGroupInfo_Util_Stats_Buckets_item, ett_getgroupinfoutilbuckets);\r\nfor (i = 0; i < PM_UTIL_BUCKETS; i++) {\r\nGetGroupInfo_Util_Stats_Bucket_item = proto_tree_add_item(GetGroupInfo_Util_Stats_Buckets_tree, hf_opa_GetGroupInfo_BWBuckets, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_item_set_text(GetGroupInfo_Util_Stats_Bucket_item, "Bucket %u: %3u%%+: %u", i, i * util, tvb_get_ntohl(tvb, local_offset));\r\nlocal_offset += 4;\r\n}\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_avgKPps, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_minKPps, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_maxKPps, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_pmaFailedPorts, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_topoFailedPorts, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nGetGroupInfo_Util_Stats_tree = proto_tree_add_subtree(GetGroupInfo_header_tree, tvb, local_offset, 48 + PM_UTIL_BUCKETS * 4,\r\nett_getgroupinfoutilstats, NULL, "External Send Utilization Statistics");\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_totalMBps, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_totalKPps, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_avgMBps, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_minMBps, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_maxMBps, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nGetGroupInfo_Util_Stats_Buckets_item = proto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_numBWBuckets, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nGetGroupInfo_Util_Stats_Buckets_tree = proto_item_add_subtree(GetGroupInfo_Util_Stats_Buckets_item, ett_getgroupinfoutilbuckets);\r\nfor (i = 0; i < PM_UTIL_BUCKETS; i++) {\r\nGetGroupInfo_Util_Stats_Bucket_item = proto_tree_add_item(GetGroupInfo_Util_Stats_Buckets_tree, hf_opa_GetGroupInfo_BWBuckets, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_item_set_text(GetGroupInfo_Util_Stats_Bucket_item, "Bucket %u: %3u%%+: %u", i, i * util, tvb_get_ntohl(tvb, local_offset));\r\nlocal_offset += 4;\r\n}\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_avgKPps, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_minKPps, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_maxKPps, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_pmaFailedPorts, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_topoFailedPorts, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nGetGroupInfo_Util_Stats_tree = proto_tree_add_subtree(GetGroupInfo_header_tree, tvb, local_offset, 48 + PM_UTIL_BUCKETS * 4,\r\nett_getgroupinfoutilstats, NULL, "External Receive Utilization Statistics");\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_totalMBps, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_totalKPps, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_avgMBps, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_minMBps, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_maxMBps, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nGetGroupInfo_Util_Stats_Buckets_item = proto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_numBWBuckets, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nGetGroupInfo_Util_Stats_Buckets_tree = proto_item_add_subtree(GetGroupInfo_Util_Stats_Buckets_item, ett_getgroupinfoutilbuckets);\r\nfor (i = 0; i < PM_UTIL_BUCKETS; i++) {\r\nGetGroupInfo_Util_Stats_Bucket_item = proto_tree_add_item(GetGroupInfo_Util_Stats_Buckets_tree, hf_opa_GetGroupInfo_BWBuckets, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_item_set_text(GetGroupInfo_Util_Stats_Bucket_item, "Bucket %u: %3u%%+: %u", i, i * util, tvb_get_ntohl(tvb, local_offset));\r\nlocal_offset += 4;\r\n}\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_avgKPps, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_minKPps, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_maxKPps, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_pmaFailedPorts, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(GetGroupInfo_Util_Stats_tree, hf_opa_GetGroupInfo_topoFailedPorts, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nGetGroupInfo_Error_Summary_tree = proto_tree_add_subtree(GetGroupInfo_header_tree, tvb, local_offset, 40 + PM_ERR_BUCKETS * 24,\r\nett_getgroupinfoerrorsummary, NULL, "Internal Error Statistics");\r\nGetGroupInfo_Error_Stats_Integrity_Buckets_item = proto_tree_add_item(GetGroupInfo_Error_Summary_tree, hf_opa_GetGroupInfo_integrityErrors, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nGetGroupInfo_Error_Stats_Congestion_Buckets_item = proto_tree_add_item(GetGroupInfo_Error_Summary_tree, hf_opa_GetGroupInfo_congestionErrors, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nGetGroupInfo_Error_Stats_SmaCongestion_Buckets_item = proto_tree_add_item(GetGroupInfo_Error_Summary_tree, hf_opa_GetGroupInfo_smaCongestionErrors, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nGetGroupInfo_Error_Stats_Bubble_Buckets_item = proto_tree_add_item(GetGroupInfo_Error_Summary_tree, hf_opa_GetGroupInfo_bubbleErrors, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nGetGroupInfo_Error_Stats_Security_Buckets_item = proto_tree_add_item(GetGroupInfo_Error_Summary_tree, hf_opa_GetGroupInfo_securityErrors, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nGetGroupInfo_Error_Stats_Routing_Buckets_item = proto_tree_add_item(GetGroupInfo_Error_Summary_tree, hf_opa_GetGroupInfo_routingErrors, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetGroupInfo_Error_Summary_tree, hf_opa_GetGroupInfo_utlizationPct10, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(GetGroupInfo_Error_Summary_tree, hf_opa_GetGroupInfo_discardsPct10, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(GetGroupInfo_Error_Summary_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetGroupInfo_Error_Summary_tree, hf_opa_reserved64, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nGetGroupInfo_Error_Integrity_Buckets_tree = proto_item_add_subtree(GetGroupInfo_Error_Stats_Integrity_Buckets_item, ett_getgroupinfoerrintegritybucket);\r\nGetGroupInfo_Error_Congestion_Buckets_tree = proto_item_add_subtree(GetGroupInfo_Error_Stats_Congestion_Buckets_item, ett_getgroupinfoerrcongestionbucket);\r\nGetGroupInfo_Error_SmaCongestion_Buckets_tree = proto_item_add_subtree(GetGroupInfo_Error_Stats_SmaCongestion_Buckets_item, ett_getgroupinfoerrsmacongestionbucket);\r\nGetGroupInfo_Error_Bubble_Buckets_tree = proto_item_add_subtree(GetGroupInfo_Error_Stats_Bubble_Buckets_item, ett_getgroupinfoerrbubblebucket);\r\nGetGroupInfo_Error_Security_Buckets_tree = proto_item_add_subtree(GetGroupInfo_Error_Stats_Security_Buckets_item, ett_getgroupinfoerrsecuritybucket);\r\nGetGroupInfo_Error_Routing_Buckets_tree = proto_item_add_subtree(GetGroupInfo_Error_Stats_Routing_Buckets_item, ett_getgroupinfoerrroutingbucket);\r\nfor (i = 0; i < PM_ERR_BUCKETS; i++) {\r\nGetGroupInfo_Error_Stats_Bucket_item = proto_tree_add_item(GetGroupInfo_Error_Integrity_Buckets_tree, hf_opa_GetGroupInfo_BWBuckets, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_item_set_text(GetGroupInfo_Error_Stats_Bucket_item, "Bucket %u: %3u%%+: %u", i, i * err, tvb_get_ntohl(tvb, local_offset));\r\nlocal_offset += 4;\r\nGetGroupInfo_Error_Stats_Bucket_item = proto_tree_add_item(GetGroupInfo_Error_Congestion_Buckets_tree, hf_opa_GetGroupInfo_BWBuckets, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_item_set_text(GetGroupInfo_Error_Stats_Bucket_item, "Bucket %u: %3u%%+: %u", i, i * err, tvb_get_ntohl(tvb, local_offset));\r\nlocal_offset += 4;\r\nGetGroupInfo_Error_Stats_Bucket_item = proto_tree_add_item(GetGroupInfo_Error_SmaCongestion_Buckets_tree, hf_opa_GetGroupInfo_BWBuckets, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_item_set_text(GetGroupInfo_Error_Stats_Bucket_item, "Bucket %u: %3u%%+: %u", i, i * err, tvb_get_ntohl(tvb, local_offset));\r\nlocal_offset += 4;\r\nGetGroupInfo_Error_Stats_Bucket_item = proto_tree_add_item(GetGroupInfo_Error_Bubble_Buckets_tree, hf_opa_GetGroupInfo_BWBuckets, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_item_set_text(GetGroupInfo_Error_Stats_Bucket_item, "Bucket %u: %3u%%+: %u", i, i * err, tvb_get_ntohl(tvb, local_offset));\r\nlocal_offset += 4;\r\nGetGroupInfo_Error_Stats_Bucket_item = proto_tree_add_item(GetGroupInfo_Error_Security_Buckets_tree, hf_opa_GetGroupInfo_BWBuckets, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_item_set_text(GetGroupInfo_Error_Stats_Bucket_item, "Bucket %u: %3u%%+: %u", i, i * err, tvb_get_ntohl(tvb, local_offset));\r\nlocal_offset += 4;\r\nGetGroupInfo_Error_Stats_Bucket_item = proto_tree_add_item(GetGroupInfo_Error_Routing_Buckets_tree, hf_opa_GetGroupInfo_BWBuckets, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_item_set_text(GetGroupInfo_Error_Stats_Bucket_item, "Bucket %u: %3u%%+: %u", i, i * err, tvb_get_ntohl(tvb, local_offset));\r\nlocal_offset += 4;\r\n}\r\nGetGroupInfo_Error_Summary_tree = proto_tree_add_subtree(GetGroupInfo_header_tree, tvb, local_offset, 40 + PM_ERR_BUCKETS * 24,\r\nett_getgroupinfoerrorsummary, NULL, "External Error Statistics");\r\nGetGroupInfo_Error_Stats_Integrity_Buckets_item = proto_tree_add_item(GetGroupInfo_Error_Summary_tree, hf_opa_GetGroupInfo_integrityErrors, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nGetGroupInfo_Error_Stats_Congestion_Buckets_item = proto_tree_add_item(GetGroupInfo_Error_Summary_tree, hf_opa_GetGroupInfo_congestionErrors, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nGetGroupInfo_Error_Stats_SmaCongestion_Buckets_item = proto_tree_add_item(GetGroupInfo_Error_Summary_tree, hf_opa_GetGroupInfo_smaCongestionErrors, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nGetGroupInfo_Error_Stats_Bubble_Buckets_item = proto_tree_add_item(GetGroupInfo_Error_Summary_tree, hf_opa_GetGroupInfo_bubbleErrors, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nGetGroupInfo_Error_Stats_Security_Buckets_item = proto_tree_add_item(GetGroupInfo_Error_Summary_tree, hf_opa_GetGroupInfo_securityErrors, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nGetGroupInfo_Error_Stats_Routing_Buckets_item = proto_tree_add_item(GetGroupInfo_Error_Summary_tree, hf_opa_GetGroupInfo_routingErrors, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetGroupInfo_Error_Summary_tree, hf_opa_GetGroupInfo_utlizationPct10, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(GetGroupInfo_Error_Summary_tree, hf_opa_GetGroupInfo_discardsPct10, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(GetGroupInfo_Error_Summary_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetGroupInfo_Error_Summary_tree, hf_opa_reserved64, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nGetGroupInfo_Error_Integrity_Buckets_tree = proto_item_add_subtree(GetGroupInfo_Error_Stats_Integrity_Buckets_item, ett_getgroupinfoerrintegritybucket);\r\nGetGroupInfo_Error_Congestion_Buckets_tree = proto_item_add_subtree(GetGroupInfo_Error_Stats_Congestion_Buckets_item, ett_getgroupinfoerrcongestionbucket);\r\nGetGroupInfo_Error_SmaCongestion_Buckets_tree = proto_item_add_subtree(GetGroupInfo_Error_Stats_SmaCongestion_Buckets_item, ett_getgroupinfoerrsmacongestionbucket);\r\nGetGroupInfo_Error_Bubble_Buckets_tree = proto_item_add_subtree(GetGroupInfo_Error_Stats_Bubble_Buckets_item, ett_getgroupinfoerrbubblebucket);\r\nGetGroupInfo_Error_Security_Buckets_tree = proto_item_add_subtree(GetGroupInfo_Error_Stats_Security_Buckets_item, ett_getgroupinfoerrsecuritybucket);\r\nGetGroupInfo_Error_Routing_Buckets_tree = proto_item_add_subtree(GetGroupInfo_Error_Stats_Routing_Buckets_item, ett_getgroupinfoerrroutingbucket);\r\nfor (i = 0; i < PM_ERR_BUCKETS; i++) {\r\nGetGroupInfo_Error_Stats_Bucket_item = proto_tree_add_item(GetGroupInfo_Error_Integrity_Buckets_tree, hf_opa_GetGroupInfo_BWBuckets, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_item_set_text(GetGroupInfo_Error_Stats_Bucket_item, "Bucket %u: %3u%%+: %u", i, i * err, tvb_get_ntohl(tvb, local_offset));\r\nlocal_offset += 4;\r\nGetGroupInfo_Error_Stats_Bucket_item = proto_tree_add_item(GetGroupInfo_Error_Congestion_Buckets_tree, hf_opa_GetGroupInfo_BWBuckets, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_item_set_text(GetGroupInfo_Error_Stats_Bucket_item, "Bucket %u: %3u%%+: %u", i, i * err, tvb_get_ntohl(tvb, local_offset));\r\nlocal_offset += 4;\r\nGetGroupInfo_Error_Stats_Bucket_item = proto_tree_add_item(GetGroupInfo_Error_SmaCongestion_Buckets_tree, hf_opa_GetGroupInfo_BWBuckets, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_item_set_text(GetGroupInfo_Error_Stats_Bucket_item, "Bucket %u: %3u%%+: %u", i, i * err, tvb_get_ntohl(tvb, local_offset));\r\nlocal_offset += 4;\r\nGetGroupInfo_Error_Stats_Bucket_item = proto_tree_add_item(GetGroupInfo_Error_Bubble_Buckets_tree, hf_opa_GetGroupInfo_BWBuckets, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_item_set_text(GetGroupInfo_Error_Stats_Bucket_item, "Bucket %u: %3u%%+: %u", i, i * err, tvb_get_ntohl(tvb, local_offset));\r\nlocal_offset += 4;\r\nGetGroupInfo_Error_Stats_Bucket_item = proto_tree_add_item(GetGroupInfo_Error_Security_Buckets_tree, hf_opa_GetGroupInfo_BWBuckets, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_item_set_text(GetGroupInfo_Error_Stats_Bucket_item, "Bucket %u: %3u%%+: %u", i, i * err, tvb_get_ntohl(tvb, local_offset));\r\nlocal_offset += 4;\r\nGetGroupInfo_Error_Stats_Bucket_item = proto_tree_add_item(GetGroupInfo_Error_Routing_Buckets_tree, hf_opa_GetGroupInfo_BWBuckets, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_item_set_text(GetGroupInfo_Error_Stats_Bucket_item, "Bucket %u: %3u%%+: %u", i, i * err, tvb_get_ntohl(tvb, local_offset));\r\nlocal_offset += 4;\r\n}\r\nproto_tree_add_item(GetGroupInfo_header_tree, hf_opa_GetGroupInfo_maxInternalRate, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(GetGroupInfo_header_tree, hf_opa_GetGroupInfo_minInternalRate, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(GetGroupInfo_header_tree, hf_opa_GetGroupInfo_maxExternalRate, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(GetGroupInfo_header_tree, hf_opa_GetGroupInfo_minExternalRate, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(GetGroupInfo_header_tree, hf_opa_GetGroupInfo_maxInternalMBps, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetGroupInfo_header_tree, hf_opa_GetGroupInfo_maxExternalMBps, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_GetGroupConfig(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD, RMPP_t *RMPP, PA_HEADER_t *PA_HEADER)\r\n{\r\nproto_item *GetGroupConfig_header_item;\r\nproto_tree *GetGroupConfig_header_tree = parentTree;\r\nproto_item *GetGroupConfig_Port_item;\r\nproto_tree *GetGroupConfig_Port_tree;\r\ngint local_offset = *offset;\r\nguint i;\r\nguint length = ((RMPP->resptime_flags & RMPP_FLAG_LAST_MASK) ? (RMPP->PayloadLength - 20) % STL_MAX_SA_PA_PAYLOAD : STL_MAX_SA_PA_PAYLOAD);\r\nguint records = (PA_HEADER->AttributeOffset ? length / (PA_HEADER->AttributeOffset * 8) : 0);\r\nif (!parentTree)\r\nreturn *offset;\r\nif (MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE) {\r\nGetGroupConfig_header_item = proto_tree_add_item(parentTree, hf_opa_GetGroupConfig, tvb, local_offset, 64 + 16, ENC_NA);\r\nproto_item_set_text(GetGroupConfig_header_item, "GroupConfig for %s", tvb_get_string_enc(wmem_file_scope(), tvb, local_offset, 64, ENC_ASCII));\r\nGetGroupConfig_header_tree = proto_item_add_subtree(GetGroupConfig_header_item, ett_getgroupconfig);\r\nproto_tree_add_item(GetGroupConfig_header_tree, hf_opa_GetGroupConfig_groupName, tvb, local_offset, 64, ENC_ASCII | ENC_NA);\r\nlocal_offset += 64;\r\nlocal_offset = parse_Image(GetGroupConfig_header_tree, tvb, &local_offset);\r\n} else if (MAD->Method == METHOD_GET_RESP || MAD->Method == METHOD_GETTABLE_RESP) {\r\nGetGroupConfig_header_item = proto_tree_add_item(parentTree, hf_opa_GetGroupConfig, tvb, local_offset, records * PA_HEADER->AttributeOffset * 8, ENC_NA);\r\nGetGroupConfig_header_tree = proto_item_add_subtree(GetGroupConfig_header_item, ett_getgroupconfig);\r\nfor (i = 0; i < records; i++) {\r\nGetGroupConfig_Port_tree = proto_tree_add_subtree_format(GetGroupConfig_header_tree, tvb, local_offset,\r\nPA_HEADER->AttributeOffset * 8, ett_getgroupconfigport, &GetGroupConfig_Port_item, "%3u: ", i);\r\nlocal_offset = parse_Image(GetGroupConfig_Port_tree, tvb, &local_offset);\r\nproto_tree_add_item(GetGroupConfig_Port_tree, hf_opa_GetGroupConfig_Port_NodeGUID, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetGroupConfig_Port_tree, hf_opa_GetGroupConfig_Port_nodeDesc, tvb, local_offset, 64, ENC_ASCII | ENC_NA);\r\nlocal_offset += 64;\r\nproto_item_append_text(GetGroupConfig_Port_item, "LID: 0x%04x, Port: %u", tvb_get_ntohl(tvb, local_offset), tvb_get_guint8(tvb, local_offset + 4));\r\nproto_tree_add_item(GetGroupConfig_Port_tree, hf_opa_GetGroupConfig_Port_NodeLID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetGroupConfig_Port_tree, hf_opa_GetGroupConfig_Port_PortNumber, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(GetGroupConfig_Port_tree, hf_opa_reserved24, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\n}\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_GetPortCounters(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\nproto_tree *GetPortCounters_header_tree;\r\nproto_item *GetPortCounters_header_item;\r\ngint local_offset = *offset;\r\nif (!parentTree)\r\nreturn *offset;\r\nGetPortCounters_header_item = proto_tree_add_item(parentTree, hf_opa_GetPortCounters, tvb, local_offset, 232 + 16, ENC_NA);\r\nproto_item_set_text(GetPortCounters_header_item, "Port Counters for LID: 0x%x Port: %u", tvb_get_ntohl(tvb, local_offset), tvb_get_guint8(tvb, local_offset + 4));\r\nGetPortCounters_header_tree = proto_item_add_subtree(GetPortCounters_header_item, ett_getportcounters);\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_nodeLID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_PortNumber, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_reserved24, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_flags, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_reserved64, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nlocal_offset = parse_Image(GetPortCounters_header_tree, tvb, &local_offset);\r\nif (MAD->Method == METHOD_GET_RESP || MAD->Method == METHOD_GETTABLE_RESP) {\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_PortXmitData, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_PortRcvData, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_PortXmitPkts, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_PortRcvPkts, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_PortMulticastXmitPkts, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_PortMulticastRcvPkts, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_LocalLinkIntegrityErrors, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_FMConfigErrors, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_PortRcvErrors, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_ExcessiveBufferOverruns, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_PortRcvConstraintErrors, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_PortRcvSwitchRelayErrors, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_PortXmitDiscards, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_PortXmitConstraintErrors, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_PortRcvRemotePhysicalErrors, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_SwPortCongestion, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_PortXmitWait, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_PortRcvFECN, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_PortRcvBECN, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_PortXmitTimeCong, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_PortXmitWastedBW, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_PortXmitWaitData, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_PortRcvBubble, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_PortMarkFECN, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_LinkErrorRecovery, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_LinkDowned, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_UncorrectableErrors, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_NumLanesDown, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_reserved, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_GetPortCounters_LinkQualityIndicator, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(GetPortCounters_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\n} else {\r\nlocal_offset += 208;\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_ClearPortCounters(proto_tree *parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\nproto_tree *ClearPortCounters_header_tree;\r\nproto_item *ClearPortCounters_header_item;\r\ngint local_offset = *offset;\r\nif (!parentTree)\r\nreturn *offset;\r\nClearPortCounters_header_item = proto_tree_add_item(parentTree, hf_opa_ClearPortCounters, tvb, local_offset, 20, ENC_NA);\r\nproto_item_set_text(ClearPortCounters_header_item, "Clear User Port Counters for LID: 0x%x Port: %u", tvb_get_ntohl(tvb, local_offset), tvb_get_guint8(tvb, local_offset + 4));\r\nClearPortCounters_header_tree = proto_item_add_subtree(ClearPortCounters_header_item, ett_clearportcounters);\r\nproto_tree_add_item(ClearPortCounters_header_tree, hf_opa_ClearPortCounters_nodeLID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(ClearPortCounters_header_tree, hf_opa_ClearPortCounters_PortNumber, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(ClearPortCounters_header_tree, hf_opa_reserved24, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(ClearPortCounters_header_tree, hf_opa_reserved64, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_bitmask(ClearPortCounters_header_tree, tvb, local_offset,\r\nhf_opa_ClearPortCounters_CounterSelectMask, ett_clearportcounters_counterselectmask,\r\n_ClearPortCounters_CounterSelectMask, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nreturn local_offset;\r\n}\r\nstatic gint parse_ClearAllPortCounters(proto_tree *parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\nproto_tree *ClearAllPortCounters_header_tree;\r\nproto_item *ClearAllPortCounters_header_item;\r\ngint local_offset = *offset;\r\nif (!parentTree)\r\nreturn *offset;\r\nClearAllPortCounters_header_item = proto_tree_add_item(parentTree, hf_opa_ClearAllPortCounters, tvb, local_offset, 4, ENC_NA);\r\nproto_item_set_text(ClearAllPortCounters_header_item, "Clear All User Port Counters");\r\nClearAllPortCounters_header_tree = proto_item_add_subtree(ClearAllPortCounters_header_item, ett_clearallportcounters);\r\nproto_tree_add_bitmask(ClearAllPortCounters_header_tree, tvb, local_offset,\r\nhf_opa_ClearAllPortCounters_CounterSelectMask, ett_clearallportcounters_counterselectmask,\r\n_ClearAllPortCounters_CounterSelectMask, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nreturn local_offset;\r\n}\r\nstatic gint parse_PMConfig(proto_tree *parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\nproto_tree *PMConfig_header_tree;\r\nproto_item *PMConfig_header_item;\r\ngint local_offset = *offset;\r\nif (!parentTree)\r\nreturn *offset;\r\nPMConfig_header_item = proto_tree_add_item(parentTree, hf_opa_PMConfig, tvb, local_offset, 104, ENC_NA);\r\nPMConfig_header_tree = proto_item_add_subtree(PMConfig_header_item, ett_pmconfig);\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_sweepInterval, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_maxClients, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_sizeHistory, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_sizeFreeze, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_lease, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_pmFlags, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_PortXmitWait, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_SwPortCongestion, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_PortRcvFECN, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_PortRcvBECN, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_PortXmitTimeCong, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_PortMarkFECN, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_integrityErrors, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_congestionErrors, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_smaCongestionErrors, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_bubbleErrors, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_securityErrors, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_routingErrors, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_LocalLinkIntegrityErrors, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_PortRcvErrors, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_ExcessiveBufferOverrunErrors, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_LinkErrorRecovery, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_LinkDowned, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_UncorrectableErrors, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_FMConfigErrors, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_LinkQualityIndicator, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_LinkWidthDowngrade, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_reserved8, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_memoryFootprint, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_maxAttempts, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_respTimeout, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_minRespTimeout, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_maxParallelNodes, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_pmaBatchSize, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_PMConfig_errorClear, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(PMConfig_header_tree, hf_opa_reserved24, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nreturn local_offset;\r\n}\r\nstatic gint parse_MoveFreezeFrame(proto_tree *parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\nproto_tree *MoveFreezeFrame_header_tree = parentTree;\r\nproto_item *MoveFreezeFrame_old_item;\r\nproto_tree *MoveFreezeFrame_old_tree;\r\nproto_item *MoveFreezeFrame_new_item;\r\nproto_tree *MoveFreezeFrame_new_tree;\r\ngint local_offset = *offset;\r\nif (!parentTree)\r\nreturn *offset;\r\nMoveFreezeFrame_old_item = proto_tree_add_item(MoveFreezeFrame_header_tree, hf_opa_MoveFreezeFrame_old, tvb, local_offset, 16, ENC_NA);\r\nMoveFreezeFrame_old_tree = proto_item_add_subtree(MoveFreezeFrame_old_item, ett_movefreezeframeold);\r\nlocal_offset = parse_Image(MoveFreezeFrame_old_tree, tvb, &local_offset);\r\nMoveFreezeFrame_new_item = proto_tree_add_item(MoveFreezeFrame_header_tree, hf_opa_MoveFreezeFrame_new, tvb, local_offset, 16, ENC_NA);\r\nMoveFreezeFrame_new_tree = proto_item_add_subtree(MoveFreezeFrame_new_item, ett_movefreezeframenew);\r\nlocal_offset = parse_Image(MoveFreezeFrame_new_tree, tvb, &local_offset);\r\nreturn local_offset;\r\n}\r\nstatic gint parse_GetFocusPorts(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD, RMPP_t *RMPP, PA_HEADER_t *PA_HEADER)\r\n{\r\nproto_tree *GetFocusPorts_header_tree;\r\nproto_item *GetFocusPorts_header_item;\r\nproto_tree *GetFocusPorts_Port_tree;\r\nproto_item *GetFocusPorts_Port_item;\r\ngint local_offset = *offset;\r\nguint i = 0;\r\nguint length = ((RMPP->resptime_flags & RMPP_FLAG_LAST_MASK) ? (RMPP->PayloadLength - 20) % STL_MAX_SA_PA_PAYLOAD : STL_MAX_SA_PA_PAYLOAD);\r\nguint records = (PA_HEADER->AttributeOffset ? length / (PA_HEADER->AttributeOffset * 8) : 0);\r\nif (!parentTree)\r\nreturn *offset;\r\nif (MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE) {\r\nGetFocusPorts_header_item = proto_tree_add_item(parentTree, hf_opa_GetFocusPorts, tvb, local_offset, 64 + 28, ENC_NA);\r\nproto_item_set_text(GetFocusPorts_header_item, "Focus Ports for %s", tvb_get_string_enc(wmem_file_scope(), tvb, local_offset, 64, ENC_ASCII));\r\nGetFocusPorts_header_tree = proto_item_add_subtree(GetFocusPorts_header_item, ett_getfocusports);\r\nproto_tree_add_item(GetFocusPorts_header_tree, hf_opa_GetFocusPorts_groupName, tvb, local_offset, 64, ENC_ASCII | ENC_NA);\r\nlocal_offset += 64;\r\nlocal_offset = parse_Image(GetFocusPorts_header_tree, tvb, &local_offset);\r\nproto_tree_add_item(GetFocusPorts_header_tree, hf_opa_GetFocusPorts_select, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetFocusPorts_header_tree, hf_opa_GetFocusPorts_start, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetFocusPorts_header_tree, hf_opa_GetFocusPorts_range, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\n} else if (MAD->Method == METHOD_GET_RESP || MAD->Method == METHOD_GETTABLE_RESP) {\r\nGetFocusPorts_header_item = proto_tree_add_item(parentTree, hf_opa_GetFocusPorts, tvb, local_offset, records * PA_HEADER->AttributeOffset * 8, ENC_NA);\r\nGetFocusPorts_header_tree = proto_item_add_subtree(GetFocusPorts_header_item, ett_getfocusports);\r\nfor (i = 0; i < records; i++) {\r\nGetFocusPorts_Port_tree = proto_tree_add_subtree_format(GetFocusPorts_header_tree, tvb, local_offset,\r\nPA_HEADER->AttributeOffset * 8, ett_getfocusportsport, &GetFocusPorts_Port_item, "%3u: ", i);\r\nlocal_offset = parse_Image(GetFocusPorts_Port_tree, tvb, &local_offset);\r\nproto_item_append_text(GetFocusPorts_Port_item, "LID: %04x, Port %u",\r\ntvb_get_ntohl(tvb, local_offset), tvb_get_guint8(tvb, local_offset + 4));\r\nproto_tree_add_item(GetFocusPorts_Port_tree, hf_opa_GetFocusPorts_nodeLID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetFocusPorts_Port_tree, hf_opa_GetFocusPorts_portNumber, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(GetFocusPorts_Port_tree, hf_opa_GetFocusPorts_rate, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(GetFocusPorts_Port_tree, hf_opa_GetFocusPorts_mtu, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(GetFocusPorts_Port_tree, hf_opa_GetFocusPorts_localFlags, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(GetFocusPorts_Port_tree, hf_opa_GetFocusPorts_neighborFlags, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(GetFocusPorts_Port_tree, hf_opa_GetFocusPorts_value, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetFocusPorts_Port_tree, hf_opa_GetFocusPorts_nodeGUID, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetFocusPorts_Port_tree, hf_opa_GetFocusPorts_nodeDesc, tvb, local_offset, 64, ENC_ASCII | ENC_NA);\r\nlocal_offset += 64;\r\nproto_tree_add_item(GetFocusPorts_Port_tree, hf_opa_GetFocusPorts_neighborLid, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetFocusPorts_Port_tree, hf_opa_GetFocusPorts_neighborPortNumber, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(GetFocusPorts_Port_tree, hf_opa_reserved24, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(GetFocusPorts_Port_tree, hf_opa_GetFocusPorts_neighborValue, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetFocusPorts_Port_tree, hf_opa_GetFocusPorts_neighborGuid, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetFocusPorts_Port_tree, hf_opa_GetFocusPorts_neighborNodeDesc, tvb, local_offset, 64, ENC_ASCII | ENC_NA);\r\nlocal_offset += 64;\r\n}\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_GetImageInfo(proto_tree *parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\nproto_tree *GetImageInfo_header_tree = parentTree;\r\nproto_item *GetImageInfo_header_item;\r\nproto_tree *GetImageInfo_SM_tree;\r\nguint32 numSMs;\r\nnstime_t ts;\r\ngint local_offset = *offset;\r\nif (!parentTree)\r\nreturn *offset;\r\nGetImageInfo_header_item = proto_tree_add_item(parentTree, hf_opa_GetImageInfo, tvb, local_offset, 216, ENC_NA);\r\nGetImageInfo_header_tree = proto_item_add_subtree(GetImageInfo_header_item, ett_getimageinfo);\r\nlocal_offset = parse_Image(GetImageInfo_header_tree, tvb, &local_offset);\r\nts.secs = (time_t)tvb_get_guint64(tvb, local_offset, ENC_BIG_ENDIAN);\r\nts.nsecs = 0;\r\nproto_tree_add_time(GetImageInfo_header_tree, hf_opa_GetImageInfo_sweepStart, tvb, local_offset, 8, &ts);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetImageInfo_header_tree, hf_opa_GetImageInfo_sweepDuration, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetImageInfo_header_tree, hf_opa_GetImageInfo_numHFIPorts, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(GetImageInfo_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetImageInfo_header_tree, hf_opa_GetImageInfo_numSwitchNodes, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(GetImageInfo_header_tree, hf_opa_GetImageInfo_numSwitchPorts, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetImageInfo_header_tree, hf_opa_GetImageInfo_numLinks, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nnumSMs = tvb_get_ntohl(tvb, local_offset);\r\nproto_tree_add_item(GetImageInfo_header_tree, hf_opa_GetImageInfo_numSMs, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetImageInfo_header_tree, hf_opa_GetImageInfo_numFailedNodes, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetImageInfo_header_tree, hf_opa_GetImageInfo_numFailedPorts, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetImageInfo_header_tree, hf_opa_GetImageInfo_numSkippedNodes, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetImageInfo_header_tree, hf_opa_GetImageInfo_numSkippedPorts, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetImageInfo_header_tree, hf_opa_GetImageInfo_numUnexpectedClearPorts, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetImageInfo_header_tree, hf_opa_GetImageInfo_imageInterval, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nGetImageInfo_SM_tree = proto_tree_add_subtree(GetImageInfo_header_tree, tvb, local_offset, 16 + 64,\r\nett_getimageinfosm, NULL, "Primary SM Info");\r\nproto_tree_add_item(GetImageInfo_SM_tree, hf_opa_GetImageInfo_lid, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetImageInfo_SM_tree, hf_opa_GetImageInfo_state, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(GetImageInfo_SM_tree, hf_opa_GetImageInfo_priority, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(GetImageInfo_SM_tree, hf_opa_GetImageInfo_portNumber, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(GetImageInfo_SM_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(GetImageInfo_SM_tree, hf_opa_GetImageInfo_smPortGuid, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetImageInfo_SM_tree, hf_opa_GetImageInfo_smNodeDesc, tvb, local_offset, 64, ENC_NA | ENC_ASCII);\r\nlocal_offset += 64;\r\nif (!numSMs || numSMs > 1) {\r\nGetImageInfo_SM_tree = proto_tree_add_subtree(GetImageInfo_header_tree, tvb, local_offset, 16 + 64,\r\nett_getimageinfosm, NULL, "Secondary SM Info");\r\nproto_tree_add_item(GetImageInfo_SM_tree, hf_opa_GetImageInfo_lid, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetImageInfo_SM_tree, hf_opa_GetImageInfo_state, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(GetImageInfo_SM_tree, hf_opa_GetImageInfo_priority, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(GetImageInfo_SM_tree, hf_opa_GetImageInfo_portNumber, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(GetImageInfo_SM_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(GetImageInfo_SM_tree, hf_opa_GetImageInfo_smPortGuid, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetImageInfo_SM_tree, hf_opa_GetImageInfo_smNodeDesc, tvb, local_offset, 64, ENC_NA | ENC_ASCII);\r\nlocal_offset += 64;\r\n} else {\r\nproto_tree_add_subtree(GetImageInfo_header_tree, tvb, local_offset, 16 + 64,\r\nett_getimageinfosm, NULL, "No Secondary SM Info");\r\nlocal_offset += (16 + 64);\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_GetVFList(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD, RMPP_t *RMPP, PA_HEADER_t *PA_HEADER)\r\n{\r\nproto_item *GetVFList_GroupName_item;\r\nproto_tree *GetVFList_header_tree;\r\nproto_item *GetVFList_header_item;\r\ngint local_offset = *offset;\r\nguint i;\r\nguint length = ((RMPP->resptime_flags & RMPP_FLAG_LAST_MASK) ? (RMPP->PayloadLength - 20) % STL_MAX_SA_PA_PAYLOAD : STL_MAX_SA_PA_PAYLOAD);\r\nguint records = (PA_HEADER->AttributeOffset ? length / (PA_HEADER->AttributeOffset * 8) : 0);\r\nif (!parentTree || RMPP->Type != RMPP_DATA ||\r\n(MAD->Method != METHOD_GET_RESP && MAD->Method != METHOD_GETTABLE_RESP)) {\r\nreturn *offset;\r\n}\r\nGetVFList_header_item = proto_tree_add_item(parentTree, hf_opa_GetVFList, tvb, local_offset, length, ENC_NA);\r\nGetVFList_header_tree = proto_item_add_subtree(GetVFList_header_item, ett_getvflist);\r\nproto_tree_add_none_format(GetVFList_header_tree, hf_opa_GetVFList, tvb, local_offset, length, "Number of VFs: %u", records);\r\nfor (i = 0; i < records; i++) {\r\nGetVFList_GroupName_item = proto_tree_add_item(GetVFList_header_tree, hf_opa_GetVFList_vfName, tvb, local_offset, 64, ENC_ASCII | ENC_NA);\r\nlocal_offset += 64;\r\nproto_item_prepend_text(GetVFList_GroupName_item, "%3u: ", i + 1);\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_GetVFInfo(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD, RMPP_t *RMPP, PA_HEADER_t *PA_HEADER)\r\n{\r\nproto_tree *GetVFInfo_header_tree = parentTree;\r\nproto_tree *GetVFInfo_header_item = parentTree;\r\nproto_tree *GetVFInfo_Util_Stats_tree;\r\nproto_item *GetVFInfo_Util_Stats_Buckets_item;\r\nproto_tree *GetVFInfo_Util_Stats_Buckets_tree;\r\nproto_item *GetVFInfo_Util_Stats_Bucket_item;\r\nproto_tree *GetVFInfo_Error_Summary_tree;\r\nproto_tree *GetVFInfo_Error_Integrity_Buckets_tree;\r\nproto_tree *GetVFInfo_Error_Congestion_Buckets_tree;\r\nproto_tree *GetVFInfo_Error_SmaCongestion_Buckets_tree;\r\nproto_tree *GetVFInfo_Error_Bubble_Buckets_tree;\r\nproto_tree *GetVFInfo_Error_Security_Buckets_tree;\r\nproto_tree *GetVFInfo_Error_Routing_Buckets_tree;\r\nproto_item *GetVFInfo_Error_Stats_Integrity_Buckets_item;\r\nproto_item *GetVFInfo_Error_Stats_Congestion_Buckets_item;\r\nproto_item *GetVFInfo_Error_Stats_SmaCongestion_Buckets_item;\r\nproto_item *GetVFInfo_Error_Stats_Bubble_Buckets_item;\r\nproto_item *GetVFInfo_Error_Stats_Security_Buckets_item;\r\nproto_item *GetVFInfo_Error_Stats_Routing_Buckets_item;\r\nproto_item *GetVFInfo_Error_Stats_Bucket_item;\r\ngint local_offset = *offset;\r\nguint i;\r\nguint length = ((RMPP->resptime_flags & RMPP_FLAG_LAST_MASK) ? (RMPP->PayloadLength - 20) % STL_MAX_SA_PA_PAYLOAD : STL_MAX_SA_PA_PAYLOAD);\r\nguint records = (PA_HEADER->AttributeOffset ? length / (PA_HEADER->AttributeOffset * 8) : 0);\r\nguint util = 100 / PM_UTIL_BUCKETS;\r\nguint err = 100 / (PM_ERR_BUCKETS - 1);\r\nif (!parentTree) {\r\nreturn *offset;\r\n}\r\nif (MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE) {\r\nGetVFInfo_header_item = proto_tree_add_item(parentTree, hf_opa_GetVFInfo, tvb, local_offset, 64 + 24, ENC_NA);\r\nproto_item_set_text(GetVFInfo_header_item, "VFInfo for %s", tvb_get_string_enc(wmem_file_scope(), tvb, local_offset, 64, ENC_ASCII));\r\nGetVFInfo_header_tree = proto_item_add_subtree(GetVFInfo_header_item, ett_getvfinfo);\r\nproto_tree_add_item(GetVFInfo_header_tree, hf_opa_GetVFInfo_vfName, tvb, local_offset, 64, ENC_ASCII | ENC_NA);\r\nlocal_offset += 64;\r\nproto_tree_add_item(GetVFInfo_header_tree, hf_opa_reserved64, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nlocal_offset = parse_Image(GetVFInfo_header_tree, tvb, &local_offset);\r\nreturn local_offset;\r\n}\r\nfor (i = 0; i < records; i++) {\r\nGetVFInfo_header_item = proto_tree_add_item(parentTree, hf_opa_GetVFInfo, tvb, local_offset, PA_HEADER->AttributeOffset * 8, ENC_NA);\r\nproto_item_set_text(GetVFInfo_header_item, "VFInfo for %s", tvb_get_string_enc(wmem_file_scope(), tvb, local_offset, 64, ENC_ASCII));\r\nGetVFInfo_header_tree = proto_item_add_subtree(GetVFInfo_header_item, ett_getvfinfo);\r\nproto_tree_add_item(GetVFInfo_header_tree, hf_opa_GetVFInfo_vfName, tvb, local_offset, 64, ENC_ASCII | ENC_NA);\r\nlocal_offset += 64;\r\nproto_tree_add_item(GetVFInfo_header_tree, hf_opa_reserved64, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nlocal_offset = parse_Image(GetVFInfo_header_tree, tvb, &local_offset);\r\nproto_tree_add_item(GetVFInfo_header_tree, hf_opa_GetVFInfo_numPorts, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nGetVFInfo_Util_Stats_tree = proto_tree_add_subtree(GetVFInfo_header_tree, tvb, local_offset, 40 + PM_UTIL_BUCKETS * 4,\r\nett_getvfinfoutilstats, NULL, "Internal Utilization Statistics");\r\nproto_tree_add_item(GetVFInfo_Util_Stats_tree, hf_opa_GetVFInfo_totalMBps, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetVFInfo_Util_Stats_tree, hf_opa_GetVFInfo_totalKPps, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetVFInfo_Util_Stats_tree, hf_opa_GetVFInfo_avgMBps, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetVFInfo_Util_Stats_tree, hf_opa_GetVFInfo_minMBps, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetVFInfo_Util_Stats_tree, hf_opa_GetVFInfo_maxMBps, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nGetVFInfo_Util_Stats_Buckets_item = proto_tree_add_item(GetVFInfo_Util_Stats_tree, hf_opa_GetVFInfo_numBWBuckets, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nGetVFInfo_Util_Stats_Buckets_tree = proto_item_add_subtree(GetVFInfo_Util_Stats_Buckets_item, ett_getvfinfoutilbuckets);\r\nfor (i = 0; i < PM_UTIL_BUCKETS; i++) {\r\nGetVFInfo_Util_Stats_Bucket_item = proto_tree_add_item(GetVFInfo_Util_Stats_Buckets_tree, hf_opa_GetVFInfo_BWBuckets, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_item_set_text(GetVFInfo_Util_Stats_Bucket_item, "Bucket %u: %3u%%+: %u", i, i * util, tvb_get_ntohl(tvb, local_offset));\r\nlocal_offset += 4;\r\n}\r\nproto_tree_add_item(GetVFInfo_Util_Stats_tree, hf_opa_GetVFInfo_avgKPps, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetVFInfo_Util_Stats_tree, hf_opa_GetVFInfo_minKPps, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetVFInfo_Util_Stats_tree, hf_opa_GetVFInfo_maxKPps, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetVFInfo_Util_Stats_tree, hf_opa_GetVFInfo_pmaFailedPorts, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(GetVFInfo_Util_Stats_tree, hf_opa_GetVFInfo_topoFailedPorts, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nGetVFInfo_Error_Summary_tree = proto_tree_add_subtree(GetVFInfo_header_tree, tvb, local_offset, 40 + PM_ERR_BUCKETS * 24,\r\nett_getvfinfoerrorsummary, NULL, "Internal Error Statistics");\r\nGetVFInfo_Error_Stats_Integrity_Buckets_item = proto_tree_add_item(GetVFInfo_Error_Summary_tree, hf_opa_GetVFInfo_integrityErrors, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nGetVFInfo_Error_Stats_Congestion_Buckets_item = proto_tree_add_item(GetVFInfo_Error_Summary_tree, hf_opa_GetVFInfo_congestionErrors, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nGetVFInfo_Error_Stats_SmaCongestion_Buckets_item = proto_tree_add_item(GetVFInfo_Error_Summary_tree, hf_opa_GetVFInfo_smaCongestionErrors, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nGetVFInfo_Error_Stats_Bubble_Buckets_item = proto_tree_add_item(GetVFInfo_Error_Summary_tree, hf_opa_GetVFInfo_bubbleErrors, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nGetVFInfo_Error_Stats_Security_Buckets_item = proto_tree_add_item(GetVFInfo_Error_Summary_tree, hf_opa_GetVFInfo_securityErrors, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nGetVFInfo_Error_Stats_Routing_Buckets_item = proto_tree_add_item(GetVFInfo_Error_Summary_tree, hf_opa_GetVFInfo_routingErrors, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetVFInfo_Error_Summary_tree, hf_opa_GetVFInfo_utlizationPct10, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(GetVFInfo_Error_Summary_tree, hf_opa_GetVFInfo_discardsPct10, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(GetVFInfo_Error_Summary_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetVFInfo_Error_Summary_tree, hf_opa_reserved64, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nGetVFInfo_Error_Integrity_Buckets_tree = proto_item_add_subtree(GetVFInfo_Error_Stats_Integrity_Buckets_item, ett_getvfinfoerrintegritybucket);\r\nGetVFInfo_Error_Congestion_Buckets_tree = proto_item_add_subtree(GetVFInfo_Error_Stats_Congestion_Buckets_item, ett_getvfinfoerrcongestionbucket);\r\nGetVFInfo_Error_SmaCongestion_Buckets_tree = proto_item_add_subtree(GetVFInfo_Error_Stats_SmaCongestion_Buckets_item, ett_getvfinfoerrsmacongestionbucket);\r\nGetVFInfo_Error_Bubble_Buckets_tree = proto_item_add_subtree(GetVFInfo_Error_Stats_Bubble_Buckets_item, ett_getvfinfoerrbubblebucket);\r\nGetVFInfo_Error_Security_Buckets_tree = proto_item_add_subtree(GetVFInfo_Error_Stats_Security_Buckets_item, ett_getvfinfoerrsecuritybucket);\r\nGetVFInfo_Error_Routing_Buckets_tree = proto_item_add_subtree(GetVFInfo_Error_Stats_Routing_Buckets_item, ett_getvfinfoerrroutingbucket);\r\nfor (i = 0; i < PM_ERR_BUCKETS; i++) {\r\nGetVFInfo_Error_Stats_Bucket_item = proto_tree_add_item(GetVFInfo_Error_Integrity_Buckets_tree, hf_opa_GetVFInfo_BWBuckets, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_item_set_text(GetVFInfo_Error_Stats_Bucket_item, "Bucket %u: %3u%%+: %u", i, i * err, tvb_get_ntohl(tvb, local_offset));\r\nlocal_offset += 4;\r\nGetVFInfo_Error_Stats_Bucket_item = proto_tree_add_item(GetVFInfo_Error_Congestion_Buckets_tree, hf_opa_GetVFInfo_BWBuckets, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_item_set_text(GetVFInfo_Error_Stats_Bucket_item, "Bucket %u: %3u%%+: %u", i, i * err, tvb_get_ntohl(tvb, local_offset));\r\nlocal_offset += 4;\r\nGetVFInfo_Error_Stats_Bucket_item = proto_tree_add_item(GetVFInfo_Error_SmaCongestion_Buckets_tree, hf_opa_GetVFInfo_BWBuckets, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_item_set_text(GetVFInfo_Error_Stats_Bucket_item, "Bucket %u: %3u%%+: %u", i, i * err, tvb_get_ntohl(tvb, local_offset));\r\nlocal_offset += 4;\r\nGetVFInfo_Error_Stats_Bucket_item = proto_tree_add_item(GetVFInfo_Error_Bubble_Buckets_tree, hf_opa_GetVFInfo_BWBuckets, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_item_set_text(GetVFInfo_Error_Stats_Bucket_item, "Bucket %u: %3u%%+: %u", i, i * err, tvb_get_ntohl(tvb, local_offset));\r\nlocal_offset += 4;\r\nGetVFInfo_Error_Stats_Bucket_item = proto_tree_add_item(GetVFInfo_Error_Security_Buckets_tree, hf_opa_GetVFInfo_BWBuckets, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_item_set_text(GetVFInfo_Error_Stats_Bucket_item, "Bucket %u: %3u%%+: %u", i, i * err, tvb_get_ntohl(tvb, local_offset));\r\nlocal_offset += 4;\r\nGetVFInfo_Error_Stats_Bucket_item = proto_tree_add_item(GetVFInfo_Error_Routing_Buckets_tree, hf_opa_GetVFInfo_BWBuckets, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_item_set_text(GetVFInfo_Error_Stats_Bucket_item, "Bucket %u: %3u%%+: %u", i, i * err, tvb_get_ntohl(tvb, local_offset));\r\nlocal_offset += 4;\r\n}\r\nproto_tree_add_item(GetVFInfo_header_tree, hf_opa_GetVFInfo_maxInternalRate, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(GetVFInfo_header_tree, hf_opa_GetVFInfo_minInternalRate, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(GetVFInfo_header_tree, hf_opa_GetVFInfo_maxInternalMBps, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_GetVFConfig(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD, RMPP_t *RMPP, PA_HEADER_t *PA_HEADER)\r\n{\r\nproto_tree *GetVFConfig_header_tree;\r\nproto_item *GetVFConfig_header_item;\r\nproto_item *GetVFConfig_Port_item;\r\nproto_tree *GetVFConfig_Port_tree;\r\ngint local_offset = *offset;\r\nguint i;\r\nguint length = ((RMPP->resptime_flags & RMPP_FLAG_LAST_MASK) ? (RMPP->PayloadLength - 20) % STL_MAX_SA_PA_PAYLOAD : STL_MAX_SA_PA_PAYLOAD);\r\nguint records = (PA_HEADER->AttributeOffset ? length / (PA_HEADER->AttributeOffset * 8) : 0);\r\nif (!parentTree)\r\nreturn *offset;\r\nif (MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE) {\r\nGetVFConfig_header_item = proto_tree_add_item(parentTree, hf_opa_GetVFConfig, tvb, local_offset, 64 + 24, ENC_NA);\r\nproto_item_set_text(GetVFConfig_header_item, "VF Config");\r\nGetVFConfig_header_tree = proto_item_add_subtree(GetVFConfig_header_item, ett_getvfconfig);\r\nproto_tree_add_item(GetVFConfig_header_tree, hf_opa_GetVFConfig_vfName, tvb, local_offset, 64, ENC_ASCII | ENC_NA);\r\nlocal_offset += 64;\r\nproto_tree_add_item(GetVFConfig_header_tree, hf_opa_reserved64, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nlocal_offset = parse_Image(GetVFConfig_header_tree, tvb, &local_offset);\r\n} else if (MAD->Method == METHOD_GETTABLE_RESP || MAD->Method == METHOD_GET_RESP) {\r\nGetVFConfig_header_item = proto_tree_add_item(parentTree, hf_opa_GetVFConfig, tvb, local_offset, records * PA_HEADER->AttributeOffset * 8, ENC_NA);\r\nproto_item_set_text(GetVFConfig_header_item, "VF Config");\r\nGetVFConfig_header_tree = proto_item_add_subtree(GetVFConfig_header_item, ett_getvfconfig);\r\nfor (i = 0; i < records; i++) {\r\nGetVFConfig_Port_tree = proto_tree_add_subtree_format(GetVFConfig_header_tree, tvb, local_offset,\r\nPA_HEADER->AttributeOffset * 8, ett_getvfconfigport, &GetVFConfig_Port_item, "%3u: ", i);\r\nlocal_offset = parse_Image(GetVFConfig_Port_tree, tvb, &local_offset);\r\nproto_tree_add_item(GetVFConfig_Port_tree, hf_opa_GetVFConfig_Port_NodeGUID, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetVFConfig_Port_tree, hf_opa_GetVFConfig_Port_nodeDesc, tvb, local_offset, 64, ENC_ASCII | ENC_NA);\r\nlocal_offset += 64;\r\nproto_item_append_text(GetVFConfig_Port_item, "LID: 0x%04x, Port: %u", tvb_get_ntohl(tvb, local_offset), tvb_get_guint8(tvb, local_offset + 4));\r\nproto_tree_add_item(GetVFConfig_Port_tree, hf_opa_GetVFConfig_Port_NodeLID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetVFConfig_Port_tree, hf_opa_GetVFConfig_Port_PortNumber, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(GetVFConfig_Port_tree, hf_opa_reserved24, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\n}\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_GetVFPortCounters(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD)\r\n{\r\nproto_tree *GetVFPortCounters_header_tree;\r\nproto_item *GetVFPortCounters_header_item;\r\ngint local_offset = *offset;\r\nif (!parentTree)\r\nreturn *offset;\r\nGetVFPortCounters_header_item = proto_tree_add_item(parentTree, hf_opa_GetVFPortCounters, tvb, local_offset, 224, ENC_NA);\r\nGetVFPortCounters_header_tree = proto_item_add_subtree(GetVFPortCounters_header_item, ett_getvfportcounters);\r\nproto_tree_add_item(GetVFPortCounters_header_tree, hf_opa_GetVFPortCounters_nodeLID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetVFPortCounters_header_tree, hf_opa_GetVFPortCounters_PortNumber, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(GetVFPortCounters_header_tree, hf_opa_reserved24, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(GetVFPortCounters_header_tree, hf_opa_GetVFPortCounters_flags, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetVFPortCounters_header_tree, hf_opa_reserved32, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetVFPortCounters_header_tree, hf_opa_reserved64, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetVFPortCounters_header_tree, hf_opa_GetVFPortCounters_vfName, tvb, local_offset, 64, ENC_ASCII | ENC_NA);\r\nlocal_offset += 64;\r\nproto_tree_add_item(GetVFPortCounters_header_tree, hf_opa_reserved64, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nlocal_offset = parse_Image(GetVFPortCounters_header_tree, tvb, &local_offset);\r\nif (MAD->Method == METHOD_GET_RESP || MAD->Method == METHOD_GETTABLE_RESP) {\r\nproto_tree_add_item(GetVFPortCounters_header_tree, hf_opa_GetVFPortCounters_PortVFXmitData, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetVFPortCounters_header_tree, hf_opa_GetVFPortCounters_PortVFRcvData, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetVFPortCounters_header_tree, hf_opa_GetVFPortCounters_PortVFXmitPkts, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetVFPortCounters_header_tree, hf_opa_GetVFPortCounters_PortVFRcvPkts, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetVFPortCounters_header_tree, hf_opa_GetVFPortCounters_PortVFXmitDiscards, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetVFPortCounters_header_tree, hf_opa_GetVFPortCounters_SwPortVFCongestion, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetVFPortCounters_header_tree, hf_opa_GetVFPortCounters_PortVFXmitWait, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetVFPortCounters_header_tree, hf_opa_GetVFPortCounters_PortVFRcvFECN, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetVFPortCounters_header_tree, hf_opa_GetVFPortCounters_PortVFRcvBECN, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetVFPortCounters_header_tree, hf_opa_GetVFPortCounters_PortVFXmitTimeCong, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetVFPortCounters_header_tree, hf_opa_GetVFPortCounters_PortVFXmitWastedBW, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetVFPortCounters_header_tree, hf_opa_GetVFPortCounters_PortVFXmitWaitData, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetVFPortCounters_header_tree, hf_opa_GetVFPortCounters_PortVFRcvBubble, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetVFPortCounters_header_tree, hf_opa_GetVFPortCounters_PortVFMarkFECN, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\n} else {\r\nlocal_offset += 112;\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gint parse_ClearVFPortCounters(proto_tree *parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\nproto_tree *ClearVFPortCounters_header_tree;\r\nproto_item *ClearVFPortCounters_header_item;\r\ngint local_offset = *offset;\r\nif (!parentTree)\r\nreturn *offset;\r\nClearVFPortCounters_header_item = proto_tree_add_item(parentTree, hf_opa_ClearVFPortCounters, tvb, local_offset, 92, ENC_NA);\r\nClearVFPortCounters_header_tree = proto_item_add_subtree(ClearVFPortCounters_header_item, ett_clearvfportcounters);\r\nproto_tree_add_item(ClearVFPortCounters_header_tree, hf_opa_ClearVFPortCounters_nodeLID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(ClearVFPortCounters_header_tree, hf_opa_ClearVFPortCounters_PortNumber, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(ClearVFPortCounters_header_tree, hf_opa_reserved24, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(ClearVFPortCounters_header_tree, hf_opa_reserved64, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(ClearVFPortCounters_header_tree, hf_opa_ClearVFPortCounters_vfName, tvb, local_offset, 64, ENC_ASCII | ENC_NA);\r\nlocal_offset += 64;\r\nproto_tree_add_item(ClearVFPortCounters_header_tree, hf_opa_reserved64, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_bitmask(ClearVFPortCounters_header_tree, tvb, local_offset,\r\nhf_opa_ClearVFPortCounters_CounterSelectMask, ett_clearvfportcounters_counterselectmask,\r\n_ClearVFPortCounters_CounterSelectMask, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nreturn local_offset;\r\n}\r\nstatic gint parse_GetVFFocusPorts(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD, RMPP_t *RMPP, PA_HEADER_t *PA_HEADER)\r\n{\r\nproto_tree *GetVFFocusPorts_header_tree;\r\nproto_item *GetVFFocusPorts_header_item;\r\nproto_tree *GetVFFocusPorts_Port_tree;\r\ngint local_offset = *offset;\r\nguint i;\r\nguint length = ((RMPP->resptime_flags & RMPP_FLAG_LAST_MASK) ? (RMPP->PayloadLength - 20) % STL_MAX_SA_PA_PAYLOAD : STL_MAX_SA_PA_PAYLOAD);\r\nguint records = (PA_HEADER->AttributeOffset ? length / (PA_HEADER->AttributeOffset * 8) : 0);\r\nif (!parentTree)\r\nreturn *offset;\r\nif (MAD->Method == METHOD_GET || MAD->Method == METHOD_GETTABLE) {\r\nGetVFFocusPorts_header_item = proto_tree_add_item(parentTree, hf_opa_GetVFFocusPorts, tvb, local_offset, 130, ENC_NA);\r\nGetVFFocusPorts_header_tree = proto_item_add_subtree(GetVFFocusPorts_header_item, ett_getvffocusports);\r\nproto_tree_add_item(GetVFFocusPorts_header_tree, hf_opa_GetVFFocusPorts_vfName, tvb, local_offset, 64, ENC_ASCII | ENC_NA);\r\nlocal_offset += 64;\r\nproto_tree_add_item(GetVFFocusPorts_header_tree, hf_opa_reserved64, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nlocal_offset = parse_Image(GetVFFocusPorts_header_tree, tvb, &local_offset);\r\nproto_tree_add_item(GetVFFocusPorts_header_tree, hf_opa_GetVFFocusPorts_select, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetVFFocusPorts_header_tree, hf_opa_GetVFFocusPorts_start, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetVFFocusPorts_header_tree, hf_opa_GetVFFocusPorts_range, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\n} else if (MAD->Method == METHOD_GET_RESP || MAD->Method == METHOD_GETTABLE_RESP) {\r\nGetVFFocusPorts_header_item = proto_tree_add_item(parentTree, hf_opa_GetVFFocusPorts, tvb, local_offset, records * PA_HEADER->AttributeOffset * 8, ENC_NA);\r\nGetVFFocusPorts_header_tree = proto_item_add_subtree(GetVFFocusPorts_header_item, ett_getvffocusports);\r\nfor (i = 0; i < records; i++) {\r\nGetVFFocusPorts_Port_tree = proto_tree_add_subtree_format(GetVFFocusPorts_header_tree,\r\ntvb, local_offset, PA_HEADER->AttributeOffset * 8, ett_getvffocusportsport, NULL,\r\n"%3u: LID: 0x%04x, Port: %u",\r\ni, tvb_get_ntohl(tvb, local_offset), tvb_get_guint8(tvb, local_offset + 4));\r\nproto_tree_add_item(GetVFFocusPorts_Port_tree, hf_opa_GetVFFocusPorts_nodeLID, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetVFFocusPorts_Port_tree, hf_opa_GetVFFocusPorts_portNumber, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(GetVFFocusPorts_Port_tree, hf_opa_GetVFFocusPorts_rate, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(GetVFFocusPorts_Port_tree, hf_opa_GetVFFocusPorts_mtu, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(GetVFFocusPorts_Port_tree, hf_opa_GetVFFocusPorts_localFlags, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(GetVFFocusPorts_Port_tree, hf_opa_GetVFFocusPorts_neighborFlags, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(GetVFFocusPorts_Port_tree, hf_opa_GetVFFocusPorts_value, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetVFFocusPorts_Port_tree, hf_opa_GetVFFocusPorts_nodeGUID, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetVFFocusPorts_Port_tree, hf_opa_GetVFFocusPorts_nodeDesc, tvb, local_offset, 64, ENC_ASCII | ENC_NA);\r\nlocal_offset += 64;\r\nproto_tree_add_item(GetVFFocusPorts_Port_tree, hf_opa_GetVFFocusPorts_neighborLid, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nproto_tree_add_item(GetVFFocusPorts_Port_tree, hf_opa_GetVFFocusPorts_neighborPortNumber, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(GetVFFocusPorts_Port_tree, hf_opa_reserved24, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_offset += 3;\r\nproto_tree_add_item(GetVFFocusPorts_Port_tree, hf_opa_GetVFFocusPorts_neighborValue, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetVFFocusPorts_Port_tree, hf_opa_GetVFFocusPorts_neighborGuid, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(GetVFFocusPorts_Port_tree, hf_opa_GetVFFocusPorts_neighborNodeDesc, tvb, local_offset, 64, ENC_ASCII | ENC_NA);\r\nlocal_offset += 64;\r\n}\r\n}\r\nreturn local_offset;\r\n}\r\nstatic gboolean parse_PA_Attribute(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_t *MAD, RMPP_t *RMPP, PA_HEADER_t *PA_HEADER)\r\n{\r\ngint local_offset = *offset;\r\nswitch (MAD->AttributeID) {\r\ncase PA_ATTR_ID_CLASS_PORTINFO:\r\nlocal_offset = parse_ClassPortInfo(parentTree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase PA_ATTR_ID_GET_GRP_LIST:\r\nlocal_offset = parse_GetGroupList(parentTree, tvb, &local_offset, MAD, RMPP, PA_HEADER);\r\nbreak;\r\ncase PA_ATTR_ID_GET_GRP_INFO:\r\nlocal_offset = parse_GetGroupInfo(parentTree, tvb, &local_offset, MAD, RMPP, PA_HEADER);\r\nbreak;\r\ncase PA_ATTR_ID_GET_GRP_CFG:\r\nlocal_offset = parse_GetGroupConfig(parentTree, tvb, &local_offset, MAD, RMPP, PA_HEADER);\r\nbreak;\r\ncase PA_ATTR_ID_GET_PORT_CTRS:\r\nlocal_offset = parse_GetPortCounters(parentTree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase PA_ATTR_ID_CLR_PORT_CTRS:\r\nlocal_offset = parse_ClearPortCounters(parentTree, tvb, &local_offset);\r\nbreak;\r\ncase PA_ATTR_ID_CLR_ALL_PORT_CTRS:\r\nlocal_offset = parse_ClearAllPortCounters(parentTree, tvb, &local_offset);\r\nbreak;\r\ncase PA_ATTR_ID_GET_PM_CFG:\r\nlocal_offset = parse_PMConfig(parentTree, tvb, &local_offset);\r\nbreak;\r\ncase PA_ATTR_ID_FREEZE_IMAGE:\r\nlocal_offset = parse_Image(parentTree, tvb, &local_offset);\r\nbreak;\r\ncase PA_ATTR_ID_RELEASE_IMAGE:\r\nlocal_offset = parse_Image(parentTree, tvb, &local_offset);\r\nbreak;\r\ncase PA_ATTR_ID_RENEW_IMAGE:\r\nlocal_offset = parse_Image(parentTree, tvb, &local_offset);\r\nbreak;\r\ncase PA_ATTR_ID_GET_FOCUS_PORTS:\r\nlocal_offset = parse_GetFocusPorts(parentTree, tvb, &local_offset, MAD, RMPP, PA_HEADER);\r\nbreak;\r\ncase PA_ATTR_ID_GET_IMAGE_INFO:\r\nlocal_offset = parse_GetImageInfo(parentTree, tvb, &local_offset);\r\nbreak;\r\ncase PA_ATTR_ID_MOVE_FREEZE_FRAME:\r\nlocal_offset = parse_MoveFreezeFrame(parentTree, tvb, &local_offset);\r\nbreak;\r\ncase PA_ATTR_ID_GET_VF_LIST:\r\nlocal_offset = parse_GetVFList(parentTree, tvb, &local_offset, MAD, RMPP, PA_HEADER);\r\nbreak;\r\ncase PA_ATTR_ID_GET_VF_INFO:\r\nlocal_offset = parse_GetVFInfo(parentTree, tvb, &local_offset, MAD, RMPP, PA_HEADER);\r\nbreak;\r\ncase PA_ATTR_ID_GET_VF_CONFIG:\r\nlocal_offset = parse_GetVFConfig(parentTree, tvb, &local_offset, MAD, RMPP, PA_HEADER);\r\nbreak;\r\ncase PA_ATTR_ID_GET_VF_PORT_CTRS:\r\nlocal_offset = parse_GetVFPortCounters(parentTree, tvb, &local_offset, MAD);\r\nbreak;\r\ncase PA_ATTR_ID_CLR_VF_PORT_CTRS:\r\nlocal_offset = parse_ClearVFPortCounters(parentTree, tvb, &local_offset);\r\nbreak;\r\ncase PA_ATTR_ID_GET_VF_FOCUS_PORTS:\r\nlocal_offset = parse_GetVFFocusPorts(parentTree, tvb, &local_offset, MAD, RMPP, PA_HEADER);\r\nbreak;\r\ndefault:\r\nreturn FALSE;\r\n}\r\n*offset = local_offset;\r\nreturn TRUE;\r\n}\r\nstatic void label_PA_Method(proto_item *PAItem, MAD_t *MAD, packet_info *pinfo)\r\n{\r\nconst guchar *label = val_to_str_const(MAD->Method, PA_Methods, "(Unknown Perf Method!)");\r\nproto_item_append_text(PAItem, " %s", label);\r\ncol_append_str(pinfo->cinfo, COL_INFO, label);\r\n}\r\nstatic void label_PA_Attribute(proto_item *PAItem, MAD_t *MAD, packet_info *pinfo)\r\n{\r\nconst guchar *label = val_to_str_const(MAD->AttributeID, PA_Attributes, "Attribute (Unknown Perf Attribute!)");\r\nproto_item_append_text(PAItem, "%s", &label[11]);\r\ncol_append_str(pinfo->cinfo, COL_INFO, &label[11]);\r\n}\r\nstatic gboolean parse_PA_HEADER(proto_tree *parentTree, packet_info *pinfo, tvbuff_t *tvb, gint *offset, MAD_t *MAD, PA_HEADER_t *PA_HEADER)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *PA_HEADER_header_item;\r\nproto_tree *PA_HEADER_header_tree;\r\nPA_HEADER_header_item = proto_tree_add_item(parentTree, hf_opa_pa, tvb, local_offset, 20, ENC_NA);\r\nPA_HEADER_header_tree = proto_item_add_subtree(PA_HEADER_header_item, ett_pa);\r\nPA_HEADER->SM_Key = tvb_get_ntoh64(tvb, local_offset);\r\nproto_tree_add_item(PA_HEADER_header_tree, hf_opa_pa_sm_key, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nPA_HEADER->AttributeOffset = tvb_get_ntohs(tvb, local_offset);\r\nproto_tree_add_item(PA_HEADER_header_tree, hf_opa_pa_attribute_offset, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nPA_HEADER->Reserved = tvb_get_ntohs(tvb, local_offset);\r\nproto_tree_add_item(PA_HEADER_header_tree, hf_opa_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nPA_HEADER->ComponentMask = tvb_get_ntoh64(tvb, local_offset);\r\nproto_tree_add_item(PA_HEADER_header_tree, hf_opa_pa_component_mask, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nlabel_PA_Method(PA_HEADER_header_item, MAD, pinfo);\r\nlabel_PA_Attribute(PA_HEADER_header_item, MAD, pinfo);\r\n*offset = local_offset;\r\nreturn TRUE;\r\n}\r\nstatic void parse_PERFADMN(proto_tree *parentTree, packet_info *pinfo, tvbuff_t *tvb, gint *offset)\r\n{\r\nMAD_t MAD;\r\nRMPP_t RMPP;\r\nPA_HEADER_t PA_HEADER;\r\nif (!parse_MAD_Common(parentTree, pinfo, tvb, offset, &MAD)) {\r\nreturn;\r\n}\r\nif (!parse_RMPP(parentTree, pinfo, tvb, offset, &RMPP)) {\r\nreturn;\r\n}\r\nif (!parse_PA_HEADER(parentTree, pinfo, tvb, offset, &MAD, &PA_HEADER)) {\r\nreturn;\r\n}\r\nif ((!pref_parse_on_mad_status_error && MAD.Status) ||\r\nRMPP.Type == RMPP_ACK ||\r\n(RMPP.Type == RMPP_DATA && RMPP.SegmentNumber != 1)) {\r\n*offset += tvb_captured_length_remaining(tvb, *offset);\r\nreturn;\r\n}\r\nif (!parse_PA_Attribute(parentTree, tvb, offset, &MAD, &RMPP, &PA_HEADER)) {\r\nexpert_add_info_format(pinfo, NULL, &ei_opa_mad_no_attribute_dissector,\r\n"Attribute Dissector Not Implemented (0x%x)", MAD.AttributeID);\r\n*offset += tvb_captured_length_remaining(tvb, *offset);\r\nreturn;\r\n}\r\n}\r\nstatic void parse_VENDOR_MANAGEMENT(proto_tree *parentTree, packet_info *pinfo, tvbuff_t *tvb, gint *offset)\r\n{\r\nMAD_t MAD;\r\nRMPP_t RMPP;\r\nif (!parse_MAD_Common(parentTree, pinfo, tvb, offset, &MAD)) {\r\nreturn;\r\n}\r\nif (value_is_in_range(global_mad_vendor_class, MAD.MgmtClass)) {\r\n} else if (value_is_in_range(global_mad_vendor_rmpp_class, MAD.MgmtClass)) {\r\nif (!parse_RMPP(parentTree, pinfo, tvb, offset, &RMPP)) {\r\nreturn;\r\n}\r\n}\r\nif (!pref_parse_on_mad_status_error && MAD.Status) {\r\n*offset += tvb_captured_length_remaining(tvb, *offset);\r\nreturn;\r\n}\r\nproto_tree_add_item(parentTree, hf_opa_vendor, tvb, *offset, -1, ENC_NA);\r\ncol_append_str(pinfo->cinfo, COL_INFO, "Vendor: (Dissector Not Implemented)");\r\nexpert_add_info_format(pinfo, NULL, &ei_opa_mad_no_attribute_dissector,\r\n"Attribute Dissector Not Implemented (0x%x)", MAD.AttributeID);\r\n*offset += tvb_captured_length_remaining(tvb, *offset);\r\nreturn;\r\n}\r\nstatic void parse_APPLICATION_MANAGEMENT(proto_tree *parentTree, packet_info *pinfo, tvbuff_t *tvb, gint *offset)\r\n{\r\nMAD_t MAD;\r\nif (!parse_MAD_Common(parentTree, pinfo, tvb, offset, &MAD)) {\r\nreturn;\r\n}\r\nif (!pref_parse_on_mad_status_error && MAD.Status) {\r\n*offset += tvb_captured_length_remaining(tvb, *offset);\r\nreturn;\r\n}\r\nproto_tree_add_item(parentTree, hf_opa_application, tvb, *offset, -1, ENC_NA);\r\ncol_append_str(pinfo->cinfo, COL_INFO, "Application: (Dissector Not Implemented)");\r\nexpert_add_info_format(pinfo, NULL, &ei_opa_mad_no_attribute_dissector,\r\n"Attribute Dissector Not Implemented (0x%x)", MAD.AttributeID);\r\n*offset += tvb_captured_length_remaining(tvb, *offset);\r\nreturn;\r\n}\r\nstatic void parse_RESERVED_MANAGEMENT(proto_tree *parentTree, packet_info *pinfo, tvbuff_t *tvb, gint *offset)\r\n{\r\nMAD_t MAD;\r\nif (!parse_MAD_Common(parentTree, pinfo, tvb, offset, &MAD)) {\r\nreturn;\r\n}\r\nif (!pref_parse_on_mad_status_error && MAD.Status) {\r\n*offset += tvb_captured_length_remaining(tvb, *offset);\r\nreturn;\r\n}\r\nproto_tree_add_item(parentTree, hf_opa_reservedmclass, tvb, *offset, -1, ENC_NA);\r\ncol_append_str(pinfo->cinfo, COL_INFO, "Reserved: (Dissector Not Implemented)");\r\nexpert_add_info_format(pinfo, NULL, &ei_opa_mad_no_attribute_dissector,\r\n"Attribute Dissector Not Implemented (0x%x)", MAD.AttributeID);\r\n*offset += tvb_captured_length_remaining(tvb, *offset);\r\nreturn;\r\n}\r\nstatic void parse_UNKNOWN_MANAGEMENT(proto_tree *parentTree, packet_info *pinfo, tvbuff_t *tvb, gint *offset)\r\n{\r\nMAD_t MAD;\r\nif (!parse_MAD_Common(parentTree, pinfo, tvb, offset, &MAD)) {\r\nreturn;\r\n}\r\nif (!pref_parse_on_mad_status_error && MAD.Status) {\r\n*offset += tvb_captured_length_remaining(tvb, *offset);\r\nreturn;\r\n}\r\nproto_tree_add_item(parentTree, hf_opa_unknown, tvb, *offset, -1, ENC_NA);\r\ncol_append_str(pinfo->cinfo, COL_INFO, "Unknown: (Dissector Not Implemented)");\r\nexpert_add_info_format(pinfo, NULL, &ei_opa_mad_no_attribute_dissector,\r\n"Attribute Dissector Not Implemented (0x%x)", MAD.AttributeID);\r\n*offset += tvb_captured_length_remaining(tvb, *offset);\r\nreturn;\r\n}\r\nstatic int dissect_opa_mad(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data _U_)\r\n{\r\ngint offset = 0;\r\nguint8 management_class;\r\nguint16 etype, reserved;\r\ndissector_handle_t dissector_found = NULL;\r\ngboolean parent_was_opa_fe = proto_is_frame_protocol(pinfo->layers, "opa.fe");\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "Omni-Path");\r\ncol_clear_fence(pinfo->cinfo, COL_INFO);\r\nif (pinfo->srcport == 0 || pinfo->srcport == 1 || pinfo->destport == 0\r\n|| pinfo->destport == 1 || parent_was_opa_fe) {\r\nmanagement_class = tvb_get_guint8(tvb, offset + 1);\r\nif (value_is_in_range(global_mad_vendor_class, management_class) ||\r\nvalue_is_in_range(global_mad_vendor_rmpp_class, management_class)) {\r\nparse_VENDOR_MANAGEMENT(tree, pinfo, tvb, &offset);\r\n} else if (value_is_in_range(global_mad_application_class, management_class)) {\r\nparse_APPLICATION_MANAGEMENT(tree, pinfo, tvb, &offset);\r\n} else if (value_is_in_range(global_mad_reserved_class, management_class)) {\r\nparse_RESERVED_MANAGEMENT(tree, pinfo, tvb, &offset);\r\n} else if (value_is_in_range(global_mad_opa_class, management_class)) {\r\nswitch (management_class) {\r\ncase SUBN_LID_ROUTED:\r\nparse_SUBN_LID_ROUTED(tree, pinfo, tvb, &offset);\r\nbreak;\r\ncase SUBN_DIRECTED_ROUTE:\r\nparse_SUBN_DIRECTED_ROUTE(tree, pinfo, tvb, &offset);\r\nbreak;\r\ncase SUBNADMN:\r\nparse_SUBNADMN(tree, pinfo, tvb, &offset);\r\nbreak;\r\ncase PERFADMN:\r\nparse_PERFADMN(tree, pinfo, tvb, &offset);\r\nbreak;\r\ncase PERF:\r\nparse_PERF(tree, pinfo, tvb, &offset);\r\nbreak;\r\ndefault:\r\nparse_UNKNOWN_MANAGEMENT(tree, pinfo, tvb, &offset);\r\nbreak;\r\n}\r\n} else {\r\nparse_UNKNOWN_MANAGEMENT(tree, pinfo, tvb, &offset);\r\n}\r\n} else {\r\netype = tvb_get_ntohs(tvb, offset);\r\nreserved = tvb_get_ntohs(tvb, offset + 2);\r\ndissector_found = dissector_get_uint_handle(ethertype_dissector_table, etype);\r\nif (dissector_found != NULL && (reserved == 0)) {\r\nproto_tree_add_item(tree, hf_opa_etype, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_opa_etype_reserved16, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\ncall_dissector(dissector_found, tvb_new_subset_remaining(tvb, offset), pinfo, tree);\r\n}\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid proto_register_opa_mad(void)\r\n{\r\nmodule_t *opa_mad_module;\r\nexpert_module_t *expert_opa_mad;\r\nstatic hf_register_info hf[] = {\r\n{ &hf_opa_reserved64, {\r\n"Reserved (64 bits)", "opa.reserved64",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_reserved32, {\r\n"Reserved (32 bits)", "opa.reserved",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_reserved24, {\r\n"Reserved (24 bits)", "opa.reserved",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_reserved16, {\r\n"Reserved (16 bits)", "opa.reserved",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_reserved8, {\r\n"Reserved (8 bits)", "opa.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_etype, {\r\n"Ethertype", "opa.etype",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_etype_reserved16, {\r\n"Reserved (16 bits)", "opa.etype.reserved",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sm_lid, {\r\n"Subnet Management (LID Routed)", "opa.sm.lid",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sm_m_key, {\r\n"M_Key", "opa.sm.lid.mkey",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sm_dr, {\r\n"Subnet Management (Directed Route)", "opa.sm.dr",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sm_dr_slid, {\r\n"DrSLID", "opa.sm.dr.slid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sm_dr_dlid, {\r\n"DrDLID", "opa.sm.dr.dlid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sm_dr_initial_path, {\r\n"Initial Path", "opa.sm.dr.initialpath",\r\nFT_BYTES, SEP_SPACE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sm_dr_return_path, {\r\n"Return Path", "opa.sm.dr.returnpath",\r\nFT_BYTES, SEP_SPACE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sm_dr_reserved64, {\r\n"Reserved (64 bits)", "opa.sm.dr.reserved",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sa, {\r\n"Subnet Administration Header", "opa.sa",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sa_sm_key, {\r\n"SM_Key (Verification Key)", "opa.sa.smkey",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sa_attribute_offset, {\r\n"Attribute Offset", "opa.sa.attributeoffset",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sa_component_mask, {\r\n"Component Mask", "opa.sa.componentmask",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_pm, {\r\n"Performance Management", "opa.pm",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_pa, {\r\n"Performance Administration Header", "opa.pa",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_pa_sm_key, {\r\n"SM_Key (Verification Key)", "opa.pa.smkey",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_pa_attribute_offset, {\r\n"Attribute Offset", "opa.pa.attributeoffset",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_pa_component_mask, {\r\n"Component Mask", "opa.pa.componentmask",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_vendor, {\r\n"Vendor MAD Header", "opa.vendor",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_application, {\r\n"Application MAD Header", "opa.application",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_reservedmclass, {\r\n"Reserved MAD Header", "opa.reservedmclass",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_unknown, {\r\n"Unknown MAD Header", "opa.unknown",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_mad, {\r\n"MAD Header - Common Management Datagram", "opa.mad.header",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_mad_base_version, {\r\n"Base Version", "opa.mad.baseversion",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_mad_mgmt_class, {\r\n"Management Class", "opa.mad.mgmtclass",\r\nFT_UINT8, BASE_HEX | BASE_EXT_STRING, &MAD_mgmt_names_ext, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_mad_class_version, {\r\n"Class Version", "opa.mad.classversion",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_mad_method, {\r\n"Method", "opa.mad.method",\r\nFT_UINT8, BASE_HEX, VALS(Methods), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_mad_status, {\r\n"Status", "opa.mad.status",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_mad_status_DR_D, {\r\n"Direction", "opa.mad.dr.direction",\r\nFT_UINT16, BASE_HEX, NULL, 0x8000, NULL, HFILL }\r\n},\r\n{ &hf_opa_mad_status_DR_status, {\r\n"Status", "opa.mad.status",\r\nFT_UINT16, BASE_HEX, NULL, 0x7FFF, NULL, HFILL }\r\n},\r\n{ &hf_opa_mad_status_DR_Hop_Pointer, {\r\n"Hop Pointer", "opa.mad.dr.hoppointer",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_mad_status_DR_Hop_Count, {\r\n"Hop Counter", "opa.mad.dr.hopcounter",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_mad_status_NM_ClassSpecific, {\r\n"Class Specific", "opa.mad.status.classspecific",\r\nFT_UINT16, BASE_HEX, NULL, 0xFF00, NULL, HFILL }\r\n},\r\n{ &hf_opa_mad_status_NM_reserved1, {\r\n"Reserved (3 Bits)", "opa.mad.status.reserved",\r\nFT_UINT16, BASE_HEX, NULL, 0x00E0, NULL, HFILL }\r\n},\r\n{ &hf_opa_mad_status_NM_InvalidField, {\r\n"Invalid Field", "opa.mad.status.invalidfield",\r\nFT_UINT16, BASE_HEX, VALS(MAD_Status_InvalidField), 0x001C, NULL, HFILL }\r\n},\r\n{ &hf_opa_mad_status_NM_RedirectRqrd, {\r\n"Redirect Required", "opa.mad.status.redirectrqrd",\r\nFT_BOOLEAN, 16, TFS(&tfs_redirect_no_redirect), 0x0002, NULL, HFILL }\r\n},\r\n{ &hf_opa_mad_status_NM_Busy, {\r\n"Busy", "opa.mad.status.busy",\r\nFT_BOOLEAN, 16, TFS(&tfs_busy_not_busy), 0x0001, NULL, HFILL }\r\n},\r\n{ &hf_opa_mad_transaction_id, {\r\n"Transaction ID", "opa.mad.transactionid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_mad_attribute_id, {\r\n"Attribute ID", "opa.mad.attributeid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_attribute_modifier, {\r\n"Attribute Modifier", "opa.mad.attributemodifier",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_attribute_modifier_A, {\r\n"All", "opa.mad.attributemodifier.a",\r\nFT_BOOLEAN, 32, NULL, 0x00000100, NULL, HFILL }\r\n},\r\n{ &hf_opa_attribute_modifier_A2, {\r\n"All Ingress Ports", "opa.mad.attributemodifier.a2",\r\nFT_BOOLEAN, 32, NULL, 0x00020000, NULL, HFILL }\r\n},\r\n{ &hf_opa_attribute_modifier_A3, {\r\n"All", "opa.mad.attributemodifier.a3",\r\nFT_BOOLEAN, 32, NULL, 0x00040000, NULL, HFILL }\r\n},\r\n{ &hf_opa_attribute_modifier_A4, {\r\n"All", "opa.mad.attributemodifier.a4",\r\nFT_BOOLEAN, 32, NULL, 0x00100000, NULL, HFILL }\r\n},\r\n{ &hf_opa_attribute_modifier_A5, {\r\n"Starting Address", "opa.mad.attributemodifier.a5",\r\nFT_UINT32, BASE_HEX, NULL, 0x7FF80000, NULL, HFILL }\r\n},\r\n{ &hf_opa_attribute_modifier_A6, {\r\n"All", "opa.mad.attributemodifier.a6",\r\nFT_BOOLEAN, 32, NULL, 0x00000020, NULL, HFILL }\r\n},\r\n{ &hf_opa_attribute_modifier_B, {\r\n"Block Number", "opa.mad.attributemodifier.b",\r\nFT_UINT32, BASE_DEC, NULL, 0x000007FF, NULL, HFILL }\r\n},\r\n{ &hf_opa_attribute_modifier_B2, {\r\n"All Egress Ports", "opa.mad.attributemodifier.b2",\r\nFT_BOOLEAN, 32, NULL, 0x00010000, NULL, HFILL }\r\n},\r\n{ &hf_opa_attribute_modifier_B3, {\r\n"Block Number", "opa.mad.attributemodifier.b3",\r\nFT_UINT32, BASE_DEC, NULL, 0x0003FFFF, NULL, HFILL }\r\n},\r\n{ &hf_opa_attribute_modifier_B4, {\r\n"Block Number", "opa.mad.attributemodifier.b4",\r\nFT_UINT32, BASE_DEC, NULL, 0x000FFFFF, NULL, HFILL }\r\n},\r\n{ &hf_opa_attribute_modifier_B5, {\r\n"Block Number", "opa.mad.attributemodifier.b5",\r\nFT_UINT32, BASE_DEC, NULL, 0x0000001F, NULL, HFILL }\r\n},\r\n{ &hf_opa_attribute_modifier_E, {\r\n"Egress Ports", "opa.mad.attributemodifier.e",\r\nFT_UINT32, BASE_DEC, NULL, 0x000000FF, NULL, HFILL }\r\n},\r\n{ &hf_opa_attribute_modifier_I, {\r\n"Ingress Ports", "opa.mad.attributemodifier.i",\r\nFT_UINT32, BASE_DEC, NULL, 0x0000FF00, NULL, HFILL }\r\n},\r\n{ &hf_opa_attribute_modifier_L, {\r\n"Length", "opa.mad.attributemodifier.l",\r\nFT_UINT32, BASE_DEC, NULL, 0x0007E000, NULL, HFILL }\r\n},\r\n{ &hf_opa_attribute_modifier_NP, {\r\n"Number of Ports", "opa.mad.attributemodifier.n",\r\nFT_UINT32, BASE_DEC, NULL, 0xFF000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_attribute_modifier_NB, {\r\n"Number of Blocks", "opa.mad.attributemodifier.n",\r\nFT_UINT32, BASE_DEC, NULL, 0xFF000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_attribute_modifier_N2, {\r\n"Number of aggregated Attributes", "opa.mad.attributemodifier.n",\r\nFT_UINT32, BASE_DEC, NULL, 0x000000FF, NULL, HFILL }\r\n},\r\n{ &hf_opa_attribute_modifier_P, {\r\n"Port Number", "opa.mad.attributemodifier.p",\r\nFT_UINT32, BASE_DEC, NULL, 0x000000FF, NULL, HFILL }\r\n},\r\n{ &hf_opa_attribute_modifier_P2, {\r\n"Port Number", "opa.mad.attributemodifier.p",\r\nFT_UINT32, BASE_DEC, NULL, 0x00FF0000, NULL, HFILL }\r\n},\r\n{ &hf_opa_attribute_modifier_P3, {\r\n"Position", "opa.mad.attributemodifier.p",\r\nFT_UINT32, BASE_DEC, NULL, 0x00C00000, NULL, HFILL }\r\n},\r\n{ &hf_opa_attribute_modifier_S, {\r\n"Section of Table", "opa.mad.attributemodifier.s",\r\nFT_UINT32, BASE_DEC, VALS(MADAttrModSectionVLarb), 0x00FF0000, NULL, HFILL }\r\n},\r\n{ &hf_opa_attribute_modifier_S2, {\r\n"Start of SM Configuration", "opa.mad.attributemodifier.s2",\r\nFT_BOOLEAN, 32, NULL, 0x00000200, NULL, HFILL }\r\n},\r\n{ &hf_opa_attribute_modifier_Y, {\r\n"Asynchronous update", "opa.mad.attributemodifier.y",\r\nFT_BOOLEAN, 32, NULL, 0x00001000, NULL, HFILL }\r\n},\r\n{ &hf_opa_rmpp, {\r\n"RMPP - Reliable Multi-Packet Transaction Protocol", "opa.rmpp",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_rmpp_version, {\r\n"RMPP Version", "opa.rmpp.rmppversion",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_rmpp_type, {\r\n"RMPP Type", "opa.rmpp.rmpptype",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_rmpp_r_resp_time, {\r\n"R Resp Time", "opa.rmpp.rresptime",\r\nFT_UINT8, BASE_HEX, NULL, 0xF8, NULL, HFILL }\r\n},\r\n{ &hf_opa_rmpp_flags_last, {\r\n"Last", "opa.rmpp.flags.last",\r\nFT_BOOLEAN, 8, NULL, 0x04, NULL, HFILL }\r\n},\r\n{ &hf_opa_rmpp_flags_first, {\r\n"First", "opa.rmpp.flags.first",\r\nFT_BOOLEAN, 8, NULL, 0x02, NULL, HFILL }\r\n},\r\n{ &hf_opa_rmpp_flags_active, {\r\n"Active", "opa.rmpp.flags.active",\r\nFT_BOOLEAN, 8, NULL, 0x01, NULL, HFILL }\r\n},\r\n{ &hf_opa_rmpp_status, {\r\n"RMPP Status", "opa.rmpp.rmppstatus",\r\nFT_UINT8, BASE_HEX, VALS(RMPP_Status), 0xFF, NULL, HFILL }\r\n},\r\n{ &hf_opa_rmpp_data1, {\r\n"RMPP Data 1", "opa.rmpp.data1",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_rmpp_data2, {\r\n"RMPP Data 2", "opa.rmpp.data2",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_rmpp_segment_number, {\r\n"Segment Number", "opa.rmpp.segmentnumber",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_rmpp_payload_length32, {\r\n"Payload Length", "opa.rmpp.payloadlength",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_rmpp_new_window_last, {\r\n"New Window Last", "opa.rmpp.newwindowlast",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sa_Lid, {\r\n"LID", "opa.sa.lid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sa_Port, {\r\n"Port", "opa.sa.port",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sa_EndportLID, {\r\n"EndportLID", "opa.sa.endportlid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sa_PortNum, {\r\n"PortNum", "opa.sa.portnum",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sa_InputPortNum, {\r\n"InputPortNum", "opa.sa.inputportnum",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sa_OutputPortNum, {\r\n"OutputPortNum", "opa.sa.outputportnum",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sa_reserved14, {\r\n"Reserved (14 bits)", "opa.sa.reserved",\r\nFT_UINT32, BASE_HEX, NULL, 0xFFFC0000, NULL, HFILL }\r\n},\r\n{ &hf_opa_sa_BlockNum_18b, {\r\n"BlockNum", "opa.sa.blocknum",\r\nFT_UINT32, BASE_HEX, NULL, 0x0003FFFF, NULL, HFILL }\r\n},\r\n{ &hf_opa_sa_Position, {\r\n"Position", "opa.sa.position",\r\nFT_UINT32, BASE_HEX, NULL, 0xC0000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_sa_reserved9, {\r\n"Reserved (9 bits)", "opa.sa.reserved",\r\nFT_UINT32, BASE_HEX, NULL, 0x3FE00000, NULL, HFILL }\r\n},\r\n{ &hf_opa_sa_BlockNum_21b, {\r\n"BlockNum", "opa.sa.blocknum",\r\nFT_UINT32, BASE_HEX, NULL, 0x001FFFFF, NULL, HFILL }\r\n},\r\n{ &hf_opa_sa_BlockNum_8b, {\r\n"BlockNum", "opa.sa.blocknum",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sa_BlockNum_16b, {\r\n"BlockNum", "opa.sa.blocknum",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sa_SubscriberLID, {\r\n"SubscriberGID", "opa.sa.subscribergid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sa_Enum, {\r\n"Enum", "opa.sa.enum",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sa_FromLID, {\r\n"FromLID", "opa.sa.fromlid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sa_FromPort, {\r\n"FromPort", "opa.sa.fromport",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sa_ServiceID, {\r\n"ServiceID", "opa.sa.serviceid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sa_ServiceLID, {\r\n"ServiceLID", "opa.sa.servicelid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sa_ServiceP_Key, {\r\n"ServiceP_Key", "opa.sa.servicep_key",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sa_ServiceGID, {\r\n"ServiceGID", "opa.sa.servicegid",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sa_MGID, {\r\n"MGID", "opa.sa.mgid",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_sa_PortGID, {\r\n"PortGID", "opa.sa.portgid",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Notice, {\r\n"Notice", "opa.notice",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Notice_IsGeneric, {\r\n"IsGeneric", "opa.notice.isgeneric",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL }\r\n},\r\n{ &hf_opa_Notice_Type, {\r\n"Type", "opa.notice.type",\r\nFT_UINT8, BASE_HEX, VALS(NoticeType), 0x7F, NULL, HFILL }\r\n},\r\n{ &hf_opa_Notice_ProducerType, {\r\n"ProducerType", "opa.notice.producertype",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Notice_TrapNumber, {\r\n"TrapNumber", "opa.notice.trapnumber",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Notice_VendorID, {\r\n"VendorID", "opa.notice.vendorid",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Notice_DeviceID, {\r\n"DeviceID", "opa.notice.deviceid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Notice_Toggle, {\r\n"Toggle", "opa.notice.toggle",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL }\r\n},\r\n{ &hf_opa_Notice_Count, {\r\n"Count", "opa.notice.count",\r\nFT_UINT16, BASE_HEX, NULL, 0x7FFF, NULL, HFILL }\r\n},\r\n{ &hf_opa_Notice_IssuerLID, {\r\n"IssuerLID", "opa.notice.issuerlid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Notice_IssuerGID, {\r\n"IssuerGID", "opa.notice.issuergid",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Notice_ClassDataDetails, {\r\n"ClassDataDetails", "opa.notice.classdatadetails",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap, {\r\n"Trap", "opa.trap",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_GID, {\r\n"GID", "opa.trap.gid",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_LID, {\r\n"LIDADDR", "opa.trap.lidaddr",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_PORTNO, {\r\n"PORTNO", "opa.trap.portno",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_CAPABILITYMASK, {\r\n"CapabilityMask", "opa.trap.capabilitymask",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_CAPABILITYMASK3, {\r\n"CapabilityMask3", "opa.trap.capabilitymask3",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_144_reserved, {\r\n"Reserved (4 bits)", "opa.trap.144.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0xF0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_LinkWidthDowngradeEnabledChange, {\r\n"LinkWidthDowngradeEnabledChange", "opa.trap.linkwidthdowngradeenabledchange",\r\nFT_BOOLEAN, 8, NULL, 0x08, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_LinkSpeecEnabledChange, {\r\n"LinkSpeecEnabledChange", "opa.trap.linkspeecenabledchange",\r\nFT_BOOLEAN, 8, NULL, 0x04, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_LinkWidthEnabledChange, {\r\n"LinkWidthEnabledChange", "opa.trap.linkwidthenabledchange",\r\nFT_BOOLEAN, 8, NULL, 0x02, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_NodeDescriptionChange, {\r\n"NodeDescriptionChange", "opa.trap.nodedescriptionchange",\r\nFT_BOOLEAN, 8, NULL, 0x01, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_SystemImageGUID, {\r\n"SystemImageGUID", "opa.trap.systemimageguid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_DRSLID, {\r\n"DR SLID", "opa.trap.drslid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_Method, {\r\n"Method", "opa.trap.method",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_AttributeID, {\r\n"AttributeID", "opa.trap.attributeid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_AttributeModifier, {\r\n"AttributeModifier", "opa.trap.attributemodifier",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_MKey, {\r\n"MKey", "opa.trap.mkey",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_DRNotice, {\r\n"DRNotice", "opa.trap.drnotice",\r\nFT_BOOLEAN, 8, NULL, 0x80, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_DRPathTruncated, {\r\n"DRPathTruncated", "opa.trap.drpathtruncated",\r\nFT_BOOLEAN, 8, NULL, 0x40, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_DRHopCount, {\r\n"DRHopCount", "opa.trap.drhopcount",\r\nFT_UINT8, BASE_HEX, NULL, 0x3F, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_DRNoticeReturnPath, {\r\n"DRNoticeReturnPath", "opa.trap.drnoticereturnpath",\r\nFT_BYTES, SEP_SPACE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_Key, {\r\n"Key", "opa.trap.key",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_SL, {\r\n"SL", "opa.trap.sl",\r\nFT_UINT8, BASE_HEX, NULL, 0xF8, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_SL_reserved, {\r\n"Reserved (3 bits)", "opa.trap.sl.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x07, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_QP, {\r\n"QP", "opa.trap.qp",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_DataValid, {\r\n"DataValid", "opa.trap.datavalid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_DataValid_Lid1, {\r\n"Lid1", "opa.trap.datavalid.lid1",\r\nFT_BOOLEAN, 16, TFS(&tfs_valid_invalid), 0x8000, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_DataValid_Lid2, {\r\n"Lid2", "opa.trap.datavalid.lid2",\r\nFT_BOOLEAN, 16, TFS(&tfs_valid_invalid), 0x4000, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_DataValid_PKey, {\r\n"PKey", "opa.trap.datavalid.pkey",\r\nFT_BOOLEAN, 16, TFS(&tfs_valid_invalid), 0x2000, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_DataValid_SL, {\r\n"SL", "opa.trap.datavalid.sl",\r\nFT_BOOLEAN, 16, TFS(&tfs_valid_invalid), 0x1000, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_DataValid_QP1, {\r\n"QP1", "opa.trap.datavalid.qp1",\r\nFT_BOOLEAN, 16, TFS(&tfs_valid_invalid), 0x0800, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_DataValid_QP2, {\r\n"QP2", "opa.trap.datavalid.qp2",\r\nFT_BOOLEAN, 16, TFS(&tfs_valid_invalid), 0x0400, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_DataValid_Gid1, {\r\n"Gid1", "opa.trap.datavalid.gid1",\r\nFT_BOOLEAN, 16, TFS(&tfs_valid_invalid), 0x0200, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_DataValid_Gid2, {\r\n"Gid2", "opa.trap.datavalid.gid2",\r\nFT_BOOLEAN, 16, TFS(&tfs_valid_invalid), 0x01000, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_DataValid_Reserved, {\r\n"DataValid", "opa.trap.datavalid.reserved",\r\nFT_UINT16, BASE_HEX, NULL, 0x00FF, NULL, HFILL }\r\n},\r\n{ &hf_opa_Trap_PKey, {\r\n"PKey", "opa.trap.pkey",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClassPortInfo, {\r\n"ClassPortInfo", "opa.classportinfo",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClassPortInfo_BaseVersion, {\r\n"BaseVersion", "opa.clasportinfo.baseversion",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClassPortInfo_ClassVersion, {\r\n"ClassVersion", "opa.clasportinfo.classversion",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClassPortInfo_CapMask, {\r\n"CapMask", "opa.clasportinfo.capmask",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClassPortInfo_CapMask2, {\r\n"CapMask2", "opa.clasportinfo.capmask2",\r\nFT_UINT32, BASE_HEX, NULL, 0xFFFFFFE0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClassPortInfo_RespTimeValue, {\r\n"RespTimeValue", "opa.clasportinfo.resptimevalue",\r\nFT_UINT32, BASE_HEX, NULL, 0x0000001F, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClassPortInfo_Redirect_GID, {\r\n"GID", "opa.clasportinfo.redirect.gid",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClassPortInfo_Redirect_TClass, {\r\n"TClass", "opa.clasportinfo.redirect.tclass",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClassPortInfo_Redirect_reserved, {\r\n"Reserved (4 bits)", "opa.clasportinfo.redirect.reserved",\r\nFT_UINT24, BASE_HEX, NULL, 0xF00000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClassPortInfo_Redirect_FlowLabel, {\r\n"FlowLabel", "opa.clasportinfo.redirect.flowlabel",\r\nFT_UINT24, BASE_HEX, NULL, 0x0FFFFF, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClassPortInfo_Redirect_LID, {\r\n"LID", "opa.clasportinfo.redirect.lid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClassPortInfo_Redirect_SL, {\r\n"SL", "opa.clasportinfo.redirect.sl",\r\nFT_UINT8, BASE_HEX, NULL, 0xF8, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClassPortInfo_Redirect_reserved2, {\r\n"Reserved (3 bits)", "opa.clasportinfo.redirect.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x07, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClassPortInfo_Redirect_QP, {\r\n"QP", "opa.clasportinfo.redirect.qp",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClassPortInfo_Redirect_Q_Key, {\r\n"Q_Key", "opa.clasportinfo.redirect.q_key",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClassPortInfo_Trap_GID, {\r\n"GID", "opa.clasportinfo.trap.gid",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClassPortInfo_Trap_TClass, {\r\n"TClass", "opa.clasportinfo.trap.tclass",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClassPortInfo_Trap_reserved, {\r\n"Reserved (4 bits)", "opa.clasportinfo.trap.reserved",\r\nFT_UINT24, BASE_HEX, NULL, 0xF00000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClassPortInfo_Trap_FlowLabel, {\r\n"FlowLabel", "opa.clasportinfo.trap.flowlabel",\r\nFT_UINT24, BASE_HEX, NULL, 0x0FFFFF, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClassPortInfo_Trap_LID, {\r\n"LID", "opa.clasportinfo.trap.lid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClassPortInfo_Trap_HopLimit, {\r\n"HopLimit", "opa.clasportinfo.trap.hoplimit",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClassPortInfo_Trap_QP, {\r\n"QP", "opa.clasportinfo.trap.qp",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClassPortInfo_Trap_Q_Key, {\r\n"Q_Key", "opa.clasportinfo.trap.q_key",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClassPortInfo_Trap_P_Key, {\r\n"P_Key", "opa.clasportinfo.trap.p_key",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClassPortInfo_Redirect_P_Key, {\r\n"P_Key", "opa.clasportinfo.redirect.p_key",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClassPortInfo_Trap_SL, {\r\n"SL", "opa.clasportinfo.trap.sl",\r\nFT_UINT8, BASE_HEX, NULL, 0xF8, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClassPortInfo_Trap_reserved2, {\r\n"Reserved (3 bits)", "opa.clasportinfo.trap.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x07, NULL, HFILL }\r\n},\r\n{ &hf_opa_NodeDescription, {\r\n"NodeDescription", "opa.nodedescription",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_NodeDescription_NodeString, {\r\n"NodeString", "opa.nodedescription.nodestring",\r\nFT_STRING, STR_ASCII, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_NodeInfo, {\r\n"Node Info", "opa.nodeinfo",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_NodeInfo_BaseVersion, {\r\n"Base Version", "opa.nodeinfo.baseversion",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_NodeInfo_ClassVersion, {\r\n"Class Version", "opa.nodeinfo.classversion",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_NodeInfo_NodeType, {\r\n"Node Type", "opa.nodeinfo.nodetype",\r\nFT_UINT8, BASE_HEX, VALS(NodeType), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_NodeInfo_NumPorts, {\r\n"Num Ports", "opa.nodeinfo.numports",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_NodeInfo_SystemImageGUID, {\r\n"System Image GUID", "opa.nodeinfo.systemimageguid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_NodeInfo_NodeGUID, {\r\n"Node GUID", "opa.nodeinfo.nodeguid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_NodeInfo_PortGUID, {\r\n"Port GUID", "opa.nodeinfo.portguid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_NodeInfo_PartitionCap, {\r\n"Partition Cap", "opa.nodeinfo.partitioncap",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_NodeInfo_DeviceID, {\r\n"Device ID", "opa.nodeinfo.deviceid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_NodeInfo_Revision, {\r\n"Revision", "opa.nodeinfo.revision",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_NodeInfo_LocalPortNum, {\r\n"Local Port Num", "opa.nodeinfo.localportnum",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_NodeInfo_VendorID, {\r\n"Vendor ID", "opa.nodeinfo.vendorid",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo, {\r\n"Switch Info", "opa.switchinfo",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_LinearFDBCap, {\r\n"Linear FDB Cap", "opa.switchinfo.linearfdbcap",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_MulticastFDBCap, {\r\n"Multicast FDB Cap", "opa.switchinfo.multicastfdbcap",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_LinearFDBTop, {\r\n"Linear FDB Top", "opa.switchinfo.linearfdbtop",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_MulticastFDBTop, {\r\n"Multicast FDB Top", "opa.switchinfo.multicastfdbtop",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_CollectiveCap, {\r\n"Collective Cap", "opa.switchinfo.collectivecap",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_CollectiveTop, {\r\n"Collective Top", "opa.switchinfo.collectivetop",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_IPAddrIPv6, {\r\n"IP Addr IPv6", "opa.switchinfo.ipaddripv6",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_IPAddrIPv4, {\r\n"IP Addr IPv4", "opa.switchinfo.ipaddripv4",\r\nFT_IPv4, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_LifeTimeValue, {\r\n"Life Time Value", "opa.switchinfo.lifetimevalue",\r\nFT_UINT8, BASE_HEX, NULL, 0xF8, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_PortStateChange, {\r\n"Port State Change", "opa.switchinfo.portstatechange",\r\nFT_BOOLEAN, 8, NULL, 0x04, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_reserved2, {\r\n"Reserved (2 bits)", "opa.switchinfo.reserved2",\r\nFT_UINT8, BASE_HEX, NULL, 0x03, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_PartitionEnforcementCap, {\r\n"Partition Enforcement Cap", "opa.switchinfo.partitionenforcementcap",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_PortGroupCap, {\r\n"Port Group Cap", "opa.switchinfo.portgroupcap",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_PortGroupTop, {\r\n"Port Group Top", "opa.switchinfo.portgrouptop",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_SupportedRoutingMode, {\r\n"Supported Routing Mode", "opa.switchinfo.supportedroutingmode",\r\nFT_UINT8, BASE_HEX, VALS(RoutingMode), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_EnabledRoutingMode, {\r\n"Enabled Routing Mode", "opa.switchinfo.enabledroutingmode",\r\nFT_UINT8, BASE_HEX, VALS(RoutingMode), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_reserved3, {\r\n"Reserved (4 bits)", "opa.switchinfo.reserved3",\r\nFT_UINT8, BASE_HEX, NULL, 0xF0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_EnhancedPortZero, {\r\n"Enhanced Port Zero", "opa.switchinfo.enhancedportzero",\r\nFT_BOOLEAN, 8, NULL, 0x08, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_reserved4, {\r\n"Reserved (3 bits)", "opa.switchinfo.reserved4",\r\nFT_UINT8, BASE_HEX, NULL, 0x07, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_reserved5, {\r\n"Reserved (2 bits)", "opa.switchinfo.reserved5",\r\nFT_UINT8, BASE_HEX, NULL, 0xC0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_CollectiveMask, {\r\n"Collective Mask", "opa.switchinfo.collectivemask",\r\nFT_UINT8, BASE_HEX, NULL, 0x38, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_MulticastMask, {\r\n"Multicast Mask", "opa.switchinfo.multicastmask",\r\nFT_UINT8, BASE_HEX, NULL, 0x07, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_AdaptiveRoutingEnable, {\r\n"Adaptive Routing Enable", "opa.switchinfo.adaptiveroutingenable",\r\nFT_BOOLEAN, 16, NULL, 0x8000, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_AdaptiveRoutingPause, {\r\n"Adaptive Routing Pause", "opa.switchinfo.adaptiveroutingpause",\r\nFT_BOOLEAN, 16, NULL, 0x4000, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_AdaptiveRoutingAlgorithm, {\r\n"Adaptive Routing Algorithm", "opa.switchinfo.adaptiveroutingalgorithm",\r\nFT_UINT16, BASE_HEX, VALS(AdaptiveRoutingAlgorithm), 0x3800, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_AdaptiveRoutingFrequency, {\r\n"Adaptive Routing Frequency", "opa.switchinfo.adaptiveroutingfrequency",\r\nFT_UINT16, BASE_CUSTOM, CF_FUNC(cf_opa_mad_swinfo_ar_frequency), 0x0700, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_AdaptiveRoutingLostRoutesOnly, {\r\n"Adaptive Routing Lost Routes Only", "opa.switchinfo.adaptiveroutinglostroutesonly",\r\nFT_BOOLEAN, 16, NULL, 0x0080, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_AdaptiveRoutingThreshold, {\r\n"Adaptive Routing Threshold", "opa.switchinfo.adaptiveroutingthreshold",\r\nFT_UINT16, BASE_HEX, VALS(AdaptiveRoutingThreshold), 0x0070, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_reserved6, {\r\n"Reserved (4 bits)", "opa.switchinfo.reserved6",\r\nFT_UINT16, BASE_HEX, NULL, 0x000F, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_SwitchCapabilityMask, {\r\n"Switch Capability Mask", "opa.switchinfo.switchcapabilitymask",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_SwitchCapabilityMask_reserved, {\r\n"Reserved (13 bits)", "opa.switchinfo.switchcapabilitymask.reserved",\r\nFT_UINT16, BASE_HEX, NULL, 0xFFF8, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_SwitchCapabilityMask_IsAddrRangeConfigSupported, {\r\n"IsAddrRangeConfigSupported", "opa.switchinfo.switchcapabilitymask.isaddrrangeconfigsupported",\r\nFT_BOOLEAN, 16, NULL, 0x0004, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_SwitchCapabilityMask_reserved2, {\r\n"Reserved (1 bit)", "opa.switchinfo.switchcapabilitymask.reserved",\r\nFT_UINT16, BASE_HEX, NULL, 0x0002, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_SwitchCapabilityMask_IsAdaptiveRoutingSupported, {\r\n"IsAdaptiveRoutingSupported", "opa.switchinfo.switchcapabilitymask.isadaptiveroutingsupported",\r\nFT_BOOLEAN, 16, NULL, 0x0001, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchInfo_CapabilityMaskCollectives, {\r\n"Capability Mask Collectives", "opa.switchinfo.capabilitymaskcollectives",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo, {\r\n"Port Info", "opa.portinfo",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_LID, {\r\n"LID", "opa.portinfo.lid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, "Base LID of this node", HFILL }\r\n},\r\n{ &hf_opa_PortInfo_FlowControlMask, {\r\n"Flow Control Mask", "opa.portinfo.flowcontrolmask",\r\nFT_UINT32, BASE_CUSTOM, CF_FUNC(cf_opa_mad_32b_mask), 0x0, "Flow control enabled on all VLs except VL15", HFILL }\r\n},\r\n{ &hf_opa_PortInfo_VL_PreemptCap, {\r\n"PreemptCap", "opa.portinfo.vl.preemptcap",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, "Size of Preempting VL Arbitration table", HFILL }\r\n},\r\n{ &hf_opa_PortInfo_VL_reserved, {\r\n"Reserved (3 bits)", "opa.portinfo.vl.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0xE0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_VL_Cap, {\r\n"VL Cap", "opa.portinfo.vl.cap",\r\nFT_UINT8, BASE_DEC, NULL, 0x1F, "Virtual Lanes supported on this port", HFILL }\r\n},\r\n{ &hf_opa_PortInfo_VL_HighLimit, {\r\n"HighLimit", "opa.portinfo.vl.highlimit",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, "Limit of high priority component of VL Arbitration table", HFILL }\r\n},\r\n{ &hf_opa_PortInfo_VL_PreemptingLimit, {\r\n"PreemptingLimit", "opa.portinfo.vl.preemptinglimit",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, "Limit of preempt component of VL Arbitration table", HFILL }\r\n},\r\n{ &hf_opa_PortInfo_VL_ArbitrationHighCap, {\r\n"ArbitrationHighCap", "opa.portinfo.vl.arbitrationhighcap",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_VL_ArbitrationLowCap, {\r\n"ArbitrationLowCap", "opa.portinfo.vl.arbitrationlowcap",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortPhysConfig_reserved, {\r\n"Reserved (4 bits)", "opa.portinfo.portphysconfig.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0xF0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortPhysConfig_PortType, {\r\n"PortPhysConfig PortType", "opa.portinfo.portphysconfig.porttype",\r\nFT_UINT8, BASE_HEX, VALS(PortType), 0x0F, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_MultiCollectMask_reserved, {\r\n"Reserved (2 bits)", "opa.portinfo.multicollectmask.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0xC0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_MultiCollectMask_CollectiveMask, {\r\n"MultiCollectMask CollectiveMask", "opa.portinfo.multicollectmask.collectivemask",\r\nFT_UINT8, BASE_HEX, NULL, 0x38, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_MultiCollectMask_MulticastMask, {\r\n"MultiCollectMask MulticastMask", "opa.portinfo.multicollectmask.multicastmask",\r\nFT_UINT8, BASE_HEX, NULL, 0x07, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_M_KeyProtectBits, {\r\n"M_KeyProtectBits", "opa.portinfo.mkeyprotectbits",\r\nFT_UINT8, BASE_HEX, NULL, 0xC0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_S1_reserved, {\r\n"Reserved (2 bits)", "opa.portinfo.s1.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x30, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_LMC, {\r\n"LMC", "opa.portinfo.lmc",\r\nFT_UINT8, BASE_HEX, NULL, 0x0F, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_S2_reserved, {\r\n"Reserved (3 bits)", "opa.portinfo.s2.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0xE0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_MasterSMSL, {\r\n"MasterSMSL", "opa.portinfo.mastersml",\r\nFT_UINT8, BASE_HEX, NULL, 0x1F, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_LinkInitReason, {\r\n"LinkInitReason", "opa.portinfo.linkinitreason",\r\nFT_UINT8, BASE_HEX, VALS(LinkInitReason), 0xF0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PartitionEnforcementInbound, {\r\n"PartitionEnforcementInbound", "opa.portinfo.partitionenforcementinbound",\r\nFT_UINT8, BASE_HEX, NULL, 0x08, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PartitionEnforcementOutbound, {\r\n"PartitionEnforcementOutbound", "opa.portinfo.partitionenforcementoutbound",\r\nFT_UINT8, BASE_HEX, NULL, 0x04, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_S3_reserved2, {\r\n"Reserved (2 bits)", "opa.portinfo.s3.reserved2",\r\nFT_UINT8, BASE_HEX, NULL, 0x03, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_S4_reserved, {\r\n"Reserved (3 bits)", "opa.portinfo.s4.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0xE0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_OperationalVL, {\r\n"OperationalVL", "opa.portinfo.operationalvl",\r\nFT_UINT8, BASE_HEX, NULL, 0x1F, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_P_Keys_P_Key_8B, {\r\n"P_Keys P_Key_8B", "opa.portinfo.pkey8",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_P_Keys_P_Key_10B, {\r\n"P_Keys P_Key_10B", "opa.portinfo.pkey10",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_M_KeyViolations, {\r\n"M_KeyViolations", "opa.portinfo.m_keyviolations",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_P_KeyViolations, {\r\n"P_KeyViolations", "opa.portinfo.p_keyviolations",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_Q_KeyViolations, {\r\n"Q_KeyViolations", "opa.portinfo.q_keyviolations",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_TrapQueuePair_reserved, {\r\n"TrapQueuePair Reserved (8 bits)", "opa.portinfo.trapqpair.reserved",\r\nFT_UINT32, BASE_HEX, NULL, 0xFF000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_TrapQueuePair, {\r\n"TrapQueuePair", "opa.portinfo.trapqpair",\r\nFT_UINT32, BASE_HEX, NULL, 0x00FFFFFF, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_SAQueuePair_reserved, {\r\n"SAQueuePair Reserved (8 bits)", "opa.portinfo.saqpair.reserved",\r\nFT_UINT32, BASE_HEX, NULL, 0xFF000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_SAQueuePair, {\r\n"SAQueuePair", "opa.portinfo.saqpair",\r\nFT_UINT32, BASE_HEX, NULL, 0x00FFFFFF, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_NeighborPortNum, {\r\n"NeighborPortNum", "opa.portinfo.neighborportnum",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_LinkDownReason, {\r\n"LinkDownReason", "opa.portinfo.linkdownreason",\r\nFT_UINT8, BASE_HEX, VALS(LinkDownReason), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_NeighborLinkDownReason, {\r\n"NeighborLinkDownReason", "opa.portinfo.neighborlinkdownreason",\r\nFT_UINT8, BASE_HEX, VALS(LinkDownReason), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_ClientRegister, {\r\n"Subnet ClientRegister", "opa.portinfo.clientregister",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_MulticastPKeyTrapSuppressEnabled, {\r\n"Subnet Multicast PKey Trap Enabled", "opa.portinfo.multicastpkeytrapenabled",\r\nFT_UINT8, BASE_HEX, NULL, 0x60, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_Timeout, {\r\n"Subnet Timeout", "opa.portinfo.timeout",\r\nFT_UINT8, BASE_HEX, NULL, 0x1F, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_LinkSpeedSupported, {\r\n"LinkSpeedSupported", "opa.portinfo.linkspeedsupported",\r\nFT_UINT16, BASE_CUSTOM, CF_FUNC(cf_opa_mad_linkspeed), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_LinkSpeedEnabled, {\r\n"LinkSpeedEnabled", "opa.portinfo.linkspeedenabled",\r\nFT_UINT16, BASE_CUSTOM, CF_FUNC(cf_opa_mad_linkspeed), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_LinkSpeedActive, {\r\n"LinkSpeedActive", "opa.portinfo.linkspeedactive",\r\nFT_UINT16, BASE_CUSTOM, CF_FUNC(cf_opa_mad_linkspeed), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_LinkWidthSupported, {\r\n"LinkWidthSupported", "opa.portinfo.linkwidthsupported",\r\nFT_UINT16, BASE_CUSTOM, CF_FUNC(cf_opa_mad_linkwidth), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_LinkWidthEnabled, {\r\n"LinkWidthEnabled", "opa.portinfo.linkwidthenabled",\r\nFT_UINT16, BASE_CUSTOM, CF_FUNC(cf_opa_mad_linkwidth), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_LinkWidthActive, {\r\n"LinkWidthActive", "opa.portinfo.linkwidthactive",\r\nFT_UINT16, BASE_CUSTOM, CF_FUNC(cf_opa_mad_linkwidth), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_LinkWidthDowngrade_Supported, {\r\n"LinkWidthDowngrade Supported", "opa.portinfo.linkwidthdowngradesupported",\r\nFT_UINT16, BASE_CUSTOM, CF_FUNC(cf_opa_mad_linkwidth), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_LinkWidthDowngrade_Enabled, {\r\n"LinkWidthDowngrade Enabled", "opa.portinfo.linkwidthdowngradeenabled",\r\nFT_UINT16, BASE_CUSTOM, CF_FUNC(cf_opa_mad_linkwidth), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_LinkWidthDowngrade_TxActive, {\r\n"LinkWidthDowngrade TxActive", "opa.portinfo.linkwidthdowngradetxactive",\r\nFT_UINT16, BASE_CUSTOM, CF_FUNC(cf_opa_mad_linkwidth), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_LinkWidthDowngrade_RxActive, {\r\n"LinkWidthDowngrade RxActive", "opa.portinfo.linkwidthdowngraderxactive",\r\nFT_UINT16, BASE_CUSTOM, CF_FUNC(cf_opa_mad_linkwidth), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortLinkMode_reserved, {\r\n"PortLinkMode Reserved (1 bit)", "opa.portinfo.portlinkmode.reserved",\r\nFT_UINT16, BASE_HEX, NULL, 0x8000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortLinkMode_Supported, {\r\n"PortLinkMode Supported", "opa.portinfo.portlinkmode.supported",\r\nFT_UINT16, BASE_CUSTOM, CF_FUNC(cf_opa_mad_portlinkmode), 0x7C00, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortLinkMode_Enabled, {\r\n"PortLinkMode Enabled", "opa.portinfo.portlinkmode.enabled",\r\nFT_UINT16, BASE_CUSTOM, CF_FUNC(cf_opa_mad_portlinkmode), 0x03E0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortLinkMode_Active, {\r\n"PortLinkMode Active", "opa.portinfo.portlinkmode.active",\r\nFT_UINT16, BASE_CUSTOM, CF_FUNC(cf_opa_mad_portlinkmode), 0x001F, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortLTPCRCMode_reserved, {\r\n"PortLTPCRCMode Reserved (4 bits)", "opa.portinfo.portltpcrc.reserved",\r\nFT_UINT16, BASE_HEX, NULL, 0xF000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortLTPCRCMode_Supported, {\r\n"PortLTPCRCMode Supported", "opa.portinfo.portltpcrc.supported",\r\nFT_UINT16, BASE_CUSTOM, CF_FUNC(cf_opa_mad_portltpcrcmode), 0x0F00, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortLTPCRCMode_Enabled, {\r\n"PortLTPCRCMode Enabled", "opa.portinfo.portltpcrc.enabled",\r\nFT_UINT16, BASE_CUSTOM, CF_FUNC(cf_opa_mad_portltpcrcmode), 0x00F0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortLTPCRCMode_Active, {\r\n"PortLTPCRCMode Active", "opa.portinfo.portltpcrc.active",\r\nFT_UINT16, BASE_CUSTOM, CF_FUNC(cf_opa_mad_portltpcrcmode), 0x000F, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortMode, {\r\n"PortMode", "opa.portinfo.portmode",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortMode_reserved, {\r\n"Reserved (9 bits)", "opa.portinfo.portmode.reserved",\r\nFT_UINT16, BASE_HEX, NULL, 0xFF80, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortMode_IsActiveOptimizeEnabled, {\r\n"IsActiveOptimizeEnabled", "opa.portinfo.portmode.isactiveoptimizeenabled",\r\nFT_BOOLEAN, 16, NULL, 0x0040, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortMode_IsPassThroughEnabled, {\r\n"IsPassThroughEnabled", "opa.portinfo.portmode.ispassthroughenabled",\r\nFT_BOOLEAN, 16, NULL, 0x0020, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortMode_IsVLMarkerEnabled, {\r\n"IsVLMarkerEnabled", "opa.portinfo.portmode.isvlmarkerenabled",\r\nFT_BOOLEAN, 16, NULL, 0x0010, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortMode_reserved2, {\r\n"Reserved (2 bits)", "opa.portinfo.portmode.reserved2",\r\nFT_UINT16, BASE_HEX, NULL, 0x000C, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortMode_Is16BTrapQueryEnabled, {\r\n"Is16BTrapQueryEnabled", "opa.portinfo.portmode.is16btrapqueryenabled",\r\nFT_BOOLEAN, 16, NULL, 0x0002, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortMode_reserved3, {\r\n"Reserved (1 bit)", "opa.portinfo.portmode.reserved3",\r\nFT_UINT16, BASE_HEX, NULL, 0x0001, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortPacketFormats_Supported, {\r\n"PortPacketFormats Supported", "opa.portinfo.portpacketformats.supported",\r\nFT_UINT16, BASE_CUSTOM, CF_FUNC(cf_opa_mad_packetformat), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortPacketFormats_Enabled, {\r\n"PortPacketFormats Enabled", "opa.portinfo.portpacketformats.enabled",\r\nFT_UINT16, BASE_CUSTOM, CF_FUNC(cf_opa_mad_packetformat), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_FlitControl_Interleave_reserved, {\r\n"Interleave Reserved (2 bits)", "opa.portinfo.flitcontrol.interleave.reserved",\r\nFT_UINT16, BASE_HEX, NULL, 0xC000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_FlitControl_Interleave_DistanceSupported, {\r\n"Interleave DistanceSupported", "opa.portinfo.flitcontrol.interleave.distancesupported",\r\nFT_UINT16, BASE_HEX, VALS(PortFlitDistanceMode), 0x3000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_FlitControl_Interleave_DistanceEnabled, {\r\n"Interleave DistanceEnabled", "opa.portinfo.flitcontrol.interleave.distanceenabled",\r\nFT_UINT16, BASE_HEX, VALS(PortFlitDistanceMode), 0x0C00, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_FlitControl_Interleave_MaxNestLevelTxEnabled, {\r\n"Interleave MaxNestLevelTxEnabled", "opa.portinfo.flitcontrol.interleave.maxnestleveltxenabled",\r\nFT_UINT16, BASE_HEX, NULL, 0x03E0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_FlitControl_Interleave_MaxNestLevelRxSupported, {\r\n"Interleave MaxNestLevelRxEnabled", "opa.portinfo.flitcontrol.interleave.maxnestlevelrxenabled",\r\nFT_UINT16, BASE_HEX, NULL, 0x001F, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_FlitControl_Preemption_MinInitial, {\r\n"Preemption MinIntial", "opa.portinfo.flitcontrol.preemption.mininitial",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_FlitControl_Preemption_MinTail, {\r\n"Preemption Mintail", "opa.portinfo.flitcontrol.preemption.mintail",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_FlitControl_Preemption_LargePacketLimit, {\r\n"Preemption LargePacketLimit", "opa.portinfo.flitcontrol.preemption.largepacketlimit",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_FlitControl_Preemption_SmallPacketLimit, {\r\n"Preemption SmallPacketLimit", "opa.portinfo.flitcontrol.preemption.smallpacketlimit",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_FlitControl_Preemption_MaxSmallPacketLimit, {\r\n"Preemption MaxSmallPacketLimit", "opa.portinfo.flitcontrol.preemption.maxsmallpacketlimit",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_FlitControl_Preemption_PreemptionLimit, {\r\n"Preemption PreemptionLimit", "opa.portinfo.flitcontrol.preemption.preemptionlimit",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortErrorAction, {\r\n"PortErrorAction", "opa.portinfo.porterroraction",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortErrorAction_ExcessiveBufferOverrun, {\r\n"ExcessiveBufferOverrun", "opa.portinfo.porterroraction.excessivebufferoverrun",\r\nFT_BOOLEAN, 32, NULL, 0x80000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortErrorAction_reserved, {\r\n"Reserved (7 bits)", "opa.portinfo.porterroraction.reserved",\r\nFT_UINT32, BASE_HEX, NULL, 0x7F000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortErrorAction_FmConfigErrorExceedMulticastLimit, {\r\n"FMConfigErrorExceedMulticastLimit", "opa.portinfo.porterroraction.fmconfigerrorexceedmulticastlimit",\r\nFT_BOOLEAN, 32, NULL, 0x00800000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortErrorAction_FmConfigErrorBadControlFlit, {\r\n"FmConfigErrorBadControlFlit", "opa.portinfo.porterroraction.fmconfigerrorbadcontrolflit",\r\nFT_BOOLEAN, 32, NULL, 0x00400000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortErrorAction_FmConfigErrorBadPreempt, {\r\n"FmConfigErrorBadPreempt", "opa.portinfo.porterroraction.fmconfigerrorbadpreempt",\r\nFT_BOOLEAN, 32, NULL, 0x00200000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortErrorAction_FmConfigErrorBadVLMarker, {\r\n"FmConfigErrorBadVLMarker", "opa.portinfo.porterroraction.fmconfigerrorbadvlmarker",\r\nFT_BOOLEAN, 32, NULL, 0x00100000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortErrorAction_FmConfigErrorBadCrdtAck, {\r\n"FmConfigErrorBadCrdtAck", "opa.portinfo.porterroraction.fmconfigerrorbadcrdtack",\r\nFT_BOOLEAN, 32, NULL, 0x00080000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortErrorAction_FmConfigErrorBadCtrlDist, {\r\n"FmConfigErrorBadCtrlDist", "opa.portinfo.porterroraction.fmconfigerrorbadctrldist",\r\nFT_BOOLEAN, 32, NULL, 0x00040000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortErrorAction_FmConfigErrorBadTailDist, {\r\n"FmConfigErrorBadTailDist", "opa.portinfo.porterroraction.fmconfigerrorbadtaildist",\r\nFT_BOOLEAN, 32, NULL, 0x00020000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortErrorAction_FmConfigErrorBadHeadDist, {\r\n"FmConfigErrorBadHeadDist", "opa.portinfo.porterroraction.fmconfigerrorbadheaddist",\r\nFT_BOOLEAN, 32, NULL, 0x00010000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortErrorAction_reserved2, {\r\n"Reserved (2 bits)", "opa.portinfo.porterroraction.reserved2",\r\nFT_UINT32, BASE_HEX, NULL, 0x0000C000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortErrorAction_PortRcvErrorBadVLMarker, {\r\n"PortRcvErrorBadVLMarker", "opa.portinfo.porterroraction.portrcverrorbadvlmarker",\r\nFT_BOOLEAN, 32, NULL, 0x00002000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortErrorAction_PortRcvErrorPreemptVL15, {\r\n"PortRcvErrorPreemptVL15", "opa.portinfo.porterroraction.portrcverrorpreemptvl15",\r\nFT_BOOLEAN, 32, NULL, 0x00001000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortErrorAction_PortRcvErrorPreemptError, {\r\n"PortRcvErrorPreemptError", "opa.portinfo.porterroraction.portrcverrorpreempterror",\r\nFT_BOOLEAN, 32, NULL, 0x00000800, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortErrorAction_reserved3, {\r\n"Reserved (1 bit)", "opa.portinfo.porterroraction.reserved3",\r\nFT_UINT32, BASE_HEX, NULL, 0x00000400, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortErrorAction_PortRcvErrorBadMidTail, {\r\n"PortRcvErrorBadMidTail", "opa.portinfo.porterroraction.portrcverrorbadmidtail",\r\nFT_BOOLEAN, 32, NULL, 0x00000200, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortErrorAction_PortRcvErrorReserved, {\r\n"PortRcvErrorReserved", "opa.portinfo.porterroraction.portrcverrorreserved",\r\nFT_UINT32, BASE_HEX, NULL, 0x00000100, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortErrorAction_PortRcvErrorBadSC, {\r\n"PortRcvErrorBadSC", "opa.portinfo.porterroraction.portrcverrorbadsc",\r\nFT_BOOLEAN, 32, NULL, 0x00000080, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortErrorAction_PortRcvErrorBadL2, {\r\n"PortRcvErrorBadL2", "opa.portinfo.porterroraction.portrcverrorbadl2",\r\nFT_BOOLEAN, 32, NULL, 0x00000040, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortErrorAction_PortRcvErrorBadDLID, {\r\n"PortRcvErrorBadDLID", "opa.portinfo.porterroraction.portrcverrorbaddlid",\r\nFT_BOOLEAN, 32, NULL, 0x00000020, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortErrorAction_PortRcvErrorBadSLID, {\r\n"PortRcvErrorBadSLID", "opa.portinfo.porterroraction.portrcverrorbadslid",\r\nFT_BOOLEAN, 32, NULL, 0x00000010, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortErrorAction_PortRcvErrorPktLenTooShort, {\r\n"PortRcvErrorPktLenTooShort", "opa.portinfo.porterroraction.portrcverrorpktlentooshort",\r\nFT_BOOLEAN, 32, NULL, 0x00000008, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortErrorAction_PortRcvErrorPktLenTooLong, {\r\n"PortRcvErrorPktLenTooLong", "opa.portinfo.porterroraction.portrcverrorpktlentoolong",\r\nFT_BOOLEAN, 32, NULL, 0x00000004, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortErrorAction_PortRcvErrorBadPktLen, {\r\n"PortRcvErrorBadPktLen", "opa.portinfo.porterroraction.portrcverrorbadpktlen",\r\nFT_BOOLEAN, 32, NULL, 0x00000002, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortErrorAction_reserved4, {\r\n"Reserved (1 bit)", "opa.portinfo.porterroraction.reserved4",\r\nFT_UINT32, BASE_HEX, NULL, 0x00000001, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PassThroughControl_EgressPort, {\r\n"PassThroughControl EgressPort", "opa.portinfo.passthroughcontrol.egressport",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PassThroughControl_reserved, {\r\n"Reserved (7 Bits)", "opa.portinfo.passthroughcontrol.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0xFE, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PassThroughControl_DRControl, {\r\n"PassThroughControl DRControl", "opa.portinfo.passthroughcontrol.drcontrol",\r\nFT_UINT8, BASE_HEX, NULL, 0x01, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_M_KeyLeasePeriod, {\r\n"M_KeyLeasePeriod", "opa.portinfo.m_keyleaseperiod",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_BufferUnits_reserved, {\r\n"BufferUnits Reserved (9 bits)", "opa.portinfo.bufferunits.reserved",\r\nFT_UINT32, BASE_HEX, NULL, 0xFF800000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_BufferUnits_VL15Init, {\r\n"BufferUnits VL15Init", "opa.portinfo.bufferunits.vl15init",\r\nFT_UINT32, BASE_HEX, NULL, 0x007FF800, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_BufferUnits_VL15CreditRate, {\r\n"BufferUnits VL15Credit", "opa.portinfo.bufferunits.vl15credit",\r\nFT_UINT32, BASE_HEX, NULL, 0x0000007C0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_BufferUnits_CreditAck, {\r\n"BufferUnits CreditAck", "opa.portinfo.bufferunits.creditack",\r\nFT_UINT32, BASE_HEX, NULL, 0x00000038, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_BufferUnits_BufferAlloc, {\r\n"BufferUnits BufferAlloc", "opa.portinfo.bufferunits.bufferalloc",\r\nFT_UINT32, BASE_HEX, NULL, 0x00000007, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_MasterSMLID, {\r\n"MasterSMLID", "opa.portinfo.mastersmlid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_M_Key, {\r\n"MKey", "opa.portinfo.mkey",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_SubnetPrefix, {\r\n"SubnetPrefix", "opa.portinfo.subnetprefix",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_VL1, {\r\n"VL", "opa.portinfo.vl1",\r\nFT_UINT8, BASE_HEX, VALS(MTU), 0xF0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_VL2, {\r\n"VL", "opa.portinfo.vl2",\r\nFT_UINT8, BASE_HEX, VALS(MTU), 0x0F, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_XmitQ_VLStallCount, {\r\n"VLStallCount", "opa.portinfo.xmitq.vlstallcount",\r\nFT_UINT8, BASE_HEX, NULL, 0xE0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_XmitQ_HOQLife, {\r\n"HOQLife", "opa.portinfo.xmitq.hoqlife",\r\nFT_UINT8, BASE_HEX, NULL, 0x1F, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_IPAddrIPv6, {\r\n"IPAddr IPv6", "opa.portinfo.ipaddripv6",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_IPAddrIPv4, {\r\n"IPAddr IPv4", "opa.portinfo.ipaddripv4",\r\nFT_IPv4, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_NeighborNodeGUID, {\r\n"NeighborNodeGUID", "opa.portinfo.neighbornodeguid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_CapabilityMask, {\r\n"CapabilityMask", "opa.portinfo.capabilitymask",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_CapabilityMask_reserved, {\r\n"Reserved (9 bits)", "opa.portinfo.capabilitymask.reserved",\r\nFT_UINT32, BASE_HEX, NULL, 0xFF800000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_CapabilityMask_IsCapabilityMaskNoticeSupported, {\r\n"IsCapabilityMaskNoticeSupported", "opa.portinfo.capabilitymask.iscapabilitymasknoticesupported",\r\nFT_BOOLEAN, 32, NULL, 0x00400000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_CapabilityMask_reserved2, {\r\n"Reserved (1 bit)", "opa.portinfo.capabilitymask.reserved2",\r\nFT_UINT32, BASE_HEX, NULL, 0x00200000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_CapabilityMask_IsVendorClassSupported, {\r\n"IsVendorClassSupported", "opa.portinfo.capabilitymask.isvendorclasssupported",\r\nFT_BOOLEAN, 32, NULL, 0x00100000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_CapabilityMask_IsDeviceManagementSupported, {\r\n"IsDeviceManagementSupported", "opa.portinfo.capabilitymask.isdevicemanagementsupported",\r\nFT_BOOLEAN, 32, NULL, 0x00080000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_CapabilityMask_reserved3, {\r\n"Reserved (2 bits)", "opa.portinfo.capabilitymask.reserved3",\r\nFT_UINT32, BASE_HEX, NULL, 0x00060000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_CapabilityMask_IsConnectionManagementSupported, {\r\n"IsConnectionManagementSupported", "opa.portinfo.capabilitymask.isconnectionmanagementsupported",\r\nFT_BOOLEAN, 32, NULL, 0x00010000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_CapabilityMask_reserved4, {\r\n"Reserved (10 bits)", "opa.portinfo.capabilitymask.reserved4",\r\nFT_UINT32, BASE_HEX, NULL, 0x0000FFC0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_CapabilityMask_IsAutomaticMigrationSupported, {\r\n"IsAutomaticMigrationSupported", "opa.portinfo.capabilitymask.isautomaticmigrationsupported",\r\nFT_BOOLEAN, 32, NULL, 0x00000020, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_CapabilityMask_reserved5, {\r\n"Reserved (3 bits)", "opa.portinfo.capabilitymask.reserved5",\r\nFT_UINT32, BASE_HEX, NULL, 0x0000001C, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_CapabilityMask_IsSM, {\r\n"IsSM", "opa.portinfo.capabilitymask.issm",\r\nFT_BOOLEAN, 32, NULL, 0x00000002, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_CapabilityMask_reserved6, {\r\n"Reserved (1 bit)", "opa.portinfo.capabilitymask.reserved6",\r\nFT_UINT32, BASE_HEX, NULL, 0x00000001, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_CapabilityMask3, {\r\n"CapabilityMask3", "opa.portinfo.capabilitymask3",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_CapabilityMask3_reserved, {\r\n"Reserved (8 bits)", "opa.portinfo.capabilitymask3.reserved",\r\nFT_UINT16, BASE_HEX, NULL, 0xFF00, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_CapabilityMask3_IsSnoopSupported, {\r\n"IsSnoopSupported", "opa.portinfo.capabilitymask3.issnoopsupported",\r\nFT_BOOLEAN, 16, NULL, 0x0080, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_CapabilityMask3_IsAsyncSCtoVLSupported, {\r\n"IsAsyncSCtoVLSupported", "opa.portinfo.capabilitymask3.isasyncsc2vlsupported",\r\nFT_BOOLEAN, 16, NULL, 0x0040, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_CapabilityMask3_IsAddrRangeConfigSupported, {\r\n"IsAddrRangeConfigSupported", "opa.portinfo.capabilitymask3.isaddrrangeconfigsupported",\r\nFT_BOOLEAN, 16, NULL, 0x0020, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_CapabilityMask3_IsPassThroughSupported, {\r\n"IsPassThroughSupported", "opa.portinfo.capabilitymask3.ispassthroughsupported",\r\nFT_BOOLEAN, 16, NULL, 0x0010, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_CapabilityMask3_IsSharedSpaceSupported, {\r\n"IsSharedSpaceSupported", "opa.portinfo.capabilitymask3.issharedspacesupported",\r\nFT_BOOLEAN, 16, NULL, 0x0008, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_CapabilityMask3_reserved2, {\r\n"IsVLMarkerSupported", "opa.portinfo.capabilitymask3.reserved2",\r\nFT_BOOLEAN, 16, NULL, 0x0004, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_CapabilityMask3_IsVLMarkerSupported, {\r\n"IsVLMarkerSupported", "opa.portinfo.capabilitymask3.isvlmarkersupported",\r\nFT_BOOLEAN, 16, NULL, 0x0002, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_CapabilityMask3_IsVLrSupported, {\r\n"IsVLrSupported", "opa.portinfo.capabilitymask3.isvlrsupported",\r\nFT_BOOLEAN, 16, NULL, 0x0001, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_OverallBufferSpace, {\r\n"OverallBufferSpace", "opa.portinfo.overallbufferspace",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_DiagCode, {\r\n"DiagCode", "opa.portinfo.diagcode",\r\nFT_UINT16, BASE_HEX, VALS(DiagCode), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_ReplayDepth_BufferDepth, {\r\n"Replay BufferDepth", "opa.portinfo.replaydepth.bufferdepth",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_ReplayDepth_WireDepth, {\r\n"Replay WireDepth", "opa.portinfo.replaydepth.wiredepth",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortNeighborMode_reserved, {\r\n"PortNeighborMode Reserved (4 bits)", "opa.portinfo.portneighbormode.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0xF0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortNeighborMode_MgmtAllowed, {\r\n"PortNeighborMode MgmtAllowed", "opa.portinfo.portneighbormode.mgmtallowed",\r\nFT_BOOLEAN, 8, NULL, 0x08, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortNeighborMode_NeighborFWAuthenBypass, {\r\n"PortNeighborMode NeighborFWAuthenBypass", "opa.portinfo.portneighbormode.neighborfwauthenbypass",\r\nFT_BOOLEAN, 8, TFS(&tfs_NeighborFWAuthenBypass), 0x04, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_PortNeighborMode_NeighborNodeType, {\r\n"PortNeighborMode NeighborNodeType", "opa.portinfo.portneighbormode.neighbornodetype",\r\nFT_UINT8, BASE_HEX, NULL, 0x03, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_MTU_reserved, {\r\n"MTU Reserved (4 bits)", "opa.portinfo.mtu.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0xF0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_MTU_Cap, {\r\n"MTU Cap", "opa.portinfo.mtu.cap",\r\nFT_UINT8, BASE_HEX, VALS(MTU), 0x0F, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_Resp_reserved, {\r\n"Resp Reserved (3 bits)", "opa.portinfo.resp.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0xE0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_Resp_TimeValue, {\r\n"Resp TimeValue", "opa.portinfo.resp.timevalue",\r\nFT_UINT8, BASE_HEX, NULL, 0x1F, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfo_LocalPortNum, {\r\n"LocalPortNum", "opa.portinfo.localportnum",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStates, {\r\n"PortStates", "opa.portstates",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStates_reserved, {\r\n"Reserved (10 bits)", "opa.portstates.reserved",\r\nFT_UINT32, BASE_HEX, NULL, 0xFF800000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStates_LEDEnabled, {\r\n"LEDEnabled", "opa.portstates.ledenabled",\r\nFT_BOOLEAN, 32, NULL, 0x00400000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStates_IsSMConfigurationStarted, {\r\n"IsSMConfigurationStarted", "opa.portstates.issmconfigurationstarted",\r\nFT_BOOLEAN, 32, NULL, 0x00200000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStates_NeighborNormal, {\r\n"NeighborNormal", "opa.portstates.neighbornormal",\r\nFT_BOOLEAN, 32, NULL, 0x00100000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStates_OfflineDisabledReason, {\r\n"OfflineDisabledReason", "opa.portstates.offlinedisabledreason",\r\nFT_UINT32, BASE_HEX, VALS(OfflineDisabledReason), 0x000F0000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStates_PortUnsleepState, {\r\n"PortUnsleepState", "opa.portstates.portunsleepstates",\r\nFT_UINT32, BASE_HEX, VALS(PortPhysicalState), 0x0000F000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStates_DownDefaultState, {\r\n"DownDefaultState", "opa.portstates.downdefaultstate",\r\nFT_UINT32, BASE_HEX, VALS(PortPhysicalState), 0x00000F00, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStates_PortPhysicalState, {\r\n"PortPhysicalState", "opa.portstates.portphysicalstate",\r\nFT_UINT32, BASE_HEX, VALS(PortPhysicalState), 0x000000F0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStates_PortState, {\r\n"PortState", "opa.portstates.portstate",\r\nFT_UINT32, BASE_HEX, VALS(PortState), 0x0000000F, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStates_LinkWidthDowngradeTxActive, {\r\n"LinkWidthDowngrade TxActive", "opa.portstates.linkwidthdowngradetxactive",\r\nFT_UINT16, BASE_CUSTOM, CF_FUNC(cf_opa_mad_linkwidth), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStates_LinkWidthDowngradeRxActive, {\r\n"LinkWidthDowngrade RxActive", "opa.portstates.linkwidthdowngradetxactive",\r\nFT_UINT16, BASE_CUSTOM, CF_FUNC(cf_opa_mad_linkwidth), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_P_KeyTable, {\r\n"P_Key Table", "opa.p_keytable",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_P_KeyTable_MembershipType, {\r\n"Membership Type", "opa.p_keytable.membershiptype",\r\nFT_BOOLEAN, 16, TFS(&tfs_PKeyMembershipType), 0x8000, NULL, HFILL }\r\n},\r\n{ &hf_opa_P_KeyTable_P_KeyBase, {\r\n"P_Key Base", "opa.p_keytable.p_keybase",\r\nFT_UINT16, BASE_HEX, NULL, 0x7FFF, NULL, HFILL }\r\n},\r\n{ &hf_opa_SLtoSCMappingTable, {\r\n"SL to SC Mapping Table", "opa.sltoscmappingtable",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SLtoSCMappingTable_SLtoSC_HighBits, {\r\n"Reserved (3 bits)", "opa.sltoscmappingtable.sltoschighbits",\r\nFT_UINT8, BASE_HEX, NULL, 0xE0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SLtoSCMappingTable_SLtoSC_LowBits, {\r\n"SC", "opa.sltoscmappingtable.sltosclowbits",\r\nFT_UINT8, BASE_HEX, NULL, 0x1F, NULL, HFILL }\r\n},\r\n{ &hf_opa_SCtoSCMappingTable, {\r\n"SC to SC Mapping Table", "opa.sctoscmappingtable",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SCtoSCMappingTable_SCtoSC_HighBits, {\r\n"Reserved (3 bits)", "opa.sctoscmappingtable.sctoschighbits",\r\nFT_UINT8, BASE_HEX, NULL, 0xE0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SCtoSCMappingTable_SCtoSC_LowBits, {\r\n"SC", "opa.sctoscmappingtable.sctosclowbits",\r\nFT_UINT8, BASE_HEX, NULL, 0x1F, NULL, HFILL }\r\n},\r\n{ &hf_opa_SCtoSLMappingTable, {\r\n"SC to SL Mapping Table", "opa.sctoslmappingtable",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SCtoSLMappingTable_SCtoSL_HighBits, {\r\n"Reserved (3 bits)", "opa.sctoslmappingtable.sctoslhighbits",\r\nFT_UINT8, BASE_HEX, NULL, 0xE0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SCtoSLMappingTable_SCtoSL_LowBits, {\r\n"SL", "opa.sctoslmappingtable.sctosllowbits",\r\nFT_UINT8, BASE_HEX, NULL, 0x1F, NULL, HFILL }\r\n},\r\n{ &hf_opa_SCtoVLxMappingTable, {\r\n"SC to VLx Mapping Table", "opa.sctovlxmappingtable",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SCtoVLxMappingTable_SCtoVLx_HighBits, {\r\n"Reserved (3 bits)", "opa.sctovlxmappingtable.sctovlxhighbits",\r\nFT_UINT8, BASE_HEX, NULL, 0xE0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SCtoVLxMappingTable_SCtoVLx_LowBits, {\r\n"VL", "opa.sctovlxmappingtable.sctovlxlowbits",\r\nFT_UINT8, BASE_HEX, NULL, 0x1F, NULL, HFILL }\r\n},\r\n{ &hf_opa_VLArbitrationTable, {\r\n"VL Arbitration Table", "opa.vlarbitrationtable",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_VLArbitrationTable_reserved, {\r\n"Reserved (3 bits)", "opa.vlarbitrationtable.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0xE0, NULL, HFILL }\r\n},\r\n{ &hf_opa_VLArbitrationTable_VL, {\r\n"VL", "opa.vlarbitrationtable.vl",\r\nFT_UINT8, BASE_HEX, NULL, 0x1F, NULL, HFILL }\r\n},\r\n{ &hf_opa_VLArbitrationTable_Weight, {\r\n"Weight", "opa.vlarbitrationtable.weight",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_VLArbitrationTable_Matrix, {\r\n"Element", "opa.vlarbitrationtable.matrix",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_LinearForwardingTable, {\r\n"Linear Forwarding Table", "opa.linearforwardingtable",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_LinearForwardingTable_Port, {\r\n"Port", "opa.linearforwardingtable.port",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MulticastForwardingTable, {\r\n"Multicast Forwarding Table", "opa.multicastforwardingtable",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MulticastForwardingTable_PortMask, {\r\n"Port Mask", "opa.multicastforwardingtable.portmask",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortGroupForwardingTable, {\r\n"Port Group Forwarding Table", "opa.portgroupforwardingtable",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortGroupForwardingTable_Port, {\r\n"Port", "opa.portgroupforwardingtable.port",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortGroupTable, {\r\n"Port Group Table", "opa.portgrouptable",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortGroupTable_PortMask, {\r\n"Port Mask", "opa.portgrouptable.portmask",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SMInfo, {\r\n"SM Info", "opa.sminfo",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SMInfo_GUID, {\r\n"GUID", "opa.sminfo.guid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SMInfo_SM_Key, {\r\n"SM_Key", "opa.sminfo.sm_key",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SMInfo_ActCount, {\r\n"ActCount", "opa.sminfo.actcount",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SMInfo_ElapsedTime, {\r\n"ElapsedTime", "opa.sminfo.elapsedtime",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SMInfo_Priority, {\r\n"Priority", "opa.sminfo.priority",\r\nFT_UINT8, BASE_HEX, NULL, 0xF0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SMInfo_ElevatedPriority, {\r\n"ElevatedPriority", "opa.sminfo.elevatedpriority",\r\nFT_UINT8, BASE_HEX, NULL, 0x0F, NULL, HFILL }\r\n},\r\n{ &hf_opa_SMInfo_InitialPriority, {\r\n"InitialPriority", "opa.sminfo.initialpriority",\r\nFT_UINT8, BASE_HEX, NULL, 0xF0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SMInfo_SMState, {\r\n"SMState", "opa.sminfo.smstate",\r\nFT_UINT8, BASE_HEX, NULL, 0x0F, NULL, HFILL }\r\n},\r\n{ &hf_opa_LedInfo, {\r\n"Led Info", "opa.ledinfo",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_LedInfo_LedMask, {\r\n"LedMask", "opa.ledinfo.ledmask",\r\nFT_BOOLEAN, 32, NULL, 0x80000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_LedInfo_reserved, {\r\n"Reserved (31 bits)", "opa.ledinfo.reserved",\r\nFT_UINT32, BASE_HEX, NULL, 0x7FFFFFFF, NULL, HFILL }\r\n},\r\n{ &hf_opa_CableInfo, {\r\n"Cable Info", "opa.cableinfo",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_CableInfo_Data, {\r\n"Data", "opa.cableinfo.data",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_CableInfo_DataStream, {\r\n"Data", "opa.cableinfo.datastream",\r\nFT_STRING, STR_ASCII, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Aggregate, {\r\n"Aggregate", "opa.aggregate",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Aggregate_AttributeID, {\r\n"Attribute ID", "opa.aggregate.attrid",\r\nFT_UINT16, BASE_HEX, VALS(SUBM_Attributes), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_Aggregate_Error, {\r\n"Error", "opa.aggregate.error",\r\nFT_BOOLEAN, 16, NULL, 0x8000, NULL, HFILL }\r\n},\r\n{ &hf_opa_Aggregate_RequestLength, {\r\n"Request Length", "opa.aggregate.requestlength",\r\nFT_UINT16, BASE_DEC, NULL, 0x007F, NULL, HFILL }\r\n},\r\n{ &hf_opa_BufferControlTable, {\r\n"Buffer Control Table", "opa.buffercontroltable",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_BufferControlTable_TxOverallSharedLimit, {\r\n"Tx Overall Shared Limit", "opa.buffercontroltable.txoverallsharedlimit",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_BufferControlTable_TxDedicatedLimit, {\r\n"Tx Dedictated Limit", "opa.buffercontroltable.txdedicatedlimit",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_BufferControlTable_TxSharedLimit, {\r\n"Tx Shared Limit", "opa.buffercontroltable.txsharedlimit",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_FabricInfoRecord, {\r\n"Fabric Info Record", "opa.fabricinforecord",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_FabricInfoRecord_NumHFIs, {\r\n"Num HFIs", "opa.fabricinforecord.numhfis",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_FabricInfoRecord_NumSwitches, {\r\n"Num Switches", "opa.fabricinforecord.numswitches",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_FabricInfoRecord_NumInternalHFILinks, {\r\n"Num Internal HFI Links", "opa.fabricinforecord.numinternalhfilinks",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_FabricInfoRecord_NumExternalHFILinks, {\r\n"Num External HFI Links", "opa.fabricinforecord.numexternalhfilinks",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_FabricInfoRecord_NumInternalISLs, {\r\n"Num Internal ISLs", "opa.fabricinforecord.numinternalisls",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_FabricInfoRecord_NumExternalISLs, {\r\n"Num External ISLs", "opa.fabricinforecord.numexternalisls",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_FabricInfoRecord_NumDegradedHFILinks, {\r\n"Num Degraded HFI Links", "opa.fabricinforecord.numdegradedhfilinks",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_FabricInfoRecord_NumDegradedISLs, {\r\n"Num Degraded ISLs", "opa.fabricinforecord.numdegradedisls",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_FabricInfoRecord_NumOmittedHFILinks, {\r\n"Num Omitted HFI Links", "opa.fabricinforecord.numomittedhfilinks",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_FabricInfoRecord_NumOmittedISLs, {\r\n"Num Omitted ISLs", "opa.fabricinforecord.numomittedisls",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_FabricInfoRecord_Reserved, {\r\n"Reserved (92 Bytes)", "opa.fabricinforecord.reserved",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_CongestionInfo, {\r\n"Congestion Info", "opa.congestioninfo",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_CongestionInfo_CongestionInfo, {\r\n"Congestion Info", "opa.congestioninfo.congestioninfo",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_CongestionInfo_ControlTableCap, {\r\n"Control Table Cap", "opa.congestioninfo.controltablecap",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_CongestionInfo_CongestionLogLength, {\r\n"Congestion Log Length", "opa.congestioninfo.congestionloglength",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchCongestionLog, {\r\n"Switch Congestion Log", "opa.switchcongestionlog",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchCongestionLog_LogType, {\r\n"Log Type", "opa.switchcongestionlog.logtype",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchCongestionLog_CongestionFlags, {\r\n"Congestion Flags", "opa.switchcongestionlog.congestionflags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchCongestionLog_LogEventsCounter, {\r\n"Log Events Counter", "opa.switchcongestionlog.logeventscounter",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchCongestionLog_CurrentTimeStamp, {\r\n"Current Time Stamp", "opa.switchcongestionlog.currenttimestamp",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchCongestionLog_PortMap, {\r\n"Port Map", "opa.switchcongestionlog.portmap",\r\nFT_BYTES, FT_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchCongestionLog_SLID, {\r\n"SLID", "opa.switchcongestionlog.slid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchCongestionLog_DLID, {\r\n"DLID", "opa.switchcongestionlog.dlid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchCongestionLog_SC, {\r\n"SC", "opa.switchcongestionlog.sc",\r\nFT_UINT8, BASE_HEX, NULL, 0xF8, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchCongestionLog_reserved, {\r\n"Reserved (3 bits)", "opa.switchcongestionlog.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x07, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchCongestionLog_TimeStamp, {\r\n"Time Stamp", "opa.switchcongestionlog.timestamp",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchCongestionSetting, {\r\n"Switch Congestion Setting", "opa.switchcongestionsetting",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchCongestionSetting_Control_Map, {\r\n"Control Map", "opa.switchcongestionsetting.controlmap",\r\nFT_UINT32, BASE_CUSTOM, CF_FUNC(cf_opa_mad_swcongestionsetting_controlmap), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchCongestionSetting_Victim_Mask, {\r\n"Victim Mask", "opa.switchcongestionsetting.victimmask",\r\nFT_BYTES, FT_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchCongestionSetting_Credit_Mask, {\r\n"Credit Mask", "opa.switchcongestionsetting.creditmask",\r\nFT_BYTES, FT_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchCongestionSetting_Threshold, {\r\n"Threshold", "opa.switchcongestionsetting.threshold",\r\nFT_UINT8, BASE_HEX, NULL, 0xF0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchCongestionSetting_reserved1, {\r\n"Reserved (4 bits)", "opa.switchcongestionsetting.reserved1",\r\nFT_UINT8, BASE_HEX, NULL, 0x0F, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchCongestionSetting_Packet_Size, {\r\n"Packet Size", "opa.switchcongestionsetting.packetsize",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchCongestionSetting_CS_Threshold, {\r\n"CS Threshold", "opa.switchcongestionsetting.csthreshold",\r\nFT_UINT8, BASE_HEX, NULL, 0xF0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchCongestionSetting_reserved2, {\r\n"Reserved (4 bits)", "opa.switchcongestionsetting.reserved2",\r\nFT_UINT8, BASE_HEX, NULL, 0x0F, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchCongestionSetting_CS_ReturnDelay, {\r\n"CS ReturnDelay", "opa.switchcongestionsetting.csreturndelay",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchCongestionSetting_Marking_Rate, {\r\n"Marking Rate", "opa.switchcongestionsetting.markingrate",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchPortCongestionSetting, {\r\n"Switch Port Congestion Setting", "opa.switchportcongestionsetting",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchPortCongestionSetting_Valid, {\r\n"Valid", "opa.switchportcongestionsetting.valid",\r\nFT_BOOLEAN, 8, TFS(&tfs_valid_invalid), 0x80, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchPortCongestionSetting_Control_Type, {\r\n"Control Type", "opa.switchportcongestionsetting.controltype",\r\nFT_BOOLEAN, 8, TFS(&tfs_SwPortCongSetting_CtrlType), 0x40, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchPortCongestionSetting_reserved, {\r\n"Reserved (2 bits)", "opa.switchportcongestionsetting.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x30, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchPortCongestionSetting_Threshold, {\r\n"Threshold", "opa.switchportcongestionsetting.threshold",\r\nFT_UINT8, BASE_HEX, NULL, 0x0F, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchPortCongestionSetting_Packet_Size, {\r\n"Packet Size", "opa.switchportcongestionsetting.packetsize",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_SwitchPortCongestionSetting_Marking_Rate, {\r\n"Marking Rate", "opa.switchportcongestionsetting.markingrate",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_HFICongestionLog, {\r\n"HFI Congestion Log", "opa.hficongestionlog",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_HFICongestionLog_LogType, {\r\n"Log Type", "opa.hficongestionsetting.logtype",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_HFICongestionLog_CongestionFlags, {\r\n"Congestion Flags", "opa.hficongestionsetting.congestionflags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_HFICongestionLog_ThresholdEventCounter, {\r\n"Threshold Event Counter", "opa.hficongestionsetting.thresholdeventcounter",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_HFICongestionLog_CurrentTimeStamp, {\r\n"Current Time Stamp", "opa.hficongestionsetting.currenttimestamp",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_HFICongestionLog_ThresholdCongestionEventMap, {\r\n"Threshold Congestion Event Map", "opa.hficongestionsetting.thresholdcongestioneventmap",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_HFICongestionLog_Local_QP_CN_Entry, {\r\n"Local QP CN Entry", "opa.hficongestionsetting.localqpcnentry",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_HFICongestionLog_Remote_QP_Number_CN_Entry, {\r\n"Remote QP Number CN Entry", "opa.hficongestionsetting.remoteqpnumbercnentry",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_HFICongestionLog_SL_CN_Entry, {\r\n"Threshold Congestion Event Map", "opa.hficongestionsetting.thresholdcongestioneventmap",\r\nFT_UINT8, BASE_HEX, NULL, 0xF8, NULL, HFILL }\r\n},\r\n{ &hf_opa_HFICongestionLog_Service_Type_CN_Entry, {\r\n"Service Type CN Entry", "opa.hficongestionsetting.servicetypecnentry",\r\nFT_UINT8, BASE_HEX, NULL, 0x0E, NULL, HFILL }\r\n},\r\n{ &hf_opa_HFICongestionLog_Remote_LID_CN_Entry, {\r\n"LID CN Entry", "opa.hficongestionsetting.lidcnentry",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_HFICongestionLog_TimeStamp_CN_Entry, {\r\n"TimeStamp CN Entry", "opa.hficongestionsetting.timestampcnentry",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_HFICongestionSetting, {\r\n"HFI Congestion Setting", "opa.hficongestionsetting",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_HFICongestionSetting_Control_Map, {\r\n"Control Map", "opa.hficongestionsetting.controlmap",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_HFICongestionSetting_Port_Control, {\r\n"Port Control", "opa.hficongestionsetting.portcontrol",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_HFICongestionSetting_CCTI_Increase, {\r\n"CCTI Increase", "opa.hficongestionsetting.cctiincrease",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_HFICongestionSetting_CCTI_Timer, {\r\n"CCTI Timer", "opa.hficongestionsetting.cctitimer",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_HFICongestionSetting_TriggerThreshold, {\r\n"Trigger Threshold", "opa.hficongestionsetting.triggerthreshold",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_HFICongestionSetting_CCTI_Min, {\r\n"CCTI Min", "opa.hficongestionsetting.cctimin",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_HFICongestionControlTable, {\r\n"HFI Congestion Control Table", "opa.hficongestioncontroltable",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_HFICongestionControlTable_CCTI_Limit, {\r\n"CCTI Limit", "opa.hficongestioncontroltable.cctilimit",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_HFICongestionControlTable_CCT_Shift, {\r\n"CCT Shift", "opa.hficongestioncontroltable.cctshift",\r\nFT_UINT16, BASE_HEX, NULL, 0xC000, NULL, HFILL }\r\n},\r\n{ &hf_opa_HFICongestionControlTable_CCT_Multiplier, {\r\n"CCT Multiplier", "opa.hficongestioncontroltable.cctmultiplier",\r\nFT_UINT16, BASE_HEX, NULL, 0x3FFF, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfoRecord_LinkDownReason_NeighborLinkDownReason, {\r\n"Neighbor Link Down Reason", "opa.portinforecord.linkdownreason.neighborlinkdownreason",\r\nFT_UINT8, BASE_HEX, VALS(LinkDownReason), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfoRecord_LinkDownReason_LinkDownReason, {\r\n"Link Down Reason", "opa.portinforecord.linkdownreason.linkdownreason",\r\nFT_UINT8, BASE_HEX, VALS(LinkDownReason), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortInfoRecord_LinkDownReason_Timestamp, {\r\n"Time Stamp", "opa.portinforecord.linkdownreason.timestamp",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_InformInfo, {\r\n"Inform Info", "opa.informinfo",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_InformInfo_GID, {\r\n"GID", "opa.informinfo.gid",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_InformInfo_LIDRangeBegin, {\r\n"LID Range Begin", "opa.informinfo.lidrangebegin",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_InformInfo_LIDRangeEnd, {\r\n"LID Range End", "opa.informinfo.lidrangeend",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_InformInfo_IsGeneric, {\r\n"Is Generic", "opa.informinfo.isgeneric",\r\nFT_BOOLEAN, 8, NULL, 0x01, NULL, HFILL }\r\n},\r\n{ &hf_opa_InformInfo_Subscribe, {\r\n"Subscribe", "opa.informinfo.subscribe",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_InformInfo_Type, {\r\n"Type", "opa.informinfo.type",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_InformInfo_TrapNumber, {\r\n"Trap Number", "opa.informinfo.trapnumber",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_InformInfo_DeviceID, {\r\n"Device ID", "opa.informinfo.deviceid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_InformInfo_QPN, {\r\n"QPN", "opa.informinfo.qpn",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_InformInfo_reserved, {\r\n"Reserved (3 bits)", "opa.informinfo.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0xE0, NULL, HFILL }\r\n},\r\n{ &hf_opa_InformInfo_RespTimeValue, {\r\n"Resp Time Value", "opa.informinfo.resptimevalue",\r\nFT_UINT8, BASE_HEX, NULL, 0x1F, NULL, HFILL }\r\n},\r\n{ &hf_opa_InformInfo_ProducerType, {\r\n"Producer Type", "opa.informinfo.producertype",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_InformInfo_VendorID, {\r\n"Vendor ID", "opa.informinfo.vendorid",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_LinkRecord, {\r\n"Link Record", "opa.linkrecord",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_LinkRecord_ToPort, {\r\n"To Port", "opa.linkrecord.toport",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_LinkRecord_ToLID, {\r\n"To LID", "opa.linkrecord.tolid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ServiceRecord, {\r\n"Service Record", "opa.servicerecord",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ServiceRecord_ServiceLease, {\r\n"ServiceLease", "opa.servicerecord.servicelease",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ServiceRecord_ServiceKey, {\r\n"ServiceKey", "opa.servicerecord.servicekey",\r\nFT_BYTES, FT_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ServiceRecord_ServiceName, {\r\n"ServiceName", "opa.servicerecord.servicename",\r\nFT_STRING, STR_ASCII, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ServiceRecord_ServiceData, {\r\n"ServiceData", "opa.servicerecord.servicedata",\r\nFT_BYTES, FT_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ServiceAssociationRecord_ServiceKey, {\r\n"ServiceKey", "opa.serviceassociationrecord.servicekey",\r\nFT_BYTES, FT_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ServiceAssociationRecord_ServiceName, {\r\n"ServiceName", "opa.serviceassociationrecord.servicename",\r\nFT_STRING, STR_ASCII, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord, {\r\n"Path Record", "opa.pathrecord",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_ServiceID, {\r\n"Service ID", "opa.pathrecord.serviceid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_DGID, {\r\n"DGID", "opa.pathrecord.dgid",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_DGID_L2_8B, {\r\n"8B Support", "opa.pathrecord.dgid.8b",\r\nFT_BOOLEAN, 8, NULL, 0x80, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_DGID_L2_10B, {\r\n"10B Support", "opa.pathrecord.dgid.10b",\r\nFT_BOOLEAN, 8, NULL, 0x40, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_DGID_L2_9B, {\r\n"9B Support", "opa.pathrecord.dgid.9b",\r\nFT_BOOLEAN, 8, NULL, 0x20, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_DGID_L2_16B, {\r\n"16B Support", "opa.pathrecord.dgid.16b",\r\nFT_BOOLEAN, 8, NULL, 0x10, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_DGID_L2_reserved, {\r\n"Reserved (4 bits)", "opa.pathrecord.dgid.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x0F, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_DGID_LIDLen, {\r\n"LID Length", "opa.pathrecord.dgid.lidlen",\r\nFT_UINT8, BASE_DEC, VALS(pathrecord_lidlen), 0xC0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_DGID_reserved, {\r\n"Reserved (1 bit)", "opa.pathrecord.dgid.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x20, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_DGID_SL, {\r\n"SL", "opa.pathrecord.dgid.sl",\r\nFT_UINT8, BASE_HEX, NULL, 0x1F, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_DGID_DLIDHigh, {\r\n"DLID High", "opa.pathrecord.dgid.dlidhigh",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_DGID_SLIDHigh, {\r\n"SLID High", "opa.pathrecord.dgid.slidhigh",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_DGID_DestGUID, {\r\n"Dest GUID", "opa.pathrecord.dgid.destguid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_SGID, {\r\n"SGID", "opa.pathrecord.sgid",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_SGID_SubnetPrefix, {\r\n"Subnet Prefix", "opa.pathrecord.sgid.subnetprefix",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_SGID_SourceGUID, {\r\n"Source GUID", "opa.pathrecord.sgid.sourceguid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_DLID, {\r\n"DLID", "opa.pathrecord.dlid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_SLID, {\r\n"SLID", "opa.pathrecord.slid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_RawTraffic, {\r\n"Raw Traffic", "opa.pathrecord.rawtraffic",\r\nFT_UINT32, BASE_HEX, NULL, 0x80000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_reserved, {\r\n"Reserved (3 bits)", "opa.pathrecord.reserved",\r\nFT_UINT32, BASE_HEX, NULL, 0x70000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_FlowLabel, {\r\n"Flow Label", "opa.pathrecord.flowlabel",\r\nFT_UINT32, BASE_HEX, NULL, 0x0FFFFF00, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_HopLimit, {\r\n"Hop Limit", "opa.pathrecord.hoplimit",\r\nFT_UINT32, BASE_HEX, NULL, 0x000000FF, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_TClass, {\r\n"T Class", "opa.pathrecord.tclass",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_Reversible, {\r\n"Reversible", "opa.pathrecord.reversible",\r\nFT_BOOLEAN, 8, NULL, 0x80, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_NumbPath, {\r\n"Numb Path", "opa.pathrecord.numbpath",\r\nFT_UINT8, BASE_HEX, NULL, 0x7F, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_P_Key, {\r\n"P_Key", "opa.pathrecord.p_key",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_QosType, {\r\n"Qos Type", "opa.pathrecord.qostype",\r\nFT_UINT16, BASE_HEX, NULL, 0xC000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_reserved2, {\r\n"Reserved (2 bits)", "opa.pathrecord.reserved2",\r\nFT_UINT16, BASE_HEX, NULL, 0x3000, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_QosPriority, {\r\n"Qos Priority", "opa.pathrecord.qospriority",\r\nFT_UINT16, BASE_HEX, NULL, 0x0FF0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_SL, {\r\n"SL", "opa.pathrecord.sl",\r\nFT_UINT16, BASE_HEX, NULL, 0x000F, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_MTUSelector, {\r\n"MTU Selector", "opa.pathrecord.mtuselector",\r\nFT_UINT8, BASE_HEX, NULL, 0xC0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_MTU, {\r\n"MTU", "opa.pathrecord.mtu",\r\nFT_UINT8, BASE_HEX, VALS(MTU), 0x3F, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_RateSelector, {\r\n"Rate Selector", "opa.pathrecord.rateselector",\r\nFT_UINT8, BASE_HEX, NULL, 0xC0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_Rate, {\r\n"Rate", "opa.pathrecord.rate",\r\nFT_UINT8, BASE_HEX, NULL, 0x3F, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_PacketLifeTimeSelector, {\r\n"Packet Life Time Selector", "opa.pathrecord.packetlifetimeselector",\r\nFT_UINT8, BASE_HEX, NULL, 0xC0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_PacketLifeTime, {\r\n"Packet Life Time", "opa.pathrecord.packetlifetime",\r\nFT_UINT8, BASE_HEX, NULL, 0x3F, NULL, HFILL }\r\n},\r\n{ &hf_opa_PathRecord_Preference, {\r\n"Preference", "opa.pathrecord.preference",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MCMemberRecord, {\r\n"MC Member Record", "opa.mcmemberrecord",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MCMemberRecord_Q_Key, {\r\n"Q_Key", "opa.mcmemberrecord.q_key",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MCMemberRecord_MLID, {\r\n"MLID", "opa.mcmemberrecord.mlid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MCMemberRecord_MTUSelector, {\r\n"MTU Selector", "opa.mcmemberrecord.mtuselector",\r\nFT_UINT8, BASE_HEX, NULL, 0xC0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MCMemberRecord_MTU, {\r\n"MTU", "opa.mcmemberrecord.mtu",\r\nFT_UINT8, BASE_HEX, VALS(MTU), 0x3F, NULL, HFILL }\r\n},\r\n{ &hf_opa_MCMemberRecord_TClass, {\r\n"T Class", "opa.mcmemberrecord.tclass",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MCMemberRecord_P_Key, {\r\n"P_Key", "opa.mcmemberrecord.p_key",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MCMemberRecord_RateSelector, {\r\n"Rate Selector", "opa.mcmemberrecord.rateselector",\r\nFT_UINT8, BASE_HEX, NULL, 0xC0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MCMemberRecord_Rate, {\r\n"Rate", "opa.mcmemberrecord.rate",\r\nFT_UINT8, BASE_HEX, NULL, 0x3F, NULL, HFILL }\r\n},\r\n{ &hf_opa_MCMemberRecord_PacketLifeTimeSelector, {\r\n"Packet Life Time Selector", "opa.mcmemberrecord.packetlifetimeselector",\r\nFT_UINT8, BASE_HEX, NULL, 0xC0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MCMemberRecord_PacketLifeTime, {\r\n"Packet Life Time", "opa.mcmemberrecord.packetlifetime",\r\nFT_UINT8, BASE_HEX, NULL, 0x3F, NULL, HFILL }\r\n},\r\n{ &hf_opa_MCMemberRecord_SL, {\r\n"SL", "opa.mcmemberrecord.sl",\r\nFT_UINT32, BASE_HEX, NULL, 0xF8000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_MCMemberRecord_reserved, {\r\n"Reserved (19 bits)", "opa.mcmemberrecord.reserved",\r\nFT_UINT32, BASE_HEX, NULL, 0x07FFFF00, NULL, HFILL }\r\n},\r\n{ &hf_opa_MCMemberRecord_HopLimit, {\r\n"Hop Limit", "opa.mcmemberrecord.hoplimit",\r\nFT_UINT32, BASE_HEX, NULL, 0x000000FF, NULL, HFILL }\r\n},\r\n{ &hf_opa_MCMemberRecord_Scope, {\r\n"Scope", "opa.mcmemberrecord.scope",\r\nFT_UINT8, BASE_HEX, NULL, 0xF0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MCMemberRecord_reserved2, {\r\n"Reserved (1 bit)", "opa.mcmemberrecord.reserved2",\r\nFT_UINT8, BASE_HEX, NULL, 0x08, NULL, HFILL }\r\n},\r\n{ &hf_opa_MCMemberRecord_JoinSendOnlyMember, {\r\n"Join Send Only Member", "opa.mcmemberrecord.joinsendonlymember",\r\nFT_UINT8, BASE_HEX, NULL, 0x04, NULL, HFILL }\r\n},\r\n{ &hf_opa_MCMemberRecord_JoinNonMember, {\r\n"Join Non Member", "opa.mcmemberrecord.joinnonmember",\r\nFT_UINT8, BASE_HEX, NULL, 0x04, NULL, HFILL }\r\n},\r\n{ &hf_opa_MCMemberRecord_JoinFullMember, {\r\n"Join Full Member", "opa.mcmemberrecord.joinfullmember",\r\nFT_UINT8, BASE_HEX, NULL, 0x04, NULL, HFILL }\r\n},\r\n{ &hf_opa_MCMemberRecord_ProxyJoin, {\r\n"Proxy Join", "opa.mcmemberrecord.proxyjoin",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL }\r\n},\r\n{ &hf_opa_MCMemberRecord_reserved3, {\r\n"Reserved (7 bits)", "opa.mcmemberrecord.reserved3",\r\nFT_UINT8, BASE_HEX, NULL, 0x7F, NULL, HFILL }\r\n},\r\n{ &hf_opa_TraceRecord, {\r\n"Trace Record", "opa.tracerecord",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_TraceRecord_IDGeneration, {\r\n"ID Generation", "opa.tracerecord.idgeneration",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_TraceRecord_NodeType, {\r\n"Node Type", "opa.tracerecord.nodetype",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_TraceRecord_NodeID, {\r\n"Node ID", "opa.tracerecord.nodeid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_TraceRecord_ChassisID, {\r\n"Chassis ID", "opa.tracerecord.chassisid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_TraceRecord_EntryPortID, {\r\n"Entry Port ID", "opa.tracerecord.entryportid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_TraceRecord_ExitPortID, {\r\n"Exit Port ID", "opa.tracerecord.exitportid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_TraceRecord_EntryPort, {\r\n"Entry Port", "opa.tracerecord.entryport",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_TraceRecord_ExitPort, {\r\n"Exit Port", "opa.tracerecord.exitport",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord, {\r\n"Multi Path Record", "opa.multipathrecord",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_reserved, {\r\n"Reserved (4 bits)", "opa.multipathrecord.reserved",\r\nFT_UINT32, BASE_HEX, NULL, 0xF0000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_FlowLabel, {\r\n"Flow Label", "opa.multipathrecord.flowlabel",\r\nFT_UINT32, BASE_HEX, NULL, 0x0FFFFF00, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_HopLimit, {\r\n"Hop Limit", "opa.multipathrecord.hoplimit",\r\nFT_UINT32, BASE_HEX, NULL, 0x000000FF, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_TClass, {\r\n"T Class", "opa.multipathrecord.tclass",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_Reversible, {\r\n"Reversible", "opa.multipathrecord.reversible",\r\nFT_BOOLEAN, 8, NULL, 0x80, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_NumbPath, {\r\n"Numb Path", "opa.multipathrecord.numbpath",\r\nFT_UINT8, BASE_HEX, NULL, 0x7F, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_P_Key, {\r\n"P_Key", "opa.multipathrecord.p_key",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_QoSType, {\r\n"QoS Type", "opa.multipathrecord.qostype",\r\nFT_UINT16, BASE_HEX, NULL, 0xC000, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_QoSPriority, {\r\n"QoS Priority", "opa.multipathrecord.qospriority",\r\nFT_UINT16, BASE_HEX, NULL, 0x3FC0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_reserved2, {\r\n"Reserved (1 bit)", "opa.multipathrecord.reserved2",\r\nFT_UINT16, BASE_HEX, NULL, 0x0020, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_SL, {\r\n"SL", "opa.multipathrecord.sl",\r\nFT_UINT16, BASE_HEX, NULL, 0x001F, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_MTUSelector, {\r\n"MTU Selector", "opa.multipathrecord.mtuselector",\r\nFT_UINT8, BASE_HEX, NULL, 0xC0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_MTU, {\r\n"MTU", "opa.multipathrecord.mtu",\r\nFT_UINT8, BASE_HEX, VALS(MTU), 0x3F, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_RateSelector, {\r\n"Rate Selector", "opa.multipathrecord.rateselector",\r\nFT_UINT8, BASE_HEX, NULL, 0xC0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_Rate, {\r\n"Rate", "opa.multipathrecord.rate",\r\nFT_UINT8, BASE_HEX, NULL, 0x3F, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_PacketLifeTimeSelector, {\r\n"Packet Life Time Selector", "opa.multipathrecord.packetlifetimeselector",\r\nFT_UINT8, BASE_HEX, NULL, 0xC0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_PacketLifeTime, {\r\n"Packet Life Time", "opa.multipathrecord.packetlifetime",\r\nFT_UINT8, BASE_HEX, NULL, 0x3F, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_IndependenceSelector, {\r\n"Independence Selector", "opa.multipathrecord.independenceselector",\r\nFT_UINT8, BASE_HEX, NULL, 0xC0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_SGIDScope, {\r\n"SGID Scope", "opa.multipathrecord.sgidscope",\r\nFT_UINT8, BASE_HEX, NULL, 0x38, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_DGIDScope, {\r\n"DGID Scope", "opa.multipathrecord.dgidscope",\r\nFT_UINT8, BASE_HEX, NULL, 0x07, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_SGIDCount, {\r\n"SGID Count", "opa.multipathrecord.sgidcount",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_DGIDCount, {\r\n"DGID Count", "opa.multipathrecord.dgidcount",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_SGID, {\r\n"Source GID", "opa.multipathrecord.sgid",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_DGID, {\r\n"Dest GID", "opa.multipathrecord.dgid",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_L2_8B, {\r\n"8B Support", "opa.multipathrecord.l2_8b",\r\nFT_BOOLEAN, 8, NULL, 0x80, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_L2_10B, {\r\n"10B Support", "opa.multipathrecord.l2_10b",\r\nFT_BOOLEAN, 8, NULL, 0x40, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_L2_9B, {\r\n"9B Support", "opa.multipathrecord.l2_9b",\r\nFT_BOOLEAN, 8, NULL, 0x20, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_L2_16B, {\r\n"16B Support", "opa.multipathrecord.l2_16b",\r\nFT_BOOLEAN, 8, NULL, 0x10, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_reserved3, {\r\n"Reserved (4 bits)", "opa.multipathrecord.reserved3",\r\nFT_UINT8, BASE_HEX, NULL, 0x0F, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_ServiceID, {\r\n"Service ID", "opa.multipathrecord.serviceid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_SubnetPrefix, {\r\n"SubnetPrefix", "opa.multipathrecord.subnetprefix",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_SGUIDScope, {\r\n"SGUIDScope", "opa.multipathrecord.sguidscope",\r\nFT_UINT8, BASE_HEX, NULL, 0x38, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_DGUIDScope, {\r\n"DGUIDScope", "opa.multipathrecord.dguidscope",\r\nFT_UINT8, BASE_HEX, NULL, 0x07, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_SGUIDCount, {\r\n"SGUIDCount", "opa.multipathrecord.sguidcount",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_DGUIDCount, {\r\n"DGUIDCount", "opa.multipathrecord.dguidcount",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_SGUID, {\r\n"Source GUID", "opa.multipathrecord.sguid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_DGUID, {\r\n"Dest GUID", "opa.multipathrecord.dguid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_SLIDCount, {\r\n"SLIDCount", "opa.multipathrecord.slidcount",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_DLIDCount, {\r\n"DLIDCount", "opa.multipathrecord.dlidcount",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_SLID, {\r\n"Source LID", "opa.multipathrecord.slid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MultiPathRecord_DLID, {\r\n"Dest LID", "opa.multipathrecord.dlid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_CableInfoRecord, {\r\n"Cable Info Record", "opa.cableinforecord",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_CableInfoRecord_Lid, {\r\n"LID", "opa.cableinforecord.lid",\r\nFT_UINT32, BASE_HEX, NULL, 0xFE, NULL, HFILL }\r\n},\r\n{ &hf_opa_CableInfoRecord_Port, {\r\n"Port", "opa.cableinforecord.port",\r\nFT_UINT8, BASE_HEX, NULL, 0xFE, NULL, HFILL }\r\n},\r\n{ &hf_opa_CableInfoRecord_Length, {\r\n"Length", "opa.cableinforecord.length",\r\nFT_UINT8, BASE_HEX, NULL, 0xFE, NULL, HFILL }\r\n},\r\n{ &hf_opa_CableInfoRecord_reserved, {\r\n"Reserved (1 bit)", "opa.cableinforecord.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x01, NULL, HFILL }\r\n},\r\n{ &hf_opa_CableInfoRecord_Address, {\r\n"Address", "opa.cableinforecord.address",\r\nFT_UINT16, BASE_HEX, NULL, 0xFFF0, NULL, HFILL }\r\n},\r\n{ &hf_opa_CableInfoRecord_PortType, {\r\n"LID", "opa.cableinforecord.porttype",\r\nFT_UINT16, BASE_HEX, NULL, 0x000F, NULL, HFILL }\r\n},\r\n{ &hf_opa_CableInfoRecord_Data, {\r\n"LID", "opa.cableinforecord.data",\r\nFT_BYTES, FT_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus, {\r\n"Port Status", "opa.pm.portstatus",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortNumber, {\r\n"Port Number", "opa.pm.portstatus.portnumber",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_VLSelectMask, {\r\n"VL Select Mask", "opa.pm.portstatus.vlselectmask",\r\nFT_UINT32, BASE_CUSTOM, CF_FUNC(cf_opa_mad_32b_mask), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortXmitData, {\r\n"PortXmitData", "opa.pm.portstatus.portxmitdata",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortRcvData, {\r\n"PortRcvData", "opa.pm.portstatus.portrcvdata",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortXmitPkts, {\r\n"PortXmitPkts", "opa.pm.portstatus.portxmitpkts",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortRcvPkts, {\r\n"PortRcvPkts", "opa.pm.portstatus.portrcvpkts",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortMulticastXmitPkts, {\r\n"PortMulticastXmitPkts", "opa.pm.portstatus.portmulticastxmitpkts",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortMulticastRcvPkts, {\r\n"PortMulticastRcvPkts", "opa.pm.portstatus.portmulticastrcvpkts",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortXmitWait, {\r\n"PortXmitWait", "opa.pm.portstatus.portxmitwait",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_SwPortCongestion, {\r\n"SwPortCongestion", "opa.pm.portstatus.swportcongestion",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortRcvFECN, {\r\n"PortRcvFECN", "opa.pm.portstatus.portrecvfecn",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortRcvBECN, {\r\n"PortRcvBECN", "opa.pm.portstatus.portrecvbecn",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortXmitTimeCong, {\r\n"PortXmitTimeCong", "opa.pm.portstatus.portxmittimecong",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortXmitWastedBW, {\r\n"PortXmitWastedBW", "opa.pm.portstatus.portxmitwastedbw",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortXmitWaitData, {\r\n"PortXmitWaitData", "opa.pm.portstatus.portxmitwaitdata",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortRcvBubble, {\r\n"PortRcvBubble", "opa.pm.portstatus.portrcvbubble",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortMarkFECN, {\r\n"PortMarkFECN", "opa.pm.portstatus.portmarkfecn",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortRcvConstraintErrors, {\r\n"PortRcvConstraintErrors", "opa.pm.portstatus.portrcvconstrainterrors",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortRcvSwitchRelayErrors, {\r\n"PortRcvSwitchRelayErrors", "opa.pm.portstatus.portrcvswitchrelayerrors",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortXmitDiscards, {\r\n"PortXmitDiscards", "opa.pm.portstatus.portxmitdiscards",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortXmitConstraintErrors, {\r\n"PortXmitConstraintErrors", "opa.pm.portstatus.portxmitconstrainterrors",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortRcvRemotePhysicalErrors, {\r\n"PortRcvRemotePhysicalErrors", "opa.pm.portstatus.portrcvremotephysicalerrors",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_LocalLinkIntegrityErrors, {\r\n"LocalLinkIntegrityErrors", "opa.pm.portstatus.locallinkintegrityerrors",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortRcvErrors, {\r\n"PortRcvErrors", "opa.pm.portstatus.portrcverrors",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_ExcessiveBufferOverruns, {\r\n"ExcessiveBufferOverruns", "opa.pm.portstatus.excessivebufferoverruns",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_FMConfigErrors, {\r\n"FMConfigErrors", "opa.pm.portstatus.fmconfigerrors",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_LinkErrorRecovery, {\r\n"LinkErrorRecovery", "opa.pm.portstatus.linkerrorrecovery",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_LinkDowned, {\r\n"LinkDowned", "opa.pm.portstatus.linkdowned",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_UncorrectableErrors, {\r\n"UncorrectableErrors", "opa.pm.portstatus.uncorrectableerrors",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_reserved, {\r\n"Reserved", "opa.pm.portstatus.reserved",\r\nFT_UINT8, BASE_DEC, NULL, 0xF8, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_LinkQualityIndicator, {\r\n"LinkQualityIndicator", "opa.pm.portstatus.linkqualityindicator",\r\nFT_UINT8, BASE_DEC, VALS(LinkQualityIndicator), 0x07, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortVLXmitData, {\r\n"PortVLXmitData", "opa.pm.portstatus.vl.xmitdata",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortVLRcvData, {\r\n"PortVLRcvData", "opa.pm.portstatus.vl.rcvdata",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortVLXmitPkts, {\r\n"PortVLXmitPkts", "opa.pm.portstatus.vl.xmitpkts",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortVLRcvPkts, {\r\n"PortVLRcvPkts", "opa.pm.portstatus.vl.rcvpkts",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortVLXmitWait, {\r\n"PortVLXmitWait", "opa.pm.portstatus.vl.xmitwait",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_SwPortVLCongestion, {\r\n"SwPortVLCongestion", "opa.pm.portstatus.vl.swcongestion",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortVLRcvFECN, {\r\n"PortVLRcvFECN", "opa.pm.portstatus.vl.rcvfecn",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortVLRcvBECN, {\r\n"PortVLRcvBECN", "opa.pm.portstatus.vl.rcvbecn",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortVLXmitTimeCong, {\r\n"PortVLXmitTimeCong", "opa.pm.portstatus.vl.xmittimecong",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortVLXmitWastedBW, {\r\n"PortVLXmitWastedBW", "opa.pm.portstatus.vl.xmitwastedbw",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortVLXmitWaitData, {\r\n"PortVLXmitWaitData", "opa.pm.portstatus.vl.xmitwaitdata",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortVLRcvBubble, {\r\n"PortVLRcvBubble", "opa.pm.portstatus.vl.rcvbubble",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortVLMarkFECN, {\r\n"PortVLMarkFECN", "opa.pm.portstatus.vl.markfecn",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PortStatus_PortVLXmitDiscards, {\r\n"PortVLXmitDiscards", "opa.pm.portstatus.vl.xmitdiscards",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus, {\r\n"Clear Port Status", "opa.pm.clearportstatus",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_PortSelectMask, {\r\n"Port Select Mask", "opa.pm.clearportstatus.portselectmask",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_CounterSelectMask, {\r\n"CounterSelectMask", "opa.pm.clearportstatus.counterselectmask",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_PortXmitData, {\r\n"PortXmitData", "opa.pm.clearportstatus.portxmitdata",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x80000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_PortRcvData, {\r\n"PortRcvData", "opa.pm.clearportstatus.portrcvdata",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x40000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_PortXmitPkts, {\r\n"PortXmitPkts", "opa.pm.clearportstatus.portxmitpkts",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x20000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_PortRcvPkts, {\r\n"PortRcvPkts", "opa.pm.clearportstatus.portrcvpkts",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x10000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_PortMulticastXmitPkts, {\r\n"PortMulticastXmitPkts", "opa.pm.clearportstatus.portmulticastxmitpkts",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x08000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_PortMulticastRcvPkts, {\r\n"PortMulticastRcvPkts", "opa.pm.clearportstatus.portmulticastrcvpkts",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x04000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_PortXmitWait, {\r\n"PortXmitWait", "opa.pm.clearportstatus.portxmitwait",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x02000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_SwPortCongestion, {\r\n"SwPortCongestion", "opa.pm.clearportstatus.swportcongestion",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x01000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_PortRcvFECN, {\r\n"PortRcvFECN", "opa.pm.clearportstatus.portrecvfecn",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00800000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_PortRcvBECN, {\r\n"PortRcvBECN", "opa.pm.clearportstatus.portrecvbecn",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00400000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_PortXmitTimeCong, {\r\n"PortXmitTimeCong", "opa.pm.clearportstatus.portxmittimecong",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00200000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_PortXmitWastedBW, {\r\n"PortXmitWastedBW", "opa.pm.clearportstatus.portxmitwastedbw",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00100000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_PortXmitWaitData, {\r\n"PortXmitWaitData", "opa.pm.clearportstatus.portxmitwaitdata",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00080000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_PortRcvBubble, {\r\n"PortRcvBubble", "opa.pm.clearportstatus.portrcvbubble",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00040000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_PortMarkFECN, {\r\n"PortMarkFECN", "opa.pm.clearportstatus.portmarkfecn",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00020000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_PortRcvConstraintErrors, {\r\n"PortRcvConstraintErrors", "opa.pm.clearportstatus.portrcvconstrainterrors",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00010000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_PortRcvSwitchRelayErrors, {\r\n"PortRcvSwitchRelayErrors", "opa.pm.clearportstatus.portrcvswitchrelayerrors",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00008000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_PortXmitDiscards, {\r\n"PortXmitDiscards", "opa.pm.clearportstatus.portxmitdiscards",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00004000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_PortXmitConstraintErrors, {\r\n"PortXmitConstraintErrors", "opa.pm.clearportstatus.portxmitconstrainterrors",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00002000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_PortRcvRemotePhysicalErrors, {\r\n"PortRcvRemotePhysicalErrors", "opa.pm.clearportstatus.portrcvremotephysicalerrors",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00001000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_LocalLinkIntegrityErrors, {\r\n"LocalLinkIntegrityErrors", "opa.pm.clearportstatus.locallinkintegrityerrors",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00000800, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_PortRcvErrors, {\r\n"PortRcvErrors", "opa.pm.clearportstatus.portrcverrors",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00000400, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_ExcessiveBufferOverruns, {\r\n"ExcessiveBufferOverruns", "opa.pm.clearportstatus.excessivebufferoverruns",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00000200, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_FMConfigErrors, {\r\n"FMConfigErrors", "opa.pm.clearportstatus.fmconfigerrors",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00000100, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_LinkErrorRecovery, {\r\n"LinkErrorRecovery", "opa.pm.clearportstatus.linkerrorrecovery",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00000080, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_LinkDowned, {\r\n"LinkDowned", "opa.pm.clearportstatus.linkdowned",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00000040, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_UncorrectableErrors, {\r\n"UncorrectableErrors", "opa.pm.clearportstatus.uncorrectableerrors",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00000020, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortStatus_reserved, {\r\n"Reserved (5 bits)", "opa.pm.clearportstatus.reserved",\r\nFT_UINT32, BASE_DEC, NULL, 0x0000001F, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters, {\r\n"Data Port Counters", "opa.pm.dataportcounters",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortSelectMask, {\r\n"Port Select Mask", "opa.pm.dataportcounters.portselectmask",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_VLSelectMask, {\r\n"VL Select Mask", "opa.pm.dataportcounters.vlselectmask",\r\nFT_UINT32, BASE_CUSTOM, CF_FUNC(cf_opa_mad_32b_mask), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_resolution_reserved, {\r\n"Reserved (24 bits)", "opa.pm.dataportcounters.reserved",\r\nFT_UINT32, BASE_HEX, NULL, 0xFFFFFF00, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_LocalLinkIntegrityResolution, {\r\n"Local Link Integrity Resolution", "opa.pm.dataportcounters.locallinkintegrityresolution",\r\nFT_UINT32, BASE_DEC, NULL, 0x000000F0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_LinkErrorRecoveryResolution, {\r\n"Link Error Recovery Resolution", "opa.pm.dataportcounters.linkerrorrecoveryresolution",\r\nFT_UINT32, BASE_DEC, NULL, 0x0000000F, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortNumber, {\r\n"PortNumber", "opa.pm.dataportcounters.portnumber",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_lqi_reserved, {\r\n"Reserved (29 bits)", "opa.pm.dataportcounters.reserved",\r\nFT_UINT32, BASE_DEC, NULL, 0xFFFFFFF8, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_LinkQualityIndicator, {\r\n"LinkQualityIndicator", "opa.pm.dataportcounters.linkqualityindicator",\r\nFT_UINT32, BASE_DEC, VALS(LinkQualityIndicator), 0x00000007, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortXmitData, {\r\n"PortXmitData", "opa.pm.dataportcounters.portxmitdata",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortRcvData, {\r\n"PortRcvData", "opa.pm.dataportcounters.portrcvdata",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortXmitPkts, {\r\n"PortXmitPkts", "opa.pm.dataportcounters.portxmitpkts",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortRcvPkts, {\r\n"PortRcvPkts", "opa.pm.dataportcounters.portrcvpkts",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortMulticastXmitPkts, {\r\n"PortMulticastXmitPkts", "opa.pm.dataportcounters.portmulticastxmitpkts",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortMulticastRcvPkts, {\r\n"PortMulticastRcvPkts", "opa.pm.dataportcounters.portmulticastrcvpkts",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortXmitWait, {\r\n"PortXmitWait", "opa.pm.dataportcounters.portxmitwait",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_SwPortCongestion, {\r\n"SwPortCongestion", "opa.pm.dataportcounters.swportcongestion",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortRcvFECN, {\r\n"PortRcvFECN", "opa.pm.dataportcounters.portrecvfecn",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortRcvBECN, {\r\n"PortRcvBECN", "opa.pm.dataportcounters.portrecvbecn",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortXmitTimeCong, {\r\n"PortXmitTimeCong", "opa.pm.dataportcounters.portxmittimecong",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortXmitWastedBW, {\r\n"PortXmitWastedBW", "opa.pm.dataportcounters.portxmitwastedbw",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortXmitWaitData, {\r\n"PortXmitWaitData", "opa.pm.dataportcounters.portxmitwaitdata",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortRcvBubble, {\r\n"PortRcvBubble", "opa.pm.dataportcounters.portrcvbubble",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortMarkFECN, {\r\n"PortMarkFECN", "opa.pm.dataportcounters.portmarkfecn",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortErrorCounterSummary, {\r\n"PortErrorCounterSummary", "opa.pm.dataportcounters.porterrorcountersummary",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortVLXmitData, {\r\n"PortVLXmitData", "opa.pm.dataportcounters.vl.xmitdata",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortVLRcvData, {\r\n"PortVLRcvData", "opa.pm.dataportcounters.vl.rcvdata",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortVLXmitPkts, {\r\n"PortVLXmitPkts", "opa.pm.dataportcounters.vl.xmitpkts",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortVLRcvPkts, {\r\n"PortVLRcvPkts", "opa.pm.dataportcounters.vl.rcvpkts",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortVLXmitWait, {\r\n"PortVLXmitWait", "opa.pm.dataportcounters.vl.xmitwait",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_SwPortVLCongestion, {\r\n"SwPortVLCongestion", "opa.pm.dataportcounters.vl.swcongestion",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortVLRcvFECN, {\r\n"PortVLRcvFECN", "opa.pm.dataportcounters.vl.rcvfecn",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortVLRcvBECN, {\r\n"PortVLRcvBECN", "opa.pm.dataportcounters.vl.rcvbecn",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortVLXmitTimeCong, {\r\n"PortVLXmitTimeCong", "opa.pm.dataportcounters.vl.xmittimecong",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortVLXmitWastedBW, {\r\n"PortVLXmitWastedBW", "opa.pm.dataportcounters.vl.xmitwastedbw",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortVLXmitWaitData, {\r\n"PortVLXmitWaitData", "opa.pm.dataportcounters.vl.xmitwaitdata",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortVLRcvBubble, {\r\n"PortVLRcvBubble", "opa.pm.dataportcounters.vl.rcvbubble",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_DataPortCounters_PortVLMarkFECN, {\r\n"PortVLMarkFECN", "opa.pm.dataportcounters.vl.markfecn",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortCounters, {\r\n"Error Port Counters", "opa.pm.errorportcounters",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortCounters_PortSelectMask, {\r\n"Port Select Mask", "opa.pm.errorportcounters.portselectmask",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortCounters_VLSelectMask, {\r\n"VL Select Mask", "opa.pm.errorportcounters.vlselectmask",\r\nFT_UINT32, BASE_CUSTOM, CF_FUNC(cf_opa_mad_32b_mask), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortCounters_PortNumber, {\r\n"PortNumber", "opa.pm.errorportcounters.portnumber",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortCounters_PortRcvConstraintErrors, {\r\n"PortRcvConstraintErrors", "opa.pm.errorportcounters.portrcvconstrainterrors",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortCounters_PortRcvSwitchRelayErrors, {\r\n"PortRcvSwitchRelayErrors", "opa.pm.errorportcounters.portrcvswitchrelayerrors",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortCounters_PortXmitDiscards, {\r\n"PortXmitDiscards", "opa.pm.errorportcounters.portxmitdiscards",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortCounters_PortXmitConstraintErrors, {\r\n"PortXmitConstraintErrors", "opa.pm.errorportcounters.portxmitconstrainterrors",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortCounters_PortRcvRemotePhysicalErrors, {\r\n"PortRcvRemotePhysicalErrors", "opa.pm.errorportcounters.portrcvremotephysicalerrors",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortCounters_LocalLinkIntegrityErrors, {\r\n"LocalLinkIntegrityErrors", "opa.pm.errorportcounters.locallinkintegrityerrors",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortCounters_PortRcvErrors, {\r\n"PortRcvErrors", "opa.pm.errorportcounters.portrcverrors",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortCounters_ExcessiveBufferOverruns, {\r\n"ExcessiveBufferOverruns", "opa.pm.errorportcounters.excessivebufferoverruns",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortCounters_FMConfigErrors, {\r\n"FMConfigErrors", "opa.pm.errorportcounters.fmconfigerrors",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortCounters_LinkErrorRecovery, {\r\n"LinkErrorRecovery", "opa.pm.errorportcounters.linkerrorrecovery",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortCounters_LinkDowned, {\r\n"LinkDowned", "opa.pm.errorportcounters.linkdowned",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortCounters_UncorrectableErrors, {\r\n"UncorrectableErrors", "opa.pm.errorportcounters.uncorrectableerrors",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortCounters_PortVLXmitDiscards, {\r\n"PortVLXmitDiscards", "opa.pm.errorportcounters.portvlxmitdiscards",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo, {\r\n"Error Port Info", "opa.pm.errorportinfo",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_PortSelectMask, {\r\n"Port Select Mask", "opa.pm.errorportinfo.portselectmask",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_ErrorInfoSelectMask_PortRcvErrorInfo, {\r\n"Port Rcv Error Info", "opa.pm.errorportinfo.errorinfoselectmask.portrcverrorinfo",\r\nFT_BOOLEAN, 32, NULL, 0x80000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_ErrorInfoSelectMask_ExcessiveBufferOverrunInfo, {\r\n"ExcessiveBufferOverrunInfo", "opa.pm.errorportinfo.errorinfoselectmask.excessivebufferoverruninfo",\r\nFT_BOOLEAN, 32, NULL, 0x40000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_ErrorInfoSelectMask_PortXmitConstraintErrorInfo, {\r\n"PortXmitConstraintErrorInfo", "opa.pm.errorportinfo.errorinfoselectmask.portxmitconstrainterrorinfo",\r\nFT_BOOLEAN, 32, NULL, 0x20000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_ErrorInfoSelectMask_PortRcvConstraintErrorInfo, {\r\n"PortRcvConstraintErrorInfo", "opa.pm.errorportinfo.errorinfoselectmask.portrcvconstrainterrorinfo",\r\nFT_BOOLEAN, 32, NULL, 0x10000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_ErrorInfoSelectMask_PortRcvSwitchRelayErrorInfo, {\r\n"PortRcvSwitchRelayErrorInfo", "opa.pm.errorportinfo.errorinfoselectmask.portrcvswitchrelayerrorinfo",\r\nFT_BOOLEAN, 32, NULL, 0x08000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_ErrorInfoSelectMask_UncorrectableErrorInfo, {\r\n"UncorrectableErrorInfo", "opa.pm.errorportinfo.errorinfoselectmask.uncorrectableerrorinfo",\r\nFT_BOOLEAN, 32, NULL, 0x04000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_ErrorInfoSelectMask_FMConfigErrorInfo, {\r\n"Fmconfigerrorinfo", "opa.pm.errorportinfo.errorinfoselectmask.fmconfigerrorinfo",\r\nFT_BOOLEAN, 32, NULL, 0x02000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_ErrorInfoSelectMask_reserved, {\r\n"Reserved (25 bits)", "opa.pm.errorportinfo.errorinfoselectmask.reserved",\r\nFT_UINT32, BASE_HEX, NULL, 0x01FFFFFF, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_PortNumber, {\r\n"Port Number", "opa.pm.errorportinfo.Portnumber",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_PortRcvErrorInfo_Status, {\r\n"Status", "opa.pm.errorportinfo.portrcverrorinfo.status",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_PortRcvErrorInfo_reserved, {\r\n"Reserved", "opa.pm.errorportinfo.portrcverrorinfo.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x70, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_PortRcvErrorInfo_ErrorCode, {\r\n"ErrorCode", "opa.pm.errorportinfo.portrcverrorinfo.errorcode",\r\nFT_UINT8, BASE_HEX, NULL, 0x0F, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_PortRcvErrorInfo_PacketFlit1, {\r\n"PacketFlit1", "opa.pm.errorportinfo.portrcverrorinfo.packetflit1",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_PortRcvErrorInfo_PacketFlit2, {\r\n"PacketFlit2", "opa.pm.errorportinfo.portrcverrorinfo.packetflit2",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_PortRcvErrorInfo_Flit1Bits, {\r\n"Flit1Bits", "opa.pm.errorportinfo.portrcverrorinfo.flit1bits",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_PortRcvErrorInfo_Flit2Bits, {\r\n"Flit2Bits", "opa.pm.errorportinfo.portrcverrorinfo.flit2bits",\r\nFT_UINT8, BASE_HEX, NULL, 0x40, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_PortRcvErrorInfo_reserved2, {\r\n"Reserved (4 bits)", "opa.pm.errorportinfo.portrcverrorinfo.reserved2",\r\nFT_UINT8, BASE_HEX, NULL, 0x3F, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_PortRcvErrorInfo_PacketBytes, {\r\n"PacketBytes", "opa.pm.errorportinfo.portrcverrorinfo.packetbytes",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_PortRcvErrorInfo_FlitBits, {\r\n"FlitBits", "opa.pm.errorportinfo.portrcverrorinfo.flitbits",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_PortRcvErrorInfo_reserved3, {\r\n"Reserved (6 bits)", "opa.pm.errorportinfo.portrcverrorinfo.reserved3",\r\nFT_UINT8, BASE_HEX, NULL, 0x7F, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_PortRcvErrorInfo_reserved4, {\r\n"Reserved (17 bytes)", "opa.pm.errorportinfo.portrcverrorinfo.reserved4",\r\nFT_BYTES, FT_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_ExcessiveBufferOverrunErrorInfo_Status, {\r\n"Status", "opa.pm.errorportinfo.excessivebufferoverrunerrorinfo.status",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_ExcessiveBufferOverrunErrorInfo_SC, {\r\n"SC", "opa.pm.errorportinfo.excessivebufferoverrunerrorinfo.sc",\r\nFT_UINT8, BASE_HEX, NULL, 0x7C, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_ExcessiveBufferOverrunErrorInfo_reserved, {\r\n"Reserved (2 bits)", "opa.pm.errorportinfo.ExcessiveBufferOverrunErrorInfo.Reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x03, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_PortXmitConstraintErrorInfo_Status, {\r\n"Status", "opa.pm.errorportinfo.portxmitconstrainterrorinfo.status",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_PortXmitConstraintErrorInfo_reserved, {\r\n"Reserved (7 bits)", "opa.pm.errorportinfo.portxmitconstrainterrorinfo.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x7F, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_PortXmitConstraintErrorInfo_P_Key, {\r\n"P_Key", "opa.pm.errorportinfo.portxmitconstrainterrorinfo.pkey",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_PortXmitConstraintErrorInfo_SLID, {\r\n"SLID", "opa.pm.errorportinfo.portxmitconstrainterrorinfo.slid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_PortRcvConstraintErrorInfo_Status, {\r\n"Status", "opa.pm.errorportinfo.portrcvconstrainterrorinfo.status",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_PortRcvConstraintErrorInfo_reserved, {\r\n"Reserved (7 bits)", "opa.pm.errorportinfo.portrcvconstrainterrorinfo.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x7F, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_PortRcvConstraintErrorInfo_P_Key, {\r\n"P_Key", "opa.pm.errorportinfo.portrcvconstrainterrorinfo.pkey",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_PortRcvConstraintErrorInfo_SLID, {\r\n"SLID", "opa.pm.errorportinfo.portrcvconstrainterrorinfo.slid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_PortRcvSwitchRelayErrorInfo_Status, {\r\n"Status", "opa.pm.errorportinfo.portrcvswitchrelayerrorinfo.status",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_PortRcvSwitchRelayErrorInfo_reserved, {\r\n"Reserved (3 bits)", "opa.pm.errorportinfo.portrcvswitchrelayerrorinfo.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x70, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_PortRcvSwitchRelayErrorInfo_ErrorCode, {\r\n"ErrorCode", "opa.pm.errorportinfo.portrcvswitchrelayerrorinfo.errorcode",\r\nFT_UINT8, BASE_HEX, NULL, 0x0F, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_PortRcvSwitchRelayErrorInfo_DLID, {\r\n"DLID", "opa.pm.errorportinfo.portrcvswitchrelayerrorinfo.dlid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_PortRcvSwitchRelayErrorInfo_EgressPortNum, {\r\n"EgressPortNum", "opa.pm.errorportinfo.portrcvswitchrelayerrorinfo.egressportnum",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_PortRcvSwitchRelayErrorInfo_SC, {\r\n"SC", "opa.pm.errorportinfo.portrcvswitchrelayerrorinfo.scorsl",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_UncorrectableErrorInfo_Status, {\r\n"Status", "opa.pm.errorportinfo.uncorrectableerrorinfo.status",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_UncorrectableErrorInfo_reserved, {\r\n"Reserved (3 bits)", "opa.pm.errorportinfo.uncorrectableerrorinfo.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x70, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_UncorrectableErrorInfo_ErrorCode, {\r\n"ErrorCode", "opa.pm.errorportinfo.uncorrectableerrorinfo.errorcode",\r\nFT_UINT8, BASE_HEX, NULL, 0x0F, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_FMConfigErrorInfo_Status, {\r\n"Status", "opa.pm.errorportinfo.fmconfigerrorinfo.status",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_FMConfigErrorInfo_reserved, {\r\n"Reserved (3 bits)", "opa.pm.errorportinfo.fmconfigerrorinfo.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x70, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_FMConfigErrorInfo_ErrorCode, {\r\n"ErrorCode", "opa.pm.errorportinfo.fmconfigerrorinfo.errorcode",\r\nFT_UINT8, BASE_HEX, NULL, 0x0F, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_FMConfigErrorInfo_VL, {\r\n"VL", "opa.pm.errorportinfo.fmconfigerrorinfo.vl",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_FMConfigErrorInfo_Distance, {\r\n"Distance", "opa.pm.errorportinfo.fmconfigerrorinfo.distance",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_FMConfigErrorInfo_BadFlitBits, {\r\n"BadFlitBits", "opa.pm.errorportinfo.fmconfigerrorinfo.badflitbits",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ErrorPortInfo_FMConfigErrorInfo_SC, {\r\n"SC", "opa.pm.errorportinfo.fmconfigerrorinfo.sc",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ImageID_imageNumber, {\r\n"imageNumber", "opa.pa.imageid.imagenumber",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ImageID_imageOffset, {\r\n"imageOffset", "opa.pa.imageid.imageoffset",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupList, {\r\n"Group List", "opa.pa.getgrouplist",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupList_groupName, {\r\n"Group Name", "opa.pa.getgrouplist.groupname",\r\nFT_STRING, STR_ASCII, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo, {\r\n"Group Info", "opa.pa.getgroupinfo",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_groupName, {\r\n"Group Name", "opa.pa.getgroupinfo.groupname",\r\nFT_STRING, STR_ASCII, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_numInternalPorts, {\r\n"numInternalPorts", "opa.pa.getgroupinfo.numinternalports",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_numExternalPorts, {\r\n"numExternalPorts", "opa.pa.getgroupinfo.numexternalports",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_totalMBps, {\r\n"totalMBps", "opa.pa.getgroupinfo.totalmbps",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_totalKPps, {\r\n"totalKPps", "opa.pa.getgroupinfo.totalkpps",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_avgMBps, {\r\n"avgMBps", "opa.pa.getgroupinfo.avgmbps",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_minMBps, {\r\n"minMBps", "opa.pa.getgroupinfo.minmbps",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_maxMBps, {\r\n"maxMBps", "opa.pa.getgroupinfo.maxmbps",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_numBWBuckets, {\r\n"numBWBuckets", "opa.pa.getgroupinfo.numbwbuckets",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_BWBuckets, {\r\n"BWBuckets", "opa.pa.getgroupinfo.bwbuckets",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_avgKPps, {\r\n"avgKPps", "opa.pa.getgroupinfo.avgkpps",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_minKPps, {\r\n"minKPps", "opa.pa.getgroupinfo.minkpps",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_maxKPps, {\r\n"maxKPps", "opa.pa.getgroupinfo.maxkpps",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_pmaFailedPorts, {\r\n"pmaFailedPorts", "opa.pa.getgroupinfo.pmafailedports",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_topoFailedPorts, {\r\n"topoFailedPorts", "opa.pa.getgroupinfo.topofailedports",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_integrityErrors, {\r\n"integrityErrors", "opa.pa.getgroupinfo.integrityerrors",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_congestionErrors, {\r\n"congestionErrors", "opa.pa.getgroupinfo.congestionerrors",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_smaCongestionErrors, {\r\n"smaCongestionErrors", "opa.pa.getgroupinfo.smacongestionerrors",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_bubbleErrors, {\r\n"bubbleErrors", "opa.pa.getgroupinfo.bubbleerrors",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_securityErrors, {\r\n"securityErrors", "opa.pa.getgroupinfo.securityerrors",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_routingErrors, {\r\n"routingErrors", "opa.pa.getgroupinfo.routingerrors",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_utlizationPct10, {\r\n"utlizationPct10", "opa.pa.getgroupinfo.utlizationpct10",\r\nFT_UINT16, BASE_CUSTOM, CF_FUNC(cf_opa_mad_computed_pct10), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_discardsPct10, {\r\n"discardsPct10", "opa.pa.getgroupinfo.discardspct10",\r\nFT_UINT16, BASE_CUSTOM, CF_FUNC(cf_opa_mad_computed_pct10), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_maxInternalRate, {\r\n"maxInternalRate", "opa.pa.getgroupinfo.maxinternalrate",\r\nFT_UINT8, BASE_HEX, VALS(Rate), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_minInternalRate, {\r\n"minInternalRate", "opa.pa.getgroupinfo.mininternalrate",\r\nFT_UINT8, BASE_HEX, VALS(Rate), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_maxExternalRate, {\r\n"maxExternalRate", "opa.pa.getgroupinfo.maxexternalrate",\r\nFT_UINT8, BASE_HEX, VALS(Rate), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_minExternalRate, {\r\n"minExternalRate", "opa.pa.getgroupinfo.minexternalrate",\r\nFT_UINT8, BASE_HEX, VALS(Rate), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_maxInternalMBps, {\r\n"maxInternalMBps", "opa.pa.getgroupinfo.maxinternalmbps",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupInfo_maxExternalMBps, {\r\n"maxExternalMBps", "opa.pa.getgroupinfo.maxexternalmbps",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupConfig, {\r\n"Group Config", "opa.pa.getgroupconfig",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupConfig_groupName, {\r\n"Group Name", "opa.pa.getgroupconfig.groupname",\r\nFT_STRING, STR_ASCII, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupConfig_Port_NodeGUID, {\r\n"NodeGUID", "opa.pa.getgroupconfig.port.nodeguid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupConfig_Port_nodeDesc, {\r\n"nodeDesc", "opa.pa.getgroupconfig.port.nodedesc",\r\nFT_STRING, STR_ASCII, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupConfig_Port_NodeLID, {\r\n"NodeLID", "opa.pa.getgroupconfig.port.nodelid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetGroupConfig_Port_PortNumber, {\r\n"PortNumber", "opa.pa.getgroupconfig.port.portnumber",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters, {\r\n"Port Counters", "opa.pa.getportcounters",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_nodeLID, {\r\n"nodeLID", "opa.pa.getportcounters.nodelid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_PortNumber, {\r\n"PortNumber", "opa.pa.getportcounters.portnumber",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_flags, {\r\n"flags", "opa.pa.getportcounters.flags",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_PortXmitData, {\r\n"PortXmitData", "opa.pa.getportcounters.portxmitdata",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_PortRcvData, {\r\n"PortRcvData", "opa.pa.getportcounters.portrcvdata",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_PortXmitPkts, {\r\n"PortXmitPkts", "opa.pa.getportcounters.portxmitpkts",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_PortRcvPkts, {\r\n"PortRcvPkts", "opa.pa.getportcounters.portrcvpkts",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_PortMulticastXmitPkts, {\r\n"PortMulticastXmitPkts", "opa.pa.getportcounters.portmulticastxmitpkts",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_PortMulticastRcvPkts, {\r\n"PortMulticastRcvPkts", "opa.pa.getportcounters.portmulticastrcvpkts",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_LocalLinkIntegrityErrors, {\r\n"LocalLinkIntegrityErrors", "opa.pa.getportcounters.locallinkintegrityerrors",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_FMConfigErrors, {\r\n"FMConfigErrors", "opa.pa.getportcounters.fmconfigerrors",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_PortRcvErrors, {\r\n"PortRcvErrors", "opa.pa.getportcounters.portrcverrors",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_ExcessiveBufferOverruns, {\r\n"ExcessiveBufferOverruns", "opa.pa.getportcounters.excessivebufferoverruns",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_PortRcvConstraintErrors, {\r\n"PortRcvConstraintErrors", "opa.pa.getportcounters.portrcvconstrainterrors",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_PortRcvSwitchRelayErrors, {\r\n"PortRcvSwitchRelayErrors", "opa.pa.getportcounters.portrcvswitchrelayerrors",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_PortXmitDiscards, {\r\n"PortXmitDiscards", "opa.pa.getportcounters.portxmitdiscards",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_PortXmitConstraintErrors, {\r\n"PortXmitConstraintErrors", "opa.pa.getportcounters.portxmitconstrainterrors",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_PortRcvRemotePhysicalErrors, {\r\n"PortRcvRemotePhysicalErrors", "opa.pa.getportcounters.portrcvremotephysicalerrors",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_SwPortCongestion, {\r\n"SwPortCongestion", "opa.pa.getportcounters.swportcongestion",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_PortXmitWait, {\r\n"PortXmitWait", "opa.pa.getportcounters.portxmitwait",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_PortRcvFECN, {\r\n"PortRcvFECN", "opa.pa.getportcounters.portrcvfecn",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_PortRcvBECN, {\r\n"PortRcvBECN", "opa.pa.getportcounters.portrcvbecn",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_PortXmitTimeCong, {\r\n"PortXmitTimeCong", "opa.pa.getportcounters.portxmittimecong",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_PortXmitWastedBW, {\r\n"PortXmitWastedBW", "opa.pa.getportcounters.portxmitwastedbw",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_PortXmitWaitData, {\r\n"PortXmitWaitData", "opa.pa.getportcounters.portxmitwaitdata",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_PortRcvBubble, {\r\n"PortRcvBubble", "opa.pa.getportcounters.portrcvbubble",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_PortMarkFECN, {\r\n"PortMarkFECN", "opa.pa.getportcounters.portmarkfecn",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_LinkErrorRecovery, {\r\n"LinkErrorRecovery", "opa.pa.getportcounters.linkerrorrecovery",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_LinkDowned, {\r\n"LinkDowned", "opa.pa.getportcounters.linkdowned",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_UncorrectableErrors, {\r\n"UncorrectableErrors", "opa.pa.getportcounters.uncorrectableerrors",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_NumLanesDown, {\r\n"NumLanesDown", "opa.pa.getportcounters.numlanesdown",\r\nFT_UINT8, BASE_DEC, NULL, 0xF0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_reserved, {\r\n"Reserved", "opa.pa.getportcounters.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x08, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetPortCounters_LinkQualityIndicator, {\r\n"LinkQualityIndicator", "opa.pa.getportcounters.linkqualityindicator",\r\nFT_UINT8, BASE_DEC, VALS(LinkQualityIndicator), 0x07, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters, {\r\n"Clear User Port Counters", "opa.pa.clearportcounters",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_nodeLID, {\r\n"nodeLID", "opa.pa.clearportcounters.nodelid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_PortNumber, {\r\n"PortNumber", "opa.pa.clearportcounters.portnumber",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_CounterSelectMask, {\r\n"CounterSelectMask", "opa.pa.clearportcounters.counterselectmask",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_PortXmitData, {\r\n"PortXmitData", "opa.pa.clearportcounters.portxmitdata",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x80000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_PortRcvData, {\r\n"PortRcvData", "opa.pa.clearportcounters.portrcvdata",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x40000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_PortXmitPkts, {\r\n"PortXmitPkts", "opa.pa.clearportcounters.portxmitpkts",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x20000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_PortRcvPkts, {\r\n"PortRcvPkts", "opa.pa.clearportcounters.portrcvpkts",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x10000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_PortMulticastXmitPkts, {\r\n"PortMulticastXmitPkts", "opa.pa.clearportcounters.portmulticastxmitpkts",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x08000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_PortMulticastRcvPkts, {\r\n"PortMulticastRcvPkts", "opa.pa.clearportcounters.portmulticastrcvpkts",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x04000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_PortXmitWait, {\r\n"PortXmitWait", "opa.pa.clearportcounters.portxmitwait",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x02000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_SwPortCongestion, {\r\n"SwPortCongestion", "opa.pa.clearportcounters.swportcongestion",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x01000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_PortRcvFECN, {\r\n"PortRcvFECN", "opa.pa.clearportcounters.portrecvfecn",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00800000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_PortRcvBECN, {\r\n"PortRcvBECN", "opa.pa.clearportcounters.portrecvbecn",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00400000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_PortXmitTimeCong, {\r\n"PortXmitTimeCong", "opa.pa.clearportcounters.portxmittimecong",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00200000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_PortXmitWastedBW, {\r\n"PortXmitWastedBW", "opa.pa.clearportcounters.portxmitwastedbw",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00100000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_PortXmitWaitData, {\r\n"PortXmitWaitData", "opa.pa.clearportcounters.portxmitwaitdata",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00080000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_PortRcvBubble, {\r\n"PortRcvBubble", "opa.pa.clearportcounters.portrcvbubble",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00040000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_PortMarkFECN, {\r\n"PortMarkFECN", "opa.pa.clearportcounters.portmarkfecn",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00020000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_PortRcvConstraintErrors, {\r\n"PortRcvConstraintErrors", "opa.pa.clearportcounters.portrcvconstrainterrors",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00010000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_PortRcvSwitchRelayErrors, {\r\n"PortRcvSwitchRelayErrors", "opa.pa.clearportcounters.portrcvswitchrelayerrors",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00008000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_PortXmitDiscards, {\r\n"PortXmitDiscards", "opa.pa.clearportcounters.portxmitdiscards",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00004000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_PortXmitConstraintErrors, {\r\n"PortXmitConstraintErrors", "opa.pa.clearportcounters.portxmitconstrainterrors",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00002000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_PortRcvRemotePhysicalErrors, {\r\n"PortRcvRemotePhysicalErrors", "opa.pa.clearportcounters.portrcvremotephysicalerrors",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00001000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_LocalLinkIntegrityErrors, {\r\n"LocalLinkIntegrityErrors", "opa.pa.clearportcounters.locallinkintegrityerrors",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00000800, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_PortRcvErrors, {\r\n"PortRcvErrors", "opa.pa.clearportcounters.portrcverrors",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00000400, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_ExcessiveBufferOverruns, {\r\n"ExcessiveBufferOverruns", "opa.pa.clearportcounters.excessivebufferoverruns",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00000200, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_FMConfigErrors, {\r\n"FMConfigErrors", "opa.pa.clearportcounters.fmconfigerrors",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00000100, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_LinkErrorRecovery, {\r\n"LinkErrorRecovery", "opa.pa.clearportcounters.linkerrorrecovery",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00000080, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_LinkDowned, {\r\n"LinkDowned", "opa.pa.clearportcounters.linkdowned",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00000040, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_UncorrectableErrors, {\r\n"UncorrectableErrors", "opa.pa.clearportcounters.uncorrectableerrors",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00000020, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearPortCounters_reserved, {\r\n"Reserved (5 bits)", "opa.pa.clearportcounters.reserved",\r\nFT_UINT32, BASE_DEC, NULL, 0x0000001F, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters, {\r\n"Clear All User Port Counters", "opa.pa.clearallportcounters",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_CounterSelectMask, {\r\n"CounterSelectMask", "opa.pa.clearallportcounters.counterselectmask",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_PortXmitData, {\r\n"PortXmitData", "opa.pa.clearallportcounters.portxmitdata",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x80000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_PortRcvData, {\r\n"PortRcvData", "opa.pa.clearallportcounters.portrcvdata",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x40000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_PortXmitPkts, {\r\n"PortXmitPkts", "opa.pa.clearallportcounters.portxmitpkts",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x20000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_PortRcvPkts, {\r\n"PortRcvPkts", "opa.pa.clearallportcounters.portrcvpkts",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x10000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_PortMulticastXmitPkts, {\r\n"PortMulticastXmitPkts", "opa.pa.clearallportcounters.portmulticastxmitpkts",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x08000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_PortMulticastRcvPkts, {\r\n"PortMulticastRcvPkts", "opa.pa.clearallportcounters.portmulticastrcvpkts",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x04000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_PortXmitWait, {\r\n"PortXmitWait", "opa.pa.clearallportcounters.portxmitwait",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x02000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_SwPortCongestion, {\r\n"SwPortCongestion", "opa.pa.clearallportcounters.swportcongestion",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x01000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_PortRcvFECN, {\r\n"PortRcvFECN", "opa.pa.clearallportcounters.portrecvfecn",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00800000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_PortRcvBECN, {\r\n"PortRcvBECN", "opa.pa.clearallportcounters.portrecvbecn",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00400000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_PortXmitTimeCong, {\r\n"PortXmitTimeCong", "opa.pa.clearallportcounters.portxmittimecong",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00200000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_PortXmitWastedBW, {\r\n"PortXmitWastedBW", "opa.pa.clearallportcounters.portxmitwastedbw",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00100000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_PortXmitWaitData, {\r\n"PortXmitWaitData", "opa.pa.clearallportcounters.portxmitwaitdata",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00080000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_PortRcvBubble, {\r\n"PortRcvBubble", "opa.pa.clearallportcounters.portrcvbubble",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00040000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_PortMarkFECN, {\r\n"PortMarkFECN", "opa.pa.clearallportcounters.portmarkfecn",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00020000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_PortRcvConstraintErrors, {\r\n"PortRcvConstraintErrors", "opa.pa.clearallportcounters.portrcvconstrainterrors",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00010000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_PortRcvSwitchRelayErrors, {\r\n"PortRcvSwitchRelayErrors", "opa.pa.clearallportcounters.portrcvswitchrelayerrors",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00008000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_PortXmitDiscards, {\r\n"PortXmitDiscards", "opa.pa.clearallportcounters.portxmitdiscards",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00004000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_PortXmitConstraintErrors, {\r\n"PortXmitConstraintErrors", "opa.pa.clearallportcounters.portxmitconstrainterrors",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00002000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_PortRcvRemotePhysicalErrors, {\r\n"PortRcvRemotePhysicalErrors", "opa.pa.clearallportcounters.portrcvremotephysicalerrors",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00001000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_LocalLinkIntegrityErrors, {\r\n"LocalLinkIntegrityErrors", "opa.pa.clearallportcounters.locallinkintegrityerrors",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00000800, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_PortRcvErrors, {\r\n"PortRcvErrors", "opa.pa.clearallportcounters.portrcverrors",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00000400, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_ExcessiveBufferOverruns, {\r\n"ExcessiveBufferOverruns", "opa.pa.clearallportcounters.excessivebufferoverruns",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00000200, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_FMConfigErrors, {\r\n"FMConfigErrors", "opa.pa.clearallportcounters.fmconfigerrors",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00000100, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_LinkErrorRecovery, {\r\n"LinkErrorRecovery", "opa.pa.clearallportcounters.linkerrorrecovery",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00000080, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_LinkDowned, {\r\n"LinkDowned", "opa.pa.clearallportcounters.linkdowned",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00000040, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_UncorrectableErrors, {\r\n"UncorrectableErrors", "opa.pa.clearallportcounters.uncorrectableerrors",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00000020, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearAllPortCounters_reserved, {\r\n"Reserved (5 bits)", "opa.pa.clearallportcounters.reserved",\r\nFT_UINT32, BASE_DEC, NULL, 0x0000001F, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig, {\r\n"PM Config", "opa.pa.pmconfig",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_sweepInterval, {\r\n"sweepInterval", "opa.pa.pmconfig.sweepinterval",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_maxClients, {\r\n"maxClients", "opa.pa.pmconfig.maxclients",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_sizeHistory, {\r\n"sizeHistory", "opa.pa.pmconfig.sizehistory",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_sizeFreeze, {\r\n"sizeFreeze", "opa.pa.pmconfig.sizefreeze",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_lease, {\r\n"lease", "opa.pa.pmconfig.lease",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_pmFlags, {\r\n"pmFlags", "opa.pa.pmconfig.pmflags",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_PortXmitWait, {\r\n"PortXmitWait", "opa.pa.pmconfig.portxmitwait",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_SwPortCongestion, {\r\n"SwPortCongestion", "opa.pa.pmconfig.swportcongestion",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_PortRcvFECN, {\r\n"PortRcvFECN", "opa.pa.pmconfig.portrcvfecn",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_PortRcvBECN, {\r\n"PortRcvBECN", "opa.pa.pmconfig.portrcvbecn",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_PortXmitTimeCong, {\r\n"PortXmitTimeCong", "opa.pa.pmconfig.portxmittimecong",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_PortMarkFECN, {\r\n"PortMarkFECN", "opa.pa.pmconfig.portmarkfecn",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_integrityErrors, {\r\n"integrityErrors", "opa.pa.pmconfig.integrityerrors",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_congestionErrors, {\r\n"congestionErrors", "opa.pa.pmconfig.congestionerrors",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_bubbleErrors, {\r\n"bubbleErrors", "opa.pa.pmconfig.bubbleerrors",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_smaCongestionErrors, {\r\n"smaCongestionErrors", "opa.pa.pmconfig.smacongestionerrors",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_securityErrors, {\r\n"securityErrors", "opa.pa.pmconfig.securityerrors",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_routingErrors, {\r\n"routingErrors", "opa.pa.pmconfig.routingerrors",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_LocalLinkIntegrityErrors, {\r\n"LocalLinkIntegrityErrors", "opa.pa.pmconfig.locallinkintegrityerrors",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_PortRcvErrors, {\r\n"PortRcvErrors", "opa.pa.pmconfig.portrcverrors",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_ExcessiveBufferOverrunErrors, {\r\n"ExcessiveBufferOverrunErrors", "opa.pa.pmconfig.excessivebufferoverrunerrors",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_LinkErrorRecovery, {\r\n"LinkErrorRecovery", "opa.pa.pmconfig.linkerrorrecovery",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_LinkDowned, {\r\n"LinkDowned", "opa.pa.pmconfig.linkdowned",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_UncorrectableErrors, {\r\n"UncorrectableErrors", "opa.pa.pmconfig.uncorrectableerrors",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_FMConfigErrors, {\r\n"FMConfigErrors", "opa.pa.pmconfig.fmconfigerrors",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_LinkQualityIndicator, {\r\n"LinkQualityIndicator", "opa.pa.pmconfig.linkqualityindicator",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_LinkWidthDowngrade, {\r\n"LinkWidthDowngrade", "opa.pa.pmconfig.linkwidthdowngrade",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_memoryFootprint, {\r\n"memoryFootprint", "opa.pa.pmconfig.memoryfootprint",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_maxAttempts, {\r\n"maxAttempts", "opa.pa.pmconfig.maxattempts",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_respTimeout, {\r\n"respTimeout", "opa.pa.pmconfig.resptimeout",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_minRespTimeout, {\r\n"minRespTimeout", "opa.pa.pmconfig.minresptimeout",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_maxParallelNodes, {\r\n"maxParallelNodes", "opa.pa.pmconfig.maxparallelnodes",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_pmaBatchSize, {\r\n"pmaBatchSize", "opa.pa.pmconfig.pmabatchsize",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_PMConfig_errorClear, {\r\n"errorClear", "opa.pa.pmconfig.errorclear",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MoveFreezeFrame_old, {\r\n"Old Image", "opa.pa.movefreezeframe.old",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_MoveFreezeFrame_new, {\r\n"New Image", "opa.pa.movefreezeframe.new",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetFocusPorts, {\r\n"Focus Ports", "opa.pa.getfocusports",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetFocusPorts_groupName, {\r\n"Group Name", "opa.pa.getfocusports.groupname",\r\nFT_STRING, STR_ASCII, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetFocusPorts_select, {\r\n"select", "opa.pa.getfocusports.select",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetFocusPorts_start, {\r\n"start", "opa.pa.getfocusports.start",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetFocusPorts_range, {\r\n"range", "opa.pa.getfocusports.range",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetFocusPorts_nodeLID, {\r\n"nodeLID", "opa.pa.getfocusports.nodelid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetFocusPorts_portNumber, {\r\n"portNumber", "opa.pa.getfocusports.portnumber",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetFocusPorts_rate, {\r\n"rate", "opa.pa.getfocusports.rate",\r\nFT_UINT8, BASE_HEX, VALS(Rate), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetFocusPorts_mtu, {\r\n"mtu", "opa.pa.getfocusports.mtu",\r\nFT_UINT8, BASE_HEX, VALS(MTU), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetFocusPorts_localFlags, {\r\n"localFlags", "opa.pa.getfocusports.localflags",\r\nFT_UINT8, BASE_DEC, VALS(FocusPortFlags), 0xF0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetFocusPorts_neighborFlags, {\r\n"neighborFlags", "opa.pa.getfocusports.neighborflags",\r\nFT_UINT8, BASE_DEC, VALS(FocusPortFlags), 0x0F, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetFocusPorts_value, {\r\n"value", "opa.pa.getfocusports.value",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetFocusPorts_nodeGUID, {\r\n"nodeGUID", "opa.pa.getfocusports.nodeguid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetFocusPorts_nodeDesc, {\r\n"nodeDesc", "opa.pa.getfocusports.nodedesc",\r\nFT_STRING, STR_ASCII, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetFocusPorts_neighborLid, {\r\n"neighborLid", "opa.pa.getfocusports.neighborlid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetFocusPorts_neighborPortNumber, {\r\n"neighborPortNumber", "opa.pa.getfocusports.neighborportnumber",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetFocusPorts_neighborValue, {\r\n"neighborValue", "opa.pa.getfocusports.neighborvalue",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetFocusPorts_neighborGuid, {\r\n"neighborGuid", "opa.pa.getfocusports.neighborguid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetFocusPorts_neighborNodeDesc, {\r\n"neighborNodeDesc", "opa.pa.getfocusports.neighbornodedesc",\r\nFT_STRING, STR_ASCII, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetImageInfo, {\r\n"Image Info", "opa.pa.getimageinfo",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetImageInfo_sweepStart, {\r\n"sweepStart", "opa.pa.getimageinfo.sweepstart",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_LOCAL, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetImageInfo_sweepDuration, {\r\n"sweepDuration", "opa.pa.getimageinfo.sweepduration",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetImageInfo_numHFIPorts, {\r\n"numHHIPorts", "opa.pa.getimageinfo.numhfiports",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetImageInfo_numSwitchNodes, {\r\n"numSwitchNodes", "opa.pa.getimageinfo.numswitchnodes",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetImageInfo_numSwitchPorts, {\r\n"numSwitchPorts", "opa.pa.getimageinfo.numswitchports",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetImageInfo_numLinks, {\r\n"numLinks", "opa.pa.getimageinfo.numlinks",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetImageInfo_numSMs, {\r\n"numSMs", "opa.pa.getimageinfo.numsms",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetImageInfo_numFailedNodes, {\r\n"numFailedNodes", "opa.pa.getimageinfo.numfailednodes",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetImageInfo_numFailedPorts, {\r\n"numFailedPorts", "opa.pa.getimageinfo.numfailedports",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetImageInfo_numSkippedNodes, {\r\n"numSkippedNodes", "opa.pa.getimageinfo.numskippednodes",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetImageInfo_numSkippedPorts, {\r\n"numSkippedPorts", "opa.pa.getimageinfo.numskippedports",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetImageInfo_numUnexpectedClearPorts, {\r\n"numUnexpectedClearPorts", "opa.pa.getimageinfo.numunexpectedclearports",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetImageInfo_imageInterval, {\r\n"imageInterval", "opa.pa.getimageinfo.imageinterval",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetImageInfo_lid, {\r\n"lid", "opa.pa.getimageinfo.sminfo.lid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetImageInfo_state, {\r\n"state", "opa.pa.getimageinfo.sminfo.state",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetImageInfo_priority, {\r\n"priority", "opa.pa.getimageinfo.sminfo.priority",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetImageInfo_portNumber, {\r\n"portNumber", "opa.pa.getimageinfo.sminfo.portnumber",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetImageInfo_smPortGuid, {\r\n"portGUID", "opa.pa.getimageinfo.sminfo.portguid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetImageInfo_smNodeDesc, {\r\n"nodeDesc", "opa.pa.getimageinfo.sminfo.nodedesc",\r\nFT_STRING, STR_ASCII, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFList, {\r\n"Vf List", "opa.pa.getvflist",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFList_vfName, {\r\n"VF Name", "opa.pa.getvflist.vfname",\r\nFT_STRING, STR_ASCII, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFInfo, {\r\n"VF Info", "opa.pa.getvfinfo",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFInfo_vfName, {\r\n"VF Name", "opa.pa.getvfinfo.vfname",\r\nFT_STRING, STR_ASCII, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFInfo_numPorts, {\r\n"numPorts", "opa.pa.getvfinfo.numports",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFInfo_totalMBps, {\r\n"totalMBps", "opa.pa.getvfinfo.totalmbps",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFInfo_totalKPps, {\r\n"totalKPps", "opa.pa.getvfinfo.totalkpps",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFInfo_avgMBps, {\r\n"avgMBps", "opa.pa.getvfinfo.avgmbps",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFInfo_minMBps, {\r\n"minMBps", "opa.pa.getvfinfo.minmbps",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFInfo_maxMBps, {\r\n"maxMBps", "opa.pa.getvfinfo.maxmbps",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFInfo_numBWBuckets, {\r\n"numBWBuckets", "opa.pa.getvfinfo.numbwbuckets",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFInfo_BWBuckets, {\r\n"BWBuckets", "opa.pa.getvfinfo.bwbuckets",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFInfo_avgKPps, {\r\n"avgKPps", "opa.pa.getvfinfo.avgkpps",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFInfo_minKPps, {\r\n"minKPps", "opa.pa.getvfinfo.minkpps",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFInfo_maxKPps, {\r\n"maxKPps", "opa.pa.getvfinfo.maxkpps",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFInfo_pmaFailedPorts, {\r\n"pmaFailedPorts", "opa.pa.getvfinfo.pmafailedports",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFInfo_topoFailedPorts, {\r\n"topoFailedPorts", "opa.pa.getvfinfo.topofailedports",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFInfo_integrityErrors, {\r\n"integrityErrors", "opa.pa.getvfinfo.integrityerrors",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFInfo_congestionErrors, {\r\n"congestionErrors", "opa.pa.getvfinfo.congestionerrors",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFInfo_smaCongestionErrors, {\r\n"smaCongestionErrors", "opa.pa.getvfinfo.smacongestionerrors",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFInfo_bubbleErrors, {\r\n"bubbleErrors", "opa.pa.getvfinfo.bubbleerrors",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFInfo_securityErrors, {\r\n"securityErrors", "opa.pa.getvfinfo.securityerrors",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFInfo_routingErrors, {\r\n"routingErrors", "opa.pa.getvfinfo.routingerrors",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFInfo_utlizationPct10, {\r\n"utlizationPct10", "opa.pa.getvfinfo.utlizationpct10",\r\nFT_UINT16, BASE_CUSTOM, CF_FUNC(cf_opa_mad_computed_pct10), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFInfo_discardsPct10, {\r\n"discardsPct10", "opa.pa.getvfinfo.discardspct10",\r\nFT_UINT16, BASE_CUSTOM, CF_FUNC(cf_opa_mad_computed_pct10), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFInfo_maxInternalRate, {\r\n"maxInternalRate", "opa.pa.getvfinfo.maxinternalrate",\r\nFT_UINT8, BASE_HEX, VALS(Rate), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFInfo_minInternalRate, {\r\n"minInternalRate", "opa.pa.getvfinfo.mininternalrate",\r\nFT_UINT8, BASE_HEX, VALS(Rate), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFInfo_maxInternalMBps, {\r\n"maxInternalMBps", "opa.pa.getvfinfo.maxinternalmbps",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFConfig, {\r\n"VF Config", "opa.pa.getvfconfig",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFConfig_vfName, {\r\n"VF Name", "opa.pa.getvfconfig.vfname",\r\nFT_STRING, STR_ASCII, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFConfig_Port_NodeGUID, {\r\n"NodeGUID", "opa.pa.getvfconfig.port.nodeguid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFConfig_Port_nodeDesc, {\r\n"nodeDesc", "opa.pa.getvfconfig.port.nodedesc",\r\nFT_STRING, STR_ASCII, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFConfig_Port_NodeLID, {\r\n"NodeLID", "opa.pa.getvfconfig.port.nodelid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFConfig_Port_PortNumber, {\r\n"PortNumber", "opa.pa.getvfconfig.port.portnumber",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFPortCounters, {\r\n"VF Port Counters", "opa.pa.getvfportcounters",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFPortCounters_vfName, {\r\n"VF Name", "opa.pa.getvfportcounters.vfname",\r\nFT_STRING, STR_ASCII, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFPortCounters_nodeLID, {\r\n"nodeLID", "opa.pa.getvfportcounters.nodelid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFPortCounters_PortNumber, {\r\n"PortNumber", "opa.pa.getvfportcounters.portnumber",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFPortCounters_flags, {\r\n"flags", "opa.pa.getvfportcounters.flags",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFPortCounters_PortVFXmitData, {\r\n"PortVFXmitData", "opa.pa.getvfportcounters.portvfxmitdata",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFPortCounters_PortVFRcvData, {\r\n"PortVFRcvData", "opa.pa.getvfportcounters.portvfrcvdata",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFPortCounters_PortVFXmitPkts, {\r\n"PortVFXmitPkts", "opa.pa.getvfportcounters.portvfxmitpkts",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFPortCounters_PortVFRcvPkts, {\r\n"PortVFRcvPkts", "opa.pa.getvfportcounters.portvfrcvpkts",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFPortCounters_PortVFXmitDiscards, {\r\n"PortVFXmitDiscards", "opa.pa.getvfportcounters.portvfxmitdiscards",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFPortCounters_SwPortVFCongestion, {\r\n"SwPortCongestion", "opa.pa.getvfportcounters.swportcongestion",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFPortCounters_PortVFXmitWait, {\r\n"PortVFXmitWait", "opa.pa.getvfportcounters.portvfxmitwait",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFPortCounters_PortVFRcvFECN, {\r\n"PortVFRcvFECN", "opa.pa.getvfportcounters.portvfrcvfecn",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFPortCounters_PortVFRcvBECN, {\r\n"PortVFRcvBECN", "opa.pa.getvfportcounters.portvfrcvbecn",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFPortCounters_PortVFXmitTimeCong, {\r\n"PortVFXmitTimeCong", "opa.pa.getvfportcounters.portvfxmittimecong",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFPortCounters_PortVFXmitWastedBW, {\r\n"PortVFXmitWastedBW", "opa.pa.getvfportcounters.portvfxmitwastedbw",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFPortCounters_PortVFXmitWaitData, {\r\n"PortVFXmitWaitData", "opa.pa.getvfportcounters.portvfxmitwaitdata",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFPortCounters_PortVFRcvBubble, {\r\n"PortVFRcvBubble", "opa.pa.getvfportcounters.portvfrcvbubble",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFPortCounters_PortVFMarkFECN, {\r\n"PortVFMarkFECN", "opa.pa.getvfportcounters.portvfmarkfecn",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearVFPortCounters, {\r\n"Clear VF Port Counters", "opa.pa.clearvfportcounters",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearVFPortCounters_vfName, {\r\n"VF Name", "opa.pa.clearvfportcounters.vfname",\r\nFT_STRING, STR_ASCII, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearVFPortCounters_nodeLID, {\r\n"nodeLID", "opa.pa.clearvfportcounters.nodelid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearVFPortCounters_PortNumber, {\r\n"PortNumber", "opa.pa.clearvfportcounters.portnumber",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearVFPortCounters_CounterSelectMask, {\r\n"CounterSelectMask", "opa.pa.clearvfportcounters.counterselectmask",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearVFPortCounters_PortVFXmitData, {\r\n"PortVFXmitData", "opa.pa.clearvfportcounters.portvfxmitdata",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x80000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearVFPortCounters_PortVFRcvData, {\r\n"PortVFRcvData", "opa.pa.clearvfportcounters.portvfrcvdata",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x40000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearVFPortCounters_PortVFXmitPkts, {\r\n"PortVFXmitPkts", "opa.pa.clearvfportcounters.portvfxmitpkts",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x20000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearVFPortCounters_PortVFRcvPkts, {\r\n"PortVFRcvPkts", "opa.pa.clearvfportcounters.portvfrcvpkts",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x10000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearVFPortCounters_PortVFXmitDiscards, {\r\n"PortVFXmitDiscards", "opa.pa.clearvfportcounters.portvfxmitdiscards",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x08000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearVFPortCounters_SwPortVFCongestion, {\r\n"SwPortVFCongestion", "opa.pa.clearvfportcounters.swportvfcongestion",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x04000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearVFPortCounters_PortVFXmitWait, {\r\n"PortVFXmitWait", "opa.pa.clearvfportcounters.portvfxmitwait",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x02000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearVFPortCounters_PortVFRcvFECN, {\r\n"PortVFRcvFECN", "opa.pa.clearvfportcounters.portvfrcvfecn",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x01000000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearVFPortCounters_PortVFRcvBECN, {\r\n"PortVFRcvBECN", "opa.pa.clearvfportcounters.portvfrcvbecn",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00800000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearVFPortCounters_PortVFXmitTimeCong, {\r\n"PortVFXmitTimeCong", "opa.pa.clearvfportcounters.portvfxmittimecong",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00400000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearVFPortCounters_PortVFXmitWastedBW, {\r\n"PortVFXmitWastedBW", "opa.pa.clearvfportcounters.portvfxmitwastedbw",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00200000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearVFPortCounters_PortVFXmitWaitData, {\r\n"PortVFXmitWaitData", "opa.pa.clearvfportcounters.portvfxmitwaitdata",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00100000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearVFPortCounters_PortVFRcvBubble, {\r\n"PortVFRcvBubble", "opa.pa.clearvfportcounters.portvfrcvbubble",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00080000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearVFPortCounters_PortVFMarkFECN, {\r\n"PortVFMarkFECN", "opa.pa.clearvfportcounters.portvfmarkfecn",\r\nFT_BOOLEAN, 32, TFS(&tfs_clear_dont_clear), 0x00040000, NULL, HFILL }\r\n},\r\n{ &hf_opa_ClearVFPortCounters_reserved, {\r\n"Reserved", "opa.pa.clearvfportcounters.reserved",\r\nFT_UINT32, BASE_HEX, NULL, 0x0003FFFF, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFFocusPorts, {\r\n"VF Focus Ports", "opa.pa.getvffocusports",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFFocusPorts_vfName, {\r\n"VF Name", "opa.pa.getvffocusports.vfname",\r\nFT_STRING, STR_ASCII, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFFocusPorts_select, {\r\n"select", "opa.pa.getvffocusports.select",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFFocusPorts_start, {\r\n"start", "opa.pa.getvffocusports.start",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFFocusPorts_range, {\r\n"range", "opa.pa.getvffocusports.range",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFFocusPorts_nodeLID, {\r\n"nodeLID", "opa.pa.getvffocusports.nodelid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFFocusPorts_portNumber, {\r\n"portNumber", "opa.pa.getvffocusports.portnumber",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFFocusPorts_rate, {\r\n"rate", "opa.pa.getvffocusports.rate",\r\nFT_UINT8, BASE_HEX, VALS(Rate), 0xF8, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFFocusPorts_mtu, {\r\n"mtu", "opa.pa.getvffocusports.mtu",\r\nFT_UINT8, BASE_HEX, VALS(MTU), 0x07, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFFocusPorts_localFlags, {\r\n"localFlags", "opa.pa.getvffocusports.localflags",\r\nFT_UINT8, BASE_DEC, VALS(FocusPortFlags), 0xF0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFFocusPorts_neighborFlags, {\r\n"neighborFlags", "opa.pa.getvffocusports.neighborflags",\r\nFT_UINT8, BASE_DEC, VALS(FocusPortFlags), 0x0F, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFFocusPorts_value, {\r\n"value", "opa.pa.getvffocusports.value",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFFocusPorts_nodeGUID, {\r\n"nodeGUID", "opa.pa.getvffocusports.nodeguid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFFocusPorts_nodeDesc, {\r\n"nodeDesc", "opa.pa.getvffocusports.nodedesc",\r\nFT_STRING, STR_ASCII, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFFocusPorts_neighborLid, {\r\n"neighborLid", "opa.pa.getvffocusports.neighborlid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFFocusPorts_neighborPortNumber, {\r\n"neighborPortNumber", "opa.pa.getvffocusports.neighborportnumber",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFFocusPorts_neighborValue, {\r\n"neighborValue", "opa.pa.getvffocusports.neighborvalue",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFFocusPorts_neighborGuid, {\r\n"neighborGuid", "opa.pa.getvffocusports.neighborguid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_GetVFFocusPorts_neighborNodeDesc, {\r\n"neighborNodeDesc", "opa.pa.getvffocusports.neighbornodedesc",\r\nFT_STRING, STR_ASCII, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_VFInfoRecord, {\r\n"VF Info Record", "opa.vfinforecorf",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_VFInfoRecord_vfIndex, {\r\n"VF Index", "opa.vfinforecorf.vfindex",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_VFInfoRecord_pKey, {\r\n"P Key", "opa.vfinforecord.pkey",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_VFInfoRecord_vfName, {\r\n"VF Name", "opa.vfinforecord.vfname",\r\nFT_STRING, STR_ASCII, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_VFInfoRecord_MGID, {\r\n"M GID", "opa.vfinforecord.mgid",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_VFInfoRecord_SelectFlags, {\r\n"Select Flags", "opa.vfinforecord.selectflags",\r\nFT_UINT8, BASE_HEX, NULL, 0xC0, NULL, HFILL }\r\n},\r\n{ &hf_opa_VFInfoRecord_reserved, {\r\n"Reserved (1 bit)", "opa.vfinforecord.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x20, NULL, HFILL }\r\n},\r\n{ &hf_opa_VFInfoRecord_SL, {\r\n"SL", "opa.vfinforecord.sl",\r\nFT_UINT8, BASE_HEX, NULL, 0x1F, NULL, HFILL }\r\n},\r\n{ &hf_opa_VFInfoRecord_MTUSpecified, {\r\n"MTU Specified", "opa.vfinforecord.mtuspecified",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL }\r\n},\r\n{ &hf_opa_VFInfoRecord_reserved2, {\r\n"Reserved (1 bit)", "opa.vfinforecord.reserved2",\r\nFT_UINT8, BASE_HEX, NULL, 0x40, NULL, HFILL }\r\n},\r\n{ &hf_opa_VFInfoRecord_MTU, {\r\n"MTU", "opa.vfinforecord.mtu",\r\nFT_UINT8, BASE_HEX, VALS(MTU), 0x3F, NULL, HFILL }\r\n},\r\n{ &hf_opa_VFInfoRecord_RateSpecified, {\r\n"Rate Specified", "opa.vfinforecord.ratespecified",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL }\r\n},\r\n{ &hf_opa_VFInfoRecord_reserved4, {\r\n"Reserved (1 bit)", "opa.vfinforecord.reserved4",\r\nFT_UINT8, BASE_HEX, NULL, 0x40, NULL, HFILL }\r\n},\r\n{ &hf_opa_VFInfoRecord_Rate, {\r\n"Rate", "opa.vfinforecord.rate",\r\nFT_UINT8, BASE_HEX, NULL, 0x3F, NULL, HFILL }\r\n},\r\n{ &hf_opa_VFInfoRecord_PktLifeSpecified, {\r\n"Packet Life Time Specified", "opa.vfinforecord.pktlifespecified",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL }\r\n},\r\n{ &hf_opa_VFInfoRecord_reserved5, {\r\n"Reserved (4 bits)", "opa.vfinforecord.reserved5",\r\nFT_UINT8, BASE_HEX, NULL, 0x78, NULL, HFILL }\r\n},\r\n{ &hf_opa_VFInfoRecord_PktLifeTimeInc, {\r\n"Packet Life Time", "opa.vfinforecord.pktlifetime",\r\nFT_UINT8, BASE_HEX, NULL, 0x07, NULL, HFILL }\r\n},\r\n{ &hf_opa_VFInfoRecord_OptionFlags, {\r\n"Option Flags", "opa.vfinforecord.optionflags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_VFInfoRecord_BandwidthPercent, {\r\n"Bandwidth Percent", "opa.vfinforecord.bandwidthpercent",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_VFInfoRecord_reserved6, {\r\n"Reserved (7 bits)", "opa.vfinforecord.reserved6",\r\nFT_UINT8, BASE_HEX, NULL, 0xFE, NULL, HFILL }\r\n},\r\n{ &hf_opa_VFInfoRecord_Priority, {\r\n"Priority", "opa.vfinforecord.priority",\r\nFT_UINT8, BASE_HEX, NULL, 0x01, NULL, HFILL }\r\n},\r\n{ &hf_opa_VFInfoRecord_RoutingSLs, {\r\n"Routing SLs", "opa.vfinforecord.routingsls",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_VFInfoRecord_reserved7, {\r\n"Rezerved (24 Bytes)", "opa.vfinforecord.reserved7",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_QuarantinedNodeRecord, {\r\n"Quarantined Node Record", "opa.quarantinednoderecord",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_QuarantinedNodeRecord_TrustedLid, {\r\n"Trusted LID", "opa.quarantinednoderecord.trustedlid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_QuarantinedNodeRecord_TrustedNodeGUID, {\r\n"Trusted Node GUID", "opa.quarantinednoderecord.trustednodeguid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_QuarantinedNodeRecord_TrustedPortNum, {\r\n"Trusted Port Num", "opa.quarantinednoderecord.trustedportnum",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_QuarantinedNodeRecord_TrustedNeighborNodeGUID, {\r\n"Trusted Neighbor Node GUID", "opa.quarantinednoderecord.trustedneighbornodeguid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_QuarantinedNodeRecord_QuarantineReasons, {\r\n"Quarantine Reasons", "opa.quarantinednoderecord.quarantinereasons",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_QuarantinedNodeRecord_ExpectedNodeDesc, {\r\n"Expected Node Desc", "opa.quarantinednoderecord.expectednodedesc",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_QuarantinedNodeRecord_ExpectedNodeGUID, {\r\n"Expected Node GUID", "opa.quarantinednoderecord.expectednodeguid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_opa_QuarantinedNodeRecord_ExpectedPortGUID, {\r\n"Expected Port GUID", "opa.quarantinednoderecord.expectedportguid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n}\r\n};\r\nstatic gint *ett[] = {\r\n&ett_payload,\r\n&ett_sm_lid,\r\n&ett_sm_dr,\r\n&ett_sa,\r\n&ett_pm,\r\n&ett_pa,\r\n&ett_mad,\r\n&ett_mad_status,\r\n&ett_mad_attributemod,\r\n&ett_rmpp,\r\n&ett_sm_attribute,\r\n&ett_sa_attribute,\r\n&ett_pm_attribute,\r\n&ett_pa_attribute,\r\n&ett_noticestraps,\r\n&ett_datadetails,\r\n&ett_datadetails_trap259datavalid,\r\n&ett_informinfo,\r\n&ett_classportinfo,\r\n&ett_classportinfo_redirect,\r\n&ett_classportinfo_trap,\r\n&ett_nodedescription,\r\n&ett_nodeinfo,\r\n&ett_switchinfo,\r\n&ett_switchinfo_switchcapabilitymask,\r\n&ett_portinfo,\r\n&ett_portinfo_vl,\r\n&ett_portinfo_link,\r\n&ett_portinfo_portmode,\r\n&ett_portinfo_flitcontrol,\r\n&ett_portinfo_porterroraction,\r\n&ett_portinfo_neighbormtu,\r\n&ett_portinfo_xmitq,\r\n&ett_portinfo_capmask,\r\n&ett_portinfo_capmask3,\r\n&ett_portstates,\r\n&ett_pkeytable,\r\n&ett_pkeytable_block,\r\n&ett_sltoscmapping,\r\n&ett_sltoscmapping_block,\r\n&ett_sctoscmapping,\r\n&ett_sctoscmapping_block,\r\n&ett_sctoslmapping,\r\n&ett_sctoslmapping_block,\r\n&ett_sctovlxmappingtable,\r\n&ett_sctovlxmappingtable_block,\r\n&ett_vlarbitrationtable,\r\n&ett_vlarbitrationtable_port,\r\n&ett_linearforwardingtable,\r\n&ett_linearforwardingtable_block,\r\n&ett_multicastforwardingtable,\r\n&ett_multicastforwardingtable_block,\r\n&ett_portgroupforwardingtable,\r\n&ett_portgroupforwardingtable_block,\r\n&ett_portgrouptable,\r\n&ett_portgrouptable_block,\r\n&ett_sminfo,\r\n&ett_ledinfo,\r\n&ett_cableinfo,\r\n&ett_aggregate,\r\n&ett_buffercontroltable,\r\n&ett_buffercontroltable_port,\r\n&ett_fabricinforecord,\r\n&ett_congestioninfo,\r\n&ett_switchcongestionlog,\r\n&ett_switchcongestionlog_entry,\r\n&ett_switchcongestionsetting,\r\n&ett_switchportcongestionsetting,\r\n&ett_switchportcongestionsetting_port,\r\n&ett_hficongestionlog,\r\n&ett_hficongestionlog_entry,\r\n&ett_hficongestionsetting,\r\n&ett_hficongestioncontroltable,\r\n&ett_hficongestioncontroltable_block,\r\n&ett_portinforecord_linkdownreason,\r\n&ett_portinforecord_linkdownreason_entry,\r\n&ett_scmappingrecord,\r\n&ett_lftrecord,\r\n&ett_linkrecord,\r\n&ett_servicerecord,\r\n&ett_pathrecord,\r\n&ett_pathrecord_dgid,\r\n&ett_pathrecord_sgid,\r\n&ett_mcmemberrecord,\r\n&ett_tracerecord,\r\n&ett_multipathrecord_gid,\r\n&ett_multipathrecord_guid,\r\n&ett_multipathrecord_lid,\r\n&ett_cableinforecord,\r\n&ett_serviceassocrecord,\r\n&ett_sctoslmappingtablerecord,\r\n&ett_portgroupforwardingtablerecord,\r\n&ett_vfinforecord,\r\n&ett_quarantinednoderecord,\r\n&ett_portstatus,\r\n&ett_portstatus_vl,\r\n&ett_clearportstatus,\r\n&ett_clearportstatus_counterselectmask,\r\n&ett_dataportcounters,\r\n&ett_dataportcounters_port,\r\n&ett_dataportcounters_vl,\r\n&ett_errorportcounters,\r\n&ett_errorportcounters_port,\r\n&ett_errorportinfo,\r\n&ett_errorportinfoport,\r\n&ett_errorportinfo_portrcverrorinfo,\r\n&ett_errorportinfo_excessivebufferoverruninfo,\r\n&ett_errorportinfo_portxmitconstrainterrorinfo,\r\n&ett_errorportinfo_portrcvconstrainterrorinfo,\r\n&ett_errorportinfo_portrcvswitchrelayerrorinfo,\r\n&ett_errorportinfo_uncorrectableerrorinfo,\r\n&ett_errorportinfo_fmconfigerrorinfo,\r\n&ett_getgrouplist,\r\n&ett_getgroupinfo,\r\n&ett_getgroupinfoutilstats,\r\n&ett_getgroupinfoutilbuckets,\r\n&ett_getgroupinfoerrorsummary,\r\n&ett_getgroupinfoerrintegritybucket,\r\n&ett_getgroupinfoerrcongestionbucket,\r\n&ett_getgroupinfoerrsmacongestionbucket,\r\n&ett_getgroupinfoerrbubblebucket,\r\n&ett_getgroupinfoerrsecuritybucket,\r\n&ett_getgroupinfoerrroutingbucket,\r\n&ett_getportcounters,\r\n&ett_clearportcounters,\r\n&ett_clearportcounters_counterselectmask,\r\n&ett_clearallportcounters,\r\n&ett_clearallportcounters_counterselectmask,\r\n&ett_pmconfig,\r\n&ett_getgroupconfig,\r\n&ett_getgroupconfigport,\r\n&ett_movefreezeframeold,\r\n&ett_movefreezeframenew,\r\n&ett_getfocusports,\r\n&ett_getfocusportsport,\r\n&ett_getimageinfo,\r\n&ett_getimageinfosm,\r\n&ett_getvflist,\r\n&ett_getvfinfo,\r\n&ett_getvfinfoutilstats,\r\n&ett_getvfinfoutilbuckets,\r\n&ett_getvfinfoerrorsummary,\r\n&ett_getvfinfoerrintegritybucket,\r\n&ett_getvfinfoerrcongestionbucket,\r\n&ett_getvfinfoerrsmacongestionbucket,\r\n&ett_getvfinfoerrbubblebucket,\r\n&ett_getvfinfoerrsecuritybucket,\r\n&ett_getvfinfoerrroutingbucket,\r\n&ett_getvfconfig,\r\n&ett_getvfconfigport,\r\n&ett_getvffocusports,\r\n&ett_getvffocusportsport,\r\n&ett_getvfportcounters,\r\n&ett_clearvfportcounters,\r\n&ett_clearvfportcounters_counterselectmask\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_opa_mad_error, {\r\n"opa.mad.error", PI_RESPONSE_CODE, PI_WARN,\r\n"MAD Status Error", EXPFILL }\r\n},\r\n{ &ei_opa_mad_no_attribute_dissector, {\r\n"opa.mad.noattributedissector", PI_UNDECODED, PI_NOTE,\r\n"Attribute Dissector Not Implemented", EXPFILL }\r\n},\r\n{ &ei_opa_mad_attribute_modifier_error_nonzero, {\r\n"opa.mad.attributemodifiererrornonzero", PI_PROTOCOL, PI_WARN,\r\n"Attribute Modifier is unexpectedly Non-zero", EXPFILL }\r\n},\r\n{ &ei_opa_rmpp_undecoded, {\r\n"opa.rmpp.undecoded", PI_UNDECODED, PI_NOTE,\r\n"RMPP Records Undecoded", EXPFILL }\r\n},\r\n{ &ei_opa_aggregate_error, {\r\n"opa.aggregate.error.exp", PI_RESPONSE_CODE, PI_WARN,\r\n"Aggregate Error", EXPFILL }\r\n}\r\n};\r\nproto_opa_mad = proto_register_protocol("Intel Omni-Path MAD", "OPA MAD", "opa.mad");\r\nopa_mad_handle = register_dissector("opa.mad", dissect_opa_mad, proto_opa_mad);\r\nproto_register_field_array(proto_opa_mad, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_opa_mad = expert_register_protocol(proto_opa_mad);\r\nexpert_register_field_array(expert_opa_mad, ei, array_length(ei));\r\nrange_convert_str(&global_mad_vendor_class, OPA_VENDOR_RANGE_STR, 0xFF);\r\nrange_convert_str(&global_mad_vendor_rmpp_class, OPA_VENDOR_RMPP_RANGE_STR, 0xFF);\r\nrange_convert_str(&global_mad_application_class, OPA_APPLICATION_RANGE_STR, 0xFF);\r\nrange_convert_str(&global_mad_reserved_class, OPA_RESERVED_RANGE_STR, 0xFF);\r\nrange_convert_str(&global_mad_opa_class, OPA_MGMTCLASS_RANGE_STR, 0xFF);\r\nopa_mad_module = prefs_register_protocol(proto_opa_mad, proto_reg_handoff_opa_mad);\r\nprefs_register_bool_preference(opa_mad_module, "parse_mad_error",\r\n"Enable Parsing of Mad Payload on Mad Status Error",\r\n"Attempt to parse mad payload even when MAD.Status is non-zero",\r\n&pref_parse_on_mad_status_error);\r\n}\r\nvoid proto_reg_handoff_opa_mad(void)\r\n{\r\neth_handle = find_dissector("eth");\r\nethertype_dissector_table = find_dissector_table("ethertype");\r\n}
