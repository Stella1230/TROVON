static struct _sprt_conversation_info* find_sprt_conversation_data(packet_info *pinfo)\r\n{\r\nconversation_t *p_conv = NULL;\r\nstruct _sprt_conversation_info *p_conv_data = NULL;\r\np_conv = find_conversation(pinfo->num,\r\n&pinfo->src,\r\n&pinfo->dst,\r\npinfo->ptype,\r\npinfo->srcport,\r\npinfo->destport,\r\nNO_ADDR_B|NO_PORT_B);\r\nif (p_conv)\r\n{\r\np_conv_data = (struct _sprt_conversation_info*)conversation_get_proto_data(p_conv, proto_sprt);\r\n}\r\nreturn p_conv_data;\r\n}\r\nvoid sprt_add_address(packet_info *pinfo,\r\naddress *addr, int port,\r\nint other_port,\r\nconst gchar *setup_method,\r\nguint32 setup_frame_number)\r\n{\r\naddress null_addr;\r\nconversation_t* p_conv;\r\nstruct _sprt_conversation_info *p_conv_data = NULL;\r\nif (pinfo->fd->flags.visited)\r\n{\r\nreturn;\r\n}\r\nclear_address(&null_addr);\r\np_conv = find_conversation(setup_frame_number, addr, &null_addr, PT_UDP, port, other_port,\r\nNO_ADDR_B | (!other_port ? NO_PORT_B : 0));\r\nif (!p_conv || p_conv->setup_frame != setup_frame_number) {\r\np_conv = conversation_new(setup_frame_number, addr, &null_addr, PT_UDP,\r\n(guint32)port, (guint32)other_port,\r\nNO_ADDR2 | (!other_port ? NO_PORT2 : 0));\r\n}\r\nconversation_set_dissector(p_conv, sprt_handle);\r\np_conv_data = (struct _sprt_conversation_info *)conversation_get_proto_data(p_conv, proto_sprt);\r\nif (!p_conv_data) {\r\np_conv_data = wmem_new(wmem_file_scope(), struct _sprt_conversation_info);\r\np_conv_data->stream_started = FALSE;\r\np_conv_data->seqnum[0] = 0;\r\np_conv_data->seqnum[1] = 0;\r\np_conv_data->seqnum[2] = 0;\r\np_conv_data->seqnum[3] = 0;\r\np_conv_data->i_octet_dlci_status = DLCI_UNKNOWN;\r\np_conv_data->connect_frame_number = 0;\r\nconversation_add_proto_data(p_conv, proto_sprt, p_conv_data);\r\n}\r\ng_strlcpy(p_conv_data->method, setup_method, SPRT_CONV_MAX_SETUP_METHOD_SIZE);\r\np_conv_data->frame_number = setup_frame_number;\r\n}\r\nstatic void show_setup_info(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nstruct _sprt_conversation_info *p_conv_data;\r\nproto_tree *sprt_setup_tree;\r\nproto_item *ti;\r\np_conv_data = find_sprt_conversation_data(pinfo);\r\nif (!p_conv_data)\r\n{\r\nproto_tree_add_string_format(tree, hf_sprt_setup, tvb, 0, 0, "", "No setup info found");\r\nreturn;\r\n}\r\nti = proto_tree_add_string_format(tree, hf_sprt_setup, tvb, 0, 0,\r\n"",\r\n"Stream setup by %s (frame %u)",\r\np_conv_data->method,\r\np_conv_data->frame_number);\r\nPROTO_ITEM_SET_GENERATED(ti);\r\nsprt_setup_tree = proto_item_add_subtree(ti, ett_sprt_setup);\r\nif (sprt_setup_tree)\r\n{\r\nproto_item* item = proto_tree_add_uint(sprt_setup_tree, hf_sprt_setup_frame,\r\ntvb, 0, 0, p_conv_data->frame_number);\r\nPROTO_ITEM_SET_GENERATED(item);\r\nitem = proto_tree_add_string(sprt_setup_tree, hf_sprt_setup_method,\r\ntvb, 0, 0, p_conv_data->method);\r\nPROTO_ITEM_SET_GENERATED(item);\r\n}\r\n}\r\nstatic int\r\ndissect_sprt_data(tvbuff_t *tvb,\r\npacket_info *pinfo,\r\nstruct _sprt_conversation_info *p_conv_data,\r\nproto_tree *sprt_tree,\r\nunsigned int offset,\r\nguint payload_length)\r\n{\r\nproto_item *ti;\r\nproto_tree *sprt_payload_tree, *field_subtree;\r\nguint8 octet, payload_msgid, category_id;\r\nguint8 selcompr, mr_event_id;\r\nguint16 word, category_count;\r\nif (payload_length > 0)\r\n{\r\nti = proto_tree_add_uint(sprt_tree, hf_sprt_payload_length, tvb, offset, 1, payload_length);\r\nproto_item_set_len(ti, payload_length);\r\nsprt_payload_tree = proto_item_add_subtree(ti, ett_payload);\r\npayload_msgid = tvb_get_guint8(tvb, offset) & 0x7F;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_reserved_bit, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_message_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\npayload_length--;\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ", %s(%d)", rval_to_str(payload_msgid, sprt_modem_relay_msg_id_name, "Unknown"), payload_msgid);\r\nswitch(payload_msgid)\r\n{\r\ncase SPRT_MODEM_RELAY_MSG_ID_INIT:\r\nti = proto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_init_all_fields, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nfield_subtree = proto_item_add_subtree(ti, ett_init_msg_all_fields);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_init_necrxch, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_init_ecrxch, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_init_xid_prof_exch, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_init_assym_data_types, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_init_opt_moip_types_i_raw_bit, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_init_opt_moip_types_i_frame, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_init_opt_moip_types_i_char_stat, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_init_opt_moip_types_i_char_dyn, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_init_opt_moip_types_i_octet_cs, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_init_opt_moip_types_i_char_stat_cs, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_init_opt_moip_types_i_char_dyn_cs, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_init_opt_moip_types_reserved, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nbreak;\r\ncase SPRT_MODEM_RELAY_MSG_ID_XID_XCHG:\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_xidxchg_ecp, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_xidxchg_xidlr1_v42bis, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_xidxchg_xidlr1_v44, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_xidxchg_xidlr1_mnp5, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_xidxchg_xidlr1_reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_xidxchg_xidlr2_v42bis_compr_req, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_xidxchg_xidlr3and4_v42bis_num_codewords, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_xidxchg_xidlr5_v42bis_max_strlen, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_xidxchg_xidlr6_v44_capability, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_xidxchg_xidlr7_v44_compr_req, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_xidxchg_xidlr8and9_v44_num_codewords_trans, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_xidxchg_xidlr10and11_v44_num_codewords_recv, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_xidxchg_xidlr12_v44_max_strlen_trans, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_xidxchg_xidlr13_v44_max_strlen_recv, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_xidxchg_xidlr14and15_v44_history_len_trans, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_xidxchg_xidlr16and17_v44_history_len_recv, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nbreak;\r\ncase SPRT_MODEM_RELAY_MSG_ID_JM_INFO:\r\ncategory_count = 1;\r\ndo\r\n{\r\nword = tvb_get_ntohs(tvb, offset);\r\ncategory_id = (word >> 12);\r\nti = proto_tree_add_uint_format_value(sprt_payload_tree, hf_sprt_payload_msg_jminfo_category_data, tvb, offset, 2, word,\r\n"Item #%d: %s (0x%04x)", category_count, val_to_str_const(category_id, sprt_jm_info_cat_id_name, "Unknown"), category_id);\r\ncategory_count++;\r\nfield_subtree = proto_item_add_subtree(ti, ett_jminfo_msg_cat_data);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_jminfo_category_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nswitch(category_id)\r\n{\r\ncase SPRT_JM_INFO_CAT_ID_CALL_FUNCT:\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_jminfo_call_function, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_jminfo_category_leftover_bits, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase SPRT_JM_INFO_CAT_ID_MOD_MODES:\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_jminfo_mod_v34_duplex, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_jminfo_mod_v34_half_duplex, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_jminfo_mod_v32bis_v32, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_jminfo_mod_v22bis_v22, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_jminfo_mod_v17, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_jminfo_mod_v29_half_duplex, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_jminfo_mod_v27ter, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_jminfo_mod_v26ter, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_jminfo_mod_v26bis, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_jminfo_mod_v23_duplex, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_jminfo_mod_v23_half_duplex, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_jminfo_mod_v21, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase SPRT_JM_INFO_CAT_ID_PROTOCOLS:\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_jminfo_protocols, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_jminfo_category_leftover_bits, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase SPRT_JM_INFO_CAT_ID_PSTN_ACCESS:\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_jminfo_pstn_access_call_dce_cell, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_jminfo_pstn_access_answ_dce_cell, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_jminfo_pstn_access_dce_on_digital_net, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_jminfo_category_leftover_bits, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase SPRT_JM_INFO_CAT_ID_PCM_MODEM_AVAIL:\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_jminfo_pcm_modem_avail_v90_v92_analog, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_jminfo_pcm_modem_avail_v90_v92_digital, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_jminfo_pcm_modem_avail_v91, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_jminfo_category_leftover_bits, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase SPRT_JM_INFO_CAT_ID_CATEGORY_EXTENSION:\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_jminfo_category_ext_info, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_jminfo_unk_category_info, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\noffset += 2;\r\n} while (tvb_reported_length_remaining(tvb, offset) >= 2);\r\nbreak;\r\ncase SPRT_MODEM_RELAY_MSG_ID_START_JM:\r\nbreak;\r\ncase SPRT_MODEM_RELAY_MSG_ID_CONNECT:\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_connect_selmod, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_connect_compr_dir, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nselcompr = (tvb_get_guint8(tvb, offset) & 0xF0) >> 4;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_connect_selected_compr, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_connect_selected_err_corr, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_connect_tdsr, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_connect_rdsr, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nword = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_connect_dlci_enabled, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nif (p_conv_data->connect_frame_number == 0)\r\n{\r\np_conv_data->connect_frame_number = pinfo->num;\r\nif (word & 0x8000)\r\n{\r\np_conv_data->i_octet_dlci_status = DLCI_PRESENT;\r\n} else {\r\np_conv_data->i_octet_dlci_status = DLCI_ABSENT;\r\n}\r\n}\r\nti = proto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_connect_avail_data_types, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nfield_subtree = proto_item_add_subtree(ti, ett_connect_msg_adt);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_connect_adt_octet_no_format_no_dlci, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_connect_adt_i_raw_bit, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_connect_adt_i_frame, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_connect_adt_i_char_stat, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_connect_adt_i_char_dyn, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_connect_adt_i_octet_cs, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_connect_adt_i_char_stat_cs, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_connect_adt_i_char_dyn_cs, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_subtree, hf_sprt_payload_msg_connect_adt_reserved, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nif (selcompr != SPRT_SELECTED_COMPR_NONE &&\r\nselcompr != SPRT_SELECTED_COMPR_MNP5)\r\n{\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_connect_compr_trans_dict_sz, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_connect_compr_recv_dict_sz, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_connect_compr_trans_str_len, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_connect_compr_recv_str_len, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\n}\r\nif (selcompr != SPRT_SELECTED_COMPR_NONE &&\r\nselcompr != SPRT_SELECTED_COMPR_MNP5 &&\r\nselcompr != SPRT_SELECTED_COMPR_V42_BIS)\r\n{\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_connect_compr_trans_hist_sz, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_connect_compr_recv_hist_sz, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\nbreak;\r\ncase SPRT_MODEM_RELAY_MSG_ID_BREAK:\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_break_source_proto, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_break_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_break_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nbreak;\r\ncase SPRT_MODEM_RELAY_MSG_ID_BREAK_ACK:\r\nbreak;\r\ncase SPRT_MODEM_RELAY_MSG_ID_MR_EVENT:\r\nmr_event_id = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_mr_event_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_mr_evt_reason_code, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nif (mr_event_id == SPRT_MREVT_EVENT_ID_PHYSUP)\r\n{\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_mr_evt_selmod, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_mr_evt_txsen, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_mr_evt_rxsen, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_mr_evt_tdsr, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_mr_evt_rdsr, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nif (tvb_reported_length_remaining(tvb, offset) >= 2)\r\n{\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_mr_evt_txsr, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_mr_evt_rxsr, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\n}\r\n}\r\nbreak;\r\ncase SPRT_MODEM_RELAY_MSG_ID_CLEARDOWN:\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_cleardown_reason_code, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_cleardown_vendor_tag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_cleardown_vendor_info, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nbreak;\r\ncase SPRT_MODEM_RELAY_MSG_ID_PROF_XCHG:\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_profxchg_v42_lapm, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_profxchg_annex_av42, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_profxchg_v44_compr, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_profxchg_v42bis_compr, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_profxchg_mnp5_compr, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_profxchg_reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_profxchg_xidlr2_v42bis_compr_req, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_profxchg_xidlr3and4_v42bis_num_codewords, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_profxchg_xidlr5_v42bis_max_strlen, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_profxchg_xidlr6_v44_capability, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_profxchg_xidlr7_v44_compr_req, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_profxchg_xidlr8and9_v44_num_codewords_trans, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_profxchg_xidlr10and11_v44_num_codewords_recv, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_profxchg_xidlr12_v44_max_strlen_trans, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_profxchg_xidlr13_v44_max_strlen_recv, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_profxchg_xidlr14and15_v44_history_len_trans, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_msg_profxchg_xidlr16and17_v44_history_len_recv, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nbreak;\r\ncase SPRT_MODEM_RELAY_MSG_ID_I_RAW_OCTET:\r\noctet = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_rawoctet_n_field_present, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_rawoctet_l, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nif (octet & 0x80)\r\n{\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_rawoctet_n, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\noffset++;\r\npayload_length--;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_data, tvb, offset, payload_length, ENC_NA);\r\nbreak;\r\ncase SPRT_MODEM_RELAY_MSG_ID_I_RAW_BIT:\r\nswitch((tvb_get_guint8(tvb, offset) & 0xC0) >> 6)\r\n{\r\ncase 0x0:\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_rawbit_included_fields_l, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_rawbit_len_a, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\npayload_length--;\r\nbreak;\r\ncase 0x1:\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_rawbit_included_fields_lp, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_rawbit_len_b, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_rawbit_p, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\npayload_length--;\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_rawbit_included_fields_lpn, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_rawbit_len_c, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_rawbit_p, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\npayload_length--;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_rawbit_n, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\npayload_length--;\r\nbreak;\r\n}\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_data, tvb, offset, payload_length, ENC_NA);\r\nbreak;\r\ncase SPRT_MODEM_RELAY_MSG_ID_I_OCTET:\r\nif (global_sprt_show_dlci_info)\r\n{\r\nswitch(p_conv_data->i_octet_dlci_status)\r\n{\r\ncase DLCI_PRESENT:\r\noctet = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_i_octet_dlci1, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_i_octet_cr, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_i_octet_ea, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\npayload_length--;\r\nif (!(octet & 0x01))\r\n{\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_i_octet_dlci2, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_i_octet_ea, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\npayload_length--;\r\n}\r\nti = proto_tree_add_uint(sprt_payload_tree, hf_sprt_payload_i_octet_dlci_setup_by_connect_frame, tvb, 0, 0, p_conv_data->connect_frame_number);\r\nPROTO_ITEM_SET_GENERATED(ti);\r\nbreak;\r\ncase DLCI_ABSENT:\r\nti = proto_tree_add_item(sprt_payload_tree, hf_sprt_payload_i_octet_no_dlci, tvb, 0, 0, ENC_NA);\r\nPROTO_ITEM_SET_GENERATED(ti);\r\nti = proto_tree_add_uint(sprt_payload_tree, hf_sprt_payload_i_octet_dlci_setup_by_connect_frame, tvb, 0, 0, p_conv_data->connect_frame_number);\r\nPROTO_ITEM_SET_GENERATED(ti);\r\nbreak;\r\ncase DLCI_UNKNOWN:\r\ndefault:\r\nti = proto_tree_add_item(sprt_payload_tree, hf_sprt_payload_i_octet_dlci_presence_unknown, tvb, 0, 0, ENC_NA);\r\nPROTO_ITEM_SET_GENERATED(ti);\r\nbreak;\r\n}\r\n}\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_data, tvb, offset, payload_length, ENC_NA);\r\nbreak;\r\ncase SPRT_MODEM_RELAY_MSG_ID_I_CHAR_STAT:\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_data_reserved_bit, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_data_num_data_bits, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_data_parity_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_num_stop_bits, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\npayload_length--;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_data, tvb, offset, payload_length, ENC_NA);\r\nbreak;\r\ncase SPRT_MODEM_RELAY_MSG_ID_I_CHAR_DYN:\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_data_reserved_bit, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_data_num_data_bits, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_data_parity_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_num_stop_bits, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\npayload_length--;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_data, tvb, offset, payload_length, ENC_NA);\r\nbreak;\r\ncase SPRT_MODEM_RELAY_MSG_ID_I_FRAME:\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_frame_reserved_bits, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_frame_state, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\npayload_length--;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_data, tvb, offset, payload_length, ENC_NA);\r\nbreak;\r\ncase SPRT_MODEM_RELAY_MSG_ID_I_OCTET_CS:\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_data_cs, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\npayload_length -= 2;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_data, tvb, offset, payload_length, ENC_NA);\r\nbreak;\r\ncase SPRT_MODEM_RELAY_MSG_ID_I_CHAR_STAT_CS:\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_data_reserved_bit, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_data_num_data_bits, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_data_parity_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_num_stop_bits, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\npayload_length--;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_data_cs, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\npayload_length -= 2;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_data, tvb, offset, payload_length, ENC_NA);\r\nbreak;\r\ncase SPRT_MODEM_RELAY_MSG_ID_I_CHAR_DYN_CS:\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_data_reserved_bit, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_data_num_data_bits, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_data_parity_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_num_stop_bits, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\npayload_length--;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_data_cs, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\npayload_length -= 2;\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_data, tvb, offset, payload_length, ENC_NA);\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(sprt_payload_tree, hf_sprt_payload_data, tvb, offset, payload_length, ENC_NA);\r\nbreak;\r\n}\r\n} else {\r\nproto_tree_add_item(sprt_tree, hf_sprt_payload_no_data, tvb, offset, 0, ENC_NA);\r\ncol_append_str(pinfo->cinfo, COL_INFO, ", No Payload");\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_sprt(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data _U_)\r\n{\r\nproto_item *ti;\r\nproto_tree *sprt_tree = NULL;\r\nproto_tree *sprt_ack_field_tree;\r\nguint16 word1;\r\nunsigned int offset = 0;\r\nguint payload_length;\r\nstruct _sprt_conversation_info *p_conv_data = NULL;\r\nint i;\r\nguint16 tc;\r\nguint16 seqnum;\r\nguint16 noa;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "SPRT");\r\ncol_clear(pinfo->cinfo, COL_INFO);\r\nif (tree)\r\n{\r\nti = proto_tree_add_item(tree, proto_sprt, tvb, 0, -1, ENC_NA);\r\nsprt_tree = proto_item_add_subtree(ti, ett_sprt);\r\nif (global_sprt_show_setup_info)\r\n{\r\nshow_setup_info(tvb, pinfo, sprt_tree);\r\n}\r\n}\r\nword1 = tvb_get_ntohs(tvb, offset + 2);\r\ntc = (word1 & 0xC000) >> 14;\r\nseqnum = word1 & 0x3FFF;\r\nnoa = (tvb_get_ntohs(tvb, offset + 4) & 0xC000) >> 14;\r\np_conv_data = find_sprt_conversation_data(pinfo);\r\nif (!p_conv_data)\r\n{\r\nsprt_add_address(pinfo,\r\n&pinfo->src, pinfo->srcport,\r\n0,\r\n"SPRT stream",\r\npinfo->num);\r\np_conv_data = find_sprt_conversation_data(pinfo);\r\n}\r\nproto_tree_add_item(sprt_tree, hf_sprt_header_extension_bit, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_tree, hf_sprt_subsession_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sprt_tree, hf_sprt_reserved_bit, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_tree, hf_sprt_payload_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(sprt_tree, hf_sprt_transport_channel_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nti = proto_tree_add_item(sprt_tree, hf_sprt_sequence_number, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nif (tc == 0 && seqnum != 0)\r\nexpert_add_info(pinfo, ti, &ei_sprt_sequence_number_0);\r\np_conv_data->seqnum[tc] = seqnum;\r\noffset+=2;\r\nproto_tree_add_item(sprt_tree, hf_sprt_number_of_ack_fields, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_tree, hf_sprt_base_sequence_number, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset+=2;\r\nif (noa)\r\n{\r\nti = proto_tree_add_item(sprt_tree, hf_sprt_ack_field_items, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nsprt_ack_field_tree = proto_item_add_subtree(ti, ett_sprt_ack_fields);\r\nfor(i = 0; i < noa; i++)\r\n{\r\nproto_tree_add_item(sprt_ack_field_tree, hf_sprt_transport_channel_item, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sprt_ack_field_tree, hf_sprt_sequence_item, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\n}\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "TC=%u", tc);\r\nif (tc != 0)\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ", Seq=%u", seqnum);\r\npayload_length = tvb_captured_length(tvb) - (6 + noa * 2);\r\ndissect_sprt_data(tvb, pinfo, p_conv_data, sprt_tree, offset, payload_length);\r\nif (noa)\r\ncol_append_str(pinfo->cinfo, COL_INFO, " (ACK fields present)");\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic gboolean\r\ndissect_sprt_heur(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data _U_)\r\n{\r\nguint8 octet, extension_bit, reserved_bit, payload_type;\r\nguint16 word, tc, seqnum;\r\nunsigned int offset = 0;\r\nif (tvb_captured_length(tvb) < 6)\r\nreturn FALSE;\r\nextension_bit = tvb_get_guint8(tvb, offset) & 0x7F;\r\nif (extension_bit != 0)\r\nreturn FALSE;\r\noctet = tvb_get_guint8(tvb, offset + 1);\r\nreserved_bit = octet & 80;\r\npayload_type = octet & 0x7F;\r\nif (reserved_bit != 0)\r\nreturn FALSE;\r\nif (payload_type < 96 || payload_type > 128)\r\nreturn FALSE;\r\nword = tvb_get_ntohs(tvb, offset + 2);\r\ntc = word >> 14;\r\nseqnum = word & 0x3F;\r\nif ((tc == 0 || tc == 3) && (seqnum != 0))\r\nreturn FALSE;\r\ndissect_sprt(tvb, pinfo, tree, NULL);\r\nreturn TRUE;\r\n}\r\nvoid\r\nproto_register_sprt(void)\r\n{\r\nmodule_t *sprt_module;\r\nexpert_module_t* expert_sprt;\r\nstatic hf_register_info hf[] =\r\n{\r\n{\r\n&hf_sprt_setup,\r\n{\r\n"Stream setup",\r\n"sprt.setup",\r\nFT_STRING,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\n"Stream setup, method and frame number", HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_setup_frame,\r\n{\r\n"Setup frame",\r\n"sprt.setup-frame",\r\nFT_FRAMENUM,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\n"Frame that set up this stream", HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_setup_method,\r\n{\r\n"Setup Method",\r\n"sprt.setup-method",\r\nFT_STRING,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\n"Method used to set up this stream", HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_header_extension_bit,\r\n{\r\n"Header extension bit",\r\n"sprt.x",\r\nFT_BOOLEAN,\r\n8,\r\nTFS(&tfs_set_notset),\r\n0x80,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_subsession_id,\r\n{\r\n"Sub session ID",\r\n"sprt.ssid",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x7F,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_reserved_bit,\r\n{\r\n"Reserved bit",\r\n"sprt.reserved",\r\nFT_BOOLEAN,\r\n8,\r\nTFS(&tfs_set_notset),\r\n0x80,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_type,\r\n{\r\n"Payload type",\r\n"sprt.pt",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x7F,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_transport_channel_id,\r\n{\r\n"Transport channel ID",\r\n"sprt.tc",\r\nFT_UINT16,\r\nBASE_DEC,\r\nVALS(sprt_transport_channel_characteristics),\r\n0xC000,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_sequence_number,\r\n{\r\n"Sequence number",\r\n"sprt.seq",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x3FFF,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_number_of_ack_fields,\r\n{\r\n"Number of ACK fields",\r\n"sprt.noa",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0xC000,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_base_sequence_number,\r\n{\r\n"Base sequence number",\r\n"sprt.bsqn",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x3FFF,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_ack_field_items,\r\n{\r\n"ACK fields",\r\n"sprt.ack.field",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0xC000,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_transport_channel_item,\r\n{\r\n"Transport control channel",\r\n"sprt.tcn",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0xC000,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_sequence_item,\r\n{\r\n"Sequence number",\r\n"sprt.sqn",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x3FFF,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_length,\r\n{\r\n"Payload (in bytes)",\r\n"sprt.payload.length",\r\nFT_UINT32,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_no_data,\r\n{\r\n"No payload",\r\n"sprt.payload",\r\nFT_NONE,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_reserved_bit,\r\n{\r\n"Reserved bit",\r\n"sprt.payload.reserved_bit",\r\nFT_BOOLEAN,\r\n8,\r\nTFS(&tfs_set_notset),\r\n0x80,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_message_id,\r\n{\r\n"Payload message ID",\r\n"sprt.payload.msgid",\r\nFT_UINT8,\r\nBASE_DEC | BASE_RANGE_STRING,\r\nRVALS(sprt_modem_relay_msg_id_name),\r\n0x7F,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_init_all_fields,\r\n{\r\n"Init message fields",\r\n"sprt.payload.msg_init.all_fields",\r\nFT_UINT16,\r\nBASE_HEX,\r\nNULL,\r\n0xFFFF,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_init_necrxch,\r\n{\r\n"NECRxCH",\r\n"sprt.payload.msg_init.NECRxCH",\r\nFT_BOOLEAN,\r\n16,\r\nNULL,\r\n0x8000,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_init_ecrxch,\r\n{\r\n"ECRxCH",\r\n"sprt.payload.msg_init.ECRxCH",\r\nFT_BOOLEAN,\r\n16,\r\nNULL,\r\n0x4000,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_init_xid_prof_exch,\r\n{\r\n"XID profile exchange",\r\n"sprt.payload.msg_init.XID_profile_exch",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_supported_not_supported),\r\n0x2000,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_init_assym_data_types,\r\n{\r\n"Asymmetrical data types",\r\n"sprt.payload.msg_init.assym_data_types",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_supported_not_supported),\r\n0x1000,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_init_opt_moip_types_i_raw_bit,\r\n{\r\n"I_RAW-BIT",\r\n"sprt.payload.msg_init.opt_moip_types_i_raw_bit",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_supported_not_supported),\r\n0x0800,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_init_opt_moip_types_i_frame,\r\n{\r\n"I_FRAME",\r\n"sprt.payload.msg_init.opt_moip_types_i_frame",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_supported_not_supported),\r\n0x0400,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_init_opt_moip_types_i_char_stat,\r\n{\r\n"I_CHAR-STAT",\r\n"sprt.payload.msg_init.opt_moip_types_i_char_stat",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_supported_not_supported),\r\n0x0200,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_init_opt_moip_types_i_char_dyn,\r\n{\r\n"I_CHAR-DYN",\r\n"sprt.payload.msg_init.opt_moip_types_i_char_dyn",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_supported_not_supported),\r\n0x0100,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_init_opt_moip_types_i_octet_cs,\r\n{\r\n"I_OCTET-CS",\r\n"sprt.payload.msg_init.opt_moip_types_i_octet_cs",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_supported_not_supported),\r\n0x0080,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_init_opt_moip_types_i_char_stat_cs,\r\n{\r\n"I_CHAR-STAT-CS",\r\n"sprt.payload.msg_init.opt_moip_types_i_char_stat_cs",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_supported_not_supported),\r\n0x0040,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_init_opt_moip_types_i_char_dyn_cs,\r\n{\r\n"I_CHAR-DYN-CS",\r\n"sprt.payload.msg_init.opt_moip_types_i_char_dyn_cs",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_supported_not_supported),\r\n0x0020,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_init_opt_moip_types_reserved,\r\n{\r\n"Reserved for ITU-T",\r\n"sprt.payload.msg_init.opt_moip_types_reserved",\r\nFT_UINT16,\r\nBASE_HEX,\r\nNULL,\r\n0x001F,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_xidxchg_ecp,\r\n{\r\n"Error correcting protocol",\r\n"sprt.payload.msg_xidxchg.ecp",\r\nFT_UINT8,\r\nBASE_DEC | BASE_RANGE_STRING,\r\nRVALS(sprt_ecp_name),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_xidxchg_xidlr1_v42bis,\r\n{\r\n"V.42 bis",\r\n"sprt.payload.msg_xidxchg.xidlr1_v42bis",\r\nFT_BOOLEAN,\r\n8,\r\nTFS(&tfs_supported_not_supported),\r\n0x80,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_xidxchg_xidlr1_v44,\r\n{\r\n"V.44",\r\n"sprt.payload.msg_xidxchg.xidlr1_v44",\r\nFT_BOOLEAN,\r\n8,\r\nTFS(&tfs_supported_not_supported),\r\n0x40,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_xidxchg_xidlr1_mnp5,\r\n{\r\n"MNP5",\r\n"sprt.payload.msg_xidxchg.xidlr1_mnp5",\r\nFT_BOOLEAN,\r\n8,\r\nTFS(&tfs_supported_not_supported),\r\n0x20,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_xidxchg_xidlr1_reserved,\r\n{\r\n"Reserved for ITU-T",\r\n"sprt.payload.msg_xidxchg.xidlr1_reserved",\r\nFT_UINT8,\r\nBASE_HEX,\r\nNULL,\r\n0x1F,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_xidxchg_xidlr2_v42bis_compr_req,\r\n{\r\n"V.42bis data compression request",\r\n"sprt.payload.msg_xidxchg.xidlr2_v42bis_compr_req",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_xidxchg_xidlr3and4_v42bis_num_codewords,\r\n{\r\n"V.42bis number of codewords",\r\n"sprt.payload.msg_xidxchg.xidlr3and4_v42bis_num_codewords",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_xidxchg_xidlr5_v42bis_max_strlen,\r\n{\r\n"V.42bis maximum string length",\r\n"sprt.payload.msg_xidxchg.xidlr5_v42bis_max_strlen",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_xidxchg_xidlr6_v44_capability,\r\n{\r\n"V.44 capability",\r\n"sprt.payload.msg_xidxchg.xidlr6_v44_capability",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_xidxchg_xidlr7_v44_compr_req,\r\n{\r\n"V.44 data compression request",\r\n"sprt.payload.msg_xidxchg.xidlr7_v44_compr_req",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_xidxchg_xidlr8and9_v44_num_codewords_trans,\r\n{\r\n"V.44 number of codewords in transmit direction",\r\n"sprt.payload.msg_xidxchg.xidlr8and9_v44_num_codewords_trans",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_xidxchg_xidlr10and11_v44_num_codewords_recv,\r\n{\r\n"V.44 number of codewords in receive direction",\r\n"sprt.payload.msg_xidxchg.xidlr10and11_v44_num_codewords_recv",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_xidxchg_xidlr12_v44_max_strlen_trans,\r\n{\r\n"V.44 maximum string length in transmit direction",\r\n"sprt.payload.msg_xidxchg.xidlr12_v44_max_strlen_trans",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_xidxchg_xidlr13_v44_max_strlen_recv,\r\n{\r\n"V.44 maximum string length in receive direction",\r\n"sprt.payload.msg_xidxchg.xidlr13_v44_max_strlen_recv",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_xidxchg_xidlr14and15_v44_history_len_trans,\r\n{\r\n"V.44 length of history in transmit direction",\r\n"sprt.payload.msg_xidxchg.xidlr14and15_v44_history_len_trans",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_xidxchg_xidlr16and17_v44_history_len_recv,\r\n{\r\n"V.44 length of history in receive direction",\r\n"sprt.payload.msg_xidxchg.xidlr16and17_v44_history_len_recv",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_jminfo_category_data,\r\n{\r\n"Category data",\r\n"sprt.payload.msg_jminfo.category_data",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0xFFFF,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_jminfo_category_id,\r\n{\r\n"Category ID",\r\n"sprt.payload.msg_jminfo.category_id",\r\nFT_UINT16,\r\nBASE_HEX,\r\nVALS(sprt_jm_info_cat_id_name),\r\n0xF000,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_jminfo_category_ext_info,\r\n{\r\n"Unrecognized category data",\r\n"sprt.payload.msg_jminfo.category_ext_info",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0FFF,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_jminfo_unk_category_info,\r\n{\r\n"Category extension data",\r\n"sprt.payload.msg_jminfo.unk_category_info",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0FFF,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_jminfo_category_leftover_bits,\r\n{\r\n"Leftover bits",\r\n"sprt.payload.msg_jminfo.category_leftover_bits",\r\nFT_UINT16,\r\nBASE_HEX,\r\nNULL,\r\n0x01FF,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_jminfo_call_function,\r\n{\r\n"Call function",\r\n"sprt.payload.msg_jminfo.call_function",\r\nFT_UINT16,\r\nBASE_DEC,\r\nVALS(sprt_jminfo_tbc_call_funct_name),\r\n0x0E00,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_jminfo_mod_v34_duplex,\r\n{\r\n"V.34 duplex",\r\n"sprt.payload.msg_jminfo.mod_v34_duplex",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_available_not_available),\r\n0x0800,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_jminfo_mod_v34_half_duplex,\r\n{\r\n"V.34 half-duplex",\r\n"sprt.payload.msg_jminfo.mod_v34_half_duplex",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_available_not_available),\r\n0x0400,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_jminfo_mod_v32bis_v32,\r\n{\r\n"V.32bis/V.32",\r\n"sprt.payload.msg_jminfo.mod_v32bis_v32",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_available_not_available),\r\n0x0200,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_jminfo_mod_v22bis_v22,\r\n{\r\n"V.22bis/V.22",\r\n"sprt.payload.msg_jminfo.mod_v22bis_v22",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_available_not_available),\r\n0x0100,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_jminfo_mod_v17,\r\n{\r\n"V.17",\r\n"sprt.payload.msg_jminfo.mod_v17",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_available_not_available),\r\n0x0080,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_jminfo_mod_v29_half_duplex,\r\n{\r\n"V.29 half-duplex",\r\n"sprt.payload.msg_jminfo.mod_v29_half_duplex",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_available_not_available),\r\n0x0040,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_jminfo_mod_v27ter,\r\n{\r\n"V.27ter",\r\n"sprt.payload.msg_jminfo.mod_v27ter",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_available_not_available),\r\n0x0020,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_jminfo_mod_v26ter,\r\n{\r\n"V.26ter",\r\n"sprt.payload.msg_jminfo.mod_v26ter",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_available_not_available),\r\n0x0010,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_jminfo_mod_v26bis,\r\n{\r\n"V.26bis",\r\n"sprt.payload.msg_jminfo.mod_v16bis",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_available_not_available),\r\n0x0008,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_jminfo_mod_v23_duplex,\r\n{\r\n"V.23 duplex",\r\n"sprt.payload.msg_jminfo.mod_v23_duplex",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_available_not_available),\r\n0x0004,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_jminfo_mod_v23_half_duplex,\r\n{\r\n"V.23 half-duplex",\r\n"sprt.payload.msg_jminfo.mod_v23_half_duplex",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_available_not_available),\r\n0x0002,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_jminfo_mod_v21,\r\n{\r\n"V.21",\r\n"sprt.payload.msg_jminfo.mod_v21",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_available_not_available),\r\n0x0001,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_jminfo_protocols,\r\n{\r\n"Protocols",\r\n"sprt.payload.msg_jminfo.protocols",\r\nFT_UINT16,\r\nBASE_DEC | BASE_RANGE_STRING,\r\nRVALS(sprt_jminfo_tbc_protocol_name),\r\n0x0E00,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_jminfo_pstn_access_call_dce_cell,\r\n{\r\n"Call DCE is on a cellular connection",\r\n"sprt.payload.msg_jminfo.pstn_access_call_dce_cell",\r\nFT_BOOLEAN,\r\n16,\r\nNULL,\r\n0x0800,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_jminfo_pstn_access_answ_dce_cell,\r\n{\r\n"Answer DCE is on a cellular connection",\r\n"sprt.payload.msg_jminfo.pstn_access_answ_dce_cell",\r\nFT_BOOLEAN,\r\n16,\r\nNULL,\r\n0x0400,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_jminfo_pstn_access_dce_on_digital_net,\r\n{\r\n"DCE is on a digital network connection",\r\n"sprt.payload.msg_jminfo.pstn_access_dce_on_digital_net",\r\nFT_BOOLEAN,\r\n16,\r\nNULL,\r\n0x0200,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_jminfo_pcm_modem_avail_v90_v92_analog,\r\n{\r\n"V.90 or V.92 analog modem availability",\r\n"sprt.payload.msg_jminfo.pcm_modem_avail_v90_v92_analog",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_available_not_available),\r\n0x0800,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_jminfo_pcm_modem_avail_v90_v92_digital,\r\n{\r\n"V.90 or V.92 digital modem availability",\r\n"sprt.payload.msg_jminfo.pcm_modem_avail_v90_v92_digital",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_available_not_available),\r\n0x0400,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_jminfo_pcm_modem_avail_v91,\r\n{\r\n"V.91 modem availability",\r\n"sprt.payload.msg_jminfo.pcm_modem_avail_v91",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_available_not_available),\r\n0x0200,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_connect_selmod,\r\n{\r\n"Selected modulation",\r\n"sprt.payload.msg_connect.selmod",\r\nFT_UINT8,\r\nBASE_DEC | BASE_RANGE_STRING,\r\nRVALS(sprt_selmod_name),\r\n0xFC,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_connect_compr_dir,\r\n{\r\n"Compression direction",\r\n"sprt.payload.msg_connect.compr_dir",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(sprt_comp_direction),\r\n0x03,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_connect_selected_compr,\r\n{\r\n"Selected compression",\r\n"sprt.payload.msg_connect.selected_compr",\r\nFT_UINT8,\r\nBASE_DEC | BASE_RANGE_STRING,\r\nRVALS(sprt_selected_compr_name),\r\n0xF0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_connect_selected_err_corr,\r\n{\r\n"Selected error correction",\r\n"sprt.payload.msg_connect.selected_err_corr",\r\nFT_UINT8,\r\nBASE_DEC | BASE_RANGE_STRING,\r\nRVALS(sprt_selected_err_corr_name),\r\n0x0F,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_connect_tdsr,\r\n{\r\n"Transmit data signalling rate (bits/sec)",\r\n"sprt.payload.msg_connect.tdsr",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_connect_rdsr,\r\n{\r\n"Receive data signalling rate (bits/sec)",\r\n"sprt.payload.msg_connect.rdsr",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_connect_dlci_enabled,\r\n{\r\n"DLCI",\r\n"sprt.payload.msg_connect.dlci_enabled",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_enabled_disabled),\r\n0x8000,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_connect_avail_data_types,\r\n{\r\n"Available data types",\r\n"sprt.payload.msg_connect.avail_data_types",\r\nFT_UINT16,\r\nBASE_HEX,\r\nNULL,\r\n0x7FFF,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_connect_adt_octet_no_format_no_dlci,\r\n{\r\n"Octet w/o formatting with no DLCI",\r\n"sprt.payload.msg_connect.adt_octet_no_format_no_dlci",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_available_not_available),\r\n0x4000,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_connect_adt_i_raw_bit,\r\n{\r\n"I_RAW-BIT",\r\n"sprt.payload.msg_connect.adt_i_raw_bit",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_available_not_available),\r\n0x2000,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_connect_adt_i_frame,\r\n{\r\n"I_FRAME",\r\n"sprt.payload.msg_connect.adt_i_frame",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_available_not_available),\r\n0x1000,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_connect_adt_i_char_stat,\r\n{\r\n"I_CHAR-STAT",\r\n"sprt.payload.msg_connect.adt_i_char_stat",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_available_not_available),\r\n0x0800,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_connect_adt_i_char_dyn,\r\n{\r\n"I_CHAR-DYN",\r\n"sprt.payload.msg_connect.adt_i_char_dyn",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_available_not_available),\r\n0x0400,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_connect_adt_i_octet_cs,\r\n{\r\n"I_OCTET-CS",\r\n"sprt.payload.msg_connect.adt_i_octet_cs",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_available_not_available),\r\n0x0200,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_connect_adt_i_char_stat_cs,\r\n{\r\n"I_CHAR-STAT-CS",\r\n"sprt.payload.msg_connect.adt_i_char_stat_cs",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_available_not_available),\r\n0x0100,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_connect_adt_i_char_dyn_cs,\r\n{\r\n"I_CHAR-DYN-CS",\r\n"sprt.payload.msg_connect.adt_i_char_dyn_cs",\r\nFT_BOOLEAN,\r\n16,\r\nTFS(&tfs_available_not_available),\r\n0x0080,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_connect_adt_reserved,\r\n{\r\n"Reserved for ITU-T",\r\n"sprt.payload.msg_connect.adt_reserved",\r\nFT_UINT16,\r\nBASE_HEX,\r\nNULL,\r\n0x007F,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_connect_compr_trans_dict_sz,\r\n{\r\n"Compression transmit dictionary size",\r\n"sprt.payload.msg_connect.compr_trans_dict_sz",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_connect_compr_recv_dict_sz,\r\n{\r\n"Compression receive dictionary size",\r\n"sprt.payload.msg_connect.compr_recv_dict_sz",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_connect_compr_trans_str_len,\r\n{\r\n"Compression transmit string length",\r\n"sprt.payload.msg_connect.compr_trans_str_len",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_connect_compr_recv_str_len,\r\n{\r\n"Compression receive string length",\r\n"sprt.payload.msg_connect.compr_recv_str_len",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_connect_compr_trans_hist_sz,\r\n{\r\n"Compression transmit history size",\r\n"sprt.payload.msg_connect.compr_trans_hist_sz",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_connect_compr_recv_hist_sz,\r\n{\r\n"Compression receive history size",\r\n"sprt.payload.msg_connect.compr_recv_hist_sz",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_break_source_proto,\r\n{\r\n"Break source protocol",\r\n"sprt.payload.msg_break.source_proto",\r\nFT_UINT8,\r\nBASE_DEC | BASE_RANGE_STRING,\r\nRVALS(sprt_break_src_proto_name),\r\n0xF0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_break_type,\r\n{\r\n"Break type",\r\n"sprt.payload.msg_break.type",\r\nFT_UINT8,\r\nBASE_DEC | BASE_RANGE_STRING,\r\nRVALS(sprt_break_type_name),\r\n0x0F,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_break_length,\r\n{\r\n"Break length (x10 msec)",\r\n"sprt.payload.msg_break.length",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_mr_event_id,\r\n{\r\n"Modem relay event ID",\r\n"sprt.payload.msg_mr_event.id",\r\nFT_UINT8,\r\nBASE_DEC | BASE_RANGE_STRING,\r\nRVALS(sprt_mrevent_id_name),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_mr_evt_reason_code,\r\n{\r\n"Reason code",\r\n"sprt.payload.msg_mr_event.reason_code",\r\nFT_UINT8,\r\nBASE_DEC | BASE_RANGE_STRING,\r\nRVALS(sprt_mrevent_reason_code_name),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_mr_evt_selmod,\r\n{\r\n"Selected modulation",\r\n"sprt.payload.msg_mr_event.selmod",\r\nFT_UINT8,\r\nBASE_DEC | BASE_RANGE_STRING,\r\nRVALS(sprt_selmod_name),\r\n0xFC,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_mr_evt_txsen,\r\n{\r\n"TxSEN",\r\n"sprt.payload.msg_mr_event.txsen",\r\nFT_BOOLEAN,\r\n8,\r\nTFS(&tfs_enabled_disabled),\r\n0x02,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_mr_evt_rxsen,\r\n{\r\n"RxSEN",\r\n"sprt.payload.msg_mr_event.rxsen",\r\nFT_BOOLEAN,\r\n8,\r\nTFS(&tfs_enabled_disabled),\r\n0x01,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_mr_evt_tdsr,\r\n{\r\n"Transmit data signalling rate (bits/sec)",\r\n"sprt.payload.msg_mr_event.tdsr",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_mr_evt_rdsr,\r\n{\r\n"Receive data signalling rate (bits/sec)",\r\n"sprt.payload.msg_mr_event.rdsr",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_mr_evt_txsr,\r\n{\r\n"Physical layer transmitter symbol rate (TxSR)",\r\n"sprt.payload.msg_mr_event.txsr",\r\nFT_UINT8,\r\nBASE_DEC | BASE_RANGE_STRING,\r\nRVALS(sprt_mrevent_phys_layer_symbol_rate),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_mr_evt_rxsr,\r\n{\r\n"Physical layer receiver symbol rate (RxSR)",\r\n"sprt.payload.msg_mr_event.rxsr",\r\nFT_UINT8,\r\nBASE_DEC | BASE_RANGE_STRING,\r\nRVALS(sprt_mrevent_phys_layer_symbol_rate),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_cleardown_reason_code,\r\n{\r\n"Reason code",\r\n"sprt.payload.msg_cleardown.reason_code",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(sprt_cleardown_reason),\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_cleardown_vendor_tag,\r\n{\r\n"Vendor tag",\r\n"sprt.payload.msg_cleardown.vendor_tag",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_cleardown_vendor_info,\r\n{\r\n"Vendor info",\r\n"sprt.payload.msg_cleardown.vendor_info",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_profxchg_v42_lapm,\r\n{\r\n"V.42/LAPM protocol support",\r\n"sprt.payload.msg_profxchg.v42_lapm",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(sprt_prof_xchg_support),\r\n0xC0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_profxchg_annex_av42,\r\n{\r\n"Annex A/V.42(1996) protocol support",\r\n"sprt.payload.msg_profxchg.annex_av42",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(sprt_prof_xchg_support),\r\n0x30,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_profxchg_v44_compr,\r\n{\r\n"V.44 compression support",\r\n"sprt.payload.msg_profxchg.v44_compr",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(sprt_prof_xchg_support),\r\n0x0C,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_profxchg_v42bis_compr,\r\n{\r\n"V.42bis compression support",\r\n"sprt.payload.msg_profxchg.v42bis_compr",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(sprt_prof_xchg_support),\r\n0x03,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_profxchg_mnp5_compr,\r\n{\r\n"MNP5 compression support",\r\n"sprt.payload.msg_profxchg.mnp5_compr",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(sprt_prof_xchg_support),\r\n0xC0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_profxchg_reserved,\r\n{\r\n"Reserved for ITU-T",\r\n"sprt.payload.msg_profxchg.reserved",\r\nFT_UINT8,\r\nBASE_HEX,\r\nNULL,\r\n0x3F,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_profxchg_xidlr2_v42bis_compr_req,\r\n{\r\n"V.42bis data compression request",\r\n"sprt.payload.msg_profxchg.xidlr2_v42bis_compr_req",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_profxchg_xidlr3and4_v42bis_num_codewords,\r\n{\r\n"V.42bis number of codewords",\r\n"sprt.payload.msg_profxchg.xidlr3and4_v42bis_num_codewords",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_profxchg_xidlr5_v42bis_max_strlen,\r\n{\r\n"V.42bis maximum string length",\r\n"sprt.payload.msg_profxchg.xidlr5_v42bis_max_strlen",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_profxchg_xidlr6_v44_capability,\r\n{\r\n"V.44 capability",\r\n"sprt.payload.msg_profxchg.xidlr6_v44_capability",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_profxchg_xidlr7_v44_compr_req,\r\n{\r\n"V.44 data compression request",\r\n"sprt.payload.msg_profxchg.xidlr7_v44_compr_req",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_profxchg_xidlr8and9_v44_num_codewords_trans,\r\n{\r\n"V.44 number of codewords in transmit direction",\r\n"sprt.payload.msg_profxchg.xidlr8and9_v44_num_codewords_trans",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_profxchg_xidlr10and11_v44_num_codewords_recv,\r\n{\r\n"V.44 number of codewords in receive direction",\r\n"sprt.payload.msg_profxchg.xidlr10and11_v44_num_codewords_recv",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_profxchg_xidlr12_v44_max_strlen_trans,\r\n{\r\n"V.44 maximum string length in transmit direction",\r\n"sprt.payload.msg_profxchg.xidlr12_v44_max_strlen_trans",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_profxchg_xidlr13_v44_max_strlen_recv,\r\n{\r\n"V.44 maximum string length in receive direction",\r\n"sprt.payload.msg_profxchg.xidlr13_v44_max_strlen_recv",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_profxchg_xidlr14and15_v44_history_len_trans,\r\n{\r\n"V.44 length of history in transmit direction",\r\n"sprt.payload.msg_profxchg.xidlr14and15_v44_history_len_trans",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_msg_profxchg_xidlr16and17_v44_history_len_recv,\r\n{\r\n"V.44 length of history in receive direction",\r\n"sprt.payload.msg_profxchg.xidlr16and17_v44_history_len_recv",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_i_octet_no_dlci,\r\n{\r\n"No DLCI field",\r\n"sprt.payload.i_octet_no_dlci",\r\nFT_NONE,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_i_octet_dlci_presence_unknown,\r\n{\r\n"Not known if DLCI field is present",\r\n"sprt.payload.i_octet_dlci_presence_unknown",\r\nFT_NONE,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_i_octet_dlci1,\r\n{\r\n"DLCI #1",\r\n"sprt.payload.i_octet_dlci1",\r\nFT_UINT8,\r\nBASE_DEC | BASE_RANGE_STRING,\r\nRVALS(sprt_payload_dlci1),\r\n0xFC,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_i_octet_cr,\r\n{\r\n"Command/response bit",\r\n"sprt.payload.i_octet_cr",\r\nFT_BOOLEAN,\r\n8,\r\nNULL,\r\n0x02,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_i_octet_ea,\r\n{\r\n"Address field extension bit",\r\n"sprt.payload.i_octet_ea",\r\nFT_BOOLEAN,\r\n8,\r\nTFS(&sprt_payload_ea_bit),\r\n0x01,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_i_octet_dlci2,\r\n{\r\n"DLCI #2",\r\n"sprt.payload.i_octet_dlci2",\r\nFT_UINT8,\r\nBASE_DEC | BASE_RANGE_STRING,\r\nRVALS(sprt_payload_dlci2),\r\n0xFE,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_i_octet_dlci_setup_by_connect_frame,\r\n{\r\n"DLCI setup by CONNECT message at frame",\r\n"sprt.payload.i_octet_dlci_setup_by_connect_frame",\r\nFT_FRAMENUM,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_rawoctet_n_field_present,\r\n{\r\n"N field",\r\n"sprt.payload.rawoctet_n_field_present",\r\nFT_BOOLEAN,\r\n8,\r\nTFS(&tfs_present_absent),\r\n0x80,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_rawoctet_l,\r\n{\r\n"L: # of octets in segment minus one",\r\n"sprt.payload.rawoctet_l",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x7F,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_rawoctet_n,\r\n{\r\n"N: # of times octets appear in data minus 2",\r\n"sprt.payload.rawoctet_n",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0xFF,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_rawbit_included_fields_l,\r\n{\r\n"Include field L only",\r\n"sprt.payload.rawbit_included_fields_l",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0xC0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_rawbit_included_fields_lp,\r\n{\r\n"Include fields L, P",\r\n"sprt.payload.rawbit_field_format_lp",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0xC0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_rawbit_included_fields_lpn,\r\n{\r\n"Include fields L, P, N",\r\n"sprt.payload.rawbit_included_fields_lpn",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x80,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_rawbit_len_a,\r\n{\r\n"L: # of octets in segment",\r\n"sprt.payload.rawbit_len_a",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x3F,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_rawbit_len_b,\r\n{\r\n"L: # of octets in segment",\r\n"sprt.payload.rawbit_len_b",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x38,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_rawbit_len_c,\r\n{\r\n"L: # of octets in segment",\r\n"sprt.payload.rawbit_len_c",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x78,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_rawbit_p,\r\n{\r\n"P: # of low-order bits in last octet that are not in segment",\r\n"sprt.payload.rawbit_p",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x7,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_rawbit_n,\r\n{\r\n"N: # of times octets appear in data minus 2",\r\n"sprt.payload.rawbit_n",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0xFF,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_data_reserved_bit,\r\n{\r\n"Reserved bit",\r\n"sprt.payload.reserved_bit",\r\nFT_BOOLEAN,\r\n8,\r\nTFS(&tfs_set_notset),\r\n0x80,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_data_num_data_bits,\r\n{\r\n"D: Number of data bits",\r\n"sprt.payload.num_data_bits",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(sprt_payload_data_bits),\r\n0x60,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_data_parity_type,\r\n{\r\n"P: Parity type",\r\n"sprt.payload.parity_type",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(sprt_payload_parity),\r\n0x1C,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_num_stop_bits,\r\n{\r\n"S: Number stop bits",\r\n"sprt.payload.num_stop_bits",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(sprt_payload_stop_bits),\r\n0x03,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_data_cs,\r\n{\r\n"Character sequence number",\r\n"sprt.payload.cs",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_frame_reserved_bits,\r\n{\r\n"Reserved bits",\r\n"sprt.payload.frame_reserved_bits",\r\nFT_UINT8,\r\nBASE_HEX,\r\nNULL,\r\n0xFC,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_frame_state,\r\n{\r\n"Frame state",\r\n"sprt.payload.frame_state",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(sprt_payload_frame_state),\r\n0x03,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_sprt_payload_data,\r\n{\r\n"Payload data",\r\n"sprt.payload.data",\r\nFT_BYTES,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_sprt,\r\n&ett_sprt_setup,\r\n&ett_sprt_ack_fields,\r\n&ett_payload,\r\n&ett_init_msg_all_fields,\r\n&ett_jminfo_msg_cat_data,\r\n&ett_connect_msg_adt\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_sprt_sequence_number_0, { "sprt.sequence_number_0", PI_PROTOCOL, PI_WARN, "Should be 0 for transport channel 0", EXPFILL }},\r\n};\r\nproto_sprt = proto_register_protocol("Simple Packet Relay Transport", "SPRT", "sprt");\r\nproto_register_field_array(proto_sprt, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_sprt = expert_register_protocol(proto_sprt);\r\nexpert_register_field_array(expert_sprt, ei, array_length(ei));\r\nregister_dissector("sprt", dissect_sprt, proto_sprt);\r\nsprt_module = prefs_register_protocol(proto_sprt, NULL);\r\nprefs_register_bool_preference(sprt_module, "show_setup_info",\r\n"Show stream setup information",\r\n"Where available, show which protocol and frame caused "\r\n"this SPRT stream to be created",\r\n&global_sprt_show_setup_info);\r\nprefs_register_bool_preference(sprt_module, "show_dlci_info",\r\n"Show DLCI in I_OCTET messages",\r\n"Show the DLCI field in I_OCTET messages as well as the frame that "\r\n"enabled/disabled the DLCI",\r\n&global_sprt_show_dlci_info);\r\n}\r\nvoid\r\nproto_reg_handoff_sprt(void)\r\n{\r\nsprt_handle = find_dissector("sprt");\r\ndissector_add_for_decode_as("udp.port", sprt_handle);\r\nheur_dissector_add( "udp", dissect_sprt_heur, "SPRT over UDP", "sprt_udp", proto_sprt, HEURISTIC_ENABLE);\r\n}
