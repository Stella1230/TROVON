static int\r\nrsip_parameter(tvbuff_t *tvb, proto_tree *rsip_tree, int off, int eoff)\r\n{\r\nint consumed, i, paramleft;\r\nguint8 addrtype, flowpolicy, method, number, paramtype, tuntype;\r\nguint16 error, ind, paramlen, portnum;\r\nguint32 bid, cid, leasetm, msgc;\r\nproto_tree *p_tree, *v_tree;\r\nproto_item *pti, *vti;\r\nif (off >= eoff)\r\nreturn 0;\r\nparamtype = tvb_get_guint8(tvb, off);\r\nparamlen = tvb_get_ntohs(tvb, off + 1);\r\np_tree = proto_tree_add_subtree(rsip_tree, tvb, off, 3 + paramlen,\r\nett_rsip_param, &pti,\r\nval_to_str(paramtype, param_type_vals, "Unknown (%d)"));\r\nproto_tree_add_item(p_tree, hf_rsip_parameter_type, tvb,\r\noff, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(p_tree, hf_rsip_parameter_length, tvb,\r\noff + 1, 2, ENC_BIG_ENDIAN);\r\nconsumed = 3;\r\nif (paramlen == 0)\r\nreturn consumed;\r\nvti = proto_tree_add_item(p_tree, hf_rsip_parameter_value,\r\ntvb, off + 3, paramlen, ENC_NA);\r\nv_tree = proto_item_add_subtree(vti, ett_rsip_param_val);\r\nswitch (paramtype) {\r\ncase 1:\r\nproto_tree_add_item(v_tree, hf_rsip_parameter_address_type,\r\ntvb, off + 3, 1, ENC_BIG_ENDIAN);\r\naddrtype = tvb_get_guint8(tvb, off + 3);\r\nswitch (addrtype) {\r\ncase 0:\r\nbreak;\r\ncase 1:\r\nif (paramlen - 1 > 0) {\r\nproto_tree_add_item(v_tree,\r\nhf_rsip_parameter_address_ipv4, tvb,\r\noff + 4, paramlen - 1, ENC_BIG_ENDIAN);\r\nproto_item_append_text(pti, ": %s",\r\ntvb_ip_to_str(tvb, off + 4));\r\n} else\r\nproto_item_append_text(pti,\r\n": Any IPv4 Address");\r\nbreak;\r\ncase 2:\r\nif (paramlen - 1 > 0) {\r\nproto_tree_add_item(v_tree,\r\nhf_rsip_parameter_address_ipv4_netmask,\r\ntvb, off + 4, paramlen - 1, ENC_BIG_ENDIAN);\r\nproto_item_append_text(pti, "(netmask): %s",\r\ntvb_ip_to_str(tvb, off + 4));\r\n} else\r\nproto_item_append_text(pti,\r\n": Any IPv4 Netmask");\r\nbreak;\r\ncase 3:\r\nif (paramlen - 1 > 0) {\r\nproto_tree_add_item(v_tree,\r\nhf_rsip_parameter_address_ipv6, tvb,\r\noff + 4, paramlen - 1, ENC_NA);\r\nproto_item_append_text(pti, ": %s",\r\ntvb_ip6_to_str(tvb, off + 4));\r\n} else\r\nproto_item_append_text(pti,\r\n": Any IPv6 Address");\r\nbreak;\r\ncase 4:\r\nif (paramlen - 1 > 0) {\r\nproto_tree_add_item(v_tree,\r\nhf_rsip_parameter_address_fqdn, tvb,\r\noff + 4, paramlen - 1, ENC_ASCII|ENC_NA);\r\nproto_item_append_text(pti, ": %s",\r\ntvb_format_text(tvb, off + 4, paramlen - 1));\r\n} else\r\nproto_item_append_text(pti,\r\n": Any Fully Qualified Domain Name");\r\nbreak;\r\ndefault:\r\nproto_item_append_text(pti, ": Unknown Address Type");\r\nbreak;\r\n}\r\nbreak;\r\ncase 2:\r\nproto_tree_add_item(v_tree, hf_rsip_parameter_ports_number,\r\ntvb, off + 3, 1, ENC_BIG_ENDIAN);\r\nnumber = tvb_get_guint8(tvb, off + 3);\r\nif (paramlen == 1) {\r\nswitch (number) {\r\ncase 0:\r\nproto_item_append_text(pti, ": Unspecified");\r\nbreak;\r\ncase 1:\r\nproto_item_append_text(pti, ": Any port");\r\nbreak;\r\ndefault:\r\nproto_item_append_text(pti, ": Any %d ports",\r\nnumber);\r\nbreak;\r\n}\r\n} else {\r\nportnum = tvb_get_ntohs(tvb, off + 4);\r\nif (number == 1) {\r\nproto_tree_add_item(v_tree,\r\nhf_rsip_parameter_ports_port_number,\r\ntvb, off + 4, 2, ENC_BIG_ENDIAN);\r\n} else {\r\nparamleft = paramlen - 1;\r\nif (paramleft == 2) {\r\nproto_tree_add_uint_format_value(v_tree,\r\nhf_rsip_parameter_ports_port_number,\r\ntvb, off + 4, 2, portnum, "%d - %d",\r\nportnum, portnum + number);\r\nproto_item_append_text(pti,\r\n": %d - %d", portnum,\r\nportnum + number);\r\n} else {\r\nfor (i = off + 4;\r\nparamleft > 0;\r\ni += 2, paramleft -= 2)\r\nproto_tree_add_item(v_tree,\r\nhf_rsip_parameter_ports_port_number,\r\ntvb, i, 2, ENC_BIG_ENDIAN);\r\nproto_item_append_text(pti,\r\n": List of %d Ports", number);\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 3:\r\nproto_tree_add_item(v_tree, hf_rsip_parameter_lease_time,\r\ntvb, off + 3, paramlen, ENC_BIG_ENDIAN);\r\nleasetm = tvb_get_ntohl(tvb, off + 3);\r\nproto_item_append_text(pti, ": %d seconds", leasetm);\r\nbreak;\r\ncase 4:\r\nproto_tree_add_item(v_tree, hf_rsip_parameter_client_id,\r\ntvb, off + 3, paramlen, ENC_BIG_ENDIAN);\r\ncid = tvb_get_ntohl(tvb, off + 3);\r\nproto_item_append_text(pti, ": %d", cid);\r\nbreak;\r\ncase 5:\r\nproto_tree_add_item(v_tree, hf_rsip_parameter_bind_id,\r\ntvb, off + 3, paramlen, ENC_BIG_ENDIAN);\r\nbid = tvb_get_ntohl(tvb, off + 3);\r\nproto_item_append_text(pti, ": %d", bid);\r\nbreak;\r\ncase 6:\r\nproto_tree_add_item(v_tree, hf_rsip_parameter_tunnel_type,\r\ntvb, off + 3, paramlen, ENC_BIG_ENDIAN);\r\ntuntype = tvb_get_guint8(tvb, off + 3);\r\nproto_item_append_text(pti, ": %s",\r\nval_to_str(tuntype, tunnel_type_vals,\r\n"Unknown Tunnel Type (%d)"));\r\nbreak;\r\ncase 7:\r\nproto_tree_add_item(v_tree, hf_rsip_parameter_method,\r\ntvb, off + 3, paramlen, ENC_BIG_ENDIAN);\r\nmethod = tvb_get_guint8(tvb, off + 3);\r\nproto_item_append_text(pti, ": %s",\r\nval_to_str(method, method_vals,\r\n"Unknown RSIP Method (%d)"));\r\nbreak;\r\ncase 8:\r\nproto_tree_add_item(v_tree, hf_rsip_parameter_error,\r\ntvb, off + 3, paramlen, ENC_BIG_ENDIAN);\r\nerror = tvb_get_ntohs(tvb, off + 3);\r\nproto_item_append_text(pti, ": %s",\r\nval_to_str(error, error_number_vals, "Undefined Error (%d)"));\r\nbreak;\r\ncase 9:\r\nproto_tree_add_item(v_tree,\r\nhf_rsip_parameter_flow_policy_local, tvb, off + 3, 1, ENC_BIG_ENDIAN);\r\nflowpolicy = tvb_get_guint8(tvb, off + 3);\r\nproto_item_append_text(pti, ": %s",\r\nval_to_str(flowpolicy, lcl_flow_policy_vals,\r\n"Undefined Local Flow Policy (%d)"));\r\nproto_tree_add_item(v_tree,\r\nhf_rsip_parameter_flow_policy_remote, tvb, off + 4, 1,\r\nENC_BIG_ENDIAN);\r\nflowpolicy = tvb_get_guint8(tvb, off + 4);\r\nproto_item_append_text(pti, "/%s",\r\nval_to_str(flowpolicy, rmt_flow_policy_vals,\r\n"Undefined Remote Flow Policy (%d)"));\r\nbreak;\r\ncase 10:\r\nproto_tree_add_item(v_tree, hf_rsip_parameter_indicator, tvb,\r\noff + 3, 2, ENC_BIG_ENDIAN);\r\nind = tvb_get_ntohs(tvb, off + 3);\r\nproto_item_append_text(pti, ": %d", ind);\r\nbreak;\r\ncase 11:\r\nproto_tree_add_item(v_tree, hf_rsip_parameter_message_counter,\r\ntvb, off + 3, 4, ENC_BIG_ENDIAN);\r\nmsgc = tvb_get_ntohl(tvb, off + 3);\r\nproto_item_append_text(pti, ": %d", msgc);\r\nbreak;\r\ncase 12:\r\nproto_tree_add_item(v_tree,\r\nhf_rsip_parameter_vendor_specific_vendor_id, tvb, off + 3,\r\n2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(v_tree,\r\nhf_rsip_parameter_vendor_specific_subtype, tvb, off + 5,\r\n2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(v_tree,\r\nhf_rsip_parameter_vendor_specific_value, tvb, off + 9,\r\nparamlen - 4, ENC_NA);\r\nbreak;\r\ncase 22:\r\nproto_tree_add_item(v_tree, hf_rsip_parameter_spi_number, tvb,\r\noff + 3, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(v_tree, hf_rsip_parameter_spi, tvb,\r\noff + 5, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nconsumed += paramlen;\r\nreturn consumed;\r\n}\r\nstatic int\r\nrsip_message_error_response(tvbuff_t *tvb, proto_tree *rsip_tree,\r\nint offset, int eoffset)\r\n{\r\nint consumed, offset_delta;\r\nconsumed = 0;\r\ndo {\r\noffset_delta =\r\nrsip_parameter(tvb, rsip_tree, offset, eoffset);\r\noffset += offset_delta;\r\nconsumed += offset_delta;\r\n} while ((offset_delta > 0) && (offset < eoffset));\r\nreturn consumed;\r\n}\r\nstatic int\r\nrsip_message_register_request(tvbuff_t *tvb, proto_tree *rsip_tree,\r\nint offset, int eoffset)\r\n{\r\nint consumed, offset_delta;\r\nconsumed = 0;\r\ndo {\r\noffset_delta =\r\nrsip_parameter(tvb, rsip_tree, offset, eoffset);\r\noffset += offset_delta;\r\nconsumed += offset_delta;\r\n} while ((offset_delta > 0) && (offset < eoffset));\r\nreturn consumed;\r\n}\r\nstatic int\r\nrsip_message_register_response(tvbuff_t *tvb, proto_tree *rsip_tree,\r\nint offset, int eoffset)\r\n{\r\nint consumed, offset_delta;\r\nconsumed = 0;\r\ndo {\r\noffset_delta =\r\nrsip_parameter(tvb, rsip_tree, offset, eoffset);\r\noffset += offset_delta;\r\nconsumed += offset_delta;\r\n} while ((offset_delta > 0) && (offset < eoffset));\r\nreturn consumed;\r\n}\r\nstatic int\r\nrsip_message_deregister_request(tvbuff_t *tvb, proto_tree *rsip_tree,\r\nint offset, int eoffset)\r\n{\r\nint consumed, offset_delta;\r\nconsumed = 0;\r\ndo {\r\noffset_delta =\r\nrsip_parameter(tvb, rsip_tree, offset, eoffset);\r\noffset += offset_delta;\r\nconsumed += offset_delta;\r\n} while ((offset_delta > 0) && (offset < eoffset));\r\nreturn consumed;\r\n}\r\nstatic int\r\nrsip_message_deregister_response(tvbuff_t *tvb, proto_tree *rsip_tree,\r\nint offset, int eoffset)\r\n{\r\nreturn rsip_message_deregister_request(tvb, rsip_tree, offset, eoffset);\r\n}\r\nstatic int\r\nrsip_message_assign_request_rsaip(tvbuff_t *tvb, proto_tree *rsip_tree,\r\nint offset, int eoffset)\r\n{\r\nint consumed, offset_delta;\r\nconsumed = 0;\r\ndo {\r\noffset_delta =\r\nrsip_parameter(tvb, rsip_tree, offset, eoffset);\r\noffset += offset_delta;\r\nconsumed += offset_delta;\r\n} while ((offset_delta > 0) && (offset < eoffset));\r\nreturn consumed;\r\n}\r\nstatic int\r\nrsip_message_assign_response_rsaip(tvbuff_t *tvb, proto_tree *rsip_tree,\r\nint offset, int eoffset)\r\n{\r\nint consumed, offset_delta;\r\nconsumed = 0;\r\ndo {\r\noffset_delta =\r\nrsip_parameter(tvb, rsip_tree, offset, eoffset);\r\noffset += offset_delta;\r\nconsumed += offset_delta;\r\n} while ((offset_delta > 0) && (offset < eoffset));\r\nreturn consumed;\r\n}\r\nstatic int\r\nrsip_message_assign_request_rsapip(tvbuff_t *tvb, proto_tree *rsip_tree,\r\nint offset, int eoffset)\r\n{\r\nint consumed, offset_delta;\r\nconsumed = 0;\r\ndo {\r\noffset_delta =\r\nrsip_parameter(tvb, rsip_tree, offset, eoffset);\r\noffset += offset_delta;\r\nconsumed += offset_delta;\r\n} while ((offset_delta > 0) && (offset < eoffset));\r\nreturn consumed;\r\n}\r\nstatic int\r\nrsip_message_assign_response_rsapip(tvbuff_t *tvb, proto_tree *rsip_tree,\r\nint offset, int eoffset)\r\n{\r\nint consumed, offset_delta;\r\nconsumed = 0;\r\ndo {\r\noffset_delta =\r\nrsip_parameter(tvb, rsip_tree, offset, eoffset);\r\noffset += offset_delta;\r\nconsumed += offset_delta;\r\n} while ((offset_delta > 0) && (offset < eoffset));\r\nreturn consumed;\r\n}\r\nstatic int\r\nrsip_message_extend_request(tvbuff_t *tvb, proto_tree *rsip_tree,\r\nint offset, int eoffset)\r\n{\r\nint consumed, offset_delta;\r\nconsumed = 0;\r\ndo {\r\noffset_delta =\r\nrsip_parameter(tvb, rsip_tree, offset, eoffset);\r\noffset += offset_delta;\r\nconsumed += offset_delta;\r\n} while ((offset_delta > 0) && (offset < eoffset));\r\nreturn consumed;\r\n}\r\nstatic int\r\nrsip_message_extend_response(tvbuff_t *tvb, proto_tree *rsip_tree,\r\nint offset, int eoffset)\r\n{\r\nint consumed, offset_delta;\r\nconsumed = 0;\r\ndo {\r\noffset_delta =\r\nrsip_parameter(tvb, rsip_tree, offset, eoffset);\r\noffset += offset_delta;\r\nconsumed += offset_delta;\r\n} while ((offset_delta > 0) && (offset < eoffset));\r\nreturn consumed;\r\n}\r\nstatic int\r\nrsip_message_free_request(tvbuff_t *tvb, proto_tree *rsip_tree,\r\nint offset, int eoffset)\r\n{\r\nint consumed, offset_delta;\r\nconsumed = 0;\r\ndo {\r\noffset_delta =\r\nrsip_parameter(tvb, rsip_tree, offset, eoffset);\r\noffset += offset_delta;\r\nconsumed += offset_delta;\r\n} while ((offset_delta > 0) && (offset < eoffset));\r\nreturn consumed;\r\n}\r\nstatic int\r\nrsip_message_free_response(tvbuff_t *tvb, proto_tree *rsip_tree,\r\nint offset, int eoffset)\r\n{\r\nint consumed, offset_delta;\r\nconsumed = 0;\r\ndo {\r\noffset_delta =\r\nrsip_parameter(tvb, rsip_tree, offset, eoffset);\r\noffset += offset_delta;\r\nconsumed += offset_delta;\r\n} while ((offset_delta > 0) && (offset < eoffset));\r\nreturn consumed;\r\n}\r\nstatic int\r\nrsip_message_query_request(tvbuff_t *tvb, proto_tree *rsip_tree,\r\nint offset, int eoffset)\r\n{\r\nint consumed, offset_delta;\r\nconsumed = 0;\r\ndo {\r\noffset_delta =\r\nrsip_parameter(tvb, rsip_tree, offset, eoffset);\r\noffset += offset_delta;\r\nconsumed += offset_delta;\r\n} while ((offset_delta > 0) && (offset < eoffset));\r\nreturn consumed;\r\n}\r\nstatic int\r\nrsip_message_query_response(tvbuff_t *tvb, proto_tree *rsip_tree,\r\nint offset, int eoffset)\r\n{\r\nint consumed, offset_delta;\r\nconsumed = 0;\r\ndo {\r\noffset_delta =\r\nrsip_parameter(tvb, rsip_tree, offset, eoffset);\r\noffset += offset_delta;\r\nconsumed += offset_delta;\r\n} while ((offset_delta > 0) && (offset < eoffset));\r\nreturn consumed;\r\n}\r\nstatic int\r\nrsip_message_listen_request(tvbuff_t *tvb, proto_tree *rsip_tree,\r\nint offset, int eoffset)\r\n{\r\nint consumed, offset_delta;\r\nconsumed = 0;\r\ndo {\r\noffset_delta =\r\nrsip_parameter(tvb, rsip_tree, offset, eoffset);\r\noffset += offset_delta;\r\nconsumed += offset_delta;\r\n} while ((offset_delta > 0) && (offset < eoffset));\r\nreturn consumed;\r\n}\r\nstatic int\r\nrsip_message_listen_response(tvbuff_t *tvb, proto_tree *rsip_tree,\r\nint offset, int eoffset)\r\n{\r\nint consumed, offset_delta;\r\nconsumed = 0;\r\ndo {\r\noffset_delta =\r\nrsip_parameter(tvb, rsip_tree, offset, eoffset);\r\noffset += offset_delta;\r\nconsumed += offset_delta;\r\n} while ((offset_delta > 0) && (offset < eoffset));\r\nreturn consumed;\r\n}\r\nstatic int\r\nrsip_message_assign_request_rsipsec(tvbuff_t *tvb, proto_tree *rsip_tree,\r\nint offset, int eoffset)\r\n{\r\nint consumed, offset_delta;\r\nconsumed = 0;\r\ndo {\r\noffset_delta =\r\nrsip_parameter(tvb, rsip_tree, offset, eoffset);\r\noffset += offset_delta;\r\nconsumed += offset_delta;\r\n} while ((offset_delta > 0) && (offset < eoffset));\r\nreturn consumed;\r\n}\r\nstatic int\r\nrsip_message_assign_response_rsipsec(tvbuff_t *tvb, proto_tree *rsip_tree,\r\nint offset, int eoffset)\r\n{\r\nint consumed, offset_delta;\r\nconsumed = 0;\r\ndo {\r\noffset_delta =\r\nrsip_parameter(tvb, rsip_tree, offset, eoffset);\r\noffset += offset_delta;\r\nconsumed += offset_delta;\r\n} while ((offset_delta > 0) && (offset < eoffset));\r\nreturn consumed;\r\n}\r\nstatic int\r\ndissect_rsip(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nproto_item *ti;\r\nproto_tree *rsip_tree;\r\nguint8 msgtype;\r\nint eoff;\r\nmsgtype = tvb_get_guint8(tvb, 1);\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "RSIP");\r\ncol_add_str(pinfo->cinfo, COL_INFO,\r\nval_to_str(msgtype, msg_type_vals,\r\n"Unknown Message Type (0x%0x)"));\r\nif (tree) {\r\nti = proto_tree_add_item(tree, proto_rsip, tvb, 0, -1, ENC_NA);\r\nrsip_tree = proto_item_add_subtree(ti, ett_rsip);\r\nproto_tree_add_item(rsip_tree,\r\nhf_rsip_version, tvb, 0, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(rsip_tree,\r\nhf_rsip_message_type, tvb, 1, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(rsip_tree,\r\nhf_rsip_message_length, tvb, 2, 2, ENC_BIG_ENDIAN);\r\neoff = tvb_reported_length(tvb);\r\nswitch (msgtype) {\r\ncase 1:\r\nrsip_message_error_response(tvb, rsip_tree, 4, eoff);\r\nbreak;\r\ncase 2:\r\nrsip_message_register_request(tvb, rsip_tree, 4, eoff);\r\nbreak;\r\ncase 3:\r\nrsip_message_register_response(tvb, rsip_tree, 4, eoff);\r\nbreak;\r\ncase 4:\r\nrsip_message_deregister_request(tvb, rsip_tree, 4, eoff);\r\nbreak;\r\ncase 5:\r\nrsip_message_deregister_response(tvb, rsip_tree, 4, eoff);\r\nbreak;\r\ncase 6:\r\nrsip_message_assign_request_rsaip(tvb, rsip_tree, 4, eoff);\r\nbreak;\r\ncase 7:\r\nrsip_message_assign_response_rsaip(tvb, rsip_tree, 4, eoff);\r\nbreak;\r\ncase 8:\r\nrsip_message_assign_request_rsapip(tvb, rsip_tree, 4, eoff);\r\nbreak;\r\ncase 9:\r\nrsip_message_assign_response_rsapip(tvb, rsip_tree, 4, eoff);\r\nbreak;\r\ncase 10:\r\nrsip_message_extend_request(tvb, rsip_tree, 4, eoff);\r\nbreak;\r\ncase 11:\r\nrsip_message_extend_response(tvb, rsip_tree, 4, eoff);\r\nbreak;\r\ncase 12:\r\nrsip_message_free_request(tvb, rsip_tree, 4, eoff);\r\nbreak;\r\ncase 13:\r\nrsip_message_free_response(tvb, rsip_tree, 4, eoff);\r\nbreak;\r\ncase 14:\r\nrsip_message_query_request(tvb, rsip_tree, 4, eoff);\r\nbreak;\r\ncase 15:\r\nrsip_message_query_response(tvb, rsip_tree, 4, eoff);\r\nbreak;\r\ncase 16:\r\nrsip_message_listen_request(tvb, rsip_tree, 4, eoff);\r\nbreak;\r\ncase 17:\r\nrsip_message_listen_response(tvb, rsip_tree, 4, eoff);\r\nbreak;\r\ncase 22:\r\nrsip_message_assign_request_rsipsec(tvb, rsip_tree, 4, eoff);\r\nbreak;\r\ncase 23:\r\nrsip_message_assign_response_rsipsec(tvb, rsip_tree, 4, eoff);\r\nbreak;\r\n}\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_rsip(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_rsip_version,\r\n{ "Protocol version", "rsip.version",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsip_message_type,\r\n{ "Message type", "rsip.message_type",\r\nFT_UINT8, BASE_DEC, VALS(msg_type_appendix_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsip_message_length,\r\n{ "Message length", "rsip.message_length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsip_parameter_type,\r\n{ "Type", "rsip.parameter.type",\r\nFT_UINT8, BASE_DEC, VALS(param_type_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsip_parameter_length,\r\n{ "Length", "rsip.parameter.length",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsip_parameter_value,\r\n{ "Value", "rsip.parameter.value",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_rsip_parameter_address_type,\r\n{ "Address type", "rsip.parameter.address_type",\r\nFT_UINT8, BASE_DEC, VALS(addr_type_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsip_parameter_address_ipv4,\r\n{ "IPv4 Address", "rsip.parameter.address",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsip_parameter_address_ipv4_netmask,\r\n{ "IPv4 Netmask", "rsip.parameter.netmask",\r\nFT_IPv4, BASE_NETMASK, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsip_parameter_address_ipv6,\r\n{ "IPv6 Address", "rsip.parameter.address.ipv6",\r\nFT_IPv6, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsip_parameter_address_fqdn,\r\n{ "Fully Qualified Domain Name", "rsip.parameter.fqdn",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsip_parameter_ports_number,\r\n{ "Number", "rsip.parameter.ports.number",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsip_parameter_ports_port_number,\r\n{ "Port", "rsip.parameter.ports.port_number",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsip_parameter_lease_time,\r\n{ "Lease time", "rsip.parameter.lease_time",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsip_parameter_client_id,\r\n{ "Client ID", "rsip.parameter.client_id",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsip_parameter_bind_id,\r\n{ "Bind ID", "rsip.parameter.bind_id",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsip_parameter_tunnel_type,\r\n{ "Tunnel type", "rsip.parameter.tunnel_type",\r\nFT_UINT8, BASE_DEC, VALS(tunnel_type_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsip_parameter_method,\r\n{ "Method", "rsip.method_param.method",\r\nFT_UINT8, BASE_DEC, VALS(method_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsip_parameter_error,\r\n{ "Error", "rsip.parameter.error",\r\nFT_UINT16, BASE_DEC, VALS(error_number_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsip_parameter_flow_policy_local,\r\n{ "Local Flow Policy", "rsip.parameter.local_flow_policy",\r\nFT_UINT8, BASE_DEC, VALS(lcl_flow_policy_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsip_parameter_flow_policy_remote,\r\n{ "Remote Flow Policy", "rsip.parameter.remote_flow_policy",\r\nFT_UINT8, BASE_DEC, VALS(rmt_flow_policy_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsip_parameter_indicator,\r\n{ "Value", "rsip.parameter.indicator",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsip_parameter_message_counter,\r\n{ "Counter", "rsip.parameter.message_counter",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsip_parameter_vendor_specific_vendor_id,\r\n{ "Vendor ID", "rsip.parameter.vendor_specific.vendor_id",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsip_parameter_vendor_specific_subtype,\r\n{ "Subtype", "rsip.parameter.vendor_specific.subtype",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsip_parameter_vendor_specific_value,\r\n{ "Value", "rsip.parameter.vendor_specific.value",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsip_parameter_spi_number,\r\n{ "Number", "rsip.parameter.spi_number",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsip_parameter_spi,\r\n{ "SPI", "rsip.parameter.spi",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n}\r\n};\r\nstatic gint *ett[] = {\r\n&ett_rsip,\r\n&ett_rsip_param,\r\n&ett_rsip_param_val\r\n};\r\nproto_rsip = proto_register_protocol("Realm Specific IP Protocol",\r\n"RSIP", "rsip");\r\nproto_register_field_array(proto_rsip, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid\r\nproto_reg_handoff_rsip(void)\r\n{\r\nstatic gboolean initialized = FALSE;\r\ndissector_handle_t rsip_handle;\r\nif (!initialized) {\r\nrsip_handle = create_dissector_handle(dissect_rsip,\r\nproto_rsip);\r\ndissector_add_uint("udp.port", UDP_PORT_RSIP, rsip_handle);\r\ndissector_add_uint("tcp.port", TCP_PORT_RSIP, rsip_handle);\r\ninitialized = TRUE;\r\n}\r\n}
