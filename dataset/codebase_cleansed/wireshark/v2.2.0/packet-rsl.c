static int\r\ndissect_rsl_ie_ch_no(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_CH_NO)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 2, ett_ie_ch_no, NULL, "Channel number IE ");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_ch_no_Cbits, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_tree, hf_rsl_ch_no_TN, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_link_id(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 octet;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_LINK_ID)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 2, ett_ie_link_id, NULL, "Link Identifier IE ");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\noctet = tvb_get_guint8(tvb, offset);\r\nif ((octet & 0x20) == 0x20) {\r\nproto_tree_add_item(ie_tree, hf_rsl_na, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset;\r\n}\r\nproto_tree_add_item(ie_tree, hf_rsl_ch_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_tree, hf_rsl_na, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_tree, hf_rsl_prio, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_tree, hf_rsl_sapi, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_act_type(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nguint octet;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_ACT_TYPE)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 2, ett_ie_act_type, NULL, "Activation Type IE ");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_rbit, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noctet = (tvb_get_guint8(tvb, offset) & 0x06) >> 1;\r\nproto_tree_add_item(ie_tree, hf_rsl_a3a2, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nswitch (octet) {\r\ncase 0:\r\nproto_tree_add_item(ie_tree, hf_rsl_a1_0, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 1:\r\nproto_tree_add_item(ie_tree, hf_rsl_a1_1, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 2:\r\nproto_tree_add_item(ie_tree, hf_rsl_a1_2, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_bs_power(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_BS_POW)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 2, ett_ie_bs_power, NULL, "BS Power IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_epc_mode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_tree, hf_rsl_bs_fpc_epc_mode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_tree, hf_rsl_bs_power, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_ch_id(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_item *ti;\r\nproto_tree *ie_tree;\r\nguint8 length;\r\nint ie_offset;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_CH_ID)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_ch_id, &ti, "Channel Identification IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nlength = tvb_get_guint8(tvb, offset);\r\nproto_item_set_len(ti, length+2);\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nie_offset = offset;\r\nproto_tree_add_item(ie_tree, hf_rsl_channel_description_tag, tvb, offset, 1, ENC_NA);\r\nde_rr_ch_dsc(tvb, ie_tree, pinfo, offset+1, length, NULL, 0);\r\noffset += 4;\r\nproto_tree_add_item(ie_tree, hf_rsl_mobile_allocation_tag, tvb, offset, 2, ENC_NA);\r\nreturn ie_offset + length;\r\n}\r\nstatic int\r\ndissect_rsl_ie_ch_mode(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_item *ti;\r\nproto_tree *ie_tree;\r\nguint8 length;\r\nint ie_offset;\r\nguint8 ie_id;\r\nguint8 octet;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_CH_MODE)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_ch_mode, &ti, "Channel Mode IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nlength = tvb_get_guint8(tvb, offset);\r\nproto_item_set_len(ti, length+2);\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nie_offset = offset;\r\nproto_tree_add_item(ie_tree, hf_rsl_cm_dtxd, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_tree, hf_rsl_cm_dtxu, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_speech_or_data, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noctet = tvb_get_guint8(tvb, offset);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_ch_rate_and_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nswitch (octet) {\r\ncase 1:\r\nproto_tree_add_item(ie_tree, hf_rsl_speech_coding_alg, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 2:\r\nproto_tree_add_item(ie_tree, hf_rsl_extension_bit, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_tree, hf_rsl_t_nt_bit, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noctet = tvb_get_guint8(tvb, offset);\r\nif ((octet & 0x40) == 0x40) {\r\nproto_tree_add_item(ie_tree, hf_rsl_ra_if_data_rte, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}else{\r\nproto_tree_add_item(ie_tree, hf_rsl_data_rte, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase 3:\r\nproto_tree_add_item(ie_tree, hf_rsl_no_resources_required, tvb, offset, 1, ENC_NA);\r\nbreak;\r\ndefault:\r\nproto_tree_add_expert(ie_tree, pinfo, &ei_rsl_speech_or_data_indicator, tvb, offset, 1);\r\nbreak;\r\n}\r\noffset++;\r\nreturn ie_offset + length;\r\n}\r\nstatic int\r\ndissect_rsl_ie_enc_inf(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_item *ti;\r\nproto_tree *ie_tree;\r\nguint8 length;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_ENC_INF)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_enc_inf, &ti, "Encryption information IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nlength = tvb_get_guint8(tvb, offset);\r\nproto_item_set_len(ti, length+2);\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_alg_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_tree, hf_rsl_key, tvb, offset+1, length -1, ENC_NA);\r\nreturn offset + length;\r\n}\r\nstatic int\r\ndissect_rsl_ie_frame_no(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_FRAME_NO)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 3, ett_ie_frame_no, NULL, "Frame Number IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_req_ref_T1prim, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_tree, hf_rsl_req_ref_T3, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_req_ref_T2, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_ho_ref(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_HO_REF)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 2, ett_ie_ho_ref, NULL, "Handover reference IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_ho_ref, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_l1_inf(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_L1_INF)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 3, ett_ie_l1_inf, NULL, "L1 Information IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_l1inf_power_lev, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_tree, hf_rsl_l1inf_fpc, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_act_timing_adv, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_L3_inf(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, int offset, gboolean is_mandatory, l3_inf_t type)\r\n{\r\nproto_item *ti;\r\nproto_tree *ie_tree;\r\ntvbuff_t *next_tvb;\r\nguint16 length;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_L3_INF)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_L3_inf, &ti, "L3 Information IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nlength = tvb_get_ntohs(tvb, offset);\r\nproto_item_set_len(ti, length+3);\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_length, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset= offset+2;\r\nif (type == L3_INF_CCCH)\r\n{\r\nproto_tree_add_item(ie_tree, hf_rsl_llsdu_ccch, tvb, offset, length, ENC_NA);\r\nnext_tvb = tvb_new_subset_length(tvb, offset, length);\r\ncall_dissector(gsm_a_ccch_handle, next_tvb, pinfo, top_tree);\r\n}\r\nelse if (type == L3_INF_SACCH)\r\n{\r\nproto_tree_add_item(ie_tree, hf_rsl_llsdu_sacch, tvb, offset, length, ENC_NA);\r\nnext_tvb = tvb_new_subset_length(tvb, offset, length);\r\ncall_dissector(gsm_a_sacch_handle, next_tvb, pinfo, top_tree);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(ie_tree, hf_rsl_llsdu, tvb, offset, length, ENC_NA);\r\nnext_tvb = tvb_new_subset_length(tvb, offset, length);\r\ncall_dissector(gsm_a_dtap_handle, next_tvb, pinfo, top_tree);\r\n}\r\noffset = offset + length;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_ms_id(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_item *ti;\r\nproto_tree *ie_tree;\r\nguint length;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_MS_ID)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_ms_id, &ti, "MS Identity IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nlength = tvb_get_guint8(tvb, offset);\r\nproto_item_set_len(ti, length+2);\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nde_mid(tvb, ie_tree, pinfo, offset, length, NULL, 0);\r\noffset = offset + length;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_ms_pow(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_MS_POW)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 2, ett_ie_ms_pow, NULL, "MS Power IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_ms_power_lev, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_tree, hf_rsl_ms_fpc, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_paging_grp(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_PAGING_GRP)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 2, ett_ie_paging_grp, NULL, "Paging Group IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_paging_grp, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_paging_load(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_PAGING_LOAD)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 3, ett_ie_paging_load, NULL, "Paging Load IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_paging_load, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_phy_ctx(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_item *ti;\r\nproto_tree *ie_tree;\r\nguint length;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_PHY_CTX)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_phy_ctx, &ti, "Physical Context IE ");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nlength = tvb_get_guint8(tvb, offset);\r\nproto_item_set_len(ti, length+2);\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_phy_ctx, tvb, offset, length, ENC_NA);\r\noffset = offset + length;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_access_delay(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_ACCESS_DELAY)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 2, ett_ie_access_delay, NULL, "Access Delay IE ");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_acc_delay, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_rach_load(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_item *ti;\r\nproto_tree *ie_tree;\r\nguint length;\r\nguint8 ie_id;\r\nint ie_offset;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_RACH_LOAD)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_rach_load, &ti, "RACH Load IE ");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nlength = tvb_get_guint8(tvb, offset);\r\nproto_item_set_len(ti, length+2);\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nie_offset = offset;\r\nproto_tree_add_item(ie_tree, hf_rsl_rach_slot_cnt, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset +2;\r\nlength = length -2;\r\nproto_tree_add_item(ie_tree, hf_rsl_rach_busy_cnt, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset +2;\r\nlength = length -2;\r\nproto_tree_add_item(ie_tree, hf_rsl_rach_acc_cnt, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset +2;\r\nlength = length -2;\r\nif ( length > 0) {\r\nproto_tree_add_item(ie_tree, hf_rsl_rach_supplementary_information, tvb, offset, length, ENC_NA);\r\n}\r\noffset = ie_offset + length;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_req_ref(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_REQ_REF)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 4, ett_ie_req_ref, NULL, "Request Reference IE ");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_req_ref_ra, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_req_ref_T1prim, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_tree, hf_rsl_req_ref_T3, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_req_ref_T2, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_rel_mode(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_REL_MODE)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 4, ett_ie_rel_mode, NULL, "Release Mode IE ");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_rel_mode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_resource_inf(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_item *ti;\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nguint length;\r\nint ie_offset;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_RESOURCE_INF)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_resource_inf, &ti, "Resource Information IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nlength = tvb_get_guint8(tvb, offset);\r\nproto_item_set_len(ti, length+2);\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nie_offset = offset;\r\nwhile (length > 0) {\r\nproto_tree_add_item(ie_tree, hf_rsl_ch_no_Cbits, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_tree, hf_rsl_ch_no_TN, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_interf_band, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_tree, hf_rsl_interf_band_reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nlength = length - 2;\r\n}\r\nreturn ie_offset + length;\r\n}\r\nstatic int\r\ndissect_rsl_ie_rlm_cause(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_item *ti;\r\nproto_tree *ie_tree;\r\nguint length;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_RLM_CAUSE)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_rlm_cause, &ti, "RLM Cause IE ");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nlength = tvb_get_guint8(tvb, offset);\r\nproto_item_set_len(ti, length+2);\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(tree, hf_rsl_extension_bit, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_tree, hf_rsl_cause, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_starting_time(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_STARTING_TIME)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 3, ett_ie_staring_time, NULL, "Starting Time IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_req_ref_T1prim, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_tree, hf_rsl_req_ref_T3, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_req_ref_T2, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_timing_adv(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_TIMING_ADV)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 2, ett_ie_timing_adv, NULL, "Timing Advance IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_timing_adv, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_uplik_meas(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_item *ti;\r\nproto_tree *ie_tree;\r\nguint length;\r\nint ie_offset;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_UPLINK_MEAS)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_uplink_meas, &ti, "Uplink Measurements IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nlength = tvb_get_guint8(tvb, offset);\r\nproto_item_set_len(ti, length+2);\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nie_offset = offset;\r\nproto_tree_add_item(ie_tree, hf_rsl_dtxd, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_tree, hf_rsl_rxlev_full_up, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_rxlev_sub_up, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_rxqual_full_up, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_tree, hf_rsl_rxqual_sub_up, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn ie_offset+length;\r\n}\r\nstatic int\r\ndissect_rsl_ie_cause(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_item *ti;\r\nproto_tree *ie_tree;\r\nguint length;\r\nguint8 octet;\r\nint ie_offset;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_CAUSE)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_cause, &ti, "Cause IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nlength = tvb_get_guint8(tvb, offset);\r\nproto_item_set_len(ti, length+2);\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nie_offset = offset;\r\noctet = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_rsl_extension_bit, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_rsl_class, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nif ((octet & 0x80) == 0x80)\r\noffset++;\r\nreturn ie_offset+length;\r\n}\r\nstatic int\r\ndissect_rsl_ie_meas_res_no(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_MEAS_RES_NO)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 2, ett_ie_meas_res_no, NULL, "Measurement result number IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_meas_res_no, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_message_id(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_MESSAGE_ID)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_message_id, NULL, "Message Identifier IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(tree, hf_rsl_msg_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_sys_info_type(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset,\r\ngboolean is_mandatory, guint8 *sys_info_type)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_SYS_INFO_TYPE) {\r\n*sys_info_type = 0xff;\r\nreturn offset;\r\n}\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 2, ett_ie_sys_info_type, NULL, "System Info Type IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\n*sys_info_type = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_rsl_sys_info_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_full_imm_ass_inf(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_item *ti;\r\nproto_tree *ie_tree;\r\nguint length;\r\ntvbuff_t *next_tvb;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_FULL_IMM_ASS_INF)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_full_imm_ass_inf, &ti, "Full Immediate Assign Info IE ");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nlength = tvb_get_guint8(tvb, offset);\r\nproto_item_set_len(ti, length+2);\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_full_immediate_assign_info_field, tvb, offset, length, ENC_NA);\r\nnext_tvb = tvb_new_subset_length(tvb, offset, length);\r\ncall_dissector(gsm_a_ccch_handle, next_tvb, pinfo, top_tree);\r\noffset = offset + length;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_smscb_inf(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_item *ti;\r\nproto_tree *ie_tree;\r\ntvbuff_t *next_tvb;\r\nguint length;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_SMSCB_INF)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_smscb_inf, &ti, "SMSCB Information IE ");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nlength = tvb_get_guint8(tvb, offset);\r\nproto_item_set_len(ti, length+2);\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nnext_tvb = tvb_new_subset_length(tvb, offset, length);\r\ncall_dissector(gsm_cbch_handle, next_tvb, pinfo, top_tree);\r\noffset = offset + length;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_ms_timing_offset(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_FULL_MS_TIMING_OFFSET)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_ms_timing_offset, NULL, "MS Timing Offset IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_timing_offset, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_err_msg(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_item *ti;\r\nproto_tree *ie_tree;\r\nguint length;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_ERR_MSG)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_err_msg, &ti, "Erroneous Message IE ");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nlength = tvb_get_guint8(tvb, offset);\r\nproto_item_set_len(ti, length+2);\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\noffset = dissct_rsl_msg(tvb, pinfo, ie_tree, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_full_bcch_inf(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_item *ti;\r\nproto_tree *ie_tree;\r\ntvbuff_t *next_tvb;\r\nguint16 length;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_FULL_BCCH_INF)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_full_bcch_inf, &ti, "Full BCCH Information IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nlength = tvb_get_guint8(tvb, offset);\r\nproto_item_set_len(ti, length+2);\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_layer_3_message, tvb, offset, length, ENC_NA);\r\nnext_tvb = tvb_new_subset_length(tvb, offset, length);\r\ncall_dissector(gsm_a_ccch_handle, next_tvb, pinfo, top_tree);\r\noffset = offset + length;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_ch_needed(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_CH_NEEDED)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_ch_needed, NULL, "Channel Needed IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_ch_needed, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_cb_cmd_type(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_CB_CMD_TYPE)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_cb_cmd_type, NULL, "CB Command type IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_ch_needed, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_smscb_mess(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_item *ti;\r\nproto_tree *ie_tree;\r\ntvbuff_t *next_tvb;\r\nguint length;\r\nguint8 ie_id;\r\nint ie_offset;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_SMSCB_MESS)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_smscb_mess, &ti, "SMSCB Message IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nlength = tvb_get_guint8(tvb, offset);\r\nproto_item_set_len(ti, length+2);\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nie_offset = offset;\r\nnext_tvb = tvb_new_subset_length(tvb, offset, length);\r\ncall_dissector(gsm_cbs_handle, next_tvb, pinfo, top_tree);\r\noffset = ie_offset + length;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_cbch_load_inf(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_item *item;\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nguint8 octet;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_CBCH_LOAD_INF)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_cbch_load_inf, NULL, "CBCH Load Information IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\noctet = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(ie_tree, hf_rsl_cbch_load_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nitem = proto_tree_add_item(ie_tree, hf_rsl_msg_slt_cnt, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nif ((octet & 0x80) == 0x80) {\r\nproto_item_append_text(item, "The amount of SMSCB messages (1 to 15) that are needed immediately by BTS");\r\n}else{\r\nproto_item_append_text(item, "The amount of delay in message slots (1 to 15) that is needed immediately by BTS");\r\n}\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_smscb_ch_ind(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_SMSCB_CH_IND)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_smscb_ch_ind, NULL, "SMSCB Channel Indicator IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_ch_ind, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_grp_call_ref(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_item *ti;\r\nproto_tree *ie_tree;\r\nguint length;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_GRP_CALL_REF)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_grp_call_ref, &ti, "Group call reference IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nlength = tvb_get_guint8(tvb, offset);\r\nproto_item_set_len(ti, length+2);\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_descriptive_group_or_broadcast_call_reference, tvb, offset, length, ENC_NA);\r\nde_d_gb_call_ref(tvb, ie_tree, pinfo, offset, length, NULL, 0);\r\noffset = offset + length;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_ch_desc(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_item *ti;\r\nproto_tree *ie_tree;\r\nguint length;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_CH_DESC)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_ch_desc, &ti, "Channel description IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nlength = tvb_get_guint8(tvb, offset);\r\nproto_item_set_len(ti, length+2);\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_group_channel_description, tvb, offset, length, ENC_NA);\r\noffset = offset + length;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_nch_drx(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_NCH_DRX_INF)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 2, ett_ie_nch_drx, NULL, "NCH DRX information IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_cmd_ind(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nguint8 octet;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_CMD_IND)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 2, ett_ie_cmd_ind, NULL, "Command indicator IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_extension_bit, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noctet = tvb_get_guint8(tvb, offset);\r\nif ((octet & 0x80) == 0x80) {\r\nproto_tree_add_item(ie_tree, hf_rsl_command, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset+2;\r\n}else{\r\nproto_tree_add_item(ie_tree, hf_rsl_command, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_emlpp_prio(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_EMLPP_PRIO)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 2, ett_ie_emlpp_prio, NULL, "eMLPP Priority IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_emlpp_prio, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_uic(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_UIC)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_uic, NULL, "UIC IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_uic, tvb, offset, 1, ENC_NA);\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_main_ch_ref(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_MAIN_CH_REF)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_main_ch_ref, NULL, "Main channel reference IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_ch_no_TN, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_multirate_conf(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_item *ti;\r\nproto_tree *ie_tree;\r\nguint length;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_MULTIRATE_CONF)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_multirate_conf, &ti, "MultiRate configuration IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nlength = tvb_get_guint8(tvb, offset);\r\nproto_item_set_len(ti, length+2);\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nde_rr_multirate_conf(tvb, ie_tree, pinfo, offset, length, NULL, 0);\r\noffset = offset + length;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_multirate_cntrl(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_MULTIRATE_CNTRL)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 2, ett_ie_multirate_cntrl, NULL, "MultiRate Control IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_sup_codec_types(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_item *ti;\r\nproto_tree *ie_tree;\r\nguint length;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_SUP_CODEC_TYPES)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_sup_codec_types, &ti, "Supported Codec Types IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nlength = tvb_get_guint8(tvb, offset);\r\nproto_item_set_len(ti, length+2);\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(tree, hf_rsl_codec_list, tvb, offset, length, ENC_NA);\r\nreturn offset + length;\r\n}\r\nstatic int\r\ndissect_rsl_ie_codec_conf(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_item *ti;\r\nproto_tree *ie_tree;\r\nguint length;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_CODEC_CONF)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_codec_conf, &ti, "Codec Configuration IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nlength = tvb_get_guint8(tvb, offset);\r\nproto_item_set_len(ti, length+2);\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset + length;\r\n}\r\nstatic int\r\ndissect_rsl_ie_rtd(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_item *rtd_item;\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nguint8 rtd;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_RTD)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_rtd, NULL, "Round Trip Delay IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nrtd = (tvb_get_guint8(tvb, offset)>>1)*20;\r\nrtd_item = proto_tree_add_uint(tree, hf_rsl_rtd, tvb, offset, 1, rtd);\r\nproto_item_append_text(rtd_item, " ms");\r\nproto_tree_add_item(ie_tree, hf_rsl_delay_ind, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_tfo_status(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_tree *ie_tree;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_TFO_STATUS)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_tfo_status, NULL, "TFO Status IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_rsl_tfo, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl_ie_llp_apdu(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_item *ti;\r\nproto_tree *ie_tree;\r\nguint8 length;\r\nint ie_offset;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_LLP_APDU)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_llp_apdu, &ti, "LLP APDU IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nlength = tvb_get_guint8(tvb, offset);\r\nproto_item_set_len(ti, length+2);\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nie_offset = offset;\r\nproto_tree_add_expert(tree, pinfo, &ei_rsl_facility_information_element_3gpp_ts_44071, tvb, offset, length);\r\nreturn ie_offset + length;\r\n}\r\nstatic int\r\ndissect_rsl_ie_tfo_transp_cont(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset, gboolean is_mandatory)\r\n{\r\nproto_item *ti;\r\nproto_tree *ie_tree;\r\nguint8 length;\r\nint ie_offset;\r\nguint8 ie_id;\r\nif (is_mandatory == FALSE) {\r\nie_id = tvb_get_guint8(tvb, offset);\r\nif (ie_id != RSL_IE_TFO_TRANSP_CONT)\r\nreturn offset;\r\n}\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_ie_tfo_transp_cont, &ti, "TFO transparent container IE");\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nlength = tvb_get_guint8(tvb, offset);\r\nproto_item_set_len(ti, length+2);\r\nproto_tree_add_item(ie_tree, hf_rsl_ie_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nie_offset = offset;\r\nproto_tree_add_expert(tree, pinfo, &ei_rsl_embedded_message_tfo_configuration, tvb, offset, length);\r\nreturn ie_offset + length;\r\n}\r\nstatic int\r\ndissct_rsl_ipaccess_msg(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, int offset)\r\n{\r\nguint8 msg_type;\r\nguint32 local_addr = 0;\r\nguint16 local_port = 0;\r\naddress src_addr;\r\nmsg_type = tvb_get_guint8(tvb, offset) & 0x7f;\r\noffset++;\r\nwhile (tvb_reported_length_remaining(tvb, offset) > 0) {\r\nguint8 tag;\r\nunsigned int len, hlen;\r\nconst struct tlv_def *tdef;\r\nproto_item *ti;\r\nproto_tree *ie_tree;\r\ntag = tvb_get_guint8(tvb, offset);\r\ntdef = &rsl_att_tlvdef.def[tag];\r\nswitch (tdef->type) {\r\ncase TLV_TYPE_FIXED:\r\nhlen = 1;\r\nlen = tdef->fixed_len;\r\nbreak;\r\ncase TLV_TYPE_T:\r\nhlen = 1;\r\nlen = 0;\r\nbreak;\r\ncase TLV_TYPE_TV:\r\nhlen = 1;\r\nlen = 1;\r\nbreak;\r\ncase TLV_TYPE_TLV:\r\nhlen = 2;\r\nlen = tvb_get_guint8(tvb, offset+1);\r\nbreak;\r\ncase TLV_TYPE_TL16V:\r\nhlen = 3;\r\nlen = tvb_get_guint8(tvb, offset+1) << 8 |\r\ntvb_get_guint8(tvb, offset+2);\r\nbreak;\r\ncase TLV_TYPE_UNKNOWN:\r\ndefault:\r\nreturn tvb_reported_length(tvb);\r\n}\r\nti = proto_tree_add_item(tree, hf_rsl_ie_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nie_tree = proto_item_add_subtree(ti, ett_ie_local_port);\r\noffset += hlen;\r\nswitch (tag) {\r\ncase RSL_IE_CH_NO:\r\ndissect_rsl_ie_ch_no(tvb, pinfo, ie_tree, offset, FALSE);\r\nbreak;\r\ncase RSL_IE_FRAME_NO:\r\ndissect_rsl_ie_frame_no(tvb, pinfo, ie_tree, offset, FALSE);\r\nbreak;\r\ncase RSL_IE_MS_POW:\r\ndissect_rsl_ie_ms_pow(tvb, pinfo, ie_tree, offset, FALSE);\r\nbreak;\r\ncase RSL_IE_IPAC_REMOTE_IP:\r\nproto_tree_add_item(ie_tree, hf_rsl_remote_ip, tvb,\r\noffset, len, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase RSL_IE_IPAC_REMOTE_PORT:\r\nproto_tree_add_item(ie_tree, hf_rsl_remote_port, tvb,\r\noffset, len, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase RSL_IE_IPAC_LOCAL_IP:\r\nproto_tree_add_item(ie_tree, hf_rsl_local_ip, tvb,\r\noffset, len, ENC_BIG_ENDIAN);\r\nlocal_addr = tvb_get_ipv4(tvb, offset);\r\nbreak;\r\ncase RSL_IE_IPAC_LOCAL_PORT:\r\nproto_tree_add_item(ie_tree, hf_rsl_local_port, tvb,\r\noffset, len, ENC_BIG_ENDIAN);\r\nlocal_port = tvb_get_ntohs(tvb, offset);\r\nbreak;\r\ncase RSL_IE_IPAC_SPEECH_MODE:\r\nproto_tree_add_item(ie_tree, hf_rsl_speech_mode_s, tvb,\r\noffset, len, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_tree, hf_rsl_speech_mode_m, tvb,\r\noffset, len, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase RSL_IE_IPAC_RTP_PAYLOAD:\r\ncase RSL_IE_IPAC_RTP_PAYLOAD2:\r\nproto_tree_add_item(ie_tree, hf_rsl_rtp_payload, tvb,\r\noffset, len, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase RSL_IE_IPAC_RTP_CSD_FMT:\r\nproto_tree_add_item(ie_tree, hf_rsl_rtp_csd_fmt_d, tvb,\r\noffset, len, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_tree, hf_rsl_rtp_csd_fmt_ir, tvb,\r\noffset, len, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase RSL_IE_IPAC_CONN_ID:\r\nproto_tree_add_item(ie_tree, hf_rsl_conn_id, tvb,\r\noffset, len, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase RSL_IE_IPAC_CONN_STAT:\r\nproto_tree_add_item(ie_tree, hf_rsl_cstat_tx_pkts, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_tree, hf_rsl_cstat_tx_octs, tvb,\r\noffset+4, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_tree, hf_rsl_cstat_rx_pkts, tvb,\r\noffset+8, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_tree, hf_rsl_cstat_rx_octs, tvb,\r\noffset+12, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_tree, hf_rsl_cstat_lost_pkts, tvb,\r\noffset+16, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_tree, hf_rsl_cstat_ia_jitter, tvb,\r\noffset+20, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_tree, hf_rsl_cstat_avg_tx_dly, tvb,\r\noffset+24, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\noffset += len;\r\n}\r\nswitch (msg_type) {\r\ncase RSL_MSG_TYPE_IPAC_CRCX_ACK:\r\nsrc_addr.type = AT_IPv4;\r\nsrc_addr.len = 4;\r\nsrc_addr.data = (guint8 *)&local_addr;\r\nrtp_add_address(pinfo, &src_addr, local_port, 0,\r\n"GSM A-bis/IP", pinfo->num, 0, NULL);\r\nrtcp_add_address(pinfo, &src_addr, local_port+1, 0,\r\n"GSM A-bis/IP", pinfo->num);\r\nbreak;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissct_rsl_msg(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, int offset)\r\n{\r\nguint8 msg_disc, msg_type, sys_info_type;\r\nmsg_disc = tvb_get_guint8(tvb, offset++) >> 1;\r\nmsg_type = tvb_get_guint8(tvb, offset) & 0x7f;\r\nproto_tree_add_item(tree, hf_rsl_msg_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nif (msg_disc == RSL_MSGDISC_IPACCESS) {\r\noffset = dissct_rsl_ipaccess_msg(tvb, pinfo, tree, offset);\r\nreturn offset;\r\n}\r\noffset++;\r\nswitch (msg_type) {\r\ncase RSL_MSG_TYPE_DATA_REQ:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_link_id(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_L3_inf(tvb, pinfo, tree, offset, TRUE, L3_INF_OTHER);\r\nbreak;\r\ncase RSL_MSG_TYPE_DATA_IND:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_link_id(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_L3_inf(tvb, pinfo, tree, offset, TRUE, L3_INF_OTHER);\r\nbreak;\r\ncase RSL_MSG_TYPE_ERROR_IND:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_link_id(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_rlm_cause(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_TYPE_EST_REQ:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_link_id(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_TYPE_EST_CONF:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_link_id(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_EST_IND:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_link_id(tvb, pinfo, tree, offset, TRUE);\r\nif (tvb_reported_length_remaining(tvb, offset) >1)\r\noffset = dissect_rsl_ie_L3_inf(tvb, pinfo, tree, offset, FALSE, L3_INF_OTHER);\r\nbreak;\r\ncase RSL_MSG_REL_REQ:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_link_id(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_rel_mode(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_REL_CONF:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_link_id(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_REL_IND:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_link_id(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_UNIT_DATA_REQ:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_link_id(tvb, pinfo, tree, offset, TRUE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_L3_inf(tvb, pinfo, tree, offset, FALSE, L3_INF_OTHER);\r\nbreak;\r\ncase RSL_MSG_BCCH_INFO:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_sys_info_type(tvb, pinfo, tree, offset, TRUE, &sys_info_type);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_full_bcch_inf(tvb, pinfo, tree, offset, TRUE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_starting_time(tvb, pinfo, tree, offset, FALSE);\r\nbreak;\r\ncase RSL_MSG_CCCH_LOAD_IND:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_rach_load(tvb, pinfo, tree, offset, FALSE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_paging_load(tvb, pinfo, tree, offset, FALSE);\r\nbreak;\r\ncase RSL_MSG_CHANRQD:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_req_ref(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_access_delay(tvb, pinfo, tree, offset, TRUE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_phy_ctx(tvb, pinfo, tree, offset, FALSE);\r\nbreak;\r\ncase RSL_MSG_DELETE_IND:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_full_imm_ass_inf(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_PAGING_CMD:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_paging_grp(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_ms_id(tvb, pinfo, tree, offset, TRUE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_ch_needed(tvb, pinfo, tree, offset, FALSE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_emlpp_prio(tvb, pinfo, tree, offset, FALSE);\r\nbreak;\r\ncase RSL_MSG_IMM_ASS_CMD:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_full_imm_ass_inf(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_SMS_BC_REQ:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_smscb_inf(tvb, pinfo, tree, offset, TRUE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_smscb_ch_ind(tvb, pinfo, tree, offset, FALSE);\r\nbreak;\r\ncase RSL_MSG_RF_RES_IND:\r\noffset = dissect_rsl_ie_resource_inf(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_SACCH_FILL:\r\noffset = dissect_rsl_ie_sys_info_type(tvb, pinfo, tree, offset, TRUE, &sys_info_type);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_L3_inf(tvb, pinfo, tree, offset, FALSE,\r\n(sys_info_type == 0x48) ? L3_INF_SACCH : L3_INF_OTHER);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_starting_time(tvb, pinfo, tree, offset, FALSE);\r\nbreak;\r\ncase RSL_MSG_OVERLOAD:\r\noffset = dissect_rsl_ie_cause(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_ERROR_REPORT:\r\noffset = dissect_rsl_ie_cause(tvb, pinfo, tree, offset, TRUE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_message_id(tvb, pinfo, tree, offset, FALSE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_link_id(tvb, pinfo, tree, offset, TRUE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_err_msg(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_SMS_BC_CMD:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_cb_cmd_type(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_smscb_mess(tvb, pinfo, tree, offset, TRUE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_smscb_ch_ind(tvb, pinfo, tree, offset, FALSE);\r\nbreak;\r\ncase RSL_MSG_CBCH_LOAD_IND:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_cbch_load_inf(tvb, pinfo, tree, offset, TRUE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_smscb_ch_ind(tvb, pinfo, tree, offset, FALSE);\r\nbreak;\r\ncase RSL_MSG_NOT_CMD:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_cmd_ind(tvb, pinfo, tree, offset, TRUE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_grp_call_ref(tvb, pinfo, tree, offset, FALSE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_ch_desc(tvb, pinfo, tree, offset, FALSE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_nch_drx(tvb, pinfo, tree, offset, FALSE);\r\nbreak;\r\ncase RSL_MSG_CHAN_ACTIV:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_act_type(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_ch_mode(tvb, pinfo, tree, offset, TRUE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_ch_id(tvb, pinfo, tree, offset, FALSE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_enc_inf(tvb, pinfo, tree, offset, FALSE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_ho_ref(tvb, pinfo, tree, offset, FALSE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_bs_power(tvb, pinfo, tree, offset, FALSE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_ms_pow(tvb, pinfo, tree, offset, FALSE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_timing_adv(tvb, pinfo, tree, offset, FALSE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_phy_ctx(tvb, pinfo, tree, offset, FALSE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_uic(tvb, pinfo, tree, offset, FALSE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_main_ch_ref(tvb, pinfo, tree, offset, FALSE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_multirate_conf(tvb, pinfo, tree, offset, FALSE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_multirate_cntrl(tvb, pinfo, tree, offset, FALSE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_sup_codec_types(tvb, pinfo, tree, offset, FALSE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_tfo_transp_cont(tvb, pinfo, tree, offset, FALSE);\r\nbreak;\r\ncase RSL_MSG_CHAN_ACTIV_ACK:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_frame_no(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_CHAN_ACTIV_N_ACK:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_cause(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_CONN_FAIL:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_cause(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_DEACTIVATE_SACCH:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_ENCR_CMD:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_enc_inf(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_link_id(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_L3_inf(tvb, pinfo, tree, offset, TRUE, L3_INF_OTHER);\r\nbreak;\r\ncase RSL_MSG_HANDODET:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_access_delay(tvb, pinfo, tree, offset, FALSE);\r\nbreak;\r\ncase RSL_MSG_MEAS_RES:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_meas_res_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_uplik_meas(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_bs_power(tvb, pinfo, tree, offset, TRUE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_l1_inf(tvb, pinfo, tree, offset, FALSE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0){\r\nif ( ( tvb_get_guint8(tvb, offset+3) & 0xFE ) == 0x10 ) {\r\noffset = dissect_rsl_ie_L3_inf(tvb, pinfo, tree, offset, FALSE, L3_INF_SACCH);\r\n}else{\r\noffset = dissect_rsl_ie_L3_inf(tvb, pinfo, tree, offset, FALSE, L3_INF_OTHER);\r\n}\r\n}\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_ms_timing_offset(tvb, pinfo, tree, offset, FALSE);\r\nbreak;\r\ncase RSL_MSG_MODE_MODIFY_REQ:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_ch_mode(tvb, pinfo, tree, offset, TRUE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_enc_inf(tvb, pinfo, tree, offset, FALSE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_main_ch_ref(tvb, pinfo, tree, offset, FALSE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_multirate_conf(tvb, pinfo, tree, offset, FALSE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_multirate_cntrl(tvb, pinfo, tree, offset, FALSE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_sup_codec_types(tvb, pinfo, tree, offset, FALSE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_tfo_transp_cont(tvb, pinfo, tree, offset, FALSE);\r\nbreak;\r\ncase RSL_MSG_MODE_MODIFY_ACK:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_MODE_MODIFY_NACK:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_cause(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_PHY_CONTEXT_REQ:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_PHY_CONTEXT_CONF:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_bs_power(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_ms_pow(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_timing_adv(tvb, pinfo, tree, offset, TRUE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_phy_ctx(tvb, pinfo, tree, offset, FALSE);\r\nbreak;\r\ncase RSL_MSG_RF_CHAN_REL:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_MS_POWER_CONTROL:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_ms_pow(tvb, pinfo, tree, offset, FALSE);\r\nbreak;\r\ncase RSL_MSG_BS_POWER_CONTROL:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_bs_power(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_PREPROC_CONFIG:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_PREPROC_MEAS_RES:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_RF_CHAN_REL_ACK:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_SACCH_INFO_MODIFY:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_sys_info_type(tvb, pinfo, tree, offset, TRUE, &sys_info_type);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_L3_inf(tvb, pinfo, tree, offset, FALSE,\r\n(sys_info_type == 0x48) ? L3_INF_SACCH : L3_INF_OTHER);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_starting_time(tvb, pinfo, tree, offset, FALSE);\r\nbreak;\r\ncase RSL_MSG_TALKER_DET:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_LISTENER_DET:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_REMOTE_CODEC_CONF_REP:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_codec_conf(tvb, pinfo, tree, offset, TRUE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_sup_codec_types(tvb, pinfo, tree, offset, FALSE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_tfo_transp_cont(tvb, pinfo, tree, offset, FALSE);\r\nbreak;\r\ncase RSL_MSG_R_T_D_REP:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_rtd(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_PRE_HANDO_NOTIF:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_multirate_cntrl(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_codec_conf(tvb, pinfo, tree, offset, TRUE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_tfo_transp_cont(tvb, pinfo, tree, offset, FALSE);\r\nbreak;\r\ncase RSL_MSG_MR_CODEC_MOD_REQ:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_multirate_conf(tvb, pinfo, tree, offset, FALSE);\r\nbreak;\r\ncase RSL_MSG_MR_CODEC_MOD_ACK:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_multirate_conf(tvb, pinfo, tree, offset, FALSE);\r\nbreak;\r\ncase RSL_MSG_MR_CODEC_MOD_NACK:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_cause(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_MR_CODEC_MOD_PER:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_multirate_conf(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_TFO_REP:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_tfo_status(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_TFO_MOD_REQ:\r\noffset = dissect_rsl_ie_ch_no(tvb, pinfo, tree, offset, TRUE);\r\noffset = dissect_rsl_ie_multirate_cntrl(tvb, pinfo, tree, offset, TRUE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_sup_codec_types(tvb, pinfo, tree, offset, FALSE);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\noffset = dissect_rsl_ie_tfo_transp_cont(tvb, pinfo, tree, offset, FALSE);\r\nbreak;\r\ncase RSL_MSG_LOC_INF:\r\noffset = dissect_rsl_ie_llp_apdu(tvb, pinfo, tree, offset, TRUE);\r\nbreak;\r\ncase RSL_MSG_TYPE_IPAC_MEAS_PP_DEF:\r\ncase RSL_MSG_TYPE_IPAC_HO_CAND_INQ:\r\ncase RSL_MSG_TYPE_IPAC_HO_CAND_RESP:\r\ncase RSL_MSG_TYPE_IPAC_PDCH_ACT:\r\ncase RSL_MSG_TYPE_IPAC_PDCH_ACT_ACK:\r\ncase RSL_MSG_TYPE_IPAC_PDCH_ACT_NACK:\r\ncase RSL_MSG_TYPE_IPAC_PDCH_DEACT:\r\ncase RSL_MSG_TYPE_IPAC_PDCH_DEACT_ACK:\r\ncase RSL_MSG_TYPE_IPAC_PDCH_DEACT_NACK:\r\nif (global_rsl_use_nano_bts)\r\noffset = dissct_rsl_ipaccess_msg(tvb, pinfo, tree, offset-1);\r\ndefault:\r\nbreak;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rsl(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data _U_)\r\n{\r\nproto_item *ti;\r\nproto_tree *rsl_tree;\r\nguint8 msg_type;\r\nint offset = 0;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "RSL");\r\ncol_clear(pinfo->cinfo, COL_INFO);\r\nmsg_type = tvb_get_guint8(tvb, offset+1) & 0x7f;\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s ", val_to_str_ext(msg_type, &rsl_msg_type_vals_ext, "unknown %u"));\r\ntop_tree = tree;\r\nti = proto_tree_add_item(tree, proto_rsl, tvb, 0, -1, ENC_NA);\r\nif (!global_rsl_use_nano_bts) {\r\nguint8 msg_disc = tvb_get_guint8(tvb, offset) >> 1;\r\nif (msg_disc == RSL_MSGDISC_IPACCESS)\r\nreturn 0;\r\n}\r\nrsl_tree = proto_item_add_subtree(ti, ett_rsl);\r\nproto_tree_add_item(rsl_tree, hf_rsl_msg_dsc, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(rsl_tree, hf_rsl_T_bit, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset = dissct_rsl_msg(tvb, pinfo, rsl_tree, offset);\r\nreturn offset;\r\n}\r\nvoid proto_register_rsl(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_rsl_msg_dsc,\r\n{ "Message discriminator", "gsm_abis_rsl.msg_dsc",\r\nFT_UINT8, BASE_DEC, VALS(rsl_msg_disc_vals), 0xfe,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_T_bit,\r\n{ "T bit", "gsm_abis_rsl.T_bit",\r\nFT_BOOLEAN, 8, TFS(&rsl_t_bit_vals), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_msg_type,\r\n{ "Message type", "gsm_abis_rsl.msg_type",\r\nFT_UINT8, BASE_HEX_DEC|BASE_EXT_STRING, &rsl_msg_type_vals_ext, 0x7f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_ie_id,\r\n{ "Element identifier", "gsm_abis_rsl.ie_id",\r\nFT_UINT8, BASE_HEX_DEC|BASE_EXT_STRING, &rsl_ie_type_vals_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_ie_length,\r\n{ "Length", "gsm_abis_rsl.ie_length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_ch_no_Cbits,\r\n{ "C-bits", "gsm_abis_rsl.ch_no_Cbits",\r\nFT_UINT8, BASE_DEC|BASE_EXT_STRING, &rsl_ch_no_Cbits_vals_ext, 0xf8,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_ch_no_TN,\r\n{ "Time slot number (TN)", "gsm_abis_rsl.ch_no_TN",\r\nFT_UINT8, BASE_DEC, NULL, 0x07,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_rtd,\r\n{ "Round Trip Delay (RTD)", "gsm_abis_rsl.rtd",\r\nFT_UINT8, BASE_DEC, NULL, 0xfe,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_delay_ind,\r\n{ "Delay IND", "gsm_abis_rsl.delay_ind",\r\nFT_UINT8, BASE_DEC, VALS(rsl_delay_ind_vals), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_tfo,\r\n{ "TFO", "gsm_abis_rsl.tfo",\r\nFT_BOOLEAN, 8, TFS(&rsl_tfo_vals), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_req_ref_ra,\r\n{ "Random Access Information (RA)", "gsm_abis_rsl.req_ref_ra",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_req_ref_T1prim,\r\n{ "T1'", "gsm_abis_rsl.req_ref_T1prim",\r\nFT_UINT8, BASE_DEC, NULL, 0xf8,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_req_ref_T3,\r\n{ "T3", "gsm_abis_rsl.req_ref_T3",\r\nFT_UINT16, BASE_DEC, NULL, 0x07e0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_req_ref_T2,\r\n{ "T2", "gsm_abis_rsl.req_ref_T2",\r\nFT_UINT8, BASE_DEC, NULL, 0x1f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_timing_adv,\r\n{ "Timing Advance", "gsm_abis_rsl.timing_adv",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_ho_ref,\r\n{ "Hand-over reference", "gsm_abis_rsl.ho_ref",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_l1inf_power_lev,\r\n{ "MS power level", "gsm_abis_rsl.ms_power_lev",\r\nFT_UINT8, BASE_DEC, NULL, 0xf8,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_l1inf_fpc,\r\n{ "FPC/EPC", "gsm_abis_rsl.ms_fpc",\r\nFT_BOOLEAN, 8, TFS(&rsl_ms_fpc_epc_mode_vals), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_ms_power_lev,\r\n{ "MS power level", "gsm_abis_rsl.ms_power_lev",\r\nFT_UINT8, BASE_DEC, NULL, 0x1f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_ms_fpc,\r\n{ "FPC/EPC", "gsm_abis_rsl.ms_fpc",\r\nFT_BOOLEAN, 8, TFS(&rsl_ms_fpc_epc_mode_vals), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_act_timing_adv,\r\n{ "Actual Timing Advance", "gsm_abis_rsl.act_timing_adv",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_dtxd,\r\n{ "DTXd", "gsm_abis_rsl.dtxd",\r\nFT_BOOLEAN, 8, TFS(&rsl_dtxd_vals), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_rxlev_full_up,\r\n{ "RXLEV.FULL.up", "gsm_abis_rsl.rxlev_full_up",\r\nFT_UINT8, BASE_DEC, NULL, 0x3f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_rxlev_sub_up,\r\n{ "RXLEV.SUB.up", "gsm_abis_rsl.rxlev_sub_up",\r\nFT_UINT8, BASE_DEC, NULL, 0x3f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_rxqual_full_up,\r\n{ "RXQUAL.FULL.up", "gsm_abis_rsl.rxqual_full_up",\r\nFT_UINT8, BASE_DEC, NULL, 0x38,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_rxqual_sub_up,\r\n{ "RXQUAL.SUB.up", "gsm_abis_rsl.rxqual_sub_up",\r\nFT_UINT8, BASE_DEC, NULL, 0x07,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_acc_delay,\r\n{ "Access Delay", "gsm_abis_rsl.acc_del",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_rach_slot_cnt,\r\n{ "RACH Slot Count", "gsm_abis_rsl.rach_slot_cnt",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_rach_busy_cnt,\r\n{ "RACH Busy Count", "gsm_abis_rsl.rach_busy_cnt",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_rach_acc_cnt,\r\n{ "RACH Access Count", "gsm_abis_rsl.rach_acc_cnt",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_phy_ctx,\r\n{ "Physical Context", "gsm_abis_rsl.phy_ctx",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_na,\r\n{ "Not applicable (NA)", "gsm_abis_rsl.na",\r\nFT_BOOLEAN, 8, TFS(&rsl_na_vals), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_ch_type,\r\n{ "channel type", "gsm_abis_rsl.ch_type",\r\nFT_UINT8, BASE_DEC, VALS(rsl_ch_type_vals), 0xc0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_prio,\r\n{ "Priority", "gsm_abis_rsl.prio",\r\nFT_UINT8, BASE_DEC, VALS(rsl_prio_vals), 0x18,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_sapi,\r\n{ "SAPI", "gsm_abis_rsl.sapi",\r\nFT_UINT8, BASE_DEC, NULL, 0x07,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_rbit,\r\n{ "R", "gsm_abis_rsl.rbit",\r\nFT_BOOLEAN, 8, TFS(&rsl_rbit_vals), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_a3a2,\r\n{ "A3A2", "gsm_abis_rsl.a3a2",\r\nFT_UINT8, BASE_DEC, VALS(rsl_a3a2_vals), 0x06,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_a1_0,\r\n{ "A1", "gsm_abis_rsl.a1_0",\r\nFT_BOOLEAN, 8, TFS(&rsl_a1_0_vals), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_a1_1,\r\n{ "A1", "gsm_abis_rsl.a1_1",\r\nFT_BOOLEAN, 8, TFS(&rsl_a1_1_vals), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_a1_2,\r\n{ "A1", "gsm_abis_rsl.a2_0",\r\nFT_BOOLEAN, 8, TFS(&rsl_a1_2_vals), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_epc_mode,\r\n{ "EPC mode", "gsm_abis_rsl.epc_mode",\r\nFT_BOOLEAN, 8, TFS(&rsl_epc_mode_vals), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_bs_fpc_epc_mode,\r\n{ "FPC-EPC mode", "gsm_abis_rsl.fpc_epc_mode",\r\nFT_BOOLEAN, 8, TFS(&rsl_fpc_epc_mode_vals), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_bs_power,\r\n{ "Power Level", "gsm_abis_rsl.bs_power",\r\nFT_UINT8, BASE_DEC|BASE_EXT_STRING, &rsl_rlm_bs_power_vals_ext, 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_cm_dtxd,\r\n{ "DTXd", "gsm_abis_rsl.cm_dtxd",\r\nFT_BOOLEAN, 8, TFS(&rsl_dtx_vals), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_cm_dtxu,\r\n{ "DTXu", "gsm_abis_rsl.cm_dtxu",\r\nFT_BOOLEAN, 8, TFS(&rsl_dtx_vals), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_speech_or_data,\r\n{ "Speech or data indicator", "gsm_abis_rsl.speech_or_data",\r\nFT_UINT8, BASE_DEC, VALS(rsl_speech_or_data_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_ch_rate_and_type,\r\n{ "Channel rate and type", "gsm_abis_rsl.ch_rate_and_type",\r\nFT_UINT8, BASE_DEC|BASE_EXT_STRING, &rsl_ch_rate_and_type_vals_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_speech_coding_alg,\r\n{ "Speech coding algorithm", "gsm_abis_rsl.speech_coding_alg",\r\nFT_UINT8, BASE_DEC, VALS(rsl_speech_coding_alg_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_t_nt_bit,\r\n{ "Transparent indication", "gsm_abis_rsl.t_nt_bit",\r\nFT_BOOLEAN, 8, TFS(&t_nt_bit_vals), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_ra_if_data_rte,\r\n{ "Radio interface data rate", "gsm_abis_rsl.ra_if_data_rte",\r\nFT_UINT8, BASE_DEC, VALS(rsl_ra_if_data_rte_vals), 0x3f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_data_rte,\r\n{ "Data rate", "gsm_abis_rsl.data_rte",\r\nFT_UINT8, BASE_DEC, VALS(rsl_ra_if_data_rte_vals), 0x3f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_alg_id,\r\n{ "Algorithm Identifier", "gsm_abis_rsl.alg_id",\r\nFT_UINT8, BASE_DEC, VALS(rsl_algorithm_id_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_key,\r\n{ "KEY", "gsm_abis_rsl.key",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_cause,\r\n{ "Cause", "gsm_abis_rsl.cause",\r\nFT_UINT8, BASE_DEC|BASE_EXT_STRING, &rsl_rlm_cause_vals_ext, 0x7f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_rel_mode,\r\n{ "Release Mode", "gsm_abis_rsl.rel_mode",\r\nFT_UINT8, BASE_DEC, VALS(rel_mode_vals), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_interf_band,\r\n{ "Interf Band", "gsm_abis_rsl.interf_band",\r\nFT_UINT8, BASE_DEC, NULL, 0xe0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_interf_band_reserved,\r\n{ "Interf Band reserved bits", "gsm_abis_rsl.interf_band_reserved",\r\nFT_UINT8, BASE_DEC, NULL, 0x1f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_meas_res_no,\r\n{ "Measurement result number", "gsm_abis_rsl.meas_res_no",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_extension_bit,\r\n{ "Extension", "gsm_abis_rsl.extension_bit",\r\nFT_BOOLEAN, 8, TFS(&rsl_extension_bit_value), 0x80,\r\nNULL, HFILL }},\r\n{ &hf_rsl_class,\r\n{ "Class", "gsm_abis_rsl.class",\r\nFT_UINT8, BASE_DEC, VALS(rsl_class_vals), 0x70,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_paging_grp,\r\n{ "Paging Group", "gsm_abis_rsl.paging_grp",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_paging_load,\r\n{ "Paging Buffer Space", "gsm_abis_rsl.paging_load",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_sys_info_type,\r\n{ "System Info Type", "gsm_abis_rsl.sys_info_type",\r\nFT_UINT8, BASE_DEC|BASE_EXT_STRING, &rsl_sys_info_type_vals_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_timing_offset,\r\n{ "Timing Offset", "gsm_abis_rsl.timing_offset",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_ch_needed,\r\n{ "Channel Needed", "gsm_abis_rsl.ch_needed",\r\nFT_UINT8, BASE_DEC, VALS(rsl_ch_needed_vals), 0x03,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_cbch_load_type,\r\n{ "CBCH Load Type", "gsm_abis_rsl.cbch_load_type",\r\nFT_BOOLEAN, 8, TFS(&rsl_cbch_load_type_vals), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_msg_slt_cnt,\r\n{ "Message Slot Count", "gsm_abis_rsl.sg_slt_cnt",\r\nFT_UINT8, BASE_DEC, NULL, 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_ch_ind,\r\n{ "Channel Ind", "gsm_abis_rsl.ch_ind",\r\nFT_UINT8, BASE_DEC, VALS(rsl_ch_ind_vals), 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_command,\r\n{ "Command", "gsm_abis_rsl.cmd",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_emlpp_prio,\r\n{ "eMLPP Priority", "gsm_abis_rsl.emlpp_prio",\r\nFT_UINT8, BASE_DEC, VALS(rsl_emlpp_prio_vals), 0x03,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rsl_speech_mode_s,\r\n{ "ip.access Speech Mode S", "gsm_abis_rsl.ipacc.speech_mode_s",\r\nFT_UINT8, BASE_HEX, VALS(rsl_ipacc_spm_s_vals),\r\n0xf, NULL, HFILL }\r\n},\r\n{ &hf_rsl_speech_mode_m,\r\n{ "ip.access Speech Mode M", "gsm_abis_rsl.ipacc.speech_mode_m",\r\nFT_UINT8, BASE_HEX, VALS(rsl_ipacc_spm_m_vals),\r\n0xf0, NULL, HFILL }\r\n},\r\n{ &hf_rsl_conn_id,\r\n{ "ip.access Connection ID", "gsm_abis_rsl.ipacc.conn_id",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_rsl_rtp_payload,\r\n{ "ip.access RTP Payload Type", "gsm_abis_rsl.ipacc.rtp_payload",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_rsl_rtp_csd_fmt_d,\r\n{ "ip.access RTP CSD Format D", "gsm_abis_rsl.ipacc.rtp_csd_fmt_d",\r\nFT_UINT8, BASE_HEX, VALS(rsl_ipacc_rtp_csd_fmt_d_vals),\r\n0x0f, NULL, HFILL },\r\n},\r\n{ &hf_rsl_rtp_csd_fmt_ir,\r\n{ "ip.access RTP CSD Format IR", "gsm_abis_rsl.ipacc.rtp_csd_fmt_ir",\r\nFT_UINT8, BASE_HEX, VALS(rsl_ipacc_rtp_csd_fmt_ir_vals),\r\n0xf0, NULL, HFILL },\r\n},\r\n{ &hf_rsl_local_port,\r\n{ "ip.access Local RTP Port", "gsm_abis_rsl.ipacc.local_port",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL },\r\n},\r\n{ &hf_rsl_remote_port,\r\n{ "ip.access Remote RTP Port", "gsm_abis_rsl.ipacc.remote_port",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL },\r\n},\r\n{ &hf_rsl_local_ip,\r\n{ "ip.access Local IP Address", "gsm_abis_rsl.ipacc.local_ip",\r\nFT_IPv4, BASE_NONE, NULL, 0x0, NULL, HFILL },\r\n},\r\n{ &hf_rsl_remote_ip,\r\n{ "ip.access Remote IP Address", "gsm_abis_rsl.ipacc.remote_ip",\r\nFT_IPv4, BASE_NONE, NULL, 0x0, NULL, HFILL },\r\n},\r\n{ &hf_rsl_cstat_tx_pkts,\r\n{ "Packets Sent", "gsm_abis_rsl.ipacc.cstat.tx_pkts",\r\nFT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_rsl_cstat_tx_octs,\r\n{ "Octets Sent", "gsm_abis_rsl.ipacc.cstat.tx_octets",\r\nFT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_rsl_cstat_rx_pkts,\r\n{ "Packets Received", "gsm_abis_rsl.ipacc.cstat.rx_pkts",\r\nFT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_rsl_cstat_rx_octs,\r\n{ "Octets Received", "gsm_abis_rsl.ipacc.cstat.rx_octets",\r\nFT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_rsl_cstat_lost_pkts,\r\n{ "Packets Lost", "gsm_abis_rsl.ipacc.cstat.lost_pkts",\r\nFT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_rsl_cstat_ia_jitter,\r\n{ "Inter-arrival Jitter", "gsm_abis_rsl.ipacc.cstat.ia_jitter",\r\nFT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_rsl_cstat_avg_tx_dly,\r\n{ "Average Tx Delay", "gsm_abis_rsl.ipacc.cstat.avg_tx_delay",\r\nFT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_rsl_channel_description_tag, { "Channel Description Tag", "gsm_abis_rsl.channel_description_tag", FT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_rsl_mobile_allocation_tag, { "Mobile Allocation Tag+Length(0)", "gsm_abis_rsl.mobile_allocation_tag", FT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_rsl_no_resources_required, { "0 No resources required(All other values are reserved)", "gsm_abis_rsl.no_resources_required", FT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_rsl_llsdu_ccch, { "Link Layer Service Data Unit (L3 Message)(CCCH)", "gsm_abis_rsl.llsdu.ccch", FT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_rsl_llsdu_sacch, { "Link Layer Service Data Unit (L3 Message)(SACCH)", "gsm_abis_rsl.llsdu.sacch", FT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_rsl_llsdu, { "Link Layer Service Data Unit (L3 Message)", "gsm_abis_rsl.llsdu", FT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_rsl_rach_supplementary_information, { "Supplementary Information", "gsm_abis_rsl.supplementary_information", FT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_rsl_full_immediate_assign_info_field, { "Full Immediate Assign Info field", "gsm_abis_rsl.full_immediate_assign_info_field", FT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_rsl_layer_3_message, { "Layer 3 message", "gsm_abis_rsl.layer_3_message", FT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_rsl_descriptive_group_or_broadcast_call_reference, { "Descriptive group or broadcast call reference", "gsm_abis_rsl.descriptive_group_or_broadcast_call_reference", FT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_rsl_group_channel_description, { "Group Channel Description", "gsm_abis_rsl.group_channel_description", FT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_rsl_uic, { "UIC", "gsm_abis_rsl.uic", FT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_rsl_codec_list, { "Codec List", "gsm_abis_rsl.codec_list", FT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_rsl,\r\n&ett_ie_link_id,\r\n&ett_ie_act_type,\r\n&ett_ie_bs_power,\r\n&ett_ie_ch_id,\r\n&ett_ie_ch_mode,\r\n&ett_ie_enc_inf,\r\n&ett_ie_ch_no,\r\n&ett_ie_frame_no,\r\n&ett_ie_ho_ref,\r\n&ett_ie_l1_inf,\r\n&ett_ie_L3_inf,\r\n&ett_ie_ms_id,\r\n&ett_ie_ms_pow,\r\n&ett_ie_phy_ctx,\r\n&ett_ie_paging_grp,\r\n&ett_ie_paging_load,\r\n&ett_ie_access_delay,\r\n&ett_ie_rach_load,\r\n&ett_ie_req_ref,\r\n&ett_ie_rel_mode,\r\n&ett_ie_resource_inf,\r\n&ett_ie_rlm_cause,\r\n&ett_ie_staring_time,\r\n&ett_ie_timing_adv,\r\n&ett_ie_uplink_meas,\r\n&ett_ie_full_imm_ass_inf,\r\n&ett_ie_smscb_inf,\r\n&ett_ie_ms_timing_offset,\r\n&ett_ie_err_msg,\r\n&ett_ie_full_bcch_inf,\r\n&ett_ie_ch_needed,\r\n&ett_ie_cb_cmd_type,\r\n&ett_ie_smscb_mess,\r\n&ett_ie_cbch_load_inf,\r\n&ett_ie_smscb_ch_ind,\r\n&ett_ie_grp_call_ref,\r\n&ett_ie_ch_desc,\r\n&ett_ie_nch_drx,\r\n&ett_ie_cmd_ind,\r\n&ett_ie_emlpp_prio,\r\n&ett_ie_uic,\r\n&ett_ie_main_ch_ref,\r\n&ett_ie_multirate_conf,\r\n&ett_ie_multirate_cntrl,\r\n&ett_ie_sup_codec_types,\r\n&ett_ie_codec_conf,\r\n&ett_ie_rtd,\r\n&ett_ie_tfo_status,\r\n&ett_ie_llp_apdu,\r\n&ett_ie_tfo_transp_cont,\r\n&ett_ie_cause,\r\n&ett_ie_meas_res_no,\r\n&ett_ie_message_id,\r\n&ett_ie_sys_info_type,\r\n&ett_ie_speech_mode,\r\n&ett_ie_conn_id,\r\n&ett_ie_remote_ip,\r\n&ett_ie_remote_port,\r\n&ett_ie_local_port,\r\n&ett_ie_local_ip,\r\n&ett_ie_rtp_payload,\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_rsl_speech_or_data_indicator, { "gsm_abis_rsl.speech_or_data_indicator.bad", PI_PROTOCOL, PI_WARN, "Speech or data indicator != 1,2 or 3", EXPFILL }},\r\n{ &ei_rsl_facility_information_element_3gpp_ts_44071, { "gsm_abis_rsl.facility_information_element_3gpp_ts_44071", PI_PROTOCOL, PI_NOTE, "Facility Information Element as defined in 3GPP TS 44.071", EXPFILL }},\r\n{ &ei_rsl_embedded_message_tfo_configuration, { "gsm_abis_rsl.embedded_message_tfo_configuration", PI_PROTOCOL, PI_NOTE, "Embedded message that contains the TFO configuration", EXPFILL }},\r\n};\r\nmodule_t *rsl_module;\r\nexpert_module_t *expert_rsl;\r\n#define RSL_ATT_TLVDEF(_attr, _type, _fixed_len) \\r\nrsl_att_tlvdef.def[_attr].type = _type; \\r\nrsl_att_tlvdef.def[_attr].fixed_len = _fixed_len; \\r\nRSL_ATT_TLVDEF(RSL_IE_CH_NO, TLV_TYPE_TV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_LINK_ID, TLV_TYPE_TV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_ACT_TYPE, TLV_TYPE_TV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_BS_POW, TLV_TYPE_TV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_CH_ID, TLV_TYPE_TLV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_CH_MODE, TLV_TYPE_TLV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_ENC_INF, TLV_TYPE_TLV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_FRAME_NO, TLV_TYPE_FIXED, 2);\r\nRSL_ATT_TLVDEF(RSL_IE_HO_REF, TLV_TYPE_TV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_L1_INF, TLV_TYPE_FIXED, 2);\r\nRSL_ATT_TLVDEF(RSL_IE_L3_INF, TLV_TYPE_TL16V, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_MS_ID, TLV_TYPE_TLV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_MS_POW, TLV_TYPE_TV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_PAGING_GRP, TLV_TYPE_TV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_PAGING_LOAD, TLV_TYPE_FIXED, 2);\r\nRSL_ATT_TLVDEF(RSL_IE_PHY_CTX, TLV_TYPE_TLV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_ACCESS_DELAY, TLV_TYPE_TV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_RACH_LOAD, TLV_TYPE_TLV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_REQ_REF, TLV_TYPE_FIXED, 3);\r\nRSL_ATT_TLVDEF(RSL_IE_REL_MODE, TLV_TYPE_TV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_RESOURCE_INF, TLV_TYPE_TLV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_RLM_CAUSE, TLV_TYPE_TLV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_STARTING_TIME, TLV_TYPE_FIXED, 2);\r\nRSL_ATT_TLVDEF(RSL_IE_TIMING_ADV, TLV_TYPE_TV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_UPLINK_MEAS, TLV_TYPE_TLV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_CAUSE, TLV_TYPE_TLV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_MEAS_RES_NO, TLV_TYPE_TV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_MESSAGE_ID, TLV_TYPE_TV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_SYS_INFO_TYPE, TLV_TYPE_TV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_MS_POWER_PARAM, TLV_TYPE_TLV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_BS_POWER_PARAM, TLV_TYPE_TLV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_PREPROC_PARAM, TLV_TYPE_TLV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_PREPROC_MEAS, TLV_TYPE_TLV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_ERR_MSG, TLV_TYPE_TLV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_FULL_BCCH_INF, TLV_TYPE_TLV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_CH_NEEDED, TLV_TYPE_TV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_CB_CMD_TYPE, TLV_TYPE_TV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_SMSCB_MESS, TLV_TYPE_TLV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_FULL_IMM_ASS_INF, TLV_TYPE_TLV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_CBCH_LOAD_INF, TLV_TYPE_TV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_SMSCB_CH_IND, TLV_TYPE_TV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_GRP_CALL_REF, TLV_TYPE_TLV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_CH_DESC, TLV_TYPE_TLV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_NCH_DRX_INF, TLV_TYPE_TLV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_CMD_IND, TLV_TYPE_TLV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_EMLPP_PRIO, TLV_TYPE_TV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_UIC, TLV_TYPE_TLV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_MAIN_CH_REF, TLV_TYPE_TV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_MULTIRATE_CONF, TLV_TYPE_TLV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_MULTIRATE_CNTRL, TLV_TYPE_TV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_SUP_CODEC_TYPES, TLV_TYPE_TLV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_CODEC_CONF, TLV_TYPE_TLV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_RTD, TLV_TYPE_TV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_TFO_STATUS, TLV_TYPE_TV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_LLP_APDU, TLV_TYPE_TLV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_IPAC_REMOTE_IP, TLV_TYPE_FIXED, 4);\r\nRSL_ATT_TLVDEF(RSL_IE_IPAC_REMOTE_PORT, TLV_TYPE_FIXED, 2);\r\nRSL_ATT_TLVDEF(RSL_IE_IPAC_LOCAL_IP, TLV_TYPE_FIXED, 4);\r\nRSL_ATT_TLVDEF(RSL_IE_IPAC_CONN_STAT, TLV_TYPE_TLV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_IPAC_LOCAL_PORT, TLV_TYPE_FIXED, 2);\r\nRSL_ATT_TLVDEF(RSL_IE_IPAC_SPEECH_MODE, TLV_TYPE_TV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_IPAC_CONN_ID, TLV_TYPE_FIXED, 2);\r\nRSL_ATT_TLVDEF(RSL_IE_IPAC_RTP_PAYLOAD2, TLV_TYPE_TV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_IPAC_RTP_PAYLOAD, TLV_TYPE_TV, 0);\r\nRSL_ATT_TLVDEF(RSL_IE_IPAC_RTP_CSD_FMT, TLV_TYPE_TV, 0);\r\nproto_rsl = proto_register_protocol("Radio Signalling Link (RSL)", "RSL", "gsm_abis_rsl");\r\nproto_register_field_array(proto_rsl, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_rsl = expert_register_protocol(proto_rsl);\r\nexpert_register_field_array(expert_rsl, ei, array_length(ei));\r\nrsl_handle = register_dissector("gsm_abis_rsl", dissect_rsl, proto_rsl);\r\nrsl_module = prefs_register_protocol(proto_rsl, proto_reg_handoff_rsl);\r\nprefs_register_bool_preference(rsl_module, "use_ipaccess_rsl",\r\n"Use nanoBTS definitions",\r\n"Use ipaccess nanoBTS specific definitions for RSL",\r\n&global_rsl_use_nano_bts);\r\n}\r\nvoid\r\nproto_reg_handoff_rsl(void)\r\n{\r\ndissector_add_uint("lapd.gsm.sapi", LAPD_GSM_SAPI_RA_SIG_PROC, rsl_handle);\r\ngsm_cbch_handle = find_dissector_add_dependency("gsm_cbch", proto_rsl);\r\ngsm_cbs_handle = find_dissector_add_dependency("gsm_cbs", proto_rsl);\r\ngsm_a_ccch_handle = find_dissector_add_dependency("gsm_a_ccch", proto_rsl);\r\ngsm_a_dtap_handle = find_dissector_add_dependency("gsm_a_dtap", proto_rsl);\r\ngsm_a_sacch_handle = find_dissector_add_dependency("gsm_a_sacch", proto_rsl);\r\n}
