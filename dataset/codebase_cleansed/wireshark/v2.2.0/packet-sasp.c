static guint\r\nget_sasp_pdu_len(packet_info *pinfo _U_, tvbuff_t *tvb, int offset, void *data _U_)\r\n{\r\nreturn tvb_get_ntohl(tvb, offset + 5);\r\n}\r\nstatic int\r\ndissect_sasp_pdu(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nproto_item *ti;\r\nproto_item *hti;\r\nproto_item *mti;\r\nproto_tree *sasp_tree;\r\nproto_tree *msg_tree;\r\nproto_tree *pay_load;\r\nguint16 msg_type;\r\nguint16 hdr_type;\r\nguint32 offset = 0;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "SASP");\r\ncol_clear(pinfo->cinfo, COL_INFO);\r\nti = proto_tree_add_item(tree, proto_sasp, tvb, offset, -1, ENC_NA);\r\nsasp_tree = proto_item_add_subtree(ti, ett_sasp_header);\r\nhdr_type = tvb_get_ntohs(tvb, offset);\r\nhti = proto_tree_add_uint_format_value(sasp_tree, hf_sasp_type, tvb, offset, 2, hdr_type,\r\n"%s", (hdr_type == SASP_HDR_TYPE) ? "SASP" : "[Invalid]");\r\nif (hdr_type != SASP_HDR_TYPE)\r\n{\r\nexpert_add_info_format(pinfo, hti, &ei_msg_type_invalid,\r\n"Invalid SASP Header Type [0x%04x]", hdr_type);\r\ncol_set_str(pinfo->cinfo, COL_INFO, "[Malformed: Invalid SASP Header Type]");\r\nreturn tvb_reported_length(tvb);\r\n}\r\noffset += 2;\r\nproto_tree_add_item(sasp_tree, hf_sasp_length, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(sasp_tree, hf_sasp_vrsn, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nmsg_tree = proto_item_add_subtree(ti, ett_sasp_msg);\r\nproto_tree_add_item(msg_tree, hf_msg_len, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(msg_tree, hf_msg_id, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nmsg_type = tvb_get_ntohs(tvb, offset);\r\nmti = proto_tree_add_item(msg_tree, hf_msg_type, tvb, offset, 2, ENC_BIG_ENDIAN);\r\npay_load = proto_item_add_subtree(ti, ett_sasp_payload);\r\noffset += 2;\r\nswitch(msg_type)\r\n{\r\ncase 0x1010:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Registration Request");\r\ndissect_reg_req(tvb, pay_load, offset);\r\nbreak;\r\ncase 0x1015:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Registration Reply");\r\ndissect_reg_rep(tvb, pay_load, offset);\r\nbreak;\r\ncase 0x1020:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Deregistration Request");\r\ndissect_dereg_req(tvb, pay_load, offset);\r\nbreak;\r\ncase 0x1025:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Deregistration Reply");\r\ndissect_dereg_rep(tvb, pay_load, offset);\r\nbreak;\r\ncase 0x1030:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Get Weights Request");\r\ndissect_wt_req(tvb, pay_load, offset);\r\nbreak;\r\ncase 0x1035:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Get Weights Response");\r\ndissect_wt_rep(tvb, pay_load, offset);\r\nbreak;\r\ncase 0x1040:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Send Weights Request");\r\ndissect_sendwt(tvb, pay_load, offset);\r\nbreak;\r\ncase 0x1050:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Set LB State Request");\r\ndissect_setlbstate_req(tvb, pay_load, offset);\r\nbreak;\r\ncase 0x1055:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Set LB State Reply");\r\ndissect_setlbstate_rep(tvb, pay_load, offset);\r\nbreak;\r\ncase 0x1060:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Set Member State Request");\r\ndissect_setmemstate_req(tvb, pay_load, offset);\r\nbreak;\r\ncase 0x1065:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Set Member State Reply");\r\ndissect_setmemstate_rep(tvb, pay_load, offset);\r\nbreak;\r\ndefault:\r\ncol_add_fstr(pinfo->cinfo, COL_INFO,\r\n"[Malformed: Unknown Message Type [0x%04x]", msg_type);\r\nexpert_add_info_format(pinfo, mti, &ei_msg_type_invalid,\r\n"Unknown SASP Message Type: 0x%4x", msg_type);\r\nbreak;\r\n}\r\nreturn tvb_reported_length(tvb);\r\n}\r\nstatic int\r\ndissect_sasp(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data)\r\n{\r\ntcp_dissect_pdus(tvb, pinfo, tree, sasp_desegment, SASP_MIN_PACKET_LEN, get_sasp_pdu_len,\r\ndissect_sasp_pdu, data);\r\nreturn tvb_reported_length(tvb);\r\n}\r\nstatic void dissect_reg_req(tvbuff_t *tvb, proto_tree *pay_load, guint32 offset)\r\n{\r\nproto_tree *reg_req_data;\r\nguint16 gmd_cnt, i;\r\nreg_req_data = proto_tree_add_subtree(pay_load, tvb, offset, -1, ett_sasp_reg_req_sz, NULL, "Reg Request");\r\nproto_tree_add_item(reg_req_data, hf_sasp_reg_req_sz, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(reg_req_data, hf_reg_req_lbflag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\ngmd_cnt = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_item(reg_req_data, hf_sasp_gmd_cnt, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nfor (i=0; i<gmd_cnt; i++)\r\noffset = dissect_grp_memdatacomp(tvb, reg_req_data, offset);\r\n}\r\nstatic void dissect_reg_rep(tvbuff_t *tvb, proto_tree *pay_load, guint32 offset)\r\n{\r\nproto_tree *reg_rep_tree;\r\nreg_rep_tree = proto_tree_add_subtree(pay_load, tvb, offset, -1 , ett_sasp_reg_rep, NULL, "Reg Reply");\r\nproto_tree_add_item(reg_rep_tree, hf_sasp_reg_rep_sz, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(reg_rep_tree, hf_sasp_reg_rep_rcode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic void dissect_dereg_req(tvbuff_t *tvb, proto_tree *pay_load, guint32 offset)\r\n{\r\nguint16 gmd_cnt, i;\r\nproto_tree *dereg_req_data;\r\nguint8 reason_flag;\r\nstatic gboolean first_flag = TRUE;\r\nwmem_strbuf_t *reasonflags_strbuf = wmem_strbuf_new_label(wmem_packet_scope());\r\nstatic const gchar *fstr[] = {"No Reason", "Learned & Purposeful" };\r\ndereg_req_data = proto_tree_add_subtree(pay_load, tvb, offset, -1, ett_sasp_dereg_req_sz, NULL, "DeReg Request");\r\nproto_tree_add_item(dereg_req_data, hf_sasp_dereg_req_sz, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(dereg_req_data, hf_dereg_req_lbflag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nwmem_strbuf_truncate(reasonflags_strbuf, 0);\r\nreason_flag = tvb_get_guint8(tvb, offset);\r\nif ((reason_flag & SASP_DEREG_REQ_REASON_LEARNED) == 0)\r\nwmem_strbuf_append_printf(reasonflags_strbuf, "%s%s", first_flag ? "" : ", ", fstr[0]);\r\nelse\r\nwmem_strbuf_append_printf(reasonflags_strbuf, "%s%s", first_flag ? "" : ", ", fstr[1]);\r\nfirst_flag = FALSE;\r\nproto_tree_add_uint_format(dereg_req_data, hf_dereg_req_reason_flag, tvb,\r\noffset, 1, reason_flag, "Reason: 0x%02x (%s)", reason_flag,\r\nwmem_strbuf_get_str(reasonflags_strbuf));\r\n#if 0\r\ndereg_req_reason_flag_tree = proto_item_add_subtree(dereg_req_reason_flag, ett_dereg_req_reason_flag);\r\n#endif\r\noffset += 1;\r\ngmd_cnt = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_item(dereg_req_data, hf_sasp_gmd_cnt, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nfor (i=0; i<gmd_cnt; i++)\r\noffset = dissect_grp_memdatacomp(tvb, dereg_req_data, offset);\r\n}\r\nstatic void dissect_dereg_rep(tvbuff_t *tvb, proto_tree *pay_load, guint32 offset)\r\n{\r\nproto_tree *dereg_rep_tree;\r\ndereg_rep_tree = proto_tree_add_subtree(pay_load, tvb, offset, -1, ett_sasp_dereg_rep, NULL, "Dereg Reply");\r\nproto_tree_add_item(dereg_rep_tree, hf_sasp_dereg_rep_sz, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(dereg_rep_tree, hf_sasp_dereg_rep_rcode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic void dissect_sendwt(tvbuff_t *tvb, proto_tree *pay_load, guint32 offset)\r\n{\r\nproto_tree *sendwt_tree;\r\nguint16 gwed_cnt, i;\r\nsendwt_tree = proto_tree_add_subtree(pay_load, tvb, offset, -1, ett_sasp_sendwt, NULL, "Send Weight");\r\nproto_tree_add_item(sendwt_tree, hf_sasp_sendwt_sz, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\ngwed_cnt = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_item(sendwt_tree, hf_sasp_sendwt_gwedcnt, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nfor (i=0; i<gwed_cnt; i++)\r\noffset = dissect_grp_wt_entry_datacomp(tvb, sendwt_tree, offset);\r\n}\r\nstatic void dissect_setmemstate_req(tvbuff_t *tvb, proto_tree *pay_load, guint32 offset)\r\n{\r\nproto_tree *setmemstate_req_data;\r\nguint16 gmsd_cnt, i;\r\nsetmemstate_req_data = proto_tree_add_subtree(pay_load, tvb, offset, -1, ett_sasp_setmemstate_req, NULL, "Set Mem State Request");\r\nproto_tree_add_item(setmemstate_req_data, hf_sasp_setmemstate_req_sz, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(setmemstate_req_data, hf_setmemstate_req_lbflag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\ngmsd_cnt = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_item(setmemstate_req_data, hf_sasp_setmemstate_req_gmsd_cnt, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nfor (i=0; i<gmsd_cnt; i++)\r\noffset = dissect_grp_memstatedatacomp(tvb, setmemstate_req_data, offset);\r\n}\r\nstatic void dissect_setmemstate_rep(tvbuff_t *tvb, proto_tree *pay_load, guint32 offset)\r\n{\r\nproto_tree *setmemstate_rep_tree;\r\nsetmemstate_rep_tree = proto_tree_add_subtree(pay_load, tvb, offset, -1, ett_sasp_setmemstate_rep, NULL, "Set Mem State Reply");\r\nproto_tree_add_item(setmemstate_rep_tree, hf_sasp_setmemstate_rep_sz, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(setmemstate_rep_tree, hf_sasp_setmemstate_rep_rcode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic guint32 dissect_memdatacomp(tvbuff_t *tvb, proto_tree *pay_load, guint32 offset, proto_tree **mdct_p)\r\n{\r\nproto_item *memdatacomp;\r\nproto_tree *memdatacomp_tree;\r\nguint8 lab_len;\r\nconst gchar *ip_str;\r\nstruct e_in6_addr ipv6_address;\r\ntvb_get_ipv6(tvb, offset+7, &ipv6_address);\r\nip_str = tvb_ip6_to_str(tvb, offset+7);\r\nlab_len = tvb_get_guint8(tvb, offset+23);\r\nmemdatacomp = proto_tree_add_ipv6_format(pay_load, hf_sasp_memdatacomp_ip,\r\ntvb, offset, 24+lab_len, &ipv6_address,\r\n"Member Data Comp (%s)", ip_str);\r\nmemdatacomp_tree = proto_item_add_subtree(memdatacomp, ett_sasp_memdatacomp);\r\nproto_tree_add_item(memdatacomp_tree, hf_sasp_memdatacomp_type, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(memdatacomp_tree, hf_sasp_memdatacomp_sz, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(memdatacomp_tree, hf_sasp_memdatacomp_protocol, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(memdatacomp_tree, hf_sasp_memdatacomp_port, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(memdatacomp_tree, hf_sasp_memdatacomp_ip, tvb, offset, 16, ENC_NA);\r\noffset += 16;\r\nproto_tree_add_item(memdatacomp_tree, hf_sasp_memdatacomp_lab_len, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(memdatacomp_tree, hf_sasp_memdatacomp_label, tvb, offset, lab_len, ENC_ASCII|ENC_NA);\r\noffset += lab_len;\r\nif (mdct_p != NULL)\r\n*mdct_p = memdatacomp_tree;\r\nreturn offset;\r\n}\r\nstatic guint32 dissect_grpdatacomp(tvbuff_t *tvb, proto_tree *pay_load, guint32 offset)\r\n{\r\nproto_tree *grpdatacomp_tree;\r\nguint8 LB_uid_len;\r\nguint8 grp_name_len;\r\ngrpdatacomp_tree = proto_tree_add_subtree(pay_load, tvb, offset, -1, ett_sasp_grpdatacomp, NULL, "Group Data Component");\r\nproto_tree_add_item(grpdatacomp_tree, hf_sasp_grpdatacomp, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(grpdatacomp_tree, hf_sasp_grpdatacomp_sz, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nLB_uid_len = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(grpdatacomp_tree, hf_sasp_grpdatacomp_LB_uid_len,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(grpdatacomp_tree, hf_sasp_grpdatacomp_LB_uid,\r\ntvb, offset, LB_uid_len, ENC_ASCII|ENC_NA);\r\noffset += (guint8)LB_uid_len;\r\ngrp_name_len = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(grpdatacomp_tree, hf_sasp_grpdatacomp_grp_name_len,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(grpdatacomp_tree, hf_sasp_grpdatacomp_grp_name,\r\ntvb, offset, grp_name_len, ENC_ASCII|ENC_NA);\r\noffset += grp_name_len;\r\nreturn offset;\r\n}\r\nstatic guint32 dissect_grp_memdatacomp(tvbuff_t *tvb, proto_tree *pay_load, guint32 offset)\r\n{\r\nproto_tree *grp_memdatacomp_tree;\r\nguint16 mem_cnt;\r\nguint16 i;\r\ngrp_memdatacomp_tree = proto_tree_add_subtree(pay_load, tvb, offset, -1, ett_sasp_grp_memdatacomp, NULL, "Group Of Member Data");\r\nproto_tree_add_item(grp_memdatacomp_tree, hf_sasp_grp_memdatacomp, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(grp_memdatacomp_tree, hf_sasp_grp_memdatacomp_sz, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nmem_cnt = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_item(grp_memdatacomp_tree, hf_sasp_grp_memdatacomp_cnt, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\noffset = dissect_grpdatacomp(tvb, grp_memdatacomp_tree, offset);\r\nfor (i=0; i<mem_cnt; i++)\r\noffset = dissect_memdatacomp(tvb, grp_memdatacomp_tree, offset, NULL);\r\nreturn offset;\r\n}\r\nstatic void dissect_wt_req(tvbuff_t *tvb, proto_tree *pay_load, guint32 offset)\r\n{\r\nproto_tree *get_wt_tree;\r\nguint16 gd_cnt, i;\r\nget_wt_tree = proto_tree_add_subtree(pay_load, tvb, offset, -1, ett_sasp_getwt, NULL, "Get Wt Req");\r\nproto_tree_add_item(get_wt_tree, hf_sasp_wt_req_sz, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\ngd_cnt = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_item(get_wt_tree, hf_sasp_wt_req_gd_cnt, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nfor (i=0; i<gd_cnt; i++)\r\noffset = dissect_grpdatacomp(tvb, get_wt_tree, offset);\r\n}\r\nstatic void dissect_wt_rep(tvbuff_t *tvb, proto_tree *pay_load, guint32 offset)\r\n{\r\nproto_tree *wt_rep_tree;\r\nguint16 gwed_cnt, i;\r\nwt_rep_tree = proto_tree_add_subtree(pay_load, tvb, offset, -1, ett_sasp_wt_rep, NULL, "Get Weights Reply");\r\nproto_tree_add_item(wt_rep_tree, hf_sasp_wt_rep_sz, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(wt_rep_tree, hf_sasp_wt_rep_rcode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(wt_rep_tree, hf_sasp_wt_rep_interval, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\ngwed_cnt = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_item(wt_rep_tree, hf_sasp_wt_rep_gwed_cnt, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nfor (i=0; i<gwed_cnt; i++)\r\noffset = dissect_grp_wt_entry_datacomp(tvb, wt_rep_tree, offset);\r\n}\r\nstatic void dissect_setlbstate_req(tvbuff_t *tvb, proto_tree *pay_load, guint32 offset)\r\n{\r\nguint8 LB_uid_len;\r\nstatic const int *lbflags[] = {\r\n&hf_sasp_pushflag,\r\n&hf_sasp_trustflag,\r\n&hf_sasp_nochangeflag,\r\nNULL\r\n};\r\nproto_tree *setlbstate_req_tree;\r\nsetlbstate_req_tree = proto_tree_add_subtree(pay_load, tvb, offset, -1, ett_sasp_setlbstate_req, NULL, "Set LB State Req");\r\nproto_tree_add_item(setlbstate_req_tree, hf_sasp_setlbstate_req_sz,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nLB_uid_len = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(setlbstate_req_tree, hf_sasp_setlbstate_req_LB_uid_len,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(setlbstate_req_tree, hf_sasp_setlbstate_req_LB_uid,\r\ntvb, offset, LB_uid_len, ENC_ASCII|ENC_NA);\r\noffset += (guint8)LB_uid_len;\r\nproto_tree_add_item(setlbstate_req_tree, hf_sasp_setlbstate_req_LB_health,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_bitmask_text(setlbstate_req_tree, tvb, offset, 1, "LB Flags:", NULL,\r\nett_setlbstate_req_lbflag, lbflags, ENC_BIG_ENDIAN, 0);\r\n}\r\nstatic void dissect_setlbstate_rep(tvbuff_t *tvb, proto_tree *pay_load, guint32 offset)\r\n{\r\nproto_tree *setlbstate_rep_tree;\r\nsetlbstate_rep_tree = proto_tree_add_subtree(pay_load, tvb, offset, -1, ett_sasp_setlbstate_rep, NULL, "Set LB State Rep");\r\nproto_tree_add_item(setlbstate_rep_tree, hf_sasp_setlbstate_rep_sz,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(setlbstate_rep_tree, hf_sasp_setlbstate_rep_rcode,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic guint32 dissect_grp_memstatedatacomp(tvbuff_t *tvb, proto_tree *pay_load, guint32 offset)\r\n{\r\nproto_tree *grp_memstatedatacomp_tree;\r\nguint16 mem_cnt;\r\nguint16 i;\r\ngrp_memstatedatacomp_tree = proto_tree_add_subtree(pay_load, tvb, offset, -1,\r\nett_sasp_grp_memstatedatacomp, NULL, "Group Mem State Comp");\r\nproto_tree_add_item(grp_memstatedatacomp_tree, hf_sasp_grp_memstatedatacomp,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(grp_memstatedatacomp_tree, hf_sasp_grp_memstatedatacomp_sz,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nmem_cnt = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_item(grp_memstatedatacomp_tree, hf_sasp_grp_memstatedatacomp_cnt,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\noffset = dissect_grpdatacomp(tvb, grp_memstatedatacomp_tree, offset);\r\nfor (i=0; i<mem_cnt; i++)\r\noffset = dissect_memstatedatacomp(tvb, grp_memstatedatacomp_tree, offset);\r\nreturn offset;\r\n}\r\nstatic guint32 dissect_memstatedatacomp(tvbuff_t *tvb, proto_tree *pay_load, guint32 offset)\r\n{\r\nproto_tree *memstatedatacomp_tree;\r\nproto_tree *memdatacomp_tree;\r\noffset = dissect_memdatacomp(tvb, pay_load, offset, &memdatacomp_tree);\r\nmemstatedatacomp_tree = proto_tree_add_subtree(memdatacomp_tree, tvb, offset, -1, ett_sasp_memstatedatacomp, NULL, "Member State Data");\r\nproto_tree_add_item(memstatedatacomp_tree, hf_sasp_memstatedatacomp_instance,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(memstatedatacomp_tree, hf_sasp_memstatedatacomp_sz,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(memstatedatacomp_tree, hf_sasp_memstatedatacomp_state,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(memstatedatacomp_tree, hf_sasp_memstatedatacomp_quiesce_flag,\r\ntvb, offset, 1, ENC_NA);\r\noffset += 1;\r\nreturn offset;\r\n}\r\nstatic guint32 dissect_weight_entry_data_comp(tvbuff_t *tvb, proto_tree *pay_load, guint32 offset)\r\n{\r\nproto_tree *weight_entry_data_comp_tree;\r\nstatic const int *wtflags[] = {\r\n&hf_sasp_wed_contactsuccess_flag,\r\n&hf_sasp_wed_quiesce_flag,\r\n&hf_sasp_wed_registration_flag,\r\n&hf_sasp_wed_confident_flag,\r\nNULL\r\n};\r\noffset = dissect_memdatacomp(tvb, pay_load, offset, NULL);\r\nweight_entry_data_comp_tree = proto_tree_add_subtree(pay_load, tvb, offset, -1,\r\nett_sasp_weight_entry_data_comp, NULL, "Weight Entry Data");\r\nproto_tree_add_item(weight_entry_data_comp_tree, hf_sasp_weight_entry_data_comp_type,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(weight_entry_data_comp_tree, hf_sasp_weight_entry_data_comp_sz,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(weight_entry_data_comp_tree, hf_sasp_weight_entry_data_comp_state,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_bitmask_text(weight_entry_data_comp_tree, tvb, offset, 1, "Flags:", NULL,\r\nett_wt_entry_data_flag, wtflags, ENC_BIG_ENDIAN, 0);\r\noffset += 1;\r\nproto_tree_add_item(weight_entry_data_comp_tree, hf_sasp_weight_entry_data_comp_weight,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nreturn offset;\r\n}\r\nstatic guint32 dissect_grp_wt_entry_datacomp(tvbuff_t *tvb, proto_tree *pay_load, guint32 offset)\r\n{\r\nproto_tree *grp_wt_entry_datacomp_tree;\r\nguint16 wt_entry_cnt;\r\nguint16 i;\r\ngrp_wt_entry_datacomp_tree = proto_tree_add_subtree(pay_load, tvb, offset, -1, ett_sasp_grp_wt_entry_datacomp, NULL, "Group of Wt Entry Data");\r\nproto_tree_add_item(grp_wt_entry_datacomp_tree, hf_sasp_grp_wt_entry_datacomp_type,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(grp_wt_entry_datacomp_tree, hf_sasp_grp_wt_entry_datacomp_sz,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nwt_entry_cnt = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_item(grp_wt_entry_datacomp_tree, hf_sasp_grp_wt_entry_datacomp_cnt,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\noffset = dissect_grpdatacomp(tvb, grp_wt_entry_datacomp_tree, offset);\r\nfor (i=0; i<wt_entry_cnt; i++)\r\noffset = dissect_weight_entry_data_comp(tvb, grp_wt_entry_datacomp_tree, offset);\r\nreturn offset;\r\n}\r\nvoid proto_register_sasp(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_sasp_type,\r\n{ "Type", "sasp.msg.type",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\n"SASP Header", HFILL }\r\n},\r\n{ &hf_sasp_length,\r\n{ "Length", "sasp.header.Len",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"SASP Header Length", HFILL }\r\n},\r\n{ &hf_sasp_vrsn,\r\n{ "Version", "sasp.version",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"SASP Version", HFILL }\r\n},\r\n{ &hf_msg_len,\r\n{ "Message Len", "sasp.msg.len",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"SASP Msg Len", HFILL }\r\n},\r\n{ &hf_msg_id,\r\n{ "Message Id", "sasp.msg.id",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"SASP Msg Id", HFILL }\r\n},\r\n{ &hf_msg_type,\r\n{ "Message Type", "sasp.msg.type",\r\nFT_UINT16, BASE_HEX|BASE_EXT_STRING, &msg_table_ext, 0x0,\r\n"SASP Msg Type", HFILL }\r\n},\r\n{ &hf_sasp_reg_req_sz,\r\n{ "Reg Req-Size", "sasp.reg-req.size",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"SASP Reg Req Size", HFILL }\r\n},\r\n{ &hf_reg_req_lbflag,\r\n{ "Reg Req-LB Flag", "sasp.reg-req.lbflag",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\n"SASP Reg Req LB Flag", HFILL } },\r\n{ &hf_sasp_gmd_cnt,\r\n{ "Grp Mem Data-Count", "sasp.grp-mem-data.count",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"SASP Grp Mem Data Count", HFILL } },\r\n{ &hf_sasp_reg_rep_sz,\r\n{ "Reg Reply-Size", "sasp.reg-rep.size",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"SASP Reg Reply size", HFILL } },\r\n{ &hf_sasp_reg_rep_rcode,\r\n{ "Reg Reply-Return Code", "sasp.reg-rep.retcode",\r\nFT_UINT8, BASE_HEX, VALS(reg_reply_response_code), 0x0,\r\n"SASP Reg Rep Return Code", HFILL } },\r\n{ &hf_sasp_dereg_req_sz,\r\n{ "Dereg Req-Size", "sasp.dereg-req.size",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"SASP Dereg Req Size", HFILL } },\r\n{ &hf_dereg_req_lbflag,\r\n{ "Dereg Req-LB Flag", "sasp.dereg-req.lbflag",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\n"SASP Dereg Req LB Flag", HFILL } },\r\n{ &hf_dereg_req_reason_flag,\r\n{ "Reason Flags", "sasp.flags.reason",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL } },\r\n#if 0\r\n{ &hf_dereg_req_reason,\r\n{ "Dereg Req-Reason", "sasp.dereg-req.reason",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\n"SASP Dereg Req Reason", HFILL } },\r\n#endif\r\n{ &hf_sasp_dereg_rep_sz,\r\n{ "Dereg Rep-Size", "sasp.dereg-rep.size",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"SASP Dereg Rep Size", HFILL } },\r\n{ &hf_sasp_dereg_rep_rcode,\r\n{ "Dereg Rep-Return Code", "sasp.dereg-rep.retcode",\r\nFT_UINT8, BASE_HEX, VALS(dereg_reply_response_code), 0x0,\r\n"SASP Dereg Rep Return Code", HFILL } },\r\n{ &hf_sasp_sendwt_sz,\r\n{ "Sendwt-Size", "sasp.sendwt.size",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"SASP Sendwt-Size", HFILL } },\r\n{ &hf_sasp_sendwt_gwedcnt,\r\n{ "Sendwt-Grp Wt EntryData Count", "sasp.sendwt-grp-wtentrydata.count",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"SASP Sendwt Grp Wt Entry Data Count", HFILL } },\r\n{ &hf_sasp_setmemstate_req_sz,\r\n{ "Set Memstate Req-Size", "sasp.setmemstate-req.size",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"SASP Set Memstate Req Size", HFILL } },\r\n{ &hf_setmemstate_req_lbflag,\r\n{ "Set Memstate Req-LB Flag", "sasp.setmemstate-req.lbflag",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\n"SASP Set Memstate Req LB Flag", HFILL } },\r\n{ &hf_sasp_setmemstate_req_gmsd_cnt,\r\n{ "Set Memstate Req-Gmsd Count", "sasp.group-memstate.count",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Group Of Member State Data Count", HFILL } },\r\n#if 0\r\n{ &hf_sasp_setmemstate_rep,\r\n{ "Set Memstate Reply", "sasp.setmemstate-rep",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\n"SASP Set Memstate Reply", HFILL } },\r\n#endif\r\n{ &hf_sasp_setmemstate_rep_sz,\r\n{ "Set Memstate Rep-Size", "sasp.setmemstate-rep.size",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"SASP Set Memstate Rep Size", HFILL } },\r\n{ &hf_sasp_setmemstate_rep_rcode,\r\n{ "Set Memstate Rep-Return Code", "sasp.setmemstate-rep.retcode",\r\nFT_UINT8, BASE_HEX, VALS(set_mem_state_reply_response_code), 0x0,\r\n"SASP Set Memstate Rep Return Code", HFILL } },\r\n{ &hf_sasp_memdatacomp_type,\r\n{ "Message Type", "sasp.msg.type",\r\nFT_UINT16, BASE_HEX|BASE_EXT_STRING, &msg_table_ext, 0x0,\r\n"SASP Mem Data Comp", HFILL } },\r\n{ &hf_sasp_memdatacomp_sz,\r\n{ "Mem Data Comp-Size", "sasp.memdatacomp.size",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"SASP Mem Data Comp Size", HFILL } },\r\n{ &hf_sasp_memdatacomp_protocol,\r\n{ "Mem Data Comp-Protocol", "sasp.memdatacomp.protocol",\r\nFT_UINT8, BASE_HEX, VALS(protocol_table), 0x0,\r\n"SASP Mem Data Comp Protocol", HFILL } },\r\n{ &hf_sasp_memdatacomp_port,\r\n{ "Mem Data Comp-Port", "sasp.memdatacomp.port",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"SASP Mem Data Comp Port", HFILL } },\r\n{ &hf_sasp_memdatacomp_ip,\r\n{ "Mem Data Comp-Ip", "sasp.memdatacomp.ip",\r\nFT_IPv6, BASE_NONE, NULL, 0x0,\r\n"SASP Mem Data Comp Ip", HFILL } },\r\n{ &hf_sasp_memdatacomp_lab_len,\r\n{ "Mem Data Comp-Label Len", "sasp.memdatacomp.label.len",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"SASP Mem Data Comp Label Length", HFILL } },\r\n{ &hf_sasp_memdatacomp_label,\r\n{ "Mem Data Comp-Label", "sasp.memdatacomp.label",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\n"SASP Mem Data Comp Label", HFILL } },\r\n{ &hf_sasp_wt_req_sz,\r\n{ "Get Wt Req-Size", "sasp.getwt.req.size",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"SASP Get Wt Req Size", HFILL } },\r\n{ &hf_sasp_wt_req_gd_cnt,\r\n{ "Get Wt Req-Grp Data Count", "sasp.getwt-req-grpdata.count",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"SASP Get Wt Grp Data Count", HFILL } },\r\n{ &hf_sasp_wt_rep_sz,\r\n{ "Get Wt Rep-Size", "sasp.getwt.rep.size",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"SASP Get Wt Rep Size", HFILL } },\r\n{ &hf_sasp_wt_rep_rcode,\r\n{ "Get Wt Rep-Return Code", "sasp.getwt-rep.retcode",\r\nFT_UINT8, BASE_HEX, VALS(get_weights_reply_response_code), 0x0,\r\n"SASP Get Wt Rep Return Code", HFILL } },\r\n{ &hf_sasp_wt_rep_interval,\r\n{ "Get Wt Rep-Interval", "sasp.getwt-rep.interval",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"SASP Get Wt Rep Interval", HFILL } },\r\n{ &hf_sasp_wt_rep_gwed_cnt,\r\n{ "Get Wt Rep-Grp WtEntry Data Cnt", "sasp.getwt-rep-grpwtentrydata.count",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"SASP Get Wt Rep Grp Wt Entry Data Cnt", HFILL } },\r\n#if 0\r\n{ &hf_sasp_setlbstate_rep,\r\n{ "Set Lbstate Rep", "sasp.msg.type",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\n"SASP Set Lbstate Rep", HFILL } },\r\n#endif\r\n{ &hf_sasp_setlbstate_rep_sz,\r\n{ "Set Lbstate Rep-Size", "sasp.setlbstate-rep.size",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"SASP Set Lbstate Rep Size", HFILL } },\r\n{ &hf_sasp_setlbstate_rep_rcode,\r\n{ "Set Lbstate Rep-Return Code", "sasp.setlbstate-rep.retcode",\r\nFT_UINT8, BASE_HEX, VALS(set_lb_state_reply_response_code), 0x0,\r\n"SASP Set Lbstate Rep Return Code", HFILL } },\r\n{ &hf_sasp_grpdatacomp,\r\n{ "Message Type", "sasp.msg.type",\r\nFT_UINT16, BASE_HEX|BASE_EXT_STRING, &msg_table_ext, 0x0,\r\n"SASP Grp Data Comp", HFILL } },\r\n{ &hf_sasp_grpdatacomp_sz,\r\n{ "Grp Data Comp-Size", "sasp.grpdatacomp.size",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"SASP Grp Data Comp size", HFILL } },\r\n{ &hf_sasp_grpdatacomp_LB_uid_len,\r\n{ "Grp Data Comp-Label UID Len", "sasp.grpdatacomp.label.uid.len",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"SASP Grp Data Comp Label Uid Len", HFILL } },\r\n{ &hf_sasp_grpdatacomp_LB_uid,\r\n{ "Grp Data Comp-Label UID", "sasp.grpdatacomp.label.uid",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\n"SASP Grp Data Comp Label Uid", HFILL } },\r\n{ &hf_sasp_grpdatacomp_grp_name_len,\r\n{ "Grp Data Comp-Grp Name Len", "sasp.grpdatacomp.grpname.len",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"SASP Grp Data Comp Grp Name Len", HFILL } },\r\n{ &hf_sasp_grpdatacomp_grp_name,\r\n{ "Grp Data Comp-Grp Name", "sasp.grpdatacomp.grpname",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\n"SASP Grp Data Comp Grp Name", HFILL } },\r\n{ &hf_sasp_grp_memdatacomp,\r\n{ "Message Type", "sasp.msg.type",\r\nFT_UINT16, BASE_HEX|BASE_EXT_STRING, &msg_table_ext, 0x0,\r\n"SASP Grp Mem Data Comp", HFILL } },\r\n{ &hf_sasp_grp_memdatacomp_sz,\r\n{ "Grp Mem Data Comp-Size", "sasp.grp-memdatacomp.size",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"SASP Grp Mem Data Comp Size", HFILL } },\r\n{ &hf_sasp_grp_memdatacomp_cnt,\r\n{ "Grp Mem Data Comp-Count", "sasp.grp.memdatacomp.count",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"SASP Grp Mem Data Comp Cnt", HFILL } },\r\n{ &hf_sasp_setlbstate_req_sz,\r\n{ "Set LB State Req-Size", "sasp.setlbstate-req.size",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"SASP Set LB State Req Size", HFILL } },\r\n{ &hf_sasp_setlbstate_req_LB_uid_len,\r\n{ "Set LB State Req-LB UID Len", "sasp.setlbstate-req.lbuid.len",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"SASP Set LB State Req LB Uid Len", HFILL } },\r\n{ &hf_sasp_setlbstate_req_LB_uid,\r\n{ "Set LB State Req-LB UID", "sasp.setlbstate-req.lbuid",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\n"SASP Set LB State Req LB UID", HFILL } },\r\n{ &hf_sasp_setlbstate_req_LB_health,\r\n{ "Set LB State Req-LB Health", "sasp.setlbstate-req.lbhealth",\r\nFT_UINT8, BASE_HEX, VALS(lbstate_healthtable), 0x0,\r\n"SASP Set LB State Req LB Health", HFILL } },\r\n#if 0\r\n{ &hf_lbstate_flag,\r\n{ "Flags", "sasp.flags.lbstate",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL } },\r\n#endif\r\n{ &hf_sasp_pushflag,\r\n{ "PUSH", "sasp.flags.push",\r\nFT_BOOLEAN, 8, NULL, SASP_PUSH_FLAG,\r\n"SASP Push Flag", HFILL } },\r\n{ &hf_sasp_trustflag,\r\n{ "TRUST", "sasp.flags.trust",\r\nFT_BOOLEAN, 8, NULL, SASP_TRUST_FLAG,\r\n"SASP Trust Flag", HFILL } },\r\n{ &hf_sasp_nochangeflag,\r\n{ "NOCHANGE", "sasp.flags.nochange",\r\nFT_BOOLEAN, 8, NULL, SASP_NOCHANGE_FLAG,\r\n"SASP Nochange Flag", HFILL } },\r\n{ &hf_sasp_grp_memstatedatacomp,\r\n{ "Message Type", "sasp.msg.type",\r\nFT_UINT16, BASE_HEX|BASE_EXT_STRING, &msg_table_ext, 0x0,\r\n"SASP Message Type", HFILL } },\r\n{ &hf_sasp_grp_memstatedatacomp_sz,\r\n{ "Grp Mem State-Size", "sasp.grp.memstate.size",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"SASP Grp Mem State Data Comp Size", HFILL } },\r\n{ &hf_sasp_grp_memstatedatacomp_cnt,\r\n{ "Grp Mem State-Count", "sasp.grp.memstate.count",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"SASP Grp Mem State Data Comp Count", HFILL } },\r\n{ &hf_sasp_memstatedatacomp_instance,\r\n{ "Message Type", "sasp.msg.type",\r\nFT_UINT16, BASE_HEX|BASE_EXT_STRING, &msg_table_ext, 0x0,\r\n"SASP Message Type", HFILL } },\r\n{ &hf_sasp_memstatedatacomp_sz,\r\n{ "Mem State-Size", "sasp.memstate.size",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"SASP Mem State Data Comp Size", HFILL } },\r\n{ &hf_sasp_memstatedatacomp_state,\r\n{ "Mem State-State", "sasp.memstate.state",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\n"SASP Mem State Data Comp State", HFILL } },\r\n{ &hf_sasp_memstatedatacomp_quiesce_flag,\r\n{ "Mem State-Quiesce Flag", "sasp.flags.quiesce",\r\nFT_BOOLEAN, 8, NULL, SASP_QUIESCE_FLAG,\r\n"SASP Quiesce Flag", HFILL } },\r\n{ &hf_sasp_weight_entry_data_comp_type,\r\n{ "Wt Entry Data Comp", "sasp.msg.type",\r\nFT_UINT16, BASE_HEX|BASE_EXT_STRING, &msg_table_ext, 0x0,\r\n"SASP Wt Entry Data Comp", HFILL } },\r\n{ &hf_sasp_weight_entry_data_comp_sz,\r\n{ "Wt Entry Data Comp-Size", "sasp.wtentry.size",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"SASP Wt Entry Data Comp Size", HFILL } },\r\n{ &hf_sasp_weight_entry_data_comp_state,\r\n{ "Wt Entry Data Comp-state", "sasp.wtentry.state",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\n"SASP Wt Entry Data Comp State", HFILL } },\r\n#if 0\r\n{ &hf_wtstate_flag,\r\n{ "Flags", "sasp.flags.wtstate",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL } },\r\n#endif\r\n{ &hf_sasp_wed_contactsuccess_flag,\r\n{ "Contact Success", "sasp.flags.contactsuccess",\r\nFT_BOOLEAN, 8, NULL, SASP_WED_CONTACT_SUCCESS_FLAG,\r\n"SASP Contact Success Flag", HFILL } },\r\n{ &hf_sasp_wed_quiesce_flag,\r\n{ "Quiesce", "sasp.flags.quiesce",\r\nFT_BOOLEAN, 8, NULL, SASP_WED_QUIESCE_FLAG,\r\n"SASP Quiesce Flag", HFILL } },\r\n{ &hf_sasp_wed_registration_flag,\r\n{ "Registration", "sasp.flags.registration",\r\nFT_BOOLEAN, 8, NULL, SASP_WED_REG_FLAG,\r\n"SASP Registration Flag", HFILL } },\r\n{ &hf_sasp_wed_confident_flag,\r\n{ "Confident", "sasp.flags.confident",\r\nFT_BOOLEAN, 8, NULL, SASP_WED_CONF_FLAG,\r\n"SASP Confident Flag", HFILL } },\r\n{ &hf_sasp_weight_entry_data_comp_weight,\r\n{ "Wt Entry Data Comp-weight", "sasp.wtentrydatacomp.weight",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"SASP Wt Entry Data Comp weight", HFILL } },\r\n{ &hf_sasp_grp_wt_entry_datacomp_type,\r\n{ "Grp Wt Entry Data Comp", "sasp.msg.type",\r\nFT_UINT16, BASE_HEX|BASE_EXT_STRING, &msg_table_ext, 0x0,\r\n"SASP Grp Wt Entry Data Comp", HFILL } },\r\n{ &hf_sasp_grp_wt_entry_datacomp_sz,\r\n{ "Grp Wt Entry Data Comp Size", "sasp.grp-wtentrydata.size",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"SASP Grp Wt Entry Data Comp Size", HFILL } },\r\n{ &hf_sasp_grp_wt_entry_datacomp_cnt,\r\n{ "Grp Wt Entry Data Comp Cnt", "sasp.grp-wtentrydata.count",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"SASP Grp Wt Entry Data Comp Cnt", HFILL } }\r\n};\r\nstatic gint *ett[] = {\r\n&ett_sasp_data,\r\n&ett_sasp_header,\r\n&ett_sasp_msg,\r\n&ett_sasp_payload,\r\n&ett_sasp_reg_req,\r\n&ett_sasp_reg_rep,\r\n&ett_sasp_reg_req_sz,\r\n&ett_sasp_dereg_req_sz,\r\n&ett_sasp_dereg_rep,\r\n&ett_sasp_sendwt,\r\n&ett_sasp_setmemstate_req,\r\n&ett_sasp_setmemstate_rep,\r\n&ett_sasp_memdatacomp,\r\n&ett_sasp_grpdatacomp,\r\n&ett_sasp_grp_memdatacomp,\r\n&ett_sasp_setlbstate_req,\r\n&ett_sasp_setlbstate_rep,\r\n&ett_sasp_getwt,\r\n&ett_setlbstate_req_lbflag,\r\n&ett_sasp_grp_memstatedatacomp,\r\n&ett_sasp_memstatedatacomp,\r\n&ett_sasp_grp_wt_entry_datacomp,\r\n&ett_sasp_weight_entry_data_comp,\r\n&ett_wt_entry_data_flag,\r\n&ett_sasp_wt_rep\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_msg_type_invalid, { "sasp.msg.type.invalid", PI_PROTOCOL, PI_WARN, "Invalid Type", EXPFILL }}\r\n};\r\nmodule_t *sasp_module;\r\nexpert_module_t* expert_sasp;\r\nproto_sasp = proto_register_protocol("Server/Application State Protocol", "SASP", "sasp");\r\nproto_register_field_array(proto_sasp, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_sasp = expert_register_protocol(proto_sasp);\r\nexpert_register_field_array(expert_sasp, ei, array_length(ei));\r\nsasp_module = prefs_register_protocol(proto_sasp, NULL);\r\nprefs_register_bool_preference(sasp_module, "desegment_sasp_messages",\r\n"Reassemble SASP messages spanning multiple TCP segments",\r\n"Whether the SASP dissector should reassemble messages"\r\n" spanning multiple TCP segments."\r\n" To use this option, you must also enable"\r\n" \"Allow subdissectors to reassemble TCP streams\""\r\n" in the TCP protocol settings.",\r\n&sasp_desegment);\r\n}\r\nvoid\r\nproto_reg_handoff_sasp(void)\r\n{\r\ndissector_handle_t sasp_handle;\r\nsasp_handle = create_dissector_handle(dissect_sasp, proto_sasp);\r\ndissector_add_uint("tcp.port", SASP_GLOBAL_PORT, sasp_handle);\r\n}
