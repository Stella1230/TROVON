static int dissect_mac_lte_framed(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data _U_)\r\n{\r\ngint offset = 0;\r\nstruct mac_lte_info *p_mac_lte_info;\r\ntvbuff_t *mac_tvb;\r\ngboolean infoAlreadySet = FALSE;\r\ndissector_handle_t mac_lte_handle = find_dissector("mac-lte");\r\nif (!mac_lte_handle) {\r\nreturn 0;\r\n}\r\nif ((size_t)tvb_reported_length_remaining(tvb, offset) < (3+2)) {\r\nreturn 5;\r\n}\r\np_mac_lte_info = (struct mac_lte_info*)p_get_proto_data(wmem_file_scope(), pinfo, proto_mac_lte, 0);\r\nif (p_mac_lte_info == NULL) {\r\np_mac_lte_info = (struct mac_lte_info*)wmem_alloc0(wmem_file_scope(), sizeof(struct mac_lte_info));\r\ninfoAlreadySet = FALSE;\r\n}\r\nelse {\r\ninfoAlreadySet = TRUE;\r\n}\r\nif (!dissect_mac_lte_context_fields(p_mac_lte_info, tvb, &offset)) {\r\nreturn offset;\r\n}\r\nif (!infoAlreadySet) {\r\np_add_proto_data(wmem_file_scope(), pinfo, proto_mac_lte, 0, p_mac_lte_info);\r\n}\r\nmac_tvb = tvb_new_subset_remaining(tvb, offset);\r\ncall_dissector_only(mac_lte_handle, mac_tvb, pinfo, tree, NULL);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid proto_register_mac_lte_framed(void)\r\n{\r\nproto_mac_lte_framed = proto_register_protocol("mac-lte-framed", "MAC-LTE-FRAMED", "mac-lte-framed");\r\nregister_dissector("mac-lte-framed", dissect_mac_lte_framed, proto_mac_lte_framed);\r\n}
