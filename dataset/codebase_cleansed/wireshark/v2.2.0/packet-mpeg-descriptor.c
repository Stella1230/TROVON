static void\r\nproto_mpeg_descriptor_dissect_video_stream(tvbuff_t *tvb, guint offset, proto_tree *tree)\r\n{\r\nguint8 mpeg1_only_flag;\r\nmpeg1_only_flag = tvb_get_guint8(tvb, offset) & MPEG_DESCR_VIDEO_STREAM_MPEG1_ONLY_FLAG_MASK;\r\nproto_tree_add_item(tree, hf_mpeg_descr_video_stream_multiple_frame_rate_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_video_stream_frame_rate_code, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_video_stream_mpeg1_only_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_video_stream_constrained_parameter_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_video_stream_still_picture_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nif (mpeg1_only_flag == 0) {\r\nproto_tree_add_item(tree, hf_mpeg_descr_video_stream_profile_and_level_indication, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_mpeg_descr_video_stream_chroma_format, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_video_stream_frame_rate_extension_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_video_stream_reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_audio_stream(tvbuff_t *tvb, guint offset, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_mpeg_descr_audio_stream_free_format_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_audio_stream_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_audio_stream_layer, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_audio_stream_variable_rate_audio_indicator, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_audio_stream_reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_registration(tvbuff_t *tvb, guint offset, guint len, proto_tree *tree)\r\n{\r\nguint offset_start;\r\noffset_start = offset;\r\nproto_tree_add_item(tree, hf_mpeg_descr_reg_form_id, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nwhile (offset-offset_start<len) {\r\nproto_tree_add_item(tree, hf_mpeg_descr_reg_add_id_inf, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\n}\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_data_stream_alignment(tvbuff_t *tvb, guint offset, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_mpeg_descr_data_stream_alignment, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_ca(tvbuff_t *tvb, guint offset, guint len, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_mpeg_descr_ca_system_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_mpeg_descr_ca_reserved, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_ca_pid, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nif (len > 4)\r\nproto_tree_add_item(tree, hf_mpeg_descr_ca_private, tvb, offset, len - 4, ENC_NA);\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_iso639(tvbuff_t *tvb, guint offset, guint len, proto_tree *tree)\r\n{\r\nif (len > 1)\r\nproto_tree_add_item(tree, hf_mpeg_descr_iso639_lang, tvb, offset, len - 1, ENC_ASCII|ENC_NA);\r\noffset += len - 1;\r\nproto_tree_add_item(tree, hf_mpeg_descr_iso639_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_system_clock(tvbuff_t *tvb, guint offset, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_mpeg_descr_system_clock_external_clock_reference_indicator, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_system_clock_reserved1, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_system_clock_accuracy_integer, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_mpeg_descr_system_clock_accuracy_exponent, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_system_clock_reserved2, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_max_bitrate(tvbuff_t *tvb, guint offset, proto_tree *tree)\r\n{\r\nproto_item *rate_item;\r\nguint32 rate;\r\nproto_tree_add_item(tree, hf_mpeg_descr_max_bitrate_reserved, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nrate = tvb_get_ntoh24(tvb, offset) & MPEG_DESCR_MAX_BITRATE_MASK;\r\nrate_item = proto_tree_add_item(tree, hf_mpeg_descr_max_bitrate, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nproto_item_append_text(rate_item, " (%u bytes/sec)", rate * 50);\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_smoothing_buffer(tvbuff_t *tvb, guint offset, proto_tree *tree)\r\n{\r\nproto_item *leak_rate_item;\r\nguint32 leak_rate;\r\nproto_tree_add_item(tree, hf_mpeg_descr_smoothing_buffer_reserved1, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nleak_rate = tvb_get_ntoh24(tvb, offset) & MPEG_DESCR_SMOOTHING_BUFFER_LEAK_RATE_MASK;\r\nleak_rate_item = proto_tree_add_item(tree, hf_mpeg_descr_smoothing_buffer_leak_rate, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nproto_item_append_text(leak_rate_item, " (%u bytes/sec)", leak_rate * 400 / 8);\r\noffset += 3;\r\nproto_tree_add_item(tree, hf_mpeg_descr_smoothing_buffer_reserved2, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_smoothing_buffer_size, tvb, offset, 3, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_std(tvbuff_t *tvb, guint offset, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_mpeg_descr_std_reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_std_leak_valid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_carousel_identifier(tvbuff_t *tvb, guint offset, guint len, proto_tree *tree)\r\n{\r\nguint key_len;\r\nguint8 format_id;\r\nguint private_len = 0;\r\nproto_tree_add_item(tree, hf_mpeg_descr_carousel_identifier_id, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nformat_id = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_mpeg_descr_carousel_identifier_format_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nif (format_id == 0x01) {\r\nproto_tree_add_item(tree, hf_mpeg_descr_carousel_identifier_module_version, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_mpeg_descr_carousel_identifier_module_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_mpeg_descr_carousel_identifier_block_size, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_mpeg_descr_carousel_identifier_module_size, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_mpeg_descr_carousel_identifier_compression_method, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_mpeg_descr_carousel_identifier_original_size, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_mpeg_descr_carousel_identifier_timeout, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nkey_len = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_mpeg_descr_carousel_identifier_object_key_len, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_mpeg_descr_carousel_identifier_object_key_data, tvb, offset, key_len, ENC_NA);\r\noffset += key_len;\r\nif (len > (key_len + 20))\r\nprivate_len = len - 20 - key_len;\r\n} else {\r\nif (len > 5)\r\nprivate_len = len - 5;\r\n}\r\nif (private_len)\r\nproto_tree_add_item(tree, hf_mpeg_descr_carousel_identifier_private, tvb, offset, private_len, ENC_NA);\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_association_tag(tvbuff_t *tvb, guint offset, guint len, proto_tree *tree)\r\n{\r\nguint end = offset + len;\r\nguint16 use;\r\nguint8 selector_len;\r\nproto_tree_add_item(tree, hf_mpeg_descr_association_tag, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nuse = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_item(tree, hf_mpeg_descr_association_tag_use, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nselector_len = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_mpeg_descr_association_tag_selector_len, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset ++;\r\nif (use == 0x00) {\r\nif (selector_len != 8)\r\nreturn;\r\nproto_tree_add_item(tree, hf_mpeg_descr_association_tag_transaction_id, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_mpeg_descr_association_tag_timeout, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\n} else {\r\nproto_tree_add_item(tree, hf_mpeg_descr_association_tag_selector_bytes, tvb, offset, selector_len, ENC_NA);\r\noffset += selector_len;\r\n}\r\nif (offset < end)\r\nproto_tree_add_item(tree, hf_mpeg_descr_association_tag_private_bytes, tvb, offset, end - offset, ENC_NA);\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_avc_vid(tvbuff_t *tvb, guint offset, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_mpeg_descr_avc_vid_profile_idc, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_mpeg_descr_avc_vid_constraint_set0_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_avc_vid_constraint_set1_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_avc_vid_constraint_set2_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_avc_vid_compatible_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_mpeg_descr_avc_vid_level_idc, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_mpeg_descr_avc_vid_still_present, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_avc_vid_24h_picture_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_avc_vid_reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_network_name(tvbuff_t *tvb, guint offset, guint len, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_mpeg_descr_network_name_descriptor, tvb, offset, len, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_service_list(tvbuff_t *tvb, guint offset, guint len, proto_tree *tree)\r\n{\r\nguint end = offset + len;\r\nguint16 svc_id;\r\nproto_tree *svc_tree;\r\nwhile (offset < end) {\r\nsvc_id = tvb_get_ntohs(tvb, offset);\r\nsvc_tree = proto_tree_add_subtree_format(tree, tvb, offset, 3,\r\nett_mpeg_descriptor_service_list, NULL, "Service 0x%02x", svc_id);\r\nproto_tree_add_item(svc_tree, hf_mpeg_descr_service_list_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(svc_tree, hf_mpeg_descr_service_list_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_stuffing(tvbuff_t *tvb, guint offset, guint len, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_mpeg_descr_stuffing, tvb, offset, len, ENC_NA);\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_satellite_delivery(tvbuff_t *tvb, guint offset, proto_tree *tree)\r\n{\r\ndouble frequency, symbol_rate;\r\nfloat orbital_position;\r\nguint8 modulation_system;\r\nfrequency = MPEG_SECT_BCD44_TO_DEC(tvb_get_guint8(tvb, offset)) * 10.0 +\r\nMPEG_SECT_BCD44_TO_DEC(tvb_get_guint8(tvb, offset+1)) / 10.0 +\r\nMPEG_SECT_BCD44_TO_DEC(tvb_get_guint8(tvb, offset+2)) / 1000.0 +\r\nMPEG_SECT_BCD44_TO_DEC(tvb_get_guint8(tvb, offset+3)) / 100000.0;\r\nproto_tree_add_double_format_value(tree, hf_mpeg_descr_satellite_delivery_frequency,\r\ntvb, offset, 4, frequency, "%f GHz", frequency);\r\noffset += 4;\r\norbital_position = MPEG_SECT_BCD44_TO_DEC(tvb_get_guint8(tvb, offset)) * 10.0f +\r\nMPEG_SECT_BCD44_TO_DEC(tvb_get_guint8(tvb, offset+1)) / 10.0f;\r\nproto_tree_add_float_format_value(tree, hf_mpeg_descr_satellite_delivery_orbital_position,\r\ntvb, offset, 2, orbital_position, "%f degrees", orbital_position);\r\noffset += 2;\r\nmodulation_system = tvb_get_guint8(tvb, offset) & MPEG_DESCR_SATELLITE_DELIVERY_MODULATION_SYSTEM_MASK;\r\nproto_tree_add_item(tree, hf_mpeg_descr_satellite_delivery_west_east_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_satellite_delivery_polarization, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nif (modulation_system)\r\nproto_tree_add_item(tree, hf_mpeg_descr_satellite_delivery_roll_off, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nelse\r\nproto_tree_add_item(tree, hf_mpeg_descr_satellite_delivery_zero, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_satellite_delivery_modulation_system, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_satellite_delivery_modulation_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nsymbol_rate = MPEG_SECT_BCD44_TO_DEC(tvb_get_guint8(tvb, offset)) * 10.0 +\r\nMPEG_SECT_BCD44_TO_DEC(tvb_get_guint8(tvb, offset+1)) / 10.0 +\r\nMPEG_SECT_BCD44_TO_DEC(tvb_get_guint8(tvb, offset+2)) / 1000.0 +\r\nMPEG_SECT_BCD44_TO_DEC(tvb_get_guint8(tvb, offset+3)>>4) / 10000.0;\r\nproto_tree_add_double_format_value(tree, hf_mpeg_descr_satellite_delivery_symbol_rate,\r\ntvb, offset, 4, symbol_rate, "%3.4f MSym/s", symbol_rate);\r\noffset += 3;\r\nproto_tree_add_item(tree, hf_mpeg_descr_satellite_delivery_fec_inner, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_cable_delivery(tvbuff_t *tvb, guint offset, proto_tree *tree) {\r\ndouble frequency, symbol_rate;\r\nfrequency = MPEG_SECT_BCD44_TO_DEC(tvb_get_guint8(tvb, offset)) * 100.0 +\r\nMPEG_SECT_BCD44_TO_DEC(tvb_get_guint8(tvb, offset+1)) +\r\nMPEG_SECT_BCD44_TO_DEC(tvb_get_guint8(tvb, offset+2)) / 100.0 +\r\nMPEG_SECT_BCD44_TO_DEC(tvb_get_guint8(tvb, offset+3)) / 10000.0;\r\nproto_tree_add_double_format_value(tree, hf_mpeg_descr_cable_delivery_frequency,\r\ntvb, offset, 4, frequency, "%4.4f MHz", frequency);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_mpeg_descr_cable_delivery_reserved, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_cable_delivery_fec_outer, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_mpeg_descr_cable_delivery_modulation, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nsymbol_rate = MPEG_SECT_BCD44_TO_DEC(tvb_get_guint8(tvb, offset)) * 10.0 +\r\nMPEG_SECT_BCD44_TO_DEC(tvb_get_guint8(tvb, offset+1)) / 10.0 +\r\nMPEG_SECT_BCD44_TO_DEC(tvb_get_guint8(tvb, offset+2)) / 1000.0 +\r\nMPEG_SECT_BCD44_TO_DEC(tvb_get_guint8(tvb, offset+3)>>4) / 10000.0;\r\nproto_tree_add_double_format_value(tree, hf_mpeg_descr_cable_delivery_symbol_rate,\r\ntvb, offset, 4, symbol_rate, "%3.4f MSymbol/s", symbol_rate);\r\noffset += 3;\r\nproto_tree_add_item(tree, hf_mpeg_descr_cable_delivery_fec_inner, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_vbi_data(tvbuff_t *tvb, guint offset, guint len, proto_tree *tree)\r\n{\r\nguint8 svc_id, svc_len;\r\nguint end = offset + len, svc_end;\r\nproto_tree *svc_tree;\r\nwhile (offset < end) {\r\nsvc_id = tvb_get_guint8(tvb, offset);\r\nsvc_len = tvb_get_guint8(tvb, offset + 1);\r\nsvc_tree = proto_tree_add_subtree_format(tree, tvb, offset, svc_len + 2,\r\nett_mpeg_descriptor_vbi_data_service, NULL, "Service 0x%02x", svc_id);\r\nproto_tree_add_item(svc_tree, hf_mpeg_descr_vbi_data_service_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(svc_tree, hf_mpeg_descr_vbi_data_descr_len, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nswitch (svc_id) {\r\ncase 0x01:\r\ncase 0x02:\r\ncase 0x04:\r\ncase 0x05:\r\ncase 0x06:\r\ncase 0x07:\r\nsvc_end = offset + svc_len;\r\nwhile (offset < svc_end) {\r\nproto_tree_add_item(svc_tree, hf_mpeg_descr_vbi_data_reserved1, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(svc_tree, hf_mpeg_descr_vbi_data_field_parity, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(svc_tree, hf_mpeg_descr_vbi_data_line_offset, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(svc_tree, hf_mpeg_descr_vbi_data_reserved2, tvb, offset, svc_len, ENC_NA);\r\noffset += svc_len;\r\nbreak;\r\n}\r\n}\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_bouquet_name(tvbuff_t *tvb, guint offset, guint len, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_mpeg_descr_bouquet_name, tvb, offset, len, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_service(tvbuff_t *tvb, guint offset, proto_tree *tree)\r\n{\r\nguint8 prov_len, name_len;\r\nguint enc_len;\r\ndvb_encoding_e encoding;\r\nproto_tree_add_item(tree, hf_mpeg_descr_service_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nprov_len = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_mpeg_descr_service_provider_name_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nif (prov_len>0) {\r\nenc_len = dvb_analyze_string_charset(tvb, offset, prov_len, &encoding);\r\ndvb_add_chartbl(tree, hf_mpeg_descr_service_provider_name_encoding, tvb, offset, enc_len, encoding);\r\nproto_tree_add_item(tree, hf_mpeg_descr_service_provider,\r\ntvb, offset+enc_len, prov_len-enc_len, dvb_enc_to_item_enc(encoding));\r\n}\r\noffset += prov_len;\r\nname_len = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_mpeg_descr_service_name_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nif (name_len>0) {\r\nenc_len = dvb_analyze_string_charset(tvb, offset, name_len, &encoding);\r\ndvb_add_chartbl(tree, hf_mpeg_descr_service_name_encoding, tvb, offset, enc_len, encoding);\r\nproto_tree_add_item(tree, hf_mpeg_descr_service_name,\r\ntvb, offset+enc_len, name_len-enc_len, dvb_enc_to_item_enc(encoding));\r\n}\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_linkage(tvbuff_t *tvb, guint offset, guint len, proto_tree *tree)\r\n{\r\nguint8 linkage_type, hand_over_type, origin_type;\r\nguint end = offset + len;\r\nguint population_id_loop_count;\r\nguint16 population_id_base, population_id_mask;\r\nproto_item *pi;\r\nproto_tree *population_tree;\r\nproto_tree_add_item(tree, hf_mpeg_descr_linkage_transport_stream_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_mpeg_descr_linkage_original_network_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_mpeg_descr_linkage_service_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_mpeg_descr_linkage_linkage_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nlinkage_type = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nif (linkage_type == 0x08) {\r\nproto_tree_add_item(tree, hf_mpeg_descr_linkage_hand_over_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_linkage_reserved1, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_linkage_origin_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nhand_over_type = (tvb_get_guint8(tvb, offset) & MPEG_DESCR_LINKAGE_HAND_OVER_TYPE_MASK) >> MPEG_DESCR_LINKAGE_HAND_OVER_TYPE_SHIFT;\r\norigin_type = tvb_get_guint8(tvb, offset) & MPEG_DESCR_LINKAGE_ORIGIN_TYPE_MASK;\r\noffset += 1;\r\nif ((hand_over_type == 1) || (hand_over_type == 2) || (hand_over_type == 3)) {\r\nproto_tree_add_item(tree, hf_mpeg_descr_linkage_network_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\nif (origin_type) {\r\nproto_tree_add_item(tree, hf_mpeg_descr_linkage_initial_service_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\n} else if (linkage_type == 0x0D) {\r\nproto_tree_add_item(tree, hf_mpeg_descr_linkage_target_event_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_mpeg_descr_linkage_target_listed, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_linkage_event_simulcast, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_linkage_reserved2, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n} else if (linkage_type == 0x81) {\r\nif (offset+7>end)\r\nreturn;\r\nproto_tree_add_item(tree, hf_mpeg_descr_linkage_interactive_network_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\npopulation_id_loop_count = tvb_get_guint8(tvb, offset) + 1;\r\nproto_tree_add_item(tree, hf_mpeg_descr_linkage_population_id_loop_count, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nwhile (population_id_loop_count--) {\r\npopulation_id_base = tvb_get_ntohs(tvb, offset);\r\npopulation_id_mask = tvb_get_ntohs(tvb, offset + 2);\r\npi = proto_tree_add_uint_format_value(tree, hf_mpeg_descr_linkage_population_id, tvb, offset, 4,\r\npopulation_id_base<<16|population_id_mask,\r\n"0x%04x / 0x%04x", population_id_base, population_id_mask);\r\npopulation_tree = proto_item_add_subtree(pi, ett_mpeg_descriptor_linkage_population_id);\r\nproto_tree_add_item(population_tree, hf_mpeg_descr_linkage_population_id_base, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(population_tree, hf_mpeg_descr_linkage_population_id_mask, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\n}\r\nif (end - offset > 0)\r\nproto_tree_add_item(tree, hf_mpeg_descr_linkage_private_data_byte, tvb, offset, end - offset, ENC_NA);\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_short_event(tvbuff_t *tvb, guint offset, proto_tree *tree)\r\n{\r\nguint8 name_len, text_len;\r\nguint enc_len;\r\ndvb_encoding_e encoding;\r\nproto_tree_add_item(tree, hf_mpeg_descr_short_event_lang_code, tvb, offset, 3, ENC_ASCII|ENC_NA);\r\noffset += 3;\r\nname_len = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_mpeg_descr_short_event_name_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nif (name_len>0) {\r\nenc_len = dvb_analyze_string_charset(tvb, offset, name_len, &encoding);\r\ndvb_add_chartbl(tree, hf_mpeg_descr_short_event_name_encoding, tvb, offset, enc_len, encoding);\r\nproto_tree_add_item(tree, hf_mpeg_descr_short_event_name,\r\ntvb, offset+enc_len, name_len-enc_len, dvb_enc_to_item_enc(encoding));\r\n}\r\noffset += name_len;\r\ntext_len = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_mpeg_descr_short_event_text_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nif (text_len>0) {\r\nenc_len = dvb_analyze_string_charset(tvb, offset, text_len, &encoding);\r\ndvb_add_chartbl(tree, hf_mpeg_descr_short_event_text_encoding, tvb, offset, enc_len, encoding);\r\nproto_tree_add_item(tree, hf_mpeg_descr_short_event_text,\r\ntvb, offset+enc_len, text_len-enc_len, dvb_enc_to_item_enc(encoding));\r\n}\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_extended_event(tvbuff_t *tvb, guint offset, proto_tree *tree)\r\n{\r\nguint8 items_len, item_descr_len, item_len, text_len;\r\nguint items_end;\r\nproto_tree *item_tree;\r\nguint enc_len;\r\ndvb_encoding_e encoding;\r\nproto_tree_add_item(tree, hf_mpeg_descr_extended_event_descriptor_number, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_extended_event_last_descriptor_number, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_mpeg_descr_extended_event_lang_code, tvb, offset, 3, ENC_ASCII|ENC_NA);\r\noffset += 3;\r\nitems_len = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_mpeg_descr_extended_event_length_of_items, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nitems_end = offset + items_len;\r\nwhile (offset < items_end) {\r\nitem_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_mpeg_descriptor_extended_event_item, NULL, "Item");\r\nitem_descr_len = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(item_tree, hf_mpeg_descr_extended_event_item_description_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(item_tree, hf_mpeg_descr_extended_event_item_description_char, tvb, offset, item_descr_len, ENC_ASCII|ENC_NA);\r\noffset += item_descr_len;\r\nitem_len = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(item_tree, hf_mpeg_descr_extended_event_item_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(item_tree, hf_mpeg_descr_extended_event_item_char, tvb, offset, item_len, ENC_ASCII|ENC_NA);\r\noffset += item_len;\r\n}\r\ntext_len = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_mpeg_descr_extended_event_text_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nif (text_len>0) {\r\nenc_len = dvb_analyze_string_charset(tvb, offset, text_len, &encoding);\r\ndvb_add_chartbl(tree, hf_mpeg_descr_extended_event_text_encoding, tvb, offset, enc_len, encoding);\r\nproto_tree_add_item(tree, hf_mpeg_descr_extended_event_text,\r\ntvb, offset+enc_len, text_len-enc_len, dvb_enc_to_item_enc(encoding));\r\n}\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_component(tvbuff_t *tvb, guint offset, guint len, proto_tree *tree)\r\n{\r\nproto_item *cti;\r\nproto_tree *content_type_tree;\r\nproto_tree_add_item(tree, hf_mpeg_descr_component_reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ncti = proto_tree_add_item(tree, hf_mpeg_descr_component_content_type, tvb, offset, 2, ENC_BIG_ENDIAN);\r\ncontent_type_tree = proto_item_add_subtree(cti, ett_mpeg_descriptor_component_content_type);\r\nproto_tree_add_item(content_type_tree, hf_mpeg_descr_component_stream_content, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(content_type_tree, hf_mpeg_descr_component_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_mpeg_descr_component_tag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_mpeg_descr_component_lang_code, tvb, offset, 3, ENC_ASCII|ENC_NA);\r\noffset += 3;\r\nif (offset < len)\r\nproto_tree_add_item(tree, hf_mpeg_descr_component_text, tvb, offset, len - offset, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_stream_identifier(tvbuff_t *tvb, guint offset, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_mpeg_descr_stream_identifier_component_tag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_ca_identifier(tvbuff_t *tvb, guint offset, guint len, proto_tree *tree)\r\n{\r\nguint end = offset + len;\r\nwhile (offset < end) {\r\nproto_tree_add_item(tree, hf_mpeg_descr_ca_identifier_system_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_content(tvbuff_t *tvb, guint offset, guint len, proto_tree *tree)\r\n{\r\nproto_item *ni;\r\nproto_tree *nibble_tree;\r\nguint end = offset + len;\r\nwhile (offset < end) {\r\nni = proto_tree_add_item(tree, hf_mpeg_descr_content_nibble, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nnibble_tree = proto_item_add_subtree(ni, ett_mpeg_descriptor_content_nibble);\r\nproto_tree_add_item(nibble_tree, hf_mpeg_descr_content_nibble_level_1, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(nibble_tree, hf_mpeg_descr_content_nibble_level_2, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_mpeg_descr_content_user_byte, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_parental_rating(tvbuff_t *tvb, guint offset, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_mpeg_descr_parental_rating_country_code, tvb, offset, 3, ENC_ASCII|ENC_NA);\r\noffset += 3;\r\nproto_tree_add_item(tree, hf_mpeg_descr_parental_rating_rating, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_teletext(tvbuff_t *tvb, guint offset, guint len, proto_tree *tree)\r\n{\r\nguint end = offset + len;\r\nwhile (offset < end) {\r\nproto_tree_add_item(tree, hf_mpeg_descr_teletext_lang_code, tvb, offset, 3, ENC_ASCII|ENC_NA);\r\noffset += 3;\r\nproto_tree_add_item(tree, hf_mpeg_descr_teletext_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_teletext_magazine_number, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_mpeg_descr_teletext_page_number, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_local_time_offset(tvbuff_t *tvb, guint offset, guint len, proto_tree *tree)\r\n{\r\nguint end = offset + len;\r\nguint8 hour, min;\r\nnstime_t local_time_offset, time_of_change, next_time_offset;\r\nwhile (offset < end) {\r\nproto_tree_add_item(tree, hf_mpeg_descr_local_time_offset_country_code, tvb, offset, 3, ENC_ASCII|ENC_NA);\r\noffset += 3;\r\nproto_tree_add_item(tree, hf_mpeg_descr_local_time_offset_region_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_local_time_offset_reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_local_time_offset_polarity, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nhour = MPEG_SECT_BCD44_TO_DEC(tvb_get_guint8(tvb, offset));\r\nmin = MPEG_SECT_BCD44_TO_DEC(tvb_get_guint8(tvb, offset+1));\r\nnstime_set_zero(&local_time_offset);\r\nlocal_time_offset.secs = hour*60*60 + min*60;\r\nproto_tree_add_time_format_value(tree, hf_mpeg_descr_local_time_offset_offset,\r\ntvb, offset, 2, &local_time_offset, "%02d:%02d", hour, min);\r\noffset += 2;\r\nif (packet_mpeg_sect_mjd_to_utc_time(tvb, offset, &time_of_change) < 0) {\r\nproto_tree_add_time_format_value(tree, hf_mpeg_descr_local_time_offset_time_of_change, tvb, offset, 5, &time_of_change, "Unparseable time");\r\n} else {\r\nproto_tree_add_time(tree, hf_mpeg_descr_local_time_offset_time_of_change, tvb, offset, 5, &time_of_change);\r\n}\r\noffset += 5;\r\nhour = MPEG_SECT_BCD44_TO_DEC(tvb_get_guint8(tvb, offset));\r\nmin = MPEG_SECT_BCD44_TO_DEC(tvb_get_guint8(tvb, offset+1));\r\nnstime_set_zero(&next_time_offset);\r\nnext_time_offset.secs = hour*60*60 + min*60;\r\nproto_tree_add_time_format_value(tree, hf_mpeg_descr_local_time_offset_next_time_offset,\r\ntvb, offset, 2, &next_time_offset, "%02d:%02d", hour, min);\r\noffset += 2;\r\n}\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_subtitling(tvbuff_t *tvb, guint offset, guint len, proto_tree *tree)\r\n{\r\nguint end = offset + len;\r\nwhile (offset < end) {\r\nproto_tree_add_item(tree, hf_mpeg_descr_subtitling_lang_code, tvb, offset, 3, ENC_ASCII|ENC_NA);\r\noffset += 3;\r\nproto_tree_add_item(tree, hf_mpeg_descr_subtitling_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_mpeg_descr_subtitling_composition_page_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_mpeg_descr_subtitling_ancillary_page_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_terrestrial_delivery(tvbuff_t *tvb, guint offset, proto_tree *tree)\r\n{\r\nguint64 centre_freq;\r\ncentre_freq = tvb_get_ntohl(tvb, offset) * 10;\r\nproto_tree_add_uint64_format_value(tree, hf_mpeg_descr_terrestrial_delivery_centre_frequency, tvb, offset, 4,\r\ncentre_freq, "%d.%06d MHz", (guint)centre_freq/(1000*1000), (guint)centre_freq%(1000*1000));\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_mpeg_descr_terrestrial_delivery_bandwidth, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_terrestrial_delivery_priority, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_terrestrial_delivery_time_slicing_indicator, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_terrestrial_delivery_mpe_fec_indicator, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_terrestrial_delivery_reserved1, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_mpeg_descr_terrestrial_delivery_constellation, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_terrestrial_delivery_hierarchy_information, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_terrestrial_delivery_code_rate_hp_stream, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_mpeg_descr_terrestrial_delivery_code_rate_lp_stream, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_terrestrial_delivery_guard_interval, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_terrestrial_delivery_transmission_mode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_terrestrial_delivery_other_frequency_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_mpeg_descr_terrestrial_delivery_reserved2, tvb, offset, 4, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_private_data_specifier(tvbuff_t *tvb, guint offset, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_mpeg_descr_private_data_specifier_id, tvb, offset, 4, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_data_bcast(tvbuff_t *tvb, guint offset, proto_tree *tree)\r\n{\r\nguint8 selector_len, text_len;\r\nproto_tree_add_item(tree, hf_mpeg_descr_data_bcast_bcast_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_mpeg_descr_data_bcast_component_tag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nselector_len = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_mpeg_descr_data_bcast_selector_len, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nif (selector_len > 0) {\r\nproto_tree_add_item(tree, hf_mpeg_descr_data_bcast_selector_bytes, tvb, offset, selector_len, ENC_NA);\r\noffset += selector_len;\r\n}\r\nproto_tree_add_item(tree, hf_mpeg_descr_data_bcast_lang_code, tvb, offset, 3, ENC_ASCII|ENC_NA);\r\noffset += 3;\r\ntext_len = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_mpeg_descr_data_bcast_text_len, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nif (text_len > 0)\r\nproto_tree_add_item(tree, hf_mpeg_descr_data_bcast_text, tvb, offset, text_len, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_data_bcast_id(tvbuff_t *tvb, guint offset, guint len, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_mpeg_descr_data_bcast_id_bcast_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nif (len > 2)\r\nproto_tree_add_item(tree, hf_mpeg_descr_data_bcast_id_id_selector_bytes, tvb, offset, len - 2, ENC_NA);\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_ac3(tvbuff_t *tvb, guint offset, guint len, proto_tree *tree)\r\n{\r\nguint end = offset + len;\r\nguint8 flags, component_type;\r\nproto_tree *component_type_tree;\r\nflags = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_mpeg_descr_ac3_component_type_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_ac3_bsid_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_ac3_mainid_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_ac3_asvc_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_ac3_reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nif (flags & MPEG_DESCR_AC3_COMPONENT_TYPE_FLAG_MASK) {\r\ncomponent_type = tvb_get_guint8(tvb, offset);\r\ncomponent_type_tree = proto_tree_add_subtree_format(tree, tvb, offset, 3,\r\nett_mpeg_descriptor_ac3_component_type, NULL, "Component Type 0x%02x", component_type);\r\nproto_tree_add_item(component_type_tree, hf_mpeg_descr_ac3_component_type_reserved_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(component_type_tree, hf_mpeg_descr_ac3_component_type_full_service_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(component_type_tree, hf_mpeg_descr_ac3_component_type_service_type_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(component_type_tree, hf_mpeg_descr_ac3_component_type_number_of_channels_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\nif (flags & MPEG_DESCR_AC3_BSID_FLAG_MASK) {\r\nproto_tree_add_item(tree, hf_mpeg_descr_ac3_bsid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\nif (flags & MPEG_DESCR_AC3_MAINID_FLAG_MASK) {\r\nproto_tree_add_item(tree, hf_mpeg_descr_ac3_mainid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\nif (flags & MPEG_DESCR_AC3_ASVC_FLAG_MASK) {\r\nproto_tree_add_item(tree, hf_mpeg_descr_ac3_asvc, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\nif (offset < end)\r\nproto_tree_add_item(tree, hf_mpeg_descr_ac3_additional_info, tvb, offset, end - offset, ENC_NA);\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_app_sig(tvbuff_t *tvb, guint offset, guint len, proto_tree *tree)\r\n{\r\nguint offset_start;\r\noffset_start = offset;\r\nwhile ((offset - offset_start) < len) {\r\nproto_tree_add_item(tree, hf_mpeg_descr_app_sig_app_type, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_mpeg_descr_app_sig_ait_ver, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_default_authority(tvbuff_t *tvb, guint offset, guint len, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_mpeg_descr_default_authority_name, tvb, offset, len, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_content_identifier(tvbuff_t *tvb, guint offset, guint len, proto_tree *tree)\r\n{\r\nguint end = offset + len, crid_len;\r\nguint8 crid, crid_location, crid_type;\r\nproto_tree *crid_tree;\r\nwhile (offset < end) {\r\ncrid = tvb_get_guint8(tvb, offset);\r\ncrid_type = (crid & MPEG_DESCR_CONTENT_IDENTIFIER_CRID_TYPE_MASK) >> 2;\r\ncrid_location = crid & MPEG_DESCR_CONTENT_IDENTIFIER_CRID_LOCATION_MASK;\r\nif (crid_location == 0) {\r\ncrid_len = 2 + tvb_get_guint8(tvb, offset + 1);\r\n} else if (crid_location == 1) {\r\ncrid_len = 3;\r\n} else {\r\ncrid_len = 1;\r\n}\r\ncrid_tree = proto_tree_add_subtree_format(tree, tvb, offset, crid_len,\r\nett_mpeg_descriptor_content_identifier_crid, NULL, "CRID type=0%02x", crid_type);\r\nproto_tree_add_item(crid_tree, hf_mpeg_descr_content_identifier_crid_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(crid_tree, hf_mpeg_descr_content_identifier_crid_location, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nif (crid_location == 0x00) {\r\ncrid_len = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(crid_tree, hf_mpeg_descr_content_identifier_crid_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(crid_tree, hf_mpeg_descr_content_identifier_crid_bytes, tvb, offset, crid_len, ENC_NA);\r\noffset += crid_len;\r\n} else if (crid_location == 0x01) {\r\nproto_tree_add_item(crid_tree, hf_mpeg_descr_content_identifier_cird_ref, tvb, offset, 2, ENC_BIG_ENDIAN);\r\n}\r\n}\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_extension(tvbuff_t *tvb, guint offset, guint len, proto_tree *tree)\r\n{\r\nguint offset_start;\r\nguint8 tag_ext;\r\ngboolean lang_code_present;\r\nguint already_dissected;\r\noffset_start = offset;\r\ntag_ext = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_mpeg_descr_extension_tag_extension, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nswitch (tag_ext) {\r\ncase EXT_TAG_SUPP_AUDIO:\r\nproto_tree_add_item(tree, hf_mpeg_descr_extension_supp_audio_mix_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_extension_supp_audio_ed_cla, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nlang_code_present = ((tvb_get_guint8(tvb, offset) & 0x01) == 0x01);\r\nproto_tree_add_item(tree, hf_mpeg_descr_extension_supp_audio_lang_code_present, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nif (lang_code_present) {\r\nproto_tree_add_item(tree, hf_mpeg_descr_extension_supp_audio_lang_code, tvb, offset, 3, ENC_ASCII|ENC_NA);\r\noffset += 3;\r\n}\r\nalready_dissected = offset-offset_start;\r\nif (already_dissected<len)\r\nproto_tree_add_item(tree, hf_mpeg_descr_private_data, tvb, offset, len-already_dissected, ENC_NA);\r\nbreak;\r\ndefault:\r\nalready_dissected = offset-offset_start;\r\nif (already_dissected<len)\r\nproto_tree_add_item(tree, hf_mpeg_descr_extension_data, tvb, offset, len-already_dissected, ENC_NA);\r\nbreak;\r\n}\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_logon_initialize(tvbuff_t *tvb, guint offset, guint len, proto_tree *tree)\r\n{\r\nguint end = offset + len;\r\nguint8 flags;\r\nguint16 flags2;\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_group_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_logon_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_continuous_carrier_reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_continuous_carrier, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_security_handshake_required, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_prefix_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_data_unit_labelling_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_mini_slot_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_contention_based_mini_slot_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nflags = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_capacity_type_flag_reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_capacity_type_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_traffic_burst_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nif (flags & MPEG_DESCR_LOGON_INITIALIZE_TRAFFIC_BURST_TYPE_MASK) {\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_connectivity, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nflags2 = tvb_get_ntohs(tvb, offset);\r\nif (flags2 & MPEG_DESCR_LOGON_INITIALIZE_CONNECTIVITY_MASK) {\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_return_signalling_vpi_reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_return_signalling_vpi, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_return_signalling_vci, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_forward_signalling_vpi_reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_forward_signalling_vpi, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_forward_signalling_vci, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n} else {\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_return_vpi_reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_return_vpi, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_return_vci, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\n} else {\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_return_trf_pid, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_return_ctrl_mngm_pid_reserved, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_return_ctrl_mngm_pid, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\nif ((offset < end) && (flags & MPEG_DESCR_LOGON_INITIALIZE_CAPACITY_TYPE_FLAG_MASK)) {\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_cra_level, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_vbdc_max_reserved, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_vbdc_max, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_rbdc_max, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\nproto_tree_add_item(tree, hf_mpeg_descr_logon_initialize_rbdc_timeout, tvb, offset, 2, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\nproto_mpeg_descriptor_dissect_rcs_content(tvbuff_t *tvb, guint offset, guint len, proto_tree *tree)\r\n{\r\nguint end = offset + len;\r\nwhile (offset < end) {\r\nproto_tree_add_item(tree, hf_mpeg_descr_rcs_content_table_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\n}\r\nstatic guint\r\nproto_mpeg_descriptor_dissect_private_ciplus(tvbuff_t *tvb, guint offset, proto_tree *tree)\r\n{\r\nguint offset_start;\r\nguint8 tag, len;\r\nconst gchar *tag_str;\r\nproto_item *di;\r\nproto_tree *descriptor_tree;\r\noffset_start=offset;\r\ntag = tvb_get_guint8(tvb, offset);\r\ntag_str = try_val_to_str(tag, mpeg_descriptor_ciplus_tag_vals);\r\nif (!tag_str)\r\nreturn 0;\r\ndescriptor_tree = proto_tree_add_subtree_format(tree, tvb, offset_start, -1,\r\nett_mpeg_descriptor, &di, "CI+ private descriptor Tag=0x%02x", tag);\r\nproto_tree_add_uint_format(descriptor_tree, hf_mpeg_descriptor_tag,\r\ntvb, offset, 1, tag, "Descriptor Tag: %s (0x%02x)", tag_str, tag);\r\noffset += 1;\r\nlen = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(descriptor_tree, hf_mpeg_descriptor_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nif (tag==CIPLUS_DESC_TAG_CNT_LBL) {\r\nproto_tree_add_item(tree, hf_mpeg_descr_ciplus_cl_cb_min, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_mpeg_descr_ciplus_cl_cb_max, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_mpeg_descr_ciplus_cl_lang, tvb, offset, 3, ENC_ASCII|ENC_NA);\r\noffset += 3;\r\nproto_tree_add_item(tree, hf_mpeg_descr_ciplus_cl_label, tvb, offset, len-offset, ENC_ASCII|ENC_NA);\r\noffset += len-offset;\r\n}\r\nelse if (tag==CIPLUS_DESC_TAG_SVC) {\r\nguint8 str_len_byte;\r\nproto_tree_add_item(descriptor_tree, hf_mpeg_descr_ciplus_svc_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(descriptor_tree, hf_mpeg_descr_ciplus_svc_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(descriptor_tree, hf_mpeg_descr_ciplus_svc_visible, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(descriptor_tree, hf_mpeg_descr_ciplus_svc_selectable, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(descriptor_tree, hf_mpeg_descr_ciplus_svc_lcn, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nstr_len_byte = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(descriptor_tree, hf_mpeg_descr_ciplus_svc_prov_name, tvb, offset, 1, ENC_ASCII|ENC_BIG_ENDIAN);\r\noffset += 1+str_len_byte;\r\nstr_len_byte = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(descriptor_tree, hf_mpeg_descr_ciplus_svc_name, tvb, offset, 1, ENC_ASCII|ENC_BIG_ENDIAN);\r\noffset += 1+str_len_byte;\r\n}\r\nelse if (tag==CIPLUS_DESC_TAG_PROT) {\r\ngboolean match_brand_flag;\r\nguint8 num_brands, i;\r\nguint remaining;\r\nproto_tree_add_item(descriptor_tree, hf_mpeg_descr_ciplus_prot_free_ci_mode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nmatch_brand_flag = ((tvb_get_guint8(tvb, offset) & 0x40) == 0x40);\r\nproto_tree_add_item(descriptor_tree, hf_mpeg_descr_ciplus_prot_match_brand_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nif (match_brand_flag) {\r\nnum_brands = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(descriptor_tree, hf_mpeg_descr_ciplus_prot_num_entries, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nfor (i=0; i<num_brands; i++) {\r\nproto_tree_add_item(descriptor_tree, hf_mpeg_descr_ciplus_prot_brand_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\n}\r\nremaining = offset_start+2+len - offset;\r\nif (remaining > 0) {\r\nproto_tree_add_item(descriptor_tree, hf_mpeg_descr_private_data, tvb, offset, remaining, ENC_NA);\r\noffset += remaining;\r\n}\r\n}\r\nproto_item_set_len(di, offset-offset_start);\r\nreturn offset-offset_start;\r\n}\r\nguint\r\nproto_mpeg_descriptor_dissect(tvbuff_t *tvb, guint offset, proto_tree *tree)\r\n{\r\nguint tag, len;\r\nproto_tree *descriptor_tree;\r\ntag = tvb_get_guint8(tvb, offset);\r\nlen = tvb_get_guint8(tvb, offset + 1);\r\ndescriptor_tree = proto_tree_add_subtree_format(tree, tvb, offset, len + 2,\r\nett_mpeg_descriptor, NULL, "Descriptor Tag=0x%02x", tag);\r\nproto_tree_add_item(descriptor_tree, hf_mpeg_descriptor_tag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(descriptor_tree, hf_mpeg_descriptor_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nif (len == 0)\r\nreturn 2;\r\nswitch (tag) {\r\ncase 0x02:\r\nproto_mpeg_descriptor_dissect_video_stream(tvb, offset, descriptor_tree);\r\nbreak;\r\ncase 0x03:\r\nproto_mpeg_descriptor_dissect_audio_stream(tvb, offset, descriptor_tree);\r\nbreak;\r\ncase 0x05:\r\nproto_mpeg_descriptor_dissect_registration(tvb, offset, len, descriptor_tree);\r\nbreak;\r\ncase 0x06:\r\nproto_mpeg_descriptor_dissect_data_stream_alignment(tvb, offset, descriptor_tree);\r\nbreak;\r\ncase 0x09:\r\nproto_mpeg_descriptor_dissect_ca(tvb, offset, len, descriptor_tree);\r\nbreak;\r\ncase 0x0A:\r\nproto_mpeg_descriptor_dissect_iso639(tvb, offset, len, descriptor_tree);\r\nbreak;\r\ncase 0x0B:\r\nproto_mpeg_descriptor_dissect_system_clock(tvb, offset, descriptor_tree);\r\nbreak;\r\ncase 0x0E:\r\nproto_mpeg_descriptor_dissect_max_bitrate(tvb, offset, descriptor_tree);\r\nbreak;\r\ncase 0x10:\r\nproto_mpeg_descriptor_dissect_smoothing_buffer(tvb, offset, descriptor_tree);\r\nbreak;\r\ncase 0x11:\r\nproto_mpeg_descriptor_dissect_std(tvb, offset, descriptor_tree);\r\nbreak;\r\ncase 0x13:\r\nproto_mpeg_descriptor_dissect_carousel_identifier(tvb, offset, len, descriptor_tree);\r\nbreak;\r\ncase 0x14:\r\nproto_mpeg_descriptor_dissect_association_tag(tvb, offset, len, descriptor_tree);\r\nbreak;\r\ncase 0x28:\r\nproto_mpeg_descriptor_dissect_avc_vid(tvb, offset, descriptor_tree);\r\nbreak;\r\ncase 0x40:\r\nproto_mpeg_descriptor_dissect_network_name(tvb, offset, len, descriptor_tree);\r\nbreak;\r\ncase 0x41:\r\nproto_mpeg_descriptor_dissect_service_list(tvb, offset, len, descriptor_tree);\r\nbreak;\r\ncase 0x42:\r\nproto_mpeg_descriptor_stuffing(tvb, offset, len, descriptor_tree);\r\nbreak;\r\ncase 0x43:\r\nproto_mpeg_descriptor_dissect_satellite_delivery(tvb, offset, descriptor_tree);\r\nbreak;\r\ncase 0x44:\r\nproto_mpeg_descriptor_dissect_cable_delivery(tvb, offset, descriptor_tree);\r\nbreak;\r\ncase 0x45:\r\nproto_mpeg_descriptor_dissect_vbi_data(tvb, offset, len, descriptor_tree);\r\nbreak;\r\ncase 0x47:\r\nproto_mpeg_descriptor_dissect_bouquet_name(tvb, offset, len, descriptor_tree);\r\nbreak;\r\ncase 0x48:\r\nproto_mpeg_descriptor_dissect_service(tvb, offset, descriptor_tree);\r\nbreak;\r\ncase 0x4A:\r\nproto_mpeg_descriptor_dissect_linkage(tvb, offset, len, descriptor_tree);\r\nbreak;\r\ncase 0x4D:\r\nproto_mpeg_descriptor_dissect_short_event(tvb, offset, descriptor_tree);\r\nbreak;\r\ncase 0x4E:\r\nproto_mpeg_descriptor_dissect_extended_event(tvb, offset, descriptor_tree);\r\nbreak;\r\ncase 0x50:\r\nproto_mpeg_descriptor_dissect_component(tvb, offset, len, descriptor_tree);\r\nbreak;\r\ncase 0x52:\r\nproto_mpeg_descriptor_dissect_stream_identifier(tvb, offset, descriptor_tree);\r\nbreak;\r\ncase 0x53:\r\nproto_mpeg_descriptor_dissect_ca_identifier(tvb, offset, len, descriptor_tree);\r\nbreak;\r\ncase 0x54:\r\nproto_mpeg_descriptor_dissect_content(tvb, offset, len, descriptor_tree);\r\nbreak;\r\ncase 0x55:\r\nproto_mpeg_descriptor_dissect_parental_rating(tvb, offset, descriptor_tree);\r\nbreak;\r\ncase 0x56:\r\nproto_mpeg_descriptor_dissect_teletext(tvb, offset, len, descriptor_tree);\r\nbreak;\r\ncase 0x58:\r\nproto_mpeg_descriptor_dissect_local_time_offset(tvb, offset, len, descriptor_tree);\r\nbreak;\r\ncase 0x59:\r\nproto_mpeg_descriptor_dissect_subtitling(tvb, offset, len, descriptor_tree);\r\nbreak;\r\ncase 0x5A:\r\nproto_mpeg_descriptor_dissect_terrestrial_delivery(tvb, offset, descriptor_tree);\r\nbreak;\r\ncase 0x5F:\r\nproto_mpeg_descriptor_dissect_private_data_specifier(tvb, offset, descriptor_tree);\r\nbreak;\r\ncase 0x64:\r\nproto_mpeg_descriptor_dissect_data_bcast(tvb, offset, descriptor_tree);\r\nbreak;\r\ncase 0x66:\r\nproto_mpeg_descriptor_dissect_data_bcast_id(tvb, offset, len, descriptor_tree);\r\nbreak;\r\ncase 0x6A:\r\nproto_mpeg_descriptor_dissect_ac3(tvb, offset, len, descriptor_tree);\r\nbreak;\r\ncase 0x6F:\r\nproto_mpeg_descriptor_dissect_app_sig(tvb, offset, len, descriptor_tree);\r\nbreak;\r\ncase 0x73:\r\nproto_mpeg_descriptor_dissect_default_authority(tvb, offset, len, descriptor_tree);\r\nbreak;\r\ncase 0x76:\r\nproto_mpeg_descriptor_dissect_content_identifier(tvb, offset, len, descriptor_tree);\r\nbreak;\r\ncase 0x7F:\r\nproto_mpeg_descriptor_dissect_extension(tvb, offset, len, descriptor_tree);\r\nbreak;\r\ncase 0xA2:\r\nproto_mpeg_descriptor_dissect_logon_initialize(tvb, offset, len, descriptor_tree);\r\nbreak;\r\ncase 0xA7:\r\nproto_mpeg_descriptor_dissect_rcs_content(tvb, offset, len, descriptor_tree);\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(descriptor_tree, hf_mpeg_descriptor_data, tvb, offset, len, ENC_NA);\r\nbreak;\r\n}\r\nreturn len + 2;\r\n}\r\nguint\r\nproto_mpeg_descriptor_loop_dissect(tvbuff_t *tvb, guint offset, guint loop_len, proto_tree *tree)\r\n{\r\nguint32 private_data_specifier = PRIVATE_DATA_SPECIFIER_RESERVED;\r\nguint offset_start;\r\nguint desc_len;\r\nguint8 tag;\r\noffset_start = offset;\r\nwhile ((offset - offset_start) < loop_len) {\r\ntag = tvb_get_guint8(tvb, offset);\r\nif (tag == 0x5F) {\r\nprivate_data_specifier = tvb_get_ntohl(tvb, offset+2);\r\n}\r\nif (try_val_to_str(tag, mpeg_descriptor_tag_vals)) {\r\ndesc_len = proto_mpeg_descriptor_dissect(tvb, offset, tree);\r\n}\r\nelse {\r\nswitch (private_data_specifier) {\r\ncase PRIVATE_DATA_SPECIFIER_CIPLUS_LLP:\r\ndesc_len = proto_mpeg_descriptor_dissect_private_ciplus(tvb, offset, tree);\r\nbreak;\r\ndefault:\r\ndesc_len = 0;\r\nbreak;\r\n}\r\nif (desc_len == 0) {\r\ndesc_len = proto_mpeg_descriptor_dissect(tvb, offset, tree);\r\n}\r\n}\r\noffset += desc_len;\r\n}\r\nreturn offset-offset_start;\r\n}\r\nvoid\r\nproto_register_mpeg_descriptor(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_mpeg_descriptor_tag, {\r\n"Descriptor Tag", "mpeg_descr.tag",\r\nFT_UINT8, BASE_HEX | BASE_EXT_STRING, &mpeg_descriptor_tag_vals_ext, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descriptor_length, {\r\n"Descriptor Length", "mpeg_descr.len",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descriptor_data, {\r\n"Descriptor Data", "mpeg_descr.data",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_video_stream_multiple_frame_rate_flag, {\r\n"Multiple Frame Rate Flag", "mpeg_descr.video_stream.multiple_frame_rate_flag",\r\nFT_UINT8, BASE_DEC, VALS(mpeg_descr_video_stream_multiple_frame_rate_flag_vals),\r\nMPEG_DESCR_VIDEO_STREAM_MULTIPLE_FRAME_RATE_FLAG_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_video_stream_frame_rate_code, {\r\n"Frame Rate Code", "mpeg_descr.video_stream.frame_rate_code",\r\nFT_UINT8, BASE_HEX, NULL, MPEG_DESCR_VIDEO_STREAM_FRAME_RATE_CODE_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_video_stream_mpeg1_only_flag, {\r\n"MPEG1 Only Flag", "mpeg_descr.video_stream.mpeg1_only_flag",\r\nFT_UINT8, BASE_DEC, NULL, MPEG_DESCR_VIDEO_STREAM_MPEG1_ONLY_FLAG_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_video_stream_constrained_parameter_flag, {\r\n"Constrained Parameter Flag", "mpeg_descr.video_stream.constrained_parameter_flag",\r\nFT_UINT8, BASE_DEC, NULL, MPEG_DESCR_VIDEO_STREAM_CONSTRAINED_PARAMETER_FLAG_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_video_stream_still_picture_flag, {\r\n"Still Picture Flag", "mpeg_descr.video_stream.still_picture_flag",\r\nFT_UINT8, BASE_DEC, NULL, MPEG_DESCR_VIDEO_STREAM_STILL_PICTURE_FLAG_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_video_stream_profile_and_level_indication, {\r\n"Profile and Level Indication", "mpeg_descr.video_stream.profile_level_ind",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_video_stream_chroma_format, {\r\n"Chroma Format", "mpeg_descr.video_stream.chroma_format",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_video_stream_frame_rate_extension_flag, {\r\n"Frame Rate Extension Flag", "mpeg_descr.video_stream.frame_rate_extension_flag",\r\nFT_UINT8, BASE_DEC, NULL, MPEG_DESCR_VIDEO_STREAM_FRAME_RATE_EXTENSION_FLAG_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_video_stream_reserved, {\r\n"Reserved", "mpeg_descr.video_stream.reserved",\r\nFT_UINT8, BASE_HEX, NULL, MPEG_DESCR_VIDEO_STREAM_RESERVED_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_audio_stream_free_format_flag, {\r\n"Free Format Flag", "mpeg_descr.audio_stream.free_format_flag",\r\nFT_UINT8, BASE_DEC, VALS(mpeg_descr_audio_stream_free_format_flag_vals), MPEG_DESCR_AUDIO_STREAM_FREE_FORMAT_FLAG_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_audio_stream_id, {\r\n"ID", "mpeg_descr.audio_stream.id",\r\nFT_UINT8, BASE_DEC, VALS(mpeg_descr_audio_stream_id_vals), MPEG_DESCR_AUDIO_STREAM_ID_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_audio_stream_layer, {\r\n"Layer", "mpeg_descr.audio_stream.layer",\r\nFT_UINT8, BASE_DEC, NULL, MPEG_DESCR_AUDIO_STREAM_LAYER_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_audio_stream_variable_rate_audio_indicator, {\r\n"Variable Rate Audio Indicator", "mpeg_descr.audio_stream.vbr_indicator",\r\nFT_UINT8, BASE_DEC, VALS(mpeg_descr_audio_stream_variable_rate_audio_indicator_vals),\r\nMPEG_DESCR_AUDIO_STREAM_VARIABLE_RATE_AUDIO_INDICATOR_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_audio_stream_reserved, {\r\n"Reserved", "mpeg_descr.audio_stream.reserved",\r\nFT_UINT8, BASE_HEX, NULL, MPEG_DESCR_AUDIO_STREAM_RESERVED_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_reg_form_id, {\r\n"Format identifier", "mpeg_descr.registration.format_identifier",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_reg_add_id_inf, {\r\n"Additional identification info", "mpeg_descr.registration.add_id_info",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_data_stream_alignment, {\r\n"Data Stream Alignment", "mpeg_descr.data_stream_alignment.alignment",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_data_stream_alignment_vals), 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ca_system_id, {\r\n"System ID", "mpeg_descr.ca.sys_id",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ca_reserved, {\r\n"Reserved", "mpeg_descr.ca.reserved",\r\nFT_UINT16, BASE_HEX, NULL, MPEG_DESCR_CA_RESERVED_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ca_pid, {\r\n"CA PID", "mpeg_descr.ca.pid",\r\nFT_UINT16, BASE_HEX, NULL, MPEG_DESCR_CA_PID_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ca_private, {\r\n"Private bytes", "mpeg_descr.ca.private",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_iso639_lang, {\r\n"ISO 639 Language Code", "mpeg_descr.lang.code",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_iso639_type, {\r\n"ISO 639 Language Type", "mpeg_descr.lang.type",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_iso639_type_vals), 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_system_clock_external_clock_reference_indicator, {\r\n"External Clock Reference Indicator", "mpeg_descr.sys_clk.external_clk_ref_ind",\r\nFT_UINT8, BASE_DEC, NULL, MPEG_DESCR_SYSTEM_CLOCK_EXTERNAL_CLOCK_REFERENCE_INDICATOR_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_system_clock_reserved1, {\r\n"Reserved", "mpeg_descr.sys_clk.reserved1",\r\nFT_UINT8, BASE_HEX, NULL, MPEG_DESCR_SYSTEM_CLOCK_RESERVED1_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_system_clock_accuracy_integer, {\r\n"Accuracy Integer", "mpeg_descr.sys_clk.accuracy_integer",\r\nFT_UINT8, BASE_DEC, NULL, MPEG_DESCR_SYSTEM_CLOCK_ACCURACY_INTEGER_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_system_clock_accuracy_exponent, {\r\n"Accuracy Exponent", "mpeg_descr.sys_clk.accuracy_exponent",\r\nFT_UINT8, BASE_DEC, NULL, MPEG_DESCR_SYSTEM_CLOCK_ACCURACY_EXPONENT_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_system_clock_reserved2, {\r\n"Reserved", "mpeg_descr.sys_clk.reserved2",\r\nFT_UINT8, BASE_HEX, NULL, MPEG_DESCR_SYSTEM_CLOCK_RESERVED2_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_max_bitrate_reserved, {\r\n"Maximum Bitrate Reserved", "mpeg_descr.max_bitrate.reserved",\r\nFT_UINT24, BASE_HEX, NULL, MPEG_DESCR_MAX_BITRATE_RESERVED_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_max_bitrate, {\r\n"Maximum Bitrate", "mpeg_descr.max_bitrate.rate",\r\nFT_UINT24, BASE_DEC, NULL, MPEG_DESCR_MAX_BITRATE_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_smoothing_buffer_reserved1, {\r\n"Reserved", "mpeg_descr.smoothing_buf.reserved1",\r\nFT_UINT24, BASE_HEX, NULL, MPEG_DESCR_SMOOTHING_BUFFER_RESERVED1_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_smoothing_buffer_leak_rate, {\r\n"Leak Rate", "mpeg_descr.smoothing_buf.leak_rate",\r\nFT_UINT24, BASE_DEC, NULL, MPEG_DESCR_SMOOTHING_BUFFER_LEAK_RATE_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_smoothing_buffer_reserved2, {\r\n"Reserved", "mpeg_descr.smoothing_buf.reserved2",\r\nFT_UINT24, BASE_HEX, NULL, MPEG_DESCR_SMOOTHING_BUFFER_RESERVED2_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_smoothing_buffer_size, {\r\n"Buffer Size", "mpeg_descr.smoothing_buf.size",\r\nFT_UINT24, BASE_DEC, NULL, MPEG_DESCR_SMOOTHING_BUFFER_SIZE_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_std_reserved, {\r\n"Reserved", "mpeg_descr.std.reserved",\r\nFT_UINT8, BASE_HEX, NULL, MPEG_DESCR_STD_RESERVED_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_std_leak_valid, {\r\n"Leak Valid", "mpeg_descr.std.leak_valid",\r\nFT_UINT8, BASE_DEC, NULL, MPEG_DESCR_STD_LEAK_VALID_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_carousel_identifier_id, {\r\n"Carousel ID", "mpeg_descr.carousel_identifier.id",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_carousel_identifier_format_id, {\r\n"Format ID", "mpeg_descr.carousel_identifier.format_id",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_carousel_identifier_format_id_vals), 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_carousel_identifier_module_version, {\r\n"Module Version", "mpeg_descr.carousel_identifier.module_version",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_carousel_identifier_module_id, {\r\n"Module ID", "mpeg_descr.carousel_identifier.module_id",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_carousel_identifier_block_size, {\r\n"Block Size", "mpeg_descr.carousel_identifier.block_size",\r\nFT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_carousel_identifier_module_size, {\r\n"Module Size", "mpeg_descr.carousel_identifier.module_size",\r\nFT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_carousel_identifier_compression_method, {\r\n"Compression Method", "mpeg_descr.carousel_identifier.comp_method",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_carousel_identifier_original_size, {\r\n"Original Size", "mpeg_descr.carousel_identifier.orig_size",\r\nFT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_carousel_identifier_timeout, {\r\n"Timeout", "mpeg_descr.carousel_identifier.timeout",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_carousel_identifier_object_key_len, {\r\n"Object Key Length", "mpeg_descr.carousel_identifier.key_len",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_carousel_identifier_object_key_data, {\r\n"Object Key Data", "mpeg_descr.carousel_identifier.key_data",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_carousel_identifier_private, {\r\n"Private Bytes", "mpeg_descr.carousel_identifier.private",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_association_tag, {\r\n"Association Tag", "mpeg_descr.assoc_tag.tag",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_association_tag_use, {\r\n"Use", "mpeg_descr.assoc_tag.use",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_association_tag_selector_len, {\r\n"Selector Length", "mpeg_descr.assoc_tag.selector_len",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_association_tag_transaction_id, {\r\n"Transaction ID", "mpeg_descr.assoc_tag.transaction_id",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_association_tag_timeout, {\r\n"Timeout", "mpeg_descr.assoc_tag.timeout",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_association_tag_selector_bytes, {\r\n"Selector Bytes", "mpeg_descr.assoc_tag.selector_bytes",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_association_tag_private_bytes, {\r\n"Private Bytes", "mpeg_descr.assoc_tag.private_bytes",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_avc_vid_profile_idc, {\r\n"Profile IDC", "mpeg_descr.avc_vid.profile_idc",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_avc_vid_constraint_set0_flag, {\r\n"Constraint Set0 Flag", "mpeg_descr.avc_vid.contraint_set0",\r\nFT_UINT8, BASE_DEC, NULL, MPEG_DESCR_AVC_VID_CONSTRAINT_SET0_FLAG_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_avc_vid_constraint_set1_flag, {\r\n"Constraint Set1 Flag", "mpeg_descr.avc_vid.contraint_set1",\r\nFT_UINT8, BASE_DEC, NULL, MPEG_DESCR_AVC_VID_CONSTRAINT_SET1_FLAG_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_avc_vid_constraint_set2_flag, {\r\n"Constraint Set2 Flag", "mpeg_descr.avc_vid.contraint_set2",\r\nFT_UINT8, BASE_DEC, NULL, MPEG_DESCR_AVC_VID_CONSTRAINT_SET2_FLAG_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_avc_vid_compatible_flags, {\r\n"Constraint Compatible Flags", "mpeg_descr.avc_vid.compatible_flags",\r\nFT_UINT8, BASE_HEX, NULL, MPEG_DESCR_AVC_VID_COMPATIBLE_FLAGS_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_avc_vid_level_idc, {\r\n"Level IDC", "mpeg_descr.avc_vid.level_idc",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_avc_vid_still_present, {\r\n"AVC Still Present", "mpeg_descr.avc_vid.still_present",\r\nFT_UINT8, BASE_DEC, NULL, MPEG_DESCR_AVC_VID_STILL_PRESENT_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_avc_vid_24h_picture_flag, {\r\n"AVC 24 Hour Picture Flag", "mpeg_descr.avc_vid.24h_picture_flag",\r\nFT_UINT8, BASE_DEC, NULL, MPEG_DESCR_AVC_VID_24H_PICTURE_FLAG_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_avc_vid_reserved, {\r\n"Reserved", "mpeg_descr.avc_vid.reserved",\r\nFT_UINT8, BASE_HEX, NULL, MPEG_DESCR_AVC_VID_RESERVED_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_network_name_descriptor, {\r\n"Network Name", "mpeg_descr.net_name.name",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_service_list_id, {\r\n"Service ID", "mpeg_descr.svc_list.id",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_service_list_type, {\r\n"Service Type", "mpeg_descr.svc_list.type",\r\nFT_UINT8, BASE_HEX | BASE_EXT_STRING, &mpeg_descr_service_type_vals_ext, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_stuffing, {\r\n"Stuffing", "mpeg_descr.stuffing",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_satellite_delivery_frequency, {\r\n"Frequency", "mpeg_descr.sat_delivery.freq",\r\nFT_DOUBLE, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_satellite_delivery_orbital_position, {\r\n"Orbital Position", "mpeg_descr.sat_delivery.orbital_pos",\r\nFT_FLOAT, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_satellite_delivery_west_east_flag, {\r\n"West East Flag", "mpeg_descr.sat_delivery.west_east_flag",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_satellite_delivery_west_east_flag_vals),\r\nMPEG_DESCR_SATELLITE_DELIVERY_WEST_EAST_FLAG_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_satellite_delivery_polarization, {\r\n"Polarization", "mpeg_descr.sat_delivery.polarization",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_satellite_delivery_polarization_vals),\r\nMPEG_DESCR_SATELLITE_DELIVERY_POLARIZATION_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_satellite_delivery_roll_off, {\r\n"Roll Off", "mpeg_descr.sat_delivery.roll_off",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_satellite_delivery_roll_off_vals),\r\nMPEG_DESCR_SATELLITE_DELIVERY_ROLL_OFF_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_satellite_delivery_zero, {\r\n"Zero", "mpeg_descr.sat_delivery.zero",\r\nFT_UINT8, BASE_HEX, NULL, MPEG_DESCR_SATELLITE_DELIVERY_ZERO_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_satellite_delivery_modulation_system, {\r\n"Modulation System", "mpeg_descr.sat_delivery.modulation_system",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_satellite_delivery_modulation_system_vals),\r\nMPEG_DESCR_SATELLITE_DELIVERY_MODULATION_SYSTEM_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_satellite_delivery_modulation_type, {\r\n"Modulation Type", "mpeg_descr.sat_delivery.modulation_type",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_satellite_delivery_modulation_type_vals),\r\nMPEG_DESCR_SATELLITE_DELIVERY_MODULATION_TYPE_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_satellite_delivery_symbol_rate, {\r\n"Symbol Rate", "mpeg_descr.sat_delivery.symbol_rate",\r\nFT_DOUBLE, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_satellite_delivery_fec_inner, {\r\n"FEC Inner", "mpeg_descr.sat_delivery.fec_inner",\r\nFT_UINT8, BASE_HEX | BASE_EXT_STRING, &mpeg_descr_satellite_delivery_fec_inner_vals_ext,\r\nMPEG_DESCR_SATELLITE_DELIVERY_FEC_INNER_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_cable_delivery_frequency, {\r\n"Frequency", "mpeg_descr.cable_delivery.freq",\r\nFT_DOUBLE, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_cable_delivery_reserved, {\r\n"Reserved", "mpeg_descr.cable_delivery.reserved",\r\nFT_UINT16, BASE_HEX, NULL, MPEG_DESCR_CABLE_DELIVERY_RESERVED_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_cable_delivery_fec_outer, {\r\n"FEC Outer", "mpeg_descr.cable_delivery.fec_outer",\r\nFT_UINT16, BASE_HEX, VALS(mpeg_descr_cable_delivery_fec_outer_vals),\r\nMPEG_DESCR_CABLE_DELIVERY_FEC_OUTER_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_cable_delivery_modulation, {\r\n"Modulation", "mpeg_descr.cable_delivery.modulation",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_cable_delivery_modulation_vals), 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_cable_delivery_symbol_rate, {\r\n"Symbol Rate", "mpeg_descr.cable_delivery.sym_rate",\r\nFT_DOUBLE, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_cable_delivery_fec_inner, {\r\n"FEC Inner", "mpeg_descr.cable_delivery.fec_inner",\r\nFT_UINT8, BASE_HEX | BASE_EXT_STRING, &mpeg_descr_cable_delivery_fec_inner_vals_ext,\r\nMPEG_DESCR_CABLE_DELIVERY_FEC_INNER_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_vbi_data_service_id, {\r\n"Data Service ID", "mpeg_descr.vbi_data.svc_id",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_vbi_data_service_id_vals), 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_vbi_data_descr_len, {\r\n"Data Descriptor Length", "mpeg_descr.vbi_data.decr_len",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_vbi_data_reserved1, {\r\n"Reserved", "mpeg_descr.vbi_data.reserved1",\r\nFT_UINT8, BASE_HEX, NULL, MPEG_DESCR_VBI_DATA_RESERVED1_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_vbi_data_field_parity, {\r\n"Field Parity", "mpeg_descr.vbi_data.field_parity",\r\nFT_UINT8, BASE_DEC, VALS(mpeg_descr_vbi_data_field_parity_vals),\r\nMPEG_DESCR_VBI_DATA_FIELD_PARITY_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_vbi_data_line_offset, {\r\n"Line offset", "mpeg_descr.vbi_data.line_offset",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_vbi_data_reserved2, {\r\n"Reserved", "mpeg_descr.vbi_data.reserved2",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_bouquet_name, {\r\n"Bouquet Name Descriptor", "mpeg_descr.bouquet_name.name",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_service_type, {\r\n"Service Type", "mpeg_descr.svc.type",\r\nFT_UINT8, BASE_HEX | BASE_EXT_STRING, &mpeg_descr_service_type_vals_ext, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_service_provider_name_length, {\r\n"Provider Name Length", "mpeg_descr.svc.provider_name_len",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_service_provider_name_encoding, {\r\n"Provider Name Encoding", "mpeg_descr.svc.provider_name_enc",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_service_provider, {\r\n"Service Provider Name", "mpeg_descr.svc.provider_name",\r\nFT_STRING, STR_UNICODE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_service_name_length, {\r\n"Service Name Length", "mpeg_descr.svc.svc_name_len",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_service_name_encoding, {\r\n"Service Name Encoding", "mpeg_descr.svc.svn_name_enc",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_service_name, {\r\n"Service Name", "mpeg_descr.svc.svc_name",\r\nFT_STRING, STR_UNICODE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_linkage_transport_stream_id, {\r\n"Transport Stream ID", "mpeg_descr.linkage.tsid",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_linkage_original_network_id, {\r\n"Original Network ID", "mpeg_descr.linkage.original_nid",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_linkage_service_id, {\r\n"Service ID", "mpeg_descr.linkage.svc_id",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_linkage_linkage_type, {\r\n"Linkage Type", "mpeg_descr.linkage.type",\r\nFT_UINT8, BASE_HEX | BASE_EXT_STRING, &mpeg_descr_linkage_linkage_type_vals_ext, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_linkage_hand_over_type, {\r\n"Hand-Over Type", "mpeg_descr.linkage.hand_over_type",\r\nFT_UINT8, BASE_HEX, NULL, MPEG_DESCR_LINKAGE_HAND_OVER_TYPE_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_linkage_reserved1, {\r\n"Reserved", "mpeg_descr.linkage.reserved1",\r\nFT_UINT8, BASE_HEX, NULL, MPEG_DESCR_LINKAGE_RESERVED1_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_linkage_origin_type, {\r\n"Origin Type", "mpeg_descr.linkage.origin_type",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_linkage_origin_type_vals), 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_linkage_network_id, {\r\n"Network ID", "mpeg_descr.linkage.network_id",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_linkage_initial_service_id, {\r\n"Initial Service ID", "mpeg_descr.linkage.initial_svc_id",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_linkage_target_event_id, {\r\n"Target Event ID", "mpeg_descr.linkage.target_evt_id",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_linkage_target_listed, {\r\n"Target Listed", "mpeg_descr.linkage.target_listed",\r\nFT_UINT8, BASE_DEC, VALS(mpeg_descr_linkage_target_listed_vals),\r\nMPEG_DESCR_LINKAGE_TARGET_LISTED_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_linkage_event_simulcast, {\r\n"Event Simulcast", "mpeg_descr.linkage.evt_simulcast",\r\nFT_UINT8, BASE_DEC, VALS(mpeg_descr_linkage_event_simulcast_vals),\r\nMPEG_DESCR_LINKAGE_EVENT_SIMULCAST_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_linkage_reserved2, {\r\n"Reserved", "mpeg_descr.linkage.reserved2",\r\nFT_UINT8, BASE_HEX, NULL, MPEG_DESCR_LINKAGE_RESERVED2_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_linkage_private_data_byte, {\r\n"Private Data", "mpeg_descr.linkage.private_data",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_linkage_interactive_network_id, {\r\n"Interactive Network ID", "mpeg_descr.interactive_network_id",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_linkage_population_id_loop_count, {\r\n"Population ID loop count", "mpeg_descr.population_id_loop_count",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_linkage_population_id, {\r\n"Population ID", "mpeg_descr.population_id",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_linkage_population_id_base, {\r\n"Population ID Base", "mpeg_descr.population_id_base",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_linkage_population_id_mask, {\r\n"Population ID Mask", "mpeg_descr.population_id_mask",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_short_event_lang_code, {\r\n"Language Code", "mpeg_descr.short_evt.lang_code",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_short_event_name_length, {\r\n"Event Name Length", "mpeg_descr.short_evt.name_len",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_short_event_name_encoding, {\r\n"Event Name Encoding", "mpeg_descr.short_evt.name_enc",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_short_event_name, {\r\n"Event Name", "mpeg_descr.short_evt.name",\r\nFT_STRING, STR_UNICODE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_short_event_text_length, {\r\n"Event Text Length", "mpeg_descr.short_evt.txt_len",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_short_event_text_encoding, {\r\n"Event Text Encoding", "mpeg_descr.short_evt.txt_enc",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_short_event_text, {\r\n"Event Text", "mpeg_descr.short_evt.txt",\r\nFT_STRING, STR_UNICODE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_extended_event_descriptor_number, {\r\n"Descriptor Number", "mpeg_descr.ext_evt.descr_num",\r\nFT_UINT8, BASE_DEC, NULL, MPEG_DESCR_EXTENDED_EVENT_DESCRIPTOR_NUMBER_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_extended_event_last_descriptor_number, {\r\n"Last Descriptor Number", "mpeg_descr.ext_evt.last_descr_num",\r\nFT_UINT8, BASE_DEC, NULL, MPEG_DESCR_EXTENDED_EVENT_LAST_DESCRIPTOR_NUMBER_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_extended_event_lang_code, {\r\n"Language Code", "mpeg_descr.ext_evt.lang_code",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_extended_event_length_of_items, {\r\n"Length of items", "mpeg_descr.ext_evt.items_len",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_extended_event_item_description_length, {\r\n"Item Description Length", "mpeg_descr.ext_evt.item_descr_len",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_extended_event_item_description_char, {\r\n"Item Description", "mpeg_descr.ext_evt.item_descr",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_extended_event_item_length, {\r\n"Item Length", "mpeg_descr.ext_evt.item_len",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_extended_event_item_char, {\r\n"Item", "mpeg_descr.ext_evt.item",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_extended_event_text_length, {\r\n"Text Length", "mpeg_descr.ext_evt.txt_len",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_extended_event_text_encoding, {\r\n"Text Encoding", "mpeg_descr.ext_evt.txt_enc",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_extended_event_text, {\r\n"Text", "mpeg_descr.ext_evt.txt",\r\nFT_STRING, STR_UNICODE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_component_reserved, {\r\n"Reserved", "mpeg_descr.component.reserved",\r\nFT_UINT8, BASE_HEX, NULL, MPEG_DESCR_COMPONENT_RESERVED_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_component_stream_content, {\r\n"Stream Content", "mpeg_descr.component.stream_content",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_component_stream_content_vals),\r\nMPEG_DESCR_COMPONENT_STREAM_CONTENT_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_component_type, {\r\n"Component Type", "mpeg_descr.component.type",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_component_content_type, {\r\n"Stream Content and Component Type", "mpeg_descr.component.content_type",\r\nFT_UINT16, BASE_HEX | BASE_EXT_STRING, &mpeg_descr_component_content_type_vals_ext,\r\nMPEG_DESCR_COMPONENT_CONTENT_TYPE_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_component_tag, {\r\n"Component Tag", "mpeg_descr.component.tag",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_component_lang_code, {\r\n"Language Code", "mpeg_descr.component.lang_code",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_component_text, {\r\n"Text", "mpeg_descr.component.text",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_stream_identifier_component_tag, {\r\n"Component Tag", "mpeg_descr.stream_id.component_tag",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ca_identifier_system_id, {\r\n"CA System ID", "mpeg_descr.ca_id.sys_id",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_content_nibble, {\r\n"Nibble Level 1 and 2", "mpeg_descr.content.nibble_1_2",\r\nFT_UINT8, BASE_HEX | BASE_EXT_STRING, &mpeg_descr_content_nibble_vals_ext, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_content_nibble_level_1, {\r\n"Nibble Level 1", "mpeg_descr.content.nibble_lvl_1",\r\nFT_UINT8, BASE_HEX | BASE_EXT_STRING, &mpeg_descr_content_nibble_level_1_vals_ext,\r\nMPEG_DESCR_CONTENT_NIBBLE_LEVEL_1_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_content_nibble_level_2, {\r\n"Nibble Level 2", "mpeg_descr.content.nibble_lvl_2",\r\nFT_UINT8, BASE_HEX, NULL, MPEG_DESCR_CONTENT_NIBBLE_LEVEL_2_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_content_user_byte, {\r\n"User Byte", "mpeg_descr.content.user",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_teletext_lang_code, {\r\n"Language Code", "mpeg_descr.teletext.lang_code",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_teletext_type, {\r\n"Teletext Type", "mpeg_descr.teletext.type",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_teletext_type_vals),\r\nMPEG_DESCR_TELETEXT_TYPE_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_teletext_magazine_number, {\r\n"Magazine Number", "mpeg_descr.teletext.magazine_num",\r\nFT_UINT8, BASE_DEC, NULL, MPEG_DESCR_TELETEXT_MAGAZINE_NUMBER_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_teletext_page_number, {\r\n"Page Number", "mpeg_descr.teletext.page_num",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_parental_rating_country_code, {\r\n"Country Code", "mpeg_descr.parental_rating.country_code",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_parental_rating_rating, {\r\n"Rating", "mpeg_descr.parental_rating.rating",\r\nFT_UINT8, BASE_HEX | BASE_EXT_STRING, &mpeg_descr_parental_rating_vals_ext, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_local_time_offset_country_code, {\r\n"Country Code", "mpeg_descr.local_time_offset.country_code",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_local_time_offset_region_id, {\r\n"Region ID", "mpeg_descr.local_time_offset.region_id",\r\nFT_UINT8, BASE_HEX, NULL, MPEG_DESCR_LOCAL_TIME_OFFSET_COUNTRY_REGION_ID_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_local_time_offset_reserved, {\r\n"Reserved", "mpeg_descr.local_time_offset.reserved",\r\nFT_UINT8, BASE_HEX, NULL, MPEG_DESCR_LOCAL_TIME_OFFSET_RESERVED_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_local_time_offset_polarity, {\r\n"Time Offset Polarity", "mpeg_descr.local_time_offset.polarity",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_local_time_offset_polarity_vals),\r\nMPEG_DESCR_LOCAL_TIME_OFFSET_POLARITY, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_local_time_offset_offset, {\r\n"Local Time Offset", "mpeg_descr.local_time_offset.offset",\r\nFT_RELATIVE_TIME, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_local_time_offset_time_of_change, {\r\n"Time of Change", "mpeg_descr.local_time_offset.time_of_change",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_UTC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_local_time_offset_next_time_offset, {\r\n"Next Time Offset", "mpeg_descr.local_time_offset.next_time_offset",\r\nFT_RELATIVE_TIME, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_subtitling_lang_code, {\r\n"Language Code", "mpeg_descr.subtitling.lang_code",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_subtitling_type, {\r\n"Subtitling Type", "mpeg_descr.subtitling.type",\r\nFT_UINT8, BASE_HEX | BASE_EXT_STRING, &mpeg_descr_subtitling_type_vals_ext, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_subtitling_composition_page_id, {\r\n"Composition Page ID", "mpeg_descr.subtitling.composition_page_id",\r\nFT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_subtitling_ancillary_page_id, {\r\n"Ancillary Page ID", "mpeg_descr.subtitling.ancillary_page_id",\r\nFT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_terrestrial_delivery_centre_frequency, {\r\n"Centre Frequency", "mpeg_descr.terr_delivery.centre_freq",\r\nFT_UINT64, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_terrestrial_delivery_bandwidth, {\r\n"Bandwidth", "mpeg_descr.terr_delivery.bandwidth",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_terrestrial_delivery_bandwidth_vals),\r\nMPEG_DESCR_TERRESTRIAL_DELIVERY_BANDWIDTH_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_terrestrial_delivery_priority, {\r\n"Priority", "mpeg_descr.terr_delivery.priority",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_terrestrial_delivery_priority_vals),\r\nMPEG_DESCR_TERRESTRIAL_DELIVERY_PRIORITY_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_terrestrial_delivery_time_slicing_indicator, {\r\n"Time Slicing Indicator", "mpeg_descr.terr_delivery.time_slicing_ind",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_terrestrial_delivery_time_slicing_indicator_vals),\r\nMPEG_DESCR_TERRESTRIAL_DELIVERY_TIME_SLICING_INDICATOR_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_terrestrial_delivery_mpe_fec_indicator, {\r\n"MPE-FEC Indicator", "mpeg_descr.terr_delivery.mpe_fec_ind",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_terrestrial_delivery_mpe_fec_indicator_vals),\r\nMPEG_DESCR_TERRESTRIAL_DELIVERY_MPE_FEC_INDICATOR_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_terrestrial_delivery_reserved1, {\r\n"Reserved", "mpeg_descr.terr_delivery.reserved1",\r\nFT_UINT8, BASE_HEX, NULL, MPEG_DESCR_TERRESTRIAL_DELIVERY_RESERVED1_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_terrestrial_delivery_constellation, {\r\n"Constellation", "mpeg_descr.terr_delivery.constellation",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_terrestrial_delivery_constellation_vals),\r\nMPEG_DESCR_TERRESTRIAL_DELIVERY_CONSTELLATION_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_terrestrial_delivery_hierarchy_information, {\r\n"Hierarchy Information", "mpeg_descr.terr_delivery.hierarchy_information",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_terrestrial_delivery_hierarchy_information_vals),\r\nMPEG_DESCR_TERRESTRIAL_DELIVERY_HIERARCHY_INFORMATION_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_terrestrial_delivery_code_rate_hp_stream, {\r\n"Code Rate High Priority Stream", "mpeg_descr.terr_delivery.code_rate_hp_stream",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_terrestrial_delivery_code_rate_vals),\r\nMPEG_DESCR_TERRESTRIAL_DELIVERY_CODE_RATE_HP_STREAM_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_terrestrial_delivery_code_rate_lp_stream, {\r\n"Code Rate Low Priority Stream", "mpeg_descr.terr_delivery.code_rate_lp_stream",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_terrestrial_delivery_code_rate_vals),\r\nMPEG_DESCR_TERRESTRIAL_DELIVERY_CODE_RATE_LP_STREAM_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_terrestrial_delivery_guard_interval, {\r\n"Guard Interval", "mpeg_descr.terr_delivery.guard_interval",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_terrestrial_delivery_guard_interval_vals),\r\nMPEG_DESCR_TERRESTRIAL_DELIVERY_GUARD_INTERVAL_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_terrestrial_delivery_transmission_mode, {\r\n"Transmission Mode", "mpeg_descr.terr_delivery.transmission_mode",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_terrestrial_delivery_transmission_mode_vals),\r\nMPEG_DESCR_TERRESTRIAL_DELIVERY_TRANSMISSION_MODE_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_terrestrial_delivery_other_frequency_flag, {\r\n"Other Frequency Flag", "mpeg_descr.terr_delivery.other_freq_flag",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_terrestrial_delivery_other_frequency_flag_vals),\r\nMPEG_DESCR_TERRESTRIAL_DELIVERY_OTHER_FREQUENCY_FLAG_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_terrestrial_delivery_reserved2, {\r\n"Reserved", "mpeg_descr.terr_delivery.reserved2",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_private_data_specifier_id, {\r\n"Private Data Specifier", "mpeg_descr.private_data_specifier.id",\r\nFT_UINT32, BASE_HEX, VALS(mpeg_descr_data_specifier_id_vals), 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_data_bcast_bcast_id, {\r\n"Data Broadcast ID", "mpeg_descr.data_bcast.id",\r\nFT_UINT16, BASE_HEX | BASE_EXT_STRING, &mpeg_descr_data_bcast_id_vals_ext, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_data_bcast_component_tag, {\r\n"Component Tag", "mpeg_descr.data_bcast.component_tag",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_data_bcast_selector_len, {\r\n"Selector Length", "mpeg_descr.data_bcast.selector_len",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_data_bcast_selector_bytes, {\r\n"Selector Bytes", "mpeg_descr.data_bcast.selector_bytes",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_data_bcast_lang_code, {\r\n"Language Code", "mpeg_descr.data_bcast.lang_code",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_data_bcast_text_len, {\r\n"Text Length", "mpeg_descr.data_bcast.text_len",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_data_bcast_text, {\r\n"Text", "mpeg_descr.data_bcast.text",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_data_bcast_id_bcast_id, {\r\n"Data Broadcast ID", "mpeg_descr.data_bcast_id.id",\r\nFT_UINT16, BASE_HEX | BASE_EXT_STRING, &mpeg_descr_data_bcast_id_vals_ext, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_data_bcast_id_id_selector_bytes, {\r\n"ID Selector Bytes", "mpeg_descr.data_bcast_id.id_selector_bytes",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ac3_component_type_flag, {\r\n"Component Type Flag", "mpeg_descr.ac3.component_type_flag",\r\nFT_UINT8, BASE_DEC, VALS(mpeg_descr_ac3_component_type_flag_vals),\r\nMPEG_DESCR_AC3_COMPONENT_TYPE_FLAG_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ac3_bsid_flag, {\r\n"BSID Flag", "mpeg_descr.ac3.bsid_flag",\r\nFT_UINT8, BASE_DEC, VALS(mpeg_descr_ac3_bsid_flag_vals),\r\nMPEG_DESCR_AC3_BSID_FLAG_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ac3_mainid_flag, {\r\n"Main ID Flag", "mpeg_descr.ac3_main_id_flag",\r\nFT_UINT8, BASE_DEC, VALS(mpeg_descr_ac3_mainid_flag_vals),\r\nMPEG_DESCR_AC3_MAINID_FLAG_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ac3_asvc_flag, {\r\n"ASVC Flag", "mpeg_descr.ac3.asvc_flag",\r\nFT_UINT8, BASE_DEC, VALS(mpeg_descr_ac3_asvc_flag_vals),\r\nMPEG_DESCR_AC3_ASVC_FLAG_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ac3_reserved, {\r\n"Reserved", "mpeg_descr.ac3.reserved",\r\nFT_UINT8, BASE_HEX, NULL, MPEG_DESCR_AC3_RESERVED_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ac3_component_type_reserved_flag, {\r\n"Type Reserved Flag", "mpeg_descr.ac3.component_type.reserved_flag",\r\nFT_UINT8, BASE_HEX, NULL, MPEG_DESCR_AC3_COMPONENT_TYPE_RESERVED_FLAG_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ac3_component_type_full_service_flag, {\r\n"Full Service Flag", "mpeg_descr.ac3.component_type.full_service_flag",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_ac3_component_type_full_service_flag_vals),\r\nMPEG_DESCR_AC3_COMPONENT_TYPE_FULL_SERVICE_FLAG_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ac3_component_type_service_type_flags, {\r\n"Service Type Flags", "mpeg_descr.ac3.component_type.service_type_flags",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_ac3_component_type_service_type_flags_vals),\r\nMPEG_DESCR_AC3_COMPONENT_TYPE_SERVICE_TYPE_FLAGS_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ac3_component_type_number_of_channels_flags, {\r\n"Number of Channels Flags", "mpeg_descr.ac3.component_type.number_chan_flags",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_ac3_component_type_number_of_channels_flags_vals),\r\nMPEG_DESCR_AC3_COMPONENT_TYPE_NUMBER_OF_CHANNELS_FLAGS, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ac3_bsid, {\r\n"BSID", "mpeg_descr.ac3.bsid",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ac3_mainid, {\r\n"Main ID", "mpeg_descr.ac3.mainid",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ac3_asvc, {\r\n"ASVC", "mpeg_descr.ac3.asvc",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ac3_additional_info, {\r\n"Additional Info", "mpeg_descr.ac3.additional_info",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_app_sig_app_type, {\r\n"Application type", "mpeg_descr.app_sig.app_type",\r\nFT_UINT16, BASE_HEX, NULL, 0x7FFF, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_app_sig_ait_ver, {\r\n"AIT version", "mpeg_descr.app_sig.ait_ver",\r\nFT_UINT8, BASE_HEX, NULL, 0x3F, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_default_authority_name, {\r\n"Default Authority Name", "mpeg_descr.default_authority.name",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_content_identifier_crid_type, {\r\n"CRID Type", "mpeg_descr.content_identifier.crid_type",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_content_identifier_crid_type_vals),\r\nMPEG_DESCR_CONTENT_IDENTIFIER_CRID_TYPE_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_content_identifier_crid_location, {\r\n"CRID Location", "mpeg_descr.content_identifier.crid_location",\r\nFT_UINT8, BASE_HEX, VALS(mpeg_descr_content_identifier_crid_location_vals),\r\nMPEG_DESCR_CONTENT_IDENTIFIER_CRID_LOCATION_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_content_identifier_crid_length, {\r\n"CRID Length", "mpeg_descr.content_identifier.crid_len",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_content_identifier_crid_bytes, {\r\n"CRID Bytes", "mpeg_descr.content_identifier.crid_bytes",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_content_identifier_cird_ref, {\r\n"CRID Reference", "mpeg_descr.content_identifier.crid_ref",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_extension_tag_extension, {\r\n"Descriptor Tag Extension", "mpeg_descr.ext.tag",\r\nFT_UINT8, BASE_HEX | BASE_EXT_STRING, &mpeg_descr_extension_tag_extension_vals_ext, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_extension_data, {\r\n"Descriptor Extension Data", "mpeg_descr.ext.data",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_extension_supp_audio_mix_type, {\r\n"Mix type", "mpeg_descr.ext.supp_audio.mix_type",\r\nFT_UINT8, BASE_HEX, VALS(supp_audio_mix_type_vals), 0x80, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_extension_supp_audio_ed_cla, {\r\n"Editorial classification", "mpeg_descr.ext.supp_audio.ed_cla",\r\nFT_UINT8, BASE_HEX, VALS(supp_audio_ed_cla), 0x7C, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_extension_supp_audio_lang_code_present, {\r\n"Language code present", "mpeg_descr.ext.supp_audio.lang_code_present",\r\nFT_UINT8, BASE_HEX, NULL, 0x01, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_extension_supp_audio_lang_code, {\r\n"ISO 639 language code", "mpeg_descr.ext.supp_audio.lang_code",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_private_data, {\r\n"Private data", "mpeg_descr.private_data",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_group_id, {\r\n"Group ID", "mpeg_descr.logon_init.group_id",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_logon_id, {\r\n"Logon ID", "mpeg_descr.logon_init.logon_id",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_continuous_carrier_reserved, {\r\n"Continuous Carrier Reserved", "mpeg_descr.logon_init.continuous_carrier_reserved",\r\nFT_UINT8, BASE_HEX, NULL, MPEG_DESCR_LOGON_INITIALIZE_CONTINUOUS_CARRIER_RESERVED_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_continuous_carrier, {\r\n"Continuous Carrier", "mpeg_descr.logon_init.continuous_carrier",\r\nFT_UINT8, BASE_DEC, NULL, MPEG_DESCR_LOGON_INITIALIZE_CONTINUOUS_CARRIER_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_security_handshake_required, {\r\n"Security Handshake Required", "mpeg_descr.logon_init.security_handshake_required",\r\nFT_UINT8, BASE_DEC, NULL, MPEG_DESCR_LOGON_INITIALIZE_SECURITY_HANDSHAKE_REQUIRED_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_prefix_flag, {\r\n"Prefix Flag", "mpeg_descr.logon_init.prefix_flag",\r\nFT_UINT8, BASE_DEC, NULL, MPEG_DESCR_LOGON_INITIALIZE_PREFIX_FLAG_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_data_unit_labelling_flag, {\r\n"Unit Labelling Flag", "mpeg_descr.logon_init.data_unit_labelling_flag",\r\nFT_UINT8, BASE_DEC, NULL, MPEG_DESCR_LOGON_INITIALIZE_DATA_UNIT_LABELLING_FLAG_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_mini_slot_flag, {\r\n"Mini Slot Flag", "mpeg_descr.logon_init.mini_slot_flag",\r\nFT_UINT8, BASE_DEC, NULL, MPEG_DESCR_LOGON_INITIALIZE_MINI_SLOT_FLAG_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_contention_based_mini_slot_flag, {\r\n"Contention Based Mini Slot Flag", "mpeg_descr.logon_init.contention_based_mini_slot_flag",\r\nFT_UINT8, BASE_DEC, NULL, MPEG_DESCR_LOGON_INITIALIZE_CONTENTION_BASED_MINI_SLOT_FLAG_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_capacity_type_flag_reserved, {\r\n"Capacity Type Flag Reserved", "mpeg_descr.logon_init.capactity_type_flag_reserved",\r\nFT_UINT8, BASE_DEC, NULL, MPEG_DESCR_LOGON_INITIALIZE_CAPACITY_TYPE_FLAG_RESERVED_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_capacity_type_flag, {\r\n"Capacity Type Flag", "mpeg_descr.logon_init.capactity_type_flag",\r\nFT_UINT8, BASE_DEC, NULL, MPEG_DESCR_LOGON_INITIALIZE_CAPACITY_TYPE_FLAG_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_traffic_burst_type, {\r\n"Traffic Burst Type", "mpeg_descr.logon_init.traffic_burst_type",\r\nFT_UINT8, BASE_DEC, NULL, MPEG_DESCR_LOGON_INITIALIZE_TRAFFIC_BURST_TYPE_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_return_trf_pid, {\r\n"Return TRF PID", "mpeg_descr.logon_init.return_trf_pid",\r\nFT_UINT16, BASE_HEX, NULL, MPEG_DESCR_LOGON_INITIALIZE_RETURN_TRF_PID_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_return_ctrl_mngm_pid_reserved, {\r\n"Return CTRL MNGM PID Reserved", "mpeg_descr.logon_init.return_mngm_pid_reserved",\r\nFT_UINT16, BASE_HEX, NULL, MPEG_DESCR_LOGON_INITIALIZE_RETURN_CTRL_MNGM_PID_RESERVED_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_return_ctrl_mngm_pid, {\r\n"Return CTRL MNGM PID", "mpeg_descr.logon_init.return_mngm_pid",\r\nFT_UINT16, BASE_HEX, NULL, MPEG_DESCR_LOGON_INITIALIZE_RETURN_CTRL_MNGM_PID_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_connectivity, {\r\n"Connectivity", "mpeg_descr.logon_init.connectivity",\r\nFT_UINT16, BASE_HEX, NULL, MPEG_DESCR_LOGON_INITIALIZE_CONNECTIVITY_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_return_vpi_reserved, {\r\n"Return VPI Reserved", "mpeg_descr.logon_init.return_vpi_reserved",\r\nFT_UINT8, BASE_HEX, NULL, MPEG_DESCR_LOGON_INITIALIZE_RETURN_VPI_RESERVED_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_return_vpi, {\r\n"Return VPI", "mpeg_descr.logon_init.return_vpi",\r\nFT_UINT8, BASE_HEX, NULL, MPEG_DESCR_LOGON_INITIALIZE_RETURN_VPI_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_return_vci, {\r\n"Return VCI", "mpeg_descr.logon_init.return_vci",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_return_signalling_vpi_reserved, {\r\n"Return Signalling VPI Reserved", "mpeg_descr.logon_init.return_signalling_vpi_reserved",\r\nFT_UINT8, BASE_HEX, NULL, MPEG_DESCR_LOGON_INITIALIZE_RETURN_SIGNALLING_VPI_RESERVED_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_return_signalling_vpi, {\r\n"Return Signalling VPI", "mpeg_descr.logon_init.return_signalling_vpi",\r\nFT_UINT8, BASE_HEX, NULL, MPEG_DESCR_LOGON_INITIALIZE_RETURN_SIGNALLING_VPI_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_return_signalling_vci, {\r\n"Return Signalling VCI", "mpeg_descr.logon_init.return_signalling_vci",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_forward_signalling_vpi_reserved, {\r\n"Forward Signalling VPI Reserved", "mpeg_descr.logon_init.forward_signalling_vpi_reserved",\r\nFT_UINT8, BASE_HEX, NULL, MPEG_DESCR_LOGON_INITIALIZE_RETURN_SIGNALLING_VPI_RESERVED_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_forward_signalling_vpi, {\r\n"Forward Signalling VPI", "mpeg_descr.logon_init.forward_signalling_vpi",\r\nFT_UINT8, BASE_HEX, NULL, MPEG_DESCR_LOGON_INITIALIZE_RETURN_SIGNALLING_VPI_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_forward_signalling_vci, {\r\n"Forward Signalling VCI", "mpeg_descr.logon_init.forward_signalling_vci",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_cra_level, {\r\n"CRA Level", "mpeg_descr.logon_init.cra_level",\r\nFT_UINT24, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_vbdc_max_reserved, {\r\n"VDBC Max Reserved", "mpeg_descr.logon_init.vdbc_max_reserved",\r\nFT_UINT16, BASE_HEX, NULL, MPEG_DESCR_LOGON_INITIALIZE_VDBC_MAX_RESERVED_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_vbdc_max, {\r\n"VDBC Max", "mpeg_descr.logon_init.vdbc_max",\r\nFT_UINT16, BASE_DEC, NULL, MPEG_DESCR_LOGON_INITIALIZE_VDBC_MAX_MASK, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_rbdc_max, {\r\n"RDBC Max", "mpeg_descr.logon_init.rdbc_max",\r\nFT_UINT24, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_logon_initialize_rbdc_timeout, {\r\n"RDBC Timeout", "mpeg_descr.logon_init.rdbc_timeout",\r\nFT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_rcs_content_table_id, {\r\n"Table ID", "mpeg_descr.rcs_content.tid",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ciplus_cl_cb_min, {\r\n"Content byte minimum value", "mpeg_descr.ciplus_content_label.content_byte_min",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ciplus_cl_cb_max, {\r\n"Content byte maximum value", "mpeg_descr.ciplus_content_label.content_byte_max",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ciplus_cl_lang, {\r\n"ISO 639 language code", "mpeg_descr.ciplus_content_label.lang_code",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ciplus_cl_label, {\r\n"Content label", "mpeg_descr.ciplus_content_label.label",\r\nFT_STRING, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ciplus_svc_id, {\r\n"Service ID", "mpeg_descr.ciplus_svc.id",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ciplus_svc_type, {\r\n"Service type", "mpeg_descr.ciplus_svc.type",\r\nFT_UINT8, BASE_HEX | BASE_EXT_STRING, &mpeg_descr_service_type_vals_ext, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ciplus_svc_visible, {\r\n"Visible Service Flag", "mpeg_descr.ciplus_svc.visible",\r\nFT_UINT16, BASE_HEX, NULL, 0x8000, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ciplus_svc_selectable, {\r\n"Selectable Service Flag", "mpeg_descr.ciplus_svc.selectable",\r\nFT_UINT16, BASE_HEX, NULL, 0x4000, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ciplus_svc_lcn, {\r\n"Logical Channel Number", "mpeg_descr.ciplus_svc.lcn",\r\nFT_UINT16, BASE_DEC, NULL, 0x3FFF, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ciplus_svc_prov_name, {\r\n"Service Provider Name", "mpeg_descr.ciplus_svc.provider_name",\r\nFT_UINT_STRING, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ciplus_svc_name, {\r\n"Service Name", "mpeg_descr.ciplus_svc.name",\r\nFT_UINT_STRING, BASE_NONE, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ciplus_prot_free_ci_mode, {\r\n"Free CI mode", "mpeg_descr.ciplus_prot.free_ci_mode",\r\nFT_BOOLEAN, 8, TFS(&tfs_prot_noprot), 0x80, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ciplus_prot_match_brand_flag, {\r\n"Match brand flag", "mpeg_descr.ciplus_prot.match_brand_flag",\r\nFT_BOOLEAN, 8, TFS(&tfs_enabled_disabled), 0x40, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ciplus_prot_num_entries, {\r\n"Number of entries", "mpeg_descr.ciplus_prot.num_entries",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL\r\n} },\r\n{ &hf_mpeg_descr_ciplus_prot_brand_id, {\r\n"CICAM brand identifier", "mpeg_descr.ciplus_prot.brand_id",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL\r\n} }\r\n};\r\nstatic gint *ett[] = {\r\n&ett_mpeg_descriptor,\r\n&ett_mpeg_descriptor_extended_event_item,\r\n&ett_mpeg_descriptor_component_content_type,\r\n&ett_mpeg_descriptor_content_nibble,\r\n&ett_mpeg_descriptor_vbi_data_service,\r\n&ett_mpeg_descriptor_content_identifier_crid,\r\n&ett_mpeg_descriptor_service_list,\r\n&ett_mpeg_descriptor_ac3_component_type,\r\n&ett_mpeg_descriptor_linkage_population_id\r\n};\r\nproto_mpeg_descriptor = proto_register_protocol("MPEG2 Descriptors", "MPEG Descriptor", "mpeg_descr");\r\nproto_register_field_array(proto_mpeg_descriptor, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}
