static const gchar* dissect_fields_unknown(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info _U_) {\r\nproto_item* pi = proto_tree_add_item(tree,hf_alcap_unknown,tvb,offset,len,ENC_NA);\r\nexpert_add_info(pinfo, pi, &ei_alcap_undecoded);\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_cau(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info) {\r\nguint coding;\r\nconst gchar* ret_str;\r\nproto_item* pi;\r\nif (len < 2) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\nmsg_info->release_cause = tvb_get_guint8(tvb, offset+1) & 0x7f;\r\ncoding = tvb_get_guint8(tvb, offset) & 0x3;\r\nproto_tree_add_item(tree, hf_alcap_cau_coding, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nif (coding == 0) {\r\npi = proto_tree_add_item(tree, hf_alcap_cau_value_itu, tvb, offset+1, 1, ENC_BIG_ENDIAN);\r\nif ( msg_info->release_cause && msg_info->release_cause != 31 )\r\nexpert_add_info(pinfo, pi, &ei_alcap_abnormal_release);\r\nret_str = val_to_str(msg_info->release_cause, cause_values_itu, "Unknown(%u)");\r\n} else {\r\nproto_tree_add_item(tree, hf_alcap_cau_value_non_itu, tvb, offset+1 , 1, ENC_BIG_ENDIAN);\r\nret_str = wmem_strdup_printf(wmem_packet_scope(), "%u", msg_info->release_cause);\r\n}\r\nif (!tree) return ret_str;\r\noffset += 2;\r\nif (len > 2) {\r\nint diag_len = tvb_get_guint8(tvb,offset);\r\npi = proto_tree_add_item(tree,hf_alcap_cau_diag, tvb, offset,len-2,ENC_NA);\r\ntree = proto_item_add_subtree(pi,ett_cau_diag);\r\nproto_tree_add_item(tree, hf_alcap_cau_diag_len, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nif (diag_len) {\r\nswitch (msg_info->release_cause) {\r\ncase 97:\r\ncase 99:\r\ncase 110:\r\nproto_tree_add_item(tree, hf_alcap_cau_diag_msg, tvb, ++offset, 1, ENC_BIG_ENDIAN);\r\nwhile(diag_len >= 2) {\r\nproto_tree_add_item(tree, hf_alcap_cau_diag_param_id, tvb, ++offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_cau_diag_field_num, tvb, ++offset, 1, ENC_BIG_ENDIAN);\r\ndiag_len -= 2;\r\n}\r\nbreak;\r\ndefault:\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_undecoded, tvb, offset, diag_len);\r\nbreak;\r\n}\r\n}\r\n}\r\nreturn ret_str;\r\n}\r\nstatic const gchar* dissect_fields_ceid(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info) {\r\nproto_item* pi;\r\nif (len != 5) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\npi = proto_tree_add_item(tree,hf_alcap_ceid_pathid,tvb,offset,4,ENC_BIG_ENDIAN);\r\nmsg_info->pathid = tvb_get_ntohl(tvb,offset);\r\nmsg_info->cid = tvb_get_guint8(tvb,offset+4);\r\nif (msg_info->pathid == 0) {\r\nproto_item_append_text(pi," (All Paths in association)");\r\nreturn "Path: 0 (All Paths)";\r\n}\r\npi = proto_tree_add_item(tree,hf_alcap_ceid_cid,tvb,offset+4,1,ENC_BIG_ENDIAN);\r\nif (msg_info->cid == 0) {\r\nproto_item_append_text(pi," (All CIDs in the Path)");\r\nreturn wmem_strdup_printf(wmem_packet_scope(), "Path: %u CID: 0 (Every CID)",msg_info->pathid);\r\n} else {\r\nreturn wmem_strdup_printf(wmem_packet_scope(), "Path: %u CID: %u",msg_info->pathid,msg_info->cid);\r\n}\r\n}\r\nstatic const gchar* dissect_fields_desea(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info _U_) {\r\ne164_info_t* e164;\r\nif (len < 2) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\ne164 = wmem_new(wmem_packet_scope(), e164_info_t);\r\ne164->e164_number_type = CALLED_PARTY_NUMBER;\r\ne164->nature_of_address = tvb_get_guint8(tvb,offset) & 0x7f;\r\ne164->E164_number_str = (gchar*)tvb_get_string_enc(wmem_packet_scope(),tvb,offset+1,len,ENC_ASCII|ENC_NA);\r\ne164->E164_number_length = len-1;\r\ndissect_e164_number(tvb, tree, offset-1, len, *e164);\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_oesea(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info _U_) {\r\ne164_info_t* e164;\r\nif (len < 2) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\ne164 = wmem_new(wmem_packet_scope(), e164_info_t);\r\ne164->e164_number_type = CALLING_PARTY_NUMBER;\r\ne164->nature_of_address = tvb_get_guint8(tvb,offset) & 0x7f;\r\ne164->E164_number_str = (gchar*)tvb_get_string_enc(wmem_packet_scope(),tvb,offset+1,len,ENC_ASCII|ENC_NA);\r\ne164->E164_number_length = len-1;\r\ndissect_e164_number(tvb, tree, offset-1, len, *e164);\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_dnsea(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info) {\r\nif (len < 1) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\nmsg_info->dest_nsap = tvb_bytes_to_str(wmem_packet_scope(), tvb,offset,20);\r\nproto_tree_add_item(tree, hf_alcap_dnsea, tvb, offset, 20, ENC_NA);\r\ndissect_nsap(tvb, offset,20, tree);\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_onsea(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info) {\r\nif (len < 1) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\nmsg_info->orig_nsap = tvb_bytes_to_str(wmem_packet_scope(), tvb,offset,20);\r\nproto_tree_add_item(tree, hf_alcap_onsea, tvb, offset, 20, ENC_NA);\r\ndissect_nsap(tvb, offset,20, tree);\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_alc(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info _U_) {\r\nif (len != 12) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\nproto_tree_add_item(tree, hf_alcap_alc_max_br_fw, tvb, offset+0, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_alc_max_br_bw, tvb, offset+2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_alc_avg_br_fw, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_alc_avg_br_bw, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_alc_max_sdu_fw, tvb, offset+8, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_alc_max_sdu_bw, tvb, offset+9, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_alc_avg_sdu_fw, tvb, offset+10, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_alc_avg_sdu_bw, tvb, offset+11, 1, ENC_BIG_ENDIAN);\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_plc(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info _U_) {\r\nif (len != 12) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\nproto_tree_add_item(tree, hf_alcap_plc_max_br_fw, tvb, offset+0, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_plc_max_br_bw, tvb, offset+2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_plc_avg_br_fw, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_plc_avg_br_bw, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_plc_max_sdu_fw, tvb, offset+8, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_plc_max_sdu_bw, tvb, offset+9, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_plc_avg_sdu_fw, tvb, offset+10, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_plc_avg_sdu_bw, tvb, offset+11, 1, ENC_BIG_ENDIAN);\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_osaid(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info) {\r\nif (len != 4) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\nmsg_info->osaid = tvb_get_ntohl(tvb,offset);\r\nproto_tree_add_item(tree, hf_alcap_osaid, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_sugr(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info) {\r\nif (len != 4) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\nmsg_info->sugr = tvb_get_ntohl(tvb,offset);\r\nproto_tree_add_item(tree, hf_alcap_sugr, tvb, offset, 4, ENC_NA);\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_suci(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info _U_) {\r\nif (len != 4) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\nproto_tree_add_item(tree, hf_alcap_suci, tvb, offset, len, ENC_BIG_ENDIAN);\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_ssia(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info _U_) {\r\nif (len != 8) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\nproto_tree_add_item(tree, hf_alcap_ssia_pr_type, tvb, offset+0,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_ssia_pr_id, tvb, offset+2,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_ssia_frm, tvb, offset+3,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_ssia_cmd, tvb, offset+3,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_ssia_mfr2, tvb, offset+3,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_ssia_mfr1, tvb, offset+3,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_ssia_dtmf, tvb, offset+3,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_ssia_cas, tvb, offset+3,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_ssia_fax, tvb, offset+3,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_ssia_pcm, tvb, offset+3,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_ssia_max_len, tvb, offset+4,2,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_ssia_oui, tvb, offset+5,3,ENC_NA);\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_ssim(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info _U_) {\r\nif (len != 3) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\nproto_tree_add_item(tree,hf_alcap_ssim_frm,tvb,offset,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_ssim_mult,tvb,offset,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_ssim_max,tvb,offset+1,2,ENC_BIG_ENDIAN);\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_ssisa(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info _U_) {\r\nif (len != 14) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\nproto_tree_add_item(tree,hf_alcap_ssisa_max_sssar_fw,tvb,offset,3,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_ssisa_max_sssar_bw,tvb,offset+3,3,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_ssisa_max_sscop_sdu_fw,tvb,offset+6,2,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_ssisa_max_sscop_sdu_bw,tvb,offset+8,2,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_ssisa_max_sscop_uu_fw,tvb,offset+10,2,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_ssisa_max_sscop_uu_bw,tvb,offset+12,2,ENC_BIG_ENDIAN);\r\nproto_tree_add_expert_format(tree,pinfo,&ei_alcap_undecoded,tvb,offset,14,"Not yet decoded: Q.2630.1 7.4.8");\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_ssisu(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info _U_) {\r\nif (len != 7) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\nproto_tree_add_item(tree,hf_alcap_ssisu_max_sssar_fw,tvb,offset,3,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_ssisu_max_sssar_bw,tvb,offset+3,3,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_ssisu_ted,tvb,offset+6,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_expert_format(tree,pinfo,&ei_alcap_undecoded,tvb,offset,7,"Not yet decoded: Q.2630.1 7.4.9");\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_none(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info _U_) {\r\nif (len != 0) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_ssiae(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info _U_) {\r\nif (len != 8) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\nproto_tree_add_item(tree, hf_alcap_ssiae_pr_type, tvb, offset,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_ssiae_lb, tvb, offset,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_ssiae_rc, tvb, offset,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_ssiae_syn, tvb, offset,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_ssiae_pr_id, tvb, offset+1,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_ssiae_frm, tvb, offset+3,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_ssiae_cmd, tvb, offset+3,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_ssiae_mfr2, tvb, offset+3,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_ssiae_mfr1, tvb, offset+3,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_ssiae_dtmf, tvb, offset+3,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_ssiae_cas, tvb, offset+3,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_ssiae_fax, tvb, offset+3,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_ssiae_pcm, tvb, offset+3,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_ssiae_max_len, tvb, offset+4,2,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_ssiae_oui, tvb, offset+5,3,ENC_NA);\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_pssiae(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info _U_) {\r\nif (len != 8) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\nproto_tree_add_item(tree, hf_alcap_pssiae_pr_type, tvb, offset,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_pssiae_lb, tvb, offset,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_pssiae_rc, tvb, offset,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_pssiae_syn, tvb, offset,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_pssiae_pr_id, tvb, offset+1,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_pssiae_frm, tvb, offset+3,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_pssiae_cmd, tvb, offset+3,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_pssiae_mfr2, tvb, offset+3,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_pssiae_mfr1, tvb, offset+3,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_pssiae_dtmf, tvb, offset+3,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_pssiae_cas, tvb, offset+3,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_pssiae_fax, tvb, offset+3,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_pssiae_pcm, tvb, offset+3,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_pssiae_max_len, tvb, offset+4,2,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_pssiae_oui, tvb, offset+5,3,ENC_NA);\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_ssime(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info _U_) {\r\nif (len != 3) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\nproto_tree_add_item(tree,hf_alcap_ssime_frm,tvb,offset,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_ssime_lb,tvb,offset,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_ssime_mult,tvb,offset,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_ssime_max,tvb,offset+1,2,ENC_BIG_ENDIAN);\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_pssime(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info _U_) {\r\nif (len != 3) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\nproto_tree_add_item(tree,hf_alcap_pssime_frm,tvb,offset,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_pssime_lb,tvb,offset,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_pssime_mult,tvb,offset,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_pssime_max,tvb,offset+1,2,ENC_BIG_ENDIAN);\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_acc(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info _U_) {\r\nif (len != 1) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\nproto_tree_add_item(tree,hf_alcap_acc_level,tvb,offset,len,ENC_BIG_ENDIAN);\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_cp(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info _U_) {\r\nif (len != 1) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\nproto_tree_add_item(tree,hf_alcap_cp,tvb,offset,len,ENC_BIG_ENDIAN);\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_pt(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info _U_) {\r\nif (len != 1) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\nproto_tree_add_item(tree,hf_alcap_pt,tvb,offset,len,ENC_BIG_ENDIAN);\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_hc(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info _U_) {\r\nif (len != 1) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\nproto_tree_add_item(tree,hf_alcap_hc,tvb,offset,len,ENC_BIG_ENDIAN);\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_fbw(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info _U_) {\r\nif (len != 12) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\nproto_tree_add_item(tree,hf_alcap_fbw_br_fw,tvb,offset,3,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_fbw_br_bw,tvb,offset+3,3,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_fbw_bucket_fw,tvb,offset+6,2,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_fbw_bucket_bw,tvb,offset+8,2,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_fbw_size_fw,tvb,offset+10,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_fbw_size_bw,tvb,offset+11,1,ENC_BIG_ENDIAN);\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_pfbw(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info _U_) {\r\nif (len != 12) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\nproto_tree_add_item(tree,hf_alcap_pfbw_br_fw,tvb,offset,3,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_pfbw_br_bw,tvb,offset+3,3,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_pfbw_bucket_fw,tvb,offset+6,2,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_pfbw_bucket_bw,tvb,offset+8,2,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_pfbw_size_fw,tvb,offset+10,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_pfbw_size_bw,tvb,offset+11,1,ENC_BIG_ENDIAN);\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_vbws(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info _U_) {\r\nif (len != 13) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\nproto_tree_add_item(tree,hf_alcap_vbws_br_fw,tvb,offset,3,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_vbws_br_bw,tvb,offset+3,3,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_vbws_bucket_fw,tvb,offset+6,2,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_vbws_bucket_bw,tvb,offset+8,2,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_vbws_size_fw,tvb,offset+10,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_vbws_size_bw,tvb,offset+11,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_vbws_size_bw,tvb,offset+11,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_vbws_stt,tvb,offset+12,1,ENC_BIG_ENDIAN);\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_pvbws(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info _U_) {\r\nif (len != 13) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\nproto_tree_add_item(tree,hf_alcap_pvbws_br_fw,tvb,offset,3,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_pvbws_br_bw,tvb,offset+3,3,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_pvbws_bucket_fw,tvb,offset+6,2,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_pvbws_bucket_bw,tvb,offset+8,2,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_pvbws_size_fw,tvb,offset+10,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_pvbws_size_bw,tvb,offset+11,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_pvbws_size_bw,tvb,offset+11,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_pvbws_stt,tvb,offset+12,1,ENC_BIG_ENDIAN);\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_pvbwt(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info _U_) {\r\nif (len != 22) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\nproto_tree_add_item(tree,hf_alcap_pvbwt_peak_br_fw,tvb,offset,3,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_pvbwt_peak_br_bw,tvb,offset+3,3,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_pvbwt_peak_bucket_fw,tvb,offset+6,2,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_pvbwt_peak_bucket_bw,tvb,offset+8,2,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_pvbwt_sust_br_fw,tvb,offset+10,3,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_pvbwt_sust_br_bw,tvb,offset+13,3,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_pvbwt_sust_bucket_fw,tvb,offset+16,2,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_pvbwt_sust_bucket_bw,tvb,offset+18,2,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_pvbwt_size_fw,tvb,offset+20,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_pvbwt_size_bw,tvb,offset+21,1,ENC_BIG_ENDIAN);\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_vbwt(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info _U_) {\r\nif (len != 22) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\nproto_tree_add_item(tree,hf_alcap_vbwt_peak_br_fw,tvb,offset,3,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_vbwt_peak_br_bw,tvb,offset+3,3,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_vbwt_peak_bucket_fw,tvb,offset+6,2,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_vbwt_peak_bucket_bw,tvb,offset+8,2,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_vbwt_sust_br_fw,tvb,offset+10,3,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_vbwt_sust_br_bw,tvb,offset+13,3,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_vbwt_sust_bucket_fw,tvb,offset+16,2,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_vbwt_sust_bucket_bw,tvb,offset+18,2,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_vbwt_size_fw,tvb,offset+20,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,hf_alcap_vbwt_size_bw,tvb,offset+21,1,ENC_BIG_ENDIAN);\r\nreturn NULL;\r\n}\r\nstatic const gchar* dissect_fields_sut(packet_info* pinfo, tvbuff_t *tvb, proto_tree *tree, int offset, int len, alcap_message_info_t* msg_info _U_) {\r\nguint sut_len;\r\nif (len < 2) {\r\nproto_tree_add_expert(tree, pinfo, &ei_alcap_parameter_field_bad_length, tvb, offset, len);\r\nreturn NULL;\r\n}\r\nsut_len = tvb_get_guint8(tvb,offset);\r\nproto_tree_add_item(tree, hf_alcap_sut_len, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_alcap_sut, tvb, offset, sut_len, ENC_NA);\r\nreturn NULL;\r\n}\r\nstatic void alcap_leg_tree(proto_tree* tree, tvbuff_t* tvb, packet_info *pinfo, const alcap_leg_info_t* leg) {\r\nproto_item* pi;\r\ntree = proto_tree_add_subtree(tree,tvb,0,0,ett_leg,NULL,"[ALCAP Leg Info]");\r\nif (leg->dsaid) {\r\npi = proto_tree_add_uint(tree,hf_alcap_leg_dsaid,tvb,0,0,leg->dsaid);\r\nPROTO_ITEM_SET_GENERATED(pi);\r\n}\r\nif (leg->osaid) {\r\npi = proto_tree_add_uint(tree,hf_alcap_leg_osaid,tvb,0,0,leg->osaid);\r\nPROTO_ITEM_SET_GENERATED(pi);\r\n}\r\nif (leg->pathid) {\r\npi = proto_tree_add_uint(tree,hf_alcap_leg_pathid,tvb,0,0,leg->pathid);\r\nPROTO_ITEM_SET_GENERATED(pi);\r\n}\r\nif (leg->cid) {\r\npi = proto_tree_add_uint(tree,hf_alcap_leg_cid,tvb,0,0,leg->cid);\r\nPROTO_ITEM_SET_GENERATED(pi);\r\n}\r\nif (leg->sugr) {\r\npi = proto_tree_add_uint(tree,hf_alcap_leg_sugr,tvb,0,0,leg->sugr);\r\nPROTO_ITEM_SET_GENERATED(pi);\r\n}\r\nif (leg->orig_nsap) {\r\npi = proto_tree_add_string(tree,hf_alcap_leg_onsea,tvb,0,0,leg->orig_nsap);\r\nPROTO_ITEM_SET_GENERATED(pi);\r\n}\r\nif (leg->dest_nsap) {\r\npi = proto_tree_add_string(tree,hf_alcap_leg_dnsea,tvb,0,0,leg->dest_nsap);\r\nPROTO_ITEM_SET_GENERATED(pi);\r\n}\r\nif(leg->release_cause) {\r\npi = proto_tree_add_uint(tree,hf_alcap_leg_release_cause,tvb,0,0,leg->release_cause);\r\nPROTO_ITEM_SET_GENERATED(pi);\r\nif (leg->release_cause && leg->release_cause != 31)\r\nexpert_add_info(pinfo, pi, &ei_alcap_release_cause_not31);\r\n}\r\nif(leg->msgs) {\r\nalcap_msg_data_t* msg = leg->msgs;\r\nproto_item* pi_local;\r\nproto_tree* tree_local = proto_tree_add_subtree(tree,tvb,0,0,ett_leg,&pi_local,"[Messages in this leg]");\r\ndo {\r\npi_local = proto_tree_add_uint(tree_local,hf_alcap_leg_frame,tvb,0,0,msg->framenum);\r\nproto_item_set_text(pi_local,"%s in frame %u",\r\nval_to_str_ext_const(msg->msg_type,&msg_type_strings_ext,"Unknown message"),\r\nmsg->framenum);\r\nPROTO_ITEM_SET_GENERATED(pi_local);\r\n} while (( msg = msg->next));\r\n}\r\n}\r\nextern void alcap_tree_from_bearer_key(proto_tree* tree, tvbuff_t* tvb, packet_info *pinfo, const gchar* key) {\r\nalcap_leg_info_t* leg = (alcap_leg_info_t*)wmem_tree_lookup_string(legs_by_bearer,key,0);\r\nif (leg) {\r\nalcap_leg_tree(tree,tvb,pinfo,leg);\r\n}\r\n}\r\nstatic int dissect_alcap(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_) {\r\nproto_tree *alcap_tree = NULL;\r\nalcap_message_info_t* msg_info = wmem_new0(wmem_packet_scope(), alcap_message_info_t);\r\nint len = tvb_reported_length(tvb);\r\nint offset;\r\nproto_item* pi;\r\nproto_tree* compat_tree;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, alcap_proto_name_short);\r\nif (tree) {\r\nproto_item *alcap_item = proto_tree_add_item(tree, proto_alcap, tvb, 0, -1, ENC_NA);\r\nalcap_tree = proto_item_add_subtree(alcap_item, ett_alcap);\r\n}\r\nproto_tree_add_item(alcap_tree,hf_alcap_dsaid,tvb,0,4,ENC_BIG_ENDIAN);\r\npi = proto_tree_add_item(alcap_tree,hf_alcap_msg_id,tvb,4,1,ENC_BIG_ENDIAN);\r\nmsg_info->dsaid = tvb_get_ntohl(tvb, 0);\r\nmsg_info->msg_type = tvb_get_guint8(tvb, 4);\r\nexpert_add_info(pinfo, pi, &ei_alcap_response);\r\ncol_set_str(pinfo->cinfo, COL_INFO, val_to_str_const(msg_info->msg_type, msg_type_strings, "Unknown Message"));\r\npi = proto_tree_add_item(alcap_tree,hf_alcap_compat,tvb,5,1,ENC_NA);\r\ncompat_tree = proto_item_add_subtree(pi,ett_compat);\r\nproto_tree_add_item(compat_tree,hf_alcap_compat_pass_on_sni,tvb,5,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(compat_tree,hf_alcap_compat_pass_on_ii,tvb,5,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(compat_tree,hf_alcap_compat_general_sni,tvb,5,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(compat_tree,hf_alcap_compat_general_ii,tvb,5,1,ENC_BIG_ENDIAN);\r\nlen -= ALCAP_MSG_HEADER_LEN;\r\noffset = ALCAP_MSG_HEADER_LEN;\r\nwhile(len > 0) {\r\nguint param_id = tvb_get_guint8(tvb,offset);\r\nguint param_len = tvb_get_guint8(tvb,offset+2);\r\nconst alcap_param_info_t* param_info = GET_PARAM_INFO(param_id);\r\nproto_tree* param_tree;\r\nconst gchar* colinfo_str = NULL;\r\npi = proto_tree_add_item(alcap_tree,hf_alcap_param_id,tvb,offset,1,ENC_BIG_ENDIAN);\r\nparam_tree = proto_item_add_subtree(pi,param_info->ett);\r\npi = proto_tree_add_item(param_tree,hf_alcap_compat,tvb,offset+1,1,ENC_NA);\r\ncompat_tree = proto_item_add_subtree(pi,ett_compat);\r\nproto_tree_add_item(compat_tree,hf_alcap_compat_pass_on_sni,tvb,offset+1,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(compat_tree,hf_alcap_compat_pass_on_ii,tvb,offset+1,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(compat_tree,hf_alcap_compat_general_sni,tvb,offset+1,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(compat_tree,hf_alcap_compat_general_ii,tvb,offset+1,1,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(param_tree,hf_alcap_param_len,tvb,offset+2,1,ENC_BIG_ENDIAN);\r\nif ( alcap_tree || param_info->run_wo_tree )\r\ncolinfo_str = param_info->dissect_fields(pinfo,tvb,param_tree,offset+3,param_len,msg_info);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " %s",colinfo_str);\r\nlen -= 3 + param_len;\r\noffset += 3 + param_len;\r\n}\r\nif (keep_persistent_info) {\r\nalcap_leg_info_t* leg = NULL;\r\nswitch (msg_info->msg_type) {\r\ncase 5:\r\nif( ! ( leg = (alcap_leg_info_t*)wmem_tree_lookup32(legs_by_osaid,msg_info->osaid) )) {\r\nleg = wmem_new(wmem_file_scope(), alcap_leg_info_t);\r\nleg->dsaid = 0;\r\nleg->osaid = msg_info->osaid;\r\nleg->pathid = msg_info->pathid;\r\nleg->cid = msg_info->cid;\r\nleg->sugr = msg_info->sugr;\r\nleg->orig_nsap = NULL;\r\nleg->dest_nsap = NULL;\r\nif (msg_info->orig_nsap) {\r\ngchar* key = wmem_strdup_printf(wmem_file_scope(), "%s:%.8X",msg_info->orig_nsap,leg->sugr);\r\nascii_strdown_inplace(key);\r\nleg->orig_nsap = wmem_strdup(wmem_file_scope(), msg_info->orig_nsap);\r\nif (!wmem_tree_lookup_string(legs_by_bearer,key,0)) {\r\nwmem_tree_insert_string(legs_by_bearer,key,leg,0);\r\n}\r\n}\r\nif (msg_info->dest_nsap) {\r\ngchar* key = wmem_strdup_printf(wmem_file_scope(), "%s:%.8X",msg_info->dest_nsap,leg->sugr);\r\nascii_strdown_inplace(key);\r\nleg->dest_nsap = wmem_strdup(wmem_file_scope(), msg_info->dest_nsap);\r\nif (!wmem_tree_lookup_string(legs_by_bearer,key,0)) {\r\nwmem_tree_insert_string(legs_by_bearer,key,leg,0);\r\n}\r\n}\r\nleg->msgs = NULL;\r\nleg->release_cause = 0;\r\nwmem_tree_insert32(legs_by_osaid,leg->osaid,leg);\r\n}\r\nbreak;\r\ncase 4:\r\nif(( leg = (alcap_leg_info_t *)wmem_tree_lookup32(legs_by_osaid,msg_info->dsaid) )) {\r\nleg->dsaid = msg_info->osaid;\r\nwmem_tree_insert32(legs_by_dsaid,leg->dsaid,leg);\r\n}\r\nbreak;\r\ncase 6:\r\ncase 12:\r\ncase 13:\r\ncase 14:\r\nif( ( leg = (alcap_leg_info_t *)wmem_tree_lookup32(legs_by_osaid,msg_info->dsaid) )\r\n|| ( leg = (alcap_leg_info_t *)wmem_tree_lookup32(legs_by_dsaid,msg_info->dsaid) ) ) {\r\nif(msg_info->release_cause)\r\nleg->release_cause = msg_info->release_cause;\r\n}\r\nbreak;\r\ncase 7:\r\nleg = (alcap_leg_info_t *)wmem_tree_lookup32(legs_by_osaid,msg_info->dsaid);\r\nif(leg) {\r\nleg->release_cause = msg_info->release_cause;\r\n} else if (( leg = (alcap_leg_info_t *)wmem_tree_lookup32(legs_by_dsaid,msg_info->dsaid) )) {\r\nleg->release_cause = msg_info->release_cause;\r\n}\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nif (leg != NULL && ( (! leg->msgs) || leg->msgs->last->framenum < pinfo->num ) ) {\r\nalcap_msg_data_t* msg = wmem_new(wmem_file_scope(), alcap_msg_data_t);\r\nmsg->msg_type = msg_info->msg_type;\r\nmsg->framenum = pinfo->num;\r\nmsg->next = NULL;\r\nmsg->last = NULL;\r\nif (leg->msgs) {\r\nleg->msgs->last->next = msg;\r\n} else {\r\nleg->msgs = msg;\r\n}\r\nleg->msgs->last = msg;\r\n}\r\nif (tree && leg) alcap_leg_tree(alcap_tree,tvb,pinfo,leg);\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_alcap(void)\r\n{\r\nmodule_t *alcap_module;\r\nexpert_module_t *expert_alcap;\r\nstatic hf_register_info hf[] = {\r\n{ &hf_alcap_dsaid,\r\n{ "DSAID", "alcap.dsaid",\r\nFT_UINT32, BASE_HEX, NULL, 0,\r\n"Destination Service Association ID", HFILL }\r\n},\r\n{ &hf_alcap_msg_id,\r\n{ "Message Type", "alcap.msg_type",\r\nFT_UINT8, BASE_DEC | BASE_EXT_STRING, &msg_type_strings_ext, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_compat,\r\n{ "Message Compatibility", "alcap.compat",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_compat_pass_on_sni,\r\n{ "Pass-On SNI", "alcap.compat.pass.sni",\r\nFT_UINT8, BASE_DEC, VALS(send_notification), 0x40,\r\n"Send Notification Indicator", HFILL }\r\n},\r\n{ &hf_alcap_compat_pass_on_ii,\r\n{ "Pass-On II", "alcap.compat.pass.ii",\r\nFT_UINT8, BASE_DEC, VALS(instruction_indicator), 0x30,\r\n"Instruction Indicator", HFILL }\r\n},\r\n{ &hf_alcap_compat_general_sni,\r\n{ "General SNI", "alcap.compat.general.sni",\r\nFT_UINT8, BASE_DEC, VALS(send_notification), 0x04,\r\n"Send Notification Indicator", HFILL }\r\n},\r\n{ &hf_alcap_compat_general_ii,\r\n{ "General II", "alcap.compat.general.ii",\r\nFT_UINT8, BASE_DEC, VALS(instruction_indicator), 0x03,\r\n"Instruction Indicator", HFILL }\r\n},\r\n{ &hf_alcap_unknown,\r\n{ "Unknown Field Data", "alcap.unknown.field",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_param_id,\r\n{ "Parameter", "alcap.param",\r\nFT_UINT8, BASE_DEC, VALS(msg_parm_strings), 0,\r\n"Parameter Id", HFILL }\r\n},\r\n{ &hf_alcap_param_len,\r\n{ "Length", "alcap.param.len",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"Parameter Length", HFILL }\r\n},\r\n{ &hf_alcap_cau_coding,\r\n{ "Cause Coding", "alcap.cau.coding",\r\nFT_UINT8, BASE_DEC, VALS(cause_coding_vals), 0x03,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_cau_value_itu,\r\n{ "Cause Value (ITU)", "alcap.cau.value",\r\nFT_UINT8, BASE_DEC, VALS(cause_values_itu), 0x7f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_cau_value_non_itu,\r\n{ "Cause Value (Other)", "alcap.cau.value",\r\nFT_UINT8, BASE_DEC, NULL, 0x7f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_cau_diag,\r\n{ "Diagnostic", "alcap.cau.diag",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_cau_diag_len,\r\n{ "Length", "alcap.cau.diag.len",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"Diagnostics Length", HFILL }\r\n},\r\n{ &hf_alcap_cau_diag_msg,\r\n{ "Message Identifier", "alcap.cau.diag.msg",\r\nFT_UINT8, BASE_DEC | BASE_EXT_STRING, &msg_type_strings_ext, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_cau_diag_param_id,\r\n{ "Parameter Identifier", "alcap.cau.diag.param",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_cau_diag_field_num,\r\n{ "Field Number", "alcap.cau.diag.field_num",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ceid_pathid,\r\n{ "Path ID", "alcap.ceid.pathid",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ceid_cid,\r\n{ "CID", "alcap.ceid.cid",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_dnsea,\r\n{ "Address", "alcap.dnsea.addr",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_alc_max_br_fw,\r\n{ "Maximum Forward Bit Rate", "alcap.alc.bitrate.max.fw",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_alc_max_br_bw,\r\n{ "Maximum Backwards Bit Rate", "alcap.alc.bitrate.max.bw",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_alc_avg_br_fw,\r\n{ "Average Forward Bit Rate", "alcap.alc.bitrate.avg.fw",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_alc_avg_br_bw,\r\n{ "Average Backwards Bit Rate", "alcap.alc.bitrate.avg.bw",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_alc_max_sdu_fw,\r\n{ "Maximum Forward CPS SDU Size", "alcap.alc.sdusize.max.fw",\r\nFT_UINT8, BASE_DEC, NULL, 0x7f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_alc_max_sdu_bw,\r\n{ "Maximum Backwards CPS SDU Size", "alcap.alc.sdusize.max.bw",\r\nFT_UINT8, BASE_DEC, NULL, 0x7f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_alc_avg_sdu_fw,\r\n{ "Average Forward CPS SDU Size", "alcap.alc.sdusize.avg.fw",\r\nFT_UINT8, BASE_DEC, NULL, 0x7f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_alc_avg_sdu_bw,\r\n{ "Average Backwards CPS SDU Size", "alcap.alc.sdusize.avg.bw",\r\nFT_UINT8, BASE_DEC, NULL, 0x7f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_osaid,\r\n{ "OSAID", "alcap.osaid",\r\nFT_UINT32, BASE_HEX, NULL, 0,\r\n"Originating Service Association ID", HFILL }\r\n},\r\n{ &hf_alcap_sugr,\r\n{ "SUGR", "alcap.sugr",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"Served User Generated Reference", HFILL }\r\n},\r\n{ &hf_alcap_sut_len,\r\n{ "SUT Length", "alcap.sut.sut_len",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_sut,\r\n{ "SUT", "alcap.sut.transport",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"Served User Transport", HFILL }\r\n},\r\n{ &hf_alcap_ssia_pr_type,\r\n{ "Profile Type", "alcap.ssia.profile.type",\r\nFT_UINT8, BASE_DEC, VALS(audio_profile_type), 0xc0,\r\n"I.366.2 Profile Type", HFILL }\r\n},\r\n{ &hf_alcap_ssia_pr_id,\r\n{ "Profile Id", "alcap.ssia.profile.id",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssia_frm,\r\n{ "Frame Mode", "alcap.ssia.frm",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssia_cmd,\r\n{ "Circuit Mode", "alcap.ssia.cmd",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssia_mfr2,\r\n{ "Multi-Frequency R2", "alcap.ssia.mfr2",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssia_mfr1,\r\n{ "Multi-Frequency R1", "alcap.ssia.mfr1",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssia_dtmf,\r\n{ "DTMF", "alcap.ssia.dtmf",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssia_cas,\r\n{ "CAS", "alcap.ssia.cas",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0x04,\r\n"Channel Associated Signalling", HFILL }\r\n},\r\n{ &hf_alcap_ssia_fax,\r\n{ "Fax", "alcap.ssia.fax",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0x02,\r\n"Facsimile", HFILL }\r\n},\r\n{ &hf_alcap_ssia_pcm,\r\n{ "PCM Mode", "alcap.ssia.pcm",\r\nFT_UINT8, BASE_DEC, VALS(alaw_ulaw), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssia_max_len,\r\n{ "Max Len of FM Data", "alcap.ssia.max_fmdata_len",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssia_oui,\r\n{ "OUI", "alcap.ssia.oui",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"Organizational Unique Identifier", HFILL }\r\n},\r\n{ &hf_alcap_ssim_frm,\r\n{ "Frame Mode", "alcap.ssim.frm",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssim_mult,\r\n{ "Multiplier", "alcap.ssim.mult",\r\nFT_UINT8, BASE_DEC, NULL, 0x1f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssim_max,\r\n{ "Max Len", "alcap.ssim.max",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssisa_max_sssar_fw,\r\n{ "Maximum Len of SSSAR-SDU Forward", "alcap.ssisa.sssar.max_len.fw",\r\nFT_UINT24, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssisa_max_sssar_bw,\r\n{ "Maximum Len of SSSAR-SDU Backwards", "alcap.ssisa.sssar.max_len.fw",\r\nFT_UINT24, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssisa_max_sscop_sdu_fw,\r\n{ "Maximum Len of SSSAR-SDU Forward", "alcap.ssisa.sscop.max_sdu_len.fw",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssisa_max_sscop_sdu_bw,\r\n{ "Maximum Len of SSSAR-SDU Backwards", "alcap.ssisa.sscop.max_sdu_len.bw",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssisa_max_sscop_uu_fw,\r\n{ "Maximum Len of SSSAR-SDU Forward", "alcap.ssisa.sscop.max_uu_len.fw",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssisa_max_sscop_uu_bw,\r\n{ "Maximum Len of SSSAR-SDU Backwards", "alcap.ssisa.sscop.max_uu_len.bw",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssisu_max_sssar_fw,\r\n{ "Maximum Len of SSSAR-SDU Forward", "alcap.ssisu.sssar.max_len.fw",\r\nFT_UINT24, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssisu_max_sssar_bw,\r\n{ "Maximum Len of SSSAR-SDU Backwards", "alcap.ssisu.sssar.max_len.fw",\r\nFT_UINT24, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssisu_ted,\r\n{ "Transmission Error Detection", "alcap.ssisu.ted",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pt,\r\n{ "QoS Codepoint", "alcap.pt.codepoint",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_plc_max_br_fw,\r\n{ "Maximum Forward Bit Rate", "alcap.plc.bitrate.max.fw",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_plc_max_br_bw,\r\n{ "Maximum Backwards Bit Rate", "alcap.plc.bitrate.max.bw",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_plc_avg_br_fw,\r\n{ "Average Forward Bit Rate", "alcap.plc.bitrate.avg.fw",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_plc_avg_br_bw,\r\n{ "Average Backwards Bit Rate", "alcap.plc.bitrate.avg.bw",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_plc_max_sdu_fw,\r\n{ "Maximum Forward CPS SDU Size", "alcap.plc.sdusize.max.fw",\r\nFT_UINT8, BASE_DEC, NULL, 0x7f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_plc_max_sdu_bw,\r\n{ "Maximum Backwards CPS SDU Size", "alcap.plc.sdusize.max.bw",\r\nFT_UINT8, BASE_DEC, NULL, 0x7f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_plc_avg_sdu_fw,\r\n{ "Maximum Forward CPS SDU Size", "alcap.plc.sdusize.max.fw",\r\nFT_UINT8, BASE_DEC, NULL, 0x7f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_plc_avg_sdu_bw,\r\n{ "Maximum Backwards CPS SDU Size", "alcap.plc.sdusize.max.bw",\r\nFT_UINT8, BASE_DEC, NULL, 0x7f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pssiae_pr_type,\r\n{ "Profile Type", "alcap.pssiae.profile.type",\r\nFT_UINT8, BASE_DEC, VALS(audio_profile_type), 0xc0,\r\n"I.366.2 Profile Type", HFILL }\r\n},\r\n{ &hf_alcap_pssiae_pr_id,\r\n{ "Profile Id", "alcap.pssiae.profile.id",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pssiae_lb,\r\n{ "Loopback", "alcap.pssiae.lb",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0xc0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pssiae_rc,\r\n{ "Rate Control", "alcap.pssiae.rc",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0xc0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pssiae_syn,\r\n{ "Synchronization", "alcap.pssiae.syn",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0xc0,\r\n"Transport of synchronization of change in SSCS operation", HFILL }\r\n},\r\n{ &hf_alcap_pssiae_frm,\r\n{ "Frame Mode", "alcap.pssiae.frm",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pssiae_cmd,\r\n{ "Circuit Mode", "alcap.pssiae.cmd",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pssiae_mfr2,\r\n{ "Multi-Frequency R2", "alcap.pssiae.mfr2",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pssiae_mfr1,\r\n{ "Multi-Frequency R1", "alcap.pssiae.mfr1",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pssiae_dtmf,\r\n{ "DTMF", "alcap.pssiae.dtmf",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pssiae_cas,\r\n{ "CAS", "alcap.pssiae.cas",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0x04,\r\n"Channel Associated Signalling", HFILL }\r\n},\r\n{ &hf_alcap_pssiae_fax,\r\n{ "Fax", "alcap.pssiae.fax",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0x02,\r\n"Facsimile", HFILL }\r\n},\r\n{ &hf_alcap_pssiae_pcm,\r\n{ "PCM Mode", "alcap.pssiae.pcm",\r\nFT_UINT8, BASE_DEC, VALS(alaw_ulaw), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pssiae_max_len,\r\n{ "Max Len of FM Data", "alcap.pssiae.max_fmdata_len",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pssiae_oui,\r\n{ "OUI", "alcap.pssiae.oui",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"Organizational Unique Identifier", HFILL }\r\n},\r\n{ &hf_alcap_pssime_frm,\r\n{ "Frame Mode", "alcap.pssime.frm",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pssime_lb,\r\n{ "Loopback", "alcap.pssime.lb",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pssime_mult,\r\n{ "Multiplier", "alcap.pssime.mult",\r\nFT_UINT8, BASE_DEC, NULL, 0x1f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pssime_max,\r\n{ "Max Len", "alcap.pssime.max",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_suci,\r\n{ "SUCI", "alcap.suci",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\n"Served User Correlation Id", HFILL }\r\n},\r\n{ &hf_alcap_onsea,\r\n{ "Address", "alcap.onsea.addr",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssiae_pr_type,\r\n{ "Profile Type", "alcap.ssiae.profile.type",\r\nFT_UINT8, BASE_DEC, VALS(audio_profile_type), 0xc0,\r\n"I.366.2 Profile Type", HFILL }\r\n},\r\n{ &hf_alcap_ssiae_lb,\r\n{ "Loopback", "alcap.ssiae.lb",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0xc0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssiae_rc,\r\n{ "Rate Control", "alcap.ssiae.rc",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0xc0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssiae_syn,\r\n{ "Synchronization", "alcap.ssiae.syn",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0xc0,\r\n"Transport of synchronization of change in SSCS operation", HFILL }\r\n},\r\n{ &hf_alcap_ssiae_pr_id,\r\n{ "Profile Id", "alcap.ssiae.profile.id",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssiae_frm,\r\n{ "Frame Mode", "alcap.ssiae.frm",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssiae_cmd,\r\n{ "Circuit Mode", "alcap.ssiae.cmd",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssiae_mfr2,\r\n{ "Multi-Frequency R2", "alcap.ssiae.mfr2",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssiae_mfr1,\r\n{ "Multi-Frequency R1", "alcap.ssiae.mfr1",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssiae_dtmf,\r\n{ "DTMF", "alcap.ssiae.dtmf",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssiae_cas,\r\n{ "CAS", "alcap.ssiae.cas",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0x04,\r\n"Channel Associated Signalling", HFILL }\r\n},\r\n{ &hf_alcap_ssiae_fax,\r\n{ "Fax", "alcap.ssiae.fax",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0x02,\r\n"Facsimile", HFILL }\r\n},\r\n{ &hf_alcap_ssiae_pcm,\r\n{ "PCM Mode", "alcap.ssiae.pcm",\r\nFT_UINT8, BASE_DEC, VALS(alaw_ulaw), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssiae_max_len,\r\n{ "Max Len of FM Data", "alcap.ssiae.max_fmdata_len",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssiae_oui,\r\n{ "OUI", "alcap.ssiae.oui",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"Organizational Unique Identifier", HFILL }\r\n},\r\n{ &hf_alcap_ssime_frm,\r\n{ "Frame Mode", "alcap.ssime.frm",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssime_lb,\r\n{ "Loopback", "alcap.ssime.lb",\r\nFT_UINT8, BASE_DEC, VALS(enabled_disabled), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssime_mult,\r\n{ "Multiplier", "alcap.ssime.mult",\r\nFT_UINT8, BASE_DEC, NULL, 0x1f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_ssime_max,\r\n{ "Max Len", "alcap.ssime.max",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_acc_level,\r\n{ "Congestion Level", "alcap.acc.level",\r\nFT_UINT8, BASE_DEC, VALS(congestion_level), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_cp,\r\n{ "Level", "alcap.cp.level",\r\nFT_UINT8, BASE_DEC, VALS(connection_priority), 0x07,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_hc,\r\n{ "Codepoint", "alcap.hc.codepoint",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pfbw_br_fw,\r\n{ "CPS Forward Bitrate", "alcap.pfbw.bitrate.fw",\r\nFT_UINT24, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pfbw_br_bw,\r\n{ "CPS Backwards Bitrate", "alcap.pfbw.bitrate.bw",\r\nFT_UINT24, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pfbw_bucket_fw,\r\n{ "Forward CPS Bucket Size", "alcap.pfbw.bucket_size.fw",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pfbw_bucket_bw,\r\n{ "Backwards CPS Bucket Size", "alcap.pfbw.bucket_size.bw",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pfbw_size_fw,\r\n{ "Forward CPS Packet Size", "alcap.pfbw.max_size.fw",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pfbw_size_bw,\r\n{ "Backwards CPS Packet Size", "alcap.pfbw.max_size.bw",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pvbws_br_fw,\r\n{ "Peak CPS Forward Bitrate", "alcap.pvbws.bitrate.fw",\r\nFT_UINT24, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pvbws_br_bw,\r\n{ "Peak CPS Backwards Bitrate", "alcap.pvbws.bitrate.bw",\r\nFT_UINT24, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pvbws_bucket_fw,\r\n{ "Peak Forward CPS Bucket Size", "alcap.pvbws.bucket_size.fw",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pvbws_bucket_bw,\r\n{ "Peak Backwards CPS Bucket Size", "alcap.pvbws.bucket_size.bw",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pvbws_size_fw,\r\n{ "Forward CPS Packet Size", "alcap.pvbws.max_size.fw",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pvbws_size_bw,\r\n{ "Backwards CPS Packet Size", "alcap.pvbws.max_size.bw",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pvbws_stt,\r\n{ "Source Traffic Type", "alcap.pvbws.stt",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pvbwt_peak_br_fw,\r\n{ "Peak CPS Forward Bitrate", "alcap.pvbwt.bitrate.fw",\r\nFT_UINT24, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pvbwt_peak_br_bw,\r\n{ "Peak CPS Backwards Bitrate", "alcap.pvbwt.bitrate.bw",\r\nFT_UINT24, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pvbwt_peak_bucket_fw,\r\n{ "Peak Forward CPS Bucket Size", "alcap.pvbwt.bucket_size.fw",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pvbwt_peak_bucket_bw,\r\n{ "Peak Backwards CPS Bucket Size", "alcap.pvbwt.bucket_size.bw",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pvbwt_sust_br_fw,\r\n{ "Sustainable CPS Forward Bitrate", "alcap.pvbwt.bitrate.fw",\r\nFT_UINT24, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pvbwt_sust_br_bw,\r\n{ "Sustainable CPS Backwards Bitrate", "alcap.pvbwt.bitrate.bw",\r\nFT_UINT24, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pvbwt_sust_bucket_fw,\r\n{ "Sustainable Forward CPS Bucket Size", "alcap.pvbwt.bucket_size.fw",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pvbwt_sust_bucket_bw,\r\n{ "Sustainable Backwards CPS Bucket Size", "alcap.pvbwt.bucket_size.bw",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pvbwt_size_fw,\r\n{ "Forward CPS Packet Size", "alcap.pvbwt.max_size.fw",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_pvbwt_size_bw,\r\n{ "Backwards CPS Packet Size", "alcap.pvbwt.max_size.bw",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_fbw_br_fw,\r\n{ "CPS Forward Bitrate", "alcap.fbw.bitrate.fw",\r\nFT_UINT24, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_fbw_br_bw,\r\n{ "CPS Backwards Bitrate", "alcap.fbw.bitrate.bw",\r\nFT_UINT24, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_fbw_bucket_fw,\r\n{ "Forward CPS Bucket Size", "alcap.fbw.bucket_size.fw",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_fbw_bucket_bw,\r\n{ "Backwards CPS Bucket Size", "alcap.fbw.bucket_size.bw",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_fbw_size_fw,\r\n{ "Forward CPS Packet Size", "alcap.fbw.max_size.fw",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_fbw_size_bw,\r\n{ "Backwards CPS Packet Size", "alcap.fbw.max_size.bw",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_vbws_br_fw,\r\n{ "CPS Forward Bitrate", "alcap.vbws.bitrate.fw",\r\nFT_UINT24, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_vbws_br_bw,\r\n{ "CPS Backwards Bitrate", "alcap.vbws.bitrate.bw",\r\nFT_UINT24, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_vbws_bucket_fw,\r\n{ "Forward CPS Bucket Size", "alcap.vbws.bucket_size.fw",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_vbws_bucket_bw,\r\n{ "Backwards CPS Bucket Size", "alcap.vbws.bucket_size.bw",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_vbws_size_fw,\r\n{ "Forward CPS Packet Size", "alcap.vbws.max_size.fw",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_vbws_size_bw,\r\n{ "Backwards CPS Packet Size", "alcap.vbws.max_size.bw",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_vbws_stt,\r\n{ "Source Traffic Type", "alcap.vbws.stt",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_vbwt_peak_br_fw,\r\n{ "Peak CPS Forward Bitrate", "alcap.vbwt.bitrate.fw",\r\nFT_UINT24, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_vbwt_peak_br_bw,\r\n{ "Peak CPS Backwards Bitrate", "alcap.vbwt.bitrate.bw",\r\nFT_UINT24, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_vbwt_peak_bucket_fw,\r\n{ "Peak Forward CPS Bucket Size", "alcap.vbwt.bucket_size.fw",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_vbwt_peak_bucket_bw,\r\n{ "Peak Backwards CPS Bucket Size", "alcap.vbwt.bucket_size.bw",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_vbwt_sust_br_fw,\r\n{ "Sustainable CPS Forward Bitrate", "alcap.vbwt.bitrate.fw",\r\nFT_UINT24, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_vbwt_sust_br_bw,\r\n{ "Sustainable CPS Backwards Bitrate", "alcap.vbwt.bitrate.bw",\r\nFT_UINT24, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_vbwt_sust_bucket_fw,\r\n{ "Sustainable Forward CPS Bucket Size", "alcap.vbwt.bucket_size.fw",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_vbwt_sust_bucket_bw,\r\n{ "Sustainable Backwards CPS Bucket Size", "alcap.vbwt.bucket_size.bw",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_vbwt_size_fw,\r\n{ "Forward CPS Packet Size", "alcap.vbwt.max_size.fw",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_vbwt_size_bw,\r\n{ "Backwards CPS Packet Size", "alcap.vbwt.max_size.bw",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_leg_osaid,\r\n{ "Leg's ERQ OSA id", "alcap.leg.osaid",\r\nFT_UINT32, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_leg_dsaid,\r\n{ "Leg's ECF OSA id", "alcap.leg.dsaid",\r\nFT_UINT32, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_leg_pathid,\r\n{ "Leg's path id", "alcap.leg.pathid",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_leg_cid,\r\n{ "Leg's channel id", "alcap.leg.cid",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_leg_sugr,\r\n{ "Leg's SUGR", "alcap.leg.sugr",\r\nFT_UINT32, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_leg_dnsea,\r\n{ "Leg's destination NSAP", "alcap.leg.dnsea",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_leg_onsea,\r\n{ "Leg's originating NSAP", "alcap.leg.onsea",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_leg_frame,\r\n{ "a message of this leg", "alcap.leg.msg",\r\nFT_FRAMENUM, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_alcap_leg_release_cause,\r\n{ "Leg's cause value in REL", "alcap.leg.cause",\r\nFT_UINT8, BASE_DEC, VALS(cause_values_itu), 0,\r\nNULL, HFILL }\r\n},\r\n};\r\ngint* ett[] = {\r\n&ett_alcap,\r\n&ett_leg,\r\n&ett_compat,\r\n&ett_cau_diag,\r\n&param_infos[0].ett,\r\n&param_infos[1].ett,\r\n&param_infos[2].ett,\r\n&param_infos[3].ett,\r\n&param_infos[4].ett,\r\n&param_infos[5].ett,\r\n&param_infos[6].ett,\r\n&param_infos[7].ett,\r\n&param_infos[8].ett,\r\n&param_infos[9].ett,\r\n&param_infos[10].ett,\r\n&param_infos[11].ett,\r\n&param_infos[12].ett,\r\n&param_infos[13].ett,\r\n&param_infos[14].ett,\r\n&param_infos[15].ett,\r\n&param_infos[16].ett,\r\n&param_infos[17].ett,\r\n&param_infos[18].ett,\r\n&param_infos[19].ett,\r\n&param_infos[20].ett,\r\n&param_infos[21].ett,\r\n&param_infos[22].ett,\r\n&param_infos[23].ett,\r\n&param_infos[24].ett,\r\n&param_infos[25].ett,\r\n&param_infos[26].ett,\r\n&param_infos[27].ett,\r\n&param_infos[28].ett,\r\n&param_infos[29].ett,\r\n&param_infos[30].ett,\r\n&param_infos[31].ett,\r\n&param_infos[32].ett,\r\n&param_infos[33].ett,\r\n&param_infos[34].ett,\r\n&param_infos[35].ett,\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_alcap_parameter_field_bad_length, { "alcap.parameter_field_bad_length", PI_MALFORMED, PI_WARN, "Wrong length for parameter fields", EXPFILL }},\r\n{ &ei_alcap_undecoded, { "alcap.undecoded", PI_UNDECODED, PI_WARN, "Undecoded", EXPFILL }},\r\n{ &ei_alcap_release_cause_not31, { "alcap.leg.cause.not31", PI_RESPONSE_CODE, PI_WARN, "Leg Release cause != 31", EXPFILL }},\r\n{ &ei_alcap_abnormal_release, { "alcap.abnormal_release", PI_RESPONSE_CODE, PI_WARN, "Abnormal Release", EXPFILL }},\r\n{ &ei_alcap_response, { "alcap.response", PI_RESPONSE_CODE, PI_NOTE, " ", EXPFILL }},\r\n};\r\nproto_alcap = proto_register_protocol(alcap_proto_name, alcap_proto_name_short, "alcap");\r\nregister_dissector("alcap", dissect_alcap, proto_alcap);\r\nproto_register_field_array(proto_alcap, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_alcap = expert_register_protocol(proto_alcap);\r\nexpert_register_field_array(expert_alcap, ei, array_length(ei));\r\nalcap_module = prefs_register_protocol(proto_alcap, NULL);\r\nprefs_register_bool_preference(alcap_module, "leg_info",\r\n"Keep Leg Information",\r\n"Whether persistent call leg information is to be kept",\r\n&keep_persistent_info);\r\nlegs_by_dsaid = wmem_tree_new_autoreset(wmem_epan_scope(), wmem_file_scope());\r\nlegs_by_osaid = wmem_tree_new_autoreset(wmem_epan_scope(), wmem_file_scope());\r\nlegs_by_bearer = wmem_tree_new_autoreset(wmem_epan_scope(), wmem_file_scope());\r\n}\r\nvoid\r\nproto_reg_handoff_alcap(void)\r\n{\r\ndissector_handle_t alcap_handle = find_dissector("alcap");\r\ndissector_add_uint("mtp3.service_indicator", MTP_SI_AAL2, alcap_handle);\r\n}
