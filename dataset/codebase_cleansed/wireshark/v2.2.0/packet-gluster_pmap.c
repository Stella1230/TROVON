static int\r\ngluster_pmap_portbybrick_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_gluster_brick_status, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_gluster_brick_port, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ngluster_pmap_portbybrick_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nreturn dissect_rpc_string(tvb, tree, hf_gluster_brick, 0, NULL);\r\n}\r\nstatic int\r\ngluster_dump_reply_detail(tvbuff_t *tvb, int offset, packet_info *pinfo _U_,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nproto_item *detail_item;\r\nproto_tree *detail_tree;\r\nconst gchar *progname = NULL;\r\ndetail_tree = proto_tree_add_subtree(tree, tvb, offset, -1,\r\nett_gluster_dump_detail, &detail_item, "Available Progam: ");\r\noffset = dissect_rpc_string(tvb, detail_tree, hf_gluster_progname,\r\noffset, &progname);\r\nproto_item_append_text(detail_item, "%s", progname);\r\noffset = dissect_rpc_uint64(tvb, detail_tree, hf_gluster_prognum,\r\noffset);\r\noffset = dissect_rpc_uint64(tvb, detail_tree, hf_gluster_progver,\r\noffset);\r\nreturn offset;\r\n}\r\nstatic int\r\ngluster_dump_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_uint64(tvb, tree, hf_gluster_gfsid, offset);\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = dissect_rpc_list(tvb, pinfo, tree, offset,\r\ngluster_dump_reply_detail, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ngluster_dump_call(tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nreturn dissect_rpc_uint64(tvb, tree, hf_gluster_gfsid, 0);\r\n}\r\nvoid\r\nproto_register_gluster_pmap(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_gluster_pmap_proc,\r\n{ "Gluster Portmap", "gluster.pmap.proc", FT_UINT32,\r\nBASE_DEC, VALS(gluster_pmap_proc_vals), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gluster_brick,\r\n{ "Brick", "gluster.brick", FT_STRINGZ, BASE_NONE,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_brick_status,\r\n{ "Status", "gluster.brick.status", FT_INT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_brick_port,\r\n{ "Port", "gluster.brick.port", FT_INT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }\r\n}\r\n};\r\nstatic gint *ett[] = {\r\n&ett_gluster_pmap\r\n};\r\nproto_gluster_pmap = proto_register_protocol("Gluster Portmap",\r\n"Gluster Portmap", "gluster.pmap");\r\nproto_register_subtree_array(ett, array_length(ett));\r\nproto_register_field_array(proto_gluster_pmap, hf, array_length(hf));\r\n}\r\nvoid\r\nproto_reg_handoff_gluster_pmap(void)\r\n{\r\nrpc_init_prog(proto_gluster_pmap, GLUSTER_PMAP_PROGRAM,\r\nett_gluster_pmap,\r\nG_N_ELEMENTS(gluster_pmap_vers_info), gluster_pmap_vers_info);\r\n}\r\nvoid\r\nproto_register_gluster_dump(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_gluster_dump_proc,\r\n{ "Gluster DUMP", "gluster.dump.proc", FT_UINT32,\r\nBASE_DEC, VALS(gluster_dump_proc_vals), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gluster_progname,\r\n{ "Program Name", "gluster.dump.progname", FT_STRING,\r\nBASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_prognum,\r\n{ "Program Number", "gluster.dump.prognum",\r\nFT_UINT64, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_progver,\r\n{ "Program Version", "gluster.dump.progver",\r\nFT_UINT64, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_gfsid,\r\n{ "GFS ID", "gluster.gfsid", FT_UINT64, BASE_HEX, NULL,\r\n0, NULL, HFILL }\r\n}\r\n};\r\nstatic gint *ett[] = {\r\n&ett_gluster_dump,\r\n&ett_gluster_dump_detail\r\n};\r\nproto_gluster_dump = proto_register_protocol("Gluster Dump",\r\n"Gluster Dump", "gluster.dump");\r\nproto_register_subtree_array(ett, array_length(ett));\r\nproto_register_field_array(proto_gluster_dump, hf, array_length(hf));\r\n}\r\nvoid\r\nproto_reg_handoff_gluster_dump(void)\r\n{\r\nrpc_init_prog(proto_gluster_dump, GLUSTER_DUMP_PROGRAM,\r\nett_gluster_dump,\r\nG_N_ELEMENTS(gluster_dump_vers_info), gluster_dump_vers_info);\r\n}
