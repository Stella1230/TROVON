static void sam_timeout_base(gchar* buf, guint32 value) {\r\nif (value == 0x00) {\r\ng_snprintf(buf, ITEM_LABEL_LENGTH, "No timeout control");\r\n} else if (0x01 <= value && value <= 0x13) {\r\ng_snprintf(buf, ITEM_LABEL_LENGTH, "%u ms", value * 50);\r\n} else {\r\ng_snprintf(buf, ITEM_LABEL_LENGTH, "%u.%03u s", value * 50 / 1000, value * 50 % 1000);\r\n}\r\n}\r\nstatic void replay_delay_base(gchar* buf, guint32 value) {\r\ng_snprintf(buf, ITEM_LABEL_LENGTH, "%u.%03u s", value * 500 / 1000, value * 500 % 1000);\r\n}\r\nstatic gint\r\ndissect_status(proto_tree *tree, tvbuff_t *tvb, gint offset)\r\n{\r\nproto_tree_add_item(tree, hf_pn532_status_nad_present, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_pn532_status_mi, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_pn532_status_error_code, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nreturn offset + 1;\r\n}\r\nstatic gint\r\ndissect_pn532(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data)\r\n{\r\nproto_item *item;\r\nproto_tree *pn532_tree;\r\nproto_item *sub_item;\r\nproto_tree *sub_tree;\r\nproto_item *next_item;\r\nproto_tree *next_tree;\r\nguint8 cmd;\r\nguint8 config;\r\ngint16 baudrate;\r\ngint16 test_number;\r\nguint8 length;\r\nguint8 value;\r\nguint8 type;\r\nguint8 item_value;\r\ntvbuff_t *next_tvb;\r\ngint offset = 0;\r\ncommand_data_t *command_data = NULL;\r\nusb_conv_info_t *usb_conv_info;\r\nwmem_tree_key_t key[5];\r\nguint32 bus_id;\r\nguint32 device_address;\r\nguint32 endpoint;\r\nguint32 k_bus_id;\r\nguint32 k_device_address;\r\nguint32 k_endpoint;\r\nguint32 k_frame_number;\r\nif (data == NULL)\r\nreturn 0;\r\nusb_conv_info = (usb_conv_info_t *)data;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "PN532");\r\nitem = proto_tree_add_item(tree, proto_pn532, tvb, 0, -1, ENC_NA);\r\npn532_tree = proto_item_add_subtree(item, ett_pn532);\r\nproto_tree_add_item(pn532_tree, hf_pn532_direction, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_command, tvb, offset, 1, ENC_NA);\r\ncmd = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\ncol_set_str(pinfo->cinfo, COL_INFO, val_to_str_ext_const(cmd, &pn532_commands_ext, "Unknown command"));\r\nbus_id = usb_conv_info->bus_id;\r\ndevice_address = usb_conv_info->device_address;\r\nendpoint = usb_conv_info->endpoint;\r\nk_bus_id = bus_id;\r\nk_device_address = device_address;\r\nk_endpoint = endpoint;\r\nk_frame_number = pinfo->num;\r\nkey[0].length = 1;\r\nkey[0].key = &k_bus_id;\r\nkey[1].length = 1;\r\nkey[1].key = &k_device_address;\r\nkey[2].length = 1;\r\nkey[2].key = &k_endpoint;\r\nkey[3].length = 1;\r\nkey[3].key = &k_frame_number;\r\nkey[4].length = 0;\r\nkey[4].key = NULL;\r\nif (!pinfo->fd->flags.visited && !(cmd & 0x01)) {\r\ncommand_data = wmem_new(wmem_file_scope(), command_data_t);\r\ncommand_data->bus_id = bus_id;\r\ncommand_data->device_address = device_address;\r\ncommand_data->endpoint = endpoint;\r\ncommand_data->command = cmd;\r\ncommand_data->command_frame_number = pinfo->num;\r\ncommand_data->response_frame_number = 0;\r\nwmem_tree_insert32_array(command_info, key, command_data);\r\nk_bus_id = bus_id;\r\nk_device_address = device_address;\r\nk_endpoint = endpoint;\r\nk_frame_number = pinfo->num;\r\nkey[0].length = 1;\r\nkey[0].key = &k_bus_id;\r\nkey[1].length = 1;\r\nkey[1].key = &k_device_address;\r\nkey[2].length = 1;\r\nkey[2].key = &k_endpoint;\r\nkey[3].length = 1;\r\nkey[3].key = &k_frame_number;\r\nkey[4].length = 0;\r\nkey[4].key = NULL;\r\n}\r\nif (cmd & 0x01) {\r\nwmem_tree_t *wmem_tree;\r\nkey[3].length = 0;\r\nkey[3].key = NULL;\r\nwmem_tree = (wmem_tree_t *) wmem_tree_lookup32_array(command_info, key);\r\nif (wmem_tree) {\r\ncommand_data = (command_data_t *) wmem_tree_lookup32_le(wmem_tree, pinfo->num);\r\nif (command_data && (command_data->response_frame_number == 0 ||\r\ncommand_data->response_frame_number == pinfo->num)) {\r\nif (!pinfo->fd->flags.visited && command_data->response_frame_number == 0) {\r\ncommand_data->response_frame_number = pinfo->num;\r\n}\r\n}\r\n}\r\nif (command_data) {\r\nsub_item = proto_tree_add_uint(pn532_tree, hf_pn532_response_for, tvb, offset, tvb_captured_length_remaining(tvb, offset), command_data->command_frame_number);\r\nPROTO_ITEM_SET_GENERATED(sub_item);\r\n}\r\n}\r\nswitch (cmd) {\r\ncase DIAGNOSE_REQ:\r\nproto_tree_add_item(pn532_tree, hf_pn532_test_number, tvb, offset, 1, ENC_NA);\r\ntest_number = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nif (command_data)\r\ncommand_data->data.test_number = test_number;\r\nproto_tree_add_item(pn532_tree, hf_pn532_parameters_length, tvb, offset, 1, ENC_NA);\r\nlength = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nswitch (test_number) {\r\ncase 0x00:\r\nproto_tree_add_item(pn532_tree, hf_pn532_data_in, tvb, offset, length, ENC_NA);\r\noffset += length;\r\nbreak;\r\ncase 0x04:\r\nproto_tree_add_item(pn532_tree, hf_pn532_diagnose_baudrate, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\nbreak;\r\ncase 0x05:\r\nproto_tree_add_item(pn532_tree, hf_pn532_reply_delay, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_ciu_tx_mode, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_ciu_rx_mode, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\nbreak;\r\ncase 0x07:\r\nproto_tree_add_item(pn532_tree, hf_pn532_andet_bot, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pn532_tree, hf_pn532_andet_up, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pn532_tree, hf_pn532_andet_ith, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pn532_tree, hf_pn532_andet_en, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\nbreak;\r\ncase 0x01:\r\ncase 0x02:\r\ncase 0x06:\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(pn532_tree, hf_pn532_parameters, tvb, offset, tvb_captured_length_remaining(tvb, offset), ENC_NA);\r\noffset += tvb_captured_length_remaining(tvb, offset);\r\n}\r\nbreak;\r\ncase DIAGNOSE_RSP:\r\nif (command_data && command_data->command == DIAGNOSE_REQ)\r\ntest_number = command_data->data.test_number;\r\nelse\r\ntest_number = -1;\r\nif (tvb_reported_length_remaining(tvb, offset) >= 1) {\r\nproto_tree_add_item(pn532_tree, hf_pn532_parameters_length, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\nswitch (test_number) {\r\ncase 0x00:\r\nproto_tree_add_item(pn532_tree, hf_pn532_test_number, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_parameters_length, tvb, offset, 1, ENC_NA);\r\nlength = tvb_captured_length_remaining(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_data_out, tvb, offset, length, ENC_NA);\r\noffset += length;\r\nbreak;\r\ncase 0x01:\r\ncase 0x02:\r\ncase 0x06:\r\ncase 0x07:\r\nproto_tree_add_item(pn532_tree, hf_pn532_diagnose_result, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\nbreak;\r\ncase 0x04:\r\nproto_tree_add_item(pn532_tree, hf_pn532_diagnose_number_of_fails, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\nbreak;\r\ncase 0x05:\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(pn532_tree, hf_pn532_parameters, tvb, offset, tvb_captured_length_remaining(tvb, offset), ENC_NA);\r\noffset += tvb_captured_length_remaining(tvb, offset);\r\n}\r\n}\r\nbreak;\r\ncase GET_FIRMWARE_VERSION_REQ:\r\nbreak;\r\ncase GET_FIRMWARE_VERSION_RSP:\r\nproto_tree_add_item(pn532_tree, hf_pn532_ic_version, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_fw_version, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_fw_revision, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\nsub_item = proto_tree_add_item(pn532_tree, hf_pn532_fw_support, tvb, offset, 1, ENC_NA);\r\nsub_tree = proto_item_add_subtree(sub_item, ett_pn532_fw_support);\r\nproto_tree_add_item(sub_tree, hf_pn532_fw_support_rfu, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(sub_tree, hf_pn532_fw_support_iso_018092, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(sub_tree, hf_pn532_fw_support_iso_iec_14443_type_b, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(sub_tree, hf_pn532_fw_support_iso_iec_14443_type_a, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\nbreak;\r\ncase GET_GENERAL_STATUS_REQ:\r\nbreak;\r\ncase GET_GENERAL_STATUS_RSP:\r\nproto_tree_add_item(pn532_tree, hf_pn532_error, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_field, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_NbTg, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nvalue = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nfor (item_value = 1; item_value <= value; item_value += 1) {\r\nsub_item = proto_tree_add_item(pn532_tree, hf_pn532_target, tvb, offset, 4, ENC_NA);\r\nsub_tree = proto_item_add_subtree(sub_item, ett_pn532_target);\r\nproto_item_append_text(sub_item, " %u/%u", item_value, value);\r\nproto_tree_add_item(sub_tree, hf_pn532_Tg, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_tree, hf_pn532_brrx, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_tree, hf_pn532_brtx, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_tree, hf_pn532_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\nproto_tree_add_item(pn532_tree, hf_pn532_sam_status, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase READ_REGISTER_REQ:\r\nwhile (tvb_reported_length_remaining(tvb, offset) >= 2) {\r\nproto_tree_add_item(pn532_tree, hf_pn532_register_address, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\nbreak;\r\ncase READ_REGISTER_RSP:\r\nwhile (tvb_reported_length_remaining(tvb, offset) >= 1) {\r\nproto_tree_add_item(pn532_tree, hf_pn532_register_value, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\nbreak;\r\ncase WRITE_REGISTER_REQ:\r\nwhile (tvb_reported_length_remaining(tvb, offset) >= 3) {\r\nproto_tree_add_item(pn532_tree, hf_pn532_register_address, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(pn532_tree, hf_pn532_register_value, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\nbreak;\r\ncase WRITE_REGISTER_RSP:\r\nbreak;\r\ncase READ_GPIO_REQ:\r\nbreak;\r\ncase READ_GPIO_RSP:\r\nproto_tree_add_item(pn532_tree, hf_pn532_gpio_p3, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_gpio_p7, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_gpio_ioi1, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase WRITE_GPIO_REQ:\r\nproto_tree_add_item(pn532_tree, hf_pn532_gpio_p3, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_gpio_p7, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase WRITE_GPIO_RSP:\r\nbreak;\r\ncase SET_SERIAL_BAUD_RATE_REQ:\r\nproto_tree_add_item(pn532_tree, hf_pn532_baudrate, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase SET_SERIAL_BAUD_RATE_RSP:\r\nbreak;\r\ncase SET_PARAMETERS_REQ:\r\nsub_item = proto_tree_add_item(pn532_tree, hf_pn532_flags, tvb, offset, 1, ENC_NA);\r\nsub_tree = proto_item_add_subtree(sub_item, ett_pn532_flags);\r\nproto_tree_add_item(sub_tree, hf_pn532_flags_rfu_7, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_pn532_flags_remove_preamble_and_postamble, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_pn532_flags_iso_14443_4_picc_emulation, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_pn532_flags_automatic_rats, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_pn532_flags_rfu_3, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_pn532_flags_automatic_atr_res, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_pn532_flags_did_used, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_pn532_flags_nad_used, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase SET_PARAMETERS_RSP:\r\nbreak;\r\ncase SAM_CONFIGURATION_REQ:\r\nproto_tree_add_item(pn532_tree, hf_pn532_sam_mode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_sam_timeout, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nif (tvb_reported_length_remaining(tvb, offset) >= 1) {\r\nproto_tree_add_item(pn532_tree, hf_pn532_sam_irq, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\nbreak;\r\ncase SAM_CONFIGURATION_RSP:\r\nbreak;\r\ncase POWER_DOWN_REQ:\r\nsub_item = proto_tree_add_item(pn532_tree, hf_pn532_wakeup_enable, tvb, offset, 1, ENC_NA);\r\nsub_tree = proto_item_add_subtree(sub_item, ett_pn532_wakeup_enable);\r\nproto_tree_add_item(sub_tree, hf_pn532_wakeup_enable_i2c, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_pn532_wakeup_enable_gpio, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_pn532_wakeup_enable_spi, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_pn532_wakeup_enable_hsu, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_pn532_wakeup_enable_rf_level_detector, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_pn532_wakeup_enable_rfu_2, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_pn532_wakeup_enable_int_1, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_pn532_wakeup_enable_int_0, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nif (tvb_reported_length_remaining(tvb, offset) >= 1) {\r\nproto_tree_add_item(pn532_tree, hf_pn532_generate_irq, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\nbreak;\r\ncase POWER_DOWN_RSP:\r\noffset = dissect_status(pn532_tree, tvb, offset);\r\nbreak;\r\ncase RF_CONFIGURATION_REQ:\r\nproto_tree_add_item(pn532_tree, hf_pn532_config, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nconfig = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nswitch(config) {\r\ncase 0x01:\r\nproto_tree_add_item(pn532_tree, hf_pn532_config_not_used, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pn532_tree, hf_pn532_config_auto_rfca, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pn532_tree, hf_pn532_config_rf, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase 0x02:\r\nproto_tree_add_item(pn532_tree, hf_pn532_config_rfu, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_config_atr_res_timeout, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_config_timeout_non_dep, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase 0x04:\r\nproto_tree_add_item(pn532_tree, hf_pn532_config_max_rty_com, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase 0x05:\r\nproto_tree_add_item(pn532_tree, hf_pn532_config_max_rty_atr, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_config_max_rty_psl, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_config_max_rty_passive_activation, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase 0x0A:\r\ncase 0x0B:\r\nproto_tree_add_item(pn532_tree, hf_pn532_config_ciu_rf_cfg, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_config_ciu_gs_n_on, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_config_ciu_cw_gs_p, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_config_ciu_mod_gs_p, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_config_ciu_demon_rf_on, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_config_ciu_rx_threshold, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_config_ciu_demon_rf_off, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_config_ciu_gs_n_off, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nif (config == 0x0A) {\r\nproto_tree_add_item(pn532_tree, hf_pn532_config_ciu_mod_width, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_config_ciu_mif_nfc, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_config_ciu_tx_bit_phase, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\nbreak;\r\ncase 0x0C:\r\nproto_tree_add_item(pn532_tree, hf_pn532_config_ciu_gs_n_on, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_config_ciu_mod_gs_p, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_config_ciu_rx_threshold, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase 0x0D:\r\nsub_item = proto_tree_add_item(pn532_tree, hf_pn532_config_212_kbps, tvb, offset, 3, ENC_NA);\r\nsub_tree = proto_item_add_subtree(sub_item, ett_pn532_config_212_kbps);\r\nproto_tree_add_item(sub_tree, hf_pn532_config_ciu_rx_threshold, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_tree, hf_pn532_config_ciu_mod_width, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_tree, hf_pn532_config_ciu_mif_nfc, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nsub_item = proto_tree_add_item(pn532_tree, hf_pn532_config_424_kbps, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nsub_tree = proto_item_add_subtree(sub_item, ett_pn532_config_424_kbps);\r\nproto_tree_add_item(sub_tree, hf_pn532_config_ciu_rx_threshold, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_tree, hf_pn532_config_ciu_mod_width, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_tree, hf_pn532_config_ciu_mif_nfc, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nsub_item = proto_tree_add_item(pn532_tree, hf_pn532_config_848_kbps, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nsub_tree = proto_item_add_subtree(sub_item, ett_pn532_config_848_kbps);\r\nproto_tree_add_item(sub_tree, hf_pn532_config_ciu_rx_threshold, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_tree, hf_pn532_config_ciu_mod_width, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_tree, hf_pn532_config_ciu_mif_nfc, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ndefault:\r\nproto_tree_add_expert(pn532_tree, pinfo, &ei_unknown_data, tvb, offset, tvb_captured_length_remaining(tvb, offset));\r\noffset += tvb_captured_length_remaining(tvb, offset);\r\n}\r\nbreak;\r\ncase RF_CONFIGURATION_RSP:\r\nbreak;\r\ncase RF_REGULATION_TEST_REQ:\r\nproto_tree_add_item(pn532_tree, hf_pn532_txmode_nu_7, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pn532_tree, hf_pn532_txmode_tx_speed, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pn532_tree, hf_pn532_txmode_nu_2_3, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pn532_tree, hf_pn532_txmode_tx_framing, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase RF_REGULATION_TEST_RSP:\r\nbreak;\r\ncase IN_JUMP_FOR_DEP_REQ:\r\ncase IN_JUMP_FOR_PSL_REQ:\r\nproto_tree_add_item(pn532_tree, hf_pn532_communication_mode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_activation_baudrate, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbaudrate = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_jump_next_not_used_3_7, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pn532_tree, hf_pn532_jump_next_passive_initiator_data, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pn532_tree, hf_pn532_jump_next_gi, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pn532_tree, hf_pn532_jump_next_nfc_id_3i, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nvalue = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nif (value & 0x01) {\r\nif (baudrate == 0x00) {\r\nproto_tree_add_item(pn532_tree, hf_pn532_passive_initiator_data, tvb, offset, 4, ENC_NA);\r\noffset += 4;\r\n} else {\r\nproto_tree_add_item(pn532_tree, hf_pn532_passive_initiator_data, tvb, offset, 5, ENC_NA);\r\noffset += 5;\r\n}\r\n}\r\nif (value & 0x02) {\r\nproto_tree_add_item(pn532_tree, hf_pn532_nfc_id_3i, tvb, offset, 10, ENC_NA);\r\noffset += 10;\r\n}\r\nif (value & 0x04) {\r\nproto_tree_add_item(pn532_tree, hf_pn532_gi, tvb, offset, tvb_captured_length_remaining(tvb, offset), ENC_NA);\r\noffset += tvb_captured_length_remaining(tvb, offset);\r\n}\r\nbreak;\r\ncase IN_JUMP_FOR_DEP_RSP:\r\ncase IN_JUMP_FOR_PSL_RSP:\r\noffset = dissect_status(pn532_tree, tvb, offset);\r\nproto_tree_add_item(pn532_tree, hf_pn532_Tg, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_nfc_id_3t, tvb, offset, 10, ENC_NA);\r\noffset += 10;\r\nproto_tree_add_item(pn532_tree, hf_pn532_did_target, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_send_bit_rate_target, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_receive_bit_rate_target, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_timeout, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_optional_parameters, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_gt, tvb, offset, 10, ENC_NA);\r\noffset += 10;\r\nbreak;\r\ncase IN_LIST_PASSIVE_TARGET_REQ:\r\nproto_tree_add_item(pn532_tree, hf_pn532_MaxTg, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_BrTy, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbaudrate = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nif (command_data)\r\ncommand_data->data.baudrate = baudrate;\r\nswitch(baudrate) {\r\ncase ISO_IEC_14443A_106:\r\nwhile (tvb_reported_length_remaining(tvb, offset) >= 4) {\r\nproto_tree_add_item(pn532_tree, hf_pn532_14443a_uid, tvb, 6, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\n}\r\nbreak;\r\ncase FELICA_212:\r\ncase FELICA_424:\r\nnext_tvb = tvb_new_subset_length(tvb, offset, 5);\r\ncall_dissector(sub_handles[SUB_FELICA], next_tvb, pinfo, tree);\r\noffset += 5;\r\nbreak;\r\ncase ISO_IEC_14443B_106:\r\nproto_tree_add_item(pn532_tree, hf_pn532_afi, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nif (tvb_reported_length_remaining(tvb, offset) >= 1) {\r\nproto_tree_add_item(pn532_tree, hf_pn532_polling_method, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\nbreak;\r\ncase JEWEL_14443A_106:\r\nbreak;\r\n}\r\nbreak;\r\ncase IN_LIST_PASSIVE_TARGET_RSP:\r\nproto_tree_add_item(pn532_tree, hf_pn532_NbTg, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nvalue = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nif (command_data && command_data->command == IN_LIST_PASSIVE_TARGET_REQ)\r\nbaudrate = command_data->data.baudrate;\r\nelse\r\nbaudrate = -1;\r\nsub_item = proto_tree_add_uint(pn532_tree, hf_pn532_BrTy, tvb, offset, tvb_captured_length_remaining(tvb, offset), baudrate);\r\nPROTO_ITEM_SET_GENERATED(sub_item);\r\nfor (item_value = 1; item_value <= value; item_value += 1) {\r\nsub_item = proto_tree_add_item(pn532_tree, hf_pn532_target, tvb, offset, tvb_captured_length_remaining(tvb, offset), ENC_NA);\r\nsub_tree = proto_item_add_subtree(sub_item, ett_pn532_target);\r\nproto_item_append_text(sub_item, " %u/%u", item_value, value);\r\nproto_tree_add_item(sub_tree, hf_pn532_Tg, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nswitch (baudrate) {\r\ncase ISO_IEC_14443A_106:\r\nproto_tree_add_item(sub_tree, hf_pn532_sens_res, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(sub_tree, hf_pn532_sel_res, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_tree, hf_pn532_nfc_id_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nlength = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(sub_tree, hf_pn532_nfc_id_1, tvb, offset, length, ENC_NA);\r\noffset += length;\r\nif (tvb_reported_length_remaining(tvb, offset)) {\r\nproto_tree_add_item(sub_tree, hf_pn532_ats_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nlength = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(sub_tree, hf_pn532_ats, tvb, offset, length - 1, ENC_NA);\r\noffset += length - 1;\r\n}\r\nbreak;\r\ncase FELICA_212:\r\ncase FELICA_424:\r\nproto_tree_add_item(sub_tree, hf_pn532_pol_res_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_tree, hf_pn532_response_code, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sub_tree, hf_pn532_nfc_id_2t, tvb, offset, 8, ENC_NA);\r\noffset += 8;\r\nproto_tree_add_item(sub_tree, hf_pn532_pad, tvb, offset, 8, ENC_NA);\r\noffset += 8;\r\nif (tvb_reported_length_remaining(tvb, offset) >= 2) {\r\nproto_tree_add_item(sub_tree, hf_pn532_syst_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n} else if (tvb_reported_length_remaining(tvb, offset) == 1) {\r\nproto_tree_add_expert(pn532_tree, pinfo, &ei_unexpected_data, tvb, offset, 1);\r\noffset += 1;\r\n}\r\nbreak;\r\ncase ISO_IEC_14443B_106:\r\nproto_tree_add_item(sub_tree, hf_pn532_atqb_response, tvb, offset, 12, ENC_NA);\r\noffset += 12;\r\nproto_tree_add_item(sub_tree, hf_pn532_attrib_res_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nlength = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(sub_tree, hf_pn532_attrib_res, tvb, offset, length, ENC_NA);\r\noffset += length;\r\nbreak;\r\ncase JEWEL_14443A_106:\r\nproto_tree_add_item(sub_tree, hf_pn532_sens_res, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(sub_tree, hf_pn532_jewel_id, tvb, offset, 4, ENC_NA);\r\noffset += 4;\r\nbreak;\r\ndefault:\r\nproto_tree_add_expert(pn532_tree, pinfo, &ei_unknown_data, tvb, offset, tvb_captured_length_remaining(tvb, offset));\r\noffset += tvb_captured_length_remaining(tvb, offset);\r\n}\r\n}\r\nbreak;\r\ncase IN_ATR_REQ:\r\nproto_tree_add_item(pn532_tree, hf_pn532_Tg, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_next_not_used_2_7, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pn532_tree, hf_pn532_next_gi, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pn532_tree, hf_pn532_next_nfc_id_3i, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nvalue = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nif (value & 0x01) {\r\nproto_tree_add_item(pn532_tree, hf_pn532_nfc_id_3i, tvb, offset, 10, ENC_NA);\r\noffset += 10;\r\n}\r\nif (value & 0x02) {\r\nproto_tree_add_item(pn532_tree, hf_pn532_gi, tvb, offset, tvb_captured_length_remaining(tvb, offset), ENC_NA);\r\noffset += tvb_captured_length_remaining(tvb, offset);\r\n}\r\nbreak;\r\ncase IN_ATR_RSP:\r\noffset = dissect_status(pn532_tree, tvb, offset);\r\nproto_tree_add_item(pn532_tree, hf_pn532_nfc_id_3t, tvb, offset, 10, ENC_NA);\r\noffset += 10;\r\nproto_tree_add_item(pn532_tree, hf_pn532_did_target, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_send_bit_rate_target, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_receive_bit_rate_target, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_timeout, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_optional_parameters, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_gt, tvb, offset, 10, ENC_NA);\r\noffset += 10;\r\nbreak;\r\ncase IN_PSL_REQ:\r\nproto_tree_add_item(pn532_tree, hf_pn532_Tg, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_brit, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_brti, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase IN_PSL_RSP:\r\noffset = dissect_status(pn532_tree, tvb, offset);\r\nbreak;\r\ncase IN_DATA_EXCHANGE_REQ:\r\nproto_tree_add_item(pn532_tree, hf_pn532_Tg, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nif (sub_selected == SUB_MIFARE) {\r\nnext_tvb = tvb_new_subset_remaining(tvb, offset);\r\ncall_dissector(sub_handles[SUB_MIFARE], next_tvb, pinfo, tree);\r\noffset += tvb_captured_length_remaining(tvb, offset);\r\n} else if (sub_selected == SUB_ISO7816) {\r\nnext_tvb = tvb_new_subset_remaining(tvb, offset);\r\npinfo->p2p_dir = P2P_DIR_SENT;\r\ncall_dissector(sub_handles[SUB_ISO7816], next_tvb, pinfo, tree);\r\noffset += tvb_captured_length_remaining(tvb, offset);\r\n} else {\r\nproto_tree_add_item(pn532_tree, hf_pn532_data_out, tvb, offset, tvb_captured_length_remaining(tvb, offset), ENC_NA);\r\noffset += tvb_captured_length_remaining(tvb, offset);\r\n}\r\nbreak;\r\ncase IN_DATA_EXCHANGE_RSP:\r\noffset = dissect_status(pn532_tree, tvb, offset);\r\nif (sub_selected == SUB_ISO7816) {\r\nnext_tvb = tvb_new_subset_remaining(tvb, offset);\r\npinfo->p2p_dir = P2P_DIR_RECV;\r\ncall_dissector(sub_handles[SUB_ISO7816], next_tvb, pinfo, tree);\r\noffset += tvb_captured_length_remaining(tvb, offset);\r\n} else {\r\nproto_tree_add_item(pn532_tree, hf_pn532_data_in, tvb, offset, tvb_captured_length_remaining(tvb, offset), ENC_NA);\r\noffset += tvb_captured_length_remaining(tvb, offset);\r\n}\r\nbreak;\r\ncase IN_COMMUNICATE_THRU_REQ:\r\nif (sub_selected == SUB_FELICA) {\r\nproto_tree_add_item(pn532_tree, hf_pn532_payload_length, tvb, 2, 1, ENC_BIG_ENDIAN);\r\nnext_tvb = tvb_new_subset_remaining(tvb, 3);\r\ncall_dissector(sub_handles[SUB_FELICA], next_tvb, pinfo, tree);\r\n} else {\r\nproto_tree_add_item(pn532_tree, hf_pn532_data_out, tvb, offset, tvb_captured_length_remaining(tvb, offset), ENC_NA);\r\noffset += tvb_captured_length_remaining(tvb, offset);\r\n}\r\nbreak;\r\ncase IN_COMMUNICATE_THRU_RSP:\r\noffset = dissect_status(pn532_tree, tvb, offset);\r\nif (sub_selected == SUB_FELICA) {\r\nproto_tree_add_item(pn532_tree, hf_pn532_payload_length, tvb, 3, 1, ENC_BIG_ENDIAN);\r\nnext_tvb = tvb_new_subset_remaining(tvb, 4);\r\ncall_dissector(sub_handles[SUB_FELICA], next_tvb, pinfo, tree);\r\n} else {\r\nproto_tree_add_item(pn532_tree, hf_pn532_data_in, tvb, offset, tvb_captured_length_remaining(tvb, offset), ENC_NA);\r\noffset += tvb_captured_length_remaining(tvb, offset);\r\n}\r\nbreak;\r\ncase IN_DESELECT_REQ:\r\ncase IN_RELEASE_REQ:\r\ncase IN_SELECT_REQ:\r\nproto_tree_add_item(pn532_tree, hf_pn532_Tg, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase IN_DESELECT_RSP:\r\ncase IN_RELEASE_RSP:\r\ncase IN_SELECT_RSP:\r\noffset = dissect_status(pn532_tree, tvb, offset);\r\nbreak;\r\ncase IN_AUTO_POLL_REQ:\r\nproto_tree_add_item(pn532_tree, hf_pn532_poll_number, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_period, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nsub_item = proto_tree_add_item(pn532_tree, hf_pn532_autopoll_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nsub_tree = proto_item_add_subtree(sub_item, ett_pn532_autopoll_type);\r\nproto_tree_add_item(sub_tree, hf_pn532_autopoll_type_act, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_pn532_autopoll_type_dep, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_pn532_autopoll_type_tcl, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_pn532_autopoll_type_mf_fe, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_pn532_autopoll_type_not_used, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_pn532_autopoll_type_baudrate_and_modulation, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nwhile (tvb_reported_length_remaining(tvb, offset) >= 1) {\r\nsub_item = proto_tree_add_item(pn532_tree, hf_pn532_autopoll_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nsub_tree = proto_item_add_subtree(sub_item, ett_pn532_autopoll_type);\r\nproto_tree_add_item(sub_tree, hf_pn532_autopoll_type_act, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_pn532_autopoll_type_dep, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_pn532_autopoll_type_tcl, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_pn532_autopoll_type_mf_fe, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_pn532_autopoll_type_not_used, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_pn532_autopoll_type_baudrate_and_modulation, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\nbreak;\r\ncase IN_AUTO_POLL_RSP:\r\nproto_tree_add_item(pn532_tree, hf_pn532_NbTg, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nvalue = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nfor (item_value = 1; item_value <= value; item_value += 1) {\r\nsub_item = proto_tree_add_item(pn532_tree, hf_pn532_target, tvb, offset, 4, ENC_NA);\r\nsub_tree = proto_item_add_subtree(sub_item, ett_pn532_target);\r\nproto_item_append_text(sub_item, " %u/%u", item_value, value);\r\nnext_item = proto_tree_add_item(sub_tree, hf_pn532_autopoll_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nnext_tree = proto_item_add_subtree(next_item, ett_pn532_autopoll_type);\r\nproto_tree_add_item(next_tree, hf_pn532_autopoll_type_act, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(next_tree, hf_pn532_autopoll_type_dep, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(next_tree, hf_pn532_autopoll_type_tcl, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(next_tree, hf_pn532_autopoll_type_mf_fe, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(next_tree, hf_pn532_autopoll_type_not_used, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(next_tree, hf_pn532_autopoll_type_baudrate_and_modulation, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ntype = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nproto_tree_add_item(sub_tree, hf_pn532_target_data_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nlength = tvb_get_guint8(tvb, offset);\r\nproto_item_set_len(sub_item, length + 4);\r\noffset += 1;\r\nif (type & 0x40) {\r\nif (type & 0x80) {\r\nproto_tree_add_item(pn532_tree, hf_pn532_target_data, tvb, offset, length, ENC_NA);\r\noffset += length;\r\n}\r\nproto_tree_add_item(pn532_tree, hf_pn532_nfc_id_3t, tvb, offset, 10, ENC_NA);\r\noffset += 10;\r\nproto_tree_add_item(pn532_tree, hf_pn532_did_target, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_send_bit_rate_target, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_receive_bit_rate_target, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_timeout, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_optional_parameters, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_gt, tvb, offset, 10, ENC_NA);\r\noffset += 10;\r\n} else {\r\nproto_tree_add_item(pn532_tree, hf_pn532_target_data, tvb, offset, length, ENC_NA);\r\noffset += length;\r\n}\r\n}\r\nbreak;\r\ncase TG_INIT_AS_TARGET_REQ:\r\nproto_tree_add_item(pn532_tree, hf_pn532_mode_nu_3_7, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pn532_tree, hf_pn532_mode_picc_only, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pn532_tree, hf_pn532_mode_dep_only, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pn532_tree, hf_pn532_mode_passive_only, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nsub_item = proto_tree_add_item(pn532_tree, hf_pn532_mode_mifare_parameters, tvb, offset, 6, ENC_NA);\r\nsub_tree = proto_item_add_subtree(sub_item, ett_pn532_mifare_parameters);\r\nproto_tree_add_item(sub_tree, hf_pn532_mode_mifare_parameters_sens_res, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(sub_tree, hf_pn532_mode_mifare_parameters_nfc_id_1t, tvb, offset, 3, ENC_NA);\r\noffset += 3;\r\nproto_tree_add_item(sub_tree, hf_pn532_mode_mifare_parameters_sel_res, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nsub_item = proto_tree_add_item(pn532_tree, hf_pn532_mode_felica_parameters, tvb, offset, 18, ENC_NA);\r\nsub_tree = proto_item_add_subtree(sub_item, ett_pn532_felica_parameters);\r\nproto_tree_add_item(sub_tree, hf_pn532_mode_felica_parameters_nfc_id_2t, tvb, offset, 8, ENC_NA);\r\noffset += 8;\r\nproto_tree_add_item(sub_tree, hf_pn532_mode_felica_parameters_pad, tvb, offset, 8, ENC_NA);\r\noffset += 8;\r\nproto_tree_add_item(sub_tree, hf_pn532_mode_felica_parameters_system_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(pn532_tree, hf_pn532_mode_nfc_id_3t, tvb, offset, 10, ENC_NA);\r\noffset += 10;\r\nproto_tree_add_item(pn532_tree, hf_pn532_mode_gt_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nlength = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nif (length > 0) {\r\nproto_tree_add_item(pn532_tree, hf_pn532_mode_gt, tvb, offset, length, ENC_NA);\r\noffset += length;\r\n}\r\nproto_tree_add_item(pn532_tree, hf_pn532_mode_tk_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nlength = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nif (length > 0) {\r\nproto_tree_add_item(pn532_tree, hf_pn532_mode_tk, tvb, offset, length, ENC_NA);\r\noffset += length;\r\n}\r\nbreak;\r\ncase TG_INIT_AS_TARGET_RSP:\r\nproto_tree_add_item(pn532_tree, hf_pn532_mode_nu_7, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pn532_tree, hf_pn532_mode_baudrate, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pn532_tree, hf_pn532_mode_iso_iec_14443_4_picc, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pn532_tree, hf_pn532_mode_dep, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pn532_tree, hf_pn532_mode_framing_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_initiator_command, tvb, offset, tvb_captured_length_remaining(tvb, offset), ENC_NA);\r\noffset += tvb_captured_length_remaining(tvb, offset);\r\nbreak;\r\ncase TG_SET_GENERAL_BYTES_REQ:\r\nproto_tree_add_item(pn532_tree, hf_pn532_gt, tvb, offset, tvb_captured_length_remaining(tvb, offset), ENC_NA);\r\noffset += tvb_captured_length_remaining(tvb, offset);\r\nbreak;\r\ncase TG_SET_GENERAL_BYTES_RSP:\r\noffset = dissect_status(pn532_tree, tvb, offset);\r\nbreak;\r\ncase TG_GET_DATA_REQ:\r\nbreak;\r\ncase TG_GET_DATA_RSP:\r\noffset = dissect_status(pn532_tree, tvb, offset);\r\nproto_tree_add_item(pn532_tree, hf_pn532_data_in, tvb, offset, tvb_captured_length_remaining(tvb, offset), ENC_NA);\r\noffset += tvb_captured_length_remaining(tvb, offset);\r\nbreak;\r\ncase TG_SET_DATA_REQ:\r\ncase TG_SET_METADATA_REQ:\r\nproto_tree_add_item(pn532_tree, hf_pn532_data_out, tvb, offset, tvb_captured_length_remaining(tvb, offset), ENC_NA);\r\noffset += tvb_captured_length_remaining(tvb, offset);\r\nbreak;\r\ncase TG_SET_DATA_RSP:\r\ncase TG_SET_METADATA_RSP:\r\noffset = dissect_status(pn532_tree, tvb, offset);\r\nbreak;\r\ncase TG_GET_INITIATOR_CMD_REQ:\r\nbreak;\r\ncase TG_GET_INITIATOR_CMD_RSP:\r\noffset = dissect_status(pn532_tree, tvb, offset);\r\nproto_tree_add_item(pn532_tree, hf_pn532_initiator_command, tvb, offset, tvb_captured_length_remaining(tvb, offset), ENC_NA);\r\noffset += tvb_captured_length_remaining(tvb, offset);\r\nbreak;\r\ncase TG_RESP_TO_INITIATOR_REQ:\r\nproto_tree_add_item(pn532_tree, hf_pn532_tg_response, tvb, offset, tvb_captured_length_remaining(tvb, offset), ENC_NA);\r\noffset += tvb_captured_length_remaining(tvb, offset);\r\nbreak;\r\ncase TG_RESP_TO_INITIATOR_RSP:\r\noffset = dissect_status(pn532_tree, tvb, offset);\r\nbreak;\r\ncase TG_GET_TARGET_STATUS_REQ:\r\nbreak;\r\ncase TG_GET_TARGET_STATUS_RSP:\r\nproto_tree_add_item(pn532_tree, hf_pn532_state, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pn532_tree, hf_pn532_brit_nu_7, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pn532_tree, hf_pn532_brit_speed_initiator, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pn532_tree, hf_pn532_brit_nu_3, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pn532_tree, hf_pn532_brit_speed_target, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ndefault:\r\nproto_tree_add_expert(pn532_tree, pinfo, &ei_unknown_data, tvb, offset, tvb_captured_length_remaining(tvb, offset));\r\noffset += tvb_captured_length_remaining(tvb, offset);\r\nbreak;\r\n}\r\nif (tvb_reported_length_remaining(tvb, offset) > 0) {\r\nproto_tree_add_expert(pn532_tree, pinfo, &ei_unexpected_data, tvb, offset, tvb_captured_length_remaining(tvb, offset));\r\noffset += tvb_captured_length_remaining(tvb, offset);\r\n}\r\nreturn offset;\r\n}\r\nvoid proto_register_pn532(void)\r\n{\r\nmodule_t *pref_mod;\r\nexpert_module_t *expert_pn532;\r\nstatic hf_register_info hf[] = {\r\n{&hf_pn532_command,\r\n{"Command", "pn532.cmd", FT_UINT8, BASE_HEX | BASE_EXT_STRING,\r\n&pn532_commands_ext, 0x0, NULL, HFILL}},\r\n{&hf_pn532_direction,\r\n{"Direction", "pn532.tfi", FT_UINT8, BASE_HEX,\r\nVALS(pn532_directions), 0x0, NULL, HFILL}},\r\n{&hf_pn532_status_nad_present,\r\n{"NAD Present", "pn532.status.nad_present", FT_UINT8, BASE_HEX,\r\nNULL, 0x80, NULL, HFILL}},\r\n{&hf_pn532_status_mi,\r\n{"MI", "pn532.status.mi", FT_UINT8, BASE_HEX,\r\nNULL, 0x40, NULL, HFILL}},\r\n{&hf_pn532_status_error_code,\r\n{"Error Code", "pn532.status.error_code", FT_UINT8, BASE_HEX,\r\nVALS(pn532_errors), 0x3F, NULL, HFILL}},\r\n{&hf_pn532_error,\r\n{"Last Error", "pn532.last_error", FT_UINT8, BASE_HEX,\r\nVALS(pn532_errors), 0x00, NULL, HFILL}},\r\n{&hf_pn532_BrTy,\r\n{"Baud Rate and Modulation", "pn532.BrTy", FT_UINT8, BASE_HEX,\r\nVALS(pn532_brtypes), 0x0, NULL, HFILL}},\r\n{&hf_pn532_MaxTg,\r\n{"Maximum Number of Targets", "pn532.MaxTg", FT_UINT8, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{&hf_pn532_Tg,\r\n{"Logical Target Number", "pn532.Tg", FT_INT8, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{&hf_pn532_NbTg,\r\n{"Number of Targets", "pn532.NbTg", FT_UINT8, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{&hf_pn532_payload_length,\r\n{"Payload Length", "pn532.payload.length", FT_INT8, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{&hf_pn532_ic_version,\r\n{"Integrated Circuit Version", "pn532.ic.version", FT_UINT8, BASE_HEX,\r\nNULL, 0x0, "Version of the IC. For PN532, the contain of this byte is 0x32", HFILL}},\r\n{&hf_pn532_fw_version,\r\n{"Firmware Version", "pn532.fw.version", FT_UINT8, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{&hf_pn532_fw_revision,\r\n{"Firmware Revision", "pn532.fw.revision", FT_UINT8, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{&hf_pn532_fw_support,\r\n{"Firmware Support", "pn532.fw.support", FT_UINT8, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{&hf_pn532_fw_support_rfu,\r\n{"RFU", "pn532.fw.support.rfu", FT_UINT8, BASE_HEX,\r\nNULL, 0xF8, NULL, HFILL}},\r\n{&hf_pn532_fw_support_iso_018092,\r\n{"ISO 018092", "pn532.fw.support.iso_018092", FT_BOOLEAN, 8,\r\nNULL, 0x04, NULL, HFILL}},\r\n{&hf_pn532_fw_support_iso_iec_14443_type_b,\r\n{"ISO/IEC 14443 Type B", "pn532.fw.support.iso_iec_14443_type_b", FT_BOOLEAN, 8,\r\nNULL, 0x02, NULL, HFILL}},\r\n{&hf_pn532_fw_support_iso_iec_14443_type_a,\r\n{"ISO/IEC 14443 Type A", "pn532.fw.support.iso_iec_14443_type_a", FT_BOOLEAN, 8,\r\nNULL, 0x01, NULL, HFILL}},\r\n{&hf_pn532_14443a_uid,\r\n{"ISO/IEC 14443-A UID", "pn532.iso.14443a.uid", FT_UINT64, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{&hf_pn532_sam_mode,\r\n{"SAM Mode", "pn532.sam.mode", FT_UINT8, BASE_HEX,\r\nVALS(pn532_sam_modes), 0x0, NULL, HFILL}},\r\n{&hf_pn532_sam_timeout,\r\n{"SAM Timeout", "pn532.sam.timeout", FT_UINT8, BASE_CUSTOM,\r\nCF_FUNC(sam_timeout_base), 0x0, NULL, HFILL}},\r\n{&hf_pn532_sam_irq,\r\n{"SAM IRQ", "pn532.sam.irq", FT_UINT8, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{&hf_pn532_config,\r\n{"Config Item", "pn532.config", FT_UINT8, BASE_HEX,\r\nVALS(pn532_config_vals), 0x0, NULL, HFILL}},\r\n{&hf_pn532_config_not_used,\r\n{"Not used", "pn532.config.not_used", FT_UINT8, BASE_HEX,\r\nNULL, 0xFC, NULL, HFILL}},\r\n{&hf_pn532_config_auto_rfca,\r\n{"Auto RFCA", "pn532.config.auto_rfca", FT_BOOLEAN, 8,\r\nNULL, 0x02, NULL, HFILL}},\r\n{&hf_pn532_config_rf,\r\n{"RF", "pn532.config.rf", FT_BOOLEAN, 8,\r\nNULL, 0x01, NULL, HFILL}},\r\n{&hf_pn532_config_rfu,\r\n{"RFU", "pn532.config.rfu", FT_UINT8, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_config_atr_res_timeout,\r\n{"ATR Res Timeout", "pn532.config.atr_res_timeout", FT_UINT8, BASE_HEX,\r\nVALS(pn532_config_timeout_vals), 0x00, NULL, HFILL}},\r\n{&hf_pn532_config_timeout_non_dep,\r\n{"TimeOut during non-DEP communications", "pn532.config.timeout_non_dep", FT_UINT8, BASE_HEX,\r\nVALS(pn532_config_timeout_vals), 0x00, NULL, HFILL}},\r\n{&hf_pn532_config_max_rty_com,\r\n{"Max Retry COM", "pn532.config.max_rty_com", FT_UINT8, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_config_max_rty_atr,\r\n{"Max Retry ATR", "pn532.config.max_rty_atr", FT_UINT8, BASE_DEC,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_config_max_rty_psl,\r\n{"Max Retry PSL", "pn532.config.max_rty_psl", FT_UINT8, BASE_DEC,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_config_max_rty_passive_activation,\r\n{"Max Retry Passive Activation", "pn532.config.max_rty_passive_activation", FT_UINT8, BASE_DEC,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_afi,\r\n{"AFI", "pn532.afi", FT_UINT8, BASE_DEC,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_polling_method,\r\n{"Polling Method", "pn532.polling_method", FT_UINT8, BASE_DEC,\r\nVALS(pn532_polling_method_vals), 0x00, NULL, HFILL}},\r\n{&hf_pn532_config_ciu_rf_cfg,\r\n{"CIU RF Cfg", "pn532.ciu_rf_cfg", FT_UINT8, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_config_ciu_gs_n_on,\r\n{"CIU GsN On", "pn532.ciu_gs_n_on", FT_UINT8, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_config_ciu_gs_n_off,\r\n{"CIU GsN Off", "pn532.ciu_gs_n_off", FT_UINT8, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_config_ciu_cw_gs_p,\r\n{"CIU CW GsP", "pn532.ciu_cw_gs_p", FT_UINT8, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_config_ciu_demon_rf_on,\r\n{"CIU Demon when RF is On", "pn532.ciu_demon_rf_on", FT_UINT8, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_config_ciu_demon_rf_off,\r\n{"CIU Demon when RF is Off", "pn532.ciu_demon_rf_off", FT_UINT8, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_config_ciu_rx_threshold,\r\n{"CIU RX Threshold", "pn532.ciu_rx_threshold", FT_UINT8, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_config_ciu_mod_width,\r\n{"CIU Mod Width", "pn532.ciu_mod_width", FT_UINT8, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_config_ciu_mod_gs_p,\r\n{"CIU Mod GsP", "pn532.ciu_mod_gs_p", FT_UINT8, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_config_ciu_mif_nfc,\r\n{"CIU Mif NFC", "pn532.ciu_mif_nfc", FT_UINT8, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_config_ciu_tx_bit_phase,\r\n{"CIU TX Bit Phase", "pn532.ciu_tx_bit_phase", FT_UINT8, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_config_212_kbps,\r\n{"212 kbps settings", "pn532.212_kbps", FT_UINT24, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_config_424_kbps,\r\n{"424 kbps settings", "pn532.424_kbps", FT_UINT24, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_config_848_kbps,\r\n{"848 kbps settings", "pn532.848_kbps", FT_UINT24, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_state,\r\n{"State", "pn532.state", FT_UINT8, BASE_HEX,\r\nVALS(pn532_state_vals), 0x00, NULL, HFILL}},\r\n{&hf_pn532_brit_nu_7,\r\n{"Not Used", "pn532.brit.not_used.7", FT_UINT8, BASE_HEX,\r\nNULL, 0x80, NULL, HFILL}},\r\n{&hf_pn532_brit_speed_initiator,\r\n{"Speed Initiator", "pn532.brit.speed_initiator", FT_UINT8, BASE_HEX,\r\nVALS(pn532_speed_vals), 0x70, NULL, HFILL}},\r\n{&hf_pn532_brit_nu_3,\r\n{"Not Used", "pn532.brit.not_used.3", FT_UINT8, BASE_HEX,\r\nNULL, 0x08, NULL, HFILL}},\r\n{&hf_pn532_brit_speed_target,\r\n{"Speed Target", "pn532.brit.speed_target", FT_UINT8, BASE_HEX,\r\nVALS(pn532_speed_vals), 0x07, NULL, HFILL}},\r\n{&hf_pn532_tg_response,\r\n{"TG Response", "pn532.tg_response", FT_BYTES, BASE_NONE,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_initiator_command,\r\n{"Initiator Command", "pn532.initiator_command", FT_BYTES, BASE_NONE,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_data_out,\r\n{"Data Out", "pn532.data_out", FT_BYTES, BASE_NONE,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_data_in,\r\n{"Data In", "pn532.data_in", FT_BYTES, BASE_NONE,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_gt,\r\n{"Gt", "pn532.gt", FT_BYTES, BASE_NONE,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_gi,\r\n{"Gi", "pn532.gi", FT_BYTES, BASE_NONE,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_mode_nu_3_7,\r\n{"Not Used", "pn532.mode.not_used.3_7", FT_UINT8, BASE_HEX,\r\nNULL, 0xF8, NULL, HFILL}},\r\n{&hf_pn532_mode_picc_only,\r\n{"PICC Only", "pn532.mode.picc_only", FT_BOOLEAN, 8,\r\nNULL, 0x04, NULL, HFILL}},\r\n{&hf_pn532_mode_dep_only,\r\n{"DEP Only", "pn532.mode.dep_only", FT_BOOLEAN, 8,\r\nNULL, 0x02, NULL, HFILL}},\r\n{&hf_pn532_mode_passive_only,\r\n{"Passive Only", "pn532.mode.passive_only", FT_BOOLEAN, 8,\r\nNULL, 0x01, NULL, HFILL}},\r\n{&hf_pn532_mode_mifare_parameters,\r\n{"Mifare Parameters", "pn532.mode.mifare_parameters", FT_NONE, BASE_NONE,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_mode_mifare_parameters_sens_res,\r\n{"SENS RES", "pn532.mode.mifare_parameters.sens_res", FT_UINT16, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_mode_mifare_parameters_nfc_id_1t,\r\n{"NFC ID 1t", "pn532.mode.mifare_parameters.nfc_id_1t", FT_BYTES, BASE_NONE,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_mode_mifare_parameters_sel_res,\r\n{"SEL RES", "pn532.mode.mifare_parameters.sel_res", FT_UINT8, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_mode_felica_parameters,\r\n{"FeliCA Parameters", "pn532.mode.felica_parameters", FT_NONE, BASE_NONE,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_mode_felica_parameters_nfc_id_2t,\r\n{"NFC ID 2t", "pn532.mode.felica_parameters.nfc_id_2t", FT_BYTES, BASE_NONE,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_mode_felica_parameters_pad,\r\n{"Pad", "pn532.mode.felica_parameters.pad", FT_BYTES, BASE_NONE,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_mode_felica_parameters_system_code,\r\n{"System Code", "pn532.mode.felica_parameters.system_code", FT_UINT16, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_mode_nfc_id_3t,\r\n{"NFC ID 3t", "pn532.mode.nfc_id_3t", FT_BYTES, BASE_NONE,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_mode_gt,\r\n{"Gt", "pn532.mode.gt", FT_BYTES, BASE_NONE,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_mode_gt_length,\r\n{"Gt Length", "pn532.mode.gt.length", FT_UINT8, BASE_DEC,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_mode_tk,\r\n{"Tk", "pn532.mode.tk", FT_BYTES, BASE_NONE,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_mode_tk_length,\r\n{"Tk Length", "pn532.mode.tk.length", FT_UINT8, BASE_DEC,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_mode_nu_7,\r\n{"Not Used", "pn532.mode.not_used.7", FT_BOOLEAN, 8,\r\nNULL, 0x80, NULL, HFILL}},\r\n{&hf_pn532_mode_baudrate,\r\n{"Baudrate", "pn532.mode.baudrate", FT_UINT8, BASE_HEX,\r\nVALS(pn532_speed_vals), 0x70, NULL, HFILL}},\r\n{&hf_pn532_mode_iso_iec_14443_4_picc,\r\n{"ISO/IEC 14443-4 PICC", "pn532.mode.iso_iec_14443_4_picc", FT_BOOLEAN, 8,\r\nNULL, 0x08, NULL, HFILL}},\r\n{&hf_pn532_mode_dep,\r\n{"DEP", "pn532.mode.dep", FT_BOOLEAN, 8,\r\nNULL, 0x04, NULL, HFILL}},\r\n{&hf_pn532_mode_framing_type,\r\n{"Framing Type", "pn532.mode.framing_type", FT_UINT8, BASE_HEX,\r\nVALS(pn532_framing_type_vals), 0x03, NULL, HFILL}},\r\n{&hf_pn532_brit,\r\n{"BRit", "pn532.brit", FT_UINT8, BASE_HEX,\r\nVALS(pn532_speed_vals), 0x00, NULL, HFILL}},\r\n{&hf_pn532_brti,\r\n{"BRti", "pn532.brti", FT_UINT8, BASE_HEX,\r\nVALS(pn532_speed_vals), 0x00, NULL, HFILL}},\r\n{&hf_pn532_txmode_nu_7,\r\n{"Not Used", "pn532.txmode.not_used.7", FT_BOOLEAN, 8,\r\nNULL, 0x80, NULL, HFILL}},\r\n{&hf_pn532_txmode_tx_speed,\r\n{"Tx Speed", "pn532.txmode.txspeed", FT_UINT8, BASE_HEX,\r\nVALS(pn532_txspeed_vals), 0x70, NULL, HFILL}},\r\n{&hf_pn532_txmode_nu_2_3,\r\n{"Not Used", "pn532.txmode.not_used.2_3", FT_UINT8, BASE_HEX,\r\nNULL, 0xC0, NULL, HFILL}},\r\n{&hf_pn532_txmode_tx_framing,\r\n{"Tx Framing", "pn532.txmode.not_used.2_3", FT_UINT8, BASE_HEX,\r\nVALS(pn532_txframing_vals), 0x03, NULL, HFILL}},\r\n{&hf_pn532_baudrate,\r\n{"Baudrate", "pn532.baudrate", FT_UINT8, BASE_HEX,\r\nVALS(pn532_baudrate_vals), 0x00, NULL, HFILL}},\r\n{&hf_pn532_flags,\r\n{"Flags", "pn532.flags", FT_UINT8, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_flags_rfu_7,\r\n{"RFU", "pn532.flags.rfu.7", FT_BOOLEAN, 8,\r\nNULL, 0x80, NULL, HFILL}},\r\n{&hf_pn532_flags_remove_preamble_and_postamble,\r\n{"Remove Preamble and Postamble", "pn532.flags.remove_preamble_and_postamble", FT_BOOLEAN, 8,\r\nNULL, 0x40, NULL, HFILL}},\r\n{&hf_pn532_flags_iso_14443_4_picc_emulation,\r\n{"ISO 14443-4 PICC Emulation", "pn532.flags.iso_14443_4_picc_emulation", FT_BOOLEAN, 8,\r\nNULL, 0x20, NULL, HFILL}},\r\n{&hf_pn532_flags_automatic_rats,\r\n{"Automatic RATS", "pn532.flags.automatic_rats", FT_BOOLEAN, 8,\r\nNULL, 0x10, NULL, HFILL}},\r\n{&hf_pn532_flags_rfu_3,\r\n{"RFU", "pn532.flags.rfu.3", FT_BOOLEAN, 8,\r\nNULL, 0x08, NULL, HFILL}},\r\n{&hf_pn532_flags_automatic_atr_res,\r\n{"Automatic ATR RES", "pn532.flags.automatic_atr_res", FT_BOOLEAN, 8,\r\nNULL, 0x04, NULL, HFILL}},\r\n{&hf_pn532_flags_did_used,\r\n{"DID Used", "pn532.flags.did_used", FT_BOOLEAN, 8,\r\nNULL, 0x02, NULL, HFILL}},\r\n{&hf_pn532_flags_nad_used,\r\n{"NAD Used", "pn532.flags.nad_used", FT_BOOLEAN, 8,\r\nNULL, 0x01, NULL, HFILL}},\r\n{&hf_pn532_wakeup_enable,\r\n{"Wakeup Enable", "pn532.wakeup_enable", FT_UINT8, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_target,\r\n{"Target", "pn532.target", FT_NONE, BASE_NONE,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_generate_irq,\r\n{"Generate IRQ", "pn532.generate_irq", FT_UINT8, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_register_address,\r\n{"Register Address", "pn532.register.address", FT_UINT16, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_register_value,\r\n{"Register Value", "pn532.register.value", FT_UINT8, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_field,\r\n{"Field", "pn532.field", FT_BOOLEAN, BASE_NONE,\r\nTFS(&tfs_present_not_present), 0x00, "Field indicates if an external RF field is present and detected by the PN532", HFILL}},\r\n{&hf_pn532_brrx,\r\n{"Baudrate Rx", "pn532.brrx", FT_UINT8, BASE_HEX,\r\nVALS(pn532_speed_vals), 0x00, NULL, HFILL}},\r\n{&hf_pn532_brtx,\r\n{"Baudrate Tx", "pn532.brtx", FT_UINT8, BASE_HEX,\r\nVALS(pn532_speed_vals), 0x00, NULL, HFILL}},\r\n{&hf_pn532_type,\r\n{"Type", "pn532.type", FT_UINT8, BASE_HEX,\r\nVALS(pn532_type_vals), 0x00, NULL, HFILL}},\r\n{&hf_pn532_sam_status,\r\n{"SAM Status", "pn532.sam.status", FT_UINT8, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_wakeup_enable_i2c,\r\n{"I2C", "pn532.wakeup_enable.i2c", FT_BOOLEAN, 8,\r\nNULL, 0x80, NULL, HFILL}},\r\n{&hf_pn532_wakeup_enable_gpio,\r\n{"GPIO", "pn532.wakeup_enable.gpio", FT_BOOLEAN, 8,\r\nNULL, 0x40, NULL, HFILL}},\r\n{&hf_pn532_wakeup_enable_spi,\r\n{"SPI", "pn532.wakeup_enable.spi", FT_BOOLEAN, 8,\r\nNULL, 0x20, NULL, HFILL}},\r\n{&hf_pn532_wakeup_enable_hsu,\r\n{"HSU", "pn532.wakeup_enable.hsu", FT_BOOLEAN, 8,\r\nNULL, 0x10, NULL, HFILL}},\r\n{&hf_pn532_wakeup_enable_rf_level_detector,\r\n{"RF Level Detector", "pn532.wakeup_enable.rf_level_detector", FT_BOOLEAN, 8,\r\nNULL, 0x08, NULL, HFILL}},\r\n{&hf_pn532_wakeup_enable_rfu_2,\r\n{"RFU", "pn532.wakeup_enable.rfu_2", FT_BOOLEAN, 8,\r\nNULL, 0x04, NULL, HFILL}},\r\n{&hf_pn532_wakeup_enable_int_1,\r\n{"I2C", "pn532.wakeup_enable.int.1", FT_BOOLEAN, 8,\r\nNULL, 0x02, NULL, HFILL}},\r\n{&hf_pn532_wakeup_enable_int_0,\r\n{"I2C", "pn532.wakeup_enable.int.0", FT_BOOLEAN, 8,\r\nNULL, 0x01, NULL, HFILL}},\r\n{&hf_pn532_gpio_ioi1,\r\n{"GPIO IOI1", "pn532.gpio.ioi1", FT_UINT8, BASE_HEX,\r\nNULL, 0xFF, NULL, HFILL}},\r\n{&hf_pn532_gpio_p3,\r\n{"GPIO P3", "pn532.gpio.p3", FT_UINT8, BASE_HEX,\r\nNULL, 0xFF, NULL, HFILL}},\r\n{&hf_pn532_gpio_p7,\r\n{"GPIO P7", "pn532.gpio.p7", FT_UINT8, BASE_HEX,\r\nNULL, 0xFF, NULL, HFILL}},\r\n{&hf_pn532_poll_number,\r\n{"Poll Number", "pn532.poll_number", FT_UINT8, BASE_DEC,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_period,\r\n{"Period", "pn532.period", FT_UINT8, BASE_DEC,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_autopoll_type,\r\n{"Type", "pn532.autopoll_type", FT_UINT8, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_target_data,\r\n{"Target Data", "pn532.target_data", FT_BYTES, BASE_NONE,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_target_data_length,\r\n{"Target Data Length", "pn532.target_data.length", FT_UINT8, BASE_DEC,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_autopoll_type_act,\r\n{"Active Mode", "pn532.autopoll_type.active", FT_BOOLEAN, 8,\r\nNULL, 0x80, NULL, HFILL}},\r\n{&hf_pn532_autopoll_type_dep,\r\n{"DEP", "pn532.autopoll_type.dep", FT_BOOLEAN, 8,\r\nNULL, 0x40, NULL, HFILL}},\r\n{&hf_pn532_autopoll_type_tcl,\r\n{"TCL", "pn532.autopoll_type.tcl", FT_BOOLEAN, 8,\r\nNULL, 0x20, NULL, HFILL}},\r\n{&hf_pn532_autopoll_type_mf_fe,\r\n{"Mf_Fe", "pn532.autopoll_type.mf_fe", FT_BOOLEAN, 8,\r\nNULL, 0x10, NULL, HFILL}},\r\n{&hf_pn532_autopoll_type_not_used,\r\n{"Not used", "pn532.autopoll_type.not_used", FT_BOOLEAN, 8,\r\nNULL, 0x08, NULL, HFILL}},\r\n{&hf_pn532_autopoll_type_baudrate_and_modulation,\r\n{"Baudrate and Modulation", "pn532.autopoll_type.baudrate_and_modulation", FT_UINT8, BASE_HEX,\r\nVALS(pn532_brtypes), 0x07, NULL, HFILL}},\r\n{&hf_pn532_nfc_id_3i,\r\n{"NFC ID 3i", "pn532.nfc_id_3i", FT_BYTES, BASE_NONE,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_next_not_used_2_7,\r\n{"Not Used", "pn532.next.not_used.2_7", FT_BOOLEAN, 8,\r\nNULL, 0xFC, NULL, HFILL}},\r\n{&hf_pn532_next_gi,\r\n{"Gi", "pn532.next.gi", FT_BOOLEAN, 8,\r\nTFS(&tfs_present_not_present), 0x02, NULL, HFILL}},\r\n{&hf_pn532_next_nfc_id_3i,\r\n{"NFC ID 3i", "pn532.next.nfc_id_3i", FT_BOOLEAN, 8,\r\nTFS(&tfs_present_not_present), 0x01, NULL, HFILL}},\r\n{&hf_pn532_nfc_id_3t,\r\n{"NFC ID 3t", "pn532.nfc_id_3t", FT_BYTES, BASE_NONE,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_communication_mode,\r\n{"Communication Mode", "pn532.communication_mode", FT_UINT8, BASE_HEX,\r\nVALS(pn532_communication_mode_vals), 0x00, NULL, HFILL}},\r\n{&hf_pn532_activation_baudrate,\r\n{"Baudrate", "pn532.activation_baudrate", FT_UINT8, BASE_HEX,\r\nVALS(pn532_speed_vals), 0x70, NULL, HFILL}},\r\n{&hf_pn532_jump_next_not_used_3_7,\r\n{"Not Used", "pn532.jump_next.not_used.3_7", FT_BOOLEAN, 8,\r\nNULL, 0xF8, NULL, HFILL}},\r\n{&hf_pn532_jump_next_gi,\r\n{"Gi", "pn532.jump_next.gi", FT_BOOLEAN, 8,\r\nTFS(&tfs_present_not_present), 0x04, NULL, HFILL}},\r\n{&hf_pn532_jump_next_nfc_id_3i,\r\n{"NFC ID 3i", "pn532.jump_next.nfc_id_3i", FT_BOOLEAN, 8,\r\nTFS(&tfs_present_not_present), 0x02, NULL, HFILL}},\r\n{&hf_pn532_jump_next_passive_initiator_data,\r\n{"Passive Initiator Data", "pn532.jump_next.passive_initiator_data", FT_BOOLEAN, 8,\r\nTFS(&tfs_present_not_present), 0x01, NULL, HFILL}},\r\n{&hf_pn532_passive_initiator_data,\r\n{"Passive Initiator Data", "pn532.passive_initiator_data", FT_BYTES, BASE_NONE,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_did_target,\r\n{"DID Target", "pn532.did_target", FT_UINT8, BASE_HEX_DEC,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_send_bit_rate_target,\r\n{"Send Bit Rate Target", "pn532.send_bit_rate_target", FT_UINT8, BASE_DEC_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_receive_bit_rate_target,\r\n{"Receive Bit Rate Target", "pn532.receive_bit_rate_target", FT_UINT8, BASE_DEC_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_timeout,\r\n{"Timeout", "pn532.timeout", FT_UINT8, BASE_DEC_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_optional_parameters,\r\n{"Optional Parameters", "pn532.optional_parameters", FT_UINT8, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_test_number,\r\n{"Test Number", "pn532.test_number", FT_UINT8, BASE_HEX,\r\nVALS(pn532_test_number_vals), 0x00, NULL, HFILL}},\r\n{&hf_pn532_parameters,\r\n{"Parameters", "pn532.diagnose_parameters", FT_BYTES, BASE_NONE,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_parameters_length,\r\n{"Parameters Length", "pn532.diagnose_parameters.length", FT_UINT8, BASE_DEC,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_sens_res,\r\n{"SENS RES", "pn532.sens_res", FT_UINT16, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_sel_res,\r\n{"SEL RES", "pn532.sel_res", FT_UINT8, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_nfc_id_length,\r\n{"NFC ID Length", "pn532.nfc_id_length", FT_UINT8, BASE_DEC,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_nfc_id_1,\r\n{"NFC ID 1", "pn532.nfc_id_1", FT_BYTES, BASE_NONE,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_ats_length,\r\n{"ATS Length", "pn532.ats_length", FT_UINT8, BASE_DEC,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_ats,\r\n{"ATS", "pn532.ats", FT_BYTES, BASE_NONE,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_pol_res_length,\r\n{"POL RES Length", "pn532.pol_res_length", FT_UINT8, BASE_DEC,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_response_code,\r\n{"Response Code", "pn532.response_code", FT_UINT8, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_nfc_id_2t,\r\n{"NFC ID 2t", "pn532.nfc_id_2t", FT_BYTES, BASE_NONE,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_pad,\r\n{"Pad", "pn532.pad", FT_BYTES, BASE_NONE,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_syst_code,\r\n{"Syst Code", "pn532.syst_code", FT_UINT16, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_atqb_response,\r\n{"ATQB Response", "pn532.atqb_response", FT_BYTES, BASE_NONE,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_attrib_res_length,\r\n{"Attrib RES Length", "pn532.attrib_res_length", FT_UINT8, BASE_DEC,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_attrib_res,\r\n{"Attrib RES", "pn532.attrib_res", FT_BYTES, BASE_NONE,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_jewel_id,\r\n{"Jewel ID", "pn532.jewel_id", FT_BYTES, BASE_NONE,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_response_for,\r\n{ "Response for", "pn532.response_for", FT_FRAMENUM, BASE_NONE,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_diagnose_baudrate,\r\n{"Diagnose Baudrate", "pn532.diagnose_baudrate", FT_UINT8, BASE_HEX,\r\nVALS(pn532_diagnose_baudrate_vals), 0x00, NULL, HFILL}},\r\n{&hf_pn532_reply_delay,\r\n{"Reply Delay", "pn532.sam.reply_delay", FT_UINT8, BASE_CUSTOM,\r\nCF_FUNC(replay_delay_base), 0x0, NULL, HFILL}},\r\n{&hf_pn532_ciu_tx_mode,\r\n{"CIU Tx Mode", "pn532.ciu_tx_mode", FT_UINT8, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_ciu_rx_mode,\r\n{"CIU Rx Mode", "pn532.ciu_rx_mode", FT_UINT8, BASE_HEX,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_diagnose_number_of_fails,\r\n{"Number of Fails", "pn532.number_of_fails", FT_UINT8, BASE_DEC,\r\nNULL, 0x00, NULL, HFILL}},\r\n{&hf_pn532_diagnose_result,\r\n{"Result", "pn532.result", FT_BOOLEAN, BASE_NONE,\r\nTFS(&tfs_ok_error), 0x00, NULL, HFILL}},\r\n{&hf_pn532_andet_bot,\r\n{"Andet Bot", "pn532.andet.bot", FT_BOOLEAN, 8,\r\nNULL, 0x80, NULL, HFILL}},\r\n{&hf_pn532_andet_up,\r\n{"Andet Up", "pn532.andet.up", FT_BOOLEAN, 8,\r\nNULL, 0x40, NULL, HFILL}},\r\n{&hf_pn532_andet_ith,\r\n{"Andet Ith", "pn532.andet.ith", FT_BOOLEAN, 8,\r\nNULL, 0x3E, NULL, HFILL}},\r\n{&hf_pn532_andet_en,\r\n{"Andet En", "pn532.andet.en", FT_BOOLEAN, 8,\r\nNULL, 0x01, NULL, HFILL}}\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_unknown_data, { "pn532.expert.unknown_data", PI_PROTOCOL, PI_NOTE, "Unknown data", EXPFILL }},\r\n{ &ei_unexpected_data, { "pn532.expert.unexpected_data", PI_PROTOCOL, PI_WARN, "Unexpected data", EXPFILL }},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_pn532,\r\n&ett_pn532_flags,\r\n&ett_pn532_target,\r\n&ett_pn532_fw_support,\r\n&ett_pn532_config_212_kbps,\r\n&ett_pn532_config_424_kbps,\r\n&ett_pn532_config_848_kbps,\r\n&ett_pn532_mifare_parameters,\r\n&ett_pn532_felica_parameters,\r\n&ett_pn532_wakeup_enable,\r\n&ett_pn532_autopoll_type\r\n};\r\nstatic const enum_val_t sub_enum_vals[] = {\r\n{ "data", "Data", SUB_DATA },\r\n{ "felica", "Sony FeliCa", SUB_FELICA },\r\n{ "mifare", "NXP MiFare", SUB_MIFARE },\r\n{ "iso7816", "ISO 7816", SUB_ISO7816 },\r\n{ NULL, NULL, 0 }\r\n};\r\ncommand_info = wmem_tree_new_autoreset(wmem_epan_scope(), wmem_file_scope());\r\nproto_pn532 = proto_register_protocol("NXP PN532", "PN532", "pn532");\r\nproto_register_field_array(proto_pn532, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_pn532 = expert_register_protocol(proto_pn532);\r\nexpert_register_field_array(expert_pn532, ei, array_length(ei));\r\npref_mod = prefs_register_protocol(proto_pn532, NULL);\r\nprefs_register_static_text_preference(pref_mod, "version",\r\n"PN532 protocol version is based on: \"UM0701-02; PN532 User Manual\"",\r\n"Version of protocol supported by this dissector.");\r\nprefs_register_enum_preference(pref_mod, "prtype532", "Payload Type", "Protocol payload type",\r\n&sub_selected, sub_enum_vals, FALSE);\r\nregister_dissector("pn532", dissect_pn532, proto_pn532);\r\n}\r\nvoid proto_reg_handoff_pn532(void)\r\n{\r\nsub_handles[SUB_DATA] = find_dissector("data");\r\nsub_handles[SUB_FELICA] = find_dissector_add_dependency("felica", proto_pn532);\r\nsub_handles[SUB_MIFARE] = find_dissector_add_dependency("mifare", proto_pn532);\r\nsub_handles[SUB_ISO7816] = find_dissector_add_dependency("iso7816", proto_pn532);\r\n}
