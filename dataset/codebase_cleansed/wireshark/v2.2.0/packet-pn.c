void\r\ninit_pnio_rtc1_station(stationInfo *station_info) {\r\nstation_info->iocs_data_in = wmem_list_new(wmem_file_scope());\r\nstation_info->iocs_data_out = wmem_list_new(wmem_file_scope());\r\nstation_info->ioobject_data_in = wmem_list_new(wmem_file_scope());\r\nstation_info->ioobject_data_out = wmem_list_new(wmem_file_scope());\r\nstation_info->diff_module = wmem_list_new(wmem_file_scope());\r\n}\r\nint\r\ndissect_pn_uint8(tvbuff_t *tvb, gint offset, packet_info *pinfo _U_,\r\nproto_tree *tree, int hfindex, guint8 *pdata)\r\n{\r\nguint8 data;\r\ndata = tvb_get_guint8 (tvb, offset);\r\nif (tree) {\r\nproto_tree_add_uint(tree, hfindex, tvb, offset, 1, data);\r\n}\r\nif (pdata)\r\n*pdata = data;\r\nreturn offset + 1;\r\n}\r\nint\r\ndissect_pn_uint16_ret_item(tvbuff_t *tvb, gint offset, packet_info *pinfo _U_,\r\nproto_tree *tree, int hfindex, guint16 *pdata, proto_item ** new_item)\r\n{\r\nguint16 data;\r\nproto_item *item = NULL;\r\ndata = tvb_get_ntohs (tvb, offset);\r\nif (tree) {\r\nitem = proto_tree_add_uint(tree, hfindex, tvb, offset, 2, data);\r\n}\r\nif (pdata)\r\n*pdata = data;\r\nif (new_item)\r\n*new_item = item;\r\nreturn offset + 2;\r\n}\r\nint\r\ndissect_pn_uint16(tvbuff_t *tvb, gint offset, packet_info *pinfo _U_,\r\nproto_tree *tree, int hfindex, guint16 *pdata)\r\n{\r\nguint16 data;\r\ndata = tvb_get_ntohs (tvb, offset);\r\nif (tree) {\r\nproto_tree_add_uint(tree, hfindex, tvb, offset, 2, data);\r\n}\r\nif (pdata)\r\n*pdata = data;\r\nreturn offset + 2;\r\n}\r\nint\r\ndissect_pn_uint32(tvbuff_t *tvb, gint offset, packet_info *pinfo _U_,\r\nproto_tree *tree, int hfindex, guint32 *pdata)\r\n{\r\nguint32 data;\r\ndata = tvb_get_ntohl (tvb, offset);\r\nif (tree) {\r\nproto_tree_add_uint(tree, hfindex, tvb, offset, 4, data);\r\n}\r\nif (pdata)\r\n*pdata = data;\r\nreturn offset+4;\r\n}\r\nint\r\ndissect_pn_int16(tvbuff_t *tvb, gint offset, packet_info *pinfo _U_,\r\nproto_tree *tree, int hfindex, gint16 *pdata)\r\n{\r\ngint16 data;\r\ndata = tvb_get_ntohs (tvb, offset);\r\nif (tree) {\r\nproto_tree_add_int(tree, hfindex, tvb, offset, 2, data);\r\n}\r\nif (pdata)\r\n*pdata = data;\r\nreturn offset + 2;\r\n}\r\nint\r\ndissect_pn_int32(tvbuff_t *tvb, gint offset, packet_info *pinfo _U_,\r\nproto_tree *tree, int hfindex, gint32 *pdata)\r\n{\r\ngint32 data;\r\ndata = tvb_get_ntohl (tvb, offset);\r\nif (tree) {\r\nproto_tree_add_int(tree, hfindex, tvb, offset, 4, data);\r\n}\r\nif (pdata)\r\n*pdata = data;\r\nreturn offset + 4;\r\n}\r\nint\r\ndissect_pn_oid(tvbuff_t *tvb, int offset, packet_info *pinfo _U_,\r\nproto_tree *tree, int hfindex, guint32 *pdata)\r\n{\r\nguint32 data;\r\ndata = tvb_get_ntoh24(tvb, offset);\r\nif (tree) {\r\nproto_tree_add_uint(tree, hfindex, tvb, offset, 3, data);\r\n}\r\nif (pdata)\r\n*pdata = data;\r\nreturn offset + 3;\r\n}\r\nint\r\ndissect_pn_mac(tvbuff_t *tvb, int offset, packet_info *pinfo _U_,\r\nproto_tree *tree, int hfindex, guint8 *pdata)\r\n{\r\nguint8 data[6];\r\ntvb_memcpy(tvb, data, offset, 6);\r\nif(tree)\r\nproto_tree_add_ether(tree, hfindex, tvb, offset, 6, data);\r\nif (pdata)\r\nmemcpy(pdata, data, 6);\r\nreturn offset + 6;\r\n}\r\nint\r\ndissect_pn_ipv4(tvbuff_t *tvb, int offset, packet_info *pinfo _U_,\r\nproto_tree *tree, int hfindex, guint32 *pdata)\r\n{\r\nguint32 data;\r\ndata = tvb_get_ipv4(tvb, offset);\r\nif(tree)\r\nproto_tree_add_ipv4(tree, hfindex, tvb, offset, 4, data);\r\nif (pdata)\r\n*pdata = data;\r\nreturn offset + 4;\r\n}\r\nint\r\ndissect_pn_uuid(tvbuff_t *tvb, int offset, packet_info *pinfo _U_,\r\nproto_tree *tree, int hfindex, e_guid_t *uuid)\r\n{\r\nguint8 drep[2] = { 0,0 };\r\noffset = dissect_dcerpc_uuid_t(tvb, offset, pinfo, tree, drep,\r\nhfindex, uuid);\r\nreturn offset;\r\n}\r\nint\r\ndissect_pn_undecoded(tvbuff_t *tvb, int offset, packet_info *pinfo _U_,\r\nproto_tree *tree, guint32 length)\r\n{\r\nproto_item *item;\r\nitem = proto_tree_add_string_format(tree, hf_pn_undecoded_data, tvb, offset, length, "data",\r\n"Undecoded Data: %d bytes", length);\r\nexpert_add_info_format(pinfo, item, &ei_pn_undecoded_data,\r\n"Undecoded Data, %u bytes", length);\r\nreturn offset + length;\r\n}\r\nint\r\ndissect_pn_user_data_bytes(tvbuff_t *tvb, int offset, packet_info *pinfo _U_,\r\nproto_tree *tree, guint32 length, int iSelect)\r\n{\r\nif (tree) {\r\nif(iSelect == FRAG_DATA)\r\nproto_tree_add_item(tree, hf_pn_frag_bytes, tvb, offset, length, ENC_NA);\r\nelse\r\nproto_tree_add_item(tree, hf_pn_user_bytes, tvb, offset, length, ENC_NA);\r\n}\r\nreturn offset + length;\r\n}\r\nint\r\ndissect_pn_user_data(tvbuff_t *tvb, int offset, packet_info *pinfo _U_,\r\nproto_tree *tree, guint32 length, const char *text)\r\n{\r\nif (tree && length != 0) {\r\nproto_tree_add_string_format(tree, hf_pn_user_data, tvb, offset, length, "data",\r\n"%s: %d bytes", text, length);\r\n}\r\nreturn offset + length;\r\n}\r\nint\r\ndissect_pn_malformed(tvbuff_t *tvb, int offset, packet_info *pinfo _U_,\r\nproto_tree *tree, guint32 length)\r\n{\r\nproto_tree_add_item(tree, hf_pn_malformed, tvb, 0, 10000, ENC_NA);\r\nreturn offset + length;\r\n}\r\nint\r\ndissect_pn_padding(tvbuff_t *tvb, int offset, packet_info *pinfo _U_,\r\nproto_tree *tree, int length)\r\n{\r\nproto_tree_add_string_format(tree, hf_pn_padding, tvb, offset, length, "data",\r\n"Padding: %u byte", length);\r\nreturn offset + length;\r\n}\r\nint\r\ndissect_pn_align4(tvbuff_t *tvb, int offset, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nguint padding = 0;\r\nif (offset % 4) {\r\npadding = 4 - (offset % 4);\r\nproto_tree_add_string_format(tree, hf_pn_padding, tvb, offset, padding, "data",\r\n"Padding: %u byte", padding);\r\n}\r\nreturn offset + padding;\r\n}\r\nvoid\r\npn_append_info(packet_info *pinfo, proto_item *dcp_item, const char *text)\r\n{\r\ncol_append_str(pinfo->cinfo, COL_INFO, text);\r\nproto_item_append_text(dcp_item, "%s", text);\r\n}\r\nvoid\r\ninit_pn (int proto)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_pn_padding,\r\n{ "Padding", "pn.padding",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_pn_undecoded_data,\r\n{ "Undecoded Data", "pn.undecoded",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_pn_user_data,\r\n{ "User Data", "pn.user_data",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_pn_user_bytes,\r\n{ "Substitute Data", "pn.user_bytes",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_pn_frag_bytes,\r\n{ "Fragment Data", "pn.frag_bytes",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_pn_malformed,\r\n{ "Malformed", "pn_rt.malformed",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }}\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_pn_undecoded_data, { "pn.undecoded_data", PI_UNDECODED, PI_WARN, "Undecoded Data", EXPFILL }},\r\n};\r\nexpert_module_t* expert_pn;\r\nproto_register_field_array (proto, hf, array_length (hf));\r\nexpert_pn = expert_register_protocol(proto);\r\nexpert_register_field_array(expert_pn, ei, array_length(ei));\r\n}
