static int\r\ngluster_cli_2_common_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nreturn gluster_rpc_dissect_dict(tree, tvb, hf_gluster_dict, 0);\r\n}\r\nstatic int\r\ngluster_cli_2_common_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = dissect_rpc_string(tvb, tree, hf_gluster_op_errstr, offset,\r\nNULL);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_gluster_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ngluster_cli_2_probe_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_gluster_port, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_gluster_hostname, offset,\r\nNULL);\r\noffset = dissect_rpc_string(tvb, tree, hf_gluster_op_errstr, offset,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ngluster_cli_2_probe_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_string(tvb, tree, hf_gluster_hostname, offset,\r\nNULL);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_gluster_port, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ngluster_cli_2_deprobe_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = dissect_rpc_string(tvb, tree, hf_gluster_hostname, offset,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ngluster_cli_2_deprobe_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_string(tvb, tree, hf_gluster_hostname, offset,\r\nNULL);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_gluster_port, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_gluster_flags, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ngluster_cli_2_fsm_log_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nreturn dissect_rpc_string(tvb, tree, hf_gluster_wd, 0, NULL);\r\n}\r\nstatic int\r\ngluster_cli_2_getwd_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = dissect_rpc_string(tvb, tree, hf_gluster_wd, offset, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ngluster_cli_2_getwd_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nreturn dissect_rpc_uint32(tvb, tree, hf_gluster_unused, 0);\r\n}\r\nstatic int\r\ngluster_cli_2_mount_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_string(tvb, tree, hf_gluster_label, offset,\r\nNULL);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_gluster_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ngluster_cli_2_mount_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = dissect_rpc_string(tvb, tree, hf_gluster_path, offset, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ngluster_cli_2_umount_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_uint32(tvb, tree, hf_gluster_lazy, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_gluster_path, offset, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ngluster_cli_dissect_common_reply(tvbuff_t *tvb,\r\npacket_info *pinfo, proto_tree *tree, void* data)\r\n{\r\nreturn gluster_dissect_common_reply(tvb, 0, pinfo, tree, data);\r\n}\r\nvoid\r\nproto_register_gluster_cli(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_gluster_cli_proc,\r\n{ "Gluster CLI", "gluster.cli.proc", FT_UINT32,\r\nBASE_DEC | BASE_EXT_STRING, &gluster_cli_proc_vals_ext, 0, NULL,\r\nHFILL }\r\n},\r\n{ &hf_gluster_cli_2_proc,\r\n{ "Gluster CLI", "gluster.cli.proc", FT_UINT32,\r\nBASE_DEC | BASE_EXT_STRING, &gluster_cli_2_proc_vals_ext, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gluster_dict,\r\n{ "Dict", "gluster.dict", FT_STRING, BASE_NONE, NULL,\r\n0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_path,\r\n{ "Path", "gluster.path", FT_STRING, BASE_NONE, NULL,\r\n0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_lazy,\r\n{ "Lazy", "gluster.lazy", FT_UINT32, BASE_HEX, NULL,\r\n0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_label,\r\n{ "Label", "gluster.label", FT_STRING, BASE_NONE, NULL,\r\n0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_unused,\r\n{ "Unused", "gluster.unused", FT_UINT32, BASE_HEX,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_wd,\r\n{ "Path", "gluster.wd", FT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gluster_op_errstr,\r\n{ "Error", "gluster.op_errstr", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_hostname,\r\n{ "Hostname", "gluster.hostname", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_port,\r\n{ "Port", "gluster.port", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gluster_flags,\r\n{ "Flags", "gluster.flag", FT_UINT32, BASE_HEX, NULL,\r\n0, NULL, HFILL }\r\n}\r\n};\r\nstatic gint *ett[] = {\r\n&ett_gluster_cli\r\n};\r\nproto_gluster_cli = proto_register_protocol("Gluster CLI",\r\n"Gluster CLI", "gluster.cli");\r\nproto_register_subtree_array(ett, array_length(ett));\r\nproto_register_field_array(proto_gluster_cli, hf, array_length(hf));\r\n}\r\nvoid\r\nproto_reg_handoff_gluster_cli(void)\r\n{\r\nrpc_init_prog(proto_gluster_cli, GLUSTER_CLI_PROGRAM, ett_gluster_cli,\r\nG_N_ELEMENTS(gluster_cli_vers_info), gluster_cli_vers_info);\r\n}
