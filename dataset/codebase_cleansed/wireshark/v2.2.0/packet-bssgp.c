static guint16\r\nde_bssgp_aligment_octets(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_spare, tvb, curr_offset, len, ENC_NA);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nde_bssgp_bmax_default_ms(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_bmax, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\ncurr_offset+=2;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_bss_area_ind(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_bss_area_ind, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_bucket_leak_rate(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_r, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\ncurr_offset+=2;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_bvc_bucket_size(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_bucket_size, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\ncurr_offset+=2;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_bvci(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string, int string_len)\r\n{\r\nguint32 curr_offset;\r\nguint16 bvci;\r\ncurr_offset = offset;\r\nbvci = tvb_get_ntohs(tvb,curr_offset);\r\nproto_tree_add_item(tree, hf_bssgp_bvci, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\ncurr_offset+=2;\r\nif (add_string)\r\ng_snprintf(add_string, string_len, " - 0x%x", bvci);\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_bvc_meas(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_delay_val, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\ncurr_offset+=2;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_cause(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_cause, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset+=1;\r\nreturn(curr_offset-offset);\r\n}\r\nguint16\r\nde_bssgp_cell_id(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len _U_, gchar *add_string, int string_len)\r\n{\r\nguint32 curr_offset;\r\nguint16 ci;\r\ncurr_offset = offset;\r\ncurr_offset = curr_offset + de_gmm_rai(tvb, tree, pinfo, curr_offset, 6, add_string, string_len);\r\nci = tvb_get_ntohs(tvb, curr_offset);\r\nproto_tree_add_item(tree, hf_bssgp_ci, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\ncurr_offset+=2;\r\nif (add_string)\r\ng_snprintf(add_string, string_len, "%s, CI %u", add_string, ci);\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_chnl_needed(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\ncurr_offset = de_rr_chnl_needed(tvb, tree, pinfo, curr_offset, len , NULL, 0);\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_flush_action(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string, int string_len)\r\n{\r\nguint32 curr_offset;\r\nguint8 oct;\r\ncurr_offset = offset;\r\noct = tvb_get_guint8(tvb,curr_offset);\r\nproto_tree_add_item(tree, hf_bssgp_flush_action, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset+=1;\r\nif (add_string)\r\ng_snprintf(add_string, string_len, " - %s", val_to_str_const(oct, bssgp_flush_action_vals, "Reserved"));\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_llc_pdu(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\ntvbuff_t *next_tvb=NULL;\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nif(len > 0){\r\nnext_tvb = tvb_new_subset_length(tvb, curr_offset, len);\r\nproto_tree_add_bytes_format(tree, hf_bssgp_llc_data, tvb, curr_offset, len, NULL, "LLC Data");\r\n}\r\nif(next_tvb){\r\nif (llc_handle) {\r\ncall_dissector(llc_handle, next_tvb, pinfo, gparent_tree);\r\n} else {\r\ncall_data_dissector(next_tvb, pinfo, gparent_tree);\r\n}\r\n}\r\nreturn(len);\r\n}\r\nstatic guint16\r\nde_bssgp_llc_frames_disc(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string, int string_len)\r\n{\r\nguint32 curr_offset;\r\nguint8 oct;\r\ncurr_offset = offset;\r\noct = tvb_get_guint8(tvb,curr_offset);\r\nproto_tree_add_item(tree, hf_bssgp_llc_frames_disc, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset+=1;\r\nif (add_string)\r\ng_snprintf(add_string, string_len, " - %u Frames", oct);\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_ms_bucket_size(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_bucket_size, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\ncurr_offset+=2;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_omc_id(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_omc_id, tvb, curr_offset, len, ENC_NA);\r\nreturn len;\r\n}\r\nstatic guint16\r\nde_bssgp_pdu_in_error(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_msg_type, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nproto_tree_add_item(tree, hf_bssgp_pdu_data, tvb, curr_offset, len-1, ENC_NA);\r\nreturn len;\r\n}\r\nstatic guint16\r\nde_bssgp_pdu_lifetime(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_delay_val, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\ncurr_offset+=2;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_qos_profile(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nproto_item *pre_item;\r\nguint32 curr_offset;\r\nguint16 peak_bit_rate;\r\nguint8 rate_gran, precedence;\r\nint link_dir;\r\ncurr_offset = offset;\r\nlink_dir = pinfo->link_dir;\r\npeak_bit_rate = tvb_get_ntohs(tvb, curr_offset);\r\nif (peak_bit_rate == 0) {\r\nproto_tree_add_uint_format_value(tree, hf_bssgp_peak_bit_rate, tvb, curr_offset, 2, peak_bit_rate, "Best effort");\r\n}else{\r\nrate_gran = tvb_get_guint8(tvb, curr_offset+2)&0xc0;\r\nswitch(rate_gran){\r\ncase 0:\r\nproto_tree_add_uint_format_value(tree, hf_bssgp_peak_bit_rate, tvb, curr_offset, 2, peak_bit_rate,\r\n"%u bits/s", peak_bit_rate * 100);\r\nbreak;\r\ncase 1:\r\nproto_tree_add_uint_format_value(tree, hf_bssgp_peak_bit_rate, tvb, curr_offset, 2, peak_bit_rate,\r\n"%u kbits/s", peak_bit_rate);\r\nbreak;\r\ncase 2:\r\nproto_tree_add_uint_format_value(tree, hf_bssgp_peak_bit_rate, tvb, curr_offset, 2, peak_bit_rate,\r\n"%u kbits/s", peak_bit_rate * 10);\r\nbreak;\r\ncase 3:\r\nproto_tree_add_uint_format_value(tree, hf_bssgp_peak_bit_rate, tvb, curr_offset, 2, peak_bit_rate,\r\n"%u kbits/s", peak_bit_rate * 100);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\ncurr_offset+=2;\r\nproto_tree_add_item(tree, hf_bssgp_peak_rate_gran, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_bssgp_cr_bit, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_bssgp_t_bit, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_bssgp_a_bit, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nprecedence = tvb_get_guint8(tvb, curr_offset) & 0x7;\r\npre_item = proto_tree_add_item(tree, hf_bssgp_precedence, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nif(link_dir == P2P_DIR_DL){\r\nproto_item_append_text(pre_item, " %s", val_to_str_const((guint32)precedence, bssgp_precedence_dl, "Radio Priority Unknown(Radio priority 3)"));\r\n}else{\r\nproto_item_append_text(pre_item, " %s", val_to_str_const((guint32)precedence, bssgp_precedence_ul, "Priority Unknown(Low priority)"));\r\n}\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_ra_cause(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_ra_cause, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_ra_cap_upd_cause(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_ra_cap_upd_cause, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_r_default_ms(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_r_default_ms, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\ncurr_offset+=2;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_suspend_ref_no(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_suspend_ref_no, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_tag(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_tag, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_trace_ref(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_trace_ref, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\ncurr_offset+=2;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_trace_type(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_trace_type_data, tvb, curr_offset, len, ENC_NA);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nde_bssgp_transaction_id(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_transaction_id, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_trigger_id(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_trigger_id, tvb, curr_offset, len, ENC_NA);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nde_bssgp_no_of_oct_affected(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string, int string_len)\r\n{\r\nguint32 curr_offset;\r\nguint32 no_of_oct;\r\ncurr_offset = offset;\r\nno_of_oct = tvb_get_ntoh24(tvb,curr_offset);\r\nproto_tree_add_item(tree, hf_bssgp_no_of_oct, tvb, curr_offset, 3, ENC_BIG_ENDIAN);\r\ncurr_offset+=3;\r\nif (add_string)\r\ng_snprintf(add_string, string_len, " - %u", no_of_oct);\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_gprs_timer(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_unit_val, tvb, curr_offset, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_bssgp_gprs_timer, tvb, curr_offset, 3, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_feature_bitmap(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_mbms, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_bssgp_EnhancedRadioStatus, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_bssgp_pfcfc, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_bssgp_rim, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_bssgp_lcs, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_bssgp_inr, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_bssgp_cbl, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_bssgp_pfc, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_bucket_full_ratio(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_bucket_full_ratio, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_serv_utran_cco(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_serv_eutran_cco, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_bssgp_serv_utran_cco, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_nsei(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\nguint16 nsei;\r\ncurr_offset = offset;\r\nnsei = tvb_get_ntohs(tvb, curr_offset);\r\nproto_tree_add_item(tree, hf_bssgp_nsei, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\ncurr_offset+=2;\r\ncol_append_sep_fstr(pinfo->cinfo, COL_INFO, BSSGP_SEP, "NSEI %u", nsei);\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_rrlp_apdu(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\ntvbuff_t *next_tvb=NULL;\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nif(len > 0){\r\nnext_tvb = tvb_new_subset_remaining(tvb, curr_offset);\r\nproto_tree_add_bytes_format(tree, hf_bssgp_rrlp_apdu, tvb, curr_offset, len, NULL, "RRLP APDU");\r\n}\r\nif(next_tvb){\r\nif (rrlp_handle) {\r\ncall_dissector(rrlp_handle, next_tvb, pinfo, gparent_tree);\r\n} else {\r\ncall_data_dissector(next_tvb, pinfo, gparent_tree);\r\n}\r\n}\r\nreturn(len);\r\n}\r\nstatic guint16\r\nde_bssgp_rrlp_flags(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_rrlp_flag1, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_rim_app_id(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\ng_rim_application_identity = tvb_get_guint8(tvb, curr_offset);\r\nproto_tree_add_item(tree, hf_bssgp_rim_app_id, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_rim_seq_no(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_rim_seq_no, tvb, curr_offset, 4, ENC_BIG_ENDIAN);\r\ncurr_offset+=4;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_ran_information_request_app_cont(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string, int string_len)\r\n{\r\ntvbuff_t *new_tvb = NULL;\r\nint curr_offset, bit_offset;\r\ncurr_offset = offset;\r\nswitch(g_rim_application_identity){\r\ncase 1:\r\ncurr_offset = curr_offset + de_bssgp_cell_id(tvb, tree, pinfo,curr_offset, len, add_string, string_len);\r\nbreak;\r\ncase 2:\r\ncurr_offset = curr_offset + de_bssgp_cell_id(tvb, tree, pinfo, curr_offset, len, add_string, string_len);\r\nbreak;\r\ncase 3:\r\ncurr_offset = curr_offset + de_bssgp_cell_id(tvb, tree, pinfo, curr_offset, len, add_string, string_len);\r\nbreak;\r\ncase 4:\r\n{\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_PER, TRUE, pinfo);\r\nbit_offset = curr_offset<<3;\r\nbit_offset = dissect_s1ap_Global_ENB_ID(tvb, bit_offset, &asn1_ctx, tree, hf_bssgp_Global_ENB_ID_PDU);\r\ndissect_s1ap_SONtransferRequestContainer(tvb, bit_offset, &asn1_ctx, tree, hf_bssgp_SONtransferRequestContainer_PDU);\r\ncurr_offset += 7; curr_offset >>= 3;\r\n}\r\nbreak;\r\ncase 5:\r\nnew_tvb = tvb_new_subset_remaining(tvb, curr_offset);\r\ncurr_offset = curr_offset + dissect_ranap_SourceCellID_PDU(new_tvb, pinfo, tree, NULL);\r\nbreak;\r\ndefault :\r\nproto_tree_add_expert(tree, pinfo, &ei_bssgp_unknown_rim_app_id, tvb, curr_offset, len);\r\ncurr_offset+=len;\r\nbreak;\r\n}\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_ran_information_app_cont_unit(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string, int string_len)\r\n{\r\ntvbuff_t *new_tvb = NULL;\r\nguint32 curr_offset;\r\nguint8 type, num_items, rat_type, oct;\r\nint i;\r\ncurr_offset = offset;\r\nswitch(g_rim_application_identity){\r\ncase 1:\r\ncurr_offset = curr_offset + de_bssgp_cell_id(tvb, tree, pinfo, curr_offset, len, add_string, string_len);\r\nnum_items = tvb_get_guint8(tvb,curr_offset)>>1;\r\nproto_tree_add_item(tree, hf_bssgp_num_si_psi, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ntype = tvb_get_guint8(tvb,curr_offset)&0x01;\r\nproto_tree_add_item(tree, hf_bssgp_si_psi_type, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nif(type==1){\r\nfor (i=0; i < num_items; i++){\r\nproto_tree_add_expert_format(tree, pinfo, &ei_bssgp_not_dissected_yet, tvb, curr_offset, 22, "PSI item %u - not dissected yet",i+1);\r\ncurr_offset+=22;\r\n}\r\n}else{\r\nvoid (*msg_fcn_p)(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len);\r\ngint ett_tree;\r\nint hf_idx;\r\nconst gchar *msg_str;\r\nproto_item *si_item, *si_item2;\r\nproto_tree *si_tree;\r\nfor (i=0; i < num_items; i++){\r\noct = tvb_get_guint8(tvb,curr_offset);\r\nget_rr_msg_params(oct, &msg_str, &ett_tree, &hf_idx, &msg_fcn_p);\r\nsi_item2 = proto_tree_add_bytes_format(tree, hf_bssgp_si_item, tvb, curr_offset, 21, NULL, "SI item %u ",i+1);\r\nsi_item = proto_tree_add_item(tree, hf_idx, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nsi_tree = proto_item_add_subtree(si_item, ett_tree);\r\nif (msg_fcn_p == NULL){\r\nexpert_add_info(pinfo, si_item2, &ei_bssgp_si_item);\r\n}else{\r\n(*msg_fcn_p)(tvb, si_tree, pinfo, curr_offset+1, 20);\r\n}\r\ncurr_offset+=21;\r\n}\r\n}\r\nbreak;\r\ncase 2:\r\ncurr_offset = curr_offset + de_bssgp_cell_id(tvb, tree, pinfo, curr_offset, len, add_string, string_len);\r\nproto_tree_add_item(tree, hf_bssgp_sys_info_type3_msg, tvb, curr_offset, 1, ENC_NA);\r\ncurr_offset++;\r\nbreak;\r\ncase 3:\r\ncurr_offset = curr_offset + de_bssgp_cell_id(tvb, tree, pinfo, curr_offset, len, add_string, string_len);\r\nproto_tree_add_expert_format(tree, pinfo, &ei_bssgp_not_dissected_yet, tvb, curr_offset, len-6, "MBMS data channel report - not dissected yet");\r\nbreak;\r\ncase 4:\r\nrat_type = tvb_get_guint8(tvb,curr_offset) & 0x0f;\r\nproto_tree_add_item(tree, hf_bssgp_rat_discriminator, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nswitch(rat_type){\r\ncase 0:\r\ncurr_offset = curr_offset + de_bssgp_cell_id(tvb, tree, pinfo, curr_offset, len, add_string, string_len);\r\nbreak;\r\ncase 1:\r\nnew_tvb = tvb_new_subset_remaining(tvb, curr_offset);\r\ncurr_offset = curr_offset + dissect_ranap_SourceCellID_PDU(new_tvb, pinfo, tree, NULL);\r\nbreak;\r\ncase 2:\r\nnew_tvb = tvb_new_subset_remaining(tvb, curr_offset);\r\ncurr_offset = curr_offset + dissect_s1ap_Global_ENB_ID_PDU(new_tvb, pinfo, tree, NULL);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nbreak;\r\ncase 5:\r\nnew_tvb = tvb_new_subset_remaining(tvb, curr_offset);\r\ncurr_offset = curr_offset + dissect_ranap_SourceCellID_PDU(new_tvb, pinfo, tree, NULL);\r\nproto_tree_add_expert_format(tree, pinfo, &ei_bssgp_not_dissected_yet, tvb, curr_offset, len-(curr_offset-offset), "UTRA SI Container - not dissected yet");\r\nbreak;\r\ndefault :\r\nproto_tree_add_expert(tree, pinfo, &ei_bssgp_unknown_rim_app_id_data, tvb, curr_offset, len);\r\ncurr_offset+=len;\r\nbreak;\r\n}\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_ran_app_error_cont(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\ntvbuff_t *new_tvb = NULL;\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nswitch(g_rim_application_identity){\r\ncase 1:\r\nproto_tree_add_item(tree, hf_bssgp_nacc_cause, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nproto_tree_add_expert(tree, pinfo, &ei_bssgp_erroneous_app_container, tvb, curr_offset, len-(curr_offset-offset));\r\nbreak;\r\ncase 2:\r\nproto_tree_add_item(tree, hf_bssgp_s13_cause, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nproto_tree_add_expert(tree, pinfo, &ei_bssgp_erroneous_app_container, tvb, curr_offset, len-(curr_offset-offset));\r\nbreak;\r\ncase 3:\r\nproto_tree_add_item(tree, hf_bssgp_mbms_data_ch_cause, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nproto_tree_add_expert(tree, pinfo, &ei_bssgp_erroneous_app_container, tvb, curr_offset, len-(curr_offset-offset));\r\nbreak;\r\ncase 4:\r\nnew_tvb = tvb_new_subset_remaining(tvb, curr_offset);\r\ncurr_offset = curr_offset + dissect_s1ap_SONtransferCause_PDU(new_tvb, pinfo, tree, NULL);\r\nproto_tree_add_expert(tree, pinfo, &ei_bssgp_erroneous_app_container, tvb, curr_offset, len-(curr_offset-offset));\r\nbreak;\r\ncase 5:\r\nproto_tree_add_item(tree, hf_bssgp_utra_si_cause, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault :\r\nproto_tree_add_expert(tree, pinfo, &ei_bssgp_unknown_app_container, tvb, curr_offset, len);\r\nbreak;\r\n}\r\nreturn(len);\r\n}\r\nstatic guint16\r\nde_bssgp_rim_pdu_indications(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nswitch(g_pdu_type){\r\ncase BSSGP_PDU_RAN_INFORMATION_REQUEST:\r\nproto_tree_add_item(tree, hf_bssgp_ran_inf_req_pdu_t_ext_c, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nbreak;\r\ncase BSSGP_PDU_RAN_INFORMATION:\r\nproto_tree_add_item(tree, hf_bssgp_ran_inf_pdu_t_ext_c, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_bssgp_rim_pdu_ind_ack, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nbreak;\r\ncase BSSGP_PDU_RAN_INFORMATION_APP_ERROR:\r\nproto_tree_add_item(tree, hf_bssgp_rim_pdu_ind_ack, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_rim_proto_ver_no(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_rim_proto_ver_no, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_pfc_flow_ctrl(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nproto_tree *pfc_tree;\r\nguint32 curr_offset;\r\nguint8 num_pfc, i, pfc_len;\r\ngboolean b_pfc_included;\r\ncurr_offset = offset;\r\nnum_pfc = tvb_get_guint8(tvb, curr_offset);\r\nif (num_pfc < 12) {\r\nproto_tree_add_uint(tree, hf_bssgp_num_pfc, tvb, curr_offset, 1, num_pfc);\r\n}else {\r\nproto_tree_add_uint_format_value(tree, hf_bssgp_num_pfc, tvb, curr_offset, 1, num_pfc, "Reserved");\r\nreturn (curr_offset-offset);\r\n}\r\ncurr_offset++;\r\nif (num_pfc == 0)\r\nreturn (curr_offset-offset);\r\npfc_len = (len - 1) / num_pfc;\r\nb_pfc_included = (pfc_len == 6);\r\nfor (i = 0; i < num_pfc; i++) {\r\npfc_tree = proto_tree_add_subtree_format(tree, tvb, curr_offset, pfc_len,\r\nett_bssgp_pfc_flow_control_parameters_pfc, NULL, "PFC (%u)", i + 1);\r\nde_sm_pflow_id(tvb, pfc_tree, pinfo, curr_offset, 1, NULL, 0);\r\ncurr_offset++;\r\nproto_tree_add_item(tree, hf_bssgp_bmax_pfc, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\ncurr_offset += 2;\r\nproto_tree_add_item(tree, hf_bssgp_r_pfc, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\ncurr_offset += 2;\r\nif (b_pfc_included) {\r\nproto_tree_add_item(tree, hf_bssgp_b_pfc, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\n}\r\n}\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_rim_routing_inf(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string, int string_len)\r\n{\r\nguint8 oct;\r\nguint16 rnc_id;\r\ntvbuff_t *new_tvb = NULL;\r\nguint32 curr_offset;\r\nproto_item* ti;\r\ncurr_offset = offset;\r\noct = tvb_get_guint8(tvb,curr_offset);\r\nti = proto_tree_add_item(tree, hf_bssgp_ra_discriminator, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nswitch(oct){\r\ncase 0:\r\nde_bssgp_cell_id(tvb, tree, pinfo, curr_offset, len, add_string, string_len);\r\nbreak;\r\ncase 1:\r\ncurr_offset = curr_offset + de_gmm_rai(tvb, tree, pinfo, curr_offset , 6, add_string, string_len);\r\nrnc_id = tvb_get_ntohs(tvb, curr_offset);\r\nproto_tree_add_item(tree, hf_bssgp_rnc_id, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\nif (add_string)\r\ng_snprintf(add_string, string_len, " %s, RNC-ID %u", add_string, rnc_id);\r\nbreak;\r\ncase 2:\r\ncurr_offset = curr_offset+ de_emm_trac_area_id(tvb, tree, pinfo, curr_offset, 5, add_string, string_len);\r\nnew_tvb = tvb_new_subset_remaining(tvb, curr_offset);\r\ndissect_s1ap_Global_ENB_ID_PDU(new_tvb, pinfo, tree, NULL);\r\nbreak;\r\ndefault:\r\nexpert_add_info(pinfo, ti, &ei_bssgp_ra_discriminator);\r\nreturn len;\r\n}\r\nreturn len;\r\n}\r\nstatic guint16\r\nde_bssgp_mbms_session_id(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_mbms_session_id, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_mbms_session_dur(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\ntvbuff_t *new_tvb;\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nnew_tvb =tvb_new_subset_length(tvb, offset, len);\r\ndissector_try_uint(diameter_3gpp_avp_dissector_table, 904, new_tvb, pinfo, tree);\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_mbms_sai_list(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\ntvbuff_t *new_tvb;\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nnew_tvb =tvb_new_subset_length(tvb, offset, len);\r\ndissector_try_uint(diameter_3gpp_avp_dissector_table, 903, new_tvb, pinfo, tree);\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_mbms_response(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_mbms_cause, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_mbms_ra_list(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nproto_tree *rai_tree;\r\nguint32 curr_offset;\r\nguint8 num_ra_ids;\r\nint i;\r\ncurr_offset = offset;\r\nnum_ra_ids = tvb_get_guint8(tvb,curr_offset) >> 4;\r\nproto_tree_add_item(tree, hf_bssgp_mbms_num_ra_ids, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nfor (i = 0; i < num_ra_ids; i++) {\r\nrai_tree = proto_tree_add_subtree_format(tree, tvb, curr_offset, 8,\r\nett_bssgp_ra_id, NULL, "Routing Area Identification (%u)", i + 1);\r\nde_gmm_rai(tvb, rai_tree, pinfo, curr_offset , 6, NULL, 0);\r\ncurr_offset+=8;\r\n}\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_mbms_session_inf(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_session_inf, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_mbms_stop_cause(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_mbms_stop_cause, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_pfcs_to_be_set_up_list(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nproto_tree *pfc_tree, *pft_tree, *abqp_tree, *arp_tree, *t10_tree;\r\nguint32 curr_offset;\r\nguint8 num_pfc, i, pfc_len;\r\ncurr_offset = offset;\r\nnum_pfc = tvb_get_guint8(tvb, curr_offset);\r\nif (num_pfc < 12) {\r\nproto_tree_add_uint(tree, hf_bssgp_num_pfc, tvb, curr_offset, 1, num_pfc);\r\n}else {\r\nproto_tree_add_uint_format_value(tree, hf_bssgp_num_pfc, tvb, curr_offset, 1, num_pfc, "Reserved");\r\nreturn (len);\r\n}\r\ncurr_offset++;\r\nif (num_pfc == 0)\r\nreturn (curr_offset-offset);\r\npfc_len = (len - 1) / num_pfc;\r\nfor (i = 0; i < num_pfc; i++) {\r\npfc_tree = proto_tree_add_subtree_format(tree, tvb, curr_offset, pfc_len,\r\nett_bssgp_pfcs_to_be_set_up_list, NULL, "PFC (%u)", i + 1);\r\nde_sm_pflow_id(tvb, pfc_tree, pinfo, curr_offset, 1, NULL, 0);\r\ncurr_offset++;\r\npft_tree = proto_tree_add_subtree(pfc_tree, tvb, curr_offset, 3,\r\nett_bssgp_pfcs_to_be_set_up_list_pft, NULL, "Packet Flow Timer(PFT)");\r\nproto_tree_add_item(pft_tree, hf_bssgp_unit_val, tvb, curr_offset, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pft_tree, hf_bssgp_gprs_timer, tvb, curr_offset, 3, ENC_BIG_ENDIAN);\r\ncurr_offset += 3;\r\nabqp_tree = proto_tree_add_subtree(pfc_tree, tvb, curr_offset, 3,\r\nett_bssgp_pfcs_to_be_set_up_list_abqp, NULL, "Aggregate BSS QoS Profile(ABQP)");\r\ncurr_offset = curr_offset + de_sm_qos(tvb, abqp_tree, pinfo, curr_offset, 16, NULL, 0);\r\nif(pfc_len>17){\r\narp_tree = proto_tree_add_subtree(pfc_tree, tvb, curr_offset, 3,\r\nett_bssgp_pfcs_to_be_set_up_list_arp, NULL, "Allocation/Retention Priority");\r\ncurr_offset = curr_offset + be_prio(tvb, arp_tree, pinfo, curr_offset, 1, NULL, 0);\r\n}\r\nif(pfc_len>18){\r\nt10_tree = proto_tree_add_subtree(pfc_tree, tvb, curr_offset, 3,\r\nett_bssgp_pfcs_to_be_set_up_list_t10, NULL, "T10");\r\nproto_tree_add_item(t10_tree, hf_bssgp_unit_val, tvb, curr_offset, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(t10_tree, hf_bssgp_gprs_timer, tvb, curr_offset, 3, ENC_BIG_ENDIAN);\r\ncurr_offset += 3;\r\n}\r\n}\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_list_of_setup_pfcs(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nproto_tree *pfc_tree;\r\nguint32 curr_offset;\r\nguint8 num_pfc, i;\r\ncurr_offset = offset;\r\nnum_pfc = tvb_get_guint8(tvb, curr_offset);\r\nif (num_pfc < 12) {\r\nproto_tree_add_uint(tree, hf_bssgp_num_pfc, tvb, curr_offset, 1, num_pfc);\r\n}else {\r\nproto_tree_add_uint_format_value(tree, hf_bssgp_num_pfc, tvb, curr_offset, 1, num_pfc, "Reserved");\r\nreturn (curr_offset-offset);\r\n}\r\ncurr_offset++;\r\nif (num_pfc == 0)\r\nreturn (curr_offset-offset);\r\nfor (i = 0; i < num_pfc; i++) {\r\npfc_tree = proto_tree_add_subtree_format(tree, tvb, curr_offset, 1,\r\nett_bssgp_list_of_setup_pfcs, NULL, "PFC (%u)", i + 1);\r\nde_sm_pflow_id(tvb, pfc_tree, pinfo, curr_offset, 1, NULL, 0);\r\ncurr_offset++;\r\n}\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_ext_feature_bitmap(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_gb_if, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_bssgp_ps_ho, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_src_to_trg_transp_cont(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_src_to_trg_transp_cont, tvb, curr_offset, len, ENC_NA);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nde_bssgp_trg_to_src_transp_cont(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_trg_to_src_transp_cont, tvb, curr_offset, len, ENC_NA);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nde_bssgp_rnc_identifier(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len _U_, gchar *add_string, int string_len)\r\n{\r\nguint32 curr_offset;\r\nguint16 rnc_id;\r\ncurr_offset = offset;\r\ncurr_offset = curr_offset + de_gmm_rai(tvb, tree, pinfo, curr_offset, 6, add_string, string_len);\r\nrnc_id = tvb_get_ntohs(tvb, curr_offset);\r\nproto_tree_add_item(tree, hf_bssgp_rnc_id, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\ncurr_offset+=2;\r\nif (add_string)\r\ng_snprintf(add_string, string_len, " %s, RNC-ID %u", add_string, rnc_id);\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_page_mode(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_page_mode, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_container_id(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_container_id, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_global_tfi(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\nguint32 bit_offset;\r\nguint8 gtfi;\r\ncurr_offset = offset;\r\nbit_offset = (curr_offset << 3) +3;\r\ngtfi = tvb_get_bits8(tvb,bit_offset,1);\r\nproto_tree_add_bits_item(tree, hf_bssgp_global_tfi, tvb, bit_offset, 1, ENC_BIG_ENDIAN);\r\nbit_offset++;\r\nif(gtfi == 0){\r\nproto_tree_add_bits_item(tree, hf_bssgp_ul_tfi, tvb, bit_offset, 1, ENC_BIG_ENDIAN);\r\n}else{\r\nproto_tree_add_bits_item(tree, hf_bssgp_dl_tfi, tvb, bit_offset, 1, ENC_BIG_ENDIAN);\r\n}\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_time_to_MBMS_data_tran(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\nguint8 value;\r\ncurr_offset = offset;\r\nvalue = tvb_get_guint8(tvb,curr_offset) + 1;\r\nproto_tree_add_uint(tree, hf_bssgp_time_to_MBMS_data_tran, tvb, curr_offset, 1, value);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nde_bssgp_mbms_session_rep_no(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_mbms_session_rep_no, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(len);\r\n}\r\nstatic guint16\r\nde_bssgp_inter_rat_ho_info(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\ntvbuff_t *new_tvb;\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nnew_tvb = tvb_new_subset_remaining(tvb, curr_offset);\r\ndissect_rrc_InterRATHandoverInfo_PDU(new_tvb, pinfo, tree, NULL);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nde_bssgp_ps_ho_cmd(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_ps_ho_cmd, tvb, curr_offset, len, ENC_NA);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nde_bssgp_ps_ho_indications(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_sipsi, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_sipsi_container(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\nguint8 oct,num, type, i;\r\ncurr_offset = offset;\r\noct = tvb_get_guint8(tvb, curr_offset);\r\nnum = oct >>1;\r\ntype = oct & 1;\r\nproto_tree_add_item(tree, hf_bssgp_num_si_psi, tvb, curr_offset, 1, ENC_NA);\r\nproto_tree_add_item(tree, hf_bssgp_type, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nif (type==0){\r\nfor (i = 0; i < num; i++) {\r\nproto_tree_add_bytes_format(tree, hf_bssgp_si, tvb, curr_offset, 21, NULL, "SI (%u)", i + 1);\r\ncurr_offset+=21;\r\n}\r\n}else{\r\nfor (i = 0; i < num; i++) {\r\nproto_tree_add_bytes_format(tree, hf_bssgp_psi, tvb, curr_offset, 22, NULL, "PSI (%u)", i + 1);\r\ncurr_offset+=22;\r\n}\r\n}\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_active_pfcs_list(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nproto_tree *pfc_tree;\r\nguint32 curr_offset;\r\nguint8 num_pfc, i;\r\ncurr_offset = offset;\r\nnum_pfc = tvb_get_guint8(tvb, curr_offset);\r\nif (num_pfc < 12) {\r\nproto_tree_add_uint(tree, hf_bssgp_num_pfc, tvb, curr_offset, 1, num_pfc);\r\n}else {\r\nproto_tree_add_uint_format_value(tree, hf_bssgp_num_pfc, tvb, curr_offset, 1, num_pfc, "Reserved");\r\nreturn (curr_offset-offset);\r\n}\r\ncurr_offset++;\r\nif (num_pfc == 0)\r\nreturn (curr_offset-offset);\r\nfor (i = 0; i < num_pfc; i++) {\r\npfc_tree = proto_tree_add_subtree_format(tree, tvb, curr_offset, 1,\r\nett_bssgp_pfc_flow_control_parameters_pfc, NULL, "PFC (%u)", i + 1);\r\nde_sm_pflow_id(tvb, pfc_tree, pinfo, curr_offset, 1, NULL, 0);\r\ncurr_offset++;\r\n}\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_velocity_data(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string, int string_len)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\ncurr_offset = dissect_description_of_velocity(tvb, tree, pinfo, curr_offset, len, add_string, string_len);\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_dtm_ho_cmd(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_dtm_handover_command_data, tvb, curr_offset, len, ENC_NA);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nde_bssgp_cs_indication(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_cs_indication, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_flow_control_gran(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_flow_control_gran, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_enb_id(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string, int string_len)\r\n{\r\ntvbuff_t *new_tvb;\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\ncurr_offset = curr_offset+ de_emm_trac_area_id(tvb, tree, pinfo, curr_offset, 5, add_string, string_len);\r\nnew_tvb = tvb_new_subset_remaining(tvb, curr_offset);\r\ndissect_s1ap_Global_ENB_ID_PDU(new_tvb, pinfo, tree, NULL);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nde_bssgp_e_utran_inter_rat_ho_info(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\ntvbuff_t *new_tvb;\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nnew_tvb = tvb_new_subset_remaining(tvb, curr_offset);\r\ndissect_lte_rrc_UE_EUTRA_Capability_PDU(new_tvb, pinfo, tree, NULL);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nde_bssgp_sub_prof_id_f_rat_freq_prio(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\nguint8 value;\r\ncurr_offset = offset;\r\nvalue = tvb_get_guint8(tvb,curr_offset) + 1;\r\nproto_tree_add_uint(tree, hf_bssgp_sub_prof_id_f_rat_freq_prio, tvb, curr_offset, 1, value);\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_req_for_inter_rat_ho_inf(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_eutran_irat_ho_inf_req, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_bssgp_irat_ho_inf_req, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_reliable_inter_rat_ho_inf(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_rel_int_rat_ho_inf_ind, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_son_transfer_app_id(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\ntvbuff_t *next_tvb;\r\nif(len > 0){\r\nnext_tvb = tvb_new_subset_length(tvb, offset, len);\r\ndissect_s1ap_SONtransferApplicationIdentity_PDU(next_tvb, pinfo, tree, NULL);\r\n}\r\nreturn(len);\r\n}\r\nstatic guint16\r\nde_bssgp_csg_id(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_csg_id, tvb, curr_offset, 4, ENC_BIG_ENDIAN);\r\ncurr_offset+=4;\r\nproto_tree_add_item(tree, hf_bssgp_cell_acc_mode, tvb, curr_offset, 4, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_redir_attempt_flg(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_spare, tvb, curr_offset, 1, ENC_NA);\r\ncurr_offset += 1;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_redir_indication(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_redir_indiction_reroute_reject_cause, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset += 1;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_redir_complete(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_bssgp_redir_complete_outcome, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset += 1;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_unconfim_send_state_var(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nproto_tree_add_item(tree, hf_bssgp_unconfim_send_state_var, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nreturn 2;\r\n}\r\nstatic guint16\r\nde_bssgp_selected_plmn_id(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nproto_tree_add_string(tree, hf_bssgp_selected_plmn_id, tvb, offset, 3, dissect_e212_mcc_mnc_wmem_packet_str(tvb, pinfo, tree, offset, E212_NONE, TRUE));\r\nreturn 3;\r\n}\r\nstatic guint16\r\nde_bssgp_ran_inf_request_rim_cont(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_IN_ELEM_MAND_TELV(BSSGP_IEI_RIM_APP_ID, BSSGP_PDU_TYPE, DE_BSSGP_RIM_APP_ID, NULL);\r\nELEM_IN_ELEM_MAND_TELV(BSSGP_IEI_RIM_SEQUENCE_NUMBER, BSSGP_PDU_TYPE, DE_BSSGP_RIM_SEQ_NO, NULL);\r\nELEM_IN_ELEM_MAND_TELV(BSSGP_IEI_RIM_PDU_INDICATIONS, BSSGP_PDU_TYPE, DE_BSSGP_RIM_PDU_INDICATIONS, NULL);\r\nELEM_IN_ELEM_OPT_TELV(BSSGP_IEI_RIM_PROTOCOL_VERSION, BSSGP_PDU_TYPE, DE_BSSGP_RIM_PROTO_VER_NO, NULL);\r\nELEM_IN_ELEM_OPT_TELV(BSSGP_IEI_RAN_INF_REQUEST_APP_CONTAINER, BSSGP_PDU_TYPE, DE_BSSGP_RAN_INFORMATION_REQUEST_APP_CONT, NULL);\r\nELEM_IN_ELEM_OPT_TELV(0x84, BSSGP_PDU_TYPE, DE_BSSGP_SON_TRANSFER_APP_ID, NULL);\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_ran_inf_rim_cont(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_IN_ELEM_MAND_TELV(BSSGP_IEI_RIM_APP_ID, BSSGP_PDU_TYPE, DE_BSSGP_RIM_APP_ID, NULL);\r\nELEM_IN_ELEM_MAND_TELV(BSSGP_IEI_RIM_SEQUENCE_NUMBER, BSSGP_PDU_TYPE, DE_BSSGP_RIM_SEQ_NO, NULL);\r\nELEM_IN_ELEM_MAND_TELV(BSSGP_IEI_RIM_PDU_INDICATIONS, BSSGP_PDU_TYPE, DE_BSSGP_RIM_PDU_INDICATIONS, NULL);\r\nELEM_IN_ELEM_OPT_TELV(BSSGP_IEI_RIM_PROTOCOL_VERSION, BSSGP_PDU_TYPE, DE_BSSGP_RIM_PROTO_VER_NO, NULL);\r\nELEM_IN_ELEM_OPT_TELV(BSSGP_IEI_RAN_INF_APP_CONTAINER, BSSGP_PDU_TYPE, DE_BSSGP_RAN_INFORMATION_APP_CONT_UNIT, NULL);\r\nELEM_IN_ELEM_OPT_TELV(BSSGP_IEI_APPLICATION_ERROR_CONTAINER, BSSGP_PDU_TYPE, DE_BSSGP_RAN_APP_ERROR_CONT, NULL);\r\nELEM_IN_ELEM_OPT_TELV(0x84, BSSGP_PDU_TYPE, DE_BSSGP_SON_TRANSFER_APP_ID, NULL);\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_ran_inf_ack_rim_cont(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_IN_ELEM_MAND_TELV(BSSGP_IEI_RIM_APP_ID, BSSGP_PDU_TYPE, DE_BSSGP_RIM_APP_ID, NULL);\r\nELEM_IN_ELEM_MAND_TELV(BSSGP_IEI_RIM_SEQUENCE_NUMBER, BSSGP_PDU_TYPE, DE_BSSGP_RIM_SEQ_NO, NULL);\r\nELEM_IN_ELEM_OPT_TELV(BSSGP_IEI_RIM_PROTOCOL_VERSION, BSSGP_PDU_TYPE, DE_BSSGP_RIM_PROTO_VER_NO, NULL);\r\nELEM_IN_ELEM_OPT_TELV(0x84, BSSGP_PDU_TYPE, DE_BSSGP_SON_TRANSFER_APP_ID, NULL);\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_ran_inf_error_rim_cont(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_IN_ELEM_MAND_TELV(BSSGP_IEI_RIM_APP_ID, BSSGP_PDU_TYPE, DE_BSSGP_RIM_APP_ID, NULL);\r\nELEM_IN_ELEM_MAND_TELV(BSSGP_IEI_CAUSE,BSSGP_PDU_TYPE, DE_BSSGP_CAUSE, " - RIM");\r\nELEM_IN_ELEM_OPT_TELV(BSSGP_IEI_RIM_PROTOCOL_VERSION, BSSGP_PDU_TYPE, DE_BSSGP_RIM_PROTO_VER_NO, NULL);\r\nELEM_IN_ELEM_MAND_TELV(0x15, BSSGP_PDU_TYPE, DE_BSSGP_PDU_IN_ERROR , NULL);\r\nELEM_IN_ELEM_OPT_TELV(0x84, BSSGP_PDU_TYPE, DE_BSSGP_SON_TRANSFER_APP_ID, NULL);\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nde_bssgp_ran_inf_app_error_rim_cont(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_IN_ELEM_MAND_TELV(BSSGP_IEI_RIM_APP_ID, BSSGP_PDU_TYPE, DE_BSSGP_RIM_APP_ID, NULL);\r\nELEM_IN_ELEM_MAND_TELV(BSSGP_IEI_RIM_SEQUENCE_NUMBER, BSSGP_PDU_TYPE, DE_BSSGP_RIM_SEQ_NO, NULL);\r\nELEM_IN_ELEM_MAND_TELV(BSSGP_IEI_RIM_PDU_INDICATIONS, BSSGP_PDU_TYPE, DE_BSSGP_RIM_PDU_INDICATIONS, NULL);\r\nELEM_IN_ELEM_OPT_TELV(BSSGP_IEI_RIM_PROTOCOL_VERSION, BSSGP_PDU_TYPE, DE_BSSGP_RIM_PROTO_VER_NO, NULL);\r\nELEM_IN_ELEM_MAND_TELV(BSSGP_IEI_APPLICATION_ERROR_CONTAINER, BSSGP_PDU_TYPE, DE_BSSGP_RAN_APP_ERROR_CONT, NULL);\r\nELEM_IN_ELEM_OPT_TELV(0x84, BSSGP_PDU_TYPE, DE_BSSGP_SON_TRANSFER_APP_ID, NULL);\r\nreturn(curr_offset-offset);\r\n}\r\nguint16\r\nde_bssgp_source_BSS_to_target_BSS_transp_cont(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_IN_ELEM_MAND_TELV(BSSGP_IEI_MS_RADIO_ACCESS_CAPABILITY, GSM_A_PDU_TYPE_GM, DE_MS_RAD_ACC_CAP , NULL);\r\nELEM_IN_ELEM_OPT_TELV(0x73, BSSGP_PDU_TYPE, DE_BSSGP_INTER_RAT_HO_INFO, NULL);\r\nELEM_IN_ELEM_OPT_TELV(0x6d, BSSGP_PDU_TYPE, DE_BSSGP_PAGE_MODE, NULL);\r\nELEM_IN_ELEM_OPT_TELV(0x6e, BSSGP_PDU_TYPE, DE_BSSGP_CONTAINER_ID, NULL);\r\nELEM_IN_ELEM_OPT_TELV(0x6f, BSSGP_PDU_TYPE, DE_BSSGP_GLOBAL_TFI, NULL);\r\nELEM_IN_ELEM_OPT_TELV(0x75, BSSGP_PDU_TYPE, DE_BSSGP_PS_HO_INDICATIONS, NULL);\r\nELEM_IN_ELEM_OPT_TELV(0x7a, BSSGP_PDU_TYPE, DE_BSSGP_CS_INDICATION, NULL);\r\nELEM_IN_ELEM_OPT_TELV(0x80, BSSGP_PDU_TYPE, DE_BSSGP_E_UTRAN_INTER_RAT_HO_INFO, NULL);\r\nreturn(curr_offset-offset);\r\n}\r\nguint16\r\nde_bssgp_target_BSS_to_source_BSS_transp_cont(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_IN_ELEM_OPT_TELV(0x74, BSSGP_PDU_TYPE, DE_BSSGP_PS_HO_CMD, NULL);\r\nELEM_IN_ELEM_OPT_TELV(0x76, BSSGP_PDU_TYPE, DE_BSSGP_SIPSI_CONTAINER, NULL);\r\nELEM_IN_ELEM_OPT_TELV(0x79, BSSGP_PDU_TYPE, DE_BBSGP_DTM_HO_CMD, NULL);\r\nreturn(curr_offset-offset);\r\n}\r\nstatic void\r\nbssgp_dl_unitdata(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_DL;\r\nELEM_MAND_V(GSM_A_PDU_TYPE_RR, DE_RR_TLLI, " - current");\r\nELEM_MAND_V(BSSGP_PDU_TYPE, DE_BSSGP_QOS_PROFILE, NULL);\r\nELEM_MAND_TELV(0x16, BSSGP_PDU_TYPE, DE_BSSGP_PDU_LIFETIME, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(BSSGP_IEI_MS_RADIO_ACCESS_CAPABILITY, GSM_A_PDU_TYPE_GM, DE_MS_RAD_ACC_CAP , NULL);\r\nELEM_OPT_TELV(0x17, GSM_A_PDU_TYPE_BSSMAP, BE_PRIO, NULL);\r\nELEM_OPT_TELV(0x0a , GSM_A_PDU_TYPE_GM, DE_DRX_PARAM , NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_IMSI, BSSGP_PDU_TYPE, DE_BSSGP_IMSI , NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI , " - old");\r\nELEM_OPT_TELV( BSSGP_IEI_PFI , GSM_A_PDU_TYPE_GM, DE_PACKET_FLOW_ID , NULL);\r\nELEM_OPT_TELV(0x27, GSM_A_PDU_TYPE_BSSMAP, BE_LSA_INFO, NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_SERVICE_UTRAN_CCO, BSSGP_PDU_TYPE, DE_BSSGP_SERV_UTRAN_CCO, NULL);\r\nELEM_OPT_TELV(0x81, BSSGP_PDU_TYPE, DE_BSSGP_SUB_PROF_ID_F_RAT_FRQ_PRIO, NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_REDIR_INDICATION, BSSGP_PDU_TYPE, DE_BSSGP_REDIR_INDICATION, NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_REDIR_COMPLETE, BSSGP_PDU_TYPE, DE_BSSGP_REDIR_COMPLETE, NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_UNCONFIRM_SEND_STATE_VAR, BSSGP_PDU_TYPE, DE_BSSGP_UNCONFIRM_SEND_STATE_VAR, NULL);\r\nELEM_OPT_TELV(0x00, BSSGP_PDU_TYPE, DE_BSSGP_ALIGNMENT_OCTETS, NULL);\r\nELEM_MAND_TELV(0x0e, BSSGP_PDU_TYPE, DE_BSSGP_LLC_PDU, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(0x0e, BSSGP_PDU_TYPE, DE_BSSGP_LLC_PDU, " - initial");\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_ul_unitdata(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_V(GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL);\r\nELEM_MAND_V(BSSGP_PDU_TYPE, DE_BSSGP_QOS_PROFILE, NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_CELL_IDENTIFIER, BSSGP_PDU_TYPE, DE_BSSGP_CELL_ID , NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_PFI , GSM_A_PDU_TYPE_GM, DE_PACKET_FLOW_ID , NULL);\r\nELEM_OPT_TELV(0x26, GSM_A_PDU_TYPE_BSSMAP, BE_LSA_ID_LIST, NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_REDIR_ATTEMP_FLG, BSSGP_PDU_TYPE, DE_BSSGP_REDIR_ATTEMPT_FLG, NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_IMSI, BSSGP_PDU_TYPE, DE_BSSGP_IMSI , NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_UNCONFIRM_SEND_STATE_VAR, BSSGP_PDU_TYPE, DE_BSSGP_UNCONFIRM_SEND_STATE_VAR, NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_SELECTED_PLMN_ID, BSSGP_PDU_TYPE, DE_BSSGP_SELECTED_PLMN_ID, NULL);\r\nELEM_OPT_TELV(0x00, BSSGP_PDU_TYPE, DE_BSSGP_ALIGNMENT_OCTETS, NULL);\r\nELEM_MAND_TELV(0x0e, BSSGP_PDU_TYPE, DE_BSSGP_LLC_PDU, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_ra_cap(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_MS_RADIO_ACCESS_CAPABILITY, GSM_A_PDU_TYPE_GM, DE_MS_RAD_ACC_CAP, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_dl_mbms_unitdata(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_DL;\r\nELEM_MAND_TELV(0x16, BSSGP_PDU_TYPE, DE_BSSGP_PDU_LIFETIME, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x5c, GSM_A_PDU_TYPE_GM, DE_TMGI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(0x5d, BSSGP_PDU_TYPE, DE_BSSGP_MBMS_SESSION_ID, NULL);\r\nELEM_OPT_TELV(0x00, BSSGP_PDU_TYPE, DE_BSSGP_ALIGNMENT_OCTETS, NULL);\r\nELEM_MAND_TELV(0x0e, BSSGP_PDU_TYPE, DE_BSSGP_LLC_PDU, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_ul_mbms_unitdata(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(0x5c, GSM_A_PDU_TYPE_GM, DE_TMGI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(0x5d, BSSGP_PDU_TYPE, DE_BSSGP_MBMS_SESSION_ID, NULL);\r\nELEM_OPT_TELV(0x00, BSSGP_PDU_TYPE, DE_BSSGP_ALIGNMENT_OCTETS, NULL);\r\nELEM_MAND_TELV(0x0e, BSSGP_PDU_TYPE, DE_BSSGP_LLC_PDU, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_paging_ps(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_DL;\r\nELEM_MAND_TELV(BSSGP_IEI_IMSI, BSSGP_PDU_TYPE, DE_BSSGP_IMSI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(0x0a , GSM_A_PDU_TYPE_GM, DE_DRX_PARAM , NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_BVCI, BSSGP_PDU_TYPE, DE_BSSGP_BVCI , NULL);\r\nELEM_OPT_TELV(0x10,GSM_A_PDU_TYPE_COMMON, DE_LAI, NULL);\r\nELEM_OPT_TELV(0x1b,GSM_A_PDU_TYPE_GM, DE_RAI, NULL);\r\nELEM_OPT_TELV(0x02,BSSGP_PDU_TYPE, DE_BSSGP_BSS_AREA_IND, NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_PFI , GSM_A_PDU_TYPE_GM, DE_PACKET_FLOW_ID , NULL);\r\nELEM_OPT_TELV(0x3a , GSM_A_PDU_TYPE_GM, DE_QOS , NULL);\r\nELEM_MAND_TELV(0x18,BSSGP_PDU_TYPE, DE_BSSGP_QOS_PROFILE, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(BSSGP_IEI_TMSI,GSM_A_PDU_TYPE_RR, DE_RR_TMSI_PTMSI, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_paging_cs(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_DL;\r\nELEM_MAND_TELV(BSSGP_IEI_IMSI, BSSGP_PDU_TYPE, DE_BSSGP_IMSI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x0a , GSM_A_PDU_TYPE_GM, DE_DRX_PARAM, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(BSSGP_IEI_BVCI, BSSGP_PDU_TYPE, DE_BSSGP_BVCI , NULL);\r\nELEM_OPT_TELV(0x10,GSM_A_PDU_TYPE_COMMON, DE_LAI, NULL);\r\nELEM_OPT_TELV(0x1b,GSM_A_PDU_TYPE_GM, DE_RAI, NULL);\r\nELEM_OPT_TELV(0x02,BSSGP_PDU_TYPE, DE_BSSGP_BSS_AREA_IND, NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI , NULL);\r\nELEM_OPT_TELV(0x09, BSSGP_PDU_TYPE, DE_BSSGP_CHLN_NEEDED , NULL);\r\nELEM_OPT_TELV(0x0b, GSM_A_PDU_TYPE_BSSMAP, BE_EMLPP_PRIO, NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_TMSI,GSM_A_PDU_TYPE_RR, DE_RR_TMSI_PTMSI, NULL);\r\nELEM_OPT_TELV(0x53, SGSAP_PDU_TYPE, DE_SGSAP_GLOBAL_CN_ID, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_ra_cap_upd(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_TAG, BSSGP_PDU_TYPE, DE_BSSGP_TAG, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(BSSGP_IEI_IMSI, BSSGP_PDU_TYPE, DE_BSSGP_IMSI , NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_RA_CAP_UPD_CAUSE, BSSGP_PDU_TYPE, DE_BSSGP_RA_CAP_UPD_CAUSE , NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_MS_RADIO_ACCESS_CAPABILITY, GSM_A_PDU_TYPE_GM, DE_MS_RAD_ACC_CAP , NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_ra_cap_upd_ack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_DL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_TAG, BSSGP_PDU_TYPE, DE_BSSGP_TAG, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(BSSGP_IEI_IMSI, BSSGP_PDU_TYPE, DE_BSSGP_IMSI , NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_RA_CAP_UPD_CAUSE, BSSGP_PDU_TYPE, DE_BSSGP_RA_CAP_UPD_CAUSE , NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_MS_RADIO_ACCESS_CAPABILITY, GSM_A_PDU_TYPE_GM, DE_MS_RAD_ACC_CAP , NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_ra_status(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_OPT_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI , NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_TMSI,GSM_A_PDU_TYPE_RR, DE_RR_TMSI_PTMSI, NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_IMSI, BSSGP_PDU_TYPE, DE_BSSGP_IMSI , NULL);\r\nELEM_MAND_TELV(BSSGP_IEI_RADIO_CAUSE, BSSGP_PDU_TYPE, DE_BSSGP_RA_CAUSE, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_suspend(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x1b,GSM_A_PDU_TYPE_GM, DE_RAI, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nvoid\r\nbssgp_suspend_ack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_DL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x1b,GSM_A_PDU_TYPE_GM, DE_RAI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x1d,BSSGP_PDU_TYPE, DE_BBSGP_SUSPEND_REF_NO, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_suspend_nack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_DL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x1b,GSM_A_PDU_TYPE_GM, DE_RAI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(BSSGP_IEI_CAUSE,BSSGP_PDU_TYPE, DE_BSSGP_CAUSE, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_resume(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x1b,GSM_A_PDU_TYPE_GM, DE_RAI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x1d,BSSGP_PDU_TYPE, DE_BBSGP_SUSPEND_REF_NO, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_resume_ack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_DL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x1b,GSM_A_PDU_TYPE_GM, DE_RAI, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_resume_nack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_DL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x1b,GSM_A_PDU_TYPE_GM, DE_RAI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(BSSGP_IEI_CAUSE,BSSGP_PDU_TYPE, DE_BSSGP_CAUSE, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_flush_ll(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_DL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_BVCI, BSSGP_PDU_TYPE, DE_BSSGP_BVCI, " - Old", ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(BSSGP_IEI_BVCI, BSSGP_PDU_TYPE, DE_BSSGP_BVCI , " - New");\r\nELEM_OPT_TELV(0x3e, GSM_A_PDU_TYPE_RR, DE_BSSGP_NSEI , " - New");\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_flush_ll_ack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x0c, BSSGP_PDU_TYPE, DE_BSSGP_FLUSH_ACTION, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(BSSGP_IEI_BVCI, BSSGP_PDU_TYPE, DE_BSSGP_BVCI , " - New");\r\nELEM_MAND_TELV(BSSGP_IEI_NUMBER_OF_OCTETS_AFFECTED, BSSGP_PDU_TYPE, DE_BSSGP_NO_OF_OCT_AFFECTED, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(0x3e, GSM_A_PDU_TYPE_RR, DE_BSSGP_NSEI , " - New");\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_llc_discarded(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_LLC_FRAMES_DISCARDED, BSSGP_PDU_TYPE, DE_BSSGP_LLC_FRAMES_DISC, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_BVCI, BSSGP_PDU_TYPE, DE_BSSGP_BVCI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_NUMBER_OF_OCTETS_AFFECTED, BSSGP_PDU_TYPE, DE_BSSGP_NO_OF_OCT_AFFECTED, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(BSSGP_IEI_PFI , GSM_A_PDU_TYPE_GM, DE_PACKET_FLOW_ID , NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_flow_control_bvc(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(BSSGP_IEI_TAG, BSSGP_PDU_TYPE, DE_BSSGP_TAG, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x05, BSSGP_PDU_TYPE, DE_BSSGP_BVC_BUCKET_SIZE, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_BUCKET_LEAK_RATE, BSSGP_PDU_TYPE, DE_BSSGP_BUCKET_LEAK_RATE, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x01, BSSGP_PDU_TYPE, DE_BSSGP_BMAX_DEFAULT_MS, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x1c, BSSGP_PDU_TYPE, DE_BSSGP_R_DEFAULT_MS, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(BSSGP_IEI_BUCKET_FULL_RATIO, BSSGP_PDU_TYPE, DE_BSSGP_BUCKET_FULL_RATIO , NULL);\r\nELEM_OPT_TELV(0x06, BSSGP_PDU_TYPE, DE_BSSGP_BVC_MEAS , NULL);\r\nELEM_OPT_TELV(0x7e, BSSGP_PDU_TYPE, DE_BSSGP_FLOW_CONTROL_GRAN , NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_flow_control_bvc_ack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_DL;\r\nELEM_MAND_TELV(BSSGP_IEI_TAG, BSSGP_PDU_TYPE, DE_BSSGP_TAG, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_flow_control_ms(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_TAG, BSSGP_PDU_TYPE, DE_BSSGP_TAG, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_MS_BUCKET_SIZE, BSSGP_PDU_TYPE, DE_BSSGP_MS_BUCKET_SIZE, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_BUCKET_LEAK_RATE, BSSGP_PDU_TYPE, DE_BSSGP_BUCKET_LEAK_RATE, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(BSSGP_IEI_BUCKET_FULL_RATIO, BSSGP_PDU_TYPE, DE_BSSGP_BUCKET_FULL_RATIO , NULL);\r\nELEM_OPT_TELV(0x7e, BSSGP_PDU_TYPE, DE_BSSGP_FLOW_CONTROL_GRAN , NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_flow_control_ms_ack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_DL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_TAG, BSSGP_PDU_TYPE, DE_BSSGP_TAG, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_bvc_block(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(BSSGP_IEI_BVCI, BSSGP_PDU_TYPE, DE_BSSGP_BVCI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_CAUSE,BSSGP_PDU_TYPE, DE_BSSGP_CAUSE, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_bvc_block_ack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_DL;\r\nELEM_MAND_TELV(BSSGP_IEI_BVCI, BSSGP_PDU_TYPE, DE_BSSGP_BVCI, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_bvc_un_block(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(BSSGP_IEI_BVCI, BSSGP_PDU_TYPE, DE_BSSGP_BVCI, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_bvc_un_block_ack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_DL;\r\nELEM_MAND_TELV(BSSGP_IEI_BVCI, BSSGP_PDU_TYPE, DE_BSSGP_BVCI, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_bvc_reset(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TELV(BSSGP_IEI_BVCI, BSSGP_PDU_TYPE, DE_BSSGP_BVCI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_CAUSE,BSSGP_PDU_TYPE, DE_BSSGP_CAUSE, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(BSSGP_IEI_CELL_IDENTIFIER, BSSGP_PDU_TYPE, DE_BSSGP_CELL_ID , NULL);\r\nELEM_OPT_TELV(0x3b, BSSGP_PDU_TYPE, DE_BSSGP_FEATURE_BITMAP , NULL);\r\nELEM_OPT_TELV(0x69, BSSGP_PDU_TYPE, DE_BSSGP_EXT_FEATURE_BITMAP , NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_bvc_reset_ack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TELV(BSSGP_IEI_BVCI, BSSGP_PDU_TYPE, DE_BSSGP_BVCI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(BSSGP_IEI_CELL_IDENTIFIER, BSSGP_PDU_TYPE, DE_BSSGP_CELL_ID , NULL);\r\nELEM_OPT_TELV(0x3b, BSSGP_PDU_TYPE, DE_BSSGP_FEATURE_BITMAP , NULL);\r\nELEM_OPT_TELV(0x69, BSSGP_PDU_TYPE, DE_BSSGP_EXT_FEATURE_BITMAP , NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_status(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TELV(BSSGP_IEI_CAUSE,BSSGP_PDU_TYPE, DE_BSSGP_CAUSE, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(BSSGP_IEI_BVCI, BSSGP_PDU_TYPE, DE_BSSGP_BVCI, NULL);\r\nELEM_OPT_TELV(0x15, BSSGP_PDU_TYPE, DE_BSSGP_PDU_IN_ERROR, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_sgsn_invoke_trace(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(0x22, BSSGP_PDU_TYPE, DE_BSSGP_TRACE_TYPE, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x21, BSSGP_PDU_TYPE, DE_BSSGP_TRACE_REF, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(0x24, BSSGP_PDU_TYPE, DE_BSSGP_TRIGGER_ID , NULL);\r\nELEM_OPT_TELV(0x11,GSM_A_PDU_TYPE_COMMON, DE_MID, NULL);\r\nELEM_OPT_TELV(0x14,GSM_A_PDU_TYPE_COMMON, DE_BSSGP_OMC_ID, NULL);\r\nELEM_OPT_TELV(0x23, BSSGP_PDU_TYPE, DE_BSSGP_TRANSACTION_ID , NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_download_bss_pfc(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_PFI , GSM_A_PDU_TYPE_GM, DE_PACKET_FLOW_ID, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_create_bss_pfc(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_DL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(BSSGP_IEI_IMSI, BSSGP_PDU_TYPE, DE_BSSGP_IMSI , NULL);\r\nELEM_MAND_TELV(BSSGP_IEI_PFI , GSM_A_PDU_TYPE_GM, DE_PACKET_FLOW_ID, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x29, BSSGP_PDU_TYPE, DE_BSSGP_GPRS_TIMER, " - PFT", ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x3a , GSM_A_PDU_TYPE_GM, DE_QOS, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(BSSGP_IEI_SERVICE_UTRAN_CCO, BSSGP_PDU_TYPE, DE_BSSGP_SERV_UTRAN_CCO, NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_MS_RADIO_ACCESS_CAPABILITY, GSM_A_PDU_TYPE_GM, DE_MS_RAD_ACC_CAP , NULL);\r\nELEM_OPT_TELV(0x17, GSM_A_PDU_TYPE_BSSMAP, BE_PRIO, NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_GPRS_TIMER, BSSGP_PDU_TYPE, DE_BSSGP_GPRS_TIMER, " - T10");\r\nELEM_OPT_TELV(0x73, BSSGP_PDU_TYPE, DE_BSSGP_INTER_RAT_HO_INFO, NULL);\r\nELEM_OPT_TELV(0x80, BSSGP_PDU_TYPE, DE_BSSGP_E_UTRAN_INTER_RAT_HO_INFO, NULL);\r\nELEM_OPT_TELV(0x81, BSSGP_PDU_TYPE, DE_BSSGP_SUB_PROF_ID_F_RAT_FRQ_PRIO, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_create_bss_pfc_ack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_PFI , GSM_A_PDU_TYPE_GM, DE_PACKET_FLOW_ID, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x3a , GSM_A_PDU_TYPE_GM, DE_QOS, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(BSSGP_IEI_CAUSE,BSSGP_PDU_TYPE, DE_BSSGP_CAUSE, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_create_bss_pfc_nack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_PFI , GSM_A_PDU_TYPE_GM, DE_PACKET_FLOW_ID, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_CAUSE,BSSGP_PDU_TYPE, DE_BSSGP_CAUSE, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_modify_bss_pfc(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_PFI , GSM_A_PDU_TYPE_GM, DE_PACKET_FLOW_ID, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x3a , GSM_A_PDU_TYPE_GM, DE_QOS, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_modify_bss_pfc_ack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_DL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_PFI , GSM_A_PDU_TYPE_GM, DE_PACKET_FLOW_ID, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_GPRS_TIMER, BSSGP_PDU_TYPE, DE_BSSGP_GPRS_TIMER, " - PFT", ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x3a , GSM_A_PDU_TYPE_GM, DE_QOS, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_delete_bss_pfc(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_DL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_PFI , GSM_A_PDU_TYPE_GM, DE_PACKET_FLOW_ID, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_delete_bss_pfc_ack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_PFI , GSM_A_PDU_TYPE_GM, DE_PACKET_FLOW_ID, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_flow_cntrl_pfc(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_TAG, BSSGP_PDU_TYPE, DE_BSSGP_TAG, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(BSSGP_IEI_MS_BUCKET_SIZE, BSSGP_PDU_TYPE, DE_BSSGP_MS_BUCKET_SIZE , NULL);\r\nELEM_OPT_TELV(0x3b, BSSGP_PDU_TYPE, DE_BSSGP_FEATURE_BITMAP , NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_BUCKET_FULL_RATIO, BSSGP_PDU_TYPE, DE_BSSGP_BUCKET_FULL_RATIO , NULL);\r\nELEM_MAND_TELV(0x52, BSSGP_PDU_TYPE, DE_BSSGP_PFC_FLOW_CTRL, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(0x7e, BSSGP_PDU_TYPE, DE_BSSGP_FLOW_CONTROL_GRAN , NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_flow_cntrl_pfc_ack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_DL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_TAG, BSSGP_PDU_TYPE, DE_BSSGP_TAG, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_delete_bss_pfc_req(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_PFI , GSM_A_PDU_TYPE_GM, DE_PACKET_FLOW_ID, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_CAUSE,BSSGP_PDU_TYPE, DE_BSSGP_CAUSE, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_ps_ho_required(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_CAUSE,BSSGP_PDU_TYPE, DE_BSSGP_CAUSE, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_CELL_IDENTIFIER, BSSGP_PDU_TYPE, DE_BSSGP_CELL_ID, " - Source", ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(BSSGP_IEI_CELL_IDENTIFIER, BSSGP_PDU_TYPE, DE_BSSGP_CELL_ID , " - Target");\r\nELEM_OPT_TELV(0x64,BSSGP_PDU_TYPE, DE_BSSGP_SOURCE_BSS_TO_TARGET_BSS_TRANSP_CONT, NULL);\r\nELEM_OPT_TELV(0x6c,BSSGP_PDU_TYPE, BE_BSSGP_RNC_ID, " - Target");\r\nELEM_OPT_TELV(0x6a,BSSGP_PDU_TYPE, DE_BSSGP_SRC_TO_TRG_TRANSP_CONT, NULL);\r\nELEM_OPT_TELV(0x77,BSSGP_PDU_TYPE, DE_BSSGP_ACTIVE_PFCS_LIST, NULL);\r\nELEM_OPT_TELV(0x7f,BSSGP_PDU_TYPE, DE_BSSGP_ENB_ID, " - Target");\r\nELEM_OPT_TELV(0x83,BSSGP_PDU_TYPE, DE_BSSGP_RELIABLE_INTER_RAT_HO_INF, NULL);\r\nELEM_OPT_TELV(0x85,BSSGP_PDU_TYPE, DE_BSSGP_CSG_ID, NULL);\r\nELEM_OPT_TELV(0x86, NAS_PDU_TYPE_EMM, DE_EMM_TRAC_AREA_ID, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_ps_ho_required_ack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_DL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x68,BSSGP_PDU_TYPE, DE_BSSGP_LIST_OF_SETUP_PFCS, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(0x65,BSSGP_PDU_TYPE, DE_BSSGP_TARGET_BSS_TO_SOURCE_BSS_TRANSP_CONT, NULL);\r\nELEM_OPT_TELV(0x6b,BSSGP_PDU_TYPE, DE_BSSGP_TRG_TO_SRC_TRANSP_CONT, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_ps_ho_required_nack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_DL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_CAUSE,BSSGP_PDU_TYPE, DE_BSSGP_CAUSE, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_ps_ho_request(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_DL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_IMSI, BSSGP_PDU_TYPE, DE_BSSGP_IMSI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_CAUSE,BSSGP_PDU_TYPE, DE_BSSGP_CAUSE, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(BSSGP_IEI_CELL_IDENTIFIER, BSSGP_PDU_TYPE, DE_BSSGP_CELL_ID , " - Source");\r\nELEM_OPT_TELV(0x6c,BSSGP_PDU_TYPE, BE_BSSGP_RNC_ID, " - Source");\r\nELEM_OPT_TELV(BSSGP_IEI_CELL_IDENTIFIER, BSSGP_PDU_TYPE, DE_BSSGP_CELL_ID , " - Target");\r\nELEM_OPT_TELV(0x64,BSSGP_PDU_TYPE, DE_BSSGP_SOURCE_BSS_TO_TARGET_BSS_TRANSP_CONT, NULL);\r\nELEM_OPT_TELV(0x67,BSSGP_PDU_TYPE, DE_BSSGP_PFCS_TO_BE_SET_UP_LIST, NULL);\r\nELEM_OPT_TELV(0x66,GSM_A_PDU_TYPE_COMMON, DE_NAS_CONT_FOR_PS_HO, NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_SERVICE_UTRAN_CCO, BSSGP_PDU_TYPE, DE_BSSGP_SERV_UTRAN_CCO, NULL);\r\nELEM_OPT_TELV(0x81, BSSGP_PDU_TYPE, DE_BSSGP_SUB_PROF_ID_F_RAT_FRQ_PRIO, NULL);\r\nELEM_OPT_TELV(0x83,BSSGP_PDU_TYPE, DE_BSSGP_RELIABLE_INTER_RAT_HO_INF, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_ps_ho_request_ack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x68,BSSGP_PDU_TYPE, DE_BSSGP_LIST_OF_SETUP_PFCS, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x65,BSSGP_PDU_TYPE, DE_BSSGP_TARGET_BSS_TO_SOURCE_BSS_TRANSP_CONT, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_ps_ho_request_nack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_CAUSE,BSSGP_PDU_TYPE, DE_BSSGP_CAUSE, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_ps_ho_complete(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_IMSI, BSSGP_PDU_TYPE, DE_BSSGP_IMSI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(BSSGP_IEI_CELL_IDENTIFIER, BSSGP_PDU_TYPE, DE_BSSGP_CELL_ID , " - Target");\r\nELEM_OPT_TELV(0x82, BSSGP_PDU_TYPE, DE_BSSGP_REQ_FOR_INTER_RAT_HO_INFO , NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_ps_ho_cancel(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_IN_ELEM_MAND_TELV(BSSGP_IEI_CAUSE,BSSGP_PDU_TYPE, DE_BSSGP_CAUSE, NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_CELL_IDENTIFIER, BSSGP_PDU_TYPE, DE_BSSGP_CELL_ID , " - Source");\r\nELEM_OPT_TELV(BSSGP_IEI_CELL_IDENTIFIER, BSSGP_PDU_TYPE, DE_BSSGP_CELL_ID , " - Target");\r\nELEM_OPT_TELV(0x6c,BSSGP_PDU_TYPE, BE_BSSGP_RNC_ID, " - Target");\r\nELEM_OPT_TELV(0x7f,BSSGP_PDU_TYPE, DE_BSSGP_ENB_ID, " - Target");\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_ps_ho_complete_ack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_DL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(0x73, BSSGP_PDU_TYPE, DE_BSSGP_INTER_RAT_HO_INFO, NULL);\r\nELEM_OPT_TELV(0x80, BSSGP_PDU_TYPE, DE_BSSGP_E_UTRAN_INTER_RAT_HO_INFO, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_perform_loc_request(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_IMSI, BSSGP_PDU_TYPE, DE_BSSGP_IMSI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(0x86, NAS_PDU_TYPE_EMM, DE_EMM_TRAC_AREA_ID, NULL);\r\nELEM_MAND_TELV(BSSGP_IEI_BVCI, BSSGP_PDU_TYPE, DE_BSSGP_BVCI, " - (PCU-PTP)", ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(0x3e, GSM_A_PDU_TYPE_RR, DE_BSSGP_NSEI , " - (PCU-PTP)");\r\nELEM_OPT_TELV(0x7c, GSM_PDU_TYPE_BSSMAP_LE, DE_BMAPLE_GANSS_LOC_TYPE, NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_CELL_IDENTIFIER, BSSGP_PDU_TYPE, DE_BSSGP_CELL_ID , NULL);\r\nELEM_OPT_TELV( BSSGP_IEI_LCS_CAPABILITY , GSM_A_PDU_TYPE_GM, DE_PS_LCS_CAP , NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_LCS_PRIORITY, GSM_A_PDU_TYPE_BSSMAP, BE_LCS_PRIO, NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_LCS_QOS, GSM_PDU_TYPE_BSSMAP_LE, DE_BMAPLE_LCSQOS, NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_LCS_CLIENT_TYPE, GSM_PDU_TYPE_BSSMAP_LE, DE_BMAPLE_LCS_CLIENT_TYPE, NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_REQUESTED_GPS_ASSISTANCE_DATA, GSM_PDU_TYPE_BSSMAP_LE, DE_BMAPLE_REQ_GPS_ASSIST_D, NULL);\r\nELEM_OPT_TELV(0x70,GSM_A_PDU_TYPE_COMMON, DE_MID, NULL);\r\nELEM_OPT_TELV(0x7c, GSM_A_PDU_TYPE_BSSMAP, BE_GANSS_LOC_TYP, NULL);\r\nELEM_OPT_TLV(0x7b, GSM_A_PDU_TYPE_BSSMAP, BE_GANSS_ASS_DTA, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_perform_loc_response(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_BVCI, BSSGP_PDU_TYPE, DE_BSSGP_BVCI, " - (PCU-PTP)", ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(BSSGP_IEI_LOCATION_ESTIMATE, GSM_A_PDU_TYPE_BSSMAP, BE_LOC_EST, NULL);\r\nELEM_OPT_TELV(0x7d, GSM_PDU_TYPE_BSSMAP_LE, DE_BMAPLE_POS_DATA, NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_DECIPHERING_KEYS, GSM_PDU_TYPE_BSSMAP_LE, DE_BMAPLE_DECIPH_KEYS, NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_LCS_CAUSE, GSM_PDU_TYPE_BSSMAP_LE, DE_BMAPLE_LCS_CAUSE, NULL);\r\nELEM_OPT_TELV(0x78, BSSGP_PDU_TYPE, DE_BSSGP_VELOCITY_DATA, NULL);\r\nELEM_OPT_TELV(0x7d, GSM_A_PDU_TYPE_BSSMAP, BE_GANSS_POS_DTA, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_perform_loc_response_abort(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_DL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_BVCI, BSSGP_PDU_TYPE, DE_BSSGP_BVCI, " - (PCU-PTP)", ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_LCS_CAUSE, GSM_PDU_TYPE_BSSMAP_LE, DE_BMAPLE_LCS_CAUSE, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_pos_cmd(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_BVCI, BSSGP_PDU_TYPE, DE_BSSGP_BVCI, " - (PCU-PTP)", ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_RRLP_FLAGS, BSSGP_PDU_TYPE, DE_BSSGP_RRLP_FLAGS, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_RRLP_APDU, BSSGP_PDU_TYPE, DE_BSSGP_RRLP_APDU, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_pos_resp(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_DL;\r\nELEM_MAND_TELV(BSSGP_IEI_TLLI, GSM_A_PDU_TYPE_RR, DE_RR_TLLI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_BVCI, BSSGP_PDU_TYPE, DE_BSSGP_BVCI, " - (PCU-PTP)", ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(BSSGP_IEI_RRLP_FLAGS, BSSGP_PDU_TYPE, DE_BSSGP_RRLP_FLAGS , NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_RRLP_APDU, BSSGP_PDU_TYPE, DE_BSSGP_RRLP_APDU , NULL);\r\nELEM_OPT_TELV(BSSGP_IEI_LCS_CAUSE, GSM_PDU_TYPE_BSSMAP_LE, DE_BMAPLE_LCS_CAUSE, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_ran_inf_request(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TELV(BSSGP_IEI_RIM_ROUTING_INFORMATION, BSSGP_PDU_TYPE, DE_BSSGP_RIM_ROUTING_INF, " - Destination Cell Identifier", ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_RIM_ROUTING_INFORMATION, BSSGP_PDU_TYPE, DE_BSSGP_RIM_ROUTING_INF, " - Source Cell Identifier", ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(BSSGP_IEI_RAN_INF_REQUEST_RIM_CONTAINER, BSSGP_PDU_TYPE, DE_BSSGP_RAN_INF_REQUEST_RIM_CONT, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_ran_inf(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TELV(BSSGP_IEI_RIM_ROUTING_INFORMATION, BSSGP_PDU_TYPE, DE_BSSGP_RIM_ROUTING_INF, " - Destination Cell Identifier", ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_RIM_ROUTING_INFORMATION, BSSGP_PDU_TYPE, DE_BSSGP_RIM_ROUTING_INF, " - Source Cell Identifier", ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_RAN_INF_RIM_CONTAINER, BSSGP_PDU_TYPE, DE_BSSGP_RAN_INF_RIM_CONT, " - Source Cell Identifier", ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_ran_inf_request_ack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TELV(BSSGP_IEI_RIM_ROUTING_INFORMATION, BSSGP_PDU_TYPE, DE_BSSGP_RIM_ROUTING_INF, " - Destination Cell Identifier", ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_RIM_ROUTING_INFORMATION, BSSGP_PDU_TYPE, DE_BSSGP_RIM_ROUTING_INF, " - Source Cell Identifier", ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_RAN_INF_ACK_RIM_CONTAINER, BSSGP_PDU_TYPE, DE_BSSGP_RAN_INFORMATION_ACK_RIM_CONT, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_ran_inf_err(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TELV(BSSGP_IEI_RIM_ROUTING_INFORMATION, BSSGP_PDU_TYPE, DE_BSSGP_RIM_ROUTING_INF, " - Destination Cell Identifier", ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_RIM_ROUTING_INFORMATION, BSSGP_PDU_TYPE, DE_BSSGP_RIM_ROUTING_INF, " - Source Cell Identifier", ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_RAN_INF_ERROR_RIM_CONTAINER, BSSGP_PDU_TYPE, DE_BSSGP_RAN_INFORMATION_ERROR_RIM_CONT, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_ran_inf_app_err(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TELV(BSSGP_IEI_RIM_ROUTING_INFORMATION, BSSGP_PDU_TYPE, DE_BSSGP_RIM_ROUTING_INF, " - Destination Cell Identifier", ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_RIM_ROUTING_INFORMATION, BSSGP_PDU_TYPE, DE_BSSGP_RIM_ROUTING_INF, " - Source Cell Identifier", ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(BSSGP_IEI_RAN_INF_APP_ERROR_RIM_CONTAINER, BSSGP_PDU_TYPE, DE_BSSGP_RAN_INF_APP_ERROR_RIM_CONT, NULL, ei_bssgp_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_mbms_session_start_req(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_DL;\r\nELEM_MAND_TELV(0x5c, GSM_A_PDU_TYPE_GM, DE_TMGI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(0x5d, BSSGP_PDU_TYPE, DE_BSSGP_MBMS_SESSION_ID, NULL);\r\nELEM_MAND_TELV(0x3a , GSM_A_PDU_TYPE_GM, DE_QOS, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x5f, BSSGP_PDU_TYPE, DE_BSSGP_MBMS_SAI_LIST, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x61, BSSGP_PDU_TYPE, DE_BSSGP_MBMS_RA_LIST, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x5e, BSSGP_PDU_TYPE, DE_BSSGP_MBMS_SESSION_DUR, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x62, BSSGP_PDU_TYPE, DE_BSSGP_MBMS_SESSION_INF, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x71, BSSGP_PDU_TYPE, DE_BSSGP_TIME_TO_MBMS_DATA_TRAN, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(0x17, GSM_A_PDU_TYPE_BSSMAP, BE_PRIO, NULL);\r\nELEM_OPT_TELV(0x72, BSSGP_PDU_TYPE, DE_BSSGP_MBMS_SESSION_REP_NO, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_mbms_session_start_resp(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(0x5c, GSM_A_PDU_TYPE_GM, DE_TMGI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(0x5d, BSSGP_PDU_TYPE, DE_BSSGP_MBMS_SESSION_ID, NULL);\r\nELEM_OPT_TELV(0x60, BSSGP_PDU_TYPE, DE_BSSGP_MBMS_RESPONSE, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_mbms_session_stop_req(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_DL;\r\nELEM_MAND_TELV(0x5c, GSM_A_PDU_TYPE_GM, DE_TMGI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(0x5d, BSSGP_PDU_TYPE, DE_BSSGP_MBMS_SESSION_ID, NULL);\r\nELEM_OPT_TELV(0x63, BSSGP_PDU_TYPE, DE_BSSGP_MBMS_STOP_CAUSE, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_mbms_session_stop_resp(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(0x5c, GSM_A_PDU_TYPE_GM, DE_TMGI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(0x5d, BSSGP_PDU_TYPE, DE_BSSGP_MBMS_SESSION_ID, NULL);\r\nELEM_OPT_TELV(0x60, BSSGP_PDU_TYPE, DE_BSSGP_MBMS_RESPONSE, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_mbms_session_update_req(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(0x5c, GSM_A_PDU_TYPE_GM, DE_TMGI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(0x5d, BSSGP_PDU_TYPE, DE_BSSGP_MBMS_SESSION_ID, NULL);\r\nELEM_MAND_TELV(0x3a , GSM_A_PDU_TYPE_GM, DE_QOS, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x5f, BSSGP_PDU_TYPE, DE_BSSGP_MBMS_SAI_LIST, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x61, BSSGP_PDU_TYPE, DE_BSSGP_MBMS_RA_LIST, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x5e, BSSGP_PDU_TYPE, DE_BSSGP_MBMS_SESSION_DUR, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x62, BSSGP_PDU_TYPE, DE_BSSGP_MBMS_SESSION_INF, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_MAND_TELV(0x71, BSSGP_PDU_TYPE, DE_BSSGP_TIME_TO_MBMS_DATA_TRAN, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(0x17, GSM_A_PDU_TYPE_BSSMAP, BE_PRIO, NULL);\r\nELEM_OPT_TELV(0x72, BSSGP_PDU_TYPE, DE_BSSGP_MBMS_SESSION_REP_NO, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void\r\nbssgp_mbms_session_uptate_resp(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\npinfo->link_dir = P2P_DIR_UL;\r\nELEM_MAND_TELV(0x5c, GSM_A_PDU_TYPE_GM, DE_TMGI, NULL, ei_bssgp_missing_mandatory_element);\r\nELEM_OPT_TELV(0x5d, BSSGP_PDU_TYPE, DE_BSSGP_MBMS_SESSION_ID, NULL);\r\nELEM_OPT_TELV(0x60, BSSGP_PDU_TYPE, DE_BSSGP_MBMS_RESPONSE, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_bssgp_extraneous_data);\r\n}\r\nstatic void get_bssgp_msg_params(guint8 oct, const gchar **msg_str, int *ett_tree, int *hf_idx, msg_fcn *msg_fcn_p)\r\n{\r\ngint idx;\r\n*msg_str = try_val_to_str_idx_ext((guint32) (oct & 0xff), &bssgp_msg_strings_ext, &idx);\r\n*hf_idx = hf_bssgp_msg_type;\r\nif (*msg_str != NULL) {\r\n*ett_tree = ett_bssgp_msg[idx];\r\n*msg_fcn_p = bssgp_msg_fcn[idx];\r\n}\r\nreturn;\r\n}\r\nstatic int\r\ndissect_bssgp(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nproto_item *ti;\r\nproto_tree *bssgp_tree = NULL;\r\nint offset = 0;\r\nguint32 len;\r\nconst gchar *msg_str = NULL;\r\ngint ett_tree;\r\nint hf_idx;\r\nvoid (*msg_fcn_p)(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len);\r\ng_rim_application_identity = 0;\r\ngparent_tree = tree;\r\nlen = tvb_reported_length(tvb);\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "BSSGP");\r\ncol_clear(pinfo->cinfo, COL_INFO);\r\ng_pdu_type = tvb_get_guint8(tvb,offset);\r\nti = proto_tree_add_item(tree, proto_bssgp, tvb, 0, -1, ENC_NA);\r\nbssgp_tree = proto_item_add_subtree(ti, ett_bssgp);\r\nmsg_fcn_p = NULL;\r\nett_tree = -1;\r\nhf_idx = -1;\r\nmsg_str = NULL;\r\nget_bssgp_msg_params(g_pdu_type, &msg_str, &ett_tree, &hf_idx, &msg_fcn_p);\r\nif(msg_str){\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "%s", msg_str);\r\n}else{\r\nexpert_add_info_format(pinfo, ti, &ei_bssgp_msg_type, "Unknown message 0x%x", g_pdu_type);\r\nreturn 1;\r\n}\r\nproto_tree_add_item(bssgp_tree, hf_idx, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nif (msg_fcn_p == NULL)\r\n{\r\nproto_tree_add_item(bssgp_tree, hf_bssgp_message_elements, tvb, offset, len - offset, ENC_NA);\r\n}\r\nelse\r\n{\r\n(*msg_fcn_p)(tvb, bssgp_tree, pinfo, offset, len - offset);\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_bssgp(void)\r\n{\r\nguint i;\r\nguint last_offset;\r\nstatic hf_register_info hf[] = {\r\n{ &hf_bssgp_msg_type,\r\n{ "PDU Type", "bssgp.pdu_type",\r\nFT_UINT8, BASE_HEX|BASE_EXT_STRING, &bssgp_msg_strings_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_elem_id,\r\n{ "Element ID", "bssgp.elem_id",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_bss_area_ind,\r\n{ "BSS indicator", "bssgp.bss_ind",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_bvci,\r\n{ "BVCI", "bssgp.bvci",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_bmax,\r\n{ "Bmax(x 100 or in increments as defined by the Flow Control Granularity IE)", "bssgp.bmax",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_r,\r\n{ "R(x 100 or in increments as defined by the Flow Control Granularity IE)", "bssgp.r",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_r_pfc,\r\n{ "R_PFC(x 100 or in increments as defined by the Flow Control Granularity IE)", "bssgp.r_pfc",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_bucket_size,\r\n{ "Bmax(x 100 or in increments as defined by the Flow Control Granularity IE)", "bssgp.bucket_size",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_bmax_pfc,\r\n{ "Bmax_PFC(x 100 or in increments as defined by the Flow Control Granularity IE)", "bssgp.bmax_pfc",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_omc_id,\r\n{ "OMC identity", "bssgp.omc_id",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_nsei,\r\n{ "NSEI", "bssgp.nsei",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_rrlp_flag1,\r\n{ "Flag 1", "bssgp.rrlp_flag1",\r\nFT_BOOLEAN, 8, TFS(&bssgp_rrlp_flg1_vals), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_ci,\r\n{ "CI", "bssgp.ci",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\n"Cell Identity", HFILL }\r\n},\r\n{ &hf_bssgp_flush_action,\r\n{ "Action", "bssgp.flush_action",\r\nFT_UINT8, BASE_DEC, VALS(bssgp_flush_action_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_llc_frames_disc,\r\n{ "Number of frames discarded", "bssgp.llc_frames_disc",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_ra_discriminator,\r\n{ "Routing Address Discriminator", "bssgp.rad",\r\nFT_UINT8, BASE_DEC, VALS(bssgp_ra_discriminator_vals), 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_rim_app_id,\r\n{ "RIM Application Identity", "bssgp.rim_app_id",\r\nFT_UINT8, BASE_DEC, VALS(bssgp_rim_appid_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_rim_seq_no,\r\n{ "RIM Sequence Number", "bssgp.rim_seq_no",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_rat_discriminator,\r\n{ "RAT discriminator", "bssgp.rat_discriminator",\r\nFT_UINT8, BASE_DEC, VALS(bssgp_rat_discriminator_vals), 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_nacc_cause,\r\n{ "NACC Cause", "bssgp.nacc_cause",\r\nFT_UINT8, BASE_DEC, VALS(bssgp_nacc_cause_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_s13_cause,\r\n{ "SI3 Cause", "bssgp.s13_cause",\r\nFT_UINT8, BASE_DEC, VALS(bssgp_s13_cause_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_mbms_data_ch_cause,\r\n{ "MBMS data channel Cause", "bssgp.mbms_data_ch_cause",\r\nFT_UINT8, BASE_DEC, VALS(bssgp_mbms_data_ch_cause_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_utra_si_cause,\r\n{ "UTRA SI Cause", "bssgp.utra_si_cause",\r\nFT_UINT8, BASE_DEC, VALS(bssgp_utra_si_cause_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_num_si_psi,\r\n{ "Number of SI/PSI", "bssgp.num_si_psi",\r\nFT_UINT8, BASE_DEC, NULL, 0xfe,\r\nNULL, HFILL }\r\n},\r\n{&hf_bssgp_si_psi_type,\r\n{ "Type", "bssgp.si_psi_type",\r\nFT_BOOLEAN, 8, TFS(&bssgp_si_psi_type_vals), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_ran_inf_req_pdu_t_ext_c,\r\n{ "PDU Type Extension", "bssgp.ran_inf_req_pdu_t_ext_c",\r\nFT_UINT8, BASE_DEC, VALS(bssgp_ran_inf_req_pdu_t_ext_c_vals), 0x0e,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_ran_inf_pdu_t_ext_c,\r\n{ "PDU Type Extension", "bssgp.ran_inf_pdu_t_ext_c",\r\nFT_UINT8, BASE_DEC, VALS(bssgp_ran_inf_pdu_t_ext_c_vals), 0x0e,\r\nNULL, HFILL }\r\n},\r\n{&hf_bssgp_rim_pdu_ind_ack,\r\n{ "ACK", "bssgp.rim_pdu_ind_ack",\r\nFT_BOOLEAN, 8, TFS(&bssgp_rim_pdu_ind_ack_vals), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_rim_proto_ver_no,\r\n{ "RIM Protocol Version Number", "bssgp.rim_proto_ver_no",\r\nFT_UINT8, BASE_DEC, VALS(bssgp_rim_proto_ver_no_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_delay_val,\r\n{ "Delay Value (in centi-seconds)", "bssgp.delay_val",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_cause,\r\n{ "Cause", "bssgp.cause",\r\nFT_UINT8, BASE_DEC|BASE_EXT_STRING, &bssgp_cause_vals_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_peak_rate_gran,\r\n{ "Peak Bit Rate Granularity", "bssgp.peak_rate_gran",\r\nFT_UINT8, BASE_DEC, NULL, 0xc0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_cr_bit,\r\n{ "C/R", "bssgp.cr_bit",\r\nFT_BOOLEAN, 8, TFS(&bssgp_cr_bit_vals), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_t_bit,\r\n{ "T", "bssgp.t_bit",\r\nFT_BOOLEAN, 8, TFS(&bssgp_t_bit_vals), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_a_bit,\r\n{ "A", "bssgp.a_bit",\r\nFT_BOOLEAN, 8, TFS(&bssgp_a_bit_vals), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_ra_cause,\r\n{ "Radio Cause", "bssgp.ra_cause",\r\nFT_UINT8, BASE_DEC, VALS(bssgp_radio_cause_vals), 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_ra_cap_upd_cause,\r\n{ "RA-Cap-UPD Cause", "bssgp.ra_cap_upd_cause",\r\nFT_UINT8, BASE_DEC, VALS(bssgp_ra_cap_upd_cause_vals), 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_r_default_ms,\r\n{ "R_default_MS(x 100 or in increments as defined by the Flow Control Granularity IE)", "bssgp.r_default_ms",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_suspend_ref_no,\r\n{ "Suspend Reference Number", "bssgp.suspend_ref_no",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_tag,\r\n{ "Tag", "bssgp.tag",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_trace_ref,\r\n{ "Trace Reference", "bssgp.trace_ref",\r\nFT_UINT16, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_trigger_id,\r\n{ "Entity Identity", "bssgp.entity_id",\r\nFT_BYTES, BASE_NONE, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_transaction_id,\r\n{ "Transaction Id", "bssgp.transaction_id",\r\nFT_UINT16, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_no_of_oct,\r\n{ "Number of octets transferred or deleted", "bssgp.no_of_oct",\r\nFT_UINT24, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_unit_val,\r\n{ "Unit Value", "bssgp.unit_val",\r\nFT_UINT8, BASE_DEC, VALS(bssgp_unit_vals), 0xe0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_gprs_timer,\r\n{ "Unit Value", "bssgp.gprs_timer",\r\nFT_UINT8, BASE_DEC, NULL, 0x1f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_mbms,\r\n{ "MBMS Procedures", "bssgp.mbms",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_EnhancedRadioStatus,\r\n{ "Enhanced Radio Status Procedures", "bssgp.enhancedradiostatus",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_pfcfc,\r\n{ "PFC Flow Control Procedures", "bssgp.pfcfc",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_rim,\r\n{ "RAN Information Management (RIM) procedures", "bssgp.rim",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_lcs,\r\n{ "LCS Procedures", "bssgp.lcs",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_inr,\r\n{ "Inter-NSE re-routing(INR)", "bssgp.inr",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_cbl,\r\n{ "Current Bucket Level(CBL) Procedures", "bssgp.cbl",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_pfc,\r\n{ "Packet Flow Context(PFC) Procedures", "bssgp.pfc",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_bucket_full_ratio,\r\n{ "Ratio of the bucket that is filled up with data", "bssgp.bucket_full_ratio",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"B current x (100 / Bmax)", HFILL }\r\n},\r\n{ &hf_bssgp_b_pfc,\r\n{ "B_PFC: Bucket Full Ratio of the PFC", "bssgp.b_pfc",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"B current x (100 / Bmax)", HFILL }\r\n},\r\n{ &hf_bssgp_precedence,\r\n{ "Precedence", "bssgp.precedence",\r\nFT_UINT8, BASE_DEC, NULL, 0x07,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_serv_utran_cco,\r\n{ "Service UTRAN CCO", "bssgp.serv_utran_cco",\r\nFT_UINT8, BASE_DEC, VALS(bssgp_service_utran_cco_vals), 0x07,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_mbms_session_id,\r\n{ "MBMS Session ID", "bssgp.mbms_session_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_mbms_cause,\r\n{ "Cause", "bssgp.mbms_cause",\r\nFT_UINT8, BASE_DEC|BASE_EXT_STRING, &bssgp_mbms_cause_vals_ext, 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_mbms_stop_cause,\r\n{ "Stop Cause", "bssgp.mbms_stop_cause",\r\nFT_UINT8, BASE_DEC|BASE_EXT_STRING, &bssgp_mbms_stop_cause_vals_ext, 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_session_inf,\r\n{ "BC/MC", "bssgp.session_inf",\r\nFT_BOOLEAN, 8, TFS(&tfs_bssgp_bc_mc), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_mbms_num_ra_ids,\r\n{ "Number of Routing Area Identifications", "bssgp.mbms_num_ra_ids",\r\nFT_UINT8, BASE_DEC|BASE_EXT_STRING, &bssgp_mbms_num_ra_ids_vals_ext, 0xf0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_gb_if,\r\n{ "Gigabit Interface", "bssgp.gb_if",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_ps_ho,\r\n{ "PS Handover", "bssgp.ps_ho",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_src_to_trg_transp_cont,\r\n{ "Source to Target Transparent Container", "bssgp.src_to_trg_transp_cont",\r\nFT_BYTES, FT_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_trg_to_src_transp_cont,\r\n{ "Target to Source Transparent Container", "bssgp.trg_to_src_transp_cont",\r\nFT_BYTES, FT_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_rnc_id,\r\n{ "RNC ID", "bssgp.rnc_id",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_page_mode,\r\n{ "PAGE_MODE", "bssgp.page_mode",\r\nFT_UINT8, BASE_DEC, VALS(bssgp_page_mode_vals), 0x03,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_container_id,\r\n{ "Container ID", "bssgp.container_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x03,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_global_tfi,\r\n{ "Global TFI", "bssgp.global_tfi",\r\nFT_UINT8, BASE_DEC, VALS(bssgp_global_tfi_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_ul_tfi,\r\n{ "UPLINK_TFI", "bssgp.ul_tfi",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_dl_tfi,\r\n{ "DOWNLINK_TFI", "bssgp.dl_tfi",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_time_to_MBMS_data_tran,\r\n{ "Time to MBMS Data Transfer", "bssgp.time_to_mbms_data_tran",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_mbms_session_rep_no,\r\n{ "MBMS-Session-Repetition-Number", "bssgp.mbms_session_rep_no",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_ps_ho_cmd,\r\n{ "PS Handover Command", "bssgp.ps_ho_cmd",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_sipsi,\r\n{ "SI/PSI", "bssgp.sipsi",\r\nFT_BOOLEAN, 8, TFS(&tfs_requested_not_requested), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_type,\r\n{ "Type", "bssgp.type",\r\nFT_UINT8, BASE_DEC, VALS(type_vals), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_cs_indication,\r\n{ "CS Indication Contents", "bssgp.cs_indication",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_flow_control_gran,\r\n{ "Granularity", "bssgp.flow_control_gran",\r\nFT_UINT8, BASE_DEC, VALS(bssgp_flow_control_gran_vals), 0x03,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_serv_eutran_cco,\r\n{ "Service EUTRAN CCO", "bssgp.serv_eutran_cco",\r\nFT_UINT8, BASE_DEC, VALS(bssgp_service_eutran_cco_vals), 0x18,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_sub_prof_id_f_rat_freq_prio,\r\n{ "Subscriber Profile ID for RAT/Frequency priority", "bssgp.sub_prof_id_f_rat_freq_prio",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_eutran_irat_ho_inf_req,\r\n{ "E-UTRAN Inter RAT Handover Info", "bssgp.eutran_irat_ho_inf_req",\r\nFT_BOOLEAN, 8, TFS(&tfs_requested_not_requested), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_irat_ho_inf_req,\r\n{ "Inter RAT Handover Info", "bssgp.irat_ho_inf_req",\r\nFT_BOOLEAN, 8, TFS(&tfs_requested_not_requested), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_rel_int_rat_ho_inf_ind,\r\n{ "Inter RAT Handover Info", "bssgp.rel_int_rat_ho_inf_ind",\r\nFT_BOOLEAN, 8, TFS(&tfs_reliable_not_reliable), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_csg_id,\r\n{ "CSG Identity (CSG-ID)", "bssgp.csg_id",\r\nFT_UINT32, BASE_HEX, NULL, 0xffffff0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_cell_acc_mode,\r\n{ "Cell Access Mode", "bssgp.cell_acc_mode",\r\nFT_UINT8, BASE_DEC, VALS(bssgp_cell_access_mode_vals), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_redir_complete_outcome,\r\n{ "Outcome Value", "bssgp.redir_complete_outcome",\r\nFT_UINT8, BASE_HEX, VALS(bssgp_redir_complete_outcome_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_redir_indiction_reroute_reject_cause,\r\n{ "Reroute Reject Cause Value", "bssgp.redir_indiction_reroute_reject_cause",\r\nFT_UINT8, BASE_HEX, VALS(bssgp_redir_indiction_reroute_reject_cause_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_unconfim_send_state_var,\r\n{ "Unconfirmed Send State Variable V(U)", "bssgp.unconfim_send_state_var",\r\nFT_UINT16, BASE_DEC, NULL, 0x01ff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_Global_ENB_ID_PDU,\r\n{ "Global-ENB-ID", "bssgp.Global_ENB_ID",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_SONtransferRequestContainer_PDU,\r\n{ "SONtransferRequestContainer", "bssgp.SONtransferRequestContainer",\r\nFT_UINT32, BASE_DEC, VALS(s1ap_SONtransferRequestContainer_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_bssgp_selected_plmn_id,\r\n{ "Selected PLMN ID", "bssgp.selected_plmn_id",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_bssgp_num_pfc,\r\n{ "Number of PFCs", "bssgp.num_pfc",\r\nFT_UINT16, BASE_DEC, NULL, 0x01ff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_bssgp_llc_data,\r\n{ "LLC DATA", "bssgp.llc_data",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_bssgp_pdu_data,\r\n{ "PDU DATA", "bssgp.pdu_data",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_bssgp_rrlp_apdu,\r\n{ "RRLP APDU", "bssgp.rrlp_apdu",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_bssgp_dtm_handover_command_data,\r\n{ "DTM Handover Command data", "bssgp.dtm_handover_command_data",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_bssgp_message_elements,\r\n{ "Message Elements", "bssgp.message_elements",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_bssgp_spare,\r\n{ "Spare octet(s)", "bssgp.spare",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_bssgp_si,\r\n{ "SI", "bssgp.si",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_bssgp_psi,\r\n{ "PSI", "bssgp.psi",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_bssgp_peak_bit_rate,\r\n{ "Peak bit rate", "bssgp.peak_bit_rate",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_bssgp_sys_info_type3_msg,\r\n{ "SYSTEM INFORMATION type 3 message", "bssgp.sys_info_type3_msg",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_bssgp_trace_type_data,\r\n{ "Trace Type data ( Coding unknown (Specification withdrawn) 3GPP TS 32.008)", "bssgp.trace_type_data",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_bssgp_si_item,\r\n{ "SI item", "bssgp.si_item",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n};\r\n#define NUM_INDIVIDUAL_ELEMS 10\r\ngint *ett[NUM_INDIVIDUAL_ELEMS +\r\nNUM_BSSGP_ELEM +\r\nNUM_BSSGP_MSG];\r\nstatic ei_register_info ei[] = {\r\n{ &ei_bssgp_extraneous_data, { "bssgp.extraneous_data", PI_PROTOCOL, PI_NOTE, "Extraneous Data, dissector bug or later version spec(report to wireshark.org)", EXPFILL }},\r\n{ &ei_bssgp_missing_mandatory_element, { "bssgp.missing_mandatory_element", PI_PROTOCOL, PI_WARN, "Missing Mandatory element, rest of dissection is suspect", EXPFILL }},\r\n{ &ei_bssgp_not_dissected_yet, { "bssgp.not_dissected_yet", PI_UNDECODED, PI_WARN, "Not dissected yet", EXPFILL }},\r\n{ &ei_bssgp_erroneous_app_container, { "bssgp.erroneous_app_container", PI_PROTOCOL, PI_WARN, "Erroneous Application Container including IEI and LI", EXPFILL }},\r\n{ &ei_bssgp_si_item, { "bssgp.erroneous_app_container", PI_PROTOCOL, PI_WARN, "Unknown SI message", EXPFILL }},\r\n{ &ei_bssgp_unknown_rim_app_id_data, { "bssgp.rim_app_id_data.unknown", PI_PROTOCOL, PI_WARN, "Unknown RIM Application Identitys Data", EXPFILL }},\r\n{ &ei_bssgp_unknown_app_container, { "bssgp.unknown_app_container", PI_PROTOCOL, PI_WARN, "Unknown Application Error Container", EXPFILL }},\r\n{ &ei_bssgp_ra_discriminator, { "bssgp.ra_discriminator.unknown", PI_PROTOCOL, PI_WARN, "Unknown RIM Routing Address discriminator", EXPFILL }},\r\n{ &ei_bssgp_unknown_rim_app_id, { "bssgp.rim_app_id.unknown", PI_PROTOCOL, PI_WARN, "Unknown RIM Application Identity", EXPFILL }},\r\n{ &ei_bssgp_msg_type, { "bssgp.msg_type.unknown", PI_PROTOCOL, PI_WARN, "Unknown message", EXPFILL }},\r\n};\r\nexpert_module_t* expert_bssgp;\r\nett[0] = &ett_bssgp;\r\nett[1] = &ett_bssgp_list_of_setup_pfcs;\r\nett[2] = &ett_bssgp_pfcs_to_be_set_up_list_t10;\r\nett[3] = &ett_bssgp_pfcs_to_be_set_up_list_arp;\r\nett[4] = &ett_bssgp_pfcs_to_be_set_up_list_abqp;\r\nett[5] = &ett_bssgp_pfcs_to_be_set_up_list_pft;\r\nett[6] = &ett_bssgp_pfcs_to_be_set_up_list;\r\nett[7] = &ett_bssgp_new;\r\nett[8] = &ett_bssgp_pfc_flow_control_parameters_pfc;\r\nett[9] = &ett_bssgp_ra_id,\r\nlast_offset = NUM_INDIVIDUAL_ELEMS;\r\nfor (i=0; i < NUM_BSSGP_ELEM; i++, last_offset++)\r\n{\r\nett_bssgp_elem[i] = -1;\r\nett[last_offset] = &ett_bssgp_elem[i];\r\n}\r\nfor (i=0; i < NUM_BSSGP_MSG; i++, last_offset++)\r\n{\r\nett_bssgp_msg[i] = -1;\r\nett[last_offset] = &ett_bssgp_msg[i];\r\n}\r\nproto_bssgp = proto_register_protocol("Base Station Subsystem GPRS Protocol", "BSSGP", "bssgp");\r\nproto_register_field_array(proto_bssgp, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_bssgp = expert_register_protocol(proto_bssgp);\r\nexpert_register_field_array(expert_bssgp, ei, array_length(ei));\r\nregister_dissector("bssgp", dissect_bssgp, proto_bssgp);\r\nbssgp_module = prefs_register_protocol(proto_bssgp, NULL);\r\nprefs_register_bool_preference(bssgp_module, "decode_nri",\r\n"Decode NRI",\r\n"Decode NRI (for use with SGSN in Pool)",\r\n&bssgp_decode_nri);\r\nprefs_register_uint_preference(bssgp_module, "nri_length", "NRI length",\r\n"NRI length, in bits",\r\n10, &bssgp_nri_length);\r\n}\r\nvoid\r\nproto_reg_handoff_bssgp(void)\r\n{\r\nllc_handle = find_dissector("llcgprs");\r\nrrlp_handle = find_dissector("rrlp");\r\ndiameter_3gpp_avp_dissector_table = find_dissector_table("diameter.3gpp");\r\n}
