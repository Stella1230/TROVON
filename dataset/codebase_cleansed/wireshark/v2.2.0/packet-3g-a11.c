static void\r\ndecode_sse(proto_tree *ext_tree, packet_info *pinfo, tvbuff_t *tvb, int offset, guint ext_len, proto_item *ext_len_item)\r\n{\r\nguint8 msid_len;\r\nguint8 msid_start_offset;\r\nguint8 msid_num_digits;\r\nguint8 msid_index;\r\nchar *msid_digits;\r\nconst char *p_msid;\r\ngboolean odd_even_ind;\r\nif (ext_len < 2) {\r\nexpert_add_info_format(pinfo, ext_len_item, &ei_a11_sse_too_short,\r\n"Cannot decode Protocol Type - SSE too short");\r\nreturn;\r\n}\r\nproto_tree_add_item(ext_tree, hf_a11_ses_ptype, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\next_len -= 2;\r\nif (ext_len < 4) {\r\nexpert_add_info_format(pinfo, ext_len_item, &ei_a11_sse_too_short,\r\n"Cannot decode Session Key - SSE too short");\r\nreturn;\r\n}\r\nproto_tree_add_item(ext_tree, hf_a11_ses_key, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\next_len -= 4;\r\nif (ext_len < 2) {\r\nexpert_add_info_format(pinfo, ext_len_item, &ei_a11_sse_too_short,\r\n"Cannot decode Session Id Version - SSE too short");\r\nreturn;\r\n}\r\nproto_tree_add_item(ext_tree, hf_a11_ses_sidver, tvb, offset+1, 1, ENC_BIG_ENDIAN);\r\noffset += 2;\r\next_len -= 2;\r\nif (ext_len < 2) {\r\nexpert_add_info_format(pinfo, ext_len_item, &ei_a11_sse_too_short,\r\n"Cannot decode SRID - SSE too short");\r\nreturn;\r\n}\r\nproto_tree_add_item(ext_tree, hf_a11_ses_mnsrid, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\next_len -= 2;\r\nif (ext_len < 2) {\r\nexpert_add_info_format(pinfo, ext_len_item, &ei_a11_sse_too_short,\r\n"Cannot decode MSID Type - SSE too short");\r\nreturn;\r\n}\r\nproto_tree_add_item(ext_tree, hf_a11_ses_msid_type, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\next_len -= 2;\r\nif (ext_len < 1) {\r\nexpert_add_info_format(pinfo, ext_len_item, &ei_a11_sse_too_short,\r\n"Cannot decode MSID Length - SSE too short");\r\nreturn;\r\n}\r\nmsid_len = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(ext_tree, hf_a11_ses_msid_len, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\next_len -= 1;\r\nif (ext_len < msid_len) {\r\nexpert_add_info_format(pinfo, ext_len_item, &ei_a11_sse_too_short,\r\n"Cannot decode MSID - SSE too short");\r\nreturn;\r\n}\r\nmsid_digits = (char *)wmem_alloc(wmem_packet_scope(), A11_MSG_MSID_LEN_MAX+2);\r\nmsid_start_offset = offset;\r\nif (msid_len > A11_MSG_MSID_ELEM_LEN_MAX) {\r\np_msid = "MSID is too long";\r\n} else if (msid_len == 0) {\r\np_msid = "MSID is too short";\r\n} else {\r\nfor (msid_index=0; msid_index<msid_len; msid_index++) {\r\nguint8 msid_digit = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\next_len -= 1;\r\nmsid_digits[msid_index*2] = (msid_digit & 0x0F) + '0';\r\nmsid_digits[(msid_index*2) + 1] = ((msid_digit & 0xF0) >> 4) + '0';\r\n}\r\nodd_even_ind = (msid_digits[0] == '1');\r\nif (odd_even_ind) {\r\nmsid_num_digits = ((msid_len-1) * 2) + 1;\r\n} else {\r\nmsid_num_digits = (msid_len-1) * 2;\r\n}\r\nmsid_digits[msid_num_digits + 1] = '\0';\r\np_msid = msid_digits + 1;\r\n}\r\nproto_tree_add_string(ext_tree, hf_a11_ses_msid, tvb, msid_start_offset, msid_len, p_msid);\r\n}\r\nstatic void\r\ndecode_bcmcs(proto_tree* ext_tree, packet_info *pinfo, tvbuff_t* tvb, int offset, guint ext_len, proto_item *ext_len_item)\r\n{\r\nguint8 bc_stype, entry_len;\r\nif (ext_len < 2) {\r\nexpert_add_info_format(pinfo, ext_len_item, &ei_a11_bcmcs_too_short,\r\n"Cannot decode Protocol Type - BCMCS too short");\r\nreturn;\r\n}\r\nbc_stype=tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(ext_tree, hf_a11_bcmcs_stype, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\next_len -= 1;\r\nswitch (bc_stype) {\r\ncase 1:\r\n{\r\nint i = 0;\r\nproto_tree *entry_tree;\r\nwhile (ext_len > 0) {\r\ni++;\r\nentry_len = tvb_get_guint8(tvb, offset);\r\nif (entry_len == 0) {\r\next_len -= 1;\r\nentry_len = 1;\r\n} else {\r\next_len = ext_len - entry_len;\r\n}\r\nentry_tree = proto_tree_add_subtree_format(ext_tree, tvb, offset, entry_len,\r\nett_a11_bcmcs_entry, NULL, "BCMCS Information Entry %u", i);\r\nproto_tree_add_item(entry_tree, hf_a11_bcmcs_entry_len, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_expert(ext_tree, pinfo, &ei_a11_entry_data_not_dissected, tvb, offset, entry_len -1);\r\noffset = offset+entry_len;\r\n}\r\n}\r\nbreak;\r\ndefault:\r\nproto_tree_add_expert_format(ext_tree, pinfo, &ei_a11_session_data_not_dissected, tvb, offset, -1, "Session Data Type %u Not dissected yet", bc_stype);\r\nreturn;\r\nbreak;\r\n}\r\n}\r\nstatic void\r\ndissect_a11_radius( tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *tree, int app_len)\r\n{\r\nproto_tree *radius_tree;\r\nif (!tree)\r\nreturn;\r\nif (tvb_reported_length_remaining(tvb, offset) < 12) {\r\nreturn;\r\n}\r\nradius_tree = proto_tree_add_subtree(tree, tvb, offset - 2, app_len, ett_a11_radiuses, NULL, "Airlink Record");\r\ndissect_attribute_value_pairs(radius_tree, pinfo, tvb, offset, app_len-2);\r\n}\r\nstatic const gchar *\r\ndissect_3gpp2_service_option_profile(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo)\r\n{\r\nint offset = 0;\r\nguint8 sub_type, sub_type_length;\r\nproto_item *pi;\r\nproto_tree_add_item(tree, hf_a11_serv_opt_prof_max_serv, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset+=4;\r\nwhile (tvb_reported_length_remaining(tvb,offset) > 0) {\r\nsub_type_length = tvb_get_guint8(tvb,offset+1);\r\nsub_type = tvb_get_guint8(tvb,offset);\r\nproto_tree_add_item(tree, hf_a11_sub_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\npi = proto_tree_add_item(tree, hf_a11_sub_type_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nif (sub_type_length < 2) {\r\nexpert_add_info(pinfo, pi, &ei_a11_sub_type_length_not2);\r\nsub_type_length = 2;\r\n}\r\nif (sub_type == 1) {\r\nproto_tree_add_item(tree, hf_a11_serv_opt, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_a11_max_num_serv_opt, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\noffset = offset + sub_type_length-2;\r\n}\r\nreturn "";\r\n}\r\nstatic const gchar *\r\ndissect_3gpp2_radius_aut_flow_profile_ids(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo)\r\n{\r\nproto_tree *sub_tree;\r\nint offset = 0;\r\nproto_item *item;\r\nguint8 sub_type, sub_type_length;\r\nguint32 value;\r\nwhile (tvb_reported_length_remaining(tvb,offset) > 0) {\r\nsub_type = tvb_get_guint8(tvb,offset);\r\nsub_type_length = tvb_get_guint8(tvb,offset+1);\r\nvalue = tvb_get_ntohs(tvb,offset+2);\r\nsub_tree = proto_tree_add_subtree_format(tree, tvb, offset, sub_type_length, ett_a11_aut_flow_profile_ids, &item,\r\n"%s = %u", val_to_str_const(sub_type, a11_aut_flow_prof_subtype_vals, "Unknown"), value);\r\nproto_tree_add_item(sub_tree, hf_a11_aut_flow_prof_sub_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nitem = proto_tree_add_item(sub_tree, hf_a11_aut_flow_prof_sub_type_len, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nif (sub_type_length < 2) {\r\nexpert_add_info(pinfo, item, &ei_a11_sub_type_length_not2);\r\nsub_type_length = 2;\r\n}\r\noffset += 1;\r\nproto_tree_add_item(sub_tree, hf_a11_aut_flow_prof_sub_type_value, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset+sub_type_length - 2;\r\n}\r\nreturn "";\r\n}\r\nstatic void\r\ndissect_ase(tvbuff_t *tvb, int offset, guint ase_len, proto_tree *ext_tree)\r\n{\r\nguint clen = 0;\r\nwhile (clen < ase_len) {\r\nproto_tree *exts_tree;\r\nguint8 srid = tvb_get_guint8(tvb, offset+1);\r\nguint16 service_option = tvb_get_ntohs(tvb, offset+2);\r\nguint8 entry_length;\r\nint entry_start_offset;\r\nentry_start_offset = offset;\r\nentry_length = tvb_get_guint8(tvb, offset);\r\nif (registration_request_msg && ((service_option == 64) || (service_option == 67)))\r\nexts_tree = proto_tree_add_subtree_format(ext_tree, tvb, offset, entry_length+1,\r\nett_a11_ase, NULL, "GRE Key Entry (SRID: %d)", srid);\r\nelse\r\nexts_tree = proto_tree_add_subtree_format(ext_tree, tvb, offset, entry_length,\r\nett_a11_ase, NULL, "GRE Key Entry (SRID: %d)", srid);\r\nproto_tree_add_item(exts_tree, hf_a11_ase_len_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(exts_tree, hf_a11_ase_srid_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(exts_tree, hf_a11_ase_servopt_type, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(exts_tree, hf_a11_ase_gre_proto_type, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(exts_tree, hf_a11_ase_gre_key, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(exts_tree, hf_a11_ase_pcf_addr_key, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nif ((entry_length>14)&&(registration_request_msg)) {\r\nif (service_option == 0x0043) {\r\nproto_tree *extv_tree;\r\nguint8 profile_count = tvb_get_guint8(tvb, offset+6);\r\nguint8 profile_index = 0;\r\nguint8 reverse_profile_count;\r\nproto_tree *extt_tree = proto_tree_add_subtree(exts_tree, tvb, offset,6+(profile_count*2)+1,\r\nett_a11_forward_rohc, NULL, "Forward ROHC Info");\r\nproto_tree_add_item(extt_tree, hf_a11_ase_forward_rohc_info_len, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(extt_tree, hf_a11_ase_forward_maxcid, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(extt_tree, hf_a11_ase_forward_mrru, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(extt_tree, hf_a11_ase_forward_large_cids, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nprofile_count=tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(extt_tree, hf_a11_ase_forward_profile_count, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nfor (profile_index=0; profile_index<profile_count; profile_index++) {\r\nproto_tree *extu_tree = proto_tree_add_subtree_format(extt_tree, tvb, offset, (2*profile_count),\r\nett_a11_forward_profile, NULL, "Forward Profile : %d", profile_index);\r\nproto_tree_add_item(extu_tree, hf_a11_ase_forward_profile, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\nreverse_profile_count=tvb_get_guint8(tvb, offset+6);\r\nextv_tree = proto_tree_add_subtree(exts_tree, tvb, offset,6+(reverse_profile_count*2)+1,\r\nett_a11_reverse_rohc, NULL, "Reverse ROHC Info");\r\nproto_tree_add_item(extv_tree, hf_a11_ase_reverse_rohc_info_len, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(extv_tree, hf_a11_ase_reverse_maxcid, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(extv_tree, hf_a11_ase_reverse_mrru, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(extv_tree, hf_a11_ase_reverse_large_cids, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nprofile_count=tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(extv_tree, hf_a11_ase_reverse_profile_count, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nfor (profile_index=0; profile_index<reverse_profile_count; profile_index++) {\r\nproto_tree *extw_tree = proto_tree_add_subtree_format(extv_tree, tvb, offset, (2*profile_count),\r\nett_a11_reverse_profile, NULL, "Reverse Profile : %d", profile_index);\r\nproto_tree_add_item(extw_tree, hf_a11_ase_reverse_profile, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\n}\r\n}\r\nclen += entry_length + 1;\r\noffset = entry_start_offset + entry_length+1;\r\n}\r\nregistration_request_msg =0;\r\n}\r\nstatic void\r\ndissect_fwd_qosinfo_flags(tvbuff_t *tvb, int offset, proto_tree *ext_tree, guint8 *p_dscp_included)\r\n{\r\nguint8 flags = tvb_get_guint8(tvb, offset);\r\nproto_item *ti = proto_tree_add_item(ext_tree, hf_a11_fqi_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree *flags_tree = proto_item_add_subtree(ti, ett_a11_fqi_flags);\r\nproto_tree_add_item(flags_tree, hf_a11_fqi_flags_ip_flow, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(flags_tree, hf_a11_fqi_flags_dscp, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nif (flags & A11_FQI_DSCP_INCLUDED) {\r\n*p_dscp_included = 1;\r\n} else {\r\n*p_dscp_included = 0;\r\n}\r\n}\r\nstatic void\r\ndissect_fqi_entry_flags(tvbuff_t *tvb, int offset, proto_tree *ext_tree, guint8 dscp_enabled)\r\n{\r\nproto_item *ti = proto_tree_add_item(ext_tree, hf_a11_fqi_entry_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree *flags_tree = proto_item_add_subtree(ti, ett_a11_fqi_entry_flags);\r\nif (dscp_enabled) {\r\nproto_tree_add_item(flags_tree, hf_a11_fqi_entry_flag_dscp, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nproto_tree_add_item(flags_tree, hf_a11_fqi_entry_flag_flow_state, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_rqi_entry_flags(tvbuff_t *tvb, int offset, proto_tree *ext_tree)\r\n{\r\nproto_item *ti = proto_tree_add_item(ext_tree, hf_a11_rqi_entry_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree *flags_tree = proto_item_add_subtree(ti, ett_a11_rqi_entry_flags);\r\nproto_tree_add_item(flags_tree, hf_a11_rqi_entry_flag_flow_state, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_fwd_qosinfo(tvbuff_t *tvb, int offset, proto_tree *ext_tree)\r\n{\r\nint clen = 0;\r\nguint8 flow_count;\r\nguint8 flow_index;\r\nguint8 dscp_enabled = 0;\r\nproto_tree_add_item(ext_tree, hf_a11_fqi_srid, tvb, offset+clen, 1, ENC_BIG_ENDIAN);\r\nclen++;\r\ndissect_fwd_qosinfo_flags(tvb, offset+clen, ext_tree, &dscp_enabled);\r\nclen++;\r\nflow_count = tvb_get_guint8(tvb, offset+clen);\r\nflow_count &= 0x1F;\r\nproto_tree_add_item(ext_tree, hf_a11_fqi_flowcount, tvb, offset+clen, 1, ENC_BIG_ENDIAN);\r\nclen++;\r\nfor (flow_index=0; flow_index<flow_count; flow_index++) {\r\nguint8 requested_qos_len = 0;\r\nguint8 granted_qos_len = 0;\r\nguint8 entry_len = tvb_get_guint8(tvb, offset+clen);\r\nguint8 flow_id = tvb_get_guint8(tvb, offset+clen+1);\r\nproto_tree *flow_tree = proto_tree_add_subtree_format(ext_tree, tvb, offset+clen,\r\nentry_len+1, ett_a11_fqi_flowentry, NULL, "Forward Flow Entry (Flow Id: %d)", flow_id);\r\nproto_tree_add_item(flow_tree, hf_a11_fqi_entrylen, tvb, offset+clen, 1, ENC_BIG_ENDIAN);\r\nclen++;\r\nproto_tree_add_item(flow_tree, hf_a11_fqi_flowid, tvb, offset+clen, 1, ENC_BIG_ENDIAN);\r\nclen++;\r\ndissect_fqi_entry_flags(tvb, offset+clen, flow_tree, dscp_enabled);\r\nclen++;\r\nrequested_qos_len = tvb_get_guint8(tvb, offset+clen);\r\nproto_tree_add_item(flow_tree, hf_a11_fqi_requested_qoslen, tvb, offset+clen, 1, ENC_BIG_ENDIAN);\r\nclen++;\r\nif (requested_qos_len) {\r\nproto_tree *exts_tree2;\r\nproto_tree *exts_tree1 = proto_tree_add_subtree(flow_tree, tvb, offset+clen,requested_qos_len,\r\nett_a11_fqi_requestedqos, NULL, "Forward Requested QoS ");\r\nproto_tree_add_item(exts_tree1, hf_a11_fqi_flow_priority, tvb,offset+clen , 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(exts_tree1, hf_a11_fqi_num_qos_attribute_set, tvb, offset+clen, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(exts_tree1, hf_a11_fqi_qos_attribute_setlen, tvb, offset+clen, 2, ENC_BIG_ENDIAN);\r\nclen++;\r\nexts_tree2 = proto_tree_add_subtree(exts_tree1, tvb, offset+clen, 4, ett_a11_fqi_qos_attribute_set,\r\nNULL, "QoS Attribute Set");\r\nproto_tree_add_item(exts_tree2, hf_a11_fqi_qos_attribute_setid, tvb, offset+clen, 2, ENC_BIG_ENDIAN);\r\nclen++;\r\nproto_tree_add_item(exts_tree2, hf_a11_fqi_verbose, tvb,offset+clen, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(exts_tree2, hf_a11_fqi_flow_profileid, tvb, offset+clen, 3, ENC_BIG_ENDIAN);\r\nclen += 3;\r\n}\r\ngranted_qos_len = tvb_get_guint8(tvb, offset+clen);\r\nproto_tree_add_item(flow_tree, hf_a11_fqi_granted_qoslen, tvb, offset+clen, 1, ENC_BIG_ENDIAN);\r\nclen++;\r\nif (granted_qos_len) {\r\nproto_tree *exts_tree3;\r\nexts_tree3 = proto_tree_add_subtree(flow_tree, tvb, offset+clen, granted_qos_len,\r\nett_a11_fqi_grantedqos, NULL, "Forward Granted QoS ");\r\nproto_tree_add_item(exts_tree3, hf_a11_fqi_qos_granted_attribute_setid, tvb, offset+clen, 1, ENC_BIG_ENDIAN);\r\nclen++;\r\n}\r\n}\r\n}\r\nstatic void\r\ndissect_rev_qosinfo(tvbuff_t *tvb, int offset, proto_tree *ext_tree)\r\n{\r\nint clen = 0;\r\nguint8 flow_count;\r\nguint8 flow_index;\r\nproto_tree_add_item(ext_tree, hf_a11_rqi_srid, tvb, offset+clen, 1, ENC_BIG_ENDIAN);\r\nclen++;\r\nflow_count = tvb_get_guint8(tvb, offset+clen);\r\nflow_count &= 0x1F;\r\nproto_tree_add_item(ext_tree, hf_a11_rqi_flowcount, tvb, offset+clen, 1, ENC_BIG_ENDIAN);\r\nclen++;\r\nfor (flow_index=0; flow_index<flow_count; flow_index++) {\r\nguint8 requested_qos_len;\r\nguint8 granted_qos_len;\r\nguint8 entry_len = tvb_get_guint8(tvb, offset+clen);\r\nguint8 flow_id = tvb_get_guint8(tvb, offset+clen+1);\r\nproto_tree *flow_tree = proto_tree_add_subtree_format\r\n(ext_tree, tvb, offset+clen, entry_len+1, ett_a11_rqi_flowentry, NULL,\r\n"Reverse Flow Entry (Flow Id: %d)", flow_id);\r\nproto_tree_add_item(flow_tree, hf_a11_rqi_entrylen, tvb, offset+clen, 1, ENC_BIG_ENDIAN);\r\nclen++;\r\nproto_tree_add_item(flow_tree, hf_a11_rqi_flowid, tvb, offset+clen, 1, ENC_BIG_ENDIAN);\r\nclen++;\r\ndissect_rqi_entry_flags(tvb, offset+clen, flow_tree);\r\nclen++;\r\nrequested_qos_len = tvb_get_guint8(tvb, offset+clen);\r\nproto_tree_add_item(flow_tree, hf_a11_rqi_requested_qoslen, tvb, offset+clen, 1, ENC_BIG_ENDIAN);\r\nclen++;\r\nif (requested_qos_len) {\r\nproto_tree *exts_tree1, *exts_tree2;\r\nexts_tree1 = proto_tree_add_subtree(flow_tree, tvb, offset+clen,requested_qos_len,\r\nett_a11_rqi_requestedqos, NULL, "Reverse Requested QoS ");\r\nproto_tree_add_item(exts_tree1, hf_a11_rqi_flow_priority, tvb,offset+clen , 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(exts_tree1, hf_a11_rqi_num_qos_attribute_set, tvb, offset+clen, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(exts_tree1, hf_a11_rqi_qos_attribute_setlen, tvb, offset+clen, 2, ENC_BIG_ENDIAN);\r\nclen++;\r\nexts_tree2 = proto_tree_add_subtree(exts_tree1, tvb, offset+clen, 4,\r\nett_a11_rqi_qos_attribute_set, NULL, "QoS Attribute Set");\r\nproto_tree_add_item(exts_tree2, hf_a11_rqi_qos_attribute_setid, tvb, offset+clen, 2, ENC_BIG_ENDIAN);\r\nclen++;\r\nproto_tree_add_item(exts_tree2, hf_a11_rqi_verbose, tvb,offset+clen, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(exts_tree2, hf_a11_rqi_flow_profileid, tvb, offset+clen, 3, ENC_BIG_ENDIAN);\r\nclen += 3;\r\n}\r\ngranted_qos_len = tvb_get_guint8(tvb, offset+clen);\r\nproto_tree_add_item(flow_tree, hf_a11_rqi_granted_qoslen, tvb, offset+clen, 1, ENC_BIG_ENDIAN);\r\nclen++;\r\nif (granted_qos_len) {\r\nproto_tree *exts_tree3;\r\nexts_tree3 = proto_tree_add_subtree(flow_tree, tvb, offset+clen,granted_qos_len,\r\nett_a11_rqi_grantedqos, NULL, "Reverse Granted QoS ");\r\nproto_tree_add_item(exts_tree3, hf_a11_rqi_qos_granted_attribute_setid, tvb, offset+clen, 1, ENC_BIG_ENDIAN);\r\nclen++;\r\n}\r\n}\r\n}\r\nstatic void\r\ndissect_subscriber_qos_profile(tvbuff_t *tvb, packet_info *pinfo, int offset, int ext_len, proto_tree *ext_tree)\r\n{\r\nproto_tree *exts_tree;\r\nint qos_profile_len = ext_len;\r\nexts_tree =\r\nproto_tree_add_subtree_format(ext_tree, tvb, offset, 0, ett_a11_subscriber_profile, NULL,\r\n"Subscriber Qos Profile (%d bytes)",\r\nqos_profile_len);\r\nif (qos_profile_len) {\r\nproto_tree_add_item\r\n(exts_tree, hf_a11_subsciber_profile, tvb, offset,\r\nqos_profile_len, ENC_NA);\r\ndissect_attribute_value_pairs(exts_tree, pinfo, tvb, offset, qos_profile_len);\r\n}\r\n}\r\nstatic void\r\ndissect_fwd_qosupdate_info(tvbuff_t *tvb, int offset, proto_tree *ext_tree)\r\n{\r\nint clen = 0;\r\nguint8 flow_count;\r\nguint8 flow_index;\r\nflow_count = tvb_get_guint8(tvb, offset+clen);\r\nproto_tree_add_item(ext_tree, hf_a11_fqui_flowcount, tvb, offset+clen, 1, ENC_BIG_ENDIAN);\r\nclen++;\r\nfor (flow_index=0; flow_index<flow_count; flow_index++) {\r\nproto_tree *exts_tree;\r\nguint8 granted_qos_len;\r\nguint8 flow_id = tvb_get_guint8(tvb, offset+clen);\r\nexts_tree = proto_tree_add_subtree_format\r\n(ext_tree, tvb, offset+clen, 1, ett_a11_fqui_flowentry, NULL,\r\n"Forward Flow Entry (Flow Id: %d)", flow_id);\r\nclen++;\r\ngranted_qos_len = tvb_get_guint8(tvb, offset+clen);\r\nproto_tree_add_item\r\n(exts_tree, hf_a11_fqui_updated_qoslen, tvb, offset+clen, 1, ENC_BIG_ENDIAN);\r\nclen++;\r\nif (granted_qos_len) {\r\nproto_tree_add_item\r\n(exts_tree, hf_a11_fqui_updated_qos, tvb, offset+clen,\r\ngranted_qos_len, ENC_NA);\r\nclen += granted_qos_len;\r\n}\r\n}\r\n}\r\nstatic void\r\ndissect_rev_qosupdate_info(tvbuff_t *tvb, int offset, proto_tree *ext_tree)\r\n{\r\nint clen = 0;\r\nguint8 flow_count;\r\nguint8 flow_index;\r\nflow_count = tvb_get_guint8(tvb, offset+clen);\r\nproto_tree_add_item(ext_tree, hf_a11_rqui_flowcount, tvb, offset+clen, 1, ENC_BIG_ENDIAN);\r\nclen++;\r\nfor (flow_index=0; flow_index<flow_count; flow_index++) {\r\nproto_tree *exts_tree;\r\nguint8 granted_qos_len;\r\nguint8 flow_id = tvb_get_guint8(tvb, offset+clen);\r\nexts_tree = proto_tree_add_subtree_format\r\n(ext_tree, tvb, offset+clen, 1, ett_a11_rqui_flowentry, NULL,\r\n"Reverse Flow Entry (Flow Id: %d)", flow_id);\r\nclen++;\r\ngranted_qos_len = tvb_get_guint8(tvb, offset+clen);\r\nproto_tree_add_item\r\n(exts_tree, hf_a11_rqui_updated_qoslen, tvb, offset+clen, 1, ENC_BIG_ENDIAN);\r\nclen++;\r\nif (granted_qos_len) {\r\nproto_tree_add_item\r\n(exts_tree, hf_a11_rqui_updated_qos, tvb, offset+clen,\r\ngranted_qos_len, ENC_NA);\r\nclen += granted_qos_len;\r\n}\r\n}\r\n}\r\nstatic void\r\ndissect_a11_extensions( tvbuff_t *tvb, packet_info *pinfo, int offset, proto_tree *tree)\r\n{\r\nproto_tree *exts_tree;\r\nproto_tree *ext_tree;\r\nproto_item *ext_len_item = NULL;\r\nguint ext_len;\r\nguint8 ext_type;\r\nguint8 ext_subtype = 0;\r\nguint hdrLen;\r\ngint16 apptype = -1;\r\nexts_tree = proto_tree_add_subtree(tree, tvb, offset, -1, ett_a11_exts, NULL, "Extensions");\r\nwhile (tvb_reported_length_remaining(tvb, offset) > 0) {\r\next_type = tvb_get_guint8(tvb, offset);\r\nif (ext_type == GEN_AUTH_EXT) {\r\next_subtype = tvb_get_guint8(tvb, offset + 1);\r\next_len = tvb_get_ntohs(tvb, offset + 2);\r\nhdrLen = 4;\r\n} else if ((ext_type == CVSE_EXT) || (ext_type == OLD_CVSE_EXT)) {\r\next_len = tvb_get_ntohs(tvb, offset + 2);\r\next_subtype = tvb_get_guint8(tvb, offset + 8);\r\nhdrLen = 4;\r\n} else {\r\next_len = tvb_get_guint8(tvb, offset + 1);\r\nhdrLen = 2;\r\n}\r\next_tree = proto_tree_add_subtree_format(exts_tree, tvb, offset, ext_len + hdrLen,\r\nett_a11_ext, NULL, "Extension: %s",\r\nval_to_str_ext(ext_type, &a11_ext_types_ext,\r\n"Unknown Extension %u"));\r\nproto_tree_add_uint(ext_tree, hf_a11_ext_type, tvb, offset, 1, ext_type);\r\noffset += 1;\r\nif (ext_type == SS_EXT) {\r\next_len_item = proto_tree_add_uint(ext_tree, hf_a11_ext_len, tvb, offset, 1, ext_len);\r\noffset += 1;\r\n}\r\nelse if ((ext_type == CVSE_EXT) || (ext_type == OLD_CVSE_EXT)) {\r\noffset += 1;\r\next_len_item = proto_tree_add_uint(ext_tree, hf_a11_ext_len, tvb, offset, 2, ext_len);\r\noffset += 2;\r\n}\r\nelse if (ext_type != GEN_AUTH_EXT) {\r\next_len_item = proto_tree_add_uint(ext_tree, hf_a11_ext_len, tvb, offset, 1, ext_len);\r\noffset += 1;\r\n}\r\nswitch (ext_type) {\r\ncase SS_EXT:\r\ndecode_sse(ext_tree, pinfo, tvb, offset, ext_len, ext_len_item);\r\noffset += ext_len;\r\next_len = 0;\r\nbreak;\r\ncase MH_AUTH_EXT:\r\ncase MF_AUTH_EXT:\r\ncase FH_AUTH_EXT:\r\ncase RU_AUTH_EXT:\r\nif (ext_len < 4)\r\nbreak;\r\nproto_tree_add_item(ext_tree, hf_a11_aext_spi, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\next_len -= 4;\r\nif (ext_len == 0)\r\nbreak;\r\nproto_tree_add_item(ext_tree, hf_a11_aext_auth, tvb, offset, ext_len,\r\nENC_NA);\r\nbreak;\r\ncase MN_NAI_EXT:\r\nif (ext_len == 0)\r\nbreak;\r\nproto_tree_add_item(ext_tree, hf_a11_next_nai, tvb, offset,\r\next_len, ENC_UTF_8|ENC_NA);\r\nbreak;\r\ncase GEN_AUTH_EXT:\r\nproto_tree_add_uint(ext_tree, hf_a11_ext_stype, tvb, offset, 1, ext_subtype);\r\noffset += 1;\r\nproto_tree_add_uint(ext_tree, hf_a11_ext_len, tvb, offset, 2, ext_len);\r\noffset += 2;\r\nif (ext_len < 4)\r\nbreak;\r\nproto_tree_add_item(ext_tree, hf_a11_aext_spi, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\next_len -= 4;\r\nif (ext_len == 0)\r\nbreak;\r\nproto_tree_add_item(ext_tree, hf_a11_aext_auth, tvb, offset,\r\next_len, ENC_NA);\r\nbreak;\r\ncase OLD_CVSE_EXT:\r\ncase CVSE_EXT:\r\nif (ext_len < 4)\r\nbreak;\r\nproto_tree_add_item(ext_tree, hf_a11_vse_vid, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\next_len -= 4;\r\nif (ext_len < 2)\r\nbreak;\r\napptype = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_uint(ext_tree, hf_a11_vse_apptype, tvb, offset, 2, apptype);\r\noffset += 2;\r\next_len -= 2;\r\nif (apptype == 0x0101) {\r\nif (tvb_reported_length_remaining(tvb, offset) > 0) {\r\ndissect_a11_radius(tvb, pinfo, offset, ext_tree, ext_len + 2);\r\n}\r\n}\r\nbreak;\r\ncase OLD_NVSE_EXT:\r\ncase NVSE_EXT:\r\nif (ext_len < 6)\r\nbreak;\r\nproto_tree_add_item(ext_tree, hf_a11_vse_vid, tvb, offset+2, 4, ENC_BIG_ENDIAN);\r\noffset += 6;\r\next_len -= 6;\r\nproto_tree_add_item(ext_tree, hf_a11_vse_apptype, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nif (ext_len < 2)\r\nbreak;\r\napptype = tvb_get_ntohs(tvb, offset);\r\noffset += 2;\r\next_len -= 2;\r\nswitch (apptype) {\r\ncase 0x0401:\r\nif (ext_len < 5)\r\nbreak;\r\nproto_tree_add_item(ext_tree, hf_a11_vse_panid, tvb, offset, 5, ENC_NA);\r\noffset += 5;\r\next_len -= 5;\r\nif (ext_len < 5)\r\nbreak;\r\nproto_tree_add_item(ext_tree, hf_a11_vse_canid, tvb, offset, 5, ENC_NA);\r\nbreak;\r\ncase 0x0501:\r\nif (ext_len < 4)\r\nbreak;\r\nproto_tree_add_item(ext_tree, hf_a11_vse_ppaddr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x0601:\r\nif (ext_len < 2)\r\nbreak;\r\nproto_tree_add_item(ext_tree, hf_a11_vse_dormant, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x0602:\r\nif (ext_len < 1)\r\nbreak;\r\nproto_tree_add_item(ext_tree, hf_a11_vse_ehrpd_mode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x0603:\r\nif (ext_len < 1)\r\nbreak;\r\nproto_tree_add_item(ext_tree, hf_a11_vse_ehrpd_pmk, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ext_tree, hf_a11_vse_ehrpd_handoff_info, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ext_tree, hf_a11_vse_ehrpd_tunnel_mode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x0701:\r\nif (ext_len < 1)\r\nbreak;\r\nproto_tree_add_item(ext_tree, hf_a11_vse_code, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x0801:\r\nif (ext_len < 1)\r\nbreak;\r\nproto_tree_add_item(ext_tree, hf_a11_vse_pdit, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x0802:\r\nproto_tree_add_item(ext_tree, hf_a11_vse_session_parameter, tvb, offset, -1, ENC_NA);\r\nbreak;\r\ncase 0x0803:\r\nproto_tree_add_item(ext_tree, hf_a11_vse_qosmode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x0901:\r\nif (ext_len < 2)\r\nbreak;\r\nproto_tree_add_item(ext_tree, hf_a11_vse_srvopt, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x0C01:\r\ndissect_ase(tvb, offset, ext_len, ext_tree);\r\nbreak;\r\ncase 0x0D01:\r\ndissect_fwd_qosinfo(tvb, offset, ext_tree);\r\nbreak;\r\ncase 0x0D02:\r\ndissect_rev_qosinfo(tvb, offset, ext_tree);\r\nbreak;\r\ncase 0x0D03:\r\ndissect_subscriber_qos_profile(tvb, pinfo, offset, ext_len, ext_tree);\r\nbreak;\r\ncase 0x0DFE:\r\ndissect_fwd_qosupdate_info(tvb, offset, ext_tree);\r\nbreak;\r\ncase 0x0DFF:\r\ndissect_rev_qosupdate_info(tvb, offset, ext_tree);\r\nbreak;\r\n}\r\nbreak;\r\ncase BCMCS_EXT:\r\ndecode_bcmcs(ext_tree, pinfo, tvb, offset, ext_len, ext_len_item);\r\noffset += ext_len;\r\next_len = 0;\r\nbreak;\r\ncase MF_CHALLENGE_EXT:\r\ndefault:\r\nproto_tree_add_item(ext_tree, hf_a11_ext, tvb, offset, ext_len, ENC_NA);\r\nbreak;\r\n}\r\noffset += ext_len;\r\n}\r\n}\r\nstatic int\r\ndissect_a11( tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data _U_)\r\n{\r\nproto_item *ti;\r\nproto_tree *a11_tree = NULL;\r\nguint8 type;\r\nguint offset = 0;\r\nif (!tvb_bytes_exist(tvb, offset, 1))\r\nreturn 0;\r\ntype = tvb_get_guint8(tvb, offset);\r\nif (try_val_to_str_ext(type, &a11_types_ext) == NULL)\r\nreturn 0;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "3GPP2 A11");\r\ncol_clear(pinfo->cinfo, COL_INFO);\r\nif (type == REGISTRATION_REQUEST)\r\nregistration_request_msg =1;\r\nelse\r\nregistration_request_msg =0;\r\nswitch (type) {\r\ncase REGISTRATION_REQUEST:\r\nregistration_request_msg = 1;\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "Reg Request: PDSN=%s PCF=%s",\r\ntvb_ip_to_str(tvb, 8),\r\ntvb_ip_to_str(tvb, 12));\r\nif (tree) {\r\nti = proto_tree_add_item(tree, proto_a11, tvb, offset, -1, ENC_NA);\r\na11_tree = proto_item_add_subtree(ti, ett_a11);\r\nproto_tree_add_uint(a11_tree, hf_a11_type, tvb, offset, 1, type);\r\noffset += 1;\r\nproto_tree_add_bitmask(a11_tree, tvb, offset, hf_a11_flags,\r\nett_a11_flags, a11_flags, ENC_NA);\r\noffset += 1;\r\nproto_tree_add_item(a11_tree, hf_a11_life, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset +=2;\r\nproto_tree_add_item(a11_tree, hf_a11_homeaddr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_haaddr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_coa, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_ident, tvb, offset, 8, ENC_TIME_NTP|ENC_BIG_ENDIAN);\r\noffset += 8;\r\n}\r\nbreak;\r\ncase REGISTRATION_REPLY:\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "Reg Reply: PDSN=%s, Code=%u",\r\ntvb_ip_to_str(tvb, 8), tvb_get_guint8(tvb,1));\r\nif (tree) {\r\nti = proto_tree_add_item(tree, proto_a11, tvb, offset, -1, ENC_NA);\r\na11_tree = proto_item_add_subtree(ti, ett_a11);\r\nproto_tree_add_uint(a11_tree, hf_a11_type, tvb, offset, 1, type);\r\noffset += 1;\r\nproto_tree_add_item(a11_tree, hf_a11_code, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(a11_tree, hf_a11_life, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(a11_tree, hf_a11_homeaddr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_haaddr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_ident, tvb, offset, 8, ENC_TIME_NTP|ENC_BIG_ENDIAN);\r\noffset += 8;\r\n}\r\nbreak;\r\ncase REGISTRATION_UPDATE:\r\ncol_add_fstr(pinfo->cinfo, COL_INFO,"Reg Update: PDSN=%s",\r\ntvb_ip_to_str(tvb, 8));\r\nif (tree) {\r\nti = proto_tree_add_item(tree, proto_a11, tvb, offset, -1, ENC_NA);\r\na11_tree = proto_item_add_subtree(ti, ett_a11);\r\nproto_tree_add_uint(a11_tree, hf_a11_type, tvb, offset, 1, type);\r\noffset += 1;\r\noffset += 3;\r\nproto_tree_add_item(a11_tree, hf_a11_homeaddr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_haaddr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_ident, tvb, offset, 8, ENC_TIME_NTP|ENC_BIG_ENDIAN);\r\noffset += 8;\r\n}\r\nbreak;\r\ncase REGISTRATION_ACK:\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "Reg Ack: PCF=%s Status=%u",\r\ntvb_ip_to_str(tvb, 8),\r\ntvb_get_guint8(tvb,3));\r\nif (tree) {\r\nti = proto_tree_add_item(tree, proto_a11, tvb, offset, -1, ENC_NA);\r\na11_tree = proto_item_add_subtree(ti, ett_a11);\r\nproto_tree_add_uint(a11_tree, hf_a11_type, tvb, offset, 1, type);\r\noffset += 1;\r\noffset += 2;\r\nproto_tree_add_item(a11_tree, hf_a11_status, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(a11_tree, hf_a11_homeaddr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_coa, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_ident, tvb, offset, 8, ENC_TIME_NTP|ENC_BIG_ENDIAN);\r\noffset += 8;\r\n}\r\nbreak;\r\ncase SESSION_UPDATE:\r\ncol_add_fstr(pinfo->cinfo, COL_INFO,"Ses Update: PDSN=%s",\r\ntvb_ip_to_str(tvb, 8));\r\nif (tree) {\r\nti = proto_tree_add_item(tree, proto_a11, tvb, offset, -1, ENC_NA);\r\na11_tree = proto_item_add_subtree(ti, ett_a11);\r\nproto_tree_add_uint(a11_tree, hf_a11_type, tvb, offset, 1, type);\r\noffset += 1;\r\noffset += 3;\r\nproto_tree_add_item(a11_tree, hf_a11_homeaddr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_haaddr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_ident, tvb, offset, 8, ENC_TIME_NTP|ENC_BIG_ENDIAN);\r\noffset += 8;\r\n}\r\nbreak;\r\ncase SESSION_ACK:\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "Ses Upd Ack: PCF=%s, Status=%u",\r\ntvb_ip_to_str(tvb, 8),\r\ntvb_get_guint8(tvb,3));\r\nif (tree) {\r\nti = proto_tree_add_item(tree, proto_a11, tvb, offset, -1, ENC_NA);\r\na11_tree = proto_item_add_subtree(ti, ett_a11);\r\nproto_tree_add_uint(a11_tree, hf_a11_type, tvb, offset, 1, type);\r\noffset += 1;\r\noffset += 2;\r\nproto_tree_add_item(a11_tree, hf_a11_status, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(a11_tree, hf_a11_homeaddr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_coa, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_ident, tvb, offset, 8, ENC_TIME_NTP|ENC_BIG_ENDIAN);\r\noffset += 8;\r\n}\r\nbreak;\r\ncase CAPABILITIES_INFO:\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "Cap Info: PDSN=%s, PCF=%s",\r\ntvb_ip_to_str(tvb, 8),\r\ntvb_ip_to_str(tvb, 12));\r\nif (tree) {\r\nti = proto_tree_add_item(tree, proto_a11, tvb, offset, -1, ENC_NA);\r\na11_tree = proto_item_add_subtree(ti, ett_a11);\r\nproto_tree_add_uint(a11_tree, hf_a11_type, tvb, offset, 1, type);\r\noffset += 1;\r\noffset += 3;\r\nproto_tree_add_item(a11_tree, hf_a11_homeaddr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_haaddr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_coa, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_ident, tvb, offset, 8, ENC_TIME_NTP|ENC_BIG_ENDIAN);\r\noffset += 8;\r\n}\r\nbreak;\r\ncase CAPABILITIES_INFO_ACK:\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "Cap Info Ack: PCF=%s",\r\ntvb_ip_to_str(tvb, 8));\r\nif (tree) {\r\nti = proto_tree_add_item(tree, proto_a11, tvb, offset, -1, ENC_NA);\r\na11_tree = proto_item_add_subtree(ti, ett_a11);\r\nproto_tree_add_uint(a11_tree, hf_a11_type, tvb, offset, 1, type);\r\noffset += 1;\r\noffset += 3;\r\nproto_tree_add_item(a11_tree, hf_a11_homeaddr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_coa, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_ident, tvb, offset, 8, ENC_TIME_NTP|ENC_BIG_ENDIAN);\r\noffset += 8;\r\n}\r\nbreak;\r\ncase BC_SERVICE_REQUEST:\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "Service Request: PCF=%s ",\r\ntvb_ip_to_str(tvb, offset + 8));\r\nif (tree) {\r\nti = proto_tree_add_item(tree, proto_a11, tvb, offset, -1, ENC_NA);\r\na11_tree = proto_item_add_subtree(ti, ett_a11);\r\nproto_tree_add_uint(a11_tree, hf_a11_type, tvb, offset, 1, type);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_homeaddr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_coa, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_ident, tvb, offset, 8, ENC_TIME_NTP|ENC_BIG_ENDIAN);\r\noffset += 8;\r\n}\r\nbreak;\r\ncase BC_SERVICE_REPLY:\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "Service Response: BSN=%s ",\r\ntvb_ip_to_str(tvb, offset + 8));\r\nif (tree) {\r\nti = proto_tree_add_item(tree, proto_a11, tvb, offset, -1, ENC_NA);\r\na11_tree = proto_item_add_subtree(ti, ett_a11);\r\nproto_tree_add_uint(a11_tree, hf_a11_type, tvb, offset, 1, type);\r\noffset += 3;\r\nproto_tree_add_item(a11_tree, hf_a11_code, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(a11_tree, hf_a11_homeaddr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_haaddr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_ident, tvb, offset, 8, ENC_TIME_NTP|ENC_BIG_ENDIAN);\r\noffset += 8;\r\n}\r\nbreak;\r\ncase BC_REGISTRATION_REQUEST:\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "BC Reg Request: BSN=%s ",\r\ntvb_ip_to_str(tvb, offset + 8));\r\nif (tree) {\r\nti = proto_tree_add_item(tree, proto_a11, tvb, offset, -1, ENC_NA);\r\na11_tree = proto_item_add_subtree(ti, ett_a11);\r\nproto_tree_add_uint(a11_tree, hf_a11_type, tvb, offset, 1, type);\r\noffset += 1;\r\nproto_tree_add_bitmask(a11_tree, tvb, offset, hf_a11_flags,\r\nett_a11_flags, a11_flags, ENC_NA);\r\noffset += 1;\r\nproto_tree_add_item(a11_tree, hf_a11_life, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset +=2;\r\nproto_tree_add_item(a11_tree, hf_a11_homeaddr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_haaddr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_coa, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_ident, tvb, offset, 8, ENC_TIME_NTP|ENC_BIG_ENDIAN);\r\noffset += 8;\r\n}\r\nbreak;\r\ncase BC_REGISTRATION_REPLY:\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "BC Reg Reply: BSN=%s, Code=%u",\r\ntvb_ip_to_str(tvb, offset + 8),\r\ntvb_get_guint8(tvb, offset + 1));\r\nif (tree) {\r\nti = proto_tree_add_item(tree, proto_a11, tvb, offset, -1, ENC_NA);\r\na11_tree = proto_item_add_subtree(ti, ett_a11);\r\nproto_tree_add_uint(a11_tree, hf_a11_type, tvb, offset, 1, type);\r\noffset += 1;\r\nproto_tree_add_item(a11_tree, hf_a11_code, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(a11_tree, hf_a11_life, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(a11_tree, hf_a11_homeaddr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_haaddr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_ident, tvb, offset, 8, ENC_TIME_NTP|ENC_BIG_ENDIAN);\r\noffset += 8;\r\n}\r\nbreak;\r\ncase BC_REGISTRATION_UPDATE:\r\ncol_add_fstr(pinfo->cinfo, COL_INFO,"BC Reg Update: BSN=%s",\r\ntvb_ip_to_str(tvb, offset + 8));\r\nif (tree) {\r\nti = proto_tree_add_item(tree, proto_a11, tvb, offset, -1, ENC_NA);\r\na11_tree = proto_item_add_subtree(ti, ett_a11);\r\nproto_tree_add_uint(a11_tree, hf_a11_type, tvb, offset, 1, type);\r\noffset += 1;\r\noffset += 3;\r\nproto_tree_add_item(a11_tree, hf_a11_homeaddr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_haaddr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_ident, tvb, offset, 8, ENC_TIME_NTP|ENC_BIG_ENDIAN);\r\noffset += 8;\r\n}\r\nbreak;\r\ncase BC_REGISTRATION_ACK:\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "BC Reg Acknowledge: PCF=%s Status=%u",\r\ntvb_ip_to_str(tvb, offset + 8),\r\ntvb_get_guint8(tvb, offset + 3));\r\nif (tree) {\r\nti = proto_tree_add_item(tree, proto_a11, tvb, offset, -1, ENC_NA);\r\na11_tree = proto_item_add_subtree(ti, ett_a11);\r\nproto_tree_add_uint(a11_tree, hf_a11_type, tvb, offset, 1, type);\r\noffset += 1;\r\noffset += 2;\r\nproto_tree_add_item(a11_tree, hf_a11_status, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(a11_tree, hf_a11_homeaddr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_coa, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(a11_tree, hf_a11_ident, tvb, offset, 8, ENC_TIME_NTP|ENC_BIG_ENDIAN);\r\noffset += 8;\r\n}\r\nbreak;\r\ndefault:\r\nDISSECTOR_ASSERT_NOT_REACHED();\r\nbreak;\r\n}\r\nif (tree && a11_tree) {\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\ndissect_a11_extensions(tvb, pinfo, offset, a11_tree);\r\n}\r\nreturn tvb_reported_length(tvb);\r\n}\r\nvoid\r\nproto_register_a11(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_a11_type,\r\n{ "Message Type", "a11.type",\r\nFT_UINT8, BASE_DEC | BASE_EXT_STRING, &a11_types_ext, 0,\r\n"A11 Message Type", HFILL }\r\n},\r\n{ &hf_a11_flags,\r\n{ "Flags", "a11.flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_a11_s,\r\n{ "Simultaneous Bindings", "a11.s",\r\nFT_BOOLEAN, 8, NULL, 128,\r\n"Simultaneous Bindings Allowed", HFILL }\r\n},\r\n{ &hf_a11_b,\r\n{ "Broadcast Datagrams", "a11.b",\r\nFT_BOOLEAN, 8, NULL, 64,\r\n"Broadcast Datagrams requested", HFILL }\r\n},\r\n{ &hf_a11_d,\r\n{ "Co-located Care-of Address", "a11.d",\r\nFT_BOOLEAN, 8, NULL, 32,\r\n"MN using Co-located Care-of address", HFILL }\r\n},\r\n{ &hf_a11_m,\r\n{ "Minimal Encapsulation", "a11.m",\r\nFT_BOOLEAN, 8, NULL, 16,\r\n"MN wants Minimal encapsulation", HFILL }\r\n},\r\n{ &hf_a11_g,\r\n{ "GRE", "a11.g",\r\nFT_BOOLEAN, 8, NULL, 8,\r\n"MN wants GRE encapsulation", HFILL }\r\n},\r\n{ &hf_a11_v,\r\n{ "Van Jacobson", "a11.v",\r\nFT_BOOLEAN, 8, NULL, 4,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_t,\r\n{ "Reverse Tunneling", "a11.t",\r\nFT_BOOLEAN, 8, NULL, 2,\r\n"Reverse tunneling requested", HFILL }\r\n},\r\n{ &hf_a11_code,\r\n{ "Reply Code", "a11.code",\r\nFT_UINT8, BASE_DEC | BASE_EXT_STRING, &a11_reply_codes_ext, 0,\r\n"A11 Registration Reply code", HFILL }\r\n},\r\n{ &hf_a11_status,\r\n{ "Reply Status", "a11.ackstat",\r\nFT_UINT8, BASE_DEC | BASE_EXT_STRING, &a11_ack_status_ext, 0,\r\n"A11 Registration Ack Status", HFILL }\r\n},\r\n{ &hf_a11_life,\r\n{ "Lifetime", "a11.life",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n"A11 Registration Lifetime", HFILL }\r\n},\r\n{ &hf_a11_homeaddr,\r\n{ "Home Address", "a11.homeaddr",\r\nFT_IPv4, BASE_NONE, NULL, 0,\r\n"Mobile Node's home address", HFILL }\r\n},\r\n{ &hf_a11_haaddr,\r\n{ "Home Agent", "a11.haaddr",\r\nFT_IPv4, BASE_NONE, NULL, 0,\r\n"Home agent IP Address", HFILL }\r\n},\r\n{ &hf_a11_coa,\r\n{ "Care of Address", "a11.coa",\r\nFT_IPv4, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_ident,\r\n{ "Identification", "a11.ident",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_UTC, NULL, 0,\r\n"MN Identification", HFILL }\r\n},\r\n{ &hf_a11_ext_type,\r\n{ "Extension Type", "a11.ext.type",\r\nFT_UINT8, BASE_DEC | BASE_EXT_STRING, &a11_ext_types_ext, 0,\r\n"Mobile IP Extension Type", HFILL }\r\n},\r\n{ &hf_a11_ext_stype,\r\n{ "Gen Auth Ext SubType", "a11.ext.auth.subtype",\r\nFT_UINT8, BASE_DEC, VALS(a11_ext_stypes), 0,\r\n"Mobile IP Auth Extension Sub Type", HFILL }\r\n},\r\n{ &hf_a11_ext_len,\r\n{ "Extension Length", "a11.ext.len",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n"Mobile IP Extension Length", HFILL }\r\n},\r\n{ &hf_a11_ext,\r\n{ "Extension", "a11.extension",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_aext_spi,\r\n{ "SPI", "a11.auth.spi",\r\nFT_UINT32, BASE_HEX, NULL, 0,\r\n"Authentication Header Security Parameter Index", HFILL }\r\n},\r\n{ &hf_a11_aext_auth,\r\n{ "Authenticator", "a11.auth.auth",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_next_nai,\r\n{ "NAI", "a11.nai",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_ses_key,\r\n{ "Key", "a11.ext.key",\r\nFT_UINT32, BASE_HEX, NULL, 0,\r\n"Session Key", HFILL }\r\n},\r\n{ &hf_a11_ses_sidver,\r\n{ "Session ID Version", "a11.ext.sidver",\r\nFT_UINT8, BASE_DEC, NULL, 3,\r\nNULL, HFILL}\r\n},\r\n{ &hf_a11_ses_mnsrid,\r\n{ "MNSR-ID", "a11.ext.mnsrid",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_ses_msid_type,\r\n{ "MSID Type", "a11.ext.msid_type",\r\nFT_UINT16, BASE_DEC, VALS(a11_ses_msid_type_vals), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_ses_msid_len,\r\n{ "MSID Length", "a11.ext.msid_len",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_ses_msid,\r\n{ "MSID(BCD)", "a11.ext.msid",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_ses_ptype,\r\n{ "Protocol Type", "a11.ext.ptype",\r\nFT_UINT16, BASE_HEX, VALS(a11_ses_ptype_vals), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_vse_vid,\r\n{ "Vendor ID", "a11.ext.vid",\r\nFT_UINT32, BASE_HEX|BASE_EXT_STRING, &sminmpec_values_ext, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_vse_apptype,\r\n{ "Application Type", "a11.ext.apptype",\r\nFT_UINT8, BASE_HEX | BASE_EXT_STRING, &a11_ext_app_ext, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_vse_ppaddr,\r\n{ "Anchor P-P Address", "a11.ext.ppaddr",\r\nFT_IPv4, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_vse_dormant,\r\n{ "All Dormant Indicator", "a11.ext.dormant",\r\nFT_UINT16, BASE_HEX, VALS(a11_ext_dormant), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_vse_ehrpd_mode,\r\n{ "eHRPD Mode", "a11.ext.ehrpd.mode",\r\nFT_BOOLEAN, 8, TFS(&a11_tfs_ehrpd_mode), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_vse_ehrpd_pmk,\r\n{ "PMK", "a11.ext.ehrpd.pmk",\r\nFT_BOOLEAN, 8, TFS(&a11_tfs_ehrpd_pmk), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_vse_ehrpd_handoff_info,\r\n{ "E-UTRAN Handoff Info", "a11.ext.ehrpd.handoff_info",\r\nFT_BOOLEAN, 8, TFS(&a11_tfs_ehrpd_handoff_info), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_vse_ehrpd_tunnel_mode,\r\n{ "Tunnel Mode", "a11.ext.ehrpd.tunnel_mode",\r\nFT_BOOLEAN, 8, TFS(&a11_tfs_ehrpd_tunnel_mode), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_vse_code,\r\n{ "Reply Code", "a11.ext.code",\r\nFT_UINT8, BASE_DEC | BASE_EXT_STRING, &a11_reply_codes_ext, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_vse_pdit,\r\n{ "PDSN Code", "a11.ext.code",\r\nFT_UINT8, BASE_HEX, VALS(a11_ext_nvose_pdsn_code), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_vse_session_parameter,\r\n{ "Session Parameter - Always On", "a11.ext.session_parameter",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_vse_srvopt,\r\n{ "Service Option", "a11.ext.srvopt",\r\nFT_UINT16, BASE_HEX, VALS(a11_ext_nvose_srvopt), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_vse_panid,\r\n{ "PANID", "a11.ext.panid",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_vse_canid,\r\n{ "CANID", "a11.ext.canid",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_vse_qosmode,\r\n{ "QoS Mode", "a11.ext.qosmode",\r\nFT_UINT8, BASE_HEX, VALS(a11_ext_nvose_qosmode), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_ase_len_type,\r\n{ "Entry Length", "a11.ext.ase.len",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_ase_srid_type,\r\n{ "Service Reference ID (SRID)", "a11.ext.ase.srid",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_ase_servopt_type,\r\n{ "Service Option", "a11.ext.ase.srvopt",\r\nFT_UINT16, BASE_HEX, VALS(a11_ext_nvose_srvopt), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_ase_gre_proto_type,\r\n{ "GRE Protocol Type", "a11.ext.ase.ptype",\r\nFT_UINT16, BASE_HEX, VALS(a11_ses_ptype_vals), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_ase_gre_key,\r\n{ "GRE Key", "a11.ext.ase.key",\r\nFT_UINT32, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_ase_pcf_addr_key,\r\n{ "PCF IP Address", "a11.ext.ase.pcfip",\r\nFT_IPv4, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_fqi_srid,\r\n{ "SRID", "a11.ext.fqi.srid",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"Forward Flow Entry SRID", HFILL }\r\n},\r\n{ &hf_a11_fqi_flags,\r\n{ "Flags", "a11.ext.fqi.flags",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\n"Forward Flow Entry Flags", HFILL }\r\n},\r\n{ &hf_a11_fqi_flags_ip_flow,\r\n{ "IP Flow Discriminator", "a11.ext.fqi.flags.ip_flow",\r\nFT_BOOLEAN, 8, TFS(&tfs_enabled_disabled), A11_FQI_IPFLOW_DISC_ENABLED,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_fqi_flags_dscp,\r\n{ "DSCP", "a11.ext.fqi.flags.dscp",\r\nFT_BOOLEAN, 8, TFS(&tfs_included_not_included), A11_FQI_DSCP_INCLUDED,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_fqi_entry_flag,\r\n{ "DSCP and Flow State", "a11.ext.fqi.entry_flag",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_fqi_entry_flag_dscp,\r\n{ "DSCP", "a11.ext.fqi.entry_flag.dscp",\r\nFT_UINT8, BASE_HEX, NULL, 0x7E,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_fqi_entry_flag_flow_state,\r\n{ "Flow State", "a11.ext.fqi.entry_flag.flow_state",\r\nFT_BOOLEAN, 8, TFS(&tfs_active_inactive), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_fqi_flowcount,\r\n{ "Forward Flow Count", "a11.ext.fqi.flowcount",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_fqi_flowid,\r\n{ "Forward Flow Id", "a11.ext.fqi.flowid",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_fqi_entrylen,\r\n{ "Entry Length", "a11.ext.fqi.entrylen",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"Forward Entry Length", HFILL }\r\n},\r\n#if 0\r\n{ &hf_a11_fqi_flowstate,\r\n{ "Forward Flow State", "a11.ext.fqi.flowstate",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_a11_fqi_requested_qoslen,\r\n{ "Requested QoS Length", "a11.ext.fqi.reqqoslen",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"Forward Requested QoS Length", HFILL }\r\n},\r\n{ &hf_a11_fqi_flow_priority,\r\n{ "Flow Priority", "a11.ext.fqi.flow_priority",\r\nFT_UINT8, BASE_DEC, NULL, 0xF0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_fqi_num_qos_attribute_set,\r\n{ "Number of QoS Attribute Sets", "a11.ext.fqi.num_qos_attribute_set",\r\nFT_UINT8, BASE_DEC, NULL, 0x0E,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_fqi_qos_attribute_setlen,\r\n{ "QoS Attribute Set Length", "a11.ext.fqi.qos_attribute_setlen",\r\nFT_UINT16, BASE_DEC, NULL, 0x01E0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_fqi_qos_attribute_setid,\r\n{ "QoS Attribute SetID", "a11.ext.fqi.qos_attribute_setid",\r\nFT_UINT16, BASE_DEC, NULL, 0x1FC0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_fqi_verbose,\r\n{ "Verbose", "a11.ext.fqi.verbose",\r\nFT_UINT8, BASE_DEC, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_fqi_flow_profileid,\r\n{ "Flow Profile Id", "a11.ext.fqi.flow_profileid",\r\nFT_UINT24, BASE_DEC, NULL, 0x1FFFE0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_fqi_qos_granted_attribute_setid,\r\n{ "QoS Attribute SetID", "a11.ext.fqi.qos_granted_attribute_setid",\r\nFT_UINT8, BASE_DEC, NULL, 0xFE,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_fqi_granted_qoslen,\r\n{ "Granted QoS Length", "a11.ext.fqi.graqoslen",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"Forward Granted QoS Length", HFILL }\r\n},\r\n{ &hf_a11_rqi_flow_priority,\r\n{ "Flow Priority", "a11.ext.rqi.flow_priority",\r\nFT_UINT8, BASE_DEC, NULL, 0xF0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_rqi_num_qos_attribute_set,\r\n{ "Number of QoS Attribute Sets", "a11.ext.rqi.num_qos_attribute_set",\r\nFT_UINT8, BASE_DEC, NULL, 0x0E,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_rqi_qos_attribute_setlen,\r\n{ "QoS Attribute Set Length", "a11.ext.rqi.qos_attribute_setlen",\r\nFT_UINT16, BASE_DEC, NULL, 0x01E0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_rqi_qos_attribute_setid,\r\n{ "QoS Attribute SetID", "a11.ext.rqi.qos_attribute_setid",\r\nFT_UINT16, BASE_DEC, NULL, 0x1FC0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_rqi_verbose,\r\n{ "Verbose", "a11.ext.rqi.verbose",\r\nFT_UINT8, BASE_DEC, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_rqi_flow_profileid,\r\n{ "Flow Profile Id", "a11.ext.rqi.flow_profileid",\r\nFT_UINT24, BASE_DEC, NULL, 0x1FFFE0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_rqi_qos_granted_attribute_setid,\r\n{ "QoS Attribute SetID", "a11.ext.rqi.qos_granted_attribute_setid",\r\nFT_UINT8, BASE_DEC, NULL, 0xFE,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_rqi_srid,\r\n{ "SRID", "a11.ext.rqi.srid",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"Reverse Flow Entry SRID", HFILL }\r\n},\r\n{ &hf_a11_rqi_flowcount,\r\n{ "Reverse Flow Count", "a11.ext.rqi.flowcount",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_rqi_flowid,\r\n{ "Reverse Flow Id", "a11.ext.rqi.flowid",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_rqi_entrylen,\r\n{ "Entry Length", "a11.ext.rqi.entrylen",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"Reverse Flow Entry Length", HFILL }\r\n},\r\n{ &hf_a11_rqi_entry_flag,\r\n{ "Flags", "a11.ext.rqi.entry_flag",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_rqi_entry_flag_flow_state,\r\n{ "Flow State", "a11.ext.rqi.entry_flag.flow_state",\r\nFT_BOOLEAN, 8, TFS(&tfs_active_inactive), 0x01,\r\nNULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_a11_rqi_flowstate,\r\n{ "Flow State", "a11.ext.rqi.flowstate",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\n"Reverse Flow State", HFILL }\r\n},\r\n#endif\r\n{ &hf_a11_rqi_requested_qoslen,\r\n{ "Requested QoS Length", "a11.ext.rqi.reqqoslen",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"Reverse Requested QoS Length", HFILL }\r\n},\r\n#if 0\r\n{ &hf_a11_rqi_requested_qos,\r\n{ "Requested QoS", "a11.ext.rqi.reqqos",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"Reverse Requested QoS", HFILL }\r\n},\r\n#endif\r\n{ &hf_a11_rqi_granted_qoslen,\r\n{ "Granted QoS Length", "a11.ext.rqi.graqoslen",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"Reverse Granted QoS Length", HFILL }\r\n},\r\n#if 0\r\n{ &hf_a11_rqi_granted_qos,\r\n{ "Granted QoS", "a11.ext.rqi.graqos",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"Reverse Granted QoS", HFILL }\r\n},\r\n#endif\r\n{ &hf_a11_fqui_flowcount,\r\n{ "Forward QoS Update Flow Count", "a11.ext.fqui.flowcount",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_rqui_flowcount,\r\n{ "Reverse QoS Update Flow Count", "a11.ext.rqui.flowcount",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_fqui_updated_qoslen,\r\n{ "Forward Updated QoS Sub-Blob Length", "a11.ext.fqui.updatedqoslen",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_fqui_updated_qos,\r\n{ "Forward Updated QoS Sub-Blob", "a11.ext.fqui.updatedqos",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_rqui_updated_qoslen,\r\n{ "Reverse Updated QoS Sub-Blob Length", "a11.ext.rqui.updatedqoslen",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_rqui_updated_qos,\r\n{ "Reverse Updated QoS Sub-Blob", "a11.ext.rqui.updatedqos",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_a11_subsciber_profile_len,\r\n{ "Subscriber QoS Profile Length", "a11.ext.sqp.profilelen",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_a11_subsciber_profile,\r\n{ "Subscriber QoS Profile", "a11.ext.sqp.profile",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_ase_forward_rohc_info_len,\r\n{ "Forward ROHC Info Length", "a11.ext.ase.forwardlen",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_ase_forward_maxcid,\r\n{ "Forward MAXCID", "a11.ext.ase.maxcid",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_ase_forward_mrru,\r\n{ "Forward MRRU", "a11.ext.ase.mrru",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_ase_forward_large_cids,\r\n{ "Forward Large CIDS", "a11.ext.ase.forwardlargecids",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_ase_forward_profile_count,\r\n{ "Forward Profile Count", "a11.ext.ase.profilecount",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_ase_forward_profile,\r\n{ "Forward Profile", "a11.ext.ase.forwardprofile",\r\nFT_UINT16, BASE_DEC | BASE_EXT_STRING, &a11_rohc_profile_vals_ext, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_ase_reverse_rohc_info_len,\r\n{ "Reverse ROHC Info Length", "a11.ext.ase.reverselen",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_ase_reverse_maxcid,\r\n{ "Reverse MAXCID", "a11.ext.ase.revmaxcid",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_ase_reverse_mrru,\r\n{ "Reverse MRRU", "a11.ext.ase.revmrru",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_ase_reverse_large_cids,\r\n{ "Reverse Large CIDS", "a11.ext.ase.reverselargecids",\r\nFT_UINT8, BASE_DEC, NULL, 128,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_ase_reverse_profile_count,\r\n{ "Reverse Profile Count", "a11.ext.ase.revprofilecount",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_ase_reverse_profile,\r\n{ "Reverse Profile", "a11.ext.ase.reverseprofile",\r\nFT_UINT16, BASE_DEC | BASE_EXT_STRING, &a11_rohc_profile_vals_ext, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_aut_flow_prof_sub_type,\r\n{ "Sub type", "a11.aut_flow_prof.sub_type",\r\nFT_UINT8, BASE_DEC, VALS(a11_aut_flow_prof_subtype_vals), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_aut_flow_prof_sub_type_len,\r\n{ "Length", "a11.aut_flow_prof.length",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_aut_flow_prof_sub_type_value,\r\n{ "Value", "a11.aut_flow_prof.value",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_serv_opt_prof_max_serv,\r\n{ "Service-Connections-Per-Link-flow", "a11.serv_opt_prof.scplf",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_sub_type,\r\n{ "Sub-Type", "a11.sub_type",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_sub_type_length,\r\n{ "Sub-Type Length", "a11.sub_type_length",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_serv_opt,\r\n{ "Service Option", "a11.serviceoption",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_max_num_serv_opt,\r\n{ "Max number of service instances of Service Option", "a11.serviceoption",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_bcmcs_stype,\r\n{ "Protocol Type", "a11.ext.bcmcs.ptype",\r\nFT_UINT8, BASE_HEX, VALS(a11_bcmcs_stype_vals), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a11_bcmcs_entry_len,\r\n{ "Entry length", "a11.ext.bcmcs.entry_len",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_a11,\r\n&ett_a11_flags,\r\n&ett_a11_ext,\r\n&ett_a11_exts,\r\n&ett_a11_radius,\r\n&ett_a11_radiuses,\r\n&ett_a11_ase,\r\n&ett_a11_fqi_flowentry,\r\n&ett_a11_fqi_requestedqos,\r\n&ett_a11_fqi_qos_attribute_set,\r\n&ett_a11_fqi_grantedqos,\r\n&ett_a11_rqi_flowentry,\r\n&ett_a11_rqi_requestedqos,\r\n&ett_a11_rqi_qos_attribute_set,\r\n&ett_a11_rqi_grantedqos,\r\n&ett_a11_fqi_flags,\r\n&ett_a11_fqi_entry_flags,\r\n&ett_a11_rqi_entry_flags,\r\n&ett_a11_fqui_flowentry,\r\n&ett_a11_rqui_flowentry,\r\n&ett_a11_subscriber_profile,\r\n&ett_a11_forward_rohc,\r\n&ett_a11_reverse_rohc,\r\n&ett_a11_forward_profile,\r\n&ett_a11_reverse_profile,\r\n&ett_a11_aut_flow_profile_ids,\r\n&ett_a11_bcmcs_entry,\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_a11_sub_type_length_not2, { "a11.sub_type_length.bad", PI_PROTOCOL, PI_WARN, "Sub-Type Length should be at least 2", EXPFILL }},\r\n{ &ei_a11_sse_too_short, { "a11.sse_too_short", PI_MALFORMED, PI_ERROR, "SSE too short", EXPFILL }},\r\n{ &ei_a11_bcmcs_too_short, { "a11.bcmcs_too_short", PI_MALFORMED, PI_ERROR, "BCMCS too short", EXPFILL }},\r\n{ &ei_a11_entry_data_not_dissected, { "a11.entry_data_not_dissected", PI_UNDECODED, PI_WARN, "Entry Data, Not dissected yet", EXPFILL }},\r\n{ &ei_a11_session_data_not_dissected, { "a11.session_data_not_dissected", PI_UNDECODED, PI_WARN, "Session Data Type Not dissected yet", EXPFILL }},\r\n};\r\nexpert_module_t* expert_a11;\r\nproto_a11 = proto_register_protocol("3GPP2 A11", "3GPP2 A11", "a11");\r\nregister_dissector("a11", dissect_a11, proto_a11);\r\nproto_register_field_array(proto_a11, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_a11 = expert_register_protocol(proto_a11);\r\nexpert_register_field_array(expert_a11, ei, array_length(ei));\r\n}\r\nvoid\r\nproto_reg_handoff_a11(void)\r\n{\r\ndissector_handle_t a11_handle;\r\na11_handle = find_dissector("a11");\r\ndissector_add_uint("udp.port", UDP_PORT_3GA11, a11_handle);\r\nradius_register_avp_dissector(VENDOR_THE3GPP2, 74, dissect_3gpp2_service_option_profile);\r\nradius_register_avp_dissector(VENDOR_THE3GPP2, 131, dissect_3gpp2_radius_aut_flow_profile_ids);\r\n}
