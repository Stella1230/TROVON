static int\r\ndissect_ucd (tvbuff_t * tvb, packet_info * pinfo, proto_tree * tree, void* data _U_)\r\n{\r\nint pos, endtlvpos;\r\nguint8 type, length;\r\nguint8 tlvlen, tlvtype;\r\nproto_tree *ucd_tree;\r\nproto_item *ucd_item;\r\nproto_tree *tlv_tree;\r\nproto_item *tlv_item;\r\nproto_tree *burst_tree;\r\nproto_item *burst_item;\r\ngint len;\r\nguint8 upchid, symrate;\r\nlen = tvb_reported_length_remaining (tvb, 0);\r\nupchid = tvb_get_guint8 (tvb, 0);\r\nif (upchid > 0)\r\ncol_add_fstr (pinfo->cinfo, COL_INFO,\r\n"Type 2 UCD Message: Channel ID = %u (U%u)", upchid,\r\nupchid - 1);\r\nelse\r\ncol_add_fstr (pinfo->cinfo, COL_INFO,\r\n"Type 2 UCD Message: Channel ID = %u (Telephony Return)",\r\nupchid);\r\nif (tree)\r\n{\r\nucd_item =\r\nproto_tree_add_protocol_format (tree, proto_docsis_ucd, tvb, 0, -1,\r\n"UCD Message (Type 2)");\r\nucd_tree = proto_item_add_subtree (ucd_item, ett_docsis_ucd);\r\nproto_tree_add_item (ucd_tree, hf_docsis_ucd_upstream_chid, tvb, 0, 1,\r\nENC_BIG_ENDIAN);\r\nproto_tree_add_item (ucd_tree, hf_docsis_ucd_config_ch_cnt, tvb, 1, 1,\r\nENC_BIG_ENDIAN);\r\nproto_tree_add_item (ucd_tree, hf_docsis_ucd_mini_slot_size, tvb, 2, 1,\r\nENC_BIG_ENDIAN);\r\nproto_tree_add_item (ucd_tree, hf_docsis_ucd_down_chid, tvb, 3, 1,\r\nENC_BIG_ENDIAN);\r\npos = 4;\r\nwhile (pos < len)\r\n{\r\ntype = tvb_get_guint8 (tvb, pos);\r\ntlv_tree = proto_tree_add_subtree(ucd_tree, tvb, pos, -1,\r\nett_docsis_tlv, &tlv_item,\r\nval_to_str(type, channel_tlv_vals,\r\n"Unknown TLV (%u)"));\r\nproto_tree_add_uint (tlv_tree, hf_docsis_ucd_type,\r\ntvb, pos, 1, type);\r\npos++;\r\nlength = tvb_get_guint8 (tvb, pos);\r\nproto_tree_add_uint (tlv_tree, hf_docsis_ucd_length,\r\ntvb, pos, 1, length);\r\npos++;\r\nproto_item_set_len(tlv_item, length + 2);\r\nswitch (type)\r\n{\r\ncase UCD_SYMBOL_RATE:\r\nif (length == 1)\r\n{\r\nsymrate = tvb_get_guint8 (tvb, pos);\r\nproto_tree_add_uint (tlv_tree, hf_docsis_ucd_symbol_rate,\r\ntvb, pos, length, symrate * 160);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\npos = pos + length;\r\nbreak;\r\ncase UCD_FREQUENCY:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (tlv_tree, hf_docsis_ucd_frequency, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\npos = pos + length;\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\nbreak;\r\ncase UCD_PREAMBLE:\r\nproto_tree_add_item (tlv_tree, hf_docsis_ucd_preamble_pat, tvb,\r\npos, length, ENC_NA);\r\npos = pos + length;\r\nbreak;\r\ncase UCD_EXT_PREAMBLE:\r\nproto_tree_add_item (tlv_tree, hf_docsis_ucd_ext_preamble_pat, tvb,\r\npos, length, ENC_NA);\r\npos = pos + length;\r\nbreak;\r\ncase UCD_SCDMA_MODE_ENABLED:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (tlv_tree, hf_docsis_ucd_scdma_mode_enabled,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\npos = pos + length;\r\nbreak;\r\ncase UCD_MAINTAIN_POWER_SPECTRAL_DENSITY:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (tlv_tree, hf_docsis_ucd_maintain_power_spectral_density,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\npos = pos + length;\r\nbreak;\r\ncase UCD_RANGING_REQUIRED:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (tlv_tree, hf_docsis_ucd_ranging_required,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\npos = pos + length;\r\nbreak;\r\ncase UCD_RANGING_HOLD_OFF_PRIORITY_FIELD:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (tlv_tree, hf_docsis_ucd_rnghoff_cm, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tlv_tree, hf_docsis_ucd_rnghoff_erouter, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tlv_tree, hf_docsis_ucd_rnghoff_emta, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tlv_tree, hf_docsis_ucd_rnghoff_estb, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tlv_tree, hf_docsis_ucd_rnghoff_rsvd, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tlv_tree, hf_docsis_ucd_rnghoff_id_ext, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\npos = pos + length;\r\nbreak;\r\ncase UCD_RANGING_CHANNEL_CLASS_ID:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (tlv_tree, hf_docsis_ucd_chan_class_id_cm, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tlv_tree, hf_docsis_ucd_chan_class_id_erouter, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tlv_tree, hf_docsis_ucd_chan_class_id_emta, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tlv_tree, hf_docsis_ucd_chan_class_id_estb, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tlv_tree, hf_docsis_ucd_chan_class_id_rsvd, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tlv_tree, hf_docsis_ucd_chan_class_id_id_ext, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\npos = pos + length;\r\nbreak;\r\ncase UCD_BURST_DESCR:\r\nproto_tree_add_item (tlv_tree, hf_docsis_ucd_iuc, tvb,\r\npos++, 1, ENC_BIG_ENDIAN);\r\nendtlvpos = pos + length - 1;\r\nwhile (pos < endtlvpos)\r\n{\r\nburst_tree = proto_tree_add_subtree (tlv_tree, tvb, pos, -1,\r\nett_docsis_burst_tlv, &burst_item,\r\nval_to_str(type, burst_tlv_vals,\r\n"Unknown TLV (%u)"));\r\ntlvtype = tvb_get_guint8 (tvb, pos);\r\nproto_tree_add_uint (burst_tree, hf_docsis_ucd_burst_type, tvb, pos++, 1, tlvtype);\r\ntlvlen = tvb_get_guint8 (tvb, pos);\r\nproto_tree_add_uint (burst_tree, hf_docsis_ucd_burst_length, tvb, pos++, 1, tlvlen);\r\nproto_item_set_len(burst_item, tlvlen + 2);\r\nswitch (tlvtype)\r\n{\r\ncase UCD_MODULATION:\r\nif (tlvlen == 1)\r\n{\r\nproto_tree_add_item (burst_tree,\r\nhf_docsis_burst_mod_type, tvb,\r\npos, tlvlen, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\nbreak;\r\ncase UCD_DIFF_ENCODING:\r\nif (tlvlen == 1)\r\n{\r\nproto_tree_add_item (burst_tree,\r\nhf_docsis_burst_diff_encoding,\r\ntvb, pos, tlvlen, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\nbreak;\r\ncase UCD_PREAMBLE_LEN:\r\nif (tlvlen == 2)\r\n{\r\nproto_tree_add_item (burst_tree,\r\nhf_docsis_burst_preamble_len,\r\ntvb, pos, tlvlen, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\nbreak;\r\ncase UCD_PREAMBLE_VAL_OFF:\r\nif (tlvlen == 2)\r\n{\r\nproto_tree_add_item (burst_tree,\r\nhf_docsis_burst_preamble_val_off,\r\ntvb, pos, tlvlen, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\nbreak;\r\ncase UCD_FEC:\r\nif (tlvlen == 1)\r\n{\r\nproto_tree_add_item (burst_tree,\r\nhf_docsis_burst_fec, tvb, pos,\r\ntlvlen, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\nbreak;\r\ncase UCD_FEC_CODEWORD:\r\nif (tlvlen == 1)\r\n{\r\nproto_tree_add_item (burst_tree,\r\nhf_docsis_burst_fec_codeword,\r\ntvb, pos, tlvlen, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\nbreak;\r\ncase UCD_SCRAMBLER_SEED:\r\nif (tlvlen == 2)\r\n{\r\nproto_tree_add_item (burst_tree,\r\nhf_docsis_burst_scrambler_seed,\r\ntvb, pos, tlvlen, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\nbreak;\r\ncase UCD_MAX_BURST:\r\nif (tlvlen == 1)\r\n{\r\nproto_tree_add_item (burst_tree,\r\nhf_docsis_burst_max_burst, tvb,\r\npos, tlvlen, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\nbreak;\r\ncase UCD_GUARD_TIME:\r\nif (tlvlen == 1)\r\n{\r\nproto_tree_add_item (burst_tree,\r\nhf_docsis_burst_guard_time,\r\ntvb, pos, tlvlen, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\nbreak;\r\ncase UCD_LAST_CW_LEN:\r\nif (tlvlen == 1)\r\n{\r\nproto_tree_add_item (burst_tree,\r\nhf_docsis_burst_last_cw_len,\r\ntvb, pos, tlvlen, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\nbreak;\r\ncase UCD_SCRAMBLER_ONOFF:\r\nif (tlvlen == 1)\r\n{\r\nproto_tree_add_item (burst_tree,\r\nhf_docsis_burst_scrambler_onoff,\r\ntvb, pos, tlvlen, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\nbreak;\r\n}\r\npos = pos + tlvlen;\r\n}\r\nbreak;\r\ncase UCD_BURST_DESCR5:\r\nproto_tree_add_item (tlv_tree, hf_docsis_ucd_iuc, tvb,\r\npos++, 1, ENC_BIG_ENDIAN);\r\nendtlvpos = pos + length - 1;\r\nwhile (pos < endtlvpos)\r\n{\r\nburst_tree = proto_tree_add_subtree (tlv_tree, tvb, pos, -1,\r\nett_docsis_burst_tlv, &burst_item,\r\nval_to_str(type, burst_tlv_vals,\r\n"Unknown TLV (%u)"));\r\ntlvtype = tvb_get_guint8 (tvb, pos);\r\nproto_tree_add_uint (burst_tree, hf_docsis_ucd_burst_type, tvb, pos++, 1, tlvtype);\r\ntlvlen = tvb_get_guint8 (tvb, pos);\r\nproto_tree_add_uint (burst_tree, hf_docsis_ucd_burst_length, tvb, pos++, 1, tlvlen);\r\nproto_item_set_len(burst_item, tlvlen + 2);\r\nswitch (tlvtype)\r\n{\r\ncase UCD_MODULATION:\r\nif (tlvlen == 1)\r\n{\r\nproto_tree_add_item (burst_tree,\r\nhf_docsis_burst_mod_type, tvb,\r\npos, tlvlen, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\nbreak;\r\ncase UCD_DIFF_ENCODING:\r\nif (tlvlen == 1)\r\n{\r\nproto_tree_add_item (burst_tree,\r\nhf_docsis_burst_diff_encoding,\r\ntvb, pos, tlvlen, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\nbreak;\r\ncase UCD_PREAMBLE_LEN:\r\nif (tlvlen == 2)\r\n{\r\nproto_tree_add_item (burst_tree,\r\nhf_docsis_burst_preamble_len,\r\ntvb, pos, tlvlen, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\nbreak;\r\ncase UCD_PREAMBLE_VAL_OFF:\r\nif (tlvlen == 2)\r\n{\r\nproto_tree_add_item (burst_tree,\r\nhf_docsis_burst_preamble_val_off,\r\ntvb, pos, tlvlen, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\nbreak;\r\ncase UCD_FEC:\r\nif (tlvlen == 1)\r\n{\r\nproto_tree_add_item (burst_tree,\r\nhf_docsis_burst_fec, tvb, pos,\r\ntlvlen, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\nbreak;\r\ncase UCD_FEC_CODEWORD:\r\nif (tlvlen == 1)\r\n{\r\nproto_tree_add_item (burst_tree,\r\nhf_docsis_burst_fec_codeword,\r\ntvb, pos, tlvlen, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\nbreak;\r\ncase UCD_SCRAMBLER_SEED:\r\nif (tlvlen == 2)\r\n{\r\nproto_tree_add_item (burst_tree,\r\nhf_docsis_burst_scrambler_seed,\r\ntvb, pos, tlvlen, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\nbreak;\r\ncase UCD_MAX_BURST:\r\nif (tlvlen == 1)\r\n{\r\nproto_tree_add_item (burst_tree,\r\nhf_docsis_burst_max_burst, tvb,\r\npos, tlvlen, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\nbreak;\r\ncase UCD_GUARD_TIME:\r\nif (tlvlen == 1)\r\n{\r\nproto_tree_add_item (burst_tree,\r\nhf_docsis_burst_guard_time,\r\ntvb, pos, tlvlen, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\nbreak;\r\ncase UCD_LAST_CW_LEN:\r\nif (tlvlen == 1)\r\n{\r\nproto_tree_add_item (burst_tree,\r\nhf_docsis_burst_last_cw_len,\r\ntvb, pos, tlvlen, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\nbreak;\r\ncase UCD_SCRAMBLER_ONOFF:\r\nif (tlvlen == 1)\r\n{\r\nproto_tree_add_item (burst_tree,\r\nhf_docsis_burst_scrambler_onoff,\r\ntvb, pos, tlvlen, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\nbreak;\r\ncase UCD_RS_INT_DEPTH:\r\nif (tlvlen == 1)\r\n{\r\nproto_tree_add_item (burst_tree,\r\nhf_docsis_rs_int_depth,\r\ntvb, pos, tlvlen, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\nbreak;\r\ncase UCD_RS_INT_BLOCK:\r\nif (tlvlen == 2)\r\n{\r\nproto_tree_add_item (burst_tree,\r\nhf_docsis_rs_int_block,\r\ntvb, pos, tlvlen, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\nbreak;\r\ncase UCD_PREAMBLE_TYPE:\r\nif (tlvlen == 1)\r\n{\r\nproto_tree_add_item (burst_tree,\r\nhf_docsis_preamble_type,\r\ntvb, pos, tlvlen, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nexpert_add_info_format(pinfo, ucd_item, &ei_docsis_ucd_tlvlen_bad, "Wrong TLV length: %u", length);\r\n}\r\nbreak;\r\n}\r\npos = pos + tlvlen;\r\n}\r\nbreak;\r\n}\r\n}\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_docsis_ucd (void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{&hf_docsis_ucd_upstream_chid,\r\n{"Upstream Channel ID", "docsis_ucd.upchid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_ucd_config_ch_cnt,\r\n{"Config Change Count", "docsis_ucd.confcngcnt",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Configuration Change Count", HFILL}\r\n},\r\n{&hf_docsis_ucd_mini_slot_size,\r\n{"Mini Slot Size (6.25us TimeTicks)", "docsis_ucd.mslotsize",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_ucd_down_chid,\r\n{"Downstream Channel ID", "docsis_ucd.downchid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Management Message", HFILL}\r\n},\r\n{&hf_docsis_ucd_type,\r\n{"Type", "docsis_ucd.type",\r\nFT_UINT8, BASE_DEC, VALS(channel_tlv_vals), 0x0,\r\n"Channel TLV type", HFILL}\r\n},\r\n{&hf_docsis_ucd_length,\r\n{"Length", "docsis_ucd.length",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Channel TLV length", HFILL}\r\n},\r\n{&hf_docsis_ucd_burst_type,\r\n{"Type", "docsis_ucd.burst.tlvtype",\r\nFT_UINT8, BASE_DEC, VALS(channel_tlv_vals), 0x0,\r\n"Burst TLV type", HFILL}\r\n},\r\n{&hf_docsis_ucd_burst_length,\r\n{"Length", "docsis_ucd.burst.tlvlen",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Burst TLV length", HFILL}\r\n},\r\n{&hf_docsis_ucd_symbol_rate,\r\n{"Symbol Rate (ksym/sec)", "docsis_ucd.symrate",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Symbol Rate", HFILL}\r\n},\r\n{&hf_docsis_ucd_frequency,\r\n{"Frequency (Hz)", "docsis_ucd.freq",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Upstream Center Frequency", HFILL}\r\n},\r\n{&hf_docsis_ucd_preamble_pat,\r\n{"Preamble Pattern", "docsis_ucd.preamble",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Preamble Superstring", HFILL}\r\n},\r\n{&hf_docsis_ucd_ext_preamble_pat,\r\n{"Extended Preamble Pattern", "docsis_ucd.extpreamble",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Extended Preamble Superstring", HFILL}\r\n},\r\n{&hf_docsis_ucd_scdma_mode_enabled,\r\n{"S-CDMA Mode Enabled", "docsis_ucd.scdma",\r\nFT_UINT8, BASE_DEC, VALS (on_off_vals), 0x0,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_ucd_maintain_power_spectral_density,\r\n{"Maintain Power Spectral Density", "docsis_ucd.maintpower",\r\nFT_UINT8, BASE_DEC, VALS (on_off_vals), 0x0,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_ucd_ranging_required,\r\n{"Ranging Required", "docsis_ucd.rangingreq",\r\nFT_UINT8, BASE_DEC, VALS (ranging_req_vals), 0x0,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_ucd_rnghoff_cm,\r\n{"Ranging Hold-Off (CM)","docsis_ucd.rnghoffcm",\r\nFT_UINT32, BASE_DEC, VALS (allow_inhibit_vals), 0x1,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_ucd_rnghoff_erouter,\r\n{"Ranging Hold-Off (eRouter)",\r\n"docsis_ucd.rnghofferouter",\r\nFT_UINT32, BASE_DEC, VALS (allow_inhibit_vals), 0x2,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_ucd_rnghoff_emta,\r\n{"Ranging Hold-Off (eMTA or EDVA)",\r\n"docsis_ucd.rnghoffemta",\r\nFT_UINT32, BASE_DEC, VALS (allow_inhibit_vals), 0x4,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_ucd_rnghoff_estb,\r\n{"Ranging Hold-Off (DSG/eSTB)",\r\n"docsis_ucd.rnghoffestb",\r\nFT_UINT32, BASE_DEC, VALS (allow_inhibit_vals), 0x8,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_ucd_rnghoff_rsvd,\r\n{"Reserved [0x000000]",\r\n"docsis_ucd.rnghoffrsvd",\r\nFT_UINT32, BASE_HEX, NULL, 0xFFF0,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_ucd_rnghoff_id_ext,\r\n{"CM Ranging Class ID Extension",\r\n"docsis_ucd.rngidext",\r\nFT_UINT32, BASE_HEX, NULL, 0xFFFF0000,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_ucd_chan_class_id_cm,\r\n{"Channel Class ID (CM)","docsis_ucd.classidcm",\r\nFT_UINT32, BASE_DEC, VALS (inhibit_allow_vals), 0x1,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_ucd_chan_class_id_erouter,\r\n{"Channel Class ID (eRouter)",\r\n"docsis_ucd.classiderouter",\r\nFT_UINT32, BASE_DEC, VALS (inhibit_allow_vals), 0x2,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_ucd_chan_class_id_emta,\r\n{"Channel Class ID (eMTA or EDVA)",\r\n"docsis_ucd.classidemta",\r\nFT_UINT32, BASE_DEC, VALS (inhibit_allow_vals), 0x4,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_ucd_chan_class_id_estb,\r\n{"Channel Class ID (DSG/eSTB)",\r\n"docsis_ucd.classidestb",\r\nFT_UINT32, BASE_DEC, VALS (inhibit_allow_vals), 0x8,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_ucd_chan_class_id_rsvd,\r\n{"Reserved [0x000000]",\r\n"docsis_ucd.classidrsvd",\r\nFT_UINT32, BASE_HEX, NULL, 0xFFF0,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_ucd_chan_class_id_id_ext,\r\n{"CM Ranging Class ID Extension",\r\n"docsis_ucd.classidext",\r\nFT_UINT32, BASE_HEX, NULL, 0xFFFF0000,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_ucd_iuc,\r\n{"Interval Usage Code", "docsis_ucd.iuc",\r\nFT_UINT8, BASE_DEC, VALS (iuc_vals), 0x0,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_burst_mod_type,\r\n{"Modulation Type", "docsis_ucd.burst.modtype",\r\nFT_UINT8, BASE_DEC, VALS (mod_vals), 0x0,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_burst_diff_encoding,\r\n{"Differential Encoding", "docsis_ucd.burst.diffenc",\r\nFT_UINT8, BASE_DEC, VALS (on_off_vals), 0x0,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_burst_preamble_len,\r\n{"Preamble Length (Bits)", "docsis_ucd.burst.preamble_len",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_burst_preamble_val_off,\r\n{"Preamble Offset (Bits)", "docsis_ucd.burst.preamble_off",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_burst_fec,\r\n{"FEC (T)", "docsis_ucd.burst.fec",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"FEC (T) Codeword Parity Bits = 2^T", HFILL}\r\n},\r\n{&hf_docsis_burst_fec_codeword,\r\n{"FEC Codeword Info bytes (k)", "docsis_ucd.burst.fec_codeword",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_burst_scrambler_seed,\r\n{"Scrambler Seed", "docsis_ucd.burst.scrambler_seed",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\n"Burst Descriptor", HFILL}\r\n},\r\n{&hf_docsis_burst_max_burst,\r\n{"Max Burst Size (Minislots)", "docsis_ucd.burst.maxburst",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_burst_guard_time,\r\n{"Guard Time Size (Symbol Times)", "docsis_ucd.burst.guardtime",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Guard Time Size", HFILL}\r\n},\r\n{&hf_docsis_burst_last_cw_len,\r\n{"Last Codeword Length", "docsis_ucd.burst.last_cw_len",\r\nFT_UINT8, BASE_DEC, VALS (last_cw_len_vals), 0x0,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_burst_scrambler_onoff,\r\n{"Scrambler On/Off", "docsis_ucd.burst.scrambleronoff",\r\nFT_UINT8, BASE_DEC, VALS (on_off_vals), 0x0,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_rs_int_depth,\r\n{"RS Interleaver Depth", "docsis_ucd.burst.rsintdepth",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"R-S Interleaver Depth", HFILL}\r\n},\r\n{&hf_docsis_rs_int_block,\r\n{"RS Interleaver Block Size", "docsis_ucd.burst.rsintblock",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"R-S Interleaver Block", HFILL}\r\n},\r\n{&hf_docsis_preamble_type,\r\n{"Preamble Type", "docsis_ucd.burst.preambletype",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n};\r\nstatic ei_register_info ei[] = {\r\n{&ei_docsis_ucd_tlvlen_bad, {"docsis_ucd.tlvlenbad", PI_MALFORMED, PI_ERROR, "Bad TLV length", EXPFILL}},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_docsis_ucd,\r\n&ett_docsis_tlv,\r\n&ett_docsis_burst_tlv,\r\n};\r\nexpert_module_t* expert_docsis_ucd;\r\nproto_docsis_ucd =\r\nproto_register_protocol ("DOCSIS Upstream Channel Descriptor",\r\n"DOCSIS UCD", "docsis_ucd");\r\nproto_register_field_array (proto_docsis_ucd, hf, array_length (hf));\r\nproto_register_subtree_array (ett, array_length (ett));\r\nexpert_docsis_ucd = expert_register_protocol(proto_docsis_ucd);\r\nexpert_register_field_array(expert_docsis_ucd, ei, array_length(ei));\r\nregister_dissector ("docsis_ucd", dissect_ucd, proto_docsis_ucd);\r\n}\r\nvoid\r\nproto_reg_handoff_docsis_ucd (void)\r\n{\r\ndissector_handle_t docsis_ucd_handle;\r\ndocsis_ucd_handle = find_dissector ("docsis_ucd");\r\ndissector_add_uint ("docsis_mgmt", 0x02, docsis_ucd_handle);\r\n}
