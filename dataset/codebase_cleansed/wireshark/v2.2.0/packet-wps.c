static void\r\nadd_wps_wfa_ext(guint8 id, proto_tree *tree, tvbuff_t *tvb,\r\nint offset, gint size)\r\n{\r\nproto_item *item;\r\nproto_tree *elem;\r\nguint8 val8;\r\nelem = proto_tree_add_subtree(tree, tvb, offset - 2, 2 + size, ett_wps_wfa_ext, &item,\r\nval_to_str(id, eapwps_wfa_ext_types, "Unknown (%u)"));\r\nproto_tree_add_item(elem, hf_eapwps_wfa_ext_id, tvb, offset - 2, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(elem, hf_eapwps_wfa_ext_len, tvb, offset - 1, 1, ENC_BIG_ENDIAN);\r\nswitch (id) {\r\ncase WPS_WFA_EXT_VERSION2:\r\nval8 = tvb_get_guint8(tvb, offset);\r\nproto_item_append_text(item, ": %d.%d", val8 >> 4, val8 & 0x0f);\r\nproto_tree_add_item(elem, hf_eapwps_wfa_ext_version2, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase WPS_WFA_EXT_AUTHORIZEDMACS:\r\nproto_tree_add_item(elem, hf_eapwps_wfa_ext_authorizedmacs,\r\ntvb, offset, size, ENC_NA);\r\nbreak;\r\ncase WPS_WFA_EXT_NETWORK_KEY_SHAREABLE:\r\nval8 = tvb_get_guint8(tvb, offset);\r\nproto_item_append_text(item, ": %s", val8 ? "TRUE" : "FALSE");\r\nproto_tree_add_item(elem, hf_eapwps_wfa_ext_network_key_shareable,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase WPS_WFA_EXT_REQUEST_TO_ENROLL:\r\nval8 = tvb_get_guint8(tvb, offset);\r\nproto_item_append_text(item, ": %s", val8 ? "TRUE" : "FALSE");\r\nproto_tree_add_item(elem, hf_eapwps_wfa_ext_request_to_enroll,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase WPS_WFA_EXT_SETTINGS_DELAY_TIME:\r\nval8 = tvb_get_guint8(tvb, offset);\r\nproto_item_append_text(item, ": %d second(s)", val8);\r\nproto_tree_add_item(elem, hf_eapwps_wfa_ext_settings_delay_time,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\nstatic void\r\ndissect_wps_wfa_ext(proto_tree *tree, tvbuff_t *tvb,\r\nint offset, gint size)\r\n{\r\nint pos = offset;\r\nint end = offset + size;\r\nguint8 id, len;\r\nwhile (pos + 2 < end) {\r\nid = tvb_get_guint8(tvb, pos);\r\nlen = tvb_get_guint8(tvb, pos + 1);\r\nif ((pos + 2 + len) > end)\r\nbreak;\r\npos += 2;\r\nadd_wps_wfa_ext(id, tree, tvb, pos, len);\r\npos += len;\r\n}\r\n}\r\nstatic void\r\ndissect_wps_vendor_ext(proto_tree *tree, tvbuff_t *tvb,\r\nint offset, gint size)\r\n{\r\nguint32 vendor_id;\r\nif (size < 3)\r\nreturn;\r\nvendor_id = tvb_get_ntoh24(tvb, offset);\r\nproto_tree_add_item(tree, hf_eapwps_vendor_id, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nif (vendor_id == VENDOR_WIFI_ALLIANCE)\r\ndissect_wps_wfa_ext(tree, tvb, offset + 3, size - 3);\r\n}\r\nvoid\r\ndissect_wps_tlvs(proto_tree *eap_tree, tvbuff_t *tvb, int offset,\r\ngint size, packet_info *pinfo)\r\n{\r\nstatic const char *fmt_warn_too_long = "Value too long (max. %d)";\r\nstatic const char *fmt_length_warn = "Value length not %d";\r\nguint tlv_len;\r\nguint16 tlv_type;\r\nproto_item *tlv_item = NULL;\r\nproto_tree *tlv_root = NULL;\r\nproto_item *tmp_item = NULL;\r\nint hfindex = -1;\r\nwhile(size > 0) {\r\nif (size < 4) {\r\nif ((tmp_item != NULL) && pinfo)\r\nexpert_add_info(pinfo, tmp_item, &ei_eapwps_packet_too_short);\r\nbreak;\r\n}\r\ntmp_item = NULL;\r\ntlv_type = tvb_get_ntohs(tvb, offset);\r\ntlv_len = tvb_get_ntohs(tvb, offset+2);\r\ntlv_root = proto_tree_add_subtree_format(eap_tree, tvb, offset, tlv_len+4,\r\nett_wps_tlv, &tlv_item, "Unknown Type (0x%04x)", tlv_type);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_type, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_len, tvb, offset+2, 2, ENC_BIG_ENDIAN);\r\nswitch(tlv_type) {\r\ncase WPS_TLV_TYPE_AP_CHANNEL:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_ap_channel, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_ap_channel;\r\nbreak;\r\ncase WPS_TLV_TYPE_ASSOCIATION_STATE:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_association_state, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_association_state;\r\nbreak;\r\ncase WPS_TLV_TYPE_AUTHENTICATION_TYPE:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_authentication_type, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_authentication_type;\r\nbreak;\r\ncase WPS_TLV_TYPE_AUTHENTICATION_TYPE_FLAGS:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_authentication_type_flags, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_authentication_type_flags;\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_authentication_type_flags_open, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_authentication_type_flags_wpapsk, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_authentication_type_flags_shared, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_authentication_type_flags_wpa, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_authentication_type_flags_wpa2, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_authentication_type_flags_wpa2psk, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase WPS_TLV_TYPE_AUTHENTICATOR:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_authenticator, tvb, offset+4, 8, ENC_NA);\r\nhfindex = hf_eapwps_tlv_authenticator;\r\nproto_item_append_text(tmp_item, " (1st 64 bits of HMAC)");\r\nbreak;\r\ncase WPS_TLV_TYPE_CONFIG_METHODS:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_config_methods, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_config_methods;\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_config_methods_usba, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_config_methods_ethernet, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_config_methods_label, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_config_methods_display, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_config_methods_virt_display, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_config_methods_phy_display, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_config_methods_nfcext, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_config_methods_nfcint, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_config_methods_nfcinf, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_config_methods_pushbutton, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_config_methods_virt_pushbutton, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_config_methods_phy_pushbutton, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_config_methods_keypad, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase WPS_TLV_TYPE_CONFIGURATION_ERROR:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_configuration_error, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_configuration_error;\r\nbreak;\r\ncase WPS_TLV_TYPE_CONFIRMATION_URL4:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_confirmation_url4, tvb, offset+4, tlv_len, ENC_ASCII|ENC_NA);\r\nhfindex = hf_eapwps_tlv_confirmation_url4;\r\nif (tlv_len > 64)\r\nexpert_add_info_format(pinfo, tmp_item, &ei_eapwps_fmt_warn_too_long, fmt_warn_too_long, tlv_len);\r\nbreak;\r\ncase WPS_TLV_TYPE_CONFIRMATION_URL6:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_confirmation_url6, tvb, offset+4, tlv_len, ENC_ASCII|ENC_NA);\r\nhfindex = hf_eapwps_tlv_confirmation_url6;\r\nif (tlv_len > 76)\r\nexpert_add_info_format(pinfo, tmp_item, &ei_eapwps_fmt_warn_too_long, fmt_warn_too_long, tlv_len);\r\nbreak;\r\ncase WPS_TLV_TYPE_CONNECTION_TYPE:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_connection_type, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_connection_type;\r\nbreak;\r\ncase WPS_TLV_TYPE_CONNECTION_TYPE_FLAGS:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_connection_type_flags, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_connection_type_flags;\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_connection_type_flags_ess, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_connection_type_flags_ibss, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase WPS_TLV_TYPE_CREDENTIAL:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_credential, tvb, offset+4, tlv_len, ENC_NA);\r\nhfindex = hf_eapwps_tlv_credential;\r\nbreak;\r\ncase WPS_TLV_TYPE_DEVICE_NAME:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_device_name, tvb, offset+4, tlv_len, ENC_ASCII|ENC_NA);\r\nhfindex = hf_eapwps_tlv_device_name;\r\nif ((tlv_len > 32) && pinfo)\r\nexpert_add_info_format(pinfo, tmp_item, &ei_eapwps_fmt_warn_too_long, fmt_warn_too_long, tlv_len);\r\nbreak;\r\ncase WPS_TLV_TYPE_DEVICE_PASSWORD_ID:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_device_password_id, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_device_password_id;\r\nbreak;\r\ncase WPS_TLV_TYPE_E_HASH1:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_e_hash1, tvb, offset+4, 32, ENC_NA);\r\nhfindex = hf_eapwps_tlv_e_hash1;\r\nif ((tlv_len != 32) && pinfo)\r\nexpert_add_info_format(pinfo, tmp_item, &ei_eapwps_fmt_length_warn, fmt_length_warn, 32);\r\nbreak;\r\ncase WPS_TLV_TYPE_E_HASH2:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_e_hash2, tvb, offset+4, 32, ENC_NA);\r\nhfindex = hf_eapwps_tlv_e_hash2;\r\nif ((tlv_len != 32) && pinfo)\r\nexpert_add_info_format(pinfo, tmp_item, &ei_eapwps_fmt_length_warn, fmt_length_warn, 32);\r\nbreak;\r\ncase WPS_TLV_TYPE_E_SNONCE1:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_e_snonce1, tvb, offset+4, 16, ENC_NA);\r\nhfindex = hf_eapwps_tlv_e_snonce1;\r\nif ((tlv_len != 16) && pinfo)\r\nexpert_add_info_format(pinfo, tmp_item, &ei_eapwps_fmt_length_warn, fmt_length_warn, 16);\r\nbreak;\r\ncase WPS_TLV_TYPE_E_SNONCE2:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_e_snonce2, tvb, offset+4, 16, ENC_NA);\r\nhfindex = hf_eapwps_tlv_e_snonce2;\r\nif ((tlv_len != 16) && pinfo)\r\nexpert_add_info_format(pinfo, tmp_item, &ei_eapwps_fmt_length_warn, fmt_length_warn, 16);\r\nbreak;\r\ncase WPS_TLV_TYPE_ENCRYPTED_SETTINGS:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_encrypted_settings, tvb, offset+4, tlv_len, ENC_NA);\r\nhfindex = hf_eapwps_tlv_encrypted_settings;\r\nbreak;\r\ncase WPS_TLV_TYPE_ENCRYPTION_TYPE:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_encryption_type, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_encryption_type;\r\nbreak;\r\ncase WPS_TLV_TYPE_ENCRYPTION_TYPE_FLAGS:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_encryption_type_flags, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_encryption_type_flags;\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_encryption_type_flags_none, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_encryption_type_flags_wep, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_encryption_type_flags_tkip, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_encryption_type_flags_aes, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase WPS_TLV_TYPE_ENROLLEE_NONCE:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_enrollee_nonce, tvb, offset+4, 16, ENC_NA);\r\nhfindex = hf_eapwps_tlv_enrollee_nonce;\r\nif ((tlv_len != 16) && pinfo)\r\nexpert_add_info_format(pinfo, tmp_item, &ei_eapwps_fmt_length_warn, fmt_length_warn, 16);\r\nbreak;\r\ncase WPS_TLV_TYPE_FEATURE_ID:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_feature_id, tvb, offset+4, 4, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_feature_id;\r\nbreak;\r\ncase WPS_TLV_TYPE_IDENTITY:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_identity, tvb, offset+4, tlv_len, ENC_ASCII|ENC_NA);\r\nhfindex = hf_eapwps_tlv_identity;\r\nif ((tlv_len > 80) && pinfo)\r\nexpert_add_info_format(pinfo, tmp_item, &ei_eapwps_fmt_warn_too_long, fmt_warn_too_long, tlv_len);\r\nbreak;\r\ncase WPS_TLV_TYPE_IDENTITY_PROOF:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_identity_proof, tvb, offset+4, tlv_len, ENC_NA);\r\nhfindex = hf_eapwps_tlv_identity_proof;\r\nbreak;\r\ncase WPS_TLV_TYPE_KEY_WRAP_AUTHENTICATOR:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_key_wrap_authenticator, tvb, offset+4, 8, ENC_NA);\r\nhfindex = hf_eapwps_tlv_key_wrap_authenticator;\r\nbreak;\r\ncase WPS_TLV_TYPE_KEY_IDENTIFIER:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_key_identifier, tvb, offset+4, 16, ENC_NA);\r\nhfindex = hf_eapwps_tlv_key_identifier;\r\nbreak;\r\ncase WPS_TLV_TYPE_MAC_ADDRESS:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_mac_address, tvb, offset+4, 6, ENC_NA);\r\nhfindex = hf_eapwps_tlv_mac_address;\r\nbreak;\r\ncase WPS_TLV_TYPE_MANUFACTURER:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_manufacturer, tvb, offset+4, tlv_len, ENC_ASCII|ENC_NA);\r\nhfindex = hf_eapwps_tlv_manufacturer;\r\nif ((tlv_len > 64) && pinfo)\r\nexpert_add_info_format(pinfo, tmp_item, &ei_eapwps_fmt_warn_too_long, fmt_warn_too_long, tlv_len);\r\nbreak;\r\ncase WPS_TLV_TYPE_MESSAGE_TYPE:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_message_type, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_message_type;\r\nif ((pinfo != NULL))\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ", %s", val_to_str(tvb_get_guint8(tvb, offset+4),\r\neapwps_tlv_message_type_vals,\r\n"Unknown (0x%02x)"));\r\nbreak;\r\ncase WPS_TLV_TYPE_MODEL_NAME:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_model_name, tvb, offset+4, tlv_len, ENC_ASCII|ENC_NA);\r\nhfindex = hf_eapwps_tlv_model_name;\r\nif ((tlv_len > 32) && pinfo)\r\nexpert_add_info_format(pinfo, tmp_item, &ei_eapwps_fmt_warn_too_long, fmt_warn_too_long, tlv_len);\r\nbreak;\r\ncase WPS_TLV_TYPE_MODEL_NUMBER:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_model_number, tvb, offset+4, tlv_len, ENC_ASCII|ENC_NA);\r\nhfindex = hf_eapwps_tlv_model_number;\r\nif ((tlv_len > 32) && pinfo)\r\nexpert_add_info_format(pinfo, tmp_item, &ei_eapwps_fmt_warn_too_long, fmt_warn_too_long, tlv_len);\r\nbreak;\r\ncase WPS_TLV_TYPE_NETWORK_INDEX:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_network_index, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_network_index;\r\nbreak;\r\ncase WPS_TLV_TYPE_NETWORK_KEY:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_network_key, tvb, offset+4, tlv_len, ENC_NA);\r\nhfindex = hf_eapwps_tlv_network_key;\r\nif ((tlv_len > 64) && pinfo)\r\nexpert_add_info_format(pinfo, tmp_item, &ei_eapwps_fmt_warn_too_long, fmt_warn_too_long, tlv_len);\r\nbreak;\r\ncase WPS_TLV_TYPE_NETWORK_KEY_INDEX:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_network_key_index, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_network_key_index;\r\nbreak;\r\ncase WPS_TLV_TYPE_NEW_DEVICE_NAME:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_new_device_name, tvb, offset+4, tlv_len, ENC_NA);\r\nhfindex = hf_eapwps_tlv_new_device_name;\r\nif ((tlv_len > 32) && pinfo)\r\nexpert_add_info_format(pinfo, tmp_item, &ei_eapwps_fmt_warn_too_long, fmt_warn_too_long, tlv_len);\r\nbreak;\r\ncase WPS_TLV_TYPE_NEW_PASSWORD:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_new_password, tvb, offset+4, tlv_len, ENC_NA);\r\nhfindex = hf_eapwps_tlv_new_password;\r\nif ((tlv_len > 64) && pinfo)\r\nexpert_add_info_format(pinfo, tmp_item, &ei_eapwps_fmt_warn_too_long, fmt_warn_too_long, tlv_len);\r\nbreak;\r\ncase WPS_TLV_TYPE_OOB_DEVICE_PASSWORD:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_oob_device_password, tvb, offset+4, tlv_len, ENC_NA);\r\nhfindex = hf_eapwps_tlv_oob_device_password;\r\nif ((tlv_len > 56) && pinfo)\r\nexpert_add_info_format(pinfo, tmp_item, &ei_eapwps_fmt_warn_too_long, fmt_warn_too_long, tlv_len);\r\nbreak;\r\ncase WPS_TLV_TYPE_OS_VERSION:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_os_version, tvb, offset+4, 4, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_os_version;\r\nbreak;\r\ncase WPS_TLV_TYPE_POWER_LEVEL:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_power_level, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_power_level;\r\nbreak;\r\ncase WPS_TLV_TYPE_PSK_CURRENT:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_psk_current, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_psk_current;\r\nbreak;\r\ncase WPS_TLV_TYPE_PSK_MAX:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_psk_max, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_psk_max;\r\nbreak;\r\ncase WPS_TLV_TYPE_PUBLIC_KEY:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_public_key, tvb, offset+4, 192, ENC_NA);\r\nhfindex = hf_eapwps_tlv_public_key;\r\nif ((tlv_len != 192) && pinfo)\r\nexpert_add_info_format(pinfo, tmp_item, &ei_eapwps_fmt_length_warn, fmt_length_warn, 192);\r\nbreak;\r\ncase WPS_TLV_TYPE_RADIO_ENABLED:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_radio_enabled, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_radio_enabled;\r\nbreak;\r\ncase WPS_TLV_TYPE_REBOOT:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_reboot, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_reboot;\r\nbreak;\r\ncase WPS_TLV_TYPE_REGISTRAR_CURRENT:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_registrar_current, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_registrar_current;\r\nbreak;\r\ncase WPS_TLV_TYPE_REGISTRAR_ESTABLISHED:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_registrar_established, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_registrar_established;\r\nbreak;\r\ncase WPS_TLV_TYPE_REGISTRAR_LIST:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_registrar_list, tvb, offset+4, tlv_len, ENC_NA);\r\nhfindex = hf_eapwps_tlv_registrar_list;\r\nbreak;\r\ncase WPS_TLV_TYPE_REGISTRAR_MAX:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_registrar_max, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_registrar_max;\r\nbreak;\r\ncase WPS_TLV_TYPE_REGISTRAR_NONCE:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_registrar_nonce, tvb, offset+4, 16, ENC_NA);\r\nhfindex = hf_eapwps_tlv_registrar_nonce;\r\nbreak;\r\ncase WPS_TLV_TYPE_REQUEST_TYPE:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_request_type, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_request_type;\r\nbreak;\r\ncase WPS_TLV_TYPE_RESPONSE_TYPE:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_response_type, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_response_type;\r\nbreak;\r\ncase WPS_TLV_TYPE_RF_BANDS:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_rf_bands, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_rf_bands;\r\nbreak;\r\ncase WPS_TLV_TYPE_R_HASH1:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_r_hash1, tvb, offset+4, 32, ENC_NA);\r\nhfindex = hf_eapwps_tlv_r_hash1;\r\nbreak;\r\ncase WPS_TLV_TYPE_R_HASH2:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_r_hash2, tvb, offset+4, 32, ENC_NA);\r\nhfindex = hf_eapwps_tlv_r_hash2;\r\nbreak;\r\ncase WPS_TLV_TYPE_R_SNONCE1:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_r_snonce1, tvb, offset+4, 16, ENC_NA);\r\nhfindex = hf_eapwps_tlv_r_snonce1;\r\nbreak;\r\ncase WPS_TLV_TYPE_R_SNONCE2:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_r_snonce2, tvb, offset+4, 16, ENC_NA);\r\nhfindex = hf_eapwps_tlv_r_snonce2;\r\nbreak;\r\ncase WPS_TLV_TYPE_SELECTED_REGISTRAR:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_selected_registrar, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_selected_registrar;\r\nbreak;\r\ncase WPS_TLV_TYPE_SERIAL_NUMBER:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_serial_number, tvb, offset+4, tlv_len, ENC_ASCII|ENC_NA);\r\nhfindex = hf_eapwps_tlv_serial_number;\r\nif ((tlv_len > 32) && pinfo)\r\nexpert_add_info_format(pinfo, tmp_item, &ei_eapwps_fmt_warn_too_long, fmt_warn_too_long, tlv_len);\r\nbreak;\r\ncase WPS_TLV_TYPE_WIFI_PROTECTED_SETUP_STATE:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_wifi_protected_setup_state, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_wifi_protected_setup_state;\r\nbreak;\r\ncase WPS_TLV_TYPE_SSID:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_ssid, tvb, offset+4, tlv_len, ENC_ASCII|ENC_NA);\r\nhfindex = hf_eapwps_tlv_ssid;\r\nif ((tlv_len > 32) && pinfo)\r\nexpert_add_info_format(pinfo, tmp_item, &ei_eapwps_fmt_warn_too_long, fmt_warn_too_long, tlv_len);\r\nbreak;\r\ncase WPS_TLV_TYPE_TOTAL_NETWORKS:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_total_networks, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_total_networks;\r\nbreak;\r\ncase WPS_TLV_TYPE_UUID_E:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_uuid_e, tvb, offset+4, tlv_len, ENC_NA);\r\nhfindex = hf_eapwps_tlv_uuid_e;\r\nif ((tlv_len > 16) && pinfo)\r\nexpert_add_info_format(pinfo, tmp_item, &ei_eapwps_fmt_warn_too_long, fmt_warn_too_long, tlv_len);\r\nbreak;\r\ncase WPS_TLV_TYPE_UUID_R:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_uuid_r, tvb, offset+4, tlv_len, ENC_NA);\r\nhfindex = hf_eapwps_tlv_uuid_r;\r\nif ((tlv_len > 16) && pinfo)\r\nexpert_add_info_format(pinfo, tmp_item, &ei_eapwps_fmt_warn_too_long, fmt_warn_too_long, tlv_len);\r\nbreak;\r\ncase WPS_TLV_TYPE_VENDOR_EXTENSION:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_vendor_extension, tvb, offset+4, tlv_len, ENC_NA);\r\nhfindex = hf_eapwps_tlv_vendor_extension;\r\nbreak;\r\ncase WPS_TLV_TYPE_VERSION:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_version, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_version;\r\nbreak;\r\ncase WPS_TLV_TYPE_X509_CERTIFICATE_REQUEST:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_x509_certificate_request, tvb, offset+4, tlv_len, ENC_NA);\r\nhfindex = hf_eapwps_tlv_x509_certificate_request;\r\nbreak;\r\ncase WPS_TLV_TYPE_X509_CERTIFICATE:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_x509_certificate, tvb, offset+4, tlv_len, ENC_NA);\r\nhfindex = hf_eapwps_tlv_x509_certificate;\r\nbreak;\r\ncase WPS_TLV_TYPE_EAP_IDENTITY:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_eap_identity, tvb, offset+4, tlv_len, ENC_NA);\r\nhfindex = hf_eapwps_tlv_eap_identity;\r\nif ((tlv_len > 64) && pinfo)\r\nexpert_add_info_format(pinfo, tmp_item, &ei_eapwps_fmt_warn_too_long, fmt_warn_too_long, tlv_len);\r\nbreak;\r\ncase WPS_TLV_TYPE_MESSAGE_COUNTER:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_message_counter, tvb, offset+4, 8, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_message_counter;\r\nbreak;\r\ncase WPS_TLV_TYPE_PUBLIC_KEY_HASH:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_public_key_hash, tvb, offset+4, 20, ENC_NA);\r\nhfindex = hf_eapwps_tlv_public_key_hash;\r\nbreak;\r\ncase WPS_TLV_TYPE_REKEY_KEY:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_rekey_key, tvb, offset+4, 32, ENC_NA);\r\nhfindex = hf_eapwps_tlv_rekey_key;\r\nbreak;\r\ncase WPS_TLV_TYPE_KEY_LIFETIME:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_key_lifetime, tvb, offset+4, 4, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_key_lifetime;\r\nbreak;\r\ncase WPS_TLV_TYPE_PERMITTED_CONFIG_METHODS:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_permitted_config_methods, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_permitted_config_methods;\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_permitted_config_methods_usba, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_permitted_config_methods_ethernet, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_permitted_config_methods_label, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_permitted_config_methods_display, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_permitted_config_methods_virt_display, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_permitted_config_methods_phy_display, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_permitted_config_methods_nfcext, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_permitted_config_methods_nfcint, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_permitted_config_methods_nfcinf, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_permitted_config_methods_pushbutton, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_permitted_config_methods_virt_pushbutton, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_permitted_config_methods_phy_pushbutton, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_permitted_config_methods_keypad, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase WPS_TLV_TYPE_SELECTED_REGISTRAR_CONFIG_METHODS:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_selected_registrar_config_methods, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_selected_registrar_config_methods;\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_selected_registrar_config_methods_usba, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_selected_registrar_config_methods_ethernet, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_selected_registrar_config_methods_label, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_selected_registrar_config_methods_display, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_selected_registrar_config_methods_virt_display, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_selected_registrar_config_methods_phy_display, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_selected_registrar_config_methods_nfcext, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_selected_registrar_config_methods_nfcint, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_selected_registrar_config_methods_nfcinf, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_selected_registrar_config_methods_pushbutton, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_selected_registrar_config_methods_virt_pushbutton, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_selected_registrar_config_methods_phy_pushbutton, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_selected_registrar_config_methods_keypad, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase WPS_TLV_TYPE_PRIMARY_DEVICE_TYPE:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_primary_device_type, tvb, offset+4, 8, ENC_NA);\r\nhfindex = hf_eapwps_tlv_primary_device_type;\r\nif (tvb_get_ntohl(tvb, offset+6) == WFA_OUI) {\r\nguint16 dev_cat = tvb_get_ntohs(tvb, offset+4);\r\nif ((dev_cat > 0) && (dev_cat <= WPS_DEVICE_TYPE_CATEGORY_MAX)) {\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_primary_device_type_category, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_eapwps_tlv_primary_device_type_subcategory[dev_cat-1], tvb, offset+10, 2, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nbreak;\r\ncase WPS_TLV_TYPE_SECONDARY_DEVICE_TYPE_LIST:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_secondary_device_type_list, tvb, offset+4, tlv_len, ENC_NA);\r\nhfindex = hf_eapwps_tlv_secondary_device_type_list;\r\nif ((tlv_len > 128) && pinfo)\r\nexpert_add_info_format(pinfo, tmp_item, &ei_eapwps_fmt_warn_too_long, fmt_warn_too_long, tlv_len);\r\nbreak;\r\ncase WPS_TLV_TYPE_PORTABLE_DEVICE:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_portable_device, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_portable_device;\r\nbreak;\r\ncase WPS_TLV_TYPE_AP_SETUP_LOCKED:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_ap_setup_locked, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_ap_setup_locked;\r\nbreak;\r\ncase WPS_TLV_TYPE_APPLICATION_EXTENSION:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_application_extension, tvb, offset+4, tlv_len, ENC_NA);\r\nhfindex = hf_eapwps_tlv_application_extension;\r\nif ((tlv_len > 512) && pinfo)\r\nexpert_add_info_format(pinfo, tmp_item, &ei_eapwps_fmt_warn_too_long, fmt_warn_too_long, tlv_len);\r\nbreak;\r\ncase WPS_TLV_TYPE_EAP_TYPE:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_eap_type, tvb, offset+4, tlv_len, ENC_NA);\r\nhfindex = hf_eapwps_tlv_eap_type;\r\nif ((tlv_len > 8) && pinfo)\r\nexpert_add_info_format(pinfo, tmp_item, &ei_eapwps_fmt_warn_too_long, fmt_warn_too_long, tlv_len);\r\nbreak;\r\ncase WPS_TLV_TYPE_INITIALIZATION_VECTOR:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_initialization_vector, tvb, offset+4, 32, ENC_NA);\r\nhfindex = hf_eapwps_tlv_initialization_vector;\r\nbreak;\r\ncase WPS_TLV_TYPE_KEY_PROVIDED_AUTOMATICALLY:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_key_provided_automatically, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_key_provided_automatically;\r\nbreak;\r\ncase WPS_TLV_TYPE_8021X_ENABLED:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_8021x_enabled, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_8021x_enabled;\r\nbreak;\r\ncase WPS_TLV_TYPE_APPSESSIONKEY:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_appsessionkey, tvb, offset+4, tlv_len, ENC_NA);\r\nhfindex = hf_eapwps_tlv_appsessionkey;\r\nif ((tlv_len > 128) && pinfo)\r\nexpert_add_info_format(pinfo, tmp_item, &ei_eapwps_fmt_warn_too_long, fmt_warn_too_long, tlv_len);\r\nbreak;\r\ncase WPS_TLV_TYPE_WEPTRANSMITKEY:\r\ntmp_item = proto_tree_add_item(tlv_root, hf_eapwps_tlv_weptransmitkey, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nhfindex = hf_eapwps_tlv_weptransmitkey;\r\nbreak;\r\ncase WPS_TLV_TYPE_REQUESTED_DEV_TYPE:\r\ntmp_item = proto_tree_add_item(tlv_root,\r\nhf_eapwps_tlv_requested_dev_type, tvb,\r\noffset + 4, 8, ENC_NA);\r\nhfindex = hf_eapwps_tlv_requested_dev_type;\r\nbreak;\r\ndefault:\r\ntmp_item = NULL;\r\nhfindex = -1;\r\n}\r\nif ((tmp_item != NULL) && (tlv_item != NULL)) {\r\nguint32 value = -1;\r\nvoid *valuep = NULL;\r\nheader_field_info *hf_info = NULL;\r\nconst char *fmt = NULL;\r\nproto_item_set_text(tlv_item, "%s",\r\nval_to_str(tlv_type, eapwps_tlv_types, "Unknown (0x%04x)"));\r\nhf_info = proto_registrar_get_nth(hfindex);\r\nif (hf_info != NULL) {\r\nswitch(hf_info->type) {\r\ncase FT_UINT8:\r\nfmt = hf_info->strings ? ": %s (0x%02x)": ": 0x%02x";\r\nvalue = tvb_get_guint8 (tvb, offset+4);\r\nbreak;\r\ncase FT_UINT16:\r\nfmt = hf_info->strings ? ": %s (0x%04x)": ": 0x%04x";\r\nvalue = tvb_get_ntohs (tvb, offset+4);\r\nbreak;\r\ncase FT_UINT32:\r\nfmt = hf_info->strings ? ": %s (0x%08x)": ": 0x%08x";\r\nvalue = tvb_get_ntohl (tvb, offset+4);\r\nbreak;\r\ncase FT_STRING:\r\nfmt = ": %s";\r\nvaluep = tvb_get_string_enc(wmem_packet_scope(), tvb, offset+4, tlv_len, ENC_ASCII);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\nif ((hf_info != NULL) && hf_info->strings) {\r\nproto_item_append_text(tlv_item, fmt, val_to_str(value,\r\n(const value_string *)hf_info->strings,\r\n"Unknown: %d"), value);\r\n} else if (valuep != NULL) {\r\nproto_item_append_text(tlv_item, fmt, valuep);\r\n} else if (fmt != NULL) {\r\nproto_item_append_text(tlv_item, fmt, value);\r\n} else {\r\n}\r\n}\r\nif (tlv_type == WPS_TLV_TYPE_VENDOR_EXTENSION)\r\ndissect_wps_vendor_ext(tlv_root, tvb, offset + 4, tlv_len);\r\noffset += tlv_len + 2 + 2;\r\nsize -= tlv_len + 2 + 2;\r\n}\r\n}\r\nvoid\r\ndissect_exteap_wps(proto_tree *eap_tree, tvbuff_t *tvb, int offset,\r\ngint size, packet_info *pinfo)\r\n{\r\nproto_item *pi;\r\nproto_tree *pt;\r\nguint8 flags;\r\npi = proto_tree_add_item(eap_tree, hf_eapwps_opcode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1; size -= 1;\r\npi = proto_item_get_parent(pi);\r\nif (pi != NULL)\r\nproto_item_append_text(pi, " (Wifi Alliance, WifiProtectedSetup)");\r\nif (pinfo != NULL)\r\ncol_append_str(pinfo->cinfo, COL_INFO, ", WPS");\r\nflags = tvb_get_guint8(tvb,offset);\r\npi = proto_tree_add_item(eap_tree, hf_eapwps_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\npt = proto_item_add_subtree(pi, ett_eap_wps_flags);\r\nproto_tree_add_item(pt, hf_eapwps_flag_mf, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pt, hf_eapwps_flag_lf, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1; size -= 1;\r\nif (flags & MASK_WSC_FLAG_LF) {\r\nproto_tree_add_item(eap_tree, hf_eapwps_msglen, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2; size -= 2;\r\n}\r\ndissect_wps_tlvs(eap_tree, tvb, offset, size, pinfo);\r\n}\r\nvoid\r\nproto_register_wps(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_eapwps_opcode,\r\n{ "Opcode", "eap.wps.code",\r\nFT_UINT8, BASE_DEC, VALS(eapwps_opcode_vals), 0x0, "WSC Message Type", HFILL }},\r\n{ &hf_eapwps_flags,\r\n{ "Flags", "eap.wps.flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_flag_mf,\r\n{ "More flag", "eap.wps.flags.more",\r\nFT_BOOLEAN, 8, NULL, MASK_WSC_FLAG_MF, NULL, HFILL }},\r\n{ &hf_eapwps_flag_lf,\r\n{ "Length field present", "eap.wps.flags.length",\r\nFT_BOOLEAN, 8, NULL, MASK_WSC_FLAG_LF, NULL, HFILL }},\r\n{ &hf_eapwps_msglen,\r\n{ "Length field", "eap.wps.msglen",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_type,\r\n{ "Data Element Type", "wps.type",\r\nFT_UINT16, BASE_HEX, VALS(eapwps_tlv_types), 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_len,\r\n{ "Data Element Length", "wps.length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_ap_channel,\r\n{ "AP Channel", "wps.ap_channel",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_association_state,\r\n{ "Association State", "wps.association_state",\r\nFT_UINT16, BASE_HEX, VALS(eapwps_tlv_association_state_vals), 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_authentication_type,\r\n{ "Authentication Type", "wps.authentication_type",\r\nFT_UINT16, BASE_HEX, VALS(eapwps_tlv_authentication_type_vals), 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_authentication_type_flags,\r\n{ "Authentication Type Flags", "wps.authentication_type_flags",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_authentication_type_flags_open,\r\n{ "Open", "wps.authentication_type.open",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_AUTHTYPE_OPEN, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_authentication_type_flags_wpapsk,\r\n{ "WPA PSK", "wps.authentication_type.wpapsk",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_AUTHTYPE_WPAPSK, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_authentication_type_flags_shared,\r\n{ "Shared", "wps.authentication_type.shared",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_AUTHTYPE_SHARED, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_authentication_type_flags_wpa,\r\n{ "WPA", "wps.authentication_type.wpa",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_AUTHTYPE_WPA, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_authentication_type_flags_wpa2,\r\n{ "WPA2", "wps.authentication_type.wpa2",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_AUTHTYPE_WPA2, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_authentication_type_flags_wpa2psk,\r\n{ "WPA2PSK", "wps.authentication_type.wpa2psk",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_AUTHTYPE_WPA2PSK, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_authenticator,\r\n{ "Authenticator", "wps.authenticator",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_config_methods,\r\n{ "Configuration Methods", "wps.config_methods",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_config_methods_usba,\r\n{ "USB", "wps.config_methods.usba",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_USBA, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_config_methods_ethernet,\r\n{ "Ethernet", "wps.config_methods.ethernet",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_ETHERNET, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_config_methods_label,\r\n{ "Label", "wps.config_methods.label",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_LABEL, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_config_methods_display,\r\n{ "Display", "wps.config_methods.display",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_DISPLAY, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_config_methods_virt_display,\r\n{ "Virtual Display", "wps.config_methods.virt_display",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_VIRT_DISPLAY, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_config_methods_phy_display,\r\n{ "Physical Display", "wps.config_methods.phy_display",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_PHY_DISPLAY, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_config_methods_nfcext,\r\n{ "External NFC", "wps.config_methods.nfcext",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_NFCEXT, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_config_methods_nfcint,\r\n{ "Internal NFC", "wps.config_methods.nfcint",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_NFCINT, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_config_methods_nfcinf,\r\n{ "NFC Interface", "wps.config_methods.nfcinf",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_NFCINF, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_config_methods_pushbutton,\r\n{ "Push Button", "wps.config_methods.pushbutton",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_PUSHBUTTON, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_config_methods_virt_pushbutton,\r\n{ "Virtual Push Button", "wps.config_methods.virt_pushbutton",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_VIRT_PUSHBUTTON, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_config_methods_phy_pushbutton,\r\n{ "Physical Push Button", "wps.config_methods.phy_pushbutton",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_PHY_PUSHBUTTON, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_config_methods_keypad,\r\n{ "Keypad", "wps.config_methods.keypad",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_KEYPAD, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_configuration_error,\r\n{ "Configuration Error", "wps.configuration_error",\r\nFT_UINT16, BASE_HEX, VALS(eapwps_tlv_configuration_error_vals), 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_confirmation_url4,\r\n{ "Confirmation URL4", "wps.confirmation_url4",\r\nFT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_confirmation_url6,\r\n{ "Confirmation URL6", "wps.confirmation_url6",\r\nFT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_connection_type,\r\n{ "Connection Type", "wps.connection_type",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_connection_type_flags,\r\n{ "Connection Types", "wps.connection_type_flags",\r\nFT_UINT8, BASE_HEX, VALS(eapwps_tlv_connection_type_vals), 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_connection_type_flags_ess,\r\n{ "ESS", "wps.connection_type_flags.ess",\r\nFT_UINT8, BASE_HEX, NULL, EAPWPS_CONNTYPE_ESS, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_connection_type_flags_ibss,\r\n{ "IBSS", "wps.connection_type_flags.ibss",\r\nFT_UINT8, BASE_HEX, NULL, EAPWPS_CONNTYPE_IBSS, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_credential,\r\n{ "Credential", "wps.credential",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_device_name,\r\n{ "Device Name", "wps.device_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_device_password_id,\r\n{ "Device Password ID", "wps.device_password_id",\r\nFT_UINT16, BASE_HEX, VALS(eapwps_tlv_device_password_id_vals), 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_e_hash1,\r\n{ "Enrollee Hash 1", "wps.e_hash1",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_e_hash2,\r\n{ "Enrollee Hash 2", "wps.e_hash2",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_e_snonce1,\r\n{ "Enrollee SNounce 1", "wps.e_snonce1",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_e_snonce2,\r\n{ "Enrollee SNounce 2", "wps.e_snonce2",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_encrypted_settings,\r\n{ "Encrypted Settings", "wps.encrypted_settings",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_encryption_type,\r\n{ "Encryption Type", "wps.encryption_type",\r\nFT_UINT16, BASE_HEX, VALS(eapwps_tlv_encryption_type_vals), 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_encryption_type_flags,\r\n{ "Encryption Type Flags", "wps.encryption_type_flags",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_encryption_type_flags_none,\r\n{ "None", "wps.encryption_type_flags.none",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_ENCTYPE_NONE, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_encryption_type_flags_wep,\r\n{ "WEP", "wps.encryption_type_flags.wep",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_ENCTYPE_WEP, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_encryption_type_flags_tkip,\r\n{ "TKIP", "wps.encryption_type_flags.tkip",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_ENCTYPE_TKIP, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_encryption_type_flags_aes,\r\n{ "AES", "wps.encryption_type_flags.aes",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_ENCTYPE_AES, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_enrollee_nonce,\r\n{ "Enrollee Nonce", "wps.enrollee_nonce",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_feature_id,\r\n{ "Feature ID", "wps.feature_id",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_identity,\r\n{ "Identity", "wps.identity",\r\nFT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_identity_proof,\r\n{ "Identity Proof", "wps.identity_proof",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_key_wrap_authenticator,\r\n{ "Key Wrap Authenticator", "wps.key_wrap_authenticator",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_key_identifier,\r\n{ "Key Identifier", "wps.key_identifier",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_mac_address,\r\n{ "MAC", "wps.mac_address",\r\nFT_ETHER, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_manufacturer,\r\n{ "Manufacturer", "wps.manufacturer",\r\nFT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_message_type,\r\n{ "Message Type", "wps.message_type",\r\nFT_UINT8, BASE_HEX, VALS(eapwps_tlv_message_type_vals), 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_model_name,\r\n{ "Model Name", "wps.model_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_model_number,\r\n{ "Model Number", "wps.model_number",\r\nFT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_network_index,\r\n{ "Network Index", "wps.network_index",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_network_key,\r\n{ "Network Key", "wps.network_key",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_network_key_index,\r\n{ "Network Key Index", "wps.network_key_index",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_new_device_name,\r\n{ "New Device Name", "wps.new_device_name",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_new_password,\r\n{ "New Password", "wps.new_password",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_oob_device_password,\r\n{ "OOB Device Password", "wps.oob_device_password",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_os_version,\r\n{ "OS Version", "wps.os_version",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_power_level,\r\n{ "Power Level", "wps.power_level",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_psk_current,\r\n{ "PSK Current", "wps.psk_current",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_psk_max,\r\n{ "PSK Max", "wps.psk_max",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_public_key,\r\n{ "Public Key", "wps.public_key",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_radio_enabled,\r\n{ "Radio Enabled", "wps.radio_enabled",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_reboot,\r\n{ "Reboot", "wps.reboot",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_registrar_current,\r\n{ "Registrar current", "wps.registrar_current",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_registrar_established,\r\n{ "Registrar established", "wps.registrar_established",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_registrar_list,\r\n{ "Registrar list", "wps.registrar_list",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_registrar_max,\r\n{ "Registrar max", "wps.registrar_max",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_registrar_nonce,\r\n{ "Registrar Nonce", "wps.registrar_nonce",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_request_type,\r\n{ "Request Type", "wps.request_type",\r\nFT_UINT8, BASE_HEX, VALS(eapwps_tlv_request_type_vals), 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_response_type,\r\n{ "Response Type", "wps.response_type",\r\nFT_UINT8, BASE_HEX, VALS(eapwps_tlv_response_type_vals), 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_rf_bands,\r\n{ "RF Bands", "wps.rf_bands",\r\nFT_UINT8, BASE_HEX, VALS(eapwps_tlv_rf_bands_vals), 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_r_hash1,\r\n{ "Registrar Hash 1", "wps.r_hash1",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_r_hash2,\r\n{ "Registrar Hash 2", "wps.r_hash2",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_r_snonce1,\r\n{ "Registrar Snonce1", "wps.r_snonce1",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_r_snonce2,\r\n{ "Registrar Snonce 2", "wps.r_snonce2",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_selected_registrar,\r\n{ "Selected Registrar", "wps.selected_registrar",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_serial_number,\r\n{ "Serial Number", "wps.serial_number",\r\nFT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_wifi_protected_setup_state,\r\n{ "Wifi Protected Setup State", "wps.wifi_protected_setup_state",\r\nFT_UINT8, BASE_HEX, VALS(eapwps_tlv_wifi_protected_setup_state), 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_ssid,\r\n{ "SSID", "wps.ssid",\r\nFT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_total_networks,\r\n{ "Total Networks", "wps.total_networks",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_uuid_e,\r\n{ "UUID Enrollee", "wps.uuid_e",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_uuid_r,\r\n{ "UUID Registrar", "wps.uuid_r",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_vendor_extension,\r\n{ "Vendor Extension", "wps.vendor_extension",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_version,\r\n{ "Version", "wps.version",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_x509_certificate_request,\r\n{ "X509 Certificate Request", "wps.x509_certificate_request",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_x509_certificate,\r\n{ "X509 Certificate", "wps.x509_certificate",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_eap_identity,\r\n{ "EAP Identity", "wps.eap_identity",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_message_counter,\r\n{ "Message Counter", "wps.message_counter",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_public_key_hash,\r\n{ "Public Key Hash", "wps.public_key_hash",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_rekey_key,\r\n{ "Rekey Key", "wps.rekey_key",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_key_lifetime,\r\n{ "Key Lifetime", "wps.key_lifetime",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_permitted_config_methods,\r\n{ "Permitted COnfig Methods", "wps.permitted_config_methods",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_permitted_config_methods_usba,\r\n{ "USB", "wps.permitted_config_methods.usba",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_USBA, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_permitted_config_methods_ethernet,\r\n{ "Ethernet", "wps.permitted_config_methods.ethernet",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_ETHERNET, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_permitted_config_methods_label,\r\n{ "Label", "wps.permitted_config_methods.label",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_LABEL, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_permitted_config_methods_display,\r\n{ "Display", "wps.permitted_config_methods.display",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_DISPLAY, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_permitted_config_methods_virt_display,\r\n{ "Virtual Display", "wps.permitted_config_methods.virt_display",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_VIRT_DISPLAY, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_permitted_config_methods_phy_display,\r\n{ "Physical Display", "wps.permitted_config_methods.phy_display",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_PHY_DISPLAY, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_permitted_config_methods_nfcext,\r\n{ "External NFC", "wps.permitted_config_methods.nfcext",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_NFCEXT, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_permitted_config_methods_nfcint,\r\n{ "Internal NFC", "wps.permitted_config_methods.nfcint",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_NFCINT, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_permitted_config_methods_nfcinf,\r\n{ "NFC Interface", "wps.permitted_config_methods.nfcinf",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_NFCINF, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_permitted_config_methods_pushbutton,\r\n{ "Push Button", "wps.permitted_config_methods.pushbutton",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_PUSHBUTTON, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_permitted_config_methods_virt_pushbutton,\r\n{ "Virtual Push Button", "wps.permitted_config_methods.virt_pushbutton",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_VIRT_PUSHBUTTON, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_permitted_config_methods_phy_pushbutton,\r\n{ "Physical Push Button", "wps.permitted_config_methods.phy_pushbutton",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_PHY_PUSHBUTTON, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_permitted_config_methods_keypad,\r\n{ "Keypad", "wps.permitted_config_methods.keypad",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_KEYPAD, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_selected_registrar_config_methods,\r\n{ "Selected Registrar Config Methods", "wps.selected_registrar_config_methods",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_selected_registrar_config_methods_usba,\r\n{ "USB", "wps.selected_registrar_config_methods.usba",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_USBA, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_selected_registrar_config_methods_ethernet,\r\n{ "Ethernet", "wps.selected_registrar_config_methods.ethernet",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_ETHERNET, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_selected_registrar_config_methods_label,\r\n{ "Label", "wps.selected_registrar_config_methods.label",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_LABEL, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_selected_registrar_config_methods_display,\r\n{ "Display", "wps.selected_registrar_config_methods.display",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_DISPLAY, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_selected_registrar_config_methods_virt_display,\r\n{ "Virtual Display", "wps.selected_registrar_config_methods.virt_display",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_VIRT_DISPLAY, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_selected_registrar_config_methods_phy_display,\r\n{ "Physical Display", "wps.selected_registrar_config_methods.phy_display",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_PHY_DISPLAY, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_selected_registrar_config_methods_nfcext,\r\n{ "External NFC", "wps.selected_registrar_config_methods.nfcext",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_NFCEXT, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_selected_registrar_config_methods_nfcint,\r\n{ "Internal NFC", "wps.selected_registrar_config_methods.nfcint",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_NFCINT, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_selected_registrar_config_methods_nfcinf,\r\n{ "NFC Interface", "wps.selected_registrar_config_methods.nfcinf",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_NFCINF, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_selected_registrar_config_methods_pushbutton,\r\n{ "Push Button", "wps.selected_registrar_config_methods.pushbutton",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_PUSHBUTTON, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_selected_registrar_config_methods_virt_pushbutton,\r\n{ "Virtual Push Button", "wps.selected_registrar_config_methods.virt_pushbutton",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_VIRT_PUSHBUTTON, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_selected_registrar_config_methods_phy_pushbutton,\r\n{ "Physical Push Button", "wps.selected_registrar_config_methods.phy_pushbutton",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_PHY_PUSHBUTTON, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_selected_registrar_config_methods_keypad,\r\n{ "Keypad", "wps.selected_registrar_config_methods.keypad",\r\nFT_UINT16, BASE_HEX, NULL, EAPWPS_CONFMETH_KEYPAD, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_primary_device_type,\r\n{ "Primary Device Type", "wps.primary_device_type",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_primary_device_type_category,\r\n{ "Category", "wps.primary_device_type.category",\r\nFT_UINT16, BASE_HEX, VALS(eapwps_tlv_primary_device_type_category), 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_primary_device_type_subcategory[0],\r\n{ "Subcategory", "wps.primary_device_type.subcategory_computer",\r\nFT_UINT16, BASE_HEX, VALS(eapwps_tlv_computer_subcategory), 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_primary_device_type_subcategory[1],\r\n{ "Subcategory", "wps.primary_device_type.subcategory_input_device",\r\nFT_UINT16, BASE_HEX, VALS(eapwps_tlv_input_device_subcategory), 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_primary_device_type_subcategory[2],\r\n{ "Subcategory", "wps.primary_device_type.subcategory_printers_scanners_faxes_copiers",\r\nFT_UINT16, BASE_HEX, VALS(eapwps_tlv_printers_scanners_faxes_copiers_subcategory), 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_primary_device_type_subcategory[3],\r\n{ "Subcategory", "wps.primary_device_type.subcategory_camera",\r\nFT_UINT16, BASE_HEX, VALS(eapwps_tlv_camera_subcategory), 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_primary_device_type_subcategory[4],\r\n{ "Subcategory", "wps.primary_device_type.subcategory_storage",\r\nFT_UINT16, BASE_HEX, VALS(eapwps_tlv_storage_subcategory), 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_primary_device_type_subcategory[5],\r\n{ "Subcategory", "wps.primary_device_type.subcategory_network_infrastructure",\r\nFT_UINT16, BASE_HEX, VALS(eapwps_tlv_network_infrastructure_subcategory), 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_primary_device_type_subcategory[6],\r\n{ "Subcategory", "wps.primary_device_type.subcategory_displays",\r\nFT_UINT16, BASE_HEX, VALS(eapwps_tlv_displays_subcategory), 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_primary_device_type_subcategory[7],\r\n{ "Subcategory", "wps.primary_device_type.subcategory_multimedia_devices",\r\nFT_UINT16, BASE_HEX, VALS(eapwps_tlv_multimedia_devices_subcategory), 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_primary_device_type_subcategory[8],\r\n{ "Subcategory", "wps.primary_device_type.subcategory_gaming_devices",\r\nFT_UINT16, BASE_HEX, VALS(eapwps_tlv_gaming_devices_subcategory), 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_primary_device_type_subcategory[9],\r\n{ "Subcategory", "wps.primary_device_type.subcategory_telephone",\r\nFT_UINT16, BASE_HEX, VALS(eapwps_tlv_telephone_subcategory), 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_primary_device_type_subcategory[10],\r\n{ "Subcategory", "wps.primary_device_type.subcategory_audio_devices",\r\nFT_UINT16, BASE_HEX, VALS(eapwps_tlv_audio_devices_subcategory), 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_secondary_device_type_list,\r\n{ "Secondary Device Type List", "wps.secondary_device_type_list",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_portable_device,\r\n{ "Portable Device", "wps.portable_device",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_ap_setup_locked,\r\n{ "AP Setup Locked", "wps.ap_setup_locked",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_application_extension,\r\n{ "Application Extension", "wps.application_extension",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_eap_type,\r\n{ "EAP Type", "wps.eap_type",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_initialization_vector,\r\n{ "Initialization Vector", "wps.initialization_vector",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_key_provided_automatically,\r\n{ "Key Provided Automatically", "wps.key_provided_automatically",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_8021x_enabled,\r\n{ "8021x Enabled", "wps.8021x_enabled",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_appsessionkey,\r\n{ "AppSessionKey", "wps.appsessionkey",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_weptransmitkey,\r\n{ "WEP Transmit Key", "wps.weptransmitkey",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_tlv_requested_dev_type,\r\n{ "Requested Device Type", "wps.requested_dev_type",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_vendor_id,\r\n{ "Vendor ID", "wps.vendor_id",\r\nFT_UINT24, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_wfa_ext_id,\r\n{ "WFA Extension Subelement ID", "wps.ext.id",\r\nFT_UINT8, BASE_DEC, VALS(eapwps_wfa_ext_types), 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_wfa_ext_len,\r\n{ "WFA Extension Subelement Length", "wps.ext.len",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_wfa_ext_version2,\r\n{ "Version2", "wps.ext.version2",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_wfa_ext_authorizedmacs,\r\n{ "AuthorizedMACs", "wps.ext.authorizedmacs",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_wfa_ext_network_key_shareable,\r\n{ "Network Key Shareable", "wps.ext.network_key_shareable",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_wfa_ext_request_to_enroll,\r\n{ "Request to Enroll", "wps.ext.request_to_enroll",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_eapwps_wfa_ext_settings_delay_time,\r\n{ "Settings Delay Time", "wps.ext.settings_delay_time",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_eap_wps_attr,\r\n&ett_eap_wps_flags,\r\n&ett_wps_tlv,\r\n&ett_eap_wps_ap_channel,\r\n&ett_eap_wps_association_state,\r\n&ett_eap_wps_authentication_type,\r\n&ett_eap_wps_authentication_type_flags,\r\n&ett_eap_wps_authenticator,\r\n&ett_eap_wps_config_methods,\r\n&ett_eap_wps_configuration_error,\r\n&ett_eap_wps_confirmation_url4,\r\n&ett_eap_wps_confirmation_url6,\r\n&ett_eap_wps_connection_type,\r\n&ett_eap_wps_connection_type_flags,\r\n&ett_eap_wps_credential,\r\n&ett_eap_wps_device_name,\r\n&ett_eap_wps_device_password_id,\r\n&ett_eap_wps_e_hash1,\r\n&ett_eap_wps_e_hash2,\r\n&ett_eap_wps_e_snonce1,\r\n&ett_eap_wps_e_snonce2,\r\n&ett_eap_wps_encrypted_settings,\r\n&ett_eap_wps_encryption_type,\r\n&ett_eap_wps_encryption_type_flags,\r\n&ett_eap_wps_enrollee_nonce,\r\n&ett_eap_wps_feature_id,\r\n&ett_eap_wps_identity,\r\n&ett_eap_wps_identity_proof,\r\n&ett_eap_wps_key_wrap_authenticator,\r\n&ett_eap_wps_key_identifier,\r\n&ett_eap_wps_mac_address,\r\n&ett_eap_wps_manufacturer,\r\n&ett_eap_wps_message_type,\r\n&ett_eap_wps_model_name,\r\n&ett_eap_wps_model_number,\r\n&ett_eap_wps_network_index,\r\n&ett_eap_wps_network_key,\r\n&ett_eap_wps_network_key_index,\r\n&ett_eap_wps_new_device_name,\r\n&ett_eap_wps_new_password,\r\n&ett_eap_wps_oob_device_password,\r\n&ett_eap_wps_os_version,\r\n&ett_eap_wps_power_level,\r\n&ett_eap_wps_psk_current,\r\n&ett_eap_wps_psk_max,\r\n&ett_eap_wps_public_key,\r\n&ett_eap_wps_radio_enabled,\r\n&ett_eap_wps_reboot,\r\n&ett_eap_wps_registrar_current,\r\n&ett_eap_wps_registrar_established,\r\n&ett_eap_wps_registrar_list,\r\n&ett_eap_wps_registrar_max,\r\n&ett_eap_wps_registrar_nonce,\r\n&ett_eap_wps_request_type,\r\n&ett_eap_wps_response_type,\r\n&ett_eap_wps_rf_bands,\r\n&ett_eap_wps_r_hash1,\r\n&ett_eap_wps_r_hash2,\r\n&ett_eap_wps_r_snonce1,\r\n&ett_eap_wps_r_snonce2,\r\n&ett_eap_wps_selected_registrar,\r\n&ett_eap_wps_serial_number,\r\n&ett_eap_wps_wifi_protected_setup_state,\r\n&ett_eap_wps_ssid,\r\n&ett_eap_wps_total_networks,\r\n&ett_eap_wps_uuid_e,\r\n&ett_eap_wps_uuid_r,\r\n&ett_eap_wps_vendor_extension,\r\n&ett_eap_wps_version,\r\n&ett_eap_wps_x509_certificate_request,\r\n&ett_eap_wps_x509_certificate,\r\n&ett_eap_wps_eap_identity,\r\n&ett_eap_wps_message_counter,\r\n&ett_eap_wps_public_key_hash,\r\n&ett_eap_wps_rekey_key,\r\n&ett_eap_wps_key_lifetime,\r\n&ett_eap_wps_permitted_config_methods,\r\n&ett_eap_wps_selected_registrar_config_methods,\r\n&ett_eap_wps_primary_device_type,\r\n&ett_eap_wps_secondary_device_type_list,\r\n&ett_eap_wps_portable_device,\r\n&ett_eap_wps_ap_setup_locked,\r\n&ett_eap_wps_application_extension,\r\n&ett_eap_wps_eap_type,\r\n&ett_eap_wps_initialization_vector,\r\n&ett_eap_wps_key_provided_automatically,\r\n&ett_eap_wps_8021x_enabled,\r\n&ett_eap_wps_appsessionkey,\r\n&ett_eap_wps_weptransmitkey,\r\n&ett_wps_wfa_ext,\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_eapwps_packet_too_short, { "wps.packet_too_short", PI_MALFORMED, PI_ERROR, "Packet too short", EXPFILL }},\r\n{ &ei_eapwps_fmt_warn_too_long, { "wps.length.value_too_long", PI_MALFORMED, PI_ERROR, "Value too long", EXPFILL }},\r\n{ &ei_eapwps_fmt_length_warn, { "wps.length.too_long", PI_MALFORMED, PI_ERROR, "Value length not X", EXPFILL }},\r\n};\r\nexpert_module_t* expert_wps;\r\nproto_wps = proto_register_protocol("Wifi Protected Setup",\r\n"WPS", "wps");\r\nproto_register_field_array(proto_wps, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_wps = expert_register_protocol(proto_wps);\r\nexpert_register_field_array(expert_wps, ei, array_length(ei));\r\n}
