static void\r\ndissect_zcl_thermostat_schedule_days(proto_tree *tree, tvbuff_t *tvb, guint offset)\r\n{\r\nstatic const int *thermostat_schedule_days[] = {\r\n&hf_zbee_zcl_thermostat_schedule_day_sunday,\r\n&hf_zbee_zcl_thermostat_schedule_day_monday,\r\n&hf_zbee_zcl_thermostat_schedule_day_tuesday,\r\n&hf_zbee_zcl_thermostat_schedule_day_wednesday,\r\n&hf_zbee_zcl_thermostat_schedule_day_thursday,\r\n&hf_zbee_zcl_thermostat_schedule_day_friday,\r\n&hf_zbee_zcl_thermostat_schedule_day_saturday,\r\n&hf_zbee_zcl_thermostat_schedule_day_vacation,\r\nNULL\r\n};\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_zbee_zcl_thermostat_schedule_day_sequence,\r\nett_zbee_zcl_thermostat_schedule_days, thermostat_schedule_days, ENC_NA);\r\n}\r\nstatic void\r\ndissect_zcl_thermostat_schedule_mode(proto_tree *tree, tvbuff_t *tvb, guint offset)\r\n{\r\nstatic const int *thermostat_schedule_modes[] = {\r\n&hf_zbee_zcl_thermostat_schedule_mode_heat,\r\n&hf_zbee_zcl_thermostat_schedule_mode_cool,\r\nNULL\r\n};\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_zbee_zcl_thermostat_schedule_mode_sequence,\r\nett_zbee_zcl_thermostat_schedule_mode, thermostat_schedule_modes, ENC_NA);\r\n}\r\nstatic int\r\ndissect_zcl_thermostat_schedule(proto_tree *tree, tvbuff_t *tvb, guint offset)\r\n{\r\nguint start = offset;\r\nguint8 num_transitions;\r\nguint8 mode_sequence;\r\nint i;\r\nnum_transitions = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_uint(tree, hf_zbee_zcl_thermostat_schedule_num_trans, tvb, offset, 1,\r\nnum_transitions);\r\noffset++;\r\ndissect_zcl_thermostat_schedule_days(tree, tvb, offset);\r\noffset++;\r\nmode_sequence = tvb_get_guint8(tvb, offset);\r\ndissect_zcl_thermostat_schedule_mode(tree, tvb, offset);\r\noffset++;\r\nfor (i = 0; i < num_transitions; i++) {\r\nnstime_t tv;\r\ntv.secs = tvb_get_letohs(tvb, offset) * 60;\r\ntv.nsecs = 0;\r\nproto_tree_add_time(tree, hf_zbee_zcl_thermostat_schedule_time, tvb, offset, 2, &tv);\r\noffset += 2;\r\nif (mode_sequence & ZBEE_ZCL_CMD_THERMOSTAT_SCHEDULE_MODE_SEQUENCE_HEAT) {\r\nfloat setpoint = (gint16)tvb_get_letohs(tvb, offset);\r\nproto_tree_add_float(tree, hf_zbee_zcl_thermostat_schedule_heat,\r\ntvb, offset, 2, (setpoint / 100.0f));\r\noffset += 2;\r\n}\r\nif (mode_sequence & ZBEE_ZCL_CMD_THERMOSTAT_SCHEDULE_MODE_SEQUENCE_COOL) {\r\nfloat setpoint = (gint16)tvb_get_letohs(tvb, offset);\r\nproto_tree_add_float(tree, hf_zbee_zcl_thermostat_schedule_cool,\r\ntvb, offset, 2, (setpoint / 100.0f));\r\noffset += 2;\r\n}\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic int\r\ndissect_zbee_zcl_thermostat(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data)\r\n{\r\nzbee_zcl_packet *zcl;\r\nguint offset = 0;\r\nguint8 cmd_id;\r\nfloat amount;\r\nif (data == NULL)\r\nreturn 0;\r\nzcl = (zbee_zcl_packet *)data;\r\ncmd_id = zcl->cmd_id;\r\nif (zcl->direction == ZBEE_ZCL_FCF_TO_SERVER) {\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s, Seq: %u",\r\nval_to_str_const(cmd_id, zbee_zcl_thermostat_srv_rx_cmd_names, "Unknown Command"),\r\nzcl->tran_seqno);\r\nproto_tree_add_item(tree, hf_zbee_zcl_thermostat_srv_rx_cmd_id, tvb, offset, 1, cmd_id);\r\noffset++;\r\nswitch (cmd_id) {\r\ncase ZBEE_ZCL_CMD_ID_THERMOSTAT_SETPOINT:\r\nproto_tree_add_item(tree, hf_zbee_zcl_thermostat_setpoint_mode,\r\ntvb, offset, 1, ENC_NA);\r\noffset++;\r\namount = (gint8)tvb_get_guint8(tvb, offset);\r\nproto_tree_add_float(tree, hf_zbee_zcl_thermostat_setpoint_amount,\r\ntvb, offset, 1, (amount / 100.0f));\r\noffset++;\r\nbreak;\r\ncase ZBEE_ZCL_CMD_ID_THERMOSTAT_GET_SCHEDULE:\r\ndissect_zcl_thermostat_schedule_days(tree, tvb, offset);\r\noffset++;\r\ndissect_zcl_thermostat_schedule_mode(tree, tvb, offset);\r\noffset++;\r\nbreak;\r\ncase ZBEE_ZCL_CMD_ID_THERMOSTAT_SET_SCHEDULE:\r\ndissect_zcl_thermostat_schedule(tree, tvb, offset);\r\nbreak;\r\ncase ZBEE_ZCL_CMD_ID_THERMOSTAT_GET_RELAY_LOG:\r\ndefault:\r\nbreak;\r\n}\r\n} else {\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s, Seq: %u",\r\nval_to_str_const(cmd_id, zbee_zcl_thermostat_srv_tx_cmd_names, "Unknown Command"),\r\nzcl->tran_seqno);\r\nproto_tree_add_item(tree, hf_zbee_zcl_thermostat_srv_tx_cmd_id, tvb, offset, 1, cmd_id);\r\noffset++;\r\nswitch (cmd_id) {\r\ncase ZBEE_ZCL_CMD_ID_THERMOSTAT_GET_SCHEDULE_RESPONSE:\r\ndissect_zcl_thermostat_schedule(tree, tvb, offset);\r\nbreak;\r\ncase ZBEE_ZCL_CMD_ID_THERMOSTAT_GET_RELAY_LOG_RESPONSE:\r\ndefault:\r\nbreak;\r\n}\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic void\r\ndissect_zcl_thermostat_attr_data(proto_tree *tree, tvbuff_t *tvb, guint *offset, guint16 attr_id, guint data_type)\r\n{\r\nswitch (attr_id) {\r\ndefault:\r\ndissect_zcl_attr_data(tvb, tree, offset, data_type);\r\nbreak;\r\n}\r\n}\r\nvoid\r\nproto_register_zbee_zcl_thermostat(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_zbee_zcl_thermostat_attr_id,\r\n{ "Attribute", "zbee_zcl_hvac.thermostat.attr_id", FT_UINT16, BASE_HEX, VALS(zbee_zcl_thermostat_attr_names),\r\n0x0, NULL, HFILL } },\r\n{ &hf_zbee_zcl_thermostat_srv_rx_cmd_id,\r\n{ "Command", "zbee_zcl_hvac.thermostat.cmd.srv_rx.id", FT_UINT8, BASE_HEX,\r\nVALS(zbee_zcl_thermostat_srv_rx_cmd_names), 0x0, NULL, HFILL }},\r\n{ &hf_zbee_zcl_thermostat_srv_tx_cmd_id,\r\n{ "Command", "zbee_zcl_hvac.thermostat.cmd.srv_tx.id", FT_UINT8, BASE_HEX,\r\nVALS(zbee_zcl_thermostat_srv_tx_cmd_names), 0x0, NULL, HFILL }},\r\n{ &hf_zbee_zcl_thermostat_setpoint_mode,\r\n{ "Mode", "zbee_zcl_hvac.thermostat.mode", FT_UINT8, BASE_HEX,\r\nVALS(zbee_zcl_thermostat_setpoint_mode_names), 0x0, NULL, HFILL }},\r\n{ &hf_zbee_zcl_thermostat_setpoint_amount,\r\n{ "Amount", "zbee_zcl_hvac.thermostat.amount", FT_FLOAT, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_zbee_zcl_thermostat_schedule_num_trans,\r\n{ "Number of Transitions for Sequence", "zbee_zcl_hvac.thermostat.num_trans", FT_UINT8, BASE_HEX, NULL,\r\n0x0, NULL, HFILL }},\r\n{ &hf_zbee_zcl_thermostat_schedule_day_sequence,\r\n{ "Days of Week for Sequence", "zbee_zcl_hvac.thermostat.day_sequence", FT_UINT8, BASE_HEX, NULL,\r\n0x0, NULL, HFILL }},\r\n{ &hf_zbee_zcl_thermostat_schedule_day_sunday,\r\n{ "Sunday", "zbee_zcl_hvac.thermostat.day.sunday", FT_BOOLEAN, 8, TFS(&tfs_true_false), 0x01, NULL,\r\nHFILL }},\r\n{ &hf_zbee_zcl_thermostat_schedule_day_monday,\r\n{ "Monday", "zbee_zcl_hvac.thermostat.day.monday", FT_BOOLEAN, 8, TFS(&tfs_true_false), 0x02, NULL,\r\nHFILL }},\r\n{ &hf_zbee_zcl_thermostat_schedule_day_tuesday,\r\n{ "Tuesday", "zbee_zcl_hvac.thermostat.day.tuesday", FT_BOOLEAN, 8, TFS(&tfs_true_false), 0x04, NULL,\r\nHFILL }},\r\n{ &hf_zbee_zcl_thermostat_schedule_day_wednesday,\r\n{ "Wednesday", "zbee_zcl_hvac.thermostat.day.wednesday", FT_BOOLEAN, 8, TFS(&tfs_true_false), 0x08, NULL,\r\nHFILL }},\r\n{ &hf_zbee_zcl_thermostat_schedule_day_thursday,\r\n{ "Thursday", "zbee_zcl_hvac.thermostat.day.thursday", FT_BOOLEAN, 8, TFS(&tfs_true_false), 0x10, NULL,\r\nHFILL }},\r\n{ &hf_zbee_zcl_thermostat_schedule_day_friday,\r\n{ "Friday", "zbee_zcl_hvac.thermostat.day.friday", FT_BOOLEAN, 8, TFS(&tfs_true_false), 0x20, NULL,\r\nHFILL }},\r\n{ &hf_zbee_zcl_thermostat_schedule_day_saturday,\r\n{ "Saturday", "zbee_zcl_hvac.thermostat.day.saturday", FT_BOOLEAN, 8, TFS(&tfs_true_false), 0x40, NULL,\r\nHFILL }},\r\n{ &hf_zbee_zcl_thermostat_schedule_day_vacation,\r\n{ "Away/Vacation", "zbee_zcl_hvac.thermostat.day.vacation", FT_BOOLEAN, 8, TFS(&tfs_true_false), 0x80, NULL,\r\nHFILL }},\r\n{ &hf_zbee_zcl_thermostat_schedule_mode_sequence,\r\n{ "Mode for Sequence", "zbee_zcl_hvac.thermostat.mode_sequence", FT_UINT8, BASE_HEX, NULL,\r\n0x0, NULL, HFILL }},\r\n{ &hf_zbee_zcl_thermostat_schedule_mode_heat,\r\n{ "Heating", "zbee_zcl_hvac.thermostat.mode.heat", FT_BOOLEAN, 8, TFS(&tfs_true_false), 0x01, NULL, HFILL }},\r\n{ &hf_zbee_zcl_thermostat_schedule_mode_cool,\r\n{ "Cooling", "zbee_zcl_hvac.thermostat.mode.cool", FT_BOOLEAN, 8, TFS(&tfs_true_false), 0x02, NULL, HFILL }},\r\n{ &hf_zbee_zcl_thermostat_schedule_time,\r\n{ "Transition Time", "zbee_zcl_hvac.thermostat.time", FT_RELATIVE_TIME, BASE_NONE, NULL, 0x0,\r\n"Setpoint transition time relative to midnight of the scheduled day", HFILL }},\r\n{ &hf_zbee_zcl_thermostat_schedule_heat,\r\n{ "Heating Setpoint", "zbee_zcl_hvac.thermostat.heat", FT_FLOAT, BASE_NONE, NULL, 0x0,\r\n"Heating setpoint in degrees Celcius", HFILL }},\r\n{ &hf_zbee_zcl_thermostat_schedule_cool,\r\n{ "Cooling Setpoint", "zbee_zcl_hvac.thermostat.cool", FT_FLOAT, BASE_NONE, NULL, 0x0,\r\n"Cooling setpoint in degrees Celcius", HFILL }}\r\n};\r\nstatic gint *ett[ZBEE_ZCL_THERMOSTAT_NUM_ETT];\r\nett[0] = &ett_zbee_zcl_thermostat;\r\nett[1] = &ett_zbee_zcl_thermostat_schedule_days;\r\nett[2] = &ett_zbee_zcl_thermostat_schedule_mode;\r\nproto_zbee_zcl_thermostat = proto_register_protocol("ZigBee ZCL Thermostat", "ZCL Thermostat", ZBEE_PROTOABBREV_ZCL_THERMOSTAT);\r\nproto_register_field_array(proto_zbee_zcl_thermostat, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nregister_dissector(ZBEE_PROTOABBREV_ZCL_THERMOSTAT, dissect_zbee_zcl_thermostat, proto_zbee_zcl_thermostat);\r\n}\r\nvoid\r\nproto_reg_handoff_zbee_zcl_thermostat(void)\r\n{\r\ndissector_handle_t thermostat_handle;\r\nthermostat_handle = find_dissector(ZBEE_PROTOABBREV_ZCL_THERMOSTAT);\r\ndissector_add_uint("zbee.zcl.cluster", ZBEE_ZCL_CID_THERMOSTAT, thermostat_handle);\r\nzbee_zcl_init_cluster( proto_zbee_zcl_thermostat,\r\nett_zbee_zcl_thermostat,\r\nZBEE_ZCL_CID_THERMOSTAT,\r\nhf_zbee_zcl_thermostat_attr_id,\r\nhf_zbee_zcl_thermostat_srv_rx_cmd_id,\r\nhf_zbee_zcl_thermostat_srv_tx_cmd_id,\r\n(zbee_zcl_fn_attr_data)dissect_zcl_thermostat_attr_data\r\n);\r\n}\r\nstatic void\r\ndissect_zcl_ias_zone_status(proto_tree *tree, tvbuff_t *tvb, guint offset)\r\n{\r\nstatic const int *ias_zone_statuses[] = {\r\n&hf_zbee_zcl_ias_zone_status_alarm1,\r\n&hf_zbee_zcl_ias_zone_status_alarm2,\r\n&hf_zbee_zcl_ias_zone_status_tamper,\r\n&hf_zbee_zcl_ias_zone_status_battery,\r\n&hf_zbee_zcl_ias_zone_status_supervision_reports,\r\n&hf_zbee_zcl_ias_zone_status_restore_reports,\r\n&hf_zbee_zcl_ias_zone_status_trouble,\r\n&hf_zbee_zcl_ias_zone_status_ac_mains,\r\nNULL\r\n};\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_zbee_zcl_ias_zone_status, ett_zbee_zcl_ias_zone_status, ias_zone_statuses, ENC_NA);\r\n}\r\nstatic int\r\ndissect_zbee_zcl_ias_zone(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data)\r\n{\r\nzbee_zcl_packet *zcl;\r\nguint offset = 0;\r\nguint8 cmd_id;\r\nif (data == NULL)\r\nreturn 0;\r\nzcl = (zbee_zcl_packet *)data;\r\ncmd_id = zcl->cmd_id;\r\nif (zcl->direction == ZBEE_ZCL_FCF_TO_SERVER) {\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s, Seq: %u",\r\nval_to_str_const(cmd_id, zbee_zcl_ias_zone_srv_rx_cmd_names, "Unknown Command"),\r\nzcl->tran_seqno);\r\nproto_tree_add_item(tree, hf_zbee_zcl_ias_zone_srv_rx_cmd_id, tvb, offset, 1, cmd_id);\r\noffset++;\r\nswitch (cmd_id) {\r\ncase ZBEE_ZCL_CMD_ID_IAS_ZONE_ENROLL_RESPONSE:\r\nproto_tree_add_item(tree, hf_zbee_zcl_ias_zone_enroll_code, tvb, offset, 1, ENC_NA);\r\noffset++;\r\nproto_tree_add_item(tree, hf_zbee_zcl_ias_zone_zone_id, tvb, offset, 1, ENC_NA);\r\noffset++;\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n} else {\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s, Seq: %u",\r\nval_to_str_const(cmd_id, zbee_zcl_ias_zone_srv_tx_cmd_names, "Unknown Command"),\r\nzcl->tran_seqno);\r\nproto_tree_add_item(tree, hf_zbee_zcl_ias_zone_srv_tx_cmd_id, tvb, offset, 1, cmd_id);\r\noffset++;\r\nswitch (cmd_id) {\r\ncase ZBEE_ZCL_CMD_ID_IAS_ZONE_ENROLL_NOTIFY:\r\ndissect_zcl_ias_zone_status(tree, tvb, offset);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_zbee_zcl_ias_zone_ext_status, tvb, offset,\r\n1, ENC_NA);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_zbee_zcl_ias_zone_zone_id, tvb, offset, 1,\r\nENC_NA);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_zbee_zcl_ias_zone_delay, tvb, offset, 2,\r\nENC_LITTLE_ENDIAN);\r\ncase ZBEE_ZCL_CMD_ID_IAS_ZONE_ENROLL_REQUEST:\r\ndefault:\r\nbreak;\r\n}\r\n}\r\nreturn tvb_reported_length(tvb);\r\n}\r\nstatic void\r\ndissect_zcl_ias_zone_attr_data(proto_tree *tree, tvbuff_t *tvb, guint *offset, guint16 attr_id, guint data_type)\r\n{\r\nswitch (attr_id) {\r\ncase ZBEE_ZCL_ATTR_ID_IAS_ZONE_STATE:\r\nproto_tree_add_item(tree, hf_zbee_zcl_ias_zone_state, tvb, *offset, 1, ENC_NA);\r\n*offset += 1;\r\nbreak;\r\ncase ZBEE_ZCL_ATTR_ID_IAS_ZONE_TYPE:\r\nproto_tree_add_item(tree, hf_zbee_zcl_ias_zone_type, tvb, *offset, 2, ENC_LITTLE_ENDIAN);\r\n*offset += 2;\r\nbreak;\r\ncase ZBEE_ZCL_ATTR_ID_IAS_ZONE_STATUS:\r\ndissect_zcl_ias_zone_status(tree, tvb, *offset);\r\n*offset += 2;\r\nbreak;\r\ncase ZBEE_ZCL_ATTR_ID_IAS_CIE_ADDRESS:\r\ndefault:\r\ndissect_zcl_attr_data(tvb, tree, offset, data_type);\r\nbreak;\r\n}\r\n}\r\nvoid\r\nproto_reg_handoff_zbee_zcl_ias_zone(void)\r\n{\r\ndissector_handle_t zone_handle;\r\nzone_handle = find_dissector(ZBEE_PROTOABBREV_ZCL_IAS_ZONE);\r\ndissector_add_uint("zbee.zcl.cluster", ZBEE_ZCL_CID_IAS_ZONE, zone_handle);\r\nzbee_zcl_init_cluster( proto_zbee_zcl_ias_zone,\r\nett_zbee_zcl_ias_zone,\r\nZBEE_ZCL_CID_IAS_ZONE,\r\nhf_zbee_zcl_ias_zone_attr_id,\r\nhf_zbee_zcl_ias_zone_srv_rx_cmd_id,\r\nhf_zbee_zcl_ias_zone_srv_tx_cmd_id,\r\n(zbee_zcl_fn_attr_data)dissect_zcl_ias_zone_attr_data\r\n);\r\n}\r\nvoid\r\nproto_register_zbee_zcl_ias_zone(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_zbee_zcl_ias_zone_attr_id,\r\n{ "Attribute", "zbee_zcl_ias.zone.attr_id", FT_UINT16, BASE_HEX, VALS(zbee_zcl_ias_zone_attr_names),\r\n0x0, NULL, HFILL } },\r\n{ &hf_zbee_zcl_ias_zone_srv_rx_cmd_id,\r\n{ "Command", "zbee_zcl_ias.zone.cmd.srv_rx.id", FT_UINT8, BASE_HEX,\r\nVALS(zbee_zcl_ias_zone_srv_rx_cmd_names), 0x0, NULL, HFILL }},\r\n{ &hf_zbee_zcl_ias_zone_srv_tx_cmd_id,\r\n{ "Command", "zbee_zcl_ias.zone.cmd.srv_tx.id", FT_UINT8, BASE_HEX,\r\nVALS(zbee_zcl_ias_zone_srv_tx_cmd_names), 0x0, NULL, HFILL }},\r\n{ &hf_zbee_zcl_ias_zone_enroll_code,\r\n{ "Enroll response code", "zbee_zcl_ias.zone.enroll_code", FT_UINT8, BASE_HEX,\r\nVALS(zbee_zcl_ias_zone_enroll_code_names), 0x0, NULL, HFILL }},\r\n{ &hf_zbee_zcl_ias_zone_zone_id,\r\n{ "Zone ID", "zbee_zcl_ias.zone.zone_id", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_zbee_zcl_ias_zone_state,\r\n{ "ZoneState", "zbee_zcl_ias.zone.state", FT_UINT16, BASE_HEX, VALS(zbee_ias_state_names), 0x0, NULL, HFILL }},\r\n{ &hf_zbee_zcl_ias_zone_type,\r\n{ "ZoneType", "zbee_zcl_ias.zone.type", FT_UINT16, BASE_HEX, VALS(zbee_ias_type_names), 0x0, NULL, HFILL }},\r\n{ &hf_zbee_zcl_ias_zone_status,\r\n{ "ZoneStatus", "zbee_zcl_ias.zone.status", FT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_zbee_zcl_ias_zone_delay,\r\n{ "Delay (in quarterseconds)", "zbee_zcl_ias.zone.delay", FT_UINT16, BASE_DEC, NULL, 0x0, NULL,\r\nHFILL }},\r\n{ &hf_zbee_zcl_ias_zone_ext_status,\r\n{ "Extended Status", "zbee_zcl_ias.zone.ext_status", FT_UINT8, BASE_HEX, NULL, 0x0, NULL,\r\nHFILL }},\r\n{ &hf_zbee_zcl_ias_zone_status_alarm1,\r\n{ "Alarm 1", "zbee_zcl_ias.zone.status.alarm_1", FT_BOOLEAN, 16, TFS(&tfs_alarmed_or_not), ZBEE_IAS_ZONE_STATUS_ALARM1, NULL,\r\nHFILL }},\r\n{ &hf_zbee_zcl_ias_zone_status_alarm2,\r\n{ "Alarm 2", "zbee_zcl_ias.zone.status.alarm_2", FT_BOOLEAN, 16, TFS(&tfs_alarmed_or_not), ZBEE_IAS_ZONE_STATUS_ALARM2, NULL,\r\nHFILL }},\r\n{ &hf_zbee_zcl_ias_zone_status_battery,\r\n{ "Battery", "zbee_zcl_ias.zone.status.battery", FT_BOOLEAN, 16, TFS(&tfs_battery), ZBEE_IAS_ZONE_STATUS_BATTERY, NULL,\r\nHFILL }},\r\n{ &hf_zbee_zcl_ias_zone_status_tamper,\r\n{ "Tamper", "zbee_zcl_ias.zone.status.tamper", FT_BOOLEAN, 16, TFS(&tfs_tampered_or_not), ZBEE_IAS_ZONE_STATUS_TAMPER, NULL,\r\nHFILL }},\r\n{ &hf_zbee_zcl_ias_zone_status_supervision_reports,\r\n{ "Supervision Reports", "zbee_zcl_ias.zone.status.supervision_reports", FT_BOOLEAN, 16,\r\nTFS(&tfs_reports_or_not), ZBEE_IAS_ZONE_STATUS_SUPERVISION, NULL, HFILL }},\r\n{ &hf_zbee_zcl_ias_zone_status_restore_reports,\r\n{ "Restore Reports", "zbee_zcl_ias.zone.status.restore_reports", FT_BOOLEAN, 16,\r\nTFS(&tfs_reports_restore), ZBEE_IAS_ZONE_STATUS_RESTORE, NULL, HFILL }},\r\n{ &hf_zbee_zcl_ias_zone_status_trouble,\r\n{ "Trouble", "zbee_zcl_ias.zone.status.trouble", FT_BOOLEAN, 16, TFS(&tfs_trouble_failure), ZBEE_IAS_ZONE_STATUS_TROUBLE, NULL,\r\nHFILL }},\r\n{ &hf_zbee_zcl_ias_zone_status_ac_mains,\r\n{ "AC (mains)", "zbee_zcl_ias.zone.status.ac_mains", FT_BOOLEAN, 16, TFS(&tfs_ac_mains), ZBEE_IAS_ZONE_STATUS_AC_MAINS, NULL,\r\nHFILL }}\r\n};\r\nstatic gint *ett[ZBEE_ZCL_IAS_ZONE_NUM_ETT];\r\nett[0] = &ett_zbee_zcl_ias_zone;\r\nett[1] = &ett_zbee_zcl_ias_zone_status;\r\nproto_zbee_zcl_ias_zone = proto_register_protocol("ZigBee ZCL IAS Zone", "ZCL IAS Zone", ZBEE_PROTOABBREV_ZCL_IAS_ZONE);\r\nproto_register_field_array(proto_zbee_zcl_ias_zone, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nregister_dissector(ZBEE_PROTOABBREV_ZCL_IAS_ZONE, dissect_zbee_zcl_ias_zone, proto_zbee_zcl_ias_zone);\r\n}
