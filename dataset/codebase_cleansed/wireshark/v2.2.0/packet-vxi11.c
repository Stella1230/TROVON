static int\r\ndissect_error(tvbuff_t *tvb,\r\nint offset,\r\npacket_info *pinfo,\r\nproto_tree *tree,\r\nconst gchar *packet_type,\r\nguint32 *error)\r\n{\r\nconst gchar *errstr;\r\n*error = tvb_get_ntohl(tvb, offset);\r\nerrstr = val_to_str(*error, vxi11_core_error_vals, "Error %d");\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_error, offset);\r\nif (tree)\r\n{\r\nproto_item_append_text(tree, " (%s) %s", packet_type, errstr);\r\n}\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " %s", errstr);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_flags(tvbuff_t *tvb, int offset, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nguint32 flags =\r\ntvb_get_ntohl(tvb, offset);\r\nproto_item *flags_item =\r\nproto_tree_add_item(tree, hf_vxi11_core_flags, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nif (flags_item)\r\n{\r\nproto_tree *flags_tree =\r\nproto_item_add_subtree(flags_item, ett_vxi11_core_flags);\r\nproto_tree_add_item(flags_tree, hf_vxi11_core_flag_wait_lock, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(flags_tree, hf_vxi11_core_flag_end, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(flags_tree, hf_vxi11_core_flag_term_chr_set, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nif (flags != 0)\r\n{\r\nwmem_strbuf_t *strbuf = wmem_strbuf_new_label(wmem_packet_scope());\r\nif (flags & VXI11_CORE_FLAG_WAITLOCK)\r\n{\r\nwmem_strbuf_append(strbuf, "WAIT_LOCK, ");\r\n}\r\nif (flags & VXI11_CORE_FLAG_END)\r\n{\r\nwmem_strbuf_append(strbuf, "END, ");\r\n}\r\nif (flags & VXI11_CORE_FLAG_TERMCHRSET)\r\n{\r\nwmem_strbuf_append(strbuf, "TERM_CHR_SET, ");\r\n}\r\nwmem_strbuf_truncate(strbuf, wmem_strbuf_get_len(strbuf) - 2);\r\nproto_item_append_text(flags_item, " (%s)", wmem_strbuf_get_str(strbuf));\r\n}\r\n}\r\n}\r\nreturn offset + 4;\r\n}\r\nstatic int\r\ndissect_reason(tvbuff_t *tvb, int offset, proto_tree *tree)\r\n{\r\nif (tree)\r\n{\r\nguint32 reason =\r\ntvb_get_ntohl(tvb, offset);\r\nproto_item *reason_item =\r\nproto_tree_add_item(tree, hf_vxi11_core_reason, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nif (reason_item)\r\n{\r\nproto_tree *reason_tree =\r\nproto_item_add_subtree(reason_item, ett_vxi11_core_reason);\r\nproto_tree_add_item(reason_tree, hf_vxi11_core_reason_req_cnt, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(reason_tree, hf_vxi11_core_reason_chr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(reason_tree, hf_vxi11_core_reason_end, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nif (reason != 0)\r\n{\r\nwmem_strbuf_t *strbuf = wmem_strbuf_new_label(wmem_packet_scope());\r\nif (reason & VXI11_CORE_REASON_REQCNT)\r\n{\r\nwmem_strbuf_append(strbuf, "REQ_CNT, ");\r\n}\r\nif (reason & VXI11_CORE_REASON_CHR)\r\n{\r\nwmem_strbuf_append(strbuf, "CHR, ");\r\n}\r\nif (reason & VXI11_CORE_REASON_END)\r\n{\r\nwmem_strbuf_append(strbuf, "END, ");\r\n}\r\nwmem_strbuf_truncate(strbuf, wmem_strbuf_get_len(strbuf) - 2);\r\nproto_item_append_text(reason_item, " (%s)", wmem_strbuf_get_str(strbuf));\r\n}\r\n}\r\n}\r\nreturn offset + 4;\r\n}\r\nstatic int\r\ndissect_create_link_parms(tvbuff_t *tvb,\r\npacket_info *pinfo,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nconst char *str;\r\nint offset = 0;\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_client_id, offset);\r\noffset = dissect_rpc_bool(tvb, tree, hf_vxi11_core_lock_device, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_lock_timeout, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_vxi11_core_device, offset, &str);\r\nproto_item_append_text(tree, " (Create_LinkParms) %s", str);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " %s", str);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_create_link_resp(tvbuff_t *tvb,\r\npacket_info *pinfo,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nguint32 error, lid;\r\nint offset = 0;\r\noffset = dissect_error(tvb, offset, pinfo, tree, "Create_LinkResp", &error);\r\nlid = tvb_get_ntohl(tvb, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_lid, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_abort_port, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_max_recv_size, offset);\r\nif (error == VXI11_CORE_ERROR_NO_ERROR)\r\n{\r\nproto_item_append_text(tree, " LID=%d", lid);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " LID=%d", lid);\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_device_SRQ_parms(tvbuff_t *tvb,\r\npacket_info *pinfo _U_,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nint offset = dissect_rpc_opaque_data(tvb, 0, tree, NULL, hf_vxi11_intr_handle, FALSE, 0, FALSE, NULL, NULL);\r\nproto_item_append_text(tree, " (Device_SrqParms)");\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_device_docmd_parms(tvbuff_t *tvb,\r\npacket_info *pinfo,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nguint32 lid, cmd;\r\nconst gchar *cmdstr;\r\nint offset = 0;\r\nlid = tvb_get_ntohl(tvb, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_lid, offset);\r\noffset = dissect_flags(tvb, offset, tree);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_io_timeout, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_lock_timeout, offset);\r\ncmd = tvb_get_ntohl(tvb, offset);\r\ncmdstr = val_to_str(cmd, vxi11_core_cmd_vals, "Unknown(0x%x)");\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_cmd, offset);\r\noffset = dissect_rpc_bool(tvb, tree, hf_vxi11_core_network_order, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_size, offset);\r\noffset = dissect_rpc_opaque_data(tvb, offset, tree, NULL, hf_vxi11_core_data, FALSE, 0, FALSE, NULL, NULL);\r\nif (tree)\r\n{\r\nproto_item_append_text(tree, " (Device_DocmdParms) LID=%d CMD=%s", lid, cmdstr);\r\n}\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " LID=%d CMD=%s", lid, cmdstr);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_device_docmd_resp(tvbuff_t *tvb,\r\npacket_info *pinfo,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nguint32 error;\r\nint offset = 0;\r\noffset = dissect_error(tvb, offset, pinfo, tree, "Device_DocmdResp", &error);\r\noffset = dissect_rpc_opaque_data(tvb, offset, tree, NULL, hf_vxi11_core_data, FALSE, 0, FALSE, NULL, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_device_enable_SRQ_parms(tvbuff_t *tvb,\r\npacket_info *pinfo,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\nguint32 lid = tvb_get_ntohl(tvb, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_lid, offset);\r\noffset = dissect_rpc_bool(tvb, tree, hf_vxi11_core_enable, offset);\r\noffset = dissect_rpc_opaque_data(tvb, offset, tree, NULL, hf_vxi11_core_handle, FALSE, 0, FALSE, NULL, NULL);\r\nif (tree)\r\n{\r\nproto_item_append_text(tree, " (Device_EnableSrqParms) LID=%d", lid);\r\n}\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " LID=%d", lid);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_device_error(tvbuff_t *tvb,\r\npacket_info *pinfo,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nguint32 error;\r\nreturn dissect_error(tvb, 0, pinfo, tree, "Device_Error", &error);\r\n}\r\nstatic int\r\ndissect_device_generic_parms(tvbuff_t *tvb,\r\npacket_info *pinfo,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\nguint32 lid = tvb_get_ntohl(tvb, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_lid, offset);\r\noffset = dissect_flags(tvb, offset, tree);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_io_timeout, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_lock_timeout, offset);\r\nif (tree)\r\n{\r\nproto_item_append_text(tree, " (Device_GenericParms) LID=%d", lid);\r\n}\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " LID=%d", lid);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_device_link(tvbuff_t *tvb,\r\npacket_info *pinfo,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\nguint32 lid = tvb_get_ntohl(tvb, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_lid, offset);\r\nif (tree)\r\n{\r\nproto_item_append_text(tree, " (Device_Link) LID=%d", lid);\r\n}\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " LID=%d", lid);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_device_lock_parms(tvbuff_t *tvb,\r\npacket_info *pinfo,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\nguint32 lid = tvb_get_ntohl(tvb, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_lid, offset);\r\noffset = dissect_flags(tvb, offset, tree);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_lock_timeout, offset);\r\nif (tree)\r\n{\r\nproto_item_append_text(tree, " (Device_LockParms) LID=%d", lid);\r\n}\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " LID=%d", lid);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_device_read_parms(tvbuff_t *tvb,\r\npacket_info *pinfo,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\nguint32 lid = tvb_get_ntohl(tvb, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_lid, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_size, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_io_timeout, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_lock_timeout, offset);\r\noffset = dissect_flags(tvb, offset, tree);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_term_char, offset);\r\nproto_item_append_text(tree, " (Device_ReadParms) LID=%d", lid);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " LID=%d", lid);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_device_read_resp(tvbuff_t *tvb,\r\npacket_info *pinfo,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nguint32 error;\r\nint offset = 0;\r\nguint32 datalength = 0;\r\noffset = dissect_error(tvb, offset, pinfo, tree, "Device_ReadResp", &error);\r\noffset = dissect_reason(tvb, offset, tree);\r\ndatalength = tvb_get_ntohl( tvb, offset);\r\nif(MAX_DATA_SHOW_SIZE <=datalength)\r\ndatalength = MAX_DATA_SHOW_SIZE;\r\ncol_append_fstr( pinfo->cinfo, COL_INFO," %s",tvb_format_text(tvb, offset+4,(guint32) datalength));\r\noffset = dissect_rpc_opaque_data(tvb, offset, tree, NULL, hf_vxi11_core_data, FALSE, 0, FALSE, NULL, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_device_readstb_resp(tvbuff_t *tvb,\r\npacket_info *pinfo,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nguint32 error, stb;\r\nint offset = 0;\r\noffset = dissect_error(tvb, offset, pinfo, tree, "Device_ReadStbResp", &error);\r\nstb = tvb_get_ntohl(tvb, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_stb, offset);\r\nif (error == VXI11_CORE_ERROR_NO_ERROR)\r\n{\r\nproto_item_append_text(tree, " STB=0x%02x", stb);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " STB=0x%02x", stb);\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_device_remote_func(tvbuff_t *tvb,\r\npacket_info *pinfo,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nguint32 port;\r\nconst gchar *addrstr;\r\nint offset = 0;\r\naddrstr = tvb_ip_to_str(tvb, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_host_addr, offset);\r\nport = tvb_get_ntohl(tvb, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_host_port, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_prog_num, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_prog_vers, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_prog_family, offset);\r\nproto_item_append_text(tree, " (Device_RemoteFunc) %s:%d", addrstr, port);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " %s:%d", addrstr, port);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_device_write_parms(tvbuff_t *tvb,\r\npacket_info *pinfo,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nguint32 datalength = 0;\r\nint offset = 0;\r\nguint32 lid = tvb_get_ntohl(tvb, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_lid, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_io_timeout, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_lock_timeout, offset);\r\noffset = dissect_flags(tvb, offset, tree);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " LID=%d", lid);\r\ndatalength = tvb_get_ntohl( tvb, offset);\r\nif(MAX_DATA_SHOW_SIZE <=datalength)\r\ndatalength = MAX_DATA_SHOW_SIZE;\r\ncol_append_fstr( pinfo->cinfo, COL_INFO," %s",tvb_format_text(tvb, offset+4,(guint32) datalength));\r\noffset = dissect_rpc_opaque_data(tvb, offset, tree, NULL, hf_vxi11_core_data, FALSE, 0, FALSE, NULL, NULL);\r\nif (tree)\r\n{\r\nproto_item_append_text(tree, " (Device_WriteParms) LID=%d", lid);\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_device_write_resp(tvbuff_t *tvb,\r\npacket_info *pinfo,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nguint32 error;\r\nint offset = 0;\r\noffset = dissect_error(tvb, offset, pinfo, tree, "Device_WriteResp", &error);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_vxi11_core_size, offset);\r\nreturn offset;\r\n}\r\nvoid\r\nproto_register_vxi11_core(void)\r\n{\r\nstatic const value_string vxi11_core_v1_proc_vals[] = {\r\n{ VXI11_CORE_PROC_NULL, "NULL" },\r\n{ VXI11_CORE_PROC_CREATE_LINK, "CREATE_LINK" },\r\n{ VXI11_CORE_PROC_DEVICE_WRITE, "DEVICE_WRITE" },\r\n{ VXI11_CORE_PROC_DEVICE_READ, "DEVICE_READ" },\r\n{ VXI11_CORE_PROC_DEVICE_READSTB, "DEVICE_READSTB" },\r\n{ VXI11_CORE_PROC_DEVICE_TRIGGER, "DEVICE_TRIGGER" },\r\n{ VXI11_CORE_PROC_DEVICE_CLEAR, "DEVICE_CLEAR" },\r\n{ VXI11_CORE_PROC_DEVICE_REMOTE, "DEVICE_REMOTE" },\r\n{ VXI11_CORE_PROC_DEVICE_LOCAL, "DEVICE_LOCAL" },\r\n{ VXI11_CORE_PROC_DEVICE_LOCK, "DEVICE_LOCK" },\r\n{ VXI11_CORE_PROC_DEVICE_UNLOCK, "DEVICE_UNLOCK" },\r\n{ VXI11_CORE_PROC_DEVICE_ENABLE_SRQ, "DEVICE_ENABLE_SRQ" },\r\n{ VXI11_CORE_PROC_DEVICE_DOCMD, "DEVICE_DOCMD" },\r\n{ VXI11_CORE_PROC_DESTROY_LINK, "DESTROY_LINK" },\r\n{ VXI11_CORE_PROC_CREATE_INTR_CHAN, "CREATE_INTR_CHAN" },\r\n{ VXI11_CORE_PROC_DESTROY_INTR_CHAN, "DESTROY_INTR_CHAN" },\r\n{ 0, NULL }\r\n};\r\nstatic const value_string vxi11_core_addr_family_vals[] = {\r\n{ VXI11_CORE_ADDRESS_FAMILY_TCP, "TCP" },\r\n{ VXI11_CORE_ADDRESS_FAMILY_UDP, "UDP" },\r\n{ 0, NULL }\r\n};\r\nstatic hf_register_info vxi11_core_hf[] = {\r\n{ &hf_vxi11_core_procedure_v1,\r\n{\r\n"V1 Procedure", "vxi11_core.procedure_v1", FT_UINT32, BASE_DEC,\r\nVALS(vxi11_core_v1_proc_vals), 0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_abort_port,\r\n{\r\n"Abort Port", "vxi11_core.abort_port", FT_UINT16, BASE_DEC,\r\nNULL, 0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_client_id,\r\n{\r\n"Client ID", "vxi11_core.client_id", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_cmd,\r\n{\r\n"Command", "vxi11_core.cmd", FT_UINT32, BASE_HEX,\r\nVALS(vxi11_core_cmd_vals), 0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_data,\r\n{\r\n"Data", "vxi11_core.data", FT_BYTES, BASE_NONE,\r\nNULL, 0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_device,\r\n{\r\n"Device Name", "vxi11_core.device", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_enable,\r\n{\r\n"Enable", "vxi11_core.enable", FT_BOOLEAN, BASE_NONE,\r\nTFS(&tfs_yes_no), 0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_error,\r\n{\r\n"Error Code", "vxi11_core.error", FT_UINT32, BASE_DEC,\r\nVALS(vxi11_core_error_vals), 0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_flags,\r\n{\r\n"Flags", "vxi11_core.flags", FT_UINT32, BASE_HEX,\r\nNULL, 0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_flag_wait_lock,\r\n{\r\n"Wait Until Locked", "vxi11_core.flags.wait_lock", FT_BOOLEAN, 32,\r\nNULL, VXI11_CORE_FLAG_WAITLOCK, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_flag_end,\r\n{\r\n"Set EOI", "vxi11_core.flags.end", FT_BOOLEAN, 32,\r\nNULL, VXI11_CORE_FLAG_END, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_flag_term_chr_set,\r\n{\r\n"Termination Character Set", "vxi11_core.flags.term_chr_set", FT_BOOLEAN, 32,\r\nNULL, VXI11_CORE_FLAG_TERMCHRSET, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_handle,\r\n{\r\n"Handle", "vxi11_core.handle", FT_BYTES, BASE_NONE,\r\nNULL, 0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_host_addr,\r\n{\r\n"Host Address", "vxi11_core.host_addr", FT_UINT32, BASE_HEX,\r\nNULL, 0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_host_port,\r\n{\r\n"Host Port", "vxi11_core.host_port", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_io_timeout,\r\n{\r\n"I/O Timeout", "vxi11_core.io_timeout", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_lid,\r\n{\r\n"Link ID", "vxi11_core.lid", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_lock_device,\r\n{\r\n"Lock Device", "vxi11_core.lock_device", FT_BOOLEAN, BASE_NONE,\r\nTFS(&tfs_yes_no), 0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_lock_timeout,\r\n{\r\n"Lock Timeout", "vxi11_core.lock_timeout", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_max_recv_size,\r\n{\r\n"Maximum Receive Size", "vxi11_core.max_recv_size", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_network_order,\r\n{\r\n"Network Byte Order", "vxi11_core.network_order", FT_BOOLEAN, BASE_NONE,\r\nTFS(&tfs_yes_no), 0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_prog_family,\r\n{\r\n"Address Family", "vxi11_core.prog_family", FT_UINT32, BASE_DEC,\r\nVALS(vxi11_core_addr_family_vals), 0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_prog_num,\r\n{\r\n"Program", "vxi11_core.prog_num", FT_UINT32, BASE_HEX,\r\nNULL, 0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_prog_vers,\r\n{\r\n"Version", "vxi11_core.prog_vers", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_reason,\r\n{\r\n"Reason", "vxi11_core.reason", FT_UINT32, BASE_HEX,\r\nNULL, 0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_reason_req_cnt,\r\n{\r\n"Requested Count Reached", "vxi11_core.reason.req_cnt", FT_BOOLEAN, 32,\r\nNULL, VXI11_CORE_REASON_REQCNT, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_reason_chr,\r\n{\r\n"Termination Character Seen", "vxi11_core.reason.chr", FT_BOOLEAN, 32,\r\nNULL, VXI11_CORE_REASON_CHR, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_reason_end,\r\n{\r\n"EOI Set", "vxi11_core.reason.end", FT_BOOLEAN, 32,\r\nNULL, VXI11_CORE_REASON_END, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_size,\r\n{\r\n"Size", "vxi11_core.size", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_stb,\r\n{\r\n"Status Byte", "vxi11_core.stb", FT_UINT8, BASE_HEX,\r\nNULL, 0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_core_term_char,\r\n{\r\n"Termination Character", "vxi11_core.term_char", FT_UINT8, BASE_HEX,\r\nNULL, 0, NULL, HFILL\r\n}\r\n}\r\n};\r\nstatic gint *vxi11_core_ett[] = {\r\n&ett_vxi11_core,\r\n&ett_vxi11_core_flags,\r\n&ett_vxi11_core_reason\r\n};\r\nproto_vxi11_core = proto_register_protocol("VXI-11 Core Protocol",\r\n"VXI-11 Core",\r\n"vxi11_core");\r\nproto_register_field_array(proto_vxi11_core, vxi11_core_hf, array_length(vxi11_core_hf));\r\nproto_register_subtree_array(vxi11_core_ett, array_length(vxi11_core_ett));\r\n}\r\nvoid\r\nproto_reg_handoff_vxi11_core(void)\r\n{\r\nstatic const vsff vxi111_core_proc[] = {\r\n{ VXI11_CORE_PROC_NULL, "NULL",\r\ndissect_rpc_void, dissect_rpc_void },\r\n{ VXI11_CORE_PROC_CREATE_LINK, "CREATE_LINK",\r\ndissect_create_link_parms, dissect_create_link_resp },\r\n{ VXI11_CORE_PROC_DEVICE_WRITE, "DEVICE_WRITE",\r\ndissect_device_write_parms, dissect_device_write_resp },\r\n{ VXI11_CORE_PROC_DEVICE_READ, "DEVICE_READ",\r\ndissect_device_read_parms, dissect_device_read_resp },\r\n{ VXI11_CORE_PROC_DEVICE_READSTB, "DEVICE_READSTB",\r\ndissect_device_generic_parms, dissect_device_readstb_resp },\r\n{ VXI11_CORE_PROC_DEVICE_TRIGGER, "DEVICE_TRIGGER",\r\ndissect_device_generic_parms, dissect_device_error },\r\n{ VXI11_CORE_PROC_DEVICE_CLEAR, "DEVICE_CLEAR",\r\ndissect_device_generic_parms, dissect_device_error },\r\n{ VXI11_CORE_PROC_DEVICE_REMOTE, "DEVICE_REMOTE",\r\ndissect_device_generic_parms, dissect_device_error },\r\n{ VXI11_CORE_PROC_DEVICE_LOCAL, "DEVICE_LOCAL",\r\ndissect_device_generic_parms, dissect_device_error },\r\n{ VXI11_CORE_PROC_DEVICE_LOCK, "DEVICE_LOCK",\r\ndissect_device_lock_parms, dissect_device_error },\r\n{ VXI11_CORE_PROC_DEVICE_UNLOCK, "DEVICE_UNLOCK",\r\ndissect_device_link, dissect_device_error },\r\n{ VXI11_CORE_PROC_DEVICE_ENABLE_SRQ, "DEVICE_ENABLE_SRQ",\r\ndissect_device_enable_SRQ_parms, dissect_device_error },\r\n{ VXI11_CORE_PROC_DEVICE_DOCMD, "DEVICE_DOCMD",\r\ndissect_device_docmd_parms, dissect_device_docmd_resp },\r\n{ VXI11_CORE_PROC_DESTROY_LINK, "DESTROY_LINK",\r\ndissect_device_link, dissect_device_error },\r\n{ VXI11_CORE_PROC_CREATE_INTR_CHAN, "CREATE_INTR_CHAN",\r\ndissect_device_remote_func, dissect_device_error },\r\n{ VXI11_CORE_PROC_DESTROY_INTR_CHAN, "DESTROY_INTR_CHAN",\r\ndissect_rpc_void, dissect_device_error },\r\n{ 0, NULL, NULL, NULL }\r\n};\r\nstatic const rpc_prog_vers_info vxi11_core_vers_info[] = {\r\n{ VXI11_CORE_VERSION, vxi111_core_proc, &hf_vxi11_core_procedure_v1 },\r\n};\r\nrpc_init_prog(proto_vxi11_core, VXI11_CORE_PROGRAM, ett_vxi11_core,\r\nG_N_ELEMENTS(vxi11_core_vers_info), vxi11_core_vers_info);\r\n}\r\nvoid\r\nproto_register_vxi11_async(void)\r\n{\r\nstatic const value_string vxi11_async_v1_proc_vals[] = {\r\n{ VXI11_ASYNC_PROC_NULL, "NULL" },\r\n{ VXI11_ASYNC_PROC_DEVICE_ABORT, "DEVICE_ABORT" },\r\n{ 0, NULL }\r\n};\r\nstatic hf_register_info vxi11_async_hf[] = {\r\n{ &hf_vxi11_async_procedure_v1,\r\n{\r\n"V1 Procedure", "vxi11_async.procedure_v1", FT_UINT32, BASE_DEC,\r\nVALS(vxi11_async_v1_proc_vals), 0, NULL, HFILL\r\n}\r\n}\r\n};\r\nstatic gint *vxi11_async_ett[] = {\r\n&ett_vxi11_async,\r\n};\r\nproto_vxi11_async = proto_register_protocol("VXI-11 Asynchronous Abort",\r\n"VXI-11 Async",\r\n"vxi11_async");\r\nproto_register_field_array(proto_vxi11_async, vxi11_async_hf, array_length(vxi11_async_hf));\r\nproto_register_subtree_array(vxi11_async_ett, array_length(vxi11_async_ett));\r\n}\r\nvoid\r\nproto_reg_handoff_vxi11_async(void)\r\n{\r\nstatic const vsff vxi111_async_proc[] = {\r\n{ VXI11_ASYNC_PROC_NULL, "NULL",\r\ndissect_rpc_void, dissect_rpc_void },\r\n{ VXI11_ASYNC_PROC_DEVICE_ABORT, "DEVICE_ABORT",\r\ndissect_device_link, dissect_device_error },\r\n{ 0, NULL, NULL, NULL }\r\n};\r\nstatic const rpc_prog_vers_info vxi11_async_vers_info[] = {\r\n{ VXI11_ASYNC_VERSION, vxi111_async_proc, &hf_vxi11_async_procedure_v1 },\r\n};\r\nrpc_init_prog(proto_vxi11_async, VXI11_ASYNC_PROGRAM, ett_vxi11_async,\r\nG_N_ELEMENTS(vxi11_async_vers_info), vxi11_async_vers_info);\r\n}\r\nvoid\r\nproto_register_vxi11_intr(void)\r\n{\r\nstatic const value_string vxi11_intr_v1_proc_vals[] = {\r\n{ VXI11_INTR_PROC_NULL, "NULL" },\r\n{ VXI11_INTR_PROC_DEVICE_INTR_SRQ, "DEVICE_INTR_SRQ" },\r\n{ 0, NULL }\r\n};\r\nstatic hf_register_info vxi11_intr_hf[] = {\r\n{ &hf_vxi11_intr_procedure_v1,\r\n{\r\n"V1 Procedure", "vxi11_intr.procedure_v1", FT_UINT32, BASE_DEC,\r\nVALS(vxi11_intr_v1_proc_vals), 0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_vxi11_intr_handle,\r\n{\r\n"Handle", "vxi11_intr.handle", FT_BYTES, BASE_NONE,\r\nNULL, 0, NULL, HFILL\r\n}\r\n}\r\n};\r\nstatic gint *vxi11_intr_ett[] = {\r\n&ett_vxi11_intr,\r\n};\r\nproto_vxi11_intr = proto_register_protocol("VXI-11 Interrupt",\r\n"VXI-11 Intr",\r\n"vxi11_intr");\r\nproto_register_field_array(proto_vxi11_intr, vxi11_intr_hf, array_length(vxi11_intr_hf));\r\nproto_register_subtree_array(vxi11_intr_ett, array_length(vxi11_intr_ett));\r\n}\r\nvoid\r\nproto_reg_handoff_vxi11_intr(void)\r\n{\r\nstatic const vsff vxi111_intr_proc[] = {\r\n{ VXI11_INTR_PROC_NULL, "NULL",\r\ndissect_rpc_void, dissect_rpc_void },\r\n{ VXI11_INTR_PROC_DEVICE_INTR_SRQ, "DEVICE_INTR_SRQ",\r\ndissect_device_SRQ_parms, dissect_rpc_void },\r\n{ 0, NULL, NULL, NULL }\r\n};\r\nstatic const rpc_prog_vers_info vxi11_intr_vers_info[] = {\r\n{ VXI11_INTR_VERSION, vxi111_intr_proc, &hf_vxi11_intr_procedure_v1 },\r\n};\r\nrpc_init_prog(proto_vxi11_intr, VXI11_INTR_PROGRAM, ett_vxi11_intr,\r\nG_N_ELEMENTS(vxi11_intr_vers_info), vxi11_intr_vers_info);\r\n}
