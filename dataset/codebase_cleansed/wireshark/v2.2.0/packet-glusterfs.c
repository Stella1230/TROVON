static int\r\nglusterfs_rpc_dissect_gfid(proto_tree *tree, tvbuff_t *tvb, int hfindex, int offset)\r\n{\r\nif (tree)\r\nproto_tree_add_item(tree, hfindex, tvb, offset, 16, ENC_NA);\r\noffset += 16;\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_rpc_dissect_mode(proto_tree *tree, tvbuff_t *tvb, int hfindex,\r\nint offset)\r\n{\r\nstatic const int *mode_bits[] = {\r\n&hf_glusterfs_mode_suid,\r\n&hf_glusterfs_mode_sgid,\r\n&hf_glusterfs_mode_svtx,\r\n&hf_glusterfs_mode_rusr,\r\n&hf_glusterfs_mode_wusr,\r\n&hf_glusterfs_mode_xusr,\r\n&hf_glusterfs_mode_rgrp,\r\n&hf_glusterfs_mode_wgrp,\r\n&hf_glusterfs_mode_xgrp,\r\n&hf_glusterfs_mode_roth,\r\n&hf_glusterfs_mode_woth,\r\n&hf_glusterfs_mode_xoth,\r\n&hf_glusterfs_mode_reserved,\r\nNULL\r\n};\r\nif (tree)\r\nproto_tree_add_bitmask(tree, tvb, offset, hfindex,\r\nett_glusterfs_mode, mode_bits, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nint\r\nglusterfs_rpc_dissect_gf_iatt(proto_tree *tree, tvbuff_t *tvb, int hfindex,\r\nint offset)\r\n{\r\nproto_item *iatt_item;\r\nproto_tree *iatt_tree;\r\nnstime_t timestamp;\r\nint start_offset = offset;\r\niatt_item = proto_tree_add_item(tree, hfindex, tvb, offset, -1,\r\nENC_NA);\r\niatt_tree = proto_item_add_subtree(iatt_item, ett_glusterfs_iatt);\r\noffset = glusterfs_rpc_dissect_gfid(iatt_tree, tvb, hf_glusterfs_gfid,\r\noffset);\r\noffset = dissect_rpc_uint64(tvb, iatt_tree, hf_glusterfs_ia_ino,\r\noffset);\r\noffset = dissect_rpc_uint64(tvb, iatt_tree, hf_glusterfs_ia_dev,\r\noffset);\r\noffset = glusterfs_rpc_dissect_mode(iatt_tree, tvb,\r\nhf_glusterfs_ia_mode, offset);\r\noffset = dissect_rpc_uint32(tvb, iatt_tree, hf_glusterfs_ia_nlink,\r\noffset);\r\noffset = dissect_rpc_uint32(tvb, iatt_tree, hf_glusterfs_ia_uid,\r\noffset);\r\noffset = dissect_rpc_uint32(tvb, iatt_tree, hf_glusterfs_ia_gid,\r\noffset);\r\noffset = dissect_rpc_uint64(tvb, iatt_tree, hf_glusterfs_ia_rdev,\r\noffset);\r\noffset = dissect_rpc_uint64(tvb, iatt_tree, hf_glusterfs_ia_size,\r\noffset);\r\noffset = dissect_rpc_uint32(tvb, iatt_tree, hf_glusterfs_ia_blksize,\r\noffset);\r\noffset = dissect_rpc_uint64(tvb, iatt_tree, hf_glusterfs_ia_blocks,\r\noffset);\r\ntimestamp.secs = tvb_get_ntohl(tvb, offset);\r\ntimestamp.nsecs = tvb_get_ntohl(tvb, offset + 4);\r\nif (tree)\r\nproto_tree_add_time(iatt_tree, hf_glusterfs_ia_atime, tvb,\r\noffset, 8, &timestamp);\r\noffset += 8;\r\ntimestamp.secs = tvb_get_ntohl(tvb, offset);\r\ntimestamp.nsecs = tvb_get_ntohl(tvb, offset + 4);\r\nif (tree)\r\nproto_tree_add_time(iatt_tree, hf_glusterfs_ia_mtime, tvb,\r\noffset, 8, &timestamp);\r\noffset += 8;\r\ntimestamp.secs = tvb_get_ntohl(tvb, offset);\r\ntimestamp.nsecs = tvb_get_ntohl(tvb, offset + 4);\r\nif (tree)\r\nproto_tree_add_time(iatt_tree, hf_glusterfs_ia_ctime, tvb,\r\noffset, 8, &timestamp);\r\noffset += 8;\r\nproto_item_set_len (iatt_item, offset - start_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_rpc_dissect_gf_flock(proto_tree *tree, tvbuff_t *tvb, int offset)\r\n{\r\noffset = dissect_rpc_uint32(tvb, tree, hf_glusterfs_flock_type, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_glusterfs_flock_whence, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_flock_start, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_flock_len, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_glusterfs_flock_pid, offset);\r\nif (tree)\r\nproto_tree_add_item(tree, hf_glusterfs_flock_owner, tvb,\r\noffset, 8, ENC_NA);\r\noffset += 8;\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_rpc_dissect_gf_2_flock(proto_tree *tree, tvbuff_t *tvb, int offset)\r\n{\r\nproto_item *flock_item;\r\nproto_tree *flock_tree;\r\nint len;\r\nint start_offset = offset;\r\nflock_tree = proto_tree_add_subtree(tree, tvb, offset, -1, ett_glusterfs_flock, &flock_item, "Flock");\r\noffset = dissect_rpc_uint32(tvb, flock_tree, hf_glusterfs_flock_type,\r\noffset);\r\noffset = dissect_rpc_uint32(tvb, flock_tree, hf_glusterfs_flock_whence,\r\noffset);\r\noffset = dissect_rpc_uint64(tvb, flock_tree, hf_glusterfs_flock_start,\r\noffset);\r\noffset = dissect_rpc_uint64(tvb, flock_tree, hf_glusterfs_flock_len,\r\noffset);\r\noffset = dissect_rpc_uint32(tvb, flock_tree, hf_glusterfs_flock_pid,\r\noffset);\r\nlen = tvb_get_ntohl(tvb, offset);\r\noffset += 4;\r\nif (tree)\r\nproto_tree_add_item(flock_tree, hf_glusterfs_flock_owner, tvb,\r\noffset, len, ENC_NA);\r\noffset += len;\r\nproto_item_set_len (flock_item, offset - start_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_rpc_dissect_flags(proto_tree *tree, tvbuff_t *tvb, int offset)\r\n{\r\ngboolean rdonly;\r\nguint32 accmode;\r\nproto_item *flag_tree;\r\nheader_field_info *rdonly_hf, *accmode_hf;\r\nstatic const int *flag_bits[] = {\r\n&hf_glusterfs_flags_wronly,\r\n&hf_glusterfs_flags_rdwr,\r\n&hf_glusterfs_flags_creat,\r\n&hf_glusterfs_flags_excl,\r\n&hf_glusterfs_flags_noctty,\r\n&hf_glusterfs_flags_trunc,\r\n&hf_glusterfs_flags_append,\r\n&hf_glusterfs_flags_nonblock,\r\n&hf_glusterfs_flags_ndelay,\r\n&hf_glusterfs_flags_sync,\r\n&hf_glusterfs_flags_async,\r\n&hf_glusterfs_flags_direct,\r\n&hf_glusterfs_flags_largefile,\r\n&hf_glusterfs_flags_directory,\r\n&hf_glusterfs_flags_nofollow,\r\n&hf_glusterfs_flags_noatime,\r\n&hf_glusterfs_flags_cloexec,\r\n&hf_glusterfs_flags_reserved,\r\nNULL\r\n};\r\nif (tree) {\r\nflag_tree = proto_tree_add_bitmask(tree, tvb, offset, hf_glusterfs_flags, ett_glusterfs_flags, flag_bits, ENC_BIG_ENDIAN);\r\nrdonly = (tvb_get_ntohl(tvb, offset) == 0);\r\nproto_tree_add_item(flag_tree, hf_glusterfs_flags_rdonly, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nif (rdonly) {\r\nrdonly_hf = proto_registrar_get_nth(hf_glusterfs_flags_rdonly);\r\nproto_item_append_text(flag_tree, ", %s", rdonly_hf->name);\r\n}\r\naccmode_hf = proto_registrar_get_nth(hf_glusterfs_flags_accmode);\r\naccmode = tvb_get_ntohl(tvb, offset);\r\nproto_tree_add_uint_format_value(flag_tree, hf_glusterfs_flags_accmode, tvb, offset, 4, accmode,\r\n"%s", val_to_str_const((accmode & (guint32)(accmode_hf->bitmask)), glusterfs_accmode_vals, "Unknown"));\r\nif ((accmode & accmode_hf->bitmask) == accmode_hf->bitmask)\r\nproto_item_append_text(flag_tree, ", %s", proto_registrar_get_nth(hf_glusterfs_flags_accmode)->name);\r\n}\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_rpc_dissect_statfs(proto_tree *tree, tvbuff_t *tvb, int offset)\r\n{\r\nstatic const int *flag_bits[] = {\r\n&hf_glusterfs_mnt_flag_rdonly,\r\n&hf_glusterfs_mnt_flag_nosuid,\r\n&hf_glusterfs_mnt_flag_nodev,\r\n&hf_glusterfs_mnt_flag_noexec,\r\n&hf_glusterfs_mnt_flag_synchronous,\r\n&hf_glusterfs_mnt_flag_mandlock,\r\n&hf_glusterfs_mnt_flag_write,\r\n&hf_glusterfs_mnt_flag_append,\r\n&hf_glusterfs_mnt_flag_immutable,\r\n&hf_glusterfs_mnt_flag_noatime,\r\n&hf_glusterfs_mnt_flag_nodiratime,\r\n&hf_glusterfs_mnt_flag_relatime,\r\nNULL\r\n};\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_bsize, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_frsize, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_blocks, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_bfree, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_bavail, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_files, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_ffree, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_favail, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_id, offset);\r\nif (tree)\r\nproto_tree_add_bitmask(tree, tvb, offset,\r\nhf_glusterfs_mnt_flags, ett_glusterfs_mnt_flags,\r\nflag_bits, ENC_BIG_ENDIAN);\r\noffset += 8;\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_namemax, offset);\r\nreturn offset;\r\n}\r\nint\r\ngluster_rpc_dissect_dict(proto_tree *tree, tvbuff_t *tvb, int hfindex, int offset)\r\n{\r\ngchar *key, *value;\r\nconst gchar *name;\r\ngint roundup, value_len, key_len;\r\nguint32 i, items, len;\r\nint start_offset, start_offset2;\r\nproto_item *subtree_item, *ti;\r\nproto_tree *subtree;\r\nproto_item *dict_item = NULL;\r\nif (hfindex >= 0) {\r\nheader_field_info *hfinfo = proto_registrar_get_nth(hfindex);\r\nname = hfinfo->name;\r\n} else\r\nname = "<NAMELESS DICT STRUCTURE>";\r\nstart_offset = offset;\r\nsubtree = proto_tree_add_subtree(tree, tvb, offset, -1, ett_gluster_dict, &subtree_item, name);\r\nlen = tvb_get_ntohl(tvb, offset);\r\nroundup = rpc_roundup(len) - len;\r\nti = proto_tree_add_item_ret_uint(subtree, hf_gluster_dict_size, tvb, offset, 4, ENC_BIG_ENDIAN, &len);\r\nproto_item_append_text(ti, " (%d bytes inc. RPC-roundup)", rpc_roundup(len));\r\nPROTO_ITEM_SET_GENERATED(ti);\r\noffset += 4;\r\nif (len == 0)\r\nitems = 0;\r\nelse\r\nitems = tvb_get_ntohl(tvb, offset);\r\nproto_item_append_text(subtree_item, ", contains %d item%s", items, items == 1 ? "" : "s");\r\nif (len == 0)\r\nreturn offset;\r\nproto_tree_add_uint(subtree, hf_gluster_num_dict_items, tvb, offset, 4, items);\r\noffset += 4;\r\nfor (i = 0; i < items; i++) {\r\noffset += 4;\r\nvalue_len = tvb_get_ntohl(tvb, offset);\r\noffset += 4;\r\nkey = tvb_get_stringz_enc(wmem_packet_scope(), tvb, offset, &key_len, ENC_ASCII);\r\nstart_offset2 = offset;\r\noffset += key_len;\r\nif (tree) {\r\nif (value_len == 16 && (\r\n!strncmp("gfid-req", key, 8) ||\r\n!strncmp("transaction_id", key, 14) ||\r\n!strncmp("originator_uuid", key, 15))) {\r\nchar *gfid_s;\r\ne_guid_t gfid;\r\ntvb_get_ntohguid(tvb, offset, &gfid);\r\ngfid_s = guid_to_str(wmem_packet_scope(), &gfid);\r\ndict_item = proto_tree_add_guid_format(subtree, hf_glusterfs_gfid,\r\ntvb, offset, 16, &gfid,\r\n"%s: %s", key, gfid_s);\r\n} else if (value_len == 12 && !strncmp("trusted.afr.", key, 12)) {\r\ndict_item = proto_tree_add_bytes_format(subtree, hf_gluster_trusted_afr_key, tvb, offset, 12,\r\nNULL, "%s: 0x%.8x%.8x%.8x", key,\r\ntvb_get_letohl(tvb, offset + 0),\r\ntvb_get_letohl(tvb, offset + 4),\r\ntvb_get_letohl(tvb, offset + 8));\r\n} else {\r\nvalue = tvb_get_string_enc(wmem_packet_scope(), tvb, offset, value_len, ENC_ASCII);\r\ndict_item = proto_tree_add_string_format(subtree, hf_gluster_dict_value, tvb, offset, value_len, value, "%s: %s",\r\nkey, value);\r\n}\r\n}\r\noffset += value_len;\r\nif (tree)\r\nproto_item_set_len (dict_item, offset - start_offset2);\r\n}\r\nif (roundup) {\r\nti = proto_tree_add_item(subtree, hf_gluster_rpc_roundup_bytes, tvb, offset, -1, ENC_NA);\r\nPROTO_ITEM_SET_GENERATED(ti);\r\noffset += roundup;\r\n}\r\nproto_item_set_len (subtree_item, offset - start_offset);\r\nreturn offset;\r\n}\r\nint\r\ngluster_dissect_common_reply(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nproto_item *errno_item;\r\nguint op_errno;\r\noffset = dissect_rpc_uint32(tvb, tree, hf_gluster_op_ret, offset);\r\nif (tree) {\r\nop_errno = tvb_get_ntohl(tvb, offset);\r\nerrno_item = proto_tree_add_int(tree, hf_gluster_op_errno, tvb,\r\noffset, 4, op_errno);\r\nproto_item_append_text(errno_item, " (%s)",\r\ng_strerror(op_errno));\r\n}\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\ngluster_local_dissect_common_reply(tvbuff_t *tvb,\r\npacket_info *pinfo, proto_tree *tree, void* data)\r\n{\r\nreturn gluster_dissect_common_reply(tvb, 0, pinfo, tree, data);\r\n}\r\nstatic int\r\n_glusterfs_gfs3_common_readdir_reply(tvbuff_t *tvb, proto_tree *tree, int offset)\r\n{\r\nproto_item *errno_item;\r\nguint op_errno;\r\noffset = dissect_rpc_uint32(tvb, tree, hf_glusterfs_entries, offset);\r\nif (tree) {\r\nop_errno = tvb_get_ntohl(tvb, offset);\r\nerrno_item = proto_tree_add_int(tree, hf_gluster_op_errno, tvb,\r\noffset, 4, op_errno);\r\nif (op_errno == 0)\r\nproto_item_append_text(errno_item,\r\n" (More replies follow)");\r\nelse if (op_errno == 2 )\r\nproto_item_append_text(errno_item,\r\n" (Last reply)");\r\n}\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_op_unlink_reply(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb,\r\nhf_glusterfs_preparent_iatt, offset);\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb,\r\nhf_glusterfs_postparent_iatt, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_op_unlink_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_pargfid, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_path, offset, NULL);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_bname, offset, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_op_statfs_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = glusterfs_rpc_dissect_statfs(tree, tvb, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_op_statfs_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_path, offset, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_op_flush_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_fd, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_op_setxattr_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = glusterfs_rpc_dissect_flags(tree, tvb, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_path, offset, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_op_opendir_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_fd, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_op_opendir_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_path, offset, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_op_create_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb, hf_glusterfs_iatt,\r\noffset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_fd, offset);\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb,\r\nhf_glusterfs_preparent_iatt, offset);\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb,\r\nhf_glusterfs_postparent_iatt, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_op_create_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_pargfid, offset);\r\noffset = glusterfs_rpc_dissect_flags(tree, tvb, offset);\r\noffset = glusterfs_rpc_dissect_mode(tree, tvb, hf_glusterfs_mode, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_path, offset, NULL);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_bname, offset, NULL);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_op_lookup_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb, hf_glusterfs_iatt,\r\noffset);\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb,\r\nhf_glusterfs_postparent_iatt, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_op_lookup_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_pargfid, offset);\r\noffset = glusterfs_rpc_dissect_flags(tree, tvb, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_path, offset, NULL);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_bname, offset, NULL);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_op_inodelk_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nproto_item *flock_item;\r\nproto_tree *flock_tree;\r\nint start_offset;\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_glusterfs_cmd, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_glusterfs_type, offset);\r\nstart_offset = offset;\r\nflock_tree = proto_tree_add_subtree(tree, tvb, offset, -1, ett_glusterfs_flock, &flock_item, "Flock");\r\noffset = glusterfs_rpc_dissect_gf_flock(flock_tree, tvb, offset);\r\nproto_item_set_len (flock_item, offset - start_offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_path, offset, NULL);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_volume, offset, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\n_glusterfs_gfs_op_readdir_entry(tvbuff_t *tvb, int offset, proto_tree *tree,\r\ngboolean iatt, gboolean dict)\r\n{\r\nproto_item *entry_item;\r\nproto_tree *entry_tree;\r\nconst gchar* path = NULL;\r\nint start_offset = offset;\r\nentry_tree = proto_tree_add_subtree(tree, tvb, offset, -1, ett_glusterfs_entry, &entry_item, "Entry");\r\noffset = dissect_rpc_uint64(tvb, entry_tree, hf_glusterfs_entry_ino, offset);\r\noffset = dissect_rpc_uint64(tvb, entry_tree, hf_glusterfs_entry_off, offset);\r\noffset = dissect_rpc_uint32(tvb, entry_tree, hf_glusterfs_entry_len, offset);\r\noffset = dissect_rpc_uint32(tvb, entry_tree, hf_glusterfs_entry_type, offset);\r\noffset = dissect_rpc_string(tvb, entry_tree, hf_glusterfs_entry_path, offset, &path);\r\nproto_item_append_text(entry_item, " Path: %s", path);\r\nif (iatt)\r\noffset = glusterfs_rpc_dissect_gf_iatt(entry_tree, tvb,\r\nhf_glusterfs_iatt, offset);\r\nif (dict)\r\noffset = gluster_rpc_dissect_dict(entry_tree, tvb, hf_glusterfs_dict, offset);\r\nproto_item_set_len (entry_item, offset - start_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_op_readdirp_entry(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nreturn _glusterfs_gfs_op_readdir_entry(tvb, offset, tree, TRUE, FALSE);\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_readdir_entry(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nreturn _glusterfs_gfs_op_readdir_entry(tvb, offset, tree, FALSE, FALSE);\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_readdirp_entry(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nreturn _glusterfs_gfs_op_readdir_entry(tvb, offset, tree, TRUE, TRUE);\r\n}\r\nstatic int\r\nglusterfs_gfs3_op_readdirp_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = _glusterfs_gfs3_common_readdir_reply(tvb, tree, offset);\r\noffset = dissect_rpc_list(tvb, pinfo, tree, offset,\r\nglusterfs_gfs3_op_readdirp_entry, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_op_readdirp_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_fd, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_offset, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_glusterfs_size, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_op_setattr_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb,\r\nhf_glusterfs_preop_iatt, offset);\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb,\r\nhf_glusterfs_postop_iatt, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_rpc_dissect_setattr(proto_tree *tree, tvbuff_t *tvb, int offset)\r\n{\r\nstatic const int *flag_bits[] = {\r\n&hf_glusterfs_setattr_set_mode,\r\n&hf_glusterfs_setattr_set_uid,\r\n&hf_glusterfs_setattr_set_gid,\r\n&hf_glusterfs_setattr_set_size,\r\n&hf_glusterfs_setattr_set_atime,\r\n&hf_glusterfs_setattr_set_mtime,\r\n&hf_glusterfs_setattr_set_reserved,\r\nNULL\r\n};\r\nif (tree)\r\nproto_tree_add_bitmask(tree, tvb, offset,\r\nhf_glusterfs_setattr_valid,\r\nett_glusterfs_setattr_valid, flag_bits, ENC_NA);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_op_setattr_call(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid,\r\noffset);\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb, hf_glusterfs_iatt,\r\noffset);\r\noffset = glusterfs_rpc_dissect_setattr(tree, tvb, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_path, offset, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_stat_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_stat_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb, hf_glusterfs_iatt,\r\noffset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict,\r\noffset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_mknod_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb, hf_glusterfs_iatt,\r\noffset);\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb,\r\nhf_glusterfs_preparent_iatt, offset);\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb,\r\nhf_glusterfs_postparent_iatt, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict,\r\noffset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_mknod_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_pargfid, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_offset, offset);\r\noffset = glusterfs_rpc_dissect_mode(tree, tvb, hf_glusterfs_mode, offset);\r\noffset = glusterfs_rpc_dissect_mode(tree, tvb, hf_glusterfs_umask, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_bname, offset, NULL);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_mkdir_call(tvbuff_t *tvb,\r\npacket_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\nconst char *name = NULL;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_pargfid, offset);\r\noffset = glusterfs_rpc_dissect_mode(tree, tvb, hf_glusterfs_mode, offset);\r\noffset = glusterfs_rpc_dissect_mode(tree, tvb, hf_glusterfs_umask, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_bname, offset, &name);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ", Filename: %s", name);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_readlink_reply(tvbuff_t *tvb,\r\npacket_info *pinfo, proto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb, hf_glusterfs_iatt,\r\noffset);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_path, offset,\r\nNULL);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict,\r\noffset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_readlink_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_glusterfs_size, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_unlink_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb,\r\nhf_glusterfs_preparent_iatt, offset);\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb,\r\nhf_glusterfs_postparent_iatt, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_unlink_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nguint xflags;\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_pargfid, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_bname, offset, NULL);\r\nxflags = tvb_get_ntohl(tvb, offset);\r\nproto_tree_add_uint_format(tree, hf_glusterfs_xflags, tvb, offset, 4, xflags, "Flags: 0%02o", xflags);\r\noffset += 4;\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_rmdir_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nguint xflags;\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_pargfid, offset);\r\nxflags = tvb_get_ntohl(tvb, offset);\r\nproto_tree_add_uint_format(tree, hf_glusterfs_xflags, tvb, offset, 4, xflags, "Flags: 0%02o", xflags);\r\noffset += 4;\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_bname, offset, NULL);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_symlink_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_pargfid, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_bname, offset, NULL);\r\noffset = glusterfs_rpc_dissect_mode(tree, tvb, hf_glusterfs_umask, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_linkname, offset, NULL);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_rename_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_oldgfid, offset);\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_newgfid, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_oldbname, offset, NULL);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_newbname, offset, NULL);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_rename_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data)\r\n{\r\nproto_tree *old_tree, *new_tree;\r\nproto_item *old_item, *new_item;\r\nint start_offset;\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb, hf_glusterfs_iatt,\r\noffset);\r\nstart_offset = offset;\r\nold_tree = proto_tree_add_subtree(tree, tvb, offset, -1,\r\nett_glusterfs_parent_iatt, &old_item, "Old parent");\r\noffset = glusterfs_rpc_dissect_gf_iatt(old_tree, tvb,\r\nhf_glusterfs_preparent_iatt, offset);\r\noffset = glusterfs_rpc_dissect_gf_iatt(old_tree, tvb,\r\nhf_glusterfs_postparent_iatt, offset);\r\nproto_item_set_len (old_item, offset - start_offset);\r\nstart_offset = offset;\r\nnew_tree = proto_tree_add_subtree(tree, tvb, offset, -1, ett_glusterfs_parent_iatt, &new_item, "New parent");\r\noffset = glusterfs_rpc_dissect_gf_iatt(new_tree, tvb,\r\nhf_glusterfs_preparent_iatt, offset);\r\noffset = glusterfs_rpc_dissect_gf_iatt(new_tree, tvb,\r\nhf_glusterfs_postparent_iatt, offset);\r\nproto_item_set_len (new_item, offset - start_offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_link_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_oldgfid, offset);\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_newgfid, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_newbname, offset, NULL);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_truncate_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_offset, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_open_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_fd, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_open_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = glusterfs_rpc_dissect_flags(tree, tvb, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_read_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb, hf_glusterfs_iatt,\r\noffset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_glusterfs_size, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict,\r\noffset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_read_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_fd, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_offset, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_glusterfs_size, offset);\r\noffset = glusterfs_rpc_dissect_flags(tree, tvb, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_write_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_fd, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_offset, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_glusterfs_size, offset);\r\noffset = glusterfs_rpc_dissect_flags(tree, tvb, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_statfs_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = glusterfs_rpc_dissect_statfs(tree, tvb, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_statfs_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_flush_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_fd, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_setxattr_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = glusterfs_rpc_dissect_flags(tree, tvb, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_getxattr_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_glusterfs_namelen, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_name, offset, NULL);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_getxattr_reply(tvbuff_t *tvb,\r\npacket_info *pinfo, proto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_removexattr_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_name, offset, NULL);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_fsync_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nstatic const int *flag_bits[] = {\r\n&hf_glusterfs_fsync_flag_datasync,\r\n&hf_glusterfs_fsync_flag_unknown,\r\nNULL\r\n};\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_fd, offset);\r\nproto_tree_add_bitmask(tree, tvb, offset,\r\nhf_glusterfs_fsync_flags,\r\nett_glusterfs_fsync_flags, flag_bits, ENC_NA);\r\noffset += 4;\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_opendir_reply(tvbuff_t *tvb,\r\npacket_info *pinfo, proto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_fd, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_opendir_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_create_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb, hf_glusterfs_iatt,\r\noffset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_fd, offset);\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb,\r\nhf_glusterfs_preparent_iatt, offset);\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb,\r\nhf_glusterfs_postparent_iatt, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_create_call(tvbuff_t *tvb,\r\npacket_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nconst char *name = NULL;\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_pargfid, offset);\r\noffset = glusterfs_rpc_dissect_flags(tree, tvb, offset);\r\noffset = glusterfs_rpc_dissect_mode(tree, tvb, hf_glusterfs_mode, offset);\r\noffset = glusterfs_rpc_dissect_mode(tree, tvb, hf_glusterfs_umask, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_bname, offset, &name);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ", Filename: %s", name);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_ftruncate_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_fd, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_offset, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_fstat_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_fd, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_fstat_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb, hf_glusterfs_iatt,\r\noffset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict,\r\noffset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_lk_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_fd, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_glusterfs_cmd, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_glusterfs_type, offset);\r\noffset = glusterfs_rpc_dissect_gf_2_flock(tree, tvb, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_lk_reply(tvbuff_t *tvb,\r\npacket_info *pinfo, proto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = glusterfs_rpc_dissect_gf_2_flock(tree, tvb, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_access_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_glusterfs_mask, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_lookup_call(tvbuff_t *tvb,\r\npacket_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nconst char *name = NULL;\r\nint length;\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_pargfid, offset);\r\noffset = glusterfs_rpc_dissect_flags(tree, tvb, offset);\r\nlength = tvb_get_letohl(tvb, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_bname, offset, &name);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nif(length == 0)\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ", Filename: (nameless, by GFID)");\r\nelse\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ", Filename: %s", name);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_readdir_reply(tvbuff_t *tvb,\r\npacket_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = _glusterfs_gfs3_common_readdir_reply(tvb, tree, offset);\r\noffset = dissect_rpc_list(tvb, pinfo, tree, offset,\r\nglusterfs_gfs3_3_op_readdir_entry, NULL);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_readdir_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_fd, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_offset, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_glusterfs_size, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_inodelk_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_glusterfs_cmd, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_glusterfs_type, offset);\r\noffset = glusterfs_rpc_dissect_gf_2_flock(tree, tvb, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_volume, offset, NULL);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_finodelk_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_fd, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_glusterfs_cmd, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_glusterfs_type, offset);\r\noffset = glusterfs_rpc_dissect_gf_2_flock(tree, tvb, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_volume, offset, NULL);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_entrylk_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_glusterfs_cmd, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_glusterfs_type, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_entrylk_namelen, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_name, offset, NULL);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_volume, offset, NULL);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_fentrylk_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_fd, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_glusterfs_cmd, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_glusterfs_type, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_entrylk_namelen, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_name, offset, NULL);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_volume, offset, NULL);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_xattrop_reply(tvbuff_t *tvb,\r\npacket_info *pinfo, proto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_xattrop_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = glusterfs_rpc_dissect_flags(tree, tvb, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_fxattrop_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = glusterfs_rpc_dissect_flags(tree, tvb, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_fd, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_fgetxattr_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_fd, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_glusterfs_namelen, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_name, offset, NULL);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ngluter_gfs3_3_op_fsetxattr_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_fd, offset);\r\noffset = glusterfs_rpc_dissect_flags(tree, tvb, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_setattr_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb,\r\nhf_glusterfs_preop_iatt, offset);\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb,\r\nhf_glusterfs_postop_iatt, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_setattr_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid,\r\noffset);\r\noffset = glusterfs_rpc_dissect_gf_iatt(tree, tvb, hf_glusterfs_iatt,\r\noffset);\r\noffset = glusterfs_rpc_dissect_setattr(tree, tvb, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_readdirp_reply(tvbuff_t *tvb,\r\npacket_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = _glusterfs_gfs3_common_readdir_reply(tvb, tree, offset);\r\noffset = dissect_rpc_list(tvb, pinfo, tree, offset,\r\nglusterfs_gfs3_3_op_readdirp_entry, NULL);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_readdirp_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_fd, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_offset, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_glusterfs_size, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_release_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_fd, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_releasedir_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_fd, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_fremovexattr_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_fd, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_glusterfs_name, offset, NULL);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_fallocate_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_fd, offset);\r\noffset = glusterfs_rpc_dissect_flags(tree, tvb, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_offset, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_glusterfs_size, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_zerofill_call(tvbuff_t *tvb,\r\npacket_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_fd, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_offset, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_size64, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_seek_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_offset, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nglusterfs_gfs3_3_op_seek_call(tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = glusterfs_rpc_dissect_gfid(tree, tvb, hf_glusterfs_gfid, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_fd, offset);\r\noffset = dissect_rpc_uint64(tvb, tree, hf_glusterfs_offset, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_glusterfs_whence, offset);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nint\r\nglusterfs_gfs3_3_op_common_reply(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = gluster_dissect_common_reply(tvb, offset, pinfo, tree, data);\r\noffset = gluster_rpc_dissect_dict(tree, tvb, hf_glusterfs_dict, offset);\r\nreturn offset;\r\n}\r\nvoid\r\nproto_register_glusterfs(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_glusterfs_proc,\r\n{ "GlusterFS", "glusterfs.proc", FT_UINT32, BASE_DEC | BASE_EXT_STRING,\r\n&glusterfs3_1_fop_proc_vals_ext, 0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_op_ret,\r\n{ "Return value", "gluster.op_ret", FT_INT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_op_errno,\r\n{ "Errno", "gluster.op_errno", FT_INT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_gfid,\r\n{ "GFID", "glusterfs.gfid", FT_GUID,\r\nBASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_pargfid,\r\n{ "Parent GFID", "glusterfs.pargfid", FT_GUID,\r\nBASE_NONE, NULL, 0,\r\n"GFID of the parent directory", HFILL }\r\n},\r\n{ &hf_glusterfs_oldgfid,\r\n{ "Old GFID", "glusterfs.oldgfid", FT_GUID,\r\nBASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_newgfid,\r\n{ "New GFID", "glusterfs.newgfid", FT_GUID,\r\nBASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_path,\r\n{ "Path", "glusterfs.path", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_bname,\r\n{ "Basename", "glusterfs.bname", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_dict,\r\n{ "Dict", "glusterfs.dict", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_fd,\r\n{ "File Descriptor", "glusterfs.fd", FT_UINT64, BASE_DEC,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_offset,\r\n{ "Offset", "glusterfs.offset", FT_UINT64, BASE_DEC,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_size,\r\n{ "Size", "glusterfs.size", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_size64,\r\n{ "Size", "glusterfs.size64", FT_UINT64, BASE_DEC,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_type,\r\n{ "Type", "glusterfs.type", FT_INT32, BASE_DEC,\r\nVALS(glusterfs_lk_type_names), 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_cmd,\r\n{ "Command", "glusterfs.cmd", FT_INT32, BASE_DEC | BASE_EXT_STRING,\r\n&glusterfs_lk_cmd_names_ext, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_volume,\r\n{ "Volume", "glusterfs.volume", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_namelen,\r\n{ "Name Lenth", "glusterfs.namelen", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_linkname,\r\n{ "Linkname", "glusterfs.linkname", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_umask,\r\n{ "Umask", "glusterfs.umask", FT_UINT32, BASE_OCT,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_mask,\r\n{ "Mask", "glusterfs.mask", FT_UINT32, BASE_OCT,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_entries,\r\n{ "Entries returned", "glusterfs.entries", FT_INT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_whence,\r\n{ "Whence", "glusterfs.whence", FT_UINT32, BASE_DEC,\r\nVALS(glusterfs_seek_whence), 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_flags,\r\n{ "Flags", "glusterfs.flags", FT_UINT32, BASE_OCT,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_flags_rdonly,\r\n{ "O_RDONLY", "glusterfs.flags.rdonly", FT_BOOLEAN, 32,\r\nTFS(&glusterfs_notset_set), 0xffffffff, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_flags_wronly,\r\n{ "O_WRONLY", "glusterfs.flags.wronly", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), 00000001, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_flags_rdwr,\r\n{ "O_RDWR", "glusterfs.flags.rdwr", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), 00000002, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_flags_accmode,\r\n{ "O_ACCMODE", "glusterfs.flags.accmode", FT_UINT32, BASE_DEC,\r\nVALS(glusterfs_accmode_vals), 00000003, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_flags_append,\r\n{ "O_APPEND", "glusterfs.flags.append", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), 00002000, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_flags_async,\r\n{ "O_ASYNC", "glusterfs.flags.async", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), 00020000, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_flags_cloexec,\r\n{ "O_CLOEXEC", "glusterfs.flags.cloexec", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), 02000000, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_flags_creat,\r\n{ "O_CREAT", "glusterfs.flags.creat", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), 00000100, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_flags_direct,\r\n{ "O_DIRECT", "glusterfs.flags.direct", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), 00040000, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_flags_directory,\r\n{ "O_DIRECTORY", "glusterfs.flags.directory", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), 00200000, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_flags_excl,\r\n{ "O_EXCL", "glusterfs.flags.excl", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), 00000200, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_flags_largefile,\r\n{ "O_LARGEFILE", "glusterfs.flags.largefile", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), 00100000, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_flags_noatime,\r\n{ "O_NOATIME", "glusterfs.flags.noatime", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), 01000000, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_flags_noctty,\r\n{ "O_NOCTTY", "glusterfs.flags.noctty", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), 00000400, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_flags_nofollow,\r\n{ "O_NOFOLLOW", "glusterfs.flags.nofollow", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), 00400000, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_flags_nonblock,\r\n{ "O_NONBLOCK", "glusterfs.flags.nonblock", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), 00004000, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_flags_ndelay,\r\n{ "O_NDELAY", "glusterfs.flags.ndelay", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), 00004000, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_flags_sync,\r\n{ "O_SYNC", "glusterfs.flags.sync", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), 00010000, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_flags_trunc,\r\n{ "O_TRUNC", "glusterfs.flags.trunc", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), 00001000, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_flags_reserved,\r\n{ "Unused", "glusterfs.flags.reserved", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), 037774000074, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_mode,\r\n{ "Mode", "glusterfs.mode", FT_UINT32, BASE_OCT,\r\nNULL, 0, "Access Permissions", HFILL }\r\n},\r\n{ &hf_glusterfs_mode_suid,\r\n{ "S_ISUID", "glusterfs.mode.s_isuid", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), (04000), "set-user-ID", HFILL }\r\n},\r\n{ &hf_glusterfs_mode_sgid,\r\n{ "S_ISGID", "glusterfs.mode.s_isgid", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), (02000), "set-group-ID", HFILL }\r\n},\r\n{ &hf_glusterfs_mode_svtx,\r\n{ "S_ISVTX", "glusterfs.mode.s_isvtx", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), (01000), "sticky bit", HFILL }\r\n},\r\n{ &hf_glusterfs_mode_rusr,\r\n{ "S_IRUSR", "glusterfs.mode.s_irusr", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), (00400), "read by owner", HFILL }\r\n},\r\n{ &hf_glusterfs_mode_wusr,\r\n{ "S_IWUSR", "glusterfs.mode.s_iwusr", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), (00200), "write by owner", HFILL }\r\n},\r\n{ &hf_glusterfs_mode_xusr,\r\n{ "S_IXUSR", "glusterfs.mode.s_ixusr", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), (00100), "execute/search by owner", HFILL }\r\n},\r\n{ &hf_glusterfs_mode_rgrp,\r\n{ "S_IRGRP", "glusterfs.mode.s_irgrp", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), (00040), "read by group", HFILL }\r\n},\r\n{ &hf_glusterfs_mode_wgrp,\r\n{ "S_IWGRP", "glusterfs.mode.s_iwgrp", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), (00020), "write by group", HFILL }\r\n},\r\n{ &hf_glusterfs_mode_xgrp,\r\n{ "S_IXGRP", "glusterfs.mode.s_ixgrp", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), (00010), "execute/search by group", HFILL }\r\n},\r\n{ &hf_glusterfs_mode_roth,\r\n{ "S_IROTH", "glusterfs.mode.s_iroth", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), (00004), "read by others", HFILL }\r\n},\r\n{ &hf_glusterfs_mode_woth,\r\n{ "S_IWOTH", "glusterfs.mode.s_iwoth", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), (00002), "write by others", HFILL }\r\n},\r\n{ &hf_glusterfs_mode_xoth,\r\n{ "S_IXOTH", "glusterfs.mode.s_ixoth", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), (00001), "execute/search by others", HFILL }\r\n},\r\n{ &hf_glusterfs_mode_reserved,\r\n{ "Reserved", "glusterfs.mode.reserved", FT_BOOLEAN, 32,\r\nTFS(&tfs_set_notset), (~07777), "execute/search by others", HFILL }\r\n},\r\n{ &hf_glusterfs_entry_ino,\r\n{ "Inode", "glusterfs.entry.ino", FT_UINT64, BASE_DEC,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_entry_off,\r\n{ "Offset", "glusterfs.entry.d_off", FT_UINT64, BASE_DEC,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_entry_len,\r\n{ "Path length", "glusterfs.entry.len", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_entry_type,\r\n{ "Type", "glusterfs.entry.d_type", FT_UINT32, BASE_DEC | BASE_EXT_STRING,\r\n&glusterfs_entry_type_names_ext, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_entry_path,\r\n{ "Path", "glusterfs.entry.path", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_iatt,\r\n{ "IATT", "glusterfs.iatt", FT_NONE, BASE_NONE, NULL,\r\n0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_preparent_iatt,\r\n{ "Pre-operation parent IATT", "glusterfs.preparent_iatt", FT_NONE, BASE_NONE, NULL,\r\n0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_postparent_iatt,\r\n{ "Post-operation parent IATT", "glusterfs.postparent_iatt", FT_NONE, BASE_NONE, NULL,\r\n0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_preop_iatt,\r\n{ "Pre-operation IATT", "glusterfs.preop_iatt", FT_NONE, BASE_NONE, NULL,\r\n0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_postop_iatt,\r\n{ "Post-operation IATT", "glusterfs.postop_iatt", FT_NONE, BASE_NONE, NULL,\r\n0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_ia_ino,\r\n{ "Inode", "glusterfs.ia_ino", FT_UINT64, BASE_DEC,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_ia_dev,\r\n{ "Device", "glusterfs.ia_dev", FT_UINT64, BASE_HEX,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_ia_mode,\r\n{ "Mode", "glusterfs.ia_mode", FT_UINT32, BASE_OCT,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_ia_nlink,\r\n{ "Number of hard links", "glusterfs.ia_nlink",\r\nFT_INT32, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_ia_uid,\r\n{ "UID", "glusterfs.ia_uid", FT_INT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_ia_gid,\r\n{ "GID", "glusterfs.ia_gid", FT_INT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_ia_rdev,\r\n{ "Root device", "glusterfs.ia_rdev", FT_UINT64,\r\nBASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_ia_size,\r\n{ "Size", "glusterfs.ia_size", FT_UINT64, BASE_DEC,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_ia_blksize,\r\n{ "Block size", "glusterfs.ia_blksize", FT_INT32,\r\nBASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_ia_blocks,\r\n{ "Blocks", "glusterfs.ia_blocks", FT_UINT64,\r\nBASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_ia_atime,\r\n{ "Time of last access", "glusterfs.ia_atime",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_LOCAL, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_glusterfs_ia_mtime,\r\n{ "Time of last modification", "glusterfs.ia_mtime",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_LOCAL, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_glusterfs_ia_ctime,\r\n{ "Time of last status change", "glusterfs.ia_ctime",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_LOCAL, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_glusterfs_flock_type,\r\n{ "Type", "glusterfs.flock.type", FT_UINT32, BASE_DEC,\r\nVALS(glusterfs_lk_type_names), 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_flock_whence,\r\n{ "Whence", "glusterfs.flock.whence", FT_UINT32,\r\nBASE_DEC, VALS(glusterfs_lk_whence), 0, NULL,\r\nHFILL }\r\n},\r\n{ &hf_glusterfs_flock_start,\r\n{ "Start", "glusterfs.flock.start", FT_UINT64,\r\nBASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_flock_len,\r\n{ "Length", "glusterfs.flock.len", FT_UINT64, BASE_DEC,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_flock_pid,\r\n{ "PID", "glusterfs.flock.pid", FT_INT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_flock_owner,\r\n{ "Owner", "glusterfs.flock.owner", FT_BYTES,\r\nBASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_bsize,\r\n{ "File system block size", "glusterfs.statfs.bsize",\r\nFT_UINT64, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_frsize,\r\n{ "Fragment size", "glusterfs.statfs.frsize",\r\nFT_UINT64, BASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_blocks,\r\n{ "Size of fs in f_frsize units",\r\n"glusterfs.statfs.blocks", FT_UINT64, BASE_DEC,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_bfree,\r\n{ "# free blocks", "glusterfs.statfs.bfree", FT_UINT64,\r\nBASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_bavail,\r\n{ "# free blocks for non-root",\r\n"glusterfs.statfs.bavail", FT_UINT64, BASE_DEC,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_files,\r\n{ "# inodes", "glusterfs.statfs.files", FT_UINT64,\r\nBASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_ffree,\r\n{ "# free inodes", "glusterfs.statfs.ffree", FT_UINT64,\r\nBASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_favail,\r\n{ "# free inodes for non-root",\r\n"glusterfs.statfs.favail", FT_UINT64, BASE_DEC,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_id,\r\n{ "File system ID", "glusterfs.statfs.fsid", FT_UINT64,\r\nBASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_mnt_flags,\r\n{ "Mount flags", "glusterfs.statfs.flags", FT_UINT64,\r\nBASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_mnt_flag_rdonly,\r\n{ "ST_RDONLY", "glusterfs.statfs.flag.rdonly",\r\nFT_BOOLEAN, 64, TFS(&tfs_set_notset), 1, NULL,\r\nHFILL }\r\n},\r\n{ &hf_glusterfs_mnt_flag_nosuid,\r\n{ "ST_NOSUID", "glusterfs.statfs.flag.nosuid",\r\nFT_BOOLEAN, 64, TFS(&tfs_set_notset), 2, NULL,\r\nHFILL }\r\n},\r\n{ &hf_glusterfs_mnt_flag_nodev,\r\n{ "ST_NODEV", "glusterfs.statfs.flag.nodev",\r\nFT_BOOLEAN, 64, TFS(&tfs_set_notset), 4, NULL,\r\nHFILL }\r\n},\r\n{ &hf_glusterfs_mnt_flag_noexec,\r\n{ "ST_EXEC", "glusterfs.statfs.flag.noexec",\r\nFT_BOOLEAN, 64, TFS(&tfs_set_notset), 8, NULL,\r\nHFILL }\r\n},\r\n{ &hf_glusterfs_mnt_flag_synchronous,\r\n{ "ST_SYNCHRONOUS",\r\n"glusterfs.statfs.flag.synchronous",\r\nFT_BOOLEAN, 64, TFS(&tfs_set_notset), 16, NULL,\r\nHFILL }\r\n},\r\n{ &hf_glusterfs_mnt_flag_mandlock,\r\n{ "ST_MANDLOCK", "glusterfs.statfs.flag.mandlock",\r\nFT_BOOLEAN, 64, TFS(&tfs_set_notset), 64, NULL,\r\nHFILL }\r\n},\r\n{ &hf_glusterfs_mnt_flag_write,\r\n{ "ST_WRITE", "glusterfs.statfs.flag.write",\r\nFT_BOOLEAN, 64, TFS(&tfs_set_notset), 128,\r\nNULL, HFILL }\r\n},\r\n{ &hf_glusterfs_mnt_flag_append,\r\n{ "ST_APPEND", "glusterfs.statfs.flag.append",\r\nFT_BOOLEAN, 64, TFS(&tfs_set_notset), 256,\r\nNULL, HFILL }\r\n},\r\n{ &hf_glusterfs_mnt_flag_immutable,\r\n{ "ST_IMMUTABLE", "glusterfs.statfs.flag.immutable",\r\nFT_BOOLEAN, 64, TFS(&tfs_set_notset), 512,\r\nNULL, HFILL }\r\n},\r\n{ &hf_glusterfs_mnt_flag_noatime,\r\n{ "ST_NOATIME", "glusterfs.statfs.flag.noatime",\r\nFT_BOOLEAN, 64, TFS(&tfs_set_notset), 1024,\r\nNULL, HFILL }\r\n},\r\n{ &hf_glusterfs_mnt_flag_nodiratime,\r\n{ "ST_NODIRATIME", "glusterfs.statfs.flag.nodiratime",\r\nFT_BOOLEAN, 64, TFS(&tfs_set_notset), 2048,\r\nNULL, HFILL }\r\n},\r\n{ &hf_glusterfs_mnt_flag_relatime,\r\n{ "ST_RELATIME", "glusterfs.statfs.flag.relatime",\r\nFT_BOOLEAN, 64, TFS(&tfs_set_notset), 4096,\r\nNULL, HFILL }\r\n},\r\n{ &hf_glusterfs_namemax,\r\n{ "Maximum filename length",\r\n"glusterfs.statfs.namemax", FT_UINT64,\r\nBASE_DEC, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_setattr_valid,\r\n{ "Set attributes", "glusterfs.setattr.valid",\r\nFT_UINT32, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_setattr_set_mode,\r\n{ "SET_ATTR_MODE", "glusterfs.setattr.set_mode",\r\nFT_BOOLEAN, 32, TFS(&tfs_set_notset), 0x1,\r\nNULL, HFILL }\r\n},\r\n{ &hf_glusterfs_setattr_set_uid,\r\n{ "SET_ATTR_UID", "glusterfs.setattr.set_uid",\r\nFT_BOOLEAN, 32, TFS(&tfs_set_notset), 0x2,\r\nNULL, HFILL }\r\n},\r\n{ &hf_glusterfs_setattr_set_gid,\r\n{ "SET_ATTR_GID", "glusterfs.setattr.set_gid",\r\nFT_BOOLEAN, 32, TFS(&tfs_set_notset), 0x4,\r\nNULL, HFILL }\r\n},\r\n{ &hf_glusterfs_setattr_set_size,\r\n{ "SET_ATTR_SIZE", "glusterfs.setattr.set_size",\r\nFT_BOOLEAN, 32, TFS(&tfs_set_notset), 0x8,\r\nNULL, HFILL }\r\n},\r\n{ &hf_glusterfs_setattr_set_atime,\r\n{ "SET_ATTR_ATIME", "glusterfs.setattr.set_atime",\r\nFT_BOOLEAN, 32, TFS(&tfs_set_notset), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_glusterfs_setattr_set_mtime,\r\n{ "SET_ATTR_MTIME", "glusterfs.setattr.set_mtime",\r\nFT_BOOLEAN, 32, TFS(&tfs_set_notset), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_glusterfs_setattr_set_reserved,\r\n{ "Reserved", "glusterfs.setattr.set_reserved",\r\nFT_BOOLEAN, 32, TFS(&tfs_set_notset), ~0x3f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_glusterfs_xflags,\r\n{ "XFlags", "glusterfs.xflags", FT_UINT32, BASE_OCT,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_oldbname,\r\n{ "OldBasename", "glusterfs.oldbname", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_newbname,\r\n{ "NewBasename", "glusterfs.newbname", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_name,\r\n{ "Name", "glusterfs.name", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_fsync_flags,\r\n{ "Flags", "glusterfs.fsync.flags", FT_UINT32, BASE_HEX,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_glusterfs_fsync_flag_datasync,\r\n{ "DATASYNC", "glusterfs.fsync.datasync",\r\nFT_BOOLEAN, 32, TFS(&tfs_set_notset), 0x1,\r\nNULL, HFILL }\r\n},\r\n{ &hf_glusterfs_fsync_flag_unknown,\r\n{ "Unknown", "glusterfs.fsync.unknown",\r\nFT_BOOLEAN, 32, TFS(&tfs_set_notset), ~0x1,\r\nNULL, HFILL }\r\n},\r\n{ &hf_glusterfs_entrylk_namelen,\r\n{ "File Descriptor", "glusterfs.entrylk.namelen", FT_UINT64, BASE_DEC,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_dict_size,\r\n{ "Size", "glusterfs.dict_size", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_num_dict_items,\r\n{ "Items", "glusterfs.num_dict_items", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_rpc_roundup_bytes,\r\n{ "RPC-roundup bytes", "glusterfs.rpc_roundup_bytes", FT_BYTES, BASE_NONE,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_trusted_afr_key,\r\n{ "Key", "glusterfs.trusted_afr_key", FT_BYTES, BASE_NONE,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_gluster_dict_value,\r\n{ "Value", "glusterfs.dict_value", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }\r\n},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_glusterfs,\r\n&ett_glusterfs_flags,\r\n&ett_glusterfs_mnt_flags,\r\n&ett_glusterfs_mode,\r\n&ett_glusterfs_entry,\r\n&ett_glusterfs_setattr_valid,\r\n&ett_glusterfs_parent_iatt,\r\n&ett_glusterfs_iatt,\r\n&ett_glusterfs_flock,\r\n&ett_glusterfs_fsync_flags,\r\n&ett_gluster_dict,\r\n&ett_gluster_dict_items\r\n};\r\nproto_glusterfs = proto_register_protocol("GlusterFS", "GlusterFS",\r\n"glusterfs");\r\nproto_register_subtree_array(ett, array_length(ett));\r\nproto_register_field_array(proto_glusterfs, hf, array_length(hf));\r\n}\r\nvoid\r\nproto_reg_handoff_glusterfs(void)\r\n{\r\nrpc_init_prog(proto_glusterfs, GLUSTER3_1_FOP_PROGRAM, ett_glusterfs,\r\nG_N_ELEMENTS(glusterfs_vers_info), glusterfs_vers_info);\r\n}
