static int dissect_cfm_ccm(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\ngint maid_offset;\r\nguint8 cfm_maid_md_name_format;\r\nguint8 cfm_maid_ma_name_format;\r\nguint8 cfm_maid_ma_name_length;\r\nproto_item *ti;\r\nproto_item *fi;\r\nproto_item *mi;\r\nproto_item *wi;\r\nproto_tree *cfm_pdu_tree;\r\nproto_tree *cfm_flag_tree;\r\nproto_tree *cfm_ccm_maid_tree;\r\nproto_tree *cfm_ccm_itu_tree;\r\nti = proto_tree_add_item(tree, hf_cfm_ccm_pdu, tvb, offset, -1, ENC_NA);\r\ncfm_pdu_tree = proto_item_add_subtree(ti, ett_cfm_pdu);\r\nfi = proto_tree_add_item(cfm_pdu_tree, hf_cfm_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ncfm_flag_tree = proto_item_add_subtree(fi, ett_cfm_flags);\r\nproto_tree_add_item(cfm_flag_tree, hf_cfm_flags_RDI, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cfm_flag_tree, hf_cfm_flags_ccm_Reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cfm_flag_tree, hf_cfm_flags_Interval, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_first_tlv_offset, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_ccm_seq_number, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_ccm_ma_ep_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nmi = proto_tree_add_item(cfm_pdu_tree, hf_cfm_ccm_maid, tvb, offset, 48, ENC_NA);\r\ncfm_ccm_maid_tree = proto_item_add_subtree(mi, ett_cfm_ccm_maid);\r\nmaid_offset = offset;\r\nproto_tree_add_item(cfm_ccm_maid_tree, hf_cfm_maid_md_name_format, tvb, maid_offset, 1, ENC_BIG_ENDIAN);\r\ncfm_maid_md_name_format = tvb_get_guint8(tvb, maid_offset);\r\nmaid_offset += 1;\r\nif (cfm_maid_md_name_format != 1) {\r\nguint8 cfm_maid_md_name_length;\r\nproto_tree_add_item(cfm_ccm_maid_tree, hf_cfm_maid_md_name_length,\r\ntvb, maid_offset, 1, ENC_BIG_ENDIAN);\r\ncfm_maid_md_name_length = tvb_get_guint8(tvb, maid_offset);\r\nmaid_offset += 1;\r\nif (cfm_maid_md_name_length) {\r\nif (cfm_maid_md_name_format == 3) {\r\nif (cfm_maid_md_name_length != 8) {\r\nproto_tree_add_item(cfm_ccm_maid_tree, hf_cfm_maid_md_name_hex,\r\ntvb, maid_offset, cfm_maid_md_name_length, ENC_NA);\r\n} else {\r\nproto_tree_add_item(cfm_ccm_maid_tree, hf_cfm_maid_md_name_mac,\r\ntvb, maid_offset, 6, ENC_NA);\r\nproto_tree_add_item(cfm_ccm_maid_tree, hf_cfm_maid_md_name_mac_id,\r\ntvb, maid_offset+6, 2, ENC_NA);\r\n}\r\n} else {\r\nproto_tree_add_item(cfm_ccm_maid_tree, hf_cfm_maid_md_name_string,\r\ntvb, maid_offset, cfm_maid_md_name_length, ENC_ASCII|ENC_NA);\r\n}\r\nmaid_offset += cfm_maid_md_name_length;\r\n}\r\n}\r\nproto_tree_add_item(cfm_ccm_maid_tree, hf_cfm_maid_ma_name_format, tvb, maid_offset, 1, ENC_BIG_ENDIAN);\r\ncfm_maid_ma_name_format = tvb_get_guint8(tvb, maid_offset);\r\nmaid_offset += 1;\r\nproto_tree_add_item(cfm_ccm_maid_tree, hf_cfm_maid_ma_name_length, tvb, maid_offset, 1, ENC_BIG_ENDIAN);\r\ncfm_maid_ma_name_length = tvb_get_guint8(tvb, maid_offset);\r\nmaid_offset += 1;\r\nif ((cfm_maid_ma_name_format == 2) ||\r\n(cfm_maid_ma_name_format == 32)) {\r\nproto_tree_add_item(cfm_ccm_maid_tree, hf_cfm_maid_ma_name_string,\r\ntvb, maid_offset, cfm_maid_ma_name_length, ENC_ASCII|ENC_NA);\r\n} else {\r\nproto_tree_add_item(cfm_ccm_maid_tree, hf_cfm_maid_ma_name_hex,\r\ntvb, maid_offset, cfm_maid_ma_name_length, ENC_NA);\r\n}\r\nmaid_offset += cfm_maid_ma_name_length;\r\noffset += 48;\r\nif (offset > maid_offset) {\r\ngint padding_length;\r\npadding_length = offset - maid_offset;\r\nproto_tree_add_item(cfm_ccm_maid_tree, hf_cfm_maid_padding,\r\ntvb, maid_offset, padding_length, ENC_NA);\r\n}\r\nwi = proto_tree_add_item(cfm_pdu_tree, hf_cfm_ccm_itu_t_y1731, tvb, offset, 16, ENC_NA);\r\ncfm_ccm_itu_tree = proto_item_add_subtree(wi, ett_cfm_ccm_itu);\r\nproto_tree_add_item(cfm_ccm_itu_tree, hf_cfm_itu_TxFCf, tvb, offset, 4, ENC_NA);\r\noffset += 4;\r\nproto_tree_add_item(cfm_ccm_itu_tree, hf_cfm_itu_RxFCb, tvb, offset, 4, ENC_NA);\r\noffset += 4;\r\nproto_tree_add_item(cfm_ccm_itu_tree, hf_cfm_itu_TxFCb, tvb, offset, 4, ENC_NA);\r\noffset += 4;\r\nproto_tree_add_item(cfm_ccm_itu_tree, hf_cfm_itu_reserved, tvb, offset, 4, ENC_NA);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int dissect_cfm_lbm(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nproto_item *ti;\r\nproto_tree *cfm_pdu_tree;\r\nti = proto_tree_add_item(tree, hf_cfm_lbm_pdu, tvb, offset, -1, ENC_NA);\r\ncfm_pdu_tree = proto_item_add_subtree(ti, ett_cfm_pdu);\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_first_tlv_offset, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_lb_transaction_id, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int dissect_cfm_lbr(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nproto_item *ti;\r\nproto_tree *cfm_pdu_tree;\r\nti = proto_tree_add_item(tree, hf_cfm_lbr_pdu, tvb, offset, -1, ENC_NA);\r\ncfm_pdu_tree = proto_item_add_subtree(ti, ett_cfm_pdu);\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_first_tlv_offset, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_lb_transaction_id, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int dissect_cfm_ltm(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nproto_item *ti;\r\nproto_item *fi;\r\nproto_tree *cfm_pdu_tree;\r\nproto_tree *cfm_flag_tree;\r\nti = proto_tree_add_item(tree, hf_cfm_ltm_pdu, tvb, offset, -1, ENC_NA);\r\ncfm_pdu_tree = proto_item_add_subtree(ti, ett_cfm_pdu);\r\nfi = proto_tree_add_item(cfm_pdu_tree, hf_cfm_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ncfm_flag_tree = proto_item_add_subtree(fi, ett_cfm_flags);\r\nproto_tree_add_item(cfm_flag_tree, hf_cfm_flags_UseFDBonly, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cfm_flag_tree, hf_cfm_flags_ltm_Reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_first_tlv_offset, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_lt_transaction_id, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_lt_ttl, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_ltm_orig_addr, tvb, offset, 6, ENC_NA);\r\noffset += 6;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_ltm_targ_addr, tvb, offset, 6, ENC_NA);\r\noffset += 6;\r\nreturn offset;\r\n}\r\nstatic int dissect_cfm_ltr(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nproto_item *ti;\r\nproto_item *fi;\r\nproto_tree *cfm_pdu_tree;\r\nproto_tree *cfm_flag_tree;\r\nti = proto_tree_add_item(tree, hf_cfm_ltr_pdu, tvb, offset, -1, ENC_NA);\r\ncfm_pdu_tree = proto_item_add_subtree(ti, ett_cfm_pdu);\r\nfi = proto_tree_add_item(cfm_pdu_tree, hf_cfm_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ncfm_flag_tree = proto_item_add_subtree(fi, ett_cfm_flags);\r\nproto_tree_add_item(cfm_flag_tree, hf_cfm_flags_UseFDBonly, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cfm_flag_tree, hf_cfm_flags_FwdYes, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cfm_flag_tree, hf_cfm_flags_TerminalMEP, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cfm_flag_tree, hf_cfm_flags_ltr_Reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_first_tlv_offset, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_lt_transaction_id, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_lt_ttl, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_ltr_relay_action, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nreturn offset;\r\n}\r\nstatic int dissect_cfm_ais(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nproto_item *ti;\r\nproto_item *fi;\r\nproto_tree *cfm_pdu_tree;\r\nproto_tree *cfm_flag_tree;\r\nti = proto_tree_add_item(tree, hf_cfm_ais_pdu, tvb, offset, -1, ENC_NA);\r\ncfm_pdu_tree = proto_item_add_subtree(ti, ett_cfm_pdu);\r\nfi = proto_tree_add_item(cfm_pdu_tree, hf_cfm_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ncfm_flag_tree = proto_item_add_subtree(fi, ett_cfm_flags);\r\nproto_tree_add_item(cfm_flag_tree, hf_cfm_flags_ais_lck_Reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cfm_flag_tree, hf_cfm_flags_ais_lck_Period, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_first_tlv_offset, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nreturn offset;\r\n}\r\nstatic int dissect_cfm_lck(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nproto_item *ti;\r\nproto_item *fi;\r\nproto_tree *cfm_pdu_tree;\r\nproto_tree *cfm_flag_tree;\r\nti = proto_tree_add_item(tree, hf_cfm_lck_pdu, tvb, offset, -1, ENC_NA);\r\ncfm_pdu_tree = proto_item_add_subtree(ti, ett_cfm_pdu);\r\nfi = proto_tree_add_item(cfm_pdu_tree, hf_cfm_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ncfm_flag_tree = proto_item_add_subtree(fi, ett_cfm_flags);\r\nproto_tree_add_item(cfm_flag_tree, hf_cfm_flags_ais_lck_Reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cfm_flag_tree, hf_cfm_flags_ais_lck_Period, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_first_tlv_offset, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nreturn offset;\r\n}\r\nstatic int dissect_cfm_tst(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nproto_item *ti;\r\nproto_item *fi;\r\nproto_tree *cfm_pdu_tree;\r\nproto_tree *cfm_flag_tree;\r\nti = proto_tree_add_item(tree, hf_cfm_tst_pdu, tvb, offset, -1, ENC_NA);\r\ncfm_pdu_tree = proto_item_add_subtree(ti, ett_cfm_pdu);\r\nfi = proto_tree_add_item(cfm_pdu_tree, hf_cfm_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ncfm_flag_tree = proto_item_add_subtree(fi, ett_cfm_flags);\r\nproto_tree_add_item(cfm_flag_tree, hf_cfm_flags_Reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_first_tlv_offset, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_tst_sequence_num, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int dissect_cfm_aps(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nproto_item *ti;\r\nproto_item *fi;\r\nproto_tree *cfm_pdu_tree;\r\nproto_tree *cfm_flag_tree;\r\nti = proto_tree_add_item(tree, hf_cfm_aps_pdu, tvb, offset, -1, ENC_NA);\r\ncfm_pdu_tree = proto_item_add_subtree(ti, ett_cfm_pdu);\r\nfi = proto_tree_add_item(cfm_pdu_tree, hf_cfm_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ncfm_flag_tree = proto_item_add_subtree(fi, ett_cfm_flags);\r\nproto_tree_add_item(cfm_flag_tree, hf_cfm_flags_Reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_first_tlv_offset, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_aps_req_st, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_aps_protection_type_A, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_aps_protection_type_B, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_aps_protection_type_D, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_aps_protection_type_R, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_aps_requested_signal, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_aps_bridged_signal, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_aps_bridge_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nreturn offset;\r\n}\r\nstatic int dissect_cfm_raps(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nproto_item *ti;\r\nproto_item *fi;\r\nproto_item *ri;\r\nproto_tree *cfm_pdu_tree;\r\nproto_tree *cfm_flag_tree;\r\nproto_tree *raps_flag_tree;\r\nguint8 raps_version;\r\nguint8 raps_requeststate;\r\nraps_version = tvb_get_guint8(tvb, CFM_VERSION);\r\nraps_version &= 0x1F;\r\nti = proto_tree_add_item(tree, hf_cfm_raps_pdu, tvb, offset, -1, ENC_NA);\r\ncfm_pdu_tree = proto_item_add_subtree(ti, ett_cfm_pdu);\r\nfi = proto_tree_add_item(cfm_pdu_tree, hf_cfm_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ncfm_flag_tree = proto_item_add_subtree(fi, ett_cfm_flags);\r\nproto_tree_add_item(cfm_flag_tree, hf_cfm_flags_Reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_first_tlv_offset, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_raps_req_st, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nraps_requeststate = tvb_get_guint8(tvb, offset);\r\nraps_requeststate >>= 4;\r\nif(raps_version == 1 && raps_requeststate == RAPS_REQUESTSTATE_EVENT){\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_raps_event_subcode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\noffset += 1;\r\nri = proto_tree_add_item(cfm_pdu_tree, hf_cfm_raps_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nraps_flag_tree = proto_item_add_subtree(ri, ett_cfm_raps_flags);\r\nproto_tree_add_item(raps_flag_tree, hf_cfm_raps_flags_rb, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(raps_flag_tree, hf_cfm_raps_flags_dnf, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nif(raps_version == 1){\r\nproto_tree_add_item(raps_flag_tree, hf_cfm_raps_flags_bpr, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_raps_node_id, tvb, offset, 6, ENC_NA);\r\noffset += 6;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_raps_reserved, tvb, offset, 24, ENC_NA);\r\noffset += 24;\r\nreturn offset;\r\n}\r\nstatic int dissect_cfm_mcc(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\ngint cfm_tlv_offset;\r\nproto_item *ti;\r\nproto_item *fi;\r\nproto_item *oi;\r\nproto_tree *cfm_pdu_tree;\r\nproto_tree *cfm_flag_tree;\r\nti = proto_tree_add_item(tree, hf_cfm_mcc_pdu, tvb, offset, -1, ENC_NA);\r\ncfm_pdu_tree = proto_item_add_subtree(ti, ett_cfm_pdu);\r\nfi = proto_tree_add_item(cfm_pdu_tree, hf_cfm_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ncfm_flag_tree = proto_item_add_subtree(fi, ett_cfm_flags);\r\nproto_tree_add_item(cfm_flag_tree, hf_cfm_flags_Reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_first_tlv_offset, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\noi = proto_tree_add_item(cfm_pdu_tree, hf_tlv_org_spec_oui, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nproto_item_append_text(oi, " (%s)", tvb_get_manuf_name(tvb, offset));\r\noffset += 3;\r\nproto_tree_add_item(cfm_pdu_tree, hf_tlv_org_spec_subtype, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\ncfm_tlv_offset = tvb_get_guint8(tvb, 3);\r\ncfm_tlv_offset -= 4;\r\nif (cfm_tlv_offset > 0) {\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_mcc_data, tvb, offset, cfm_tlv_offset, ENC_NA);\r\noffset += cfm_tlv_offset;\r\n}\r\nreturn offset;\r\n}\r\nstatic int dissect_cfm_lmm(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nproto_item *ti;\r\nproto_item *fi;\r\nproto_tree *cfm_pdu_tree;\r\nproto_tree *cfm_flag_tree;\r\nti = proto_tree_add_item(tree, hf_cfm_lmm_pdu, tvb, offset, -1, ENC_NA);\r\ncfm_pdu_tree = proto_item_add_subtree(ti, ett_cfm_pdu);\r\nfi = proto_tree_add_item(cfm_pdu_tree, hf_cfm_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ncfm_flag_tree = proto_item_add_subtree(fi, ett_cfm_flags);\r\nproto_tree_add_item(cfm_flag_tree, hf_cfm_flags_Reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_first_tlv_offset, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_lmm_lmr_TxFCf, tvb, offset, 4, ENC_NA);\r\noffset += 4;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_lmm_lmr_RxFCf, tvb, offset, 4, ENC_NA);\r\noffset += 4;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_lmm_lmr_TxFCb, tvb, offset, 4, ENC_NA);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int dissect_cfm_lmr(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nproto_item *ti;\r\nproto_item *fi;\r\nproto_tree *cfm_pdu_tree;\r\nproto_tree *cfm_flag_tree;\r\nti = proto_tree_add_item(tree, hf_cfm_lmr_pdu, tvb, offset, -1, ENC_NA);\r\ncfm_pdu_tree = proto_item_add_subtree(ti, ett_cfm_pdu);\r\nfi = proto_tree_add_item(cfm_pdu_tree, hf_cfm_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ncfm_flag_tree = proto_item_add_subtree(fi, ett_cfm_flags);\r\nproto_tree_add_item(cfm_flag_tree, hf_cfm_flags_Reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_first_tlv_offset, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_lmm_lmr_TxFCf, tvb, offset, 4, ENC_NA);\r\noffset += 4;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_lmm_lmr_RxFCf, tvb, offset, 4, ENC_NA);\r\noffset += 4;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_lmm_lmr_TxFCb, tvb, offset, 4, ENC_NA);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int dissect_cfm_odm(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nproto_item *ti;\r\nproto_item *fi;\r\nproto_tree *cfm_pdu_tree;\r\nproto_tree *cfm_flag_tree;\r\nti = proto_tree_add_item(tree, hf_cfm_odm_pdu, tvb, offset, -1, ENC_NA);\r\ncfm_pdu_tree = proto_item_add_subtree(ti, ett_cfm_pdu);\r\nfi = proto_tree_add_item(cfm_pdu_tree, hf_cfm_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ncfm_flag_tree = proto_item_add_subtree(fi, ett_cfm_flags);\r\nproto_tree_add_item(cfm_flag_tree, hf_cfm_flags_Reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_first_tlv_offset, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_odm_dmm_dmr_TxTimestampf, tvb, offset, 8, ENC_NA);\r\noffset += 8;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_odm_dmm_dmr_RxTimestampf, tvb, offset, 8, ENC_NA);\r\noffset += 8;\r\nreturn offset;\r\n}\r\nstatic int dissect_cfm_dmm(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nproto_item *ti;\r\nproto_item *fi;\r\nproto_tree *cfm_pdu_tree;\r\nproto_tree *cfm_flag_tree;\r\nti = proto_tree_add_item(tree, hf_cfm_dmm_pdu, tvb, offset, -1, ENC_NA);\r\ncfm_pdu_tree = proto_item_add_subtree(ti, ett_cfm_pdu);\r\nfi = proto_tree_add_item(cfm_pdu_tree, hf_cfm_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ncfm_flag_tree = proto_item_add_subtree(fi, ett_cfm_flags);\r\nproto_tree_add_item(cfm_flag_tree, hf_cfm_flags_Reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_first_tlv_offset, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_odm_dmm_dmr_TxTimestampf, tvb, offset, 8, ENC_NA);\r\noffset += 8;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_odm_dmm_dmr_RxTimestampf, tvb, offset, 8, ENC_NA);\r\noffset += 8;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_dmm_dmr_TxTimestampb, tvb, offset, 8, ENC_NA);\r\noffset += 8;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_dmm_dmr_RxTimestampb, tvb, offset, 8, ENC_NA);\r\noffset += 8;\r\nreturn offset;\r\n}\r\nstatic int dissect_cfm_dmr(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nproto_item *ti;\r\nproto_item *fi;\r\nproto_tree *cfm_pdu_tree;\r\nproto_tree *cfm_flag_tree;\r\nti = proto_tree_add_item(tree, hf_cfm_dmr_pdu, tvb, offset, -1, ENC_NA);\r\ncfm_pdu_tree = proto_item_add_subtree(ti, ett_cfm_pdu);\r\nfi = proto_tree_add_item(cfm_pdu_tree, hf_cfm_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ncfm_flag_tree = proto_item_add_subtree(fi, ett_cfm_flags);\r\nproto_tree_add_item(cfm_flag_tree, hf_cfm_flags_Reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_first_tlv_offset, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_odm_dmm_dmr_TxTimestampf, tvb, offset, 8, ENC_NA);\r\noffset += 8;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_odm_dmm_dmr_RxTimestampf, tvb, offset, 8, ENC_NA);\r\noffset += 8;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_dmm_dmr_TxTimestampb, tvb, offset, 8, ENC_NA);\r\noffset += 8;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_dmm_dmr_RxTimestampb, tvb, offset, 8, ENC_NA);\r\noffset += 8;\r\nreturn offset;\r\n}\r\nstatic int dissect_cfm_exm(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\ngint cfm_tlv_offset;\r\nproto_item *ti;\r\nproto_item *fi;\r\nproto_item *oi;\r\nproto_tree *cfm_pdu_tree;\r\nproto_tree *cfm_flag_tree;\r\nti = proto_tree_add_item(tree, hf_cfm_exm_pdu, tvb, offset, -1, ENC_NA);\r\ncfm_pdu_tree = proto_item_add_subtree(ti, ett_cfm_pdu);\r\nfi = proto_tree_add_item(cfm_pdu_tree, hf_cfm_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ncfm_flag_tree = proto_item_add_subtree(fi, ett_cfm_flags);\r\nproto_tree_add_item(cfm_flag_tree, hf_cfm_flags_Reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_first_tlv_offset, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\noi = proto_tree_add_item(cfm_pdu_tree, hf_tlv_org_spec_oui, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nproto_item_append_text(oi, " (%s)", tvb_get_manuf_name(tvb, offset));\r\noffset += 3;\r\nproto_tree_add_item(cfm_pdu_tree, hf_tlv_org_spec_subtype, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\ncfm_tlv_offset = tvb_get_guint8(tvb, 3);\r\ncfm_tlv_offset -= 4;\r\nif (cfm_tlv_offset > 0) {\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_exm_exr_data, tvb, offset, cfm_tlv_offset, ENC_NA);\r\noffset += cfm_tlv_offset;\r\n}\r\nreturn offset;\r\n}\r\nstatic int dissect_cfm_exr(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\ngint cfm_tlv_offset;\r\nproto_item *ti;\r\nproto_item *fi;\r\nproto_item *oi;\r\nproto_tree *cfm_pdu_tree;\r\nproto_tree *cfm_flag_tree;\r\nti = proto_tree_add_item(tree, hf_cfm_exr_pdu, tvb, offset, -1, ENC_NA);\r\ncfm_pdu_tree = proto_item_add_subtree(ti, ett_cfm_pdu);\r\nfi = proto_tree_add_item(cfm_pdu_tree, hf_cfm_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ncfm_flag_tree = proto_item_add_subtree(fi, ett_cfm_flags);\r\nproto_tree_add_item(cfm_flag_tree, hf_cfm_flags_Reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_first_tlv_offset, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\noi = proto_tree_add_item(cfm_pdu_tree, hf_tlv_org_spec_oui, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nproto_item_append_text(oi, " (%s)", tvb_get_manuf_name(tvb, offset));\r\noffset += 3;\r\nproto_tree_add_item(cfm_pdu_tree, hf_tlv_org_spec_subtype, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\ncfm_tlv_offset = tvb_get_guint8(tvb, 3);\r\ncfm_tlv_offset -= 4;\r\nif (cfm_tlv_offset > 0) {\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_exm_exr_data, tvb, offset, cfm_tlv_offset, ENC_NA);\r\noffset += cfm_tlv_offset;\r\n}\r\nreturn offset;\r\n}\r\nstatic int dissect_cfm_vsm(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\ngint cfm_tlv_offset;\r\nproto_item *ti;\r\nproto_item *fi;\r\nproto_item *oi;\r\nproto_tree *cfm_pdu_tree;\r\nproto_tree *cfm_flag_tree;\r\nti = proto_tree_add_item(tree, hf_cfm_vsm_pdu, tvb, offset, -1, ENC_NA);\r\ncfm_pdu_tree = proto_item_add_subtree(ti, ett_cfm_pdu);\r\nfi = proto_tree_add_item(cfm_pdu_tree, hf_cfm_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ncfm_flag_tree = proto_item_add_subtree(fi, ett_cfm_flags);\r\nproto_tree_add_item(cfm_flag_tree, hf_cfm_flags_Reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_first_tlv_offset, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\noi = proto_tree_add_item(cfm_pdu_tree, hf_tlv_org_spec_oui, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nproto_item_append_text(oi, " (%s)", tvb_get_manuf_name(tvb, offset));\r\noffset += 3;\r\nproto_tree_add_item(cfm_pdu_tree, hf_tlv_org_spec_subtype, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\ncfm_tlv_offset = tvb_get_guint8(tvb, 3);\r\ncfm_tlv_offset -= 4;\r\nif (cfm_tlv_offset > 0) {\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_vsm_vsr_data, tvb, offset, cfm_tlv_offset, ENC_NA);\r\noffset += cfm_tlv_offset;\r\n}\r\nreturn offset;\r\n}\r\nstatic int dissect_cfm_vsr(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\ngint cfm_tlv_offset;\r\nproto_item *ti;\r\nproto_item *fi;\r\nproto_item *oi;\r\nproto_tree *cfm_pdu_tree;\r\nproto_tree *cfm_flag_tree;\r\nti = proto_tree_add_item(tree, hf_cfm_vsr_pdu, tvb, offset, -1, ENC_NA);\r\ncfm_pdu_tree = proto_item_add_subtree(ti, ett_cfm_pdu);\r\nfi = proto_tree_add_item(cfm_pdu_tree, hf_cfm_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ncfm_flag_tree = proto_item_add_subtree(fi, ett_cfm_flags);\r\nproto_tree_add_item(cfm_flag_tree, hf_cfm_flags_Reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_first_tlv_offset, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\noi = proto_tree_add_item(cfm_pdu_tree, hf_tlv_org_spec_oui, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nproto_item_append_text(oi, " (%s)", tvb_get_manuf_name(tvb, offset));\r\noffset += 3;\r\nproto_tree_add_item(cfm_pdu_tree, hf_tlv_org_spec_subtype, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\ncfm_tlv_offset = tvb_get_guint8(tvb, 3);\r\ncfm_tlv_offset -= 4;\r\nif (cfm_tlv_offset > 0) {\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_vsm_vsr_data, tvb, offset, cfm_tlv_offset, ENC_NA);\r\noffset += cfm_tlv_offset;\r\n}\r\nreturn offset;\r\n}\r\nstatic int dissect_cfm_slm(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nproto_item *ti;\r\nproto_item *fi;\r\nproto_tree *cfm_pdu_tree;\r\nproto_tree *cfm_flag_tree;\r\nti = proto_tree_add_item(tree, hf_cfm_slm_pdu, tvb, offset, -1, ENC_NA);\r\ncfm_pdu_tree = proto_item_add_subtree(ti, ett_cfm_pdu);\r\nfi = proto_tree_add_item(cfm_pdu_tree, hf_cfm_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ncfm_flag_tree = proto_item_add_subtree(fi, ett_cfm_flags);\r\nproto_tree_add_item(cfm_flag_tree, hf_cfm_flags_Reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_first_tlv_offset, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_slm_src_mep, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_slr_rsp_mep, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_slm_testid, tvb, offset, 4, ENC_NA);\r\noffset += 4;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_slm_txfcf, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_slr_txfcb, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int dissect_cfm_slr(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, int offset)\r\n{\r\nproto_item *ti;\r\nproto_item *fi;\r\nproto_tree *cfm_pdu_tree;\r\nproto_tree *cfm_flag_tree;\r\nti = proto_tree_add_item(tree, hf_cfm_slr_pdu, tvb, offset, -1, ENC_NA);\r\ncfm_pdu_tree = proto_item_add_subtree(ti, ett_cfm_pdu);\r\nfi = proto_tree_add_item(cfm_pdu_tree, hf_cfm_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ncfm_flag_tree = proto_item_add_subtree(fi, ett_cfm_flags);\r\nproto_tree_add_item(cfm_flag_tree, hf_cfm_flags_Reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_first_tlv_offset, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_slm_src_mep, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_slr_rsp_mep, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_slm_testid, tvb, offset, 4, ENC_NA);\r\noffset += 4;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_slm_txfcf, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(cfm_pdu_tree, hf_cfm_slr_txfcb, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int dissect_cfm(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\ngint offset = 0;\r\nguint8 cfm_pdu_type;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "CFM");\r\ncol_clear(pinfo->cinfo, COL_INFO);\r\ncfm_pdu_type = tvb_get_guint8(tvb, CFM_OPCODE);\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "Type %s",\r\nval_to_str(cfm_pdu_type, opcodetypenames, "Unknown (0x%02x)"));\r\nif (tree) {\r\ngint cfm_tlv_offset;\r\nproto_item *ti;\r\nproto_item *oi;\r\nproto_tree *cfm_tree;\r\nti = proto_tree_add_item(tree, proto_cfm, tvb, 0, -1, ENC_NA);\r\nproto_item_append_text(ti, ", Type %s",\r\nval_to_str(cfm_pdu_type, opcodetypenames, "Unknown (0x%02x)"));\r\ncfm_tree = proto_item_add_subtree(ti, ett_cfm);\r\nproto_tree_add_item(cfm_tree, hf_cfm_md_level, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cfm_tree, hf_cfm_version, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(cfm_tree, hf_cfm_opcode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nswitch(cfm_pdu_type) {\r\ncase CCM:\r\noffset = dissect_cfm_ccm(tvb, pinfo, tree, offset);\r\nbreak;\r\ncase LBM:\r\noffset = dissect_cfm_lbm(tvb, pinfo, tree, offset);\r\nbreak;\r\ncase LBR:\r\noffset = dissect_cfm_lbr(tvb, pinfo, tree, offset);\r\nbreak;\r\ncase LTM:\r\noffset = dissect_cfm_ltm(tvb, pinfo, tree, offset);\r\nbreak;\r\ncase LTR:\r\noffset = dissect_cfm_ltr(tvb, pinfo, tree, offset);\r\nbreak;\r\ncase AIS:\r\noffset = dissect_cfm_ais(tvb, pinfo, tree, offset);\r\nbreak;\r\ncase LCK:\r\noffset = dissect_cfm_lck(tvb, pinfo, tree, offset);\r\nbreak;\r\ncase TST:\r\noffset = dissect_cfm_tst(tvb, pinfo, tree, offset);\r\nbreak;\r\ncase APS:\r\noffset = dissect_cfm_aps(tvb, pinfo, tree, offset);\r\nbreak;\r\ncase RAPS:\r\noffset = dissect_cfm_raps(tvb, pinfo, tree, offset);\r\nbreak;\r\ncase MCC:\r\noffset = dissect_cfm_mcc(tvb, pinfo, tree, offset);\r\nbreak;\r\ncase LMM:\r\noffset = dissect_cfm_lmm(tvb, pinfo, tree, offset);\r\nbreak;\r\ncase LMR:\r\noffset = dissect_cfm_lmr(tvb, pinfo, tree, offset);\r\nbreak;\r\ncase ODM:\r\noffset = dissect_cfm_odm(tvb, pinfo, tree, offset);\r\nbreak;\r\ncase DMM:\r\noffset = dissect_cfm_dmm(tvb, pinfo, tree, offset);\r\nbreak;\r\ncase DMR:\r\noffset = dissect_cfm_dmr(tvb, pinfo, tree, offset);\r\nbreak;\r\ncase EXM:\r\noffset = dissect_cfm_exm(tvb, pinfo, tree, offset);\r\nbreak;\r\ncase EXR:\r\noffset = dissect_cfm_exr(tvb, pinfo, tree, offset);\r\nbreak;\r\ncase VSM:\r\noffset = dissect_cfm_vsm(tvb, pinfo, tree, offset);\r\nbreak;\r\ncase VSR:\r\noffset = dissect_cfm_vsr(tvb, pinfo, tree, offset);\r\nbreak;\r\ncase SLM:\r\noffset = dissect_cfm_slm(tvb, pinfo, tree, offset);\r\nbreak;\r\ncase SLR:\r\noffset = dissect_cfm_slr(tvb, pinfo, tree, offset);\r\nbreak;\r\n}\r\ncfm_tlv_offset = tvb_get_guint8(tvb, 3);\r\ncfm_tlv_offset += 4;\r\nif ((cfm_tlv_offset == offset) && (cfm_tlv_offset > 3)) {\r\nproto_tree *cfm_all_tlvs_tree;\r\nguint8 cfm_tlv_type = 255;\r\nti = proto_tree_add_item(tree, hf_cfm_all_tlvs, tvb, cfm_tlv_offset, -1, ENC_NA);\r\ncfm_all_tlvs_tree = proto_item_add_subtree(ti, ett_cfm_all_tlvs);\r\nwhile (cfm_tlv_type != END_TLV)\r\n{\r\nguint16 cfm_tlv_length;\r\ngint tlv_header_modifier;\r\nproto_tree *cfm_tlv_tree;\r\ncfm_tlv_type = tvb_get_guint8(tvb, cfm_tlv_offset);\r\nif (cfm_tlv_type == END_TLV) {\r\ntlv_header_modifier = 1;\r\ncfm_tlv_length = 0;\r\n} else {\r\ntlv_header_modifier = 3;\r\ncfm_tlv_length = tvb_get_ntohs(tvb, cfm_tlv_offset+1);\r\n}\r\ncfm_tlv_tree = proto_tree_add_subtree_format(cfm_all_tlvs_tree, tvb, cfm_tlv_offset, cfm_tlv_length+tlv_header_modifier,\r\nett_cfm_tlv, NULL, "TLV: %s (t=%d,l=%d)", val_to_str(cfm_tlv_type, tlvtypefieldvalues, "Unknown (0x%02x)"),\r\ncfm_tlv_type, cfm_tlv_length);\r\nproto_tree_add_item(cfm_tlv_tree, hf_cfm_tlv_type, tvb, cfm_tlv_offset, 1, ENC_BIG_ENDIAN);\r\ncfm_tlv_offset += 1;\r\nif (cfm_tlv_type != END_TLV) {\r\nproto_tree_add_item(cfm_tlv_tree, hf_cfm_tlv_length, tvb, cfm_tlv_offset, 2, ENC_BIG_ENDIAN);\r\ncfm_tlv_offset += 2;\r\nif (cfm_tlv_length != 0) {\r\ngint tlv_data_offset;\r\nguint8 tlv_chassis_id_length;\r\nguint8 tlv_tst_test_pattern_type;\r\ntlv_data_offset = cfm_tlv_offset;\r\nswitch(cfm_tlv_type) {\r\ncase SENDER_ID_TLV:\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_chassis_id_length,\r\ntvb, tlv_data_offset, 1, ENC_BIG_ENDIAN);\r\ntlv_chassis_id_length = tvb_get_guint8(tvb,tlv_data_offset);\r\ntlv_data_offset += 1;\r\nif (tlv_chassis_id_length > 0) {\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_chassis_id_subtype,\r\ntvb, tlv_data_offset, 1, ENC_BIG_ENDIAN);\r\ntlv_data_offset += 1;\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_chassis_id,\r\ntvb, tlv_data_offset, tlv_chassis_id_length, ENC_NA);\r\ntlv_data_offset += tlv_chassis_id_length;\r\n}\r\nif (cfm_tlv_length > (2 + tlv_chassis_id_length)) {\r\nguint8 tlv_ma_domain_length;\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_ma_domain_length,\r\ntvb, tlv_data_offset, 1, ENC_BIG_ENDIAN);\r\ntlv_ma_domain_length = tvb_get_guint8(tvb,tlv_data_offset);\r\ntlv_data_offset += 1;\r\nif (tlv_ma_domain_length > 0) {\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_ma_domain,\r\ntvb, tlv_data_offset, tlv_ma_domain_length, ENC_NA);\r\ntlv_data_offset += tlv_ma_domain_length;\r\n}\r\nif (cfm_tlv_length > (2 + tlv_chassis_id_length + 1 + tlv_ma_domain_length)) {\r\nguint8 tlv_management_addr_length;\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_management_addr_length,\r\ntvb, tlv_data_offset, 1, ENC_BIG_ENDIAN);\r\ntlv_management_addr_length = tvb_get_guint8(tvb,tlv_data_offset);\r\ntlv_data_offset += 1;\r\nif (tlv_management_addr_length > 0) {\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_management_addr,\r\ntvb, tlv_data_offset, tlv_management_addr_length, ENC_NA);\r\ntlv_data_offset += tlv_management_addr_length;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase PORT_STAT_TLV:\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_port_status_value,\r\ntvb, tlv_data_offset, 1, ENC_BIG_ENDIAN);\r\ntlv_data_offset += 1;\r\nbreak;\r\ncase DATA_TLV:\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_data_value,\r\ntvb, tlv_data_offset, cfm_tlv_length, ENC_NA);\r\ntlv_data_offset += cfm_tlv_length;\r\nbreak;\r\ncase INTERF_STAT_TLV:\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_interface_status_value,\r\ntvb, tlv_data_offset, 1, ENC_BIG_ENDIAN);\r\ntlv_data_offset += 1;\r\nbreak;\r\ncase REPLY_ING_TLV:\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_reply_ingress_action,\r\ntvb, tlv_data_offset, 1, ENC_BIG_ENDIAN);\r\ntlv_data_offset += 1;\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_reply_ingress_mac_address,\r\ntvb, tlv_data_offset, 6, ENC_NA);\r\ntlv_data_offset += 6;\r\nif (cfm_tlv_length > 7) {\r\nguint8 tlv_reply_ingress_portid_length;\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_reply_ing_egr_portid_length,\r\ntvb, tlv_data_offset, 1, ENC_BIG_ENDIAN);\r\ntlv_reply_ingress_portid_length = tvb_get_guint8(tvb,tlv_data_offset);\r\ntlv_data_offset += 1;\r\nif (tlv_reply_ingress_portid_length > 0) {\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_reply_ing_egr_portid_subtype,\r\ntvb, tlv_data_offset, 1, ENC_BIG_ENDIAN);\r\ntlv_data_offset += 1;\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_reply_ing_egr_portid,\r\ntvb, tlv_data_offset, tlv_reply_ingress_portid_length, ENC_NA);\r\ntlv_data_offset += tlv_reply_ingress_portid_length;\r\n}\r\n}\r\nbreak;\r\ncase REPLY_EGR_TLV:\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_reply_egress_action,\r\ntvb, tlv_data_offset, 1, ENC_BIG_ENDIAN);\r\ntlv_data_offset += 1;\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_reply_egress_mac_address,\r\ntvb, tlv_data_offset, 6, ENC_NA);\r\ntlv_data_offset += 6;\r\nif (cfm_tlv_length > 7) {\r\nguint8 tlv_reply_egress_portid_length;\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_reply_ing_egr_portid_length,\r\ntvb, tlv_data_offset, 1, ENC_BIG_ENDIAN);\r\ntlv_reply_egress_portid_length = tvb_get_guint8(tvb,tlv_data_offset);\r\ntlv_data_offset += 1;\r\nif (tlv_reply_egress_portid_length > 0) {\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_reply_ing_egr_portid_subtype,\r\ntvb, tlv_data_offset, 1, ENC_BIG_ENDIAN);\r\ntlv_data_offset += 1;\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_reply_ing_egr_portid,\r\ntvb, tlv_data_offset, tlv_reply_egress_portid_length, ENC_NA);\r\ntlv_data_offset += tlv_reply_egress_portid_length;\r\n}\r\n}\r\nbreak;\r\ncase LTM_EGR_ID_TLV:\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_ltm_egress_id_unique_identifier,\r\ntvb, tlv_data_offset, 2, ENC_NA);\r\ntlv_data_offset += 2;\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_ltm_egress_id_mac,\r\ntvb, tlv_data_offset, 6, ENC_NA);\r\ntlv_data_offset += 6;\r\nbreak;\r\ncase LTR_EGR_ID_TLV:\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_ltr_egress_last_id_unique_identifier,\r\ntvb, tlv_data_offset, 2, ENC_NA);\r\ntlv_data_offset += 2;\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_ltr_egress_last_id_mac,\r\ntvb, tlv_data_offset, 6, ENC_NA);\r\ntlv_data_offset += 6;\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_ltr_egress_next_id_unique_identifier,\r\ntvb, tlv_data_offset, 2, ENC_NA);\r\ntlv_data_offset += 2;\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_ltr_egress_next_id_mac,\r\ntvb, tlv_data_offset, 6, ENC_NA);\r\ntlv_data_offset += 6;\r\nbreak;\r\ncase ORG_SPEC_TLV:\r\nif (cfm_tlv_length > 3) {\r\noi = proto_tree_add_item(cfm_tlv_tree, hf_tlv_org_spec_oui,\r\ntvb, tlv_data_offset, 3, ENC_BIG_ENDIAN);\r\nproto_item_append_text(oi, " (%s)", tvb_get_manuf_name(tvb, tlv_data_offset));\r\ntlv_data_offset += 3;\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_org_spec_subtype,\r\ntvb, tlv_data_offset, 1, ENC_NA);\r\ntlv_data_offset += 1;\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_org_spec_value,\r\ntvb, tlv_data_offset, cfm_tlv_length-4, ENC_NA);\r\ntlv_data_offset -= 4;\r\n}\r\ntlv_data_offset += cfm_tlv_length;\r\nbreak;\r\ncase TEST_TLV:\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_tst_test_pattern_type,\r\ntvb, tlv_data_offset, 1, ENC_BIG_ENDIAN);\r\ntlv_tst_test_pattern_type = tvb_get_guint8(tvb,tlv_data_offset);\r\ntlv_data_offset += 1;\r\nif (cfm_tlv_length > 0) {\r\nswitch (tlv_tst_test_pattern_type) {\r\ncase 0:\r\ncase 2:\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_tst_test_pattern,\r\ntvb, tlv_data_offset, cfm_tlv_length-1, ENC_NA);\r\ntlv_data_offset += cfm_tlv_length-1;\r\nbreak;\r\ncase 1:\r\ncase 3:\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_tst_test_pattern,\r\ntvb, tlv_data_offset, cfm_tlv_length-5, ENC_NA);\r\ntlv_data_offset += (cfm_tlv_length-5);\r\nproto_tree_add_item(cfm_tlv_tree, hf_tlv_tst_CRC32,\r\ntvb, tlv_data_offset, 4, ENC_NA);\r\ntlv_data_offset += 4;\r\nbreak;\r\n}\r\n}\r\nbreak;\r\n}\r\ncfm_tlv_offset = tlv_data_offset;\r\n}\r\n}\r\n}\r\n}\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid proto_register_cfm(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_cfm_md_level,\r\n{ "CFM MD Level", "cfm.md.level", FT_UINT8,\r\nBASE_DEC, NULL, 0xe0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_version,\r\n{ "CFM Version", "cfm.version", FT_UINT8,\r\nBASE_DEC, NULL, 0x1f, NULL, HFILL }\r\n},\r\n{ &hf_cfm_opcode,\r\n{ "CFM OpCode", "cfm.opcode", FT_UINT8,\r\nBASE_DEC, VALS(opcodetypenames), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_ccm_pdu,\r\n{ "CFM CCM PDU", "cfm.ccm.pdu", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_flags,\r\n{ "Flags", "cfm.flags", FT_UINT8,\r\nBASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_flags_RDI,\r\n{ "RDI", "cfm.flags.rdi", FT_UINT8,\r\nBASE_DEC, NULL, 0x80, NULL, HFILL }\r\n},\r\n{ &hf_cfm_flags_ccm_Reserved,\r\n{ "Reserved", "cfm.flags.ccm.reserved", FT_UINT8,\r\nBASE_DEC, NULL, 0x78, NULL, HFILL }\r\n},\r\n{ &hf_cfm_flags_Interval,\r\n{ "Interval Field", "cfm.flags.interval", FT_UINT8,\r\nBASE_DEC, VALS(CCM_IntervalFieldEncoding), 0x07, NULL, HFILL }\r\n},\r\n{ &hf_cfm_first_tlv_offset,\r\n{ "First TLV Offset", "cfm.first.tlv.offset", FT_UINT8,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_ccm_seq_number,\r\n{ "Sequence Number", "cfm.ccm.seq.num", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_ccm_ma_ep_id,\r\n{ "Maintenance Association End Point Identifier", "cfm.ccm.ma.ep.id",\r\nFT_UINT16, BASE_DEC, NULL, 0x1FFF, NULL, HFILL }\r\n},\r\n{ &hf_cfm_ccm_maid,\r\n{ "Maintenance Association Identifier (MEG ID)", "cfm.ccm.maid", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_maid_md_name_format,\r\n{ "MD Name Format", "cfm.maid.md.name.format", FT_UINT8,\r\nBASE_DEC, VALS(mdnameformattypes), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_maid_md_name_length,\r\n{ "MD Name Length", "cfm.maid.md.name.length", FT_UINT8,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_maid_md_name_string,\r\n{ "MD Name (String)", "cfm.maid.md.name.string", FT_STRING,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_maid_md_name_hex,\r\n{ "MD Name", "cfm.maid.md.name.hex", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_maid_md_name_mac,\r\n{ "MD Name (MAC)", "cfm.maid.md.name.mac", FT_ETHER,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_maid_md_name_mac_id,\r\n{ "MD Name (MAC)", "cfm.maid.md.name.mac.id", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_maid_ma_name_format,\r\n{ "Short MA Name (MEG ID) Format", "cfm.maid.ma.name.format", FT_UINT8,\r\nBASE_DEC, VALS(manameformattypes), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_maid_ma_name_length,\r\n{ "Short MA Name (MEG ID) Length", "cfm.maid.ma.name.length", FT_UINT8,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_maid_ma_name_string,\r\n{ "Short MA Name", "cfm.maid.ma.name.string", FT_STRING,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_maid_ma_name_hex,\r\n{ "Short MA Name", "cfm.maid.ma.name.hex", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_maid_padding,\r\n{ "Zero-Padding", "cfm.ccm.maid.padding", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_ccm_itu_t_y1731,\r\n{ "Defined by ITU-T Y.1731", "cfm.ccm.itu.t.y1731", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_itu_TxFCf,\r\n{ "TxFCf", "cfm.itu.txfcf", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_itu_RxFCb,\r\n{ "RxFCb", "cfm.itu.rxfcb", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_itu_TxFCb,\r\n{ "TxFCb", "cfm.itu.txfcb", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_itu_reserved,\r\n{ "Reserved", "cfm.itu.reserved", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_lbm_pdu,\r\n{ "CFM LBM PDU", "cfm.lbm.pdu", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_lb_transaction_id,\r\n{ "Loopback Transaction Identifier", "cfm.lb.transaction.id", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_lbr_pdu,\r\n{ "CFM LBR PDU", "cfm.lbr.pdu", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_ltm_pdu,\r\n{ "CFM LTM PDU", "cfm.ltm.pdu", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_flags_UseFDBonly,\r\n{ "UseFDBonly", "cfm.flags.usefdbonly", FT_UINT8,\r\nBASE_DEC, NULL, 0x80, NULL, HFILL }\r\n},\r\n{ &hf_cfm_flags_ltm_Reserved,\r\n{ "Reserved", "cfm.flags.ltm.reserved", FT_UINT8,\r\nBASE_DEC, NULL, 0x7F, NULL, HFILL }\r\n},\r\n{ &hf_cfm_lt_transaction_id,\r\n{ "Linktrace Transaction Identifier", "cfm.lt.transaction.id", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_lt_ttl,\r\n{ "Linktrace TTL", "cfm.lt.ttl", FT_UINT8,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_ltm_orig_addr,\r\n{ "Linktrace Message: Original Address", "cfm.ltm.orig.addr", FT_ETHER,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_ltm_targ_addr,\r\n{ "Linktrace Message: Target Address", "cfm.ltm.targ.addr", FT_ETHER,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_ltr_pdu,\r\n{ "CFM LTR PDU", "cfm.ltr.pdu", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_flags_FwdYes,\r\n{ "FwdYes", "cfm.flags.fwdyes", FT_UINT8,\r\nBASE_DEC, NULL, 0x40, NULL, HFILL }\r\n},\r\n{ &hf_cfm_flags_TerminalMEP,\r\n{ "TerminalMEP", "cfm.flags.ltr.terminalmep", FT_UINT8,\r\nBASE_DEC, NULL, 0x20, NULL, HFILL }\r\n},\r\n{ &hf_cfm_flags_ltr_Reserved,\r\n{ "Reserved", "cfm.flags.ltr.reserved", FT_UINT8,\r\nBASE_DEC, NULL, 0x1F, NULL, HFILL }\r\n},\r\n{ &hf_cfm_ltr_relay_action,\r\n{ "Linktrace Reply Relay Action", "cfm.ltr.relay.action", FT_UINT8,\r\nBASE_DEC, VALS(relayactiontypes), 0x0, NULL, HFILL}\r\n},\r\n{ &hf_cfm_ais_pdu,\r\n{ "CFM AIS PDU", "cfm.ais.pdu", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_flags_ais_lck_Reserved,\r\n{ "Reserved", "cfm.flags.ais_lck_Reserved", FT_UINT8,\r\nBASE_DEC, NULL, 0xF8, NULL, HFILL }\r\n},\r\n{ &hf_cfm_flags_ais_lck_Period,\r\n{ "Period", "cfm.flags.ais_lck_Period", FT_UINT8,\r\nBASE_DEC, VALS(aislckperiodtypes), 0x07, NULL, HFILL }\r\n},\r\n{ &hf_cfm_lck_pdu,\r\n{ "CFM LCK PDU", "cfm.lck.pdu", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_tst_pdu,\r\n{ "CFM TST PDU", "cfm.tst.pdu", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_flags_Reserved,\r\n{ "Reserved", "cfm.flags.reserved", FT_UINT8,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_tst_sequence_num,\r\n{ "Sequence Number", "cfm.tst.sequence.num", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_aps_pdu,\r\n{ "CFM APS PDU", "cfm.aps.pdu", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_aps_req_st,\r\n{ "Request/State", "cfm.raps.req.st", FT_UINT8,\r\nBASE_DEC, VALS(aps_request_state_values), 0xf0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_aps_protection_type_A,\r\n{ "Protection type A", "cfm.aps.protec.type.A", FT_BOOLEAN,\r\n8, TFS(&aps_protection_type_A_values), 0x08, NULL, HFILL }\r\n},\r\n{ &hf_cfm_aps_protection_type_B,\r\n{ "Protection type B", "cfm.aps.protec.type.B", FT_BOOLEAN,\r\n8, TFS(&aps_protection_type_B_values), 0x04, NULL, HFILL }\r\n},\r\n{ &hf_cfm_aps_protection_type_D,\r\n{ "Protection type D", "cfm.aps.protec.type.D", FT_BOOLEAN,\r\n8, TFS(&aps_protection_type_D_values), 0x02, NULL, HFILL }\r\n},\r\n{ &hf_cfm_aps_protection_type_R,\r\n{ "Protection type R", "cfm.aps.protec.type.R", FT_BOOLEAN,\r\n8, TFS(&aps_protection_type_R_values), 0x01, NULL, HFILL }\r\n},\r\n{ &hf_cfm_aps_requested_signal,\r\n{ "Requested signal", "cfm.aps.req.sgnl", FT_UINT8,\r\nBASE_HEX, VALS(aps_requested_signal_values), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_aps_bridged_signal,\r\n{ "Bridged signal", "cfm.aps.brdgd.sgnl", FT_UINT8,\r\nBASE_HEX, VALS(aps_bridged_signal_values), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_aps_bridge_type,\r\n{ "Bridge type", "cfm.aps.bridge.type", FT_UINT8,\r\nBASE_HEX, VALS(aps_bridge_type_values), 0x80, NULL, HFILL }\r\n},\r\n{ &hf_cfm_raps_pdu,\r\n{ "CFM R-APS PDU", "cfm.raps.pdu", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_raps_req_st,\r\n{ "Request/State", "cfm.raps.req.st", FT_UINT8,\r\nBASE_HEX, VALS(rapsrequeststatevalues), 0xF0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_raps_event_subcode,\r\n{ "Sub-code", "cfm.raps.event.subcode", FT_UINT8,\r\nBASE_HEX, VALS(rapseventsubcode), 0x0F, NULL, HFILL }\r\n},\r\n{ &hf_cfm_raps_flags,\r\n{ "R-APS Flags", "cfm.raps.flags", FT_UINT8,\r\nBASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_raps_flags_rb,\r\n{ "RPL Blocked", "cfm.raps.flags.rb", FT_BOOLEAN,\r\n8, TFS(&rapsrplblockedvalues), 0x80, NULL, HFILL }\r\n},\r\n{ &hf_cfm_raps_flags_dnf,\r\n{ "Do Not Flush", "cfm.raps.flags.dnf", FT_BOOLEAN,\r\n8, TFS(&rapsdnfvalues), 0x40, NULL, HFILL }\r\n},\r\n{ &hf_cfm_raps_flags_bpr,\r\n{ "Blocked Port Reference", "cfm.raps.flags.bpr", FT_BOOLEAN,\r\n8, TFS(&rapsbprvalues), 0x20, NULL, HFILL }\r\n},\r\n{ &hf_cfm_raps_node_id,\r\n{ "R-APS Node ID", "cfm.raps.node.id", FT_ETHER,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_raps_reserved,\r\n{ "R-APS Reserved", "cfm.raps.reserved", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_mcc_pdu,\r\n{ "CFM MCC PDU", "cfm.mcc.pdu", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_mcc_data,\r\n{ "MCC data", "cfm.mcc.data", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_lmm_pdu,\r\n{ "CFM LMM PDU", "cfm.lmm.pdu", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_lmm_lmr_TxFCf,\r\n{ "TxFCf", "cfm.lmm.lmr.txfcf", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_lmm_lmr_RxFCf,\r\n{ "RxFCf", "cfm.lmm.lmr.rxfcf", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_lmm_lmr_TxFCb,\r\n{ "TxFCb", "cfm.lmm.lmr.txfcb", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_lmr_pdu,\r\n{ "CFM LMR PDU", "cfm.lmr.pdu", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_odm_pdu,\r\n{ "CFM 1DM PDU", "cfm.odm.pdu", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_odm_dmm_dmr_TxTimestampf,\r\n{ "TxTimestampf", "cfm.odm.dmm.dmr.txtimestampf", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_odm_dmm_dmr_RxTimestampf,\r\n{ "RxTimestampf", "cfm.odm.dmm.dmr.rxtimestampf", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_dmm_pdu,\r\n{ "CFM DMM PDU", "cfm.dmm.pdu", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_dmm_dmr_TxTimestampb,\r\n{ "TxTimestampb", "cfm.dmm.dmr.txtimestampb", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_dmm_dmr_RxTimestampb,\r\n{ "RxTimestampb", "cfm.dmm.dmr.rxtimestampb", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_dmr_pdu,\r\n{ "CFM DMR PDU", "cfm.dmr.pdu", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_exm_pdu,\r\n{ "CFM EXM PDU", "cfm.exm.pdu", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_exm_exr_data,\r\n{ "EXM/EXR data", "cfm.exm_exr.data", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_exr_pdu,\r\n{ "CFM EXR PDU", "cfm.exr.pdu", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_vsm_pdu,\r\n{ "CFM VSM PDU", "cfm.vsm.pdu", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_vsm_vsr_data,\r\n{ "VSM/VSR data", "cfm.vsm_vsr.data", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_vsr_pdu,\r\n{ "CFM VSR PDU", "cfm.vsr.pdu", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_slm_pdu,\r\n{ "CFM SLM PDU", "cfm.slm.pdu", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_slr_pdu,\r\n{ "CFM SLR PDU", "cfm.slr.pdu", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_slm_src_mep,\r\n{ "Source MEP ID", "cfm.slm.src_mep_id", FT_UINT16,\r\nBASE_DEC, NULL, 0x1FFF, NULL, HFILL }\r\n},\r\n{ &hf_cfm_slr_rsp_mep,\r\n{ "Responder MEP ID", "cfm.slr.rsp_mep_id", FT_UINT16,\r\nBASE_DEC, NULL, 0x1FFF, NULL, HFILL }\r\n},\r\n{ &hf_cfm_slm_testid,\r\n{ "TestID", "cfm.slm.test_id", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_slm_txfcf,\r\n{ "TxFcF", "cfm.slm.txfcf", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_slr_txfcb,\r\n{ "TxFcB", "cfm.slr.txfcb", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_all_tlvs,\r\n{ "CFM TLVs", "cfm.all.tlvs", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_cfm_tlv_type,\r\n{ "TLV Type", "cfm.tlv.type", FT_UINT8,\r\nBASE_DEC, VALS(tlvtypefieldvalues), 0x0, NULL, HFILL}\r\n},\r\n{ &hf_cfm_tlv_length,\r\n{ "TLV Length", "cfm.tlv.length", FT_UINT16,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_tlv_chassis_id_length,\r\n{ "Chassis ID Length", "cfm.tlv.chassis.id.length", FT_UINT8,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_tlv_chassis_id_subtype,\r\n{ "Chassis ID Sub-type", "cfm.tlv.chassis.id.subtype", FT_UINT8,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_tlv_chassis_id,\r\n{ "Chassis ID", "cfm.tlv.chassis.id", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_tlv_ma_domain_length,\r\n{ "Management Address Domain Length", "cfm.tlv.ma.domain.length", FT_UINT8,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_tlv_ma_domain,\r\n{ "Management Address Domain", "cfm.tlv.ma.domain", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_tlv_management_addr_length,\r\n{ "Management Address Length", "cfm.tlv.management.addr.length", FT_UINT8,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_tlv_management_addr,\r\n{ "Management Address", "cfm.tlv.management.addr", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_tlv_port_status_value,\r\n{ "Port Status value", "cfm.tlv.port.status.value", FT_UINT8,\r\nBASE_DEC, VALS(portstatTLVvalues), 0x0, NULL, HFILL}\r\n},\r\n{ &hf_tlv_data_value,\r\n{ "Data Value", "cfm.tlv.data.value", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_tlv_interface_status_value,\r\n{ "Interface Status value", "cfm.tlv.port.interface.value", FT_UINT8,\r\nBASE_DEC, VALS(interfacestatTLVvalues), 0x0, NULL, HFILL}\r\n},\r\n{ &hf_tlv_reply_ingress_action,\r\n{ "Ingress Action", "cfm.tlv.reply.ingress.action", FT_UINT8,\r\nBASE_DEC, VALS(replyingressTLVvalues), 0x0, NULL, HFILL}\r\n},\r\n{ &hf_tlv_reply_ingress_mac_address,\r\n{ "Ingress MAC address", "cfm.tlv.reply.ingress.mac.address", FT_ETHER,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_tlv_reply_ing_egr_portid_length,\r\n{ "Chassis ID Length", "cfm.tlv.reply.ing.egr.portid.length", FT_UINT8,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_tlv_reply_ing_egr_portid_subtype,\r\n{ "Chassis ID Sub-type", "cfm.tlv.reply.ing.egr.portid.subtype", FT_UINT8,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_tlv_reply_ing_egr_portid,\r\n{ "Chassis ID", "cfm.tlv.reply.ing.egr.portid", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_tlv_reply_egress_action,\r\n{ "Egress Action", "cfm.tlv.reply.egress.action", FT_UINT8,\r\nBASE_DEC, VALS(replyegressTLVvalues), 0x0, NULL, HFILL}\r\n},\r\n{ &hf_tlv_reply_egress_mac_address,\r\n{ "Egress MAC address", "cfm.tlv.reply.egress.mac.address", FT_ETHER,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_tlv_ltm_egress_id_mac,\r\n{ "Egress Identifier - MAC of LT Initiator/Responder", "cfm.tlv.ltm.egress.id.mac", FT_ETHER,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_tlv_ltm_egress_id_unique_identifier,\r\n{ "Egress Identifier - Unique Identifier", "cfm.tlv.ltm.egress.id.ui", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_tlv_ltr_egress_last_id_mac,\r\n{ "Last Egress Identifier - MAC address", "cfm.tlv.ltr.egress.last.id.mac", FT_ETHER,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_tlv_ltr_egress_last_id_unique_identifier,\r\n{ "Last Egress Identifier - Unique Identifier", "cfm.tlv.ltr.egress.last.id.ui", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_tlv_ltr_egress_next_id_mac,\r\n{ "Next Egress Identifier - MAC address", "cfm.tlv.ltr.egress.next.id.mac", FT_ETHER,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_tlv_ltr_egress_next_id_unique_identifier,\r\n{ "Next Egress Identifier - Unique Identifier", "cfm.tlv.ltr.egress.next.id.ui", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_tlv_org_spec_oui,\r\n{ "OUI", "cfm.tlv.org.spec.oui", FT_UINT24,\r\nBASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_tlv_org_spec_subtype,\r\n{ "Sub-Type", "cfm.tlv.org.spec.subtype", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_tlv_org_spec_value,\r\n{ "Value", "cfm.tlv.org.spec.value", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_tlv_tst_test_pattern_type,\r\n{ "Test Pattern Type", "cfm.tlv.tst.test.pattern.type", FT_UINT8,\r\nBASE_DEC, VALS(testTLVpatterntypes), 0x0, NULL, HFILL}\r\n},\r\n{ &hf_tlv_tst_test_pattern,\r\n{ "Test Pattern", "cfm.tlv.tst.test.pattern", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_tlv_tst_CRC32,\r\n{ "CRC-32", "cfm.tlv.tst.crc32", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_cfm,\r\n&ett_cfm_flags,\r\n&ett_cfm_ccm_maid,\r\n&ett_cfm_ccm_itu,\r\n&ett_cfm_pdu,\r\n&ett_cfm_all_tlvs,\r\n&ett_cfm_tlv,\r\n&ett_cfm_raps_flags\r\n};\r\nproto_cfm = proto_register_protocol (\r\n"CFM EOAM 802.1ag/ITU Protocol",\r\n"CFM",\r\n"cfm"\r\n);\r\ncfm_handle = register_dissector("cfm", dissect_cfm, proto_cfm);\r\nproto_register_field_array(proto_cfm, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid proto_reg_handoff_cfm(void)\r\n{\r\ndissector_add_uint("ethertype", ETHERTYPE_CFM, cfm_handle);\r\ndissector_add_for_decode_as("pwach.channel_type", cfm_handle);\r\n}
