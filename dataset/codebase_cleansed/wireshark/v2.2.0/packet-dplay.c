static gint display_unicode_string(proto_tree *tree, gint hf_index, tvbuff_t *tvb, gint offset)\r\n{\r\nchar *str, *p;\r\ngint len;\r\ngint charoffset;\r\nguint16 character;\r\nlen = 0;\r\nwhile (tvb_get_letohs(tvb, offset + len) != '\0')\r\nlen += 2;\r\nlen += 2;\r\nstr = (char *)wmem_alloc(wmem_packet_scope(), len/2);\r\ncharoffset = offset;\r\np = str;\r\nwhile ((character = tvb_get_letohs(tvb, charoffset)) != '\0') {\r\n*p++ = (char) character;\r\ncharoffset += 2;\r\n}\r\n*p = '\0';\r\nproto_tree_add_string(tree, hf_index, tvb, offset, len, str);\r\nreturn offset+len;\r\n}\r\nstatic gint dissect_sockaddr_in(proto_tree *tree, tvbuff_t *tvb, gint offset)\r\n{\r\nproto_tree *sa_tree;\r\nsa_tree = proto_tree_add_subtree(tree, tvb, offset, 16, ett_dplay_sockaddr, NULL,\r\n"DirectPlay sockaddr_in structure");\r\nproto_tree_add_item(sa_tree, hf_dplay_saddr_af, tvb, offset, 2, ENC_LITTLE_ENDIAN); offset += 2;\r\nproto_tree_add_item(sa_tree, hf_dplay_saddr_port, tvb, offset, 2, ENC_BIG_ENDIAN); offset += 2;\r\nproto_tree_add_item(sa_tree, hf_dplay_saddr_ip, tvb, offset, 4, ENC_BIG_ENDIAN); offset += 4;\r\nproto_tree_add_item(sa_tree, hf_dplay_saddr_padding, tvb, offset, 8, ENC_NA); offset += 8;\r\nreturn offset;\r\n}\r\nstatic gint dissect_session_desc(proto_tree *tree, tvbuff_t *tvb, gint offset)\r\n{\r\nstatic const int * flags[] = {\r\n&hf_dplay_flags_no_sess_desc_changes,\r\n&hf_dplay_flags_acqire_voice,\r\n&hf_dplay_flags_optimize_latency,\r\n&hf_dplay_flags_preserve_order,\r\n&hf_dplay_flags_reliable,\r\n&hf_dplay_flags_server_player_only,\r\n&hf_dplay_flags_route,\r\n&hf_dplay_flags_password_req,\r\n&hf_dplay_flags_private_session,\r\n&hf_dplay_flags_use_auth,\r\n&hf_dplay_flags_no_player_updates,\r\n&hf_dplay_flags_use_ping,\r\n&hf_dplay_flags_can_join,\r\n&hf_dplay_flags_ignored,\r\n&hf_dplay_flags_short_player_msg,\r\n&hf_dplay_flags_migrate_host,\r\n&hf_dplay_flags_0002,\r\n&hf_dplay_flags_no_create_players,\r\nNULL\r\n};\r\nproto_tree_add_item(tree, hf_dplay_sess_desc_length, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_dplay_sess_desc_flags, ett_dplay_sess_desc_flags, flags, ENC_LITTLE_ENDIAN); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_instance_guid, tvb, offset, 16, ENC_BIG_ENDIAN); offset += 16;\r\nproto_tree_add_item(tree, hf_dplay_game_guid, tvb, offset, 16, ENC_BIG_ENDIAN); offset += 16;\r\nproto_tree_add_item(tree, hf_dplay_max_players, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_curr_players, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_sess_name_ptr, tvb, offset, 4, ENC_NA); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_passwd_ptr, tvb, offset, 4, ENC_NA); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_sess_desc_reserved_1, tvb, offset, 4, ENC_NA); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_sess_desc_reserved_2, tvb, offset, 4, ENC_NA); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_sess_desc_user_1, tvb, offset, 4, ENC_NA); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_sess_desc_user_2, tvb, offset, 4, ENC_NA); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_sess_desc_user_3, tvb, offset, 4, ENC_NA); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_sess_desc_user_4, tvb, offset, 4, ENC_NA); offset += 4;\r\nreturn offset;\r\n}\r\nstatic gint dissect_packed_player(proto_tree *tree, tvbuff_t *tvb, gint offset)\r\n{\r\nguint32 sn_len, ln_len, sd_len, pd_len, num_players, i;\r\ngint size;\r\nstatic const int * flags[] = {\r\n&hf_dplay_pp_flag_sending,\r\n&hf_dplay_pp_flag_in_group,\r\n&hf_dplay_pp_flag_nameserver,\r\n&hf_dplay_pp_flag_sysplayer,\r\nNULL\r\n};\r\nsize = tvb_get_letohl(tvb, offset);\r\nproto_tree_add_item(tree, hf_dplay_pp_size, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_dplay_pp_flags, ett_dplay_pp_flags, flags, ENC_LITTLE_ENDIAN); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_pp_id, tvb, offset, 4, ENC_NA); offset += 4;\r\nsn_len = tvb_get_letohl(tvb, offset);\r\nproto_tree_add_item(tree, hf_dplay_pp_short_name_len, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nln_len = tvb_get_letohl(tvb, offset);\r\nproto_tree_add_item(tree, hf_dplay_pp_long_name_len, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nsd_len = tvb_get_letohl(tvb, offset);\r\nproto_tree_add_item(tree, hf_dplay_pp_sp_data_size, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\npd_len = tvb_get_letohl(tvb, offset);\r\nproto_tree_add_item(tree, hf_dplay_pp_player_data_size, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nnum_players = tvb_get_letohl(tvb, offset);\r\nproto_tree_add_item(tree, hf_dplay_pp_num_players, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_pp_system_player, tvb, offset, 4, ENC_NA); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_pp_fixed_size, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_pp_dialect, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_pp_unknown_1, tvb, offset, 4, ENC_NA); offset += 4;\r\nif (sn_len)\r\noffset = display_unicode_string(tree, hf_dplay_pp_short_name, tvb, offset);\r\nif (ln_len)\r\noffset = display_unicode_string(tree, hf_dplay_pp_long_name, tvb, offset);\r\nproto_tree_add_item(tree, hf_dplay_pp_sp_data, tvb, offset, sd_len, ENC_NA);\r\noffset += sd_len;\r\nif (pd_len) {\r\nproto_tree_add_item(tree, hf_dplay_pp_player_data, tvb, offset, pd_len, ENC_NA);\r\noffset += pd_len;\r\n}\r\nfor (i=0; i < num_players; ++i) {\r\nproto_tree_add_item(tree, hf_dplay_pp_player_id, tvb, offset, 4, ENC_NA); offset += 4;\r\n}\r\nif (size + 4 > offset) {\r\nproto_tree_add_item(tree, hf_dplay_pp_parent_id, tvb, offset, 4, ENC_NA); offset += 4;\r\n}\r\nreturn offset;\r\n}\r\nstatic gint spp_get_value(guint32 length_type, tvbuff_t *tvb, gint offset, guint32 *value)\r\n{\r\ngint len = 0;\r\n*value = 0;\r\nswitch (length_type) {\r\ncase 1:\r\nlen = 1;\r\n*value = tvb_get_guint8(tvb, offset);\r\nbreak;\r\ncase 2:\r\nlen = 2;\r\n*value = tvb_get_letohs(tvb, offset);\r\nbreak;\r\ncase 3:\r\nlen = 4;\r\n*value = tvb_get_letohl(tvb, offset);\r\nbreak;\r\n}\r\nreturn len;\r\n}\r\nstatic gint dissect_dplay_super_packed_player(proto_tree *tree, tvbuff_t *tvb, gint offset)\r\n{\r\nguint32 flags, is_sysplayer, info_mask;\r\nguint32 have_short_name, have_long_name, sp_length_type, pd_length_type;\r\nguint32 player_count_type, have_parent_id, shortcut_count_type;\r\nguint32 player_data_length, sp_data_length, player_count, shortcut_count;\r\nproto_item *im_item = NULL;\r\nproto_tree *im_tree = NULL;\r\ngint len;\r\nstatic const int * ssp_flags[] = {\r\n&hf_dplay_spp_flags_sending,\r\n&hf_dplay_spp_flags_in_group,\r\n&hf_dplay_spp_flags_nameserver,\r\n&hf_dplay_spp_flags_sysplayer,\r\nNULL\r\n};\r\nproto_tree_add_item(tree, hf_dplay_spp_size, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nflags = tvb_get_letohl(tvb, offset);\r\nis_sysplayer = flags & 0x00000001;\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_dplay_spp_flags, ett_dplay_spp_flags, ssp_flags, ENC_LITTLE_ENDIAN); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_spp_id, tvb, offset, 4, ENC_NA); offset += 4;\r\ninfo_mask = tvb_get_letohl(tvb, offset);\r\nhave_short_name = info_mask & 0x00000001;\r\nhave_long_name = (info_mask & 0x00000002) >> 1;\r\nsp_length_type = (info_mask & 0x0000000c) >> 2;\r\npd_length_type = (info_mask & 0x00000030) >> 4;\r\nplayer_count_type = (info_mask & 0x000000c0) >> 6;\r\nhave_parent_id = (info_mask & 0x00000100) >> 8;\r\nshortcut_count_type = (info_mask & 0x00000600) >> 9;\r\nim_item = proto_tree_add_item(tree, hf_dplay_spp_player_info_mask, tvb, offset, 4, ENC_LITTLE_ENDIAN);\r\nim_tree = proto_item_add_subtree(im_item, ett_dplay_spp_info_mask);\r\nproto_tree_add_uint(im_tree, hf_dplay_spp_have_short_name, tvb, offset, 4, have_short_name);\r\nproto_tree_add_uint(im_tree, hf_dplay_spp_have_long_name, tvb, offset, 4, have_long_name);\r\nproto_tree_add_uint(im_tree, hf_dplay_spp_sp_length_type, tvb, offset, 4, sp_length_type);\r\nproto_tree_add_uint(im_tree, hf_dplay_spp_pd_length_type, tvb, offset, 4, pd_length_type);\r\nproto_tree_add_uint(im_tree, hf_dplay_spp_player_count_type, tvb, offset, 4, player_count_type);\r\nproto_tree_add_uint(im_tree, hf_dplay_spp_have_parent_id, tvb, offset, 4, have_parent_id);\r\nproto_tree_add_uint(im_tree, hf_dplay_spp_shortcut_count_type, tvb, offset, 4, shortcut_count_type);\r\noffset+=4;\r\nif (is_sysplayer) {\r\nproto_tree_add_item(tree, hf_dplay_spp_dialect, tvb, offset, 4, ENC_LITTLE_ENDIAN);\r\n} else {\r\nproto_tree_add_item(tree, hf_dplay_spp_sys_player_id, tvb, offset, 4, ENC_NA);\r\n}\r\noffset += 4;\r\nif (have_short_name) {\r\noffset = display_unicode_string(tree, hf_dplay_spp_short_name, tvb, offset);\r\n}\r\nif (have_long_name) {\r\noffset = display_unicode_string(tree, hf_dplay_spp_long_name, tvb, offset);\r\n}\r\nif (pd_length_type) {\r\nlen = spp_get_value(pd_length_type, tvb, offset, &player_data_length);\r\nproto_tree_add_item(tree, hf_dplay_spp_player_data_length, tvb, offset, len, ENC_LITTLE_ENDIAN);\r\noffset += len;\r\nproto_tree_add_item(tree, hf_dplay_spp_player_data, tvb, offset, player_data_length, ENC_NA);\r\noffset += player_data_length;\r\n}\r\nif (sp_length_type) {\r\nlen = spp_get_value(sp_length_type, tvb, offset, &sp_data_length);\r\nproto_tree_add_item(tree, hf_dplay_spp_sp_data_length, tvb, offset, len, ENC_LITTLE_ENDIAN);\r\noffset += len;\r\nproto_tree_add_item(tree, hf_dplay_spp_sp_data, tvb, offset, sp_data_length, ENC_NA);\r\noffset += sp_data_length;\r\n}\r\nif (player_count_type) {\r\nguint32 i;\r\nlen = spp_get_value(player_count_type, tvb, offset, &player_count);\r\nproto_tree_add_item(tree, hf_dplay_spp_player_count, tvb, offset, len, ENC_LITTLE_ENDIAN);\r\noffset += len;\r\nfor (i=0; i < player_count; ++i) {\r\nproto_tree_add_item(tree, hf_dplay_spp_player_id, tvb, offset, 4, ENC_NA); offset += 4;\r\n}\r\n}\r\nif (have_parent_id) {\r\nproto_tree_add_item(tree, hf_dplay_spp_parent_id, tvb, offset, 4, ENC_NA); offset += 4;\r\n}\r\nif (shortcut_count_type) {\r\nguint32 i;\r\nlen = spp_get_value(shortcut_count_type, tvb, offset, &shortcut_count);\r\nproto_tree_add_item(tree, hf_dplay_spp_shortcut_count, tvb, offset, len, ENC_LITTLE_ENDIAN);\r\noffset += len;\r\nfor (i=0; i < shortcut_count; ++i) {\r\nproto_tree_add_item(tree, hf_dplay_spp_shortcut_id, tvb, offset, 4, ENC_NA); offset += 4;\r\n}\r\n}\r\nreturn offset;\r\n}\r\nstatic gint dissect_security_desc(proto_tree *tree, tvbuff_t *tvb, gint offset)\r\n{\r\nproto_tree_add_item(tree, hf_dplay_sd_size, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_sd_flags, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_sd_sspi, tvb, offset, 4, ENC_NA); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_sd_capi, tvb, offset, 4, ENC_NA); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_sd_capi_type, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_sd_enc_alg, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nreturn offset;\r\n}\r\nstatic gint dissect_dplay_header(proto_tree *tree, tvbuff_t *tvb, gint offset)\r\n{\r\nguint32 mixed, size, token;\r\nmixed = tvb_get_letohl(tvb, offset);\r\nsize = mixed & 0x000FFFFF;\r\ntoken = (mixed & 0xFFF00000) >> 20;\r\nproto_tree_add_uint(tree, hf_dplay_size, tvb, offset, 4, size);\r\nproto_tree_add_uint(tree, hf_dplay_token, tvb, offset, 4, token);\r\noffset += 4;\r\noffset = dissect_sockaddr_in(tree, tvb, offset);\r\nproto_tree_add_item(tree, hf_dplay_play_str, tvb, offset, 4, ENC_ASCII|ENC_NA); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_command, tvb, offset, 2, ENC_LITTLE_ENDIAN); offset += 2;\r\nproto_tree_add_item(tree, hf_dplay_proto_dialect, tvb, offset, 2, ENC_LITTLE_ENDIAN); offset += 2;\r\nreturn offset;\r\n}\r\nstatic gint dissect_type01_message(proto_tree *tree, tvbuff_t *tvb, gint offset)\r\n{\r\nguint32 name_offset;\r\noffset = dissect_session_desc(tree, tvb, offset);\r\nname_offset = tvb_get_letohl(tvb, offset);\r\nproto_tree_add_item(tree, hf_dplay_type_01_name_offset, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nif (name_offset != 0) {\r\noffset = display_unicode_string(tree, hf_dplay_type_01_game_name, tvb, offset);\r\n}\r\nreturn offset;\r\n}\r\nstatic gint dissect_type02_message(proto_tree *tree, tvbuff_t *tvb, gint offset)\r\n{\r\nguint32 passwd_offset;\r\nstatic const int * flags[] = {\r\n&hf_enum_sess_flag_passwd,\r\n&hf_enum_sess_flag_all,\r\n&hf_enum_sess_flag_join,\r\nNULL\r\n};\r\npasswd_offset = tvb_get_letohl(tvb, offset + 16);\r\nproto_tree_add_item(tree, hf_dplay_type_02_game_guid, tvb, offset, 16, ENC_BIG_ENDIAN); offset += 16;\r\nproto_tree_add_item(tree, hf_dplay_type_02_password_offset, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_dplay_type_02_flags, ett_dplay_type02_flags, flags, ENC_LITTLE_ENDIAN); offset += 4;\r\nif (passwd_offset != 0) {\r\noffset = display_unicode_string(tree, hf_dplay_type_02_password, tvb, offset);\r\n}\r\nreturn offset;\r\n}\r\nstatic gint dissect_type05_message(proto_tree *tree, tvbuff_t *tvb, gint offset)\r\n{\r\nstatic const int * flags[] = {\r\n&hf_dplay_type_05_secure,\r\n&hf_dplay_type_05_unknown,\r\n&hf_dplay_type_05_local,\r\n&hf_dplay_type_05_name_server,\r\n&hf_dplay_type_05_system_player,\r\nNULL\r\n};\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_dplay_type_05_flags, ett_dplay_type05_flags, flags, ENC_LITTLE_ENDIAN);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic gint dissect_type07_message(proto_tree *tree, tvbuff_t *tvb, gint offset)\r\n{\r\nguint32 sspi_offset, capi_offset;\r\nproto_tree_add_item(tree, hf_dplay_type_07_dpid, tvb, offset, 4, ENC_NA); offset += 4;\r\noffset = dissect_security_desc(tree, tvb, offset);\r\nsspi_offset = tvb_get_letohl(tvb, offset);\r\nproto_tree_add_item(tree, hf_dplay_type_07_sspi_offset, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\ncapi_offset = tvb_get_letohl(tvb, offset);\r\nproto_tree_add_item(tree, hf_dplay_type_07_capi_offset, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_type_07_hresult, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nif (sspi_offset) {\r\noffset = display_unicode_string(tree, hf_dplay_type_07_sspi, tvb, offset);\r\n}\r\nif (capi_offset) {\r\noffset = display_unicode_string(tree, hf_dplay_type_07_capi, tvb, offset);\r\n}\r\nreturn offset;\r\n}\r\nstatic gint dissect_player_message(proto_tree *tree, tvbuff_t *tvb, gint offset)\r\n{\r\nguint32 pp_ofs;\r\nproto_tree_add_item(tree, hf_dplay_multi_id_to, tvb, offset, 4, ENC_NA); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_multi_player_id, tvb, offset, 4, ENC_NA); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_multi_group_id, tvb, offset, 4, ENC_NA); offset += 4;\r\npp_ofs = tvb_get_letohl(tvb, offset);\r\nproto_tree_add_item(tree, hf_dplay_multi_create_offset, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_multi_password_offset, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nif (pp_ofs)\r\noffset = dissect_packed_player(tree, tvb, offset);\r\nif (tvb_bytes_exist(tvb, offset, 2))\r\noffset = display_unicode_string(tree, hf_dplay_multi_password, tvb, offset);\r\nreturn offset;\r\n}\r\nstatic gint dissect_type0f_message(proto_tree *tree, tvbuff_t *tvb, gint offset)\r\n{\r\nguint32 data_size;\r\nproto_tree_add_item(tree, hf_dplay_type_0f_id_to, tvb, offset, 4, ENC_NA); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_type_0f_id, tvb, offset, 4, ENC_NA); offset += 4;\r\ndata_size = tvb_get_letohl(tvb, offset);\r\nproto_tree_add_item(tree, hf_dplay_type_0f_data_size, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_type_0f_data_offset, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_type_0f_data, tvb, offset, data_size, ENC_NA);\r\noffset += data_size;\r\nreturn offset;\r\n}\r\nstatic gint dissect_type13_message(proto_tree *tree, tvbuff_t *tvb, gint offset)\r\n{\r\nguint32 pp_ofs, pw_ofs;\r\nproto_tree_add_item(tree, hf_dplay_type_13_id_to, tvb, offset, 4, ENC_NA); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_type_13_player_id, tvb, offset, 4, ENC_NA); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_type_13_group_id, tvb, offset, 4, ENC_NA); offset += 4;\r\npp_ofs = tvb_get_letohl(tvb, offset);\r\nproto_tree_add_item(tree, hf_dplay_type_13_create_offset, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\npw_ofs = tvb_get_letohl(tvb, offset);\r\nproto_tree_add_item(tree, hf_dplay_type_13_password_offset, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nif (pp_ofs)\r\noffset = dissect_packed_player(tree, tvb, offset);\r\nif (pw_ofs)\r\noffset = display_unicode_string(tree, hf_dplay_type_13_password, tvb, offset);\r\nproto_tree_add_item(tree, hf_dplay_type_13_tick_count, tvb, offset, 4, ENC_NA); offset += 4;\r\nreturn offset;\r\n}\r\nstatic gint dissect_type15_message(proto_tree *tree, tvbuff_t *tvb, gint offset)\r\n{\r\nguint16 second_message_type;\r\nproto_tree *enc_tree;\r\nsecond_message_type = tvb_get_letohs(tvb, 72);\r\nproto_tree_add_item(tree, hf_dplay_message_guid, tvb, offset, 16, ENC_BIG_ENDIAN); offset += 16;\r\nproto_tree_add_item(tree, hf_dplay_type_15_packet_idx, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_type_15_data_size, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_type_15_offset, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_type_15_total_packets, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_type_15_msg_size, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_type_15_packet_offset, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nenc_tree = proto_tree_add_subtree(tree, tvb, offset, -1, ett_dplay_enc_packet, NULL, "DirectPlay encapsulated packet");\r\nproto_tree_add_item(enc_tree, hf_dplay_play_str_2, tvb, offset, 4, ENC_ASCII|ENC_NA); offset += 4;\r\nproto_tree_add_item(enc_tree, hf_dplay_command_2, tvb, offset, 2, ENC_LITTLE_ENDIAN); offset += 2;\r\nproto_tree_add_item(enc_tree, hf_dplay_proto_dialect_2, tvb, offset, 2, ENC_LITTLE_ENDIAN); offset += 2;\r\nswitch(second_message_type)\r\n{\r\ncase 0x0005:\r\noffset = dissect_type05_message(enc_tree, tvb, offset);\r\nbreak;\r\ncase 0x0007:\r\noffset = dissect_type05_message(enc_tree, tvb, offset);\r\nbreak;\r\ncase 0x0008:\r\ncase 0x0009:\r\ncase 0x000b:\r\ncase 0x000c:\r\ncase 0x000d:\r\ncase 0x000e:\r\ncase 0x002e:\r\noffset = dissect_player_message(enc_tree, tvb, offset);\r\nbreak;\r\ncase 0x0013:\r\noffset = dissect_type13_message(enc_tree, tvb, offset);\r\nbreak;\r\ncase 0x001a:\r\noffset = dissect_type1a_message(enc_tree, tvb, offset);\r\nbreak;\r\n}\r\nreturn offset;\r\n}\r\nstatic gint dissect_ping_message(proto_tree *tree, tvbuff_t *tvb, gint offset)\r\n{\r\nproto_tree_add_item(tree, hf_dplay_ping_id_from, tvb, offset, 4, ENC_NA); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_ping_tick_count, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nreturn offset;\r\n}\r\nstatic gint dissect_type1a_message(proto_tree *tree, tvbuff_t *tvb, gint offset)\r\n{\r\nguint32 sn_ofs, pw_ofs;\r\nproto_tree_add_item(tree, hf_dplay_type_1a_id_to, tvb, offset, 4, ENC_NA); offset += 4;\r\nsn_ofs = tvb_get_letohl(tvb, offset);\r\nproto_tree_add_item(tree, hf_dplay_type_1a_sess_name_ofs, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\npw_ofs = tvb_get_letohl(tvb, offset);\r\nproto_tree_add_item(tree, hf_dplay_type_1a_password_ofs, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\noffset = dissect_session_desc(tree, tvb, offset);\r\nif (sn_ofs) {\r\noffset = display_unicode_string(tree, hf_dplay_type_1a_session_name, tvb, offset);\r\n}\r\nif (pw_ofs) {\r\noffset = display_unicode_string(tree, hf_dplay_type_1a_password, tvb, offset);\r\n}\r\nreturn offset;\r\n}\r\nstatic gint dissect_type29_message(proto_tree *tree, tvbuff_t *tvb, gint offset)\r\n{\r\nguint32 password_offset = tvb_get_letohl(tvb, offset + 24);\r\ngint player_count, group_count, shortcut_count;\r\ngint i;\r\nplayer_count = tvb_get_letohl(tvb, offset);\r\nproto_tree_add_item(tree, hf_dplay_type_29_player_count, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\ngroup_count = tvb_get_letohl(tvb, offset);\r\nproto_tree_add_item(tree, hf_dplay_type_29_group_count, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_type_29_packed_offset, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nshortcut_count = tvb_get_letohl(tvb, offset);\r\nproto_tree_add_item(tree, hf_dplay_type_29_shortcut_count, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_type_29_description_offset, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_type_29_name_offset, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\nproto_tree_add_item(tree, hf_dplay_type_29_password_offset, tvb, offset, 4, ENC_LITTLE_ENDIAN); offset += 4;\r\noffset = dissect_session_desc(tree, tvb, offset);\r\noffset = display_unicode_string(tree, hf_dplay_type_29_game_name, tvb, offset);\r\nif (password_offset != 0) {\r\noffset = display_unicode_string(tree, hf_dplay_type_29_password, tvb, offset);\r\n}\r\nfor (i=0; i < player_count; ++i) {\r\nproto_tree *spp_tree;\r\nspp_tree = proto_tree_add_subtree_format(tree, tvb, offset, 0, ett_dplay_type29_spp, NULL, "Player %d", i);\r\noffset = dissect_dplay_super_packed_player(spp_tree, tvb, offset);\r\n}\r\nfor (i=0; i < group_count; ++i) {\r\nproto_tree *spp_tree;\r\nspp_tree = proto_tree_add_subtree_format(tree, tvb, offset, 0, ett_dplay_type29_spp, NULL, "Group %d", i);\r\noffset = dissect_dplay_super_packed_player(spp_tree, tvb, offset);\r\n}\r\nfor (i=0; i < shortcut_count; ++i) {\r\nproto_tree *spp_tree;\r\nspp_tree = proto_tree_add_subtree_format(tree, tvb, offset, 0, ett_dplay_type29_spp, NULL, "Shortcut %d", i);\r\noffset = dissect_dplay_super_packed_player(spp_tree, tvb, offset);\r\n}\r\nreturn offset;\r\n}\r\nstatic gint dissect_type2f_message(proto_tree *tree, tvbuff_t *tvb, gint offset)\r\n{\r\nproto_tree_add_item(tree, hf_dplay_type_2f_dpid, tvb, offset, 4, ENC_NA); offset += 4;\r\nreturn offset;\r\n}\r\nstatic void dissect_dplay(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint16 message_type;\r\nguint16 second_message_type = G_MAXUINT16;\r\nguint16 proto_version;\r\nguint32 dplay_id;\r\nguint8 play_id[] = {'p','l','a','y'};\r\ndplay_id = tvb_get_letohl(tvb, 20);\r\nmessage_type = tvb_get_letohs(tvb, 24);\r\nproto_version = tvb_get_letohs(tvb, 26);\r\nif(memcmp(play_id, (guint8 *)&dplay_id, 4) != 0)\r\n{\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "DPLAY");\r\ncol_set_str(pinfo->cinfo,COL_INFO, "DPlay data packet");\r\nreturn;\r\n}\r\nif(message_type == 0x0015)\r\n{\r\nsecond_message_type = tvb_get_letohs(tvb, 72);\r\n}\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "DPLAY");\r\nif(message_type == 0x0015)\r\ncol_add_fstr(pinfo->cinfo,COL_INFO, "%s: %s, holding a %s",\r\nval_to_str(proto_version, dplay_proto_dialect_val, "Unknown (0x%04x)"),\r\nval_to_str(message_type, dplay_command_val, "Unknown (0x%04x)"),\r\nval_to_str(second_message_type, dplay_command_val, "Unknown (0x%04x)"));\r\nelse\r\ncol_add_fstr(pinfo->cinfo,COL_INFO, "%s: %s",\r\nval_to_str(proto_version, dplay_proto_dialect_val, "Unknown (0x%04x)"),\r\nval_to_str(message_type, dplay_command_val, "Unknown (0x%04x)"));\r\nif(tree)\r\n{\r\nproto_item *dplay_item;\r\nproto_tree *dplay_tree;\r\nproto_tree *dplay_header;\r\nproto_tree *dplay_data;\r\ngint offset = 0;\r\ndplay_item = proto_tree_add_item(tree, proto_dplay, tvb, 0, -1, ENC_NA);\r\ndplay_tree = proto_item_add_subtree(dplay_item, ett_dplay);\r\ndplay_header = proto_tree_add_subtree(dplay_tree, tvb, offset, DPLAY_HEADER_OFFSET, ett_dplay_header, NULL, "DirectPlay header");\r\noffset = dissect_dplay_header(dplay_header, tvb, offset);\r\nif(message_type == 0x0004)\r\nreturn;\r\ndplay_data = proto_tree_add_subtree(dplay_tree, tvb, offset, -1, ett_dplay_data, NULL, "DirectPlay data");\r\nswitch(message_type)\r\n{\r\ncase 0x0001:\r\ndissect_type01_message(dplay_data, tvb, offset);\r\nbreak;\r\ncase 0x0002:\r\ndissect_type02_message(dplay_data, tvb, offset);\r\nbreak;\r\ncase 0x0005:\r\ndissect_type05_message(dplay_data, tvb, offset);\r\nbreak;\r\ncase 0x0007:\r\ndissect_type07_message(dplay_data, tvb, offset);\r\nbreak;\r\ncase 0x0008:\r\ncase 0x0009:\r\ncase 0x000b:\r\ncase 0x000c:\r\ncase 0x000d:\r\ncase 0x000e:\r\ncase 0x002e:\r\ncase 0x0038:\r\ndissect_player_message(dplay_data, tvb, offset);\r\nbreak;\r\ncase 0x000f:\r\ndissect_type0f_message(dplay_data, tvb, offset);\r\nbreak;\r\ncase 0x0013:\r\ndissect_type13_message(dplay_data, tvb, offset);\r\nbreak;\r\ncase 0x0015:\r\ndissect_type15_message(dplay_data, tvb, offset);\r\nbreak;\r\ncase 0x0016:\r\ncase 0x0017:\r\ndissect_ping_message(dplay_data, tvb, offset);\r\nbreak;\r\ncase 0x001a:\r\ndissect_type1a_message(dplay_data, tvb, offset);\r\nbreak;\r\ncase 0x0029:\r\ndissect_type29_message(dplay_data, tvb, offset);\r\nbreak;\r\ncase 0x002f:\r\ndissect_type2f_message(dplay_data, tvb, offset);\r\nbreak;\r\n}\r\n}\r\n}\r\nstatic void dissect_dplay_player_msg(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint32 mixed, size, token;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "DPLAY");\r\ncol_set_str(pinfo->cinfo,COL_INFO, "DPlay player to player message");\r\nif(tree)\r\n{\r\nproto_item *dplay_item;\r\nproto_tree *dplay_tree;\r\nproto_tree *data_tree;\r\ngint offset = 0;\r\ndplay_item = proto_tree_add_item(tree, proto_dplay, tvb, offset, -1, ENC_NA);\r\ndplay_tree = proto_item_add_subtree(dplay_item, ett_dplay);\r\ndata_tree = proto_tree_add_subtree(dplay_tree, tvb, offset, -1, ett_dplay_data, NULL, "Message content");\r\nmixed = tvb_get_letohl(tvb, offset);\r\nsize = mixed & 0x000FFFFF;\r\ntoken = (mixed & 0xFFF00000) >> 20;\r\nproto_tree_add_uint(data_tree, hf_dplay_size, tvb, offset, 4, size);\r\nproto_tree_add_uint(data_tree, hf_dplay_token, tvb, offset, 4, token);\r\noffset += 4;\r\noffset = dissect_sockaddr_in(data_tree, tvb, offset);\r\nproto_tree_add_item(data_tree, hf_dplay_player_msg, tvb, offset, -1, ENC_NA);\r\n}\r\n}\r\nstatic gboolean heur_dissect_dplay(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data _U_)\r\n{\r\nguint32 dplay_id, token;\r\nif(tvb_captured_length(tvb) < 25)\r\nreturn FALSE;\r\ndplay_id = tvb_get_letohl(tvb, 20);\r\nif( dplay_id == 0x706c6179) {\r\ndissect_dplay(tvb, pinfo, tree);\r\nreturn TRUE;\r\n}\r\ntoken = tvb_get_letohl(tvb, 0);\r\ntoken = (token & 0xfff00000) >> 20;\r\nif (token == 0xfab || token == 0xbab || token == 0xcab) {\r\nif (tvb_get_letohs(tvb, 4) == WINSOCK_AF_INET) {\r\nint offset;\r\nfor (offset = 12; offset <= 20; offset++)\r\nif (tvb_get_guint8(tvb, offset) != 0)\r\nreturn FALSE;\r\ndissect_dplay_player_msg(tvb, pinfo, tree);\r\nreturn TRUE;\r\n}\r\n}\r\nreturn FALSE;\r\n}\r\nvoid proto_register_dplay(void)\r\n{\r\nstatic hf_register_info hf [] = {\r\n{ &hf_dplay_size,\r\n{ "DirectPlay package size", "dplay.size", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_token,\r\n{ "DirectPlay token", "dplay.token", FT_UINT32, BASE_HEX,\r\nVALS(dplay_token_val), 0x0, NULL, HFILL}},\r\n{ &hf_dplay_saddr_af,\r\n{ "DirectPlay s_addr_in address family", "dplay.saddr.af", FT_UINT16, BASE_HEX,\r\nVALS(dplay_af_val), 0x0, NULL, HFILL}},\r\n{ &hf_dplay_saddr_port,\r\n{ "DirectPlay s_addr_in port", "dplay.saddr.port", FT_UINT16, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_saddr_ip,\r\n{ "DirectPlay s_addr_in ip address", "dplay.saddr.ip", FT_IPv4, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_saddr_padding,\r\n{ "DirectPlay s_addr_in null padding", "dplay.saddr.padding", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_play_str,\r\n{ "DirectPlay action string", "dplay.dplay_str", FT_STRING, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_command,\r\n{ "DirectPlay command", "dplay.command", FT_UINT16, BASE_HEX,\r\nVALS(dplay_command_val), 0x0, NULL, HFILL}},\r\n{ &hf_dplay_proto_dialect,\r\n{ "DirectPlay dialect version", "dplay.dialect.version", FT_UINT16, BASE_HEX,\r\nVALS(dplay_proto_dialect_val), 0x0, NULL, HFILL}},\r\n{ &hf_dplay_play_str_2,\r\n{ "DirectPlay second action string", "dplay.dplay_str_2", FT_STRING, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_command_2,\r\n{ "DirectPlay second command", "dplay.command_2", FT_UINT16, BASE_HEX,\r\nVALS(dplay_command_val), 0x0, NULL, HFILL}},\r\n{ &hf_dplay_proto_dialect_2,\r\n{ "DirectPlay second dialect version", "dplay.dialect.version_2", FT_UINT16, BASE_HEX,\r\nVALS(dplay_proto_dialect_val), 0x0, NULL, HFILL}},\r\n{ &hf_dplay_player_msg,\r\n{ "DirectPlay Player to Player message", "dplay.player_msg", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_sess_desc_flags,\r\n{ "DirectPlay session desc flags", "dplay.flags", FT_UINT32, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_flags_no_create_players,\r\n{ "no create players flag", "dplay.flags.no_create_players", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_FLAG_NO_CREATE_PLAYERS, "No Create Players", HFILL}},\r\n{ &hf_dplay_flags_0002,\r\n{ "unused", "dplay.flags.unused", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_FLAG_0002, NULL, HFILL}},\r\n{ &hf_dplay_flags_migrate_host,\r\n{ "migrate host flag", "dplay.flags.migrate_host", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_FLAG_MIGRATE_HOST, "Migrate Host", HFILL}},\r\n{ &hf_dplay_flags_short_player_msg,\r\n{ "short player message", "dplay.flags.short_player_msg", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_FLAG_SHORT_PLAYER_MSG, "Short Player Msg", HFILL}},\r\n{ &hf_dplay_flags_ignored,\r\n{ "ignored", "dplay.flags.ignored", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_FLAG_IGNORED, NULL, HFILL}},\r\n{ &hf_dplay_flags_can_join,\r\n{ "can join", "dplay.flags.can_join", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_FLAG_CAN_JOIN, NULL, HFILL}},\r\n{ &hf_dplay_flags_use_ping,\r\n{ "use ping", "dplay.flags.use_ping", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_FLAG_USE_PING, NULL, HFILL}},\r\n{ &hf_dplay_flags_no_player_updates,\r\n{ "no player updates", "dplay.flags.no_player_updates", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_FLAG_NO_P_UPD, NULL, HFILL}},\r\n{ &hf_dplay_flags_use_auth,\r\n{ "use authentication", "dplay.flags.use_auth", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_FLAG_USE_AUTH, "Use Auth", HFILL}},\r\n{ &hf_dplay_flags_private_session,\r\n{ "private session", "dplay.flags.priv_sess", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_FLAG_PRIV_SESS, "Priv Session", HFILL}},\r\n{ &hf_dplay_flags_password_req,\r\n{ "password required", "dplay.flags.pass_req", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_FLAG_PASS_REQ, "Pass Req", HFILL}},\r\n{ &hf_dplay_flags_route,\r\n{ "route via game host", "dplay.flags.route", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_FLAG_ROUTE, "Route", HFILL}},\r\n{ &hf_dplay_flags_server_player_only,\r\n{ "get server player only", "dplay.flags.srv_p_only", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_FLAG_SRV_ONLY, "Svr Player Only", HFILL}},\r\n{ &hf_dplay_flags_reliable,\r\n{ "use reliable protocol", "dplay.flags.reliable", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_FLAG_RELIABLE, "Reliable", HFILL}},\r\n{ &hf_dplay_flags_preserve_order,\r\n{ "preserve order", "dplay.flags.order", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_FLAG_ORDER, "Order", HFILL}},\r\n{ &hf_dplay_flags_optimize_latency,\r\n{ "optimize for latency", "dplay.flags.opt_latency", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_FLAG_OPT_LAT, "Opt Latency", HFILL}},\r\n{ &hf_dplay_flags_acqire_voice,\r\n{ "acquire voice", "dplay.flags.acq_voice", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_FLAG_ACQ_VOICE, "Acq Voice", HFILL}},\r\n{ &hf_dplay_flags_no_sess_desc_changes,\r\n{ "no session desc changes", "dplay.flags.no_sess_desc", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_FLAG_NO_SESS_DESC_CHANGES, "No Sess Desc Changes", HFILL}},\r\n{ &hf_dplay_instance_guid,\r\n{ "DirectPlay instance guid", "dplay.instance.guid", FT_GUID, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_game_guid,\r\n{ "DirectPlay game GUID", "dplay.game.guid", FT_GUID, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_sess_desc_length,\r\n{ "DirectPlay session desc length", "dplay.sess_desc.length", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_max_players,\r\n{ "DirectPlay max players", "dplay.sess_desc.max_players", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_curr_players,\r\n{ "DirectPlay current players", "dplay.sess_desc.curr_players", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_sess_name_ptr,\r\n{ "Session description name pointer placeholder", "dplay.sess_desc.name_ptr", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_passwd_ptr,\r\n{ "Session description password pointer placeholder", "dplay.sess_desc.pw_ptr", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_sess_desc_reserved_1,\r\n{ "Session description reserved 1", "dplay.sess_desc.res_1", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_sess_desc_reserved_2,\r\n{ "Session description reserved 2", "dplay.sess_desc.res_2", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_sess_desc_user_1,\r\n{ "Session description user defined 1", "dplay.sess_desc.user_1", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_sess_desc_user_2,\r\n{ "Session description user defined 2", "dplay.sess_desc.user_2", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_sess_desc_user_3,\r\n{ "Session description user defined 3", "dplay.sess_desc.user_3", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_sess_desc_user_4,\r\n{ "Session description user defined 4", "dplay.sess_desc.user_4", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_pp_size,\r\n{ "PackedPlayer size", "dplay.pp.size", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_pp_flags,\r\n{ "PackedPlayer flags", "dplay.pp.flags", FT_UINT32, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_pp_flag_sysplayer,\r\n{ "is system player", "dplay.pp.flags.sysplayer", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_PP_FLAG_SYSPLAYER, NULL, HFILL}},\r\n{ &hf_dplay_pp_flag_nameserver,\r\n{ "is name server", "dplay.pp.flags.nameserver", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_PP_FLAG_NAMESERVER, NULL, HFILL}},\r\n{ &hf_dplay_pp_flag_in_group,\r\n{ "in group", "dplay.pp.flags.in_group", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_PP_FLAG_IN_GROUP, NULL, HFILL}},\r\n{ &hf_dplay_pp_flag_sending,\r\n{ "sending player on local machine", "dplay.pp.flags.sending", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_SPP_FLAG_SENDING, NULL, HFILL}},\r\n{ &hf_dplay_pp_id,\r\n{ "PackedPlayer ID", "dplay.pp.id", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_pp_short_name_len,\r\n{ "PackedPlayer short name length", "dplay.pp.short_name_len", FT_UINT32, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_pp_long_name_len,\r\n{ "PackedPlayer long name length", "dplay.pp.long_name_len", FT_UINT32, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_pp_sp_data_size,\r\n{ "PackedPlayer service provider data size", "dplay.pp.sp_data_size", FT_UINT32, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_pp_player_data_size,\r\n{ "PackedPlayer player data size", "dplay.pp.player_data_size", FT_UINT32, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_pp_num_players,\r\n{ "PackedPlayer player count", "dplay.pp.player_count", FT_UINT32, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_pp_system_player,\r\n{ "PackedPlayer system player ID", "dplay.pp.sysplayer_id", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_pp_fixed_size,\r\n{ "PackedPlayer fixed size", "dplay.pp.fixed_size", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_pp_dialect,\r\n{ "PackedPlayer dialect version", "dplay.pp.dialect", FT_UINT32, BASE_HEX,\r\nVALS(dplay_proto_dialect_val), 0x0, NULL, HFILL}},\r\n{ &hf_dplay_pp_unknown_1,\r\n{ "PackedPlayer unknown 1", "dplay.pp.unknown_1", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_pp_short_name,\r\n{ "PackedPlayer short name", "dplay.pp.short_name", FT_STRING, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_pp_long_name,\r\n{ "PackedPlayer long name", "dplay.pp.long_name", FT_STRING, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_pp_player_data,\r\n{ "PackedPlayer player data", "dplay.pp.player_data", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_pp_sp_data,\r\n{ "PackedPlayer service provider data", "dplay.pp.sp_data", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_pp_player_id,\r\n{ "PackedPlayer player ID", "dplay.pp.player_id", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_pp_parent_id,\r\n{ "PackedPlayer parent ID", "dplay.pp.parent_id", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_spp_size,\r\n{ "SuperPackedPlayer size", "dplay.spp.size", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_spp_flags,\r\n{ "SuperPackedPlayer flags", "dplay.spp.flags", FT_UINT32, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_spp_flags_sysplayer,\r\n{ "is system player", "dplay.spp.flags.sysplayer", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_SPP_FLAG_SYSPLAYER, NULL, HFILL}},\r\n{ &hf_dplay_spp_flags_nameserver,\r\n{ "is name server", "dplay.spp.flags.nameserver", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_SPP_FLAG_NAMESERVER, NULL, HFILL}},\r\n{ &hf_dplay_spp_flags_in_group,\r\n{ "in group", "dplay.spp.flags.in_group", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_SPP_FLAG_IN_GROUP, NULL, HFILL}},\r\n{ &hf_dplay_spp_flags_sending,\r\n{ "sending player on local machine", "dplay.spp.flags.sending", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_SPP_FLAG_SENDING, NULL, HFILL}},\r\n{ &hf_dplay_spp_id,\r\n{ "SuperPackedPlayer ID", "dplay.spp.id", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_spp_player_info_mask,\r\n{ "SuperPackedPlayer player info mask", "dplay.spp.pim", FT_UINT32, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_spp_have_short_name,\r\n{ "SuperPackedPlayer have short name", "dplay.spp.pim.short_name", FT_UINT32, BASE_HEX,\r\nVALS(yes_no_val), 0x0, NULL, HFILL}},\r\n{ &hf_dplay_spp_have_long_name,\r\n{ "SuperPackedPlayer have long name", "dplay.spp.pim.long_name", FT_UINT32, BASE_HEX,\r\nVALS(yes_no_val), 0x0, NULL, HFILL}},\r\n{ &hf_dplay_spp_sp_length_type,\r\n{ "SuperPackedPlayer service provider length info", "dplay.spp.pim.sp_length", FT_UINT32, BASE_HEX,\r\nVALS(dplay_spp_length_val), 0x0, NULL, HFILL}},\r\n{ &hf_dplay_spp_pd_length_type,\r\n{ "SuperPackedPlayer player data length info", "dplay.spp.pim.pd_length", FT_UINT32, BASE_HEX,\r\nVALS(dplay_spp_length_val), 0x0, NULL, HFILL}},\r\n{ &hf_dplay_spp_player_count_type,\r\n{ "SuperPackedPlayer player count info", "dplay.spp.pim.player_count", FT_UINT32, BASE_HEX,\r\nVALS(dplay_spp_length_val), 0x0, NULL, HFILL}},\r\n{ &hf_dplay_spp_have_parent_id,\r\n{ "SuperPackedPlayer have parent ID", "dplay.spp.pim.parent_id", FT_UINT32, BASE_HEX,\r\nVALS(yes_no_val), 0x0, NULL, HFILL}},\r\n{ &hf_dplay_spp_shortcut_count_type,\r\n{ "SuperPackedPlayer shortcut count info", "dplay.spp.pim.shortcut_count", FT_UINT32, BASE_HEX,\r\nVALS(dplay_spp_length_val), 0x0, NULL, HFILL}},\r\n{ &hf_dplay_spp_dialect,\r\n{ "SuperPackedPlayer dialect version", "dplay.spp.dialect", FT_UINT32, BASE_HEX,\r\nVALS(dplay_proto_dialect_val), 0x0, NULL, HFILL}},\r\n{ &hf_dplay_spp_sys_player_id,\r\n{ "SuperPackedPlayer system player ID", "dplay.spp.sysplayer_id", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_spp_short_name,\r\n{ "SuperPackedPlayer short name", "dplay.spp.short_name", FT_STRING, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_spp_long_name,\r\n{ "SuperPackedPlayer long name", "dplay.spp.long_name", FT_STRING, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_spp_player_data_length,\r\n{ "SuperPackedPlayer player data length", "dplay.spp.pd_length", FT_UINT32, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_spp_player_data,\r\n{ "SuperPackedPlayer player data", "dplay.spp.player_data", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_spp_sp_data_length,\r\n{ "SuperPackedPlayer service provider data length", "dplay.spp.sp_data_length", FT_UINT32, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_spp_sp_data,\r\n{ "SuperPackedPlayer service provider data", "dplay.spp.sp_data", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_spp_player_count,\r\n{ "SuperPackedPlayer player count", "dplay.spp.player_count", FT_UINT32, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_spp_player_id,\r\n{ "SuperPackedPlayer player ID", "dplay.spp.player_id", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_spp_parent_id,\r\n{ "SuperPackedPlayer parent ID", "dplay.spp.parent_id", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_spp_shortcut_count,\r\n{ "SuperPackedPlayer shortcut count", "dplay.spp.shortcut_count", FT_UINT32, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_spp_shortcut_id,\r\n{ "SuperPackedPlayer shortcut ID", "dplay.spp.shortcut_id", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_sd_size,\r\n{ "SecDesc struct size", "dplay.sd.size", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_sd_flags,\r\n{ "SecDesc flags", "dplay.sd.flags", FT_UINT32, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_sd_sspi,\r\n{ "SecDesc SSPI provider ptr", "dplay.sd.sspi", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_sd_capi,\r\n{ "SecDesc CAPI provider ptr", "dplay.sd.capi", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_sd_capi_type,\r\n{ "SecDesc CAPI provider type", "dplay.sd.capi_type", FT_UINT32, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_sd_enc_alg,\r\n{ "SecDesc encryption algorithm" , "dplay.sd.enc_alg", FT_UINT32, BASE_HEX,\r\nVALS(dplay_enc_alg_val), 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_01_name_offset,\r\n{ "Enum Session Reply name offset", "dplay.type_01.name_offs", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_01_game_name,\r\n{ "Enum Session Reply game name", "dplay.type_01.game_name", FT_STRING, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_02_game_guid,\r\n{ "DirectPlay game GUID", "dplay.type02.game.guid", FT_GUID, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_02_password_offset,\r\n{ "Enum Sessions password offset", "dplay.type02.password_offset", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_02_flags,\r\n{ "Enum Session flags", "dplay.type02.flags", FT_UINT32, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_02_password,\r\n{ "Session password", "dplay.type02.password", FT_STRING, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_enum_sess_flag_join,\r\n{ "Enumerate joinable sessions", "dplay.type02.joinable", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_ENUM_SESS_FLAG_JOIN, "Joinable", HFILL}},\r\n{ &hf_enum_sess_flag_all,\r\n{ "Enumerate all sessions", "dplay.type02.all", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_ENUM_SESS_FLAG_ALL, "All", HFILL}},\r\n{ &hf_enum_sess_flag_passwd,\r\n{ "Enumerate sessions requiring a password", "dplay.type02.pw_req", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_ENUM_SESS_FLAG_PASSWD, "Password", HFILL}},\r\n{ &hf_dplay_type_05_flags,\r\n{ "Player ID request flags", "dplay.type_05.flags", FT_UINT32, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_05_system_player,\r\n{ "is system player", "dplay.type_05.flags.sys_player", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_TYPE05_FLAG_SYSPLAYER, NULL, HFILL}},\r\n{ &hf_dplay_type_05_name_server,\r\n{ "is name server", "dplay.type_05.flags.name_server", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_TYPE05_FLAG_NAMESERVER, NULL, HFILL}},\r\n{ &hf_dplay_type_05_local,\r\n{ "is local player", "dplay.type_05.flags.local", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_TYPE05_FLAG_LOCAL, NULL, HFILL}},\r\n{ &hf_dplay_type_05_unknown,\r\n{ "unknown", "dplay.type_05.flags.unknown", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_TYPE05_FLAG_UNKNOWN, NULL, HFILL}},\r\n{ &hf_dplay_type_05_secure,\r\n{ "is secure session", "dplay.type_05.flags.secure", FT_BOOLEAN, 32,\r\nTFS(&tfs_dplay_flag), DPLAY_TYPE05_FLAG_SECURE, NULL, HFILL}},\r\n{ &hf_dplay_type_07_dpid,\r\n{ "DirectPlay ID", "dplay.type_07.dpid", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_07_sspi_offset,\r\n{ "SSPI provider offset", "dplay.type_07.sspi_offset", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_07_capi_offset,\r\n{ "CAPI provider offset", "dplay.type_07.capi_offset", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_07_hresult,\r\n{ "Request player HRESULT", "dplay.type_07.hresult", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_07_sspi,\r\n{ "SSPI provider", "dplay.type_07.sspi", FT_STRING, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_07_capi,\r\n{ "CAPI provider", "dplay.type_07.capi", FT_STRING, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_multi_id_to,\r\n{ "ID to", "dplay.multi.id_to", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_multi_player_id,\r\n{ "Player ID", "dplay.multi.player_id", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_multi_group_id,\r\n{ "Group ID", "dplay.multi.group_id", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_multi_create_offset,\r\n{ "Offset to PackedPlayer struct", "dplay.multi.create_offset", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_multi_password_offset,\r\n{ "Offset to password", "dplay.multi.password_offset", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_multi_password,\r\n{ "Password", "dplay.multi.password", FT_STRING, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_0f_id_to,\r\n{ "ID to", "dplay.type_0f.id_to", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_0f_id,\r\n{ "Player ID", "dplay.type_0f.player_id", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_0f_data_size,\r\n{ "Data Size", "dplay.type_0f.data_size", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_0f_data_offset,\r\n{ "Data Offset", "dplay.type_0f.data_offset", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_0f_data,\r\n{ "Player Data", "dplay.type_0f.player_data", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_13_id_to,\r\n{ "ID to", "dplay.type_13.id_to", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_13_player_id,\r\n{ "Player ID", "dplay.type_13.player_id", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_13_group_id,\r\n{ "Group ID", "dplay.type_13.group_id", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_13_create_offset,\r\n{ "Create Offset", "dplay.type_13.create_offset", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_13_password_offset,\r\n{ "Password Offset", "dplay.type_13.password_offset", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_13_password,\r\n{ "Password", "dplay.type_13.password", FT_STRING, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_13_tick_count,\r\n{ "Tick count? Looks like an ID", "dplay.type_13.tick_count", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_message_guid,\r\n{ "Message GUID", "dplay.message.guid", FT_GUID, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_15_packet_idx,\r\n{ "Packet Index", "dplay.type_15.packet_idx", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_15_data_size,\r\n{ "Data Size", "dplay.type_15.data_size", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_15_offset,\r\n{ "Offset", "dplay.type_15.offset", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_15_total_packets,\r\n{ "Total Packets", "dplay.type_15.total_packets", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_15_msg_size,\r\n{ "Message size", "dplay.type_15.message.size", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_15_packet_offset,\r\n{ "Packet offset", "dplay.type_15.packet_offset", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_ping_id_from,\r\n{ "ID From", "dplay.ping.id_from", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_ping_tick_count,\r\n{ "Tick Count", "dplay.ping.tick_count", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_1a_id_to,\r\n{ "ID From", "dplay.type_1a.id_to", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_1a_sess_name_ofs,\r\n{ "Session Name Offset", "dplay.type_1a.sess_name_ofs", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_1a_password_ofs,\r\n{ "Password Offset", "dplay.type_1a.password_offset", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_1a_session_name,\r\n{ "Session Name", "dplay.type_1a.session_name", FT_STRING, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_1a_password,\r\n{ "Password", "dplay.type_1a.password", FT_STRING, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_29_player_count,\r\n{ "SuperEnumPlayers Reply player count", "dplay.type_29.player_count", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_29_group_count,\r\n{ "SuperEnumPlayers Reply group count", "dplay.type_29.group_count", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_29_packed_offset,\r\n{ "SuperEnumPlayers Reply packed offset", "dplay.type_29.packed_offset", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_29_shortcut_count,\r\n{ "SuperEnumPlayers Reply shortcut count", "dplay.type_29.shortcut_count", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_29_description_offset,\r\n{ "SuperEnumPlayers Reply description offset", "dplay.type_29.desc_offset", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_29_name_offset,\r\n{ "SuperEnumPlayers Reply name offset", "dplay.type_29.name_offset", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_29_password_offset,\r\n{ "SuperEnumPlayers Reply password offset", "dplay.type_29.pass_offset", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_29_game_name,\r\n{ "SuperEnumPlayers Reply game name", "dplay.type_29.game_name", FT_STRING, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_29_password,\r\n{ "SuperEnumPlayers Reply Password", "dplay.type_29.password", FT_STRING, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_dplay_type_2f_dpid,\r\n{ "ID of the forwarded player", "dplay.type_29.id", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_dplay,\r\n&ett_dplay_header,\r\n&ett_dplay_sockaddr,\r\n&ett_dplay_data,\r\n&ett_dplay_flags,\r\n&ett_dplay_enc_packet,\r\n&ett_dplay_sess_desc_flags,\r\n&ett_dplay_pp_flags,\r\n&ett_dplay_spp_flags,\r\n&ett_dplay_spp_info_mask,\r\n&ett_dplay_type02_flags,\r\n&ett_dplay_type05_flags,\r\n&ett_dplay_type29_spp,\r\n};\r\nproto_dplay = proto_register_protocol (\r\n"DirectPlay Protocol",\r\n"DPLAY",\r\n"dplay"\r\n);\r\nproto_register_field_array(proto_dplay, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid proto_reg_handoff_dplay(void)\r\n{\r\nheur_dissector_add("udp", heur_dissect_dplay, "DirectPlay over UDP", "dplay_udp", proto_dplay, HEURISTIC_ENABLE);\r\nheur_dissector_add("tcp", heur_dissect_dplay, "DirectPlay over TCP", "dplay_tcp", proto_dplay, HEURISTIC_ENABLE);\r\n}
