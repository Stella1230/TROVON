static void\r\nvalidate_boolean(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree _U_, int offset, proto_item *boolean_item)\r\n{\r\nguint8 booleanByte;\r\nbooleanByte = tvb_get_guint8(tvb, offset);\r\nif (booleanByte != FALSE && booleanByte != TRUE)\r\n{\r\nexpert_add_info(pinfo, boolean_item, &ei_openwire_encoding_not_supported);\r\n}\r\n}\r\nstatic int\r\nparticularize(int specificField, int genericField)\r\n{\r\nreturn (specificField == hf_openwire_none ? genericField : specificField);\r\n}\r\nstatic void\r\ndetect_protocol_options(tvbuff_t *tvb, packet_info *pinfo, int offset, int iCommand)\r\n{\r\nif (tvb_captured_length_remaining(tvb, offset) >= 12)\r\n{\r\nif (iCommand == OPENWIRE_SESSION_INFO\r\n|| iCommand == OPENWIRE_DESTINATION_INFO\r\n|| iCommand == OPENWIRE_CONNECTION_INFO\r\n|| iCommand == OPENWIRE_CONSUMER_INFO\r\n|| iCommand == OPENWIRE_PRODUCER_INFO\r\n|| iCommand == OPENWIRE_BROKER_INFO\r\n|| iCommand == OPENWIRE_TRANSACTION_INFO\r\n|| iCommand == OPENWIRE_REMOVE_SUBSCRIPTION_INFO\r\n|| iCommand == OPENWIRE_MESSAGE_DISPATCH\r\n|| iCommand == OPENWIRE_MESSAGE_ACK\r\n|| iCommand == OPENWIRE_MESSAGE_PULL)\r\n{\r\nconversation_t *conv = NULL;\r\nopenwire_conv_data *cd = NULL;\r\nconv = find_or_create_conversation(pinfo);\r\ncd = (openwire_conv_data*)conversation_get_proto_data(conv, proto_openwire);\r\nif (!cd)\r\n{\r\nguint8 present, type;\r\ngint command_id = 0;\r\npresent = tvb_get_guint8(tvb, offset + 10);\r\ntype = tvb_get_guint8(tvb, offset + 11);\r\ncommand_id = tvb_get_ntohl(tvb, offset + 5);\r\ncd = wmem_new(wmem_file_scope(), openwire_conv_data);\r\ncd->caching = FALSE;\r\ncd->tight = FALSE;\r\nif (command_id > (1 << 24))\r\n{\r\ncd->tight = TRUE;\r\n}\r\nelse\r\n{\r\nif (present == TRUE && type == OPENWIRE_TYPE_NULL)\r\n{\r\ncd->caching = TRUE;\r\n}\r\n}\r\nconversation_add_proto_data(conv, proto_openwire, cd);\r\n}\r\n}\r\n}\r\nelse if ((tvb_get_guint8(tvb, 4) == OPENWIRE_KEEP_ALIVE_INFO)\r\n&& (tvb_captured_length(tvb) == 11))\r\n{\r\nconversation_t *conv = NULL;\r\nopenwire_conv_data *cd = NULL;\r\nconv = find_or_create_conversation(pinfo);\r\ncd = (openwire_conv_data*)conversation_get_proto_data(conv, proto_openwire);\r\nif (!cd)\r\n{\r\ncd = wmem_new(wmem_file_scope(), openwire_conv_data);\r\ncd->tight = TRUE;\r\ncd->caching = FALSE;\r\nconversation_add_proto_data(conv, proto_openwire, cd);\r\n}\r\n}\r\n}\r\nstatic gboolean\r\nretrieve_caching(packet_info *pinfo)\r\n{\r\nconversation_t *conv;\r\nopenwire_conv_data *cd;\r\nconv = find_or_create_conversation(pinfo);\r\ncd = (openwire_conv_data*)conversation_get_proto_data(conv, proto_openwire);\r\nif (cd) return cd->caching;\r\nreturn FALSE;\r\n}\r\nstatic gboolean\r\nretrieve_tight(packet_info *pinfo)\r\n{\r\nconversation_t *conv;\r\nopenwire_conv_data *cd;\r\nconv = find_or_create_conversation(pinfo);\r\ncd = (openwire_conv_data*)conversation_get_proto_data(conv, proto_openwire);\r\nif (cd && cd->tight) return TRUE;\r\nreturn FALSE;\r\n}\r\nstatic int\r\ndissect_openwire_type(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, int offset, int field, int type, int parentType, gboolean nullable)\r\n{\r\ngint startOffset = offset;\r\nproto_item *boolean_item = NULL;\r\nconst char *cache_str = "";\r\nif (type == OPENWIRE_TYPE_CACHED && retrieve_caching(pinfo) == TRUE && tvb_reported_length_remaining(tvb, offset) >= 3)\r\n{\r\nguint8 inlined = 0;\r\ngint cachedID = 0;\r\nproto_item * cached_item = NULL;\r\ninlined = tvb_get_guint8(tvb, offset + 0) == TRUE ? TRUE : FALSE;\r\ncachedID = tvb_get_ntohs(tvb, offset + 1);\r\ncache_str = wmem_strdup_printf(wmem_packet_scope(), " (CachedID: %d)", cachedID);\r\nif (openwire_verbose_type)\r\n{\r\nproto_tree_add_item(tree, hf_openwire_cached_inlined, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\ncached_item = proto_tree_add_item(tree, hf_openwire_cached_id, tvb, offset + 1, 2, ENC_BIG_ENDIAN);\r\nif (!openwire_verbose_type)\r\n{\r\nPROTO_ITEM_SET_HIDDEN(cached_item);\r\n}\r\nif (inlined == FALSE)\r\n{\r\nproto_item *ti;\r\nti = proto_tree_add_item(tree, particularize(field, hf_openwire_type_object), tvb, startOffset, 3, ENC_NA);\r\nproto_item_append_text(ti, "%s", cache_str);\r\nreturn 3;\r\n}\r\nelse\r\n{\r\noffset += 3;\r\n}\r\n}\r\nif (nullable == TRUE && (type == OPENWIRE_TYPE_NESTED || type == OPENWIRE_TYPE_CACHED || type == OPENWIRE_COMMAND_INNER) && tvb_reported_length_remaining(tvb, offset) >= 1)\r\n{\r\nnullable = tvb_get_guint8(tvb, offset + 0) == FALSE ? TRUE : FALSE;\r\nif (openwire_verbose_type)\r\n{\r\nboolean_item = proto_tree_add_item(tree, hf_openwire_type_notnull, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nvalidate_boolean(tvb, pinfo, tree, offset, boolean_item);\r\nif (nullable == TRUE)\r\n{\r\nproto_tree_add_item(tree, particularize(field, hf_openwire_none), tvb, offset, 1, ENC_NA);\r\nreturn offset - startOffset + 1;\r\n}\r\noffset += 1;\r\n}\r\nif (type == OPENWIRE_COMMAND_INNER && tvb_reported_length_remaining(tvb, offset) >= 1)\r\n{\r\nproto_item * inner_item = NULL;\r\nproto_tree * object_tree = NULL;\r\nguint8 iCommand = parentType;\r\niCommand = tvb_get_guint8(tvb, offset + 0);\r\ninner_item = proto_tree_add_item(tree, particularize(field, hf_openwire_none), tvb, startOffset, -1, ENC_NA);\r\nproto_item_append_text(inner_item, ": %s", val_to_str_ext(iCommand, &openwire_opcode_vals_ext, "Unknown (0x%02x)"));\r\nobject_tree = proto_item_add_subtree(inner_item, ett_openwire_type);\r\nreturn (1 + dissect_openwire_command(tvb, pinfo, object_tree, offset, parentType));\r\n}\r\nif ((type == OPENWIRE_TYPE_NESTED || type == OPENWIRE_TYPE_CACHED) && tvb_reported_length_remaining(tvb, offset) >= 1)\r\n{\r\ntype = tvb_get_guint8(tvb, offset + 0);\r\nif (openwire_verbose_type)\r\n{\r\nproto_tree_add_item(tree, hf_openwire_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\noffset += 1;\r\n}\r\nif (nullable == TRUE && tvb_reported_length_remaining(tvb, offset) >= 1)\r\n{\r\nnullable = tvb_get_guint8(tvb, offset + 0) == FALSE ? TRUE : FALSE;\r\nif (openwire_verbose_type)\r\n{\r\nboolean_item = proto_tree_add_item(tree, hf_openwire_type_notnull, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nvalidate_boolean(tvb, pinfo, tree, offset, boolean_item);\r\nif (nullable == TRUE)\r\n{\r\nproto_tree_add_item(tree, particularize(field, hf_openwire_none), tvb, offset, 1, ENC_NA);\r\nreturn offset - startOffset + 1;\r\n}\r\noffset += 1;\r\n}\r\nif (type == OPENWIRE_TYPE_NULL)\r\n{\r\noffset += 0;\r\n}\r\nelse if (type == OPENWIRE_TYPE_INTEGER && tvb_reported_length_remaining(tvb, offset) >= 4)\r\n{\r\nproto_tree_add_item(tree, particularize(field, hf_openwire_type_integer), tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\n}\r\nelse if (type == OPENWIRE_TYPE_SHORT && tvb_reported_length_remaining(tvb, offset) >= 2)\r\n{\r\nproto_tree_add_item(tree, particularize(field, hf_openwire_type_short), tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\nelse if (type == OPENWIRE_TYPE_LONG && tvb_reported_length_remaining(tvb, offset) >= 8)\r\n{\r\nproto_tree_add_item(tree, particularize(field, hf_openwire_type_long), tvb, offset, 8, ENC_BIG_ENDIAN);\r\noffset += 8;\r\n}\r\nelse if (type == OPENWIRE_TYPE_BOOLEAN && tvb_reported_length_remaining(tvb, offset) >= 1)\r\n{\r\nboolean_item = proto_tree_add_item(tree, particularize(field, hf_openwire_type_boolean), tvb, offset, 1, ENC_BIG_ENDIAN);\r\nvalidate_boolean(tvb, pinfo, tree, offset, boolean_item);\r\noffset += 1;\r\n}\r\nelse if (type == OPENWIRE_TYPE_BYTE && tvb_reported_length_remaining(tvb, offset) >= 1)\r\n{\r\nproto_tree_add_item(tree, particularize(field, hf_openwire_type_byte), tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\n}\r\nelse if (type == OPENWIRE_TYPE_CHAR && tvb_reported_length_remaining(tvb, offset) >= 2)\r\n{\r\nproto_tree_add_item(tree, particularize(field, hf_openwire_type_char), tvb, offset, 2, ENC_NA);\r\noffset += 2;\r\n}\r\nelse if (type == OPENWIRE_TYPE_FLOAT && tvb_reported_length_remaining(tvb, offset) >= 4)\r\n{\r\nproto_tree_add_item(tree, particularize(field, hf_openwire_type_float), tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\n}\r\nelse if (type == OPENWIRE_TYPE_DOUBLE && tvb_reported_length_remaining(tvb, offset) >= 8)\r\n{\r\nproto_tree_add_item(tree, particularize(field, hf_openwire_type_double), tvb, offset, 8, ENC_BIG_ENDIAN);\r\noffset += 8;\r\n}\r\nelse if (type == OPENWIRE_TYPE_STRING && tvb_reported_length_remaining(tvb, offset) >= 2)\r\n{\r\ngint iStringLength = 0;\r\niStringLength = tvb_get_ntohs(tvb, offset);\r\nif (openwire_verbose_type)\r\n{\r\nproto_tree_add_item(tree, hf_openwire_type_short, tvb, offset, 2, ENC_BIG_ENDIAN);\r\n}\r\noffset += 2;\r\nif (tvb_reported_length_remaining(tvb, offset) >= iStringLength)\r\n{\r\nproto_tree_add_item(tree, particularize(field, hf_openwire_type_string), tvb, offset, iStringLength, ENC_NA);\r\noffset += iStringLength;\r\n}\r\n}\r\nelse if (type == OPENWIRE_TYPE_BIG_STRING && tvb_reported_length_remaining(tvb, offset) >= 4)\r\n{\r\ngint iStringLength = 0;\r\niStringLength = tvb_get_ntohl(tvb, offset);\r\nif (openwire_verbose_type)\r\n{\r\nproto_tree_add_item(tree, hf_openwire_type_integer, tvb, offset, 4, ENC_BIG_ENDIAN);\r\n}\r\noffset += 4;\r\nif (tvb_reported_length_remaining(tvb, offset) >= iStringLength)\r\n{\r\nproto_tree_add_item(tree, particularize(field, hf_openwire_type_string), tvb, offset, iStringLength, ENC_NA);\r\noffset += iStringLength;\r\n}\r\n}\r\nelse if (type == OPENWIRE_TYPE_BYTE_ARRAY && tvb_reported_length_remaining(tvb, offset) >= 4)\r\n{\r\ngint iArrayLength = 0;\r\niArrayLength = tvb_get_ntohl(tvb, offset);\r\nif (openwire_verbose_type)\r\n{\r\nproto_tree_add_item(tree, hf_openwire_type_integer, tvb, offset, 4, ENC_BIG_ENDIAN);\r\n}\r\noffset += 4;\r\nif (tvb_reported_length_remaining(tvb, offset) >= iArrayLength)\r\n{\r\nproto_item * array_item = NULL;\r\nproto_tree * object_tree = NULL;\r\narray_item = proto_tree_add_item(tree, particularize(field, hf_openwire_type_bytes), tvb, offset, iArrayLength, ENC_NA);\r\nobject_tree = proto_item_add_subtree(array_item, ett_openwire_type);\r\nif (field == hf_openwire_message_body)\r\n{\r\ntvbuff_t* next_tvb = NULL;\r\nif (parentType == OPENWIRE_ACTIVEMQ_TEXT_MESSAGE)\r\n{\r\ndissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_none, OPENWIRE_TYPE_BIG_STRING, type, FALSE);\r\nnext_tvb = tvb_new_subset_length(tvb, offset, iArrayLength);\r\nadd_new_data_source(pinfo, next_tvb, "Body");\r\n}\r\nelse if (parentType == OPENWIRE_ACTIVEMQ_MAP_MESSAGE)\r\n{\r\ndissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_none, OPENWIRE_TYPE_MAP, type, FALSE);\r\n}\r\nelse if (parentType == OPENWIRE_ACTIVEMQ_STREAM_MESSAGE)\r\n{\r\ngint streamOffset = offset;\r\nwhile (streamOffset < offset + iArrayLength)\r\n{\r\nstreamOffset += dissect_openwire_type(tvb, pinfo, object_tree, streamOffset, hf_openwire_none, OPENWIRE_TYPE_NESTED, type, FALSE);\r\n}\r\n}\r\nelse if (parentType == OPENWIRE_ACTIVEMQ_BYTES_MESSAGE\r\n|| parentType == OPENWIRE_ACTIVEMQ_OBJECT_MESSAGE\r\n|| parentType == OPENWIRE_ACTIVEMQ_BLOB_MESSAGE)\r\n{\r\nnext_tvb = tvb_new_subset_length(tvb, offset, iArrayLength);\r\nadd_new_data_source(pinfo, next_tvb, "Body");\r\nexpert_add_info(pinfo, array_item, &ei_openwire_body_type_not_supported);\r\n}\r\n}\r\nelse if (field == hf_openwire_message_properties)\r\n{\r\ndissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_none, OPENWIRE_TYPE_MAP, type, FALSE);\r\n}\r\noffset += iArrayLength;\r\n}\r\n}\r\nelse if (tvb_reported_length_remaining(tvb, offset) >= 1)\r\n{\r\nproto_tree *object_tree;\r\nproto_item *ti;\r\nti = proto_tree_add_item(tree, particularize(field, hf_openwire_type_object), tvb, startOffset, -1, ENC_NA);\r\nproto_item_append_text(ti, ": %s", val_to_str_ext(type, &openwire_type_vals_ext, "Unknown (0x%02x)"));\r\nproto_item_append_text(ti, "%s", cache_str);\r\nobject_tree = proto_item_add_subtree(ti, ett_openwire_type);\r\nif (type == OPENWIRE_TYPE_OBJECT_ARRAY && tvb_reported_length_remaining(tvb, offset) >= 2)\r\n{\r\ngint iArrayLength;\r\nint iArrayItem = 0;\r\niArrayLength = tvb_get_ntohs(tvb, offset);\r\nif (openwire_verbose_type)\r\n{\r\nproto_tree_add_item(object_tree, hf_openwire_type_short, tvb, offset + 0, 2, ENC_BIG_ENDIAN);\r\n}\r\nproto_item_append_text(ti, " (Size : %d)", iArrayLength);\r\noffset += 2;\r\nfor (iArrayItem = 0; iArrayItem < iArrayLength; iArrayItem++)\r\n{\r\nif (tvb_reported_length_remaining(tvb, offset) >= 0)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_none, OPENWIRE_TYPE_NESTED, type, TRUE);\r\n}\r\n}\r\n}\r\nelse if (type == OPENWIRE_TYPE_MAP && tvb_reported_length_remaining(tvb, offset) >= 4)\r\n{\r\nint iMapItem = 0;\r\nint iMapLength = 0;\r\niMapLength = tvb_get_ntohl(tvb, offset);\r\nif (openwire_verbose_type)\r\n{\r\nproto_tree_add_item(object_tree, hf_openwire_map_length, tvb, offset, 4, ENC_BIG_ENDIAN);\r\n}\r\nproto_item_append_text(ti, " (Size : %d)", iMapLength);\r\noffset += 4;\r\nfor (iMapItem = 0; (iMapItem < iMapLength) && (tvb_reported_length_remaining(tvb, offset) > 0); iMapItem++)\r\n{\r\nproto_item * map_entry;\r\nproto_tree * entry_tree;\r\ngint entryStartOffset = offset;\r\nmap_entry = proto_tree_add_item(object_tree, hf_openwire_map_entry, tvb, offset, 0, ENC_NA);\r\nentry_tree = proto_item_add_subtree(map_entry, ett_openwire_type);\r\noffset += dissect_openwire_type(tvb, pinfo, entry_tree, offset, hf_openwire_map_key, OPENWIRE_TYPE_STRING, type, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, entry_tree, offset, hf_openwire_none, OPENWIRE_TYPE_NESTED, type, FALSE);\r\nproto_item_set_len(map_entry, offset - entryStartOffset);\r\n}\r\n}\r\nelse if (type == OPENWIRE_TYPE_THROWABLE && tvb_reported_length_remaining(tvb, offset) >= 2)\r\n{\r\ngint iStackTraceDepth, iStackTraceItem;\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_throwable_class, OPENWIRE_TYPE_STRING, type, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_throwable_message, OPENWIRE_TYPE_STRING, type, TRUE);\r\niStackTraceDepth = tvb_get_ntohs(tvb, offset);\r\nif (openwire_verbose_type)\r\n{\r\nproto_tree_add_item(tree, hf_openwire_type_short, tvb, offset, 2, ENC_BIG_ENDIAN);\r\n}\r\noffset += 2;\r\nif (iStackTraceDepth > 0)\r\n{\r\nfor (iStackTraceItem = 0; iStackTraceItem < iStackTraceDepth; iStackTraceItem++)\r\n{\r\nproto_item *element;\r\nproto_tree *element_tree;\r\ngint startElementOffset = offset;\r\nelement = proto_tree_add_item(object_tree, hf_openwire_throwable_element, tvb, startElementOffset, -1, ENC_NA);\r\nelement_tree = proto_item_add_subtree(element, ett_openwire_type);\r\nif (tvb_reported_length_remaining(tvb, offset) >= 0)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, element_tree, offset, hf_openwire_throwable_classname, OPENWIRE_TYPE_STRING, type, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, element_tree, offset, hf_openwire_throwable_methodname, OPENWIRE_TYPE_STRING, type, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, element_tree, offset, hf_openwire_throwable_filename, OPENWIRE_TYPE_STRING, type, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, element_tree, offset, hf_openwire_throwable_linenumber, OPENWIRE_TYPE_INTEGER, type, FALSE);\r\nproto_item_set_len(element, offset - startElementOffset);\r\n}\r\n}\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_exceptionresponse_exception, OPENWIRE_TYPE_THROWABLE, type, TRUE);\r\n}\r\n}\r\nelse if (type == OPENWIRE_TYPE_LIST && tvb_reported_length_remaining(tvb, offset) >= 4)\r\n{\r\n}\r\nelse if (type == OPENWIRE_CONNECTION_ID && tvb_reported_length_remaining(tvb, offset) >= 1)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_connectionid_value, OPENWIRE_TYPE_STRING, type, TRUE);\r\n}\r\nelse if (type == OPENWIRE_SESSION_ID && tvb_reported_length_remaining(tvb, offset) >= 2)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_sessionid_connectionid, OPENWIRE_TYPE_STRING, type, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_sessionid_value, OPENWIRE_TYPE_LONG, type, FALSE);\r\n}\r\nelse if (type == OPENWIRE_CONSUMER_ID && tvb_reported_length_remaining(tvb, offset) >= 3)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_consumerid_connectionid, OPENWIRE_TYPE_STRING, type, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_consumerid_value, OPENWIRE_TYPE_LONG, type, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_consumerid_sessionid, OPENWIRE_TYPE_LONG, type, FALSE);\r\n}\r\nelse if (type == OPENWIRE_PRODUCER_ID && tvb_reported_length_remaining(tvb, offset) >= 3)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_producerid_connectionid, OPENWIRE_TYPE_STRING, type, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_producerid_value, OPENWIRE_TYPE_LONG, type, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_producerid_sessionid, OPENWIRE_TYPE_LONG, type, FALSE);\r\n}\r\nelse if (type == OPENWIRE_BROKER_ID && tvb_reported_length_remaining(tvb, offset) >= 1)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_brokerid_value, OPENWIRE_TYPE_STRING, type, TRUE);\r\n}\r\nelse if (type == OPENWIRE_MESSAGE_ID && tvb_reported_length_remaining(tvb, offset) >= 3)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_messageid_producerid, OPENWIRE_TYPE_CACHED, type, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_messageid_producersequenceid, OPENWIRE_TYPE_LONG, type, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_messageid_brokersequenceid, OPENWIRE_TYPE_LONG, type, FALSE);\r\n}\r\nelse if (type == OPENWIRE_ACTIVEMQ_LOCAL_TRANSACTION_ID && tvb_reported_length_remaining(tvb, offset) >= 2)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_localtransactionid_value, OPENWIRE_TYPE_LONG, type, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_localtransactionid_connectionid, OPENWIRE_TYPE_CACHED, type, TRUE);\r\n}\r\nelse if (type == OPENWIRE_ACTIVEMQ_XA_TRANSACTION_ID && tvb_reported_length_remaining(tvb, offset) >= 3)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_xatransactionid_formatid, OPENWIRE_TYPE_INTEGER, type, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_xatransactionid_globaltransactionid, OPENWIRE_TYPE_BYTE_ARRAY, type, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_xatransactionid_branchqualifier, OPENWIRE_TYPE_BYTE_ARRAY, type, TRUE);\r\n}\r\nelse if ((type == OPENWIRE_ACTIVEMQ_QUEUE\r\n|| type == OPENWIRE_ACTIVEMQ_TOPIC\r\n|| type == OPENWIRE_ACTIVEMQ_TEMP_QUEUE\r\n|| type == OPENWIRE_ACTIVEMQ_TEMP_TOPIC)\r\n&& tvb_reported_length_remaining(tvb, offset) >= 1)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_destination_name, OPENWIRE_TYPE_STRING, type, TRUE);\r\n}\r\nelse if (type == OPENWIRE_ACTIVEMQ_MESSAGE\r\n|| type == OPENWIRE_ACTIVEMQ_BYTES_MESSAGE\r\n|| type == OPENWIRE_ACTIVEMQ_MAP_MESSAGE\r\n|| type == OPENWIRE_ACTIVEMQ_OBJECT_MESSAGE\r\n|| type == OPENWIRE_ACTIVEMQ_STREAM_MESSAGE\r\n|| type == OPENWIRE_ACTIVEMQ_TEXT_MESSAGE\r\n|| type == OPENWIRE_ACTIVEMQ_BLOB_MESSAGE)\r\n{\r\nif (parentType != type)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_command_id, OPENWIRE_TYPE_INTEGER, type, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_command_response_required, OPENWIRE_TYPE_BOOLEAN, type, FALSE);\r\n}\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_producerid, OPENWIRE_TYPE_CACHED, type, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_destination, OPENWIRE_TYPE_CACHED, type, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_transactionid, OPENWIRE_TYPE_CACHED, type, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_originaldestination, OPENWIRE_TYPE_CACHED, type, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_messageid, OPENWIRE_TYPE_NESTED, type, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_originaldestinationid, OPENWIRE_TYPE_CACHED, type, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_groupid, OPENWIRE_TYPE_STRING, type, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_groupsequence, OPENWIRE_TYPE_INTEGER, type, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_correlationid, OPENWIRE_TYPE_STRING, type, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_persistent, OPENWIRE_TYPE_BOOLEAN, type, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_expiration, OPENWIRE_TYPE_LONG, type, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_priority, OPENWIRE_TYPE_BYTE, type, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_replyto, OPENWIRE_TYPE_NESTED, type, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_timestamp, OPENWIRE_TYPE_LONG, type, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_type, OPENWIRE_TYPE_STRING, type, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_body, OPENWIRE_TYPE_BYTE_ARRAY, type, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_properties, OPENWIRE_TYPE_BYTE_ARRAY, type, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_datastructure, OPENWIRE_COMMAND_INNER, type, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_targetconsumerid, OPENWIRE_TYPE_CACHED, type, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_compressed, OPENWIRE_TYPE_BOOLEAN, type, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_redeliverycount, OPENWIRE_TYPE_INTEGER, type, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_brokerpath, OPENWIRE_TYPE_OBJECT_ARRAY, type, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_arrival, OPENWIRE_TYPE_LONG, type, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_userid, OPENWIRE_TYPE_STRING, type, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_receivedbydfbridge, OPENWIRE_TYPE_BOOLEAN, type, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_droppable, OPENWIRE_TYPE_BOOLEAN, type, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_cluster, OPENWIRE_TYPE_OBJECT_ARRAY, type, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_brokerintime, OPENWIRE_TYPE_LONG, type, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, object_tree, offset, hf_openwire_message_brokerouttime, OPENWIRE_TYPE_LONG, type, FALSE);\r\n}\r\nelse if (tvb_reported_length_remaining(tvb, offset) > 0)\r\n{\r\nexpert_add_info_format(pinfo, object_tree, &ei_openwire_type_not_supported, "OpenWire type not supported by Wireshark : %d", type);\r\noffset += tvb_captured_length_remaining(tvb, offset);\r\n}\r\nproto_item_set_len(ti, offset - startOffset);\r\n}\r\nreturn (offset - startOffset);\r\n}\r\nstatic int\r\ndissect_openwire_command(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, int offset, int parentType)\r\n{\r\ngint startOffset = offset;\r\nguint8 iCommand;\r\niCommand = tvb_get_guint8(tvb, offset + 0);\r\nproto_tree_add_item(tree, hf_openwire_command, tvb, offset + 0, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nif (iCommand == OPENWIRE_WIREFORMAT_INFO)\r\n{\r\nif (tvb_reported_length_remaining(tvb, offset) >= 17)\r\n{\r\nproto_tree_add_item(tree, hf_openwire_wireformatinfo_magic, tvb, offset + 0, 8, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(tree, hf_openwire_wireformatinfo_version, tvb, offset + 8, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_openwire_wireformatinfo_data, tvb, offset + 12, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_openwire_wireformatinfo_length, tvb, offset + 13, 4, ENC_BIG_ENDIAN);\r\noffset += 17;\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_none, OPENWIRE_TYPE_MAP, iCommand, FALSE);\r\n}\r\n}\r\nelse\r\n{\r\nif (tvb_reported_length_remaining(tvb, offset) >= 5)\r\n{\r\nproto_tree_add_item(tree, hf_openwire_command_id, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_openwire_command_response_required, tvb, offset + 4, 1, ENC_BIG_ENDIAN);\r\noffset += 5;\r\nif (iCommand == OPENWIRE_SHUTDOWN_INFO || iCommand == OPENWIRE_KEEP_ALIVE_INFO || iCommand == OPENWIRE_FLUSH_COMMAND)\r\n{\r\n}\r\nelse if (iCommand == OPENWIRE_SESSION_INFO)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_sessioninfo_sessionid, OPENWIRE_TYPE_CACHED, iCommand, TRUE);\r\n}\r\nelse if (iCommand == OPENWIRE_DESTINATION_INFO)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_destinationinfo_connectionid, OPENWIRE_TYPE_CACHED, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_destinationinfo_destination, OPENWIRE_TYPE_CACHED, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_destinationinfo_operationtype, OPENWIRE_TYPE_BYTE, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_destinationinfo_timeout, OPENWIRE_TYPE_LONG, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_destinationinfo_brokerpath, OPENWIRE_TYPE_OBJECT_ARRAY, iCommand, TRUE);\r\n}\r\nelse if (iCommand == OPENWIRE_CONNECTION_INFO)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_connectioninfo_connectionid, OPENWIRE_TYPE_CACHED, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_connectioninfo_clientid, OPENWIRE_TYPE_STRING, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_connectioninfo_password, OPENWIRE_TYPE_STRING, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_connectioninfo_username, OPENWIRE_TYPE_STRING, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_connectioninfo_brokerpath, OPENWIRE_TYPE_OBJECT_ARRAY, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_connectioninfo_brokermasterconnector, OPENWIRE_TYPE_BOOLEAN, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_connectioninfo_manageable, OPENWIRE_TYPE_BOOLEAN, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_connectioninfo_clientmaster, OPENWIRE_TYPE_BOOLEAN, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_connectioninfo_faulttolerant, OPENWIRE_TYPE_BOOLEAN, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_connectioninfo_failoverreconnect, OPENWIRE_TYPE_BOOLEAN, iCommand, FALSE);\r\n}\r\nelse if (iCommand == OPENWIRE_CONNECTION_CONTROL)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_connectioncontrol_close, OPENWIRE_TYPE_BOOLEAN, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_connectioncontrol_exit, OPENWIRE_TYPE_BOOLEAN, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_connectioncontrol_faulttolerant, OPENWIRE_TYPE_BOOLEAN, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_connectioncontrol_resume, OPENWIRE_TYPE_BOOLEAN, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_connectioncontrol_suspend, OPENWIRE_TYPE_BOOLEAN, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_connectioncontrol_connectedbrokers, OPENWIRE_TYPE_STRING, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_connectioncontrol_reconnectto, OPENWIRE_TYPE_STRING, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_connectioncontrol_rebalanceconnection, OPENWIRE_TYPE_BOOLEAN, iCommand, FALSE);\r\n}\r\nelse if (iCommand == OPENWIRE_CONSUMER_INFO)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_consumerinfo_consumerid, OPENWIRE_TYPE_CACHED, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_consumerinfo_browser, OPENWIRE_TYPE_BOOLEAN, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_consumerinfo_destination, OPENWIRE_TYPE_CACHED, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_consumerinfo_prefetchsize, OPENWIRE_TYPE_INTEGER, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_consumerinfo_maximumpendingmessagelimit, OPENWIRE_TYPE_INTEGER, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_consumerinfo_dispatchasync, OPENWIRE_TYPE_BOOLEAN, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_consumerinfo_selector, OPENWIRE_TYPE_STRING, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_consumerinfo_subscriptionname, OPENWIRE_TYPE_STRING, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_consumerinfo_nolocal, OPENWIRE_TYPE_BOOLEAN, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_consumerinfo_exclusive, OPENWIRE_TYPE_BOOLEAN, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_consumerinfo_retroactive, OPENWIRE_TYPE_BOOLEAN, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_consumerinfo_priority, OPENWIRE_TYPE_BYTE, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_consumerinfo_brokerpath, OPENWIRE_TYPE_OBJECT_ARRAY, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_consumerinfo_additionalpredicate, OPENWIRE_TYPE_NESTED, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_consumerinfo_networksubscription, OPENWIRE_TYPE_BOOLEAN, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_consumerinfo_optimizedacknowledge, OPENWIRE_TYPE_BOOLEAN, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_consumerinfo_norangeacks, OPENWIRE_TYPE_BOOLEAN, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_consumerinfo_networkconsumerpath, OPENWIRE_TYPE_OBJECT_ARRAY, iCommand, TRUE);\r\n}\r\nelse if (iCommand == OPENWIRE_PRODUCER_INFO)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_producerinfo_producerid, OPENWIRE_TYPE_CACHED, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_producerinfo_destination, OPENWIRE_TYPE_CACHED, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_producerinfo_brokerpath, OPENWIRE_TYPE_OBJECT_ARRAY, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_producerinfo_dispatchasync, OPENWIRE_TYPE_BOOLEAN, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_producerinfo_windowsize, OPENWIRE_TYPE_INTEGER, iCommand, FALSE);\r\n}\r\nelse if (iCommand == OPENWIRE_CONSUMER_CONTROL)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_consumercontrol_destination, OPENWIRE_TYPE_NESTED, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_consumercontrol_close, OPENWIRE_TYPE_BOOLEAN, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_consumercontrol_consumerid, OPENWIRE_TYPE_NESTED, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_consumercontrol_prefetch, OPENWIRE_TYPE_INTEGER, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_consumercontrol_flush, OPENWIRE_TYPE_BOOLEAN, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_consumercontrol_start, OPENWIRE_TYPE_BOOLEAN, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_consumercontrol_stop, OPENWIRE_TYPE_BOOLEAN, iCommand, FALSE);\r\n}\r\nelse if (iCommand == OPENWIRE_BROKER_INFO)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_brokerinfo_brokerid, OPENWIRE_TYPE_CACHED, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_brokerinfo_brokerurl, OPENWIRE_TYPE_STRING, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_brokerinfo_peerbrokerinfos, OPENWIRE_TYPE_OBJECT_ARRAY, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_brokerinfo_brokername, OPENWIRE_TYPE_STRING, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_brokerinfo_slavebroker, OPENWIRE_TYPE_BOOLEAN, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_brokerinfo_masterbroker, OPENWIRE_TYPE_BOOLEAN, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_brokerinfo_faulttolerantconfiguration, OPENWIRE_TYPE_BOOLEAN, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_brokerinfo_duplexconnection, OPENWIRE_TYPE_BOOLEAN, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_brokerinfo_networkconnection, OPENWIRE_TYPE_BOOLEAN, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_brokerinfo_connectionid, OPENWIRE_TYPE_LONG, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_brokerinfo_brokeruploadurl, OPENWIRE_TYPE_STRING, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_brokerinfo_networkproperties, OPENWIRE_TYPE_STRING, iCommand, TRUE);\r\n}\r\nelse if (iCommand == OPENWIRE_TRANSACTION_INFO)\r\n{\r\nguint8 iTransactionType;\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_transactioninfo_connectionid, OPENWIRE_TYPE_CACHED, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_transactioninfo_transactionid, OPENWIRE_TYPE_CACHED, iCommand, TRUE);\r\nif (tvb_reported_length_remaining(tvb, offset) >= 1)\r\n{\r\niTransactionType = tvb_get_guint8(tvb, offset);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_transactioninfo_type, OPENWIRE_TYPE_BYTE, iCommand, FALSE);\r\nproto_item_append_text(tree, " (%s)", val_to_str_ext(iTransactionType, &openwire_transaction_type_vals_ext, "Unknown (0x%02x)"));\r\n}\r\n}\r\nelse if (iCommand == OPENWIRE_PRODUCER_ACK)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_producerack_producerid, OPENWIRE_TYPE_NESTED, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_producerack_size, OPENWIRE_TYPE_INTEGER, iCommand, FALSE);\r\n}\r\nelse if (iCommand == OPENWIRE_REMOVE_INFO)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_removeinfo_objectid, OPENWIRE_TYPE_CACHED, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_removeinfo_lastdeliveredsequenceid, OPENWIRE_TYPE_LONG, iCommand, FALSE);\r\n}\r\nelse if (iCommand == OPENWIRE_REMOVE_SUBSCRIPTION_INFO)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_removesubscriptioninfo_connectionid, OPENWIRE_TYPE_CACHED, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_removesubscriptioninfo_subscriptionname, OPENWIRE_TYPE_STRING, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_removesubscriptioninfo_clientid, OPENWIRE_TYPE_STRING, iCommand, TRUE);\r\n}\r\nelse if (iCommand == OPENWIRE_MESSAGE_DISPATCH)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_messagedispatch_consumerid, OPENWIRE_TYPE_CACHED, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_messagedispatch_destination, OPENWIRE_TYPE_CACHED, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_messagedispatch_message, OPENWIRE_TYPE_NESTED, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_messagedispatch_redeliverycounter, OPENWIRE_TYPE_INTEGER, iCommand, FALSE);\r\n}\r\nelse if (iCommand == OPENWIRE_MESSAGE_ACK)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_messageack_destination, OPENWIRE_TYPE_CACHED, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_messageack_transactionid, OPENWIRE_TYPE_CACHED, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_messageack_consumerid, OPENWIRE_TYPE_CACHED, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_messageack_acktype, OPENWIRE_TYPE_BYTE, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_messageack_firstmessageid, OPENWIRE_TYPE_NESTED, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_messageack_lastmessageid, OPENWIRE_TYPE_NESTED, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_messageack_messagecount, OPENWIRE_TYPE_INTEGER, iCommand, FALSE);\r\n}\r\nelse if (iCommand == OPENWIRE_MESSAGE_PULL)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_messagepull_consumerid, OPENWIRE_TYPE_CACHED, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_messagepull_destinationid, OPENWIRE_TYPE_CACHED, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_messagepull_timeout, OPENWIRE_TYPE_LONG, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_messagepull_correlationid, OPENWIRE_TYPE_STRING, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_messagepull_messageid, OPENWIRE_TYPE_NESTED, iCommand, TRUE);\r\n}\r\nelse if (iCommand == OPENWIRE_RESPONSE)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_response_correlationid, OPENWIRE_TYPE_INTEGER, iCommand, FALSE);\r\n}\r\nelse if (iCommand == OPENWIRE_DATA_RESPONSE)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_response_correlationid, OPENWIRE_TYPE_INTEGER, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_dataresponse_data, OPENWIRE_COMMAND_INNER, iCommand, TRUE);\r\n}\r\nelse if (iCommand == OPENWIRE_CONNECTION_ERROR)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_connectionerror_exception, OPENWIRE_TYPE_THROWABLE, iCommand, TRUE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_connectionerror_connectionid, OPENWIRE_TYPE_NESTED, iCommand, TRUE);\r\n}\r\nelse if (iCommand == OPENWIRE_EXCEPTION_RESPONSE)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_response_correlationid, OPENWIRE_TYPE_INTEGER, iCommand, FALSE);\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_exceptionresponse_exception, OPENWIRE_TYPE_THROWABLE, iCommand, TRUE);\r\n}\r\nelse if (iCommand == OPENWIRE_CONTROL_COMMAND)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_controlcommand_command, OPENWIRE_TYPE_STRING, iCommand, TRUE);\r\n}\r\nelse if (iCommand == OPENWIRE_ACTIVEMQ_MESSAGE\r\n|| iCommand == OPENWIRE_ACTIVEMQ_BYTES_MESSAGE\r\n|| iCommand == OPENWIRE_ACTIVEMQ_MAP_MESSAGE\r\n|| iCommand == OPENWIRE_ACTIVEMQ_OBJECT_MESSAGE\r\n|| iCommand == OPENWIRE_ACTIVEMQ_STREAM_MESSAGE\r\n|| iCommand == OPENWIRE_ACTIVEMQ_TEXT_MESSAGE\r\n|| iCommand == OPENWIRE_ACTIVEMQ_BLOB_MESSAGE)\r\n{\r\noffset += dissect_openwire_type(tvb, pinfo, tree, offset, hf_openwire_none, iCommand, parentType, FALSE);\r\n}\r\nelse if (tvb_reported_length_remaining(tvb, offset) > 0)\r\n{\r\nexpert_add_info_format(pinfo, tree, &ei_openwire_command_not_supported, "OpenWire command not supported by Wireshark: %d", iCommand);\r\n}\r\n}\r\n}\r\nreturn (offset - startOffset);\r\n}\r\nstatic int\r\ndissect_openwire(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\ngint offset = 0;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "OpenWire");\r\ncol_clear(pinfo->cinfo, COL_INFO);\r\nif (tvb_reported_length_remaining(tvb, offset) >= 5)\r\n{\r\nguint8 iCommand;\r\nproto_tree *openwireroot_tree;\r\nproto_item *ti;\r\ngboolean caching;\r\niCommand = tvb_get_guint8(tvb, offset + 4);\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, " | ",\r\nval_to_str_ext(iCommand, &openwire_opcode_vals_ext, "Unknown (0x%02x)"));\r\ncol_set_fence(pinfo->cinfo, COL_INFO);\r\ndetect_protocol_options(tvb, pinfo, offset, iCommand);\r\nti = proto_tree_add_item(tree, proto_openwire, tvb, offset, -1, ENC_NA);\r\nproto_item_append_text(ti, " (%s)", val_to_str_ext(iCommand, &openwire_opcode_vals_ext, "Unknown (0x%02x)"));\r\nopenwireroot_tree = proto_item_add_subtree(ti, ett_openwire);\r\nproto_tree_add_item(openwireroot_tree, hf_openwire_length, tvb, offset + 0, 4, ENC_BIG_ENDIAN);\r\nif (iCommand != OPENWIRE_WIREFORMAT_INFO && retrieve_tight(pinfo) == TRUE)\r\n{\r\nproto_tree_add_item(openwireroot_tree, hf_openwire_command, tvb, offset + 4, 1, ENC_BIG_ENDIAN);\r\nexpert_add_info(pinfo, openwireroot_tree, &ei_openwire_tight_encoding_not_supported);\r\nreturn tvb_captured_length(tvb);\r\n}\r\ncaching = retrieve_caching(pinfo);\r\nif (caching)\r\n{\r\nproto_tree_add_boolean(openwireroot_tree, hf_openwire_cached_enabled, tvb, offset, 0, caching);\r\n}\r\noffset += 4;\r\noffset += dissect_openwire_command(tvb, pinfo, openwireroot_tree, offset, iCommand);\r\nif (tvb_reported_length_remaining(tvb, offset) > 0)\r\n{\r\nexpert_add_info_format(pinfo, tree, &ei_openwire_command_not_supported, "OpenWire command fields unknown to Wireshark: %d", iCommand);\r\n}\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic guint\r\nget_openwire_pdu_len(packet_info *pinfo _U_, tvbuff_t *tvb, int offset, void *data _U_)\r\n{\r\nreturn (tvb_get_ntohl(tvb, offset) + 4);\r\n}\r\nstatic int\r\ndissect_openwire_tcp(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data)\r\n{\r\ntcp_dissect_pdus(tvb, pinfo, tree, openwire_desegment, 5, get_openwire_pdu_len, dissect_openwire, data);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic gboolean\r\ndissect_openwire_heur(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data)\r\n{\r\nconversation_t *conversation;\r\ngboolean detected = FALSE;\r\nif (tvb_reported_length(tvb) == 10 || tvb_reported_length(tvb) == 11)\r\n{\r\nif ((tvb_get_guint8(tvb, 4) == OPENWIRE_KEEP_ALIVE_INFO)\r\n&& (tvb_get_ntohl(tvb, 0) + 4 == tvb_reported_length(tvb)))\r\n{\r\ndetected = TRUE;\r\n}\r\n}\r\nelse if (tvb_reported_length(tvb) == 14 || tvb_reported_length(tvb) == 15)\r\n{\r\nif ((tvb_get_guint8(tvb, 4) == OPENWIRE_RESPONSE)\r\n&& (tvb_get_ntohl(tvb, 0) + 4 == tvb_reported_length(tvb)))\r\n{\r\ndetected = TRUE;\r\n}\r\n}\r\nelse if (tvb_reported_length(tvb) >= 13)\r\n{\r\nif (tvb_captured_length(tvb) >= 10\r\n&& (tvb_get_guint8(tvb, 4) == OPENWIRE_WIREFORMAT_INFO)\r\n&& (tvb_get_ntohl(tvb, 5) == OPENWIRE_MAGIC_PART_1)\r\n&& (tvb_get_ntohl(tvb, 9) == OPENWIRE_MAGIC_PART_2))\r\n{\r\ndetected = TRUE;\r\n}\r\n}\r\nif (detected)\r\n{\r\nconversation = find_or_create_conversation(pinfo);\r\nconversation_set_dissector(conversation, openwire_tcp_handle);\r\ndissect_openwire(tvb, pinfo, tree, data);\r\nreturn TRUE;\r\n}\r\nreturn FALSE;\r\n}\r\nvoid\r\nproto_register_openwire(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_openwire_length,\r\n{ "Length", "openwire.length", FT_UINT32, BASE_DEC, NULL, 0x0, "OpenWire length", HFILL }},\r\n{ &hf_openwire_command,\r\n{ "Command", "openwire.command", FT_UINT8, BASE_DEC, VALS(openwire_opcode_vals), 0x0, "Openwire command", HFILL }},\r\n{ &hf_openwire_command_id,\r\n{ "Command Id", "openwire.command.id", FT_UINT32, BASE_DEC, NULL, 0x0, "Openwire command id", HFILL }},\r\n{ &hf_openwire_command_response_required,\r\n{ "Command response required", "openwire.command.response_required", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire command response required", HFILL }},\r\n{ &hf_openwire_response_correlationid,\r\n{ "CorrelationId", "openwire.response.correlationid", FT_INT32, BASE_DEC, NULL, 0x0, "Openwire Response CorrelationId", HFILL }},\r\n{ &hf_openwire_dataresponse_data,\r\n{ "Data", "openwire.responsedata.data", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire ResponseData Data", HFILL }},\r\n{ &hf_openwire_exceptionresponse_exception,\r\n{ "Exception", "openwire.exceptionresponse.exception", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire ExceptionResponse Exception", HFILL }},\r\n{ &hf_openwire_connectionerror_exception,\r\n{ "Exception", "openwire.connectionerror.exception", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire ConnectionError Exception", HFILL }},\r\n{ &hf_openwire_connectionerror_connectionid,\r\n{ "ConnectionId", "openwire.connectionerror.connectionid", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire ConnectionError ConnectionId", HFILL }},\r\n{ &hf_openwire_controlcommand_command,\r\n{ "Command", "openwire.controlcommand.command", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire ControlCommand Command", HFILL }},\r\n{ &hf_openwire_wireformatinfo_magic,\r\n{ "Magic", "openwire.wireformatinfo.magic", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire WireFormatInfo Magic", HFILL }},\r\n{ &hf_openwire_wireformatinfo_version,\r\n{ "Version", "openwire.wireformatinfo.version", FT_UINT32, BASE_DEC, NULL, 0x0, "Openwire WireFormatInfo Version", HFILL }},\r\n{ &hf_openwire_wireformatinfo_data,\r\n{ "Data", "openwire.wireformatinfo.data", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire WireFormatInfo Data", HFILL }},\r\n{ &hf_openwire_wireformatinfo_length,\r\n{ "Length", "openwire.wireformatinfo.length", FT_UINT32, BASE_DEC, NULL, 0x0, "Openwire WireFormatInfo Length", HFILL }},\r\n{ &hf_openwire_sessioninfo_sessionid,\r\n{ "SessionId", "openwire.sessioninfo.sessionid", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire SessionInfo SessionId", HFILL }},\r\n{ &hf_openwire_destinationinfo_connectionid,\r\n{ "ConnectionId", "openwire.destinationinfo.connectionid", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire DestinationInfo ConnectionId", HFILL }},\r\n{ &hf_openwire_destinationinfo_destination,\r\n{ "Destination", "openwire.destinationinfo.destination", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire DestinationInfo Destination", HFILL }},\r\n{ &hf_openwire_destinationinfo_operationtype,\r\n{ "OperationType", "openwire.destinationinfo.operationtype", FT_UINT8, BASE_DEC, VALS(openwire_operation_type_vals), 0x0, "Openwire DestinationInfo OperationType", HFILL }},\r\n{ &hf_openwire_destinationinfo_timeout,\r\n{ "Timeout", "openwire.destinationinfo.timeout", FT_INT64, BASE_DEC, NULL, 0x0, "Openwire DestinationInfo Timeout", HFILL }},\r\n{ &hf_openwire_destinationinfo_brokerpath,\r\n{ "BrokerPath", "openwire.destinationinfo.brokerpath", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire DestinationInfo BrokerPath", HFILL }},\r\n{ &hf_openwire_brokerinfo_brokerid,\r\n{ "BrokerId", "openwire.brokerinfo.brokerid", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire BrokerInfo BrokerId", HFILL }},\r\n{ &hf_openwire_brokerinfo_brokerurl,\r\n{ "BrokerURL", "openwire.brokerinfo.brokerurl", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire BrokerInfo BrokerURL", HFILL }},\r\n{ &hf_openwire_brokerinfo_peerbrokerinfos,\r\n{ "PeerBrokerInfos", "openwire.brokerinfo.peerbrokerinfos", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire BrokerInfo PeerBrokerInfos", HFILL }},\r\n{ &hf_openwire_brokerinfo_brokername,\r\n{ "BrokerName", "openwire.brokerinfo.brokername", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire BrokerInfo BrokerName", HFILL }},\r\n{ &hf_openwire_brokerinfo_slavebroker,\r\n{ "SlaveBroker", "openwire.brokerinfo.slavebroker", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire BrokerInfo SlaveBroker", HFILL }},\r\n{ &hf_openwire_brokerinfo_masterbroker,\r\n{ "MasterBroker", "openwire.brokerinfo.masterbroker", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire BrokerInfo MasterBroker", HFILL }},\r\n{ &hf_openwire_brokerinfo_faulttolerantconfiguration,\r\n{ "FaultTolerantConfiguration", "openwire.brokerinfo.faulttolerantconfiguration", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire BrokerInfo FaultTolerantConfiguration", HFILL }},\r\n{ &hf_openwire_brokerinfo_duplexconnection,\r\n{ "DuplexConnection", "openwire.brokerinfo.duplexconnection", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire BrokerInfo DuplexConnection", HFILL }},\r\n{ &hf_openwire_brokerinfo_networkconnection,\r\n{ "NetworkConnection", "openwire.brokerinfo.networkconnection", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire BrokerInfo NetworkConnection", HFILL }},\r\n{ &hf_openwire_brokerinfo_connectionid,\r\n{ "ConnectionId", "openwire.brokerinfo.connectionid", FT_INT64, BASE_DEC, NULL, 0x0, "Openwire BrokerInfo ConnectionId", HFILL }},\r\n{ &hf_openwire_brokerinfo_brokeruploadurl,\r\n{ "BrokerUploadUrl", "openwire.brokerinfo.brokeruploadurl", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire BrokerInfo BrokerUploadUrl", HFILL }},\r\n{ &hf_openwire_brokerinfo_networkproperties,\r\n{ "NetworkProperties", "openwire.brokerinfo.networkproperties", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire BrokerInfo NetworkProperties", HFILL }},\r\n{ &hf_openwire_connectioninfo_connectionid,\r\n{ "ConnectionId", "openwire.connectioninfo.connectionid", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire ConnectionInfo ConnectionId", HFILL }},\r\n{ &hf_openwire_connectioninfo_clientid,\r\n{ "ClientId", "openwire.connectioninfo.clientid", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire ConnectionInfo ClientId", HFILL }},\r\n{ &hf_openwire_connectioninfo_password,\r\n{ "Password", "openwire.connectioninfo.password", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire ConnectionInfo Password", HFILL }},\r\n{ &hf_openwire_connectioninfo_username,\r\n{ "UserName", "openwire.connectioninfo.username", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire ConnectionInfo UserName", HFILL }},\r\n{ &hf_openwire_connectioninfo_brokerpath,\r\n{ "BrokerPath", "openwire.connectioninfo.brokerpath", FT_BYTES, BASE_NONE, NULL, 0x0, "Openwire ConnectionInfo BrokerPath", HFILL }},\r\n{ &hf_openwire_connectioninfo_brokermasterconnector,\r\n{ "BrokerMasterConnector", "openwire.connectioninfo.brokermasterconnector", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire ConnectionInfo BrokerMasterConnector", HFILL }},\r\n{ &hf_openwire_connectioninfo_manageable,\r\n{ "Manageable", "openwire.connectioninfo.manageable", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire ConnectionInfo Manageable", HFILL }},\r\n{ &hf_openwire_connectioninfo_clientmaster,\r\n{ "ClientMaster", "openwire.connectioninfo.clientmaster", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire ConnectionInfo ClientMaster", HFILL }},\r\n{ &hf_openwire_connectioninfo_faulttolerant,\r\n{ "FaultTolerant", "openwire.connectioninfo.faulttolerant", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire ConnectionInfo FaultTolerant", HFILL }},\r\n{ &hf_openwire_connectioninfo_failoverreconnect,\r\n{ "FailoverReconnect", "openwire.connectioninfo.failoverreconnect", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire ConnectionInfo FailoverReconnect", HFILL } },\r\n{ &hf_openwire_consumerinfo_consumerid,\r\n{ "ConsumerId", "openwire.consumerinfo.consumerid", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire ConsumerInfo ConsumerId", HFILL }},\r\n{ &hf_openwire_consumerinfo_browser,\r\n{ "Browser", "openwire.consumerinfo.browser", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire ConsumerInfo Browser", HFILL }},\r\n{ &hf_openwire_consumerinfo_destination,\r\n{ "Destination", "openwire.consumerinfo.destination", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire ConsumerInfo Destination", HFILL }},\r\n{ &hf_openwire_consumerinfo_prefetchsize,\r\n{ "PrefetchSize", "openwire.consumerinfo.prefetchsize", FT_INT32, BASE_DEC, NULL, 0x0, "Openwire ConsumerInfo PrefetchSize", HFILL }},\r\n{ &hf_openwire_consumerinfo_maximumpendingmessagelimit,\r\n{ "MaximumPendingMessageLimit", "openwire.consumerinfo.maximumpendingmessagelimit", FT_INT32, BASE_DEC, NULL, 0x0, "Openwire ConsumerInfo MaximumPendingMessageLimit", HFILL }},\r\n{ &hf_openwire_consumerinfo_dispatchasync,\r\n{ "DispatchAsync", "openwire.consumerinfo.dispatchasync", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire ConsumerInfo DispatchAsync", HFILL }},\r\n{ &hf_openwire_consumerinfo_selector,\r\n{ "Selector", "openwire.consumerinfo.selector", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire ConsumerInfo Selector", HFILL }},\r\n{ &hf_openwire_consumerinfo_subscriptionname,\r\n{ "SubscriptionName", "openwire.consumerinfo.subscriptionname", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire ConsumerInfo SubscriptionName", HFILL }},\r\n{ &hf_openwire_consumerinfo_nolocal,\r\n{ "NoLocal", "openwire.consumerinfo.nolocal", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire ConsumerInfo NoLocal", HFILL }},\r\n{ &hf_openwire_consumerinfo_exclusive,\r\n{ "Exclusive", "openwire.consumerinfo.exclusive", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire ConsumerInfo Exclusive", HFILL }},\r\n{ &hf_openwire_consumerinfo_retroactive,\r\n{ "RetroActive", "openwire.consumerinfo.retroactive", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire ConsumerInfo RetroActive", HFILL }},\r\n{ &hf_openwire_consumerinfo_priority,\r\n{ "Priority", "openwire.consumerinfo.priority", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire ConsumerInfo Priority", HFILL }},\r\n{ &hf_openwire_consumerinfo_brokerpath,\r\n{ "BrokerPath", "openwire.consumerinfo.brokerpath", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire ConsumerInfo BrokerPath", HFILL }},\r\n{ &hf_openwire_consumerinfo_additionalpredicate,\r\n{ "AdditionalPredicate", "openwire.consumerinfo.additionalpredicate", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire ConsumerInfo AdditionalPredicate", HFILL }},\r\n{ &hf_openwire_consumerinfo_networksubscription,\r\n{ "NetworkSubscription", "openwire.consumerinfo.networksubscription", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire ConsumerInfo NetworkSubscription", HFILL }},\r\n{ &hf_openwire_consumerinfo_optimizedacknowledge,\r\n{ "OptimizedAcknowledge", "openwire.consumerinfo.optimizedacknowledge", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire ConsumerInfo OptimizedAcknowledge", HFILL }},\r\n{ &hf_openwire_consumerinfo_norangeacks,\r\n{ "NoRangeAcks", "openwire.consumerinfo.norangeacks", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire ConsumerInfo NoRangeAcks", HFILL }},\r\n{ &hf_openwire_consumerinfo_networkconsumerpath,\r\n{ "NetworkConsumerPath", "openwire.consumerinfo.networkconsumerpath", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire ConsumerInfo NetworkConsumerPath", HFILL }},\r\n{ &hf_openwire_consumercontrol_destination,\r\n{ "Destination", "openwire.consumercontrol.destination", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire ConsumerControl Destination", HFILL }},\r\n{ &hf_openwire_consumercontrol_close,\r\n{ "Close", "openwire.consumercontrol.close", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire ConsumerControl Close", HFILL }},\r\n{ &hf_openwire_consumercontrol_consumerid,\r\n{ "ConsumerId", "openwire.consumercontrol.consumerid", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire ConsumerControl ConsumerId", HFILL }},\r\n{ &hf_openwire_consumercontrol_prefetch,\r\n{ "Prefetch", "openwire.consumercontrol.prefetch", FT_INT32, BASE_DEC, NULL, 0x0, "Openwire ConsumerControl Prefetch", HFILL }},\r\n{ &hf_openwire_consumercontrol_flush,\r\n{ "Flush", "openwire.consumercontrol.flush", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire ConsumerControl Flush", HFILL }},\r\n{ &hf_openwire_consumercontrol_start,\r\n{ "Start", "openwire.consumercontrol.start", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire ConsumerControl Start", HFILL }},\r\n{ &hf_openwire_consumercontrol_stop,\r\n{ "Stop", "openwire.consumercontrol.stop", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire ConsumerControl Stop", HFILL }},\r\n{ &hf_openwire_connectioncontrol_close,\r\n{ "Close", "openwire.connectioncontrol.close", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire ConnectionControl Close", HFILL }},\r\n{ &hf_openwire_connectioncontrol_exit,\r\n{ "Exit", "openwire.connectioncontrol.exit", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire ConnectionControl Exit", HFILL }},\r\n{ &hf_openwire_connectioncontrol_faulttolerant,\r\n{ "FaultTolerant", "openwire.connectioncontrol.faulttolerant", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire ConnectionControl FaultTolerant", HFILL }},\r\n{ &hf_openwire_connectioncontrol_resume,\r\n{ "Resume", "openwire.connectioncontrol.resume", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire ConnectionControl Resume", HFILL }},\r\n{ &hf_openwire_connectioncontrol_suspend,\r\n{ "Suspend", "openwire.connectioncontrol.suspend", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire ConnectionControl Suspend", HFILL }},\r\n{ &hf_openwire_connectioncontrol_connectedbrokers,\r\n{ "ConnectedBrokers", "openwire.connectioncontrol.connectedbrokers", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire ConnectionControl ConnectedBrokers", HFILL }},\r\n{ &hf_openwire_connectioncontrol_reconnectto,\r\n{ "ReconnectTo", "openwire.connectioncontrol.reconnectto", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire ConnectionControl ReconnectTo", HFILL }},\r\n{ &hf_openwire_connectioncontrol_rebalanceconnection,\r\n{ "RebalanceConnection", "openwire.connectioncontrol.rebalanceconnection", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire ConnectionControl RebalanceConnection", HFILL }},\r\n{ &hf_openwire_removeinfo_objectid,\r\n{ "ObjectId", "openwire.removeinfo.objectid", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire RemoveInfo ObjectId", HFILL }},\r\n{ &hf_openwire_removeinfo_lastdeliveredsequenceid,\r\n{ "LastDeliveredSequenceId", "openwire.removeinfo.lastdeliveredsequenceid", FT_INT64, BASE_DEC, NULL, 0x0, "Openwire RemoveInfo LastDeliveredSequenceId" , HFILL }},\r\n{ &hf_openwire_removesubscriptioninfo_connectionid,\r\n{ "ConnectionId", "openwire.removesubscriptioninfo.connectionid", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire RemoveSubscriptionInfo ConnectionId", HFILL } },\r\n{ &hf_openwire_removesubscriptioninfo_subscriptionname,\r\n{ "SubscriptionName", "openwire.removesubscriptioninfo.subscriptionname", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire RemoveSubscriptionInfo SubscriptionName", HFILL }},\r\n{ &hf_openwire_removesubscriptioninfo_clientid,\r\n{ "ClientId", "openwire.removesubscriptioninfo.clientid", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire RemoveSubscriptionInfo ClientId", HFILL }},\r\n{ &hf_openwire_producerinfo_producerid,\r\n{ "ProducerId", "openwire.producerinfo.producerid", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire ProducerInfo ProducerId", HFILL }},\r\n{ &hf_openwire_producerinfo_destination,\r\n{ "Destination", "openwire.producerinfo.destination", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire ProducerInfo Destination", HFILL }},\r\n{ &hf_openwire_producerinfo_brokerpath,\r\n{ "BrokerPath", "openwire.producerinfo.brokerpath", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire ProducerInfo BrokerPath", HFILL }},\r\n{ &hf_openwire_producerinfo_dispatchasync,\r\n{ "DispatchAsync", "openwire.producerinfo.dispatchasync", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire ProducerInfo DispatchAsync", HFILL }},\r\n{ &hf_openwire_producerinfo_windowsize,\r\n{ "WindowSize", "openwire.producerinfo.windowsize", FT_INT32, BASE_DEC, NULL, 0x0, "Openwire ProducerInfo WindowSize", HFILL }},\r\n{ &hf_openwire_transactioninfo_connectionid,\r\n{ "ConnectionId", "openwire.transactioninfo.connectionid", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire TransactionInfo ConnectionId", HFILL }},\r\n{ &hf_openwire_transactioninfo_transactionid,\r\n{ "TransactionId", "openwire.transactioninfo.transactionid", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire TransactionInfo TransactionId", HFILL }},\r\n{ &hf_openwire_transactioninfo_type,\r\n{ "Type", "openwire.transactioninfo.type", FT_UINT8, BASE_DEC, VALS(openwire_transaction_type_vals), 0x0, "Openwire TransactionInfo Type", HFILL }},\r\n{ &hf_openwire_producerack_producerid,\r\n{ "ProducerId", "openwire.producerack.producerid", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire ProducerAck ProducerId", HFILL }},\r\n{ &hf_openwire_producerack_size,\r\n{ "Size", "openwire.producerack.size", FT_INT32, BASE_DEC, NULL, 0x0, "Openwire ProducerAck Size", HFILL }},\r\n{ &hf_openwire_messagedispatch_consumerid,\r\n{ "ConsumerId", "openwire.messagedispatch.consumerid", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire MessageDispatch ConsumerId", HFILL }},\r\n{ &hf_openwire_messagedispatch_destination,\r\n{ "Destination", "openwire.messagedispatch.destination", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire MessageDispatch Destination", HFILL }},\r\n{ &hf_openwire_messagedispatch_message,\r\n{ "Message", "openwire.messagedispatch.message", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire MessageDispatch Message", HFILL }},\r\n{ &hf_openwire_messagedispatch_redeliverycounter,\r\n{ "RedeliveryCounter", "openwire.messagedispatch.redeliverycounter", FT_INT32, BASE_DEC, NULL, 0x0, "Openwire MessageDispatch RedeliveryCounter", HFILL }},\r\n{ &hf_openwire_messageack_destination,\r\n{ "Destination", "openwire.messageack.destination", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire MessageAck Destination", HFILL }},\r\n{ &hf_openwire_messageack_transactionid,\r\n{ "TransactionId", "openwire.messageack.transactionid", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire MessageAck TransactionId", HFILL }},\r\n{ &hf_openwire_messageack_consumerid,\r\n{ "ConsumerId", "openwire.messageack.consumerid", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire MessageAck ConsumerId", HFILL }},\r\n{ &hf_openwire_messageack_acktype,\r\n{ "AckType", "openwire.messageack.acktype", FT_UINT8, BASE_DEC, VALS(openwire_message_ack_type_vals), 0x0, "Openwire MessageAck AckType", HFILL }},\r\n{ &hf_openwire_messageack_firstmessageid,\r\n{ "FirstMessageId", "openwire.messageack.firstmessageid", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire MessageAck FirstMessageId", HFILL }},\r\n{ &hf_openwire_messageack_lastmessageid,\r\n{ "LastMessageId", "openwire.messageack.lastmessageid", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire MessageAck LastMessageId", HFILL }},\r\n{ &hf_openwire_messageack_messagecount,\r\n{ "MessageCount", "openwire.messageack.messagecount", FT_INT32, BASE_DEC, NULL, 0x0, "Openwire MessageAck MessageCount", HFILL }},\r\n{ &hf_openwire_messagepull_consumerid,\r\n{ "ConsumerId", "openwire.messagepull.consumerid", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire MessagePull ConsumerId", HFILL }},\r\n{ &hf_openwire_messagepull_destinationid,\r\n{ "DestinationId", "openwire.messagepull.destinationid", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire MessagePull DestinationId", HFILL }},\r\n{ &hf_openwire_messagepull_timeout,\r\n{ "Timeout", "openwire.messagepull.timeout", FT_INT64, BASE_DEC, NULL, 0x0, "Openwire MessagePull Timeout", HFILL }},\r\n{ &hf_openwire_messagepull_correlationid,\r\n{ "CorrelationId", "openwire.messagepull.correlationid", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire MessagePull CorrelationId", HFILL }},\r\n{ &hf_openwire_messagepull_messageid,\r\n{ "MessageId", "openwire.messagepull.messageid", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire MessagePull MessageId", HFILL }},\r\n{ &hf_openwire_message_producerid,\r\n{ "ProducerId", "openwire.message.producerid", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire message ProducerID", HFILL }},\r\n{ &hf_openwire_message_destination,\r\n{ "Destination", "openwire.message.destination", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire message Destination", HFILL }},\r\n{ &hf_openwire_message_transactionid,\r\n{ "TransactionId", "openwire.message.transactionid", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire message TransactionId", HFILL }},\r\n{ &hf_openwire_message_originaldestination,\r\n{ "OriginalDestination", "openwire.message.originaldestination", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire message OriginalDestination", HFILL }},\r\n{ &hf_openwire_message_messageid,\r\n{ "MessageId", "openwire.message.messageid", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire message MessageId", HFILL }},\r\n{ &hf_openwire_message_originaldestinationid,\r\n{ "OriginalDestinationId", "openwire.message.originaldestinationid", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire message OriginalDestinationId", HFILL }},\r\n{ &hf_openwire_message_groupid,\r\n{ "GroupID", "openwire.message.groupid", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire message GroupID", HFILL }},\r\n{ &hf_openwire_message_groupsequence,\r\n{ "GroupSequence", "openwire.message.groupsequence", FT_INT32, BASE_DEC, NULL, 0x0, "Openwire message GroupSequence", HFILL }},\r\n{ &hf_openwire_message_correlationid,\r\n{ "CorrelationId", "openwire.message.correlationid", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire message CorrelationID", HFILL }},\r\n{ &hf_openwire_message_persistent,\r\n{ "Persistent", "openwire.message.persistent", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire message Persistent", HFILL }},\r\n{ &hf_openwire_message_expiration,\r\n{ "Expiration", "openwire.message.expiration", FT_INT64, BASE_DEC, NULL, 0x0, "Openwire message Expiration", HFILL }},\r\n{ &hf_openwire_message_priority,\r\n{ "Priority", "openwire.message.priority", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire message Priority", HFILL }},\r\n{ &hf_openwire_message_replyto,\r\n{ "ReplyTo", "openwire.message.replyto", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire message ReplyTo", HFILL }},\r\n{ &hf_openwire_message_timestamp,\r\n{ "Timestamp", "openwire.message.timestamp", FT_INT64, BASE_DEC, NULL, 0x0, "Openwire message Timestamp", HFILL }},\r\n{ &hf_openwire_message_type,\r\n{ "Type", "openwire.message.type", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire message Type", HFILL }},\r\n{ &hf_openwire_message_body,\r\n{ "Body", "openwire.message.body", FT_BYTES, BASE_NONE, NULL, 0x0, "Openwire message Body", HFILL }},\r\n{ &hf_openwire_message_properties,\r\n{ "Properties", "openwire.message.properties", FT_BYTES, BASE_NONE, NULL, 0x0, "Openwire message Properties", HFILL }},\r\n{ &hf_openwire_message_datastructure,\r\n{ "DataStructure", "openwire.message.datastructure", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire message DataStructure", HFILL }},\r\n{ &hf_openwire_message_targetconsumerid,\r\n{ "TargetConsumerId", "openwire.message.targetconsumerid", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire message TargetConsumerId", HFILL }},\r\n{ &hf_openwire_message_compressed,\r\n{ "Compressed", "openwire.message.compressed", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire message Compressed", HFILL }},\r\n{ &hf_openwire_message_redeliverycount,\r\n{ "RedeliveryCount", "openwire.message.redeliverycount", FT_INT32, BASE_DEC, NULL, 0x0, "Openwire message RedeliveryCount", HFILL }},\r\n{ &hf_openwire_message_brokerpath,\r\n{ "BrokerPath", "openwire.message.brokerpath", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire message BrokerPath", HFILL }},\r\n{ &hf_openwire_message_arrival,\r\n{ "Arrival", "openwire.message.arrival", FT_INT64, BASE_DEC, NULL, 0x0, "Openwire message Arrival", HFILL }},\r\n{ &hf_openwire_message_userid,\r\n{ "UserID", "openwire.message.userid", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire message UserID", HFILL }},\r\n{ &hf_openwire_message_receivedbydfbridge,\r\n{ "RecievedByDFBridge", "openwire.message.receivedbydfbridge", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire message ReceivedByDFBridge", HFILL }},\r\n{ &hf_openwire_message_droppable,\r\n{ "Droppable", "openwire.message.droppable", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire message Droppable", HFILL }},\r\n{ &hf_openwire_message_cluster,\r\n{ "Cluster", "openwire.message.cluster", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire message Cluster", HFILL }},\r\n{ &hf_openwire_message_brokerintime,\r\n{ "BrokerInTime", "openwire.message.brokerintime", FT_INT64, BASE_DEC, NULL, 0x0, "Openwire message BrokerInTime", HFILL }},\r\n{ &hf_openwire_message_brokerouttime,\r\n{ "BrokerOutTime", "openwire.message.brokerouttime", FT_INT64, BASE_DEC, NULL, 0x0, "Openwire message BrokerOutTime", HFILL }},\r\n{ &hf_openwire_producerid_connectionid,\r\n{ "ConnectionId", "openwire.producerid.connectionid", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire ProducerId ConnectionId", HFILL }},\r\n{ &hf_openwire_producerid_value,\r\n{ "Value", "openwire.producerid.value", FT_INT64, BASE_DEC, NULL, 0x0, "Openwire ProducerId Value", HFILL }},\r\n{ &hf_openwire_producerid_sessionid,\r\n{ "SessionId", "openwire.producerid.sessionid", FT_INT64, BASE_DEC, NULL, 0x0, "Openwire ProducerId SessionId", HFILL }},\r\n{ &hf_openwire_consumerid_connectionid,\r\n{ "ConnectionId", "openwire.consumerid.connectionid", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire ConsumerId ConnectionId", HFILL }},\r\n{ &hf_openwire_consumerid_value,\r\n{ "Value", "openwire.consumerid.value", FT_INT64, BASE_DEC, NULL, 0x0, "Openwire ConsumerId Value", HFILL }},\r\n{ &hf_openwire_consumerid_sessionid,\r\n{ "SessionId", "openwire.consumerid.sessionid", FT_INT64, BASE_DEC, NULL, 0x0, "Openwire ConsumerId SessionId", HFILL }},\r\n{ &hf_openwire_destination_name,\r\n{ "Name", "openwire.destination.name", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire Destination Name", HFILL }},\r\n{ &hf_openwire_messageid_producerid,\r\n{ "ProducerId", "openwire.messageid.producerid", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire MessageId ProducerId", HFILL }},\r\n{ &hf_openwire_messageid_producersequenceid,\r\n{ "ProducerSequenceId", "openwire.messageid.producersequenceid", FT_INT64, BASE_DEC, NULL, 0x0, "Openwire MessageId ProducerSequenceId", HFILL }},\r\n{ &hf_openwire_messageid_brokersequenceid,\r\n{ "BrokerSequenceId", "openwire.messageid.brokersequenceid", FT_INT64, BASE_DEC, NULL, 0x0, "Openwire MessageId BrokerSequenceId", HFILL }},\r\n{ &hf_openwire_connectionid_value,\r\n{ "Value", "openwire.connectionid.value", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire ConnectionId Value", HFILL }},\r\n{ &hf_openwire_sessionid_connectionid,\r\n{ "Connection", "openwire.sessionid.connectionid", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire SessionId ConnectionId", HFILL }},\r\n{ &hf_openwire_sessionid_value,\r\n{ "Value", "openwire.sessionid.value", FT_INT64, BASE_DEC, NULL, 0x0, "Openwire SessionId Value", HFILL }},\r\n{ &hf_openwire_brokerid_value,\r\n{ "Value", "openwire.brokerid.value", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire BrokerId Value", HFILL }},\r\n{ &hf_openwire_localtransactionid_value,\r\n{ "Value", "openwire.localtransactionid.value", FT_INT64, BASE_DEC, NULL, 0x0, "Openwire LocalTransactionId Value", HFILL }},\r\n{ &hf_openwire_localtransactionid_connectionid,\r\n{ "ConnectionId", "openwire.localtransactionid.connectionid", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire LocalTransactionId ConnecctionId", HFILL }},\r\n{ &hf_openwire_xatransactionid_formatid,\r\n{ "FormatId", "openwire.xatransactionid.formatid", FT_INT32, BASE_DEC, NULL, 0x0, "Openwire XATransactionId FormatId", HFILL }},\r\n{ &hf_openwire_xatransactionid_globaltransactionid,\r\n{ "GlobalTransactionId", "openwire.xatransactionid.globaltransactionid", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire XATransactionId GlobalTransactionId", HFILL }},\r\n{ &hf_openwire_xatransactionid_branchqualifier,\r\n{ "BranchQualifier", "openwire.xatransactionid.branchqualifier", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire XATransactionId BranchQualifier", HFILL }},\r\n{ &hf_openwire_none,\r\n{ "Generic field", "openwire.generic", FT_BYTES, BASE_NONE, NULL, 0x0, "Openwire integer type", HFILL }},\r\n{ &hf_openwire_map_length,\r\n{ "Length", "openwire.map.length", FT_INT32, BASE_DEC, NULL, 0x0, "Openwire map length", HFILL }},\r\n{ &hf_openwire_map_key,\r\n{ "Key", "openwire.map.key", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire map Key", HFILL }},\r\n{ &hf_openwire_map_entry,\r\n{ "Entry", "openwire.map.entry", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire map Entry", HFILL }},\r\n{ &hf_openwire_throwable_class,\r\n{ "Class", "openwire.throwable.class", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire Throwable Class", HFILL }},\r\n{ &hf_openwire_throwable_message,\r\n{ "Message", "openwire.throwable.message", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire Throwable Message", HFILL }},\r\n{ &hf_openwire_throwable_element,\r\n{ "Element", "openwire.throwable.element", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire Throwable Element", HFILL }},\r\n{ &hf_openwire_throwable_classname,\r\n{ "ClassName", "openwire.throwable.classname", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire Throwable ClassName", HFILL }},\r\n{ &hf_openwire_throwable_methodname,\r\n{ "MethodName", "openwire.throwable.methodname", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire Throwable MethodName", HFILL }},\r\n{ &hf_openwire_throwable_filename,\r\n{ "FileName", "openwire.throwable.filename", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire Throwable FileName", HFILL }},\r\n{ &hf_openwire_throwable_linenumber,\r\n{ "LineNumber", "openwire.throwable.linenumber", FT_UINT32, BASE_DEC, NULL, 0x0, "Openwire Throwable LineNumber", HFILL }},\r\n{ &hf_openwire_type_integer,\r\n{ "Integer", "openwire.type.integer", FT_INT32, BASE_DEC, NULL, 0x0, "Openwire Integer type", HFILL }},\r\n{ &hf_openwire_type_short,\r\n{ "Short", "openwire.type.short", FT_INT32, BASE_DEC, NULL, 0x0, "Openwire Short type", HFILL }},\r\n{ &hf_openwire_type_string,\r\n{ "String", "openwire.type.string", FT_STRINGZ, BASE_NONE, NULL, 0x0, "Openwire String type", HFILL }},\r\n{ &hf_openwire_type_bytes,\r\n{ "Bytes", "openwire.type.bytes", FT_BYTES, BASE_NONE, NULL, 0x0, "Openwire Bytes type", HFILL }},\r\n{ &hf_openwire_type_boolean,\r\n{ "Boolean", "openwire.type.boolean", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire Boolean type", HFILL }},\r\n{ &hf_openwire_type_byte,\r\n{ "Byte", "openwire.type.byte", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire Byte type", HFILL }},\r\n{ &hf_openwire_type_char,\r\n{ "Char", "openwire.type.char", FT_UINT16, BASE_DEC, NULL, 0x0, "Openwire Char type", HFILL }},\r\n{ &hf_openwire_type_long,\r\n{ "Long", "openwire.type.long", FT_INT64, BASE_DEC, NULL, 0x0, "Openwire Cong type", HFILL }},\r\n{ &hf_openwire_type_float,\r\n{ "Float", "openwire.type.float", FT_FLOAT, BASE_NONE, NULL, 0x0, "Openwire Float type", HFILL }},\r\n{ &hf_openwire_type_double,\r\n{ "Double", "openwire.type.double", FT_DOUBLE, BASE_NONE, NULL, 0x0, "Openwire Double type", HFILL }},\r\n{ &hf_openwire_type_notnull,\r\n{ "NotNull", "openwire.type.notnull", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire NotNull type", HFILL }},\r\n{ &hf_openwire_cached_inlined,\r\n{ "Inlined", "openwire.cached.inlined", FT_UINT8, BASE_DEC, NULL, 0x0, "Openwire Cached Inlined", HFILL }},\r\n{ &hf_openwire_cached_id,\r\n{ "CachedID", "openwire.cached.id", FT_UINT16, BASE_DEC, NULL, 0x0, "Openwire Cached ID", HFILL }},\r\n{ &hf_openwire_cached_enabled,\r\n{ "CachedEnabled", "openwire.cached.enabled", FT_BOOLEAN, BASE_NONE, NULL, 0x0, "Openwire Cached Enabled", HFILL }},\r\n{ &hf_openwire_type_object,\r\n{ "Object", "openwire.type.object", FT_NONE, BASE_NONE, NULL, 0x0, "Openwire object", HFILL }},\r\n{ &hf_openwire_type,\r\n{ "Type", "openwire.type", FT_UINT8, BASE_DEC, VALS(openwire_type_vals), 0x0, "Openwire type", HFILL }}\r\n};\r\nstatic gint *ett[] = {\r\n&ett_openwire,\r\n&ett_openwire_type\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_openwire_encoding_not_supported, { "openwire.encoding_not_supported", PI_PROTOCOL, PI_WARN, "OpenWire encoding not supported by Wireshark or dissector bug", EXPFILL }},\r\n{ &ei_openwire_body_type_not_supported, { "openwire.body_type_not_supported", PI_UNDECODED, PI_NOTE, "OpenWire body type not supported by Wireshark", EXPFILL }},\r\n{ &ei_openwire_type_not_supported, { "openwire.type.not_supported", PI_UNDECODED, PI_NOTE, "OpenWire type not supported by Wireshark", EXPFILL }},\r\n{ &ei_openwire_command_not_supported, { "openwire.command.not_supported", PI_UNDECODED, PI_NOTE, "OpenWire command not supported by Wireshark", EXPFILL }},\r\n{ &ei_openwire_tight_encoding_not_supported, { "openwire.tight_encoding_not_supported", PI_UNDECODED, PI_NOTE, "OpenWire tight encoding not supported by Wireshark", EXPFILL }},\r\n};\r\nmodule_t *openwire_module;\r\nexpert_module_t* expert_openwire;\r\nproto_openwire = proto_register_protocol("OpenWire", "OpenWire", "openwire");\r\nproto_register_field_array(proto_openwire, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_openwire = expert_register_protocol(proto_openwire);\r\nexpert_register_field_array(expert_openwire, ei, array_length(ei));\r\nopenwire_module = prefs_register_protocol(proto_openwire, NULL);\r\nprefs_register_bool_preference(openwire_module, "desegment",\r\n"Reassemble Openwire messages spanning multiple TCP segments",\r\n"Whether the Openwire dissector should reassemble messages spanning multiple TCP segments."\r\n" To use this option, you must also enable \"Allow subdissectors to reassemble TCP streams\" in the TCP protocol settings.",\r\n&openwire_desegment);\r\nprefs_register_bool_preference(openwire_module, "verbose_type",\r\n"Show verbose type information",\r\n"Whether verbose type and length information are displayed in the protocol tree",\r\n&openwire_verbose_type);\r\n}\r\nvoid\r\nproto_reg_handoff_openwire(void)\r\n{\r\nheur_dissector_add("tcp", dissect_openwire_heur, "OpenWire over TCP", "openwire_tcp", proto_openwire, HEURISTIC_ENABLE);\r\nopenwire_tcp_handle = create_dissector_handle(dissect_openwire_tcp, proto_openwire);\r\ndissector_add_for_decode_as("tcp.port", openwire_tcp_handle);\r\n}
