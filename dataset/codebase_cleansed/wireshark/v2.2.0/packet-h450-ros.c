static int\r\nargument_cb(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree _U_, void* data _U_) {\r\narg_next_tvb = tvb;\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic int\r\nresult_cb(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree _U_, void* data _U_) {\r\nres_next_tvb = tvb;\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic int\r\nerror_cb(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree _U_, void* data _U_) {\r\nerr_next_tvb = tvb;\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic int\r\ndissect_h450_ros_T_local(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_integer(tvb, offset, actx, tree, hf_index, &actx->rose_ctx->d.code_local);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h450_ros_T_global(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_object_identifier_str(tvb, offset, actx, tree, hf_index, &actx->rose_ctx->d.code_global);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h450_ros_Code(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_choice(tvb, offset, actx, tree, hf_index,\r\nett_h450_ros_Code, Code_choice,\r\n&actx->rose_ctx->d.code);\r\n#line 39 "./asn1/h450-ros/h450-ros.cnf"\r\nactx->rose_ctx->d.code_item = actx->created_item;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h450_ros_InvokeId(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_integer(tvb, offset, actx, tree, hf_index, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h450_ros_T_invokeIdConstrained(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 67 "./asn1/h450-ros/h450-ros.cnf"\r\noffset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,\r\n0U, 65535U, NULL, TRUE);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h450_ros_InvokeArgument(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_open_type_pdu_new(tvb, offset, actx, tree, hf_index, argument_cb);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h450_ros_Invoke(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 6 "./asn1/ros/ros-inv.cnf"\r\ndissector_handle_t arg_handle = NULL;\r\nconst gchar *descr = "";\r\narg_next_tvb = NULL;\r\noffset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,\r\nett_h450_ros_Invoke, Invoke_sequence);\r\n#line 11 "./asn1/ros/ros-inv.cnf"\r\nactx->rose_ctx->d.pdu = 1;\r\nif ((actx->rose_ctx->d.code == 0) && actx->rose_ctx->arg_local_dissector_table) {\r\narg_handle = dissector_get_uint_handle(actx->rose_ctx->arg_local_dissector_table, actx->rose_ctx->d.code_local);\r\n} else if ((actx->rose_ctx->d.code == 1) && actx->rose_ctx->arg_global_dissector_table) {\r\narg_handle = dissector_get_string_handle(actx->rose_ctx->arg_global_dissector_table, actx->rose_ctx->d.code_global);\r\n} else {\r\narg_handle = NULL;\r\n}\r\nif (!arg_handle ||\r\n!proto_is_protocol_enabled(find_protocol_by_id(dissector_handle_get_protocol_index(arg_handle)))) {\r\nif (actx->rose_ctx->d.code == 0)\r\ndescr = wmem_strdup_printf(wmem_packet_scope(), "INV: %d", actx->rose_ctx->d.code_local);\r\nelse if (actx->rose_ctx->d.code == 1)\r\ndescr = wmem_strdup_printf(wmem_packet_scope(), "INV: %s", actx->rose_ctx->d.code_global);\r\n} else {\r\ndescr = wmem_strdup(wmem_packet_scope(), "INV:");\r\n}\r\nif (actx->rose_ctx->apdu_depth >= 0)\r\nproto_item_append_text(proto_item_get_parent_nth(proto_tree_get_parent(tree), actx->rose_ctx->apdu_depth), " %s", descr);\r\nif (actx->rose_ctx->fillin_info)\r\ncol_append_str(actx->pinfo->cinfo, COL_INFO, descr);\r\nif (actx->rose_ctx->fillin_ptr)\r\ng_strlcat(actx->rose_ctx->fillin_ptr, descr, actx->rose_ctx->fillin_buf_size);\r\nif (!arg_next_tvb) {\r\narg_next_tvb = tvb_new_subset(tvb, (actx->encoding==ASN1_ENC_PER)?offset>>3:offset, 0, 0);\r\n}\r\ncall_dissector_with_data((arg_handle)?arg_handle:data_handle, arg_next_tvb, actx->pinfo, tree, actx->rose_ctx);\r\nif (!arg_handle) {\r\nexpert_add_info_format(actx->pinfo, tree, &ei_ros_undecoded, "Undecoded %s", descr);\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h450_ros_ResultArgument(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_open_type_pdu_new(tvb, offset, actx, tree, hf_index, result_cb);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h450_ros_T_result(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,\r\nett_h450_ros_T_result, T_result_sequence);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h450_ros_ReturnResult(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 6 "./asn1/ros/ros-res.cnf"\r\ndissector_handle_t res_handle = NULL;\r\nconst gchar *descr = "";\r\nactx->rose_ctx->d.code = -1;\r\nres_next_tvb = NULL;\r\noffset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,\r\nett_h450_ros_ReturnResult, ReturnResult_sequence);\r\n#line 12 "./asn1/ros/ros-res.cnf"\r\nactx->rose_ctx->d.pdu = 2;\r\nif ((actx->rose_ctx->d.code == 0) && actx->rose_ctx->res_local_dissector_table) {\r\nres_handle = dissector_get_uint_handle(actx->rose_ctx->res_local_dissector_table, actx->rose_ctx->d.code_local);\r\n} else if ((actx->rose_ctx->d.code == 1) && actx->rose_ctx->res_global_dissector_table) {\r\nres_handle = dissector_get_string_handle(actx->rose_ctx->res_global_dissector_table, actx->rose_ctx->d.code_global);\r\n} else {\r\nres_handle = NULL;\r\n}\r\nif (!res_handle ||\r\n!proto_is_protocol_enabled(find_protocol_by_id(dissector_handle_get_protocol_index(res_handle)))) {\r\nif (actx->rose_ctx->d.code == 0)\r\ndescr = wmem_strdup_printf(wmem_packet_scope(), "RES: %d", actx->rose_ctx->d.code_local);\r\nelse if (actx->rose_ctx->d.code == 1)\r\ndescr = wmem_strdup_printf(wmem_packet_scope(), "RES: %s", actx->rose_ctx->d.code_global);\r\n} else {\r\ndescr = wmem_strdup(wmem_packet_scope(), "RES:");\r\n}\r\nif (actx->rose_ctx->apdu_depth >= 0)\r\nproto_item_append_text(proto_item_get_parent_nth(proto_tree_get_parent(tree), actx->rose_ctx->apdu_depth), " %s", descr);\r\nif (actx->rose_ctx->fillin_info)\r\ncol_append_str(actx->pinfo->cinfo, COL_INFO, descr);\r\nif (actx->rose_ctx->fillin_ptr)\r\ng_strlcat(actx->rose_ctx->fillin_ptr, descr, actx->rose_ctx->fillin_buf_size);\r\nif (actx->rose_ctx->d.code != -1) {\r\nif (!res_next_tvb) {\r\nres_next_tvb = tvb_new_subset(tvb, (actx->encoding==ASN1_ENC_PER)?offset>>3:offset, 0, 0);\r\n}\r\ncall_dissector_with_data((res_handle)?res_handle:data_handle, res_next_tvb, actx->pinfo, tree, actx->rose_ctx);\r\nif (!res_handle) {\r\nexpert_add_info_format(actx->pinfo, tree, &ei_ros_undecoded, "Undecoded %s", descr);\r\n}\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h450_ros_T_parameter(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_open_type_pdu_new(tvb, offset, actx, tree, hf_index, error_cb);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h450_ros_ReturnError(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 6 "./asn1/ros/ros-err.cnf"\r\ndissector_handle_t err_handle = NULL;\r\nconst gchar *descr = "";\r\nerr_next_tvb = NULL;\r\noffset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,\r\nett_h450_ros_ReturnError, ReturnError_sequence);\r\n#line 11 "./asn1/ros/ros-err.cnf"\r\nactx->rose_ctx->d.pdu = 3;\r\nif ((actx->rose_ctx->d.code == 0) && actx->rose_ctx->err_local_dissector_table) {\r\nerr_handle = dissector_get_uint_handle(actx->rose_ctx->err_local_dissector_table, actx->rose_ctx->d.code_local);\r\n} else if ((actx->rose_ctx->d.code == 1) && actx->rose_ctx->err_global_dissector_table) {\r\nerr_handle = dissector_get_string_handle(actx->rose_ctx->err_global_dissector_table, actx->rose_ctx->d.code_global);\r\n} else {\r\nerr_handle = NULL;\r\n}\r\nif (!err_handle ||\r\n!proto_is_protocol_enabled(find_protocol_by_id(dissector_handle_get_protocol_index(err_handle)))) {\r\nif (actx->rose_ctx->d.code == 0)\r\ndescr = wmem_strdup_printf(wmem_packet_scope(), "ERR: %d", actx->rose_ctx->d.code_local);\r\nelse if (actx->rose_ctx->d.code == 1)\r\ndescr = wmem_strdup_printf(wmem_packet_scope(), "ERR: %s", actx->rose_ctx->d.code_global);\r\n} else {\r\ndescr = wmem_strdup(wmem_packet_scope(), "ERR:");\r\n}\r\nif (actx->rose_ctx->apdu_depth >= 0)\r\nproto_item_append_text(proto_item_get_parent_nth(proto_tree_get_parent(tree), actx->rose_ctx->apdu_depth), " %s", descr);\r\nif (actx->rose_ctx->fillin_info)\r\ncol_append_str(actx->pinfo->cinfo, COL_INFO, descr);\r\nif (actx->rose_ctx->fillin_ptr)\r\ng_strlcat(actx->rose_ctx->fillin_ptr, descr, actx->rose_ctx->fillin_buf_size);\r\nif (!err_next_tvb) {\r\nerr_next_tvb = tvb_new_subset(tvb, (actx->encoding==ASN1_ENC_PER)?offset>>3:offset, 0, 0);\r\n}\r\ncall_dissector_with_data((err_handle)?err_handle:data_handle, err_next_tvb, actx->pinfo, tree, actx->rose_ctx);\r\nif (!err_handle) {\r\nexpert_add_info_format(actx->pinfo, tree, &ei_ros_undecoded, "Undecoded %s", descr);\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h450_ros_GeneralProblem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_integer(tvb, offset, actx, tree, hf_index, &problem_val);\r\n#line 50 "./asn1/h450-ros/h450-ros.cnf"\r\ng_strlcpy(problem_str, val_to_str_const(problem_val, VALS(h450_ros_GeneralProblem_vals), ""), 64);\r\nproblem_str[64-1] = '\0';\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h450_ros_InvokeProblem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_integer(tvb, offset, actx, tree, hf_index, &problem_val);\r\n#line 53 "./asn1/h450-ros/h450-ros.cnf"\r\ng_strlcpy(problem_str, val_to_str_const(problem_val, VALS(h450_ros_InvokeProblem_vals), ""), 64);\r\nproblem_str[64-1] = '\0';\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h450_ros_ReturnResultProblem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_integer(tvb, offset, actx, tree, hf_index, &problem_val);\r\n#line 56 "./asn1/h450-ros/h450-ros.cnf"\r\ng_strlcpy(problem_str, val_to_str_const(problem_val, VALS(h450_ros_ReturnResultProblem_vals), ""), 64);\r\nproblem_str[64-1] = '\0';\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h450_ros_ReturnErrorProblem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_integer(tvb, offset, actx, tree, hf_index, &problem_val);\r\n#line 59 "./asn1/h450-ros/h450-ros.cnf"\r\ng_strlcpy(problem_str, val_to_str_const(problem_val, VALS(h450_ros_ReturnErrorProblem_vals), ""), 64);\r\nproblem_str[64-1] = '\0';\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h450_ros_T_problem(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_choice(tvb, offset, actx, tree, hf_index,\r\nett_h450_ros_T_problem, T_problem_choice,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_h450_ros_Reject(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 6 "./asn1/ros/ros-rej.cnf"\r\nconst gchar *descr = "";\r\nproblem_str[0] = '\0';\r\noffset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,\r\nett_h450_ros_Reject, Reject_sequence);\r\n#line 10 "./asn1/ros/ros-rej.cnf"\r\ndescr = wmem_strdup_printf(wmem_packet_scope(), "REJ: %s", problem_str);\r\nif (actx->rose_ctx->apdu_depth >= 0)\r\nproto_item_append_text(proto_item_get_parent_nth(proto_tree_get_parent(tree), actx->rose_ctx->apdu_depth), " %s", descr);\r\nif (actx->rose_ctx->fillin_info)\r\ncol_append_str(actx->pinfo->cinfo, COL_INFO, descr);\r\nif (actx->rose_ctx->fillin_ptr)\r\ng_strlcat(actx->rose_ctx->fillin_ptr, descr, actx->rose_ctx->fillin_buf_size);\r\nreturn offset;\r\n}\r\nint\r\ndissect_h450_ros_ROS(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 28 "./asn1/h450-ros/h450-ros.cnf"\r\nDISSECTOR_ASSERT(actx->rose_ctx);\r\nrose_ctx_clean_data(actx->rose_ctx);\r\noffset = dissect_per_choice(tvb, offset, actx, tree, hf_index,\r\nett_h450_ros_ROS, ROS_choice,\r\nNULL);\r\nreturn offset;\r\n}\r\nvoid proto_register_h450_ros(void) {\r\nstatic hf_register_info hf[] = {\r\n#line 1 "./asn1/h450-ros/packet-h450-ros-hfarr.c"\r\n{ &hf_h450_ros_local,\r\n{ "local", "h450.ros.local",\r\nFT_INT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_h450_ros_global,\r\n{ "global", "h450.ros.global",\r\nFT_OID, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_h450_ros_invoke,\r\n{ "invoke", "h450.ros.invoke_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_h450_ros_returnResult,\r\n{ "returnResult", "h450.ros.returnResult_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_h450_ros_returnError,\r\n{ "returnError", "h450.ros.returnError_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_h450_ros_reject,\r\n{ "reject", "h450.ros.reject_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_h450_ros_invokeIdConstrained,\r\n{ "invokeId", "h450.ros.invokeId",\r\nFT_INT32, BASE_DEC, NULL, 0,\r\n"T_invokeIdConstrained", HFILL }},\r\n{ &hf_h450_ros_linkedId,\r\n{ "linkedId", "h450.ros.linkedId",\r\nFT_INT32, BASE_DEC, NULL, 0,\r\n"InvokeId", HFILL }},\r\n{ &hf_h450_ros_opcode,\r\n{ "opcode", "h450.ros.opcode",\r\nFT_UINT32, BASE_DEC, VALS(h450_ros_Code_vals), 0,\r\n"Code", HFILL }},\r\n{ &hf_h450_ros_argument,\r\n{ "argument", "h450.ros.argument",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"InvokeArgument", HFILL }},\r\n{ &hf_h450_ros_invokeId,\r\n{ "invokeId", "h450.ros.invokeId",\r\nFT_INT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_h450_ros_result,\r\n{ "result", "h450.ros.result_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_h450_ros_resultArgument,\r\n{ "result", "h450.ros.result",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"ResultArgument", HFILL }},\r\n{ &hf_h450_ros_errcode,\r\n{ "errcode", "h450.ros.errcode",\r\nFT_UINT32, BASE_DEC, VALS(h450_ros_Code_vals), 0,\r\n"Code", HFILL }},\r\n{ &hf_h450_ros_parameter,\r\n{ "parameter", "h450.ros.parameter",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_h450_ros_problem,\r\n{ "problem", "h450.ros.problem",\r\nFT_UINT32, BASE_DEC, VALS(h450_ros_T_problem_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_h450_ros_general,\r\n{ "general", "h450.ros.general",\r\nFT_INT32, BASE_DEC, VALS(h450_ros_GeneralProblem_vals), 0,\r\n"GeneralProblem", HFILL }},\r\n{ &hf_h450_ros_invokeProblem,\r\n{ "invoke", "h450.ros.invoke",\r\nFT_INT32, BASE_DEC, VALS(h450_ros_InvokeProblem_vals), 0,\r\n"InvokeProblem", HFILL }},\r\n{ &hf_h450_ros_returnResultProblem,\r\n{ "returnResult", "h450.ros.returnResult",\r\nFT_INT32, BASE_DEC, VALS(h450_ros_ReturnResultProblem_vals), 0,\r\n"ReturnResultProblem", HFILL }},\r\n{ &hf_h450_ros_returnErrorProblem,\r\n{ "returnError", "h450.ros.returnError",\r\nFT_INT32, BASE_DEC, VALS(h450_ros_ReturnErrorProblem_vals), 0,\r\n"ReturnErrorProblem", HFILL }},\r\n#line 86 "./asn1/h450-ros/packet-h450-ros-template.c"\r\n};\r\nstatic gint *ett[] = {\r\n#line 1 "./asn1/h450-ros/packet-h450-ros-ettarr.c"\r\n&ett_h450_ros_Code,\r\n&ett_h450_ros_ROS,\r\n&ett_h450_ros_Invoke,\r\n&ett_h450_ros_ReturnResult,\r\n&ett_h450_ros_T_result,\r\n&ett_h450_ros_ReturnError,\r\n&ett_h450_ros_Reject,\r\n&ett_h450_ros_T_problem,\r\n#line 91 "./asn1/h450-ros/packet-h450-ros-template.c"\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_ros_undecoded, { "h450.ros.undecoded", PI_UNDECODED, PI_WARN, "Undecoded", EXPFILL }},\r\n};\r\nexpert_module_t* expert_h450_ros;\r\nproto_h450_ros = proto_register_protocol(PNAME, PSNAME, PFNAME);\r\nproto_set_cant_toggle(proto_h450_ros);\r\nproto_register_field_array(proto_h450_ros, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_h450_ros = expert_register_protocol(proto_h450_ros);\r\nexpert_register_field_array(expert_h450_ros, ei, array_length(ei));\r\n}\r\nvoid proto_reg_handoff_h450_ros(void) {\r\ndata_handle = find_dissector("data");\r\n}
