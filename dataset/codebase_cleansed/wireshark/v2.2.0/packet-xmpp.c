static int\r\ndissect_xmpp(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_) {\r\nxml_frame_t *xml_frame;\r\nxml_frame_t *xml_dissector_frame;\r\ngboolean out_packet;\r\nconversation_t *conversation;\r\nxmpp_conv_info_t *xmpp_info;\r\nproto_tree *xmpp_tree = NULL;\r\nproto_item *xmpp_item = NULL;\r\nproto_item *outin_item;\r\nxmpp_element_t *packet = NULL;\r\nint proto_xml = dissector_handle_get_protocol_index(xml_handle);\r\nint indx;\r\ngchar last_char;\r\nconversation = find_or_create_conversation(pinfo);\r\nxmpp_info = (xmpp_conv_info_t *)conversation_get_proto_data(conversation, proto_xmpp);\r\nif (!xmpp_info && xmpp_desegment)\r\n{\r\nindx = tvb_reported_length(tvb) - 1;\r\nif (indx >= 0)\r\n{\r\nlast_char = tvb_get_guint8(tvb, indx);\r\nwhile ((last_char <= ' ') && (indx - 1 >= 0))\r\n{\r\nindx--;\r\nlast_char = tvb_get_guint8(tvb, indx);\r\n}\r\nif ((indx >= 0) && (last_char != '>'))\r\n{\r\npinfo->desegment_len = DESEGMENT_ONE_MORE_SEGMENT;\r\nreturn tvb_captured_length(tvb);\r\n}\r\n}\r\n}\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "XMPP");\r\ncol_clear(pinfo->cinfo, COL_INFO);\r\nxmpp_item = proto_tree_add_item(tree, proto_xmpp, tvb, 0, -1, ENC_NA);\r\nxmpp_tree = proto_item_add_subtree(xmpp_item, ett_xmpp);\r\ncall_dissector_with_data(xml_handle, tvb, pinfo, xmpp_tree, NULL);\r\nif (!proto_is_protocol_enabled(find_protocol_by_id(proto_xml)))\r\n{\r\ncol_append_str(pinfo->cinfo, COL_INFO, "(XML dissector disabled, can't dissect XMPP)");\r\nexpert_add_info(pinfo, xmpp_item, &ei_xmpp_xml_disabled);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nif(xmpp_stream_close(xmpp_tree,tvb, pinfo))\r\n{\r\nif(xmpp_tree)\r\nxmpp_proto_tree_hide_first_child(xmpp_tree);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nxml_dissector_frame = (xml_frame_t *)p_get_proto_data(pinfo->pool, pinfo, proto_xml, 0);\r\nif(xml_dissector_frame == NULL)\r\nreturn tvb_captured_length(tvb);\r\nxml_frame = xml_dissector_frame->first_child;\r\nif(!xml_frame)\r\nreturn tvb_captured_length(tvb);\r\nif (!xmpp_info) {\r\nxmpp_info = wmem_new(wmem_file_scope(), xmpp_conv_info_t);\r\nxmpp_info->req_resp = wmem_tree_new(wmem_file_scope());\r\nxmpp_info->jingle_sessions = wmem_tree_new(wmem_file_scope());\r\nxmpp_info->ibb_sessions = wmem_tree_new(wmem_file_scope());\r\nxmpp_info->gtalk_sessions = wmem_tree_new(wmem_file_scope());\r\nxmpp_info->ssl_start = 0;\r\nconversation_add_proto_data(conversation, proto_xmpp, (void *) xmpp_info);\r\n}\r\nif (pinfo->match_uint == pinfo->destport)\r\nout_packet = TRUE;\r\nelse\r\nout_packet = FALSE;\r\nwhile(xml_frame)\r\n{\r\npacket = xmpp_xml_frame_to_element_t(xml_frame, NULL, tvb);\r\nDISSECTOR_ASSERT(packet);\r\nif (strcmp(packet->name, "iq") == 0) {\r\nxmpp_iq_reqresp_track(pinfo, packet, xmpp_info);\r\nxmpp_jingle_session_track(pinfo, packet, xmpp_info);\r\nxmpp_gtalk_session_track(pinfo, packet, xmpp_info);\r\n}\r\nif (strcmp(packet->name, "iq") == 0 || strcmp(packet->name, "message") == 0) {\r\nxmpp_ibb_session_track(pinfo, packet, xmpp_info);\r\n}\r\nif (out_packet)\r\noutin_item = proto_tree_add_boolean(xmpp_tree, hf_xmpp_out, tvb, 0, 0, TRUE);\r\nelse\r\noutin_item = proto_tree_add_boolean(xmpp_tree, hf_xmpp_in, tvb, 0, 0, TRUE);\r\nPROTO_ITEM_SET_HIDDEN(outin_item);\r\nxmpp_proto_tree_hide_first_child(xmpp_tree);\r\nif (strcmp(packet->name, "iq") == 0) {\r\nxmpp_iq(xmpp_tree, tvb, pinfo, packet);\r\n} else if (strcmp(packet->name, "presence") == 0) {\r\nxmpp_presence(xmpp_tree, tvb, pinfo, packet);\r\n} else if (strcmp(packet->name, "message") == 0) {\r\nxmpp_message(xmpp_tree, tvb, pinfo, packet);\r\n} else if (strcmp(packet->name, "auth") == 0) {\r\nxmpp_auth(xmpp_tree, tvb, pinfo, packet);\r\n} else if (strcmp(packet->name, "challenge") == 0) {\r\nxmpp_challenge_response_success(xmpp_tree, tvb, pinfo, packet, &ei_xmpp_challenge, ett_xmpp_challenge, "CHALLENGE");\r\n} else if (strcmp(packet->name, "response") == 0) {\r\nxmpp_challenge_response_success(xmpp_tree, tvb, pinfo, packet, &ei_xmpp_response, ett_xmpp_response, "RESPONSE");\r\n} else if (strcmp(packet->name, "success") == 0) {\r\nxmpp_challenge_response_success(xmpp_tree, tvb, pinfo, packet, &ei_xmpp_success, ett_xmpp_success, "SUCCESS");\r\n} else if (strcmp(packet->name, "failure") == 0) {\r\nxmpp_failure(xmpp_tree, tvb, pinfo, packet);\r\n} else if (strcmp(packet->name, "xml") == 0) {\r\nxmpp_xml_header(xmpp_tree, tvb, pinfo, packet);\r\n} else if (strcmp(packet->name, "stream") == 0) {\r\nxmpp_stream(xmpp_tree, tvb, pinfo, packet);\r\n} else if (strcmp(packet->name, "features") == 0) {\r\nxmpp_features(xmpp_tree, tvb, pinfo, packet);\r\n} else if (strcmp(packet->name, "starttls") == 0) {\r\nxmpp_starttls(xmpp_tree, tvb, pinfo, packet, xmpp_info);\r\n}else if (strcmp(packet->name, "proceed") == 0) {\r\nxmpp_proceed(xmpp_tree, tvb, pinfo, packet, xmpp_info);\r\n}else {\r\nxmpp_proto_tree_show_first_child(xmpp_tree);\r\nexpert_add_info_format(pinfo, xmpp_tree, &ei_xmpp_packet_unknown, "Unknown packet: %s", packet->name);\r\ncol_set_str(pinfo->cinfo, COL_INFO, "UNKNOWN PACKET ");\r\n}\r\nif (pinfo->match_uint == pinfo->destport) {\r\nxmpp_attr_t *to = xmpp_get_attr(packet, "to");\r\nif (to)\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "> %s ", to->value);\r\n} else {\r\nxmpp_attr_t *from = xmpp_get_attr(packet, "from");\r\nif (from)\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "< %s ", from->value);\r\n}\r\nxmpp_element_t_tree_free(packet);\r\nxml_frame = xml_frame->next_sibling;\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_xmpp(void) {\r\nstatic hf_register_info hf[] = {\r\n{ &hf_xmpp_iq,\r\n{\r\n"IQ", "xmpp.iq", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"iq packet", HFILL\r\n}},\r\n{&hf_xmpp_xmlns,\r\n{\r\n"xmlns", "xmpp.xmlns", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"element namespace", HFILL\r\n}},\r\n{&hf_xmpp_cdata,\r\n{\r\n"CDATA", "xmpp.cdata", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{&hf_xmpp_attribute,\r\n{\r\n"Attribute", "xmpp.attribute", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{ &hf_xmpp_id,\r\n{\r\n"id", "xmpp.id", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"packet id", HFILL\r\n}},\r\n{ &hf_xmpp_type,\r\n{\r\n"type", "xmpp.type", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"packet type", HFILL\r\n}},\r\n{ &hf_xmpp_from,\r\n{\r\n"from", "xmpp.from", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"packet from", HFILL\r\n}},\r\n{ &hf_xmpp_to,\r\n{\r\n"to", "xmpp.to", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"packet to", HFILL\r\n}},\r\n{ &hf_xmpp_query,\r\n{\r\n"QUERY", "xmpp.query", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"iq query", HFILL\r\n}},\r\n{ &hf_xmpp_query_node,\r\n{\r\n"node", "xmpp.query.node", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq query node", HFILL\r\n}},\r\n{ &hf_xmpp_query_item,\r\n{\r\n"ITEM", "xmpp.query.item", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"iq query item", HFILL\r\n}},\r\n{ &hf_xmpp_query_item_jid,\r\n{\r\n"jid", "xmpp.query.item.jid", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq query item jid", HFILL\r\n}},\r\n{ &hf_xmpp_query_item_name,\r\n{\r\n"name", "xmpp.query.item.name", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq query item name", HFILL\r\n}},\r\n{ &hf_xmpp_query_item_subscription,\r\n{\r\n"subscription", "xmpp.query.item.subscription", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq query item subscription", HFILL\r\n}},\r\n{ &hf_xmpp_query_item_ask,\r\n{\r\n"ask", "xmpp.query.item.ask", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq query item ask", HFILL\r\n}},\r\n{ &hf_xmpp_query_item_group,\r\n{\r\n"GROUP", "xmpp.query.item.group", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq query item group", HFILL\r\n}},\r\n{ &hf_xmpp_query_item_approved,\r\n{\r\n"approved", "xmpp.query.item.approved", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq query item approved", HFILL\r\n}},\r\n{ &hf_xmpp_query_item_node,\r\n{\r\n"node", "xmpp.query.item.node", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq query item node", HFILL\r\n}},\r\n{ &hf_xmpp_query_identity,\r\n{\r\n"IDENTITY", "xmpp.query.identity", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"iq query identity", HFILL\r\n}},\r\n{ &hf_xmpp_query_identity_category,\r\n{\r\n"category", "xmpp.query.identity.category", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq query identity category", HFILL\r\n}},\r\n{ &hf_xmpp_query_identity_type,\r\n{\r\n"type", "xmpp.query.identity.type", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq query identity type", HFILL\r\n}},\r\n{ &hf_xmpp_query_identity_name,\r\n{\r\n"name", "xmpp.query.identity.name", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq query identity name", HFILL\r\n}},\r\n{ &hf_xmpp_query_identity_lang,\r\n{\r\n"lang", "xmpp.query.identity.lang", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq query identity lang", HFILL\r\n}},\r\n{ &hf_xmpp_query_feature,\r\n{\r\n"FEATURE", "xmpp.query.feature", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq query feature", HFILL\r\n}},\r\n{ &hf_xmpp_query_streamhost,\r\n{\r\n"STREAMHOST", "xmpp.query.streamhost", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"iq query streamhost", HFILL\r\n}},\r\n{ &hf_xmpp_query_streamhost_used,\r\n{\r\n"STREAMHOST-USED", "xmpp.query.streamhost-used", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"iq query streamhost-used", HFILL\r\n}},\r\n{ &hf_xmpp_query_activate,\r\n{\r\n"ACTIVATE", "xmpp.query.activate", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq query activate", HFILL\r\n}},\r\n{ &hf_xmpp_query_udpsuccess,\r\n{\r\n"UDPSUCCESS", "xmpp.query.udpsuccess", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"iq query streamhost-used", HFILL\r\n}},\r\n{ &hf_xmpp_error,\r\n{\r\n"ERROR", "xmpp.error", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"iq error", HFILL\r\n}},\r\n{ &hf_xmpp_error_code,\r\n{\r\n"code", "xmpp.error.code", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq stanza error code", HFILL\r\n}},\r\n{ &hf_xmpp_error_type,\r\n{\r\n"type", "xmpp.error.type", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq error type", HFILL\r\n}},\r\n{ &hf_xmpp_error_condition,\r\n{\r\n"CONDITION", "xmpp.error.condition", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq error condition", HFILL\r\n}},\r\n{ &hf_xmpp_error_text,\r\n{\r\n"TEXT", "xmpp.error.text", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq error text", HFILL\r\n}},\r\n{ &hf_xmpp_iq_bind,\r\n{\r\n"BIND", "xmpp.iq.bind", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"iq bind", HFILL\r\n}},\r\n{ &hf_xmpp_iq_bind_jid,\r\n{\r\n"jid", "xmpp.iq.bind.jid", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq bind jid", HFILL\r\n}},\r\n{ &hf_xmpp_iq_bind_resource,\r\n{\r\n"resource", "xmpp.iq.bind.resource", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq bind resource", HFILL\r\n}},\r\n{ &hf_xmpp_services,\r\n{\r\n"SERVICES", "xmpp.services", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"http://jabber.org/protocol/jinglenodes services", HFILL\r\n}},\r\n{ &hf_xmpp_channel,\r\n{\r\n"CHANNEL", "xmpp.channel", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"http://jabber.org/protocol/jinglenodes#channel", HFILL\r\n}},\r\n{ &hf_xmpp_iq_session,\r\n{\r\n"SESSION", "xmpp.iq.session", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"iq session", HFILL\r\n}},\r\n{ &hf_xmpp_vcard,\r\n{\r\n"VCARD", "xmpp.vcard", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"vcard-temp", HFILL\r\n}},\r\n{ &hf_xmpp_vcard_x_update,\r\n{\r\n"X VCARD-UPDATE", "xmpp.vcard-update", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"vcard-temp:x:update", HFILL\r\n}},\r\n{ &hf_xmpp_jingle,\r\n{\r\n"JINGLE", "xmpp.jingle", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"iq jingle", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_action,\r\n{\r\n"action", "xmpp.jingle.action", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq jingle action", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_sid,\r\n{\r\n"sid", "xmpp.jingle.sid", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq jingle sid", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_initiator,\r\n{\r\n"initiator", "xmpp.jingle.initiator", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq jingle initiator", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_responder,\r\n{\r\n"responder", "xmpp.jingle.responder", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq jingle responder", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_content,\r\n{\r\n"CONTENT", "xmpp.jingle.content", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"iq jingle content", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_content_creator,\r\n{\r\n"creator", "xmpp.jingle.content.creator", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq jingle content creator", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_content_name,\r\n{\r\n"name", "xmpp.jingle.content.name", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq jingle content name", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_content_disposition,\r\n{\r\n"disposition", "xmpp.jingle.content.disposition", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq jingle content disposition", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_content_senders,\r\n{\r\n"senders", "xmpp.jingle.content.senders", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq jingle content senders", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_content_description,\r\n{\r\n"DESCRIPTION", "xmpp.jingle.content.description", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"iq jingle content description", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_content_description_media,\r\n{\r\n"media", "xmpp.jingle.content.description.media", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq jingle content description", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_content_description_ssrc,\r\n{\r\n"ssrc", "xmpp.jingle.content.description.ssrc", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq jingle content description ssrc", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_cont_desc_payload,\r\n{\r\n"PAYLOAD-TYPE", "xmpp.jingle.content.description.payload-type", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"iq jingle content description payload-type", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_cont_desc_payload_id,\r\n{\r\n"id", "xmpp.jingle.content.description.payload-type.id", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq jingle content description payload-type id", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_cont_desc_payload_channels,\r\n{\r\n"channels", "xmpp.jingle.content.description.payload-type.channels", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq jingle content description payload-type channels", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_cont_desc_payload_clockrate,\r\n{\r\n"clockrate", "xmpp.jingle.content.description.payload-type.clockrate", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq jingle content description payload-type clockrate", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_cont_desc_payload_maxptime,\r\n{\r\n"maxptime", "xmpp.jingle.content.description.payload-type.maxptime", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq jingle content description payload-type maxptime", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_cont_desc_payload_name,\r\n{\r\n"name", "xmpp.jingle.content.description.payload-type.name", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq jingle content description payload-type name", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_cont_desc_payload_ptime,\r\n{\r\n"ptime", "xmpp.jingle.content.description.payload-type.ptime", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq jingle content description payload-type ptime", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_cont_desc_payload_param,\r\n{\r\n"PARAMETER", "xmpp.jingle.content.description.payload-type.parameter", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"iq jingle content description payload-type parameter", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_cont_desc_payload_param_name,\r\n{\r\n"name", "xmpp.jingle.content.description.payload-type.parameter.name", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq jingle content description payload-type parameter name", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_cont_desc_payload_param_value,\r\n{\r\n"value", "xmpp.jingle.content.description.payload-type.parameter.value", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq jingle content description payload-type parameter value", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_cont_trans,\r\n{\r\n"TRANSPORT", "xmpp.jingle.content.transport", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"iq jingle content transport", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_cont_trans_ufrag,\r\n{\r\n"ufrag", "xmpp.jingle.content.transport.ufrag", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq jingle content transport ufrag", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_cont_trans_pwd,\r\n{\r\n"pwd", "xmpp.jingle.content.transport.pwd", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq jingle content transport pwd", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_cont_trans_cand,\r\n{\r\n"CANDIDATE", "xmpp.jingle.content.transport.candidate", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"iq jingle content transport candidate", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_cont_trans_rem_cand,\r\n{\r\n"REMOTE-CANDIDATE", "xmpp.jingle.content.transport.remote-candidate", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"iq jingle content transport remote-candidate", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_cont_trans_activated,\r\n{\r\n"ACTIVATED", "xmpp.jingle.content.transport.activated", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"urn:xmpp:jingle:transports:s5b:1 activated", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_cont_trans_candidate_used,\r\n{\r\n"CANDIDATE-USED", "xmpp.jingle.content.transport.candidate-used", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"urn:xmpp:jingle:transports:s5b:1 candidate-used", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_cont_trans_candidate_error,\r\n{\r\n"CANDIDATE-ERROR", "xmpp.jingle.content.transport.candidate-error", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"urn:xmpp:jingle:transports:s5b:1 candidate-error", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_cont_trans_proxy_error,\r\n{\r\n"PROXY-ERROR", "xmpp.jingle.content.transport.proxy-error", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"urn:xmpp:jingle:transports:s5b:1 proxy-error", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_cont_desc_enc,\r\n{\r\n"ENCRYPTION", "xmpp.jingle.content.description.encryption", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"iq jingle content description encryption", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_cont_desc_enc_zrtp_hash,\r\n{\r\n"ZRTP-HASH", "xmpp.jingle.content.description.encryption.zrtp-hash", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"iq jingle content description encryption zrtp-hash", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_cont_desc_enc_crypto,\r\n{\r\n"CRYPTO", "xmpp.jingle.content.description.encryption.crypto", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"iq jingle content description encryption crypto", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_cont_desc_bandwidth,\r\n{\r\n"BANDWIDTH", "xmpp.jingle.content.description.bandwidth", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"iq jingle content description bandwidth", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_cont_desc_rtp_hdr,\r\n{\r\n"RTP-HDREXT", "xmpp.jingle.content.description.rtp-hdrext", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"iq jingle content description rtp-hdrext", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_reason,\r\n{\r\n"REASON", "xmpp.jingle.reason", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"iq jingle reason", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_reason_condition,\r\n{\r\n"CONDITION", "xmpp.jingle.reason.condition", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq jingle reason condition", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_reason_text,\r\n{\r\n"TEXT", "xmpp.jingle.reason.text", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq jingle reason text", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_rtp_info,\r\n{\r\n"RTP-INFO", "xmpp.jingle.rtp_info", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"iq jingle rtp-info(ringing, active, hold, mute, ...)", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_file_transfer_offer,\r\n{\r\n"OFFER", "xmpp.jingle.content.description.offer", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"urn:xmpp:jingle:apps:file-transfer:3 offer", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_file_transfer_request,\r\n{\r\n"REQUEST", "xmpp.jingle.content.description.request", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"urn:xmpp:jingle:apps:file-transfer:3 request", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_file_transfer_received,\r\n{\r\n"RECEIVED", "xmpp.jingle.content.received", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"urn:xmpp:jingle:apps:file-transfer:3 received", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_file_transfer_abort,\r\n{\r\n"ABORT", "xmpp.jingle.content.abort", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"urn:xmpp:jingle:apps:file-transfer:3 abort", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_file_transfer_checksum,\r\n{\r\n"CHECKSUM", "xmpp.jingle.content.checksum", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"urn:xmpp:jingle:apps:file-transfer:3 checksum", HFILL\r\n}},\r\n{ &hf_xmpp_si,\r\n{\r\n"SI", "xmpp.si", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"iq si", HFILL\r\n}},\r\n{ &hf_xmpp_si_file,\r\n{\r\n"FILE", "xmpp.si.file", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"iq si file", HFILL\r\n}},\r\n{ &hf_xmpp_iq_feature_neg,\r\n{\r\n"FEATURE", "xmpp.feature-neg", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"http://jabber.org/protocol/feature-neg", HFILL\r\n}},\r\n{ &hf_xmpp_x_data,\r\n{\r\n"X-DATA", "xmpp.x-data", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"jabber:x:data", HFILL\r\n}},\r\n{ &hf_xmpp_x_data_field,\r\n{\r\n"FIELD", "xmpp.x-data.field", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"jabber:x:data field", HFILL\r\n}},\r\n{ &hf_xmpp_x_data_field_value,\r\n{\r\n"VALUE", "xmpp.x-data.field.value", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"jabber:x:data field value", HFILL\r\n}},\r\n{ &hf_xmpp_x_data_instructions,\r\n{\r\n"INSTRUCTIONS", "xmpp.x-data.instructions", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{ &hf_xmpp_muc_user_status,\r\n{\r\n"STATUS", "xmpp.muc_user_status", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{ &hf_xmpp_delay,\r\n{\r\n"DELAY", "xmpp.delay", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"urn:xmpp:delay", HFILL\r\n}},\r\n{ &hf_xmpp_x_event,\r\n{\r\n"X EVENT", "xmpp.x-event", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"jabber:x:event", HFILL\r\n}},\r\n{ &hf_xmpp_x_event_condition,\r\n{\r\n"CONDITION", "xmpp.x-event.condition", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"jabber:x:event condition", HFILL\r\n}},\r\n{ &hf_xmpp_presence,\r\n{\r\n"PRESENCE", "xmpp.presence", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"presence packet", HFILL\r\n}},\r\n{ &hf_xmpp_presence_show,\r\n{\r\n"SHOW", "xmpp.presence.show", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"presence show", HFILL\r\n}},\r\n{ &hf_xmpp_presence_status,\r\n{\r\n"STATUS", "xmpp.presence.status", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"presence status", HFILL\r\n}},\r\n{ &hf_xmpp_presence_caps,\r\n{\r\n"CAPS", "xmpp.presence.caps", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"presence caps", HFILL\r\n}},\r\n{ &hf_xmpp_message,\r\n{\r\n"MESSAGE", "xmpp.message", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"message packet", HFILL\r\n}},\r\n{ &hf_xmpp_message_chatstate,\r\n{\r\n"CHATSTATE", "xmpp.message.chatstate", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"message chatstate", HFILL\r\n}},\r\n{ &hf_xmpp_message_thread,\r\n{\r\n"THREAD", "xmpp.message.thread", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"message thread", HFILL\r\n}},\r\n{ &hf_xmpp_message_body,\r\n{\r\n"BODY", "xmpp.message.body", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"message body", HFILL\r\n}},\r\n{ &hf_xmpp_message_subject,\r\n{\r\n"SUBJECT", "xmpp.message.subject", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"message subject", HFILL\r\n}},\r\n{ &hf_xmpp_message_thread_parent,\r\n{\r\n"parent", "xmpp.message.thread.parent", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"message thread parent", HFILL\r\n}},\r\n{ &hf_xmpp_auth,\r\n{\r\n"AUTH", "xmpp.auth", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"auth packet", HFILL\r\n}},\r\n{ &hf_xmpp_stream,\r\n{\r\n"STREAM", "xmpp.stream", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"XMPP stream", HFILL\r\n}},\r\n{ &hf_xmpp_failure,\r\n{\r\n"FAILURE", "xmpp.failure", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"failure packet", HFILL\r\n}},\r\n{ &hf_xmpp_failure_text,\r\n{\r\n"FAILURE TEXT", "xmpp.failure_text", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{ &hf_xmpp_xml_header_version,\r\n{\r\n"XML HEADER VER", "xmpp.xml_header_version", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{ &hf_xmpp_stream_end,\r\n{\r\n"STREAM END", "xmpp.stream_end", FT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{ &hf_xmpp_features,\r\n{\r\n"FEATURES", "xmpp.features", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"stream features", HFILL\r\n}},\r\n{ &hf_xmpp_starttls,\r\n{\r\n"STARTTLS", "xmpp.starttls", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"starttls packet", HFILL\r\n}},\r\n{ &hf_xmpp_proceed,\r\n{\r\n"PROCEED", "xmpp.proceed", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"proceed packet", HFILL\r\n}},\r\n{ &hf_xmpp_unknown,\r\n{\r\n"UNKNOWN", "xmpp.unknown", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"unknown element", HFILL\r\n}},\r\n{ &hf_xmpp_unknown_attr,\r\n{\r\n"UNKNOWN ATTR", "xmpp.unknown_attr", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"unknown attribute", HFILL\r\n}},\r\n{ &hf_xmpp_ibb_open,\r\n{\r\n"IBB-OPEN", "xmpp.ibb.open", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"xmpp ibb open", HFILL\r\n}},\r\n{ &hf_xmpp_ibb_close,\r\n{\r\n"IBB-CLOSE", "xmpp.ibb.close", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"xmpp ibb close", HFILL\r\n}},\r\n{ &hf_xmpp_ibb_data,\r\n{\r\n"IBB-DATA", "xmpp.ibb.data", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"xmpp ibb data", HFILL\r\n}},\r\n{ &hf_xmpp_muc_x,\r\n{\r\n"X MUC", "xmpp.muc-x", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"http://jabber.org/protocol/muc", HFILL\r\n}},\r\n{ &hf_xmpp_muc_user_x,\r\n{\r\n"X MUC-USER", "xmpp.muc-user-x", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"http://jabber.org/protocol/muc#user", HFILL\r\n}},\r\n{ &hf_xmpp_muc_user_item,\r\n{\r\n"ITEM", "xmpp.muc-user-x.item", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"muc#user item", HFILL\r\n}},\r\n{ &hf_xmpp_muc_user_invite,\r\n{\r\n"INVITE", "xmpp.muc-user-x.invite", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"muc#user invite", HFILL\r\n}},\r\n{ &hf_xmpp_gtalk_session,\r\n{\r\n"GTALK-SESSION", "xmpp.gtalk.session", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"GTalk session", HFILL\r\n}},\r\n{ &hf_xmpp_gtalk_session_type,\r\n{\r\n"type", "xmpp.gtalk.session.type", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"GTalk session type", HFILL\r\n}},\r\n{ &hf_xmpp_gtalk,\r\n{\r\n"GTALK SESSION", "xmpp.gtalk", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"GTalk SID", HFILL\r\n}},\r\n{ &hf_xmpp_gtalk_setting,\r\n{\r\n"USERSETTING", "xmpp.gtalk.setting", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"google:setting usersetting", HFILL\r\n}},\r\n{ &hf_xmpp_gtalk_setting_element,\r\n{\r\n"USERSETTING ELEMENT", "xmpp.gtalk.setting_element", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{ &hf_xmpp_gtalk_nosave_x,\r\n{\r\n"X-NOSAVE", "xmpp.gtalk.nosave.x", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"google:nosave x", HFILL\r\n}},\r\n{ &hf_xmpp_gtalk_mail_mailbox,\r\n{\r\n"MAILBOX", "xmpp.gtalk.mailbox", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"google:mail:notify mailbox", HFILL\r\n}},\r\n{ &hf_xmpp_gtalk_mail_new_mail,\r\n{\r\n"NEW MAIL", "xmpp.gtalk.new-mail", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"google:mail:notify new-mail", HFILL\r\n}},\r\n{ &hf_xmpp_gtalk_transport_p2p,\r\n{\r\n"TRANSPORT", "xmpp.gtalk.transport-p2p", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"google/transport/p2p", HFILL\r\n}},\r\n{ &hf_xmpp_gtalk_mail_snippet,\r\n{\r\n"SNIPPET", "xmpp.gtalk.mail_snippet", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{ &hf_xmpp_gtalk_status_status_list,\r\n{\r\n"STATUS", "xmpp.gtalk.status_status_list", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{ &hf_xmpp_conf_info,\r\n{\r\n"CONFERENCE INFO", "xmpp.conf-info", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"urn:ietf:params:xml:ns:conference-info", HFILL\r\n}},\r\n{ &hf_xmpp_conf_info_sid,\r\n{\r\n"sid", "xmpp.conf-info.sid", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"urn:ietf:params:xml:ns:conference-info sid", HFILL\r\n}},\r\n{ &hf_xmpp_response_in,\r\n{ "Response In", "xmpp.response_in",\r\nFT_FRAMENUM, BASE_NONE, NULL, 0x0,\r\n"The response to this request is in this frame", HFILL }\r\n},\r\n{ &hf_xmpp_response_to,\r\n{ "Request In", "xmpp.response_to",\r\nFT_FRAMENUM, BASE_NONE, NULL, 0x0,\r\n"This is a response to the request in this frame", HFILL }\r\n},\r\n{ &hf_xmpp_out,\r\n{\r\n"Out", "xmpp.out", FT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\n"Outgoing packet", HFILL\r\n}},\r\n{ &hf_xmpp_in,\r\n{\r\n"In", "xmpp.in", FT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\n"Ingoing packet", HFILL\r\n}},\r\n{ &hf_xmpp_ibb,\r\n{\r\n"IBB SESSION", "xmpp.ibb", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"In-Band Bytestreams session", HFILL\r\n}},\r\n{ &hf_xmpp_jingle_session,\r\n{\r\n"JINGLE SESSION", "xmpp.jingle_session", FT_STRING, BASE_NONE, NULL, 0x0,\r\n"Jingle SID", HFILL\r\n}},\r\n{ &hf_xmpp_ping,\r\n{\r\n"PING", "xmpp.ping", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"urn:xmpp:ping", HFILL\r\n}},\r\n{ &hf_xmpp_hashes,\r\n{\r\n"HASHES", "xmpp.hashes", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"urn:xmpp:hashes:0", HFILL\r\n}},\r\n{ &hf_xmpp_jitsi_inputevt,\r\n{\r\n"INPUTEVT", "xmpp.inputevt", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"http://jitsi.org/protocol/inputevt", HFILL\r\n}},\r\n{ &hf_xmpp_jitsi_inputevt_rmt_ctrl,\r\n{\r\n"REMOTE-CONTROL", "xmpp.inputevt.remote-control", FT_NONE, BASE_NONE, NULL, 0x0,\r\n"http://jitsi.org/protocol/inputevt remote-control", HFILL\r\n}},\r\n};\r\nstatic gint * ett[] = {\r\n&ett_xmpp,\r\n&ett_xmpp_iq,\r\n&ett_xmpp_query,\r\n&ett_xmpp_query_item,\r\n&ett_xmpp_query_identity,\r\n&ett_xmpp_query_feature,\r\n&ett_xmpp_query_streamhost,\r\n&ett_xmpp_query_streamhost_used,\r\n&ett_xmpp_query_udpsuccess,\r\n&ett_xmpp_iq_error,\r\n&ett_xmpp_iq_bind,\r\n&ett_xmpp_iq_session,\r\n&ett_xmpp_vcard,\r\n&ett_xmpp_vcard_x_update,\r\n&ett_xmpp_jingle,\r\n&ett_xmpp_jingle_content,\r\n&ett_xmpp_jingle_content_description,\r\n&ett_xmpp_jingle_cont_desc_payload,\r\n&ett_xmpp_jingle_cont_desc_payload_param,\r\n&ett_xmpp_jingle_cont_desc_enc,\r\n&ett_xmpp_jingle_cont_desc_enc_zrtp_hash,\r\n&ett_xmpp_jingle_cont_desc_enc_crypto,\r\n&ett_xmpp_jingle_cont_desc_bandwidth,\r\n&ett_xmpp_jingle_cont_desc_rtp_hdr,\r\n&ett_xmpp_jingle_cont_trans,\r\n&ett_xmpp_jingle_cont_trans_cand,\r\n&ett_xmpp_jingle_cont_trans_rem_cand,\r\n&ett_xmpp_jingle_reason,\r\n&ett_xmpp_jingle_rtp_info,\r\n&ett_xmpp_services,\r\n&ett_xmpp_services_relay,\r\n&ett_xmpp_channel,\r\n&ett_xmpp_si,\r\n&ett_xmpp_si_file,\r\n&ett_xmpp_si_file_range,\r\n&ett_xmpp_iq_feature_neg,\r\n&ett_xmpp_x_data,\r\n&ett_xmpp_x_data_field,\r\n&ett_xmpp_x_data_field_value,\r\n&ett_xmpp_ibb_open,\r\n&ett_xmpp_ibb_close,\r\n&ett_xmpp_ibb_data,\r\n&ett_xmpp_delay,\r\n&ett_xmpp_x_event,\r\n&ett_xmpp_message,\r\n&ett_xmpp_message_thread,\r\n&ett_xmpp_message_subject,\r\n&ett_xmpp_message_body,\r\n&ett_xmpp_presence,\r\n&ett_xmpp_presence_status,\r\n&ett_xmpp_presence_caps,\r\n&ett_xmpp_auth,\r\n&ett_xmpp_challenge,\r\n&ett_xmpp_response,\r\n&ett_xmpp_success,\r\n&ett_xmpp_failure,\r\n&ett_xmpp_muc_x,\r\n&ett_xmpp_muc_hist,\r\n&ett_xmpp_muc_user_x,\r\n&ett_xmpp_muc_user_item,\r\n&ett_xmpp_muc_user_invite,\r\n&ett_xmpp_gtalk_session,\r\n&ett_xmpp_gtalk_session_desc,\r\n&ett_xmpp_gtalk_session_desc_payload,\r\n&ett_xmpp_gtalk_session_cand,\r\n&ett_xmpp_gtalk_session_reason,\r\n&ett_xmpp_gtalk_jingleinfo_stun,\r\n&ett_xmpp_gtalk_jingleinfo_server,\r\n&ett_xmpp_gtalk_jingleinfo_relay,\r\n&ett_xmpp_gtalk_jingleinfo_relay_serv,\r\n&ett_xmpp_gtalk_setting,\r\n&ett_xmpp_gtalk_nosave_x,\r\n&ett_xmpp_gtalk_mail_mailbox,\r\n&ett_xmpp_gtalk_mail_mail_info,\r\n&ett_xmpp_gtalk_mail_senders,\r\n&ett_xmpp_gtalk_mail_sender,\r\n&ett_xmpp_gtalk_status_status_list,\r\n&ett_xmpp_conf_info,\r\n&ett_xmpp_conf_desc,\r\n&ett_xmpp_conf_state,\r\n&ett_xmpp_conf_users,\r\n&ett_xmpp_conf_user,\r\n&ett_xmpp_conf_endpoint,\r\n&ett_xmpp_conf_media,\r\n&ett_xmpp_gtalk_transport_p2p,\r\n&ett_xmpp_gtalk_transport_p2p_cand,\r\n&ett_xmpp_ping,\r\n&ett_xmpp_hashes_hash,\r\n&ett_xmpp_hashes,\r\n&ett_xmpp_jingle_file_transfer_offer,\r\n&ett_xmpp_jingle_file_transfer_request,\r\n&ett_xmpp_jingle_file_transfer_received,\r\n&ett_xmpp_jingle_file_transfer_abort,\r\n&ett_xmpp_jingle_file_transfer_checksum,\r\n&ett_xmpp_jingle_file_transfer_file,\r\n&ett_xmpp_jitsi_inputevt,\r\n&ett_xmpp_jitsi_inputevt_rmt_ctrl,\r\n&ett_xmpp_stream,\r\n&ett_xmpp_features,\r\n&ett_xmpp_features_mechanisms,\r\n&ett_xmpp_starttls,\r\n&ett_xmpp_proceed,\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_xmpp_xml_disabled, { "xmpp.xml_disabled", PI_UNDECODED, PI_WARN, "XML dissector disabled, can't dissect XMPP", EXPFILL }},\r\n{ &ei_xmpp_packet_unknown, { "xmpp.packet_unknown", PI_UNDECODED, PI_NOTE, "Unknown packet", EXPFILL }},\r\n{ &ei_xmpp_packet_without_response, { "xmpp.packet_without_response", PI_PROTOCOL, PI_CHAT, "Packet without response", EXPFILL }},\r\n{ &ei_xmpp_response, { "xmpp.response", PI_RESPONSE_CODE, PI_CHAT, "RESPONSE", EXPFILL }},\r\n{ &ei_xmpp_challenge, { "xmpp.challenge", PI_RESPONSE_CODE, PI_CHAT, "CHALLENGE", EXPFILL }},\r\n{ &ei_xmpp_success, { "xmpp.success", PI_RESPONSE_CODE, PI_CHAT, "SUCCESS", EXPFILL }},\r\n{ &ei_xmpp_starttls_already_in_frame, { "xmpp.starttls.already_in_frame", PI_PROTOCOL, PI_WARN, "Already saw STARTTLS in frame X", EXPFILL }},\r\n{ &ei_xmpp_starttls_missing, { "xmpp.starttls.missing", PI_PROTOCOL, PI_WARN, "Haven't seen a STARTTLS, did the capture start in the middle of a session?", EXPFILL }},\r\n{ &ei_xmpp_proceed_already_in_frame, { "xmpp.proceed.already_in_frame", PI_PROTOCOL, PI_WARN, "Already saw PROCEED in frame X", EXPFILL }},\r\n{ &ei_xmpp_unknown_element, { "xmpp.unknown.element", PI_UNDECODED, PI_NOTE, "Unknown element", EXPFILL }},\r\n{ &ei_xmpp_unknown_attribute, { "xmpp.unknown.attribute", PI_UNDECODED, PI_NOTE, "Unknown attribute", EXPFILL }},\r\n{ &ei_xmpp_required_attribute, { "xmpp.required_attribute", PI_PROTOCOL, PI_WARN, "Required attribute doesn't appear", EXPFILL }},\r\n{ &ei_xmpp_field_unexpected_value, { "xmpp.field.unexpected_value", PI_PROTOCOL, PI_WARN, "Field has unexpected value", EXPFILL }},\r\n};\r\nmodule_t *xmpp_module;\r\nexpert_module_t* expert_xmpp;\r\nstatic gint* ett_unknown_ptr[ETT_UNKNOWN_LEN];\r\ngint i;\r\nfor(i=0;i<ETT_UNKNOWN_LEN;i++)\r\n{\r\nett_unknown[i] = -1;\r\nett_unknown_ptr[i] = &ett_unknown[i];\r\n}\r\nproto_xmpp = proto_register_protocol(\r\n"XMPP Protocol",\r\n"XMPP",\r\n"xmpp"\r\n);\r\nxmpp_module = prefs_register_protocol(proto_xmpp, NULL);\r\nprefs_register_bool_preference(xmpp_module, "desegment",\r\n"Reassemble XMPP messages",\r\n"Whether the XMPP dissector should reassemble messages. "\r\n"To use this option, you must also enable"\r\n" \"Allow subdissectors to reassemble TCP streams\""\r\n" in the TCP protocol settings",\r\n&xmpp_desegment);\r\nproto_register_field_array(proto_xmpp, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nproto_register_subtree_array(ett_unknown_ptr, array_length(ett_unknown_ptr));\r\nexpert_xmpp = expert_register_protocol(proto_xmpp);\r\nexpert_register_field_array(expert_xmpp, ei, array_length(ei));\r\nxmpp_handle = register_dissector("xmpp", dissect_xmpp, proto_xmpp);\r\nxmpp_init_parsers();\r\n}\r\nvoid\r\nproto_reg_handoff_xmpp(void) {\r\nxml_handle = find_dissector_add_dependency("xml", proto_xmpp);\r\ndissector_add_uint("tcp.port", XMPP_PORT, xmpp_handle);\r\n}
