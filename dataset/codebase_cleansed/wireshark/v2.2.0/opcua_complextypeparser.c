void parseTrustListDataType(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_TrustListDataType, &ti, "%s: TrustListDataType", szFieldName);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_SpecifiedLists);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "TrustedCertificates", "ByteString", hf_opcua_TrustedCertificates, parseByteString, ett_opcua_array_ByteString);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "TrustedCrls", "ByteString", hf_opcua_TrustedCrls, parseByteString, ett_opcua_array_ByteString);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "IssuerCertificates", "ByteString", hf_opcua_IssuerCertificates, parseByteString, ett_opcua_array_ByteString);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "IssuerCrls", "ByteString", hf_opcua_IssuerCrls, parseByteString, ett_opcua_array_ByteString);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseNode(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_Node, &ti, "%s: Node", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "NodeId");\r\nparseNodeClass(subtree, tvb, pinfo, pOffset);\r\nparseQualifiedName(subtree, tvb, pinfo, pOffset, "BrowseName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "DisplayName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "Description");\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_WriteMask);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_UserWriteMask);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "References", "ReferenceNode", parseReferenceNode, ett_opcua_array_ReferenceNode);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseInstanceNode(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_InstanceNode, &ti, "%s: InstanceNode", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "NodeId");\r\nparseNodeClass(subtree, tvb, pinfo, pOffset);\r\nparseQualifiedName(subtree, tvb, pinfo, pOffset, "BrowseName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "DisplayName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "Description");\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_WriteMask);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_UserWriteMask);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "References", "ReferenceNode", parseReferenceNode, ett_opcua_array_ReferenceNode);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseTypeNode(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_TypeNode, &ti, "%s: TypeNode", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "NodeId");\r\nparseNodeClass(subtree, tvb, pinfo, pOffset);\r\nparseQualifiedName(subtree, tvb, pinfo, pOffset, "BrowseName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "DisplayName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "Description");\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_WriteMask);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_UserWriteMask);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "References", "ReferenceNode", parseReferenceNode, ett_opcua_array_ReferenceNode);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseObjectNode(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ObjectNode, &ti, "%s: ObjectNode", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "NodeId");\r\nparseNodeClass(subtree, tvb, pinfo, pOffset);\r\nparseQualifiedName(subtree, tvb, pinfo, pOffset, "BrowseName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "DisplayName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "Description");\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_WriteMask);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_UserWriteMask);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "References", "ReferenceNode", parseReferenceNode, ett_opcua_array_ReferenceNode);\r\nparseByte(subtree, tvb, pinfo, pOffset, hf_opcua_EventNotifier);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseObjectTypeNode(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ObjectTypeNode, &ti, "%s: ObjectTypeNode", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "NodeId");\r\nparseNodeClass(subtree, tvb, pinfo, pOffset);\r\nparseQualifiedName(subtree, tvb, pinfo, pOffset, "BrowseName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "DisplayName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "Description");\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_WriteMask);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_UserWriteMask);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "References", "ReferenceNode", parseReferenceNode, ett_opcua_array_ReferenceNode);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_IsAbstract);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseVariableNode(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_VariableNode, &ti, "%s: VariableNode", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "NodeId");\r\nparseNodeClass(subtree, tvb, pinfo, pOffset);\r\nparseQualifiedName(subtree, tvb, pinfo, pOffset, "BrowseName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "DisplayName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "Description");\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_WriteMask);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_UserWriteMask);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "References", "ReferenceNode", parseReferenceNode, ett_opcua_array_ReferenceNode);\r\nparseVariant(subtree, tvb, pinfo, pOffset, "Value");\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "DataType");\r\nparseInt32(subtree, tvb, pinfo, pOffset, hf_opcua_ValueRank);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "ArrayDimensions", "UInt32", hf_opcua_ArrayDimensions, parseUInt32, ett_opcua_array_UInt32);\r\nparseByte(subtree, tvb, pinfo, pOffset, hf_opcua_AccessLevel);\r\nparseByte(subtree, tvb, pinfo, pOffset, hf_opcua_UserAccessLevel);\r\nparseDouble(subtree, tvb, pinfo, pOffset, hf_opcua_MinimumSamplingInterval);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_Historizing);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseVariableTypeNode(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_VariableTypeNode, &ti, "%s: VariableTypeNode", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "NodeId");\r\nparseNodeClass(subtree, tvb, pinfo, pOffset);\r\nparseQualifiedName(subtree, tvb, pinfo, pOffset, "BrowseName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "DisplayName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "Description");\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_WriteMask);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_UserWriteMask);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "References", "ReferenceNode", parseReferenceNode, ett_opcua_array_ReferenceNode);\r\nparseVariant(subtree, tvb, pinfo, pOffset, "Value");\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "DataType");\r\nparseInt32(subtree, tvb, pinfo, pOffset, hf_opcua_ValueRank);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "ArrayDimensions", "UInt32", hf_opcua_ArrayDimensions, parseUInt32, ett_opcua_array_UInt32);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_IsAbstract);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseReferenceTypeNode(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ReferenceTypeNode, &ti, "%s: ReferenceTypeNode", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "NodeId");\r\nparseNodeClass(subtree, tvb, pinfo, pOffset);\r\nparseQualifiedName(subtree, tvb, pinfo, pOffset, "BrowseName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "DisplayName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "Description");\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_WriteMask);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_UserWriteMask);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "References", "ReferenceNode", parseReferenceNode, ett_opcua_array_ReferenceNode);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_IsAbstract);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_Symmetric);\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "InverseName");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseMethodNode(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_MethodNode, &ti, "%s: MethodNode", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "NodeId");\r\nparseNodeClass(subtree, tvb, pinfo, pOffset);\r\nparseQualifiedName(subtree, tvb, pinfo, pOffset, "BrowseName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "DisplayName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "Description");\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_WriteMask);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_UserWriteMask);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "References", "ReferenceNode", parseReferenceNode, ett_opcua_array_ReferenceNode);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_Executable);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_UserExecutable);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseViewNode(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ViewNode, &ti, "%s: ViewNode", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "NodeId");\r\nparseNodeClass(subtree, tvb, pinfo, pOffset);\r\nparseQualifiedName(subtree, tvb, pinfo, pOffset, "BrowseName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "DisplayName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "Description");\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_WriteMask);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_UserWriteMask);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "References", "ReferenceNode", parseReferenceNode, ett_opcua_array_ReferenceNode);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_ContainsNoLoops);\r\nparseByte(subtree, tvb, pinfo, pOffset, hf_opcua_EventNotifier);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseDataTypeNode(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_DataTypeNode, &ti, "%s: DataTypeNode", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "NodeId");\r\nparseNodeClass(subtree, tvb, pinfo, pOffset);\r\nparseQualifiedName(subtree, tvb, pinfo, pOffset, "BrowseName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "DisplayName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "Description");\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_WriteMask);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_UserWriteMask);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "References", "ReferenceNode", parseReferenceNode, ett_opcua_array_ReferenceNode);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_IsAbstract);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseReferenceNode(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ReferenceNode, &ti, "%s: ReferenceNode", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "ReferenceTypeId");\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_IsInverse);\r\nparseExpandedNodeId(subtree, tvb, pinfo, pOffset, "TargetId");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseArgument(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_Argument, &ti, "%s: Argument", szFieldName);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_Name);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "DataType");\r\nparseInt32(subtree, tvb, pinfo, pOffset, hf_opcua_ValueRank);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "ArrayDimensions", "UInt32", hf_opcua_ArrayDimensions, parseUInt32, ett_opcua_array_UInt32);\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "Description");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseEnumValueType(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_EnumValueType, &ti, "%s: EnumValueType", szFieldName);\r\nparseInt64(subtree, tvb, pinfo, pOffset, hf_opcua_Value);\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "DisplayName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "Description");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseOptionSet(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_OptionSet, &ti, "%s: OptionSet", szFieldName);\r\nparseByteString(subtree, tvb, pinfo, pOffset, hf_opcua_Value);\r\nparseByteString(subtree, tvb, pinfo, pOffset, hf_opcua_ValidBits);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseTimeZoneDataType(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_TimeZoneDataType, &ti, "%s: TimeZoneDataType", szFieldName);\r\nparseInt16(subtree, tvb, pinfo, pOffset, hf_opcua_Offset);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_DaylightSavingInOffset);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseApplicationDescription(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ApplicationDescription, &ti, "%s: ApplicationDescription", szFieldName);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_ApplicationUri);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_ProductUri);\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "ApplicationName");\r\nparseApplicationType(subtree, tvb, pinfo, pOffset);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_GatewayServerUri);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_DiscoveryProfileUri);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "DiscoveryUrls", "String", hf_opcua_DiscoveryUrls, parseString, ett_opcua_array_String);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseRequestHeader(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nstatic const int *returnDiagnostics_mask[] = {\r\n&hf_opcua_returnDiag_mask_sl_symbolicId,\r\n&hf_opcua_returnDiag_mask_sl_localizedText,\r\n&hf_opcua_returnDiag_mask_sl_additionalinfo,\r\n&hf_opcua_returnDiag_mask_sl_innerstatuscode,\r\n&hf_opcua_returnDiag_mask_sl_innerdiagnostics,\r\n&hf_opcua_returnDiag_mask_ol_symbolicId,\r\n&hf_opcua_returnDiag_mask_ol_localizedText,\r\n&hf_opcua_returnDiag_mask_ol_additionalinfo,\r\n&hf_opcua_returnDiag_mask_ol_innerstatuscode,\r\n&hf_opcua_returnDiag_mask_ol_innerdiagnostics,\r\nNULL};\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_RequestHeader, &ti, "%s: RequestHeader", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "AuthenticationToken");\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_Timestamp);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_RequestHandle);\r\nproto_tree_add_bitmask(subtree, tvb, *pOffset, hf_opcua_returnDiag, ett_opcua_returnDiagnostics, returnDiagnostics_mask, ENC_LITTLE_ENDIAN); *pOffset += 4;\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_AuditEntryId);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_TimeoutHint);\r\nparseExtensionObject(subtree, tvb, pinfo, pOffset, "AdditionalHeader");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseResponseHeader(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ResponseHeader, &ti, "%s: ResponseHeader", szFieldName);\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_Timestamp);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_RequestHandle);\r\nparseStatusCode(subtree, tvb, pinfo, pOffset, hf_opcua_ServiceResult);\r\nparseDiagnosticInfo(subtree, tvb, pinfo, pOffset, "ServiceDiagnostics");\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "StringTable", "String", hf_opcua_StringTable, parseString, ett_opcua_array_String);\r\nparseExtensionObject(subtree, tvb, pinfo, pOffset, "AdditionalHeader");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseServerOnNetwork(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ServerOnNetwork, &ti, "%s: ServerOnNetwork", szFieldName);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_RecordId);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_ServerName);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_DiscoveryUrl);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "ServerCapabilities", "String", hf_opcua_ServerCapabilities, parseString, ett_opcua_array_String);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseUserTokenPolicy(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_UserTokenPolicy, &ti, "%s: UserTokenPolicy", szFieldName);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_PolicyId);\r\nparseUserTokenType(subtree, tvb, pinfo, pOffset);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_IssuedTokenType);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_IssuerEndpointUrl);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_SecurityPolicyUri);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseEndpointDescription(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_EndpointDescription, &ti, "%s: EndpointDescription", szFieldName);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_EndpointUrl);\r\nparseApplicationDescription(subtree, tvb, pinfo, pOffset, "Server");\r\nparseByteString(subtree, tvb, pinfo, pOffset, hf_opcua_ServerCertificate);\r\nparseMessageSecurityMode(subtree, tvb, pinfo, pOffset);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_SecurityPolicyUri);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "UserIdentityTokens", "UserTokenPolicy", parseUserTokenPolicy, ett_opcua_array_UserTokenPolicy);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_TransportProfileUri);\r\nparseByte(subtree, tvb, pinfo, pOffset, hf_opcua_SecurityLevel);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseRegisteredServer(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_RegisteredServer, &ti, "%s: RegisteredServer", szFieldName);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_ServerUri);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_ProductUri);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "ServerNames", "LocalizedText", parseLocalizedText, ett_opcua_array_LocalizedText);\r\nparseApplicationType(subtree, tvb, pinfo, pOffset);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_GatewayServerUri);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "DiscoveryUrls", "String", hf_opcua_DiscoveryUrls, parseString, ett_opcua_array_String);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_SemaphoreFilePath);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_IsOnline);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseMdnsDiscoveryConfiguration(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_MdnsDiscoveryConfiguration, &ti, "%s: MdnsDiscoveryConfiguration", szFieldName);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_MdnsServerName);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "ServerCapabilities", "String", hf_opcua_ServerCapabilities, parseString, ett_opcua_array_String);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseChannelSecurityToken(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ChannelSecurityToken, &ti, "%s: ChannelSecurityToken", szFieldName);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_ChannelId);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_TokenId);\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_CreatedAt);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_RevisedLifetime);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseSignedSoftwareCertificate(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_SignedSoftwareCertificate, &ti, "%s: SignedSoftwareCertificate", szFieldName);\r\nparseByteString(subtree, tvb, pinfo, pOffset, hf_opcua_CertificateData);\r\nparseByteString(subtree, tvb, pinfo, pOffset, hf_opcua_Signature);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseSignatureData(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_SignatureData, &ti, "%s: SignatureData", szFieldName);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_Algorithm);\r\nparseByteString(subtree, tvb, pinfo, pOffset, hf_opcua_Signature);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseUserIdentityToken(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_UserIdentityToken, &ti, "%s: UserIdentityToken", szFieldName);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_PolicyId);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseAnonymousIdentityToken(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_AnonymousIdentityToken, &ti, "%s: AnonymousIdentityToken", szFieldName);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_PolicyId);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseUserNameIdentityToken(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_UserNameIdentityToken, &ti, "%s: UserNameIdentityToken", szFieldName);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_PolicyId);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_UserName);\r\nparseByteString(subtree, tvb, pinfo, pOffset, hf_opcua_Password);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_EncryptionAlgorithm);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseX509IdentityToken(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_X509IdentityToken, &ti, "%s: X509IdentityToken", szFieldName);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_PolicyId);\r\nparseByteString(subtree, tvb, pinfo, pOffset, hf_opcua_CertificateData);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseKerberosIdentityToken(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_KerberosIdentityToken, &ti, "%s: KerberosIdentityToken", szFieldName);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_PolicyId);\r\nparseByteString(subtree, tvb, pinfo, pOffset, hf_opcua_TicketData);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseIssuedIdentityToken(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_IssuedIdentityToken, &ti, "%s: IssuedIdentityToken", szFieldName);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_PolicyId);\r\nparseByteString(subtree, tvb, pinfo, pOffset, hf_opcua_TokenData);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_EncryptionAlgorithm);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseNodeAttributes(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_NodeAttributes, &ti, "%s: NodeAttributes", szFieldName);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_SpecifiedAttributes);\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "DisplayName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "Description");\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_WriteMask);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_UserWriteMask);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseObjectAttributes(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ObjectAttributes, &ti, "%s: ObjectAttributes", szFieldName);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_SpecifiedAttributes);\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "DisplayName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "Description");\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_WriteMask);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_UserWriteMask);\r\nparseByte(subtree, tvb, pinfo, pOffset, hf_opcua_EventNotifier);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseVariableAttributes(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_VariableAttributes, &ti, "%s: VariableAttributes", szFieldName);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_SpecifiedAttributes);\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "DisplayName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "Description");\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_WriteMask);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_UserWriteMask);\r\nparseVariant(subtree, tvb, pinfo, pOffset, "Value");\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "DataType");\r\nparseInt32(subtree, tvb, pinfo, pOffset, hf_opcua_ValueRank);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "ArrayDimensions", "UInt32", hf_opcua_ArrayDimensions, parseUInt32, ett_opcua_array_UInt32);\r\nparseByte(subtree, tvb, pinfo, pOffset, hf_opcua_AccessLevel);\r\nparseByte(subtree, tvb, pinfo, pOffset, hf_opcua_UserAccessLevel);\r\nparseDouble(subtree, tvb, pinfo, pOffset, hf_opcua_MinimumSamplingInterval);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_Historizing);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseMethodAttributes(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_MethodAttributes, &ti, "%s: MethodAttributes", szFieldName);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_SpecifiedAttributes);\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "DisplayName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "Description");\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_WriteMask);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_UserWriteMask);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_Executable);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_UserExecutable);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseObjectTypeAttributes(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ObjectTypeAttributes, &ti, "%s: ObjectTypeAttributes", szFieldName);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_SpecifiedAttributes);\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "DisplayName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "Description");\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_WriteMask);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_UserWriteMask);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_IsAbstract);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseVariableTypeAttributes(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_VariableTypeAttributes, &ti, "%s: VariableTypeAttributes", szFieldName);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_SpecifiedAttributes);\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "DisplayName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "Description");\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_WriteMask);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_UserWriteMask);\r\nparseVariant(subtree, tvb, pinfo, pOffset, "Value");\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "DataType");\r\nparseInt32(subtree, tvb, pinfo, pOffset, hf_opcua_ValueRank);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "ArrayDimensions", "UInt32", hf_opcua_ArrayDimensions, parseUInt32, ett_opcua_array_UInt32);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_IsAbstract);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseReferenceTypeAttributes(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ReferenceTypeAttributes, &ti, "%s: ReferenceTypeAttributes", szFieldName);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_SpecifiedAttributes);\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "DisplayName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "Description");\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_WriteMask);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_UserWriteMask);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_IsAbstract);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_Symmetric);\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "InverseName");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseDataTypeAttributes(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_DataTypeAttributes, &ti, "%s: DataTypeAttributes", szFieldName);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_SpecifiedAttributes);\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "DisplayName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "Description");\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_WriteMask);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_UserWriteMask);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_IsAbstract);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseViewAttributes(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ViewAttributes, &ti, "%s: ViewAttributes", szFieldName);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_SpecifiedAttributes);\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "DisplayName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "Description");\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_WriteMask);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_UserWriteMask);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_ContainsNoLoops);\r\nparseByte(subtree, tvb, pinfo, pOffset, hf_opcua_EventNotifier);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseAddNodesItem(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_AddNodesItem, &ti, "%s: AddNodesItem", szFieldName);\r\nparseExpandedNodeId(subtree, tvb, pinfo, pOffset, "ParentNodeId");\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "ReferenceTypeId");\r\nparseExpandedNodeId(subtree, tvb, pinfo, pOffset, "RequestedNewNodeId");\r\nparseQualifiedName(subtree, tvb, pinfo, pOffset, "BrowseName");\r\nparseNodeClass(subtree, tvb, pinfo, pOffset);\r\nparseExtensionObject(subtree, tvb, pinfo, pOffset, "NodeAttributes");\r\nparseExpandedNodeId(subtree, tvb, pinfo, pOffset, "TypeDefinition");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseAddNodesResult(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_AddNodesResult, &ti, "%s: AddNodesResult", szFieldName);\r\nparseStatusCode(subtree, tvb, pinfo, pOffset, hf_opcua_StatusCode);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "AddedNodeId");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseAddReferencesItem(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_AddReferencesItem, &ti, "%s: AddReferencesItem", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "SourceNodeId");\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "ReferenceTypeId");\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_IsForward);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_TargetServerUri);\r\nparseExpandedNodeId(subtree, tvb, pinfo, pOffset, "TargetNodeId");\r\nparseNodeClass(subtree, tvb, pinfo, pOffset);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseDeleteNodesItem(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_DeleteNodesItem, &ti, "%s: DeleteNodesItem", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "NodeId");\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_DeleteTargetReferences);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseDeleteReferencesItem(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_DeleteReferencesItem, &ti, "%s: DeleteReferencesItem", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "SourceNodeId");\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "ReferenceTypeId");\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_IsForward);\r\nparseExpandedNodeId(subtree, tvb, pinfo, pOffset, "TargetNodeId");\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_DeleteBidirectional);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseViewDescription(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ViewDescription, &ti, "%s: ViewDescription", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "ViewId");\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_Timestamp);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_ViewVersion);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseBrowseDescription(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_BrowseDescription, &ti, "%s: BrowseDescription", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "NodeId");\r\nparseBrowseDirection(subtree, tvb, pinfo, pOffset);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "ReferenceTypeId");\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_IncludeSubtypes);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_NodeClassMask);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_ResultMask);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseReferenceDescription(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ReferenceDescription, &ti, "%s: ReferenceDescription", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "ReferenceTypeId");\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_IsForward);\r\nparseExpandedNodeId(subtree, tvb, pinfo, pOffset, "NodeId");\r\nparseQualifiedName(subtree, tvb, pinfo, pOffset, "BrowseName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "DisplayName");\r\nparseNodeClass(subtree, tvb, pinfo, pOffset);\r\nparseExpandedNodeId(subtree, tvb, pinfo, pOffset, "TypeDefinition");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseBrowseResult(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_BrowseResult, &ti, "%s: BrowseResult", szFieldName);\r\nparseStatusCode(subtree, tvb, pinfo, pOffset, hf_opcua_StatusCode);\r\nparseByteString(subtree, tvb, pinfo, pOffset, hf_opcua_ContinuationPoint);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "References", "ReferenceDescription", parseReferenceDescription, ett_opcua_array_ReferenceDescription);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseRelativePathElement(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_RelativePathElement, &ti, "%s: RelativePathElement", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "ReferenceTypeId");\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_IsInverse);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_IncludeSubtypes);\r\nparseQualifiedName(subtree, tvb, pinfo, pOffset, "TargetName");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseRelativePath(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_RelativePath, &ti, "%s: RelativePath", szFieldName);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "Elements", "RelativePathElement", parseRelativePathElement, ett_opcua_array_RelativePathElement);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseBrowsePath(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_BrowsePath, &ti, "%s: BrowsePath", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "StartingNode");\r\nparseRelativePath(subtree, tvb, pinfo, pOffset, "RelativePath");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseBrowsePathTarget(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_BrowsePathTarget, &ti, "%s: BrowsePathTarget", szFieldName);\r\nparseExpandedNodeId(subtree, tvb, pinfo, pOffset, "TargetId");\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_RemainingPathIndex);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseBrowsePathResult(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_BrowsePathResult, &ti, "%s: BrowsePathResult", szFieldName);\r\nparseStatusCode(subtree, tvb, pinfo, pOffset, hf_opcua_StatusCode);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "Targets", "BrowsePathTarget", parseBrowsePathTarget, ett_opcua_array_BrowsePathTarget);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseEndpointConfiguration(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_EndpointConfiguration, &ti, "%s: EndpointConfiguration", szFieldName);\r\nparseInt32(subtree, tvb, pinfo, pOffset, hf_opcua_OperationTimeout);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_UseBinaryEncoding);\r\nparseInt32(subtree, tvb, pinfo, pOffset, hf_opcua_MaxStringLength);\r\nparseInt32(subtree, tvb, pinfo, pOffset, hf_opcua_MaxByteStringLength);\r\nparseInt32(subtree, tvb, pinfo, pOffset, hf_opcua_MaxArrayLength);\r\nparseInt32(subtree, tvb, pinfo, pOffset, hf_opcua_MaxMessageSize);\r\nparseInt32(subtree, tvb, pinfo, pOffset, hf_opcua_MaxBufferSize);\r\nparseInt32(subtree, tvb, pinfo, pOffset, hf_opcua_ChannelLifetime);\r\nparseInt32(subtree, tvb, pinfo, pOffset, hf_opcua_SecurityTokenLifetime);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseSupportedProfile(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_SupportedProfile, &ti, "%s: SupportedProfile", szFieldName);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_OrganizationUri);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_ProfileId);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_ComplianceTool);\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_ComplianceDate);\r\nparseComplianceLevel(subtree, tvb, pinfo, pOffset);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "UnsupportedUnitIds", "String", hf_opcua_UnsupportedUnitIds, parseString, ett_opcua_array_String);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseSoftwareCertificate(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_SoftwareCertificate, &ti, "%s: SoftwareCertificate", szFieldName);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_ProductName);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_ProductUri);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_VendorName);\r\nparseByteString(subtree, tvb, pinfo, pOffset, hf_opcua_VendorProductCertificate);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_SoftwareVersion);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_BuildNumber);\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_BuildDate);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_IssuedBy);\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_IssueDate);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "SupportedProfiles", "SupportedProfile", parseSupportedProfile, ett_opcua_array_SupportedProfile);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseQueryDataDescription(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_QueryDataDescription, &ti, "%s: QueryDataDescription", szFieldName);\r\nparseRelativePath(subtree, tvb, pinfo, pOffset, "RelativePath");\r\nparseAttributeId(subtree, tvb, pinfo, pOffset);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_IndexRange);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseNodeTypeDescription(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_NodeTypeDescription, &ti, "%s: NodeTypeDescription", szFieldName);\r\nparseExpandedNodeId(subtree, tvb, pinfo, pOffset, "TypeDefinitionNode");\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_IncludeSubTypes);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "DataToReturn", "QueryDataDescription", parseQueryDataDescription, ett_opcua_array_QueryDataDescription);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseQueryDataSet(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_QueryDataSet, &ti, "%s: QueryDataSet", szFieldName);\r\nparseExpandedNodeId(subtree, tvb, pinfo, pOffset, "NodeId");\r\nparseExpandedNodeId(subtree, tvb, pinfo, pOffset, "TypeDefinitionNode");\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "Values", "Variant", parseVariant, ett_opcua_array_Variant);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseNodeReference(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_NodeReference, &ti, "%s: NodeReference", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "NodeId");\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "ReferenceTypeId");\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_IsForward);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "ReferencedNodeIds", "NodeId", parseNodeId, ett_opcua_array_NodeId);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseContentFilterElement(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ContentFilterElement, &ti, "%s: ContentFilterElement", szFieldName);\r\nparseFilterOperator(subtree, tvb, pinfo, pOffset);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "FilterOperands", "ExtensionObject", parseExtensionObject, ett_opcua_array_ExtensionObject);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseContentFilter(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ContentFilter, &ti, "%s: ContentFilter", szFieldName);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "Elements", "ContentFilterElement", parseContentFilterElement, ett_opcua_array_ContentFilterElement);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseElementOperand(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ElementOperand, &ti, "%s: ElementOperand", szFieldName);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_Index);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseLiteralOperand(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_LiteralOperand, &ti, "%s: LiteralOperand", szFieldName);\r\nparseVariant(subtree, tvb, pinfo, pOffset, "Value");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseAttributeOperand(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_AttributeOperand, &ti, "%s: AttributeOperand", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "NodeId");\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_Alias);\r\nparseRelativePath(subtree, tvb, pinfo, pOffset, "BrowsePath");\r\nparseAttributeId(subtree, tvb, pinfo, pOffset);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_IndexRange);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseSimpleAttributeOperand(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_SimpleAttributeOperand, &ti, "%s: SimpleAttributeOperand", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "TypeDefinitionId");\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "BrowsePath", "QualifiedName", parseQualifiedName, ett_opcua_array_QualifiedName);\r\nparseAttributeId(subtree, tvb, pinfo, pOffset);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_IndexRange);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseContentFilterElementResult(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ContentFilterElementResult, &ti, "%s: ContentFilterElementResult", szFieldName);\r\nparseStatusCode(subtree, tvb, pinfo, pOffset, hf_opcua_StatusCode);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "OperandStatusCodes", "StatusCode", hf_opcua_OperandStatusCodes, parseStatusCode, ett_opcua_array_StatusCode);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "OperandDiagnosticInfos", "DiagnosticInfo", parseDiagnosticInfo, ett_opcua_array_DiagnosticInfo);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseContentFilterResult(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ContentFilterResult, &ti, "%s: ContentFilterResult", szFieldName);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "ElementResults", "ContentFilterElementResult", parseContentFilterElementResult, ett_opcua_array_ContentFilterElementResult);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "ElementDiagnosticInfos", "DiagnosticInfo", parseDiagnosticInfo, ett_opcua_array_DiagnosticInfo);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseParsingResult(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ParsingResult, &ti, "%s: ParsingResult", szFieldName);\r\nparseStatusCode(subtree, tvb, pinfo, pOffset, hf_opcua_StatusCode);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "DataStatusCodes", "StatusCode", hf_opcua_DataStatusCodes, parseStatusCode, ett_opcua_array_StatusCode);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "DataDiagnosticInfos", "DiagnosticInfo", parseDiagnosticInfo, ett_opcua_array_DiagnosticInfo);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseReadValueId(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ReadValueId, &ti, "%s: ReadValueId", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "NodeId");\r\nparseAttributeId(subtree, tvb, pinfo, pOffset);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_IndexRange);\r\nparseQualifiedName(subtree, tvb, pinfo, pOffset, "DataEncoding");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseHistoryReadValueId(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_HistoryReadValueId, &ti, "%s: HistoryReadValueId", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "NodeId");\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_IndexRange);\r\nparseQualifiedName(subtree, tvb, pinfo, pOffset, "DataEncoding");\r\nparseByteString(subtree, tvb, pinfo, pOffset, hf_opcua_ContinuationPoint);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseHistoryReadResult(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_HistoryReadResult, &ti, "%s: HistoryReadResult", szFieldName);\r\nparseStatusCode(subtree, tvb, pinfo, pOffset, hf_opcua_StatusCode);\r\nparseByteString(subtree, tvb, pinfo, pOffset, hf_opcua_ContinuationPoint);\r\nparseExtensionObject(subtree, tvb, pinfo, pOffset, "HistoryData");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseReadEventDetails(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ReadEventDetails, &ti, "%s: ReadEventDetails", szFieldName);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_NumValuesPerNode);\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_StartTime);\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_EndTime);\r\nparseEventFilter(subtree, tvb, pinfo, pOffset, "Filter");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseReadRawModifiedDetails(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ReadRawModifiedDetails, &ti, "%s: ReadRawModifiedDetails", szFieldName);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_IsReadModified);\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_StartTime);\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_EndTime);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_NumValuesPerNode);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_ReturnBounds);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseReadProcessedDetails(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ReadProcessedDetails, &ti, "%s: ReadProcessedDetails", szFieldName);\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_StartTime);\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_EndTime);\r\nparseDouble(subtree, tvb, pinfo, pOffset, hf_opcua_ProcessingInterval);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "AggregateType", "NodeId", parseNodeId, ett_opcua_array_NodeId);\r\nparseAggregateConfiguration(subtree, tvb, pinfo, pOffset, "AggregateConfiguration");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseReadAtTimeDetails(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ReadAtTimeDetails, &ti, "%s: ReadAtTimeDetails", szFieldName);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "ReqTimes", "DateTime", hf_opcua_ReqTimes, parseDateTime, ett_opcua_array_DateTime);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_UseSimpleBounds);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseHistoryData(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_HistoryData, &ti, "%s: HistoryData", szFieldName);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "DataValues", "DataValue", parseDataValue, ett_opcua_array_DataValue);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseModificationInfo(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ModificationInfo, &ti, "%s: ModificationInfo", szFieldName);\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_ModificationTime);\r\nparseHistoryUpdateType(subtree, tvb, pinfo, pOffset);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_UserName);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseHistoryModifiedData(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_HistoryModifiedData, &ti, "%s: HistoryModifiedData", szFieldName);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "DataValues", "DataValue", parseDataValue, ett_opcua_array_DataValue);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "ModificationInfos", "ModificationInfo", parseModificationInfo, ett_opcua_array_ModificationInfo);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseHistoryEvent(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_HistoryEvent, &ti, "%s: HistoryEvent", szFieldName);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "Events", "HistoryEventFieldList", parseHistoryEventFieldList, ett_opcua_array_HistoryEventFieldList);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseWriteValue(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_WriteValue, &ti, "%s: WriteValue", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "NodeId");\r\nparseAttributeId(subtree, tvb, pinfo, pOffset);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_IndexRange);\r\nparseDataValue(subtree, tvb, pinfo, pOffset, "Value");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseHistoryUpdateDetails(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_HistoryUpdateDetails, &ti, "%s: HistoryUpdateDetails", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "NodeId");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseUpdateDataDetails(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_UpdateDataDetails, &ti, "%s: UpdateDataDetails", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "NodeId");\r\nparsePerformUpdateType(subtree, tvb, pinfo, pOffset);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "UpdateValues", "DataValue", parseDataValue, ett_opcua_array_DataValue);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseUpdateStructureDataDetails(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_UpdateStructureDataDetails, &ti, "%s: UpdateStructureDataDetails", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "NodeId");\r\nparsePerformUpdateType(subtree, tvb, pinfo, pOffset);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "UpdateValues", "DataValue", parseDataValue, ett_opcua_array_DataValue);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseUpdateEventDetails(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_UpdateEventDetails, &ti, "%s: UpdateEventDetails", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "NodeId");\r\nparsePerformUpdateType(subtree, tvb, pinfo, pOffset);\r\nparseEventFilter(subtree, tvb, pinfo, pOffset, "Filter");\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "EventData", "HistoryEventFieldList", parseHistoryEventFieldList, ett_opcua_array_HistoryEventFieldList);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseDeleteRawModifiedDetails(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_DeleteRawModifiedDetails, &ti, "%s: DeleteRawModifiedDetails", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "NodeId");\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_IsDeleteModified);\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_StartTime);\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_EndTime);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseDeleteAtTimeDetails(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_DeleteAtTimeDetails, &ti, "%s: DeleteAtTimeDetails", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "NodeId");\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "ReqTimes", "DateTime", hf_opcua_ReqTimes, parseDateTime, ett_opcua_array_DateTime);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseDeleteEventDetails(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_DeleteEventDetails, &ti, "%s: DeleteEventDetails", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "NodeId");\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "EventIds", "ByteString", hf_opcua_EventIds, parseByteString, ett_opcua_array_ByteString);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseHistoryUpdateResult(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_HistoryUpdateResult, &ti, "%s: HistoryUpdateResult", szFieldName);\r\nparseStatusCode(subtree, tvb, pinfo, pOffset, hf_opcua_StatusCode);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "OperationResults", "StatusCode", hf_opcua_OperationResults, parseStatusCode, ett_opcua_array_StatusCode);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "DiagnosticInfos", "DiagnosticInfo", parseDiagnosticInfo, ett_opcua_array_DiagnosticInfo);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseCallMethodRequest(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_CallMethodRequest, &ti, "%s: CallMethodRequest", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "ObjectId");\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "MethodId");\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "InputArguments", "Variant", parseVariant, ett_opcua_array_Variant);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseCallMethodResult(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_CallMethodResult, &ti, "%s: CallMethodResult", szFieldName);\r\nparseStatusCode(subtree, tvb, pinfo, pOffset, hf_opcua_StatusCode);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "InputArgumentResults", "StatusCode", hf_opcua_InputArgumentResults, parseStatusCode, ett_opcua_array_StatusCode);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "InputArgumentDiagnosticInfos", "DiagnosticInfo", parseDiagnosticInfo, ett_opcua_array_DiagnosticInfo);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "OutputArguments", "Variant", parseVariant, ett_opcua_array_Variant);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseDataChangeFilter(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_DataChangeFilter, &ti, "%s: DataChangeFilter", szFieldName);\r\nparseDataChangeTrigger(subtree, tvb, pinfo, pOffset);\r\nparseDeadbandType(subtree, tvb, pinfo, pOffset);\r\nparseDouble(subtree, tvb, pinfo, pOffset, hf_opcua_DeadbandValue);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseEventFilter(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_EventFilter, &ti, "%s: EventFilter", szFieldName);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "SelectClauses", "SimpleAttributeOperand", parseSimpleAttributeOperand, ett_opcua_array_SimpleAttributeOperand);\r\nparseContentFilter(subtree, tvb, pinfo, pOffset, "WhereClause");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseAggregateConfiguration(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_AggregateConfiguration, &ti, "%s: AggregateConfiguration", szFieldName);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_UseServerCapabilitiesDefaults);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_TreatUncertainAsBad);\r\nparseByte(subtree, tvb, pinfo, pOffset, hf_opcua_PercentDataBad);\r\nparseByte(subtree, tvb, pinfo, pOffset, hf_opcua_PercentDataGood);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_UseSlopedExtrapolation);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseAggregateFilter(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_AggregateFilter, &ti, "%s: AggregateFilter", szFieldName);\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_StartTime);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "AggregateType");\r\nparseDouble(subtree, tvb, pinfo, pOffset, hf_opcua_ProcessingInterval);\r\nparseAggregateConfiguration(subtree, tvb, pinfo, pOffset, "AggregateConfiguration");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseEventFilterResult(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_EventFilterResult, &ti, "%s: EventFilterResult", szFieldName);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "SelectClauseResults", "StatusCode", hf_opcua_SelectClauseResults, parseStatusCode, ett_opcua_array_StatusCode);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "SelectClauseDiagnosticInfos", "DiagnosticInfo", parseDiagnosticInfo, ett_opcua_array_DiagnosticInfo);\r\nparseContentFilterResult(subtree, tvb, pinfo, pOffset, "WhereClauseResult");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseAggregateFilterResult(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_AggregateFilterResult, &ti, "%s: AggregateFilterResult", szFieldName);\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_RevisedStartTime);\r\nparseDouble(subtree, tvb, pinfo, pOffset, hf_opcua_RevisedProcessingInterval);\r\nparseAggregateConfiguration(subtree, tvb, pinfo, pOffset, "RevisedAggregateConfiguration");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseMonitoringParameters(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_MonitoringParameters, &ti, "%s: MonitoringParameters", szFieldName);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_ClientHandle);\r\nparseDouble(subtree, tvb, pinfo, pOffset, hf_opcua_SamplingInterval);\r\nparseExtensionObject(subtree, tvb, pinfo, pOffset, "Filter");\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_QueueSize);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_DiscardOldest);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseMonitoredItemCreateRequest(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_MonitoredItemCreateRequest, &ti, "%s: MonitoredItemCreateRequest", szFieldName);\r\nparseReadValueId(subtree, tvb, pinfo, pOffset, "ItemToMonitor");\r\nparseMonitoringMode(subtree, tvb, pinfo, pOffset);\r\nparseMonitoringParameters(subtree, tvb, pinfo, pOffset, "RequestedParameters");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseMonitoredItemCreateResult(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_MonitoredItemCreateResult, &ti, "%s: MonitoredItemCreateResult", szFieldName);\r\nparseStatusCode(subtree, tvb, pinfo, pOffset, hf_opcua_StatusCode);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_MonitoredItemId);\r\nparseDouble(subtree, tvb, pinfo, pOffset, hf_opcua_RevisedSamplingInterval);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_RevisedQueueSize);\r\nparseExtensionObject(subtree, tvb, pinfo, pOffset, "FilterResult");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseMonitoredItemModifyRequest(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_MonitoredItemModifyRequest, &ti, "%s: MonitoredItemModifyRequest", szFieldName);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_MonitoredItemId);\r\nparseMonitoringParameters(subtree, tvb, pinfo, pOffset, "RequestedParameters");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseMonitoredItemModifyResult(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_MonitoredItemModifyResult, &ti, "%s: MonitoredItemModifyResult", szFieldName);\r\nparseStatusCode(subtree, tvb, pinfo, pOffset, hf_opcua_StatusCode);\r\nparseDouble(subtree, tvb, pinfo, pOffset, hf_opcua_RevisedSamplingInterval);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_RevisedQueueSize);\r\nparseExtensionObject(subtree, tvb, pinfo, pOffset, "FilterResult");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseNotificationMessage(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_NotificationMessage, &ti, "%s: NotificationMessage", szFieldName);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_SequenceNumber);\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_PublishTime);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "NotificationData", "ExtensionObject", parseExtensionObject, ett_opcua_array_ExtensionObject);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseDataChangeNotification(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_DataChangeNotification, &ti, "%s: DataChangeNotification", szFieldName);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "MonitoredItems", "MonitoredItemNotification", parseMonitoredItemNotification, ett_opcua_array_MonitoredItemNotification);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "DiagnosticInfos", "DiagnosticInfo", parseDiagnosticInfo, ett_opcua_array_DiagnosticInfo);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseMonitoredItemNotification(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_MonitoredItemNotification, &ti, "%s: MonitoredItemNotification", szFieldName);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_ClientHandle);\r\nparseDataValue(subtree, tvb, pinfo, pOffset, "Value");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseEventNotificationList(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_EventNotificationList, &ti, "%s: EventNotificationList", szFieldName);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "Events", "EventFieldList", parseEventFieldList, ett_opcua_array_EventFieldList);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseEventFieldList(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_EventFieldList, &ti, "%s: EventFieldList", szFieldName);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_ClientHandle);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "EventFields", "Variant", parseVariant, ett_opcua_array_Variant);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseHistoryEventFieldList(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_HistoryEventFieldList, &ti, "%s: HistoryEventFieldList", szFieldName);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "EventFields", "Variant", parseVariant, ett_opcua_array_Variant);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseStatusChangeNotification(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_StatusChangeNotification, &ti, "%s: StatusChangeNotification", szFieldName);\r\nparseStatusCode(subtree, tvb, pinfo, pOffset, hf_opcua_Status);\r\nparseDiagnosticInfo(subtree, tvb, pinfo, pOffset, "DiagnosticInfo");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseSubscriptionAcknowledgement(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_SubscriptionAcknowledgement, &ti, "%s: SubscriptionAcknowledgement", szFieldName);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_SubscriptionId);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_SequenceNumber);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseTransferResult(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_TransferResult, &ti, "%s: TransferResult", szFieldName);\r\nparseStatusCode(subtree, tvb, pinfo, pOffset, hf_opcua_StatusCode);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "AvailableSequenceNumbers", "UInt32", hf_opcua_AvailableSequenceNumbers, parseUInt32, ett_opcua_array_UInt32);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseScalarTestType(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ScalarTestType, &ti, "%s: ScalarTestType", szFieldName);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_Boolean);\r\nparseSByte(subtree, tvb, pinfo, pOffset, hf_opcua_SByte);\r\nparseByte(subtree, tvb, pinfo, pOffset, hf_opcua_Byte);\r\nparseInt16(subtree, tvb, pinfo, pOffset, hf_opcua_Int16);\r\nparseUInt16(subtree, tvb, pinfo, pOffset, hf_opcua_UInt16);\r\nparseInt32(subtree, tvb, pinfo, pOffset, hf_opcua_Int32);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_UInt32);\r\nparseInt64(subtree, tvb, pinfo, pOffset, hf_opcua_Int64);\r\nparseUInt64(subtree, tvb, pinfo, pOffset, hf_opcua_UInt64);\r\nparseFloat(subtree, tvb, pinfo, pOffset, hf_opcua_Float);\r\nparseDouble(subtree, tvb, pinfo, pOffset, hf_opcua_Double);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_String);\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_DateTime);\r\nparseGuid(subtree, tvb, pinfo, pOffset, hf_opcua_Guid);\r\nparseByteString(subtree, tvb, pinfo, pOffset, hf_opcua_ByteString);\r\nparseXmlElement(subtree, tvb, pinfo, pOffset, hf_opcua_XmlElement);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "NodeId");\r\nparseExpandedNodeId(subtree, tvb, pinfo, pOffset, "ExpandedNodeId");\r\nparseStatusCode(subtree, tvb, pinfo, pOffset, hf_opcua_StatusCode);\r\nparseDiagnosticInfo(subtree, tvb, pinfo, pOffset, "DiagnosticInfo");\r\nparseQualifiedName(subtree, tvb, pinfo, pOffset, "QualifiedName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "LocalizedText");\r\nparseExtensionObject(subtree, tvb, pinfo, pOffset, "ExtensionObject");\r\nparseDataValue(subtree, tvb, pinfo, pOffset, "DataValue");\r\nparseEnumeratedTestType(subtree, tvb, pinfo, pOffset);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseArrayTestType(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ArrayTestType, &ti, "%s: ArrayTestType", szFieldName);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "Booleans", "Boolean", hf_opcua_Booleans, parseBoolean, ett_opcua_array_Boolean);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "SBytes", "SByte", hf_opcua_SBytes, parseSByte, ett_opcua_array_SByte);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "Int16s", "Int16", hf_opcua_Int16s, parseInt16, ett_opcua_array_Int16);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "UInt16s", "UInt16", hf_opcua_UInt16s, parseUInt16, ett_opcua_array_UInt16);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "Int32s", "Int32", hf_opcua_Int32s, parseInt32, ett_opcua_array_Int32);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "UInt32s", "UInt32", hf_opcua_UInt32s, parseUInt32, ett_opcua_array_UInt32);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "Int64s", "Int64", hf_opcua_Int64s, parseInt64, ett_opcua_array_Int64);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "UInt64s", "UInt64", hf_opcua_UInt64s, parseUInt64, ett_opcua_array_UInt64);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "Floats", "Float", hf_opcua_Floats, parseFloat, ett_opcua_array_Float);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "Doubles", "Double", hf_opcua_Doubles, parseDouble, ett_opcua_array_Double);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "Strings", "String", hf_opcua_Strings, parseString, ett_opcua_array_String);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "DateTimes", "DateTime", hf_opcua_DateTimes, parseDateTime, ett_opcua_array_DateTime);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "Guids", "Guid", hf_opcua_Guids, parseGuid, ett_opcua_array_Guid);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "ByteStrings", "ByteString", hf_opcua_ByteStrings, parseByteString, ett_opcua_array_ByteString);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "XmlElements", "XmlElement", hf_opcua_XmlElements, parseXmlElement, ett_opcua_array_XmlElement);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "NodeIds", "NodeId", parseNodeId, ett_opcua_array_NodeId);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "ExpandedNodeIds", "ExpandedNodeId", parseExpandedNodeId, ett_opcua_array_ExpandedNodeId);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "StatusCodes", "StatusCode", hf_opcua_StatusCodes, parseStatusCode, ett_opcua_array_StatusCode);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "DiagnosticInfos", "DiagnosticInfo", parseDiagnosticInfo, ett_opcua_array_DiagnosticInfo);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "QualifiedNames", "QualifiedName", parseQualifiedName, ett_opcua_array_QualifiedName);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "LocalizedTexts", "LocalizedText", parseLocalizedText, ett_opcua_array_LocalizedText);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "ExtensionObjects", "ExtensionObject", parseExtensionObject, ett_opcua_array_ExtensionObject);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "DataValues", "DataValue", parseDataValue, ett_opcua_array_DataValue);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "Variants", "Variant", parseVariant, ett_opcua_array_Variant);\r\nparseArrayEnum(subtree, tvb, pinfo, pOffset, "EnumeratedValues", "EnumeratedTestType", parseEnumeratedTestType, ett_opcua_array_EnumeratedTestType);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseCompositeTestType(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_CompositeTestType, &ti, "%s: CompositeTestType", szFieldName);\r\nparseScalarTestType(subtree, tvb, pinfo, pOffset, "Field1");\r\nparseArrayTestType(subtree, tvb, pinfo, pOffset, "Field2");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseBuildInfo(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_BuildInfo, &ti, "%s: BuildInfo", szFieldName);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_ProductUri);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_ManufacturerName);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_ProductName);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_SoftwareVersion);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_BuildNumber);\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_BuildDate);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseRedundantServerDataType(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_RedundantServerDataType, &ti, "%s: RedundantServerDataType", szFieldName);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_ServerId);\r\nparseByte(subtree, tvb, pinfo, pOffset, hf_opcua_ServiceLevel);\r\nparseServerState(subtree, tvb, pinfo, pOffset);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseEndpointUrlListDataType(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_EndpointUrlListDataType, &ti, "%s: EndpointUrlListDataType", szFieldName);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "EndpointUrlList", "String", hf_opcua_EndpointUrlList, parseString, ett_opcua_array_String);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseNetworkGroupDataType(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_NetworkGroupDataType, &ti, "%s: NetworkGroupDataType", szFieldName);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_ServerUri);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "NetworkPaths", "EndpointUrlListDataType", parseEndpointUrlListDataType, ett_opcua_array_EndpointUrlListDataType);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseSamplingIntervalDiagnosticsDataType(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_SamplingIntervalDiagnosticsDataType, &ti, "%s: SamplingIntervalDiagnosticsDataType", szFieldName);\r\nparseDouble(subtree, tvb, pinfo, pOffset, hf_opcua_SamplingInterval);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_MonitoredItemCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_MaxMonitoredItemCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_DisabledMonitoredItemCount);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseServerDiagnosticsSummaryDataType(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ServerDiagnosticsSummaryDataType, &ti, "%s: ServerDiagnosticsSummaryDataType", szFieldName);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_ServerViewCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_CurrentSessionCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_CumulatedSessionCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_SecurityRejectedSessionCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_RejectedSessionCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_SessionTimeoutCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_SessionAbortCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_CurrentSubscriptionCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_CumulatedSubscriptionCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_PublishingIntervalCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_SecurityRejectedRequestsCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_RejectedRequestsCount);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseServerStatusDataType(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ServerStatusDataType, &ti, "%s: ServerStatusDataType", szFieldName);\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_StartTime);\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_CurrentTime);\r\nparseServerState(subtree, tvb, pinfo, pOffset);\r\nparseBuildInfo(subtree, tvb, pinfo, pOffset, "BuildInfo");\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_SecondsTillShutdown);\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "ShutdownReason");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseSessionDiagnosticsDataType(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_SessionDiagnosticsDataType, &ti, "%s: SessionDiagnosticsDataType", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "SessionId");\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_SessionName);\r\nparseApplicationDescription(subtree, tvb, pinfo, pOffset, "ClientDescription");\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_ServerUri);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_EndpointUrl);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "LocaleIds", "String", hf_opcua_LocaleIds, parseString, ett_opcua_array_String);\r\nparseDouble(subtree, tvb, pinfo, pOffset, hf_opcua_ActualSessionTimeout);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_MaxResponseMessageSize);\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_ClientConnectionTime);\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_ClientLastContactTime);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_CurrentSubscriptionsCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_CurrentMonitoredItemsCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_CurrentPublishRequestsInQueue);\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "TotalRequestCount");\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_UnauthorizedRequestCount);\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "ReadCount");\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "HistoryReadCount");\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "WriteCount");\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "HistoryUpdateCount");\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "CallCount");\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "CreateMonitoredItemsCount");\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "ModifyMonitoredItemsCount");\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "SetMonitoringModeCount");\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "SetTriggeringCount");\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "DeleteMonitoredItemsCount");\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "CreateSubscriptionCount");\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "ModifySubscriptionCount");\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "SetPublishingModeCount");\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "PublishCount");\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "RepublishCount");\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "TransferSubscriptionsCount");\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "DeleteSubscriptionsCount");\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "AddNodesCount");\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "AddReferencesCount");\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "DeleteNodesCount");\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "DeleteReferencesCount");\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "BrowseCount");\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "BrowseNextCount");\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "TranslateBrowsePathsToNodeIdsCount");\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "QueryFirstCount");\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "QueryNextCount");\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "RegisterNodesCount");\r\nparseServiceCounterDataType(subtree, tvb, pinfo, pOffset, "UnregisterNodesCount");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseSessionSecurityDiagnosticsDataType(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_SessionSecurityDiagnosticsDataType, &ti, "%s: SessionSecurityDiagnosticsDataType", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "SessionId");\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_ClientUserIdOfSession);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "ClientUserIdHistory", "String", hf_opcua_ClientUserIdHistory, parseString, ett_opcua_array_String);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_AuthenticationMechanism);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_Encoding);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_TransportProtocol);\r\nparseMessageSecurityMode(subtree, tvb, pinfo, pOffset);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_SecurityPolicyUri);\r\nparseByteString(subtree, tvb, pinfo, pOffset, hf_opcua_ClientCertificate);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseServiceCounterDataType(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ServiceCounterDataType, &ti, "%s: ServiceCounterDataType", szFieldName);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_TotalCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_ErrorCount);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseStatusResult(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_StatusResult, &ti, "%s: StatusResult", szFieldName);\r\nparseStatusCode(subtree, tvb, pinfo, pOffset, hf_opcua_StatusCode);\r\nparseDiagnosticInfo(subtree, tvb, pinfo, pOffset, "DiagnosticInfo");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseSubscriptionDiagnosticsDataType(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_SubscriptionDiagnosticsDataType, &ti, "%s: SubscriptionDiagnosticsDataType", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "SessionId");\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_SubscriptionId);\r\nparseByte(subtree, tvb, pinfo, pOffset, hf_opcua_Priority);\r\nparseDouble(subtree, tvb, pinfo, pOffset, hf_opcua_PublishingInterval);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_MaxKeepAliveCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_MaxLifetimeCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_MaxNotificationsPerPublish);\r\nparseBoolean(subtree, tvb, pinfo, pOffset, hf_opcua_PublishingEnabled);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_ModifyCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_EnableCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_DisableCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_RepublishRequestCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_RepublishMessageRequestCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_RepublishMessageCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_TransferRequestCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_TransferredToAltClientCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_TransferredToSameClientCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_PublishRequestCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_DataChangeNotificationsCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_EventNotificationsCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_NotificationsCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_LatePublishRequestCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_CurrentKeepAliveCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_CurrentLifetimeCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_UnacknowledgedMessageCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_DiscardedMessageCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_MonitoredItemCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_DisabledMonitoredItemCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_MonitoringQueueOverflowCount);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_NextSequenceNumber);\r\nparseUInt32(subtree, tvb, pinfo, pOffset, hf_opcua_EventQueueOverFlowCount);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseModelChangeStructureDataType(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ModelChangeStructureDataType, &ti, "%s: ModelChangeStructureDataType", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "Affected");\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "AffectedType");\r\nparseByte(subtree, tvb, pinfo, pOffset, hf_opcua_Verb);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseSemanticChangeStructureDataType(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_SemanticChangeStructureDataType, &ti, "%s: SemanticChangeStructureDataType", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "Affected");\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "AffectedType");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseRange(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_Range, &ti, "%s: Range", szFieldName);\r\nparseDouble(subtree, tvb, pinfo, pOffset, hf_opcua_Low);\r\nparseDouble(subtree, tvb, pinfo, pOffset, hf_opcua_High);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseEUInformation(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_EUInformation, &ti, "%s: EUInformation", szFieldName);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_NamespaceUri);\r\nparseInt32(subtree, tvb, pinfo, pOffset, hf_opcua_UnitId);\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "DisplayName");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "Description");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseComplexNumberType(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ComplexNumberType, &ti, "%s: ComplexNumberType", szFieldName);\r\nparseFloat(subtree, tvb, pinfo, pOffset, hf_opcua_Real);\r\nparseFloat(subtree, tvb, pinfo, pOffset, hf_opcua_Imaginary);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseDoubleComplexNumberType(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_DoubleComplexNumberType, &ti, "%s: DoubleComplexNumberType", szFieldName);\r\nparseDouble(subtree, tvb, pinfo, pOffset, hf_opcua_Real);\r\nparseDouble(subtree, tvb, pinfo, pOffset, hf_opcua_Imaginary);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseAxisInformation(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_AxisInformation, &ti, "%s: AxisInformation", szFieldName);\r\nparseEUInformation(subtree, tvb, pinfo, pOffset, "EngineeringUnits");\r\nparseRange(subtree, tvb, pinfo, pOffset, "EURange");\r\nparseLocalizedText(subtree, tvb, pinfo, pOffset, "Title");\r\nparseAxisScaleEnumeration(subtree, tvb, pinfo, pOffset);\r\nparseArraySimple(subtree, tvb, pinfo, pOffset, "AxisSteps", "Double", hf_opcua_AxisSteps, parseDouble, ett_opcua_array_Double);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseXVType(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_XVType, &ti, "%s: XVType", szFieldName);\r\nparseDouble(subtree, tvb, pinfo, pOffset, hf_opcua_X);\r\nparseFloat(subtree, tvb, pinfo, pOffset, hf_opcua_Value);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseProgramDiagnosticDataType(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_ProgramDiagnosticDataType, &ti, "%s: ProgramDiagnosticDataType", szFieldName);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "CreateSessionId");\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_CreateClientName);\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_InvocationCreationTime);\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_LastTransitionTime);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_LastMethodCall);\r\nparseNodeId(subtree, tvb, pinfo, pOffset, "LastMethodSessionId");\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "LastMethodInputArguments", "Argument", parseArgument, ett_opcua_array_Argument);\r\nparseArrayComplex(subtree, tvb, pinfo, pOffset, "LastMethodOutputArguments", "Argument", parseArgument, ett_opcua_array_Argument);\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_LastMethodCallTime);\r\nparseStatusResult(subtree, tvb, pinfo, pOffset, "LastMethodReturnStatus");\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid parseAnnotation(proto_tree *tree, tvbuff_t *tvb, packet_info *pinfo, gint *pOffset, const char *szFieldName)\r\n{\r\nproto_item *ti;\r\nproto_tree *subtree = proto_tree_add_subtree_format(tree, tvb, *pOffset, -1, ett_opcua_Annotation, &ti, "%s: Annotation", szFieldName);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_Message);\r\nparseString(subtree, tvb, pinfo, pOffset, hf_opcua_UserName);\r\nparseDateTime(subtree, tvb, pinfo, pOffset, hf_opcua_AnnotationTime);\r\nproto_item_set_end(ti, tvb, *pOffset);\r\n}\r\nvoid registerComplexTypes(void)\r\n{\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}
