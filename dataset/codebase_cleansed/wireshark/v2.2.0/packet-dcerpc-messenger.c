static int\r\nmessenger_dissect_send_message_rqst(tvbuff_t *tvb, int offset, packet_info *pinfo,\r\nproto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\noffset = dissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_ndr_char_cvstring, NDR_POINTER_REF,\r\n"Server", hf_messenger_server);\r\noffset = dissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_ndr_char_cvstring, NDR_POINTER_REF,\r\n"Client", hf_messenger_client);\r\noffset = dissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_ndr_char_cvstring, NDR_POINTER_REF,\r\n"Message", hf_messenger_message);\r\nreturn offset;\r\n}\r\nstatic int\r\nmessenger_dissect_send_message_reply(tvbuff_t *tvb, int offset, packet_info *pinfo,\r\nproto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\noffset = dissect_ntstatus(tvb, offset, pinfo, tree, di, drep,\r\nhf_messenger_rc, NULL);\r\nreturn offset;\r\n}\r\nvoid\r\nproto_register_dcerpc_messenger(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_messenger_opnum,\r\n{ "Operation", "messenger.opnum", FT_UINT16, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL }},\r\n{ &hf_messenger_rc,\r\n{ "Return code", "messenger.rc", FT_UINT32, BASE_HEX | BASE_EXT_STRING, &NT_errors_ext, 0x0, NULL, HFILL }},\r\n{ &hf_messenger_server, {\r\n"Server", "messenger.server",\r\nFT_STRING, BASE_NONE, NULL, 0, "Server to send the message to", HFILL }},\r\n{ &hf_messenger_client, {\r\n"Client", "messenger.client",\r\nFT_STRING, BASE_NONE, NULL, 0, "Client that sent the message", HFILL }},\r\n{ &hf_messenger_message, {\r\n"Message", "messenger.message",\r\nFT_STRING, BASE_NONE, NULL, 0, "The message being sent", HFILL }}\r\n};\r\nstatic gint *ett[] = {\r\n&ett_dcerpc_messenger\r\n};\r\nproto_dcerpc_messenger = proto_register_protocol(\r\n"Microsoft Messenger Service", "Messenger", "messenger");\r\nproto_register_field_array (proto_dcerpc_messenger, hf, array_length (hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid\r\nproto_reg_handoff_dcerpc_messenger(void)\r\n{\r\ndcerpc_init_uuid(proto_dcerpc_messenger, ett_dcerpc_messenger, &uuid_dcerpc_messenger,\r\nver_dcerpc_messenger, dcerpc_messenger_dissectors, hf_messenger_opnum);\r\n}
