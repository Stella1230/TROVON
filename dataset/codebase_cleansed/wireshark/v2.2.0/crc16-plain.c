long crc16_plain_reflect(long data, size_t data_len)\r\n{\r\nunsigned int i;\r\nlong ret;\r\nret = data & 0x01;\r\nfor (i = 1; i < data_len; i++)\r\n{\r\ndata >>= 1;\r\nret = (ret << 1) | (data & 0x01);\r\n}\r\nreturn ret;\r\n}\r\ncrc16_plain_t crc16_plain_update(crc16_plain_t crc, const unsigned char *data, size_t data_len)\r\n{\r\nunsigned int tbl_idx;\r\nwhile (data_len--) {\r\ntbl_idx = (crc ^ *data) & 0xff;\r\ncrc = (crc_table_reflected[tbl_idx] ^ (crc >> 8)) & 0xffff;\r\ndata++;\r\n}\r\nreturn crc & 0xffff;\r\n}\r\nguint16 crc16_8005_noreflect_noxor(const guint8 *data, guint64 data_len)\r\n{\r\nguint tbl_idx;\r\nguint16 crc = 0;\r\nwhile (data_len--) {\r\ntbl_idx = ((crc >> 8) ^ *data) & 0xff;\r\ncrc = (crc16_table_8005_noreflect_noxor[tbl_idx] ^ (crc << 8)) & 0xffff;\r\ndata++;\r\n}\r\nreturn crc & 0xffff;\r\n}
