static int\r\ndissect_aim_tlv_value_rendezvous(proto_item *ti, guint16 valueid _U_, tvbuff_t *tvb, packet_info *pinfo)\r\n{\r\nint offset = 0;\r\nproto_tree *entry = proto_item_add_subtree(ti, ett_aim_rendezvous_data);\r\nproto_tree_add_item(entry, hf_aim_rendezvous_msg_type, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(entry, hf_aim_icbm_cookie, tvb, offset, 8, ENC_NA);\r\noffset += 8;\r\noffset = dissect_aim_capability(entry, tvb, offset);\r\nreturn dissect_aim_tlv_sequence(tvb, pinfo, offset, entry,\r\naim_rendezvous_tlvs);\r\n}\r\nstatic int\r\ndissect_aim_msg_outgoing(tvbuff_t *tvb, packet_info *pinfo, proto_tree *msg_tree)\r\n{\r\nint offset = 0;\r\nconst aim_tlv *aim_ch_tlvs = NULL;\r\nguint16 channel_id;\r\nguint8 *buddyname;\r\nint buddyname_length;\r\nproto_tree_add_item(msg_tree, hf_aim_icbm_cookie, tvb, offset, 8, ENC_NA);\r\noffset += 8;\r\nchannel_id = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_item(msg_tree, hf_aim_message_channel_id, tvb, offset, 2,\r\nENC_BIG_ENDIAN);\r\noffset += 2;\r\nbuddyname_length = aim_get_buddyname(&buddyname, tvb, offset);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " to: %s",\r\nformat_text(buddyname, buddyname_length));\r\noffset = dissect_aim_buddyname(tvb, pinfo, offset, msg_tree);\r\nswitch(channel_id) {\r\ncase ICBM_CHANNEL_IM: aim_ch_tlvs = aim_messaging_incoming_ch1_tlvs; break;\r\ncase ICBM_CHANNEL_RENDEZVOUS: aim_ch_tlvs = aim_messaging_incoming_ch2_tlvs; break;\r\ndefault: return offset;\r\n}\r\nreturn dissect_aim_tlv_sequence(tvb, pinfo, offset, msg_tree, aim_ch_tlvs);\r\n}\r\nstatic int\r\ndissect_aim_msg_incoming(tvbuff_t *tvb, packet_info *pinfo, proto_tree *msg_tree)\r\n{\r\nint offset = 0;\r\nconst aim_tlv *aim_ch_tlvs;\r\nguint16 channel_id;\r\nproto_tree_add_item(msg_tree, hf_aim_icbm_cookie, tvb, offset, 8, ENC_NA);\r\noffset += 8;\r\nproto_tree_add_item(msg_tree, hf_aim_message_channel_id, tvb, offset, 2,\r\nENC_BIG_ENDIAN);\r\nchannel_id = tvb_get_ntohs(tvb, offset);\r\noffset += 2;\r\noffset = dissect_aim_userinfo(tvb, pinfo, offset, msg_tree);\r\nswitch(channel_id) {\r\ncase ICBM_CHANNEL_IM: aim_ch_tlvs = aim_messaging_incoming_ch1_tlvs; break;\r\ncase ICBM_CHANNEL_RENDEZVOUS: aim_ch_tlvs = aim_messaging_incoming_ch2_tlvs; break;\r\ndefault: return offset;\r\n}\r\nreturn dissect_aim_tlv_sequence(tvb, pinfo, offset, msg_tree, aim_ch_tlvs);\r\n}\r\nstatic int\r\ndissect_aim_msg_params(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *msg_tree)\r\n{\r\nint offset = 0;\r\nproto_tree_add_item(msg_tree, hf_aim_icbm_channel, tvb, offset, 2, ENC_BIG_ENDIAN); offset+=2;\r\nproto_tree_add_item(msg_tree, hf_aim_icbm_msg_flags, tvb, offset, 4, ENC_BIG_ENDIAN); offset+=4;\r\nproto_tree_add_item(msg_tree, hf_aim_icbm_max_snac_size, tvb, offset, 2, ENC_BIG_ENDIAN); offset+=2;\r\nproto_tree_add_item(msg_tree, hf_aim_icbm_max_sender_warnlevel, tvb, offset, 2, ENC_BIG_ENDIAN); offset+=2;\r\nproto_tree_add_item(msg_tree, hf_aim_icbm_max_receiver_warnlevel, tvb, offset, 2, ENC_BIG_ENDIAN); offset+=2;\r\nproto_tree_add_item(msg_tree, hf_aim_icbm_min_msg_interval, tvb, offset, 4, ENC_BIG_ENDIAN); offset+=4;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_aim_msg_evil_req(tvbuff_t *tvb, packet_info *pinfo, proto_tree *msg_tree)\r\n{\r\nint offset = 0;\r\nproto_tree_add_item(msg_tree, hf_aim_icbm_evil, tvb, offset, 2, ENC_BIG_ENDIAN); offset+=2;\r\nreturn dissect_aim_buddyname(tvb, pinfo, offset, msg_tree);\r\n}\r\nstatic int\r\ndissect_aim_msg_evil_repl(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *msg_tree)\r\n{\r\nint offset = 0;\r\nproto_tree_add_item(msg_tree, hf_aim_evil_warn_level, tvb, offset, 2, ENC_BIG_ENDIAN); offset+=2;\r\nproto_tree_add_item(msg_tree, hf_aim_evil_new_warn_level, tvb, offset, 2, ENC_BIG_ENDIAN); offset+=2;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_aim_msg_minityping(tvbuff_t *tvb, packet_info *pinfo, proto_tree *msg_tree)\r\n{\r\nint offset = 0;\r\nproto_tree_add_item(msg_tree,hf_aim_icbm_notification_cookie, tvb, offset, 8, ENC_NA); offset+=8;\r\nproto_tree_add_item(msg_tree,hf_aim_icbm_notification_channel, tvb, offset, 2, ENC_BIG_ENDIAN); offset+=2;\r\noffset = dissect_aim_buddyname(tvb, pinfo, offset, msg_tree);\r\nproto_tree_add_item(msg_tree,hf_aim_icbm_notification_type, tvb, offset, 2, ENC_BIG_ENDIAN); offset+=2;\r\nreturn offset;\r\n}\r\nstatic const\r\naim_client_plugin *aim_find_plugin ( e_guid_t uuid)\r\n{\r\nint i;\r\nfor(i = 0; known_client_plugins[i].name; i++)\r\n{\r\nconst aim_client_plugin *plugin = &(known_client_plugins[i]);\r\nif(memcmp(&(plugin->uuid), &uuid, sizeof(e_guid_t)) == 0)\r\nreturn plugin;\r\n}\r\nreturn NULL;\r\n}\r\nstatic int\r\ndissect_aim_plugin(proto_tree *entry, tvbuff_t *tvb, int offset, e_guid_t* out_plugin_uuid)\r\n{\r\nconst aim_client_plugin *plugin = NULL;\r\ne_guid_t uuid;\r\nproto_item* ti;\r\nuuid.data1 = tvb_get_ntohl(tvb, offset);\r\nuuid.data2 = tvb_get_ntohs(tvb, offset+4);\r\nuuid.data3 = tvb_get_ntohs(tvb, offset+6);\r\ntvb_memcpy(tvb, uuid.data4, offset+8, 8);\r\nif (out_plugin_uuid)\r\n*out_plugin_uuid = uuid;\r\nplugin = aim_find_plugin(uuid);\r\nti = proto_tree_add_item(entry, hf_aim_messaging_plugin, tvb, offset, 16, ENC_NA);\r\nproto_item_append_text(ti, " (%s)", plugin ? plugin->name:"Unknown");\r\nreturn offset+16;\r\n}\r\nstatic int\r\ndissect_aim_rendezvous_extended_message(tvbuff_t *tvb, proto_tree *msg_tree)\r\n{\r\nint offset = 0;\r\nguint32 text_length;\r\nstatic const int * flags[] = {\r\n&hf_aim_rendezvous_extended_data_message_flags_normal,\r\n&hf_aim_rendezvous_extended_data_message_flags_auto,\r\n&hf_aim_rendezvous_extended_data_message_flags_multi,\r\nNULL\r\n};\r\nproto_tree_add_item(msg_tree, hf_aim_rendezvous_extended_data_message_type, tvb, offset, 1, ENC_BIG_ENDIAN); offset+=1;\r\nproto_tree_add_bitmask(msg_tree, tvb, offset, hf_aim_rendezvous_extended_data_message_flags,\r\nett_aim_extended_data_message_flags, flags, ENC_NA);\r\noffset+=1;\r\nproto_tree_add_item(msg_tree, hf_aim_rendezvous_extended_data_message_status_code, tvb, offset, 2, ENC_BIG_ENDIAN); offset+=2;\r\nproto_tree_add_item(msg_tree, hf_aim_rendezvous_extended_data_message_priority_code, tvb, offset, 2, ENC_BIG_ENDIAN); offset+=2;\r\ntext_length = tvb_get_letohs(tvb, offset);\r\nproto_tree_add_item_ret_uint(msg_tree, hf_aim_rendezvous_extended_data_message_text_length, tvb, offset, 2, ENC_BIG_ENDIAN, &text_length); offset+=2;\r\nproto_tree_add_item(msg_tree, hf_aim_rendezvous_extended_data_message_text, tvb, offset, text_length, ENC_ASCII|ENC_NA);\r\noffset = tvb_reported_length(tvb);\r\nreturn offset;\r\n}\r\nstatic int\r\nis_uuid_null(e_guid_t uuid)\r\n{\r\nreturn (uuid.data1 == 0) &&\r\n(uuid.data2 == 0) &&\r\n(uuid.data3 == 0) &&\r\n(uuid.data4[0] == 0) &&\r\n(uuid.data4[1] == 0) &&\r\n(uuid.data4[2] == 0) &&\r\n(uuid.data4[3] == 0) &&\r\n(uuid.data4[4] == 0) &&\r\n(uuid.data4[5] == 0) &&\r\n(uuid.data4[6] == 0) &&\r\n(uuid.data4[7] == 0);\r\n}\r\nstatic int\r\ndissect_aim_tlv_value_extended_data(proto_tree *entry, guint16 valueid _U_, tvbuff_t *tvb, packet_info *pinfo _U_)\r\n{\r\nint offset = 0;\r\nguint16 length;\r\nint start_offset;\r\ne_guid_t plugin_uuid;\r\nlength = tvb_get_letohs(tvb, offset);\r\nproto_tree_add_item(entry, hf_aim_icbm_client_err_length, tvb, offset, 2, ENC_LITTLE_ENDIAN); offset+=2;\r\nstart_offset = offset;\r\nproto_tree_add_item(entry, hf_aim_icbm_client_err_protocol_version, tvb, offset, 2, ENC_BIG_ENDIAN); offset+=2;\r\noffset = dissect_aim_plugin(entry, tvb, offset, &plugin_uuid);\r\nproto_tree_add_item(entry, hf_aim_messaging_unknown, tvb, offset, 2, ENC_LITTLE_ENDIAN); offset += 2;\r\nproto_tree_add_item(entry, hf_aim_icbm_client_err_client_caps_flags, tvb, offset, 4, ENC_BIG_ENDIAN); offset+=4;\r\nproto_tree_add_item(entry, hf_aim_messaging_unknown, tvb, offset, 1, ENC_NA); offset += 1;\r\nproto_tree_add_item(entry, hf_aim_icbm_client_err_downcounter, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\noffset = start_offset + length;\r\nlength = tvb_get_letohs(tvb, offset);\r\nproto_tree_add_item(entry, hf_aim_icbm_client_err_length, tvb, offset, 2, ENC_LITTLE_ENDIAN); offset+=2;\r\nstart_offset = offset;\r\nproto_tree_add_item(entry, hf_aim_icbm_client_err_downcounter, tvb, offset, 2, ENC_LITTLE_ENDIAN); offset += 2;\r\nproto_tree_add_item(entry, hf_aim_messaging_unknown_data, tvb, offset, length-2, ENC_NA);\r\noffset = start_offset + length;\r\nif (is_uuid_null(plugin_uuid))\r\n{\r\ntvbuff_t *subtvb = tvb_new_subset_remaining(tvb, offset);\r\ndissect_aim_rendezvous_extended_message(subtvb, entry);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(entry, hf_aim_messaging_plugin_specific_data, tvb, offset, -1, ENC_NA);\r\n}\r\noffset = tvb_reported_length(tvb);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_aim_msg_ack(tvbuff_t *tvb, packet_info *pinfo, proto_tree *msg_tree)\r\n{\r\nint offset = 0;\r\nproto_tree_add_item(msg_tree,hf_aim_icbm_cookie, tvb, offset, 8, ENC_NA); offset+=8;\r\nproto_tree_add_item(msg_tree, hf_aim_message_channel_id, tvb, offset, 2,\r\nENC_BIG_ENDIAN); offset += 2;\r\noffset = dissect_aim_buddyname(tvb, pinfo, offset, msg_tree);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_aim_msg_client_err(tvbuff_t *tvb, packet_info *pinfo, proto_tree *msg_tree)\r\n{\r\nint offset = 0;\r\nguint16 channel, reason;\r\nproto_tree_add_item(msg_tree,hf_aim_icbm_cookie, tvb, offset, 8, ENC_NA); offset+=8;\r\nchannel = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_item(msg_tree,hf_aim_icbm_channel, tvb, offset, 2, ENC_BIG_ENDIAN); offset+=2;\r\noffset = dissect_aim_buddyname(tvb, pinfo, offset, msg_tree);\r\nreason = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_item(msg_tree, hf_aim_icbm_client_err_reason, tvb, offset, 2, ENC_BIG_ENDIAN); offset+=2;\r\nif (reason == CLIENT_ERR__REASON_CHANNEL_SPECIFIC && tvb_reported_length_remaining(tvb, offset) > 0)\r\n{\r\nswitch (channel)\r\n{\r\ncase ICBM_CHANNEL_RENDEZVOUS:\r\nproto_tree_add_item(msg_tree, hf_aim_icbm_rendezvous_nak_length, tvb, offset, 2, ENC_BIG_ENDIAN); offset+=2;\r\nproto_tree_add_item(msg_tree, hf_aim_icbm_rendezvous_nak, tvb, offset, 2, ENC_BIG_ENDIAN); offset+=2;\r\nbreak;\r\ndefault:\r\n{\r\ntvbuff_t *subtvb = tvb_new_subset_remaining(tvb, offset);\r\nproto_tree *extended_tree = proto_tree_add_subtree(msg_tree, tvb, offset, -1, ett_aim_extended_data, NULL, "Extended Data");\r\ndissect_aim_tlv_value_extended_data(extended_tree, 0, subtvb, pinfo);\r\nbreak;\r\n}\r\n}\r\n}\r\nreturn offset;\r\n}\r\nvoid\r\nproto_register_aim_messaging(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_aim_icbm_channel,\r\n{ "Channel", "aim_messaging.icbm.channel",\r\nFT_UINT16, BASE_HEX, VALS(icbm_channel_types), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_icbm_msg_flags,\r\n{ "Message Flags", "aim_messaging.icbm.flags",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_icbm_max_snac_size,\r\n{ "Max SNAC Size", "aim_messaging.icbm.max_snac",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_icbm_max_sender_warnlevel,\r\n{ "Max sender warn level", "aim_messaging.icbm.max_sender_warn-level",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_icbm_max_receiver_warnlevel,\r\n{ "max receiver warn level", "aim_messaging.icbm.max_receiver_warnlevel",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_icbm_min_msg_interval,\r\n{ "Minimum message interval (milliseconds)", "aim_messaging.icbm.min_msg_interval",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_icbm_cookie,\r\n{ "ICBM Cookie", "aim_messaging.icbmcookie",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_message_channel_id,\r\n{ "Message Channel ID", "aim_messaging.channelid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_icbm_evil,\r\n{ "Send Evil Bit As", "aim_messaging.evilreq.origin",\r\nFT_UINT16, BASE_DEC, VALS(evil_origins), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_evil_warn_level,\r\n{ "Old warning level", "aim_messaging.evil.warn_level",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_evil_new_warn_level,\r\n{ "New warning level", "aim_messaging.evil.new_warn_level",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_icbm_notification_cookie,\r\n{ "Notification Cookie", "aim_messaging.notification.cookie",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_icbm_notification_channel,\r\n{ "Notification Channel", "aim_messaging.notification.channel",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_icbm_notification_type,\r\n{ "Notification Type", "aim_messaging.notification.type",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_icbm_rendezvous_nak,\r\n{ "Rendezvous NAK reason", "aim_messaging.rendezvous_nak",\r\nFT_UINT16, BASE_HEX, VALS(rendezvous_nak_reason_types), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_icbm_rendezvous_nak_length,\r\n{ "Rendezvous NAK reason length", "aim_messaging.rendezvous_nak_length",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_rendezvous_msg_type,\r\n{ "Message Type", "aim_messaging.rendezvous.msg_type",\r\nFT_UINT16, BASE_HEX, VALS(rendezvous_msg_types), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_icbm_client_err_reason,\r\n{ "Reason", "aim_messaging.clienterr.reason",\r\nFT_UINT16, BASE_DEC, VALS(client_err_reason_types), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_icbm_client_err_protocol_version,\r\n{ "Version", "aim_messaging.clienterr.protocol_version",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_icbm_client_err_client_caps_flags,\r\n{ "Client Capabilities Flags", "aim_messaging.clienterr.client_caps_flags",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_rendezvous_extended_data_message_type,\r\n{ "Message Type", "aim_messaging.icbm.extended_data.message.type",\r\nFT_UINT8, BASE_HEX, VALS(extended_data_message_types), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_rendezvous_extended_data_message_flags,\r\n{ "Message Flags", "aim_messaging.icbm.extended_data.message.flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_rendezvous_extended_data_message_flags_normal,\r\n{ "Normal Message", "aim_messaging.icbm.extended_data.message.flags.normal",\r\nFT_BOOLEAN, 16, TFS(&tfs_set_notset), EXTENDED_DATA_MFLAG_NORMAL,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_rendezvous_extended_data_message_flags_auto,\r\n{ "Auto Message", "aim_messaging.icbm.extended_data.message.flags.auto",\r\nFT_BOOLEAN, 16, TFS(&tfs_set_notset), EXTENDED_DATA_MFLAG_AUTO,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_rendezvous_extended_data_message_flags_multi,\r\n{ "Multiple Recipients Message", "aim_messaging.icbm.rendezvous.extended_data.message.flags.multi",\r\nFT_BOOLEAN, 16, TFS(&tfs_set_notset), EXTENDED_DATA_MFLAG_MULTI,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_rendezvous_extended_data_message_status_code,\r\n{ "Status Code", "aim_messaging.icbm.extended_data.message.status_code",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_rendezvous_extended_data_message_priority_code,\r\n{ "Priority Code", "aim_messaging.icbm.extended_data.message.priority_code",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_rendezvous_extended_data_message_text_length,\r\n{ "Text Length", "aim_messaging.icbm.extended_data.message.text_length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_rendezvous_extended_data_message_text,\r\n{ "Text", "aim_messaging.icbm.extended_data.message.text",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_aim_messaging_plugin, { "Plugin", "aim_messaging.plugin", FT_GUID, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_aim_icbm_client_err_length, { "Length", "aim_messaging.clienterr.length", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_aim_messaging_unknown, { "Unknown", "aim_messaging.unknown", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_aim_icbm_client_err_downcounter, { "Downcounter?", "aim_messaging.clienterr.downcounter", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_aim_messaging_unknown_data, { "Unknown", "aim_messaging.unknown_bytes", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_aim_messaging_plugin_specific_data, { "Plugin-specific data", "aim_messaging.plugin_specific_data", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_aim_messaging,\r\n&ett_aim_rendezvous_data,\r\n&ett_aim_extended_data,\r\n&ett_aim_extended_data_message_flags\r\n};\r\nproto_aim_messaging = proto_register_protocol("AIM Messaging", "AIM Messaging", "aim_messaging");\r\nproto_register_field_array(proto_aim_messaging, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid\r\nproto_reg_handoff_aim_messaging(void)\r\n{\r\naim_init_family(proto_aim_messaging, ett_aim_messaging, FAMILY_MESSAGING, aim_fnac_family_messaging);\r\n}
