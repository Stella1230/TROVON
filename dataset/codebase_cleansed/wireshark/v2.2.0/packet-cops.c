static int cops_tag_cls2syntax ( guint tag, guint cls ) {\r\nCOPS_CNV *cnv;\r\ncnv = CopsCnv;\r\nwhile (cnv->syntax != -1)\r\n{\r\nif (cnv->tag == tag && cnv->ber_class == cls)\r\n{\r\nreturn *(cnv->hfidp);\r\n}\r\ncnv++;\r\n}\r\nreturn hf_cops_epd_unknown;\r\n}\r\nstatic guint\r\nget_cops_pdu_len(packet_info *pinfo _U_, tvbuff_t *tvb, int offset, void *data _U_)\r\n{\r\nreturn tvb_get_ntohl(tvb, offset + 4);\r\n}\r\nstatic int\r\ndissect_cops_pdu(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nguint8 op_code;\r\nguint16 client_type;\r\nint object_len;\r\nproto_item *ti, *tv;\r\nproto_tree *cops_tree, *ver_flags_tree;\r\nguint32 msg_len;\r\nguint32 offset = 0;\r\nguint8 ver_flags;\r\ngint garbage;\r\nguint32 handle_value = 0;\r\nguint i;\r\ngboolean is_solicited, is_request, is_response;\r\nconversation_t *conversation;\r\ncops_conv_info_t *cops_conv_info;\r\ncops_call_t *cops_call;\r\nGPtrArray* pdus_array;\r\nnstime_t delta;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "COPS");\r\ncol_clear(pinfo->cinfo, COL_INFO);\r\nop_code = tvb_get_guint8(tvb, 1);\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "COPS %s",\r\nval_to_str_const(op_code, cops_op_code_vals, "Unknown Op Code"));\r\nclient_type = tvb_get_ntohs(tvb, 2);\r\nti = proto_tree_add_item(tree, proto_cops, tvb, offset, -1, ENC_NA);\r\ncops_tree = proto_item_add_subtree(ti, ett_cops);\r\nver_flags = tvb_get_guint8(tvb, offset);\r\nis_solicited = (lo_nibble(ver_flags) == 0x01);\r\ntv = proto_tree_add_uint_format(cops_tree, hf_cops_ver_flags, tvb, offset, 1,\r\nver_flags, "Version: %u, Flags: %s",\r\nhi_nibble(ver_flags),\r\nval_to_str_const(lo_nibble(ver_flags), cops_flags_vals, "Unknown"));\r\nver_flags_tree = proto_item_add_subtree(tv, ett_cops_ver_flags);\r\nproto_tree_add_uint(ver_flags_tree, hf_cops_version, tvb, offset, 1, ver_flags);\r\nproto_tree_add_uint(ver_flags_tree, hf_cops_flags, tvb, offset, 1, ver_flags);\r\noffset++;\r\nproto_tree_add_item(cops_tree, hf_cops_op_code, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset ++;\r\nproto_tree_add_item(cops_tree, hf_cops_client_type, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nmsg_len = tvb_get_ntohl(tvb, offset);\r\nproto_tree_add_uint(cops_tree, hf_cops_msg_len, tvb, offset, 4, msg_len);\r\noffset += 4;\r\nwhile (tvb_reported_length_remaining(tvb, offset) >= COPS_OBJECT_HDR_SIZE) {\r\nobject_len = dissect_cops_object(tvb, pinfo, op_code, offset, cops_tree, client_type, &handle_value);\r\nif (object_len < 0)\r\nreturn offset;\r\noffset += object_len;\r\n}\r\ngarbage = tvb_reported_length_remaining(tvb, offset);\r\nif (garbage > 0) {\r\nproto_tree_add_expert_format(tree, pinfo, &ei_cops_trailing_garbage, tvb, offset, garbage, "Trailing garbage: %d byte%s", garbage, plurality(garbage, "", "s"));\r\n}\r\nif (handle_value == 0 &&\r\n( op_code != COPS_MSG_SSQ &&\r\nop_code != COPS_MSG_OPN &&\r\nop_code != COPS_MSG_CAT &&\r\nop_code != COPS_MSG_CC &&\r\nop_code != COPS_MSG_KA &&\r\nop_code != COPS_MSG_SSC) ) {\r\nreturn offset;\r\n}\r\nis_request =\r\nop_code == COPS_MSG_REQ ||\r\n(op_code == COPS_MSG_DEC && !is_solicited) ||\r\nop_code == COPS_MSG_SSQ ||\r\nop_code == COPS_MSG_OPN ||\r\n(op_code == COPS_MSG_KA && !is_solicited);\r\nis_response =\r\n(op_code == COPS_MSG_DEC && is_solicited) ||\r\n(op_code == COPS_MSG_RPT && is_solicited) ||\r\n(op_code == COPS_MSG_DRQ && is_solicited) ||\r\nop_code == COPS_MSG_CAT ||\r\n(op_code == COPS_MSG_CC && is_solicited) ||\r\n(op_code == COPS_MSG_KA && is_solicited) ||\r\nop_code == COPS_MSG_SSC;\r\nconversation = find_or_create_conversation(pinfo);\r\ncops_conv_info = (cops_conv_info_t *)conversation_get_proto_data(conversation, proto_cops);\r\nif (!cops_conv_info) {\r\ncops_conv_info = (cops_conv_info_t *)wmem_alloc(wmem_file_scope(), sizeof(cops_conv_info_t));\r\ncops_conv_info->pdus_tree = wmem_map_new(wmem_file_scope(), g_direct_hash, g_direct_equal);\r\nconversation_add_proto_data(conversation, proto_cops, cops_conv_info);\r\n}\r\nif ( is_request ||\r\n(op_code == COPS_MSG_DEC && is_solicited) ) {\r\npdus_array = (GPtrArray *)wmem_map_lookup(cops_conv_info->pdus_tree, GUINT_TO_POINTER(handle_value));\r\nif (pdus_array == NULL) {\r\npdus_array = g_ptr_array_new();\r\nwmem_map_insert(cops_conv_info->pdus_tree, GUINT_TO_POINTER(handle_value), pdus_array);\r\n}\r\nif (!pinfo->fd->flags.visited) {\r\ncops_call = wmem_new(wmem_file_scope(), cops_call_t);\r\ncops_call->op_code = op_code;\r\ncops_call->solicited = is_solicited;\r\ncops_call->req_num = pinfo->num;\r\ncops_call->rsp_num = 0;\r\ncops_call->req_time = pinfo->abs_ts;\r\ng_ptr_array_add(pdus_array, cops_call);\r\n}\r\nelse {\r\nfor (i=0; i < pdus_array->len; i++) {\r\ncops_call = (cops_call_t*)g_ptr_array_index(pdus_array, i);\r\nif ( cops_call->req_num == pinfo->num\r\n&& cops_call->rsp_num != 0) {\r\nti = proto_tree_add_uint_format(cops_tree, hf_cops_response_in, tvb, 0, 0, cops_call->rsp_num,\r\n"Response to this request is in frame %u", cops_call->rsp_num);\r\nPROTO_ITEM_SET_GENERATED(ti);\r\n}\r\n}\r\n}\r\n}\r\nif (is_response) {\r\npdus_array = (GPtrArray *)wmem_map_lookup(cops_conv_info->pdus_tree, GUINT_TO_POINTER(handle_value));\r\nif (pdus_array == NULL)\r\nreturn offset;\r\nif (!pinfo->fd->flags.visited) {\r\nfor (i=0; i < pdus_array->len; i++) {\r\ncops_call = (cops_call_t*)g_ptr_array_index(pdus_array, i);\r\nif (nstime_cmp(&pinfo->abs_ts, &cops_call->req_time) <= 0 || cops_call->rsp_num != 0)\r\ncontinue;\r\nif (\r\n( (cops_call->op_code == COPS_MSG_REQ) &&\r\n(op_code == COPS_MSG_DEC && is_solicited) ) ||\r\n( (cops_call->op_code == COPS_MSG_DEC) &&\r\n( (op_code == COPS_MSG_RPT && is_solicited) ||\r\n(op_code == COPS_MSG_DRQ && is_solicited) ) ) ||\r\n( (cops_call->op_code == COPS_MSG_SSQ) &&\r\n( (op_code == COPS_MSG_RPT && is_solicited) ||\r\n(op_code == COPS_MSG_DRQ && is_solicited) ||\r\n(op_code == COPS_MSG_SSC) ) ) ||\r\n( (cops_call->op_code == COPS_MSG_OPN) &&\r\n(op_code == COPS_MSG_CAT ||\r\nop_code == COPS_MSG_CC) ) ||\r\n( (cops_call->op_code == COPS_MSG_KA && !(cops_call->solicited)) &&\r\n(op_code == COPS_MSG_KA && is_solicited) ) ) {\r\ncops_call->rsp_num = pinfo->num;\r\nbreak;\r\n}\r\n}\r\n}\r\nelse {\r\nfor (i=0; i < pdus_array->len; i++) {\r\ncops_call = (cops_call_t*)g_ptr_array_index(pdus_array, i);\r\nif ( cops_call->rsp_num == pinfo->num ) {\r\nti = proto_tree_add_uint_format(cops_tree, hf_cops_response_to, tvb, 0, 0, cops_call->req_num,\r\n"Response to a request in frame %u", cops_call->req_num);\r\nPROTO_ITEM_SET_GENERATED(ti);\r\nnstime_delta(&delta, &pinfo->abs_ts, &cops_call->req_time);\r\nti = proto_tree_add_time(cops_tree, hf_cops_response_time, tvb, 0, 0, &delta);\r\nPROTO_ITEM_SET_GENERATED(ti);\r\nbreak;\r\n}\r\n}\r\n}\r\n}\r\nreturn tvb_reported_length(tvb);\r\n}\r\nstatic int\r\ndissect_cops(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data)\r\n{\r\ntcp_dissect_pdus(tvb, pinfo, tree, cops_desegment, 8,\r\nget_cops_pdu_len, dissect_cops_pdu, data);\r\nreturn tvb_reported_length(tvb);\r\n}\r\nstatic const char *cops_c_type_to_str(guint8 c_num, guint8 c_type)\r\n{\r\nswitch (c_num) {\r\ncase COPS_OBJ_HANDLE:\r\nif (c_type == 1)\r\nreturn "Client Handle";\r\nbreak;\r\ncase COPS_OBJ_IN_INT:\r\ncase COPS_OBJ_OUT_INT:\r\nif (c_type == 1)\r\nreturn "IPv4 Address + Interface";\r\nelse if (c_type == 2)\r\nreturn "IPv6 Address + Interface";\r\nbreak;\r\ncase COPS_OBJ_DECISION:\r\ncase COPS_OBJ_LPDPDECISION:\r\nif (c_type == 1)\r\nreturn "Decision Flags (Mandatory)";\r\nelse if (c_type == 2)\r\nreturn "Stateless Data";\r\nelse if (c_type == 3)\r\nreturn "Replacement Data";\r\nelse if (c_type == 4)\r\nreturn "Client Specific Decision Data";\r\nelse if (c_type == 5)\r\nreturn "Named Decision Data";\r\nbreak;\r\ncase COPS_OBJ_CLIENTSI:\r\nif (c_type == 1)\r\nreturn "Signaled ClientSI";\r\nelse if (c_type == 2)\r\nreturn "Named ClientSI";\r\nbreak;\r\ncase COPS_OBJ_KATIMER:\r\nif (c_type == 1)\r\nreturn "Keep-alive timer value";\r\nbreak;\r\ncase COPS_OBJ_PDPREDIRADDR:\r\ncase COPS_OBJ_LASTPDPADDR:\r\nif (c_type == 1)\r\nreturn "IPv4 Address + TCP Port";\r\nelse if (c_type == 2)\r\nreturn "IPv6 Address + TCP Port";\r\nbreak;\r\ncase COPS_OBJ_ACCTTIMER:\r\nif (c_type == 1)\r\nreturn "Accounting timer value";\r\nbreak;\r\ncase COPS_OBJ_INTEGRITY:\r\nif (c_type == 1)\r\nreturn "HMAC digest";\r\nbreak;\r\n}\r\nreturn "";\r\n}\r\nstatic int dissect_cops_object(tvbuff_t *tvb, packet_info *pinfo, guint8 op_code, guint32 offset, proto_tree *tree, guint16 client_type, guint32* handle_value)\r\n{\r\nint object_len, contents_len;\r\nguint8 c_num, c_type;\r\nproto_item *ti;\r\nproto_tree *obj_tree;\r\nconst char *type_str;\r\nobject_len = tvb_get_ntohs(tvb, offset);\r\nif (object_len < COPS_OBJECT_HDR_SIZE) {\r\nti = proto_tree_add_uint(tree, hf_cops_obj_len, tvb, offset, 2, object_len);\r\nexpert_add_info_format(pinfo, ti, &ei_cops_bad_cops_object_length,\r\n"Bad COPS object length: %u, should be at least %u",\r\nobject_len, COPS_OBJECT_HDR_SIZE);\r\nreturn -1;\r\n}\r\nc_num = tvb_get_guint8(tvb, offset + 2);\r\nc_type = tvb_get_guint8(tvb, offset + 3);\r\nti = proto_tree_add_uint_format(tree, hf_cops_obj_c_num, tvb, offset, object_len, c_num,\r\n"%s: %s", val_to_str_const(c_num, cops_c_num_vals, "Unknown"),\r\ncops_c_type_to_str(c_num, c_type));\r\nobj_tree = proto_item_add_subtree(ti, ett_cops_obj);\r\nproto_tree_add_uint(obj_tree, hf_cops_obj_len, tvb, offset, 2, object_len);\r\noffset += 2;\r\nproto_tree_add_uint(obj_tree, hf_cops_obj_c_num, tvb, offset, 1, c_num);\r\noffset++;\r\ntype_str = cops_c_type_to_str(c_num, c_type);\r\nproto_tree_add_uint_format_value(obj_tree, hf_cops_obj_c_type, tvb, offset, 1, c_type,\r\n"%s%s%u%s",\r\ntype_str,\r\nstrlen(type_str) ? " (" : "",\r\nc_type,\r\nstrlen(type_str) ? ")" : "");\r\noffset++;\r\ncontents_len = object_len - COPS_OBJECT_HDR_SIZE;\r\ndissect_cops_object_data(tvb, pinfo, offset, obj_tree, op_code, client_type, c_num, c_type, contents_len, handle_value);\r\nif (object_len % sizeof (guint32))\r\nobject_len += ((int)sizeof (guint32) - object_len % (int)sizeof (guint32));\r\nreturn object_len;\r\n}\r\nstatic void dissect_cops_pr_objects(tvbuff_t *tvb, packet_info *pinfo, guint32 offset, proto_tree *tree, int pr_len,\r\noid_info_t** oid_info_p, guint32** pprid_subids_p, guint* pprid_subids_len_p)\r\n{\r\nint object_len, contents_len;\r\nguint8 s_num, s_type;\r\nconst char *type_str;\r\nint ret;\r\nproto_tree *cops_pr_tree, *obj_tree;\r\nproto_item *ti;\r\ncops_pr_tree = proto_item_add_subtree(tree, ett_cops_pr_obj);\r\nwhile (pr_len >= COPS_OBJECT_HDR_SIZE) {\r\nobject_len = tvb_get_ntohs(tvb, offset);\r\nif (object_len < COPS_OBJECT_HDR_SIZE) {\r\nti = proto_tree_add_uint(cops_pr_tree, hf_cops_obj_len, tvb, offset, 2, object_len);\r\nexpert_add_info_format(pinfo, ti, &ei_cops_bad_cops_pr_object_length,\r\n"Bad COPS-PR object length: %u, should be at least %u",\r\nobject_len, COPS_OBJECT_HDR_SIZE);\r\nreturn;\r\n}\r\ns_num = tvb_get_guint8(tvb, offset + 2);\r\nti = proto_tree_add_uint_format(cops_pr_tree, hf_cops_obj_s_num, tvb, offset, object_len, s_num,\r\n"%s", val_to_str_const(s_num, cops_s_num_vals, "Unknown"));\r\nobj_tree = proto_item_add_subtree(ti, ett_cops_pr_obj);\r\nproto_tree_add_uint(obj_tree, hf_cops_obj_len, tvb, offset, 2, object_len);\r\noffset += 2;\r\npr_len -= 2;\r\nproto_tree_add_uint(obj_tree, hf_cops_obj_s_num, tvb, offset, 1, s_num);\r\noffset++;\r\npr_len--;\r\ns_type = tvb_get_guint8(tvb, offset);\r\ntype_str = val_to_str_const(s_type, cops_s_type_vals, "Unknown");\r\nproto_tree_add_uint_format_value(obj_tree, hf_cops_obj_s_type, tvb, offset, 1, s_type,\r\n"%s%s%u%s",\r\ntype_str,\r\nstrlen(type_str) ? " (" : "",\r\ns_type,\r\nstrlen(type_str) ? ")" : "");\r\noffset++;\r\npr_len--;\r\ncontents_len = object_len - COPS_OBJECT_HDR_SIZE;\r\nret = dissect_cops_pr_object_data(tvb, pinfo, offset, obj_tree, s_num, s_type, contents_len,\r\noid_info_p, pprid_subids_p, pprid_subids_len_p);\r\nif (ret < 0)\r\nbreak;\r\nif (object_len % sizeof (guint32))\r\nobject_len += ((int)sizeof (guint32) - object_len % (int)sizeof (guint32));\r\npr_len -= object_len - COPS_OBJECT_HDR_SIZE;\r\noffset += object_len - COPS_OBJECT_HDR_SIZE;\r\n}\r\n}\r\nstatic void dissect_cops_object_data(tvbuff_t *tvb, packet_info *pinfo, guint32 offset, proto_tree *tree,\r\nguint8 op_code, guint16 client_type, guint8 c_num, guint8 c_type, int len, guint32* handle_value)\r\n{\r\nproto_item *ti;\r\nproto_tree *r_type_tree, *itf_tree, *reason_tree, *dec_tree, *error_tree, *clientsi_tree, *pdp_tree;\r\nguint16 r_type, m_type, reason, reason_sub, cmd_code, cmd_flags, error, error_sub,\r\ntcp_port, katimer, accttimer;\r\nguint32 ifindex;\r\nstruct e_in6_addr ipv6addr;\r\noid_info_t* oid_info = NULL;\r\nguint32* pprid_subids = NULL;\r\nguint pprid_subids_len = 0;\r\nswitch (c_num) {\r\ncase COPS_OBJ_HANDLE:\r\nif (len >= 4) {\r\noffset += (len-4);\r\n*handle_value = tvb_get_ntohl(tvb, offset);\r\nproto_tree_add_item(tree, hf_cops_handle, tvb, offset, 4, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase COPS_OBJ_CONTEXT:\r\nr_type = tvb_get_ntohs(tvb, offset);\r\nm_type = tvb_get_ntohs(tvb, offset + 2);\r\nr_type_tree = proto_tree_add_subtree_format(tree, tvb, offset, 4, ett_cops_r_type_flags, NULL,\r\n"Contents: R-Type: %s, M-Type: %u",\r\nval_to_str_const(r_type, cops_r_type_vals, "Unknown"), m_type);\r\nproto_tree_add_uint(r_type_tree, hf_cops_r_type_flags, tvb, offset, 2, r_type);\r\noffset += 2;\r\nproto_tree_add_uint(r_type_tree, hf_cops_m_type_flags, tvb, offset, 2, m_type);\r\nbreak;\r\ncase COPS_OBJ_IN_INT:\r\ncase COPS_OBJ_OUT_INT:\r\nif (c_type == 1) {\r\nifindex = tvb_get_ntohl(tvb, offset + 4);\r\nitf_tree = proto_tree_add_subtree_format(tree, tvb, offset, 8, ett_cops_itf, NULL,\r\n"Contents: IPv4 address %s, ifIndex: %u",\r\ntvb_ip_to_str(tvb, offset), ifindex);\r\nproto_tree_add_item(itf_tree,\r\n(c_num == COPS_OBJ_IN_INT) ? hf_cops_in_int_ipv4 : hf_cops_out_int_ipv4,\r\ntvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\n} else if (c_type == 2) {\r\nifindex = tvb_get_ntohl(tvb, offset + (int)sizeof ipv6addr);\r\nitf_tree = proto_tree_add_subtree_format(tree, tvb, offset, 20, ett_cops_itf, NULL,\r\n"Contents: IPv6 address %s, ifIndex: %u",\r\ntvb_ip6_to_str(tvb, offset), ifindex);\r\nproto_tree_add_item(itf_tree,\r\n(c_num == COPS_OBJ_IN_INT) ? hf_cops_in_int_ipv6 : hf_cops_out_int_ipv6,\r\ntvb, offset, 16, ENC_NA);\r\noffset += 16;\r\n} else {\r\nbreak;\r\n}\r\nproto_tree_add_uint(itf_tree, hf_cops_int_ifindex, tvb, offset, 4, ifindex);\r\nbreak;\r\ncase COPS_OBJ_REASON:\r\nreason = tvb_get_ntohs(tvb, offset);\r\nreason_sub = tvb_get_ntohs(tvb, offset + 2);\r\nreason_tree = proto_tree_add_subtree_format(tree, tvb, offset, 4, ett_cops_reason, NULL,\r\n"Contents: Reason-Code: %s, Reason Sub-code: 0x%04x",\r\nval_to_str_const(reason, cops_reason_vals, "<Unknown value>"), reason_sub);\r\nproto_tree_add_uint(reason_tree, hf_cops_reason, tvb, offset, 2, reason);\r\noffset += 2;\r\nif (reason == 13) {\r\nproto_tree_add_uint_format_value(reason_tree, hf_cops_reason_sub, tvb, offset, 2,\r\nreason_sub, "Unknown object's C-Num %u, C-Type %u",\r\ntvb_get_guint8(tvb, offset), tvb_get_guint8(tvb, offset + 1));\r\n} else\r\nproto_tree_add_uint(reason_tree, hf_cops_reason_sub, tvb, offset, 2, reason_sub);\r\nbreak;\r\ncase COPS_OBJ_DECISION:\r\ncase COPS_OBJ_LPDPDECISION:\r\nif (c_type == 1) {\r\ncmd_code = tvb_get_ntohs(tvb, offset);\r\ncmd_flags = tvb_get_ntohs(tvb, offset + 2);\r\ndec_tree = proto_tree_add_subtree_format(tree, tvb, offset, 4, ett_cops_decision, NULL, "Contents: Command-Code: %s, Flags: %s",\r\nval_to_str_const(cmd_code, cops_dec_cmd_code_vals, "<Unknown value>"),\r\nval_to_str_const(cmd_flags, cops_dec_cmd_flag_vals, "<Unknown flag>"));\r\nproto_tree_add_uint(dec_tree, hf_cops_dec_cmd_code, tvb, offset, 2, cmd_code);\r\noffset += 2;\r\nproto_tree_add_uint(dec_tree, hf_cops_dec_flags, tvb, offset, 2, cmd_flags);\r\n} else if (c_type == 5) {\r\ndec_tree = proto_tree_add_subtree_format(tree, tvb, offset, len, ett_cops_decision, NULL, "Contents: %d bytes", len);\r\ndissect_cops_pr_objects(tvb, pinfo, offset, dec_tree, len, &oid_info, &pprid_subids, &pprid_subids_len);\r\n}\r\nif (client_type == COPS_CLIENT_PC_DQOS && c_type == 4) {\r\ncops_analyze_packetcable_dqos_obj(tvb, pinfo, tree, op_code, offset);\r\n} else if (client_type == COPS_CLIENT_PC_MM && c_type == 4) {\r\ncops_analyze_packetcable_mm_obj(tvb, pinfo, tree, op_code, offset);\r\n}\r\nbreak;\r\ncase COPS_OBJ_ERROR:\r\nif (c_type != 1)\r\nbreak;\r\nerror = tvb_get_ntohs(tvb, offset);\r\nerror_sub = tvb_get_ntohs(tvb, offset + 2);\r\nerror_tree = proto_tree_add_subtree_format(tree, tvb, offset, 4, ett_cops_error, NULL,\r\n"Contents: Error-Code: %s, Error Sub-code: 0x%04x",\r\nval_to_str_const(error, cops_error_vals, "<Unknown value>"), error_sub);\r\nproto_tree_add_uint(error_tree, hf_cops_error, tvb, offset, 2, error);\r\noffset += 2;\r\nif (error == 13) {\r\nproto_tree_add_uint_format_value(error_tree, hf_cops_error_sub, tvb, offset, 2,\r\nerror_sub, "Unknown object's C-Num %u, C-Type %u",\r\ntvb_get_guint8(tvb, offset), tvb_get_guint8(tvb, offset + 1));\r\n} else\r\nproto_tree_add_uint(error_tree, hf_cops_error_sub, tvb, offset, 2, error_sub);\r\nbreak;\r\ncase COPS_OBJ_CLIENTSI:\r\nif (client_type == COPS_CLIENT_PC_DQOS && c_type == 1) {\r\ncops_analyze_packetcable_dqos_obj(tvb, pinfo, tree, op_code, offset);\r\nbreak;\r\n} else if (client_type == COPS_CLIENT_PC_MM && c_type == 1) {\r\ncops_analyze_packetcable_mm_obj(tvb, pinfo, tree, op_code, offset);\r\nbreak;\r\n}\r\nif (c_type != 2)\r\nbreak;\r\nclientsi_tree = proto_tree_add_subtree_format(tree, tvb, offset, 4, ett_cops_clientsi, NULL, "Contents: %d bytes", len);\r\ndissect_cops_pr_objects(tvb, pinfo, offset, clientsi_tree, len, &oid_info, &pprid_subids, &pprid_subids_len);\r\nbreak;\r\ncase COPS_OBJ_KATIMER:\r\nif (c_type != 1)\r\nbreak;\r\nkatimer = tvb_get_ntohs(tvb, offset + 2);\r\nif (katimer == 0) {\r\nproto_tree_add_uint_format_value(tree, hf_cops_katimer, tvb, offset + 2, 2, katimer, "0 (infinity)");\r\n} else {\r\nproto_tree_add_item(tree, hf_cops_katimer, tvb, offset + 2, 2, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase COPS_OBJ_PEPID:\r\nif (c_type != 1)\r\nbreak;\r\nif (tvb_strnlen(tvb, offset, len) == -1) {\r\nti = proto_tree_add_item(tree, hf_cops_pepid, tvb, offset, len, ENC_ASCII|ENC_NA);\r\nexpert_add_info(pinfo, ti, &ei_cops_pepid_not_null);\r\n}\r\nelse\r\nproto_tree_add_item(tree, hf_cops_pepid, tvb, offset,\r\ntvb_strnlen(tvb, offset, len) + 1, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase COPS_OBJ_REPORT_TYPE:\r\nif (c_type != 1)\r\nbreak;\r\nproto_tree_add_item(tree, hf_cops_report_type, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase COPS_OBJ_PDPREDIRADDR:\r\ncase COPS_OBJ_LASTPDPADDR:\r\nif (c_type == 1) {\r\ntcp_port = tvb_get_ntohs(tvb, offset + 4 + 2);\r\npdp_tree = proto_tree_add_subtree_format(tree, tvb, offset, 8, ett_cops_pdp, NULL,\r\n"Contents: IPv4 address %s, TCP Port Number: %u",\r\ntvb_ip_to_str(tvb, offset), tcp_port);\r\nproto_tree_add_item(pdp_tree,\r\n(c_num == COPS_OBJ_PDPREDIRADDR) ? hf_cops_pdprediraddr_ipv4 : hf_cops_lastpdpaddr_ipv4,\r\ntvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\n} else if (c_type == 2) {\r\ntcp_port = tvb_get_ntohs(tvb, offset + (int)sizeof ipv6addr + 2);\r\npdp_tree = proto_tree_add_subtree_format(tree, tvb, offset, 20, ett_cops_pdp, NULL,\r\n"Contents: IPv6 address %s, TCP Port Number: %u",\r\ntvb_ip6_to_str(tvb, offset), tcp_port);\r\nproto_tree_add_item(pdp_tree,\r\n(c_num == COPS_OBJ_PDPREDIRADDR) ? hf_cops_pdprediraddr_ipv6 : hf_cops_lastpdpaddr_ipv6,\r\ntvb, offset, 16, ENC_NA);\r\noffset += 16;\r\n} else {\r\nbreak;\r\n}\r\noffset += 2;\r\nproto_tree_add_uint(pdp_tree, hf_cops_pdp_tcp_port, tvb, offset, 2, tcp_port);\r\nbreak;\r\ncase COPS_OBJ_ACCTTIMER:\r\nif (c_type != 1)\r\nbreak;\r\naccttimer = tvb_get_ntohs(tvb, offset + 2);\r\nif (accttimer == 0) {\r\nproto_tree_add_uint_format_value(tree, hf_cops_accttimer, tvb, offset + 2, 2, accttimer,\r\n"0 (there SHOULD be no unsolicited accounting updates)");\r\n} else {\r\nproto_tree_add_item(tree, hf_cops_accttimer, tvb, offset + 2, 2, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase COPS_OBJ_INTEGRITY:\r\nif (c_type != 1)\r\nbreak;\r\nproto_tree_add_item(tree, hf_cops_key_id, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cops_seq_num, tvb, offset + 4, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cops_keyed_message_digest, tvb, offset + 8 , len - 8, ENC_NA);\r\nbreak;\r\ndefault:\r\nproto_tree_add_expert_format(tree, pinfo, &ei_cops_unknown_c_num, tvb, offset, len, "Unknown C-Num %d, Contents: %d bytes", c_num, len);\r\nbreak;\r\n}\r\n}\r\nstatic guint redecode_oid(guint32* pprid_subids, guint pprid_subids_len, guint8* encoded_subids, guint encoded_len, guint32** subids_p) {\r\nguint i;\r\nguint n = 0;\r\nguint32 subid = 0;\r\nguint32* subids;\r\nguint32* subid_overflow;\r\nfor (i=0; i<encoded_len; i++) { if (! (encoded_subids[i] & 0x80 )) n++; }\r\n*subids_p = subids = (guint32 *)wmem_alloc(wmem_packet_scope(), sizeof(guint32)*(n+pprid_subids_len));\r\nsubid_overflow = subids+n+pprid_subids_len;\r\nfor (i=0;i<pprid_subids_len;i++) subids[i] = pprid_subids[i];\r\nsubids += pprid_subids_len;\r\nfor (i=0; i<encoded_len; i++){\r\nguint8 byte = encoded_subids[i];\r\nsubid <<= 7;\r\nsubid |= byte & 0x7F;\r\nif (byte & 0x80) {\r\ncontinue;\r\n}\r\nDISSECTOR_ASSERT(subids < subid_overflow);\r\n*subids++ = subid;\r\nsubid = 0;\r\n}\r\nreturn pprid_subids_len+n;\r\n}\r\nstatic int dissect_cops_pr_object_data(tvbuff_t *tvb, packet_info *pinfo, guint32 offset, proto_tree *tree,\r\nguint8 s_num, guint8 s_type, int len,\r\noid_info_t** oid_info_p, guint32** pprid_subids, guint* pprid_subids_len) {\r\nproto_tree *asn_tree, *gperror_tree, *cperror_tree;\r\nguint16 gperror=0, gperror_sub=0, cperror=0, cperror_sub=0;\r\nasn1_ctx_t actx;\r\nmemset(&actx,0,sizeof(actx));\r\nactx.pinfo = pinfo;\r\nswitch (s_num){\r\ncase COPS_OBJ_PPRID: {\r\ntvbuff_t* oid_tvb = NULL;\r\nif (s_type != 1)\r\nbreak;\r\nasn_tree = proto_tree_add_subtree(tree, tvb, offset, len, ett_cops_asn1, NULL, "Contents:");\r\ndissect_ber_object_identifier(FALSE, &actx, asn_tree, tvb, offset, hf_cops_pprid_oid, &oid_tvb);\r\nif (oid_tvb) {\r\ngint encoid_len;\r\nguint8* encoid;\r\nencoid_len = tvb_reported_length_remaining(oid_tvb,0);\r\nif (encoid_len > 0) {\r\nencoid = (guint8*)tvb_memdup(wmem_packet_scope(),oid_tvb,0,encoid_len);\r\n(*pprid_subids_len) = oid_encoded2subid(wmem_packet_scope(), encoid, encoid_len, pprid_subids);\r\n}\r\n}\r\nbreak;\r\n}\r\ncase COPS_OBJ_PRID: {\r\nguint32* subids;\r\nguint subids_len;\r\nguint matched;\r\nguint left;\r\ngint8 ber_class;\r\ngboolean ber_pc;\r\ngint32 ber_tag;\r\nguint encoid_len;\r\nguint8* encoid;\r\noid_info_t* oid_info;\r\nif (s_type != 1) break;\r\nasn_tree = proto_tree_add_subtree(tree, tvb, offset, len, ett_cops_asn1, NULL, "Contents:");\r\noffset = get_ber_identifier(tvb, offset, &ber_class, &ber_pc, &ber_tag);\r\noffset = get_ber_length(tvb, offset, &encoid_len, NULL);\r\nencoid = (guint8*)tvb_memdup(wmem_packet_scope(),tvb,offset,encoid_len);\r\nif (*pprid_subids) {\r\nsubids_len = redecode_oid(*pprid_subids, *pprid_subids_len, encoid, encoid_len, &subids);\r\nencoid_len = oid_subid2encoded(wmem_packet_scope(), subids_len, subids, &encoid);\r\n} else {\r\nsubids_len = oid_encoded2subid(wmem_packet_scope(), encoid, encoid_len, &subids);\r\n}\r\nproto_tree_add_oid(asn_tree,hf_cops_prid_oid,tvb,offset,encoid_len,encoid);\r\noid_info = oid_get(subids_len, subids, &matched, &left);\r\nif (left <= 1 && oid_info->kind == OID_KIND_ROW) {\r\n*oid_info_p = oid_info;\r\n} else {\r\n*oid_info_p = NULL;\r\n}\r\nbreak;\r\n}\r\ncase COPS_OBJ_EPD: {\r\noid_info_t* oid_info;\r\nguint end_offset = offset + len;\r\nif (s_type != 1) break;\r\nasn_tree = proto_tree_add_subtree(tree, tvb, offset, len, ett_cops_asn1, NULL, "Contents:");\r\nif(*oid_info_p) {\r\nif ((*oid_info_p)->kind == OID_KIND_ROW) {\r\noid_info = (oid_info_t *)wmem_tree_lookup32((*oid_info_p)->children,1);\r\n} else {\r\noid_info = NULL;\r\n}\r\n} else {\r\noid_info = NULL;\r\n}\r\nwhile(offset < end_offset) {\r\ngint8 ber_class;\r\ngboolean ber_pc;\r\ngint32 ber_tag;\r\nguint32 ber_length;\r\ngboolean ber_ind;\r\nint hfid;\r\noffset = get_ber_identifier(tvb, offset, &ber_class, &ber_pc, &ber_tag);\r\noffset = get_ber_length(tvb, offset, &ber_length, &ber_ind);\r\nif (oid_info) {\r\nhfid = oid_info->value_hfid;\r\noid_info = (oid_info_t *)wmem_tree_lookup32((*oid_info_p)->children,oid_info->subid+1);\r\n} else\r\nhfid = cops_tag_cls2syntax( ber_tag, ber_class );\r\nswitch (proto_registrar_get_ftype(hfid)) {\r\ncase FT_INT8:\r\ncase FT_INT16:\r\ncase FT_INT24:\r\ncase FT_INT32:\r\ncase FT_INT64:\r\ncase FT_UINT8:\r\ncase FT_UINT16:\r\ncase FT_UINT24:\r\ncase FT_UINT32:\r\ncase FT_UINT64:\r\ncase FT_BOOLEAN:\r\ncase FT_FLOAT:\r\ncase FT_DOUBLE:\r\ncase FT_IPv4:\r\nproto_tree_add_item(asn_tree,hfid,tvb,offset,ber_length,ENC_BIG_ENDIAN);\r\nbreak;\r\ncase FT_STRING:\r\nproto_tree_add_item(asn_tree,hfid,tvb,offset,ber_length,ENC_ASCII|ENC_NA);\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(asn_tree,hfid,tvb,offset,ber_length,ENC_NA);\r\nbreak;\r\n}\r\noffset += ber_length;\r\n}\r\n(*oid_info_p) = NULL;\r\nbreak;\r\n}\r\ncase COPS_OBJ_ERRPRID: {\r\nif (s_type != 1) break;\r\nasn_tree = proto_tree_add_subtree(tree, tvb, offset, len, ett_cops_asn1, NULL, "Contents:");\r\ndissect_ber_object_identifier(FALSE, &actx, asn_tree, tvb, offset, hf_cops_errprid_oid, NULL);\r\nbreak;\r\n}\r\ncase COPS_OBJ_GPERR:\r\nif (s_type != 1)\r\nbreak;\r\ngperror = tvb_get_ntohs(tvb, offset);\r\ngperror_sub = tvb_get_ntohs(tvb, offset + 2);\r\ngperror_tree = proto_tree_add_subtree_format(tree, tvb, offset, 4, ett_cops_gperror, NULL,\r\n"Contents: Error-Code: %s, Error Sub-code: 0x%04x",\r\nval_to_str_const(gperror, cops_gperror_vals, "<Unknown value>"), gperror_sub);\r\nproto_tree_add_uint(gperror_tree, hf_cops_gperror, tvb, offset, 2, gperror);\r\noffset += 2;\r\nif (gperror == 13) {\r\nproto_tree_add_uint_format_value(gperror_tree, hf_cops_gperror_sub, tvb, offset, 2,\r\ngperror_sub, "Unknown object's C-Num %u, C-Type %u",\r\ntvb_get_guint8(tvb, offset), tvb_get_guint8(tvb, offset + 1));\r\n} else\r\nproto_tree_add_uint(gperror_tree, hf_cops_gperror_sub, tvb, offset, 2, gperror_sub);\r\nbreak;\r\ncase COPS_OBJ_CPERR:\r\nif (s_type != 1)\r\nbreak;\r\ncperror = tvb_get_ntohs(tvb, offset);\r\ncperror_sub = tvb_get_ntohs(tvb, offset + 2);\r\ncperror_tree = proto_tree_add_subtree_format(tree, tvb, offset, 4, ett_cops_gperror, NULL,\r\n"Contents: Error-Code: %s, Error Sub-code: 0x%04x",\r\nval_to_str_const(gperror, cops_gperror_vals, "<Unknown value>"), gperror_sub);\r\nproto_tree_add_uint(cperror_tree, hf_cops_cperror, tvb, offset, 2, cperror);\r\noffset += 2;\r\nif (cperror == 13) {\r\nproto_tree_add_uint_format_value(cperror_tree, hf_cops_cperror_sub, tvb, offset, 2, cperror_sub,\r\n"Unknown object's S-Num %u, C-Type %u",\r\ntvb_get_guint8(tvb, offset), tvb_get_guint8(tvb, offset + 1));\r\n} else\r\nproto_tree_add_uint(cperror_tree, hf_cops_cperror_sub, tvb, offset, 2, cperror_sub);\r\nbreak;\r\ndefault:\r\nproto_tree_add_bytes_format_value(tree, hf_cops_integrity_contents, tvb, offset, len, NULL, "%d bytes", len);\r\nbreak;\r\n}\r\nreturn 0;\r\n}\r\nvoid proto_register_cops(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_cops_ver_flags,\r\n{ "Version and Flags", "cops.ver_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\n"Version and Flags in COPS Common Header", HFILL }\r\n},\r\n{ &hf_cops_version,\r\n{ "Version", "cops.version",\r\nFT_UINT8, BASE_DEC, NULL, 0xF0,\r\n"Version in COPS Common Header", HFILL }\r\n},\r\n{ &hf_cops_flags,\r\n{ "Flags", "cops.flags",\r\nFT_UINT8, BASE_HEX, VALS(cops_flags_vals), 0x0F,\r\n"Flags in COPS Common Header", HFILL }\r\n},\r\n{ &hf_cops_response_in,\r\n{ "Response In", "cops.response_in",\r\nFT_FRAMENUM, BASE_NONE, NULL, 0x0,\r\n"The response to this COPS request is in this frame", HFILL }\r\n},\r\n{ &hf_cops_response_to,\r\n{ "Request In", "cops.response_to",\r\nFT_FRAMENUM, BASE_NONE, NULL, 0x0,\r\n"This is a response to the COPS request in this frame", HFILL }\r\n},\r\n{ &hf_cops_response_time,\r\n{ "Response Time", "cops.response_time",\r\nFT_RELATIVE_TIME, BASE_NONE, NULL, 0x0,\r\n"The time between the Call and the Reply", HFILL }\r\n},\r\n{ &hf_cops_op_code,\r\n{ "Op Code", "cops.op_code",\r\nFT_UINT8, BASE_DEC, VALS(cops_op_code_vals), 0x0,\r\n"Op Code in COPS Common Header", HFILL }\r\n},\r\n{ &hf_cops_client_type,\r\n{ "Client Type", "cops.client_type",\r\nFT_UINT16, BASE_DEC, VALS(cops_client_type_vals), 0x0,\r\n"Client Type in COPS Common Header", HFILL }\r\n},\r\n{ &hf_cops_msg_len,\r\n{ "Message Length", "cops.msg_len",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Message Length in COPS Common Header", HFILL }\r\n},\r\n{ &hf_cops_obj_len,\r\n{ "Object Length", "cops.obj.len",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Object Length in COPS Object Header", HFILL }\r\n},\r\n{ &hf_cops_obj_c_num,\r\n{ "C-Num", "cops.c_num",\r\nFT_UINT8, BASE_DEC, VALS(cops_c_num_vals), 0x0,\r\n"C-Num in COPS Object Header", HFILL }\r\n},\r\n{ &hf_cops_obj_c_type,\r\n{ "C-Type", "cops.c_type",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"C-Type in COPS Object Header", HFILL }\r\n},\r\n{ &hf_cops_obj_s_num,\r\n{ "S-Num", "cops.s_num",\r\nFT_UINT8, BASE_DEC, VALS(cops_s_num_vals), 0x0,\r\n"S-Num in COPS-PR Object Header", HFILL }\r\n},\r\n{ &hf_cops_obj_s_type,\r\n{ "S-Type", "cops.s_type",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"S-Type in COPS-PR Object Header", HFILL }\r\n},\r\n{ &hf_cops_handle,\r\n{ "Handle", "cops.handle",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\n"Handle in COPS Handle Object", HFILL }\r\n},\r\n{ &hf_cops_r_type_flags,\r\n{ "R-Type", "cops.context.r_type",\r\nFT_UINT16, BASE_HEX, VALS(cops_r_type_vals), 0xFFFF,\r\n"R-Type in COPS Context Object", HFILL }\r\n},\r\n{ &hf_cops_m_type_flags,\r\n{ "M-Type", "cops.context.m_type",\r\nFT_UINT16, BASE_HEX, NULL, 0xFFFF,\r\n"M-Type in COPS Context Object", HFILL }\r\n},\r\n{ &hf_cops_in_int_ipv4,\r\n{ "IPv4 address", "cops.in-int.ipv4",\r\nFT_IPv4, BASE_NONE, NULL, 0,\r\n"IPv4 address in COPS IN-Int object", HFILL }\r\n},\r\n{ &hf_cops_in_int_ipv6,\r\n{ "IPv6 address", "cops.in-int.ipv6",\r\nFT_IPv6, BASE_NONE, NULL, 0,\r\n"IPv6 address in COPS IN-Int object", HFILL }\r\n},\r\n{ &hf_cops_out_int_ipv4,\r\n{ "IPv4 address", "cops.out-int.ipv4",\r\nFT_IPv4, BASE_NONE, NULL, 0,\r\n"IPv4 address in COPS OUT-Int object", HFILL }\r\n},\r\n{ &hf_cops_out_int_ipv6,\r\n{ "IPv6 address", "cops.out-int.ipv6",\r\nFT_IPv6, BASE_NONE, NULL, 0,\r\n"IPv6 address in COPS OUT-Int", HFILL }\r\n},\r\n{ &hf_cops_int_ifindex,\r\n{ "ifIndex", "cops.in-out-int.ifindex",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"If SNMP is supported, corresponds to MIB-II ifIndex", HFILL }\r\n},\r\n{ &hf_cops_reason,\r\n{ "Reason", "cops.reason",\r\nFT_UINT16, BASE_DEC, VALS(cops_reason_vals), 0,\r\n"Reason in Reason object", HFILL }\r\n},\r\n{ &hf_cops_reason_sub,\r\n{ "Reason Sub-code", "cops.reason_sub",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"Reason Sub-code in Reason object", HFILL }\r\n},\r\n{ &hf_cops_dec_cmd_code,\r\n{ "Command-Code", "cops.decision.cmd",\r\nFT_UINT16, BASE_DEC, VALS(cops_dec_cmd_code_vals), 0,\r\n"Command-Code in Decision/LPDP Decision object", HFILL }\r\n},\r\n{ &hf_cops_dec_flags,\r\n{ "Flags", "cops.decision.flags",\r\nFT_UINT16, BASE_HEX, VALS(cops_dec_cmd_flag_vals), 0xffff,\r\n"Flags in Decision/LPDP Decision object", HFILL }\r\n},\r\n{ &hf_cops_error,\r\n{ "Error", "cops.error",\r\nFT_UINT16, BASE_DEC, VALS(cops_error_vals), 0,\r\n"Error in Error object", HFILL }\r\n},\r\n{ &hf_cops_error_sub,\r\n{ "Error Sub-code", "cops.error_sub",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"Error Sub-code in Error object", HFILL }\r\n},\r\n{ &hf_cops_katimer,\r\n{ "Contents: KA Timer Value", "cops.katimer.value",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n"Keep-Alive Timer Value in KATimer object", HFILL }\r\n},\r\n{ &hf_cops_pepid,\r\n{ "Contents: PEP Id", "cops.pepid.id",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\n"PEP Id in PEPID object", HFILL }\r\n},\r\n{ &hf_cops_report_type,\r\n{ "Contents: Report-Type", "cops.report_type",\r\nFT_UINT16, BASE_DEC, VALS(cops_report_type_vals), 0,\r\n"Report-Type in Report-Type object", HFILL }\r\n},\r\n{ &hf_cops_pdprediraddr_ipv4,\r\n{ "IPv4 address", "cops.pdprediraddr.ipv4",\r\nFT_IPv4, BASE_NONE, NULL, 0,\r\n"IPv4 address in COPS PDPRedirAddr object", HFILL }\r\n},\r\n{ &hf_cops_pdprediraddr_ipv6,\r\n{ "IPv6 address", "cops.pdprediraddr.ipv6",\r\nFT_IPv6, BASE_NONE, NULL, 0,\r\n"IPv6 address in COPS PDPRedirAddr object", HFILL }\r\n},\r\n{ &hf_cops_lastpdpaddr_ipv4,\r\n{ "IPv4 address", "cops.lastpdpaddr.ipv4",\r\nFT_IPv4, BASE_NONE, NULL, 0,\r\n"IPv4 address in COPS LastPDPAddr object", HFILL }\r\n},\r\n{ &hf_cops_lastpdpaddr_ipv6,\r\n{ "IPv6 address", "cops.lastpdpaddr.ipv6",\r\nFT_IPv6, BASE_NONE, NULL, 0,\r\n"IPv6 address in COPS LastPDPAddr object", HFILL }\r\n},\r\n{ &hf_cops_pdp_tcp_port,\r\n{ "TCP Port Number", "cops.pdp.tcp_port",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"TCP Port Number of PDP in PDPRedirAddr/LastPDPAddr object", HFILL }\r\n},\r\n{ &hf_cops_accttimer,\r\n{ "Contents: ACCT Timer Value", "cops.accttimer.value",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n"Accounting Timer Value in AcctTimer object", HFILL }\r\n},\r\n{ &hf_cops_key_id,\r\n{ "Contents: Key ID", "cops.integrity.key_id",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"Key ID in Integrity object", HFILL }\r\n},\r\n{ &hf_cops_seq_num,\r\n{ "Contents: Sequence Number", "cops.integrity.seq_num",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"Sequence Number in Integrity object", HFILL }\r\n},\r\n{ &hf_cops_keyed_message_digest,\r\n{ "Contents: Keyed Message Digest", "cops.integrity.keyed_message_digest",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_integrity_contents,\r\n{ "Contents", "cops.integrity.contents",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_opaque_data,\r\n{ "Opaque Data", "cops.opaque_data",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_gperror,\r\n{ "Error", "cops.gperror",\r\nFT_UINT16, BASE_DEC, VALS(cops_gperror_vals), 0,\r\n"Error in Error object", HFILL }\r\n},\r\n{ &hf_cops_gperror_sub,\r\n{ "Error Sub-code", "cops.gperror_sub",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"Error Sub-code in Error object", HFILL }\r\n},\r\n{ &hf_cops_cperror,\r\n{ "Error", "cops.cperror",\r\nFT_UINT16, BASE_DEC, VALS(cops_cperror_vals), 0,\r\n"Error in Error object", HFILL }\r\n},\r\n{ &hf_cops_cperror_sub,\r\n{ "Error Sub-code", "cops.cperror_sub",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"Error Sub-code in Error object", HFILL }\r\n},\r\n{ &hf_cops_reserved8, { "Reserved", "cops.reserved", FT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL } },\r\n{ &hf_cops_reserved16, { "Reserved", "cops.reserved", FT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL } },\r\n{ &hf_cops_reserved24, { "Reserved", "cops.reserved", FT_UINT24, BASE_HEX, NULL, 0, NULL, HFILL } },\r\n{ &hf_cops_prid_oid, { "PRID Instance Identifier", "cops.prid.instance_id", FT_OID, BASE_NONE, NULL, 0, NULL, HFILL } },\r\n{ &hf_cops_pprid_oid, { "Prefix Identifier", "cops.pprid.prefix_id", FT_OID, BASE_NONE, NULL, 0, NULL, HFILL } },\r\n{ &hf_cops_errprid_oid, { "ErrorPRID Instance Identifier", "cops.errprid.instance_id", FT_OID, BASE_NONE, NULL, 0, NULL, HFILL } },\r\n{ &hf_cops_epd_unknown, { "EPD Unknown Data", "cops.epd.unknown", FT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL } },\r\n{ &hf_cops_epd_null, { "EPD Null Data", "cops.epd.null", FT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL } },\r\n{ &hf_cops_epd_int, { "EPD Integer Data", "cops.epd.int", FT_INT64, BASE_DEC, NULL, 0, NULL, HFILL } },\r\n{ &hf_cops_epd_octets, { "EPD Octet String Data", "cops.epd.octets", FT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL } },\r\n{ &hf_cops_epd_oid, { "EPD OID Data", "cops.epd.oid", FT_OID, BASE_NONE, NULL, 0, NULL, HFILL } },\r\n{ &hf_cops_epd_ipv4, { "EPD IPAddress Data", "cops.epd.ipv4", FT_IPv4, BASE_NONE, NULL, 0, NULL, HFILL } },\r\n{ &hf_cops_epd_u32, { "EPD Unsigned32 Data", "cops.epd.unsigned32", FT_UINT64, BASE_DEC, NULL, 0, NULL, HFILL } },\r\n{ &hf_cops_epd_ticks, { "EPD TimeTicks Data", "cops.epd.timeticks", FT_UINT64, BASE_DEC, NULL, 0, NULL, HFILL } },\r\n{ &hf_cops_epd_opaque, { "EPD Opaque Data", "cops.epd.opaque", FT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL } },\r\n{ &hf_cops_epd_i64, { "EPD Inetger64 Data", "cops.epd.integer64", FT_INT64, BASE_DEC, NULL, 0, NULL, HFILL } },\r\n{ &hf_cops_epd_u64, { "EPD Unsigned64 Data", "cops.epd.unsigned64", FT_UINT64, BASE_DEC, NULL, 0, NULL, HFILL } },\r\n{ &hf_cops_subtree,\r\n{ "Object Subtree", "cops.pc_subtree",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_ds_field,\r\n{ "DS Field (DSCP or TOS)", "cops.pc_ds_field",\r\nFT_UINT8, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_direction,\r\n{ "Direction", "cops.pc_direction",\r\nFT_UINT8, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_gate_spec_flags,\r\n{ "Flags", "cops.pc_gate_spec_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_protocol_id,\r\n{ "Protocol ID", "cops.pc_protocol_id",\r\nFT_UINT8, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_session_class,\r\n{ "Session Class", "cops.pc_session_class",\r\nFT_UINT8, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_algorithm,\r\n{ "Algorithm", "cops.pc_algorithm",\r\nFT_UINT16, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_cmts_ip_port,\r\n{ "CMTS IP Port", "cops.pc_cmts_ip_port",\r\nFT_UINT16, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_prks_ip_port,\r\n{ "PRKS IP Port", "cops.pc_prks_ip_port",\r\nFT_UINT16, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_srks_ip_port,\r\n{ "SRKS IP Port", "cops.pc_srks_ip_port",\r\nFT_UINT16, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_dest_port,\r\n{ "Destination IP Port", "cops.pc_dest_port",\r\nFT_UINT16, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_packetcable_err_code,\r\n{ "Error Code", "cops.pc_packetcable_err_code",\r\nFT_UINT16, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_packetcable_sub_code,\r\n{ "Error Sub Code", "cops.pc_packetcable_sub_code",\r\nFT_UINT16, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_remote_flags,\r\n{ "Flags", "cops.pc_remote_flags",\r\nFT_UINT16, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_close_subcode,\r\n{ "Reason Sub Code", "cops.pc_close_subcode",\r\nFT_UINT16, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_gate_command_type,\r\n{ "Gate Command Type", "cops.pc_gate_command_type",\r\nFT_UINT16, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_reason_code,\r\n{ "Reason Code", "cops.pc_reason_code",\r\nFT_UINT16, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_delete_subcode,\r\n{ "Reason Sub Code", "cops.pc_delete_subcode",\r\nFT_UINT16, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_src_port,\r\n{ "Source IP Port", "cops.pc_src_port",\r\nFT_UINT16, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_t1_value,\r\n{ "Timer T1 Value (sec)", "cops.pc_t1_value",\r\nFT_UINT16, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_t7_value,\r\n{ "Timer T7 Value (sec)", "cops.pc_t7_value",\r\nFT_UINT16, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_t8_value,\r\n{ "Timer T8 Value (sec)", "cops.pc_t8_value",\r\nFT_UINT16, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_transaction_id,\r\n{ "Transaction Identifier", "cops.pc_transaction_id",\r\nFT_UINT16, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_cmts_ip,\r\n{ "CMTS IP Address", "cops.pc_cmts_ip",\r\nFT_IPv4, BASE_NONE, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_prks_ip,\r\n{ "PRKS IP Address", "cops.pc_prks_ip",\r\nFT_IPv4, BASE_NONE, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_srks_ip,\r\n{ "SRKS IP Address", "cops.pc_srks_ip",\r\nFT_IPv4, BASE_NONE, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_dfcdc_ip,\r\n{ "DF IP Address CDC", "cops.pc_dfcdc_ip",\r\nFT_IPv4, BASE_NONE, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_dfccc_ip,\r\n{ "DF IP Address CCC", "cops.pc_dfccc_ip",\r\nFT_IPv4, BASE_NONE, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_dfcdc_ip_port,\r\n{ "DF IP Port CDC", "cops.pc_dfcdc_ip_port",\r\nFT_UINT16, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_dfccc_ip_port,\r\n{ "DF IP Port CCC", "cops.pc_dfccc_ip_port",\r\nFT_UINT16, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_dfccc_id,\r\n{ "CCC ID", "cops.pc_dfccc_id",\r\nFT_UINT32, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_activity_count,\r\n{ "Count", "cops.pc_activity_count",\r\nFT_UINT32, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_dest_ip,\r\n{ "Destination IP Address", "cops.pc_dest_ip",\r\nFT_IPv4, BASE_NONE, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_gate_id,\r\n{ "Gate Identifier", "cops.pc_gate_id",\r\nFT_UINT32, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_max_packet_size,\r\n{ "Maximum Packet Size", "cops.pc_max_packet_size",\r\nFT_UINT32, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_min_policed_unit,\r\n{ "Minimum Policed Unit", "cops.pc_min_policed_unit",\r\nFT_UINT32, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_peak_data_rate,\r\n{ "Peak Data Rate", "cops.pc_peak_data_rate",\r\nFT_FLOAT, BASE_NONE, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_spec_rate,\r\n{ "Rate", "cops.pc_spec_rate",\r\nFT_FLOAT, BASE_NONE, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_remote_gate_id,\r\n{ "Remote Gate ID", "cops.pc_remote_gate_id",\r\nFT_UINT32, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_reserved,\r\n{ "Reserved", "cops.pc_reserved",\r\nFT_UINT32, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_key,\r\n{ "Security Key", "cops.pc_key",\r\nFT_UINT32, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_slack_term,\r\n{ "Slack Term", "cops.pc_slack_term",\r\nFT_UINT32, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_src_ip,\r\n{ "Source IP Address", "cops.pc_src_ip",\r\nFT_IPv4, BASE_NONE, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_subscriber_id_ipv4,\r\n{ "Subscriber Identifier (IPv4)", "cops.pc_subscriber_id4",\r\nFT_IPv4, BASE_NONE, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_subscriber_id_ipv6,\r\n{ "Subscriber Identifier (IPv6)", "cops.pc_subscriber_id6",\r\nFT_IPv6, BASE_NONE, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_token_bucket_rate,\r\n{ "Token Bucket Rate", "cops.pc_token_bucket_rate",\r\nFT_FLOAT, BASE_NONE, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_token_bucket_size,\r\n{ "Token Bucket Size", "cops.pc_token_bucket_size",\r\nFT_FLOAT, BASE_NONE, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_bcid_id,\r\n{ "BCID - Element ID", "cops.pc_bcid.id",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_bcid_tz,\r\n{ "BCID - Time Zone", "cops.pc_bcid.tz",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pc_bcid_ts,\r\n{ "BDID Timestamp", "cops.pc_bcid_ts",\r\nFT_UINT32, BASE_HEX, NULL, 0x00,\r\n"BCID Timestamp", HFILL }\r\n},\r\n{ &hf_cops_pc_bcid_ev,\r\n{ "BDID Event Counter", "cops.pc_bcid_ev",\r\nFT_UINT32, BASE_HEX, NULL, 0x00,\r\n"BCID Event Counter", HFILL }\r\n},\r\n{ &hf_cops_pcmm_amid_app_type,\r\n{ "AMID Application Type", "cops.pc_mm_amid_application_type",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia AMID Application Type", HFILL }\r\n},\r\n{ &hf_cops_pcmm_amid_am_tag,\r\n{ "AMID Application Manager Tag", "cops.pc_mm_amid_am_tag",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia AMID Application Manager Tag", HFILL }\r\n},\r\n{ &hf_cops_pcmm_gate_spec_flags,\r\n{ "Flags", "cops.pc_mm_gs_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\n"PacketCable Multimedia GateSpec Flags", HFILL }\r\n},\r\n{ &hf_cops_pcmm_gate_spec_flags_gate,\r\n{ "Gate", "cops.pc_mm_gs_flags.gate",\r\nFT_BOOLEAN, 8, TFS(&tfs_upstream_downstream), 0x1,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pcmm_gate_spec_flags_dscp_overwrite,\r\n{ "DSCP/TOS overwrite", "cops.pc_mm_gs_flags.dscp_overwrite",\r\nFT_BOOLEAN, 8, TFS(&tfs_enabled_disabled), 0x2,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pcmm_gate_spec_dscp_tos_field,\r\n{ "DSCP/TOS Field", "cops.pc_mm_gs_dscp",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\n"PacketCable Multimedia GateSpec DSCP/TOS Field", HFILL }\r\n},\r\n{ &hf_cops_pcmm_gate_spec_dscp_tos_mask,\r\n{ "DSCP/TOS Mask", "cops.pc_mm_gs_dscp_mask",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\n"PacketCable Multimedia GateSpec DSCP/TOS Mask", HFILL }\r\n},\r\n{ &hf_cops_pcmm_gate_spec_session_class_id,\r\n{ "SessionClassID", "cops.pc_mm_gs_scid",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia GateSpec SessionClassID", HFILL }\r\n},\r\n{ &hf_cops_pcmm_gate_spec_session_class_id_priority,\r\n{ "SessionClassID Priority", "cops.pc_mm_gs_scid_prio",\r\nFT_UINT8, BASE_DEC, NULL, 0x07,\r\n"PacketCable Multimedia GateSpec SessionClassID Priority", HFILL }\r\n},\r\n{ &hf_cops_pcmm_gate_spec_session_class_id_preemption,\r\n{ "SessionClassID Preemption", "cops.pc_mm_gs_scid_preempt",\r\nFT_UINT8, BASE_DEC, NULL, 0x08,\r\n"PacketCable Multimedia GateSpec SessionClassID Preemption", HFILL }\r\n},\r\n{ &hf_cops_pcmm_gate_spec_session_class_id_configurable,\r\n{ "SessionClassID Configurable", "cops.pc_mm_gs_scid_conf",\r\nFT_UINT8, BASE_DEC, NULL, 0xf0,\r\n"PacketCable Multimedia GateSpec SessionClassID Configurable", HFILL }\r\n},\r\n{ &hf_cops_pcmm_gate_spec_timer_t1,\r\n{ "Timer T1", "cops.pc_mm_gs_timer_t1",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia GateSpec Timer T1", HFILL }\r\n},\r\n{ &hf_cops_pcmm_gate_spec_timer_t2,\r\n{ "Timer T2", "cops.pc_mm_gs_timer_t2",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia GateSpec Timer T2", HFILL }\r\n},\r\n{ &hf_cops_pcmm_gate_spec_timer_t3,\r\n{ "Timer T3", "cops.pc_mm_gs_timer_t3",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia GateSpec Timer T3", HFILL }\r\n},\r\n{ &hf_cops_pcmm_gate_spec_timer_t4,\r\n{ "Timer T4", "cops.pc_mm_gs_timer_t4",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia GateSpec Timer T4", HFILL }\r\n},\r\n{ &hf_cops_pcmm_classifier_protocol_id,\r\n{ "Protocol ID", "cops.pc_mm_classifier_proto_id",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"PacketCable Multimedia Classifier Protocol ID", HFILL }\r\n},\r\n{ &hf_cops_pcmm_classifier_dscp_tos_field,\r\n{ "DSCP/TOS Field", "cops.pc_mm_classifier_dscp",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\n"PacketCable Multimedia Classifier DSCP/TOS Field", HFILL }\r\n},\r\n{ &hf_cops_pcmm_classifier_dscp_tos_mask,\r\n{ "DSCP/TOS Mask", "cops.pc_mm_classifier_dscp_mask",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\n"PacketCable Multimedia Classifier DSCP/TOS Mask", HFILL }\r\n},\r\n{ &hf_cops_pcmm_classifier_src_addr,\r\n{ "Source address", "cops.pc_mm_classifier_src_addr",\r\nFT_IPv4, BASE_NONE, NULL, 0,\r\n"PacketCable Multimedia Classifier Source IP Address", HFILL }\r\n},\r\n{ &hf_cops_pcmm_classifier_src_mask,\r\n{ "Source mask", "cops.pc_mm_classifier_src_mask",\r\nFT_IPv4, BASE_NONE, NULL, 0,\r\n"PacketCable Multimedia Classifier Source Mask", HFILL }\r\n},\r\n{ &hf_cops_pcmm_classifier_dst_addr,\r\n{ "Destination address", "cops.pc_mm_classifier_dst_addr",\r\nFT_IPv4, BASE_NONE, NULL, 0,\r\n"PacketCable Multimedia Classifier Destination IP Address", HFILL }\r\n},\r\n{ &hf_cops_pcmm_classifier_dst_mask,\r\n{ "Destination mask", "cops.pc_mm_classifier_dst_mask",\r\nFT_IPv4, BASE_NONE, NULL, 0,\r\n"PacketCable Multimedia Classifier Destination Mask", HFILL }\r\n},\r\n{ &hf_cops_pcmm_classifier_src_port,\r\n{ "Source Port", "cops.pc_mm_classifier_src_port",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Classifier Source Port", HFILL }\r\n},\r\n{ &hf_cops_pcmm_classifier_src_port_end,\r\n{ "Source Port End", "cops.pc_mm_classifier_src_port_end",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Classifier Source Port End", HFILL }\r\n},\r\n{ &hf_cops_pcmm_classifier_dst_port,\r\n{ "Destination Port", "cops.pc_mm_classifier_dst_port",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Classifier Source Port", HFILL }\r\n},\r\n{ &hf_cops_pcmm_classifier_dst_port_end,\r\n{ "Destination Port End", "cops.pc_mm_classifier_dst_port_end",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Classifier Source Port End", HFILL }\r\n},\r\n{ &hf_cops_pcmm_classifier_priority,\r\n{ "Priority", "cops.pc_mm_classifier_priority",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\n"PacketCable Multimedia Classifier Priority", HFILL }\r\n},\r\n{ &hf_cops_pcmm_classifier_classifier_id,\r\n{ "Classifier Id", "cops.pc_mm_classifier_id",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"PacketCable Multimedia Classifier ID", HFILL }\r\n},\r\n{ &hf_cops_pcmm_classifier_activation_state,\r\n{ "Activation State", "cops.pc_mm_classifier_activation_state",\r\nFT_UINT8, BASE_HEX, VALS(pcmm_activation_state_vals), 0,\r\n"PacketCable Multimedia Classifier Activation State", HFILL }\r\n},\r\n{ &hf_cops_pcmm_classifier_action,\r\n{ "Action", "cops.pc_mm_classifier_action",\r\nFT_UINT8, BASE_HEX, VALS(pcmm_action_vals), 0,\r\n"PacketCable Multimedia Classifier Action", HFILL }\r\n},\r\n{ &hf_cops_pcmm_classifier_flags,\r\n{ "Flags", "cops.pc_mm_classifier_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\n"PacketCable Multimedia Classifier Flags", HFILL }\r\n},\r\n{ &hf_cops_pcmm_classifier_tc_low,\r\n{ "tc-low", "cops.pc_mm_classifier_tc_low",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\n"PacketCable Multimedia Classifier tc-low", HFILL }\r\n},\r\n{ &hf_cops_pcmm_classifier_tc_high,\r\n{ "tc-high", "cops.pc_mm_classifier_tc_high",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\n"PacketCable Multimedia Classifier tc-high", HFILL }\r\n},\r\n{ &hf_cops_pcmm_classifier_tc_mask,\r\n{ "tc-mask", "cops.pc_mm_classifier_tc_mask",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\n"PacketCable Multimedia Classifier tc-mask", HFILL }\r\n},\r\n{ &hf_cops_pcmm_classifier_flow_label,\r\n{ "Flow Label", "cops.pc_mm_classifier_flow_label",\r\nFT_UINT32, BASE_HEX, NULL, 0,\r\n"PacketCable Multimedia Classifier Flow Label", HFILL }\r\n},\r\n{ &hf_cops_pcmm_classifier_next_header_type,\r\n{ "Next Header Type", "cops.pc_mm_classifier_next_header_type",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"PacketCable Multimedia Classifier Next Header Type", HFILL }\r\n},\r\n{ &hf_cops_pcmm_classifier_source_prefix_length,\r\n{ "Source Prefix Length", "cops.pc_mm_classifier_source_prefix_length",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\n"PacketCable Multimedia Classifier Source Prefix Length", HFILL }\r\n},\r\n{ &hf_cops_pcmm_classifier_destination_prefix_length,\r\n{ "Destination Prefix Length", "cops.pc_mm_classifier_destination_prefix_length",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\n"PacketCable Multimedia Classifier Destination Prefix Length", HFILL }\r\n},\r\n{ &hf_cops_pcmm_classifier_src_addr_v6,\r\n{ "IPv6 Source Address", "cops.pc_mm_classifier_src_addr_v6",\r\nFT_IPv6, BASE_NONE, NULL, 0,\r\n"PacketCable Multimedia Classifier IPv6 Source Address", HFILL }\r\n},\r\n{ &hf_cops_pcmm_classifier_dst_addr_v6,\r\n{ "IPv6 Destination Address", "cops.pc_mm_classifier_dst_addr_v6",\r\nFT_IPv6, BASE_NONE, NULL, 0,\r\n"PacketCable Multimedia Classifier IPv6 Destination Address", HFILL }\r\n},\r\n{ &hf_cops_pcmm_flow_spec_envelope,\r\n{ "Envelope", "cops.pc_mm_fs_envelope",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Flow Spec Envelope", HFILL }\r\n},\r\n{ &hf_cops_pcmm_flow_spec_service_number,\r\n{ "Service Number", "cops.pc_mm_fs_svc_num",\r\nFT_UINT8, BASE_DEC, VALS(pcmm_flow_spec_service_vals), 0,\r\n"PacketCable Multimedia Flow Spec Service Number", HFILL }\r\n},\r\n{ &hf_cops_pcmm_docsis_scn,\r\n{ "Service Class Name", "cops.pc_mm_docsis_scn",\r\nFT_STRINGZ, BASE_NONE, NULL, 0,\r\n"PacketCable Multimedia DOCSIS Service Class Name", HFILL }\r\n},\r\n{ &hf_cops_pcmm_envelope,\r\n{ "Envelope", "cops.pc_mm_envelope",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Envelope", HFILL }\r\n},\r\n{ &hf_cops_pcmm_traffic_priority,\r\n{ "Traffic Priority", "cops.pc_mm_tp",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Committed Envelope Traffic Priority", HFILL }\r\n},\r\n{ &hf_cops_pcmm_request_transmission_policy,\r\n{ "Request Transmission Policy", "cops.pc_mm_rtp",\r\nFT_UINT32, BASE_HEX, NULL, 0,\r\n"PacketCable Multimedia Committed Envelope Traffic Priority", HFILL }\r\n},\r\n{ &hf_cops_pcmm_request_transmission_policy_sf_all_cm,\r\n{ "The Service Flow MUST NOT use \"all CMs\" broadcast request opportunities", "cops.pc_mm_rtp.sf.all_cm",\r\nFT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0001,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pcmm_request_transmission_policy_sf_priority,\r\n{ "The Service Flow MUST NOT use Priority Request multicast request opportunities", "cops.pc_mm_rtp.sf.priority",\r\nFT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0002,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pcmm_request_transmission_policy_sf_request_for_request,\r\n{ "The Service Flow MUST NOT use Request/Data opportunities for Requests", "cops.pc_mm_rtp.sf.request_for_request",\r\nFT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0004,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pcmm_request_transmission_policy_sf_data_for_data,\r\n{ "The Service Flow MUST NOT use Request/Data opportunities for Data", "cops.pc_mm_rtp.sf.data_for_data",\r\nFT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0008,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pcmm_request_transmission_policy_sf_piggyback,\r\n{ "The Service Flow MUST NOT piggyback requests with data", "cops.pc_mm_rtp.sf.piggyback",\r\nFT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0010,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pcmm_request_transmission_policy_sf_concatenate,\r\n{ "The Service Flow MUST NOT concatenate data", "cops.pc_mm_rtp.sf.concatenate",\r\nFT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0020,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pcmm_request_transmission_policy_sf_fragment,\r\n{ "The Service Flow MUST NOT fragment data", "cops.pc_mm_rtp.sf.fragment",\r\nFT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0040,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pcmm_request_transmission_policy_sf_supress,\r\n{ "The Service Flow MUST NOT suppress payload headers", "cops.pc_mm_rtp.sf.supress",\r\nFT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0080,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pcmm_request_transmission_policy_sf_drop_packets,\r\n{ "The Service Flow MUST drop packets that do not fit in the Unsolicited Grant Size", "cops.pc_mm_rtp.sf.drop_packets",\r\nFT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x0100,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cops_pcmm_max_sustained_traffic_rate,\r\n{ "Maximum Sustained Traffic Rate", "cops.pc_mm_mstr",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Committed Envelope Maximum Sustained Traffic Rate", HFILL }\r\n},\r\n{ &hf_cops_pcmm_max_traffic_burst,\r\n{ "Maximum Traffic Burst", "cops.pc_mm_mtb",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Committed Envelope Maximum Traffic Burst", HFILL }\r\n},\r\n{ &hf_cops_pcmm_min_reserved_traffic_rate,\r\n{ "Minimum Reserved Traffic Rate", "cops.pc_mm_mrtr",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Committed Envelope Minimum Reserved Traffic Rate", HFILL }\r\n},\r\n{ &hf_cops_pcmm_ass_min_rtr_packet_size,\r\n{ "Assumed Minimum Reserved Traffic Rate Packet Size", "cops.pc_mm_amrtrps",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Committed Envelope Assumed Minimum Reserved Traffic Rate Packet Size", HFILL }\r\n},\r\n{ &hf_cops_pcmm_max_concat_burst,\r\n{ "Maximum Concatenated Burst", "cops.pc_mm_mcburst",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Committed Envelope Maximum Concatenated Burst", HFILL }\r\n},\r\n{ &hf_cops_pcmm_req_att_mask,\r\n{ "Required Attribute Mask", "cops.pc_mm_ramask",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Committed Envelope Required Attribute Mask", HFILL }\r\n},\r\n{ &hf_cops_pcmm_forbid_att_mask,\r\n{ "Forbidden Attribute Mask", "cops.pc_mm_famask",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Committed Envelope Forbidden Attribute Mask", HFILL }\r\n},\r\n{ &hf_cops_pcmm_att_aggr_rule_mask,\r\n{ "Attribute Aggregation Rule Mask", "cops.pc_mm_aarmask",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Committed Envelope Attribute Aggregation Rule Mask", HFILL }\r\n},\r\n{ &hf_cops_pcmm_nominal_polling_interval,\r\n{ "Nominal Polling Interval", "cops.pc_mm_npi",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Nominal Polling Interval", HFILL }\r\n},\r\n{ &hf_cops_pcmm_tolerated_poll_jitter,\r\n{ "Tolerated Poll Jitter", "cops.pc_mm_tpj",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Tolerated Poll Jitter", HFILL }\r\n},\r\n{ &hf_cops_pcmm_unsolicited_grant_size,\r\n{ "Unsolicited Grant Size", "cops.pc_mm_ugs",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Unsolicited Grant Size", HFILL }\r\n},\r\n{ &hf_cops_pcmm_grants_per_interval,\r\n{ "Grants Per Interval", "cops.pc_mm_gpi",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Grants Per Interval", HFILL }\r\n},\r\n{ &hf_cops_pcmm_nominal_grant_interval,\r\n{ "Nominal Grant Interval", "cops.pc_mm_ngi",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Nominal Grant Interval", HFILL }\r\n},\r\n{ &hf_cops_pcmm_tolerated_grant_jitter,\r\n{ "Tolerated Grant Jitter", "cops.pc_mm_tgj",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Tolerated Grant Jitter", HFILL }\r\n},\r\n{ &hf_cops_pcmm_down_resequencing,\r\n{ "Downstream Resequencing", "cops.pc_mm_downres",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Downstream Resequencing", HFILL }\r\n},\r\n{ &hf_cops_pcmm_down_peak_traffic_rate,\r\n{ "Downstream Peak Traffic Rate", "cops.pc_mm_downpeak",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Downstream Peak Traffic Rate", HFILL }\r\n},\r\n{ &hf_cops_pcmm_max_downstream_latency,\r\n{ "Maximum Downstream Latency", "cops.pc_mm_mdl",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Maximum Downstream Latency", HFILL }\r\n},\r\n{ &hf_cops_pcmm_volume_based_usage_limit,\r\n{ "Usage Limit", "cops.pc_mm_vbul_ul",\r\nFT_UINT64, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Volume-Based Usage Limit", HFILL }\r\n},\r\n{ &hf_cops_pcmm_time_based_usage_limit,\r\n{ "Usage Limit", "cops.pc_mm_tbul_ul",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Time-Based Usage Limit", HFILL }\r\n},\r\n{ &hf_cops_pcmm_gate_time_info,\r\n{ "Gate Time Info", "cops.pc_mm_gti",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Gate Time Info", HFILL }\r\n},\r\n{ &hf_cops_pcmm_gate_usage_info,\r\n{ "Gate Usage Info", "cops.pc_mm_gui",\r\nFT_UINT64, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Gate Usage Info", HFILL }\r\n},\r\n{ &hf_cops_pcmm_packetcable_error_code,\r\n{ "Error-Code", "cops.pc_mm_error_ec",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia PacketCable-Error Error-Code", HFILL }\r\n},\r\n{ &hf_cops_pcmm_packetcable_error_subcode,\r\n{ "Error-code", "cops.pc_mm_error_esc",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"PacketCable Multimedia PacketCable-Error Error Sub-code", HFILL }\r\n},\r\n{ &hf_cops_pcmm_packetcable_gate_state,\r\n{ "State", "cops.pc_mm_gs_state",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Gate State", HFILL }\r\n},\r\n{ &hf_cops_pcmm_packetcable_gate_state_reason,\r\n{ "Reason", "cops.pc_mm_gs_reason",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"PacketCable Multimedia Gate State Reason", HFILL }\r\n},\r\n{ &hf_cops_pcmm_packetcable_version_info_major,\r\n{ "Major Version Number", "cops.pc_mm_vi_major",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Major Version Number", HFILL }\r\n},\r\n{ &hf_cops_pcmm_packetcable_version_info_minor,\r\n{ "Minor Version Number", "cops.pc_mm_vi_minor",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia Minor Version Number", HFILL }\r\n},\r\n{ &hf_cops_pcmm_psid,\r\n{ "PSID", "cops.pc_mm_psid",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"PacketCable Multimedia PSID", HFILL }\r\n},\r\n{ &hf_cops_pcmm_synch_options_report_type,\r\n{ "Report Type", "cops.pc_mm_synch_options_report_type",\r\nFT_UINT8, BASE_DEC, VALS(pcmm_report_type_vals), 0,\r\n"PacketCable Multimedia Synch Options Report Type", HFILL }\r\n},\r\n{ &hf_cops_pcmm_synch_options_synch_type,\r\n{ "Synch Type", "cops.pc_mm_synch_options_synch_type",\r\nFT_UINT8, BASE_DEC, VALS(pcmm_synch_type_vals), 0,\r\n"PacketCable Multimedia Synch Options Synch Type", HFILL }\r\n},\r\n{ &hf_cops_pcmm_msg_receipt_key,\r\n{ "Msg Receipt Key", "cops.pc_mm_msg_receipt_key",\r\nFT_UINT32, BASE_HEX, NULL, 0,\r\n"PacketCable Multimedia Msg Receipt Key", HFILL }\r\n},\r\n{ &hf_cops_pcmm_userid,\r\n{ "UserID", "cops.pc_mm_userid",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\n"PacketCable Multimedia UserID", HFILL }\r\n},\r\n{ &hf_cops_pcmm_sharedresourceid,\r\n{ "SharedResourceID", "cops.pc_mm_sharedresourceid",\r\nFT_UINT32, BASE_HEX, NULL, 0,\r\n"PacketCable Multimedia SharedResourceID", HFILL }\r\n},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_cops,\r\n&ett_cops_ver_flags,\r\n&ett_cops_obj,\r\n&ett_cops_pr_obj,\r\n&ett_cops_obj_data,\r\n&ett_cops_r_type_flags,\r\n&ett_cops_itf,\r\n&ett_cops_reason,\r\n&ett_cops_decision,\r\n&ett_cops_error,\r\n&ett_cops_clientsi,\r\n&ett_cops_asn1,\r\n&ett_cops_gperror,\r\n&ett_cops_cperror,\r\n&ett_cops_pdp,\r\n&ett_cops_subtree,\r\n&ett_docsis_request_transmission_policy,\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_cops_pepid_not_null, { "cops.pepid.not_null", PI_MALFORMED, PI_NOTE, "PEP Id is not a NULL terminated ASCII string", EXPFILL }},\r\n{ &ei_cops_trailing_garbage, { "cops.trailing_garbage", PI_UNDECODED, PI_NOTE, "Trailing garbage", EXPFILL }},\r\n{ &ei_cops_bad_cops_object_length, { "cops.bad_cops_object_length", PI_MALFORMED, PI_ERROR, "COPS object length is too short", EXPFILL }},\r\n{ &ei_cops_bad_cops_pr_object_length, { "cops.bad_cops_pr_object_length", PI_MALFORMED, PI_ERROR, "COPS-PR object length is too short", EXPFILL }},\r\n{ &ei_cops_unknown_c_num, { "cops.unknown_c_num", PI_UNDECODED, PI_NOTE, "Unknown C-Num value", EXPFILL }},\r\n#if 0\r\n{ &ei_cops_unknown_s_num, { "cops.unknown_s_num", PI_UNDECODED, PI_NOTE, "Unknown S-Num value", EXPFILL }},\r\n#endif\r\n};\r\nmodule_t* cops_module;\r\nexpert_module_t* expert_cops;\r\nproto_cops = proto_register_protocol("Common Open Policy Service",\r\n"COPS", "cops");\r\nproto_register_field_array(proto_cops, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_cops = expert_register_protocol(proto_cops);\r\nexpert_register_field_array(expert_cops, ei, array_length(ei));\r\nregister_dissector("cops", dissect_cops, proto_cops);\r\ncops_module = prefs_register_protocol(proto_cops, proto_reg_handoff_cops);\r\nprefs_register_uint_preference(cops_module,"tcp.cops_port",\r\n"COPS TCP Port",\r\n"Set the TCP port for COPS messages",\r\n10,&global_cops_tcp_port);\r\nprefs_register_bool_preference(cops_module, "desegment",\r\n"Reassemble COPS messages spanning multiple TCP segments",\r\n"Whether the COPS dissector should reassemble messages spanning multiple TCP segments."\r\n" To use this option, you must also enable \"Allow subdissectors to reassemble TCP streams\" in the TCP protocol settings.",\r\n&cops_desegment);\r\nprefs_register_bool_preference(cops_module, "packetcable",\r\n"Decode for PacketCable clients",\r\n"Decode the COPS messages using PacketCable clients. (Select port 2126)",\r\n&cops_packetcable);\r\nprefs_register_static_text_preference(cops_module, "info_pibs",\r\n"PIB settings can be changed in the Name Resolution preferences",\r\n"PIB settings can be changed in the Name Resolution preferences");\r\nprefs_register_obsolete_preference(cops_module, "typefrommib");\r\n}\r\nvoid proto_reg_handoff_cops(void)\r\n{\r\nstatic gboolean cops_prefs_initialized = FALSE;\r\nstatic dissector_handle_t cops_handle;\r\nstatic guint cops_tcp_port;\r\nif (!cops_prefs_initialized) {\r\ncops_handle = find_dissector("cops");\r\ndissector_add_uint("tcp.port", TCP_PORT_PKTCABLE_COPS, cops_handle);\r\ndissector_add_uint("tcp.port", TCP_PORT_PKTCABLE_MM_COPS, cops_handle);\r\ncops_prefs_initialized = TRUE;\r\n} else {\r\ndissector_delete_uint("tcp.port",cops_tcp_port,cops_handle);\r\n}\r\ncops_tcp_port = global_cops_tcp_port;\r\ndissector_add_uint("tcp.port", cops_tcp_port, cops_handle);\r\n}\r\nstatic proto_item *\r\ninfo_to_display(tvbuff_t *tvb, proto_item *stt, int offset, int octets, const char *str, const value_string *vsp, int mode,gint *hf_proto_parameter)\r\n{\r\nproto_item *pi = NULL;\r\nguint8 *codestr;\r\nguint8 code8 = 0;\r\nguint16 code16 = 0;\r\nguint32 codeipv4 = 0;\r\nguint32 code32 = 0;\r\nguint64 code64 = 0;\r\nfloat codefl = 0.0f;\r\nif (mode==FMT_STR) {\r\ncodestr = tvb_get_string_enc(wmem_packet_scope(), tvb, offset, octets, ENC_ASCII);\r\npi = proto_tree_add_string_format(stt, *hf_proto_parameter, tvb,\r\noffset, octets, codestr, "%-28s : %s", str, codestr);\r\nreturn pi;\r\n}\r\nswitch (octets) {\r\ncase 1:\r\ncode8 = tvb_get_guint8( tvb, offset );\r\nif (vsp == NULL) {\r\nif (mode==FMT_HEX)\r\npi = proto_tree_add_uint_format(stt, *hf_proto_parameter,tvb,\r\noffset, octets, code8,"%-28s : 0x%02x",str,code8);\r\nelse\r\npi = proto_tree_add_uint_format(stt, *hf_proto_parameter,tvb,\r\noffset, octets, code8,"%-28s : %u",str,code8);\r\n} else {\r\nif (mode==FMT_HEX)\r\npi = proto_tree_add_uint_format(\r\nstt, *hf_proto_parameter,tvb, offset, octets, code8,\r\n"%-28s : %s (0x%02x)",str,val_to_str_const(code8, vsp, "Unknown"),code8);\r\nelse\r\npi = proto_tree_add_uint_format(\r\nstt, *hf_proto_parameter,tvb, offset, octets, code8,\r\n"%-28s : %s (%u)",str,val_to_str_const(code8, vsp, "Unknown"),code8);\r\n}\r\nbreak;\r\ncase 2:\r\ncode16 = tvb_get_ntohs(tvb,offset);\r\nif (vsp == NULL) {\r\nif (mode==FMT_HEX)\r\npi = proto_tree_add_uint_format(stt, *hf_proto_parameter,tvb,\r\noffset, octets, code16,"%-28s : 0x%04x",str,code16);\r\nelse\r\npi = proto_tree_add_uint_format(stt, *hf_proto_parameter,tvb,\r\noffset, octets, code16,"%-28s : %u",str,code16);\r\n} else {\r\nif (mode==FMT_HEX)\r\npi = proto_tree_add_uint_format(stt, *hf_proto_parameter,tvb,\r\noffset, octets, code16,"%-28s : %s (0x%04x)", str,\r\nval_to_str(code16, vsp, "Unknown (0x%04x)"),code16);\r\nelse\r\npi = proto_tree_add_uint_format(\r\nstt, *hf_proto_parameter,tvb, offset, octets, code16,\r\n"%-28s : %s (%u)",str,val_to_str(code16, vsp, "Unknown (0x%04x)"),code16);\r\n}\r\nbreak;\r\ncase 4:\r\nswitch (mode) {\r\ncase FMT_FLT: codefl = tvb_get_ntohieee_float(tvb,offset);\r\nbreak;\r\ncase FMT_IPv4: codeipv4 = tvb_get_ipv4(tvb, offset);\r\nbreak;\r\ndefault: code32 = tvb_get_ntohl(tvb,offset);\r\n}\r\nif (vsp == NULL) {\r\nif (mode==FMT_HEX) {\r\npi = proto_tree_add_uint_format(stt, *hf_proto_parameter,tvb,\r\noffset, octets, code32,"%-28s : 0x%08x",str,code32);\r\nbreak;\r\n}\r\nif (mode==FMT_IPv4) {\r\npi = proto_tree_add_ipv4(stt, *hf_proto_parameter,tvb, offset, octets, codeipv4);\r\nbreak;\r\n}\r\nif (mode==FMT_FLT) {\r\npi = proto_tree_add_float_format(stt, *hf_proto_parameter,tvb, offset, octets,\r\ncodefl,"%-28s : %.10g",str,codefl);\r\nbreak;\r\n}\r\npi = proto_tree_add_uint_format(stt, *hf_proto_parameter,tvb, offset, octets,\r\ncode32,"%-28s : %u",str,code32);\r\n} else {\r\nif (mode==FMT_HEX)\r\npi = proto_tree_add_uint_format(stt, *hf_proto_parameter,tvb, offset, octets,\r\ncode32,"%-28s : %s (0x%08x)",str,val_to_str_const(code32, vsp, "Unknown"),code32);\r\nelse\r\npi = proto_tree_add_uint_format(stt, *hf_proto_parameter,tvb, offset, octets,\r\ncode32,"%-28s : %s (%u)",str,val_to_str_const(code32, vsp, "Unknown"),code32);\r\n}\r\nbreak;\r\ndefault:\r\nif (mode==FMT_HEX) {\r\npi = proto_tree_add_item(stt, *hf_proto_parameter,\r\ntvb, offset, octets, ENC_NA);\r\n} else if (mode==FMT_IPv6 && octets==16) {\r\npi = proto_tree_add_item(stt, *hf_proto_parameter, tvb, offset, octets,\r\nENC_NA);\r\n} else if (mode==FMT_DEC && octets==8) {\r\ncode64 = tvb_get_ntoh64(tvb, offset);\r\npi = proto_tree_add_uint64_format(stt, *hf_proto_parameter, tvb, offset, octets,\r\ncode64, "%-28s : %" G_GINT64_MODIFIER "u", str, code64);\r\n} else {\r\npi = proto_tree_add_uint_format(stt, *hf_proto_parameter,\r\ntvb, offset, octets, code32,"%s",str);\r\n}\r\nbreak;\r\n}\r\nreturn pi;\r\n}\r\nstatic proto_tree *\r\ninfo_to_cops_subtree(tvbuff_t *tvb, proto_tree *st, int n, int offset, const char *str) {\r\nproto_item *tv;\r\ntv = proto_tree_add_none_format( st, hf_cops_subtree, tvb, offset, n, "%s", str);\r\nreturn( proto_item_add_subtree( tv, ett_cops_subtree ) );\r\n}\r\nstatic void\r\ncops_transaction_id(tvbuff_t *tvb, packet_info *pinfo, proto_tree *st, guint8 op_code, guint n, guint32 offset) {\r\nproto_tree *stt;\r\nguint16 code16;\r\nchar info[50];\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"D-QoS Transaction ID");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,2,"D-QoS Transaction Identifier", NULL,FMT_DEC,&hf_cops_pc_transaction_id);\r\noffset +=2;\r\ncode16 = tvb_get_ntohs(tvb,offset);\r\nproto_tree_add_uint_format(stt, hf_cops_pc_gate_command_type,tvb, offset, 2,\r\ncode16,"%-28s : %s (%u)", "Gate Command Type",\r\nval_to_str(code16,table_cops_dqos_transaction_id, "Unknown (0x%04x)"),code16);\r\ng_snprintf(info,sizeof(info),"COPS %-20s - %s",val_to_str_const(op_code,cops_op_code_vals, "Unknown"),\r\nval_to_str_const(code16,table_cops_dqos_transaction_id, "Unknown"));\r\ncol_add_str(pinfo->cinfo, COL_INFO,info);\r\n}\r\nstatic void\r\ncops_subscriber_id_v4(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_item *tv;\r\ntv = info_to_cops_subtree(tvb,st,n,offset,"Subscriber ID (IPv4)");\r\noffset += 4;\r\ninfo_to_display(tvb,tv,offset,4,"Subscriber Identifier (IPv4)", NULL,FMT_IPv4,&hf_cops_pc_subscriber_id_ipv4);\r\n}\r\nstatic void\r\ncops_subscriber_id_v6(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_item *tv;\r\ntv = info_to_cops_subtree(tvb,st,n,offset,"Subscriber ID (IPv6)");\r\noffset += 4;\r\ninfo_to_display(tvb,tv,offset,16,"Subscriber Identifier (IPv6)", NULL,FMT_IPv6,&hf_cops_pc_subscriber_id_ipv6);\r\n}\r\nstatic void\r\ncops_gate_id(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Gate ID");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,4,"Gate Identifier", NULL,FMT_HEX,&hf_cops_pc_gate_id);\r\n}\r\nstatic void\r\ncops_activity_count(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Activity Count");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,4,"Count", NULL,FMT_DEC,&hf_cops_pc_activity_count);\r\n}\r\nstatic void\r\ncops_gate_specs(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Gate Specifications");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,1,"Direction",table_cops_direction,FMT_DEC,&hf_cops_pc_direction);\r\noffset += 1;\r\ninfo_to_display(tvb,stt,offset,1,"Protocol ID",NULL,FMT_DEC,&hf_cops_pc_protocol_id);\r\noffset += 1;\r\ninfo_to_display(tvb,stt,offset,1,"Flags",NULL,FMT_DEC,&hf_cops_pc_gate_spec_flags);\r\noffset += 1;\r\ninfo_to_display(tvb,stt,offset,1,"Session Class",table_cops_session_class,FMT_DEC,&hf_cops_pc_session_class);\r\noffset += 1;\r\ninfo_to_display(tvb,stt,offset,4,"Source IP Address",NULL,FMT_IPv4,&hf_cops_pc_src_ip);\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,4,"Destination IP Address",NULL,FMT_IPv4,&hf_cops_pc_dest_ip);\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,2,"Source IP Port",NULL,FMT_DEC,&hf_cops_pc_src_port);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,2,"Destination IP Port",NULL,FMT_DEC,&hf_cops_pc_dest_port);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,1,"DS Field (DSCP or TOS)",NULL,FMT_HEX,&hf_cops_pc_ds_field);\r\noffset += 1;\r\noffset += 3;\r\ninfo_to_display(tvb,stt,offset,2,"Timer T1 Value (sec)",NULL,FMT_DEC,&hf_cops_pc_t1_value);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,2,"Reserved",NULL,FMT_DEC,&hf_cops_pc_reserved);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,2,"Timer T7 Value (sec)",NULL,FMT_DEC,&hf_cops_pc_t7_value);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,2,"Timer T8 Value (sec)",NULL,FMT_DEC,&hf_cops_pc_t8_value);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,4,"Token Bucket Rate",NULL,FMT_FLT,&hf_cops_pc_token_bucket_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,4,"Token Bucket Size",NULL,FMT_FLT,&hf_cops_pc_token_bucket_size);\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,4,"Peak Data Rate",NULL,FMT_FLT,&hf_cops_pc_peak_data_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,4,"Minimum Policed Unit",NULL,FMT_DEC,&hf_cops_pc_min_policed_unit);\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,4,"Maximum Packet Size",NULL,FMT_DEC,&hf_cops_pc_max_packet_size);\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,4,"Rate",NULL,FMT_FLT,&hf_cops_pc_spec_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,4,"Slack Term",NULL,FMT_DEC,&hf_cops_pc_slack_term);\r\n}\r\nstatic void\r\ncops_surveillance_parameters(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Electronic Surveillance Parameters");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,4,"DF IP Address for CDC", NULL,FMT_IPv4,&hf_cops_pc_dfcdc_ip);\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,2,"DF IP Port for CDC",NULL,FMT_DEC,&hf_cops_pc_dfcdc_ip_port);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,2,"Flags",NULL,FMT_HEX,&hf_cops_pc_gate_spec_flags);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,4,"DF IP Address for CCC", NULL,FMT_IPv4,&hf_cops_pc_dfccc_ip);\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,2,"DF IP Port for CCC",NULL,FMT_DEC,&hf_cops_pc_dfccc_ip_port);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,2,"Reserved",NULL,FMT_HEX,&hf_cops_pc_reserved);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,4,"CCCID", NULL,FMT_DEC,&hf_cops_pc_dfccc_id);\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,4,"BCID - Timestamp",NULL,FMT_HEX,&hf_cops_pc_bcid_ts);\r\noffset += 4;\r\nproto_tree_add_item(stt, hf_cops_pc_bcid_id, tvb, offset, 8, ENC_ASCII|ENC_NA);\r\noffset += 8;\r\nproto_tree_add_item(stt, hf_cops_pc_bcid_tz, tvb, offset, 8, ENC_ASCII|ENC_NA);\r\noffset += 8;\r\ninfo_to_display(tvb,stt,offset,4,"BCID - Event Counter",NULL,FMT_DEC,&hf_cops_pc_bcid_ev);\r\n}\r\nstatic void\r\ncops_event_generation_info(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Event Generation Info");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,4,"PRKS IP Address", NULL,FMT_IPv4,&hf_cops_pc_prks_ip);\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,2,"PRKS IP Port",NULL,FMT_DEC,&hf_cops_pc_prks_ip_port);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,1,"Flags",NULL,FMT_HEX,&hf_cops_pc_gate_spec_flags);\r\noffset += 1;\r\ninfo_to_display(tvb,stt,offset,1,"Reserved",NULL,FMT_HEX,&hf_cops_pc_reserved);\r\noffset += 1;\r\ninfo_to_display(tvb,stt,offset,4,"SRKS IP Address", NULL,FMT_IPv4,&hf_cops_pc_srks_ip);\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,2,"SRKS IP Port",NULL,FMT_DEC,&hf_cops_pc_srks_ip_port);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,1,"Flags",NULL,FMT_DEC,&hf_cops_pc_gate_spec_flags);\r\noffset += 1;\r\ninfo_to_display(tvb,stt,offset,1,"Reserved",NULL,FMT_HEX,&hf_cops_pc_reserved);\r\noffset += 1;\r\ninfo_to_display(tvb,stt,offset,4,"BCID - Timestamp",NULL,FMT_HEX,&hf_cops_pc_bcid_ts);\r\noffset += 4;\r\nproto_tree_add_item(stt, hf_cops_pc_bcid_id, tvb, offset, 8, ENC_ASCII|ENC_NA);\r\noffset += 8;\r\nproto_tree_add_item(stt, hf_cops_pc_bcid_tz, tvb, offset, 8, ENC_ASCII|ENC_NA);\r\noffset += 8;\r\ninfo_to_display(tvb,stt,offset,4,"BCID - Event Counter",NULL,FMT_DEC,&hf_cops_pc_bcid_ev);\r\n}\r\nstatic void\r\ncops_remote_gate_info(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Remote Gate Info");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,4,"CMTS IP Address", NULL,FMT_IPv4,&hf_cops_pc_cmts_ip);\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,2,"CMTS IP Port",NULL,FMT_DEC,&hf_cops_pc_cmts_ip_port);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,2,"Flags",NULL,FMT_DEC,&hf_cops_pc_remote_flags);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,4,"Remote Gate ID", NULL,FMT_HEX,&hf_cops_pc_remote_gate_id);\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,2,"Algorithm", NULL,FMT_DEC,&hf_cops_pc_algorithm);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,4,"Reserved", NULL,FMT_HEX,&hf_cops_pc_reserved);\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,4,"Security Key", NULL,FMT_HEX,&hf_cops_pc_key);\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,4,"Security Key (cont)", NULL,FMT_HEX,&hf_cops_pc_key);\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,4,"Security Key (cont)", NULL,FMT_HEX,&hf_cops_pc_key);\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,4,"Security Key (cont)", NULL,FMT_HEX,&hf_cops_pc_key);\r\n}\r\nstatic void\r\ncops_packetcable_reason(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt;\r\nguint16 code16;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"PacketCable Reason");\r\noffset += 4;\r\ncode16 = tvb_get_ntohs(tvb,offset);\r\nproto_tree_add_uint_format(stt, hf_cops_pc_reason_code,tvb, offset, 2,\r\ncode16, "%-28s : %s (%u)","Reason Code",\r\nval_to_str(code16, table_cops_reason_code, "Unknown (0x%04x)"),code16);\r\noffset += 2;\r\nif ( code16 == 0 ) {\r\ninfo_to_display(tvb,stt,offset,2,"Reason Sub Code",table_cops_reason_subcode_delete,FMT_DEC,&hf_cops_pc_delete_subcode);\r\n} else {\r\ninfo_to_display(tvb,stt,offset,2,"Reason Sub Code",table_cops_reason_subcode_close,FMT_DEC,&hf_cops_pc_close_subcode);\r\n}\r\n}\r\nstatic void\r\ncops_packetcable_error(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"PacketCable Error");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,2,"Error Code",table_cops_packetcable_error,FMT_DEC,&hf_cops_pc_packetcable_err_code);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,2,"Error Sub Code",NULL,FMT_HEX,&hf_cops_pc_packetcable_sub_code);\r\n}\r\nstatic void\r\ncops_mm_transaction_id(tvbuff_t *tvb, packet_info *pinfo, proto_tree *st, guint8 op_code, guint n, guint32 offset) {\r\nproto_tree *stt;\r\nguint16 code16;\r\nchar info[50];\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"MM Transaction ID");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,2,"Multimedia Transaction Identifier", NULL,FMT_DEC,&hf_cops_pc_transaction_id);\r\noffset +=2;\r\ncode16 = tvb_get_ntohs(tvb,offset);\r\nproto_tree_add_uint_format(stt, hf_cops_pc_gate_command_type,tvb, offset, 2,\r\ncode16,"%-28s : %s (%u)", "Gate Command Type",\r\nval_to_str(code16,table_cops_mm_transaction_id, "Unknown (0x%04x)"),code16);\r\ng_snprintf(info,sizeof(info),"COPS %-20s - %s",val_to_str_const(op_code,cops_op_code_vals, "Unknown"),\r\nval_to_str_const(code16,table_cops_mm_transaction_id, "Unknown"));\r\ncol_add_str(pinfo->cinfo, COL_INFO,info);\r\n}\r\nstatic void\r\ncops_amid(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"AMID");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,2,"Application Manager ID Application Type", NULL,FMT_DEC,&hf_cops_pcmm_amid_app_type);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,2,"Application Manager ID Application Manager Tag", NULL,FMT_DEC,&hf_cops_pcmm_amid_am_tag);\r\n}\r\nstatic int\r\ncops_mm_gate_spec(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_item *ti;\r\nproto_tree *stt, *object_tree;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Gate Spec");\r\noffset += 4;\r\nti = info_to_display(tvb,stt,offset,1,"Flags",NULL,FMT_HEX,&hf_cops_pcmm_gate_spec_flags);\r\nobject_tree = proto_item_add_subtree(ti, ett_cops_subtree );\r\nproto_tree_add_item(object_tree, hf_cops_pcmm_gate_spec_flags_gate, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(object_tree, hf_cops_pcmm_gate_spec_flags_dscp_overwrite, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\ninfo_to_display(tvb,stt,offset,1,"DS Field (DSCP or TOS)",NULL,FMT_HEX,&hf_cops_pcmm_gate_spec_dscp_tos_field);\r\noffset += 1;\r\ninfo_to_display(tvb,stt,offset,1,"DS Field (DSCP or TOS) Mask",NULL,FMT_HEX,&hf_cops_pcmm_gate_spec_dscp_tos_mask);\r\noffset += 1;\r\nti = info_to_display(tvb,stt,offset,1,"Session Class",table_cops_session_class,FMT_DEC,&hf_cops_pcmm_gate_spec_session_class_id);\r\nobject_tree = proto_item_add_subtree(ti, ett_cops_subtree);\r\nproto_tree_add_item(object_tree, hf_cops_pcmm_gate_spec_session_class_id_priority, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(object_tree, hf_cops_pcmm_gate_spec_session_class_id_preemption, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(object_tree, hf_cops_pcmm_gate_spec_session_class_id_configurable, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\ninfo_to_display(tvb,stt,offset,2,"Timer T1 Value (sec)",NULL,FMT_DEC,&hf_cops_pcmm_gate_spec_timer_t1);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,2,"Timer T2 Value (sec)",NULL,FMT_DEC,&hf_cops_pcmm_gate_spec_timer_t2);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,2,"Timer T3 Value (sec)",NULL,FMT_DEC,&hf_cops_pcmm_gate_spec_timer_t3);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,2,"Timer T4 Value (sec)",NULL,FMT_DEC,&hf_cops_pcmm_gate_spec_timer_t4);\r\noffset += 2;\r\nreturn offset;\r\n}\r\nstatic int\r\ncops_classifier(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset, gboolean extended) {\r\nproto_tree *stt;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,\r\nextended ? "Extended Classifier" : "Classifier");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,2,"Protocol ID",NULL,FMT_DEC,&hf_cops_pcmm_classifier_protocol_id);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,1,"DS Field (DSCP or TOS)",NULL,FMT_HEX,&hf_cops_pcmm_classifier_dscp_tos_field);\r\noffset += 1;\r\ninfo_to_display(tvb,stt,offset,1,"DS Field (DSCP or TOS) Mask",NULL,FMT_HEX,&hf_cops_pcmm_classifier_dscp_tos_mask);\r\noffset += 1;\r\ninfo_to_display(tvb,stt,offset,4,"Source IP Address",NULL,FMT_IPv4,&hf_cops_pcmm_classifier_src_addr);\r\noffset += 4;\r\nif (extended) {\r\ninfo_to_display(tvb,stt,offset,4,"Source Mask",NULL,FMT_IPv4,&hf_cops_pcmm_classifier_src_mask);\r\noffset += 4;\r\n}\r\ninfo_to_display(tvb,stt,offset,4,"Destination IP Address",NULL,FMT_IPv4,&hf_cops_pcmm_classifier_dst_addr);\r\noffset += 4;\r\nif (extended) {\r\ninfo_to_display(tvb,stt,offset,4,"Destination Mask",NULL,FMT_IPv4,&hf_cops_pcmm_classifier_dst_mask);\r\noffset += 4;\r\n}\r\ninfo_to_display(tvb,stt,offset,2,"Source IP Port",NULL,FMT_DEC,&hf_cops_pcmm_classifier_src_port);\r\noffset += 2;\r\nif (extended) {\r\ninfo_to_display(tvb,stt,offset,2,"Source Port End",NULL,FMT_DEC,&hf_cops_pcmm_classifier_src_port_end);\r\noffset += 2;\r\n}\r\ninfo_to_display(tvb,stt,offset,2,"Destination IP Port",NULL,FMT_DEC,&hf_cops_pcmm_classifier_dst_port);\r\noffset += 2;\r\nif (extended) {\r\ninfo_to_display(tvb,stt,offset,2,"Destination Port End",NULL,FMT_DEC,&hf_cops_pcmm_classifier_dst_port_end);\r\noffset += 2;\r\n}\r\nif (extended) {\r\ninfo_to_display(tvb,stt,offset,2,"ClassifierID",NULL,FMT_HEX,&hf_cops_pcmm_classifier_classifier_id);\r\noffset += 2;\r\n}\r\ninfo_to_display(tvb,stt,offset,1,"Priority",NULL,FMT_HEX,&hf_cops_pcmm_classifier_priority);\r\noffset += 1;\r\nif (extended) {\r\ninfo_to_display(tvb,stt,offset,1,"Activation State",NULL,FMT_HEX,&hf_cops_pcmm_classifier_activation_state);\r\noffset += 1;\r\ninfo_to_display(tvb,stt,offset,1,"Action",NULL,FMT_HEX,&hf_cops_pcmm_classifier_action);\r\noffset += 1;\r\n}\r\noffset += 3;\r\nreturn offset;\r\n}\r\nstatic int\r\ncops_ipv6_classifier(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt;\r\nstt = info_to_cops_subtree(tvb,st,n,offset, "IPv6 Classifier");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,1,"Flags",NULL,FMT_HEX,&hf_cops_pcmm_classifier_flags);\r\noffset += 1;\r\ninfo_to_display(tvb,stt,offset,1,"tc-low",NULL,FMT_HEX,&hf_cops_pcmm_classifier_tc_low);\r\noffset += 1;\r\ninfo_to_display(tvb,stt,offset,1,"tc-high",NULL,FMT_HEX,&hf_cops_pcmm_classifier_tc_high);\r\noffset += 1;\r\ninfo_to_display(tvb,stt,offset,1,"tc-mask",NULL,FMT_HEX,&hf_cops_pcmm_classifier_tc_mask);\r\noffset += 1;\r\ninfo_to_display(tvb,stt,offset,4,"Flow Label",NULL,FMT_HEX,&hf_cops_pcmm_classifier_flow_label);\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,2,"Next Header Type",NULL,FMT_DEC,&hf_cops_pcmm_classifier_next_header_type);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,1,"Source Prefix Length",NULL,FMT_DEC,&hf_cops_pcmm_classifier_source_prefix_length);\r\noffset += 1;\r\ninfo_to_display(tvb,stt,offset,1,"Destination Prefix Length",NULL,FMT_DEC,&hf_cops_pcmm_classifier_destination_prefix_length);\r\noffset += 1;\r\ninfo_to_display(tvb,stt,offset,16,"IPv6 Source Address",NULL,FMT_IPv6,&hf_cops_pcmm_classifier_src_addr_v6);\r\noffset += 16;\r\ninfo_to_display(tvb,stt,offset,16,"IPv6 Destination Address",NULL,FMT_IPv6,&hf_cops_pcmm_classifier_dst_addr_v6);\r\noffset += 16;\r\ninfo_to_display(tvb,stt,offset,2,"Source Port Start",NULL,FMT_DEC,&hf_cops_pcmm_classifier_src_port);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,2,"Source Port End",NULL,FMT_DEC,&hf_cops_pcmm_classifier_src_port_end);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,2,"Destination Port Start",NULL,FMT_DEC,&hf_cops_pcmm_classifier_dst_port);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,2,"Destination Port End",NULL,FMT_DEC,&hf_cops_pcmm_classifier_dst_port_end);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,2,"ClassifierID",NULL,FMT_HEX,&hf_cops_pcmm_classifier_classifier_id);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,1,"Priority",NULL,FMT_HEX,&hf_cops_pcmm_classifier_priority);\r\noffset += 1;\r\ninfo_to_display(tvb,stt,offset,1,"Activation State",NULL,FMT_HEX,&hf_cops_pcmm_classifier_activation_state);\r\noffset += 1;\r\ninfo_to_display(tvb,stt,offset,1,"Action",NULL,FMT_HEX,&hf_cops_pcmm_classifier_action);\r\noffset += 1;\r\noffset += 3;\r\nreturn offset;\r\n}\r\nstatic int\r\ncops_flow_spec(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt, *object_tree;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Flow Spec");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,1,"Envelope",NULL,FMT_DEC,&hf_cops_pcmm_flow_spec_envelope);\r\noffset += 1;\r\ninfo_to_display(tvb,stt,offset,1,"Service Number",NULL,FMT_DEC,&hf_cops_pcmm_flow_spec_service_number);\r\noffset += 1;\r\ninfo_to_display(tvb,stt,offset,2,"Reserved",NULL,FMT_HEX,&hf_cops_pc_reserved);\r\noffset += 2;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, 28, ett_cops_subtree, NULL, "Authorized Envelope");\r\ninfo_to_display(tvb,object_tree,offset,4,"Token Bucket Rate",NULL,FMT_FLT,&hf_cops_pc_token_bucket_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Token Bucket Size",NULL,FMT_FLT,&hf_cops_pc_token_bucket_size);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Peak Data Rate",NULL,FMT_FLT,&hf_cops_pc_peak_data_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Minimum Policed Unit",NULL,FMT_DEC,&hf_cops_pc_min_policed_unit);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Packet Size",NULL,FMT_DEC,&hf_cops_pc_max_packet_size);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Rate",NULL,FMT_FLT,&hf_cops_pc_spec_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Slack Term",NULL,FMT_DEC,&hf_cops_pc_slack_term);\r\noffset += 4;\r\nif (n < 64) return offset;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, 28, ett_cops_subtree, NULL, "Reserved Envelope");\r\ninfo_to_display(tvb,object_tree,offset,4,"Token Bucket Rate",NULL,FMT_FLT,&hf_cops_pc_token_bucket_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Token Bucket Size",NULL,FMT_FLT,&hf_cops_pc_token_bucket_size);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Peak Data Rate",NULL,FMT_FLT,&hf_cops_pc_peak_data_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Minimum Policed Unit",NULL,FMT_DEC,&hf_cops_pc_min_policed_unit);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Packet Size",NULL,FMT_DEC,&hf_cops_pc_max_packet_size);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Rate",NULL,FMT_FLT,&hf_cops_pc_spec_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Slack Term",NULL,FMT_DEC,&hf_cops_pc_slack_term);\r\noffset += 4;\r\nif (n < 92) return offset;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, 28, ett_cops_subtree, NULL, "Committed Envelope");\r\ninfo_to_display(tvb,object_tree,offset,4,"Token Bucket Rate",NULL,FMT_FLT,&hf_cops_pc_token_bucket_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Token Bucket Size",NULL,FMT_FLT,&hf_cops_pc_token_bucket_size);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Peak Data Rate",NULL,FMT_FLT,&hf_cops_pc_peak_data_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Minimum Policed Unit",NULL,FMT_DEC,&hf_cops_pc_min_policed_unit);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Packet Size",NULL,FMT_DEC,&hf_cops_pc_max_packet_size);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Rate",NULL,FMT_FLT,&hf_cops_pc_spec_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Slack Term",NULL,FMT_DEC,&hf_cops_pc_slack_term);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\ncops_docsis_service_class_name(tvbuff_t *tvb, packet_info *pinfo, proto_tree *st, guint object_len, guint32 offset) {\r\nproto_tree *stt;\r\nstt = info_to_cops_subtree(tvb,st,object_len,offset,"DOCSIS Service Class Name");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,1,"Envelope",NULL,FMT_DEC,&hf_cops_pcmm_envelope);\r\noffset += 1;\r\nproto_tree_add_item(stt, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\nif (object_len >= 12) {\r\nproto_tree_add_item(stt, hf_cops_pcmm_docsis_scn, tvb, offset, object_len - 8, ENC_ASCII|ENC_NA);\r\noffset += object_len - 8;\r\n} else {\r\nproto_tree_add_expert_format(stt, pinfo, &ei_cops_bad_cops_object_length,\r\ntvb, offset - 8, 2, "Invalid object length: %u", object_len);\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ncops_best_effort_service_i04_i05(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset, gboolean i05) {\r\nproto_tree *stt, *object_tree;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Best Effort Service");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,1,"Envelope",NULL,FMT_DEC,&hf_cops_pcmm_envelope);\r\noffset += 1;\r\nproto_tree_add_item(stt, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, i05 ? 36 : 32, ett_cops_subtree, NULL, "Authorized Envelope");\r\ninfo_to_display(tvb,object_tree,offset,1,"Traffic Priority",NULL,FMT_HEX,&hf_cops_pcmm_traffic_priority);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Sustained Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_max_sustained_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Traffic Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_traffic_burst);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Minimum Reserved Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_min_reserved_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Assumed Minimum Reserved Traffic Rate Packet Size",NULL,FMT_DEC,&hf_cops_pcmm_ass_min_rtr_packet_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,2,"Maximum Concatenated Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_concat_burst);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,4,"Required Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_req_att_mask);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Forbidden Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_forbid_att_mask);\r\noffset += 4;\r\nif (i05) {\r\ninfo_to_display(tvb,object_tree,offset,4,"Attribute Aggregation Rule Mask",NULL,FMT_DEC,&hf_cops_pcmm_att_aggr_rule_mask);\r\noffset += 4;\r\n}\r\nif (n < 56) return offset;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, i05 ? 36 : 32, ett_cops_subtree, NULL, "Reserved Envelope");\r\ninfo_to_display(tvb,object_tree,offset,1,"Traffic Priority",NULL,FMT_HEX,&hf_cops_pcmm_traffic_priority);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Sustained Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_max_sustained_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Traffic Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_traffic_burst);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Minimum Reserved Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_min_reserved_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Assumed Minimum Reserved Traffic Rate Packet Size",NULL,FMT_DEC,&hf_cops_pcmm_ass_min_rtr_packet_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,2,"Maximum Concatenated Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_concat_burst);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,4,"Required Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_req_att_mask);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Forbidden Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_forbid_att_mask);\r\noffset += 4;\r\nif (i05) {\r\ninfo_to_display(tvb,object_tree,offset,4,"Attribute Aggregation Rule Mask",NULL,FMT_DEC,&hf_cops_pcmm_att_aggr_rule_mask);\r\noffset += 4;\r\n}\r\nif (n < 80) return offset;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, i05 ? 36 : 32, ett_cops_subtree, NULL, "Committed Envelope");\r\ninfo_to_display(tvb,object_tree,offset,1,"Traffic Priority",NULL,FMT_HEX,&hf_cops_pcmm_traffic_priority);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Sustained Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_max_sustained_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Traffic Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_traffic_burst);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Minimum Reserved Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_min_reserved_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Assumed Minimum Reserved Traffic Rate Packet Size",NULL,FMT_DEC,&hf_cops_pcmm_ass_min_rtr_packet_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,2,"Maximum Concatenated Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_concat_burst);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,4,"Required Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_req_att_mask);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Forbidden Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_forbid_att_mask);\r\noffset += 4;\r\nif (i05) {\r\ninfo_to_display(tvb,object_tree,offset,4,"Attribute Aggregation Rule Mask",NULL,FMT_DEC,&hf_cops_pcmm_att_aggr_rule_mask);\r\noffset += 4;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ncops_non_real_time_polling_service_i04_i05(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset, gboolean i05) {\r\nproto_tree *stt, *object_tree;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Non-Real-Time Polling Service");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,1,"Envelope",NULL,FMT_DEC,&hf_cops_pcmm_envelope);\r\noffset += 1;\r\nproto_tree_add_item(stt, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, i05 ? 40 : 36, ett_cops_subtree, NULL, "Authorized Envelope");\r\ninfo_to_display(tvb,object_tree,offset,1,"Traffic Priority",NULL,FMT_HEX,&hf_cops_pcmm_traffic_priority);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Sustained Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_max_sustained_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Traffic Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_traffic_burst);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Minimum Reserved Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_min_reserved_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Assumed Minimum Reserved Traffic Rate Packet Size",NULL,FMT_DEC,&hf_cops_pcmm_ass_min_rtr_packet_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,2,"Maximum Concatenated Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_concat_burst);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Polling Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_polling_interval);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Required Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_req_att_mask);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Forbidden Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_forbid_att_mask);\r\noffset += 4;\r\nif (i05) {\r\ninfo_to_display(tvb,object_tree,offset,4,"Attribute Aggregation Rule Mask",NULL,FMT_DEC,&hf_cops_pcmm_att_aggr_rule_mask);\r\noffset += 4;\r\n}\r\nif (n < 64) return offset;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, i05 ? 40 : 36, ett_cops_subtree, NULL, "Reserved Envelope");\r\ninfo_to_display(tvb,object_tree,offset,1,"Traffic Priority",NULL,FMT_HEX,&hf_cops_pcmm_traffic_priority);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Sustained Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_max_sustained_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Traffic Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_traffic_burst);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Minimum Reserved Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_min_reserved_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Assumed Minimum Reserved Traffic Rate Packet Size",NULL,FMT_DEC,&hf_cops_pcmm_ass_min_rtr_packet_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,2,"Maximum Concatenated Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_concat_burst);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Polling Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_polling_interval);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Required Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_req_att_mask);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Forbidden Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_forbid_att_mask);\r\noffset += 4;\r\nif (i05) {\r\ninfo_to_display(tvb,object_tree,offset,4,"Attribute Aggregation Rule Mask",NULL,FMT_DEC,&hf_cops_pcmm_att_aggr_rule_mask);\r\noffset += 4;\r\n}\r\nif (n < 92) return offset;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, i05 ? 40 : 36, ett_cops_subtree, NULL, "Committed Envelope");\r\ninfo_to_display(tvb,object_tree,offset,1,"Traffic Priority",NULL,FMT_HEX,&hf_cops_pcmm_traffic_priority);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Sustained Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_max_sustained_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Traffic Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_traffic_burst);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Minimum Reserved Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_min_reserved_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Assumed Minimum Reserved Traffic Rate Packet Size",NULL,FMT_DEC,&hf_cops_pcmm_ass_min_rtr_packet_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,2,"Maximum Concatenated Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_concat_burst);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Polling Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_polling_interval);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Required Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_req_att_mask);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Forbidden Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_forbid_att_mask);\r\noffset += 4;\r\nif (i05) {\r\ninfo_to_display(tvb,object_tree,offset,4,"Attribute Aggregation Rule Mask",NULL,FMT_DEC,&hf_cops_pcmm_att_aggr_rule_mask);\r\noffset += 4;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ncops_real_time_polling_service_i04_i05(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset, gboolean i05) {\r\nproto_tree *stt, *object_tree;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Real-Time Polling Service");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,1,"Envelope",NULL,FMT_DEC,&hf_cops_pcmm_envelope);\r\noffset += 1;\r\nproto_tree_add_item(stt, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, i05 ? 40 : 36, ett_cops_subtree, NULL, "Authorized Envelope");\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Sustained Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_max_sustained_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Traffic Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_traffic_burst);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Minimum Reserved Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_min_reserved_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Assumed Minimum Reserved Traffic Rate Packet Size",NULL,FMT_DEC,&hf_cops_pcmm_ass_min_rtr_packet_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,2,"Maximum Concatenated Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_concat_burst);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Polling Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_polling_interval);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Tolerated Poll Jitter",NULL,FMT_DEC,&hf_cops_pcmm_tolerated_poll_jitter);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Required Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_req_att_mask);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Forbidden Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_forbid_att_mask);\r\noffset += 4;\r\nif (i05) {\r\ninfo_to_display(tvb,object_tree,offset,4,"Attribute Aggregation Rule Mask",NULL,FMT_DEC,&hf_cops_pcmm_att_aggr_rule_mask);\r\noffset += 4;\r\n}\r\nif (n < 64) return offset;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, i05 ? 40 : 36, ett_cops_subtree, NULL, "Reserved Envelope");\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Sustained Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_max_sustained_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Traffic Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_traffic_burst);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Minimum Reserved Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_min_reserved_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Assumed Minimum Reserved Traffic Rate Packet Size",NULL,FMT_DEC,&hf_cops_pcmm_ass_min_rtr_packet_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,2,"Maximum Concatenated Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_concat_burst);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Polling Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_polling_interval);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Tolerated Poll Jitter",NULL,FMT_DEC,&hf_cops_pcmm_tolerated_poll_jitter);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Required Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_req_att_mask);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Forbidden Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_forbid_att_mask);\r\noffset += 4;\r\nif (i05) {\r\ninfo_to_display(tvb,object_tree,offset,4,"Attribute Aggregation Rule Mask",NULL,FMT_DEC,&hf_cops_pcmm_att_aggr_rule_mask);\r\noffset += 4;\r\n}\r\nif (n < 92) return offset;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, i05 ? 40 : 36, ett_cops_subtree, NULL, "Committed Envelope");\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Sustained Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_max_sustained_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Traffic Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_traffic_burst);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Minimum Reserved Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_min_reserved_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Assumed Minimum Reserved Traffic Rate Packet Size",NULL,FMT_DEC,&hf_cops_pcmm_ass_min_rtr_packet_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,2,"Maximum Concatenated Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_concat_burst);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Polling Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_polling_interval);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Tolerated Poll Jitter",NULL,FMT_DEC,&hf_cops_pcmm_tolerated_poll_jitter);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Required Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_req_att_mask);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Forbidden Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_forbid_att_mask);\r\noffset += 4;\r\nif (i05) {\r\ninfo_to_display(tvb,object_tree,offset,4,"Attribute Aggregation Rule Mask",NULL,FMT_DEC,&hf_cops_pcmm_att_aggr_rule_mask);\r\noffset += 4;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ncops_unsolicited_grant_service_i04_i05(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset, gboolean i05) {\r\nproto_tree *stt, *object_tree;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Unsolicited Grant Service");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,1,"Envelope",NULL,FMT_DEC,&hf_cops_pcmm_envelope);\r\noffset += 1;\r\nproto_tree_add_item(stt, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, i05 ? 28 : 24, ett_cops_subtree, NULL, "Authorized Envelope");\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Unsolicited Grant Size",NULL,FMT_DEC,&hf_cops_pcmm_unsolicited_grant_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,1,"Grants Per Interval",NULL,FMT_DEC,&hf_cops_pcmm_grants_per_interval);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved8, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Grant Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_grant_interval);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Tolerated Grant Jitter",NULL,FMT_DEC,&hf_cops_pcmm_tolerated_grant_jitter);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Required Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_req_att_mask);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Forbidden Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_forbid_att_mask);\r\noffset += 4;\r\nif (i05) {\r\ninfo_to_display(tvb,object_tree,offset,4,"Attribute Aggregation Rule Mask",NULL,FMT_DEC,&hf_cops_pcmm_att_aggr_rule_mask);\r\noffset += 4;\r\n}\r\nif (n < 40) return offset;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, i05 ? 28 : 24, ett_cops_subtree, NULL, "Reserved Envelope");\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Unsolicited Grant Size",NULL,FMT_DEC,&hf_cops_pcmm_unsolicited_grant_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,1,"Grants Per Interval",NULL,FMT_DEC,&hf_cops_pcmm_grants_per_interval);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved8, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Grant Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_grant_interval);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Tolerated Grant Jitter",NULL,FMT_DEC,&hf_cops_pcmm_tolerated_grant_jitter);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Required Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_req_att_mask);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Forbidden Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_forbid_att_mask);\r\noffset += 4;\r\nif (i05) {\r\ninfo_to_display(tvb,object_tree,offset,4,"Attribute Aggregation Rule Mask",NULL,FMT_DEC,&hf_cops_pcmm_att_aggr_rule_mask);\r\noffset += 4;\r\n}\r\nif (n < 56) return offset;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, i05 ? 28 : 24, ett_cops_subtree, NULL, "Committed Envelope");\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Unsolicited Grant Size",NULL,FMT_DEC,&hf_cops_pcmm_unsolicited_grant_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,1,"Grants Per Interval",NULL,FMT_DEC,&hf_cops_pcmm_grants_per_interval);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved8, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Grant Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_grant_interval);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Tolerated Grant Jitter",NULL,FMT_DEC,&hf_cops_pcmm_tolerated_grant_jitter);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Required Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_req_att_mask);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Forbidden Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_forbid_att_mask);\r\noffset += 4;\r\nif (i05) {\r\ninfo_to_display(tvb,object_tree,offset,4,"Attribute Aggregation Rule Mask",NULL,FMT_DEC,&hf_cops_pcmm_att_aggr_rule_mask);\r\noffset += 4;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ncops_ugs_with_activity_detection_i04_i05(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset, gboolean i05) {\r\nproto_tree *stt, *object_tree;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Unsolicited Grant Service with Activity Detection");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,1,"Envelope",NULL,FMT_DEC,&hf_cops_pcmm_envelope);\r\noffset += 1;\r\nproto_tree_add_item(stt, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, i05 ? 36 : 32, ett_cops_subtree, NULL, "Authorized Envelope");\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Unsolicited Grant Size",NULL,FMT_DEC,&hf_cops_pcmm_unsolicited_grant_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,1,"Grants Per Interval",NULL,FMT_DEC,&hf_cops_pcmm_grants_per_interval);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved8, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Grant Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_grant_interval);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Tolerated Grant Jitter",NULL,FMT_DEC,&hf_cops_pcmm_tolerated_grant_jitter);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Polling Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_polling_interval);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Tolerated Poll Jitter",NULL,FMT_DEC,&hf_cops_pcmm_tolerated_poll_jitter);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Required Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_req_att_mask);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Forbidden Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_forbid_att_mask);\r\noffset += 4;\r\nif (i05) {\r\ninfo_to_display(tvb,object_tree,offset,4,"Attribute Aggregation Rule Mask",NULL,FMT_DEC,&hf_cops_pcmm_att_aggr_rule_mask);\r\noffset += 4;\r\n}\r\nif (n < 56) return offset;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, i05 ? 36 : 32, ett_cops_subtree, NULL, "Reserved Envelope");\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Unsolicited Grant Size",NULL,FMT_DEC,&hf_cops_pcmm_unsolicited_grant_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,1,"Grants Per Interval",NULL,FMT_DEC,&hf_cops_pcmm_grants_per_interval);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved8, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Grant Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_grant_interval);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Tolerated Grant Jitter",NULL,FMT_DEC,&hf_cops_pcmm_tolerated_grant_jitter);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Polling Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_polling_interval);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Tolerated Poll Jitter",NULL,FMT_DEC,&hf_cops_pcmm_tolerated_poll_jitter);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Required Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_req_att_mask);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Forbidden Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_forbid_att_mask);\r\noffset += 4;\r\nif (i05) {\r\ninfo_to_display(tvb,object_tree,offset,4,"Attribute Aggregation Rule Mask",NULL,FMT_DEC,&hf_cops_pcmm_att_aggr_rule_mask);\r\noffset += 4;\r\n}\r\nif (n < 80) return offset;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, i05 ? 36 : 32, ett_cops_subtree, NULL, "Committed Envelope");\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Unsolicited Grant Size",NULL,FMT_DEC,&hf_cops_pcmm_unsolicited_grant_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,1,"Grants Per Interval",NULL,FMT_DEC,&hf_cops_pcmm_grants_per_interval);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved8, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Grant Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_grant_interval);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Tolerated Grant Jitter",NULL,FMT_DEC,&hf_cops_pcmm_tolerated_grant_jitter);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Polling Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_polling_interval);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Tolerated Poll Jitter",NULL,FMT_DEC,&hf_cops_pcmm_tolerated_poll_jitter);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Required Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_req_att_mask);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Forbidden Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_forbid_att_mask);\r\noffset += 4;\r\nif (i05) {\r\ninfo_to_display(tvb,object_tree,offset,4,"Attribute Aggregation Rule Mask",NULL,FMT_DEC,&hf_cops_pcmm_att_aggr_rule_mask);\r\noffset += 4;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ncops_downstream_service_i04_i05(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset, gboolean i05) {\r\nproto_tree *stt, *object_tree;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Downstream Service");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,1,"Envelope",NULL,FMT_DEC,&hf_cops_pcmm_envelope);\r\noffset += 1;\r\nproto_tree_add_item(stt, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, i05 ? 40 : 36, ett_cops_subtree, NULL, "Authorized Envelope");\r\ninfo_to_display(tvb,object_tree,offset,1,"Traffic Priority",NULL,FMT_HEX,&hf_cops_pcmm_traffic_priority);\r\noffset += 1;\r\ninfo_to_display(tvb,object_tree,offset,1,"Downstream Resequencing",NULL,FMT_HEX,&hf_cops_pcmm_down_resequencing);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved16, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Sustained Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_max_sustained_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Traffic Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_traffic_burst);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Minimum Reserved Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_min_reserved_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Assumed Minimum Reserved Traffic Rate Packet Size",NULL,FMT_DEC,&hf_cops_pcmm_ass_min_rtr_packet_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,2,"Reserved",NULL,FMT_HEX,&hf_cops_pc_reserved);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Downstream Latency",NULL,FMT_DEC,&hf_cops_pcmm_max_downstream_latency);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Downstream Peak Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_down_peak_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Required Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_req_att_mask);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Forbidden Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_forbid_att_mask);\r\noffset += 4;\r\nif (i05) {\r\ninfo_to_display(tvb,object_tree,offset,4,"Attribute Aggregation Rule Mask",NULL,FMT_DEC,&hf_cops_pcmm_att_aggr_rule_mask);\r\noffset += 4;\r\n}\r\nif (n < 56) return offset;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, i05 ? 40 : 36, ett_cops_subtree, NULL, "Reserved Envelope");\r\ninfo_to_display(tvb,object_tree,offset,1,"Traffic Priority",NULL,FMT_HEX,&hf_cops_pcmm_traffic_priority);\r\noffset += 1;\r\ninfo_to_display(tvb,object_tree,offset,1,"Downstream Resequencing",NULL,FMT_HEX,&hf_cops_pcmm_down_resequencing);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved16, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Sustained Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_max_sustained_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Traffic Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_traffic_burst);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Minimum Reserved Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_min_reserved_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Assumed Minimum Reserved Traffic Rate Packet Size",NULL,FMT_DEC,&hf_cops_pcmm_ass_min_rtr_packet_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,2,"Reserved",NULL,FMT_HEX,&hf_cops_pc_reserved);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Downstream Latency",NULL,FMT_DEC,&hf_cops_pcmm_max_downstream_latency);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Downstream Peak Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_down_peak_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Required Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_req_att_mask);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Forbidden Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_forbid_att_mask);\r\noffset += 4;\r\nif (i05) {\r\ninfo_to_display(tvb,object_tree,offset,4,"Attribute Aggregation Rule Mask",NULL,FMT_DEC,&hf_cops_pcmm_att_aggr_rule_mask);\r\noffset += 4;\r\n}\r\nif (n < 80) return offset;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, i05 ? 40 : 36, ett_cops_subtree, NULL, "Committed Envelope");\r\ninfo_to_display(tvb,object_tree,offset,1,"Traffic Priority",NULL,FMT_HEX,&hf_cops_pcmm_traffic_priority);\r\noffset += 1;\r\ninfo_to_display(tvb,object_tree,offset,1,"Downstream Resequencing",NULL,FMT_HEX,&hf_cops_pcmm_down_resequencing);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved16, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Sustained Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_max_sustained_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Traffic Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_traffic_burst);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Minimum Reserved Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_min_reserved_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Assumed Minimum Reserved Traffic Rate Packet Size",NULL,FMT_DEC,&hf_cops_pcmm_ass_min_rtr_packet_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,2,"Reserved",NULL,FMT_HEX,&hf_cops_pc_reserved);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Downstream Latency",NULL,FMT_DEC,&hf_cops_pcmm_max_downstream_latency);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Downstream Peak Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_down_peak_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Required Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_req_att_mask);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Forbidden Attribute Mask",NULL,FMT_DEC,&hf_cops_pcmm_forbid_att_mask);\r\noffset += 4;\r\nif (i05) {\r\ninfo_to_display(tvb,object_tree,offset,4,"Attribute Aggregation Rule Mask",NULL,FMT_DEC,&hf_cops_pcmm_att_aggr_rule_mask);\r\noffset += 4;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ncops_upstream_drop_i04(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Upstream Drop");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,1,"Envelope",NULL,FMT_DEC,&hf_cops_pcmm_envelope);\r\noffset += 1;\r\nproto_tree_add_item(stt, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\nreturn offset;\r\n}\r\nstatic int\r\ncops_best_effort_service(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt, *object_tree;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Best Effort Service");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,1,"Envelope",NULL,FMT_DEC,&hf_cops_pcmm_envelope);\r\noffset += 1;\r\nproto_tree_add_item(stt, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, 24, ett_cops_subtree, NULL, "Authorized Envelope");\r\ninfo_to_display(tvb,object_tree,offset,1,"Traffic Priority",NULL,FMT_HEX,&hf_cops_pcmm_traffic_priority);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Sustained Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_max_sustained_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Traffic Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_traffic_burst);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Minimum Reserved Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_min_reserved_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Assumed Minimum Reserved Traffic Rate Packet Size",NULL,FMT_DEC,&hf_cops_pcmm_ass_min_rtr_packet_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,2,"Reserved",NULL,FMT_HEX,&hf_cops_pc_reserved);\r\noffset += 2;\r\nif (n < 56) return offset;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, 24, ett_cops_subtree, NULL, "Reserved Envelope");\r\ninfo_to_display(tvb,object_tree,offset,1,"Traffic Priority",NULL,FMT_HEX,&hf_cops_pcmm_traffic_priority);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Sustained Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_max_sustained_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Traffic Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_traffic_burst);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Minimum Reserved Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_min_reserved_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Assumed Minimum Reserved Traffic Rate Packet Size",NULL,FMT_DEC,&hf_cops_pcmm_ass_min_rtr_packet_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,2,"Reserved",NULL,FMT_HEX,&hf_cops_pc_reserved);\r\noffset += 2;\r\nif (n < 80) return offset;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, 24, ett_cops_subtree, NULL, "Committed Envelope");\r\ninfo_to_display(tvb,object_tree,offset,1,"Traffic Priority",NULL,FMT_HEX,&hf_cops_pcmm_traffic_priority);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Sustained Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_max_sustained_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Traffic Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_traffic_burst);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Minimum Reserved Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_min_reserved_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Assumed Minimum Reserved Traffic Rate Packet Size",NULL,FMT_DEC,&hf_cops_pcmm_ass_min_rtr_packet_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,2,"Reserved",NULL,FMT_HEX,&hf_cops_pc_reserved);\r\noffset += 2;\r\nreturn offset;\r\n}\r\nstatic int\r\ncops_non_real_time_polling_service(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt, *object_tree;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Non-Real-Time Polling Service");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,1,"Envelope",NULL,FMT_DEC,&hf_cops_pcmm_envelope);\r\noffset += 1;\r\nproto_tree_add_item(stt, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, 28, ett_cops_subtree, NULL, "Authorized Envelope");\r\ninfo_to_display(tvb,object_tree,offset,1,"Traffic Priority",NULL,FMT_HEX,&hf_cops_pcmm_traffic_priority);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Sustained Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_max_sustained_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Traffic Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_traffic_burst);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Minimum Reserved Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_min_reserved_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Assumed Minimum Reserved Traffic Rate Packet Size",NULL,FMT_DEC,&hf_cops_pcmm_ass_min_rtr_packet_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,2,"Reserved",NULL,FMT_HEX,&hf_cops_pc_reserved);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Polling Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_polling_interval);\r\noffset += 4;\r\nif (n < 64) return offset;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, 24, ett_cops_subtree, NULL, "Reserved Envelope");\r\ninfo_to_display(tvb,object_tree,offset,1,"Traffic Priority",NULL,FMT_HEX,&hf_cops_pcmm_traffic_priority);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Sustained Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_max_sustained_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Traffic Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_traffic_burst);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Minimum Reserved Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_min_reserved_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Assumed Minimum Reserved Traffic Rate Packet Size",NULL,FMT_DEC,&hf_cops_pcmm_ass_min_rtr_packet_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,2,"Reserved",NULL,FMT_HEX,&hf_cops_pc_reserved);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Polling Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_polling_interval);\r\noffset += 4;\r\nif (n < 92) return offset;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, 24, ett_cops_subtree, NULL, "Committed Envelope");\r\ninfo_to_display(tvb,object_tree,offset,1,"Traffic Priority",NULL,FMT_HEX,&hf_cops_pcmm_traffic_priority);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Sustained Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_max_sustained_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Traffic Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_traffic_burst);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Minimum Reserved Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_min_reserved_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Assumed Minimum Reserved Traffic Rate Packet Size",NULL,FMT_DEC,&hf_cops_pcmm_ass_min_rtr_packet_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,2,"Reserved",NULL,FMT_HEX,&hf_cops_pc_reserved);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Polling Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_polling_interval);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\ncops_real_time_polling_service(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt, *object_tree;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Real-Time Polling Service");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,1,"Envelope",NULL,FMT_DEC,&hf_cops_pcmm_envelope);\r\noffset += 1;\r\nproto_tree_add_item(stt, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, 28, ett_cops_subtree, NULL, "Authorized Envelope");\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Sustained Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_max_sustained_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Traffic Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_traffic_burst);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Minimum Reserved Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_min_reserved_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Assumed Minimum Reserved Traffic Rate Packet Size",NULL,FMT_DEC,&hf_cops_pcmm_ass_min_rtr_packet_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,2,"Reserved",NULL,FMT_HEX,&hf_cops_pc_reserved);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Polling Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_polling_interval);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Tolerated Poll Jitter",NULL,FMT_DEC,&hf_cops_pcmm_tolerated_poll_jitter);\r\noffset += 4;\r\nif (n < 64) return offset;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, 24, ett_cops_subtree, NULL, "Reserved Envelope");\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Sustained Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_max_sustained_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Traffic Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_traffic_burst);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Minimum Reserved Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_min_reserved_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Assumed Minimum Reserved Traffic Rate Packet Size",NULL,FMT_DEC,&hf_cops_pcmm_ass_min_rtr_packet_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,2,"Reserved",NULL,FMT_HEX,&hf_cops_pc_reserved);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Polling Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_polling_interval);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Tolerated Poll Jitter",NULL,FMT_DEC,&hf_cops_pcmm_tolerated_poll_jitter);\r\noffset += 4;\r\nif (n < 92) return offset;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, 24, ett_cops_subtree, NULL, "Committed Envelope");\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Sustained Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_max_sustained_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Traffic Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_traffic_burst);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Minimum Reserved Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_min_reserved_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Assumed Minimum Reserved Traffic Rate Packet Size",NULL,FMT_DEC,&hf_cops_pcmm_ass_min_rtr_packet_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,2,"Reserved",NULL,FMT_HEX,&hf_cops_pc_reserved);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Polling Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_polling_interval);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Tolerated Poll Jitter",NULL,FMT_DEC,&hf_cops_pcmm_tolerated_poll_jitter);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\ncops_unsolicited_grant_service(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt, *object_tree;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Unsolicited Grant Service");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,1,"Envelope",NULL,FMT_DEC,&hf_cops_pcmm_envelope);\r\noffset += 1;\r\nproto_tree_add_item(stt, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, 16, ett_cops_subtree, NULL, "Authorized Envelope");\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Unsolicited Grant Size",NULL,FMT_DEC,&hf_cops_pcmm_unsolicited_grant_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,1,"Grants Per Interval",NULL,FMT_DEC,&hf_cops_pcmm_grants_per_interval);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved8, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Grant Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_grant_interval);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Tolerated Grant Jitter",NULL,FMT_DEC,&hf_cops_pcmm_tolerated_grant_jitter);\r\noffset += 4;\r\nif (n < 40) return offset;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, 16, ett_cops_subtree, NULL, "Reserved Envelope");\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Unsolicited Grant Size",NULL,FMT_DEC,&hf_cops_pcmm_unsolicited_grant_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,1,"Grants Per Interval",NULL,FMT_DEC,&hf_cops_pcmm_grants_per_interval);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved8, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Grant Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_grant_interval);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Tolerated Grant Jitter",NULL,FMT_DEC,&hf_cops_pcmm_tolerated_grant_jitter);\r\noffset += 4;\r\nif (n < 56) return offset;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, 16, ett_cops_subtree, NULL, "Committed Envelope");\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Unsolicited Grant Size",NULL,FMT_DEC,&hf_cops_pcmm_unsolicited_grant_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,1,"Grants Per Interval",NULL,FMT_DEC,&hf_cops_pcmm_grants_per_interval);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved8, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Grant Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_grant_interval);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Tolerated Grant Jitter",NULL,FMT_DEC,&hf_cops_pcmm_tolerated_grant_jitter);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\ncops_ugs_with_activity_detection(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt, *object_tree;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Unsolicited Grant Service with Activity Detection");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,1,"Envelope",NULL,FMT_DEC,&hf_cops_pcmm_envelope);\r\noffset += 1;\r\nproto_tree_add_item(stt, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, 24, ett_cops_subtree, NULL, "Authorized Envelope");\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Unsolicited Grant Size",NULL,FMT_DEC,&hf_cops_pcmm_unsolicited_grant_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,1,"Grants Per Interval",NULL,FMT_DEC,&hf_cops_pcmm_grants_per_interval);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved8, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Grant Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_grant_interval);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Tolerated Grant Jitter",NULL,FMT_DEC,&hf_cops_pcmm_tolerated_grant_jitter);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Polling Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_polling_interval);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Tolerated Poll Jitter",NULL,FMT_DEC,&hf_cops_pcmm_tolerated_poll_jitter);\r\noffset += 4;\r\nif (n < 56) return offset;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, 24, ett_cops_subtree, NULL, "Reserved Envelope");\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Unsolicited Grant Size",NULL,FMT_DEC,&hf_cops_pcmm_unsolicited_grant_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,1,"Grants Per Interval",NULL,FMT_DEC,&hf_cops_pcmm_grants_per_interval);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved8, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Grant Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_grant_interval);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Tolerated Grant Jitter",NULL,FMT_DEC,&hf_cops_pcmm_tolerated_grant_jitter);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Polling Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_polling_interval);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Tolerated Poll Jitter",NULL,FMT_DEC,&hf_cops_pcmm_tolerated_poll_jitter);\r\noffset += 4;\r\nif (n < 80) return offset;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, 24, ett_cops_subtree, NULL, "Committed Envelope");\r\ndecode_docsis_request_transmission_policy(tvb, offset, object_tree);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Unsolicited Grant Size",NULL,FMT_DEC,&hf_cops_pcmm_unsolicited_grant_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,1,"Grants Per Interval",NULL,FMT_DEC,&hf_cops_pcmm_grants_per_interval);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved8, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Grant Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_grant_interval);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Tolerated Grant Jitter",NULL,FMT_DEC,&hf_cops_pcmm_tolerated_grant_jitter);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Nominal Polling Interval",NULL,FMT_DEC,&hf_cops_pcmm_nominal_polling_interval);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Tolerated Poll Jitter",NULL,FMT_DEC,&hf_cops_pcmm_tolerated_poll_jitter);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\ncops_downstream_service(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt, *object_tree;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Downstream Service");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,1,"Envelope",NULL,FMT_DEC,&hf_cops_pcmm_envelope);\r\noffset += 1;\r\nproto_tree_add_item(stt, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, 24, ett_cops_subtree, NULL, "Authorized Envelope");\r\ninfo_to_display(tvb,object_tree,offset,1,"Traffic Priority",NULL,FMT_HEX,&hf_cops_pcmm_traffic_priority);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Sustained Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_max_sustained_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Traffic Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_traffic_burst);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Minimum Reserved Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_min_reserved_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Assumed Minimum Reserved Traffic Rate Packet Size",NULL,FMT_DEC,&hf_cops_pcmm_ass_min_rtr_packet_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,2,"Reserved",NULL,FMT_HEX,&hf_cops_pc_reserved);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Downstream Latency",NULL,FMT_DEC,&hf_cops_pcmm_max_downstream_latency);\r\noffset += 4;\r\nif (n < 56) return offset;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, 24, ett_cops_subtree, NULL, "Reserved Envelope");\r\ninfo_to_display(tvb,object_tree,offset,1,"Traffic Priority",NULL,FMT_HEX,&hf_cops_pcmm_traffic_priority);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Sustained Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_max_sustained_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Traffic Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_traffic_burst);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Minimum Reserved Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_min_reserved_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Assumed Minimum Reserved Traffic Rate Packet Size",NULL,FMT_DEC,&hf_cops_pcmm_ass_min_rtr_packet_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,2,"Reserved",NULL,FMT_HEX,&hf_cops_pc_reserved);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Downstream Latency",NULL,FMT_DEC,&hf_cops_pcmm_max_downstream_latency);\r\noffset += 4;\r\nif (n < 80) return offset;\r\nobject_tree = proto_tree_add_subtree(stt, tvb, offset, 24, ett_cops_subtree, NULL, "Committed Envelope");\r\ninfo_to_display(tvb,object_tree,offset,1,"Traffic Priority",NULL,FMT_HEX,&hf_cops_pcmm_traffic_priority);\r\noffset += 1;\r\nproto_tree_add_item(object_tree, hf_cops_reserved24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Sustained Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_max_sustained_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Traffic Burst",NULL,FMT_DEC,&hf_cops_pcmm_max_traffic_burst);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,4,"Minimum Reserved Traffic Rate",NULL,FMT_DEC,&hf_cops_pcmm_min_reserved_traffic_rate);\r\noffset += 4;\r\ninfo_to_display(tvb,object_tree,offset,2,"Assumed Minimum Reserved Traffic Rate Packet Size",NULL,FMT_DEC,&hf_cops_pcmm_ass_min_rtr_packet_size);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,2,"Reserved",NULL,FMT_HEX,&hf_cops_pc_reserved);\r\noffset += 2;\r\ninfo_to_display(tvb,object_tree,offset,4,"Maximum Downstream Latency",NULL,FMT_DEC,&hf_cops_pcmm_max_downstream_latency);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic void\r\ncops_mm_event_generation_info(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Event Generation Info");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,4,"PRKS IP Address", NULL,FMT_IPv4,&hf_cops_pc_prks_ip);\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,2,"PRKS IP Port",NULL,FMT_DEC,&hf_cops_pc_prks_ip_port);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,2,"Reserved",NULL,FMT_HEX,&hf_cops_pc_reserved);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,4,"SRKS IP Address", NULL,FMT_IPv4,&hf_cops_pc_srks_ip);\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,2,"SRKS IP Port",NULL,FMT_DEC,&hf_cops_pc_srks_ip_port);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,2,"Reserved",NULL,FMT_HEX,&hf_cops_pc_reserved);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,4,"BCID - Timestamp",NULL,FMT_HEX,&hf_cops_pc_bcid_ts);\r\noffset += 4;\r\nproto_tree_add_item(stt, hf_cops_pc_bcid_id, tvb, offset, 8, ENC_ASCII|ENC_NA);\r\noffset += 8;\r\nproto_tree_add_item(stt, hf_cops_pc_bcid_tz, tvb, offset, 8, ENC_ASCII|ENC_NA);\r\noffset += 8;\r\ninfo_to_display(tvb,stt,offset,4,"BCID - Event Counter",NULL,FMT_DEC,&hf_cops_pc_bcid_ev);\r\n}\r\nstatic int\r\ncops_volume_based_usage_limit(tvbuff_t *tvb, proto_tree *st, guint object_len, guint32 offset) {\r\nproto_tree *stt;\r\nstt = info_to_cops_subtree(tvb,st,object_len,offset,"Volume-Based Usage Limit");\r\noffset += 4;\r\nproto_tree_add_item(stt, hf_cops_pcmm_volume_based_usage_limit, tvb, offset, 8,\r\nENC_BIG_ENDIAN);\r\noffset += 8;\r\nreturn offset;\r\n}\r\nstatic int\r\ncops_time_based_usage_limit(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Time-Based Usage Limit");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,4,"Time Limit", NULL,FMT_DEC,&hf_cops_pcmm_time_based_usage_limit);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic void\r\ncops_opaque_data(tvbuff_t *tvb, proto_tree *st, guint object_len, guint32 offset) {\r\nproto_tree *stt;\r\nstt = info_to_cops_subtree(tvb,st,object_len,offset,"Opaque Data");\r\noffset += 4;\r\nproto_tree_add_item(stt, hf_cops_opaque_data, tvb, offset, 8, ENC_NA);\r\n}\r\nstatic int\r\ncops_gate_time_info(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Gate Time Info");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,4,"Time Committed", NULL,FMT_DEC,&hf_cops_pcmm_gate_time_info);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic void\r\ncops_gate_usage_info(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Gate Usage Info");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,8,"Octet Count", NULL,FMT_DEC,&hf_cops_pcmm_gate_usage_info);\r\n}\r\nstatic int\r\ncops_packetcable_mm_error(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt;\r\nguint16 code, subcode;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"PacketCable Error");\r\noffset += 4;\r\ncode = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_uint_format(stt, hf_cops_pcmm_packetcable_error_code, tvb, offset, 2, code,\r\n"Error Code: %s (%u)", val_to_str_const(code, pcmm_packetcable_error_code, "Unknown"),\r\ncode);\r\noffset += 2;\r\nsubcode = tvb_get_ntohs(tvb, offset);\r\nif (code == 6 || code == 7)\r\nproto_tree_add_uint_format(stt, hf_cops_pcmm_packetcable_error_subcode,\r\ntvb, offset, 2, code, "Error-Subcode: 0x%02x, S-Num: 0x%02x, S-Type: 0x%02x",\r\nsubcode, subcode >> 8, subcode & 0xf);\r\nelse\r\nproto_tree_add_uint_format(stt, hf_cops_pcmm_packetcable_error_subcode,\r\ntvb, offset, 2, code, "Error-Subcode: 0x%04x", subcode);\r\noffset += 2;\r\nreturn offset;\r\n}\r\nstatic int\r\ncops_gate_state(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Gate State");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,2,"State",pcmm_gate_state,FMT_DEC,&hf_cops_pcmm_packetcable_gate_state);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,2,"Reason",pcmm_gate_state_reason,FMT_DEC,&hf_cops_pcmm_packetcable_gate_state_reason);\r\noffset += 2;\r\nreturn offset;\r\n}\r\nstatic int\r\ncops_version_info(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Version Info");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,2,"Major Version Number",NULL,FMT_DEC,&hf_cops_pcmm_packetcable_version_info_major);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,2,"Minor Version Number",NULL,FMT_DEC,&hf_cops_pcmm_packetcable_version_info_minor);\r\noffset += 2;\r\nreturn offset;\r\n}\r\nstatic void\r\ncops_psid(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"PSID");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,4,"PSID", NULL,FMT_DEC,&hf_cops_pcmm_psid);\r\n}\r\nstatic int\r\ncops_synch_options(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Synch Options");\r\noffset += 4;\r\nproto_tree_add_item(stt, hf_cops_reserved16, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\ninfo_to_display(tvb,stt,offset,1,"Report Type", pcmm_report_type_vals,FMT_DEC,&hf_cops_pcmm_synch_options_report_type);\r\noffset += 1;\r\ninfo_to_display(tvb,stt,offset,1,"Synch Type", pcmm_synch_type_vals,FMT_DEC,&hf_cops_pcmm_synch_options_synch_type);\r\noffset += 1;\r\nreturn offset;\r\n}\r\nstatic void\r\ncops_msg_receipt_key(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"Msg Receipt Key");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,4,"Msg Receipt Key", NULL,FMT_HEX,&hf_cops_pcmm_msg_receipt_key);\r\n}\r\nstatic void\r\ncops_userid(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt;\r\nstt = info_to_cops_subtree(tvb, st, n, offset, "UserID");\r\noffset += 4;\r\ninfo_to_display(tvb, stt, offset, n-4, "UserID", NULL, FMT_STR, &hf_cops_pcmm_userid);\r\n}\r\nstatic void\r\ncops_sharedresourceid(tvbuff_t *tvb, proto_tree *st, guint n, guint32 offset) {\r\nproto_tree *stt;\r\nstt = info_to_cops_subtree(tvb,st,n,offset,"SharedResourceID");\r\noffset += 4;\r\ninfo_to_display(tvb,stt,offset,4,"SharedResourceID", NULL,FMT_HEX,&hf_cops_pcmm_sharedresourceid);\r\n}\r\nstatic void\r\ncops_analyze_packetcable_dqos_obj(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint8 op_code, guint32 offset) {\r\ngint remdata;\r\nguint16 object_len;\r\nguint8 s_num, s_type;\r\nguint16 num_type_glob;\r\nif ( cops_packetcable == FALSE ) {\r\nreturn;\r\n}\r\nremdata = tvb_reported_length_remaining(tvb, offset);\r\nwhile (remdata > 4) {\r\nobject_len = tvb_get_ntohs(tvb, offset);\r\nif (object_len < 4) {\r\nproto_tree_add_expert_format(tree, pinfo, &ei_cops_bad_cops_object_length, tvb, offset, 2,\r\n"Incorrect PacketCable object length %u < 4", object_len);\r\nreturn;\r\n}\r\ns_num = tvb_get_guint8(tvb, offset + 2);\r\ns_type = tvb_get_guint8(tvb, offset + 3);\r\nnum_type_glob = s_num << 8 | s_type;\r\nswitch (num_type_glob){\r\ncase PCDQ_TRANSACTION_ID:\r\ncops_transaction_id(tvb, pinfo, tree, op_code, object_len, offset);\r\nbreak;\r\ncase PCDQ_SUBSCRIBER_IDv4:\r\ncops_subscriber_id_v4(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCDQ_SUBSCRIBER_IDv6:\r\ncops_subscriber_id_v6(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCDQ_GATE_ID:\r\ncops_gate_id(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCDQ_ACTIVITY_COUNT:\r\ncops_activity_count(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCDQ_GATE_SPEC:\r\ncops_gate_specs(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCDQ_REMOTE_GATE_INFO:\r\ncops_remote_gate_info(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCDQ_EVENT_GENERATION_INFO:\r\ncops_event_generation_info(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCDQ_PACKETCABLE_ERROR:\r\ncops_packetcable_error(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCDQ_ELECTRONIC_SURVEILLANCE:\r\ncops_surveillance_parameters(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCDQ_PACKETCABLE_REASON:\r\ncops_packetcable_reason(tvb, tree, object_len, offset);\r\nbreak;\r\n}\r\noffset += object_len;\r\nremdata = tvb_reported_length_remaining(tvb, offset);\r\n}\r\n}\r\nstatic void\r\ndecode_docsis_request_transmission_policy(tvbuff_t *tvb, guint32 offset, proto_tree *tree) {\r\nstatic const int *policies[] = {\r\n&hf_cops_pcmm_request_transmission_policy_sf_all_cm,\r\n&hf_cops_pcmm_request_transmission_policy_sf_priority,\r\n&hf_cops_pcmm_request_transmission_policy_sf_request_for_request,\r\n&hf_cops_pcmm_request_transmission_policy_sf_data_for_data,\r\n&hf_cops_pcmm_request_transmission_policy_sf_piggyback,\r\n&hf_cops_pcmm_request_transmission_policy_sf_concatenate,\r\n&hf_cops_pcmm_request_transmission_policy_sf_fragment,\r\n&hf_cops_pcmm_request_transmission_policy_sf_supress,\r\n&hf_cops_pcmm_request_transmission_policy_sf_drop_packets,\r\nNULL\r\n};\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_cops_pcmm_request_transmission_policy,\r\nett_docsis_request_transmission_policy,\r\npolicies,\r\nENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ncops_analyze_packetcable_mm_obj(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint8 op_code, guint32 offset) {\r\nguint16 object_len;\r\nguint8 s_num, s_type;\r\nguint16 num_type_glob;\r\nif ( cops_packetcable == FALSE ) {\r\nreturn;\r\n}\r\nwhile (tvb_reported_length_remaining(tvb, offset) > 4) {\r\nobject_len = tvb_get_ntohs(tvb, offset);\r\nif (object_len < 4) {\r\nproto_tree_add_expert_format(tree, pinfo, &ei_cops_bad_cops_object_length, tvb, offset, 2,\r\n"Incorrect PacketCable object length %u < 4", object_len);\r\nreturn;\r\n}\r\ns_num = tvb_get_guint8(tvb, offset + 2);\r\ns_type = tvb_get_guint8(tvb, offset + 3);\r\nnum_type_glob = s_num << 8 | s_type;\r\nswitch (num_type_glob){\r\ncase PCMM_TRANSACTION_ID:\r\ncops_mm_transaction_id(tvb, pinfo, tree, op_code, object_len, offset);\r\nbreak;\r\ncase PCMM_AMID:\r\ncops_amid(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCMM_SUBSCRIBER_ID:\r\ncops_subscriber_id_v4(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCMM_SUBSCRIBER_ID_V6:\r\ncops_subscriber_id_v6(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCMM_GATE_ID:\r\ncops_gate_id(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCMM_GATE_SPEC:\r\ncops_mm_gate_spec(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCMM_CLASSIFIER:\r\ncops_classifier(tvb, tree, object_len, offset, FALSE);\r\nbreak;\r\ncase PCMM_EXTENDED_CLASSIFIER:\r\ncops_classifier(tvb, tree, object_len, offset, TRUE);\r\nbreak;\r\ncase PCMM_IPV6_CLASSIFIER:\r\ncops_ipv6_classifier(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCMM_FLOW_SPEC:\r\ncops_flow_spec(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCMM_DOCSIS_SERVICE_CLASS_NAME:\r\ncops_docsis_service_class_name(tvb, pinfo, tree, object_len, offset);\r\nbreak;\r\ncase PCMM_BEST_EFFORT_SERVICE:\r\nif (object_len == 44 || object_len == 80 || object_len == 116)\r\ncops_best_effort_service_i04_i05(tvb, tree, object_len, offset, TRUE);\r\nelse if (object_len == 40 || object_len == 72 || object_len == 104)\r\ncops_best_effort_service_i04_i05(tvb, tree, object_len, offset, FALSE);\r\nelse\r\ncops_best_effort_service(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCMM_NON_REAL_TIME_POLLING_SERVICE:\r\nif (object_len == 48 || object_len == 88 || object_len == 128)\r\ncops_non_real_time_polling_service_i04_i05(tvb, tree, object_len, offset, TRUE);\r\nelse if (object_len == 44 || object_len == 80 || object_len == 116)\r\ncops_non_real_time_polling_service_i04_i05(tvb, tree, object_len, offset, FALSE);\r\nelse\r\ncops_non_real_time_polling_service(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCMM_REAL_TIME_POLLING_SERVICE:\r\nif (object_len == 48 || object_len == 88 || object_len == 128)\r\ncops_real_time_polling_service_i04_i05(tvb, tree, object_len, offset, TRUE);\r\nelse if (object_len == 44 || object_len == 80 || object_len == 116)\r\ncops_real_time_polling_service_i04_i05(tvb, tree, object_len, offset, FALSE);\r\nelse\r\ncops_real_time_polling_service(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCMM_UNSOLICITED_GRANT_SERVICE:\r\nif (object_len == 36 || object_len == 64 || object_len == 92)\r\ncops_unsolicited_grant_service_i04_i05(tvb, tree, object_len, offset, TRUE);\r\nelse if (object_len == 32 || object_len == 56 || object_len == 80)\r\ncops_unsolicited_grant_service_i04_i05(tvb, tree, object_len, offset, FALSE);\r\nelse\r\ncops_unsolicited_grant_service(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCMM_UGS_WITH_ACTIVITY_DETECTION:\r\nif (object_len == 44 || object_len == 80 || object_len == 116)\r\ncops_ugs_with_activity_detection_i04_i05(tvb, tree, object_len, offset, TRUE);\r\nelse if (object_len == 40 || object_len == 72 || object_len == 104)\r\ncops_ugs_with_activity_detection_i04_i05(tvb, tree, object_len, offset, FALSE);\r\nelse\r\ncops_ugs_with_activity_detection(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCMM_DOWNSTREAM_SERVICE:\r\nif (object_len == 48 || object_len == 88 || object_len == 128)\r\ncops_downstream_service_i04_i05(tvb, tree, object_len, offset, TRUE);\r\nelse if (object_len == 40 || object_len == 72 || object_len == 104)\r\ncops_downstream_service_i04_i05(tvb, tree, object_len, offset, FALSE);\r\nelse\r\ncops_downstream_service(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCMM_UPSTREAM_DROP:\r\ncops_upstream_drop_i04(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCMM_EVENT_GENERATION_INFO:\r\ncops_mm_event_generation_info(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCMM_VOLUME_BASED_USAGE_LIMIT:\r\ncops_volume_based_usage_limit(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCMM_TIME_BASED_USAGE_LIMIT:\r\ncops_time_based_usage_limit(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCMM_OPAQUE_DATA:\r\ncops_opaque_data(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCMM_GATE_TIME_INFO:\r\ncops_gate_time_info(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCMM_GATE_USAGE_INFO:\r\ncops_gate_usage_info(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCMM_PACKETCABLE_ERROR:\r\ncops_packetcable_mm_error(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCMM_GATE_STATE:\r\ncops_gate_state(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCMM_VERSION_INFO:\r\ncops_version_info(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCMM_PSID:\r\ncops_psid(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCMM_SYNCH_OPTIONS:\r\ncops_synch_options(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCMM_MSG_RECEIPT_KEY:\r\ncops_msg_receipt_key(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCMM_USERID:\r\ncops_userid(tvb, tree, object_len, offset);\r\nbreak;\r\ncase PCMM_SHAREDRESOURCEID:\r\ncops_sharedresourceid(tvb, tree, object_len, offset);\r\nbreak;\r\n}\r\noffset += object_len;\r\n}\r\n}
