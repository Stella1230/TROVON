static guint64 decode_utf8(guint64 utf8)\r\n{\r\nstatic guint64 unicode;\r\nif (utf8 <= G_GUINT64_CONSTANT(0xFF))\r\n{\r\nunicode =\r\nutf8 & G_GUINT64_CONSTANT(0x7F);\r\n}\r\nelse if (utf8 <= G_GUINT64_CONSTANT(0xFFFF))\r\n{\r\nunicode =\r\n((utf8 & G_GUINT64_CONSTANT(0x1F00) >> 2) +\r\n(utf8 & G_GUINT64_CONSTANT(0x3F)));\r\n}\r\nelse if (utf8 <= G_GUINT64_CONSTANT(0xFFFFFF))\r\n{\r\nunicode =\r\n((utf8 & G_GUINT64_CONSTANT(0x0F0000)) >> 4) +\r\n((utf8 & G_GUINT64_CONSTANT(0x3F00)) >> 2) +\r\n(utf8 & G_GUINT64_CONSTANT(0x3F));\r\n}\r\nelse if (utf8 <= G_GUINT64_CONSTANT(0xFFFFFFFF))\r\n{\r\nunicode =\r\n((utf8 & G_GUINT64_CONSTANT(0x07000000)) >> 6) +\r\n((utf8 & G_GUINT64_CONSTANT(0x3F0000)) >> 4) +\r\n((utf8 & G_GUINT64_CONSTANT(0x3F00)) >> 2) +\r\n(utf8 & G_GUINT64_CONSTANT(0x3F));\r\n}\r\nelse if (utf8 <= G_GUINT64_CONSTANT(0xFFFFFFFFFF))\r\n{\r\nunicode =\r\n((utf8 & G_GUINT64_CONSTANT(0x0300000000)) >> 8) +\r\n((utf8 & G_GUINT64_CONSTANT(0x3F000000)) >> 6) +\r\n((utf8 & G_GUINT64_CONSTANT(0x3F0000)) >> 4) +\r\n((utf8 & G_GUINT64_CONSTANT(0x3F00)) >> 2) +\r\n(utf8 & G_GUINT64_CONSTANT(0x3F));\r\n}\r\nelse if (utf8 <= G_GUINT64_CONSTANT(0xFFFFFFFFFFFF))\r\n{\r\nunicode =\r\n((utf8 & G_GUINT64_CONSTANT(0x010000000000)) >> 10) +\r\n((utf8 & G_GUINT64_CONSTANT(0x3F00000000)) >> 8) +\r\n((utf8 & G_GUINT64_CONSTANT(0x3F000000)) >> 6) +\r\n((utf8 & G_GUINT64_CONSTANT(0x3F0000)) >> 4) +\r\n((utf8 & G_GUINT64_CONSTANT(0x3F00)) >> 2) +\r\n(utf8 & G_GUINT64_CONSTANT(0x3F));\r\n}\r\nelse\r\n{\r\nunicode = G_GUINT64_CONSTANT(0);\r\n}\r\nreturn unicode;\r\n}\r\nstatic char *decode_key_name(int unicode)\r\n{\r\nchar *key_name;\r\nkey_name = (char *)wmem_alloc(wmem_packet_scope(), 10);\r\nif ((unicode <= 0x20)\r\n|| (unicode == 0x7F)\r\n|| (unicode == 0xE0)\r\n|| (unicode == 0xE7)\r\n|| (unicode == 0xE8)\r\n|| (unicode == 0xE9)\r\n|| (unicode == 0xF9))\r\n{\r\ng_snprintf(key_name, 10, "%s", val_to_str_ext_const(unicode, &str_key_name_ext, "Unknown"));\r\n}\r\nelse if (unicode <= 0xFF)\r\n{\r\ng_snprintf(key_name, 10, "%c", unicode);\r\n}\r\nelse\r\n{\r\ng_snprintf(key_name, 10, "%s", val_to_str_ext_const(unicode, &str_key_name_ext, "Unknown"));\r\n}\r\nreturn key_name;\r\n}\r\nstatic void decode_evt_error(proto_tree *tree,\r\ntvbuff_t *tvb,\r\nguint offset,\r\nguint length)\r\n{\r\nif (!tree)\r\nreturn;\r\nproto_tree_add_item(tree, hf_noe_errcode, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nlength -= 2;\r\nproto_tree_add_item(tree, hf_noe_method, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlength -= 1;\r\nproto_tree_add_item(tree, hf_noe_class, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlength -= 1;\r\nproto_tree_add_item(tree, hf_noe_objectid, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nlength -= 2;\r\nproto_tree_add_item(tree, hf_noe_pcode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlength -= 1;\r\nproto_tree_add_item(tree, hf_noe_aindx, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlength -= 1;\r\nproto_tree_add_item(tree, hf_noe_length, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nlength -= 2;\r\nproto_tree_add_item(tree, hf_noe_value, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nlength -= 4;\r\nproto_tree_add_item(tree, hf_noe_message, tvb, offset, length, ENC_NA);\r\n}\r\nstatic void decode_tlv(proto_tree *tree,\r\ntvbuff_t *tvb,\r\nguint offset,\r\nguint length)\r\n{\r\nproto_tree *property_tree;\r\nguint8 property_type;\r\nguint16 property_length;\r\nproperty_tree = proto_tree_add_subtree(tree,\r\ntvb,\r\noffset,\r\nlength, ett_body, NULL,\r\n"NOE Message Body");\r\nwhile(length > 0)\r\n{\r\nproperty_type = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(property_tree, hf_noe_pcode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlength -= 1;\r\nif (property_type >= P_ARRAY)\r\n{\r\nproto_tree_add_item(property_tree, hf_noe_aindx, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlength -= 1;\r\n}\r\nproperty_length = tvb_get_guint8(tvb, offset);\r\nif (property_length & 0x80)\r\n{\r\nproperty_length = tvb_get_ntohs(tvb, offset);\r\nproperty_length &= 0x7fff;\r\nproto_tree_add_uint(property_tree, hf_noe_psize, tvb, offset, 2,\r\ntvb_get_guint8(tvb, offset) * 256 + tvb_get_guint8(tvb, offset+1));\r\noffset += 2;\r\nlength -= 2;\r\n}\r\nelse\r\n{\r\nproto_tree_add_uint(property_tree, hf_noe_psize, tvb, offset, 1,\r\ntvb_get_guint8(tvb, offset));\r\noffset += 1;\r\nlength -= 1;\r\n}\r\nswitch(property_length)\r\n{\r\ncase 0:\r\n{\r\nbreak;\r\n}\r\ncase 1:\r\nproto_tree_add_item(property_tree, hf_noe_property_item_u8, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlength -= 1;\r\nbreak;\r\ncase 2:\r\nproto_tree_add_item(property_tree, hf_noe_property_item_u16, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nlength -= 2;\r\nbreak;\r\ncase 3:\r\nproto_tree_add_item(property_tree, hf_noe_property_item_u24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\nlength -= 3;\r\nbreak;\r\ncase 4:\r\nproto_tree_add_item(property_tree, hf_noe_property_item_u32, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nlength -= 4;\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(property_tree, hf_noe_property_item_bytes, tvb, offset, property_length, ENC_NA);\r\noffset += property_length;\r\nlength -= property_length;\r\nbreak;\r\n}\r\n}\r\n}\r\nstatic void decode_getproperty_tlv(proto_tree *tree,\r\ntvbuff_t *tvb,\r\nguint offset,\r\nguint length)\r\n{\r\nproto_tree *body_tree;\r\nguint8 body_type;\r\nbody_tree = proto_tree_add_subtree(tree,\r\ntvb,\r\noffset,\r\nlength, ett_property, NULL,\r\n"NOE Message Body");\r\nwhile(length > 0)\r\n{\r\nbody_type = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(body_tree, hf_noe_pcode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlength -= 1;\r\nif (body_type >= P_ARRAY)\r\n{\r\nproto_tree_add_item(body_tree, hf_noe_aindx, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlength -= 1;\r\n}\r\n}\r\n}\r\nstatic void decode_evt(proto_tree *tree,\r\ntvbuff_t *tvb,\r\npacket_info *pinfo,\r\nguint offset,\r\nguint length)\r\n{\r\nproto_item *ti;\r\nguint8 event = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_noe_event, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " %s",\r\nval_to_str_ext_const(event, &val_str_event_ext, "Unknown"));\r\nproto_item_append_text(tree, ", %s",\r\nval_to_str_ext_const(event, &val_str_event_ext, "Unknown"));\r\noffset += 1;\r\nlength -= 1;\r\nswitch(event)\r\n{\r\ncase OPCODE_EVT_BT_KEY_SHORTPRESS:\r\ncase OPCODE_EVT_BT_KEY_LONGPRESS:\r\ncase OPCODE_EVT_BT_KEY_VERYLONGPRESS:\r\ncase OPCODE_EVT_KEY_LINE:\r\ncase OPCODE_EVT_ONHOOK:\r\ncase OPCODE_EVT_OFFHOOK:\r\nti = proto_tree_add_item(tree, hf_event_value_u8, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_set_len(ti, length);\r\nbreak;\r\ncase OPCODE_EVT_KEY_PRESS:\r\ncase OPCODE_EVT_KEY_RELEASE:\r\ncase OPCODE_EVT_KEY_SHORTPRESS:\r\ncase OPCODE_EVT_KEY_LONGPRESS:\r\ncase OPCODE_EVT_HELP:\r\n{\r\nguint64 utf8_value = 0;\r\nguint64 unicode_value;\r\nchar *key_name;\r\nint pt_length = length;\r\nint pt_offset = offset;\r\nwhile(pt_length > 0)\r\n{\r\nutf8_value = (utf8_value << 8) + tvb_get_guint8(tvb, pt_offset);\r\npt_offset += 1;\r\npt_length -= 1;\r\n}\r\nunicode_value = decode_utf8(utf8_value);\r\nkey_name = (char *)wmem_alloc(wmem_packet_scope(), 30);\r\ng_snprintf(key_name, 30, "\"%s\"", decode_key_name((int)unicode_value));\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ": %s", key_name);\r\nproto_item_append_text(tree, ", %s",\r\nkey_name);\r\nproto_tree_add_string_format_value(tree, hf_noe_key_name,\r\ntvb,\r\noffset,\r\nlength, key_name,\r\n"%s (UTF-8 Value: %s, Unicode Value: 0x%" G_GINT64_MODIFIER "x)",\r\nkey_name,\r\ntvb_bytes_to_str(wmem_packet_scope(), tvb, offset, length),\r\nunicode_value);\r\nbreak;\r\n}\r\ncase OPCODE_EVT_ERROR_PROTOCOL:\r\ncase OPCODE_EVT_ERROR_CREATE:\r\ncase OPCODE_EVT_ERROR_DELETE:\r\ncase OPCODE_EVT_ERROR_SET_PROPERTY:\r\ncase OPCODE_EVT_ERROR_GET_PROPERTY:\r\n{\r\ndecode_evt_error(tree, tvb, offset, length);\r\nbreak;\r\n}\r\ncase OPCODE_EVT_CONTEXT_SWITCH:\r\nproto_tree_add_item(tree, hf_event_context_switch, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase OPCODE_EVT_SUCCESS_CREATE:\r\ncase OPCODE_EVT_SUCCESS_DELETE:\r\ncase OPCODE_EVT_SUCCESS_SET_PROPERTY:\r\ncase OPCODE_EVT_SUCCESS_INSERT_ITEM:\r\ncase OPCODE_EVT_SUCCESS_DELETE_ITEM:\r\nproto_tree_add_item(tree, hf_noe_objectid, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase OPCODE_EVT_WIDGETS_GC:\r\nproto_tree_add_item(tree, hf_event_widget_gc, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase OPCODE_EVT_BT_BONDING_RESULT:\r\n{\r\nproto_tree_add_item(tree, hf_noe_objectid, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_noe_bonded, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_uint_format_value(tree, hf_noe_value,\r\ntvb,\r\noffset,\r\n1, tvb_get_ntohs(tvb, offset),\r\n"%d",\r\ntvb_get_ntohs(tvb, offset));\r\nbreak;\r\n}\r\ndefault:\r\nproto_tree_add_item(tree, hf_noe_objectid, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nlength -= 2;\r\nif (length > 0)\r\ndecode_tlv(tree, tvb, offset, length);\r\nbreak;\r\n}\r\n}\r\nstatic void decode_mtd(proto_tree *tree,\r\ntvbuff_t *tvb,\r\npacket_info *pinfo,\r\nguint8 method,\r\nguint offset,\r\nguint length)\r\n{\r\nguint8 noe_class = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_noe_class, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " %s",\r\nval_to_str_ext_const(noe_class, &val_str_class_ext, "Unknown"));\r\nproto_item_append_text(tree, ", %s",\r\nval_to_str_ext_const(noe_class, &val_str_class_ext, "Unknown"));\r\noffset += 1;\r\nlength -= 1;\r\nif (noe_class >= C_DYNAMIC)\r\n{\r\nproto_tree_add_item(tree, hf_noe_objectid, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nlength -= 2;\r\n}\r\nswitch(method)\r\n{\r\ncase METHOD_INSERT_ITEM:\r\n{\r\nproto_tree_add_item(tree, hf_noe_method_index, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlength -= 1;\r\nif (length > 0)\r\ndecode_tlv(tree, tvb, offset, length);\r\nbreak;\r\n}\r\ncase METHOD_DELETE_ITEM:\r\n{\r\nproto_tree_add_item(tree, hf_noe_method_index, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\ncase METHOD_GET_PROPERTY:\r\n{\r\ndecode_getproperty_tlv(tree, tvb, offset, length);\r\nbreak;\r\n}\r\ndefault:\r\n{\r\nif (length > 0)\r\ndecode_tlv(tree, tvb, offset, length);\r\nbreak;\r\n}\r\n}\r\n}\r\nstatic int dissect_noe(tvbuff_t *tvb,\r\npacket_info *pinfo,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nproto_item *noe_item;\r\nproto_tree *noe_tree;\r\ngint length;\r\nguint8 server;\r\nguint8 method;\r\ngboolean methodack;\r\ngint offset = 0;\r\nnoe_item = proto_tree_add_item(tree, proto_noe, tvb, 0, -1, ENC_NA);\r\nnoe_tree = proto_item_add_subtree(noe_item, ett_noe);\r\nlength = tvb_get_letohs(tvb, offset);\r\nproto_tree_add_uint(noe_tree,\r\nhf_noe_length,\r\ntvb,\r\noffset,\r\n2,\r\nlength);\r\noffset += 2;\r\nserver = tvb_get_guint8(tvb, offset);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " - NOE Protocol (%s)",\r\nval_to_str_const(server, servers_short_vals, "Unknown"));\r\nproto_tree_add_uint(noe_tree,\r\nhf_noe_server,\r\ntvb,\r\noffset,\r\n1,\r\nserver);\r\noffset += 1;\r\nlength -= 1;\r\nproto_item_append_text(noe_item, ", %s",\r\nval_to_str_const(server, servers_short_vals, "Unknown"));\r\nmethod = tvb_get_guint8(tvb, offset);\r\nmethodack = (method & 0x80) != 0;\r\nmethod = (method & 0x7f);\r\nproto_tree_add_uint_format_value(noe_tree,\r\nhf_noe_method,\r\ntvb,\r\noffset,\r\n1,\r\nmethod,\r\n"%s (%d)",\r\nval_to_str_const(method, methods_vals, "Unknown"),\r\nmethod);\r\nif (method >= METHOD_INVALID)\r\nreturn offset;\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ": %s",\r\nval_to_str_const(method, methods_vals, "Unknown"));\r\nproto_item_append_text(noe_item, ", %s",\r\nval_to_str_const(method, methods_vals, "Unknown"));\r\nif (method == METHOD_NOTIFY)\r\n{\r\noffset += 1;\r\nlength -= 1;\r\ndecode_evt(noe_tree, tvb, pinfo, offset, length);\r\n}\r\nelse\r\n{\r\nproto_tree_add_boolean(noe_tree,\r\nhf_noe_method_ack,\r\ntvb,\r\noffset,\r\n1,\r\nmethodack);\r\noffset += 1;\r\nlength -= 1;\r\ndecode_mtd(noe_tree, tvb, pinfo, method, offset, length);\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid proto_register_noe(void)\r\n{\r\nstatic hf_register_info hf_noe[] =\r\n{\r\n{ &hf_noe_length,\r\n{\r\n"Length",\r\n"noe.length",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\n"Method Length",\r\nHFILL\r\n}\r\n},\r\n{ &hf_noe_server,\r\n{\r\n"Server",\r\n"noe.server",\r\nFT_UINT8,\r\nBASE_HEX,\r\nVALS(servers_vals),\r\n0x0,\r\n"Method Opcode",\r\nHFILL\r\n}\r\n},\r\n{ &hf_noe_method_ack,\r\n{\r\n"Ack",\r\n"noe.method_ack",\r\nFT_BOOLEAN,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\n"Method Acknowledge",\r\nHFILL\r\n}\r\n},\r\n{ &hf_noe_method,\r\n{\r\n"Method",\r\n"noe.method",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(methods_vals),\r\n0x0,\r\n"Method Opcode",\r\nHFILL\r\n}\r\n},\r\n{ &hf_noe_class,\r\n{\r\n"Class",\r\n"noe.class",\r\nFT_UINT8,\r\nBASE_DEC|BASE_EXT_STRING,\r\n&val_str_class_ext,\r\n0x0,\r\n"Class Opcode",\r\nHFILL\r\n}\r\n},\r\n{ &hf_noe_event,\r\n{\r\n"Event",\r\n"noe.event",\r\nFT_UINT8,\r\nBASE_DEC|BASE_EXT_STRING,\r\n&val_str_event_ext,\r\n0x0,\r\n"Event Opcode",\r\nHFILL\r\n}\r\n},\r\n{ &hf_noe_objectid,\r\n{\r\n"Objectid",\r\n"noe.objectid",\r\nFT_UINT16,\r\nBASE_HEX,\r\nNULL,\r\n0x0,\r\n"Object Identifier",\r\nHFILL\r\n}\r\n},\r\n{ &hf_noe_method_index,\r\n{\r\n"ItemIndx",\r\n"noe.item_index",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\n"Delete/Insert Index",\r\nHFILL\r\n}\r\n},\r\n{ &hf_noe_pcode,\r\n{\r\n"Property",\r\n"noe.property",\r\nFT_UINT8,\r\nBASE_HEX|BASE_EXT_STRING,\r\n&val_str_props_ext,\r\n0x0,\r\n"Property Identifier",\r\nHFILL\r\n}\r\n},\r\n{ &hf_noe_psize,\r\n{\r\n"PropLength",\r\n"noe.prop_len",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\n"Property Length",\r\nHFILL\r\n}\r\n},\r\n{ &hf_noe_errcode,\r\n{\r\n"ErrCode",\r\n"noe.errcode",\r\nFT_UINT16,\r\nBASE_DEC|BASE_EXT_STRING,\r\n&errcode_vals_ext,\r\n0x0,\r\n"Error Code",\r\nHFILL\r\n}\r\n},\r\n{ &hf_noe_aindx,\r\n{\r\n"ArrIndex",\r\n"noe.array_index",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\n"Array Index",\r\nHFILL\r\n}\r\n},\r\n{ &hf_noe_value,\r\n{\r\n"Value",\r\n"noe.value",\r\nFT_UINT32,\r\nBASE_HEX,\r\nNULL,\r\n0x0,\r\nNULL,\r\nHFILL\r\n}\r\n},\r\n{ &hf_noe_message,\r\n{\r\n"Message",\r\n"noe.messages",\r\nFT_BYTES,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL,\r\nHFILL\r\n}\r\n},\r\n{ &hf_noe_property_item_u8,\r\n{\r\n"Value",\r\n"noe.property_item.uint",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL,\r\nHFILL\r\n}\r\n},\r\n{ &hf_noe_property_item_u16,\r\n{\r\n"Value",\r\n"noe.property_item.uint",\r\nFT_UINT16,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL,\r\nHFILL\r\n}\r\n},\r\n{ &hf_noe_property_item_u24,\r\n{\r\n"Value",\r\n"noe.property_item.uint",\r\nFT_UINT24,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL,\r\nHFILL\r\n}\r\n},\r\n{ &hf_noe_property_item_u32,\r\n{\r\n"Value",\r\n"noe.property_item.uint",\r\nFT_UINT32,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL,\r\nHFILL\r\n}\r\n},\r\n{ &hf_noe_property_item_bytes,\r\n{\r\n"Value",\r\n"noe.property_item.bytes",\r\nFT_BYTES,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL,\r\nHFILL\r\n}\r\n},\r\n{ &hf_event_value_u8,\r\n{\r\n"Value",\r\n"noe.event_value.uint",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(noe_event_str_struct),\r\n0x0,\r\nNULL,\r\nHFILL\r\n}\r\n},\r\n{ &hf_event_context_switch,\r\n{\r\n"Context",\r\n"noe.event_context_switch",\r\nFT_UINT8,\r\nBASE_DEC,\r\nVALS(servers_vals),\r\n0x0,\r\nNULL,\r\nHFILL\r\n}\r\n},\r\n{ &hf_event_widget_gc,\r\n{\r\n"FreeMem (bytes)",\r\n"noe.event_widget_gc",\r\nFT_UINT32,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL,\r\nHFILL\r\n}\r\n},\r\n{ &hf_noe_bonded,\r\n{\r\n"Bonded",\r\n"noe.bonded",\r\nFT_UINT8,\r\nBASE_DEC,\r\nNULL,\r\n0x0,\r\nNULL,\r\nHFILL\r\n}\r\n},\r\n{ &hf_noe_key_name,\r\n{\r\n"Key name",\r\n"noe.keyname",\r\nFT_STRING,\r\nBASE_NONE,\r\nNULL,\r\n0x0,\r\nNULL,\r\nHFILL\r\n}\r\n},\r\n};\r\nstatic gint *ett[] =\r\n{\r\n&ett_noe,\r\n&ett_body,\r\n&ett_property,\r\n&ett_value,\r\n};\r\nproto_noe = proto_register_protocol("NOE Protocol", "NOE", "noe");\r\nproto_register_field_array(proto_noe, hf_noe, array_length(hf_noe));\r\nregister_dissector("noe", dissect_noe, proto_noe);\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid proto_reg_handoff_noe(void)\r\n{\r\n#if 0\r\ndissector_handle_t handle_noe = find_dissector("noe");\r\ndissector_add_uint("ua.opcode", 0x15, handle_noe);\r\n#endif\r\n}
