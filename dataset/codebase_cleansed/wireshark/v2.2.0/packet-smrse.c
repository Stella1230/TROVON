static int\r\ndissect_smrse_T_address_type(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_smrse_T_numbering_plan(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_smrse_T_octet_format(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 19 "./asn1/smrse/smrse.cnf"\r\nchar *strp,tmpstr[21];\r\nguint32 i, start_offset;\r\ngint8 ber_class;\r\ngboolean pc, ind;\r\ngint32 tag;\r\nguint32 len;\r\nstatic char n2a[16] = { '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'A', 'B', 'C', 'D', 'E', 'F' };\r\nstart_offset=offset;\r\noffset=dissect_ber_identifier(actx->pinfo, tree, tvb, offset, &ber_class, &pc, &tag);\r\noffset=dissect_ber_length(actx->pinfo, tree, tvb, offset, &len, &ind);\r\nif(len>10){\r\nlen=10;\r\n}\r\nstrp=tmpstr;\r\nfor(i=0;i<len;i++){\r\n*strp++=n2a[tvb_get_guint8(tvb, offset)&0x0f];\r\n*strp++=n2a[(tvb_get_guint8(tvb, offset)>>4)&0x0f];\r\noffset++;\r\n}\r\n*strp=0;\r\nproto_tree_add_string(tree, hf_smrse_Octet_Format, tvb, start_offset, offset-start_offset, tmpstr);\r\nreturn offset;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_smrse_T_address_value(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_choice(actx, tree, tvb, offset,\r\nT_address_value_choice, hf_index, ett_smrse_T_address_value,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_smrse_SMS_Address(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nSMS_Address_sequence, hf_index, ett_smrse_SMS_Address);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_smrse_Password(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_restricted_string(implicit_tag, BER_UNI_TAG_PrintableString,\r\nactx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_smrse_SMR_Bind(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nSMR_Bind_sequence, hf_index, ett_smrse_SMR_Bind);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_smrse_IMSI_Address(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_octet_string(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_smrse_SMR_Bind_Confirm(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nSMR_Bind_Confirm_sequence, hf_index, ett_smrse_SMR_Bind_Confirm);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_smrse_Connect_fail(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_smrse_SMR_Bind_Failure(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nSMR_Bind_Failure_sequence, hf_index, ett_smrse_SMR_Bind_Failure);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_smrse_SMR_Unbind(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nSMR_Unbind_sequence, hf_index, ett_smrse_SMR_Unbind);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_smrse_BOOLEAN(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_boolean(implicit_tag, actx, tree, tvb, offset, hf_index, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_smrse_RP_MR(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_smrse_RP_UD(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_octet_string(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_smrse_SM_TC(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_smrse_RPDataMT(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nRPDataMT_sequence, hf_index, ett_smrse_RPDataMT);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_smrse_RPDataMO(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nRPDataMO_sequence, hf_index, ett_smrse_RPDataMO);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_smrse_RPAck(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nRPAck_sequence, hf_index, ett_smrse_RPAck);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_smrse_Error_reason(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_smrse_RPError(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nRPError_sequence, hf_index, ett_smrse_RPError);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_smrse_RPAlertSC(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nRPAlertSC_sequence, hf_index, ett_smrse_RPAlertSC);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_smrse(tvbuff_t *tvb, packet_info *pinfo, proto_tree *parent_tree, void *data _U_)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nguint8 reserved, tag;\r\nint offset=0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\nreserved=tvb_get_guint8(tvb, 0);\r\ntag=tvb_get_guint8(tvb, 3);\r\nif( reserved!= 126 )\r\nreturn 0;\r\nif( (tag<1)||(tag>11) )\r\nreturn 0;\r\nif(parent_tree){\r\nitem = proto_tree_add_item(parent_tree, proto_smrse, tvb, 0, -1, ENC_NA);\r\ntree = proto_item_add_subtree(item, ett_smrse);\r\n}\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "SMRSE");\r\ncol_add_str(pinfo->cinfo, COL_INFO, val_to_str(tag, tag_vals,"Unknown Tag:0x%02x"));\r\nproto_tree_add_item(tree, hf_smrse_reserved, tvb, 0, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_smrse_length, tvb, 1, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_smrse_tag, tvb, 3, 1, ENC_BIG_ENDIAN);\r\nswitch(tag){\r\ncase 1:\r\ncase 2:\r\noffset=4;\r\nbreak;\r\ncase 3:\r\noffset=dissect_smrse_SMR_Bind(FALSE, tvb, 4, &asn1_ctx, tree, -1);\r\nbreak;\r\ncase 4:\r\noffset=dissect_smrse_SMR_Bind_Confirm(FALSE, tvb, 4, &asn1_ctx, tree, -1);\r\nbreak;\r\ncase 5:\r\noffset=dissect_smrse_SMR_Bind_Failure(FALSE, tvb, 4, &asn1_ctx, tree, -1);\r\nbreak;\r\ncase 6:\r\noffset=dissect_smrse_SMR_Unbind(FALSE, tvb, 4, &asn1_ctx, tree, -1);\r\nbreak;\r\ncase 7:\r\noffset=dissect_smrse_RPDataMT(FALSE, tvb, 4, &asn1_ctx, tree, -1);\r\nbreak;\r\ncase 8:\r\noffset=dissect_smrse_RPDataMO(FALSE, tvb, 4, &asn1_ctx, tree, -1);\r\nbreak;\r\ncase 9:\r\noffset=dissect_smrse_RPAck(FALSE, tvb, 4, &asn1_ctx, tree, -1);\r\nbreak;\r\ncase 10:\r\noffset=dissect_smrse_RPError(FALSE, tvb, 4, &asn1_ctx, tree, -1);\r\nbreak;\r\ncase 11:\r\noffset=dissect_smrse_RPAlertSC(FALSE, tvb, 4, &asn1_ctx, tree, -1);\r\nbreak;\r\n}\r\nreturn offset;\r\n}\r\nvoid proto_register_smrse(void) {\r\nstatic hf_register_info hf[] = {\r\n{ &hf_smrse_reserved, {\r\n"Reserved", "smrse.reserved", FT_UINT8, BASE_DEC,\r\nNULL, 0, "Reserved byte, must be 126", HFILL }},\r\n{ &hf_smrse_tag, {\r\n"Tag", "smrse.tag", FT_UINT8, BASE_DEC,\r\nVALS(tag_vals), 0, NULL, HFILL }},\r\n{ &hf_smrse_length, {\r\n"Length", "smrse.length", FT_UINT16, BASE_DEC,\r\nNULL, 0, "Length of SMRSE PDU", HFILL }},\r\n{ &hf_smrse_Octet_Format,\r\n{ "octet-Format", "smrse.octet_Format",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\n"SMS-Address/address-value/octet-format", HFILL }},\r\n#line 1 "./asn1/smrse/packet-smrse-hfarr.c"\r\n{ &hf_smrse_sc_address,\r\n{ "sc-address", "smrse.sc_address_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"SMS_Address", HFILL }},\r\n{ &hf_smrse_password,\r\n{ "password", "smrse.password",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_smrse_address_type,\r\n{ "address-type", "smrse.address_type",\r\nFT_INT32, BASE_DEC, VALS(smrse_T_address_type_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_smrse_numbering_plan,\r\n{ "numbering-plan", "smrse.numbering_plan",\r\nFT_INT32, BASE_DEC, VALS(smrse_T_numbering_plan_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_smrse_address_value,\r\n{ "address-value", "smrse.address_value",\r\nFT_UINT32, BASE_DEC, VALS(smrse_T_address_value_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_smrse_octet_format,\r\n{ "octet-format", "smrse.octet_format",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"T_octet_format", HFILL }},\r\n{ &hf_smrse_connect_fail_reason,\r\n{ "connect-fail-reason", "smrse.connect_fail_reason",\r\nFT_INT32, BASE_DEC, VALS(smrse_Connect_fail_vals), 0,\r\n"Connect_fail", HFILL }},\r\n{ &hf_smrse_mt_priority_request,\r\n{ "mt-priority-request", "smrse.mt_priority_request",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0,\r\n"BOOLEAN", HFILL }},\r\n{ &hf_smrse_mt_mms,\r\n{ "mt-mms", "smrse.mt_mms",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0,\r\n"BOOLEAN", HFILL }},\r\n{ &hf_smrse_mt_message_reference,\r\n{ "mt-message-reference", "smrse.mt_message_reference",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"RP_MR", HFILL }},\r\n{ &hf_smrse_mt_originating_address,\r\n{ "mt-originating-address", "smrse.mt_originating_address_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"SMS_Address", HFILL }},\r\n{ &hf_smrse_mt_destination_address,\r\n{ "mt-destination-address", "smrse.mt_destination_address_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"SMS_Address", HFILL }},\r\n{ &hf_smrse_mt_user_data,\r\n{ "mt-user-data", "smrse.mt_user_data",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"RP_UD", HFILL }},\r\n{ &hf_smrse_mt_origVMSCAddr,\r\n{ "mt-origVMSCAddr", "smrse.mt_origVMSCAddr_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"SMS_Address", HFILL }},\r\n{ &hf_smrse_mt_tariffClass,\r\n{ "mt-tariffClass", "smrse.mt_tariffClass",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"SM_TC", HFILL }},\r\n{ &hf_smrse_mo_message_reference,\r\n{ "mo-message-reference", "smrse.mo_message_reference",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"RP_MR", HFILL }},\r\n{ &hf_smrse_mo_originating_address,\r\n{ "mo-originating-address", "smrse.mo_originating_address_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"SMS_Address", HFILL }},\r\n{ &hf_smrse_mo_user_data,\r\n{ "mo-user-data", "smrse.mo_user_data",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"RP_UD", HFILL }},\r\n{ &hf_smrse_origVMSCAddr,\r\n{ "origVMSCAddr", "smrse.origVMSCAddr_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"SMS_Address", HFILL }},\r\n{ &hf_smrse_moimsi,\r\n{ "moimsi", "smrse.moimsi",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"IMSI_Address", HFILL }},\r\n{ &hf_smrse_message_reference,\r\n{ "message-reference", "smrse.message_reference",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"RP_MR", HFILL }},\r\n{ &hf_smrse_error_reason,\r\n{ "error-reason", "smrse.error_reason",\r\nFT_INT32, BASE_DEC, VALS(smrse_Error_reason_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_smrse_msg_waiting_set,\r\n{ "msg-waiting-set", "smrse.msg_waiting_set",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0,\r\n"BOOLEAN", HFILL }},\r\n{ &hf_smrse_alerting_MS_ISDN,\r\n{ "alerting-MS-ISDN", "smrse.alerting_MS_ISDN_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"SMS_Address", HFILL }},\r\n{ &hf_smrse_sm_diag_info,\r\n{ "sm-diag-info", "smrse.sm_diag_info",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"RP_UD", HFILL }},\r\n{ &hf_smrse_ms_address,\r\n{ "ms-address", "smrse.ms_address_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"SMS_Address", HFILL }},\r\n#line 158 "./asn1/smrse/packet-smrse-template.c"\r\n};\r\nstatic gint *ett[] = {\r\n&ett_smrse,\r\n#line 1 "./asn1/smrse/packet-smrse-ettarr.c"\r\n&ett_smrse_SMR_Bind,\r\n&ett_smrse_SMS_Address,\r\n&ett_smrse_T_address_value,\r\n&ett_smrse_SMR_Bind_Confirm,\r\n&ett_smrse_SMR_Bind_Failure,\r\n&ett_smrse_SMR_Unbind,\r\n&ett_smrse_RPDataMT,\r\n&ett_smrse_RPDataMO,\r\n&ett_smrse_RPAck,\r\n&ett_smrse_RPError,\r\n&ett_smrse_RPAlertSC,\r\n#line 164 "./asn1/smrse/packet-smrse-template.c"\r\n};\r\nproto_smrse = proto_register_protocol(PNAME, PSNAME, PFNAME);\r\nproto_register_field_array(proto_smrse, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid proto_reg_handoff_smrse(void) {\r\ndissector_handle_t smrse_handle;\r\nsmrse_handle = create_dissector_handle(dissect_smrse, proto_smrse);\r\ndissector_add_uint("tcp.port",TCP_PORT_SMRSE, smrse_handle);\r\n}
