static void\r\ndissect_phs_err (tvbuff_t * tvb, proto_tree * tree, int start,\r\nguint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *err_tree;\r\nint pos = start;\r\nerr_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_sflow_err, NULL,\r\n"5 Service Flow Error Encodings (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase PHS_ERR_PARAM:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (err_tree, hf_docsis_tlv_phs_err_param, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase PHS_ERR_CODE:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (err_tree, hf_docsis_tlv_phs_err_code, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase PHS_ERR_MSG:\r\nproto_tree_add_item (err_tree, hf_docsis_tlv_phs_err_msg, tvb, pos,\r\nlength, ENC_ASCII|ENC_NA);\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_phs (tvbuff_t * tvb, proto_tree * tree, int start, guint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *phs_tree;\r\nint pos = start;\r\nphs_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_phs, NULL,\r\n"26 PHS Encodings (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase PHS_CLSFR_REF:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (phs_tree, hf_docsis_tlv_phs_class_ref, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase PHS_CLSFR_ID:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (phs_tree, hf_docsis_tlv_phs_class_id, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase PHS_SFLOW_REF:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (phs_tree, hf_docsis_tlv_phs_sflow_ref, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase PHS_SFLOW_ID:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (phs_tree, hf_docsis_tlv_phs_sflow_id, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase PHS_DSC_ACTION:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (phs_tree, hf_docsis_tlv_phs_dsc_action,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase PHS_ERRORS:\r\ndissect_phs_err (tvb, phs_tree, pos, length);\r\nbreak;\r\ncase PHS_FIELD:\r\nproto_tree_add_item (phs_tree, hf_docsis_tlv_phs_phsf, tvb, pos,\r\nlength, ENC_NA);\r\nbreak;\r\ncase PHS_INDEX:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (phs_tree, hf_docsis_tlv_phs_phsi, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase PHS_MASK:\r\nproto_tree_add_item (phs_tree, hf_docsis_tlv_phs_phsm, tvb, pos,\r\nlength, ENC_NA);\r\nbreak;\r\ncase PHS_SUP_SIZE:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (phs_tree, hf_docsis_tlv_phs_phss, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase PHS_VERIFICATION:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (phs_tree, hf_docsis_tlv_phs_phsf, tvb, pos,\r\nlength, ENC_NA);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase PHS_VENDOR_SPEC:\r\nproto_tree_add_item (phs_tree, hf_docsis_tlv_phs_vendorspec, tvb,\r\npos, length, ENC_NA);\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_reqxmit_policy (tvbuff_t * tvb, proto_tree * tree, int start)\r\n{\r\nstatic const gint *requests[] = {\r\n&hf_docsis_tlv_sflow_reqxmit_all_cm_broadcast,\r\n&hf_docsis_tlv_sflow_reqxmit_priority_multicast,\r\n&hf_docsis_tlv_sflow_reqxmit_req_data_requests,\r\n&hf_docsis_tlv_sflow_reqxmit_req_data_data,\r\n&hf_docsis_tlv_sflow_reqxmit_piggy_back,\r\n&hf_docsis_tlv_sflow_reqxmit_concatenate_data,\r\n&hf_docsis_tlv_sflow_reqxmit_fragment,\r\n&hf_docsis_tlv_sflow_reqxmit_suppress_payload,\r\n&hf_docsis_tlv_sflow_reqxmit_drop_packets,\r\nNULL\r\n};\r\nproto_tree_add_bitmask(tree, tvb, start, hf_docsis_tlv_sflow_reqxmit_pol,\r\nett_docsis_tlv_reqxmitpol, requests, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_sflow_err (tvbuff_t * tvb, proto_tree * tree, int start,\r\nguint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *err_tree;\r\nint pos = start;\r\nerr_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_sflow_err, NULL,\r\n"5 Service Flow Error Encodings (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase SFW_ERR_PARAM:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (err_tree, hf_docsis_tlv_sflow_err_param,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SFW_ERR_CODE:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (err_tree, hf_docsis_tlv_sflow_err_code,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SFW_ERR_MSG:\r\nproto_tree_add_item (err_tree, hf_docsis_tlv_sflow_err_msg, tvb,\r\npos, length, ENC_ASCII|ENC_NA);\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_downstream_sflow (tvbuff_t * tvb, proto_tree * sflow_tree,\r\nint start, guint16 len)\r\n{\r\nguint8 type, length;\r\nint pos = start;\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase SFW_MAX_DOWN_LAT:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (sflow_tree,\r\nhf_docsis_tlv_sflow_max_down_latency, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_upstream_sflow (tvbuff_t * tvb, proto_tree * sflow_tree,\r\nint start, guint16 len)\r\n{\r\nguint8 type, length;\r\nint pos = start;\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase SFW_MAX_CONCAT_BURST:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (sflow_tree,\r\nhf_docsis_tlv_sflow_max_concat_burst, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SFW_SCHEDULING_TYPE:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (sflow_tree, hf_docsis_tlv_sflow_sched_type,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SFW_REQ_XMIT_POL:\r\ndissect_reqxmit_policy (tvb, sflow_tree, pos);\r\nbreak;\r\ncase SFW_NOM_POLL_INT:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (sflow_tree,\r\nhf_docsis_tlv_sflow_nominal_polling, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SFW_POLL_JTTR_TOL:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (sflow_tree,\r\nhf_docsis_tlv_sflow_tolerated_jitter, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SFW_UG_SIZE:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (sflow_tree, hf_docsis_tlv_sflow_ugs_size,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SFW_NOM_GRNT_INTV:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (sflow_tree,\r\nhf_docsis_tlv_sflow_nom_grant_intvl, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SFW_GRNT_JTTR_TOL:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (sflow_tree,\r\nhf_docsis_tlv_sflow_tol_grant_jitter, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SFW_GRNTS_PER_INTV:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (sflow_tree,\r\nhf_docsis_tlv_sflow_grants_per_intvl, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SFW_IP_TOS_OVERWRITE:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (sflow_tree,\r\nhf_docsis_tlv_sflow_ip_tos_overwrite, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SFW_UG_TIME_REF:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (sflow_tree,\r\nhf_docsis_tlv_sflow_ugs_timeref, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_sflow (tvbuff_t * tvb, proto_tree * tree, int start, guint16 len,\r\nguint8 direction)\r\n{\r\nguint8 type, length;\r\nproto_tree *sflow_tree;\r\nint pos = start;\r\nif (direction == 24)\r\nsflow_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_clsfr, NULL,\r\n"24 Upstream Service Flow (Length = %u)", len);\r\nelse if (direction == 25)\r\nsflow_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_clsfr, NULL,\r\n"25 Downstream Service Flow (Length = %u)", len);\r\nelse\r\nreturn;\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase SFW_REF:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (sflow_tree, hf_docsis_tlv_sflow_ref, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SFW_ID:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (sflow_tree, hf_docsis_tlv_sflow_id, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SFW_SID:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (sflow_tree, hf_docsis_tlv_sflow_sid, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SFW_SERVICE_CLASS_NAME:\r\nproto_tree_add_item (sflow_tree, hf_docsis_tlv_sflow_classname, tvb,\r\npos, length, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase SFW_ERRORS:\r\ndissect_sflow_err (tvb, sflow_tree, pos, length);\r\nbreak;\r\ncase SFW_QOS_SET_TYPE:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (sflow_tree, hf_docsis_tlv_sflow_qos_param,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SFW_TRAF_PRI:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (sflow_tree, hf_docsis_tlv_sflow_traf_pri,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SFW_MAX_SUSTAINED:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (sflow_tree, hf_docsis_tlv_sflow_max_sus,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SFW_MAX_BURST:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (sflow_tree, hf_docsis_tlv_sflow_max_burst,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SFW_MIN_RSVD_TRAF:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (sflow_tree, hf_docsis_tlv_sflow_min_traf,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SFW_MIN_RSVD_PACKETSIZE:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (sflow_tree,\r\nhf_docsis_tlv_sflow_ass_min_pkt_size, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SFW_ACTIVE_QOS_TIMEOUT:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (sflow_tree,\r\nhf_docsis_tlv_sflow_timeout_active, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SFW_ADMITT_QOS_TIMEOUT:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (sflow_tree,\r\nhf_docsis_tlv_sflow_timeout_admitted, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SFW_VENDOR_SPEC:\r\nproto_tree_add_item (sflow_tree, hf_docsis_tlv_sflow_vendor_spec,\r\ntvb, pos, length, ENC_NA);\r\nbreak;\r\ndefault:\r\nif (direction == 24)\r\ndissect_upstream_sflow (tvb, sflow_tree, pos - 2, length);\r\nelse\r\ndissect_downstream_sflow (tvb, sflow_tree, pos - 2, length);\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_dot1q_clsfr (tvbuff_t * tvb, proto_tree * tree, int start,\r\nguint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *dot1qclsfr_tree;\r\nint pos = start;\r\ndot1qclsfr_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_cos, NULL,\r\n"11 801.1P/Q Classifiers (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase CFR_D1Q_USER_PRI:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (dot1qclsfr_tree,\r\nhf_docsis_tlv_dot1qclsfr_user_pri, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CFR_D1Q_VLAN_ID:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (dot1qclsfr_tree,\r\nhf_docsis_tlv_dot1qclsfr_vlanid, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CFR_D1Q_VENDOR_SPEC:\r\nproto_tree_add_item (dot1qclsfr_tree,\r\nhf_docsis_tlv_dot1qclsfr_vendorspec, tvb, pos,\r\nlength, ENC_NA);\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_eth_clsfr (tvbuff_t * tvb, proto_tree * tree, int start,\r\nguint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *ethclsfr_tree;\r\nint pos = start;\r\nethclsfr_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_clsfr_eth, NULL,\r\n"10 Ethernet Classifiers (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase CFR_ETH_DST_MAC:\r\nif (length == 6)\r\n{\r\nproto_tree_add_item (ethclsfr_tree, hf_docsis_tlv_ethclsfr_dmac,\r\ntvb, pos, length, ENC_NA);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CFR_ETH_SRC_MAC:\r\nif (length == 6)\r\n{\r\nproto_tree_add_item (ethclsfr_tree, hf_docsis_tlv_ethclsfr_smac,\r\ntvb, pos, length, ENC_NA);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CFR_ETH_DSAP:\r\nif (length == 3)\r\n{\r\nproto_tree_add_item (ethclsfr_tree,\r\nhf_docsis_tlv_ethclsfr_ethertype, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_clsfr_err (tvbuff_t * tvb, proto_tree * tree, int start,\r\nguint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *err_tree;\r\nint pos = start;\r\nerr_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_clsfr_err, NULL,\r\n"8 Classifier Error Encodings (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase CFR_ERR_PARAM:\r\nif (length == 1)\r\nproto_tree_add_item (err_tree, hf_docsis_tlv_clsfr_err_param, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\nelse if (length == 2)\r\n{\r\nproto_tree_add_item (err_tree, hf_docsis_tlv_clsfr_err_param,\r\ntvb, pos, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (err_tree, hf_docsis_tlv_clsfr_err_param,\r\ntvb, pos + 1, 1, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CFR_ERR_CODE:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (err_tree, hf_docsis_tlv_clsfr_err_code,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CFR_ERR_MSG:\r\nproto_tree_add_item (err_tree, hf_docsis_tlv_clsfr_err_msg, tvb,\r\npos, length, ENC_ASCII|ENC_NA);\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_ip_classifier (tvbuff_t * tvb, proto_tree * tree, int start,\r\nguint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *ipclsfr_tree;\r\nint pos = start;\r\nipclsfr_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_clsfr_ip, NULL,\r\n"9 IP Classifier (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase CFR_IP_TOS_RANGE_MASK:\r\nif (length == 3)\r\n{\r\nproto_tree_add_item (ipclsfr_tree,\r\nhf_docsis_tlv_ipclsfr_tosmask, tvb, pos,\r\nlength, ENC_NA);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CFR_IP_PROTO:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (ipclsfr_tree,\r\nhf_docsis_tlv_ipclsfr_ipproto, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CFR_IP_SOURCE_ADDR:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (ipclsfr_tree, hf_docsis_tlv_ipclsfr_src,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CFR_IP_SOURCE_MASK:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (ipclsfr_tree,\r\nhf_docsis_tlv_ipclsfr_srcmask, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CFR_IP_DEST_ADDR:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (ipclsfr_tree, hf_docsis_tlv_ipclsfr_dst,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CFR_IP_DEST_MASK:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (ipclsfr_tree,\r\nhf_docsis_tlv_ipclsfr_dstmask, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CFR_IP_SRCPORT_START:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (ipclsfr_tree,\r\nhf_docsis_tlv_ipclsfr_sport_start, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CFR_IP_SRCPORT_END:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (ipclsfr_tree,\r\nhf_docsis_tlv_ipclsfr_sport_end, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CFR_IP_DSTPORT_START:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (ipclsfr_tree,\r\nhf_docsis_tlv_ipclsfr_dport_start, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CFR_IP_DSTPORT_END:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (ipclsfr_tree,\r\nhf_docsis_tlv_ipclsfr_dport_end, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_classifiers (tvbuff_t * tvb, proto_tree * tree, int start,\r\nguint16 len, guint8 direction)\r\n{\r\nguint8 type, length;\r\nproto_tree *clsfr_tree;\r\nint pos = start;\r\nif (direction == 22)\r\nclsfr_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_clsfr, NULL,\r\n"22 Upstream Packet Classifier (Length = %u)",\r\nlen);\r\nelse if (direction == 23)\r\nclsfr_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_clsfr, NULL,\r\n"23 Downstream Packet Classifier (Length = %u)",\r\nlen);\r\nelse\r\nreturn;\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase CFR_REF:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (clsfr_tree, hf_docsis_tlv_clsfr_ref, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CFR_ID:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (clsfr_tree, hf_docsis_tlv_clsfr_id, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CFR_SFLOW_REF:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (clsfr_tree, hf_docsis_tlv_clsfr_sflow_ref,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CFR_SFLOW_ID:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (clsfr_tree, hf_docsis_tlv_clsfr_sflow_id,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CFR_RULE_PRI:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (clsfr_tree, hf_docsis_tlv_clsfr_rule_pri,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CFR_ACT_STATE:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (clsfr_tree, hf_docsis_tlv_clsfr_act_state,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CFR_DSA_ACTION:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (clsfr_tree, hf_docsis_tlv_clsfr_dsc_act,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CFR_ERROR:\r\ndissect_clsfr_err (tvb, clsfr_tree, pos, length);\r\nbreak;\r\ncase CFR_IP_CLASSIFIER:\r\ndissect_ip_classifier (tvb, clsfr_tree, pos, length);\r\nbreak;\r\ncase CFR_ETH_CLASSIFIER:\r\ndissect_eth_clsfr (tvb, clsfr_tree, pos, length);\r\nbreak;\r\ncase CFR_8021Q_CLASSIFIER:\r\ndissect_dot1q_clsfr (tvb, clsfr_tree, pos, length);\r\nbreak;\r\ncase CFR_VENDOR_SPEC:\r\nproto_tree_add_item (clsfr_tree, hf_docsis_tlv_clsfr_vendor_spc,\r\ntvb, pos, length, ENC_NA);\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_doc10cos (tvbuff_t * tvb, proto_tree * tree, int start,\r\nguint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *doc10cos_tree;\r\nint pos = start;\r\ndoc10cos_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_cos, NULL,\r\n"1 Docsis 1.0 Class of Service (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase 1:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (doc10cos_tree, hf_docsis_tlv_cos_id, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase 2:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (doc10cos_tree, hf_docsis_tlv_cos_sid, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_modemcap (tvbuff_t * tvb, proto_tree * tree, int start,\r\nguint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *mcap_tree;\r\nint pos = start;\r\nmcap_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_mcap, NULL,\r\n"5 Modem Capabilities Type (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase CAP_CONCAT:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_concat, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_DOCSIS_VER:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_docs_ver,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_FRAG:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_frag, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_PHS:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_phs, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_IGMP:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_igmp, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_PRIVACY:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_privacy, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_DOWN_SAID:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_down_said,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_UP_SID:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_up_sid, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_OPT_FILT:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_8021P_filter,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_8021Q_filter,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_XMIT_EQPERSYM:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree,\r\nhf_docsis_tlv_mcap_xmit_eq_taps_per_sym,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_NUM_XMIT_EQ_TAPS:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_xmit_eq_taps,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_DCC:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_dcc, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_IP_FILTERS:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_ip_filters, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_LLC_FILTERS:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_llc_filters, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_EXP_UNICAST_SID:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_exp_unicast_sid, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_RNG_HOFF:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_rnghoff_cm, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_rnghoff_erouter, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_rnghoff_emta, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_rnghoff_estb, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_L2VPN:\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_l2vpn, tvb,\r\npos, length, ENC_NA);\r\nbreak;\r\ncase CAP_L2VPN_ESAFE:\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_l2vpn_esafe, tvb,\r\npos, length, ENC_NA);\r\nbreak;\r\ncase CAP_DUT_FILTERING:\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_dut_filtering, tvb,\r\npos, length, ENC_NA);\r\nbreak;\r\ncase CAP_US_FREQ_RNG:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_us_freq_range, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_US_SRATE:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_us_srate_160, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_us_srate_320, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_us_srate_640, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_us_srate_1280, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_us_srate_2560, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_us_srate_5120, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_SAC:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_sac, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_CODE_HOP_M2:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_code_hop_mode2, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_MTC:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_mtc, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_512_MSPS_UTC:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_512_msps_utc, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_256_MSPS_UTC:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_256_msps_utc, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_TOTAL_SID_CLUST:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_total_sid_cluster, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_SID_PER_SF:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_sid_per_sf, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_MRC:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_mrc, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_TOTAL_DSID:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_total_dsid, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_RESEQ_DSID:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_reseq_dsid, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_MC_DSID:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_mc_dsid, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_MC_DSID_FWD:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_mc_dsid_fwd, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_FCTYPE_FWD:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_fctype_fwd, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_DPV:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_dpv_path, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_dpv_packet, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_UGS:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_ugs, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_MAP_UCD:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_map_ucd, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_UDC:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_udc, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_IPV6:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_ipv6, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CAP_EXT_US_TRNS_PWR:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (mcap_tree, hf_docsis_tlv_mcap_ext_us_trans_power, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_cos (tvbuff_t * tvb, proto_tree * tree, int start, guint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *cos_tree;\r\nint pos = start;\r\ncos_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_cos, NULL,\r\n"4 Class of Service Type (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase COS_CLASSID:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (cos_tree, hf_docsis_tlv_cos_id, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase COS_MAX_DOWN:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (cos_tree, hf_docsis_tlv_cos_max_down, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase COS_MAX_UP:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (cos_tree, hf_docsis_tlv_cos_max_up, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase COS_UP_CH_PRIO:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (cos_tree, hf_docsis_tlv_cos_up_chnl_pri,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase COS_MIN_UP_RATE:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (cos_tree, hf_docsis_tlv_cos_min_grntd_up,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase COS_MAX_UP_BURST:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (cos_tree, hf_docsis_tlv_cos_max_up_burst,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase COS_BP_ENABLE:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (cos_tree, hf_docsis_tlv_cos_privacy_enable,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_svc_unavail(tvbuff_t * tvb, proto_tree * tree, int pos, guint16 length) {\r\nproto_item *svc_unavail_it;\r\nproto_tree *svc_unavail_tree;\r\nsvc_unavail_it = proto_tree_add_item (tree,\r\nhf_docsis_tlv_svc_unavail,\r\ntvb, pos, length, ENC_NA);\r\nsvc_unavail_tree = proto_item_add_subtree(svc_unavail_it, ett_docsis_tlv_svc_unavail );\r\nproto_tree_add_item (svc_unavail_tree,\r\nhf_docsis_tlv_svc_unavail_classid, tvb,\r\npos, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (svc_unavail_tree,\r\nhf_docsis_tlv_svc_unavail_type, tvb,\r\npos+1, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (svc_unavail_tree,\r\nhf_docsis_tlv_svc_unavail_code, tvb,\r\npos+2, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_snmpv3_kickstart(tvbuff_t * tvb, proto_tree *tree, int start, guint16 len) {\r\nproto_item *snmpv3_it;\r\nproto_tree *snmpv3_tree;\r\nguint8 type, length;\r\nint pos = start;\r\nsnmpv3_it = proto_tree_add_item (tree,\r\nhf_docsis_tlv_snmpv3_kick,\r\ntvb, start, len, ENC_NA);\r\nsnmpv3_tree = proto_item_add_subtree(snmpv3_it, ett_docsis_tlv_snmpv3_kick);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase SNMPV3_SEC_NAME:\r\nproto_tree_add_item (snmpv3_tree,\r\nhf_docsis_tlv_snmpv3_kick_name, tvb,\r\npos, length, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase SNMPV3_MGR_PUB_NUM:\r\nproto_tree_add_item (snmpv3_tree,\r\nhf_docsis_tlv_snmpv3_kick_publicnum, tvb,\r\npos, length, ENC_NA);\r\nbreak;\r\n}\r\npos += length;\r\n}\r\n}\r\nstatic void\r\ndissect_ds_ch_list_single (tvbuff_t * tvb, proto_tree * tree,\r\nint start, guint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *single_tree;\r\nint pos = start;\r\nsingle_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_ds_ch_list_single, NULL,\r\n"1 Single Downstream Channel (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase SINGLE_CH_TIMEOUT:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (single_tree, hf_docsis_tlv_single_ch_timeout, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SINGLE_CH_FREQ:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (single_tree, hf_docsis_tlv_single_ch_freq, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_ds_ch_list_range (tvbuff_t * tvb, proto_tree * tree,\r\nint start, guint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *range_tree;\r\nint pos = start;\r\nrange_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_ds_ch_list_range, NULL,\r\n"2 Downstream Frequency Range (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase FREQ_RNG_TIMEOUT:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (range_tree, hf_docsis_tlv_freq_rng_timeout, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase FREQ_RNG_START:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (range_tree, hf_docsis_tlv_freq_rng_start, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase FREQ_RNG_END:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (range_tree, hf_docsis_tlv_freq_rng_end, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase FREQ_RNG_STEP:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (range_tree, hf_docsis_tlv_freq_rng_step, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_dut_filter (tvbuff_t * tvb, proto_tree * tree,\r\nint start, guint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *dut_tree;\r\nint pos = start;\r\ndut_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_dut_filter, NULL,\r\n"Downstream Unencrypted Traffic (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase DUT_CONTROL:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (dut_tree, hf_docsis_tlv_dut_filter_control, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase DUT_CMIM:\r\nproto_tree_add_item (dut_tree, hf_docsis_tlv_dut_filter_cmim, tvb,\r\npos, length, ENC_NA);\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_ds_ch_list(tvbuff_t * tvb, proto_tree *tree, int start, guint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *dschlst_tree;\r\nint pos = start;\r\ndschlst_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_ds_ch_list, NULL,\r\n"41 Downstream Channel List (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase DS_CH_LIST_SINGLE:\r\ndissect_ds_ch_list_single(tvb, dschlst_tree, pos, length);\r\nbreak;\r\ncase DS_CH_LIST_RANGE:\r\ndissect_ds_ch_list_range(tvb, dschlst_tree, pos, length);\r\nbreak;\r\ncase DS_CH_LIST_DEFAULT_TIMEOUT:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (dschlst_tree,\r\nhf_docsis_tlv_ds_ch_list_default_timeout, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_tcc_err(tvbuff_t * tvb, proto_tree *tree, int start, guint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *tccerr_tree;\r\nint pos = start;\r\ntccerr_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_tcc_err, NULL,\r\n"TCC Error Encodings (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase TCC_ERR_SUBTYPE:\r\nproto_tree_add_item (tccerr_tree,\r\nhf_docsis_tcc_err_subtype, tvb,\r\npos, length, ENC_NA);\r\nbreak;\r\ncase TCC_ERR_CODE:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (tccerr_tree,\r\nhf_docsis_tcc_err_code, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TCC_ERR_MSG:\r\nproto_tree_add_item (tccerr_tree,\r\nhf_docsis_tcc_err_msg, tvb,\r\npos, length, ENC_ASCII|ENC_NA);\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_tcc_rng_parms(tvbuff_t * tvb, proto_tree *tree, int start, guint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *rngparm_tree;\r\nint pos = start;\r\nrngparm_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_tcc_rng_parms, NULL,\r\n"Ranging Parameters (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase RNG_PARMS_US_CH_ID:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (rngparm_tree,\r\nhf_docsis_rng_parms_us_ch_id, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase RNG_PARMS_TIME_OFF_INT:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (rngparm_tree,\r\nhf_docsis_rng_parms_time_off_int, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase RNG_PARMS_TIME_OFF_FRAC:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (rngparm_tree,\r\nhf_docsis_rng_parms_time_off_frac, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase RNG_PARMS_POWER_OFF:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (rngparm_tree,\r\nhf_docsis_rng_parms_power_off, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase RNG_PARMS_FREQ_OFF:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (rngparm_tree,\r\nhf_docsis_rng_parms_freq_off, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_sid_cl_so_crit(tvbuff_t * tvb, proto_tree *tree, int start, guint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *crit_tree;\r\nint pos = start;\r\ncrit_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_sid_cl_so, NULL,\r\n"SID Cluster Switchover Criteria (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase SID_CL_SO_MAX_REQ:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (crit_tree,\r\nhf_docsis_sid_cl_so_max_req, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SID_CL_SO_MAX_OUT_BYTES:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (crit_tree,\r\nhf_docsis_sid_cl_so_max_out_bytes, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SID_CL_SO_MAX_REQ_BYTES:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (crit_tree,\r\nhf_docsis_sid_cl_so_max_req_bytes, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SID_CL_SO_MAX_TIME:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (crit_tree,\r\nhf_docsis_sid_cl_so_max_time, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_sid_cl_enc_map(tvbuff_t * tvb, proto_tree *tree, int start, guint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *map_tree;\r\nint pos = start;\r\nmap_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_sid_cl_enc_map, NULL,\r\n"SID-to-Channel Mapping (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase SID_CL_MAP_US_CH_ID:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (map_tree,\r\nhf_docsis_sid_cl_map_us_ch_id, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SID_CL_MAP_SID:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (map_tree,\r\nhf_docsis_sid_cl_map_sid, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SID_CL_MAP_ACTION:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (map_tree,\r\nhf_docsis_sid_cl_map_action, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_sid_cl_enc(tvbuff_t * tvb, proto_tree *tree, int start, guint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *enc_tree;\r\nint pos = start;\r\nenc_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_sid_cl_enc, NULL,\r\n"SID Cluster Encoding (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase SID_CL_ENC_ID:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (enc_tree,\r\nhf_docsis_sid_cl_enc_id, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SID_CL_ENC_MAP:\r\nif (length == 10)\r\ndissect_sid_cl_enc_map(tvb, enc_tree, pos, length);\r\nelse\r\nTHROW (ReportedBoundsError);\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_sid_cl(tvbuff_t * tvb, proto_tree *tree, int start, guint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *sid_tree;\r\nint pos = start;\r\nsid_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_sid_cl, NULL,\r\n"47 Service Flow SID Cluster Assignments (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase SID_CL_SF_ID:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (sid_tree,\r\nhf_docsis_sid_cl_sf_id, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase SID_CL_ENC:\r\ndissect_sid_cl_enc(tvb, sid_tree, pos, length);\r\nbreak;\r\ncase SID_CL_SO_CRIT:\r\ndissect_sid_cl_so_crit(tvb, sid_tree, pos, length);\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_tcc(tvbuff_t * tvb, packet_info * pinfo _U_,\r\nproto_tree *tree, int start, guint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *tcc_tree;\r\nint pos = start;\r\ntvbuff_t *ucd_tvb;\r\ntcc_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_tcc, NULL,\r\n"46 Transmit Channel Configuration (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase TLV_TCC_REFID:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (tcc_tree,\r\nhf_docsis_tlv_tcc_refid, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_TCC_US_CH_ACTION:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (tcc_tree,\r\nhf_docsis_tlv_tcc_us_ch_action, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_TCC_US_CH_ID:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (tcc_tree,\r\nhf_docsis_tlv_tcc_us_ch_id, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_TCC_NEW_US_CH_ID:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (tcc_tree,\r\nhf_docsis_tlv_tcc_new_us_ch_id, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_TCC_UCD:\r\nucd_tvb = tvb_new_subset_length (tvb, pos, length);\r\ncall_dissector (docsis_ucd_handle, ucd_tvb, pinfo, tcc_tree);\r\nbreak;\r\ncase TLV_TCC_RNG_SID:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (tcc_tree,\r\nhf_docsis_tlv_tcc_rng_sid, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_TCC_INIT_TECH:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (tcc_tree,\r\nhf_docsis_tlv_tcc_init_tech, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_TCC_RNG_PARMS:\r\ndissect_tcc_rng_parms(tvb, tcc_tree, pos, length);\r\nbreak;\r\ncase TLV_TCC_DYN_RNG_WIN:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (tcc_tree,\r\nhf_docsis_tlv_tcc_dyn_rng_win, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_TCC_ERR:\r\ndissect_tcc_err(tvb, tcc_tree, pos, length);\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_ch_bl_rng(tvbuff_t * tvb, proto_tree *tree, int start, guint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *chblrng_tree;\r\nint pos = start;\r\nchblrng_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_rcp_ch_bl_rng, NULL,\r\n"Receive Module Channel Block Range (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase CH_BL_RNG_MIN_CTR_FREQ:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (chblrng_tree,\r\nhf_docsis_ch_bl_rng_min_ctr_freq, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CH_BL_RNG_MAX_CTR_FREQ:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (chblrng_tree,\r\nhf_docsis_ch_bl_rng_max_ctr_freq, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_rcp_rcv_mod(tvbuff_t * tvb, proto_tree *tree, int start, guint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *rcvmod_tree;\r\nint pos = start;\r\nrcvmod_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_rcp_rcv_mod_enc, NULL,\r\n"Receive Module Capability (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase RCV_MOD_ENC_IDX:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (rcvmod_tree,\r\nhf_docsis_rcv_mod_enc_idx, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase RCV_MOD_ENC_CH_BL_RNG:\r\ndissect_ch_bl_rng(tvb, rcvmod_tree, pos, length);\r\nbreak;\r\ncase RCV_MOD_ENC_CTR_FREQ_ASGN:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (rcvmod_tree,\r\nhf_docsis_rcv_mod_enc_ctr_freq_asgn, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase RCV_MOD_ENC_RSQ_CH_SUBS_CAP:\r\nproto_tree_add_item (rcvmod_tree,\r\nhf_docsis_rcv_mod_enc_rsq_ch_subs_cap, tvb, pos,\r\nlength, ENC_NA);\r\nbreak;\r\ncase RCV_MOD_ENC_CONN:\r\nproto_tree_add_item (rcvmod_tree,\r\nhf_docsis_rcv_mod_enc_conn, tvb, pos,\r\nlength, ENC_NA);\r\nbreak;\r\ncase RCV_MOD_ENC_PHY_LAYR_PARMS:\r\nproto_tree_add_item (rcvmod_tree,\r\nhf_docsis_rcv_mod_enc_phy_layr_parms, tvb, pos,\r\nlength, ENC_NA);\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_rcp_rcv_ch(tvbuff_t * tvb, proto_tree *tree, int start, guint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *rcvch_tree;\r\nint pos = start;\r\nrcvch_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_rcp_rcv_ch, NULL,\r\n"Receive Channels (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase RCV_CH_IDX:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (rcvch_tree,\r\nhf_docsis_rcv_ch_idx, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase RCV_CH_CONN:\r\nproto_tree_add_item (rcvch_tree,\r\nhf_docsis_rcv_ch_conn, tvb, pos,\r\nlength, ENC_NA);\r\nbreak;\r\ncase RCV_CH_CONN_OFF:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (rcvch_tree,\r\nhf_docsis_rcv_ch_conn_off, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase RCV_CH_PRIM_DS_CH_IND:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (rcvch_tree,\r\nhf_docsis_rcv_ch_prim_ds_ch_ind, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_rcp(tvbuff_t * tvb, packet_info * pinfo _U_,\r\nproto_tree *tree, int start, guint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *rcp_tree;\r\nint pos = start;\r\ntvbuff_t *vsif_tvb;\r\nrcp_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_rcp, NULL,\r\n"48 Receive Channel Profile (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase TLV_RCP_ID:\r\nif (length == 5)\r\n{\r\nproto_tree_add_item (rcp_tree,\r\nhf_docsis_tlv_rcp_id, tvb, pos,\r\nlength, ENC_NA);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_RCP_NAME:\r\nif (length <= 15)\r\n{\r\nproto_tree_add_item (rcp_tree,\r\nhf_docsis_tlv_rcp_name, tvb, pos,\r\nlength, ENC_NA);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_RCP_FREQ_SPC:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (rcp_tree,\r\nhf_docsis_tlv_rcp_freq_spc, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_RCP_RCV_MOD_ENC:\r\ndissect_rcp_rcv_mod(tvb, rcp_tree, pos, length);\r\nbreak;\r\ncase TLV_RCP_RCV_CH:\r\ndissect_rcp_rcv_ch(tvb, rcp_tree, pos, length);\r\nbreak;\r\ncase TLV_RCP_VEN_SPEC:\r\nvsif_tvb = tvb_new_subset_length (tvb, pos, length);\r\ncall_dissector (docsis_vsif_handle, vsif_tvb, pinfo, rcp_tree);\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_rcc_rcv_mod(tvbuff_t * tvb, proto_tree *tree, int start, guint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *rcvmod_tree;\r\nint pos = start;\r\nrcvmod_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_rcc_rcv_mod_enc, NULL,\r\n"Receive Module Assignment (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase RCV_MOD_ENC_IDX:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (rcvmod_tree,\r\nhf_docsis_rcc_rcv_mod_enc_idx, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase RCV_MOD_ENC_CTR_FREQ_ASGN:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (rcvmod_tree,\r\nhf_docsis_rcc_rcv_mod_enc_ctr_freq_asgn, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase RCV_MOD_ENC_CONN:\r\nproto_tree_add_item (rcvmod_tree,\r\nhf_docsis_rcc_rcv_mod_enc_conn, tvb, pos,\r\nlength, ENC_NA);\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_rcc_rcv_ch(tvbuff_t * tvb, proto_tree *tree, int start, guint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *rcvch_tree;\r\nint pos = start;\r\nrcvch_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_rcc_rcv_ch, NULL,\r\n"Receive Channels (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase RCV_CH_IDX:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (rcvch_tree,\r\nhf_docsis_rcc_rcv_ch_idx, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase RCV_CH_CONN:\r\nproto_tree_add_item (rcvch_tree,\r\nhf_docsis_rcc_rcv_ch_conn, tvb, pos,\r\nlength, ENC_NA);\r\nbreak;\r\ncase RCV_CH_CTR_FREQ_ASGN:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (rcvch_tree,\r\nhf_docsis_rcc_rcv_ch_ctr_freq_asgn, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase RCV_CH_PRIM_DS_CH_IND:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (rcvch_tree,\r\nhf_docsis_rcc_rcv_ch_prim_ds_ch_ind, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_rcc_err(tvbuff_t * tvb, proto_tree *tree, int start, guint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *err_tree;\r\nint pos = start;\r\nerr_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_rcc_rcv_ch, NULL,\r\n"RCC Error Encodings (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase RCC_ERR_MOD_OR_CH:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (err_tree,\r\nhf_docsis_tlv_rcc_err_mod_or_ch, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase RCC_ERR_IDX:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (err_tree,\r\nhf_docsis_tlv_rcc_err_idx, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase RCC_ERR_PARAM:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (err_tree,\r\nhf_docsis_tlv_rcc_err_param, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase RCC_ERR_CODE:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (err_tree,\r\nhf_docsis_tlv_rcc_err_code, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase RCC_ERR_MSG:\r\nproto_tree_add_item (err_tree,\r\nhf_docsis_tlv_rcc_err_msg, tvb, pos,\r\nlength, ENC_NA);\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_rcc(tvbuff_t * tvb, packet_info * pinfo _U_,\r\nproto_tree *tree, int start, guint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *rcc_tree;\r\nint pos = start;\r\ntvbuff_t *vsif_tvb;\r\nrcc_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_rcc, NULL,\r\n"49 Receive Channel Configuration (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase TLV_RCP_ID:\r\nif (length == 5)\r\n{\r\nproto_tree_add_item (rcc_tree,\r\nhf_docsis_tlv_rcc_id, tvb, pos,\r\nlength, ENC_NA);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_RCP_RCV_MOD_ENC:\r\ndissect_rcc_rcv_mod(tvb, rcc_tree, pos, length);\r\nbreak;\r\ncase TLV_RCP_RCV_CH:\r\ndissect_rcc_rcv_ch(tvb, rcc_tree, pos, length);\r\nbreak;\r\ncase TLV_RCP_VEN_SPEC:\r\nvsif_tvb = tvb_new_subset_length (tvb, pos, length);\r\ncall_dissector (docsis_vsif_handle, vsif_tvb, pinfo, rcc_tree);\r\nbreak;\r\ncase TLV_RCC_ERR:\r\ndissect_rcc_err(tvb, rcc_tree, pos, length);\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_dsid_ds_reseq(tvbuff_t * tvb, proto_tree *tree, int start, guint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *dsid_tree;\r\nint pos = start;\r\ndsid_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_dsid_ds_reseq, NULL,\r\n"Resequencing DSID (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase DS_RESEQ_DSID:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (dsid_tree,\r\nhf_docsis_ds_reseq_dsid, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase DS_RESEQ_CH_LST:\r\nproto_tree_add_item (dsid_tree,\r\nhf_docsis_ds_reseq_ch_lst, tvb, pos,\r\nlength, ENC_NA);\r\nbreak;\r\ncase DS_RESEQ_WAIT_TIME:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (dsid_tree,\r\nhf_docsis_ds_reseq_wait_time, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase DS_RESEQ_WARN_THRESH:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (dsid_tree,\r\nhf_docsis_ds_reseq_warn_thresh, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase DS_RESEQ_HO_TIMER:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (dsid_tree,\r\nhf_docsis_ds_reseq_ho_timer, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_dsid_mc_addr(tvbuff_t * tvb, proto_tree *tree, int start, guint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *dsid_tree;\r\nint pos = start;\r\ndsid_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_dsid_mc_addr, NULL,\r\n"Client MAC Address Encodings (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase MC_ADDR_ACTION:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (dsid_tree,\r\nhf_docsis_mc_addr_action, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase MC_ADDR_ADDR:\r\nif (length == 6)\r\n{\r\nproto_tree_add_item (dsid_tree,\r\nhf_docsis_mc_addr_addr, tvb, pos,\r\nlength, ENC_NA);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_dsid_mc(tvbuff_t * tvb, proto_tree *tree, int start, guint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *dsid_tree;\r\nint pos = start;\r\ndsid_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_dsid_mc, NULL,\r\n"Multicast Encodings (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase TLV_DSID_MC_ADDR:\r\ndissect_dsid_mc_addr(tvb, dsid_tree, pos, length);\r\nbreak;\r\ncase TLV_DSID_MC_CMIM:\r\nproto_tree_add_item (dsid_tree,\r\nhf_docsis_tlv_dsid_mc_cmim, tvb, pos,\r\nlength, ENC_NA);\r\nbreak;\r\ncase TLV_DSID_MC_GROUP:\r\nproto_tree_add_item (dsid_tree,\r\nhf_docsis_tlv_dsid_mc_group, tvb, pos,\r\nlength, ENC_NA);\r\nbreak;\r\ncase TLV_DSID_MC_PHS:\r\ndissect_phs(tvb, dsid_tree, pos, length);\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_dsid(tvbuff_t * tvb, proto_tree *tree, int start, guint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *dsid_tree;\r\nint pos = start;\r\ndsid_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_dsid, NULL,\r\n"50 DSID Encodings (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase TLV_DSID_ID:\r\nif (length == 3)\r\n{\r\nproto_tree_add_item (dsid_tree,\r\nhf_docsis_tlv_dsid_id, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_DSID_ACTION:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (dsid_tree,\r\nhf_docsis_tlv_dsid_action, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_DSID_DS_RESEQ:\r\ndissect_dsid_ds_reseq(tvb, dsid_tree, pos, length);\r\nbreak;\r\ncase TLV_DSID_MC:\r\ndissect_dsid_mc(tvb, dsid_tree, pos, length);\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_sec_assoc(tvbuff_t * tvb, proto_tree *tree, int start, guint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *sec_tree;\r\nint pos = start;\r\nsec_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_dsid, NULL,\r\n"51 Security Association Encodings (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase TLV_SEC_ASSOC_ACTION:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (sec_tree,\r\nhf_docsis_tlv_sec_assoc_action, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_SEC_ASSOC_DESC:\r\nif (length == 14)\r\n{\r\nproto_tree_add_item (sec_tree,\r\nhf_docsis_tlv_sec_assoc_desc, tvb, pos,\r\nlength, ENC_NA);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_ch_asgn(tvbuff_t * tvb, proto_tree *tree, int start, guint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *asgn_tree;\r\nint pos = start;\r\nasgn_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_tlv_ch_asgn, NULL,\r\n"56 Channel Assignment Configuration Settings (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase TLV_CH_ASGN_US_CH_ID:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (asgn_tree,\r\nhf_docsis_ch_asgn_us_ch_id, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_CH_ASGN_RX_FREQ:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (asgn_tree,\r\nhf_docsis_ch_asgn_rx_freq, tvb, pos,\r\nlength, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic void\r\ndissect_cmts_mc_sess_enc(tvbuff_t * tvb, proto_tree *tree, int start, guint16 len)\r\n{\r\nguint8 type, length;\r\nproto_tree *mc_tree;\r\nint pos = start;\r\nmc_tree =\r\nproto_tree_add_subtree_format(tree, tvb, start, len, ett_docsis_cmts_mc_sess_enc, NULL,\r\n"64 CMTS Static Multicast Session Encoding (Length = %u)", len);\r\nwhile (pos < (start + len))\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase CMTS_MC_SESS_ENC_GRP:\r\nif (length == 4 || length == 16)\r\n{\r\nproto_tree_add_item (mc_tree,\r\nhf_docsis_cmts_mc_sess_enc_grp, tvb, pos,\r\nlength, ENC_NA);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase CMTS_MC_SESS_ENC_SRC:\r\nif (length == 4 || length == 16)\r\n{\r\nproto_tree_add_item (mc_tree,\r\nhf_docsis_cmts_mc_sess_enc_src, tvb, pos,\r\nlength, ENC_NA);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nstatic int\r\ndissect_tlv (tvbuff_t * tvb, packet_info * pinfo _U_, proto_tree * tree, void* data _U_)\r\n{\r\nproto_item *it;\r\nproto_tree *tlv_tree;\r\nint pos = 0;\r\ngint total_len;\r\nguint8 type, length;\r\nguint16 x;\r\ntvbuff_t *vsif_tvb;\r\ntotal_len = tvb_reported_length_remaining (tvb, 0);\r\n{\r\nit =\r\nproto_tree_add_protocol_format (tree, proto_docsis_tlv, tvb, 0,\r\ntotal_len, "TLV Data");\r\ntlv_tree = proto_item_add_subtree (it, ett_docsis_tlv);\r\nwhile (pos < total_len)\r\n{\r\ntype = tvb_get_guint8 (tvb, pos++);\r\nlength = tvb_get_guint8 (tvb, pos++);\r\nswitch (type)\r\n{\r\ncase TLV_DOWN_FREQ:\r\nif (length == 4)\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_down_freq, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\nelse if (length == 1)\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_rng_tech, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\nelse\r\ndissect_doc10cos (tvb, tlv_tree, pos, length);\r\nbreak;\r\ncase TLV_CHNL_ID:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_upstream_chid,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_NET_ACCESS:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_net_access,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_COS:\r\ndissect_cos (tvb, tlv_tree, pos, length);\r\nbreak;\r\ncase TLV_MODEM_CAP:\r\ndissect_modemcap (tvb, tlv_tree, pos, length);\r\nbreak;\r\ncase TLV_CM_MIC:\r\nif (length == 16)\r\n{\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_cm_mic, tvb,\r\npos, length, ENC_NA);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_CMTS_MIC:\r\nif (length == 16)\r\n{\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_cmts_mic, tvb,\r\npos, length, ENC_NA);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_VENDOR_ID:\r\nif (length == 3)\r\n{\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_vendor_id, tvb,\r\npos, length, ENC_NA);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_SW_UPG_FILE:\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_sw_file, tvb, pos,\r\nlength, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase TLV_SNMP_WRITE_CTRL:\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_snmp_access, tvb,\r\npos, length, ENC_NA);\r\nbreak;\r\ncase TLV_SNMP_OBJECT:\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_snmp_obj, tvb,\r\npos, length, ENC_NA);\r\nbreak;\r\ncase TLV_MODEM_IP:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_modem_addr,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_SVC_UNAVAIL:\r\nif (length == 3)\r\n{\r\ndissect_svc_unavail(tvb, tlv_tree, pos, length);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_ETHERNET_MAC:\r\nif (length == 6)\r\n{\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_cpe_ethernet,\r\ntvb, pos, length, ENC_NA);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_TEL_SETTINGS:\r\nbreak;\r\ncase TLV_BPI_CONFIG:\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_bpi, tvb,\r\npos, length, ENC_NA);\r\nbreak;\r\ncase TLV_MAX_CPES:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_max_cpe, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_TFTP_TIME:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (tlv_tree,\r\nhf_docsis_tlv_tftp_server_timestamp,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_TFTP_MODEM_ADDRESS:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (tlv_tree,\r\nhf_docsis_tlv_tftp_prov_modem_address,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_SW_UPG_SRVR:\r\nif (length == 4)\r\n{\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_sw_upg_srvr,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_UPSTREAM_CLASSIFIER:\r\ncase TLV_DOWN_CLASSIFIER:\r\ndissect_classifiers (tvb, tlv_tree, pos, length, type);\r\nbreak;\r\ncase TLV_UPSTREAM_SERVICE_FLOW:\r\ncase TLV_DOWN_SERVICE_FLOW:\r\ndissect_sflow (tvb, tlv_tree, pos, length, type);\r\nbreak;\r\ncase TLV_PHS:\r\ndissect_phs (tvb, tlv_tree, pos, length);\r\nbreak;\r\ncase TLV_HMAC_DIGEST:\r\nif (length == 20)\r\n{\r\nproto_tree_add_item (tlv_tree,\r\nhf_docsis_tlv_hmac_digest, tvb,\r\npos, length, ENC_NA);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_MAX_CLASSIFIERS:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (tlv_tree,\r\nhf_docsis_tlv_max_classifiers, tvb,\r\npos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_PRIVACY_ENABLE:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_privacy_enable,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_AUTH_BLOCK:\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_auth_block,\r\ntvb, pos, length, ENC_NA);\r\nbreak;\r\ncase TLV_KEY_SEQ_NUM:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_key_seq_num, tvb,\r\npos, length, ENC_NA);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_MFGR_CVC:\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_mfgr_cvc,\r\ntvb, pos, length, ENC_NA);\r\nbreak;\r\ncase TLV_COSIGN_CVC:\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_cosign_cvc,\r\ntvb, pos, length, ENC_NA);\r\nbreak;\r\ncase TLV_SNMPV3_KICKSTART:\r\ndissect_snmpv3_kickstart(tvb, tlv_tree, pos, length);\r\nbreak;\r\ncase TLV_SUBS_MGMT_CTRL:\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_subs_mgmt_ctrl,\r\ntvb, pos, length, ENC_NA);\r\nbreak;\r\ncase TLV_SUBS_MGMT_CPE:\r\nif ((length % 4) == 0)\r\n{\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_subs_mgmt_ip_table,\r\ntvb, pos, length, ENC_NA);\r\nfor (x = 0; x < length; x+=4)\r\n{\r\nproto_tree_add_item (tlv_tree,\r\nhf_docsis_tlv_subs_mgmt_ip_entry,\r\ntvb, pos + x, 4, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_SUBS_MGMT_FLTR:\r\nproto_tree_add_item (tlv_tree,\r\nhf_docsis_tlv_subs_mgmt_filter_grps,\r\ntvb, pos, length, ENC_NA);\r\nbreak;\r\ncase TLV_SNMPV3_NTFY_RCVR:\r\nproto_tree_add_item(tlv_tree,\r\nhf_docsis_tlv_snmpv3_ntfy_rcvr,\r\ntvb, pos, length, ENC_NA);\r\nbreak;\r\ncase TLV_ENABLE_20_MODE:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_enable_20_mode,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_ENABLE_TEST_MODES:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_enable_test_modes,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_DS_CH_LIST:\r\ndissect_ds_ch_list(tvb, tlv_tree, pos, length);\r\nbreak;\r\ncase TLV_MC_MAC_ADDRESS:\r\nif (length == 6)\r\n{\r\nproto_tree_add_item(tlv_tree, hf_docsis_tlv_mc_mac_address,\r\ntvb, pos, length, ENC_NA);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_VENDOR_SPEC:\r\nvsif_tvb = tvb_new_subset_length (tvb, pos, length);\r\ncall_dissector (docsis_vsif_handle, vsif_tvb, pinfo, tlv_tree);\r\nbreak;\r\ncase TLV_DUT_FILTER:\r\ndissect_dut_filter(tvb, tlv_tree, pos, length);\r\nbreak;\r\ncase TLV_TCC:\r\ndissect_tcc(tvb, pinfo, tlv_tree, pos, length);\r\nbreak;\r\ncase TLV_SID_CL:\r\ndissect_sid_cl(tvb, tlv_tree, pos, length);\r\nbreak;\r\ncase TLV_RCP:\r\ndissect_rcp(tvb, pinfo, tlv_tree, pos, length);\r\nbreak;\r\ncase TLV_RCC:\r\ndissect_rcc(tvb, pinfo, tlv_tree, pos, length);\r\nbreak;\r\ncase TLV_DSID:\r\ndissect_dsid(tvb, tlv_tree, pos, length);\r\nbreak;\r\ncase TLV_SEC_ASSOC:\r\ndissect_sec_assoc(tvb, tlv_tree, pos, length);\r\nbreak;\r\ncase TLV_INIT_CH_TIMEOUT:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item(tlv_tree, hf_docsis_tlv_init_ch_timeout,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_CH_ASGN:\r\ndissect_ch_asgn(tvb, tlv_tree, pos, length);\r\nbreak;\r\ncase TLV_CM_INIT_REASON:\r\nif (length == 1)\r\n{\r\nproto_tree_add_item(tlv_tree, hf_docsis_tlv_cm_init_reason,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_SW_UPG_SRVR_IPV6:\r\nif (length == 16)\r\n{\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_sw_upg_srvr_ipv6,\r\ntvb, pos, length, ENC_NA);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_TFTP_PROV_CM_IPV6_ADDR:\r\nif (length == 16)\r\n{\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_tftp_prov_cm_ipv6_addr,\r\ntvb, pos, length, ENC_NA);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_US_DROP_CLFY:\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_us_drop_clfy,\r\ntvb, pos, length, ENC_NA);\r\nbreak;\r\ncase TLV_SUBS_MGMT_IPV6_LST:\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_subs_mgmt_ipv6_lst,\r\ntvb, pos, length, ENC_NA);\r\nbreak;\r\ncase TLV_US_DROP_CLFY_GROUP_ID:\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_us_drop_clfy_group_id,\r\ntvb, pos, length, ENC_NA);\r\nbreak;\r\ncase TLV_SUBS_MGMT_CTRL_MAX_CPE_IPV6:\r\nif (length == 2)\r\n{\r\nproto_tree_add_item (tlv_tree, hf_docsis_tlv_subs_mgmt_ctrl_max_cpe_ipv6,\r\ntvb, pos, length, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nTHROW (ReportedBoundsError);\r\n}\r\nbreak;\r\ncase TLV_CMTS_MC_SESS_ENC:\r\ndissect_cmts_mc_sess_enc(tvb, tlv_tree, pos, length);\r\nbreak;\r\ncase TLV_END:\r\nbreak;\r\n}\r\npos = pos + length;\r\n}\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_docsis_tlv (void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{&hf_docsis_tlv_down_freq,\r\n{"1 Downstream Frequency", "docsis_tlv.downfreq",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Downstream Frequency", HFILL}\r\n},\r\n{&hf_docsis_tlv_upstream_chid,\r\n{"2 Upstream Channel ID", "docsis_tlv.upchid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Service Identifier", HFILL}\r\n},\r\n{&hf_docsis_tlv_net_access,\r\n{"3 Network Access", "docsis_tlv.netaccess",\r\nFT_BOOLEAN, BASE_NONE, TFS (&on_off_tfs), 0x0,\r\n"Network Access TLV", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_cos,\r\n{"4 COS Encodings", "docsis_tlv.cos",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_tlv_cos_id,\r\n{".1 Class ID", "docsis_tlv.cos.id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Class ID", HFILL}\r\n},\r\n{&hf_docsis_tlv_cos_sid,\r\n{".2 Service ID", "docsis_tlv.cos.sid",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Service ID", HFILL}\r\n},\r\n{&hf_docsis_tlv_cos_max_down,\r\n{".2 Max Downstream Rate (bps)", "docsis_tlv.cos.maxdown",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Max Downstream Rate", HFILL}\r\n},\r\n{&hf_docsis_tlv_cos_max_up,\r\n{".3 Max Upstream Rate (bps)", "docsis_tlv.cos.maxup",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Max Upstream Rate", HFILL}\r\n},\r\n{&hf_docsis_tlv_cos_up_chnl_pri,\r\n{".4 Upstream Channel Priority", "docsis_tlv.cos.upchnlpri",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Upstream Channel Priority", HFILL}\r\n},\r\n{&hf_docsis_tlv_cos_min_grntd_up,\r\n{".5 Guaranteed Upstream Rate", "docsis_tlv.cos.mingrntdup",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Guaranteed Minimum Upstream Data Rate", HFILL}\r\n},\r\n{&hf_docsis_tlv_cos_max_up_burst,\r\n{".6 Maximum Upstream Burst", "docsis_tlv.cos.maxupburst",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Maximum Upstream Burst", HFILL}\r\n},\r\n{&hf_docsis_tlv_cos_privacy_enable,\r\n{".7 COS Privacy Enable", "docsis_tlv.cos.privacy_enable",\r\nFT_BOOLEAN, BASE_NONE, TFS (&ena_dis_tfs), 0x0,\r\n"Class of Service Privacy Enable", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_mcap,\r\n{"5 Modem Capabilities", "docsis_tlv.mcap",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Modem Capabilities", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_tlv_mcap_concat,\r\n{".1 Concatenation Support", "docsis_tlv.mcap.concat",\r\nFT_BOOLEAN, BASE_NONE, TFS (&on_off_tfs), 0x0,\r\n"Concatenation Support", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_docs_ver,\r\n{".2 Docsis Version", "docsis_tlv.map.docsver",\r\nFT_UINT8, BASE_DEC, VALS (docs_ver_vals), 0x0,\r\n"DOCSIS Version", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_frag,\r\n{".3 Fragmentation Support", "docsis_tlv.mcap.frag",\r\nFT_BOOLEAN, BASE_NONE, TFS (&on_off_tfs), 0x0,\r\n"Fragmentation Support", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_phs,\r\n{".4 PHS Support", "docsis_tlv.mcap.phs",\r\nFT_BOOLEAN, BASE_NONE, TFS (&on_off_tfs), 0x0,\r\n"PHS Support", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_igmp,\r\n{".5 IGMP Support", "docsis_tlv.mcap.igmp",\r\nFT_BOOLEAN, BASE_NONE, TFS (&on_off_tfs), 0x0,\r\n"IGMP Support", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_privacy,\r\n{".6 Privacy Support", "docsis_tlv.mcap.privacy",\r\nFT_BOOLEAN, BASE_NONE, TFS (&on_off_tfs), 0x0,\r\n"Privacy Support", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_down_said,\r\n{".7 # Downstream SAIDs Supported", "docsis_tlv.mcap.downsaid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Downstream Said Support", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_up_sid,\r\n{".8 # Upstream SAIDs Supported", "docsis_tlv.mcap.upsid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Upstream SID Support", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_8021P_filter,\r\n{".9 802.1P Filtering Support", "docsis_tlv.mcap.dot1pfiltering",\r\nFT_UINT8, BASE_DEC, VALS (on_off_vals), 0x80,\r\n"802.1P Filtering Support", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_8021Q_filter,\r\n{".9 802.1Q Filtering Support", "docsis_tlv.mcap.dot1qfilt",\r\nFT_UINT8, BASE_DEC, VALS (on_off_vals), 0x40,\r\n"802.1Q Filtering Support", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_xmit_eq_taps_per_sym,\r\n{".10 Xmit Equalizer Taps/Sym", "docsis_tlv.mcap.tapspersym",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Transmit Equalizer Taps per Symbol", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_xmit_eq_taps,\r\n{".11 # Xmit Equalizer Taps", "docsis_tlv.mcap.numtaps",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Number of Transmit Equalizer Taps", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_dcc,\r\n{".12 DCC Support", "docsis_tlv.mcap.dcc",\r\nFT_BOOLEAN, BASE_NONE, TFS (&on_off_tfs), 0x0,\r\n"DCC Support", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_ip_filters,\r\n{".13 IP Filters Support","docsis_tlv.mcap.ipfilters",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"IP Filters Support", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_llc_filters,\r\n{".14 LLC Filters Support","docsis_tlv.mcap.llcfilters",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"LLC Filters Support", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_exp_unicast_sid,\r\n{".15 Expanded Unicast SID Space","docsis_tlv.mcap.exucsid",\r\nFT_BOOLEAN, BASE_NONE, TFS (&on_off_tfs), 0x0,\r\n"Expanded Unicast SID Space", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_rnghoff_cm,\r\n{".16 Ranging Hold-Off (CM)","docsis_tlv.mcap.rnghoffcm",\r\nFT_UINT32, BASE_DEC, VALS (on_off_vals), 0x1,\r\n"Ranging Hold-Off (CM)", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_rnghoff_erouter,\r\n{".16 Ranging Hold-Off (ePS or eRouter)",\r\n"docsis_tlv.mcap.rnghofferouter",\r\nFT_UINT32, BASE_DEC, VALS (on_off_vals), 0x2,\r\n"Ranging Hold-Off (ePS or eRouter)", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_rnghoff_emta,\r\n{".16 Ranging Hold-Off (eMTA or EDVA)",\r\n"docsis_tlv.mcap.rnghoffemta",\r\nFT_UINT32, BASE_DEC, VALS (on_off_vals), 0x4,\r\n"Ranging Hold-Off (eMTA or EDVA)", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_rnghoff_estb,\r\n{".16 Ranging Hold-Off (DSG/eSTB)",\r\n"docsis_tlv.mcap.rnghoffestb",\r\nFT_UINT32, BASE_DEC, VALS (on_off_vals), 0x8,\r\n"Ranging Hold-Off (DSG/eSTB)", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_l2vpn,\r\n{".17 L2VPN Capability","docsis_tlv.mcap.l2vpn",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"L2VPN Capability", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_l2vpn_esafe,\r\n{".18 L2VPN eSAFE Host Capability","docsis_tlv.mcap.l2vpnesafe",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"L2VPN eSAFE Host Capability", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_dut_filtering,\r\n{".19 Downstream Unencrypted Traffic (DUT) Filtering",\r\n"docsis_tlv.mcap.dut",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Downstream Unencrypted Traffic (DUT) Filtering", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_us_freq_range,\r\n{".20 Upstream Frequency Range Support",\r\n"docsis_tlv.mcap.usfreqrng",\r\nFT_UINT8, BASE_DEC, VALS (docsis_freq_rng_vals), 0x0,\r\n"Upstream Frequency Range Support", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_us_srate_160,\r\n{".21 Upstream Symbol Rate 160ksps supported",\r\n"docsis_tlv.mcap.srate160",\r\nFT_UINT8, BASE_DEC, VALS (on_off_vals), 0x1,\r\n"Upstream Symbol Rate 160ksps supported", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_us_srate_320,\r\n{".21 Upstream Symbol Rate 320ksps supported",\r\n"docsis_tlv.mcap.srate320",\r\nFT_UINT8, BASE_DEC, VALS (on_off_vals), 0x2,\r\n"Upstream Symbol Rate 320ksps supported", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_us_srate_640,\r\n{".21 Upstream Symbol Rate 640ksps supported",\r\n"docsis_tlv.mcap.srate640",\r\nFT_UINT8, BASE_DEC, VALS (on_off_vals), 0x4,\r\n"Upstream Symbol Rate 640ksps supported", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_us_srate_1280,\r\n{".21 Upstream Symbol Rate 1280ksps supported",\r\n"docsis_tlv.mcap.srate1280",\r\nFT_UINT8, BASE_DEC, VALS (on_off_vals), 0x8,\r\n"Upstream Symbol Rate 1280ksps supported", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_us_srate_2560,\r\n{".21 Upstream Symbol Rate 2560ksps supported",\r\n"docsis_tlv.mcap.srate2560",\r\nFT_UINT8, BASE_DEC, VALS (on_off_vals), 0x10,\r\n"Upstream Symbol Rate 2560ksps supported", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_us_srate_5120,\r\n{".21 Upstream Symbol Rate 5120ksps supported",\r\n"docsis_tlv.mcap.srate5120",\r\nFT_UINT8, BASE_DEC, VALS (on_off_vals), 0x20,\r\n"Upstream Symbol Rate 5120ksps supported", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_sac,\r\n{".22 Selectable Active Code Mode 2 Support","docsis_tlv.mcap.sac",\r\nFT_BOOLEAN, BASE_NONE, TFS (&on_off_tfs), 0x0,\r\n"Selectable Active Code Mode 2 Support", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_code_hop_mode2,\r\n{".23 Code Hopping Mode 2 Support","docsis_tlv.mcap.codehopm2",\r\nFT_BOOLEAN, BASE_NONE, TFS (&on_off_tfs), 0x0,\r\n"Code Hopping Mode 2 Support", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_mtc,\r\n{".24 Multiple Transmit Channel Support","docsis_tlv.mcap.mtc",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Multiple Transmit Channel Support", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_512_msps_utc,\r\n{".25 5.12 Msps Upstream Transmit Channel Support",\r\n"docsis_tlv.mcap.512mspsutc",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"5.12 Msps Upstream Transmit Channel Support", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_256_msps_utc,\r\n{".26 2.56 Msps Upstream Transmit Channel Support",\r\n"docsis_tlv.mcap.256mspsutc",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"2.56 Msps Upstream Transmit Channel Support", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_total_sid_cluster,\r\n{".27 Total SID Cluster Support","docsis_tlv.mcap.totalsidcl",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Total SID Cluster Support", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_sid_per_sf,\r\n{".28 SID Clusters per Service Flow Support",\r\n"docsis_tlv.mcap.sidpersf",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"SID Clusters per Service Flow Support", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_mrc,\r\n{".29 Multiple Receive Channel Support","docsis_tlv.mcap.mrc",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Multiple Receive Channel Support", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_total_dsid,\r\n{".30 Total Downstream Service ID (DSID) Support",\r\n"docsis_tlv.mcap.totaldsid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Total Downstream Service ID (DSID) Support", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_reseq_dsid,\r\n{".31 Resequencing Downstream Service ID (DSID) Support",\r\n"docsis_tlv.mcap.reseqdsid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Resequencing Downstream Service ID (DSID) Support", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_mc_dsid,\r\n{".32 Multicast Downstream Service ID (DSID) Support",\r\n"docsis_tlv.mcap.mcdsid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Multicast Downstream Service ID (DSID) Support", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_mc_dsid_fwd,\r\n{".33 Multicast DSID Forwarding","docsis_tlv.mcap.mcdsidfwd",\r\nFT_UINT8, BASE_DEC, VALS (mc_dsid_fwd_vals), 0x0,\r\n"Mulitcast DSID Forwarding", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_fctype_fwd,\r\n{".34 Frame Control Type Forwarding Capability",\r\n"docsis_tlv.mcap.fctypefwd",\r\nFT_UINT8, BASE_DEC, VALS (fctype_fwd_vals), 0x0,\r\n"Frame Control Type Forwarding Capability", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_dpv_path,\r\n{".35 DPV Capability (per Path)","docsis_tlv.mcap.dpvpath",\r\nFT_UINT8, BASE_DEC, NULL, 0x1,\r\n"DPV Capability (per Path)", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_dpv_packet,\r\n{".35 DPV Capability (per Packet)","docsis_tlv.mcap.dpvpacket",\r\nFT_UINT8, BASE_DEC, NULL, 0x2,\r\n"DPV Capability (per Packet)", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_ugs,\r\n{".36 Unsolicited Grant Service Support","docsis_tlv.mcap.ugs",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Unsolicited Grant Service Support", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_map_ucd,\r\n{".37 MAP and UCD Receipt Support","docsis_tlv.mcap.mapucd",\r\nFT_BOOLEAN, BASE_NONE, TFS (&on_off_tfs), 0x0,\r\n"MAP and UCD Receipt Support", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_udc,\r\n{".38 Upstream Drop Classifier Support","docsis_tlv.mcap.udc",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Upstream Drop Classifier Support", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_ipv6,\r\n{".39 IPv6 Support","docsis_tlv.mcap.ipv6",\r\nFT_BOOLEAN, BASE_NONE, TFS (&on_off_tfs), 0x0,\r\n"IPv6 Support", HFILL}\r\n},\r\n{&hf_docsis_tlv_mcap_ext_us_trans_power,\r\n{".40 Extended Upstream Transmit Power Capability",\r\n"docsis_tlv.mcap.extustrpwr",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Extended Upstream Transmit Power Capability", HFILL}\r\n},\r\n{&hf_docsis_tlv_cm_mic,\r\n{"6 CM MIC", "docsis_tlv.cmmic",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Cable Modem Message Integrity Check", HFILL}\r\n},\r\n{&hf_docsis_tlv_cmts_mic,\r\n{"7 CMTS MIC", "docsis_tlv.cmtsmic",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"CMTS Message Integrity Check", HFILL}\r\n},\r\n{&hf_docsis_tlv_vendor_id,\r\n{"8 Vendor ID", "docsis_tlv.vendorid",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Vendor Identifier", HFILL}\r\n},\r\n{&hf_docsis_tlv_sw_file,\r\n{"9 Software Upgrade File", "docsis_tlv.sw_upg_file",\r\nFT_STRINGZ, BASE_NONE, NULL, 0x0,\r\n"Software Upgrade File", HFILL}\r\n},\r\n{&hf_docsis_tlv_snmp_access,\r\n{"10 SNMP Write Access", "docsis_tlv.snmp_access",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"SNMP Write Access", HFILL}\r\n},\r\n{&hf_docsis_tlv_snmp_obj,\r\n{"11 SNMP Object", "docsis_tlv.snmp_obj",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"SNMP Object", HFILL}\r\n},\r\n{&hf_docsis_tlv_modem_addr,\r\n{"12 Modem IP Address", "docsis_tlv.modemaddr",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\n"Modem IP Address", HFILL}\r\n},\r\n{&hf_docsis_tlv_svc_unavail,\r\n{"13 Service Not Available Response", "docsis_tlv.svcunavail",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Service Not Available Response", HFILL}\r\n},\r\n{&hf_docsis_tlv_svc_unavail_classid,\r\n{"Service Not Available: (Class ID)", "docsis_tlv.svcunavail.classid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Service Not Available (Class ID)", HFILL}\r\n},\r\n{&hf_docsis_tlv_svc_unavail_type,\r\n{"Service Not Available (Type)", "docsis_tlv.svcunavail.type",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_tlv_svc_unavail_code,\r\n{"Service Not Available (Code)", "docsis_tlv.svcunavail.code",\r\nFT_UINT8, BASE_DEC, VALS(docsis_conf_code), 0x0,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_tlv_cpe_ethernet,\r\n{"14 CPE Ethernet Addr", "docsis_tlv.cpe_ether",\r\nFT_ETHER, BASE_NONE, NULL, 0x0,\r\n"CPE Ethernet Addr", HFILL}\r\n},\r\n{&hf_docsis_tlv_bpi,\r\n{"17 Baseline Privacy Encoding", "docsis_tlv.bpi",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Baseline Privacy Encoding", HFILL}\r\n},\r\n{&hf_docsis_tlv_max_cpe,\r\n{"18 Max # of CPE's", "docsis_tlv.maxcpe",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Max Number of CPE's", HFILL}\r\n},\r\n{&hf_docsis_tlv_tftp_server_timestamp,\r\n{"19 TFTP Server Timestamp", "docsis_tlv.tftp_time",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"TFTP Server TimeStamp", HFILL}\r\n},\r\n{&hf_docsis_tlv_tftp_prov_modem_address,\r\n{"20 TFTP Server Provisioned Modem Addr", "docsis_tlv.tftpmodemaddr",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\n"TFTP Server Provisioned Modem Addr", HFILL}\r\n},\r\n{&hf_docsis_tlv_sw_upg_srvr,\r\n{"21 Software Upgrade Server", "docsis_tlv.sw_upg_srvr",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\n"Software Upgrade Server", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_upclsfr,\r\n{"22 Upstream Classifier", "docsis_tlv.upclsfr",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_tlv_downclsfr,\r\n{"23 Downstream Classifier", "docsis_tlv.downclsfr",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_tlv_clsfr_ref,\r\n{".1 Classifier Ref", "docsis_tlv.clsfr.ref",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Classifier Reference", HFILL}\r\n},\r\n{&hf_docsis_tlv_clsfr_id,\r\n{".2 Classifier ID", "docsis_tlv.clsfr.id",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Classifier ID", HFILL}\r\n},\r\n{&hf_docsis_tlv_clsfr_sflow_ref,\r\n{".3 Service Flow Ref", "docsis_tlv.clsfr.sflowref",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Service Flow Reference", HFILL}\r\n},\r\n{&hf_docsis_tlv_clsfr_sflow_id,\r\n{".4 Service Flow ID", "docsis_tlv.clsfr.sflowid",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Service Flow ID", HFILL}\r\n},\r\n{&hf_docsis_tlv_clsfr_rule_pri,\r\n{".5 Rule Priority", "docsis_tlv.clsfr.rulepri",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Rule Priority", HFILL}\r\n},\r\n{&hf_docsis_tlv_clsfr_act_state,\r\n{".6 Activation State", "docsis_tlv.clsfr.actstate",\r\nFT_BOOLEAN, BASE_NONE, TFS (&activation_tfs), 0x0,\r\n"Classifier Activation State", HFILL}\r\n},\r\n{&hf_docsis_tlv_clsfr_dsc_act,\r\n{".7 DSC Action", "docsis_tlv.clsfr.dscact",\r\nFT_UINT8, BASE_DEC, VALS (dsc_act_vals), 0x0,\r\n"Dynamic Service Change Action", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_clsfr_err,\r\n{".8 Error Encodings", "docsis_tlv.clsfr.err",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Error Encodings", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_tlv_clsfr_err_param,\r\n{"..1 Param Subtype", "docsis_tlv.clsfr.err.param",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Parameter Subtype", HFILL}\r\n},\r\n{&hf_docsis_tlv_clsfr_err_code,\r\n{"..2 Error Code", "docsis_tlv.clsfr.err.code",\r\nFT_UINT8, BASE_DEC, VALS(docsis_conf_code), 0x0,\r\n"TCP/UDP Destination Port End", HFILL}\r\n},\r\n{&hf_docsis_tlv_clsfr_err_msg,\r\n{"..3 Error Message", "docsis_tlv.clsfr.err.msg",\r\nFT_STRINGZ, BASE_NONE, NULL, 0x0,\r\n"Error Message", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_ipclsfr,\r\n{".9 IP Classifier Encodings", "docsis_tlv.clsfr.ip",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"IP Classifier Encodings", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_tlv_ipclsfr_tosmask,\r\n{"..1 Type Of Service Mask", "docsis_tlv.clsfr.ip.tosmask",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Type Of Service Mask", HFILL}\r\n},\r\n{&hf_docsis_tlv_ipclsfr_ipproto,\r\n{"..2 IP Protocol", "docsis_tlv.clsfr.ip.ipproto",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"IP Protocol", HFILL}\r\n},\r\n{&hf_docsis_tlv_ipclsfr_src,\r\n{"..3 Source Address", "docsis_tlv.clsfr.ip.src",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\n"Source Address", HFILL}\r\n},\r\n{&hf_docsis_tlv_ipclsfr_dst,\r\n{"..4 Destination Address", "docsis_tlv.clsfr.ip.dst",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\n"Destination Address", HFILL}\r\n},\r\n{&hf_docsis_tlv_ipclsfr_srcmask,\r\n{"..5 Source Mask", "docsis_tlv.clsfr.ip.smask",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\n"Source Mask", HFILL}\r\n},\r\n{&hf_docsis_tlv_ipclsfr_dstmask,\r\n{"..6 Destination Mask", "docsis_tlv.clsfr.ip.dmask",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\n"Destination Mask", HFILL}\r\n},\r\n{&hf_docsis_tlv_ipclsfr_sport_start,\r\n{"..7 Source Port Start", "docsis_tlv.clsfr.ip.sportstart",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"TCP/UDP Source Port Start", HFILL}\r\n},\r\n{&hf_docsis_tlv_ipclsfr_sport_end,\r\n{"..8 Source Port End", "docsis_tlv.clsfr.ip.sportend",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"TCP/UDP Source Port End", HFILL}\r\n},\r\n{&hf_docsis_tlv_ipclsfr_dport_start,\r\n{"..9 Dest Port Start", "docsis_tlv.clsfr.ip.dportstart",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"TCP/UDP Destination Port Start", HFILL}\r\n},\r\n{&hf_docsis_tlv_ipclsfr_dport_end,\r\n{"..10 Dest Port End", "docsis_tlv.clsfr.ip.dportend",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"TCP/UDP Destination Port End", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_ethclsfr,\r\n{".10 Ethernet Classifier Encodings", "docsis_tlv.clsfr.eth",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Ethernet Classifier Encodings", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_tlv_ethclsfr_dmac,\r\n{"..1 Dest Mac Address", "docsis_tlv.clsfr.eth.dmac",\r\nFT_ETHER, BASE_NONE, NULL, 0x0,\r\n"Destination Mac Address", HFILL}\r\n},\r\n{&hf_docsis_tlv_ethclsfr_smac,\r\n{"..2 Source Mac Address", "docsis_tlv.clsfr.eth.smac",\r\nFT_ETHER, BASE_NONE, NULL, 0x0,\r\n"Source Mac Address", HFILL}\r\n},\r\n{&hf_docsis_tlv_ethclsfr_ethertype,\r\n{"..3 Ethertype", "docsis_tlv.clsfr.eth.ethertype",\r\nFT_UINT24, BASE_HEX, NULL, 0x0,\r\n"Ethertype", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_dot1qclsfr,\r\n{".11 802.1Q Classifier Encodings", "docsis_tlv.clsfr.dot1q",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"802.1Q Classifier Encodings", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_tlv_dot1qclsfr_user_pri,\r\n{"..1 User Priority", "docsis_tlv.clsfr.dot1q.userpri",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\n"User Priority", HFILL}\r\n},\r\n{&hf_docsis_tlv_dot1qclsfr_vlanid,\r\n{"..2 VLAN id", "docsis_tlv.clsfr.dot1q.ethertype",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"VLAN Id", HFILL}\r\n},\r\n{&hf_docsis_tlv_dot1qclsfr_vendorspec,\r\n{"..43 Vendor Specific Encodings", "docsis_tlv.clsfr.dot1q.vendorspec",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Vendor Specific Encodings", HFILL}\r\n},\r\n{&hf_docsis_tlv_clsfr_vendor_spc,\r\n{".43 Vendor Specific Encodings", "docsis_tlv.clsfr.vendor",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Vendor Specific Encodings", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_upsflow,\r\n{"24 Upstream Service Flow", "docsis_tlv.upsflow",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_tlv_downsflow,\r\n{"25 Downstream Service Flow", "docsis_tlv.downsflow",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_tlv_sflow_ref,\r\n{".1 Service Flow Ref", "docsis_tlv.sflow.ref",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Service Flow Reference", HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_id,\r\n{".2 Service Flow Id", "docsis_tlv.sflow.id",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Service Flow Id", HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_sid,\r\n{".3 Service Identifier", "docsis_tlv.sflow.sid",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Service Identifier", HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_classname,\r\n{".4 Service Class Name", "docsis_tlv.sflow.cname",\r\nFT_STRINGZ, BASE_NONE, NULL, 0x0,\r\n"Service Class Name", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_sflow_err,\r\n{".5 Error Encodings", "docsis_tlv.sflow.err",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Error Encodings", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_tlv_sflow_err_param,\r\n{"..1 Param Subtype", "docsis_tlv.sflow.err.param",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Parameter Subtype", HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_err_code,\r\n{"..2 Error Code", "docsis_tlv.sflow.err.code",\r\nFT_UINT8, BASE_DEC, VALS(docsis_conf_code), 0x0,\r\n"Error Code", HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_err_msg,\r\n{"..3 Error Message", "docsis_tlv.sflow.err.msg",\r\nFT_STRINGZ, BASE_NONE, NULL, 0x0,\r\n"Error Message", HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_qos_param,\r\n{".6 QOS Parameter Set", "docsis_tlv.sflow.qos",\r\nFT_UINT8, BASE_HEX, VALS (qos_param_vals), 0x0,\r\n"QOS Parameter Set", HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_traf_pri,\r\n{".7 Traffic Priority", "docsis_tlv.sflow.trafpri",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Traffic Priority", HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_max_sus,\r\n{".8 Maximum Sustained Traffic Rate (bps)", "docsis_tlv.sflow.maxtrafrate",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Maximum Sustained Traffic Rate (bps)", HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_max_burst,\r\n{".9 Maximum Burst (bps)", "docsis_tlv.sflow.maxburst",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Maximum Burst (bps)", HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_min_traf,\r\n{".10 Minimum Traffic Rate (bps)", "docsis_tlv.sflow.mintrafrate",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Minimum Traffic Rate (bps)", HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_ass_min_pkt_size,\r\n{".11 Assumed Min Reserved Packet Size", "docsis_tlv.sflow.assumed_min_pkt_size",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Assumed Minimum Reserved Packet Size", HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_timeout_active,\r\n{".12 Timeout for Active Params (secs)", "docsis_tlv.sflow.act_timeout",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Timeout for Active Params (secs)", HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_timeout_admitted,\r\n{".13 Timeout for Admitted Params (secs)", "docsis_tlv.sflow.adm_timeout",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Timeout for Admitted Params (secs)", HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_max_down_latency,\r\n{".14 Maximum Downstream Latency (usec)", "docsis_tlv.sflow.max_down_lat",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Maximum Downstream Latency (usec)", HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_max_concat_burst,\r\n{".14 Max Concat Burst", "docsis_tlv.sflow.maxconcat",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Max Concatenated Burst", HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_sched_type,\r\n{".15 Scheduling Type", "docsis_tlv.sflow.schedtype",\r\nFT_UINT32, BASE_HEX, VALS (sched_type_vals), 0x0,\r\n"Scheduling Type", HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_reqxmit_pol,\r\n{".16 Request/Transmission Policy", "docsis_tlv.sflow.reqxmitpol",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\n"Request/Transmission Policy", HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_reqxmit_all_cm_broadcast,\r\n{"Service flow use \"all CMs\" broadcast request opportunities", "docsis_tlv.sflow.reqxmitpol.all_cm_broadcast",\r\nFT_BOOLEAN, 32, TFS(&tfs_must_not_must), 0x01,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_reqxmit_priority_multicast,\r\n{"Service flow use priority multicast request opportunities", "docsis_tlv.sflow.reqxmitpol.priority_multicast",\r\nFT_BOOLEAN, 32, TFS(&tfs_must_not_must), 0x02,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_reqxmit_req_data_requests,\r\n{"Service flow use Request/Data opportunities for requests", "docsis_tlv.sflow.reqxmitpol.req_data_requests",\r\nFT_BOOLEAN, 32, TFS(&tfs_must_not_must), 0x04,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_reqxmit_req_data_data,\r\n{"Service flow use Request/Data opportunities for data", "docsis_tlv.sflow.reqxmitpol.req_data_data",\r\nFT_BOOLEAN, 32, TFS(&tfs_must_not_must), 0x08,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_reqxmit_piggy_back,\r\n{"Service flow use piggy back requests with data", "docsis_tlv.sflow.reqxmitpol.piggy_back",\r\nFT_BOOLEAN, 32, TFS(&tfs_must_not_must), 0x10,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_reqxmit_concatenate_data,\r\n{"Service flow concatenate data", "docsis_tlv.sflow.reqxmitpol.concatenate_data",\r\nFT_BOOLEAN, 32, TFS(&tfs_must_not_must), 0x20,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_reqxmit_fragment,\r\n{"Service flow fragment data", "docsis_tlv.sflow.reqxmitpol.fragment",\r\nFT_BOOLEAN, 32, TFS(&tfs_must_not_must), 0x40,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_reqxmit_suppress_payload,\r\n{"Service flow suppress payload headers", "docsis_tlv.sflow.reqxmitpol.suppress_payload",\r\nFT_BOOLEAN, 32, TFS(&tfs_must_not_must), 0x80,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_reqxmit_drop_packets,\r\n{"Service flow drop packets that do not fit in the UGS size", "docsis_tlv.sflow.reqxmitpol.drop_packets",\r\nFT_BOOLEAN, 32, TFS(&tfs_must_must_not), 0x100,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_nominal_polling,\r\n{".17 Nominal Polling Interval(usec)", "docsis_tlv.sflow.nominal_polling",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Nominal Polling Interval(usec)", HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_tolerated_jitter,\r\n{".18 Tolerated Poll Jitter (usec)", "docsis_tlv.sflow.toler_jitter",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Tolerated Poll Jitter (usec)", HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_ugs_size,\r\n{".19 Unsolicited Grant Size (bytes)", "docsis_tlv.sflow.ugs_size",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Unsolicited Grant Size (bytes)", HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_nom_grant_intvl,\r\n{".20 Nominal Grant Interval (usec)", "docsis_tlv.sflow.nom_grant_intvl",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Nominal Grant Interval (usec)", HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_tol_grant_jitter,\r\n{".21 Tolerated Grant Jitter (usec)", "docsis_tlv.sflow.tol_grant_jitter",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Tolerated Grant Jitter (usec)", HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_grants_per_intvl,\r\n{".22 Grants Per Interval", "docsis_tlv.sflow.grnts_per_intvl",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Grants Per Interval", HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_ip_tos_overwrite,\r\n{".23 IP TOS Overwrite", "docsis_tlv.sflow.iptos_overwrite",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\n"IP TOS Overwrite", HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_ugs_timeref,\r\n{".24 UGS Time Reference", "docsis_tlv.sflow.ugs_timeref",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"UGS Time Reference", HFILL}\r\n},\r\n{&hf_docsis_tlv_sflow_vendor_spec,\r\n{".43 Vendor Specific Encodings", "docsis_tlv.sflow.vendorspec",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Vendor Specific Encodings", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_phs,\r\n{"26 PHS Rules", "docsis_tlv.phs",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"PHS Rules", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_tlv_phs_class_ref,\r\n{".1 Classifier Reference", "docsis_tlv.phs.classref",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Classifier Reference", HFILL}\r\n},\r\n{&hf_docsis_tlv_phs_class_id,\r\n{".2 Classifier Id", "docsis_tlv.phs.classid",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Classifier Id", HFILL}\r\n},\r\n{&hf_docsis_tlv_phs_sflow_ref,\r\n{".3 Service flow reference", "docsis_tlv.phs.sflowref",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Service Flow Reference", HFILL}\r\n},\r\n{&hf_docsis_tlv_phs_sflow_id,\r\n{".4 Service flow Id", "docsis_tlv.phs.sflowid",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Service Flow Id", HFILL}\r\n},\r\n{&hf_docsis_tlv_phs_dsc_action,\r\n{".5 DSC Action", "docsis_tlv.phs.dscaction",\r\nFT_UINT8, BASE_DEC, VALS (action_vals), 0x0,\r\n"Dynamic Service Change Action", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_phs_err,\r\n{".6 Error Encodings", "docsis_tlv.phs.err",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Error Encodings", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_tlv_phs_err_param,\r\n{"..1 Param Subtype", "docsis_tlv.phs.err.param",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Parameter Subtype", HFILL}\r\n},\r\n{&hf_docsis_tlv_phs_err_code,\r\n{"..2 Error Code", "docsis_tlv.phs.err.code",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Error Code", HFILL}\r\n},\r\n{&hf_docsis_tlv_phs_err_msg,\r\n{"..3 Error Message", "docsis_tlv.phs.err.msg",\r\nFT_STRINGZ, BASE_NONE, NULL, 0x0,\r\n"Error Message", HFILL}\r\n},\r\n{&hf_docsis_tlv_phs_phsf,\r\n{".7 PHS Field", "docsis_tlv.phs.phsf",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"PHS Field", HFILL}\r\n},\r\n{&hf_docsis_tlv_phs_phsi,\r\n{".8 PHS Index", "docsis_tlv.phs.phsi",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"PHS Index", HFILL}\r\n},\r\n{&hf_docsis_tlv_phs_phsm,\r\n{".9 PHS Mask", "docsis_tlv.phs.phsm",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"PHS Mask", HFILL}\r\n},\r\n{&hf_docsis_tlv_phs_phss,\r\n{".10 PHS Size", "docsis_tlv.phs.phss",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"PHS Size", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_phs_phsv,\r\n{".11 PHS Verify", "docsis_tlv.phs.phsv",\r\nFT_BOOLEAN, BASE_NONE, TFS (&verify_tfs), 0x0,\r\n"PHS Verify", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_tlv_phs_vendorspec,\r\n{".43 PHS Vendor Specific", "docsis_tlv.phs.vendorspec",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"PHS Vendor Specific", HFILL}\r\n},\r\n{&hf_docsis_tlv_hmac_digest,\r\n{"27 HMAC Digest", "docsis_tlv.hmac_digest",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"HMAC Digest", HFILL}\r\n},\r\n{&hf_docsis_tlv_max_classifiers,\r\n{"28 Max # of Classifiers", "docsis_tlv.maxclass",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Max # of Classifiers", HFILL}\r\n},\r\n{&hf_docsis_tlv_privacy_enable,\r\n{"29 Privacy Enable", "docsis_tlv.bpi_en",\r\nFT_BOOLEAN, BASE_NONE, TFS (&ena_dis_tfs), 0x0,\r\n"Privacy Enable", HFILL}\r\n},\r\n{&hf_docsis_tlv_auth_block,\r\n{"30 Auth Block", "docsis_tlv.auth_block",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Auth Block", HFILL}\r\n},\r\n{&hf_docsis_tlv_key_seq_num,\r\n{"31 Key Sequence Number", "docsis_tlv.key_seq",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Key Sequence Number", HFILL}\r\n},\r\n{&hf_docsis_tlv_mfgr_cvc,\r\n{"32 Manufacturer CVC", "docsis_tlv.mfgr_cvc",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Manufacturer CVC", HFILL}\r\n},\r\n{&hf_docsis_tlv_cosign_cvc,\r\n{"33 Co-Signer CVC", "docsis_tlv.cosign_cvc",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Co-Signer CVC", HFILL}\r\n},\r\n{&hf_docsis_tlv_snmpv3_kick,\r\n{"34 SNMPv3 Kickstart Value", "docsis_tlv.snmpv3",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"SNMPv3 Kickstart Value", HFILL}\r\n},\r\n{&hf_docsis_tlv_snmpv3_kick_name,\r\n{".1 SNMPv3 Kickstart Security Name", "docsis_tlv.snmpv3.secname",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\n"SNMPv3 Kickstart Security Name", HFILL}\r\n},\r\n{&hf_docsis_tlv_snmpv3_kick_publicnum,\r\n{".2 SNMPv3 Kickstart Manager Public Number", "docsis_tlv.snmpv3.publicnum",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"SNMPv3 Kickstart Value Manager Public Number", HFILL}\r\n},\r\n{&hf_docsis_tlv_subs_mgmt_ctrl,\r\n{"35 Subscriber Management Control", "docsis_tlv.subsmgmtctrl",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Subscriber Management Control", HFILL}\r\n},\r\n{&hf_docsis_tlv_subs_mgmt_ip_table,\r\n{"36 Subscriber Management CPE IP Table", "docsis_tlv.subsiptable",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Subscriber Management CPE IP Table", HFILL}\r\n},\r\n{&hf_docsis_tlv_subs_mgmt_ip_entry,\r\n{"Subscriber Management CPE IP Entry", "docsis_tlv.subsipentry",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_tlv_subs_mgmt_filter_grps,\r\n{"37 Subscriber Management Filter Groups", "docsis_tlv.subsfltrgrps",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Subscriber Management Filter Groups", HFILL}\r\n},\r\n{&hf_docsis_tlv_snmpv3_ntfy_rcvr,\r\n{"38 SNMPv3 Notification Receiver", "docsis_tlv.snmpv3ntfy",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"SNMPv3 Notification Receiver", HFILL}\r\n},\r\n{&hf_docsis_tlv_enable_20_mode,\r\n{"39 Enable 2.0 Mode", "docsis_tlv.enable20mode",\r\nFT_BOOLEAN, BASE_NONE, TFS (&ena_dis_tfs), 0x0,\r\n"Enable 2.0 Mode", HFILL}\r\n},\r\n{&hf_docsis_tlv_enable_test_modes,\r\n{"40 Enable Test Modes", "docsis_tlv.enabletestmodes",\r\nFT_BOOLEAN, BASE_NONE, TFS (&ena_dis_tfs), 0x0,\r\n"Enable Test Modes", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_ds_ch_list,\r\n{"41 Downstream Channel List", "docsis_tlv.dschlist",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{&hf_docsis_tlv_ds_ch_list_single,\r\n{".1 Single Downstream Channel", "docsis_tlv.dschlist.single",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_tlv_single_ch_timeout,\r\n{"..1 Timeout", "docsis_tlv.dschlist.single.timeout",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Timeout", HFILL}\r\n},\r\n{&hf_docsis_tlv_single_ch_freq,\r\n{"..2 Timeout", "docsis_tlv.dschlist.single.freq",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Timeout", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_ds_ch_list_range,\r\n{".2 Downstream Frequency Range", "docsis_tlv.dschlist.range",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_tlv_freq_rng_timeout,\r\n{"..1 Timeout", "docsis_tlv.dschlist.range.timeout",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Timeout", HFILL}\r\n},\r\n{&hf_docsis_tlv_freq_rng_start,\r\n{"..2 Frequency Start", "docsis_tlv.dschlist.range.start",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Frequency Start", HFILL}\r\n},\r\n{&hf_docsis_tlv_freq_rng_end,\r\n{"..3 Frequency Start", "docsis_tlv.dschlist.range.end",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Frequency End", HFILL}\r\n},\r\n{&hf_docsis_tlv_freq_rng_step,\r\n{"..4 Frequency Step Size", "docsis_tlv.dschlist.range.step",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Frequency Step Size", HFILL}\r\n},\r\n{&hf_docsis_tlv_ds_ch_list_default_timeout,\r\n{".3 Default Scanning Timeout", "docsis_tlv.dschlist.defaulttimeout",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Default Scanning Timeout", HFILL}\r\n},\r\n{&hf_docsis_tlv_mc_mac_address,\r\n{"42 Static Multicast MAC Address", "docsis_tlv.mcmac",\r\nFT_ETHER, BASE_NONE, NULL, 0x0,\r\n"Static Multicast MAC Address", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_vendor_spec,\r\n{"43 Vendor Specific Encodings", "docsis_tlv.vendorspec",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Vendor Specific Encodings", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_tlv_rng_tech,\r\n{"Ranging Technique", "docsis_tlv.rng_tech",\r\nFT_UINT8, BASE_DEC, VALS (rng_tech_vals), 0x0,\r\nNULL, HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_dut_filter,\r\n{"45 Downstream Unencrypted Traffic Filtering Encoding", "docsis_tlv.dut",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Downstream Unencrypted Traffic Filtering Encoding", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_tlv_dut_filter_control,\r\n{".1 DUT Control", "docsis_tlv.dut.control",\r\nFT_BOOLEAN, BASE_NONE, TFS (&ena_dis_tfs), 0x0,\r\n"DUT Control", HFILL}\r\n},\r\n{&hf_docsis_tlv_dut_filter_cmim,\r\n{".2 DUT CMIM", "docsis_tlv.dut.cmim",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"DUT CMIM", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_tcc,\r\n{"46 Transmit Channel Configuration", "docsis_tlv.tcc",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Transmit Channel Configuration", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_tlv_tcc_refid,\r\n{".1 TCC Reference ID", "docsis_tlv.tcc.refid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"TCC Reference ID", HFILL}\r\n},\r\n{&hf_docsis_tlv_tcc_us_ch_action,\r\n{".2 Upstream Channel Action", "docsis_tlv.tcc.uschact",\r\nFT_UINT8, BASE_DEC, VALS (us_ch_action_vals), 0x0,\r\n"Upstream Channel Action", HFILL}\r\n},\r\n{&hf_docsis_tlv_tcc_us_ch_id,\r\n{".3 Upstream Channel ID", "docsis_tlv.tcc.uschid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Upstream Channel ID", HFILL}\r\n},\r\n{&hf_docsis_tlv_tcc_new_us_ch_id,\r\n{".4 New Upstream Channel ID", "docsis_tlv.tcc.newuschid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"New Upstream Channel ID", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_tcc_ucd,\r\n{".5 Upstream Channel Decsriptor", "docsis_tlv.tcc.ucd",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Upstream Channel Descriptor", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_tlv_tcc_rng_sid,\r\n{".6 Ranging SID", "docsis_tlv.tcc.rngsid",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Ranging SID", HFILL}\r\n},\r\n{&hf_docsis_tlv_tcc_init_tech,\r\n{".7 Initialization Technique", "docsis_tlv.tcc.inittech",\r\nFT_UINT8, BASE_DEC, VALS (init_tech_vals), 0x0,\r\n"Initialization Technique", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_tcc_rng_parms,\r\n{".8 Ranging Parameters", "docsis_tlv.tcc.rngparms",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Ranging Parameters", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_rng_parms_us_ch_id,\r\n{"..1 Ranging Reference Channel ID", "docsis_tlv.tcc.rngparms.uschid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Upstream Channel ID", HFILL}\r\n},\r\n{&hf_docsis_rng_parms_time_off_int,\r\n{"..2 Timing Offset, Integer Part", "docsis_tlv.tcc.rngparms.timeoffint",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Timing Offset, Integer Part", HFILL}\r\n},\r\n{&hf_docsis_rng_parms_time_off_frac,\r\n{"..3 Timing Offset, Fractional Part", "docsis_tlv.tcc.rngparms.timeofffrac",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Timing Offset, Fractional Part", HFILL}\r\n},\r\n{&hf_docsis_rng_parms_power_off,\r\n{"..4 Power Offset", "docsis_tlv.tcc.rngparms.poweroff",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Power Offset", HFILL}\r\n},\r\n{&hf_docsis_rng_parms_freq_off,\r\n{"..5 Frequency Offset", "docsis_tlv.tcc.rngparms.freqoff",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Frequency Offset", HFILL}\r\n},\r\n{&hf_docsis_tlv_tcc_dyn_rng_win,\r\n{".9 Dynamic Range Window", "docsis_tlv.tcc.dynrngwin",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Dynamic Range Window", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_tcc_err,\r\n{".10 TCC Error Encodings", "docsis_tlv.tcc.err",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"TCC Error Encodings", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_tcc_err_subtype,\r\n{"..1 TCC Subtype", "docsis_tlv.tcc.err.subtype",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"TCC Subtype", HFILL}\r\n},\r\n{&hf_docsis_tcc_err_code,\r\n{"..2 Error Code", "docsis_tlv.tcc.err.code",\r\nFT_UINT8, BASE_DEC, VALS(docsis_conf_code), 0x0,\r\n"Error Code", HFILL}\r\n},\r\n{&hf_docsis_tcc_err_msg,\r\n{"..3 Error Message", "docsis_tlv.tcc.err.msg",\r\nFT_STRINGZ, BASE_NONE, NULL, 0x0,\r\n"Error Message", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_sid_cl,\r\n{"47 Service Flow SID Cluster Assignments", "docsis_tlv.sid",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Service Flow SID Cluster Assignments", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_sid_cl_sf_id,\r\n{".1 Service Flow ID", "docsis_tlv.sid.sfid",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Upstream Channel ID", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_sid_cl_enc,\r\n{".2 SID Cluster Encodings", "docsis_tlv.sid.enc",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"SID Cluster Encodings", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_sid_cl_enc_id,\r\n{"..1 SID Cluster ID", "docsis_tlv.sid.enc.id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"SID Cluster ID", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_sid_cl_enc_map,\r\n{"..2 SID-to-Channel Mapping", "docsis_tlv.sid.enc.map",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"SID Cluster ID", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_sid_cl_map_us_ch_id,\r\n{"...1 Upstream Channel ID", "docsis_tlv.sid.enc.map.uschid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Upstream Channel ID", HFILL}\r\n},\r\n{&hf_docsis_sid_cl_map_sid,\r\n{"...2 SID", "docsis_tlv.sid.enc.map.sid",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"SID", HFILL}\r\n},\r\n{&hf_docsis_sid_cl_map_action,\r\n{"...3 SID-to-Channel Mapping Action", "docsis_tlv.sid.enc.map.action",\r\nFT_UINT8, BASE_DEC, VALS (sid_ch_map_vals), 0x0,\r\n"SID-to-Channel Mapping Action", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_sid_cl_so_crit,\r\n{".3 SID Cluster Switchover Criteria", "docsis_tlv.sid.socrit",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"SID Cluster Switchover Criteria", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_sid_cl_so_max_req,\r\n{"..1 Maximum Requests per SID Cluster", "docsis_tlv.sid.socrit.maxreq",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Maximum Requests per SID Cluster", HFILL}\r\n},\r\n{&hf_docsis_sid_cl_so_max_out_bytes,\r\n{"..2 Maximum Outstanding Bytes per SID Cluster", "docsis_tlv.sid.socrit.maxoutbytes",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Maximum Outstanding Bytes per SID Cluster", HFILL}\r\n},\r\n{&hf_docsis_sid_cl_so_max_req_bytes,\r\n{"..3 Maximum Total Bytes Requested per SID Cluster", "docsis_tlv.sid.socrit.maxreqbytes",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Maximum Total Bytes Requested per SID Cluster", HFILL}\r\n},\r\n{&hf_docsis_sid_cl_so_max_time,\r\n{"..4 Maximum Time in the SID Cluster", "docsis_tlv.sid.socrit.maxtime",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Maximum Time in the SID Cluster", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_rcp,\r\n{"48 Receive Channel Profile", "docsis_tlv.rcp",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Receive Channel Profile", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_tlv_rcp_id,\r\n{".1 RCP-ID", "docsis_tlv.rcp.id",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"RCP-ID", HFILL}\r\n},\r\n{&hf_docsis_tlv_rcp_name,\r\n{".2 RCP Name", "docsis_tlv.rcp.name",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"RCP Name", HFILL}\r\n},\r\n{&hf_docsis_tlv_rcp_freq_spc,\r\n{".3 RCP Center Frequency Spacing", "docsis_tlv.rcp.freq_spc",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"RCP Center Frequency Spacing", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_rcp_rcv_mod_enc,\r\n{".4 Receive Module Capability", "docsis_tlv.rcp.rcv_mod_enc",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Receive Module Encoding", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_rcv_mod_enc_idx,\r\n{"..1 Receive Module Index", "docsis_tlv.rcp.rcv_mod_enc.idx",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Receive Module Index", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_rcv_mod_enc_adj_ch,\r\n{"..2 Adjacent Channels", "docsis_tlv.rcp.rcv_mod_enc.adj_ch",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Adjacent Channels", HFILL}\r\n},\r\n{&hf_docsis_rcv_mod_enc_ch_bl_rng,\r\n{"..3 Channel Block Range", "docsis_tlv.rcp.rcv_mod_enc.ch_bl_rng",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Channel Block Range", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_rcv_mod_enc_ctr_freq_asgn,\r\n{"..4 First Channel Center Frequency Assignment", "docsis_tlv.rcv_mod_enc.ctr_freq_asgn",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"First Channel Center Frequency Assignment", HFILL}\r\n},\r\n{&hf_docsis_ch_bl_rng_min_ctr_freq,\r\n{"...1 Minimum Center Frequency", "docsis_tlv.rcp.rcv_mod_enc.ch_bl_rng.min_ctr_freq",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Minimum Center Frequency", HFILL}\r\n},\r\n{&hf_docsis_ch_bl_rng_max_ctr_freq,\r\n{"...2 Maximum Center Frequency", "docsis_tlv.rcp.rcv_mod_enc.ch_bl_rng.max_ctr_freq",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Maximum Center Frequency", HFILL}\r\n},\r\n{&hf_docsis_rcv_mod_enc_rsq_ch_subs_cap ,\r\n{"..5 Resequencing Channel Subset Capability", "docsis_tlv.rcp.rcv_mod_enc.rsq_ch_subs_cap",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Resequencing Channel Subset Capability", HFILL}\r\n},\r\n{&hf_docsis_rcv_mod_enc_conn ,\r\n{"..6 Receive Module Connectivity", "docsis_tlv.rcp.rcv_mod_enc.conn",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Receive Module Connectivity", HFILL}\r\n},\r\n{&hf_docsis_rcv_mod_enc_phy_layr_parms,\r\n{"..7 Physical Layer Parameter", "docsis_tlv.rcp.rcv_mod_enc.phy_layr_parms",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Physical Layer Parameter", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_rcp_rcv_ch,\r\n{".5 Receive Channel", "docsis_tlv.rcp.rcv_ch",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Receive Channel", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_rcv_ch_idx,\r\n{"..1 Receive Channel Index", "docsis_tlv.rcp.rcv_ch.idx",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Receive Channel Index", HFILL}\r\n},\r\n{&hf_docsis_rcv_ch_conn,\r\n{"..2 Receive Channel Connectivity", "docsis_tlv.rcp.rcv_ch.conn",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Receive Channel Connectivity", HFILL}\r\n},\r\n{&hf_docsis_rcv_ch_conn_off,\r\n{"..3 Receive Channel Connected Offset", "docsis_tlv.rcp.rcv_ch.conn_off",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Receive Channel Connected Offset", HFILL}\r\n},\r\n{&hf_docsis_rcv_ch_prim_ds_ch_ind,\r\n{"..5 Primary Downstream Channel Indicator", "docsis_tlv.rcp.rcv_ch.prim_ds_ch_ind",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Primary Downstream Channel Indicator", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_rcp_ven_spec,\r\n{".43 Vendor Specific Encodings", "docsis_tlv.rcp.vendorspec",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Vendor Specific Encodings", HFILL}\r\n},\r\n{&hf_docsis_tlv_rcc,\r\n{"49 Receive Channel Configuration", "docsis_tlv.rcc",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Receive Channel Configuration", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_tlv_rcc_id,\r\n{".1 Assigned RCP-ID", "docsis_tlv.rcc.id",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Assigned RCP-ID", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_rcc_rcv_mod_enc,\r\n{".4 Receive Module Assignment", "docsis_tlv.rcc.rcv_mod_enc",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Receive Module Assignment", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_rcc_rcv_mod_enc_idx,\r\n{"..1 Receive Module Index", "docsis_tlv.rcc.rcc_rcv_mod_enc.idx",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Receive Module Index", HFILL}\r\n},\r\n{&hf_docsis_rcc_rcv_mod_enc_ctr_freq_asgn,\r\n{"..4 First Channel Center Frequency Assignment", "docsis_tlv.rcc.rcv_mod_enc.ctr_freq_asgn",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"First Channel Center Frequency Assignment", HFILL}\r\n},\r\n{&hf_docsis_rcc_rcv_mod_enc_conn ,\r\n{"..6 Receive Module Connectivity", "docsis_tlv.rcc.rcv_mod_enc.conn",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Receive Module Connectivity", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_rcc_rcv_ch,\r\n{".5 Receive Channel", "docsis_tlv.rcc.rcv_ch",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Receive Channel", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_rcc_rcv_ch_idx,\r\n{"..1 Receive Channel Index", "docsis_tlv.rcc.rcv_ch.idx",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Receive Channel Index", HFILL}\r\n},\r\n{&hf_docsis_rcc_rcv_ch_conn,\r\n{"..2 Receive Channel Connectivity", "docsis_tlv.rcc.rcv_ch.conn",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Receive Channel Connectivity", HFILL}\r\n},\r\n{&hf_docsis_rcc_rcv_ch_ctr_freq_asgn,\r\n{"..4 Receive Channel Center Frequency Assignment", "docsis_tlv.rcc.rcv_ch.ctr_freq_asgn",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Receive Channel Center Frequency Assignment", HFILL}\r\n},\r\n{&hf_docsis_rcc_rcv_ch_prim_ds_ch_ind,\r\n{"..5 Primary Downstream Channel Indicator", "docsis_tlv.rcc.rcv_ch.prim_ds_ch_ind",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Primary Downstream Channel Indicator", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_rcc_part_serv_ds_ch,\r\n{".6 Partial Service Downstream Channels", "docsis_tlv.rcc.part_serv_ds_ch",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Partial Service Downstream Channels", HFILL}\r\n},\r\n{&hf_docsis_tlv_rcc_ven_spec,\r\n{".43 Vendor Specific Encodings", "docsis_tlv.rcc.vendorspec",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Vendor Specific Encodings", HFILL}\r\n},\r\n{&hf_docsis_tlv_rcc_err,\r\n{".254 RCC Error Encodings", "docsis_tlv.rcc.err",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"RCC Error Encodings", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_tlv_rcc_err_mod_or_ch,\r\n{".1 Receive Modul or Receive Channel", "docsis_tlv.rcc.err.mod_or_ch",\r\nFT_UINT8, BASE_DEC, VALS (mod_or_ch_vals), 0x0,\r\n"Receive Modul or Receive Channel", HFILL}\r\n},\r\n{&hf_docsis_tlv_rcc_err_idx,\r\n{".2 Receive Modul/Channel Index", "docsis_tlv.rcc.err.idx",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Receive Modul/Channel Index", HFILL}\r\n},\r\n{&hf_docsis_tlv_rcc_err_param,\r\n{".3 Reported Parameter", "docsis_tlv.rcc.err.param",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Reported Parameter", HFILL}\r\n},\r\n{&hf_docsis_tlv_rcc_err_code,\r\n{".4 Error Code", "docsis_tlv.rcc.err.code",\r\nFT_UINT8, BASE_DEC, VALS (docsis_conf_code), 0x0,\r\n"Error Code", HFILL}\r\n},\r\n{&hf_docsis_tlv_rcc_err_msg,\r\n{".5 Error Message", "docsis_tlv.rcc.err.msg",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Error Message", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_dsid,\r\n{"50 DSID Encodings", "docsis_tlv.dsid",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"DSID Encodings", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_tlv_dsid_id,\r\n{".1 Downstream Service Identifier (DSID)", "docsis_tlv.dsid.id",\r\nFT_UINT24, BASE_DEC, NULL, 0x0,\r\n"Downstream Service Identifier (DSID)", HFILL}\r\n},\r\n{&hf_docsis_tlv_dsid_action,\r\n{".2 DSID Action", "docsis_tlv.dsid.action",\r\nFT_UINT8, BASE_DEC, VALS (dsid_action_vals), 0x0,\r\n"DSID Action", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_dsid_ds_reseq,\r\n{".3 Downstream Resequencing Encodings", "docsis_tlv.dsid.ds_reseq",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Downstream Resequencing Encodings", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_ds_reseq_dsid,\r\n{"..1 Resequencing DSID", "docsis_tlv.dsid.ds_reseq.dsid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Resequencing DSID", HFILL}\r\n},\r\n{&hf_docsis_ds_reseq_ch_lst,\r\n{"..2 Downstream Resequencing Channel List", "docsis_tlv.dsid.ds_reseq.ch_lst",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Downstream Resequencing Channel List", HFILL}\r\n},\r\n{&hf_docsis_ds_reseq_wait_time,\r\n{"..3 Downstream Resequencing Wait Time", "docsis_tlv.dsid.ds_reseq.wait_time",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Downstream Resequencing Wait Time", HFILL}\r\n},\r\n{&hf_docsis_ds_reseq_warn_thresh,\r\n{"..4 Resequencing Warn Threshold", "docsis_tlv.dsid.ds_reseq.warn_thresh",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Resequencing Warn Threshold", HFILL}\r\n},\r\n{&hf_docsis_ds_reseq_ho_timer,\r\n{"..5 CM-Status max. Event Hold-Off Timer (Out-of-Range Events)", "docsis_tlv.dsid.ds_reseq.ho_timer",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"CM-Status max. Event Hold-Off Timer (Out-of-Range Events)", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_dsid_mc,\r\n{".4 Multicast Encodings", "docsis_tlv.dsid.mc",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Multicast Encodings", HFILL}\r\n},\r\n{&hf_docsis_tlv_dsid_mc_addr,\r\n{"..1 Client MAC Address Encodings", "docsis_tlv.dsid.mc.addr",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Client MAC Address Encodings", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_mc_addr_action,\r\n{"...1 Client MAC Address Action", "docsis_tlv.dsid.mc.addr.action",\r\nFT_UINT8, BASE_DEC, VALS (add_del_vals), 0x0,\r\n"Client MAC Address Action", HFILL}\r\n},\r\n{&hf_docsis_mc_addr_addr,\r\n{"...2 Client MAC Address", "docsis_tlv.dsid.mc.addr.addr",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Client MAC Address", HFILL}\r\n},\r\n{&hf_docsis_tlv_dsid_mc_cmim,\r\n{"..2 Multicast CM Interface Mask", "docsis_tlv.dsid.mc.cmim",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Multicast CM Interface Mask", HFILL}\r\n},\r\n{&hf_docsis_tlv_dsid_mc_group,\r\n{"..3 Multicast Group MAC Addresses", "docsis_tlv.dsid.mc.group",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Multicast Group MAC Addresses", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_dsid_mc_phs,\r\n{"..26 Payload Header Suppression Encodings", "docsis_tlv.dsid.mc.phs",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Payload Header Suppression Encodings", HFILL}\r\n},\r\n{&hf_docsis_tlv_sec_assoc,\r\n{"51 Security Association Encodings", "docsis_tlv.sec_assoc",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Security Association Encodings", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_tlv_sec_assoc_action,\r\n{".1 SA Action", "docsis_tlv.sec_assoc.action",\r\nFT_UINT8, BASE_DEC, VALS (add_del_vals), 0x0,\r\n"SA Action", HFILL}\r\n},\r\n{&hf_docsis_tlv_sec_assoc_desc,\r\n{".23 SA Descriptor", "docsis_tlv.sec_assoc.desc",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"SA Descriptor", HFILL}\r\n},\r\n{&hf_docsis_tlv_init_ch_timeout,\r\n{"52 Intializing Channel Timeout", "docsis_tlv.init_ch_timeout",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Intializing Channel Timeout", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_ch_asgn,\r\n{"56 Channel Assignment Configuration Settings", "docsis_tlv.ch_asgn",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Channel Assignment Configuration Settings", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_ch_asgn_us_ch_id,\r\n{".1 Upstream Channel ID", "docsis_tlv.ch_asgn.us_ch_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Upstream Channel ID", HFILL}\r\n},\r\n{&hf_docsis_ch_asgn_rx_freq,\r\n{".2 Rx Frequency", "docsis_tlv.ch_asgn.rx_freq",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Rx Frequency", HFILL}\r\n},\r\n{&hf_docsis_tlv_cm_init_reason,\r\n{"57 CM Initialization Reason", "docsis_tlv.cm_init_reason",\r\nFT_UINT16, BASE_DEC, VALS (init_reason_vals), 0x0,\r\n"CM Initialization Reason", HFILL}\r\n},\r\n{&hf_docsis_tlv_sw_upg_srvr_ipv6,\r\n{"58 Software Upgrade Server IPv6", "docsis_tlv.sw_upg_srvr_ipv6",\r\nFT_IPv6, BASE_NONE, NULL, 0x0,\r\n"Software Upgrade Server IPv6", HFILL}\r\n},\r\n{&hf_docsis_tlv_tftp_prov_cm_ipv6_addr,\r\n{"59 TFTP Server Provisioned Modem IPv6 Address", "docsis_tlv.tftp_prov_cm_ipv6_addr",\r\nFT_IPv6, BASE_NONE, NULL, 0x0,\r\n"TFTP Server Provisioned Modem IPv6 Address", HFILL}\r\n},\r\n{&hf_docsis_tlv_us_drop_clfy,\r\n{"60 Upstream Drop Packet Classification Encoding", "docsis_tlv.us_drop_clfy",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Upstream Drop Packet Classification Encoding", HFILL}\r\n},\r\n{&hf_docsis_tlv_subs_mgmt_ipv6_lst,\r\n{"61 Subscriber Management CPE IPv6 Prefix List", "docsis_tlv.subs_mgmt_ipv6_lst",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Subscriber Management CPE IPv6 Prefix List", HFILL}\r\n},\r\n{&hf_docsis_tlv_us_drop_clfy_group_id,\r\n{"62 Upstream Drop Classifier Group ID", "docsis_tlv.us_drop_clfy_group_id",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Upstream Drop Classifier Group ID", HFILL}\r\n},\r\n{&hf_docsis_tlv_subs_mgmt_ctrl_max_cpe_ipv6,\r\n{"63 Subscriber Management Control Max CPE IPv6 Prefix", "docsis_tlv.subs_mgmt_ctrl_max_cpe_ipv6",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Subscriber Management Control Max CPE IPv6 Prefix", HFILL}\r\n},\r\n#if 0\r\n{&hf_docsis_tlv_cmts_mc_sess_enc,\r\n{"64 CMTS Static Multicast Session Encoding", "docsis_tlv.cmts_mc_sess_enc",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"CMTS Static Multicast Session Encoding", HFILL}\r\n},\r\n#endif\r\n{&hf_docsis_cmts_mc_sess_enc_grp,\r\n{".1 Multicast Group Address", "docsis_tlv.cmts_mc_sess_enc.grp",\r\nFT_IPXNET, BASE_NONE, NULL, 0x0,\r\n"Multicast Group Address", HFILL}\r\n},\r\n{&hf_docsis_cmts_mc_sess_enc_src,\r\n{".2 Source IP Address", "docsis_tlv.cmts_mc_sess_enc.src",\r\nFT_IPXNET, BASE_NONE, NULL, 0x0,\r\n"Source IP Address", HFILL}\r\n},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_docsis_tlv,\r\n&ett_docsis_tlv_cos,\r\n&ett_docsis_tlv_mcap,\r\n&ett_docsis_tlv_clsfr,\r\n&ett_docsis_tlv_clsfr_ip,\r\n&ett_docsis_tlv_clsfr_eth,\r\n&ett_docsis_tlv_clsfr_err,\r\n&ett_docsis_tlv_clsfr_dot1q,\r\n&ett_docsis_tlv_reqxmitpol,\r\n&ett_docsis_tlv_sflow_err,\r\n&ett_docsis_tlv_phs,\r\n&ett_docsis_tlv_phs_err,\r\n&ett_docsis_tlv_svc_unavail,\r\n&ett_docsis_tlv_snmpv3_kick,\r\n&ett_docsis_tlv_ds_ch_list,\r\n&ett_docsis_tlv_ds_ch_list_single,\r\n&ett_docsis_tlv_ds_ch_list_range,\r\n&ett_docsis_tlv_tcc,\r\n&ett_docsis_tlv_tcc_ucd,\r\n&ett_docsis_tlv_tcc_rng_parms,\r\n&ett_docsis_tlv_tcc_err,\r\n&ett_docsis_tlv_sid_cl,\r\n&ett_docsis_tlv_sid_cl_enc,\r\n&ett_docsis_tlv_sid_cl_enc_map,\r\n&ett_docsis_tlv_sid_cl_so,\r\n&ett_docsis_tlv_rcp,\r\n&ett_docsis_tlv_rcp_rcv_mod_enc,\r\n&ett_docsis_tlv_rcp_ch_bl_rng,\r\n&ett_docsis_tlv_rcp_rcv_ch,\r\n&ett_docsis_tlv_rcc,\r\n&ett_docsis_tlv_rcc_rcv_mod_enc,\r\n&ett_docsis_tlv_rcc_rcv_ch,\r\n&ett_docsis_tlv_rcc_err,\r\n&ett_docsis_tlv_dsid,\r\n&ett_docsis_tlv_dsid_ds_reseq,\r\n&ett_docsis_tlv_dsid_mc,\r\n&ett_docsis_tlv_dsid_mc_addr,\r\n&ett_docsis_tlv_sec_assoc,\r\n&ett_docsis_tlv_ch_asgn,\r\n&ett_docsis_cmts_mc_sess_enc,\r\n};\r\nproto_docsis_tlv = proto_register_protocol ("DOCSIS Appendix C TLV's",\r\n"DOCSIS TLVs", "docsis_tlv");\r\nproto_register_field_array (proto_docsis_tlv, hf, array_length (hf));\r\nproto_register_subtree_array (ett, array_length (ett));\r\nregister_dissector ("docsis_tlv", dissect_tlv, proto_docsis_tlv);\r\n}\r\nvoid\r\nproto_reg_handoff_docsis_tlv (void)\r\n{\r\n#if 0\r\ndissector_handle_t docsis_tlv_handle;\r\ndocsis_tlv_handle = find_dissector ("docsis_tlv");\r\ndissector_add_uint ("docsis", 0xFF, docsis_tlv_handle);\r\n#endif\r\ndocsis_vsif_handle = find_dissector("docsis_vsif");\r\ndocsis_ucd_handle = find_dissector("docsis_ucd");\r\n}
