static void\r\ndissect_ssc_read6 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *read6_fields[] = {\r\n&hf_scsi_ssc_sili,\r\n&hf_scsi_ssc_fixed,\r\nNULL\r\n};\r\nif (isreq) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(Len: %u)",\r\ntvb_get_ntoh24 (tvb, offset+1));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_ssc_read6_flags,\r\nett_scsi_read6, read6_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_rdwr6_xferlen, tvb, offset+1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+4, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_ssc_recoverbuffereddata (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *recover_fields[] = {\r\n&hf_scsi_ssc_sili,\r\n&hf_scsi_ssc_fixed,\r\nNULL\r\n};\r\nif (isreq) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(Len: %u)",\r\ntvb_get_ntoh24 (tvb, offset+1));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_ssc_read6_flags,\r\nett_scsi_read6, recover_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_rdwr6_xferlen, tvb, offset+1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+4, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_ssc_reportdensitysupport (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *rd_fields[] = {\r\n&hf_scsi_ssc_medium_type,\r\n&hf_scsi_ssc_media,\r\nNULL\r\n};\r\nif (isreq) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(Len: %u)",\r\ntvb_get_ntoh24 (tvb, offset+1));\r\n}\r\nif(!tree)\r\nreturn;\r\nif (isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_ssc_read6_flags,\r\nett_scsi_read6, rd_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_rdwr6_xferlen, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+8, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n} else {\r\n}\r\n}\r\nstatic void\r\ndissect_ssc_readreverse6 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *rr6_fields[] = {\r\n&hf_scsi_ssc_bytord,\r\n&hf_scsi_ssc_sili,\r\n&hf_scsi_ssc_fixed,\r\nNULL\r\n};\r\nif (isreq) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(Len: %u)",\r\ntvb_get_ntoh24 (tvb, offset+1));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_ssc_read6_flags,\r\nett_scsi_read6, rr6_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_rdwr6_xferlen, tvb, offset+1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+4, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_ssc_read16 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *read6_fields[] = {\r\n&hf_scsi_ssc_sili,\r\n&hf_scsi_ssc_fixed,\r\nNULL\r\n};\r\nif (isreq) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(Len: %u)",\r\ntvb_get_ntoh24 (tvb, offset+1));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_ssc_read6_flags,\r\nett_scsi_read6, read6_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_partition, tvb, offset+2, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_locate16_loid, tvb, offset+3, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_rdwr6_xferlen, tvb, offset+11, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+14, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_ssc_write16 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *write16_fields[] = {\r\n&hf_scsi_ssc_fcs,\r\n&hf_scsi_ssc_lcs,\r\n&hf_scsi_ssc_fixed,\r\nNULL\r\n};\r\nif (isreq) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(Len: %u)",\r\ntvb_get_ntoh24 (tvb, offset+1));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_ssc_read6_flags,\r\nett_scsi_read6, write16_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_partition, tvb, offset+2, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_locate16_loid, tvb, offset+3, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_rdwr6_xferlen, tvb, offset+11, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+14, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_ssc_writefilemarks16 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *wf16_fields[] = {\r\n&hf_scsi_ssc_fcs,\r\n&hf_scsi_ssc_lcs,\r\n&hf_scsi_ssc_immed,\r\nNULL\r\n};\r\nif (isreq) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(Len: %u)",\r\ntvb_get_ntoh24 (tvb, offset+1));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_ssc_read6_flags,\r\nett_scsi_read6, wf16_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_partition, tvb, offset+2, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_locate16_loid, tvb, offset+3, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_rdwr6_xferlen, tvb, offset+11, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+14, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_ssc_verify16 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *verify16_fields[] = {\r\n&hf_scsi_ssc_verify16_immed,\r\n&hf_scsi_ssc_bytcmp,\r\n&hf_scsi_ssc_fixed,\r\nNULL\r\n};\r\nif (isreq) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(Len: %u)",\r\ntvb_get_ntoh24 (tvb, offset+1));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_ssc_read6_flags,\r\nett_scsi_read6, verify16_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_partition, tvb, offset+2, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_locate16_loid, tvb, offset+3, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_ver16_verlen, tvb, offset+11, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+14, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_ssc_verify6 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *verify6_fields[] = {\r\n&hf_scsi_ssc_verify16_immed,\r\n&hf_scsi_ssc_bytcmp,\r\n&hf_scsi_ssc_fixed,\r\nNULL\r\n};\r\nif (isreq) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(Len: %u)",\r\ntvb_get_ntoh24 (tvb, offset+1));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_ssc_read6_flags,\r\nett_scsi_read6, verify6_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_ver16_verlen, tvb, offset+1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+4, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_ssc_readreverse16 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *rr16_fields[] = {\r\n&hf_scsi_ssc_bytord,\r\n&hf_scsi_ssc_sili,\r\n&hf_scsi_ssc_fixed,\r\nNULL\r\n};\r\nif (isreq) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(Len: %u)",\r\ntvb_get_ntoh24 (tvb, offset+1));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_ssc_read6_flags,\r\nett_scsi_read6, rr16_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_partition, tvb, offset+2, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_locate16_loid, tvb, offset+3, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_rdwr6_xferlen, tvb, offset+11, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+14, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_ssc_write6 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *write6_fields[] = {\r\n&hf_scsi_ssc_immed,\r\nNULL\r\n};\r\nif (isreq && iscdb) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(Len: %u)",\r\ntvb_get_ntoh24 (tvb, offset+1));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_ssc_read6_flags,\r\nett_scsi_read6, write6_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_rdwr6_xferlen, tvb, offset+1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+4, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_ssc_writefilemarks6 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *wf6_fields[] = {\r\n&hf_scsi_ssc_immed,\r\nNULL\r\n};\r\nif (isreq) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(Len: %u)",\r\ntvb_get_ntoh24 (tvb, offset+1));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_ssc_read6_flags,\r\nett_scsi_read6, wf6_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_rdwr6_xferlen, tvb, offset+1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+4, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_ssc_loadunload (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *loadunload_immed_fields[] = {\r\n&hf_scsi_ssc_immed,\r\nNULL\r\n};\r\nstatic const int *loadunload_fields[] = {\r\n&hf_scsi_ssc_hold,\r\n&hf_scsi_ssc_eot,\r\n&hf_scsi_ssc_reten,\r\n&hf_scsi_ssc_load,\r\nNULL\r\n};\r\nif (isreq && iscdb) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(Immed: %u)",\r\ntvb_get_guint8 (tvb, offset) & 0x01);\r\n}\r\nif (!tree)\r\nreturn;\r\nif (isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_ssc_loadunload_immed_flags,\r\nett_scsi_loadunload_immed, loadunload_immed_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+3, hf_scsi_ssc_loadunload_flags,\r\nett_scsi_loadunload, loadunload_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+4, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_ssc_readblocklimits (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nguint8 granularity;\r\nif (!tree)\r\nreturn;\r\nif (isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset+4, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\nelse if (!iscdb) {\r\ngranularity = tvb_get_guint8 (tvb, offset);\r\nproto_tree_add_uint_format_value(tree, hf_scsi_ssc_readblocklimits_granularity, tvb, offset, 1,\r\n1 << granularity, "%u %s", 1 << granularity,\r\nplurality(1 << granularity, "byte", "bytes"));\r\nproto_tree_add_uint_format_value(tree, hf_scsi_ssc_readblocklimits_max_block_length_limit, tvb, offset+1, 3,\r\ntvb_get_ntoh24 (tvb, offset+1), "%u bytes", tvb_get_ntoh24 (tvb, offset+1));\r\nproto_tree_add_uint_format_value(tree, hf_scsi_ssc_readblocklimits_min_block_length_limit, tvb, offset+4, 2,\r\ntvb_get_ntohs (tvb, offset+4), "%u bytes", tvb_get_ntohs (tvb, offset+4));\r\n}\r\n}\r\nstatic void\r\ndissect_ssc_rewind (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *rewind_fields[] = {\r\n&hf_scsi_ssc_immed,\r\nNULL\r\n};\r\nif (!tree)\r\nreturn;\r\nif (isreq && iscdb) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(Immed: %u)",\r\ntvb_get_guint8 (tvb, offset) & 0x01);\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_ssc_read6_flags, ett_scsi_read6, rewind_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+4, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_ssc_setcapacity (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *sc_fields[] = {\r\n&hf_scsi_ssc_immed,\r\nNULL\r\n};\r\nif (!tree)\r\nreturn;\r\nif (isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_ssc_read6_flags,\r\nett_scsi_read6, sc_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_capacity_prop_value, tvb, offset+2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+4, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_ssc_locate10 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *locate_fields[] = {\r\n&hf_scsi_ssc_bt,\r\n&hf_scsi_ssc_cp,\r\n&hf_scsi_ssc_immed,\r\nNULL\r\n};\r\nif (!tree)\r\nreturn;\r\nif (isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_ssc_locate_flags,\r\nett_scsi_locate, locate_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_locate10_loid, tvb, offset+2, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_partition, tvb, offset+7, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+8, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_ssc_locate16 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *locate_fields[] = {\r\n&hf_scsi_ssc_dest_type,\r\n&hf_scsi_ssc_cp,\r\n&hf_scsi_ssc_immed,\r\nNULL\r\n};\r\nstatic const int *bam_fields[] = {\r\n&hf_scsi_ssc_bam,\r\nNULL\r\n};\r\nif (!tree)\r\nreturn;\r\nif (isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_ssc_locate_flags,\r\nett_scsi_locate, locate_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+1, hf_scsi_ssc_bam_flags,\r\nett_scsi_bam, bam_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_partition, tvb, offset+2, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_locate16_loid, tvb, offset+3, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+14, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_ssc_erase6 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nif (isreq && iscdb) {\r\nif (!tree)\r\nreturn;\r\nproto_tree_add_item(tree, hf_scsi_ssc_erase6_immed, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_scsi_ssc_erase6_long, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+4, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_ssc_erase16 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *erase16_fields[] = {\r\n&hf_scsi_ssc_fcs,\r\n&hf_scsi_ssc_lcs,\r\n&hf_scsi_ssc_erase_immed,\r\n&hf_scsi_ssc_long,\r\nNULL\r\n};\r\nif (!tree)\r\nreturn;\r\nif (isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_ssc_erase_flags,\r\nett_scsi_erase, erase16_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_partition, tvb, offset+2, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_lbi, tvb, offset+3, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+14, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_ssc_space6 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nif (!tree)\r\nreturn;\r\nif (isreq && iscdb) {\r\nproto_tree_add_item (tree, hf_scsi_ssc_space6_code, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_space6_count, tvb, offset+1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+4, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_ssc_space16 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nif (!tree)\r\nreturn;\r\nif (isreq && iscdb) {\r\nproto_tree_add_item (tree, hf_scsi_ssc_space6_code, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_space16_count, tvb, offset+3, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_scsi_ssc_space16_parameter_len, tvb, offset+11, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+14, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_ssc_formatmedium (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *formatmedium_fields[] = {\r\n&hf_scsi_ssc_verify,\r\n&hf_scsi_ssc_immed,\r\nNULL\r\n};\r\nif (!tree)\r\nreturn;\r\nif (isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_ssc_formatmedium_flags,\r\nett_scsi_formatmedium, formatmedium_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_format, tvb, offset+1, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_ssc_rdwr10_xferlen, tvb, offset+2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+4, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_ssc_readposition (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata)\r\n{\r\ngint service_action;\r\nguint8 flags;\r\nif (!tree)\r\nreturn;\r\nif (isreq && iscdb) {\r\nservice_action = tvb_get_guint8 (tvb, offset) & 0x1F;\r\nproto_tree_add_item(tree, hf_scsi_ssc_readposition_service_action, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nif (cdata != NULL) {\r\ncdata->itlq->flags = service_action;\r\n}\r\nproto_tree_add_item(tree, hf_scsi_ssc_readposition_parameter_len, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+8, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\nelse if (!isreq) {\r\nif (cdata)\r\nservice_action = cdata->itlq->flags;\r\nelse\r\nservice_action = -1;\r\nswitch (service_action) {\r\ncase SHORT_FORM_BLOCK_ID:\r\ncase SHORT_FORM_VENDOR_SPECIFIC:\r\n{\r\nstatic const int * block_id_flags[] = {\r\n&hf_scsi_ssc_readposition_bop,\r\n&hf_scsi_ssc_readposition_eop,\r\n&hf_scsi_ssc_readposition_bcu,\r\n&hf_scsi_ssc_readposition_bycu,\r\n&hf_scsi_ssc_readposition_bpu,\r\n&hf_scsi_ssc_readposition_perr,\r\nNULL\r\n};\r\nflags = tvb_get_guint8 (tvb, offset);\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_ssc_readposition_flags,\r\nett_scsi_ssc_readposition_flags, block_id_flags, ENC_NA);\r\noffset += 1;\r\nproto_tree_add_item (tree, hf_scsi_ssc_partition, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\noffset += 2;\r\nif (!(flags & BPU)) {\r\nproto_tree_add_item(tree, hf_scsi_ssc_readposition_first_block_location, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_scsi_ssc_readposition_last_block_location, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\n} else\r\noffset += 8;\r\noffset += 1;\r\nif (!(flags & BCU)) {\r\nproto_tree_add_item(tree, hf_scsi_ssc_readposition_num_blocks_buffer, tvb, offset, 3, ENC_BIG_ENDIAN);\r\n}\r\noffset += 3;\r\nif (!(flags & BYCU)) {\r\nproto_tree_add_item(tree, hf_scsi_ssc_readposition_num_bytes_buffer, tvb, offset, 4, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nbreak;\r\ncase LONG_FORM:\r\n{\r\nstatic const int * long_form_flags[] = {\r\n&hf_scsi_ssc_readposition_bop,\r\n&hf_scsi_ssc_readposition_eop,\r\n&hf_scsi_ssc_readposition_mpu,\r\n&hf_scsi_ssc_readposition_bcu,\r\nNULL\r\n};\r\nflags = tvb_get_guint8 (tvb, offset);\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_ssc_readposition_flags,\r\nett_scsi_ssc_readposition_flags, long_form_flags, ENC_NA);\r\noffset += 1;\r\noffset += 3;\r\nif (!(flags & BPU)) {\r\nproto_tree_add_item(tree, hf_scsi_ssc_readposition_partition_number, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_scsi_ssc_readposition_block_number, tvb, offset, 8, ENC_BIG_ENDIAN);\r\noffset += 8;\r\n} else\r\noffset += 12;\r\nif (!(flags & MPU)) {\r\nproto_tree_add_item(tree, hf_scsi_ssc_readposition_file_number, tvb, offset, 8, ENC_BIG_ENDIAN);\r\noffset += 8;\r\nproto_tree_add_item(tree, hf_scsi_ssc_readposition_set_number, tvb, offset, 8, ENC_BIG_ENDIAN);\r\n} else {\r\n}\r\n}\r\nbreak;\r\ncase EXTENDED_FORM:\r\n{\r\nstatic const int * extended_form_flags[] = {\r\n&hf_scsi_ssc_readposition_bop,\r\n&hf_scsi_ssc_readposition_eop,\r\n&hf_scsi_ssc_readposition_bcu,\r\n&hf_scsi_ssc_readposition_bycu,\r\n&hf_scsi_ssc_readposition_mpu,\r\n&hf_scsi_ssc_readposition_bpu,\r\n&hf_scsi_ssc_readposition_perr,\r\nNULL\r\n};\r\nflags = tvb_get_guint8 (tvb, offset);\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_ssc_readposition_flags,\r\nett_scsi_ssc_readposition_flags, extended_form_flags, ENC_NA);\r\noffset += 1;\r\nproto_tree_add_item (tree, hf_scsi_ssc_partition, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_scsi_ssc_readposition_additional_length, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\noffset += 1;\r\nif (!(flags & BCU)) {\r\nproto_tree_add_item(tree, hf_scsi_ssc_readposition_num_blocks_buffer, tvb, offset, 3, ENC_BIG_ENDIAN);\r\n}\r\noffset += 3;\r\nif (!(flags & BPU)) {\r\nproto_tree_add_item(tree, hf_scsi_ssc_readposition_first_block_location, tvb, offset, 8, ENC_BIG_ENDIAN);\r\noffset += 8;\r\nproto_tree_add_item(tree, hf_scsi_ssc_readposition_last_block_location, tvb, offset, 8, ENC_BIG_ENDIAN);\r\noffset += 8;\r\n} else\r\noffset += 16;\r\noffset += 1;\r\nif (!(flags & BYCU)) {\r\nproto_tree_add_item(tree, hf_scsi_ssc_readposition_num_bytes_buffer, tvb, offset, 8, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\n}\r\nvoid\r\nproto_register_scsi_ssc(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_scsi_ssc_opcode,\r\n{"SSC Opcode", "scsi_ssc.opcode", FT_UINT8, BASE_HEX | BASE_EXT_STRING,\r\n&scsi_ssc_vals_ext, 0x0, NULL, HFILL}},\r\n{ &hf_scsi_ssc_rdwr6_xferlen,\r\n{"Transfer Length", "scsi_ssc.rdwr6.xferlen", FT_UINT24, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}},\r\n{ &hf_scsi_ssc_ver16_verlen,\r\n{"Verification Length", "scsi_ssc.verify16.verify_len", FT_UINT24, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}},\r\n{ &hf_scsi_ssc_locate10_loid,\r\n{"Logical Object Identifier", "scsi_ssc.locate10.loid", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}},\r\n{ &hf_scsi_ssc_locate16_loid,\r\n{"Logical Identifier", "scsi_ssc.locate16.loid", FT_UINT64, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}},\r\n{ &hf_scsi_ssc_space6_count,\r\n{"Count", "scsi_ssc.space6.count", FT_INT24, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}},\r\n{ &hf_scsi_ssc_space6_code,\r\n{"Code", "scsi_ssc.space6.code", FT_UINT8, BASE_HEX,\r\nVALS(space6_code_vals), 0x0f,\r\nNULL, HFILL}},\r\n{ &hf_scsi_ssc_space16_count,\r\n{"Count", "scsi_ssc.space16.count", FT_UINT64, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}},\r\n{ &hf_scsi_ssc_rdwr10_xferlen,\r\n{"Transfer Length", "scsi_ssc.rdwr10.xferlen", FT_UINT16, BASE_DEC, NULL,\r\n0x0, NULL, HFILL}},\r\n{ &hf_scsi_ssc_erase_flags,\r\n{"Flags", "scsi_ssc.erase_flags", FT_UINT8, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_scsi_ssc_fcs,\r\n{"FCS", "scsi_ssc.fcs", FT_BOOLEAN, 8,\r\nNULL, 0x08, NULL, HFILL}},\r\n{ &hf_scsi_ssc_lcs,\r\n{"LCS", "scsi_ssc.lcs", FT_BOOLEAN, 8,\r\nNULL, 0x04, NULL, HFILL}},\r\n{ &hf_scsi_ssc_erase_immed,\r\n{"IMMED", "scsi_ssc.erase_immed", FT_BOOLEAN, 8,\r\nNULL, 0x02, NULL, HFILL}},\r\n{ &hf_scsi_ssc_long,\r\n{"LONG", "scsi_ssc.long", FT_BOOLEAN, 8,\r\nNULL, 0x01, NULL, HFILL}},\r\n{ &hf_scsi_ssc_partition,\r\n{"Partition", "scsi_ssc.partition", FT_UINT8, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_scsi_ssc_lbi,\r\n{"Logical Block Identifier", "scsi_ssc.lbi", FT_UINT64, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_scsi_ssc_verify,\r\n{"VERIFY", "scsi_ssc.verify", FT_BOOLEAN, 8,\r\nNULL, 0x02, NULL, HFILL}},\r\n{ &hf_scsi_ssc_immed,\r\n{"IMMED", "scsi_ssc.immed", FT_BOOLEAN, 8,\r\nNULL, 0x01, NULL, HFILL}},\r\n{ &hf_scsi_ssc_formatmedium_flags,\r\n{"Flags", "scsi_ssc.formatmedium_flags", FT_UINT8, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_scsi_ssc_format,\r\n{"Format", "scsi_ssc.format", FT_UINT8, BASE_HEX,\r\nVALS(format_vals), 0x0f, NULL, HFILL}},\r\n{ &hf_scsi_ssc_loadunload_immed_flags,\r\n{"Immed", "scsi_ssc.loadunload_immed_flags", FT_UINT8, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_scsi_ssc_loadunload_flags,\r\n{"Flags", "scsi_ssc.loadunload_flags", FT_UINT8, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_scsi_ssc_hold,\r\n{"HOLD", "scsi_ssc.hold", FT_BOOLEAN, 8,\r\nNULL, 0x08, NULL, HFILL}},\r\n{ &hf_scsi_ssc_eot,\r\n{"EOT", "scsi_ssc.eot", FT_BOOLEAN, 8,\r\nNULL, 0x04, NULL, HFILL}},\r\n{ &hf_scsi_ssc_reten,\r\n{"RETEN", "scsi_ssc.reten", FT_BOOLEAN, 8,\r\nNULL, 0x02, NULL, HFILL}},\r\n{ &hf_scsi_ssc_load,\r\n{"LOAD", "scsi_ssc.load", FT_BOOLEAN, 8,\r\nNULL, 0x01, NULL, HFILL}},\r\n{ &hf_scsi_ssc_locate_flags,\r\n{"Flags", "scsi_ssc.locate_flags", FT_UINT8, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_scsi_ssc_bt,\r\n{"BT", "scsi_ssc.bt", FT_BOOLEAN, 8,\r\nNULL, 0x04, NULL, HFILL}},\r\n{ &hf_scsi_ssc_cp,\r\n{"CP", "scsi_ssc.cp", FT_BOOLEAN, 8,\r\nNULL, 0x02, NULL, HFILL}},\r\n{ &hf_scsi_ssc_dest_type,\r\n{"Dest Type", "scsi_ssc.dest_type", FT_UINT8, BASE_HEX,\r\nVALS(dest_type_vals), 0x18, NULL, HFILL}},\r\n{ &hf_scsi_ssc_bam_flags,\r\n{"Flags", "scsi_ssc.bam_flags", FT_UINT8, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_scsi_ssc_bam,\r\n{"BAM", "scsi_ssc.bam", FT_BOOLEAN, 8,\r\nNULL, 0x01, NULL, HFILL}},\r\n{ &hf_scsi_ssc_read6_flags,\r\n{"Flags", "scsi_ssc.read6_flags", FT_UINT8, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_scsi_ssc_sili,\r\n{"SILI", "scsi_ssc.sili", FT_BOOLEAN, 8,\r\nNULL, 0x02, NULL, HFILL}},\r\n{ &hf_scsi_ssc_fixed,\r\n{"FIXED", "scsi_ssc.fixed", FT_BOOLEAN, 8,\r\nNULL, 0x01, NULL, HFILL}},\r\n{ &hf_scsi_ssc_bytord,\r\n{"BYTORD", "scsi_ssc.bytord", FT_BOOLEAN, 8,\r\nNULL, 0x04, NULL, HFILL}},\r\n{ &hf_scsi_ssc_bytcmp,\r\n{"BYTCMP", "scsi_ssc.bytcmp", FT_BOOLEAN, 8,\r\nNULL, 0x02, NULL, HFILL}},\r\n{ &hf_scsi_ssc_verify16_immed,\r\n{"IMMED", "scsi_ssc.verify16_immed", FT_BOOLEAN, 8,\r\nNULL, 0x04, NULL, HFILL}},\r\n{ &hf_scsi_ssc_medium_type,\r\n{"Medium Type", "scsi_ssc.medium_type", FT_BOOLEAN, 8,\r\nNULL, 0x02, NULL, HFILL}},\r\n{ &hf_scsi_ssc_media,\r\n{"Media", "scsi_ssc.media", FT_BOOLEAN, 8,\r\nNULL, 0x01, NULL, HFILL}},\r\n{ &hf_scsi_ssc_capacity_prop_value,\r\n{"Capacity Proportion Value", "scsi_ssc.cpv", FT_UINT16, BASE_DEC,\r\nNULL, 0, NULL, HFILL}},\r\n{ &hf_scsi_ssc_readblocklimits_granularity, { "Granularity", "scsi_ssc.readblocklimits.granularity", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_scsi_ssc_readblocklimits_max_block_length_limit, { "Maximum Block Length Limit", "scsi_ssc.readblocklimits.max_block_length_limit", FT_UINT24, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_scsi_ssc_readblocklimits_min_block_length_limit, { "Minimum Block Length Limit", "scsi_ssc.readblocklimits.min_block_length_limit", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_scsi_ssc_erase6_immed, { "IMMED", "scsi_ssc.erase6.immed", FT_UINT8, BASE_DEC, NULL, 0x02, NULL, HFILL }},\r\n{ &hf_scsi_ssc_erase6_long, { "LONG", "scsi_ssc.erase6.long", FT_UINT8, BASE_DEC, NULL, 0x01, NULL, HFILL }},\r\n{ &hf_scsi_ssc_space16_parameter_len, { "Parameter Len", "scsi_ssc.space16.parameter_len", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_scsi_ssc_readposition_service_action, { "Service Action", "scsi_ssc.readposition.service_action", FT_UINT8, BASE_DEC, VALS(service_action_vals), 0x1F, NULL, HFILL }},\r\n{ &hf_scsi_ssc_readposition_parameter_len, { "Parameter Len", "scsi_ssc.readposition.parameter_len", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_scsi_ssc_readposition_flags, { "Flags", "scsi_ssc.readposition.flags", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_scsi_ssc_readposition_bop, { "BOP", "scsi_ssc.readposition.bop", FT_UINT8, BASE_DEC, NULL, 0x80, NULL, HFILL }},\r\n{ &hf_scsi_ssc_readposition_eop, { "EOP", "scsi_ssc.readposition.eop", FT_UINT8, BASE_DEC, NULL, 0x40, NULL, HFILL }},\r\n{ &hf_scsi_ssc_readposition_mpu, { "EOP", "scsi_ssc.readposition.mpu", FT_UINT8, BASE_DEC, NULL, MPU, NULL, HFILL }},\r\n{ &hf_scsi_ssc_readposition_bcu, { "BCU", "scsi_ssc.readposition.bcu", FT_UINT8, BASE_DEC, NULL, BCU, NULL, HFILL }},\r\n{ &hf_scsi_ssc_readposition_bycu, { "BYCU", "scsi_ssc.readposition.bycu", FT_UINT8, BASE_DEC, NULL, BYCU, NULL, HFILL }},\r\n{ &hf_scsi_ssc_readposition_bpu, { "BPU", "scsi_ssc.readposition.bpu", FT_UINT8, BASE_DEC, NULL, BPU, NULL, HFILL }},\r\n{ &hf_scsi_ssc_readposition_perr, { "PERR", "scsi_ssc.readposition.perr", FT_UINT8, BASE_DEC, NULL, 0x02, NULL, HFILL }},\r\n{ &hf_scsi_ssc_readposition_first_block_location, { "First Block Location", "scsi_ssc.readposition.first_block_location", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_scsi_ssc_readposition_last_block_location, { "Last Block Location", "scsi_ssc.readposition.last_block_location", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_scsi_ssc_readposition_num_blocks_buffer, { "Number of Blocks in Buffer", "scsi_ssc.readposition.num_blocks_buffer", FT_UINT24, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_scsi_ssc_readposition_num_bytes_buffer, { "Number of Bytes in Buffer", "scsi_ssc.readposition.num_bytes_buffer", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_scsi_ssc_readposition_partition_number, { "Partition Number", "scsi_ssc.readposition.partition_number", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_scsi_ssc_readposition_block_number, { "Block Number", "scsi_ssc.readposition.block_number", FT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_scsi_ssc_readposition_file_number, { "File Number", "scsi_ssc.readposition.file_number", FT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_scsi_ssc_readposition_set_number, { "Set Number", "scsi_ssc.readposition.set_number", FT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_scsi_ssc_readposition_additional_length, { "Additional Length", "scsi_ssc.readposition.additional_length", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_scsi_erase,\r\n&ett_scsi_formatmedium,\r\n&ett_scsi_loadunload_immed,\r\n&ett_scsi_loadunload,\r\n&ett_scsi_locate,\r\n&ett_scsi_bam,\r\n&ett_scsi_read6,\r\n&ett_scsi_ssc_readposition_flags\r\n};\r\nproto_scsi_ssc = proto_register_protocol("SCSI_SSC", "SCSI_SSC", "scsi_ssc");\r\nproto_register_field_array(proto_scsi_ssc, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}
