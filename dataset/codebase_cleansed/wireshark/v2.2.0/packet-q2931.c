static void\r\ndissect_q2931_shift_ie(tvbuff_t *tvb, int offset, int len,\r\nproto_tree *tree, guint8 info_element)\r\n{\r\ngboolean non_locking_shift;\r\nguint8 codeset;\r\nif (len == 0)\r\nreturn;\r\nnon_locking_shift = (info_element == Q2931_IE_BBAND_NLOCKING_SHIFT);\r\ncodeset = tvb_get_guint8(tvb, offset) & 0x07;\r\nproto_tree_add_uint_format(tree, hf_q2931_locking_codeset, tvb, offset, 1, codeset,\r\n"%s shift to codeset %u: %s",\r\n(non_locking_shift ? "Non-locking" : "Locking"),\r\ncodeset, val_to_str(codeset, q2931_codeset_vals, "Unknown (0x%02X)"));\r\n}\r\nstatic void\r\ndissect_q2931_aal_parameters_ie(tvbuff_t *tvb, packet_info* pinfo, int offset, int len,\r\nproto_tree *tree)\r\n{\r\nguint8 aal_type;\r\nguint8 identifier;\r\nguint32 value;\r\nguint32 low_mid, high_mid;\r\nproto_item* ti;\r\nif (len == 0)\r\nreturn;\r\naal_type = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_q2931_aal_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlen -= 1;\r\nif (aal_type == 0x40) {\r\nif (len > 4)\r\nlen = 4;\r\nproto_tree_add_item(tree, hf_q2931_user_defined_aal_information, tvb, offset, len, ENC_NA);\r\nreturn;\r\n}\r\nwhile (len >= 0) {\r\nidentifier = tvb_get_guint8(tvb, offset);\r\nti = proto_tree_add_item(tree, hf_q2931_aal_parameter_identifier, tvb, offset, 1, ENC_NA);\r\noffset++;\r\nlen--;\r\nswitch (identifier) {\r\ncase 0x85:\r\nif (len < 1)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_aal1_subtype, tvb, offset, 1, ENC_NA);\r\noffset++;\r\nlen--;\r\nbreak;\r\ncase 0x86:\r\nif (len < 1)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_aal1_cbr_rate, tvb, offset, 1, ENC_NA);\r\noffset++;\r\nlen--;\r\nbreak;\r\ncase 0x87:\r\nif (len < 2)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_aal1_multiplier, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nlen -= 2;\r\nbreak;\r\ncase 0x88:\r\nif (len < 1)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_aal1_source_clock_frequency_recovery_method, tvb, offset, 1, ENC_NA);\r\noffset++;\r\nlen--;\r\nbreak;\r\ncase 0x89:\r\nif (len < 1)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_aal1_error_correction_method, tvb, offset, 1, ENC_NA);\r\noffset++;\r\nlen--;\r\nbreak;\r\ncase 0x8A:\r\nif (len < 2)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_aal1_structured_data_transfer_block_size, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nlen -= 2;\r\nbreak;\r\ncase 0x8B:\r\nif (len < 1)\r\nreturn;\r\nvalue = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_uint_format_value(tree, hf_q2931_aal1_partially_filled_cells_method, tvb, offset, 1,\r\nvalue, "%u octets", value);\r\noffset++;\r\nlen--;\r\nbreak;\r\ncase 0x8C:\r\nif (len < 2)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_aal1_forward_max_cpcs_sdu_size, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nlen -= 2;\r\nbreak;\r\ncase 0x81:\r\nif (len < 2)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_aal1_backward_max_cpcs_sdu_size, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nlen -= 2;\r\nbreak;\r\ncase 0x82:\r\nif (len < 4)\r\nreturn;\r\nlow_mid = tvb_get_ntohs(tvb, offset);\r\nhigh_mid = tvb_get_ntohs(tvb, offset + 2);\r\nproto_tree_add_uint_format_value(tree, hf_q2931_midrange, tvb, offset, 4, tvb_get_ntohl(tvb, offset),\r\n"%u - %u", low_mid, high_mid);\r\noffset += 4;\r\nlen -= 4;\r\nbreak;\r\ncase 0x83:\r\nif (len < 1)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_aal1_mode, tvb, offset, 1, ENC_NA);\r\noffset++;\r\nlen--;\r\nbreak;\r\ncase 0x84:\r\nif (len < 1)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_aal1_sscs_type, tvb, offset, 1, ENC_NA);\r\noffset++;\r\nlen--;\r\nbreak;\r\ndefault:\r\nexpert_add_info(pinfo, ti, &ei_q2931_aal_parameter_identifier);\r\nreturn;\r\n}\r\n}\r\n}\r\nstatic void\r\ndissect_q2931_atm_cell_rate_ie(tvbuff_t *tvb, packet_info* pinfo, int offset, int len,\r\nproto_tree *tree)\r\n{\r\nguint8 identifier;\r\nguint32 value;\r\nproto_item* ti;\r\nwhile (len >= 0) {\r\nidentifier = tvb_get_guint8(tvb, offset);\r\nti = proto_tree_add_item(tree, hf_q2931_atm_identifier, tvb, offset, 1, ENC_NA);\r\nswitch (identifier) {\r\ncase Q2931_ATM_CR_FW_PEAK_CLP_0:\r\ncase Q2931_ATM_CR_BW_PEAK_CLP_0:\r\ncase Q2931_ATM_CR_FW_PEAK_CLP_0_1:\r\ncase Q2931_ATM_CR_BW_PEAK_CLP_0_1:\r\ncase Q2931_ATM_CR_FW_SUST_CLP_0:\r\ncase Q2931_ATM_CR_BW_SUST_CLP_0:\r\ncase Q2931_ATM_CR_FW_SUST_CLP_0_1:\r\ncase Q2931_ATM_CR_BW_SUST_CLP_0_1:\r\ncase Q2931_ATM_CR_FW_MAXB_CLP_0:\r\ncase Q2931_ATM_CR_BW_MAXB_CLP_0:\r\ncase Q2931_ATM_CR_FW_MAXB_CLP_0_1:\r\ncase Q2931_ATM_CR_BW_MAXB_CLP_0_1:\r\nif (len < 4)\r\nreturn;\r\nvalue = tvb_get_ntoh24(tvb, offset + 1);\r\nproto_tree_add_uint_format_value(tree, hf_q2931_atm_identifier_value, tvb, offset+3, 3, value,\r\n"%u cell%s/s", value, plurality(value, "", "s"));\r\noffset += 4;\r\nlen -= 4;\r\nbreak;\r\ncase Q2931_ATM_CR_BEST_EFFORT_IND:\r\noffset += 1;\r\nlen -= 1;\r\nbreak;\r\ncase Q2931_ATM_CR_TRAFFIC_MGMT_OPT:\r\nif (len < 2)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_frame_discard_forward_dir, tvb, offset + 1, 1, ENC_NA);\r\nproto_tree_add_item(tree, hf_q2931_frame_discard_backward_dir, tvb, offset + 1, 1, ENC_NA);\r\nproto_tree_add_item(tree, hf_q2931_tagging_backward_dir, tvb, offset + 1, 1, ENC_NA);\r\nproto_tree_add_item(tree, hf_q2931_tagging_forward_dir, tvb, offset + 1, 1, ENC_NA);\r\noffset += 2;\r\nlen -= 2;\r\nbreak;\r\ndefault:\r\nexpert_add_info(pinfo, ti, &ei_q2931_atm_identifier);\r\nreturn;\r\n}\r\n}\r\n}\r\nstatic void\r\ndissect_q2931_bband_bearer_cap_ie(tvbuff_t *tvb, int offset, int len,\r\nproto_tree *tree)\r\n{\r\nguint8 octet;\r\nif (len == 0)\r\nreturn;\r\noctet = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_q2931_bearer_class, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlen -= 1;\r\nif (len == 0)\r\nreturn;\r\nif (!(octet & Q2931_IE_EXTENSION)) {\r\nproto_tree_add_item(tree, hf_q2931_atm_transfer_capability, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlen -= 1;\r\n}\r\nif (len == 0)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_susceptibility_to_clipping, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_q2931_user_plane_connection_configuration, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_q2931_bband_hi_layer_info_ie(tvbuff_t *tvb, int offset, int len,\r\nproto_tree *tree)\r\n{\r\nif (len == 0)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_high_layer_information_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_q2931_bband_low_layer_info_ie(tvbuff_t *tvb, int offset, int len,\r\nproto_tree *tree)\r\n{\r\nguint8 octet;\r\nguint8 uil2_protocol;\r\nguint8 uil3_protocol;\r\nguint8 add_l3_info;\r\nguint32 organization_code;\r\nif (len == 0)\r\nreturn;\r\noctet = tvb_get_guint8(tvb, offset);\r\nif ((octet & 0x60) == 0x20) {\r\nproto_tree_add_item(tree, hf_q2931_bband_low_layer_info_user_info_l1_proto, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlen -= 1;\r\n}\r\nif (len == 0)\r\nreturn;\r\noctet = tvb_get_guint8(tvb, offset);\r\nif ((octet & 0x60) == 0x40) {\r\nuil2_protocol = octet & 0x1F;\r\nproto_tree_add_item(tree, hf_q2931_bband_low_layer_info_user_info_l2_proto, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlen -= 1;\r\nif (octet & Q2931_IE_EXTENSION)\r\ngoto l2_done;\r\nif (len == 0)\r\nreturn;\r\noctet = tvb_get_guint8(tvb, offset);\r\nif (uil2_protocol == Q2931_UIL2_USER_SPEC) {\r\nproto_tree_add_item(tree, hf_q2931_bband_low_layer_info_user_specified_l2_proto, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n} else {\r\nproto_tree_add_item(tree, hf_q2931_bband_low_layer_info_mode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\noffset += 1;\r\nlen -= 1;\r\nif (octet & Q2931_IE_EXTENSION)\r\ngoto l2_done;\r\nif (len == 0)\r\nreturn;\r\noctet = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_uint_format_value(tree, hf_q2931_bband_low_layer_info_window_size, tvb, offset, 1,\r\noctet & 0x7F, "%u k", octet & 0x7F);\r\noffset += 1;\r\nlen -= 1;\r\n}\r\nl2_done:\r\n;\r\nif (len == 0)\r\nreturn;\r\noctet = tvb_get_guint8(tvb, offset);\r\nif ((octet & 0x60) == 0x60) {\r\nuil3_protocol = octet & 0x1F;\r\nproto_tree_add_item(tree, hf_q2931_bband_low_layer_info_user_info_l3_proto, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlen -= 1;\r\nif (octet & Q2931_IE_EXTENSION)\r\ngoto l3_done;\r\nif (len == 0)\r\nreturn;\r\noctet = tvb_get_guint8(tvb, offset);\r\nswitch (uil3_protocol) {\r\ncase Q2931_UIL3_X25_PL:\r\ncase Q2931_UIL3_ISO_8208:\r\ncase Q2931_UIL3_X223:\r\nproto_tree_add_item(tree, hf_q2931_bband_low_layer_info_mode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlen -= 1;\r\nif (octet & Q2931_IE_EXTENSION)\r\ngoto l3_done;\r\nif (len == 0)\r\nreturn;\r\noctet = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_q2931_bband_low_layer_info_default_packet_size, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlen -= 1;\r\nif (octet & Q2931_IE_EXTENSION)\r\ngoto l3_done;\r\nif (len == 0)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_bband_low_layer_info_packet_window_size, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase Q2931_UIL3_USER_SPEC:\r\nproto_tree_add_uint_format_value(tree, hf_q2931_bband_low_layer_info_default_packet_size, tvb, offset, 1,\r\n1 << (octet & 0x0F), "%u octets", 1 << (octet & 0x0F));\r\nbreak;\r\ncase Q2931_UIL3_TR_9577:\r\nadd_l3_info = (octet & 0x7F) << 1;\r\nif (octet & Q2931_IE_EXTENSION)\r\ngoto l3_done;\r\nif (len < 2)\r\nreturn;\r\nadd_l3_info |= (tvb_get_guint8(tvb, offset + 1) & 0x40) >> 6;\r\nproto_tree_add_uint(tree, hf_q2931_bband_low_layer_info_additional_l3_proto, tvb, offset, 2, add_l3_info);\r\noffset += 2;\r\nlen -= 2;\r\nif (add_l3_info == NLPID_SNAP) {\r\nif (len < 6)\r\nreturn;\r\noffset += 1;\r\norganization_code = tvb_get_ntoh24(tvb, offset);\r\nproto_tree_add_item(tree, hf_q2931_organization_code, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\nswitch (organization_code) {\r\ncase OUI_ENCAP_ETHER:\r\nproto_tree_add_item(tree, hf_q2931_ethernet_type, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase OUI_ATM_FORUM:\r\nproto_tree_add_item(tree, hf_q2931_lane_protocol_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(tree, hf_q2931_protocol_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\n}\r\nbreak;\r\n}\r\n}\r\nl3_done:\r\n;\r\n}\r\nstatic void\r\ndissect_q2931_cause_ie(tvbuff_t *tvb, packet_info* pinfo, int offset, int len,\r\nproto_tree *tree)\r\n{\r\nguint8 octet;\r\nguint8 cause_value;\r\nguint8 rejection_reason;\r\nguint8 info_element;\r\nguint8 info_element_ext;\r\nguint16 info_element_len;\r\nif (len == 0)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_cause_location, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlen -= 1;\r\nif (len == 0)\r\nreturn;\r\noctet = tvb_get_guint8(tvb, offset);\r\ncause_value = octet & 0x7F;\r\nproto_tree_add_item(tree, hf_q2931_cause_value, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlen -= 1;\r\nif (len == 0)\r\nreturn;\r\nswitch (cause_value) {\r\ncase Q2931_CAUSE_UNALLOC_NUMBER:\r\ncase Q2931_CAUSE_NO_ROUTE_TO_DEST:\r\ncase Q2931_CAUSE_QOS_UNAVAILABLE:\r\nproto_tree_add_item(tree, hf_q2931_cause_network_service, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(tree, hf_q2931_cause_network_behavior, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(tree, hf_q2931_cause_rejection_condition, tvb, offset, 1, ENC_NA);\r\nbreak;\r\ncase Q2931_CAUSE_CALL_REJECTED:\r\nrejection_reason = octet & 0x7C;\r\nproto_tree_add_item(tree, hf_q2931_cause_rejection_reason, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_q2931_cause_rejection_condition, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlen -= 1;\r\nif (len == 0)\r\nreturn;\r\nswitch (rejection_reason) {\r\ncase Q2931_REJ_USER_SPECIFIC:\r\nproto_tree_add_item(tree, hf_q2931_cause_rejection_user_specific_diagnostic, tvb, offset, len, ENC_NA);\r\nbreak;\r\ncase Q2931_REJ_IE_MISSING:\r\nproto_tree_add_item(tree, hf_q2931_cause_rejection_missing_information_element, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase Q2931_REJ_IE_INSUFFICIENT:\r\nproto_tree_add_item(tree, hf_q2931_cause_rejection_insufficient_information_element, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(tree, hf_q2931_cause_rejection_diagnostic, tvb, offset, len, ENC_NA);\r\nbreak;\r\n}\r\nbreak;\r\ncase Q2931_CAUSE_NUMBER_CHANGED:\r\ninfo_element = tvb_get_guint8(tvb, offset);\r\ninfo_element_ext = tvb_get_guint8(tvb, offset + 1);\r\ninfo_element_len = tvb_get_ntohs(tvb, offset + 2);\r\ndissect_q2931_ie(tvb, pinfo, offset, info_element_len, tree,\r\ninfo_element, info_element_ext);\r\nbreak;\r\ncase Q2931_CAUSE_ACCESS_INFO_DISC:\r\ncase Q2931_CAUSE_INCOMPATIBLE_DEST:\r\ncase Q2931_CAUSE_MAND_IE_MISSING:\r\ncase Q2931_CAUSE_IE_NONEX_OR_UNIMPL:\r\ncase Q2931_CAUSE_INVALID_IE_CONTENTS:\r\ndo {\r\nproto_tree_add_item(tree, hf_q2931_cause_information_element, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlen -= 1;\r\n} while (len >= 0);\r\nbreak;\r\ncase Q2931_CAUSE_CELL_RATE_UNAVAIL:\r\ndo {\r\nproto_tree_add_item(tree, hf_q2931_cause_cell_rate_subfield_identifier, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlen -= 1;\r\n} while (len >= 0);\r\nbreak;\r\ncase Q2931_CAUSE_CHAN_NONEXISTENT:\r\nif (len < 2)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_cause_vpci, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nlen -= 2;\r\nif (len < 2)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_cause_vci, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase Q2931_CAUSE_MT_NONEX_OR_UNIMPL:\r\ncase Q2931_CAUSE_MSG_INCOMPAT_W_CS:\r\nproto_tree_add_item(tree, hf_q2931_cause_message_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase Q2931_CAUSE_REC_TIMER_EXP:\r\nif (len < 3)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_cause_timer, tvb, offset, 3, ENC_ASCII|ENC_NA);\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(tree, hf_q2931_cause_rejection_diagnostic, tvb, offset, len, ENC_NA);\r\n}\r\n}\r\nstatic void\r\ndissect_q2931_call_state_ie(tvbuff_t *tvb, int offset, int len,\r\nproto_tree *tree)\r\n{\r\nif (len == 0)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_call_state, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_q2931_number_ie(tvbuff_t *tvb, packet_info* pinfo, int offset, int len,\r\nproto_tree *tree)\r\n{\r\nguint8 octet;\r\nguint8 numbering_plan;\r\nproto_tree *nsap_tree;\r\nif (len == 0)\r\nreturn;\r\noctet = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_q2931_number_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nnumbering_plan = octet & 0x0F;\r\nproto_tree_add_item(tree, hf_q2931_number_plan, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlen -= 1;\r\nif (!(octet & Q2931_IE_EXTENSION)) {\r\nif (len == 0)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_number_presentation_indicator, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_q2931_number_screening_indicator, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlen -= 1;\r\n}\r\nif (len == 0)\r\nreturn;\r\nswitch (numbering_plan) {\r\ncase Q2931_ISDN_NUMBERING:\r\nproto_tree_add_item(tree, hf_q2931_number_string, tvb, offset, len, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase Q2931_NSAP_ADDRESSING:\r\nif (len < 20) {\r\nproto_tree_add_item(tree, hf_q2931_nsap_address_number_short, tvb, offset, len, ENC_NA);\r\nreturn;\r\n}\r\nnsap_tree = proto_tree_add_subtree(tree, tvb, offset, len, ett_q2931_nsap, NULL, "Number");\r\ndissect_atm_nsap(tvb, pinfo, offset, len, nsap_tree);\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(tree, hf_q2931_number_bytes, tvb, offset, len, ENC_NA);\r\nbreak;\r\n}\r\n}\r\nstatic void\r\ndissect_q2931_party_subaddr_ie(tvbuff_t *tvb, int offset, int len,\r\nproto_tree *tree)\r\n{\r\nif (len == 0)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_party_subaddr_type_of_subaddress, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_q2931_party_subaddr_odd_even_indicator, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlen -= 1;\r\nif (len == 0)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_party_subaddr_subaddress, tvb, offset, len, ENC_NA);\r\n}\r\nstatic void\r\ndissect_q2931_connection_identifier_ie(tvbuff_t *tvb, int offset, int len,\r\nproto_tree *tree)\r\n{\r\nif (len == 0)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_conn_id_vp_associated_signalling, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_q2931_conn_id_preferred_exclusive, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlen -= 1;\r\nif (len < 2)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_conn_id_vpci, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nlen -= 2;\r\nif (len < 2)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_conn_id_vci, tvb, offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_q2931_e2e_transit_delay_ie(tvbuff_t *tvb, packet_info* pinfo, int offset, int len, proto_tree *tree)\r\n{\r\nguint8 identifier;\r\nguint16 value;\r\nproto_item* ti;\r\nwhile (len >= 3) {\r\nti = proto_tree_add_item(tree, hf_q2931_e2e_transit_delay_identifier, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nidentifier = tvb_get_guint8(tvb, offset);\r\noffset++;\r\nvalue = tvb_get_ntohs(tvb, offset);\r\nlen -=3;\r\nswitch (identifier) {\r\ncase 0x01:\r\nproto_tree_add_uint_format_value(tree, hf_q2931_e2e_transit_delay_cumulative, tvb, offset, 2,\r\nvalue, "%u ms", value);\r\nbreak;\r\ncase 0x03:\r\nif (value == 0xFFFF) {\r\nproto_tree_add_uint_format_value(tree, hf_q2931_e2e_transit_delay_maximum_end_to_end, tvb, offset, 2,\r\nvalue, "Any end-to-end transit delay value acceptable");\r\n} else {\r\nproto_tree_add_uint_format_value(tree, hf_q2931_e2e_transit_delay_maximum_end_to_end, tvb, offset, 2,\r\nvalue, "%u ms", value);\r\n}\r\nbreak;\r\ndefault:\r\nexpert_add_info(pinfo, ti, &ei_q2931_e2e_transit_delay_identifier);\r\nreturn;\r\n}\r\n}\r\n}\r\nstatic void\r\ndissect_q2931_qos_parameter_ie(tvbuff_t *tvb, int offset, int len,\r\nproto_tree *tree)\r\n{\r\nif (len == 0)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_qos_class_forward, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlen -= 1;\r\nif (len == 0)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_qos_class_backward, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_q2931_bband_rpt_indicator(tvbuff_t *tvb, int offset, int len,\r\nproto_tree *tree)\r\n{\r\nif (len == 0)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_broadband_repeat_indicator, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_q2931_restart_indicator(tvbuff_t *tvb, int offset, int len,\r\nproto_tree *tree)\r\n{\r\nif (len == 0)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_restart_indicator, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_q2931_bband_sending_compl_ie(tvbuff_t *tvb, packet_info* pinfo, int offset, int len,\r\nproto_tree *tree)\r\n{\r\nguint8 identifier;\r\nproto_item* ti;\r\nwhile (len >= 0) {\r\nti = proto_tree_add_item(tree, hf_q2931_bband_sending_complete_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nidentifier = tvb_get_guint8(tvb, offset);\r\nswitch (identifier) {\r\ncase 0xA1:\r\nproto_tree_add_item(tree, hf_q2931_bband_sending_complete, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\nlen -= 1;\r\nbreak;\r\ndefault:\r\nexpert_add_info(pinfo, ti, &ei_q2931_bband_sending_complete_id);\r\nreturn;\r\n}\r\n}\r\n}\r\nstatic void\r\ndissect_q2931_transit_network_sel_ie(tvbuff_t *tvb, int offset, int len,\r\nproto_tree *tree)\r\n{\r\nif (len == 0)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_transit_network_sel_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_q2931_transit_network_sel_plan, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlen -= 1;\r\nif (len == 0)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_transit_network_sel_network_id, tvb, offset, len, ENC_NA|ENC_ASCII);\r\n}\r\nstatic void\r\ndissect_q2931_oam_traffic_descriptor_ie(tvbuff_t *tvb, int offset, int len,\r\nproto_tree *tree)\r\n{\r\nif (len == 0)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_oam_traffic_descriptor_shaping_indicator, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_q2931_oam_end_to_end_f5_flow, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_q2931_oam_traffic_descriptor_management_indicator, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlen -= 1;\r\nif (len == 0)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_oam_traffic_descriptor_forward_f5_flow_indicator, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_q2931_oam_traffic_descriptor_backward_f5_flow_indicator, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_q2931_endpoint_reference_ie(tvbuff_t *tvb, int offset, int len,\r\nproto_tree *tree)\r\n{\r\nif (len == 0)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_endpoint_reference_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nlen -= 1;\r\nif (len < 2)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_endpoint_reference_flag, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_q2931_endpoint_reference_identifier_value, tvb, offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_q2931_endpoint_state_ie(tvbuff_t *tvb, int offset, int len,\r\nproto_tree *tree)\r\n{\r\nif (len == 0)\r\nreturn;\r\nproto_tree_add_item(tree, hf_q2931_endpoint_state, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_q2931_ie_contents(tvbuff_t *tvb, packet_info* pinfo, int offset, int len,\r\nproto_tree *tree, guint8 info_element)\r\n{\r\nswitch (info_element) {\r\ncase Q2931_IE_BBAND_LOCKING_SHIFT:\r\ncase Q2931_IE_BBAND_NLOCKING_SHIFT:\r\ndissect_q2931_shift_ie(tvb, offset, len, tree, info_element);\r\nbreak;\r\ncase Q2931_IE_NBAND_BEARER_CAP:\r\ncase Q2931_IE_NBAND_LOW_LAYER_COMPAT:\r\ndissect_q931_bearer_capability_ie(tvb, offset, len, tree);\r\nbreak;\r\ncase Q2931_IE_NBAND_HIGH_LAYER_COMPAT:\r\ndissect_q931_high_layer_compat_ie(tvb, offset, len, tree);\r\nbreak;\r\ncase Q2931_IE_PROGRESS_INDICATOR:\r\ndissect_q931_progress_indicator_ie(tvb, offset, len, tree);\r\nbreak;\r\ncase Q2931_IE_AAL_PARAMETERS:\r\ndissect_q2931_aal_parameters_ie(tvb, pinfo, offset, len, tree);\r\nbreak;\r\ncase Q2931_IE_ATM_USER_CELL_RATE:\r\ndissect_q2931_atm_cell_rate_ie(tvb, pinfo, offset, len, tree);\r\nbreak;\r\ncase Q2931_IE_BBAND_BEARER_CAP:\r\ndissect_q2931_bband_bearer_cap_ie(tvb, offset, len, tree);\r\nbreak;\r\ncase Q2931_IE_BBAND_HI_LAYER_INFO:\r\ndissect_q2931_bband_hi_layer_info_ie(tvb, offset, len, tree);\r\nbreak;\r\ncase Q2931_IE_BBAND_LOW_LAYER_INFO:\r\ndissect_q2931_bband_low_layer_info_ie(tvb, offset, len, tree);\r\nbreak;\r\ncase Q2931_IE_CALL_STATE:\r\ndissect_q2931_call_state_ie(tvb, offset, len, tree);\r\nbreak;\r\ncase Q2931_IE_CALLED_PARTY_NUMBER:\r\ncase Q2931_IE_CALLING_PARTY_NUMBER:\r\ndissect_q2931_number_ie(tvb, pinfo, offset, len, tree);\r\nbreak;\r\ncase Q2931_IE_CALLED_PARTY_SUBADDR:\r\ncase Q2931_IE_CALLING_PARTY_SUBADDR:\r\ndissect_q2931_party_subaddr_ie(tvb, offset, len, tree);\r\nbreak;\r\ncase Q2931_IE_CAUSE:\r\ndissect_q2931_cause_ie(tvb, pinfo, offset, len, tree);\r\nbreak;\r\ncase Q2931_IE_CONNECTION_IDENTIFIER:\r\ndissect_q2931_connection_identifier_ie(tvb, offset, len, tree);\r\nbreak;\r\ncase Q2931_IE_E2E_TRANSIT_DELAY:\r\ndissect_q2931_e2e_transit_delay_ie(tvb, pinfo, offset, len, tree);\r\nbreak;\r\ncase Q2931_IE_QOS_PARAMETER:\r\ndissect_q2931_qos_parameter_ie(tvb, offset, len, tree);\r\nbreak;\r\ncase Q2931_IE_BBAND_RPT_INDICATOR:\r\ndissect_q2931_bband_rpt_indicator(tvb, offset, len, tree);\r\nbreak;\r\ncase Q2931_IE_RESTART_INDICATOR:\r\ndissect_q2931_restart_indicator(tvb, offset, len, tree);\r\nbreak;\r\ncase Q2931_IE_BBAND_SENDING_COMPL:\r\ndissect_q2931_bband_sending_compl_ie(tvb, pinfo, offset, len, tree);\r\nbreak;\r\ncase Q2931_IE_TRANSIT_NETWORK_SEL:\r\ndissect_q2931_transit_network_sel_ie(tvb, offset, len, tree);\r\nbreak;\r\ncase Q2931_IE_OAM_TRAFFIC_DESCRIPTOR:\r\ndissect_q2931_oam_traffic_descriptor_ie(tvb, offset, len, tree);\r\nbreak;\r\ncase Q2931_IE_ENDPOINT_REFERENCE:\r\ndissect_q2931_endpoint_reference_ie(tvb, offset, len, tree);\r\nbreak;\r\ncase Q2931_IE_ENDPOINT_STATE:\r\ndissect_q2931_endpoint_state_ie(tvb, offset, len, tree);\r\nbreak;\r\n}\r\n}\r\nstatic void\r\ndissect_q2931_ie(tvbuff_t *tvb, packet_info* pinfo, int offset, int len, proto_tree *tree,\r\nguint8 info_element, guint8 info_element_ext)\r\n{\r\nproto_item *ti;\r\nproto_tree *ie_tree;\r\nproto_tree *ie_ext_tree;\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, 1+1+2+len, ett_q2931_ie, NULL,\r\nval_to_str_ext(info_element, &q2931_info_element_vals_ext,\r\n"Unknown information element (0x%02X)"));\r\nproto_tree_add_uint(ie_tree, hf_q2931_information_element, tvb, offset, 1, info_element);\r\nti = proto_tree_add_uint(ie_tree, hf_q2931_information_element_extension, tvb, offset + 1, 1, info_element_ext);\r\nie_ext_tree = proto_item_add_subtree(ti, ett_q2931_ie_ext);\r\nproto_tree_add_item(ie_ext_tree, hf_q2931_ie_coding_standard, tvb, offset+1, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_ext_tree, hf_q2931_ie_handling_instructions, tvb, offset+1, 1, ENC_BIG_ENDIAN);\r\nif (info_element_ext & Q2931_IE_COMPAT_FOLLOW_INST) {\r\nproto_tree_add_item(ie_ext_tree, hf_q2931_ie_action_indicator, tvb, offset+1, 1, ENC_BIG_ENDIAN);\r\n}\r\nproto_tree_add_uint(ie_tree, hf_q2931_information_element_length, tvb, offset + 2, 2, len);\r\nif ((info_element_ext & Q2931_IE_COMPAT_CODING_STD)\r\n== Q2931_ITU_STANDARDIZED_CODING) {\r\ndissect_q2931_ie_contents(tvb, pinfo, offset + 4,\r\nlen, ie_tree, info_element);\r\n} else {\r\nproto_tree_add_item(ie_tree, hf_q2931_information_element_data, tvb, offset + 4, len, ENC_NA);\r\n}\r\n}\r\nstatic int\r\ndissect_q2931(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\nproto_tree *q2931_tree = NULL;\r\nproto_item *ti;\r\nguint8 call_ref_len;\r\nguint8 call_ref[16];\r\nguint8 message_type;\r\nguint8 message_type_ext;\r\nguint16 message_len;\r\nguint8 info_element;\r\nguint8 info_element_ext;\r\nguint16 info_element_len;\r\n#if 0\r\nint codeset;\r\ngboolean non_locking_shift;\r\n#endif\r\nstatic const int * ext_flags[] = {\r\n&hf_q2931_message_flag,\r\nNULL\r\n};\r\nstatic const int * ext_flags_follow_inst[] = {\r\n&hf_q2931_message_flag,\r\n&hf_q2931_message_action_indicator,\r\nNULL\r\n};\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "Q.2931");\r\nif (tree) {\r\nti = proto_tree_add_item(tree, proto_q2931, tvb, offset, -1,\r\nENC_NA);\r\nq2931_tree = proto_item_add_subtree(ti, ett_q2931);\r\nproto_tree_add_uint(q2931_tree, hf_q2931_discriminator, tvb, offset, 1, tvb_get_guint8(tvb, offset));\r\n}\r\noffset += 1;\r\ncall_ref_len = tvb_get_guint8(tvb, offset) & 0xF;\r\nif (q2931_tree != NULL)\r\nproto_tree_add_uint(q2931_tree, hf_q2931_call_ref_len, tvb, offset, 1, call_ref_len);\r\noffset += 1;\r\nif (call_ref_len != 0) {\r\ntvb_memcpy(tvb, call_ref, offset, call_ref_len);\r\nproto_tree_add_boolean(q2931_tree, hf_q2931_call_ref_flag,\r\ntvb, offset, 1, (call_ref[0] & 0x80) != 0);\r\ncall_ref[0] &= 0x7F;\r\nproto_tree_add_bytes(q2931_tree, hf_q2931_call_ref, tvb, offset, call_ref_len, call_ref);\r\noffset += call_ref_len;\r\n}\r\nmessage_type = tvb_get_guint8(tvb, offset);\r\ncol_add_str(pinfo->cinfo, COL_INFO,\r\nval_to_str_ext(message_type, &q2931_message_type_vals_ext,\r\n"Unknown message type (0x%02X)"));\r\nproto_tree_add_uint(q2931_tree, hf_q2931_message_type, tvb, offset, 1, message_type);\r\noffset += 1;\r\nmessage_type_ext = tvb_get_guint8(tvb, offset);\r\nif (message_type_ext & Q2931_MSG_TYPE_EXT_FOLLOW_INST) {\r\nproto_tree_add_bitmask(q2931_tree, tvb, offset, hf_q2931_message_type_ext, ett_q2931_ext, ext_flags_follow_inst, ENC_NA);\r\n} else {\r\nproto_tree_add_bitmask(q2931_tree, tvb, offset, hf_q2931_message_type_ext, ett_q2931_ext, ext_flags, ENC_NA);\r\n}\r\noffset += 1;\r\nmessage_len = tvb_get_ntohs(tvb, offset);\r\nif (q2931_tree != NULL)\r\nproto_tree_add_uint(q2931_tree, hf_q2931_message_len, tvb, offset, 2, message_len);\r\noffset += 2;\r\n#if 0\r\ncodeset = 0;\r\nnon_locking_shift = TRUE;\r\n#endif\r\nwhile (tvb_reported_length_remaining(tvb, offset) > 0) {\r\ninfo_element = tvb_get_guint8(tvb, offset);\r\ninfo_element_ext = tvb_get_guint8(tvb, offset + 1);\r\ninfo_element_len = tvb_get_ntohs(tvb, offset + 2);\r\nif (q2931_tree != NULL) {\r\ndissect_q2931_ie(tvb, pinfo, offset, info_element_len,\r\nq2931_tree, info_element, info_element_ext);\r\n}\r\n#if 0\r\nif (non_locking_shift)\r\ncodeset = 0;\r\nswitch (info_element) {\r\ncase Q2931_IE_BBAND_LOCKING_SHIFT:\r\nif (info_element_len >= 1) {\r\nnon_locking_shift = FALSE;\r\ncodeset = tvb_get_guint8(tvb, offset + 4) & 0x07;\r\n}\r\nbreak;\r\ncase Q2931_IE_BBAND_NLOCKING_SHIFT:\r\nif (info_element_len >= 1) {\r\nnon_locking_shift = TRUE;\r\ncodeset = tvb_get_guint8(tvb, offset + 4) & 0x07;\r\n}\r\nbreak;\r\n}\r\n#endif\r\noffset += 1 + 1 + 2 + info_element_len;\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_q2931(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_q2931_discriminator,\r\n{ "Protocol discriminator", "q2931.disc",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_call_ref_len,\r\n{ "Call reference value length", "q2931.call_ref_len",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_call_ref_flag,\r\n{ "Call reference flag", "q2931.call_ref_flag",\r\nFT_BOOLEAN, BASE_NONE, TFS(&tfs_call_ref_flag), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_call_ref,\r\n{ "Call reference value", "q2931.call_ref",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_message_type,\r\n{ "Message type", "q2931.message_type",\r\nFT_UINT8, BASE_HEX|BASE_EXT_STRING, &q2931_message_type_vals_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_message_type_ext,\r\n{ "Message type extension", "q2931.message_type_ext",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_message_flag,\r\n{ "Flag", "q2931.message_flag",\r\nFT_BOOLEAN, 8, TFS(&tos_msg_flag), Q2931_MSG_TYPE_EXT_FOLLOW_INST,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_message_action_indicator,\r\n{ "Action indicator", "q2931.message_action_indicator",\r\nFT_UINT8, BASE_DEC, VALS(msg_action_ind_vals), Q2931_MSG_TYPE_EXT_ACTION_IND,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_message_len,\r\n{ "Message length", "q2931.message_len",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_ie_handling_instructions,\r\n{ "Handling Instructions", "q2931.ie_handling_instructions",\r\nFT_BOOLEAN, 8, TFS(&tfs_q2931_handling_instructions), Q2931_IE_COMPAT_FOLLOW_INST,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_ie_coding_standard,\r\n{ "Coding standard", "q2931.ie_coding_standard",\r\nFT_UINT8, BASE_DEC, VALS(coding_std_vals), Q2931_IE_COMPAT_CODING_STD,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_ie_action_indicator,\r\n{ "Action indicator", "q2931.ie_action_indicator",\r\nFT_UINT8, BASE_DEC, VALS(ie_action_ind_vals), Q2931_IE_COMPAT_ACTION_IND,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_aal_type,\r\n{ "AAL type", "q2931.aal_type",\r\nFT_UINT8, BASE_HEX, VALS(q9231_aal_type_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_user_defined_aal_information,\r\n{ "User defined AAL information", "q2931.user_defined_aal_information",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_aal1_subtype,\r\n{ "Subtype", "q2931.aal1.subtype",\r\nFT_UINT8, BASE_HEX, VALS(q9231_aal1_subtype_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_aal1_cbr_rate,\r\n{ "CBR rate", "q2931.aal1.cbr_rate",\r\nFT_UINT8, BASE_HEX, VALS(q9231_aal1_cbr_rate_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_aal1_multiplier,\r\n{ "Multiplier", "q2931.aal1.multiplier",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_aal1_source_clock_frequency_recovery_method,\r\n{ "Source clock frequency recovery method", "q2931.aal1.source_clock_frequency_recovery_method",\r\nFT_UINT8, BASE_HEX, VALS(q2931_aal1_src_clk_rec_meth_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_aal1_error_correction_method,\r\n{ "Error correction method", "q2931.aal1.error_correction_method",\r\nFT_UINT8, BASE_HEX, VALS(q2931_aal1_err_correction_method_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_aal1_structured_data_transfer_block_size,\r\n{ "Structured data transfer block size", "q2931.aal1.structured_data_transfer_block_size",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_aal1_partially_filled_cells_method,\r\n{ "Partially filled cells method", "q2931.aal1.partially_filled_cells_method",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_aal1_forward_max_cpcs_sdu_size,\r\n{ "Forward maximum CPCS-SDU size", "q2931.aal1.forward_max_cpcs_sdu_size",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_aal1_backward_max_cpcs_sdu_size,\r\n{ "Backward maximum CPCS-SDU size", "q2931.aal1.backward_max_cpcs_sdu_size",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_aal1_mode,\r\n{ "Mode", "q2931.aal1.mode",\r\nFT_UINT8, BASE_HEX, VALS(q2931_aal_mode_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_aal1_sscs_type,\r\n{ "SSCS type", "q2931.aal1.sscs_type",\r\nFT_UINT8, BASE_HEX, VALS(q2931_sscs_type_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_bearer_class,\r\n{ "Bearer class", "q2931.bearer_class",\r\nFT_UINT8, BASE_HEX, VALS(q2931_bearer_class_vals), 0x1F,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_atm_transfer_capability,\r\n{ "ATM Transfer Capability", "q2931.atm_transfer_capability",\r\nFT_UINT8, BASE_HEX, VALS(q2931_transfer_capability_vals), 0x1F,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_susceptibility_to_clipping,\r\n{ "Susceptibility to clipping", "q2931.susceptibility_to_clipping",\r\nFT_UINT8, BASE_HEX, VALS(q2931_susc_clip_vals), 0x60,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_user_plane_connection_configuration,\r\n{ "User-plane connection configuration", "q2931.user_plane_connection_configuration",\r\nFT_UINT8, BASE_HEX, VALS(q2931_up_conn_config_vals), 0x03,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_high_layer_information_type,\r\n{ "High layer information type", "q2931.high_layer_information_type",\r\nFT_UINT8, BASE_HEX, VALS(q2931_hi_layer_info_type_vals), 0x7F,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_bband_low_layer_info_user_info_l1_proto,\r\n{ "User information layer 1 protocol", "q2931.bband_low_layer_info.user_info_l1_proto",\r\nFT_UINT8, BASE_HEX, NULL, 0x1F,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_bband_low_layer_info_user_info_l2_proto,\r\n{ "User information layer 2 protocol", "q2931.bband_low_layer_info.user_info_l2_proto",\r\nFT_UINT8, BASE_HEX, VALS(q2931_uil2_vals), 0x1F,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_bband_low_layer_info_user_specified_l2_proto,\r\n{ "User-specified layer 2 protocol information", "q2931.bband_low_layer_info.user_specified_l2_proto",\r\nFT_UINT8, BASE_HEX, NULL, 0x7F,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_bband_low_layer_info_mode,\r\n{ "Mode", "q2931.bband_low_layer_info.mode",\r\nFT_UINT8, BASE_HEX, VALS(q2931_mode_vals), 0x60,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_bband_low_layer_info_window_size,\r\n{ "Window size", "q2931.bband_low_layer_info.window_size",\r\nFT_UINT8, BASE_DEC, NULL, 0x7F,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_bband_low_layer_info_user_info_l3_proto,\r\n{ "User information layer 3 protocol", "q2931.bband_low_layer_info.user_info_l3_proto",\r\nFT_UINT8, BASE_HEX, VALS(q2931_uil3_vals), 0x1F,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_bband_low_layer_info_default_packet_size,\r\n{ "Default packet size", "q2931.bband_low_layer_info.default_packet_size",\r\nFT_UINT8, BASE_DEC, NULL, 0x0F,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_bband_low_layer_info_packet_window_size,\r\n{ "Packet window size", "q2931.bband_low_layer_info.packet_window_size",\r\nFT_UINT8, BASE_DEC, NULL, 0x7F,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_bband_low_layer_info_additional_l3_proto,\r\n{ "Additional layer 3 protocol information", "q2931.bband_low_layer_info.additional_l3_proto",\r\nFT_UINT8, BASE_HEX, VALS(nlpid_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_organization_code,\r\n{ "Organization Code", "q2931.bband_low_layer_info.organization_code",\r\nFT_UINT24, BASE_HEX, VALS(oui_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_ethernet_type,\r\n{ "Ethernet type", "q2931.bband_low_layer_info.ethernet_type",\r\nFT_UINT16, BASE_HEX, VALS(etype_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_lane_protocol_id,\r\n{ "LANE Protocol ID", "q2931.bband_low_layer_info.lane_protocol_id",\r\nFT_UINT16, BASE_HEX, VALS(lane_pid_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_protocol_id,\r\n{ "Protocol ID", "q2931.bband_low_layer_info.protocol_id",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_cause_location,\r\n{ "Location", "q2931.cause.location",\r\nFT_UINT8, BASE_HEX, VALS(q2931_cause_location_vals), 0x0F,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_cause_value,\r\n{ "Cause value", "q2931.cause.value",\r\nFT_UINT8, BASE_HEX|BASE_EXT_STRING, &q2931_cause_code_vals_ext, 0x7F,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_cause_rejection_reason,\r\n{ "Rejection reason", "q2931.cause.rejection.reason",\r\nFT_UINT8, BASE_HEX, VALS(q2931_rejection_reason_vals), 0x7C,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_cause_rejection_condition,\r\n{ "Condition", "q2931.cause.rejection.condition",\r\nFT_UINT8, BASE_HEX, VALS(q2931_cause_condition_vals), 0x03,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_cause_rejection_user_specific_diagnostic,\r\n{ "User specific diagnostic", "q2931.cause.rejection.user_specific_diagnostic",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_cause_rejection_missing_information_element,\r\n{ "Missing information element", "q2931.cause.rejection.missing_information_element",\r\nFT_UINT8, BASE_HEX|BASE_EXT_STRING, &q2931_info_element_vals_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_cause_rejection_insufficient_information_element,\r\n{ "Insufficient information element", "q2931.cause.rejection.insufficient_information_element",\r\nFT_UINT8, BASE_HEX|BASE_EXT_STRING, &q2931_info_element_vals_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_cause_rejection_diagnostic,\r\n{ "Diagnostic", "q2931.cause.rejection.diagnostic",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_cause_information_element,\r\n{ "Information element", "q2931.cause.information_element",\r\nFT_UINT8, BASE_HEX|BASE_EXT_STRING, &q2931_info_element_vals_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_cause_cell_rate_subfield_identifier,\r\n{ "Cell rate subfield identifier", "q2931.cause.cell_rate_subfield_identifier",\r\nFT_UINT8, BASE_HEX, VALS(q2931_atm_td_subfield_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_cause_vpci,\r\n{ "VPCI", "q2931.cause.vpci",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_cause_vci,\r\n{ "VCI", "q2931.cause.vci",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_cause_message_type,\r\n{ "Message type", "q2931.cause.message_type",\r\nFT_UINT8, BASE_HEX|BASE_EXT_STRING, &q2931_message_type_vals_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_cause_timer,\r\n{ "Timer", "q2931.cause.timer",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_call_state,\r\n{ "Call state", "q2931.call_state",\r\nFT_UINT8, BASE_HEX, VALS(q2931_call_state_vals), 0x3F,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_number_type,\r\n{ "Type of number", "q2931.number.type",\r\nFT_UINT8, BASE_HEX, VALS(q2931_number_type_vals), 0x70,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_number_plan,\r\n{ "Numbering plan", "q2931.number.plan",\r\nFT_UINT8, BASE_HEX, VALS(q2931_numbering_plan_vals), 0x0F,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_number_presentation_indicator,\r\n{ "Presentation indicator", "q2931.number.presentation_indicator",\r\nFT_UINT8, BASE_HEX, VALS(q2931_presentation_indicator_vals), 0x60,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_number_screening_indicator,\r\n{ "Screening indicator", "q2931.number.screening_indicator",\r\nFT_UINT8, BASE_HEX, VALS(q2931_screening_indicator_vals), 0x03,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_number_string,\r\n{ "Number", "q2931.number.string",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_number_bytes,\r\n{ "Number", "q2931.number.bytes",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_party_subaddr_type_of_subaddress,\r\n{ "Type of subaddress", "q2931.party_subaddr.type_of_subaddress",\r\nFT_UINT8, BASE_HEX, VALS(q2931_subaddress_type_vals), 0x70,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_party_subaddr_odd_even_indicator,\r\n{ "Odd/even indicator", "q2931.party_subaddr.odd_even_indicator",\r\nFT_UINT8, BASE_HEX, VALS(q2931_odd_even_indicator_vals), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_party_subaddr_subaddress,\r\n{ "Subaddress", "q2931.party_subaddr.subaddress",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_conn_id_vp_associated_signalling,\r\n{ "VP-associated signalling", "q2931.conn_id.vp_associated_signalling",\r\nFT_UINT8, BASE_HEX, VALS(q2931_vp_associated_signalling_vals), 0x18,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_conn_id_preferred_exclusive,\r\n{ "Preferred/exclusive", "q2931.conn_id.preferred_exclusive",\r\nFT_UINT8, BASE_HEX, VALS(q2931_preferred_exclusive_vals), 0x07,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_conn_id_vpci,\r\n{ "VPCI", "q2931.conn_id.vpci",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_conn_id_vci,\r\n{ "VCI", "q2931.conn_id.vci",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_e2e_transit_delay_cumulative,\r\n{ "Cumulative transit delay", "q2931.e2e_transit_delay.cumulative",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_e2e_transit_delay_maximum_end_to_end,\r\n{ "Maximum end-to-end transit delay", "q2931.e2e_transit_delay.maximum_end_to_end",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_qos_class_forward,\r\n{ "QOS class forward", "q2931.qos_class_forward",\r\nFT_UINT8, BASE_HEX, VALS(q2931_qos_parameter_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_qos_class_backward,\r\n{ "QOS class backward", "q2931.qos_class_backward",\r\nFT_UINT8, BASE_HEX, VALS(q2931_qos_parameter_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_broadband_repeat_indicator,\r\n{ "Broadband repeat indicator", "q2931.broadband_repeat_indicator",\r\nFT_UINT8, BASE_HEX, VALS(q2931_bband_rpt_indicator_vals), 0x0F,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_restart_indicator,\r\n{ "Restart indicator", "q2931.restart_indicator",\r\nFT_UINT8, BASE_HEX, VALS(q2931_class_vals), 0x07,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_transit_network_sel_type,\r\n{ "Type of network identification", "q2931.transit_network_sel.type",\r\nFT_UINT8, BASE_HEX, VALS(q2931_netid_type_vals), 0x70,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_transit_network_sel_plan,\r\n{ "Network identification plan", "q2931.transit_network_sel.plan",\r\nFT_UINT8, BASE_HEX, VALS(q2931_netid_plan_vals), 0x0F,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_transit_network_sel_network_id,\r\n{ "Network identification", "q2931.transit_network_sel.network_identification",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_oam_traffic_descriptor_shaping_indicator,\r\n{ "Shaping indicator", "q2931.oam_traffic_descriptor.shaping_indicator",\r\nFT_UINT8, BASE_HEX, VALS(q2931_shaping_indicator_vals), 0x60,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_oam_end_to_end_f5_flow,\r\n{ "Use of end-to-end OAM F5 flow", "q2931.oam_end_to_end_f5_flow",\r\nFT_BOOLEAN, 8, TFS(&tfs_mandatory_optional), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_oam_traffic_descriptor_management_indicator,\r\n{ "User-Network fault management indicator", "q2931.oam_traffic_descriptor.management_indicator",\r\nFT_UINT8, BASE_HEX, VALS(q2931_user_net_fault_mgmt_vals), 0x07,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_oam_traffic_descriptor_forward_f5_flow_indicator,\r\n{ "Forward end-to-end OAM F5 flow indicator", "q2931.oam_traffic_descriptor.forward_f5_flow_indicator",\r\nFT_UINT8, BASE_HEX, VALS(q2931_fwd_e2e_oam_f5_flow_indicator_vals), 0x70,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_oam_traffic_descriptor_backward_f5_flow_indicator,\r\n{ "Backward end-to-end OAM F5 flow indicator", "q2931.oam_traffic_descriptor.backward_f5_flow_indicator",\r\nFT_UINT8, BASE_HEX, VALS(q2931_bwd_e2e_oam_f5_flow_indicator_vals), 0x07,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_endpoint_reference_type,\r\n{ "Endpoint reference type", "q2931.endpoint_reference.type",\r\nFT_UINT8, BASE_HEX, VALS(q2931_endpoint_reference_type_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_endpoint_reference_flag,\r\n{ "Endpoint reference identifier value", "q2931.endpoint_reference.flag",\r\nFT_BOOLEAN, 16, TFS(&tfs_endpoint_reference_flag), 0x8000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_endpoint_reference_identifier_value,\r\n{ "Endpoint reference identifier value", "q2931.endpoint_reference.identifier_value",\r\nFT_UINT16, BASE_DEC, NULL, 0x7FFF,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_endpoint_state,\r\n{ "Endpoint reference party-state", "q2931.endpoint_state",\r\nFT_UINT8, BASE_HEX, VALS(q2931_endpoint_reference_party_state_vals), 0x3F,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_information_element,\r\n{ "Information element", "q2931.information_element",\r\nFT_UINT8, BASE_HEX|BASE_EXT_STRING, &q2931_info_element_vals_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_information_element_extension,\r\n{ "Information element extension", "q2931.information_element.extension",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_information_element_length,\r\n{ "Length", "q2931.information_element.length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_information_element_data,\r\n{ "Data", "q2931.information_element.data",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_frame_discard_forward_dir,\r\n{ "Frame discard in forward direction", "q2931.frame_discard_forward_dir",\r\nFT_BOOLEAN, 8, TFS(&tfs_allowed_not_allowed), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_frame_discard_backward_dir,\r\n{ "Frame discard in backward direction", "q2931.frame_discard_backward_dir",\r\nFT_BOOLEAN, 8, TFS(&tfs_allowed_not_allowed), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_tagging_backward_dir,\r\n{ "Tagging in backward direction", "q2931.tagging_backward_dir",\r\nFT_BOOLEAN, 8, TFS(&tfs_requested_not_requested), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_tagging_forward_dir,\r\n{ "Tagging in forward direction", "q2931.tagging_forward_dir",\r\nFT_BOOLEAN, 8, TFS(&tfs_requested_not_requested), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_midrange,\r\n{ "MID range", "q2931.midrange",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_cause_network_service,\r\n{ "Network service", "q2931.cause.network_service",\r\nFT_BOOLEAN, 8, TFS(&tfs_user_provider), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_cause_network_behavior,\r\n{ "Network behavior", "q2931.cause.network_behavior",\r\nFT_BOOLEAN, 8, TFS(&tfs_abnormal_normal), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_nsap_address_number_short,\r\n{ "Number (too short)", "q2931.nsap_address.number_short",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_atm_identifier,\r\n{ "Identifier", "q2931.atm_identifier",\r\nFT_UINT8, BASE_HEX, VALS(q2931_atm_td_subfield_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_atm_identifier_value,\r\n{ "Value", "q2931.atm_identifier_value",\r\nFT_UINT24, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_aal_parameter_identifier,\r\n{ "Identifier", "q2931.aal.parameter_identifier",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_e2e_transit_delay_identifier,\r\n{ "Identifier", "q2931.transit_delay.identifier",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_bband_sending_complete_id,\r\n{ "Identifier", "q2931.bband_sending_complete.id",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_bband_sending_complete,\r\n{ "Broadband sending complete indication", "q2931.bband_sending_complete",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_q2931_locking_codeset,\r\n{ "Locking codeset", "q2931.locking_codeset",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_q2931,\r\n&ett_q2931_ext,\r\n&ett_q2931_ie,\r\n&ett_q2931_ie_ext,\r\n&ett_q2931_nsap,\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_q2931_atm_identifier, { "q2931.atm_identifier.unknown", PI_PROTOCOL, PI_WARN, "Unknown ATM traffic descriptor element", EXPFILL }},\r\n{ &ei_q2931_aal_parameter_identifier, { "q2931.aal.parameter_identifier.unknown", PI_PROTOCOL, PI_WARN, "Unknown AAL parameter", EXPFILL }},\r\n{ &ei_q2931_e2e_transit_delay_identifier, { "q2931.transit_delay.parameter_identifier.unknown", PI_PROTOCOL, PI_WARN, "Unknown transit delay identifier", EXPFILL }},\r\n{ &ei_q2931_bband_sending_complete_id, { "q2931.bband_sending_complete.id.unknown", PI_PROTOCOL, PI_WARN, "Unknown broadband sending complete element", EXPFILL }},\r\n};\r\nexpert_module_t* expert_q2931;\r\nproto_q2931 = proto_register_protocol("Q.2931", "Q.2931", "q2931");\r\nproto_register_field_array (proto_q2931, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_q2931 = expert_register_protocol(proto_q2931);\r\nexpert_register_field_array(expert_q2931, ei, array_length(ei));\r\nregister_dissector("q2931", dissect_q2931, proto_q2931);\r\n}
