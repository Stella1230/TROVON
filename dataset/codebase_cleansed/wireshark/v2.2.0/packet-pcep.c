static void\r\ndissect_pcep_tlvs(proto_tree *pcep_obj, tvbuff_t *tvb, int offset, gint length, gint ett_pcep_obj)\r\n{\r\nproto_tree *tlv;\r\nguint16 tlv_length, tlv_type, of_code;\r\nint i, j;\r\nint padding = 0;\r\nfor (j = 0; j < length; j += 4 + tlv_length + padding) {\r\ntlv_type = tvb_get_ntohs(tvb, offset+j);\r\ntlv_length = tvb_get_ntohs(tvb, offset + j + 2);\r\ntlv = proto_tree_add_subtree(pcep_obj, tvb, offset + j, tlv_length+4,\r\nett_pcep_obj, NULL, val_to_str(tlv_type, pcep_tlvs_vals, "Unknown TLV (%u). "));\r\nproto_tree_add_item(tlv, hf_pcep_tlv_type, tvb, offset + j, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv, hf_pcep_tlv_length, tvb, offset + 2 + j, 2, ENC_BIG_ENDIAN);\r\nswitch (tlv_type)\r\n{\r\ncase 1:\r\nproto_tree_add_item(tlv, hf_pcep_no_path_tlvs_pce, tvb, offset+4+j, tlv_length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv, hf_pcep_no_path_tlvs_unk_dest, tvb, offset+4+j, tlv_length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv, hf_pcep_no_path_tlvs_unk_src, tvb, offset+4+j, tlv_length, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 3:\r\nproto_tree_add_item(tlv, hf_pcep_request_id, tvb, offset+4+j, tlv_length, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 4:\r\nfor (i=0; i<tlv_length/2; i++) {\r\nof_code = tvb_get_ntohs(tvb, offset+4+j+i*2);\r\nproto_tree_add_uint_format(tlv, hf_pcep_of_code, tvb, offset+4+j+i*2, 2, of_code, "OF-Code #%d: %s (%u)",\r\ni+1, val_to_str_const(of_code, pcep_of_vals, "Unknown"), of_code);\r\n}\r\nbreak;\r\ncase 16:\r\nproto_tree_add_item(tlv, hf_pcep_lsp_update_capability, tvb, offset+4+j, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv, hf_pcep_include_db_version, tvb, offset+4+j, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv, hf_pcep_lsp_instantiation_capability, tvb, offset+4+j, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv, hf_pcep_triggered_resync, tvb, offset+4+j, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv, hf_pcep_delta_lsp_sync_capability, tvb, offset+4+j, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv, hf_pcep_triggered_initial_sync, tvb, offset+4+j, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 17:\r\nproto_tree_add_item(tlv, hf_pcep_symbolic_path_name, tvb, offset+4+j, tlv_length, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase 18:\r\nproto_tree_add_item(tlv, hf_pcep_ipv4_lsp_id_tunnnel_sender_address, tvb, offset+4+j, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv, hf_pcep_ipv4_lsp_id_lsp_id, tvb, offset+4+j + 4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv, hf_pcep_ipv4_lsp_id_tunnel_id, tvb, offset+4+j + 6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv, hf_pcep_ipv4_lsp_id_extended_tunnel_id, tvb, offset+4+j + 8, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv, hf_pcep_ipv4_lsp_id_tunnel_endpoint_address, tvb, offset+4+j + 12, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 19:\r\nproto_tree_add_item(tlv, hf_pcep_ipv6_lsp_id_tunnnel_sender_address, tvb, offset+4+j, 16, ENC_NA);\r\nproto_tree_add_item(tlv, hf_pcep_ipv6_lsp_id_lsp_id, tvb, offset+4+j + 16, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv, hf_pcep_ipv6_lsp_id_tunnel_id, tvb, offset+4+j + 18, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv, hf_pcep_ipv6_lsp_id_extended_tunnel_id, tvb, offset+4+j + 20, 16, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv, hf_pcep_ipv6_lsp_id_tunnel_endpoint_address, tvb, offset+4+j + 36, 16, ENC_NA);\r\nbreak;\r\ncase 20:\r\nproto_tree_add_item(tlv, hf_pcep_lsp_error_code, tvb, offset+4+j, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 21:\r\nproto_tree_add_item(tlv, hf_pcep_rsvp_user_error_spec, tvb, offset+4+j, tlv_length, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase 23:\r\nproto_tree_add_item(tlv, hf_pcep_lsp_state_db_version_number, tvb, offset+4+j, 8, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 24:\r\nproto_tree_add_item(tlv, hf_pcep_speaker_entity_id, tvb, offset+4+j, tlv_length, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase 26:\r\nproto_tree_add_item(tlv, hf_pcep_sr_capability_reserved16, tvb, offset + 4 + j, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv, hf_pcep_sr_capability_flags_reserved, tvb, offset + 4 + j + 2, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv, hf_pcep_sr_capability_msd, tvb, offset + 4 + j + 3, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 27:\r\ncase 28:\r\nproto_tree_add_item(tlv, hf_pcep_path_setup_type_reserved24, tvb, offset + 4 + j, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv, hf_pcep_path_setup_type, tvb, offset + 4 + j + 3, 1, ENC_NA);\r\nbreak;\r\ncase 98:\r\nproto_tree_add_item(tlv, hf_pcep_association_source_global, tvb, offset + 4 + j, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 99:\r\nproto_tree_add_item(tlv, hf_pcep_association_id_extended, tvb, offset + 4 + j, tlv_length, ENC_NA);\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(tlv, hf_pcep_tlv_data, tvb, offset+4+j, tlv_length, ENC_NA);\r\n}\r\npadding = (4 - (tlv_length % 4)) % 4;\r\nif (padding != 0) {\r\nproto_tree_add_item(tlv, hf_pcep_tlv_padding, tvb, offset+4+j+tlv_length, padding, ENC_NA);\r\n}\r\n}\r\n}\r\nstatic void\r\ndissect_subobj_ipv4(proto_tree *pcep_subobj_tree, packet_info *pinfo, tvbuff_t *tvb, int offset, int obj_class, gint ett_pcep_obj, guint length)\r\n{\r\nproto_tree *pcep_subobj_ipv4;\r\nproto_tree *pcep_subobj_ipv4_flags;\r\nproto_item *ti;\r\nguint8 prefix_length;\r\nti = proto_tree_add_item(pcep_subobj_tree, hf_PCEPF_SUBOBJ_IPv4, tvb, offset, length, ENC_NA);\r\npcep_subobj_ipv4 = proto_item_add_subtree(ti, ett_pcep_obj);\r\nif (length != 8) {\r\nexpert_add_info_format(pinfo, ti, &ei_pcep_subobject_bad_length,\r\n"Bad IPv4 subobject: length %u != 8", length);\r\nreturn;\r\n}\r\nprefix_length = tvb_get_guint8(tvb, offset+6);\r\nproto_item_append_text(ti, ": %s/%u", tvb_ip_to_str(tvb, offset+2),\r\nprefix_length);\r\nswitch (obj_class) {\r\ncase PCEP_EXPLICIT_ROUTE_OBJ:\r\ncase PCEP_SERO_OBJ:\r\nproto_tree_add_item(pcep_subobj_ipv4, hf_pcep_subobj_ipv4_l, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv4, hf_PCEPF_SUBOBJ_7F, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv4, hf_pcep_subobj_ipv4_length, tvb, offset+1, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv4, hf_pcep_subobj_ipv4_ipv4, tvb, offset+2, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_subobj_ipv4, hf_pcep_subobj_ipv4_prefix_length, tvb, offset+6, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv4, hf_pcep_subobj_ipv4_padding, tvb, offset+7, 1, ENC_NA);\r\nbreak;\r\ncase PCEP_RECORD_ROUTE_OBJ:\r\ncase PCEP_SRRO_OBJ:\r\nproto_tree_add_item(pcep_subobj_ipv4, hf_PCEPF_SUBOBJ, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv4, hf_pcep_subobj_ipv4_length, tvb, offset+1, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv4, hf_pcep_subobj_ipv4_ipv4, tvb, offset+2, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_subobj_ipv4, hf_pcep_subobj_ipv4_prefix_length, tvb, offset+6, 1, ENC_NA);\r\nti = proto_tree_add_item(pcep_subobj_ipv4, hf_pcep_subobj_ipv4_flags, tvb, offset+7, 1, ENC_NA);\r\npcep_subobj_ipv4_flags = proto_item_add_subtree(ti, ett_pcep_obj);\r\nproto_tree_add_item(pcep_subobj_ipv4_flags, pcep_subobj_flags_lpa, tvb, offset+7, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv4_flags, pcep_subobj_flags_lpu, tvb, offset+7, 1, ENC_NA);\r\nbreak;\r\ncase PCEP_IRO_OBJ:\r\nproto_tree_add_item(pcep_subobj_ipv4, hf_pcep_subobj_iro_ipv4_l, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv4, hf_PCEPF_SUBOBJ_7F, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv4, hf_pcep_subobj_ipv4_length, tvb, offset+1, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv4, hf_pcep_subobj_ipv4_ipv4, tvb, offset+2, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_subobj_ipv4, hf_pcep_subobj_ipv4_prefix_length, tvb, offset+6, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv4, hf_pcep_subobj_ipv4_padding, tvb, offset+7, 1, ENC_NA);\r\nbreak;\r\ncase PCEP_XRO_OBJ:\r\nproto_tree_add_item(pcep_subobj_ipv4, hf_pcep_subobj_ipv4_x, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv4, hf_PCEPF_SUBOBJ_XRO, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv4, hf_pcep_subobj_ipv4_length, tvb, offset+1, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv4, hf_pcep_subobj_ipv4_ipv4, tvb, offset+2, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_subobj_ipv4, hf_pcep_subobj_ipv4_prefix_length, tvb, offset+6, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv4, hf_pcep_subobj_ipv4_attribute, tvb, offset+7, 1, ENC_NA);\r\nbreak;\r\ndefault:\r\nexpert_add_info_format(pinfo, ti, &ei_pcep_non_defined_subobject,\r\n"Non defined subobject for this object");\r\nbreak;\r\n}\r\n}\r\nstatic void\r\ndissect_subobj_ipv6(proto_tree *pcep_subobj_tree, packet_info *pinfo, tvbuff_t *tvb, int offset, int obj_class, gint ett_pcep_obj, guint length)\r\n{\r\nproto_tree *pcep_subobj_ipv6;\r\nproto_tree *pcep_subobj_ipv6_flags;\r\nproto_item *ti;\r\nguint8 prefix_length;\r\nti = proto_tree_add_item(pcep_subobj_tree, hf_PCEPF_SUBOBJ_IPv6, tvb, offset, length, ENC_NA);\r\npcep_subobj_ipv6 = proto_item_add_subtree(ti, ett_pcep_obj);\r\nif (length != 20) {\r\nexpert_add_info_format(pinfo, ti, &ei_pcep_subobject_bad_length,\r\n"Bad IPv6 subobject: length %u != 20", length);\r\nreturn;\r\n}\r\nprefix_length = tvb_get_guint8(tvb, offset+18);\r\nproto_item_append_text(ti, ": %s/%u", tvb_ip6_to_str(tvb, offset+2),\r\nprefix_length);\r\nswitch (obj_class) {\r\ncase PCEP_EXPLICIT_ROUTE_OBJ:\r\ncase PCEP_SERO_OBJ:\r\nproto_tree_add_item(pcep_subobj_ipv6, hf_pcep_subobj_ipv6_l, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv6, hf_PCEPF_SUBOBJ_7F, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv6, hf_pcep_subobj_ipv6_length, tvb, offset+1, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv6, hf_pcep_subobj_ipv6_ipv6, tvb, offset+2, 16, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv6, hf_pcep_subobj_ipv6_prefix_length, tvb, offset+18, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv6, hf_pcep_subobj_ipv6_padding, tvb, offset+19, 1, ENC_NA);\r\nbreak;\r\ncase PCEP_RECORD_ROUTE_OBJ:\r\ncase PCEP_SRRO_OBJ:\r\nproto_tree_add_item(pcep_subobj_ipv6, hf_PCEPF_SUBOBJ, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv6, hf_pcep_subobj_ipv6_length, tvb, offset+1, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv6, hf_pcep_subobj_ipv6_ipv6, tvb, offset+2, 16, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv6, hf_pcep_subobj_ipv6_prefix_length, tvb, offset+18, 1, ENC_NA);\r\nti = proto_tree_add_item(pcep_subobj_ipv6, hf_pcep_subobj_ipv6_flags, tvb, offset+19, 1, ENC_NA);\r\npcep_subobj_ipv6_flags = proto_item_add_subtree(ti, ett_pcep_obj);\r\nproto_tree_add_item(pcep_subobj_ipv6_flags, pcep_subobj_flags_lpa, tvb, offset+19, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv6_flags, pcep_subobj_flags_lpu, tvb, offset+19, 1, ENC_NA);\r\nbreak;\r\ncase PCEP_IRO_OBJ:\r\nproto_tree_add_item(pcep_subobj_ipv6, hf_pcep_subobj_iro_ipv6_l, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv6, hf_PCEPF_SUBOBJ_7F, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv6, hf_pcep_subobj_ipv6_length, tvb, offset+1, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv6, hf_pcep_subobj_ipv6_ipv6, tvb, offset+2, 16, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv6, hf_pcep_subobj_ipv6_prefix_length, tvb, offset+18, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv6, hf_pcep_subobj_ipv6_padding, tvb, offset+19, 1, ENC_NA);\r\nbreak;\r\ncase PCEP_XRO_OBJ:\r\nproto_tree_add_item(pcep_subobj_ipv6, hf_pcep_subobj_ipv6_x, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv6, hf_PCEPF_SUBOBJ_XRO, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv6, hf_pcep_subobj_ipv6_length, tvb, offset+1, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv6, hf_pcep_subobj_ipv6_ipv6, tvb, offset+2, 16, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv6, hf_pcep_subobj_ipv6_prefix_length, tvb, offset+18, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_ipv6, hf_pcep_subobj_ipv6_attribute, tvb, offset+19, 1, ENC_NA);\r\nbreak;\r\ndefault:\r\nexpert_add_info_format(pinfo, ti, &ei_pcep_non_defined_subobject,\r\n"Non defined subobject for this object");\r\nbreak;\r\n}\r\n}\r\nstatic void\r\ndissect_subobj_label_control(proto_tree *pcep_subobj_tree, packet_info *pinfo, tvbuff_t *tvb, int offset, int obj_class, gint ett_pcep_obj, guint length)\r\n{\r\nproto_tree *pcep_subobj_label_control;\r\nproto_tree *pcep_subobj_label_flags;\r\nproto_item *ti;\r\nti = proto_tree_add_item(pcep_subobj_tree, hf_PCEPF_SUBOBJ_LABEL_CONTROL, tvb, offset, length, ENC_NA);\r\npcep_subobj_label_control = proto_item_add_subtree(ti, ett_pcep_obj);\r\nif (length < 5) {\r\nexpert_add_info_format(pinfo, ti, &ei_pcep_subobject_bad_length,\r\n"Bad label control subobject: length %u < 5", length);\r\nreturn;\r\n}\r\nswitch (obj_class) {\r\ncase PCEP_EXPLICIT_ROUTE_OBJ:\r\ncase PCEP_SERO_OBJ:\r\nproto_tree_add_item(pcep_subobj_label_control, hf_pcep_subobj_label_control_l, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_label_control, hf_PCEPF_SUBOBJ_7F, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_label_control, hf_pcep_subobj_label_control_length, tvb, offset+1, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_label_control, hf_pcep_subobj_label_control_u, tvb, offset+2, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_label_control, hf_pcep_subobj_label_control_reserved, tvb, offset+2, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_label_control, hf_pcep_subobj_label_control_c_type, tvb, offset+3, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_label_control, hf_pcep_subobj_label_control_label, tvb, offset+4, length-4, ENC_NA);\r\nbreak;\r\ncase PCEP_RECORD_ROUTE_OBJ:\r\ncase PCEP_SRRO_OBJ:\r\nproto_tree_add_item(pcep_subobj_label_control, hf_PCEPF_SUBOBJ, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_label_control, hf_pcep_subobj_label_control_length, tvb, offset+1, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_label_control, hf_pcep_subobj_label_control_u, tvb, offset+2, 1, ENC_NA);\r\nti = proto_tree_add_item(pcep_subobj_label_control, hf_pcep_subobj_label_control_flags, tvb, offset+2, 1, ENC_NA);\r\npcep_subobj_label_flags = proto_item_add_subtree(ti, ett_pcep_obj);\r\nproto_tree_add_item(pcep_subobj_label_flags, pcep_subobj_label_flags_gl, tvb, offset+2, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_label_control, hf_pcep_subobj_label_control_c_type, tvb, offset+3, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_label_control, hf_pcep_subobj_label_control_label, tvb, offset+4, length-4, ENC_NA);\r\nbreak;\r\ndefault:\r\nexpert_add_info_format(pinfo, ti, &ei_pcep_non_defined_subobject,\r\n"Non defined subobject for this object");\r\nbreak;\r\n}\r\n}\r\nstatic void\r\ndissect_subobj_sr(proto_tree *pcep_subobj_tree, packet_info *pinfo, tvbuff_t *tvb, int offset, int obj_class, gint ett_pcep_obj, guint length)\r\n{\r\nproto_tree *pcep_subobj_sr_tree = NULL;\r\nproto_item *ti = NULL;\r\nguint32 sid = 0;\r\nguint8 st = 0;\r\nstatic const int *subobj_sr_flags[] = {\r\n&hf_pcep_subobj_sr_flags_m,\r\n&hf_pcep_subobj_sr_flags_c,\r\n&hf_pcep_subobj_sr_flags_s,\r\n&hf_pcep_subobj_sr_flags_f,\r\nNULL\r\n};\r\nti = proto_tree_add_item(pcep_subobj_tree, hf_PCEPF_SUBOBJ_SR, tvb, offset, length, ENC_NA);\r\npcep_subobj_sr_tree = proto_item_add_subtree(ti, ett_pcep_obj);\r\nif (length < 8) {\r\nexpert_add_info_format(pinfo, ti, &ei_pcep_subobject_bad_length,\r\n"Bad SR subobject: length %u < 8", length);\r\nreturn;\r\n}\r\nsid = tvb_get_ntohl(tvb, offset + 4) >> 12;\r\nproto_item_append_text(ti, ": %u", sid);\r\nst = ((tvb_get_guint8(tvb, offset + 2)) >> 4);\r\nswitch (obj_class) {\r\ncase PCEP_EXPLICIT_ROUTE_OBJ:\r\nproto_tree_add_item(pcep_subobj_sr_tree, hf_pcep_subobj_sr_l, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_sr_tree, hf_PCEPF_SUBOBJ_7F, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_sr_tree, hf_pcep_subobj_sr_length, tvb, offset + 1, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_sr_tree, hf_pcep_subobj_sr_st, tvb, offset + 2, 1, ENC_NA);\r\nproto_tree_add_bitmask(pcep_subobj_sr_tree, tvb, offset + 2, hf_pcep_subobj_sr_flags, ett_pcep_obj, subobj_sr_flags, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_sr_tree, hf_pcep_subobj_sr_sid, tvb, offset + 4, 4, ENC_BIG_ENDIAN);\r\nif ((st == 1) && (length == 12)) {\r\nproto_tree_add_item(pcep_subobj_sr_tree, hf_pcep_subobj_sr_nai_ipv4_node, tvb,\r\noffset + 8, 4, ENC_BIG_ENDIAN);\r\n}\r\nif ((st == 2) && (length == 24)) {\r\nproto_tree_add_item(pcep_subobj_sr_tree, hf_pcep_subobj_sr_nai_ipv6_node, tvb,\r\noffset + 8, 16, ENC_NA);\r\n}\r\nbreak;\r\ncase PCEP_RECORD_ROUTE_OBJ:\r\nproto_tree_add_item(pcep_subobj_sr_tree, hf_PCEPF_SUBOBJ, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_sr_tree, hf_pcep_subobj_sr_length, tvb, offset + 1, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_sr_tree, hf_pcep_subobj_sr_st, tvb, offset + 2, 1, ENC_NA);\r\nproto_tree_add_bitmask(pcep_subobj_sr_tree, tvb, offset + 2, hf_pcep_subobj_sr_flags, ett_pcep_obj, subobj_sr_flags, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_sr_tree, hf_pcep_subobj_sr_sid, tvb, offset + 4, 4, ENC_BIG_ENDIAN);\r\nif ((st == 1) && (length == 12)) {\r\nproto_tree_add_item(pcep_subobj_sr_tree, hf_pcep_subobj_sr_nai_ipv4_node, tvb,\r\noffset + 8, 4, ENC_BIG_ENDIAN);\r\n}\r\nif ((st == 2) && (length == 24)) {\r\nproto_tree_add_item(pcep_subobj_sr_tree, hf_pcep_subobj_sr_nai_ipv6_node, tvb,\r\noffset + 8, 16, ENC_NA);\r\n}\r\nbreak;\r\ndefault:\r\nexpert_add_info_format(pinfo, ti, &ei_pcep_non_defined_subobject,\r\n"Non defined subobject for this object");\r\nbreak;\r\n}\r\n}\r\nstatic void\r\ndissect_subobj_unnumb_interfaceID(proto_tree *pcep_subobj_tree, packet_info *pinfo, tvbuff_t *tvb, int offset, int obj_class, gint ett_pcep_obj, guint length)\r\n{\r\nproto_tree *pcep_subobj_unnumb_interfaceID;\r\nproto_item *ti;\r\nguint32 interface_ID;\r\nti = proto_tree_add_item(pcep_subobj_tree, hf_PCEPF_SUBOBJ_UNNUM_INTERFACEID, tvb, offset, length, ENC_NA);\r\npcep_subobj_unnumb_interfaceID = proto_item_add_subtree(ti, ett_pcep_obj);\r\nif (length != 12) {\r\nexpert_add_info_format(pinfo, ti, &ei_pcep_subobject_bad_length,\r\n"Bad unnumbered interface ID subobject: length %u != 12", length);\r\nreturn;\r\n}\r\ninterface_ID = tvb_get_ntohl(tvb, offset+8);\r\nproto_item_append_text(ti, ": %s:%u", tvb_ip_to_str (tvb, offset+4),\r\ninterface_ID);\r\nswitch (obj_class) {\r\ncase PCEP_EXPLICIT_ROUTE_OBJ:\r\ncase PCEP_SERO_OBJ:\r\nproto_tree_add_item(pcep_subobj_unnumb_interfaceID, hf_pcep_subobj_unnumb_interfaceID_l, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_unnumb_interfaceID, hf_PCEPF_SUBOBJ_7F, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_unnumb_interfaceID, hf_pcep_subobj_unnumb_interfaceID_length, tvb, offset+1, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_unnumb_interfaceID, hf_pcep_subobj_unnumb_interfaceID_reserved, tvb, offset+2, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase PCEP_RECORD_ROUTE_OBJ:\r\ncase PCEP_SRRO_OBJ:\r\n{\r\nstatic const int * flags[] = {\r\n&pcep_subobj_flags_lpa,\r\n&pcep_subobj_flags_lpu,\r\nNULL\r\n};\r\nproto_tree_add_item(pcep_subobj_unnumb_interfaceID, hf_PCEPF_SUBOBJ, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_unnumb_interfaceID, hf_pcep_subobj_unnumb_interfaceID_length, tvb, offset+1, 1, ENC_NA);\r\nproto_tree_add_bitmask(pcep_subobj_unnumb_interfaceID, tvb, offset+2, hf_pcep_subobj_unnumb_interfaceID_flags, ett_pcep_obj, flags, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_subobj_unnumb_interfaceID, hf_pcep_subobj_unnumb_interfaceID_reserved_rrobj, tvb, offset+3, 1, ENC_NA);\r\n}\r\nbreak;\r\ncase PCEP_IRO_OBJ:\r\nproto_tree_add_item(pcep_subobj_unnumb_interfaceID, hf_pcep_subobj_iro_unnumb_interfaceID_l, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_unnumb_interfaceID, hf_PCEPF_SUBOBJ_7F, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_unnumb_interfaceID, hf_pcep_subobj_unnumb_interfaceID_length, tvb, offset+1, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_unnumb_interfaceID, hf_pcep_subobj_unnumb_interfaceID_reserved, tvb, offset+2, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase PCEP_XRO_OBJ:\r\nproto_tree_add_item(pcep_subobj_unnumb_interfaceID, hf_pcep_subobj_unnumb_interfaceID_x, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_unnumb_interfaceID, hf_PCEPF_SUBOBJ_XRO, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_unnumb_interfaceID, hf_pcep_subobj_unnumb_interfaceID_reserved_xroobj, tvb, offset+2, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_unnumb_interfaceID, hf_pcep_subobj_unnumb_interfaceID_attribute, tvb, offset+3, 1, ENC_NA);\r\nbreak;\r\ndefault:\r\nexpert_add_info_format(pinfo, ti, &ei_pcep_non_defined_subobject,\r\n"Non defined subobject for this object");\r\nbreak;\r\n}\r\nproto_tree_add_item(pcep_subobj_unnumb_interfaceID, hf_pcep_subobj_unnumb_interfaceID_router_id, tvb, offset+4, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_subobj_unnumb_interfaceID, hf_pcep_subobj_unnumb_interfaceID_interface_id, tvb, offset+8, 4, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_subobj_autonomous_sys_num(proto_tree *pcep_subobj_tree, packet_info *pinfo, tvbuff_t *tvb, int offset, int obj_class, guint ett_pcep_obj, guint length)\r\n{\r\nproto_tree *pcep_subobj_autonomous_sys_num;\r\nproto_item *ti;\r\nif (obj_class == PCEP_XRO_OBJ) {\r\nti = proto_tree_add_item(pcep_subobj_tree, hf_PCEPF_SUBOBJ_AUTONOMOUS_SYS_NUM, tvb, offset, length, ENC_NA);\r\npcep_subobj_autonomous_sys_num = proto_item_add_subtree(ti, ett_pcep_obj);\r\nif (length != 8) {\r\nexpert_add_info_format(pinfo, ti, &ei_pcep_subobject_bad_length,\r\n"Bad autonomous system number subobject: length %u != 8", length);\r\nreturn;\r\n}\r\nproto_tree_add_item(pcep_subobj_autonomous_sys_num, hf_pcep_subobj_autonomous_sys_num_x, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_autonomous_sys_num, hf_PCEPF_SUBOBJ_XRO, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_autonomous_sys_num, hf_pcep_subobj_autonomous_sys_num_length, tvb, offset+1, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_autonomous_sys_num, hf_pcep_subobj_autonomous_sys_num_reserved, tvb, offset+2, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_autonomous_sys_num, hf_pcep_subobj_autonomous_sys_num_attribute, tvb, offset+3, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_autonomous_sys_num, hf_pcep_subobj_autonomous_sys_num_optional_as_number_high_octets, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_subobj_autonomous_sys_num, hf_pcep_subobj_autonomous_sys_num_as_number, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\n} else {\r\nti = proto_tree_add_item(pcep_subobj_tree, hf_PCEPF_SUBOBJ_AUTONOMOUS_SYS_NUM, tvb, offset, length, ENC_NA);\r\npcep_subobj_autonomous_sys_num = proto_item_add_subtree(ti, ett_pcep_obj);\r\nif (length != 4) {\r\nexpert_add_info_format(pinfo, ti, &ei_pcep_subobject_bad_length,\r\n"Bad autonomous system number subobject: length %u != 4", length);\r\nreturn;\r\n}\r\nif (obj_class == PCEP_IRO_OBJ)\r\nproto_tree_add_item(pcep_subobj_autonomous_sys_num, hf_pcep_subobj_iro_autonomous_sys_num_l, tvb, offset, 1, ENC_NA);\r\nelse\r\nproto_tree_add_item(pcep_subobj_autonomous_sys_num, hf_pcep_subobj_autonomous_sys_num_l, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_autonomous_sys_num, hf_PCEPF_SUBOBJ_7F, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_autonomous_sys_num, hf_pcep_subobj_autonomous_sys_num_length, tvb, offset+1, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_autonomous_sys_num, hf_pcep_subobj_autonomous_sys_num_as_number, tvb, offset+2, 2, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_subobj_srlg(proto_tree *pcep_subobj_tree, packet_info *pinfo, tvbuff_t *tvb, int offset, guint ett_pcep_obj, guint length)\r\n{\r\nproto_tree *pcep_subobj_srlg;\r\nproto_item *ti;\r\nti = proto_tree_add_item(pcep_subobj_tree, hf_PCEPF_SUBOBJ_SRLG, tvb, offset, length, ENC_NA);\r\npcep_subobj_srlg = proto_item_add_subtree(ti, ett_pcep_obj);\r\nif (length != 8) {\r\nexpert_add_info_format(pinfo, ti, &ei_pcep_subobject_bad_length,\r\n"Bad SRLG subobject: length %u != 8", length);\r\nreturn;\r\n}\r\nproto_tree_add_item(pcep_subobj_srlg, hf_pcep_subobj_srlg_x, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_srlg, hf_PCEPF_SUBOBJ_XRO, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_srlg, hf_pcep_subobj_srlg_length, tvb, offset+1, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_srlg, hf_pcep_subobj_srlg_id, tvb, offset+2, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_subobj_srlg, hf_pcep_subobj_srlg_reserved, tvb, offset+6, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_srlg, hf_pcep_subobj_srlg_attribute, tvb, offset+7, 1, ENC_NA);\r\n}\r\nstatic void\r\ndissect_subobj_exrs(proto_tree *pcep_subobj_tree, packet_info *pinfo, tvbuff_t *tvb, int offset, int obj_class, guint ett_pcep_obj, guint type_iro, guint length)\r\n{\r\nproto_tree *pcep_subobj_exrs;\r\nproto_item *ti;\r\nguint8 l_type;\r\nguint8 length2;\r\nguint type_exrs;\r\nguint offset_exrs = 0;\r\nti = proto_tree_add_item(pcep_subobj_tree, hf_PCEPF_SUBOBJ_EXRS, tvb, offset, length, ENC_NA);\r\npcep_subobj_exrs = proto_item_add_subtree(ti, ett_pcep_obj);\r\nif (length < 4) {\r\nexpert_add_info_format(pinfo, ti, &ei_pcep_subobject_bad_length,\r\n"Bad EXRS subobject: length %u < 4", length);\r\nreturn;\r\n}\r\nproto_tree_add_item(pcep_subobj_exrs, hf_pcep_subobj_exrs_l, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_exrs, hf_pcep_subobj_exrs_type, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_exrs, hf_pcep_subobj_exrs_length, tvb, offset+1, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_exrs, hf_pcep_subobj_exrs_reserved, tvb, offset+2, 2, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nwhile (offset_exrs<length-4) {\r\nl_type = tvb_get_guint8(tvb, offset);\r\nlength2 = tvb_get_guint8(tvb, offset+1);\r\nif (length2 < 2) {\r\nexpert_add_info_format(pinfo, ti, &ei_pcep_subobject_bad_length,\r\n"Bad packet: subobject length %u < 2", length2);\r\nbreak;\r\n}\r\ntype_exrs = (l_type & Mask_Type);\r\nif (type_iro == PCEP_SUB_EXRS)\r\nobj_class = PCEP_XRO_OBJ;\r\nswitch (type_exrs) {\r\ncase PCEP_SUB_IPv4:\r\ndissect_subobj_ipv4(pcep_subobj_exrs, pinfo, tvb, offset, obj_class, ett_pcep_obj, length2);\r\nbreak;\r\ncase PCEP_SUB_IPv6:\r\ndissect_subobj_ipv6(pcep_subobj_exrs, pinfo, tvb, offset, obj_class, ett_pcep_obj, length2);\r\nbreak;\r\ncase PCEP_SUB_UNNUMB_INTERFACE_ID:\r\ndissect_subobj_unnumb_interfaceID(pcep_subobj_exrs, pinfo, tvb, offset, obj_class, ett_pcep_obj, length2);\r\nbreak;\r\ncase PCEP_SUB_AUTONOMOUS_SYS_NUM:\r\ndissect_subobj_autonomous_sys_num(pcep_subobj_exrs, pinfo, tvb, offset, obj_class, ett_pcep_obj, length2);\r\nbreak;\r\ncase PCEP_SUB_SRLG:\r\ndissect_subobj_srlg(pcep_subobj_exrs, pinfo, tvb, offset, ett_pcep_obj, length2);\r\nbreak;\r\ndefault:\r\nproto_tree_add_expert_format(pcep_subobj_exrs, pinfo, &ei_pcep_non_defined_subobject,\r\ntvb, offset+2, length-2,\r\n"Non defined subobject (%d)", type_exrs);\r\nbreak;\r\n}\r\noffset_exrs += length2;\r\noffset += length2;\r\n}\r\n}\r\nstatic void\r\ndissect_subobj_pksv4(proto_tree *pcep_subobj_tree, packet_info *pinfo, tvbuff_t *tvb, int offset, gint ett_pcep_obj, guint length)\r\n{\r\nproto_tree *pcep_subobj_pksv4;\r\nproto_item *ti;\r\nguint16 path_key;\r\nti = proto_tree_add_item(pcep_subobj_tree, hf_PCEPF_SUBOBJ_PKSv4, tvb, offset, length, ENC_NA);\r\npcep_subobj_pksv4 = proto_item_add_subtree(ti, ett_pcep_obj);\r\nif (length != 8) {\r\nexpert_add_info_format(pinfo, ti, &ei_pcep_subobject_bad_length,\r\n"Bad path key subobject: length %u != 8", length);\r\nreturn;\r\n}\r\npath_key = tvb_get_ntohs(tvb, offset+2);\r\nproto_item_append_text(ti, ": %s, Path Key %u", tvb_ip_to_str(tvb, offset+4), path_key);\r\nproto_tree_add_item(pcep_subobj_pksv4, hf_pcep_subobj_pksv4_l, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_pksv4, hf_PCEPF_SUBOBJ_7F, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_pksv4, hf_pcep_subobj_pksv4_length, tvb, offset+1, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_pksv4, hf_pcep_subobj_pksv4_path_key, tvb, offset+2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_subobj_pksv4, hf_pcep_subobj_pksv4_pce_id, tvb, offset+4, 4, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_subobj_pksv6(proto_tree *pcep_subobj_tree, packet_info *pinfo, tvbuff_t *tvb, int offset, gint ett_pcep_obj, guint length)\r\n{\r\nproto_tree *pcep_subobj_pksv6;\r\nproto_item *ti;\r\nguint16 path_key;\r\nti = proto_tree_add_item(pcep_subobj_tree, hf_PCEPF_SUBOBJ_PKSv6, tvb, offset, length, ENC_NA);\r\npcep_subobj_pksv6 = proto_item_add_subtree(ti, ett_pcep_obj);\r\nif (length != 20) {\r\nexpert_add_info_format(pinfo, ti, &ei_pcep_subobject_bad_length,\r\n"Bad path key subobject: length %u != 20", length);\r\nreturn;\r\n}\r\npath_key = tvb_get_ntohs(tvb, offset+2);\r\nproto_item_append_text(ti, ": %s, Path Key %u", tvb_ip6_to_str(tvb, offset+4), path_key);\r\nproto_tree_add_item(pcep_subobj_pksv6, hf_pcep_subobj_pksv6_l, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_pksv6, hf_PCEPF_SUBOBJ_7F, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_pksv6, hf_pcep_subobj_pksv6_length, tvb, offset+1, 1, ENC_NA);\r\nproto_tree_add_item(pcep_subobj_pksv6, hf_pcep_subobj_pksv6_path_key, tvb, offset+2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_subobj_pksv6, hf_pcep_subobj_pksv6_pce_id, tvb, offset+4, 4, ENC_NA);\r\n}\r\nstatic void\r\ndissect_pcep_open_obj (proto_tree *pcep_object_tree, packet_info *pinfo, tvbuff_t *tvb, int offset2, int obj_length)\r\n{\r\nproto_tree *pcep_open_obj_flags;\r\nproto_item *ti;\r\nif (obj_length < OBJ_HDR_LEN+OPEN_OBJ_MIN_LEN) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, obj_length,\r\n"Bad OPEN object length %u, should be >= %u",\r\nobj_length, OBJ_HDR_LEN+OPEN_OBJ_MIN_LEN);\r\nreturn;\r\n}\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_open_obj_pcep_version, tvb, offset2, 1, ENC_NA);\r\nti = proto_tree_add_item(pcep_object_tree, hf_pcep_open_obj_flags, tvb, offset2, 1, ENC_NA);\r\npcep_open_obj_flags = proto_item_add_subtree(ti, ett_pcep_obj_open);\r\nproto_tree_add_item(pcep_open_obj_flags, hf_pcep_open_flags_res, tvb, offset2, 1, ENC_NA);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_open_obj_keepalive, tvb, offset2+1, 1, ENC_NA);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_open_obj_deadtime, tvb, offset2+2, 1, ENC_NA);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_open_obj_sid, tvb, offset2+3, 1, ENC_NA);\r\noffset2 += OPEN_OBJ_MIN_LEN;\r\nobj_length -= OBJ_HDR_LEN+OPEN_OBJ_MIN_LEN;\r\ndissect_pcep_tlvs(pcep_object_tree, tvb, offset2, obj_length, ett_pcep_obj_open);\r\n}\r\nstatic void\r\ndissect_pcep_rp_obj(proto_tree *pcep_object_tree, packet_info *pinfo,\r\ntvbuff_t *tvb, int offset2, int obj_length)\r\n{\r\nproto_tree *pcep_rp_obj_flags;\r\nproto_item *ti;\r\nif (obj_length < OBJ_HDR_LEN+RP_OBJ_MIN_LEN) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, obj_length,\r\n"Bad RP object length %u, should be >= %u",\r\nobj_length, OBJ_HDR_LEN+RP_OBJ_MIN_LEN);\r\nreturn;\r\n}\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_rp_obj_reserved, tvb, offset2, 1, ENC_NA);\r\nti = proto_tree_add_item(pcep_object_tree, hf_pcep_rp_obj_flags, tvb, offset2+1, 3, ENC_BIG_ENDIAN);\r\npcep_rp_obj_flags = proto_item_add_subtree(ti, ett_pcep_obj_request_parameters);\r\nproto_tree_add_item(pcep_rp_obj_flags, hf_pcep_rp_flags_reserved, tvb, offset2+1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_rp_obj_flags, hf_pcep_rp_flags_f, tvb, offset2+1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_rp_obj_flags, hf_pcep_rp_flags_n, tvb, offset2+1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_rp_obj_flags, hf_pcep_rp_flags_e, tvb, offset2+1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_rp_obj_flags, hf_pcep_rp_flags_m, tvb, offset2+1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_rp_obj_flags, hf_pcep_rp_flags_d, tvb, offset2+1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_rp_obj_flags, hf_pcep_rp_flags_p, tvb, offset2+1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_rp_obj_flags, hf_pcep_rp_flags_s, tvb, offset2+1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_rp_obj_flags, hf_pcep_rp_flags_v, tvb, offset2+1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_rp_obj_flags, hf_pcep_rp_flags_o, tvb, offset2+1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_rp_obj_flags, hf_pcep_rp_flags_b, tvb, offset2+1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_rp_obj_flags, hf_pcep_rp_flags_r, tvb, offset2+1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_rp_obj_flags, hf_pcep_rp_flags_pri, tvb, offset2+1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_rp_obj_requested_id_number, tvb, offset2+4, 4, ENC_BIG_ENDIAN);\r\noffset2 += RP_OBJ_MIN_LEN;\r\nobj_length -= OBJ_HDR_LEN+RP_OBJ_MIN_LEN;\r\ndissect_pcep_tlvs(pcep_object_tree, tvb, offset2, obj_length, ett_pcep_obj_request_parameters);\r\n}\r\nstatic void\r\ndissect_pcep_no_path_obj(proto_tree *pcep_object_tree, packet_info *pinfo,\r\ntvbuff_t *tvb, int offset2, int obj_length)\r\n{\r\nproto_tree *pcep_no_path_obj_flags;\r\nproto_item *ti;\r\nif (obj_length < OBJ_HDR_LEN+NO_PATH_OBJ_MIN_LEN) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, obj_length,\r\n"Bad NO-PATH object length %u, should be >= %u",\r\nobj_length, OBJ_HDR_LEN+NO_PATH_OBJ_MIN_LEN);\r\nreturn;\r\n}\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_no_path_obj_nature_of_issue, tvb, offset2, 1, ENC_NA);\r\nti = proto_tree_add_item(pcep_object_tree, hf_pcep_no_path_obj_flags, tvb, offset2+1, 2, ENC_BIG_ENDIAN);\r\npcep_no_path_obj_flags = proto_item_add_subtree(ti, ett_pcep_obj_no_path);\r\nproto_tree_add_item(pcep_no_path_obj_flags, hf_pcep_no_path_flags_c, tvb, offset2+1, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_no_path_obj_reserved, tvb, offset2+3, 1, ENC_NA);\r\noffset2 += NO_PATH_OBJ_MIN_LEN;\r\nobj_length -= OBJ_HDR_LEN+NO_PATH_OBJ_MIN_LEN;\r\ndissect_pcep_tlvs(pcep_object_tree, tvb, offset2, obj_length, ett_pcep_obj_no_path);\r\n}\r\nstatic void\r\ndissect_pcep_end_point_obj(proto_tree *pcep_object_tree, packet_info *pinfo,\r\ntvbuff_t *tvb, int offset2, int obj_length, int type)\r\n{\r\nint dest_leafs;\r\nint i=0;\r\nswitch (type)\r\n{\r\ncase IPv4:\r\nif (obj_length != OBJ_HDR_LEN+END_POINT_IPV4_OBJ_LEN) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, obj_length,\r\n"Bad IPv4 END-POINTS object length %u, should be %u",\r\nobj_length, OBJ_HDR_LEN+END_POINT_IPV4_OBJ_LEN);\r\nreturn;\r\n}\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_end_point_obj_source_ipv4_address, tvb, offset2, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_end_point_obj_destination_ipv4_address, tvb, offset2+4, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase IPv6:\r\nif (obj_length != OBJ_HDR_LEN+END_POINT_IPV6_OBJ_LEN) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, obj_length,\r\n"Bad IPv6 END-POINTS object length %u, should be %u",\r\nobj_length, OBJ_HDR_LEN+END_POINT_IPV6_OBJ_LEN);\r\nreturn;\r\n}\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_end_point_obj_source_ipv6_address, tvb, offset2, 16, ENC_NA);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_end_point_obj_destination_ipv6_address, tvb, offset2+16, 16, ENC_NA);\r\nbreak;\r\ncase IPv4_P2MP:\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_endpoint_p2mp_leaf, tvb, offset2, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_end_point_obj_source_ipv4_address, tvb, offset2+4, 4, ENC_BIG_ENDIAN);\r\ndest_leafs = (obj_length - OBJ_HDR_LEN - 8)/4;\r\nfor (i=0; i<dest_leafs; i++)\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_end_point_obj_destination_ipv4_address, tvb, offset2+8+4*i, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase IPv6_P2MP:\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_endpoint_p2mp_leaf, tvb, offset2, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_end_point_obj_source_ipv6_address, tvb, offset2+4, 16, ENC_NA);\r\ndest_leafs = (obj_length - OBJ_HDR_LEN - 20)/16;\r\nfor (i=0; i<dest_leafs; i++)\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_end_point_obj_destination_ipv6_address, tvb, (offset2+20+i*16), 16, ENC_NA);\r\nbreak;\r\ndefault:\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_unknown_type_object,\r\ntvb, offset2, obj_length-OBJ_HDR_LEN,\r\n"UNKNOWN Type Object (%u)", type);\r\nbreak;\r\n}\r\n}\r\nstatic void\r\ndissect_pcep_bandwidth_obj(proto_tree *pcep_object_tree, packet_info *pinfo, tvbuff_t *tvb, int offset2, int obj_length)\r\n{\r\nif (obj_length != OBJ_HDR_LEN+BANDWIDTH_OBJ_LEN) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, obj_length,\r\n"Bad BANDWIDTH object length %u, should be %u",\r\nobj_length, OBJ_HDR_LEN+BANDWIDTH_OBJ_LEN);\r\nreturn;\r\n}\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_bandwidth, tvb, offset2, 4, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_pcep_metric_obj(proto_tree *pcep_object_tree, packet_info *pinfo,\r\ntvbuff_t *tvb, int offset2, int obj_length)\r\n{\r\nproto_tree *pcep_metric_obj_flags;\r\nproto_item *ti;\r\nif (obj_length != OBJ_HDR_LEN+METRIC_OBJ_LEN) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, obj_length,\r\n"Bad METRIC object length %u, should be %u",\r\nobj_length, OBJ_HDR_LEN+METRIC_OBJ_LEN);\r\nreturn;\r\n}\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_metric_obj_reserved, tvb, offset2, 2, ENC_BIG_ENDIAN);\r\nti = proto_tree_add_item(pcep_object_tree, hf_pcep_metric_obj_flags, tvb, offset2+2, 1, ENC_NA);\r\npcep_metric_obj_flags = proto_item_add_subtree(ti, ett_pcep_obj_metric);\r\nproto_tree_add_item(pcep_metric_obj_flags, hf_pcep_metric_flags_c, tvb, offset2+2, 1, ENC_NA);\r\nproto_tree_add_item(pcep_metric_obj_flags, hf_pcep_metric_flags_b, tvb, offset2+2, 1, ENC_NA);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_metric_obj_type, tvb, offset2+3, 1, ENC_NA);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_metric_obj_metric_value, tvb, offset2+4, 4, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_pcep_explicit_route_obj(proto_tree *pcep_object_tree, packet_info *pinfo,\r\ntvbuff_t *tvb, int offset2, int obj_length, int obj_class)\r\n{\r\nguint8 l_type;\r\nguint8 length;\r\nguint type_exp_route;\r\nguint body_obj_len;\r\nbody_obj_len = obj_length - OBJ_HDR_LEN;\r\nwhile (body_obj_len) {\r\nif (body_obj_len < 2) {\r\nexpert_add_info_format(pinfo, pcep_object_tree, &ei_pcep_subobject_bad_length,\r\n"Bad ERO object: subobject goes past end of object");\r\nbreak;\r\n}\r\nl_type = tvb_get_guint8(tvb, offset2);\r\nlength = tvb_get_guint8(tvb, offset2+1);\r\nif (length < 2) {\r\nexpert_add_info_format(pinfo, pcep_object_tree, &ei_pcep_subobject_bad_length,\r\n"Bad ERO object: subobject length %u < 2", length);\r\nbreak;\r\n}\r\ntype_exp_route = (l_type & Mask_Type);\r\nif (body_obj_len <length) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, length,\r\n"Bad ERO object: subobject length %u > remaining length %u",\r\nlength, body_obj_len);\r\nbreak;\r\n}\r\nswitch (type_exp_route) {\r\ncase PCEP_SUB_IPv4:\r\ndissect_subobj_ipv4(pcep_object_tree, pinfo, tvb, offset2, obj_class, ett_pcep_obj_explicit_route, length);\r\nbreak;\r\ncase PCEP_SUB_IPv6:\r\ndissect_subobj_ipv6(pcep_object_tree, pinfo, tvb, offset2, obj_class, ett_pcep_obj_explicit_route, length);\r\nbreak;\r\ncase PCEP_SUB_LABEL_CONTROL:\r\ndissect_subobj_label_control(pcep_object_tree, pinfo, tvb, offset2, obj_class, ett_pcep_obj_explicit_route, length);\r\nbreak;\r\ncase PCEP_SUB_UNNUMB_INTERFACE_ID:\r\ndissect_subobj_unnumb_interfaceID(pcep_object_tree, pinfo, tvb, offset2, obj_class, ett_pcep_obj_explicit_route, length);\r\nbreak;\r\ncase PCEP_SUB_AUTONOMOUS_SYS_NUM:\r\ndissect_subobj_autonomous_sys_num(pcep_object_tree, pinfo, tvb, offset2, obj_class, ett_pcep_obj_explicit_route, length);\r\nbreak;\r\ncase PCEP_SUB_PKSv4:\r\ndissect_subobj_pksv4(pcep_object_tree, pinfo, tvb, offset2, ett_pcep_obj_explicit_route, length);\r\nbreak;\r\ncase PCEP_SUB_SR_PRE_IANA:\r\ncase PCEP_SUB_SR:\r\ndissect_subobj_sr(pcep_object_tree, pinfo, tvb, offset2, obj_class, ett_pcep_obj_explicit_route, length);\r\nbreak;\r\ndefault:\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_non_defined_subobject,\r\ntvb, offset2, length,\r\n"Non defined subobject (%d)", type_exp_route);\r\nbreak;\r\n}\r\noffset2 += length;\r\nbody_obj_len -= length;\r\n}\r\n}\r\nstatic void\r\ndissect_pcep_record_route_obj(proto_tree *pcep_object_tree, packet_info *pinfo, tvbuff_t *tvb, int offset2, int obj_length, int obj_class)\r\n{\r\nguint8 type;\r\nguint8 length;\r\nguint body_obj_len;\r\nbody_obj_len = obj_length - OBJ_HDR_LEN;\r\nwhile (body_obj_len) {\r\nif (body_obj_len < 2) {\r\nexpert_add_info_format(pinfo, pcep_object_tree, &ei_pcep_subobject_bad_length,\r\n"Bad RRO object: subobject goes past end of object");\r\nbreak;\r\n}\r\ntype = tvb_get_guint8(tvb, offset2);\r\nlength = tvb_get_guint8(tvb, offset2+1);\r\nif (length < 2) {\r\nexpert_add_info_format(pinfo, pcep_object_tree, &ei_pcep_subobject_bad_length,\r\n"Bad RRO object: subobject length %u < 2", length);\r\nbreak;\r\n}\r\nif (body_obj_len <length) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, length,\r\n"Bad RRO subobject: subobject length %u > remaining length %u",\r\nlength, body_obj_len);\r\nbreak;\r\n}\r\nswitch (type) {\r\ncase PCEP_SUB_IPv4:\r\ndissect_subobj_ipv4(pcep_object_tree, pinfo, tvb, offset2, obj_class, ett_pcep_obj_record_route, length);\r\nbreak;\r\ncase PCEP_SUB_IPv6:\r\ndissect_subobj_ipv6(pcep_object_tree, pinfo, tvb, offset2, obj_class, ett_pcep_obj_record_route, length);\r\nbreak;\r\ncase PCEP_SUB_LABEL_CONTROL:\r\ndissect_subobj_label_control(pcep_object_tree, pinfo, tvb, offset2, obj_class, ett_pcep_obj_record_route, length);\r\nbreak;\r\ncase PCEP_SUB_UNNUMB_INTERFACE_ID:\r\ndissect_subobj_unnumb_interfaceID(pcep_object_tree, pinfo, tvb, offset2, obj_class, ett_pcep_obj_record_route, length);\r\nbreak;\r\ndefault:\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_non_defined_subobject,\r\ntvb, offset2, length,\r\n"Non defined subobject (%d)", type);\r\nbreak;\r\n}\r\noffset2 += length;\r\nbody_obj_len -= length;\r\n}\r\n}\r\nstatic void\r\ndissect_pcep_lspa_obj(proto_tree *pcep_object_tree, packet_info *pinfo, tvbuff_t *tvb, int offset2, int obj_length)\r\n{\r\nproto_tree *pcep_lspa_obj_flags;\r\nproto_item *ti;\r\nif (obj_length < OBJ_HDR_LEN+LSPA_OBJ_MIN_LEN) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, obj_length,\r\n"Bad LSPA object length %u, should be >= %u",\r\nobj_length, OBJ_HDR_LEN+LSPA_OBJ_MIN_LEN);\r\nreturn;\r\n}\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_lspa_obj_exclude_any, tvb, offset2, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_lspa_obj_include_any, tvb, offset2+4, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_lspa_obj_include_all, tvb, offset2+8, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_lspa_obj_setup_priority, tvb, offset2+12, 1, ENC_NA);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_lspa_obj_holding_priority, tvb, offset2+13, 1, ENC_NA);\r\nti = proto_tree_add_item(pcep_object_tree, hf_pcep_lspa_obj_flags, tvb, offset2+14, 1, ENC_NA);\r\npcep_lspa_obj_flags = proto_item_add_subtree(ti, ett_pcep_obj_metric);\r\nproto_tree_add_item(pcep_lspa_obj_flags, hf_pcep_lspa_flags_l, tvb, offset2+14, 1, ENC_NA);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_lspa_obj_reserved, tvb, offset2+15, 1, ENC_NA);\r\noffset2 += LSPA_OBJ_MIN_LEN;\r\nobj_length -= OBJ_HDR_LEN+LSPA_OBJ_MIN_LEN;\r\ndissect_pcep_tlvs(pcep_object_tree, tvb, offset2, obj_length, ett_pcep_obj_lspa);\r\n}\r\nstatic void\r\ndissect_pcep_iro_obj(proto_tree *pcep_object_tree, packet_info *pinfo,\r\ntvbuff_t *tvb, int offset2, int obj_length, int obj_class)\r\n{\r\nguint8 l_type;\r\nguint8 length;\r\nint type_iro;\r\nguint body_obj_len;\r\nbody_obj_len = obj_length - OBJ_HDR_LEN;\r\nwhile (body_obj_len) {\r\nif (body_obj_len < 2) {\r\nexpert_add_info_format(pinfo, pcep_object_tree, &ei_pcep_subobject_bad_length,\r\n"Bad IRO object: subobject goes past end of object");\r\nbreak;\r\n}\r\nl_type = tvb_get_guint8(tvb, offset2);\r\nlength = tvb_get_guint8(tvb, offset2+1);\r\nif (length < 2) {\r\nexpert_add_info_format(pinfo, pcep_object_tree, &ei_pcep_subobject_bad_length,\r\n"Bad IRO object: subobject length %u < 2", length);\r\nbreak;\r\n}\r\ntype_iro = (l_type & Mask_Type);\r\nif (body_obj_len <length) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, length,\r\n"Bad IRO object: subobject length %u > remaining length %u",\r\nlength, body_obj_len);\r\nbreak;\r\n}\r\nswitch (type_iro) {\r\ncase PCEP_SUB_IPv4:\r\ndissect_subobj_ipv4(pcep_object_tree, pinfo, tvb, offset2, obj_class, ett_pcep_obj_iro, length);\r\nbreak;\r\ncase PCEP_SUB_IPv6:\r\ndissect_subobj_ipv6(pcep_object_tree, pinfo, tvb, offset2, obj_class, ett_pcep_obj_iro, length);\r\nbreak;\r\ncase PCEP_SUB_UNNUMB_INTERFACE_ID:\r\ndissect_subobj_unnumb_interfaceID(pcep_object_tree, pinfo, tvb, offset2, obj_class, ett_pcep_obj_iro, length);\r\nbreak;\r\ncase PCEP_SUB_AUTONOMOUS_SYS_NUM:\r\ndissect_subobj_autonomous_sys_num(pcep_object_tree, pinfo, tvb, offset2, obj_class, ett_pcep_obj_iro, length);\r\nbreak;\r\ncase PCEP_SUB_EXRS:\r\ndissect_subobj_exrs(pcep_object_tree, pinfo, tvb, offset2, obj_class, ett_pcep_obj_iro, type_iro, length);\r\nbreak;\r\ndefault:\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_non_defined_subobject,\r\ntvb, offset2, length,\r\n"Non defined subobject (%d)", type_iro);\r\nbreak;\r\n}\r\noffset2 += length;\r\nbody_obj_len -= length;\r\n}\r\n}\r\nstatic void\r\ndissect_pcep_svec_obj(proto_tree *pcep_object_tree, packet_info *pinfo,\r\ntvbuff_t *tvb, int offset2, int obj_length)\r\n{\r\nproto_item *ti;\r\nproto_tree *pcep_svec_flags_obj;\r\nint m;\r\nint i;\r\nguint32 requestID;\r\nif (obj_length < OBJ_HDR_LEN+SVEC_OBJ_MIN_LEN) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, obj_length,\r\n"Bad SVEC object length %u, should be >= %u",\r\nobj_length, OBJ_HDR_LEN+SVEC_OBJ_MIN_LEN);\r\nreturn;\r\n}\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_svec_obj_reserved, tvb, offset2, 1, ENC_NA);\r\nti = proto_tree_add_item(pcep_object_tree, hf_pcep_svec_obj_flags, tvb, offset2+1, 3, ENC_BIG_ENDIAN);\r\npcep_svec_flags_obj = proto_item_add_subtree(ti, ett_pcep_obj_svec);\r\nproto_tree_add_item(pcep_svec_flags_obj, hf_pcep_svec_flags_l, tvb, offset2 + 1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_svec_flags_obj, hf_pcep_svec_flags_n, tvb, offset2 + 1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_svec_flags_obj, hf_pcep_svec_flags_s, tvb, offset2 + 1, 3, ENC_BIG_ENDIAN);\r\nm = 1;\r\nfor ( i=4 ; i<(obj_length-OBJ_HDR_LEN) ; ) {\r\nrequestID = tvb_get_ntohl(tvb, offset2+i);\r\nproto_tree_add_uint_format(pcep_object_tree, hf_pcep_svec_obj_request_id_number, tvb, offset2+i, 4, requestID,\r\n"Request-ID-Number %u: 0x%x", m++, requestID);\r\ni += 4;\r\n}\r\n}\r\nstatic void\r\ndissect_pcep_notification_obj(proto_tree *pcep_object_tree, packet_info *pinfo, tvbuff_t *tvb, int offset2, int obj_length)\r\n{\r\nguint8 nt;\r\nif (obj_length < OBJ_HDR_LEN+NOTIFICATION_OBJ_MIN_LEN) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, obj_length,\r\n"Bad NOTIFICATION object length %u, should be >= %u",\r\nobj_length, OBJ_HDR_LEN+NOTIFICATION_OBJ_MIN_LEN);\r\nreturn;\r\n}\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_notification_obj_reserved, tvb, offset2, 1, ENC_NA);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_notification_obj_flags, tvb, offset2+1, 1, ENC_NA);\r\nnt = tvb_get_guint8(tvb, offset2+2);\r\nproto_tree_add_item(pcep_object_tree, hf_PCEPF_NOTI_TYPE, tvb, offset2+2, 1, ENC_NA);\r\nswitch (nt) {\r\ncase 1:\r\nproto_tree_add_item(pcep_object_tree, hf_PCEPF_NOTI_VAL1, tvb, offset2+2, 1, ENC_NA);\r\nbreak;\r\ncase 2:\r\nproto_tree_add_item(pcep_object_tree, hf_PCEPF_NOTI_VAL2, tvb, offset2+2, 1, ENC_NA);\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_notification_obj_type, tvb, offset2+2, 1, ENC_NA);\r\nbreak;\r\n}\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_notification_obj_value, tvb, offset2+3, 1, ENC_NA);\r\noffset2 += NOTIFICATION_OBJ_MIN_LEN;\r\nobj_length -= OBJ_HDR_LEN+NOTIFICATION_OBJ_MIN_LEN;\r\ndissect_pcep_tlvs(pcep_object_tree, tvb, offset2, obj_length, ett_pcep_obj_notification);\r\n}\r\nstatic void\r\ndissect_pcep_error_obj(proto_tree *pcep_object_tree, packet_info *pinfo, tvbuff_t *tvb, int offset2, int obj_length)\r\n{\r\nguint8 error_type;\r\nguint8 error_value;\r\nproto_item* type_item;\r\nconst gchar *err_str = "Unassigned";\r\nif (obj_length < OBJ_HDR_LEN+ERROR_OBJ_MIN_LEN) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, obj_length,\r\n"Bad ERROR object length %u, should be >= %u",\r\nobj_length, OBJ_HDR_LEN+ERROR_OBJ_MIN_LEN);\r\nreturn;\r\n}\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_error_obj_reserved, tvb, offset2, 1, ENC_NA);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_error_obj_flags, tvb, offset2+1, 1, ENC_NA);\r\nerror_type = tvb_get_guint8(tvb, offset2+2);\r\nerror_value = tvb_get_guint8(tvb, offset2+3);\r\ntype_item = proto_tree_add_item(pcep_object_tree, hf_PCEPF_ERROR_TYPE, tvb, offset2+2, 1, ENC_NA);\r\nswitch (error_type) {\r\ncase ESTABLISH_FAILURE:\r\nerr_str = val_to_str_const(error_value, pcep_error_value_1_vals, "Unknown");\r\nbreak;\r\ncase CAP_NOT_SUPPORTED:\r\nbreak;\r\ncase UNKNOWN_OBJ:\r\nerr_str = val_to_str_const(error_value, pcep_error_value_3_vals, "Unknown");\r\nbreak;\r\ncase NOT_SUPP_OBJ:\r\nerr_str = val_to_str_const(error_value, pcep_error_value_4_vals, "Unknown");\r\nbreak;\r\ncase POLICY_VIOLATION:\r\nerr_str = val_to_str_const(error_value, pcep_error_value_5_vals, "Unknown");\r\nbreak;\r\ncase MANDATORY_OBJ_MIS:\r\nerr_str = val_to_str_const(error_value, pcep_error_value_6_vals, "Unknown");\r\nbreak;\r\ncase SYNCH_PCREQ_MIS:\r\nbreak;\r\ncase UNKNOWN_REQ_REF:\r\nbreak;\r\ncase ATTEMPT_2_SESSION:\r\nbreak;\r\ncase INVALID_OBJ:\r\nerr_str = val_to_str_const(error_value, pcep_error_value_10_vals, "Unknown");\r\nbreak;\r\ncase UNRECO_EXRS_SUBOBJ:\r\nbreak;\r\ncase DIFFSERV_TE_ERROR:\r\nerr_str = val_to_str_const(error_value, pcep_error_value_12_vals, "Unknown");\r\nbreak;\r\ncase BRPC_FAILURE:\r\nerr_str = val_to_str_const(error_value, pcep_error_value_13_vals, "Unknown");\r\nbreak;\r\ncase GCO_ERROR:\r\nerr_str = val_to_str_const(error_value, pcep_error_value_15_vals, "Unknown");\r\nbreak;\r\ncase P2MP_CAPABILITY_ERROR:\r\nerr_str = val_to_str_const(error_value, pcep_error_value_16_vals, "Unknown");\r\nbreak;\r\ncase P2MP_END_POINTS_ERROR:\r\nerr_str = val_to_str_const(error_value, pcep_error_value_17_vals, "Unknown");\r\nbreak;\r\ncase P2MP_FRAGMENT_ERROR:\r\nerr_str = val_to_str_const(error_value, pcep_error_value_18_vals, "Unknown");\r\nbreak;\r\ncase INVALID_OPERATION:\r\nerr_str = val_to_str_const(error_value, pcep_error_value_19_vals, "Unknown");\r\nbreak;\r\ncase LSP_STATE_SYNCHRONIZATION_ERROR:\r\nerr_str = val_to_str_const(error_value, pcep_error_value_20_vals, "Unknown");\r\nbreak;\r\ncase INVALID_PATH_SETUP_TYPE:\r\nerr_str = val_to_str_const(error_value, pcep_error_value_21_vals, "Unknown");\r\nbreak;\r\ncase BAD_PARAMETER_VALUE:\r\nerr_str = val_to_str_const(error_value, pcep_error_value_23_vals, "Unknown");\r\nbreak;\r\ncase LSP_INSTANTIATION_ERROR:\r\nerr_str = val_to_str_const(error_value, pcep_error_value_24_vals, "Unknown");\r\nbreak;\r\ndefault:\r\nproto_item_append_text(type_item, " (%u Non defined Error-Value)", error_type);\r\n}\r\nproto_tree_add_uint_format_value(pcep_object_tree, hf_PCEPF_ERROR_VALUE, tvb, offset2+3, 1, error_value, "%s (%u)", err_str, error_value);\r\noffset2 += ERROR_OBJ_MIN_LEN;\r\nobj_length -= OBJ_HDR_LEN+ERROR_OBJ_MIN_LEN;\r\ndissect_pcep_tlvs(pcep_object_tree, tvb, offset2, obj_length, ett_pcep_obj_error);\r\n}\r\nstatic void\r\ndissect_pcep_balancing_obj(proto_tree *pcep_object_tree, packet_info *pinfo, tvbuff_t *tvb, int offset2, int obj_length)\r\n{\r\nif (obj_length != OBJ_HDR_LEN+LOAD_BALANCING_OBJ_LEN) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, obj_length,\r\n"Bad LOAD-BALANCING object length %u, should be %u",\r\nobj_length, OBJ_HDR_LEN+LOAD_BALANCING_OBJ_LEN);\r\nreturn;\r\n}\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_balancing_obj_reserved, tvb, offset2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_balancing_obj_flags, tvb, offset2+2, 1, ENC_NA);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_balancing_obj_maximum_number_of_te_lsps, tvb, offset2+3, 1, ENC_NA);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_balancing_obj_minimum_bandwidth, tvb, offset2+4, 4, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_pcep_close_obj(proto_tree *pcep_object_tree, packet_info *pinfo, tvbuff_t *tvb, int offset2, int obj_length)\r\n{\r\nif (obj_length < OBJ_HDR_LEN+CLOSE_OBJ_MIN_LEN) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, obj_length,\r\n"Bad CLOSE object length %u, should be >= %u",\r\nobj_length, OBJ_HDR_LEN+CLOSE_OBJ_MIN_LEN);\r\nreturn;\r\n}\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_close_obj_reserved, tvb, offset2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_close_obj_flags, tvb, offset2+2, 1, ENC_NA);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_close_obj_reason, tvb, offset2+3, 1, ENC_NA);\r\noffset2 += CLOSE_OBJ_MIN_LEN;\r\nobj_length -= OBJ_HDR_LEN+CLOSE_OBJ_MIN_LEN;\r\ndissect_pcep_tlvs(pcep_object_tree, tvb, offset2, obj_length, ett_pcep_obj_load_balancing);\r\n}\r\nstatic void\r\ndissect_pcep_path_key_obj(proto_tree *pcep_object_tree, packet_info *pinfo,\r\ntvbuff_t *tvb, int offset2, int obj_length)\r\n{\r\nguint8 l_type;\r\nguint8 length;\r\nguint type_exp_route;\r\nguint body_obj_len;\r\nbody_obj_len = obj_length - OBJ_HDR_LEN;\r\nwhile (body_obj_len) {\r\nif (body_obj_len < 2) {\r\nexpert_add_info_format(pinfo, pcep_object_tree, &ei_pcep_subobject_bad_length,\r\n"Bad PATH-KEY object: subobject goes past end of object");\r\nbreak;\r\n}\r\nl_type = tvb_get_guint8(tvb, offset2);\r\nlength = tvb_get_guint8(tvb, offset2+1);\r\nif (length < 2) {\r\nexpert_add_info_format(pinfo, pcep_object_tree, &ei_pcep_subobject_bad_length,\r\n"Bad PATH-KEY object: subobject length %u < 2", length);\r\nbreak;\r\n}\r\ntype_exp_route = (l_type & Mask_Type);\r\nif (body_obj_len <length) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, length,\r\n"Bad PATH-KEY object: subobject length %u > remaining length %u",\r\nlength, body_obj_len);\r\nbreak;\r\n}\r\nswitch (type_exp_route) {\r\ncase PCEP_SUB_PKSv4:\r\ndissect_subobj_pksv4(pcep_object_tree, pinfo, tvb, offset2, ett_pcep_obj_explicit_route, length);\r\nbreak;\r\ndefault:\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_non_defined_subobject,\r\ntvb, offset2, length,\r\n"Non defined subobject (%d)", type_exp_route);\r\nbreak;\r\n}\r\noffset2 += length;\r\nbody_obj_len -= length;\r\n}\r\n}\r\nstatic void\r\ndissect_pcep_xro_obj(proto_tree *pcep_object_tree, packet_info *pinfo, tvbuff_t *tvb, int offset2, int obj_length, int obj_class)\r\n{\r\nproto_tree *pcep_xro_flags_obj;\r\nproto_item *ti;\r\nguint8 x_type;\r\nguint8 length;\r\nguint type_xro;\r\nguint body_obj_len;\r\nbody_obj_len = obj_length - OBJ_HDR_LEN;\r\nif (obj_length < OBJ_HDR_LEN+XRO_OBJ_MIN_LEN) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, obj_length,\r\n"Bad XRO object length %u, should be >= %u",\r\nobj_length, OBJ_HDR_LEN+XRO_OBJ_MIN_LEN);\r\nreturn;\r\n}\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_xro_obj_reserved, tvb, offset2, 2, ENC_BIG_ENDIAN);\r\nti = proto_tree_add_item(pcep_object_tree, hf_pcep_xro_obj_flags, tvb, offset2+2, 2, ENC_BIG_ENDIAN);\r\npcep_xro_flags_obj = proto_item_add_subtree(ti, ett_pcep_obj_xro);\r\nproto_tree_add_item(pcep_xro_flags_obj, hf_pcep_xro_flags_f, tvb, offset2 + 2, 2, ENC_BIG_ENDIAN);\r\noffset2 += XRO_OBJ_MIN_LEN;\r\nbody_obj_len -= XRO_OBJ_MIN_LEN;\r\nwhile (body_obj_len >= 2) {\r\nif (body_obj_len < 2) {\r\nexpert_add_info_format(pinfo, pcep_object_tree, &ei_pcep_subobject_bad_length,\r\n"Bad XRO object: subobject goes past end of object");\r\nbreak;\r\n}\r\nx_type = tvb_get_guint8(tvb, offset2);\r\nlength = tvb_get_guint8(tvb, offset2+1);\r\nif (length < 2) {\r\nexpert_add_info_format(pinfo, pcep_object_tree, &ei_pcep_subobject_bad_length,\r\n"Bad XRO object: object length %u < 2", length);\r\nbreak;\r\n}\r\ntype_xro = (x_type & Mask_Type);\r\nif (body_obj_len <length) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, length,\r\n"Bad XRO object: object length %u > remaining length %u",\r\nlength, body_obj_len);\r\nbreak;\r\n}\r\nswitch (type_xro) {\r\ncase PCEP_SUB_IPv4:\r\ndissect_subobj_ipv4(pcep_object_tree, pinfo, tvb, offset2, obj_class, ett_pcep_obj_xro, length);\r\nbreak;\r\ncase PCEP_SUB_IPv6:\r\ndissect_subobj_ipv6(pcep_object_tree, pinfo, tvb, offset2, obj_class, ett_pcep_obj_xro, length);\r\nbreak;\r\ncase PCEP_SUB_UNNUMB_INTERFACE_ID:\r\ndissect_subobj_unnumb_interfaceID(pcep_object_tree, pinfo, tvb, offset2, obj_class, ett_pcep_obj_xro, length);\r\nbreak;\r\ncase PCEP_SUB_AUTONOMOUS_SYS_NUM:\r\ndissect_subobj_autonomous_sys_num(pcep_object_tree, pinfo, tvb, offset2, obj_class, ett_pcep_obj_xro, length);\r\nbreak;\r\ncase PCEP_SUB_SRLG:\r\ndissect_subobj_srlg(pcep_object_tree, pinfo, tvb, offset2, ett_pcep_obj_xro, length);\r\nbreak;\r\ncase PCEP_SUB_PKSv4:\r\ndissect_subobj_pksv4(pcep_object_tree, pinfo, tvb, offset2, ett_pcep_obj_xro, length);\r\nbreak;\r\ncase PCEP_SUB_PKSv6:\r\ndissect_subobj_pksv6(pcep_object_tree, pinfo, tvb, offset2, ett_pcep_obj_xro, length);\r\nbreak;\r\ndefault:\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_non_defined_subobject,\r\ntvb, offset2-4, length,\r\n"Non defined subobject (%d)", type_xro);\r\nbreak;\r\n}\r\noffset2 += length;\r\nbody_obj_len -= length;\r\n}\r\n}\r\nstatic void\r\ndissect_pcep_obj_monitoring(proto_tree *pcep_object_tree, packet_info *pinfo, tvbuff_t *tvb, int offset2, int obj_length)\r\n{\r\nproto_item *ti;\r\nproto_tree *monitoring_flags;\r\nif (obj_length < OBJ_HDR_LEN + OBJ_MONITORING_MIN_LEN) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, obj_length,\r\n"Bad MONITORING object length %u, should be >= %u",\r\nobj_length, OBJ_HDR_LEN + OBJ_MONITORING_MIN_LEN);\r\nreturn;\r\n}\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_obj_monitoring_reserved, tvb, offset2, 1, ENC_NA);\r\nti = proto_tree_add_item(pcep_object_tree, hf_pcep_obj_monitoring_flags, tvb, offset2+1, 3, ENC_BIG_ENDIAN);\r\nmonitoring_flags = proto_item_add_subtree(ti, ett_pcep_obj_monitoring);\r\nproto_tree_add_item(monitoring_flags, hf_pcep_obj_monitoring_flags_reserved, tvb, offset2 + 1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(monitoring_flags, hf_pcep_obj_monitoring_flags_i, tvb, offset2 + 1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(monitoring_flags, hf_pcep_obj_monitoring_flags_c, tvb, offset2 + 1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(monitoring_flags, hf_pcep_obj_monitoring_flags_p, tvb, offset2 + 1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(monitoring_flags, hf_pcep_obj_monitoring_flags_g, tvb, offset2 + 1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(monitoring_flags, hf_pcep_obj_monitoring_flags_l, tvb, offset2 + 1, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_obj_monitoring_monitoring_id_number, tvb, offset2 + 4, 4, ENC_BIG_ENDIAN);\r\noffset2 += OBJ_MONITORING_MIN_LEN;\r\nobj_length -= OBJ_HDR_LEN + OBJ_MONITORING_MIN_LEN;\r\ndissect_pcep_tlvs(pcep_object_tree, tvb, offset2, obj_length, ett_pcep_obj_monitoring);\r\n}\r\nstatic void\r\ndissect_pcep_obj_pcc_id_req(proto_tree *pcep_object_tree, packet_info *pinfo, tvbuff_t *tvb, int offset2, int obj_length, int type)\r\n{\r\nswitch (type)\r\n{\r\ncase PCEP_OBJ_PCC_ID_REQ_IPv4:\r\nif (obj_length != OBJ_HDR_LEN + OBJ_PCC_ID_REQ_IPV4_LEN) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, obj_length,\r\n"Bad IPv4 PCC-ID-REQ object length %u, should be %u",\r\nobj_length, OBJ_HDR_LEN + OBJ_PCC_ID_REQ_IPV4_LEN);\r\nreturn;\r\n}\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_obj_pcc_id_req_ipv4, tvb, offset2, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase PCEP_OBJ_PCC_ID_REQ_IPv6:\r\nif (obj_length != OBJ_HDR_LEN + OBJ_PCC_ID_REQ_IPV6_LEN) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, obj_length,\r\n"Bad IPv6 PCC-ID-REQ object length %u, should be %u",\r\nobj_length, OBJ_HDR_LEN + OBJ_PCC_ID_REQ_IPV6_LEN);\r\nreturn;\r\n}\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_obj_pcc_id_req_ipv6, tvb, offset2, 16, ENC_NA);\r\nbreak;\r\ndefault:\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_non_defined_subobject,\r\ntvb, offset2, obj_length - OBJ_HDR_LEN,\r\n"UNKNOWN Type Object (%u)", type);\r\nbreak;\r\n}\r\n}\r\nstatic void\r\ndissect_pcep_of_obj(proto_tree *pcep_object_tree, packet_info *pinfo, tvbuff_t *tvb, int offset2, int obj_length)\r\n{\r\nif (obj_length < OBJ_HDR_LEN+OF_OBJ_MIN_LEN) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, obj_length,\r\n"Bad OF object length %u, should be >= %u",\r\nobj_length, OBJ_HDR_LEN+OF_OBJ_MIN_LEN);\r\nreturn;\r\n}\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_obj_of_code, tvb, offset2, 2, ENC_BIG_ENDIAN);\r\noffset2 += OPEN_OBJ_MIN_LEN;\r\nobj_length -= OBJ_HDR_LEN+OF_OBJ_MIN_LEN;\r\ndissect_pcep_tlvs(pcep_object_tree, tvb, offset2, obj_length, ett_pcep_obj_open);\r\n}\r\nstatic void\r\ndissect_pcep_obj_pce_id(proto_tree *pcep_object_tree, packet_info *pinfo, tvbuff_t *tvb, int offset2, int obj_length, int type)\r\n{\r\nswitch (type)\r\n{\r\ncase PCEP_OBJ_PCE_ID_IPv4:\r\nif (obj_length != OBJ_HDR_LEN + OBJ_PCE_ID_IPV4_LEN) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, obj_length,\r\n"Bad IPv4 PCE-ID object length %u, should be %u",\r\nobj_length, OBJ_HDR_LEN + OBJ_PCE_ID_IPV4_LEN);\r\nreturn;\r\n}\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_obj_pce_id_ipv4, tvb, offset2, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase PCEP_OBJ_PCE_ID_IPv6:\r\nif (obj_length != OBJ_HDR_LEN + OBJ_PCE_ID_IPV6_LEN) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, obj_length,\r\n"Bad IPv6 PCE-ID object length %u, should be %u",\r\nobj_length, OBJ_HDR_LEN + OBJ_PCE_ID_IPV6_LEN);\r\nreturn;\r\n}\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_obj_pce_id_ipv6, tvb, offset2, 16, ENC_NA);\r\nbreak;\r\ndefault:\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_non_defined_subobject,\r\ntvb, offset2, obj_length - OBJ_HDR_LEN,\r\n"UNKNOWN Type Object (%u)", type);\r\nbreak;\r\n}\r\n}\r\nstatic void\r\ndissect_pcep_obj_proc_time(proto_tree *pcep_object_tree, packet_info *pinfo, tvbuff_t *tvb, int offset2, int obj_length)\r\n{\r\nproto_item *ti;\r\nproto_tree *proc_time_flags;\r\nif (obj_length != OBJ_HDR_LEN + OBJ_PROC_TIME_LEN) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, obj_length,\r\n"Bad PROC-TIME object length %u, should be %u",\r\nobj_length, OBJ_HDR_LEN + OBJ_PROC_TIME_LEN);\r\nreturn;\r\n}\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_obj_proc_time_reserved, tvb, offset2, 2, ENC_BIG_ENDIAN);\r\nti = proto_tree_add_item(pcep_object_tree, hf_pcep_obj_proc_time_flags, tvb, offset2 + 2, 2, ENC_BIG_ENDIAN);\r\nproc_time_flags = proto_item_add_subtree(ti, ett_pcep_obj_proc_time);\r\nproto_tree_add_item(proc_time_flags, hf_pcep_obj_proc_time_flags_reserved, tvb, offset2 + 2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(proc_time_flags, hf_pcep_obj_proc_time_flags_e, tvb, offset2 + 2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_obj_proc_time_cur_proc_time, tvb, offset2 + 4, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_obj_proc_time_min_proc_time, tvb, offset2 + 8, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_obj_proc_time_max_proc_time, tvb, offset2 + 12, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_obj_proc_time_ave_proc_time, tvb, offset2 + 16, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_obj_proc_time_var_proc_time, tvb, offset2 + 20, 4, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_pcep_obj_overload(proto_tree *pcep_object_tree, packet_info *pinfo, tvbuff_t *tvb, int offset2, int obj_length)\r\n{\r\nif (obj_length != OBJ_HDR_LEN + OBJ_OVERLOAD_LEN) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, obj_length,\r\n"Bad OVERLOAD object length %u, should be %u",\r\nobj_length, OBJ_HDR_LEN + OBJ_OVERLOAD_LEN);\r\nreturn;\r\n}\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_obj_overload_flags, tvb, offset2, 1, ENC_NA);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_obj_overload_reserved, tvb, offset2 + 1, 1, ENC_NA);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_obj_overload_duration, tvb, offset2 + 2, 2, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_pcep_obj_lsp(proto_tree *pcep_object_tree, packet_info *pinfo, tvbuff_t *tvb, int offset2, int obj_length)\r\n{\r\nproto_item *ti;\r\nproto_tree *lsp_flags;\r\nif (obj_length < OBJ_HDR_LEN + OBJ_LSP_MIN_LEN) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, obj_length,\r\n"Bad LSP object length %u, should >= %u",\r\nobj_length, OBJ_HDR_LEN + OBJ_LSP_MIN_LEN);\r\nreturn;\r\n}\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_obj_lsp_plsp_id, tvb, offset2, 3, ENC_BIG_ENDIAN);\r\nti = proto_tree_add_item(pcep_object_tree, hf_pcep_obj_lsp_flags, tvb, offset2+2, 2, ENC_BIG_ENDIAN);\r\nlsp_flags = proto_item_add_subtree(ti, ett_pcep_obj_lsp);\r\nproto_tree_add_item(lsp_flags, hf_pcep_obj_lsp_flags_d, tvb, offset2+2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(lsp_flags, hf_pcep_obj_lsp_flags_s, tvb, offset2+2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(lsp_flags, hf_pcep_obj_lsp_flags_r, tvb, offset2+2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(lsp_flags, hf_pcep_obj_lsp_flags_a, tvb, offset2+2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(lsp_flags, hf_pcep_obj_lsp_flags_o, tvb, offset2+2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(lsp_flags, hf_pcep_obj_lsp_flags_c, tvb, offset2+2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(lsp_flags, hf_pcep_obj_lsp_flags_reserved, tvb, offset2+2, 2, ENC_BIG_ENDIAN);\r\noffset2 += OBJ_LSP_MIN_LEN;\r\nobj_length -= OBJ_HDR_LEN + OBJ_LSP_MIN_LEN;\r\ndissect_pcep_tlvs(pcep_object_tree, tvb, offset2, obj_length, ett_pcep_obj_lsp);\r\n}\r\nstatic void\r\ndissect_pcep_obj_srp(proto_tree *pcep_object_tree, packet_info *pinfo, tvbuff_t *tvb, int offset2, int obj_length)\r\n{\r\nproto_item *ti;\r\nproto_tree *srp_flags;\r\nif (obj_length < OBJ_HDR_LEN + OBJ_SRP_MIN_LEN) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_subobject_bad_length,\r\ntvb, offset2, obj_length,\r\n"Bad SRP object length %u, should >= %u",\r\nobj_length, OBJ_HDR_LEN + OBJ_SRP_MIN_LEN);\r\nreturn;\r\n}\r\nti = proto_tree_add_item(pcep_object_tree, hf_pcep_obj_srp_flags, tvb, offset2, 4, ENC_BIG_ENDIAN);\r\nsrp_flags = proto_item_add_subtree(ti, ett_pcep_obj_srp);\r\nproto_tree_add_item(srp_flags, hf_pcep_obj_srp_flags_r, tvb, offset2, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_obj_srp_id_number, tvb, offset2 + 4, 4, ENC_BIG_ENDIAN);\r\noffset2 += OBJ_SRP_MIN_LEN;\r\nobj_length -= OBJ_HDR_LEN + OBJ_SRP_MIN_LEN;\r\ndissect_pcep_tlvs(pcep_object_tree, tvb, offset2, obj_length, ett_pcep_obj_srp);\r\n}\r\nstatic void\r\ndissect_pcep_association_obj(proto_tree *pcep_object_tree, packet_info *pinfo,\r\ntvbuff_t *tvb, int offset2, int obj_length, int type)\r\n{\r\nproto_tree *pcep_association_flags = NULL;\r\nproto_item *ti = NULL;\r\nif ((type == 1) &&\r\n(obj_length < OBJ_HDR_LEN + ASSOCIATION_OBJ_v4_MIN_LEN)) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo,\r\n&ei_pcep_subobject_bad_length,\r\ntvb, offset2, obj_length,\r\n"Bad ASSOCIATION IPv4 object length %u"\r\n", should be >= %u",\r\nobj_length,\r\nOBJ_HDR_LEN + ASSOCIATION_OBJ_v4_MIN_LEN);\r\nreturn;\r\n}\r\nif ((type == 2) &&\r\n(obj_length < OBJ_HDR_LEN + ASSOCIATION_OBJ_v6_MIN_LEN)) {\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo,\r\n&ei_pcep_subobject_bad_length,\r\ntvb, offset2, obj_length,\r\n"Bad ASSOCIATION IPv6 object length %u"\r\n", should be >= %u",\r\nobj_length,\r\nOBJ_HDR_LEN + ASSOCIATION_OBJ_v4_MIN_LEN);\r\nreturn;\r\n}\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_association_reserved,\r\ntvb, offset2, 2, ENC_NA);\r\noffset2 += 2;\r\nti = proto_tree_add_item(pcep_object_tree, hf_pcep_association_flags,\r\ntvb, offset2, 2, ENC_NA);\r\npcep_association_flags =\r\nproto_item_add_subtree(ti, ett_pcep_obj_association);\r\nproto_tree_add_item(pcep_association_flags, hf_pcep_association_flags_r,\r\ntvb, offset2, 2, ENC_NA);\r\noffset2 += 2;\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_association_type,\r\ntvb, offset2, 2, ENC_BIG_ENDIAN);\r\noffset2 += 2;\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_association_id,\r\ntvb, offset2, 2, ENC_BIG_ENDIAN);\r\noffset2 += 2;\r\nswitch (type) {\r\ncase 1:\r\nproto_tree_add_item(pcep_object_tree,\r\nhf_pcep_association_source_ipv4,\r\ntvb, offset2, 4, ENC_BIG_ENDIAN);\r\noffset2 += 4;\r\nobj_length -= OBJ_HDR_LEN + ASSOCIATION_OBJ_v4_MIN_LEN;\r\nbreak;\r\ncase 2:\r\nproto_tree_add_item(pcep_object_tree,\r\nhf_pcep_association_source_ipv6,\r\ntvb, offset2, 16, ENC_NA);\r\noffset2 += 16;\r\nobj_length -= OBJ_HDR_LEN + ASSOCIATION_OBJ_v6_MIN_LEN;\r\nbreak;\r\ndefault:\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo,\r\n&ei_pcep_non_defined_subobject,\r\ntvb, offset2, obj_length - OBJ_HDR_LEN,\r\n"Unknown Association Type (%u)", type);\r\nreturn;\r\n}\r\ndissect_pcep_tlvs(pcep_object_tree, tvb,\r\noffset2, obj_length, ett_pcep_obj_association);\r\n}\r\nstatic void\r\ndissect_pcep_obj_tree(proto_tree *pcep_tree, packet_info *pinfo, tvbuff_t *tvb, int len, int offset, int msg_length)\r\n{\r\nguint8 obj_class;\r\nguint8 ot_res_p_i;\r\nguint16 obj_length;\r\nint type;\r\nproto_tree *pcep_object_tree;\r\nproto_item *pcep_object_item;\r\nproto_tree *pcep_header_obj_flags;\r\nwhile (len < msg_length) {\r\nobj_class = tvb_get_guint8(tvb, offset);\r\nswitch (obj_class) {\r\ncase PCEP_OPEN_OBJ:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_OPEN, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_open);\r\nbreak;\r\ncase PCEP_RP_OBJ:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_RP, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_request_parameters);\r\nbreak;\r\ncase PCEP_NO_PATH_OBJ:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_NO_PATH, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_no_path);\r\nbreak;\r\ncase PCEP_END_POINT_OBJ:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_END_POINT, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_end_point);\r\nbreak;\r\ncase PCEP_BANDWIDTH_OBJ:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_BANDWIDTH, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_bandwidth);\r\nbreak;\r\ncase PCEP_METRIC_OBJ:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_METRIC, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_metric);\r\nbreak;\r\ncase PCEP_EXPLICIT_ROUTE_OBJ:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_EXPLICIT_ROUTE, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_explicit_route);\r\nbreak;\r\ncase PCEP_RECORD_ROUTE_OBJ:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_RECORD_ROUTE, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_record_route);\r\nbreak;\r\ncase PCEP_LSPA_OBJ:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_LSPA, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_lspa);\r\nbreak;\r\ncase PCEP_IRO_OBJ:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_IRO, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_iro);\r\nbreak;\r\ncase PCEP_SVEC_OBJ:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_SVEC, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_svec);\r\nbreak;\r\ncase PCEP_NOTIFICATION_OBJ:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_NOTIFICATION, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_notification);\r\nbreak;\r\ncase PCEP_PCEP_ERROR_OBJ:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_PCEP_ERROR, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_error);\r\nbreak;\r\ncase PCEP_LOAD_BALANCING_OBJ:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_LOAD_BALANCING, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_load_balancing);\r\nbreak;\r\ncase PCEP_CLOSE_OBJ:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_CLOSE, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_close);\r\nbreak;\r\ncase PCEP_PATH_KEY_OBJ:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_PATH_KEY, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_path_key);\r\nbreak;\r\ncase PCEP_XRO_OBJ:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_XRO, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_xro);\r\nbreak;\r\ncase PCEP_OBJ_MONITORING:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_MONITORING, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_monitoring);\r\nbreak;\r\ncase PCEP_OBJ_PCC_ID_REQ:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_PCC_ID_REQ, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_pcc_id_req);\r\nbreak;\r\ncase PCEP_OF_OBJ:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_OF, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_of);\r\nbreak;\r\ncase PCEP_OBJ_PCE_ID:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_PCE_ID, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_pce_id);\r\nbreak;\r\ncase PCEP_OBJ_PROC_TIME:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_PROC_TIME, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_proc_time);\r\nbreak;\r\ncase PCEP_OBJ_OVERLOAD:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_OVERLOAD, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_overload);\r\nbreak;\r\ncase PCEP_OBJ_LSP:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_LSP, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_lsp);\r\nbreak;\r\ncase PCEP_OBJ_SRP:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_SRP, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_srp);\r\nbreak;\r\ncase PCEP_SERO_OBJ:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_SERO, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_sero);\r\nbreak;\r\ncase PCEP_SRRO_OBJ:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_SRRO, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_srro);\r\nbreak;\r\ncase PCEP_ASSOCIATION_OBJ:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_ASSOCIATION, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_association);\r\nbreak;\r\ndefault:\r\npcep_object_item = proto_tree_add_item(pcep_tree, hf_PCEPF_OBJ_UNKNOWN_TYPE, tvb, offset, -1, ENC_NA);\r\npcep_object_tree = proto_item_add_subtree(pcep_object_item, ett_pcep_obj_unknown);\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_non_defined_object,\r\ntvb, offset, -1,\r\n"Unknown object (%u)", obj_class);\r\nbreak;\r\n}\r\nproto_tree_add_uint(pcep_object_tree, hf_PCEPF_OBJECT_CLASS, tvb, offset, 1, obj_class);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_object_type, tvb, offset+1, 1, ENC_NA);\r\not_res_p_i = tvb_get_guint8(tvb, offset+1);\r\ntype = (ot_res_p_i & MASK_OBJ_TYPE)>>4;\r\npcep_header_obj_flags = proto_tree_add_subtree(pcep_object_tree, tvb, offset+1, 1, ett_pcep_hdr, NULL, "Flags");\r\nproto_tree_add_item(pcep_header_obj_flags, hf_pcep_hdr_obj_flags_reserved, tvb, offset+1, 1, ENC_NA);\r\nproto_tree_add_item(pcep_header_obj_flags, hf_pcep_hdr_obj_flags_p, tvb, offset+1, 1, ENC_NA);\r\nproto_tree_add_item(pcep_header_obj_flags, hf_pcep_hdr_obj_flags_i, tvb, offset+1, 1, ENC_NA);\r\nproto_tree_add_item(pcep_object_tree, hf_pcep_object_length, tvb, offset+2, 2, ENC_BIG_ENDIAN);\r\nobj_length = tvb_get_ntohs(tvb, offset+2);\r\nproto_item_set_len(pcep_object_item, obj_length);\r\nif (obj_length < 4) {\r\nexpert_add_info_format(pinfo, pcep_object_tree, &ei_pcep_object_length,\r\n"Object Length: %u (bogus, must be >= 4)", obj_length);\r\nbreak;\r\n}\r\nswitch (obj_class) {\r\ncase PCEP_OPEN_OBJ:\r\ndissect_pcep_open_obj(pcep_object_tree, pinfo, tvb, offset+4, obj_length);\r\nbreak;\r\ncase PCEP_RP_OBJ:\r\ndissect_pcep_rp_obj(pcep_object_tree, pinfo, tvb, offset+4, obj_length);\r\nbreak;\r\ncase PCEP_NO_PATH_OBJ:\r\ndissect_pcep_no_path_obj(pcep_object_tree, pinfo, tvb, offset+4, obj_length);\r\nbreak;\r\ncase PCEP_END_POINT_OBJ:\r\ndissect_pcep_end_point_obj(pcep_object_tree, pinfo, tvb, offset+4, obj_length, type);\r\nbreak;\r\ncase PCEP_BANDWIDTH_OBJ:\r\ndissect_pcep_bandwidth_obj(pcep_object_tree, pinfo, tvb, offset+4, obj_length);\r\nbreak;\r\ncase PCEP_METRIC_OBJ:\r\ndissect_pcep_metric_obj(pcep_object_tree, pinfo, tvb, offset+4, obj_length);\r\nbreak;\r\ncase PCEP_EXPLICIT_ROUTE_OBJ:\r\ndissect_pcep_explicit_route_obj(pcep_object_tree, pinfo, tvb, offset+4, obj_length, obj_class);\r\nbreak;\r\ncase PCEP_RECORD_ROUTE_OBJ:\r\ndissect_pcep_record_route_obj(pcep_object_tree, pinfo, tvb, offset+4, obj_length, obj_class);\r\nbreak;\r\ncase PCEP_LSPA_OBJ:\r\ndissect_pcep_lspa_obj(pcep_object_tree, pinfo, tvb, offset+4, obj_length);\r\nbreak;\r\ncase PCEP_IRO_OBJ:\r\ndissect_pcep_iro_obj(pcep_object_tree, pinfo, tvb, offset+4, obj_length, obj_class);\r\nbreak;\r\ncase PCEP_SVEC_OBJ:\r\ndissect_pcep_svec_obj(pcep_object_tree, pinfo, tvb, offset+4, obj_length);\r\nbreak;\r\ncase PCEP_NOTIFICATION_OBJ:\r\ndissect_pcep_notification_obj(pcep_object_tree, pinfo, tvb, offset+4, obj_length);\r\nbreak;\r\ncase PCEP_PCEP_ERROR_OBJ:\r\ndissect_pcep_error_obj(pcep_object_tree, pinfo, tvb, offset+4, obj_length);\r\nbreak;\r\ncase PCEP_LOAD_BALANCING_OBJ:\r\ndissect_pcep_balancing_obj(pcep_object_tree, pinfo, tvb, offset+4, obj_length);\r\nbreak;\r\ncase PCEP_CLOSE_OBJ:\r\ndissect_pcep_close_obj(pcep_object_tree, pinfo, tvb, offset+4, obj_length);\r\nbreak;\r\ncase PCEP_PATH_KEY_OBJ:\r\ndissect_pcep_path_key_obj(pcep_object_tree, pinfo, tvb, offset+4, obj_length);\r\nbreak;\r\ncase PCEP_XRO_OBJ:\r\ndissect_pcep_xro_obj(pcep_object_tree, pinfo, tvb, offset+4, obj_length, obj_class);\r\nbreak;\r\ncase PCEP_OBJ_MONITORING:\r\ndissect_pcep_obj_monitoring(pcep_object_tree, pinfo, tvb, offset+4, obj_length);\r\nbreak;\r\ncase PCEP_OBJ_PCC_ID_REQ:\r\ndissect_pcep_obj_pcc_id_req(pcep_object_tree, pinfo, tvb, offset+4, obj_length, type);\r\nbreak;\r\ncase PCEP_OF_OBJ:\r\ndissect_pcep_of_obj(pcep_object_tree, pinfo, tvb, offset+4, obj_length);\r\nbreak;\r\ncase PCEP_OBJ_PCE_ID:\r\ndissect_pcep_obj_pce_id(pcep_object_tree, pinfo, tvb, offset+4, obj_length, type);\r\nbreak;\r\ncase PCEP_OBJ_PROC_TIME:\r\ndissect_pcep_obj_proc_time(pcep_object_tree, pinfo, tvb, offset+4, obj_length);\r\nbreak;\r\ncase PCEP_OBJ_OVERLOAD:\r\ndissect_pcep_obj_overload(pcep_object_tree, pinfo, tvb, offset+4, obj_length);\r\nbreak;\r\ncase PCEP_OBJ_LSP:\r\ndissect_pcep_obj_lsp(pcep_object_tree, pinfo, tvb, offset+4, obj_length);\r\nbreak;\r\ncase PCEP_OBJ_SRP:\r\ndissect_pcep_obj_srp(pcep_object_tree, pinfo, tvb, offset+4, obj_length);\r\nbreak;\r\ncase PCEP_SERO_OBJ:\r\ndissect_pcep_explicit_route_obj(pcep_object_tree, pinfo, tvb, offset+4, obj_length, obj_class);\r\nbreak;\r\ncase PCEP_SRRO_OBJ:\r\ndissect_pcep_record_route_obj(pcep_object_tree, pinfo, tvb, offset+4, obj_length, obj_class);\r\nbreak;\r\ncase PCEP_ASSOCIATION_OBJ:\r\ndissect_pcep_association_obj(pcep_object_tree, pinfo, tvb, offset + 4, obj_length, type);\r\nbreak;\r\ndefault:\r\nproto_tree_add_expert_format(pcep_object_tree, pinfo, &ei_pcep_pcep_object_body_non_defined,\r\ntvb, offset+4, obj_length-OBJ_HDR_LEN,\r\n"PCEP Object BODY non defined (%u)", type);\r\nbreak;\r\n}\r\noffset += obj_length;\r\nlen += obj_length;\r\n}\r\n}\r\nstatic void\r\ndissect_pcep_msg_tree(tvbuff_t *tvb, proto_tree *tree, guint tree_mode, packet_info *pinfo)\r\n{\r\nproto_tree *pcep_tree, *pcep_header_tree, *pcep_header_msg_flags;\r\nproto_item *ti;\r\nint offset = 0;\r\nint len = 0;\r\nguint8 message_type;\r\nguint16 msg_length;\r\nmessage_type = tvb_get_guint8(tvb, 1);\r\nmsg_length = tvb_get_ntohs(tvb, 2);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s", val_to_str(message_type, message_type_vals, "Unknown Message (%u). "));\r\nti = proto_tree_add_item(tree, proto_pcep, tvb, offset, msg_length, ENC_NA);\r\npcep_tree = proto_item_add_subtree(ti, tree_mode);\r\npcep_header_tree = proto_tree_add_subtree_format(pcep_tree, tvb, offset, 4, ett_pcep_hdr, NULL,\r\n"%s Header", val_to_str(message_type, message_type_vals, "Unknown Message (%u). "));\r\nproto_tree_add_item(pcep_header_tree, hf_pcep_version, tvb, offset, 1, ENC_NA);\r\nti = proto_tree_add_item(pcep_header_tree, hf_pcep_flags, tvb, offset, 1, ENC_NA);\r\npcep_header_msg_flags = proto_item_add_subtree(ti, ett_pcep_hdr);\r\nproto_tree_add_item(pcep_header_msg_flags, hf_pcep_hdr_msg_flags_reserved, tvb, offset, 1, ENC_NA);\r\nproto_tree_add_item(pcep_header_tree, hf_PCEPF_MSG, tvb, offset+1, 1, ENC_NA);\r\nproto_tree_add_item(pcep_header_tree, hf_pcep_message_length, tvb, offset+2, 2, ENC_BIG_ENDIAN);\r\noffset = 4;\r\nlen = 4;\r\ndissect_pcep_obj_tree(pcep_tree, pinfo, tvb, len, offset, msg_length);\r\n}\r\nstatic guint\r\nget_pcep_message_len(packet_info *pinfo _U_, tvbuff_t *tvb, int offset, void *data _U_)\r\n{\r\nguint16 plen;\r\nplen = tvb_get_ntohs(tvb, offset+2);\r\nreturn plen;\r\n}\r\nstatic int\r\ndissect_pcep_pdu(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "PCEP");\r\ncol_clear(pinfo->cinfo, COL_INFO);\r\ndissect_pcep_msg_tree(tvb, tree, ett_pcep, pinfo);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic int\r\ndissect_pcep(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data)\r\n{\r\ntcp_dissect_pdus(tvb, pinfo, tree, TRUE, 4, get_pcep_message_len,\r\ndissect_pcep_pdu, data);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_pcep(void)\r\n{\r\nstatic hf_register_info pcepf_info[] = {\r\n{ &hf_PCEPF_MSG,\r\n{ "Message Type", "pcep.msg",\r\nFT_UINT8, BASE_DEC, VALS(message_type_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_hdr_msg_flags_reserved,\r\n{ "Reserved Flags", "pcep.hdr.msg.flags.reserved",\r\nFT_BOOLEAN, 8, TFS(&tfs_set_notset), PCEP_HDR_MSG_RESERVED,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_hdr_obj_flags_reserved,\r\n{ "Reserved Flags", "pcep.hdr.obj.flags.reserved",\r\nFT_BOOLEAN, 4, TFS(&tfs_set_notset), PCEP_HDR_OBJ_RESERVED,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_hdr_obj_flags_p,\r\n{ "Processing-Rule (P)", "pcep.hdr.obj.flags.p",\r\nFT_BOOLEAN, 4, TFS(&tfs_set_notset), PCEP_HDR_OBJ_P,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_hdr_obj_flags_i,\r\n{ "Ignore (I)", "pcep.hdr.obj.flags.i",\r\nFT_BOOLEAN, 4, TFS(&tfs_set_notset), PCEP_HDR_OBJ_I,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJECT_CLASS,\r\n{ "Object Class", "pcep.object",\r\nFT_UINT32, BASE_DEC | BASE_EXT_STRING, &pcep_class_vals_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_endpoint_p2mp_leaf,\r\n{ "P2MP Leaf type", "pcep.obj.endpoint.p2mp.leaf",\r\nFT_UINT32, BASE_DEC, VALS(pcep_p2mp_leaf_type_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_OPEN,\r\n{ "OPEN object", "pcep.obj.open",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_open_flags_res,\r\n{ "Reserved Flags", "pcep.open.flags.res",\r\nFT_BOOLEAN, 8, TFS(&tfs_set_notset), PCEP_OPEN_RES,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_RP,\r\n{ "RP object", "pcep.obj.rp",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_rp_flags_reserved,\r\n{ "Reserved Flags", "pcep.rp.flags.reserved",\r\nFT_BOOLEAN, 24, TFS(&tfs_set_notset), PCEP_RP_RESERVED,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_rp_flags_pri,\r\n{ "(PRI) Priority", "pcep.rp.flags.pri",\r\nFT_BOOLEAN, 24, TFS(&tfs_on_off), PCEP_RP_PRI,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_rp_flags_r,\r\n{ "(R) Reoptimization", "pcep.rp.flags.r",\r\nFT_BOOLEAN, 24, TFS(&tfs_set_notset), PCEP_RP_R,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_rp_flags_b,\r\n{ "(B) Bi-directional", "pcep.rp.flags.b",\r\nFT_BOOLEAN, 24, TFS(&tfs_set_notset), PCEP_RP_B,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_rp_flags_o,\r\n{ "(L) Strict/Loose", "pcep.rp.flags.o",\r\nFT_BOOLEAN, 24, TFS(&tfs_set_notset), PCEP_RP_O,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_rp_flags_v,\r\n{ "(V) VSPT", "pcep.rp.flags.v",\r\nFT_BOOLEAN, 24, TFS(&tfs_set_notset), PCEP_RP_V,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_rp_flags_s,\r\n{ "(S) Supply OF on response", "pcep.rp.flags.s",\r\nFT_BOOLEAN, 24, TFS(&tfs_set_notset), PCEP_RP_S,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_rp_flags_p,\r\n{ "(P) Path Key", "pcep.rp.flags.p",\r\nFT_BOOLEAN, 24, TFS(&tfs_set_notset), PCEP_RP_P,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_rp_flags_d,\r\n{ "(D) Report the request order", "pcep.rp.flags.d",\r\nFT_BOOLEAN, 24, TFS(&tfs_set_notset), PCEP_RP_D,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_rp_flags_m,\r\n{ "(M) Make-before-break", "pcep.rp.flags.m",\r\nFT_BOOLEAN, 24, TFS(&tfs_set_notset), PCEP_RP_M,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_rp_flags_e,\r\n{ "(E) ERO-compression", "pcep.rp.flags.e",\r\nFT_BOOLEAN, 24, TFS(&tfs_set_notset), PCEP_RP_E,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_rp_flags_n,\r\n{ "(N) P2MP", "pcep.rp.flags.n",\r\nFT_BOOLEAN, 24, TFS(&tfs_set_notset), PCEP_RP_N,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_rp_flags_f,\r\n{ "(F) Fragmentation", "pcep.rp.flags.f",\r\nFT_BOOLEAN, 24, TFS(&tfs_set_notset), PCEP_RP_F,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_NO_PATH,\r\n{ "NO-PATH object", "pcep.obj.nopath",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_no_path_flags_c,\r\n{ "C", "pcep.no.path.flags.c",\r\nFT_BOOLEAN, 16, TFS(&tfs_set_notset), PCEP_NO_PATH_C,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_END_POINT,\r\n{ "END-POINT object", "pcep.obj.endpoint",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_BANDWIDTH,\r\n{ "BANDWIDTH object", "pcep.obj.bandwidth",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_METRIC,\r\n{ "METRIC object", "pcep.obj.metric",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_metric_flags_c,\r\n{ "(C) Cost", "pcep.metric.flags.c",\r\nFT_BOOLEAN, 8, TFS(&tfs_set_notset), PCEP_METRIC_C,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_metric_flags_b,\r\n{ "(B) Bound", "pcep.metric.flags.b",\r\nFT_BOOLEAN, 8, TFS(&tfs_set_notset), PCEP_METRIC_B,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_EXPLICIT_ROUTE,\r\n{ "EXPLICIT ROUTE object (ERO)", "pcep.obj.ero",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_SERO,\r\n{ "SECONDARY EXPLICIT ROUTE object (SERO)", "pcep.obj.sero",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_SRRO,\r\n{ "SECONDARY RECORD ROUTE object (SRRO)", "pcep.obj.srro",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_RECORD_ROUTE,\r\n{ "RECORD ROUTE object (RRO)", "pcep.obj.rro",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_LSPA,\r\n{ "LSPA object", "pcep.obj.lspa",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_lspa_flags_l,\r\n{ "Local Protection Desired (L)", "pcep.lspa.flags.l",\r\nFT_BOOLEAN, 8, TFS(&tfs_set_notset), PCEP_LSPA_L,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_IRO,\r\n{ "IRO object", "pcep.obj.iro",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_SVEC,\r\n{ "SVEC object", "pcep.obj.svec",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_svec_flags_l,\r\n{ "Link diverse (L)", "pcep.svec.flags.l",\r\nFT_BOOLEAN, 24, TFS(&tfs_set_notset), PCEP_SVEC_L,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_svec_flags_n,\r\n{ "Node diverse (N)", "pcep.svec.flags.n",\r\nFT_BOOLEAN, 24, TFS(&tfs_set_notset), PCEP_SVEC_N,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_svec_flags_s,\r\n{ "SRLG diverse (S)", "pcep.svec.flags.s",\r\nFT_BOOLEAN, 24, TFS(&tfs_set_notset), PCEP_SVEC_S,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_NOTIFICATION,\r\n{ "NOTIFICATION object", "pcep.obj.notification",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_NOTI_TYPE,\r\n{ "Notification Value", "pcep.notification.value1",\r\nFT_UINT32, BASE_DEC, VALS(pcep_notification_types_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_NOTI_VAL1,\r\n{ "Notification Type", "pcep.notification.type2",\r\nFT_UINT32, BASE_DEC, VALS(pcep_notification_values1_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_NOTI_VAL2,\r\n{ "Notification Type", "pcep.notification.type",\r\nFT_UINT32, BASE_DEC, VALS(pcep_notification_values2_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_PCEP_ERROR,\r\n{ "ERROR object", "pcep.obj.error",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_ERROR_TYPE,\r\n{ "Error-Type", "pcep.error.type",\r\nFT_UINT8, BASE_DEC | BASE_EXT_STRING, &pcep_error_types_obj_vals_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_ERROR_VALUE,\r\n{ "Error-Value", "pcep.error.value",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_LOAD_BALANCING,\r\n{ "LOAD BALANCING object", "pcep.obj.loadbalancing",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_CLOSE,\r\n{ "CLOSE object", "pcep.obj.close",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_PATH_KEY,\r\n{ "PATH-KEY object", "pcep.obj.path_key",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_XRO,\r\n{ "EXCLUDE ROUTE object (XRO)", "pcep.obj.xro",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_MONITORING,\r\n{ "MONITORING object", "pcep.obj.monitoring",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_monitoring_flags_reserved,\r\n{ "Reserved Flags", "pcep.obj.monitoring.flags.reserved",\r\nFT_BOOLEAN, 24, TFS(&tfs_set_notset), PCEP_OBJ_MONITORING_FLAGS_RESERVED,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_monitoring_flags_l,\r\n{ "Liveness (L)", "pcep.obj.monitoring.flags.l",\r\nFT_BOOLEAN, 24, TFS(&tfs_set_notset), PCEP_OBJ_MONITORING_FLAGS_L,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_monitoring_flags_g,\r\n{ "General (G)", "pcep.obj.monitoring.flags.g",\r\nFT_BOOLEAN, 24, TFS(&tfs_set_notset), PCEP_OBJ_MONITORING_FLAGS_G,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_monitoring_flags_p,\r\n{ "Processing Time (P)", "pcep.obj.monitoring.flags.p",\r\nFT_BOOLEAN, 24, TFS(&tfs_set_notset), PCEP_OBJ_MONITORING_FLAGS_P,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_monitoring_flags_c,\r\n{ "Overload (C)", "pcep.obj.monitoring.flags.c",\r\nFT_BOOLEAN, 24, TFS(&tfs_set_notset), PCEP_OBJ_MONITORING_FLAGS_C,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_monitoring_flags_i,\r\n{ "Incomplete (I)", "pcep.obj.monitoring.flags.i",\r\nFT_BOOLEAN, 24, TFS(&tfs_set_notset), PCEP_OBJ_MONITORING_FLAGS_I,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_monitoring_monitoring_id_number,\r\n{ "Monitoring ID Number", "pcep.obj.monitoring.monidnumber",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_PCC_ID_REQ,\r\n{ "PCC-ID-REQ object", "pcep.obj.pccidreq",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_pcc_id_req_ipv4,\r\n{ "IPv4 address", "pcep.obj.pccidreq.ipv4",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_pcc_id_req_ipv6,\r\n{ "IPv6 address", "pcep.obj.pccidreq.ipv6",\r\nFT_IPv6, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_OF,\r\n{ "OBJECTIVE FUNCTION object (OF)", "pcep.obj.of",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_PCE_ID,\r\n{ "PCE-ID object", "pcep.obj.pceid",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_pce_id_ipv4,\r\n{ "IPv4 address", "pcep.obj.pceid.ipv4",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_pce_id_ipv6,\r\n{ "IPv6 address", "pcep.obj.pceid.ipv6",\r\nFT_IPv6, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_PROC_TIME,\r\n{ "PROC-TIME object", "pcep.obj.proctime",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_proc_time_flags_reserved,\r\n{ "Reserved Flags", "pcep.obj.proctime.flags.reserved",\r\nFT_BOOLEAN, 16, TFS(&tfs_set_notset), PCEP_OBJ_PROC_TIME_FLAGS_RESERVED,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_proc_time_flags_e,\r\n{ "Estimated (E)", "pcep.obj.proctime.flags.e",\r\nFT_BOOLEAN, 16, TFS(&tfs_set_notset), PCEP_OBJ_PROC_TIME_FLAGS_E,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_proc_time_cur_proc_time,\r\n{ "Current processing time", "pcep.obj.proctime.curproctime",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_proc_time_min_proc_time,\r\n{ "Minimum processing time", "pcep.obj.proctime.minproctime",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_proc_time_max_proc_time,\r\n{ "Maximum processing time", "pcep.obj.proctime.maxproctime",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_proc_time_ave_proc_time,\r\n{ "Average processing time", "pcep.obj.proctime.aveproctime",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_proc_time_var_proc_time,\r\n{ "Variance processing time", "pcep.obj.proctime.varproctime",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_OVERLOAD,\r\n{ "OVERLOAD object", "pcep.obj.overload",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_overload_duration,\r\n{ "Overload Duration", "pcep.obj.overload.duration",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_LSP,\r\n{ "LSP object", "pcep.obj.lsp",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_SRP,\r\n{ "SRP object", "pcep.obj.srp",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_ASSOCIATION,\r\n{ "ASSOCIATION object", "pcep.obj.association",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_OBJ_UNKNOWN_TYPE,\r\n{ "Unknown object", "pcep.obj.unknown",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_SUBOBJ,\r\n{ "Type", "pcep.subobj",\r\nFT_UINT8, BASE_DEC, VALS(pcep_subobj_vals), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_SUBOBJ_7F,\r\n{ "Type", "pcep.subobj",\r\nFT_UINT8, BASE_DEC, VALS(pcep_subobj_vals), 0x7F,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_SUBOBJ_IPv4,\r\n{ "SUBOBJECT: IPv4 Prefix", "pcep.subobj.ipv4",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_SUBOBJ_IPv6,\r\n{ "SUBOBJECT: IPv6 Prefix", "pcep.subobj.ipv6",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_SUBOBJ_LABEL_CONTROL,\r\n{ "SUBOBJECT: Label Control", "pcep.subobj.label.control",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_SUBOBJ_UNNUM_INTERFACEID,\r\n{ "SUBOBJECT: Unnumbered Interface ID", "pcep.subobj.unnum.interfaceid",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_SUBOBJ_AUTONOMOUS_SYS_NUM,\r\n{ "SUBOBJECT: Autonomous System Number", "pcep.subobj.autonomous.sys.num",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_SUBOBJ_SRLG,\r\n{ "SUBOBJECT: SRLG", "pcep.subobj.srlg",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_SUBOBJ_EXRS,\r\n{ "SUBOBJECT: EXRS", "pcep.subobj.exrs",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_SUBOBJ_PKSv4,\r\n{ "SUBOBJECT: Path Key (IPv4)", "pcep.subobj.path_key.ipv4",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_SUBOBJ_PKSv6,\r\n{ "SUBOBJECT: Path Key (IPv6)", "pcep.subobj.path_key.ipv6",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_SUBOBJ_XRO,\r\n{ "Type", "pcep.subobj.label",\r\nFT_UINT32, BASE_DEC, VALS(pcep_subobj_xro_vals), 0x7F,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_xro_flags_f,\r\n{ "Fail (F)", "pcep.xro.flags.f",\r\nFT_BOOLEAN, 16, TFS(&tfs_set_notset), PCEP_XRO_F,\r\nNULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_PCEPF_SUB_XRO_ATTRIB,\r\n{ "Attribute", "pcep.xro.sub.attribute",\r\nFT_UINT32, BASE_DEC, VALS(pcep_xro_attribute_obj_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n#endif\r\n{ &pcep_subobj_flags_lpa,\r\n{ "Local Protection Available", "pcep.subobj.flags.lpa",\r\nFT_BOOLEAN, 8, TFS(&tfs_set_notset), PCEP_SUB_LPA,\r\nNULL, HFILL }\r\n},\r\n{ &pcep_subobj_flags_lpu,\r\n{ "Local protection in Use", "pcep.subobj.flags.lpu",\r\nFT_BOOLEAN, 8, TFS(&tfs_set_notset), PCEP_SUB_LPU,\r\nNULL, HFILL }\r\n},\r\n{ &pcep_subobj_label_flags_gl,\r\n{ "Global Label", "pcep.subobj.label.flags.gl",\r\nFT_BOOLEAN, 8, TFS(&tfs_set_notset), PCEP_SUB_LABEL_GL,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_no_path_tlvs_pce,\r\n{ "PCE currently unavailable", "pcep.no_path_tlvs.pce",\r\nFT_BOOLEAN, 32, TFS(&tfs_true_false), 0x0001,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_no_path_tlvs_unk_dest,\r\n{ "Unknown destination", "pcep.no_path_tlvs.unk_dest",\r\nFT_BOOLEAN, 32, TFS(&tfs_true_false), 0x0002,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_no_path_tlvs_unk_src,\r\n{ "Unknown source", "pcep.no_path_tlvs.unk_src",\r\nFT_BOOLEAN, 32, TFS(&tfs_true_false), 0x0004,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_lsp_update_capability,\r\n{ "LSP-UPDATE-CAPABILITY (U)", "pcep.stateful-pce-capability.lsp-update",\r\nFT_BOOLEAN, 32, TFS(&tfs_true_false), PCEP_TLV_STATEFUL_PCE_CAPABILITY_U,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_include_db_version,\r\n{ "INCLUDE-DB-VERSION (S)", "pcep.sync-capability.include-db-version",\r\nFT_BOOLEAN, 32, TFS(&tfs_true_false), PCEP_TLV_STATEFUL_PCE_CAPABILITY_S,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_lsp_instantiation_capability,\r\n{ "LSP-INSTANTIATION-CAPABILITY (I)", "pcep.stateful-pce-capability.lsp-instantiation",\r\nFT_BOOLEAN, 32, TFS(&tfs_true_false), PCEP_TLV_STATEFUL_PCE_CAPABILITY_I,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_triggered_resync,\r\n{ "TRIGGERED-RESYNC (T)", "pcep.stateful-pce-capability.triggered-resync",\r\nFT_BOOLEAN, 32, TFS(&tfs_true_false), PCEP_TLV_STATEFUL_PCE_CAPABILITY_T,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_delta_lsp_sync_capability,\r\n{ "DELTA-LSP-SYNC-CAPABILITY (D)", "pcep.stateful-pce-capability.delta-lsp-sync",\r\nFT_BOOLEAN, 32, TFS(&tfs_true_false), PCEP_TLV_STATEFUL_PCE_CAPABILITY_D,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_triggered_initial_sync,\r\n{ "TRIGGERED-INITIAL-SYNC (F)", "pcep.stateful-pce-capability.triggered-initial-sync",\r\nFT_BOOLEAN, 32, TFS(&tfs_true_false), PCEP_TLV_STATEFUL_PCE_CAPABILITY_F,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_sr_capability_reserved16,\r\n{ "Reserved", "pcep.sr.capability.reserved",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_sr_capability_flags_reserved,\r\n{ "Flags (reserved)", "pcep.sr.capability.flags.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_sr_capability_msd,\r\n{ "SR Capability (maximum SID depth)", "pcep.sr.capability.msd",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_path_setup_type_reserved24,\r\n{ "Reserved", "pcep.pst.reserved",\r\nFT_UINT24, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_path_setup_type,\r\n{ "Path Setup Type", "pcep.pst",\r\nFT_UINT8, BASE_DEC, VALS(pcep_pst_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_PCEPF_SUBOBJ_SR,\r\n{ "SUBOBJECT: SR", "pcep.subobj.sr",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_sr_l,\r\n{ "L", "pcep.subobj.sr.l",\r\nFT_UINT8, BASE_DEC, VALS(pcep_route_l_obj_vals), Mask_L,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_sr_length,\r\n{ "Length", "pcep.subobj.sr.length",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_sr_st,\r\n{ "SID Type", "pcep.subobj.sr.st",\r\nFT_UINT8, BASE_DEC, VALS(pcep_sr_st_vals), 0xF0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_sr_flags,\r\n{ "Flags", "pcep.subobj.sr.flags",\r\nFT_UINT16, BASE_HEX, NULL, 0x0FFF,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_sr_flags_m,\r\n{ "SID value represents an MPLS label w/o TC, S, and TTL (M)", "pcep.subobj.sr.flags.m",\r\nFT_BOOLEAN, 12, TFS(&tfs_set_notset), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_sr_flags_c,\r\n{ "SID value represents an MPLS label w/ TC, S, and TTL (C)", "pcep.subobj.sr.flags.c",\r\nFT_BOOLEAN, 12, TFS(&tfs_set_notset), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_sr_flags_s,\r\n{ "SID value is null (S)", "pcep.subobj.sr.flags.s",\r\nFT_BOOLEAN, 12, TFS(&tfs_set_notset), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_sr_flags_f,\r\n{ "NAI value is null (F)", "pcep.subobj.sr.flags.f",\r\nFT_BOOLEAN, 12, TFS(&tfs_set_notset), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_sr_sid,\r\n{ "SID", "pcep.subobj.sr.sid",\r\nFT_UINT32, BASE_DEC, NULL, 0xFFFFF000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_sr_nai_ipv4_node,\r\n{ "NAI (IPv4 Node ID)", "pcep.subobj.sr.nai.ipv4node",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_sr_nai_ipv6_node,\r\n{ "NAI (IPv6 Node ID)", "pcep.subobj.sr.nai.ipv6node",\r\nFT_IPv6, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_tlv_type,\r\n{ "Type", "pcep.tlv.type",\r\nFT_UINT16, BASE_DEC, VALS(pcep_tlvs_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_tlv_length,\r\n{ "Length", "pcep.tlv.length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_request_id,\r\n{ "Request-ID", "pcep.request_id",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_tlv_data,\r\n{ "Data", "pcep.tlv.data",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_tlv_padding,\r\n{ "Padding", "pcep.tlv.padding",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_ipv4_length,\r\n{ "Length", "pcep.subobj.ipv4.length",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_ipv4_ipv4,\r\n{ "IPv4 Address", "pcep.subobj.ipv4.ipv4",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_ipv4_prefix_length,\r\n{ "Prefix Length", "pcep.subobj.ipv4.prefix_length",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_ipv4_padding,\r\n{ "Padding", "pcep.subobj.ipv4.padding",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_ipv4_flags,\r\n{ "Flags", "pcep.subobj.ipv4.flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_ipv4_attribute,\r\n{ "Attribute", "pcep.subobj.ipv4.attribute",\r\nFT_UINT8, BASE_DEC, VALS(pcep_xro_attribute_obj_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_ipv6_length,\r\n{ "Length", "pcep.subobj.ipv6.length",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_ipv6_ipv6,\r\n{ "IPv6 Address", "pcep.subobj.ipv6.ipv6",\r\nFT_IPv6, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_ipv6_prefix_length,\r\n{ "Prefix Length", "pcep.subobj.ipv6.prefix_length",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_ipv6_padding,\r\n{ "Padding", "pcep.subobj.ipv6.padding",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_ipv6_flags,\r\n{ "Flags", "pcep.subobj.ipv6.flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_ipv6_attribute,\r\n{ "Attribute", "pcep.attribute",\r\nFT_UINT8, BASE_DEC, VALS(pcep_xro_attribute_obj_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_label_control_length,\r\n{ "Length", "pcep.subobj.label_control.length",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_label_control_u,\r\n{ "U", "pcep.subobj.label_control.u",\r\nFT_UINT8, BASE_DEC, VALS(pcep_route_u_obj_vals), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_label_control_reserved,\r\n{ "Reserved", "pcep.subobj.label_control.reserved",\r\nFT_UINT8, BASE_DEC, NULL, 0x7F,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_label_control_c_type,\r\n{ "C-Type", "pcep.subobj.label_control.c_type",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_label_control_label,\r\n{ "Label", "pcep.subobj.label_control.label",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_label_control_flags,\r\n{ "Flags", "pcep.subobj.label_control.flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x7F,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_unnumb_interfaceID_length,\r\n{ "Length", "pcep.subobj.unnumb_interfaceID.length",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_unnumb_interfaceID_reserved,\r\n{ "Reserved", "pcep.subobj.unnumb_interfaceID.reserved",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_unnumb_interfaceID_flags,\r\n{ "Flags", "pcep.subobj.unnumb_interfaceID.flags",\r\nFT_UINT16, BASE_HEX, NULL, 0xFF00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_unnumb_interfaceID_reserved_rrobj,\r\n{ "Reserved", "pcep.subobj.unnumb_interfaceID.reserved",\r\nFT_UINT16, BASE_HEX, NULL, 0x00FF,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_unnumb_interfaceID_reserved_xroobj,\r\n{ "Reserved", "pcep.subobj.unnumb_interfaceID.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_unnumb_interfaceID_attribute,\r\n{ "Attribute", "pcep.subobj.unnumb_interfaceID.attribute",\r\nFT_UINT8, BASE_DEC, VALS(pcep_xro_attribute_obj_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_unnumb_interfaceID_router_id,\r\n{ "Router ID", "pcep.subobj.unnumb_interfaceID.router_id",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_unnumb_interfaceID_interface_id,\r\n{ "Interface ID", "pcep.subobj.unnumb_interfaceID.interface_id",\r\nFT_UINT32, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_autonomous_sys_num_length,\r\n{ "Length", "pcep.subobj.autonomous_sys_num.length",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_autonomous_sys_num_reserved,\r\n{ "Reserved", "pcep.subobj.autonomous_sys_num.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_autonomous_sys_num_attribute,\r\n{ "Attribute", "pcep.subobj.autonomous_sys_num.attribute",\r\nFT_UINT8, BASE_DEC, VALS(pcep_xro_attribute_obj_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_autonomous_sys_num_optional_as_number_high_octets,\r\n{ "Optional AS Number High Octets", "pcep.subobj.autonomous_sys_num.optional_as_number_high_octets",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_autonomous_sys_num_as_number,\r\n{ "AS Number", "pcep.subobj.autonomous_sys_num.as_number",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_srlg_length,\r\n{ "Length", "pcep.subobj.srlg.length",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_srlg_id,\r\n{ "SRLG ID", "pcep.subobj.srlg.id",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_srlg_reserved,\r\n{ "Reserved", "pcep.subobj.srlg.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_srlg_attribute,\r\n{ "Attribute", "pcep.subobj.srlg.attribute",\r\nFT_UINT8, BASE_DEC, VALS(pcep_xro_attribute_obj_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_exrs_length,\r\n{ "Length", "pcep.subobj.exrs.length",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_exrs_reserved,\r\n{ "Reserved", "pcep.subobj.exrs.reserved",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_pksv4_length,\r\n{ "Length", "pcep.subobj.pksv4.length",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_pksv4_path_key,\r\n{ "Path Key", "pcep.subobj.pksv4.path_key",\r\nFT_UINT16, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_pksv4_pce_id,\r\n{ "PCE ID", "pcep.subobj.pksv4.pce_id",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_pksv6_length,\r\n{ "Length", "pcep.subobj.pksv6.length",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_pksv6_path_key,\r\n{ "Path Key", "pcep.subobj.pksv6.path_key",\r\nFT_UINT16, BASE_DEC_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_pksv6_pce_id,\r\n{ "PCE ID", "pcep.subobj.pksv6.pce_id",\r\nFT_IPv6, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_open_obj_pcep_version,\r\n{ "PCEP Version", "pcep.obj.open.pcep_version",\r\nFT_UINT8, BASE_DEC, NULL, 0xE0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_open_obj_flags,\r\n{ "Flags", "pcep.obj.open.flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x1F,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_open_obj_keepalive,\r\n{ "Keepalive", "pcep.obj.open.keepalive",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_open_obj_deadtime,\r\n{ "Deadtime", "pcep.obj.open.deadtime",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_open_obj_sid,\r\n{ "SID", "pcep.obj.open.sid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_rp_obj_reserved,\r\n{ "Reserved", "pcep.obj.rp.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_rp_obj_flags,\r\n{ "Flags", "pcep.obj.rp.flags",\r\nFT_UINT24, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_rp_obj_requested_id_number,\r\n{ "Requested ID Number", "pcep.obj.rp.requested_id_number",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_no_path_obj_flags,\r\n{ "Flags", "pcep.obj.no_path.flags",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_no_path_obj_reserved,\r\n{ "Reserved", "pcep.obj.no_path.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_end_point_obj_source_ipv4_address,\r\n{ "Source IPv4 Address", "pcep.obj.end_point.source_ipv4_address",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_end_point_obj_destination_ipv4_address,\r\n{ "Destination IPv4 Address", "pcep.obj.end_point.destination_ipv4_address",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_end_point_obj_source_ipv6_address,\r\n{ "Source IPv6 Address", "pcep.obj.end_point.source_ipv6_address",\r\nFT_IPv6, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_end_point_obj_destination_ipv6_address,\r\n{ "Destination IPv6 Address", "pcep.obj.end_point.destination_ipv6_address",\r\nFT_IPv6, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_bandwidth,\r\n{ "Bandwidth", "pcep.bandwidth",\r\nFT_FLOAT, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_metric_obj_reserved,\r\n{ "Reserved", "pcep.obj.metric.reserved",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_metric_obj_flags,\r\n{ "Flags", "pcep.obj.metric.flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_metric_obj_type,\r\n{ "Type", "pcep.obj.metric.type",\r\nFT_UINT8, BASE_DEC, VALS(pcep_metric_obj_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_metric_obj_metric_value,\r\n{ "Metric Value", "pcep.obj.metric.metric_value",\r\nFT_FLOAT, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_lspa_obj_exclude_any,\r\n{ "Exclude-Any", "pcep.obj.lspa.exclude_any",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_lspa_obj_include_any,\r\n{ "Include-Any", "pcep.obj.lspa.include_any",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_lspa_obj_include_all,\r\n{ "Include-All", "pcep.obj.lspa.include_all",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_lspa_obj_setup_priority,\r\n{ "Setup Priority", "pcep.obj.lspa.setup_priority",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_lspa_obj_holding_priority,\r\n{ "Holding Priority", "pcep.obj.lspa.holding_priority",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_lspa_obj_flags,\r\n{ "Flags", "pcep.obj.lspa.flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_lspa_obj_reserved,\r\n{ "Reserved", "pcep.obj.lspa.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_svec_obj_reserved,\r\n{ "Reserved", "pcep.obj.svec.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_svec_obj_flags,\r\n{ "Flags", "pcep.obj.svec.flags",\r\nFT_UINT24, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_svec_obj_request_id_number,\r\n{ "Request-ID-Number", "pcep.obj.svec.request_id_number",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_notification_obj_reserved,\r\n{ "Reserved", "pcep.obj.notification.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_notification_obj_flags,\r\n{ "Flags", "pcep.obj.notification.flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_notification_obj_type,\r\n{ "Notification Type", "pcep.obj.notification.type",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_notification_obj_value,\r\n{ "Notification Value", "pcep.obj.notification.value",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_error_obj_reserved,\r\n{ "Reserved", "pcep.obj.error.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_error_obj_flags,\r\n{ "Flags", "pcep.obj.error.flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_balancing_obj_reserved,\r\n{ "Reserved", "pcep.obj.balancing.reserved",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_balancing_obj_flags,\r\n{ "Flags", "pcep.obj.balancing.flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_balancing_obj_maximum_number_of_te_lsps,\r\n{ "Maximum Number of TE LSPs", "pcep.obj.balancing.maximum_number_of_te_lsps",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_balancing_obj_minimum_bandwidth,\r\n{ "Minimum Bandwidth", "pcep.obj.balancing.minimum_bandwidth",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_close_obj_reserved,\r\n{ "Reserved", "pcep.obj.close.reserved",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_close_obj_flags,\r\n{ "Flags", "pcep.obj.close.flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_close_obj_reason,\r\n{ "Reason", "pcep.obj.close.reason",\r\nFT_UINT8, BASE_DEC, VALS(pcep_close_reason_obj_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_xro_obj_reserved,\r\n{ "Reserved", "pcep.obj.xro.reserved",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_xro_obj_flags,\r\n{ "Flags", "pcep.obj.xro.flags",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_monitoring_reserved,\r\n{ "Reserved", "pcep.obj.monitoring.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_monitoring_flags,\r\n{ "Flags", "pcep.obj.monitoring.flags",\r\nFT_UINT24, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_of_code,\r\n{ "OF-Code", "pcep.obj.of.code",\r\nFT_UINT16, BASE_DEC, VALS(pcep_of_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_proc_time_reserved,\r\n{ "Reserved", "pcep.obj.proc_time.reserved",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_proc_time_flags,\r\n{ "Flags", "pcep.obj.proc_time.flags",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_overload_flags,\r\n{ "Flags", "pcep.obj.overload.flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_overload_reserved,\r\n{ "Reserved", "pcep.obj.overload.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_object_type,\r\n{ "Object Type", "pcep.object_type",\r\nFT_UINT8, BASE_DEC, NULL, MASK_OBJ_TYPE,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_object_length,\r\n{ "Object Length", "pcep.object_length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_version,\r\n{ "PCEP Version", "pcep.version",\r\nFT_UINT8, BASE_HEX, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_flags,\r\n{ "Flags", "pcep.flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x1F,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_message_length,\r\n{ "Message length", "pcep.msg_length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_of_code,\r\n{ "OF-Code", "pcep.of_code",\r\nFT_UINT16, BASE_DEC, VALS(pcep_of_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_ipv4_l,\r\n{ "L", "pcep.subobj.ipv4.l",\r\nFT_UINT8, BASE_DEC, VALS(pcep_route_l_obj_vals), Mask_L,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_iro_ipv4_l,\r\n{ "L", "pcep.iro.subobj.ipv4.l",\r\nFT_UINT8, BASE_HEX, NULL, Mask_L,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_ipv4_x,\r\n{ "X", "pcep.subobj.ipv4.x",\r\nFT_UINT8, BASE_HEX, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_ipv6_l,\r\n{ "L", "pcep.subobj.ipv6.l",\r\nFT_UINT8, BASE_DEC, VALS(pcep_route_l_obj_vals), Mask_L,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_iro_ipv6_l,\r\n{ "L", "pcep.iro.subobj.ipv6.l",\r\nFT_UINT8, BASE_HEX, NULL, Mask_L,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_ipv6_x,\r\n{ "X", "pcep.subobj.ipv6.x",\r\nFT_UINT8, BASE_HEX, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_label_control_l,\r\n{ "L", "pcep.subobj.label_control.l",\r\nFT_UINT8, BASE_DEC, VALS(pcep_route_l_obj_vals), Mask_L,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_unnumb_interfaceID_l,\r\n{ "L", "pcep.subobj.unnumb_interfaceID.l",\r\nFT_UINT8, BASE_DEC, VALS(pcep_route_l_obj_vals), Mask_L,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_iro_unnumb_interfaceID_l,\r\n{ "L", "pcep.iro.subobj.unnumb_interfaceID.l",\r\nFT_UINT8, BASE_HEX, NULL, Mask_L,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_unnumb_interfaceID_x,\r\n{ "X", "pcep.subobj.unnumb_interfaceID.x",\r\nFT_UINT8, BASE_HEX, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_autonomous_sys_num_x,\r\n{ "X", "pcep.subobj.autonomous_sys_num.x",\r\nFT_UINT8, BASE_HEX, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_iro_autonomous_sys_num_l,\r\n{ "L", "pcep.iro.subobj.autonomous_sys_num.l",\r\nFT_UINT8, BASE_HEX, NULL, Mask_L,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_autonomous_sys_num_l,\r\n{ "L", "pcep.subobj.autonomous_sys_num.l",\r\nFT_UINT8, BASE_DEC, VALS(pcep_route_l_obj_vals), Mask_L,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_srlg_x,\r\n{ "X", "pcep.subobj.srlg.x",\r\nFT_UINT8, BASE_HEX, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_exrs_l,\r\n{ "L", "pcep.subobj.exrs.l",\r\nFT_UINT8, BASE_DEC, VALS(pcep_route_l_obj_vals), Mask_L,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_exrs_type,\r\n{ "Type", "pcep.subobj.exrs.type",\r\nFT_UINT8, BASE_DEC, NULL, 0x7F,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_pksv4_l,\r\n{ "L", "pcep.subobj.pksv4.l",\r\nFT_UINT8, BASE_DEC, VALS(pcep_route_l_obj_vals), Mask_L,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_subobj_pksv6_l,\r\n{ "L", "pcep.subobj.pksv6.l",\r\nFT_UINT8, BASE_DEC, VALS(pcep_route_l_obj_vals), Mask_L,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_no_path_obj_nature_of_issue,\r\n{ "Nature of Issue", "pcep.obj.no_path.nature_of_issue",\r\nFT_UINT8, BASE_DEC, VALS(pcep_no_path_obj_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_srp_id_number,\r\n{ "SRP-ID-number", "pcep.obj.srp.id-number",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_lsp_plsp_id,\r\n{ "PLSP-ID", "pcep.obj.lsp.plsp-id",\r\nFT_UINT32, BASE_DEC, NULL, PCEP_OBJ_LSP_PLSP_ID,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_lsp_flags,\r\n{ "Flags", "pcep.obj.lsp.flags",\r\nFT_UINT24, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_lsp_flags_d,\r\n{ "Delegate (D)", "pcep.obj.lsp.flags.delegate",\r\nFT_BOOLEAN, 16, TFS(&tfs_set_notset), PCEP_OBJ_LSP_FLAGS_D,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_lsp_flags_s,\r\n{ "SYNC (S)", "pcep.obj.lsp.flags.sync",\r\nFT_BOOLEAN, 16, TFS(&tfs_set_notset), PCEP_OBJ_LSP_FLAGS_S,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_lsp_flags_r,\r\n{ "Remove (R)", "pcep.obj.lsp.flags.remove",\r\nFT_BOOLEAN, 16, TFS(&tfs_set_notset), PCEP_OBJ_LSP_FLAGS_R,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_lsp_flags_a,\r\n{ "Administrative (A)", "pcep.obj.lsp.flags.administrative",\r\nFT_BOOLEAN, 16, TFS(&tfs_set_notset), PCEP_OBJ_LSP_FLAGS_A,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_lsp_flags_o,\r\n{ "Operational (O)", "pcep.obj.lsp.flags.operational",\r\nFT_UINT16, BASE_DEC, VALS(pcep_object_lsp_flags_operational_vals), PCEP_OBJ_LSP_FLAGS_O,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_lsp_flags_c,\r\n{ "Create (C)", "pcep.obj.lsp.flags.create",\r\nFT_BOOLEAN, 16, TFS(&tfs_set_notset), PCEP_OBJ_LSP_FLAGS_C,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_lsp_flags_reserved,\r\n{ "Reserved", "pcep.obj.lsp.flags.reserved",\r\nFT_BOOLEAN, 16, TFS(&tfs_set_notset), PCEP_OBJ_LSP_FLAGS_RESERVED,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_srp_flags,\r\n{ "Flags", "pcep.obj.srp.flags",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_obj_srp_flags_r,\r\n{ "Remove (R)", "pcep.obj.srp.flags.remove",\r\nFT_BOOLEAN, 32, TFS(&tfs_set_notset), PCEP_OBJ_SRP_FLAGS_R,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_symbolic_path_name,\r\n{ "SYMBOLIC-PATH-NAME", "pcep.tlv.symbolic-path-name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_ipv4_lsp_id_tunnnel_sender_address,\r\n{ "IPv4 Tunnel Sender Address", "pcep.tlv.ipv4-lsp-id.tunnnel-sender-addr",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_ipv4_lsp_id_lsp_id,\r\n{ "LSP ID", "pcep.tlv.ipv4-lsp-id.lsp-id",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_ipv4_lsp_id_tunnel_id,\r\n{ "Tunnel ID", "pcep.tlv.ipv4-lsp-id.tunnel-id",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_ipv4_lsp_id_extended_tunnel_id,\r\n{ "Extended Tunnel ID", "pcep.tlv.ipv4-lsp-id.extended-tunnel-id",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_ipv4_lsp_id_tunnel_endpoint_address,\r\n{ "IPv4 Tunnel Endpoint Address", "pcep.tlv.ipv4-lsp-id.tunnnel-endpoint-addr",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_ipv6_lsp_id_tunnnel_sender_address,\r\n{ "IPv6 Tunnel Sender Address", "pcep.tlv.ipv6-lsp-id.tunnnel-sender-addr",\r\nFT_IPv6, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_ipv6_lsp_id_lsp_id,\r\n{ "LSP ID", "pcep.tlv.ipv6-lsp-id.lsp-id",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_ipv6_lsp_id_tunnel_id,\r\n{ "Tunnel ID", "pcep.tlv.ipv6-lsp-id.tunnel-id",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_ipv6_lsp_id_extended_tunnel_id,\r\n{ "Extended Tunnel ID", "pcep.tlv.ipv6-lsp-id.extended-tunnel-id",\r\nFT_UINT64, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_ipv6_lsp_id_tunnel_endpoint_address,\r\n{ "IPv6 Tunnel Endpoint Address", "pcep.tlv.ipv6-lsp-id.tunnnel-endpoint-addr",\r\nFT_IPv6, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_lsp_error_code,\r\n{ "LSP Error Code", "pcep.tlv.lsp-error-code",\r\nFT_UINT32, BASE_DEC, VALS(pcep_tlv_lsp_error_code_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_rsvp_user_error_spec,\r\n{ "RSVP/USER ERROR_SPEC", "pcep.tlv.rsvp-user-error-spec",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_lsp_state_db_version_number,\r\n{ "LSP State DB Version Number", "pcep.tlv.lsp-state-db-version-number",\r\nFT_UINT64, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_speaker_entity_id,\r\n{ "Speaker Entity Identifier", "pcep.tlv.speaker-entity-id",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_association_reserved,\r\n{ "Reserved", "pcep.association.reserved",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_association_flags,\r\n{ "Flags", "pcep.association.flags",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_association_flags_r,\r\n{ "Remove (R)", "pcep.association.flags.r",\r\nFT_BOOLEAN, 16, TFS(&tfs_set_notset), PCEP_OBJ_ASSOCIATION_FLAGS_R,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_association_type,\r\n{ "Association Type", "pcep.association.type",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_association_id,\r\n{ "Association ID", "pcep.association.id",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_association_source_ipv4,\r\n{ "IPv4 Association Source", "pcep.association.ipv4.source",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_association_source_ipv6,\r\n{ "IPv6 Association Source", "pcep.association.ipv6.source",\r\nFT_IPv6, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_association_source_global,\r\n{ "Global Association Source", "pcep.association.global.source",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_pcep_association_id_extended,\r\n{ "Extended Association ID", "pcep.association.id.extended",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_pcep,\r\n&ett_pcep_hdr,\r\n&ett_pcep_obj_open,\r\n&ett_pcep_obj_request_parameters,\r\n&ett_pcep_obj_no_path,\r\n&ett_pcep_obj_end_point,\r\n&ett_pcep_obj_bandwidth,\r\n&ett_pcep_obj_metric,\r\n&ett_pcep_obj_explicit_route,\r\n&ett_pcep_obj_record_route,\r\n&ett_pcep_obj_sero,\r\n&ett_pcep_obj_srro,\r\n&ett_pcep_obj_lspa,\r\n&ett_pcep_obj_iro,\r\n&ett_pcep_obj_svec,\r\n&ett_pcep_obj_notification,\r\n&ett_pcep_obj_error,\r\n&ett_pcep_obj_load_balancing,\r\n&ett_pcep_obj_close,\r\n&ett_pcep_obj_path_key,\r\n&ett_pcep_obj_xro,\r\n&ett_pcep_obj_monitoring,\r\n&ett_pcep_obj_pcc_id_req,\r\n&ett_pcep_obj_of,\r\n&ett_pcep_obj_pce_id,\r\n&ett_pcep_obj_proc_time,\r\n&ett_pcep_obj_overload,\r\n&ett_pcep_obj_lsp,\r\n&ett_pcep_obj_srp,\r\n&ett_pcep_obj_association,\r\n&ett_pcep_obj_unknown\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_pcep_subobject_bad_length, { "pcep.subobject_bad_length", PI_MALFORMED, PI_WARN, "Bad subobject length", EXPFILL }},\r\n{ &ei_pcep_non_defined_subobject, { "pcep.non_defined_subobject", PI_PROTOCOL, PI_WARN, "Non defined subobject for this object", EXPFILL }},\r\n{ &ei_pcep_non_defined_object, { "pcep.unknown_object", PI_PROTOCOL, PI_WARN, "Unknown object", EXPFILL }},\r\n{ &ei_pcep_object_length, { "pcep.object_length.bad", PI_MALFORMED, PI_WARN, "Object Length bogus", EXPFILL }},\r\n{ &ei_pcep_pcep_object_body_non_defined, { "pcep.object_body_non_defined", PI_PROTOCOL, PI_WARN, "PCEP Object BODY non defined", EXPFILL }},\r\n{ &ei_pcep_unknown_type_object, { "pcep.unknown_type_object", PI_PROTOCOL, PI_WARN, "UNKNOWN Type Object", EXPFILL }},\r\n};\r\nexpert_module_t* expert_pcep;\r\nproto_pcep = proto_register_protocol (\r\n"Path Computation Element communication Protocol", "PCEP", "pcep");\r\nproto_register_field_array(proto_pcep, pcepf_info, array_length(pcepf_info));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_pcep = expert_register_protocol(proto_pcep);\r\nexpert_register_field_array(expert_pcep, ei, array_length(ei));\r\n}\r\nvoid\r\nproto_reg_handoff_pcep(void)\r\n{\r\ndissector_handle_t pcep_handle;\r\npcep_handle = create_dissector_handle(dissect_pcep, proto_pcep);\r\ndissector_add_uint("tcp.port", TCP_PORT_PCEP, pcep_handle);\r\n}
