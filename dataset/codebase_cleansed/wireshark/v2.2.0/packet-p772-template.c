static int\r\ndissect_p772(tvbuff_t *tvb, packet_info *pinfo, proto_tree *parent_tree, void* data _U_)\r\n{\r\nint offset = 0;\r\nproto_item *item=NULL;\r\nproto_tree *tree=NULL;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\nif (parent_tree) {\r\nitem = proto_tree_add_item(parent_tree, proto_p772, tvb, 0, -1, ENC_NA);\r\ntree = proto_item_add_subtree(item, ett_p772);\r\n}\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "P772");\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Military");\r\ndissect_p772_InformationObject(TRUE, tvb, offset, &asn1_ctx , tree, -1);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid proto_register_p772(void) {\r\nstatic hf_register_info hf[] =\r\n{\r\n#include "packet-p772-hfarr.c"\r\n};\r\nstatic gint *ett[] = {\r\n&ett_p772,\r\n#include "packet-p772-ettarr.c"\r\n};\r\nproto_p772 = proto_register_protocol(PNAME, PSNAME, PFNAME);\r\nregister_dissector("p772", dissect_p772, proto_p772);\r\nproto_register_field_array(proto_p772, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nregister_ber_syntax_dissector("STANAG 4406", proto_p772, dissect_p772);\r\nregister_ber_oid_syntax(".p772", NULL, "STANAG 4406");\r\n}\r\nvoid proto_reg_handoff_p772(void) {\r\n#include "packet-p772-dis-tab.c"\r\nregister_ber_oid_dissector("1.3.26.0.4406.0.4.1", dissect_p772, proto_p772, "STANAG 4406");\r\n}
