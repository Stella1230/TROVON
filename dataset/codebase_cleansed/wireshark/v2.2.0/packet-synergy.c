static int\r\ndissect_synergy(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "synergy");\r\nif (tree) {\r\ngint offset=0;\r\nchar buffer[20];\r\nproto_item *ti = NULL;\r\nproto_tree *synergy_tree = NULL;\r\nti = proto_tree_add_protocol_format(tree, proto_synergy, tvb, 0, -1,"Synergy Protocol");\r\nsynergy_tree = proto_item_add_subtree(ti, ett_synergy);\r\ntvb_get_nstringz(tvb,offset+4,20,(guint8*)buffer);\r\nif(strncmp(buffer,"Synergy",7)==0)\r\ndissect_synergy_handshake(tvb,pinfo,synergy_tree,offset+4);\r\nelse if(strncmp(buffer,"CNOP",4)==0)\r\nproto_tree_add_item(synergy_tree,hf_synergy_cnop,tvb,offset+4,-1,ENC_NA);\r\nelse if(strncmp(buffer,"CALV",4)==0)\r\nproto_tree_add_item(synergy_tree,hf_synergy_calv,tvb,offset+4,-1,ENC_NA);\r\nelse if(strncmp(buffer,"CBYE",4)==0)\r\nproto_tree_add_item(synergy_tree,hf_synergy_cbye,tvb,offset+4,-1,ENC_NA);\r\nelse if(strncmp(buffer,"CINN",4)==0)\r\ndissect_synergy_cinn(tvb,pinfo,synergy_tree,offset+4);\r\nelse if(strncmp(buffer,"COUT",4)==0)\r\nproto_tree_add_item(synergy_tree,hf_synergy_cout,tvb,offset+4,-1,ENC_NA);\r\nelse if(strncmp(buffer,"CCLP",4)==0)\r\ndissect_synergy_cclp(tvb,pinfo,synergy_tree,offset+4);\r\nelse if(strncmp(buffer,"CSEC",4)==0)\r\nproto_tree_add_item(synergy_tree,hf_synergy_csec,tvb,offset+4,1,ENC_BIG_ENDIAN);\r\nelse if(strncmp(buffer,"CROP",4)==0)\r\nproto_tree_add_item(synergy_tree,hf_synergy_crop,tvb,offset+4,-1,ENC_NA);\r\nelse if(strncmp(buffer,"CIAK",4)==0)\r\nproto_tree_add_item(synergy_tree,hf_synergy_ciak,tvb,offset+4,-1,ENC_NA);\r\nelse if(strncmp(buffer,"DKDN",4)==0)\r\ndissect_synergy_dkdn(tvb,pinfo,synergy_tree,offset+4);\r\nelse if(strncmp(buffer,"DKRP",4)==0)\r\ndissect_synergy_dkrp(tvb,pinfo,synergy_tree,offset+4);\r\nelse if(strncmp(buffer,"DKUP",4)==0)\r\ndissect_synergy_dkup(tvb,pinfo,synergy_tree,offset+4);\r\nelse if(strncmp(buffer,"DMDN",4)==0)\r\nproto_tree_add_item(synergy_tree,hf_synergy_dmdn,tvb,offset+4,1,ENC_BIG_ENDIAN);\r\nelse if(strncmp(buffer,"DMUP",4)==0)\r\nproto_tree_add_item(synergy_tree,hf_synergy_dmup,tvb,offset+4,1,ENC_BIG_ENDIAN);\r\nelse if(strncmp(buffer,"DMMV",4)==0)\r\ndissect_synergy_dmmv(tvb,pinfo,synergy_tree,offset+4);\r\nelse if(strncmp(buffer,"DMRM",4)==0)\r\ndissect_synergy_dmrm(tvb,pinfo,synergy_tree,offset+4);\r\nelse if(strncmp(buffer,"DMWM",4)==0)\r\nproto_tree_add_item(synergy_tree,hf_synergy_dmwm,tvb,offset+4,2,ENC_BIG_ENDIAN);\r\nelse if(strncmp(buffer,"DCLP",4)==0)\r\ndissect_synergy_dclp(tvb,pinfo,synergy_tree,offset+4);\r\nelse if(strncmp(buffer,"DINF",4)==0)\r\ndissect_synergy_dinf(tvb,pinfo,synergy_tree,offset+4);\r\nelse if(strncmp(buffer,"DSOP",4)==0)\r\nproto_tree_add_item(synergy_tree,hf_synergy_dsop,tvb,offset+4,4,ENC_BIG_ENDIAN);\r\nelse if(strncmp(buffer,"QINF",4)==0)\r\nproto_tree_add_item(synergy_tree,hf_synergy_qinf,tvb,offset+4,-1,ENC_NA);\r\nelse if(strncmp(buffer,"EICV",4)==0)\r\ndissect_synergy_eicv(tvb,pinfo,synergy_tree,offset+4);\r\nelse if(strncmp(buffer,"EBSY",4)==0)\r\nproto_tree_add_item(synergy_tree,hf_synergy_ebsy,tvb,offset+4,-1,ENC_NA);\r\nelse if(strncmp(buffer,"EUNK",4)==0)\r\nproto_tree_add_item(synergy_tree,hf_synergy_eunk,tvb,offset+4,-1,ENC_NA);\r\nelse if(strncmp(buffer,"EBAD",4)==0)\r\nproto_tree_add_item(synergy_tree,hf_synergy_ebad,tvb,offset+4,-1,ENC_NA);\r\nelse\r\nproto_tree_add_item(synergy_tree,hf_synergy_unknown,tvb,offset+4,-1,ENC_NA);\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic void dissect_synergy_handshake( tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, gint offset )\r\n{\r\nproto_item *ti = NULL;\r\nproto_tree *sub_tree = NULL;\r\nti = proto_tree_add_item(tree, hf_synergy_handshake, tvb, offset, -1, ENC_NA);\r\nsub_tree = proto_item_add_subtree(ti, ett_synergy);\r\nproto_tree_add_item(sub_tree, hf_synergy_handshake_majorversion, tvb, offset + 7, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_synergy_handshake_minorversion, tvb, offset + 9, 2, ENC_BIG_ENDIAN);\r\nif (tvb_reported_length_remaining(tvb, offset + 11) != 0)\r\n{\r\nproto_tree_add_item(sub_tree, hf_synergy_unknown, tvb, offset + 11, 4, ENC_NA);\r\nproto_tree_add_item(sub_tree, hf_synergy_handshake_clientname, tvb, offset + 15, -1, ENC_ASCII|ENC_NA);\r\n}\r\n}\r\nstatic void dissect_synergy_cinn( tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, gint offset )\r\n{\r\nproto_item *ti = NULL;\r\nproto_tree *sub_tree = NULL;\r\nti = proto_tree_add_item(tree, hf_synergy_cinn, tvb, offset, -1, ENC_NA);\r\nsub_tree = proto_item_add_subtree(ti, ett_synergy);\r\nproto_tree_add_item(sub_tree, hf_synergy_cinn_x, tvb, offset + 4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_synergy_cinn_y, tvb, offset + 6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_synergy_cinn_sequence, tvb, offset + 8, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_synergy_cinn_modifiermask, tvb, offset + 12, 2, ENC_BIG_ENDIAN);\r\n}\r\nstatic void dissect_synergy_cclp( tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, gint offset )\r\n{\r\nproto_item *ti = NULL;\r\nproto_tree *sub_tree = NULL;\r\nti = proto_tree_add_item(tree, hf_synergy_cclp, tvb, offset, -1, ENC_NA);\r\nsub_tree = proto_item_add_subtree(ti, ett_synergy);\r\nproto_tree_add_item(sub_tree, hf_synergy_cclp_clipboardidentifier, tvb, offset + 4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_synergy_cclp_sequencenumber, tvb, offset + 5, 4, ENC_BIG_ENDIAN);\r\n}\r\nstatic void dissect_synergy_dkdn( tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, gint offset )\r\n{\r\nproto_item *ti = NULL;\r\nproto_tree *sub_tree = NULL;\r\nti = proto_tree_add_item(tree, hf_synergy_dkdn, tvb, offset, -1, ENC_NA);\r\nsub_tree = proto_item_add_subtree(ti, ett_synergy);\r\nproto_tree_add_item(sub_tree, hf_synergy_dkdn_keyid, tvb, offset + 4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_synergy_dkdn_keymodifiermask, tvb, offset + 6, 2, ENC_BIG_ENDIAN);\r\nif (tvb_reported_length_remaining(tvb, offset + 8) != 0)\r\nproto_tree_add_item(sub_tree, hf_synergy_dkdn_keybutton, tvb, offset + 8, 2, ENC_BIG_ENDIAN);\r\n}\r\nstatic void dissect_synergy_dkrp( tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, gint offset )\r\n{\r\nproto_item *ti = NULL;\r\nproto_tree *sub_tree = NULL;\r\nti = proto_tree_add_item(tree, hf_synergy_dkrp, tvb, offset, -1, ENC_NA);\r\nsub_tree = proto_item_add_subtree(ti, ett_synergy);\r\nproto_tree_add_item(sub_tree, hf_synergy_dkrp_keyid, tvb, offset + 4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_synergy_dkrp_keymodifiermask, tvb, offset + 6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_synergy_dkrp_numberofrepeats, tvb, offset + 8, 2, ENC_BIG_ENDIAN);\r\nif (tvb_reported_length_remaining(tvb, offset + 10) != 0)\r\nproto_tree_add_item(sub_tree, hf_synergy_dkrp_keybutton, tvb, offset + 10, 2, ENC_BIG_ENDIAN);\r\n}\r\nstatic void dissect_synergy_dkup( tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, gint offset )\r\n{\r\nproto_item *ti = NULL;\r\nproto_tree *sub_tree = NULL;\r\nti = proto_tree_add_item(tree, hf_synergy_dkup, tvb, offset, -1, ENC_NA);\r\nsub_tree = proto_item_add_subtree(ti, ett_synergy);\r\nproto_tree_add_item(sub_tree, hf_synergy_dkup_keyid, tvb, offset + 4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_synergy_dkup_keymodifiermask, tvb, offset + 6, 2, ENC_BIG_ENDIAN);\r\nif (tvb_reported_length_remaining(tvb, offset + 8) != 0)\r\nproto_tree_add_item(sub_tree, hf_synergy_dkup_keybutton, tvb, offset + 8, 2, ENC_BIG_ENDIAN);\r\n}\r\nstatic void dissect_synergy_dmmv( tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, gint offset )\r\n{\r\nproto_item *ti = NULL;\r\nproto_tree *sub_tree = NULL;\r\nti = proto_tree_add_item(tree, hf_synergy_dmmv, tvb, offset, -1, ENC_NA);\r\nsub_tree = proto_item_add_subtree(ti, ett_synergy);\r\nproto_tree_add_item(sub_tree, hf_synergy_dmmv_x, tvb, offset + 4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_synergy_dmmv_y, tvb, offset + 6, 2, ENC_BIG_ENDIAN);\r\n}\r\nstatic void dissect_synergy_dmrm( tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, gint offset )\r\n{\r\nproto_item *ti = NULL;\r\nproto_tree *sub_tree = NULL;\r\nti = proto_tree_add_item(tree, hf_synergy_dmrm, tvb, offset, -1, ENC_NA);\r\nsub_tree = proto_item_add_subtree(ti, ett_synergy);\r\nproto_tree_add_item(sub_tree, hf_synergy_dmrm_x, tvb, offset + 4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_synergy_dmrm_y, tvb, offset + 6, 2, ENC_BIG_ENDIAN);\r\n}\r\nstatic void dissect_synergy_dclp( tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, gint offset )\r\n{\r\nproto_item *ti = NULL;\r\nproto_tree *sub_tree = NULL;\r\nti = proto_tree_add_item(tree, hf_synergy_dclp, tvb, offset, -1, ENC_NA);\r\nsub_tree = proto_item_add_subtree(ti, ett_synergy);\r\nproto_tree_add_item(sub_tree, hf_synergy_dclp_clipboardidentifier, tvb, offset + 4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_synergy_dclp_sequencenumber, tvb, offset + 5, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_synergy_dclp_clipboarddata, tvb, offset + 9, -1, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void dissect_synergy_dinf( tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, gint offset )\r\n{\r\nproto_item *ti = NULL;\r\nproto_tree *sub_tree = NULL;\r\nti = proto_tree_add_item(tree, hf_synergy_dinf, tvb, offset, -1, ENC_NA);\r\nsub_tree = proto_item_add_subtree(ti, ett_synergy);\r\nproto_tree_add_item(sub_tree, hf_synergy_dinf_clp, tvb, offset + 4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_synergy_dinf_ctp, tvb, offset + 6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_synergy_dinf_wsp, tvb, offset + 8, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_synergy_dinf_hsp, tvb, offset + 10, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_synergy_dinf_swz, tvb, offset + 12, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_synergy_dinf_x, tvb, offset + 14, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_synergy_dinf_y, tvb, offset + 16, 2, ENC_BIG_ENDIAN);\r\n}\r\nstatic void dissect_synergy_eicv( tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, gint offset )\r\n{\r\nproto_item *ti = NULL;\r\nproto_tree *sub_tree = NULL;\r\nti = proto_tree_add_item(tree, hf_synergy_eicv, tvb, offset, -1, ENC_NA);\r\nsub_tree = proto_item_add_subtree(ti, ett_synergy);\r\nproto_tree_add_item(sub_tree, hf_synergy_eicv_majorversion, tvb, offset + 4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sub_tree, hf_synergy_eicv_minorversion, tvb, offset + 6, 2, ENC_BIG_ENDIAN);\r\n}\r\nvoid\r\nproto_register_synergy(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_synergy_unknown,\r\n{ "unknown","synergy.unknown",FT_NONE, BASE_NONE, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_handshake,\r\n{ "Handshake","synergy.handshake",FT_NONE, BASE_NONE, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_handshake_majorversion,\r\n{ "Major Version","synergy.handshake.majorversion",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_handshake_minorversion,\r\n{ "Minor Version","synergy.handshake.minorversion",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_handshake_clientname,\r\n{ "Client Name","synergy.handshake.client",FT_STRING, BASE_NONE, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_calv,\r\n{ "Keep Alive","synergy.calv",FT_NONE, BASE_NONE, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_cnop,\r\n{ "No Operation","synergy.cnop",FT_NONE, BASE_NONE, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_cbye,\r\n{ "Close Connection","synergy.cbye",FT_NONE, BASE_NONE, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_cinn,\r\n{ "Enter Screen","synergy.cinn",FT_NONE, BASE_NONE, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_cinn_x,\r\n{ "Screen X","synergy.cinn.x",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_cinn_y,\r\n{ "Screen Y","synergy.cinn.y",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_cinn_sequence,\r\n{ "Sequence Number","synergy.cinn.sequence",FT_UINT32, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_cinn_modifiermask,\r\n{ "Modifier Key Mask","synergy.cinn.mask",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_cout,\r\n{ "Leave Screen","synergy.cout",FT_NONE, BASE_NONE, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_cclp,\r\n{ "Grab Clipboard","synergy.clipboard",FT_NONE, BASE_NONE, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_cclp_clipboardidentifier,\r\n{ "Identifier","synergy.clipboard.identifier",FT_UINT8, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_cclp_sequencenumber,\r\n{ "Sequence Number","synergy.clipboard.sequence",FT_UINT32, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_csec,\r\n{ "Screen Saver Change","synergy.screensaver",FT_BOOLEAN, BASE_NONE, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_crop,\r\n{ "Reset Options","synergy.resetoptions",FT_NONE, BASE_NONE, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_ciak,\r\n{ "resolution change acknowledgment","synergy.ack",FT_NONE, BASE_NONE, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dkdn,\r\n{ "Key Pressed","synergy.keypressed",FT_NONE, BASE_NONE, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dkdn_keyid,\r\n{ "Key Id","synergy.keypressed.keyid",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dkdn_keymodifiermask,\r\n{ "Key Modifier Mask","synergy.keypressed.mask",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dkdn_keybutton,\r\n{ "Key Button","synergy.keypressed.key",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dkrp,\r\n{ "key auto-repeat","synergy.keyautorepeat",FT_NONE, BASE_NONE, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dkrp_keyid,\r\n{ "Key ID","synergy.keyautorepeat.keyid",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dkrp_keymodifiermask,\r\n{ "Key modifier Mask","synergy.keyautorepeat.mask",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dkrp_numberofrepeats,\r\n{ "Number of Repeats","synergy.keyautorepeat.repeat",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dkrp_keybutton,\r\n{ "Key Button","synergy.keyautorepeat.key",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dkup,\r\n{ "key released","synergy.keyreleased",FT_NONE, BASE_NONE, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dkup_keyid,\r\n{ "Key Id","synergy.keyreleased.keyid",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dkup_keymodifiermask,\r\n{ "Key Modifier Mask","synergy.keyreleased.mask",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dkup_keybutton,\r\n{ "Key Button","synergy.keyreleased.key",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dmdn,\r\n{ "Mouse Button Pressed","synergy.mousebuttonpressed",FT_UINT8, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dmup,\r\n{ "Mouse Button Released","synergy.mousebuttonreleased",FT_UINT8, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dmmv,\r\n{ "Mouse Moved","synergy.mousemoved",FT_NONE, BASE_NONE, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dmmv_x,\r\n{ "X Axis","synergy.mousemoved.x",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dmmv_y,\r\n{ "Y Axis","synergy.mousemoved.y",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dmrm,\r\n{ "Relative Mouse Move","synergy.relativemousemove",FT_NONE, BASE_NONE, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dmrm_x,\r\n{ "X Axis","synergy.relativemousemove.x",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dmrm_y,\r\n{ "Y Axis","synergy.relativemousemove.y",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dmwm,\r\n{ "Mouse Button Pressed","synergy.mousebuttonpressed",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dclp,\r\n{ "Clipboard Data","synergy.clipboarddata",FT_NONE, BASE_NONE, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dclp_clipboardidentifier,\r\n{ "Clipboard Identifier","synergy.clipboarddata.identifier",FT_UINT8, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dclp_sequencenumber,\r\n{ "Sequence Number","synergy.clipboarddata.sequence",FT_UINT32, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dclp_clipboarddata,\r\n{ "Clipboard Data","synergy.clipboarddata.data",FT_STRING, BASE_NONE, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dinf,\r\n{ "Client Data","synergy.clientdata",FT_NONE, BASE_NONE, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dinf_clp,\r\n{ "coordinate of leftmost pixel on secondary screen","synergy.clps",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dinf_ctp,\r\n{ "coordinate of topmost pixel on secondary screen","synergy.clps.ctp",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dinf_wsp,\r\n{ "width of secondary screen in pixels","synergy.clps.wsp",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dinf_hsp,\r\n{ "height of secondary screen in pixels","synergy.clps.hsp",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dinf_swz,\r\n{ "size of warp zone","synergy.clps.swz",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dinf_x,\r\n{ "x position of the mouse on the secondary screen","synergy.clps.x",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dinf_y,\r\n{ "y position of the mouse on the secondary screen","synergy.clps.y",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_dsop,\r\n{ "Set Options","synergy.setoptions",FT_UINT32, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_qinf,\r\n{ "Query Screen Info","synergy.qinf",FT_NONE, BASE_NONE, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_eicv,\r\n{ "incompatible versions","synergy.eicv",FT_NONE, BASE_NONE, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_eicv_majorversion,\r\n{ "Major Version Number","synergy.eicv.major",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_eicv_minorversion,\r\n{ "Minor Version Number","synergy.eicv.minor",FT_UINT16, BASE_DEC, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_ebsy,\r\n{ "Connection Already in Use","synergy.ebsy",FT_NONE, BASE_NONE, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_eunk,\r\n{ "Unknown Client","synergy.unknown",FT_NONE, BASE_NONE, NULL, 0x0,NULL, HFILL }\r\n},\r\n{ &hf_synergy_ebad,\r\n{ "protocol violation","synergy.violation",FT_NONE, BASE_NONE, NULL, 0x0,NULL, HFILL }\r\n},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_synergy,\r\n};\r\nproto_synergy = proto_register_protocol("Synergy",\r\n"Synergy", "synergy");\r\nproto_register_field_array(proto_synergy, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nregister_dissector("synergy", dissect_synergy, proto_synergy);\r\n}\r\nvoid\r\nproto_reg_handoff_synergy(void)\r\n{\r\ndissector_handle_t synergy_handle;\r\nsynergy_handle = find_dissector("synergy");\r\ndissector_add_uint("tcp.port",24800, synergy_handle);\r\n}
