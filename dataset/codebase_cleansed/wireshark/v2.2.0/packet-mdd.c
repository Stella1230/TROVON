static int\r\ndissect_mdd (tvbuff_t * tvb, packet_info * pinfo, proto_tree * tree, void* data _U_)\r\n{\r\nproto_item *it;\r\nproto_tree *mdd_tree;\r\nint pos;\r\nint subpos = 0;\r\ngint len;\r\nguint8 type, length;\r\nguint8 subtype, sublength;\r\nint i;\r\nproto_tree *tlv_tree;\r\nproto_tree *tlv_sub_tree;\r\nproto_item *text_item;\r\nlen = tvb_reported_length_remaining (tvb, 0);\r\ncol_set_str(pinfo->cinfo, COL_INFO, "MDD Message:");\r\nif (tree)\r\n{\r\nit = proto_tree_add_protocol_format (tree, proto_docsis_mdd, tvb, 0, -1,"MDD Message");\r\nmdd_tree = proto_item_add_subtree (it, ett_docsis_mdd);\r\nproto_tree_add_item (mdd_tree, hf_docsis_mdd_ccc, tvb, 0, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (mdd_tree, hf_docsis_mdd_number_of_fragments, tvb, 1, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (mdd_tree, hf_docsis_mdd_fragment_sequence_number, tvb, 2, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (mdd_tree, hf_docsis_mdd_current_channel_dcid, tvb, 3, 1, ENC_BIG_ENDIAN);\r\npos = 4;\r\nwhile (pos < len)\r\n{\r\ntype = tvb_get_guint8 (tvb, pos);\r\nlength = tvb_get_guint8 (tvb, pos + 1);\r\ntlv_tree = proto_tree_add_subtree(mdd_tree, tvb, pos, length + 2, ett_tlv, NULL, val_to_str(type, mdd_tlv_vals, "Unknown TLV (%u)"));\r\nswitch(type) {\r\ncase DOWNSTREAM_ACTIVE_CHANNEL_LIST:\r\nsubpos = pos + 2;\r\nwhile (subpos < pos + length + 2) {\r\nsubtype = tvb_get_guint8 (tvb, subpos);\r\nsublength = tvb_get_guint8 (tvb, subpos + 1);\r\nswitch(subtype) {\r\ncase DOWNSTREAM_ACTIVE_CHANNEL_LIST_CHANNEL_ID:\r\nproto_tree_add_item (tlv_tree, hf_docsis_mdd_downstream_active_channel_list_channel_id, tvb, subpos + 2 , 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase DOWNSTREAM_ACTIVE_CHANNEL_LIST_FREQUENCY:\r\nproto_tree_add_item (tlv_tree, hf_docsis_mdd_downstream_active_channel_list_frequency, tvb, subpos + 2 , 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase DOWNSTREAM_ACTIVE_CHANNEL_LIST_MODULATION_ORDER_ANNEX:\r\ntlv_sub_tree = proto_tree_add_subtree(tlv_tree, tvb, subpos + 2, 1, ett_sub_tlv, NULL, "Modulation Order/Annex");\r\nproto_tree_add_item (tlv_sub_tree, hf_docsis_mdd_downstream_active_channel_list_modulation_order, tvb, subpos + 2 , 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tlv_sub_tree, hf_docsis_mdd_downstream_active_channel_list_annex, tvb, subpos + 2 , 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase DOWNSTREAM_ACTIVE_CHANNEL_LIST_PRIMARY_CAPABLE:\r\nproto_tree_add_item (tlv_tree, hf_docsis_mdd_downstream_active_channel_list_primary_capable, tvb, subpos + 2 , 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase DOWNSTREAM_ACTIVE_CHANNEL_LIST_CM_STATUS_EVENT_ENABLE_BITMASK:\r\ntlv_sub_tree = proto_tree_add_subtree(tlv_tree, tvb, subpos + 2, 2, ett_sub_tlv, NULL, "CM-STATUS Event Enable Bitmask");\r\nproto_tree_add_item (tlv_sub_tree, hf_docsis_mdd_cm_status_event_enable_bitmask_mdd_timeout, tvb, subpos + 2 , 2,ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tlv_sub_tree, hf_docsis_mdd_cm_status_event_enable_bitmask_qam_fec_lock_failure, tvb, subpos + 2 , 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tlv_sub_tree, hf_docsis_mdd_cm_status_event_enable_bitmask_mdd_recovery, tvb, subpos + 2 , 2,ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tlv_sub_tree, hf_docsis_mdd_cm_status_event_enable_bitmask_qam_fec_lock_recovery, tvb, subpos + 2 , 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase DOWNSTREAM_ACTIVE_CHANNEL_LIST_MAP_UCD_TRANSPORT_INDICATOR:\r\nproto_tree_add_item (tlv_tree, hf_docsis_mdd_downstream_active_channel_list_map_ucd_transport_indicator, tvb, subpos + 2 , 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase DOWNSTREAM_ACTIVE_CHANNEL_LIST_OFDM_PLC_PARAMETERS:\r\ntlv_sub_tree = proto_tree_add_subtree(tlv_tree, tvb, subpos + 2, 1, ett_sub_tlv, NULL, "OFDM PLC Parameters");\r\nproto_tree_add_item (tlv_sub_tree, hf_docsis_mdd_ofdm_plc_parameters_tukey_raised_cosine_window, tvb, subpos + 2 , 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tlv_sub_tree, hf_docsis_mdd_ofdm_plc_parameters_cyclic_prefix, tvb, subpos + 2 , 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tlv_sub_tree, hf_docsis_mdd_ofdm_plc_parameters_sub_carrier_spacing, tvb, subpos + 2 , 1, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\nsubpos += sublength + 2;\r\n}\r\nbreak;\r\ncase MAC_DOMAIN_DOWNSTREAM_SERVICE_GROUP:\r\nsubpos = pos + 2;\r\nwhile (subpos < pos + length + 2) {\r\nsubtype = tvb_get_guint8 (tvb, subpos);\r\nsublength = tvb_get_guint8 (tvb, subpos + 1);\r\nswitch(subtype) {\r\ncase MAC_DOMAIN_DOWNSTREAM_SERVICE_GROUP_MD_DS_SG_IDENTIFIER:\r\nproto_tree_add_item (tlv_tree, hf_docsis_mdd_mac_domain_downstream_service_group_md_ds_sg_identifier, tvb, subpos + 2 , 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase MAC_DOMAIN_DOWNSTREAM_SERVICE_GROUP_CHANNEL_IDS:\r\nfor (i = 0; i < sublength; i++) {\r\nproto_tree_add_item (tlv_tree, hf_docsis_mdd_mac_domain_downstream_service_group_channel_id, tvb, subpos + 2 + i , 1, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\n}\r\nsubpos += sublength + 2;\r\n}\r\nbreak;\r\ncase DOWNSTREAM_AMBIGUITY_RESOLUTION_FREQUENCY_LIST:\r\nsubpos = pos + 2;\r\nfor (i = 0; i < length; i+=4) {\r\nproto_tree_add_item (tlv_tree, hf_docsis_mdd_downstream_ambiguity_resolution_frequency, tvb, subpos + i , 4, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase RECEIVE_CHANNEL_PROFILE_REPORTING_CONTROL:\r\nsubpos = pos + 2;\r\nwhile (subpos < pos + length + 2) {\r\nsubtype = tvb_get_guint8 (tvb, subpos);\r\nsublength = tvb_get_guint8 (tvb, subpos + 1);\r\nswitch(subtype) {\r\ncase RCP_CENTER_FREQUENCY_SPACING:\r\nproto_tree_add_item (tlv_tree, hf_docsis_mdd_rpc_center_frequency_spacing, tvb, subpos + 2 , 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase VERBOSE_RCP_REPORTING:\r\nproto_tree_add_item (tlv_tree, hf_docsis_mdd_verbose_rcp_reporting, tvb, subpos + 2 , 1, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\nsubpos += sublength + 2;\r\n}\r\nbreak;\r\ncase IP_INITIALIZATION_PARAMETERS:\r\nsubpos = pos + 2;\r\nwhile (subpos < pos + length + 2) {\r\nsubtype = tvb_get_guint8 (tvb, subpos);\r\nsublength = tvb_get_guint8 (tvb, subpos + 1);\r\nswitch(subtype) {\r\ncase IP_PROVISIONING_MODE:\r\nproto_tree_add_item (tlv_tree, hf_docsis_mdd_ip_provisioning_mode, tvb, subpos + 2 , 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase PRE_REGISTRATION_DSID:\r\nproto_tree_add_item (tlv_tree, hf_docsis_mdd_pre_registration_dsid, tvb, subpos + 2 , 3, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\nsubpos += sublength + 2;\r\n}\r\nbreak;\r\ncase EARLY_AUTHENTICATION_AND_ENCRYPTION:\r\nsubpos = pos + 2;\r\nproto_tree_add_item (tlv_tree, hf_docsis_mdd_early_authentication_and_encryption, tvb, subpos, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase UPSTREAM_ACTIVE_CHANNEL_LIST:\r\nsubpos = pos + 2;\r\nwhile (subpos < pos + length + 2) {\r\nsubtype = tvb_get_guint8 (tvb, subpos);\r\nsublength = tvb_get_guint8 (tvb, subpos + 1);\r\nswitch(subtype) {\r\ncase UPSTREAM_ACTIVE_CHANNEL_LIST_UPSTREAM_CHANNEL_ID:\r\nproto_tree_add_item (tlv_tree, hf_docsis_mdd_upstream_active_channel_list_upstream_channel_id, tvb, subpos + 2 , 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase UPSTREAM_ACTIVE_CHANNEL_LIST_CM_STATUS_EVENT_ENABLE_BITMASK:\r\ntlv_sub_tree = proto_tree_add_subtree(tlv_tree, tvb, subpos + 2, 2, ett_sub_tlv, NULL, "CM-STATUS Event Enable Bitmask");\r\nproto_tree_add_item (tlv_sub_tree, hf_docsis_mdd_cm_status_event_enable_bitmask_t4_timeout, tvb, subpos + 2 , 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tlv_sub_tree, hf_docsis_mdd_cm_status_event_enable_bitmask_t3_retries_exceeded, tvb, subpos + 2 , 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tlv_sub_tree, hf_docsis_mdd_cm_status_event_enable_bitmask_successful_ranging_after_t3_retries_exceeded, tvb, subpos + 2 , 2, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\nsubpos += sublength + 2;\r\n}\r\nbreak;\r\ncase UPSTREAM_AMBIGUITY_RESOLUTION_CHANNEL_LIST:\r\nsublength = tvb_get_guint8 (tvb, subpos + 1);\r\nfor (i = 0; i < sublength; i++) {\r\nproto_tree_add_item (tlv_tree, hf_docsis_mdd_upstream_ambiguity_resolution_channel_list_channel_id, tvb, pos + 2 + i , 1, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase UPSTREAM_FREQUENCY_RANGE:\r\nsubpos = pos + 2;\r\nproto_tree_add_item (tlv_tree, hf_docsis_mdd_upstream_frequency_range, tvb, subpos, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase SYMBOL_CLOCK_LOCKING_INDICATOR:\r\nsubpos = pos + 2;\r\nproto_tree_add_item (tlv_tree, hf_docsis_mdd_symbol_clock_locking_indicator, tvb, subpos, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase CM_STATUS_EVENT_CONTROL:\r\nsubpos = pos + 2;\r\nwhile (subpos < pos + length + 2) {\r\nsubtype = tvb_get_guint8 (tvb, subpos);\r\nsublength = tvb_get_guint8 (tvb, subpos + 1);\r\nswitch(subtype) {\r\ncase EVENT_TYPE_CODE:\r\nproto_tree_add_item (tlv_tree, hf_docsis_mdd_event_type, tvb, subpos+2, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase MAXIMUM_EVENT_HOLDOFF_TIMER:\r\ntext_item = proto_tree_add_item (tlv_tree, hf_docsis_mdd_maximum_event_holdoff_timer, tvb, subpos, 2, ENC_BIG_ENDIAN);\r\nproto_item_append_text(text_item, " (%d ms)", (256*tvb_get_guint8 (tvb, subpos) + tvb_get_guint8 (tvb, subpos + 1)) * 20);\r\nbreak;\r\ncase MAXIMUM_NUMBER_OF_REPORTS_PER_EVENT:\r\ntext_item = proto_tree_add_item (tlv_tree, hf_docsis_mdd_maximum_number_of_reports_per_event, tvb, subpos, 1, ENC_BIG_ENDIAN);\r\nif ( tvb_get_guint8 (tvb, subpos) == 0) {\r\nproto_item_append_text(text_item, " (Unlimited)");\r\n}\r\nbreak;\r\n}\r\nsubpos += sublength + 2;\r\n}\r\nbreak;\r\ncase UPSTREAM_TRANSMIT_POWER_REPORTING:\r\nsubpos = pos + 2;\r\nproto_tree_add_item (tlv_tree, hf_docsis_mdd_upstream_transmit_power_reporting, tvb, subpos, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase DSG_DA_TO_DSID_ASSOCIATION_ENTRY:\r\nsubpos = pos + 2;\r\nwhile (subpos < pos + length + 2) {\r\nsubtype = tvb_get_guint8 (tvb, subpos);\r\nsublength = tvb_get_guint8 (tvb, subpos + 1);\r\nswitch(subtype) {\r\ncase DSG_DA_TO_DSID_ASSOCIATION_DA:\r\nproto_tree_add_item (tlv_tree, hf_docsis_mdd_dsg_da_to_dsid_association_da, tvb, subpos + 2, 6, ENC_NA);\r\nbreak;\r\ncase DSG_DA_TO_DSID_ASSOCIATION_DSID:\r\nproto_tree_add_item (tlv_tree, hf_docsis_mdd_dsg_da_to_dsid_association_dsid, tvb, subpos + 2, 3, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\nsubpos += sublength + 2;\r\n}\r\nbreak;\r\ncase CM_STATUS_EVENT_ENABLE_NON_CHANNEL_SPECIFIC_EVENTS:\r\nsubpos = pos + 2;\r\ntlv_sub_tree = proto_tree_add_subtree(tlv_tree, tvb, subpos, 2, ett_sub_tlv, NULL, "CM-STATUS Event Enable Bitmask for Non-Channel-Specific Events");\r\nproto_tree_add_item (tlv_sub_tree, hf_docsis_mdd_cm_status_event_enable_non_channel_specific_events_sequence_out_of_range, tvb, subpos, 2,ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tlv_sub_tree, hf_docsis_mdd_cm_status_event_enable_non_channel_specific_events_cm_operating_on_battery_backup, tvb, subpos , 2,ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tlv_sub_tree, hf_docsis_mdd_cm_status_event_enable_non_channel_specific_events_cm_returned_to_ac_power, tvb, subpos , 2,ENC_BIG_ENDIAN);\r\nbreak;\r\ncase EXTENDED_UPSTREAM_TRANSMIT_POWER_SUPPORT:\r\nsubpos = pos + 2;\r\nproto_tree_add_item (tlv_tree, hf_docsis_mdd_extended_upstream_transmit_power_support, tvb, subpos, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\npos += length + 2;\r\n}\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid proto_register_docsis_mdd (void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{&hf_docsis_mdd_ccc,\r\n{"Configuration Change Count", "docsis_mdd.ccc",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Mdd Configuration Change Count", HFILL}\r\n},\r\n{&hf_docsis_mdd_number_of_fragments,\r\n{"Number of Fragments", "docsis_mdd.number_of_fragments",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Mdd Number of Fragments", HFILL}\r\n},\r\n{&hf_docsis_mdd_fragment_sequence_number,\r\n{"Fragment Sequence Number", "docsis_mdd.fragment_sequence_number",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Mdd Fragment Sequence Number", HFILL}\r\n},\r\n{&hf_docsis_mdd_current_channel_dcid,\r\n{"Current Channel DCID", "docsis_mdd.current_channel_dcid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Mdd Current Channel DCID", HFILL}\r\n},\r\n{&hf_docsis_mdd_downstream_active_channel_list_channel_id,\r\n{"Channel ID", "docsis_mdd.downstream_active_channel_list_channel_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Mdd Downstream Active Channel List Channel ID", HFILL}\r\n},\r\n{&hf_docsis_mdd_downstream_active_channel_list_frequency,\r\n{"Frequency", "docsis_mdd.downstream_active_channel_list_frequency",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Mdd Downstream Active Channel List Frequency", HFILL}\r\n},\r\n{&hf_docsis_mdd_downstream_active_channel_list_annex,\r\n{"Annex", "docsis_mdd.downstream_active_channel_list_annex",\r\nFT_UINT8, BASE_DEC, VALS(J83_annex_vals), 0xF0,\r\n"Mdd Downstream Active Channel List Annex", HFILL}\r\n},\r\n{&hf_docsis_mdd_downstream_active_channel_list_modulation_order,\r\n{"Modulation Order", "docsis_mdd.downstream_active_channel_list_modulation_order",\r\nFT_UINT8, BASE_DEC, VALS(modulation_order_vals), 0x0F,\r\n"Mdd Downstream Active Channel List Modulation Order", HFILL}\r\n},\r\n{&hf_docsis_mdd_downstream_active_channel_list_primary_capable,\r\n{"Primary Capable", "docsis_mdd.downstream_active_channel_list_primary_capable",\r\nFT_UINT8, BASE_DEC, VALS(primary_capable_vals), 0x0,\r\n"Mdd Downstream Active Channel List Primary Capable", HFILL}\r\n},\r\n{&hf_docsis_mdd_cm_status_event_enable_bitmask_mdd_timeout,\r\n{"MDD Timeout", "docsis_mdd.downstream_active_channel_list_mdd_timeout",\r\nFT_UINT16, BASE_DEC, NULL, 0x0002,\r\n"Mdd Downstream Active Channel List MDD Timeout", HFILL}\r\n},\r\n{&hf_docsis_mdd_cm_status_event_enable_bitmask_qam_fec_lock_failure,\r\n{"QAM/FEC Lock Failure", "docsis_mdd.cm_status_event_enable_bitmask_qam_fec_lock_failure",\r\nFT_UINT16, BASE_DEC, NULL, 0x0004,\r\n"Mdd Downstream Active Channel List QAM/FEC Lock Failure", HFILL}\r\n},\r\n{&hf_docsis_mdd_cm_status_event_enable_bitmask_mdd_recovery,\r\n{"MDD Recovery", "docsis_mdd.cm_status_event_enable_bitmask_mdd_recovery",\r\nFT_UINT16, BASE_DEC, NULL, 0x0010,\r\n"CM-STATUS event MDD Recovery", HFILL}\r\n},\r\n{&hf_docsis_mdd_cm_status_event_enable_bitmask_qam_fec_lock_recovery,\r\n{"QAM/FEC Lock Recovery", "docsis_mdd.cm_status_event_enable_bitmask_qam_fec_lock_recovery",\r\nFT_UINT16, BASE_DEC, NULL, 0x0020,\r\n"CM-STATUS event QAM/FEC Lock Recovery", HFILL}\r\n},\r\n{&hf_docsis_mdd_downstream_active_channel_list_map_ucd_transport_indicator,\r\n{"MAP and UCD transport indicator", "docsis_mdd.downstream_active_channel_list_map_ucd_transport_indicator",\r\nFT_UINT8, BASE_DEC, VALS(map_ucd_transport_indicator_vals), 0x0,\r\n"Mdd Downstream Active Channel List MAP and UCD Transport Indicator", HFILL}\r\n},\r\n{&hf_docsis_mdd_ofdm_plc_parameters_tukey_raised_cosine_window,\r\n{"Tukey raised cosine window", "docsis_mdd.ofdm_plc_parameters_tukey_raised_cosine_window",\r\nFT_UINT8, BASE_DEC, VALS(tukey_raised_cosine_vals), 0x07,\r\n"OFDM PLC Parameters Tukey raised cosine window", HFILL}\r\n},\r\n{&hf_docsis_mdd_ofdm_plc_parameters_cyclic_prefix,\r\n{"Cyclic prefix", "docsis_mdd.ofdm_plc_parameters_cyclic_prefix",\r\nFT_UINT8, BASE_DEC, VALS(cyclic_prefix_vals), 0x38,\r\n"OFDM PLC parameters Cyclic prefix", HFILL}\r\n},\r\n{&hf_docsis_mdd_ofdm_plc_parameters_sub_carrier_spacing,\r\n{"Sub carrier spacing", "docsis_mdd.ofdm_plc_parameters_sub_carrier_spacing",\r\nFT_UINT8, BASE_DEC, VALS(spacing_vals), 0x40,\r\n"OFDM PLC parameters Sub carrier spacing", HFILL}\r\n},\r\n{&hf_docsis_mdd_cm_status_event_enable_bitmask_t4_timeout,\r\n{"T4 timeout", "docsis_mdd.cm_status_event_enable_bitmask_t4_timeout",\r\nFT_UINT16, BASE_DEC, NULL, 0x0040,\r\n"CM-STATUS event T4 timeout", HFILL}\r\n},\r\n{&hf_docsis_mdd_cm_status_event_enable_bitmask_t3_retries_exceeded,\r\n{"T3 Retries Exceeded", "docsis_mdd.cm_status_event_enable_bitmask_t3_retries_exceeded",\r\nFT_UINT16, BASE_DEC, NULL, 0x0080,\r\n"CM-STATUS event T3 Retries Exceeded", HFILL}\r\n},\r\n{&hf_docsis_mdd_cm_status_event_enable_bitmask_successful_ranging_after_t3_retries_exceeded,\r\n{"Successful Ranging after T3 Retries Exceeded", "docsis_mdd.cm_status_event_enable_bitmask_successful_ranging_after_t3_retries_exceeded",\r\nFT_UINT16, BASE_DEC, NULL, 0x0100,\r\n"CM-STATUS event Successful Ranging after T3 Retries Exceeded", HFILL}\r\n},\r\n{&hf_docsis_mdd_mac_domain_downstream_service_group_channel_id,\r\n{"Channel Id", "docsis_mdd.mac_domain_downstream_service_group_channel_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Mdd Mac Domain Downstream Service Group Channel Id", HFILL}\r\n},\r\n{&hf_docsis_mdd_mac_domain_downstream_service_group_md_ds_sg_identifier,\r\n{"MD-DS-SG Identifier", "docsis_mdd.mac_domain_downstream_service_group_md_ds_sg_identifier",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Mdd Mac Domain Downstream Service Group MD-DS-SG Identifier", HFILL}\r\n},\r\n{&hf_docsis_mdd_downstream_ambiguity_resolution_frequency,\r\n{"Frequency", "docsis_mdd.downstream_ambiguity_resolution_frequency",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Mdd Downstream Ambiguity Resolution frequency", HFILL}\r\n},\r\n{&hf_docsis_mdd_rpc_center_frequency_spacing,\r\n{"RPC Center Frequency Spacing", "docsis_mdd.rpc_center_frequency_spacing",\r\nFT_UINT8, BASE_DEC, VALS(rpc_center_frequency_spacing_vals), 0x0,\r\n"Mdd RPC Center Frequency Spacing", HFILL}\r\n},\r\n{&hf_docsis_mdd_verbose_rcp_reporting,\r\n{"Verbose RCP reporting", "docsis_mdd.verbose_rpc_reporting",\r\nFT_UINT8, BASE_DEC, VALS(verbose_rpc_reporting_vals), 0x0,\r\n"Mdd Verbose RPC Reporting", HFILL}\r\n},\r\n{&hf_docsis_mdd_ip_provisioning_mode,\r\n{"IP Provisioning Mode", "docsis_mdd.ip_provisioning_mode",\r\nFT_UINT8, BASE_DEC, VALS(ip_provisioning_mode_vals), 0x0,\r\n"Mdd IP Provisioning Mode", HFILL}\r\n},\r\n{&hf_docsis_mdd_pre_registration_dsid,\r\n{"Pre-registration DSID", "docsis_mdd.pre_registration_dsid",\r\nFT_UINT24, BASE_DEC, NULL, 0x0FFFFF,\r\n"Mdd Pre-registration DSID", HFILL}\r\n},\r\n{&hf_docsis_mdd_early_authentication_and_encryption,\r\n{"Early Authentication and Encryption", "docsis_mdd.early_authentication_and_encryption",\r\nFT_UINT8, BASE_DEC, VALS(eae_vals), 0x0,\r\n"Mdd Early Authentication and Encryption", HFILL}\r\n},\r\n{&hf_docsis_mdd_upstream_active_channel_list_upstream_channel_id,\r\n{"Upstream Channel Id", "docsis_mdd.upstream_active_channel_list_upstream_channel_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Mdd Upstream Active Channel List Upstream Channel Id", HFILL}\r\n},\r\n{&hf_docsis_mdd_upstream_ambiguity_resolution_channel_list_channel_id,\r\n{"Channel Id", "docsis_mdd.upstream_ambiguity_resolution_channel_list_channel_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Mdd Mac Domain Upstream Ambiguity Resolution Channel List Channel Id", HFILL}\r\n},\r\n{&hf_docsis_mdd_upstream_frequency_range,\r\n{"Upstream Frequency Range", "docsis_mdd.upstream_frequency_range",\r\nFT_UINT8, BASE_DEC, VALS(upstream_frequency_range_vals), 0x0,\r\n"Mdd Upstream Frequency Range", HFILL}\r\n},\r\n{&hf_docsis_mdd_symbol_clock_locking_indicator,\r\n{"Symbol Clock Locking Indicator", "docsis_mdd.symbol_clock_locking_indicator",\r\nFT_UINT8, BASE_DEC, VALS(symbol_clock_locking_indicator_vals), 0x0,\r\n"Mdd Symbol Clock Locking Indicator", HFILL}\r\n},\r\n{&hf_docsis_mdd_event_type,\r\n{"Event Type", "docsis_mdd.event_type",\r\nFT_UINT8, BASE_DEC, VALS(symbol_cm_status_event_vals), 0x0,\r\n"Mdd CM-STATUS Event Type", HFILL}\r\n},\r\n{&hf_docsis_mdd_maximum_event_holdoff_timer,\r\n{"Maximum Event Holdoff Timer (units of 20 ms)", "docsis_mdd.maximum_event_holdoff_timer",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Mdd Maximum Event Holdoff Timer", HFILL}\r\n},\r\n{&hf_docsis_mdd_maximum_number_of_reports_per_event,\r\n{"Maximum Number of Reports per Event", "docsis_mdd.maximum_number_of_reports_per_event",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Mdd Maximum Number of Reports per Event", HFILL}\r\n},\r\n{&hf_docsis_mdd_upstream_transmit_power_reporting,\r\n{"Upstream Transmit Power Reporting", "docsis_mdd.upstream_transmit_power_reporting",\r\nFT_UINT8, BASE_DEC, VALS(upstream_transmit_power_reporting_vals), 0x0,\r\n"Mdd Upstream Transmit Power Reporting", HFILL}\r\n},\r\n{&hf_docsis_mdd_dsg_da_to_dsid_association_da,\r\n{"Destination Address", "docsis_mdd.dsg_da_to_dsid_association_da",\r\nFT_ETHER, BASE_NONE, NULL, 0x0,\r\n"Mdd DSG DA to DSID association Destination Address", HFILL}\r\n},\r\n{&hf_docsis_mdd_dsg_da_to_dsid_association_dsid,\r\n{"DSID", "docsis_mdd.dsg_da_to_dsid_association_dsid",\r\nFT_UINT24, BASE_DEC, NULL, 0x0FFFFF,\r\n"Mdd Mdd DSG DA to DSID association DSID", HFILL}\r\n},\r\n{&hf_docsis_mdd_cm_status_event_enable_non_channel_specific_events_sequence_out_of_range,\r\n{"Sequence out of range", "docsis_mdd.cm_status_event_enable_non_channel_specific_events_sequence_out_of_range",\r\nFT_UINT16, BASE_DEC, NULL, 0x0008,\r\n"CM-STATUS event non-channel-event Sequence out of range", HFILL}\r\n},\r\n{&hf_docsis_mdd_cm_status_event_enable_non_channel_specific_events_cm_operating_on_battery_backup,\r\n{"CM operating on battery backup", "docsis_mdd.cm_status_event_enable_non_channel_specific_events_cm_operating_on_battery_backup",\r\nFT_UINT16, BASE_DEC, NULL, 0x0200,\r\n"CM-STATUS event non-channel-event Cm operating on battery backup", HFILL}\r\n},\r\n{&hf_docsis_mdd_cm_status_event_enable_non_channel_specific_events_cm_returned_to_ac_power,\r\n{"Returned to AC power", "docsis_mdd.cm_status_event_enable_non_channel_specific_events_cm_returned_to_ac_power",\r\nFT_UINT16, BASE_DEC, NULL, 0x0400,\r\n"CM-STATUS event non-channel-event Cm returned to AC power", HFILL}\r\n},\r\n{&hf_docsis_mdd_extended_upstream_transmit_power_support,\r\n{ "Extended Upstream Transmit Power Support", "docsis_mdd.extended_upstream_transmit_power_support",\r\nFT_BOOLEAN, BASE_NONE, TFS(&mdd_tfs_on_off), 0x0,\r\n"Mdd Extended Upstream Transmit Power Support", HFILL}\r\n},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_docsis_mdd,\r\n&ett_tlv,\r\n&ett_sub_tlv\r\n};\r\nproto_docsis_mdd =\r\nproto_register_protocol ("DOCSIS Mac Domain Description",\r\n"DOCSIS Mdd", "docsis_mdd");\r\nproto_register_field_array (proto_docsis_mdd, hf, array_length (hf));\r\nproto_register_subtree_array (ett, array_length (ett));\r\nregister_dissector ("docsis_mdd", dissect_mdd, proto_docsis_mdd);\r\n}\r\nvoid\r\nproto_reg_handoff_docsis_mdd (void)\r\n{\r\ndissector_handle_t docsis_mdd_handle;\r\ndocsis_mdd_handle = find_dissector ("docsis_mdd");\r\ndissector_add_uint ("docsis_mgmt", 33, docsis_mdd_handle);\r\n}
