static void\r\ndissect_rdmap_payload(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, struct rdmapinfo *info)\r\n{\r\nheur_dtbl_entry_t *hdtbl_entry;\r\nif (!dissector_try_heuristic(rdmap_heur_subdissector_list,\r\ntvb, pinfo, tree, &hdtbl_entry, info)) {\r\ncall_data_dissector(tvb, pinfo, tree);\r\n}\r\n}\r\nstatic void\r\nddp_rdma_packetlist(packet_info *pinfo, gboolean ddp_last_flag,\r\nguint8 rdma_msg_opcode)\r\n{\r\nconst gchar *ddp_fragment_state;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "DDP/RDMA");\r\nif (ddp_last_flag) {\r\nddp_fragment_state = "[last DDP segment]";\r\n} else {\r\nddp_fragment_state = "[more DDP segments]";\r\n}\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "%d > %d %s %s", pinfo->srcport,\r\npinfo->destport, val_to_str(rdma_msg_opcode, rdmap_messages,\r\n"Unknown %d"), ddp_fragment_state);\r\n}\r\nstatic void\r\ndissect_iwarp_rdmap(tvbuff_t *tvb, proto_tree *rdma_tree, guint32 offset,\r\nguint8 rdma_msg_opcode)\r\n{\r\nproto_tree *rdma_header_tree = NULL;\r\nproto_tree *term_ctrl_field_tree = NULL;\r\nproto_tree *header_ctrl_field_tree = NULL;\r\nproto_item *rdma_header_subitem = NULL;\r\nproto_item *term_ctrl_field_subitem = NULL;\r\nproto_item *header_ctrl_field_subitem = NULL;\r\nguint8 layer, etype, hdrct;\r\nguint32 rdmardsz;\r\nif (rdma_tree) {\r\nif (rdma_msg_opcode == RDMA_READ_REQUEST) {\r\nrdma_header_subitem = proto_tree_add_item(rdma_tree,\r\nhf_iwarp_rdma_rr_header, tvb, offset, -1, ENC_NA);\r\nrdma_header_tree = proto_item_add_subtree(rdma_header_subitem,\r\nett_iwarp_rdma);\r\nproto_tree_add_item(rdma_header_tree, hf_iwarp_rdma_sinkstag, tvb,\r\noffset, RDMA_SINKSTAG_LEN, ENC_BIG_ENDIAN);\r\noffset += RDMA_SINKSTAG_LEN;\r\nproto_tree_add_item(rdma_header_tree, hf_iwarp_rdma_sinkto, tvb,\r\noffset, RDMA_SINKTO_LEN, ENC_BIG_ENDIAN);\r\noffset += RDMA_SINKTO_LEN;\r\nrdmardsz = (guint32) tvb_get_ntohl(tvb, offset);\r\nproto_tree_add_uint_format_value(rdma_header_tree,\r\nhf_iwarp_rdma_rdmardsz, tvb, offset,\r\nRDMA_RDMARDSZ_LEN, rdmardsz, "%u bytes",\r\nrdmardsz);\r\noffset += RDMA_RDMARDSZ_LEN;\r\nproto_tree_add_item(rdma_header_tree, hf_iwarp_rdma_srcstag, tvb,\r\noffset, RDMA_SRCSTAG_LEN, ENC_BIG_ENDIAN);\r\noffset += RDMA_SRCSTAG_LEN;\r\nproto_tree_add_item(rdma_header_tree, hf_iwarp_rdma_srcto, tvb,\r\noffset, RDMA_SRCTO_LEN, ENC_NA);\r\noffset += RDMA_SRCTO_LEN;\r\n}\r\nif (rdma_msg_opcode == RDMA_TERMINATE) {\r\nrdma_header_subitem = proto_tree_add_item(rdma_tree,\r\nhf_iwarp_rdma_terminate_header, tvb, offset, -1, ENC_NA);\r\nrdma_header_tree = proto_item_add_subtree(rdma_header_subitem,\r\nett_iwarp_rdma);\r\nlayer = tvb_get_guint8(tvb, offset) & IWARP_LAYER;\r\netype = tvb_get_guint8(tvb, offset) & IWARP_ETYPE;\r\nterm_ctrl_field_subitem = proto_tree_add_item(rdma_tree,\r\nhf_iwarp_rdma_term_ctrl, tvb, offset, 3, ENC_NA);\r\nterm_ctrl_field_tree = proto_item_add_subtree(\r\nterm_ctrl_field_subitem, ett_iwarp_rdma);\r\nproto_tree_add_item(term_ctrl_field_tree, hf_iwarp_rdma_term_layer,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\nswitch (layer) {\r\ncase IWARP_LAYER_RDMA:\r\nproto_tree_add_item(term_ctrl_field_tree,\r\nhf_iwarp_rdma_term_etype_rdma, tvb, offset, 1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(term_ctrl_field_tree,\r\nhf_iwarp_rdma_term_errcode_rdma, tvb, offset, 1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase IWARP_LAYER_DDP:\r\nproto_tree_add_item(term_ctrl_field_tree,\r\nhf_iwarp_rdma_term_etype_ddp, tvb, offset, 1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nswitch (etype) {\r\ncase IWARP_ETYPE_DDP_TAGGED:\r\nproto_tree_add_item(term_ctrl_field_tree,\r\nhf_iwarp_rdma_term_errcode_ddp_tagged, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase IWARP_ETYPE_DDP_UNTAGGED:\r\nproto_tree_add_item(term_ctrl_field_tree,\r\nhf_iwarp_rdma_term_errcode_ddp_untagged, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(term_ctrl_field_tree,\r\nhf_iwarp_rdma_term_errcode, tvb, offset, 1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\n}\r\nbreak;\r\ncase IWARP_LAYER_LLP:\r\nproto_tree_add_item(term_ctrl_field_tree,\r\nhf_iwarp_rdma_term_etype_llp, tvb, offset, 1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(term_ctrl_field_tree,\r\nhf_iwarp_rdma_term_errcode_llp, tvb, offset, 1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(term_ctrl_field_tree,\r\nhf_iwarp_rdma_term_etype, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(term_ctrl_field_tree,\r\nhf_iwarp_rdma_term_errcode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\n}\r\nheader_ctrl_field_subitem = proto_tree_add_item(\r\nterm_ctrl_field_tree, hf_iwarp_rdma_term_hdrct, tvb,\r\noffset, 1, ENC_NA);\r\nheader_ctrl_field_tree = proto_item_add_subtree(\r\nheader_ctrl_field_subitem, ett_iwarp_rdma);\r\nhdrct = tvb_get_guint8(tvb, offset) & IWARP_HDRCT;\r\nproto_tree_add_item(header_ctrl_field_tree,\r\nhf_iwarp_rdma_term_hdrct_m, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(header_ctrl_field_tree,\r\nhf_iwarp_rdma_term_hdrct_d, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(header_ctrl_field_tree,\r\nhf_iwarp_rdma_term_hdrct_r, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(rdma_header_tree, hf_iwarp_rdma_term_rsvd, tvb,\r\noffset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nif (hdrct & IWARP_HDRCT_D) {\r\nproto_tree_add_item(rdma_header_tree,\r\nhf_iwarp_rdma_term_ddp_seg_len, tvb,\r\noffset, RDMA_DDP_SEGLEN_LEN, ENC_NA);\r\noffset += RDMA_DDP_SEGLEN_LEN;\r\nif (etype == IWARP_ETYPE_DDP_TAGGED) {\r\nproto_tree_add_item(rdma_header_tree,\r\nhf_iwarp_rdma_term_ddp_h, tvb,\r\noffset, DDP_TAGGED_HEADER_LEN, ENC_NA);\r\noffset += DDP_TAGGED_HEADER_LEN;\r\n} else {\r\nproto_tree_add_item(rdma_header_tree,\r\nhf_iwarp_rdma_term_ddp_h, tvb,\r\noffset, DDP_UNTAGGED_HEADER_LEN, ENC_NA);\r\noffset += DDP_UNTAGGED_HEADER_LEN;\r\n}\r\n}\r\nif (hdrct & IWARP_HDRCT_R) {\r\nproto_tree_add_item(rdma_header_tree, hf_iwarp_rdma_term_rdma_h,\r\ntvb, offset, RDMA_TERMINATED_RDMA_LEN, ENC_NA);\r\n}\r\n}\r\n}\r\n}\r\nstatic int\r\ndissect_iwarp_ddp_rdmap(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nproto_tree *ddp_rdma_tree = NULL;\r\nproto_tree *ddp_tree = NULL;\r\nproto_tree *ddp_ctrl_field_tree = NULL;\r\nproto_tree *ddp_buffer_model_tree = NULL;\r\nproto_tree *rdma_tree = NULL;\r\nproto_tree *rdma_ctrl_field_tree = NULL;\r\nproto_item *ddp_rdma_item = NULL;\r\nproto_item *ddp_item = NULL;\r\nproto_item *ddp_ctrl_field_item = NULL;\r\nproto_item *ddp_buffer_model_item = NULL;\r\nproto_item *rdma_item = NULL;\r\nproto_item *rdma_ctrl_field_item = NULL;\r\ntvbuff_t *next_tvb = NULL;\r\ngboolean is_tagged_buffer_model;\r\nguint8 ddp_ctrl_field, rdma_ctrl_field;\r\nstruct rdmapinfo info = { 0, };\r\nguint32 header_end;\r\nguint32 offset = 0;\r\nddp_ctrl_field = tvb_get_guint8(tvb, 0);\r\nrdma_ctrl_field = tvb_get_guint8(tvb, 1);\r\ninfo.opcode = rdma_ctrl_field & RDMA_OPCODE;\r\nis_tagged_buffer_model = ddp_ctrl_field & DDP_TAGGED_FLAG;\r\nddp_rdma_packetlist(pinfo, ddp_ctrl_field & DDP_LAST_FLAG, info.opcode);\r\noffset = 0;\r\nif (is_tagged_buffer_model) {\r\nheader_end = DDP_TAGGED_HEADER_LEN;\r\n} else {\r\nheader_end = DDP_UNTAGGED_HEADER_LEN;\r\n}\r\nif (info.opcode == RDMA_READ_REQUEST\r\n|| info.opcode == RDMA_TERMINATE) {\r\nheader_end = -1;\r\n}\r\nddp_rdma_item = proto_tree_add_item(tree, proto_iwarp_ddp_rdmap,\r\ntvb, offset, header_end, ENC_NA);\r\nddp_rdma_tree = proto_item_add_subtree(ddp_rdma_item,\r\nett_iwarp_ddp_rdmap);\r\nddp_item = proto_tree_add_item(ddp_rdma_tree, hf_iwarp_ddp, tvb,\r\noffset, header_end, ENC_NA);\r\nddp_tree = proto_item_add_subtree(ddp_item, ett_iwarp_ddp);\r\nddp_ctrl_field_item = proto_tree_add_item(ddp_tree,\r\nhf_iwarp_ddp_control_field, tvb, offset,\r\nDDP_CONTROL_FIELD_LEN, ENC_NA);\r\nddp_ctrl_field_tree = proto_item_add_subtree(ddp_ctrl_field_item,\r\nett_iwarp_ddp);\r\nproto_tree_add_item(ddp_ctrl_field_tree, hf_iwarp_ddp_t_flag, tvb,\r\noffset, DDP_CONTROL_FIELD_LEN, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ddp_ctrl_field_tree, hf_iwarp_ddp_l_flag, tvb,\r\noffset, DDP_CONTROL_FIELD_LEN, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ddp_ctrl_field_tree, hf_iwarp_ddp_rsvd, tvb,\r\noffset, DDP_CONTROL_FIELD_LEN, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ddp_ctrl_field_tree, hf_iwarp_ddp_dv, tvb, offset,\r\nDDP_CONTROL_FIELD_LEN, ENC_BIG_ENDIAN);\r\noffset += DDP_CONTROL_FIELD_LEN;\r\nif (!is_tagged_buffer_model) {\r\nproto_tree_add_item(ddp_tree, hf_iwarp_ddp_rsvdulp, tvb,\r\noffset, DDP_UNTAGGED_RSVDULP_LEN, ENC_NA);\r\n}\r\nif (is_tagged_buffer_model) {\r\nheader_end = RDMA_CONTROL_FIELD_LEN;\r\n} else {\r\nheader_end = RDMA_CONTROL_FIELD_LEN + RDMA_RESERVED_FIELD_LEN;\r\n}\r\nrdma_item = proto_tree_add_item(ddp_rdma_tree, hf_iwarp_rdma, tvb,\r\noffset, header_end, ENC_NA);\r\nrdma_tree = proto_item_add_subtree(rdma_item, ett_iwarp_rdma);\r\nrdma_ctrl_field_item = proto_tree_add_item(rdma_tree,\r\nhf_iwarp_rdma_control_field, tvb, offset,\r\nRDMA_CONTROL_FIELD_LEN, ENC_NA);\r\nrdma_ctrl_field_tree = proto_item_add_subtree(rdma_ctrl_field_item,\r\nett_iwarp_rdma);\r\nproto_tree_add_item(rdma_ctrl_field_tree, hf_iwarp_rdma_version, tvb,\r\noffset, RDMA_CONTROL_FIELD_LEN, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(rdma_ctrl_field_tree, hf_iwarp_rdma_rsvd, tvb,\r\noffset, RDMA_CONTROL_FIELD_LEN, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(rdma_ctrl_field_tree, hf_iwarp_rdma_opcode, tvb,\r\noffset, RDMA_CONTROL_FIELD_LEN, ENC_BIG_ENDIAN);\r\noffset += RDMA_CONTROL_FIELD_LEN;\r\nif (info.opcode == RDMA_READ_REQUEST\r\n|| info.opcode == RDMA_SEND\r\n|| info.opcode == RDMA_SEND_SE\r\n|| info.opcode == RDMA_TERMINATE) {\r\nproto_tree_add_item(rdma_tree, hf_iwarp_rdma_reserved,\r\ntvb, offset, RDMA_RESERVED_FIELD_LEN, ENC_NA);\r\n}\r\nif (info.opcode == RDMA_SEND_INVALIDATE\r\n|| info.opcode == RDMA_SEND_SE_INVALIDATE) {\r\nproto_tree_add_item(rdma_tree, hf_iwarp_rdma_inval_stag,\r\ntvb, offset, RDMA_INVAL_STAG_LEN, ENC_BIG_ENDIAN);\r\n}\r\nif (!is_tagged_buffer_model) {\r\noffset += RDMA_RESERVED_FIELD_LEN;\r\n}\r\nif (is_tagged_buffer_model) {\r\nddp_buffer_model_item = proto_tree_add_item(ddp_tree,\r\nhf_iwarp_ddp_tagged_header, tvb, offset,\r\nDDP_BUFFER_MODEL_LEN, ENC_NA);\r\nddp_buffer_model_tree = proto_item_add_subtree(ddp_buffer_model_item,\r\nett_iwarp_ddp);\r\nproto_tree_add_item(ddp_buffer_model_tree, hf_iwarp_ddp_stag, tvb,\r\noffset, DDP_STAG_LEN, ENC_NA);\r\noffset += DDP_STAG_LEN;\r\nproto_tree_add_item(ddp_buffer_model_tree, hf_iwarp_ddp_to, tvb,\r\noffset, DDP_TO_LEN, ENC_NA);\r\noffset += DDP_TO_LEN;\r\nif( info.opcode == RDMA_READ_RESPONSE\r\n|| info.opcode == RDMA_WRITE) {\r\nnext_tvb = tvb_new_subset_remaining(tvb, DDP_TAGGED_HEADER_LEN);\r\ndissect_rdmap_payload(next_tvb, pinfo, tree, &info);\r\n}\r\n} else {\r\nddp_buffer_model_item = proto_tree_add_item(ddp_tree,\r\nhf_iwarp_ddp_untagged_header, tvb, offset,\r\nDDP_BUFFER_MODEL_LEN, ENC_NA);\r\nddp_buffer_model_tree = proto_item_add_subtree(ddp_buffer_model_item,\r\nett_iwarp_ddp);\r\nproto_tree_add_item(ddp_buffer_model_tree, hf_iwarp_ddp_qn, tvb,\r\noffset, DDP_QN_LEN, ENC_BIG_ENDIAN);\r\noffset += DDP_QN_LEN;\r\nproto_tree_add_item(ddp_buffer_model_tree, hf_iwarp_ddp_msn, tvb,\r\noffset, DDP_MSN_LEN, ENC_BIG_ENDIAN);\r\noffset += DDP_MSN_LEN;\r\nproto_tree_add_item(ddp_buffer_model_tree, hf_iwarp_ddp_mo, tvb,\r\noffset, DDP_MO_LEN, ENC_BIG_ENDIAN);\r\noffset += DDP_MO_LEN;\r\nif (info.opcode == RDMA_SEND\r\n|| info.opcode == RDMA_SEND_INVALIDATE\r\n|| info.opcode == RDMA_SEND_SE\r\n|| info.opcode == RDMA_SEND_SE_INVALIDATE) {\r\nnext_tvb = tvb_new_subset_remaining(tvb, DDP_UNTAGGED_HEADER_LEN);\r\ndissect_rdmap_payload(next_tvb, pinfo, tree, &info);\r\n}\r\n}\r\nif (info.opcode == RDMA_READ_REQUEST\r\n|| info.opcode == RDMA_TERMINATE) {\r\ndissect_iwarp_rdmap(tvb, rdma_tree, offset, info.opcode);\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_iwarp_ddp_rdmap(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_iwarp_ddp, {\r\n"DDP header", "iwarp_ddp",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL } },\r\n{ &hf_iwarp_ddp_control_field, {\r\n"DDP control field", "iwarp_ddp.control_field",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL } },\r\n{ &hf_iwarp_ddp_tagged_header, {\r\n"Tagged buffer model", "iwarp_ddp.tagged",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\n"DDP Tagged Buffer Model Header", HFILL} },\r\n{ &hf_iwarp_ddp_untagged_header, {\r\n"Untagged buffer model", "iwarp_ddp.untagged",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\n"DDP Untagged Buffer Model Header", HFILL} },\r\n{ &hf_iwarp_ddp_t_flag, {\r\n"Tagged flag", "iwarp_ddp.tagged_flag",\r\nFT_BOOLEAN, 8, NULL, DDP_TAGGED_FLAG,\r\nNULL, HFILL} },\r\n{ &hf_iwarp_ddp_l_flag, {\r\n"Last flag", "iwarp_ddp.last_flag",\r\nFT_BOOLEAN, 8, NULL, DDP_LAST_FLAG,\r\nNULL, HFILL} },\r\n{ &hf_iwarp_ddp_rsvd, {\r\n"Reserved", "iwarp_ddp.rsvd",\r\nFT_UINT8, BASE_HEX, NULL, DDP_RSVD,\r\nNULL, HFILL} },\r\n{ &hf_iwarp_ddp_dv, {\r\n"DDP protocol version", "iwarp_ddp.dv",\r\nFT_UINT8, BASE_DEC, NULL, DDP_DV,\r\nNULL, HFILL} },\r\n{ &hf_iwarp_ddp_rsvdulp, {\r\n"Reserved for use by the ULP", "iwarp_ddp.rsvdulp",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL} },\r\n{ &hf_iwarp_ddp_stag, {\r\n"(Data Sink) Steering Tag", "iwarp_ddp.stag",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL} },\r\n{ &hf_iwarp_ddp_to, {\r\n"(Data Sink) Tagged offset", "iwarp_ddp.tagged_offset",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL} },\r\n{ &hf_iwarp_ddp_qn, {\r\n"Queue number", "iwarp_ddp.qn",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL} },\r\n{ &hf_iwarp_ddp_msn, {\r\n"Message sequence number", "iwarp_ddp.msn",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL} },\r\n{ &hf_iwarp_ddp_mo, {\r\n"Message offset", "iwarp_ddp.mo",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_iwarp_rdma, {\r\n"RDMAP header", "iwarp_rdma",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL} },\r\n{ &hf_iwarp_rdma_control_field, {\r\n"RDMAP control field", "iwarp_rdma.control_field",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\n"RDMA Control Field", HFILL} },\r\n{ &hf_iwarp_rdma_version, {\r\n"Version", "iwarp_rdma.version",\r\nFT_UINT8, BASE_DEC, NULL, RDMA_RV,\r\n"RDMA Version Field", HFILL} },\r\n{ &hf_iwarp_rdma_rsvd, {\r\n"Reserved", "iwarp_rdma.rsv",\r\nFT_UINT8, BASE_HEX, NULL, RDMA_RSV,\r\n"RDMA Control Field Reserved", HFILL} },\r\n{ &hf_iwarp_rdma_opcode, {\r\n"OpCode", "iwarp_rdma.opcode",\r\nFT_UINT8, BASE_HEX, VALS(rdmap_messages), RDMA_OPCODE,\r\n"RDMA OpCode Field", HFILL} },\r\n{ &hf_iwarp_rdma_reserved, {\r\n"Reserved", "iwarp_rdma.reserved",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL} },\r\n{ &hf_iwarp_rdma_inval_stag, {\r\n"Invalidate STag", "iwarp_rdma.inval_stag",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"RDMA Invalidate STag", HFILL} },\r\n{ &hf_iwarp_rdma_rr_header, {\r\n"Read request", "iwarp_rdma.rr",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\n"RDMA Read Request Header", HFILL} },\r\n{ &hf_iwarp_rdma_terminate_header, {\r\n"Terminate", "iwarp_rdma.terminate",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\n"RDMA Terminate Header", HFILL} },\r\n{ &hf_iwarp_rdma_sinkstag, {\r\n"Data Sink STag", "iwarp_rdma.sinkstag",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL} },\r\n{ &hf_iwarp_rdma_sinkto, {\r\n"Data Sink Tagged Offset", "iwarp_rdma.sinkto",\r\nFT_UINT64, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL} },\r\n{ &hf_iwarp_rdma_rdmardsz, {\r\n"RDMA Read Message Size", "iwarp_rdma.rdmardsz",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL} },\r\n{ &hf_iwarp_rdma_srcstag, {\r\n"Data Source STag", "iwarp_rdma.srcstag",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL} },\r\n{ &hf_iwarp_rdma_srcto, {\r\n"Data Source Tagged Offset", "iwarp_rdma.srcto",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL} },\r\n{ &hf_iwarp_rdma_term_ctrl, {\r\n"Terminate Control", "iwarp_rdma.term_ctrl",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\n"RDMA Terminate Control Field", HFILL} },\r\n{ &hf_iwarp_rdma_term_layer, {\r\n"Layer", "iwarp_rdma.term_layer",\r\nFT_UINT8, BASE_HEX, VALS(layer_names), IWARP_LAYER,\r\n"Terminate Control Field: Layer", HFILL} },\r\n{ &hf_iwarp_rdma_term_etype_rdma, {\r\n"Error Types for RDMA layer", "iwarp_rdma.term_etype_rdma",\r\nFT_UINT8, BASE_HEX, VALS(rdma_etype_names), IWARP_ETYPE,\r\n"Terminate Control Field: Error Type", HFILL} },\r\n{ &hf_iwarp_rdma_term_etype_ddp, {\r\n"Error Types for DDP layer", "iwarp_rdma.term_etype_ddp",\r\nFT_UINT8, BASE_HEX, VALS(ddp_etype_names), IWARP_ETYPE,\r\n"Terminate Control Field: Error Type", HFILL} },\r\n{ &hf_iwarp_rdma_term_etype_llp, {\r\n"Error Types for LLP layer", "iwarp_rdma.term_etype_llp",\r\nFT_UINT8, BASE_HEX, NULL, IWARP_ETYPE,\r\n"Terminate Control Field: Error Type", HFILL} },\r\n{ &hf_iwarp_rdma_term_etype, {\r\n"Error Types", "iwarp_rdma.term_etype",\r\nFT_UINT8, BASE_HEX, NULL, IWARP_ETYPE,\r\n"Terminate Control Field: Error Type", HFILL} },\r\n{ &hf_iwarp_rdma_term_errcode_rdma, {\r\n"Error Code for RDMA layer", "iwarp_rdma.term_errcode_rdma",\r\nFT_UINT8, BASE_HEX, VALS(rdma_errcode_names), 0x0,\r\n"Terminate Control Field: Error Code", HFILL} },\r\n{ &hf_iwarp_rdma_term_errcode_ddp_tagged, {\r\n"Error Code for DDP Tagged Buffer",\r\n"iwarp_rdma.term_errcode_ddp_tagged",\r\nFT_UINT8, BASE_HEX, VALS(ddp_errcode_tagged_names), 0x0,\r\n"Terminate Control Field: Error Code", HFILL} },\r\n{ &hf_iwarp_rdma_term_errcode_ddp_untagged, {\r\n"Error Code for DDP Untagged Buffer",\r\n"iwarp_rdma.term_errcode_ddp_untagged",\r\nFT_UINT8, BASE_HEX, VALS(ddp_errcode_untagged_names), 0x0,\r\n"Terminate Control Field: Error Code", HFILL} },\r\n{ &hf_iwarp_rdma_term_errcode, {\r\n"Error Code", "iwarp_rdma.term_errcode",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\n"Terminate Control Field: Error Code", HFILL} },\r\n{ &hf_iwarp_rdma_term_errcode_llp, {\r\n"Error Code for LLP layer", "iwarp_rdma.term_errcode_llp",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\n"Terminate Control Field: Lower Layer Protocol Error Code",\r\nHFILL} },\r\n{ &hf_iwarp_rdma_term_hdrct, {\r\n"Header control bits", "iwarp_rdma.term_hdrct",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\n"Terminate Control Field: Header control bits", HFILL} },\r\n{ &hf_iwarp_rdma_term_hdrct_m, {\r\n"M bit", "iwarp_rdma.term_hdrct_m",\r\nFT_UINT8, BASE_HEX, NULL, IWARP_HDRCT_M,\r\n"Header control bit m: DDP Segment Length valid", HFILL} },\r\n{ &hf_iwarp_rdma_term_hdrct_d, {\r\n"D bit", "iwarp_rdma.hdrct_d",\r\nFT_UINT8, BASE_HEX, NULL, IWARP_HDRCT_D,\r\n"Header control bit d: DDP Header Included", HFILL} },\r\n{ &hf_iwarp_rdma_term_hdrct_r, {\r\n"R bit", "iwarp_rdma.hdrct_r",\r\nFT_UINT8, BASE_HEX, NULL, IWARP_HDRCT_R,\r\n"Header control bit r: RDMAP Header Included", HFILL} },\r\n{ &hf_iwarp_rdma_term_rsvd, {\r\n"Reserved", "iwarp_rdma.term_rsvd",\r\nFT_UINT16, BASE_HEX, NULL, IWARP_TERM_RES,\r\nNULL, HFILL} },\r\n{ &hf_iwarp_rdma_term_ddp_seg_len, {\r\n"DDP Segment Length", "iwarp_rdma.term_ddp_seg_len",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL} },\r\n{ &hf_iwarp_rdma_term_ddp_h, {\r\n"Terminated DDP Header", "iwarp_rdma.term_ddp_h",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL} },\r\n{ &hf_iwarp_rdma_term_rdma_h, {\r\n"Terminated RDMA Header", "iwarp_rdma.term_rdma_h",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL} }\r\n};\r\nstatic gint *ett[] = {\r\n&ett_iwarp_ddp_rdmap,\r\n&ett_iwarp_ddp,\r\n&ett_iwarp_ddp_control_field,\r\n&ett_iwarp_ddp_tagged_header,\r\n&ett_iwarp_ddp_untagged_header,\r\n&ett_iwarp_rdma,\r\n&ett_iwarp_rdma_control_field,\r\n&ett_iwarp_rdma_rr_header,\r\n&ett_iwarp_rdma_terminate_header,\r\n&ett_iwarp_rdma_term_ctrl,\r\n&ett_iwarp_rdma_term_hdrct\r\n};\r\nproto_iwarp_ddp_rdmap = proto_register_protocol(\r\n"iWARP Direct Data Placement and Remote Direct Memory Access Protocol",\r\n"IWARP_DDP_RDMAP",\r\n"iwarp_ddp_rdmap");\r\nproto_register_field_array(proto_iwarp_ddp_rdmap, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nrdmap_heur_subdissector_list = register_heur_dissector_list("iwarp_ddp_rdmap", proto_iwarp_ddp_rdmap);\r\nregister_dissector("iwarp_ddp_rdmap", dissect_iwarp_ddp_rdmap,\r\nproto_iwarp_ddp_rdmap);\r\n}
