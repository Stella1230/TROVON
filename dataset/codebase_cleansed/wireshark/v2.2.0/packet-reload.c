static kind_t * getKindFromId(guint32 id) {\r\nguint i;\r\nfor (i = 0; i < nreloadkinds; i++) {\r\nif (id == kindidlist_uats[i].id) {\r\nreturn (kindidlist_uats+i);\r\n}\r\n}\r\n{\r\nguint npredefinedkinds = sizeof(predefined_kinds) / sizeof(kind_t);\r\nfor (i = 0; i < npredefinedkinds; i++) {\r\nif (id == predefined_kinds[i].id) {\r\nreturn (predefined_kinds+i);\r\n}\r\n}\r\n}\r\nreturn NULL;\r\n}\r\nstatic void* uat_kindid_copy_cb(void* n, const void* o, size_t siz _U_) {\r\nkind_t * new_record = (kind_t *)n;\r\nconst kind_t* old_record = (const kind_t *)o;\r\nif (old_record->name) {\r\nnew_record->name = g_strdup(old_record->name);\r\n} else {\r\nnew_record->name = NULL;\r\n}\r\nreturn new_record;\r\n}\r\nstatic void uat_kindid_record_free_cb(void*r) {\r\nkind_t* rec = (kind_t *)r;\r\nif (rec->name) g_free(rec->name);\r\n}\r\nstatic void\r\nreload_defragment_init(void)\r\n{\r\nreassembly_table_init(&reload_reassembly_table,\r\n&addresses_reassembly_table_functions);\r\n}\r\nstatic void\r\nreload_defragment_cleanup(void)\r\n{\r\nreassembly_table_destroy(&reload_reassembly_table);\r\n}\r\nstatic guint\r\nget_reload_message_length(packet_info *pinfo _U_, tvbuff_t *tvb, int offset)\r\n{\r\nguint32 length = tvb_get_ntohl(tvb, offset + MSG_LENGH_OFFSET);\r\nreturn length;\r\n}\r\nstatic int\r\nget_opaque_length(tvbuff_t *tvb, guint16 offset, guint16 length_size)\r\n{\r\nint length = -1;\r\nswitch (length_size) {\r\ncase 1:\r\nlength = (gint32)tvb_get_guint8(tvb,offset);\r\nbreak;\r\ncase 2:\r\nlength = (gint32)tvb_get_ntohs(tvb, offset);\r\nbreak;\r\ncase 3:\r\nlength = ((gint32) (tvb_get_ntohs(tvb, offset) <<8) + (tvb_get_guint8(tvb, offset+2)));\r\nbreak;\r\ncase 4:\r\nlength = (gint32)tvb_get_ntohl(tvb, offset);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nreturn length;\r\n}\r\nstatic int\r\ndissect_opaque_string_or_data(tvbuff_t *tvb, packet_info *pinfo,proto_tree *tree, int anchor_index, guint16 offset, guint16 length_size, gint32 max_field_length, gboolean is_string)\r\n{\r\nproto_tree *opaque_tree;\r\nproto_item *ti_anchor;\r\ngint length_index = -1;\r\ngint32 length = -1;\r\nint hf = hf_reload_opaque;\r\nint hf_data = hf_reload_opaque_data;\r\nguint hf_data_encoding = ENC_NA;\r\nif (anchor_index >= 0) {\r\nhf = anchor_index;\r\n}\r\nif (is_string) {\r\nhf_data = hf_reload_opaque_string;\r\nhf_data_encoding = ENC_ASCII|ENC_NA;\r\n}\r\nswitch (length_size) {\r\ncase 1:\r\nlength_index = hf_reload_length_uint8;\r\nlength = (gint32)tvb_get_guint8(tvb,offset);\r\nbreak;\r\ncase 2:\r\nlength_index = hf_reload_length_uint16;\r\nlength = (gint32)tvb_get_ntohs(tvb, offset);\r\nbreak;\r\ncase 3:\r\nlength_index = hf_reload_length_uint24;\r\nlength = ((gint32) (tvb_get_ntohs(tvb, offset) <<8) + (tvb_get_guint8(tvb, offset+2)));\r\nbreak;\r\ncase 4:\r\nlength_index = hf_reload_length_uint32;\r\nlength = (gint32)tvb_get_ntohl(tvb, offset);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nif (length_index < 0) return 0;\r\nti_anchor = proto_tree_add_item(tree, hf, tvb, offset, length_size + length, ENC_NA);\r\nif (max_field_length > 0) {\r\nif ((length + length_size) > max_field_length) {\r\nexpert_add_info(pinfo, ti_anchor, &ei_reload_computed_len_too_big);\r\nlength = max_field_length - length_size;\r\n}\r\n}\r\nopaque_tree = proto_item_add_subtree(ti_anchor, ett_reload_opaque);\r\nproto_tree_add_uint(opaque_tree, length_index, tvb, offset, length_size, (guint)length);\r\nif (length) {\r\nproto_tree_add_item(opaque_tree, hf_data, tvb, offset + length_size, length, hf_data_encoding);\r\n}\r\nif (hf != hf_reload_opaque) {\r\nproto_item_append_text(ti_anchor, " (opaque<%d>)", length);\r\n}\r\nelse {\r\nproto_item_append_text(ti_anchor, "<%d>", length);\r\n}\r\nreturn (length_size + length);\r\n}\r\nstatic int\r\ndissect_opaque(tvbuff_t *tvb, packet_info *pinfo,proto_tree *tree, int anchor_index, guint16 offset, guint16 length_size, gint32 max_field_length) {\r\nreturn dissect_opaque_string_or_data(tvb, pinfo, tree, anchor_index, offset, length_size, max_field_length, FALSE);\r\n}\r\nstatic int\r\ndissect_opaque_string(tvbuff_t *tvb, packet_info *pinfo,proto_tree *tree, int anchor_index, guint16 offset, guint16 length_size, gint32 max_field_length) {\r\nreturn dissect_opaque_string_or_data(tvb, pinfo, tree, anchor_index, offset, length_size, max_field_length, TRUE);\r\n}\r\nstatic int dissect_length(tvbuff_t *tvb, proto_tree *tree, guint16 offset, guint16 length_size) {\r\nswitch (length_size) {\r\ncase 1:\r\nproto_tree_add_item(tree, hf_reload_length_uint8, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nreturn 1;\r\ncase 2:\r\nproto_tree_add_item(tree, hf_reload_length_uint16, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nreturn 2;\r\ncase 3:\r\nproto_tree_add_item(tree, hf_reload_length_uint24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nreturn 3;\r\ncase 4:\r\nproto_tree_add_item(tree, hf_reload_length_uint32, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nreturn 4;\r\ndefault:\r\nbreak;\r\n}\r\nreturn 0;\r\n}\r\nstatic int dissect_resourceid(int anchor, tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nproto_item *ti_local;\r\nproto_tree *local_tree;\r\nint hf = hf_reload_resourceid;\r\nguint8 local_length;\r\nif (anchor >= 0) {\r\nhf = anchor;\r\n}\r\nlocal_length = tvb_get_guint8(tvb, offset);\r\nif (length < local_length+1) {\r\nti_local = proto_tree_add_item(tree, hf, tvb, offset, length, ENC_NA);\r\nexpert_add_info_format(pinfo, ti_local, &ei_reload_truncated_field, "Truncated ResourceId");\r\nreturn length;\r\n}\r\nti_local = proto_tree_add_item(tree, hf, tvb, offset, 1+local_length, ENC_NA);\r\nlocal_tree = proto_item_add_subtree(ti_local, ett_reload_resourceid);\r\nproto_tree_add_item(local_tree, hf_reload_length_uint8, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(local_tree, hf_reload_opaque_data, tvb, offset+1, local_length, ENC_NA);\r\nif (hf != hf_reload_resourceid) {\r\nproto_item_append_text(ti_local, " (ResourceId<%d>)", local_length);\r\n}\r\nelse {\r\nproto_item_append_text(ti_local, "<%d>", local_length);\r\n}\r\nreturn 1+local_length;\r\n}\r\nstatic int dissect_nodeid(int anchor, tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nproto_item *ti_nodeid;\r\nint hf = hf_reload_nodeid;\r\nif (anchor >= 0) {\r\nhf = anchor;\r\n}\r\nif (length < reload_nodeid_length) {\r\nti_nodeid = proto_tree_add_item(tree, hf, tvb, offset, length, ENC_NA);\r\nexpert_add_info_format(pinfo, ti_nodeid, &ei_reload_truncated_field, "Truncated NodeId");\r\nreturn length;\r\n}\r\nti_nodeid = proto_tree_add_item(tree, hf, tvb, offset, reload_nodeid_length, ENC_NA);\r\n{\r\ngboolean allZeros = TRUE;\r\ngboolean allOnes = TRUE;\r\nguint i;\r\nfor (i=0; i<reload_nodeid_length; i++) {\r\nguint8 byte = tvb_get_guint8(tvb,offset+i);\r\nif (byte != 0) {\r\nallZeros = FALSE;\r\nif (allOnes == FALSE) break;\r\n}\r\nif (byte != 0xFF) {\r\nallOnes = FALSE;\r\nif (allZeros == FALSE) break;\r\n}\r\n}\r\nif (allZeros) {\r\nproto_item_append_text(ti_nodeid, "\n [Invalid]");\r\n}\r\nif (allOnes) {\r\nproto_item_append_text(ti_nodeid, "\n [Wildcard]");\r\n}\r\n}\r\nreturn reload_nodeid_length;\r\n}\r\nstatic int\r\ndissect_destination(int anchor, tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nguint8 destination_type;\r\nproto_tree *destination_tree;\r\nproto_item *ti_destination;\r\nguint8 destination_length = 0;\r\nint hf = hf_reload_destination;\r\nif (anchor >= 0) {\r\nhf = anchor;\r\n}\r\ndestination_type = tvb_get_guint8(tvb,offset);\r\nif (destination_type & 0x80) {\r\nti_destination = proto_tree_add_item(tree, hf, tvb, offset, 2, ENC_NA);\r\nif (hf == anchor) {\r\nproto_item_append_text(ti_destination, " (Destination)");\r\n}\r\nproto_item_append_text(ti_destination, ": uint16");\r\ndestination_tree = proto_item_add_subtree(ti_destination, ett_reload_destination);\r\nproto_tree_add_item(destination_tree,hf_reload_destination_compressed_id , tvb, offset, 2, ENC_BIG_ENDIAN);\r\nreturn 2;\r\n}\r\nelse {\r\ndestination_length = tvb_get_guint8(tvb,offset+1);\r\nti_destination = proto_tree_add_item(tree, hf, tvb, offset, 2+destination_length, ENC_NA);\r\nif (hf == anchor) {\r\nproto_item_append_text(ti_destination, " (Destination)");\r\n}\r\ndestination_tree = proto_item_add_subtree(ti_destination, ett_reload_destination);\r\nproto_item_append_text(ti_destination, ": %s", val_to_str_const(destination_type, destinationtypes, "Unknown"));\r\nproto_tree_add_item(destination_tree, hf_reload_destination_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_uint(destination_tree, hf_reload_length_uint8, tvb, offset+1, 1, destination_length);\r\nif (2 + destination_length > length) {\r\nexpert_add_info_format(pinfo, ti_destination, &ei_reload_truncated_field, "Truncated Destination");\r\nreturn length;\r\n}\r\nswitch(destination_type) {\r\ncase DESTINATIONTYPE_NODE:\r\ndissect_nodeid(hf_reload_destination_data_node_id, tvb, pinfo, destination_tree, offset+2, destination_length);\r\nbreak;\r\ncase DESTINATIONTYPE_RESOURCE:\r\ndissect_resourceid(hf_reload_destination_data_resource_id, tvb, pinfo, destination_tree, offset+2, destination_length);\r\nbreak;\r\ncase DESTINATIONTYPE_COMPRESSED:\r\ndissect_opaque(tvb, pinfo, destination_tree, hf_reload_destination_data_compressed_id, offset+2, 1, destination_length);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\nreturn (2+destination_length);\r\n}\r\nstatic int\r\ndissect_destination_list(tvbuff_t *tvb, packet_info *pinfo, proto_tree *list_tree, guint16 offset, guint16 length, int *numDestinations)\r\n{\r\ngint local_offset = 0;\r\ngint local_increment;\r\n*numDestinations = 0;\r\nwhile (local_offset +2 <= length) {\r\nlocal_increment = dissect_destination(-1,tvb, pinfo, list_tree, offset + local_offset, length-local_offset);\r\nif (local_increment <= 0) break;\r\nlocal_offset += local_increment;\r\n(*numDestinations)++;\r\n}\r\nreturn local_offset;\r\n}\r\nstatic int\r\ndissect_probe_information(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nproto_item *ti_probe_information;\r\nproto_tree *probe_information_tree;\r\nguint8 type;\r\nguint8 probe_length;\r\ntype = tvb_get_guint8(tvb, offset);\r\nprobe_length = tvb_get_guint8(tvb, offset + 1);\r\nif (probe_length + 2 > length) {\r\nti_probe_information = proto_tree_add_item(tree, hf_reload_probe_information, tvb, offset, length, ENC_NA);\r\nexpert_add_info_format(pinfo, ti_probe_information, &ei_reload_truncated_field, "Truncated probe information");\r\nreturn length;\r\n}\r\nti_probe_information = proto_tree_add_item(tree, hf_reload_probe_information, tvb, offset, 2 + probe_length, ENC_NA);\r\nprobe_information_tree = proto_item_add_subtree(ti_probe_information, ett_reload_probe_information);\r\nproto_tree_add_item(probe_information_tree, hf_reload_probe_information_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_uint(probe_information_tree, hf_reload_length_uint8, tvb, offset + 1, 1, probe_length);\r\n{\r\nproto_item *ti_probe_information_data;\r\nproto_tree *probe_information_data_tree;\r\nti_probe_information_data = proto_tree_add_item(probe_information_tree, hf_reload_probe_information_data, tvb, offset+2, probe_length, ENC_NA);\r\nprobe_information_data_tree = proto_item_add_subtree(ti_probe_information_data, ett_reload_probe_information_data);\r\nswitch(type) {\r\ncase PROBEINFORMATIONTYPE_RESPONSIBLESET:\r\nif (probe_length < 4) {\r\nexpert_add_info_format(pinfo, ti_probe_information_data, &ei_reload_truncated_field, "Truncated responsible set");\r\nreturn 2 + probe_length;\r\n}\r\nproto_tree_add_item(probe_information_data_tree, hf_reload_responsible_set, tvb, offset + 2, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase PROBEINFORMATIONTYPE_NUMRESOURCES:\r\nif (probe_length < 4) {\r\nexpert_add_info_format(pinfo, ti_probe_information_data, &ei_reload_truncated_field, "Truncated num resource info");\r\nreturn 2 + probe_length;\r\n}\r\nproto_tree_add_item(probe_information_data_tree, hf_reload_num_resources, tvb, offset + 2, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase PROBEINFORMATIONTYPE_UPTIME:\r\nif (probe_length < 4) {\r\nexpert_add_info_format(pinfo, ti_probe_information_data, &ei_reload_truncated_field, "Truncated uptime info");\r\nreturn 2 + probe_length;\r\n}\r\nproto_tree_add_item(probe_information_data_tree, hf_reload_uptime, tvb, offset + 2, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\nreturn probe_length + 2;\r\n}\r\nstatic int\r\ndissect_ipaddressport(int anchor, tvbuff_t *tvb, proto_tree *tree, guint16 offset)\r\n{\r\nproto_item *ti_ipaddressport;\r\nproto_tree *ipaddressport_tree;\r\nguint8 ipaddressport_type;\r\nguint8 ipaddressport_length;\r\nint hf = hf_reload_ipaddressport;\r\nif (anchor >= 0) {\r\nhf = anchor;\r\n}\r\nipaddressport_length = tvb_get_guint8(tvb, offset+1);\r\nti_ipaddressport = proto_tree_add_item(tree, hf, tvb, offset, ipaddressport_length+2, ENC_NA);\r\nif (hf == anchor) proto_item_append_text(ti_ipaddressport, " (IpAddressPort)");\r\nipaddressport_type = tvb_get_guint8(tvb, offset);\r\nproto_item_append_text(ti_ipaddressport, ": %s", val_to_str_const(ipaddressport_type, ipaddressporttypes,"Unknown Type"));\r\nif (ipaddressport_type == IPADDRESSPORTTYPE_IPV4) {\r\nproto_item_append_text(ti_ipaddressport, " (%s:%d)", tvb_ip_to_str(tvb, offset+2),tvb_get_ntohs(tvb,offset+2+4));\r\n}\r\nelse if (ipaddressport_type == IPADDRESSPORTTYPE_IPV6) {\r\nproto_item_append_text(ti_ipaddressport, " (%s:%d)", tvb_ip6_to_str(tvb, offset+2),tvb_get_ntohs(tvb,offset+2+16));\r\n}\r\nipaddressport_tree = proto_item_add_subtree(ti_ipaddressport, ett_reload_ipaddressport);\r\nproto_tree_add_item(ipaddressport_tree, hf_reload_ipaddressport_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_uint(ipaddressport_tree, hf_reload_length_uint8, tvb, offset, 1, ipaddressport_length);\r\noffset += 1;\r\nswitch (ipaddressport_type) {\r\ncase IPADDRESSPORTTYPE_IPV4:\r\n{\r\nproto_item *ti_ipv4;\r\nproto_tree *ipv4_tree;\r\nti_ipv4 = proto_tree_add_item(ipaddressport_tree, hf_reload_ipv4addrport, tvb, offset, 6, ENC_NA);\r\nproto_item_append_text(ti_ipv4, ": %s:%d", tvb_ip_to_str(tvb, offset),tvb_get_ntohs(tvb,offset+4));\r\nipv4_tree = proto_item_add_subtree(ti_ipv4, ett_reload_ipv4addrport);\r\nproto_tree_add_item(ipv4_tree, hf_reload_ipv4addr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ipv4_tree, hf_reload_port, tvb, offset + 4, 2, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase IPADDRESSPORTTYPE_IPV6:\r\n{\r\nproto_item *ti_ipv6;\r\nproto_tree *ipv6_tree;\r\nti_ipv6 = proto_tree_add_item(ipaddressport_tree, hf_reload_ipv6addrport, tvb, offset, 6, ENC_NA);\r\nproto_item_append_text(ti_ipv6, ": %s:%d", tvb_ip6_to_str(tvb, offset),tvb_get_ntohs(tvb,offset+16));\r\nipv6_tree = proto_item_add_subtree(ti_ipv6, ett_reload_ipv6addrport);\r\nproto_tree_add_item(ipv6_tree, hf_reload_ipv6addr, tvb, offset, 16, ENC_NA);\r\nproto_tree_add_item(ipv6_tree, hf_reload_port, tvb, offset + 16, 2, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nreturn (int) (2 + ipaddressport_length);\r\n}\r\nstatic int\r\ndissect_icecandidates(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nproto_item *ti_icecandidates;\r\nproto_tree *icecandidates_tree;\r\nguint32 icecandidates_offset = 0;\r\nguint32 icecandidates_length;\r\nguint32 local_offset = 0;\r\nint nCandidates = 0;\r\nicecandidates_length = tvb_get_ntohs(tvb, offset);\r\nif (2+icecandidates_length > length) {\r\nti_icecandidates = proto_tree_add_item(tree, hf_reload_icecandidates, tvb, offset, length, ENC_NA);\r\nexpert_add_info_format(pinfo, ti_icecandidates, &ei_reload_truncated_field, "Truncated ice candidates");\r\nreturn length;\r\n}\r\nti_icecandidates = proto_tree_add_item(tree, hf_reload_icecandidates, tvb, offset, 2+icecandidates_length, ENC_NA);\r\nproto_item_append_text(ti_icecandidates, " (IceCandidate<%d>)", icecandidates_length);\r\nicecandidates_tree = proto_item_add_subtree(ti_icecandidates, ett_reload_icecandidates);\r\nproto_tree_add_uint(icecandidates_tree, hf_reload_length_uint16, tvb, offset+local_offset, 2, icecandidates_length);\r\nlocal_offset += 2;\r\nwhile (icecandidates_offset < icecandidates_length) {\r\nproto_item *ti_icecandidate;\r\nproto_tree *icecandidate_tree;\r\nguint8 ipaddressport_length;\r\nguint8 computed_ipaddressport_length;\r\nguint16 iceextensions_length;\r\nguint8 foundation_length;\r\nguint8 candtype;\r\nguint16 icecandidate_offset = 0;\r\nipaddressport_length = tvb_get_guint8(tvb, offset+local_offset+icecandidates_offset+icecandidate_offset+1);\r\nicecandidate_offset += 2 + ipaddressport_length;\r\nicecandidate_offset += 1;\r\nfoundation_length = tvb_get_guint8(tvb, offset+local_offset+icecandidates_offset+icecandidate_offset);\r\nicecandidate_offset += 1 + foundation_length;\r\nicecandidate_offset += 4;\r\ncandtype = tvb_get_guint8(tvb, offset+local_offset+icecandidates_offset+icecandidate_offset);\r\nicecandidate_offset += 1;\r\ncomputed_ipaddressport_length = 0;\r\nswitch (candtype) {\r\ncase CANDTYPE_HOST:\r\nbreak;\r\ncase CANDTYPE_SRFLX:\r\ncase CANDTYPE_PRFLX:\r\ncase CANDTYPE_RELAY:\r\ncomputed_ipaddressport_length = tvb_get_guint8(tvb, offset+local_offset+icecandidates_offset+icecandidate_offset+1);\r\nicecandidate_offset += computed_ipaddressport_length+2;\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\niceextensions_length = tvb_get_ntohs(tvb, offset+local_offset+icecandidates_offset+icecandidate_offset);\r\nicecandidate_offset += iceextensions_length + 2;\r\nif (icecandidates_offset + icecandidate_offset > icecandidates_length) {\r\nexpert_add_info_format(pinfo, ti_icecandidates, &ei_reload_truncated_field, "Truncated IceCandidate");\r\nbreak;\r\n}\r\nti_icecandidate = proto_tree_add_item(icecandidates_tree, hf_reload_icecandidate, tvb, offset+local_offset+ icecandidates_offset, icecandidate_offset, ENC_NA);\r\nicecandidate_tree = proto_item_add_subtree(ti_icecandidate, ett_reload_icecandidate);\r\nicecandidate_offset = 0;\r\ndissect_ipaddressport(hf_reload_icecandidate_addr_port,tvb, icecandidate_tree, offset+local_offset+icecandidates_offset+icecandidate_offset);\r\nicecandidate_offset += 2 + ipaddressport_length;\r\nproto_tree_add_item(icecandidate_tree, hf_reload_overlaylink_type, tvb,\r\noffset+local_offset+icecandidates_offset+icecandidate_offset, 1, ENC_BIG_ENDIAN);\r\nicecandidate_offset += 1;\r\nicecandidate_offset += dissect_opaque_string(tvb, pinfo,icecandidate_tree, hf_reload_icecandidate_foundation,offset+local_offset+icecandidates_offset + icecandidate_offset, 1, -1);\r\n{\r\nguint32 priority;\r\npriority = tvb_get_ntohl(tvb, offset+local_offset + icecandidates_offset);\r\nproto_tree_add_item(icecandidate_tree, hf_reload_icecandidate_priority, tvb, offset+local_offset + icecandidates_offset, 4, ENC_BIG_ENDIAN);\r\nicecandidate_offset += 4;\r\nproto_tree_add_item(icecandidate_tree, hf_reload_icecandidate_type, tvb,\r\noffset+local_offset+icecandidates_offset+icecandidate_offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_append_text(ti_icecandidate, ": %s, priority=%d", val_to_str_const(candtype, candtypes, "Unknown"), priority);\r\n}\r\nicecandidate_offset += 1;\r\n{\r\nint item_index = -1;\r\nswitch (candtype) {\r\ncase CANDTYPE_HOST:\r\nbreak;\r\ncase CANDTYPE_SRFLX:\r\ncase CANDTYPE_PRFLX:\r\ncase CANDTYPE_RELAY:\r\nitem_index = hf_reload_icecandidate_relay_addr;\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nif (item_index != -1) {\r\ndissect_ipaddressport(item_index,tvb, icecandidate_tree,\r\noffset+local_offset+icecandidates_offset+icecandidate_offset);\r\nicecandidate_offset += computed_ipaddressport_length + 2;\r\n}\r\n}\r\n{\r\nguint32 iceextensions_offset = 0;\r\nproto_item *ti_iceextension, *ti_extensions;\r\nproto_tree *iceextension_tree,*extensions_tree;\r\nguint16 iceextension_name_length;\r\nguint16 iceextension_value_length;\r\nint nExtensions = 0;\r\nti_extensions =\r\nproto_tree_add_item(icecandidate_tree, hf_reload_iceextensions, tvb,\r\noffset+local_offset+icecandidates_offset+icecandidate_offset, 2+iceextensions_length,\r\nENC_NA);\r\nproto_item_append_text(ti_extensions, " (IceExtensions<%d>)", iceextensions_length);\r\nextensions_tree = proto_item_add_subtree(ti_extensions, ett_reload_iceextensions);\r\nproto_tree_add_item(extensions_tree, hf_reload_length_uint16, tvb,\r\noffset+local_offset+icecandidates_offset+icecandidate_offset, 2, ENC_BIG_ENDIAN);\r\nicecandidate_offset += 2;\r\nwhile (iceextensions_offset < iceextensions_length) {\r\nint local_increment;\r\niceextension_name_length =\r\ntvb_get_ntohs(tvb, offset+local_offset+icecandidates_offset+icecandidate_offset+iceextensions_offset);\r\niceextension_value_length =\r\ntvb_get_ntohs(tvb, offset+local_offset+icecandidates_offset+icecandidate_offset+iceextensions_offset+iceextension_name_length + 2);\r\nif ((iceextensions_offset + 4 + iceextension_name_length + iceextension_value_length) > iceextensions_length) {\r\nexpert_add_info_format(pinfo, ti_extensions, &ei_reload_truncated_field, "Truncated extensions");\r\nbreak;\r\n}\r\nti_iceextension =\r\nproto_tree_add_item(extensions_tree, hf_reload_iceextension, tvb,\r\noffset+local_offset + icecandidates_offset + icecandidate_offset + iceextensions_offset, 4 + iceextension_name_length + iceextension_value_length, ENC_NA);\r\niceextension_tree = proto_item_add_subtree(ti_iceextension, ett_reload_iceextension);\r\ndissect_opaque(tvb, pinfo, iceextension_tree, hf_reload_iceextension_name,offset+local_offset+ icecandidates_offset + icecandidate_offset + iceextensions_offset, 2, iceextension_name_length+2);\r\ndissect_opaque(tvb, pinfo, iceextension_tree, hf_reload_iceextension_value,offset+local_offset + icecandidates_offset + icecandidate_offset + iceextensions_offset +2 + iceextension_name_length, 2, iceextension_value_length+2);\r\nlocal_increment = 4 + iceextension_name_length + iceextension_value_length;\r\nif (local_increment <= 0) break;\r\niceextensions_offset += local_increment;\r\nnExtensions++;\r\n}\r\nproto_item_append_text(ti_extensions, ": %d elements", nExtensions);\r\n}\r\nicecandidate_offset += iceextensions_length;\r\nif (icecandidate_offset <= 0) break;\r\nicecandidates_offset += icecandidate_offset;\r\nnCandidates++;\r\n}\r\nproto_item_append_text(ti_icecandidates, ": %d elements", nCandidates);\r\nreturn (2 + icecandidates_length);\r\n}\r\nstatic int\r\ndissect_attachreqans(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nproto_item *ti_attachreqans;\r\nproto_tree *attachreqans_tree;\r\nguint8 ufrag_length;\r\nguint8 password_length;\r\nguint8 role_length;\r\nguint16 icecandidates_length;\r\nguint16 local_offset = 0;\r\nufrag_length = tvb_get_guint8(tvb,offset+local_offset);\r\nlocal_offset += 1;\r\nif (local_offset + ufrag_length > length) {\r\nti_attachreqans = proto_tree_add_item(tree, hf_reload_attachreqans, tvb, offset, length, ENC_NA);\r\nexpert_add_info_format(pinfo, ti_attachreqans, &ei_reload_truncated_field, "Truncated attach_reqans");\r\nreturn length;\r\n}\r\nlocal_offset += ufrag_length;\r\npassword_length = tvb_get_guint8(tvb,offset+local_offset);\r\nlocal_offset += 1;\r\nif (local_offset + password_length > length) {\r\nti_attachreqans = proto_tree_add_item(tree, hf_reload_attachreqans, tvb, offset, length, ENC_NA);\r\nexpert_add_info_format(pinfo, ti_attachreqans, &ei_reload_truncated_field, "Truncated attach_reqans");\r\nreturn length;\r\n}\r\nlocal_offset += password_length;\r\nrole_length = tvb_get_guint8(tvb,offset+local_offset);\r\nlocal_offset += 1;\r\nif (local_offset + role_length > length) {\r\nti_attachreqans = proto_tree_add_item(tree, hf_reload_attachreqans, tvb, offset, length, ENC_NA);\r\nexpert_add_info_format(pinfo, ti_attachreqans, &ei_reload_truncated_field, "Truncated attach_reqans");\r\nreturn length;\r\n}\r\nlocal_offset += role_length;\r\nicecandidates_length = tvb_get_ntohs(tvb, offset+local_offset);\r\nlocal_offset += 2;\r\nif (local_offset +icecandidates_length > length) {\r\nti_attachreqans = proto_tree_add_item(tree, hf_reload_attachreqans, tvb, offset, length, ENC_NA);\r\nexpert_add_info_format(pinfo, ti_attachreqans, &ei_reload_truncated_field, "Truncated attach_reqans");\r\nreturn length;\r\n}\r\nlocal_offset += icecandidates_length;\r\nti_attachreqans = proto_tree_add_item(tree, hf_reload_attachreqans, tvb, offset, local_offset, ENC_NA);\r\nattachreqans_tree = proto_item_add_subtree(ti_attachreqans, ett_reload_attachreqans);\r\nlocal_offset = 0;\r\nlocal_offset += dissect_opaque_string(tvb, pinfo,attachreqans_tree, hf_reload_ufrag,offset+local_offset, 1, -1);\r\nlocal_offset += dissect_opaque_string(tvb, pinfo,attachreqans_tree, hf_reload_password,offset+local_offset, 1, -1);\r\nlocal_offset += dissect_opaque_string(tvb, pinfo,attachreqans_tree, hf_reload_role,offset+local_offset, 1, -1);\r\nlocal_offset += dissect_icecandidates(tvb, pinfo, attachreqans_tree, offset + local_offset, 2+icecandidates_length);\r\nproto_tree_add_item(attachreqans_tree, hf_reload_sendupdate, tvb, offset+local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nreturn local_offset;\r\n}\r\nstatic int\r\ndissect_sipregistration(tvbuff_t *tvb, packet_info *pinfo,proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nproto_item *ti_local, *ti_sipregistrationdata;\r\nproto_tree *local_tree, *sipregistrationdata_tree;\r\nint local_offset = 0;\r\nguint16 length_field;\r\nguint8 type;\r\nti_local = proto_tree_add_item(tree, hf_reload_sipregistration, tvb, offset, length, ENC_NA);\r\nlocal_tree = proto_item_add_subtree(ti_local, ett_reload_sipregistration);\r\ntype = tvb_get_guint8(tvb, offset + local_offset);\r\nproto_tree_add_item(local_tree, hf_reload_sipregistration_type, tvb,offset+local_offset,1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nlength_field = tvb_get_ntohs(tvb, offset+local_offset);\r\nproto_tree_add_item(local_tree, hf_reload_length_uint16, tvb,offset+local_offset,2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nif (length_field>0) {\r\nti_sipregistrationdata = proto_tree_add_item(local_tree, hf_reload_sipregistration_data, tvb, offset, length_field, ENC_NA);\r\nsipregistrationdata_tree = proto_item_add_subtree(ti_sipregistrationdata, ett_reload_sipregistration_data);\r\nswitch(type) {\r\ncase SIPREGISTRATIONTYPE_URI:\r\ndissect_opaque_string(tvb,pinfo, sipregistrationdata_tree, hf_reload_sipregistration_data_uri, offset+local_offset, 2, length_field);\r\nbreak;\r\ncase SIPREGISTRATIONTYPE_ROUTE:\r\n{\r\nguint16 route_offset = 0;\r\nguint16 destinations_length;\r\nint numDestinations = 0;\r\nproto_item *ti_destination_list;\r\nproto_tree *destination_list_tree;\r\nroute_offset += dissect_opaque_string(tvb,pinfo, sipregistrationdata_tree, hf_reload_sipregistration_data_contact_prefs, offset+local_offset, 2, length_field);\r\ndestinations_length = (guint16) get_opaque_length(tvb, offset+local_offset+route_offset, 2);\r\nti_destination_list = proto_tree_add_item(sipregistrationdata_tree, hf_reload_sipregistration_data_destination_list, tvb,offset+local_offset+route_offset, length_field-route_offset, ENC_NA);\r\ndestination_list_tree = proto_item_add_subtree(ti_destination_list, ett_reload_sipregistration_destination_list);\r\nproto_tree_add_item(destination_list_tree, hf_reload_length_uint16, tvb,offset+local_offset+route_offset, 2, ENC_BIG_ENDIAN);\r\nroute_offset += 2;\r\nif (destinations_length>0) {\r\ndissect_destination_list(tvb, pinfo, destination_list_tree, offset+local_offset+route_offset,destinations_length, &numDestinations);\r\n}\r\nproto_item_append_text(ti_destination_list, " (Destination<%d>): %d elements", destinations_length,numDestinations);\r\n}\r\nbreak;\r\n}\r\n}\r\nlocal_offset += length_field;\r\nreturn local_offset;\r\n}\r\nstatic int\r\ndissect_turnserver(tvbuff_t *tvb, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nproto_item *ti_local;\r\nproto_tree *local_tree;\r\nint local_offset = 0;\r\nti_local = proto_tree_add_item(tree, hf_reload_turnserver, tvb, offset, length, ENC_NA);\r\nlocal_tree = proto_item_add_subtree(ti_local, ett_reload_turnserver);\r\nproto_tree_add_item(local_tree, hf_reload_turnserver_iteration, tvb,offset,1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nlocal_offset += dissect_ipaddressport(hf_reload_turnserver_server_address,tvb, local_tree, offset+local_offset);\r\nreturn local_offset;\r\n}\r\nstatic int dissect_redirserviceproviderdata(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nproto_item *ti_local;\r\nproto_tree *local_tree;\r\nint local_offset = 0;\r\nti_local = proto_tree_add_item(tree, hf_reload_redirserviceproviderdata, tvb, offset, length, ENC_NA);\r\nlocal_tree = proto_item_add_subtree(ti_local, ett_reload_redirserviceproviderdata);\r\nlocal_offset += dissect_nodeid(hf_reload_redirserviceproviderdata_serviceprovider, tvb, pinfo, local_tree, offset+local_offset, length);\r\nlocal_offset += dissect_opaque_string(tvb, pinfo, local_tree, hf_reload_redirserviceproviderdata_namespace, offset+local_offset, 2, length-local_offset);\r\nproto_tree_add_item(local_tree, hf_reload_redirserviceproviderdata_level, tvb, offset+local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(local_tree, hf_reload_redirserviceproviderdata_node, tvb, offset+local_offset, 2, ENC_BIG_ENDIAN);\r\nreturn length;\r\n}\r\nstatic int dissect_redirserviceprovider(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nproto_item *ti_local;\r\nproto_tree *local_tree;\r\nint local_offset = 0;\r\nguint16 length_field;\r\nlength_field = tvb_get_ntohs(tvb, offset);\r\nif (2+length_field>length) {\r\nti_local = proto_tree_add_item(tree, hf_reload_redirserviceprovider, tvb, offset, length, ENC_NA);\r\nexpert_add_info_format(pinfo, ti_local, &ei_reload_truncated_field, "Truncated RedirServiceProvider");\r\nreturn length;\r\n}\r\nti_local = proto_tree_add_item(tree, hf_reload_redirserviceprovider, tvb, offset, length_field+2, ENC_NA);\r\nlocal_tree = proto_item_add_subtree(ti_local, ett_reload_redirserviceprovider);\r\nproto_tree_add_item(local_tree, hf_reload_length_uint16, tvb, offset,2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\ndissect_redirserviceproviderdata(tvb, pinfo, local_tree, offset+local_offset, length_field);\r\nreturn (2+length_field);\r\n}\r\nstatic int dissect_datavalue(int anchor, tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length, gboolean meta, kind_t *kind) {\r\nproto_item *ti_datavalue;\r\nproto_tree *datavalue_tree;\r\nif (meta != TRUE) {\r\nint value_length = get_opaque_length(tvb,offset+1,4);\r\nint hf = hf_reload_datavalue;\r\nif (anchor >= 0) {\r\nhf = anchor;\r\n}\r\nif (1+4+value_length > length) {\r\nti_datavalue = proto_tree_add_item(tree, hf, tvb, offset, length, ENC_NA);\r\nexpert_add_info_format(pinfo, ti_datavalue, &ei_reload_truncated_field, "Truncated DataValue");\r\nreturn length;\r\n}\r\nti_datavalue = proto_tree_add_item(tree, hf, tvb, offset,1+4+value_length, ENC_NA);\r\ndatavalue_tree = proto_item_add_subtree(ti_datavalue,ett_reload_datavalue);\r\nproto_tree_add_item(datavalue_tree, hf_reload_datavalue_exists, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nif (kind != NULL) {\r\nswitch(kind->id) {\r\ncase DATAKINDID_TURNSERVICE:\r\n{\r\nguint32 length_field = tvb_get_ntohl(tvb, offset+1);\r\nproto_tree_add_item(datavalue_tree, hf_reload_length_uint32, tvb, offset+1,4, ENC_BIG_ENDIAN);\r\nif (length_field>0) {\r\ndissect_turnserver(tvb, datavalue_tree, offset+1+4, length_field);\r\n}\r\n}\r\nbreak;\r\ncase DATAKINDID_SIP_REGISTRATION:\r\n{\r\nguint32 length_field = tvb_get_ntohl(tvb, offset+1);\r\nproto_tree_add_item(datavalue_tree, hf_reload_length_uint32, tvb, offset+1,4, ENC_BIG_ENDIAN);\r\nif (length_field>0) {\r\ndissect_sipregistration(tvb, pinfo, datavalue_tree, offset+1+4, length_field);\r\n}\r\n}\r\nbreak;\r\ncase DATAKINDID_CERTIFICATE_BY_NODE:\r\ncase DATAKINDID_CERTIFICATE_BY_USER:\r\n{\r\nguint32 length_field = tvb_get_ntohl(tvb, offset+1);\r\nproto_tree_add_item(datavalue_tree, hf_reload_length_uint32, tvb, offset+1,4, ENC_BIG_ENDIAN);\r\nif (length_field>0) {\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\ndissect_x509af_Certificate(FALSE, tvb, offset + 1 + 4, &asn1_ctx,\r\ndatavalue_tree, hf_reload_certificate);\r\n}\r\n}\r\nbreak;\r\ncase DATAKINDID_REDIR:\r\n{\r\nguint32 length_field = tvb_get_ntohl(tvb, offset+1);\r\nproto_tree_add_item(datavalue_tree, hf_reload_length_uint32, tvb, offset+1,4, ENC_BIG_ENDIAN);\r\nif (length_field>0) {\r\ndissect_redirserviceprovider(tvb, pinfo, datavalue_tree, offset+1+4, length_field);\r\n}\r\n}\r\nbreak;\r\ndefault:\r\ndissect_opaque(tvb, pinfo, datavalue_tree, hf_reload_datavalue_value, offset +1, 4, length-1);\r\nbreak;\r\n}\r\n}\r\nelse {\r\ndissect_opaque(tvb, pinfo, datavalue_tree, hf_reload_datavalue_value, offset +1, 4, length-1);\r\n}\r\nif (hf == anchor) {\r\nproto_item_append_text(ti_datavalue, " (DataValue)");\r\n}\r\nreturn (1+4+value_length);\r\n}\r\nelse {\r\nint hash_length = get_opaque_length(tvb, offset +1+4+1,1);\r\nint hf = hf_reload_metadata;\r\nif (anchor >= 0) {\r\nhf = anchor;\r\n}\r\nif (1+4+1+1+hash_length > length) {\r\nti_datavalue = proto_tree_add_item(tree, hf, tvb, offset, length, ENC_NA);\r\nexpert_add_info_format(pinfo, ti_datavalue, &ei_reload_truncated_field, "Truncated MetaData");\r\nreturn length;\r\n}\r\nti_datavalue = proto_tree_add_item(tree, hf, tvb, offset,1+4+1+1+hash_length, ENC_NA);\r\ndatavalue_tree = proto_item_add_subtree(ti_datavalue,ett_reload_datavalue);\r\nproto_tree_add_item(datavalue_tree, hf_reload_datavalue_exists, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(datavalue_tree, hf_reload_metadata_value_length, tvb, offset+1, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(datavalue_tree, hf_reload_hash_algorithm, tvb, offset+1+4, 1, ENC_BIG_ENDIAN);\r\ndissect_opaque(tvb, pinfo, datavalue_tree, hf_reload_metadata_hash_value, offset +1+4+1, 1, length-1-4-1);\r\nif (hf == anchor) {\r\nproto_item_append_text(ti_datavalue, " (MetaData)");\r\n}\r\nreturn (1+4+1+hash_length);\r\n}\r\nreturn 0;\r\n}\r\nstatic int getDataValueLength(tvbuff_t *tvb, guint16 offset, gboolean meta) {\r\nif (meta != TRUE) {\r\nint value_length = get_opaque_length(tvb,offset+1,4);\r\nreturn (1+4+value_length);\r\n}\r\nelse {\r\nint hash_length = get_opaque_length(tvb, offset +1+4+1,1);\r\nreturn (1+4+1+1+hash_length);\r\n}\r\nreturn 0;\r\n}\r\nstatic int dissect_arrayentry(int anchor, tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length, gboolean meta, kind_t *kind) {\r\nproto_item *ti_arrayentry, *ti_index;\r\nproto_tree *arrayentry_tree;\r\nint data_length = getDataValueLength(tvb, offset+4, meta);\r\nint hf = hf_reload_arrayentry;\r\nif (anchor >= 0) {\r\nhf = anchor;\r\n}\r\nif (4+data_length > length) {\r\nti_arrayentry = proto_tree_add_item(tree, hf, tvb, offset, length, ENC_NA);\r\nexpert_add_info_format(pinfo, ti_arrayentry, &ei_reload_truncated_field, "Truncated ArrayEntry");\r\nreturn length;\r\n}\r\nti_arrayentry = proto_tree_add_item(tree, hf, tvb, offset,4+data_length, ENC_NA);\r\narrayentry_tree = proto_item_add_subtree(ti_arrayentry,ett_reload_arrayentry);\r\nti_index = proto_tree_add_item(arrayentry_tree, hf_reload_arrayentry_index, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nif (0xffffffff == (guint32) tvb_get_ntohl(tvb, offset)) {\r\nproto_item_append_text(ti_index, "(append)");\r\n}\r\ndissect_datavalue(hf_reload_arrayentry_value,tvb, pinfo, arrayentry_tree, offset+4, length-4, meta, kind);\r\nif (hf == anchor) {\r\nproto_item_append_text(ti_arrayentry, " (ArrayEntry)");\r\n}\r\nreturn (4+data_length);\r\n}\r\nstatic int dissect_dictionaryentry(int anchor, tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length, gboolean meta, kind_t *kind) {\r\nproto_item *ti_dictionaryentry;\r\nproto_tree *dictionaryentry_tree;\r\nint local_offset = 0;\r\nguint16 key_length = 0;\r\nint hf = hf_reload_dictionaryentry;\r\nif (anchor >= 0) {\r\nhf = anchor;\r\n}\r\nif (length < 2) {\r\nti_dictionaryentry = proto_tree_add_item(tree, hf, tvb, offset, length, ENC_NA);\r\nexpert_add_info_format(pinfo, ti_dictionaryentry, &ei_reload_truncated_field, "Truncated ArrayEntry");\r\nreturn length;\r\n}\r\nkey_length = get_opaque_length(tvb,offset,2);\r\nif (length < (key_length +2)) {\r\nti_dictionaryentry = proto_tree_add_item(tree, hf, tvb, offset, length, ENC_NA);\r\nexpert_add_info_format(pinfo, ti_dictionaryentry, &ei_reload_truncated_field, "Truncated ArrayEntry");\r\nreturn length;\r\n}\r\n{\r\nint data_length = getDataValueLength(tvb, offset+2+key_length, meta);\r\nif (length < (key_length+2+data_length)) {\r\nti_dictionaryentry = proto_tree_add_item(tree, hf, tvb, offset, length, ENC_NA);\r\n}\r\nelse {\r\nti_dictionaryentry = proto_tree_add_item(tree, hf, tvb, offset, 2+key_length+1+4+data_length, ENC_NA);\r\n}\r\n}\r\ndictionaryentry_tree = proto_item_add_subtree(ti_dictionaryentry,ett_reload_dictionaryentry);\r\nif (hf == anchor) {\r\nproto_item_append_text(ti_dictionaryentry, " (DictionaryEntry)");\r\n}\r\nif (kind != NULL) {\r\nswitch(kind->id) {\r\ncase DATAKINDID_SIP_REGISTRATION:\r\ncase DATAKINDID_REDIR:\r\n{\r\nproto_item *ti_key;\r\nproto_tree *key_tree;\r\nti_key = proto_tree_add_item(dictionaryentry_tree, hf_reload_dictionarykey, tvb, offset, 2+key_length, ENC_NA);\r\nkey_tree = proto_item_add_subtree(ti_key,ett_reload_dictionaryentry_key);\r\nproto_tree_add_item(key_tree, hf_reload_length_uint16, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nlocal_offset+= dissect_nodeid(-1, tvb, pinfo, key_tree, offset+2, key_length);\r\n}\r\nbreak;\r\ndefault:\r\nlocal_offset += dissect_opaque(tvb, pinfo, dictionaryentry_tree, hf_reload_dictionarykey, offset, 2, length);\r\nbreak;\r\n}\r\n}\r\nelse {\r\nlocal_offset +=\r\ndissect_opaque(tvb, pinfo, dictionaryentry_tree, hf_reload_dictionarykey, offset, 2, length);\r\n}\r\nlocal_offset += dissect_datavalue(hf_reload_dictionary_value,tvb, pinfo, dictionaryentry_tree, offset+local_offset, length-local_offset, meta, kind);\r\nreturn (local_offset);\r\n}\r\nstatic int\r\ndissect_signature(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset)\r\n{\r\nint local_offset = 0;\r\nproto_item *ti_signature;\r\nproto_tree *signature_tree;\r\nguint16 signeridentityvalue_length;\r\nguint16 signaturevalue_length;\r\nsigneridentityvalue_length = tvb_get_ntohs(tvb, offset +2+1);\r\nsignaturevalue_length = tvb_get_ntohs(tvb, offset + 2 + 1 + 2+ signeridentityvalue_length);\r\nti_signature = proto_tree_add_item(tree,\r\nhf_reload_signature, tvb, offset,\r\n2 +\r\n1 + 2 + signeridentityvalue_length +\r\n2 + signaturevalue_length,\r\nENC_NA);\r\nsignature_tree = proto_item_add_subtree(ti_signature, ett_reload_signature);\r\n{\r\nproto_item *ti_signatureandhashalgorithm;\r\nproto_tree *signatureandhashalgorithm_tree;\r\nti_signatureandhashalgorithm = proto_tree_add_item(signature_tree, hf_reload_signatureandhashalgorithm, tvb, offset, 2, ENC_NA);\r\nsignatureandhashalgorithm_tree = proto_item_add_subtree( ti_signatureandhashalgorithm, ett_reload_signatureandhashalgorithm);\r\nproto_tree_add_item(signatureandhashalgorithm_tree, hf_reload_hash_algorithm, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(signatureandhashalgorithm_tree, hf_reload_signature_algorithm, tvb, offset + local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\n}\r\n{\r\nproto_item *ti_signeridentity;\r\nproto_tree *signeridentity_tree;\r\nguint8 identity_type;\r\nti_signeridentity = proto_tree_add_item(signature_tree,\r\nhf_reload_signeridentity,\r\ntvb, offset+local_offset,\r\n1 + 2 + signeridentityvalue_length,\r\nENC_NA);\r\nsigneridentity_tree = proto_item_add_subtree(ti_signeridentity, ett_reload_signeridentity);\r\nidentity_type = tvb_get_guint8(tvb, offset + local_offset);\r\nproto_tree_add_item(signeridentity_tree, hf_reload_signeridentity_type, tvb,\r\noffset + local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_uint(signeridentity_tree, hf_reload_length_uint16, tvb,\r\noffset + local_offset, 2, signeridentityvalue_length);\r\nlocal_offset += 2;\r\n{\r\nproto_item *ti_signeridentity_identity;\r\nproto_tree * signeridentity_identity_tree;\r\nti_signeridentity_identity = proto_tree_add_item(signeridentity_tree,\r\nhf_reload_signeridentity_identity,\r\ntvb, offset+local_offset,\r\nsigneridentityvalue_length,\r\nENC_NA);\r\nsigneridentity_identity_tree = proto_item_add_subtree(ti_signeridentity_identity, ett_reload_signeridentity_identity);\r\nproto_item_append_text(ti_signeridentity_identity, " (SignerIdentityValue[%d])",signeridentityvalue_length);\r\n{\r\nproto_item *ti_signeridentityvalue;\r\nproto_tree *signeridentityvalue_tree;\r\nif (identity_type == SIGNERIDENTITYTYPE_CERTHASH || identity_type == SIGNERIDENTITYTYPE_CERTHASHNODEID) {\r\nguint8 certificate_hash_length;\r\ncertificate_hash_length = tvb_get_guint8(tvb, offset + local_offset + 1);\r\nif (1 + 1 + certificate_hash_length > signeridentityvalue_length) {\r\nexpert_add_info_format(pinfo, ti_signeridentity, &ei_reload_truncated_field, "Truncated signature identity value");\r\n}\r\nelse {\r\nti_signeridentityvalue= proto_tree_add_item(signeridentity_identity_tree,\r\nhf_reload_signeridentity_value,\r\ntvb, offset + local_offset,\r\n1 + 1 + certificate_hash_length,\r\nENC_NA);\r\nsigneridentityvalue_tree = proto_item_add_subtree(ti_signeridentityvalue, ett_reload_signeridentity_value);\r\nproto_tree_add_item(signeridentityvalue_tree, hf_reload_signeridentity_value_hash_alg, tvb,\r\noffset + local_offset, 1, ENC_BIG_ENDIAN);\r\ndissect_opaque(tvb, pinfo, signeridentityvalue_tree,\r\n(identity_type == SIGNERIDENTITYTYPE_CERTHASH) ?\r\nhf_reload_signeridentity_value_certificate_hash:\r\nhf_reload_signeridentity_value_certificate_node_id_hash,\r\noffset + local_offset +1, 1, -1);\r\n}\r\n}\r\nelse {\r\nexpert_add_info(pinfo, signeridentity_identity_tree, &ei_reload_identity_type_unknown);\r\n}\r\n}\r\n}\r\nlocal_offset += signeridentityvalue_length;\r\n}\r\nlocal_offset += dissect_opaque(tvb, pinfo, signature_tree, hf_reload_signature_value, offset + local_offset, 2, -1);\r\nreturn local_offset;\r\n}\r\nstatic int\r\ndissect_storeddata(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length, kind_t *kind, gboolean meta)\r\n{\r\nproto_item *ti_storeddata;\r\nproto_tree *storeddata_tree;\r\nguint32 storeddata_length;\r\nguint32 local_offset;\r\nint hf = hf_reload_storeddata;\r\nif (meta == TRUE) {\r\nhf = hf_reload_storedmetadata;\r\n}\r\nstoreddata_length = tvb_get_ntohl(tvb, offset);\r\nif (storeddata_length + 4 > length) {\r\nti_storeddata = proto_tree_add_item(tree, hf, tvb, offset, length, ENC_NA);\r\nexpert_add_info_format(pinfo, ti_storeddata, &ei_reload_truncated_field, "Truncated StoredData");\r\nreturn length;\r\n}\r\nlocal_offset = 0;\r\nti_storeddata = proto_tree_add_item(tree, hf, tvb, offset, 4 + storeddata_length, ENC_NA);\r\nstoreddata_tree = proto_item_add_subtree(ti_storeddata, ett_reload_storeddata);\r\nproto_tree_add_uint(storeddata_tree, hf_reload_length_uint32, tvb, offset, 4, storeddata_length);\r\nlocal_offset += 4;\r\n{\r\nguint64 storage_time;\r\nguint32 remaining_ms;\r\ntime_t storage_time_sec;\r\nnstime_t l_nsTime;\r\nstorage_time = tvb_get_ntoh64(tvb, offset+local_offset);\r\nstorage_time_sec = (time_t)(storage_time/1000);\r\nremaining_ms = (guint32) (storage_time % 1000);\r\nl_nsTime.secs = storage_time_sec;\r\nl_nsTime.nsecs = remaining_ms*1000*1000;\r\nproto_tree_add_time(storeddata_tree, hf_reload_storeddata_storage_time, tvb, offset + local_offset, 8, &l_nsTime);\r\n}\r\nlocal_offset += 8;\r\nproto_tree_add_item(storeddata_tree, hf_reload_storeddata_lifetime, tvb, offset + local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nif ((NULL != kind) && (kind->id != DATAKINDID_INVALID)) {\r\nswitch(kind->data_model) {\r\ncase DATAMODEL_SINGLE:\r\nlocal_offset += dissect_datavalue(hf_reload_value,tvb, pinfo, storeddata_tree, offset+local_offset, (storeddata_length-local_offset+4), meta, kind);\r\nbreak;\r\ncase DATAMODEL_ARRAY:\r\nlocal_offset += dissect_arrayentry(hf_reload_value,tvb, pinfo, storeddata_tree, offset+local_offset, (storeddata_length-local_offset+4), meta, kind);\r\nbreak;\r\ncase DATAMODEL_DICTIONARY:\r\nlocal_offset += dissect_dictionaryentry(hf_reload_value,tvb, pinfo, storeddata_tree, offset+local_offset, (storeddata_length-local_offset+4), meta, kind);\r\nbreak;\r\ndefault:\r\nexpert_add_info(pinfo, ti_storeddata, &ei_reload_unknown_data_model);\r\nreturn (storeddata_length + 4);\r\n}\r\nif (TRUE != meta) {\r\ndissect_signature(tvb, pinfo, storeddata_tree, offset +local_offset);\r\n}\r\n}\r\nreturn (storeddata_length + 4);\r\n}\r\nstatic int\r\ndissect_kindid(int anchor, tvbuff_t *tvb, proto_tree *tree, guint16 offset, kind_t **kind)\r\n{\r\nproto_item *ti_kindid;\r\nguint32 kindid = 0;\r\nint hf = hf_reload_kindid;\r\nif (anchor >= 0) {\r\nhf = anchor;\r\n}\r\n*kind = NULL;\r\nkindid = tvb_get_ntohl(tvb, offset);\r\n*kind = getKindFromId(kindid);\r\nti_kindid = proto_tree_add_item(tree, hf, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nif ((NULL != (*kind)) && ((*kind)->name != NULL)) {\r\nproto_item_append_text(ti_kindid, " (%s)", (*kind)->name);\r\n}\r\nreturn 4;\r\n}\r\nstatic int\r\ndissect_kinddata(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length, gboolean meta)\r\n{\r\nproto_item *ti_kinddata;\r\nproto_item *kinddata_tree;\r\nguint32 values_length;\r\nguint32 local_offset = 0;\r\nkind_t *kind;\r\nint hf = hf_reload_kinddata;\r\nint nValues = 0;\r\nif (meta) {\r\nhf = hf_reload_statkindresponse;\r\n}\r\nvalues_length = tvb_get_ntohl(tvb, offset + 4 + 8);\r\nif (12 + values_length > length) {\r\nti_kinddata = proto_tree_add_item(tree, hf, tvb, offset, length, ENC_NA);\r\nexpert_add_info_format(pinfo, ti_kinddata, &ei_reload_truncated_field, "Truncated kind data");\r\nreturn length;\r\n}\r\nti_kinddata = proto_tree_add_item(tree, hf, tvb, offset, 16+values_length, ENC_NA);\r\nkinddata_tree = proto_item_add_subtree(ti_kinddata, ett_reload_kinddata);\r\nlocal_offset += dissect_kindid(hf_reload_kinddata_kind,tvb, kinddata_tree, offset+local_offset, &kind);\r\nproto_tree_add_item(kinddata_tree, hf_reload_generation_counter, tvb, offset+local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\n{\r\ngint32 values_offset = 0;\r\nguint32 values_increment;\r\nproto_item *ti_values;\r\nproto_tree *values_tree;\r\nti_values = proto_tree_add_item(kinddata_tree, hf_reload_values, tvb, offset+local_offset, 4+values_length, ENC_NA);\r\nvalues_tree = proto_item_add_subtree(ti_values, ett_reload_values);\r\nif (meta) {\r\nproto_item_append_text(ti_values, " (StoredMetaData<%d>)", values_length);\r\n} else {\r\nproto_item_append_text(ti_values, " (StoredData<%d>)", values_length);\r\n}\r\nproto_tree_add_uint(values_tree, hf_reload_length_uint32, tvb, offset +local_offset, 4, values_length);\r\nlocal_offset += 4;\r\nwhile (values_offset >= 0 && (guint32)values_offset < values_length) {\r\nvalues_increment = dissect_storeddata(tvb, pinfo, values_tree, offset+local_offset+values_offset, values_length - values_offset, kind, meta);\r\nif (values_increment == 0) {\r\nbreak;\r\n}\r\nnValues++;\r\nvalues_offset += values_increment;\r\n}\r\nproto_item_append_text(ti_values, ": %d elements", nValues);\r\n}\r\nlocal_offset += values_length;\r\nreturn local_offset;\r\n}\r\nstatic int dissect_nodeid_list(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length, int hf, int length_size)\r\n{\r\nguint16 list_length;\r\nguint16 local_offset = 0;\r\ngint32 list_offset = 0;\r\nguint16 list_increment = 0;\r\nint nNodeIds = 0;\r\nproto_item *ti_local;\r\nproto_tree *local_tree;\r\nlist_length= (guint16) get_opaque_length(tvb, offset, length_size);\r\nif (list_length+length_size>length) {\r\nti_local = proto_tree_add_item(tree, hf, tvb, offset, length, ENC_NA);\r\nexpert_add_info_format(pinfo, ti_local, &ei_reload_truncated_field, "Truncated NodeId list");\r\n}\r\nti_local = proto_tree_add_item(tree, hf, tvb, offset, list_length+length_size, ENC_NA);\r\nproto_item_append_text(ti_local, " (NodeId<%d>)", list_length);\r\nlocal_tree = proto_item_add_subtree(ti_local, ett_reload_nodeid_list);\r\nlocal_offset += dissect_length(tvb, local_tree, offset, length_size);\r\nwhile (list_offset >= 0 && list_offset < list_length) {\r\ndissect_nodeid(-1, tvb, pinfo, local_tree, offset+local_offset+list_offset,list_length-list_offset);\r\nlist_increment = reload_nodeid_length;\r\nif (list_increment <= 0) break;\r\nlist_offset += list_increment;\r\nnNodeIds++;\r\n}\r\nproto_item_append_text(ti_local, ":%d elements", nNodeIds);\r\nreturn (list_length+length_size);\r\n}\r\nstatic int\r\ndissect_storekindresponse(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nproto_item *ti_local;\r\nproto_tree *local_tree;\r\nguint16 local_offset = 0;\r\nguint16 local_length = 0;\r\nguint16 replicas_length;\r\nkind_t *kind;\r\nreplicas_length = tvb_get_ntohs(tvb, offset+4+8);\r\nlocal_length = 4+8+2+replicas_length;\r\nif (length < local_length) {\r\nti_local = proto_tree_add_item(tree, hf_reload_storekindresponse, tvb, offset, length, ENC_NA);\r\nexpert_add_info_format(pinfo, ti_local, &ei_reload_truncated_field, "Truncated StoreKindResponse");\r\nreturn length;\r\n}\r\nti_local = proto_tree_add_item(tree, hf_reload_storekindresponse, tvb, offset, 4+8+2+replicas_length, ENC_NA);\r\nlocal_tree = proto_item_add_subtree(ti_local, ett_reload_storekindresponse);\r\nlocal_offset += dissect_kindid(hf_reload_kinddata_kind,tvb, local_tree, offset+local_offset, &kind);\r\nproto_tree_add_item(local_tree, hf_reload_generation_counter, tvb, offset+local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nlocal_offset += dissect_nodeid_list(tvb, pinfo, local_tree, offset+local_offset, local_length-local_offset, hf_reload_replicas, 2);\r\nreturn local_offset;\r\n}\r\nstatic int\r\ndissect_storeans(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nproto_item *ti_local, *ti_kind_responses;\r\nproto_tree *local_tree, *kind_responses_tree;\r\nguint16 local_offset = 0;\r\nguint16 kind_responses_length;\r\ngint32 kind_responses_offset = 0;\r\nint nKindResponses = 0;\r\nti_local = proto_tree_add_item(tree, hf_reload_storeans, tvb, offset, length, ENC_NA);\r\nlocal_tree = proto_item_add_subtree(ti_local, ett_reload_storeans);\r\nkind_responses_length = tvb_get_ntohs(tvb, offset);\r\nti_kind_responses = proto_tree_add_item(local_tree, hf_reload_storeans_kind_responses, tvb, offset, 2+kind_responses_length, ENC_NA);\r\nkind_responses_tree = proto_item_add_subtree(ti_kind_responses, ett_reload_storeans_kind_responses);\r\nproto_item_append_text(ti_kind_responses, " (StoreKindResponse<%d>)", kind_responses_length);\r\nproto_tree_add_item(kind_responses_tree, hf_reload_length_uint16, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nwhile (kind_responses_offset >=0 && kind_responses_offset < kind_responses_length) {\r\nint local_increment = dissect_storekindresponse(tvb, pinfo, kind_responses_tree, offset+local_offset+kind_responses_offset, kind_responses_length-kind_responses_offset);\r\nif (local_increment <= 0) break;\r\nkind_responses_offset += local_increment;\r\nnKindResponses++;\r\n}\r\nlocal_offset += kind_responses_length;\r\nproto_item_append_text(ti_kind_responses, ": %d elements", nKindResponses);\r\nreturn local_offset;\r\n}\r\nstatic int\r\ndissect_storereq(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nproto_item *ti_storereq;\r\nproto_tree *storereq_tree;\r\nguint32 local_offset = 0;\r\nguint32 kind_data_length;\r\nlocal_offset += get_opaque_length(tvb, offset, 1) + 1;\r\nif (local_offset > length) {\r\nti_storereq = proto_tree_add_item(tree, hf_reload_storereq, tvb, offset, length, ENC_NA);\r\nexpert_add_info_format(pinfo, ti_storereq, &ei_reload_truncated_field, "Truncated StoreReq: resource too long");\r\nreturn length;\r\n}\r\nlocal_offset += 1;\r\nif (local_offset > length) {\r\nti_storereq = proto_tree_add_item(tree, hf_reload_storereq, tvb, offset, length, ENC_NA);\r\nexpert_add_info_format(pinfo, ti_storereq, &ei_reload_truncated_field, "Truncated StoreReq: no room for replica_number");\r\nreturn length;\r\n}\r\nkind_data_length = tvb_get_ntohl(tvb, offset + local_offset);\r\nlocal_offset += 4;\r\nif (local_offset + kind_data_length > length) {\r\nti_storereq = proto_tree_add_item(tree, hf_reload_storereq, tvb, offset, length, ENC_NA);\r\nexpert_add_info_format(pinfo, ti_storereq, &ei_reload_truncated_field, "Truncated StoreReq: kind_data too long");\r\nreturn length;\r\n}\r\nlocal_offset += kind_data_length;\r\nti_storereq = proto_tree_add_item(tree, hf_reload_storereq, tvb, offset, local_offset, ENC_NA);\r\nstorereq_tree = proto_item_add_subtree(ti_storereq, ett_reload_storereq);\r\nlocal_offset = 0;\r\nlocal_offset += dissect_resourceid(hf_reload_resource, tvb, pinfo, storereq_tree, offset+local_offset, length);\r\nproto_tree_add_item(storereq_tree, hf_reload_store_replica_num, tvb, offset + local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\n{\r\ngint32 kind_data_offset = 0;\r\nguint32 kind_data_increment;\r\nproto_item *ti_kind_data;\r\nproto_tree *kind_data_tree;\r\nint nKindDatas = 0;\r\nti_kind_data = proto_tree_add_item(storereq_tree, hf_reload_store_kind_data, tvb, offset+local_offset,4+kind_data_length, ENC_NA);\r\nproto_item_append_text(ti_kind_data, " (StoreKindData<%d>)", kind_data_length);\r\nkind_data_tree = proto_item_add_subtree(ti_kind_data, ett_reload_store_kind_data);\r\nproto_tree_add_item(kind_data_tree, hf_reload_length_uint32, tvb, offset + local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nwhile (kind_data_offset >= 0 && (guint32)kind_data_offset < kind_data_length) {\r\nkind_data_increment = dissect_kinddata(tvb, pinfo, kind_data_tree, offset+local_offset+kind_data_offset, kind_data_length - kind_data_offset, FALSE);\r\nif (kind_data_increment == 0) {\r\nbreak;\r\n}\r\nnKindDatas++;\r\nkind_data_offset += kind_data_increment;\r\n}\r\nproto_item_append_text(ti_kind_data, ": %d elements", nKindDatas);\r\n}\r\nlocal_offset += kind_data_length;\r\nreturn local_offset;\r\n}\r\nstatic int dissect_arrayrange(tvbuff_t *tvb, proto_tree *tree, guint16 offset) {\r\nproto_item *ti;\r\ngint32 first;\r\ngint32 last;\r\nti = proto_tree_add_item(tree, hf_reload_arrayrange, tvb, offset, (16), ENC_NA);\r\nfirst = tvb_get_ntohl(tvb, offset);\r\nlast = tvb_get_ntohl(tvb, offset+4);\r\nproto_item_append_text(ti, " [%d-", first);\r\nif ((guint32)last != 0xFFFFFFFF) {\r\nproto_item_append_text(ti, "%d]", last);\r\n}\r\nelse {\r\nproto_item_append_text(ti, "end]");\r\n}\r\nreturn 8;\r\n}\r\nstatic int\r\ndissect_storeddataspecifier(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nguint16 length_field, local_offset = 0;\r\nproto_item *ti_storeddataspecifier;\r\nproto_tree *storeddataspecifier_tree;\r\nkind_t *kind = NULL;\r\nlength_field = tvb_get_ntohs(tvb, offset+4+8);\r\nif ((length_field + 4 + 8 + 2) > length) {\r\nti_storeddataspecifier = proto_tree_add_item(tree, hf_reload_storeddataspecifier, tvb, offset, length, ENC_NA);\r\nexpert_add_info_format(pinfo, ti_storeddataspecifier, &ei_reload_truncated_field, "Truncated StoredDataSpecifier");\r\nreturn length;\r\n}\r\nti_storeddataspecifier = proto_tree_add_item(tree, hf_reload_storeddataspecifier, tvb, offset, (length_field + 4 + 8 +2), ENC_NA);\r\nstoreddataspecifier_tree = proto_item_add_subtree(ti_storeddataspecifier, ett_reload_storeddataspecifier);\r\nlocal_offset += dissect_kindid(hf_reload_kinddata_kind,tvb,storeddataspecifier_tree, offset, &kind);\r\nproto_tree_add_item(storeddataspecifier_tree, hf_reload_generation_counter, tvb, offset+local_offset, 8, ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(storeddataspecifier_tree, hf_reload_length_uint16, tvb, offset+local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nif ((kind != NULL) && (kind->id != DATAKINDID_INVALID)) {\r\nswitch(kind->data_model) {\r\ncase DATAMODEL_ARRAY:\r\n{\r\nproto_item *ti_indices;\r\nproto_tree *indices_tree;\r\ngint32 indices_offset = 0;\r\nguint16 indices_length = tvb_get_ntohs(tvb, offset+local_offset);\r\nint nIndices = 0;\r\nti_indices = proto_tree_add_item(storeddataspecifier_tree, hf_reload_storeddataspecifier_indices,\r\ntvb, offset+local_offset, 2+indices_length, ENC_NA);\r\nproto_item_append_text(ti_indices, " (ArrayRange<%d>)", indices_length);\r\nindices_tree = proto_item_add_subtree(ti_indices, ett_reload_storeddataspecifier_indices);\r\nproto_tree_add_item(indices_tree, hf_reload_length_uint16, tvb, offset+local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nwhile (indices_offset >= 0 && indices_offset < indices_length) {\r\nindices_offset += dissect_arrayrange(tvb, indices_tree, offset + local_offset + indices_offset);\r\nnIndices++;\r\n}\r\nproto_item_append_text(ti_indices, ": %d elements", nIndices);\r\n}\r\nbreak;\r\ncase DATAMODEL_DICTIONARY:\r\n{\r\nproto_item *ti_keys;\r\nproto_tree *keys_tree;\r\ngint32 keys_offset = 0;\r\nguint16 keys_length = tvb_get_ntohs(tvb, offset+local_offset);\r\nint nKeys = 0;\r\nti_keys = proto_tree_add_item(tree, hf_reload_storeddataspecifier_keys, tvb, offset+local_offset, 2+keys_length, ENC_NA);\r\nkeys_tree = proto_item_add_subtree(ti_keys, ett_reload_storeddataspecifier_keys);\r\nwhile (keys_offset >= 0 && keys_offset < keys_length) {\r\nguint32 local_increment;\r\nlocal_increment = dissect_opaque(tvb, pinfo, keys_tree, hf_reload_dictionarykey, offset, 2, keys_length-keys_offset);\r\nif (local_increment == 0) break;\r\nkeys_offset += local_increment;\r\nnKeys++;\r\n}\r\nproto_item_append_text(ti_keys, "(%d keys)", nKeys);\r\n}\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\nreturn (length_field + 4 + 8 +2);\r\n}\r\nstatic int\r\ndissect_fetchreq(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length, gboolean meta)\r\n{\r\nproto_item *ti_fetchreq;\r\nproto_item *ti_specifiers;\r\nproto_tree *fetchreq_tree;\r\nproto_tree *specifiers_tree;\r\nguint16 resourceid_length;\r\nguint16 specifiers_length;\r\ngint32 specifiers_offset = 0;\r\nint nSpecifiers = 0;\r\nguint16 local_offset = 0;\r\nguint16 local_length = 0;\r\nint hf = hf_reload_fetchreq;\r\nif (meta == TRUE) {\r\nhf = hf_reload_statreq;\r\n}\r\nresourceid_length = get_opaque_length(tvb,offset, 1);\r\nspecifiers_length = get_opaque_length(tvb, offset+1+resourceid_length, 2);\r\nif (1+ resourceid_length+ 2 + specifiers_length > length) {\r\nti_fetchreq = proto_tree_add_item(tree, hf, tvb, offset, length, ENC_NA);\r\nexpert_add_info_format(pinfo, ti_fetchreq, &ei_reload_truncated_field, "Truncated FetchReq");\r\nreturn length;\r\n}\r\nlocal_length = 1+ resourceid_length+ 2 + specifiers_length;\r\nti_fetchreq = proto_tree_add_item(tree, hf, tvb, offset, local_length, ENC_NA);\r\nfetchreq_tree = proto_item_add_subtree(ti_fetchreq, ett_reload_fetchreq);\r\nlocal_offset +=\r\ndissect_resourceid(hf_reload_resource, tvb, pinfo, fetchreq_tree, offset, local_length);\r\nti_specifiers = proto_tree_add_item(fetchreq_tree, hf_reload_fetchreq_specifiers, tvb, offset+local_offset, 2+specifiers_length, ENC_NA);\r\nspecifiers_tree = proto_item_add_subtree(ti_specifiers, ett_reload_fetchreq_specifiers);\r\nproto_item_append_text(ti_specifiers, "(StoredDataSpecifier<%d>)", specifiers_length);\r\nproto_tree_add_item(specifiers_tree, hf_reload_length_uint16, tvb, offset+local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nwhile (specifiers_offset >= 0 && specifiers_offset < specifiers_length) {\r\nguint32 specifiers_increment;\r\nspecifiers_increment = dissect_storeddataspecifier(tvb, pinfo, specifiers_tree, offset+local_offset+specifiers_offset, specifiers_length-specifiers_offset);\r\nif (specifiers_increment == 0) {\r\nbreak;\r\n}\r\nnSpecifiers++;\r\nspecifiers_offset += specifiers_increment;\r\n}\r\nproto_item_append_text(ti_specifiers, ": %d elements", nSpecifiers);\r\nreturn (1+ resourceid_length+ 2 + specifiers_length);\r\n}\r\nstatic int\r\ndissect_fetchans(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nproto_item *ti_fetchans;\r\nproto_tree *fetchans_tree;\r\nguint32 kind_responses_length;\r\nguint32 kind_responses_offset = 0;\r\nkind_responses_length = tvb_get_ntohl(tvb, offset);\r\nif (4 + kind_responses_length > length) {\r\nti_fetchans = proto_tree_add_item(tree, hf_reload_fetchans, tvb, offset, length, ENC_NA);\r\nexpert_add_info_format(pinfo, ti_fetchans, &ei_reload_truncated_field, "Truncated FetchAns");\r\nreturn length;\r\n}\r\nti_fetchans = proto_tree_add_item(tree, hf_reload_fetchans, tvb, offset, 4 + kind_responses_length, ENC_NA);\r\nfetchans_tree = proto_item_add_subtree(ti_fetchans, ett_reload_fetchans);\r\nproto_tree_add_uint(fetchans_tree, hf_reload_length_uint32, tvb, offset, 4, kind_responses_length);\r\nwhile (kind_responses_offset < kind_responses_length) {\r\nguint32 kind_responses_increment;\r\nkind_responses_increment = dissect_kinddata(tvb, pinfo, fetchans_tree, offset + 4 + kind_responses_offset, kind_responses_length - kind_responses_offset, FALSE);\r\nif (kind_responses_increment == 0) {\r\nbreak;\r\n}\r\nkind_responses_offset += kind_responses_increment;\r\n}\r\nreturn 4 + kind_responses_length;\r\n}\r\nstatic int\r\ndissect_statans(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nproto_item *ti_statans;\r\nproto_tree *statans_tree;\r\nguint32 kind_responses_length;\r\nguint32 kind_responses_offset = 0;\r\nint nResponses = 0;\r\nkind_responses_length = tvb_get_ntohl(tvb, offset);\r\nif (4 + kind_responses_length > length) {\r\nti_statans = proto_tree_add_item(tree, hf_reload_statans, tvb, offset, length, ENC_NA);\r\nexpert_add_info_format(pinfo, ti_statans, &ei_reload_truncated_field, "Truncated StatAns");\r\nreturn length;\r\n}\r\nti_statans = proto_tree_add_item(tree, hf_reload_statans, tvb, offset, 4 + kind_responses_length, ENC_NA);\r\nproto_item_append_text(ti_statans, " (StatKindResponse<%d>)", kind_responses_length);\r\nstatans_tree = proto_item_add_subtree(ti_statans, ett_reload_statans);\r\nproto_tree_add_uint(statans_tree, hf_reload_length_uint32, tvb, offset, 4, kind_responses_length);\r\nwhile (kind_responses_offset < kind_responses_length) {\r\nguint32 kind_responses_increment;\r\nkind_responses_increment = dissect_kinddata(tvb, pinfo, statans_tree, offset + 4 + kind_responses_offset, kind_responses_length - kind_responses_offset, TRUE);\r\nif (kind_responses_increment == 0) {\r\nbreak;\r\n}\r\nnResponses++;\r\nkind_responses_offset += kind_responses_increment;\r\n}\r\nproto_item_append_text(ti_statans, ": %d elements", nResponses);\r\nreturn 4 + kind_responses_length;\r\n}\r\nstatic int\r\ndissect_chordupdate(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nproto_item *ti_chordupdate;\r\nproto_tree *chordupdate_tree;\r\nguint16 local_offset = 0;\r\nguint8 type;\r\nti_chordupdate = proto_tree_add_item(tree, hf_reload_chordupdate, tvb, offset, length, ENC_NA);\r\nchordupdate_tree = proto_item_add_subtree(ti_chordupdate, ett_reload_chordupdate);\r\nproto_tree_add_item(chordupdate_tree, hf_reload_uptime, tvb, offset+local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\ntype = tvb_get_guint8(tvb, offset + local_offset);\r\nproto_tree_add_uint(chordupdate_tree, hf_reload_chordupdate_type, tvb, offset+local_offset, 1, type);\r\nlocal_offset += 1;\r\nswitch(type) {\r\ncase CHORDUPDATETYPE_NEIGHBORS:\r\nlocal_offset += dissect_nodeid_list(tvb, pinfo, chordupdate_tree, offset+local_offset, length-local_offset, hf_reload_chordupdate_predecessors, 2);\r\nlocal_offset += dissect_nodeid_list(tvb, pinfo, chordupdate_tree, offset+local_offset, length-local_offset, hf_reload_chordupdate_successors, 2);\r\nbreak;\r\ncase CHORDUPDATETYPE_FULL:\r\nlocal_offset += dissect_nodeid_list(tvb, pinfo, chordupdate_tree, offset+local_offset, length-local_offset, hf_reload_chordupdate_predecessors, 2);\r\nlocal_offset += dissect_nodeid_list(tvb, pinfo, chordupdate_tree, offset+local_offset, length-local_offset, hf_reload_chordupdate_successors, 2);\r\nlocal_offset += dissect_nodeid_list(tvb, pinfo, chordupdate_tree, offset+local_offset, length-local_offset, hf_reload_chordupdate_fingers, 2);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nreturn local_offset;\r\n}\r\nstatic int\r\ndissect_chordroutequeryans(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nproto_item *ti_chordroutequeryans;\r\nproto_tree *chordroutequeryans_tree;\r\nti_chordroutequeryans = proto_tree_add_item(tree, hf_reload_chordroutequeryans, tvb, offset, length, ENC_NA);\r\nchordroutequeryans_tree = proto_item_add_subtree(ti_chordroutequeryans, ett_reload_chordroutequeryans);\r\ndissect_nodeid(hf_reload_chordroutequeryans_next_peer, tvb, pinfo, chordroutequeryans_tree, offset, length);\r\nreturn length;\r\n}\r\nstatic int\r\ndissect_chordleavedata(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nproto_item *ti_local;\r\nproto_tree *local_tree;\r\nguint16 local_offset = 0;\r\nguint8 type;\r\nti_local = proto_tree_add_item(tree, hf_reload_chordleave, tvb, offset, length, ENC_NA);\r\nlocal_tree = proto_item_add_subtree(ti_local, ett_reload_chordleave);\r\ntype = tvb_get_guint8(tvb, offset + local_offset);\r\nproto_tree_add_uint(local_tree, hf_reload_chordleave_type, tvb, offset+local_offset, 1, type);\r\nlocal_offset += 1;\r\nswitch(type) {\r\ncase CHORDLEAVETYPE_FROM_SUCC:\r\nlocal_offset += dissect_nodeid_list(tvb, pinfo, local_tree, offset+local_offset, length-local_offset, hf_reload_chordleave_successors, 2);\r\nbreak;\r\ncase CHORDLEAVETYPE_FROM_PRED:\r\nlocal_offset += dissect_nodeid_list(tvb, pinfo, local_tree, offset+local_offset, length-local_offset, hf_reload_chordleave_predecessors, 2);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nreturn local_offset;\r\n}\r\nstatic int dissect_kindid_list(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length, guint16 length_size)\r\n{\r\nproto_item *ti_local;\r\nproto_tree *local_tree;\r\nint kinds_length = 0;\r\nint kinds_offset = 0;\r\nint nKinds = 0;\r\nkinds_length = get_opaque_length(tvb, offset, length_size);\r\nif ((guint16)length<kinds_length+length_size) {\r\nti_local = proto_tree_add_item(tree, hf_reload_kindid_list, tvb, offset, length, ENC_NA);\r\nexpert_add_info_format(pinfo, ti_local, &ei_reload_truncated_field, "Truncated kinds list");\r\n}\r\nti_local = proto_tree_add_item(tree, hf_reload_kindid_list, tvb, offset, length, ENC_NA);\r\nlocal_tree = proto_item_add_subtree(ti_local, ett_reload_kindid_list);\r\nproto_item_append_text(ti_local, "(KindId<%d>)", kinds_length);\r\ndissect_length(tvb, local_tree, offset, length_size);\r\nwhile (kinds_offset < kinds_length) {\r\nkind_t *kind;\r\nint local_increment = dissect_kindid(-1,tvb, local_tree,offset+length_size+kinds_offset, &kind);\r\nif (local_increment <= 0) break;\r\nkinds_offset += local_increment;\r\nnKinds++;\r\n}\r\nproto_item_append_text(ti_local, ": %d elements", nKinds);\r\nreturn (length_size+kinds_length);\r\n}\r\nstatic int dissect_findreq(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length) {\r\nproto_item *ti_local;\r\nproto_tree *local_tree;\r\nguint16 local_offset = 0;\r\nti_local = proto_tree_add_item(tree, hf_reload_findreq, tvb, offset, length, ENC_NA);\r\nlocal_tree = proto_item_add_subtree(ti_local, ett_reload_findreq);\r\nlocal_offset += dissect_resourceid(hf_reload_resource, tvb, pinfo, local_tree, offset, length);\r\ndissect_kindid_list(tvb, pinfo, local_tree, offset+local_offset, length-local_offset, 1);\r\nreturn length;\r\n}\r\nstatic int dissect_findans(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length) {\r\nproto_item *ti_local;\r\nproto_tree *local_tree;\r\nguint16 results_length;\r\nti_local = proto_tree_add_item(tree, hf_reload_findans, tvb, offset, length, ENC_NA);\r\nlocal_tree = proto_item_add_subtree(ti_local, ett_reload_findans);\r\nresults_length = tvb_get_ntohs(tvb, offset);\r\nproto_item_append_text(ti_local, " (FindKindData<%d>)", results_length);\r\nif (results_length + 2 > length) {\r\nexpert_add_info_format(pinfo, ti_local, &ei_reload_truncated_field, "Truncated FindAns");\r\n}\r\nproto_tree_add_uint(local_tree, hf_reload_length_uint16, tvb, offset, 2, results_length);\r\n{\r\ngint32 results_offset = 0;\r\nint nResults = 0;\r\nwhile (results_offset >= 0 && results_offset < results_length) {\r\nproto_item *ti_findkinddata;\r\nproto_tree *findkinddata_tree;\r\nguint16 findkinddata_length;\r\nkind_t *kind;\r\nfindkinddata_length = 4 + 1 + get_opaque_length(tvb,offset + 2 + results_offset + 4, 1);\r\nif (results_offset + findkinddata_length > results_length) {\r\nti_findkinddata = proto_tree_add_item(local_tree, hf_reload_findkinddata, tvb, offset + results_offset, results_length - results_offset, ENC_NA);\r\nexpert_add_info_format(pinfo, ti_findkinddata, &ei_reload_truncated_field, "Truncated FindKindData");\r\nbreak;\r\n}\r\nti_findkinddata = proto_tree_add_item(local_tree, hf_reload_findkinddata, tvb, offset + 2 + results_offset, findkinddata_length, ENC_NA);\r\nfindkinddata_tree = proto_item_add_subtree(ti_findkinddata, ett_reload_findkinddata);\r\ndissect_kindid(hf_reload_kinddata_kind,tvb, findkinddata_tree, offset+2+results_offset,&kind);\r\ndissect_resourceid(hf_reload_findkinddata_closest, tvb, pinfo, findkinddata_tree, offset+2+results_offset+4, results_length - 4 - results_offset);\r\nif (findkinddata_length <= 0) break;\r\nresults_offset += findkinddata_length;\r\nnResults++;\r\n}\r\nproto_item_append_text(ti_local, ": %d elements", nResults);\r\n}\r\nreturn length;\r\n}\r\nstatic int dissect_selftuningdata(tvbuff_t *tvb, proto_tree *tree, guint16 offset)\r\n{\r\nproto_item *ti_local;\r\nproto_tree *local_tree;\r\nti_local = proto_tree_add_item(tree, hf_reload_self_tuning_data, tvb, offset, 12, ENC_NA);\r\nlocal_tree = proto_item_add_subtree(ti_local, ett_reload_self_tuning_data);\r\nproto_tree_add_item(local_tree, hf_reload_self_tuning_data_network_size, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(local_tree, hf_reload_self_tuning_data_join_rate, tvb, offset+4, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(local_tree, hf_reload_self_tuning_data_leave_rate, tvb, offset+8, 4, ENC_BIG_ENDIAN);\r\nreturn 12;\r\n}\r\nstatic int dissect_extensiveroutingmodeoption(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nproto_item *ti_local;\r\nproto_tree *local_tree;\r\nguint16 local_offset = 0;\r\nti_local = proto_tree_add_item(tree, hf_reload_extensiveroutingmodeoption, tvb, offset, length, ENC_NA);\r\nlocal_tree = proto_item_add_subtree(ti_local, ett_reload_extensiveroutingmodeoption);\r\nproto_tree_add_item(local_tree, hf_reload_routemode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(local_tree, hf_reload_extensiveroutingmode_transport, tvb,\r\noffset+local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nlocal_offset += dissect_ipaddressport(hf_reload_extensiveroutingmode_ipaddressport, tvb, local_tree, offset+local_offset);\r\n{\r\nproto_item *ti_destination;\r\nproto_tree *destination_tree;\r\nguint16 destination_length;\r\nint nDestinations = 0;\r\ndestination_length = tvb_get_guint8(tvb, offset+local_offset);\r\nif (destination_length+1+local_offset>length) {\r\nexpert_add_info_format(pinfo, ti_local, &ei_reload_truncated_field, "Truncated ExtensiveRoutingModeOption");\r\ndestination_length = length -1-local_offset;\r\n}\r\nti_destination = proto_tree_add_item(local_tree, hf_reload_extensiveroutingmode_destination, tvb,offset+local_offset, 1+destination_length, ENC_NA);\r\nproto_item_append_text(ti_destination, " (Destination<%d>)", destination_length);\r\ndestination_tree = proto_item_add_subtree(ti_destination, ett_reload_extensiveroutingmode_destination);\r\nproto_tree_add_item(destination_tree, hf_reload_length_uint8, tvb,offset+local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\ndissect_destination_list(tvb, pinfo, destination_tree, offset+local_offset, destination_length, &nDestinations);\r\nproto_item_append_text(ti_destination, ": %d elements", nDestinations);\r\nlocal_offset += destination_length;\r\n}\r\nreturn local_offset;\r\n}\r\nstatic int dissect_forwardingoption(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nproto_item *ti_option;\r\nguint16 local_offset = 0;\r\nguint8 option_type = tvb_get_guint8(tvb,offset);\r\nguint8 option_flags = tvb_get_guint8(tvb, offset+ 1);\r\nguint16 option_length = tvb_get_ntohs(tvb, offset+ 2);\r\nproto_tree *option_tree;\r\nti_option = proto_tree_add_item(tree, hf_reload_forwarding_option, tvb, offset+local_offset, option_length + 4, ENC_NA);\r\nproto_item_append_text(ti_option, " type=%s, flags=%02x, length=%d", val_to_str_const(option_type, forwardingoptiontypes, "Unknown"), option_flags, option_length);\r\noption_tree = proto_item_add_subtree(ti_option, ett_reload_forwarding_option);\r\nproto_tree_add_item(option_tree, hf_reload_forwarding_option_type, tvb, offset+local_offset, 1, ENC_BIG_ENDIAN);\r\n{\r\nproto_item *ti_flags;\r\nproto_tree *flags_tree;\r\nguint32 bit_offset;\r\nti_flags = proto_tree_add_uint(option_tree, hf_reload_forwarding_option_flags, tvb, offset+local_offset+1, 1, option_flags);\r\nflags_tree = proto_item_add_subtree(ti_flags, ett_reload_forwarding_option_flags);\r\nbit_offset = 8*(offset+local_offset+1);\r\nproto_tree_add_bits_item(flags_tree, hf_reload_forwarding_option_flag_ignore_state_keeping, tvb, bit_offset+4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bits_item(flags_tree, hf_reload_forwarding_option_flag_response_copy, tvb, bit_offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bits_item(flags_tree, hf_reload_forwarding_option_flag_destination_critical, tvb, bit_offset+6, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bits_item(flags_tree, hf_reload_forwarding_option_flag_forward_critical, tvb, bit_offset+7, 1, ENC_BIG_ENDIAN);\r\n}\r\nproto_tree_add_uint(option_tree, hf_reload_length_uint16, tvb, offset+local_offset+2, 2, option_length);\r\nlocal_offset += 4;\r\nif (local_offset + option_length > length) {\r\nexpert_add_info_format(pinfo, ti_option, &ei_reload_truncated_field, "Truncated ForwardingOption");\r\nreturn length;\r\n}\r\nswitch (option_type) {\r\ncase OPTIONTYPE_EXTENSIVE_ROUTING_MODE:\r\ndissect_extensiveroutingmodeoption(tvb, pinfo, option_tree, offset+local_offset, option_length);\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(option_tree, hf_reload_opaque_data, tvb, offset+local_offset, option_length, ENC_NA);\r\nbreak;\r\n}\r\nlocal_offset += option_length;\r\nreturn local_offset;\r\n}\r\nstatic int dissect_dmflag(tvbuff_t *tvb, proto_tree *tree, guint16 offset) {\r\nproto_item *ti_local;\r\nproto_tree *local_tree;\r\nguint i;\r\nguint32 bit_offset = offset<<3;\r\nti_local = proto_tree_add_item(tree, hf_reload_dmflags, tvb, offset, 8, ENC_BIG_ENDIAN);\r\nlocal_tree = proto_item_add_subtree(ti_local, ett_reload_dmflags);\r\nfor (i=0; i<(sizeof(reload_dmflag_items)/sizeof(gint *)); i++) {\r\nif (reload_dmflag_items[i] != NULL) {\r\nproto_tree_add_bits_item(local_tree, *(reload_dmflag_items[i]), tvb, bit_offset+63-i, 1, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nreturn 8;\r\n}\r\nstatic int dissect_diagnosticextension(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nproto_item *ti_local;\r\nproto_tree *local_tree;\r\nguint16 local_offset = 0;\r\nguint16 local_length = 0;\r\nlocal_length = 2 + 4 + get_opaque_length(tvb, offset+2,4);\r\nti_local = proto_tree_add_item(tree, hf_reload_diagnosticextension, tvb, offset, local_length, ENC_NA);\r\nlocal_tree = proto_item_add_subtree(ti_local, ett_reload_diagnosticextension);\r\nproto_tree_add_item(local_tree, hf_reload_diagnosticextension_type, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nlocal_offset += dissect_opaque(tvb, pinfo, local_tree, hf_reload_diagnosticextension_contents, offset + local_offset, 4, length-2);\r\nreturn local_offset;\r\n}\r\nstatic int dissect_diagnosticrequest(int anchor, tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length) {\r\nproto_item *ti_local;\r\nproto_tree *local_tree;\r\nguint16 local_offset = 0;\r\nguint32 local_length = 0;\r\nint hf = hf_reload_diagnosticrequest;\r\nif (anchor >= 0) {\r\nhf = anchor;\r\n}\r\nti_local = proto_tree_add_item(tree, hf, tvb, offset, length, ENC_NA);\r\nlocal_tree = proto_item_add_subtree(ti_local, ett_reload_diagnosticrequest);\r\nproto_tree_add_item(local_tree, hf_reload_diagnostic_expiration, tvb, offset, 8, ENC_TIME_NTP|ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(local_tree, hf_reload_diagnosticrequest_timestampinitiated, tvb,\r\noffset+local_offset, 8, ENC_TIME_NTP|ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nlocal_offset += dissect_dmflag(tvb, local_tree, offset+local_offset);\r\nlocal_length = tvb_get_ntohl(tvb, offset+local_offset);\r\nproto_tree_add_item(local_tree, hf_reload_length_uint32, tvb, offset+local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nif (local_offset+local_length > length) {\r\nexpert_add_info_format(pinfo, ti_local, &ei_reload_truncated_field, "Truncated DiagnosticRequest");\r\nlocal_length = length-local_offset;\r\n}\r\nif (local_length>0) {\r\nproto_item *ti_extensions;\r\nproto_tree *extensions_tree;\r\nguint32 extensions_offset = 0;\r\nguint32 extensions_length = 0;\r\nint nExtensions = 0;\r\nti_extensions = proto_tree_add_item(local_tree, hf_reload_diagnosticrequest_extensions, tvb, offset+local_offset, local_length, ENC_NA);\r\nextensions_tree = proto_item_add_subtree(ti_extensions, ett_reload_diagnosticrequest_extensions);\r\nextensions_length = tvb_get_ntohl(tvb, offset+local_offset);\r\nif (extensions_length+4 > local_length) {\r\nexpert_add_info_format(pinfo, ti_extensions, &ei_reload_truncated_field, "Truncated Diagnostic extensions");\r\nextensions_length = local_length-4;\r\n}\r\nproto_item_append_text(ti_extensions, " (DiagnosticExtension<%d>)",extensions_length);\r\nproto_tree_add_item(extensions_tree, hf_reload_length_uint32, tvb, offset+local_offset, 4, ENC_BIG_ENDIAN);\r\nwhile (extensions_offset<extensions_length) {\r\nint local_increment = dissect_diagnosticextension(tvb, pinfo, extensions_tree, offset+4+local_offset+extensions_offset, extensions_length-extensions_offset);\r\nif (local_increment <= 0) break;\r\nextensions_offset += local_increment;\r\nnExtensions++;\r\n}\r\nproto_item_append_text(ti_extensions, " : %d elements", nExtensions);\r\n}\r\nlocal_offset += local_length;\r\nreturn local_offset;\r\n}\r\nstatic int dissect_pathtrackreq(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nproto_item *ti_local;\r\nproto_tree *local_tree;\r\nguint16 local_offset = 0;\r\nti_local = proto_tree_add_item(tree, hf_reload_pathtrackreq, tvb, offset, length, ENC_NA);\r\nlocal_tree = proto_item_add_subtree(ti_local, ett_reload_pathtrackreq);\r\nlocal_offset += dissect_destination(hf_reload_pathtrackreq_destination, tvb, pinfo, local_tree, offset+local_offset,length);\r\nlocal_offset += dissect_diagnosticrequest(hf_reload_pathtrackreq_request, tvb, pinfo, local_tree, offset+local_offset, length-local_offset);\r\nreturn local_offset;\r\n}\r\nstatic int dissect_diagnosticinfo(tvbuff_t *tvb, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nproto_item *ti_local;\r\nproto_tree *local_tree;\r\nguint16 local_offset = 0;\r\nguint16 local_length = 0;\r\nguint16 kindid;\r\nlocal_length = 2 + tvb_get_ntohs(tvb, offset+2);\r\nti_local = proto_tree_add_item(tree, hf_reload_diagnosticinfo, tvb, offset, local_length+4, ENC_NA);\r\nlocal_tree = proto_item_add_subtree(ti_local, ett_reload_diagnosticinfo);\r\nproto_tree_add_item(local_tree, hf_reload_diagnosticinfo_kind, tvb, offset+local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nproto_tree_add_item(local_tree, hf_reload_length_uint16, tvb, offset+local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nkindid = tvb_get_ntohs(tvb, offset);\r\nswitch(kindid) {\r\ncase DIAGNOSTICKINDID_STATUS_INFO:\r\nproto_tree_add_item(local_tree, hf_reload_diagnosticinfo_congestion_status, tvb, offset+local_offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase DIAGNOSTICKINDID_ROUTING_TABLE_SIZE:\r\nproto_tree_add_item(local_tree, hf_reload_diagnosticinfo_number_peers, tvb, offset+local_offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase DIAGNOSTICKINDID_PROCESS_POWER:\r\nproto_tree_add_item(local_tree, hf_reload_diagnosticinfo_processing_power, tvb, offset+local_offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase DIAGNOSTICKINDID_BANDWIDTH:\r\nproto_tree_add_item(local_tree, hf_reload_diagnosticinfo_bandwidth, tvb, offset+local_offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase DIAGNOSTICKINDID_SOFTWARE_VERSION:\r\nproto_tree_add_item(local_tree, hf_reload_diagnosticinfo_software_version, tvb, offset+local_offset, length, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase DIAGNOSTICKINDID_MACHINE_UPTIME:\r\nproto_tree_add_item(local_tree, hf_reload_diagnosticinfo_machine_uptime, tvb, offset+local_offset, 8, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase DIAGNOSTICKINDID_APP_UPTIME:\r\nproto_tree_add_item(local_tree, hf_reload_diagnosticinfo_app_uptime, tvb, offset+local_offset, 8, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase DIAGNOSTICKINDID_MEMORY_FOOTPRINT:\r\nproto_tree_add_item(local_tree, hf_reload_diagnosticinfo_memory_footprint, tvb, offset+local_offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase DIAGNOSTICKINDID_DATASIZE_STORED:\r\nproto_tree_add_item(local_tree, hf_reload_diagnosticinfo_datasize_stored, tvb, offset+local_offset, 8, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase DIAGNOSTICKINDID_INSTANCES_STORED:\r\n{\r\nproto_item *ti_instances;\r\nproto_tree *instances_tree;\r\ngint32 instances_offset = 0;\r\nint nElements = 0;\r\nti_instances = proto_tree_add_item(local_tree, hf_reload_diagnosticinfo_instances_stored,\\r\ntvb, offset+local_offset, length, ENC_NA);\r\ninstances_tree = proto_item_add_subtree(ti_instances, ett_reload_diagnosticinfo_instances_stored);\r\nproto_item_append_text(ti_instances, "[%d]", length);\r\nwhile (instances_offset >= 0 && instances_offset < length) {\r\nproto_item *ti_instances_per_kindid;\r\nproto_tree *instances_per_kindid_tree;\r\nkind_t *kind;\r\nguint64 instances;\r\nti_instances_per_kindid = proto_tree_add_item(instances_tree, hf_reload_diagnosticinfo_instancesstored_info,\r\ntvb, offset+local_offset+instances_offset, 12, ENC_NA);\r\ninstances_per_kindid_tree = proto_item_add_subtree(ti_instances_per_kindid,\r\nett_reload_diagnosticinfo_instancesstored_info);\r\ndissect_kindid(hf_reload_kinddata_kind, tvb, instances_per_kindid_tree, offset+local_offset+instances_offset, &kind);\r\nproto_tree_add_item(instances_per_kindid_tree, hf_reload_diagnosticinfo_instancesstored_instances,\r\ntvb, offset+local_offset+instances_offset+4, 8, ENC_BIG_ENDIAN);\r\ninstances = tvb_get_ntoh64(tvb, offset+local_offset+instances_offset+4);\r\nproto_item_append_text(ti_instances_per_kindid, ": %s/%" G_GINT64_MODIFIER "d",\r\n((kind != NULL) && (kind->name != NULL)) ? kind->name : "UNKNOWN KIND", instances);\r\ninstances_offset += 12;\r\nnElements++;\r\n}\r\nif (nElements>0) {\r\nproto_item_append_text(ti_instances, ": %d", nElements);\r\n}\r\n}\r\nbreak;\r\ncase DIAGNOSTICKINDID_MESSAGES_SENT_RCVD:\r\n{\r\nproto_item *ti_messages;\r\nproto_tree *messages_tree;\r\ngint32 messages_offset = 0;\r\nint nElements = 0;\r\nti_messages = proto_tree_add_item(local_tree, hf_reload_diagnosticinfo_messages_sent_rcvd,\r\ntvb, offset+local_offset, length, ENC_NA);\r\nmessages_tree = proto_item_add_subtree(ti_messages, ett_reload_diagnosticinfo_messages_sent_rcvd);\r\nproto_item_append_text(ti_messages, "[%d]", length);\r\nwhile (messages_offset >= 0 && messages_offset < length) {\r\nproto_item *ti_sent_rcvd;\r\nproto_tree *sent_rcvd_tree;\r\nguint16 message_code;\r\nti_sent_rcvd = proto_tree_add_item(messages_tree, hf_reload_diagnosticinfo_messages_sent_rcvd_info, tvb, offset+local_offset+messages_offset, 20, ENC_NA);\r\nsent_rcvd_tree = proto_item_add_subtree(ti_sent_rcvd, ett_reload_diagnosticinfo_messages_sent_rcvd_info);\r\nmessage_code = tvb_get_ntohs(tvb, offset+local_offset+messages_offset);\r\nif (message_code == RELOAD_ERROR) {\r\nproto_tree_add_uint_format_value(sent_rcvd_tree, hf_reload_diagnosticinfo_message_code, tvb,\r\noffset+local_offset+messages_offset, 2,\r\nmessage_code,\r\n"error");\r\n}\r\nelse {\r\nproto_tree_add_uint_format_value(sent_rcvd_tree, hf_reload_diagnosticinfo_message_code, tvb,\r\noffset+local_offset+messages_offset, 2,\r\nmessage_code,\r\n"%s_%s",\r\nval_to_str_const(MSGCODE_TO_METHOD(message_code), methods_short, "Unknown"),\r\nval_to_str_const(MSGCODE_TO_CLASS(message_code), classes_short, "Unknown"));\r\n}\r\nproto_tree_add_item(sent_rcvd_tree, hf_reload_diagnosticinfo_messages_sent,\r\ntvb, offset+local_offset+messages_offset+2, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sent_rcvd_tree, hf_reload_diagnosticinfo_messages_rcvd,\r\ntvb, offset+local_offset+messages_offset+2+8, 8, ENC_BIG_ENDIAN);\r\nmessages_offset += 18;\r\nnElements++;\r\n}\r\nif (nElements>0) {\r\nproto_item_append_text(ti_messages, ": %d", nElements);\r\n}\r\n}\r\nbreak;\r\ncase DIAGNOSTICKINDID_EWMA_BYTES_SENT:\r\nproto_tree_add_item(local_tree, hf_reload_diagnosticinfo_ewma_bytes_sent, tvb, offset+local_offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase DIAGNOSTICKINDID_EWMA_BYTES_RCVD:\r\nproto_tree_add_item(local_tree, hf_reload_diagnosticinfo_ewma_bytes_rcvd, tvb, offset+local_offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase DIAGNOSTICKINDID_UNDERLAY_HOP:\r\nproto_tree_add_item(local_tree, hf_reload_diagnosticinfo_underlay_hops, tvb, offset+local_offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase DIAGNOSTICKINDID_BATTERY_STATUS:\r\nproto_tree_add_item(local_tree, hf_reload_diagnosticinfo_battery_status, tvb, offset+local_offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(local_tree, hf_reload_opaque_data, tvb, offset+local_offset, length, ENC_NA);\r\nbreak;\r\n}\r\nreturn local_length;\r\n}\r\nstatic int dissect_diagnosticresponse(int anchor, tvbuff_t *tvb, packet_info *pinfo,proto_tree *tree, guint16 offset, guint16 length) {\r\nproto_item *ti_local;\r\nproto_tree *local_tree;\r\nguint16 local_offset = 0;\r\nint hf = hf_reload_diagnosticresponse;\r\nif (anchor >= 0) {\r\nhf = anchor;\r\n}\r\nti_local = proto_tree_add_item(tree, hf, tvb, offset, length, ENC_NA);\r\nlocal_tree = proto_item_add_subtree(ti_local, ett_reload_diagnosticresponse);\r\nproto_tree_add_item(local_tree, hf_reload_diagnostic_expiration, tvb, offset, 8, ENC_TIME_NTP|ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(local_tree, hf_reload_diagnosticresponse_timestampreceived,\r\ntvb, offset+local_offset, 8, ENC_TIME_NTP|ENC_BIG_ENDIAN);\r\nlocal_offset += 8;\r\nproto_tree_add_item(local_tree, hf_reload_diagnosticresponse_hopcounter, tvb, offset+local_offset, 1, ENC_BIG_ENDIAN);\r\n{\r\nproto_item *ti_diagnostics;\r\nproto_tree *diagnostics_tree;\r\ngint32 diagnostics_offset = 0;\r\nguint32 diagnostics_length = 0;\r\nint nDiagnostics = 0;\r\ndiagnostics_length = tvb_get_ntohl(tvb, offset+local_offset);\r\nif (diagnostics_length+local_offset+4>length) {\r\nexpert_add_info_format(pinfo, ti_local, &ei_reload_truncated_field, "Truncated Diagnostic Response");\r\ndiagnostics_length = length -4 -local_offset;\r\n}\r\nti_diagnostics = proto_tree_add_item(local_tree, hf_reload_diagnosticresponse_diagnostic_info_list, tvb, offset+local_offset, diagnostics_length, ENC_NA);\r\ndiagnostics_tree = proto_item_add_subtree(ti_local, ett_reload_diagnosticresponse_diagnostic_info_list);\r\nproto_item_append_text(ti_diagnostics, " (DiagnosticInfo<%d>)",diagnostics_length);\r\nproto_tree_add_item(diagnostics_tree, hf_reload_length_uint32, tvb, offset+local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\nwhile (diagnostics_offset >= 0 && (guint32)diagnostics_offset<diagnostics_length) {\r\nint local_increment = dissect_diagnosticinfo(tvb, diagnostics_tree, offset+local_offset+diagnostics_offset, diagnostics_length-diagnostics_offset);\r\nif (local_increment <= 0) break;\r\ndiagnostics_offset += local_increment;\r\nnDiagnostics++;\r\n}\r\nproto_item_append_text(ti_diagnostics, " : %d elements", nDiagnostics);\r\nlocal_offset += diagnostics_length;\r\n}\r\nreturn local_offset;\r\n}\r\nstatic int dissect_pathtrackans(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nproto_item *ti_local;\r\nproto_tree *local_tree;\r\nguint16 local_offset = 0;\r\nti_local = proto_tree_add_item(tree, hf_reload_pathtrackans, tvb, offset, length, ENC_NA);\r\nlocal_tree = proto_item_add_subtree(ti_local, ett_reload_pathtrackans);\r\nlocal_offset += dissect_destination(hf_reload_pathtrackans_next_hop, tvb, pinfo, local_tree, offset+local_offset,length);\r\nlocal_offset += dissect_diagnosticresponse(hf_reload_pathtrackans_response, tvb, pinfo, local_tree, offset+local_offset, length-local_offset);\r\nreturn local_offset;\r\n}\r\nstatic int dissect_joinreq(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nproto_item *ti_local;\r\nproto_tree *local_tree;\r\nguint16 local_offset = 0;\r\nti_local = proto_tree_add_item(tree, hf_reload_joinreq, tvb, offset, length, ENC_NA);\r\nlocal_tree = proto_item_add_subtree(ti_local, ett_reload_joinreq);\r\nlocal_offset += dissect_nodeid(hf_reload_joinreq_joining_peer_id, tvb, pinfo, local_tree, offset, length);\r\nlocal_offset += dissect_opaque(tvb, pinfo, local_tree, hf_reload_overlay_specific, offset + local_offset, 2,\r\nlength - local_offset);\r\nreturn local_offset;\r\n}\r\nstatic int dissect_joinans(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nproto_item *ti_local;\r\nproto_tree *local_tree;\r\nguint16 local_offset = 0;\r\nti_local = proto_tree_add_item(tree, hf_reload_joinans, tvb, offset, length, ENC_NA);\r\nlocal_tree = proto_item_add_subtree(ti_local, ett_reload_joinans);\r\nlocal_offset = dissect_opaque(tvb, pinfo, local_tree, hf_reload_overlay_specific,\r\noffset + local_offset, 2, length );\r\nreturn local_offset;\r\n}\r\nstatic int dissect_leavereq(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nproto_item *ti_local;\r\nproto_tree *local_tree;\r\nguint16 local_offset = 0;\r\nti_local = proto_tree_add_item(tree, hf_reload_leavereq, tvb, offset, length, ENC_NA);\r\nlocal_tree = proto_item_add_subtree(ti_local, ett_reload_leavereq);\r\nlocal_offset += dissect_nodeid(hf_reload_leavereq_leaving_peer_id, tvb, pinfo, local_tree, offset, length);\r\nif (0 == strcmp(TOPOLOGY_PLUGIN_CHORD_RELOAD, reload_topology_plugin)) {\r\nproto_item *ti_overlay_specific;\r\nproto_tree *overlay_specific_tree;\r\nguint16 overlay_length;\r\nti_overlay_specific = proto_tree_add_item(local_tree, hf_reload_overlay_specific,\r\ntvb, offset+local_offset, length - local_offset, ENC_NA);\r\noverlay_specific_tree = proto_item_add_subtree(ti_overlay_specific, ett_reload_overlay_specific);\r\nproto_tree_add_item(overlay_specific_tree, hf_reload_length_uint16, tvb, offset+local_offset, 2, ENC_BIG_ENDIAN);\r\noverlay_length = tvb_get_ntohs(tvb, offset+local_offset);\r\nlocal_offset+= 2;\r\ndissect_chordleavedata(tvb, pinfo, overlay_specific_tree, offset+local_offset, overlay_length);\r\nlocal_offset += overlay_length;\r\n}\r\nelse {\r\nlocal_offset += dissect_opaque(tvb, pinfo, local_tree, hf_reload_overlay_specific,\r\noffset + reload_nodeid_length, 2, length - local_offset);\r\n}\r\nreturn local_offset;\r\n}\r\nstatic int dissect_probereq(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nproto_item *ti_local, *ti_requested_info;\r\nproto_tree *local_tree, *requested_info_tree;\r\nguint8 info_list_length = 0;\r\nti_local = proto_tree_add_item(tree, hf_reload_probereq, tvb, offset, length, ENC_NA);\r\nlocal_tree = proto_item_add_subtree(ti_local, ett_reload_probereq);\r\nti_requested_info = proto_tree_add_item(local_tree, hf_reload_probereq_requested_info, tvb, offset, length, ENC_NA);\r\nrequested_info_tree = proto_item_add_subtree(ti_requested_info, ett_reload_probereq_requested_info);\r\ninfo_list_length = tvb_get_guint8(tvb, offset);\r\nproto_item_append_text(ti_requested_info, " (ProbeInformationType<%d>)", info_list_length);\r\nproto_tree_add_uint(requested_info_tree, hf_reload_length_uint8, tvb, offset, 1, info_list_length);\r\nif ((info_list_length+1) > length) {\r\nexpert_add_info_format(pinfo, ti_requested_info, &ei_reload_truncated_field, "Truncated requested_info");\r\ninfo_list_length = length - 1;\r\n}\r\n{\r\nint probe_offset = 0;\r\nint nInfos = 0;\r\nwhile (probe_offset >= 0 && probe_offset < info_list_length) {\r\nproto_tree_add_item(requested_info_tree, hf_reload_probe_information_type,\r\ntvb, offset + 1 + probe_offset, 1, ENC_BIG_ENDIAN);\r\nprobe_offset += 1;\r\nnInfos++;\r\n}\r\nproto_item_append_text(ti_requested_info, ": %d elements", nInfos);\r\n}\r\nreturn info_list_length;\r\n}\r\nstatic int dissect_probeans(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nproto_item *ti_local, *ti_infos;\r\nproto_tree *local_tree, *infos_tree;\r\nguint16 info_list_length = 0;\r\nti_local = proto_tree_add_item(tree, hf_reload_probeans, tvb, offset, length, ENC_NA);\r\nlocal_tree = proto_item_add_subtree(ti_local, ett_reload_probeans);\r\ninfo_list_length = tvb_get_ntohs(tvb, offset);\r\nif (info_list_length+2 >length) {\r\nexpert_add_info_format(pinfo, ti_local, &ei_reload_truncated_field, "Truncated ProbeAns");\r\ninfo_list_length = length - 2;\r\n}\r\nti_infos = proto_tree_add_item(local_tree, hf_reload_probeans_probe_info, tvb, offset, info_list_length, ENC_NA);\r\nproto_item_append_text(ti_infos, " (ProbeInformation<%d>)", info_list_length);\r\ninfos_tree = proto_item_add_subtree(ti_infos, ett_reload_probeans_probe_info);\r\n{\r\nint probe_offset = 0;\r\nint probe_increment;\r\nint nInfos = 0;\r\nwhile (probe_offset >= 0 && probe_offset < info_list_length) {\r\nprobe_increment = dissect_probe_information(tvb, pinfo, infos_tree, offset + 2 + probe_offset, info_list_length - probe_offset);\r\nif (probe_increment <= 0) {\r\nbreak;\r\n}\r\nprobe_offset += probe_increment;\r\nnInfos++;\r\n}\r\nproto_item_append_text(ti_infos, ": %d elements", nInfos);\r\n}\r\nreturn length;\r\n}\r\nextern gint dissect_reload_messagecontents(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint16 offset, guint16 length)\r\n{\r\nguint32 message_body_length;\r\nguint32 extensions_length;\r\nproto_item *ti_message_contents;\r\nproto_tree *message_contents_tree;\r\nguint16 message_code;\r\nmessage_body_length = tvb_get_ntohl(tvb, offset + 2);\r\nextensions_length = tvb_get_ntohl(tvb, offset + 2 + 4 + message_body_length);\r\nif (2 + 4 + message_body_length + 4 + extensions_length > length) {\r\nti_message_contents = proto_tree_add_item(tree, hf_reload_message_contents, tvb, offset, length, ENC_NA);\r\nexpert_add_info_format(pinfo, ti_message_contents, &ei_reload_truncated_field, "Truncated MessageContents");\r\nreturn length;\r\n}\r\nti_message_contents = proto_tree_add_item(tree, hf_reload_message_contents, tvb, offset, 2 + 4 + message_body_length + 4 + extensions_length, ENC_NA);\r\nmessage_contents_tree = proto_item_add_subtree(ti_message_contents, ett_reload_message_contents);\r\nmessage_code = tvb_get_ntohs(tvb, offset);\r\nif (message_code != RELOAD_ERROR) {\r\nproto_item *ti_message_body;\r\nproto_tree *message_body_tree;\r\nconst gchar *message_type_str = NULL;\r\n{\r\nproto_item *ti_message_code;\r\nti_message_code = proto_tree_add_item(message_contents_tree, hf_reload_message_code, tvb,\r\noffset, 2, ENC_BIG_ENDIAN);\r\nproto_item_append_text(ti_message_code, " (%s_%s)",\r\nval_to_str(MSGCODE_TO_METHOD(message_code), methods_short, "Unknown %d"),\r\nval_to_str(MSGCODE_TO_CLASS(message_code), classes_short, "Unknown %d"));\r\n}\r\noffset += 2;\r\nti_message_body = proto_tree_add_item(message_contents_tree, hf_reload_message_body, tvb, offset, 4 + message_body_length, ENC_NA);\r\nmessage_body_tree = proto_item_add_subtree(ti_message_body, ett_reload_message_body);\r\nproto_tree_add_uint(message_body_tree, hf_reload_length_uint32, tvb, offset, 4, message_body_length);\r\noffset += 4;\r\nif (message_body_length > 0) {\r\nswitch(MSGCODE_TO_METHOD(message_code)) {\r\ncase METHOD_ROUTEQUERY:\r\n{\r\nif (IS_REQUEST(message_code)) {\r\n{\r\nproto_item * ti_routequeryreq;\r\nproto_tree * routequeryreq_tree;\r\nint destination_length;\r\nmessage_type_str = "RouteQueryReq";\r\nti_routequeryreq = proto_tree_add_item(message_body_tree, hf_reload_routequeryreq,\r\ntvb, offset, message_body_length, ENC_NA);\r\nroutequeryreq_tree = proto_item_add_subtree(ti_routequeryreq, ett_reload_routequeryreq);\r\nproto_tree_add_item(routequeryreq_tree, hf_reload_sendupdate, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ndestination_length = dissect_destination(hf_reload_routequeryreq_destination,\r\ntvb, pinfo, routequeryreq_tree, offset + 1, message_body_length - 1 - 2);\r\ndissect_opaque(tvb, pinfo, routequeryreq_tree, hf_reload_overlay_specific, offset + 1 + destination_length, 2, (message_body_length - 1 - destination_length));\r\n}\r\n}\r\nelse {\r\nmessage_type_str = "ChordRouteQueryAns";\r\nif (0 == strcmp(TOPOLOGY_PLUGIN_CHORD_RELOAD, reload_topology_plugin)) {\r\ndissect_chordroutequeryans(tvb, pinfo, message_body_tree, offset, message_body_length);\r\n}\r\n}\r\n}\r\nbreak;\r\ncase METHOD_PROBE:\r\n{\r\nif (IS_REQUEST(message_code)) {\r\nmessage_type_str = "ProbeReq";\r\ndissect_probereq(tvb, pinfo, message_body_tree, offset, message_body_length);\r\n}\r\nelse {\r\nmessage_type_str = "ProbeAns";\r\ndissect_probeans(tvb, pinfo, message_body_tree, offset, message_body_length);\r\n}\r\n}\r\nbreak;\r\ncase METHOD_ATTACH:\r\n{\r\nmessage_type_str = "AttachReqAns";\r\ndissect_attachreqans(tvb, pinfo, message_body_tree, offset, message_body_length);\r\n}\r\nbreak;\r\ncase METHOD_APPATTACH:\r\n{\r\n{\r\nguint16 local_offset = 0;\r\nproto_item *ti_appattach;\r\nproto_tree *appattach_tree;\r\nint hf = hf_reload_appattachans;\r\nmessage_type_str = "AttachAppAns";\r\nif (IS_REQUEST(message_code)) {\r\nhf = hf_reload_appattachreq;\r\nmessage_type_str = "AttachAppReq";\r\n}\r\nti_appattach = proto_tree_add_item(message_body_tree, hf, tvb, offset+local_offset, message_body_length, ENC_NA);\r\nappattach_tree = proto_item_add_subtree(ti_appattach, ett_reload_appattach);\r\nlocal_offset += dissect_opaque_string(tvb, pinfo,appattach_tree, hf_reload_ufrag,offset+local_offset, 1, message_body_length-local_offset);\r\nlocal_offset += dissect_opaque_string(tvb, pinfo,appattach_tree, hf_reload_password,offset+local_offset, 1, message_body_length-local_offset);\r\nproto_tree_add_item(appattach_tree, hf_reload_application, tvb, offset+local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_offset += 2;\r\nlocal_offset += dissect_opaque_string(tvb, pinfo,appattach_tree, hf_reload_role,offset+local_offset, 1, message_body_length-local_offset);\r\ndissect_icecandidates(tvb, pinfo, appattach_tree, offset+local_offset, message_body_length-local_offset);\r\n}\r\n}\r\nbreak;\r\ncase METHOD_PING:\r\n{\r\nif (IS_REQUEST(message_code)) {\r\nproto_item *ti_local;\r\nproto_tree *local_tree;\r\nmessage_type_str = "PingReq";\r\nti_local = proto_tree_add_item(message_body_tree, hf_reload_pingreq, tvb, offset, message_body_length, ENC_NA);\r\nlocal_tree = proto_item_add_subtree(ti_local, ett_reload_pingreq);\r\ndissect_opaque(tvb, pinfo, local_tree, hf_reload_padding, offset, 2, message_body_length);\r\n}\r\nelse {\r\nmessage_type_str = "PingAns";\r\nif (message_body_length < 16) {\r\nexpert_add_info_format(pinfo, ti_message_contents, &ei_reload_truncated_field, "Truncated ping answer");\r\n}\r\nelse {\r\nproto_item *ti_local;\r\nproto_tree *local_tree;\r\nti_local = proto_tree_add_item(message_body_tree, hf_reload_pingans, tvb, offset, message_body_length, ENC_NA);\r\nlocal_tree = proto_item_add_subtree(ti_local, ett_reload_pingans);\r\nproto_tree_add_item(local_tree, hf_reload_ping_response_id, tvb, offset, 8, ENC_BIG_ENDIAN);\r\n{\r\nguint64 timev;\r\nguint32 remaining_ms;\r\ntime_t time_sec;\r\nnstime_t l_nsTime;\r\ntimev = tvb_get_ntoh64(tvb, offset+8);\r\ntime_sec = (time_t)timev/1000;\r\nremaining_ms = (guint32)(timev % 1000);\r\nl_nsTime.secs = time_sec;\r\nl_nsTime.nsecs = remaining_ms*1000*1000;\r\nproto_tree_add_time(local_tree, hf_reload_ping_time, tvb, offset + 8, 8, &l_nsTime);\r\n}\r\n}\r\n}\r\n}\r\nbreak;\r\ncase METHOD_CONFIGUPDATE:\r\n{\r\nif (IS_REQUEST(message_code)) {\r\nguint16 local_offset = 0;\r\nproto_item *ti_configupdate;\r\nproto_tree *configupdate_tree;\r\nguint8 configupdate_type;\r\nguint32 configupdate_length;\r\nmessage_type_str = "ConfigUpdateReq";\r\nti_configupdate = proto_tree_add_item(message_body_tree, hf_reload_configupdatereq, tvb, offset+local_offset, message_body_length, ENC_NA);\r\nconfigupdate_tree = proto_item_add_subtree(ti_configupdate, ett_reload_configupdatereq);\r\nconfigupdate_type = tvb_get_guint8(tvb, offset + local_offset);\r\nproto_tree_add_uint(configupdate_tree, hf_reload_configupdatereq_type, tvb, offset+local_offset, 1, configupdate_type);\r\nlocal_offset += 1;\r\nconfigupdate_length = tvb_get_ntohl(tvb, offset + local_offset);\r\nproto_tree_add_uint(configupdate_tree, hf_reload_length_uint32, tvb, offset + local_offset, 4, configupdate_length);\r\nif (5 + configupdate_length > message_body_length) {\r\nexpert_add_info_format(pinfo, ti_configupdate, &ei_reload_truncated_field, "Truncated ConfigUpdateReq");\r\nbreak;\r\n}\r\nlocal_offset += 4;\r\nswitch(configupdate_type) {\r\ncase CONFIGUPDATETYPE_CONFIG:\r\n{\r\nif (xml_handle == NULL) {\r\nexpert_add_info(pinfo, ti_configupdate, &ei_reload_no_xml_dissector);\r\ndissect_opaque_string(tvb, pinfo, configupdate_tree, hf_reload_configupdatereq_configdata, offset+local_offset, 3, configupdate_length);\r\n}\r\nelse {\r\nproto_item *ti_config_data;\r\nproto_tree *config_data_tree;\r\nguint32 config_length;\r\nconfig_length = tvb_get_ntoh24(tvb,offset+local_offset);\r\nti_config_data = proto_tree_add_item(configupdate_tree, hf_reload_configupdatereq_configdata, tvb, offset+local_offset, configupdate_length, ENC_NA);\r\nconfig_data_tree = proto_item_add_subtree(ti_config_data, ett_reload_configupdatereq_config_data);\r\nproto_tree_add_item(config_data_tree, hf_reload_length_uint24, tvb, offset+local_offset, 3, ENC_BIG_ENDIAN);\r\ncall_dissector_only(xml_handle,\r\ntvb_new_subset(tvb, offset+local_offset+3, config_length, length-offset-local_offset-3),\r\npinfo, config_data_tree, NULL);\r\n}\r\n}\r\nbreak;\r\ncase CONFIGUPDATETYPE_KIND:\r\n{\r\nproto_item *ti_kinds;\r\nproto_tree *kinds_tree;\r\nguint32 kinds_length;\r\nguint32 kinds_offset = 0;\r\nint nKinds = 0;\r\nti_kinds = proto_tree_add_item(configupdate_tree, hf_reload_configupdatereq_kinds,\r\ntvb, offset+local_offset, configupdate_length, ENC_NA);\r\nkinds_tree = proto_item_add_subtree(ti_kinds, ett_reload_configupdatereq_kinds);\r\nkinds_length = get_opaque_length(tvb, offset+local_offset, 3);\r\nproto_item_append_text(ti_kinds, " (KindDescription<%d>)", kinds_length);\r\nlocal_offset += dissect_length(tvb, kinds_tree, offset+local_offset, 3);\r\nwhile (kinds_offset < kinds_length) {\r\nguint16 local_increment = tvb_get_ntohs(tvb,offset+local_offset+kinds_offset);\r\nif (xml_handle == NULL) {\r\nexpert_add_info(pinfo, ti_configupdate, &ei_reload_no_xml_dissector);\r\ndissect_opaque_string(tvb, pinfo, configupdate_tree, hf_reload_kinddescription,\r\noffset+local_offset+kinds_offset, 2, configupdate_length);\r\n}\r\nelse {\r\nproto_item *ti_kinddescription;\r\nproto_tree *kinddescription_tree;\r\nti_kinddescription = proto_tree_add_item(kinds_tree, hf_reload_kinddescription,\r\ntvb, offset+local_offset+kinds_offset, 2+local_increment, ENC_NA);\r\nkinddescription_tree = proto_item_add_subtree(ti_kinddescription, ett_reload_kinddescription);\r\nproto_tree_add_item(kinddescription_tree, hf_reload_length_uint16,\r\ntvb, offset+local_offset+kinds_offset, 2, ENC_BIG_ENDIAN);\r\ncall_dissector(xml_handle,\r\ntvb_new_subset(tvb, offset+local_offset+kinds_offset+2,\r\nlocal_increment,\r\nlength-(offset+local_offset+kinds_offset+2)),\r\npinfo, kinddescription_tree);\r\n}\r\nlocal_increment += 2;\r\nif (local_increment <= 0) break;\r\nkinds_offset += local_increment;\r\nnKinds++;\r\n}\r\nproto_item_append_text(ti_kinds, ": %d elements", nKinds);\r\n}\r\nbreak;\r\n}\r\n}\r\nelse {\r\nmessage_type_str = "ConfigUpdateAns";\r\n}\r\nbreak;\r\n}\r\ncase METHOD_STORE:\r\n{\r\nif (IS_REQUEST(message_code)) {\r\nmessage_type_str = "StoreReq";\r\ndissect_storereq(tvb, pinfo, message_body_tree, offset, message_body_length);\r\n}\r\nelse {\r\nmessage_type_str = "StoreAns";\r\ndissect_storeans(tvb, pinfo, message_body_tree, offset, message_body_length);\r\n}\r\n}\r\nbreak;\r\ncase METHOD_FETCH:\r\n{\r\nif (IS_REQUEST(message_code)) {\r\nmessage_type_str = "FetchReq";\r\ndissect_fetchreq(tvb, pinfo, message_body_tree, offset, message_body_length, FALSE);\r\n}\r\nelse {\r\nmessage_type_str = "FetchAns";\r\ndissect_fetchans(tvb, pinfo, message_body_tree, offset, message_body_length);\r\n}\r\n}\r\nbreak;\r\ncase METHOD_STAT:\r\n{\r\nif (IS_REQUEST(message_code)) {\r\nmessage_type_str = "StatReq";\r\ndissect_fetchreq(tvb, pinfo, message_body_tree, offset, message_body_length, TRUE);\r\n}\r\nelse {\r\nmessage_type_str = "StatAns";\r\ndissect_statans(tvb, pinfo, message_body_tree, offset, message_body_length);\r\n}\r\n}\r\nbreak;\r\ncase METHOD_FIND:\r\n{\r\nif (IS_REQUEST(message_code)) {\r\nmessage_type_str = "FindReq";\r\ndissect_findreq(tvb,pinfo, message_body_tree,offset,message_body_length);\r\n}\r\nelse {\r\nmessage_type_str = "FindAns";\r\ndissect_findans(tvb, pinfo, message_body_tree, offset, message_body_length);\r\n}\r\n}\r\nbreak;\r\ncase METHOD_LEAVE:\r\n{\r\nif (IS_REQUEST(message_code)) {\r\nmessage_type_str = "LeaveReq";\r\ndissect_leavereq(tvb,pinfo, message_body_tree,offset,message_body_length);\r\n}\r\nelse {\r\nmessage_type_str = "LeaveAns";\r\ndissect_opaque(tvb, pinfo, message_body_tree, hf_reload_overlay_specific, offset, 2, message_body_length);\r\n}\r\n}\r\nbreak;\r\ncase METHOD_JOIN:\r\n{\r\nif (IS_REQUEST(message_code)) {\r\nmessage_type_str = "JoinReq";\r\ndissect_joinreq(tvb, pinfo, message_body_tree, offset, message_body_length);\r\n}\r\nelse {\r\nmessage_type_str = "JoinAns";\r\ndissect_joinans(tvb, pinfo, message_body_tree, offset, message_body_length);\r\n}\r\n}\r\nbreak;\r\ncase METHOD_UPDATE:\r\nif (0 == strcmp(TOPOLOGY_PLUGIN_CHORD_RELOAD, reload_topology_plugin)) {\r\nif (IS_REQUEST(message_code)) {\r\nmessage_type_str = "ChordUpdate";\r\ndissect_chordupdate(tvb, pinfo, message_body_tree, offset, message_body_length);\r\n}\r\n}\r\nbreak;\r\ncase METHOD_PATH_TRACK:\r\nif (IS_REQUEST(message_code)) {\r\nmessage_type_str = "PathTrackReck";\r\ndissect_pathtrackreq(tvb, pinfo, message_body_tree, offset, message_body_length);\r\n}\r\nelse {\r\nmessage_type_str = "PathTrackAns";\r\ndissect_pathtrackans(tvb, pinfo, message_body_tree, offset, message_body_length);\r\n}\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\nif (message_type_str!= NULL) {\r\nproto_item_append_text(ti_message_body, " (%s<%d>)", message_type_str, message_body_length);\r\n}\r\nelse {\r\nproto_item_append_text(ti_message_body,\r\n" (%s%s<%d>)",\r\nval_to_str_const(MSGCODE_TO_METHOD(message_code),methods,"opaque"),\r\nval_to_str_const(MSGCODE_TO_CLASS(message_code), classes_Short, ""),\r\nmessage_body_length);\r\n}\r\n}\r\nelse {\r\nguint16 error_length, error_code;\r\nproto_item *ti_message_body;\r\nproto_tree *message_body_tree;\r\nproto_item *ti_error;\r\nproto_tree *error_tree;\r\nproto_tree_add_uint_format_value(message_contents_tree, hf_reload_message_code,\r\ntvb, offset, 2, message_code, "Error");\r\noffset += 2;\r\nti_message_body = proto_tree_add_item(message_contents_tree, hf_reload_message_body,\r\ntvb, offset, 4 + message_body_length, ENC_NA);\r\nmessage_body_tree = proto_item_add_subtree(ti_message_body, ett_reload_message_body);\r\nerror_length = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_uint(message_body_tree, hf_reload_length_uint32, tvb, offset, 4, message_body_length);\r\noffset += 4;\r\nerror_code = tvb_get_ntohs(tvb, offset);\r\nif (2 + 2 + error_length >length) {\r\nexpert_add_info_format(pinfo, ti_message_body, &ei_reload_truncated_field, "Truncated error message");\r\nreturn length;\r\n}\r\nti_error = proto_tree_add_item(message_body_tree, hf_reload_error_response,\r\ntvb, offset, 2 + 2 + error_length, ENC_NA);\r\nerror_tree = proto_item_add_subtree(ti_error, ett_reload_error_response);\r\nproto_tree_add_item(error_tree, hf_reload_error_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_item_append_text(ti_error, ": %s", val_to_str_const(error_code, errorcodes, "Unknown"));\r\nswitch(error_code) {\r\ncase ERRORCODE_GENERATIONCOUNTERTOOLOW:\r\n{\r\nguint16 local_length = tvb_get_ntohs(tvb, offset+2);\r\nproto_tree_add_item(error_tree, hf_reload_length_uint16, tvb, offset+2, 2, ENC_BIG_ENDIAN);\r\ndissect_storeans(tvb, pinfo, error_tree, offset+4, local_length);\r\n}\r\nbreak;\r\ncase ERRORCODE_UNKNOWNKIND:\r\n{\r\nguint16 local_length = tvb_get_ntohs(tvb, offset+2);\r\nproto_tree_add_item(error_tree, hf_reload_length_uint16, tvb, offset+2, 2, ENC_BIG_ENDIAN);\r\ndissect_kindid_list(tvb, pinfo, error_tree, offset+4, local_length,1);\r\n}\r\nbreak;\r\ncase ERRORCODE_UNDERLAY_DESTINATION_UNREACHABLE:\r\n{\r\nproto_tree_add_item(error_tree, hf_reload_opaque_string, tvb, offset+2, 32, ENC_ASCII|ENC_NA);\r\n}\r\nbreak;\r\ndefault:\r\ndissect_opaque_string(tvb, pinfo, error_tree, hf_reload_error_response_info, offset+2, 2, -1);\r\nif (error_code <= 19) {\r\nguint16 info_length = tvb_get_ntohs(tvb,offset+2);\r\nif (info_length>0) {\r\nproto_item_append_text(ti_error, " (%s)", tvb_get_string_enc(wmem_packet_scope(), tvb, offset+4, info_length, ENC_ASCII));\r\n}\r\n}\r\nbreak;\r\n}\r\n}\r\noffset += message_body_length;\r\n{\r\nproto_tree *extensions_tree;\r\nproto_item *ti_extensions;\r\nproto_tree *extension_tree;\r\ngint32 extension_offset = 0;\r\nint nExtensions = 0;\r\nti_extensions =\r\nproto_tree_add_item(message_contents_tree, hf_reload_message_extensions, tvb, offset, 4+extensions_length, ENC_NA);\r\nextensions_tree = proto_item_add_subtree(ti_extensions, ett_reload_message_extensions);\r\nproto_tree_add_item(extensions_tree, hf_reload_length_uint32, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nwhile (extension_offset >= 0 && (guint32)extension_offset < extensions_length) {\r\nguint16 type;\r\nproto_item *ti_extension;\r\nguint32 extension_content_length = tvb_get_ntohl(tvb, offset + extension_offset + 3);\r\nif ((extension_offset + 3 + 4 + extension_content_length) > extensions_length) {\r\nexpert_add_info_format(pinfo, ti_extensions, &ei_reload_truncated_field, "Truncated message extensions");\r\nbreak;\r\n}\r\nti_extension = proto_tree_add_item(extensions_tree, hf_reload_message_extension, tvb, offset+ extension_offset, 3 + 4 + extension_content_length, ENC_NA);\r\nextension_tree = proto_item_add_subtree(ti_extension, ett_reload_message_extension);\r\ntype = tvb_get_ntohs(tvb, offset+ extension_offset);\r\nproto_tree_add_item(extension_tree, hf_reload_message_extension_type, tvb, offset+ extension_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(extension_tree, hf_reload_message_extension_critical, tvb, offset+ extension_offset + 2, 1, ENC_BIG_ENDIAN);\r\nswitch(type) {\r\ncase MESSAGEEXTENSIONTYPE_SELF_TUNING_DATA:\r\n{\r\nguint32 extension_length;\r\nproto_tree_add_item(extension_tree, hf_reload_length_uint32, tvb, offset+extension_offset+3, 4, ENC_BIG_ENDIAN);\r\nextension_length = tvb_get_ntohl(tvb, offset+extension_offset+3);\r\nif (extension_length > 0) {\r\ndissect_selftuningdata(tvb, extension_tree, offset+extension_offset+3+4);\r\n}\r\n}\r\nbreak;\r\ncase MESSAGEEXTENSIONTYPE_DIAGNOSTIC_PING:\r\n{\r\nguint32 extension_length;\r\nproto_tree_add_item(extension_tree, hf_reload_length_uint32, tvb, offset+extension_offset+3, 4, ENC_BIG_ENDIAN);\r\nextension_length = tvb_get_ntohl(tvb, offset+extension_offset+3);\r\nif ((extension_length > 0) && (MSGCODE_TO_METHOD(message_code) == METHOD_PING)) {\r\nif (IS_REQUEST(message_code)) {\r\ndissect_diagnosticrequest(-1, tvb, pinfo, extension_tree, offset+extension_offset+3+4, extension_length);\r\n}\r\nelse {\r\ndissect_diagnosticresponse(-1, tvb, pinfo, extension_tree, offset+extension_offset+3+4, extension_length);\r\n}\r\n}\r\n}\r\nbreak;\r\ndefault:\r\ndissect_opaque(tvb, pinfo, extension_tree, hf_reload_message_extension_content, offset + extension_offset + 3, 4, -1);\r\nbreak;\r\n}\r\nextension_offset += 3 + 4 + extension_content_length;\r\nnExtensions ++;\r\n}\r\nproto_item_append_text(ti_extensions, " (%d elements)", nExtensions);\r\n}\r\nreturn ( 2 + 4 + message_body_length + 4 + extensions_length);\r\n}\r\nstatic int\r\ndissect_reload_message(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nproto_item *ti;\r\nproto_tree *reload_tree;\r\nguint32 relo_token;\r\nguint effective_length;\r\nguint msg_length, dgram_msg_length;\r\nguint16 offset;\r\nconversation_t *conversation;\r\nreload_conv_info_t *reload_info;\r\nreload_transaction_t *reload_trans;\r\nwmem_tree_key_t transaction_id_key[2];\r\nguint32 transaction_id[2];\r\nguint16 options_length;\r\nguint16 via_list_length;\r\nguint16 destination_list_length;\r\nguint16 message_code;\r\nguint16 error_code = 0;\r\nguint32 forwarding_length;\r\nproto_tree *reload_forwarding_tree;\r\nconst char *msg_class_str;\r\nconst char *msg_method_str = NULL;\r\ngboolean fragmented = FALSE;\r\ngboolean last_fragment = FALSE;\r\nfragment_head *reload_fd_head = NULL;\r\nguint32 fragment = 0;\r\ngboolean save_fragmented = FALSE;\r\ngboolean update_col_info = TRUE;\r\noffset = 0;\r\neffective_length = tvb_captured_length(tvb);\r\nif (effective_length < MIN_HDR_LENGTH)\r\nreturn 0;\r\nrelo_token = tvb_get_ntohl(tvb,0);\r\nif (relo_token != RELOAD_TOKEN) {\r\nreturn 0;\r\n}\r\nmsg_length = get_reload_message_length(pinfo, tvb, offset);\r\ndgram_msg_length = msg_length;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "RELOAD");\r\ncol_clear(pinfo->cinfo, COL_INFO);\r\ntransaction_id[0] = tvb_get_ntohl(tvb, 20);\r\ntransaction_id[1] = tvb_get_ntohl(tvb, 24);\r\ntransaction_id_key[0].length = 2;\r\ntransaction_id_key[0].key = transaction_id;\r\ntransaction_id_key[1].length = 0;\r\ntransaction_id_key[1].key = NULL;\r\nvia_list_length = tvb_get_ntohs(tvb, 32);\r\ndestination_list_length = tvb_get_ntohs(tvb, 34);\r\noptions_length = tvb_get_ntohs(tvb, 36);\r\nforwarding_length = MIN_HDR_LENGTH + (via_list_length + destination_list_length + options_length);\r\nconversation = find_or_create_conversation(pinfo);\r\nreload_info = (reload_conv_info_t *)conversation_get_proto_data(conversation, proto_reload);\r\nif (!reload_info) {\r\nreload_info = wmem_new(wmem_file_scope(), reload_conv_info_t);\r\nreload_info->transaction_pdus = wmem_tree_new(wmem_file_scope());\r\nconversation_add_proto_data(conversation, proto_reload, reload_info);\r\n}\r\nti = proto_tree_add_item(tree, proto_reload, tvb, 0, -1, ENC_NA);\r\nreload_tree = proto_item_add_subtree(ti, ett_reload);\r\nti = proto_tree_add_item(reload_tree, hf_reload_forwarding, tvb, 0, forwarding_length, ENC_NA);\r\nreload_forwarding_tree = proto_item_add_subtree(ti, ett_reload_forwarding);\r\nproto_tree_add_uint(reload_forwarding_tree, hf_reload_token, tvb, 0, 4, relo_token);\r\nproto_tree_add_item(reload_forwarding_tree, hf_reload_overlay, tvb, 4, 4, ENC_BIG_ENDIAN);\r\n{\r\nproto_item *ti_tmp;\r\nguint16 tmp;\r\ntmp = tvb_get_ntohs(tvb,8);\r\nti_tmp = proto_tree_add_item(reload_forwarding_tree, hf_reload_configuration_sequence, tvb, 8, 2, ENC_BIG_ENDIAN);\r\nif (tmp == 0) {\r\nproto_item_append_text(ti_tmp, "\n [sequence value not verified]");\r\n}\r\n}\r\nproto_tree_add_item(reload_forwarding_tree, hf_reload_version, tvb, 10, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(reload_forwarding_tree, hf_reload_ttl, tvb, 11, 1, ENC_BIG_ENDIAN);\r\n{\r\nproto_item *ti_fragment;\r\nproto_tree *fragment_tree;\r\nguint32 bit_offset;\r\nfragment = tvb_get_ntohl(tvb,12);\r\nti_fragment = proto_tree_add_uint(reload_forwarding_tree, hf_reload_fragment_flag, tvb, 12, 4, fragment);\r\nfragment_tree = proto_item_add_subtree(ti_fragment, ett_reload_fragment_flag);\r\nbit_offset = (12) * 8;\r\nif (fragment & 0x80000000) {\r\nproto_item_append_text(ti_fragment, " (Fragment)");\r\nfragmented = TRUE;\r\n}\r\nif (fragment & 0x40000000) {\r\nproto_item_append_text(ti_fragment, " (Last)");\r\nlast_fragment = TRUE;\r\n}\r\nproto_tree_add_bits_item(fragment_tree, hf_reload_fragment_fragmented, tvb, bit_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bits_item(fragment_tree, hf_reload_fragment_last_fragment, tvb, bit_offset+1, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bits_item(fragment_tree, hf_reload_fragment_reserved, tvb, bit_offset+2, 6, ENC_BIG_ENDIAN);\r\nfragment = fragment & 0x00ffffff;\r\nproto_tree_add_uint(fragment_tree, hf_reload_fragment_offset, tvb, 13, 3, fragment);\r\n}\r\nproto_tree_add_uint(reload_forwarding_tree, hf_reload_length_uint32, tvb, 16, 4, msg_length);\r\nproto_tree_add_item(reload_forwarding_tree, hf_reload_trans_id, tvb, 20, 8, ENC_BIG_ENDIAN);\r\n{\r\nproto_item *ti_tmp;\r\nguint32 tmp;\r\ntmp = tvb_get_ntohl(tvb,28);\r\nti_tmp = proto_tree_add_item(reload_forwarding_tree, hf_reload_max_response_length, tvb, 28, 4, ENC_BIG_ENDIAN);\r\nif (0 == tmp) {\r\nproto_item_append_text(ti_tmp, "\n [Response length not restricted]");\r\n}\r\n}\r\nproto_tree_add_uint(reload_forwarding_tree, hf_reload_via_list_length, tvb, 32, 2, via_list_length);\r\nproto_tree_add_uint(reload_forwarding_tree, hf_reload_destination_list_length, tvb, 34, 2, destination_list_length);\r\nproto_tree_add_uint(reload_forwarding_tree, hf_reload_options_length, tvb, 36, 2, options_length);\r\noffset += MIN_HDR_LENGTH;\r\nif (((guint)offset + via_list_length) > msg_length) {\r\nexpert_add_info(pinfo, ti, &ei_reload_truncated_packet);\r\nreturn MIN_HDR_LENGTH;\r\n}\r\nif (via_list_length > 0) {\r\nproto_item *ti_vialist;\r\nproto_tree *vialist_tree;\r\nint numDestinations = 0;\r\nti_vialist = proto_tree_add_item(reload_forwarding_tree, hf_reload_via_list, tvb, offset, via_list_length, ENC_NA);\r\nvialist_tree = proto_item_add_subtree(ti_vialist, ett_reload_via_list);\r\ndissect_destination_list(tvb, pinfo, vialist_tree, offset, via_list_length, &numDestinations);\r\nproto_item_append_text(ti_vialist, " (Destination<%d>): %d elements",via_list_length,numDestinations);\r\n}\r\noffset += via_list_length;\r\nif (((guint)offset + destination_list_length) > msg_length) {\r\nexpert_add_info(pinfo, ti, &ei_reload_truncated_packet);\r\nreturn offset;\r\n}\r\nif (destination_list_length > 0) {\r\nproto_item *ti_destination_list;\r\nproto_tree *destination_list_tree;\r\nint numDestinations;\r\nti_destination_list = proto_tree_add_item(reload_forwarding_tree, hf_reload_destination_list,\r\ntvb, offset, destination_list_length, ENC_NA);\r\ndestination_list_tree = proto_item_add_subtree(ti_destination_list, ett_reload_destination_list);\r\ndissect_destination_list(tvb, pinfo, destination_list_tree, offset, destination_list_length, &numDestinations);\r\nproto_item_append_text(ti_destination_list, " (Destination<%d>): %d elements",\r\ndestination_list_length,numDestinations);\r\n}\r\noffset += destination_list_length;\r\nif (((guint)offset + options_length) > msg_length) {\r\nexpert_add_info(pinfo, ti, &ei_reload_truncated_packet);\r\nreturn offset;\r\n}\r\nif (options_length > 0) {\r\ngint32 local_offset = 0;\r\nproto_item *ti_options;\r\nproto_tree *options_tree;\r\nint nOptions = 0;\r\nti_options = proto_tree_add_item(reload_forwarding_tree, hf_reload_forwarding_options, tvb, offset+local_offset, options_length, ENC_NA);\r\noptions_tree = proto_item_add_subtree(ti_options, ett_reload_forwarding_options);\r\nwhile (local_offset >=0 && local_offset < options_length) {\r\nint local_increment;\r\nlocal_increment = dissect_forwardingoption(tvb, pinfo, options_tree, offset+local_offset, options_length-local_offset);\r\nif (0 >= local_increment) break;\r\nlocal_offset += local_increment;\r\nnOptions++;\r\n}\r\nproto_item_append_text(ti_options, " (ForwardingOption<%d>): %d elements",options_length,nOptions);\r\n}\r\noffset += options_length;\r\nif ((reload_defragment) && ((fragmented != FALSE) && !((fragment == 0) && (last_fragment)))) {\r\ntvbuff_t *next_tvb = NULL;\r\nreload_fd_head = NULL;\r\nif (tvb_bytes_exist(tvb, offset, msg_length - offset)) {\r\nreload_fd_head = fragment_add_check(&reload_reassembly_table, tvb, offset,\r\npinfo,\r\ntransaction_id[0]^transaction_id[1],\r\nNULL,\r\nfragment,\r\nmsg_length - offset,\r\n!last_fragment);\r\nnext_tvb = process_reassembled_data(tvb, offset, pinfo, "Reassembled RELOAD",\r\nreload_fd_head, &reload_frag_items, &update_col_info, reload_tree);\r\n}\r\nif (next_tvb == NULL) {\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "Fragmented RELOAD protocol (trans id=%x%x off=%u",\r\ntransaction_id[0],transaction_id[1], fragment);\r\nif (reload_fd_head && reload_fd_head->reassembled_in != pinfo->num) {\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " [Reassembled in #%u]",\r\nreload_fd_head->reassembled_in);\r\n}\r\nsave_fragmented = pinfo->fragmented;\r\npinfo->fragmented = TRUE;\r\ncall_data_dissector(tvb_new_subset_remaining(tvb, offset), pinfo, tree);\r\npinfo->fragmented = save_fragmented;\r\nreturn effective_length;\r\n}\r\ntvb = next_tvb;\r\nmsg_length -= offset;\r\noffset = 0;\r\n}\r\neffective_length = tvb_captured_length(tvb);\r\nif (effective_length < msg_length) {\r\nexpert_add_info(pinfo, NULL, &ei_reload_truncated_packet);\r\nreturn 0;\r\n}\r\nmessage_code = tvb_get_ntohs(tvb, offset);\r\nif (!pinfo->fd->flags.visited) {\r\nif ((reload_trans = (reload_transaction_t *)\r\nwmem_tree_lookup32_array(reload_info->transaction_pdus, transaction_id_key)) == NULL) {\r\nreload_trans = wmem_new(wmem_file_scope(), reload_transaction_t);\r\nreload_trans->req_frame = 0;\r\nreload_trans->rep_frame = 0;\r\nreload_trans->req_time = pinfo->abs_ts;\r\nwmem_tree_insert32_array(reload_info->transaction_pdus, transaction_id_key, (void *)reload_trans);\r\n}\r\nif (IS_REQUEST(message_code) && (message_code != RELOAD_ERROR)) {\r\nif (reload_trans->req_frame == 0) {\r\nreload_trans->req_frame = pinfo->num;\r\n}\r\n}\r\nelse {\r\nif (reload_trans->rep_frame == 0) {\r\nreload_trans->rep_frame = pinfo->num;\r\n}\r\n}\r\n}\r\nelse {\r\nreload_trans = (reload_transaction_t *)wmem_tree_lookup32_array(reload_info->transaction_pdus, transaction_id_key);\r\n}\r\nif (!reload_trans) {\r\nreload_trans = wmem_new(wmem_packet_scope(), reload_transaction_t);\r\nreload_trans->req_frame = 0;\r\nreload_trans->rep_frame = 0;\r\nreload_trans->req_time = pinfo->abs_ts;\r\n}\r\nif (IS_REQUEST(message_code) && (message_code != RELOAD_ERROR)) {\r\nif (reload_trans->req_frame != pinfo->num) {\r\nproto_item *it;\r\nit = proto_tree_add_uint(reload_tree, hf_reload_duplicate, tvb, 0, 0, reload_trans->req_frame);\r\nPROTO_ITEM_SET_GENERATED(it);\r\n}\r\nif (reload_trans->rep_frame) {\r\nproto_item *it;\r\nit = proto_tree_add_uint(reload_tree, hf_reload_response_in, tvb, 0, 0, reload_trans->rep_frame);\r\nPROTO_ITEM_SET_GENERATED(it);\r\n}\r\n}\r\nelse {\r\nif (reload_trans->rep_frame != pinfo->num) {\r\nproto_item *it;\r\nit = proto_tree_add_uint(reload_tree, hf_reload_duplicate, tvb, 0, 0, reload_trans->rep_frame);\r\nPROTO_ITEM_SET_GENERATED(it);\r\n}\r\nif (reload_trans->req_frame) {\r\nproto_item *it;\r\nnstime_t ns;\r\nit = proto_tree_add_uint(reload_tree, hf_reload_response_to, tvb, 0, 0, reload_trans->req_frame);\r\nPROTO_ITEM_SET_GENERATED(it);\r\nnstime_delta(&ns, &pinfo->abs_ts, &reload_trans->req_time);\r\nit = proto_tree_add_time(reload_tree, hf_reload_time, tvb, 0, 0, &ns);\r\nPROTO_ITEM_SET_GENERATED(it);\r\n}\r\n}\r\nif (message_code == RELOAD_ERROR) {\r\nerror_code = tvb_get_ntohs(tvb, forwarding_length + 2+4);\r\nmsg_class_str = "Error Response";\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "%s %s", msg_class_str, val_to_str_const(error_code, errorcodes, "Unknown"));\r\nproto_item_append_text(ti, ": %s %s", msg_class_str, val_to_str_const(error_code, errorcodes, "Unknown"));\r\n}\r\nelse {\r\nmsg_class_str = val_to_str(MSGCODE_TO_CLASS(message_code), classes, "Unknown %d");\r\nmsg_method_str = val_to_str(MSGCODE_TO_METHOD(message_code), methods, "Unknown %d");\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "%s %s",\r\nmsg_method_str, msg_class_str);\r\nproto_item_append_text(ti, ": %s %s", msg_method_str, msg_class_str);\r\n}\r\noffset += dissect_reload_messagecontents(tvb, pinfo, reload_tree, offset, (effective_length - offset));\r\n{\r\nproto_item *ti_security_block;\r\nproto_tree *security_block_tree;\r\nproto_item *ti_certificates;\r\nproto_tree *certificates_tree;\r\nguint16 certificates_length;\r\nguint16 signeridentityvalue_length;\r\nguint16 signaturevalue_length;\r\nguint16 security_block_offset = 0;\r\ncertificates_length = tvb_get_ntohs(tvb, offset);\r\nsecurity_block_offset += 2 + certificates_length;\r\nsecurity_block_offset += 2;\r\nsecurity_block_offset += 1;\r\nsigneridentityvalue_length = tvb_get_ntohs(tvb, offset +security_block_offset);\r\nsecurity_block_offset += 2;\r\nsecurity_block_offset += signeridentityvalue_length;\r\nsignaturevalue_length = tvb_get_ntohs(tvb, offset +security_block_offset);\r\nsecurity_block_offset += 2;\r\nsecurity_block_offset += signaturevalue_length;\r\nti_security_block = proto_tree_add_item(reload_tree, hf_reload_security_block, tvb, offset,\r\nsecurity_block_offset, ENC_NA);\r\nsecurity_block_tree = proto_item_add_subtree(ti_security_block, ett_reload_security_block);\r\nsecurity_block_offset = 0;\r\nti_certificates = proto_tree_add_item(security_block_tree,\r\nhf_reload_certificates, tvb, offset,\r\n2 + certificates_length,\r\nENC_NA);\r\nproto_item_append_text(ti_certificates, " (GenericCertificate<%d>)", certificates_length);\r\ncertificates_tree = proto_item_add_subtree(ti_certificates, ett_reload_certificates);\r\nproto_tree_add_uint(certificates_tree, hf_reload_length_uint16, tvb, offset, 2, certificates_length);\r\nsecurity_block_offset += 2;\r\n{\r\ngint32 certificate_offset = 0;\r\nint nCertificates = 0;\r\nwhile (certificate_offset >= 0 && certificate_offset < certificates_length) {\r\nproto_item *ti_genericcertificate;\r\nproto_tree *genericcertificate_tree;\r\nguint16 certificate_length;\r\ncertificate_length = tvb_get_ntohs(tvb, offset + security_block_offset + certificate_offset + 1);\r\nif (certificate_offset + 1 + 2 + certificate_length > certificates_length) {\r\nexpert_add_info_format(pinfo, ti_security_block, &ei_reload_truncated_field, "Truncated certificate");\r\nbreak;\r\n}\r\nti_genericcertificate =\r\nproto_tree_add_item(certificates_tree,\r\nhf_reload_genericcertificate, tvb, offset + security_block_offset + certificate_offset,\r\n1 + 2 + certificate_length,\r\nENC_NA);\r\ngenericcertificate_tree = proto_item_add_subtree(ti_genericcertificate, ett_reload_genericcertificate);\r\nproto_tree_add_item(genericcertificate_tree, hf_reload_certificate_type, tvb,\r\noffset + security_block_offset + certificate_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(genericcertificate_tree, hf_reload_length_uint16, tvb,\r\noffset + security_block_offset + certificate_offset+1, 2, ENC_BIG_ENDIAN);\r\nswitch (tvb_get_guint8(tvb, offset + security_block_offset + certificate_offset)) {\r\ncase 0: {\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\ndissect_x509af_Certificate(FALSE, tvb, offset + security_block_offset + certificate_offset + 1 + 2, &asn1_ctx,\r\ngenericcertificate_tree, hf_reload_certificate);\r\n}\r\nbreak;\r\ndefault:\r\ndissect_opaque(tvb, pinfo, genericcertificate_tree, hf_reload_certificate, offset + security_block_offset + certificate_offset + 1, 2, -1);\r\n}\r\ncertificate_offset += 1 + 2 + certificate_length;\r\nnCertificates++;\r\n}\r\nproto_item_append_text(ti_certificates, ": %d elements", nCertificates);\r\n}\r\nsecurity_block_offset += certificates_length;\r\ndissect_signature(tvb, pinfo, security_block_tree, offset + security_block_offset);\r\n}\r\nreturn dgram_msg_length;\r\n}\r\nstatic gboolean\r\ndissect_reload_heur(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data _U_)\r\n{\r\nif (dissect_reload_message(tvb, pinfo, tree, data) == 0) {\r\nreturn FALSE;\r\n}\r\nreturn TRUE;\r\n}\r\nvoid\r\nproto_register_reload(void)\r\n{\r\nmodule_t *reload_module;\r\nexpert_module_t* expert_reload;\r\nstatic hf_register_info hf[] = {\r\n{ &hf_reload_response_in,\r\n{ "Response in", "reload.response-in", FT_FRAMENUM,\r\nBASE_NONE, NULL, 0x0, "The response to this RELOAD Request is in this frame", HFILL\r\n}\r\n},\r\n{ &hf_reload_response_to,\r\n{ "Request in", "reload.response-to", FT_FRAMENUM,\r\nBASE_NONE, NULL, 0x0, "This is a response to the RELOAD Request in this frame", HFILL\r\n}\r\n},\r\n{ &hf_reload_time,\r\n{ "Time", "reload.time", FT_RELATIVE_TIME,\r\nBASE_NONE, NULL, 0x0, "The time between the Request and the Response", HFILL\r\n}\r\n},\r\n{ &hf_reload_duplicate,\r\n{ "Duplicated original message in", "reload.duplicate", FT_FRAMENUM,\r\nBASE_NONE, NULL, 0x0, "This is a duplicate of RELOAD message in this frame", HFILL\r\n}\r\n},\r\n{ &hf_reload_forwarding,\r\n{ "ForwardingHeader", "reload.forwarding", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_token,\r\n{ "relo_token (uint32)", "reload.forwarding.token", FT_UINT32,\r\nBASE_HEX, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_overlay,\r\n{ "overlay (uint32)", "reload.forwarding.overlay", FT_UINT32,\r\nBASE_HEX, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_configuration_sequence,\r\n{ "configuration_sequence (uint16)", "reload.forwarding.configuration_sequence", FT_UINT16,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_version,\r\n{ "version (uint8)", "reload.forwarding.version", FT_UINT8,\r\nBASE_HEX, VALS(versions), 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_ttl,\r\n{ "ttl (uint8)", "reload.forwarding.ttl", FT_UINT8,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_fragment_flag,\r\n{ "fragment (uint32)", "reload.forwarding.fragment", FT_UINT32,\r\nBASE_HEX, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_fragment_fragmented,\r\n{ "Fragmented (always set)", "reload.forwarding.fragment.fragmented", FT_BOOLEAN, BASE_NONE, TFS(&tfs_set_notset), 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_fragment_last_fragment,\r\n{ "Last Fragment", "reload.forwarding.fragment.last", FT_BOOLEAN, BASE_NONE, TFS(&tfs_set_notset), 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_fragment_reserved,\r\n{ "Reserved (always 0)", "reload.forwarding.fragment.reserved", FT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_fragment_offset,\r\n{ "Fragment Offset","reload.forwarding.fragment.offset", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_trans_id,\r\n{ "transaction_id (uint32)", "reload.forwarding.trans_id", FT_UINT64,\r\nBASE_HEX, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_max_response_length,\r\n{ "max_response_length (uint32)", "reload.forwarding.max_response_length", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_via_list_length,\r\n{ "via_list_length (uint16)", "reload.forwarding.via_list.length", FT_UINT16,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_destination_list_length,\r\n{ "destination_list_length (uint16)", "reload.forwarding.destination_list.length", FT_UINT16,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_options_length,\r\n{ "options_length (uint16)", "reload.forwarding.options.length", FT_UINT16,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_via_list,\r\n{ "via_list", "reload.forwarding.via_list", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_destination,\r\n{ "Destination", "reload.destination", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_destination_compressed_id,\r\n{ "compressed_id (uint16)", "reload.forwarding.destination.compressed_id", FT_UINT16,\r\nBASE_HEX, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_destination_type,\r\n{ "type (DestinationType)", "reload.forwarding.destination.type", FT_UINT8,\r\nBASE_HEX, VALS(destinationtypes), 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_destination_data_node_id,\r\n{ "node_id (NodeId)", "reload.destination.data.nodeid", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_destination_data_resource_id,\r\n{ "resource_id", "reload.destination.data.resourceid", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_nodeid,\r\n{ "NodeId", "reload.nodeid", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_resourceid,\r\n{ "ResourceId", "reload.resource_id", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_destination_data_compressed_id,\r\n{ "compressed_id", "reload.destination.data.compressed_id", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_destination_list,\r\n{ "destination_list", "reload.forwarding.destination_list", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_forwarding_options,\r\n{ "options", "reload.forwarding.options", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_forwarding_option,\r\n{ "ForwardingOption", "reload.forwarding.option", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_forwarding_option_type,\r\n{ "type (ForwardingOptionType)", "reload.forwarding.option.type", FT_UINT8,\r\nBASE_DEC, VALS(forwardingoptiontypes), 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_forwarding_option_flags,\r\n{ "flags (uint8)", "reload.forwarding.option.flags", FT_UINT8,\r\nBASE_HEX, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_forwarding_option_flag_ignore_state_keeping,\r\n{ "IGNORE_STATE_KEEPING", "reload.forwarding.option.flag.ignore_state_keeping", FT_BOOLEAN, BASE_NONE, TFS(&tfs_set_notset), 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_forwarding_option_flag_response_copy,\r\n{ "RESPONSE_COPY", "reload.forwarding.option.flag.response_copy", FT_BOOLEAN, BASE_NONE, TFS(&tfs_set_notset), 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_forwarding_option_flag_destination_critical,\r\n{ "DESTINATION_CRITICAL", "reload.forwarding.option.flags.destination_critical", FT_BOOLEAN, BASE_NONE, TFS(&tfs_set_notset), 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_forwarding_option_flag_forward_critical,\r\n{ "FORWARD_CRITICAL", "reload.forwarding.option.flags.forward_critical", FT_BOOLEAN, BASE_NONE, TFS(&tfs_set_notset), 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_attachreqans,\r\n{ "AttachReqAns", "reload.attachreqans", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_ufrag,\r\n{ "ufrag", "reload.ufrag", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_password,\r\n{ "password", "reload.password", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_role,\r\n{ "role", "reload.role", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_icecandidates,\r\n{ "candidates", "reload.icecandidates", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_icecandidate,\r\n{ "IceCandidate", "reload.icecandidate", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_icecandidate_addr_port,\r\n{ "addr_port", "reload.icecandidate.addr_port", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_icecandidate_relay_addr,\r\n{ "rel_addr_port", "reload.icecandidate.relay_addr", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_ipaddressport,\r\n{ "IpAddressPort", "reload.ipaddressport", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_ipaddressport_type,\r\n{ "type (AddressType)", "reload.ipaddressport.type", FT_UINT8,\r\nBASE_HEX, VALS(ipaddressporttypes), 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_ipv4addrport,\r\n{ "IPv4AddrPort", "reload.ipv4addrport", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_ipv4addr,\r\n{ "addr (uint32)", "reload.ipv4addr", FT_IPv4,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_ipv6addrport,\r\n{ "IPv6AddrPort", "reload.ipv6addrport", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_ipv6addr,\r\n{ "addr (uint128)", "reload.ipv6addr", FT_IPv6,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_port,\r\n{ "port (uint16)", "reload.port", FT_UINT16,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_overlaylink_type,\r\n{ "overlay_link (OverlayLinkType)", "reload.overlaylink.type", FT_UINT8,\r\nBASE_DEC, VALS(overlaylinktypes), 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_icecandidate_foundation,\r\n{ "foundation", "reload.icecandidate.foundation", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_icecandidate_priority,\r\n{ "priority (uint32)", "reload.icecandidate.priority", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_icecandidate_type,\r\n{ "Ice candidate type", "reload.icecandidate.type", FT_UINT8,\r\nBASE_DEC, VALS(candtypes), 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_iceextensions,\r\n{ "extensions", "reload.iceextensions", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_iceextension,\r\n{ "IceExtension", "reload.iceextension", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_iceextension_name,\r\n{ "name", "reload.iceextension.name", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_iceextension_value,\r\n{ "value", "reload.iceextension.value", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_sendupdate,\r\n{ "send_update (Boolean)", "reload.sendupdate", FT_BOOLEAN,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_message_contents,\r\n{ "MessageContents", "reload.message.contents", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_message_code,\r\n{ "message_code (uint16)", "reload.message.code", FT_UINT16,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_message_body,\r\n{ "message_body", "reload.message.body", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_message_extensions,\r\n{ "extensions", "reload.message.extensions", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_message_extension,\r\n{ "MessageExtension", "reload.message_extension", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_message_extension_type,\r\n{ "type (MessageExtensionType)", "reload.message_extension.type", FT_UINT16,\r\nBASE_DEC, VALS(messageextensiontypes), 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_message_extension_critical,\r\n{ "critical (Boolean)", "reload.message_extension.critical", FT_BOOLEAN,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_message_extension_content,\r\n{ "extension_content", "reload.message_extension.content", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_error_response,\r\n{ "ErrorResponse", "reload.error_response", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_error_response_code,\r\n{ "error_code (uint16)", "reload.error_response.code", FT_UINT16,\r\nBASE_DEC, VALS(errorcodes), 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_error_response_info,\r\n{ "error_info", "reload.error_response_info", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_security_block,\r\n{ "SecurityBlock", "reload.security_block", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_certificates,\r\n{ "certificates", "reload.certificates", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_certificate_type,\r\n{ "type (CertificateType)", "reload.certificate.type", FT_UINT8,\r\nBASE_DEC, VALS(tls_certificate_type), 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_genericcertificate,\r\n{ "GenericCertificate", "reload.genericcertificate", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_certificate,\r\n{ "certificate", "reload.certificate", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_signature,\r\n{ "signature (Signature)", "reload.signature", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_signatureandhashalgorithm,\r\n{ "algorithm (SignatureAndHashAlgorithm)", "reload.signatureandhashalgorithm", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_hash_algorithm,\r\n{ "hash (HashAlgorithm)", "reload.hash_algorithm", FT_UINT8,\r\nBASE_DEC, VALS(tls_hash_algorithm), 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_signeridentity_value_hash_alg,\r\n{ "hash_alg (HashAlgorithm)", "reload.signeridentityvalue.hash_alg", FT_UINT8,\r\nBASE_DEC, VALS(tls_hash_algorithm), 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_signature_algorithm,\r\n{ "signature (SignatureAlgorithm)", "reload.signature_algorithm", FT_UINT8,\r\nBASE_DEC, VALS(tls_signature_algorithm), 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_signeridentity,\r\n{ "identity (SignerIdentity)", "reload.signature.identity", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_signeridentity_identity,\r\n{ "identity", "reload.signature.identity.identity", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_signeridentity_type,\r\n{ "identity_type (SignerIdentityType)", "reload.signature.identity.type", FT_UINT8,\r\nBASE_DEC, VALS(signeridentitytypes), 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_signeridentity_value,\r\n{ "SignatureIdentityValue", "reload.signature.identity.value", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_signeridentity_value_certificate_hash,\r\n{ "certificate_hash", "reload.signature.identity.value.certificate_hash", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_signeridentity_value_certificate_node_id_hash,\r\n{ "certificate_node_id_hash", "reload.signature.identity.value.certificate_node_id_hash", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_signature_value,\r\n{ "signature_value", "reload.signature.value.", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_length_uint8,\r\n{ "length (uint8)", "reload.length.8", FT_UINT8,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_length_uint16,\r\n{ "length (uint16)", "reload.length.16", FT_UINT16,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_length_uint24,\r\n{ "length (uint24)", "reload.length.24", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_length_uint32,\r\n{ "length (uint32)", "reload.length.32", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_opaque,\r\n{ "opaque", "reload.opaque", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_opaque_data,\r\n{ "data (bytes)", "reload.opaque.data", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_opaque_string,\r\n{ "data (string)", "reload.opaque.string", FT_STRING,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_routequeryreq,\r\n{ "RouteQueryReq", "reload.routequeryreq", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_routequeryreq_destination,\r\n{ "destination", "reload.routequeryreq.destination", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_overlay_specific,\r\n{ "overlay_specific_data", "reload.overlay_specific_data", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_probereq,\r\n{ "ProbeReq", "reload.probereq", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_probereq_requested_info,\r\n{ "requested_info", "reload.probereq.requested_info", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_probe_information,\r\n{ "ProbeInformation", "reload.probe_information", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_probe_information_data,\r\n{ "value (ProbeInformationData)", "reload.probe_information_data", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_probe_information_type,\r\n{ "type (ProbeInformationType)", "reload.probe_information.type", FT_UINT8,\r\nBASE_HEX, VALS(probeinformationtypes), 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_responsible_set,\r\n{ "responsible_ppb (uint32)", "reload.responsible_set", FT_UINT32,\r\nBASE_HEX, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_num_resources,\r\n{ "num_resources (uint32)", "reload.num_resources", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_uptime,\r\n{ "uptime (uint32)", "reload.uptime", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_probeans,\r\n{ "ProbeAns", "reload.probeans", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_probeans_probe_info,\r\n{ "probe_info", "reload.probe_info", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_appattachreq,\r\n{ "AppAttachReq", "reload.appattachreq", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_appattachans,\r\n{ "AppAttachAns", "reload.appattachans", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_application,\r\n{ "application (uint16)", "reload.application", FT_UINT16,\r\nBASE_DEC, VALS(applicationids), 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_ping_response_id,\r\n{ "response_id (uint64)", "reload.ping.response_id", FT_UINT64,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_ping_time,\r\n{ "time (uint64)", "reload.ping.time", FT_ABSOLUTE_TIME,\r\nABSOLUTE_TIME_UTC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_storeddata,\r\n{ "StoredData", "reload.storeddata", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_storedmetadata,\r\n{ "StoredMetaData", "reload.storedmetadata", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_storeddata_storage_time,\r\n{ "storage_time (uint64)", "reload.storeddata.storage_time", FT_ABSOLUTE_TIME,\r\nABSOLUTE_TIME_UTC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_storeddata_lifetime,\r\n{ "lifetime (uint32)", "reload.storeddata.lifetime", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_datavalue,\r\n{ "DataValue", "reload.datavalue", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_value,\r\n{ "value", "reload.value", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_metadata,\r\n{ "MetaData", "reload.metadata", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_datavalue_exists,\r\n{ "exists (Boolean)", "reload.datavalue.exists", FT_BOOLEAN,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_datavalue_value,\r\n{ "value", "reload.datavaluevalue", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_metadata_value_length,\r\n{ "value_length (uint32)", "reload.metadata.value_length", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ & hf_reload_metadata_hash_value,\r\n{ "hash_value", "reload.metadata.hash_value", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_arrayentry,\r\n{ "ArrayEntry", "reload.arrayentry", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_arrayentry_index,\r\n{ "index (uint32)", "reload.arrayentry.index", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_arrayentry_value,\r\n{ "value", "reload.arrayentry.value", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_dictionaryentry,\r\n{ "DictionaryEntry", "reload.dictionaryentry", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_dictionarykey,\r\n{ "key (DictionaryKey)", "reload.dictionarykey", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_dictionary_value,\r\n{ "value (DataValue)", "reload.dictionary.value", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_kinddata,\r\n{ "StoreKindData", "reload.kinddata", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_kinddata_kind,\r\n{ "kind (KindId)", "reload.kinddata.kind", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_statkindresponse,\r\n{ "StatKindResponse", "reload.statkindresponse", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_kindid,\r\n{ "KindId", "reload.kindid", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_kindid_list,\r\n{ "kinds", "reload.kindid_list", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_generation_counter,\r\n{ "generation_counter (uint64)", "reload.generation_counter", FT_UINT64,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_values,\r\n{ "values", "reload.kinddata.values_length", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_storereq,\r\n{ "StoreReq", "reload.storereq", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_resource,\r\n{ "resource", "reload.resource", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_store_replica_num,\r\n{ "replica_number (uint8)", "reload.store.replica_number", FT_UINT8,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_store_kind_data,\r\n{ "kind_data", "reload.store.kind_data", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_storeans,\r\n{ "StoreAns", "reload.storeans", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_storeans_kind_responses,\r\n{ "kind_responses", "reload.storeans.kind_responses", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_storekindresponse,\r\n{ "StoreKindResponse", "reload.storekindresponse", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_replicas,\r\n{ "replicas", "reload.storekindresponse.replicas", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_statreq,\r\n{ "StatReq", "reload.statreq", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_fetchans,\r\n{ "FetchAns", "reload.fetchans", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_fetchreq,\r\n{ "FetchReq", "reload.fetchreq", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_fetchreq_specifiers,\r\n{ "specifiers", "reload.fetchreq.specifiers", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_arrayrange,\r\n{ "ArrayRange", "reload.arrayrange", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_storeddataspecifier,\r\n{ "StoredDataSpecifier", "reload.storeddataspecifier", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_storeddataspecifier_indices,\r\n{ "indices", "reload.storeddataspecifier.indices", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_storeddataspecifier_keys,\r\n{ "indices", "reload.storeddataspecifier.keys", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_statans,\r\n{ "StatAns", "reload.statans", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_findans,\r\n{ "FindAns", "reload.findans", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_findkinddata_closest,\r\n{ "closest", "reload.findkindata.closest", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_findkinddata,\r\n{ "FindKindData", "reload.findkinddata", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_fragment_overlap,\r\n{ "Fragment overlap", "reload.fragment.overlap", FT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\n"Fragment overlaps with other fragments", HFILL\r\n}\r\n},\r\n{ &hf_reload_fragment_overlap_conflict,\r\n{ "Conflicting data in fragment overlap", "reload.fragment.overlap.conflict", FT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\n"Overlapping fragments contained conflicting data", HFILL\r\n}\r\n},\r\n{ &hf_reload_fragment_multiple_tails,\r\n{ "Multiple tail fragments found", "reload.fragment.multipletails", FT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\n"Several tails were found when defragmenting the packet", HFILL\r\n}\r\n},\r\n{ &hf_reload_fragment_too_long_fragment,\r\n{ "Fragment too long", "reload.fragment.toolongfragment", FT_BOOLEAN, BASE_NONE, NULL, 0x0,\r\n"Fragment contained data past end of packet", HFILL\r\n}\r\n},\r\n{ &hf_reload_fragment_error,\r\n{ "Defragmentation error", "reload.fragment.error", FT_FRAMENUM, BASE_NONE, NULL, 0x0,\r\n"Defragmentation error due to illegal fragments", HFILL\r\n}\r\n},\r\n{ &hf_reload_fragment_count,\r\n{ "Fragment count", "reload.fragment.count", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_fragment,\r\n{ "RELOAD fragment", "reload.fragment", FT_FRAMENUM, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_fragments,\r\n{ "RELOAD fragments", "reload.fragments", FT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_reassembled_in,\r\n{ "Reassembled RELOAD in frame", "reload.reassembled_in", FT_FRAMENUM, BASE_NONE, NULL, 0x0,\r\n"This RELOAD packet is reassembled in this frame", HFILL\r\n}\r\n},\r\n{ &hf_reload_reassembled_length,\r\n{ "Reassembled RELOAD length", "reload.reassembled.length", FT_UINT32, BASE_DEC, NULL, 0x0,\r\n"The total length of the reassembled payload", HFILL\r\n}\r\n},\r\n{ &hf_reload_configupdatereq,\r\n{ "ConfigUpdateReq", "reload.configupdatereq.", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_configupdatereq_type,\r\n{ "type (ConfigUpdateType)", "reload.configupdatereq.type", FT_UINT8,\r\nBASE_DEC, VALS(configupdatetypes), 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_configupdatereq_configdata,\r\n{ "config_data", "reload.configupdatereq.config_data", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_configupdatereq_kinds,\r\n{ "kinds", "reload.configupdatereq.kinds", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_kinddescription,\r\n{ "KindDescription", "reload.configupdatereq.kinddescription", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_pingreq,\r\n{ "PingReq", "reload.pingreq", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_pingans,\r\n{ "PingAns", "reload.pingans", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_padding,\r\n{ "padding", "reload.padding", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_chordupdate,\r\n{ "ChordUpdate", "reload.chordupdate", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_chordupdate_type,\r\n{ "type (ChordUpdateType)", "reload.chordupdate.type", FT_UINT8,\r\nBASE_DEC, VALS(chordupdatetypes), 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_chordupdate_predecessors,\r\n{ "predecessors", "reload.chordupdate.predecessors", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_chordupdate_successors,\r\n{ "successors", "reload.chordupdate.successors", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_chordupdate_fingers,\r\n{ "fingers", "reload.chordupdate.fingers", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_chordroutequeryans,\r\n{ "ChordRouteQueryAns", "reload.chordroutequeryans", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_chordroutequeryans_next_peer,\r\n{ "next_peer (NodeId)", "reload.chordroutequeryans.nodeid", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_chordleave,\r\n{ "ChordLeaveData", "reload.chordleavedata", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_chordleave_type,\r\n{ "type (ChordLeaveType)", "reload.chordleavedata.type", FT_UINT8,\r\nBASE_DEC, VALS(chordleavetypes), 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_chordleave_predecessors,\r\n{ "predecessors", "reload.chordleavedata.predecessors", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_chordleave_successors,\r\n{ "successors", "reload.chordleavedata.successors", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_turnserver,\r\n{ "TurnServer", "reload.turnserver", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_turnserver_iteration,\r\n{ "iteration (uint8)", "reload.turnserver.iteration", FT_UINT8,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_turnserver_server_address,\r\n{ "server_address", "reload.turnserver.server_address", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_sipregistration,\r\n{ "SipRegistration", "reload.sipregistration", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_sipregistration_type,\r\n{ "type (SipRegistrationType)", "reload.sipregistration.type", FT_UINT8,\r\nBASE_DEC, VALS(sipregistrationtypes), 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_sipregistration_data,\r\n{ "data (SipRegistrationData)", "reload.sipregistration.data", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_sipregistration_data_uri,\r\n{ "uri", "reload.sipregistration.data.uri", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_sipregistration_data_contact_prefs,\r\n{ "contact_prefs", "reload.sipregistration.data.contact_prefs", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_sipregistration_data_destination_list,\r\n{ "destination_list", "reload.sipregistration.data.destination_list", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_redirserviceprovider,\r\n{ "RedirServiceProvider", "reload.redirserviceprovider", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_redirserviceproviderdata,\r\n{ "data (RedirServiceProviderData)", "reload.redirserviceprovider.data", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_redirserviceproviderdata_serviceprovider,\r\n{ "serviceProvider (NodeId)", "reload.redirserviceprovider.data.serviceprovider", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_redirserviceproviderdata_namespace,\r\n{ "namespace", "reload.redirserviceprovider.data.namespace", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_redirserviceproviderdata_level,\r\n{ "level (uint16)", "reload.redirserviceprovider.data.level", FT_UINT16,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_redirserviceproviderdata_node,\r\n{ "node (uint16)", "reload.redirserviceprovider.data.node", FT_UINT16,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_self_tuning_data,\r\n{ "SelfTuningData", "reload.selftuning_data", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_self_tuning_data_network_size,\r\n{ "network_size (uint32)", "reload.selftuning_data.network_size", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_self_tuning_data_join_rate,\r\n{ "join_rate (uint32)", "reload.selftuning_data.join_rate", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_self_tuning_data_leave_rate,\r\n{ "leave_rate (uint32)", "reload.selftuning_data.leave_rate", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_findreq,\r\n{ "FindReq", "reload.findreq", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_dmflags,\r\n{ "dMFlags (uint64)", "reload.dmflags", FT_UINT64,\r\nBASE_HEX, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_dmflag_status_info,\r\n{ "STATUS_INFO", "reload.dmflags.status_info", FT_BOOLEAN, BASE_NONE, TFS(&tfs_set_notset), 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_dmflag_routing_table_size,\r\n{ "ROUTING_TABLE_SIZE", "reload.dmflags.routing_table_size", FT_BOOLEAN, BASE_NONE, TFS(&tfs_set_notset), 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_dmflag_process_power,\r\n{ "PROCESS_POWER", "reload.dmflags.process_power", FT_BOOLEAN, BASE_NONE, TFS(&tfs_set_notset), 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_dmflag_bandwidth,\r\n{ "BANDWIDTH", "reload.dmflags.bandwidth", FT_BOOLEAN, BASE_NONE, TFS(&tfs_set_notset), 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_dmflag_software_version,\r\n{ "SOFTWARE_VERSION", "reload.dmflags.software_version", FT_BOOLEAN, BASE_NONE, TFS(&tfs_set_notset), 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_dmflag_machine_uptime,\r\n{ "MACHINE_UPTIME", "reload.dmflags.machine_uptime", FT_BOOLEAN, BASE_NONE, TFS(&tfs_set_notset), 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_dmflag_app_uptime,\r\n{ "APP_UPTIME", "reload.dmflags.app_uptime", FT_BOOLEAN, BASE_NONE, TFS(&tfs_set_notset), 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_dmflag_memory_footprint,\r\n{ "MEMORY_FOOTPRINT", "reload.dmflags.memory_footprint", FT_BOOLEAN, BASE_NONE, TFS(&tfs_set_notset), 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_dmflag_datasize_stored,\r\n{ "DATASIZE_STORED", "reload.dmflags.datasize_stored", FT_BOOLEAN, BASE_NONE, TFS(&tfs_set_notset), 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_dmflag_instances_stored,\r\n{ "INSTANCES_STORED", "reload.dmflags.instances_stored", FT_BOOLEAN, BASE_NONE, TFS(&tfs_set_notset), 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_dmflag_messages_sent_rcvd,\r\n{ "MESSAGES_SENT_RCVD", "reload.dmflags.messages_sent_rcvd", FT_BOOLEAN, BASE_NONE, TFS(&tfs_set_notset), 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_dmflag_ewma_bytes_sent,\r\n{ "EWMA_BYTES_SENT", "reload.dmflags.ewma_bytes_sent", FT_BOOLEAN, BASE_NONE, TFS(&tfs_set_notset), 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_dmflag_ewma_bytes_rcvd,\r\n{ "EWMA_BYTES_RCVD", "reload.dmflags.ewma_bytes_rcvd", FT_BOOLEAN, BASE_NONE, TFS(&tfs_set_notset), 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_dmflag_underlay_hop,\r\n{ "UNDERLAY_HOP", "reload.dmflags.underlay_hop", FT_BOOLEAN, BASE_NONE, TFS(&tfs_set_notset), 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_dmflag_battery_status,\r\n{ "BATTERY_STATUS", "reload.dmflags.battery_status", FT_BOOLEAN, BASE_NONE, TFS(&tfs_set_notset), 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticrequest,\r\n{ "DiagnosticRequest", "reload.diagnosticrequest", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticresponse,\r\n{ "DiagnosticResponse", "reload.diagnosticresponse", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticextension,\r\n{ "DiagnosticExtension", "reload.diagnosticextension", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticextension_type,\r\n{ "type (DiagnosticExtensionRequestType)", "reload.diagnosticextension.type", FT_UINT16,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticextension_contents,\r\n{ "diagnostic_extension_contents", "reload.diagnosticextension.contents", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnostic_expiration, {\r\n"expiration (uint64)", "reload.diagnostic.expiration", FT_ABSOLUTE_TIME, ABSOLUTE_TIME_LOCAL,\r\nNULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticrequest_timestampinitiated, {\r\n"timestampInitiated (uint64)", "reload.diagnosticrequest.timestampinitiated",FT_ABSOLUTE_TIME, ABSOLUTE_TIME_LOCAL,\r\nNULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticrequest_extensions,\r\n{ "diagnostic_extensions", "reload.diagnosticrequest.extensions", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_pathtrackreq,\r\n{ "PathTrackReq", "reload.pathtrackreq", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_pathtrackreq_destination,\r\n{ "destination (Destination)", "reload.pathtrackreq.destination", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_pathtrackreq_request,\r\n{ "request (DiagnosticRequest)", "reload.pathtrackreq.request", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticinfo,\r\n{ "DiagnosticInfo", "reload.diagnostic.info", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticinfo_kind,\r\n{ "kind (DiagnosticKindId)", "reload.diagnostic.kindid", FT_UINT16,\r\nBASE_DEC, VALS(diagnostickindids), 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticinfo_congestion_status,\r\n{ "congestion_status (uint8)", "reload.diagnostic.info.congestion_status", FT_UINT8,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticinfo_number_peers,\r\n{ "number_peers (uint32)", "reload.diagnostic.info.number_peers", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticinfo_processing_power,\r\n{ "processing_power (uint32)", "reload.diagnostic.info.processing_power", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticinfo_bandwidth,\r\n{ "bandwidth (uint32)", "reload.diagnostic.info.bandwidth", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticinfo_software_version,\r\n{ "software_version (opaque string)", "reload.diagnostic.info.software_version", FT_STRING,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticinfo_machine_uptime,\r\n{ "machine_uptime (uint64)", "reload.diagnostic.info.machine_uptime", FT_UINT64,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticinfo_app_uptime,\r\n{ "app_uptime (uint64)", "reload.diagnostic.info.app_uptime", FT_UINT64,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticinfo_memory_footprint,\r\n{ "memory_footprint(uint32)", "reload.diagnostic.info.memory_footprint", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticinfo_datasize_stored,\r\n{ "datasize_stored (uint64)", "reload.diagnostic.info.datasize_stored", FT_UINT64,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticinfo_instances_stored,\r\n{ "instances_stored", "reload.diagnostic.info.instances_stored", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticinfo_instancesstored_info,\r\n{ "InstancesStoredInfo)", "reload.diagnostic.info.instancesstored_info", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticinfo_instancesstored_instances,\r\n{ "instances (uint64)", "reload.diagnostic.info.instancesstored_instances", FT_UINT64,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticinfo_messages_sent_rcvd,\r\n{ "messages_sent_rcvd", "reload.diagnostic.info.messages_sent_rcvd", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticinfo_messages_sent_rcvd_info,\r\n{ "MessagesSentRcvdInfo", "reload.diagnostic.info.messages_sent_rcvd.info", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticinfo_message_code,\r\n{ "messages_code (uint16)", "reload.diagnostic.info.message_code", FT_UINT16,\r\nBASE_HEX, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticinfo_messages_sent,\r\n{ "sent (uint64)", "reload.diagnostic.info.messages_sent", FT_UINT64,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticinfo_messages_rcvd,\r\n{ "rcvd (uint64)", "reload.diagnostic.info.messages_rcvd", FT_UINT64,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticinfo_ewma_bytes_sent,\r\n{ "ewma_bytes_sent (uint32)", "reload.diagnostic.info.ewma_bytes_sent", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticinfo_ewma_bytes_rcvd,\r\n{ "ewma_bytes_rcvd (uint32)", "reload.diagnostic.info.ewma_bytes_rcvd", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticinfo_underlay_hops,\r\n{ "underlay_hops (uint8)", "reload.diagnostic.info.underlay_hops", FT_UINT8,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticinfo_battery_status,\r\n{ "battery_status (uint8)", "reload.diagnostic.info.battery_status", FT_UINT8,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticresponse_timestampreceived, {\r\n"timestampReceived (uint64)", "reload.diagnosticresponse.timestampreceived",FT_ABSOLUTE_TIME, ABSOLUTE_TIME_LOCAL,\r\nNULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticresponse_hopcounter,\r\n{ "hopCounter (uint8)", "reload.diagnosticresponse.hopcounter", FT_UINT8,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_diagnosticresponse_diagnostic_info_list,\r\n{ "diagnostic_info_list", "reload.diagnosticresponse.diagnostic_info_list", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_pathtrackans,\r\n{ "PathTrackAns", "reload.pathtrackans", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_pathtrackans_next_hop,\r\n{ "next_hop", "reload.pathtrackans.next_hop", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_pathtrackans_response,\r\n{ "response (DiagnosticResponse)", "reload.pathtrackand.response", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_extensiveroutingmodeoption,\r\n{ "ExtensiveRoutingModeOption", "reload.extensiveroutingmodeoption", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_routemode,\r\n{ "routemode (RouteMode)", "reload.routemode", FT_UINT8,\r\nBASE_DEC, VALS(routemodes), 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_extensiveroutingmode_transport,\r\n{ "transport (OverlayLinkType)", "reload.extensiveroutingmode.transport", FT_UINT8,\r\nBASE_DEC, VALS(overlaylinktypes), 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_extensiveroutingmode_ipaddressport,\r\n{ "ipaddressport (IpAddressPort)", "reload.extensiveroutingmode.ipaddressport", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_extensiveroutingmode_destination,\r\n{ "destination", "reload.extensiveroutingmode.destination", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_joinreq,\r\n{ "JoinReq", "reload.joinreq", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_joinans,\r\n{ "JoinAns", "reload.joinans", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_joinreq_joining_peer_id,\r\n{ "joining_peer_id (NodeId)", "reload.joinreq.joining_peer_id", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_leavereq,\r\n{ "LeaveReq", "reload.leavereq", FT_NONE,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{ &hf_reload_leavereq_leaving_peer_id,\r\n{ "leaving_peer_id (NodeId)", "reload.leavereq.leaving_peer_id", FT_BYTES,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_reload,\r\n&ett_reload_forwarding,\r\n&ett_reload_message,\r\n&ett_reload_security,\r\n&ett_reload_fragment_flag,\r\n&ett_reload_destination,\r\n&ett_reload_via_list,\r\n&ett_reload_destination_list,\r\n&ett_reload_resourceid,\r\n&ett_reload_forwarding_options,\r\n&ett_reload_forwarding_option,\r\n&ett_reload_forwarding_option_flags,\r\n&ett_reload_forwarding_option_directresponseforwarding,\r\n&ett_reload_attachreqans,\r\n&ett_reload_icecandidates,\r\n&ett_reload_icecandidate,\r\n&ett_reload_icecandidate_computed_address,\r\n&ett_reload_iceextensions,\r\n&ett_reload_iceextension,\r\n&ett_reload_ipaddressport,\r\n&ett_reload_ipv4addrport,\r\n&ett_reload_ipv6addrport,\r\n&ett_reload_message_contents,\r\n&ett_reload_message_extensions,\r\n&ett_reload_message_extension,\r\n&ett_reload_error_response,\r\n&ett_reload_security_block,\r\n&ett_reload_certificates,\r\n&ett_reload_genericcertificate,\r\n&ett_reload_signature,\r\n&ett_reload_signatureandhashalgorithm,\r\n&ett_reload_signeridentity,\r\n&ett_reload_signeridentity_identity,\r\n&ett_reload_signeridentity_value,\r\n&ett_reload_opaque,\r\n&ett_reload_message_body,\r\n&ett_reload_routequeryreq,\r\n&ett_reload_probereq,\r\n&ett_reload_probereq_requested_info,\r\n&ett_reload_probe_information,\r\n&ett_reload_probe_information_data,\r\n&ett_reload_probeans,\r\n&ett_reload_probeans_probe_info,\r\n&ett_reload_appattach,\r\n&ett_reload_pingreq,\r\n&ett_reload_pingans,\r\n&ett_reload_storeddata,\r\n&ett_reload_kinddata,\r\n&ett_reload_values,\r\n&ett_reload_datavalue,\r\n&ett_reload_arrayentry,\r\n&ett_reload_dictionaryentry,\r\n&ett_reload_storereq,\r\n&ett_reload_store_kind_data,\r\n&ett_reload_storeans,\r\n&ett_reload_storeans_kind_responses,\r\n&ett_reload_storekindresponse,\r\n&ett_reload_fetchans,\r\n&ett_reload_fetchreq,\r\n&ett_reload_fetchreq_specifiers,\r\n&ett_reload_storeddataspecifier,\r\n&ett_reload_storeddataspecifier_indices,\r\n&ett_reload_storeddataspecifier_keys,\r\n&ett_reload_statans,\r\n&ett_reload_findans,\r\n&ett_reload_findkinddata,\r\n&ett_reload_fragments,\r\n&ett_reload_fragment,\r\n&ett_reload_configupdatereq,\r\n&ett_reload_configupdatereq_config_data,\r\n&ett_reload_kinddescription,\r\n&ett_reload_configupdatereq_kinds,\r\n&ett_reload_storekindresponse_replicas,\r\n&ett_reload_nodeid_list,\r\n&ett_reload_chordupdate,\r\n&ett_reload_chordroutequeryans,\r\n&ett_reload_chordleave,\r\n&ett_reload_turnserver,\r\n&ett_reload_sipregistration,\r\n&ett_reload_sipregistration_data,\r\n&ett_reload_sipregistration_destination_list,\r\n&ett_reload_dictionaryentry_key,\r\n&ett_reload_overlay_specific,\r\n&ett_reload_kindid_list,\r\n&ett_reload_redirserviceproviderdata,\r\n&ett_reload_redirserviceprovider,\r\n&ett_reload_self_tuning_data,\r\n&ett_reload_findreq,\r\n&ett_reload_dmflags,\r\n&ett_reload_diagnosticextension,\r\n&ett_reload_diagnosticrequest,\r\n&ett_reload_diagnosticrequest_extensions,\r\n&ett_reload_pathtrackreq,\r\n&ett_reload_diagnosticinfo,\r\n&ett_reload_diagnosticinfo_instances_stored,\r\n&ett_reload_diagnosticinfo_instancesstored_info,\r\n&ett_reload_diagnosticinfo_messages_sent_rcvd,\r\n&ett_reload_diagnosticinfo_messages_sent_rcvd_info,\r\n&ett_reload_diagnosticresponse,\r\n&ett_reload_diagnosticresponse_diagnostic_info_list,\r\n&ett_reload_pathtrackans,\r\n&ett_reload_extensiveroutingmodeoption,\r\n&ett_reload_extensiveroutingmode_destination,\r\n&ett_reload_joinreq,\r\n&ett_reload_joinans,\r\n&ett_reload_leavereq,\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_reload_truncated_field, { "reload.truncated_field", PI_PROTOCOL, PI_ERROR, "Truncated field", EXPFILL }},\r\n{ &ei_reload_truncated_packet, { "reload.truncated_packet", PI_PROTOCOL, PI_ERROR, "Truncated RELOAD packet", EXPFILL }},\r\n{ &ei_reload_computed_len_too_big, { "reload.computed_len_too_big", PI_PROTOCOL, PI_ERROR, "Computed length > max_field length", EXPFILL }},\r\n{ &ei_reload_identity_type_unknown, { "reload.signature.identity.type.unknown", PI_PROTOCOL, PI_ERROR, "Unknown identity type", EXPFILL }},\r\n{ &ei_reload_unknown_data_model, { "reload.unknown_data_model", PI_PROTOCOL, PI_ERROR, "Unknown Data Model", EXPFILL }},\r\n{ &ei_reload_no_xml_dissector, { "reload.no_xml_dissector", PI_PROTOCOL, PI_ERROR, "Can not find xml dissector", EXPFILL }},\r\n};\r\nstatic uat_field_t reloadkindidlist_uats_flds[] = {\r\nUAT_FLD_DEC(kindidlist_uats,id,"Kind-ID Number","Custom Kind-ID Number"),\r\nUAT_FLD_CSTRING(kindidlist_uats,name,"Kind-ID Name","Custom Kind-ID Name"),\r\nUAT_FLD_VS(kindidlist_uats,data_model,"Kind-ID data model",datamodels,"Kind ID data model"),\r\nUAT_END_FIELDS\r\n};\r\nproto_reload = proto_register_protocol("REsource LOcation And Discovery", "RELOAD", "reload");\r\nregister_dissector("reload", dissect_reload_message, proto_reload);\r\nproto_register_field_array(proto_reload, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_reload = expert_register_protocol(proto_reload);\r\nexpert_register_field_array(expert_reload, ei, array_length(ei));\r\nreload_module = prefs_register_protocol(proto_reload, NULL);\r\nreloadkindids_uat =\r\nuat_new("Kind-ID Table",\r\nsizeof(kind_t),\r\n"reload_kindids",\r\nTRUE,\r\n&kindidlist_uats,\r\n&nreloadkinds,\r\nUAT_AFFECTS_DISSECTION,\r\nNULL,\r\nuat_kindid_copy_cb,\r\nNULL,\r\nuat_kindid_record_free_cb,\r\nNULL,\r\nreloadkindidlist_uats_flds);\r\nprefs_register_uat_preference(reload_module, "kindid.table",\r\n"Kind ID list",\r\n"A table of Kind ID definitions",\r\nreloadkindids_uat);\r\nprefs_register_bool_preference(reload_module, "defragment",\r\n"Reassemble fragmented reload datagrams",\r\n"Whether fragmented RELOAD datagrams should be reassembled",\r\n&reload_defragment);\r\nprefs_register_uint_preference(reload_module, "nodeid_length",\r\n"NodeId Length",\r\n"Length of the NodeId as defined in the overlay.",\r\n10,\r\n&reload_nodeid_length);\r\nprefs_register_string_preference(reload_module, "topology_plugin",\r\n"topology plugin", "topology plugin defined in the overlay", &reload_topology_plugin);\r\nregister_init_routine(reload_defragment_init);\r\nregister_cleanup_routine(reload_defragment_cleanup);\r\n}\r\nvoid\r\nproto_reg_handoff_reload(void)\r\n{\r\nxml_handle = find_dissector_add_dependency("xml", proto_reload);\r\nheur_dissector_add("udp", dissect_reload_heur, "RELOAD over UDP", "reload_udp", proto_reload, HEURISTIC_ENABLE);\r\nheur_dissector_add("tcp", dissect_reload_heur, "RELOAD over TCP", "reload_tcp", proto_reload, HEURISTIC_ENABLE);\r\n}
