static void table_destroy_notify(gpointer data) {\r\ng_free(data);\r\n}\r\nstatic int\r\ndissect_rroce(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\ndissect_infiniband_common(tvb, pinfo, tree, IB_PACKET_STARTS_WITH_BTH);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic int\r\ndissect_roce(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\ndissect_infiniband_common(tvb, pinfo, tree, IB_PACKET_STARTS_WITH_GRH);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic int\r\ndissect_infiniband(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\ndissect_infiniband_common(tvb, pinfo, tree, IB_PACKET_STARTS_WITH_LRH);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic void\r\ndissect_infiniband_common(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, ib_packet_start_header starts_with)\r\n{\r\nproto_item *infiniband_packet;\r\nproto_tree *all_headers_tree;\r\ngboolean dctBthHeader = FALSE;\r\ngint bthSize = 12;\r\nproto_item *local_route_header_item;\r\nproto_tree *local_route_header_tree;\r\nproto_item *RAWDATA_header_item;\r\nguint8 lnh_val;\r\ngint offset = 0;\r\ngboolean bthFollows = FALSE;\r\nstruct infinibandinfo info = { 0, FALSE };\r\ngint32 nextHeaderSequence = -1;\r\nguint8 nxtHdr = 0;\r\nguint16 packetLength = 0;\r\ngint crc_length = 0;\r\ngint crclen = 6;\r\nvoid *src_addr,\r\n*dst_addr;\r\npinfo->srcport = pinfo->destport = 0xffffffff;\r\npinfo->ptype = PT_IBQP;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "InfiniBand");\r\ncol_clear(pinfo->cinfo, COL_INFO);\r\ninfiniband_packet = proto_tree_add_item(tree, proto_infiniband, tvb, offset, -1, ENC_NA);\r\nall_headers_tree = proto_item_add_subtree(infiniband_packet, ett_all_headers);\r\nif (starts_with == IB_PACKET_STARTS_WITH_GRH) {\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "RoCE");\r\nlnh_val = IBA_GLOBAL;\r\npacketLength = tvb_reported_length_remaining(tvb, offset);\r\ncrclen = 4;\r\ngoto skip_lrh;\r\n}\r\nelse if (starts_with == IB_PACKET_STARTS_WITH_BTH) {\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "RRoCE");\r\nlnh_val = IBA_LOCAL;\r\npacketLength = tvb_reported_length_remaining(tvb, offset);\r\ncrclen = 4;\r\ngoto skip_lrh;\r\n}\r\nlocal_route_header_item = proto_tree_add_item(all_headers_tree, hf_infiniband_LRH, tvb, offset, 8, ENC_NA);\r\nproto_item_set_text(local_route_header_item, "%s", "Local Route Header");\r\nlocal_route_header_tree = proto_item_add_subtree(local_route_header_item, ett_lrh);\r\nproto_tree_add_item(local_route_header_tree, hf_infiniband_virtual_lane, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(local_route_header_tree, hf_infiniband_link_version, tvb, offset, 1, ENC_BIG_ENDIAN); offset += 1;\r\nproto_tree_add_item(local_route_header_tree, hf_infiniband_service_level, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(local_route_header_tree, hf_infiniband_reserved2, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(local_route_header_tree, hf_infiniband_link_next_header, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nlnh_val = tvb_get_guint8(tvb, offset);\r\nlnh_val = lnh_val & 0x03;\r\noffset += 1;\r\nproto_tree_add_item(local_route_header_tree, hf_infiniband_destination_local_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\ndst_addr = wmem_alloc(pinfo->pool, sizeof(guint16));\r\n*((guint16*) dst_addr) = tvb_get_ntohs(tvb, offset);\r\nset_address(&pinfo->dst, AT_IB, sizeof(guint16), dst_addr);\r\noffset += 2;\r\nproto_tree_add_item(local_route_header_tree, hf_infiniband_reserved5, tvb, offset, 2, ENC_BIG_ENDIAN);\r\npacketLength = tvb_get_ntohs(tvb, offset);\r\npacketLength = packetLength & 0x07FF;\r\npacketLength = packetLength * 4;\r\nproto_tree_add_item(local_route_header_tree, hf_infiniband_packet_length, tvb, offset, 2, ENC_BIG_ENDIAN); offset += 2;\r\nproto_tree_add_item(local_route_header_tree, hf_infiniband_source_local_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nsrc_addr = wmem_alloc(pinfo->pool, sizeof(guint16));\r\n*((guint16*) src_addr) = tvb_get_ntohs(tvb, offset);\r\nset_address(&pinfo->src, AT_IB, sizeof(guint16), src_addr);\r\noffset += 2;\r\npacketLength -= 8;\r\nskip_lrh:\r\nswitch (lnh_val)\r\n{\r\ncase IBA_GLOBAL: {\r\nproto_item *global_route_header_item;\r\nproto_tree *global_route_header_tree;\r\nglobal_route_header_item = proto_tree_add_item(all_headers_tree, hf_infiniband_GRH, tvb, offset, 40, ENC_NA);\r\nproto_item_set_text(global_route_header_item, "%s", "Global Route Header");\r\nglobal_route_header_tree = proto_item_add_subtree(global_route_header_item, ett_grh);\r\nproto_tree_add_item(global_route_header_tree, hf_infiniband_ip_version, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(global_route_header_tree, hf_infiniband_traffic_class, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(global_route_header_tree, hf_infiniband_flow_label, tvb, offset, 4, ENC_BIG_ENDIAN); offset += 4;\r\nproto_tree_add_item(global_route_header_tree, hf_infiniband_payload_length, tvb, offset, 2, ENC_BIG_ENDIAN); offset += 2;\r\nnxtHdr = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(global_route_header_tree, hf_infiniband_next_header, tvb, offset, 1, ENC_BIG_ENDIAN); offset += 1;\r\nproto_tree_add_item(global_route_header_tree, hf_infiniband_hop_limit, tvb, offset, 1, ENC_BIG_ENDIAN); offset += 1;\r\nproto_tree_add_item(global_route_header_tree, hf_infiniband_source_gid, tvb, offset, 16, ENC_NA);\r\nset_address_tvb(&pinfo->src, AT_IB, GID_SIZE, tvb, offset);\r\noffset += 16;\r\nproto_tree_add_item(global_route_header_tree, hf_infiniband_destination_gid, tvb, offset, 16, ENC_NA);\r\nset_address_tvb(&pinfo->dst, AT_IB, GID_SIZE, tvb, offset);\r\noffset += 16;\r\npacketLength -= 40;\r\nif (nxtHdr != 0x1B)\r\n{\r\nbreak;\r\n}\r\n}\r\ncase IBA_LOCAL: {\r\nproto_item *base_transport_header_item;\r\nproto_tree *base_transport_header_tree;\r\nbthFollows = TRUE;\r\ninfo.opCode = tvb_get_guint8(tvb, offset);\r\nif ((info.opCode >> 5) == 0x2) {\r\ninfo.dctConnect = !(tvb_get_guint8(tvb, offset + 1) & 0x80);\r\ndctBthHeader = TRUE;\r\nbthSize += 8;\r\n}\r\nbase_transport_header_item = proto_tree_add_item(all_headers_tree, hf_infiniband_BTH, tvb, offset, bthSize, ENC_NA);\r\nproto_item_set_text(base_transport_header_item, "%s", "Base Transport Header");\r\nbase_transport_header_tree = proto_item_add_subtree(base_transport_header_item, ett_bth);\r\nproto_tree_add_item(base_transport_header_tree, hf_infiniband_opcode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nif (dctBthHeader) {\r\ncol_append_str(pinfo->cinfo, COL_INFO, val_to_str_const((guint32)info.opCode, DctOpCodeMap, "Unknown OpCode"));\r\n}\r\nelse {\r\ncol_append_str(pinfo->cinfo, COL_INFO, val_to_str_const((guint32)info.opCode, OpCodeMap, "Unknown OpCode"));\r\n}\r\noffset += 1;\r\nproto_tree_add_item(base_transport_header_tree, hf_infiniband_solicited_event, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(base_transport_header_tree, hf_infiniband_migreq, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(base_transport_header_tree, hf_infiniband_pad_count, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(base_transport_header_tree, hf_infiniband_transport_header_version, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(base_transport_header_tree, hf_infiniband_partition_key, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(base_transport_header_tree, hf_infiniband_reserved8, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(base_transport_header_tree, hf_infiniband_destination_qp, tvb, offset, 3, ENC_BIG_ENDIAN);\r\npinfo->destport = tvb_get_ntoh24(tvb, offset);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "QP=0x%06x ", pinfo->destport);\r\noffset += 3;\r\nproto_tree_add_item(base_transport_header_tree, hf_infiniband_acknowledge_request, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(base_transport_header_tree, hf_infiniband_reserved7, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(base_transport_header_tree, hf_infiniband_packet_sequence_number, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\noffset += bthSize - 12;\r\npacketLength -= bthSize;\r\n}\r\nbreak;\r\ncase IP_NON_IBA:\r\ndst_addr = wmem_strdup(pinfo->pool, "IPv6 over IB Packet");\r\nset_address(&pinfo->dst, AT_STRINGZ, (int)strlen((char *)dst_addr)+1, dst_addr);\r\nparse_IPvSix(all_headers_tree, tvb, &offset, pinfo);\r\nbreak;\r\ncase RAW:\r\nparse_RWH(all_headers_tree, tvb, &offset, pinfo, tree);\r\nbreak;\r\ndefault:\r\nRAWDATA_header_item = proto_tree_add_item(all_headers_tree, hf_infiniband_raw_data, tvb, offset, -1, ENC_NA);\r\nproto_item_set_text(RAWDATA_header_item, "%s", "Unknown Raw Data - IB Encapsulated");\r\nbreak;\r\n}\r\nif (bthFollows)\r\n{\r\nnextHeaderSequence = find_next_header_sequence(&info);\r\nswitch (nextHeaderSequence)\r\n{\r\ncase RDETH_DETH_PAYLD:\r\nparse_RDETH(all_headers_tree, tvb, &offset);\r\nparse_DETH(all_headers_tree, pinfo, tvb, &offset);\r\npacketLength -= 4;\r\npacketLength -= 8;\r\nparse_PAYLOAD(all_headers_tree, pinfo, &info, tvb, &offset, packetLength, crclen, tree);\r\nbreak;\r\ncase RDETH_DETH_RETH_PAYLD:\r\nparse_RDETH(all_headers_tree, tvb, &offset);\r\nparse_DETH(all_headers_tree, pinfo, tvb, &offset);\r\nparse_RETH(all_headers_tree, tvb, &offset);\r\npacketLength -= 4;\r\npacketLength -= 8;\r\npacketLength -= 16;\r\nparse_PAYLOAD(all_headers_tree, pinfo, &info, tvb, &offset, packetLength, crclen, tree);\r\nbreak;\r\ncase RDETH_DETH_IMMDT_PAYLD:\r\nparse_RDETH(all_headers_tree, tvb, &offset);\r\nparse_DETH(all_headers_tree, pinfo, tvb, &offset);\r\nparse_IMMDT(all_headers_tree, tvb, &offset);\r\npacketLength -= 4;\r\npacketLength -= 8;\r\npacketLength -= 4;\r\nparse_PAYLOAD(all_headers_tree, pinfo, &info, tvb, &offset, packetLength, crclen, tree);\r\nbreak;\r\ncase RDETH_DETH_RETH_IMMDT_PAYLD:\r\nparse_RDETH(all_headers_tree, tvb, &offset);\r\nparse_DETH(all_headers_tree, pinfo, tvb, &offset);\r\nparse_RETH(all_headers_tree, tvb, &offset);\r\nparse_IMMDT(all_headers_tree, tvb, &offset);\r\npacketLength -= 4;\r\npacketLength -= 8;\r\npacketLength -= 16;\r\npacketLength -= 4;\r\nparse_PAYLOAD(all_headers_tree, pinfo, &info, tvb, &offset, packetLength, crclen, tree);\r\nbreak;\r\ncase RDETH_DETH_RETH:\r\nparse_RDETH(all_headers_tree, tvb, &offset);\r\nparse_DETH(all_headers_tree, pinfo, tvb, &offset);\r\nparse_RETH(all_headers_tree, tvb, &offset);\r\nbreak;\r\ncase RDETH_AETH_PAYLD:\r\nparse_RDETH(all_headers_tree, tvb, &offset);\r\nparse_AETH(all_headers_tree, tvb, &offset);\r\npacketLength -= 4;\r\npacketLength -= 4;\r\nparse_PAYLOAD(all_headers_tree, pinfo, &info, tvb, &offset, packetLength, crclen, tree);\r\nbreak;\r\ncase RDETH_PAYLD:\r\nparse_RDETH(all_headers_tree, tvb, &offset);\r\npacketLength -= 4;\r\nparse_PAYLOAD(all_headers_tree, pinfo, &info, tvb, &offset, packetLength, crclen, tree);\r\nbreak;\r\ncase RDETH_AETH:\r\nparse_AETH(all_headers_tree, tvb, &offset);\r\nbreak;\r\ncase RDETH_AETH_ATOMICACKETH:\r\nparse_RDETH(all_headers_tree, tvb, &offset);\r\nparse_AETH(all_headers_tree, tvb, &offset);\r\nparse_ATOMICACKETH(all_headers_tree, tvb, &offset);\r\nbreak;\r\ncase RDETH_DETH_ATOMICETH:\r\nparse_RDETH(all_headers_tree, tvb, &offset);\r\nparse_DETH(all_headers_tree, pinfo, tvb, &offset);\r\nparse_ATOMICETH(all_headers_tree, tvb, &offset);\r\nbreak;\r\ncase RDETH_DETH:\r\nparse_RDETH(all_headers_tree, tvb, &offset);\r\nparse_DETH(all_headers_tree, pinfo, tvb, &offset);\r\nbreak;\r\ncase DETH_PAYLD:\r\nparse_DETH(all_headers_tree, pinfo, tvb, &offset);\r\npacketLength -= 8;\r\nparse_PAYLOAD(all_headers_tree, pinfo, &info, tvb, &offset, packetLength, crclen, tree);\r\nbreak;\r\ncase PAYLD:\r\nparse_PAYLOAD(all_headers_tree, pinfo, &info, tvb, &offset, packetLength, crclen, tree);\r\nbreak;\r\ncase IMMDT_PAYLD:\r\nparse_IMMDT(all_headers_tree, tvb, &offset);\r\npacketLength -= 4;\r\nparse_PAYLOAD(all_headers_tree, pinfo, &info, tvb, &offset, packetLength, crclen, tree);\r\nbreak;\r\ncase RETH_IMMDT_PAYLD:\r\nparse_RETH(all_headers_tree, tvb, &offset);\r\nparse_IMMDT(all_headers_tree, tvb, &offset);\r\npacketLength -= 16;\r\npacketLength -= 4;\r\nparse_PAYLOAD(all_headers_tree, pinfo, &info, tvb, &offset, packetLength, crclen, tree);\r\nbreak;\r\ncase RETH_PAYLD:\r\nparse_RETH(all_headers_tree, tvb, &offset);\r\npacketLength -= 16;\r\nparse_PAYLOAD(all_headers_tree, pinfo, &info, tvb, &offset, packetLength, crclen, tree);\r\nbreak;\r\ncase RETH:\r\nparse_RETH(all_headers_tree, tvb, &offset);\r\nbreak;\r\ncase AETH_PAYLD:\r\nparse_AETH(all_headers_tree, tvb, &offset);\r\npacketLength -= 4;\r\nparse_PAYLOAD(all_headers_tree, pinfo, &info, tvb, &offset, packetLength, crclen, tree);\r\nbreak;\r\ncase AETH:\r\nparse_AETH(all_headers_tree, tvb, &offset);\r\nbreak;\r\ncase AETH_ATOMICACKETH:\r\nparse_AETH(all_headers_tree, tvb, &offset);\r\nparse_ATOMICACKETH(all_headers_tree, tvb, &offset);\r\nbreak;\r\ncase ATOMICETH:\r\nparse_ATOMICETH(all_headers_tree, tvb, &offset);\r\nbreak;\r\ncase IETH_PAYLD:\r\nparse_IETH(all_headers_tree, tvb, &offset);\r\npacketLength -= 4;\r\nparse_PAYLOAD(all_headers_tree, pinfo, &info, tvb, &offset, packetLength, crclen, tree);\r\nbreak;\r\ncase DETH_IMMDT_PAYLD:\r\nparse_DETH(all_headers_tree, pinfo, tvb, &offset);\r\nparse_IMMDT(all_headers_tree, tvb, &offset);\r\npacketLength -= 8;\r\npacketLength -= 4;\r\nparse_PAYLOAD(all_headers_tree, pinfo, &info, tvb, &offset, packetLength, crclen, tree);\r\nbreak;\r\ncase DCCETH:\r\nparse_DCCETH(all_headers_tree, tvb, &offset);\r\npacketLength -= 16;\r\nparse_PAYLOAD(all_headers_tree, pinfo, &info, tvb, &offset, packetLength, crclen, tree);\r\nbreak;\r\ndefault:\r\nparse_VENDOR(all_headers_tree, tvb, &offset);\r\nbreak;\r\n}\r\n}\r\ncrc_length = tvb_reported_length_remaining(tvb, offset);\r\nif (crc_length == 6)\r\n{\r\nproto_tree_add_item(all_headers_tree, hf_infiniband_invariant_crc, tvb, offset, 4, ENC_BIG_ENDIAN); offset += 4;\r\nproto_tree_add_item(all_headers_tree, hf_infiniband_variant_crc, tvb, offset, 2, ENC_BIG_ENDIAN); offset += 2;\r\n}\r\nelse if (crc_length == 4)\r\n{\r\nproto_tree_add_item(all_headers_tree, hf_infiniband_invariant_crc, tvb, offset, 4, ENC_BIG_ENDIAN); offset += 4;\r\n}\r\nelse if (crc_length == 2)\r\n{\r\nproto_tree_add_item(all_headers_tree, hf_infiniband_variant_crc, tvb, offset, 2, ENC_BIG_ENDIAN); offset += 2;\r\n}\r\n}\r\nstatic int\r\ndissect_infiniband_link(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nproto_item *infiniband_link_packet;\r\nproto_tree *link_tree;\r\nproto_item *operand_item;\r\ngint offset = 0;\r\nguint8 operand;\r\noperand = tvb_get_guint8(tvb, offset);\r\noperand = (operand & 0xF0) >> 4;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "InfiniBand Link");\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "%s",\r\nval_to_str(operand, Operand_Description, "Unknown (0x%1x)"));\r\ndissect_general_info(tvb, offset, pinfo, IB_PACKET_STARTS_WITH_LRH);\r\ninfiniband_link_packet = proto_tree_add_item(tree, proto_infiniband_link, tvb, offset, -1, ENC_NA);\r\nlink_tree = proto_item_add_subtree(infiniband_link_packet, ett_link);\r\noperand_item = proto_tree_add_item(link_tree, hf_infiniband_link_op, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nif (operand > 1) {\r\nproto_item_set_text(operand_item, "%s", "Reserved");\r\ncall_data_dissector(tvb, pinfo, link_tree);\r\n} else {\r\nproto_tree_add_item(link_tree, hf_infiniband_link_fctbs, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(link_tree, hf_infiniband_link_vl, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(link_tree, hf_infiniband_link_fccl, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(link_tree, hf_infiniband_link_lpcrc, tvb, offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic gint32\r\nfind_next_header_sequence(struct infinibandinfo* ibInfo)\r\n{\r\nif (ibInfo->opCode == 0x55)\r\nreturn ibInfo->dctConnect ? DCCETH : PAYLD;\r\nif (contains(ibInfo->opCode, &opCode_PAYLD[0], (gint32)array_length(opCode_PAYLD)))\r\nreturn PAYLD;\r\nif (contains(ibInfo->opCode, &opCode_IMMDT_PAYLD[0], (gint32)array_length(opCode_IMMDT_PAYLD)))\r\nreturn IMMDT_PAYLD;\r\nif (contains(ibInfo->opCode, &opCode_RDETH_DETH_PAYLD[0], (gint32)array_length(opCode_RDETH_DETH_PAYLD)))\r\nreturn RDETH_DETH_PAYLD;\r\nif (contains(ibInfo->opCode, &opCode_RETH_PAYLD[0], (gint32)array_length(opCode_RETH_PAYLD)))\r\nreturn RETH_PAYLD;\r\nif (contains(ibInfo->opCode, &opCode_RDETH_AETH_PAYLD[0], (gint32)array_length(opCode_RDETH_AETH_PAYLD)))\r\nreturn RDETH_AETH_PAYLD;\r\nif (contains(ibInfo->opCode, &opCode_AETH_PAYLD[0], (gint32)array_length(opCode_AETH_PAYLD)))\r\nreturn AETH_PAYLD;\r\nif (contains(ibInfo->opCode, &opCode_RDETH_DETH_IMMDT_PAYLD[0], (gint32)array_length(opCode_RDETH_DETH_IMMDT_PAYLD)))\r\nreturn RDETH_DETH_IMMDT_PAYLD;\r\nif (contains(ibInfo->opCode, &opCode_RETH_IMMDT_PAYLD[0], (gint32)array_length(opCode_RETH_IMMDT_PAYLD)))\r\nreturn RETH_IMMDT_PAYLD;\r\nif (contains(ibInfo->opCode, &opCode_RDETH_DETH_RETH_PAYLD[0], (gint32)array_length(opCode_RDETH_DETH_RETH_PAYLD)))\r\nreturn RDETH_DETH_RETH_PAYLD;\r\nif (contains(ibInfo->opCode, &opCode_ATOMICETH[0], (gint32)array_length(opCode_ATOMICETH)))\r\nreturn ATOMICETH;\r\nif (contains(ibInfo->opCode, &opCode_IETH_PAYLD[0], (gint32)array_length(opCode_IETH_PAYLD)))\r\nreturn IETH_PAYLD;\r\nif (contains(ibInfo->opCode, &opCode_RDETH_DETH_ATOMICETH[0], (gint32)array_length(opCode_RDETH_DETH_ATOMICETH)))\r\nreturn RDETH_DETH_ATOMICETH;\r\nif ((ibInfo->opCode ^ RC_ACKNOWLEDGE) == 0)\r\nreturn AETH;\r\nif ((ibInfo->opCode ^ RC_RDMA_READ_REQUEST) == 0)\r\nreturn RETH;\r\nif ((ibInfo->opCode ^ RC_ATOMIC_ACKNOWLEDGE) == 0)\r\nreturn AETH_ATOMICACKETH;\r\nif ((ibInfo->opCode ^ RD_RDMA_READ_RESPONSE_MIDDLE) == 0)\r\nreturn RDETH_PAYLD;\r\nif ((ibInfo->opCode ^ RD_ACKNOWLEDGE) == 0)\r\nreturn RDETH_AETH;\r\nif ((ibInfo->opCode ^ RD_ATOMIC_ACKNOWLEDGE) == 0)\r\nreturn RDETH_AETH_ATOMICACKETH;\r\nif ((ibInfo->opCode ^ RD_RDMA_WRITE_ONLY_IMM) == 0)\r\nreturn RDETH_DETH_RETH_IMMDT_PAYLD;\r\nif ((ibInfo->opCode ^ RD_RDMA_READ_REQUEST) == 0)\r\nreturn RDETH_DETH_RETH;\r\nif ((ibInfo->opCode ^ RD_RESYNC) == 0)\r\nreturn RDETH_DETH;\r\nif ((ibInfo->opCode ^ UD_SEND_ONLY) == 0)\r\nreturn DETH_PAYLD;\r\nif ((ibInfo->opCode ^ UD_SEND_ONLY_IMM) == 0)\r\nreturn DETH_IMMDT_PAYLD;\r\nreturn -1;\r\n}\r\nstatic gboolean\r\ncontains(guint32 OpCode, guint32* Codes, gint32 length)\r\n{\r\ngint32 i;\r\nfor (i = 0; i < length; i++)\r\n{\r\nif ((OpCode ^ Codes[i]) == 0)\r\nreturn TRUE;\r\n}\r\nreturn FALSE;\r\n}\r\nstatic void\r\nparse_RDETH(proto_tree * parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *RDETH_header_item;\r\nproto_tree *RDETH_header_tree;\r\nRDETH_header_item = proto_tree_add_item(parentTree, hf_infiniband_RDETH, tvb, local_offset, 4, ENC_NA);\r\nproto_item_set_text(RDETH_header_item, "%s", "RDETH - Reliable Datagram Extended Transport Header");\r\nRDETH_header_tree = proto_item_add_subtree(RDETH_header_item, ett_rdeth);\r\nproto_tree_add_item(RDETH_header_tree, hf_infiniband_reserved8_RDETH, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(RDETH_header_tree, hf_infiniband_ee_context, tvb, local_offset, 3, ENC_BIG_ENDIAN); local_offset += 3;\r\n*offset = local_offset;\r\n}\r\nstatic void\r\nparse_DETH(proto_tree *parentTree, packet_info *pinfo, tvbuff_t *tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *DETH_header_item;\r\nproto_tree *DETH_header_tree;\r\nDETH_header_item = proto_tree_add_item(parentTree, hf_infiniband_DETH, tvb, local_offset, 8, ENC_NA);\r\nproto_item_set_text(DETH_header_item, "%s", "DETH - Datagram Extended Transport Header");\r\nDETH_header_tree = proto_item_add_subtree(DETH_header_item, ett_deth);\r\nproto_tree_add_item(DETH_header_tree, hf_infiniband_queue_key, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nproto_tree_add_item(DETH_header_tree, hf_infiniband_reserved8_DETH, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(DETH_header_tree, hf_infiniband_source_qp, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\npinfo->srcport = tvb_get_ntoh24(tvb, local_offset); local_offset += 3;\r\n*offset = local_offset;\r\n}\r\nstatic void\r\nparse_DCCETH(proto_tree *parentTree _U_, tvbuff_t *tvb _U_, gint *offset)\r\n{\r\n*offset += 16;\r\n}\r\nstatic void\r\nparse_RETH(proto_tree * parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *RETH_header_item;\r\nproto_tree *RETH_header_tree;\r\nRETH_header_item = proto_tree_add_item(parentTree, hf_infiniband_RETH, tvb, local_offset, 16, ENC_NA);\r\nproto_item_set_text(RETH_header_item, "%s", "RETH - RDMA Extended Transport Header");\r\nRETH_header_tree = proto_item_add_subtree(RETH_header_item, ett_reth);\r\nproto_tree_add_item(RETH_header_tree, hf_infiniband_virtual_address, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(RETH_header_tree, hf_infiniband_remote_key, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nproto_tree_add_item(RETH_header_tree, hf_infiniband_dma_length, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\n*offset = local_offset;\r\n}\r\nstatic void\r\nparse_ATOMICETH(proto_tree * parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *ATOMICETH_header_item;\r\nproto_tree *ATOMICETH_header_tree;\r\nATOMICETH_header_item = proto_tree_add_item(parentTree, hf_infiniband_AtomicETH, tvb, local_offset, 28, ENC_NA);\r\nproto_item_set_text(ATOMICETH_header_item, "%s", "AtomicETH - Atomic Extended Transport Header");\r\nATOMICETH_header_tree = proto_item_add_subtree(ATOMICETH_header_item, ett_atomiceth);\r\nproto_tree_add_item(ATOMICETH_header_tree, hf_infiniband_virtual_address, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(ATOMICETH_header_tree, hf_infiniband_remote_key, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nproto_tree_add_item(ATOMICETH_header_tree, hf_infiniband_swap_or_add_data, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(ATOMICETH_header_tree, hf_infiniband_compare_data, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\n*offset = local_offset;\r\n}\r\nstatic void\r\nparse_AETH(proto_tree * parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *AETH_header_item;\r\nproto_tree *AETH_header_tree;\r\nAETH_header_item = proto_tree_add_item(parentTree, hf_infiniband_AETH, tvb, local_offset, 4, ENC_NA);\r\nproto_item_set_text(AETH_header_item, "%s", "AETH - ACK Extended Transport Header");\r\nAETH_header_tree = proto_item_add_subtree(AETH_header_item, ett_aeth);\r\nproto_tree_add_item(AETH_header_tree, hf_infiniband_syndrome, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(AETH_header_tree, hf_infiniband_message_sequence_number, tvb, local_offset, 3, ENC_BIG_ENDIAN); local_offset += 3;\r\n*offset = local_offset;\r\n}\r\nstatic void\r\nparse_ATOMICACKETH(proto_tree * parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *ATOMICACKETH_header_item;\r\nproto_tree *ATOMICACKETH_header_tree;\r\nATOMICACKETH_header_item = proto_tree_add_item(parentTree, hf_infiniband_AtomicAckETH, tvb, local_offset, 8, ENC_NA);\r\nproto_item_set_text(ATOMICACKETH_header_item, "%s", "ATOMICACKETH - Atomic ACK Extended Transport Header");\r\nATOMICACKETH_header_tree = proto_item_add_subtree(ATOMICACKETH_header_item, ett_atomicacketh);\r\nproto_tree_add_item(ATOMICACKETH_header_tree, hf_infiniband_original_remote_data, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\n*offset = local_offset;\r\n}\r\nstatic void\r\nparse_IMMDT(proto_tree * parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *IMMDT_header_item;\r\nproto_tree *IMMDT_header_tree;\r\nIMMDT_header_item = proto_tree_add_item(parentTree, hf_infiniband_IMMDT, tvb, local_offset, 4, ENC_NA);\r\nproto_item_set_text(IMMDT_header_item, "%s", "IMMDT - Immediate Data Extended Transport Header");\r\nIMMDT_header_tree = proto_item_add_subtree(IMMDT_header_item, ett_immdt);\r\nproto_tree_add_item(IMMDT_header_tree, hf_infiniband_IMMDT, tvb, local_offset, 4, ENC_NA); local_offset += 4;\r\n*offset = local_offset;\r\n}\r\nstatic void\r\nparse_IETH(proto_tree * parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *IETH_header_item;\r\nproto_tree *IETH_header_tree;\r\nIETH_header_item = proto_tree_add_item(parentTree, hf_infiniband_IETH, tvb, local_offset, 4, ENC_NA);\r\nproto_item_set_text(IETH_header_item, "%s", "IETH - Invalidate Extended Transport Header");\r\nIETH_header_tree = proto_item_add_subtree(IETH_header_item, ett_ieth);\r\nproto_tree_add_item(IETH_header_tree, hf_infiniband_IETH, tvb, local_offset, 4, ENC_NA); local_offset += 4;\r\n*offset = local_offset;\r\n}\r\nstatic void parse_PAYLOAD(proto_tree *parentTree,\r\npacket_info *pinfo, struct infinibandinfo *info,\r\ntvbuff_t *tvb, gint *offset, gint length, gint crclen, proto_tree *top_tree)\r\n{\r\ngint local_offset = *offset;\r\nguint8 management_class;\r\ntvbuff_t *volatile next_tvb;\r\ngint reported_length;\r\nguint16 etype, reserved;\r\nconst char *saved_proto;\r\nvolatile gboolean dissector_found = FALSE;\r\nheur_dtbl_entry_t *hdtbl_entry;\r\nif (!tvb_bytes_exist(tvb, *offset, length))\r\n{\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Invalid Packet Length from LRH! [Malformed Packet]");\r\ncol_set_fence(pinfo->cinfo, COL_INFO);\r\nreturn;\r\n}\r\nif (pinfo->srcport == 0 || pinfo->srcport == 1 || pinfo->destport == 0 || pinfo->destport == 1)\r\n{\r\nmanagement_class = tvb_get_guint8(tvb, (*offset) + 1);\r\nif (((management_class >= (guint8)VENDOR_1_START) && (management_class <= (guint8)VENDOR_1_END))\r\n|| ((management_class >= (guint8)VENDOR_2_START) && (management_class <= (guint8)VENDOR_2_END)))\r\n{\r\nparse_VENDOR_MANAGEMENT(parentTree, tvb, offset);\r\n}\r\nelse if ((management_class >= (guint8)APPLICATION_START) && (management_class <= (guint8)APPLICATION_END))\r\n{\r\nparse_APPLICATION_MANAGEMENT(parentTree, tvb, offset);\r\n}\r\nelse if (((management_class == (guint8)0x00) || (management_class == (guint8)0x02))\r\n|| ((management_class >= (guint8)0x50) && (management_class <= (guint8)0x80))\r\n|| ((management_class >= (guint8)0x82)))\r\n{\r\nparse_RESERVED_MANAGEMENT(parentTree, tvb, offset);\r\n}\r\nelse\r\n{\r\nswitch (management_class)\r\n{\r\ncase SUBN_LID_ROUTED:\r\nparse_SUBN_LID_ROUTED(parentTree, pinfo, tvb, &local_offset);\r\nbreak;\r\ncase SUBN_DIRECTED_ROUTE:\r\nparse_SUBN_DIRECTED_ROUTE(parentTree, pinfo, tvb, &local_offset);\r\nbreak;\r\ncase SUBNADMN:\r\nparse_SUBNADMN(parentTree, pinfo, tvb, &local_offset);\r\nbreak;\r\ncase PERF:\r\nparse_PERF(parentTree, tvb, pinfo, &local_offset);\r\nbreak;\r\ncase BM:\r\nparse_BM(parentTree, tvb, &local_offset);\r\nbreak;\r\ncase DEV_MGT:\r\nparse_DEV_MGT(parentTree, tvb, &local_offset);\r\nbreak;\r\ncase COM_MGT:\r\nparse_COM_MGT(parentTree, pinfo, tvb, &local_offset);\r\nbreak;\r\ncase SNMP:\r\nparse_SNMP(parentTree, tvb, &local_offset);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\n}\r\nelse\r\n{\r\netype = tvb_get_ntohs(tvb, local_offset);\r\nreserved = tvb_get_ntohs(tvb, local_offset + 2);\r\nif (pref_dissect_eoib &&\r\n(((info->opCode & 0xE0) >> 5) == TRANSPORT_UD) &&\r\n(tvb_get_bits8(tvb, local_offset*8, 4) == 0xC)) {\r\ndissector_found = parse_EoIB(parentTree, tvb, local_offset, pinfo, top_tree);\r\n}\r\nif (!dissector_found && pref_identify_iba_payload && (reserved == 0)) {\r\nnext_tvb = tvb_new_subset_remaining(tvb, local_offset+4);\r\nsaved_proto = pinfo->current_proto;\r\nTRY {\r\ndissector_found = dissector_try_uint(ethertype_dissector_table,\r\netype, next_tvb, pinfo, top_tree);\r\n}\r\nCATCH_NONFATAL_ERRORS {\r\nshow_exception(next_tvb, pinfo, top_tree, EXCEPT_CODE, GET_MESSAGE);\r\ndissector_found = TRUE;\r\npinfo->current_proto = saved_proto;\r\n}\r\nENDTRY;\r\nif (dissector_found) {\r\nproto_item *PAYLOAD_header_item;\r\nproto_tree *PAYLOAD_header_tree;\r\nPAYLOAD_header_item = proto_tree_add_item(parentTree, hf_infiniband_payload, tvb, local_offset, tvb_reported_length_remaining(tvb, local_offset)-6, ENC_NA);\r\nproto_item_set_text(PAYLOAD_header_item, "%s", "IBA Payload - appears to be EtherType encapsulated");\r\nPAYLOAD_header_tree = proto_item_add_subtree(PAYLOAD_header_item, ett_payload);\r\nproto_tree_add_uint(PAYLOAD_header_tree, hf_infiniband_etype, tvb,\r\nlocal_offset, 2, tvb_get_ntohs(tvb, local_offset));\r\nlocal_offset += 2;\r\nproto_tree_add_uint(PAYLOAD_header_tree, hf_infiniband_reserved16_RWH, tvb,\r\nlocal_offset, 2, tvb_get_ntohs(tvb, local_offset));\r\n}\r\n}\r\nreported_length = tvb_reported_length_remaining(tvb,\r\nlocal_offset);\r\nif (reported_length >= crclen)\r\nreported_length -= crclen;\r\nnext_tvb = tvb_new_subset_length(tvb, local_offset, reported_length);\r\nif (!dissector_found) {\r\ndissector_found = dissector_try_heuristic(heur_dissectors_payload, next_tvb, pinfo, parentTree, &hdtbl_entry, info);\r\n}\r\nif (!dissector_found) {\r\ncall_data_dissector(next_tvb, pinfo, top_tree);\r\n}\r\nlocal_offset = tvb_reported_length(tvb) - crclen;\r\n}\r\n*offset = local_offset;\r\n}\r\nstatic void parse_VENDOR(proto_tree * parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *VENDOR_header_item;\r\nproto_tree *VENDOR_header_tree;\r\nVENDOR_header_item = proto_tree_add_item(parentTree, hf_infiniband_vendor, tvb, local_offset, 4, ENC_NA);\r\nproto_item_set_text(VENDOR_header_item, "%s", "Vendor Specific or Unknown Header Sequence");\r\nVENDOR_header_tree = proto_item_add_subtree(VENDOR_header_item, ett_vendor);\r\nproto_tree_add_item(VENDOR_header_tree, hf_infiniband_vendor, tvb, local_offset, -1, ENC_NA);\r\n*offset = local_offset;\r\n}\r\nstatic void parse_IPvSix(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, packet_info *pinfo)\r\n{\r\ntvbuff_t *ipv6_tvb;\r\nipv6_tvb = tvb_new_subset_length(tvb, *offset,\r\ntvb_reported_length_remaining(tvb, *offset) - 2);\r\ncall_dissector(ipv6_handle, ipv6_tvb, pinfo, parentTree);\r\n*offset = tvb_reported_length(tvb) - 2;\r\nproto_tree_add_item(parentTree, hf_infiniband_variant_crc, tvb, *offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nstatic void parse_RWH(proto_tree *ah_tree, tvbuff_t *tvb, gint *offset, packet_info *pinfo, proto_tree *top_tree)\r\n{\r\nguint16 ether_type;\r\ntvbuff_t *next_tvb;\r\nproto_item *RWH_header_item;\r\nproto_tree *RWH_header_tree;\r\ngint captured_length, reported_length;\r\nRWH_header_item = proto_tree_add_item(ah_tree, hf_infiniband_RWH, tvb, *offset, 4, ENC_NA);\r\nproto_item_set_text(RWH_header_item, "%s", "RWH - Raw Header");\r\nRWH_header_tree = proto_item_add_subtree(RWH_header_item, ett_rwh);\r\nproto_tree_add_item(RWH_header_tree, hf_infiniband_reserved16_RWH, tvb,\r\n*offset, 2, ENC_BIG_ENDIAN);\r\n*offset += 2;\r\nether_type = tvb_get_ntohs(tvb, *offset);\r\nproto_tree_add_uint(RWH_header_tree, hf_infiniband_etype, tvb, *offset, 2,\r\nether_type);\r\n*offset += 2;\r\ncaptured_length = tvb_captured_length_remaining(tvb, *offset);\r\nreported_length = tvb_reported_length_remaining(tvb, *offset);\r\nif ((captured_length >= 0) && (reported_length >= 0)) {\r\nif (reported_length >= 2)\r\nreported_length -= 2;\r\n}\r\nnext_tvb = tvb_new_subset_length(tvb, *offset, reported_length);\r\nif (!dissector_try_uint(ethertype_dissector_table, ether_type,\r\nnext_tvb, pinfo, top_tree))\r\ncall_data_dissector(next_tvb, pinfo, top_tree);\r\n*offset = tvb_reported_length(tvb) - 2;\r\nproto_tree_add_item(ah_tree, hf_infiniband_variant_crc, tvb, *offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nstatic gboolean parse_EoIB(proto_tree *tree, tvbuff_t *tvb, gint offset, packet_info *pinfo, proto_tree *top_tree)\r\n{\r\nproto_item *header_item;\r\nproto_tree *header_subtree;\r\ngboolean ms;\r\ngint8 seg_offset;\r\ntvbuff_t *encap_tvb;\r\nint encap_size = tvb_reported_length_remaining(tvb, offset) - 6;\r\nif (encap_size < 4) {\r\nreturn FALSE;\r\n}\r\nencap_tvb = tvb_new_subset_length(tvb, offset + 4, encap_size - 4);\r\nheader_item = proto_tree_add_item(tree, hf_infiniband_EOIB, tvb, offset, 4, ENC_NA);\r\nheader_subtree = proto_item_add_subtree(header_item, ett_eoib);\r\nproto_tree_add_item(header_subtree, hf_infiniband_ver, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(header_subtree, hf_infiniband_tcp_chk, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(header_subtree, hf_infiniband_ip_chk, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(header_subtree, hf_infiniband_fcs, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nms = tvb_get_bits8(tvb, (offset + 1)*8 + 2, 1);\r\nseg_offset = tvb_get_bits8(tvb, (offset + 1)*8 + 3, 5);\r\nproto_tree_add_item(header_subtree, hf_infiniband_ms, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(header_subtree, hf_infiniband_seg_off, tvb, offset, 2, ENC_BIG_ENDIAN); offset += 2;\r\nproto_tree_add_item(header_subtree, hf_infiniband_seg_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nif (seg_offset || ms) {\r\ncall_data_dissector(encap_tvb, pinfo, top_tree);\r\n} else {\r\ncall_dissector(eth_handle, encap_tvb, pinfo, top_tree);\r\n}\r\nreturn TRUE;\r\n}\r\nstatic void parse_SUBN_LID_ROUTED(proto_tree *parentTree, packet_info *pinfo, tvbuff_t *tvb, gint *offset)\r\n{\r\nMAD_Data MadData;\r\ngint local_offset;\r\nproto_item *SUBN_LID_ROUTED_header_item;\r\nproto_tree *SUBN_LID_ROUTED_header_tree;\r\nif (!parse_MAD_Common(parentTree, tvb, offset, &MadData))\r\n{\r\nreturn;\r\n}\r\nlocal_offset = *offset;\r\nSUBN_LID_ROUTED_header_item = proto_tree_add_item(parentTree, hf_infiniband_SMP_LID, tvb, local_offset - 24, 256, ENC_NA);\r\nproto_item_set_text(SUBN_LID_ROUTED_header_item, "%s", "SMP (LID Routed) ");\r\nSUBN_LID_ROUTED_header_tree = proto_item_add_subtree(SUBN_LID_ROUTED_header_item, ett_subn_lid_routed);\r\nproto_tree_add_item(SUBN_LID_ROUTED_header_tree, hf_infiniband_m_key, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(SUBN_LID_ROUTED_header_tree, hf_infiniband_reserved256, tvb, local_offset, 32, ENC_NA); local_offset += 32;\r\nlabel_SUBM_Method(SUBN_LID_ROUTED_header_item, &MadData, pinfo);\r\nlabel_SUBM_Attribute(SUBN_LID_ROUTED_header_item, &MadData, pinfo);\r\nif (!parse_SUBM_Attribute(SUBN_LID_ROUTED_header_tree, tvb, &local_offset, &MadData))\r\n{\r\nproto_tree_add_item(SUBN_LID_ROUTED_header_tree, hf_infiniband_smp_data, tvb, local_offset, 64, ENC_NA); local_offset += 64;\r\n}\r\nproto_tree_add_item(SUBN_LID_ROUTED_header_tree, hf_infiniband_reserved1024, tvb, local_offset, 128, ENC_NA); local_offset += 128;\r\n*offset = local_offset;\r\n}\r\nstatic void parse_SUBN_DIRECTED_ROUTE(proto_tree *parentTree, packet_info *pinfo, tvbuff_t *tvb, gint *offset)\r\n{\r\nMAD_Data MadData;\r\ngint local_offset;\r\nproto_item *SUBN_DIRECTED_ROUTE_header_item;\r\nproto_tree *SUBN_DIRECTED_ROUTE_header_tree;\r\nif (!parse_MAD_Common(parentTree, tvb, offset, &MadData))\r\n{\r\nreturn;\r\n}\r\nlocal_offset = *offset;\r\nSUBN_DIRECTED_ROUTE_header_item = proto_tree_add_item(parentTree, hf_infiniband_SMP_DIRECTED, tvb, local_offset - 24, 256, ENC_NA);\r\nproto_item_set_text(SUBN_DIRECTED_ROUTE_header_item, "%s", "SMP (Directed Route) ");\r\nSUBN_DIRECTED_ROUTE_header_tree = proto_item_add_subtree(SUBN_DIRECTED_ROUTE_header_item, ett_subn_directed_route);\r\nlabel_SUBM_Method(SUBN_DIRECTED_ROUTE_header_item, &MadData, pinfo);\r\nlabel_SUBM_Attribute(SUBN_DIRECTED_ROUTE_header_item, &MadData, pinfo);\r\nlocal_offset -= 20;\r\nproto_tree_add_item(SUBN_DIRECTED_ROUTE_header_tree, hf_infiniband_d, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(SUBN_DIRECTED_ROUTE_header_tree, hf_infiniband_smp_status, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(SUBN_DIRECTED_ROUTE_header_tree, hf_infiniband_hop_pointer, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(SUBN_DIRECTED_ROUTE_header_tree, hf_infiniband_hop_count, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nlocal_offset += 16;\r\nproto_tree_add_item(SUBN_DIRECTED_ROUTE_header_tree, hf_infiniband_m_key, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(SUBN_DIRECTED_ROUTE_header_tree, hf_infiniband_dr_slid, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(SUBN_DIRECTED_ROUTE_header_tree, hf_infiniband_dr_dlid, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(SUBN_DIRECTED_ROUTE_header_tree, hf_infiniband_reserved28, tvb, local_offset, 28, ENC_NA); local_offset += 28;\r\nif (!parse_SUBM_Attribute(SUBN_DIRECTED_ROUTE_header_tree, tvb, &local_offset, &MadData))\r\n{\r\nproto_tree_add_item(SUBN_DIRECTED_ROUTE_header_tree, hf_infiniband_smp_data, tvb, local_offset, 64, ENC_NA); local_offset += 64;\r\n}\r\nproto_tree_add_item(SUBN_DIRECTED_ROUTE_header_tree, hf_infiniband_initial_path, tvb, local_offset, 64, ENC_NA); local_offset += 64;\r\nproto_tree_add_item(SUBN_DIRECTED_ROUTE_header_tree, hf_infiniband_return_path, tvb, local_offset, 64, ENC_NA); local_offset += 64;\r\n*offset = local_offset;\r\n}\r\nstatic void parse_SUBNADMN(proto_tree *parentTree, packet_info *pinfo, tvbuff_t *tvb, gint *offset)\r\n{\r\nMAD_Data MadData;\r\ngint local_offset;\r\nproto_item *SUBNADMN_header_item;\r\nproto_tree *SUBNADMN_header_tree;\r\nif (!parse_MAD_Common(parentTree, tvb, offset, &MadData))\r\n{\r\nreturn;\r\n}\r\nif (!parse_RMPP(parentTree, tvb, offset))\r\n{\r\nreturn;\r\n}\r\nlocal_offset = *offset;\r\nSUBNADMN_header_item = proto_tree_add_item(parentTree, hf_infiniband_SA, tvb, local_offset - 36, 256, ENC_NA);\r\nproto_item_set_text(SUBNADMN_header_item, "%s", "SMA");\r\nSUBNADMN_header_tree = proto_item_add_subtree(SUBNADMN_header_item, ett_subnadmin);\r\nproto_tree_add_item(SUBNADMN_header_tree, hf_infiniband_sm_key, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(SUBNADMN_header_tree, hf_infiniband_attribute_offset, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(SUBNADMN_header_tree, hf_infiniband_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(SUBNADMN_header_tree, hf_infiniband_component_mask, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nlabel_SUBA_Method(SUBNADMN_header_item, &MadData, pinfo);\r\nlabel_SUBA_Attribute(SUBNADMN_header_item, &MadData, pinfo);\r\nif (!parse_SUBA_Attribute(SUBNADMN_header_tree, tvb, &local_offset, &MadData))\r\n{\r\nproto_tree_add_item(SUBNADMN_header_tree, hf_infiniband_subnet_admin_data, tvb, local_offset, 200, ENC_NA); local_offset += 200;\r\n}\r\n*offset = local_offset;\r\n}\r\nstatic void parse_PERF(proto_tree *parentTree, tvbuff_t *tvb, packet_info *pinfo, gint *offset)\r\n{\r\nMAD_Data MadData;\r\ngint local_offset;\r\nproto_item *PERF_header_item;\r\nif (!parse_MAD_Common(parentTree, tvb, offset, &MadData))\r\n{\r\nreturn;\r\n}\r\nlocal_offset = *offset;\r\nswitch (MadData.attributeID) {\r\ncase ATTR_PORT_COUNTERS:\r\nparse_PERF_PortCounters(parentTree, tvb, pinfo, &local_offset);\r\nbreak;\r\ncase ATTR_PORT_COUNTERS_EXT:\r\nparse_PERF_PortCountersExtended(parentTree, tvb, pinfo, &local_offset);\r\nbreak;\r\ndefault:\r\nPERF_header_item = proto_tree_add_item(parentTree, hf_infiniband_smp_data, tvb, local_offset, MAD_DATA_SIZE, ENC_NA); local_offset += MAD_DATA_SIZE;\r\nproto_item_set_text(PERF_header_item, "%s", "PERF - Performance Management MAD (Dissector Not Implemented)");\r\nbreak;\r\n}\r\n*offset = local_offset;\r\n}\r\nstatic void parse_BM(proto_tree *parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\nMAD_Data MadData;\r\ngint local_offset;\r\nproto_item *PERF_header_item;\r\nif (!parse_MAD_Common(parentTree, tvb, offset, &MadData))\r\n{\r\nreturn;\r\n}\r\nlocal_offset = *offset;\r\nPERF_header_item = proto_tree_add_item(parentTree, hf_infiniband_smp_data, tvb, local_offset, MAD_DATA_SIZE, ENC_NA); local_offset += MAD_DATA_SIZE;\r\nproto_item_set_text(PERF_header_item, "%s", "BM - Baseboard Management MAD (Dissector Not Implemented)");\r\n*offset = local_offset;\r\n}\r\nstatic void parse_DEV_MGT(proto_tree *parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\nMAD_Data MadData;\r\ngint local_offset;\r\nproto_item *PERF_header_item;\r\nif (!parse_MAD_Common(parentTree, tvb, offset, &MadData))\r\n{\r\nreturn;\r\n}\r\nlocal_offset = *offset;\r\nPERF_header_item = proto_tree_add_item(parentTree, hf_infiniband_smp_data, tvb, local_offset, MAD_DATA_SIZE, ENC_NA); local_offset += MAD_DATA_SIZE;\r\nproto_item_set_text(PERF_header_item, "%s", "DEV_MGT - Device Management MAD (Dissector Not Implemented)");\r\n*offset = local_offset;\r\n}\r\nstatic void parse_COM_MGT(proto_tree *parentTree, packet_info *pinfo, tvbuff_t *tvb, gint *offset)\r\n{\r\nMAD_Data MadData;\r\ngint local_offset;\r\nguint8 *local_gid, *remote_gid;\r\nconst char *label;\r\nproto_item *CM_header_item;\r\nproto_tree *CM_header_tree;\r\ntvbuff_t *next_tvb;\r\nheur_dtbl_entry_t *hdtbl_entry;\r\nlocal_gid = (guint8 *)wmem_alloc(wmem_packet_scope(), GID_SIZE);\r\nremote_gid = (guint8 *)wmem_alloc(wmem_packet_scope(), GID_SIZE);\r\nif (!parse_MAD_Common(parentTree, tvb, offset, &MadData))\r\n{\r\nreturn;\r\n}\r\nlocal_offset = *offset;\r\nCM_header_item = proto_tree_add_item(parentTree, hf_infiniband_smp_data, tvb, local_offset, 140, ENC_NA);\r\nlabel = val_to_str_const(MadData.attributeID, CM_Attributes, "(Unknown CM Attribute)");\r\nproto_item_set_text(CM_header_item, "CM %s", label);\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "CM: %s", label);\r\nCM_header_tree = proto_item_add_subtree(CM_header_item, ett_cm);\r\nswitch (MadData.attributeID) {\r\ncase ATTR_CM_REQ: {\r\nguint32 local_qpn;\r\nguint32 local_lid;\r\nguint32 remote_lid;\r\nguint64 serviceid;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_local_comm_id, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nlocal_offset += 4;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_service_id, tvb, local_offset, 8, ENC_BIG_ENDIAN);\r\nserviceid = tvb_get_ntoh64(tvb, local_offset); local_offset += 8;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_local_ca_guid, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nlocal_offset += 4;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_local_qkey, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_local_qpn, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nlocal_qpn = tvb_get_ntoh24(tvb, local_offset); local_offset += 3;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_respo_res, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_local_eecn, tvb, local_offset, 3, ENC_BIG_ENDIAN); local_offset += 3;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_init_depth, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_remote_eecn, tvb, local_offset, 3, ENC_BIG_ENDIAN); local_offset += 3;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_remote_cm_resp_to, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_transp_serv_type, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_e2e_flow_ctrl, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_start_psn, tvb, local_offset, 3, ENC_BIG_ENDIAN); local_offset += 3;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_local_cm_resp_to, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_retry_count, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_pkey, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_path_pp_mtu, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_rdc_exists, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_rnr_retry_count, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_max_cm_retries, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_srq, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_primary_local_lid, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nlocal_lid = tvb_get_ntohs(tvb, local_offset); local_offset += 2;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_primary_remote_lid, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\nremote_lid = tvb_get_ntohs(tvb, local_offset); local_offset += 2;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_primary_local_gid, tvb, local_offset, 16, ENC_NA);\r\ntvb_get_ipv6(tvb, local_offset, (struct e_in6_addr*)local_gid); local_offset += 16;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_primary_remote_gid, tvb, local_offset, 16, ENC_NA);\r\ntvb_get_ipv6(tvb, local_offset, (struct e_in6_addr*)remote_gid); local_offset += 16;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_primary_flow_label, tvb, local_offset, 3, ENC_BIG_ENDIAN); local_offset += 2;\r\nlocal_offset += 1;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_primary_packet_rate, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_primary_traffic_class, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_primary_hop_limit, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_primary_sl, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_primary_subnet_local, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_primary_local_ack_to, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_alt_local_lid, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_alt_remote_lid, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_alt_local_gid, tvb, local_offset, 16, ENC_NA); local_offset += 16;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_alt_remote_gid, tvb, local_offset, 16, ENC_NA); local_offset += 16;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_flow_label, tvb, local_offset, 3, ENC_BIG_ENDIAN); local_offset += 2;\r\nlocal_offset += 1;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_packet_rate, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_alt_traffic_class, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_alt_hop_limit, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_SL, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_subnet_local, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_local_ACK_timeout, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nif (!pinfo->fd->flags.visited)\r\n{\r\nconnection_context *connection;\r\nconversation_infiniband_data *proto_data;\r\nconversation_t *conv;\r\nguint64 *hash_key = (guint64 *)g_malloc(sizeof(guint64));\r\nconnection = (connection_context *)g_malloc(sizeof(connection_context));\r\nmemcpy(&(connection->req_gid), local_gid, GID_SIZE);\r\nmemcpy(&(connection->resp_gid), remote_gid, GID_SIZE);\r\nconnection->req_lid = local_lid;\r\nconnection->resp_lid = remote_lid;\r\nconnection->req_qp = local_qpn;\r\nconnection->resp_qp = 0;\r\nconnection->service_id = serviceid;\r\n*hash_key = MadData.transactionID;\r\n*hash_key = add_address_to_hash64(*hash_key, &pinfo->src);\r\ng_hash_table_replace(CM_context_table, hash_key, connection);\r\nproto_data = wmem_new(wmem_file_scope(), conversation_infiniband_data);\r\nproto_data->service_id = connection->service_id;\r\nconv = conversation_new(pinfo->num, &pinfo->src, &pinfo->dst,\r\nPT_IBQP, pinfo->srcport, pinfo->destport, 0);\r\nconversation_add_proto_data(conv, proto_infiniband, proto_data);\r\n}\r\nnext_tvb = tvb_new_subset_length(tvb, local_offset, 92);\r\nif (! dissector_try_heuristic(heur_dissectors_cm_private, next_tvb, pinfo, parentTree, &hdtbl_entry, NULL) )\r\nproto_tree_add_item(CM_header_tree, hf_cm_req_private_data, tvb, local_offset, 92, ENC_NA);\r\nlocal_offset += 92;\r\n}\r\nbreak;\r\ncase ATTR_CM_REP: {\r\nguint32 remote_qpn;\r\nproto_tree_add_item(CM_header_tree, hf_cm_rep_localcommid, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nproto_tree_add_item(CM_header_tree, hf_cm_rep_remotecommid, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nproto_tree_add_item(CM_header_tree, hf_cm_rep_localqkey, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nproto_tree_add_item(CM_header_tree, hf_cm_rep_localqpn, tvb, local_offset, 3, ENC_BIG_ENDIAN);\r\nremote_qpn = tvb_get_ntoh24(tvb, local_offset); local_offset += 3;\r\nlocal_offset += 1;\r\nproto_tree_add_item(CM_header_tree, hf_cm_rep_localeecontnum, tvb, local_offset, 3, ENC_BIG_ENDIAN); local_offset += 3;\r\nlocal_offset += 1;\r\nproto_tree_add_item(CM_header_tree, hf_cm_rep_startingpsn, tvb, local_offset, 3, ENC_BIG_ENDIAN); local_offset += 3;\r\nlocal_offset += 1;\r\nproto_tree_add_item(CM_header_tree, hf_cm_rep_responderres, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(CM_header_tree, hf_cm_rep_initiatordepth, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(CM_header_tree, hf_cm_rep_tgtackdelay, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(CM_header_tree, hf_cm_rep_failoveracc, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(CM_header_tree, hf_cm_rep_e2eflowctl, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(CM_header_tree, hf_cm_rep_rnrretrycount, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(CM_header_tree, hf_cm_rep_srq, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(CM_header_tree, hf_cm_rep_localcaguid, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nif (!pinfo->fd->flags.visited)\r\n{\r\nconnection_context *connection;\r\nguint64 hash_key;\r\nhash_key = MadData.transactionID;\r\nhash_key = add_address_to_hash64(hash_key, &pinfo->dst);\r\nconnection = (connection_context *)g_hash_table_lookup(CM_context_table, &hash_key);\r\nif (connection)\r\n{\r\naddress req_addr,\r\nresp_addr;\r\nconversation_t *conv;\r\nconversation_infiniband_data *proto_data = NULL;\r\nconnection->resp_qp = remote_qpn;\r\nproto_data = wmem_new(wmem_file_scope(), conversation_infiniband_data);\r\nproto_data->service_id = connection->service_id;\r\nset_address(&req_addr, AT_IB, GID_SIZE, connection->req_gid);\r\nset_address(&resp_addr, AT_IB, GID_SIZE, connection->resp_gid);\r\nconv = conversation_new(pinfo->num, &req_addr, &req_addr,\r\nPT_IBQP, connection->req_qp, connection->req_qp, NO_ADDR2|NO_PORT2);\r\nconversation_add_proto_data(conv, proto_infiniband, proto_data);\r\nconv = conversation_new(pinfo->num, &resp_addr, &resp_addr,\r\nPT_IBQP, connection->resp_qp, connection->resp_qp, NO_ADDR2|NO_PORT2);\r\nconversation_add_proto_data(conv, proto_infiniband, proto_data);\r\nset_address(&req_addr, AT_IB, sizeof(guint16), &(connection->req_lid));\r\nset_address(&resp_addr, AT_IB, sizeof(guint16), &(connection->resp_lid));\r\nconv = conversation_new(pinfo->num, &req_addr, &req_addr,\r\nPT_IBQP, connection->req_qp, connection->req_qp, NO_ADDR2|NO_PORT2);\r\nconversation_add_proto_data(conv, proto_infiniband, proto_data);\r\nconv = conversation_new(pinfo->num, &resp_addr, &resp_addr,\r\nPT_IBQP, connection->resp_qp, connection->resp_qp, NO_ADDR2|NO_PORT2);\r\nconversation_add_proto_data(conv, proto_infiniband, proto_data);\r\ng_hash_table_remove(CM_context_table, &hash_key);\r\n}\r\n}\r\nnext_tvb = tvb_new_subset_length(tvb, local_offset, 196);\r\nif (! dissector_try_heuristic(heur_dissectors_cm_private, next_tvb, pinfo, parentTree, &hdtbl_entry, NULL) )\r\nproto_tree_add_item(CM_header_tree, hf_cm_rep_privatedata, tvb, local_offset, 196, ENC_NA);\r\nlocal_offset += 196;\r\n}\r\nbreak;\r\ncase ATTR_CM_RTU:\r\nproto_tree_add_item(CM_header_tree, hf_cm_rtu_localcommid, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nproto_tree_add_item(CM_header_tree, hf_cm_rtu_remotecommid, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nproto_tree_add_item(CM_header_tree, hf_cm_rtu_privatedata, tvb, local_offset, 224, ENC_NA); local_offset += 224;\r\nbreak;\r\ncase ATTR_CM_REJ:\r\nproto_tree_add_item(CM_header_tree, hf_cm_rej_local_commid, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nproto_tree_add_item(CM_header_tree, hf_cm_rej_remote_commid, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nproto_tree_add_item(CM_header_tree, hf_cm_rej_msg_rej, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(CM_header_tree, hf_cm_rej_rej_info_len, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nlocal_offset += 1;\r\nproto_tree_add_item(CM_header_tree, hf_cm_rej_reason, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(CM_header_tree, hf_cm_rej_add_rej_info, tvb, local_offset, 72, ENC_NA); local_offset += 72;\r\nproto_tree_add_item(CM_header_tree, hf_cm_rej_private_data, tvb, local_offset, 148, ENC_NA); local_offset += 148;\r\nbreak;\r\ndefault:\r\nproto_item_append_text(CM_header_item, " (Dissector Not Implemented)"); local_offset += MAD_DATA_SIZE;\r\nbreak;\r\n}\r\n*offset = local_offset;\r\n}\r\nstatic void parse_SNMP(proto_tree *parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\nMAD_Data MadData;\r\ngint local_offset;\r\nproto_item *PERF_header_item;\r\nif (!parse_MAD_Common(parentTree, tvb, offset, &MadData))\r\n{\r\nreturn;\r\n}\r\nlocal_offset = *offset;\r\nPERF_header_item = proto_tree_add_item(parentTree, hf_infiniband_smp_data, tvb, local_offset, MAD_DATA_SIZE, ENC_NA); local_offset += MAD_DATA_SIZE;\r\nproto_item_set_text(PERF_header_item, "%s", "SNMP - SNMP Tunneling MAD (Dissector Not Implemented)");\r\n*offset = local_offset;\r\n}\r\nstatic void parse_VENDOR_MANAGEMENT(proto_tree *parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\nMAD_Data MadData;\r\ngint local_offset;\r\nproto_item *PERF_header_item;\r\nif (!parse_MAD_Common(parentTree, tvb, offset, &MadData))\r\n{\r\nreturn;\r\n}\r\nlocal_offset = *offset;\r\nPERF_header_item = proto_tree_add_item(parentTree, hf_infiniband_smp_data, tvb, local_offset, MAD_DATA_SIZE, ENC_NA); local_offset += MAD_DATA_SIZE;\r\nproto_item_set_text(PERF_header_item, "%s", "VENDOR - Vendor Specific Management MAD (Dissector Not Implemented)");\r\n*offset = local_offset;\r\n}\r\nstatic void parse_APPLICATION_MANAGEMENT(proto_tree *parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\nMAD_Data MadData;\r\ngint local_offset;\r\nproto_item *PERF_header_item;\r\nif (!parse_MAD_Common(parentTree, tvb, offset, &MadData))\r\n{\r\nreturn;\r\n}\r\nlocal_offset = *offset;\r\nPERF_header_item = proto_tree_add_item(parentTree, hf_infiniband_smp_data, tvb, local_offset, MAD_DATA_SIZE, ENC_NA); local_offset += MAD_DATA_SIZE;\r\nproto_item_set_text(PERF_header_item, "%s", "APP - Application Specific MAD (Dissector Not Implemented)");\r\n*offset = local_offset;\r\n}\r\nstatic void parse_RESERVED_MANAGEMENT(proto_tree *parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\nMAD_Data MadData;\r\ngint local_offset;\r\nproto_item *PERF_header_item;\r\nif (!parse_MAD_Common(parentTree, tvb, offset, &MadData))\r\n{\r\nreturn;\r\n}\r\nlocal_offset = *offset;\r\nPERF_header_item = proto_tree_add_item(parentTree, hf_infiniband_smp_data, tvb, local_offset, 256, ENC_NA); local_offset += 256;\r\nproto_item_set_text(PERF_header_item, "%s", "RESERVED - Reserved MAD Type (Possible Device Error)");\r\n*offset = local_offset;\r\n}\r\nstatic gboolean parse_MAD_Common(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_Data* MadData)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *MAD_header_item;\r\nproto_tree *MAD_header_tree;\r\nif (MadData == NULL)\r\nreturn FALSE;\r\nif (!tvb_bytes_exist(tvb, *offset, 256))\r\nreturn FALSE;\r\nMadData->managementClass = tvb_get_guint8(tvb, local_offset + 1);\r\nMadData->classVersion = tvb_get_guint8(tvb, local_offset + 2);\r\nMadData->method = tvb_get_guint8(tvb, local_offset + 3);\r\nMadData->status = tvb_get_guint8(tvb, local_offset + 4);\r\nMadData->classSpecific = tvb_get_ntohs(tvb, local_offset + 6);\r\nMadData->transactionID = tvb_get_ntoh64(tvb, local_offset + 8);\r\nMadData->attributeID = tvb_get_ntohs(tvb, local_offset + 16);\r\nMadData->attributeModifier = tvb_get_ntohl(tvb, local_offset + 20);\r\ntvb_memcpy(tvb, MadData->data, local_offset + 24, MAD_DATA_SIZE);\r\nMAD_header_item = proto_tree_add_item(parentTree, hf_infiniband_MAD, tvb, local_offset, 256, ENC_NA);\r\nproto_item_set_text(MAD_header_item, "%s", "MAD Header - Common Management Datagram");\r\nMAD_header_tree = proto_item_add_subtree(MAD_header_item, ett_mad);\r\nproto_tree_add_item(MAD_header_tree, hf_infiniband_base_version, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(MAD_header_tree, hf_infiniband_mgmt_class, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(MAD_header_tree, hf_infiniband_class_version, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(MAD_header_tree, hf_infiniband_method, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(MAD_header_tree, hf_infiniband_status, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(MAD_header_tree, hf_infiniband_class_specific, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(MAD_header_tree, hf_infiniband_transaction_id, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(MAD_header_tree, hf_infiniband_attribute_id, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(MAD_header_tree, hf_infiniband_reserved16, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(MAD_header_tree, hf_infiniband_attribute_modifier, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nproto_tree_add_item(MAD_header_tree, hf_infiniband_data, tvb, local_offset, MAD_DATA_SIZE, ENC_NA);\r\n*offset = local_offset;\r\nreturn TRUE;\r\n}\r\nstatic gboolean parse_RMPP(proto_tree *parentTree, tvbuff_t *tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nguint8 RMPP_Type = tvb_get_guint8(tvb, local_offset + 1);\r\nproto_item *RMPP_header_item;\r\nproto_tree *RMPP_header_tree;\r\nRMPP_header_item = proto_tree_add_item(parentTree, hf_infiniband_RMPP, tvb, local_offset, 12, ENC_NA);\r\nproto_item_set_text(RMPP_header_item, "%s", val_to_str(RMPP_Type, RMPP_Packet_Types, "Reserved RMPP Type! (0x%02x)"));\r\nRMPP_header_tree = proto_item_add_subtree(RMPP_header_item, ett_rmpp);\r\nproto_tree_add_item(RMPP_header_tree, hf_infiniband_rmpp_version, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(RMPP_header_tree, hf_infiniband_rmpp_type, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(RMPP_header_tree, hf_infiniband_r_resp_time, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(RMPP_header_tree, hf_infiniband_rmpp_flags, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(RMPP_header_tree, hf_infiniband_rmpp_status, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nswitch (RMPP_Type)\r\n{\r\ncase RMPP_NOT_USED:\r\nproto_tree_add_item(RMPP_header_tree, hf_infiniband_rmpp_data1, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nproto_tree_add_item(RMPP_header_tree, hf_infiniband_rmpp_data2, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nbreak;\r\ncase RMPP_DATA:\r\nproto_tree_add_item(RMPP_header_tree, hf_infiniband_segment_number, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nproto_tree_add_item(RMPP_header_tree, hf_infiniband_payload_length32, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nproto_tree_add_item(RMPP_header_tree, hf_infiniband_transferred_data, tvb, local_offset, 220, ENC_NA);\r\nbreak;\r\ncase RMPP_ACK:\r\nproto_tree_add_item(RMPP_header_tree, hf_infiniband_segment_number, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nproto_tree_add_item(RMPP_header_tree, hf_infiniband_new_window_last, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nproto_tree_add_item(RMPP_header_tree, hf_infiniband_reserved220, tvb, local_offset, 220, ENC_NA);\r\nbreak;\r\ncase RMPP_STOP:\r\ncase RMPP_ABORT:\r\nproto_tree_add_item(RMPP_header_tree, hf_infiniband_reserved32, tvb, local_offset, 4, ENC_NA); local_offset += 4;\r\nproto_tree_add_item(RMPP_header_tree, hf_infiniband_reserved32, tvb, local_offset, 4, ENC_NA); local_offset += 4;\r\nproto_tree_add_item(RMPP_header_tree, hf_infiniband_optional_extended_error_data, tvb, local_offset, 220, ENC_NA);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n*offset = local_offset;\r\nreturn TRUE;\r\n}\r\nstatic void label_SUBM_Method(proto_item *SubMItem, MAD_Data *MadHeader, packet_info *pinfo)\r\n{\r\nconst char *label = val_to_str_const(MadHeader->method, SUBM_Methods, "(Unknown SubManagement Method!)");\r\nproto_item_append_text(SubMItem, "%s", label);\r\ncol_append_str(pinfo->cinfo, COL_INFO, label);\r\n}\r\nstatic void label_SUBA_Method(proto_item *SubAItem, MAD_Data *MadHeader, packet_info *pinfo)\r\n{\r\nconst char *label = val_to_str_const(MadHeader->method, SUBA_Methods, "(Unknown SubAdministration Method!)");\r\nproto_item_append_text(SubAItem, "%s", label);\r\ncol_append_str(pinfo->cinfo, COL_INFO, label);\r\n}\r\nstatic void label_SUBM_Attribute(proto_item *SubMItem, MAD_Data *MadHeader, packet_info *pinfo)\r\n{\r\nconst char *label = val_to_str_const(MadHeader->attributeID, SUBM_Attributes, "(Unknown SubManagement Attribute!)");\r\nproto_item_append_text(SubMItem, "%s", &label[11]);\r\ncol_append_str(pinfo->cinfo, COL_INFO, &label[11]);\r\n}\r\nstatic void label_SUBA_Attribute(proto_item *SubAItem, MAD_Data *MadHeader, packet_info *pinfo)\r\n{\r\nconst char *label = val_to_str_const(MadHeader->attributeID, SUBA_Attributes, "(Unknown SubAdministration Attribute!)");\r\nproto_item_append_text(SubAItem, "%s", &label[11]);\r\ncol_append_str(pinfo->cinfo, COL_INFO, &label[11]);\r\n}\r\nstatic gboolean parse_SUBM_Attribute(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_Data *MadHeader)\r\n{\r\nguint16 attributeID = MadHeader->attributeID;\r\nproto_item *SUBM_Attribute_header_item;\r\nproto_tree *SUBM_Attribute_header_tree;\r\nSUBM_Attribute_header_item = proto_tree_add_item(parentTree, hf_infiniband_smp_data, tvb, *offset, 64, ENC_NA);\r\nproto_item_set_text(SUBM_Attribute_header_item, "%s", val_to_str(attributeID, SUBM_Attributes, "Unknown Attribute Type! (0x%02x)"));\r\nSUBM_Attribute_header_tree = proto_item_add_subtree(SUBM_Attribute_header_item, ett_subm_attribute);\r\nswitch (attributeID)\r\n{\r\ncase 0x0002:\r\nparse_NoticesAndTraps(SUBM_Attribute_header_tree , tvb, offset);\r\nbreak;\r\ncase 0x0010:\r\nparse_NodeDescription(SUBM_Attribute_header_tree , tvb, offset);\r\nbreak;\r\ncase 0x0011:\r\nparse_NodeInfo(SUBM_Attribute_header_tree , tvb, offset);\r\nbreak;\r\ncase 0x0012:\r\nparse_SwitchInfo(SUBM_Attribute_header_tree , tvb, offset);\r\nbreak;\r\ncase 0x0014:\r\nparse_GUIDInfo(SUBM_Attribute_header_tree , tvb, offset);\r\nbreak;\r\ncase 0x0015:\r\nparse_PortInfo(SUBM_Attribute_header_tree , tvb, offset);\r\nbreak;\r\ncase 0x0016:\r\nparse_P_KeyTable(SUBM_Attribute_header_tree , tvb, offset);\r\nbreak;\r\ncase 0x0017:\r\nparse_SLtoVLMappingTable(SUBM_Attribute_header_tree , tvb, offset);\r\nbreak;\r\ncase 0x0018:\r\nparse_VLArbitrationTable(SUBM_Attribute_header_tree , tvb, offset);\r\nbreak;\r\ncase 0x0019:\r\nparse_LinearForwardingTable(SUBM_Attribute_header_tree , tvb, offset);\r\nbreak;\r\ncase 0x001A:\r\nparse_RandomForwardingTable(SUBM_Attribute_header_tree , tvb, offset);\r\nbreak;\r\ncase 0x001B:\r\nparse_MulticastForwardingTable(SUBM_Attribute_header_tree , tvb, offset);\r\nbreak;\r\ncase 0x001C:\r\nparse_SMInfo(SUBM_Attribute_header_tree , tvb, offset);\r\nbreak;\r\ncase 0x0020:\r\nparse_VendorDiag(SUBM_Attribute_header_tree , tvb, offset);\r\nbreak;\r\ncase 0x0030:\r\nparse_LedInfo(SUBM_Attribute_header_tree , tvb, offset);\r\nbreak;\r\ncase 0x0031:\r\nparse_LinkSpeedWidthPairsTable(SUBM_Attribute_header_tree , tvb, offset);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n*offset += 64;\r\nreturn TRUE;\r\n}\r\nstatic gboolean parse_SUBA_Attribute(proto_tree *parentTree, tvbuff_t *tvb, gint *offset, MAD_Data *MadHeader)\r\n{\r\nguint16 attributeID = MadHeader->attributeID;\r\nproto_item *SUBA_Attribute_header_item;\r\nproto_tree *SUBA_Attribute_header_tree;\r\nSUBA_Attribute_header_item = proto_tree_add_item(parentTree, hf_infiniband_SA, tvb, *offset, 200, ENC_NA);\r\nproto_item_set_text(SUBA_Attribute_header_item, "%s", val_to_str(attributeID, SUBA_Attributes, "Unknown Attribute Type! (0x%02x)"));\r\nSUBA_Attribute_header_tree = proto_item_add_subtree(SUBA_Attribute_header_item, ett_suba_attribute);\r\nparse_RID(SUBA_Attribute_header_tree, tvb, offset, MadHeader);\r\nswitch (MadHeader->attributeID)\r\n{\r\ncase 0x0001:\r\nparse_PortInfo(SUBA_Attribute_header_tree, tvb, offset);\r\nbreak;\r\ncase 0x0002:\r\nparse_NoticesAndTraps(SUBA_Attribute_header_tree, tvb, offset);\r\nbreak;\r\ncase 0x0003:\r\nparse_InformInfo(SUBA_Attribute_header_tree, tvb, offset);\r\nbreak;\r\ncase 0x0011:\r\nparse_NodeInfo(SUBA_Attribute_header_tree, tvb, offset);\r\n*offset += 40;\r\nparse_NodeDescription(SUBA_Attribute_header_tree, tvb, offset);\r\nbreak;\r\ncase 0x0012:\r\nparse_PortInfo(SUBA_Attribute_header_tree, tvb, offset);\r\nbreak;\r\ncase 0x0013:\r\nparse_SLtoVLMappingTable(SUBA_Attribute_header_tree, tvb, offset);\r\nbreak;\r\ncase 0x0014:\r\nparse_SwitchInfo(SUBA_Attribute_header_tree, tvb, offset);\r\nbreak;\r\ncase 0x0015:\r\nparse_LinearForwardingTable(SUBA_Attribute_header_tree, tvb, offset);\r\nbreak;\r\ncase 0x0016:\r\nparse_RandomForwardingTable(SUBA_Attribute_header_tree, tvb, offset);\r\nbreak;\r\ncase 0x0017:\r\nparse_MulticastForwardingTable(SUBA_Attribute_header_tree, tvb, offset);\r\nbreak;\r\ncase 0x0018:\r\nparse_SMInfo(SUBA_Attribute_header_tree, tvb, offset);\r\nbreak;\r\ncase 0x0019:\r\nparse_LinkSpeedWidthPairsTable(SUBA_Attribute_header_tree, tvb, offset);\r\nbreak;\r\ncase 0x00F3:\r\nparse_InformInfo(SUBA_Attribute_header_tree, tvb, offset);\r\nbreak;\r\ncase 0x0020:\r\nparse_LinkRecord(SUBA_Attribute_header_tree, tvb, offset);\r\nbreak;\r\ncase 0x0030:\r\nparse_GUIDInfo(SUBA_Attribute_header_tree, tvb, offset);\r\nbreak;\r\ncase 0x0031:\r\nparse_ServiceRecord(SUBA_Attribute_header_tree, tvb, offset);\r\nbreak;\r\ncase 0x0033:\r\nparse_P_KeyTable(SUBA_Attribute_header_tree, tvb, offset);\r\nbreak;\r\ncase 0x0035:\r\nparse_PathRecord(SUBA_Attribute_header_tree, tvb, offset);\r\nbreak;\r\ncase 0x0036:\r\nparse_VLArbitrationTable(SUBA_Attribute_header_tree, tvb, offset);\r\nbreak;\r\ncase 0x0038:\r\nparse_MCMemberRecord(SUBA_Attribute_header_tree, tvb, offset);\r\nbreak;\r\ncase 0x0039:\r\nparse_TraceRecord(SUBA_Attribute_header_tree, tvb, offset);\r\nbreak;\r\ncase 0x003A:\r\nparse_MultiPathRecord(SUBA_Attribute_header_tree, tvb, offset);\r\nbreak;\r\ncase 0x003B:\r\nparse_ServiceAssociationRecord(SUBA_Attribute_header_tree, tvb, offset);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n*offset += 200;\r\nreturn TRUE;\r\n}\r\nstatic gint parse_NoticeDataDetails(proto_tree* parentTree, tvbuff_t* tvb, gint *offset, guint16 trapNumber)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *DataDetails_header_item;\r\nproto_tree *DataDetails_header_tree;\r\nif (!parentTree)\r\nreturn 0;\r\nDataDetails_header_item = proto_tree_add_item(parentTree, hf_infiniband_smp_data, tvb, local_offset, 54, ENC_NA);\r\nDataDetails_header_tree = proto_item_add_subtree(DataDetails_header_item, ett_datadetails);\r\nswitch (trapNumber)\r\n{\r\ncase 64:\r\nproto_item_set_text(DataDetails_header_item, "%s", "Trap 64 DataDetails");\r\nlocal_offset += 6;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_GIDADDR, tvb, local_offset, 16, ENC_NA); local_offset += 16;\r\nbreak;\r\ncase 65:\r\nproto_item_set_text(DataDetails_header_item, "%s", "Trap 65 DataDetails");\r\nlocal_offset += 6;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_GIDADDR, tvb, local_offset, 16, ENC_NA); local_offset += 16;\r\nbreak;\r\ncase 66:\r\nproto_item_set_text(DataDetails_header_item, "%s", "Trap 66 DataDetails");\r\nlocal_offset += 6;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_GIDADDR, tvb, local_offset, 16, ENC_NA); local_offset += 16;\r\nbreak;\r\ncase 67:\r\nproto_item_set_text(DataDetails_header_item, "%s", "Trap 67 DataDetails");\r\nlocal_offset += 6;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_GIDADDR, tvb, local_offset, 16, ENC_NA); local_offset += 16;\r\nbreak;\r\ncase 68:\r\nproto_item_set_text(DataDetails_header_item, "%s", "Trap 68 DataDetails");\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_COMP_MASK, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_WAIT_FOR_REPATH, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 69:\r\nproto_item_set_text(DataDetails_header_item, "%s", "Trap 69 DataDetails");\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_COMP_MASK, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_WAIT_FOR_REPATH, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 128:\r\nproto_item_set_text(DataDetails_header_item, "%s", "Trap 128 DataDetails");\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_LIDADDR, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nbreak;\r\ncase 129:\r\nproto_item_set_text(DataDetails_header_item, "%s", "Trap 129 DataDetails");\r\nlocal_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_LIDADDR, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_PORTNO, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nbreak;\r\ncase 130:\r\nproto_item_set_text(DataDetails_header_item, "%s", "Trap 130 DataDetails");\r\nlocal_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_LIDADDR, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_PORTNO, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nbreak;\r\ncase 131:\r\nproto_item_set_text(DataDetails_header_item, "%s", "Trap 131 DataDetails");\r\nlocal_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_LIDADDR, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_PORTNO, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nbreak;\r\ncase 144:\r\nproto_item_set_text(DataDetails_header_item, "%s", "Trap 144 DataDetails");\r\nlocal_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_LIDADDR, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nlocal_offset += 1;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_OtherLocalChanges, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_CAPABILITYMASK, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nlocal_offset += 1;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_LinkSpeecEnabledChange, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_LinkWidthEnabledChange, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_NodeDescriptionChange, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 145:\r\nproto_item_set_text(DataDetails_header_item, "%s", "Trap 145 DataDetails");\r\nlocal_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_LIDADDR, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nlocal_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_SYSTEMIMAGEGUID, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nbreak;\r\ncase 256:\r\nproto_item_set_text(DataDetails_header_item, "%s", "Trap 256 DataDetails");\r\nlocal_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_LIDADDR, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_DRSLID, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_METHOD, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nlocal_offset += 1;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_ATTRIBUTEID, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_ATTRIBUTEMODIFIER, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_MKEY, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nlocal_offset += 1;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_DRNotice, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_DRPathTruncated, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_DRHopCount, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_DRNoticeReturnPath, tvb, local_offset, 30, ENC_NA); local_offset += 30;\r\nbreak;\r\ncase 257:\r\nproto_item_set_text(DataDetails_header_item, "%s", "Trap 257 DataDetails");\r\nlocal_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_LIDADDR1, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_LIDADDR2, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_KEY, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_SL, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_QP1, tvb, local_offset, 3, ENC_BIG_ENDIAN); local_offset += 3;\r\nlocal_offset += 1;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_QP2, tvb, local_offset, 3, ENC_BIG_ENDIAN); local_offset += 3;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_GIDADDR1, tvb, local_offset, 16, ENC_NA); local_offset += 16;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_GIDADDR2, tvb, local_offset, 16, ENC_NA); local_offset += 16;\r\nbreak;\r\ncase 258:\r\nproto_item_set_text(DataDetails_header_item, "%s", "Trap 258 DataDetails");\r\nlocal_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_LIDADDR1, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_LIDADDR2, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_KEY, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_SL, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_QP1, tvb, local_offset, 3, ENC_BIG_ENDIAN); local_offset += 3;\r\nlocal_offset += 1;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_QP2, tvb, local_offset, 3, ENC_BIG_ENDIAN); local_offset += 3;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_GIDADDR1, tvb, local_offset, 16, ENC_NA); local_offset += 16;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_GIDADDR2, tvb, local_offset, 16, ENC_NA); local_offset += 16;\r\nbreak;\r\ncase 259:\r\nproto_item_set_text(DataDetails_header_item, "%s", "Trap 259 DataDetails");\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_DataValid, tvb, local_offset, 2, ENC_NA); local_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_LIDADDR1, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_LIDADDR2, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_PKEY, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_SL, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_QP1, tvb, local_offset, 3, ENC_BIG_ENDIAN); local_offset += 3;\r\nlocal_offset += 1;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_QP2, tvb, local_offset, 3, ENC_BIG_ENDIAN); local_offset += 3;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_GIDADDR1, tvb, local_offset, 16, ENC_NA); local_offset += 16;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_GIDADDR2, tvb, local_offset, 16, ENC_NA); local_offset += 16;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_SWLIDADDR, tvb, local_offset, 2, ENC_NA); local_offset += 2;\r\nproto_tree_add_item(DataDetails_header_tree, hf_infiniband_Trap_PORTNO, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nbreak;\r\ndefault:\r\nproto_item_set_text(DataDetails_header_item, "%s", "Vendor Specific Subnet Management Trap"); local_offset += 54;\r\nbreak;\r\n}\r\nreturn local_offset;\r\n}\r\nstatic void parse_NoticesAndTraps(proto_tree* parentTree, tvbuff_t* tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *NoticesAndTraps_header_item;\r\nproto_tree *NoticesAndTraps_header_tree;\r\nguint16 trapNumber = tvb_get_ntohs(tvb, local_offset + 4);\r\nif (!parentTree)\r\nreturn;\r\nNoticesAndTraps_header_item = proto_tree_add_item(parentTree, hf_infiniband_smp_data, tvb, local_offset, 64, ENC_NA);\r\nproto_item_set_text(NoticesAndTraps_header_item, "%s", val_to_str(trapNumber, Trap_Description, "Unknown or Vendor Specific Trap Number! (0x%02x)"));\r\nNoticesAndTraps_header_tree = proto_item_add_subtree(NoticesAndTraps_header_item, ett_noticestraps);\r\nproto_tree_add_item(NoticesAndTraps_header_tree, hf_infiniband_Notice_IsGeneric, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(NoticesAndTraps_header_tree, hf_infiniband_Notice_Type, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(NoticesAndTraps_header_tree, hf_infiniband_Notice_ProducerTypeVendorID, tvb, local_offset, 3, ENC_BIG_ENDIAN); local_offset += 3;\r\nproto_tree_add_item(NoticesAndTraps_header_tree, hf_infiniband_Notice_TrapNumberDeviceID, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(NoticesAndTraps_header_tree, hf_infiniband_Notice_IssuerLID, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(NoticesAndTraps_header_tree, hf_infiniband_Notice_NoticeToggle, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(NoticesAndTraps_header_tree, hf_infiniband_Notice_NoticeCount, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nparse_NoticeDataDetails(NoticesAndTraps_header_tree, tvb, &local_offset, trapNumber);\r\nproto_tree_add_item(NoticesAndTraps_header_tree, hf_infiniband_Notice_DataDetails, tvb, local_offset, 54, ENC_NA); local_offset += 54;\r\n#if 0\r\n*proto_tree_add_item(NoticesAndTraps_header_tree, hf_infiniband_Notice_IssuerGID, tvb, local_offset, 16, ENC_NA); local_offset += 16;\r\n*proto_tree_add_item(NoticesAndTraps_header_tree, hf_infiniband_Notice_ClassTrapSpecificData, tvb, local_offset, 1, ENC_NA); local_offset += 1;\r\n#endif\r\n}\r\nstatic void parse_NodeDescription(proto_tree* parentTree, tvbuff_t* tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_tree *NodeDescription_header_tree;\r\nif (!parentTree)\r\nreturn;\r\nNodeDescription_header_tree = parentTree;\r\nproto_tree_add_item(NodeDescription_header_tree, hf_infiniband_NodeDescription_NodeString, tvb, local_offset, 64, ENC_ASCII|ENC_NA);\r\n}\r\nstatic int parse_NodeInfo(proto_tree* parentTree, tvbuff_t* tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_tree *NodeInfo_header_tree;\r\nif (!parentTree)\r\nreturn *offset;\r\nNodeInfo_header_tree = parentTree;\r\nproto_tree_add_item(NodeInfo_header_tree, hf_infiniband_NodeInfo_BaseVersion, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(NodeInfo_header_tree, hf_infiniband_NodeInfo_ClassVersion, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(NodeInfo_header_tree, hf_infiniband_NodeInfo_NodeType, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(NodeInfo_header_tree, hf_infiniband_NodeInfo_NumPorts, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(NodeInfo_header_tree, hf_infiniband_NodeInfo_SystemImageGUID, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(NodeInfo_header_tree, hf_infiniband_NodeInfo_NodeGUID, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(NodeInfo_header_tree, hf_infiniband_NodeInfo_PortGUID, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(NodeInfo_header_tree, hf_infiniband_NodeInfo_PartitionCap, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(NodeInfo_header_tree, hf_infiniband_NodeInfo_DeviceID, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(NodeInfo_header_tree, hf_infiniband_NodeInfo_Revision, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nproto_tree_add_item(NodeInfo_header_tree, hf_infiniband_NodeInfo_LocalPortNum, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(NodeInfo_header_tree, hf_infiniband_NodeInfo_VendorID, tvb, local_offset, 3, ENC_BIG_ENDIAN); local_offset += 3;\r\nreturn local_offset;\r\n}\r\nstatic int parse_SwitchInfo(proto_tree* parentTree, tvbuff_t* tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_tree *SwitchInfo_header_tree;\r\nif (!parentTree)\r\nreturn *offset;\r\nSwitchInfo_header_tree = parentTree;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_infiniband_SwitchInfo_LinearFDBCap, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_infiniband_SwitchInfo_RandomFDBCap, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_infiniband_SwitchInfo_MulticastFDBCap, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_infiniband_SwitchInfo_LinearFDBTop, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_infiniband_SwitchInfo_DefaultPort, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_infiniband_SwitchInfo_DefaultMulticastPrimaryPort, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_infiniband_SwitchInfo_DefaultMulticastNotPrimaryPort, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_infiniband_SwitchInfo_LifeTimeValue, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_infiniband_SwitchInfo_PortStateChange, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_infiniband_SwitchInfo_OptimizedSLtoVLMappingProgramming, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_infiniband_SwitchInfo_LIDsPerPort, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_infiniband_SwitchInfo_PartitionEnforcementCap, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_infiniband_SwitchInfo_InboundEnforcementCap, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_infiniband_SwitchInfo_OutboundEnforcementCap, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_infiniband_SwitchInfo_FilterRawInboundCap, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_infiniband_SwitchInfo_FilterRawOutboundCap, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(SwitchInfo_header_tree, hf_infiniband_SwitchInfo_EnhancedPortZero, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nreturn local_offset;\r\n}\r\nstatic int parse_GUIDInfo(proto_tree* parentTree, tvbuff_t* tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_tree *GUIDInfo_header_tree;\r\nproto_item *tempItemLow;\r\ngint i;\r\nif (!parentTree)\r\nreturn *offset;\r\nGUIDInfo_header_tree = parentTree;\r\nfor (i = 0; i < 8; i++)\r\n{\r\ntempItemLow = proto_tree_add_item(GUIDInfo_header_tree, hf_infiniband_GUIDInfo_GUID, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_item_append_text(tempItemLow, "(%u)", i);\r\n}\r\nreturn local_offset;\r\n}\r\nstatic int parse_PortInfo(proto_tree* parentTree, tvbuff_t* tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_tree *PortInfo_header_tree;\r\nproto_item *PortInfo_CapabilityMask_item;\r\nproto_tree *PortInfo_CapabilityMask_tree;\r\nproto_item *temp_item;\r\nguint16 temp_val;\r\nif (!parentTree)\r\nreturn *offset;\r\nPortInfo_header_tree = parentTree;\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_M_Key, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_GidPrefix, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_LID, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_MasterSMLID, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nPortInfo_CapabilityMask_item = proto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_CapabilityMask, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nPortInfo_CapabilityMask_tree = proto_item_add_subtree(PortInfo_CapabilityMask_item, ett_portinfo_capmask);\r\nproto_tree_add_item(PortInfo_CapabilityMask_tree, hf_infiniband_PortInfo_CapabilityMask_SM, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_CapabilityMask_tree, hf_infiniband_PortInfo_CapabilityMask_NoticeSupported, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_CapabilityMask_tree, hf_infiniband_PortInfo_CapabilityMask_TrapSupported, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_CapabilityMask_tree, hf_infiniband_PortInfo_CapabilityMask_OptionalPDSupported, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_CapabilityMask_tree, hf_infiniband_PortInfo_CapabilityMask_AutomaticMigrationSupported, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_CapabilityMask_tree, hf_infiniband_PortInfo_CapabilityMask_SLMappingSupported, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_CapabilityMask_tree, hf_infiniband_PortInfo_CapabilityMask_MKeyNVRAM, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_CapabilityMask_tree, hf_infiniband_PortInfo_CapabilityMask_PKeyNVRAM, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_CapabilityMask_tree, hf_infiniband_PortInfo_CapabilityMask_LEDInfoSupported, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_CapabilityMask_tree, hf_infiniband_PortInfo_CapabilityMask_SMdisabled, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_CapabilityMask_tree, hf_infiniband_PortInfo_CapabilityMask_SystemImageGUIDSupported, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_CapabilityMask_tree, hf_infiniband_PortInfo_CapabilityMask_PKeySwitchExternalPortTrapSupported, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_CapabilityMask_tree, hf_infiniband_PortInfo_CapabilityMask_CommunicationsManagementSupported, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_CapabilityMask_tree, hf_infiniband_PortInfo_CapabilityMask_SNMPTunnelingSupported, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_CapabilityMask_tree, hf_infiniband_PortInfo_CapabilityMask_ReinitSupported, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_CapabilityMask_tree, hf_infiniband_PortInfo_CapabilityMask_DeviceManagementSupported, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_CapabilityMask_tree, hf_infiniband_PortInfo_CapabilityMask_VendorClassSupported, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_CapabilityMask_tree, hf_infiniband_PortInfo_CapabilityMask_DRNoticeSupported, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_CapabilityMask_tree, hf_infiniband_PortInfo_CapabilityMask_CapabilityMaskNoticeSupported, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_CapabilityMask_tree, hf_infiniband_PortInfo_CapabilityMask_BootManagementSupported, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_CapabilityMask_tree, hf_infiniband_PortInfo_CapabilityMask_LinkRoundTripLatencySupported, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_CapabilityMask_tree, hf_infiniband_PortInfo_CapabilityMask_ClientRegistrationSupported, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_CapabilityMask_tree, hf_infiniband_PortInfo_CapabilityMask_OtherLocalChangesNoticeSupported, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_CapabilityMask_tree, hf_infiniband_PortInfo_CapabilityMask_LinkSpeedWIdthPairsTableSupported, tvb, local_offset, 4, ENC_BIG_ENDIAN);\r\nlocal_offset += 4;\r\ntemp_item = proto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_DiagCode, tvb, local_offset, 2, ENC_BIG_ENDIAN);\r\ntemp_val = tvb_get_ntohs(tvb, local_offset);\r\nproto_item_append_text(temp_item, ", %s", val_to_str_const(temp_val, DiagCode, "Reserved DiagCode! Possible Error"));\r\nlocal_offset += 2;\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_M_KeyLeasePeriod, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_LocalPortNum, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\ntemp_item = proto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_LinkWidthEnabled, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\ntemp_val = (guint16)tvb_get_guint8(tvb, local_offset);\r\nproto_item_append_text(temp_item, ", %s", val_to_str_const(temp_val, LinkWidthEnabled, "Reserved LinkWidthEnabled Value! Possible Error"));\r\nlocal_offset += 1;\r\ntemp_item = proto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_LinkWidthSupported, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\ntemp_val = (guint16)tvb_get_guint8(tvb, local_offset);\r\nproto_item_append_text(temp_item, ", %s", val_to_str_const(temp_val, LinkWidthSupported, "Reserved LinkWidthSupported Value! Possible Error"));\r\nlocal_offset += 1;\r\ntemp_item = proto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_LinkWidthActive, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\ntemp_val = (guint16)tvb_get_guint8(tvb, local_offset);\r\nproto_item_append_text(temp_item, ", %s", val_to_str_const(temp_val, LinkWidthActive, "Reserved LinkWidthActive Value! Possible Error"));\r\nlocal_offset += 1;\r\ntemp_item = proto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_LinkSpeedSupported, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\ntemp_val = (guint16)tvb_get_guint8(tvb, local_offset);\r\ntemp_val = temp_val & 0x00F0;\r\ntemp_val = temp_val >> 4;\r\nproto_item_append_text(temp_item, ", %s", val_to_str_const(temp_val, LinkSpeedSupported, "Reserved LinkWidthSupported Value! Possible Error"));\r\ntemp_item = proto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_PortState, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\ntemp_val = (guint16)tvb_get_guint8(tvb, local_offset);\r\ntemp_val = temp_val & 0x000F;\r\nproto_item_append_text(temp_item, ", %s", val_to_str_const(temp_val, PortState, "Reserved PortState Value! Possible Error"));\r\nlocal_offset += 1;\r\ntemp_item = proto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_PortPhysicalState, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\ntemp_val = (guint16)tvb_get_guint8(tvb, local_offset);\r\ntemp_val = temp_val & 0x00F0;\r\ntemp_val = temp_val >> 4;\r\nproto_item_append_text(temp_item, ", %s", val_to_str_const(temp_val, PortPhysicalState, "Reserved PortPhysicalState Value! Possible Error"));\r\ntemp_item = proto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_LinkDownDefaultState, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\ntemp_val = (guint16)tvb_get_guint8(tvb, local_offset);\r\ntemp_val = temp_val & 0x000F;\r\nproto_item_append_text(temp_item, ", %s", val_to_str_const(temp_val, LinkDownDefaultState, "Reserved LinkDownDefaultState Value! Possible Error"));\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_M_KeyProtectBits, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_LMC, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\ntemp_item = proto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_LinkSpeedActive, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\ntemp_val = (guint16)tvb_get_guint8(tvb, local_offset);\r\ntemp_val = temp_val & 0x00F0;\r\ntemp_val = temp_val >> 4;\r\nproto_item_append_text(temp_item, ", %s", val_to_str_const(temp_val, LinkSpeedActive, "Reserved LinkSpeedActive Value! Possible Error"));\r\ntemp_item = proto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_LinkSpeedEnabled, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\ntemp_val = (guint16)tvb_get_guint8(tvb, local_offset);\r\ntemp_val = temp_val & 0x000F;\r\nproto_item_append_text(temp_item, ", %s", val_to_str_const(temp_val, LinkSpeedEnabled, "Reserved LinkSpeedEnabled Value! Possible Error"));\r\nlocal_offset += 1;\r\ntemp_item = proto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_NeighborMTU, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\ntemp_val = (guint16)tvb_get_guint8(tvb, local_offset);\r\ntemp_val = temp_val & 0x00F0;\r\ntemp_val = temp_val >> 4;\r\nproto_item_append_text(temp_item, ", %s", val_to_str_const(temp_val, NeighborMTU, "Reserved NeighborMTU Value! Possible Error"));\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_MasterSMSL, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\ntemp_item = proto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_VLCap, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\ntemp_val = (guint16)tvb_get_guint8(tvb, local_offset);\r\ntemp_val = temp_val & 0x00F0;\r\ntemp_val = temp_val >> 4;\r\nproto_item_append_text(temp_item, ", %s", val_to_str_const(temp_val, VLCap, "Reserved VLCap Value! Possible Error"));\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_InitType, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_VLHighLimit, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_VLArbitrationHighCap, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_VLArbitrationLowCap, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_InitTypeReply, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\ntemp_item = proto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_MTUCap, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\ntemp_val = (guint16)tvb_get_guint8(tvb, local_offset);\r\ntemp_val = temp_val & 0x000F;\r\nproto_item_append_text(temp_item, ", %s", val_to_str_const(temp_val, MTUCap, "Reserved MTUCap Value! Possible Error"));\r\nlocal_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_VLStallCount, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_HOQLife, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\ntemp_item = proto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_OperationalVLs, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\ntemp_val = (guint16)tvb_get_guint8(tvb, local_offset);\r\ntemp_val = temp_val & 0x00F0;\r\ntemp_val = temp_val >> 4;\r\nproto_item_append_text(temp_item, ", %s", val_to_str_const(temp_val, OperationalVLs, "Reserved OperationalVLs Value! Possible Error"));\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_PartitionEnforcementInbound, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_PartitionEnforcementOutbound, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_FilterRawInbound, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_FilterRawOutbound, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_M_KeyViolations, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_P_KeyViolations, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_Q_KeyViolations, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_GUIDCap, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_ClientReregister, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_SubnetTimeOut, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_RespTimeValue, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_LocalPhyErrors, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_OverrunErrors, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_MaxCreditHint, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 3;\r\nproto_tree_add_item(PortInfo_header_tree, hf_infiniband_PortInfo_LinkRoundTripLatency, tvb, local_offset, 3, ENC_BIG_ENDIAN); local_offset += 3;\r\nreturn local_offset;\r\n}\r\nstatic void parse_P_KeyTable(proto_tree* parentTree, tvbuff_t* tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\ngint i;\r\nproto_item *P_KeyTable_header_item;\r\nproto_tree *P_KeyTable_header_tree;\r\nproto_item *tempItemLow;\r\nproto_item *tempItemHigh;\r\nif (!parentTree)\r\nreturn;\r\nP_KeyTable_header_item = proto_tree_add_item(parentTree, hf_infiniband_P_KeyTable_P_KeyTableBlock, tvb, local_offset, 64, ENC_NA);\r\nproto_item_set_text(P_KeyTable_header_item, "%s", "P_KeyTable");\r\nP_KeyTable_header_tree = proto_item_add_subtree(P_KeyTable_header_item, ett_pkeytable);\r\nfor (i = 0; i < 32; i++)\r\n{\r\ntempItemLow = proto_tree_add_item(P_KeyTable_header_tree, hf_infiniband_P_KeyTable_MembershipType, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\ntempItemHigh = proto_tree_add_item(P_KeyTable_header_tree, hf_infiniband_P_KeyTable_P_KeyBase, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_item_append_text(tempItemLow, "(%u)", i);\r\nproto_item_append_text(tempItemHigh, "(%u)", i+1);\r\n}\r\n}\r\nstatic void parse_SLtoVLMappingTable(proto_tree* parentTree, tvbuff_t* tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *SLtoVLMappingTable_header_item;\r\nproto_tree *SLtoVLMappingTable_header_tree;\r\nproto_item *tempItemLow;\r\nproto_item *tempItemHigh;\r\ngint i;\r\nif (!parentTree)\r\nreturn;\r\nSLtoVLMappingTable_header_item = proto_tree_add_item(parentTree, hf_infiniband_smp_data, tvb, local_offset, 64, ENC_NA);\r\nproto_item_set_text(SLtoVLMappingTable_header_item, "%s", "SLtoVLMappingTable");\r\nSLtoVLMappingTable_header_tree = proto_item_add_subtree(SLtoVLMappingTable_header_item, ett_sltovlmapping);\r\nfor (i = 0; i < 8; i++)\r\n{\r\ntempItemLow = proto_tree_add_item(SLtoVLMappingTable_header_tree, hf_infiniband_SLtoVLMappingTable_SLtoVL_HighBits, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\ntempItemHigh = proto_tree_add_item(SLtoVLMappingTable_header_tree, hf_infiniband_SLtoVLMappingTable_SLtoVL_LowBits, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_item_append_text(tempItemLow, "(%u)", i);\r\nproto_item_append_text(tempItemHigh, "(%u)", i+1);\r\n}\r\n}\r\nstatic void parse_VLArbitrationTable(proto_tree* parentTree, tvbuff_t* tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\ngint i;\r\nproto_item *VLArbitrationTable_header_item;\r\nproto_tree *VLArbitrationTable_header_tree;\r\nproto_item *tempItemLow;\r\nproto_item *tempItemHigh;\r\nif (!parentTree)\r\nreturn;\r\nVLArbitrationTable_header_item = proto_tree_add_item(parentTree, hf_infiniband_smp_data, tvb, local_offset, 64, ENC_NA);\r\nproto_item_set_text(VLArbitrationTable_header_item, "%s", "VLArbitrationTable");\r\nVLArbitrationTable_header_tree = proto_item_add_subtree(VLArbitrationTable_header_item, ett_vlarbitrationtable);\r\nfor (i = 0; i < 32; i++)\r\n{\r\ntempItemLow = proto_tree_add_item(VLArbitrationTable_header_tree, hf_infiniband_VLArbitrationTable_VL, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\ntempItemHigh = proto_tree_add_item(VLArbitrationTable_header_tree, hf_infiniband_VLArbitrationTable_Weight, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_item_append_text(tempItemLow, "(%u)", i);\r\nproto_item_append_text(tempItemHigh, "(%u)", i);\r\n}\r\n}\r\nstatic void parse_LinearForwardingTable(proto_tree* parentTree, tvbuff_t* tvb, gint *offset)\r\n{\r\ngint i;\r\ngint local_offset = *offset;\r\nproto_item *LinearForwardingTable_header_item;\r\nproto_tree *LinearForwardingTable_header_tree;\r\nproto_item *tempItemLow;\r\nif (!parentTree)\r\nreturn;\r\nLinearForwardingTable_header_item = proto_tree_add_item(parentTree, hf_infiniband_smp_data, tvb, local_offset, 64, ENC_NA);\r\nproto_item_set_text(LinearForwardingTable_header_item, "%s", "LinearForwardingTable");\r\nLinearForwardingTable_header_tree = proto_item_add_subtree(LinearForwardingTable_header_item, ett_linearforwardingtable);\r\nfor (i = 0; i < 64; i++)\r\n{\r\ntempItemLow = proto_tree_add_item(LinearForwardingTable_header_tree, hf_infiniband_LinearForwardingTable_Port, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_item_append_text(tempItemLow, "(%u)", i);\r\n}\r\n}\r\nstatic void parse_RandomForwardingTable(proto_tree* parentTree, tvbuff_t* tvb, gint *offset)\r\n{\r\ngint i;\r\ngint local_offset = *offset;\r\nproto_item *RandomForwardingTable_header_item;\r\nproto_tree *RandomForwardingTable_header_tree;\r\nproto_item *tempItemLow;\r\nif (!parentTree)\r\nreturn;\r\nRandomForwardingTable_header_item = proto_tree_add_item(parentTree, hf_infiniband_smp_data, tvb, local_offset, 64, ENC_NA);\r\nproto_item_set_text(RandomForwardingTable_header_item, "%s", "RandomForwardingTable");\r\nRandomForwardingTable_header_tree = proto_item_add_subtree(RandomForwardingTable_header_item, ett_randomforwardingtable);\r\nfor (i = 0; i < 16; i++)\r\n{\r\ntempItemLow = proto_tree_add_item(RandomForwardingTable_header_tree, hf_infiniband_RandomForwardingTable_LID, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_item_append_text(tempItemLow, "(%u)", i);\r\ntempItemLow = proto_tree_add_item(RandomForwardingTable_header_tree, hf_infiniband_RandomForwardingTable_Valid, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_append_text(tempItemLow, "(%u)", i);\r\ntempItemLow = proto_tree_add_item(RandomForwardingTable_header_tree, hf_infiniband_RandomForwardingTable_LMC, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_item_append_text(tempItemLow, "(%u)", i);\r\ntempItemLow = proto_tree_add_item(RandomForwardingTable_header_tree, hf_infiniband_RandomForwardingTable_Port, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_item_append_text(tempItemLow, "(%u)", i);\r\n}\r\n}\r\nstatic void parse_MulticastForwardingTable(proto_tree* parentTree, tvbuff_t* tvb, gint *offset)\r\n{\r\ngint i;\r\ngint local_offset = *offset;\r\nproto_item *MulticastForwardingTable_header_item;\r\nproto_tree *MulticastForwardingTable_header_tree;\r\nproto_item *tempItemLow;\r\nif (!parentTree)\r\nreturn;\r\nMulticastForwardingTable_header_item = proto_tree_add_item(parentTree, hf_infiniband_smp_data, tvb, local_offset, 64, ENC_NA);\r\nproto_item_set_text(MulticastForwardingTable_header_item, "%s", "MulticastForwardingTable");\r\nMulticastForwardingTable_header_tree = proto_item_add_subtree(MulticastForwardingTable_header_item, ett_multicastforwardingtable);\r\nfor (i = 0; i < 16; i++)\r\n{\r\ntempItemLow = proto_tree_add_item(MulticastForwardingTable_header_tree, hf_infiniband_MulticastForwardingTable_PortMask, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_item_append_text(tempItemLow, "(%u)", i);\r\n}\r\n}\r\nstatic int parse_SMInfo(proto_tree* parentTree, tvbuff_t* tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *SMInfo_header_item;\r\nproto_tree *SMInfo_header_tree;\r\nif (!parentTree)\r\nreturn *offset;\r\nSMInfo_header_item = proto_tree_add_item(parentTree, hf_infiniband_smp_data, tvb, local_offset, 64, ENC_NA);\r\nproto_item_set_text(SMInfo_header_item, "%s", "SMInfo");\r\nSMInfo_header_tree = proto_item_add_subtree(SMInfo_header_item, ett_sminfo);\r\nproto_tree_add_item(SMInfo_header_tree, hf_infiniband_SMInfo_GUID, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(SMInfo_header_tree, hf_infiniband_SMInfo_SM_Key, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(SMInfo_header_tree, hf_infiniband_SMInfo_ActCount, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nproto_tree_add_item(SMInfo_header_tree, hf_infiniband_SMInfo_Priority, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(SMInfo_header_tree, hf_infiniband_SMInfo_SMState, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nreturn local_offset;\r\n}\r\nstatic int parse_VendorDiag(proto_tree* parentTree, tvbuff_t* tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *VendorDiag_header_item;\r\nproto_tree *VendorDiag_header_tree;\r\nif (!parentTree)\r\nreturn *offset;\r\nVendorDiag_header_item = proto_tree_add_item(parentTree, hf_infiniband_smp_data, tvb, local_offset, 64, ENC_NA);\r\nproto_item_set_text(VendorDiag_header_item, "%s", "VendorDiag");\r\nVendorDiag_header_tree = proto_item_add_subtree(VendorDiag_header_item, ett_vendordiag);\r\nproto_tree_add_item(VendorDiag_header_tree, hf_infiniband_VendorDiag_NextIndex, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(VendorDiag_header_tree, hf_infiniband_VendorDiag_DiagData, tvb, local_offset, 62, ENC_NA); local_offset += 62;\r\nreturn local_offset;\r\n}\r\nstatic void parse_LedInfo(proto_tree* parentTree, tvbuff_t* tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *LedInfo_header_item;\r\nproto_tree *LedInfo_header_tree;\r\nif (!parentTree)\r\nreturn;\r\nLedInfo_header_item = proto_tree_add_item(parentTree, hf_infiniband_smp_data, tvb, local_offset, 64, ENC_NA);\r\nproto_item_set_text(LedInfo_header_item, "%s", "LedInfo");\r\nLedInfo_header_tree = proto_item_add_subtree(LedInfo_header_item, ett_ledinfo);\r\nproto_tree_add_item(LedInfo_header_tree, hf_infiniband_LedInfo_LedMask, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic int parse_LinkSpeedWidthPairsTable(proto_tree* parentTree, tvbuff_t* tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *LinkSpeedWidthPairsTable_header_item;\r\nproto_tree *LinkSpeedWidthPairsTable_header_tree;\r\nif (!parentTree)\r\nreturn *offset;\r\nLinkSpeedWidthPairsTable_header_item = proto_tree_add_item(parentTree, hf_infiniband_smp_data, tvb, local_offset, 64, ENC_NA);\r\nproto_item_set_text(LinkSpeedWidthPairsTable_header_item, "%s", "LinkSpeedWidthPairsTable");\r\nLinkSpeedWidthPairsTable_header_tree = proto_item_add_subtree(LinkSpeedWidthPairsTable_header_item, ett_linkspeedwidthpairs);\r\nproto_tree_add_item(LinkSpeedWidthPairsTable_header_tree, hf_infiniband_LinkSpeedWidthPairsTable_NumTables, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(LinkSpeedWidthPairsTable_header_tree, hf_infiniband_LinkSpeedWidthPairsTable_PortMask, tvb, local_offset, 32, ENC_NA); local_offset += 32;\r\nproto_tree_add_item(LinkSpeedWidthPairsTable_header_tree, hf_infiniband_LinkSpeedWidthPairsTable_SpeedTwoFive, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(LinkSpeedWidthPairsTable_header_tree, hf_infiniband_LinkSpeedWidthPairsTable_SpeedFive, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(LinkSpeedWidthPairsTable_header_tree, hf_infiniband_LinkSpeedWidthPairsTable_SpeedTen, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nreturn local_offset;\r\n}\r\nstatic void parse_RID(proto_tree* SA_header_tree, tvbuff_t* tvb, gint *offset, MAD_Data* MadHeader)\r\n{\r\ngint local_offset = *offset;\r\nif (!SA_header_tree)\r\n{\r\nreturn;\r\n}\r\nswitch (MadHeader->attributeID)\r\n{\r\ncase 0x0011:\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_SA_LID, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nlocal_offset += 2;\r\nbreak;\r\ncase 0x0012:\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_SA_EndportLID, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_SA_PortNum, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nlocal_offset += 1;\r\nbreak;\r\ncase 0x0013:\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_SA_LID, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_SA_InputPortNum, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_SA_OutputPortNum, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nlocal_offset += 4;\r\nbreak;\r\ncase 0x0014:\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_SA_LID, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nlocal_offset += 2;\r\nbreak;\r\ncase 0x0015:\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_SA_LID, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_SA_BlockNum_SixteenBit, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nlocal_offset += 4;\r\nbreak;\r\ncase 0x0016:\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_SA_LID, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_SA_BlockNum_SixteenBit, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nlocal_offset += 4;\r\nbreak;\r\ncase 0x0017:\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_SA_LID, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_SA_Position, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_SA_BlockNum_NineBit, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nlocal_offset += 4;\r\nbreak;\r\ncase 0x0036:\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_SA_LID, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_SA_OutputPortNum, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_SA_BlockNum_EightBit, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nlocal_offset += 4;\r\nbreak;\r\ncase 0x0018:\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_SA_LID, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nlocal_offset += 2;\r\nbreak;\r\ncase 0x0033:\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_SA_LID, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_SA_BlockNum_SixteenBit, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_SA_PortNum, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nlocal_offset += 3;\r\nbreak;\r\ncase 0x00F3:\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_InformInfoRecord_SubscriberGID, tvb, local_offset, 16, ENC_NA); local_offset += 16;\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_InformInfoRecord_Enum, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nlocal_offset += 6;\r\nbreak;\r\ncase 0x0020:\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_LinkRecord_FromLID, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_LinkRecord_FromPort, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nbreak;\r\ncase 0x0031:\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_ServiceRecord_ServiceID, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_ServiceRecord_ServiceGID, tvb, local_offset, 16, ENC_NA); local_offset += 16;\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_ServiceRecord_ServiceP_Key, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nlocal_offset += 2;\r\nbreak;\r\ncase 0x0038:\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_MCMemberRecord_MGID, tvb, local_offset, 16, ENC_NA); local_offset += 16;\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_MCMemberRecord_PortGID, tvb, local_offset, 16, ENC_NA); local_offset += 16;\r\nbreak;\r\ncase 0x0030:\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_SA_LID, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(SA_header_tree, hf_infiniband_SA_BlockNum_EightBit, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 2;\r\nlocal_offset += 4;\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n*offset = local_offset;\r\n}\r\nstatic int parse_InformInfo(proto_tree* parentTree, tvbuff_t* tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *InformInfo_header_item;\r\nproto_tree *InformInfo_header_tree;\r\nif (!parentTree)\r\n{\r\nreturn *offset;\r\n}\r\nInformInfo_header_item = proto_tree_add_item(parentTree, hf_infiniband_SA, tvb, local_offset, 36, ENC_NA);\r\nproto_item_set_text(InformInfo_header_item, "%s", "InformInfo");\r\nInformInfo_header_tree = proto_item_add_subtree(InformInfo_header_item, ett_informinfo);\r\nproto_tree_add_item(InformInfo_header_tree, hf_infiniband_InformInfo_GID, tvb, local_offset, 16, ENC_NA); local_offset += 16;\r\nproto_tree_add_item(InformInfo_header_tree, hf_infiniband_InformInfo_LIDRangeBegin, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(InformInfo_header_tree, hf_infiniband_InformInfo_LIDRangeEnd, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nlocal_offset += 2;\r\nproto_tree_add_item(InformInfo_header_tree, hf_infiniband_InformInfo_IsGeneric, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(InformInfo_header_tree, hf_infiniband_InformInfo_Subscribe, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(InformInfo_header_tree, hf_infiniband_InformInfo_Type, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(InformInfo_header_tree, hf_infiniband_InformInfo_TrapNumberDeviceID, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(InformInfo_header_tree, hf_infiniband_InformInfo_QPN, tvb, local_offset, 3, ENC_BIG_ENDIAN); local_offset += 3;\r\nproto_tree_add_item(InformInfo_header_tree, hf_infiniband_InformInfo_RespTimeValue, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nlocal_offset += 1;\r\nproto_tree_add_item(InformInfo_header_tree, hf_infiniband_InformInfo_ProducerTypeVendorID, tvb, local_offset, 3, ENC_BIG_ENDIAN); local_offset += 3;\r\nreturn local_offset;\r\n}\r\nstatic int parse_LinkRecord(proto_tree* parentTree, tvbuff_t* tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *LinkRecord_header_item;\r\nproto_tree *LinkRecord_header_tree;\r\nif (!parentTree)\r\n{\r\nreturn *offset;\r\n}\r\nLinkRecord_header_item = proto_tree_add_item(parentTree, hf_infiniband_SA, tvb, local_offset, 3, ENC_NA);\r\nproto_item_set_text(LinkRecord_header_item, "%s", "LinkRecord");\r\nLinkRecord_header_tree = proto_item_add_subtree(LinkRecord_header_item, ett_linkrecord);\r\nproto_tree_add_item(LinkRecord_header_tree, hf_infiniband_LinkRecord_ToPort, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(LinkRecord_header_tree, hf_infiniband_LinkRecord_ToLID, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nreturn local_offset;\r\n}\r\nstatic int parse_ServiceRecord(proto_tree* parentTree, tvbuff_t* tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *ServiceRecord_header_item;\r\nproto_tree *ServiceRecord_header_tree;\r\nproto_item *tempData;\r\nif (!parentTree)\r\n{\r\nreturn *offset;\r\n}\r\nServiceRecord_header_item = proto_tree_add_item(parentTree, hf_infiniband_SA, tvb, local_offset, 176, ENC_NA);\r\nproto_item_set_text(ServiceRecord_header_item, "%s", "ServiceRecord");\r\nServiceRecord_header_tree = proto_item_add_subtree(ServiceRecord_header_item, ett_servicerecord);\r\nproto_tree_add_item(ServiceRecord_header_tree, hf_infiniband_ServiceRecord_ServiceLease, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nproto_tree_add_item(ServiceRecord_header_tree, hf_infiniband_ServiceRecord_ServiceKey, tvb, local_offset, 16, ENC_NA); local_offset += 16;\r\nproto_tree_add_item(ServiceRecord_header_tree, hf_infiniband_ServiceRecord_ServiceName, tvb, local_offset, 64, ENC_NA); local_offset += 64;\r\ntempData = proto_tree_add_item(ServiceRecord_header_tree, hf_infiniband_ServiceRecord_ServiceData, tvb, local_offset, 16, ENC_NA); local_offset += 16;\r\nproto_item_append_text(tempData, "%s", "(ServiceData 8.1, 8.16)");\r\ntempData = proto_tree_add_item(ServiceRecord_header_tree, hf_infiniband_ServiceRecord_ServiceData, tvb, local_offset, 16, ENC_NA); local_offset += 16;\r\nproto_item_append_text(tempData, "%s", "(ServiceData 16.1, 16.8)");\r\ntempData = proto_tree_add_item(ServiceRecord_header_tree, hf_infiniband_ServiceRecord_ServiceData, tvb, local_offset, 16, ENC_NA); local_offset += 16;\r\nproto_item_append_text(tempData, "%s", "(ServiceData 32.1, 32.4)");\r\ntempData = proto_tree_add_item(ServiceRecord_header_tree, hf_infiniband_ServiceRecord_ServiceData, tvb, local_offset, 16, ENC_NA); local_offset += 16;\r\nproto_item_append_text(tempData, "%s", "(ServiceData 64.1, 64.2)");\r\nreturn local_offset;\r\n}\r\nstatic int parse_PathRecord(proto_tree* parentTree, tvbuff_t* tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *PathRecord_header_item;\r\nproto_tree *PathRecord_header_tree;\r\nif (!parentTree)\r\n{\r\nreturn *offset;\r\n}\r\nPathRecord_header_item = proto_tree_add_item(parentTree, hf_infiniband_SA, tvb, local_offset, 64, ENC_NA);\r\nproto_item_set_text(PathRecord_header_item, "%s", "PathRecord");\r\nPathRecord_header_tree = proto_item_add_subtree(PathRecord_header_item, ett_pathrecord);\r\nlocal_offset += 8;\r\nproto_tree_add_item(PathRecord_header_tree, hf_infiniband_PathRecord_DGID, tvb, local_offset, 16, ENC_NA); local_offset += 16;\r\nproto_tree_add_item(PathRecord_header_tree, hf_infiniband_PathRecord_SGID, tvb, local_offset, 16, ENC_NA); local_offset += 16;\r\nproto_tree_add_item(PathRecord_header_tree, hf_infiniband_PathRecord_DLID, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(PathRecord_header_tree, hf_infiniband_PathRecord_SLID, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(PathRecord_header_tree, hf_infiniband_PathRecord_RawTraffic, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PathRecord_header_tree, hf_infiniband_PathRecord_FlowLabel, tvb, local_offset, 3, ENC_BIG_ENDIAN); local_offset += 3;\r\nproto_tree_add_item(PathRecord_header_tree, hf_infiniband_PathRecord_HopLimit, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(PathRecord_header_tree, hf_infiniband_PathRecord_TClass, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(PathRecord_header_tree, hf_infiniband_PathRecord_Reversible, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PathRecord_header_tree, hf_infiniband_PathRecord_NumbPath, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(PathRecord_header_tree, hf_infiniband_PathRecord_P_Key, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(PathRecord_header_tree, hf_infiniband_PathRecord_SL, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(PathRecord_header_tree, hf_infiniband_PathRecord_MTUSelector, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PathRecord_header_tree, hf_infiniband_PathRecord_MTU, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(PathRecord_header_tree, hf_infiniband_PathRecord_RateSelector, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PathRecord_header_tree, hf_infiniband_PathRecord_Rate, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(PathRecord_header_tree, hf_infiniband_PathRecord_PacketLifeTimeSelector, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(PathRecord_header_tree, hf_infiniband_PathRecord_PacketLifeTime, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(PathRecord_header_tree, hf_infiniband_PathRecord_Preference, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nreturn local_offset;\r\n}\r\nstatic int parse_MCMemberRecord(proto_tree* parentTree, tvbuff_t* tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *MCMemberRecord_header_item;\r\nproto_tree *MCMemberRecord_header_tree;\r\nif (!parentTree)\r\n{\r\nreturn *offset;\r\n}\r\nMCMemberRecord_header_item = proto_tree_add_item(parentTree, hf_infiniband_SA, tvb, local_offset, 64, ENC_NA);\r\nproto_item_set_text(MCMemberRecord_header_item, "%s", "MCMemberRecord");\r\nMCMemberRecord_header_tree = proto_item_add_subtree(MCMemberRecord_header_item, ett_mcmemberrecord);\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_infiniband_MCMemberRecord_Q_Key, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_infiniband_MCMemberRecord_MLID, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_infiniband_MCMemberRecord_MTUSelector, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_infiniband_MCMemberRecord_MTU, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_infiniband_MCMemberRecord_TClass, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_infiniband_MCMemberRecord_P_Key, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_infiniband_MCMemberRecord_RateSelector, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_infiniband_MCMemberRecord_Rate, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_infiniband_MCMemberRecord_PacketLifeTimeSelector, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_infiniband_MCMemberRecord_PacketLifeTime, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_infiniband_MCMemberRecord_SL, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_infiniband_MCMemberRecord_FlowLabel, tvb, local_offset, 3, ENC_BIG_ENDIAN); local_offset += 3;\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_infiniband_MCMemberRecord_HopLimit, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_infiniband_MCMemberRecord_Scope, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_infiniband_MCMemberRecord_JoinState, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(MCMemberRecord_header_tree, hf_infiniband_MCMemberRecord_ProxyJoin, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 3;\r\nreturn local_offset;\r\n}\r\nstatic int parse_TraceRecord(proto_tree* parentTree, tvbuff_t* tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *TraceRecord_header_item;\r\nproto_tree *TraceRecord_header_tree;\r\nif (!parentTree)\r\n{\r\nreturn *offset;\r\n}\r\nTraceRecord_header_item = proto_tree_add_item(parentTree, hf_infiniband_SA, tvb, local_offset, 46, ENC_NA);\r\nproto_item_set_text(TraceRecord_header_item, "%s", "TraceRecord");\r\nTraceRecord_header_tree = proto_item_add_subtree(TraceRecord_header_item, ett_tracerecord);\r\nproto_tree_add_item(TraceRecord_header_tree, hf_infiniband_TraceRecord_GIDPrefix, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(TraceRecord_header_tree, hf_infiniband_TraceRecord_IDGeneration, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nlocal_offset += 1;\r\nproto_tree_add_item(TraceRecord_header_tree, hf_infiniband_TraceRecord_NodeType, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(TraceRecord_header_tree, hf_infiniband_TraceRecord_NodeID, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(TraceRecord_header_tree, hf_infiniband_TraceRecord_ChassisID, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(TraceRecord_header_tree, hf_infiniband_TraceRecord_EntryPortID, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(TraceRecord_header_tree, hf_infiniband_TraceRecord_ExitPortID, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(TraceRecord_header_tree, hf_infiniband_TraceRecord_EntryPort, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(TraceRecord_header_tree, hf_infiniband_TraceRecord_ExitPort, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nreturn local_offset;\r\n}\r\nstatic int parse_MultiPathRecord(proto_tree* parentTree, tvbuff_t* tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *MultiPathRecord_header_item;\r\nproto_tree *MultiPathRecord_header_tree;\r\nproto_item *SDGID;\r\nguint8 SDGIDCount;\r\nguint8 DGIDCount;\r\nguint32 i;\r\nif (!parentTree)\r\n{\r\nreturn *offset;\r\n}\r\nMultiPathRecord_header_item = proto_tree_add_item(parentTree, hf_infiniband_SA, tvb, local_offset, 200, ENC_NA);\r\nproto_item_set_text(MultiPathRecord_header_item, "%s", "MultiPathRecord");\r\nMultiPathRecord_header_tree = proto_item_add_subtree(MultiPathRecord_header_item, ett_multipathrecord);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_infiniband_MultiPathRecord_RawTraffic, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_infiniband_MultiPathRecord_FlowLabel, tvb, local_offset, 3, ENC_BIG_ENDIAN); local_offset += 3;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_infiniband_MultiPathRecord_HopLimit, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_infiniband_MultiPathRecord_TClass, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_infiniband_MultiPathRecord_Reversible, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_infiniband_MultiPathRecord_NumbPath, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_infiniband_MultiPathRecord_P_Key, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_infiniband_MultiPathRecord_SL, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_infiniband_MultiPathRecord_MTUSelector, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_infiniband_MultiPathRecord_MTU, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_infiniband_MultiPathRecord_RateSelector, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_infiniband_MultiPathRecord_Rate, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_infiniband_MultiPathRecord_PacketLifeTimeSelector, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_infiniband_MultiPathRecord_PacketLifeTime, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nlocal_offset += 1;\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_infiniband_MultiPathRecord_IndependenceSelector, tvb, local_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_infiniband_MultiPathRecord_GIDScope, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nSDGIDCount = tvb_get_guint8(tvb, local_offset);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_infiniband_MultiPathRecord_SGIDCount, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nDGIDCount = tvb_get_guint8(tvb, local_offset);\r\nproto_tree_add_item(MultiPathRecord_header_tree, hf_infiniband_MultiPathRecord_DGIDCount, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nlocal_offset += 7;\r\nfor (i = 0; i < SDGIDCount; i++)\r\n{\r\nSDGID = proto_tree_add_item(MultiPathRecord_header_tree, hf_infiniband_MultiPathRecord_SDGID, tvb, local_offset, 16, ENC_NA); local_offset += 16;\r\nproto_item_set_text(SDGID, "(%s%u)", "SGID", i);\r\n}\r\nfor (i = 0; i < DGIDCount; i++)\r\n{\r\nSDGID = proto_tree_add_item(MultiPathRecord_header_tree, hf_infiniband_MultiPathRecord_SDGID, tvb, local_offset, 16, ENC_NA); local_offset += 16;\r\nproto_item_set_text(SDGID, "(%s%u)", "DGID", i);\r\n}\r\nreturn local_offset;\r\n}\r\nstatic int parse_ServiceAssociationRecord(proto_tree* parentTree, tvbuff_t* tvb, gint *offset)\r\n{\r\ngint local_offset = *offset;\r\nproto_item *ServiceAssociationRecord_header_item;\r\nproto_tree *ServiceAssociationRecord_header_tree;\r\nif (!parentTree)\r\n{\r\nreturn *offset;\r\n}\r\nServiceAssociationRecord_header_item = proto_tree_add_item(parentTree, hf_infiniband_SA, tvb, local_offset, 80, ENC_NA);\r\nproto_item_set_text(ServiceAssociationRecord_header_item, "%s", "ServiceAssociationRecord");\r\nServiceAssociationRecord_header_tree = proto_item_add_subtree(ServiceAssociationRecord_header_item, ett_serviceassocrecord);\r\nproto_tree_add_item(ServiceAssociationRecord_header_tree, hf_infiniband_ServiceAssociationRecord_ServiceKey, tvb, local_offset, 16, ENC_NA); local_offset += 16;\r\nproto_tree_add_item(ServiceAssociationRecord_header_tree, hf_infiniband_ServiceAssociationRecord_ServiceName, tvb, local_offset, 64, ENC_ASCII|ENC_NA); local_offset += 64;\r\nreturn local_offset;\r\n}\r\nstatic int parse_PERF_PortCounters(proto_tree* parentTree, tvbuff_t* tvb, packet_info *pinfo, gint *offset)\r\n{\r\nproto_item *perf_item;\r\nproto_tree *perf_tree;\r\ngint local_offset = *offset;\r\ncol_set_str(pinfo->cinfo, COL_INFO, "PERF (PortCounters)");\r\nperf_item = proto_tree_add_item(parentTree, hf_infiniband_PortCounters, tvb, local_offset, 40, ENC_NA);\r\nperf_tree = proto_item_add_subtree(perf_item, ett_perfclass);\r\nlocal_offset += 40;\r\nlocal_offset += 1;\r\nproto_tree_add_item(perf_tree, hf_infiniband_PortCounters_PortSelect, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(perf_tree, hf_infiniband_PortCounters_CounterSelect, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(perf_tree, hf_infiniband_PortCounters_SymbolErrorCounter, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(perf_tree, hf_infiniband_PortCounters_LinkErrorRecoveryCounter, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(perf_tree, hf_infiniband_PortCounters_LinkDownedCounter, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(perf_tree, hf_infiniband_PortCounters_PortRcvErrors, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(perf_tree, hf_infiniband_PortCounters_PortRcvRemotePhysicalErrors, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(perf_tree, hf_infiniband_PortCounters_PortRcvSwitchRelayErrors, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(perf_tree, hf_infiniband_PortCounters_PortXmitDiscards, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(perf_tree, hf_infiniband_PortCounters_PortXmitConstraintErrors, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(perf_tree, hf_infiniband_PortCounters_PortRcvConstraintErrors, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nlocal_offset += 1;\r\nproto_tree_add_bits_item(perf_tree, hf_infiniband_PortCounters_LocalLinkIntegrityErrors, tvb, local_offset*8, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_bits_item(perf_tree, hf_infiniband_PortCounters_ExcessiveBufferOverrunErrors, tvb, local_offset*8 + 4, 4, ENC_BIG_ENDIAN); local_offset += 1;\r\nlocal_offset += 2;\r\nproto_tree_add_item(perf_tree, hf_infiniband_PortCounters_VL15Dropped, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nproto_tree_add_item(perf_tree, hf_infiniband_PortCounters_PortXmitData, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nproto_tree_add_item(perf_tree, hf_infiniband_PortCounters_PortRcvData, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nproto_tree_add_item(perf_tree, hf_infiniband_PortCounters_PortXmitPkts, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\nproto_tree_add_item(perf_tree, hf_infiniband_PortCounters_PortRcvPkts, tvb, local_offset, 4, ENC_BIG_ENDIAN); local_offset += 4;\r\n*offset = local_offset;\r\nreturn local_offset;\r\n}\r\nstatic int parse_PERF_PortCountersExtended(proto_tree* parentTree, tvbuff_t* tvb, packet_info *pinfo, gint *offset)\r\n{\r\nproto_item *perf_item;\r\nproto_tree *perf_tree;\r\ngint local_offset = *offset;\r\ncol_set_str(pinfo->cinfo, COL_INFO, "PERF (PortCountersExtended)");\r\nperf_item = proto_tree_add_item(parentTree, hf_infiniband_PortCountersExt, tvb, local_offset, 72, ENC_NA);\r\nperf_tree = proto_item_add_subtree(perf_item, ett_perfclass);\r\nlocal_offset += 40;\r\nlocal_offset += 1;\r\nproto_tree_add_item(perf_tree, hf_infiniband_PortCountersExt_PortSelect, tvb, local_offset, 1, ENC_BIG_ENDIAN); local_offset += 1;\r\nproto_tree_add_item(perf_tree, hf_infiniband_PortCountersExt_CounterSelect, tvb, local_offset, 2, ENC_BIG_ENDIAN); local_offset += 2;\r\nlocal_offset += 4;\r\nproto_tree_add_item(perf_tree, hf_infiniband_PortCountersExt_PortXmitData, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(perf_tree, hf_infiniband_PortCountersExt_PortRcvData, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(perf_tree, hf_infiniband_PortCountersExt_PortXmitPkts, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(perf_tree, hf_infiniband_PortCountersExt_PortRcvPkts, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(perf_tree, hf_infiniband_PortCountersExt_PortUnicastXmitPkts, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(perf_tree, hf_infiniband_PortCountersExt_PortUnicastRcvPkts, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(perf_tree, hf_infiniband_PortCountersExt_PortMulticastXmitPkts, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\nproto_tree_add_item(perf_tree, hf_infiniband_PortCountersExt_PortMulticastRcvPkts, tvb, local_offset, 8, ENC_BIG_ENDIAN); local_offset += 8;\r\n*offset = local_offset;\r\nreturn local_offset;\r\n}\r\nstatic void dissect_general_info(tvbuff_t *tvb, gint offset, packet_info *pinfo, ib_packet_start_header starts_with)\r\n{\r\nguint8 lnh_val = 0;\r\ngboolean bthFollows = FALSE;\r\nguint8 virtualLane = 0;\r\ngint32 nextHeaderSequence = -1;\r\nguint8 nxtHdr = 0;\r\nguint8 management_class = 0;\r\nMAD_Data MadData;\r\nstruct infinibandinfo info = { 0, FALSE};\r\ngint bthSize = 12;\r\nvoid *src_addr,\r\n*dst_addr;\r\nif (starts_with == IB_PACKET_STARTS_WITH_GRH) {\r\nlnh_val = IBA_GLOBAL;\r\ngoto skip_lrh;\r\n}\r\nelse if (starts_with == IB_PACKET_STARTS_WITH_BTH) {\r\nlnh_val = IBA_LOCAL;\r\ngoto skip_lrh;\r\n}\r\nvirtualLane = tvb_get_guint8(tvb, offset);\r\nvirtualLane = virtualLane & 0xF0;\r\noffset += 1;\r\nlnh_val = tvb_get_guint8(tvb, offset);\r\nlnh_val = lnh_val & 0x03;\r\noffset += 1;\r\ndst_addr = wmem_alloc(pinfo->pool, sizeof(guint16));\r\n*((guint16*) dst_addr) = tvb_get_ntohs(tvb, offset);\r\nset_address(&pinfo->dst, AT_IB, sizeof(guint16), dst_addr);\r\noffset += 4;\r\nsrc_addr = wmem_alloc(pinfo->pool, sizeof(guint16));\r\n*((guint16*) src_addr) = tvb_get_ntohs(tvb, offset);\r\nset_address(&pinfo->src, AT_IB, sizeof(guint16), src_addr);\r\noffset += 2;\r\nskip_lrh:\r\nswitch (lnh_val)\r\n{\r\ncase IBA_GLOBAL:\r\noffset += 6;\r\nnxtHdr = tvb_get_guint8(tvb, offset);\r\noffset += 2;\r\nset_address_tvb(&pinfo->src, AT_IB, GID_SIZE, tvb, offset);\r\noffset += 16;\r\nset_address_tvb(&pinfo->dst, AT_IB, GID_SIZE, tvb, offset);\r\noffset += 16;\r\nif (nxtHdr != 0x1B)\r\n{\r\nbreak;\r\n}\r\ncase IBA_LOCAL:\r\nbthFollows = TRUE;\r\ninfo.opCode = tvb_get_guint8(tvb, offset);\r\nif ((info.opCode >> 5) == 0x2) {\r\ninfo.dctConnect = !(tvb_get_guint8(tvb, offset + 1) & 0x80);\r\nbthSize += 8;\r\n}\r\ncol_append_str(pinfo->cinfo, COL_INFO, val_to_str_const(info.opCode, OpCodeMap, "Unknown OpCode"));\r\noffset += bthSize;\r\nbreak;\r\ncase IP_NON_IBA:\r\ndst_addr = wmem_strdup(pinfo->pool, "IPv6 over IB Packet");\r\nset_address(&pinfo->dst, AT_STRINGZ, (int)strlen((char *)dst_addr)+1, dst_addr);\r\nbreak;\r\ncase RAW:\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nif (bthFollows)\r\n{\r\nnextHeaderSequence = find_next_header_sequence(&info);\r\nswitch (nextHeaderSequence)\r\n{\r\ncase RDETH_DETH_PAYLD:\r\noffset += 4;\r\noffset += 8;\r\nbreak;\r\ncase RETH_IMMDT_PAYLD:\r\noffset += 16;\r\noffset += 4;\r\nbreak;\r\ncase RDETH_DETH_RETH_PAYLD:\r\noffset += 4;\r\noffset += 8;\r\noffset += 16;\r\nbreak;\r\ncase RDETH_DETH_IMMDT_PAYLD:\r\noffset += 4;\r\noffset += 8;\r\noffset += 4;\r\nbreak;\r\ncase RDETH_DETH_RETH_IMMDT_PAYLD:\r\noffset += 4;\r\noffset += 8;\r\noffset += 16;\r\noffset += 4;\r\nbreak;\r\ncase RDETH_DETH_RETH:\r\noffset += 4;\r\noffset += 8;\r\noffset += 16;\r\nbreak;\r\ncase RDETH_AETH_PAYLD:\r\noffset += 4;\r\noffset += 4;\r\nbreak;\r\ncase RDETH_PAYLD:\r\noffset += 4;\r\nbreak;\r\ncase RDETH_AETH:\r\noffset += 4;\r\noffset += 4;\r\nbreak;\r\ncase RDETH_AETH_ATOMICACKETH:\r\noffset += 4;\r\noffset += 4;\r\noffset += 8;\r\nbreak;\r\ncase RDETH_DETH_ATOMICETH:\r\noffset += 4;\r\noffset += 8;\r\noffset += 28;\r\nbreak;\r\ncase RDETH_DETH:\r\noffset += 4;\r\noffset += 8;\r\nbreak;\r\ncase DETH_PAYLD:\r\noffset += 8;\r\nbreak;\r\ncase PAYLD:\r\nbreak;\r\ncase IMMDT_PAYLD:\r\noffset += 4;\r\nbreak;\r\ncase RETH_PAYLD:\r\noffset += 16;\r\nbreak;\r\ncase RETH:\r\noffset += 16;\r\nbreak;\r\ncase AETH_PAYLD:\r\noffset += 4;\r\nbreak;\r\ncase AETH:\r\noffset += 4;\r\nbreak;\r\ncase AETH_ATOMICACKETH:\r\noffset += 4;\r\noffset += 8;\r\nbreak;\r\ncase ATOMICETH:\r\noffset += 28;\r\nbreak;\r\ncase IETH_PAYLD:\r\noffset += 4;\r\nbreak;\r\ncase DETH_IMMDT_PAYLD:\r\noffset += 8;\r\noffset += 4;\r\nbreak;\r\ncase DCCETH:\r\noffset += 16;\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\nif (virtualLane == 0xF0)\r\n{\r\nmanagement_class = tvb_get_guint8(tvb, offset + 1);\r\nif (((management_class >= (guint8)VENDOR_1_START) && (management_class <= (guint8)VENDOR_1_END))\r\n|| ((management_class >= (guint8)VENDOR_2_START) && (management_class <= (guint8)VENDOR_2_END)))\r\n{\r\nreturn;\r\n}\r\nelse if ((management_class >= (guint8)APPLICATION_START) && (management_class <= (guint8)APPLICATION_END))\r\n{\r\nreturn;\r\n}\r\nelse if (((management_class == (guint8)0x00) || (management_class == (guint8)0x02))\r\n|| ((management_class >= (guint8)0x50) && (management_class <= (guint8)0x80))\r\n|| ((management_class >= (guint8)0x82)))\r\n{\r\nreturn;\r\n}\r\nelse\r\n{\r\nif (parse_MAD_Common(NULL, tvb, &offset, &MadData)) {\r\nlabel_SUBM_Method(NULL, &MadData, pinfo);\r\nlabel_SUBM_Attribute(NULL, &MadData, pinfo);\r\n}\r\n}\r\n}\r\nreturn;\r\n}\r\nvoid proto_register_infiniband(void)\r\n{\r\nmodule_t *infiniband_module;\r\nstatic const value_string mad_method_str[] = {\r\n{ 0x01, "Get()" },\r\n{ 0x02, "Set()" },\r\n{ 0x81, "GetResp()" },\r\n{ 0x03, "Send()" },\r\n{ 0x05, "Trap()" },\r\n{ 0x06, "Report()" },\r\n{ 0x86, "ReportResp()" },\r\n{ 0x07, "TrapRepress()" },\r\n{ 0, NULL }\r\n};\r\nstatic hf_register_info hf[] = {\r\n{ &hf_infiniband_LRH, {\r\n"Local Route Header", "infiniband.lrh",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_virtual_lane, {\r\n"Virtual Lane", "infiniband.lrh.vl",\r\nFT_UINT8, BASE_HEX, NULL, 0xF0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_link_version, {\r\n"Link Version", "infiniband.lrh.lver",\r\nFT_UINT8, BASE_DEC, NULL, 0x0F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_service_level, {\r\n"Service Level", "infiniband.lrh.sl",\r\nFT_UINT8, BASE_DEC, NULL, 0xF0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_reserved2, {\r\n"Reserved (2 bits)", "infiniband.lrh.reserved2",\r\nFT_UINT8, BASE_DEC, NULL, 0x0C, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_link_next_header, {\r\n"Link Next Header", "infiniband.lrh.lnh",\r\nFT_UINT8, BASE_HEX, NULL, 0x03, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_destination_local_id, {\r\n"Destination Local ID", "infiniband.lrh.dlid",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_reserved5, {\r\n"Reserved (5 bits)", "infiniband.lrh.reserved5",\r\nFT_UINT16, BASE_DEC, NULL, 0xF800, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_packet_length, {\r\n"Packet Length", "infiniband.lrh.pktlen",\r\nFT_UINT16, BASE_DEC, NULL, 0x07FF, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_source_local_id, {\r\n"Source Local ID", "infiniband.lrh.slid",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_GRH, {\r\n"Global Route Header", "infiniband.grh",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_ip_version, {\r\n"IP Version", "infiniband.grh.ipver",\r\nFT_UINT8, BASE_DEC, NULL, 0xF0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_traffic_class, {\r\n"Traffic Class", "infiniband.grh.tclass",\r\nFT_UINT16, BASE_DEC, NULL, 0x0FF0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_flow_label, {\r\n"Flow Label", "infiniband.grh.flowlabel",\r\nFT_UINT32, BASE_DEC, NULL, 0x000FFFFF, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_payload_length, {\r\n"Payload Length", "infiniband.grh.paylen",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_next_header, {\r\n"Next Header", "infiniband.grh.nxthdr",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_hop_limit, {\r\n"Hop Limit", "infiniband.grh.hoplmt",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_source_gid, {\r\n"Source GID", "infiniband.grh.sgid",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_destination_gid, {\r\n"Destination GID", "infiniband.grh.dgid",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_BTH, {\r\n"Base Transport Header", "infiniband.bth",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_opcode, {\r\n"Opcode", "infiniband.bth.opcode",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_solicited_event, {\r\n"Solicited Event", "infiniband.bth.se",\r\nFT_BOOLEAN, 8, NULL, 0x80, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_migreq, {\r\n"MigReq", "infiniband.bth.m",\r\nFT_BOOLEAN, 8, NULL, 0x40, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_pad_count, {\r\n"Pad Count", "infiniband.bth.padcnt",\r\nFT_UINT8, BASE_DEC, NULL, 0x30, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_transport_header_version, {\r\n"Header Version", "infiniband.bth.tver",\r\nFT_UINT8, BASE_DEC, NULL, 0x0F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_partition_key, {\r\n"Partition Key", "infiniband.bth.p_key",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_reserved8, {\r\n"Reserved (8 bits)", "infiniband.bth.reserved8",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_destination_qp, {\r\n"Destination Queue Pair", "infiniband.bth.destqp",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_acknowledge_request, {\r\n"Acknowledge Request", "infiniband.bth.a",\r\nFT_BOOLEAN, 8, NULL, 0x80, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_reserved7, {\r\n"Reserved (7 bits)", "infiniband.bth.reserved7",\r\nFT_UINT8, BASE_DEC, NULL, 0x7F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_packet_sequence_number, {\r\n"Packet Sequence Number", "infiniband.bth.psn",\r\nFT_UINT24, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_RWH, {\r\n"Raw Header", "infiniband.rwh",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_reserved16_RWH, {\r\n"Reserved (16 bits)", "infiniband.rwh.reserved",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_etype, {\r\n"Ethertype", "infiniband.rwh.etype",\r\nFT_UINT16, BASE_HEX, NULL , 0x0, "Type", HFILL }\r\n},\r\n{ &hf_infiniband_RDETH, {\r\n"Reliable Datagram Extended Transport Header", "infiniband.rdeth",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_reserved8_RDETH, {\r\n"Reserved (8 bits)", "infiniband.rdeth.reserved8",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_ee_context, {\r\n"E2E Context", "infiniband.rdeth.eecnxt",\r\nFT_UINT24, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_DETH, {\r\n"Datagram Extended Transport Header", "infiniband.deth",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_queue_key, {\r\n"Queue Key", "infiniband.deth.q_key",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_reserved8_DETH, {\r\n"Reserved (8 bits)", "infiniband.deth.reserved8",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_source_qp, {\r\n"Source Queue Pair", "infiniband.deth.srcqp",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_RETH, {\r\n"RDMA Extended Transport Header", "infiniband.reth",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_virtual_address, {\r\n"Virtual Address", "infiniband.reth.va",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_remote_key, {\r\n"Remote Key", "infiniband.reth.r_key",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_dma_length, {\r\n"DMA Length", "infiniband.reth.dmalen",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_AtomicETH, {\r\n"Atomic Extended Transport Header", "infiniband.atomiceth",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n#if 0\r\n{ &hf_infiniband_virtual_address_AtomicETH, {\r\n"Virtual Address", "infiniband.atomiceth.va",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_remote_key_AtomicETH, {\r\n"Remote Key", "infiniband.atomiceth.r_key",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n#endif\r\n{ &hf_infiniband_swap_or_add_data, {\r\n"Swap (Or Add) Data", "infiniband.atomiceth.swapdt",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_compare_data, {\r\n"Compare Data", "infiniband.atomiceth.cmpdt",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_AETH, {\r\n"ACK Extended Transport Header", "infiniband.aeth",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_syndrome, {\r\n"Syndrome", "infiniband.aeth.syndrome",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_message_sequence_number, {\r\n"Message Sequence Number", "infiniband.aeth.msn",\r\nFT_UINT24, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_AtomicAckETH, {\r\n"Atomic ACK Extended Transport Header", "infiniband.atomicacketh",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_original_remote_data, {\r\n"Original Remote Data", "infiniband.atomicacketh.origremdt",\r\nFT_UINT64, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_IMMDT, {\r\n"Immediate Data", "infiniband.immdt",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_IETH, {\r\n"RKey", "infiniband.ieth",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_payload, {\r\n"Payload", "infiniband.payload",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_invariant_crc, {\r\n"Invariant CRC", "infiniband.invariant.crc",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_variant_crc, {\r\n"Variant CRC", "infiniband.variant.crc",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_raw_data, {\r\n"Raw Data", "infiniband.rawdata",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_vendor, {\r\n"Unknown/Vendor Specific Data", "infiniband.vendor",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_local_comm_id, {\r\n"Local Communication ID", "infiniband.cm.req",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_service_id, {\r\n"ServiceID", "infiniband.cm.req.serviceid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_local_ca_guid, {\r\n"Local CA GUID", "infiniband.cm.req.localcaguid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_local_qkey, {\r\n"Local Q_Key", "infiniband.cm.req.localqkey",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_local_qpn, {\r\n"Local QPN", "infiniband.cm.req.localqpn",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_respo_res, {\r\n"Responder Resources", "infiniband.cm.req.responderres",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_local_eecn, {\r\n"Local EECN", "infiniband.cm.req.localeecn",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_init_depth, {\r\n"Initiator Depth", "infiniband.cm.req.initdepth",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_remote_eecn, {\r\n"Remote EECN", "infiniband.cm.req.remoteeecn",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_remote_cm_resp_to, {\r\n"Remote CM Response Timeout", "infiniband.cm.req.remoteresptout",\r\nFT_UINT8, BASE_HEX, NULL, 0x1f, NULL, HFILL}\r\n},\r\n{&hf_cm_req_transp_serv_type, {\r\n"Transport Service Type", "infiniband.cm.req.transpsvctype",\r\nFT_UINT8, BASE_HEX, NULL, 0x60, NULL, HFILL}\r\n},\r\n{&hf_cm_req_e2e_flow_ctrl, {\r\n"End-to-End Flow Control", "infiniband.cm.req.e2eflowctrl",\r\nFT_UINT8, BASE_HEX, NULL, 0x1, NULL, HFILL}\r\n},\r\n{&hf_cm_req_start_psn, {\r\n"Starting PSN", "infiniband.cm.req.startpsn",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_local_cm_resp_to, {\r\n"Local CM Response Timeout", "infiniband.cm.req.localresptout",\r\nFT_UINT8, BASE_HEX, NULL, 0xf8, NULL, HFILL}\r\n},\r\n{&hf_cm_req_retry_count, {\r\n"Retry Count", "infiniband.cm.req.retrcount",\r\nFT_UINT8, BASE_HEX, NULL, 0x7, NULL, HFILL}\r\n},\r\n{&hf_cm_req_pkey, {\r\n"Partition Key", "infiniband.cm.req.pkey",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_path_pp_mtu, {\r\n"Path Packet Payload MTU", "infiniband.cm.req.pppmtu",\r\nFT_UINT8, BASE_HEX, NULL, 0xf0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_rdc_exists, {\r\n"RDC Exists", "infiniband.cm.req.rdcexist",\r\nFT_UINT8, BASE_HEX, NULL, 0x8, NULL, HFILL}\r\n},\r\n{&hf_cm_req_rnr_retry_count, {\r\n"RNR Retry Count", "infiniband.cm.req.rnrretrcount",\r\nFT_UINT8, BASE_HEX, NULL, 0x7, NULL, HFILL}\r\n},\r\n{&hf_cm_req_max_cm_retries, {\r\n"Max CM Retries", "infiniband.cm.req.maxcmretr",\r\nFT_UINT8, BASE_HEX, NULL, 0xf0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_srq, {\r\n"SRQ", "infiniband.cm.req.srq",\r\nFT_UINT8, BASE_HEX, NULL, 0x8, NULL, HFILL}\r\n},\r\n{&hf_cm_req_primary_local_lid, {\r\n"Primary Local Port LID", "infiniband.cm.req.prim_locallid",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_primary_remote_lid, {\r\n"Primary Remote Port LID", "infiniband.cm.req.prim_remotelid",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_primary_local_gid, {\r\n"Primary Local Port GID", "infiniband.cm.req.prim_localgid",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_primary_remote_gid, {\r\n"Primary Remote Port GID", "infiniband.cm.req.prim_remotegid",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_primary_flow_label, {\r\n"Primary Flow Label", "infiniband.cm.req.prim_flowlabel",\r\nFT_UINT24, BASE_HEX, NULL, 0xfffff0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_primary_packet_rate, {\r\n"Primary Packet Rate", "infiniband.cm.req.prim_pktrate",\r\nFT_UINT8, BASE_HEX, NULL, 0x3f, NULL, HFILL}\r\n},\r\n{&hf_cm_req_primary_traffic_class, {\r\n"Primary Traffic Class", "infiniband.cm.req.prim_tfcclass",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_primary_hop_limit, {\r\n"Primary Hop Limit", "infiniband.cm.req.prim_hoplim",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_primary_sl, {\r\n"Primary SL", "infiniband.cm.req.prim_sl",\r\nFT_UINT8, BASE_HEX, NULL, 0xf0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_primary_subnet_local, {\r\n"Primary Subnet Local", "infiniband.cm.req.prim_subnetlocal",\r\nFT_UINT8, BASE_HEX, NULL, 0x8, NULL, HFILL}\r\n},\r\n{&hf_cm_req_primary_local_ack_to, {\r\n"Primary Local ACK Timeout", "infiniband.cm.req.prim_localacktout",\r\nFT_UINT8, BASE_HEX, NULL, 0xf8, NULL, HFILL}\r\n},\r\n{&hf_cm_req_alt_local_lid, {\r\n"Alternate Local Port LID", "infiniband.cm.req.alt_locallid",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_alt_remote_lid, {\r\n"Alternate Remote Port LID", "infiniband.cm.req.alt_remotelid",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_alt_local_gid, {\r\n"Alternate Local Port GID", "infiniband.cm.req.alt_localgid",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_alt_remote_gid, {\r\n"Alternate Remote Port GID", "infiniband.cm.req.alt_remotegid",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_flow_label, {\r\n"Alternate Flow Label", "infiniband.cm.req.alt_flowlabel",\r\nFT_UINT24, BASE_HEX, NULL, 0xfffff0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_packet_rate, {\r\n"Alternate Packet Rate", "infiniband.cm.req.alt_pktrate",\r\nFT_UINT8, BASE_HEX, NULL, 0x3f, NULL, HFILL}\r\n},\r\n{&hf_cm_req_alt_traffic_class, {\r\n"Alternate Traffic Class", "infiniband.cm.req.alt_tfcclass",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_alt_hop_limit, {\r\n"Alternate Hop Limit", "infiniband.cm.req.alt_hoplim",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_SL, {\r\n"Alternate SL", "infiniband.cm.req.alt_sl",\r\nFT_UINT8, BASE_HEX, NULL, 0xf0, NULL, HFILL}\r\n},\r\n{&hf_cm_req_subnet_local, {\r\n"Alternate Subnet Local", "infiniband.cm.req.alt_subnetlocal",\r\nFT_UINT8, BASE_HEX, NULL, 0x8, NULL, HFILL}\r\n},\r\n{&hf_cm_req_local_ACK_timeout, {\r\n"Alternate Local ACK Timeout", "infiniband.cm.req.alt_localacktout",\r\nFT_UINT8, BASE_HEX, NULL, 0xf8, NULL, HFILL}\r\n},\r\n{&hf_cm_req_private_data, {\r\n"PrivateData", "infiniband.cm.req.private",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_rep_localcommid, {\r\n"Local Communication ID", "infiniband.cm.rep",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_rep_remotecommid, {\r\n"Remote Communication ID", "infiniband.cm.rep.remotecommid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_rep_localqkey, {\r\n"Local Q_Key", "infiniband.cm.rep.localqkey",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_rep_localqpn, {\r\n"Local QPN", "infiniband.cm.rep.localqpn",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_rep_localeecontnum, {\r\n"Local EE Context Number", "infiniband.cm.rep.localeecn",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_rep_startingpsn, {\r\n"Starting PSN", "infiniband.cm.rep.startpsn",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_rep_responderres, {\r\n"Responder Resources", "infiniband.cm.rep.respres",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_rep_initiatordepth, {\r\n"Initiator Depth", "infiniband.cm.rep.initdepth",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_rep_tgtackdelay, {\r\n"Target ACK Delay", "infiniband.cm.rep.tgtackdelay",\r\nFT_UINT8, BASE_HEX, NULL, 0xf8, NULL, HFILL}\r\n},\r\n{&hf_cm_rep_failoveracc, {\r\n"Failover Accepted", "infiniband.cm.rep.failoveracc",\r\nFT_UINT8, BASE_HEX, NULL, 0x6, NULL, HFILL}\r\n},\r\n{&hf_cm_rep_e2eflowctl, {\r\n"End-To-End Flow Control", "infiniband.cm.rep.e2eflowctrl",\r\nFT_UINT8, BASE_HEX, NULL, 0x1, NULL, HFILL}\r\n},\r\n{&hf_cm_rep_rnrretrycount, {\r\n"RNR Retry Count", "infiniband.cm.rep.rnrretrcount",\r\nFT_UINT8, BASE_HEX, NULL, 0xe0, NULL, HFILL}\r\n},\r\n{&hf_cm_rep_srq, {\r\n"SRQ", "infiniband.cm.rep.srq",\r\nFT_UINT8, BASE_HEX, NULL, 0x10, NULL, HFILL}\r\n},\r\n{&hf_cm_rep_localcaguid, {\r\n"Local CA GUID", "infiniband.cm.rep.localcaguid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_rep_privatedata, {\r\n"PrivateData", "infiniband.cm.rep.private",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_rtu_localcommid, {\r\n"Local Communication ID", "infiniband.cm.rtu.localcommid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_rtu_remotecommid, {\r\n"Remote Communication ID", "infiniband.cm.rtu.remotecommid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_rtu_privatedata, {\r\n"PrivateData", "infiniband.cm.rtu.private",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_rej_local_commid, {\r\n"Local Communication ID", "infiniband.cm.rej.localcommid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_rej_remote_commid, {\r\n"Remote Communication ID", "infiniband.cm.rej.remotecommid",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_rej_msg_rej, {\r\n"Message REJected", "infiniband.cm.rej.msgrej",\r\nFT_UINT8, BASE_HEX, NULL, 0xc0, NULL, HFILL}\r\n},\r\n{&hf_cm_rej_rej_info_len, {\r\n"Reject Info Length", "infiniband.cm.rej.rejinfolen",\r\nFT_UINT8, BASE_HEX, NULL, 0xfe, NULL, HFILL}\r\n},\r\n{&hf_cm_rej_reason, {\r\n"Reason", "infiniband.cm.rej.reason",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_rej_add_rej_info, {\r\n"Additional Reject Information (ARI)", "infiniband.cm.rej.ari",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{&hf_cm_rej_private_data, {\r\n"PrivateData", "infiniband.cm.rej.private",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MAD, {\r\n"MAD (Management Datagram) Common Header", "infiniband.mad",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_base_version, {\r\n"Base Version", "infiniband.mad.baseversion",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_mgmt_class, {\r\n"Management Class", "infiniband.mad.mgmtclass",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_class_version, {\r\n"Class Version", "infiniband.mad.classversion",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n#if 0\r\n{ &hf_infiniband_reserved1, {\r\n"Reserved", "infiniband.mad.reserved1",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL}\r\n},\r\n#endif\r\n{ &hf_infiniband_method, {\r\n"Method", "infiniband.mad.method",\r\nFT_UINT8, BASE_HEX, VALS(mad_method_str), 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_status, {\r\n"Status", "infiniband.mad.status",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_class_specific, {\r\n"Class Specific", "infiniband.mad.classspecific",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_transaction_id, {\r\n"Transaction ID", "infiniband.mad.transactionid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_attribute_id, {\r\n"Attribute ID", "infiniband.mad.attributeid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_reserved16, {\r\n"Reserved", "infiniband.mad.reserved16",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_attribute_modifier, {\r\n"Attribute Modifier", "infiniband.mad.attributemodifier",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_data, {\r\n"MAD Data Payload", "infiniband.mad.data",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_RMPP, {\r\n"RMPP (Reliable Multi-Packet Transaction Protocol)", "infiniband.rmpp",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_rmpp_version, {\r\n"RMPP Type", "infiniband.rmpp.rmppversion",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_rmpp_type, {\r\n"RMPP Type", "infiniband.rmpp.rmpptype",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_r_resp_time, {\r\n"R Resp Time", "infiniband.rmpp.rresptime",\r\nFT_UINT8, BASE_HEX, NULL, 0xF0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_rmpp_flags, {\r\n"RMPP Flags", "infiniband.rmpp.rmppflags",\r\nFT_UINT8, BASE_HEX, VALS(RMPP_Flags), 0x0F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_rmpp_status, {\r\n"RMPP Status", "infiniband.rmpp.rmppstatus",\r\nFT_UINT8, BASE_HEX, VALS(RMPP_Status), 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_rmpp_data1, {\r\n"RMPP Data 1", "infiniband.rmpp.data1",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_rmpp_data2, {\r\n"RMPP Data 2", "infiniband.rmpp.data2",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n#if 0\r\n{ &hf_infiniband_RMPP_DATA, {\r\n"RMPP Data (Reliable Multi-Packet Transaction Protocol)", "infiniband.rmpp.data",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n#endif\r\n{ &hf_infiniband_segment_number, {\r\n"Segment Number", "infiniband.rmpp.segmentnumber",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_payload_length32, {\r\n"Payload Length", "infiniband.rmpp.payloadlength",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_transferred_data, {\r\n"Transferred Data", "infiniband.rmpp.transferreddata",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_new_window_last, {\r\n"New Window Last", "infiniband.rmpp.newwindowlast",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_reserved220, {\r\n"Segment Number", "infiniband.rmpp.reserved220",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_reserved32, {\r\n"Reserved (32 bits)", "infiniband.rmpp.reserved32",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_optional_extended_error_data, {\r\n"Optional Extended Error Data", "infiniband.rmpp.extendederrordata",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SMP_LID, {\r\n"Subnet Management Packet (LID Routed)", "infiniband.smplid",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_m_key, {\r\n"M_Key", "infiniband.smplid.mkey",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_smp_data, {\r\n"SMP Data", "infiniband.smplid.smpdata",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_reserved1024, {\r\n"Reserved (1024 bits)", "infiniband.smplid.reserved1024",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_reserved256, {\r\n"Reserved (256 bits)", "infiniband.smplid.reserved256",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SMP_DIRECTED, {\r\n"Subnet Management Packet (Directed Route)", "infiniband.smpdirected",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_smp_status, {\r\n"Status", "infiniband.smpdirected.smpstatus",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_hop_pointer, {\r\n"Hop Pointer", "infiniband.smpdirected.hoppointer",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_hop_count, {\r\n"Hop Count", "infiniband.smpdirected.hopcount",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_dr_slid, {\r\n"DrSLID", "infiniband.smpdirected.drslid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_dr_dlid, {\r\n"DrDLID", "infiniband.smpdirected.drdlid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_reserved28, {\r\n"Reserved (224 bits)", "infiniband.smpdirected.reserved28",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_d, {\r\n"D (Direction Bit)", "infiniband.smpdirected.d",\r\nFT_UINT64, BASE_HEX, NULL, 0x8000, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_initial_path, {\r\n"Initial Path", "infiniband.smpdirected.initialpath",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_return_path, {\r\n"Return Path", "infiniband.smpdirected.returnpath",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SA, {\r\n"SA Packet (Subnet Administration)", "infiniband.sa.drdlid",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_sm_key, {\r\n"SM_Key (Verification Key)", "infiniband.sa.smkey",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_attribute_offset, {\r\n"Attribute Offset", "infiniband.sa.attributeoffset",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_component_mask, {\r\n"Component Mask", "infiniband.sa.componentmask",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_subnet_admin_data, {\r\n"Subnet Admin Data", "infiniband.sa.subnetadmindata",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_EOIB, {\r\n"Mellanox EoIB Encapsulation Header", "infiniband.eoib",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_ver, {\r\n"Version", "infiniband.eoib.version",\r\nFT_UINT16, BASE_HEX, NULL, 0x3000, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_tcp_chk, {\r\n"TCP Checksum", "infiniband.eoib.tcp_chk",\r\nFT_UINT16, BASE_HEX, NULL, 0x0c00, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_ip_chk, {\r\n"IP Checksum", "infiniband.eoib.ip_chk",\r\nFT_UINT16, BASE_HEX, NULL, 0x0300, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_fcs, {\r\n"FCS Field Present", "infiniband.eoib.fcs",\r\nFT_BOOLEAN, 16, NULL, 0x0040, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_ms, {\r\n"More Segments to Follow", "infiniband.eoib.ms",\r\nFT_BOOLEAN, 16, NULL, 0x0020, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_seg_off, {\r\n"Segment Offset", "infiniband.eoib.ip_seg_offset",\r\nFT_UINT16, BASE_DEC, NULL, 0x001f, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_seg_id, {\r\n"Segment ID", "infiniband.eoib.ip_seg_id",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_NodeDescription_NodeString, {\r\n"NodeString", "infiniband.nodedescription.nodestring",\r\nFT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_NodeInfo_BaseVersion, {\r\n"BaseVersion", "infiniband.nodeinfo.baseversion",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_NodeInfo_ClassVersion, {\r\n"ClassVersion", "infiniband.nodeinfo.classversion",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_NodeInfo_NodeType, {\r\n"NodeType", "infiniband.nodeinfo.nodetype",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_NodeInfo_NumPorts, {\r\n"NumPorts", "infiniband.nodeinfo.numports",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_NodeInfo_SystemImageGUID, {\r\n"SystemImageGUID", "infiniband.nodeinfo.systemimageguid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_NodeInfo_NodeGUID, {\r\n"NodeGUID", "infiniband.nodeinfo.nodeguid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_NodeInfo_PortGUID, {\r\n"PortGUID", "infiniband.nodeinfo.portguid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_NodeInfo_PartitionCap, {\r\n"PartitionCap", "infiniband.nodeinfo.partitioncap",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_NodeInfo_DeviceID, {\r\n"DeviceID", "infiniband.nodeinfo.deviceid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_NodeInfo_Revision, {\r\n"Revision", "infiniband.nodeinfo.revision",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_NodeInfo_LocalPortNum, {\r\n"LocalPortNum", "infiniband.nodeinfo.localportnum",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_NodeInfo_VendorID, {\r\n"VendorID", "infiniband.nodeinfo.vendorid",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SwitchInfo_LinearFDBCap, {\r\n"LinearFDBCap", "infiniband.switchinfo.linearfdbcap",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SwitchInfo_RandomFDBCap, {\r\n"RandomFDBCap", "infiniband.switchinfo.randomfdbcap",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SwitchInfo_MulticastFDBCap, {\r\n"MulticastFDBCap", "infiniband.switchinfo.multicastfdbcap",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SwitchInfo_LinearFDBTop, {\r\n"LinearFDBTop", "infiniband.switchinfo.linearfdbtop",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SwitchInfo_DefaultPort, {\r\n"DefaultPort", "infiniband.switchinfo.defaultport",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SwitchInfo_DefaultMulticastPrimaryPort, {\r\n"DefaultMulticastPrimaryPort", "infiniband.switchinfo.defaultmulticastprimaryport",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SwitchInfo_DefaultMulticastNotPrimaryPort, {\r\n"DefaultMulticastNotPrimaryPort", "infiniband.switchinfo.defaultmulticastnotprimaryport",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SwitchInfo_LifeTimeValue, {\r\n"LifeTimeValue", "infiniband.switchinfo.lifetimevalue",\r\nFT_UINT8, BASE_HEX, NULL, 0xF8, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SwitchInfo_PortStateChange, {\r\n"PortStateChange", "infiniband.switchinfo.portstatechange",\r\nFT_UINT8, BASE_HEX, NULL, 0x04, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SwitchInfo_OptimizedSLtoVLMappingProgramming, {\r\n"OptimizedSLtoVLMappingProgramming", "infiniband.switchinfo.optimizedsltovlmappingprogramming",\r\nFT_UINT8, BASE_HEX, NULL, 0x03, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SwitchInfo_LIDsPerPort, {\r\n"LIDsPerPort", "infiniband.switchinfo.lidsperport",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SwitchInfo_PartitionEnforcementCap, {\r\n"PartitionEnforcementCap", "infiniband.switchinfo.partitionenforcementcap",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SwitchInfo_InboundEnforcementCap, {\r\n"InboundEnforcementCap", "infiniband.switchinfo.inboundenforcementcap",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SwitchInfo_OutboundEnforcementCap, {\r\n"OutboundEnforcementCap", "infiniband.switchinfo.outboundenforcementcap",\r\nFT_UINT8, BASE_HEX, NULL, 0x40, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SwitchInfo_FilterRawInboundCap, {\r\n"FilterRawInboundCap", "infiniband.switchinfo.filterrawinboundcap",\r\nFT_UINT8, BASE_HEX, NULL, 0x20, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SwitchInfo_FilterRawOutboundCap, {\r\n"FilterRawOutboundCap", "infiniband.switchinfo.filterrawoutboundcap",\r\nFT_UINT8, BASE_HEX, NULL, 0x10, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SwitchInfo_EnhancedPortZero, {\r\n"EnhancedPortZero", "infiniband.switchinfo.enhancedportzero",\r\nFT_UINT8, BASE_HEX, NULL, 0x08, NULL, HFILL}\r\n},\r\n#if 0\r\n{ &hf_infiniband_GUIDInfo_GUIDBlock, {\r\n"GUIDBlock", "infiniband.switchinfo.guidblock",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n#endif\r\n{ &hf_infiniband_GUIDInfo_GUID, {\r\n"GUID", "infiniband.switchinfo.guid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_M_Key, {\r\n"M_Key", "infiniband.portinfo.m_key",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_GidPrefix, {\r\n"GidPrefix", "infiniband.portinfo.guid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_LID, {\r\n"LID", "infiniband.portinfo.lid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_MasterSMLID, {\r\n"MasterSMLID", "infiniband.portinfo.mastersmlid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_CapabilityMask, {\r\n"CapabilityMask", "infiniband.portinfo.capabilitymask",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_CapabilityMask_SM, {\r\n"SM", "infiniband.portinfo.capabilitymask.issm",\r\nFT_UINT32, BASE_HEX, NULL, 0x00000002, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_CapabilityMask_NoticeSupported, {\r\n"NoticeSupported", "infiniband.portinfo.capabilitymask.noticesupported",\r\nFT_UINT32, BASE_HEX, NULL, 0x00000004, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_CapabilityMask_TrapSupported, {\r\n"TrapSupported", "infiniband.portinfo.capabilitymask.trapsupported",\r\nFT_UINT32, BASE_HEX, NULL, 0x00000008, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_CapabilityMask_OptionalPDSupported, {\r\n"OptionalPDSupported", "infiniband.portinfo.capabilitymask.optionalpdsupported",\r\nFT_UINT32, BASE_HEX, NULL, 0x00000010, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_CapabilityMask_AutomaticMigrationSupported, {\r\n"AutomaticMigrationSupported", "infiniband.portinfo.capabilitymask.automaticmigrationsupported",\r\nFT_UINT32, BASE_HEX, NULL, 0x00000020, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_CapabilityMask_SLMappingSupported, {\r\n"SLMappingSupported", "infiniband.portinfo.capabilitymask.slmappingsupported",\r\nFT_UINT32, BASE_HEX, NULL, 0x00000040, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_CapabilityMask_MKeyNVRAM, {\r\n"MKeyNVRAM", "infiniband.portinfo.capabilitymask.mkeynvram",\r\nFT_UINT32, BASE_HEX, NULL, 0x00000080, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_CapabilityMask_PKeyNVRAM, {\r\n"PKeyNVRAM", "infiniband.portinfo.capabilitymask.pkeynvram",\r\nFT_UINT32, BASE_HEX, NULL, 0x00000100, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_CapabilityMask_LEDInfoSupported, {\r\n"LEDInfoSupported", "infiniband.portinfo.capabilitymask.ledinfosupported",\r\nFT_UINT32, BASE_HEX, NULL, 0x00000200, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_CapabilityMask_SMdisabled, {\r\n"SMdisabled", "infiniband.portinfo.capabilitymask.smdisabled",\r\nFT_UINT32, BASE_HEX, NULL, 0x00000400, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_CapabilityMask_SystemImageGUIDSupported, {\r\n"SystemImageGUIDSupported", "infiniband.portinfo.capabilitymask.systemimageguidsupported",\r\nFT_UINT32, BASE_HEX, NULL, 0x00000800, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_CapabilityMask_PKeySwitchExternalPortTrapSupported, {\r\n"PKeySwitchExternalPortTrapSupported", "infiniband.portinfo.capabilitymask.pkeyswitchexternalporttrapsupported",\r\nFT_UINT32, BASE_HEX, NULL, 0x00001000, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_CapabilityMask_CommunicationsManagementSupported, {\r\n"CommunicationsManagementSupported", "infiniband.portinfo.capabilitymask.communicationsmanagementsupported",\r\nFT_UINT32, BASE_HEX, NULL, 0x00010000, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_CapabilityMask_SNMPTunnelingSupported, {\r\n"SNMPTunnelingSupported", "infiniband.portinfo.capabilitymask.snmptunnelingsupported",\r\nFT_UINT32, BASE_HEX, NULL, 0x00020000, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_CapabilityMask_ReinitSupported, {\r\n"ReinitSupported", "infiniband.portinfo.capabilitymask.reinitsupported",\r\nFT_UINT32, BASE_HEX, NULL, 0x00040000, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_CapabilityMask_DeviceManagementSupported, {\r\n"DeviceManagementSupported", "infiniband.portinfo.capabilitymask.devicemanagementsupported",\r\nFT_UINT32, BASE_HEX, NULL, 0x00080000, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_CapabilityMask_VendorClassSupported, {\r\n"VendorClassSupported", "infiniband.portinfo.capabilitymask.vendorclasssupported",\r\nFT_UINT32, BASE_HEX, NULL, 0x00100000, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_CapabilityMask_DRNoticeSupported, {\r\n"DRNoticeSupported", "infiniband.portinfo.capabilitymask.drnoticesupported",\r\nFT_UINT32, BASE_HEX, NULL, 0x00200000, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_CapabilityMask_CapabilityMaskNoticeSupported, {\r\n"CapabilityMaskNoticeSupported", "infiniband.portinfo.capabilitymask.capabilitymasknoticesupported",\r\nFT_UINT32, BASE_HEX, NULL, 0x00400000, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_CapabilityMask_BootManagementSupported, {\r\n"BootManagementSupported", "infiniband.portinfo.capabilitymask.bootmanagementsupported",\r\nFT_UINT32, BASE_HEX, NULL, 0x00800000, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_CapabilityMask_LinkRoundTripLatencySupported, {\r\n"LinkRoundTripLatencySupported", "infiniband.portinfo.capabilitymask.linkroundtriplatencysupported",\r\nFT_UINT32, BASE_HEX, NULL, 0x01000000, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_CapabilityMask_ClientRegistrationSupported, {\r\n"ClientRegistrationSupported", "infiniband.portinfo.capabilitymask.clientregistrationsupported",\r\nFT_UINT32, BASE_HEX, NULL, 0x02000000, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_CapabilityMask_OtherLocalChangesNoticeSupported, {\r\n"OtherLocalChangesNoticeSupported", "infiniband.portinfo.capabilitymask.otherlocalchangesnoticesupported",\r\nFT_UINT32, BASE_HEX, NULL, 0x04000000, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_CapabilityMask_LinkSpeedWIdthPairsTableSupported, {\r\n"LinkSpeedWIdthPairsTableSupported", "infiniband.portinfo.capabilitymask.linkspeedwidthpairstablesupported",\r\nFT_UINT32, BASE_HEX, NULL, 0x08000000, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_DiagCode, {\r\n"DiagCode", "infiniband.portinfo.diagcode",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_M_KeyLeasePeriod, {\r\n"M_KeyLeasePeriod", "infiniband.portinfo.m_keyleaseperiod",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_LocalPortNum, {\r\n"LocalPortNum", "infiniband.portinfo.localportnum",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_LinkWidthEnabled, {\r\n"LinkWidthEnabled", "infiniband.portinfo.linkwidthenabled",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_LinkWidthSupported, {\r\n"LinkWidthSupported", "infiniband.portinfo.linkwidthsupported",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_LinkWidthActive, {\r\n"LinkWidthActive", "infiniband.portinfo.linkwidthactive",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_LinkSpeedSupported, {\r\n"LinkSpeedSupported", "infiniband.portinfo.linkspeedsupported",\r\nFT_UINT8, BASE_HEX, NULL, 0xF0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_PortState, {\r\n"PortState", "infiniband.portinfo.portstate",\r\nFT_UINT8, BASE_HEX, NULL, 0x0F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_PortPhysicalState, {\r\n"PortPhysicalState", "infiniband.portinfo.portphysicalstate",\r\nFT_UINT8, BASE_HEX, NULL, 0xF0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_LinkDownDefaultState, {\r\n"LinkDownDefaultState", "infiniband.portinfo.linkdowndefaultstate",\r\nFT_UINT8, BASE_HEX, NULL, 0x0F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_M_KeyProtectBits, {\r\n"M_KeyProtectBits", "infiniband.portinfo.m_keyprotectbits",\r\nFT_UINT8, BASE_HEX, NULL, 0xC0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_LMC, {\r\n"LMC", "infiniband.portinfo.lmc",\r\nFT_UINT8, BASE_HEX, NULL, 0x07, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_LinkSpeedActive, {\r\n"LinkSpeedActive", "infiniband.portinfo.linkspeedactive",\r\nFT_UINT8, BASE_HEX, NULL, 0xF0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_LinkSpeedEnabled, {\r\n"LinkSpeedEnabled", "infiniband.portinfo.linkspeedenabled",\r\nFT_UINT8, BASE_HEX, NULL, 0x0F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_NeighborMTU, {\r\n"NeighborMTU", "infiniband.portinfo.neighbormtu",\r\nFT_UINT8, BASE_HEX, NULL, 0xF0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_MasterSMSL, {\r\n"MasterSMSL", "infiniband.portinfo.mastersmsl",\r\nFT_UINT8, BASE_HEX, NULL, 0x0F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_VLCap, {\r\n"VLCap", "infiniband.portinfo.vlcap",\r\nFT_UINT8, BASE_HEX, NULL, 0xF0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_InitType, {\r\n"InitType", "infiniband.portinfo.inittype",\r\nFT_UINT8, BASE_HEX, NULL, 0x0F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_VLHighLimit, {\r\n"VLHighLimit", "infiniband.portinfo.vlhighlimit",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_VLArbitrationHighCap, {\r\n"VLArbitrationHighCap", "infiniband.portinfo.vlarbitrationhighcap",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_VLArbitrationLowCap, {\r\n"VLArbitrationLowCap", "infiniband.portinfo.vlarbitrationlowcap",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_InitTypeReply, {\r\n"InitTypeReply", "infiniband.portinfo.inittypereply",\r\nFT_UINT8, BASE_HEX, NULL, 0xF0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_MTUCap, {\r\n"MTUCap", "infiniband.portinfo.mtucap",\r\nFT_UINT8, BASE_HEX, NULL, 0x0F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_VLStallCount, {\r\n"VLStallCount", "infiniband.portinfo.vlstallcount",\r\nFT_UINT8, BASE_HEX, NULL, 0xE0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_HOQLife, {\r\n"HOQLife", "infiniband.portinfo.hoqlife",\r\nFT_UINT8, BASE_HEX, NULL, 0x1F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_OperationalVLs, {\r\n"OperationalVLs", "infiniband.portinfo.operationalvls",\r\nFT_UINT8, BASE_HEX, NULL, 0xF0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_PartitionEnforcementInbound, {\r\n"PartitionEnforcementInbound", "infiniband.portinfo.partitionenforcementinbound",\r\nFT_UINT8, BASE_HEX, NULL, 0x08, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_PartitionEnforcementOutbound, {\r\n"PartitionEnforcementOutbound", "infiniband.portinfo.partitionenforcementoutbound",\r\nFT_UINT8, BASE_HEX, NULL, 0x04, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_FilterRawInbound, {\r\n"FilterRawInbound", "infiniband.portinfo.filterrawinbound",\r\nFT_UINT8, BASE_HEX, NULL, 0x02, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_FilterRawOutbound, {\r\n"FilterRawOutbound", "infiniband.portinfo.filterrawoutbound",\r\nFT_UINT8, BASE_HEX, NULL, 0x01, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_M_KeyViolations, {\r\n"M_KeyViolations", "infiniband.portinfo.m_keyviolations",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_P_KeyViolations, {\r\n"P_KeyViolations", "infiniband.portinfo.p_keyviolations",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_Q_KeyViolations, {\r\n"Q_KeyViolations", "infiniband.portinfo.q_keyviolations",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_GUIDCap, {\r\n"GUIDCap", "infiniband.portinfo.guidcap",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_ClientReregister, {\r\n"ClientReregister", "infiniband.portinfo.clientreregister",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_SubnetTimeOut, {\r\n"SubnetTimeOut", "infiniband.portinfo.subnettimeout",\r\nFT_UINT8, BASE_HEX, NULL, 0x1F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_RespTimeValue, {\r\n"RespTimeValue", "infiniband.portinfo.resptimevalue",\r\nFT_UINT8, BASE_HEX, NULL, 0x1F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_LocalPhyErrors, {\r\n"LocalPhyErrors", "infiniband.portinfo.localphyerrors",\r\nFT_UINT8, BASE_HEX, NULL, 0xF0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_OverrunErrors, {\r\n"OverrunErrors", "infiniband.portinfo.overrunerrors",\r\nFT_UINT8, BASE_HEX, NULL, 0x0F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_MaxCreditHint, {\r\n"MaxCreditHint", "infiniband.portinfo.maxcredithint",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortInfo_LinkRoundTripLatency, {\r\n"LinkRoundTripLatency", "infiniband.portinfo.linkroundtriplatency",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_P_KeyTable_P_KeyTableBlock, {\r\n"P_KeyTableBlock", "infiniband.p_keytable.p_keytableblock",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_P_KeyTable_MembershipType, {\r\n"MembershipType", "infiniband.p_keytable.membershiptype",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_P_KeyTable_P_KeyBase, {\r\n"P_KeyBase", "infiniband.p_keytable.p_keybase",\r\nFT_UINT16, BASE_HEX, NULL, 0x7FFF, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SLtoVLMappingTable_SLtoVL_HighBits, {\r\n"SL(x)toVL", "infiniband.sltovlmappingtable.sltovlhighbits",\r\nFT_UINT8, BASE_HEX, NULL, 0xF0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SLtoVLMappingTable_SLtoVL_LowBits, {\r\n"SL(x)toVL", "infiniband.sltovlmappingtable.sltovllowbits",\r\nFT_UINT8, BASE_HEX, NULL, 0x0F, NULL, HFILL}\r\n},\r\n#if 0\r\n{ &hf_infiniband_VLArbitrationTable_VLWeightPairs, {\r\n"VLWeightPairs", "infiniband.vlarbitrationtable.vlweightpairs",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n#endif\r\n{ &hf_infiniband_VLArbitrationTable_VL, {\r\n"VL", "infiniband.vlarbitrationtable.vl",\r\nFT_UINT8, BASE_HEX, NULL, 0x0F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_VLArbitrationTable_Weight, {\r\n"Weight", "infiniband.vlarbitrationtable.weight",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n#if 0\r\n{ &hf_infiniband_LinearForwardingTable_LinearForwardingTableBlock, {\r\n"LinearForwardingTableBlock", "infiniband.linearforwardingtable.linearforwardingtableblock",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n#endif\r\n{ &hf_infiniband_LinearForwardingTable_Port, {\r\n"Port", "infiniband.linearforwardingtable.port",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n#if 0\r\n{ &hf_infiniband_RandomForwardingTable_RandomForwardingTableBlock, {\r\n"RandomForwardingTableBlock", "infiniband.randomforwardingtable.randomforwardingtableblock",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n#endif\r\n{ &hf_infiniband_RandomForwardingTable_LID, {\r\n"LID", "infiniband.randomforwardingtable.lid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_RandomForwardingTable_Valid, {\r\n"Valid", "infiniband.randomforwardingtable.valid",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_RandomForwardingTable_LMC, {\r\n"LMC", "infiniband.randomforwardingtable.lmc",\r\nFT_UINT8, BASE_HEX, NULL, 0x70, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_RandomForwardingTable_Port, {\r\n"Port", "infiniband.randomforwardingtable.port",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n#if 0\r\n{ &hf_infiniband_MulticastForwardingTable_MulticastForwardingTableBlock , {\r\n"MulticastForwardingTableBlock", "infiniband.multicastforwardingtable.multicastforwardingtableblock",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n#endif\r\n{ &hf_infiniband_MulticastForwardingTable_PortMask, {\r\n"PortMask", "infiniband.multicastforwardingtable.portmask",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SMInfo_GUID, {\r\n"GUID", "infiniband.sminfo.guid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SMInfo_SM_Key, {\r\n"SM_Key", "infiniband.sminfo.sm_key",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SMInfo_ActCount, {\r\n"ActCount", "infiniband.sminfo.actcount",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SMInfo_Priority, {\r\n"Priority", "infiniband.sminfo.priority",\r\nFT_UINT8, BASE_HEX, NULL, 0xF0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SMInfo_SMState, {\r\n"SMState", "infiniband.sminfo.smstate",\r\nFT_UINT8, BASE_HEX, NULL, 0x0F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_VendorDiag_NextIndex, {\r\n"NextIndex", "infiniband.vendordiag.nextindex",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_VendorDiag_DiagData, {\r\n"DiagData", "infiniband.vendordiag.diagdata",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_LedInfo_LedMask, {\r\n"LedMask", "infiniband.ledinfo.ledmask",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_LinkSpeedWidthPairsTable_NumTables, {\r\n"NumTables", "infiniband.linkspeedwidthpairstable.numtables",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_LinkSpeedWidthPairsTable_PortMask, {\r\n"PortMask", "infiniband.linkspeedwidthpairstable.portmask",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_LinkSpeedWidthPairsTable_SpeedTwoFive, {\r\n"Speed 2.5 Gbps", "infiniband.linkspeedwidthpairstable.speedtwofive",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_LinkSpeedWidthPairsTable_SpeedFive, {\r\n"Speed 5 Gbps", "infiniband.linkspeedwidthpairstable.speedfive",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_LinkSpeedWidthPairsTable_SpeedTen, {\r\n"Speed 10 Gbps", "infiniband.linkspeedwidthpairstable.speedten",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SA_LID, {\r\n"LID", "infiniband.sa.lid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SA_EndportLID, {\r\n"EndportLID", "infiniband.sa.endportlid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SA_PortNum, {\r\n"PortNum", "infiniband.sa.portnum",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SA_InputPortNum , {\r\n"InputPortNum", "infiniband.sa.inputportnum",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SA_OutputPortNum, {\r\n"OutputPortNum", "infiniband.sa.outputportnum",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SA_BlockNum_EightBit, {\r\n"BlockNum_EightBit", "infiniband.sa.blocknum_eightbit",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SA_BlockNum_NineBit, {\r\n"BlockNum_NineBit", "infiniband.sa.blocknum_ninebit",\r\nFT_UINT16, BASE_HEX, NULL, 0x01FF, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SA_BlockNum_SixteenBit, {\r\n"BlockNum_SixteenBit", "infiniband.sa.blocknum_sixteenbit",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_SA_Position, {\r\n"Position", "infiniband.sa.position",\r\nFT_UINT8, BASE_HEX, NULL, 0xF0, NULL, HFILL}\r\n},\r\n#if 0\r\n{ &hf_infiniband_SA_Index, {\r\n"Index", "infiniband.sa.index",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n#endif\r\n{ &hf_infiniband_InformInfoRecord_SubscriberGID, {\r\n"SubscriberGID", "infiniband.informinforecord.subscribergid",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_InformInfoRecord_Enum, {\r\n"Enum", "infiniband.informinforecord.enum",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_InformInfo_GID, {\r\n"GID", "infiniband.informinfo.gid",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_InformInfo_LIDRangeBegin, {\r\n"LIDRangeBegin", "infiniband.informinfo.lidrangebegin",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_InformInfo_LIDRangeEnd, {\r\n"LIDRangeEnd", "infiniband.informinfo.lidrangeend",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_InformInfo_IsGeneric, {\r\n"IsGeneric", "infiniband.informinfo.isgeneric",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_InformInfo_Subscribe, {\r\n"Subscribe", "infiniband.informinfo.subscribe",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_InformInfo_Type, {\r\n"Type", "infiniband.informinfo.type",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_InformInfo_TrapNumberDeviceID, {\r\n"TrapNumberDeviceID", "infiniband.informinfo.trapnumberdeviceid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_InformInfo_QPN, {\r\n"QPN", "infiniband.informinfo.qpn",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_InformInfo_RespTimeValue, {\r\n"RespTimeValue", "infiniband.informinfo.resptimevalue",\r\nFT_UINT8, BASE_HEX, NULL, 0x1F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_InformInfo_ProducerTypeVendorID, {\r\n"ProducerTypeVendorID", "infiniband.informinfo.producertypevendorid",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_LinkRecord_FromLID, {\r\n"FromLID", "infiniband.linkrecord.fromlid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_LinkRecord_FromPort, {\r\n"FromPort", "infiniband.linkrecord.fromport",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_LinkRecord_ToPort, {\r\n"ToPort", "infiniband.linkrecord.toport",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_LinkRecord_ToLID, {\r\n"ToLID", "infiniband.linkrecord.tolid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_ServiceRecord_ServiceID, {\r\n"ServiceID", "infiniband.linkrecord.serviceid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_ServiceRecord_ServiceGID, {\r\n"ServiceGID", "infiniband.linkrecord.servicegid",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_ServiceRecord_ServiceP_Key, {\r\n"ServiceP_Key", "infiniband.linkrecord.servicep_key",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_ServiceRecord_ServiceLease, {\r\n"ServiceLease", "infiniband.linkrecord.servicelease",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_ServiceRecord_ServiceKey, {\r\n"ServiceKey", "infiniband.linkrecord.servicekey",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_ServiceRecord_ServiceName, {\r\n"ServiceName", "infiniband.linkrecord.servicename",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_ServiceRecord_ServiceData, {\r\n"ServiceData", "infiniband.linkrecord.servicedata",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_ServiceAssociationRecord_ServiceKey, {\r\n"ServiceKey", "infiniband.serviceassociationrecord.servicekey",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_ServiceAssociationRecord_ServiceName, {\r\n"ServiceName", "infiniband.serviceassociationrecord.servicename",\r\nFT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PathRecord_DGID, {\r\n"DGID", "infiniband.pathrecord.dgid",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PathRecord_SGID, {\r\n"SGID", "infiniband.pathrecord.sgid",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PathRecord_DLID, {\r\n"DLID", "infiniband.pathrecord.dlid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PathRecord_SLID, {\r\n"SLID", "infiniband.pathrecord.slid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PathRecord_RawTraffic, {\r\n"RawTraffic", "infiniband.pathrecord.rawtraffic",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PathRecord_FlowLabel, {\r\n"FlowLabel", "infiniband.pathrecord.flowlabel",\r\nFT_UINT24, BASE_HEX, NULL, 0x0FFFFF, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PathRecord_HopLimit, {\r\n"HopLimit", "infiniband.pathrecord.hoplimit",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PathRecord_TClass, {\r\n"TClass", "infiniband.pathrecord.tclass",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PathRecord_Reversible, {\r\n"Reversible", "infiniband.pathrecord.reversible",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PathRecord_NumbPath, {\r\n"NumbPath", "infiniband.pathrecord.numbpath",\r\nFT_UINT8, BASE_HEX, NULL, 0x7F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PathRecord_P_Key, {\r\n"P_Key", "infiniband.pathrecord.p_key",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PathRecord_SL, {\r\n"SL", "infiniband.pathrecord.sl",\r\nFT_UINT16, BASE_HEX, NULL, 0x000F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PathRecord_MTUSelector, {\r\n"MTUSelector", "infiniband.pathrecord.mtuselector",\r\nFT_UINT8, BASE_HEX, NULL, 0xC0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PathRecord_MTU, {\r\n"MTU", "infiniband.pathrecord.mtu",\r\nFT_UINT8, BASE_HEX, NULL, 0x3F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PathRecord_RateSelector, {\r\n"RateSelector", "infiniband.pathrecord.rateselector",\r\nFT_UINT8, BASE_HEX, NULL, 0xC0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PathRecord_Rate, {\r\n"Rate", "infiniband.pathrecord.rate",\r\nFT_UINT8, BASE_HEX, NULL, 0x3F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PathRecord_PacketLifeTimeSelector, {\r\n"PacketLifeTimeSelector", "infiniband.pathrecord.packetlifetimeselector",\r\nFT_UINT8, BASE_HEX, NULL, 0xC0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PathRecord_PacketLifeTime, {\r\n"PacketLifeTime", "infiniband.pathrecord.packetlifetime",\r\nFT_UINT8, BASE_HEX, NULL, 0x3F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PathRecord_Preference, {\r\n"Preference", "infiniband.pathrecord.preference",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MCMemberRecord_MGID, {\r\n"MGID", "infiniband.mcmemberrecord.mgid",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MCMemberRecord_PortGID, {\r\n"PortGID", "infiniband.mcmemberrecord.portgid",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MCMemberRecord_Q_Key, {\r\n"Q_Key", "infiniband.mcmemberrecord.q_key",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MCMemberRecord_MLID, {\r\n"MLID", "infiniband.mcmemberrecord.mlid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MCMemberRecord_MTUSelector, {\r\n"MTUSelector", "infiniband.mcmemberrecord.mtuselector",\r\nFT_UINT8, BASE_HEX, NULL, 0xC0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MCMemberRecord_MTU, {\r\n"MTU", "infiniband.mcmemberrecord.mtu",\r\nFT_UINT8, BASE_HEX, NULL, 0x3F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MCMemberRecord_TClass, {\r\n"TClass", "infiniband.mcmemberrecord.tclass",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MCMemberRecord_P_Key, {\r\n"P_Key", "infiniband.mcmemberrecord.p_key",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MCMemberRecord_RateSelector, {\r\n"RateSelector", "infiniband.mcmemberrecord.rateselector",\r\nFT_UINT8, BASE_HEX, NULL, 0xC0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MCMemberRecord_Rate, {\r\n"Rate", "infiniband.mcmemberrecord.rate",\r\nFT_UINT8, BASE_HEX, NULL, 0x3F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MCMemberRecord_PacketLifeTimeSelector, {\r\n"PacketLifeTimeSelector", "infiniband.mcmemberrecord.packetlifetimeselector",\r\nFT_UINT8, BASE_HEX, NULL, 0xC0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MCMemberRecord_PacketLifeTime, {\r\n"PacketLifeTime", "infiniband.mcmemberrecord.packetlifetime",\r\nFT_UINT8, BASE_HEX, NULL, 0x3F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MCMemberRecord_SL, {\r\n"SL", "infiniband.mcmemberrecord.sl",\r\nFT_UINT8, BASE_HEX, NULL, 0xF0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MCMemberRecord_FlowLabel, {\r\n"FlowLabel", "infiniband.mcmemberrecord.flowlabel",\r\nFT_UINT24, BASE_HEX, NULL, 0x0FFFFF, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MCMemberRecord_HopLimit, {\r\n"HopLimit", "infiniband.mcmemberrecord.hoplimit",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MCMemberRecord_Scope, {\r\n"Scope", "infiniband.mcmemberrecord.scope",\r\nFT_UINT8, BASE_HEX, NULL, 0xF0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MCMemberRecord_JoinState, {\r\n"JoinState", "infiniband.mcmemberrecord.joinstate",\r\nFT_UINT8, BASE_HEX, NULL, 0x0F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MCMemberRecord_ProxyJoin, {\r\n"ProxyJoin", "infiniband.mcmemberrecord.proxyjoin",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_TraceRecord_GIDPrefix, {\r\n"GidPrefix", "infiniband.tracerecord.gidprefix",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_TraceRecord_IDGeneration, {\r\n"IDGeneration", "infiniband.tracerecord.idgeneration",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_TraceRecord_NodeType, {\r\n"NodeType", "infiniband.tracerecord.nodetype",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_TraceRecord_NodeID, {\r\n"NodeID", "infiniband.tracerecord.nodeid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_TraceRecord_ChassisID, {\r\n"ChassisID", "infiniband.tracerecord.chassisid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_TraceRecord_EntryPortID, {\r\n"EntryPortID", "infiniband.tracerecord.entryportid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_TraceRecord_ExitPortID, {\r\n"ExitPortID", "infiniband.tracerecord.exitportid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_TraceRecord_EntryPort, {\r\n"EntryPort", "infiniband.tracerecord.entryport",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_TraceRecord_ExitPort, {\r\n"ExitPort", "infiniband.tracerecord.exitport",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MultiPathRecord_RawTraffic, {\r\n"RawTraffic", "infiniband.multipathrecord.rawtraffic",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MultiPathRecord_FlowLabel, {\r\n"FlowLabel", "infiniband.multipathrecord.flowlabel",\r\nFT_UINT24, BASE_HEX, NULL, 0x0FFFFF, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MultiPathRecord_HopLimit, {\r\n"HopLimit", "infiniband.multipathrecord.hoplimit",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MultiPathRecord_TClass, {\r\n"TClass", "infiniband.multipathrecord.tclass",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MultiPathRecord_Reversible, {\r\n"Reversible", "infiniband.multipathrecord.reversible",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MultiPathRecord_NumbPath, {\r\n"NumbPath", "infiniband.multipathrecord.numbpath",\r\nFT_UINT8, BASE_HEX, NULL, 0x7F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MultiPathRecord_P_Key, {\r\n"P_Key", "infiniband.multipathrecord.p_key",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MultiPathRecord_SL, {\r\n"SL", "infiniband.multipathrecord.sl",\r\nFT_UINT8, BASE_HEX, NULL, 0x0F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MultiPathRecord_MTUSelector, {\r\n"MTUSelector", "infiniband.multipathrecord.mtuselector",\r\nFT_UINT8, BASE_HEX, NULL, 0xC0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MultiPathRecord_MTU, {\r\n"MTU", "infiniband.multipathrecord.mtu",\r\nFT_UINT8, BASE_HEX, NULL, 0x3F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MultiPathRecord_RateSelector, {\r\n"RateSelector", "infiniband.multipathrecord.rateselector",\r\nFT_UINT8, BASE_HEX, NULL, 0xC0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MultiPathRecord_Rate, {\r\n"Rate", "infiniband.multipathrecord.rate",\r\nFT_UINT8, BASE_HEX, NULL, 0x3F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MultiPathRecord_PacketLifeTimeSelector, {\r\n"PacketLifeTimeSelector", "infiniband.multipathrecord.packetlifetimeselector",\r\nFT_UINT8, BASE_HEX, NULL, 0xC0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MultiPathRecord_PacketLifeTime, {\r\n"PacketLifeTime", "infiniband.multipathrecord.packetlifetime",\r\nFT_UINT8, BASE_HEX, NULL, 0x3F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MultiPathRecord_IndependenceSelector, {\r\n"IndependenceSelector", "infiniband.multipathrecord.independenceselector",\r\nFT_UINT8, BASE_HEX, NULL, 0xC0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MultiPathRecord_GIDScope, {\r\n"GIDScope", "infiniband.multipathrecord.gidscope",\r\nFT_UINT8, BASE_HEX, NULL, 0x3F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MultiPathRecord_SGIDCount, {\r\n"SGIDCount", "infiniband.multipathrecord.sgidcount",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MultiPathRecord_DGIDCount, {\r\n"DGIDCount", "infiniband.multipathrecord.dgidcount",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_MultiPathRecord_SDGID, {\r\n"SDGID", "infiniband.multipathrecord.sdgid",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Notice_IsGeneric, {\r\n"IsGeneric", "infiniband.notice.isgeneric",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Notice_Type, {\r\n"Type", "infiniband.notice.type",\r\nFT_UINT8, BASE_HEX, NULL, 0x7F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Notice_ProducerTypeVendorID, {\r\n"ProducerTypeVendorID", "infiniband.notice.producertypevendorid",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Notice_TrapNumberDeviceID, {\r\n"TrapNumberDeviceID", "infiniband.notice.trapnumberdeviceid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Notice_IssuerLID, {\r\n"IssuerLID", "infiniband.notice.issuerlid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Notice_NoticeToggle, {\r\n"NoticeToggle", "infiniband.notice.noticetoggle",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Notice_NoticeCount, {\r\n"NoticeCount", "infiniband.notice.noticecount",\r\nFT_UINT16, BASE_HEX, NULL, 0x7FFF, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Notice_DataDetails, {\r\n"DataDetails", "infiniband.notice.datadetails",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n#if 0\r\n{ &hf_infiniband_Notice_IssuerGID, {\r\n"IssuerGID", "infiniband.notice.issuergid",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Notice_ClassTrapSpecificData, {\r\n"ClassTrapSpecificData", "infiniband.notice.classtrapspecificdata",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n#endif\r\n{ &hf_infiniband_Trap_GIDADDR, {\r\n"GIDADDR", "infiniband.trap.gidaddr",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_COMP_MASK, {\r\n"COMP_MASK", "infiniband.trap.comp_mask",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_WAIT_FOR_REPATH, {\r\n"WAIT_FOR_REPATH", "infiniband.trap.wait_for_repath",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL}\r\n},\r\n#if 0\r\n{ &hf_infiniband_Trap_PATH_REC, {\r\n"PATH_REC", "infiniband.trap.path_rec",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n#endif\r\n{ &hf_infiniband_Trap_LIDADDR, {\r\n"LIDADDR", "infiniband.trap.lidaddr",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_PORTNO, {\r\n"PORTNO", "infiniband.trap.portno",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_OtherLocalChanges, {\r\n"OtherLocalChanges", "infiniband.trap.otherlocalchanges",\r\nFT_UINT8, BASE_HEX, NULL, 0x01, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_CAPABILITYMASK, {\r\n"CAPABILITYMASK", "infiniband.trap.capabilitymask",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_LinkSpeecEnabledChange, {\r\n"LinkSpeecEnabledChange", "infiniband.trap.linkspeecenabledchange",\r\nFT_UINT8, BASE_HEX, NULL, 0x04, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_LinkWidthEnabledChange, {\r\n"LinkWidthEnabledChange", "infiniband.trap.linkwidthenabledchange",\r\nFT_UINT8, BASE_HEX, NULL, 0x02, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_NodeDescriptionChange, {\r\n"NodeDescriptionChange", "infiniband.trap.nodedescriptionchange",\r\nFT_UINT8, BASE_HEX, NULL, 0x01, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_SYSTEMIMAGEGUID, {\r\n"SYSTEMIMAGEGUID", "infiniband.trap.systemimageguid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_DRSLID, {\r\n"DRSLID", "infiniband.trap.drslid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_METHOD, {\r\n"METHOD", "infiniband.trap.method",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_ATTRIBUTEID, {\r\n"ATTRIBUTEID", "infiniband.trap.attributeid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_ATTRIBUTEMODIFIER, {\r\n"ATTRIBUTEMODIFIER", "infiniband.trap.attributemodifier",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_MKEY, {\r\n"MKEY", "infiniband.trap.mkey",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_DRNotice, {\r\n"DRNotice", "infiniband.trap.drnotice",\r\nFT_UINT8, BASE_HEX, NULL, 0x80, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_DRPathTruncated, {\r\n"DRPathTruncated", "infiniband.trap.drpathtruncated",\r\nFT_UINT8, BASE_HEX, NULL, 0x40, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_DRHopCount, {\r\n"DRHopCount", "infiniband.trap.drhopcount",\r\nFT_UINT8, BASE_HEX, NULL, 0x3F, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_DRNoticeReturnPath, {\r\n"DRNoticeReturnPath", "infiniband.trap.drnoticereturnpath",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_LIDADDR1, {\r\n"LIDADDR1", "infiniband.trap.lidaddr1",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_LIDADDR2, {\r\n"LIDADDR2", "infiniband.trap.lidaddr2",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_KEY, {\r\n"KEY", "infiniband.trap.key",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_SL, {\r\n"SL", "infiniband.trap.sl",\r\nFT_UINT8, BASE_HEX, NULL, 0xF0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_QP1, {\r\n"QP1", "infiniband.trap.qp1",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_QP2, {\r\n"QP2", "infiniband.trap.qp2",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_GIDADDR1, {\r\n"GIDADDR1", "infiniband.trap.gidaddr1",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_GIDADDR2, {\r\n"GIDADDR2", "infiniband.trap.gidaddr2",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_DataValid, {\r\n"DataValid", "infiniband.trap.datavalid",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_PKEY, {\r\n"PKEY", "infiniband.trap.pkey",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_Trap_SWLIDADDR, {\r\n"SWLIDADDR", "infiniband.trap.swlidaddr",\r\nFT_IPv6, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_PortCounters, {\r\n"Port Counters (Performance Management MAD)", "infiniband.portcounters",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\n"Performance class PortCounters packet", HFILL}\r\n},\r\n{ &hf_infiniband_PortCounters_PortSelect, {\r\n"PortSelect", "infiniband.portcounters.portselect",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\n"Selects the port that will be accessed", HFILL}\r\n},\r\n{ &hf_infiniband_PortCounters_CounterSelect, {\r\n"CounterSelect", "infiniband.portcounters.counterselect",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\n"When writing, selects which counters are affected by the operation", HFILL}\r\n},\r\n{ &hf_infiniband_PortCounters_SymbolErrorCounter, {\r\n"SymbolErrorCounter", "infiniband.portcounters.symbolerrorcounter",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Total number of minor link errors", HFILL}\r\n},\r\n{ &hf_infiniband_PortCounters_LinkErrorRecoveryCounter, {\r\n"LinkErrorRecoveryCounter", "infiniband.portcounters.linkerrorrecoverycounter",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Total number of times successfully completed link error recovery process", HFILL}\r\n},\r\n{ &hf_infiniband_PortCounters_LinkDownedCounter, {\r\n"LinkDownedCounter", "infiniband.portcounters.linkdownedcounter",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Total number of times failed link error recovery process", HFILL}\r\n},\r\n{ &hf_infiniband_PortCounters_PortRcvErrors, {\r\n"PortRcvErrors", "infiniband.portcounters.portrcverrors",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Total number of packets containing an error received", HFILL}\r\n},\r\n{ &hf_infiniband_PortCounters_PortRcvRemotePhysicalErrors, {\r\n"PortRcvRemotePhysicalErrors", "infiniband.portcounters.portrcvremotephysicalerrors",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Total number of packets marked with EBP delimiter received", HFILL}\r\n},\r\n{ &hf_infiniband_PortCounters_PortRcvSwitchRelayErrors, {\r\n"PortRcvSwitchRelayErrors", "infiniband.portcounters.portrcvswitchrelayerrors",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Total number of packets discarded because they could not be forwarded by switch relay",\r\nHFILL}\r\n},\r\n{ &hf_infiniband_PortCounters_PortXmitDiscards, {\r\n"PortXmitDiscards", "infiniband.portcounters.portxmitdiscards",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Total number of outbound packets discarded", HFILL}\r\n},\r\n{ &hf_infiniband_PortCounters_PortXmitConstraintErrors, {\r\n"PortXmitConstraintErrors", "infiniband.portcounters.portxmitconstrainterrors",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Total number of packets not transmitted from the switch physical port", HFILL}\r\n},\r\n{ &hf_infiniband_PortCounters_PortRcvConstraintErrors, {\r\n"PortRcvConstraintErrors", "infiniband.portcounters.portrcvconstrainterrors",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Total number of packets received on the switch physical port that are discarded", HFILL}\r\n},\r\n{ &hf_infiniband_PortCounters_LocalLinkIntegrityErrors, {\r\n"LocalLinkIntegrityErrors", "infiniband.portcounters.locallinkintegrityerrors",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"The number of times the count of local physical errors exceeded the threshold specified by LocalPhyErrors",\r\nHFILL}\r\n},\r\n{ &hf_infiniband_PortCounters_ExcessiveBufferOverrunErrors, {\r\n"ExcessiveBufferOverrunErrors", "infiniband.portcounters.excessivebufferoverrunerrors",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"The number of times that OverrunErrors consecutive flow control update periods occurred",\r\nHFILL}\r\n},\r\n{ &hf_infiniband_PortCounters_VL15Dropped, {\r\n"VL15Dropped", "infiniband.portcounters.vl15dropped",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\n"Number of incoming VL15 packets dropped", HFILL}\r\n},\r\n{ &hf_infiniband_PortCounters_PortXmitData, {\r\n"PortXmitData", "infiniband.portcounters.portxmitdata",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Total number of data octets, divided by 4, transmitted on all VLs from the port", HFILL}\r\n},\r\n{ &hf_infiniband_PortCounters_PortRcvData, {\r\n"PortRcvData", "infiniband.portcounters.portrcvdata",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Total number of data octets, divided by 4, received on all VLs at the port", HFILL}\r\n},\r\n{ &hf_infiniband_PortCounters_PortXmitPkts, {\r\n"PortXmitPkts", "infiniband.portcounters.portxmitpkts",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Total number of packets transmitted on all VLs from the port", HFILL}\r\n},\r\n{ &hf_infiniband_PortCounters_PortRcvPkts, {\r\n"PortRcvPkts", "infiniband.portcounters.portrcvpkts",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Total number of packets received from all VLs on the port", HFILL}\r\n},\r\n{ &hf_infiniband_PortCountersExt, {\r\n"Port Counters Extended (Performance Management MAD)", "infiniband.portcounters_ext",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\n"Performance class PortCountersExtended packet", HFILL}\r\n},\r\n{ &hf_infiniband_PortCountersExt_PortSelect, {\r\n"PortSelect", "infiniband.portcounters_ext.portselect",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\n"Selects the port that will be accessed", HFILL}\r\n},\r\n{ &hf_infiniband_PortCountersExt_CounterSelect, {\r\n"CounterSelect", "infiniband.portcounters_ext.counterselect",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\n"When writing, selects which counters are affected by the operation", HFILL}\r\n},\r\n{ &hf_infiniband_PortCountersExt_PortXmitData, {\r\n"PortXmitData", "infiniband.portcounters_ext.portxmitdata",\r\nFT_UINT64, BASE_DEC, NULL, 0x0,\r\n"Total number of data octets, divided by 4, transmitted on all VLs from the port", HFILL}\r\n},\r\n{ &hf_infiniband_PortCountersExt_PortRcvData, {\r\n"PortRcvData", "infiniband.portcounters_ext.portrcvdata",\r\nFT_UINT64, BASE_DEC, NULL, 0x0,\r\n"Total number of data octets, divided by 4, received on all VLs at the port", HFILL}\r\n},\r\n{ &hf_infiniband_PortCountersExt_PortXmitPkts, {\r\n"PortXmitPkts", "infiniband.portcounters_ext.portxmitpkts",\r\nFT_UINT64, BASE_DEC, NULL, 0x0,\r\n"Total number of packets transmitted on all VLs from the port", HFILL}\r\n},\r\n{ &hf_infiniband_PortCountersExt_PortRcvPkts, {\r\n"PortRcvPkts", "infiniband.portcounters_ext.portrcvpkts",\r\nFT_UINT64, BASE_DEC, NULL, 0x0,\r\n"Total number of packets received from all VLs on the port", HFILL}\r\n},\r\n{ &hf_infiniband_PortCountersExt_PortUnicastXmitPkts, {\r\n"PortUnicastXmitPkts", "infiniband.portcounters_ext.portunicastxmitpkts",\r\nFT_UINT64, BASE_DEC, NULL, 0x0,\r\n"Total number of unicast packets transmitted on all VLs from the port", HFILL}\r\n},\r\n{ &hf_infiniband_PortCountersExt_PortUnicastRcvPkts, {\r\n"PortUnicastRcvPkts", "infiniband.portcounters_ext.portunicastrcvpkts",\r\nFT_UINT64, BASE_DEC, NULL, 0x0,\r\n"Total number of unicast packets received from all VLs on the port", HFILL}\r\n},\r\n{ &hf_infiniband_PortCountersExt_PortMulticastXmitPkts, {\r\n"PortMulticastXmitPkts", "infiniband.portcounters_ext.portmulticastxmitpkts",\r\nFT_UINT64, BASE_DEC, NULL, 0x0,\r\n"Total number of multicast packets transmitted on all VLs from the port", HFILL}\r\n},\r\n{ &hf_infiniband_PortCountersExt_PortMulticastRcvPkts, {\r\n"PortMulticastRcvPkts", "infiniband.portcounters_ext.portmulticastrcvpkts",\r\nFT_UINT64, BASE_DEC, NULL, 0x0,\r\n"Total number of multicast packets received from all VLs on the port", HFILL}\r\n}\r\n};\r\nstatic gint *ett[] = {\r\n&ett_all_headers,\r\n&ett_lrh,\r\n&ett_grh,\r\n&ett_bth,\r\n&ett_rwh,\r\n&ett_rdeth,\r\n&ett_deth,\r\n&ett_reth,\r\n&ett_atomiceth,\r\n&ett_aeth,\r\n&ett_atomicacketh,\r\n&ett_immdt,\r\n&ett_ieth,\r\n&ett_payload,\r\n&ett_vendor,\r\n&ett_subn_lid_routed,\r\n&ett_subn_directed_route,\r\n&ett_subnadmin,\r\n&ett_cm,\r\n&ett_mad,\r\n&ett_rmpp,\r\n&ett_subm_attribute,\r\n&ett_suba_attribute,\r\n&ett_datadetails,\r\n&ett_noticestraps,\r\n&ett_portinfo_capmask,\r\n&ett_pkeytable,\r\n&ett_sltovlmapping,\r\n&ett_vlarbitrationtable,\r\n&ett_linearforwardingtable,\r\n&ett_randomforwardingtable,\r\n&ett_multicastforwardingtable,\r\n&ett_sminfo,\r\n&ett_vendordiag,\r\n&ett_ledinfo,\r\n&ett_linkspeedwidthpairs,\r\n&ett_informinfo,\r\n&ett_linkrecord,\r\n&ett_servicerecord,\r\n&ett_pathrecord,\r\n&ett_mcmemberrecord,\r\n&ett_tracerecord,\r\n&ett_multipathrecord,\r\n&ett_serviceassocrecord,\r\n&ett_perfclass,\r\n&ett_eoib\r\n};\r\nstatic hf_register_info hf_link[] = {\r\n{ &hf_infiniband_link_op, {\r\n"Operand", "infiniband_link.op",\r\nFT_UINT16, BASE_DEC, VALS(Operand_Description), 0xF000, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_link_fctbs, {\r\n"Flow Control Total Blocks Sent", "infiniband_link.fctbs",\r\nFT_UINT16, BASE_DEC, NULL, 0x0FFF, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_link_vl, {\r\n"Virtual Lane", "infiniband_link.vl",\r\nFT_UINT16, BASE_DEC, NULL, 0xF000, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_link_fccl, {\r\n"Flow Control Credit Limit", "infiniband_link.fccl",\r\nFT_UINT16, BASE_DEC, NULL, 0x0FFF, NULL, HFILL}\r\n},\r\n{ &hf_infiniband_link_lpcrc, {\r\n"Link Packet CRC", "infiniband_link.lpcrc",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL}\r\n}\r\n};\r\nstatic gint *ett_link_array[] = {\r\n&ett_link\r\n};\r\nproto_infiniband = proto_register_protocol("InfiniBand", "IB", "infiniband");\r\nib_handle = register_dissector("infiniband", dissect_infiniband, proto_infiniband);\r\nproto_register_field_array(proto_infiniband, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nheur_dissectors_payload = register_heur_dissector_list("infiniband.payload", proto_infiniband);\r\nheur_dissectors_cm_private = register_heur_dissector_list("infiniband.mad.cm.private", proto_infiniband);\r\ninfiniband_module = prefs_register_protocol(proto_infiniband, proto_reg_handoff_infiniband);\r\nprefs_register_bool_preference(infiniband_module, "identify_payload",\r\n"Attempt to identify and parse encapsulated IBA payloads",\r\n"When set, dissector will attempt to identify unknown IBA payloads "\r\n"as containing an encapsulated ethertype, and parse them accordingly",\r\n&pref_identify_iba_payload);\r\nprefs_register_bool_preference(infiniband_module, "dissect_eoib",\r\n"Attempt to identify and parse Mellanox EoIB packets",\r\n"When set, dissector will attempt to identify and parse "\r\n"Mellanox Ethernet-over-InfiniBand packets",\r\n&pref_dissect_eoib);\r\nprefs_register_uint_preference(infiniband_module, "rroce.port", "RRoce UDP Port(Default 1021)", "when set "\r\n"the Analyser will consider this as RRoce UDP Port and parse it accordingly",\r\n10, &pref_rroce_udp_port);\r\nproto_infiniband_link = proto_register_protocol("InfiniBand Link", "InfiniBand Link", "infiniband_link");\r\nib_link_handle = register_dissector("infiniband_link", dissect_infiniband_link, proto_infiniband_link);\r\nproto_register_field_array(proto_infiniband_link, hf_link, array_length(hf_link));\r\nproto_register_subtree_array(ett_link_array, array_length(ett_link_array));\r\nCM_context_table = g_hash_table_new_full(g_int64_hash, g_int64_equal,\r\ntable_destroy_notify, table_destroy_notify);\r\n}\r\nvoid proto_reg_handoff_infiniband(void)\r\n{\r\nstatic gboolean initialized = FALSE;\r\nstatic guint prev_rroce_udp_port;\r\ndissector_handle_t roce_handle, rroce_handle;\r\nipv6_handle = find_dissector_add_dependency("ipv6", proto_infiniband);\r\neth_handle = find_dissector("eth_withoutfcs");\r\nethertype_dissector_table = find_dissector_table("ethertype");\r\ndissector_add_uint("erf.types.type", ERF_TYPE_INFINIBAND, ib_handle);\r\ndissector_add_uint("erf.types.type", ERF_TYPE_INFINIBAND_LINK, ib_link_handle);\r\nroce_handle = create_dissector_handle(dissect_roce, proto_infiniband);\r\ndissector_add_uint("ethertype", ETHERTYPE_ROCE, roce_handle);\r\nrroce_handle = create_dissector_handle(dissect_rroce, proto_infiniband);\r\nif (!initialized)\r\n{\r\ninitialized = TRUE;\r\n}\r\nelse\r\n{\r\ndissector_delete_uint("udp.port", prev_rroce_udp_port, rroce_handle);\r\n}\r\nprev_rroce_udp_port = pref_rroce_udp_port;\r\ndissector_add_uint("udp.port", pref_rroce_udp_port, rroce_handle);\r\ndissector_add_uint("wtap_encap", WTAP_ENCAP_INFINIBAND, ib_handle);\r\n}
