static void\r\ncms_verify_msg_digest(proto_item *pi, tvbuff_t *content, const char *alg, tvbuff_t *tvb, int offset)\r\n{\r\nsha1_context sha1_ctx;\r\nmd5_state_t md5_ctx;\r\nint i= 0, buffer_size = 0;\r\nif(strcmp(alg, HASH_SHA1) == 0) {\r\nsha1_starts(&sha1_ctx);\r\nsha1_update(&sha1_ctx, tvb_get_ptr(content, 0, tvb_captured_length(content)),\r\ntvb_captured_length(content));\r\nsha1_finish(&sha1_ctx, digest_buf);\r\nbuffer_size = SHA1_DIGEST_LEN;\r\n} else if(strcmp(alg, HASH_MD5) == 0) {\r\nmd5_init(&md5_ctx);\r\nmd5_append(&md5_ctx, tvb_get_ptr(content, 0, tvb_captured_length(content)),\r\ntvb_captured_length(content));\r\nmd5_finish(&md5_ctx, digest_buf);\r\nbuffer_size = MD5_BUFFER_SIZE;\r\n}\r\nif(buffer_size) {\r\nif(tvb_bytes_exist(tvb, offset, buffer_size) &&\r\n(tvb_memeql(tvb, offset, digest_buf, buffer_size) != 0)) {\r\nproto_item_append_text(pi, " [incorrect, should be ");\r\nfor(i = 0; i < buffer_size; i++)\r\nproto_item_append_text(pi, "%02X", digest_buf[i]);\r\nproto_item_append_text(pi, "]");\r\n}\r\nelse\r\nproto_item_append_text(pi, " [correct]");\r\n} else {\r\nproto_item_append_text(pi, " [unable to verify]");\r\n}\r\n}\r\nint\r\ndissect_cms_ContentType(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 88 "./asn1/cms/cms.cnf"\r\nconst char *name = NULL;\r\noffset = dissect_ber_object_identifier_str(implicit_tag, actx, tree, tvb, offset, hf_index, &object_identifier_id);\r\nif(object_identifier_id) {\r\nname = oid_resolved_from_string(wmem_packet_scope(), object_identifier_id);\r\nproto_item_append_text(tree, " (%s)", name ? name : object_identifier_id);\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_T_content(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 98 "./asn1/cms/cms.cnf"\r\noffset=call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);\r\nreturn offset;\r\n}\r\nint\r\ndissect_cms_ContentInfo(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 79 "./asn1/cms/cms.cnf"\r\ntop_tree = tree;\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nContentInfo_sequence, hf_index, ett_cms_ContentInfo);\r\ncontent_tvb = NULL;\r\ntop_tree = NULL;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_CMSVersion(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nint\r\ndissect_cms_DigestAlgorithmIdentifier(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_x509af_AlgorithmIdentifier(implicit_tag, tvb, offset, actx, tree, hf_index);\r\nreturn offset;\r\n}\r\nint\r\ndissect_cms_DigestAlgorithmIdentifiers(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_set_of(implicit_tag, actx, tree, tvb, offset,\r\nDigestAlgorithmIdentifiers_set_of, hf_index, ett_cms_DigestAlgorithmIdentifiers);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_T_eContent(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 102 "./asn1/cms/cms.cnf"\r\noffset = dissect_ber_octet_string(FALSE, actx, tree, tvb, offset, hf_index, &content_tvb);\r\nproto_item_set_text(actx->created_item, "eContent (%u bytes)", tvb_reported_length (content_tvb));\r\ncall_ber_oid_callback(object_identifier_id, content_tvb, 0, actx->pinfo, top_tree ? top_tree : tree, NULL);\r\nreturn offset;\r\n}\r\nint\r\ndissect_cms_EncapsulatedContentInfo(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nEncapsulatedContentInfo_sequence, hf_index, ett_cms_EncapsulatedContentInfo);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_T_attrType(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 129 "./asn1/cms/cms.cnf"\r\nconst char *name = NULL;\r\noffset = dissect_ber_object_identifier_str(implicit_tag, actx, tree, tvb, offset, hf_cms_attrType, &object_identifier_id);\r\nif(object_identifier_id) {\r\nname = oid_resolved_from_string(wmem_packet_scope(), object_identifier_id);\r\nproto_item_append_text(tree, " (%s)", name ? name : object_identifier_id);\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_AttributeValue(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 139 "./asn1/cms/cms.cnf"\r\noffset=call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_SET_OF_AttributeValue(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_set_of(implicit_tag, actx, tree, tvb, offset,\r\nSET_OF_AttributeValue_set_of, hf_index, ett_cms_SET_OF_AttributeValue);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_Attribute(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nAttribute_sequence, hf_index, ett_cms_Attribute);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_UnauthAttributes(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_constrained_set_of(implicit_tag, actx, tree, tvb, offset,\r\n1, NO_BOUND, UnauthAttributes_set_of, hf_index, ett_cms_UnauthAttributes);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_ExtendedCertificateInfo(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nExtendedCertificateInfo_sequence, hf_index, ett_cms_ExtendedCertificateInfo);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_SignatureAlgorithmIdentifier(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_x509af_AlgorithmIdentifier(implicit_tag, tvb, offset, actx, tree, hf_index);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_Signature(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_bitstring(implicit_tag, actx, tree, tvb, offset,\r\nNULL, hf_index, -1,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_ExtendedCertificate(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nExtendedCertificate_sequence, hf_index, ett_cms_ExtendedCertificate);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_AttCertVersionV1(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_T_subject(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_choice(actx, tree, tvb, offset,\r\nT_subject_choice, hf_index, ett_cms_T_subject,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_SEQUENCE_OF_Attribute(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence_of(implicit_tag, actx, tree, tvb, offset,\r\nSEQUENCE_OF_Attribute_sequence_of, hf_index, ett_cms_SEQUENCE_OF_Attribute);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_AttributeCertificateInfoV1(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nAttributeCertificateInfoV1_sequence, hf_index, ett_cms_AttributeCertificateInfoV1);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_BIT_STRING(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_bitstring(implicit_tag, actx, tree, tvb, offset,\r\nNULL, hf_index, -1,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_AttributeCertificateV1(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nAttributeCertificateV1_sequence, hf_index, ett_cms_AttributeCertificateV1);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_AttributeCertificateV2(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_x509af_AttributeCertificate(implicit_tag, tvb, offset, actx, tree, hf_index);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_CertificateChoices(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_choice(actx, tree, tvb, offset,\r\nCertificateChoices_choice, hf_index, ett_cms_CertificateChoices,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_CertificateSet(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_set_of(implicit_tag, actx, tree, tvb, offset,\r\nCertificateSet_set_of, hf_index, ett_cms_CertificateSet);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_T_otherRevInfoFormat(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_object_identifier_str(implicit_tag, actx, tree, tvb, offset, hf_index, &object_identifier_id);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_T_otherRevInfo(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 123 "./asn1/cms/cms.cnf"\r\noffset=call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_OtherRevocationInfoFormat(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nOtherRevocationInfoFormat_sequence, hf_index, ett_cms_OtherRevocationInfoFormat);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_RevocationInfoChoice(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_choice(actx, tree, tvb, offset,\r\nRevocationInfoChoice_choice, hf_index, ett_cms_RevocationInfoChoice,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_RevocationInfoChoices(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_set_of(implicit_tag, actx, tree, tvb, offset,\r\nRevocationInfoChoices_set_of, hf_index, ett_cms_RevocationInfoChoices);\r\nreturn offset;\r\n}\r\nint\r\ndissect_cms_IssuerAndSerialNumber(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nIssuerAndSerialNumber_sequence, hf_index, ett_cms_IssuerAndSerialNumber);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_SubjectKeyIdentifier(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_octet_string(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nint\r\ndissect_cms_SignerIdentifier(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_choice(actx, tree, tvb, offset,\r\nSignerIdentifier_choice, hf_index, ett_cms_SignerIdentifier,\r\nNULL);\r\nreturn offset;\r\n}\r\nint\r\ndissect_cms_SignedAttributes(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_constrained_set_of(implicit_tag, actx, tree, tvb, offset,\r\n1, NO_BOUND, SignedAttributes_set_of, hf_index, ett_cms_SignedAttributes);\r\nreturn offset;\r\n}\r\nint\r\ndissect_cms_SignatureValue(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_octet_string(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nint\r\ndissect_cms_UnsignedAttributes(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_constrained_set_of(implicit_tag, actx, tree, tvb, offset,\r\n1, NO_BOUND, UnsignedAttributes_set_of, hf_index, ett_cms_UnsignedAttributes);\r\nreturn offset;\r\n}\r\nint\r\ndissect_cms_SignerInfo(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nSignerInfo_sequence, hf_index, ett_cms_SignerInfo);\r\nreturn offset;\r\n}\r\nint\r\ndissect_cms_SignerInfos(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_set_of(implicit_tag, actx, tree, tvb, offset,\r\nSignerInfos_set_of, hf_index, ett_cms_SignerInfos);\r\nreturn offset;\r\n}\r\nint\r\ndissect_cms_SignedData(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nSignedData_sequence, hf_index, ett_cms_SignedData);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_OriginatorInfo(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nOriginatorInfo_sequence, hf_index, ett_cms_OriginatorInfo);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_RecipientIdentifier(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_choice(actx, tree, tvb, offset,\r\nRecipientIdentifier_choice, hf_index, ett_cms_RecipientIdentifier,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_KeyEncryptionAlgorithmIdentifier(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_x509af_AlgorithmIdentifier(implicit_tag, tvb, offset, actx, tree, hf_index);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_EncryptedKey(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_octet_string(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_KeyTransRecipientInfo(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nKeyTransRecipientInfo_sequence, hf_index, ett_cms_KeyTransRecipientInfo);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_OriginatorPublicKey(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nOriginatorPublicKey_sequence, hf_index, ett_cms_OriginatorPublicKey);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_OriginatorIdentifierOrKey(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_choice(actx, tree, tvb, offset,\r\nOriginatorIdentifierOrKey_choice, hf_index, ett_cms_OriginatorIdentifierOrKey,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_UserKeyingMaterial(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_octet_string(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_GeneralizedTime(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_GeneralizedTime(implicit_tag, actx, tree, tvb, offset, hf_index);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_T_keyAttrId(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_object_identifier_str(implicit_tag, actx, tree, tvb, offset, hf_cms_ci_contentType, &object_identifier_id);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_T_keyAttr(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 118 "./asn1/cms/cms.cnf"\r\noffset=call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_OtherKeyAttribute(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nOtherKeyAttribute_sequence, hf_index, ett_cms_OtherKeyAttribute);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_RecipientKeyIdentifier(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nRecipientKeyIdentifier_sequence, hf_index, ett_cms_RecipientKeyIdentifier);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_KeyAgreeRecipientIdentifier(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_choice(actx, tree, tvb, offset,\r\nKeyAgreeRecipientIdentifier_choice, hf_index, ett_cms_KeyAgreeRecipientIdentifier,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_RecipientEncryptedKey(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nRecipientEncryptedKey_sequence, hf_index, ett_cms_RecipientEncryptedKey);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_RecipientEncryptedKeys(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence_of(implicit_tag, actx, tree, tvb, offset,\r\nRecipientEncryptedKeys_sequence_of, hf_index, ett_cms_RecipientEncryptedKeys);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_KeyAgreeRecipientInfo(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nKeyAgreeRecipientInfo_sequence, hf_index, ett_cms_KeyAgreeRecipientInfo);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_OCTET_STRING(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_octet_string(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_KEKIdentifier(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nKEKIdentifier_sequence, hf_index, ett_cms_KEKIdentifier);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_KEKRecipientInfo(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nKEKRecipientInfo_sequence, hf_index, ett_cms_KEKRecipientInfo);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_KeyDerivationAlgorithmIdentifier(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_x509af_AlgorithmIdentifier(implicit_tag, tvb, offset, actx, tree, hf_index);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_PasswordRecipientInfo(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nPasswordRecipientInfo_sequence, hf_index, ett_cms_PasswordRecipientInfo);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_T_oriType(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_object_identifier_str(implicit_tag, actx, tree, tvb, offset, hf_index, &object_identifier_id);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_T_oriValue(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 112 "./asn1/cms/cms.cnf"\r\noffset=call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_OtherRecipientInfo(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nOtherRecipientInfo_sequence, hf_index, ett_cms_OtherRecipientInfo);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_RecipientInfo(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_choice(actx, tree, tvb, offset,\r\nRecipientInfo_choice, hf_index, ett_cms_RecipientInfo,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_RecipientInfos(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_constrained_set_of(implicit_tag, actx, tree, tvb, offset,\r\n1, NO_BOUND, RecipientInfos_set_of, hf_index, ett_cms_RecipientInfos);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_ContentEncryptionAlgorithmIdentifier(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_x509af_AlgorithmIdentifier(implicit_tag, tvb, offset, actx, tree, hf_index);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_EncryptedContent(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 189 "./asn1/cms/cms.cnf"\r\ntvbuff_t *encrypted_tvb;\r\nproto_item *item;\r\noffset = dissect_ber_octet_string(implicit_tag, actx, tree, tvb, offset, hf_index,\r\n&encrypted_tvb);\r\n#line 194 "./asn1/cms/cms.cnf"\r\nitem = actx->created_item;\r\nPBE_decrypt_data(object_identifier_id, encrypted_tvb, actx, item);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_EncryptedContentInfo(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nEncryptedContentInfo_sequence, hf_index, ett_cms_EncryptedContentInfo);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_UnprotectedAttributes(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_constrained_set_of(implicit_tag, actx, tree, tvb, offset,\r\n1, NO_BOUND, UnprotectedAttributes_set_of, hf_index, ett_cms_UnprotectedAttributes);\r\nreturn offset;\r\n}\r\nint\r\ndissect_cms_EnvelopedData(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nEnvelopedData_sequence, hf_index, ett_cms_EnvelopedData);\r\nreturn offset;\r\n}\r\nint\r\ndissect_cms_Digest(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_octet_string(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_DigestedData(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nDigestedData_sequence, hf_index, ett_cms_DigestedData);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_EncryptedData(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nEncryptedData_sequence, hf_index, ett_cms_EncryptedData);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_MessageAuthenticationCodeAlgorithm(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_x509af_AlgorithmIdentifier(implicit_tag, tvb, offset, actx, tree, hf_index);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_AuthAttributes(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_constrained_set_of(implicit_tag, actx, tree, tvb, offset,\r\n1, NO_BOUND, AuthAttributes_set_of, hf_index, ett_cms_AuthAttributes);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_MessageAuthenticationCode(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_octet_string(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_AuthenticatedData(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nAuthenticatedData_sequence, hf_index, ett_cms_AuthenticatedData);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_MessageDigest(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 143 "./asn1/cms/cms.cnf"\r\nproto_item *pi;\r\nint old_offset = offset;\r\noffset = dissect_ber_octet_string(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\npi = actx->created_item;\r\nold_offset = get_ber_identifier(tvb, old_offset, NULL, NULL, NULL);\r\nold_offset = get_ber_length(tvb, old_offset, NULL, NULL);\r\nif(content_tvb)\r\ncms_verify_msg_digest(pi, content_tvb, x509af_get_last_algorithm_id(), tvb, old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_UTCTime(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_UTCTime(implicit_tag, actx, tree, tvb, offset, hf_index);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_Time(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_choice(actx, tree, tvb, offset,\r\nTime_choice, hf_index, ett_cms_Time,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_SigningTime(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_cms_Time(implicit_tag, tvb, offset, actx, tree, hf_index);\r\nreturn offset;\r\n}\r\nint\r\ndissect_cms_Countersignature(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_cms_SignerInfo(implicit_tag, tvb, offset, actx, tree, hf_index);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_RC2ParameterVersion(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 179 "./asn1/cms/cms.cnf"\r\nguint32 length = 0;\r\noffset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,\r\n&length);\r\nif(cap_tree != NULL)\r\nproto_item_append_text(cap_tree, " (%d bits)", length);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_RC2WrapParameter(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_cms_RC2ParameterVersion(implicit_tag, tvb, offset, actx, tree, hf_index);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_INTEGER(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_RC2CBCParameter(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nRC2CBCParameter_sequence, hf_index, ett_cms_RC2CBCParameter);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_T_capability(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 161 "./asn1/cms/cms.cnf"\r\nconst char *name = NULL;\r\noffset = dissect_ber_object_identifier_str(implicit_tag, actx, tree, tvb, offset, hf_cms_attrType, &object_identifier_id);\r\nif(object_identifier_id) {\r\nname = oid_resolved_from_string(wmem_packet_scope(), object_identifier_id);\r\nproto_item_append_text(tree, " %s", name ? name : object_identifier_id);\r\ncap_tree = tree;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_T_parameters(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 172 "./asn1/cms/cms.cnf"\r\noffset=call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_SMIMECapability(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nSMIMECapability_sequence, hf_index, ett_cms_SMIMECapability);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_SMIMECapabilities(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence_of(implicit_tag, actx, tree, tvb, offset,\r\nSMIMECapabilities_sequence_of, hf_index, ett_cms_SMIMECapabilities);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_SMIMEEncryptionKeyPreference(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_choice(actx, tree, tvb, offset,\r\nSMIMEEncryptionKeyPreference_choice, hf_index, ett_cms_SMIMEEncryptionKeyPreference,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cms_RC2CBCParameters(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_choice(actx, tree, tvb, offset,\r\nRC2CBCParameters_choice, hf_index, ett_cms_RC2CBCParameters,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int dissect_ContentInfo_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_cms_ContentInfo(FALSE, tvb, offset, &asn1_ctx, tree, hf_cms_ContentInfo_PDU);\r\nreturn offset;\r\n}\r\nstatic int dissect_ContentType_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_cms_ContentType(FALSE, tvb, offset, &asn1_ctx, tree, hf_cms_ContentType_PDU);\r\nreturn offset;\r\n}\r\nstatic int dissect_SignedData_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_cms_SignedData(FALSE, tvb, offset, &asn1_ctx, tree, hf_cms_SignedData_PDU);\r\nreturn offset;\r\n}\r\nstatic int dissect_EnvelopedData_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_cms_EnvelopedData(FALSE, tvb, offset, &asn1_ctx, tree, hf_cms_EnvelopedData_PDU);\r\nreturn offset;\r\n}\r\nstatic int dissect_DigestedData_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_cms_DigestedData(FALSE, tvb, offset, &asn1_ctx, tree, hf_cms_DigestedData_PDU);\r\nreturn offset;\r\n}\r\nstatic int dissect_EncryptedData_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_cms_EncryptedData(FALSE, tvb, offset, &asn1_ctx, tree, hf_cms_EncryptedData_PDU);\r\nreturn offset;\r\n}\r\nstatic int dissect_AuthenticatedData_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_cms_AuthenticatedData(FALSE, tvb, offset, &asn1_ctx, tree, hf_cms_AuthenticatedData_PDU);\r\nreturn offset;\r\n}\r\nstatic int dissect_IssuerAndSerialNumber_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_cms_IssuerAndSerialNumber(FALSE, tvb, offset, &asn1_ctx, tree, hf_cms_IssuerAndSerialNumber_PDU);\r\nreturn offset;\r\n}\r\nstatic int dissect_MessageDigest_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_cms_MessageDigest(FALSE, tvb, offset, &asn1_ctx, tree, hf_cms_MessageDigest_PDU);\r\nreturn offset;\r\n}\r\nstatic int dissect_SigningTime_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_cms_SigningTime(FALSE, tvb, offset, &asn1_ctx, tree, hf_cms_SigningTime_PDU);\r\nreturn offset;\r\n}\r\nstatic int dissect_Countersignature_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_cms_Countersignature(FALSE, tvb, offset, &asn1_ctx, tree, hf_cms_Countersignature_PDU);\r\nreturn offset;\r\n}\r\nstatic int dissect_RC2WrapParameter_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_cms_RC2WrapParameter(FALSE, tvb, offset, &asn1_ctx, tree, hf_cms_RC2WrapParameter_PDU);\r\nreturn offset;\r\n}\r\nstatic int dissect_SMIMECapabilities_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_cms_SMIMECapabilities(FALSE, tvb, offset, &asn1_ctx, tree, hf_cms_SMIMECapabilities_PDU);\r\nreturn offset;\r\n}\r\nstatic int dissect_SMIMEEncryptionKeyPreference_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_cms_SMIMEEncryptionKeyPreference(FALSE, tvb, offset, &asn1_ctx, tree, hf_cms_SMIMEEncryptionKeyPreference_PDU);\r\nreturn offset;\r\n}\r\nstatic int dissect_RC2CBCParameters_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_cms_RC2CBCParameters(FALSE, tvb, offset, &asn1_ctx, tree, hf_cms_RC2CBCParameters_PDU);\r\nreturn offset;\r\n}\r\nvoid proto_register_cms(void) {\r\nstatic hf_register_info hf[] = {\r\n{ &hf_cms_ci_contentType,\r\n{ "contentType", "cms.contentInfo.contentType",\r\nFT_OID, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n#line 1 "./asn1/cms/packet-cms-hfarr.c"\r\n{ &hf_cms_ContentInfo_PDU,\r\n{ "ContentInfo", "cms.ContentInfo_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_ContentType_PDU,\r\n{ "ContentType", "cms.ContentType",\r\nFT_OID, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_SignedData_PDU,\r\n{ "SignedData", "cms.SignedData_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_EnvelopedData_PDU,\r\n{ "EnvelopedData", "cms.EnvelopedData_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_DigestedData_PDU,\r\n{ "DigestedData", "cms.DigestedData_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_EncryptedData_PDU,\r\n{ "EncryptedData", "cms.EncryptedData_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_AuthenticatedData_PDU,\r\n{ "AuthenticatedData", "cms.AuthenticatedData_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_IssuerAndSerialNumber_PDU,\r\n{ "IssuerAndSerialNumber", "cms.IssuerAndSerialNumber_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_MessageDigest_PDU,\r\n{ "MessageDigest", "cms.MessageDigest",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_SigningTime_PDU,\r\n{ "SigningTime", "cms.SigningTime",\r\nFT_UINT32, BASE_DEC, VALS(cms_Time_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_Countersignature_PDU,\r\n{ "Countersignature", "cms.Countersignature_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_RC2WrapParameter_PDU,\r\n{ "RC2WrapParameter", "cms.RC2WrapParameter",\r\nFT_INT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_SMIMECapabilities_PDU,\r\n{ "SMIMECapabilities", "cms.SMIMECapabilities",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_SMIMEEncryptionKeyPreference_PDU,\r\n{ "SMIMEEncryptionKeyPreference", "cms.SMIMEEncryptionKeyPreference",\r\nFT_UINT32, BASE_DEC, VALS(cms_SMIMEEncryptionKeyPreference_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_RC2CBCParameters_PDU,\r\n{ "RC2CBCParameters", "cms.RC2CBCParameters",\r\nFT_UINT32, BASE_DEC, VALS(cms_RC2CBCParameters_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_contentType,\r\n{ "contentType", "cms.contentType",\r\nFT_OID, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_content,\r\n{ "content", "cms.content_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_version,\r\n{ "version", "cms.version",\r\nFT_INT32, BASE_DEC, VALS(cms_CMSVersion_vals), 0,\r\n"CMSVersion", HFILL }},\r\n{ &hf_cms_digestAlgorithms,\r\n{ "digestAlgorithms", "cms.digestAlgorithms",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"DigestAlgorithmIdentifiers", HFILL }},\r\n{ &hf_cms_encapContentInfo,\r\n{ "encapContentInfo", "cms.encapContentInfo_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"EncapsulatedContentInfo", HFILL }},\r\n{ &hf_cms_certificates,\r\n{ "certificates", "cms.certificates",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"CertificateSet", HFILL }},\r\n{ &hf_cms_crls,\r\n{ "crls", "cms.crls",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"RevocationInfoChoices", HFILL }},\r\n{ &hf_cms_signerInfos,\r\n{ "signerInfos", "cms.signerInfos",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_DigestAlgorithmIdentifiers_item,\r\n{ "DigestAlgorithmIdentifier", "cms.DigestAlgorithmIdentifier_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_SignerInfos_item,\r\n{ "SignerInfo", "cms.SignerInfo_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_eContentType,\r\n{ "eContentType", "cms.eContentType",\r\nFT_OID, BASE_NONE, NULL, 0,\r\n"ContentType", HFILL }},\r\n{ &hf_cms_eContent,\r\n{ "eContent", "cms.eContent",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_sid,\r\n{ "sid", "cms.sid",\r\nFT_UINT32, BASE_DEC, VALS(cms_SignerIdentifier_vals), 0,\r\n"SignerIdentifier", HFILL }},\r\n{ &hf_cms_digestAlgorithm,\r\n{ "digestAlgorithm", "cms.digestAlgorithm_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"DigestAlgorithmIdentifier", HFILL }},\r\n{ &hf_cms_signedAttrs,\r\n{ "signedAttrs", "cms.signedAttrs",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"SignedAttributes", HFILL }},\r\n{ &hf_cms_signatureAlgorithm,\r\n{ "signatureAlgorithm", "cms.signatureAlgorithm_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"SignatureAlgorithmIdentifier", HFILL }},\r\n{ &hf_cms_signatureValue,\r\n{ "signature", "cms.signature",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"SignatureValue", HFILL }},\r\n{ &hf_cms_unsignedAttrs,\r\n{ "unsignedAttrs", "cms.unsignedAttrs",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"UnsignedAttributes", HFILL }},\r\n{ &hf_cms_issuerAndSerialNumber,\r\n{ "issuerAndSerialNumber", "cms.issuerAndSerialNumber_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_subjectKeyIdentifier,\r\n{ "subjectKeyIdentifier", "cms.subjectKeyIdentifier",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_SignedAttributes_item,\r\n{ "Attribute", "cms.Attribute_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_UnsignedAttributes_item,\r\n{ "Attribute", "cms.Attribute_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_attrType,\r\n{ "attrType", "cms.attrType",\r\nFT_OID, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_attrValues,\r\n{ "attrValues", "cms.attrValues",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"SET_OF_AttributeValue", HFILL }},\r\n{ &hf_cms_attrValues_item,\r\n{ "AttributeValue", "cms.AttributeValue_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_originatorInfo,\r\n{ "originatorInfo", "cms.originatorInfo_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_recipientInfos,\r\n{ "recipientInfos", "cms.recipientInfos",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_encryptedContentInfo,\r\n{ "encryptedContentInfo", "cms.encryptedContentInfo_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_unprotectedAttrs,\r\n{ "unprotectedAttrs", "cms.unprotectedAttrs",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"UnprotectedAttributes", HFILL }},\r\n{ &hf_cms_certs,\r\n{ "certs", "cms.certs",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"CertificateSet", HFILL }},\r\n{ &hf_cms_RecipientInfos_item,\r\n{ "RecipientInfo", "cms.RecipientInfo",\r\nFT_UINT32, BASE_DEC, VALS(cms_RecipientInfo_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_encryptedContentType,\r\n{ "contentType", "cms.contentType",\r\nFT_OID, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_contentEncryptionAlgorithm,\r\n{ "contentEncryptionAlgorithm", "cms.contentEncryptionAlgorithm_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"ContentEncryptionAlgorithmIdentifier", HFILL }},\r\n{ &hf_cms_encryptedContent,\r\n{ "encryptedContent", "cms.encryptedContent",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_UnprotectedAttributes_item,\r\n{ "Attribute", "cms.Attribute_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_ktri,\r\n{ "ktri", "cms.ktri_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"KeyTransRecipientInfo", HFILL }},\r\n{ &hf_cms_kari,\r\n{ "kari", "cms.kari_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"KeyAgreeRecipientInfo", HFILL }},\r\n{ &hf_cms_kekri,\r\n{ "kekri", "cms.kekri_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"KEKRecipientInfo", HFILL }},\r\n{ &hf_cms_pwri,\r\n{ "pwri", "cms.pwri_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"PasswordRecipientInfo", HFILL }},\r\n{ &hf_cms_ori,\r\n{ "ori", "cms.ori_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"OtherRecipientInfo", HFILL }},\r\n{ &hf_cms_rid,\r\n{ "rid", "cms.rid",\r\nFT_UINT32, BASE_DEC, VALS(cms_RecipientIdentifier_vals), 0,\r\n"RecipientIdentifier", HFILL }},\r\n{ &hf_cms_keyEncryptionAlgorithm,\r\n{ "keyEncryptionAlgorithm", "cms.keyEncryptionAlgorithm_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"KeyEncryptionAlgorithmIdentifier", HFILL }},\r\n{ &hf_cms_encryptedKey,\r\n{ "encryptedKey", "cms.encryptedKey",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_originator,\r\n{ "originator", "cms.originator",\r\nFT_UINT32, BASE_DEC, VALS(cms_OriginatorIdentifierOrKey_vals), 0,\r\n"OriginatorIdentifierOrKey", HFILL }},\r\n{ &hf_cms_ukm,\r\n{ "ukm", "cms.ukm",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"UserKeyingMaterial", HFILL }},\r\n{ &hf_cms_recipientEncryptedKeys,\r\n{ "recipientEncryptedKeys", "cms.recipientEncryptedKeys",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_originatorKey,\r\n{ "originatorKey", "cms.originatorKey_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"OriginatorPublicKey", HFILL }},\r\n{ &hf_cms_algorithm,\r\n{ "algorithm", "cms.algorithm_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"AlgorithmIdentifier", HFILL }},\r\n{ &hf_cms_publicKey,\r\n{ "publicKey", "cms.publicKey",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"BIT_STRING", HFILL }},\r\n{ &hf_cms_RecipientEncryptedKeys_item,\r\n{ "RecipientEncryptedKey", "cms.RecipientEncryptedKey_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_rekRid,\r\n{ "rid", "cms.rid",\r\nFT_UINT32, BASE_DEC, VALS(cms_KeyAgreeRecipientIdentifier_vals), 0,\r\n"KeyAgreeRecipientIdentifier", HFILL }},\r\n{ &hf_cms_rKeyId,\r\n{ "rKeyId", "cms.rKeyId_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"RecipientKeyIdentifier", HFILL }},\r\n{ &hf_cms_date,\r\n{ "date", "cms.date",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\n"GeneralizedTime", HFILL }},\r\n{ &hf_cms_other,\r\n{ "other", "cms.other_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"OtherKeyAttribute", HFILL }},\r\n{ &hf_cms_kekid,\r\n{ "kekid", "cms.kekid_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"KEKIdentifier", HFILL }},\r\n{ &hf_cms_keyIdentifier,\r\n{ "keyIdentifier", "cms.keyIdentifier",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"OCTET_STRING", HFILL }},\r\n{ &hf_cms_keyDerivationAlgorithm,\r\n{ "keyDerivationAlgorithm", "cms.keyDerivationAlgorithm_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"KeyDerivationAlgorithmIdentifier", HFILL }},\r\n{ &hf_cms_oriType,\r\n{ "oriType", "cms.oriType",\r\nFT_OID, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_oriValue,\r\n{ "oriValue", "cms.oriValue_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_digest,\r\n{ "digest", "cms.digest",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_macAlgorithm,\r\n{ "macAlgorithm", "cms.macAlgorithm_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"MessageAuthenticationCodeAlgorithm", HFILL }},\r\n{ &hf_cms_authAttrs,\r\n{ "authAttrs", "cms.authAttrs",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"AuthAttributes", HFILL }},\r\n{ &hf_cms_mac,\r\n{ "mac", "cms.mac",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"MessageAuthenticationCode", HFILL }},\r\n{ &hf_cms_unauthAttrs,\r\n{ "unauthAttrs", "cms.unauthAttrs",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"UnauthAttributes", HFILL }},\r\n{ &hf_cms_AuthAttributes_item,\r\n{ "Attribute", "cms.Attribute_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_UnauthAttributes_item,\r\n{ "Attribute", "cms.Attribute_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_RevocationInfoChoices_item,\r\n{ "RevocationInfoChoice", "cms.RevocationInfoChoice",\r\nFT_UINT32, BASE_DEC, VALS(cms_RevocationInfoChoice_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_crl,\r\n{ "crl", "cms.crl_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"CertificateList", HFILL }},\r\n{ &hf_cms_otherRIC,\r\n{ "other", "cms.other_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"OtherRevocationInfoFormat", HFILL }},\r\n{ &hf_cms_otherRevInfoFormat,\r\n{ "otherRevInfoFormat", "cms.otherRevInfoFormat",\r\nFT_OID, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_otherRevInfo,\r\n{ "otherRevInfo", "cms.otherRevInfo_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_certificate,\r\n{ "certificate", "cms.certificate_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_extendedCertificate,\r\n{ "extendedCertificate", "cms.extendedCertificate_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_v1AttrCert,\r\n{ "v1AttrCert", "cms.v1AttrCert_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"AttributeCertificateV1", HFILL }},\r\n{ &hf_cms_v2AttrCert,\r\n{ "v2AttrCert", "cms.v2AttrCert_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"AttributeCertificateV2", HFILL }},\r\n{ &hf_cms_CertificateSet_item,\r\n{ "CertificateChoices", "cms.CertificateChoices",\r\nFT_UINT32, BASE_DEC, VALS(cms_CertificateChoices_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_issuer,\r\n{ "issuer", "cms.issuer",\r\nFT_UINT32, BASE_DEC, VALS(x509if_Name_vals), 0,\r\n"Name", HFILL }},\r\n{ &hf_cms_serialNumber,\r\n{ "serialNumber", "cms.serialNumber",\r\nFT_INT64, BASE_DEC, NULL, 0,\r\n"CertificateSerialNumber", HFILL }},\r\n{ &hf_cms_keyAttrId,\r\n{ "keyAttrId", "cms.keyAttrId",\r\nFT_OID, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_keyAttr,\r\n{ "keyAttr", "cms.keyAttr_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_utcTime,\r\n{ "utcTime", "cms.utcTime",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_generalTime,\r\n{ "generalTime", "cms.generalTime",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\n"GeneralizedTime", HFILL }},\r\n{ &hf_cms_rc2ParameterVersion,\r\n{ "rc2ParameterVersion", "cms.rc2ParameterVersion",\r\nFT_INT32, BASE_DEC, NULL, 0,\r\n"INTEGER", HFILL }},\r\n{ &hf_cms_iv,\r\n{ "iv", "cms.iv",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"OCTET_STRING", HFILL }},\r\n{ &hf_cms_extendedCertificateInfo,\r\n{ "extendedCertificateInfo", "cms.extendedCertificateInfo_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_signature,\r\n{ "signature", "cms.signature",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_attributes,\r\n{ "attributes", "cms.attributes",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"UnauthAttributes", HFILL }},\r\n{ &hf_cms_SMIMECapabilities_item,\r\n{ "SMIMECapability", "cms.SMIMECapability_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_capability,\r\n{ "capability", "cms.capability",\r\nFT_OID, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_parameters,\r\n{ "parameters", "cms.parameters_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_recipientKeyId,\r\n{ "recipientKeyId", "cms.recipientKeyId_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"RecipientKeyIdentifier", HFILL }},\r\n{ &hf_cms_subjectAltKeyIdentifier,\r\n{ "subjectAltKeyIdentifier", "cms.subjectAltKeyIdentifier",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"SubjectKeyIdentifier", HFILL }},\r\n{ &hf_cms_rc2WrapParameter,\r\n{ "rc2WrapParameter", "cms.rc2WrapParameter",\r\nFT_INT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_rc2CBCParameter,\r\n{ "rc2CBCParameter", "cms.rc2CBCParameter_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_acInfo,\r\n{ "acInfo", "cms.acInfo_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"AttributeCertificateInfoV1", HFILL }},\r\n{ &hf_cms_signatureAlgorithm_v1,\r\n{ "signatureAlgorithm", "cms.signatureAlgorithm_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"AlgorithmIdentifier", HFILL }},\r\n{ &hf_cms_signatureValue_v1,\r\n{ "signature", "cms.signature",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"BIT_STRING", HFILL }},\r\n{ &hf_cms_version_v1,\r\n{ "version", "cms.version",\r\nFT_INT32, BASE_DEC, VALS(cms_AttCertVersionV1_vals), 0,\r\n"AttCertVersionV1", HFILL }},\r\n{ &hf_cms_subject,\r\n{ "subject", "cms.subject",\r\nFT_UINT32, BASE_DEC, VALS(cms_T_subject_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_baseCertificateID,\r\n{ "baseCertificateID", "cms.baseCertificateID_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"IssuerSerial", HFILL }},\r\n{ &hf_cms_subjectName,\r\n{ "subjectName", "cms.subjectName",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"GeneralNames", HFILL }},\r\n{ &hf_cms_issuer_v1,\r\n{ "issuer", "cms.issuer",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"GeneralNames", HFILL }},\r\n{ &hf_cms_signature_v1,\r\n{ "signature", "cms.signature_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"AlgorithmIdentifier", HFILL }},\r\n{ &hf_cms_attCertValidityPeriod,\r\n{ "attCertValidityPeriod", "cms.attCertValidityPeriod_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_attributes_v1,\r\n{ "attributes", "cms.attributes",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"SEQUENCE_OF_Attribute", HFILL }},\r\n{ &hf_cms_attributes_v1_item,\r\n{ "Attribute", "cms.Attribute_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cms_issuerUniqueID,\r\n{ "issuerUniqueID", "cms.issuerUniqueID",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"UniqueIdentifier", HFILL }},\r\n{ &hf_cms_extensions,\r\n{ "extensions", "cms.extensions",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n#line 143 "./asn1/cms/packet-cms-template.c"\r\n};\r\nstatic gint *ett[] = {\r\n#line 1 "./asn1/cms/packet-cms-ettarr.c"\r\n&ett_cms_ContentInfo,\r\n&ett_cms_SignedData,\r\n&ett_cms_DigestAlgorithmIdentifiers,\r\n&ett_cms_SignerInfos,\r\n&ett_cms_EncapsulatedContentInfo,\r\n&ett_cms_SignerInfo,\r\n&ett_cms_SignerIdentifier,\r\n&ett_cms_SignedAttributes,\r\n&ett_cms_UnsignedAttributes,\r\n&ett_cms_Attribute,\r\n&ett_cms_SET_OF_AttributeValue,\r\n&ett_cms_EnvelopedData,\r\n&ett_cms_OriginatorInfo,\r\n&ett_cms_RecipientInfos,\r\n&ett_cms_EncryptedContentInfo,\r\n&ett_cms_UnprotectedAttributes,\r\n&ett_cms_RecipientInfo,\r\n&ett_cms_KeyTransRecipientInfo,\r\n&ett_cms_RecipientIdentifier,\r\n&ett_cms_KeyAgreeRecipientInfo,\r\n&ett_cms_OriginatorIdentifierOrKey,\r\n&ett_cms_OriginatorPublicKey,\r\n&ett_cms_RecipientEncryptedKeys,\r\n&ett_cms_RecipientEncryptedKey,\r\n&ett_cms_KeyAgreeRecipientIdentifier,\r\n&ett_cms_RecipientKeyIdentifier,\r\n&ett_cms_KEKRecipientInfo,\r\n&ett_cms_KEKIdentifier,\r\n&ett_cms_PasswordRecipientInfo,\r\n&ett_cms_OtherRecipientInfo,\r\n&ett_cms_DigestedData,\r\n&ett_cms_EncryptedData,\r\n&ett_cms_AuthenticatedData,\r\n&ett_cms_AuthAttributes,\r\n&ett_cms_UnauthAttributes,\r\n&ett_cms_RevocationInfoChoices,\r\n&ett_cms_RevocationInfoChoice,\r\n&ett_cms_OtherRevocationInfoFormat,\r\n&ett_cms_CertificateChoices,\r\n&ett_cms_CertificateSet,\r\n&ett_cms_IssuerAndSerialNumber,\r\n&ett_cms_OtherKeyAttribute,\r\n&ett_cms_Time,\r\n&ett_cms_RC2CBCParameter,\r\n&ett_cms_ExtendedCertificate,\r\n&ett_cms_ExtendedCertificateInfo,\r\n&ett_cms_SMIMECapabilities,\r\n&ett_cms_SMIMECapability,\r\n&ett_cms_SMIMEEncryptionKeyPreference,\r\n&ett_cms_RC2CBCParameters,\r\n&ett_cms_AttributeCertificateV1,\r\n&ett_cms_AttributeCertificateInfoV1,\r\n&ett_cms_T_subject,\r\n&ett_cms_SEQUENCE_OF_Attribute,\r\n#line 148 "./asn1/cms/packet-cms-template.c"\r\n};\r\nproto_cms = proto_register_protocol(PNAME, PSNAME, PFNAME);\r\nproto_register_field_array(proto_cms, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nregister_ber_syntax_dissector("ContentInfo", proto_cms, dissect_ContentInfo_PDU);\r\nregister_ber_syntax_dissector("SignedData", proto_cms, dissect_SignedData_PDU);\r\nregister_ber_oid_syntax(".p7s", NULL, "ContentInfo");\r\nregister_ber_oid_syntax(".p7m", NULL, "ContentInfo");\r\nregister_ber_oid_syntax(".p7c", NULL, "ContentInfo");\r\n}\r\nvoid proto_reg_handoff_cms(void) {\r\ndissector_handle_t content_info_handle;\r\n#line 1 "./asn1/cms/packet-cms-dis-tab.c"\r\nregister_ber_oid_dissector("1.2.840.113549.1.9.16.1.6", dissect_ContentInfo_PDU, proto_cms, "id-ct-contentInfo");\r\nregister_ber_oid_dissector("1.2.840.113549.1.7.2", dissect_SignedData_PDU, proto_cms, "id-signedData");\r\nregister_ber_oid_dissector("1.2.840.113549.1.7.3", dissect_EnvelopedData_PDU, proto_cms, "id-envelopedData");\r\nregister_ber_oid_dissector("1.2.840.113549.1.7.5", dissect_DigestedData_PDU, proto_cms, "id-digestedData");\r\nregister_ber_oid_dissector("1.2.840.113549.1.7.6", dissect_EncryptedData_PDU, proto_cms, "id-encryptedData");\r\nregister_ber_oid_dissector("1.2.840.113549.1.9.16.1.2", dissect_AuthenticatedData_PDU, proto_cms, "id-ct-authenticatedData");\r\nregister_ber_oid_dissector("1.2.840.113549.1.9.3", dissect_ContentType_PDU, proto_cms, "id-contentType");\r\nregister_ber_oid_dissector("1.2.840.113549.1.9.4", dissect_MessageDigest_PDU, proto_cms, "id-messageDigest");\r\nregister_ber_oid_dissector("1.2.840.113549.1.9.5", dissect_SigningTime_PDU, proto_cms, "id-signingTime");\r\nregister_ber_oid_dissector("1.2.840.113549.1.9.6", dissect_Countersignature_PDU, proto_cms, "id-counterSignature");\r\nregister_ber_oid_dissector("2.6.1.4.18", dissect_ContentInfo_PDU, proto_cms, "id-et-pkcs7");\r\nregister_ber_oid_dissector("1.3.6.1.4.1.311.16.4", dissect_IssuerAndSerialNumber_PDU, proto_cms, "ms-oe-encryption-key-preference");\r\nregister_ber_oid_dissector("1.2.840.113549.1.9.15", dissect_SMIMECapabilities_PDU, proto_cms, "id-smime-capabilities");\r\nregister_ber_oid_dissector("1.2.840.113549.1.9.16.2.11", dissect_SMIMEEncryptionKeyPreference_PDU, proto_cms, "id-encryption-key-preference");\r\nregister_ber_oid_dissector("1.2.840.113549.3.2", dissect_RC2CBCParameters_PDU, proto_cms, "id-alg-rc2-cbc");\r\nregister_ber_oid_dissector("1.2.840.113549.3.4", dissect_RC2CBCParameters_PDU, proto_cms, "id-alg-rc4");\r\nregister_ber_oid_dissector("1.2.840.113549.1.9.16.3.7", dissect_RC2WrapParameter_PDU, proto_cms, "id-alg-cmsrc2-wrap");\r\nregister_ber_oid_dissector("2.16.840.1.113730.3.1.40", dissect_SignedData_PDU, proto_cms, "userSMIMECertificate");\r\n#line 171 "./asn1/cms/packet-cms-template.c"\r\noid_add_from_string("id-data","1.2.840.113549.1.7.1");\r\noid_add_from_string("id-alg-des-ede3-cbc","1.2.840.113549.3.7");\r\noid_add_from_string("id-alg-des-cbc","1.3.14.3.2.7");\r\ncontent_info_handle = create_dissector_handle (dissect_ContentInfo_PDU, proto_cms);\r\ndissector_add_string("media_type", "application/pkcs7-mime", content_info_handle);\r\ndissector_add_string("media_type", "application/pkcs7-signature", content_info_handle);\r\n}
