static int\r\ndissect_g723(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\nguint octet;\r\nproto_item *ti;\r\nproto_tree *g723_tree;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "G.723.1");\r\nif (tree) {\r\nti = proto_tree_add_item(tree, proto_g723, tvb, 0, -1, ENC_NA);\r\ng723_tree = proto_item_add_subtree(ti, ett_g723);\r\noctet = tvb_get_guint8(tvb,offset);\r\nproto_tree_add_item(g723_tree, hf_g723_frame_size_and_codec, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(g723_tree, hf_g723_lpc_B5_B0, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nif ((octet & 0x1) == 1 )\r\nreturn tvb_captured_length(tvb);\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_reg_handoff_g723(void)\r\n{\r\ndissector_handle_t g723_handle;\r\ng723_handle = create_dissector_handle(dissect_g723, proto_g723);\r\ndissector_add_uint("rtp.pt", PT_G723, g723_handle);\r\n}\r\nvoid\r\nproto_register_g723(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_g723_frame_size_and_codec,\r\n{ "Frame size and codec type", "g723.frame_size_and_codec",\r\nFT_UINT8, BASE_HEX, VALS(g723_frame_size_and_codec_type_value), 0x03,\r\n"RATEFLAG_B0", HFILL }\r\n},\r\n{ &hf_g723_lpc_B5_B0,\r\n{ "LPC_B5...LPC_B0", "g723.lpc.b5b0",\r\nFT_UINT8, BASE_HEX, NULL, 0xfc,\r\nNULL, HFILL }\r\n},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_g723,\r\n};\r\nproto_g723 = proto_register_protocol("G.723","G.723", "g723");\r\nproto_register_field_array(proto_g723, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}
