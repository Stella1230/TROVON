static void dissect_homeplug_mctrl(ptvcursor_t * cursor)\r\n{\r\nproto_item * it = NULL;\r\nif (!ptvcursor_tree(cursor))\r\nreturn;\r\nit = ptvcursor_add_no_advance(cursor, hf_homeplug_mctrl, 1, ENC_NA);\r\nhomeplug_ne = tvb_get_guint8(ptvcursor_tvbuff(cursor),\r\nptvcursor_current_offset(cursor)) & HOMEPLUG_MCTRL_NE;\r\nptvcursor_push_subtree(cursor, it, ett_homeplug_mctrl);\r\n{\r\nptvcursor_add_no_advance(cursor, hf_homeplug_mctrl_reserved, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_mctrl_ne, 1, ENC_BIG_ENDIAN);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nstatic void dissect_homeplug_mehdr(ptvcursor_t * cursor)\r\n{\r\nproto_item * it = NULL;\r\nif (!ptvcursor_tree(cursor))\r\nreturn;\r\nit = ptvcursor_add_no_advance(cursor, hf_homeplug_mehdr, 1, ENC_NA);\r\nhomeplug_metype = tvb_get_guint8(ptvcursor_tvbuff(cursor),\r\nptvcursor_current_offset(cursor)) & HOMEPLUG_MEHDR_METYPE;\r\nptvcursor_push_subtree(cursor, it, ett_homeplug_mehdr);\r\n{\r\nptvcursor_add_no_advance(cursor, hf_homeplug_mehdr_mev, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_mehdr_metype, 1, ENC_BIG_ENDIAN);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nstatic void dissect_homeplug_melen(ptvcursor_t * cursor)\r\n{\r\nif (!ptvcursor_tree(cursor))\r\nreturn;\r\nhomeplug_melen = tvb_get_guint8(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_homeplug_melen, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic void dissect_homeplug_rce(ptvcursor_t * cursor)\r\n{\r\nproto_item * it = NULL;\r\nif (!ptvcursor_tree(cursor))\r\nreturn;\r\nit = ptvcursor_add_no_advance(cursor, hf_homeplug_rce, homeplug_melen, ENC_NA);\r\nptvcursor_push_subtree(cursor, it, ett_homeplug_rce);\r\n{\r\nptvcursor_add_no_advance(cursor, hf_homeplug_rce_cev, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_rce_rsvd, 1, ENC_BIG_ENDIAN);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nstatic void dissect_homeplug_cer(ptvcursor_t * cursor)\r\n{\r\nproto_item * it = NULL;\r\nguint8 iTone = 0;\r\nguint8 BP = 0;\r\nguint8 iNBDA = 0;\r\nif (!ptvcursor_tree(cursor))\r\nreturn;\r\nit = ptvcursor_add_no_advance(cursor, hf_homeplug_cer, homeplug_melen, ENC_NA);\r\nptvcursor_push_subtree(cursor, it, ett_homeplug_cer);\r\n{\r\nptvcursor_add_no_advance(cursor, hf_homeplug_cer_cerv, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_cer_rsvd1, 2, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_cer_rxtmi, 1, ENC_BIG_ENDIAN);\r\nfor (;iTone < 10; iTone++) {\r\nptvcursor_add(cursor, hf_homeplug_cer_vt, 1, ENC_BIG_ENDIAN);\r\n}\r\nptvcursor_add_no_advance(cursor, hf_homeplug_cer_rate, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_homeplug_cer_bp, 1, ENC_BIG_ENDIAN);\r\nBP = tvb_get_guint8(ptvcursor_tvbuff(cursor),\r\nptvcursor_current_offset(cursor)) & HOMEPLUG_CER_BP;\r\nptvcursor_add_no_advance(cursor, hf_homeplug_cer_mod, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_cer_vt11, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_homeplug_cer_rsvd2, 1, ENC_BIG_ENDIAN);\r\nif (BP) {\r\niNBDA = tvb_get_guint8(ptvcursor_tvbuff(cursor),\r\nptvcursor_current_offset(cursor)) & HOMEPLUG_CER_NBDAS;\r\nptvcursor_add(cursor, hf_homeplug_cer_nbdas, 1, ENC_BIG_ENDIAN);\r\nfor (;iNBDA > 0; iNBDA--) {\r\nptvcursor_add(cursor, hf_homeplug_cer_bda, 6, ENC_NA);\r\n}\r\n}\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nstatic void dissect_homeplug_vs(ptvcursor_t * cursor)\r\n{\r\nproto_item * it = NULL;\r\nif (!ptvcursor_tree(cursor))\r\nreturn;\r\nit = ptvcursor_add_no_advance(cursor, hf_homeplug_vs, homeplug_melen, ENC_NA);\r\nptvcursor_push_subtree(cursor, it, ett_homeplug_vs);\r\n{\r\nptvcursor_add(cursor, hf_homeplug_vs_oui, 3, ENC_BIG_ENDIAN);\r\nit = ptvcursor_add_no_advance(cursor, hf_homeplug_vs_mid, 1, ENC_BIG_ENDIAN);\r\nptvcursor_push_subtree(cursor, it, ett_homeplug_vs_mid);\r\n{\r\nptvcursor_add_no_advance(cursor, hf_homeplug_vs_dir, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_vs_mid, 1, ENC_BIG_ENDIAN);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n#if 0\r\nswitch(mid) {\r\n}\r\n#endif\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nstatic void dissect_homeplug_rba(ptvcursor_t * cursor)\r\n{\r\nif (!ptvcursor_tree(cursor))\r\nreturn;\r\nptvcursor_add_no_advance(cursor, hf_homeplug_rba, homeplug_melen, ENC_NA);\r\n}\r\nstatic void dissect_homeplug_rps(ptvcursor_t * cursor)\r\n{\r\nif (!ptvcursor_tree(cursor))\r\nreturn;\r\nptvcursor_add(cursor, hf_homeplug_rps, homeplug_melen, ENC_NA);\r\n}\r\nstatic void dissect_homeplug_snk(ptvcursor_t * cursor)\r\n{\r\nproto_item * it = NULL;\r\nif (!ptvcursor_tree(cursor))\r\nreturn;\r\nit = ptvcursor_add_no_advance(cursor, hf_homeplug_snk, homeplug_melen, ENC_NA);\r\nptvcursor_push_subtree(cursor, it, ett_homeplug_snk);\r\n{\r\nptvcursor_add(cursor, hf_homeplug_snk_eks, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_snk_nek, 8, ENC_NA);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nstatic void dissect_homeplug_mwr(ptvcursor_t * cursor)\r\n{\r\nif (!ptvcursor_tree(cursor))\r\nreturn;\r\nptvcursor_add_no_advance(cursor, hf_homeplug_mwr, homeplug_melen, ENC_NA);\r\n}\r\nstatic void dissect_homeplug_cnk(ptvcursor_t * cursor)\r\n{\r\nif (!ptvcursor_tree(cursor))\r\nreturn;\r\nptvcursor_add_no_advance(cursor, hf_homeplug_cnk, homeplug_melen, ENC_NA);\r\n}\r\nstatic void dissect_homeplug_psr(ptvcursor_t * cursor)\r\n{\r\nproto_item * it = NULL;\r\nif (!ptvcursor_tree(cursor))\r\nreturn;\r\nit = ptvcursor_add_no_advance(cursor, hf_homeplug_psr, homeplug_melen, ENC_NA);\r\nptvcursor_push_subtree(cursor, it, ett_homeplug_psr);\r\n{\r\nptvcursor_add(cursor, hf_homeplug_psr_txack, 2, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_psr_txnack, 2, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_psr_txfail, 2, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_psr_txcloss, 2, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_psr_txcoll, 2, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_psr_txca3lat, 2, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_psr_txca2lat, 2, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_psr_txca1lat, 2, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_psr_txca0lat, 2, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_psr_rxbp40, 4, ENC_BIG_ENDIAN);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nstatic void dissect_homeplug_slp(ptvcursor_t * cursor)\r\n{\r\nproto_item * it = NULL;\r\nif (!ptvcursor_tree(cursor))\r\nreturn;\r\nit = ptvcursor_add_no_advance(cursor, hf_homeplug_slp, homeplug_melen, ENC_NA);\r\nptvcursor_push_subtree(cursor, it, ett_homeplug_slp);\r\n{\r\nptvcursor_add(cursor, hf_homeplug_slp_ma, 6, ENC_NA);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nstatic void dissect_homeplug_loader(ptvcursor_t * cursor, packet_info * pinfo)\r\n{\r\nint mid, length, dlen;\r\nproto_item * it = NULL;\r\nif (!ptvcursor_tree(cursor))\r\nreturn;\r\nit = ptvcursor_add_no_advance(cursor, hf_homeplug_loader, -1, ENC_NA);\r\nptvcursor_push_subtree(cursor, it, ett_homeplug_loader);\r\n{\r\nmid = tvb_get_guint8(ptvcursor_tvbuff(cursor),\r\nptvcursor_current_offset(cursor));\r\nlength = tvb_get_ntohs(ptvcursor_tvbuff(cursor),\r\nptvcursor_current_offset(cursor) + 1);\r\nswitch(mid) {\r\ncase HOMEPLUG_MID_LGDFV:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Loader Get Firmware Version");\r\nptvcursor_add(cursor, hf_homeplug_loader_gdfv, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_length, 2, ENC_BIG_ENDIAN);\r\nif (length != 0) {\r\nptvcursor_add(cursor, hf_homeplug_loader_status, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_version, -1, ENC_ASCII|ENC_NA);\r\n}\r\nbreak;\r\ncase HOMEPLUG_MID_LSF:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Loader Start Firmware");\r\nptvcursor_add(cursor, hf_homeplug_loader_lsf, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_length, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase HOMEPLUG_MID_LWM:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Loader Write Memory");\r\nptvcursor_add(cursor, hf_homeplug_loader_lwm, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_length, 2, ENC_BIG_ENDIAN);\r\nif (length == 7)\r\nptvcursor_add(cursor, hf_homeplug_loader_status, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_data_address, 4, ENC_BIG_ENDIAN);\r\ndlen = tvb_get_ntohs(ptvcursor_tvbuff(cursor),\r\nptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_homeplug_loader_data_length, 2, ENC_BIG_ENDIAN);\r\nif (length != 7)\r\nptvcursor_add(cursor, hf_homeplug_loader_data, dlen, ENC_NA);\r\nbreak;\r\ncase HOMEPLUG_MID_LRM:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Loader Read Memory");\r\nptvcursor_add(cursor, hf_homeplug_loader_lrm, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_length, 2, ENC_BIG_ENDIAN);\r\nif (length != 6)\r\nptvcursor_add(cursor, hf_homeplug_loader_status, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_data_address, 4, ENC_BIG_ENDIAN);\r\ndlen = tvb_get_ntohs(ptvcursor_tvbuff(cursor),\r\nptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_homeplug_loader_data_length, 2, ENC_BIG_ENDIAN);\r\nif (length != 6)\r\nptvcursor_add(cursor, hf_homeplug_loader_data, dlen, ENC_NA);\r\nbreak;\r\ncase HOMEPLUG_MID_LRNVM:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Loader Read NVM");\r\nptvcursor_add(cursor, hf_homeplug_loader_lrnvm, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_length, 2, ENC_BIG_ENDIAN);\r\nif (length != 7)\r\nptvcursor_add(cursor, hf_homeplug_loader_status, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_data_address, 4, ENC_BIG_ENDIAN);\r\ndlen = tvb_get_ntohs(ptvcursor_tvbuff(cursor),\r\nptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_homeplug_loader_data_length, 2, ENC_BIG_ENDIAN);\r\nif (length != 7)\r\nptvcursor_add(cursor, hf_homeplug_loader_data, dlen, ENC_NA);\r\nbreak;\r\ncase HOMEPLUG_MID_LWNVM:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Loader Write NVM");\r\nptvcursor_add(cursor, hf_homeplug_loader_lwnvm, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_length, 2, ENC_BIG_ENDIAN);\r\nif (length == 7)\r\nptvcursor_add(cursor, hf_homeplug_loader_status, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_data_address, 4, ENC_BIG_ENDIAN);\r\ndlen = tvb_get_ntohs(ptvcursor_tvbuff(cursor),\r\nptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_homeplug_loader_data_length, 2, ENC_BIG_ENDIAN);\r\nif (length != 7)\r\nptvcursor_add(cursor, hf_homeplug_loader_data, dlen, ENC_NA);\r\nbreak;\r\ncase HOMEPLUG_MID_LRESET:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Loader Reset");\r\nptvcursor_add(cursor, hf_homeplug_loader_lreset, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_length, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase HOMEPLUG_MID_GMD:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Loader Get Module Data");\r\nptvcursor_add(cursor, hf_homeplug_loader_gmd, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_length, 2, ENC_BIG_ENDIAN);\r\nif (length != 10)\r\nptvcursor_add(cursor, hf_homeplug_loader_status, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_module_id, 4, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_module_offset, 4, ENC_BIG_ENDIAN);\r\nif (length == 10) {\r\nptvcursor_add(cursor, hf_homeplug_loader_data_length, 2, ENC_BIG_ENDIAN);\r\n} else {\r\nptvcursor_add(cursor, hf_homeplug_loader_module_size, 4, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_data, length - 13, ENC_NA);\r\n}\r\nbreak;\r\ncase HOMEPLUG_MID_SMD:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Loader Set Module Data");\r\nptvcursor_add(cursor, hf_homeplug_loader_smd, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_length, 2, ENC_BIG_ENDIAN);\r\nif (length == 13)\r\nptvcursor_add(cursor, hf_homeplug_loader_status, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_module_id, 4, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_module_offset, 4, ENC_BIG_ENDIAN);\r\ndlen = tvb_get_ntohs(ptvcursor_tvbuff(cursor),\r\nptvcursor_current_offset(cursor));\r\nif (length != 13) {\r\nptvcursor_add(cursor, hf_homeplug_loader_data_length, 2, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_data, dlen, ENC_NA);\r\n} else\r\nptvcursor_add(cursor, hf_homeplug_loader_module_size, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase HOMEPLUG_MID_CM:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Loader Commit Module");\r\nptvcursor_add(cursor, hf_homeplug_loader_cm, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_length, 2, ENC_BIG_ENDIAN);\r\nif (length == 5)\r\nptvcursor_add(cursor, hf_homeplug_loader_status, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_module_id, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase HOMEPLUG_MID_LEMD:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Loader Erase Module Data");\r\nptvcursor_add(cursor, hf_homeplug_loader_lemd, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_length, 2, ENC_BIG_ENDIAN);\r\nif (length == 9)\r\nptvcursor_add(cursor, hf_homeplug_loader_status, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_module_id, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase HOMEPLUG_MID_LENVMS:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Loader Erase NVM Sectors");\r\nptvcursor_add(cursor, hf_homeplug_loader_lenvms, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_length, 2, ENC_BIG_ENDIAN);\r\nif (length == 9)\r\nptvcursor_add(cursor, hf_homeplug_loader_status, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_data_address, 4, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_module_size, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase HOMEPLUG_MID_GNVMP:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Loader Get NVM Parameters");\r\nptvcursor_add(cursor, hf_homeplug_loader_gnvmp, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_length, 2, ENC_BIG_ENDIAN);\r\nif (length == 17) {\r\nptvcursor_add(cursor, hf_homeplug_loader_status, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_nvmp_type, 4, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_nvmp_pagesize, 4, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_nvmp_blocksize, 4, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_nvmp_memorysize, 4, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase HOMEPLUG_MID_SNVMP:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Loader Set NVM Parameters");\r\nptvcursor_add(cursor, hf_homeplug_loader_snvmp, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_length, 2, ENC_BIG_ENDIAN);\r\nif (length == 17)\r\nptvcursor_add(cursor, hf_homeplug_loader_status, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_nvmp_type, 4, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_nvmp_pagesize, 4, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_nvmp_blocksize, 4, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_loader_nvmp_memorysize, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nptvcursor_add(cursor, hf_homeplug_loader_mid, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nstatic void dissect_homeplug_hreq(ptvcursor_t * cursor, packet_info * pinfo)\r\n{\r\nint mid, length;\r\nproto_item * it = NULL;\r\nif (!ptvcursor_tree(cursor))\r\nreturn;\r\nit = ptvcursor_add_no_advance(cursor, hf_homeplug_hreq, homeplug_melen, ENC_NA);\r\nptvcursor_push_subtree(cursor, it, ett_homeplug_hreq);\r\n{\r\nmid = tvb_get_guint8(ptvcursor_tvbuff(cursor),\r\nptvcursor_current_offset(cursor));\r\nlength = tvb_get_ntohs(ptvcursor_tvbuff(cursor),\r\nptvcursor_current_offset(cursor) + 1);\r\nswitch(mid) {\r\ncase HOMEPLUG_MID_GDV:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Host Request: Get Device Version");\r\nptvcursor_add(cursor, hf_homeplug_hreq_gdv, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase HOMEPLUG_MID_GFV:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Host Request: Get Firmware Version");\r\nptvcursor_add(cursor, hf_homeplug_hreq_gfv, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase HOMEPLUG_MID_GNEK:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Host Request: Get Network Encryption Key Request");\r\nptvcursor_add(cursor, hf_homeplug_hreq_gnek, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase HOMEPLUG_MID_GCLBPL:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Host Request: Get/ Clear Local Bridge Proxy List");\r\nptvcursor_add(cursor, hf_homeplug_hreq_gclbpl, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase HOMEPLUG_MID_NVDS:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Host Request: Non-volatile Database Status");\r\nptvcursor_add(cursor, hf_homeplug_hreq_nvds, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase HOMEPLUG_MID_GRBT:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Host Request: Get Remote Bridge Table");\r\nptvcursor_add(cursor, hf_homeplug_hreq_grbt, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase HOMEPLUG_MID_GSLNM:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Host Request: Get/Set Logical Network Mappings");\r\nptvcursor_add(cursor, hf_homeplug_hreq_gslnm, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase HOMEPLUG_MID_GSSS:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Host Request: Get/Set Spectral Scaling");\r\nptvcursor_add(cursor, hf_homeplug_hreq_gsss, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase HOMEPLUG_MID_RSL:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Host Request: MAC Reset to Secondary Loader");\r\nptvcursor_add(cursor, hf_homeplug_hreq_rsl, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase HOMEPLUG_MID_RESET:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Host Request: MAC Reset");\r\nptvcursor_add(cursor, hf_homeplug_hreq_reset, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_hreq_reset_type, 1, ENC_BIG_ENDIAN);\r\nif (length == 4)\r\nptvcursor_add(cursor, hf_homeplug_hreq_reset_delay, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nptvcursor_add(cursor, hf_homeplug_hreq_mid, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nstatic void dissect_homeplug_hrsp(ptvcursor_t * cursor, packet_info * pinfo)\r\n{\r\nint mid;\r\nproto_item * it = NULL;\r\nif (!ptvcursor_tree(cursor))\r\nreturn;\r\nit = ptvcursor_add_no_advance(cursor, hf_homeplug_hrsp, homeplug_melen, ENC_NA);\r\nptvcursor_push_subtree(cursor, it, ett_homeplug_hrsp);\r\n{\r\nmid = tvb_get_guint8(ptvcursor_tvbuff(cursor),\r\nptvcursor_current_offset(cursor));\r\nswitch(mid) {\r\ncase HOMEPLUG_MID_GDVR:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Host Response: Get Device Version");\r\nptvcursor_add(cursor, hf_homeplug_hrsp_gdvr, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_hrsp_version, -1, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase HOMEPLUG_MID_GFVR:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Host Response: Get Firmware Version");\r\nptvcursor_add(cursor, hf_homeplug_hrsp_gfvr, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_hrsp_version, -1, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase HOMEPLUG_MID_GNEKR:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Get Network Encryption Key");\r\nptvcursor_add(cursor, hf_homeplug_hrsp_gnekr, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_hrsp_gnekr_select, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_hrsp_gnekr_key, 8, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase HOMEPLUG_MID_INVALID:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Host Response: Invalid MME");\r\nptvcursor_add(cursor, hf_homeplug_hrsp_invalid, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nptvcursor_add(cursor, hf_homeplug_hrsp_mid, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nstatic void dissect_homeplug_htag(ptvcursor_t * cursor)\r\n{\r\nif (!ptvcursor_tree(cursor))\r\nreturn;\r\nptvcursor_add_no_advance(cursor, hf_homeplug_htag, homeplug_melen, ENC_NA);\r\n}\r\nstatic void dissect_homeplug_ns(ptvcursor_t * cursor, packet_info * pinfo)\r\n{\r\nguint8 iTone = 0;\r\nguint8 i_buffer = 0;\r\nguint64 newt_da = 0;\r\ngboolean extended = (homeplug_melen >= HOMEPLUG_NS_EXT_LEN);\r\nproto_item * ti;\r\ncol_append_str(pinfo->cinfo, COL_INFO, extended ? " Extended" : " Basic");\r\nif (!ptvcursor_tree(cursor))\r\nreturn;\r\nptvcursor_add_with_subtree(cursor, hf_homeplug_ns, homeplug_melen, ENC_BIG_ENDIAN,\r\nett_homeplug_ns);\r\n{\r\nti = proto_tree_add_boolean(ptvcursor_tree(cursor), hf_homeplug_ns_extended,\r\nptvcursor_tvbuff(cursor), 0, 0, extended);\r\nPROTO_ITEM_SET_GENERATED(ti);\r\nptvcursor_add_no_advance(cursor, hf_homeplug_ns_netw_ctrl_ac, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_ns_netw_ctrl_icid, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_homeplug_ns_bytes40_robo, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_ns_mhz, 2, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_ns_fails_robo, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_ns_drops_robo, 2, ENC_LITTLE_ENDIAN);\r\nwhile (iTone < 15) {\r\nnewt_da = ((gint64)tvb_get_ntoh24(ptvcursor_tvbuff(cursor),\r\nptvcursor_current_offset(cursor))) << 24;\r\nnewt_da |= tvb_get_ntoh24(ptvcursor_tvbuff(cursor),\r\nptvcursor_current_offset(cursor)+3);\r\nif (newt_da != HOMEPLUG_ADDR_INEXISTANT) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH,\r\nett_homeplug_tone, "Tone Map #%d", iTone+1);\r\n{\r\nptvcursor_add(cursor, hf_homeplug_ns_netw_da, 6, ENC_NA);\r\nptvcursor_add_no_advance(cursor, hf_homeplug_ns_bytes40, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_ns_mhz, 2, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_ns_fails, 2, ENC_LITTLE_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_ns_drops, 2, ENC_LITTLE_ENDIAN);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n} else {\r\nproto_tree_add_expert_format(ptvcursor_tree(cursor), pinfo, &ei_homeplug_tone_map_not_exist, ptvcursor_tvbuff(cursor),\r\nptvcursor_current_offset(cursor), 12, "Tone Map #%d does not exist", iTone+1);\r\n}\r\niTone++;\r\n}\r\nif (extended) {\r\nwhile (i_buffer < 6) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH,\r\nett_homeplug_tx_bfr_state, "TX_BFR_%d_STATE", i_buffer);\r\n{\r\nptvcursor_add_no_advance(cursor, hf_homeplug_ns_buf_in_use, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_homeplug_ns_prio, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_ns_msdu_len, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_homeplug_ns_seqn, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_ns_toneidx, 1, ENC_BIG_ENDIAN);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\ni_buffer++;\r\n}\r\n}\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nstatic void dissect_homeplug_bcn(ptvcursor_t * cursor)\r\n{\r\nproto_item * it = NULL;\r\nguint8 i_bridge = 0;\r\nguint8 num_das;\r\nguint8 i_da;\r\nguint8 fbn;\r\nit = ptvcursor_add_no_advance(cursor, hf_homeplug_bcn, homeplug_melen, ENC_NA);\r\nptvcursor_push_subtree(cursor, it, ett_homeplug_bcn);\r\n{\r\nptvcursor_add_no_advance(cursor, hf_homeplug_bcn_network, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_homeplug_bcn_return, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_homeplug_bcn_rsvd, 1, ENC_BIG_ENDIAN);\r\nfbn = tvb_get_guint8(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor))\r\n& HOMEPLUG_BCN_FBN;\r\nptvcursor_add(cursor, hf_homeplug_bcn_fbn, 1, ENC_BIG_ENDIAN);\r\nwhile (i_bridge < 2) {\r\nptvcursor_add_text_with_subtree(cursor, SUBTREE_UNDEFINED_LENGTH,\r\nett_homeplug_bridge, "Bridge #%d", fbn + i_bridge);\r\n{\r\nptvcursor_add(cursor, hf_homeplug_bcn_brda, 6, ENC_NA);\r\nnum_das = tvb_get_guint8(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_homeplug_bcn_bp_das, 1, ENC_BIG_ENDIAN);\r\nfor (i_da = 0; i_da < num_das; i_da++) {\r\nptvcursor_add(cursor, hf_homeplug_bcn_bp_da, 6, ENC_NA);\r\n}\r\n}\r\nptvcursor_pop_subtree(cursor);\r\ni_bridge++;\r\n}\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nstatic void dissect_homeplug_bcl(ptvcursor_t * cursor)\r\n{\r\nproto_item * it = NULL;\r\nguint8 num_das;\r\nguint8 i_da = 0;\r\nit = ptvcursor_add_no_advance(cursor, hf_homeplug_bcl, homeplug_melen, ENC_NA);\r\nptvcursor_push_subtree(cursor, it, ett_homeplug_bcl);\r\n{\r\nptvcursor_add_no_advance(cursor, hf_homeplug_bcl_network, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_homeplug_bcl_return, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_bcl_rsvd, 1, ENC_BIG_ENDIAN);\r\nnum_das = tvb_get_guint8(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor));\r\nptvcursor_add(cursor, hf_homeplug_bcl_hprox_das, 1, ENC_BIG_ENDIAN);\r\nwhile (i_da < num_das) {\r\nptvcursor_add(cursor, hf_homeplug_bcl_hpbda, 6, ENC_NA);\r\ni_da++;\r\n}\r\n}\r\nptvcursor_pop_subtree(cursor);\r\n}\r\nstatic void dissect_homeplug_bc(ptvcursor_t * cursor, packet_info * pinfo)\r\n{\r\ngboolean network;\r\nif (!ptvcursor_tree(cursor))\r\nreturn;\r\nnetwork = tvb_get_guint8(ptvcursor_tvbuff(cursor), ptvcursor_current_offset(cursor))\r\n& HOMEPLUG_BC_NETWORK;\r\ncol_append_str(pinfo->cinfo, COL_INFO, network ? " Network" : " Local");\r\nif (network)\r\ndissect_homeplug_bcn(cursor);\r\nelse\r\ndissect_homeplug_bcl(cursor);\r\n}\r\nstatic void dissect_homeplug_stc(ptvcursor_t * cursor)\r\n{\r\nproto_item * it = NULL;\r\nif (!ptvcursor_tree(cursor))\r\nreturn;\r\nit = ptvcursor_add_no_advance(cursor, hf_homeplug_stc, homeplug_melen, ENC_NA);\r\nptvcursor_push_subtree(cursor, it, ett_homeplug_stc);\r\n{\r\nptvcursor_add_no_advance(cursor, hf_homeplug_stc_lco, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_homeplug_stc_encf, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_homeplug_stc_txprio, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_homeplug_stc_rexp, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_homeplug_stc_txcf, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_homeplug_stc_cftop, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_stc_rsvd1, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_homeplug_stc_retry, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_homeplug_stc_rsvd2, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_homeplug_stc_dder, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_homeplug_stc_dur, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add_no_advance(cursor, hf_homeplug_stc_ebp, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_stc_dees, 1, ENC_BIG_ENDIAN);\r\nptvcursor_add(cursor, hf_homeplug_stc_txeks, 1, ENC_BIG_ENDIAN);\r\n}\r\nptvcursor_pop_subtree(cursor);\r\nreturn;\r\n}\r\nstatic void dissect_homeplug_unknown(ptvcursor_t * cursor)\r\n{\r\nptvcursor_add(cursor, hf_homeplug_data, homeplug_melen, ENC_NA);\r\n}\r\nstatic void dissect_homeplug_mme(ptvcursor_t * cursor, packet_info * pinfo)\r\n{\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, ", ",\r\nval_to_str(homeplug_metype, homeplug_metype_vals, "Unknown 0x%x"));\r\nswitch(homeplug_metype) {\r\ncase HOMEPLUG_MME_RCE:\r\ndissect_homeplug_rce(cursor);\r\nbreak;\r\ncase HOMEPLUG_MME_CER:\r\ndissect_homeplug_cer(cursor);\r\nbreak;\r\ncase HOMEPLUG_MME_VS:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Vendor Specific");\r\ndissect_homeplug_vs(cursor);\r\nbreak;\r\ncase HOMEPLUG_MME_RBA:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Replace Bridge Address");\r\ndissect_homeplug_rba(cursor);\r\nbreak;\r\ncase HOMEPLUG_MME_SNK:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Set Network Encryption Key");\r\ndissect_homeplug_snk(cursor);\r\nbreak;\r\ncase HOMEPLUG_MME_MWR:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Multicast With Response");\r\ndissect_homeplug_mwr(cursor);\r\nbreak;\r\ncase HOMEPLUG_MME_CNK:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Confirm Network Encryption Key");\r\ndissect_homeplug_cnk(cursor);\r\nbreak;\r\ncase HOMEPLUG_MME_RPS:\r\ndissect_homeplug_rps(cursor);\r\nbreak;\r\ncase HOMEPLUG_MME_PSR:\r\ndissect_homeplug_psr(cursor);\r\nbreak;\r\ncase HOMEPLUG_MME_SLP:\r\ndissect_homeplug_slp(cursor);\r\nbreak;\r\ncase HOMEPLUG_MME_LOADER:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Load Firmware");\r\ndissect_homeplug_loader(cursor, pinfo);\r\nbreak;\r\ncase HOMEPLUG_MME_HREQ:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Host Request");\r\ndissect_homeplug_hreq(cursor, pinfo);\r\nbreak;\r\ncase HOMEPLUG_MME_HRSP:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Host Response");\r\ndissect_homeplug_hrsp(cursor, pinfo);\r\nbreak;\r\ncase HOMEPLUG_MME_HTAG:\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Host Tag");\r\ndissect_homeplug_htag(cursor);\r\nbreak;\r\ncase HOMEPLUG_MME_NS:\r\ndissect_homeplug_ns(cursor, pinfo);\r\nbreak;\r\ncase HOMEPLUG_MME_BC:\r\ndissect_homeplug_bc(cursor, pinfo);\r\nbreak;\r\ncase HOMEPLUG_MME_STC:\r\ndissect_homeplug_stc(cursor);\r\nbreak;\r\ndefault:\r\ndissect_homeplug_unknown(cursor);\r\nbreak;\r\n}\r\n}\r\nstatic int check_tvb_length(ptvcursor_t *cursor, const gint length)\r\n{\r\nif (!cursor)\r\nreturn TVB_LEN_UNDEF;\r\nif (tvb_reported_length_remaining(ptvcursor_tvbuff(cursor),\r\nptvcursor_current_offset(cursor)) < length)\r\nreturn TVB_LEN_SHORTEST;\r\nreturn TVB_LEN_GREATEST;\r\n}\r\nstatic int\r\ndissect_homeplug(tvbuff_t * tvb, packet_info * pinfo, proto_tree * tree, void* data _U_)\r\n{\r\nproto_item * it;\r\nproto_tree * homeplug_tree;\r\nptvcursor_t * cursor;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "HomePlug");\r\ncol_set_str(pinfo->cinfo, COL_INFO, "MAC Management");\r\nhomeplug_offset = 0;\r\nit = proto_tree_add_item(tree, proto_homeplug, tvb, homeplug_offset, -1, ENC_NA);\r\nhomeplug_tree = proto_item_add_subtree(it, ett_homeplug);\r\ncursor = ptvcursor_new(homeplug_tree, tvb, 0);\r\nif (check_tvb_length(cursor, HOMEPLUG_MCTRL_LEN) != TVB_LEN_SHORTEST) {\r\ndissect_homeplug_mctrl(cursor);\r\nif ((homeplug_ne > 0)) {\r\ncol_clear(pinfo->cinfo, COL_INFO);\r\n}\r\nfor (; homeplug_ne > 0; homeplug_ne--) {\r\nif (check_tvb_length(cursor, HOMEPLUG_MEHDR_LEN) == TVB_LEN_SHORTEST)\r\nbreak;\r\ndissect_homeplug_mehdr(cursor);\r\nif (check_tvb_length(cursor, HOMEPLUG_MELEN_LEN) == TVB_LEN_SHORTEST)\r\nbreak;\r\ndissect_homeplug_melen(cursor);\r\ndissect_homeplug_mme(cursor, pinfo);\r\n}\r\n}\r\nptvcursor_free(cursor);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic void\r\nhomeplug_fmt_mhz( gchar *result, guint32 ns_bytes40 )\r\n{\r\ng_snprintf( result, ITEM_LABEL_LENGTH, "%.3f", (float)(ns_bytes40)/42);\r\n}\r\nvoid\r\nproto_reg_handoff_homeplug(void)\r\n{\r\ndissector_handle_t homeplug_handle;\r\nhomeplug_handle = create_dissector_handle(dissect_homeplug, proto_homeplug);\r\ndissector_add_uint("ethertype", ETHERTYPE_HOMEPLUG, homeplug_handle);\r\n}\r\nvoid\r\nproto_register_homeplug(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_homeplug_mctrl,\r\n{ "MAC Control Field", "homeplug.mctrl",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_mctrl_reserved,\r\n{ "Reserved", "homeplug.mctrl.rsvd",\r\nFT_UINT8, BASE_DEC, NULL, HOMEPLUG_MCTRL_RSVD, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_mctrl_ne,\r\n{ "Number of MAC Data Entries", "homeplug.mctrl.ne",\r\nFT_UINT8, BASE_DEC, NULL, HOMEPLUG_MCTRL_NE, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_mehdr,\r\n{ "MAC Management Entry Header", "homeplug.mehdr",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_mehdr_mev,\r\n{ "MAC Entry Version", "homeplug.mehdr.mev",\r\nFT_UINT8, BASE_DEC, NULL, HOMEPLUG_MEHDR_MEV, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_mehdr_metype,\r\n{ "MAC Entry Type", "homeplug.mehdr.metype",\r\nFT_UINT8, BASE_HEX, VALS(homeplug_metype_vals), HOMEPLUG_MEHDR_METYPE, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_melen,\r\n{ "MAC Management Entry Length", "homeplug.melen",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_homeplug_mme,\r\n{ "MAC Management Entry Data", "homeplug.mmentry",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_homeplug_rce,\r\n{ "Request Channel Estimation", "homeplug.rce",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_rce_cev,\r\n{ "Channel Estimation Version", "homeplug.rce.cev",\r\nFT_UINT8, BASE_DEC, NULL, HOMEPLUG_RCE_CEV, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_rce_rsvd,\r\n{ "Reserved", "homeplug.rce.rsvd",\r\nFT_UINT8, BASE_DEC, NULL, HOMEPLUG_RCE_RSVD, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_cer,\r\n{ "Channel Estimation Response", "homeplug.cer",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_cer_cerv,\r\n{ "Channel Estimation Response Version", "homeplug.cer.cerv",\r\nFT_UINT8, BASE_DEC, NULL, HOMEPLUG_CER_CERV, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_cer_rsvd1,\r\n{ "Reserved", "homeplug.cer.rsvd1",\r\nFT_UINT16, BASE_DEC, NULL, HOMEPLUG_CER_RSVD, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_cer_rxtmi,\r\n{ "Receive Tone Map Index", "homeplug.cer.rxtmi",\r\nFT_UINT8, BASE_DEC, NULL, HOMEPLUG_CER_RXTMI, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_cer_vt,\r\n{"Valid Tone Flags", "homeplug.cer.vt",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_cer_rate,\r\n{ "FEC Rate", "homeplug.cer.rate",\r\nFT_UINT8, BASE_DEC, NULL, HOMEPLUG_CER_RATE, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_cer_bp,\r\n{ "Bridge Proxy", "homeplug.cer.bp",\r\nFT_UINT8, BASE_DEC, NULL, HOMEPLUG_CER_BP, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_cer_mod,\r\n{ "Modulation Method", "homeplug.cer.mod",\r\nFT_UINT8, BASE_DEC, VALS(homeplug_cer_mod_vals), HOMEPLUG_CER_MOD_MASK,\r\nNULL, HFILL }\r\n},\r\n{ &hf_homeplug_cer_vt11,\r\n{ "Valid Tone Flags [83-80]", "homeplug.cer.vt11",\r\nFT_UINT8, BASE_DEC, NULL, HOMEPLUG_CER_VT11, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_cer_rsvd2,\r\n{ "Reserved", "homeplug.cer.rsvd2",\r\nFT_UINT8, BASE_DEC, NULL, HOMEPLUG_CER_RSVD2, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_cer_nbdas,\r\n{ "Number Bridged Destination Addresses", "homeplug.cer.nbdas",\r\nFT_UINT8, BASE_DEC, NULL, HOMEPLUG_CER_NBDAS, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_cer_bda,\r\n{ "Bridged Destination Address", "homeplug.cer.bda",\r\nFT_ETHER, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_rba,\r\n{ "Replace Bridge Address", "homeplug.rba",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_vs,\r\n{ "Vendor Specific", "homeplug.vs",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_vs_dir,\r\n{ "Direction", "homeplug.vs.dir",\r\nFT_UINT8, BASE_DEC, NULL, HOMEPLUG_VS_DIR, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_vs_mid,\r\n{ "Message ID", "homeplug.vs.mid",\r\nFT_UINT8, BASE_DEC, NULL, HOMEPLUG_VS_MID, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_vs_oui,\r\n{ "OUI", "homeplug.vs.oui",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_snk,\r\n{ "Set Network Encryption Key", "homeplug.snk",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_snk_eks,\r\n{ "Encryption Key Select", "homeplug.snk.eks",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_snk_nek,\r\n{ "Network Encryption Key", "homeplug.snk.nek",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_mwr,\r\n{ "Multicast With Response", "homeplug.mwr",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_cnk,\r\n{ "Confirm Network Encryption Key", "homeplug.cnk",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_htag,\r\n{ "Host Tag", "homeplug.htag",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_rps,\r\n{ "Request Parameters and Statistics", "homeplug.rps",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_psr,\r\n{ "Parameters and Statistics Response", "homeplug.psr",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_psr_txack,\r\n{ "Transmit ACK Counter", "homeplug.psr.txack",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_psr_txnack,\r\n{ "Transmit NACK Counter", "homeplug.psr.txnack",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_psr_txfail,\r\n{ "Transmit FAIL Counter", "homeplug.psr.txfail",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_psr_txcloss,\r\n{ "Transmit Contention Loss Counter", "homeplug.psr.txcloss",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_psr_txcoll,\r\n{ "Transmit Collision Counter", "homeplug.psr.txcoll",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_psr_txca3lat,\r\n{ "Transmit CA3 Latency Counter", "homeplug.psr.txca3lat",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_psr_txca2lat,\r\n{ "Transmit CA2 Latency Counter", "homeplug.psr.txca2lat",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_psr_txca1lat,\r\n{ "Transmit CA1 Latency Counter", "homeplug.psr.txca1lat",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_psr_txca0lat,\r\n{ "Transmit CA0 Latency Counter", "homeplug.psr.txca0lat",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_psr_rxbp40,\r\n{ "Receive Cumulative Bytes per 40-symbol", "homeplug.psr.rxbp40",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_slp,\r\n{ "Set Local Parameters", "homeplug.slp",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_slp_ma,\r\n{ "MAC Address", "homeplug.slp.ma",\r\nFT_ETHER, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader,\r\n{ "Loader", "homeplug.leader",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader_mid,\r\n{ "Message ID", "homeplug.loader.mid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader_length,\r\n{ "Length", "homeplug.loader.length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader_status,\r\n{ "Status", "homeplug.loader.status",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader_version,\r\n{ "Version", "homeplug.loader.version",\r\nFT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader_gdfv,\r\n{ "Get Device/Firmware Version", "homeplug.loader.gdfv",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader_lsf,\r\n{ "Start Firmware", "homeplug.loader.lsf",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader_lwm,\r\n{ "Write Memory", "homeplug.loader.lwm",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader_lrm,\r\n{ "Read Memory", "homeplug.loader.lrm",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader_lrnvm,\r\n{ "Read NVM Data", "homeplug.loader.lrnvm",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader_lwnvm,\r\n{ "Write NVM Data", "homeplug.loader.lwnvm",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader_lreset,\r\n{ "Reset", "homeplug.loader.lreset",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader_gmd,\r\n{ "Get Module Data", "homeplug.loader.gmd",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader_smd,\r\n{ "Set Module Data", "homeplug.loader.smd",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader_module_id,\r\n{ "Module ID", "homeplug.loader.module.id",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader_module_offset,\r\n{ "Offset", "homeplug.loader.module.offset",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader_module_size,\r\n{ "Module size", "homeplug.loader.module.size",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader_data_length,\r\n{ "Data length", "homeplug.loader.data.length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader_data_address,\r\n{ "Address", "homeplug.loader.data.address",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader_data,\r\n{ "Data", "homeplug.loader.data",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader_cm,\r\n{ "Commit Modules", "homeplug.loader.cm",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader_lemd,\r\n{ "Erase Module Data", "homeplug.loader.emd",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader_lenvms,\r\n{ "Erase NVM Sectors", "homeplug.loader.lenvms",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader_gnvmp,\r\n{ "Get NVM Parameters", "homeplug.loader.gnvmp",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader_nvmp_type,\r\n{ "Type", "homeplug.loader.nvmp.type",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader_nvmp_pagesize,\r\n{ "Page Size", "homeplug.loader.nvmp.pagesize",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader_nvmp_blocksize,\r\n{ "Block Size", "homeplug.loader.nvmp.blocksize",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader_nvmp_memorysize,\r\n{ "Memory Size", "homeplug.loader.nvmp.memorysize",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_loader_snvmp,\r\n{ "Set NVM Parameters", "homeplug.loader.snvmp",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_hreq,\r\n{ "Host Request", "homeplug.hreq",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_hreq_mid,\r\n{ "Message ID", "homeplug.hreq.mid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_hreq_gdv,\r\n{ "Get Device Version", "homeplug.hreq.gdv",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_hreq_gfv,\r\n{ "Get Firmware Version", "homeplug.hreq.gfv",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_hreq_gnek,\r\n{ "Get Network Encryption Key", "homeplug.hreq.gnek",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_hreq_gclbpl,\r\n{ "Get/Clear Local Bridge Proxy List", "homeplug.hreq.gclbpl",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_hreq_nvds,\r\n{ "Non-volatile Database Status", "homeplug.hreq.nvds",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_hreq_grbt,\r\n{ "Get Remote Bridge Table", "homeplug.hreq.grbt",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_hreq_gslnm,\r\n{ "Get/Set Logical Network Mapping", "homeplug.hreq.gslnm",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_hreq_gsss,\r\n{ "Get/Set Spectral Scaling", "homeplug.hreq.gsss",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_hreq_rsl,\r\n{ "Reset Secondary Loader", "homeplug.hreq.rsl",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_hreq_reset,\r\n{ "Reset", "homeplug.hreq.reset",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_hreq_reset_type,\r\n{ "Type", "homeplug.hreq.reset.type",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_hreq_reset_delay,\r\n{ "Delay", "homeplug.hreq.reset.delay",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_hrsp,\r\n{ "Host Response", "homeplug.hrsp",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_hrsp_mid,\r\n{ "Message ID", "homeplug.hrsp.mid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_hrsp_gdvr,\r\n{ "Get Device Version", "homeplug.hrsp.gdvr",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_hrsp_gfvr,\r\n{ "Get Firmware Version", "homeplug.hrsp.gfvr",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, "Get Firmwave Version", HFILL }\r\n},\r\n{ &hf_homeplug_hrsp_gnekr,\r\n{ "Get Network Encryption Key", "homeplug.hrsp.gnekr",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_hrsp_gnekr_select,\r\n{ "Key Select", "homeplug.hrsp.gnekr.select",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_hrsp_gnekr_key,\r\n{ "Key", "homeplug.hrsp.gnekr.key",\r\nFT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_hrsp_invalid,\r\n{ "Invalid", "homeplug.hrsp.invalid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_hrsp_version,\r\n{ "Version", "homeplug.hrsp.version",\r\nFT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_ns,\r\n{ "Network Statistics", "homeplug.ns",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_ns_extended,\r\n{ "Network Statistics is Extended", "homeplug.ns.extended",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x0, "Network Statistics is Extended (MELEN >= 199)", HFILL }\r\n},\r\n{ &hf_homeplug_ns_netw_ctrl_ac,\r\n{ "Action Control", "homeplug.ns.ac",\r\nFT_BOOLEAN, 8, TFS(&homeplug_ns_ac_vals), HOMEPLUG_NS_AC, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_ns_netw_ctrl_icid,\r\n{ "IC_ID", "homeplug.ns.icid",\r\nFT_UINT8, BASE_HEX|BASE_RANGE_STRING, RVALS(homeplug_ns_icid_vals), HOMEPLUG_NS_ICID, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_ns_bytes40_robo,\r\n{ "Bytes in 40 symbols in ROBO", "homeplug.ns.bytes40_robo",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_ns_mhz,\r\n{ "Mhz", "homeplug.ns.mhz",\r\nFT_UINT16, BASE_CUSTOM, CF_FUNC(homeplug_fmt_mhz), 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_ns_fails_robo,\r\n{ "Fails Received in ROBO", "homeplug.ns.fails_robo",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_ns_drops_robo,\r\n{ "Frame Drops in ROBO", "homeplug.ns.drops_robo",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_ns_netw_da,\r\n{ "Address of Network DA", "homeplug.ns.netw_da",\r\nFT_ETHER, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_ns_bytes40,\r\n{ "Bytes in 40 symbols", "homeplug.ns.bytes40",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_ns_fails,\r\n{ "Fails Received", "homeplug.ns.fails",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_ns_drops,\r\n{ "Frame Drops", "homeplug.ns.drops",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_homeplug_ns_tx_bfr_state,\r\n{ "Transmit Buffer State", "homeplug.ns.tx_bfr_state",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_homeplug_ns_buf_in_use,\r\n{ "Buffer in use", "homeplug.ns.buf_in_use",\r\nFT_BOOLEAN, 8, TFS(&homeplug_ns_buf_in_use_vals), HOMEPLUG_NS_BUF_IN_USE,\r\n"Buffer in use (1) or Available (0)", HFILL }\r\n},\r\n{ &hf_homeplug_ns_prio,\r\n{ "Priority", "homeplug.ns.prio",\r\nFT_UINT8, BASE_DEC, VALS(homeplug_txprio_vals), HOMEPLUG_NS_PRIO,\r\nNULL, HFILL }\r\n},\r\n{ &hf_homeplug_ns_msdu_len,\r\n{ "MSDU Length", "homeplug.ns.msdu_len",\r\nFT_UINT8, BASE_DEC, NULL, HOMEPLUG_NS_MSDU_LEN, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_ns_seqn,\r\n{ "Sequence Number", "homeplug.ns.seqn",\r\nFT_UINT8, BASE_DEC, NULL, HOMEPLUG_NS_SEQN, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_ns_toneidx,\r\n{ "Transmit tone map index", "homeplug.ns.toneidx",\r\nFT_UINT8, BASE_DEC, NULL, HOMEPLUG_NS_TONEIDX,\r\n"Maps to the 16 statistics occurring earlier in this MME", HFILL }\r\n},\r\n{ &hf_homeplug_bcn,\r\n{ "Bridging Characteristics Network", "homeplug.bcn",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_bcn_network,\r\n{ "Network", "homeplug.bcn.network",\r\nFT_BOOLEAN, 8, TFS(&homeplug_bc_network_vals), HOMEPLUG_BC_NETWORK,\r\n"Local (0) or Network Bridge (1) Information", HFILL }\r\n},\r\n{ &hf_homeplug_bcn_return,\r\n{ "Return/Set", "homeplug.bcn.return",\r\nFT_BOOLEAN, 8, TFS(&homeplug_bc_return_vals), HOMEPLUG_BC_RETURN,\r\n"From host: Return (1) or set bridging characteristics (0)", HFILL }\r\n},\r\n{ &hf_homeplug_bcn_rsvd,\r\n{ "Reserved", "homeplug.bcn.rsvd",\r\nFT_UINT8, BASE_DEC, NULL, HOMEPLUG_BCN_RSVD, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_bcn_fbn,\r\n{ "First Bridge Number", "homeplug.bcn.fbn",\r\nFT_UINT8, BASE_DEC, NULL, HOMEPLUG_BCN_FBN, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_bcn_brda,\r\n{ "Address of Bridge", "homeplug.bcn.brda",\r\nFT_ETHER, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_bcn_bp_das,\r\n{ "Number of bridge proxied DAs", "homeplug.bcn.bp_das",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Number of bridge proxied DAs supported", HFILL }\r\n},\r\n{ &hf_homeplug_bcn_bp_da,\r\n{ "Bridged DA", "homeplug.bcn.bp_da",\r\nFT_ETHER, BASE_NONE, NULL, 0x0, "Bridged Destination Address", HFILL }\r\n},\r\n{ &hf_homeplug_bcl,\r\n{ "Bridging Characteristics Local", "homeplug.bcl",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_bcl_network,\r\n{ "Network/Local", "homeplug.bcl.network",\r\nFT_BOOLEAN, 8, TFS(&homeplug_bc_network_vals), HOMEPLUG_BC_NETWORK,\r\n"Local (0) or Network Bridge (1) Information", HFILL }\r\n},\r\n{ &hf_homeplug_bcl_return,\r\n{ "Return/Set", "homeplug.bcl.return",\r\nFT_BOOLEAN, 8, TFS(&homeplug_bc_return_vals), HOMEPLUG_BC_RETURN,\r\n"From host: Return (1) or set bridging characteristics (0)", HFILL }\r\n},\r\n{ &hf_homeplug_bcl_rsvd,\r\n{ "Reserved", "homeplug.bcl.rsvd",\r\nFT_UINT8, BASE_DEC, NULL, HOMEPLUG_BCL_RSVD, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_bcl_hprox_das,\r\n{ "Number of host proxied DAs", "homeplug.bcl.hprox_das",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Number of host proxied DAs supported by the bridge application", HFILL }\r\n},\r\n{ &hf_homeplug_bcl_hpbda,\r\n{ "Host Proxied DA", "homeplug.bcl.hpbda",\r\nFT_ETHER, BASE_NONE, NULL, 0x0, "Host Proxied Bridged Destination Address", HFILL }\r\n},\r\n{ &hf_homeplug_stc,\r\n{ "Set Transmit Characteristics", "homeplug.stc",\r\nFT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_stc_lco,\r\n{ "Local Consumption Only", "homeplug.stc.lco",\r\nFT_BOOLEAN, 8, NULL, HOMEPLUG_STC_LCO,\r\n"Do not transmit subsequent frames to medium", HFILL }\r\n},\r\n{ &hf_homeplug_stc_encf,\r\n{ "Encryption Flag", "homeplug.stc.encf",\r\nFT_BOOLEAN, 8, NULL, HOMEPLUG_STC_ENCF, "Encrypt subsequent frames", HFILL }\r\n},\r\n{ &hf_homeplug_stc_txprio,\r\n{ "Transmit Priority", "homeplug.stc.txprio",\r\nFT_UINT8, BASE_DEC, VALS(homeplug_txprio_vals), HOMEPLUG_STC_TXPRIO,\r\nNULL, HFILL }\r\n},\r\n{ &hf_homeplug_stc_rexp,\r\n{ "Response Expected", "homeplug.stc.rexp",\r\nFT_BOOLEAN, 8, NULL, HOMEPLUG_STC_REXP,\r\n"Mark subsequent frames to receive response", HFILL }\r\n},\r\n{ &hf_homeplug_stc_txcf,\r\n{ "Transmit Contention Free", "homeplug.stc.txcf",\r\nFT_BOOLEAN, 8, NULL, HOMEPLUG_STC_TXCF,\r\n"Mark subsequently transmitted frames as contention free", HFILL }\r\n},\r\n{ &hf_homeplug_stc_cftop,\r\n{ "Contention Free Transmit Override Priority", "homeplug.stc.cftop",\r\nFT_BOOLEAN, 8, TFS(&homeplug_stc_cftop_vals), HOMEPLUG_STC_CFTOP,\r\n"Transmit subsequent contention free frames with CA2/CA3 priority", HFILL }\r\n},\r\n{ &hf_homeplug_stc_rsvd1,\r\n{ "Reserved", "homeplug.stc.rsvd1",\r\nFT_UINT8, BASE_DEC, NULL, HOMEPLUG_STC_RSVD1, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_stc_retry,\r\n{ "Retry Control", "homeplug.stc.retry",\r\nFT_UINT8, BASE_DEC, VALS(homeplug_stc_retry_vals), HOMEPLUG_STC_RETRY,\r\nNULL, HFILL }\r\n},\r\n{ &hf_homeplug_stc_rsvd2,\r\n{ "Reserved", "homeplug.stc.rsvd2",\r\nFT_UINT8, BASE_DEC, NULL, HOMEPLUG_STC_RSVD2, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_stc_dder,\r\n{ "Disable Default Encryption Receive", "homeplug.stc.dder",\r\nFT_BOOLEAN, 8, NULL, HOMEPLUG_STC_DDER, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_stc_dur,\r\n{ "Disable Unencrypted Receive", "homeplug.stc.dur",\r\nFT_BOOLEAN, 8, NULL, HOMEPLUG_STC_DUR, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_stc_ebp,\r\n{ "INT51X1 (Host/DTE Option) Enable Backpressure", "homeplug.stc.ebp",\r\nFT_BOOLEAN, 8, NULL, HOMEPLUG_STC_EBP,\r\nNULL, HFILL }\r\n},\r\n{ &hf_homeplug_stc_dees,\r\n{ "Disable EEPROM Save", "homeplug.stc.dees",\r\nFT_BOOLEAN, 8, NULL, HOMEPLUG_STC_DEES, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_stc_txeks,\r\n{ "EKS to be used for encryption", "homeplug.stc.txeks",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }\r\n},\r\n{ &hf_homeplug_data,\r\n{ "Data", "homeplug.data",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n}\r\n};\r\nstatic gint *ett[] = {\r\n&ett_homeplug,\r\n&ett_homeplug_mctrl,\r\n&ett_homeplug_mehdr,\r\n&ett_homeplug_rce,\r\n&ett_homeplug_cer,\r\n&ett_homeplug_vs,\r\n&ett_homeplug_vs_mid,\r\n&ett_homeplug_snk,\r\n&ett_homeplug_rps,\r\n&ett_homeplug_psr,\r\n&ett_homeplug_slp,\r\n&ett_homeplug_loader,\r\n&ett_homeplug_hreq,\r\n&ett_homeplug_hrsp,\r\n&ett_homeplug_ns,\r\n&ett_homeplug_tx_bfr_state,\r\n&ett_homeplug_tone,\r\n&ett_homeplug_bcn,\r\n&ett_homeplug_bridge,\r\n&ett_homeplug_bcl,\r\n&ett_homeplug_stc\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_homeplug_tone_map_not_exist, { "homeplug.tone_map_not_exist", PI_PROTOCOL, PI_WARN, "Tone Map does not exist", EXPFILL }},\r\n};\r\nexpert_module_t* expert_homeplug;\r\nproto_homeplug = proto_register_protocol("HomePlug protocol", "HomePlug", "homeplug");\r\nproto_register_field_array(proto_homeplug, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_homeplug = expert_register_protocol(proto_homeplug);\r\nexpert_register_field_array(expert_homeplug, ei, array_length(ei));\r\n}
