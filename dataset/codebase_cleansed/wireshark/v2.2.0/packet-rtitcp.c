static void rtitcp_util_add_error_attribute(proto_tree *attribute, tvbuff_t* tvb,\r\ngint offset, guint size) {\r\nproto_tree_add_item(attribute, hf_rtitcp_control_attribute_error_code_value, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(attribute, hf_rtitcp_control_attribute_error_code_description, tvb, offset + 4,\r\nsize - 4, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void rtitcp_util_add_locator_t(proto_tree *tree, packet_info *pinfo _U_, tvbuff_t * tvb,\r\ngint offset, gboolean little_endian,\r\nproto_item * rtitcp_message, gboolean * first_attribute) {\r\ngint32 kind;\r\nguint16 port;\r\nkind = tvb_get_guint16(tvb, offset+8, little_endian ? ENC_LITTLE_ENDIAN : ENC_BIG_ENDIAN);\r\nif (kind == 0xFFFF) {\r\nkind = LOCATOR_KIND_IPV4;\r\n} else {\r\nkind = LOCATOR_KIND_IPV6;\r\n}\r\nproto_tree_add_uint(tree, hf_rtitcp_locator_kind, tvb, offset+8, 2, kind);\r\nif (kind == LOCATOR_KIND_IPV4) {\r\nproto_tree_add_item(tree, hf_rtitcp_locator_port, tvb, offset+10, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_rtitcp_locator_ipv4, tvb, offset+12, 4, ENC_BIG_ENDIAN);\r\nport = tvb_get_guint16(tvb, offset+10, little_endian ? ENC_LITTLE_ENDIAN : ENC_BIG_ENDIAN);\r\nif (*first_attribute) {\r\nproto_item_append_text(rtitcp_message," (");\r\ncol_append_str(pinfo->cinfo, COL_INFO, " (");\r\n}\r\nproto_item_append_text(rtitcp_message, "%s%s:%u",\r\n*first_attribute ? "" : ", ", tvb_ip_to_str(tvb, offset + 12), port);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s%s:%u",\r\n*first_attribute ? "" : ", ", tvb_ip_to_str(tvb, offset + 12), port);\r\n} else {\r\nproto_tree_add_item(tree, hf_rtitcp_locator_ipv6, tvb, offset, 16, ENC_NA);\r\nif (*first_attribute) {\r\nproto_item_append_text(rtitcp_message," (");\r\ncol_append_str(pinfo->cinfo, COL_INFO, " (");\r\n}\r\nproto_item_append_text(rtitcp_message, "%s%s",\r\n*first_attribute ? "" : ", ", tvb_ip6_to_str(tvb, offset));\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s%s",\r\n*first_attribute ? "" : ", ", tvb_ip6_to_str(tvb, offset));\r\n}\r\n}\r\nstatic guint dissect_attribute(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *attributes_list, guint offset, guint attributes_list_offset,\r\nproto_item * rtitcp_message, gboolean * first_attribute) {\r\nguint16 attribute_length, attribute_type;\r\nguint padding;\r\nproto_item *attribute;\r\nattribute_type = tvb_get_guint16(tvb, attributes_list_offset+offset, ENC_BIG_ENDIAN);\r\nattribute_length = tvb_get_guint16(tvb, attributes_list_offset+offset+2, ENC_BIG_ENDIAN);\r\nattribute = proto_tree_add_subtree_format(attributes_list, tvb,\r\nattributes_list_offset+offset, attribute_length+4,\r\nett_rtitcp_attribute, NULL, "Unknown Attribute");\r\nproto_tree_add_item(attribute, hf_rtitcp_control_attribute_type, tvb,\r\nattributes_list_offset+offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(attribute, hf_rtitcp_control_attribute_length, tvb,\r\nattributes_list_offset+offset+2, 2, ENC_BIG_ENDIAN);\r\nproto_item_set_text(attribute,"%s", val_to_str(attribute_type, attribute_types_vals, "Unknown attribute"));\r\nswitch (attribute_type) {\r\ncase RTPS_LOCATOR_PORT_ATTRIBUTE_TYPE: {\r\nguint32 port;\r\nport = tvb_get_guint32(tvb, attributes_list_offset+offset+4, ENC_BIG_ENDIAN);\r\nif (*first_attribute) {\r\nproto_item_append_text(rtitcp_message," (");\r\ncol_append_str(pinfo->cinfo, COL_INFO, " (");\r\n}\r\nproto_item_append_text(rtitcp_message, "%s%u",\r\n*first_attribute ? "" : ", ", port);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s%u",\r\n*first_attribute ? "" : ", ", port);\r\n(*first_attribute) = FALSE;\r\nproto_item_append_text(attribute, " (Port = %u)", port);\r\nproto_tree_add_item(attribute, hf_rtitcp_control_attribute_port, tvb,\r\nattributes_list_offset+offset+4, attribute_length, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\ncase RTPS_LOCATOR_ADDRESS_ATTRIBUTE_TYPE: {\r\nrtitcp_util_add_locator_t(attribute, pinfo, tvb, attributes_list_offset+offset+4,\r\nENC_BIG_ENDIAN, rtitcp_message, first_attribute);\r\n(*first_attribute) = FALSE;\r\nbreak;\r\n}\r\ncase CONNECTION_COOKIE_ATTRIBUTE_TYPE: {\r\nproto_tree_add_item(attribute, hf_rtitcp_control_attribute_connection_cookie,\r\ntvb, attributes_list_offset+offset+4, attribute_length, ENC_NA);\r\nif (*first_attribute) {\r\nproto_item_append_text(rtitcp_message," (");\r\ncol_append_str(pinfo->cinfo, COL_INFO, " (");\r\n}\r\nproto_item_append_text(rtitcp_message, "%s%s",\r\n(*first_attribute) ? "" : ", ",\r\ntvb_bytes_to_str(wmem_packet_scope(), tvb, attributes_list_offset+offset+4, 16));\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s%s",\r\n(*first_attribute) ? "" : ", ",\r\ntvb_bytes_to_str(wmem_packet_scope(), tvb, attributes_list_offset+offset+4, 16));\r\n(*first_attribute) = FALSE;\r\nbreak;\r\n}\r\ncase CONNECTION_TYPE_ATTRIBUTE_TYPE: {\r\nguint8 attribute_connection_type = tvb_get_guint8(tvb, attributes_list_offset+offset+4);\r\nproto_tree_add_item(attribute, hf_rtitcp_control_attribute_connection_type, tvb,\r\nattributes_list_offset+offset+4, attribute_length, ENC_BIG_ENDIAN);\r\nif (*first_attribute) {\r\nproto_item_append_text(rtitcp_message," (");\r\ncol_append_str(pinfo->cinfo, COL_INFO, " (");\r\n}\r\nproto_item_append_text(rtitcp_message, "%s%s",\r\n(*first_attribute) ? "" : ", ",\r\nval_to_str(attribute_connection_type, rtitcp_attribute_connection_type_vals, "Unknown attribute"));\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s%s",\r\n(*first_attribute) ? "" : ", ",\r\nval_to_str(attribute_connection_type, rtitcp_attribute_connection_type_vals, "Unknown attribute"));\r\n(*first_attribute) = FALSE;\r\nbreak;\r\n}\r\ncase SESSION_ID_ATTRIBUTE_TYPE: {\r\nproto_tree_add_item(attribute, hf_rtitcp_control_attribute_session_id, tvb,\r\nattributes_list_offset+offset+4, attribute_length, ENC_NA);\r\nbreak;\r\n}\r\ncase ERROR_CODE_ATTRIBUTE_TYPE: {\r\nrtitcp_util_add_error_attribute(attribute, tvb, attributes_list_offset+offset+4, attribute_length);\r\nbreak;\r\n}\r\ndefault:\r\nbreak;\r\n}\r\npadding = (4 - attribute_length%4)%4;\r\nreturn (attribute_length+padding+4);\r\n}\r\nstatic proto_tree* print_header(proto_tree *tree, proto_tree *rtitcp_message, tvbuff_t *tvb, guint offset,\r\nguint16 msg_length, gboolean printCRC, gboolean is_data) {\r\nproto_item *ti;\r\nif (is_data) {\r\nrtitcp_message = proto_tree_add_subtree_format(tree, tvb, offset, msg_length,\r\nett_rtitcp_message, NULL, "RTI TCP Data Message");\r\n} else {\r\nrtitcp_message = proto_tree_add_subtree_format(tree, tvb, offset, msg_length,\r\nett_rtitcp_message, NULL, "RTI TCP Control Message");\r\n}\r\nif (is_data) {\r\nguint32 msg_length32;\r\nproto_tree_add_item(rtitcp_message, hf_rtitcp_header_control_byte, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nti = proto_tree_add_item(rtitcp_message, hf_rtitcp_header_message_length,\r\ntvb, offset+1, 3, ENC_BIG_ENDIAN);\r\nmsg_length32 = tvb_get_guint32(tvb, offset, ENC_BIG_ENDIAN);\r\nmsg_length32 = msg_length32 % NUMBER_2E30;\r\nproto_item_set_text(ti,"RTI TCP Message Length: %d", msg_length32);\r\n} else {\r\nproto_tree_add_item(rtitcp_message, hf_rtitcp_header_control_byte, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(rtitcp_message, hf_rtitcp_header_message_length, tvb, offset+2, 2, ENC_BIG_ENDIAN);\r\n}\r\nproto_tree_add_item(rtitcp_message, hf_rtitcp_header_magic_number, tvb, offset+4, 4, ENC_BIG_ENDIAN);\r\nif (printCRC) {\r\nproto_tree_add_item(rtitcp_message, hf_rtitcp_crc_magic_cookie, tvb, offset+8, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(rtitcp_message, hf_rtitcp_control_crc_value, tvb, offset+12, 4, ENC_BIG_ENDIAN);\r\n}\r\nreturn rtitcp_message;\r\n}\r\nstatic guint16 dissect_control_message(proto_tree *rtitcp_tree, tvbuff_t *tvb, packet_info *pinfo,\r\nguint offset) {\r\nproto_tree *attributes_list, *rtitcp_message = NULL;\r\nguint16 msg_length, control_message_kind, attributes_list_length, header_length;\r\nguint attributes_list_offset, attribute_offset, offset_header = offset;\r\nguint attributes_count;\r\ngboolean is_data = FALSE, printCRC = FALSE, first_attribute;\r\ngchar * transaction_id_str;\r\nguint64 seq_num;\r\nconversation_t *conversation;\r\nrtitcp_conv_info_t *rtitcp_info;\r\nrtitcp_transaction_t *rtitcp_trans;\r\nguint64 * conversation_info_key = NULL;\r\nheader_length = 8;\r\nmsg_length = tvb_get_guint16(tvb, offset+2, ENC_BIG_ENDIAN);\r\noffset += 8;\r\nif (tvb_get_ntohl(tvb, offset) == RTITCP_CRC_MAGIC_NUMBER) {\r\nprintCRC = TRUE;\r\nheader_length += 8;\r\noffset += 8;\r\n}\r\nrtitcp_message = print_header(rtitcp_tree, rtitcp_message, tvb, offset_header, msg_length + header_length, printCRC, is_data);\r\ncontrol_message_kind = tvb_get_guint16(tvb, offset, ENC_BIG_ENDIAN);\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, ", ",\r\nval_to_str(control_message_kind,ctrl_message_types_vals, "Unknown control message"));\r\nproto_tree_add_uint(rtitcp_message, hf_rtitcp_control_kind, tvb, offset, 2, control_message_kind);\r\nproto_item_set_text(rtitcp_message,"RTI TCP Control Message , Kind: %s",\r\nval_to_str(control_message_kind,ctrl_message_types_vals, "Unknown control message"));\r\noffset += 2;\r\nattributes_list_length = tvb_get_guint16(tvb, offset, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(rtitcp_message, hf_rtitcp_attributes_list_length, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nif (tvb_get_ntohl(tvb, offset) != RTITCP_CONTROL_MAGIC_COOKIE) {\r\nreturn msg_length + header_length;\r\n}\r\nproto_tree_add_item(rtitcp_message, hf_rtitcp_control_magic_cookie, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(rtitcp_message, hf_rtitcp_control_transaction_id, tvb, offset, 12, ENC_NA);\r\ntransaction_id_str = tvb_bytes_to_str(wmem_packet_scope(), tvb, offset, 12);\r\nseq_num = tvb_get_ntoh64(tvb, offset);\r\nconversation = find_or_create_conversation(pinfo);\r\nrtitcp_info = (rtitcp_conv_info_t *)conversation_get_proto_data(conversation, proto_rtitcp);\r\nif (!rtitcp_info) {\r\nrtitcp_info = wmem_new(wmem_file_scope(), rtitcp_conv_info_t);\r\nrtitcp_info->pdus=wmem_map_new(wmem_file_scope(), g_int64_hash, g_int64_equal);\r\nconversation_add_proto_data(conversation, proto_rtitcp, rtitcp_info);\r\n}\r\nif (!pinfo->fd->flags.visited) {\r\nif (!(control_message_kind & RTITCP_FLAG_NOT_REQUEST)) {\r\nrtitcp_trans=wmem_new(wmem_file_scope(), rtitcp_transaction_t);\r\nrtitcp_trans->req_frame = pinfo->num;\r\nrtitcp_trans->rep_frame = 0;\r\nrtitcp_trans->req_time = pinfo->abs_ts;\r\nconversation_info_key = (guint64*)wmem_alloc0(wmem_file_scope(), sizeof(guint64));\r\n*conversation_info_key = seq_num;\r\nwmem_map_insert(rtitcp_info->pdus, conversation_info_key, (void *)rtitcp_trans);\r\n} else {\r\nconversation_info_key = &seq_num;\r\nrtitcp_trans=(rtitcp_transaction_t *)wmem_map_lookup(rtitcp_info->pdus, conversation_info_key);\r\nif (rtitcp_trans) {\r\nrtitcp_trans->rep_frame = pinfo->num;\r\n}\r\n}\r\n} else {\r\nconversation_info_key = &seq_num;\r\nrtitcp_trans=(rtitcp_transaction_t *)wmem_map_lookup(rtitcp_info->pdus, conversation_info_key);\r\n}\r\nif (!rtitcp_trans) {\r\nrtitcp_trans=wmem_new(wmem_packet_scope(), rtitcp_transaction_t);\r\nrtitcp_trans->req_frame = 0;\r\nrtitcp_trans->rep_frame = 0;\r\nrtitcp_trans->req_time = pinfo->abs_ts;\r\n}\r\nif (!(control_message_kind & RTITCP_FLAG_NOT_REQUEST)) {\r\nif (rtitcp_trans->rep_frame) {\r\nproto_item *it;\r\nit = proto_tree_add_uint(rtitcp_message, hf_rtitcp_response_in,\r\ntvb, 0, 0, rtitcp_trans->rep_frame);\r\nPROTO_ITEM_SET_GENERATED(it);\r\n}\r\n} else {\r\nif (rtitcp_trans->req_frame) {\r\nproto_item *it;\r\nnstime_t ns;\r\nit = proto_tree_add_uint(rtitcp_message, hf_rtitcp_response_to,\r\ntvb, 0, 0, rtitcp_trans->req_frame);\r\nPROTO_ITEM_SET_GENERATED(it);\r\nnstime_delta(&ns, &pinfo->abs_ts, &rtitcp_trans->req_time);\r\nit = proto_tree_add_time(rtitcp_message, hf_rtitcp_response_time, tvb, 0, 0, &ns);\r\nPROTO_ITEM_SET_GENERATED(it);\r\n}\r\n}\r\noffset += 12;\r\nattributes_list_offset = 0;\r\nattributes_list = proto_tree_add_subtree_format(rtitcp_message, tvb,\r\nattributes_list_offset+offset, attributes_list_length,\r\nett_rtitcp_attributes_list, NULL, "Attributes List");\r\nattributes_count = 0;\r\nfirst_attribute = TRUE;\r\nwhile (attributes_list_offset < attributes_list_length) {\r\n++attributes_count;\r\nattribute_offset = dissect_attribute(tvb, pinfo, attributes_list,\r\noffset, attributes_list_offset, rtitcp_message, &first_attribute);\r\nattributes_list_offset += attribute_offset;\r\n}\r\nif (!first_attribute) {\r\nproto_item_append_text(rtitcp_message,")");\r\ncol_append_str(pinfo->cinfo, COL_INFO, ")");\r\n}\r\nproto_item_set_text(attributes_list, "Attributes list [%d attribute%s",\r\nattributes_count, attributes_count > 1 ? "s]" : "]");\r\nproto_item_append_text(rtitcp_message,", Transaction ID: %s, Len: %d",\r\ntransaction_id_str, msg_length);\r\nreturn msg_length + header_length;\r\n}\r\nstatic guint dissect_rtitcp_control_protocol(proto_tree *rtitcp_tree, tvbuff_t *tvb, packet_info *pinfo) {\r\nguint messages_count, offset;\r\nguint16 msg_length;\r\nguint32 tvb_len;\r\noffset = 0;\r\ntvb_len = tvb_reported_length(tvb);\r\nmessages_count = 0;\r\nwhile (offset < tvb_len) {\r\nmsg_length = dissect_control_message(rtitcp_tree, tvb, pinfo, offset);\r\noffset += msg_length;\r\n++messages_count;\r\n}\r\nreturn offset;\r\n}\r\nstatic gint dissect_rtitcp_common(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void *data _U_) {\r\nproto_item *ti;\r\nproto_tree *rtitcp_tree, *rtitcp_message = NULL;\r\nguint offset, offset_header;\r\nguint16 rtitcp_msg_length, header_length;\r\nguint32 tvb_len, rtitcp_rtps_msg_length;\r\ngboolean printCRC = FALSE, is_data = FALSE;\r\ntvbuff_t *next_tvb;\r\nheur_dtbl_entry_t *hdtbl_entry;\r\noffset = 0;\r\ntvb_len = tvb_reported_length(tvb);\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "RTI-TCP");\r\nrtitcp_msg_length = tvb_get_guint16(tvb, offset+2, ENC_BIG_ENDIAN);\r\nti = proto_tree_add_item(tree, proto_rtitcp, tvb, offset, -1, ENC_NA);\r\nrtitcp_tree = proto_item_add_subtree(ti, ett_rtitcp);\r\noffset_header = 0;\r\nheader_length = 8;\r\noffset += 2;\r\noffset += 2;\r\noffset += 4;\r\nif (tvb_get_ntohl(tvb, offset) == RTITCP_CRC_MAGIC_NUMBER) {\r\nprintCRC = TRUE;\r\nheader_length += 8;\r\noffset += 8;\r\n}\r\nproto_item_set_len(ti, rtitcp_msg_length + header_length);\r\nif (tvb_get_ntohl(tvb, offset) == RTPS_MAGIC_NUMBER) {\r\nif (tvb_len > (guint32)(rtitcp_msg_length + header_length)) {\r\ntvb_set_reported_length(tvb, (rtitcp_msg_length + header_length));\r\n}\r\nrtitcp_rtps_msg_length = tvb_get_guint32(tvb, 0, ENC_BIG_ENDIAN);\r\nrtitcp_rtps_msg_length = rtitcp_rtps_msg_length % NUMBER_2E30;\r\nis_data = TRUE;\r\nrtitcp_message = print_header(rtitcp_tree, rtitcp_message, tvb, offset_header,\r\nrtitcp_rtps_msg_length + header_length, printCRC, is_data);\r\nproto_item_set_text(rtitcp_message,"RTI TCP Data Message, Len: %d",\r\nrtitcp_rtps_msg_length);\r\nnext_tvb = tvb_new_subset_remaining(tvb, offset);\r\ndissector_try_heuristic(heur_subdissector_list, next_tvb, pinfo, tree, &hdtbl_entry, NULL);\r\nreturn tvb_captured_length(tvb);\r\n} else {\r\nreturn dissect_rtitcp_control_protocol(rtitcp_tree, tvb, pinfo);\r\n}\r\n}\r\nstatic guint get_rtitcp_pdu_len(packet_info *pinfo _U_, tvbuff_t *tvb,\r\ngint offset, void * data _U_) {\r\nguint16 plen;\r\nguint16 header_length = 8;\r\nplen = tvb_get_guint16(tvb, offset+2, ENC_BIG_ENDIAN);\r\nif (tvb_get_ntohl(tvb, offset+8) == RTITCP_CRC_MAGIC_NUMBER)\r\nheader_length += 8;\r\nif (plen >= 0xfff8)\r\nreturn 1;\r\nreturn plen + header_length;\r\n}\r\nstatic gint dissect_rtitcp(tvbuff_t *tvb, packet_info *pinfo,\r\nproto_tree *tree, void *data _U_) {\r\ngboolean desegmentation = TRUE;\r\nif (tvb_captured_length(tvb) < 8)\r\nreturn 0;\r\nif (tvb_get_ntohl(tvb, 4) != RTITCP_MAGIC_NUMBER)\r\nreturn 0;\r\ncol_clear(pinfo->cinfo, COL_INFO);\r\ntcp_dissect_pdus(tvb, pinfo, tree, desegmentation, RTITCP_MIN_LENGTH,\r\nget_rtitcp_pdu_len, dissect_rtitcp_common, data);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_rtitcp(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_rtitcp_header_control_byte, {\r\n"Control Byte", "rtitcp.header.control_byte",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\n0, HFILL }\r\n},\r\n{ &hf_rtitcp_header_message_length, {\r\n"Message Length", "rtitcp.header.message_length",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n0, HFILL }\r\n},\r\n{ &hf_rtitcp_header_magic_number, {\r\n"Magic Cookie", "rtitcp.header.magic_cookie",\r\nFT_UINT32, BASE_HEX, NULL, 0,\r\n0, HFILL }\r\n},\r\n{ &hf_rtitcp_crc_magic_cookie, {\r\n"CRC Magic Cookie", "rtitcp.header.crc_magic_cookie",\r\nFT_UINT32, BASE_HEX, NULL, 0,\r\n0, HFILL }\r\n},\r\n{ &hf_rtitcp_control_kind,\r\n{ "Kind", "rtitcp.control.kind",\r\nFT_UINT16, BASE_HEX, VALS(ctrl_message_types_vals), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rtitcp_control_magic_cookie, {\r\n"Control Magic Cookie", "rtitcp.control.magic_cookie",\r\nFT_UINT32, BASE_HEX, NULL, 0,\r\n0, HFILL }\r\n},\r\n{ &hf_rtitcp_control_transaction_id, {\r\n"Transaction ID", "rtitcp.control.transaction_id",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n0, HFILL }\r\n},\r\n{ &hf_rtitcp_control_attribute_session_id, {\r\n"Session ID", "rtitcp.control.attribute.session_id",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n0, HFILL }\r\n},\r\n{ &hf_rtitcp_control_attribute_type,\r\n{ "Attribute Type", "rtitcp.control.attribute_type",\r\nFT_UINT16, BASE_HEX, VALS(attribute_types_vals), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rtitcp_control_attribute_error_code_value,\r\n{ "Kind", "rtitcp.control.attribute.error_code",\r\nFT_UINT32, BASE_HEX, VALS(error_code_kind_vals), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rtitcp_control_attribute_error_code_description, {\r\n"Description", "rtitcp.control.attribute.error_code.description",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\n0, HFILL }\r\n},\r\n{ &hf_rtitcp_control_attribute_connection_cookie, {\r\n"Connection Cookie", "rtitcp.control.attribute.connection_cookie",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n0, HFILL }\r\n},\r\n{ &hf_rtitcp_control_attribute_connection_type, {\r\n"Class ID", "rtitcp.control_attribute.connection_type",\r\nFT_UINT8, BASE_HEX, VALS(rtitcp_attribute_connection_type_vals), 0,\r\n0, HFILL }\r\n},\r\n{ &hf_rtitcp_attributes_list_length, {\r\n"Attributes list length", "rtitcp.attributes_list_length",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n0,\r\nHFILL }\r\n},\r\n{ &hf_rtitcp_control_attribute_length, {\r\n"Attribute Length", "rtitcp.control.attribute.length",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n0, HFILL }\r\n},\r\n{ &hf_rtitcp_control_attribute_port, {\r\n"Port", "rtitcp.control.attribute_port",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n0, HFILL }\r\n},\r\n{ &hf_rtitcp_locator_kind,\r\n{ "Kind", "rtitcp.locator.kind",\r\nFT_UINT16, BASE_DEC, VALS(rtitcp_locator_kind_vals), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rtitcp_locator_ipv4,\r\n{ "Address", "rtitcp.locator.ipv4",\r\nFT_IPv4, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rtitcp_locator_port,\r\n{ "Port", "rtitcp.locator.port",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rtitcp_locator_ipv6,\r\n{ "Address", "rtitcp.locator.ipv6",\r\nFT_IPv6, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_rtitcp_control_crc_value, {\r\n"CRC", "rtitcp.control.crc",\r\nFT_UINT32, BASE_HEX, NULL, 0,\r\n0, HFILL }\r\n},\r\n{ &hf_rtitcp_response_in, {\r\n"Response In", "rtitcp.response_in",\r\nFT_FRAMENUM, BASE_NONE, NULL, 0x0,\r\n"The response to this RTITCP request is in this frame", HFILL }\r\n},\r\n{ &hf_rtitcp_response_to, {\r\n"Request In", "rtitcp.response_to",\r\nFT_FRAMENUM, BASE_NONE, NULL, 0x0,\r\n"This is a response to the RTITCP request in this frame", HFILL }\r\n},\r\n{ &hf_rtitcp_response_time, {\r\n"Response Time", "rtitcp.response_time",\r\nFT_RELATIVE_TIME, BASE_NONE, NULL, 0x0,\r\n"The time between the Request and the Reply", HFILL }\r\n},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_rtitcp,\r\n&ett_rtitcp_signalling_protocol,\r\n&ett_rtitcp_message,\r\n&ett_rtitcp_attributes_list,\r\n&ett_rtitcp_attribute\r\n};\r\nproto_rtitcp = proto_register_protocol("RTI TCP Transport Protocol",\r\n"RTITCP", "rtitcp");\r\nhfi_rtitcp = proto_registrar_get_nth(proto_rtitcp);\r\nproto_register_field_array(proto_rtitcp, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nregister_dissector("rtitcp", dissect_rtitcp, proto_rtitcp);\r\nheur_subdissector_list = register_heur_dissector_list("rtitcp", proto_rtitcp);\r\n}\r\nvoid\r\nproto_reg_handoff_rtitcp(void)\r\n{\r\nheur_dissector_add("tcp", dissect_rtitcp, "RTI TCP Layer" , "rtitcp", proto_rtitcp, HEURISTIC_ENABLE);\r\n}
