void\r\nx509ce_enable_ciplus(void)\r\n{\r\ndissector_handle_t dh25, dh26, dh27;\r\ndh25 = create_dissector_handle(dissect_ScramblerCapabilities_PDU, proto_x509ce);\r\ndissector_change_string("ber.oid", "1.3.6.1.5.5.7.1.25", dh25);\r\ndh26 = create_dissector_handle(dissect_CiplusInfo_PDU, proto_x509ce);\r\ndissector_change_string("ber.oid", "1.3.6.1.5.5.7.1.26", dh26);\r\ndh27 = create_dissector_handle(dissect_CicamBrandId_PDU, proto_x509ce);\r\ndissector_change_string("ber.oid", "1.3.6.1.5.5.7.1.27", dh27);\r\n}\r\nvoid\r\nx509ce_disable_ciplus(void)\r\n{\r\ndissector_reset_string("ber.oid", "1.3.6.1.5.5.7.1.25");\r\ndissector_reset_string("ber.oid", "1.3.6.1.5.5.7.1.26");\r\ndissector_reset_string("ber.oid", "1.3.6.1.5.5.7.1.27");\r\n}\r\nstatic int\r\ndissect_x509ce_invalidityDate_callback(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\nreturn dissect_x509ce_GeneralizedTime(FALSE, tvb, 0, &asn1_ctx, tree, hf_x509ce_id_ce_invalidityDate);\r\n}\r\nstatic int\r\ndissect_x509ce_baseUpdateTime_callback(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\nreturn dissect_x509ce_GeneralizedTime(FALSE, tvb, 0, &asn1_ctx, tree, hf_x509ce_id_ce_baseUpdateTime);\r\n}\r\nvoid proto_register_x509ce(void) {\r\nstatic hf_register_info hf[] = {\r\n{ &hf_x509ce_id_ce_baseUpdateTime,\r\n{ "baseUpdateTime", "x509ce.id_ce_baseUpdateTime",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_x509ce_id_ce_invalidityDate,\r\n{ "invalidityDate", "x509ce.id_ce_invalidityDate",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_x509ce_object_identifier_id,\r\n{ "Id", "x509ce.id", FT_OID, BASE_NONE, NULL, 0,\r\n"Object identifier Id", HFILL }},\r\n{ &hf_x509ce_IPAddress,\r\n{ "iPAddress", "x509ce.IPAddress", FT_IPv4, BASE_NONE, NULL, 0,\r\n"IP Address", HFILL }},\r\n#include "packet-x509ce-hfarr.c"\r\n};\r\nstatic gint *ett[] = {\r\n#include "packet-x509ce-ettarr.c"\r\n};\r\nproto_x509ce = proto_register_protocol(PNAME, PSNAME, PFNAME);\r\nproto_register_field_array(proto_x509ce, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid proto_reg_handoff_x509ce(void) {\r\n#include "packet-x509ce-dis-tab.c"\r\nregister_ber_oid_dissector("2.5.29.24", dissect_x509ce_invalidityDate_callback, proto_x509ce, "id-ce-invalidityDate");\r\nregister_ber_oid_dissector("2.5.29.51", dissect_x509ce_baseUpdateTime_callback, proto_x509ce, "id-ce-baseUpdateTime");\r\n}
