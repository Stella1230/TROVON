static unsigned char\r\ndect_getbit(guint8 *data, int bit)\r\n{\r\nguint8 byte=data[bit/8];\r\nreturn (byte>>bit%8)&1;\r\n}\r\nstatic void\r\ndect_setbit(guint8 *data, int bit, guint8 value)\r\n{\r\nif(!value)\r\ndata[bit/8]&=~(1<<(bit%8));\r\nelse\r\ndata[bit/8]|=(1<<(bit%8));\r\n}\r\nstatic guint8\r\ncalc_xcrc(guint8* data, guint8 length)\r\n{\r\nguint8 bits[21];\r\nguint8 gp=0x1;\r\nguint8 crc;\r\nguint8 next;\r\nint y, x;\r\nmemset(bits, 0, sizeof(bits));\r\nfor(y=0;y<=length-4;y++)\r\n{\r\ndect_setbit(bits, y, dect_getbit(data, y+48*(1+(int)(y/16))));\r\n}\r\nlength=10;\r\ncrc=bits[0];\r\ny=0;\r\nwhile(y<length)\r\n{\r\nif(y<(length-1))\r\nnext=bits[y+1];\r\nelse\r\nnext=0;\r\ny++;\r\nx=0;\r\nwhile(x<8)\r\n{\r\nwhile(!(crc&0x80))\r\n{\r\ncrc<<=1;\r\ncrc|=!!(next&0x80);\r\nnext<<=1;\r\nx++;\r\nif(x>7)\r\nbreak;\r\n}\r\nif(x>7)\r\nbreak;\r\ncrc<<=1;\r\ncrc|=!!(next&0x80);\r\nnext<<=1;\r\nx++;\r\ncrc^=(gp<<4);\r\n}\r\n}\r\nreturn crc;\r\n}\r\nstatic guint16\r\ncalc_rcrc(guint8* data)\r\n{\r\nguint16 gp=0x0589;\r\nguint16 crc;\r\nguint8 next;\r\nint y, x;\r\ncrc=data[0]<<8|data[1];\r\ny=0;\r\nwhile(y<6)\r\n{\r\nnext=data[2+y];\r\ny++;\r\nx=0;\r\nwhile(x<8)\r\n{\r\nwhile(!(crc&0x8000))\r\n{\r\ncrc<<=1;\r\ncrc|=!!(next&0x80);\r\nnext<<=1;\r\nx++;\r\nif(x>7)\r\nbreak;\r\n}\r\nif(x>7)\r\nbreak;\r\ncrc<<=1;\r\ncrc|=!!(next&0x80);\r\nnext<<=1;\r\nx++;\r\ncrc^=gp;\r\n}\r\n}\r\ncrc^=1;\r\nreturn crc;\r\n}\r\nstatic gint\r\ndissect_bfield(gboolean dect_packet_type _U_, guint8 ba,\r\npacket_info *pinfo _U_, tvbuff_t *tvb, gint offset, proto_tree *DectTree, proto_tree *ColumnsTree)\r\n{\r\nguint8 xcrc;\r\nguint16 blen;\r\ngint start_offset;\r\nconst char *bfield_str;\r\nconst char *bfield_short_str;\r\nproto_item *bfieldti = NULL;\r\nproto_tree *BField = NULL;\r\nproto_item *bfdescrdatati = NULL;\r\nproto_tree *BFDescrData = NULL;\r\nguint8 bfield_data[DECT_BFIELD_DATA_SIZE];\r\nguint bfield_length = tvb_reported_length_remaining(tvb, offset);\r\nif (bfield_length > DECT_BFIELD_DATA_SIZE)\r\nbfield_length = DECT_BFIELD_DATA_SIZE;\r\nif (bfield_length)\r\n{\r\ntvb_memcpy(tvb, bfield_data, offset, bfield_length);\r\nif (bfield_length < DECT_BFIELD_DATA_SIZE)\r\nmemset(&bfield_data[bfield_length], 0, DECT_BFIELD_DATA_SIZE - bfield_length);\r\n}\r\nelse\r\nmemset(bfield_data, 0, DECT_BFIELD_DATA_SIZE);\r\nswitch(ba)\r\n{\r\ncase 0:\r\ncase 1:\r\ncase 3:\r\ncase 5:\r\ncase 6:\r\nblen=40;\r\nbfield_short_str="Full Slot";\r\nbfield_str="Full Slot (320 bit data, 4 bit xcrc)";\r\nbreak;\r\ncase 2:\r\nblen=100;\r\nbfield_short_str="Double Slot";\r\nbfield_str="Double Slot (800 bit data, 4 bit xcrc)";\r\nbreak;\r\ncase 4:\r\nblen=10;\r\nbfield_short_str="Half Slot";\r\nbfield_str="Half Slot (80 bit data, 4 bit xcrc)";\r\nbreak;\r\ncase 7:\r\ndefault:\r\nblen=0;\r\nbfield_short_str="No B-Field";\r\nbfield_str="No B-Field";\r\nbreak;\r\n}\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_BField, tvb, offset, 1, bfield_short_str);\r\nif(blen)\r\n{\r\nbfieldti = proto_tree_add_item(DectTree, hf_dect_B, tvb, offset, blen, ENC_NA);\r\nBField = proto_item_add_subtree(bfieldti, ett_bfield);\r\nproto_tree_add_none_format(BField, hf_dect_B_Data, tvb, offset, blen, "%s", bfield_str);\r\nbfdescrdatati = proto_tree_add_item(BField, hf_dect_B_DescrambledData, tvb, offset, blen, ENC_NA);\r\nBFDescrData = proto_item_add_subtree(bfdescrdatati, ett_bfdescrdata);\r\n}\r\nstart_offset=offset;\r\nif(blen<=bfield_length)\r\n{\r\ngint fn;\r\nguint16 x, y;\r\nfor(fn=0;fn<8;fn++)\r\n{\r\nguint16 bytecount=0;\r\noffset=start_offset;\r\nproto_tree_add_none_format(BFDescrData, hf_dect_B_fn, tvb, offset, 0, "Framenumber %u/%u", fn, fn+8);\r\nfor(x=0;x<blen;x+=16)\r\n{\r\nwmem_strbuf_t *string;\r\nstring = wmem_strbuf_new(wmem_packet_scope(), NULL);\r\nfor(y=0;y<16;y++)\r\n{\r\nif((x+y)>=blen)\r\nbreak;\r\nwmem_strbuf_append_printf(string,"%.2x ", bfield_data[x+y]^scrt[fn][bytecount%31]);\r\nbytecount++;\r\n}\r\nproto_tree_add_none_format(BFDescrData, hf_dect_B_Data, tvb, offset,\r\ny, "Data: %s", wmem_strbuf_get_str(string));\r\noffset+=y;\r\n}\r\n}\r\n}\r\nelse\r\nproto_tree_add_none_format(BField, hf_dect_B_Data, tvb, offset, 0, "Data too Short");\r\nif(blen==40)\r\nxcrc=calc_xcrc(bfield_data, 83);\r\nelse\r\nxcrc=0;\r\nif((unsigned)(blen+1)<=bfield_length)\r\n{\r\nif(xcrc!=(bfield_data[40]&0xf0))\r\nproto_tree_add_uint_format(bfieldti, hf_dect_B_XCRC, tvb, offset, 1, 0, "X-CRC Error (Calc:%.2x, Recv:%.2x)",xcrc, bfield_data[40]&0xf0);\r\nelse\r\nproto_tree_add_uint_format(bfieldti, hf_dect_B_XCRC, tvb, offset, 1, 1, "X-CRC Match (Calc:%.2x, Recv:%.2x)", xcrc, bfield_data[40]&0xf0);\r\n}\r\nelse\r\nproto_tree_add_uint_format(bfieldti, hf_dect_B_XCRC, tvb, offset, 1, 0, "No X-CRC logged (Calc:%.2x)", xcrc);\r\nreturn offset;\r\n}\r\nstatic void\r\ndissect_afield(gboolean dect_packet_type, guint8 *ba,\r\npacket_info *pinfo _U_, tvbuff_t *tvb, gint offset, proto_tree *DectTree, proto_tree *ColumnsTree)\r\n{\r\nguint8 ta;\r\nguint8 rcrcdat[8];\r\nguint16 computed_rcrc;\r\nwmem_strbuf_t *afield_str;\r\nproto_item *afieldti = NULL;\r\nproto_item *aheadti = NULL;\r\nproto_item *atailti = NULL;\r\nproto_tree *AField = NULL;\r\nproto_tree *AHead = NULL;\r\nproto_tree *ATail = NULL;\r\nguint8 header, tail_0, tail_1, tail_2, tail_3, tail_4;\r\nguint16 rcrc;\r\nafield_str = wmem_strbuf_new(wmem_packet_scope(), NULL);\r\nheader = tvb_get_guint8(tvb, offset+0);\r\ntail_0 = tvb_get_guint8(tvb, offset+1);\r\ntail_1 = tvb_get_guint8(tvb, offset+2);\r\ntail_2 = tvb_get_guint8(tvb, offset+3);\r\ntail_3 = tvb_get_guint8(tvb, offset+4);\r\ntail_4 = tvb_get_guint8(tvb, offset+5);\r\nrcrc = tvb_get_ntohs(tvb, offset+6);\r\nta = (header & DECT_A_TA_MASK) >> DECT_A_TA_SHIFT;\r\n*ba = (header & DECT_A_BA_MASK) >> DECT_A_BA_SHIFT;\r\nafieldti = proto_tree_add_item(DectTree, hf_dect_A, tvb, offset, DECT_AFIELD_SIZE, ENC_NA);\r\nAField = proto_item_add_subtree(afieldti, ett_afield);\r\naheadti = proto_tree_add_item(AField, hf_dect_A_Head, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nAHead = proto_item_add_subtree(aheadti, ett_ahead);\r\nif(dect_packet_type==DECT_PACKET_FP)\r\nproto_tree_add_item(AHead, hf_dect_A_Head_TA_FP, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nelse\r\nproto_tree_add_item(AHead, hf_dect_A_Head_TA_PP, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(AHead, hf_dect_A_Head_Q1, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(AHead, hf_dect_A_Head_BA, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(AHead, hf_dect_A_Head_Q2, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nif(dect_packet_type==DECT_PACKET_FP)\r\n{\r\natailti = proto_tree_add_none_format(afieldti, hf_dect_A_Tail, tvb, offset, 5,\r\n"FP-Tail: %s", val_to_str(ta, TA_vals_FP, "Error, please report: %d"));\r\n}\r\nelse\r\n{\r\natailti = proto_tree_add_none_format(afieldti, hf_dect_A_Tail, tvb, offset, 5,\r\n"PP-Tail: %s", val_to_str(ta, TA_vals_PP, "Error, please report: %d"));\r\n}\r\nATail = proto_item_add_subtree(atailti, ett_atail);\r\nif((ta==DECT_TA_CT0)||(ta==DECT_TA_CT1))\r\n{\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_TA, tvb, offset, 1, "[Ct]");\r\nif(ta==DECT_TA_CT0)\r\nwmem_strbuf_append_printf(afield_str,"C-Channel Next Data: %s",tvb_bytes_to_str(wmem_packet_scope(), tvb, offset, 5));\r\nelse\r\nwmem_strbuf_append_printf(afield_str,"C-Channel First Data: %s",tvb_bytes_to_str(wmem_packet_scope(), tvb, offset, 5));\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_AField, tvb, offset, 1, wmem_strbuf_get_str(afield_str));\r\n}\r\nelse if((ta==DECT_TA_NT)||(ta==DECT_TA_NT_CL))\r\n{\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_TA, tvb, offset, 1, "[Nt]");\r\nwmem_strbuf_append_printf(afield_str,"RFPI: %s",tvb_bytes_to_str(wmem_packet_scope(), tvb, offset, 5));\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_AField, tvb, offset, 1, wmem_strbuf_get_str(afield_str));\r\nproto_tree_add_item(atailti, hf_dect_A_Tail_Nt, tvb, offset, 5, ENC_NA);\r\n}\r\nelse if(ta==DECT_TA_QT)\r\n{\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_TA, tvb, offset, 1, "[Qt]");\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_Qh, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nswitch(tail_0>>4)\r\n{\r\ncase 0:\r\ncase 1:\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_AField, tvb, offset, 1, "Static System Info");\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_0_Nr, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_0_Sn, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_0_Sp, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_0_Esc, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_0_Txs, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_0_Mc, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_none_format(ATail, hf_dect_A_Tail_Qt_0_CA, tvb, offset, 2, " Carrier%s%s%s%s%s%s%s%s%s%s available",\r\n(tail_1&0x02)?" 0":"", (tail_1&0x01)?" 1":"", (tail_2&0x80)?" 2":"",\r\n(tail_2&0x40)?" 3":"", (tail_2&0x20)?" 4":"", (tail_2&0x10)?" 5":"",\r\n(tail_2&0x08)?" 6":"", (tail_2&0x04)?" 7":"", (tail_2&0x02)?" 8":"",\r\n(tail_2&0x01)?" 9":"");\r\noffset+=2;\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_0_Spr1, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_0_Cn, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_0_Spr2, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_0_PSCN, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\noffset-=5;\r\nbreak;\r\ncase 2:\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_AField, tvb, offset, 1, "Extended RF Carriers Part 1");\r\nbreak;\r\ncase 3:\r\n{\r\nstatic const int * cap1_flags[] = {\r\n&hf_dect_A_Tail_Qt_3_A12,\r\n&hf_dect_A_Tail_Qt_3_A13,\r\n&hf_dect_A_Tail_Qt_3_A14,\r\n&hf_dect_A_Tail_Qt_3_A15,\r\nNULL\r\n};\r\nstatic const int * cap2_flags[] = {\r\n&hf_dect_A_Tail_Qt_3_A16,\r\n&hf_dect_A_Tail_Qt_3_A17,\r\n&hf_dect_A_Tail_Qt_3_A18,\r\n&hf_dect_A_Tail_Qt_3_A19,\r\n&hf_dect_A_Tail_Qt_3_A20,\r\n&hf_dect_A_Tail_Qt_3_A21,\r\n&hf_dect_A_Tail_Qt_3_A22,\r\n&hf_dect_A_Tail_Qt_3_A23,\r\nNULL\r\n};\r\nstatic const int * cap3_flags[] = {\r\n&hf_dect_A_Tail_Qt_3_A24,\r\n&hf_dect_A_Tail_Qt_3_A25,\r\n&hf_dect_A_Tail_Qt_3_A26,\r\n&hf_dect_A_Tail_Qt_3_A27,\r\n&hf_dect_A_Tail_Qt_3_A28,\r\n&hf_dect_A_Tail_Qt_3_A29,\r\n&hf_dect_A_Tail_Qt_3_A30,\r\n&hf_dect_A_Tail_Qt_3_A31,\r\nNULL\r\n};\r\nstatic const int * cap4_flags[] = {\r\n&hf_dect_A_Tail_Qt_3_A32,\r\n&hf_dect_A_Tail_Qt_3_A33,\r\n&hf_dect_A_Tail_Qt_3_A34,\r\n&hf_dect_A_Tail_Qt_3_A35,\r\n&hf_dect_A_Tail_Qt_3_A36,\r\n&hf_dect_A_Tail_Qt_3_A37,\r\n&hf_dect_A_Tail_Qt_3_A38,\r\n&hf_dect_A_Tail_Qt_3_A39,\r\nNULL\r\n};\r\nstatic const int * cap5_flags[] = {\r\n&hf_dect_A_Tail_Qt_3_A40,\r\n&hf_dect_A_Tail_Qt_3_A41,\r\n&hf_dect_A_Tail_Qt_3_A42,\r\n&hf_dect_A_Tail_Qt_3_A43,\r\n&hf_dect_A_Tail_Qt_3_A44,\r\n&hf_dect_A_Tail_Qt_3_A45,\r\n&hf_dect_A_Tail_Qt_3_A46,\r\n&hf_dect_A_Tail_Qt_3_A47,\r\nNULL\r\n};\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_AField, tvb, offset, 1, "Fixed Part Capabilities");\r\nproto_tree_add_bitmask_list(ATail, tvb, offset, 1, cap1_flags, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask_list(ATail, tvb, offset+1, 1, cap2_flags, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask_list(ATail, tvb, offset+2, 1, cap3_flags, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask_list(ATail, tvb, offset+3, 1, cap4_flags, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask_list(ATail, tvb, offset+4, 1, cap5_flags, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase 4:\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_AField, tvb, offset, 1, "Extended Fixed Part Capabilities");\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_CRFPHops, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_CRFPEnc, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_REFHops, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_REPCap, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_Sync, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_A20, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_MACSusp, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_MACIpq, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_A23, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_A24, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_A25, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_A26, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_A27, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_A28, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_A29, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_A30, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_A31, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_A32, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_A33, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_A34, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_A35, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_A36, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_A37, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_A38, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_A39, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_A40, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_A41, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_A42, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_A43, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_A44, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_A45, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_A46, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_4_A47, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\noffset-=5;\r\nbreak;\r\ncase 5:\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_AField, tvb, offset, 1, "SARI List Contents");\r\nbreak;\r\ncase 6:\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_6_Spare, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset+=2;\r\nwmem_strbuf_append_printf(afield_str,"Multi-Frame No.: %s",tvb_bytes_to_str(wmem_packet_scope(), tvb, offset, 3));\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_AField, tvb, offset, 1, wmem_strbuf_get_str(afield_str));\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Qt_6_Mfn, tvb, offset, 3, ENC_NA);\r\noffset+=3;\r\noffset-=5;\r\nbreak;\r\ncase 7:\r\nwmem_strbuf_append_printf(afield_str,"Escape Data: %s",tvb_bytes_to_str(wmem_packet_scope(), tvb, offset, 5));\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_AField, tvb, offset, 1, wmem_strbuf_get_str(afield_str));\r\nbreak;\r\ncase 8:\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_AField, tvb, offset, 1, "Obsolete");\r\nbreak;\r\ncase 9:\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_AField, tvb, offset, 1, "Extended RF Carriers Part 2");\r\nbreak;\r\ncase 11:\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_AField, tvb, offset, 1, "Transmit Information");\r\nbreak;\r\ncase 12:\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_AField, tvb, offset, 1, "Extended Fixed Part Capabilities 2");\r\nbreak;\r\ncase 10:\r\ncase 13:\r\ncase 14:\r\ncase 15:\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_AField, tvb, offset, 1, "Reserved");\r\nbreak;\r\n}\r\n}\r\nelse if(ta==DECT_TA_ESC)\r\n{\r\n}\r\nelse if((ta==DECT_TA_MT)||((ta==DECT_TA_MT_FIRST)&&(dect_packet_type==DECT_PACKET_PP)))\r\n{\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_TA, tvb, offset, 1, "[Mt]");\r\nproto_tree_add_uint(ATail, hf_dect_A_Tail_Mt_Mh, tvb, offset, 1, tail_0);\r\nswitch(tail_0>>4)\r\n{\r\ncase 0:\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_AField, tvb, offset, 1, "Basic Connection Control");\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Mt_BasicConCtrl, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nif(((tail_0 & 0x0f)==6)||((tail_0 & 0x0f)==7))\r\n{\r\nproto_tree_add_none_format(ATail, hf_dect_A_Tail_Mt_Mh_attr, tvb, offset, 4, "More infos at ETSI EN 300 175-3 V2.3.0 7.2.5.2.4");\r\noffset +=4;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Mt_Mh_fmid, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Mt_Mh_pmid, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset+=3;\r\n}\r\noffset-=5;\r\nbreak;\r\ncase 1:\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_AField, tvb, offset, 1, "Advanced Connection Control");\r\nbreak;\r\ncase 2:\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_AField, tvb, offset, 1, "MAC Layer Test Messages");\r\nbreak;\r\ncase 3:\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_AField, tvb, offset, 1, "Quality Control");\r\nbreak;\r\ncase 4:\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_AField, tvb, offset, 1, "Broadcast and Connectionless Services");\r\nbreak;\r\ncase 5:\r\nwmem_strbuf_append_printf(afield_str,"Encryption Control: %s %s",\r\nval_to_str((tail_0&0x0c)>>2, MTEncrCmd1_vals, "Error, please report: %d"),\r\nval_to_str(tail_0&0x03, MTEncrCmd2_vals, "Error, please report: %d"));\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_AField, tvb, offset, 1, wmem_strbuf_get_str(afield_str));\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Mt_Encr_Cmd1, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Mt_Encr_Cmd2, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Mt_Mh_fmid, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Mt_Mh_pmid, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset+=3;\r\noffset-=5;\r\nbreak;\r\ncase 6:\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_AField, tvb, offset, 1, "Tail for use with the first Transmission of a B-Field \"bearer request\" Message");\r\nbreak;\r\ncase 7:\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_AField, tvb, offset, 1, "Escape");\r\nbreak;\r\ncase 8:\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_AField, tvb, offset, 1, "TARI Message");\r\nbreak;\r\ncase 9:\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_AField, tvb, offset, 1, "REP Connection Control");\r\nbreak;\r\ncase 10:\r\ncase 11:\r\ncase 12:\r\ncase 13:\r\ncase 14:\r\ncase 15:\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_AField, tvb, offset, 1, "Reserved");\r\nbreak;\r\n}\r\n}\r\nelse if((ta==DECT_TA_PT)&&(dect_packet_type==DECT_PACKET_FP))\r\n{\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_TA, tvb, offset, 1, "[Pt]");\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Pt_ExtFlag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Pt_SDU, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nif(((tail_0&0x70)>>4)&0xfe)\r\nwmem_strbuf_append_printf(afield_str,"%s, ",val_to_str((tail_0&0x70)>>4, PTSDU_vals, "Error, please report: %d"));\r\nswitch((tail_0&0x70)>>4)\r\n{\r\ncase 0:\r\ncase 1:\r\nif(((tail_0&0x70)>>4)==0)\r\n{\r\nwmem_strbuf_append_printf(afield_str,"RFPI: xxxxx%.1x%.2x%.2x, ", (tail_0&0x0f), tail_1, tail_2);\r\nproto_tree_add_none_format(atailti, hf_dect_A_Tail_Pt_RFPI, tvb, offset, 3, "RFPI: xxxxx%.1x%.2x%.2x", (tail_0&0x0f), tail_1, tail_2);\r\noffset+=3;\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Pt_InfoType, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nwmem_strbuf_append_printf(afield_str,"Bs Data: %.1x%.2x%.2x, ", (tail_0&0x0f), tail_1, tail_2);\r\nproto_tree_add_none_format(atailti, hf_dect_A_Tail_Pt_BsData, tvb, offset, 3, "Bs Data: %.1x%.2x%.2x", (tail_0&0x0f), tail_1, tail_2);\r\noffset+=3;\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Pt_InfoType, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nwmem_strbuf_append_printf(afield_str,"%s",val_to_str(tail_3>>4, PTInfoType_vals, "Error, please report: %d"));\r\nswitch(tail_3>>4)\r\n{\r\ncase 0:\r\nproto_tree_add_none_format(ATail, hf_dect_A_Tail_Pt_Fillbits, tvb, offset, 2, "Fillbits: %.1x%.2x", tail_3&0x0f, tail_4);\r\noffset+=2;\r\nbreak;\r\ncase 1:\r\noffset+=2;\r\nbreak;\r\ncase 7:\r\noffset+=2;\r\nbreak;\r\ncase 8:\r\nproto_tree_add_none_format(ATail, hf_dect_A_Tail_Pt_SlotPairs, tvb, offset, 2, " Slot-Pairs: %s%s%s%s%s%s%s%s%s%s%s%s available",\r\n(tail_3&0x08)?" 0/12":"", (tail_3&0x04)?" 1/13":"", (tail_3&0x02)?" 2/14":"",\r\n(tail_3&0x01)?" 3/15":"", (tail_4&0x80)?" 4/16":"", (tail_4&0x40)?" 5/17":"",\r\n(tail_4&0x20)?" 6/18":"", (tail_4&0x10)?" 7/19":"", (tail_4&0x08)?" 8/20":"",\r\n(tail_4&0x04)?" 9/21":"", (tail_4&0x02)?" 10/22":"", (tail_4&0x01)?" 11/23":"");\r\noffset+=2;\r\nbreak;\r\ncase 2:\r\ncase 3:\r\ncase 4:\r\ncase 5:\r\ncase 12:\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Pt_Bearer_Sn, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Pt_Bearer_Sp, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ATail, hf_dect_A_Tail_Pt_Bearer_Cn, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nbreak;\r\ncase 6:\r\noffset+=2;\r\nbreak;\r\ncase 9:\r\noffset+=2;\r\nbreak;\r\ncase 10:\r\noffset+=2;\r\nbreak;\r\ncase 11:\r\noffset+=2;\r\nbreak;\r\ncase 13:\r\noffset+=2;\r\nbreak;\r\ncase 14:\r\noffset+=2;\r\nbreak;\r\ncase 15:\r\noffset+=2;\r\nbreak;\r\n}\r\noffset-=5;\r\nbreak;\r\ncase 2:\r\nwmem_strbuf_append_printf(afield_str,"Full Page");\r\nbreak;\r\ncase 3:\r\nwmem_strbuf_append_printf(afield_str,"MAC Resume Page");\r\nbreak;\r\ncase 4:\r\nwmem_strbuf_append_printf(afield_str,"Not the Last 36 Bits");\r\nbreak;\r\ncase 5:\r\nwmem_strbuf_append_printf(afield_str,"The First 36 Bits");\r\nbreak;\r\ncase 6:\r\nwmem_strbuf_append_printf(afield_str,"The Last 36 Bits");\r\nbreak;\r\ncase 7:\r\nwmem_strbuf_append_printf(afield_str,"All of a Long Page");\r\nbreak;\r\n}\r\nproto_tree_add_string(ColumnsTree, hf_dect_cc_AField, tvb, offset, 1, wmem_strbuf_get_str(afield_str));\r\n}\r\noffset+=5;\r\ntvb_memcpy(tvb, rcrcdat, DECT_PACKET_INFO_LEN, 6);\r\nrcrcdat[6]=0;\r\nrcrcdat[7]=0;\r\ncomputed_rcrc=calc_rcrc(rcrcdat);\r\nif(computed_rcrc!=rcrc)\r\nproto_tree_add_uint_format(afieldti, hf_dect_A_RCRC, tvb, offset, 2, 0, "R-CRC Error (Calc:%.4x, Recv:%.4x)", computed_rcrc, rcrc);\r\nelse\r\nproto_tree_add_uint_format(afieldti, hf_dect_A_RCRC, tvb, offset, 2, 1, "R-CRC Match (Calc:%.4x, Recv:%.4x)", computed_rcrc, rcrc);\r\n}\r\nstatic int\r\ndissect_dect(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nproto_item *ti =NULL;\r\nproto_item *typeti =NULL;\r\nproto_tree *DectTree =NULL;\r\ngint offset =0;\r\nguint16 type;\r\nguint pkt_len;\r\nguint8 ba;\r\nproto_item *columnstreeti;\r\nproto_tree *ColumnsTree;\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Use Custom Columns for Infos");\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "DECT");\r\npkt_len=tvb_reported_length(tvb);\r\nif(pkt_len<=DECT_PACKET_INFO_LEN)\r\n{\r\ncol_set_str(pinfo->cinfo, COL_INFO, "No Data");\r\nreturn tvb_captured_length(tvb);\r\n}\r\nti=proto_tree_add_item(tree, proto_dect, tvb, 0, -1, ENC_NA);\r\nDectTree=proto_item_add_subtree(ti, ett_dect);\r\nproto_tree_add_item(DectTree, hf_dect_transceivermode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(DectTree, hf_dect_channel, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(DectTree, hf_dect_slot, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset+=2;\r\nproto_tree_add_item(DectTree, hf_dect_framenumber, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(DectTree, hf_dect_rssi, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(DectTree, hf_dect_preamble, tvb, offset, 3, ENC_NA);\r\noffset+=3;\r\ntypeti=proto_tree_add_item(DectTree, hf_dect_type, tvb, offset, 2, ENC_NA);\r\ntype=tvb_get_ntohs(tvb, offset);\r\noffset+=2;\r\ncolumnstreeti = proto_tree_add_item(DectTree, hf_dect_cc, tvb, 0, 0, ENC_NA);\r\nColumnsTree = proto_item_add_subtree(columnstreeti, ett_afield);\r\nswitch(type) {\r\ncase 0x1675:\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "DECT PP");\r\nproto_item_append_text(typeti, " Phone Packet");\r\ndissect_afield(DECT_PACKET_PP, &ba, pinfo, tvb, offset, DectTree, ColumnsTree);\r\noffset += DECT_AFIELD_SIZE;\r\ndissect_bfield(DECT_PACKET_PP, ba, pinfo, tvb, offset, DectTree, ColumnsTree);\r\nbreak;\r\ncase 0xe98a:\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "DECT RFP");\r\nproto_item_append_text(typeti, " Station Packet");\r\ndissect_afield(DECT_PACKET_FP, &ba, pinfo, tvb, offset, DectTree, ColumnsTree);\r\noffset += DECT_AFIELD_SIZE;\r\ndissect_bfield(DECT_PACKET_FP, ba, pinfo, tvb, offset, DectTree, ColumnsTree);\r\nbreak;\r\ndefault:\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "DECT Unk");\r\nproto_item_append_text(typeti, " Unknown Packet");\r\nbreak;\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_dect(void)\r\n{\r\nstatic hf_register_info hf[]=\r\n{\r\n{ &hf_dect_transceivermode,\r\n{"Tranceiver-Mode", "dect.tranceivermode", FT_UINT8, BASE_HEX, VALS(tranceiver_mode),\r\n0x0, NULL, HFILL}},\r\n{ &hf_dect_channel,\r\n{"Channel", "dect.channel", FT_UINT8, BASE_DEC, NULL,\r\n0x0, NULL, HFILL}},\r\n{ &hf_dect_framenumber,\r\n{"Frame#", "dect.framenumber", FT_UINT16, BASE_DEC, NULL,\r\n0x0, NULL, HFILL}},\r\n{ &hf_dect_rssi,\r\n{"RSSI", "dect.rssi", FT_UINT8, BASE_DEC, NULL,\r\n0x0, NULL, HFILL}},\r\n{ &hf_dect_slot,\r\n{"Slot", "dect.slot", FT_UINT16, BASE_DEC, NULL,\r\n0x0, NULL, HFILL}},\r\n{ &hf_dect_preamble,\r\n{"Preamble", "dect.preamble", FT_BYTES, BASE_NONE, NULL,\r\n0x0, NULL, HFILL}},\r\n{ &hf_dect_type,\r\n{"Packet-Type", "dect.type", FT_BYTES, BASE_NONE, NULL,\r\n0x0, NULL, HFILL}},\r\n{ &hf_dect_cc,\r\n{"Columns", "dect.cc", FT_NONE, BASE_NONE, NULL,\r\n0x0, NULL, HFILL}},\r\n{ &hf_dect_cc_TA,\r\n{"TA", "dect.cc.TA", FT_STRING, BASE_NONE, NULL,\r\n0x0, NULL, HFILL}},\r\n{ &hf_dect_cc_AField,\r\n{"A-Field", "dect.cc.afield", FT_STRING, BASE_NONE, NULL,\r\n0x0, NULL, HFILL}},\r\n{ &hf_dect_cc_BField,\r\n{"B-Field", "dect.cc.bfield", FT_STRING, BASE_NONE, NULL,\r\n0x0, NULL, HFILL}},\r\n{ &hf_dect_A,\r\n{"A-Field", "dect.afield", FT_BYTES, BASE_NONE, NULL,\r\n0x0, NULL, HFILL}},\r\n{ &hf_dect_A_Head,\r\n{"A-Field Header", "dect.afield.head", FT_UINT8, BASE_HEX, NULL,\r\n0x0, NULL, HFILL}},\r\n{ &hf_dect_A_Head_TA_FP,\r\n{"TA", "dect.afield.head.TA", FT_UINT8, BASE_DEC, VALS(TA_vals_FP),\r\nDECT_A_TA_MASK, NULL, HFILL}},\r\n{ &hf_dect_A_Head_TA_PP,\r\n{"TA", "dect.afield.head.TA", FT_UINT8, BASE_DEC, VALS(TA_vals_PP),\r\nDECT_A_TA_MASK, NULL, HFILL}},\r\n{ &hf_dect_A_Head_Q1,\r\n{"Q1", "dect.afield.head.Q1", FT_UINT8, BASE_DEC, NULL,\r\nDECT_A_Q1_MASK, NULL, HFILL}},\r\n{ &hf_dect_A_Head_BA,\r\n{"BA", "dect.afield.head.BA", FT_UINT8, BASE_DEC, VALS(BA_vals),\r\nDECT_A_BA_MASK, NULL, HFILL}},\r\n{ &hf_dect_A_Head_Q2,\r\n{"Q2", "dect.afield.head.Q2", FT_UINT8, BASE_DEC, NULL,\r\nDECT_A_Q2_MASK, NULL, HFILL}},\r\n{ &hf_dect_A_Tail,\r\n{"A-Field Tail", "dect.afield.tail", FT_NONE, BASE_NONE, NULL,\r\n0x0, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Nt,\r\n{"RFPI", "dect.afield.tail.Nt", FT_BYTES, BASE_NONE, NULL,\r\n0x0, "A-Field Tail: Nt/RFPI", HFILL}},\r\n{ &hf_dect_A_Tail_Qt_Qh,\r\n{"Qh", "dect.afield.tail.Qt.Qh", FT_UINT8, BASE_DEC, VALS(QTHead_vals),\r\n0xF0, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_0_Nr,\r\n{"NR", "dect.afield.tail.Qt.NR", FT_UINT8, BASE_DEC, VALS(QTNormalReverse_vals),\r\n0x10, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_0_Sn,\r\n{"SN", "dect.afield.tail.Qt.SN", FT_UINT8, BASE_DEC, VALS(QTSlotNumber_vals),\r\n0x0F, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_0_Sp,\r\n{"SP", "dect.afield.tail.Qt.SP", FT_UINT8, BASE_DEC, VALS(QTStartPosition_vals),\r\n0xC0, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_0_Esc,\r\n{"Esc", "dect.afield.tail.Qt.Esc", FT_UINT8, BASE_DEC, VALS(QTEscape_vals),\r\n0x20, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_0_Txs,\r\n{"Txs", "dect.afield.tail.Qt.Txs", FT_UINT8, BASE_DEC, VALS(QTTranceiver_vals),\r\n0x18, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_0_Mc,\r\n{"Mc", "dect.afield.tail.Qt.Mc", FT_UINT8, BASE_DEC, VALS(QTExtendedCarrier_vals),\r\n0x04, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_0_CA,\r\n{"CA", "dect.afield.tail.Qt.CA", FT_NONE, BASE_NONE, NULL,\r\n0x0, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_0_Spr1,\r\n{"Spr1", "dect.afield.tail.Qt.Spr1", FT_UINT8, BASE_DEC, VALS(QTSpr_vals),\r\n0xC0, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_0_Cn,\r\n{"CN", "dect.afield.tail.Qt.CN", FT_UINT8, BASE_DEC, VALS(QTCarrierNumber_vals),\r\n0x3F, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_0_Spr2,\r\n{"Spr2", "dect.afield.tail.Qt.Spr2", FT_UINT8, BASE_DEC, VALS(QTSpr_vals),\r\n0xC0, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_0_PSCN,\r\n{"PSCN", "dect.afield.tail.Qt.PSCN", FT_UINT8, BASE_DEC, VALS(QTScanCarrierNum_vals),\r\n0x3F, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A12,\r\n{"A12", "dect.afield.tail.Qt.Fp.A12", FT_UINT8, BASE_DEC, VALS(Qt_A12_vals),\r\n0x08, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A13,\r\n{"A13", "dect.afield.tail.Qt.Fp.A13", FT_UINT8, BASE_DEC, VALS(Qt_A13_vals),\r\n0x04, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A14,\r\n{"A14", "dect.afield.tail.Qt.Fp.A14", FT_UINT8, BASE_DEC, VALS(Qt_A14_vals),\r\n0x02, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A15,\r\n{"A15", "dect.afield.tail.Qt.Fp.A15", FT_UINT8, BASE_DEC, VALS(Qt_A15_vals),\r\n0x01, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A16,\r\n{"A16", "dect.afield.tail.Qt.Fp.A16", FT_UINT8, BASE_DEC, VALS(Qt_A16_vals),\r\n0x80, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A17,\r\n{"A17", "dect.afield.tail.Qt.Fp.A17", FT_UINT8, BASE_DEC, VALS(Qt_A17_vals),\r\n0x40, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A18,\r\n{"A18", "dect.afield.tail.Qt.Fp.A18", FT_UINT8, BASE_DEC, VALS(Qt_A18_vals),\r\n0x20, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A19,\r\n{"A19", "dect.afield.tail.Qt.Fp.A19", FT_UINT8, BASE_DEC, VALS(Qt_A19_vals),\r\n0x10, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A20,\r\n{"A20", "dect.afield.tail.Qt.Fp.A20", FT_UINT8, BASE_DEC, VALS(Qt_A20_vals),\r\n0x08, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A21,\r\n{"A21", "dect.afield.tail.Qt.Fp.A21", FT_UINT8, BASE_DEC, VALS(Qt_A21_vals),\r\n0x04, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A22,\r\n{"A22", "dect.afield.tail.Qt.Fp.A22", FT_UINT8, BASE_DEC, VALS(Qt_A22_vals),\r\n0x02, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A23,\r\n{"A23", "dect.afield.tail.Qt.Fp.A23", FT_UINT8, BASE_DEC, VALS(Qt_A23_vals),\r\n0x01, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A24,\r\n{"A24", "dect.afield.tail.Qt.Fp.A24", FT_UINT8, BASE_DEC, VALS(Qt_A24_vals),\r\n0x80, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A25,\r\n{"A25", "dect.afield.tail.Qt.Fp.A25", FT_UINT8, BASE_DEC, VALS(Qt_A25_vals),\r\n0x40, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A26,\r\n{"A26", "dect.afield.tail.Qt.Fp.A26", FT_UINT8, BASE_DEC, VALS(Qt_A26_vals),\r\n0x20, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A27,\r\n{"A27", "dect.afield.tail.Qt.Fp.A27", FT_UINT8, BASE_DEC, VALS(Qt_A27_vals),\r\n0x10, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A28,\r\n{"A28", "dect.afield.tail.Qt.Fp.A28", FT_UINT8, BASE_DEC, VALS(Qt_A28_vals),\r\n0x08, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A29,\r\n{"A29", "dect.afield.tail.Qt.Fp.A29", FT_UINT8, BASE_DEC, VALS(Qt_A29_vals),\r\n0x04, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A30,\r\n{"A30", "dect.afield.tail.Qt.Fp.A30", FT_UINT8, BASE_DEC, VALS(Qt_A30_vals),\r\n0x02, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A31,\r\n{"A31", "dect.afield.tail.Qt.Fp.A31", FT_UINT8, BASE_DEC, VALS(Qt_A31_vals),\r\n0x01, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A32,\r\n{"A32", "dect.afield.tail.Qt.Fp.A32", FT_UINT8, BASE_DEC, VALS(Qt_A32_vals),\r\n0x80, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A33,\r\n{"A33", "dect.afield.tail.Qt.Fp.A33", FT_UINT8, BASE_DEC, VALS(Qt_A33_vals),\r\n0x40, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A34,\r\n{"A34", "dect.afield.tail.Qt.Fp.A34", FT_UINT8, BASE_DEC, VALS(Qt_A34_vals),\r\n0x20, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A35,\r\n{"A35", "dect.afield.tail.Qt.Fp.A35", FT_UINT8, BASE_DEC, VALS(Qt_A35_vals),\r\n0x10, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A36,\r\n{"A36", "dect.afield.tail.Qt.Fp.A36", FT_UINT8, BASE_DEC, VALS(Qt_A36_vals),\r\n0x08, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A37,\r\n{"A37", "dect.afield.tail.Qt.Fp.A37", FT_UINT8, BASE_DEC, VALS(Qt_A37_vals),\r\n0x04, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A38,\r\n{"A38", "dect.afield.tail.Qt.Fp.A38", FT_UINT8, BASE_DEC, VALS(Qt_A38_vals),\r\n0x02, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A39,\r\n{"A39", "dect.afield.tail.Qt.Fp.A39", FT_UINT8, BASE_DEC, VALS(Qt_A39_vals),\r\n0x01, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A40,\r\n{"A40", "dect.afield.tail.Qt.Fp.A40", FT_UINT8, BASE_DEC, VALS(Qt_A40_vals),\r\n0x80, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A41,\r\n{"A41", "dect.afield.tail.Qt.Fp.A41", FT_UINT8, BASE_DEC, VALS(Qt_A41_vals),\r\n0x40, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A42,\r\n{"A42", "dect.afield.tail.Qt.Fp.A42", FT_UINT8, BASE_DEC, VALS(Qt_A42_vals),\r\n0x20, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A43,\r\n{"A43", "dect.afield.tail.Qt.Fp.A43", FT_UINT8, BASE_DEC, VALS(Qt_A43_vals),\r\n0x10, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A44,\r\n{"A44", "dect.afield.tail.Qt.Fp.A44", FT_UINT8, BASE_DEC, VALS(Qt_A44_vals),\r\n0x08, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A45,\r\n{"A45", "dect.afield.tail.Qt.Fp.A45", FT_UINT8, BASE_DEC, VALS(Qt_A45_vals),\r\n0x04, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A46,\r\n{"A46", "dect.afield.tail.Qt.Fp.A46", FT_UINT8, BASE_DEC, VALS(Qt_A46_vals),\r\n0x02, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_3_A47,\r\n{"A47", "dect.afield.tail.Qt.Fp.A47", FT_UINT8, BASE_DEC, VALS(Qt_A47_vals),\r\n0x01, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_CRFPHops,\r\n{"CRFP Hops", "dect.afield.tail.Qt.Efp.CRFPHops", FT_UINT8, BASE_DEC, VALS(Qt_CRFPHops_vals),\r\n0x0C, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_CRFPEnc,\r\n{"CRFP Enc", "dect.afield.tail.Qt.Efp.CRFPEnc", FT_UINT8, BASE_DEC, VALS(Qt_CRFPEnc_vals),\r\n0x02, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_REFHops,\r\n{"REP Hops", "dect.afield.tail.Qt.Efp.REPHops", FT_UINT16, BASE_DEC, VALS(Qt_REPHops_vals),\r\n0x0180, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_REPCap,\r\n{"REP Cap.", "dect.afield.tail.Qt.Efp.REPCap", FT_UINT8, BASE_DEC, VALS(Qt_REPCap_vals),\r\n0x40, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_Sync,\r\n{"Sync", "dect.afield.tail.Qt.Efp.Sync", FT_UINT8, BASE_DEC, VALS(Qt_Sync_vals),\r\n0x30, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_A20,\r\n{"A20", "dect.afield.tail.Qt.Efp.A20", FT_UINT8, BASE_DEC, VALS(Qt_EA20_vals),\r\n0x08, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_MACSusp,\r\n{"MAC Suspend", "dect.afield.tail.Qt.Efp.MACSusp", FT_UINT8, BASE_DEC, VALS(Qt_MACSusp_vals),\r\n0x04, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_MACIpq,\r\n{"MAC Ipq", "dect.afield.tail.Qt.Efp.MACIpq", FT_UINT8, BASE_DEC, VALS(Qt_MACIpq_vals),\r\n0x02, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_A23,\r\n{"A23", "dect.afield.tail.Qt.Efp.A23", FT_UINT8, BASE_DEC, VALS(Qt_EA23_vals),\r\n0x01, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_A24,\r\n{"A24", "dect.afield.tail.Qt.Efp.A24", FT_UINT8, BASE_DEC, VALS(Qt_EA24_vals),\r\n0x80, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_A25,\r\n{"A25", "dect.afield.tail.Qt.Efp.A25", FT_UINT8, BASE_DEC, VALS(Qt_EA25_vals),\r\n0x40, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_A26,\r\n{"A26", "dect.afield.tail.Qt.Efp.A26", FT_UINT8, BASE_DEC, VALS(Qt_EA26_vals),\r\n0x20, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_A27,\r\n{"A27", "dect.afield.tail.Qt.Efp.A27", FT_UINT8, BASE_DEC, VALS(Qt_EA27_vals),\r\n0x10, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_A28,\r\n{"A28", "dect.afield.tail.Qt.Efp.A28", FT_UINT8, BASE_DEC, VALS(Qt_EA28_vals),\r\n0x08, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_A29,\r\n{"A29", "dect.afield.tail.Qt.Efp.A29", FT_UINT8, BASE_DEC, VALS(Qt_EA29_vals),\r\n0x04, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_A30,\r\n{"A30", "dect.afield.tail.Qt.Efp.A30", FT_UINT8, BASE_DEC, VALS(Qt_EA30_vals),\r\n0x02, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_A31,\r\n{"A31", "dect.afield.tail.Qt.Efp.A31", FT_UINT8, BASE_DEC, VALS(Qt_EA31_vals),\r\n0x01, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_A32,\r\n{"A32", "dect.afield.tail.Qt.Efp.A32", FT_UINT8, BASE_DEC, VALS(Qt_EA32_vals),\r\n0x80, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_A33,\r\n{"A33", "dect.afield.tail.Qt.Efp.A33", FT_UINT8, BASE_DEC, VALS(Qt_EA33_vals),\r\n0x40, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_A34,\r\n{"A34", "dect.afield.tail.Qt.Efp.A34", FT_UINT8, BASE_DEC, VALS(Qt_EA34_vals),\r\n0x20, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_A35,\r\n{"A35", "dect.afield.tail.Qt.Efp.A35", FT_UINT8, BASE_DEC, VALS(Qt_EA35_vals),\r\n0x10, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_A36,\r\n{"A36", "dect.afield.tail.Qt.Efp.A36", FT_UINT8, BASE_DEC, VALS(Qt_EA36_vals),\r\n0x08, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_A37,\r\n{"A37", "dect.afield.tail.Qt.Efp.A37", FT_UINT8, BASE_DEC, VALS(Qt_EA37_vals),\r\n0x04, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_A38,\r\n{"A38", "dect.afield.tail.Qt.Efp.A38", FT_UINT8, BASE_DEC, VALS(Qt_EA38_vals),\r\n0x02, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_A39,\r\n{"A39", "dect.afield.tail.Qt.Efp.A39", FT_UINT8, BASE_DEC, VALS(Qt_EA39_vals),\r\n0x01, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_A40,\r\n{"A40", "dect.afield.tail.Qt.Efp.A40", FT_UINT8, BASE_DEC, VALS(Qt_EA40_vals),\r\n0x80, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_A41,\r\n{"A41", "dect.afield.tail.Qt.Efp.A41", FT_UINT8, BASE_DEC, VALS(Qt_EA41_vals),\r\n0x40, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_A42,\r\n{"A42", "dect.afield.tail.Qt.Efp.A42", FT_UINT8, BASE_DEC, VALS(Qt_EA42_vals),\r\n0x20, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_A43,\r\n{"A43", "dect.afield.tail.Qt.Efp.A43", FT_UINT8, BASE_DEC, VALS(Qt_EA43_vals),\r\n0x10, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_A44,\r\n{"A44", "dect.afield.tail.Qt.Efp.A44", FT_UINT8, BASE_DEC, VALS(Qt_EA44_vals),\r\n0x08, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_A45,\r\n{"A45", "dect.afield.tail.Qt.Efp.A45", FT_UINT8, BASE_DEC, VALS(Qt_EA45_vals),\r\n0x04, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_A46,\r\n{"A46", "dect.afield.tail.Qt.Efp.A46", FT_UINT8, BASE_DEC, VALS(Qt_EA46_vals),\r\n0x02, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_4_A47,\r\n{"A47", "dect.afield.tail.Qt.Efp.A47", FT_UINT8, BASE_DEC, VALS(Qt_EA47_vals),\r\n0x01, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_6_Spare,\r\n{"Spare Bits", "dect.afield.tail.Qt.Mfn.Spare", FT_UINT16, BASE_HEX, NULL,\r\n0x0FFF, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Qt_6_Mfn,\r\n{"Multiframe Number", "dect.afield.tail.Qt.Mfn.Mfn", FT_BYTES, BASE_NONE, NULL,\r\n0x0, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Mt_Mh,\r\n{"Mh", "dect.afield.tail.Mt.Mh", FT_UINT8, BASE_DEC, VALS(MTHead_vals),\r\n0xF0, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Mt_Mh_attr,\r\n{"Mh", "dect.afield.tail.Mt.Mh.attr", FT_NONE, BASE_NONE, NULL,\r\n0x0, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Mt_Mh_fmid,\r\n{"Mh/FMID", "dect.afield.tail.Mt.Mh.fmid", FT_UINT16, BASE_HEX, NULL,\r\n0xFFF0, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Mt_Mh_pmid,\r\n{"Mh/PMID", "dect.afield.tail.Mt.Mh.pmid", FT_UINT24, BASE_HEX, NULL,\r\n0x0FFFFF, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Mt_BasicConCtrl,\r\n{"Cmd", "dect.afield.tail.Mt.BasicConCtrl", FT_UINT8, BASE_DEC, VALS(MTBasicConCtrl_vals),\r\n0x0F, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Mt_Encr_Cmd1,\r\n{"Cmd1", "dect.afield.tail.Mt.Encr.Cmd1", FT_UINT8, BASE_DEC, VALS(MTEncrCmd1_vals),\r\n0x0C, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Mt_Encr_Cmd2,\r\n{"Cmd2", "dect.afield.tail.Mt.Encr.Cmd2", FT_UINT8, BASE_DEC, VALS(MTEncrCmd2_vals),\r\n0x03, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Pt_ExtFlag,\r\n{"ExtFlag", "dect.afield.tail.Pt.ExtFlag", FT_UINT8, BASE_DEC, VALS(PTExtFlag_vals),\r\n0x80, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Pt_SDU,\r\n{"Bs SDU", "dect.afield.tail.Pt.SDU", FT_UINT8, BASE_DEC, VALS(PTSDU_vals),\r\n0x70, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Pt_RFPI,\r\n{"InfoType", "dect.afield.tail.Pt.RFPI", FT_NONE, BASE_NONE, NULL,\r\n0x0, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Pt_BsData,\r\n{"Bs Data", "dect.afield.tail.Pt.BsData", FT_NONE, BASE_NONE, NULL,\r\n0x0, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Pt_InfoType,\r\n{"InfoType", "dect.afield.tail.Pt.InfoType", FT_UINT8, BASE_DEC, VALS(PTInfoType_vals),\r\n0xF0, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Pt_Fillbits,\r\n{"FillBits", "dect.afield.tail.Pt.FillBits", FT_NONE, BASE_NONE, NULL,\r\n0x0, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Pt_SlotPairs,\r\n{"SlotPairs", "dect.afield.tail.Pt.SlotPairs", FT_NONE, BASE_NONE, NULL,\r\n0x0, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Pt_Bearer_Sn,\r\n{"SN", "dect.afield.tail.Pt.SN", FT_UINT8, BASE_DEC, VALS(QTSlotNumber_vals),\r\n0x0F, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Pt_Bearer_Sp,\r\n{"SP", "dect.afield.tail.Pt.SP", FT_UINT8, BASE_DEC, VALS(QTStartPosition_vals),\r\n0xC0, NULL, HFILL}},\r\n{ &hf_dect_A_Tail_Pt_Bearer_Cn,\r\n{"CN", "dect.afield.tail.Pt.CN", FT_UINT8, BASE_DEC, VALS(QTCarrierNumber_vals),\r\n0x3F, NULL, HFILL}},\r\n{ &hf_dect_A_RCRC,\r\n{"A-Field R-CRC", "dect.afield.rcrc", FT_UINT8, BASE_DEC, NULL,\r\n0x0, NULL, HFILL}},\r\n{ &hf_dect_B,\r\n{"B-Field", "dect.bfield", FT_BYTES, BASE_NONE,\r\n0x0, 0x0, NULL, HFILL}},\r\n{ &hf_dect_B_Data,\r\n{"B-Field", "dect.bfield.data", FT_NONE, BASE_NONE, NULL,\r\n0x0, NULL, HFILL}},\r\n{ &hf_dect_B_DescrambledData,\r\n{"Descrambled Data", "dect.bfield.descrdata", FT_NONE, BASE_NONE,\r\n0x0, 0x0, NULL, HFILL}},\r\n{ &hf_dect_B_fn,\r\n{"B-Field", "dect.bfield.framenumber", FT_NONE, BASE_NONE, NULL,\r\n0x0, NULL, HFILL}},\r\n{ &hf_dect_B_XCRC,\r\n{"B-Field X-CRC", "dect.bfield.xcrc", FT_UINT8, BASE_DEC, NULL,\r\n0x0, NULL, HFILL}}\r\n};\r\nstatic gint *ett[]=\r\n{\r\n&ett_dect,\r\n&ett_columns,\r\n&ett_ahead,\r\n&ett_afield,\r\n&ett_atail,\r\n&ett_aqt,\r\n&ett_bfield,\r\n&ett_bfdescrdata\r\n};\r\nproto_dect=proto_register_protocol("DECT Protocol", "DECT", "dect");\r\nproto_register_field_array(proto_dect, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid\r\nproto_reg_handoff_dect(void)\r\n{\r\ndissector_handle_t dect_handle;\r\ndect_handle = create_dissector_handle(dissect_dect, proto_dect);\r\ndissector_add_uint("ethertype", ETHERTYPE_DECT , dect_handle);\r\n}
