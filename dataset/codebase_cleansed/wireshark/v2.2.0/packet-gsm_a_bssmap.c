static guint16\r\nbe_cic(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string, int string_len)\r\n{\r\nguint32 curr_offset;\r\nguint32 value;\r\ncurr_offset = offset;\r\nvalue = tvb_get_ntohs(tvb, curr_offset);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_pcm_multiplexer, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_timeslot, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\ncurr_offset += 2;\r\nif (add_string)\r\ng_snprintf(add_string, string_len, " - (%u) (0x%04x)", value, value);\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_res_avail(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\nguint16 value;\r\nint i;\r\nproto_item* ti;\r\ncurr_offset = offset;\r\nfor (i=0; i < 5; i++) {\r\nvalue = tvb_get_ntohl(tvb, curr_offset);\r\nti = proto_tree_add_uint_format(tree, hf_gsm_a_bssmap_full_rate_channels_available, tvb, curr_offset, 2, value, "Number of full rate channels available in band %u %u",i+1,value);\r\nproto_item_set_len(ti, len);\r\ncurr_offset+=2;\r\nti = proto_tree_add_uint_format(tree, hf_gsm_a_bssmap_half_rate_channels_available, tvb, curr_offset, 2, value, "Number of half rate channels available in band %u %u",i+1, value);\r\nproto_item_set_len(ti, len);\r\ncurr_offset+=2;\r\n}\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_cause(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len, gchar *add_string, int string_len)\r\n{\r\nguint8 oct;\r\nguint32 curr_offset;\r\nconst gchar *str = NULL;\r\ncurr_offset = offset;\r\noct = tvb_get_guint8(tvb, curr_offset);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_cause_extension, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nif (oct & 0x80)\r\n{\r\nif ((oct & 0x0f) == 0x00)\r\n{\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_cause_class, tvb, curr_offset, 1, ENC_NA);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_national_cause, tvb, curr_offset, 1, ENC_NA);\r\ncurr_offset++;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_cause_value, tvb, curr_offset, 1, ENC_NA);\r\ncurr_offset++;\r\nif (add_string)\r\ng_snprintf(add_string, string_len, " - (National Cause)");\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_cause16, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\ncurr_offset+=2;\r\n}\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_cause,\r\ntvb, curr_offset, 1, ENC_NA);\r\ncurr_offset++;\r\nif (add_string)\r\ng_snprintf(add_string, string_len, " - (%u) %s", oct & 0x7f, str);\r\n}\r\nEXTRANEOUS_DATA_CHECK(len, curr_offset - offset, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_tmsi(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len, gchar *add_string, int string_len)\r\n{\r\nguint32 curr_offset;\r\nguint32 value;\r\ncurr_offset = offset;\r\nvalue = tvb_get_ntohl(tvb, curr_offset);\r\nproto_tree_add_uint(tree, hf_gsm_a_tmsi,\r\ntvb, curr_offset, 4,\r\nvalue);\r\nif (add_string)\r\ng_snprintf(add_string, string_len, " - (0x%04x)", value);\r\ncurr_offset += 4;\r\nEXTRANEOUS_DATA_CHECK(len, curr_offset - offset, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_num_ms(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_num_ms, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nEXTRANEOUS_DATA_CHECK(len, curr_offset - offset, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_l3_header_info(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset = offset;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, curr_offset<<3, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_L3_protocol_discriminator, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nNO_MORE_DATA_CHECK(len);\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, curr_offset<<3, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_ti_flag, tvb, curr_offset, 1, ENC_NA);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_tio, tvb, curr_offset, 1, ENC_NA);\r\ncurr_offset++;\r\nEXTRANEOUS_DATA_CHECK(len, curr_offset - offset, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_enc_info(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset = offset;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_gsm_a5_7, tvb, curr_offset, 1, ENC_NA);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_gsm_a5_6, tvb, curr_offset, 1, ENC_NA);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_gsm_a5_5, tvb, curr_offset, 1, ENC_NA);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_gsm_a5_4, tvb, curr_offset, 1, ENC_NA);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_gsm_a5_3, tvb, curr_offset, 1, ENC_NA);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_gsm_a5_2, tvb, curr_offset, 1, ENC_NA);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_gsm_a5_1, tvb, curr_offset, 1, ENC_NA);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_no_encryption, tvb, curr_offset, 1, ENC_NA);\r\ncurr_offset++;\r\nNO_MORE_DATA_CHECK(len);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_enc_info_key, tvb, curr_offset, len - (curr_offset - offset), ENC_NA);\r\ncurr_offset += len - (curr_offset - offset);\r\nEXTRANEOUS_DATA_CHECK(len, curr_offset - offset, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\nreturn(curr_offset - offset);\r\n}\r\nguint16\r\nbe_chan_type(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len, gchar *add_string, int string_len)\r\n{\r\nguint8 oct;\r\nguint8 sdi;\r\nguint8 num_chan;\r\nguint32 curr_offset = offset;\r\nconst gchar *str;\r\noct = tvb_get_guint8(tvb, curr_offset);\r\nsdi = oct & 0x0f;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, curr_offset<<3, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_speech_data_ind, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nif (add_string)\r\ng_snprintf(add_string, string_len, " - (%s)", val_to_str_const(tvb_get_guint8(tvb, curr_offset) & 0x0f,\r\ngsm_a_bssap_speech_data_ind_vals,\r\n"Unknown"));\r\ncurr_offset++;\r\nNO_MORE_DATA_CHECK(len);\r\noct = tvb_get_guint8(tvb, curr_offset);\r\nif ((sdi == 0x01)||(sdi == 0x04))\r\n{\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_channel_rate_and_type, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nNO_MORE_DATA_CHECK(len);\r\ndo\r\n{\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_chan_type_extension, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_perm_speech_v_ind, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\n}\r\nwhile ((len - (curr_offset - offset)) > 0);\r\n}\r\nelse if (sdi == 0x02)\r\n{\r\nnum_chan = 0;\r\nif ((oct >= 0x20) && (oct <= 0x27))\r\n{\r\nnum_chan = (oct - 0x20) + 1;\r\n}\r\nelse if ((oct >= 0x30) && (oct <= 0x37))\r\n{\r\nnum_chan = (oct - 0x30) + 1;\r\n}\r\nif (num_chan > 0)\r\n{\r\nproto_tree_add_uint_format_value(tree, hf_gsm_a_bssmap_data_channel_rate_and_type,\r\ntvb, curr_offset, 1, oct, "Max channels %u, %s",\r\nnum_chan, rval_to_str_const(oct, gsm_a_bssap_channel_rate_and_type_rvals, "Reserved"));\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_data_channel_rate_and_type,\r\ntvb, curr_offset, 1, ENC_NA);\r\n}\r\ncurr_offset++;\r\nNO_MORE_DATA_CHECK(len);\r\noct = tvb_get_guint8(tvb, curr_offset);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_chan_type_extension, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_transparent_service, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nif (num_chan == 0)\r\n{\r\nif (oct & 0x40)\r\n{\r\nswitch (oct & 0x3f)\r\n{\r\ncase 0x00: str = "12 kbit/s if the channel is a full rate TCH, or 6 kbit/s if the channel is a half rate TCH"; break;\r\ncase 0x18: str = "14.5 kbit/s"; break;\r\ncase 0x10: str = "12 kbits/s"; break;\r\ncase 0x11: str = "6 kbits/s"; break;\r\ncase 0x31: str = "29 kbit/s"; break;\r\ncase 0x34: str = "43,5 kbit/s"; break;\r\ndefault:\r\nstr = "Reserved";\r\nbreak;\r\n}\r\n}\r\nelse\r\n{\r\nswitch (oct & 0x3f)\r\n{\r\ncase 0x18: str = "14.4 kbit/s"; break;\r\ncase 0x10: str = "9.6kbit/s"; break;\r\ncase 0x11: str = "4.8kbit/s"; break;\r\ncase 0x12: str = "2.4kbit/s"; break;\r\ncase 0x13: str = "1.2Kbit/s"; break;\r\ncase 0x14: str = "600 bit/s"; break;\r\ncase 0x15: str = "1200/75 bit/s (1200 network-to-MS / 75 MS-to-network)"; break;\r\ncase 0x39: str = "28,8 kbit/s"; break;\r\ncase 0x3a: str = "32,0 kbit/s"; break;\r\ndefault:\r\nstr = "Reserved";\r\nbreak;\r\n}\r\n}\r\n}\r\nelse\r\n{\r\nif (oct & 0x40)\r\n{\r\nswitch (oct & 0x3f)\r\n{\r\ncase 0x16: str = "58 kbit/s (4x14.5 kbit/s)"; break;\r\ncase 0x14: str = "48.0 / 43.5 kbit/s (4x12 kbit/s or 3x14.5 kbit/s)"; break;\r\ncase 0x13: str = "36.0 / 29.0 kbit/s (3x12 kbit/s or 2x14.5 kbit/s)"; break;\r\ncase 0x12: str = "24.0 / 24.0 (4x6 kbit/s or 2x12 kbit/s)"; break;\r\ncase 0x11: str = "18.0 / 14.5 kbit/s (3x6 kbit/s or 1x14.5 kbit/s)"; break;\r\ncase 0x10: str = "12.0 / 12.0 kbit/s (2x6 kbit/s or 1x12 kbit/s)"; break;\r\ndefault:\r\nstr = "Reserved";\r\nbreak;\r\n}\r\n}\r\nelse\r\n{\r\nswitch (oct & 0x3f)\r\n{\r\ncase 0x1f: str = "64 kbit/s, bit transparent"; break;\r\ncase 0x1e: str = "56 kbit/s, bit transparent"; break;\r\ncase 0x1d: str = "56 kbit/s"; break;\r\ncase 0x1c: str = "48 kbit/s"; break;\r\ncase 0x1b: str = "38.4 kbit/s"; break;\r\ncase 0x1a: str = "28.8 kbit/s"; break;\r\ncase 0x19: str = "19.2 kbit/s"; break;\r\ncase 0x18: str = "14.4 kbit/s"; break;\r\ncase 0x10: str = "9.6 kbit/s"; break;\r\ndefault:\r\nstr = "Reserved";\r\nbreak;\r\n}\r\n}\r\n}\r\nproto_tree_add_uint_format_value(tree, hf_gsm_a_bssmap_rate,\r\ntvb, curr_offset, 1, oct & 0x3f, "%s", str);\r\ncurr_offset++;\r\nNO_MORE_DATA_CHECK(len);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_chan_type_extension, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, (curr_offset<<3)+1, 3, ENC_BIG_ENDIAN);\r\nif (num_chan == 0)\r\n{\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_tch_14_5kb, tvb, curr_offset, 1, ENC_NA);\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, (curr_offset<<3)+6, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_tch_12kb, tvb, curr_offset, 1, ENC_NA);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_tch_6kb, tvb, curr_offset, 1, ENC_NA);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_tch_14_5_14_4kb, tvb, curr_offset, 1, ENC_NA);\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, (curr_offset<<3)+6, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_tch_12_9kb, tvb, curr_offset, 1, ENC_NA);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_tch_6_4_8kb, tvb, curr_offset, 1, ENC_NA);\r\n}\r\ncurr_offset++;\r\n}\r\nelse if (sdi == 0x03)\r\n{\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_data_channel_rate_and_type,\r\ntvb, curr_offset, 1, ENC_NA);\r\ncurr_offset++;\r\nNO_MORE_DATA_CHECK(len);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_spare, tvb, curr_offset, len - (curr_offset - offset), ENC_NA);\r\ncurr_offset += len - (curr_offset - offset);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_unknown_format, tvb, curr_offset, len - (curr_offset - offset), ENC_NA);\r\ncurr_offset += len - (curr_offset - offset);\r\n}\r\nEXTRANEOUS_DATA_CHECK(len, curr_offset - offset, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_periodicity(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_periodicity, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_ext_res_ind(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, curr_offset<<3, 6, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_sm, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_tarr, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_tot_res_acc(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_tot_no_of_fullr_ch, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\ncurr_offset+=2;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_tot_no_of_hr_ch, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_lsa_id(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_lsa_id, tvb, curr_offset, 3, ENC_BIG_ENDIAN);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_lsa_id_list(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, curr_offset<<3, 7, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_ep, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nwhile (curr_offset-offset < len) {\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_lsa_id, tvb, curr_offset, 3, ENC_BIG_ENDIAN);\r\ncurr_offset+=3;\r\n}\r\nreturn(len);\r\n}\r\nguint16\r\nbe_cell_id_aux(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string, int string_len, guint8 disc)\r\n{\r\nguint32 value;\r\nguint32 curr_offset;\r\nif (add_string)\r\nadd_string[0] = '\0';\r\ncurr_offset = offset;\r\nswitch (disc)\r\n{\r\ncase 0x00:\r\ncase 0x04:\r\ncase 0x08:\r\ncase 0xb:\r\ncase 0x0c:\r\nif (disc != 0x0b)\r\ncurr_offset = dissect_e212_mcc_mnc(tvb, pinfo, tree, curr_offset, E212_NONE, TRUE);\r\nelse\r\ncurr_offset = dissect_e212_mcc_mnc(tvb, pinfo, tree, curr_offset, E212_NONE, FALSE);\r\ncase 0x01:\r\ncase 0x05:\r\ncase 0x0a:\r\nvalue = tvb_get_ntohs(tvb, curr_offset);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_cell_lac, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\ncurr_offset += 2;\r\nif (add_string)\r\ng_snprintf(add_string, string_len, " - LAC (0x%04x)", value);\r\nif (disc == 0x0b) {\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_sac, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\ncurr_offset += 2;\r\nbreak;\r\n}\r\ncase 0x09:\r\nif ((disc == 0x08) ||(disc == 0x09) || (disc == 0x0a)|| (disc == 0x0c)) {\r\nvalue = tvb_get_ntohs(tvb, curr_offset);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_be_rnc_id, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\ncurr_offset += 2;\r\nif (add_string)\r\n{\r\nif (add_string[0] == '\0')\r\n{\r\ng_snprintf(add_string, string_len, " - RNC-ID (%u)", value);\r\n}\r\nelse\r\n{\r\ng_snprintf(add_string, string_len, "%s/RNC-ID (%u)", add_string, value);\r\n}\r\n}\r\nbreak;\r\n}\r\nif ((disc == 0x04) || (disc == 0x05) || (disc == 0x08)) break;\r\ncase 0x02:\r\nvalue = tvb_get_ntohs(tvb, curr_offset);\r\nproto_tree_add_uint(tree, hf_gsm_a_bssmap_cell_ci, tvb,\r\ncurr_offset, 2, value);\r\ncurr_offset += 2;\r\nif (add_string)\r\n{\r\nif (add_string[0] == '\0')\r\n{\r\ng_snprintf(add_string, string_len, " - CI (%u)", value);\r\n}\r\nelse\r\n{\r\ng_snprintf(add_string, string_len, "%s/CI (%u)", add_string, value);\r\n}\r\n}\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_cell_id_unknown_format, tvb, curr_offset, len, ENC_NA);\r\ncurr_offset += (len);\r\nbreak;\r\n}\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_cell_id(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string, int string_len)\r\n{\r\nguint8 oct;\r\nguint8 disc;\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\noct = tvb_get_guint8(tvb, curr_offset);\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, curr_offset<<3, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_be_cell_id_disc, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ndisc = oct&0x0f;\r\ncell_discriminator = disc;\r\ncurr_offset++;\r\nNO_MORE_DATA_CHECK(len);\r\ncurr_offset +=\r\nbe_cell_id_aux(tvb, tree, pinfo, curr_offset, len - (curr_offset - offset), add_string, string_len, disc);\r\nreturn(curr_offset - offset);\r\n}\r\nguint16\r\nbe_prio(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string, int string_len)\r\n{\r\nguint8 oct;\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\noct = tvb_get_guint8(tvb, curr_offset);\r\nproto_tree_add_item(tree, hf_gsm_a_b8spare, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_pci, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_priority_level, tvb, curr_offset, 1, ENC_NA);\r\nif (add_string)\r\ng_snprintf(add_string, string_len, " - (%u)", (oct & 0x3c) >> 2);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_qa, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_pvi, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_int_band(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, curr_offset<<3, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_interference_bands, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_lsa_info(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, curr_offset<<3, 7, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_lsa_only, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nwhile (curr_offset-offset < len) {\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, curr_offset<<3, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_act, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_pref, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_lsa_inf_prio, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_lsa_id, tvb, curr_offset, 3, ENC_BIG_ENDIAN);\r\ncurr_offset+=3;\r\n}\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_l3_info(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ntvbuff_t *l3_tvb;\r\nproto_item* ti;\r\ncurr_offset = offset;\r\nproto_tree_add_bytes_format(tree, hf_gsm_a_bssmap_layer_3_information_value, tvb, curr_offset, len, NULL,\r\n"Layer 3 Information value");\r\nl3_tvb = tvb_new_subset_length(tvb, curr_offset, len);\r\nif ( cell_discriminator == 0xFF)\r\n{\r\nti = proto_tree_add_uint_format(tree, hf_gsm_a_bssmap_cell_discriminator, l3_tvb, curr_offset, 1, cell_discriminator,\r\n"Cell Discriminator not initialised, try enabling the SCCP protocol option [Trace Associations], \n or maybe the file does not contain the PDUs needed for SCCP trace");\r\nproto_item_set_len(ti, len);\r\n}\r\nelse if ((cell_discriminator & 0x0f) < 8) {\r\nti = proto_tree_add_uint(tree, hf_gsm_a_bssmap_cell_discriminator, l3_tvb, curr_offset, 1, cell_discriminator);\r\nPROTO_ITEM_SET_HIDDEN(ti);\r\ncall_dissector(dtap_handle, l3_tvb, pinfo, g_tree);\r\n}\r\nelse if ((cell_discriminator & 0x0f) < 13) {\r\nti = proto_tree_add_uint(tree, hf_gsm_a_bssmap_cell_discriminator, l3_tvb, curr_offset, 1, cell_discriminator);\r\nPROTO_ITEM_SET_HIDDEN(ti);\r\ndissect_rrc_HandoverToUTRANCommand_PDU(l3_tvb, pinfo, g_tree, NULL);\r\n}\r\nelse{\r\nti = proto_tree_add_uint_format(tree, hf_gsm_a_bssmap_cell_discriminator, l3_tvb, curr_offset, 1, cell_discriminator,\r\n"Unrecognised Cell Discriminator %x",cell_discriminator);\r\nproto_item_set_len(ti, len);\r\n}\r\ncurr_offset += len;\r\nEXTRANEOUS_DATA_CHECK(len, curr_offset - offset, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_dlci(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint8 oct;\r\nguint32 curr_offset;\r\nproto_tree *subtree;\r\ncurr_offset = offset;\r\nsubtree =\r\nproto_tree_add_subtree(tree, tvb, curr_offset, 1,\r\nett_dlci, NULL, "Data Link Connection Identifier");\r\noct = tvb_get_guint8(tvb, curr_offset);\r\nproto_tree_add_uint(subtree, hf_gsm_a_bssmap_dlci_cc, tvb, curr_offset, 1, oct);\r\nproto_tree_add_uint(subtree, hf_gsm_a_bssmap_dlci_spare, tvb, curr_offset, 1, oct);\r\nproto_tree_add_uint(subtree, hf_gsm_a_bssmap_dlci_sapi, tvb, curr_offset, 1, oct);\r\ncurr_offset++;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_down_dtx_flag(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset = offset;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, curr_offset<<3, 7, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_bss_activate_downlink, tvb, curr_offset, 1, ENC_NA);\r\ncurr_offset++;\r\nreturn(curr_offset - offset);\r\n}\r\nguint16\r\nbe_cell_id_list(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string, int string_len)\r\n{\r\nguint8 oct;\r\nguint16 consumed;\r\nguint8 disc;\r\nguint8 num_cells;\r\nguint32 curr_offset;\r\nproto_item *item = NULL;\r\nproto_tree *subtree = NULL;\r\ncurr_offset = offset;\r\noct = tvb_get_guint8(tvb, curr_offset);\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, curr_offset<<3, 4, ENC_BIG_ENDIAN);\r\ndisc = oct & 0x0f;\r\ncell_discriminator = disc;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_be_cell_id_disc, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nNO_MORE_DATA_CHECK(len);\r\nnum_cells = 0;\r\ndo\r\n{\r\nsubtree =\r\nproto_tree_add_subtree_format(tree,\r\ntvb, curr_offset, -1,\r\nett_cell_list, &item, "Cell %u",\r\nnum_cells + 1);\r\nif (add_string)\r\nadd_string[0] = '\0';\r\nconsumed =\r\nbe_cell_id_aux(tvb, subtree, pinfo, curr_offset, len - (curr_offset - offset), add_string, string_len, disc);\r\nif (add_string && add_string[0] != '\0')\r\nproto_item_append_text(item, "%s", add_string);\r\nproto_item_set_len(item, consumed);\r\ncurr_offset += consumed;\r\nnum_cells++;\r\n}\r\nwhile ((len - (curr_offset - offset)) > 0 && consumed > 0);\r\nif (add_string) {\r\ng_snprintf(add_string, string_len, " - %u cell%s",\r\nnum_cells, plurality(num_cells, "", "s"));\r\n}\r\nEXTRANEOUS_DATA_CHECK(len, curr_offset - offset, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_cell_id_list_seg(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_seq_len, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_seq_no, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, curr_offset<<3, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssap_cell_id_list_seg_cell_id_disc, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nproto_tree_add_expert(tree, pinfo, &ei_gsm_a_bssmap_not_decoded_yet, tvb, curr_offset, len-2);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_cell_id_lst_seg_f_est_cells(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, curr_offset<<3, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssap_cell_id_list_seg_cell_id_disc, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nproto_tree_add_expert(tree, pinfo, &ei_gsm_a_bssmap_not_decoded_yet, tvb, curr_offset, len-1);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_cell_id_lst_seg_f_cell_tb_est(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, curr_offset<<3, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssap_cell_id_list_seg_cell_id_disc, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nproto_tree_add_expert(tree, pinfo, &ei_gsm_a_bssmap_not_decoded_yet, tvb, curr_offset, len-1);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_cell_id_lst_seg_f_rel_cell(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, curr_offset<<3, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssap_cell_id_list_seg_cell_id_disc, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nproto_tree_add_expert(tree, pinfo, &ei_gsm_a_bssmap_not_decoded_yet, tvb, curr_offset, len-1);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_cell_id_lst_seg_f_not_est_cell(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, curr_offset<<3, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssap_cell_id_list_seg_cell_id_disc, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nproto_tree_add_expert(tree, pinfo, &ei_gsm_a_bssmap_not_decoded_yet, tvb, curr_offset, len-1);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_res_ind_method(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, curr_offset<<3, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssap_res_ind_method, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_cic_list(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_gsm_a_bssap_cic_list_range, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssap_cic_list_status, tvb, (curr_offset+1), (len-1), ENC_NA);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_diag(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len , gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_gsm_a_bssap_diag_error_pointer, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\ncurr_offset += 2;\r\nNO_MORE_DATA_CHECK(len);\r\nproto_tree_add_item(tree, hf_gsm_a_bssap_diag_msg_rcv, tvb, curr_offset, (len-2), ENC_NA);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_chosen_chan(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_ch_mode, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_channel, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_ciph_resp_mode(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset = offset;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, curr_offset<<3, 7, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_imeisv_included, tvb, curr_offset, 1, ENC_NA);\r\ncurr_offset++;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_l3_msg(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\ntvbuff_t *l3_tvb;\r\nguint16 word;\r\nproto_tree_add_bytes_format(tree, hf_gsm_a_bssmap_layer3_message_contents, tvb, offset, len, NULL,\r\n"Layer 3 Message Contents");\r\nl3_tvb = tvb_new_subset_length(tvb, offset, len);\r\nword = tvb_get_ntohs(tvb, offset);\r\nif(word==0x1709){\r\nde_mid(l3_tvb, tree, pinfo, 2, 9, NULL, 0);\r\nreturn(len);\r\n}\r\ncall_dissector(dtap_handle, l3_tvb, pinfo, g_tree);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_cha_needed(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_rr_chnl_needed_ch1, tvb, (curr_offset<<3)+6, 2, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_trace_type(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ngint bit_offset;\r\nbit_offset = (offset<<3);\r\ncurr_offset = offset;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_trace_priority_indication, tvb, bit_offset, 1, ENC_BIG_ENDIAN);\r\nbit_offset ++;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, bit_offset, 1, ENC_BIG_ENDIAN);\r\nbit_offset ++;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_trace_bss_record_type, tvb, bit_offset, 2, ENC_BIG_ENDIAN);\r\nbit_offset += 2;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_trace_msc_record_type, tvb, bit_offset, 2, ENC_BIG_ENDIAN);\r\nbit_offset += 2;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_trace_invoking_event, tvb, bit_offset, 2, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_trace_trigger_id(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_trace_trigger_id, tvb, curr_offset, len, ENC_ASCII|ENC_NA);\r\ncurr_offset += len;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_trace_reference(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_trace_reference, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\ncurr_offset +=2;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_trace_transaction_id(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nif (len == 1)\r\n{\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_trace_reference, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset ++;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_trace_reference, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\ncurr_offset +=2;\r\n}\r\nEXTRANEOUS_DATA_CHECK(len, curr_offset - offset, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_trace_omc_id(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_trace_omc_id, tvb, curr_offset, len, ENC_ASCII|ENC_NA);\r\ncurr_offset += len;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_for_ind(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset = offset;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, curr_offset<<3, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_forward_indicator, tvb, curr_offset, 1, ENC_NA);\r\ncurr_offset++;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_chosen_enc_alg(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string, int string_len)\r\n{\r\nguint8 oct;\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\noct = tvb_get_guint8(tvb, curr_offset);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_algorithm_identifier, tvb, curr_offset, 1, ENC_NA);\r\ncurr_offset++;\r\nif (add_string)\r\ng_snprintf(add_string, string_len, " - %s", val_to_str_const(oct, gsm_a_bssmap_algorithm_id_vals, "Unknown"));\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_cct_pool(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string, int string_len)\r\n{\r\nguint8 oct;\r\nguint32 curr_offset;\r\nproto_item* ti;\r\ncurr_offset = offset;\r\noct = tvb_get_guint8(tvb, curr_offset);\r\nti = proto_tree_add_item(tree, hf_gsm_a_bssmap_circuit_pool_number, tvb, curr_offset, 1, ENC_NA);\r\nif (oct <= 50)\r\n{\r\n}\r\nelse if ((oct >= 0x80) && (oct <= 0x8f))\r\n{\r\nproto_item_append_text(ti, ", for national/local use");\r\n}\r\nelse\r\n{\r\nproto_item_append_text(ti, ", reserved for future international use");\r\n}\r\ncurr_offset++;\r\nif (add_string)\r\ng_snprintf(add_string, string_len, " - (%u)", oct);\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_curr_chan_1(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_cur_ch_mode, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_channel, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_que_ind(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset = offset;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, curr_offset<<3, 6, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_qri, tvb, curr_offset, 1, ENC_NA);\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, (curr_offset<<3)+7, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_speech_ver(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string, int string_len)\r\n{\r\nguint8 oct;\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\noct = tvb_get_guint8(tvb, curr_offset);\r\nproto_tree_add_item(tree, hf_gsm_a_b8spare, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_speech_version_id, tvb, curr_offset, 1, ENC_NA);\r\ncurr_offset++;\r\nif (add_string)\r\ng_snprintf(add_string, string_len, " - (%s)", rval_to_str_const(oct & 0x7f, speech_version_id_short_rvals, "Reserved"));\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_ass_req(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_ass_req, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nreturn 1;\r\n}\r\nguint16\r\nbe_emlpp_prio(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, offset << 3, 5, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_emlpp_prio, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nreturn 1;\r\n}\r\nstatic guint16\r\nbe_conf_evo_ind(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, curr_offset<<3, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_smi, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset - offset);\r\n}\r\nvoid\r\nbssmap_old_bss_to_new_bss_info(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo)\r\n{\r\nguint16 len;\r\nif (!tree) {\r\nreturn;\r\n}\r\ng_tree = tree;\r\nlen = tvb_reported_length(tvb);\r\nbe_field_element_dissect(tvb, tree, pinfo, 0, len, NULL, 0);\r\ng_tree = NULL;\r\n}\r\nstatic guint16\r\nbe_lcs_prio(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_lcs_pri, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_loc_type(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\nguint8 location_information;\r\ncurr_offset = offset;\r\nlocation_information = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_location_type_location_information, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nif (location_information == 1 || location_information == 2)\r\n{\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_location_type_positioning_method, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\n}\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_loc_est(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\ntvbuff_t *data_tvb;\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\ndata_tvb = tvb_new_subset_length(tvb, curr_offset, len);\r\ndissect_geographical_description(data_tvb, pinfo, tree);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_pos_data(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\nguint8 i;\r\nguint64 pos_data_disc;\r\ngint bit_offset;\r\ncurr_offset = offset;\r\nbit_offset = (offset<<3);\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare, tvb, bit_offset, 4, ENC_BIG_ENDIAN);\r\nbit_offset += 4;\r\nproto_tree_add_bits_ret_val(tree, hf_gsm_a_bssmap_positioning_data_discriminator, tvb, bit_offset, 4, &pos_data_disc, ENC_BIG_ENDIAN);\r\nbit_offset += 4;\r\ncurr_offset++;\r\nif (pos_data_disc == 0)\r\n{\r\nfor (i = 0; i < len-1; i++)\r\n{\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_positioning_method, tvb, bit_offset, 5, ENC_BIG_ENDIAN);\r\nbit_offset += 5;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_positioning_method_usage, tvb, bit_offset, 3, ENC_BIG_ENDIAN);\r\nbit_offset += 3;\r\ncurr_offset++;\r\n}\r\n}\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_apdu(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\nguint8 apdu_protocol_id;\r\ntvbuff_t *APDU_tvb;\r\ncurr_offset = offset;\r\nproto_tree_add_bytes_format(tree, hf_gsm_a_bssmap_apdu, tvb, curr_offset, len, NULL, "APDU");\r\napdu_protocol_id = tvb_get_guint8(tvb,curr_offset);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_apdu_protocol_id, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nlen--;\r\nswitch (apdu_protocol_id) {\r\ncase 1:\r\nAPDU_tvb = tvb_new_subset_length(tvb, curr_offset, len);\r\nif (gsm_bsslap_handle)\r\ncall_dissector(gsm_bsslap_handle, APDU_tvb, pinfo, g_tree);\r\nbreak;\r\ncase 2:\r\nbreak;\r\ncase 3:\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\ncurr_offset += len;\r\nEXTRANEOUS_DATA_CHECK(len, curr_offset - offset, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_gps_assist_data(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_expert(tree, pinfo, &ei_gsm_a_bssmap_not_decoded_yet, tvb, curr_offset, len);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_ret_err_req(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_expert(tree, pinfo, &ei_gsm_a_bssmap_not_decoded_yet, tvb, curr_offset, len);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_ret_err_cause(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_expert(tree, pinfo, &ei_gsm_a_bssmap_not_decoded_yet, tvb, curr_offset, len);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_seg(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_expert(tree, pinfo, &ei_gsm_a_bssmap_not_decoded_yet, tvb, curr_offset, len);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_serv_ho(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, curr_offset<<3, 5, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_serv_ho_inf, tvb, curr_offset+1, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_src_rnc_to_tar_rnc_umts(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\ntvbuff_t *container_tvb;\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\ncontainer_tvb = tvb_new_subset_length(tvb, curr_offset, len);\r\ndissect_ranap_SourceRNC_ToTargetRNC_TransparentContainer_PDU(container_tvb, pinfo, tree, NULL);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_src_rnc_to_tar_rnc_cdma(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_expert(tree, pinfo, &ei_gsm_a_bssmap_not_decoded_yet, tvb, curr_offset, len);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_geran_cls_m(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nif (len > 2) {\r\nde_sup_codec_list(tvb, tree, pinfo, curr_offset, (len-2), NULL, 0);\r\n}\r\ncurr_offset += len-2;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, curr_offset<<3, 5, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_max_nb_traffic_chan, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, curr_offset<<3, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_acceptable_chan_coding_bit5, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_acceptable_chan_coding_bit4, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_acceptable_chan_coding_bit3, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_acceptable_chan_coding_bit2, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_acceptable_chan_coding_bit1, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_geran_bsc_cont(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_gsm_a_bssap_speech_codec, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nNO_MORE_DATA_CHECK(len);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_allowed_data_rate_bit8, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_allowed_data_rate_bit7, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_allowed_data_rate_bit6, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_allowed_data_rate_bit5, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_allowed_data_rate_bit4, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_max_nb_traffic_chan, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nreturn(len);\r\n}\r\nvoid\r\nbssmap_new_bss_to_old_bss_info(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo)\r\n{\r\nguint16 len;\r\nif (!tree) {\r\nreturn;\r\n}\r\ng_tree = tree;\r\nlen = tvb_reported_length(tvb);\r\nbe_field_element_dissect(tvb, tree, pinfo, 0, len, NULL, 0);\r\ng_tree = NULL;\r\n}\r\nstatic guint16\r\nbe_inter_sys_inf(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\ntvbuff_t *new_tvb;\r\nnew_tvb = tvb_new_subset_length(tvb, offset, len);\r\nif (new_tvb) {\r\ndissect_ranap_InterSystemInformation_TransparentContainer_PDU(new_tvb, pinfo, tree, NULL);\r\n}\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_sna_acc_inf(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_expert(tree, pinfo, &ei_gsm_a_bssmap_not_decoded_yet, tvb, curr_offset, len);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_vstk_rand_info(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\nguint64 vstk_rand;\r\ncurr_offset = offset;\r\nvstk_rand = tvb_get_ntoh40(tvb, curr_offset);\r\nvstk_rand >>= 4;\r\nproto_tree_add_uint64(tree, hf_gsm_a_bssmap_vstk_rand, tvb, curr_offset, 5, vstk_rand);\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, (((curr_offset+4)<<3)+4), 4, ENC_BIG_ENDIAN);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_vstk_info(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_vstk, tvb, offset, 16, ENC_NA);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_paging_inf(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, curr_offset<<3, 5, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_paging_cause, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_paging_inf_flg, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nbe_vel_est(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string, int string_len)\r\n{\r\ndissect_description_of_velocity(tvb, tree, pinfo, offset, len, add_string, string_len);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_vgcs_feat_flg(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, curr_offset<<3, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_tcp, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_bss_res, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_asind_b3, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_asind_b2, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_tpind, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nstatic guint16\r\nbe_talker_pri(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_talker_pri, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nEXTRANEOUS_DATA_CHECK(len, curr_offset - offset, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_talker_id(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, curr_offset<<3, 5, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_filler_bits, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_talker_identity_field, tvb, curr_offset, len-1, ENC_NA);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_sms_to_vgcs(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nrp_data_n_ms(tvb, tree, pinfo, offset, len);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_vgcs_talker_mode(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_rr_mode, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_group_cipher_key_nb, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, ((curr_offset<<3)+6), 2, ENC_BIG_ENDIAN);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_vgcs_vbs_cell_status(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, (curr_offset<<3), 5, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_vgcs_vbs_cell_status, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nreturn(len);\r\n}\r\nguint16\r\nbe_ganss_ass_dta(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_expert(tree, pinfo, &ei_gsm_a_bssmap_not_decoded_yet, tvb, curr_offset, len);\r\nreturn(len);\r\n}\r\nguint16\r\nbe_ganss_pos_dta(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_method, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_ganss_id, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_usage, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset-offset);\r\n}\r\nguint16\r\nbe_ganss_loc_type(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_expert(tree, pinfo, &ei_gsm_a_bssmap_not_decoded_yet, tvb, curr_offset, len);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_app_data(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_expert(tree, pinfo, &ei_gsm_a_bssmap_not_decoded_yet, tvb, curr_offset, len);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_app_data_id(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_data_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_app_data_inf(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, (curr_offset<<3), 7, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_bt_ind, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_msisdn(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\ntvbuff_t *new_tvb;\r\nnew_tvb = tvb_new_subset_length(tvb, offset, len);\r\nif (new_tvb) {\r\ndissect_gsm_map_msisdn(new_tvb, pinfo , tree);\r\n}\r\nreturn len;\r\n}\r\nstatic guint16\r\nbe_aoip_trans_lay_add(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\nguint8 addr_type;\r\nguint32 rtp_ipv4_address;\r\nguint16 rtp_port;\r\naddress rtp_dst_addr;\r\nstruct e_in6_addr rtp_addr_ipv6;\r\ncurr_offset = offset;\r\nswitch (len) {\r\ncase 6:\r\naddr_type = 1;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_aoip_trans_ipv4, tvb, curr_offset, 4, ENC_BIG_ENDIAN);\r\nrtp_ipv4_address = tvb_get_ipv4(tvb, curr_offset);\r\ncurr_offset+=4;\r\nbreak;\r\ncase 18:\r\naddr_type = 2;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_aoip_trans_ipv6, tvb, curr_offset, 16, ENC_NA);\r\ntvb_get_ipv6(tvb, offset + 5, &rtp_addr_ipv6);\r\ncurr_offset+=16;\r\nbreak;\r\ndefault:\r\nproto_tree_add_expert_format(tree, pinfo, &ei_gsm_a_bssmap_bogus_length, tvb, curr_offset, len, "Bogus length %u",len);\r\nreturn(len);\r\n}\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_aoip_trans_port, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\nrtp_port = tvb_get_ntohs(tvb,curr_offset);\r\ncurr_offset+=2;\r\nswitch (addr_type) {\r\ncase 1:\r\nrtp_dst_addr.type = AT_IPv4;\r\nrtp_dst_addr.len = 4;\r\nrtp_dst_addr.data = (guint8 *)&rtp_ipv4_address;\r\nbreak;\r\ncase 2:\r\nrtp_dst_addr.type = AT_IPv6;\r\nrtp_dst_addr.len = 16;\r\nrtp_dst_addr.data = (guint8 *)&rtp_addr_ipv6;\r\nbreak;\r\n}\r\nif ((!pinfo->fd->flags.visited) && rtp_port != 0) {\r\nrtp_add_address(pinfo, &rtp_dst_addr, rtp_port, 0, "BSS MAP", pinfo->num, FALSE, 0);\r\nrtcp_add_address(pinfo, &rtp_dst_addr, rtp_port+1, 0, "BSS MAP", pinfo->num);\r\n}\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_speech_codec_lst(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset, consumed = 0;\r\nguint8 codec;\r\nguint8 number = 0;\r\nproto_item *item = NULL;\r\nproto_tree *subtree = NULL;\r\ncurr_offset = offset;\r\nwhile (curr_offset-offset < len) {\r\nnumber++;\r\nconsumed = 0;\r\nsubtree = proto_tree_add_subtree_format(tree, tvb, curr_offset, 1,\r\nett_codec_lst, &item, "Speech Codec Element %u",number);\r\ncodec = tvb_get_guint8(tvb,curr_offset)&0x0f;\r\nswitch (codec) {\r\ncase 0:\r\ncase 1:\r\ncase 2:\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_fi, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_pi, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_pt, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_tf, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssap_speech_codec, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_append_text(item, " - %s",\r\nval_to_str_const(tvb_get_guint8(tvb, curr_offset) & 0x0f,\r\nbssap_speech_codec_values,\r\n"Unknown"));\r\ncurr_offset++;\r\nconsumed++;\r\nbreak;\r\ncase 3:\r\ncase 4:\r\ncase 0xb:\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_fi, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_pi, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_pt, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_tf, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssap_speech_codec, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_append_text(item, " - %s",\r\nval_to_str_const(tvb_get_guint8(tvb, curr_offset) & 0x0f,\r\nbssap_speech_codec_values,\r\n"Unknown"));\r\ncurr_offset++;\r\nconsumed++;\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_s0_s15, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\ncurr_offset+=2;\r\nconsumed+=2;\r\nbreak;\r\ncase 0x9:\r\ncase 0xc:\r\ncase 0xd:\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_fi, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_pi, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_pt, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_tf, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssap_speech_codec, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_append_text(item, " - %s",\r\nval_to_str_const(tvb_get_guint8(tvb, curr_offset) & 0x0f,\r\nbssap_speech_codec_values,\r\n"Unknown"));\r\ncurr_offset++;\r\nconsumed++;\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_s0_s7, tvb, curr_offset, 1, ENC_NA);\r\ncurr_offset++;\r\nconsumed++;\r\nbreak;\r\ncase 0xf:\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_pi, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_pt, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssap_speech_codec, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nconsumed++;\r\nproto_tree_add_item(subtree, hf_gsm_a_bssap_extended_codec, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_append_text(item, " - %s",\r\nval_to_str_const(tvb_get_guint8(tvb, curr_offset),\r\nbssap_extended_codec_values,\r\n"Unknown"));\r\ncurr_offset++;\r\nconsumed++;\r\nproto_tree_add_item(subtree, hf_gsm_a_bssap_extended_codec_r2, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssap_extended_codec_r3, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nconsumed++;\r\nbreak;\r\ndefault:\r\nproto_tree_add_expert(subtree, pinfo, &ei_gsm_a_bssap_unknown_codec, tvb, curr_offset, 2);\r\ncurr_offset+=2;\r\nconsumed+=2;\r\nbreak;\r\n}\r\n}\r\nproto_item_set_len(item, consumed);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_speech_codec(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset, consumed = 0;\r\nguint8 codec;\r\nguint8 number = 0;\r\nproto_item *item = NULL;\r\nproto_tree *subtree = NULL;\r\ncurr_offset = offset;\r\nwhile (curr_offset-offset < len) {\r\nnumber++;\r\nconsumed = 0;\r\nsubtree = proto_tree_add_subtree_format(tree, tvb, curr_offset, 1, ett_codec_lst, &item,\r\n"Speech Codec Element %u",number);\r\ncodec = tvb_get_guint8(tvb,curr_offset)&0x0f;\r\nswitch (codec) {\r\ncase 0:\r\ncase 1:\r\ncase 2:\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_fi, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_pi, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_pt, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_tf, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssap_speech_codec, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_append_text(item, " - %s",\r\nval_to_str_const(tvb_get_guint8(tvb, curr_offset) & 0x0f,\r\nbssap_speech_codec_values,\r\n"Unknown"));\r\ncurr_offset++;\r\nconsumed++;\r\nbreak;\r\ncase 3:\r\ncase 4:\r\ncase 0xb:\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_fi2, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_pi2, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_pt2, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_tf2, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssap_speech_codec, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_append_text(item, " - %s",\r\nval_to_str_const(tvb_get_guint8(tvb, curr_offset) & 0x0f,\r\nbssap_speech_codec_values,\r\n"Unknown"));\r\ncurr_offset++;\r\nconsumed++;\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_s0_s15, tvb, curr_offset, 2, ENC_BIG_ENDIAN);\r\ncurr_offset+=2;\r\nconsumed+=2;\r\nbreak;\r\ncase 0x9:\r\ncase 0xc:\r\ncase 0xd:\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_fi2, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_pi2, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_pt2, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_tf2, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssap_speech_codec, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_append_text(item, " - %s",\r\nval_to_str_const(tvb_get_guint8(tvb, curr_offset) & 0x0f,\r\nbssap_speech_codec_values,\r\n"Unknown"));\r\ncurr_offset++;\r\nconsumed++;\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_s0_s7, tvb, curr_offset, 1, ENC_NA);\r\ncurr_offset++;\r\nconsumed++;\r\nbreak;\r\ncase 0xf:\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_pi, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssmap_pt, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssap_speech_codec, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nconsumed++;\r\nproto_tree_add_item(subtree, hf_gsm_a_bssap_extended_codec, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nconsumed++;\r\nproto_tree_add_item(subtree, hf_gsm_a_bssap_extended_codec_r2, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(subtree, hf_gsm_a_bssap_extended_codec_r3, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nconsumed++;\r\nbreak;\r\ndefault:\r\nproto_tree_add_expert(subtree, pinfo, &ei_gsm_a_bssap_unknown_codec, tvb, curr_offset, 2);\r\ncurr_offset+=2;\r\nconsumed+=2;\r\nbreak;\r\n}\r\n}\r\nproto_item_set_len(item, consumed);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_call_id(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_call_id, tvb, curr_offset, 4, ENC_LITTLE_ENDIAN);\r\ncurr_offset+=4;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_call_id_lst(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nif (len==0) {\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_all_call_identifiers_resources_released, tvb, curr_offset, len, ENC_NA);\r\n}\r\nwhile (curr_offset-offset < len) {\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_call_id, tvb, curr_offset, 4, ENC_LITTLE_ENDIAN);\r\ncurr_offset+=4;\r\n}\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_a_itf_sel_for_reset(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, (curr_offset<<3), 6, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_rip, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_rtd, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_kc128(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_kc128, tvb, curr_offset, 16, ENC_NA);\r\ncurr_offset+=16;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_csg_id(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 bit_offset;\r\nbit_offset = offset<<3;\r\nproto_tree_add_split_bits_item_ret_val(tree, hf_gsm_a_bssmap_csg_id, tvb, bit_offset, gsm_a_bssmap_csg_id_crumbs, NULL);\r\nbit_offset += 32;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_spare_bits, tvb, bit_offset, 7, ENC_BIG_ENDIAN);\r\nbit_offset += 7;\r\nproto_tree_add_bits_item(tree, hf_gsm_a_bssmap_cell_access_mode, tvb, bit_offset, 1, ENC_BIG_ENDIAN);\r\nreturn(len);\r\n}\r\nstatic guint16\r\nbe_reroute_rej_cause(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_reroute_rej_cause, tvb, curr_offset, 1, ENC_NA);\r\ncurr_offset+=1;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_send_seqn(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_send_seqn, tvb, curr_offset, 1, ENC_NA);\r\ncurr_offset+=1;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_reroute_outcome(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_reroute_outcome, tvb, curr_offset, 1, ENC_NA);\r\ncurr_offset+=1;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_global_call_ref(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_expert_format(tree, pinfo, &ei_gsm_a_bssmap_not_decoded_yet, tvb, curr_offset, len, "Field Element not decoded yet");\r\nreturn len;\r\n}\r\nstatic guint16\r\nbe_lcls_conf(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_lcls_conf, tvb, curr_offset, 1, ENC_NA);\r\ncurr_offset+=1;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_lcls_con_status_control(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_lcls_con_status_control, tvb, curr_offset, 1, ENC_NA);\r\ncurr_offset+=1;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_lcls_bss_status(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_gsm_a_bssmap_lcls_bss_status, tvb, curr_offset, 1, ENC_NA);\r\ncurr_offset+=1;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_selected_plmn_id(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nproto_tree_add_string(tree, hf_gsm_a_bssmap_selected_plmn_id, tvb, offset, 3, dissect_e212_mcc_mnc_wmem_packet_str(tvb, pinfo, tree, offset, E212_NONE, TRUE));\r\nreturn 3;\r\n}\r\nstatic guint16\r\nbe_fe_extra_info(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_fe_extra_info_prec, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_fe_extra_info_lcs, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_fe_extra_info_ue_prob, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_fe_extra_info_spare, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_fe_cur_chan_type2(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_fe_cur_chan_type2_chan_mode, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_fe_cur_chan_type2_chan_mode_spare, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nproto_tree_add_item(tree, hf_fe_cur_chan_type2_chan_field, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_fe_cur_chan_type2_chan_field_spare, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_fe_target_radio_cell_info(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_fe_target_radio_cell_info_rxlev_ncell, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_fe_target_radio_cell_info_rxlev_ncell_spare, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_fe_gprs_suspend_info(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset = offset;\r\nbssgp_suspend_ack(tvb, tree, pinfo, offset, len);\r\ncurr_offset += len;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_fe_dual_transfer_mode_info(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_fe_dtm_info_dtm_ind, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_fe_dtm_info_sto_ind, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_fe_dtm_info_egprs_ind, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_fe_dtm_info_spare_bits, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_fe_inter_rat_handover_info(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\ntvbuff_t *container_tvb;\r\ncontainer_tvb = tvb_new_subset_length(tvb, offset, len);\r\ndissect_rrc_InterRATHandoverInfo_PDU(container_tvb, pinfo, tree, NULL);\r\nreturn len;\r\n}\r\nstatic guint16\r\nbe_fe_cell_load_info_group(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\ncurr_offset += be_cell_id(tvb, tree, pinfo, curr_offset, len, NULL, 0);\r\ncurr_offset += be_field_element_dissect(tvb, tree, pinfo, curr_offset, len + offset - curr_offset, NULL, 0);\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_fe_cell_load_info(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_fe_cell_load_info_cell_capacity_class, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nproto_tree_add_item(tree, hf_fe_cell_load_info_load_value, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nproto_tree_add_item(tree, hf_fe_cell_load_info_rt_load_value, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nproto_tree_add_item(tree, hf_fe_cell_load_info_nrt_load_information_value, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_fe_ps_indication(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_fe_ps_indication, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_fe_dtm_ho_command_ind(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset;\r\ncurr_offset = offset;\r\nproto_tree_add_item(tree, hf_fe_dtm_ho_command_ind_spare, tvb, curr_offset, 1, ENC_BIG_ENDIAN);\r\ncurr_offset++;\r\nreturn(curr_offset - offset);\r\n}\r\nstatic guint16\r\nbe_field_element_dissect(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo, guint32 offset, guint len _U_, gchar *add_string _U_, int string_len _U_)\r\n{\r\nguint32 curr_offset, ie_len, fe_start_offset;\r\ngint idx;\r\nconst gchar *str;\r\nproto_item *item = NULL;\r\nproto_tree * bss_to_bss_tree = NULL;\r\ncurr_offset = offset;\r\nwhile (curr_offset - offset + 2 < len) {\r\nguint8 oct;\r\noct = tvb_get_guint8(tvb, curr_offset++);\r\nstr = try_val_to_str_idx((guint32) oct, bssmap_field_element_ids, &idx);\r\nie_len = tvb_get_guint8(tvb, curr_offset++);\r\nif (!str)\r\nstr = "Unknown";\r\nitem = proto_tree_add_uint_format(tree, hf_gsm_a_bssmap_field_elem_id,\r\ntvb, curr_offset - 2, ie_len + 2, oct, "%s (%X)", str, oct);\r\nbss_to_bss_tree = proto_item_add_subtree(item, ett_bss_to_bss_info);\r\nfe_start_offset = curr_offset;\r\nif (idx < 0 || idx >= NUM_BSS_ELEMENT_FCNS ||\r\n(bssmap_bss_to_bss_element_fcn[idx] == NULL))\r\n{\r\nproto_tree_add_expert_format(bss_to_bss_tree, pinfo, &ei_gsm_a_bssmap_not_decoded_yet,\r\ntvb, curr_offset, ie_len, "Field Element not decoded");\r\ncurr_offset += ie_len;\r\n}\r\nelse\r\n{\r\ncurr_offset += (*bssmap_bss_to_bss_element_fcn[idx])(tvb, bss_to_bss_tree, pinfo, curr_offset, ie_len, NULL, 0);\r\nEXTRANEOUS_DATA_CHECK(ie_len, curr_offset - fe_start_offset, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\n}\r\nreturn len;\r\n}\r\nstatic void\r\nbssmap_ass_req(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_CHAN_TYPE, GSM_A_PDU_TYPE_BSSMAP, BE_CHAN_TYPE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TLV(BE_L3_HEADER_INFO, GSM_A_PDU_TYPE_BSSMAP, BE_L3_HEADER_INFO, NULL);\r\nELEM_OPT_TLV(BE_PRIO, GSM_A_PDU_TYPE_BSSMAP, BE_PRIO, NULL);\r\nELEM_OPT_TV(BE_CIC, GSM_A_PDU_TYPE_BSSMAP, BE_CIC, NULL);\r\nELEM_OPT_TV(BE_DOWN_DTX_FLAG, GSM_A_PDU_TYPE_BSSMAP, BE_DOWN_DTX_FLAG, NULL);\r\nELEM_OPT_TV(BE_INT_BAND, GSM_A_PDU_TYPE_BSSMAP, BE_INT_BAND, NULL);\r\nELEM_OPT_TLV(BE_CM_INFO_2, GSM_A_PDU_TYPE_BSSMAP, BE_CM_INFO_2, NULL);\r\nELEM_OPT_TLV(BE_GROUP_CALL_REF, GSM_A_PDU_TYPE_BSSMAP, BE_GROUP_CALL_REF, NULL);\r\nELEM_OPT_T(BE_TALKER_FLAG, GSM_A_PDU_TYPE_BSSMAP, BE_TALKER_FLAG, NULL);\r\nELEM_OPT_TV(BE_CONF_EVO_IND, GSM_A_PDU_TYPE_BSSMAP, BE_CONF_EVO_IND, NULL);\r\nELEM_OPT_TV(BE_LSA_ACC_CTRL, GSM_A_PDU_TYPE_BSSMAP, BE_LSA_ACC_CTRL, NULL);\r\nELEM_OPT_TLV(BE_SERV_HO, GSM_A_PDU_TYPE_BSSMAP, BE_SERV_HO, NULL);\r\nELEM_OPT_TLV(BE_ENC_INFO, GSM_A_PDU_TYPE_BSSMAP, BE_ENC_INFO, NULL);\r\nELEM_OPT_TV(BE_TALKER_PRI, GSM_A_PDU_TYPE_BSSMAP, BE_TALKER_PRI, NULL);\r\nELEM_OPT_TLV(BE_AOIP_TRANS_LAY_ADD, GSM_A_PDU_TYPE_BSSMAP, BE_AOIP_TRANS_LAY_ADD, NULL);\r\nELEM_OPT_TLV(BE_SPEECH_CODEC_LST, GSM_A_PDU_TYPE_BSSMAP, BE_SPEECH_CODEC_LST, "(MSC Preferred)");\r\nELEM_OPT_TV(BE_CALL_ID, GSM_A_PDU_TYPE_BSSMAP, BE_CALL_ID, NULL);\r\nELEM_OPT_TV(BE_KC128, GSM_A_PDU_TYPE_BSSMAP, BE_KC128, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_ass_complete(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_OPT_TV(BE_RR_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_RR_CAUSE, NULL);\r\nELEM_OPT_TV(BE_CIC, GSM_A_PDU_TYPE_BSSMAP, BE_CIC, NULL);\r\nELEM_OPT_TLV(BE_CELL_ID, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID, NULL);\r\nELEM_OPT_TV(BE_CHOSEN_CHAN, GSM_A_PDU_TYPE_BSSMAP, BE_CHOSEN_CHAN, NULL);\r\nELEM_OPT_TV(BE_CHOSEN_ENC_ALG, GSM_A_PDU_TYPE_BSSMAP, BE_CHOSEN_ENC_ALG, NULL);\r\nELEM_OPT_TV(BE_CCT_POOL, GSM_A_PDU_TYPE_BSSMAP, BE_CCT_POOL, NULL);\r\nELEM_OPT_TV(BE_SPEECH_VER, GSM_A_PDU_TYPE_BSSMAP, BE_SPEECH_VER, " (Chosen)");\r\nELEM_OPT_TLV(BE_LSA_ID, GSM_A_PDU_TYPE_BSSMAP, BE_LSA_ID, NULL);\r\nELEM_OPT_TV(BE_TALKER_PRI, GSM_A_PDU_TYPE_BSSMAP, BE_TALKER_PRI, NULL);\r\nELEM_OPT_TLV(BE_AOIP_TRANS_LAY_ADD, GSM_A_PDU_TYPE_BSSMAP, BE_AOIP_TRANS_LAY_ADD, NULL);\r\nELEM_OPT_TLV(BE_SPEECH_CODEC, GSM_A_PDU_TYPE_BSSMAP, BE_SPEECH_CODEC, "(Chosen)");\r\nELEM_OPT_TLV(BE_SPEECH_CODEC_LST, GSM_A_PDU_TYPE_BSSMAP, BE_SPEECH_CODEC_LST, "(BSS Supported)");\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_ass_failure(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_CAUSE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TV(BE_RR_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_RR_CAUSE, NULL);\r\nELEM_OPT_TV(BE_CCT_POOL, GSM_A_PDU_TYPE_BSSMAP, BE_CCT_POOL, NULL);\r\nELEM_OPT_TLV(BE_CCT_POOL_LIST, GSM_A_PDU_TYPE_BSSMAP, BE_CCT_POOL_LIST, NULL);\r\nELEM_OPT_TV(BE_TALKER_PRI, GSM_A_PDU_TYPE_BSSMAP, BE_TALKER_PRI, NULL);\r\nELEM_OPT_TLV(BE_SPEECH_CODEC_LST, GSM_A_PDU_TYPE_BSSMAP, BE_SPEECH_CODEC_LST, "(BSS Supported)");\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_block(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TV(BE_CIC, GSM_A_PDU_TYPE_BSSMAP, BE_CIC, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TLV(BE_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_CAUSE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_T(BE_CONN_REL_REQ, GSM_A_PDU_TYPE_BSSMAP, BE_CONN_REL_REQ, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_block_ack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TV(BE_CIC, GSM_A_PDU_TYPE_BSSMAP, BE_CIC, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_unblock(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TV(BE_CIC, GSM_A_PDU_TYPE_BSSMAP, BE_CIC, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_unblock_ack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TV(BE_CIC, GSM_A_PDU_TYPE_BSSMAP, BE_CIC, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_ho_req(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_CHAN_TYPE, GSM_A_PDU_TYPE_BSSMAP, BE_CHAN_TYPE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TLV(BE_ENC_INFO, GSM_A_PDU_TYPE_BSSMAP, BE_ENC_INFO, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TV(BE_CM_INFO_1, GSM_A_PDU_TYPE_BSSMAP, BE_CM_INFO_1, NULL);\r\nELEM_OPT_TLV(BE_CM_INFO_2, GSM_A_PDU_TYPE_BSSMAP, BE_CM_INFO_2, NULL);\r\nELEM_MAND_TLV(BE_CELL_ID, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID, " (Serving)", ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TLV(BE_PRIO, GSM_A_PDU_TYPE_BSSMAP, BE_PRIO, NULL);\r\nELEM_OPT_TV(BE_CIC, GSM_A_PDU_TYPE_BSSMAP, BE_CIC, NULL);\r\nELEM_OPT_TV(BE_DOWN_DTX_FLAG, GSM_A_PDU_TYPE_BSSMAP, BE_DOWN_DTX_FLAG, NULL);\r\nELEM_MAND_TLV(BE_CELL_ID, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID, " (Target)", ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TV(BE_INT_BAND, GSM_A_PDU_TYPE_BSSMAP, BE_INT_BAND, NULL);\r\nELEM_OPT_TLV(BE_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_CAUSE, NULL);\r\nELEM_OPT_TLV(BE_CM_INFO_3, GSM_A_PDU_TYPE_BSSMAP, BE_CM_INFO_3, NULL);\r\nELEM_OPT_TV(BE_CURR_CHAN_1, GSM_A_PDU_TYPE_BSSMAP, BE_CURR_CHAN_1, NULL);\r\nELEM_OPT_TV(BE_SPEECH_VER, GSM_A_PDU_TYPE_BSSMAP, BE_SPEECH_VER, " (Used)");\r\nELEM_OPT_TLV(BE_GROUP_CALL_REF, GSM_A_PDU_TYPE_BSSMAP, BE_GROUP_CALL_REF, NULL);\r\nELEM_OPT_T(BE_TALKER_FLAG, GSM_A_PDU_TYPE_BSSMAP, BE_TALKER_FLAG, NULL);\r\nELEM_OPT_TV(BE_CONF_EVO_IND, GSM_A_PDU_TYPE_BSSMAP, BE_CONF_EVO_IND, NULL);\r\nELEM_OPT_TV(BE_CHOSEN_ENC_ALG, GSM_A_PDU_TYPE_BSSMAP, BE_CHOSEN_ENC_ALG, " (Serving)");\r\nELEM_OPT_TLV(BE_OLD2NEW_INFO, GSM_A_PDU_TYPE_BSSMAP, BE_OLD2NEW_INFO, NULL);\r\nELEM_OPT_TLV(BE_LSA_INFO, GSM_A_PDU_TYPE_BSSMAP, BE_LSA_INFO, NULL);\r\nELEM_OPT_TV(BE_LSA_ACC_CTRL, GSM_A_PDU_TYPE_BSSMAP, BE_LSA_ACC_CTRL, NULL);\r\nELEM_OPT_TLV(BE_SERV_HO, GSM_A_PDU_TYPE_BSSMAP, BE_SERV_HO, NULL);\r\nELEM_OPT_TLV(BE_IMSI, GSM_A_PDU_TYPE_BSSMAP, BE_IMSI, NULL);\r\nELEM_OPT_TLV(BE_SRC_RNC_TO_TAR_RNC_UMTS, GSM_A_PDU_TYPE_BSSMAP, BE_SRC_RNC_TO_TAR_RNC_UMTS, NULL);\r\nELEM_OPT_TLV(BE_SRC_RNC_TO_TAR_RNC_CDMA, GSM_A_PDU_TYPE_BSSMAP, BE_SRC_RNC_TO_TAR_RNC_CDMA, NULL);\r\nELEM_OPT_TLV(BE_SNA_ACC_INF, GSM_A_PDU_TYPE_BSSMAP, BE_SNA_ACC_INF, NULL);\r\nELEM_OPT_TV(BE_TALKER_PRI, GSM_A_PDU_TYPE_BSSMAP, BE_TALKER_PRI, NULL);\r\nELEM_OPT_TLV(BE_AOIP_TRANS_LAY_ADD, GSM_A_PDU_TYPE_BSSMAP, BE_AOIP_TRANS_LAY_ADD, NULL);\r\nELEM_OPT_TLV(BE_SPEECH_CODEC_LST, GSM_A_PDU_TYPE_BSSMAP, BE_SPEECH_CODEC_LST, "(MSC Preferred)");\r\nELEM_OPT_TV(BE_CALL_ID, GSM_A_PDU_TYPE_BSSMAP, BE_CALL_ID, NULL);\r\nELEM_OPT_TV(BE_KC128, GSM_A_PDU_TYPE_BSSMAP, BE_KC128, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_ho_reqd(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_CAUSE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_T(BE_RESP_REQ, GSM_A_PDU_TYPE_BSSMAP, BE_RESP_REQ, NULL);\r\nELEM_MAND_TLV(BE_CELL_ID_LIST, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID_LIST, " (Preferred)", ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TLV(BE_CCT_POOL_LIST, GSM_A_PDU_TYPE_BSSMAP, BE_CCT_POOL_LIST, NULL);\r\nELEM_OPT_TV(BE_CURR_CHAN_1, GSM_A_PDU_TYPE_BSSMAP, BE_CURR_CHAN_1, NULL);\r\nELEM_OPT_TV(BE_SPEECH_VER, GSM_A_PDU_TYPE_BSSMAP, BE_SPEECH_VER, " (Used)");\r\nELEM_OPT_TV(BE_QUE_IND, GSM_A_PDU_TYPE_BSSMAP, BE_QUE_IND, NULL);\r\nELEM_OPT_TLV(BE_OLD2NEW_INFO, GSM_A_PDU_TYPE_BSSMAP, BE_OLD2NEW_INFO, NULL);\r\nELEM_OPT_TLV(BE_SRC_RNC_TO_TAR_RNC_UMTS, GSM_A_PDU_TYPE_BSSMAP, BE_SRC_RNC_TO_TAR_RNC_UMTS, NULL);\r\nELEM_OPT_TLV(BE_SRC_RNC_TO_TAR_RNC_CDMA, GSM_A_PDU_TYPE_BSSMAP, BE_SRC_RNC_TO_TAR_RNC_CDMA, NULL);\r\nELEM_OPT_TLV(BE_GERAN_CLS_M, GSM_A_PDU_TYPE_BSSMAP, BE_GERAN_CLS_M, NULL);\r\nELEM_OPT_TV(BE_TALKER_PRI, GSM_A_PDU_TYPE_BSSMAP, BE_TALKER_PRI, NULL);\r\nELEM_OPT_TLV(BE_SPEECH_CODEC, GSM_A_PDU_TYPE_BSSMAP, BE_SPEECH_CODEC, "(Used)");\r\nELEM_OPT_TLV(BE_CSG_ID, GSM_A_PDU_TYPE_BSSMAP, BE_CSG_ID, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_ho_req_ack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_L3_INFO, GSM_A_PDU_TYPE_BSSMAP, BE_L3_INFO, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TV(BE_CHOSEN_CHAN, GSM_A_PDU_TYPE_BSSMAP, BE_CHOSEN_CHAN, NULL);\r\nELEM_OPT_TV(BE_CHOSEN_ENC_ALG, GSM_A_PDU_TYPE_BSSMAP, BE_CHOSEN_ENC_ALG, NULL);\r\nELEM_OPT_TV(BE_CCT_POOL, GSM_A_PDU_TYPE_BSSMAP, BE_CCT_POOL, NULL);\r\nELEM_OPT_TV(BE_SPEECH_VER, GSM_A_PDU_TYPE_BSSMAP, BE_SPEECH_VER, " (Chosen)");\r\nELEM_OPT_TV(BE_CIC, GSM_A_PDU_TYPE_BSSMAP, BE_CIC, NULL);\r\nELEM_OPT_TLV(BE_LSA_ID, GSM_A_PDU_TYPE_BSSMAP, BE_LSA_ID, NULL);\r\nELEM_OPT_TLV(BE_NEW_BSS_TO_OLD_BSS_INF, GSM_A_PDU_TYPE_BSSMAP, BE_NEW_BSS_TO_OLD_BSS_INF, NULL);\r\nELEM_OPT_TLV(BE_INTER_SYS_INF, GSM_A_PDU_TYPE_BSSMAP, BE_INTER_SYS_INF, NULL);\r\nELEM_OPT_TV(BE_TALKER_PRI, GSM_A_PDU_TYPE_BSSMAP, BE_TALKER_PRI, NULL);\r\nELEM_OPT_TLV(BE_AOIP_TRANS_LAY_ADD, GSM_A_PDU_TYPE_BSSMAP, BE_AOIP_TRANS_LAY_ADD, NULL);\r\nELEM_OPT_TLV(BE_SPEECH_CODEC_LST, GSM_A_PDU_TYPE_BSSMAP, BE_SPEECH_CODEC_LST, "(BSS Supported)");\r\nELEM_OPT_TLV(BE_SPEECH_CODEC, GSM_A_PDU_TYPE_BSSMAP, BE_SPEECH_CODEC, "(Chosen)");\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_ho_cmd(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_L3_INFO, GSM_A_PDU_TYPE_BSSMAP, BE_L3_INFO, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TLV(BE_CELL_ID, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID, NULL);\r\nELEM_OPT_TLV(BE_NEW_BSS_TO_OLD_BSS_INF, GSM_A_PDU_TYPE_BSSMAP, BE_NEW_BSS_TO_OLD_BSS_INF, NULL);\r\nELEM_OPT_TV(BE_TALKER_PRI, GSM_A_PDU_TYPE_BSSMAP, BE_TALKER_PRI, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_ho_complete(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_OPT_TV(BE_RR_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_RR_CAUSE, NULL);\r\nELEM_OPT_TV(BE_TALKER_PRI, GSM_A_PDU_TYPE_BSSMAP, BE_TALKER_PRI, NULL);\r\nELEM_OPT_TLV(BE_SPEECH_CODEC, GSM_A_PDU_TYPE_BSSMAP, BE_SPEECH_CODEC, "(Chosen)");\r\nELEM_OPT_TV(BE_CHOSEN_ENC_ALG, GSM_A_PDU_TYPE_BSSMAP, BE_CHOSEN_ENC_ALG, NULL);\r\nELEM_OPT_TV(BE_CHOSEN_CHAN, GSM_A_PDU_TYPE_BSSMAP, BE_CHOSEN_CHAN, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_ho_succ(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_OPT_TV(BE_TALKER_PRI, GSM_A_PDU_TYPE_BSSMAP, BE_TALKER_PRI, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_ho_cand_enq(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TV(BE_NUM_MS, GSM_A_PDU_TYPE_BSSMAP, BE_NUM_MS, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TLV(BE_CELL_ID_LIST, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID_LIST, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TLV(BE_CELL_ID, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_ho_cand_resp(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TV(BE_NUM_MS, GSM_A_PDU_TYPE_BSSMAP, BE_NUM_MS, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TLV(BE_CELL_ID, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_ho_failure(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_CAUSE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TV(BE_RR_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_RR_CAUSE, NULL);\r\nELEM_OPT_TV(BE_CCT_POOL, GSM_A_PDU_TYPE_BSSMAP, BE_CCT_POOL, NULL);\r\nELEM_OPT_TLV(BE_CCT_POOL_LIST, GSM_A_PDU_TYPE_BSSMAP, BE_CCT_POOL_LIST, NULL);\r\nELEM_OPT_TLV(BE_GERAN_CLS_M, GSM_A_PDU_TYPE_BSSMAP, BE_GERAN_CLS_M, NULL);\r\nELEM_OPT_TLV(BE_NEW_BSS_TO_OLD_BSS_INF, GSM_A_PDU_TYPE_BSSMAP, BE_NEW_BSS_TO_OLD_BSS_INF, NULL);\r\nELEM_OPT_TLV(BE_INTER_SYS_INF, GSM_A_PDU_TYPE_BSSMAP, BE_INTER_SYS_INF, NULL);\r\nELEM_OPT_TV(BE_TALKER_PRI, GSM_A_PDU_TYPE_BSSMAP, BE_TALKER_PRI, NULL);\r\nELEM_OPT_TLV(BE_SPEECH_CODEC_LST, GSM_A_PDU_TYPE_BSSMAP, BE_SPEECH_CODEC_LST, "(BSS Supported)");\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_res_req(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TV(BE_PERIODICITY, GSM_A_PDU_TYPE_BSSMAP, BE_PERIODICITY, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TV(BE_RES_IND_METHOD, GSM_A_PDU_TYPE_BSSMAP, BE_RES_IND_METHOD, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TLV(BE_CELL_ID, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TV(BE_EXT_RES_IND, GSM_A_PDU_TYPE_BSSMAP, BE_EXT_RES_IND, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_res_ind(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TV(BE_RES_IND_METHOD, GSM_A_PDU_TYPE_BSSMAP, BE_RES_IND_METHOD, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TV(BE_RES_AVAIL, GSM_A_PDU_TYPE_BSSMAP, BE_RES_AVAIL, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TLV(BE_CELL_ID, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TV(BE_TOT_RES_ACC, GSM_A_PDU_TYPE_BSSMAP, BE_TOT_RES_ACC, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_paging(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_IMSI, GSM_A_PDU_TYPE_BSSMAP, BE_IMSI, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TLV(BE_TMSI, GSM_A_PDU_TYPE_BSSMAP, BE_TMSI, NULL);\r\nELEM_MAND_TLV(BE_CELL_ID_LIST, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID_LIST, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TV(BE_CHAN_NEEDED, GSM_A_PDU_TYPE_BSSMAP, BE_CHAN_NEEDED, NULL);\r\nELEM_OPT_TV(BE_EMLPP_PRIO, GSM_A_PDU_TYPE_BSSMAP, BE_EMLPP_PRIO, NULL);\r\nELEM_OPT_TV(BE_PAGING_INF, GSM_A_PDU_TYPE_BSSMAP, BE_PAGING_INF, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_clear_req(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_CAUSE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_clear_cmd(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_OPT_TLV(BE_L3_HEADER_INFO, GSM_A_PDU_TYPE_BSSMAP, BE_L3_HEADER_INFO, NULL);\r\nELEM_MAND_TLV(BE_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_CAUSE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_T(BE_CSFB_IND, GSM_A_PDU_TYPE_BSSMAP, BE_CSFB_IND, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nvoid\r\nbssmap_reset(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_CAUSE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TV(BE_A_ITF_SEL_FOR_RESET, GSM_A_PDU_TYPE_BSSMAP, BE_A_ITF_SEL_FOR_RESET, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_reset_ack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_OPT_TV(BE_A_ITF_SEL_FOR_RESET, GSM_A_PDU_TYPE_BSSMAP, BE_A_ITF_SEL_FOR_RESET, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_ho_performed(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_CAUSE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TLV(BE_CELL_ID, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TV(BE_CHOSEN_CHAN, GSM_A_PDU_TYPE_BSSMAP, BE_CHOSEN_CHAN, NULL);\r\nELEM_OPT_TV(BE_CHOSEN_ENC_ALG, GSM_A_PDU_TYPE_BSSMAP, BE_CHOSEN_ENC_ALG, NULL);\r\nELEM_OPT_TV(BE_SPEECH_VER, GSM_A_PDU_TYPE_BSSMAP, BE_SPEECH_VER, " (Chosen)");\r\nELEM_OPT_TLV(BE_LSA_ID, GSM_A_PDU_TYPE_BSSMAP, BE_LSA_ID, NULL);\r\nELEM_OPT_TV(BE_TALKER_PRI, GSM_A_PDU_TYPE_BSSMAP, BE_TALKER_PRI, NULL);\r\nELEM_OPT_TLV(BE_SPEECH_CODEC_LST, GSM_A_PDU_TYPE_BSSMAP, BE_SPEECH_CODEC_LST, "(BSS Supported)");\r\nELEM_OPT_TLV(BE_SPEECH_CODEC, GSM_A_PDU_TYPE_BSSMAP, BE_SPEECH_CODEC, "(Chosen)");\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_overload(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_CAUSE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TLV(BE_CELL_ID, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_msc_invoke_trace(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TV(BE_TRACE_TYPE, GSM_A_PDU_TYPE_BSSMAP, BE_TRACE_TYPE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TLV(BE_TRIGGERID, GSM_A_PDU_TYPE_BSSMAP, BE_TRIGGERID, NULL);\r\nELEM_MAND_TV(BE_TRACE_REF, GSM_A_PDU_TYPE_BSSMAP, BE_TRACE_REF, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TLV(BE_TRANSID, GSM_A_PDU_TYPE_BSSMAP, BE_TRANSID, NULL);\r\nELEM_OPT_TLV(BE_MID, GSM_A_PDU_TYPE_BSSMAP, BE_MID, NULL);\r\nELEM_OPT_TLV(BE_OMCID, GSM_A_PDU_TYPE_BSSMAP, BE_OMCID, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_bss_invoke_trace(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TV(BE_TRACE_TYPE, GSM_A_PDU_TYPE_BSSMAP, BE_TRACE_TYPE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TV(BE_FOR_IND, GSM_A_PDU_TYPE_BSSMAP, BE_FOR_IND, NULL);\r\nELEM_OPT_TLV(BE_TRIGGERID, GSM_A_PDU_TYPE_BSSMAP, BE_TRIGGERID, NULL);\r\nELEM_MAND_TV(BE_TRACE_REF, GSM_A_PDU_TYPE_BSSMAP, BE_TRACE_REF, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TLV(BE_TRANSID, GSM_A_PDU_TYPE_BSSMAP, BE_TRANSID, NULL);\r\nELEM_OPT_TLV(BE_OMCID, GSM_A_PDU_TYPE_BSSMAP, BE_OMCID, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_cm_upd(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_CM_INFO_2, GSM_A_PDU_TYPE_BSSMAP, BE_CM_INFO_2, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TLV(BE_CM_INFO_3, GSM_A_PDU_TYPE_BSSMAP, BE_CM_INFO_3, NULL);\r\nELEM_OPT_TV(BE_TALKER_PRI, GSM_A_PDU_TYPE_BSSMAP, BE_TALKER_PRI, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_ciph_mode_cmd(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_OPT_TLV(BE_L3_HEADER_INFO, GSM_A_PDU_TYPE_BSSMAP, BE_L3_HEADER_INFO, NULL);\r\nELEM_MAND_TLV(BE_ENC_INFO, GSM_A_PDU_TYPE_BSSMAP, BE_ENC_INFO, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TV(BE_CIPH_RESP_MODE, GSM_A_PDU_TYPE_BSSMAP, BE_CIPH_RESP_MODE, NULL);\r\nELEM_OPT_TV(BE_KC128, GSM_A_PDU_TYPE_BSSMAP, BE_KC128, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_ciph_mode_complete(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_OPT_TLV(BE_L3_MSG, GSM_A_PDU_TYPE_BSSMAP, BE_L3_MSG, NULL);\r\nELEM_OPT_TV(BE_CHOSEN_ENC_ALG, GSM_A_PDU_TYPE_BSSMAP, BE_CHOSEN_ENC_ALG, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_cl3_info(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 consumed;\r\nguint32 curr_offset;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_CELL_ID, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TLV(BE_L3_INFO, GSM_A_PDU_TYPE_BSSMAP, BE_L3_INFO, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TV(BE_CHOSEN_CHAN, GSM_A_PDU_TYPE_BSSMAP, BE_CHOSEN_CHAN, NULL);\r\nELEM_OPT_TLV(BE_LSA_ID_LIST, GSM_A_PDU_TYPE_BSSMAP, BE_LSA_ID_LIST, NULL);\r\nELEM_OPT_TLV_E(BE_APDU, GSM_A_PDU_TYPE_BSSMAP, BE_APDU, NULL);\r\nELEM_OPT_TLV(BE_SPEECH_CODEC_LST, GSM_A_PDU_TYPE_BSSMAP, BE_SPEECH_CODEC_LST, "(BSS Supported)");\r\nELEM_OPT_T(BE_REDIR_ATT_FLG, GSM_A_PDU_TYPE_BSSMAP, BE_REDIR_ATT_FLG, NULL);\r\nELEM_OPT_TV(BE_SEND_SEQN, GSM_A_PDU_TYPE_BSSMAP, BE_SEND_SEQN, NULL);\r\nELEM_OPT_TLV(BE_IMSI, GSM_A_PDU_TYPE_BSSMAP, BE_IMSI, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_sapi_rej(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 consumed;\r\nguint32 curr_offset;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TV(BE_DLCI, GSM_A_PDU_TYPE_BSSMAP, BE_DLCI, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TLV(BE_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_CAUSE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_ho_reqd_rej(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_CAUSE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TLV(BE_NEW_BSS_TO_OLD_BSS_INF, GSM_A_PDU_TYPE_BSSMAP, BE_NEW_BSS_TO_OLD_BSS_INF, NULL);\r\nELEM_OPT_TV(BE_TALKER_PRI, GSM_A_PDU_TYPE_BSSMAP, BE_TALKER_PRI, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_reset_cct(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TV(BE_CIC, GSM_A_PDU_TYPE_BSSMAP, BE_CIC, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TLV(BE_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_CAUSE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_reset_cct_ack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TV(BE_CIC, GSM_A_PDU_TYPE_BSSMAP, BE_CIC, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_ho_det(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_OPT_TV(BE_TALKER_PRI, GSM_A_PDU_TYPE_BSSMAP, BE_TALKER_PRI, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_cct_group_block(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_CAUSE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TV(BE_CIC, GSM_A_PDU_TYPE_BSSMAP, BE_CIC, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TLV(BE_CIC_LIST, GSM_A_PDU_TYPE_BSSMAP, BE_CIC_LIST, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_cct_group_block_ack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TV(BE_CIC, GSM_A_PDU_TYPE_BSSMAP, BE_CIC, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TLV(BE_CIC_LIST, GSM_A_PDU_TYPE_BSSMAP, BE_CIC_LIST, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_cct_group_unblock(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TV(BE_CIC, GSM_A_PDU_TYPE_BSSMAP, BE_CIC, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TLV(BE_CIC_LIST, GSM_A_PDU_TYPE_BSSMAP, BE_CIC_LIST, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_cct_group_unblock_ack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TV(BE_CIC, GSM_A_PDU_TYPE_BSSMAP, BE_CIC, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TLV(BE_CIC_LIST, GSM_A_PDU_TYPE_BSSMAP, BE_CIC_LIST, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_confusion(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_CAUSE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TLV(BE_DIAG, GSM_A_PDU_TYPE_BSSMAP, BE_DIAG, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_cls_m_req(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_OPT_TV(BE_TALKER_PRI, GSM_A_PDU_TYPE_BSSMAP, BE_TALKER_PRI, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_unequipped_cct(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TV(BE_CIC, GSM_A_PDU_TYPE_BSSMAP, BE_CIC, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TLV(BE_CIC_LIST, GSM_A_PDU_TYPE_BSSMAP, BE_CIC_LIST, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_ciph_mode_rej(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_CAUSE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_load_ind(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TV(BE_TIME_IND, GSM_A_PDU_TYPE_BSSMAP, BE_TIME_IND, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TLV(BE_CELL_ID, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TLV(BE_CELL_ID_LIST, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID_LIST, " (Target)", ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TLV(BE_RES_SIT, GSM_A_PDU_TYPE_BSSMAP, BE_RES_SIT, NULL);\r\nELEM_OPT_TLV(BE_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_CAUSE, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_vgcs_vbs_setup(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_GROUP_CALL_REF, GSM_A_PDU_TYPE_BSSMAP, BE_GROUP_CALL_REF, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TLV(BE_PRIO, GSM_A_PDU_TYPE_BSSMAP, BE_PRIO, NULL);\r\nELEM_OPT_TLV(BE_VGCS_FEAT_FLG, GSM_A_PDU_TYPE_BSSMAP, BE_VGCS_FEAT_FLG, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_vgcs_vbs_setup_ack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_OPT_TLV(BE_VGCS_FEAT_FLG, GSM_A_PDU_TYPE_BSSMAP, BE_VGCS_FEAT_FLG, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_vgcs_vbs_setup_refuse(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_CAUSE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_vgcs_vbs_ass_req(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_CHAN_TYPE, GSM_A_PDU_TYPE_BSSMAP, BE_CHAN_TYPE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TV(BE_ASS_REQ, GSM_A_PDU_TYPE_BSSMAP, BE_ASS_REQ, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TLV(BE_CELL_ID, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TLV(BE_GROUP_CALL_REF, GSM_A_PDU_TYPE_BSSMAP, BE_GROUP_CALL_REF, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TLV(BE_PRIO, GSM_A_PDU_TYPE_BSSMAP, BE_PRIO, NULL);\r\nELEM_OPT_TV(BE_CIC, GSM_A_PDU_TYPE_BSSMAP, BE_CIC, NULL);\r\nELEM_OPT_TV(BE_DOWN_DTX_FLAG, GSM_A_PDU_TYPE_BSSMAP, BE_DOWN_DTX_FLAG, NULL);\r\nELEM_OPT_TLV(BE_ENC_INFO, GSM_A_PDU_TYPE_BSSMAP, BE_ENC_INFO, NULL);\r\nELEM_OPT_TLV(BE_VSTK_RAND_INF, GSM_A_PDU_TYPE_BSSMAP, BE_VSTK_RAND_INF, NULL);\r\nELEM_OPT_TLV(BE_VSTK_INF, GSM_A_PDU_TYPE_BSSMAP, BE_VSTK_INF, NULL);\r\nELEM_OPT_TLV(BE_CELL_ID_LIST_SEG, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID_LIST_SEG, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_vgcs_vbs_ass_res(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_CHAN_TYPE, GSM_A_PDU_TYPE_BSSMAP, BE_CHAN_TYPE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TLV(BE_CELL_ID, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TV(BE_CHOSEN_CHAN, GSM_A_PDU_TYPE_BSSMAP, BE_CHOSEN_CHAN, NULL);\r\nELEM_OPT_TV(BE_CIC, GSM_A_PDU_TYPE_BSSMAP, BE_CIC, NULL);\r\nELEM_OPT_TV(BE_CCT_POOL, GSM_A_PDU_TYPE_BSSMAP, BE_CCT_POOL, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_vgcs_vbs_ass_fail(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_OPT_TLV(BE_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_CAUSE, NULL);\r\nELEM_OPT_TV(BE_CCT_POOL, GSM_A_PDU_TYPE_BSSMAP, BE_CCT_POOL, NULL);\r\nELEM_OPT_TLV(BE_CCT_POOL_LIST, GSM_A_PDU_TYPE_BSSMAP, BE_CCT_POOL_LIST, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_uplink_req(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_OPT_TV(BE_TALKER_PRI, GSM_A_PDU_TYPE_BSSMAP, BE_TALKER_PRI, NULL);\r\nELEM_MAND_TLV(BE_CELL_ID, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TLV(BE_L3_INFO, GSM_A_PDU_TYPE_BSSMAP, BE_L3_INFO, NULL);\r\nELEM_OPT_TLV(BE_MID, GSM_A_PDU_TYPE_COMMON, DE_MID, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_uplink_req_ack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_OPT_TV(BE_TALKER_PRI, GSM_A_PDU_TYPE_BSSMAP, BE_TALKER_PRI, NULL);\r\nELEM_OPT_T(BE_EMRG_SET_IND, GSM_A_PDU_TYPE_BSSMAP, BE_EMRG_SET_IND, NULL);\r\nELEM_MAND_TLV(BE_TALKER_ID, GSM_A_PDU_TYPE_BSSMAP, BE_TALKER_ID, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_uplink_req_conf(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_CELL_ID, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TLV(BE_TALKER_ID, GSM_A_PDU_TYPE_BSSMAP, BE_TALKER_ID, NULL);\r\nELEM_MAND_TLV(BE_L3_INFO, GSM_A_PDU_TYPE_BSSMAP, BE_L3_INFO, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_uplink_app_data(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_CELL_ID, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TLV(BE_L3_INFO, GSM_A_PDU_TYPE_BSSMAP, BE_L3_INFO, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TLV(BE_APP_DATA_INF, GSM_A_PDU_TYPE_BSSMAP, BE_APP_DATA_INF, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_uplink_rel_ind(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_CAUSE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TV(BE_TALKER_PRI, GSM_A_PDU_TYPE_BSSMAP, BE_TALKER_PRI, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_uplink_rej_cmd(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_CAUSE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TV(BE_TALKER_PRI, GSM_A_PDU_TYPE_BSSMAP, BE_TALKER_PRI, "Current");\r\nELEM_OPT_TV(BE_TALKER_PRI, GSM_A_PDU_TYPE_BSSMAP, BE_TALKER_PRI, "Rejected");\r\nELEM_OPT_TLV(BE_TALKER_ID, GSM_A_PDU_TYPE_BSSMAP, BE_TALKER_ID, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_uplink_rel_cmd(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_OPT_TLV(BE_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_CAUSE, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_uplink_seized_cmd(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_OPT_TLV(BE_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_CAUSE, NULL);\r\nELEM_OPT_TV(BE_TALKER_PRI, GSM_A_PDU_TYPE_BSSMAP, BE_TALKER_PRI, NULL);\r\nELEM_OPT_T(BE_EMRG_SET_IND, GSM_A_PDU_TYPE_BSSMAP, BE_EMRG_SET_IND, NULL);\r\nELEM_MAND_TLV(BE_TALKER_ID, GSM_A_PDU_TYPE_BSSMAP, BE_TALKER_ID, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_sus(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TV(BE_DLCI, GSM_A_PDU_TYPE_BSSMAP, BE_DLCI, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_res(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TV(BE_DLCI, GSM_A_PDU_TYPE_BSSMAP, BE_DLCI, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_change_cct(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_CAUSE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_change_cct_ack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TV(BE_CIC, GSM_A_PDU_TYPE_BSSMAP, BE_CIC, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_common_id(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_IMSI, GSM_A_PDU_TYPE_BSSMAP, BE_IMSI, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TLV(BE_SNA_ACC_INF, GSM_A_PDU_TYPE_BSSMAP, BE_SNA_ACC_INF, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_lsa_info(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_LSA_INFO, GSM_A_PDU_TYPE_BSSMAP, BE_LSA_INFO, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nvoid\r\nbssmap_conn_oriented(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV_E(BE_APDU, GSM_A_PDU_TYPE_BSSMAP, BE_APDU, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TLV(BE_SEG, GSM_A_PDU_TYPE_BSSMAP, BE_SEG, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_perf_loc_req(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_LOC_TYPE, GSM_A_PDU_TYPE_BSSMAP, BE_LOC_TYPE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TLV(BE_CELL_ID, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TLV(BE_CM_INFO_3, GSM_A_PDU_TYPE_BSSMAP, BE_CM_INFO_3, NULL);\r\nELEM_OPT_TLV(BE_LCS_CLIENT, GSM_PDU_TYPE_BSSMAP_LE, DE_BMAPLE_LCS_CLIENT_TYPE, NULL);\r\nELEM_OPT_TV(BE_CHOSEN_CHAN, GSM_A_PDU_TYPE_BSSMAP, BE_CHOSEN_CHAN, NULL);\r\nELEM_OPT_TLV(BE_LCS_PRIO, GSM_A_PDU_TYPE_BSSMAP, BE_LCS_PRIO, NULL);\r\nELEM_OPT_TLV(BE_LCS_QOS, GSM_PDU_TYPE_BSSMAP_LE, DE_BMAPLE_LCSQOS, NULL);\r\nELEM_OPT_TLV(BE_GPS_ASSIST_DATA, GSM_A_PDU_TYPE_BSSMAP, BE_GPS_ASSIST_DATA, NULL);\r\nELEM_OPT_TLV_E(BE_APDU, GSM_A_PDU_TYPE_BSSMAP, BE_APDU, NULL);\r\nELEM_OPT_TLV(BE_IMSI, GSM_A_PDU_TYPE_BSSMAP, BE_IMSI, NULL);\r\nELEM_OPT_TLV(BE_IMEI, GSM_A_PDU_TYPE_BSSMAP, BE_IMEI, NULL);\r\nELEM_OPT_TLV(BE_GANSS_LOC_TYP, GSM_A_PDU_TYPE_BSSMAP, BE_GANSS_LOC_TYP, NULL);\r\nELEM_OPT_TLV(BE_GANSS_ASS_DTA, GSM_A_PDU_TYPE_BSSMAP, BE_GANSS_ASS_DTA, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_perf_loc_res(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_OPT_TLV(BE_LOC_EST, GSM_A_PDU_TYPE_BSSMAP, BE_LOC_EST, NULL);\r\nELEM_OPT_TLV(BE_POS_DATA, GSM_A_PDU_TYPE_BSSMAP, BE_POS_DATA, NULL);\r\nELEM_OPT_TLV(BE_DECIPH_KEYS, GSM_PDU_TYPE_BSSMAP_LE, DE_BMAPLE_DECIPH_KEYS, NULL);\r\nELEM_OPT_TLV(BE_LCS_CAUSE, GSM_PDU_TYPE_BSSMAP_LE, DE_BMAPLE_LCS_CAUSE, NULL);\r\nELEM_OPT_TLV(BE_VEL_EST, GSM_A_PDU_TYPE_BSSMAP, BE_VEL_EST, NULL);\r\nELEM_OPT_TLV(BE_GANSS_POS_DTA, GSM_A_PDU_TYPE_BSSMAP, BE_GANSS_POS_DTA, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nvoid\r\nbssmap_perf_loc_abort(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_OPT_TLV(BE_LCS_CAUSE, GSM_PDU_TYPE_BSSMAP_LE, DE_BMAPLE_LCS_CAUSE, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_chan_mod_req(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_CAUSE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_vgcs_add_inf(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_TALKER_ID, GSM_A_PDU_TYPE_BSSMAP, BE_TALKER_ID, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_vgcs_vbs_area_cell_info(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_OPT_TLV(BE_CELL_ID_LIST_SEG, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID_LIST_SEG, NULL);\r\nELEM_MAND_TV(BE_ASS_REQ, GSM_A_PDU_TYPE_BSSMAP, BE_ASS_REQ, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_vgcs_vbs_assign_status(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_OPT_TLV(BE_CELL_ID_LST_SEG_F_EST_CELLS, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID_LST_SEG_F_EST_CELLS, NULL);\r\nELEM_OPT_TLV(BE_CELL_ID_LST_SEG_F_CELL_TB_EST, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID_LST_SEG_F_CELL_TB_EST, NULL);\r\nELEM_OPT_TLV(BE_CELL_ID_LST_SEG_F_REL_CELL, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID_LST_SEG_F_REL_CELL, NULL);\r\nELEM_OPT_TLV(BE_CELL_ID_LST_SEG_F_NOT_EST_CELL, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID_LST_SEG_F_NOT_EST_CELL, NULL);\r\nELEM_OPT_TLV(BE_VGS_VBS_CELL_STAT, GSM_A_PDU_TYPE_BSSMAP, BE_VGS_VBS_CELL_STAT, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_vgcs_sms(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_SMS_TO_VGCS, GSM_A_PDU_TYPE_BSSMAP, BE_SMS_TO_VGCS, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_notification_data(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_APP_DATA_INF, GSM_A_PDU_TYPE_BSSMAP, BE_APP_DATA_INF, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TLV(BE_DATA_ID, GSM_A_PDU_TYPE_BSSMAP, BE_DATA_ID, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TLV(BE_MSISDN, GSM_A_PDU_TYPE_BSSMAP, BE_MSISDN, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_int_ho_req(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_CAUSE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TLV(BE_CELL_ID, GSM_A_PDU_TYPE_BSSMAP, BE_CELL_ID, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TLV(BE_AOIP_TRANS_LAY_ADD, GSM_A_PDU_TYPE_BSSMAP, BE_AOIP_TRANS_LAY_ADD, NULL);\r\nELEM_OPT_TLV(BE_SPEECH_CODEC_LST, GSM_A_PDU_TYPE_BSSMAP, BE_SPEECH_CODEC_LST, "(BSS Supported)");\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_int_ho_req_rej(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_CAUSE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TLV(BE_SPEECH_CODEC_LST, GSM_A_PDU_TYPE_BSSMAP, BE_SPEECH_CODEC_LST, "(BSS Supported)");\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_int_ho_cmd(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_OPT_TLV(BE_SPEECH_CODEC, GSM_A_PDU_TYPE_BSSMAP, BE_SPEECH_CODEC, "(Chosen)");\r\nELEM_OPT_TV(BE_CIC, GSM_A_PDU_TYPE_BSSMAP, BE_CIC, NULL);\r\nELEM_OPT_TLV(BE_AOIP_TRANS_LAY_ADD, GSM_A_PDU_TYPE_BSSMAP, BE_AOIP_TRANS_LAY_ADD, NULL);\r\nELEM_OPT_TV(BE_CALL_ID, GSM_A_PDU_TYPE_BSSMAP, BE_CALL_ID, NULL);\r\nELEM_OPT_TV(BE_DOWN_DTX_FLAG, GSM_A_PDU_TYPE_BSSMAP, BE_DOWN_DTX_FLAG, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_int_ho_enq(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_OPT_TLV(BE_SPEECH_CODEC, GSM_A_PDU_TYPE_BSSMAP, BE_SPEECH_CODEC, "(Chosen)");\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_reset_ip_res(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_CAUSE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TLV(BE_CALL_ID_LST, GSM_A_PDU_TYPE_BSSMAP, BE_CALL_ID_LST, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_reset_ip_res_ack(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_OPT_TLV(BE_CALL_ID_LST, GSM_A_PDU_TYPE_BSSMAP, BE_CALL_ID_LST, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_reroute_cmd(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TLV(BE_L3_INFO, GSM_A_PDU_TYPE_BSSMAP, BE_L3_INFO, " (Initial)", ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_MAND_TV(BE_REROUTE_REJ_CAUSE, GSM_A_PDU_TYPE_BSSMAP, BE_REROUTE_REJ_CAUSE, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nELEM_OPT_TLV(BE_L3_INFO, GSM_A_PDU_TYPE_BSSMAP, BE_L3_INFO, NULL);\r\nELEM_OPT_TV(BE_SEND_SEQN, GSM_A_PDU_TYPE_BSSMAP, BE_SEND_SEQN, NULL);\r\nELEM_OPT_TLV(BE_IMSI, GSM_A_PDU_TYPE_BSSMAP, BE_IMSI, NULL);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic void\r\nbssmap_reroute_complete(tvbuff_t *tvb, proto_tree *tree, packet_info *pinfo _U_, guint32 offset, guint len)\r\n{\r\nguint32 curr_offset;\r\nguint32 consumed;\r\nguint curr_len;\r\ncurr_offset = offset;\r\ncurr_len = len;\r\nELEM_MAND_TV(BE_REROUTE_OUTCOME, GSM_A_PDU_TYPE_BSSMAP, BE_REROUTE_OUTCOME, NULL, ei_gsm_a_bssmap_missing_mandatory_element);\r\nEXTRANEOUS_DATA_CHECK(curr_len, 0, pinfo, &ei_gsm_a_bssmap_extraneous_data);\r\n}\r\nstatic int\r\ndissect_bssmap(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data)\r\n{\r\nstatic gsm_a_tap_rec_t tap_rec[4];\r\nstatic gsm_a_tap_rec_t *tap_p;\r\nstatic guint tap_current = 0;\r\nguint8 oct;\r\nguint32 offset, saved_offset;\r\nguint32 len;\r\ngint idx;\r\nproto_item *bssmap_item = NULL;\r\nproto_tree *bssmap_tree = NULL;\r\nconst gchar *str;\r\nsccp_msg_info_t* sccp_msg_p = (sccp_msg_info_t*)data;\r\nif (!(sccp_msg_p && sccp_msg_p->data.co.assoc)) {\r\nsccp_msg_p = NULL;\r\n}\r\ncol_append_str(pinfo->cinfo, COL_INFO, "(BSSMAP) ");\r\ntap_current++;\r\nif (tap_current >= 4)\r\n{\r\ntap_current = 0;\r\n}\r\ntap_p = &tap_rec[tap_current];\r\noffset = 0;\r\nsaved_offset = offset;\r\ng_tree = tree;\r\nlen = tvb_reported_length(tvb);\r\noct = tvb_get_guint8(tvb, offset++);\r\nstr = try_val_to_str_idx_ext((guint32) oct, &gsm_a_bssmap_msg_strings_ext, &idx);\r\nif (sccp_msg_p && !sccp_msg_p->data.co.label) {\r\nsccp_msg_p->data.co.label = wmem_strdup(wmem_file_scope(),\r\nval_to_str_ext((guint32)oct,\r\n&gsm_a_bssmap_msg_strings_ext,\r\n"BSSMAP (0x%02x)"));\r\n}\r\nif (str == NULL || idx < 0 || idx >= NUM_GSM_BSSMAP_MSG)\r\n{\r\nbssmap_item =\r\nproto_tree_add_protocol_format(tree, proto_a_bssmap, tvb, 0, len,\r\n"GSM A-I/F BSSMAP - Unknown BSSMAP Message Type (0x%02x)",\r\noct);\r\nbssmap_tree = proto_item_add_subtree(bssmap_item, ett_bssmap_msg);\r\n}\r\nelse\r\n{\r\nbssmap_item =\r\nproto_tree_add_protocol_format(tree, proto_a_bssmap, tvb, 0, -1,\r\n"GSM A-I/F BSSMAP - %s",\r\nstr);\r\nbssmap_tree = proto_item_add_subtree(bssmap_item, ett_gsm_bssmap_msg[idx]);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s ", str);\r\nproto_tree_add_uint_format(bssmap_tree, hf_gsm_a_bssmap_msg_type,\r\ntvb, saved_offset, 1, oct, "Message Type %s",str);\r\n}\r\ntap_p->pdu_type = GSM_A_PDU_TYPE_BSSMAP;\r\ntap_p->message_type = oct;\r\ntap_queue_packet(gsm_a_tap, pinfo, tap_p);\r\nif (str == NULL) return len;\r\nif ((len - offset) <= 0) return len;\r\nif (idx < 0 || idx >= NUM_BSSMAP_MSG_FCNS || bssmap_msg_fcn[idx] == NULL) {\r\nproto_tree_add_bytes_format(bssmap_tree, hf_gsm_a_bssmap_message_elements,\r\ntvb, offset, len - offset, NULL, "Message Elements");\r\n}else{\r\nif (sccp_msg_p && ((sccp_msg_p->data.co.assoc->app_info & 0xCD00) == 0xCD00)) {\r\ncell_discriminator = sccp_msg_p->data.co.assoc->app_info & 0xFF;\r\n}else{\r\ncell_discriminator = 0xFF;\r\n}\r\n(*bssmap_msg_fcn[idx])(tvb, bssmap_tree, pinfo, offset, len - offset);\r\nif (sccp_msg_p) {\r\nsccp_msg_p->data.co.assoc->app_info = cell_discriminator | 0xCDF0;\r\n}\r\n}\r\ng_tree = NULL;\r\nreturn len;\r\n}\r\nvoid\r\nproto_register_gsm_a_bssmap(void)\r\n{\r\nguint i;\r\nguint last_offset;\r\nstatic hf_register_info hf[] =\r\n{\r\n{ &hf_gsm_a_bssmap_msg_type,\r\n{ "BSSMAP Message Type", "gsm_a.bssmap.msgtype",\r\nFT_UINT8, BASE_HEX|BASE_EXT_STRING, &gsm_a_bssmap_msg_strings_ext, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_elem_id,\r\n{ "Element ID", "gsm_a.bssmap.elem_id",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_field_elem_id,\r\n{ "Field Element ID", "gsm_a.bssmap.field_elem_id",\r\nFT_UINT8, BASE_HEX, VALS(bssmap_field_element_ids), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_cell_ci,\r\n{ "Cell CI", "gsm_a.bssmap.cell_ci",\r\nFT_UINT16, BASE_HEX_DEC, 0, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_cell_lac,\r\n{ "Cell LAC", "gsm_a.bssmap.cell_lac",\r\nFT_UINT16, BASE_HEX_DEC, 0, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_sac,\r\n{ "SAC", "gsm_a.bssmap.sac",\r\nFT_UINT16, BASE_HEX, 0, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_dlci_cc,\r\n{ "Control Channel", "gsm_a.bssmap.dlci.cc",\r\nFT_UINT8, BASE_HEX, VALS(bssap_cc_values), 0xc0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_gsm_a_bssmap_dlci_spare,\r\n{ "Spare", "gsm_a.bssmap.dlci.spare",\r\nFT_UINT8, BASE_HEX, NULL, 0x38,\r\nNULL, HFILL}\r\n},\r\n{ &hf_gsm_a_bssmap_dlci_sapi,\r\n{ "SAPI", "gsm_a.bssmap.dlci.sapi",\r\nFT_UINT8, BASE_HEX, VALS(bssap_sapi_values), 0x07,\r\nNULL, HFILL}\r\n},\r\n{ &hf_gsm_a_bssmap_cause,\r\n{ "BSSMAP Cause", "gsm_a.bssmap.cause",\r\nFT_UINT8, BASE_HEX|BASE_RANGE_STRING, RVALS(gsm_a_bssap_cause_rvals), 0x7F,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_be_cell_id_disc,\r\n{ "Cell identification discriminator","gsm_a.bssmap.be.cell_id_disc",\r\nFT_UINT8,BASE_DEC|BASE_EXT_STRING, &gsm_a_be_cell_id_disc_vals_ext, 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_pci,\r\n{ "Preemption Capability indicator(PCI)","gsm_a.bssmap.pci",\r\nFT_BOOLEAN,8, TFS(&bssmap_pci_value), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_qa,\r\n{ "Queuing Allowed Indicator(QA)","gsm_a.bssmap.qa",\r\nFT_BOOLEAN,8, TFS(&tfs_allowed_not_allowed), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_pvi,\r\n{ "Preemption Vulnerability Indicator(PVI)","gsm_a.bssmap.pvi",\r\nFT_BOOLEAN,8, TFS(&bssmap_pvi_value), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_interference_bands,\r\n{ "Acceptable interference bands","gsm_a.bssmap.interference_bands",\r\nFT_UINT8, BASE_HEX, NULL, 0x01f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_lsa_only,\r\n{ "LSA only","gsm_a.bssmap.lsa_only",\r\nFT_BOOLEAN,8, TFS(&bssmap_lsa_only_value), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_act,\r\n{ "Active mode support","gsm_a.bssmap.act",\r\nFT_BOOLEAN,8, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_pref,\r\n{ "Preferential access","gsm_a.bssmap.pref",\r\nFT_BOOLEAN,8, NULL, 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_lsa_inf_prio,\r\n{ "Priority","gsm_a.bssmap.lsa_inf_prio",\r\nFT_UINT8,BASE_DEC, NULL, 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_seq_len,\r\n{ "Sequence Length","gsm_a.bssmap.seq_len",\r\nFT_UINT8,BASE_DEC, NULL, 0xf0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_seq_no,\r\n{ "Sequence Number","gsm_a.bssmap.seq_no",\r\nFT_UINT8,BASE_DEC, NULL, 0xf,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssap_cell_id_list_seg_cell_id_disc,\r\n{ "Cell identification discriminator","gsm_a.bssmap.cell_id_list_seg_cell_id_disc",\r\nFT_UINT8,BASE_DEC, VALS(gsm_a_bssap_cell_id_list_seg_cell_id_disc_vals), 0xf,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssap_res_ind_method,\r\n{ "Resource indication method","gsm_a.bssmap.res_ind_method",\r\nFT_UINT8,BASE_DEC, VALS(gsm_a_bssap_resource_indication_vals), 0xf,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssap_cic_list_range,\r\n{ "Range","gsm_a.bssmap.cic_list_range",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssap_cic_list_status,\r\n{ "Status","gsm_a.bssmap.cic_list_status",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssap_diag_error_pointer,\r\n{ "Error pointer","gsm_a.bssmap.diag_error_pointer",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssap_diag_msg_rcv,\r\n{ "Message received","gsm_a.bssmap.cic_list_status",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_ch_mode,\r\n{ "Channel mode","gsm_a.bssmap.cch_mode",\r\nFT_UINT8,BASE_DEC, VALS(gsm_a_bssmap_ch_mode_vals), 0xf0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_cur_ch_mode,\r\n{ "Channel Mode", "gsm_a.bssmap.fe_cur_chan_type2.chan_mode",\r\nFT_UINT8, BASE_HEX, VALS(chan_mode_vals), 0xf0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_channel,\r\n{ "Channel","gsm_a.bssmap.channel",\r\nFT_UINT8,BASE_DEC, VALS(gsm_a_bssmap_channel_vals), 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_trace_trigger_id,\r\n{ "Priority Indication","gsm_a.bssmap.trace_trigger_id",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_trace_priority_indication,\r\n{ "Priority Indication","gsm_a.bssmap.trace_priority_indication",\r\nFT_UINT8,BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_trace_bss_record_type,\r\n{ "BSS Record Type","gsm_a.bssmap.bss_record__type",\r\nFT_UINT8,BASE_DEC, VALS(gsm_a_bssmap_trace_bss_record_type_vals), 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_trace_msc_record_type,\r\n{ "MSC Record Type","gsm_a.bssmap.msc_record_type",\r\nFT_UINT8,BASE_DEC, VALS(gsm_a_bssmap_trace_msc_record_type_vals), 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_trace_invoking_event,\r\n{ "Invoking Event","gsm_a.bssmap.trace_invoking_event",\r\nFT_UINT8,BASE_DEC, VALS(gsm_a_bssmap_trace_invoking_event_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_trace_reference,\r\n{ "Trace Reference","gsm_a.bssmap.trace_id",\r\nFT_UINT16,BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_trace_omc_id,\r\n{ "OMC ID","gsm_a.bssmap.trace_omc_id",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_be_rnc_id,\r\n{ "RNC-ID","gsm_a.bssmap.be.rnc_id",\r\nFT_UINT16,BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_apdu_protocol_id,\r\n{ "Protocol ID", "gsm_a.bssmap.apdu_protocol_id",\r\nFT_UINT8, BASE_DEC, VALS(gsm_a_apdu_protocol_id_strings), 0x0,\r\n"APDU embedded protocol id", HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_periodicity,\r\n{ "Periodicity", "gsm_a.bssmap.periodicity",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_sm,\r\n{ "Subsequent Mode","gsm_a.bssmap.sm",\r\nFT_BOOLEAN,8, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_tarr,\r\n{ "Total Accessible Resource Requested","gsm_a.bssmap.tarr",\r\nFT_BOOLEAN,8, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_tot_no_of_fullr_ch,\r\n{ "Total number of accessible full rate channels", "gsm_a.bssmap.tot_no_of_fullr_ch",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_tot_no_of_hr_ch,\r\n{ "Total number of accessible half rate channels", "gsm_a.bssmap.tot_no_of_hr_ch",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_lsa_id,\r\n{ "Identification of Localised Service Area", "gsm_a.bssmap.lsa_id",\r\nFT_UINT24, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_ep,\r\n{ "EP", "gsm_a.bssmap.ep",\r\nFT_UINT8, BASE_DEC, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_smi,\r\n{ "Subsequent Modification Indication(SMI)", "gsm_a.bssmap.smi",\r\nFT_UINT8, BASE_DEC, VALS(gsm_a_bssmap_smi_vals), 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_lcs_pri,\r\n{ "Periodicity", "gsm_a.bssmap.lcs_pri",\r\nFT_UINT8, BASE_DEC, VALS(lcs_priority_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_num_ms,\r\n{ "Number of handover candidates", "gsm_a.bssmap.num_ms",\r\nFT_UINT8, BASE_DEC,NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_talker_pri,\r\n{ "Priority", "gsm_a.bssmap.talker_pri",\r\nFT_UINT8, BASE_DEC,VALS(gsm_a_bssmap_talker_pri_vals), 0x03,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_rr_mode,\r\n{ "RR mode", "gsm_a.bssmap.rr_mode",\r\nFT_UINT8, BASE_DEC, VALS(gsm_a_bssmap_rr_mode_vals), 0xc0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_group_cipher_key_nb,\r\n{ "Group cipher key number", "gsm_a.bssmap.group_cipher_key_nb",\r\nFT_UINT8, BASE_DEC, VALS(gsm_a_bssmap_group_cipher_key_nb_vals), 0x3c,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_vgcs_vbs_cell_status,\r\n{ "Status", "gsm_a.bssmap.vgcs_vbs_cell_status",\r\nFT_UINT8, BASE_DEC, VALS(gsm_a_bssmap_vgcs_vbs_cell_status_vals), 0x07,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_paging_cause,\r\n{ "Paging Cause", "gsm_a.bssmap.paging_cause",\r\nFT_UINT8, BASE_DEC,VALS(gsm_a_bssmap_paging_cause_vals), 0x06,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_paging_inf_flg,\r\n{ "VGCS/VBS flag","gsm_a.bssmap.paging_inf_flg",\r\nFT_BOOLEAN,8, TFS(&bssmap_paging_inf_flg_value), 0x01,\r\n"If 1, a member of a VGCS/VBS-group", HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_serv_ho_inf,\r\n{ "Service Handover information", "gsm_a.bssmap.serv_ho_inf",\r\nFT_UINT8, BASE_HEX, NULL, 0x07,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_max_nb_traffic_chan,\r\n{ "Maximum Number of Traffic Channels", "gsm_a.bssmap.max_nb_traffic_chan",\r\nFT_UINT8, BASE_DEC, VALS(gsm_a_max_nb_traffic_chan_vals), 0x07,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_acceptable_chan_coding_bit5,\r\n{ "TCH/F43.2", "gsm_a.bssmap.acceptable_chan_coding_bit5",\r\nFT_BOOLEAN, 8, TFS(&gsm_a_bssmap_accept_not_accept_vals), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_acceptable_chan_coding_bit4,\r\n{ "TCH/F43.2", "gsm_a.bssmap.acceptable_chan_coding_bit4",\r\nFT_BOOLEAN, 8, TFS(&gsm_a_bssmap_accept_not_accept_vals), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_acceptable_chan_coding_bit3,\r\n{ "TCH/F43.2", "gsm_a.bssmap.acceptable_chan_coding_bit3",\r\nFT_BOOLEAN, 8, TFS(&gsm_a_bssmap_accept_not_accept_vals), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_acceptable_chan_coding_bit2,\r\n{ "TCH/F43.2", "gsm_a.bssmap.acceptable_chan_coding_bit2",\r\nFT_BOOLEAN, 8, TFS(&gsm_a_bssmap_accept_not_accept_vals), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_acceptable_chan_coding_bit1,\r\n{ "TCH/F43.2", "gsm_a.bssmap.acceptable_chan_coding_bit1",\r\nFT_BOOLEAN, 8, TFS(&gsm_a_bssmap_accept_not_accept_vals), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_allowed_data_rate_bit8,\r\n{ "43.5 kbit/s (TCH/F43.2)", "gsm_a.bssmap.allowed_data_rate_bit8",\r\nFT_BOOLEAN, 8, TFS(&tfs_allowed_not_allowed), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_allowed_data_rate_bit7,\r\n{ "32.0 kbit/s (TCH/F32.0)", "gsm_a.bssmap.allowed_data_rate_bit7",\r\nFT_BOOLEAN, 8, TFS(&tfs_allowed_not_allowed), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_allowed_data_rate_bit6,\r\n{ "29.0 kbit/s (TCH/F28.8)", "gsm_a.bssmap.allowed_data_rate_bit6",\r\nFT_BOOLEAN, 8, TFS(&tfs_allowed_not_allowed), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_allowed_data_rate_bit5,\r\n{ "14.5/14.4 kbit/s (TCH/F14.4)", "gsm_a.bssmap.allowed_data_rate_bit5",\r\nFT_BOOLEAN, 8, TFS(&tfs_allowed_not_allowed), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_allowed_data_rate_bit4,\r\n{ "12.0/9.6 kbit/s (TCH F/9.6)", "gsm_a.bssmap.allowed_data_rate_bit4",\r\nFT_BOOLEAN, 8, TFS(&tfs_allowed_not_allowed), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_vstk_rand,\r\n{ "VSTK_RAND", "gsm_a.bssmap.vstk_rand",\r\nFT_UINT64, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_vstk,\r\n{ "VSTK", "gsm_a.bssmap.vstk",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_spare_bits,\r\n{ "Spare bit(s)", "gsm_a.bssmap.spare_bits",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_tpind,\r\n{ "Talker priority indicator (TP Ind)","gsm_a.bssmap.tpind",\r\nFT_BOOLEAN,8, TFS(&gsm_bssmap_tpind_vals), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_asind_b2,\r\n{ "A-interface resource sharing indicator (AS Ind) bit 2","gsm_a.bssmap.asind_b2",\r\nFT_BOOLEAN,8, TFS(&gsm_bssmap_asind_b2_vals), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_asind_b3,\r\n{ "A-interface resource sharing indicator (AS Ind) bit 3","gsm_a.bssmap.asind_b3",\r\nFT_BOOLEAN,8, TFS(&gsm_bssmap_asind_b3_vals), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_bss_res,\r\n{ "Group or broadcast call re-establishment by the BSS indicator","gsm_a.bssmap.bss_res",\r\nFT_BOOLEAN,8, TFS(&gsm_bssmap_bss_res_vals), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_tcp,\r\n{ "Talker Channel Parameter (TCP)","gsm_a.bssmap.tcp",\r\nFT_BOOLEAN,8, TFS(&gsm_bssmap_bss_tcp_vals), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_filler_bits,\r\n{ "Filler Bits","gsm_a.bssmap.filler_bits",\r\nFT_UINT8, BASE_DEC,NULL, 0x07,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_method,\r\n{ "Method","gsm_a.bssmap.method",\r\nFT_UINT8, BASE_DEC,VALS(gsm_a_bssmap_method_vals), 0xc0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_ganss_id,\r\n{ "GANSS Id","gsm_a.bssmap.ganss_id",\r\nFT_UINT8, BASE_DEC,VALS(gsm_a_bssmap_ganss_id_vals), 0x38,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_usage,\r\n{ "Usage","gsm_a.bssmap.usage",\r\nFT_UINT8, BASE_DEC,VALS(gsm_a_bssmap_usage_vals), 0x07,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_data_id,\r\n{ "Data Identity","gsm_a.bssmap.data_id",\r\nFT_UINT8, BASE_DEC_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_bt_ind,\r\n{ "BT Ind","gsm_a.bssmap.bt_ind",\r\nFT_BOOLEAN, 8, TFS(&gsm_a_bssmap_bt_ind_val), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_aoip_trans_ipv4,\r\n{ "Transport Layer Address (IPv4)","gsm_a.bssmap.aoip_trans_ipv4",\r\nFT_IPv4,BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_aoip_trans_ipv6,\r\n{ "Transport Layer Address (IPv6)","gsm_a.bssmap.aoip_trans_ipv6",\r\nFT_IPv6,BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_aoip_trans_port,\r\n{ "UDP Port","gsm_a.bssmap.aoip_trans_port",\r\nFT_UINT16, BASE_DEC,NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_fi,\r\n{ "FI(Full IP)","gsm_a.bssmap.fi",\r\nFT_BOOLEAN,8, TFS(&bssmap_fi_vals), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_pi,\r\n{ "PI","gsm_a.bssmap.pi",\r\nFT_BOOLEAN,8, TFS(&bssmap_pi_vals), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_pt,\r\n{ "PT","gsm_a.bssmap.pt",\r\nFT_BOOLEAN,8, TFS(&bssmap_pt_vals), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_tf,\r\n{ "TF","gsm_a.bssmap.tf",\r\nFT_BOOLEAN,8, TFS(&bssmap_tf_vals), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssap_speech_codec,\r\n{ "Codec Type","gsm_a.bssmap.speech_codec",\r\nFT_UINT8, BASE_DEC|BASE_EXT_STRING, &bssap_speech_codec_values_ext, 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssap_extended_codec,\r\n{ "Extended Codec Type","gsm_a.bssmap.extended_codec",\r\nFT_UINT8, BASE_DEC, VALS(bssap_extended_codec_values), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssap_extended_codec_r2,\r\n{ "Redundancy Level 2","gsm_a.bssmap.r2",\r\nFT_BOOLEAN,8, TFS(&tfs_supported_not_supported), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssap_extended_codec_r3,\r\n{ "Redundancy Level 3","gsm_a.bssmap.r3",\r\nFT_BOOLEAN,8, TFS(&tfs_supported_not_supported), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_fi2,\r\n{ "FI(Full IP)","gsm_a.bssmap.fi2",\r\nFT_BOOLEAN,8, TFS(&bssmap_fi2_vals), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_pi2,\r\n{ "PI","gsm_a.bssmap.pi2",\r\nFT_BOOLEAN,8, TFS(&bssmap_pi2_vals), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_pt2,\r\n{ "PT","gsm_a.bssmap.pt2",\r\nFT_BOOLEAN,8, TFS(&bssmap_pt2_vals), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_tf2,\r\n{ "TF","gsm_a.bssmap.tf2",\r\nFT_BOOLEAN,8, TFS(&bssmap_tf2_vals), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_call_id,\r\n{ "Call Identifier","gsm_a.bssmap.callid",\r\nFT_UINT32, BASE_DEC,NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_spare,\r\n{ "Spare", "gsm_a.bssmap.spare",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_gsm_a_bssmap_positioning_data_discriminator,\r\n{ "Positioning Data Discriminator", "gsm_a.bssmap.posData.discriminator",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_positioning_method,\r\n{ "Positioning method", "gsm_a.bssmap.posData.method",\r\nFT_UINT8, BASE_HEX, VALS(bssmap_positioning_methods), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_positioning_method_usage,\r\n{ "Usage", "gsm_a.bssmap.posData.usage",\r\nFT_UINT8, BASE_HEX, VALS(bssmap_positioning_methods_usage), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_location_type_location_information,\r\n{ "Location Information", "gsm_a.bssmap.locationType.locationInformation",\r\nFT_UINT8, BASE_HEX, VALS(bssmap_location_information_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_location_type_positioning_method,\r\n{ "Positioning Method", "gsm_a.bssmap.locationType.positioningMethod",\r\nFT_UINT8, BASE_HEX, VALS(bssmap_positioning_method_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_chan_type_extension,\r\n{ "Extension", "gsm_a.bssmap.chanType.permittedIndicator.extension",\r\nFT_BOOLEAN, 8, TFS(&bssmap_chan_type_extension_value), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_cause_extension,\r\n{ "Extension", "gsm_a.bssmap.causeType.extension",\r\nFT_BOOLEAN, 8, TFS(&bssmap_cause_extension_value), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_ass_req,\r\n{ "Assignment Requirement", "gsm_a.bssmap.assignment_requirement",\r\nFT_UINT8, BASE_HEX, VALS(gsm_a_bssmap_assignment_requirement_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_emlpp_prio,\r\n{ "eMLPP Priority", "gsm_a.bssmap.emlpp_priority",\r\nFT_UINT8, BASE_HEX, VALS(gsm_a_bssmap_call_priority_vals), 0x07,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_rip,\r\n{ "RIP", "gsm_a.bssmap.rip",\r\nFT_BOOLEAN, 8, TFS(&gsm_a_bssmap_rip_value), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_rtd,\r\n{ "RTD", "gsm_a.bssmap.rtd",\r\nFT_BOOLEAN, 8, TFS(&gsm_a_bssmap_rtd_value), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_kc128,\r\n{ "Kc128", "gsm_a.bssmap.kc128",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_csg_id,\r\n{ "CSG Identity", "gsm_a.bssmap.csg_id",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_cell_access_mode,\r\n{ "Cell Access Mode", "gsm_a.bssmap.cell_access_mode",\r\nFT_BOOLEAN, BASE_NONE, TFS(&gsm_a_bssmap_cell_access_mode_value), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_fe_extra_info_prec,\r\n{ "Pre-emption Recommendation", "gsm_a.bssmap.fe_extra_info.prec",\r\nFT_UINT8, BASE_DEC, VALS(fe_extra_info_prec_vals), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_fe_extra_info_lcs,\r\n{ "LCS Information", "gsm_a.bssmap.fe_extra_info.lcs",\r\nFT_UINT8, BASE_DEC, VALS(fe_extra_info_lcs_vals), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_fe_extra_info_ue_prob,\r\n{ "UE support of UMTS", "gsm_a.bssmap.fe_extra_info.ue_prob",\r\nFT_UINT8, BASE_DEC, VALS(fe_extra_info_ue_prob_vals), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_fe_extra_info_spare,\r\n{ "Extra Information Spare bits", "gsm_a.bssmap.fe_extra_info.spare",\r\nFT_UINT8, BASE_HEX, NULL, 0xf8,\r\nNULL, HFILL }\r\n},\r\n{ &hf_fe_cur_chan_type2_chan_mode,\r\n{ "Channel Mode", "gsm_a.bssmap.fe_cur_chan_type2.chan_mode",\r\nFT_UINT8, BASE_HEX, VALS(chan_mode_vals), 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_fe_cur_chan_type2_chan_mode_spare,\r\n{ "Channel Mode Spare bits", "gsm_a.bssmap.fe_cur_chan_type2_chan_mode.spare",\r\nFT_UINT8, BASE_HEX, NULL, 0xf0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_fe_cur_chan_type2_chan_field,\r\n{ "Channel Field", "gsm_a.bssmap.fe_cur_chan_type2.chan_field",\r\nFT_UINT8, BASE_HEX, VALS(fe_cur_chan_type2_chan_field_vals),0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_fe_cur_chan_type2_chan_field_spare,\r\n{ "Channel field Spare bits", "gsm_a.bssmap.fe_cur_chan_type2_chan_field.spare",\r\nFT_UINT8, BASE_HEX, NULL, 0xf0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_fe_target_radio_cell_info_rxlev_ncell,\r\n{ "RXLEV-NCELL", "gsm_a.bssmap.fe_target_radio_cell_info.rxlev_ncell",\r\nFT_UINT8, BASE_HEX|BASE_EXT_STRING, &gsm_a_rr_rxlev_vals_ext, 0x3f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_fe_target_radio_cell_info_rxlev_ncell_spare,\r\n{ "RXLEV-NCELL Spare bits", "gsm_a.bssmap.fe_target_radio_cell_info.rxlev_ncell_spare",\r\nFT_UINT8, BASE_HEX, NULL, 0xc0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_fe_dtm_info_dtm_ind,\r\n{ "DTM indicator", "gsm_a.bssmap.fe_dtm_info.dtm_ind",\r\nFT_UINT8, BASE_HEX, VALS(gsm_a_bssmap_dtm_info_dtm_ind_vals), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_fe_dtm_info_sto_ind,\r\n{ "Time Slot Operation indicator", "gsm_a.bssmap.fe_dtm_info.sto_ind",\r\nFT_UINT8, BASE_HEX, VALS(gsm_a_bssmap_dtm_info_sto_ind_vals), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_fe_dtm_info_egprs_ind,\r\n{ "EGPRS indicator", "gsm_a.bssmap.fe_dtm_info.egprs_ind",\r\nFT_UINT8, BASE_HEX, VALS(gsm_a_bssmap_dtm_info_egprs_ind_vals), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_fe_dtm_info_spare_bits,\r\n{ "DTM Info Spare bits", "gsm_a.bssmap.fe_dtm_info.spare_bits",\r\nFT_UINT8, BASE_HEX, NULL, 0xf8,\r\nNULL, HFILL }\r\n},\r\n{ &hf_fe_cell_load_info_cell_capacity_class,\r\n{ "Cell capacity class", "gsm_a.bssmap.fe_cell_load_info.cell_capacity_class",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_fe_cell_load_info_load_value,\r\n{ "Load value", "gsm_a.bssmap.fe_cell_load_info.load_info",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_fe_cell_load_info_rt_load_value,\r\n{ "Realtime load value", "gsm_a.bssmap.fe_cell_load_info.rt_load_value",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_fe_cell_load_info_nrt_load_information_value,\r\n{ "Non-Realtime load information value", "gsm_a.bssmap.fe_cell_load_info.nrt_load_info_value",\r\nFT_UINT8, BASE_HEX, VALS(gsm_a_bssmap_cell_load_nrt_vals), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_fe_ps_indication,\r\n{ "PS Indication", "gsm_a.bssmap.fe_ps_indication.value",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_fe_dtm_ho_command_ind_spare,\r\n{ "Spare octet", "gsm_a.bssmap.fe_dtm_ho_command_ind.spare",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_speech_data_ind,\r\n{ "Speech/Data Indicator", "gsm_a.bssmap.speech_data_ind",\r\nFT_UINT8, BASE_DEC, VALS(gsm_a_bssap_speech_data_ind_vals), 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_channel_rate_and_type,\r\n{ "Channel Rate and Type", "gsm_a.bssmap.perm_speech_v_ind",\r\nFT_UINT8, BASE_DEC, VALS(gsm_a_bssap_channel_rate_and_type_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_perm_speech_v_ind,\r\n{ "Permitted speech version indication", "gsm_a.bssmap.perm_speech_v_ind",\r\nFT_UINT8, BASE_HEX|BASE_RANGE_STRING, RVALS(speech_version_id_rvals), 0x7f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_reroute_rej_cause,\r\n{ "Reroute Reject cause", "gsm_a.bssmap.reroute_rej_cause",\r\nFT_UINT8, BASE_HEX, VALS(gsm_a_bssap_reroute_rej_cause_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_send_seqn,\r\n{ "Send Sequence Number", "gsm_a.bssmap.reroute_rej_cause",\r\nFT_UINT8, BASE_HEX, NULL, 0xc0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_reroute_outcome,\r\n{ "Outcome", "gsm_a.bssmap.reroute_outcome",\r\nFT_UINT8, BASE_HEX, VALS(gsm_a_bssap_reroute_outcome_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_lcls_conf,\r\n{ "LCLS-Configuration", "gsm_a.bssmap.lcls_conf",\r\nFT_UINT8, BASE_HEX, VALS(gsm_a_bssap_lcls_conf_vals), 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_lcls_con_status_control,\r\n{ "LCLS-Connection-Status-Control", "gsm_a.bssmap.lcls_con_status_control",\r\nFT_UINT8, BASE_HEX, VALS(gsm_a_bssap_lcls_con_status_control_vals), 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_lcls_bss_status,\r\n{ "LCLS-BSS-Status", "gsm_a.bssmap.lcls_bss_status",\r\nFT_UINT8, BASE_HEX, VALS(gsm_a_bssmap_lcls_bss_status_vals), 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_selected_plmn_id,\r\n{ "Selected PLMN ID", "gsm_a.bssmap.selected_plmn_id",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gsm_a_bssmap_pcm_multiplexer, { "PCM Multiplexer", "gsm_a_bssmap.pcm_multiplexer", FT_UINT16, BASE_DEC, NULL, 0xffe0, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_timeslot, { "Timeslot", "gsm_a_bssmap.timeslot", FT_UINT16, BASE_DEC, NULL, 0x001f, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_full_rate_channels_available, { "Number of full rate channels available in band", "gsm_a_bssmap.full_rate_channels_available", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_half_rate_channels_available, { "Number of half rate channels available in band", "gsm_a_bssmap.half_rate_channels_available", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_cause_class, { "Cause Class", "gsm_a_bssmap.cause_class", FT_UINT8, BASE_DEC, VALS(cause_class_vals), 0x70, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_national_cause, { "National Cause", "gsm_a_bssmap.national_cause", FT_UINT8, BASE_DEC, NULL, 0x0f, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_cause_value, { "Cause Value", "gsm_a_bssmap.cause_value", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_cause16, { "Cause", "gsm_a_bssmap.cause", FT_UINT16, BASE_DEC, NULL, 0x07ff, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_ti_flag, { "TI flag", "gsm_a_bssmap.ti_flag", FT_BOOLEAN, 8, TFS(&tfs_allocated_by_receiver_sender), 0x08, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_tio, { "TIO", "gsm_a_bssmap.tio", FT_UINT8, BASE_DEC, NULL, 0x07, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_enc_info_key, { "Key", "gsm_a_bssmap.enc_info_key", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_transparent_service, { "Service", "gsm_a_bssmap.transparent_service", FT_BOOLEAN, 8, TFS(&tfs_non_transparent_transparent), 0x40, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_rate, { "Rate", "gsm_a_bssmap.rate", FT_UINT8, BASE_DEC, NULL, 0x3f, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_tch_14_5kb, { "14.5 kbit/s (TCH/F14.4)", "gsm_a_bssmap.tch_14_5kb", FT_BOOLEAN, 8, TFS(&tfs_allowed_not_allowed), 0x08, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_tch_12kb, { "12.0 kbit/s (TCH F/9.6)", "gsm_a_bssmap.tch_12kb", FT_BOOLEAN, 8, TFS(&tfs_allowed_not_allowed), 0x02, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_tch_6kb, { "6.0 kbit/s (TCH F/4.8)", "gsm_a_bssmap.tch_6kb", FT_BOOLEAN, 8, TFS(&tfs_allowed_not_allowed), 0x01, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_tch_14_5_14_4kb, { "14.5/14.4 kbit/s (TCH/F14.4)", "gsm_a_bssmap.tch_14_5_14_4kb", FT_BOOLEAN, 8, NULL, 0x08, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_tch_12_9kb, { "12.0/9.6 kbit/s (TCH F/9.6)", "gsm_a_bssmap.tch_12_9kb", FT_BOOLEAN, 8, NULL, 0x02, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_tch_6_4_8kb, { "6.0/4.8 kbit/s (TCH F/4.8)", "gsm_a_bssmap.tch_6_4_8kb", FT_BOOLEAN, 8, NULL, 0x01, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_unknown_format, { "Unknown format", "gsm_a_bssmap.unknown_format", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_cell_id_unknown_format, { "Cell ID - Unknown format", "gsm_a_bssmap.cell_id.unknown_format", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_priority_level, { "Priority Level", "gsm_a_bssmap.priority_level", FT_UINT8, BASE_DEC|BASE_RANGE_STRING, RVALS(bssmap_prio_rvals), 0x3c, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_layer_3_information_value, { "Layer 3 Information value", "gsm_a_bssmap.layer_3_information_value", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_bss_activate_downlink, { "BSS can to activate DTX in the downlink direction", "gsm_a_bssmap.bss_activate_downlink", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x01, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_imeisv_included, { "IMEISV must be included by the mobile station", "gsm_a_bssmap.imeisv_included", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x01, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_algorithm_identifier, { "Algorithm Identifier", "gsm_a_bssmap.algorithm_identifier", FT_UINT8, BASE_DEC, VALS(gsm_a_bssmap_algorithm_id_vals), 0x0, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_circuit_pool_number, { "Circuit pool number", "gsm_a_bssmap.circuit_pool_number", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_qri, { "qri recommended queuing", "gsm_a_bssmap.qri", FT_BOOLEAN, 8, TFS(&tfs_allowed_not_allowed), 0x02, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_speech_version_id, { "Speech version identifier", "gsm_a_bssmap.speech_version_id", FT_UINT8, BASE_DEC|BASE_RANGE_STRING, RVALS(speech_version_id_rvals), 0x7f, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_apdu, { "APDU", "gsm_a_bssmap.apdu", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_talker_identity_field, { "Talker Identity field", "gsm_a_bssmap.talker_identity_field", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_s0_s15, { "S0 - S15", "gsm_a_bssmap.s0_s15", FT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_s0_s7, { "S0 - S7", "gsm_a_bssmap.s0_s7", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_all_call_identifiers_resources_released, { "all resources and references associated to all Call Identifiers in use between the BSC and the MSC need to be released", "gsm_a_bssmap.all_call_identifiers_resources_released", FT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_message_elements, { "Message Elements", "gsm_a_bssmap.message_elements", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_layer3_message_contents, { "Layer 3 Message Contents", "gsm_a_bssmap.layer3_message_contents", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_gsm_a5_1, { "GSM A5/1", "gsm_a_bssmap.gsm_a5_1", FT_BOOLEAN, 8, TFS(&tfs_permitted_not_permitted), 0x02, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_gsm_a5_2, { "GSM A5/2", "gsm_a_bssmap.gsm_a5_2", FT_BOOLEAN, 8, TFS(&tfs_permitted_not_permitted), 0x04, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_gsm_a5_3, { "GSM A5/3", "gsm_a_bssmap.gsm_a5_3", FT_BOOLEAN, 8, TFS(&tfs_permitted_not_permitted), 0x08, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_gsm_a5_4, { "GSM A5/4", "gsm_a_bssmap.gsm_a5_4", FT_BOOLEAN, 8, TFS(&tfs_permitted_not_permitted), 0x10, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_gsm_a5_5, { "GSM A5/5", "gsm_a_bssmap.gsm_a5_5", FT_BOOLEAN, 8, TFS(&tfs_permitted_not_permitted), 0x20, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_gsm_a5_6, { "GSM A5/6", "gsm_a_bssmap.gsm_a5_6", FT_BOOLEAN, 8, TFS(&tfs_permitted_not_permitted), 0x40, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_gsm_a5_7, { "GSM A5/7", "gsm_a_bssmap.gsm_a5_7", FT_BOOLEAN, 8, TFS(&tfs_permitted_not_permitted), 0x80, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_no_encryption, { "No encryption", "gsm_a_bssmap.no_encryption", FT_BOOLEAN, 8, TFS(&tfs_permitted_not_permitted), 0x01, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_data_channel_rate_and_type, { "Channel rate and type", "gsm_a_bssmap.channel_rate_and_type", FT_UINT8, BASE_DEC|BASE_RANGE_STRING, RVALS(gsm_a_bssap_channel_rate_and_type_rvals), 0x7f, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_cell_discriminator, { "Cell Discriminator", "gsm_a_bssmap.cell_discriminator", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_gsm_a_bssmap_forward_indicator, { "Forward indicator", "gsm_a_bssmap.forward_indicator", FT_UINT8, BASE_DEC|BASE_RANGE_STRING, RVALS(forward_indicator_rvals), 0x0f, NULL, HFILL }},\r\n};\r\nexpert_module_t* expert_gsm_a_bssmap;\r\nstatic ei_register_info ei[] = {\r\n{ &ei_gsm_a_bssmap_extraneous_data, { "gsm_a_bssmap.extraneous_data", PI_PROTOCOL, PI_NOTE, "Extraneous Data, dissector bug or later version spec(report to wireshark.org)", EXPFILL }},\r\n{ &ei_gsm_a_bssmap_not_decoded_yet, { "gsm_a_bssmap.not_decoded_yet", PI_UNDECODED, PI_WARN, "Not decoded yet", EXPFILL }},\r\n{ &ei_gsm_a_bssap_unknown_codec, { "gsm_a_bssmap.unknown_codec", PI_PROTOCOL, PI_WARN, "Unknown codec - the rest of the dissection my be suspect", EXPFILL }},\r\n{ &ei_gsm_a_bssmap_bogus_length, { "gsm_a_bssmap.bogus_length", PI_PROTOCOL, PI_WARN, "Bogus length", EXPFILL }},\r\n{ &ei_gsm_a_bssmap_missing_mandatory_element, { "gsm_a_bssmap.missing_mandatory_element", PI_PROTOCOL, PI_WARN, "Missing Mandatory element, rest of dissection is suspect", EXPFILL }},\r\n};\r\n#define NUM_INDIVIDUAL_ELEMS 5\r\ngint *ett[NUM_INDIVIDUAL_ELEMS + NUM_GSM_BSSMAP_MSG +\r\nNUM_GSM_BSSMAP_ELEM];\r\nett[0] = &ett_bssmap_msg;\r\nett[1] = &ett_cell_list;\r\nett[2] = &ett_dlci;\r\nett[3] = &ett_codec_lst,\r\nett[4] = &ett_bss_to_bss_info,\r\nlast_offset = NUM_INDIVIDUAL_ELEMS;\r\nfor (i=0; i < NUM_GSM_BSSMAP_MSG; i++, last_offset++)\r\n{\r\nett_gsm_bssmap_msg[i] = -1;\r\nett[last_offset] = &ett_gsm_bssmap_msg[i];\r\n}\r\nfor (i=0; i < NUM_GSM_BSSMAP_ELEM; i++, last_offset++)\r\n{\r\nett_gsm_bssmap_elem[i] = -1;\r\nett[last_offset] = &ett_gsm_bssmap_elem[i];\r\n}\r\nproto_a_bssmap =\r\nproto_register_protocol("GSM A-I/F BSSMAP", "GSM BSSMAP", "gsm_a.bssmap");\r\nproto_register_field_array(proto_a_bssmap, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_gsm_a_bssmap = expert_register_protocol(proto_a_bssmap);\r\nexpert_register_field_array(expert_gsm_a_bssmap, ei, array_length(ei));\r\nregister_dissector("gsm_a_bssmap", dissect_bssmap, proto_a_bssmap);\r\n}\r\nvoid\r\nproto_reg_handoff_gsm_a_bssmap(void)\r\n{\r\ndissector_handle_t bssmap_handle;\r\nbssmap_handle = find_dissector("gsm_a_bssmap");\r\ndissector_add_uint("bssap.pdu_type", GSM_A_PDU_TYPE_BSSMAP, bssmap_handle);\r\ndtap_handle = find_dissector_add_dependency("gsm_a_dtap", proto_a_bssmap);\r\ngsm_bsslap_handle = find_dissector_add_dependency("gsm_bsslap", proto_a_bssmap);\r\nbssgp_handle = find_dissector_add_dependency("bssgp", proto_a_bssmap);\r\nrrc_handle = find_dissector_add_dependency("rrc", proto_a_bssmap);\r\n}
