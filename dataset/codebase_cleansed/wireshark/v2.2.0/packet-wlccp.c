static int\r\ndissect_wlccp(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nproto_item *ti;\r\nproto_tree *wlccp_tree, *wlccp_sap_tree, *wlccp_type_tree;\r\nguint offset = 0, old_offset;\r\nguint8 version=0, sap_id=0;\r\nguint16 type;\r\nguint8 base_message_type=0, message_sub_type=0;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "WLCCP");\r\nif(tvb_get_guint8(tvb, 0) == 0xC1)\r\n{\r\nsap_id = tvb_get_guint8(tvb,1) & SAP_VALUE_MASK;\r\nbase_message_type=(tvb_get_guint8(tvb,6)) & MT_BASE_MSG_TYPE;\r\nmessage_sub_type=(tvb_get_guint8(tvb, 6) & MT_SUBTYPE ) >> 6;\r\nswitch (sap_id)\r\n{\r\ncase WLCCP_SAP_CCM:\r\n{\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "Message Type: %-27s SubType: %s",\r\nval_to_str_const(base_message_type, wlccp_msg_type_vs_0, "Unknown"),\r\nval_to_str_const(message_sub_type, wlccp_subtype_vs, "Unknown"));\r\nbreak;\r\n}\r\ncase WLCCP_SAP_SEC:\r\n{\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "Message Type: %-27s SubType: %s",\r\nval_to_str_const(base_message_type, wlccp_msg_type_vs_1, "Unknown"),\r\nval_to_str_const(message_sub_type, wlccp_subtype_vs, "Unknown"));\r\nbreak;\r\n}\r\ncase WLCCP_SAP_RRM:\r\n{\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "Message Type: %-27s SubType: %s",\r\nval_to_str_const(base_message_type, wlccp_msg_type_vs_2, "Unknown"),\r\nval_to_str_const(message_sub_type, wlccp_subtype_vs, "Unknown"));\r\nbreak;\r\n}\r\ncase WLCCP_SAP_QOS:\r\n{\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "Message Type: %-27s SubType: %s",\r\nval_to_str_const(base_message_type, wlccp_msg_type_vs_3, "Unknown"),\r\nval_to_str_const(message_sub_type, wlccp_subtype_vs, "Unknown"));\r\nbreak;\r\n}\r\ncase WLCCP_SAP_NM:\r\n{\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "Message Type: %-27s SubType: %s",\r\nval_to_str_const(base_message_type, wlccp_msg_type_vs_4, "Unknown"),\r\nval_to_str_const(message_sub_type, wlccp_subtype_vs, "Unknown"));\r\nbreak;\r\n}\r\ncase WLCCP_SAP_MIP:\r\n{\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "Message Type: %-27s SubType: %s",\r\nval_to_str_const(base_message_type, wlccp_msg_type_vs_5, "Unknown"),\r\nval_to_str_const(message_sub_type, wlccp_subtype_vs, "Unknown"));\r\nbreak;\r\n}\r\ndefault:\r\n{\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "Message Type: %-27s SubType: %s", "Unknown",\r\nval_to_str_const(message_sub_type, wlccp_subtype_vs, "Unknown"));\r\nbreak;\r\n}\r\n}\r\n}\r\nif (tree) {\r\nti = proto_tree_add_item(tree, proto_wlccp, tvb, 0, -1, ENC_NA);\r\nwlccp_tree = proto_item_add_subtree(ti, ett_wlccp);\r\nproto_tree_add_item(wlccp_tree, hf_wlccp_version,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\nversion = tvb_get_guint8(tvb, 0);\r\noffset += 1;\r\nif(version == 0x0) {\r\nproto_tree_add_item(wlccp_tree, hf_wlccp_length,\r\ntvb, 1, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(wlccp_tree, hf_wlccp_type,\r\ntvb, 2, 2, ENC_BIG_ENDIAN);\r\ntype = tvb_get_ntohs(tvb, 2);\r\nproto_tree_add_item(wlccp_tree, hf_wlccp_dstmac,\r\ntvb, 4, 6, ENC_NA);\r\nproto_tree_add_item(wlccp_tree, hf_wlccp_srcmac,\r\ntvb, 10, 6, ENC_NA);\r\nif(type == 0x4081) {\r\nproto_tree_add_item(wlccp_tree, hf_wlccp_ipv4_address,\r\ntvb, 38, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(wlccp_tree, hf_wlccp_hostname,\r\ntvb, 44, 28, ENC_ASCII|ENC_NA);\r\n}\r\n}\r\nif(version == 0xC1)\r\n{\r\n{\r\nti = proto_tree_add_item(wlccp_tree, hf_wlccp_sap,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\nwlccp_sap_tree = proto_item_add_subtree(ti, ett_wlccp_sap_tree);\r\nproto_tree_add_item(wlccp_sap_tree, hf_wlccp_sap_version,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(wlccp_sap_tree, hf_wlccp_sap_id,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\nsap_id = tvb_get_guint8(tvb,offset) & SAP_VALUE_MASK;\r\noffset += 1;\r\n}\r\nproto_tree_add_item(wlccp_tree, hf_wlccp_destination_node_type,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(wlccp_tree, hf_wlccp_length,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n{\r\nti = proto_tree_add_item(wlccp_tree, hf_wlccp_type,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\nwlccp_type_tree = proto_item_add_subtree(ti, ett_wlccp_type);\r\nproto_tree_add_item(wlccp_type_tree, hf_wlccp_subtype,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\nswitch (sap_id)\r\n{\r\ncase WLCCP_SAP_CCM:\r\n{\r\nproto_tree_add_item(wlccp_type_tree, hf_wlccp_base_message_type_0,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\ncase WLCCP_SAP_SEC:\r\n{\r\nproto_tree_add_item(wlccp_type_tree, hf_wlccp_base_message_type_1,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\ncase WLCCP_SAP_RRM:\r\n{\r\nproto_tree_add_item(wlccp_type_tree, hf_wlccp_base_message_type_2,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\ncase WLCCP_SAP_QOS:\r\n{\r\nproto_tree_add_item(wlccp_type_tree, hf_wlccp_base_message_type_3,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\ncase WLCCP_SAP_NM:\r\n{\r\nproto_tree_add_item(wlccp_type_tree, hf_wlccp_base_message_type_4,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\ncase WLCCP_SAP_MIP:\r\n{\r\nproto_tree_add_item(wlccp_type_tree, hf_wlccp_base_message_type_5,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\ndefault:\r\n{\r\nproto_tree_add_item(wlccp_type_tree, hf_wlccp_base_message_type_unknown,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\n}\r\nbase_message_type=(tvb_get_guint8(tvb,offset) & MT_BASE_MSG_TYPE );\r\noffset += 1;\r\n}\r\nset_mic_flag(FALSE);\r\nset_tlv_flag(FALSE);\r\nswitch (sap_id)\r\n{\r\ncase WLCCP_SAP_CCM:\r\n{\r\noffset = dissect_wlccp_ccm_msg(wlccp_tree, tvb, offset, base_message_type);\r\nbreak;\r\n}\r\ncase WLCCP_SAP_SEC:\r\n{\r\noffset = dissect_wlccp_sec_msg(wlccp_tree, tvb, offset, base_message_type);\r\nbreak;\r\n}\r\ncase WLCCP_SAP_RRM:\r\n{\r\noffset = dissect_wlccp_rrm_msg(wlccp_tree, tvb, offset, base_message_type);\r\nbreak;\r\n}\r\ncase WLCCP_SAP_QOS:\r\n{\r\noffset = dissect_wlccp_qos_msg(wlccp_tree, tvb, offset, base_message_type);\r\nbreak;\r\n}\r\ncase WLCCP_SAP_NM:\r\n{\r\noffset = dissect_wlccp_nm_msg(wlccp_tree, tvb, offset, base_message_type);\r\nbreak;\r\n}\r\ncase WLCCP_SAP_MIP:\r\n{\r\noffset = dissect_wlccp_mip_msg(wlccp_tree, tvb, offset, base_message_type);\r\nbreak;\r\n}\r\ndefault:\r\n{\r\nbreak;\r\n}\r\n}\r\nif(get_tlv_flag() || get_mic_flag())\r\n{\r\nif (tvb_reported_length_remaining(tvb,offset) < 4)\r\n{\r\n}\r\nelse\r\n{\r\nwhile (tvb_reported_length_remaining(tvb,offset) >= 4)\r\n{\r\nold_offset = offset;\r\noffset = dissect_wlccp_tlvs(wlccp_tree, tvb, offset, 0);\r\nDISSECTOR_ASSERT(offset > old_offset);\r\n}\r\n;\r\n}\r\n}\r\n}\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic void set_mic_flag(gboolean flag)\r\n{\r\nmic_flag=flag;\r\n}\r\nstatic void set_tlv_flag(gboolean flag)\r\n{\r\ntlv_flag=flag;\r\n}\r\nstatic gboolean get_tlv_flag(void)\r\n{\r\nreturn(tlv_flag);\r\n}\r\nstatic gboolean get_mic_flag(void)\r\n{\r\nreturn(mic_flag);\r\n}\r\nstatic guint dissect_wlccp_ccm_msg(proto_tree *_tree, tvbuff_t *_tvb, guint _offset, guint8 _base_message_type)\r\n{\r\nproto_item *_ti;\r\nproto_tree *_wlccp_eapol_msg_tree, *_wlccp_cm_flags_tree, *_wlccp_scm_flags_tree, *_wlccp_scm_priority_flags_tree, *_wlccp_scm_bridge_priority_flags_tree;\r\ngboolean _relay_flag=0, _mic_flag=0, _tlv_flag=0;\r\nguint8 _aaa_msg_type=0, _eapol_type=0;\r\nguint16 _eap_msg_length=0;\r\nproto_tree_add_item(_tree, hf_wlccp_hops,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_msg_id,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\n_ti = proto_tree_add_item(_tree, hf_wlccp_flags,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_wlccp_cm_flags_tree = proto_item_add_subtree(_ti, ett_wlccp_cm_flags);\r\nproto_tree_add_item(_wlccp_cm_flags_tree, hf_wlccp_retry_flag,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_wlccp_cm_flags_tree, hf_wlccp_response_request_flag,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_wlccp_cm_flags_tree, hf_wlccp_tlv_flag,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_tlv_flag = (tvb_get_ntohs(_tvb, _offset)>>13) & 1;\r\nset_tlv_flag(_tlv_flag);\r\nproto_tree_add_item(_wlccp_cm_flags_tree, hf_wlccp_inbound_flag,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_wlccp_cm_flags_tree, hf_wlccp_outbound_flag,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_wlccp_cm_flags_tree, hf_wlccp_hopwise_routing_flag,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_wlccp_cm_flags_tree, hf_wlccp_root_cm_flag,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_wlccp_cm_flags_tree, hf_wlccp_relay_flag,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_relay_flag = (tvb_get_ntohs(_tvb, _offset)>>8) & 1;\r\nproto_tree_add_item(_wlccp_cm_flags_tree, hf_wlccp_mic_flag,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_mic_flag = (tvb_get_ntohs(_tvb, _offset)>>7) & 1;\r\nset_mic_flag(_mic_flag);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_originator_node_type,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_originator,\r\n_tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nproto_tree_add_item(_tree, hf_wlccp_responder_node_type,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_responder,\r\n_tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nif(_relay_flag)\r\n{\r\nproto_tree_add_item(_tree, hf_wlccp_relay_node_type,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_relay_node_id,\r\n_tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\n}\r\nswitch (_base_message_type)\r\n{\r\ncase 0x01:\r\n{\r\nproto_tree_add_item(_tree, hf_wlccp_scm_hop_address,\r\n_tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\n_ti = proto_tree_add_item(_tree, hf_wlccp_scm_flags,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_wlccp_scm_flags_tree = proto_item_add_subtree(_ti, ett_wlccp_scm_flags);\r\nproto_tree_add_item(_wlccp_scm_flags_tree, hf_wlccp_scm_layer2update_flag,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_wlccp_scm_flags_tree, hf_wlccp_scm_unattached_flag,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_wlccp_scm_flags_tree, hf_wlccp_scm_unscheduled_flag,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_wlccp_scm_flags_tree, hf_wlccp_scm_active_flag,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_scm_election_group,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_scm_attach_count,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\n_ti = proto_tree_add_item(_tree, hf_wlccp_scm_priority_flags,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_wlccp_scm_priority_flags_tree = proto_item_add_subtree(_ti, ett_wlccp_scm_priority_flags);\r\nproto_tree_add_item(_wlccp_scm_priority_flags_tree, hf_wlccp_scm_priority,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_wlccp_scm_priority_flags_tree, hf_wlccp_scm_preferred_flag,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\n_ti = proto_tree_add_item(_tree, hf_wlccp_scm_bridge_priority_flags,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_wlccp_scm_bridge_priority_flags_tree = proto_item_add_subtree(_ti, ett_wlccp_scm_bridge_priority_flags);\r\nproto_tree_add_item(_wlccp_scm_bridge_priority_flags_tree, hf_wlccp_scm_bridge_priority,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_wlccp_scm_bridge_priority_flags_tree, hf_wlccp_scm_bridge_disable_flag,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_scm_node_id,\r\n_tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nproto_tree_add_item(_tree, hf_wlccp_scm_unknown_short,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_scm_instance_age,\r\n_tvb, _offset, 4, ENC_BIG_ENDIAN);\r\n_offset += 4;\r\nproto_tree_add_item(_tree, hf_wlccp_scm_path_cost,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_scm_hop_count,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_scm_advperiod,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nbreak;\r\n}\r\ncase 0x02:\r\n{\r\nbreak;\r\n}\r\ncase 0x03:\r\n{\r\nbreak;\r\n}\r\ncase 0x04:\r\n{\r\nbreak;\r\n}\r\ncase 0x05:\r\n{\r\nbreak;\r\n}\r\ncase 0x06:\r\n{\r\nbreak;\r\n}\r\ncase 0x07:\r\n{\r\nbreak;\r\n}\r\ncase 0x08:\r\n{\r\nbreak;\r\n}\r\ncase 0x09:\r\n{\r\nbreak;\r\n}\r\ncase 0x0a:\r\n{\r\nbreak;\r\n}\r\ncase 0x0b:\r\n{\r\nproto_tree_add_item(_tree, hf_wlccp_requ_node_type,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_requ_node_id,\r\n_tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nproto_tree_add_item(_tree, hf_wlccp_aaa_msg_type,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_aaa_msg_type=tvb_get_guint8(_tvb,_offset);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_aaa_auth_type,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_keymgmt_type,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_status,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nif (_aaa_msg_type == 0x2)\r\n{\r\n_ti = proto_tree_add_item(_tree, hf_wlccp_eapol_msg,\r\n_tvb, _offset, 6, ENC_NA);\r\n_wlccp_eapol_msg_tree = proto_item_add_subtree(\r\n_ti, ett_wlccp_eapol_msg_tree);\r\n_offset += 2;\r\nproto_tree_add_item(_wlccp_eapol_msg_tree, hf_wlccp_eapol_version,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_wlccp_eapol_msg_tree, hf_wlccp_eapol_type,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_eapol_type=tvb_get_guint8(_tvb, _offset);\r\n_offset += 1;\r\nif (_eapol_type == 0)\r\n{\r\nproto_tree_add_item(_wlccp_eapol_msg_tree, hf_wlccp_eap_msg_length,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_eap_msg_length=tvb_get_ntohs(_tvb, _offset);\r\n_offset += 2;\r\nproto_tree_add_item(_wlccp_eapol_msg_tree, hf_wlccp_eap_msg,\r\n_tvb, _offset, _eap_msg_length, ENC_NA);\r\n_offset += _eap_msg_length;\r\n}\r\n}\r\nif (_aaa_msg_type == 0x3)\r\n{\r\nproto_tree_add_item(_tree, hf_wlccp_cisco_acctg_msg,\r\n_tvb, _offset, -1, ENC_NA);\r\n}\r\nbreak;\r\n}\r\ncase 0x0c:\r\n{\r\nproto_tree_add_item(_tree, hf_wlccp_requ_node_type,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_requ_node_id,\r\n_tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nproto_tree_add_item(_tree, hf_wlccp_path_init_rsvd,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_status,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset +=1;\r\nbreak;\r\n}\r\ncase 0x0f:\r\n{\r\nproto_tree_add_item(_tree, hf_wlccp_wids_msg_type,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_status,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset +=1;\r\nbreak;\r\n}\r\ndefault:\r\n{\r\nbreak;\r\n}\r\n}\r\nreturn(_offset);\r\n}\r\nstatic guint dissect_wlccp_sec_msg(proto_tree *_tree _U_, tvbuff_t *_tvb _U_, guint _offset, guint8 _base_message_type)\r\n{\r\nswitch (_base_message_type)\r\n{\r\ncase 0x01:\r\n{\r\nbreak;\r\n}\r\ndefault:\r\n{\r\nbreak;\r\n}\r\n}\r\nreturn(_offset);\r\n}\r\nstatic guint dissect_wlccp_rrm_msg(proto_tree *_tree, tvbuff_t *_tvb, guint _offset, guint8 _base_message_type)\r\n{\r\nproto_tree *_wlccp_rm_flags_tree;\r\nproto_item *_ti;\r\ngboolean _mic_flag=0;\r\n_ti = proto_tree_add_item(_tree, hf_wlccp_rm_flags,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_wlccp_rm_flags_tree = proto_item_add_subtree(_ti, ett_wlccp_rm_flags);\r\nproto_tree_add_item(_wlccp_rm_flags_tree, hf_wlccp_rm_mic_flag,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_mic_flag = (tvb_get_guint8(_tvb, _offset) & RM_F_MIC) >> 1;\r\nset_mic_flag(_mic_flag);\r\nset_tlv_flag(TRUE);\r\nproto_tree_add_item(_wlccp_rm_flags_tree, hf_wlccp_rm_request_reply_flag,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_msg_id,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_originator_node_type,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_originator,\r\n_tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nproto_tree_add_item(_tree, hf_wlccp_responder_node_type,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_responder,\r\n_tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nswitch (_base_message_type)\r\n{\r\ncase 0x01:\r\n{\r\nbreak;\r\n}\r\ncase 0x02:\r\n{\r\nbreak;\r\n}\r\ncase 0x03:\r\n{\r\nbreak;\r\n}\r\ndefault:\r\n{\r\nbreak;\r\n}\r\n}\r\nreturn(_offset);\r\n}\r\nstatic guint dissect_wlccp_qos_msg(proto_tree *_tree _U_, tvbuff_t *_tvb _U_, guint _offset, guint8 _base_message_type)\r\n{\r\nswitch (_base_message_type)\r\n{\r\ncase 0x01:\r\n{\r\nbreak;\r\n}\r\ndefault:\r\n{\r\nbreak;\r\n}\r\n}\r\nreturn(_offset);\r\n}\r\nstatic guint dissect_wlccp_nm_msg(proto_tree *_tree, tvbuff_t *_tvb, guint _offset, guint8 _base_message_type)\r\n{\r\nproto_item *_ti;\r\nproto_tree *_wlccp_ap_node_id_tree, *_wlccp_nm_flags_tree;\r\ngboolean _mic_flag=0, _tlv_flag=0;\r\nproto_tree_add_item(_tree, hf_wlccp_nm_version,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_msg_id,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\n_ti = proto_tree_add_item(_tree, hf_wlccp_flags,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_wlccp_nm_flags_tree = proto_item_add_subtree(_ti, ett_wlccp_nm_flags);\r\nproto_tree_add_item(_wlccp_nm_flags_tree, hf_wlccp_retry_flag,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_wlccp_nm_flags_tree, hf_wlccp_ack_required_flag,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_wlccp_nm_flags_tree, hf_wlccp_tlv_flag,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_tlv_flag = (tvb_get_ntohs(_tvb, _offset)>>13) & 1;\r\nset_tlv_flag(_tlv_flag);\r\nproto_tree_add_item(_wlccp_nm_flags_tree, hf_wlccp_mic_flag,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_mic_flag = (tvb_get_ntohs(_tvb, _offset)>>7) & 1;\r\nset_mic_flag(_mic_flag);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_originator_node_type,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_originator,\r\n_tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nproto_tree_add_item(_tree, hf_wlccp_responder_node_type,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_responder,\r\n_tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nswitch (_base_message_type)\r\n{\r\ncase 0x01:\r\n{\r\nbreak;\r\n}\r\ncase 0x10:\r\n{\r\nproto_tree_add_item(_tree, hf_wlccp_nmconfig,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\n_offset += 3;\r\nbreak;\r\n}\r\ncase 0x11:\r\n{\r\nproto_tree_add_item(_tree, hf_wlccp_nmconfig,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\n_offset += 3;\r\nbreak;\r\n}\r\ncase 0x20:\r\n{\r\nproto_tree_add_item(_tree, hf_wlccp_timestamp,\r\n_tvb, _offset, 8, ENC_BIG_ENDIAN);\r\n_offset += 8;\r\nproto_tree_add_item(_tree, hf_wlccp_apregstatus,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\n_offset += 3;\r\n_ti = proto_tree_add_item(_tree, hf_wlccp_ap_node_id,\r\n_tvb, _offset, 8, ENC_NA);\r\n_wlccp_ap_node_id_tree = proto_item_add_subtree(\r\n_ti, ett_wlccp_ap_node_id);\r\nproto_tree_add_item(_wlccp_ap_node_id_tree, hf_wlccp_ap_node_type,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nproto_tree_add_item(_wlccp_ap_node_id_tree, hf_wlccp_ap_node_id_address,\r\n_tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nbreak;\r\n}\r\ncase 0x21:\r\n{\r\nproto_tree_add_item(_tree, hf_wlccp_timestamp,\r\n_tvb, _offset, 8, ENC_BIG_ENDIAN);\r\n_offset += 8;\r\nproto_tree_add_item(_tree, hf_wlccp_scmstate_change,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_scmstate_change_reason,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\n_offset += 2;\r\nbreak;\r\n}\r\ncase 0x22:\r\n{\r\nproto_tree_add_item(_tree, hf_wlccp_scmattach_state,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_nmconfig,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_nmcapability,\r\n_tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\n_offset += 1;\r\nbreak;\r\n}\r\ncase 0x30:\r\n{\r\nproto_tree_add_item(_tree, hf_wlccp_timestamp,\r\n_tvb, _offset, 8, ENC_BIG_ENDIAN);\r\n_offset += 8;\r\nbreak;\r\n}\r\ncase 0x31:\r\n{\r\nproto_tree_add_item(_tree, hf_wlccp_refresh_req_id,\r\n_tvb, _offset, 4, ENC_BIG_ENDIAN);\r\n_offset += 4;\r\nbreak;\r\n}\r\ndefault:\r\n{\r\nbreak;\r\n}\r\n}\r\nreturn(_offset);\r\n}\r\nstatic guint dissect_wlccp_mip_msg(proto_tree *_tree _U_, tvbuff_t *_tvb _U_, guint _offset, guint8 _base_message_type)\r\n{\r\nswitch (_base_message_type)\r\n{\r\ncase 0x01:\r\n{\r\nbreak;\r\n}\r\ndefault:\r\n{\r\nbreak;\r\n}\r\n}\r\nreturn(_offset);\r\n}\r\nstatic guint dissect_wlccp_tlvs( proto_tree *_tree, tvbuff_t *_tvb, guint _offset, guint _depth)\r\n{\r\nproto_item *_ti, *_temp_ti;\r\nproto_tree *_tlv_tree;\r\nproto_tree *_tlv_flags_tree;\r\ngboolean _container_flag=0;\r\ngint _group_id=0, _type_id=0;\r\nguint _length=0;\r\nguint _tlv_end=0;\r\nguint _old_offset;\r\n_length = tvb_get_ntohs(_tvb,_offset+2);\r\n_tlv_end = _offset + _length;\r\n_ti = proto_tree_add_item(_tree, hf_wlccp_tlv, _tvb, _offset, _length, ENC_NA);\r\n_tlv_tree = proto_item_add_subtree(_ti, ett_wlccp_tlv_tree);\r\n_temp_ti = _ti;\r\nDISSECTOR_ASSERT(_depth < 100);\r\n_ti = proto_tree_add_item(_tlv_tree, hf_tlv_flags, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_tlv_flags_tree = proto_item_add_subtree(_ti, ett_tlv_flags_tree);\r\n_group_id = (tvb_get_ntohs(_tvb,_offset) & TLV_GROUP_ID) >> 8;\r\n_type_id = (tvb_get_ntohs(_tvb,_offset) & TLV_TYPE_ID);\r\nproto_tree_add_item(_tlv_flags_tree, hf_wlccp_tlv_container_flag, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_tlv_flags_tree, hf_wlccp_tlv_encrypted_flag, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_tlv_flags_tree, hf_wlccp_tlv_reserved_bit, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_tlv_flags_tree, hf_wlccp_tlv_group, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_tlv_flags_tree, hf_wlccp_tlv_request_flag, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nswitch (_group_id)\r\n{\r\ncase WLCCP_TLV_GROUP_WLCCP:\r\n{\r\nproto_tree_add_item(_tlv_flags_tree, hf_wlccp_tlv_type0, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\ncase WLCCP_TLV_GROUP_SEC:\r\n{\r\nproto_tree_add_item(_tlv_flags_tree, hf_wlccp_tlv_type1, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\ncase WLCCP_TLV_GROUP_RRM:\r\n{\r\nproto_tree_add_item(_tlv_flags_tree, hf_wlccp_tlv_type2, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\ncase WLCCP_TLV_GROUP_QOS:\r\n{\r\nproto_tree_add_item(_tlv_flags_tree, hf_wlccp_tlv_type3, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\ncase WLCCP_TLV_GROUP_NM:\r\n{\r\nproto_tree_add_item(_tlv_flags_tree, hf_wlccp_tlv_type4, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\ncase WLCCP_TLV_GROUP_MIP:\r\n{\r\nproto_tree_add_item(_tlv_flags_tree, hf_wlccp_tlv_type5, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\ndefault:\r\n{\r\nproto_tree_add_item(_tlv_flags_tree, hf_wlccp_tlv_type, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\n}\r\n_container_flag = (tvb_get_ntohs(_tvb, _offset) & TLV_F_CONTAINER) >> 15;\r\n_offset += 2;\r\nproto_tree_add_item(_tlv_tree, hf_wlccp_tlv_length, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nswitch (_group_id)\r\n{\r\ncase WLCCP_TLV_GROUP_WLCCP:\r\n{\r\n_offset = dissect_wlccp_ccm_tlv(_tlv_tree, _tvb, _offset, _type_id, _length - 4, _temp_ti);\r\nbreak;\r\n}\r\ncase WLCCP_TLV_GROUP_SEC:\r\n{\r\n_offset = dissect_wlccp_sec_tlv(_tlv_tree, _tvb, _offset, _type_id, _length - 4, _temp_ti);\r\nbreak;\r\n}\r\ncase WLCCP_TLV_GROUP_RRM:\r\n{\r\n_offset = dissect_wlccp_rrm_tlv(_tlv_tree, _tvb, _offset, _type_id, _length - 4, _temp_ti);\r\nbreak;\r\n}\r\ncase WLCCP_TLV_GROUP_QOS:\r\n{\r\n_offset = dissect_wlccp_qos_tlv(_tlv_tree, _tvb, _offset, _type_id, _length - 4, _temp_ti);\r\nbreak;\r\n}\r\ncase WLCCP_TLV_GROUP_NM:\r\n{\r\n_offset = dissect_wlccp_nm_tlv(_tlv_tree, _tvb, _offset, _type_id, _length - 4, _temp_ti);\r\nbreak;\r\n}\r\ncase WLCCP_TLV_GROUP_MIP:\r\n{\r\n_offset = dissect_wlccp_mip_tlv(_tlv_tree, _tvb, _offset, _type_id, _length - 4, _temp_ti);\r\nbreak;\r\n}\r\ndefault:\r\n{\r\n_offset = _tlv_end;\r\nbreak;\r\n}\r\n}\r\nif (_container_flag && (_offset >= _tlv_end) )\r\n{\r\n}\r\nelse\r\n{\r\nif (_container_flag && (_offset < _tlv_end) )\r\n{\r\nwhile (_offset < _tlv_end)\r\n{\r\n_old_offset = _offset;\r\n_offset = dissect_wlccp_tlvs(_tlv_tree, _tvb, _offset, _depth++);\r\nDISSECTOR_ASSERT(_offset > _old_offset);\r\n}\r\n}\r\n}\r\nreturn(_tlv_end);\r\n}\r\nstatic guint dissect_wlccp_ccm_tlv(proto_tree *_tree, tvbuff_t *_tvb, guint _offset, gint _type_id, guint _length, proto_item *_ti)\r\n{\r\nswitch (_type_id)\r\n{\r\ncase 0x00:\r\n{\r\nproto_item_append_text(_ti, " NULL TLV");\r\nproto_tree_add_item(_tree, hf_wlccp_null_tlv , _tvb, _offset, _length, ENC_NA);\r\n_offset += _length;\r\nbreak;\r\n}\r\ncase 0x09:\r\n{\r\nproto_item_append_text(_ti, " IPv4Address");\r\nproto_tree_add_item(_tree, hf_wlccp_ipv4_address, _tvb, _offset, 4, ENC_BIG_ENDIAN);\r\n_offset += 4;\r\nbreak;\r\n}\r\ndefault:\r\n{\r\nproto_item_append_text(_ti, " Unknown");\r\nproto_tree_add_item(_tree, hf_wlccp_tlv_unknown_value, _tvb, _offset, _length, ENC_NA);\r\n_offset += _length;\r\nbreak;\r\n}\r\n}\r\nreturn(_offset);\r\n}\r\nstatic guint dissect_wlccp_sec_tlv(proto_tree *_tree, tvbuff_t *_tvb, guint _offset, gint _type_id, guint _length, proto_item *_ti)\r\n{\r\nswitch (_type_id)\r\n{\r\ncase 0x01:\r\n{\r\nproto_item_append_text(_ti, " initSession");\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_path_length, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\n_offset += 2;\r\nbreak;\r\n}\r\ncase 0x02:\r\n{\r\nproto_item_append_text(_ti, " inSecureContextReq");\r\nproto_tree_add_item(_tree, hf_wlccp_key_seq_count, _tvb, _offset, 4, ENC_BIG_ENDIAN);\r\n_offset += 4;\r\nproto_tree_add_item(_tree, hf_wlccp_dest_node_type, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_dest_node_id, _tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nproto_tree_add_item(_tree, hf_wlccp_supp_node_type, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_supp_node_id, _tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_key_mgmt_type, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_nonce, _tvb, _offset, 32, ENC_NA);\r\n_offset += 32;\r\nbreak;\r\n}\r\ncase 0x06:\r\n{\r\nproto_item_append_text(_ti, " authenticator");\r\nproto_tree_add_item(_tree, hf_wlccp_dest_node_type, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_dest_node_id, _tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nproto_tree_add_item(_tree, hf_wlccp_src_node_type, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_src_node_id, _tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nproto_tree_add_item(_tree, hf_wlccp_key_seq_count, _tvb, _offset, 4, ENC_BIG_ENDIAN);\r\n_offset += 4;\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_status, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_nonce, _tvb, _offset, 32, ENC_NA);\r\n_offset += 32;\r\nbreak;\r\n}\r\ncase 0x08:\r\n{\r\nguint16 _mic_length=0;\r\nproto_item_append_text(_ti, " mic");\r\nproto_tree_add_item(_tree, hf_wlccp_mic_msg_seq_count, _tvb, _offset, 8, ENC_BIG_ENDIAN);\r\n_offset += 8;\r\nproto_tree_add_item(_tree, hf_wlccp_mic_length, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_mic_length = tvb_get_ntohs(_tvb,_offset);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_mic_value, _tvb, _offset, _mic_length, ENC_NA);\r\n_offset += _mic_length;\r\nbreak;\r\n}\r\ncase 0x0a:\r\n{\r\nproto_item_append_text(_ti, " inSecureContextReply");\r\nproto_tree_add_item(_tree, hf_wlccp_key_seq_count, _tvb, _offset, 4, ENC_BIG_ENDIAN);\r\n_offset += 4;\r\nproto_tree_add_item(_tree, hf_wlccp_dest_node_type, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_dest_node_id, _tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nproto_tree_add_item(_tree, hf_wlccp_supp_node_type, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_supp_node_id, _tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nproto_tree_add_item(_tree, hf_wlccp_nonce, _tvb, _offset, 32, ENC_NA);\r\n_offset += 32;\r\nproto_tree_add_item(_tree, hf_wlccp_session_timeout, _tvb, _offset, 4, ENC_BIG_ENDIAN);\r\n_offset += 4;\r\nbreak;\r\n}\r\ndefault:\r\n{\r\nproto_item_append_text(_ti, " Unknown");\r\nproto_tree_add_item(_tree, hf_wlccp_tlv_unknown_value, _tvb, _offset, _length, ENC_NA);\r\n_offset += _length;\r\nbreak;\r\n}\r\n}\r\nreturn(_offset);\r\n}\r\nstatic guint dissect_wlccp_rrm_tlv(proto_tree *_tree, tvbuff_t *_tvb, guint _offset, gint _type_id, guint _length, proto_item *_ti)\r\n{\r\nswitch (_type_id)\r\n{\r\ncase 0x02:\r\n{\r\nproto_item_append_text(_ti, " aggrRmReq");\r\nproto_tree_add_item(_tree, hf_wlccp_token2, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_interval, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nbreak;\r\n}\r\ncase 0x03 :\r\n{\r\nproto_item_append_text(_ti, " rmReport");\r\nproto_tree_add_item(_tree, hf_wlccp_sta_type, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_bssid, _tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nproto_tree_add_item(_tree, hf_wlccp_stamac, _tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nbreak;\r\n}\r\ncase 0x04:\r\n{\r\nproto_item_append_text(_ti, " aggrRmReport");\r\nbreak;\r\n}\r\ncase 0x12:\r\n{\r\nproto_item_append_text(_ti, " beaconRequest");\r\nproto_tree_add_item(_tree, hf_wlccp_token, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_mode, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_channel, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_scan_mode, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_duration, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nbreak;\r\n}\r\ncase 0x14:\r\n{\r\nguint _count=0, _counter=0;\r\nproto_item_append_text(_ti, " frameRequest");\r\nproto_tree_add_item(_tree, hf_wlccp_token, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_mode, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_channel, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_count, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_count = tvb_get_guint8(_tvb,_offset);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_duration, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nfor (_counter=0; _counter < _count; _counter++)\r\n{\r\nproto_tree_add_item(_tree, hf_wlccp_bssid, _tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\n}\r\nbreak;\r\n}\r\ncase 0x15:\r\n{\r\nproto_item *_fr_ti;\r\nproto_tree *_fr_elems_tree;\r\nguint _counter=0, _arraylen=0;\r\nproto_item_append_text(_ti, " frameReport");\r\nproto_tree_add_item(_tree, hf_wlccp_token, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_mode, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_channel, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_duration, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\n_arraylen=(_length-10)/14;\r\nif (_arraylen > 0)\r\n{\r\n_fr_ti = proto_tree_add_item(_tree, hf_framereport_elements, _tvb, _offset, (_length-10), ENC_NA);\r\n_fr_elems_tree = proto_item_add_subtree(_fr_ti, ett_framereport_elements_tree);\r\nfor(_counter=0; _counter < _arraylen; _counter++)\r\n{\r\nproto_tree_add_item(_fr_elems_tree, hf_wlccp_numframes, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_fr_elems_tree, hf_wlccp_rss, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_fr_elems_tree, hf_wlccp_bssid, _tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nproto_tree_add_item(_fr_elems_tree, hf_wlccp_stamac, _tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\n}\r\n}\r\nbreak;\r\n}\r\ncase 0x16:\r\n{\r\nproto_item_append_text(_ti, " ccaRequest");\r\nproto_tree_add_item(_tree, hf_wlccp_token, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_mode, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_channel, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_duration, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nbreak;\r\n}\r\ncase 0x17:\r\n{\r\nproto_item_append_text(_ti, " ccaReport");\r\nproto_tree_add_item(_tree, hf_wlccp_token, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_mode, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_channel, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_duration, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_ccabusy, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nbreak;\r\n}\r\ncase 0x18:\r\n{\r\nproto_item_append_text(_ti, " rpiHistRequest");\r\nproto_tree_add_item(_tree, hf_wlccp_token, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_mode, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_channel, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_duration, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nbreak;\r\n}\r\ncase 0x19:\r\n{\r\nguint _rpi_density_length=0;\r\nproto_item_append_text(_ti, " rpiHistReport");\r\nproto_tree_add_item(_tree, hf_wlccp_token, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_mode, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_channel, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_duration, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\n_rpi_density_length = _length - 6 - 4;\r\nproto_tree_add_item(_tree, hf_wlccp_rpidensity, _tvb, _offset, _rpi_density_length, ENC_NA);\r\n_offset += _rpi_density_length;\r\nbreak;\r\n}\r\ncase 0x1c:\r\n{\r\nproto_item_append_text(_ti, " nullRequest");\r\nproto_tree_add_item(_tree, hf_wlccp_token, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_mode, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_channel, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_duration, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nbreak;\r\n}\r\ncase 0x1e:\r\n{\r\nproto_tree *_80211_capabilities_tree;\r\nproto_item *_new_ti;\r\nguint _tlv80211length=0;\r\nproto_item_append_text(_ti, " commonBeaconReport");\r\nproto_tree_add_item(_tree, hf_wlccp_srcidx, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_channel, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_phy_type, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_bssid, _tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nproto_tree_add_item(_tree, hf_wlccp_beacon_interval, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\n_new_ti = proto_tree_add_item(_tree, hf_wlccp_80211_capabilities,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_80211_capabilities_tree = proto_item_add_subtree(_new_ti, ett_80211_capability_flags_tree);\r\nproto_tree_add_item(_80211_capabilities_tree, hf_80211_imm_block_ack,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_80211_capabilities_tree, hf_80211_dlyd_block_ack,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_80211_capabilities_tree, hf_80211_dsss_ofdm,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_80211_capabilities_tree, hf_80211_reserved,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_80211_capabilities_tree, hf_80211_apsd,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_80211_capabilities_tree, hf_80211_short_time_slot,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_80211_capabilities_tree, hf_80211_qos,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_80211_capabilities_tree, hf_80211_spectrum_mgmt,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_80211_capabilities_tree, hf_80211_chan_agility,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_80211_capabilities_tree, hf_80211_pbcc,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_80211_capabilities_tree, hf_80211_short_preamble,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_80211_capabilities_tree, hf_80211_cap_privacy,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_80211_capabilities_tree, hf_80211_cap_cf_poll_req,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_80211_capabilities_tree, hf_80211_cap_cf_pollable,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_80211_capabilities_tree, hf_80211_cap_ibss,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(_80211_capabilities_tree, hf_80211_cap_ess,\r\n_tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\n_tlv80211length = _length - 13 - 4;\r\nproto_tree_add_item(_tree, hf_wlccp_tlv80211, _tvb, _offset, _tlv80211length, ENC_NA);\r\n_offset += _tlv80211length;\r\nbreak;\r\n}\r\ncase 0x1f:\r\n{\r\nproto_item_append_text(_ti, " aggrBeaconReport");\r\nproto_tree_add_item(_tree, hf_wlccp_token, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_mode, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_rss, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_srcidx, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_parent_tsf, _tvb, _offset, 4, ENC_BIG_ENDIAN);\r\n_offset += 4;\r\nproto_tree_add_item(_tree, hf_wlccp_target_tsf, _tvb, _offset, 8, ENC_BIG_ENDIAN);\r\n_offset += 8;\r\nbreak;\r\n}\r\ncase 0x20:\r\n{\r\nguint _counter=0, _arraylen=0;\r\nproto_item_append_text(_ti, " rmReqRoutingList");\r\n_arraylen=(_length)/16;\r\nif (_arraylen > 0)\r\n{\r\nfor(_counter=0; _counter < _arraylen; _counter++)\r\n{\r\nproto_tree_add_item(_tree, hf_wlccp_ipv4_address, _tvb, _offset, 4, ENC_BIG_ENDIAN);\r\n_offset += 4;\r\nproto_tree_add_item(_tree, hf_wlccp_bssid, _tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nproto_tree_add_item(_tree, hf_wlccp_stamac, _tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\n}\r\n}\r\nbreak;\r\n}\r\ncase 0x21:\r\n{\r\nguint _counter=0, _arraylen=0;\r\nproto_item_append_text(_ti, " rmReqRoutingResp");\r\nproto_tree_add_item(_tree, hf_wlccp_token2, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\n_arraylen=(_length)/11;\r\nif (_arraylen > 0)\r\n{\r\nfor(_counter=0; _counter < _arraylen; _counter++)\r\n{\r\nproto_tree_add_item(_tree, hf_wlccp_ipv4_address, _tvb, _offset, 4, ENC_BIG_ENDIAN);\r\n_offset += 4;\r\nproto_tree_add_item(_tree, hf_wlccp_bssid, _tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nproto_tree_add_item(_tree, hf_wlccp_status, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\n}\r\n}\r\nbreak;\r\n}\r\ncase 0x22:\r\n{\r\nproto_item_append_text(_ti, " rmReqAck");\r\nproto_tree_add_item(_tree, hf_wlccp_status, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nbreak;\r\n}\r\ncase 0x58:\r\n{\r\nproto_item_append_text(_ti, " mfpCapability");\r\nproto_tree_add_item(_tree, hf_wlccp_mfpcapability, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nbreak;\r\n}\r\ncase 0x5b:\r\n{\r\nproto_item_append_text(_ti, " mfpRouting");\r\nproto_tree_add_item(_tree, hf_wlccp_ipv4_address, _tvb, _offset, 4, ENC_BIG_ENDIAN);\r\n_offset += 4;\r\nproto_tree_add_item(_tree, hf_wlccp_bssid, _tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nproto_tree_add_item(_tree, hf_wlccp_mfpflags, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nbreak;\r\n}\r\ncase 0x5c:\r\n{\r\nproto_item_append_text(_ti, " mfpConfig");\r\nproto_tree_add_item(_tree, hf_wlccp_mfpconfig, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nbreak;\r\n}\r\ndefault:\r\n{\r\nproto_item_append_text(_ti, " Unknown");\r\nproto_tree_add_item(_tree, hf_wlccp_tlv_unknown_value, _tvb, _offset, _length, ENC_NA);\r\n_offset += _length;\r\nbreak;\r\n}\r\n}\r\nreturn(_offset);\r\n}\r\nstatic guint dissect_wlccp_qos_tlv(proto_tree *_tree, tvbuff_t *_tvb, guint _offset, gint _type_id, guint _length, proto_item *_ti)\r\n{\r\nswitch (_type_id)\r\n{\r\ndefault:\r\n{\r\nproto_item_append_text(_ti, " Unknown");\r\nproto_tree_add_item(_tree, hf_wlccp_tlv_unknown_value, _tvb, _offset, _length, ENC_NA);\r\n_offset += _length;\r\nbreak;\r\n}\r\n}\r\nreturn(_offset);\r\n}\r\nstatic guint dissect_wlccp_nm_tlv(proto_tree *_tree, tvbuff_t *_tvb, guint _offset, gint _type_id, guint _length, proto_item *_ti)\r\n{\r\nswitch (_type_id)\r\n{\r\ncase 0x20:\r\n{\r\nguint _radius_user_name_length = 0;\r\nproto_item_append_text(_ti, " nmClientEventIntoWDS");\r\nproto_tree_add_item(_tree, hf_wlccp_clientmac, _tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nproto_tree_add_item(_tree, hf_time_elapsed, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_parent_ap_mac, _tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nproto_tree_add_item(_tree, hf_reg_lifetime, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_ipv4_address, _tvb, _offset, 4, ENC_BIG_ENDIAN);\r\n_offset += 4;\r\nproto_tree_add_item(_tree, hf_wlccp_auth_type, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_key_mgmt_type, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\n_offset += 1;\r\n_radius_user_name_length = _length - 23 - 4;\r\nproto_tree_add_item(_tree, hf_wlccp_radius_user_name, _tvb, _offset, _radius_user_name_length, ENC_ASCII|ENC_NA);\r\n_offset += _radius_user_name_length;\r\nbreak;\r\n}\r\ncase 0x21:\r\n{\r\nproto_item_append_text(_ti, " nmClientEventOutOfWDS");\r\nproto_tree_add_item(_tree, hf_wlccp_clientmac, _tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nproto_tree_add_item(_tree, hf_time_elapsed, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_parent_ap_mac, _tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nproto_tree_add_item(_tree, hf_wds_reason, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\n_offset += 1;\r\nbreak;\r\n}\r\ncase 0x22:\r\n{\r\nproto_item_append_text(_ti, " nmClientEventIntraWDS");\r\nproto_tree_add_item(_tree, hf_wlccp_clientmac, _tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nproto_tree_add_item(_tree, hf_time_elapsed, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_parent_ap_mac, _tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nproto_tree_add_item(_tree, hf_reg_lifetime, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_auth_type, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_key_mgmt_type, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\n_offset += 3;\r\nbreak;\r\n}\r\ncase 0x24:\r\n{\r\nproto_item_append_text(_ti, " nmClientEventIPAddressUpdate");\r\nproto_tree_add_item(_tree, hf_wlccp_clientmac, _tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nproto_tree_add_item(_tree, hf_time_elapsed, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_parent_ap_mac, _tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_ipv4_address, _tvb, _offset, 4, ENC_BIG_ENDIAN);\r\n_offset += 4;\r\nbreak;\r\n}\r\ncase 0x26:\r\n{\r\nguint _radius_user_name_length = 0;\r\nproto_item_append_text(_ti, " nmClientEventRefresh");\r\nproto_tree_add_item(_tree, hf_wlccp_clientmac, _tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nproto_tree_add_item(_tree, hf_time_elapsed, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_parent_ap_mac, _tvb, _offset, 6, ENC_NA);\r\n_offset += 6;\r\nproto_tree_add_item(_tree, hf_reg_lifetime, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_ipv4_address, _tvb, _offset, 4, ENC_BIG_ENDIAN);\r\n_offset += 4;\r\nproto_tree_add_item(_tree, hf_wlccp_auth_type, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\nproto_tree_add_item(_tree, hf_wlccp_key_mgmt_type, _tvb, _offset, 1, ENC_BIG_ENDIAN);\r\n_offset += 1;\r\n_offset += 1;\r\n_radius_user_name_length = _length - 23 - 4;\r\nproto_tree_add_item(_tree, hf_wlccp_radius_user_name, _tvb, _offset, _radius_user_name_length, ENC_ASCII|ENC_NA);\r\n_offset += _radius_user_name_length;\r\nbreak;\r\n}\r\ncase 0x27:\r\n{\r\nproto_item_append_text(_ti, " nmClientEventRefreshDone");\r\n_offset += 6;\r\nproto_tree_add_item(_tree, hf_time_elapsed, _tvb, _offset, 2, ENC_BIG_ENDIAN);\r\n_offset += 2;\r\nproto_tree_add_item(_tree, hf_wlccp_refresh_req_id, _tvb, _offset, 4, ENC_BIG_ENDIAN);\r\n_offset += 4;\r\nbreak;\r\n}\r\ndefault:\r\n{\r\nproto_item_append_text(_ti, " Unknown");\r\nproto_tree_add_item(_tree, hf_wlccp_tlv_unknown_value, _tvb, _offset, _length, ENC_NA);\r\n_offset += _length;\r\nbreak;\r\n}\r\n}\r\nreturn(_offset);\r\n}\r\nstatic guint dissect_wlccp_mip_tlv(proto_tree *_tree, tvbuff_t *_tvb, guint _offset, gint _type_id, guint _length, proto_item *_ti)\r\n{\r\nswitch (_type_id)\r\n{\r\ndefault:\r\n{\r\nproto_item_append_text(_ti, " Unknown");\r\nproto_tree_add_item(_tree, hf_wlccp_tlv_unknown_value, _tvb, _offset, _length, ENC_NA);\r\n_offset += _length;\r\nbreak;\r\n}\r\n}\r\nreturn(_offset);\r\n}\r\nvoid\r\nproto_register_wlccp(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_wlccp_version,\r\n{ "Version", "wlccp.version",\r\nFT_UINT8, BASE_HEX, NULL,\r\n0x0, "Protocol ID/Version", HFILL }\r\n},\r\n{ &hf_wlccp_srcmac,\r\n{ "Src MAC", "wlccp.srcmac",\r\nFT_ETHER, BASE_NONE, NULL,\r\n0x0, "Source MAC address", HFILL }\r\n},\r\n{ &hf_wlccp_dstmac,\r\n{ "Dst MAC", "wlccp.dstmac",\r\nFT_ETHER, BASE_NONE, NULL,\r\n0x0, "Destination MAC address", HFILL }\r\n},\r\n{ &hf_wlccp_hostname,\r\n{ "Hostname", "wlccp.hostname",\r\nFT_STRING, BASE_NONE, NULL,\r\n0x0, "Hostname of device", HFILL }\r\n},\r\n{ &hf_wlccp_sap,\r\n{ "SAP", "wlccp.sap",\r\nFT_UINT8, BASE_HEX, NULL,\r\n0x0, "Service Access Point", HFILL }\r\n},\r\n{ &hf_wlccp_sap_version,\r\n{ "SAP Version", "wlccp.sap_version",\r\nFT_UINT8, BASE_DEC, NULL,\r\nSAP_VERSION_MASK, "Service Access Point Version", HFILL }\r\n},\r\n{ &hf_wlccp_sap_id,\r\n{ "SAP ID", "wlccp.sap_id",\r\nFT_UINT8, BASE_DEC, VALS(wlccp_sap_vs),\r\nSAP_VALUE_MASK, "Service Access Point ID", HFILL }\r\n},\r\n{ &hf_wlccp_destination_node_type,\r\n{ "Destination node type", "wlccp.destination_node_type",\r\nFT_UINT16, BASE_DEC, VALS(wlccp_node_type_vs),\r\n0x0, "Node type of the hop destination", HFILL }\r\n},\r\n{ &hf_wlccp_length,\r\n{ "Length", "wlccp.length",\r\nFT_UINT16, BASE_DEC, NULL,\r\n0x0, "Length of WLCCP payload (bytes)", HFILL }\r\n},\r\n{ &hf_wlccp_type,\r\n{ "Message Type", "wlccp.type",\r\nFT_UINT8, BASE_HEX, NULL,\r\n0x0, NULL, HFILL }\r\n},\r\n{ &hf_wlccp_subtype,\r\n{ "Subtype", "wlccp.subtype",\r\nFT_UINT8, BASE_DEC, VALS(wlccp_subtype_vs),\r\nMT_SUBTYPE, "Message Subtype", HFILL }\r\n},\r\n{ &hf_wlccp_base_message_type_0,\r\n{ "Base message type", "wlccp.base_message_type",\r\nFT_UINT8, BASE_HEX_DEC, VALS(wlccp_msg_type_vs_0),\r\nMT_BASE_MSG_TYPE, NULL, HFILL }\r\n},\r\n{ &hf_wlccp_base_message_type_1,\r\n{ "Base message type", "wlccp.base_message_type",\r\nFT_UINT8, BASE_HEX_DEC, VALS(wlccp_msg_type_vs_1),\r\nMT_BASE_MSG_TYPE, NULL, HFILL }\r\n},\r\n{ &hf_wlccp_base_message_type_2,\r\n{ "Base message type", "wlccp.base_message_type",\r\nFT_UINT8, BASE_HEX_DEC, VALS(wlccp_msg_type_vs_2),\r\nMT_BASE_MSG_TYPE, NULL, HFILL }\r\n},\r\n{ &hf_wlccp_base_message_type_3,\r\n{ "Base message type", "wlccp.base_message_type",\r\nFT_UINT8, BASE_HEX_DEC, VALS(wlccp_msg_type_vs_3),\r\nMT_BASE_MSG_TYPE, NULL, HFILL }\r\n},\r\n{ &hf_wlccp_base_message_type_4,\r\n{ "Base message type", "wlccp.base_message_type",\r\nFT_UINT8, BASE_HEX_DEC, VALS(wlccp_msg_type_vs_4),\r\nMT_BASE_MSG_TYPE, NULL, HFILL }\r\n},\r\n{ &hf_wlccp_base_message_type_5,\r\n{ "Base message type", "wlccp.base_message_type",\r\nFT_UINT8, BASE_HEX_DEC, VALS(wlccp_msg_type_vs_5),\r\nMT_BASE_MSG_TYPE, NULL, HFILL }\r\n},\r\n{ &hf_wlccp_base_message_type_unknown,\r\n{ "Base message type", "wlccp.base_message_type",\r\nFT_UINT8, BASE_HEX_DEC, NULL,\r\nMT_BASE_MSG_TYPE, NULL, HFILL }\r\n},\r\n{ &hf_wlccp_hops,\r\n{ "Hops", "wlccp.hops",\r\nFT_UINT8, BASE_DEC, NULL,\r\n0x0, "Number of WLCCP hops", HFILL }\r\n},\r\n{ &hf_wlccp_nm_version,\r\n{ "NM Version", "wlccp.nm_version",\r\nFT_UINT8, BASE_DEC, NULL,\r\n0x0, NULL, HFILL }\r\n},\r\n{ &hf_wlccp_msg_id,\r\n{ "Message ID", "wlccp.msg_id",\r\nFT_UINT16, BASE_DEC, NULL,\r\n0x0, "Sequence number used to match request/reply pairs",\r\nHFILL }\r\n},\r\n{ &hf_wlccp_flags,\r\n{ "Flags", "wlccp.flags",\r\nFT_UINT16, BASE_HEX, NULL,\r\n0x0, NULL, HFILL }\r\n},\r\n{ &hf_wlccp_rm_flags,\r\n{ "RM Flags", "wlccp.rm_flags",\r\nFT_UINT8, BASE_HEX, NULL,\r\n0x0, NULL, HFILL }\r\n},\r\n{ &hf_wlccp_retry_flag,\r\n{ "Retry flag", "wlccp.retry_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_RETRY, "Set on for retransmissions", HFILL }\r\n},\r\n{ &hf_wlccp_response_request_flag,\r\n{ "Response request flag", "wlccp.response_request_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_RESPONSE_REQUEST, "Set on to request a reply", HFILL }\r\n},\r\n{ &hf_wlccp_rm_request_reply_flag,\r\n{ "Request Reply flag", "wlccp.request_reply_flag",\r\nFT_UINT8, BASE_DEC, NULL,\r\nRM_F_REQUEST_REPLY, "Set on to request a reply", HFILL }\r\n},\r\n{ &hf_wlccp_ack_required_flag,\r\n{ "Ack Required flag", "wlccp.ack_required_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_ACK_REQD, "Set on to require an acknowledgement", HFILL }\r\n},\r\n{ &hf_wlccp_tlv_flag,\r\n{ "TLV flag", "wlccp.tlv_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_TLV, "Set to indicate that optional TLVs follow the fixed fields", HFILL }\r\n},\r\n{ &hf_wlccp_inbound_flag,\r\n{ "Inbound flag", "wlccp.inbound_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_INBOUND, "Message is inbound to the top of the topology tree", HFILL }\r\n},\r\n{ &hf_wlccp_outbound_flag,\r\n{ "Outbound flag", "wlccp.outbound_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_OUTBOUND, "Message is outbound from the top of the topology tree", HFILL }\r\n},\r\n{ &hf_wlccp_hopwise_routing_flag,\r\n{ "Hopwise-routing flag", "wlccp.hopwise_routing_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_HOPWISE_ROUTING, "On to force intermediate access points to process the message also", HFILL }\r\n},\r\n{ &hf_wlccp_root_cm_flag,\r\n{ "Root context manager flag", "wlccp.root_cm_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_ROOT_CM, "Set to on to send message to the root context manager of the topology tree", HFILL }\r\n},\r\n{ &hf_wlccp_relay_flag,\r\n{ "Relay flag", "wlccp.relay_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_RELAY, "Signifies that this header is immediately followed by a relay node field", HFILL }\r\n},\r\n{ &hf_wlccp_mic_flag,\r\n{ "MIC flag", "wlccp.mic_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_MIC, "On in a message that must be authenticated and has an authentication TLV", HFILL }\r\n},\r\n{ &hf_wlccp_rm_mic_flag,\r\n{ "MIC flag", "wlccp.mic_flag",\r\nFT_UINT8, BASE_DEC, NULL,\r\nRM_F_MIC, "On in a message that must be authenticated and has an authentication TLV", HFILL }\r\n},\r\n{ &hf_wlccp_originator_node_type,\r\n{ "Originator node type", "wlccp.originator_node_type",\r\nFT_UINT16, BASE_DEC, VALS(wlccp_node_type_vs),\r\n0x0, "Originating device's node type", HFILL }\r\n},\r\n{ &hf_wlccp_originator,\r\n{ "Originator", "wlccp.originator",\r\nFT_ETHER, BASE_NONE, NULL,\r\n0x0, "Originating device's MAC address", HFILL }\r\n},\r\n{ &hf_wlccp_responder_node_type,\r\n{ "Responder node type", "wlccp.responder_node_type",\r\nFT_UINT16, BASE_DEC, VALS(wlccp_node_type_vs),\r\n0x0, "Responding device's node type", HFILL }\r\n},\r\n{ &hf_wlccp_responder,\r\n{ "Responder", "wlccp.responder",\r\nFT_ETHER, BASE_NONE, NULL,\r\n0x0, "Responding device's MAC address", HFILL }\r\n},\r\n{ &hf_wlccp_requ_node_type,\r\n{ "Requestor node type", "wlccp.requ_node_type",\r\nFT_UINT16, BASE_DEC, VALS(wlccp_node_type_vs),\r\n0x0, "Requesting device's node type", HFILL }\r\n},\r\n{ &hf_wlccp_requ_node_id,\r\n{ "Requestor", "wlccp.requestor",\r\nFT_ETHER, BASE_NONE, NULL,\r\n0x0, "Requestor device's MAC address", HFILL }\r\n},\r\n{ &hf_wlccp_status,\r\n{ "Status", "wlccp.status",\r\nFT_UINT8, BASE_DEC, VALS(wlccp_status_vs),\r\n0x0, NULL, HFILL }\r\n},\r\n{ &hf_wlccp_path_init_rsvd,\r\n{ "Reserved", "wlccp.path_init_reserved",\r\nFT_UINT8, BASE_DEC, NULL,\r\n0x0, NULL, HFILL }\r\n},\r\n{ &hf_wlccp_relay_node_type,\r\n{ "Relay node type", "wlccp.relay_node_type",\r\nFT_UINT16, BASE_DEC, VALS(wlccp_node_type_vs),\r\n0x0, "Type of node which relayed this message", HFILL }\r\n},\r\n{ &hf_wlccp_relay_node_id,\r\n{ "Relay node ID", "wlccp.relay_node_id",\r\nFT_ETHER, BASE_NONE, NULL,\r\n0x0, "Node which relayed this message", HFILL }\r\n},\r\n#if 0\r\n{ &hf_wlccp_priority,\r\n{ "WDS priority", "wlccp.priority",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"WDS priority of this access point", HFILL }\r\n},\r\n#endif\r\n#if 0\r\n{ &hf_wlccp_age,\r\n{ "Age", "wlccp.age",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"Time since AP became a WDS master", HFILL }\r\n},\r\n#endif\r\n#if 0\r\n{ &hf_wlccp_period,\r\n{ "Period", "wlccp.period",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"Interval between announcements (seconds)", HFILL }\r\n},\r\n#endif\r\n{ &hf_wlccp_ipv4_address,\r\n{ "IPv4 Address", "wlccp.ipv4_address",\r\nFT_IPv4, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_scm_hop_address,\r\n{ "Hop Address", "wlccp.scm_hop_address",\r\nFT_ETHER, BASE_NONE, NULL,\r\n0x0, "Source 802 Port Address", HFILL }\r\n},\r\n{ &hf_wlccp_scm_flags,\r\n{ "SCM flags", "wlccp.scm_flags",\r\nFT_UINT16, BASE_HEX, NULL,\r\n0x0, NULL, HFILL }\r\n},\r\n{ &hf_wlccp_scm_active_flag,\r\n{ "Active flag", "wlccp.scm_active_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_SCM_ACTIVE, "Set to on in advertisements from the active SCM", HFILL }\r\n},\r\n{ &hf_wlccp_scm_unscheduled_flag,\r\n{ "Unscheduled flag", "wlccp.scm_unscheduled_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_SCM_UNSCHEDULED, "Set to on in unscheduled advertisement messages", HFILL }\r\n},\r\n{ &hf_wlccp_scm_unattached_flag,\r\n{ "Unattached flag", "wlccp.scm_unattached_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_SCM_UNATTACHED, "Set to on in advertisements from an unattached node", HFILL }\r\n},\r\n{ &hf_wlccp_scm_layer2update_flag,\r\n{ "Layer2 Update flag", "wlccp.scm_layer2update_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_SCM_LAYER2UPDATE, "Set to on if WLCCP Layer 2 path updates are enabled", HFILL }\r\n},\r\n{ &hf_wlccp_scm_election_group,\r\n{ "SCM Election Group", "wlccp.scm_election_group",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_scm_attach_count,\r\n{ "Attach Count", "wlccp.scm_attach_count",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"Attach count of the hop source", HFILL }\r\n},\r\n{ &hf_wlccp_scm_priority_flags,\r\n{ "SCM Priority flags", "wlccp.scm_priority_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_scm_priority,\r\n{ "SCM Priority", "wlccp.scm_priority",\r\nFT_UINT8, BASE_DEC, NULL,\r\nF_SCM_PRIORITY, NULL, HFILL }\r\n},\r\n{ &hf_wlccp_scm_preferred_flag,\r\n{ "Preferred flag", "wlccp.scm_preferred_flag",\r\nFT_UINT8, BASE_DEC, NULL,\r\nF_SCM_PREFERRED, "Set to off if the SCM is the preferred SCM", HFILL }\r\n},\r\n{ &hf_wlccp_scm_bridge_priority_flags,\r\n{ "Bridge Priority flags", "wlccp.scm_bridge_priority_flags",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_scm_bridge_priority,\r\n{ "Bridge priority", "wlccp.scm_bridge_priority",\r\nFT_UINT8, BASE_DEC, NULL,\r\nF_SCM_BRIDGE_PRIORITY, "Used to negotiate the designated bridge on a non-STP secondary Ethernet LAN", HFILL }\r\n},\r\n{ &hf_wlccp_scm_bridge_disable_flag,\r\n{ "Bridge disable flag", "wlccp.scm_bridge_disable_flag",\r\nFT_UINT8, BASE_DEC, NULL,\r\nF_SCM_BRIDGE_DISABLE, "Set to on to indicate that secondary briding is disabled", HFILL }\r\n},\r\n{ &hf_wlccp_scm_node_id,\r\n{ "SCM Node ID", "wlccp.scm_node_id",\r\nFT_ETHER, BASE_NONE, NULL,\r\n0x0, "Node ID of the SCM", HFILL }\r\n},\r\n{ &hf_wlccp_scm_unknown_short,\r\n{ "Unknown Short", "wlccp.scm_unknown_short",\r\nFT_UINT16, BASE_HEX, NULL,\r\n0x0, "SCM Unknown Short Value", HFILL }\r\n},\r\n{ &hf_wlccp_scm_instance_age,\r\n{ "Instance Age", "wlccp.scm_instance_age",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"Instance age of the SCM in seconds", HFILL }\r\n},\r\n{ &hf_wlccp_scm_path_cost,\r\n{ "Path cost", "wlccp.scm_path_cost",\r\nFT_UINT16, BASE_DEC, NULL,\r\n0x0, "Sum of port costs on the path to the SCM", HFILL }\r\n},\r\n{ &hf_wlccp_scm_hop_count,\r\n{ "Hop Count", "wlccp.scm_hop_count",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"Number of wireless hops on the path to SCM", HFILL }\r\n},\r\n{ &hf_wlccp_scm_advperiod,\r\n{ "Advertisement Period", "wlccp.scm_advperiod",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"Average number of seconds between SCM advertisements", HFILL }\r\n},\r\n{ &hf_wlccp_timestamp,\r\n{ "Timestamp", "wlccp.timestamp",\r\nFT_UINT64, BASE_DEC, NULL, 0,\r\n"Registration Timestamp", HFILL }\r\n},\r\n{ &hf_wlccp_apregstatus,\r\n{ "Registration Status", "wlccp.apregstatus",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\n"AP Registration Status", HFILL }\r\n},\r\n{ &hf_wlccp_ap_node_id,\r\n{ "AP Node ID", "wlccp.apnodeid",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_ap_node_type,\r\n{ "AP Node Type", "wlccp.apnodetype",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_ap_node_id_address,\r\n{ "AP Node Address", "wlccp.apnodeidaddress",\r\nFT_ETHER, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_aaa_msg_type,\r\n{ "AAA Message Type", "wlccp.aaa_msg_type",\r\nFT_UINT8, BASE_HEX, VALS(wlccp_aaa_msg_type_vs), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_aaa_auth_type,\r\n{ "AAA Authentication Type", "wlccp.aaa_auth_type",\r\nFT_UINT8, BASE_HEX, VALS(wlccp_eapol_auth_type_vs), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_keymgmt_type,\r\n{ "AAA Key Management Type", "wlccp.aaa_keymgmt_type",\r\nFT_UINT8, BASE_HEX, VALS(wlccp_key_mgmt_type_vs), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_eapol_msg,\r\n{ "EAPOL Message", "wlccp.eapol_msg",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_eapol_version,\r\n{ "EAPOL Version", "wlccp.eapol_version",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_eapol_type,\r\n{ "EAPOL Type", "wlccp.eapol_type",\r\nFT_UINT8, BASE_HEX, VALS(eapol_type_vs), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_eap_msg_length,\r\n{ "EAP Packet Length", "wlccp.eap_pkt_length",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n"EAPOL Type", HFILL }\r\n},\r\n{ &hf_wlccp_eap_msg,\r\n{ "EAP Message", "wlccp.eap_msg",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_cisco_acctg_msg,\r\n{ "Cisco Accounting Message", "wlccp.cisco_acctg_msg",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_wids_msg_type,\r\n{ "WIDS Message Type", "wlccp.wids_msg_type",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_nmconfig,\r\n{ "NM Config", "wlccp.nmconfig",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_scmstate_change,\r\n{ "SCM State Change", "wlccp.scmstate_change",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_scmstate_change_reason,\r\n{ "SCM State Change Reason", "wlccp.scmstate_change_reason",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_scmattach_state,\r\n{ "SCM Attach State", "wlccp.scmattach_state",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_nmcapability,\r\n{ "NM Capability", "wlccp.nm_capability",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_refresh_req_id,\r\n{ "Refresh Request ID", "wlccp.refresh_request_id",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_tlv,\r\n{ "WLCCP TLV", "wlccp.tlv",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tlv_flags,\r\n{ "TLV Flags", "wlccp.tlv_flags",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"TLV Flags, Group and Type", HFILL }\r\n},\r\n{ &hf_wlccp_null_tlv,\r\n{ "NULL TLV", "wlccp.null_tlv",\r\nFT_BYTES, BASE_NONE, NULL ,\r\n0, NULL, HFILL }\r\n},\r\n{ &hf_wlccp_tlv_type,\r\n{ "TLV Type", "wlccp.tlv_type",\r\nFT_UINT16, BASE_DEC, NULL ,\r\nTLV_TYPE_ID, "TLV Type ID", HFILL }\r\n},\r\n{ &hf_wlccp_tlv_type0,\r\n{ "TLV Type", "wlccp.tlv_type",\r\nFT_UINT16, BASE_DEC, VALS(wlccp_tlv_typeID_0),\r\nTLV_TYPE_ID, "TLV Type ID", HFILL }\r\n},\r\n{ &hf_wlccp_tlv_type1,\r\n{ "TLV Type", "wlccp.tlv_type",\r\nFT_UINT16, BASE_DEC, VALS(wlccp_tlv_typeID_1),\r\nTLV_TYPE_ID, "TLV Type ID", HFILL }\r\n},\r\n{ &hf_wlccp_tlv_type2,\r\n{ "TLV Type", "wlccp.tlv_type",\r\nFT_UINT16, BASE_DEC, VALS(wlccp_tlv_typeID_2),\r\nTLV_TYPE_ID, "TLV Type ID", HFILL }\r\n},\r\n{ &hf_wlccp_tlv_type3,\r\n{ "TLV Type", "wlccp.tlv_type",\r\nFT_UINT16, BASE_DEC, VALS(wlccp_tlv_typeID_3),\r\nTLV_TYPE_ID, "TLV Type ID", HFILL }\r\n},\r\n{ &hf_wlccp_tlv_type4,\r\n{ "TLV Type", "wlccp.tlv_type",\r\nFT_UINT16, BASE_DEC, VALS(wlccp_tlv_typeID_4),\r\nTLV_TYPE_ID, "TLV Type ID", HFILL }\r\n},\r\n{ &hf_wlccp_tlv_type5,\r\n{ "TLV Type", "wlccp.tlv_type",\r\nFT_UINT16, BASE_DEC, VALS(wlccp_tlv_typeID_5),\r\nTLV_TYPE_ID, "TLV Type ID", HFILL }\r\n},\r\n{ &hf_wlccp_tlv_group,\r\n{ "TLV Group", "wlccp.tlv_group",\r\nFT_UINT16, BASE_DEC, VALS(wlccp_tlv_group_vs) ,\r\nTLV_GROUP_ID, "TLV Group ID", HFILL }\r\n},\r\n{ &hf_wlccp_tlv_container_flag,\r\n{ "TLV Container Flag", "wlccp.tlv_container_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nTLV_F_CONTAINER, "Set on if the TLV is a container", HFILL }\r\n},\r\n{ &hf_wlccp_tlv_encrypted_flag,\r\n{ "TLV Encrypted Flag", "wlccp.tlv_encrypted_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nTLV_F_ENCRYPTED, "Set on if the TLV is encrypted", HFILL }\r\n},\r\n{ &hf_wlccp_tlv_reserved_bit,\r\n{ "Reserved bits", "wlccp.tlv_reserved_bit",\r\nFT_UINT16, BASE_DEC, NULL,\r\nTLV_F_RESVD, "Reserved", HFILL }\r\n},\r\n{ &hf_wlccp_tlv_request_flag,\r\n{ "TLV Request Flag", "wlccp.tlv_request_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nTLV_F_REQUEST, "Set on if the TLV is a request", HFILL }\r\n},\r\n{ &hf_wlccp_tlv_length,\r\n{ "TLV Length", "wlccp.tlv_length",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_path_length,\r\n{ "Path Length", "wlccp.path_length",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_mic_msg_seq_count,\r\n{ "MIC Message Sequence Count", "wlccp.mic_msg_seq_count",\r\nFT_UINT64, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_mic_length,\r\n{ "MIC Length", "wlccp.mic_length",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_mic_value,\r\n{ "MIC Value", "wlccp.mic_value",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_dest_node_type,\r\n{ "Destination node type", "wlccp.dest_node_type",\r\nFT_UINT16, BASE_DEC, VALS(wlccp_node_type_vs),\r\n0x0, NULL, HFILL }\r\n},\r\n{ &hf_wlccp_dest_node_id,\r\n{ "Destination node ID", "wlccp.dest_node_id",\r\nFT_ETHER, BASE_NONE, NULL,\r\n0x0, NULL, HFILL }\r\n},\r\n{ &hf_wlccp_supp_node_type,\r\n{ "Destination node type", "wlccp.supp_node_type",\r\nFT_UINT16, BASE_DEC, VALS(wlccp_node_type_vs),\r\n0x0, NULL, HFILL }\r\n},\r\n{ &hf_wlccp_supp_node_id,\r\n{ "Supporting node ID", "wlccp.supp_node_id",\r\nFT_ETHER, BASE_NONE, NULL,\r\n0x0, NULL, HFILL }\r\n},\r\n{ &hf_wlccp_src_node_type,\r\n{ "Source node type", "wlccp.source_node_type",\r\nFT_UINT16, BASE_DEC, VALS(wlccp_node_type_vs),\r\n0x0, NULL, HFILL }\r\n},\r\n{ &hf_wlccp_src_node_id,\r\n{ "Source node ID", "wlccp.source_node_id",\r\nFT_ETHER, BASE_NONE, NULL,\r\n0x0, NULL, HFILL }\r\n},\r\n{ &hf_wlccp_key_mgmt_type,\r\n{ "Key Management type", "wlccp.key_mgmt_type",\r\nFT_UINT8, BASE_HEX, NULL,\r\n0x0, NULL, HFILL }\r\n},\r\n{ &hf_wlccp_key_seq_count,\r\n{ "Key Sequence Count", "wlccp.key_seq_count",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_session_timeout,\r\n{ "Session Timeout", "wlccp.session_timeout",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_nonce,\r\n{ "Nonce Value", "wlccp.nonce_value",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_token,\r\n{ "Token", "wlccp.token",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_scan_mode,\r\n{ "Scan Mode", "wlccp.scan_mode",\r\nFT_UINT8, BASE_HEX, NULL,\r\n0, NULL, HFILL }\r\n},\r\n{ &hf_wlccp_mode,\r\n{ "Mode", "wlccp.mode",\r\nFT_UINT8, BASE_HEX, VALS(wlccp_mode_vs),\r\n0, NULL, HFILL }\r\n},\r\n{ &hf_wlccp_rss,\r\n{ "RSS", "wlccp.rss",\r\nFT_INT8, BASE_DEC, NULL, 0,\r\n"Received Signal Strength", HFILL }\r\n},\r\n{ &hf_wlccp_srcidx,\r\n{ "Source Index", "wlccp.srcidx",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_parent_tsf,\r\n{ "Parent TSF", "wlccp.parenttsf",\r\nFT_UINT32, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_target_tsf,\r\n{ "Target TSF", "wlccp.targettsf",\r\nFT_UINT64, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_channel,\r\n{ "Channel", "wlccp.channel",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_phy_type,\r\n{ "PHY Type", "wlccp.phy_type",\r\nFT_UINT8, BASE_DEC, VALS(phy_type_80211_vs), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_bssid,\r\n{ "BSS ID", "wlccp.bssid",\r\nFT_ETHER, BASE_NONE, NULL, 0,\r\n"Basic Service Set ID", HFILL }\r\n},\r\n{ &hf_wlccp_beacon_interval,\r\n{ "Beacon Interval", "wlccp.beacon_interval",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_80211_capabilities,\r\n{ "802.11 Capabilities Flags", "wlccp.80211_capabilities",\r\nFT_UINT16, BASE_HEX, NULL,\r\n0x0, NULL, HFILL }\r\n},\r\n{ &hf_80211_cap_ess,\r\n{ "ESS flag", "wlccp.80211_ess_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_80211_ESS, "Set on by APs in Beacon or Probe Response", HFILL }\r\n},\r\n{ &hf_80211_cap_ibss,\r\n{ "IBSS flag", "wlccp.80211_ibss_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_80211_IBSS, "Set on by STAs in Beacon or Probe Response", HFILL }\r\n},\r\n{ &hf_80211_cap_cf_pollable,\r\n{ "CF Pollable flag", "wlccp.80211_cf_pollable_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_80211_CFPOLL, NULL, HFILL }\r\n},\r\n{ &hf_80211_cap_cf_poll_req,\r\n{ "CF Poll Request flag", "wlccp.80211_cf_poll_req_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_80211_CFPOLL_REQ, NULL, HFILL }\r\n},\r\n{ &hf_80211_cap_privacy,\r\n{ "Privacy flag", "wlccp.80211_cf_poll_req_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_80211_PRIVACY, "Set on indicate confidentiality is required in the BSS", HFILL }\r\n},\r\n{ &hf_80211_short_preamble,\r\n{ "Short Preamble flag", "wlccp.80211_short_preamble_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_80211_SHORT_PREAMBLE, NULL, HFILL }\r\n},\r\n{ &hf_80211_pbcc,\r\n{ "PBCC flag", "wlccp.80211_pbcc_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_80211_PBCC, NULL, HFILL }\r\n},\r\n{ &hf_80211_chan_agility,\r\n{ "Channel Agility flag", "wlccp.80211_chan_agility_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_80211_CH_AGILITY, NULL, HFILL }\r\n},\r\n{ &hf_80211_spectrum_mgmt,\r\n{ "Spectrum Management flag", "wlccp.80211_spectrum_mgmt_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_80211_SPEC_MGMT, NULL, HFILL }\r\n},\r\n{ &hf_80211_qos,\r\n{ "QOS flag", "wlccp.80211_qos_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_80211_QOS, NULL, HFILL }\r\n},\r\n{ &hf_80211_short_time_slot,\r\n{ "Short Time Slot flag", "wlccp.80211_short_time_slot_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_80211_SHORT_TIME_SLOT, NULL, HFILL }\r\n},\r\n{ &hf_80211_apsd,\r\n{ "APSD flag", "wlccp.80211_apsd_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_80211_APSD, NULL, HFILL }\r\n},\r\n{ &hf_80211_reserved,\r\n{ "Reserved", "wlccp.80211_reserved",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_80211_RESVD, NULL, HFILL }\r\n},\r\n{ &hf_80211_dsss_ofdm,\r\n{ "DSSS-OFDM Flag", "wlccp.dsss_ofdm_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_80211_DSSS_OFDM, NULL, HFILL }\r\n},\r\n{ &hf_80211_dlyd_block_ack,\r\n{ "Delayed Block Ack Flag", "wlccp.dsss_dlyd_block_ack_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_80211_DLYD_BLK_ACK, NULL, HFILL }\r\n},\r\n{ &hf_80211_imm_block_ack,\r\n{ "Immediate Block Ack Flag", "wlccp.dsss_imm_block_ack_flag",\r\nFT_UINT16, BASE_DEC, NULL,\r\nF_80211_IMM_BLK_ACK, NULL, HFILL }\r\n},\r\n{ &hf_wlccp_tlv80211,\r\n{ "802.11 TLV Value", "wlccp.tlv80211",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_duration,\r\n{ "Duration", "wlccp.duration",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_rpidensity,\r\n{ "RPI Density", "wlccp.rpi_denisty",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_ccabusy,\r\n{ "CCA Busy", "wlccp.cca_busy",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_stamac,\r\n{ "Station MAC", "wlccp.station_mac",\r\nFT_ETHER, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_sta_type,\r\n{ "Station Type", "wlccp.station_type",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_token2,\r\n{ "2 Byte Token", "wlccp.token2",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_interval,\r\n{ "Interval", "wlccp.interval",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_framereport_elements,\r\n{ "Frame Report Elements", "wlccp.framereport_elements",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_count,\r\n{ "Element Count", "wlccp.element_count",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_numframes,\r\n{ "Number of frames", "wlccp.numframes",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_mfpcapability,\r\n{ "MFP Capability", "wlccp.mfp_capability",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_mfpflags,\r\n{ "MFP Flags", "wlccp.mfp_flags",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_mfpconfig,\r\n{ "MFP Config", "wlccp.mfp_config",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_clientmac,\r\n{ "Client MAC", "wlccp.client_mac",\r\nFT_ETHER, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_reg_lifetime,\r\n{ "Reg. LifeTime", "wlccp.reg_lifetime",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_time_elapsed,\r\n{ "Elapsed Time", "wlccp.time_elapsed",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_parent_ap_mac,\r\n{ "Parent AP MAC", "wlccp.parent_ap_mac",\r\nFT_ETHER, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_auth_type,\r\n{ "Authentication Type", "wlccp.auth_type",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_radius_user_name,\r\n{ "RADIUS Username", "wlccp.radius_username",\r\nFT_STRING, BASE_NONE, NULL,\r\n0x0, NULL, HFILL }\r\n},\r\n{ &hf_wds_reason,\r\n{ "Reason Code", "wlccp.wds_reason",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_wlccp_tlv_unknown_value,\r\n{ "Unknown TLV Contents", "wlccp.tlv_unknown_value",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n}\r\n};\r\nstatic hf_register_info oui_hf[] = {\r\n{ &hf_llc_wlccp_pid,\r\n{ "PID", "llc.wlccp_pid",\r\nFT_UINT16, BASE_HEX, VALS(cisco_pid_vals),\r\n0x0, NULL, HFILL }\r\n}\r\n};\r\nstatic gint *ett[] = {\r\n&ett_wlccp,\r\n&ett_wlccp_sap_tree,\r\n&ett_wlccp_type,\r\n&ett_wlccp_flags,\r\n&ett_wlccp_cm_flags,\r\n&ett_wlccp_scm_flags,\r\n&ett_wlccp_scm_priority_flags,\r\n&ett_wlccp_scm_bridge_priority_flags,\r\n&ett_wlccp_rm_flags,\r\n&ett_wlccp_nm_flags,\r\n&ett_wlccp_ap_node_id,\r\n&ett_wlccp_eapol_msg_tree,\r\n&ett_wlccp_eap_tree,\r\n&ett_wlccp_tlv_tree,\r\n&ett_tlv_flags_tree,\r\n&ett_tlv_sub_tree,\r\n&ett_80211_capability_flags_tree,\r\n&ett_framereport_elements_tree\r\n};\r\nproto_wlccp = proto_register_protocol("Cisco Wireless LAN Context Control Protocol", "WLCCP", "wlccp");\r\nproto_register_field_array(proto_wlccp, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nllc_add_oui(OUI_CISCOWL, "llc.wlccp_pid", "LLC Cisco WLCCP OUI PID", oui_hf, proto_wlccp);\r\n}\r\nvoid\r\nproto_reg_handoff_wlccp(void)\r\n{\r\ndissector_handle_t wlccp_handle;\r\nwlccp_handle = create_dissector_handle(dissect_wlccp, proto_wlccp);\r\ndissector_add_uint("ethertype", ETHERTYPE_WLCCP, wlccp_handle);\r\ndissector_add_uint("udp.port", WLCCP_UDP_PORT, wlccp_handle);\r\ndissector_add_uint("llc.wlccp_pid", 0x0000, wlccp_handle);\r\n}
