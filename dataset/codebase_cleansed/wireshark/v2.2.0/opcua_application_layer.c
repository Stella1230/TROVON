void registerApplicationLayerTypes(int proto)\r\n{\r\nstatic hf_register_info hf[] =\r\n{\r\n{&hf_opcua_nodeid_encodingmask, {"NodeId EncodingMask", "opcua.servicenodeid.encodingmask", FT_UINT8, BASE_HEX, VALS(g_nodeidmasks), 0x0, NULL, HFILL}},\r\n{&hf_opcua_app_nsid, {"NodeId Namespace Index", "opcua.servicenodeid.nsid", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL}},\r\n{&hf_opcua_app_numeric, {"NodeId Identifier Numeric", "opcua.servicenodeid.numeric", FT_UINT32, BASE_DEC, VALS(g_requesttypes), 0x0, NULL, HFILL}}\r\n};\r\nproto_register_field_array(proto, hf, array_length(hf));\r\n}\r\nint parseServiceNodeId(proto_tree *tree, tvbuff_t *tvb, gint *pOffset)\r\n{\r\ngint iOffset = *pOffset;\r\nguint8 EncodingMask;\r\nguint32 Numeric = 0;\r\nEncodingMask = tvb_get_guint8(tvb, iOffset);\r\nproto_tree_add_item(tree, hf_opcua_nodeid_encodingmask, tvb, iOffset, 1, ENC_LITTLE_ENDIAN);\r\niOffset++;\r\nswitch(EncodingMask)\r\n{\r\ncase 0x00:\r\nNumeric = tvb_get_guint8(tvb, iOffset);\r\nproto_tree_add_item(tree, hf_opcua_app_numeric, tvb, iOffset, 1, ENC_LITTLE_ENDIAN);\r\niOffset+=1;\r\nbreak;\r\ncase 0x01:\r\nproto_tree_add_item(tree, hf_opcua_app_nsid, tvb, iOffset, 1, ENC_LITTLE_ENDIAN);\r\niOffset+=1;\r\nNumeric = tvb_get_letohs(tvb, iOffset);\r\nproto_tree_add_item(tree, hf_opcua_app_numeric, tvb, iOffset, 2, ENC_LITTLE_ENDIAN);\r\niOffset+=2;\r\nbreak;\r\ncase 0x02:\r\nproto_tree_add_item(tree, hf_opcua_app_nsid, tvb, iOffset, 2, ENC_LITTLE_ENDIAN);\r\niOffset+=2;\r\nNumeric = tvb_get_letohl(tvb, iOffset);\r\nproto_tree_add_item(tree, hf_opcua_app_numeric, tvb, iOffset, 4, ENC_LITTLE_ENDIAN);\r\niOffset+=4;\r\nbreak;\r\ncase 0x03:\r\ncase 0x04:\r\ncase 0x05:\r\nbreak;\r\n};\r\n*pOffset = iOffset;\r\nreturn Numeric;\r\n}
