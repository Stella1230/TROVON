static const gchar *get_sw_string(guint16 sw)\r\n{\r\nguint8 sw1 = sw >> 8;\r\nswitch (sw1) {\r\ncase 0x91:\r\nreturn "Normal ending of command with info from proactive SIM";\r\ncase 0x9e:\r\nreturn "Length of the response data given / SIM data download error";\r\ncase 0x9f:\r\nreturn "Length of the response data";\r\ncase 0x92:\r\nif ((sw & 0xf0) == 0x00)\r\nreturn "Command successful but after internal retry routine";\r\nbreak;\r\ncase 0x67:\r\nreturn "Incorrect parameter P3";\r\ncase 0x6d:\r\nreturn "Unknown instruction code";\r\ncase 0x6e:\r\nreturn "Wrong instruction class";\r\ncase 0x6f:\r\nreturn "Technical problem with no diagnostic";\r\n}\r\nreturn val_to_str(sw, sw_vals, "%04x");\r\n}\r\nstatic int\r\ndissect_bertlv(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nunsigned int pos = 0;\r\nwhile (pos < tvb_reported_length(tvb)) {\r\nguint8 tag;\r\nguint32 len;\r\ntvbuff_t *subtvb;\r\nproto_tree_add_item(tree, hf_cat_ber_tag, tvb, pos, 1, ENC_BIG_ENDIAN);\r\ntag = tvb_get_guint8(tvb, pos++);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s ",\r\nval_to_str(tag, ber_tlv_cat_tag_vals, "%02x "));\r\nlen = tvb_get_guint8(tvb, pos++);\r\nswitch (len) {\r\ncase 0x81:\r\nlen = tvb_get_guint8(tvb, pos++);\r\nbreak;\r\ncase 0x82:\r\nlen = tvb_get_ntohs(tvb, pos);\r\npos += 2;\r\nbreak;\r\ncase 0x83:\r\nlen = tvb_get_ntoh24(tvb, pos);\r\npos += 3;\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nsubtvb = tvb_new_subset_length(tvb, pos, len);\r\nswitch (tag) {\r\ncase 0xD0:\r\ncase 0xD1:\r\ncase 0xD6:\r\ncase 0xD7:\r\ncall_dissector_with_data(sub_handle_cap, subtvb, pinfo, tree, GUINT_TO_POINTER((guint)tag));\r\nbreak;\r\n}\r\npos += len;\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic int\r\ndissect_gsm_apdu(guint8 ins, guint8 p1, guint8 p2, guint8 p3, tvbuff_t *tvb,\r\nint offset, packet_info *pinfo, proto_tree *tree, gboolean isSIMtrace)\r\n{\r\nguint8 g8;\r\nguint16 g16;\r\ntvbuff_t *subtvb;\r\nint i, start_offset;\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s ",\r\nval_to_str(ins, apdu_ins_vals, "%02x"));\r\nswitch (ins) {\r\ncase 0xA4:\r\nif (p3 < 2)\r\nbreak;\r\nswitch (p1) {\r\ncase 0x03:\r\ncol_append_str(pinfo->cinfo, COL_INFO, "Parent DF ");\r\nbreak;\r\ncase 0x04:\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "Application %s ",\r\ntvb_bytes_to_str(wmem_packet_scope(), tvb, offset+DATA_OFFS, p3));\r\nproto_tree_add_item(tree, hf_aid, tvb, offset+DATA_OFFS, p3, ENC_NA);\r\nbreak;\r\ncase 0x09:\r\ncol_append_str(pinfo->cinfo, COL_INFO, ".");\r\ncase 0x08:\r\nfor (i = 0; i < p3; i += 2) {\r\ng16 = tvb_get_ntohs(tvb, offset+DATA_OFFS+i);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "/%s",\r\nval_to_str(g16, mf_dfs, "%04x"));\r\nproto_tree_add_item(tree, hf_file_id, tvb, offset+DATA_OFFS+i, 2, ENC_BIG_ENDIAN);\r\n}\r\ncol_append_str(pinfo->cinfo, COL_INFO, " ");\r\nbreak;\r\ndefault:\r\ng16 = tvb_get_ntohs(tvb, offset+DATA_OFFS);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "File %s ",\r\nval_to_str(g16, mf_dfs, "%04x"));\r\nproto_tree_add_item(tree, hf_file_id, tvb, offset+DATA_OFFS, p3, ENC_BIG_ENDIAN);\r\noffset++;\r\nbreak;\r\n}\r\nbreak;\r\ncase 0xF2:\r\nbreak;\r\ncase 0xB0:\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "Offset=%u ", p1 << 8 | p2);\r\nproto_tree_add_item(tree, hf_bin_offset, tvb, offset+P1_OFFS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_le, tvb, offset+P3_OFFS, 1, ENC_BIG_ENDIAN);\r\nif (isSIMtrace) {\r\nproto_tree_add_item(tree, hf_apdu_data, tvb, offset+DATA_OFFS, p3, ENC_NA);\r\n}\r\nbreak;\r\ncase 0xD6:\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "Offset=%u ", p1 << 8 | p2);\r\nproto_tree_add_item(tree, hf_bin_offset, tvb, offset+P1_OFFS, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_apdu_data, tvb, offset+DATA_OFFS, p3, ENC_NA);\r\nbreak;\r\ncase 0xB2:\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "RecordNr=%u ", p1);\r\nproto_tree_add_item(tree, hf_record_nr, tvb, offset+P1_OFFS, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_le, tvb, offset+P3_OFFS, 1, ENC_BIG_ENDIAN);\r\nif (isSIMtrace) {\r\nproto_tree_add_item(tree, hf_apdu_data, tvb, offset+DATA_OFFS, p3, ENC_NA);\r\n}\r\nbreak;\r\ncase 0xDC:\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "RecordNr=%u ", p1);\r\nproto_tree_add_item(tree, hf_record_nr, tvb, offset+P1_OFFS, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_apdu_data, tvb, offset+DATA_OFFS, p3, ENC_NA);\r\nbreak;\r\ncase 0xA2:\r\nproto_tree_add_item(tree, hf_seek_mode, tvb, offset+P2_OFFS, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_seek_type, tvb, offset+P2_OFFS, 1, ENC_BIG_ENDIAN);\r\noffset += DATA_OFFS;\r\nproto_tree_add_item(tree, hf_apdu_data, tvb, offset, p3, ENC_NA);\r\noffset += p3;\r\nif ((p2 & 0xF0) == 0x20)\r\nproto_tree_add_item(tree, hf_seek_rec_nr, tvb, offset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x32:\r\nbreak;\r\ncase 0x20:\r\ncase 0x24:\r\ncase 0x26:\r\ncase 0x28:\r\ncase 0x2C:\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "CHV=%u ", p2);\r\noffset += DATA_OFFS;\r\nbreak;\r\ncase 0x88:\r\noffset += DATA_OFFS;\r\nproto_tree_add_item(tree, hf_auth_rand, tvb, offset, 16, ENC_NA);\r\noffset += 16;\r\nif (isSIMtrace) {\r\nproto_tree_add_item(tree, hf_auth_sres, tvb, offset, 4, ENC_NA);\r\noffset += 4;\r\nproto_tree_add_item(tree, hf_auth_kc, tvb, offset, 8, ENC_NA);\r\noffset += 8;\r\n}\r\nbreak;\r\ncase 0x10:\r\noffset += DATA_OFFS;\r\nstart_offset = offset;\r\nADD_TP_BYTE(1);\r\nADD_TP_BYTE(2);\r\nADD_TP_BYTE(3);\r\nADD_TP_BYTE(4);\r\nADD_TP_BYTE(5);\r\nADD_TP_BYTE(6);\r\nADD_TP_BYTE(7);\r\nADD_TP_BYTE(8);\r\nADD_TP_BYTE(9);\r\nADD_TP_BYTE(10);\r\nADD_TP_BYTE(11);\r\nADD_TP_BYTE(12);\r\nADD_TP_BYTE(13);\r\nADD_TP_BYTE(14);\r\nADD_TP_BYTE(15);\r\nADD_TP_BYTE(16);\r\nADD_TP_BYTE(17);\r\nADD_TP_BYTE(18);\r\nADD_TP_BYTE(19);\r\nADD_TP_BYTE(20);\r\nADD_TP_BYTE(21);\r\nADD_TP_BYTE(22);\r\nADD_TP_BYTE(23);\r\nADD_TP_BYTE(24);\r\nADD_TP_BYTE(25);\r\nADD_TP_BYTE(26);\r\nADD_TP_BYTE(27);\r\nADD_TP_BYTE(28);\r\nADD_TP_BYTE(29);\r\nADD_TP_BYTE(30);\r\nADD_TP_BYTE(31);\r\nADD_TP_BYTE(32);\r\nADD_TP_BYTE(33);\r\nwhile ((offset - start_offset) < p3) {\r\nproto_tree_add_item(tree, hf_tprof_unknown_byte, tvb, offset++, 1, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase 0x12:\r\nproto_tree_add_item(tree, hf_le, tvb, offset+P3_OFFS, 1, ENC_BIG_ENDIAN);\r\nif (isSIMtrace) {\r\nsubtvb = tvb_new_subset_length(tvb, offset+DATA_OFFS, (p3 == 0) ? 256 : p3);\r\ndissect_bertlv(subtvb, pinfo, tree, NULL);\r\n}\r\nbreak;\r\ncase 0x14:\r\nsubtvb = tvb_new_subset_length(tvb, offset+DATA_OFFS, p3);\r\ncall_dissector_with_data(sub_handle_cap, subtvb, pinfo, tree, GUINT_TO_POINTER(0x14));\r\nbreak;\r\ncase 0x70:\r\nproto_tree_add_item(tree, hf_chan_op, tvb, offset-3, 1, ENC_BIG_ENDIAN);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "Operation=%s ",\r\nval_to_str(p1, chan_op_vals, "%02x"));\r\nswitch (p1) {\r\ncase 0x00:\r\nproto_tree_add_item(tree, hf_chan_nr, tvb, offset+DATA_OFFS, 1, ENC_BIG_ENDIAN);\r\ng8 = tvb_get_guint8(tvb, offset+DATA_OFFS);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "Channel=%d ", g8);\r\nbreak;\r\ncase 0x80:\r\nproto_tree_add_item(tree, hf_chan_nr, tvb, offset-2, 1, ENC_BIG_ENDIAN);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "Channel=%d ", p2);\r\nbreak;\r\n}\r\nbreak;\r\ncase 0xC0:\r\nproto_tree_add_item(tree, hf_le, tvb, offset+P3_OFFS, 1, ENC_BIG_ENDIAN);\r\nif (isSIMtrace) {\r\nproto_tree_add_item(tree, hf_apdu_data, tvb, offset+DATA_OFFS, p3, ENC_NA);\r\n}\r\nbreak;\r\ncase 0xC2:\r\nproto_tree_add_item(tree, hf_le, tvb, offset+P3_OFFS, 1, ENC_BIG_ENDIAN);\r\nsubtvb = tvb_new_subset_length(tvb, offset+DATA_OFFS, p3);\r\ndissect_bertlv(subtvb, pinfo, tree, NULL);\r\nbreak;\r\ncase 0x04:\r\ncase 0x44:\r\ndefault:\r\nreturn -1;\r\n}\r\nreturn offset;\r\n}\r\nstatic gint\r\ndissect_rsp_apdu_tvb(tvbuff_t *tvb, gint offset, packet_info *pinfo, proto_tree *tree, proto_tree *sim_tree)\r\n{\r\nguint16 sw;\r\nproto_item *ti;\r\nguint tvb_len = tvb_reported_length(tvb);\r\nif (tree && !sim_tree) {\r\nti = proto_tree_add_item(tree, proto_gsm_sim, tvb, 0, -1, ENC_NA);\r\nsim_tree = proto_item_add_subtree(ti, ett_sim);\r\n}\r\nif ((tvb_len-offset) > 2) {\r\nproto_tree_add_item(sim_tree, hf_apdu_data, tvb, offset, tvb_len - 2, ENC_NA);\r\n}\r\noffset = tvb_len - 2;\r\nsw = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_uint_format(sim_tree, hf_apdu_sw, tvb, offset, 2, sw,\r\n"Status Word: %04x %s", sw, get_sw_string(sw));\r\noffset += 2;\r\nswitch (sw >> 8) {\r\ncase 0x61:\r\ncase 0x90:\r\ncase 0x91:\r\ncase 0x92:\r\ncase 0x9e:\r\ncase 0x9f:\r\nbreak;\r\ndefault:\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ": %s ", get_sw_string(sw));\r\nbreak;\r\n}\r\nreturn offset;\r\n}\r\nstatic gint\r\ndissect_cmd_apdu_tvb(tvbuff_t *tvb, gint offset, packet_info *pinfo, proto_tree *tree, gboolean isSIMtrace)\r\n{\r\nguint8 cla, ins, p1, p2, p3;\r\nproto_item *ti;\r\nproto_tree *sim_tree = NULL;\r\ngint rc = -1;\r\nguint tvb_len = tvb_reported_length(tvb);\r\ncla = tvb_get_guint8(tvb, offset);\r\nins = tvb_get_guint8(tvb, offset+1);\r\np1 = tvb_get_guint8(tvb, offset+2);\r\np2 = tvb_get_guint8(tvb, offset+3);\r\np3 = tvb_get_guint8(tvb, offset+4);\r\nif (tree) {\r\nti = proto_tree_add_item(tree, proto_gsm_sim, tvb, 0, -1, ENC_NA);\r\nsim_tree = proto_item_add_subtree(ti, ett_sim);\r\nif ((cla & 0x50) == 0x40) {\r\nproto_tree_add_item(sim_tree, hf_apdu_cla_coding_ext, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sim_tree, hf_apdu_cla_secure_messaging_ind_ext, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sim_tree, hf_apdu_cla_log_chan_ext, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n} else {\r\nproto_tree_add_item(sim_tree, hf_apdu_cla_coding, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sim_tree, hf_apdu_cla_secure_messaging_ind, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sim_tree, hf_apdu_cla_log_chan, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nproto_tree_add_item(sim_tree, hf_apdu_ins, tvb, offset+1, 1, ENC_BIG_ENDIAN);\r\n}\r\noffset += 2;\r\nif ((cla & 0x50) == 0x40) {\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s ",\r\nval_to_str(cla>>6, apdu_cla_coding_ext_vals, "%01x"));\r\n} else {\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s ",\r\nval_to_str(cla>>4, apdu_cla_coding_vals, "%01x"));\r\n}\r\nrc = dissect_gsm_apdu(ins, p1, p2, p3, tvb, offset, pinfo, sim_tree, isSIMtrace);\r\nif (rc == -1 && sim_tree) {\r\nproto_tree_add_item(sim_tree, hf_apdu_p1, tvb, offset+0, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sim_tree, hf_apdu_p2, tvb, offset+1, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sim_tree, hf_apdu_p3, tvb, offset+2, 1, ENC_BIG_ENDIAN);\r\nif (p3 && (p3 <= tvb_reported_length_remaining(tvb, offset+3))) {\r\nproto_tree_add_item(sim_tree, hf_apdu_data, tvb, offset+3, p3, ENC_NA);\r\n}\r\n}\r\noffset += 3+p3;\r\nif (isSIMtrace) {\r\nreturn dissect_rsp_apdu_tvb(tvb, tvb_len-2, pinfo, tree, sim_tree);\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_gsm_sim(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "GSM SIM");\r\ndissect_cmd_apdu_tvb(tvb, 0, pinfo, tree, TRUE);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic int\r\ndissect_gsm_sim_command(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "GSM SIM");\r\ndissect_cmd_apdu_tvb(tvb, 0, pinfo, tree, FALSE);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic int\r\ndissect_gsm_sim_response(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "GSM SIM");\r\ndissect_rsp_apdu_tvb(tvb, 0, pinfo, tree, NULL);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_gsm_sim(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_apdu_cla_coding,\r\n{ "Class Coding", "gsm_sim.apdu.cla.coding",\r\nFT_UINT8, BASE_HEX, VALS(apdu_cla_coding_vals), 0xf0,\r\n"ISO 7816-4 APDU CLA (Class) Byte", HFILL }\r\n},\r\n{ &hf_apdu_cla_coding_ext,\r\n{ "Class Coding", "gsm_sim.apdu.cla.coding",\r\nFT_UINT8, BASE_HEX, VALS(apdu_cla_coding_ext_vals), 0xc0,\r\n"ISO 7816-4 APDU CLA (Class) Byte", HFILL }\r\n},\r\n{ &hf_apdu_cla_secure_messaging_ind,\r\n{ "Secure Messaging Indication", "gsm_sim.apdu.cla.secure_messaging_ind",\r\nFT_UINT8, BASE_HEX, VALS(apdu_cla_secure_messaging_ind_vals), 0x0c,\r\n"ISO 7816-4 APDU CLA (Class) Byte", HFILL }\r\n},\r\n{ &hf_apdu_cla_secure_messaging_ind_ext,\r\n{ "Secure Messaging Indication", "gsm_sim.apdu.cla.secure_messaging_ind",\r\nFT_BOOLEAN, 8, TFS(&apdu_cla_secure_messaging_ind_ext_val), 0x20,\r\n"ISO 7816-4 APDU CLA (Class) Byte", HFILL }\r\n},\r\n{ &hf_apdu_cla_log_chan,\r\n{ "Logical Channel number", "gsm_sim.apdu.cla.log_chan",\r\nFT_UINT8, BASE_DEC, NULL, 0x03,\r\n"ISO 7816-4 APDU CLA (Class) Byte", HFILL }\r\n},\r\n{ &hf_apdu_cla_log_chan_ext,\r\n{ "Logical Channel number", "gsm_sim.apdu.cla.log_chan",\r\nFT_UINT8, BASE_DEC, NULL, 0x0f,\r\n"ISO 7816-4 APDU CLA (Class) Byte", HFILL }\r\n},\r\n{ &hf_apdu_ins,\r\n{ "Instruction", "gsm_sim.apdu.ins",\r\nFT_UINT8, BASE_HEX, VALS(apdu_ins_vals), 0,\r\n"ISO 7816-4 APDU INS (Instruction) Byte", HFILL }\r\n},\r\n{ &hf_apdu_p1,\r\n{ "Parameter 1", "gsm_sim.apdu.p1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\n"ISO 7816-4 APDU P1 (Parameter 1) Byte", HFILL }\r\n},\r\n{ &hf_apdu_p2,\r\n{ "Parameter 2", "gsm_sim.apdu.p2",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\n"ISO 7816-4 APDU P2 (Parameter 2) Byte", HFILL }\r\n},\r\n{ &hf_apdu_p3,\r\n{ "Length (Parameter 3)", "gsm_sim.apdu.p3",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\n"ISO 7816-4 APDU P3 (Parameter 3) Byte", HFILL }\r\n},\r\n{ &hf_apdu_data,\r\n{ "APDU Payload", "gsm_sim.apdu.data",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"ISO 7816-4 APDU Data Payload", HFILL }\r\n},\r\n{ &hf_apdu_sw,\r\n{ "Status Word (SW1:SW2)", "gsm_sim.apdu.sw",\r\nFT_UINT16, BASE_HEX, VALS(sw_vals), 0,\r\n"ISO 7816-4 APDU Status Word", HFILL }\r\n},\r\n{ &hf_file_id,\r\n{ "File ID", "gsm_sim.file_id",\r\nFT_UINT16, BASE_HEX, VALS(mf_dfs), 0,\r\n"ISO 7816-4 File ID", HFILL }\r\n},\r\n{ &hf_aid,\r\n{ "Application ID", "gsm_sim.aid",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"ISO 7816-4 Application ID", HFILL }\r\n},\r\n{ &hf_bin_offset,\r\n{ "Offset", "gsm_sim.bin_offset",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n"Offset into binary file", HFILL }\r\n},\r\n{ &hf_record_nr,\r\n{ "Record number", "gsm_sim.record_nr",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"Offset into binary file", HFILL }\r\n},\r\n{ &hf_auth_rand,\r\n{ "Random Challenge", "gsm_sim.auth_rand",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"GSM Authentication Random Challenge", HFILL }\r\n},\r\n{ &hf_auth_sres,\r\n{ "SRES", "gsm_sim.auth_sres",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"GSM Authentication SRES Response", HFILL }\r\n},\r\n{ &hf_auth_kc,\r\n{ "Kc", "gsm_sim.auth_kc",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"GSM Authentication Kc result", HFILL }\r\n},\r\n{ &hf_chan_nr,\r\n{ "Channel Number", "gsm_sim.chan_nr",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"ISO 7816-4 Logical Channel Number", HFILL }\r\n},\r\n{ &hf_le,\r\n{ "Length of Expected Response Data", "gsm_sim.le",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_chan_op,\r\n{ "Channel Operation", "gsm_sim.chan_op",\r\nFT_UINT8, BASE_HEX, VALS(chan_op_vals), 0,\r\n"ISO 7816-4 Logical Channel Operation", HFILL }\r\n},\r\n{ &hf_tprof_b1,\r\n{ "Terminal Profile Byte 1 (Download)", "gsm_sim.tp.b1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_prof_dld,\r\n{ "Profile Download", "gsm_sim.tp.prof_dld",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\n"TP Profile Download", HFILL }\r\n},\r\n{ &hf_tp_sms_data_dld,\r\n{ "SMS-PP Data Download", "gsm_sim.tp.sms_data_dld",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x02,\r\n"TP SMS-PP Data Download", HFILL }\r\n},\r\n{ &hf_tp_cb_data_dld,\r\n{ "CB Data Download", "gsm_sim.tp.cb_data_dld",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x04,\r\n"TP Cell Broadcast Data Downolad", HFILL }\r\n},\r\n{ &hf_tp_menu_sel,\r\n{ "Menu Selection", "gsm_sim.tp.menu_sel",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x08,\r\n"TP Menu Selection", HFILL }\r\n},\r\n{ &hf_tp_sms_data_dld_support,\r\n{ "SMS-PP data download is supported", "gsm_sim.tp.sms_data_dld_support",\r\nFT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x10,\r\n"TP SMS-PP data download is supported", HFILL }\r\n},\r\n{ &hf_tp_timer_exp,\r\n{ "Timer expiration", "gsm_sim.tp.timer_exp",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x20,\r\n"TP Timer expiration", HFILL }\r\n},\r\n{ &hf_tp_cc_sim_support,\r\n{ "Call Control by USIM is supported", "gsm_sim.tp.cc_sim_support",\r\nFT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x40,\r\n"TP Call Control by USIM is supported", HFILL }\r\n},\r\n{ &hf_tp_cc_sim_support2,\r\n{ "Call Control by USIM is supported", "gsm_sim.tp.cc_sim_support",\r\nFT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x80,\r\n"TP Call Control by USIM is supported", HFILL }\r\n},\r\n{ &hf_tprof_b2,\r\n{ "Terminal Profile Byte 2 (Other)", "gsm_sim.tp.b2",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_cmd_res,\r\n{ "Command result", "gsm_sim.tp.cmd_res",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\n"TP Command result", HFILL }\r\n},\r\n{ &hf_tp_cc_sim,\r\n{ "Call Control by USIM", "gsm_sim.tp.cc_sim",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x02,\r\n"TP Call Control by SIM", HFILL }\r\n},\r\n{ &hf_tp_cc_sim_support3,\r\n{ "Call Control by USIM is supported", "gsm_sim.tp.cc_sim_support",\r\nFT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x04,\r\n"TP Call Control by USIM is supported", HFILL }\r\n},\r\n{ &hf_tp_mo_sms_sim,\r\n{ "MO SMS control by SIM", "gsm_sim.tp.mo_sms_sim",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x08,\r\n"TP MO short message control by SIM", HFILL }\r\n},\r\n{ &hf_tp_cc_sim_support4,\r\n{ "Call Control by USIM is supported", "gsm_sim.tp.cc_sim_support",\r\nFT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x10,\r\n"TP Call Control by USIM is supported", HFILL }\r\n},\r\n{ &hf_tp_ucs2_entry,\r\n{ "UCS2 Entry", "gsm_sim.tp.ucs2_entry",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x20,\r\n"TP UCS2 Entry", HFILL }\r\n},\r\n{ &hf_tp_ucs2_display,\r\n{ "UCS2 Display", "gsm_sim.tp.ucs2_display",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x40,\r\n"TP UCS2 Display", HFILL }\r\n},\r\n{ &hf_tp_display_ext,\r\n{ "Display of Extension Text", "gsm_sim.tp.display_ext",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x80,\r\n"TP Display of the Extension Text", HFILL }\r\n},\r\n{ &hf_tprof_b3,\r\n{ "Terminal Profile Byte 3 (Proactive SIM)", "gsm_sim.tp.b3",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_pa_display_text,\r\n{ "Proactive SIM: DISPLAY TEXT", "gsm_sim.tp.pa.display_text",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_get_inkey,\r\n{ "Proactive SIM: GET INKEY", "gsm_sim.tp.pa.get_inkey",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_get_input,\r\n{ "Proactive SIM: GET INPUT", "gsm_sim.tp.pa.get_input",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_more_time,\r\n{ "Proactive SIM: MORE TIME", "gsm_sim.tp.pa.more_time",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_play_tone,\r\n{ "Proactive SIM: PLAY TONE", "gsm_sim.tp.pa.play_tone",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_poll_intv,\r\n{ "Proactive SIM: POLL INTERVAL", "gsm_sim.tp.pa.poll_intv",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_polling_off,\r\n{ "Proactive SIM: POLLING OFF", "gsm_sim.tp.pa.polling_off",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_refresh,\r\n{ "Proactive SIM: REFRESH", "gsm_sim.tp.pa.refresh",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tprof_b4,\r\n{ "Terminal Profile Byte 4 (Proactive SIM)", "gsm_sim.tp.b4",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_pa_select_item,\r\n{ "Proactive SIM: SELECT ITEM", "gsm_sim.tp.pa.select_item",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_send_sms,\r\n{ "Proactive SIM: SEND SHORT MESSAGE", "gsm_sim.tp.pa.send_sms",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_send_ss,\r\n{ "Proactive SIM: SEND SS", "gsm_sim.tp.pa.send_ss",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_send_ussd,\r\n{ "Proactive SIM: SEND USSD", "gsm_sim.tp.pa.send_ussd",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_set_up_call,\r\n{ "Proactive SIM: SET UP CALL", "gsm_sim.tp.pa.set_up_call",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_set_up_menu,\r\n{ "Proactive SIM: SET UP MENU", "gsm_sim.tp.pa.set_up_menu",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_prov_loci,\r\n{ "Proactive SIM: PROVIDE LOCAL INFORMATION", "gsm_sim.tp.pa.prov_loci",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_prov_loci_nmr,\r\n{ "Proactive SIM: PROVIDE LOCAL INFORMATION (NMR)", "gsm_sim.tp.pa.prov_loci_nmr",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tprof_b5,\r\n{ "Terminal Profile Byte 5 (Event driven information)", "gsm_sim.tp.b5",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_pa_evt_list,\r\n{ "Proactive SIM: SET UP EVENT LIST", "gsm_sim.tp.pa.set_up_evt_list",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_ev_mt_call,\r\n{ "Event: MT call", "gsm_sim.tp.evt.mt_call",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_ev_call_connected,\r\n{ "Event: Call connected", "gsm_sim.tp.evt.call_conn",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_ev_call_disconnected,\r\n{ "Event: Call disconnected", "gsm_sim.tp.evt.call_disc",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_ev_location_status,\r\n{ "Event: Location status", "gsm_sim.tp.evt.loc_status",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_ev_user_activity,\r\n{ "Event: User activity", "gsm_sim.tp.evt.user_activity",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_ev_idle_screen,\r\n{ "Event: Idle screen available", "gsm_sim.tp.evt.idle_screen",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_ev_cardreader_status,\r\n{ "Event: Card reader status", "gsm_sim.tp.evt.card_status",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tprof_b6,\r\n{ "Terminal Profile Byte 6 (Event driven information extension)", "gsm_sim.tp.b6",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_ev_lang_sel,\r\n{ "Event: Language Selection", "gsm_sim.tp.evt.lang_sel",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_ev_brows_term,\r\n{ "Event: Browser Termination", "gsm_sim.tp.evt.brows_term",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_ev_data_avail,\r\n{ "Event: Data Available", "gsm_sim.tp.evt.data_avail",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_ev_chan_status,\r\n{ "Event: Channel Status", "gsm_sim.tp.evt.chan_status",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_ev_access_techno_change,\r\n{ "Event: Access Technology Change", "gsm_sim.tp.evt.access_techno_change",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_ev_disp_params_changed,\r\n{ "Event: Display parameters changed", "gsm_sim.tp.evt.disp_params_changed",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_ev_local_conn,\r\n{ "Event: Local Connection", "gsm_sim.tp.evt.local_conn",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_ev_nwk_search_mode_change,\r\n{ "Event: Network Search Mode Change", "gsm_sim.tp.evt.nwk_search_mode_change",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tprof_b7,\r\n{ "Terminal Profile Byte 7 (Multiple card proactive commands)", "gsm_sim.tp.b7",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_pa_power_on,\r\n{ "Proactive SIM: POWER ON CARD", "gsm_sim.tp.pa.power_on_card",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_power_off,\r\n{ "Proactive SIM: POWER OFF CARD", "gsm_sim.tp.pa.power_off_card",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_perform_card_apdu,\r\n{ "Proactive SIM: PERFORM CARD APDU", "gsm_sim.tp.pa.perf_card_apdu",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_get_reader_status,\r\n{ "Proactive SIM: GET READER STATUS (status)", "gsm_sim.tp.pa.get_rdr_status",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_get_reader_status_id,\r\n{ "Proactive SIM: GET READER STATUS (identifier)", "gsm_sim.tp.pa.get_rdr_status_id",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_rfu,\r\n{ "RFU", "gsm_sim.tp.rfu",\r\nFT_UINT8, BASE_HEX, NULL, 0xe0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tprof_b8,\r\n{ "Terminal Profile Byte 8 (Proactive SIM)", "gsm_sim.tp.b8",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_pa_timer_start_stop,\r\n{ "Proactive SIM: TIMER MANAGEMENT (start, stop)", "gsm_sim.tp.pa.timer_start_stop",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_timer_get_current,\r\n{ "Proactive SIM: TIMER MANAGEMENT (get current value)", "gsm_sim.tp.pa.timer_get_current",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_prov_loci_date_tz,\r\n{ "Proactive SIM: PROVIDE LOCAL INFORMATION (date, time, tz)", "gsm_sim.tp.pa.prov_loci_date",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_get_inkey_binary,\r\n{ "Proactive SIM: GET INKEY", "gsm_sim.tp.pa.get_inkey_bin",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_set_up_idle_mode_text,\r\n{ "Proactive SIM: SET UP IDLE MODE TEXT", "gsm_sim.tp.pa.set_up_idle_text",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_run_at_command,\r\n{ "Proactive SIM: RUN AT COMMAND", "gsm_sim.tp.pa.run_at_command",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_2nd_alpha_setup_call,\r\n{ "Proactive SIM: SETUP CALL", "gsm_sim.tp.pa.2nd_alpha_id",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_2nd_cc_sim_support,\r\n{ "Proactive SIM: Call Control by USIM is supported", "gsm_sim.tp.pa.cc_sim_support",\r\nFT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tprof_b9,\r\n{ "Terminal Profile Byte 9", "gsm_sim.tp.b9",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_display_text,\r\n{ "DISPLAY TEXT", "gsm_sim.tp.display_text",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_send_dtmf_cmd,\r\n{ "SEND DTMF command", "gsm_sim.tp.send_dtmf_cmd",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_prov_loci_nmr2,\r\n{ "Proactive SIM: PROVIDE LOCAL INFORMATION (NMR)", "gsm_sim.tp.pa.prov_loci_nmr",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_prov_loci_lang,\r\n{ "Proactive SIM: PROVIDE LOCAL INFORMATION (language)", "gsm_sim.tp.pa.prov_loci_lang",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_prov_loci_ta,\r\n{ "Proactive SIM: PROVIDE LOCAL INFORMATION (Timing Advance)", "gsm_sim.tp.pa.prov_loci_ta",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_lang_notif,\r\n{ "Proactive SIM: LANGUAGE NOTIFICATION", "gsm_sim.tp.pa.lang_notif",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_launch_browser,\r\n{ "Proactive SIM: LAUNCH BROWSER", "gsm_sim.tp.pa.launch_browser",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_prov_loci_access_techno,\r\n{ "Proactive SIM: PROVIDE LOCAL INFORMATION (Access Technology)", "gsm_sim.tp.pa.prov_loci_access_techno",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tprof_b10,\r\n{ "Terminal Profile Byte 10 (Soft keys support)", "gsm_sim.tp.b10",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_soft_key_support_select_item,\r\n{ "Soft keys support for SELECT ITEM", "gsm_sim.tp.soft_key_support.select_item",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_soft_key_support_set_up_menu,\r\n{ "Soft Keys support for SET UP MENU", "gsm_sim.tp.soft_key_support.set_up_menu",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_rfu2,\r\n{ "RFU", "gsm_sim.tp.rfu",\r\nFT_UINT8, BASE_HEX, NULL, 0xfc,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tprof_b11,\r\n{ "Terminal Profile Byte 11 (Soft keys information)", "gsm_sim.tp.b11",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_soft_key_info_max_nb,\r\n{ "Maximum number of soft keys available", "gsm_sim.tp.soft_key_info.max_nb",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tprof_b12,\r\n{ "Terminal Profile Byte 12 (Bearer Independent protocol proactive commands, class \"e\")", "gsm_sim.tp.b12",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_pa_open_chan,\r\n{ "Proactive SIM: OPEN CHANNEL", "gsm_sim.tp.pa.open_chan",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_close_chan,\r\n{ "Proactive SIM: CLOSE CHANNEL", "gsm_sim.tp.pa.close_chan",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_recv_data,\r\n{ "Proactive SIM: RECEIVE DATA", "gsm_sim.tp.pa.recv_data",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_send_data,\r\n{ "Proactive SIM: SEND DATA", "gsm_sim.tp.pa.send_data",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_get_chan_status,\r\n{ "Proactive SIM: GET CHANNEL STATUS", "gsm_sim.tp.pa.get_chan_status",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_serv_search,\r\n{ "Proactive SIM: SERVICE SEARCH", "gsm_sim.tp.pa.serv_search",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_get_serv_info,\r\n{ "Proactive SIM: GET SERVICE INFORMATION", "gsm_sim.tp.pa.get_serv_info",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_decl_serv,\r\n{ "Proactive SIM: DECLARE SERVICE", "gsm_sim.tp.pa.decl_serv",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tprof_b13,\r\n{ "Terminal Profile Byte 13 (Bearer Independent protocol supported bearers, class \"e\")", "gsm_sim.tp.b13",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_bip_csd,\r\n{ "CSD bearer", "gsm_sim.tp.bip.csd",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_bip_gprs,\r\n{ "GPRS bearer", "gsm_sim.tp.bip.gprs",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_bip_bluetooth,\r\n{ "Bluetooth bearer", "gsm_sim.tp.bip.bluetooth",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_bip_irda,\r\n{ "IrDA bearer", "gsm_sim.tp.bip.irda",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_bip_rs232,\r\n{ "RS232 bearer", "gsm_sim.tp.bip.rs232",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_num_chans,\r\n{ "Number of Channels", "gsm_sim.tp.num_chans",\r\nFT_UINT8, BASE_DEC, NULL, 0xe0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tprof_b14,\r\n{ "Terminal Profile Byte 14 (Screen height)", "gsm_sim.tp.b14",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_char_height,\r\n{ "Display height (chars)", "gsm_sim.tp.display.height",\r\nFT_UINT8, BASE_DEC, NULL, 0x1f,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_nd,\r\n{ "No display capability", "gsm_sim.tp.nd",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x20,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_nk,\r\n{ "No keypad available", "gsm_sim.tp.nk",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x40,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_sizing_supp,\r\n{ "Screen sizing parameters", "gsm_sim.tp.disp_sizing",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x80,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tprof_b15,\r\n{ "Terminal Profile Byte 15 (Screen width)", "gsm_sim.tp.b15",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_char_width,\r\n{ "Display width (chars)", "gsm_sim.tp.display.width",\r\nFT_UINT8, BASE_DEC, NULL, 0x7f,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_var_fonts,\r\n{ "Variable size fonts", "gsm_sim.tp.var_fonts",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x80,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tprof_b16,\r\n{ "Terminal Profile Byte 16 (Screen effects)", "gsm_sim.tp.b16",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_display_resize,\r\n{ "Display resize", "gsm_sim.tp.display.resize",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_text_wrapping,\r\n{ "Text Wrapping", "gsm_sim.tp.display.wrapping",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x02,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_text_scrolling,\r\n{ "Text Scrolling", "gsm_sim.tp.display.scrolling",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x04,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_text_attributes,\r\n{ "Text Attributes", "gsm_sim.tp.display.attributes",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x08,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_rfu3,\r\n{ "RFU", "gsm_sim.tp.rfu",\r\nFT_UINT8, BASE_HEX, NULL, 0x10,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_width_red_menu,\r\n{ "Width reduction when in menu", "gsm_sim.tp.display.width_red_menu",\r\nFT_UINT8, BASE_DEC, NULL, 0xe0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tprof_b17,\r\n{ "Terminal Profile Byte 17 (Bearer independent protocol supported transport interface/bearers, class \"e\")", "gsm_sim.tp.b17",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_bip_tcp_remote,\r\n{ "TCP client mode remote connection", "gsm_sim.tp.bip.tcp_remote",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_bip_udp_remote,\r\n{ "UDP client mode remote connection", "gsm_sim.tp.bip.udp_remote",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_bip_tcp_server,\r\n{ "TCP server mode", "gsm_sim.tp.bip.tcp_server",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_bip_tcp_local,\r\n{ "TCP client mode local connection", "gsm_sim.tp.bip.tcp_local",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_bip_udp_local,\r\n{ "UDP client mode local connection", "gsm_sim.tp.bip.udp_local",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_bip_direct_com,\r\n{ "Direct communication channel", "gsm_sim.tp.bip.direct_com",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_bip_eutran,\r\n{ "E-UTRAN bearer", "gsm_sim.tp.bip.eutran",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_bip_hsdpa,\r\n{ "HSDPA bearer", "gsm_sim.tp.bip.hsdpa",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tprof_b18,\r\n{ "Terminal Profile Byte 18 (Bearer independent protocol)", "gsm_sim.tp.b18",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_pa_display_text_var_time_out,\r\n{ "Proactive SIM: DISPLAY TEXT (Variable Time out)", "gsm_sim.tp.pa.display_text_var_time_out",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_get_inkey_help,\r\n{ "Proactive SIM: GET INKEY (help is supported)", "gsm_sim.tp.pa.get_inkey_help",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_bip_usb,\r\n{ "USB bearer", "gsm_sim.tp.bip.usb",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_get_inkey_var_time_out,\r\n{ "Proactive SIM: GET INKEY (Variable Timeout)", "gsm_sim.tp.pa.get_inkey_var_time_out",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_prov_loci_esn,\r\n{ "Proactive SIM: PROVIDE LOCAL INFORMATION (ESN)", "gsm_sim.tp.pa.prov_loci_esn",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_cc_gprs,\r\n{ "CALL CONTROL on GPRS", "gsm_sim.tp.cc_gprs",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_prov_loci_imeisv,\r\n{ "Proactive SIM: PROVIDE LOCAL INFORMATION (IMEISV)", "gsm_sim.tp.pa.prov_loci_imeisv",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_prov_loci_search_mode_change,\r\n{ "Proactive SIM: PROVIDE LOCAL INFORMATION (Search Mode change)", "gsm_sim.tp.pa.prov_loci_search_mode_change",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tprof_b19,\r\n{ "Terminal Profile Byte 19 (TIA/EIA-136-C facilities)", "gsm_sim.tp.b19",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_tia_eia_version,\r\n{ "TIA/EIA Version", "gsm_sim.tp.tia_eia_version",\r\nFT_UINT8, BASE_DEC, NULL, 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_rfu4,\r\n{ "RFU", "gsm_sim.tp.rfu",\r\nFT_UINT8, BASE_HEX, NULL, 0xf0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tprof_b20,\r\n{ "Terminal Profile Byte 20 (TIA/EIA/IS-820-A facilities)", "gsm_sim.tp.b20",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_tia_iea_is820a_reserved,\r\n{ "Reserved", "gsm_sim.tp.tia_iea_is820a_reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tprof_b21,\r\n{ "Terminal Profile Byte 21 (Extended Launch Browser Capability)", "gsm_sim.tp.b21",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_ext_launch_browser_wml,\r\n{ "WML", "gsm_sim.tp.ext_launch_browser.wml",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_ext_launch_browser_xhtml,\r\n{ "XHTML", "gsm_sim.tp.ext_launch_browser.xhtml",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_ext_launch_browser_html,\r\n{ "HTML", "gsm_sim.tp.ext_launch_browser.html",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_ext_launch_browser_chtml,\r\n{ "CHTML", "gsm_sim.tp.ext_launch_browser.chtml",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_rfu5,\r\n{ "RFU", "gsm_sim.tp.rfu",\r\nFT_UINT8, BASE_HEX, NULL, 0xf0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tprof_b22,\r\n{ "Terminal Profile Byte 22", "gsm_sim.tp.b22",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_utran_ps_ext_params,\r\n{ "UTRAN PS with extended parameters", "gsm_sim.tp.utran_ps_ext_params",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_prov_loci_batt_state,\r\n{ "Proactive SIM: PROVIDE LOCAL INFORMATION (battery state)", "gsm_sim.tp.pa.prov_loci_batt_state",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_play_tone_melody,\r\n{ "Proactive SIM: PLAY TONE (Melody tones and Themed tones supported)", "gsm_sim.tp.pa.play_tone_melody",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_mm_call_set_up_call,\r\n{ "Multi-media Calls in SET UP CALL", "gsm_sim.tp.mm_call_set_up_call",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_toolkit_initiated_gba,\r\n{ "Toolkit-initiated GBA", "gsm_sim.tp.toolkit_initiated_gba",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_retrieve_mm_msg,\r\n{ "Proactive SIM: RETRIEVE MULTIMEDIA MESSAGE", "gsm_sim.tp.pa.retrieve_mm_msg",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_submit_mm_msg,\r\n{ "Proactive SIM: SUBMIT MULTIMEDIA MESSAGE", "gsm_sim.tp.pa.submit_mm_msg",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_display_mm_msg,\r\n{ "Proactive SIM: DISPLAY MULTIMEDIA MESSAGE", "gsm_sim.tp.pa.display_mm_msg",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tprof_b23,\r\n{ "Terminal Profile Byte 23", "gsm_sim.tp.b23",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_pa_set_frames,\r\n{ "Proactive SIM: SET FRAMES", "gsm_sim.tp.pa.set_frames",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_get_frames_status,\r\n{ "Proactive SIM: GET FRAMES STATUS", "gsm_sim.tp.pa.get_frames_status",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_mms_notif_download,\r\n{ "MMS notification download", "gsm_sim.tp.mms_notif_download",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_alpha_id_refresh_cmd,\r\n{ "Alpha Identifier in REFRESH command", "gsm_sim.tp.alpha_id_refresh_cmd",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_geo_loc_report,\r\n{ "Geographical Location Reporting", "gsm_sim.tp.geo_loc_report",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_prov_loci_meid,\r\n{ "Proactive SIM: PROVIDE LOCAL INFORMATION (MEID)", "gsm_sim.tp.pa.prov_loci_meid",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_prov_loci_nmr_utran_eutran,\r\n{ "Proactive SIM: PROVIDE LOCAL INFORMATION (NMR(UTRAN/E-UTRAN))", "gsm_sim.tp.pa.prov_loci_nmr_utran_eutran",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_ussd_data_download,\r\n{ "USSD Data download and application mode", "gsm_sim.tp.ussd_data_download",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tprof_b24,\r\n{ "Terminal Profile Byte 24 (Class \"i\")", "gsm_sim.tp.b24",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_class_i_max_nb_frames,\r\n{ "Maximum number of frames supported", "gsm_sim.tp.class_i_max_nb_frames",\r\nFT_UINT8, BASE_DEC, NULL, 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_rfu6,\r\n{ "RFU", "gsm_sim.tp.rfu",\r\nFT_UINT8, BASE_HEX, NULL, 0xf0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tprof_b25,\r\n{ "Terminal Profile Byte 25 (Event driven information extensions)", "gsm_sim.tp.b25",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_evt_browsing_status,\r\n{ "Event: Browsing status", "gsm_sim.tp.evt.browsing_status",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_evt_mms_transfer_status,\r\n{ "Event: MMS Transfer status", "gsm_sim.tp.evt.mms_transfer_status",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_evt_frame_info_changed,\r\n{ "Event: Frame Information changed", "gsm_sim.tp.evt.frame_info_changed",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_evt_iwlan_access_status,\r\n{ "Event: I-WLAN Access status", "gsm_sim.tp.evt.iwlan_access_status",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_evt_nw_reject_geran_utran,\r\n{ "Event: Network Rejection for GERAN/UTRAN", "gsm_sim.tp.evt.nw_reject_geran_utran",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_evt_hci_connectivity,\r\n{ "Event: HCI connectivity", "gsm_sim.tp.evt.hci_connectivity",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_evt_nw_reject_eutran,\r\n{ "Event: Network Rejection for E-UTRAN", "gsm_sim.tp.evt.reject_eutran",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_evt_mult_access_techno_change,\r\n{ "Multiple access technologies supported in Event Access Technology Change and PROVIDE LOCAL INFORMATION",\r\n"gsm_sim.tp.evt.mult_access_techno_change",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tprof_b26,\r\n{ "Terminal Profile Byte 26 (Event driven information extensions)", "gsm_sim.tp.b26",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_evt_csg_cell_select,\r\n{ "Event: CSG Cell Selection", "gsm_sim.tp.evt.csg_cell_select",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_evt_contactless_state_req,\r\n{ "Event: Contactless state request", "gsm_sim.tp.evt.contactless_state_req",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_rfu7,\r\n{ "RFU", "gsm_sim.tp.rfu",\r\nFT_UINT8, BASE_HEX, NULL, 0xfc,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tprof_b27,\r\n{ "Terminal Profile Byte 27 (Event driven information extensions)", "gsm_sim.tp.b27",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_rfu8,\r\n{ "RFU", "gsm_sim.tp.rfu",\r\nFT_UINT8, BASE_HEX, NULL, 0xff,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tprof_b28,\r\n{ "Terminal Profile Byte 28 (Text attributes)", "gsm_sim.tp.b28",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_text_align_left,\r\n{ "Alignment left", "gsm_sim.tp.text.align_left",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_text_align_centre,\r\n{ "Alignment centre", "gsm_sim.tp.text.align_centre",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_text_align_right,\r\n{ "Alignment right", "gsm_sim.tp.text.align_right",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_text_font_size_normal,\r\n{ "Font size normal", "gsm_sim.tp.text.font_size_normal",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_text_font_size_large,\r\n{ "Font size large", "gsm_sim.tp.text.font_size_large",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_text_font_size_small,\r\n{ "Font size small", "gsm_sim.tp.text.font_size_small",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_rfu9,\r\n{ "RFU", "gsm_sim.tp.rfu",\r\nFT_UINT8, BASE_HEX, NULL, 0xc0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tprof_b29,\r\n{ "Terminal Profile Byte 29 (Text attributes)", "gsm_sim.tp.b29",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_text_style_normal,\r\n{ "Style normal", "gsm_sim.tp.text.style_normal",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_text_style_bold,\r\n{ "Style bold", "gsm_sim.tp.text.style_bold",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_text_style_italic,\r\n{ "Style italic", "gsm_sim.tp.text.style_italic",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_text_style_underlined,\r\n{ "Style underlined", "gsm_sim.tp.text.style_underlined",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_text_style_strikethrough,\r\n{ "Style strikethrough", "gsm_sim.tp.text.style_strikethrough",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_text_style_text_fg_colour,\r\n{ "Style text foreground colour", "gsm_sim.tp.text.style_text_fg_colour",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_text_style_text_bg_colour,\r\n{ "Style text background colour", "gsm_sim.tp.text.style_text_bg_colour",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_rfu10,\r\n{ "RFU", "gsm_sim.tp.rfu",\r\nFT_UINT8, BASE_HEX, NULL, 0x80,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tprof_b30,\r\n{ "Terminal Profile Byte 30", "gsm_sim.tp.b30",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_bip_iwlan,\r\n{ "I-WLAN bearer", "gsm_sim.tp.bip.iwlan",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_prov_loci_wsid,\r\n{ "Proactive SIM: PROVIDE LOCAL INFORMATION (WSID of the current I-WLAN connection)", "gsm_sim.tp.pa.prov_loci_wsid",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_term_app,\r\n{ "TERMINAL APPLICATIONS", "gsm_sim.tp.term_app",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_steering_roaming_refresh,\r\n{ "\"Steering of Roaming\" REFRESH", "gsm_sim.tp.steering_roaming_refresh",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_activate,\r\n{ "Proactive SIM: ACTIVATE", "gsm_sim.tp.pa.activate",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_geo_loc_req,\r\n{ "Proactive SIM: Geographical Location Request", "gsm_sim.tp.pa.geo_loc_req",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_prov_loci_broadcast_nw_info,\r\n{ "Proactive SIM: PROVIDE LOCAL INFORMATION (Broadcast Network Information)", "gsm_sim.tp.pa.prov_loci_broadcast_nw_info",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_steering_roaming_iwlan_refresh,\r\n{ "\"Steering of Roaming for I-WLAN\" REFRESH", "gsm_sim.tp.steering_roaming_iwlan_refresh",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tprof_b31,\r\n{ "Terminal Profile Byte 31", "gsm_sim.tp.b31",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_pa_contactless_state_changed,\r\n{ "Proactive SIM: Contactless State Changed", "gsm_sim.tp.pa.contactless_state_changed",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_csg_cell_discovery,\r\n{ "CSG cell discovery", "gsm_sim.tp.csg_cell_discovery",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_cnf_params_support_open_chan_server_mode,\r\n{ "Confirmation parameters supported for OPEN CHANNEL in Terminal Server Mode", "gsm_sim.tp.cnf_params_support_open_chan_server_mode",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_com_ctrl_ims,\r\n{ "Communication Control for IMS", "gsm_sim.tp.com_ctrl_ims",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_cat_over_modem_itf,\r\n{ "CAT over the modem interface", "gsm_sim.tp.cat_over_modem_itf",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_evt_incoming_data_ims,\r\n{ "Event: Incoming IMS Data", "gsm_sim.tp.evt.incoming_data_ims",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_evt_ims_registration,\r\n{ "Event: IMS Registration", "gsm_sim.tp.evt.ims_registration",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_prof_env_cont,\r\n{ "Proactive SIM: Profile Container, Envelope Container, COMMAND CONTAINER and ENCAPSULATED SESSION CONTROL", "gsm_sim.tp.pa.prof_env_cont",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tprof_b32,\r\n{ "Terminal Profile Byte 32", "gsm_sim.tp.b32",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_bip_ims,\r\n{ "IMS bearer", "gsm_sim.tp.bip.ims",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_prov_loci_henb_ip_addr,\r\n{ "Proactive SIM: PROVIDE LOCAL INFORMATION (H(e)NB IP address)", "gsm_sim.tp.pa.prov_loci_henb_ip_addr",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_prov_loci_henb_surround_macro,\r\n{ "Proactive SIM: PROVIDE LOCAL INFORMATION (H(e)NB surrounding macrocells)", "gsm_sim.tp.pa.prov_loci_henb_surround_macro",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_launch_params_support_open_chan_server_mode,\r\n{ "Launch parameters supported for OPEN CHANNEL in Terminal Server Mode", "gsm_sim.tp.launch_params_support_open_chan_server_mode",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_direct_com_support_open_chan_server_mode,\r\n{ "Direct communication channel supported for OPEN CHANNEL in Terminal Server Mode", "gsm_sim.tp.direct_com_support_open_chan_server_mode",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_pa_sec_prof_env_cont,\r\n{ "Proactive SIM: Security for Profile Container, Envelope Container, COMMAND CONTAINER and ENCAPSULATED SESSION CONTROL", "gsm_sim.tp.sec_prof_env_cont",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_cat_serv_list_ecat_client,\r\n{ "CAT service list for eCAT client", "gsm_sim.tp.serv_list_ecat_client",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_support_refresh_enforcement_policy,\r\n{ "Support of refresh enforcement policy", "gsm_sim.tp.refresh_enforcement_policy",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tprof_b33,\r\n{ "Terminal Profile Byte 33", "gsm_sim.tp.b33",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tp_support_dns_addr_req,\r\n{ "Support of DNS server address request for OPEN CHANNEL related to packet data service bearer", "gsm_sim.tp.support_dns_addr_req",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_support_nw_access_name_reuse,\r\n{ "Support of Network Access Name reuse indication for CLOSE CHANNEL related to packet data service bearer", "gsm_sim.tp.nw_access_name_reuse",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_ev_poll_intv_nego,\r\n{ "Event: Poll Interval Negotiation", "gsm_sim.tp.evt.poll_intv_nego",\r\nFT_BOOLEAN, 8, TFS(&tfs_supported_not_supported), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tp_rfu11,\r\n{ "RFU", "gsm_sim.tp.rfu",\r\nFT_UINT8, BASE_HEX, NULL, 0xf8,\r\nNULL, HFILL },\r\n},\r\n{ &hf_tprof_unknown_byte,\r\n{ "Unknown Terminal Profile Byte", "gsm_sim.tp.unknown_byte",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_cat_ber_tag,\r\n{ "BER-TLV Tag", "gsm_sim.cat.ber_tlv_tag",\r\nFT_UINT8, BASE_HEX, VALS(ber_tlv_cat_tag_vals), 0,\r\n"Card Application Toolkit BER-TLV tag", HFILL },\r\n},\r\n{ &hf_seek_mode,\r\n{ "Seek Mode", "gsm_sim.seek_mode",\r\nFT_UINT8, BASE_HEX, VALS(seek_mode_vals), 0x0F,\r\nNULL, HFILL },\r\n},\r\n{ &hf_seek_type,\r\n{ "Seek Type", "gsm_sim.seek_type",\r\nFT_UINT8, BASE_DEC, VALS(seek_type_vals), 0x0F,\r\nNULL, HFILL },\r\n},\r\n{ &hf_seek_rec_nr,\r\n{ "Seek Record Number", "gsm_sim.seek_rec_nr",\r\nFT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL },\r\n},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_sim,\r\n&ett_tprof_b1,\r\n&ett_tprof_b2,\r\n&ett_tprof_b3,\r\n&ett_tprof_b4,\r\n&ett_tprof_b5,\r\n&ett_tprof_b6,\r\n&ett_tprof_b7,\r\n&ett_tprof_b8,\r\n&ett_tprof_b9,\r\n&ett_tprof_b10,\r\n&ett_tprof_b11,\r\n&ett_tprof_b12,\r\n&ett_tprof_b13,\r\n&ett_tprof_b14,\r\n&ett_tprof_b15,\r\n&ett_tprof_b16,\r\n&ett_tprof_b17,\r\n&ett_tprof_b18,\r\n&ett_tprof_b19,\r\n&ett_tprof_b20,\r\n&ett_tprof_b21,\r\n&ett_tprof_b22,\r\n&ett_tprof_b23,\r\n&ett_tprof_b24,\r\n&ett_tprof_b25,\r\n&ett_tprof_b26,\r\n&ett_tprof_b27,\r\n&ett_tprof_b28,\r\n&ett_tprof_b29,\r\n&ett_tprof_b30,\r\n&ett_tprof_b31,\r\n&ett_tprof_b32,\r\n&ett_tprof_b33\r\n};\r\nproto_gsm_sim = proto_register_protocol("GSM SIM 11.11", "GSM SIM",\r\n"gsm_sim");\r\nproto_register_field_array(proto_gsm_sim, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nregister_dissector("gsm_sim", dissect_gsm_sim, proto_gsm_sim);\r\nregister_dissector("gsm_sim.command", dissect_gsm_sim_command, proto_gsm_sim);\r\nregister_dissector("gsm_sim.response", dissect_gsm_sim_response, proto_gsm_sim);\r\nregister_dissector("gsm_sim.bertlv", dissect_bertlv, proto_gsm_sim);\r\n}\r\nvoid\r\nproto_reg_handoff_gsm_sim(void)\r\n{\r\ndissector_handle_t sim_handle;\r\nsim_handle = find_dissector("gsm_sim");\r\ndissector_add_uint("gsmtap.type", 4, sim_handle);\r\nsub_handle_cap = find_dissector_add_dependency("etsi_cat", proto_gsm_sim);\r\n}
