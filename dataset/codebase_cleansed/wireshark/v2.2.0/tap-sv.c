static int\r\nsv_packet(void *prs _U_, packet_info *pinfo, epan_dissect_t *edt _U_, const void *pri)\r\n{\r\nint i;\r\nconst sv_frame_data * sv_data = (const sv_frame_data *)pri;\r\nprintf("%f %u ", nstime_to_sec(&pinfo->rel_ts), sv_data->smpCnt);\r\nfor (i = 0; i < sv_data->num_phsMeas; i++) {\r\nprintf("%d ", sv_data->phsMeas[i].value);\r\n}\r\nprintf("\n");\r\nreturn 0;\r\n}\r\nstatic void\r\nsvstat_init(const char *opt_arg _U_, void *userdata _U_)\r\n{\r\nGString *error_string;\r\nerror_string = register_tap_listener(\r\n"sv",\r\nNULL,\r\nNULL,\r\n0,\r\nNULL,\r\nsv_packet,\r\nNULL);\r\nif (error_string) {\r\nfprintf(stderr, "tshark: Couldn't register sv,stat tap: %s\n",\r\nerror_string->str);\r\ng_string_free(error_string, TRUE);\r\nexit(1);\r\n}\r\n}\r\nvoid\r\nregister_tap_listener_sv(void)\r\n{\r\nregister_stat_tap_ui(&svstat_ui, NULL);\r\n}
