static int\r\ndissect_cast_pdu(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\nguint32 hdr_data_length;\r\nguint32 hdr_marker;\r\nguint32 data_messageid;\r\nconst gchar *messageid_str;\r\nguint i = 0;\r\nguint t = 0;\r\nint count;\r\nint val;\r\nproto_item *ti;\r\nproto_tree *cast_tree = NULL;\r\nproto_tree *cast_sub_tree;\r\nproto_tree *cast_sub_tree_sav;\r\nproto_tree *cast_sub_tree_sav_sav;\r\nhdr_data_length = tvb_get_letohl(tvb, offset);\r\nhdr_marker = tvb_get_letohl(tvb, offset+4);\r\ndata_messageid = tvb_get_letohl(tvb, offset+8);\r\nif (tree) {\r\nti = proto_tree_add_item(tree, proto_cast, tvb, offset, hdr_data_length+8, ENC_NA);\r\ncast_tree = proto_item_add_subtree(ti, ett_cast);\r\nproto_tree_add_uint(cast_tree, hf_cast_data_length, tvb, offset, 4, hdr_data_length);\r\nproto_tree_add_uint(cast_tree, hf_cast_reserved, tvb, offset+4, 4, hdr_marker);\r\n}\r\nmessageid_str = val_to_str(data_messageid, message_id, "0x%08X (Unknown)");\r\ncol_add_str(pinfo->cinfo, COL_INFO, messageid_str);\r\nif (tree) {\r\nproto_tree_add_uint(cast_tree, hf_cast_messageid, tvb,offset+8, 4, data_messageid );\r\n}\r\nif (tree) {\r\nswitch(data_messageid) {\r\ncase 0x0 :\r\nbreak;\r\ncase 0x1 :\r\nproto_tree_add_item(cast_tree, hf_cast_version, tvb, offset+12, 4, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase 0x2 :\r\nproto_tree_add_item(cast_tree, hf_cast_version, tvb, offset+12, 4, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase 0x3 :\r\nproto_tree_add_item(cast_tree, hf_cast_videoCapCount, tvb, offset+12, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_dataCapCount, tvb, offset+16, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_RTPPayloadFormat, tvb, offset+20, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_customPictureFormatCount, tvb, offset+24, 4, ENC_LITTLE_ENDIAN);\r\ncount = offset+28;\r\nfor ( i = 0; i < MAX_CUSTOM_PICTURES; i++ ) {\r\ncast_sub_tree = proto_tree_add_subtree_format(cast_tree, tvb, offset, 20, ett_cast_tree, NULL, "customPictureFormat[%d]", i);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_pictureWidth, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_pictureHeight, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_pixelAspectRatio, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_clockConversionCode, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_clockDivisor, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\n}\r\ncast_sub_tree = proto_tree_add_subtree(cast_tree, tvb, offset, 8, ett_cast_tree, NULL, "confResources");\r\nproto_tree_add_item(cast_sub_tree, hf_cast_activeStreamsOnRegistration, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_maxBW, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_serviceResourceCount, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\ncast_sub_tree_sav = cast_sub_tree;\r\nfor ( i = 0; i < MAX_SERVICE_TYPE; i++ ) {\r\ncast_sub_tree = proto_tree_add_subtree_format(cast_sub_tree_sav, tvb, offset, 20, ett_cast_tree, NULL, "serviceResource[%d]", i);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_layoutCount, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\ncast_sub_tree_sav_sav = cast_sub_tree_sav;\r\nfor ( t = 0; t < MAX_LAYOUT_WITH_SAME_SERVICE; t++ ) {\r\ncast_sub_tree = proto_tree_add_subtree_format(cast_sub_tree_sav, tvb, offset, 20, ett_cast_tree, NULL, "layouts[%d]", t);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_layout, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\n}\r\ncast_sub_tree = cast_sub_tree_sav_sav;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_serviceNum, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_maxStreams, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_maxConferences, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_activeConferenceOnRegistration, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\n}\r\nfor ( i = 0; i < StationMaxVideoCapabilities; i++ ) {\r\ncast_sub_tree = proto_tree_add_subtree_format(cast_tree, tvb, offset, 20, ett_cast_tree, NULL, "vidCaps[%d]", i);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_payloadCapability, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_transmitOrReceive, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_levelPreferenceCount, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\ncast_sub_tree_sav = cast_sub_tree;\r\nfor ( t = 0; t < MAX_LEVEL_PREFERENCE; t++ ) {\r\ncast_sub_tree = proto_tree_add_subtree_format(cast_sub_tree_sav, tvb, offset, 20, ett_cast_tree, NULL, "levelPreference[%d]", t);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_transmitPreference, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_format, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_maxBitRate, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_minBitRate, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_MPI, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_serviceNumber, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\n}\r\ncast_sub_tree = proto_tree_add_subtree(cast_sub_tree_sav, tvb, offset, 8, ett_cast_tree, NULL, "h261VideoCapability");\r\nproto_tree_add_item(cast_sub_tree, hf_cast_temporalSpatialTradeOffCapability, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_stillImageTransmission, tvb, count+4, 4, ENC_LITTLE_ENDIAN);\r\ncast_sub_tree = proto_tree_add_subtree(cast_sub_tree_sav, tvb, offset, 8, ett_cast_tree, NULL, "h263VideoCapability");\r\nproto_tree_add_item(cast_sub_tree, hf_cast_h263_capability_bitfield, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_annexNandWFutureUse, tvb, count+4, 4, ENC_LITTLE_ENDIAN);\r\ncast_sub_tree = proto_tree_add_subtree(cast_sub_tree_sav, tvb, offset, 8, ett_cast_tree, NULL, "vieoVideoCapability");\r\nproto_tree_add_item(cast_sub_tree, hf_cast_modelNumber, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_bandwidth, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\n}\r\nfor ( i = 0; i < StationMaxDataCapabilities; i++ ) {\r\ncast_sub_tree = proto_tree_add_subtree_format(cast_tree, tvb, offset, 20, ett_cast_tree, NULL, "dataCaps[%d]", i);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_payloadCapability, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_transmitOrReceive, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_protocolDependentData, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_maxBitRate, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount+= 4;\r\n}\r\nbreak;\r\ncase 0x4 :\r\nbreak;\r\ncase 0x5 :\r\nproto_tree_add_item(cast_tree, hf_cast_conferenceID, tvb, offset+12, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_passThruPartyID, tvb, offset+16, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_payloadCapability, tvb, offset+20, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_lineInstance, tvb, offset+24, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_callIdentifier, tvb, offset+28, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_payload_rfc_number, tvb, offset+32, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_payloadType, tvb, offset+36, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_isConferenceCreator, tvb, offset+40, 4, ENC_LITTLE_ENDIAN);\r\ncast_sub_tree = proto_tree_add_subtree(cast_tree, tvb, offset, 12, ett_cast_tree, NULL, "audioParameters");\r\nproto_tree_add_item(cast_sub_tree, hf_cast_millisecondPacketSize, tvb, offset+44, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_echoCancelType, tvb, offset+48, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_g723BitRate, tvb, offset+52, 4, ENC_LITTLE_ENDIAN);\r\ncast_sub_tree = proto_tree_add_subtree(cast_tree, tvb, offset, 30, ett_cast_tree, NULL, "videoParameters");\r\nproto_tree_add_item(cast_sub_tree, hf_cast_bitRate, tvb, offset+44, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_pictureFormatCount, tvb, offset+48, 4, ENC_LITTLE_ENDIAN);\r\ncast_sub_tree_sav = cast_sub_tree;\r\ncount = offset+52;\r\nfor ( i = 0; i < MAX_PICTURE_FORMAT; i++ ) {\r\ncast_sub_tree = proto_tree_add_subtree_format(cast_sub_tree_sav, tvb, offset, 8 * MAX_PICTURE_FORMAT, ett_cast_tree, NULL, "pictureFormat[%d]", i);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_format, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount += 4;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_MPI, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount += 4;\r\n}\r\ncast_sub_tree = cast_sub_tree_sav;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_confServiceNum, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount += 4;\r\ncast_sub_tree = proto_tree_add_subtree(cast_sub_tree_sav, tvb, offset, 8, ett_cast_tree, NULL, "h261VideoCapability");\r\nproto_tree_add_item(cast_sub_tree, hf_cast_temporalSpatialTradeOffCapability, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_stillImageTransmission, tvb, count+4, 4, ENC_LITTLE_ENDIAN);\r\ncast_sub_tree = proto_tree_add_subtree(cast_sub_tree_sav, tvb, offset, 8, ett_cast_tree, NULL, "h263VideoCapability");\r\nproto_tree_add_item(cast_sub_tree, hf_cast_h263_capability_bitfield, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_annexNandWFutureUse, tvb, count+4, 4, ENC_LITTLE_ENDIAN);\r\ncast_sub_tree = proto_tree_add_subtree(cast_sub_tree_sav, tvb, offset, 8, ett_cast_tree, NULL, "vieoVideoCapability");\r\nproto_tree_add_item(cast_sub_tree, hf_cast_modelNumber, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount += 4;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_bandwidth, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncast_sub_tree = proto_tree_add_subtree(cast_tree, tvb, offset, 8, ett_cast_tree, NULL, "dataParameters");\r\nproto_tree_add_item(cast_sub_tree, hf_cast_protocolDependentData, tvb, offset+44, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_maxBitRate, tvb, offset+48, 4, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase 0x6 :\r\nproto_tree_add_item(cast_tree, hf_cast_ORCStatus, tvb, offset+12, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_ipAddress, tvb, offset+16, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_portNumber, tvb, offset+20, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_passThruPartyID, tvb, offset+24, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_callIdentifier, tvb, offset+28, 4, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase 0x7 :\r\nproto_tree_add_item(cast_tree, hf_cast_conferenceID, tvb, offset+12, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_passThruPartyID, tvb, offset+16, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_callIdentifier, tvb, offset+20, 4, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase 0x8 :\r\nproto_tree_add_item(cast_tree, hf_cast_conferenceID, tvb, offset+12, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_passThruPartyID, tvb, offset+16, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_payloadCapability, tvb, offset+20, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_ipAddress, tvb, offset+24, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_portNumber, tvb, offset+28, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_callIdentifier, tvb, offset+32, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_payload_rfc_number, tvb, offset+36, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_payloadType, tvb, offset+40, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_DSCPValue, tvb, offset+44, 4, ENC_LITTLE_ENDIAN);\r\ncast_sub_tree = proto_tree_add_subtree(cast_tree, tvb, offset, 30, ett_cast_tree, NULL, "videoParameters");\r\nproto_tree_add_item(cast_sub_tree, hf_cast_bitRate, tvb, offset+48, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_pictureFormatCount, tvb, offset+52, 4, ENC_LITTLE_ENDIAN);\r\ncast_sub_tree_sav = cast_sub_tree;\r\ncount = offset+56;\r\nfor ( i = 0; i < MAX_PICTURE_FORMAT; i++ ) {\r\ncast_sub_tree = proto_tree_add_subtree_format(cast_sub_tree_sav, tvb, offset, 8 * MAX_PICTURE_FORMAT,\r\nett_cast_tree, NULL, "pictureFormat[%d]", i);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_format, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount += 4;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_MPI, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount += 4;\r\n}\r\ncast_sub_tree = cast_sub_tree_sav;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_confServiceNum, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount += 4;\r\nval = count;\r\ncast_sub_tree = proto_tree_add_subtree(cast_sub_tree_sav, tvb, offset, 8, ett_cast_tree, NULL, "h261VideoCapability");\r\nproto_tree_add_item(cast_sub_tree, hf_cast_temporalSpatialTradeOffCapability, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount += 4;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_stillImageTransmission, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount = val;\r\ncast_sub_tree = proto_tree_add_subtree(cast_sub_tree_sav, tvb, offset, 8, ett_cast_tree, NULL, "h263VideoCapability");\r\nproto_tree_add_item(cast_sub_tree, hf_cast_h263_capability_bitfield, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount += 4;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_annexNandWFutureUse, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount = val;\r\ncast_sub_tree = proto_tree_add_subtree(cast_sub_tree_sav, tvb, offset, 8, ett_cast_tree, NULL, "vieoVideoCapability");\r\nproto_tree_add_item(cast_sub_tree, hf_cast_modelNumber, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncount += 4;\r\nproto_tree_add_item(cast_sub_tree, hf_cast_bandwidth, tvb, count, 4, ENC_LITTLE_ENDIAN);\r\ncast_sub_tree = proto_tree_add_subtree(cast_tree, tvb, offset, 8, ett_cast_tree, NULL, "dataParameters");\r\nproto_tree_add_item(cast_sub_tree, hf_cast_protocolDependentData, tvb, offset+48, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_maxBitRate, tvb, offset+52, 4, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase 0x9 :\r\nproto_tree_add_item(cast_tree, hf_cast_conferenceID, tvb, offset+12, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_passThruPartyID, tvb, offset+16, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_callIdentifier, tvb, offset+20, 4, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase 0xA :\r\nproto_tree_add_item(cast_tree, hf_cast_conferenceID, tvb, offset+12, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_passThruPartyID, tvb, offset+16, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_callIdentifier, tvb, offset+20, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_miscCommandType, tvb, offset+24, 4, ENC_LITTLE_ENDIAN);\r\ncast_sub_tree = proto_tree_add_subtree(cast_tree, tvb, offset, 8, ett_cast_tree, NULL, "videoFastUpdateGOB");\r\nproto_tree_add_item(cast_sub_tree, hf_cast_firstGOB, tvb, offset+28, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_numberOfGOBs, tvb, offset+32, 4, ENC_LITTLE_ENDIAN);\r\ncast_sub_tree = proto_tree_add_subtree(cast_tree, tvb, offset, 8, ett_cast_tree, NULL, "videoFastUpdateGOB");\r\nproto_tree_add_item(cast_sub_tree, hf_cast_firstGOB, tvb, offset+28, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_firstMB, tvb, offset+32, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_numberOfMBs, tvb, offset+36, 4, ENC_LITTLE_ENDIAN);\r\ncast_sub_tree = proto_tree_add_subtree(cast_tree, tvb, offset, 8, ett_cast_tree, NULL, "lostPicture");\r\nproto_tree_add_item(cast_sub_tree, hf_cast_pictureNumber, tvb, offset+28, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_longTermPictureIndex, tvb, offset+32, 4, ENC_LITTLE_ENDIAN);\r\ncast_sub_tree = proto_tree_add_subtree(cast_tree, tvb, offset, 8, ett_cast_tree, NULL, "lostPartialPicture");\r\nproto_tree_add_item(cast_sub_tree, hf_cast_pictureNumber, tvb, offset+28, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_longTermPictureIndex, tvb, offset+32, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_firstMB, tvb, offset+36, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_numberOfMBs, tvb, offset+40, 4, ENC_LITTLE_ENDIAN);\r\ncast_sub_tree = proto_tree_add_subtree(cast_tree, tvb, offset, 8, ett_cast_tree, NULL, "recoveryReferencePicture");\r\nproto_tree_add_item(cast_sub_tree, hf_cast_recoveryReferencePictureCount, tvb, offset+28, 4, ENC_LITTLE_ENDIAN);\r\ncast_sub_tree_sav = cast_sub_tree;\r\nfor ( i = 0; i < MAX_REFERENCE_PICTURE; i++ ) {\r\ncast_sub_tree = proto_tree_add_subtree_format(cast_sub_tree_sav, tvb, offset, 8, ett_cast_tree, NULL, "recoveryReferencePicture[%d]", i);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_pictureNumber, tvb, offset+32+(i*8), 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_longTermPictureIndex, tvb, offset+36+(i*8), 4, ENC_LITTLE_ENDIAN);\r\n}\r\ncast_sub_tree = proto_tree_add_subtree(cast_tree, tvb, offset, 4, ett_cast_tree, NULL, "temporalSpatialTradeOff");\r\nproto_tree_add_item(cast_sub_tree, hf_cast_temporalSpatialTradeOff, tvb, offset+28, 4, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase 0xB :\r\nproto_tree_add_item(cast_tree, hf_cast_conferenceID, tvb, offset+12, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_passThruPartyID, tvb, offset+16, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_callIdentifier, tvb, offset+20, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_maxBitRate, tvb, offset+24, 4, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase 0xC :\r\nproto_tree_add_item(cast_tree, hf_cast_conferenceID, tvb, offset+12, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_serviceNum, tvb, offset+16, 4, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase 0xD :\r\nproto_tree_add_item(cast_tree, hf_cast_callState, tvb, offset+12, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_lineInstance, tvb, offset+16, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_callIdentifier, tvb, offset+20, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_privacy, tvb, offset+24, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_precedenceLv, tvb, offset+28, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_precedenceDm, tvb, offset+32, 4, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase 0xE :\r\nproto_tree_add_item(cast_tree, hf_cast_callIdentifier, tvb, offset+12, 4, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase 0xF :\r\nbreak;\r\ncase 0x10 :\r\ni = offset+12;\r\nproto_tree_add_item(cast_tree, hf_cast_callingPartyName, tvb, i, StationMaxNameSize, ENC_ASCII|ENC_NA);\r\ni += StationMaxNameSize;\r\nproto_tree_add_item(cast_tree, hf_cast_callingParty, tvb, i, StationMaxDirnumSize, ENC_ASCII|ENC_NA);\r\ni += StationMaxDirnumSize;\r\nproto_tree_add_item(cast_tree, hf_cast_calledPartyName, tvb, i, StationMaxNameSize, ENC_ASCII|ENC_NA);\r\ni += StationMaxNameSize;\r\nproto_tree_add_item(cast_tree, hf_cast_calledParty, tvb, i, StationMaxDirnumSize, ENC_ASCII|ENC_NA);\r\ni += StationMaxDirnumSize;\r\nproto_tree_add_item(cast_tree, hf_cast_lineInstance, tvb, i, 4, ENC_LITTLE_ENDIAN);\r\ni += 4;\r\nproto_tree_add_item(cast_tree, hf_cast_callIdentifier, tvb, i, 4, ENC_LITTLE_ENDIAN);\r\ni += 4;\r\nproto_tree_add_item(cast_tree, hf_cast_callType, tvb, i, 4, ENC_LITTLE_ENDIAN);\r\ni += 4;\r\nproto_tree_add_item(cast_tree, hf_cast_originalCalledPartyName, tvb, i, StationMaxNameSize, ENC_ASCII|ENC_NA);\r\ni += StationMaxNameSize;\r\nproto_tree_add_item(cast_tree, hf_cast_originalCalledParty, tvb, i, StationMaxDirnumSize, ENC_ASCII|ENC_NA);\r\ni += StationMaxDirnumSize;\r\nproto_tree_add_item(cast_tree, hf_cast_lastRedirectingPartyName, tvb, i, StationMaxNameSize, ENC_ASCII|ENC_NA);\r\ni += StationMaxNameSize;\r\nproto_tree_add_item(cast_tree, hf_cast_lastRedirectingParty, tvb, i, StationMaxDirnumSize, ENC_ASCII|ENC_NA);\r\ni += StationMaxDirnumSize;\r\nproto_tree_add_item(cast_tree, hf_cast_originalCdpnRedirectReason, tvb, i, 4, ENC_LITTLE_ENDIAN);\r\ni += 4;\r\nproto_tree_add_item(cast_tree, hf_cast_lastRedirectingReason, tvb, i, 4, ENC_LITTLE_ENDIAN);\r\ni += 4;\r\nproto_tree_add_item(cast_tree, hf_cast_cgpnVoiceMailbox, tvb, i, StationMaxDirnumSize, ENC_ASCII|ENC_NA);\r\ni += StationMaxDirnumSize;\r\nproto_tree_add_item(cast_tree, hf_cast_cdpnVoiceMailbox, tvb, i, StationMaxDirnumSize, ENC_ASCII|ENC_NA);\r\ni += StationMaxDirnumSize;\r\nproto_tree_add_item(cast_tree, hf_cast_originalCdpnVoiceMailbox, tvb, i, StationMaxDirnumSize, ENC_ASCII|ENC_NA);\r\ni += StationMaxDirnumSize;\r\nproto_tree_add_item(cast_tree, hf_cast_lastRedirectingVoiceMailbox, tvb, i, StationMaxDirnumSize, ENC_ASCII|ENC_NA);\r\ni += StationMaxDirnumSize;\r\nproto_tree_add_item(cast_tree, hf_cast_callInstance, tvb, i, 4, ENC_LITTLE_ENDIAN);\r\ni += 4;\r\nproto_tree_add_item(cast_tree, hf_cast_callSecurityStatus, tvb, i, 4, ENC_LITTLE_ENDIAN);\r\ni += 4;\r\ncast_sub_tree = proto_tree_add_subtree(cast_tree, tvb, offset, 8, ett_cast_tree, NULL, "partyPIRestrictionBits");\r\nproto_tree_add_item(cast_sub_tree, hf_cast_partyPIRestrictionBits_CallingPartyName, tvb, i, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_partyPIRestrictionBits_CallingPartyNumber, tvb, i, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_partyPIRestrictionBits_CalledPartyName, tvb, i, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_partyPIRestrictionBits_CalledPartyNumber, tvb, i, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_partyPIRestrictionBits_OriginalCalledPartyName, tvb, i, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_partyPIRestrictionBits_OriginalCalledPartyNumber, tvb, i, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_partyPIRestrictionBits_LastRedirectPartyName, tvb, i, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_sub_tree, hf_cast_partyPIRestrictionBits_LastRedirectPartyNumber, tvb, i, 4, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase 0x11 :\r\nproto_tree_add_item(cast_tree, hf_cast_lineInstance, tvb, offset+12, 4, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase 0x12 :\r\nproto_tree_add_item(cast_tree, hf_cast_lineInstance, tvb, offset+12, 4, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(cast_tree, hf_cast_callIdentifier, tvb, offset+16, 4, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase 0x13 :\r\nproto_tree_add_item(cast_tree, hf_cast_calledParty, tvb, offset+12, StationMaxDirnumSize, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(cast_tree, hf_cast_lineInstance, tvb, offset+16, 4, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase 0x14 :\r\nproto_tree_add_item(cast_tree, hf_cast_lineInstance, tvb, offset+12, 4, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase 0x15 :\r\nproto_tree_add_item(cast_tree, hf_cast_lineInstance, tvb, offset+12, 4, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase 0x40 :\r\nbreak;\r\ncase 0x41 :\r\nbreak;\r\ncase 0x42 :\r\nbreak;\r\ncase 0x43 :\r\nbreak;\r\ncase 0x44 :\r\nbreak;\r\ncase 0x45 :\r\nbreak;\r\ncase 0x46 :\r\nbreak;\r\ncase 0x47 :\r\nproto_tree_add_item(cast_tree, hf_cast_audio, tvb, offset+12, 4, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase 0x50 :\r\nbreak;\r\ncase 0x51 :\r\nbreak;\r\ncase 0x60 :\r\nbreak;\r\ncase 0x61 :\r\nbreak;\r\ncase 0x62 :\r\nbreak;\r\ncase 0x70 :\r\nbreak;\r\ncase 0x71 :\r\nbreak;\r\ncase 0x74 :\r\nbreak;\r\ncase 0x75 :\r\nbreak;\r\ncase 0x80 :\r\nbreak;\r\ncase 0x90 :\r\ni = offset+12;\r\nproto_tree_add_item(cast_tree, hf_cast_stationFriendlyName, tvb, i, StationMaxNameSize, ENC_ASCII|ENC_NA);\r\ni += StationMaxNameSize;\r\nproto_tree_add_item(cast_tree, hf_cast_stationGUID, tvb, i, StationMaxNameSize, ENC_ASCII|ENC_NA);\r\ni += StationMaxNameSize;\r\nproto_tree_add_item(cast_tree, hf_cast_requestorIpAddress, tvb, i, 4, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase 0x91 :\r\ni = offset+12;\r\nproto_tree_add_item(cast_tree, hf_cast_stationFriendlyName, tvb, i, StationMaxNameSize, ENC_ASCII|ENC_NA);\r\ni += StationMaxNameSize;\r\nproto_tree_add_item(cast_tree, hf_cast_stationGUID, tvb, i, StationMaxNameSize, ENC_ASCII|ENC_NA);\r\ni += StationMaxNameSize;\r\nproto_tree_add_item(cast_tree, hf_cast_stationIpAddress, tvb, i, 4, ENC_LITTLE_ENDIAN);\r\ni += 4;\r\nproto_tree_add_item(cast_tree, hf_cast_directoryNumber, tvb, i, StationMaxNameSize, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase 0xA0 :\r\nbreak;\r\ncase 0xA1 :\r\nbreak;\r\ncase 0xA4 :\r\nbreak;\r\ncase 0xA5 :\r\nbreak;\r\ncase 0xB0 :\r\nbreak;\r\ncase 0xB1 :\r\nbreak;\r\ncase 0xB4 :\r\nbreak;\r\ncase 0xB5 :\r\nbreak;\r\ncase 0xC0 :\r\nbreak;\r\ncase 0xC1 :\r\nbreak;\r\ncase 0xC4 :\r\nbreak;\r\ncase 0xC5 :\r\nbreak;\r\ncase 0xCC :\r\nbreak;\r\ncase 0xD0 :\r\nbreak;\r\ncase 0xD1 :\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\nreturn tvb_reported_length(tvb);\r\n}\r\nstatic guint\r\nget_cast_pdu_len(packet_info *pinfo _U_, tvbuff_t *tvb, int offset, void *data _U_)\r\n{\r\nguint32 hdr_data_length;\r\nhdr_data_length = tvb_get_letohl(tvb, offset);\r\nreturn hdr_data_length + 8;\r\n}\r\nstatic int\r\ndissect_cast(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data)\r\n{\r\nguint32 hdr_data_length;\r\nguint32 hdr_marker;\r\nhdr_data_length = tvb_get_letohl(tvb, 0);\r\nhdr_marker = tvb_get_letohl(tvb, 4);\r\nif (hdr_data_length < 4 || hdr_marker != 0) {\r\nreturn 0;\r\n}\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "CAST");\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Cast Client Control Protocol");\r\ntcp_dissect_pdus(tvb, pinfo, tree, cast_desegment, 4, get_cast_pdu_len, dissect_cast_pdu, data);\r\nreturn tvb_reported_length(tvb);\r\n}\r\nvoid\r\nproto_register_cast(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_cast_data_length,\r\n{ "Data Length", "cast.data_length",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Number of bytes in the data portion.",\r\nHFILL }\r\n},\r\n{ &hf_cast_reserved,\r\n{ "Marker", "cast.marker",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\n"Marker value should ne zero.",\r\nHFILL }\r\n},\r\n{ &hf_cast_messageid,\r\n{ "Message ID", "cast.messageid",\r\nFT_UINT32, BASE_HEX, VALS(message_id), 0x0,\r\n"The function requested/done with this message.",\r\nHFILL }\r\n},\r\n{ &hf_cast_version,\r\n{ "Version", "cast.version",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"The version in the keepalive version messages.",\r\nHFILL }\r\n},\r\n{ &hf_cast_ORCStatus,\r\n{ "ORCStatus", "cast.ORCStatus",\r\nFT_UINT32, BASE_DEC, VALS(orcStatus), 0x0,\r\n"The status of the opened receive channel.",\r\nHFILL }\r\n},\r\n{ &hf_cast_ipAddress,\r\n{ "IP Address", "cast.ipAddress",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_portNumber,\r\n{ "Port Number", "cast.portNumber",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_passThruPartyID,\r\n{ "PassThruPartyID", "cast.passThruPartyID",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_callIdentifier,\r\n{ "Call Identifier", "cast.callIdentifier",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Call identifier for this call.",\r\nHFILL }\r\n},\r\n{ &hf_cast_conferenceID,\r\n{ "Conference ID", "cast.conferenceID",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_payloadType,\r\n{ "PayloadType", "cast.payloadType",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_lineInstance,\r\n{ "Line Instance", "cast.lineInstance",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"The display call plane associated with this call.",\r\nHFILL }\r\n},\r\n{ &hf_cast_payloadCapability,\r\n{ "PayloadCapability", "cast.payloadCapability",\r\nFT_UINT32, BASE_DEC, VALS(mediaPayloads), 0x0,\r\n"The payload capability for this media capability structure.",\r\nHFILL }\r\n},\r\n{ &hf_cast_isConferenceCreator,\r\n{ "IsConferenceCreator", "cast.isConferenceCreator",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_payload_rfc_number,\r\n{ "Payload_rfc_number", "cast.payload_rfc_number",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_videoCapCount,\r\n{ "VideoCapCount", "cast.videoCapCount",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_dataCapCount,\r\n{ "DataCapCount", "cast.dataCapCount",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_RTPPayloadFormat,\r\n{ "RTPPayloadFormat", "cast.RTPPayloadFormat",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_customPictureFormatCount,\r\n{ "CustomPictureFormatCount", "cast.customPictureFormatCount",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_pictureWidth,\r\n{ "PictureWidth", "cast.pictureWidth",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_pictureHeight,\r\n{ "PictureHeight", "cast.pictureHeight",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_pixelAspectRatio,\r\n{ "PixelAspectRatio", "cast.pixelAspectRatio",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_clockConversionCode,\r\n{ "ClockConversionCode", "cast.clockConversionCode",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_clockDivisor,\r\n{ "ClockDivisor", "cast.clockDivisor",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_activeStreamsOnRegistration,\r\n{ "ActiveStreamsOnRegistration", "cast.activeStreamsOnRegistration",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_maxBW,\r\n{ "MaxBW", "cast.maxBW",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_serviceResourceCount,\r\n{ "ServiceResourceCount", "cast.serviceResourceCount",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_layoutCount,\r\n{ "LayoutCount", "cast.layoutCount",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_layout,\r\n{ "Layout", "cast.layout",\r\nFT_UINT32, BASE_DEC, VALS(cast_Layouts), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_maxConferences,\r\n{ "MaxConferences", "cast.maxConferences",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_activeConferenceOnRegistration,\r\n{ "ActiveConferenceOnRegistration", "cast.activeConferenceOnRegistration",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_transmitOrReceive,\r\n{ "TransmitOrReceive", "cast.transmitOrReceive",\r\nFT_UINT32, BASE_DEC, VALS(cast_transmitOrReceive), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_levelPreferenceCount,\r\n{ "LevelPreferenceCount", "cast.levelPreferenceCount",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_transmitPreference,\r\n{ "TransmitPreference", "cast.transmitPreference",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_format,\r\n{ "Format", "cast.format",\r\nFT_UINT32, BASE_DEC, VALS(cast_formatTypes), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_maxBitRate,\r\n{ "MaxBitRate", "cast.maxBitRate",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_minBitRate,\r\n{ "MinBitRate", "cast.minBitRate",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_MPI,\r\n{ "MPI", "cast.MPI",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_serviceNumber,\r\n{ "ServiceNumber", "cast.serviceNumber",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_temporalSpatialTradeOffCapability,\r\n{ "TemporalSpatialTradeOffCapability", "cast.temporalSpatialTradeOffCapability",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_stillImageTransmission,\r\n{ "StillImageTransmission", "cast.stillImageTransmission",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_h263_capability_bitfield,\r\n{ "H263_capability_bitfield", "cast.h263_capability_bitfield",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_annexNandWFutureUse,\r\n{ "AnnexNandWFutureUse", "cast.annexNandWFutureUse",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_modelNumber,\r\n{ "ModelNumber", "cast.modelNumber",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_bandwidth,\r\n{ "Bandwidth", "cast.bandwidth",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_protocolDependentData,\r\n{ "ProtocolDependentData", "cast.protocolDependentData",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_DSCPValue,\r\n{ "DSCPValue", "cast.DSCPValue",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_serviceNum,\r\n{ "ServiceNum", "cast.serviceNum",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_cast_precedenceValue,\r\n{ "Precedence", "cast.precedenceValue",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_cast_maxStreams,\r\n{ "MaxStreams", "cast.maxStreams",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"32 bit unsigned integer indicating the maximum number of simultansous RTP duplex streams that the client can handle.",\r\nHFILL }\r\n},\r\n{ &hf_cast_millisecondPacketSize,\r\n{ "MS/Packet", "cast.millisecondPacketSize",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"The number of milliseconds of conversation in each packet",\r\nHFILL }\r\n},\r\n{ &hf_cast_echoCancelType,\r\n{ "Echo Cancel Type", "cast.echoCancelType",\r\nFT_UINT32, BASE_DEC, VALS(cast_echoCancelTypes), 0x0,\r\n"Is echo cancelling enabled or not",\r\nHFILL }\r\n},\r\n{ &hf_cast_g723BitRate,\r\n{ "G723 BitRate", "cast.g723BitRate",\r\nFT_UINT32, BASE_DEC, VALS(cast_g723BitRates), 0x0,\r\n"The G723 bit rate for this stream/JUNK if not g723 stream",\r\nHFILL }\r\n},\r\n{ &hf_cast_pictureFormatCount,\r\n{ "PictureFormatCount", "cast.pictureFormatCount",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_confServiceNum,\r\n{ "ConfServiceNum", "cast.confServiceNum",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_miscCommandType,\r\n{ "MiscCommandType", "cast.miscCommandType",\r\nFT_UINT32, BASE_DEC, VALS(cast_miscCommandType), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_temporalSpatialTradeOff,\r\n{ "TemporalSpatialTradeOff", "cast.temporalSpatialTradeOff",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_firstGOB,\r\n{ "FirstGOB", "cast.firstGOB",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_numberOfGOBs,\r\n{ "NumberOfGOBs", "cast.numberOfGOBs",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_firstMB,\r\n{ "FirstMB", "cast.firstMB",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_numberOfMBs,\r\n{ "NumberOfMBs", "cast.numberOfMBs",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_pictureNumber,\r\n{ "PictureNumber", "cast.pictureNumber",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_longTermPictureIndex,\r\n{ "LongTermPictureIndex", "cast.longTermPictureIndex",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"LongTermPictureIndex.",\r\nHFILL }\r\n},\r\n{ &hf_cast_recoveryReferencePictureCount,\r\n{ "RecoveryReferencePictureCount", "cast.recoveryReferencePictureCount",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"RecoveryReferencePictureCount.",\r\nHFILL }\r\n},\r\n{ &hf_cast_calledParty,\r\n{ "CalledParty", "cast.calledParty",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\n"The number called.",\r\nHFILL }\r\n},\r\n{ &hf_cast_privacy,\r\n{ "Privacy", "cast.privacy",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_precedenceLv,\r\n{ "PrecedenceLv", "cast.precedenceLv",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_precedenceDm,\r\n{ "PrecedenceDm", "cast.precedenceDm",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_callState,\r\n{ "CallState", "cast.callState",\r\nFT_UINT32, BASE_DEC, VALS(cast_callStateTypes), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_callingPartyName,\r\n{ "Calling Party Name", "cast.callingPartyName",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\n"The passed name of the calling party.",\r\nHFILL }\r\n},\r\n{ &hf_cast_callingParty,\r\n{ "Calling Party", "cast.callingParty",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\n"The passed number of the calling party.",\r\nHFILL }\r\n},\r\n{ &hf_cast_calledPartyName,\r\n{ "Called Party Name", "cast.calledPartyName",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\n"The name of the party we are calling.",\r\nHFILL }\r\n},\r\n{ &hf_cast_callType,\r\n{ "Call Type", "cast.callType",\r\nFT_UINT32, BASE_DEC, VALS(cast_callTypes), 0x0,\r\n"What type of call, in/out/etc",\r\nHFILL }\r\n},\r\n{ &hf_cast_originalCalledPartyName,\r\n{ "Original Called Party Name", "cast.originalCalledPartyName",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\n"name of the original person who placed the call.",\r\nHFILL }\r\n},\r\n{ &hf_cast_originalCalledParty,\r\n{ "Original Called Party", "cast.originalCalledParty",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\n"The number of the original calling party.",\r\nHFILL }\r\n},\r\n{ &hf_cast_lastRedirectingPartyName,\r\n{ "LastRedirectingPartyName", "cast.lastRedirectingPartyName",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_lastRedirectingParty,\r\n{ "LastRedirectingParty", "cast.lastRedirectingParty",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_cgpnVoiceMailbox,\r\n{ "CgpnVoiceMailbox", "cast.cgpnVoiceMailbox",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_cdpnVoiceMailbox,\r\n{ "CdpnVoiceMailbox", "cast.cdpnVoiceMailbox",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_originalCdpnVoiceMailbox,\r\n{ "OriginalCdpnVoiceMailbox", "cast.originalCdpnVoiceMailbox",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_lastRedirectingVoiceMailbox,\r\n{ "LastRedirectingVoiceMailbox", "cast.lastRedirectingVoiceMailbox",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_originalCdpnRedirectReason,\r\n{ "OriginalCdpnRedirectReason", "cast.originalCdpnRedirectReason",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_lastRedirectingReason,\r\n{ "LastRedirectingReason", "cast.lastRedirectingReason",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_callInstance,\r\n{ "CallInstance", "cast.callInstance",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_callSecurityStatus,\r\n{ "CallSecurityStatus", "cast.callSecurityStatus",\r\nFT_UINT32, BASE_DEC, VALS(cast_callSecurityStatusTypes), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_partyPIRestrictionBits_CallingPartyName,\r\n{ "RestrictCallingPartyName", "cast.partyPIRestrictionBits.CallingPartyName",\r\nFT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_partyPIRestrictionBits_CallingPartyNumber,\r\n{ "RestrictCallingPartyNumber", "cast.partyPIRestrictionBits.CallingPartyNumber",\r\nFT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_partyPIRestrictionBits_CalledPartyName,\r\n{ "RestrictCalledPartyName", "cast.partyPIRestrictionBits.CalledPartyName",\r\nFT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_partyPIRestrictionBits_CalledPartyNumber,\r\n{ "RestrictCalledPartyNumber", "cast.partyPIRestrictionBits.CalledPartyNumber",\r\nFT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_partyPIRestrictionBits_OriginalCalledPartyName,\r\n{ "RestrictOriginalCalledPartyName", "cast.partyPIRestrictionBits.OriginalCalledPartyName",\r\nFT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_partyPIRestrictionBits_OriginalCalledPartyNumber,\r\n{ "RestrictOriginalCalledPartyNumber", "cast.partyPIRestrictionBits.OriginalCalledPartyNumber",\r\nFT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_partyPIRestrictionBits_LastRedirectPartyName,\r\n{ "RestrictLastRedirectPartyName", "cast.partyPIRestrictionBits.LastRedirectPartyName",\r\nFT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_partyPIRestrictionBits_LastRedirectPartyNumber,\r\n{ "RestrictLastRedirectPartyNumber", "cast.partyPIRestrictionBits.LastRedirectPartyNumber",\r\nFT_BOOLEAN, 32, TFS(&tfs_yes_no), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_directoryNumber,\r\n{ "Directory Number", "cast.directoryNumber",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\n"The number we are reporting statistics for.",\r\nHFILL }\r\n},\r\n{ &hf_cast_requestorIpAddress,\r\n{ "RequestorIpAddress", "cast.requestorIpAddress",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_stationIpAddress,\r\n{ "StationIpAddress", "cast.stationIpAddress",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_stationFriendlyName,\r\n{ "StationFriendlyName", "cast.stationFriendlyName",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_stationGUID,\r\n{ "stationGUID", "cast.stationGUID",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_cast_audio,\r\n{ "AudioCodec", "cast.audio",\r\nFT_UINT32, BASE_DEC, VALS(audioCodecTypes), 0x0,\r\n"The audio codec that is in use.",\r\nHFILL }\r\n},\r\n{ &hf_cast_bitRate,\r\n{ "BitRate", "cast.bitRate",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_cast,\r\n&ett_cast_tree,\r\n};\r\nmodule_t *cast_module;\r\nproto_cast = proto_register_protocol("Cast Client Control Protocol",\r\n"CAST", "cast");\r\nproto_register_field_array(proto_cast, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\ncast_module = prefs_register_protocol(proto_cast, NULL);\r\nprefs_register_bool_preference(cast_module, "reassembly",\r\n"Reassemble CAST messages spanning multiple TCP segments",\r\n"Whether the CAST dissector should reassemble messages spanning multiple TCP segments."\r\n" To use this option, you must also enable \"Allow subdissectors to reassemble TCP streams\" in the TCP protocol settings.",\r\n&cast_desegment);\r\n}\r\nvoid\r\nproto_reg_handoff_cast(void)\r\n{\r\ndissector_handle_t cast_handle;\r\ncast_handle = create_dissector_handle(dissect_cast, proto_cast);\r\ndissector_add_uint("tcp.port", TCP_PORT_CAST, cast_handle);\r\n}
