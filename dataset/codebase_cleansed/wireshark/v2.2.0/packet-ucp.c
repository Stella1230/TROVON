static void\r\nucp_stats_tree_init(stats_tree* st)\r\n{\r\nst_ucp_messages = stats_tree_create_node(st, st_str_ucp, 0, TRUE);\r\nst_ucp_ops = stats_tree_create_node(st, st_str_ops, st_ucp_messages, TRUE);\r\nst_ucp_res = stats_tree_create_node(st, st_str_res, st_ucp_messages, TRUE);\r\nst_ucp_results = stats_tree_create_node(st, st_str_ucp_res, 0, TRUE);\r\nst_ucp_results_pos = stats_tree_create_node(st, st_str_pos, st_ucp_results, TRUE);\r\nst_ucp_results_neg = stats_tree_create_node(st, st_str_neg, st_ucp_results, TRUE);\r\n}\r\nstatic int\r\nucp_stats_tree_per_packet(stats_tree *st,\r\npacket_info *pinfo _U_,\r\nepan_dissect_t *edt _U_,\r\nconst void *p)\r\n{\r\nconst ucp_tap_rec_t *tap_rec = (const ucp_tap_rec_t*)p;\r\ntick_stat_node(st, st_str_ucp, 0, TRUE);\r\nif (tap_rec->message_type == 0)\r\n{\r\ntick_stat_node(st, st_str_ops, st_ucp_messages, TRUE);\r\ntick_stat_node(st, val_to_str_ext(tap_rec->operation, &vals_hdr_OT_ext,\r\n"Unknown OT: %d"), st_ucp_ops, FALSE);\r\n}\r\nelse\r\n{\r\ntick_stat_node(st, st_str_res, st_ucp_messages, TRUE);\r\ntick_stat_node(st, val_to_str_ext(tap_rec->operation, &vals_hdr_OT_ext,\r\n"Unknown OT: %d"), st_ucp_res, FALSE);\r\ntick_stat_node(st, st_str_ucp_res, 0, TRUE);\r\nif (tap_rec->result == 0)\r\n{\r\ntick_stat_node(st, st_str_pos, st_ucp_results, FALSE);\r\n}\r\nelse\r\n{\r\ntick_stat_node(st, st_str_neg, st_ucp_results, TRUE);\r\ntick_stat_node(st, val_to_str_ext(tap_rec->result, &vals_parm_EC_ext,\r\n"Unknown EC: %d"), st_ucp_results_neg, FALSE);\r\n}\r\n}\r\nreturn 1;\r\n}\r\nstatic int\r\ncheck_ucp(tvbuff_t *tvb, int *endpkt)\r\n{\r\nguint offset = 1;\r\nguint checksum = 0;\r\nint pkt_check, tmp;\r\nint length;\r\nlength = tvb_find_guint8(tvb, offset, -1, UCP_ETX);\r\nif (length == -1) {\r\n*endpkt = tvb_reported_length_remaining(tvb, offset);\r\nreturn UCP_MALFORMED;\r\n}\r\nfor (; offset < (guint) (length - 2); offset++)\r\nchecksum += tvb_get_guint8(tvb, offset);\r\nchecksum &= 0xFF;\r\ntmp = tvb_get_guint8(tvb, offset++);\r\npkt_check = AHex2Bin(tmp);\r\ntmp = tvb_get_guint8(tvb, offset++);\r\npkt_check = 16 * pkt_check + AHex2Bin(tmp);\r\n*endpkt = offset + 1;\r\nif (checksum == (guint) pkt_check)\r\nreturn 0;\r\nelse\r\nreturn UCP_INV_CHK;\r\n}\r\nstatic time_t\r\nucp_mktime(const gint len, const char *datestr)\r\n{\r\nstruct tm r_time;\r\nr_time.tm_mday = (10 * (datestr[0] - '0') + (datestr[1] - '0'));\r\nif (len >= 4)\r\nr_time.tm_mon = (10 * (datestr[2] - '0') + (datestr[3] - '0')) - 1;\r\nelse\r\nr_time.tm_mon = 0;\r\nif (len >= 6)\r\nr_time.tm_year = (10 * (datestr[4] - '0') + (datestr[5] - '0'));\r\nelse\r\nr_time.tm_year = 0;\r\nif (r_time.tm_year < 90)\r\nr_time.tm_year += 100;\r\nif (len >= 8)\r\nr_time.tm_hour = (10 * (datestr[6] - '0') + (datestr[7] - '0'));\r\nelse\r\nr_time.tm_hour = 0;\r\nif (len >= 10)\r\nr_time.tm_min = (10 * (datestr[8] - '0') + (datestr[9] - '0'));\r\nelse\r\nr_time.tm_min = 0;\r\nif (len >= 12)\r\nr_time.tm_sec = (10 * (datestr[10] - '0') + (datestr[11] - '0'));\r\nelse\r\nr_time.tm_sec = 0;\r\nr_time.tm_isdst = -1;\r\nreturn mktime(&r_time);\r\n}\r\nstatic void\r\nucp_handle_string(proto_tree *tree, tvbuff_t *tvb, int field, int *offset)\r\n{\r\ngint idx, len;\r\nidx = tvb_find_guint8(tvb, *offset, -1, '/');\r\nif (idx == -1) {\r\nlen = tvb_captured_length_remaining(tvb, *offset);\r\ntvb_ensure_bytes_exist(tvb, *offset, len + 1);\r\n} else\r\nlen = idx - *offset;\r\nif (len > 0)\r\nproto_tree_add_item(tree, field, tvb, *offset, len, ENC_ASCII|ENC_NA);\r\n*offset += len;\r\nif (idx != -1)\r\n*offset += 1;\r\n}\r\nstatic void\r\nucp_handle_IRAstring(proto_tree *tree, tvbuff_t *tvb, int field, int *offset)\r\n{\r\nchar strval[UCP_BUFSIZ + 1],\r\n*p_dst = strval;\r\nguint8 byte;\r\nint idx = 0;\r\nint tmpoff = *offset;\r\nwhile (((byte = tvb_get_guint8(tvb, tmpoff++)) != '/') &&\r\n(idx < UCP_BUFSIZ))\r\n{\r\nif (byte >= '0' && byte <= '9')\r\n{\r\n*p_dst = (byte - '0') * 16;\r\n}\r\nelse\r\n{\r\n*p_dst = (byte - 'A' + 10) * 16;\r\n}\r\nif ((byte = tvb_get_guint8(tvb, tmpoff++)) == '/')\r\n{\r\nbreak;\r\n}\r\nif (byte >= '0' && byte <= '9')\r\n{\r\n*p_dst++ += byte - '0';\r\n}\r\nelse\r\n{\r\n*p_dst++ += byte - 'A' + 10;\r\n}\r\nidx++;\r\n}\r\nstrval[idx] = '\0';\r\nif (idx == UCP_BUFSIZ)\r\n{\r\nwhile ((tvb_get_guint8(tvb, tmpoff++)) != '/')\r\n;\r\n}\r\nif ((tmpoff - *offset) > 1)\r\nproto_tree_add_string(tree, field, tvb, *offset,\r\ntmpoff - *offset - 1, strval);\r\n*offset = tmpoff;\r\n}\r\nstatic guint\r\nucp_handle_byte(proto_tree *tree, tvbuff_t *tvb, int field, int *offset)\r\n{\r\nguint intval = 0;\r\nif ((intval = tvb_get_guint8(tvb, (*offset)++)) != '/') {\r\nproto_tree_add_uint(tree, field, tvb, *offset - 1, 1, intval);\r\n(*offset)++;\r\n}\r\nreturn intval;\r\n}\r\nstatic guint\r\nucp_handle_int(proto_tree *tree, tvbuff_t *tvb, int field, int *offset)\r\n{\r\ngint idx, len;\r\nconst char *strval;\r\nguint intval = 0;\r\nidx = tvb_find_guint8(tvb, *offset, -1, '/');\r\nif (idx == -1) {\r\nlen = tvb_captured_length_remaining(tvb, *offset);\r\ntvb_ensure_bytes_exist(tvb, *offset, len + 1);\r\n} else\r\nlen = idx - *offset;\r\nstrval = tvb_get_string_enc(wmem_packet_scope(), tvb, *offset, len, ENC_ASCII);\r\nif (len > 0) {\r\nintval = atoi(strval);\r\nproto_tree_add_uint(tree, field, tvb, *offset, len, intval);\r\n}\r\n*offset += len;\r\nif (idx != -1)\r\n*offset += 1;\r\nreturn intval;\r\n}\r\nstatic void\r\nucp_handle_time(proto_tree *tree, tvbuff_t *tvb, int field, int *offset)\r\n{\r\ngint idx, len;\r\nconst char *strval;\r\ntime_t tval;\r\nnstime_t tmptime;\r\nidx = tvb_find_guint8(tvb, *offset, -1, '/');\r\nif (idx == -1) {\r\nlen = tvb_captured_length_remaining(tvb, *offset);\r\ntvb_ensure_bytes_exist(tvb, *offset, len + 1);\r\n} else\r\nlen = idx - *offset;\r\nstrval = tvb_get_string_enc(wmem_packet_scope(), tvb, *offset, len, ENC_ASCII);\r\nif (len > 0) {\r\ntval = ucp_mktime(len, strval);\r\ntmptime.secs = tval;\r\ntmptime.nsecs = 0;\r\nproto_tree_add_time(tree, field, tvb, *offset, len, &tmptime);\r\n}\r\n*offset += len;\r\nif (idx != -1)\r\n*offset += 1;\r\n}\r\nstatic void\r\nucp_handle_data(proto_tree *tree, tvbuff_t *tvb, int field, int *offset)\r\n{\r\nint tmpoff = *offset;\r\nwhile (tvb_get_guint8(tvb, tmpoff++) != '/')\r\n;\r\nif ((tmpoff - *offset) > 1)\r\nproto_tree_add_item(tree, field, tvb, *offset,\r\ntmpoff - *offset - 1, ENC_NA);\r\n*offset = tmpoff;\r\n}\r\nstatic void\r\nucp_handle_data_string(proto_tree *tree, tvbuff_t *tvb, int field, int *offset)\r\n{\r\nint tmpoff = *offset;\r\nwhile (tvb_get_guint8(tvb, tmpoff++) != '/')\r\n;\r\nif ((tmpoff - *offset) > 1)\r\nproto_tree_add_item(tree, field, tvb, *offset,\r\ntmpoff - *offset - 1, ENC_ASCII|ENC_NA);\r\n*offset = tmpoff;\r\n}\r\nstatic void\r\nucp_handle_mt(proto_tree *tree, tvbuff_t *tvb, int *offset)\r\n{\r\nguint intval;\r\nintval = ucp_handle_byte(tree, tvb, hf_ucp_parm_MT, offset);\r\nswitch (intval) {\r\ncase '1':\r\nbreak;\r\ncase '4':\r\nucp_handle_string(tree, tvb, hf_ucp_parm_NB, offset);\r\ncase '2':\r\nucp_handle_data(tree, tvb, hf_ucp_data_section, offset);\r\nbreak;\r\ncase '3':\r\nucp_handle_IRAstring(tree, tvb, hf_ucp_parm_AMsg, offset);\r\nbreak;\r\ncase '5':\r\nucp_handle_byte(tree, tvb, hf_ucp_parm_PNC, offset);\r\nucp_handle_string(tree, tvb, hf_ucp_parm_LNo, offset);\r\nucp_handle_string(tree, tvb, hf_ucp_parm_LST, offset);\r\nucp_handle_string(tree, tvb, hf_ucp_parm_TNo, offset);\r\nbreak;\r\ncase '6':\r\nucp_handle_data(tree, tvb, hf_ucp_data_section, offset);\r\nucp_handle_int(tree, tvb, hf_ucp_parm_CS, offset);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\nstatic void\r\nucp_handle_XSer(proto_tree *tree, tvbuff_t *tvb)\r\n{\r\nint offset = 0;\r\nguint intval;\r\nint service;\r\nint len;\r\nwhile ((intval = tvb_get_guint8(tvb, offset)) != '/') {\r\nservice = AHex2Bin(intval);\r\nintval = tvb_get_guint8(tvb, offset+1);\r\nservice = service * 16 + AHex2Bin(intval);\r\nintval = tvb_get_guint8(tvb, offset+2);\r\nlen = AHex2Bin(intval);\r\nintval = tvb_get_guint8(tvb, offset+3);\r\nlen = len * 16 + AHex2Bin(intval);\r\nproto_tree_add_uint(tree, hf_xser_service, tvb, offset, 2, service);\r\nproto_tree_add_uint(tree, hf_xser_length, tvb, offset+2, 2, len);\r\nproto_tree_add_item(tree, hf_xser_data, tvb, offset+4, len*2, ENC_ASCII|ENC_NA);\r\noffset += 4 + (2 * len);\r\n}\r\n}\r\nstatic void\r\nadd_00O(proto_tree *tree, tvbuff_t *tvb)\r\n{\r\nint offset = 1;\r\nUcpHandleString(hf_ucp_parm_AdC);\r\nUcpHandleString(hf_ucp_parm_OAdC);\r\nUcpHandleString(hf_ucp_parm_OAC);\r\n}\r\nstatic void\r\nadd_00R(proto_tree *tree, tvbuff_t *tvb, ucp_tap_rec_t *tap_rec)\r\n{\r\nint offset = 1;\r\nguint intval;\r\nintval = UcpHandleByte(hf_ucp_parm_ACK);\r\nif (intval == 'A')\r\n{\r\nUcpHandleByte(hf_ucp_parm_BAS);\r\nUcpHandleByte(hf_ucp_parm_LAR);\r\nUcpHandleByte(hf_ucp_parm_L1R);\r\nUcpHandleByte(hf_ucp_parm_L3R);\r\nUcpHandleByte(hf_ucp_parm_LCR);\r\nUcpHandleByte(hf_ucp_parm_LUR);\r\nUcpHandleByte(hf_ucp_parm_LRR);\r\nUcpHandleByte(hf_ucp_parm_RT);\r\nUcpHandleInt(hf_ucp_parm_NoN);\r\nUcpHandleInt(hf_ucp_parm_NoA);\r\nUcpHandleInt(hf_ucp_parm_NoB);\r\ntap_rec->result = 0;\r\n} else {\r\ntap_rec->result = UcpHandleInt(hf_ucp_parm_EC);\r\nUcpHandleString(hf_ucp_parm_SM);\r\n}\r\n}\r\nstatic void\r\nadd_01O(proto_tree *tree, tvbuff_t *tvb)\r\n{\r\nint offset = 1;\r\nUcpHandleString(hf_ucp_parm_AdC);\r\nUcpHandleString(hf_ucp_parm_OAdC);\r\nUcpHandleString(hf_ucp_parm_OAC);\r\nucp_handle_mt(tree, tvb, &offset);\r\n}\r\nstatic void\r\nadd_01R(proto_tree *tree, tvbuff_t *tvb, ucp_tap_rec_t *tap_rec)\r\n{\r\nint offset = 1;\r\nguint intval;\r\nintval = UcpHandleByte(hf_ucp_parm_ACK);\r\nif (intval == 'N')\r\ntap_rec->result = UcpHandleInt(hf_ucp_parm_EC);\r\nelse\r\ntap_rec->result = 0;\r\nUcpHandleString(hf_ucp_parm_SM);\r\n}\r\nstatic void\r\nadd_02O(proto_tree *tree, tvbuff_t *tvb)\r\n{\r\nint offset = 1;\r\nguint intval;\r\nguint idx;\r\nintval = UcpHandleInt(hf_ucp_parm_NPL);\r\nfor (idx = 0; idx < intval; idx++)\r\nUcpHandleString(hf_ucp_parm_AdC);\r\nUcpHandleString(hf_ucp_parm_OAdC);\r\nUcpHandleString(hf_ucp_parm_OAC);\r\nucp_handle_mt(tree, tvb, &offset);\r\n}\r\nstatic void\r\nadd_03O(proto_tree *tree, tvbuff_t *tvb)\r\n{\r\nint offset = 1;\r\nguint intval;\r\nguint idx;\r\nUcpHandleString(hf_ucp_parm_AdC);\r\nUcpHandleString(hf_ucp_parm_OAdC);\r\nUcpHandleString(hf_ucp_parm_OAC);\r\nintval = UcpHandleInt(hf_ucp_parm_NPL);\r\nfor (idx = 0; idx < intval; idx++)\r\nUcpHandleString(hf_ucp_parm_GA);\r\nUcpHandleByte(hf_ucp_parm_RP);\r\nUcpHandleString(hf_ucp_parm_LRP);\r\nUcpHandleByte(hf_ucp_parm_PR);\r\nUcpHandleString(hf_ucp_parm_LPR);\r\nUcpHandleByte(hf_ucp_parm_UM);\r\nUcpHandleString(hf_ucp_parm_LUM);\r\nUcpHandleByte(hf_ucp_parm_RC);\r\nUcpHandleString(hf_ucp_parm_LRC);\r\nUcpHandleByte(hf_ucp_parm_DD);\r\nUcpHandleTime(hf_ucp_parm_DDT);\r\nucp_handle_mt(tree, tvb, &offset);\r\n}\r\nstatic void\r\nadd_04O(proto_tree *tree, tvbuff_t *tvb)\r\n{\r\nint offset = 1;\r\nUcpHandleString(hf_ucp_parm_GAdC);\r\nUcpHandleString(hf_ucp_parm_AC);\r\nUcpHandleString(hf_ucp_parm_OAdC);\r\nUcpHandleString(hf_ucp_parm_OAC);\r\n}\r\nstatic void\r\nadd_04R(proto_tree *tree, tvbuff_t *tvb, ucp_tap_rec_t *tap_rec)\r\n{\r\nint offset = 1;\r\nguint intval;\r\nguint idx;\r\nintval = UcpHandleByte(hf_ucp_parm_ACK);\r\nif (intval == 'A') {\r\nintval = UcpHandleInt(hf_ucp_parm_NPL);\r\nfor (idx = 0; idx < intval; idx++)\r\nUcpHandleString(hf_ucp_parm_AdC);\r\nUcpHandleString(hf_ucp_parm_GAdC);\r\ntap_rec->result = 0;\r\n} else\r\ntap_rec->result = UcpHandleInt(hf_ucp_parm_EC);\r\nUcpHandleString(hf_ucp_parm_SM);\r\n}\r\nstatic void\r\nadd_05O(proto_tree *tree, tvbuff_t *tvb)\r\n{\r\nint offset = 1;\r\nguint intval;\r\nguint idx;\r\nUcpHandleString(hf_ucp_parm_GAdC);\r\nUcpHandleString(hf_ucp_parm_AC);\r\nUcpHandleString(hf_ucp_parm_OAdC);\r\nUcpHandleString(hf_ucp_parm_OAC);\r\nintval = UcpHandleInt(hf_ucp_parm_NPL);\r\nfor (idx = 0; idx < intval; idx++)\r\nUcpHandleString(hf_ucp_parm_AdC);\r\nUcpHandleByte(hf_ucp_parm_A_D);\r\n}\r\nstatic void\r\nadd_06O(proto_tree *tree, tvbuff_t *tvb)\r\n{\r\nint offset = 1;\r\nUcpHandleString(hf_ucp_parm_AdC);\r\nUcpHandleString(hf_ucp_parm_AC);\r\n}\r\nstatic void\r\nadd_06R(proto_tree *tree, tvbuff_t *tvb, ucp_tap_rec_t *tap_rec)\r\n{\r\nint offset = 1;\r\nguint intval;\r\nintval = UcpHandleByte(hf_ucp_parm_ACK);\r\nif (intval == 'A') {\r\nUcpHandleTime(hf_ucp_parm_CT);\r\nUcpHandleString(hf_ucp_parm_AAC);\r\ntap_rec->result = 0;\r\n} else\r\ntap_rec->result = UcpHandleInt(hf_ucp_parm_EC);\r\nUcpHandleString(hf_ucp_parm_SM);\r\n}\r\nstatic void\r\nadd_07O(proto_tree *tree, tvbuff_t *tvb)\r\n{\r\nint offset = 1;\r\nUcpHandleString(hf_ucp_parm_AdC);\r\nUcpHandleString(hf_ucp_parm_AC);\r\nUcpHandleString(hf_ucp_parm_NAC);\r\n}\r\nstatic void\r\nadd_08O(proto_tree *tree, tvbuff_t *tvb)\r\n{\r\nint offset = 1;\r\nUcpHandleString(hf_ucp_parm_AdC);\r\nUcpHandleString(hf_ucp_parm_AC);\r\nUcpHandleString(hf_ucp_parm_LAC);\r\nUcpHandleString(hf_ucp_parm_L1P);\r\nUcpHandleString(hf_ucp_parm_L3P);\r\nUcpHandleString(hf_ucp_parm_LRC);\r\nUcpHandleString(hf_ucp_parm_LUM);\r\nUcpHandleString(hf_ucp_parm_LRP);\r\nUcpHandleString(hf_ucp_parm_LST);\r\n}\r\nstatic void\r\nadd_09O(proto_tree *tree, tvbuff_t *tvb)\r\n{\r\nint offset = 1;\r\nUcpHandleString(hf_ucp_parm_LNo);\r\nUcpHandleString(hf_ucp_parm_LST);\r\n}\r\nstatic void\r\nadd_09R(proto_tree *tree, tvbuff_t *tvb, ucp_tap_rec_t *tap_rec)\r\n{\r\nint offset = 1;\r\nguint intval;\r\nguint idx;\r\nintval = UcpHandleByte(hf_ucp_parm_ACK);\r\nif (intval == 'A') {\r\nintval = UcpHandleInt(hf_ucp_parm_NPL);\r\nfor (idx = 0; idx < intval; idx++)\r\nUcpHandleString(hf_ucp_parm_LST);\r\ntap_rec->result = 0;\r\n} else\r\ntap_rec->result = UcpHandleInt(hf_ucp_parm_EC);\r\nUcpHandleString(hf_ucp_parm_SM);\r\n}\r\nstatic void\r\nadd_10O(proto_tree *tree, tvbuff_t *tvb)\r\n{\r\nint offset = 1;\r\nUcpHandleString(hf_ucp_parm_AdC);\r\nUcpHandleString(hf_ucp_parm_AC);\r\nUcpHandleString(hf_ucp_parm_LNo);\r\nUcpHandleString(hf_ucp_parm_TNo);\r\nUcpHandleData(hf_ucp_parm_STx);\r\nUcpHandleInt(hf_ucp_parm_CS);\r\n}\r\nstatic void\r\nadd_11R(proto_tree *tree, tvbuff_t *tvb, ucp_tap_rec_t *tap_rec)\r\n{\r\nint offset = 1;\r\nguint intval;\r\nguint idx;\r\nintval = UcpHandleByte(hf_ucp_parm_ACK);\r\nif (intval == 'A') {\r\nintval = UcpHandleInt(hf_ucp_parm_NPL);\r\nfor (idx = 0; idx < intval; idx++)\r\nUcpHandleString(hf_ucp_parm_GA);\r\ntap_rec->result = 0;\r\n} else\r\ntap_rec->result = UcpHandleInt(hf_ucp_parm_EC);\r\nUcpHandleString(hf_ucp_parm_SM);\r\n}\r\nstatic void\r\nadd_12O(proto_tree *tree, tvbuff_t *tvb)\r\n{\r\nint offset = 1;\r\nguint intval;\r\nguint idx;\r\nUcpHandleString(hf_ucp_parm_AdC);\r\nUcpHandleString(hf_ucp_parm_AC);\r\nintval = UcpHandleInt(hf_ucp_parm_NPL);\r\nfor (idx = 0; idx < intval; idx++)\r\nUcpHandleString(hf_ucp_parm_GA);\r\n}\r\nstatic void\r\nadd_14O(proto_tree *tree, tvbuff_t *tvb)\r\n{\r\nint offset = 1;\r\nUcpHandleString(hf_ucp_parm_AdC);\r\nUcpHandleString(hf_ucp_parm_AC);\r\nUcpHandleString(hf_ucp_parm_MNo);\r\nUcpHandleByte(hf_ucp_parm_R_T);\r\n}\r\nstatic void\r\nadd_14R(proto_tree *tree, tvbuff_t *tvb, ucp_tap_rec_t *tap_rec)\r\n{\r\nint offset = 1;\r\nguint intval;\r\nguint idx;\r\nintval = UcpHandleByte(hf_ucp_parm_ACK);\r\nif (intval == 'A') {\r\nintval = UcpHandleInt(hf_ucp_parm_NPL);\r\nfor (idx = 0; idx < intval; idx++)\r\nUcpHandleData(hf_ucp_data_section);\r\ntap_rec->result = 0;\r\n} else {\r\ntap_rec->result = UcpHandleInt(hf_ucp_parm_EC);\r\nUcpHandleString(hf_ucp_parm_SM);\r\n}\r\n}\r\nstatic void\r\nadd_15O(proto_tree *tree, tvbuff_t *tvb)\r\n{\r\nint offset = 1;\r\nUcpHandleString(hf_ucp_parm_AdC);\r\nUcpHandleString(hf_ucp_parm_AC);\r\nUcpHandleTime(hf_ucp_parm_ST);\r\nUcpHandleTime(hf_ucp_parm_SP);\r\n}\r\nstatic void\r\nadd_17O(proto_tree *tree, tvbuff_t *tvb)\r\n{\r\nint offset = 1;\r\nUcpHandleString(hf_ucp_parm_AdC);\r\nUcpHandleString(hf_ucp_parm_AC);\r\nUcpHandleString(hf_ucp_parm_DAdC);\r\nUcpHandleTime(hf_ucp_parm_ST);\r\nUcpHandleTime(hf_ucp_parm_SP);\r\n}\r\nstatic void\r\nadd_19O(proto_tree *tree, tvbuff_t *tvb)\r\n{\r\nint offset = 1;\r\nUcpHandleString(hf_ucp_parm_AdC);\r\nUcpHandleString(hf_ucp_parm_AC);\r\nUcpHandleTime(hf_ucp_parm_ST);\r\nUcpHandleTime(hf_ucp_parm_SP);\r\n}\r\nstatic void\r\nadd_22O(proto_tree *tree, tvbuff_t *tvb)\r\n{\r\nint offset = 1;\r\nUcpHandleString(hf_ucp_parm_AdC);\r\nUcpHandleString(hf_ucp_parm_OAdC);\r\nUcpHandleString(hf_ucp_parm_OAC);\r\nUcpHandleData(hf_ucp_data_section);\r\nUcpHandleInt(hf_ucp_parm_CS);\r\n}\r\nstatic void\r\nadd_23O(proto_tree *tree, tvbuff_t *tvb)\r\n{\r\nint offset = 1;\r\nUcpHandleString(hf_ucp_parm_IVR5x);\r\nUcpHandleByte(hf_ucp_parm_REQ_OT);\r\n}\r\nstatic void\r\nadd_23R(proto_tree *tree, tvbuff_t *tvb, ucp_tap_rec_t *tap_rec)\r\n{\r\nint offset = 1;\r\nguint intval;\r\nguint idx;\r\nintval = UcpHandleByte(hf_ucp_parm_ACK);\r\nif (intval == 'A') {\r\nUcpHandleByte(hf_ucp_parm_IVR5x);\r\nintval = UcpHandleInt(hf_ucp_parm_NPL);\r\nfor (idx = 0; idx < intval; idx++)\r\nUcpHandleInt(hf_ucp_hdr_OT);\r\ntap_rec->result = 0;\r\n} else\r\ntap_rec->result = UcpHandleInt(hf_ucp_parm_EC);\r\nUcpHandleString(hf_ucp_parm_SM);\r\n}\r\nstatic void\r\nadd_24O(proto_tree *tree, tvbuff_t *tvb)\r\n{\r\nint offset = 1;\r\nUcpHandleString(hf_ucp_parm_AdC);\r\nUcpHandleString(hf_ucp_parm_AC);\r\nUcpHandleByte(hf_ucp_parm_SSTAT);\r\n}\r\nstatic void\r\nadd_24R(proto_tree *tree, tvbuff_t *tvb, ucp_tap_rec_t *tap_rec)\r\n{\r\nint offset = 1;\r\nguint intval;\r\nguint idx;\r\nintval = UcpHandleByte(hf_ucp_parm_ACK);\r\nif (intval == 'A') {\r\nif ((intval = tvb_get_guint8(tvb, offset++)) != '/') {\r\nproto_tree_add_item(tree, hf_ucp_ga_roaming, tvb, offset - 1, 1, ENC_NA);\r\nif (intval == 'N') {\r\nproto_tree_add_item(tree, hf_ucp_not_subscribed, tvb, offset -1, 1, ENC_NA);\r\noffset++;\r\n} else {\r\n--offset;\r\nintval = UcpHandleInt(hf_ucp_parm_NPL);\r\nfor (idx = 0; idx < intval; idx++)\r\nUcpHandleData(hf_ucp_data_section);\r\n}\r\n}\r\nif ((intval = tvb_get_guint8(tvb, offset++)) != '/') {\r\nproto_tree_add_item(tree, hf_ucp_call_barring, tvb, offset - 1, 1, ENC_NA);\r\nif (intval == 'N') {\r\nproto_tree_add_item(tree, hf_ucp_not_subscribed, tvb, offset -1, 1, ENC_NA);\r\noffset++;\r\n} else {\r\n--offset;\r\nintval = UcpHandleInt(hf_ucp_parm_NPL);\r\nfor (idx = 0; idx < intval; idx++)\r\nUcpHandleData(hf_ucp_data_section);\r\n}\r\n}\r\nif ((intval = tvb_get_guint8(tvb, offset++)) != '/') {\r\nproto_tree_add_item(tree, hf_ucp_deferred_delivery, tvb, offset - 1, 1, ENC_NA);\r\nif (intval == 'N') {\r\nproto_tree_add_item(tree, hf_ucp_not_subscribed, tvb, offset -1, 1, ENC_NA);\r\noffset++;\r\n} else {\r\n--offset;\r\nintval = UcpHandleInt(hf_ucp_parm_NPL);\r\nfor (idx = 0; idx < intval; idx++)\r\nUcpHandleData(hf_ucp_data_section);\r\n}\r\n}\r\nif ((intval = tvb_get_guint8(tvb, offset++)) != '/') {\r\nproto_tree_add_item(tree, hf_ucp_diversion, tvb, offset - 1, 1, ENC_NA);\r\nif (intval == 'N') {\r\nproto_tree_add_item(tree, hf_ucp_not_subscribed, tvb, offset -1, 1, ENC_NA);\r\noffset++;\r\n} else {\r\n--offset;\r\nintval = UcpHandleInt(hf_ucp_parm_NPL);\r\nfor (idx = 0; idx < intval; idx++)\r\nUcpHandleData(hf_ucp_data_section);\r\n}\r\n}\r\nUcpHandleInt(hf_ucp_parm_LMN);\r\nif ((intval = tvb_get_guint8(tvb, offset++)) != '/') {\r\nif (intval == 'N') {\r\nproto_tree_add_item(tree, hf_ucp_not_subscribed, tvb, offset -1, 1, ENC_NA);\r\noffset++;\r\n} else {\r\n--offset;\r\nUcpHandleInt(hf_ucp_parm_NMESS);\r\n}\r\n}\r\ntap_rec->result = 0;\r\n} else\r\ntap_rec->result = UcpHandleInt(hf_ucp_parm_EC);\r\nUcpHandleString(hf_ucp_parm_SM);\r\n}\r\nstatic void\r\nadd_30O(proto_tree *tree, tvbuff_t *tvb)\r\n{\r\nint offset = 1;\r\nUcpHandleString(hf_ucp_parm_AdC);\r\nUcpHandleString(hf_ucp_parm_OAdC);\r\nUcpHandleString(hf_ucp_parm_AC);\r\nUcpHandleByte(hf_ucp_parm_NRq);\r\nUcpHandleString(hf_ucp_parm_NAdC);\r\nUcpHandleInt(hf_ucp_parm_NPID);\r\nUcpHandleByte(hf_ucp_parm_DD);\r\nUcpHandleTime(hf_ucp_parm_DDT);\r\nUcpHandleTime(hf_ucp_parm_VP);\r\nUcpHandleIRAString(hf_ucp_parm_AMsg);\r\n}\r\nstatic void\r\nadd_30R(proto_tree *tree, tvbuff_t *tvb, ucp_tap_rec_t *tap_rec)\r\n{\r\nint offset = 1;\r\nguint intval;\r\nintval = UcpHandleByte(hf_ucp_parm_ACK);\r\nif (intval == 'A') {\r\nUcpHandleTime(hf_ucp_parm_MVP);\r\ntap_rec->result = 0;\r\n} else {\r\ntap_rec->result = UcpHandleInt(hf_ucp_parm_EC);\r\n}\r\nUcpHandleString(hf_ucp_parm_SM);\r\n}\r\nstatic void\r\nadd_31O(proto_tree *tree, tvbuff_t *tvb)\r\n{\r\nint offset = 1;\r\nUcpHandleString(hf_ucp_parm_AdC);\r\nUcpHandleInt(hf_ucp_parm_PID);\r\n}\r\nstatic void\r\nadd_5xO(proto_tree *tree, tvbuff_t *tvb)\r\n{\r\nguint intval;\r\nint offset = 1;\r\nint tmpoff;\r\nproto_item *ti;\r\ntvbuff_t *tmptvb;\r\nUcpHandleString(hf_ucp_parm_AdC);\r\nUcpHandleString(hf_ucp_parm_OAdC);\r\nUcpHandleString(hf_ucp_parm_AC);\r\nUcpHandleByte(hf_ucp_parm_NRq);\r\nUcpHandleString(hf_ucp_parm_NAdC);\r\nUcpHandleByte(hf_ucp_parm_NT);\r\nUcpHandleInt(hf_ucp_parm_NPID);\r\nUcpHandleByte(hf_ucp_parm_LRq);\r\nUcpHandleString(hf_ucp_parm_LRAd);\r\nUcpHandleInt(hf_ucp_parm_LPID);\r\nUcpHandleByte(hf_ucp_parm_DD);\r\nUcpHandleTime(hf_ucp_parm_DDT);\r\nUcpHandleTime(hf_ucp_parm_VP);\r\nUcpHandleString(hf_ucp_parm_RPID);\r\nUcpHandleTime(hf_ucp_parm_SCTS);\r\nUcpHandleByte(hf_ucp_parm_Dst);\r\nUcpHandleInt(hf_ucp_parm_Rsn);\r\nUcpHandleTime(hf_ucp_parm_DSCTS);\r\nintval = UcpHandleByte(hf_ucp_parm_MT);\r\nUcpHandleString(hf_ucp_parm_NB);\r\nif (intval != '3')\r\nUcpHandleData(hf_ucp_data_section);\r\nelse\r\nUcpHandleIRAString(hf_ucp_parm_AMsg);\r\nUcpHandleByte(hf_ucp_parm_MMS);\r\nUcpHandleByte(hf_ucp_parm_PR);\r\nUcpHandleByte(hf_ucp_parm_DCs);\r\nUcpHandleByte(hf_ucp_parm_MCLs);\r\nUcpHandleByte(hf_ucp_parm_RPI);\r\nif (tvb_get_guint8(tvb, offset++) != '/') {\r\nproto_tree_add_string(tree, hf_ucp_parm_CPg, tvb, offset - 1,1,\r\n"(reserved for Code Page)");\r\noffset++;\r\n}\r\nif (tvb_get_guint8(tvb, offset++) != '/') {\r\nproto_tree_add_string(tree, hf_ucp_parm_RPLy, tvb, offset - 1,1,\r\n"(reserved for Reply type)");\r\noffset++;\r\n}\r\nUcpHandleString(hf_ucp_parm_OTOA);\r\nUcpHandleString(hf_ucp_parm_HPLMN);\r\ntmpoff = offset;\r\nwhile (tvb_get_guint8(tvb, tmpoff++) != '/')\r\n;\r\nif ((tmpoff - offset) > 1) {\r\nint len = tmpoff - offset - 1;\r\nproto_tree *subtree;\r\nti = proto_tree_add_item(tree, hf_ucp_parm_XSer, tvb, offset, len, ENC_NA);\r\ntmptvb = tvb_new_subset_length(tvb, offset, len + 1);\r\nsubtree = proto_item_add_subtree(ti, ett_XSer);\r\nucp_handle_XSer(subtree, tmptvb);\r\n}\r\noffset = tmpoff;\r\nUcpHandleDataString(hf_ucp_parm_RES4);\r\nUcpHandleDataString(hf_ucp_parm_RES5);\r\n}\r\nstatic void\r\nadd_6xO(proto_tree *tree, tvbuff_t *tvb, guint8 OT)\r\n{\r\nint offset = 1;\r\nUcpHandleString(hf_ucp_parm_OAdC);\r\nUcpHandleByte(hf_ucp_parm_OTON);\r\nUcpHandleByte(hf_ucp_parm_ONPI);\r\nif (OT == 60) {\r\nUcpHandleByte(hf_ucp_parm_STYP0);\r\n} else {\r\nUcpHandleByte(hf_ucp_parm_STYP1);\r\n}\r\nUcpHandleIRAString(hf_ucp_parm_PWD);\r\nUcpHandleIRAString(hf_ucp_parm_NPWD);\r\nUcpHandleString(hf_ucp_parm_VERS);\r\nUcpHandleString(hf_ucp_parm_LAdC);\r\nUcpHandleByte(hf_ucp_parm_LTON);\r\nUcpHandleByte(hf_ucp_parm_LNPI);\r\nif (OT == 60) {\r\nUcpHandleInt(hf_ucp_parm_OPID);\r\n}\r\nUcpHandleDataString(hf_ucp_parm_RES1);\r\nif (OT == 61) {\r\nUcpHandleDataString(hf_ucp_parm_RES2);\r\n}\r\n}\r\nstatic guint\r\nget_ucp_pdu_len(packet_info *pinfo _U_, tvbuff_t *tvb, int offset, void *data _U_)\r\n{\r\nguint intval=0;\r\nint i;\r\noffset = offset + 4;\r\nfor (i = 0; i < UCP_LEN_LEN; i++) {\r\nintval = 10 * intval +\r\n(tvb_get_guint8(tvb, offset) - '0');\r\noffset++;\r\n}\r\nreturn intval + 2;\r\n}\r\nstatic int\r\ndissect_ucp_common(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\nguint8 O_R;\r\nguint8 OT;\r\nguint intval;\r\nint i;\r\nint result;\r\nint endpkt;\r\nucp_tap_rec_t *tap_rec;\r\nproto_item *ti;\r\nproto_item *sub_ti;\r\nproto_tree *ucp_tree;\r\nproto_tree *sub_tree;\r\ntvbuff_t *tmp_tvb;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "UCP");\r\ncol_clear(pinfo->cinfo, COL_INFO);\r\nif (tvb_get_guint8(tvb, 0) != UCP_STX){\r\nproto_tree_add_expert(tree, pinfo, &ei_ucp_stx_missing, tvb, 0, -1);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nresult = check_ucp(tvb, &endpkt);\r\nO_R = tvb_get_guint8(tvb, UCP_O_R_OFFSET);\r\nOT = tvb_get_guint8(tvb, UCP_OT_OFFSET) - '0';\r\nOT = 10 * OT + (tvb_get_guint8(tvb, UCP_OT_OFFSET + 1) - '0');\r\ntap_rec = wmem_new0(wmem_packet_scope(), ucp_tap_rec_t);\r\ntap_rec->message_type = (O_R == 'O' ? 0 : 1);\r\ntap_rec->operation = OT;\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s (%s)",\r\nval_to_str_ext_const(OT, &vals_hdr_OT_ext, "unknown operation"),\r\nval_to_str(O_R, vals_hdr_O_R, "Unknown (%d)"));\r\nif (result == UCP_INV_CHK)\r\ncol_append_str(pinfo->cinfo, COL_INFO, " [checksum invalid]");\r\nif (tree) {\r\nti = proto_tree_add_item(tree, proto_ucp, tvb, 0, -1, ENC_NA);\r\nucp_tree = proto_item_add_subtree(ti, ett_ucp);\r\noffset++;\r\nintval = tvb_get_guint8(tvb, offset+0) - '0';\r\nintval = 10 * intval + (tvb_get_guint8(tvb, offset+1) - '0');\r\nproto_tree_add_uint(ucp_tree, hf_ucp_hdr_TRN, tvb, offset,\r\nUCP_TRN_LEN, intval);\r\noffset += UCP_TRN_LEN + 1;\r\nintval = 0;\r\nfor (i = 0; i < UCP_LEN_LEN; i++) {\r\nintval = 10 * intval +\r\n(tvb_get_guint8(tvb, offset+i) - '0');\r\n}\r\nproto_tree_add_uint(ucp_tree, hf_ucp_hdr_LEN, tvb, offset,\r\nUCP_LEN_LEN, intval);\r\noffset += UCP_LEN_LEN + 1;\r\nproto_tree_add_uint(ucp_tree, hf_ucp_hdr_O_R, tvb, offset,\r\nUCP_O_R_LEN, O_R);\r\noffset += UCP_O_R_LEN + 1;\r\nproto_tree_add_uint(ucp_tree, hf_ucp_hdr_OT, tvb, offset,\r\nUCP_OT_LEN, OT);\r\noffset += UCP_OT_LEN;\r\ntmp_tvb = tvb_new_subset_remaining(tvb, offset);\r\nsub_ti = proto_tree_add_item(ucp_tree, hf_ucp_oper_section, tvb,\r\noffset, endpkt - offset, ENC_NA);\r\nsub_tree = proto_item_add_subtree(sub_ti, ett_sub);\r\nswitch (OT) {\r\ncase 0:\r\nO_R == 'O' ? add_00O(sub_tree,tmp_tvb) : add_00R(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ncase 1:\r\nO_R == 'O' ? add_01O(sub_tree,tmp_tvb) : add_01R(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ncase 2:\r\nO_R == 'O' ? add_02O(sub_tree,tmp_tvb) : add_02R(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ncase 3:\r\nO_R == 'O' ? add_03O(sub_tree,tmp_tvb) : add_03R(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ncase 4:\r\nO_R == 'O' ? add_04O(sub_tree,tmp_tvb) : add_04R(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ncase 5:\r\nO_R == 'O' ? add_05O(sub_tree,tmp_tvb) : add_05R(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ncase 6:\r\nO_R == 'O' ? add_06O(sub_tree,tmp_tvb) : add_06R(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ncase 7:\r\nO_R == 'O' ? add_07O(sub_tree,tmp_tvb) : add_07R(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ncase 8:\r\nO_R == 'O' ? add_08O(sub_tree,tmp_tvb) : add_08R(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ncase 9:\r\nO_R == 'O' ? add_09O(sub_tree,tmp_tvb) : add_09R(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ncase 10:\r\nO_R == 'O' ? add_10O(sub_tree,tmp_tvb) : add_10R(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ncase 11:\r\nO_R == 'O' ? add_11O(sub_tree,tmp_tvb) : add_11R(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ncase 12:\r\nO_R == 'O' ? add_12O(sub_tree,tmp_tvb) : add_12R(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ncase 13:\r\nO_R == 'O' ? add_13O(sub_tree,tmp_tvb) : add_13R(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ncase 14:\r\nO_R == 'O' ? add_14O(sub_tree,tmp_tvb) : add_14R(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ncase 15:\r\nO_R == 'O' ? add_15O(sub_tree,tmp_tvb) : add_15R(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ncase 16:\r\nO_R == 'O' ? add_16O(sub_tree,tmp_tvb) : add_16R(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ncase 17:\r\nO_R == 'O' ? add_17O(sub_tree,tmp_tvb) : add_17R(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ncase 18:\r\nO_R == 'O' ? add_18O(sub_tree,tmp_tvb) : add_18R(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ncase 19:\r\nO_R == 'O' ? add_19O(sub_tree,tmp_tvb) : add_19R(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ncase 20:\r\nO_R == 'O' ? add_20O(sub_tree,tmp_tvb) : add_20R(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ncase 21:\r\nO_R == 'O' ? add_21O(sub_tree,tmp_tvb) : add_21R(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ncase 22:\r\nO_R == 'O' ? add_22O(sub_tree,tmp_tvb) : add_22R(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ncase 23:\r\nO_R == 'O' ? add_23O(sub_tree,tmp_tvb) : add_23R(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ncase 24:\r\nO_R == 'O' ? add_24O(sub_tree,tmp_tvb) : add_24R(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ncase 30:\r\nO_R == 'O' ? add_30O(sub_tree,tmp_tvb) : add_30R(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ncase 31:\r\nO_R == 'O' ? add_31O(sub_tree,tmp_tvb) : add_31R(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ncase 51: case 52: case 53: case 54: case 55: case 56: case 57:\r\ncase 58:\r\nO_R == 'O' ? add_5xO(sub_tree,tmp_tvb) : add_5xR(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ncase 60: case 61:\r\nO_R == 'O' ? add_6xO(sub_tree,tmp_tvb,OT) : add_6xR(sub_tree,tmp_tvb, tap_rec);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\ntap_queue_packet(ucp_tap, pinfo, tap_rec);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic int\r\ndissect_ucp_tcp(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data)\r\n{\r\ntcp_dissect_pdus(tvb, pinfo, tree, ucp_desegment, UCP_HEADER_SIZE,\r\nget_ucp_pdu_len, dissect_ucp_common, data);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic gboolean\r\ndissect_ucp_heur(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data)\r\n{\r\nconversation_t *conversation;\r\nif (tvb_captured_length(tvb) < UCP_HEADER_SIZE)\r\nreturn FALSE;\r\nif ((tvb_get_guint8(tvb, 0) != UCP_STX) ||\r\n(tvb_get_guint8(tvb, UCP_TRN_OFFSET + UCP_TRN_LEN) != '/') ||\r\n(tvb_get_guint8(tvb, UCP_LEN_OFFSET + UCP_LEN_LEN) != '/') ||\r\n(tvb_get_guint8(tvb, UCP_O_R_OFFSET + UCP_O_R_LEN) != '/') ||\r\n(tvb_get_guint8(tvb, UCP_OT_OFFSET + UCP_OT_LEN) != '/'))\r\nreturn FALSE;\r\nif (try_val_to_str(tvb_get_guint8(tvb, UCP_O_R_OFFSET), vals_hdr_O_R) == NULL)\r\nreturn FALSE;\r\nconversation = find_or_create_conversation(pinfo);\r\nconversation_set_dissector(conversation, ucp_handle);\r\ndissect_ucp_tcp(tvb, pinfo, tree, data);\r\nreturn TRUE;\r\n}\r\nvoid\r\nproto_register_ucp(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_ucp_hdr_TRN,\r\n{ "Transaction Reference Number", "ucp.hdr.TRN",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\n"Transaction number for this command, used in windowing.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_hdr_LEN,\r\n{ "Length", "ucp.hdr.LEN",\r\nFT_UINT16, BASE_DEC, NULL, 0x00,\r\n"Total number of characters between <stx>...<etx>.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_hdr_O_R,\r\n{ "Type", "ucp.hdr.O_R",\r\nFT_UINT8, BASE_DEC, VALS(vals_hdr_O_R), 0x00,\r\n"Your basic 'is a request or response'.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_hdr_OT,\r\n{ "Operation", "ucp.hdr.OT",\r\nFT_UINT8, BASE_DEC | BASE_EXT_STRING, &vals_hdr_OT_ext, 0x00,\r\n"The operation that is requested with this message.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_oper_section,\r\n{ "Data", "ucp.parm",\r\nFT_NONE, BASE_NONE, NULL, 0x00,\r\n"The actual content of the operation.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_AdC,\r\n{ "AdC", "ucp.parm.AdC",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Address code recipient.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_OAdC,\r\n{ "OAdC", "ucp.parm.OAdC",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Address code originator.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_DAdC,\r\n{ "DAdC", "ucp.parm.DAdC",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Diverted address code.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_AC,\r\n{ "AC", "ucp.parm.AC",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Authentication code.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_OAC,\r\n{ "OAC", "ucp.parm.OAC",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Authentication code, originator.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_NAC,\r\n{ "NAC", "ucp.parm.NAC",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"New authentication code.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_BAS,\r\n{ "BAS", "ucp.parm.BAS",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_BAS), 0x00,\r\n"Barring status flag.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_LAR,\r\n{ "LAR", "ucp.parm.LAR",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_LAR), 0x00,\r\n"Leg. code for all calls flag.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_LAC,\r\n{ "LAC", "ucp.parm.LAC",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"New leg. code for all calls.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_L1R,\r\n{ "L1R", "ucp.parm.L1R",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_L1R), 0x00,\r\n"Leg. code for priority 1 flag.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_L1P,\r\n{ "L1P", "ucp.parm.L1P",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"New leg. code for level 1 priority.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_L3R,\r\n{ "L3R", "ucp.parm.L3R",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_L3R), 0x00,\r\n"Leg. code for priority 3 flag.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_L3P,\r\n{ "L3P", "ucp.parm.L3P",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"New leg. code for level 3 priority.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_LCR,\r\n{ "LCR", "ucp.parm.LCR",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_LCR), 0x00,\r\n"Leg. code for reverse charging flag.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_LUR,\r\n{ "LUR", "ucp.parm.LUR",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_LUR), 0x00,\r\n"Leg. code for urgent message flag.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_LRR,\r\n{ "LRR", "ucp.parm.LRR",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_LRR), 0x00,\r\n"Leg. code for repetition flag.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_RT,\r\n{ "RT", "ucp.parm.RT",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_RT), 0x00,\r\n"Receiver type.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_NoN,\r\n{ "NoN", "ucp.parm.NoN",\r\nFT_UINT16, BASE_DEC, NULL, 0x00,\r\n"Maximum number of numerical characters accepted.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_NoA,\r\n{ "NoA", "ucp.parm.NoA",\r\nFT_UINT16, BASE_DEC, NULL, 0x00,\r\n"Maximum number of alphanumerical characters accepted.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_NoB,\r\n{ "NoB", "ucp.parm.NoB",\r\nFT_UINT16, BASE_DEC, NULL, 0x00,\r\n"Maximum number of data bits accepted.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_PNC,\r\n{ "PNC", "ucp.parm.PNC",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_PNC), 0x00,\r\n"Paging network controller.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_AMsg,\r\n{ "AMsg", "ucp.parm.AMsg",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"The alphanumeric message that is being sent.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_LNo,\r\n{ "LNo", "ucp.parm.LNo",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Standard text list number requested by calling party.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_LST,\r\n{ "LST", "ucp.parm.LST",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Legitimisation code for standard text.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_TNo,\r\n{ "TNo", "ucp.parm.TNo",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Standard text number requested by calling party.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_CS,\r\n{ "CS", "ucp.parm.CS",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\n"Additional character set number.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_PID,\r\n{ "PID", "ucp.parm.PID",\r\nFT_UINT16, BASE_DEC, VALS(vals_parm_PID), 0x00,\r\n"SMT PID value.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_NPL,\r\n{ "NPL", "ucp.parm.NPL",\r\nFT_UINT16, BASE_DEC, NULL, 0x00,\r\n"Number of parameters in the following list.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_GA,\r\n{ "GA", "ucp.parm.GA",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"GA?? haven't got a clue.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_RP,\r\n{ "RP", "ucp.parm.RP",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_RP), 0x00,\r\n"Repetition requested.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_LRP,\r\n{ "LRP", "ucp.parm.LRP",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Legitimisation code for repetition.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_PR,\r\n{ "PR", "ucp.parm.PR",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\n"Priority requested.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_LPR,\r\n{ "LPR", "ucp.parm.LPR",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Legitimisation code for priority requested.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_UM,\r\n{ "UM", "ucp.parm.UM",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_UM), 0x00,\r\n"Urgent message indicator.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_LUM,\r\n{ "LUM", "ucp.parm.LUM",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Legitimisation code for urgent message.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_RC,\r\n{ "RC", "ucp.parm.RC",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_RC), 0x00,\r\n"Reverse charging request.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_LRC,\r\n{ "LRC", "ucp.parm.LRC",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Legitimisation code for reverse charging.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_NRq,\r\n{ "NRq", "ucp.parm.NRq",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_NRq), 0x00,\r\n"Notification request.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_GAdC,\r\n{ "GAdC", "ucp.parm.GAdC",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Group address code.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_A_D,\r\n{ "A_D", "ucp.parm.A_D",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_A_D), 0x00,\r\n"Add to/delete from fixed subscriber address list record.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_CT,\r\n{ "CT", "ucp.parm.CT",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_LOCAL, NULL, 0x00,\r\n"Accumulated charges timestamp.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_AAC,\r\n{ "AAC", "ucp.parm.AAC",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Accumulated charges.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_MNo,\r\n{ "MNo", "ucp.parm.MNo",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Message number.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_R_T,\r\n{ "R_T", "ucp.parm.R_T",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_R_T), 0x00,\r\n"Message number.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_NAdC,\r\n{ "NAdC", "ucp.parm.NAdC",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Notification address.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_NT,\r\n{ "NT", "ucp.parm.NT",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_NT), 0x00,\r\n"Notification type.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_IVR5x,\r\n{ "IVR5x", "ucp.parm.IVR5x",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"UCP release number supported/accepted.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_REQ_OT,\r\n{ "REQ_OT", "ucp.parm.REQ_OT",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_REQ_OT), 0x00,\r\n"UCP release number supported/accepted.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_SSTAT,\r\n{ "SSTAT", "ucp.parm.SSTAT",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_SSTAT), 0x00,\r\n"Supplementary services for which status is requested.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_LMN,\r\n{ "LMN", "ucp.parm.LMN",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\n"Last message number.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_NMESS,\r\n{ "NMESS", "ucp.parm.NMESS",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\n"Number of stored messages.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_NPID,\r\n{ "NPID", "ucp.parm.NPID",\r\nFT_UINT16, BASE_DEC, VALS(vals_parm_PID), 0x00,\r\n"Notification PID value.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_LRq,\r\n{ "LRq", "ucp.parm.LRq",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_LRq), 0x00,\r\n"Last resort address request.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_LRAd,\r\n{ "LRAd", "ucp.parm.LRAd",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Last resort address.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_LPID,\r\n{ "LPID", "ucp.parm.LPID",\r\nFT_UINT16, BASE_DEC, VALS(vals_parm_PID), 0x00,\r\n"Last resort PID value.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_DD,\r\n{ "DD", "ucp.parm.DD",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_DD), 0x00,\r\n"Deferred delivery requested.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_DDT,\r\n{ "DDT", "ucp.parm.DDT",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_LOCAL, NULL, 0x00,\r\n"Deferred delivery time.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_STx,\r\n{ "STx", "ucp.parm.STx",\r\nFT_NONE, BASE_NONE, NULL, 0x00,\r\n"Standard text.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_ST,\r\n{ "ST", "ucp.parm.ST",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_LOCAL, NULL, 0x00,\r\n"Start time.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_SP,\r\n{ "SP", "ucp.parm.SP",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_LOCAL, NULL, 0x00,\r\n"Stop time.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_VP,\r\n{ "VP", "ucp.parm.VP",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_LOCAL, NULL, 0x00,\r\n"Validity period.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_RPID,\r\n{ "RPID", "ucp.parm.RPID",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Replace PID",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_SCTS,\r\n{ "SCTS", "ucp.parm.SCTS",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_LOCAL, NULL, 0x00,\r\n"Service Centre timestamp.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_Dst,\r\n{ "Dst", "ucp.parm.Dst",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_Dst), 0x00,\r\n"Delivery status.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_Rsn,\r\n{ "Rsn", "ucp.parm.Rsn",\r\nFT_UINT16, BASE_DEC | BASE_EXT_STRING, &vals_parm_Rsn_ext, 0x00,\r\n"Reason code.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_DSCTS,\r\n{ "DSCTS", "ucp.parm.DSCTS",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_LOCAL, NULL, 0x00,\r\n"Delivery timestamp.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_MT,\r\n{ "MT", "ucp.parm.MT",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_MT), 0x00,\r\n"Message type.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_NB,\r\n{ "NB", "ucp.parm.NB",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"No. of bits in Transparent Data (TD) message.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_data_section,\r\n{ "Data", "ucp.message",\r\nFT_NONE, BASE_NONE, NULL, 0x00,\r\n"The actual message or data.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_MMS,\r\n{ "MMS", "ucp.parm.MMS",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\n"More messages to send.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_DCs,\r\n{ "DCs", "ucp.parm.DCs",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_DCs), 0x00,\r\n"Data coding scheme (deprecated).",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_MCLs,\r\n{ "MCLs", "ucp.parm.MCLs",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_MCLs), 0x00,\r\n"Message class.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_RPI,\r\n{ "RPI", "ucp.parm.RPI",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_RPI), 0x00,\r\n"Reply path.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_CPg,\r\n{ "CPg", "ucp.parm.CPg",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Reserved for Code Page.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_RPLy,\r\n{ "RPLy", "ucp.parm.RPLy",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Reserved for Reply type.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_OTOA,\r\n{ "OTOA", "ucp.parm.OTOA",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Originator Type Of Address.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_HPLMN,\r\n{ "HPLMN", "ucp.parm.HPLMN",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Home PLMN address.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_XSer,\r\n{ "Extra services:", "ucp.parm.XSer",\r\nFT_NONE, BASE_NONE, NULL, 0x00,\r\n"Extra services.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_RES4,\r\n{ "RES4", "ucp.parm.RES4",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Reserved for future use.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_RES5,\r\n{ "RES5", "ucp.parm.RES5",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Reserved for future use.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_OTON,\r\n{ "OTON", "ucp.parm.OTON",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_OTON), 0x00,\r\n"Originator type of number.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_ONPI,\r\n{ "ONPI", "ucp.parm.ONPI",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_ONPI), 0x00,\r\n"Originator numbering plan id.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_STYP0,\r\n{ "STYP0", "ucp.parm.STYP0",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_STYP0), 0x00,\r\n"Subtype of operation.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_STYP1,\r\n{ "STYP1", "ucp.parm.STYP1",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_STYP1), 0x00,\r\n"Subtype of operation.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_PWD,\r\n{ "PWD", "ucp.parm.PWD",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Current password.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_NPWD,\r\n{ "NPWD", "ucp.parm.NPWD",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"New password.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_VERS,\r\n{ "VERS", "ucp.parm.VERS",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Version number.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_LAdC,\r\n{ "LAdC", "ucp.parm.LAdC",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Address for VSMSC list operation.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_LTON,\r\n{ "LTON", "ucp.parm.LTON",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\n"Type of number list address.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_LNPI,\r\n{ "LNPI", "ucp.parm.LNPI",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\n"Numbering plan id. list address.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_OPID,\r\n{ "OPID", "ucp.parm.OPID",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_OPID), 0x00,\r\n"Originator protocol identifier.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_RES1,\r\n{ "RES1", "ucp.parm.RES1",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Reserved for future use.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_RES2,\r\n{ "RES2", "ucp.parm.RES2",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"Reserved for future use.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_ACK,\r\n{ "(N)Ack", "ucp.parm.ACK",\r\nFT_UINT8, BASE_DEC, VALS(vals_parm_ACK), 0x00,\r\n"Positive or negative acknowledge of the operation.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_MVP,\r\n{ "MVP", "ucp.parm.MVP",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_LOCAL, NULL, 0x00,\r\n"Modified validity period.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_EC,\r\n{ "Error code", "ucp.parm.EC",\r\nFT_UINT8, BASE_DEC | BASE_EXT_STRING, &vals_parm_EC_ext, 0x00,\r\n"The result of the requested operation.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_parm_SM,\r\n{ "SM", "ucp.parm.SM",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\n"System message.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_ga_roaming,\r\n{ "GA roaming definitions", "ucp.parm.ga_roaming",\r\nFT_NONE, BASE_NONE, NULL, 0x00,\r\nNULL,\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_call_barring,\r\n{ "Call barring definitions", "ucp.parm.call_barring",\r\nFT_NONE, BASE_NONE, NULL, 0x00,\r\nNULL,\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_deferred_delivery,\r\n{ "Deferred delivery definitions", "ucp.parm.deferred_delivery",\r\nFT_NONE, BASE_NONE, NULL, 0x00,\r\nNULL,\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_diversion,\r\n{ "Diversion definitions", "ucp.parm.diversion",\r\nFT_NONE, BASE_NONE, NULL, 0x00,\r\nNULL,\r\nHFILL\r\n}\r\n},\r\n{ &hf_ucp_not_subscribed,\r\n{ "Not subscribed/not allowed", "ucp.parm.not_subscribed",\r\nFT_NONE, BASE_NONE, NULL, 0x00,\r\nNULL,\r\nHFILL\r\n}\r\n},\r\n{ &hf_xser_service,\r\n{ "Type of service", "ucp.xser.service",\r\nFT_UINT8, BASE_HEX | BASE_EXT_STRING, &vals_xser_service_ext, 0x00,\r\n"The type of service specified.",\r\nHFILL\r\n}\r\n},\r\n{ &hf_xser_length,\r\n{ "Length", "ucp.xser.length",\r\nFT_UINT16, BASE_DEC, NULL, 0x00,\r\nNULL,\r\nHFILL\r\n}\r\n},\r\n{ &hf_xser_data,\r\n{ "Data", "ucp.xser.data",\r\nFT_STRING, BASE_NONE, NULL, 0x00,\r\nNULL,\r\nHFILL\r\n}\r\n},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_ucp,\r\n&ett_sub,\r\n&ett_XSer\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_ucp_stx_missing, { "ucp.stx_missing", PI_MALFORMED, PI_ERROR, "UCP_STX missing, this is not a new packet", EXPFILL }},\r\n};\r\nmodule_t *ucp_module;\r\nexpert_module_t* expert_ucp;\r\nproto_ucp = proto_register_protocol("Universal Computer Protocol",\r\n"UCP", "ucp");\r\nproto_register_field_array(proto_ucp, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_ucp = expert_register_protocol(proto_ucp);\r\nexpert_register_field_array(expert_ucp, ei, array_length(ei));\r\nucp_tap = register_tap("ucp");\r\nucp_module = prefs_register_protocol(proto_ucp, NULL);\r\nprefs_register_bool_preference(ucp_module, "desegment_ucp_messages",\r\n"Reassemble UCP messages spanning multiple TCP segments",\r\n"Whether the UCP dissector should reassemble messages spanning"\r\n" multiple TCP segments."\r\n" To use this option, you must also enable "\r\n"\"Allow subdissectors to reassemble TCP streams\" in the "\r\n"TCP protocol settings.",\r\n&ucp_desegment);\r\n}\r\nvoid\r\nproto_reg_handoff_ucp(void)\r\n{\r\nheur_dissector_add("tcp", dissect_ucp_heur, "UCP over TCP", "ucp_tcp", proto_ucp, HEURISTIC_ENABLE);\r\nucp_handle = create_dissector_handle(dissect_ucp_tcp, proto_ucp);\r\ndissector_add_for_decode_as("tcp.port", ucp_handle);\r\nstats_tree_register_with_group("ucp", "ucp_messages", "_UCP Messages", 0,\r\nucp_stats_tree_per_packet, ucp_stats_tree_init,\r\nNULL, REGISTER_STAT_GROUP_TELEPHONY);\r\n}
