static int dissect_wimax_cdma_code_decoder(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\ngint offset = 0;\r\nproto_item *cdma_item;\r\nproto_tree *cdma_tree;\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, NULL, "CDMA Code Attribute");\r\nif (tree)\r\n{\r\ncdma_item = proto_tree_add_item(tree, proto_wimax_cdma_code_decoder, tvb, offset, -1, ENC_NA);\r\ncdma_tree = proto_item_add_subtree(cdma_item, ett_wimax_cdma_code_decoder);\r\nproto_tree_add_item(cdma_tree, hf_wimax_ranging_code, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cdma_tree, hf_wimax_ranging_symbol_offset, tvb, offset+1, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cdma_tree, hf_wimax_ranging_subchannel_offset, tvb, offset+2, 1, ENC_BIG_ENDIAN);\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid proto_register_wimax_cdma(void)\r\n{\r\nstatic hf_register_info hf[] =\r\n{\r\n{\r\n&hf_wimax_ranging_code,\r\n{\r\n"Ranging Code", "wmx.cdma.ranging_code",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_wimax_ranging_symbol_offset,\r\n{\r\n"Ranging Symbol Offset", "wmx.cdma.ranging_symbol_offset",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_wimax_ranging_subchannel_offset,\r\n{\r\n"Ranging Sub-Channel Offset", "wmx.cdma.ranging_subchannel_offset",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL\r\n}\r\n}\r\n};\r\nstatic gint *ett[] =\r\n{\r\n&ett_wimax_cdma_code_decoder,\r\n};\r\nproto_wimax_cdma_code_decoder = proto_register_protocol (\r\n"WiMax CDMA Code Attribute",\r\n"CDMA Code Attribute",\r\n"wmx.cdma"\r\n);\r\nproto_register_field_array(proto_wimax_cdma_code_decoder, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nregister_dissector("wimax_cdma_code_burst_handler", dissect_wimax_cdma_code_decoder, -1);\r\n}
