static gint\r\ntn5250_is_valid_aid(gint aid)\r\n{\r\nswitch (aid) {\r\ncase AID_CLEAR:\r\ncase AID_ENTER_OR_RECORD_ADV:\r\ncase AID_HELP:\r\ncase AID_ROLL_DOWN:\r\ncase AID_ROLL_UP:\r\ncase AID_ROLL_LEFT:\r\ncase AID_ROLL_RIGHT:\r\ncase AID_PRINT:\r\ncase AID_RECORD_BACKSPACE:\r\ncase AID_SLP_AUTO_ENTER:\r\ncase AID_FORWARD_EDGE_TRIGGER_AUTO__ENTER:\r\ncase AID_PA1:\r\ncase AID_PA2:\r\ncase AID_PA3:\r\ncase AID_CMD_01:\r\ncase AID_CMD_02:\r\ncase AID_CMD_03:\r\ncase AID_CMD_04:\r\ncase AID_CMD_05:\r\ncase AID_CMD_06:\r\ncase AID_CMD_07:\r\ncase AID_CMD_08:\r\ncase AID_CMD_09:\r\ncase AID_CMD_10:\r\ncase AID_CMD_11:\r\ncase AID_CMD_12:\r\ncase AID_CMD_13:\r\ncase AID_CMD_14:\r\ncase AID_CMD_15:\r\ncase AID_CMD_16:\r\ncase AID_CMD_17:\r\ncase AID_CMD_18:\r\ncase AID_CMD_19:\r\ncase AID_CMD_20:\r\ncase AID_CMD_21:\r\ncase AID_CMD_22:\r\ncase AID_CMD_23:\r\ncase AID_CMD_24:\r\ncase AID_INBOUND_WRITE_STRUCTURED_FIELD:\r\ncase AID_PASS_THROUGH_RESPONSE:\r\nreturn 1;\r\ndefault:\r\nbreak;\r\n}\r\nreturn 0;\r\n}\r\nstatic guint32\r\ntn5250_add_hf_items(proto_tree *tn5250_tree, tvbuff_t *tvb, gint offset,\r\nconst hf_items *fields)\r\n{\r\nint start=offset, byte;\r\nint i;\r\nfor (i = 0; fields[i].phf; ++i) {\r\nif (fields[i].bitmask == 0) {\r\nbyte = tvb_get_guint8(tvb,offset);\r\nif (byte == 0xFF) {\r\noffset++;\r\n}\r\nproto_tree_add_item(tn5250_tree, *fields[i].phf, tvb, offset,\r\nfields[i].length, fields[i].encoding);\r\n} else {\r\nproto_tree_add_bitmask(tn5250_tree, tvb, offset, *fields[i].phf,\r\nfields[i].bitmask_ett, fields[i].bitmask, ENC_BIG_ENDIAN);\r\n}\r\nDISSECTOR_ASSERT(fields[i].length > 0);\r\noffset+=fields[i].length;\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic guint32\r\ndissect_unknown_data(proto_tree *tn5250_tree, tvbuff_t *tvb, gint offset,\r\ngint start, gint sf_length)\r\n{\r\nint len_left;\r\nlen_left = sf_length - (offset - start);\r\nif (len_left > 0) {\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_unknown_data, tvb, offset,\r\nlen_left, ENC_NA);\r\nreturn len_left;\r\n}\r\nreturn 0;\r\n}\r\nstatic guint32\r\ndissect_wcc(proto_tree *tn5250_tree, tvbuff_t *tvb, gint offset)\r\n{\r\nstatic const int *wcc_byte[] = {\r\n&hf_tn5250_wtd_ccc2_res,\r\n&hf_tn5250_wtd_ccc2_cursor,\r\n&hf_tn5250_wtd_ccc2_reset,\r\n&hf_tn5250_wtd_ccc2_set,\r\n&hf_tn5250_wtd_ccc2_unlock,\r\n&hf_tn5250_wtd_ccc2_alarm,\r\n&hf_tn5250_wtd_ccc2_off,\r\n&hf_tn5250_wtd_ccc2_on,\r\nNULL\r\n};\r\nhf_items wcc_fields[] = {\r\n{ &hf_tn5250_wtd_ccc1, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wtd_ccc2, ett_tn5250_wcc, 1, wcc_byte, 0 },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\ntn5250_add_hf_items(tn5250_tree, tvb, offset, wcc_fields);\r\nreturn 2;\r\n}\r\nstatic guint32\r\ndissect_row_column(proto_tree *tn5250_tree, tvbuff_t *tvb, gint offset)\r\n{\r\nint start = offset;\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_buffer_x, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_buffer_y, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn (offset - start);\r\n}\r\nstatic guint32\r\ndissect_erase_to_address(proto_tree *tn5250_tree, tvbuff_t *tvb, gint offset)\r\n{\r\nint start = offset;\r\nint i, length = 0;\r\ndissect_row_column(tn5250_tree, tvb, offset);\r\nlength = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nfor (i=1; i < length; i++) {\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_attribute_type, tvb, offset, 1,\r\nENC_BIG_ENDIAN);\r\noffset++;\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic guint32\r\ndissect_start_of_header(proto_tree *tn5250_tree, tvbuff_t *tvb, gint offset)\r\n{\r\nint start = offset;\r\nstatic const int *byte[] = {\r\n&hf_tn5250_soh_cursor_direction,\r\n&hf_tn5250_soh_screen_reverse,\r\n&hf_tn5250_soh_input_capable_only,\r\nNULL\r\n};\r\nstatic const int *byte1[] = {\r\n&hf_tn5250_soh_pf24, &hf_tn5250_soh_pf23, &hf_tn5250_soh_pf22,\r\n&hf_tn5250_soh_pf21, &hf_tn5250_soh_pf20, &hf_tn5250_soh_pf19,\r\n&hf_tn5250_soh_pf18, &hf_tn5250_soh_pf17,\r\nNULL\r\n};\r\nstatic const int *byte2[] = {\r\n&hf_tn5250_soh_pf16, &hf_tn5250_soh_pf15, &hf_tn5250_soh_pf14,\r\n&hf_tn5250_soh_pf13, &hf_tn5250_soh_pf12, &hf_tn5250_soh_pf11,\r\n&hf_tn5250_soh_pf10, &hf_tn5250_soh_pf9,\r\nNULL\r\n};\r\nstatic const int *byte3[] = {\r\n&hf_tn5250_soh_pf8, &hf_tn5250_soh_pf7, &hf_tn5250_soh_pf6,\r\n&hf_tn5250_soh_pf5, &hf_tn5250_soh_pf4, &hf_tn5250_soh_pf3,\r\n&hf_tn5250_soh_pf2, &hf_tn5250_soh_pf1,\r\nNULL\r\n};\r\nhf_items start_of_header_fields[] = {\r\n{ &hf_tn5250_soh_length, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_soh_flags, ett_tn5250_soh_mask, 1, byte, 0 },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_soh_resq, 1, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_soh_err, 1, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_soh_pf24to17, ett_tn5250_soh_pf24to17_mask, 1, byte1, 0 },\r\n{ &hf_tn5250_soh_pf16to9, ett_tn5250_soh_pf16to9_mask, 1, byte2, 0 },\r\n{ &hf_tn5250_soh_pf8to1, ett_tn5250_soh_pf8to1_mask, 1, byte3, 0 },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset,\r\nstart_of_header_fields);\r\nreturn (offset - start);\r\n}\r\nstatic guint32\r\ndissect_twobyte_length_and_data(proto_tree *tn5250_tree, tvbuff_t *tvb, gint offset)\r\n{\r\nint start = offset;\r\nint length = 0;\r\nlength = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_length_twobyte, tvb, offset, 2,\r\nENC_BIG_ENDIAN);\r\noffset+=2;\r\nif (tvb_reported_length_remaining(tvb, offset) >= length) {\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_field_data, tvb, offset,\r\nlength, ENC_EBCDIC|ENC_NA);\r\noffset+=length;\r\n} else {\r\noffset += dissect_unknown_data(tn5250_tree, tvb, offset, start, length);\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic guint32\r\ndissect_field_attribute_pair(proto_tree *tn5250_tree, tvbuff_t *tvb, gint offset)\r\n{\r\nint start = offset;\r\nint attribute_type;\r\nstatic const int *byte[] = {\r\n&hf_tn5250_wea_prim_attr_flag, &hf_tn5250_wea_prim_attr_col,\r\n&hf_tn5250_wea_prim_attr_blink, &hf_tn5250_wea_prim_attr_und,\r\n&hf_tn5250_wea_prim_attr_int, &hf_tn5250_wea_prim_attr_rev,\r\nNULL\r\n};\r\nattribute_type = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_attribute_type, tvb, offset, 1,\r\nENC_BIG_ENDIAN);\r\noffset++;\r\nswitch (attribute_type) {\r\ncase EXTENDED_PRIMARY_ATTRIBUTES:\r\nproto_tree_add_bitmask(tn5250_tree, tvb, offset, hf_tn5250_wea_prim_attr,\r\nett_tn5250_wea_prim_attr, byte, ENC_BIG_ENDIAN);\r\noffset++;\r\nbreak;\r\ncase EXTENDED_FOREGROUND_COLOR_ATTRIBUTES:\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_foreground_color_attr, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nbreak;\r\ncase EXTENDED_IDEOGRAPHIC_ATTRIBUTES:\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_ideographic_attr, tvb, offset,\r\n1, ENC_BIG_ENDIAN);\r\noffset++;\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic guint32\r\ndissect_start_of_field(proto_tree *tn5250_tree, tvbuff_t *tvb, gint offset)\r\n{\r\nint start = offset;\r\nint done = 0;\r\nint ffw = 0, fcw = 0, fa = 0;\r\nstatic const int *byte[] = {\r\n&hf_tn5250_ffw_id,\r\n&hf_tn5250_ffw_bypass,\r\n&hf_tn5250_ffw_dup,\r\n&hf_tn5250_ffw_mdt,\r\n&hf_tn5250_ffw_shift,\r\nNULL\r\n};\r\nstatic const int *byte1[] = {\r\n&hf_tn5250_ffw_auto,\r\n&hf_tn5250_ffw_fer,\r\n&hf_tn5250_ffw_monocase,\r\n&hf_tn5250_ffw_res,\r\n&hf_tn5250_ffw_me,\r\n&hf_tn5250_ffw_adjust,\r\nNULL\r\n};\r\nstatic const int *fabyte[] = {\r\n&hf_tn5250_sf_attr_flag, &hf_tn5250_wea_prim_attr_col,\r\n&hf_tn5250_wea_prim_attr_blink, &hf_tn5250_wea_prim_attr_und,\r\n&hf_tn5250_wea_prim_attr_int, &hf_tn5250_wea_prim_attr_rev,\r\nNULL\r\n};\r\nhf_items outbound_text_header_fields[] = {\r\n{ &hf_tn5250_ffw, ett_tn5250_soh_mask, 1, byte, 0 },\r\n{ &hf_tn5250_ffw, ett_tn5250_soh_mask, 1, byte1, 0 },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nffw = tvb_get_guint8(tvb, offset);\r\nif (ffw & FFW_ID) {\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset,\r\noutbound_text_header_fields);\r\nwhile (tvb_reported_length_remaining(tvb, offset) > 0 && !done) {\r\nfcw = tvb_get_guint8(tvb, offset);\r\nswitch (fcw) {\r\ncase SELECTOR:\r\ncase IDEOGRAPHIC:\r\ncase FORWARD_EDGE:\r\ncase CONTINUED_ENTRY:\r\ncase SELF_CHECK:\r\ncase ENTRY_FIELD_RESEQUENCING:\r\ncase CURSOR_PROGRESSION_ENTRY_FIELD:\r\ncase HIGHLIGHTED_ENTRY_FIELD:\r\ncase POINTER_DEVICE_SELECTION_ENTRY_FIELD:\r\ncase TRANSPARENCY_ENTRY_FIELD:\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_fcw, tvb, offset,\r\n2, ENC_BIG_ENDIAN);\r\noffset+=2;\r\nbreak;\r\ndefault:\r\ndone = 1;\r\nbreak;\r\n}\r\n}\r\n}\r\nfa = tvb_get_guint8(tvb, offset);\r\nif (fa & FA_ID) {\r\nproto_tree_add_bitmask(tn5250_tree, tvb, offset, hf_tn5250_fa,\r\nett_tn5250_wea_prim_attr, fabyte, ENC_BIG_ENDIAN);\r\noffset++;\r\n} else {\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_fa_color, tvb, offset,\r\n1, ENC_BIG_ENDIAN);\r\noffset++;\r\n}\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_length_twobyte, tvb, offset,\r\n2, ENC_BIG_ENDIAN);\r\noffset+=2;\r\nreturn (offset - start);\r\n}\r\nstatic guint32\r\ndissect_create_window(proto_tree *tn5250_tree, tvbuff_t *tvb, gint offset)\r\n{\r\nint start = offset;\r\nint length = 0;\r\nint done = 0, minor_structure = 0;\r\nstatic const int *byte[] = {\r\n&hf_tn5250_wdsf_cw_flag1_1,\r\n&hf_tn5250_wdsf_cw_flag1_2,\r\n&hf_tn5250_wdsf_cw_flag1_reserved,\r\nNULL\r\n};\r\nhf_items cw_fields[] = {\r\n{ &hf_tn5250_wdsf_cw_flag1, ett_tn5250_wdsf_cw_mask, 1, byte, 0 },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_cw_wd, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_cw_ww, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nstatic const int *cw_bp_flag1[] = {\r\n&hf_tn5250_wdsf_cw_bp_flag1_1,\r\n&hf_tn5250_wdsf_cw_bp_flag1_reserved,\r\nNULL\r\n};\r\nhf_items cwbp_fields[] = {\r\n{ &hf_tn5250_length, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_cw_minor_type, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_cw_bp_flag1, ett_tn5250_wdsf_cw_bp_mask, 1, cw_bp_flag1, 0 },\r\n{ &hf_tn5250_wdsf_cw_bp_mba, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_cw_bp_cba, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_cw_bp_ulbc, 0, 1, 0, ENC_EBCDIC|ENC_NA },\r\n{ &hf_tn5250_wdsf_cw_bp_tbc, 0, 1, 0, ENC_EBCDIC|ENC_NA },\r\n{ &hf_tn5250_wdsf_cw_bp_urbc, 0, 1, 0, ENC_EBCDIC|ENC_NA },\r\n{ &hf_tn5250_wdsf_cw_bp_lbc, 0, 1, 0, ENC_EBCDIC|ENC_NA },\r\n{ &hf_tn5250_wdsf_cw_bp_rbc, 0, 1, 0, ENC_EBCDIC|ENC_NA },\r\n{ &hf_tn5250_wdsf_cw_bp_llbc, 0, 1, 0, ENC_EBCDIC|ENC_NA },\r\n{ &hf_tn5250_wdsf_cw_bp_bbc, 0, 1, 0, ENC_EBCDIC|ENC_NA },\r\n{ &hf_tn5250_wdsf_cw_bp_lrbc, 0, 1, 0, ENC_EBCDIC|ENC_NA },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nstatic const int *cw_tf_flag1[] = {\r\n&hf_tn5250_wdsf_cw_tf_flag_orientation,\r\n&hf_tn5250_wdsf_cw_tf_flag_1,\r\n&hf_tn5250_wdsf_cw_tf_flag_reserved,\r\nNULL\r\n};\r\nhf_items cw_tf_fields[] = {\r\n{ &hf_tn5250_length, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_cw_minor_type, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_cw_tf_flag, ett_tn5250_wdsf_cw_tf_mask, 1, cw_tf_flag1, 0 },\r\n{ &hf_tn5250_wdsf_cw_tf_mba, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_cw_tf_cba, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, cw_fields);\r\nwhile (tvb_reported_length_remaining(tvb, offset) > 0 && !done) {\r\nminor_structure = tvb_get_guint8(tvb, offset+1);\r\nswitch (minor_structure) {\r\ncase CW_BORDER_PRESENTATION:\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, cwbp_fields);\r\nbreak;\r\ncase CW_TITLE_FOOTER:\r\nlength = tvb_get_guint8(tvb,offset);\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, cw_tf_fields);\r\nif (length < 6) {\r\nbreak;\r\n}\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_wdsf_cw_tf_text, tvb, offset,\r\n(length - 6), ENC_EBCDIC|ENC_NA);\r\noffset += (guint32)((length - 6));\r\nbreak;\r\ndefault:\r\ndone = 1;\r\nbreak;\r\n}\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic guint32\r\ndissect_define_selection(proto_tree *tn5250_tree, tvbuff_t *tvb, gint offset)\r\n{\r\nint start = offset;\r\nint length = 0;\r\nint done = 0, minor_structure = 0, digit_selection = 0;\r\nint minor_structure_start;\r\nstatic const int *ds_flag1[] = {\r\n&hf_tn5250_wdsf_ds_flag1_mouse_characteristics, &hf_tn5250_wdsf_ds_flag1_reserved,\r\n&hf_tn5250_wdsf_ds_flag1_auto_enter, &hf_tn5250_wdsf_ds_flag1_1,\r\n&hf_tn5250_wdsf_ds_flag1_2, NULL\r\n};\r\nstatic const int *ds_flag2[] = {\r\n&hf_tn5250_wdsf_ds_flag2_1, &hf_tn5250_wdsf_ds_flag2_2,\r\n&hf_tn5250_wdsf_ds_flag2_3, &hf_tn5250_wdsf_ds_flag2_4,\r\n&hf_tn5250_wdsf_ds_flag2_5, &hf_tn5250_wdsf_ds_flag2_6,\r\n&hf_tn5250_wdsf_ds_flag2_reserved,\r\nNULL\r\n};\r\nstatic const int *ds_flag3[] = {\r\n&hf_tn5250_wdsf_ds_flag3_1, &hf_tn5250_wdsf_ds_flag3_reserved,\r\nNULL\r\n};\r\nstatic const int *ds_gdc[] = {\r\n&hf_tn5250_wdsf_ds_gdc_indicators, &hf_tn5250_wdsf_ds_gdc_reserved,\r\n&hf_tn5250_wdsf_ds_gdc_selection_techniques,\r\nNULL\r\n};\r\nstatic const int *ds_nws[] = {\r\n&hf_tn5250_wdsf_ds_nws_indicators, &hf_tn5250_wdsf_ds_nws_reserved,\r\n&hf_tn5250_wdsf_ds_nws_selection_techniques,\r\nNULL\r\n};\r\nhf_items ds_fields[] = {\r\n{ &hf_tn5250_wdsf_ds_flag1, ett_tn5250_wdsf_ds_mask, 1, ds_flag1, 0 },\r\n{ &hf_tn5250_wdsf_ds_flag2, ett_tn5250_wdsf_ds_mask, 1, ds_flag2, 0 },\r\n{ &hf_tn5250_wdsf_ds_flag3, ett_tn5250_wdsf_ds_mask, 1, ds_flag3, 0 },\r\n{ &hf_tn5250_wdsf_ds_type, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_gdc, ett_tn5250_wdsf_ds_mask, 1, ds_gdc, 0 },\r\n{ &hf_tn5250_wdsf_ds_nws, ett_tn5250_wdsf_ds_mask, 1, ds_nws, 0 },\r\n{ &hf_tn5250_wdsf_ds_nws_wout, ett_tn5250_wdsf_ds_mask, 1, ds_nws, 0 },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_textsize, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_rows, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_columns, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_padding, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_numeric_sep, 0, 1, 0, ENC_EBCDIC|ENC_NA },\r\n{ &hf_tn5250_wdsf_ds_country_sel, 0, 1, 0, ENC_EBCDIC|ENC_NA },\r\n{ &hf_tn5250_wdsf_ds_cancel_aid, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_totalrows, 0, 4, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_sliderpos, 0, 4, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nstatic const int *ds_ct_flag1[] = {\r\n&hf_tn5250_wdsf_ds_ct_flag1_choice_state, &hf_tn5250_wdsf_ds_ct_flag1_2,\r\n&hf_tn5250_wdsf_ds_ct_flag1_3, &hf_tn5250_wdsf_ds_ct_flag1_4,\r\n&hf_tn5250_wdsf_ds_ct_flag1_5, &hf_tn5250_wdsf_ds_ct_flag1_numeric_selection,\r\nNULL\r\n};\r\nstatic const int *ds_ct_flag2[] = {\r\n&hf_tn5250_wdsf_ds_ct_flag2_0, &hf_tn5250_wdsf_ds_ct_flag2_1,\r\n&hf_tn5250_wdsf_ds_ct_flag2_2, &hf_tn5250_wdsf_ds_ct_flag2_3,\r\n&hf_tn5250_wdsf_ds_ct_flag2_4, &hf_tn5250_wdsf_ds_ct_flag2_5,\r\n&hf_tn5250_wdsf_ds_ct_flag2_6, &hf_tn5250_wdsf_ds_ct_flag2_7,\r\nNULL\r\n};\r\nstatic const int *ds_ct_flag3[] = {\r\n&hf_tn5250_wdsf_ds_ct_flag3_0, &hf_tn5250_wdsf_ds_ct_flag3_1,\r\n&hf_tn5250_wdsf_ds_ct_flag3_2, &hf_tn5250_wdsf_ds_ct_flag3_reserved,\r\nNULL\r\n};\r\nhf_items ds_ct_fields[] = {\r\n{ &hf_tn5250_length, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_minor_type, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_ct_flag1, ett_tn5250_wdsf_ds_ct_mask, 1, ds_ct_flag1, 0 },\r\n{ &hf_tn5250_wdsf_ds_ct_flag2, ett_tn5250_wdsf_ds_ct_mask, 1, ds_ct_flag2, 0 },\r\n{ &hf_tn5250_wdsf_ds_ct_flag3, ett_tn5250_wdsf_ds_ct_mask, 1, ds_ct_flag3, 0 },\r\n{ &hf_tn5250_wdsf_ds_ct_mnemonic_offset, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_ct_aid, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_ct_numeric_onebyte, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_ct_numeric_twobyte, 0, 2, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nstatic const int *ds_mbs_flag[] = {\r\n&hf_tn5250_wdsf_ds_mbs_flag_0, &hf_tn5250_wdsf_ds_mbs_flag_1,\r\n&hf_tn5250_wdsf_ds_mbs_flag_reserved,\r\nNULL\r\n};\r\nhf_items ds_mbs_fields[] = {\r\n{ &hf_tn5250_length, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_minor_type, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_mbs_flag, ett_tn5250_wdsf_ds_mbs_mask, 1, ds_mbs_flag, 0 },\r\n{ &hf_tn5250_wdsf_ds_mbs_start_column, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_mbs_end_column, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_mbs_start_column, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_mbs_monochrome_sep, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_mbs_color_sep, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_mbs_sep_char, 0, 1, 0, ENC_EBCDIC|ENC_NA },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nstatic const int *ds_cpda_flag[] = {\r\n&hf_tn5250_wdsf_ds_cpda_flag1_0, &hf_tn5250_wdsf_ds_cpda_flag1_1,\r\n&hf_tn5250_wdsf_ds_cpda_flag1_2, &hf_tn5250_wdsf_ds_cpda_flag1_reserved,\r\nNULL\r\n};\r\nhf_items ds_cpda_fields[] = {\r\n{ &hf_tn5250_length, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_minor_type, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_cpda_flag1, ett_tn5250_wdsf_ds_cpda_mask, 1, ds_cpda_flag, 0 },\r\n{ &hf_tn5250_wdsf_ds_cpda_monochrome_sel_avail, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_cpda_color_sel_avail, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_cpda_monochrome_sel_selected, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_cpda_color_sel_selected, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_cpda_monochrome_sel_unavail, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_cpda_color_sel_unavail, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_cpda_monochrome_avail, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_cpda_color_avail, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_cpda_monochrome_selected, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_cpda_color_selected, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_cpda_monochrome_unavail, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_cpda_color_unavail, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_cpda_monochrome_indicator, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_cpda_color_indicator, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_cpda_monochrome_unavail_indicator, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_cpda_color_unavail_indicator, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nstatic const int *ds_ci_flag[] = {\r\n&hf_tn5250_wdsf_ds_ci_flag1_0, &hf_tn5250_wdsf_ds_ci_flag1_reserved,\r\nNULL\r\n};\r\nhf_items ds_ci_fields[] = {\r\n{ &hf_tn5250_length, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_minor_type, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_ci_flag1, ett_tn5250_wdsf_ds_ci_mask, 1, ds_ci_flag, 0 },\r\n{ &hf_tn5250_wdsf_ds_ci_left_push, 0, 1, 0, ENC_EBCDIC|ENC_NA },\r\n{ &hf_tn5250_wdsf_ds_ci_right_push, 0, 1, 0, ENC_EBCDIC|ENC_NA },\r\n{ &hf_tn5250_wdsf_ds_ci_first_choice, 0, 1, 0, ENC_EBCDIC|ENC_NA },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nstatic const int *ds_sbi_flag[] = {\r\n&hf_tn5250_wdsf_ds_sbi_flag1_0, &hf_tn5250_wdsf_ds_sbi_flag1_reserved,\r\nNULL\r\n};\r\nhf_items ds_sbi_fields[] = {\r\n{ &hf_tn5250_length, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_minor_type, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_sbi_flag1, ett_tn5250_wdsf_ds_sbi_mask, 1, ds_sbi_flag, 0 },\r\n{ &hf_tn5250_wdsf_ds_sbi_monochrome_top_highlight, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_sbi_color_top_highlight, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_sbi_monochrome_top_highlight_shaft, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_sbi_color_top_highlight_shaft, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_sbi_top_character, 0, 1, 0, ENC_EBCDIC|ENC_NA },\r\n{ &hf_tn5250_wdsf_ds_sbi_bottom_character, 0, 1, 0, ENC_EBCDIC|ENC_NA },\r\n{ &hf_tn5250_wdsf_ds_sbi_empty_character, 0, 1, 0, ENC_EBCDIC|ENC_NA },\r\n{ &hf_tn5250_wdsf_ds_sbi_slider_character, 0, 1, 0, ENC_EBCDIC|ENC_NA },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, ds_fields);\r\nwhile (tvb_reported_length_remaining(tvb, offset) > 0 && !done) {\r\nminor_structure = tvb_get_guint8(tvb, offset+1);\r\nswitch (minor_structure) {\r\ncase DS_CHOICE_TEXT:\r\nlength = tvb_get_guint8(tvb, offset);\r\ndigit_selection = tvb_get_guint8(tvb, offset+2);\r\nminor_structure_start = offset;\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, ds_ct_fields);\r\nif (digit_selection & DS_NUMERIC_SELECTION_SINGLE_DIGIT) {\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_wdsf_ds_ct_numeric_onebyte,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\n} else if (digit_selection & DS_NUMERIC_SELECTION_DOUBLE_DIGIT) {\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_wdsf_ds_ct_numeric_twobyte,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset+=2;\r\n}\r\nif (length < (offset - minor_structure_start)) {\r\nbreak;\r\n}\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_wdsf_ds_ct_text, tvb, offset,\r\n(length - (offset - minor_structure_start)),\r\nENC_EBCDIC|ENC_NA);\r\noffset += (guint32)((length - (offset - minor_structure_start)));\r\nbreak;\r\ncase DS_MENU_BAR_SEPARATOR:\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, ds_mbs_fields);\r\nbreak;\r\ncase DS_CHOICE_PRESENTATION_DISPLAY:\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, ds_cpda_fields);\r\nbreak;\r\ncase DS_CHOICE_INDICATORS:\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, ds_ci_fields);\r\nbreak;\r\ncase DS_SCROLLBAR_INDICATORS:\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, ds_sbi_fields);\r\nbreak;\r\ndefault:\r\ndone = 1;\r\nbreak;\r\n}\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic guint32\r\ndissect_define_scrollbar(proto_tree *tn5250_tree, tvbuff_t *tvb, gint offset)\r\n{\r\nint start = offset;\r\nint done = 0, minor_structure = 0;\r\nstatic const int *dsb_byte[] = {\r\n&hf_tn5250_wdsf_dsb_flag1_0, &hf_tn5250_wdsf_dsb_flag1_1,\r\n&hf_tn5250_wdsf_dsb_flag1_reserved, &hf_tn5250_wdsf_dsb_flag1_7,\r\nNULL\r\n};\r\nhf_items dsb_fields[] = {\r\n{ &hf_tn5250_wdsf_dsb_flag1, ett_tn5250_wdsf_dsb_mask, 1, dsb_byte, 0 },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_sbi_total_scroll, 0, 4, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_sbi_sliderpos, 0, 4, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_sbi_rowscols, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nstatic const int *ds_sbi_flag[] = {\r\n&hf_tn5250_wdsf_ds_sbi_flag1_0, &hf_tn5250_wdsf_ds_sbi_flag1_reserved,\r\nNULL\r\n};\r\nhf_items ds_sbi_fields[] = {\r\n{ &hf_tn5250_length, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_minor_type, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_sbi_flag1, ett_tn5250_wdsf_ds_sbi_mask, 1, ds_sbi_flag, 0 },\r\n{ &hf_tn5250_wdsf_ds_sbi_monochrome_top_highlight, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_sbi_color_top_highlight, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_sbi_monochrome_top_highlight_shaft, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_sbi_color_top_highlight_shaft, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_ds_sbi_top_character, 0, 1, 0, ENC_EBCDIC|ENC_NA },\r\n{ &hf_tn5250_wdsf_ds_sbi_bottom_character, 0, 1, 0, ENC_EBCDIC|ENC_NA },\r\n{ &hf_tn5250_wdsf_ds_sbi_empty_character, 0, 1, 0, ENC_EBCDIC|ENC_NA },\r\n{ &hf_tn5250_wdsf_ds_sbi_slider_character, 0, 1, 0, ENC_EBCDIC|ENC_NA },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, dsb_fields);\r\nwhile (tvb_reported_length_remaining(tvb, offset) > 0 && !done) {\r\nminor_structure = tvb_get_guint8(tvb, offset+1);\r\nswitch (minor_structure) {\r\ncase DS_SCROLLBAR_INDICATORS:\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, ds_sbi_fields);\r\nbreak;\r\ndefault:\r\ndone = 1;\r\nbreak;\r\n}\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic guint32\r\ndissect_draw_erase_gridlines(proto_tree *tn5250_tree, tvbuff_t *tvb, gint offset)\r\n{\r\nint start = offset;\r\nint done = 0, minor_structure=0;\r\nstatic const int *deg_byte[] = {\r\n&hf_tn5250_wdsf_deg_flag1_0, &hf_tn5250_wdsf_deg_flag1_reserved,\r\nNULL\r\n};\r\nstatic const int *deg_byte2[] = {\r\n&hf_tn5250_wdsf_deg_flag2_0, &hf_tn5250_wdsf_deg_flag2_reserved,\r\nNULL\r\n};\r\nhf_items deg_fields[] = {\r\n{ &hf_tn5250_wdsf_deg_partition, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_deg_flag1, ett_tn5250_wdsf_deg_mask, 1, deg_byte, 0 },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_deg_flag2, ett_tn5250_wdsf_deg_mask, 1, deg_byte2, 0 },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_deg_default_color, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_deg_default_line, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nstatic const int *deg_ms_byte[] = {\r\n&hf_tn5250_wdsf_deg_ms_flag1_0, &hf_tn5250_wdsf_deg_ms_flag1_reserved,\r\nNULL\r\n};\r\nhf_items deg_ms_fields[] = {\r\n{ &hf_tn5250_length, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_deg_minor_type, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_deg_ms_flag1, ett_tn5250_wdsf_deg_ms_mask, 1, deg_ms_byte, 0 },\r\n{ &hf_tn5250_wdsf_deg_ms_start_row, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_deg_ms_start_column, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_deg_ms_horizontal_dimension, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_deg_ms_vertical_dimension, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_deg_ms_default_color, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_deg_ms_line_repeat, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_deg_ms_line_interval, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, deg_fields);\r\nwhile (tvb_reported_length_remaining(tvb, offset) > 0 && !done) {\r\nminor_structure = tvb_get_guint8(tvb, offset+1);\r\nswitch (minor_structure) {\r\ncase UPPER_HORIZONTAL_LINE:\r\ncase LOWER_HORIZONTAL_LINE:\r\ncase LEFT_VERTICAL_LINE:\r\ncase RIGHT_VERTICAL_LINE:\r\ncase PLAIN_BOX:\r\ncase HORIZONTALLY_RULED_BOX:\r\ncase VERTICALLY_RULED_BOX:\r\ncase HORIZONTALLY_AND_VERTICALLY_RULED_BOX:\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, deg_ms_fields);\r\nbreak;\r\ndefault:\r\ndone = 1;\r\nbreak;\r\n}\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic guint32\r\ndissect_wdsf_structured_field(proto_tree *tn5250_tree, tvbuff_t *tvb, gint offset)\r\n{\r\nint start = offset;\r\nint minor_structure_start;\r\nint length = 0, type;\r\nint done = 0, ln_left = 0, i = 0;\r\nhf_items standard_fields[] = {\r\n{ &hf_tn5250_sf_length, 0, 2, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_sf_class, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_sf_type, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nstatic const int *rgw_byte[] = {\r\n&hf_tn5250_wdsf_rgw_flag1_0,\r\n&hf_tn5250_wdsf_rgw_flag1_1,\r\n&hf_tn5250_wdsf_rgw_reserved,\r\nNULL\r\n};\r\nhf_items rgw_fields[] = {\r\n{ &hf_tn5250_wdsf_rgw_flag1, ett_tn5250_wdsf_rgw_mask, 1, rgw_byte, 0 },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nstatic const int *ragc_byte[] = {\r\n&hf_tn5250_wdsf_ragc_flag1_0,\r\n&hf_tn5250_wdsf_ragc_reserved,\r\nNULL\r\n};\r\nhf_items ragc_fields[] = {\r\n{ &hf_tn5250_wdsf_ragc_flag1, ett_tn5250_wdsf_ragc_mask, 1, ragc_byte, 0 },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nstatic const int *wdf_byte[] = {\r\n&hf_tn5250_wdsf_wdf_flag1_0,\r\n&hf_tn5250_wdsf_wdf_flag1_reserved,\r\nNULL\r\n};\r\nhf_items wdf_fields[] = {\r\n{ &hf_tn5250_wdsf_wdf_flag1, ett_tn5250_wdsf_wdf_mask, 1, wdf_byte, 0 },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nstatic const int *pmb_byte[] = {\r\n&hf_tn5250_wdsf_pmb_flag1_0, &hf_tn5250_wdsf_pmb_flag1_1,\r\n&hf_tn5250_wdsf_pmb_flag1_2, &hf_tn5250_wdsf_pmb_flag1_3,\r\n&hf_tn5250_wdsf_pmb_flag1_reserved,\r\nNULL\r\n};\r\nhf_items pmb_fields[] = {\r\n{ &hf_tn5250_wdsf_pmb_flag1, ett_tn5250_wdsf_pmb_mask, 1, pmb_byte, 0 },\r\n{ &hf_tn5250_wdsf_pmb_first_mouse_event, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_pmb_second_mouse_event, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_aid, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nhf_items cgl_fields[] = {\r\n{ &hf_tn5250_wdsf_cgl_partition, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_cgl_start_row, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_cgl_start_column, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_cgl_rectangle_width, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wdsf_cgl_rectangle_height, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nlength = tvb_get_ntohs(tvb,offset);\r\ntype = tvb_get_guint8(tvb, offset+3);\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, standard_fields);\r\nwhile (tvb_reported_length_remaining(tvb, offset) > 0 && !done) {\r\nswitch (type) {\r\ncase CREATE_WINDOW:\r\noffset += dissect_create_window(tn5250_tree, tvb, offset);\r\nbreak;\r\ncase UNRESTRICTED_WINDOW_CURSOR_MOVEMENT:\r\ncase REMOVE_GUI_SELECTION_FIELD:\r\ncase REMOVE_GUI_SCROLL_BAR_FIELD:\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_reserved, tvb, offset,\r\n1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_reserved, tvb, offset,\r\n1, ENC_BIG_ENDIAN);\r\noffset +=2;\r\nbreak;\r\ncase REMOVE_GUI_WINDOW:\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, rgw_fields);\r\nbreak;\r\ncase REMOVE_ALL_GUI_CONSTRUCTS:\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, ragc_fields);\r\nbreak;\r\ncase DEFINE_SELECTION_FIELD:\r\noffset += dissect_define_selection(tn5250_tree, tvb, offset);\r\nbreak;\r\ncase DEFINE_SCROLL_BAR_FIELD:\r\noffset += dissect_define_scrollbar(tn5250_tree, tvb, offset);\r\nbreak;\r\ncase WRITE_DATA:\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, wdf_fields);\r\nif (length < 6) {\r\nbreak;\r\n}\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_field_data, tvb, offset,\r\n(length - 6), ENC_EBCDIC|ENC_NA);\r\noffset += (guint32)((length - 6));\r\nbreak;\r\ncase PROGRAMMABLE_MOUSE_BUTTONS:\r\nminor_structure_start = start;\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_reserved, tvb, offset,\r\n1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_reserved, tvb, offset,\r\n1, ENC_BIG_ENDIAN);\r\noffset +=2;\r\nif (length < (offset - minor_structure_start)) {\r\nbreak;\r\n}\r\nln_left = length - (offset - minor_structure_start);\r\nfor (i = 0; i < ln_left; i+=4) {\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, pmb_fields);\r\n}\r\nbreak;\r\ncase DRAW_ERASE_GRID_LINES:\r\noffset += dissect_draw_erase_gridlines(tn5250_tree, tvb, offset);\r\nbreak;\r\ncase CLEAR_GRID_LINE_BUFFER:\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, cgl_fields);\r\nbreak;\r\ndefault:\r\ndone = 1;\r\nbreak;\r\n}\r\n}\r\noffset += dissect_unknown_data(tn5250_tree, tvb, offset, start, length);\r\nreturn (offset - start);\r\n}\r\nstatic guint32\r\ndissect_tn5250_ra_data(proto_tree *tn5250_tree, tvbuff_t *tvb, gint offset)\r\n{\r\ngint order_code, done = 0;\r\ngint start = offset;\r\nwhile (tvb_reported_length_remaining(tvb, offset) > 0 && !done) {\r\norder_code = tvb_get_guint8(tvb, offset);\r\nswitch (order_code) {\r\ncase TN5250_IC:\r\ncase TN5250_MC:\r\ncase TN5250_SBA:\r\ncase TN5250_RA:\r\ncase TN5250_EA:\r\ncase TN5250_SOH:\r\ncase TN5250_TD:\r\ncase TN5250_WEA:\r\ncase TN5250_SF:\r\ncase TN5250_WDSF:\r\ncase TN5250_ESCAPE:\r\ndone = 1;\r\nbreak;\r\ndefault:\r\noffset++;\r\nbreak;\r\n}\r\n}\r\nif (offset > start) {\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_repeated_character,\r\ntvb, start, (offset - start), ENC_EBCDIC|ENC_NA);\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic guint32\r\ndissect_tn5250_orders_and_data(proto_tree *tn5250_tree, tvbuff_t *tvb, gint offset)\r\n{\r\ngint start = offset, done = 0;\r\ngint order_code;\r\nproto_tree *cc_tree;\r\nproto_item *ti;\r\nwhile (tvb_reported_length_remaining(tvb, offset) > 0 && !done) {\r\norder_code = tvb_get_guint8(tvb, offset);\r\nswitch (order_code) {\r\ncase TN5250_IC:\r\ncase TN5250_MC:\r\ncase TN5250_SBA:\r\nti = proto_tree_add_item(tn5250_tree, hf_tn5250_order_code, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\ncc_tree = proto_item_add_subtree(ti, ett_cc);\r\noffset += dissect_row_column(cc_tree, tvb, offset);\r\noffset += dissect_tn5250_ra_data(cc_tree, tvb, offset);\r\nbreak;\r\ncase TN5250_RA:\r\nti = proto_tree_add_item(tn5250_tree, hf_tn5250_order_code, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\ncc_tree = proto_item_add_subtree(ti, ett_cc);\r\noffset += dissect_row_column(cc_tree, tvb, offset);\r\noffset += dissect_tn5250_ra_data(cc_tree, tvb, offset);\r\nbreak;\r\ncase TN5250_EA:\r\nti = proto_tree_add_item(tn5250_tree, hf_tn5250_order_code, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\ncc_tree = proto_item_add_subtree(ti, ett_cc);\r\noffset += dissect_erase_to_address(cc_tree, tvb, offset);\r\nbreak;\r\ncase TN5250_SOH:\r\nti = proto_tree_add_item(tn5250_tree, hf_tn5250_order_code, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\ncc_tree = proto_item_add_subtree(ti, ett_cc);\r\noffset += dissect_start_of_header(cc_tree, tvb, offset);\r\nbreak;\r\ncase TN5250_TD:\r\nti = proto_tree_add_item(tn5250_tree, hf_tn5250_order_code, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\ncc_tree = proto_item_add_subtree(ti, ett_cc);\r\noffset += dissect_twobyte_length_and_data(cc_tree, tvb, offset);\r\nbreak;\r\ncase TN5250_WEA:\r\nti = proto_tree_add_item(tn5250_tree, hf_tn5250_order_code, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\ncc_tree = proto_item_add_subtree(ti, ett_cc);\r\noffset += dissect_field_attribute_pair(cc_tree, tvb, offset);\r\nbreak;\r\ncase TN5250_SF:\r\nti = proto_tree_add_item(tn5250_tree, hf_tn5250_order_code, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\ncc_tree = proto_item_add_subtree(ti, ett_cc);\r\noffset += dissect_start_of_field(cc_tree, tvb, offset);\r\noffset += dissect_tn5250_ra_data(cc_tree, tvb, offset);\r\nbreak;\r\ncase TN5250_WDSF:\r\nti = proto_tree_add_item(tn5250_tree, hf_tn5250_order_code, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\ncc_tree = proto_item_add_subtree(ti, ett_cc);\r\noffset += dissect_wdsf_structured_field(cc_tree, tvb, offset);\r\nbreak;\r\ndefault:\r\ndone = 1;\r\nbreak;\r\n}\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic guint32\r\ndissect_save_partial_screen(proto_tree *tn5250_tree, tvbuff_t *tvb, gint offset)\r\n{\r\nint start = offset;\r\nint length = 0;\r\nstatic const int *byte[] = {\r\n&hf_tn5250_sps_flag1_0,\r\n&hf_tn5250_sps_flag1_reserved,\r\nNULL\r\n};\r\nhf_items save_partial_screen_fields[] = {\r\n{ &hf_tn5250_soh_length, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_sps_flag1, ett_tn5250_sps_mask, 1, byte, 0 },\r\n{ &hf_tn5250_sps_top_row, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_sps_left_column, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_sps_window_depth, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_sps_window_width, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nlength = tvb_get_guint8(tvb, offset);\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset,\r\nsave_partial_screen_fields);\r\noffset += dissect_unknown_data(tn5250_tree, tvb, offset, start, length);\r\nreturn (offset - start);\r\n}\r\nstatic guint32\r\ndissect_roll(proto_tree *tn5250_tree, tvbuff_t *tvb, gint offset)\r\n{\r\nint start = offset;\r\nstatic const int *byte[] = {\r\n&hf_tn5250_roll_flag1_0,\r\n&hf_tn5250_roll_flag1_reserved,\r\n&hf_tn5250_roll_flag1_lines,\r\nNULL\r\n};\r\nhf_items roll_fields[] = {\r\n{ &hf_tn5250_roll_flag1, ett_tn5250_roll_mask, 1, byte, 0 },\r\n{ &hf_tn5250_roll_top_line, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_roll_bottom_line, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, roll_fields);\r\nreturn (offset - start);\r\n}\r\nstatic guint32\r\ndissect_write_single_structured_field_minor_fields(proto_tree *tn5250_tree,\r\ntvbuff_t *tvb, gint offset)\r\n{\r\nint start = offset;\r\nint done = 0, type = 0;\r\nstatic const int *byte_wssf_kbc_flag1[] = {\r\n&hf_tn5250_wssf_kbc_flag1_reserved,\r\n&hf_tn5250_wssf_kbc_flag1_5,\r\n&hf_tn5250_wssf_kbc_flag1_6,\r\n&hf_tn5250_wssf_kbc_flag1_7,\r\nNULL\r\n};\r\nstatic const int *byte_wssf_cc_flag1[] = {\r\n&hf_tn5250_wssf_cc_flag1_reserved,\r\n&hf_tn5250_wssf_cc_flag1_7,\r\nNULL\r\n};\r\nhf_items wsc_customization_kbc_fields[] = {\r\n{ &hf_tn5250_sf_length, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wssf_wsc_minor_type, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wssf_kbc_flag1, ett_tn5250_wssf_kbc_mask, 1, byte_wssf_kbc_flag1, 0 },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nhf_items wsc_customization_cc_fields[] = {\r\n{ &hf_tn5250_sf_length, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wssf_wsc_minor_type, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wssf_cc_flag1, ett_tn5250_wssf_cc_mask, 1, byte_wssf_cc_flag1, 0 },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nwhile (tvb_reported_length_remaining(tvb, offset) > 0 && !done) {\r\ntype = tvb_get_guint8(tvb, offset+1);\r\nswitch (type) {\r\ncase KEYSTROKE_BUFFERING_CONTROL:\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset,\r\nwsc_customization_kbc_fields);\r\nbreak;\r\ncase CURSOR_CONTROL:\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset,\r\nwsc_customization_cc_fields);\r\nbreak;\r\ndefault:\r\ndone = 1;\r\nbreak;\r\n}\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic guint32\r\ndissect_write_single_structured_field(proto_tree *tn5250_tree, tvbuff_t *tvb,\r\ngint offset)\r\n{\r\nint start = offset;\r\nint length, type, done = 0;\r\nguint32 namelength;\r\nstatic const int *byte[] = {\r\n&hf_tn5250_wssf_flag2_0,\r\n&hf_tn5250_wssf_flag2_1,\r\n&hf_tn5250_wssf_flag2_2,\r\n&hf_tn5250_wssf_flag2_3,\r\n&hf_tn5250_wssf_flag2_4,\r\n&hf_tn5250_wssf_flag2_5,\r\n&hf_tn5250_wssf_flag2_6,\r\n&hf_tn5250_wssf_flag2_7,\r\nNULL\r\n};\r\nstatic const int *ifc_byte[] = {\r\n&hf_tn5250_wssf_ifc_flag1_0,\r\n&hf_tn5250_wssf_ifc_flag1_1to3,\r\n&hf_tn5250_wssf_ifc_flag1_4,\r\n&hf_tn5250_wssf_ifc_flag1_5,\r\n&hf_tn5250_wssf_ifc_flag1_6,\r\n&hf_tn5250_wssf_ifc_flag1_7,\r\nNULL\r\n};\r\nstatic const int *ifc_byte2[] = {\r\n&hf_tn5250_wssf_ifc_flag2_0,\r\n&hf_tn5250_wssf_ifc_flag2_1,\r\n&hf_tn5250_wssf_ifc_flag2_reserved,\r\n&hf_tn5250_wssf_ifc_flag2_7,\r\nNULL\r\n};\r\nstatic const int *ifd_byte[] = {\r\n&hf_tn5250_wssf_ifd_flag1_0,\r\n&hf_tn5250_wssf_ifd_flag1_reserved,\r\nNULL\r\n};\r\nhf_items standard_fields[] = {\r\n{ &hf_tn5250_sf_length, 0, 2, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_sf_class, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_sf_type, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nhf_items wsc_customization_fields[] = {\r\n{ &hf_tn5250_wssf_flag1, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wssf_flag2, ett_tn5250_wssf_mask, 1, byte, 0 },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nhf_items wsc_image_control_fields[] = {\r\n{ &hf_tn5250_wssf_ifc_flag1, ett_tn5250_wssf_ifc_mask, 1, ifc_byte, 0 },\r\n{ &hf_tn5250_wssf_ifc_flag2, ett_tn5250_wssf_ifc_mask, 1, ifc_byte2, 0 },\r\n{ &hf_tn5250_wssf_ifc_image_format, 0, 2, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wssf_ifc_viewport_location_row, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wssf_ifc_viewport_location_col, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wssf_ifc_viewport_size_row, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wssf_ifc_viewport_size_col, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wssf_ifc_scaling, 0, 2, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wssf_ifc_viewimage_location_row, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wssf_ifc_viewimage_location_col, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wssf_ifc_rotation, 0, 2, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wssf_ifc_foreground_color, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wssf_ifc_background_color, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nhf_items wsc_image_download_fields[] = {\r\n{ &hf_tn5250_wssf_ifd_flag1, ett_tn5250_wssf_ifd_mask, 1, ifd_byte, 0 },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_length, 0, 2, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nlength = tvb_get_ntohs(tvb,offset);\r\ntype = tvb_get_guint8(tvb, offset+3);\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, standard_fields);\r\nwhile (tvb_reported_length_remaining(tvb, offset) > 0 && !done) {\r\nswitch (type) {\r\ncase WSC_CUSTOMIZATION:\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset,\r\nwsc_customization_fields);\r\noffset += dissect_write_single_structured_field_minor_fields(tn5250_tree, tvb, offset);\r\nbreak;\r\ncase IMAGE_FAX_CONTROL:\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset,\r\nwsc_image_control_fields);\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_wssf_ifc_imagefax_name, tvb, offset,\r\n(length - (start + offset)), ENC_EBCDIC|ENC_NA);\r\nif (length > (start + offset))\r\noffset += (guint32)(length - (start + offset));\r\nbreak;\r\ncase IMAGE_FAX_DOWNLOAD:\r\nnamelength = tvb_get_ntohs(tvb,offset+6);\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset,\r\nwsc_image_download_fields);\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_wssf_ifd_imagefax_name, tvb, offset,\r\nnamelength, ENC_EBCDIC|ENC_NA);\r\noffset += namelength;\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_wssf_ifd_imagefax_data, tvb, offset,\r\n(length - (start + offset)), ENC_NA);\r\nif (length > (start + offset))\r\noffset += (guint32)(length - (start + offset));\r\nbreak;\r\ncase VIDEO_AUDIO_CONTROLS:\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_vac_prefix, tvb, offset,\r\n2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_vac_data, tvb, offset,\r\n4, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nbreak;\r\ncase TRUE_TRANSPARENCY_WRITE:\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_wssf_ttw_flag, tvb, offset,\r\n1, ENC_BIG_ENDIAN);\r\noffset ++;\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_wssf_ttw_data, tvb, offset,\r\n(length - (start + offset)), ENC_NA);\r\nif (length > (start + offset))\r\noffset += (guint32)(length - (start + offset));\r\nbreak;\r\ndefault:\r\ndone = 1;\r\nbreak;\r\n}\r\n}\r\noffset += dissect_unknown_data(tn5250_tree, tvb, offset, start, length);\r\nreturn (offset - start);\r\n}\r\nstatic guint32\r\ndissect_write_structured_field(proto_tree *tn5250_tree, tvbuff_t *tvb, gint offset)\r\n{\r\nint start = offset;\r\nguint16 sf_length = 0;\r\nint length, type, done = 0, used = 0;\r\nhf_items standard_fields[] = {\r\n{ &hf_tn5250_sf_length, 0, 2, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_sf_class, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_sf_type, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nstatic const int *qss_byte1[] = {\r\n&hf_tn5250_wsf_qss_flag1_0,\r\n&hf_tn5250_wsf_qss_flag1_reserved,\r\nNULL\r\n};\r\nstatic const int *qss_byte2[] = {\r\n&hf_tn5250_wsf_qss_flag2_reserved,\r\n&hf_tn5250_wsf_qss_flag2_7,\r\nNULL\r\n};\r\nhf_items qss_fields[] = {\r\n{ &hf_tn5250_wsf_qss_flag1, ett_tn5250_wsf_qss_mask, 1, qss_byte1, 0 },\r\n{ &hf_tn5250_wsf_qss_flag2, ett_tn5250_wsf_qss_mask, 1, qss_byte2, 0 },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nhf_items dawt_fields[] = {\r\n{ &hf_tn5250_dawt_length, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_dawt_char, 0, 1, 0, ENC_EBCDIC|ENC_NA },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nhf_items dckf_fields[] = {\r\n{ &hf_tn5250_dckf_length, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_dckf_key_code, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_dckf_function_code, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nstatic const int *rts_byte1[] = {\r\n&hf_tn5250_rts_flag1_0,\r\n&hf_tn5250_rts_flag1_reserved,\r\nNULL\r\n};\r\nhf_items rts_fields[] = {\r\n{ &hf_tn5250_rts_partition, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_rts_flag1, ett_tn5250_wsf_rts_mask, 1, rts_byte1, 0 },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nstatic const int *dpo_byte1[] = {\r\n&hf_tn5250_dpo_flag1_0,\r\n&hf_tn5250_dpo_flag1_1,\r\n&hf_tn5250_dpo_flag1_2,\r\n&hf_tn5250_dpo_flag1_3,\r\n&hf_tn5250_dpo_flag1_4,\r\n&hf_tn5250_dpo_flag1_5,\r\n&hf_tn5250_dpo_flag1_6,\r\n&hf_tn5250_dpo_flag1_7,\r\nNULL\r\n};\r\nstatic const int *dpo_byte2[] = {\r\n&hf_tn5250_dpo_flag2_0,\r\n&hf_tn5250_dpo_flag2_reserved,\r\nNULL\r\n};\r\nhf_items dpo_fields[] = {\r\n{ &hf_tn5250_dpo_partition, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_dpo_flag1, ett_tn5250_wsf_dpo_mask, 1, dpo_byte1, 0 },\r\n{ &hf_tn5250_dpo_flag2, ett_tn5250_wsf_dpo_mask, 1, dpo_byte2, 0 },\r\n{ &hf_tn5250_dpo_displace_characters, 0, 3, 0, ENC_EBCDIC|ENC_NA },\r\n{ &hf_tn5250_dpo_start_location_row, 0, 2, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_dpo_start_location_col, 0, 2, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nstatic const int *dtsf_byte1[] = {\r\n&hf_tn5250_dtsf_flag1_0,\r\n&hf_tn5250_dtsf_flag1_1,\r\n&hf_tn5250_dtsf_flag1_2,\r\n&hf_tn5250_dtsf_flag1_3,\r\n&hf_tn5250_dtsf_flag1_4,\r\n&hf_tn5250_dtsf_flag1_5,\r\n&hf_tn5250_dtsf_flag1_6,\r\n&hf_tn5250_dtsf_flag1_7,\r\nNULL\r\n};\r\nstatic const int *dtsf_byte2[] = {\r\n&hf_tn5250_dtsf_flag2_0,\r\n&hf_tn5250_dtsf_flag2_1,\r\n&hf_tn5250_dtsf_flag2_2,\r\n&hf_tn5250_dtsf_flag2_3,\r\n&hf_tn5250_dtsf_flag2_4to7,\r\nNULL\r\n};\r\nhf_items dtsf_fields[] = {\r\n{ &hf_tn5250_dtsf_partition, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_dtsf_flag1, ett_tn5250_wsf_dtsf_mask, 1, dtsf_byte1, 0 },\r\n{ &hf_tn5250_dtsf_flag2, ett_tn5250_wsf_dtsf_mask, 1, dtsf_byte2, 0 },\r\n{ &hf_tn5250_dtsf_text_body_height, 0, 2, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_dtsf_text_body_width, 0, 2, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_dtsf_line_cmd_field_size, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_dtsf_location_of_pitch, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_dtsf_first_line, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nstatic const int *dsl_byte1[] = {\r\n&hf_tn5250_dsl_flag1_0,\r\n&hf_tn5250_dsl_flag1_1,\r\n&hf_tn5250_dsl_flag1_2,\r\n&hf_tn5250_dsl_flag1_reserved,\r\nNULL\r\n};\r\nhf_items dsl_fields[] = {\r\n{ &hf_tn5250_dsl_partition, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_dsl_rtl_offset, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_dsl_offset, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nhf_items dsl_fields2[] = {\r\n{ &hf_tn5250_length, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_dsl_flag1, ett_tn5250_wsf_dsl_mask, 1, dsl_byte1, 0 },\r\n{ &hf_tn5250_dsl_id, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_dsl_location, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_dsl_function, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nstatic const int *wts_byte1[] = {\r\n&hf_tn5250_wts_flag1_0,\r\n&hf_tn5250_wts_flag1_1,\r\n&hf_tn5250_wts_flag1_2,\r\n&hf_tn5250_wts_flag1_3,\r\n&hf_tn5250_wts_flag1_reserved,\r\nNULL\r\n};\r\nstatic const int *wts_byte2[] = {\r\n&hf_tn5250_wts_flag2_reserved,\r\n&hf_tn5250_wts_flag2_6,\r\n&hf_tn5250_wts_flag2_reserved2,\r\nNULL\r\n};\r\nstatic const int *wts_byte3[] = {\r\n&hf_tn5250_wts_flag3_0,\r\n&hf_tn5250_wts_flag3_1,\r\n&hf_tn5250_wts_flag3_2,\r\n&hf_tn5250_wts_flag3_3,\r\n&hf_tn5250_wts_flag3_4,\r\n&hf_tn5250_wts_flag3_5,\r\n&hf_tn5250_wts_flag3_6,\r\n&hf_tn5250_wts_flag3_7,\r\nNULL\r\n};\r\nhf_items wts_fields[] = {\r\n{ &hf_tn5250_wts_partition, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wts_flag1, ett_tn5250_wts_mask, 1, wts_byte1, 0 },\r\n{ &hf_tn5250_wts_flag2, ett_tn5250_wts_mask, 1, wts_byte2, 0 },\r\n{ &hf_tn5250_wts_flag3, ett_tn5250_wts_mask, 1, wts_byte3, 0 },\r\n{ &hf_tn5250_wts_home_position_row, 0, 2, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wts_home_position_col, 0, 2, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nstatic const int *wts_cld_byte1[] = {\r\n&hf_tn5250_wts_cld_flag1_0,\r\n&hf_tn5250_wts_cld_flag1_1,\r\n&hf_tn5250_wts_cld_flag1_2,\r\n&hf_tn5250_wts_cld_flag1_3,\r\n&hf_tn5250_wts_cld_flag1_4,\r\n&hf_tn5250_wts_cld_flag1_5,\r\n&hf_tn5250_wts_cld_flag1_6,\r\n&hf_tn5250_wts_cld_flag1_7,\r\nNULL\r\n};\r\nstatic const int *wts_cld_byte2[] = {\r\n&hf_tn5250_wts_cld_flag2_0,\r\n&hf_tn5250_wts_cld_flag2_1,\r\n&hf_tn5250_wts_cld_flag2_2,\r\n&hf_tn5250_wts_cld_flag2_3,\r\n&hf_tn5250_wts_cld_flag2_4,\r\n&hf_tn5250_wts_cld_flag2_line_spacing,\r\nNULL\r\n};\r\nstatic const int *wts_cld_byte3[] = {\r\n&hf_tn5250_wts_cld_flag3_0,\r\n&hf_tn5250_wts_cld_flag3_1,\r\n&hf_tn5250_wts_cld_flag3_2,\r\n&hf_tn5250_wts_cld_flag3_3,\r\n&hf_tn5250_wts_cld_flag3_4,\r\n&hf_tn5250_wts_cld_flag3_5,\r\n&hf_tn5250_wts_cld_flag3_6,\r\n&hf_tn5250_wts_cld_flag3_7,\r\nNULL\r\n};\r\nhf_items wts_line_data_fields[] = {\r\n{ &hf_tn5250_length, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wts_cld_flag1, ett_tn5250_wts_mask, 1, wts_cld_byte1, 0 },\r\n{ &hf_tn5250_wts_cld_flag2, ett_tn5250_wts_mask, 1, wts_cld_byte2, 0 },\r\n{ &hf_tn5250_wts_cld_row, 0, 2, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wts_cld_flag3, ett_tn5250_wts_mask, 1, wts_cld_byte3, 0 },\r\n{ &hf_tn5250_wts_cld_page_num, 0, 2, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wts_cld_lmo, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wts_cld_io, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_wts_cld_sli, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nhf_items dsc_fields[] = {\r\n{ &hf_tn5250_dsc_partition, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_dsc_sk, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_dsc_ev, 0, 1, 0, ENC_EBCDIC|ENC_NA },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nhf_items dorm_fields[] = {\r\n{ &hf_tn5250_dorm_length, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_dorm_ec, 0, 2, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nstatic const int *dfdpck_coreflag[] = {\r\n&hf_tn5250_dfdpck_coreflag_0,\r\n&hf_tn5250_dfdpck_coreflag_1,\r\n&hf_tn5250_dfdpck_coreflag_2,\r\n&hf_tn5250_dfdpck_coreflag_3,\r\n&hf_tn5250_dfdpck_coreflag_4,\r\n&hf_tn5250_dfdpck_coreflag_5,\r\n&hf_tn5250_dfdpck_coreflag_6,\r\n&hf_tn5250_dfdpck_coreflag_7,\r\nNULL\r\n};\r\nstatic const int *dfdpck_toprowflag1[] = {\r\n&hf_tn5250_dfdpck_toprowflag1_0,\r\n&hf_tn5250_dfdpck_toprowflag1_1,\r\n&hf_tn5250_dfdpck_toprowflag1_2,\r\n&hf_tn5250_dfdpck_toprowflag1_3,\r\n&hf_tn5250_dfdpck_toprowflag1_4,\r\n&hf_tn5250_dfdpck_toprowflag1_5,\r\n&hf_tn5250_dfdpck_toprowflag1_6,\r\n&hf_tn5250_dfdpck_toprowflag1_7,\r\nNULL\r\n};\r\nstatic const int *dfdpck_toprowflag2[] = {\r\n&hf_tn5250_dfdpck_toprowflag2_0,\r\n&hf_tn5250_dfdpck_toprowflag2_1,\r\n&hf_tn5250_dfdpck_toprowflag2_2,\r\n&hf_tn5250_dfdpck_toprowflag2_3,\r\n&hf_tn5250_dfdpck_toprowflag2_4,\r\n&hf_tn5250_dfdpck_toprowflag2_5,\r\n&hf_tn5250_dfdpck_toprowflag2_6,\r\n&hf_tn5250_dfdpck_toprowflag2_7,\r\nNULL\r\n};\r\nstatic const int *dfdpck_toprowflag3[] = {\r\n&hf_tn5250_dfdpck_toprowflag3_0,\r\n&hf_tn5250_dfdpck_toprowflag3_1,\r\n&hf_tn5250_dfdpck_toprowflag3_2,\r\n&hf_tn5250_dfdpck_toprowflag3_3,\r\n&hf_tn5250_dfdpck_toprowflag3_4,\r\n&hf_tn5250_dfdpck_toprowflag3_5,\r\n&hf_tn5250_dfdpck_toprowflag3_6,\r\n&hf_tn5250_dfdpck_toprowflag3_7,\r\nNULL\r\n};\r\nhf_items dfdpck_fields[] = {\r\n{ &hf_tn5250_dfdpck_partition, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nhf_items dfdpck_core_area_fields[] = {\r\n{ &hf_tn5250_length, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_dfdpck_data_field, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_dfdpck_coreflag, ett_tn5250_dfdpck_mask, 1, dfdpck_coreflag, 0 },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nhf_items dfdpck_top_row_fields[] = {\r\n{ &hf_tn5250_length, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_dfdpck_data_field, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_dfdpck_toprowflag1, ett_tn5250_dfdpck_mask, 1, dfdpck_toprowflag1, 0 },\r\n{ &hf_tn5250_dfdpck_toprowflag2, ett_tn5250_dfdpck_mask, 1, dfdpck_toprowflag2, 0 },\r\n{ &hf_tn5250_dfdpck_toprowflag3, ett_tn5250_dfdpck_mask, 1, dfdpck_toprowflag3, 0 },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nwhile (tvb_reported_length_remaining(tvb, offset) > 0 && !done) {\r\nsf_length = tvb_get_ntohs(tvb,offset);\r\ntype = tvb_get_guint8(tvb, offset+3);\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, standard_fields);\r\nswitch (type) {\r\ncase PASS_THROUGH:\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_field_data, tvb, offset,\r\n(sf_length - (start + offset)), ENC_EBCDIC|ENC_NA);\r\noffset += (guint32)(sf_length - (start + offset));\r\nbreak;\r\ncase TN5250_QUERY:\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_reserved, tvb, offset,\r\n1, ENC_BIG_ENDIAN);\r\noffset ++;\r\nbreak;\r\ncase TN5250_QUERY_STATION_STATE:\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, qss_fields);\r\nbreak;\r\ncase DEFINE_AUDIT_WINDOW__TABLE:\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_dawt_id, tvb, offset,\r\n1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nwhile ((offset - start) < sf_length) {\r\nlength = tvb_get_guint8(tvb,offset);\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, dawt_fields);\r\nif (length < 2) {\r\nbreak;\r\n}\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_dawt_message, tvb, offset,\r\n(length - 2), ENC_EBCDIC|ENC_NA);\r\noffset += length;\r\n}\r\nbreak;\r\ncase DEFINE_COMMAND_KEY_FUNCTION:\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_dckf_id, tvb, offset,\r\n1, ENC_BIG_ENDIAN);\r\noffset++;\r\nwhile ((offset - start) < sf_length) {\r\nlength = tvb_get_guint8(tvb,offset);\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset,\r\ndckf_fields);\r\nif (length < 2) {\r\nbreak;\r\n}\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_dckf_prompt_text, tvb,\r\noffset, (length - 2), ENC_EBCDIC|ENC_NA);\r\noffset += length;\r\n}\r\nbreak;\r\ncase READ_TEXT_SCREEN:\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, rts_fields);\r\nbreak;\r\ncase DEFINE_PENDING_OPERATIONS:\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, dpo_fields);\r\nbreak;\r\ncase DEFINE_TEXT_SCREEN_FORMAT:\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, dtsf_fields);\r\nbreak;\r\ncase DEFINE_SCALE_LINE:\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, dsl_fields);\r\nwhile ((offset - start) < sf_length) {\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, dsl_fields2);\r\n}\r\nbreak;\r\ncase WRITE_TEXT_SCREEN:\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset,\r\nwts_fields);\r\nlength = tvb_get_guint8(tvb,offset);\r\nused = tn5250_add_hf_items(tn5250_tree, tvb, offset,\r\nwts_line_data_fields);\r\noffset += used;\r\nif (length < used) {\r\nbreak;\r\n}\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_wts_cld_li, tvb, offset,\r\n(length - used), ENC_EBCDIC|ENC_NA);\r\nbreak;\r\ncase DEFINE_SPECIAL_CHARACTERS:\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset,\r\ndsc_fields);\r\nbreak;\r\ncase DEFINE_OPERATOR_ERROR_MESSAGES:\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_dorm_id, tvb, offset,\r\n1, ENC_BIG_ENDIAN);\r\noffset++;\r\nwhile ((offset - start) < sf_length) {\r\nlength = tvb_get_guint8(tvb,offset);\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset,\r\ndorm_fields);\r\nif (length < 2) {\r\nbreak;\r\n}\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_dorm_mt, tvb, offset,\r\n(length - 2), ENC_EBCDIC|ENC_NA);\r\noffset += length;\r\n}\r\nbreak;\r\ncase DEFINE_PITCH_TABLE:\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_dpt_id, tvb, offset,\r\n1, ENC_BIG_ENDIAN);\r\noffset++;\r\nwhile ((offset - start) < sf_length) {\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_length, tvb, offset,\r\n1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_dpt_ec, tvb, offset,\r\n4, ENC_EBCDIC|ENC_NA);\r\noffset += 4;\r\n}\r\nbreak;\r\ncase DEFINE_FAKE_DP_COMMAND_KEY_FUNCTION:\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset,\r\ndfdpck_fields);\r\nwhile ((offset - start) < sf_length) {\r\nlength = tvb_get_guint8(tvb,offset);\r\ntype = tvb_get_guint8(tvb,offset+1);\r\nif (type == CORE_AREA_COMMAND_KEYS) {\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset,\r\ndfdpck_core_area_fields);\r\n} else if (type == TOP_ROW_COMMAND_KEYS) {\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset,\r\ndfdpck_top_row_fields);\r\n} else {\r\nguint32 step;\r\nstep = dissect_unknown_data(tn5250_tree, tvb, offset, start, length);\r\nif (step==0)\r\nbreak;\r\noffset += step;\r\n}\r\n}\r\nbreak;\r\ndefault:\r\ndone = 1;\r\nbreak;\r\n}\r\n}\r\noffset += dissect_unknown_data(tn5250_tree, tvb, offset, start, sf_length);\r\nreturn (offset - start);\r\n}\r\nstatic guint32\r\ndissect_query_reply(proto_tree *tn5250_tree, tvbuff_t *tvb, gint offset)\r\n{\r\nint start = offset;\r\nstatic const int *byte[] = {\r\n&hf_tn5250_qr_flag_0,\r\n&hf_tn5250_qr_flag_reserved,\r\nNULL\r\n};\r\nstatic const int *byte1[] = {\r\n&hf_tn5250_qr_flag1_0,\r\n&hf_tn5250_qr_flag1_1,\r\n&hf_tn5250_qr_flag1_2,\r\n&hf_tn5250_qr_flag1_3,\r\n&hf_tn5250_qr_flag1_4,\r\n&hf_tn5250_qr_flag1_5,\r\n&hf_tn5250_qr_flag1_6,\r\n&hf_tn5250_qr_flag1_7,\r\nNULL\r\n};\r\nstatic const int *byte2[] = {\r\n&hf_tn5250_qr_flag2_0to3,\r\n&hf_tn5250_qr_flag2_4,\r\n&hf_tn5250_qr_flag2_5,\r\n&hf_tn5250_qr_flag2_6to7,\r\nNULL\r\n};\r\nhf_items qr_fields[] = {\r\n{ &hf_tn5250_sf_length, 0, 2, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_sf_class, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_sf_type, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_qr_flag, ett_tn5250_qr_mask, 1, byte, 0 },\r\n{ &hf_tn5250_qr_chc, 0, 2, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_qr_ccl, 0, 3, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_qr_dt, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_qr_dtc, 0, 4, 0, ENC_EBCDIC|ENC_NA },\r\n{ &hf_tn5250_qr_dm, 0, 3, 0, ENC_EBCDIC|ENC_NA },\r\n{ &hf_tn5250_qr_ki, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_qr_eki, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_qr_dsn, 0, 4, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_qr_mni, 0, 2, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_qr_flag1, ett_tn5250_qr_mask, 1, byte1, 0 },\r\n{ &hf_tn5250_qr_flag2, ett_tn5250_qr_mask, 1, byte2, 0 },\r\n{ &hf_tn5250_qr_flag3, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_qr_flag4, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, qr_fields);\r\nreturn (offset - start);\r\n}\r\nstatic guint32\r\ndissect_tn5250_header(proto_tree *tn5250_tree, tvbuff_t *tvb, gint offset)\r\n{\r\nint start=offset;\r\nint error_flag;\r\nstatic const int *byte[] = {\r\n&hf_tn5250_ds_output_error,\r\n&hf_tn5250_attn_key,\r\n&hf_tn5250_sys_request_key,\r\n&hf_tn5250_test_request_key,\r\n&hf_tn5250_error_state,\r\nNULL\r\n};\r\nhf_items fields[] = {\r\n{ &hf_tn5250_logical_record_length, 0, 2, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_sna_record_type, 0, 2, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_reserved, 0, 2, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_variable_record_length, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_header_flags, ett_tn5250_header_flags, 1, byte, 0 },\r\n{ &hf_tn5250_reserved, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ &hf_tn5250_operation_code, 0, 1, 0, ENC_BIG_ENDIAN },\r\n{ NULL, 0, 0, 0, 0 }\r\n};\r\nerror_flag = tvb_get_guint8(tvb, offset+8);\r\noffset += tn5250_add_hf_items(tn5250_tree, tvb, offset, fields);\r\nif (error_flag & 0x02) {\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_error_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic guint32\r\ndissect_outbound_stream(proto_tree *tn5250_tree, packet_info *pinfo, tvbuff_t *tvb, gint offset)\r\n{\r\ngint command_code;\r\ngint start = offset, length = 0;\r\nproto_tree *cc_tree;\r\nproto_item *ti, *item;\r\nti = proto_tree_add_item(tn5250_tree, hf_tn5250_escape_code, tvb, offset, 1,\r\nENC_BIG_ENDIAN);\r\noffset++;\r\ncc_tree = proto_item_add_subtree(ti, ett_cc);\r\ncommand_code = tvb_get_guint8(tvb, offset);\r\nitem = proto_tree_add_item(cc_tree, hf_tn5250_command_code, tvb, offset, 1,\r\nENC_BIG_ENDIAN);\r\noffset++;\r\nswitch (command_code) {\r\ncase CLEAR_UNIT:\r\ncase CLEAR_FORMAT_TABLE:\r\nbreak;\r\ncase CLEAR_UNIT_ALTERNATE:\r\nproto_tree_add_item(cc_tree, hf_tn5250_cua_parm, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nbreak;\r\ncase WRITE_TO_DISPLAY:\r\noffset += dissect_wcc(cc_tree, tvb, offset);\r\noffset += dissect_tn5250_orders_and_data(cc_tree, tvb, offset);\r\nbreak;\r\ncase WRITE_ERROR_CODE:\r\noffset += dissect_tn5250_orders_and_data(cc_tree, tvb, offset);\r\nproto_tree_add_item(cc_tree, hf_tn5250_fa, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(cc_tree, hf_tn5250_field_data, tvb, offset,\r\ntvb_reported_length_remaining(tvb, offset) - 1,\r\nENC_EBCDIC|ENC_NA);\r\noffset += (guint32)(tvb_reported_length_remaining(tvb, offset) - 1);\r\nproto_tree_add_item(cc_tree, hf_tn5250_fa, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nbreak;\r\ncase RESTORE_SCREEN:\r\nwhile (tvb_reported_length_remaining(tvb, offset) > 0) {\r\noffset += dissect_outbound_stream(cc_tree, pinfo, tvb, offset);\r\n}\r\nbreak;\r\ncase WRITE_ERROR_CODE_TO_WINDOW:\r\nproto_tree_add_item(cc_tree, hf_tn5250_wectw_start_column, tvb, offset,\r\n1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(cc_tree, hf_tn5250_wectw_end_column, tvb, offset, 1,\r\nENC_BIG_ENDIAN);\r\noffset++;\r\nbreak;\r\ncase READ_INPUT_FIELDS:\r\ncase READ_MDT_FIELDS:\r\ncase READ_MDT_ALTERNATE:\r\noffset += dissect_wcc(cc_tree, tvb, offset);\r\nbreak;\r\ncase READ_SCREEN:\r\ncase READ_SCREEN_WITH_EXTENDED_ATTRIBUTES:\r\ncase READ_SCREEN_TO_PRINT:\r\ncase READ_SCREEN_TO_PRINT_WITH_EXTENDED_ATTRIBUTES:\r\ncase READ_SCREEN_TO_PRINT_WITH_GRIDLINES:\r\ncase READ_SCREEN_TO_PRINT_WITH_EXTENDED_ATTRIBUTES_AND_GRIDLINES:\r\ncase READ_IMMEDIATE:\r\ncase READ_MODIFIED_IMMEDIATE_ALTERNATE:\r\ncase SAVE_SCREEN:\r\nbreak;\r\ncase SAVE_PARTIAL_SCREEN:\r\noffset += dissect_save_partial_screen(cc_tree, tvb, offset);\r\nbreak;\r\ncase RESTORE_PARTIAL_SCREEN:\r\nlength = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_item(cc_tree, hf_tn5250_length_twobyte, tvb, offset, 2,\r\nENC_BIG_ENDIAN);\r\noffset++;\r\noffset += dissect_tn5250_orders_and_data(cc_tree, tvb, offset);\r\nproto_tree_add_item(cc_tree, hf_tn5250_field_data, tvb, offset,\r\n(length - 2), ENC_EBCDIC|ENC_NA);\r\noffset++;\r\nbreak;\r\ncase ROLL:\r\noffset += dissect_roll(cc_tree, tvb, offset);\r\nbreak;\r\ncase WRITE_SINGLE_STRUCTURED_FIELD:\r\noffset += dissect_write_single_structured_field(cc_tree, tvb, offset);\r\nbreak;\r\ncase WRITE_STRUCTURED_FIELD:\r\noffset += dissect_write_structured_field(cc_tree, tvb, offset);\r\nbreak;\r\ncase COPY_TO_PRINTER:\r\nproto_tree_add_item(cc_tree, hf_tn5250_ctp_lsid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(cc_tree, hf_tn5250_ctp_mlpp, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nbreak;\r\ndefault:\r\nexpert_add_info(pinfo, item, &ei_tn5250_command_code);\r\noffset ++;\r\nbreak;\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic guint32\r\ndissect_inbound_stream(proto_tree *tn5250_tree, packet_info *pinfo, tvbuff_t *tvb, gint offset, gint sna_flag)\r\n{\r\ngint start = offset, aid;\r\nguint32 commands;\r\nif (sna_flag & 0x01) {\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_error_code, tvb, offset, 2,\r\nENC_BIG_ENDIAN);\r\noffset+=2;\r\nreturn (offset - start);\r\n} else if (sna_flag & 0x80) {\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_negative_response,\r\ntvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset+=4;\r\nreturn (offset - start);\r\n}\r\naid = tvb_get_guint8(tvb,offset+2);\r\nif (tn5250_is_valid_aid(aid)) {\r\nswitch(aid) {\r\ncase AID_IMAGE_FAX_REQUEST:\r\ncase AID_UNKNOWN_IMAGE_FAX_FORMAT:\r\ncase AID_IMAGE_FAX_ERROR:\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_image_fax_error, tvb, offset,\r\n2, ENC_BIG_ENDIAN);\r\noffset+=2;\r\nbreak;\r\ndefault:\r\noffset += dissect_row_column(tn5250_tree, tvb, offset);\r\nbreak;\r\n}\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_aid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nif (aid == AID_INBOUND_WRITE_STRUCTURED_FIELD) {\r\noffset += dissect_query_reply(tn5250_tree, tvb, offset);\r\nreturn (offset - start);\r\n}\r\noffset += dissect_tn5250_orders_and_data(tn5250_tree, tvb, offset);\r\n} else {\r\nif (tvb_get_guint8(tvb,offset) == TN5250_ESCAPE) {\r\ncommands = dissect_outbound_stream(tn5250_tree, pinfo, tvb, offset);\r\nif (commands) {\r\noffset += commands;\r\nif (tvb_reported_length_remaining(tvb, offset)) {\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_unknown_data, tvb, offset,\r\ntvb_reported_length_remaining(tvb, offset), ENC_NA);\r\noffset += tvb_reported_length_remaining(tvb, offset);\r\n}\r\nreturn (offset - start);\r\n}\r\n}\r\n}\r\nif (tvb_reported_length_remaining(tvb, offset)) {\r\nproto_tree_add_item(tn5250_tree, hf_tn5250_field_data, tvb, offset,\r\ntvb_reported_length_remaining(tvb, offset),\r\nENC_EBCDIC|ENC_NA);\r\noffset += tvb_reported_length_remaining(tvb, offset);\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic int\r\ndissect_tn5250(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nproto_tree *tn5250_tree;\r\nproto_item *ti;\r\ngint offset = 0;\r\nconversation_t *conversation;\r\ntn5250_conv_info_t *tn5250_info = NULL;\r\nint sna_flag;\r\nconversation = find_conversation(pinfo->num, &pinfo->src, &pinfo->dst,\r\npinfo->ptype, pinfo->srcport,\r\npinfo->destport, 0);\r\nif (conversation != NULL) {\r\ntn5250_info = (tn5250_conv_info_t *)conversation_get_proto_data(conversation, proto_tn5250);\r\n}\r\nif (!tn5250_info)\r\nreturn 0;\r\npinfo->fd->flags.encoding = PACKET_CHAR_ENC_CHAR_EBCDIC;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "TN5250");\r\nti = proto_tree_add_item(tree, proto_tn5250, tvb, offset, -1, ENC_NA);\r\ntn5250_tree = proto_item_add_subtree(ti, ett_tn5250);\r\nif (pinfo->srcport == tn5250_info->outbound_port) {\r\ncol_set_str(pinfo->cinfo, COL_INFO, "TN5250 Data from Mainframe");\r\n} else {\r\ncol_set_str(pinfo->cinfo, COL_INFO, "TN5250 Data to Mainframe");\r\n}\r\nif (tree) {\r\nsna_flag = tvb_get_ntohs(tvb, offset+6);\r\noffset += dissect_tn5250_header(tn5250_tree, tvb, offset);\r\nwhile (tvb_reported_length_remaining(tvb, offset) > 0) {\r\nif (pinfo->srcport == tn5250_info->outbound_port) {\r\noffset += dissect_outbound_stream(tn5250_tree, pinfo, tvb, offset);\r\n} else {\r\noffset += dissect_inbound_stream(tn5250_tree, pinfo, tvb, offset, sna_flag);\r\n}\r\n}\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nadd_tn5250_conversation(packet_info *pinfo, int tn5250e)\r\n{\r\nconversation_t *conversation;\r\ntn5250_conv_info_t *tn5250_info = NULL;\r\nconversation = find_or_create_conversation(pinfo);\r\ntn5250_info = (tn5250_conv_info_t *)conversation_get_proto_data(conversation, proto_tn5250);\r\nif (tn5250_info == NULL) {\r\ntn5250_info = wmem_new(wmem_file_scope(), tn5250_conv_info_t);\r\ncopy_address_wmem(wmem_file_scope(), &(tn5250_info->outbound_addr),&(pinfo->dst));\r\ntn5250_info->outbound_port = pinfo->destport;\r\ncopy_address_wmem(wmem_file_scope(), &(tn5250_info->inbound_addr),&(pinfo->src));\r\ntn5250_info->inbound_port = pinfo->srcport;\r\nconversation_add_proto_data(conversation, proto_tn5250, tn5250_info);\r\ntn5250_info->next = tn5250_info_items;\r\ntn5250_info_items = tn5250_info;\r\n}\r\ntn5250_info->extended = tn5250e;\r\n}\r\nint\r\nfind_tn5250_conversation(packet_info *pinfo)\r\n{\r\nconversation_t *conversation = NULL;\r\ntn5250_conv_info_t *tn5250_info = NULL;\r\nconversation = find_conversation(pinfo->num, &pinfo->src, &pinfo->dst,\r\npinfo->ptype, pinfo->srcport,\r\npinfo->destport, 0);\r\nif (conversation != NULL) {\r\ntn5250_info = (tn5250_conv_info_t *)conversation_get_proto_data(conversation, proto_tn5250);\r\nif (tn5250_info != NULL) {\r\nreturn 1;\r\n}\r\n}\r\nreturn 0;\r\n}\r\nvoid\r\nproto_register_tn5250(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_tn5250_escape_code,\r\n{ "Escape Code", "tn5250.escape_code",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_escape_codes), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_command_code,\r\n{ "Command Code", "tn5250.command_code",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_command_codes), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_sf_length,\r\n{ "Structured Field Length", "tn5250.sf_length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_sf_class,\r\n{ "Structured Field Class", "tn5250.class",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_sf_class), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_sf_type,\r\n{ "Structured Field Type", "tn5250.type",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_sf_type), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_cua_parm,\r\n{ "TN5250 CUA Parameter", "tn5250.cua_parm",\r\nFT_UINT16, BASE_HEX, VALS(vals_tn5250_cua_parms), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wtd_ccc1,\r\n{"Write To Display Command Control Character Byte 1", "tn5250.wtd_ccc1",\r\nFT_UINT8, BASE_HEX,\r\nVALS (vals_tn5250_wtd_cc_byteone), CCBITS, NULL, HFILL}},\r\n{ &hf_tn5250_wtd_ccc2,\r\n{ "Write To Display Command Control Character Byte 2", "tn5250.wtd_ccc2",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wtd_ccc2_res,\r\n{ "Reserved",\r\n"tn5250.wtd_ccc_reserved", FT_BOOLEAN, 8, NULL, 0x80, NULL, HFILL }},\r\n{ &hf_tn5250_wtd_ccc2_cursor,\r\n{ "Cursor does not move when keyboard unlocks",\r\n"tn5250.wtd_ccc_cursor", FT_BOOLEAN, 8, NULL, 0x40, NULL, HFILL }},\r\n{ &hf_tn5250_wtd_ccc2_reset,\r\n{ "Reset blinking cursor",\r\n"tn5250.wtd_ccc_reset", FT_BOOLEAN, 8, NULL, 0x20, NULL, HFILL }},\r\n{ &hf_tn5250_wtd_ccc2_set,\r\n{ "Set blinking cursor",\r\n"tn5250.wtd_ccc_set", FT_BOOLEAN, 8, NULL, 0x10, NULL, HFILL }},\r\n{ &hf_tn5250_wtd_ccc2_unlock,\r\n{ "Unlock the keyboard and reset any pending AID bytes",\r\n"tn5250.wtd_ccc_unlock", FT_BOOLEAN, 8, NULL, 0x08, NULL, HFILL }},\r\n{ &hf_tn5250_wtd_ccc2_alarm,\r\n{ "Sound Alarm",\r\n"tn5250.wtd_ccc_alarm", FT_BOOLEAN, 8, NULL, 0x04, NULL, HFILL }},\r\n{ &hf_tn5250_wtd_ccc2_off,\r\n{ "Set Message Waiting indicator off",\r\n"tn5250.wtd_ccc_off", FT_BOOLEAN, 8, NULL, 0x02, NULL, HFILL }},\r\n{ &hf_tn5250_wtd_ccc2_on,\r\n{ "Set Message Waiting indicator on",\r\n"tn5250.wtd_ccc_on", FT_BOOLEAN, 8, NULL, 0x01, NULL, HFILL }},\r\n{ &hf_tn5250_repeated_character,\r\n{ "Repeated Character", "tn5250.repeated_character",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_soh_length,\r\n{ "Length", "tn5250.soh_length",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_soh_flags,\r\n{ "Start of Header Flags", "tn5250.soh_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_soh_cursor_direction,\r\n{ "Right To Left Screen-Level Cursor Direction", "tn5250.soh_cursor_direction",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_soh_screen_reverse,\r\n{ "Automatic local screen reverse", "tn5250.soh_screen_reverse",\r\nFT_BOOLEAN, 8, NULL, 0x20,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_soh_input_capable_only,\r\n{ "The cursor is allowed to move only to input-capable positions", "tn5250.soh_input_capable_only",\r\nFT_BOOLEAN, 8, NULL, 0x10,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_soh_pf24to17, { "Command Key Switch 1", "tn5250.soh_pf24to17",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n{ &hf_tn5250_soh_pf24, { "PF24", "tn5250.soh_pf24",\r\nFT_BOOLEAN, 8, NULL, 0x80, NULL, HFILL }},\r\n{ &hf_tn5250_soh_pf23, { "PF22", "tn5250.soh_pf23",\r\nFT_BOOLEAN, 8, NULL, 0x40, NULL, HFILL }},\r\n{ &hf_tn5250_soh_pf22, { "PF22", "tn5250.soh_pf22",\r\nFT_BOOLEAN, 8, NULL, 0x20, NULL, HFILL }},\r\n{ &hf_tn5250_soh_pf21, { "PF21", "tn5250.soh_pf21",\r\nFT_BOOLEAN, 8, NULL, 0x10, NULL, HFILL }},\r\n{ &hf_tn5250_soh_pf20, { "PF20", "tn5250.soh_pf20",\r\nFT_BOOLEAN, 8, NULL, 0x08, NULL, HFILL }},\r\n{ &hf_tn5250_soh_pf19, { "PF19", "tn5250.soh_pf19",\r\nFT_BOOLEAN, 8, NULL, 0x04, NULL, HFILL }},\r\n{ &hf_tn5250_soh_pf18, { "PF18", "tn5250.soh_pf18",\r\nFT_BOOLEAN, 8, NULL, 0x02, NULL, HFILL }},\r\n{ &hf_tn5250_soh_pf17, { "PF17", "tn5250.soh_pf17",\r\nFT_BOOLEAN, 8, NULL, 0x01, NULL, HFILL }},\r\n{ &hf_tn5250_soh_pf16to9, { "Command Key Switch 2", "tn5250.soh_pf16to9",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n{ &hf_tn5250_soh_pf16, { "PF16", "tn5250.soh_pf16",\r\nFT_BOOLEAN, 8, NULL, 0x80, NULL, HFILL }},\r\n{ &hf_tn5250_soh_pf15, { "PF15", "tn5250.soh_pf15",\r\nFT_BOOLEAN, 8, NULL, 0x40, NULL, HFILL }},\r\n{ &hf_tn5250_soh_pf14, { "PF14", "tn5250.soh_pf14",\r\nFT_BOOLEAN, 8, NULL, 0x20, NULL, HFILL }},\r\n{ &hf_tn5250_soh_pf13, { "PF13", "tn5250.soh_pf13",\r\nFT_BOOLEAN, 8, NULL, 0x10, NULL, HFILL }},\r\n{ &hf_tn5250_soh_pf12, { "PF12", "tn5250.soh_pf12",\r\nFT_BOOLEAN, 8, NULL, 0x08, NULL, HFILL }},\r\n{ &hf_tn5250_soh_pf11, { "PF11", "tn5250.soh_pf11",\r\nFT_BOOLEAN, 8, NULL, 0x04, NULL, HFILL }},\r\n{ &hf_tn5250_soh_pf10, { "PF10", "tn5250.soh_pf10",\r\nFT_BOOLEAN, 8, NULL, 0x02, NULL, HFILL }},\r\n{ &hf_tn5250_soh_pf9, { "PF9", "tn5250.soh_pf9",\r\nFT_BOOLEAN, 8, NULL, 0x01, NULL, HFILL }},\r\n{ &hf_tn5250_soh_pf8to1, { "Command Key Switch 3", "tn5250.soh_pf8to1",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n{ &hf_tn5250_soh_pf8, { "PF8", "tn5250.soh_pf8",\r\nFT_BOOLEAN, 8, NULL, 0x80, NULL, HFILL }},\r\n{ &hf_tn5250_soh_pf7, { "PF7", "tn5250.soh_pf7",\r\nFT_BOOLEAN, 8, NULL, 0x40, NULL, HFILL }},\r\n{ &hf_tn5250_soh_pf6, { "PF6", "tn5250.soh_pf6",\r\nFT_BOOLEAN, 8, NULL, 0x20, NULL, HFILL }},\r\n{ &hf_tn5250_soh_pf5, { "PF5", "tn5250.soh_pf5",\r\nFT_BOOLEAN, 8, NULL, 0x10, NULL, HFILL }},\r\n{ &hf_tn5250_soh_pf4, { "PF4", "tn5250.soh_pf4",\r\nFT_BOOLEAN, 8, NULL, 0x08, NULL, HFILL }},\r\n{ &hf_tn5250_soh_pf3, { "PF3", "tn5250.soh_pf3",\r\nFT_BOOLEAN, 8, NULL, 0x04, NULL, HFILL }},\r\n{ &hf_tn5250_soh_pf2, { "PF2", "tn5250.soh_pf2",\r\nFT_BOOLEAN, 8, NULL, 0x02, NULL, HFILL }},\r\n{ &hf_tn5250_soh_pf1, { "PF1", "tn5250.soh_pf1",\r\nFT_BOOLEAN, 8, NULL, 0x01, NULL, HFILL }},\r\n{ &hf_tn5250_soh_resq, { "Resequence to Field", "tn5250.soh_resq",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_tn5250_soh_err, { "Error Row", "tn5250.soh_err",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_tn5250_wea_prim_attr,\r\n{ "Extended Primary Attributes", "tn5250.wea_prim_attr",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wea_prim_attr_flag,\r\n{ "Attribute Change",\r\n"tn5250.wea_prim_attr_flag", FT_BOOLEAN, 8, NULL,\r\n0x80, NULL, HFILL }},\r\n{ &hf_tn5250_wea_prim_attr_col,\r\n{ "Column Separator",\r\n"tn5250.wea_prim_attr_col", FT_BOOLEAN, 8,\r\nTFS(&tn5250_field_attr_col), 0x10, NULL, HFILL }},\r\n{ &hf_tn5250_wea_prim_attr_blink,\r\n{ "Blink",\r\n"tn5250.wea_prim_attr_blink", FT_BOOLEAN, 8,\r\nTFS(&tn5250_field_attr_blink), 0x08, NULL, HFILL }},\r\n{ &hf_tn5250_wea_prim_attr_und,\r\n{ "Underscore",\r\n"tn5250.wea_prim_attr_und", FT_BOOLEAN, 8,\r\nTFS(&tn5250_field_attr_und), 0x04, NULL, HFILL }},\r\n{ &hf_tn5250_wea_prim_attr_int,\r\n{ "Intensity",\r\n"tn5250.wea_prim_attr_int", FT_BOOLEAN, 8,\r\nTFS(&tn5250_field_attr_int), 0x02, NULL, HFILL }},\r\n{ &hf_tn5250_wea_prim_attr_rev,\r\n{ "Reverse Image",\r\n"tn5250.wea_prim_attr_rev", FT_BOOLEAN, 8,\r\nTFS(&tn5250_field_attr_rev), 0x01, NULL, HFILL }},\r\n{ &hf_tn5250_foreground_color_attr,\r\n{ "Foreground Color Attribute", "tn5250.foreground_color_attr",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_foreground_color_attributes), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_ideographic_attr,\r\n{ "Ideographic Attribute", "tn5250.ideographic_attr",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_ideographic_attributes), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_ffw,\r\n{ "Field Format Word", "tn5250.ffw",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_ffw_id,\r\n{ "Field Format Word ID", "tn5250.ffw_id", FT_UINT8, BASE_HEX,\r\nVALS(vals_tn5250_ffw_id), FFW_ID_BITS, NULL, HFILL }},\r\n{ &hf_tn5250_ffw_bypass,\r\n{ "Bypass", "tn5250.ffw_bypass",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_ffw_bypass),\r\n0x20, NULL, HFILL }},\r\n{ &hf_tn5250_ffw_dup,\r\n{ "Dupe or Field Mark Enable", "tn5250.ffw_dup",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_ffw_dup),\r\n0x10, NULL, HFILL }},\r\n{ &hf_tn5250_ffw_mdt,\r\n{ "Modified Data Tag", "tn5250.ffw_mdt",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_ffw_mdt),\r\n0x08, NULL, HFILL }},\r\n{ &hf_tn5250_ffw_shift,\r\n{ "Field Shift/Edit Specification", "tn5250.ffw_shift", FT_UINT8, BASE_HEX,\r\nVALS(vals_tn5250_ffw_shift), FFW_SHIFT_BITS, NULL, HFILL }},\r\n{ &hf_tn5250_ffw_auto,\r\n{ "Auto Enter", "tn5250.ffw_auto",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_ffw_auto),\r\n0x80, NULL, HFILL }},\r\n{ &hf_tn5250_ffw_fer,\r\n{ "Field Exit Required", "tn5250.ffw_fer",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_ffw_fer),\r\n0x40, NULL, HFILL }},\r\n{ &hf_tn5250_ffw_monocase,\r\n{ "Monocase", "tn5250.ffw_monocase",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_ffw_monocase),\r\n0x20, NULL, HFILL }},\r\n{ &hf_tn5250_ffw_res,\r\n{ "Reserved", "tn5250.ffw_res",\r\nFT_BOOLEAN, 8, NULL,\r\n0x10, NULL, HFILL }},\r\n{ &hf_tn5250_ffw_me,\r\n{ "Mandatory Enter", "tn5250.ffw_me",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_ffw_me),\r\n0x08, NULL, HFILL }},\r\n{ &hf_tn5250_ffw_adjust,\r\n{ "Right Adjust/Mandatory Fill", "tn5250.ffw_adjust", FT_UINT8, BASE_HEX,\r\nVALS(vals_tn5250_ffw_adjust), FFW_ADJUST_BITS, NULL, HFILL }},\r\n{ &hf_tn5250_fcw,\r\n{ "Field Control Word", "tn5250.fcw",\r\nFT_UINT16, BASE_HEX|BASE_RANGE_STRING, RVALS(vals_tn5250_fcw), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_fa_color,\r\n{ "Field Attribute (Color)", "tn5250.fa_color",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_fa,\r\n{ "Field Attributes", "tn5250.sf_fa",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_sf_attr_flag,\r\n{ "Attribute ID",\r\n"tn5250.sf_attr_flag", FT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_id), FA_ID_BITS, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cw_flag1,\r\n{ "Flags", "tn5250.wdsf_cw_flag1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cw_flag1_1,\r\n{ "Flag 1", "tn5250.wdsf_cw_flag1_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_cw_flag1_1),\r\n0x80, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cw_flag1_2,\r\n{ "Flag 2", "tn5250.wdsf_cw_flag1_2",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_cw_flag1_2),\r\n0x40, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cw_flag1_reserved,\r\n{ "Reserved", "tn5250.wdsf_cw_flag1_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0x3F, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cw_wd,\r\n{ "Window Depth", "tn5250.wdsf_cw_wd",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cw_ww,\r\n{ "Window Width", "tn5250.wdsf_cw_ww",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cw_minor_type,\r\n{ "Minor Structured Field Type", "tn5250.wdsf_cw_minor_type",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_wdsf_cw_minor_type), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cw_bp_flag1,\r\n{ "Flags", "tn5250.wdsf_cw_bp_flag1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cw_bp_flag1_1,\r\n{ "Flag 1", "tn5250.wdsf_cw_bp_flag1_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_cw_bp_flag1_1),\r\n0x80, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cw_bp_flag1_reserved,\r\n{ "Reserved", "tn5250.wdsf_cw_bp_flag1_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0x7F, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cw_bp_mba,\r\n{ "Monochrome Border Attribute", "tn5250.wdsf_cw_bp_mba",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cw_bp_cba,\r\n{ "Color Border Attribute", "tn5250.wdsf_cw_bp_cba",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cw_bp_ulbc,\r\n{ "Upper Left Border Character", "tn5250.wdsf_cw_bp_ulbc",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cw_bp_tbc,\r\n{ "Top Border Character", "tn5250.wdsf_cw_bp_tbc",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cw_bp_urbc,\r\n{ "Upper Right Border Character", "tn5250.wdsf_cw_bp_urbc",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cw_bp_lbc,\r\n{ "Left Border Character", "tn5250.wdsf_cw_bp_lbc",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cw_bp_rbc,\r\n{ "Right Border Character", "tn5250.wdsf_cw_bp_rbc",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cw_bp_llbc,\r\n{ "Lower Left Border Character", "tn5250.wdsf_cw_bp_llbc",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cw_bp_bbc,\r\n{ "Bottom Border Character", "tn5250.wdsf_cw_bp_bbc",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cw_bp_lrbc,\r\n{ "Lower Right Border Character", "tn5250.wdsf_cw_bp_lrbc",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cw_tf_flag,\r\n{ "Flags", "tn5250.wdsf_cw_tf_flag",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cw_tf_flag_orientation,\r\n{ "Orientation", "tn5250.wdsf_cw_tf_flag_orientation", FT_UINT8, BASE_HEX,\r\nVALS(vals_tn5250_wdsf_cw_tf_flag_orientation), WTF_BITS, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cw_tf_flag_1,\r\n{ "Title/Footer Defined", "tn5250.wdsf_cw_tf_flag_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_cw_tf_flag_1),\r\n0x20, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cw_tf_flag_reserved,\r\n{ "Reserved", "tn5250.wdsf_cw_tf_flag_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0xF8, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cw_tf_mba,\r\n{ "Monochrome Title/Footer Attribute", "tn5250.wdsf_cw_tf_mba",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cw_tf_cba,\r\n{ "Color Title/Footer Attribute", "tn5250.wdsf_cw_tf_cba",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cw_tf_text,\r\n{ "Title Text", "tn5250.wdsf_cw_tf_text",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_rgw_flag1,\r\n{ "Flags", "tn5250.wdsf_rgw_flag",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_rgw_flag1_0,\r\n{ "Reserved", "tn5250.wdsf_rgw_flag1_0",\r\nFT_BOOLEAN, 8, NULL,\r\n0x80, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_rgw_flag1_1,\r\n{ "Window Pull-Down", "tn5250.wdsf_rgw_flag1_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_cw_flag1_2),\r\n0x40, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_rgw_reserved,\r\n{ "Reserved", "tn5250.wdsf_rgw_flag_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0x3F, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ragc_flag1,\r\n{ "Flags", "tn5250.wdsf_ragc_flag",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ragc_flag1_0,\r\n{ "GUI-Like Characters", "tn5250.wdsf_ragc_flag1_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ragc_flag1_0),\r\n0x80, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ragc_reserved,\r\n{ "Reserved", "tn5250.wdsf_ragc_flag_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0x7F, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_flag1,\r\n{ "Flags", "tn5250.wdsf_ds_flag1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_flag1_mouse_characteristics,\r\n{ "Mouse Characteristics", "tn5250.wdsf_ds_flag1_mouse_characteristics", FT_UINT8, BASE_HEX,\r\nVALS(vals_tn5250_wdsf_ds_flag1_mouse_characteristics), MOUSE_CHARACTERISTICS_BITS, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_flag1_reserved,\r\n{ "Reserved", "tn5250.wdsf_ds_flag1_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0x0C, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_flag1_auto_enter,\r\n{ "Mouse Characteristics", "tn5250.wdsf_ds_flag1_auto_enter", FT_UINT8, BASE_HEX,\r\nVALS(vals_tn5250_wdsf_ds_flag1_auto_enter), DS_AUTO_ENTER_BITS, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_flag1_1,\r\n{ "Auto Select", "tn5250.wdsf_ds_flag1_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_flag1_1),\r\n0x40, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_flag1_2,\r\n{ "Field MDT", "tn5250.wdsf_ds_flag1_2",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_flag1_2),\r\n0x80, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_flag2,\r\n{ "Flags", "tn5250.wdsf_ds_flag2",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_flag2_1,\r\n{ "Bit 0", "tn5250.wdsf_ds_flag2_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_flag2_1),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_flag2_2,\r\n{ "Bit 1", "tn5250.wdsf_ds_flag2_2",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_flag2_2),\r\n0x02, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_flag2_3,\r\n{ "Bit 2", "tn5250.wdsf_ds_flag2_3",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_flag2_3),\r\n0x04, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_flag2_4,\r\n{ "Bit 3", "tn5250.wdsf_ds_flag2_4",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_flag2_4),\r\n0x08, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_flag2_5,\r\n{ "Bit 4", "tn5250.wdsf_ds_flag2_5",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_flag2_5),\r\n0x10, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_flag2_6,\r\n{ "Bit 5", "tn5250.wdsf_ds_flag2_6",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_flag2_6),\r\n0x20, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_flag2_reserved,\r\n{ "Reserved", "tn5250.wdsf_ds_flag2_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0xC0, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_flag3,\r\n{ "Flags", "tn5250.wdsf_ds_flag3",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_flag3_1,\r\n{ "Bit 0", "tn5250.wdsf_ds_flag3_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_flag3_1),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_flag3_reserved,\r\n{ "Reserved", "tn5250.wdsf_ds_flag3_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0xFE, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_type,\r\n{ "Type of Selection Field", "tn5250.wdsf_ds_type",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_wdsf_ds_type), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_gdc,\r\n{ "GUI Device Characteristics", "tn5250.wdsf_ds_gdc",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_gdc_indicators,\r\n{ "Indicators", "tn5250.wdsf_ds_gdc_indicators", FT_UINT8, BASE_HEX,\r\nVALS(vals_tn5250_wdsf_ds_gdc_indicators), DS_INDICATORS_BITS, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_gdc_reserved,\r\n{ "Reserved", "tn5250.wdsf_ds_gdc_reserved", FT_BOOLEAN, 8,\r\nNULL, 0x10, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_gdc_selection_techniques,\r\n{ "Selection Techniques", "tn5250.wdsf_ds_gdc_selection_techniques", FT_UINT8, BASE_HEX,\r\nVALS(vals_tn5250_wdsf_ds_gdc_selection_techniques), DS_SELECTION_TECHNIQUES_BITS, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_nws,\r\n{ "NWS With Mnemonic Underscore Characteristics", "tn5250.wdsf_ds_nws",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_nws_indicators,\r\n{ "Indicators", "tn5250.wdsf_ds_nws_indicators", FT_UINT8, BASE_HEX,\r\nVALS(vals_tn5250_wdsf_ds_nws_indicators), DS_NWS_INDICATORS_BITS, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_nws_reserved,\r\n{ "Reserved", "tn5250.wdsf_ds_nws_reserved", FT_BOOLEAN, 8,\r\nNULL, 0x10, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_nws_selection_techniques,\r\n{ "Selection Techniques", "tn5250.wdsf_ds_nws_selection_techniques", FT_UINT8, BASE_HEX,\r\nVALS(vals_tn5250_wdsf_ds_nws_selection_techniques), DS_NWS_SELECTION_TECHNIQUES_BITS, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_nws_wout,\r\n{ "NWS Without Mnemonic Underscore Characteristics", "tn5250.wdsf_ds_nws_wout",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_textsize,\r\n{ "Text Size", "tn5250.wdsf_ds_textsize",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_rows,\r\n{ "Rows", "tn5250.wdsf_ds_rows",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_columns,\r\n{ "Columns/Menu Bar Choices", "tn5250.wdsf_ds_columns",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_padding,\r\n{ "Padding Between Choices", "tn5250.wdsf_ds_padding",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_numeric_sep,\r\n{ "Numeric Separator Character", "tn5250.wdsf_ds_numeric_sep",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_country_sel,\r\n{ "Country Specific Selection Character", "tn5250.wdsf_ds_country_sel",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_cancel_aid,\r\n{ "Mouse Pull-Down Cancel AID", "tn5250.wdsf_ds_cancel_aid",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_totalrows,\r\n{ "Total Rows or Minor Structures That Can Be Scrolled", "tn5250.wdsf_ds_totalrows",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_sliderpos,\r\n{ "Slider Positions That Can Be Scrolled", "tn5250.wdsf_ds_sliderpos",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_minor_type,\r\n{ "Minor Structured Field Type", "tn5250.wdsf_ds_minor_type",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_wdsf_ds_minor_type), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ct_flag1,\r\n{ "Flag Byte 1", "tn5250.wdsf_ds_ct_flag1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ct_flag1_choice_state,\r\n{ "Choice State", "tn5250.wdsf_ds_ct_flag1_choice_state", FT_UINT8, BASE_HEX,\r\nVALS(vals_tn5250_wdsf_ds_ct_flag1_choice_state), DS_CHOICE_STATE_BITS, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ct_flag1_2,\r\n{ "Bit 2", "tn5250.wdsf_ds_ct_flag1_2",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_ct_flag1_2),\r\n0x04, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ct_flag1_3,\r\n{ "Bit 3", "tn5250.wdsf_ds_ct_flag1_3",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_ct_flag1_3),\r\n0x08, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ct_flag1_4,\r\n{ "Bit 4", "tn5250.wdsf_ds_ct_flag1_4",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_ct_flag1_4),\r\n0x10, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ct_flag1_5,\r\n{ "Bit 5", "tn5250.wdsf_ds_ct_flag1_5",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_ct_flag1_5),\r\n0x20, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ct_flag1_numeric_selection,\r\n{ "Numeric Selection Characters", "tn5250.wdsf_ds_ct_flag1_numeric_selection", FT_UINT8, BASE_HEX,\r\nVALS(vals_tn5250_wdsf_ds_ct_flag1_numeric_selection), DS_NUMERIC_SELECTION_BITS, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ct_flag2,\r\n{ "Flag Byte 2", "tn5250.wdsf_ds_ct_flag2",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ct_flag2_0,\r\n{ "Bit 0", "tn5250.wdsf_ds_ct_flag2_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_ct_flag2_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ct_flag2_1,\r\n{ "Bit 1", "tn5250.wdsf_ds_ct_flag2_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_ct_flag2_1),\r\n0x02, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ct_flag2_2,\r\n{ "Bit 2", "tn5250.wdsf_ds_ct_flag2_2",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_ct_flag2_2),\r\n0x04, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ct_flag2_3,\r\n{ "Bit 3", "tn5250.wdsf_ds_ct_flag2_3",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_ct_flag2_3),\r\n0x08, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ct_flag2_4,\r\n{ "Bit 4", "tn5250.wdsf_ds_ct_flag2_4",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_ct_flag2_4),\r\n0x10, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ct_flag2_5,\r\n{ "Bit 5", "tn5250.wdsf_ds_ct_flag2_5",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_ct_flag2_5),\r\n0x20, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ct_flag2_6,\r\n{ "Bit 6", "tn5250.wdsf_ds_ct_flag2_6",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_ct_flag2_6),\r\n0x40, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ct_flag2_7,\r\n{ "Bit 7", "tn5250.wdsf_ds_ct_flag2_7",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_ct_flag2_7),\r\n0x80, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ct_flag3,\r\n{ "Flag Byte 3", "tn5250.wdsf_ds_ct_flag3",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ct_flag3_0,\r\n{ "Bit 0", "tn5250.wdsf_ds_ct_flag3_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_ct_flag3_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ct_flag3_1,\r\n{ "Bit 1", "tn5250.wdsf_ds_ct_flag3_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_ct_flag3_1),\r\n0x02, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ct_flag3_2,\r\n{ "Bit 2", "tn5250.wdsf_ds_ct_flag3_2",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_ct_flag3_2),\r\n0x04, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ct_flag3_reserved,\r\n{ "Reserved", "tn5250.wdsf_ds_ct_flag3_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0xF8, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ct_mnemonic_offset,\r\n{ "Mnemonic Offset", "tn5250.wdsf_ds_ct_mnemonic_offset",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ct_aid,\r\n{ "AID", "tn5250.wdsf_ds_ct_aid",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ct_numeric_onebyte,\r\n{ "Numeric Characters", "tn5250.wdsf_ds_ct_numeric",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ct_numeric_twobyte,\r\n{ "Numeric Characters", "tn5250.wdsf_ds_ct_numeric",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ct_text,\r\n{ "Choice Text", "tn5250.wdsf_ds_ct_text",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_mbs_flag,\r\n{ "Flags", "tn5250.wdsf_ds_mbs_flag",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_mbs_flag_0,\r\n{ "Bit 0", "tn5250.wdsf_ds_mbs_flag_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_mbs_flag_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_mbs_flag_1,\r\n{ "Bit 1", "tn5250.wdsf_ds_mbs_flag_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_mbs_flag_1),\r\n0x02, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_mbs_flag_reserved,\r\n{ "Reserved", "tn5250.wdsf_ds_mbs_flag_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0xF8, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_mbs_start_column,\r\n{ "Start Column", "tn5250.wdsf_ds_mbs_start_column",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_mbs_end_column,\r\n{ "End Column", "tn5250.wdsf_ds_mbs_end_column",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_mbs_monochrome_sep,\r\n{ "Monochrome Separator Emphasis", "tn5250.wdsf_ds_mbs_monochrome_sep",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_mbs_color_sep,\r\n{ "Color Separator Emphasis", "tn5250.wdsf_ds_mbs_color_sep",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_mbs_sep_char,\r\n{ "Separator Character", "tn5250.wdsf_ds_mbs_sep_char",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_cpda_flag1,\r\n{ "Flags", "tn5250.wdsf_ds_cpda_flag1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_cpda_flag1_0,\r\n{ "Bit 0", "tn5250.wdsf_ds_cpda_flag1_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_cpda_flag1_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_cpda_flag1_1,\r\n{ "Bit 1", "tn5250.wdsf_ds_cpda_flag1_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_cpda_flag1_1),\r\n0x02, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_cpda_flag1_2,\r\n{ "Bit 2", "tn5250.wdsf_ds_cpda_flag1_2",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_cpda_flag1_2),\r\n0x04, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_cpda_flag1_reserved,\r\n{ "Reserved", "tn5250.wdsf_ds_cpda_flag1_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0xF8, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_cpda_monochrome_sel_avail,\r\n{ "Monochrome Selection Cursor Available Emphasis", "tn5250.wdsf_ds_cpda_monochrome_sel_avail",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_cpda_color_sel_avail,\r\n{ "Color Selection Cursor Available Emphasis", "tn5250.wdsf_ds_cpda_color_sel_avail",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_cpda_monochrome_sel_selected,\r\n{ "Monochrome Selection Cursor Selected Emphasis", "tn5250.wdsf_ds_cpda_monochrome_sel_selected",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_cpda_color_sel_selected,\r\n{ "Color Selection Cursor Selected Emphasis", "tn5250.wdsf_ds_cpda_color_sel_selected",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_cpda_monochrome_sel_unavail,\r\n{ "Monochrome Selection Cursor Unavailable Emphasis", "tn5250.wdsf_ds_cpda_monochrome_sel_unavail",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_cpda_color_sel_unavail,\r\n{ "Color Selection Cursor Unavailable Emphasis", "tn5250.wdsf_ds_cpda_color_sel_unavail",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_cpda_monochrome_avail,\r\n{ "Monochrome Available Emphasis", "tn5250.wdsf_ds_cpda_monochrome_avail",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_cpda_color_avail,\r\n{ "Color Available Emphasis", "tn5250.wdsf_ds_cpda_color_avail",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_cpda_monochrome_selected,\r\n{ "Monochrome Selected Emphasis", "tn5250.wdsf_ds_cpda_monochrome_selected",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_cpda_color_selected,\r\n{ "Color Selected Emphasis", "tn5250.wdsf_ds_cpda_color_selected",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_cpda_monochrome_unavail,\r\n{ "Monochrome Unavailable Emphasis", "tn5250.wdsf_ds_cpda_monochrome_unavail",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_cpda_color_unavail,\r\n{ "Color Unavailable Emphasis", "tn5250.wdsf_ds_cpda_color_unavail",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_cpda_monochrome_indicator,\r\n{ "Monochrome Indicator Emphasis", "tn5250.wdsf_ds_cpda_monochrome_indicator",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_cpda_color_indicator,\r\n{ "Color Indicator Emphasis", "tn5250.wdsf_ds_cpda_color_indicator",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_cpda_monochrome_unavail_indicator,\r\n{ "Monochrome Unavailable Indicator Emphasis", "tn5250.wdsf_ds_cpda_monochrome_unavail_indicator",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_cpda_color_unavail_indicator,\r\n{ "Color Unavailable Indicator Emphasis", "tn5250.wdsf_ds_cpda_color_unavail_indicator",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ci_flag1,\r\n{ "Flags", "tn5250.wdsf_ds_ci_flag1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ci_flag1_0,\r\n{ "Bit 0", "tn5250.wdsf_ds_ci_flag1_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_ci_flag1_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ci_flag1_reserved,\r\n{ "Reserved", "tn5250.wdsf_ds_ci_flag1_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0xFE, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ci_left_push,\r\n{ "Empty Indicator or Left Push Button", "tn5250.wdsf_ds_ci_left_push",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ci_right_push,\r\n{ "Selected Indicator or Right Push Button", "tn5250.wdsf_ds_ci_right_push",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_ci_first_choice,\r\n{ "Character That Replaces the First Choice Text Character for Unavailable Choices On a Monochrome Display", "tn5250.wdsf_ds_ci_first_choice",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_sbi_flag1,\r\n{ "Flags", "tn5250.wdsf_ds_sbi_flag1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_sbi_flag1_0,\r\n{ "Bit 0", "tn5250.wdsf_ds_sbi_flag1_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_ds_sbi_flag1_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_sbi_flag1_reserved,\r\n{ "Reserved", "tn5250.wdsf_ds_sbi_flag1_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0xFE, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_sbi_monochrome_top_highlight,\r\n{ "Monochrome Top of ScrollBar Highlighting", "tn5250.wdsf_ds_sbi_monochrome_top_highlight",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_sbi_color_top_highlight,\r\n{ "Color Top of ScrollBar Highlighting", "tn5250.wdsf_ds_sbi_color_top_highlightl",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_sbi_monochrome_top_highlight_shaft,\r\n{ "Monochrome Shaft ScrollBar Highlighting", "tn5250.wdsf_ds_sbi_monochrome_top_highlight_shaft",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_sbi_color_top_highlight_shaft,\r\n{ "Color Shaft ScrollBar Highlighting", "tn5250.wdsf_ds_sbi_color_top_highlight_shaft",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_sbi_top_character,\r\n{ "Top Scroll Bar Character", "tn5250.wdsf_ds_sbi_top_character",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_sbi_bottom_character,\r\n{ "Bottom Scroll Bar Character", "tn5250.wdsf_ds_sbi_bottom_character",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_sbi_empty_character,\r\n{ "Empty Scroll Bar Character", "tn5250.wdsf_ds_sbi_empty_character",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_ds_sbi_slider_character,\r\n{ "Slider Scroll Bar Character", "tn5250.wdsf_ds_sbi_slider_character",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_dsb_flag1,\r\n{ "Flags", "tn5250.wdsf_dsb_flag1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_dsb_flag1_0,\r\n{ "Bit 0", "tn5250.wdsf_dsb_flag1_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_dsb_flag1_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_dsb_flag1_1,\r\n{ "Bit 1", "tn5250.wdsf_dsb_flag1_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_dsb_flag1_0),\r\n0x02, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_dsb_flag1_reserved,\r\n{ "Reserved", "tn5250.wdsf_dsb_flag1_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0x7C, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_dsb_flag1_7,\r\n{ "Bit 7", "tn5250.wdsf_dsb_flag1_7",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_dsb_flag1_7),\r\n0x80, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_sbi_total_scroll,\r\n{ "TotalRows or TotalCols That Can Be Scrolled", "tn5250.wdsf_sbi_total_scroll",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_sbi_sliderpos,\r\n{ "SliderPos", "tn5250.wdsf_sbi_sliderpos",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_sbi_rowscols,\r\n{ "Rows or Columns", "tn5250.wdsf_sbi_rowscols",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_wdf_flag1,\r\n{ "Flags", "tn5250.wdsf_wdf_flag1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_wdf_flag1_0,\r\n{ "Bit 0", "tn5250.wdsf_wdf_flag1_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_wdf_flag1_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_wdf_flag1_reserved,\r\n{ "Reserved", "tn5250.wdsf_wdf_flag1_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0xFE, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_pmb_flag1,\r\n{ "Flags", "tn5250.wdsf_pmb_flag1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_pmb_flag1_0,\r\n{ "Bit 0", "tn5250.wdsf_pmb_flag1_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_pmb_flag1_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_pmb_flag1_1,\r\n{ "Bit 1", "tn5250.wdsf_pmb_flag1_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_pmb_flag1_1),\r\n0x02, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_pmb_flag1_2,\r\n{ "Bit 2", "tn5250.wdsf_pmb_flag1_2",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_pmb_flag1_2),\r\n0x04, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_pmb_flag1_3,\r\n{ "Bit 3", "tn5250.wdsf_pmb_flag1_3",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_pmb_flag1_3),\r\n0x08, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_pmb_flag1_reserved,\r\n{ "Reserved", "tn5250.wdsf_pmb_flag1_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0xF0, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_pmb_first_mouse_event,\r\n{ "First Mouse Event (Leading Edge Event)", "tn5250.wdsf_pmb_first_mouse_event",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_mouse_events), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_pmb_second_mouse_event,\r\n{ "Second Mouse Event (Trailing Edge Event)", "tn5250.wdsf_pmb_second_mouse_event",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_mouse_events), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_deg_partition,\r\n{ "Partition", "tn5250.wdsf_deg_partition",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_deg_flag1,\r\n{ "Flags", "tn5250.wdsf_deg_flag1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_deg_flag1_0,\r\n{ "Bit 0", "tn5250.wdsf_deg_flag1_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_deg_flag1_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_deg_flag1_reserved,\r\n{ "Reserved", "tn5250.wdsf_deg_flag1_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0xFE, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_deg_flag2,\r\n{ "Flags", "tn5250.wdsf_deg_flag2",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_deg_flag2_0,\r\n{ "Bit 0", "tn5250.wdsf_deg_flag2_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_deg_flag1_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_deg_flag2_reserved,\r\n{ "Reserved", "tn5250.wdsf_deg_flag2_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0xFE, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_deg_default_color,\r\n{ "Default Color for Grid Lines", "tn5250.wdsf_deg_default_color",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_deg_default_line,\r\n{ "Default Line Style", "tn5250.wdsf_deg_default_line",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_deg_lines), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_deg_minor_type,\r\n{ "Construct", "tn5250.wdsf_deg_minor_type",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_wdsf_deg_minor_type), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_deg_ms_flag1,\r\n{ "Flags", "tn5250.wdsf_deg_ms_flag1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_deg_ms_flag1_0,\r\n{ "Bit 0", "tn5250.wdsf_deg_ms_flag1_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wdsf_deg_ms_flag1_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_deg_ms_flag1_reserved,\r\n{ "Reserved", "tn5250.wdsf_deg_ms_flag1_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0xFE, NULL, HFILL }},\r\n{ &hf_tn5250_wdsf_deg_ms_start_row,\r\n{ "Start Row", "tn5250.wdsf_deg_ms_start_row",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_deg_ms_start_column,\r\n{ "Start Column", "tn5250.wdsf_deg_ms_start_column",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_deg_ms_horizontal_dimension,\r\n{ "Horizontal Dimenstion", "tn5250.wdsf_deg_ms_horizontal_dimension",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_deg_ms_vertical_dimension,\r\n{ "Vertical Dimenstion", "tn5250.wdsf_deg_ms_vertical_dimension",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_deg_ms_default_color,\r\n{ "Color", "tn5250.wdsf_deg_ms_default_color",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_fa_color), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_deg_ms_line_repeat,\r\n{ "Line Repeat", "tn5250.wdsf_deg_ms_line_repeat",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_deg_ms_line_interval,\r\n{ "Line Interval", "tn5250.wdsf_deg_ms_line_interval",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cgl_partition,\r\n{ "Partition", "tn5250.wdsf_cgl_partition",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cgl_start_row,\r\n{ "Start Row", "tn5250.wdsf_cgl_start_row",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cgl_start_column,\r\n{ "Start Column", "tn5250.wdsf_cgl_start_column",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cgl_rectangle_width,\r\n{ "Width of Rectangle", "tn5250.wdsf_cgl_rectangle_width",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wdsf_cgl_rectangle_height,\r\n{ "Height of Rectangle", "tn5250.wdsf_cgl_rectangle_height",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wectw_start_column,\r\n{ "Start Column", "tn5250.wectw_start_column",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wectw_end_column,\r\n{ "End Column", "tn5250.wectw_end_column",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_sps_flag1,\r\n{ "Flags", "tn5250.sps_flag1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_sps_flag1_0,\r\n{ "Bit 0", "tn5250.sps_flag1_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_sps_flag1_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_sps_flag1_reserved,\r\n{ "Reserved", "tn5250.sps_flag1_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0xFE, NULL, HFILL }},\r\n{ &hf_tn5250_sps_top_row,\r\n{ "Top Row", "tn5250.sps_top_row",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_sps_left_column,\r\n{ "Left Column", "tn5250.sps_left_column",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_sps_window_depth,\r\n{ "Window Depth", "tn5250.sps_window_depth",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_sps_window_width,\r\n{ "Window Width", "tn5250.sps_window_width",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_roll_flag1,\r\n{ "Byte 1", "tn5250.roll_flag1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_roll_flag1_0,\r\n{ "Bit 0", "tn5250.roll_flag1_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_roll_flag1_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_roll_flag1_reserved,\r\n{ "Reserved", "tn5250.roll_flag1_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0x06, NULL, HFILL }},\r\n{ &hf_tn5250_roll_flag1_lines,\r\n{ "Number of lines that the designated area is to be rolled", "tn5250.roll_flag1_lines", FT_UINT8, BASE_DEC,\r\nNULL, 0xF8, NULL, HFILL }},\r\n{ &hf_tn5250_roll_top_line,\r\n{ "Line number defining the top line of the area that will participate in the roll", "tn5250.roll_top_line",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_roll_bottom_line,\r\n{ "Line number defining the bottom line of the area that will participate in the roll", "tn5250.roll_bottom_line",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wssf_wsc_minor_type,\r\n{ "Minor Structured Field Type", "tn5250.wssf_wsc_minor_type",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_wssf_minor_type), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wssf_flag1,\r\n{ "Byte 1", "tn5250.wssf_flag1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wssf_flag2,\r\n{ "Byte 2", "tn5250.wssf_flag2",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wssf_flag2_0,\r\n{ "Bit 0", "tn5250.wssf_flag2_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wssf_flag2_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_wssf_flag2_1,\r\n{ "Bit 1", "tn5250.wssf_flag2_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wssf_flag2_1),\r\n0x02, NULL, HFILL }},\r\n{ &hf_tn5250_wssf_flag2_2,\r\n{ "Bit 2", "tn5250.wssf_flag2_2",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wssf_flag2_2),\r\n0x04, NULL, HFILL }},\r\n{ &hf_tn5250_wssf_flag2_3,\r\n{ "Bit 3", "tn5250.wssf_flag2_3",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wssf_flag2_3),\r\n0x08, NULL, HFILL }},\r\n{ &hf_tn5250_wssf_flag2_4,\r\n{ "Bit 4", "tn5250.wssf_flag2_4",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wssf_flag2_4),\r\n0x10, NULL, HFILL }},\r\n{ &hf_tn5250_wssf_flag2_5,\r\n{ "Bit 5", "tn5250.wssf_flag2_5",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wssf_flag2_5),\r\n0x20, NULL, HFILL }},\r\n{ &hf_tn5250_wssf_flag2_6,\r\n{ "Bit 6", "tn5250.wssf_flag2_6",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wssf_flag2_6),\r\n0x40, NULL, HFILL }},\r\n{ &hf_tn5250_wssf_flag2_7,\r\n{ "Bit 7", "tn5250.wssf_flag2_7",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wssf_flag2_7),\r\n0x80, NULL, HFILL }},\r\n{ &hf_tn5250_wssf_kbc_flag1,\r\n{ "Byte 1", "tn5250.wssf_kbc_flag1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wssf_kbc_flag1_reserved,\r\n{ "Reserved", "tn5250.wssf_kbc_flag1_reserved", FT_UINT8, BASE_HEX|BASE_RANGE_STRING,\r\nRVALS(vals_tn5250_reserved), 0x1F, NULL, HFILL }},\r\n{ &hf_tn5250_wssf_kbc_flag1_5,\r\n{ "Bit 5", "tn5250.wssf_kbc_flag1_5",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wssf_kbc_flag1_5),\r\n0x20, NULL, HFILL }},\r\n{ &hf_tn5250_wssf_kbc_flag1_6,\r\n{ "Bit 6", "tn5250.wssf_kbc_flag1_6",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wssf_kbc_flag1_6),\r\n0x40, NULL, HFILL }},\r\n{ &hf_tn5250_wssf_kbc_flag1_7,\r\n{ "Bit 7", "tn5250.wssf_kbc_flag1_7",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wssf_kbc_flag1_7),\r\n0x80, NULL, HFILL }},\r\n{ &hf_tn5250_wssf_cc_flag1,\r\n{ "Byte 1", "tn5250.wssf_cc_flag1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wssf_cc_flag1_reserved,\r\n{ "Reserved", "tn5250.wssf_cc_flag1_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0x7F, NULL, HFILL }},\r\n{ &hf_tn5250_wssf_cc_flag1_7,\r\n{ "Bit 7", "tn5250.wssf_cc_flag1_7",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wssf_cc_flag1_7),\r\n0x80, NULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifc_flag1,\r\n{ "Byte 1", "tn5250.wssf_ifc_flag1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifc_flag1_0,\r\n{ "Bit 0 (Cache allowed flag)", "tn5250.wssf_ifc_flag1_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wssf_ifc_flag1_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifc_flag1_1to3,\r\n{ "Bits 1-3 (Type of image/fax display)", "tn5250.wssf_ifc_flag1_1to3", FT_UINT8, BASE_HEX,\r\nVALS(tn5250_vals_tn5250_wssf_ifc_vals), 0x0E, NULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifc_flag1_4,\r\n{ "Bit 4 (Color importance during scaling)", "tn5250.wssf_ifc_flag1_4",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wssf_ifc_flag1_4),\r\n0x10, NULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifc_flag1_5,\r\n{ "Bit 5 (Allow display to control scaling)", "tn5250.wssf_ifc_flag1_5",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wssf_ifc_flag1_5),\r\n0x20, NULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifc_flag1_6,\r\n{ "Bit 6 (Reverse image)", "tn5250.wssf_ifc_flag1_6",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wssf_ifc_flag1_6),\r\n0x40, NULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifc_flag1_7,\r\n{ "Bit 7 (Allow/Inhibit EasyScroll with a mouse)", "tn5250.wssf_ifc_flag1_7",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wssf_ifc_flag1_7),\r\n0x80, NULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifc_flag2,\r\n{ "Byte 2", "tn5250.wssf_ifc_flag2",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifc_flag2_0,\r\n{ "Bit 0 (Duplicate Scan Lines)", "tn5250.wssf_ifc_flag2_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wssf_ifc_flag2_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifc_flag2_1,\r\n{ "Bit 1 (Allow/Inhibit Trim Magnify Scaling)", "tn5250.wssf_ifc_flag2_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wssf_ifc_flag2_1),\r\n0x02, NULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifc_flag2_reserved,\r\n{ "Reserved", "tn5250.wssf_ifc_flag2_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0x7C, NULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifc_flag2_7,\r\n{ "Bit 7", "tn5250.wssf_ifc_flag2_7",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wssf_ifc_flag2_7),\r\n0x80, NULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifc_image_format,\r\n{ "Image Format", "tn5250.wssf_ifc_image_format",\r\nFT_UINT16, BASE_DEC, VALS(vals_tn5250_image_format), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifc_viewport_location_row,\r\n{ "Viewport Location (Row)", "tn5250.wssf_ifc_viewport_location_row",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifc_viewport_location_col,\r\n{ "Viewport Location (Column)", "tn5250.wssf_ifc_viewport_location_col",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifc_viewport_size_row,\r\n{ "Viewport Size (Row)", "tn5250.wssf_ifc_viewport_size_row",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifc_viewport_size_col,\r\n{ "Viewport Size (Column)", "tn5250.wssf_ifc_viewport_size_col",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifc_scaling,\r\n{ "Scaling", "tn5250.wssf_ifc_scaling",\r\nFT_UINT16, BASE_HEX, VALS(vals_tn5250_wssf_ifc_scaling), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifc_viewimage_location_row,\r\n{ "View Image Location (Vertical Percentage)", "tn5250.wssf_ifc_viewimage_location_row",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifc_viewimage_location_col,\r\n{ "View Image Location (Horizontal Position)", "tn5250.wssf_ifc_viewimage_location_col",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifc_rotation,\r\n{ "Rotation (Degrees)", "tn5250.wssf_ifc_rotation",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifc_foreground_color,\r\n{ "Foreground Color", "tn5250.wssf_ifc_foreground_color",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_foreground_color_attributes), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifc_background_color,\r\n{ "Background Color", "tn5250.wssf_ifc_background_color",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_foreground_color_attributes), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifc_imagefax_name,\r\n{ "Image/Fax Name", "tn5250.wssf_ifc_imagefax_name",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifd_flag1,\r\n{ "Byte 1", "tn5250.wssf_ifd_flag1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifd_flag1_0,\r\n{ "Bit 0 (Last Data Stream flag)", "tn5250.wssf_ifd_flag1_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wssf_ifd_flag1_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifd_flag1_reserved,\r\n{ "Reserved", "tn5250.wssf_ifd_flag1_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0xFE, NULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifd_imagefax_name,\r\n{ "Image/Fax Name", "tn5250.wssf_ifd_imagefax_name",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wssf_ifd_imagefax_data,\r\n{ "Image/Fax Data", "tn5250.wssf_ifd_imagefax_data",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_image_fax_error,\r\n{ "Image/Fax Error", "tn5250.image_fax_error",\r\nFT_UINT16, BASE_HEX, VALS(vals_tn5250_image_fax_error), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_vac_prefix,\r\n{ "Video/Audio Control Data Prefix", "tn5250.vac_data_prefix",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_vac_data,\r\n{ "Video/Audio Control Data", "tn5250.vac_data",\r\nFT_UINT32, BASE_HEX|BASE_RANGE_STRING, RVALS(vals_tn5250_vac_data), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wssf_ttw_flag,\r\n{ "Flag", "tn5250.wssf_ttw_flag",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_wssf_ttw_flag), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wssf_ttw_data,\r\n{ "Transparent Data", "tn5250.wssf_ttw_data",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wsf_qss_flag1,\r\n{ "Byte 1", "tn5250.wsf_qss_flag1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wsf_qss_flag1_0,\r\n{ "Bit 0", "tn5250.wsf_qss_flag1_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wsf_qss_flag1_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_wsf_qss_flag1_reserved,\r\n{ "Reserved", "tn5250.wsf_qss_flag1_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0xFE, NULL, HFILL }},\r\n{ &hf_tn5250_wsf_qss_flag2,\r\n{ "Byte 2", "tn5250.wsf_qss_flag2",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wsf_qss_flag2_reserved,\r\n{ "Reserved", "tn5250.wsf_qss_flag2_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0x7F, NULL, HFILL }},\r\n{ &hf_tn5250_wsf_qss_flag2_7,\r\n{ "Bit 7", "tn5250.wsf_qss_flag2_7",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wsf_qss_flag2_7),\r\n0x80, NULL, HFILL }},\r\n{ &hf_tn5250_dawt_id,\r\n{ "ID", "tn5250.dawt_id",\r\nFT_UINT8, BASE_HEX|BASE_RANGE_STRING, RVALS(vals_tn5250_dawt_id), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dawt_length,\r\n{ "Length", "tn5250.dawt_length",\r\nFT_UINT8, BASE_HEX|BASE_RANGE_STRING, RVALS(vals_tn5250_dawt_length), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dawt_char,\r\n{ "Character", "tn5250.dawt_char",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dawt_message,\r\n{ "Message", "tn5250.dawt_message",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dckf_id,\r\n{ "ID", "tn5250.dckf_id",\r\nFT_UINT8, BASE_HEX|BASE_RANGE_STRING, RVALS(vals_tn5250_dckf_id), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dckf_length,\r\n{ "Length", "tn5250.dckf_length",\r\nFT_UINT8, BASE_HEX|BASE_RANGE_STRING, RVALS(vals_tn5250_dckf_length), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dckf_key_code,\r\n{ "Key Code", "tn5250.dckf_key_code",\r\nFT_UINT8, BASE_HEX|BASE_RANGE_STRING, RVALS(vals_tn5250_dckf_key_code), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dckf_function_code,\r\n{ "Function Code", "tn5250.dckf_function_code",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_dckf_function_code), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dckf_prompt_text,\r\n{ "Prompt Text", "tn5250.dckf_prompt_text",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_rts_partition,\r\n{ "Partition", "tn5250.rts_partition",\r\nFT_UINT8, BASE_HEX|BASE_RANGE_STRING, RVALS(vals_tn5250_rts_partition), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_rts_flag1,\r\n{ "Byte 1", "tn5250.rts_flag1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_rts_flag1_0,\r\n{ "Bit 0 (Last Data Stream flag)", "tn5250.rts_flag1_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_rts_flag1_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_rts_flag1_reserved,\r\n{ "Reserved", "tn5250.rts_flag1_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0xFE, NULL, HFILL }},\r\n{ &hf_tn5250_dpo_partition,\r\n{ "Partition", "tn5250.dpo_partition",\r\nFT_UINT8, BASE_HEX|BASE_RANGE_STRING, RVALS(vals_tn5250_rts_partition), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dpo_flag1,\r\n{ "Byte 1", "tn5250.dpo_flag1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dpo_flag1_0,\r\n{ "Bit 0", "tn5250.dpo_flag1_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dpo_flag1_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_dpo_flag1_1,\r\n{ "Bit 1", "tn5250.dpo_flag1_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dpo_flag1_1),\r\n0x02, NULL, HFILL }},\r\n{ &hf_tn5250_dpo_flag1_2,\r\n{ "Bit 2", "tn5250.dpo_flag1_2",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dpo_flag1_2),\r\n0x04, NULL, HFILL }},\r\n{ &hf_tn5250_dpo_flag1_3,\r\n{ "Bit 3", "tn5250.dpo_flag1_3",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dpo_flag1_3),\r\n0x08, NULL, HFILL }},\r\n{ &hf_tn5250_dpo_flag1_4,\r\n{ "Bit 4", "tn5250.dpo_flag1_4",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dpo_flag1_4),\r\n0x10, NULL, HFILL }},\r\n{ &hf_tn5250_dpo_flag1_5,\r\n{ "Bit 5", "tn5250.dpo_flag1_5",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dpo_flag1_5),\r\n0x20, NULL, HFILL }},\r\n{ &hf_tn5250_dpo_flag1_6,\r\n{ "Bit 6", "tn5250.dpo_flag1_6",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dpo_flag1_6),\r\n0x40, NULL, HFILL }},\r\n{ &hf_tn5250_dpo_flag1_7,\r\n{ "Bit 7", "tn5250.dpo_flag1_7",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dpo_flag1_7),\r\n0x80, NULL, HFILL }},\r\n{ &hf_tn5250_dpo_flag2,\r\n{ "Byte 1", "tn5250.dpo_flag2",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dpo_flag2_0,\r\n{ "Bit 0", "tn5250.dpo_flag2_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dpo_flag2_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_dpo_flag2_reserved,\r\n{ "Reserved", "tn5250.dpo_flag2_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0xFE, NULL, HFILL }},\r\n{ &hf_tn5250_dpo_displace_characters,\r\n{ "Displaced Characters", "tn5250.dpo_displace_characters",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dpo_start_location_row,\r\n{ "Start Location (Row)", "tn5250.dpo_start_location_row",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dpo_start_location_col,\r\n{ "Start Location (Column)", "tn5250.dpo_start_location_col",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dtsf_partition,\r\n{ "Partition", "tn5250.dtsf_partition",\r\nFT_UINT8, BASE_HEX|BASE_RANGE_STRING, RVALS(vals_tn5250_rts_partition), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dtsf_flag1,\r\n{ "Byte 1", "tn5250.dtsf_flag1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dtsf_flag1_0,\r\n{ "Bit 0", "tn5250.dtsf_flag1_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dtsf_flag1_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_dtsf_flag1_1,\r\n{ "Bit 1", "tn5250.dtsf_flag1_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dtsf_flag1_1),\r\n0x02, NULL, HFILL }},\r\n{ &hf_tn5250_dtsf_flag1_2,\r\n{ "Bit 2", "tn5250.dtsf_flag1_2",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dtsf_flag1_2),\r\n0x04, NULL, HFILL }},\r\n{ &hf_tn5250_dtsf_flag1_3,\r\n{ "Bit 3", "tn5250.dtsf_flag1_3",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dtsf_flag1_3),\r\n0x08, NULL, HFILL }},\r\n{ &hf_tn5250_dtsf_flag1_4,\r\n{ "Bit 4", "tn5250.dtsf_flag1_4",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dtsf_flag1_4),\r\n0x10, NULL, HFILL }},\r\n{ &hf_tn5250_dtsf_flag1_5,\r\n{ "Bit 5", "tn5250.dtsf_flag1_5",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dtsf_flag1_5),\r\n0x20, NULL, HFILL }},\r\n{ &hf_tn5250_dtsf_flag1_6,\r\n{ "Bit 6", "tn5250.dtsf_flag1_6",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dtsf_flag1_6),\r\n0x40, NULL, HFILL }},\r\n{ &hf_tn5250_dtsf_flag1_7,\r\n{ "Bit 7", "tn5250.dtsf_flag1_7",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dtsf_flag1_7),\r\n0x80, NULL, HFILL }},\r\n{ &hf_tn5250_dtsf_flag2,\r\n{ "Byte 1", "tn5250.dtsf_flag2",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dtsf_flag2_0,\r\n{ "Bit 0", "tn5250.dtsf_flag2_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dtsf_flag2_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_dtsf_flag2_1,\r\n{ "Bit 1", "tn5250.dtsf_flag2_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dtsf_flag2_1),\r\n0x02, NULL, HFILL }},\r\n{ &hf_tn5250_dtsf_flag2_2,\r\n{ "Bit 2", "tn5250.dtsf_flag2_2",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dtsf_flag2_2),\r\n0x04, NULL, HFILL }},\r\n{ &hf_tn5250_dtsf_flag2_3,\r\n{ "Bit 3", "tn5250.dtsf_flag2_3",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dtsf_flag2_3),\r\n0x08, NULL, HFILL }},\r\n{ &hf_tn5250_dtsf_flag2_4to7,\r\n{ "Bits 4 to 7", "tn5250.dtsf_flag2_4to7",\r\nFT_UINT8, BASE_HEX|BASE_RANGE_STRING, RVALS(vals_tn5250_dtsf_flag2_vals), 0xF0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dtsf_text_body_height,\r\n{ "Text Body Height", "tn5250.dtsf_text_body_height",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dtsf_text_body_width,\r\n{ "Text Body Width", "tn5250.dtsf_text_body_width",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dtsf_line_cmd_field_size,\r\n{ "Line Cmd Field Size", "tn5250.dtsf_line_cmd_field_size",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dtsf_location_of_pitch,\r\n{ "Location of Pitch", "tn5250.dtsf_location_of_pitch",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dtsf_first_line,\r\n{ "First Line in Text Body", "tn5250.dtsf_first_line",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dsl_partition,\r\n{ "Partition", "tn5250.dsl_partition",\r\nFT_UINT8, BASE_HEX|BASE_RANGE_STRING, RVALS(vals_tn5250_rts_partition), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dsl_rtl_offset,\r\n{ "RTL Offset", "tn5250.dsl_rtl_offset",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dsl_offset,\r\n{ "Offset", "tn5250.dsl_offset",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dsl_flag1,\r\n{ "Byte 1", "tn5250.dsl_flag1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dsl_flag1_0,\r\n{ "Bit 0", "tn5250.dsl_flag1_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dsl_flag1_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_dsl_flag1_1,\r\n{ "Bit 1", "tn5250.dsl_flag1_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dsl_flag1_1),\r\n0x02, NULL, HFILL }},\r\n{ &hf_tn5250_dsl_flag1_2,\r\n{ "Bit 2", "tn5250.dsl_flag1_2",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dsl_flag1_2),\r\n0x04, NULL, HFILL }},\r\n{ &hf_tn5250_dsl_flag1_reserved,\r\n{ "Reserved", "tn5250.dsl_flag1_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0xF8, NULL, HFILL }},\r\n{ &hf_tn5250_dsl_id,\r\n{ "ID", "tn5250.dsl_id",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dsl_location,\r\n{ "Location", "tn5250.dsl_location",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dsl_function,\r\n{ "Function", "tn5250.dsl_function",\r\nFT_UINT8, BASE_HEX|BASE_RANGE_STRING, RVALS(vals_tn5250_dsl_function), 0x00,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wts_partition,\r\n{ "Partition", "tn5250.wts_partition",\r\nFT_UINT8, BASE_HEX|BASE_RANGE_STRING, RVALS(vals_tn5250_rts_partition), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wts_flag1,\r\n{ "Byte 1", "tn5250.wts_flag1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wts_flag1_0,\r\n{ "Bit 0", "tn5250.wts_flag1_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_flag1_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_wts_flag1_1,\r\n{ "Bit 1", "tn5250.wts_flag1_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_flag1_1),\r\n0x02, NULL, HFILL }},\r\n{ &hf_tn5250_wts_flag1_2,\r\n{ "Bit 2", "tn5250.wts_flag1_2",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_flag1_2),\r\n0x04, NULL, HFILL }},\r\n{ &hf_tn5250_wts_flag1_3,\r\n{ "Bit 3", "tn5250.wts_flag1_3",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_flag1_3),\r\n0x08, NULL, HFILL }},\r\n{ &hf_tn5250_wts_flag1_reserved,\r\n{ "Reserved", "tn5250.wts_flag1_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0xF0, NULL, HFILL }},\r\n{ &hf_tn5250_wts_flag2,\r\n{ "Byte 2", "tn5250.wts_flag2",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wts_flag2_reserved,\r\n{ "Reserved", "tn5250.wts_flag2_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0x1F, NULL, HFILL }},\r\n{ &hf_tn5250_wts_flag2_6,\r\n{ "Bit 6", "tn5250.wts_flag2_6",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_flag2_6),\r\n0x20, NULL, HFILL }},\r\n{ &hf_tn5250_wts_flag2_reserved2,\r\n{ "Reserved", "tn5250.wts_flag2_reserved2", FT_UINT8, BASE_HEX,\r\nNULL, 0xC0, NULL, HFILL }},\r\n{ &hf_tn5250_wts_flag3,\r\n{ "Byte 3", "tn5250.wts_flag3",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wts_flag3_0,\r\n{ "Bit 0", "tn5250.wts_flag3_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_flag3_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_wts_flag3_1,\r\n{ "Bit 1", "tn5250.wts_flag3_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_flag3_1),\r\n0x02, NULL, HFILL }},\r\n{ &hf_tn5250_wts_flag3_2,\r\n{ "Bit 2", "tn5250.wts_flag3_2",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_flag3_2),\r\n0x04, NULL, HFILL }},\r\n{ &hf_tn5250_wts_flag3_3,\r\n{ "Bit 3", "tn5250.wts_flag3_3",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_flag3_3),\r\n0x08, NULL, HFILL }},\r\n{ &hf_tn5250_wts_flag3_4,\r\n{ "Bit 4", "tn5250.wts_flag3_4",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_flag3_4),\r\n0x10, NULL, HFILL }},\r\n{ &hf_tn5250_wts_flag3_5,\r\n{ "Bit 5", "tn5250.wts_flag3_5",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_flag3_5),\r\n0x20, NULL, HFILL }},\r\n{ &hf_tn5250_wts_flag3_6,\r\n{ "Bit 6", "tn5250.wts_flag3_6",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_flag3_6),\r\n0x40, NULL, HFILL }},\r\n{ &hf_tn5250_wts_flag3_7,\r\n{ "Bit 7", "tn5250.wts_flag3_7",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_flag3_7),\r\n0x80, NULL, HFILL }},\r\n{ &hf_tn5250_wts_home_position_row,\r\n{ "Home Position (Row)", "tn5250.wts_home_position_row",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wts_home_position_col,\r\n{ "Home Position (Column)", "tn5250.wts_home_position_col",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_flag1,\r\n{ "Byte 1", "tn5250.wts_cld_flag1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_flag1_0,\r\n{ "Bit 0", "tn5250.wts_cld_flag1_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_cld_flag1_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_flag1_1,\r\n{ "Bit 1", "tn5250.wts_cld_flag1_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_cld_flag1_1),\r\n0x02, NULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_flag1_2,\r\n{ "Bit 2", "tn5250.wts_cld_flag1_2",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_cld_flag1_2),\r\n0x04, NULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_flag1_3,\r\n{ "Bit 3", "tn5250.wts_cld_flag1_3",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_cld_flag1_3),\r\n0x08, NULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_flag1_4,\r\n{ "Bit 4", "tn5250.wts_cld_flag1_4",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_cld_flag1_4),\r\n0x10, NULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_flag1_5,\r\n{ "Bit 5", "tn5250.wts_cld_flag1_5",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_cld_flag1_5),\r\n0x20, NULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_flag1_6,\r\n{ "Bit 6", "tn5250.wts_cld_flag1_6",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_cld_flag1_6),\r\n0x40, NULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_flag1_7,\r\n{ "Bit 7", "tn5250.wts_cld_flag1_7",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_cld_flag1_7),\r\n0x80, NULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_flag2,\r\n{ "Byte 2", "tn5250.wts_cld_flag2",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_flag2_0,\r\n{ "Bit 0", "tn5250.wts_cld_flag2_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_cld_flag2_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_flag2_1,\r\n{ "Bit 1", "tn5250.wts_cld_flag2_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_cld_flag2_1),\r\n0x02, NULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_flag2_2,\r\n{ "Bit 2", "tn5250.wts_cld_flag2_2",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_cld_flag2_2),\r\n0x04, NULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_flag2_3,\r\n{ "Bit 3", "tn5250.wts_cld_flag2_3",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_cld_flag2_3),\r\n0x08, NULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_flag2_4,\r\n{ "Bit 4", "tn5250.wts_cld_flag2_4",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_cld_flag2_4),\r\n0x10, NULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_flag2_line_spacing,\r\n{ "Line Spacing in Half-Units", "tn5250.wts_cld_flag2_line_spacing", FT_UINT8, BASE_DEC,\r\nNULL, 0xE0, NULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_row,\r\n{ "Row", "tn5250.wts_cld_row",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_flag3,\r\n{ "Byte 3", "tn5250.wts_cld_flag3",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_flag3_0,\r\n{ "Bit 0", "tn5250.wts_cld_flag3_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_cld_flag3_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_flag3_1,\r\n{ "Bit 1", "tn5250.wts_cld_flag3_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_cld_flag3_1),\r\n0x02, NULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_flag3_2,\r\n{ "Bit 2", "tn5250.wts_cld_flag3_2",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_cld_flag3_2),\r\n0x04, NULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_flag3_3,\r\n{ "Bit 3", "tn5250.wts_cld_flag3_3",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_cld_flag3_3),\r\n0x08, NULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_flag3_4,\r\n{ "Bit 4", "tn5250.wts_cld_flag3_4",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_cld_flag3_4),\r\n0x10, NULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_flag3_5,\r\n{ "Bit 5", "tn5250.wts_cld_flag3_5",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_cld_flag3_5),\r\n0x20, NULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_flag3_6,\r\n{ "Bit 6", "tn5250.wts_cld_flag3_6",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_cld_flag3_6),\r\n0x40, NULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_flag3_7,\r\n{ "Bit 7", "tn5250.wts_cld_flag3_7",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_wts_cld_flag3_7),\r\n0x80, NULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_page_num,\r\n{ "Page Number", "tn5250.wts_cld_page_num",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_lmo,\r\n{ "Left Margin Offset", "tn5250.wts_cld_lmo",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_io,\r\n{ "Indent Offset", "tn5250.wts_cld_io",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_sli,\r\n{ "Scale Line ID", "tn5250.wts_cld_sli",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_wts_cld_li,\r\n{ "Line Image", "tn5250.wts_cld_li",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dsc_partition,\r\n{ "Partition", "tn5250.dsc_partition",\r\nFT_UINT8, BASE_HEX|BASE_RANGE_STRING, RVALS(vals_tn5250_rts_partition), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dsc_sk,\r\n{ "Symbol Key", "tn5250.dsc_sk",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dsc_ev,\r\n{ "EBCDIC Value", "tn5250.dsc_ev",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dorm_id,\r\n{ "ID", "tn5250.dorm_id",\r\nFT_UINT8, BASE_HEX|BASE_RANGE_STRING, RVALS(vals_tn5250_dorm_id), 0x00,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dorm_length,\r\n{ "Length", "tn5250.dorm_length",\r\nFT_UINT8, BASE_HEX|BASE_RANGE_STRING, RVALS(vals_tn5250_dorm_length), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dorm_ec,\r\n{ "Error Code", "tn5250.dorm_ec",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dorm_mt,\r\n{ "Message Text", "tn5250.dorm_mt",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dpt_id,\r\n{ "ID", "tn5250.dpt_id",\r\nFT_UINT8, BASE_HEX|BASE_RANGE_STRING, RVALS(vals_tn5250_dpt_id), 0x00,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dpt_ec,\r\n{ "EBCDIC Code", "tn5250.dpt_ec",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_partition,\r\n{ "Partition", "tn5250.dfdpck_partition",\r\nFT_UINT8, BASE_HEX|BASE_RANGE_STRING, RVALS(vals_tn5250_rts_partition), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_data_field,\r\n{ "Data Field", "tn5250.dfdpck_data_field",\r\nFT_UINT8, BASE_HEX|BASE_RANGE_STRING, RVALS(vals_tn5250_dfdpck_data_field), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_coreflag,\r\n{ "Core Area Flag", "tn5250.dfdpck_coreflag",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_coreflag_0,\r\n{ "Bit 0", "tn5250.dfdpck_coreflag_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_coreflag_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_coreflag_1,\r\n{ "Bit 1", "tn5250.dfdpck_coreflag_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_coreflag_1),\r\n0x02, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_coreflag_2,\r\n{ "Bit 2", "tn5250.dfdpck_coreflag_2",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_coreflag_2),\r\n0x04, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_coreflag_3,\r\n{ "Bit 3", "tn5250.dfdpck_coreflag_3",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_coreflag_3),\r\n0x08, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_coreflag_4,\r\n{ "Bit 4", "tn5250.dfdpck_coreflag_4",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_coreflag_4),\r\n0x10, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_coreflag_5,\r\n{ "Bit 5", "tn5250.dfdpck_coreflag_5",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_coreflag_5),\r\n0x20, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_coreflag_6,\r\n{ "Bit 6", "tn5250.dfdpck_coreflag_6",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_coreflag_6),\r\n0x40, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_coreflag_7,\r\n{ "Bit 7", "tn5250.dfdpck_coreflag_7",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_coreflag_7),\r\n0x80, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_toprowflag1,\r\n{ "Top Row Flags", "tn5250.dfdpck_toprowflag1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_toprowflag1_0,\r\n{ "Bit 0", "tn5250.dfdpck_toprowflag1_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_toprowflag1_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_toprowflag1_1,\r\n{ "Bit 1", "tn5250.dfdpck_toprowflag1_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_toprowflag1_1),\r\n0x02, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_toprowflag1_2,\r\n{ "Bit 2", "tn5250.dfdpck_toprowflag1_2",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_toprowflag1_2),\r\n0x04, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_toprowflag1_3,\r\n{ "Bit 3", "tn5250.dfdpck_toprowflag1_3",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_toprowflag1_3),\r\n0x08, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_toprowflag1_4,\r\n{ "Bit 4", "tn5250.dfdpck_toprowflag1_4",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_toprowflag1_4),\r\n0x10, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_toprowflag1_5,\r\n{ "Bit 5", "tn5250.dfdpck_toprowflag1_5",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_toprowflag1_5),\r\n0x20, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_toprowflag1_6,\r\n{ "Bit 6", "tn5250.dfdpck_toprowflag1_6",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_toprowflag1_6),\r\n0x40, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_toprowflag1_7,\r\n{ "Bit 7", "tn5250.dfdpck_toprowflag1_7",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_toprowflag1_7),\r\n0x80, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_toprowflag2,\r\n{ "Top Row Flags", "tn5250.dfdpck_toprowflag2",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_toprowflag2_0,\r\n{ "Bit 0", "tn5250.dfdpck_toprowflag2_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_toprowflag2_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_toprowflag2_1,\r\n{ "Bit 1", "tn5250.dfdpck_toprowflag2_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_toprowflag2_1),\r\n0x02, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_toprowflag2_2,\r\n{ "Bit 2", "tn5250.dfdpck_toprowflag2_2",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_toprowflag2_2),\r\n0x04, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_toprowflag2_3,\r\n{ "Bit 3", "tn5250.dfdpck_toprowflag2_3",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_toprowflag2_3),\r\n0x08, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_toprowflag2_4,\r\n{ "Bit 4", "tn5250.dfdpck_toprowflag2_4",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_toprowflag2_4),\r\n0x10, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_toprowflag2_5,\r\n{ "Bit 5", "tn5250.dfdpck_toprowflag2_5",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_toprowflag2_5),\r\n0x20, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_toprowflag2_6,\r\n{ "Bit 6", "tn5250.dfdpck_toprowflag2_6",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_toprowflag2_6),\r\n0x40, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_toprowflag2_7,\r\n{ "Bit 7", "tn5250.dfdpck_toprowflag2_7",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_toprowflag2_7),\r\n0x80, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_toprowflag3,\r\n{ "Top Row Flags", "tn5250.dfdpck_toprowflag3",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_toprowflag3_0,\r\n{ "Bit 0", "tn5250.dfdpck_toprowflag3_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_toprowflag3_0),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_toprowflag3_1,\r\n{ "Bit 1", "tn5250.dfdpck_toprowflag3_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_toprowflag3_1),\r\n0x02, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_toprowflag3_2,\r\n{ "Bit 2", "tn5250.dfdpck_toprowflag3_2",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_toprowflag3_2),\r\n0x04, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_toprowflag3_3,\r\n{ "Bit 3", "tn5250.dfdpck_toprowflag3_3",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_toprowflag3_3),\r\n0x08, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_toprowflag3_4,\r\n{ "Bit 4", "tn5250.dfdpck_toprowflag3_4",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_toprowflag3_4),\r\n0x10, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_toprowflag3_5,\r\n{ "Bit 5", "tn5250.dfdpck_toprowflag3_5",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_toprowflag3_5),\r\n0x20, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_toprowflag3_6,\r\n{ "Bit 6", "tn5250.dfdpck_toprowflag3_6",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_toprowflag3_6),\r\n0x40, NULL, HFILL }},\r\n{ &hf_tn5250_dfdpck_toprowflag3_7,\r\n{ "Bit 7", "tn5250.dfdpck_toprowflag3_7",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_dfdpck_toprowflag3_7),\r\n0x80, NULL, HFILL }},\r\n{ &hf_tn5250_ctp_lsid,\r\n{ "Printer LSID", "tn5250.ctp_lsid",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_ctp_mlpp,\r\n{ "Max Lines Per Page", "tn5250.ctp_mlpp",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_qr_flag,\r\n{ "Flag", "tn5250.qr_flag",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_qr_flag_0,\r\n{ "Bit 1", "tn5250.qr_flag_0",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_qr_flag_0),\r\n0x80, NULL, HFILL }},\r\n{ &hf_tn5250_qr_flag_reserved,\r\n{ "Reserved", "tn5250.qr_flag_reserved", FT_UINT8, BASE_HEX,\r\nNULL, 0x7F, NULL, HFILL }},\r\n{ &hf_tn5250_qr_chc,\r\n{ "Controller Hardware Class", "tn5250.qr_chc",\r\nFT_UINT16, BASE_HEX, VALS(vals_tn5250_chc), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_qr_ccl,\r\n{ "Controller Code Level", "tn5250.qr_ccl",\r\nFT_UINT24, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_qr_dt,\r\n{ "Device Type", "tn5250.qr_dt",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_dt), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_qr_dtc,\r\n{ "Device Type", "tn5250.qr_dtc",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_qr_dm,\r\n{ "Device Model", "tn5250.qr_dm",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_qr_ki,\r\n{ "Keyboard ID", "tn5250.qr_ki",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_qr_ki), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_qr_eki,\r\n{ "Extended Keyboard ID", "tn5250.qr_eki",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_qr_dsn,\r\n{ "Display Serial Number", "tn5250.qr_dsn",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_qr_mni,\r\n{ "Maximum number of input fields", "tn5250.qr_mni",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_qr_flag1,\r\n{ "Flags", "tn5250.qr_flag1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_qr_flag1_0,\r\n{ "Bit 0 (Reserved)", "tn5250.qr_flag1_0",\r\nFT_BOOLEAN, 8, NULL,\r\n0x80, NULL, HFILL }},\r\n{ &hf_tn5250_qr_flag1_1,\r\n{ "Bit 1", "tn5250.qr_flag1_1",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_qr_flag1_1),\r\n0x40, NULL, HFILL }},\r\n{ &hf_tn5250_qr_flag1_2,\r\n{ "Bit 2", "tn5250.qr_flag1_2",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_qr_flag1_2),\r\n0x20, NULL, HFILL }},\r\n{ &hf_tn5250_qr_flag1_3,\r\n{ "Bit 3", "tn5250.qr_flag1_3",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_qr_flag1_3),\r\n0x10, NULL, HFILL }},\r\n{ &hf_tn5250_qr_flag1_4,\r\n{ "Bit 4", "tn5250.qr_flag1_4",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_qr_flag1_4),\r\n0x08, NULL, HFILL }},\r\n{ &hf_tn5250_qr_flag1_5,\r\n{ "Bit 5", "tn5250.qr_flag1_5",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_qr_flag1_5),\r\n0x04, NULL, HFILL }},\r\n{ &hf_tn5250_qr_flag1_6,\r\n{ "Bit 6", "tn5250.qr_flag1_6",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_qr_flag1_6),\r\n0x02, NULL, HFILL }},\r\n{ &hf_tn5250_qr_flag1_7,\r\n{ "Bit 7", "tn5250.qr_flag1_7",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_qr_flag1_7),\r\n0x01, NULL, HFILL }},\r\n{ &hf_tn5250_qr_flag2,\r\n{ "Flags", "tn5250.qr_flag2",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_qr_flag2_0to3,\r\n{ "Bits 0 to 3", "tn5250.qr_flag2_0to3", FT_UINT8, BASE_HEX,\r\nVALS(vals_tn5250_qr_flag2_0to3), 0xF0, NULL, HFILL }},\r\n{ &hf_tn5250_qr_flag2_4,\r\n{ "Bit 4", "tn5250.qr_flag2_4",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_qr_flag2_4),\r\n0x08, NULL, HFILL }},\r\n{ &hf_tn5250_qr_flag2_5,\r\n{ "Bit 5", "tn5250.qr_flag2_5",\r\nFT_BOOLEAN, 8, TFS(&tn5250_field_qr_flag2_5),\r\n0x04, NULL, HFILL }},\r\n{ &hf_tn5250_qr_flag2_6to7,\r\n{ "Bits 6 to 7", "tn5250.qr_flag2_6to7", FT_UINT8, BASE_HEX,\r\nVALS(vals_tn5250_qr_flag2_6to7), 0x03, NULL, HFILL }},\r\n{ &hf_tn5250_qr_flag3,\r\n{ "Flags", "tn5250.qr_flag3",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_qr_flag3), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_qr_flag4,\r\n{ "Flags", "tn5250.qr_flag4",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_qr_flag4), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_order_code, { "Order Code", "tn5250.order_code",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_order_codes), 0x0, NULL, HFILL }},\r\n{ &hf_tn5250_attribute_type, { "Attribute Type", "tn5250.attribute",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_attributes), 0x0, NULL, HFILL }},\r\n{ &hf_tn5250_aid, { "Attention Identification", "tn5250.aid",\r\nFT_UINT8, BASE_HEX|BASE_RANGE_STRING,\r\nRVALS(vals_tn5250_attention_identification_bytes), 0x0, NULL, HFILL }},\r\n{ &hf_tn5250_buffer_x, { "Row Address", "tn5250.buffer_x",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_tn5250_buffer_y, { "Column Address", "tn5250.buffer_y",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_tn5250_length, { "Length", "tn5250.length",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_tn5250_length_twobyte, { "Length", "tn5250.length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_tn5250_field_data,\r\n{ "Field Data", "tn5250.field_data", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_reserved, { "Flags (Reserved):", "tn5250.reserved",\r\nFT_UINT8, BASE_HEX|BASE_RANGE_STRING, RVALS(vals_tn5250_reserved), 0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_unknown_data,\r\n{ "Unknown Data (Possible Mainframe/Emulator Bug)", "tn5250.unknown_data",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_tn5250_logical_record_length,\r\n{ "TN5250 Logical Record Length", "tn5250.logical_record_length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_tn5250_sna_record_type,\r\n{ "TN5250 SNA Record Type", "tn5250.sna_record_type",\r\nFT_UINT16, BASE_HEX, VALS(vals_tn5250_sna_record_type), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_variable_record_length,\r\n{ "TN5250 Variable Record Length", "tn5250.variable_record_length",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_tn5250_header_flags, { "TN5250 SNA Flags", "tn5250.header_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_tn5250_ds_output_error,\r\n{ "Data Stream Output Error",\r\n"tn5250.ds_output_error", FT_BOOLEAN, 8, NULL, 0x80, NULL, HFILL }},\r\n{ &hf_tn5250_attn_key,\r\n{ "5250 attention key was pressed.",\r\n"tn5250.attn_key", FT_BOOLEAN, 8, NULL, 0x40, NULL, HFILL }},\r\n{ &hf_tn5250_sys_request_key,\r\n{ "5250 System Request key was pressed",\r\n"tn5250.sys_request_key", FT_BOOLEAN, 8, NULL, 0x04, NULL, HFILL }},\r\n{ &hf_tn5250_test_request_key,\r\n{ "5250 Test Request key was pressed",\r\n"tn5250.test_request_key", FT_BOOLEAN, 8, NULL, 0x02, NULL, HFILL }},\r\n{ &hf_tn5250_error_state,\r\n{ "In Error State",\r\n"tn5250.error_state", FT_BOOLEAN, 8, NULL, 0x01, NULL, HFILL }},\r\n{ &hf_tn5250_operation_code,\r\n{ "TN5250 Operation Code", "tn5250.operation_code",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn5250_header_operation_code), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_error_code,\r\n{ "TN5250 Error Code", "tn5250.error_code",\r\nFT_UINT16, BASE_HEX, VALS(vals_tn5250_header_error_codes), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_tn5250_negative_response,\r\n{ "Negative Response", "tn5250.negative_response",\r\nFT_UINT32, BASE_HEX, VALS(vals_tn5250_negative_responses), 0x0,\r\nNULL, HFILL }},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_tn5250,\r\n&ett_sf,\r\n&ett_tn5250_wcc,\r\n&ett_tn5250_field_attribute,\r\n&ett_tn5250_dfdpck_mask,\r\n&ett_tn5250_field_validation,\r\n&ett_tn5250_header_flags,\r\n&ett_tn5250_roll_mask,\r\n&ett_tn5250_soh_mask,\r\n&ett_tn5250_soh_pf16to9_mask,\r\n&ett_tn5250_soh_pf24to17_mask,\r\n&ett_tn5250_soh_pf8to1_mask,\r\n&ett_tn5250_sps_mask,\r\n&ett_tn5250_wdsf_cw_bp_mask,\r\n&ett_tn5250_wdsf_cw_mask,\r\n&ett_tn5250_wdsf_cw_tf_mask,\r\n&ett_tn5250_wdsf_deg_mask,\r\n&ett_tn5250_wdsf_deg_ms_mask,\r\n&ett_tn5250_wdsf_ds_ci_mask,\r\n&ett_tn5250_wdsf_ds_cpda_mask,\r\n&ett_tn5250_wdsf_ds_ct_mask,\r\n&ett_tn5250_wdsf_ds_mask,\r\n&ett_tn5250_wdsf_ds_mbs_mask,\r\n&ett_tn5250_wdsf_ds_sbi_mask,\r\n&ett_tn5250_wdsf_dsb_mask,\r\n&ett_tn5250_wdsf_pmb_mask,\r\n&ett_tn5250_wdsf_ragc_mask,\r\n&ett_tn5250_wdsf_rgw_mask,\r\n&ett_tn5250_wdsf_wdf_mask,\r\n&ett_tn5250_wsf_dpo_mask,\r\n&ett_tn5250_wsf_dsl_mask,\r\n&ett_tn5250_wsf_dtsf_mask,\r\n&ett_tn5250_wsf_qss_mask,\r\n&ett_tn5250_wsf_rts_mask,\r\n&ett_tn5250_wssf_cc_mask,\r\n&ett_tn5250_wssf_ifc_mask,\r\n&ett_tn5250_wssf_ifd_mask,\r\n&ett_tn5250_wssf_kbc_mask,\r\n&ett_tn5250_wssf_mask,\r\n&ett_tn5250_wts_mask,\r\n&ett_tn5250_wea_prim_attr,\r\n&ett_tn5250_qr_mask,\r\n&ett_cc,\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_tn5250_command_code, { "tn5250.command_code.bogus", PI_PROTOCOL, PI_WARN, "Bogus value", EXPFILL }},\r\n};\r\nexpert_module_t* expert_tn5250;\r\nproto_tn5250 = proto_register_protocol("TN5250 Protocol", "TN5250", "tn5250");\r\nregister_dissector("tn5250", dissect_tn5250, proto_tn5250);\r\nproto_register_field_array(proto_tn5250, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_tn5250 = expert_register_protocol(proto_tn5250);\r\nexpert_register_field_array(expert_tn5250, ei, array_length(ei));\r\n}
