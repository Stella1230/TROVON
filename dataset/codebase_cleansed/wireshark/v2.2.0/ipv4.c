ipv4_addr_and_mask*\r\nipv4_addr_and_mask_new(void)\r\n{\r\nipv4_addr_and_mask *ipv4;\r\nipv4 = g_new(ipv4_addr_and_mask, 1);\r\nreturn ipv4;\r\n}\r\nvoid\r\nipv4_addr_and_mask_free(ipv4_addr_and_mask *ipv4)\r\n{\r\ng_free(ipv4);\r\n}\r\nvoid\r\nipv4_addr_and_mask_set_host_order_addr(ipv4_addr_and_mask *ipv4, const guint32 new_addr)\r\n{\r\nipv4->addr = new_addr;\r\n}\r\nvoid\r\nipv4_addr_and_mask_set_net_order_addr(ipv4_addr_and_mask *ipv4, const guint32 new_addr)\r\n{\r\nipv4->addr = g_ntohl(new_addr);\r\n}\r\nvoid\r\nipv4_addr_and_mask_set_netmask_bits(ipv4_addr_and_mask *ipv4, const guint new_nmask_bits)\r\n{\r\nipv4->nmask = ip_get_subnet_mask(new_nmask_bits);\r\n}\r\nguint32\r\nipv4_get_net_order_addr(ipv4_addr_and_mask *ipv4)\r\n{\r\nreturn g_htonl(ipv4->addr);\r\n}\r\nguint32\r\nipv4_get_host_order_addr(ipv4_addr_and_mask *ipv4)\r\n{\r\nreturn ipv4->addr;\r\n}\r\nvoid\r\nipv4_addr_and_mask_str_buf(const ipv4_addr_and_mask *ipv4, gchar *buf)\r\n{\r\nguint32 ipv4_host_order = g_htonl(ipv4->addr);\r\nip_to_str_buf((guint8*)&ipv4_host_order, buf, MAX_IP_STR_LEN);\r\n}\r\ngboolean\r\nipv4_addr_and_mask_eq(const ipv4_addr_and_mask *a, const ipv4_addr_and_mask *b)\r\n{\r\nguint32 val_a, val_b, nmask;\r\nnmask = MIN(a->nmask, b->nmask);\r\nval_a = a->addr & nmask;\r\nval_b = b->addr & nmask;\r\nreturn (val_a == val_b);\r\n}\r\ngboolean\r\nipv4_addr_and_mask_gt(const ipv4_addr_and_mask *a, const ipv4_addr_and_mask *b)\r\n{\r\nguint32 val_a, val_b, nmask;\r\nnmask = MIN(a->nmask, b->nmask);\r\nval_a = a->addr & nmask;\r\nval_b = b->addr & nmask;\r\nreturn (val_a > val_b);\r\n}\r\ngboolean\r\nipv4_addr_and_mask_ge(const ipv4_addr_and_mask *a, const ipv4_addr_and_mask *b)\r\n{\r\nguint32 val_a, val_b, nmask;\r\nnmask = MIN(a->nmask, b->nmask);\r\nval_a = a->addr & nmask;\r\nval_b = b->addr & nmask;\r\nreturn (val_a >= val_b);\r\n}\r\ngboolean\r\nipv4_addr_and_mask_lt(const ipv4_addr_and_mask *a, const ipv4_addr_and_mask *b)\r\n{\r\nguint32 val_a, val_b, nmask;\r\nnmask = MIN(a->nmask, b->nmask);\r\nval_a = a->addr & nmask;\r\nval_b = b->addr & nmask;\r\nreturn (val_a < val_b);\r\n}\r\ngboolean\r\nipv4_addr_and_mask_le(const ipv4_addr_and_mask *a, const ipv4_addr_and_mask *b)\r\n{\r\nguint32 val_a, val_b, nmask;\r\nnmask = MIN(a->nmask, b->nmask);\r\nval_a = a->addr & nmask;\r\nval_b = b->addr & nmask;\r\nreturn (val_a <= val_b);\r\n}
