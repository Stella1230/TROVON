static int dissect_mac_mgmt_msg_aas_beam_select_decoder(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nguint offset = 0;\r\nproto_item *aas_beam_item;\r\nproto_tree *aas_beam_tree;\r\n{\r\naas_beam_item = proto_tree_add_protocol_format(tree, proto_mac_mgmt_msg_aas_beam_decoder, tvb, offset, -1, "AAS Beam Select (AAS-BEAM-SELECT)");\r\naas_beam_tree = proto_item_add_subtree(aas_beam_item, ett_mac_mgmt_msg_aas_beam_select_decoder);\r\nproto_tree_add_item(aas_beam_tree, hf_aas_beam_select_index, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aas_beam_tree, hf_aas_beam_select_reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic int dissect_mac_mgmt_msg_aas_beam_req_decoder(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nguint offset = 0;\r\nproto_item *aas_beam_item;\r\nproto_tree *aas_beam_tree;\r\n{\r\naas_beam_item = proto_tree_add_protocol_format(tree, proto_mac_mgmt_msg_aas_beam_decoder, tvb, offset, -1, "AAS Beam Request (AAS-BEAM-REQ)");\r\naas_beam_tree = proto_item_add_subtree(aas_beam_item, ett_mac_mgmt_msg_aas_beam_req_decoder);\r\nproto_tree_add_item(aas_beam_tree, hf_aas_beam_frame_number, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(aas_beam_tree, hf_aas_beam_feedback_request_number, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aas_beam_tree, hf_aas_beam_measurement_report_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aas_beam_tree, hf_aas_beam_resolution_parameter, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(aas_beam_tree, hf_aas_beam_beam_bit_mask, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aas_beam_tree, hf_aas_beam_select_reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic int dissect_mac_mgmt_msg_aas_beam_rsp_decoder(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nguint offset = 0;\r\nguint tvb_len, report_type;\r\nguint number_of_frequencies, indx;\r\nproto_item *aas_beam_item;\r\nproto_tree *aas_beam_tree;\r\n{\r\ntvb_len = tvb_reported_length(tvb);\r\naas_beam_item = proto_tree_add_protocol_format(tree, proto_mac_mgmt_msg_aas_beam_decoder, tvb, offset, -1, "AAS Beam Response (AAS-BEAM-RSP)");\r\naas_beam_tree = proto_item_add_subtree(aas_beam_item, ett_mac_mgmt_msg_aas_beam_rsp_decoder);\r\nproto_tree_add_item(aas_beam_tree, hf_aas_beam_frame_number, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreport_type = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(aas_beam_tree, hf_aas_beam_feedback_request_number, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aas_beam_tree, hf_aas_beam_measurement_report_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aas_beam_tree, hf_aas_beam_resolution_parameter, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(aas_beam_tree, hf_aas_beam_beam_bit_mask, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(aas_beam_tree, hf_aas_beam_select_reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nif((report_type & AAS_BEAM_MEASUREMENT_REPORT_TYPE_MASK) == 0)\r\n{\r\nnumber_of_frequencies = (tvb_len - offset) / 2 - 1;\r\nfor(indx = 0; indx < number_of_frequencies; indx++)\r\n{\r\nproto_tree_add_item(aas_beam_tree, hf_aas_beam_freq_value_re, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(aas_beam_tree, hf_aas_beam_freq_value_im, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\n}\r\n}\r\nproto_tree_add_item(aas_beam_tree, hf_aas_beam_rssi_value, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(aas_beam_tree, hf_aas_beam_cinr_value, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid proto_register_mac_mgmt_msg_aas_beam(void)\r\n{\r\nstatic hf_register_info hf_aas_beam[] =\r\n{\r\n{\r\n&hf_aas_beam_select_index,\r\n{\r\n"AAS Beam Index", "wmx.aas_beam.aas_beam_index",\r\nFT_UINT8, BASE_DEC, NULL, AAS_BEAM_SELECT_AAS_BEAM_INDEX_MASK, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_aas_beam_beam_bit_mask,\r\n{\r\n"Beam Bit Mask", "wmx.aas_beam.beam_bit_mask",\r\nFT_UINT8, BASE_HEX, NULL, AAS_BEAM_BEAM_BIT_MASK_MASK, NULL, HFILL\r\n}\r\n},\r\n#ifdef OFDM\r\n{\r\n&hf_aas_beam_cinr_value,\r\n{\r\n"CINR Mean Value", "wmx.aas_beam.cinr_mean_value",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_aas_beam_feedback_request_number,\r\n{\r\n"Feedback Request Number", "wmx.aas_beam.feedback_request_number",\r\nFT_UINT8, BASE_DEC, NULL, AAS_BEAM_FEEDBACK_REQUEST_NUMBER_MASK, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_aas_beam_frame_number,\r\n{\r\n"Frame Number", "wmx.aas_beam.frame_number",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_aas_beam_freq_value_im,\r\n{\r\n"Frequency Value (imaginary part)", "wmx.aas_beam.freq_value_im",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_aas_beam_freq_value_re,\r\n{\r\n"Frequency Value (real part)", "wmx.aas_beam.freq_value_re",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_aas_beam_measurement_report_type,\r\n{\r\n"Measurement Report Type", "wmx.aas_beam.measurement_report_type",\r\nFT_UINT8, BASE_DEC, VALS(vals_report_types), AAS_BEAM_MEASUREMENT_REPORT_TYPE_MASK, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_aas_beam_select_reserved,\r\n{\r\n"Reserved", "wmx.aas_beam.reserved",\r\nFT_UINT8, BASE_HEX, NULL, AAS_BEAM_SELECT_RESERVED_MASK, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_aas_beam_resolution_parameter,\r\n{\r\n"Resolution Parameter", "wmx.aas_beam.resolution_parameter",\r\nFT_UINT8, BASE_DEC, VALS(vals_resolution_parameter), AAS_BEAM_RESOLUTION_PARAMETER_MASK, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_aas_beam_rssi_value,\r\n{\r\n"RSSI Mean Value", "wmx.aas_beam.rssi_mean_value",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n#endif\r\n#if 0\r\n{\r\n&hf_aas_beam_unknown_type,\r\n{\r\n"Unknown TLV type", "wmx.aas_beam.unknown_type",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n}\r\n#endif\r\n};\r\nstatic gint *ett[] =\r\n{\r\n&ett_mac_mgmt_msg_aas_beam_select_decoder,\r\n&ett_mac_mgmt_msg_aas_beam_req_decoder,\r\n&ett_mac_mgmt_msg_aas_beam_rsp_decoder,\r\n};\r\nproto_mac_mgmt_msg_aas_beam_decoder = proto_register_protocol (\r\n"WiMax AAS-BEAM Messages",\r\n"WiMax AAS-BEAM",\r\n"wmx.aas_beam"\r\n);\r\nproto_register_field_array(proto_mac_mgmt_msg_aas_beam_decoder, hf_aas_beam, array_length(hf_aas_beam));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nregister_dissector("mac_mgmt_msg_aas_beam_select_handler", dissect_mac_mgmt_msg_aas_beam_select_decoder, -1);\r\n#ifdef OFDM\r\nregister_dissector("mac_mgmt_msg_aas_beam_req_handler", dissect_mac_mgmt_msg_aas_beam_req_decoder, -1);\r\nregister_dissector("mac_mgmt_msg_aas_beam_rsp_handler", dissect_mac_mgmt_msg_aas_beam_rsp_decoder, -1);\r\n#endif\r\n}\r\nvoid\r\nproto_reg_handoff_mac_mgmt_msg_aas_beam(void)\r\n{\r\ndissector_handle_t aas_handle;\r\naas_handle = create_dissector_handle(dissect_mac_mgmt_msg_aas_beam_select_decoder, proto_mac_mgmt_msg_aas_beam_decoder);\r\ndissector_add_uint("wmx.mgmtmsg", MAC_MGMT_MSG_AAS_BEAM_SELECT, aas_handle);\r\n}
