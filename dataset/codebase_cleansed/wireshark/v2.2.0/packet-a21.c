static void\r\ndissect_a21_correlation_id(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, proto_item *item _U_, guint16 length _U_, guint8 message_type _U_)\r\n{\r\nint offset = 0;\r\nproto_item *tc;\r\nproto_tree *corr_tree;\r\nif (tree == NULL)\r\nreturn;\r\ntc = proto_tree_add_item(tree, hf_a21_corr_id, tvb, offset, 6, ENC_BIG_ENDIAN);\r\ncorr_tree = proto_item_add_subtree(tc,ett_a21_corr_id);\r\nproto_tree_add_item(corr_tree, hf_a21_element_identifier, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(corr_tree, hf_a21_element_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(corr_tree, hf_a21_corr_id_corr_value, tvb, offset, 4, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_a21_mobile_identity(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, proto_item *item, guint16 length, guint8 message_type _U_)\r\n{\r\nint offset = 0;\r\nguint identity_type;\r\nconst gchar *imsi_str;\r\nif (tree == NULL)\r\nreturn;\r\nidentity_type = tvb_get_guint8(tvb, offset) & 0x07;\r\nproto_tree_add_item(tree, hf_a21_mn_id_type_of_identity, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nswitch (identity_type) {\r\ncase 0:\r\nproto_tree_add_item(tree, hf_a21_mn_id_msid_value, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 1:\r\nproto_tree_add_item(tree, hf_a21_mn_id_odd_even_indicator, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 5:\r\nproto_tree_add_item(tree, hf_a21_mn_id_odd_even_indicator, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_a21_mn_id_identity_digit_1, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(tree, hf_a21_mn_id_esn, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 6:\r\nproto_tree_add_item(tree, hf_a21_mn_id_odd_even_indicator, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nimsi_str = dissect_e212_imsi(tvb, pinfo, tree, offset, length, TRUE);\r\nproto_item_append_text(item, "%s", imsi_str);\r\nbreak;\r\n}\r\n}\r\nstatic void\r\ndissect_a21_1x_message_transmission_control(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, proto_item *item _U_, guint16 length _U_, guint8 message_type _U_)\r\n{\r\nint offset = 0;\r\nif (tree == NULL)\r\nreturn;\r\nproto_tree_add_item(tree, hf_a21_reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_a21_msg_tran_ctrl_paging_msg, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_a21_msg_tran_ctrl_simul_xmit_with_next, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_a21_msg_tran_ctrl_ackrequired, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_a21_msg_tran_ctrl_3GXLogicalChannel, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(tree, hf_a21_msg_tran_ctrl_protocol_revision, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_a21_1x_lac_encapsulated_pdu(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, proto_item *item _U_, guint16 length _U_, guint8 message_type _U_)\r\n{\r\nint offset = 0;\r\nproto_tree_add_item(tree, hf_a21_1x_lac_en_pdu, tvb, offset, 3, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_a21_1x_parameters(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, proto_item *item _U_, guint16 length, guint8 message_type _U_)\r\n{\r\nproto_tree_add_item(tree, hf_a21_3G1X_parameters, tvb, 0,length, ENC_NA);\r\n}\r\nstatic void\r\ndissect_a21_pilot_list(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, proto_item *item _U_, guint16 length, guint8 message_type _U_)\r\n{\r\nint offset = 0;\r\nguint8 num;\r\nnum = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_a21_pilot_list_num_of_pilots, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nif (num>0) {\r\nproto_tree_add_item(tree, hf_a21_pilot_list_value, tvb, offset, length-1, ENC_NA);\r\n}\r\n}\r\nstatic void\r\ndissect_a21_authentication_challenge_parameter(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, proto_item *item _U_, guint16 length _U_, guint8 message_type _U_)\r\n{\r\nint offset = 0;\r\nguint type;\r\nif (tree == NULL)\r\nreturn;\r\ntype = tvb_get_guint8(tvb, offset) & 0x0f;\r\nproto_tree_add_item(tree, hf_a21_reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_a21_auth_chall_para_rand_num_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nswitch (type) {\r\ncase 1:\r\nproto_tree_add_item(tree, hf_a21_auth_chall_para_rand_value, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\n}\r\nstatic void\r\ndissect_a21_mobile_subscription_information(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, proto_item *item _U_, guint16 length, guint8 message_type _U_)\r\n{\r\nint offset = 0;\r\nint i = 0;\r\nguint8 record_id;\r\nguint16 record_len = 0;\r\nproto_tree *record_tree;\r\nif (tree == NULL)\r\nreturn;\r\nwhile (offset<length) {\r\nrecord_id = tvb_get_guint8(tvb, offset);\r\nrecord_len = tvb_get_guint8(tvb, offset+1);\r\nrecord_tree = proto_tree_add_subtree_format(tree, tvb, offset+2, record_len,\r\nett_a21_record_content, NULL, "Record %u",i+1);\r\nproto_tree_add_item(record_tree, hf_a21_mob_sub_info_record_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(record_tree, hf_a21_mob_sub_info_record_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nif (record_id == 0) {\r\nproto_tree_add_item(record_tree, hf_a21_mob_sub_info_re_con_all_band_inc, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(record_tree, hf_a21_mob_sub_info_re_con_curr_band_sub, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(record_tree, hf_a21_mob_sub_info_re_band_class, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(record_tree, hf_a21_mob_sub_info_re_con_all_sub_band_inc, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(record_tree, hf_a21_mob_sub_info_re_sub_cls_len, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += record_len-2;\r\n} else {\r\nproto_tree_add_item(record_tree, hf_a21_mob_sub_info_record_content, tvb, offset, record_len, ENC_NA);\r\noffset += record_len;\r\n}\r\n}\r\n}\r\nstatic void\r\ndissect_a21_gcsna_status(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, proto_item *item _U_, guint16 length _U_, guint8 message_type _U_)\r\n{\r\nint offset = 0;\r\nguint8 priority_incl, status_incl;\r\nif (tree == NULL)\r\nreturn;\r\nstatus_incl = tvb_get_guint8(tvb, offset) & 0x01;\r\npriority_incl = tvb_get_guint8(tvb, offset) & 0x04;\r\nproto_tree_add_item(tree, hf_a21_gcsna_status_reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_a21_gcsna_status_priority_incl, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_a21_gcsna_status_gec, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_a21_gcsna_status_status_incl, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nif (status_incl == 1) {\r\nproto_tree_add_item(tree, hf_a21_gcsna_status, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\n}\r\nif (priority_incl == 1) {\r\nproto_tree_add_item(tree, hf_a21_reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_a21_gcsna_status_call_priority, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_a21_gcsna_pdu(tvbuff_t *tvb, packet_info *pinfo, proto_tree *top_tree, proto_tree *tree, proto_item *item _U_, guint16 length, guint8 message_type _U_)\r\n{\r\nint offset = 0;\r\nproto_tree_add_item(tree, hf_a21_gcsna_content, tvb, offset, length, ENC_NA);\r\nif (gcsna_handle) {\r\ntvbuff_t *new_tvb;\r\nnew_tvb = tvb_new_subset_length(tvb, offset, length);\r\ncall_dissector(gcsna_handle, new_tvb, pinfo, top_tree);\r\n}\r\n}\r\nstatic void\r\ndissect_a21_reference_cell_id(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, proto_item *item _U_, guint16 length _U_, guint8 message_type _U_)\r\n{\r\nint offset = 0;\r\nif (tree == NULL)\r\nreturn;\r\nproto_tree_add_item(tree, hf_a21_mscid_market_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_a21_mscid_switch_number, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_a21_reference_cell_id_cell, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(tree, hf_a21_reference_cell_id_sector, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_a21_cause(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, proto_item *item _U_, guint16 length _U_, guint8 message_type _U_)\r\n{\r\nint offset = 0;\r\nproto_tree_add_item(tree, hf_a21_cause_value, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_a21_event(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, proto_item *item, guint16 length, guint8 message_type _U_)\r\n{\r\nint offset = 0;\r\nguint8 event_id;\r\nif (tree == NULL)\r\nreturn;\r\nevent_id = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_a21_event, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_item_append_text(item, "%s", val_to_str_const(event_id, a21_event_vals, "Unknown"));\r\noffset++;\r\nif (length>1) {\r\nif (event_id == 7) {\r\nproto_tree_add_item(tree, hf_a21_allowed_forward_link_message, tvb, offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nelse {\r\nproto_tree_add_item(tree, hf_a21_additional_event_info, tvb, offset, 2, ENC_BIG_ENDIAN);\r\n}\r\n}\r\n}\r\nstatic void\r\ndissect_a21_service_option(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, proto_item *item _U_, guint16 length _U_, guint8 message_type _U_)\r\n{\r\nint offset = 0;\r\nproto_tree_add_item(tree, hf_a21_service_option, tvb, offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nstatic void\r\ndissect_a21_unknown(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, proto_item *item _U_, guint16 length, guint8 message_type _U_)\r\n{\r\nproto_tree_add_expert(tree, pinfo, &ei_a21_ie_data_not_dissected_yet, tvb, 0, length);\r\n}\r\nvoid\r\ndissect_a21_ie_common(tvbuff_t *tvb, packet_info *pinfo, proto_tree *top_tree, proto_tree *tree, gint offset, guint8 message_type)\r\n{\r\nguint8 ie_type, length_len;\r\nguint16 length = 0;\r\ntvbuff_t *ie_tvb;\r\nproto_tree *ie_tree;\r\nproto_item *ti;\r\nwhile (offset < (gint)tvb_reported_length(tvb)) {\r\nie_type = tvb_get_guint8(tvb, offset);\r\nif (ie_type == A21_IEI_GCSNA_PDU) {\r\nlength_len = 2;\r\nlength = tvb_get_ntohs(tvb, offset+1);\r\n} else {\r\nlength_len = 1;\r\nlength = tvb_get_guint8(tvb, offset+1);\r\n}\r\nie_tree = proto_tree_add_subtree_format(tree, tvb, offset, 1 + length_len + length, ett_a21_ie, &ti,\r\n"%s : ", val_to_str_const(ie_type, a21_element_type_vals, "Unknown"));\r\nproto_tree_add_item(ie_tree, hf_a21_element_identifier, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ie_tree, hf_a21_gcsna_pdu_length, tvb, offset, length_len, ENC_BIG_ENDIAN);\r\noffset = offset+length_len;\r\nie_tvb = tvb_new_subset_remaining(tvb, offset);\r\nswitch (ie_type) {\r\ncase A21_IEI_1X_LAC_ENCAPSULATED_PDU:\r\ndissect_a21_1x_lac_encapsulated_pdu(ie_tvb,pinfo, ie_tree, ti, length, message_type);\r\nbreak;\r\ncase A21_IEI_A21_1X_PARAMETERS:\r\ndissect_a21_1x_parameters(ie_tvb,pinfo, ie_tree, ti, length, message_type);\r\nbreak;\r\ncase A21_IEI_PILOT_LIST:\r\ndissect_a21_pilot_list(ie_tvb,pinfo, ie_tree, ti, length, message_type);\r\nbreak;\r\ncase A21_IEI_CORRELATION_ID:\r\ndissect_a21_correlation_id(ie_tvb,pinfo, ie_tree, ti, length, message_type);\r\nbreak;\r\ncase A21_IEI_MOBILE_IDENTITY:\r\ndissect_a21_mobile_identity(ie_tvb,pinfo, ie_tree, ti, length, message_type);\r\nbreak;\r\ncase A21_IEI_AUTHENTICATION_CHALLENGE_PARAMETER:\r\ndissect_a21_authentication_challenge_parameter(ie_tvb,pinfo, ie_tree, ti, length, message_type);\r\nbreak;\r\ncase A21_IEI_A21_1X_MESSAGE_TRANSMISSION_CONTROL:\r\ndissect_a21_1x_message_transmission_control(ie_tvb,pinfo, ie_tree, ti, length, message_type);\r\nbreak;\r\ncase A21_IEI_A21_CAUSE:\r\ndissect_a21_cause(ie_tvb,pinfo, ie_tree, ti, length, message_type);\r\nbreak;\r\ncase A21_IEI_A21_EVENT:\r\ndissect_a21_event(ie_tvb,pinfo, ie_tree, ti, length, message_type);\r\nbreak;\r\ncase A21_IEI_SERVICE_OPTION:\r\ndissect_a21_service_option(ie_tvb,pinfo, ie_tree, ti, length, message_type);\r\nbreak;\r\ncase A21_IEI_A21_MOBILE_SUBSCRIPTION_INFORMATION:\r\ndissect_a21_mobile_subscription_information(ie_tvb,pinfo, ie_tree, ti, length, message_type);\r\nbreak;\r\ncase A21_IEI_GCSNA_STATUS:\r\ndissect_a21_gcsna_status(ie_tvb,pinfo, ie_tree, ti, length, message_type);\r\nbreak;\r\ncase A21_IEI_GCSNA_PDU:\r\ndissect_a21_gcsna_pdu(ie_tvb,pinfo, top_tree, ie_tree, ti, length, message_type);\r\nbreak;\r\ncase A21_IEI_REFERENCE_CELL_ID:\r\ndissect_a21_reference_cell_id(ie_tvb,pinfo, ie_tree, ti, length, message_type);\r\nbreak;\r\ndefault:\r\ndissect_a21_unknown(ie_tvb,pinfo, ie_tree, ti, length, message_type);\r\nbreak;\r\n}\r\noffset = offset + length;\r\n}\r\n}\r\nstatic int\r\ndissect_a21(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nguint8 message_type;\r\nint offset = 0;\r\nproto_item *ti, *tc;\r\nproto_tree *a21_tree, *corr_tree;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "A21");\r\ncol_clear(pinfo->cinfo, COL_INFO);\r\nmessage_type = tvb_get_guint8(tvb, offset);\r\ncol_set_str(pinfo->cinfo, COL_INFO, val_to_str_const(message_type, a21_message_type_vals, "Unknown"));\r\nti = proto_tree_add_protocol_format(tree, proto_a21, tvb, 0, -1,\r\n"A21 Protocol: %s",\r\nval_to_str_const(message_type, a21_message_type_vals, "Unknown"));\r\na21_tree = proto_item_add_subtree(ti, ett_a21);\r\nproto_tree_add_item(a21_tree, hf_a21_message_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\ntc = proto_tree_add_item(a21_tree, hf_a21_corr_id, tvb, offset, 6, ENC_BIG_ENDIAN);\r\ncorr_tree = proto_item_add_subtree(tc,ett_a21_corr_id);\r\nproto_tree_add_item(corr_tree, hf_a21_element_identifier, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(corr_tree, hf_a21_element_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(corr_tree, hf_a21_corr_id_corr_value, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\ndissect_a21_ie_common(tvb, pinfo, tree, a21_tree, offset, message_type);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid proto_register_a21(void)\r\n{\r\nstatic hf_register_info hf_a21[] = {\r\n{ &hf_a21_message_type,\r\n{"Message Type", "a21.message_type",\r\nFT_UINT8, BASE_DEC, VALS(a21_message_type_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_corr_id,\r\n{"A21 Correlation ID", "a21.correlation_id",\r\nFT_UINT64, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_element_identifier,\r\n{"A21 Element Identifier", "a21.element_identifier",\r\nFT_UINT8, BASE_DEC, VALS(a21_element_type_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_element_length,\r\n{"Length", "a21.length",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_corr_id_corr_value,\r\n{"Correlation Value", "a21.corr_id_corr_value",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_mn_id_msid_value,\r\n{"MSID Value", "a21.mn_id_msid_value",\r\nFT_UINT8, BASE_DEC, NULL, 0xf8,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_mn_id_identity_digit_1,\r\n{"Identity Digit 1", "a21.mn_id_identity_digit_1",\r\nFT_UINT8, BASE_DEC, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_mn_id_odd_even_indicator,\r\n{"Odd/Even Indicator", "a21.mn_id_odd_even_indicator",\r\nFT_UINT8, BASE_DEC, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_mn_id_type_of_identity,\r\n{"Type of Identity", "a21.mn_id_type_of_identity",\r\nFT_UINT8, BASE_DEC, VALS(a21_mn_id_type_of_identity_vals), 0x07,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_mn_id_esn,\r\n{"ESN", "a21.mn_id_esn",\r\nFT_UINT8, BASE_DEC, NULL, 0x7f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_reserved,\r\n{"Reserved", "a21.reserved",\r\nFT_UINT8, BASE_DEC, NULL, 0xf0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_msg_tran_ctrl_paging_msg,\r\n{"Paging Message", "a21.msg_tran_ctrl_paging_msg",\r\nFT_UINT8, BASE_DEC, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_msg_tran_ctrl_simul_xmit_with_next,\r\n{"Simul Xmit with Next", "a21.msg_tran_ctrl_simul_xmit_with_next",\r\nFT_UINT8, BASE_DEC, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_msg_tran_ctrl_ackrequired,\r\n{"AckRequired", "a21.msg_tran_ctrl_ackrequired",\r\nFT_UINT8, BASE_DEC, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_msg_tran_ctrl_3GXLogicalChannel,\r\n{"3GXLogicalChannel", "a21.msg_tran_ctrl_3GXLogicalChannel",\r\nFT_UINT8, BASE_DEC, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_msg_tran_ctrl_protocol_revision,\r\n{"ProtocolRevision", "a21.msg_tran_ctrl_protocol_revision",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_1x_lac_en_pdu,\r\n{"1x LAC Encapsulated PDU", "a21.1x_lac_en_pdu",\r\nFT_UINT24, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_pilot_list_num_of_pilots,\r\n{"Number of Pilots", "a21.pilot_list_num_of_pilots",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_pilot_list_value,\r\n{"Pilot List Value", "a21.pilot_list_value",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_cause_value,\r\n{"A21 Cause Value", "a21.cause_value",\r\nFT_UINT8, BASE_DEC, VALS(a21_cause_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_mscid_market_id,\r\n{"Market ID", "a21.mscid_market_id",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_mscid_switch_number,\r\n{"Switch Number", "a21.mscid_switch_number",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_event,\r\n{"Event", "a21.event",\r\nFT_UINT8, BASE_DEC, VALS(a21_event_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_additional_event_info,\r\n{"Additional Event Info", "a21.additional_event_info",\r\nFT_UINT16, BASE_DEC, VALS(a21_additional_event_info_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_allowed_forward_link_message,\r\n{"Allowed Forward Link Messages", "a21.allowed_forward_link_message",\r\nFT_UINT16, BASE_DEC, VALS(a21_additional_event_info_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_gcsna_pdu_length,\r\n{"Length", "a21.gcsna_pdu_length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_gcsna_content,\r\n{"GCSNA Content", "a21.gcsna_content",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_reference_cell_id_cell,\r\n{"Cell", "a21.reference_cell_id_cell",\r\nFT_UINT16, BASE_DEC, NULL, 0xfff0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_reference_cell_id_sector,\r\n{"Sector", "a21.reference_cell_id_sector",\r\nFT_UINT8, BASE_DEC, NULL, 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_mob_sub_info_record_id,\r\n{"Record Identifier", "a21.mob_sub_info_record_id",\r\nFT_UINT8, BASE_DEC, VALS(a21_record_identifier_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_mob_sub_info_record_length,\r\n{"Record Length", "a21.mob_sub_info_record_length",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_mob_sub_info_record_content,\r\n{"Record Content", "a21.mob_sub_info_record_content",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_mob_sub_info_re_con_all_band_inc,\r\n{"All Band Classes Included", "a21.mob_sub_info_re_con_all_band_inc",\r\nFT_UINT8, BASE_DEC, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_mob_sub_info_re_con_curr_band_sub,\r\n{"Current Band Subclass", "a21.mob_sub_info_re_con_curr_band_sub",\r\nFT_UINT8, BASE_DEC, NULL, 0x7f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_mob_sub_info_re_band_class,\r\n{"Band Class", "a21.mob_sub_info_re_band_class",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_mob_sub_info_re_con_all_sub_band_inc,\r\n{"All Band Subclasses Included", "a21.mob_sub_info_re_con_all_sub_band_inc",\r\nFT_UINT8, BASE_DEC, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_mob_sub_info_re_sub_cls_len,\r\n{"Subclass Length", "a21.mob_sub_info_re_sub_cls_len",\r\nFT_UINT8, BASE_DEC, NULL, 0x0f,\r\nNULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_a21_mob_sub_info_re_con_band_class,\r\n{"Band Class", "a21.mob_sub_info_re_con_band_class",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_a21_auth_chall_para_rand_num_type,\r\n{"Random Number Type", "a21.auth_chall_para_rand_num_type",\r\nFT_UINT8, BASE_DEC|BASE_RANGE_STRING, RVALS(a21_random_number_type_rvals), 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_auth_chall_para_rand_value,\r\n{"RAND Value", "a21.auth_chall_para_rand_value",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_service_option,\r\n{"Service Option", "a21.service_option",\r\nFT_UINT8, BASE_DEC, VALS(a21_service_option_vals), 0x7f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_gcsna_status_reserved,\r\n{"Reserved", "a21.gcsna_status_reserved",\r\nFT_UINT8, BASE_DEC, NULL, 0xf8,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_gcsna_status_priority_incl,\r\n{"Priority Incl", "a21.gcsna_status_priority_incl",\r\nFT_UINT8, BASE_DEC, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_gcsna_status_gec,\r\n{"GEC", "a21.gcsna_status_gec",\r\nFT_UINT8, BASE_DEC, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_gcsna_status_status_incl,\r\n{"Status Incl", "a21.gcsna_status_status_incl",\r\nFT_UINT8, BASE_DEC, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_gcsna_status,\r\n{"Status", "a21.gcsna_status",\r\nFT_UINT8, BASE_DEC, VALS(a21_gcsna_status_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_gcsna_status_call_priority,\r\n{"Call Priority", "a21.gcsna_status_call_priority",\r\nFT_UINT8, BASE_DEC, NULL, 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_a21_3G1X_parameters,\r\n{"3G1X Parameters", "a21.3G1X_parameters",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n};\r\nstatic gint *ett_a21_array[] = {\r\n&ett_a21,\r\n&ett_a21_corr_id,\r\n&ett_a21_ie,\r\n&ett_a21_record_content\r\n};\r\nmodule_t *a21_module;\r\nexpert_module_t *expert_a21;\r\nstatic ei_register_info ei[] = {\r\n{ &ei_a21_ie_data_not_dissected_yet,\r\n{ "a21.ie_data_not_dissected_yet",\r\nPI_PROTOCOL, PI_NOTE, "IE data not dissected yet", EXPFILL }},\r\n};\r\nproto_a21 = proto_register_protocol("A21 Protocol", "A21", "a21");\r\nproto_register_field_array(proto_a21, hf_a21, array_length(hf_a21));\r\nproto_register_subtree_array(ett_a21_array, array_length(ett_a21_array));\r\nexpert_a21 = expert_register_protocol(proto_a21);\r\nexpert_register_field_array(expert_a21, ei, array_length(ei));\r\na21_module = prefs_register_protocol(proto_a21, proto_reg_handoff_a21);\r\nprefs_register_uint_preference(a21_module, "udp.port",\r\n"A21 UDP Port",\r\n"UDP port used by A21, usually 23272",\r\n10, &a21_udp_port);\r\n}\r\nvoid proto_reg_handoff_a21(void)\r\n{\r\nstatic dissector_handle_t a21_handle;\r\nstatic gboolean a21_prefs_initialized = FALSE;\r\nstatic guint saved_a21_udp_port;\r\nif (!a21_prefs_initialized) {\r\na21_handle = create_dissector_handle(dissect_a21, proto_a21);\r\ngcsna_handle = find_dissector_add_dependency("gcsna", proto_a21);\r\ndissector_add_uint("udp.port", a21_udp_port, a21_handle);\r\na21_prefs_initialized = TRUE;\r\n} else {\r\ndissector_delete_uint("udp.port", saved_a21_udp_port, a21_handle);\r\n}\r\nsaved_a21_udp_port = a21_udp_port;\r\nif (a21_udp_port != 0) {\r\ndissector_add_uint("udp.port", a21_udp_port, a21_handle);\r\n}\r\n}
