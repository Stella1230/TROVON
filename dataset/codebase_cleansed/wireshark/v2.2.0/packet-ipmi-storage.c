static void\r\nrq10(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_ipmi_stor_10_fruid, tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nrs10(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nstatic const int *flags[] = { &hf_ipmi_stor_10_access, NULL };\r\nproto_tree_add_item(tree, hf_ipmi_stor_10_size, tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_bitmask_text(tree, tvb, 2, 1, NULL, NULL, ett_ipmi_stor_10_flags, flags, ENC_LITTLE_ENDIAN, 0);\r\n}\r\nstatic void\r\nrq11(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_ipmi_stor_11_fruid, tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_11_offset, tvb, 1, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_11_count, tvb, 3, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nrs11(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_ipmi_stor_11_ret_count, tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_11_data, tvb, 1, -1, ENC_NA);\r\n}\r\nstatic void\r\nrq12(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_ipmi_stor_12_fruid, tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_12_offset, tvb, 1, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_12_data, tvb, 3, -1, ENC_NA);\r\n}\r\nstatic void\r\nrs12(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_ipmi_stor_12_ret_count, tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nrs20(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nstatic const int *ops[] = { &hf_ipmi_stor_20_op_overflow, &hf_ipmi_stor_20_op_update,\r\n&hf_ipmi_stor_20_op_delete, &hf_ipmi_stor_20_op_partial_add, &hf_ipmi_stor_20_op_reserve,\r\n&hf_ipmi_stor_20_op_allocinfo, NULL };\r\nproto_tree_add_item(tree, hf_ipmi_stor_20_sdr_version, tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_20_rec_count, tvb, 1, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_20_free_space, tvb, 3, 2, ENC_LITTLE_ENDIAN);\r\nipmi_add_timestamp(tree, hf_ipmi_stor_20_ts_add, tvb, 5);\r\nipmi_add_timestamp(tree, hf_ipmi_stor_20_ts_erase, tvb, 9);\r\nproto_tree_add_bitmask_text(tree, tvb, 13, 1, "Operation Support: ", NULL,\r\nett_ipmi_stor_20_ops, ops, ENC_LITTLE_ENDIAN, 0);\r\n}\r\nstatic void\r\nrs21(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_ipmi_stor_21_units, tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_21_size, tvb, 2, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_21_free, tvb, 4, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_21_largest, tvb, 6, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_21_maxrec, tvb, 8, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nrs22(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_ipmi_stor_22_rsrv_id, tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nrq23(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nguint8 v = tvb_get_guint8(tvb, 5);\r\nproto_tree_add_item(tree, hf_ipmi_stor_23_rsrv_id, tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_23_rec_id, tvb, 2, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_23_offset, tvb, 4, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_uint_format_value(tree, hf_ipmi_stor_23_count, tvb, 5, 1,\r\nv, "%d%s", v, v == 0xff ? " (entire record)" : "");\r\n}\r\nstatic void\r\nrs23(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_ipmi_stor_23_next, tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_23_data, tvb, 2, -1, ENC_NA);\r\n}\r\nstatic void\r\nrq24(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_ipmi_stor_24_data, tvb, 0, -1, ENC_NA);\r\n}\r\nstatic void\r\nrs24(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_ipmi_stor_24_added_rec_id, tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nrq25(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nstatic const int *byte6[] = { &hf_ipmi_stor_25_inprogress, NULL };\r\nproto_tree_add_item(tree, hf_ipmi_stor_25_rsrv_id, tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_25_rec_id, tvb, 2, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_25_offset, tvb, 4, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_bitmask_text(tree, tvb, 5, 1, NULL, NULL,\r\nett_ipmi_stor_25_byte6, byte6, ENC_LITTLE_ENDIAN, 0);\r\nproto_tree_add_item(tree, hf_ipmi_stor_25_data, tvb, 6, -1, ENC_NA);\r\n}\r\nstatic void\r\nrs25(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_ipmi_stor_25_added_rec_id, tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nrq26(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_ipmi_stor_25_rsrv_id, tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_25_rec_id, tvb, 2, 2, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nrs26(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_ipmi_stor_26_del_rec_id, tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nrq27(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_ipmi_stor_27_rsrv_id, tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_27_clr, tvb, 2, 3, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(tree, hf_ipmi_stor_27_action, tvb, 5, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nrs27(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nstatic const int *status[] = { &hf_ipmi_stor_27_status, NULL };\r\nproto_tree_add_bitmask_text(tree, tvb, 0, 1, NULL, NULL,\r\nett_ipmi_stor_27_status, status, ENC_LITTLE_ENDIAN, 0);\r\n}\r\nstatic void\r\nrs28(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nipmi_add_timestamp(tree, hf_ipmi_stor_28_time, tvb, 0);\r\n}\r\nstatic void\r\nrq29(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nipmi_add_timestamp(tree, hf_ipmi_stor_29_time, tvb, 0);\r\n}\r\nstatic void\r\nrq2c(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nstatic const int *byte1[] = { &hf_ipmi_stor_2c_init_agent, NULL };\r\nproto_tree_add_bitmask_text(tree, tvb, 0, 1, NULL, NULL,\r\nett_ipmi_stor_2c_rq_byte1, byte1, ENC_LITTLE_ENDIAN, 0);\r\n}\r\nstatic void\r\nrs2c(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nstatic const int *byte1[] = { &hf_ipmi_stor_2c_init_state, NULL };\r\nproto_tree_add_bitmask_text(tree, tvb, 0, 1, NULL, NULL,\r\nett_ipmi_stor_2c_rs_byte1, byte1, ENC_LITTLE_ENDIAN, 0);\r\n}\r\nstatic void\r\nrs40(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nstatic const int *ops[] = { &hf_ipmi_stor_40_op_overflow, &hf_ipmi_stor_40_op_delete,\r\n&hf_ipmi_stor_40_op_partial_add, &hf_ipmi_stor_40_op_reserve, &hf_ipmi_stor_40_op_allocinfo, NULL };\r\nproto_tree_add_item(tree, hf_ipmi_stor_40_sel_version, tvb, 0, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_40_entries, tvb, 1, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_40_free_space, tvb, 3, 2, ENC_LITTLE_ENDIAN);\r\nipmi_add_timestamp(tree, hf_ipmi_stor_40_ts_add, tvb, 5);\r\nipmi_add_timestamp(tree, hf_ipmi_stor_40_ts_erase, tvb, 9);\r\nproto_tree_add_bitmask_text(tree, tvb, 13, 1, "Operation Support: ", NULL,\r\nett_ipmi_stor_40_ops, ops, ENC_LITTLE_ENDIAN, 0);\r\n}\r\nstatic void\r\nrs41(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_ipmi_stor_41_units, tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_41_size, tvb, 2, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_41_free, tvb, 4, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_41_largest, tvb, 6, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_41_maxrec, tvb, 8, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nrs42(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_ipmi_stor_42_rsrv_id, tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nrq43(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nguint8 v = tvb_get_guint8(tvb, 5);\r\nproto_tree_add_item(tree, hf_ipmi_stor_43_rsrv_id, tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_43_rec_id, tvb, 2, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_43_offset, tvb, 4, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_uint_format_value(tree, hf_ipmi_stor_43_count, tvb, 5, 1,\r\nv, "%d%s", v, v == 0xff ? " (entire record)" : "");\r\n}\r\nstatic void\r\nrs43(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_ipmi_stor_43_next, tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_43_data, tvb, 2, -1, ENC_NA);\r\n}\r\nstatic void\r\nrq44(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_ipmi_stor_44_data, tvb, 0, -1, ENC_NA);\r\n}\r\nstatic void\r\nrs44(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_ipmi_stor_44_added_rec_id, tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nrq45(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nstatic const int *byte6[] = { &hf_ipmi_stor_45_inprogress, NULL };\r\nproto_tree_add_item(tree, hf_ipmi_stor_45_rsrv_id, tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_45_rec_id, tvb, 2, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_45_offset, tvb, 4, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_bitmask_text(tree, tvb, 5, 1, NULL, NULL,\r\nett_ipmi_stor_45_byte6, byte6, ENC_LITTLE_ENDIAN, 0);\r\nproto_tree_add_item(tree, hf_ipmi_stor_45_data, tvb, 6, -1, ENC_NA);\r\n}\r\nstatic void\r\nrs45(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_ipmi_stor_45_added_rec_id, tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nrq46(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_ipmi_stor_45_rsrv_id, tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_45_rec_id, tvb, 2, 2, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nrs46(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_ipmi_stor_46_del_rec_id, tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nrq47(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nproto_tree_add_item(tree, hf_ipmi_stor_47_rsrv_id, tvb, 0, 2, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_47_clr, tvb, 2, 3, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(tree, hf_ipmi_stor_47_action, tvb, 5, 1, ENC_LITTLE_ENDIAN);\r\n}\r\nstatic void\r\nrs47(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nstatic const int *status[] = { &hf_ipmi_stor_47_status, NULL };\r\nproto_tree_add_bitmask_text(tree, tvb, 0, 1, NULL, NULL,\r\nett_ipmi_stor_47_status, status, ENC_LITTLE_ENDIAN, 0);\r\n}\r\nstatic void\r\nrs48(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nipmi_add_timestamp(tree, hf_ipmi_stor_48_time, tvb, 0);\r\n}\r\nstatic void\r\nrq49(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nipmi_add_timestamp(tree, hf_ipmi_stor_49_time, tvb, 0);\r\n}\r\nstatic void\r\nrq5a(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nstatic const int *byte1[] = { &hf_ipmi_stor_5a_log_type, NULL };\r\nipmi_set_data(pinfo, 0, tvb_get_guint8(tvb, 0) & 0x0f);\r\nif (!tree) {\r\nreturn;\r\n}\r\nproto_tree_add_bitmask_text(tree, tvb, 0, 1, NULL, NULL,\r\nett_ipmi_stor_5a_byte1, byte1, ENC_LITTLE_ENDIAN, 0);\r\n}\r\nstatic void\r\nrs5a(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nguint32 v;\r\nif (!ipmi_get_data(pinfo, 0, &v) || v > 2) {\r\nproto_tree_add_item(tree, hf_ipmi_stor_5a_unknown, tvb, 0, -1, ENC_NA);\r\nreturn;\r\n}\r\nipmi_add_timestamp(tree, hf_ipmi_stor_5a_ts_add, tvb, 0);\r\nif (v == 0) {\r\nproto_tree_add_item(tree, hf_ipmi_stor_5a_num_entries, tvb, 4, 4, ENC_LITTLE_ENDIAN);\r\n} else if (v == 1 || v == 2) {\r\nproto_tree_add_item(tree, hf_ipmi_stor_5a_iana, tvb, 4, 3, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_5a_bytes, tvb, 7, 7, ENC_NA);\r\n}\r\n}\r\nstatic void\r\nrq5b(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nstatic const int *byte1[] = { &hf_ipmi_stor_5b_log_type, NULL };\r\nguint8 v = tvb_get_guint8(tvb, 0);\r\nproto_tree_add_bitmask_text(tree, tvb, 0, 1, NULL, NULL,\r\nett_ipmi_stor_5b_byte1, byte1, ENC_LITTLE_ENDIAN, 0);\r\nif (v > 2) {\r\nproto_tree_add_item(tree, hf_ipmi_stor_5b_unknown, tvb, 1, -1, ENC_NA);\r\nreturn;\r\n}\r\nipmi_add_timestamp(tree, hf_ipmi_stor_5b_ts_add, tvb, 1);\r\nif (v == 0) {\r\nproto_tree_add_item(tree, hf_ipmi_stor_5b_num_entries, tvb, 5, 4, ENC_LITTLE_ENDIAN);\r\n} else if (v == 1 || v == 2) {\r\nproto_tree_add_item(tree, hf_ipmi_stor_5b_iana, tvb, 5, 3, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(tree, hf_ipmi_stor_5b_bytes, tvb, 8, 8, ENC_NA);\r\n}\r\n}\r\nvoid\r\nproto_register_ipmi_storage(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_ipmi_stor_10_fruid,\r\n{ "FRU ID",\r\n"ipmi.st10.fruid", FT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_10_size,\r\n{ "FRU Inventory area size",\r\n"ipmi.st10.size", FT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_10_access,\r\n{ "Device is accessed",\r\n"ipmi.st10.access", FT_BOOLEAN, 8, TFS(&tfs_10_access), 0x01, NULL, HFILL }},\r\n{ &hf_ipmi_stor_11_fruid,\r\n{ "FRU ID",\r\n"ipmi.st11.fruid", FT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_11_offset,\r\n{ "Offset to read",\r\n"ipmi.st11.offset", FT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_11_count,\r\n{ "Count to read",\r\n"ipmi.st11.count", FT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_11_ret_count,\r\n{ "Returned count",\r\n"ipmi.st11.ret_count", FT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_11_data,\r\n{ "Requested data",\r\n"ipmi.st11.data", FT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_12_fruid,\r\n{ "FRU ID",\r\n"ipmi.st12.fruid", FT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_12_offset,\r\n{ "Offset to read",\r\n"ipmi.st12.offset", FT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_12_data,\r\n{ "Requested data",\r\n"ipmi.st12.data", FT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_12_ret_count,\r\n{ "Returned count",\r\n"ipmi.st12.ret_count", FT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_20_sdr_version,\r\n{ "SDR Version",\r\n"ipmi.st20.sdr_version", FT_UINT8, BASE_CUSTOM, CF_FUNC(ipmi_fmt_version), 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_20_rec_count,\r\n{ "Record Count",\r\n"ipmi.st20.rec_count", FT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_20_free_space,\r\n{ "Free Space",\r\n"ipmi.st20.free_space", FT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_20_ts_add,\r\n{ "Most recent addition timestamp",\r\n"ipmi.st20.ts_add", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_20_ts_erase,\r\n{ "Most recent erase timestamp",\r\n"ipmi.st20.ts_erase", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_20_op_overflow,\r\n{ "Overflow",\r\n"ipmi.st20.op_overflow", FT_BOOLEAN, 8, NULL, 0x80, NULL, HFILL }},\r\n{ &hf_ipmi_stor_20_op_update,\r\n{ "SDR Repository Update",\r\n"ipmi.st20.op_update", FT_UINT8, BASE_HEX, VALS(vals_20_update), 0x60, NULL, HFILL }},\r\n{ &hf_ipmi_stor_20_op_delete,\r\n{ "Delete SDR",\r\n"ipmi.st20.op_delete", FT_BOOLEAN, 8, NULL, 0x08, NULL, HFILL }},\r\n{ &hf_ipmi_stor_20_op_partial_add,\r\n{ "Partial Add SDR",\r\n"ipmi.st20.op_partial_add", FT_BOOLEAN, 8, NULL, 0x04, NULL, HFILL }},\r\n{ &hf_ipmi_stor_20_op_reserve,\r\n{ "Reserve SDR Repository",\r\n"ipmi.st20.op_reserve", FT_BOOLEAN, 8, NULL, 0x02, NULL, HFILL }},\r\n{ &hf_ipmi_stor_20_op_allocinfo,\r\n{ "Get SDR Repository Allocation Info",\r\n"ipmi.st20.op_allocinfo", FT_BOOLEAN, 8, NULL, 0x01, NULL, HFILL }},\r\n{ &hf_ipmi_stor_21_units,\r\n{ "Number of allocation units",\r\n"ipmi.st21.units", FT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_21_size,\r\n{ "Allocation unit size",\r\n"ipmi.st21.size", FT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_21_free,\r\n{ "Number of free units",\r\n"ipmi.st21.free", FT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_21_largest,\r\n{ "Largest free block (in units)",\r\n"ipmi.st21.largest", FT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_21_maxrec,\r\n{ "Maximum record size (in units)",\r\n"ipmi.st21.maxrec", FT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_22_rsrv_id,\r\n{ "Reservation ID",\r\n"ipmi.st22.rsrv_id", FT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_23_rsrv_id,\r\n{ "Reservation ID",\r\n"ipmi.st23.rsrv_id", FT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_23_rec_id,\r\n{ "Record ID",\r\n"ipmi.st23.rec_id", FT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_23_offset,\r\n{ "Offset into record",\r\n"ipmi.st23.offset", FT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_23_count,\r\n{ "Bytes to read",\r\n"ipmi.st23.count", FT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_23_next,\r\n{ "Next Record ID",\r\n"ipmi.st23.next", FT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_23_data,\r\n{ "Record Data",\r\n"ipmi.st23.data", FT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_24_data,\r\n{ "SDR Data",\r\n"ipmi.st24.data", FT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_24_added_rec_id,\r\n{ "Record ID for added record",\r\n"ipmi.st23.added_rec_id", FT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_25_rsrv_id,\r\n{ "Reservation ID",\r\n"ipmi.st25.rsrv_id", FT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_25_rec_id,\r\n{ "Record ID",\r\n"ipmi.st25.rec_id", FT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_25_offset,\r\n{ "Offset into record",\r\n"ipmi.st25.offset", FT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_25_inprogress,\r\n{ "In progress",\r\n"ipmi.st25.inprogress", FT_UINT8, BASE_HEX, VALS(vals_25_inprogress), 0x0f, NULL, HFILL }},\r\n{ &hf_ipmi_stor_25_data,\r\n{ "SDR Data",\r\n"ipmi.st25.data", FT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_25_added_rec_id,\r\n{ "Record ID for added record",\r\n"ipmi.st25.added_rec_id", FT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n#if 0\r\n{ &hf_ipmi_stor_26_rsrv_id,\r\n{ "Reservation ID",\r\n"ipmi.st26.rsrv_id", FT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_26_rec_id,\r\n{ "Record ID",\r\n"ipmi.st26.rec_id", FT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n#endif\r\n{ &hf_ipmi_stor_26_del_rec_id,\r\n{ "Deleted Record ID",\r\n"ipmi.st26.del_rec_id", FT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_27_rsrv_id,\r\n{ "Reservation ID",\r\n"ipmi.st27.rsrv_id", FT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_27_clr,\r\n{ "Confirmation (should be CLR)",\r\n"ipmi.st27.clr", FT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_27_action,\r\n{ "Action",\r\n"ipmi.st27.action", FT_UINT8, BASE_HEX, VALS(vals_27_action), 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_27_status,\r\n{ "Erasure Status",\r\n"ipmi.st27.status", FT_UINT8, BASE_HEX, VALS(vals_27_status), 0x0f, NULL, HFILL }},\r\n{ &hf_ipmi_stor_28_time,\r\n{ "Time",\r\n"ipmi.st28.time", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_29_time,\r\n{ "Time",\r\n"ipmi.st29.time", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_2c_init_agent,\r\n{ "Initialization agent",\r\n"ipmi.st2c.init_agent", FT_BOOLEAN, 8, TFS(&tfs_2c_init_agent), 0x01, NULL, HFILL }},\r\n{ &hf_ipmi_stor_2c_init_state,\r\n{ "Initialization",\r\n"ipmi.st2c.init_state", FT_BOOLEAN, 8, TFS(&tfs_2c_init_state), 0x01, NULL, HFILL }},\r\n{ &hf_ipmi_stor_40_sel_version,\r\n{ "SEL Version",\r\n"ipmi.st40.sel_version", FT_UINT8, BASE_CUSTOM, CF_FUNC(ipmi_fmt_version), 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_40_entries,\r\n{ "Entries",\r\n"ipmi.st40.rec_count", FT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_40_free_space,\r\n{ "Free Space",\r\n"ipmi.st40.free_space", FT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_40_ts_add,\r\n{ "Most recent addition timestamp",\r\n"ipmi.st40.ts_add", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_40_ts_erase,\r\n{ "Most recent erase timestamp",\r\n"ipmi.st40.ts_erase", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_40_op_overflow,\r\n{ "Overflow",\r\n"ipmi.st40.op_overflow", FT_BOOLEAN, 8, NULL, 0x80, NULL, HFILL }},\r\n{ &hf_ipmi_stor_40_op_delete,\r\n{ "Delete SEL",\r\n"ipmi.st40.op_delete", FT_BOOLEAN, 8, NULL, 0x08, NULL, HFILL }},\r\n{ &hf_ipmi_stor_40_op_partial_add,\r\n{ "Partial Add SEL Entry",\r\n"ipmi.st40.op_partial_add", FT_BOOLEAN, 8, NULL, 0x04, NULL, HFILL }},\r\n{ &hf_ipmi_stor_40_op_reserve,\r\n{ "Reserve SEL",\r\n"ipmi.st40.op_reserve", FT_BOOLEAN, 8, NULL, 0x02, NULL, HFILL }},\r\n{ &hf_ipmi_stor_40_op_allocinfo,\r\n{ "Get SEL Allocation Info",\r\n"ipmi.st40.op_allocinfo", FT_BOOLEAN, 8, NULL, 0x01, NULL, HFILL }},\r\n{ &hf_ipmi_stor_41_units,\r\n{ "Number of allocation units",\r\n"ipmi.st41.units", FT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_41_size,\r\n{ "Allocation unit size",\r\n"ipmi.st41.size", FT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_41_free,\r\n{ "Number of free units",\r\n"ipmi.st41.free", FT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_41_largest,\r\n{ "Largest free block (in units)",\r\n"ipmi.st41.largest", FT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_41_maxrec,\r\n{ "Maximum record size (in units)",\r\n"ipmi.st41.maxrec", FT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_42_rsrv_id,\r\n{ "Reservation ID",\r\n"ipmi.st42.rsrv_id", FT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_43_rsrv_id,\r\n{ "Reservation ID",\r\n"ipmi.st43.rsrv_id", FT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_43_rec_id,\r\n{ "Record ID",\r\n"ipmi.st43.rec_id", FT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_43_offset,\r\n{ "Offset into record",\r\n"ipmi.st43.offset", FT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_43_count,\r\n{ "Bytes to read",\r\n"ipmi.st43.count", FT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_43_next,\r\n{ "Next Record ID",\r\n"ipmi.st43.next", FT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_43_data,\r\n{ "Record Data",\r\n"ipmi.st43.data", FT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_44_data,\r\n{ "SDR Data",\r\n"ipmi.st44.data", FT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_44_added_rec_id,\r\n{ "Record ID for added record",\r\n"ipmi.st43.added_rec_id", FT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_45_rsrv_id,\r\n{ "Reservation ID",\r\n"ipmi.st45.rsrv_id", FT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_45_rec_id,\r\n{ "Record ID",\r\n"ipmi.st45.rec_id", FT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_45_offset,\r\n{ "Offset into record",\r\n"ipmi.st45.offset", FT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_45_inprogress,\r\n{ "In progress",\r\n"ipmi.st45.inprogress", FT_UINT8, BASE_HEX, VALS(vals_45_inprogress), 0x0f, NULL, HFILL }},\r\n{ &hf_ipmi_stor_45_data,\r\n{ "Record Data",\r\n"ipmi.st45.data", FT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_45_added_rec_id,\r\n{ "Record ID for added record",\r\n"ipmi.st45.added_rec_id", FT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n#if 0\r\n{ &hf_ipmi_stor_46_rsrv_id,\r\n{ "Reservation ID",\r\n"ipmi.st46.rsrv_id", FT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_46_rec_id,\r\n{ "Record ID",\r\n"ipmi.st46.rec_id", FT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n#endif\r\n{ &hf_ipmi_stor_46_del_rec_id,\r\n{ "Deleted Record ID",\r\n"ipmi.st46.del_rec_id", FT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_47_rsrv_id,\r\n{ "Reservation ID",\r\n"ipmi.st47.rsrv_id", FT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_47_clr,\r\n{ "Confirmation (should be CLR)",\r\n"ipmi.st47.clr", FT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_47_action,\r\n{ "Action",\r\n"ipmi.st47.action", FT_UINT8, BASE_HEX, VALS(vals_47_action), 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_47_status,\r\n{ "Erasure Status",\r\n"ipmi.st47.status", FT_UINT8, BASE_HEX, VALS(vals_47_status), 0x0f, NULL, HFILL }},\r\n{ &hf_ipmi_stor_48_time,\r\n{ "Time",\r\n"ipmi.st48.time", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_49_time,\r\n{ "Time",\r\n"ipmi.st49.time", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_5a_log_type,\r\n{ "Log type",\r\n"ipmi.st5a.log_type", FT_UINT8, BASE_HEX, VALS(log_type_vals), 0x0f, NULL, HFILL }},\r\n{ &hf_ipmi_stor_5a_ts_add,\r\n{ "Last addition timestamp",\r\n"ipmi.st5a.ts_add", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_5a_num_entries,\r\n{ "Number of entries in MCA Log",\r\n"ipmi.st5a.num_entries", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_5a_iana,\r\n{ "OEM IANA",\r\n"ipmi.st5a.iana", FT_UINT24, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_5a_bytes,\r\n{ "Log status bytes",\r\n"ipmi.st5a.bytes", FT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_5a_unknown,\r\n{ "Unknown log format (cannot parse data)",\r\n"ipmi.st5a.unknown", FT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_5b_log_type,\r\n{ "Log type",\r\n"ipmi.st5b.log_type", FT_UINT8, BASE_HEX, VALS(log_type_vals), 0x0f, NULL, HFILL }},\r\n{ &hf_ipmi_stor_5b_ts_add,\r\n{ "Last addition timestamp",\r\n"ipmi.st5b.ts_add", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_5b_num_entries,\r\n{ "Number of entries in MCA Log",\r\n"ipmi.st5b.num_entries", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_5b_iana,\r\n{ "OEM IANA",\r\n"ipmi.st5b.iana", FT_UINT24, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_5b_bytes,\r\n{ "Log status bytes",\r\n"ipmi.st5b.bytes", FT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_ipmi_stor_5b_unknown,\r\n{ "Unknown log format (cannot parse data)",\r\n"ipmi.st5b.unknown", FT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_ipmi_stor_10_flags,\r\n&ett_ipmi_stor_20_ops,\r\n&ett_ipmi_stor_25_byte6,\r\n&ett_ipmi_stor_27_status,\r\n&ett_ipmi_stor_2c_rq_byte1,\r\n&ett_ipmi_stor_2c_rs_byte1,\r\n&ett_ipmi_stor_40_ops,\r\n&ett_ipmi_stor_45_byte6,\r\n&ett_ipmi_stor_47_status,\r\n&ett_ipmi_stor_5a_byte1,\r\n&ett_ipmi_stor_5b_byte1,\r\n};\r\nproto_register_field_array(proto_ipmi, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nipmi_register_netfn_cmdtab(IPMI_STORAGE_REQ, IPMI_OEM_NONE, NULL, 0, NULL,\r\ncmd_storage, array_length(cmd_storage));\r\n}
