static const gchar *\r\ncsm_fc(guint16 fc, guint16 ct)\r\n{\r\nif (fc == 0x0000) {\r\nreturn val_to_str(ct, class_type_vals, "0x%04x");\r\n} else {\r\nreturn val_to_str(fc, function_code_vals, "0x%04x");\r\n}\r\n}\r\nstatic gboolean\r\ncsm_to_host(guint16 fc, guint16 ct)\r\n{\r\nif (fc == 0x0000) {\r\nreturn (try_val_to_str(ct, exclusive_to_host_ct_vals) != NULL);\r\n} else {\r\nreturn (try_val_to_str(fc, exclusive_to_host_vals) != NULL);\r\n}\r\n}\r\nstatic int\r\ndissect_csm_encaps(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nproto_item *ti;\r\nproto_tree *csm_encaps_tree = NULL;\r\nguint16 function_code, channel, class_type;\r\nguint control, type, sequence, length;\r\nguint i;\r\ngboolean show_error_param= FALSE;\r\nconst gchar *str_function_name;\r\nfunction_code = tvb_get_letohs(tvb, 10);\r\ncontrol = tvb_get_guint8(tvb, 3);\r\nclass_type = tvb_get_guint8(tvb, 9);\r\nclass_type = class_type<<8;\r\nclass_type|= tvb_get_guint8(tvb, 8);\r\ntype = tvb_get_guint8(tvb, 8);\r\nsequence = tvb_get_guint8(tvb, 2);\r\nlength = tvb_get_guint8(tvb, 6);\r\nchannel = tvb_get_ntohs(tvb, 4);\r\nif (CSM_ENCAPS_CTRL_ACK&control)\r\nshow_error_param= FALSE;\r\nelse {\r\nif (csm_to_host(function_code, class_type))\r\nshow_error_param= FALSE;\r\nelse {\r\nif (type == CSM_ENCAPS_TYPE_RESPONSE)\r\nshow_error_param= TRUE;\r\nelse\r\nshow_error_param= FALSE;\r\n}\r\n}\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "CSM_ENCAPS");\r\ncol_clear(pinfo->cinfo, COL_INFO);\r\nif (CSM_ENCAPS_CTRL_ACK&control) {\r\nif (CSM_ENCAPS_CTRL_ACK_TO_HOST&control)\r\ncol_append_fstr(pinfo->cinfo, COL_INFO,\r\n"<-- ACK Ch: 0x%04X, Seq: %2d (To Host)",\r\nchannel, sequence);\r\nelse\r\ncol_append_fstr(pinfo->cinfo, COL_INFO,\r\n"--> ACK Ch: 0x%04X, Seq: %2d (From Host)",\r\nchannel, sequence);\r\n} else {\r\nstr_function_name= csm_fc(function_code, class_type);\r\nif ((type == CSM_ENCAPS_TYPE_RESPONSE) || (csm_to_host(function_code, class_type)))\r\ncol_append_fstr(pinfo->cinfo, COL_INFO,\r\n"<-- %-35s Ch: 0x%04X, Seq: %2d (To Host)",\r\nstr_function_name, channel, sequence);\r\nelse\r\ncol_append_fstr(pinfo->cinfo, COL_INFO,\r\n"--> %-35s Ch: 0x%04X, Seq: %2d (From Host)",\r\nstr_function_name, channel, sequence);\r\n}\r\nif (tree) {\r\nstatic const int * control_flags[] = {\r\n&hf_csm_encaps_ctrl_ack,\r\n&hf_csm_encaps_ctrl_ack_suppress,\r\n&hf_csm_encaps_ctrl_endian,\r\nNULL\r\n};\r\nti = proto_tree_add_item(tree, proto_csm_encaps, tvb, 0, -1, ENC_NA);\r\ncsm_encaps_tree = proto_item_add_subtree(ti, ett_csm_encaps);\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_opcode, tvb, 0, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_seq, tvb, 2, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, 3, hf_csm_encaps_ctrl, ett_csm_encaps_control, control_flags, ENC_NA);\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_channel, tvb, 4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_length, tvb, 6, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_index, tvb, 7, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_class, tvb, 9, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_type, tvb, 8, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_function_code, tvb, 10, 2, ENC_LITTLE_ENDIAN);\r\ni = 6;\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_reserved, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nif (show_error_param)\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param_error, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\nelse\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param1, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param2, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param3, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param4, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param5, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param6, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param7, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param8, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param9, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param10, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param11, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param12, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param13, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param14, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param15, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param16, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param17, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param18, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param19, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param20, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param21, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param22, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param23, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param24, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param25, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param26, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param27, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param28, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param29, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param30, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param31, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param32, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param33, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param34, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param35, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param36, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param37, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param38, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param39, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nif (i < length) {\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param40, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\ni += 2;\r\n}\r\nfor (; i < length; i += 2)\r\nproto_tree_add_item(csm_encaps_tree, hf_csm_encaps_param, tvb, 12 + i - 6, 2, ENC_LITTLE_ENDIAN);\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_csm_encaps(void)\r\n{\r\nstatic struct true_false_string control_endian_bit = {"Little Endian","Big Endian"};\r\nstatic struct true_false_string control_ack_bit = {"ACK Packet", "Message Packet"};\r\nstatic struct true_false_string control_ack_suppress_bit = {"ACK Suppressed", "ACK Required"};\r\nstatic hf_register_info hf[] = {\r\n{ &hf_csm_encaps_opcode,\r\n{ "Opcode", "csm_encaps.opcode",\r\nFT_UINT16, BASE_HEX, VALS(opcode_vals), 0,\r\n"CSM_ENCAPS Opcode", HFILL }\r\n},\r\n{ &hf_csm_encaps_seq,\r\n{ "Sequence Number", "csm_encaps.seq_num",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"CSM_ENCAPS Sequence Number", HFILL }\r\n},\r\n{ &hf_csm_encaps_ctrl,\r\n{ "Control", "csm_encaps.ctrl",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Control", HFILL }\r\n},\r\n{ &hf_csm_encaps_ctrl_ack,\r\n{ "Packet Bit", "csm_encaps.ctrl.ack",\r\nFT_BOOLEAN, 8, TFS(&control_ack_bit), CSM_ENCAPS_CTRL_ACK,\r\n"Message Packet/ACK Packet", HFILL }\r\n},\r\n{ &hf_csm_encaps_ctrl_ack_suppress,\r\n{ "ACK Suppress Bit", "csm_encaps.ctrl.ack_suppress",\r\nFT_BOOLEAN, 8, TFS(&control_ack_suppress_bit), CSM_ENCAPS_CTRL_ACK_SUPPRESS,\r\n"ACK Required/ACK Suppressed", HFILL }\r\n},\r\n{ &hf_csm_encaps_ctrl_endian,\r\n{ "Endian Bit", "csm_encaps.ctrl.endian",\r\nFT_BOOLEAN, 8, TFS(&control_endian_bit), CSM_ENCAPS_CTRL_ENDIAN,\r\n"Little Endian/Big Endian", HFILL }\r\n},\r\n{ &hf_csm_encaps_channel,\r\n{ "Channel Number", "csm_encaps.channel",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Channel Number", HFILL }\r\n},\r\n{ &hf_csm_encaps_index,\r\n{ "Index", "csm_encaps.index",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"CSM_ENCAPS Index", HFILL }\r\n},\r\n{ &hf_csm_encaps_length,\r\n{ "Length", "csm_encaps.length",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"CSM_ENCAPS Length", HFILL }\r\n},\r\n{ &hf_csm_encaps_class,\r\n{ "Class", "csm_encaps.class",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"CSM_ENCAPS Class", HFILL }\r\n},\r\n{ &hf_csm_encaps_type,\r\n{ "Type", "csm_encaps.type",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"CSM_ENCAPS Type", HFILL }\r\n},\r\n{ &hf_csm_encaps_function_code,\r\n{ "Function Code", "csm_encaps.function_code",\r\nFT_UINT16, BASE_HEX, VALS(function_code_vals), 0,\r\n"CSM_ENCAPS Function Code", HFILL }\r\n},\r\n{ &hf_csm_encaps_reserved,\r\n{ "Reserved", "csm_encaps.reserved",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Reserved", HFILL }\r\n},\r\n{ &hf_csm_encaps_param_error,\r\n{ "Parameter 1", "csm_encaps.param1",\r\nFT_UINT16, BASE_HEX, VALS(error_vals), 0,\r\n"CSM_ENCAPS Parameter 1", HFILL }\r\n},\r\n{ &hf_csm_encaps_param1,\r\n{ "Parameter 1", "csm_encaps.param1",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 1", HFILL }\r\n},\r\n{ &hf_csm_encaps_param2,\r\n{ "Parameter 2", "csm_encaps.param2",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 2", HFILL }\r\n},\r\n{ &hf_csm_encaps_param3,\r\n{ "Parameter 3", "csm_encaps.param3",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 3", HFILL }\r\n},\r\n{ &hf_csm_encaps_param4,\r\n{ "Parameter 4", "csm_encaps.param4",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 4", HFILL }\r\n},\r\n{ &hf_csm_encaps_param5,\r\n{ "Parameter 5", "csm_encaps.param5",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 5", HFILL }\r\n},\r\n{ &hf_csm_encaps_param6,\r\n{ "Parameter 6", "csm_encaps.param6",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 6", HFILL }\r\n},\r\n{ &hf_csm_encaps_param7,\r\n{ "Parameter 7", "csm_encaps.param7",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 7", HFILL }\r\n},\r\n{ &hf_csm_encaps_param8,\r\n{ "Parameter 8", "csm_encaps.param8",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 8", HFILL }\r\n},\r\n{ &hf_csm_encaps_param9,\r\n{ "Parameter 9", "csm_encaps.param9",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 9", HFILL }\r\n},\r\n{ &hf_csm_encaps_param10,\r\n{ "Parameter 10", "csm_encaps.param10",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 10", HFILL }\r\n},\r\n{ &hf_csm_encaps_param11,\r\n{ "Parameter 11", "csm_encaps.param11",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 11", HFILL }\r\n},\r\n{ &hf_csm_encaps_param12,\r\n{ "Parameter 12", "csm_encaps.param12",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 12", HFILL }\r\n},\r\n{ &hf_csm_encaps_param13,\r\n{ "Parameter 13", "csm_encaps.param13",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 13", HFILL }\r\n},\r\n{ &hf_csm_encaps_param14,\r\n{ "Parameter 14", "csm_encaps.param14",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 14", HFILL }\r\n},\r\n{ &hf_csm_encaps_param15,\r\n{ "Parameter 15", "csm_encaps.param15",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 15", HFILL }\r\n},\r\n{ &hf_csm_encaps_param16,\r\n{ "Parameter 16", "csm_encaps.param16",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 16", HFILL }\r\n},\r\n{ &hf_csm_encaps_param17,\r\n{ "Parameter 17", "csm_encaps.param17",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 17", HFILL }\r\n},\r\n{ &hf_csm_encaps_param18,\r\n{ "Parameter 18", "csm_encaps.param18",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 18", HFILL }\r\n},\r\n{ &hf_csm_encaps_param19,\r\n{ "Parameter 19", "csm_encaps.param19",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 19", HFILL }\r\n},\r\n{ &hf_csm_encaps_param20,\r\n{ "Parameter 20", "csm_encaps.param20",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 20", HFILL }\r\n},\r\n{ &hf_csm_encaps_param21,\r\n{ "Parameter 21", "csm_encaps.param21",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 21", HFILL }\r\n},\r\n{ &hf_csm_encaps_param22,\r\n{ "Parameter 22", "csm_encaps.param22",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 22", HFILL }\r\n},\r\n{ &hf_csm_encaps_param23,\r\n{ "Parameter 23", "csm_encaps.param23",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 23", HFILL }\r\n},\r\n{ &hf_csm_encaps_param24,\r\n{ "Parameter 24", "csm_encaps.param24",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 24", HFILL }\r\n},\r\n{ &hf_csm_encaps_param25,\r\n{ "Parameter 25", "csm_encaps.param25",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 25", HFILL }\r\n},\r\n{ &hf_csm_encaps_param26,\r\n{ "Parameter 26", "csm_encaps.param26",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 26", HFILL }\r\n},\r\n{ &hf_csm_encaps_param27,\r\n{ "Parameter 27", "csm_encaps.param27",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 27", HFILL }\r\n},\r\n{ &hf_csm_encaps_param28,\r\n{ "Parameter 28", "csm_encaps.param28",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 28", HFILL }\r\n},\r\n{ &hf_csm_encaps_param29,\r\n{ "Parameter 29", "csm_encaps.param29",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 29", HFILL }\r\n},\r\n{ &hf_csm_encaps_param30,\r\n{ "Parameter 30", "csm_encaps.param30",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 30", HFILL }\r\n},\r\n{ &hf_csm_encaps_param31,\r\n{ "Parameter 31", "csm_encaps.param31",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 31", HFILL }\r\n},\r\n{ &hf_csm_encaps_param32,\r\n{ "Parameter 32", "csm_encaps.param32",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 32", HFILL }\r\n},\r\n{ &hf_csm_encaps_param33,\r\n{ "Parameter 33", "csm_encaps.param33",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 33", HFILL }\r\n},\r\n{ &hf_csm_encaps_param34,\r\n{ "Parameter 34", "csm_encaps.param34",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 34", HFILL }\r\n},\r\n{ &hf_csm_encaps_param35,\r\n{ "Parameter 35", "csm_encaps.param35",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 35", HFILL }\r\n},\r\n{ &hf_csm_encaps_param36,\r\n{ "Parameter 36", "csm_encaps.param36",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 36", HFILL }\r\n},\r\n{ &hf_csm_encaps_param37,\r\n{ "Parameter 37", "csm_encaps.param37",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 37", HFILL }\r\n},\r\n{ &hf_csm_encaps_param38,\r\n{ "Parameter 38", "csm_encaps.param38",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 38", HFILL }\r\n},\r\n{ &hf_csm_encaps_param39,\r\n{ "Parameter 39", "csm_encaps.param39",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 39", HFILL }\r\n},\r\n{ &hf_csm_encaps_param40,\r\n{ "Parameter 40", "csm_encaps.param40",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter 40", HFILL }\r\n},\r\n{ &hf_csm_encaps_param,\r\n{ "Parameter", "csm_encaps.param",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"CSM_ENCAPS Parameter", HFILL }\r\n},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_csm_encaps,\r\n&ett_csm_encaps_control\r\n};\r\nproto_csm_encaps = proto_register_protocol("CSM_ENCAPS", "CSM_ENCAPS", "csm_encaps");\r\nproto_register_field_array(proto_csm_encaps, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid\r\nproto_reg_handoff_csm_encaps(void)\r\n{\r\ndissector_handle_t csm_encaps_handle;\r\ncsm_encaps_handle = create_dissector_handle(dissect_csm_encaps, proto_csm_encaps);\r\ndissector_add_uint("ethertype", ETHERTYPE_CSM_ENCAPS, csm_encaps_handle);\r\n}
