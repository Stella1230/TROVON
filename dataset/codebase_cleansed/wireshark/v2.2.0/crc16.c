static guint16 crc16_unreflected(const guint8 *buf, guint len,\r\nguint16 crc_in, const guint table[])\r\n{\r\nguint crc16 = (guint)crc_in;\r\nwhile( len-- != 0 )\r\ncrc16 = table[((crc16 >> 8) ^ *buf++) & 0xff] ^ (crc16 << 8);\r\nreturn (guint16)crc16;\r\n}\r\nstatic guint16 crc16_reflected(const guint8 *buf, guint len,\r\nguint16 crc_in, const guint table[])\r\n{\r\nguint crc16 = (guint)crc_in;\r\nwhile( len-- != 0 )\r\ncrc16 = table[(crc16 ^ *buf++) & 0xff] ^ (crc16 >> 8);\r\nreturn (guint16)crc16;\r\n}\r\nguint16 crc16_ccitt(const guint8 *buf, guint len)\r\n{\r\nreturn crc16_reflected(buf,len,crc16_ccitt_start,crc16_ccitt_table_reverse)\r\n^ crc16_ccitt_xorout;\r\n}\r\nguint16 crc16_x25_ccitt_seed(const guint8 *buf, guint len, guint16 seed)\r\n{\r\nreturn crc16_unreflected(buf,len,seed,crc16_ccitt_table);\r\n}\r\nguint16 crc16_ccitt_seed(const guint8 *buf, guint len, guint16 seed)\r\n{\r\nreturn crc16_reflected(buf,len,seed,crc16_ccitt_table_reverse)\r\n^ crc16_ccitt_xorout;\r\n}\r\nguint16 crc16_iso14443a(const guint8 *buf, guint len)\r\n{\r\nreturn crc16_reflected(buf,len, 0x6363 ,crc16_ccitt_table_reverse);\r\n}\r\nguint16 crc16_0x5935(const guint8 *buf, guint32 len, guint16 seed)\r\n{\r\nreturn crc16_unreflected(buf, len, seed, crc16_precompiled_5935);\r\n}\r\nguint16 crc16_0x755B(const guint8 *buf, guint32 len, guint16 seed)\r\n{\r\nreturn crc16_unreflected(buf, len, seed, crc16_precompiled_755B);\r\n}\r\nguint16 crc16_0x9949_seed(const guint8 *buf, guint len, guint16 seed)\r\n{\r\nreturn crc16_reflected(buf, len, seed, crc16_precompiled_9949_reverse);\r\n}\r\nguint16 crc16_0x3D65_seed(const guint8 *buf, guint len, guint16 seed)\r\n{\r\nreturn crc16_reflected(buf, len, seed, crc16_precompiled_3D65_reverse);\r\n}
