static int\r\nehs_secondary_header_size ( int protocol, tvbuff_t* tvb, int offset )\r\n{\r\nint size = EHS_SECONDARY_HEADER_SIZE;\r\nswitch ( protocol )\r\n{\r\ncase EHS_PROTOCOL__TDM_TELEMETRY:\r\nsize = tvb_get_ntohs ( tvb, offset );\r\nbreak;\r\ncase EHS_PROTOCOL__NASCOM_TELEMETRY:\r\nbreak;\r\ncase EHS_PROTOCOL__PSEUDO_TELEMETRY:\r\nsize = 8;\r\nbreak;\r\ncase EHS_PROTOCOL__TDS_DATA:\r\nbreak;\r\ncase EHS_PROTOCOL__TEST_DATA:\r\nbreak;\r\ncase EHS_PROTOCOL__GSE_DATA:\r\nsize = 16;\r\nbreak;\r\ncase EHS_PROTOCOL__CUSTOM_DATA:\r\nbreak;\r\ncase EHS_PROTOCOL__HDRS_DQ:\r\nbreak;\r\ncase EHS_PROTOCOL__CSS:\r\nbreak;\r\ncase EHS_PROTOCOL__AOS_LOS:\r\nbreak;\r\ncase EHS_PROTOCOL__PDSS_PAYLOAD_CCSDS_PACKET:\r\nbreak;\r\ncase EHS_PROTOCOL__PDSS_CORE_CCSDS_PACKET:\r\nbreak;\r\ncase EHS_PROTOCOL__PDSS_PAYLOAD_BPDU:\r\nbreak;\r\ncase EHS_PROTOCOL__PDSS_UDSM:\r\nbreak;\r\ncase EHS_PROTOCOL__PDSS_RPSM:\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nreturn size;\r\n}\r\nstatic void\r\ncommon_secondary_header_dissector ( proto_tree* ehs_secondary_header_tree, tvbuff_t* tvb, int* offset )\r\n{\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_vcdu_sequence_number, tvb, *offset, 3, ENC_BIG_ENDIAN );\r\n*offset += 3;\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_data_stream_id, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\n++(*offset);\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_gse_pkt_id, tvb, *offset, 2, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_payload_vs_core_id, tvb, *offset, 2, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_apid, tvb, *offset, 2, ENC_BIG_ENDIAN );\r\n*offset += 2;\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_virtual_channel, tvb, *offset, 2, ENC_BIG_ENDIAN );\r\n*offset += 2;\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_pdss_reserved_sync, tvb, *offset, 2, ENC_BIG_ENDIAN );\r\n*offset += 2;\r\n}\r\nstatic void\r\naoslos_secondary_header_dissector ( proto_tree* ehs_secondary_header_tree, tvbuff_t* tvb, int* offset )\r\n{\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_version, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_data_status_bit_5, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_data_status_bit_4, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_data_status_bit_3, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_data_status_bit_2, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_data_status_bit_1, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_data_status_bit_0, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\ncommon_secondary_header_dissector ( ehs_secondary_header_tree, tvb, offset );\r\n}\r\nstatic void\r\npayload_ccsds_secondary_header_dissector ( proto_tree* ehs_secondary_header_tree, tvbuff_t* tvb, int* offset )\r\n{\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_version, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_data_status_bit_5, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_data_status_bit_4, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_data_status_bit_3, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_vcdu_sequence_error, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_packet_sequence_error, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_data_status_bit_0, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\ncommon_secondary_header_dissector ( ehs_secondary_header_tree, tvb, offset );\r\n}\r\nstatic void\r\ncore_ccsds_secondary_header_dissector ( proto_tree* ehs_secondary_header_tree, tvbuff_t* tvb, int* offset )\r\n{\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_version, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_data_status_bit_5, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_data_status_bit_4, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_parent_stream_error, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_vcdu_sequence_error, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_packet_sequence_error, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_data_status_bit_0, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\ncommon_secondary_header_dissector ( ehs_secondary_header_tree, tvb, offset );\r\n}\r\nstatic void\r\npayload_bpdu_secondary_header_dissector ( proto_tree* ehs_secondary_header_tree, tvbuff_t* tvb, int* offset )\r\n{\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_version, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_data_status_bit_5, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_data_status_bit_4, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_data_status_bit_3, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_vcdu_sequence_error, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_data_status_bit_1, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_data_status_bit_0, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\ncommon_secondary_header_dissector ( ehs_secondary_header_tree, tvb, offset );\r\n}\r\nstatic void\r\nudsm_secondary_header_dissector ( proto_tree* ehs_secondary_header_tree, tvbuff_t* tvb, int* offset )\r\n{\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_version, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_data_status_bit_5, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_data_status_bit_4, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_data_status_bit_3, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_data_status_bit_2, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_data_status_bit_1, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_data_status_bit_0, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\ncommon_secondary_header_dissector ( ehs_secondary_header_tree, tvb, offset );\r\n}\r\nstatic void\r\ntdm_secondary_header_dissector ( proto_tree* ehs_secondary_header_tree, tvbuff_t* tvb, int* offset )\r\n{\r\nint j;\r\nint num_major_frames = 0;\r\nint num_minor_frames = 0;\r\nint cntmet_present = 0;\r\nint obt_present = 0;\r\nint mjfs_present = 0;\r\nproto_tree* time_tree;\r\nproto_item* time_item;\r\nint year, jday, hour, minute, second, tenths;\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_secondary_header_length, tvb, *offset, 2, ENC_BIG_ENDIAN );\r\n*offset += 2;\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_extra_data_packet, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_backup_stream_id_number, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_end_of_data_flag, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_parent_frame_error, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_checksum_error, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_fixed_value_error, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_minor_frame_counter_error, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_format_id_error, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_bit_slip_error, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_sync_error, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_aoslos_flag, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_override_errors_flag, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_data_status, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_idq, tvb, *offset, 2, ENC_BIG_ENDIAN );\r\n*offset += 2;\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_cdq, tvb, *offset, 2, ENC_BIG_ENDIAN );\r\n*offset += 2;\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_adq, tvb, *offset, 2, ENC_BIG_ENDIAN );\r\n*offset += 2;\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_data_dq, tvb, *offset, 2, ENC_BIG_ENDIAN );\r\n*offset += 2;\r\n*offset += 2;\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_format_id, tvb, *offset, 2, ENC_BIG_ENDIAN );\r\n*offset += 2;\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_major_frame_packet_index, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_numpkts_per_major_frame, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\nnum_minor_frames = 1 + tvb_get_guint8 ( tvb, *offset );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_num_minor_frames_per_packet, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\ncntmet_present = tvb_get_guint8 ( tvb, *offset ) & 0x80;\r\nobt_present = tvb_get_guint8 ( tvb, *offset ) & 0x40;\r\nmjfs_present = tvb_get_guint8 ( tvb, *offset ) & 0x20;\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_cntmet_present, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_obt_present, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_major_frame_status_present, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\nif ( cntmet_present )\r\n{\r\ntime_tree = proto_tree_add_subtree(ehs_secondary_header_tree, tvb, *offset, 7, ett_ehs_cnt_time, &time_item, "CNT/MET Time: ");\r\nyear = tvb_get_guint8 ( tvb, *offset );\r\nproto_tree_add_item ( time_tree, hf_ehs_sh_tdm_cnt_year, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\njday = tvb_get_ntohs ( tvb, *offset );\r\nproto_tree_add_item ( time_tree, hf_ehs_sh_tdm_cnt_jday, tvb, *offset, 2, ENC_BIG_ENDIAN );\r\n*offset += 2;\r\nhour = tvb_get_guint8 ( tvb, *offset );\r\nproto_tree_add_item ( time_tree, hf_ehs_sh_tdm_cnt_hour, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\nminute = tvb_get_guint8 ( tvb, *offset );\r\nproto_tree_add_item ( time_tree, hf_ehs_sh_tdm_cnt_minute, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\nsecond = tvb_get_guint8 ( tvb, *offset );\r\nproto_tree_add_item ( time_tree, hf_ehs_sh_tdm_cnt_second, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\ntenths = tvb_get_guint8 ( tvb, *offset ) >> 4;\r\nproto_tree_add_item ( time_tree, hf_ehs_sh_tdm_cnt_tenths, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\nproto_item_append_text(time_item, "%04d/%03d:%02d:%02d:%02d.%1d", year + 1900, jday, hour, minute, second, tenths );\r\n}\r\nif ( obt_present )\r\n{\r\ntime_tree = proto_tree_add_subtree(ehs_secondary_header_tree, tvb, *offset, 7, ett_ehs_obt_time, &time_item, "OBT Time: ");\r\nyear = tvb_get_guint8 ( tvb, *offset );\r\nproto_tree_add_item ( time_tree, hf_ehs_sh_tdm_obt_year, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\njday = tvb_get_ntohs ( tvb, *offset );\r\nproto_tree_add_item ( time_tree, hf_ehs_sh_tdm_obt_jday, tvb, *offset, 2, ENC_BIG_ENDIAN );\r\n*offset += 2;\r\nhour = tvb_get_guint8 ( tvb, *offset );\r\nproto_tree_add_item ( time_tree, hf_ehs_sh_tdm_obt_hour, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\nminute = tvb_get_guint8 ( tvb, *offset );\r\nproto_tree_add_item ( time_tree, hf_ehs_sh_tdm_obt_minute, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\nsecond = tvb_get_guint8 ( tvb, *offset );\r\nproto_tree_add_item ( time_tree, hf_ehs_sh_tdm_obt_second, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\ntenths = tvb_get_guint8 ( tvb, *offset ) >> 4;\r\nproto_tree_add_item ( time_tree, hf_ehs_sh_tdm_obt_tenths, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\nproto_item_append_text ( time_item, "%04d/%03d:%02d:%02d:%02d.%1d", year + 1900, jday, hour, minute, second, tenths );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_obt_delta_time_flag, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_obt_computed_flag, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_obt_not_retrieved_flag, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_obt_source_apid, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n}\r\nif ( mjfs_present )\r\n{\r\nnum_major_frames = 1 + tvb_get_guint8 ( tvb, *offset );\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_tdm_num_major_frame_status_words, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\nfor ( j=0; j < num_major_frames; ++j )\r\n{\r\nproto_tree* major_tree;\r\nconst int * major_fields[] = {\r\n&hf_ehs_sh_tdm_mjfs_parent_frame_error,\r\n&hf_ehs_sh_tdm_mjfs_checksum_error,\r\n&hf_ehs_sh_tdm_mjfs_fixed_value_error,\r\nNULL\r\n};\r\nmajor_tree = proto_tree_add_subtree_format( ehs_secondary_header_tree, tvb, *offset, 1, ett_ehs_major_frame, NULL, "Major Frame Status Byte# %d", j );\r\nproto_tree_add_bitmask_list(major_tree, tvb, *offset, 1, major_fields, ENC_BIG_ENDIAN);\r\n++(*offset);\r\n}\r\n}\r\nfor ( j=0; j < num_minor_frames; ++j )\r\n{\r\nproto_tree* minor_tree;\r\nconst int * minor_fields[] = {\r\n&hf_ehs_sh_tdm_mnfs_parent_frame_error,\r\n&hf_ehs_sh_tdm_mnfs_data_not_available,\r\n&hf_ehs_sh_tdm_mnfs_checksum_error,\r\n&hf_ehs_sh_tdm_mnfs_fixed_value_error,\r\n&hf_ehs_sh_tdm_mnfs_counter_error,\r\n&hf_ehs_sh_tdm_mnfs_format_id_error,\r\n&hf_ehs_sh_tdm_mnfs_bit_slip_error,\r\n&hf_ehs_sh_tdm_mnfs_sync_error,\r\nNULL\r\n};\r\nminor_tree = proto_tree_add_subtree_format( ehs_secondary_header_tree, tvb, *offset, 1, ett_ehs_minor_frame, NULL, "Minor Frame Status Byte# %d", j );\r\nproto_tree_add_bitmask_list(minor_tree, tvb, *offset, 1, minor_fields, ENC_BIG_ENDIAN);\r\n++(*offset);\r\n}\r\n}\r\nstatic void\r\npseudo_secondary_header_dissector ( proto_tree* ehs_secondary_header_tree, tvbuff_t* tvb, int* offset )\r\n{\r\n*offset += 2;\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_pseudo_workstation_id, tvb, *offset, 2, ENC_BIG_ENDIAN );\r\n*offset += 2;\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_pseudo_user_id, tvb, *offset, 2, ENC_BIG_ENDIAN );\r\n*offset += 2;\r\nproto_tree_add_item ( ehs_secondary_header_tree, hf_ehs_sh_pseudo_comp_id, tvb, *offset, 2, ENC_BIG_ENDIAN );\r\n*offset += 2;\r\n}\r\nstatic void\r\nehs_secondary_header_dissector ( int protocol, proto_tree* ehs_secondary_header_tree, tvbuff_t* tvb, int* offset )\r\n{\r\nswitch ( protocol )\r\n{\r\ncase EHS_PROTOCOL__TDM_TELEMETRY:\r\ntdm_secondary_header_dissector ( ehs_secondary_header_tree, tvb, offset );\r\nbreak;\r\ncase EHS_PROTOCOL__NASCOM_TELEMETRY:\r\n*offset += ehs_secondary_header_size ( protocol, tvb, *offset );\r\nbreak;\r\ncase EHS_PROTOCOL__PSEUDO_TELEMETRY:\r\npseudo_secondary_header_dissector ( ehs_secondary_header_tree, tvb, offset );\r\nbreak;\r\ncase EHS_PROTOCOL__TDS_DATA:\r\n*offset += ehs_secondary_header_size ( protocol, tvb, *offset );\r\nbreak;\r\ncase EHS_PROTOCOL__TEST_DATA:\r\n*offset += ehs_secondary_header_size ( protocol, tvb, *offset );\r\nbreak;\r\ncase EHS_PROTOCOL__GSE_DATA:\r\n*offset += ehs_secondary_header_size ( protocol, tvb, *offset );\r\nbreak;\r\ncase EHS_PROTOCOL__CUSTOM_DATA:\r\n*offset += ehs_secondary_header_size ( protocol, tvb, *offset );\r\nbreak;\r\ncase EHS_PROTOCOL__HDRS_DQ:\r\n*offset += ehs_secondary_header_size ( protocol, tvb, *offset );\r\nbreak;\r\ncase EHS_PROTOCOL__CSS:\r\n*offset += ehs_secondary_header_size ( protocol, tvb, *offset );\r\nbreak;\r\ncase EHS_PROTOCOL__AOS_LOS:\r\naoslos_secondary_header_dissector ( ehs_secondary_header_tree, tvb, offset );\r\nbreak;\r\ncase EHS_PROTOCOL__PDSS_PAYLOAD_CCSDS_PACKET:\r\npayload_ccsds_secondary_header_dissector ( ehs_secondary_header_tree, tvb, offset );\r\nbreak;\r\ncase EHS_PROTOCOL__PDSS_CORE_CCSDS_PACKET:\r\ncore_ccsds_secondary_header_dissector ( ehs_secondary_header_tree, tvb, offset );\r\nbreak;\r\ncase EHS_PROTOCOL__PDSS_PAYLOAD_BPDU:\r\npayload_bpdu_secondary_header_dissector ( ehs_secondary_header_tree, tvb, offset );\r\nbreak;\r\ncase EHS_PROTOCOL__PDSS_UDSM:\r\nudsm_secondary_header_dissector ( ehs_secondary_header_tree, tvb, offset );\r\nbreak;\r\ncase EHS_PROTOCOL__PDSS_RPSM:\r\n*offset += ehs_secondary_header_size ( protocol, tvb, *offset );\r\nbreak;\r\ndefault:\r\n*offset += ehs_secondary_header_size ( protocol, tvb, *offset );\r\nbreak;\r\n}\r\n}\r\nstatic void\r\naoslos_data_zone_dissector ( proto_tree* ehs_tree, tvbuff_t* tvb, int* offset, packet_info* pinfo _U_)\r\n{\r\nproto_tree *ehs_data_zone_tree;\r\nehs_data_zone_tree = proto_tree_add_subtree( ehs_tree, tvb, *offset, tvb_reported_length(tvb) - *offset,\r\nett_ehs_data_zone, NULL, "AOS/LOS Data Zone" );\r\nproto_tree_add_item ( ehs_data_zone_tree, hf_ehs_dz_aoslos_indicator, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\n}\r\nstatic void\r\nudsm_data_zone_dissector ( proto_tree* ehs_tree, tvbuff_t* tvb, int* offset, packet_info* pinfo _U_)\r\n{\r\nproto_tree *ehs_data_zone_tree;\r\nproto_tree* time_tree;\r\nproto_item* time_item;\r\nint year, jday, hour, minute, second;\r\nehs_data_zone_tree = proto_tree_add_subtree( ehs_tree, tvb, *offset, tvb_reported_length(tvb) - *offset,\r\nett_ehs_data_zone, NULL, "UDSM Data Zone" );\r\nproto_tree_add_item ( ehs_data_zone_tree, hf_ehs_dz_udsm_ccsds_vs_bpdu, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\n++(*offset);\r\nproto_tree_add_item ( ehs_data_zone_tree, hf_ehs_dz_udsm_gse_pkt_id, tvb, *offset, 2, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_data_zone_tree, hf_ehs_dz_udsm_payload_vs_core, tvb, *offset, 2, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_data_zone_tree, hf_ehs_dz_udsm_apid, tvb, *offset, 2, ENC_BIG_ENDIAN );\r\n*offset += 2;\r\ntime_tree = proto_tree_add_subtree(ehs_data_zone_tree, tvb, *offset, 7, ett_ehs_udsm_start_time, &time_item, "UDSM Start Time: ");\r\nyear = tvb_get_guint8 ( tvb, *offset );\r\nproto_tree_add_item ( time_tree, hf_ehs_dz_udsm_start_time_year, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\njday = tvb_get_ntohs ( tvb, *offset );\r\nproto_tree_add_item ( time_tree, hf_ehs_dz_udsm_start_time_jday, tvb, *offset, 2, ENC_BIG_ENDIAN );\r\n*offset += 2;\r\nhour = tvb_get_guint8 ( tvb, *offset );\r\nproto_tree_add_item ( time_tree, hf_ehs_dz_udsm_start_time_hour, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\nminute = tvb_get_guint8 ( tvb, *offset );\r\nproto_tree_add_item ( time_tree, hf_ehs_dz_udsm_start_time_minute, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\nsecond = tvb_get_guint8 ( tvb, *offset );\r\nproto_tree_add_item ( time_tree, hf_ehs_dz_udsm_start_time_second, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\nproto_item_append_text( time_item, "%04d/%03d:%02d:%02d:%02d = UDSM Start Time", year + 1900, jday, hour, minute, second );\r\ntime_tree = proto_tree_add_subtree(ehs_data_zone_tree, tvb, *offset, 7, ett_ehs_udsm_stop_time, &time_item, "UDSM Stop Time: ");\r\nyear = tvb_get_guint8 ( tvb, *offset );\r\nproto_tree_add_item ( time_tree, hf_ehs_dz_udsm_stop_time_year, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\njday = tvb_get_ntohs ( tvb, *offset );\r\nproto_tree_add_item ( time_tree, hf_ehs_dz_udsm_stop_time_jday, tvb, *offset, 2, ENC_BIG_ENDIAN );\r\n*offset += 2;\r\nhour = tvb_get_guint8 ( tvb, *offset );\r\nproto_tree_add_item ( time_tree, hf_ehs_dz_udsm_stop_time_hour, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\nminute = tvb_get_guint8 ( tvb, *offset );\r\nproto_tree_add_item ( time_tree, hf_ehs_dz_udsm_stop_time_minute, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\nsecond = tvb_get_guint8 ( tvb, *offset );\r\nproto_tree_add_item ( time_tree, hf_ehs_dz_udsm_stop_time_second, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\nproto_item_append_text ( time_item, "%04d/%03d:%02d:%02d:%02d", year + 1900, jday, hour, minute, second );\r\n*offset += 2;\r\nproto_tree_add_item ( ehs_data_zone_tree, hf_ehs_dz_udsm_num_pkts_xmtd, tvb, *offset, 2, ENC_BIG_ENDIAN );\r\n*offset += 2;\r\nproto_tree_add_item ( ehs_data_zone_tree, hf_ehs_dz_udsm_num_vcdu_seqerrs, tvb, *offset, 2, ENC_BIG_ENDIAN );\r\n*offset += 2;\r\nproto_tree_add_item ( ehs_data_zone_tree, hf_ehs_dz_udsm_num_pkt_seqerrs, tvb, *offset, 2, ENC_BIG_ENDIAN );\r\n*offset += 2;\r\nproto_tree_add_item ( ehs_data_zone_tree, hf_ehs_dz_udsm_num_pktlen_errors, tvb, *offset, 2, ENC_BIG_ENDIAN );\r\n*offset += 2;\r\nproto_tree_add_item ( ehs_data_zone_tree, hf_ehs_dz_udsm_event, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\nproto_tree_add_item ( ehs_data_zone_tree, hf_ehs_dz_udsm_num_pkts_xmtd_rollover, tvb, *offset, 1, ENC_BIG_ENDIAN );\r\n++(*offset);\r\n}\r\nstatic void\r\nehs_data_zone_dissector ( int protocol, proto_tree* ehs_tree, tvbuff_t* tvb, int* offset, packet_info* pinfo )\r\n{\r\nswitch ( protocol )\r\n{\r\ncase EHS_PROTOCOL__TDM_TELEMETRY:\r\nbreak;\r\ncase EHS_PROTOCOL__NASCOM_TELEMETRY:\r\nbreak;\r\ncase EHS_PROTOCOL__PSEUDO_TELEMETRY:\r\nbreak;\r\ncase EHS_PROTOCOL__TDS_DATA:\r\nbreak;\r\ncase EHS_PROTOCOL__TEST_DATA:\r\nbreak;\r\ncase EHS_PROTOCOL__GSE_DATA:\r\nbreak;\r\ncase EHS_PROTOCOL__CUSTOM_DATA:\r\nbreak;\r\ncase EHS_PROTOCOL__HDRS_DQ:\r\nbreak;\r\ncase EHS_PROTOCOL__CSS:\r\nbreak;\r\ncase EHS_PROTOCOL__AOS_LOS:\r\naoslos_data_zone_dissector ( ehs_tree, tvb, offset, pinfo );\r\nbreak;\r\ncase EHS_PROTOCOL__PDSS_PAYLOAD_CCSDS_PACKET:\r\nbreak;\r\ncase EHS_PROTOCOL__PDSS_CORE_CCSDS_PACKET:\r\nbreak;\r\ncase EHS_PROTOCOL__PDSS_PAYLOAD_BPDU:\r\nbreak;\r\ncase EHS_PROTOCOL__PDSS_UDSM:\r\nudsm_data_zone_dissector ( ehs_tree, tvb, offset, pinfo );\r\nbreak;\r\ncase EHS_PROTOCOL__PDSS_RPSM:\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\nstatic int\r\ndissect_ehs(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\nguint16 first_word;\r\ntvbuff_t *new_tvb;\r\nproto_item *ehs_packet;\r\nproto_tree *ehs_tree;\r\nproto_tree* time_tree;\r\nproto_item* time_item;\r\nproto_tree *ehs_primary_header_tree;\r\nproto_tree *ehs_secondary_header_tree;\r\nint protocol;\r\nint year, jday, hour, minute, second, tenths;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "EHS");\r\ncol_set_str(pinfo->cinfo, COL_INFO, "EHS");\r\nehs_packet = proto_tree_add_item ( tree, proto_ehs, tvb, 0, -1, ENC_NA );\r\nehs_tree = proto_item_add_subtree ( ehs_packet, ett_ehs );\r\nehs_primary_header_tree = proto_tree_add_subtree( ehs_tree, tvb, offset, EHS_PRIMARY_HEADER_SIZE,\r\nett_ehs_primary_header, NULL, "Primary EHS Header" );\r\nproto_tree_add_item ( ehs_primary_header_tree, hf_ehs_ph_version, tvb, offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_primary_header_tree, hf_ehs_ph_project, tvb, offset, 1, ENC_BIG_ENDIAN );\r\n++offset;\r\nproto_tree_add_item ( ehs_primary_header_tree, hf_ehs_ph_support_mode, tvb, offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_primary_header_tree, hf_ehs_ph_data_mode, tvb, offset, 1, ENC_BIG_ENDIAN );\r\n++offset;\r\nproto_tree_add_item ( ehs_primary_header_tree, hf_ehs_ph_mission, tvb, offset, 1, ENC_BIG_ENDIAN );\r\n++offset;\r\nprotocol = tvb_get_guint8 ( tvb, offset );\r\nproto_tree_add_item ( ehs_primary_header_tree, hf_ehs_ph_protocol, tvb, offset, 1, ENC_BIG_ENDIAN );\r\n++offset;\r\ntime_tree = proto_tree_add_subtree(ehs_primary_header_tree, tvb, offset, 7, ett_ehs_ground_receipt_time, &time_item, "EHS Ground Receipt Time: ");\r\nyear = tvb_get_guint8 ( tvb, offset );\r\nproto_tree_add_item ( time_tree, hf_ehs_ph_year, tvb, offset, 1, ENC_BIG_ENDIAN );\r\n++offset;\r\njday = tvb_get_ntohs ( tvb, offset );\r\nproto_tree_add_item ( time_tree, hf_ehs_ph_jday, tvb, offset, 2, ENC_BIG_ENDIAN );\r\noffset += 2;\r\nhour = tvb_get_guint8 ( tvb, offset );\r\nproto_tree_add_item ( time_tree, hf_ehs_ph_hour, tvb, offset, 1, ENC_BIG_ENDIAN );\r\n++offset;\r\nminute = tvb_get_guint8 ( tvb, offset );\r\nproto_tree_add_item ( time_tree, hf_ehs_ph_minute, tvb, offset, 1, ENC_BIG_ENDIAN );\r\n++offset;\r\nsecond = tvb_get_guint8 ( tvb, offset );\r\nproto_tree_add_item ( time_tree, hf_ehs_ph_second, tvb, offset, 1, ENC_BIG_ENDIAN );\r\n++offset;\r\ntenths = tvb_get_guint8 ( tvb, offset ) >> 4;\r\nproto_tree_add_item ( time_tree, hf_ehs_ph_tenths, tvb, offset, 1, ENC_BIG_ENDIAN );\r\nproto_item_append_text ( time_item, "%04d/%03d:%02d:%02d:%02d.%1d", year + 1900, jday, hour, minute, second, tenths );\r\nproto_tree_add_item ( ehs_primary_header_tree, hf_ehs_ph_new_data_flag, tvb, offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_primary_header_tree, hf_ehs_ph_hold_flag, tvb, offset, 1, ENC_BIG_ENDIAN );\r\nproto_tree_add_item ( ehs_primary_header_tree, hf_ehs_ph_sign_flag, tvb, offset, 1, ENC_BIG_ENDIAN );\r\n++offset;\r\n++offset;\r\n++offset;\r\n++offset;\r\nproto_tree_add_item ( ehs_primary_header_tree, hf_ehs_ph_hosc_packet_size, tvb, offset, 2, ENC_BIG_ENDIAN );\r\noffset += 2;\r\nehs_secondary_header_tree = proto_tree_add_subtree( ehs_tree, tvb, offset, ehs_secondary_header_size ( protocol, tvb, offset ),\r\nett_ehs_secondary_header, NULL, "Secondary EHS Header" );\r\nehs_secondary_header_dissector ( protocol, ehs_secondary_header_tree, tvb, &offset );\r\nswitch ( protocol )\r\n{\r\ncase EHS_PROTOCOL__TDM_TELEMETRY:\r\ncase EHS_PROTOCOL__PSEUDO_TELEMETRY:\r\ncase EHS_PROTOCOL__AOS_LOS:\r\ncase EHS_PROTOCOL__PDSS_PAYLOAD_CCSDS_PACKET:\r\ncase EHS_PROTOCOL__PDSS_CORE_CCSDS_PACKET:\r\ncase EHS_PROTOCOL__PDSS_UDSM:\r\nnew_tvb = tvb_new_subset_remaining ( tvb, offset);\r\ncall_dissector ( ccsds_handle, new_tvb, pinfo, ehs_tree );\r\nfirst_word = tvb_get_ntohs ( tvb, offset );\r\noffset += CCSDS_PRIMARY_HEADER_LENGTH;\r\nif ( first_word & HDR_SECHDR ) offset += CCSDS_SECONDARY_HEADER_LENGTH;\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nehs_data_zone_dissector ( protocol, ehs_tree, tvb, &offset, pinfo );\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_ehs(void)\r\n{\r\nstatic hf_register_info hf[] =\r\n{\r\n{ &hf_ehs_ph_version,\r\n{ "Version", "ehs.version",\r\nFT_UINT8, BASE_DEC, NULL, 0xf0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_ph_project,\r\n{ "Project", "ehs.project",\r\nFT_UINT8, BASE_DEC, VALS(ehs_primary_header_project), 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_ph_support_mode,\r\n{ "Support Mode", "ehs.support_mode",\r\nFT_UINT8, BASE_DEC, VALS(ehs_primary_header_support_mode), 0xf0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_ph_data_mode,\r\n{ "Data Mode", "ehs.data_mode",\r\nFT_UINT8, BASE_DEC, VALS(ehs_primary_header_data_mode), 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_ph_mission,\r\n{ "Mission", "ehs.mission",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_ph_protocol,\r\n{ "Protocol", "ehs.protocol",\r\nFT_UINT8, BASE_DEC, VALS(ehs_primary_header_protocol), 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_ph_year,\r\n{ "Years since 1900", "ehs.year",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_ph_jday,\r\n{ "Julian Day of Year", "ehs.jday",\r\nFT_UINT16, BASE_DEC, NULL, 0xffff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_ph_hour,\r\n{ "Hour", "ehs.hour",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_ph_minute,\r\n{ "Minute", "ehs.minute",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_ph_second,\r\n{ "Second", "ehs.second",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_ph_tenths,\r\n{ "Tenths", "ehs.tenths",\r\nFT_UINT8, BASE_DEC, NULL, 0xf0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_ph_new_data_flag,\r\n{ "New Data Flag", "ehs.new_data_flag",\r\nFT_BOOLEAN, 8, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_ehs_ph_pad1,\r\n{ "Pad1", "ehs.pad1",\r\nFT_UINT8, BASE_DEC, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_ehs_ph_hold_flag,\r\n{ "Hold Flag", "ehs.hold_flag",\r\nFT_BOOLEAN, 8, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_ph_sign_flag,\r\n{ "Sign Flag (1->CDT)", "ehs.sign_flag",\r\nFT_UINT8, BASE_DEC, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_ehs_ph_pad2,\r\n{ "Pad2", "ehs.pad2",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_ph_pad3,\r\n{ "Pad3", "ehs.pad3",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_ph_pad4,\r\n{ "Pad4", "ehs.pad4",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_ehs_ph_hosc_packet_size,\r\n{ "HOSC Packet Size", "ehs.hosc_packet_size",\r\nFT_UINT16, BASE_DEC, NULL, 0xffff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_version,\r\n{ "Version", "ehs2.version",\r\nFT_UINT8, BASE_DEC, NULL, 0xc0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_data_status_bit_5,\r\n{ "Data Status Bit 5", "ehs2.data_status_bit_5",\r\nFT_UINT8, BASE_DEC, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_data_status_bit_4,\r\n{ "Data Status Bit 4", "ehs2.data_status_bit_4",\r\nFT_UINT8, BASE_DEC, NULL, 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_data_status_bit_3,\r\n{ "Data Status Bit 3", "ehs2.data_status_bit_3",\r\nFT_UINT8, BASE_DEC, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_data_status_bit_2,\r\n{ "Data Status Bit 2", "ehs2.data_status_bit_2",\r\nFT_UINT8, BASE_DEC, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_data_status_bit_1,\r\n{ "Data Status Bit 1", "ehs2.data_status_bit_1",\r\nFT_UINT8, BASE_DEC, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_data_status_bit_0,\r\n{ "Data Status Bit 0", "ehs2.data_status_bit_0",\r\nFT_UINT8, BASE_DEC, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_parent_stream_error,\r\n{ "Parent Stream Error", "ehs2.parent_stream_error",\r\nFT_BOOLEAN, 8, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_vcdu_sequence_error,\r\n{ "VCDU Sequence Error", "ehs2.vcdu_sequence_error",\r\nFT_BOOLEAN, 8, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_packet_sequence_error,\r\n{ "Packet Sequence Error", "ehs2.packet_sequence_error",\r\nFT_UINT8, BASE_DEC, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_vcdu_sequence_number,\r\n{ "VCDU Sequence Number", "ehs2.vcdu_seqno",\r\nFT_UINT24, BASE_DEC, NULL, 0xffffff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_data_stream_id,\r\n{ "Data Stream ID", "ehs2.data_stream_id",\r\nFT_UINT8, BASE_DEC, VALS(ehs_secondary_header_data_stream_id), 0x80,\r\nNULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_ehs_sh_pdss_reserved_1,\r\n{ "Pdss Reserved 1", "ehs2.pdss_reserved_1",\r\nFT_UINT8, BASE_DEC, NULL, 0x7f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_pdss_reserved_2,\r\n{ "Pdss Reserved 2", "ehs2.pdss_reserved_2",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_pdss_reserved_3,\r\n{ "Pdss Reserved 3", "ehs2.pdss_reserved_3",\r\nFT_UINT16, BASE_DEC, NULL, 0xe000,\r\nNULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_ehs_sh_gse_pkt_id,\r\n{ "GSE Packet ID (1=GSE)", "ehs2.gse_pkt_id",\r\nFT_UINT16, BASE_DEC, NULL, 0x1000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_payload_vs_core_id,\r\n{ "Payload vs Core ID", "ehs2.payload_vs_core_id",\r\nFT_UINT16, BASE_DEC, VALS(ehs_secondary_header_payload_vs_core_id), 0x0800,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_apid,\r\n{ "APID", "ehs2.apid",\r\nFT_UINT16, BASE_DEC, NULL, 0x07ff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_virtual_channel,\r\n{ "Virtual Channel", "ehs2.vcid",\r\nFT_UINT16, BASE_DEC, NULL, 0xffff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_pdss_reserved_sync,\r\n{ "Pdss Reserved Sync", "ehs2.sync",\r\nFT_UINT16, BASE_HEX, NULL, 0xffff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_secondary_header_length,\r\n{ "Secondary Header Length", "ehs2.tdm_secondary_header_length",\r\nFT_UINT16, BASE_DEC, NULL, 0xffff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_extra_data_packet,\r\n{ "Extra Data Packet", "ehs2.tdm_extra_data_packet",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_backup_stream_id_number,\r\n{ "Backup Stream ID Number", "ehs2.tdm_backup_stream_id_number",\r\nFT_UINT8, BASE_DEC, VALS(ehs_secondary_header_tdm_backup_stream_id), 0x60,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_end_of_data_flag,\r\n{ "End of Data Flag", "ehs2.tdm_end_of_data_flag",\r\nFT_UINT8, BASE_DEC, VALS(ehs_secondary_header_tdm_end_of_data_flag), 0x18,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_parent_frame_error,\r\n{ "Parent Frame Error", "ehs2.tdm_parent_frame_error",\r\nFT_BOOLEAN, 8, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_checksum_error,\r\n{ "Checksum Error", "ehs2.tdm_checksum_error",\r\nFT_BOOLEAN, 8, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_fixed_value_error,\r\n{ "Fixed Value Error", "ehs2.tdm_fixed_value_error",\r\nFT_BOOLEAN, 8, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_minor_frame_counter_error,\r\n{ "Minor Frame Counter Error", "ehs2.tdm_minor_frame_counter_error",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_format_id_error,\r\n{ "Format ID Error", "ehs2.tdm_format_id_error",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_bit_slip_error,\r\n{ "Bit Slip Error", "ehs2.tdm_bit_slip_error",\r\nFT_BOOLEAN, 8, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_sync_error,\r\n{ "Sync Error", "ehs2.tdm_sync_error",\r\nFT_BOOLEAN, 8, NULL, 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_aoslos_flag,\r\n{ "AOS/LOS Flag", "ehs2.tdm_aoslos_flag",\r\nFT_BOOLEAN, 8, TFS(&ehs_tfs_secondary_header_tdm_aoslos_flag), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_override_errors_flag,\r\n{ "Override Errors", "ehs2.tdm_override_errors_flag",\r\nFT_BOOLEAN, 8, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_data_status,\r\n{ "Data Status", "ehs2.tdm_data_status",\r\nFT_UINT8, BASE_DEC, VALS(ehs_secondary_header_tdm_data_status), 0x03,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_idq,\r\n{ "IDQ", "ehs2.tdm_idq",\r\nFT_UINT16, BASE_DEC, NULL, 0xffff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_cdq,\r\n{ "CDQ", "ehs2.tdm_cdq",\r\nFT_UINT16, BASE_DEC, NULL, 0xffff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_adq,\r\n{ "ADQ", "ehs2.tdm_adq",\r\nFT_UINT16, BASE_DEC, NULL, 0xffff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_data_dq,\r\n{ "Data DQ", "ehs2.tdm_data_dq",\r\nFT_UINT16, BASE_DEC, NULL, 0xffff,\r\nNULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_ehs_sh_tdm_unused,\r\n{ "Unused", "ehs2.tdm_unused",\r\nFT_UINT16, BASE_DEC, NULL, 0xffff,\r\nNULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_ehs_sh_tdm_format_id,\r\n{ "Format ID", "ehs2.tdm_format_id",\r\nFT_UINT16, BASE_HEX, NULL, 0xffff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_major_frame_packet_index,\r\n{ "Major Frame Packet Index", "ehs2.tdm_major_frame_packet_index",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_numpkts_per_major_frame,\r\n{ "Num Packets per Major Frame", "ehs2.tdm_numpkts_per_major_frame",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_num_minor_frames_per_packet,\r\n{ "Num Minor Frames per Packet", "ehs2.tdm_num_minor_frame_per_packet",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_cntmet_present,\r\n{ "CNT or MET Present", "ehs2.tdm_cntmet_present",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_obt_present,\r\n{ "OBT Present", "ehs2.tdm_obt_present",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_major_frame_status_present,\r\n{ "Major Frame Status Present", "ehs2.tdm_major_frame_status_present",\r\nFT_BOOLEAN, 8, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_ehs_sh_tdm_reserved,\r\n{ "Reserved", "ehs2.tdm_reserved",\r\nFT_UINT8, BASE_DEC, NULL, 0x1f,\r\nNULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_ehs_sh_tdm_cnt_year,\r\n{ "CNT Years since 1900", "ehs2.tdm_cnt_year",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_cnt_jday,\r\n{ "CNT Julian Day of Year", "ehs2.tdm_cnt_jday",\r\nFT_UINT16, BASE_DEC, NULL, 0xffff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_cnt_hour,\r\n{ "CNT Hour", "ehs2.tdm_cnt_hour",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_cnt_minute,\r\n{ "CNT Minute", "ehs2.tdm_cnt_minute",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_cnt_second,\r\n{ "CNT Second", "ehs2.tdm_cnt_second",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_cnt_tenths,\r\n{ "CNT Tenths", "ehs2.tdm_cnt_tenths",\r\nFT_UINT8, BASE_DEC, NULL, 0xf0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_obt_year,\r\n{ "OBT Years since 1900", "ehs2.tdm_cnt_year",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_obt_jday,\r\n{ "OBT Julian Day of Year", "ehs2.tdm_cnt_jday",\r\nFT_UINT16, BASE_DEC, NULL, 0xffff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_obt_hour,\r\n{ "OBT Hour", "ehs2.tdm_cnt_hour",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_obt_minute,\r\n{ "OBT Minute", "ehs2.tdm_cnt_minute",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_obt_second,\r\n{ "OBT Second", "ehs2.tdm_cnt_second",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_obt_tenths,\r\n{ "OBT Tenths", "ehs2.tdm_cnt_tenths",\r\nFT_UINT8, BASE_DEC, NULL, 0xf0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_obt_delta_time_flag,\r\n{ "OBT is Delta Time Instead of GMT", "ehs2.tdm_obt_delta_time_flag",\r\nFT_BOOLEAN, 16, NULL, 0x8000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_obt_computed_flag,\r\n{ "OBT Computed", "ehs2.tdm_obt_computed_flag",\r\nFT_BOOLEAN, 16, NULL, 0x4000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_obt_not_retrieved_flag,\r\n{ "OBT Not Retrieved", "ehs2.tdm_obt_not_retrieved_flag",\r\nFT_BOOLEAN, 16, NULL, 0x2000,\r\nNULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_ehs_sh_tdm_obt_reserved,\r\n{ "OBT Reserved", "ehs2.tdm_obt_reserved",\r\nFT_BOOLEAN, 16, NULL, 0x1800,\r\nNULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_ehs_sh_tdm_obt_source_apid,\r\n{ "OBT Source APID", "ehs2.tdm_obt_source_apid",\r\nFT_UINT16, BASE_DEC, NULL, 0x07ff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_num_major_frame_status_words,\r\n{ "Number of Major Frame Status Words", "ehs2.tdm_num_major_frame_status_words",\r\nFT_UINT8, BASE_DEC, NULL, 0x0ff,\r\nNULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_ehs_sh_tdm_mjfs_reserved,\r\n{ "Reserved", "ehs2.tdm_mjfs_reserved",\r\nFT_UINT8, BASE_DEC, NULL, 0xf8,\r\nNULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_ehs_sh_tdm_mjfs_parent_frame_error,\r\n{ "Parent Frame Error", "ehs2.tdm_mjfs_parent_frame_error",\r\nFT_BOOLEAN, 8, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_mjfs_checksum_error,\r\n{ "Checksum Error", "ehs2.tdm_mjfs_checksum_error",\r\nFT_BOOLEAN, 8, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_mjfs_fixed_value_error,\r\n{ "Fixed Value Error", "ehs2.tdm_mjfs_fixed_value_error",\r\nFT_BOOLEAN, 8, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_mnfs_parent_frame_error,\r\n{ "Parent Frame Error", "ehs2.tdm_mnfs_parent_frame_error",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_mnfs_data_not_available,\r\n{ "Data Not Available", "ehs2.tdm_mnfs_data_not_available",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_mnfs_checksum_error,\r\n{ "Checksum Error", "ehs2.tdm_mnfs_checksum_error",\r\nFT_BOOLEAN, 8, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_mnfs_fixed_value_error,\r\n{ "Fixed Value Error", "ehs2.tdm_mnfs_fixed_value_error",\r\nFT_BOOLEAN, 8, NULL, 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_mnfs_counter_error,\r\n{ "Counter Error", "ehs2.tdm_mnfs_counter_error",\r\nFT_BOOLEAN, 8, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_mnfs_format_id_error,\r\n{ "Format ID Error", "ehs2.tdm_mnfs_format_id_error",\r\nFT_BOOLEAN, 8, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_mnfs_bit_slip_error,\r\n{ "Bit Slip Error", "ehs2.tdm_mnfs_bit_slip_error",\r\nFT_BOOLEAN, 8, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_tdm_mnfs_sync_error,\r\n{ "Sync Error", "ehs2.tdm_mnfs_sync_error",\r\nFT_BOOLEAN, 8, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_ehs_sh_pseudo_unused,\r\n{ "Unused", "ehs2.pseudo_unused",\r\nFT_UINT16, BASE_DEC, NULL, 0xffff,\r\nNULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_ehs_sh_pseudo_workstation_id,\r\n{ "Workstation ID", "ehs2.pseudo_workstation_id",\r\nFT_UINT16, BASE_DEC, NULL, 0xffff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_pseudo_user_id,\r\n{ "User ID", "ehs2.pseudo_user_id",\r\nFT_UINT16, BASE_DEC, NULL, 0xffff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_sh_pseudo_comp_id,\r\n{ "Comp ID", "ehs2.pseudo_comp_id",\r\nFT_UINT16, BASE_DEC, NULL, 0xffff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_dz_aoslos_indicator,\r\n{ "AOS/LOS Indicator", "ehs.dz.aoslos_indicator",\r\nFT_UINT8, BASE_DEC, VALS(ehs_data_zone_aoslos_indicator), 0x03,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_dz_udsm_ccsds_vs_bpdu,\r\n{ "CCSDS vs BPDU", "ehs.dz.udsm_ccsds_vs_bpdu",\r\nFT_UINT8, BASE_DEC, VALS(ehs_data_zone_udsm_ccsds_vs_bpdu), 0x80,\r\nNULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_ehs_dz_udsm_unused1,\r\n{ "Unused 1", "ehs.dz.udsm_unused1",\r\nFT_UINT8, BASE_DEC, NULL, 0x7f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_dz_udsm_unused2,\r\n{ "Unused 2", "ehs.dz.udsm_unused2",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_dz_udsm_unused3,\r\n{ "Unused 3", "ehs.dz.udsm_unused3",\r\nFT_UINT16, BASE_DEC, NULL, 0xe000,\r\nNULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_ehs_dz_udsm_gse_pkt_id,\r\n{ "GSE Pkt ID", "ehs.dz.udsm_gse_pkt_id",\r\nFT_BOOLEAN, 16, NULL, 0x1000,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_dz_udsm_payload_vs_core,\r\n{ "Payload vs Core", "ehs.dz.udsm_payload_vs_core",\r\nFT_UINT16, BASE_DEC, VALS(ehs_data_zone_udsm_payload_vs_core), 0x0800,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_dz_udsm_apid,\r\n{ "APID", "ehs.dz.udsm_apid",\r\nFT_UINT16, BASE_DEC, NULL, 0x07ff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_dz_udsm_start_time_year,\r\n{ "Start Time Years since 1900", "ehs.dz.udsm_start_time_year",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_dz_udsm_start_time_jday,\r\n{ "Start Time Julian Day", "ehs.dz.udsm_start_time_jday",\r\nFT_UINT16, BASE_DEC, NULL, 0xffff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_dz_udsm_start_time_hour,\r\n{ "Start Time Hour", "ehs.dz.udsm_start_time_hour",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_dz_udsm_start_time_minute,\r\n{ "Start Time Minute", "ehs.dz.udsm_start_time_minute",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_dz_udsm_start_time_second,\r\n{ "Start Time Second", "ehs.dz.udsm_start_time_second",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_dz_udsm_stop_time_year,\r\n{ "Stop Time Years since 1900", "ehs.dz.udsm_stop_time_year",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_dz_udsm_stop_time_jday,\r\n{ "Stop Time Julian Day", "ehs.dz.udsm_stop_time_jday",\r\nFT_UINT16, BASE_DEC, NULL, 0xffff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_dz_udsm_stop_time_hour,\r\n{ "Stop Time Hour", "ehs.dz.udsm_stop_time_hour",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_dz_udsm_stop_time_minute,\r\n{ "Stop Time Minute", "ehs.dz.udsm_stop_time_minute",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_dz_udsm_stop_time_second,\r\n{ "Stop Time Second", "ehs.dz.udsm_stop_time_second",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n#if 0\r\n{ &hf_ehs_dz_udsm_unused4,\r\n{ "Unused 4", "ehs.dz.udsm_unused4",\r\nFT_UINT16, BASE_DEC, NULL, 0xffff,\r\nNULL, HFILL }\r\n},\r\n#endif\r\n{ &hf_ehs_dz_udsm_num_pkts_xmtd,\r\n{ "Num Pkts Transmitted", "ehs.dz.udsm_num_pkts_xmtd",\r\nFT_UINT16, BASE_DEC, NULL, 0xffff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_dz_udsm_num_vcdu_seqerrs,\r\n{ "Num VCDU Sequence Errors", "ehs.dz.udsm_num_vcdu_seqerrs",\r\nFT_UINT16, BASE_DEC, NULL, 0xffff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_dz_udsm_num_pkt_seqerrs,\r\n{ "Num Packet Sequence Errors", "ehs.dz.udsm_num_pkt_seqerrs",\r\nFT_UINT16, BASE_DEC, NULL, 0xffff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_dz_udsm_num_pktlen_errors,\r\n{ "Num Pkt Length Errors", "ehs.dz.udsm_num_pktlen_errors",\r\nFT_UINT16, BASE_DEC, NULL, 0xffff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_dz_udsm_event,\r\n{ "UDSM Event Code", "ehs.dz.udsm_event",\r\nFT_UINT8, BASE_DEC, VALS(ehs_data_zone_udsm_event), 0xff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_ehs_dz_udsm_num_pkts_xmtd_rollover,\r\n{ "Num Pkts Transmitted Rollover Counter", "ehs.dz.udsm_num_pkts_xmtd_rollover",\r\nFT_UINT8, BASE_DEC, NULL, 0xff,\r\nNULL, HFILL }\r\n},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_ehs,\r\n&ett_ehs_primary_header,\r\n&ett_ehs_secondary_header,\r\n&ett_ehs_data_zone,\r\n&ett_ehs_cnt_time,\r\n&ett_ehs_obt_time,\r\n&ett_ehs_udsm_start_time,\r\n&ett_ehs_udsm_stop_time,\r\n&ett_ehs_ground_receipt_time,\r\n&ett_ehs_major_frame,\r\n&ett_ehs_minor_frame,\r\n};\r\nproto_ehs = proto_register_protocol("EHS", "EHS", "ehs");\r\nproto_register_field_array(proto_ehs, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nregister_dissector ( "ehs", dissect_ehs, proto_ehs );\r\n}\r\nvoid\r\nproto_reg_handoff_ehs(void)\r\n{\r\ndissector_add_for_decode_as ( "udp.port", find_dissector("ehs") );\r\nccsds_handle = find_dissector_add_dependency ( "ccsds", proto_ehs );\r\n}
