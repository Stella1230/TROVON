static int\r\ndissect_omron_fins(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data _U_)\r\n{\r\nproto_item *ti = NULL;\r\nproto_tree *omron_tree = NULL;\r\nproto_tree *omron_header_tree, *field_tree, *command_tree, *area_data_tree, *cpu_bus_tree;\r\nproto_tree *io_data_tree, *error_log_tree, *omron_disk_data_tree, *omron_file_data_tree;\r\nproto_tree *omron_block_record_tree, *omron_status_tree;\r\nconst gchar *cmd_str;\r\ngint cmd_str_idx;\r\ngint reported_length_remaining;\r\nint offset = 0;\r\nguint8 icf_flags;\r\nguint8 omron_byte;\r\ngboolean is_response = FALSE;\r\ngboolean is_command = FALSE;\r\nguint16 command_code;\r\nif(tvb_captured_length(tvb) < 12 ) {\r\nreturn 0;\r\n}\r\nomron_byte = tvb_get_guint8(tvb, 1);\r\nif(omron_byte != 0x00) {\r\nreturn 0;\r\n}\r\nomron_byte = tvb_get_guint8(tvb, 2);\r\nif(omron_byte != 0x02) {\r\nreturn 0;\r\n}\r\ncommand_code = tvb_get_ntohs(tvb,10);\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "OMRON");\r\ncmd_str = try_val_to_str_idx(command_code, command_code_cv, &cmd_str_idx);\r\nif (cmd_str_idx == -1)\r\ncmd_str = wmem_strdup_printf(wmem_packet_scope(), "Unknown (%d)", command_code);\r\nicf_flags = tvb_get_guint8(tvb, offset);\r\nif (icf_flags & 0x40) {\r\nis_response = TRUE;\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "Response : %s", cmd_str);\r\n}\r\nelse\r\n{\r\nis_command = TRUE;\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "Command : %s", cmd_str);\r\n}\r\nif (tree) {\r\nti = proto_tree_add_item(tree, proto_omron_fins, tvb, 0, -1, ENC_NA);\r\nomron_tree = proto_item_add_subtree(ti, ett_omron);\r\nomron_header_tree = proto_tree_add_subtree(omron_tree, tvb, 0, 12, ett_omron_header, &ti, "Omron Header");\r\nproto_tree_add_bitmask(omron_header_tree, tvb, offset, hf_omron_icf,\r\nett_omron_icf_fields, omron_icf_fields, ENC_BIG_ENDIAN);\r\noffset = offset + 1;\r\nproto_tree_add_item(omron_header_tree, hf_omron_rsv, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset = offset + 1;\r\nproto_tree_add_item(omron_header_tree, hf_omron_gct, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset = offset + 1;\r\nproto_tree_add_item(omron_header_tree, hf_omron_dna, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset = offset + 1;\r\nproto_tree_add_item(omron_header_tree, hf_omron_da1, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset = offset + 1;\r\nproto_tree_add_item(omron_header_tree, hf_omron_da2, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset = offset + 1;\r\nproto_tree_add_item(omron_header_tree, hf_omron_sna, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset = offset + 1;\r\nproto_tree_add_item(omron_header_tree, hf_omron_sa1, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset = offset + 1;\r\nproto_tree_add_item(omron_header_tree, hf_omron_sa2, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset = offset + 1;\r\nproto_tree_add_item(omron_header_tree, hf_omron_sid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset = offset + 1;\r\nti = proto_tree_add_item(omron_header_tree, hf_omron_command, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\nreported_length_remaining = tvb_reported_length_remaining(tvb, offset);\r\nif (cmd_str_idx == -1) {\r\nexpert_add_info(pinfo, ti, &ei_omron_command_code);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nswitch(command_code) {\r\ncase 0x0402:\r\ncase 0x0601:\r\ncase 0x0602:\r\ncase 0x0603:\r\ncase 0x0701:\r\ncase 0x0802:\r\ncase 0x2103:\r\ncase 0x2302:\r\ncase 0x2602:\r\ncase 0x2603:\r\nif (is_command) {\r\nif (reported_length_remaining != 0) {\r\nexpert_add_info_format(pinfo, omron_tree, &ei_omron_bad_length, "Unexpected Length (Should be 0)");\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nbreak;\r\ncase 0x0403:\r\nif (is_command) {\r\nif(reported_length_remaining != 0) {\r\nexpert_add_info_format(pinfo, omron_tree, &ei_omron_bad_length, "Unexpected Length (Should be 0)");\r\n}\r\n}\r\nif (is_response)\r\n{\r\nexpert_add_info_format(pinfo, ti, &ei_omron_command_code, "Unknown Response Command-Code");\r\n}\r\nreturn tvb_captured_length(tvb);\r\nbreak;\r\ncase 0x0801:\r\nif (is_command) {\r\nif (reported_length_remaining == 0)\r\nreturn tvb_captured_length(tvb);\r\n}\r\nbreak;\r\ncase 0x0803:\r\nif (is_command) {\r\nif (reported_length_remaining == 0)\r\nreturn tvb_captured_length(tvb);\r\n}\r\nif (is_response)\r\n{\r\nexpert_add_info_format(pinfo, ti, &ei_omron_command_code, "Unknown Response Command-Code");\r\nreturn tvb_captured_length(tvb);\r\n}\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\ncommand_tree = proto_tree_add_subtree(omron_tree, tvb, offset, -1, ett_omron_command_data, NULL, "Command Data");\r\nswitch(command_code) {\r\ncase 0x0101:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 6)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_command_memory_area_code,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_address, tvb, (offset+1), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_address_bits, tvb, (offset+3), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_num_items, tvb, (offset+4), 2, ENC_BIG_ENDIAN);\r\noffset = offset + 6;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining >= 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset,\r\n2, ENC_BIG_ENDIAN);\r\nif(reported_length_remaining > 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_data, tvb,\r\n(offset+2), -1, ENC_NA);\r\n}\r\noffset = offset + reported_length_remaining;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0102:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining >= 6)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_command_memory_area_code,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_address, tvb, (offset+1), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_address_bits, tvb, (offset+3), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_num_items, tvb, (offset+4), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_command_data, tvb, (offset+6), -1, ENC_NA);\r\noffset = offset + reported_length_remaining;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset,\r\n2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0103:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 8)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_command_memory_area_code,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_address, tvb, (offset+1), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_address_bits, tvb, (offset+3), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_num_items, tvb, (offset+4), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_command_data, tvb, (offset+6), 2, ENC_NA);\r\noffset = offset + 8;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset,\r\n2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0104:\r\n{\r\nif(is_command)\r\n{\r\nwhile(reported_length_remaining >= 4)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_command_memory_area_code, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_transfer_beginning_address, tvb, (offset+1), 3, ENC_BIG_ENDIAN);\r\noffset = offset + 4;\r\nreported_length_remaining = reported_length_remaining - 4;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining >= 3)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\nreported_length_remaining = reported_length_remaining - 2;\r\nwhile(reported_length_remaining >= 2)\r\n{\r\nguint8 memory_area_code;\r\nguint8 memory_code_len;\r\nti = proto_tree_add_item(command_tree, hf_omron_command_memory_area_code, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nmemory_area_code = tvb_get_guint8(tvb, offset);\r\nswitch(memory_area_code) {\r\ncase 0x00:\r\nmemory_code_len = 1;\r\nbreak;\r\ncase 0x40:\r\nmemory_code_len = 1;\r\nbreak;\r\ncase 0x80:\r\nmemory_code_len = 2;\r\nbreak;\r\ncase 0xC0:\r\nmemory_code_len = 4;\r\nbreak;\r\ncase 0x01:\r\nmemory_code_len = 1;\r\nbreak;\r\ncase 0x41:\r\nmemory_code_len = 1;\r\nbreak;\r\ncase 0x81:\r\nmemory_code_len = 2;\r\nbreak;\r\ncase 0x82:\r\nmemory_code_len = 2;\r\nbreak;\r\ncase 0x03:\r\nmemory_code_len = 1;\r\nbreak;\r\ncase 0x43:\r\nmemory_code_len = 1;\r\nbreak;\r\ncase 0x04:\r\nmemory_code_len = 1;\r\nbreak;\r\ncase 0x44:\r\nmemory_code_len = 1;\r\nbreak;\r\ncase 0x84:\r\nmemory_code_len = 2;\r\nbreak;\r\ncase 0x05:\r\nmemory_code_len = 1;\r\nbreak;\r\ncase 0x85:\r\nmemory_code_len = 2;\r\nbreak;\r\ncase 0x90:\r\nmemory_code_len = 2;\r\nbreak;\r\ncase 0x91:\r\nmemory_code_len = 2;\r\nbreak;\r\ncase 0x92:\r\nmemory_code_len = 2;\r\nbreak;\r\ncase 0x93:\r\nmemory_code_len = 2;\r\nbreak;\r\ncase 0x94:\r\nmemory_code_len = 2;\r\nbreak;\r\ncase 0x95:\r\nmemory_code_len = 2;\r\nbreak;\r\ncase 0x96:\r\nmemory_code_len = 2;\r\nbreak;\r\ncase 0x97:\r\nmemory_code_len = 2;\r\nbreak;\r\ncase 0x98:\r\nmemory_code_len = 2;\r\nbreak;\r\ncase 0x1B:\r\nmemory_code_len = 1;\r\nbreak;\r\ncase 0x9C:\r\nmemory_code_len = 2;\r\nbreak;\r\ncase 0xDD:\r\nmemory_code_len = 4;\r\nbreak;\r\ndefault:\r\nmemory_code_len = 0;\r\n}\r\noffset = offset + 1;\r\nreported_length_remaining = reported_length_remaining - 1;\r\nif(memory_code_len == 0) {\r\nexpert_add_info_format(pinfo, ti, &ei_oomron_command_memory_area_code, "Unknown Memory-Area-Code (%u)", memory_area_code);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nproto_tree_add_item(command_tree, hf_omron_data, tvb, offset, memory_code_len, ENC_NA);\r\noffset = offset + memory_code_len;\r\nreported_length_remaining = reported_length_remaining - memory_code_len;\r\n}\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0105:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 10)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_command_memory_area_code,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_address, tvb, (offset+1), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_address_bits, tvb, (offset+3), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_command_memory_area_code,\r\ntvb, (offset+4), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_address, tvb, (offset+5), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_address_bits, tvb, (offset+7), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_num_items, tvb, (offset+8), 2, ENC_BIG_ENDIAN);\r\noffset = offset + 10;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset,\r\n2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0201:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 6)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_parameter_area_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_beginning_word, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_num_words, tvb, (offset+4), 2, ENC_BIG_ENDIAN);\r\noffset = offset + 6;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining >= 8)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset,\r\n2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_parameter_area_code, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_beginning_word, tvb, (offset+4), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_num_words, tvb, (offset+6), 2, ENC_BIG_ENDIAN);\r\nif(reported_length_remaining > 8)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_data, tvb,\r\n(offset+8), -1, ENC_NA);\r\n}\r\noffset = offset + reported_length_remaining;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0202:\r\ncase 0x0203:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining >= 6)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_parameter_area_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_beginning_word, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_num_words, tvb, (offset+4), 2, ENC_BIG_ENDIAN);\r\nif(reported_length_remaining > 6)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_command_data, tvb,\r\n(offset+6), -1, ENC_NA);\r\n}\r\noffset = offset + reported_length_remaining;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset,\r\n2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0220:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 8)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_fixed, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_intelligent_id_no, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_first_word, tvb, (offset+4), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_read_len, tvb, (offset+6), 2, ENC_BIG_ENDIAN);\r\noffset = offset + 8;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining >= 3)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_no_of_link_nodes, tvb, (offset+2), 1, ENC_BIG_ENDIAN);\r\noffset = offset + 3;\r\nreported_length_remaining = reported_length_remaining - 3;\r\nwhile(reported_length_remaining >= 8)\r\n{\r\nomron_block_record_tree = proto_tree_add_subtree(command_tree, tvb, offset, 8, ett_omron_block_record, NULL, "Block Record");\r\nproto_tree_add_item(omron_block_record_tree, hf_omron_block_record_node_num_status, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_block_record_tree, hf_omron_block_record_node_num_num_nodes, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_block_record_tree, hf_omron_block_record_cio_area, tvb, (offset+1), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_block_record_tree, hf_omron_block_record_kind_of_dm, tvb, (offset+3), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_block_record_tree, hf_omron_block_record_dm_area_first_word, tvb, (offset+4), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_block_record_tree, hf_omron_block_record_no_of_total_words, tvb, (offset+6), 2, ENC_BIG_ENDIAN);\r\noffset = offset + 8;\r\nreported_length_remaining = reported_length_remaining - 8;\r\n}\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0221:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining >= 9)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_fixed, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_intelligent_id_no, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_first_word, tvb, (offset+4), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_read_len, tvb, (offset+6), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_no_of_link_nodes, tvb, (offset+8), 1, ENC_BIG_ENDIAN);\r\noffset = offset + 9;\r\nreported_length_remaining = reported_length_remaining - 9;\r\nwhile(reported_length_remaining >= 8)\r\n{\r\nomron_block_record_tree = proto_tree_add_subtree(command_tree, tvb, offset, 8, ett_omron_block_record, NULL, "Block Record");\r\nproto_tree_add_item(omron_block_record_tree, hf_omron_block_record_node_num_status, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_block_record_tree, hf_omron_block_record_node_num_num_nodes, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_block_record_tree, hf_omron_block_record_cio_area, tvb, (offset+1), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_block_record_tree, hf_omron_block_record_kind_of_dm, tvb, (offset+3), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_block_record_tree, hf_omron_block_record_dm_area_first_word, tvb, (offset+4), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_block_record_tree, hf_omron_block_record_no_of_total_words, tvb, (offset+6), 2, ENC_BIG_ENDIAN);\r\noffset = offset + 8;\r\nreported_length_remaining = reported_length_remaining - 8;\r\n}\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0304:\r\ncase 0x0305:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 15)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_program_number, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_protect_code, tvb, (offset+2), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_begin_word, tvb, (offset+3),4,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_last_word, tvb, (offset+7),4,ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_password, tvb, (offset+11),4,ENC_ASCII|ENC_NA);\r\noffset = offset + 15;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0306:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 8)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_program_number, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_begin_word, tvb, (offset+2), 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_num_words, tvb, (offset+6), 2, ENC_BIG_ENDIAN);\r\noffset = offset + 8;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining >= 10)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_program_number, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_begin_word, tvb, (offset+4), 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_num_words, tvb, (offset+8), 2, ENC_BIG_ENDIAN);\r\nif(reported_length_remaining > 10)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_data, tvb, (offset+10), -1, ENC_NA);\r\n}\r\noffset = offset + reported_length_remaining;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0307:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining >= 8)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_program_number, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_begin_word, tvb, (offset+2), 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_num_words, tvb, (offset+6), 2, ENC_BIG_ENDIAN);\r\nif(reported_length_remaining > 8)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_command_data, tvb, (offset+8), -1, ENC_NA);\r\n}\r\noffset = offset + reported_length_remaining;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 10)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_program_number, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_begin_word, tvb, (offset+4), 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_num_words, tvb, (offset+8), 2, ENC_BIG_ENDIAN);\r\noffset = offset + 10;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0308:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 3)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_program_number, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_clear_code, tvb, (offset+2), 1, ENC_BIG_ENDIAN);\r\noffset = offset + 3;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0401:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 3)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_program_number, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_mode_code, tvb, (offset+2), 1, ENC_BIG_ENDIAN);\r\noffset = offset + 3;\r\n}\r\nelse if (reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_program_number, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_monitor_label, tvb, offset, 0, ENC_NA);\r\noffset = offset + 2;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0402:\r\n{\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0501:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 1)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_command_data, tvb,\r\noffset, -1, ENC_NA);\r\noffset = offset + 1;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 94)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_controller_model, tvb, (offset+2), 20, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(command_tree, hf_omron_controller_version, tvb, (offset+22), 20, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(command_tree, hf_omron_for_system_use, tvb, (offset+42), 40, ENC_ASCII|ENC_NA);\r\narea_data_tree = proto_tree_add_subtree(command_tree, tvb, (offset+82), 12, ett_area_data, NULL, "Area Data");\r\nproto_tree_add_item(area_data_tree, hf_omron_program_area_size, tvb, (offset+82), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(area_data_tree, hf_omron_iom_size, tvb, (offset+84), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(area_data_tree, hf_omron_num_dm_words, tvb, (offset+85), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(area_data_tree, hf_omron_timer_counter_size, tvb, (offset+87), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(area_data_tree, hf_omron_expansion_dm_size, tvb, (offset+88), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(area_data_tree, hf_omron_num_step_transitions, tvb, (offset+89), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(area_data_tree, hf_omron_kind_memory_card, tvb, (offset+91), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(area_data_tree, hf_omron_memory_card_size, tvb, (offset+92), 2, ENC_BIG_ENDIAN);\r\noffset = offset + 94;\r\n}\r\nelse if(reported_length_remaining == 69)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\ncpu_bus_tree = proto_tree_add_subtree(command_tree, tvb, (offset+2), 64, ett_cpu_bus, NULL, "CPU Bus Unit Conf");\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_0, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_1, tvb, (offset+4), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_2, tvb, (offset+6), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_3, tvb, (offset+8), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_4, tvb, (offset+10), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_5, tvb, (offset+12), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_6, tvb, (offset+14), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_7, tvb, (offset+16), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_8, tvb, (offset+18), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_9, tvb, (offset+20), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_10, tvb, (offset+22), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_11, tvb, (offset+24), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_12, tvb, (offset+26), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_13, tvb, (offset+28), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_14, tvb, (offset+30), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_15, tvb, (offset+32), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_reserved, tvb, (offset+34), 32, ENC_ASCII|ENC_NA);\r\nio_data_tree = proto_tree_add_subtree(command_tree, tvb, (offset+66), 2, ett_io_data, NULL, "Remote I/O data");\r\nproto_tree_add_item(io_data_tree, hf_omron_io_data_num_sysmac_1, tvb, (offset+66), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(io_data_tree, hf_omron_io_data_num_sysmac_2, tvb, (offset+67), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(command_tree, tvb, (offset+68), hf_omron_pc_status,\r\nett_pc_status_fields, pc_status_fields, ENC_BIG_ENDIAN);\r\noffset = offset + 69;\r\n}\r\nelse if(reported_length_remaining == 161)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_controller_model, tvb, (offset+2), 20, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(command_tree, hf_omron_controller_version, tvb, (offset+22), 20, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(command_tree, hf_omron_for_system_use, tvb, (offset+42), 40, ENC_ASCII|ENC_NA);\r\narea_data_tree = proto_tree_add_subtree(command_tree, tvb, (offset+82), 12, ett_area_data, NULL, "Area Data");\r\nproto_tree_add_item(area_data_tree, hf_omron_program_area_size, tvb, (offset+82), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(area_data_tree, hf_omron_iom_size, tvb, (offset+84), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(area_data_tree, hf_omron_num_dm_words, tvb, (offset+85), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(area_data_tree, hf_omron_timer_counter_size, tvb, (offset+87), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(area_data_tree, hf_omron_expansion_dm_size, tvb, (offset+88), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(area_data_tree, hf_omron_num_step_transitions, tvb, (offset+89), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(area_data_tree, hf_omron_kind_memory_card, tvb, (offset+91), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(area_data_tree, hf_omron_memory_card_size, tvb, (offset+92), 2, ENC_BIG_ENDIAN);\r\ncpu_bus_tree = proto_tree_add_subtree(command_tree, tvb, (offset+94), 64, ett_cpu_bus, NULL, "CPU Bus Unit Conf");\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_0, tvb, (offset+94), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_1, tvb, (offset+96), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_2, tvb, (offset+98), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_3, tvb, (offset+100), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_4, tvb, (offset+102), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_5, tvb, (offset+104), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_6, tvb, (offset+106), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_7, tvb, (offset+108), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_8, tvb, (offset+110), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_9, tvb, (offset+112), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_10, tvb, (offset+114), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_11, tvb, (offset+116), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_12, tvb, (offset+118), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_13, tvb, (offset+120), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_14, tvb, (offset+122), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_unit_15, tvb, (offset+124), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(cpu_bus_tree, hf_omron_cpu_bus_reserved, tvb, (offset+126), 32, ENC_ASCII|ENC_NA);\r\nio_data_tree = proto_tree_add_subtree(command_tree, tvb, (offset+158), 2, ett_io_data, NULL, "Remote I/O data");\r\nproto_tree_add_item(io_data_tree, hf_omron_io_data_num_sysmac_1, tvb, (offset+158), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(io_data_tree, hf_omron_io_data_num_sysmac_2, tvb, (offset+159), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(command_tree, tvb, (offset+160), hf_omron_pc_status,\r\nett_pc_status_fields, pc_status_fields, ENC_BIG_ENDIAN);\r\noffset = offset + 161;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0502:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining >= 1)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_unit_address, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nif (reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_num_units, tvb, (offset+1), 1, ENC_BIG_ENDIAN);\r\noffset = offset + 1;\r\n}\r\noffset = offset + 1;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining >= 24)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_num_units, tvb, offset+2, 1, ENC_BIG_ENDIAN);\r\noffset = offset + 3;\r\nreported_length_remaining = reported_length_remaining - 3;\r\nwhile(reported_length_remaining >= 21)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_unit_address, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_model_number, tvb, offset+1, 20, ENC_ASCII|ENC_NA);\r\noffset = offset + 21;\r\nreported_length_remaining = reported_length_remaining - 21;\r\n}\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0601:\r\n{\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 28)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_status, tvb, (offset+2), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_mode_code, tvb, (offset+3), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(command_tree, tvb, (offset+4), hf_omron_fatal_error_data,\r\nett_fatal_fields, fatal_error_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(command_tree, tvb, (offset+6), hf_omron_non_fatal_error_data,\r\nett_non_fatal_fields, non_fatal_error_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(command_tree, tvb, (offset+8), hf_omron_message,\r\nett_message_fields, message_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_fals, tvb, (offset+10), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_error_message, tvb, (offset+12), 16, ENC_ASCII|ENC_NA);\r\noffset = offset + 28;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0602:\r\n{\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 108)\r\n{\r\nproto_tree *netw_nodes_sts_tree;\r\nproto_tree *netw_nodes_non_fatal_err_sts_tree;\r\nproto_tree *netw_nodes_cyclic_err_ctrs_tree;\r\nguint8 i;\r\nguint8 node_num;\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\nnetw_nodes_sts_tree = proto_tree_add_subtree(command_tree, tvb, offset, 31, ett_omron_netw_nodes_sts, NULL, "Network Nodes Status");\r\nnode_num = 1;\r\nfor(i = 0; i < 31; i++)\r\n{\r\nfield_tree = proto_tree_add_subtree_format(netw_nodes_sts_tree, tvb, offset, 1,\r\nett_omron_netw_node_sts, NULL, "Node Number %d", node_num);\r\nproto_tree_add_item(field_tree, hf_omron_netw_node_sts_low_3, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_tree, hf_omron_netw_node_sts_low_2, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_tree, hf_omron_netw_node_sts_low_1, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_tree, hf_omron_netw_node_sts_low_0, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nnode_num = node_num + 1;\r\nfield_tree = proto_tree_add_subtree_format(netw_nodes_sts_tree, tvb, offset, 1,\r\nett_omron_netw_node_sts, NULL, "Node Number %d", node_num);\r\nproto_tree_add_item(field_tree, hf_omron_netw_node_sts_high_3, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_tree, hf_omron_netw_node_sts_high_2, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_tree, hf_omron_netw_node_sts_high_1, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(field_tree, hf_omron_netw_node_sts_high_0, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nnode_num = node_num + 1;\r\noffset = offset + 1;\r\n}\r\nproto_tree_add_item(command_tree, hf_omron_com_cycle_time, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_polling_unit_node_num, tvb, (offset+2), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_cyclic_operation, tvb, (offset+3), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_cyclic_trans_status, tvb, (offset+4), 1, ENC_BIG_ENDIAN);\r\noffset =offset + 5;\r\nnetw_nodes_non_fatal_err_sts_tree = proto_tree_add_subtree(command_tree, tvb, offset, 8,\r\nett_omron_netw_nodes_non_fatal_err_sts, NULL, "Network Nodes Non-Fatal Error Status");\r\nproto_tree_add_bitmask(netw_nodes_non_fatal_err_sts_tree, tvb, (offset+0), hf_omron_cyclic_label_1,\r\nett_omron_cyclic_fields, cyclic_non_fatal_1_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(netw_nodes_non_fatal_err_sts_tree, tvb, (offset+1), hf_omron_cyclic_label_2,\r\nett_omron_cyclic_fields, cyclic_non_fatal_2_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(netw_nodes_non_fatal_err_sts_tree, tvb, (offset+2), hf_omron_cyclic_label_3,\r\nett_omron_cyclic_fields, cyclic_non_fatal_3_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(netw_nodes_non_fatal_err_sts_tree, tvb, (offset+3), hf_omron_cyclic_label_4,\r\nett_omron_cyclic_fields, cyclic_non_fatal_4_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(netw_nodes_non_fatal_err_sts_tree, tvb, (offset+4), hf_omron_cyclic_label_5,\r\nett_omron_cyclic_fields, cyclic_non_fatal_5_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(netw_nodes_non_fatal_err_sts_tree, tvb, (offset+5), hf_omron_cyclic_label_6,\r\nett_omron_cyclic_fields, cyclic_non_fatal_6_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(netw_nodes_non_fatal_err_sts_tree, tvb, (offset+6), hf_omron_cyclic_label_7,\r\nett_omron_cyclic_fields, cyclic_non_fatal_7_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(netw_nodes_non_fatal_err_sts_tree, tvb, (offset+7), hf_omron_cyclic_label_8,\r\nett_omron_cyclic_fields, cyclic_non_fatal_8_fields, ENC_BIG_ENDIAN);\r\noffset = offset + 8;\r\nnetw_nodes_cyclic_err_ctrs_tree = proto_tree_add_subtree(command_tree, tvb, offset, 62,\r\nett_omron_netw_nodes_cyclic_err_ctrs, NULL, "Network Nodes Cyclic Error Counters");\r\nnode_num = 1;\r\nfor(i = 0; i < 62; i++)\r\n{\r\nguint8 ctr = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_uint_format(netw_nodes_cyclic_err_ctrs_tree, hf_omron_node_error_count,\r\ntvb, offset, 1, ctr, "Node Number %2d: %3d", node_num, ctr);\r\nnode_num = node_num + 1;\r\noffset = offset + 1;\r\n}\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0603:\r\n{\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 16)\r\n{\r\nproto_tree *status_flags_tree;\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nti = proto_tree_add_item(command_tree, hf_omron_status_flags, tvb, (offset+2), 1, ENC_BIG_ENDIAN);\r\nomron_status_tree = proto_item_add_subtree(ti, ett_omron_status_block);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_flags_slave_master, tvb, (offset+2), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_flags_data_link, tvb, (offset+2), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_master_node_number, tvb, (offset+3), 1, ENC_BIG_ENDIAN);\r\noffset = offset + 4;\r\nstatus_flags_tree = proto_tree_add_subtree(command_tree, tvb, offset, 96, ett_omron_data_link_status_tree, NULL, "Status flag blocks");\r\nti = proto_tree_add_item(status_flags_tree, hf_omron_status_flags, tvb, (offset+0), 3, ENC_BIG_ENDIAN);\r\nomron_status_tree = proto_item_add_subtree(ti, ett_omron_status_block);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_0, tvb, (offset+0), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_1, tvb, (offset+0), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_2, tvb, (offset+0), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_3, tvb, (offset+0), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_4, tvb, (offset+0), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_5, tvb, (offset+0), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_6, tvb, (offset+0), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_7, tvb, (offset+0), 1, ENC_BIG_ENDIAN);\r\nti = proto_tree_add_item(status_flags_tree, hf_omron_status_flags, tvb, (offset+0), 3, ENC_BIG_ENDIAN);\r\nomron_status_tree = proto_item_add_subtree(ti, ett_omron_status_block);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_0, tvb, (offset+1), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_1, tvb, (offset+1), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_2, tvb, (offset+1), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_3, tvb, (offset+1), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_4, tvb, (offset+1), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_5, tvb, (offset+1), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_6, tvb, (offset+1), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_7, tvb, (offset+1), 1, ENC_BIG_ENDIAN);\r\nti = proto_tree_add_item(status_flags_tree, hf_omron_status_flags, tvb, (offset+0), 3, ENC_BIG_ENDIAN);\r\nomron_status_tree = proto_item_add_subtree(ti, ett_omron_status_block);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_0, tvb, (offset+2), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_1, tvb, (offset+2), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_2, tvb, (offset+2), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_3, tvb, (offset+2), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_4, tvb, (offset+2), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_5, tvb, (offset+2), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_6, tvb, (offset+2), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_7, tvb, (offset+2), 1, ENC_BIG_ENDIAN);\r\nti = proto_tree_add_item(status_flags_tree, hf_omron_status_flags, tvb, (offset+3), 3, ENC_BIG_ENDIAN);\r\nomron_status_tree = proto_item_add_subtree(ti, ett_omron_status_block);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_0, tvb, (offset+3), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_1, tvb, (offset+3), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_2, tvb, (offset+3), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_3, tvb, (offset+3), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_4, tvb, (offset+3), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_5, tvb, (offset+3), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_6, tvb, (offset+3), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_7, tvb, (offset+3), 1, ENC_BIG_ENDIAN);\r\nti = proto_tree_add_item(status_flags_tree, hf_omron_status_flags, tvb, (offset+3), 3, ENC_BIG_ENDIAN);\r\nomron_status_tree = proto_item_add_subtree(ti, ett_omron_status_block);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_0, tvb, (offset+4), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_1, tvb, (offset+4), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_2, tvb, (offset+4), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_3, tvb, (offset+4), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_4, tvb, (offset+4), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_5, tvb, (offset+4), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_6, tvb, (offset+4), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_7, tvb, (offset+4), 1, ENC_BIG_ENDIAN);\r\nti = proto_tree_add_item(status_flags_tree, hf_omron_status_flags, tvb, (offset+3), 3, ENC_BIG_ENDIAN);\r\nomron_status_tree = proto_item_add_subtree(ti, ett_omron_status_block);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_0, tvb, (offset+5), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_1, tvb, (offset+5), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_2, tvb, (offset+5), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_3, tvb, (offset+5), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_4, tvb, (offset+5), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_5, tvb, (offset+5), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_6, tvb, (offset+5), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_7, tvb, (offset+5), 1, ENC_BIG_ENDIAN);\r\nti = proto_tree_add_item(status_flags_tree, hf_omron_status_flags, tvb, (offset+6), 3, ENC_BIG_ENDIAN);\r\nomron_status_tree = proto_item_add_subtree(ti, ett_omron_status_block);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_0, tvb, (offset+6), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_1, tvb, (offset+6), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_2, tvb, (offset+6), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_3, tvb, (offset+6), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_4, tvb, (offset+6), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_5, tvb, (offset+6), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_6, tvb, (offset+6), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_7, tvb, (offset+6), 1, ENC_BIG_ENDIAN);\r\nti = proto_tree_add_item(status_flags_tree, hf_omron_status_flags, tvb, (offset+6), 3, ENC_BIG_ENDIAN);\r\nomron_status_tree = proto_item_add_subtree(ti, ett_omron_status_block);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_0, tvb, (offset+7), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_1, tvb, (offset+7), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_2, tvb, (offset+7), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_3, tvb, (offset+7), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_4, tvb, (offset+7), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_5, tvb, (offset+7), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_6, tvb, (offset+7), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_7, tvb, (offset+7), 1, ENC_BIG_ENDIAN);\r\nti = proto_tree_add_item(status_flags_tree, hf_omron_status_flags, tvb, (offset+6), 3, ENC_BIG_ENDIAN);\r\nomron_status_tree = proto_item_add_subtree(ti, ett_omron_status_block);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_0, tvb, (offset+8), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_1, tvb, (offset+8), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_2, tvb, (offset+8), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_3, tvb, (offset+8), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_4, tvb, (offset+8), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_5, tvb, (offset+8), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_6, tvb, (offset+8), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_7, tvb, (offset+8), 1, ENC_BIG_ENDIAN);\r\nti = proto_tree_add_item(status_flags_tree, hf_omron_status_flags, tvb, (offset+9), 3, ENC_BIG_ENDIAN);\r\nomron_status_tree = proto_item_add_subtree(ti, ett_omron_status_block);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_0, tvb, (offset+9), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_1, tvb, (offset+9), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_2, tvb, (offset+9), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_3, tvb, (offset+9), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_4, tvb, (offset+9), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_5, tvb, (offset+9), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_6, tvb, (offset+9), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_node_7, tvb, (offset+9), 1, ENC_BIG_ENDIAN);\r\nti = proto_tree_add_item(status_flags_tree, hf_omron_status_flags, tvb, (offset+9), 3, ENC_BIG_ENDIAN);\r\nomron_status_tree = proto_item_add_subtree(ti, ett_omron_status_block);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_0, tvb, (offset+10), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_1, tvb, (offset+10), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_2, tvb, (offset+10), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_3, tvb, (offset+10), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_4, tvb, (offset+10), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_5, tvb, (offset+10), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_6, tvb, (offset+10), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_1_node_7, tvb, (offset+10), 1, ENC_BIG_ENDIAN);\r\nti = proto_tree_add_item(status_flags_tree, hf_omron_status_flags, tvb, (offset+9), 3, ENC_BIG_ENDIAN);\r\nomron_status_tree = proto_item_add_subtree(ti, ett_omron_status_block);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_0, tvb, (offset+11), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_1, tvb, (offset+11), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_2, tvb, (offset+11), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_3, tvb, (offset+11), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_4, tvb, (offset+11), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_5, tvb, (offset+11), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_6, tvb, (offset+11), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_status_tree, hf_omron_status_2_node_7, tvb, (offset+11), 1, ENC_BIG_ENDIAN);\r\noffset = offset + 12;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0620:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 1)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_parameter, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset = offset + 1;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\nelse if(reported_length_remaining == 14)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_avg_cycle_time, tvb, (offset+2), 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_max_cycle_time, tvb, (offset+6), 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_min_cycle_time, tvb, (offset+10), 4, ENC_BIG_ENDIAN);\r\noffset = offset + 14;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0701:\r\n{\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 9)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_year, tvb, (offset+2), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_month, tvb, (offset+3), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_date, tvb, (offset+4), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_hour, tvb, (offset+5), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_minute, tvb, (offset+6), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_second, tvb, (offset+7), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_day, tvb, (offset+8), 1, ENC_BIG_ENDIAN);\r\noffset = offset + 9;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0702:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining >= 5)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_year, tvb, (offset), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_month, tvb, (offset+1), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_date, tvb, (offset+2), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_hour, tvb, (offset+3), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_minute, tvb, (offset+4), 1, ENC_BIG_ENDIAN);\r\nif(reported_length_remaining == 7)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_second, tvb, (offset+5), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_day, tvb, (offset+6), 1, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\noffset = offset + 5;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0801:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining > 0)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_data, tvb, offset, -1, ENC_NA);\r\noffset = offset + reported_length_remaining;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining > 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_data, tvb, (offset+2), -1, ENC_NA);\r\noffset = offset + reported_length_remaining;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0802:\r\n{\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 4)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_num_receptions, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\noffset = offset + 4;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0803:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining > 0)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_data, tvb, offset, -1, ENC_NA);\r\noffset = offset + reported_length_remaining;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0920:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nif((tvb_get_ntohs(tvb, offset) & 0xC000) == 0x8000)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_fals, tvb, offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_bitmask(command_tree, tvb, offset, hf_omron_message,\r\nett_message_fields, message_yes_no_fields, ENC_BIG_ENDIAN);\r\n}\r\noffset = offset + 2;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\nelse if(reported_length_remaining == 20)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_fals, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_error_message, tvb, (offset+4), 16, ENC_ASCII|ENC_NA);\r\noffset = offset + 20;\r\n}\r\nelse if(reported_length_remaining >= 4)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(command_tree, tvb, (offset+2), hf_omron_message,\r\nett_message_fields, message_yes_no_fields, ENC_BIG_ENDIAN);\r\noffset = offset + 4;\r\nreported_length_remaining = reported_length_remaining - 4;\r\nwhile (reported_length_remaining >= 32)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_read_message, tvb, offset, 32, ENC_ASCII|ENC_NA);\r\noffset = offset + 32;\r\nreported_length_remaining = reported_length_remaining - 32;\r\n}\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0C01:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_program_number, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\nelse if(reported_length_remaining == 5)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_unit_address, tvb, (offset+2), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_node_number, tvb, (offset+3), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_network_address, tvb, (offset+4), 1, ENC_BIG_ENDIAN);\r\noffset = offset + 5;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0C02:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_program_number, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x0C03:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_program_number, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x2101:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_error_reset_fals_no, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x2102:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 4)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_beginning_record_no, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_no_of_records, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\noffset = offset + 4;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining >= 8)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_max_no_of_stored_records, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_no_of_stored_records, tvb, (offset+4), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_no_of_records, tvb, (offset+6), 2, ENC_BIG_ENDIAN);\r\noffset = offset + 8;\r\nreported_length_remaining = reported_length_remaining - 8;\r\nwhile(reported_length_remaining >= 10)\r\n{\r\nerror_log_tree = proto_tree_add_subtree(command_tree, tvb, offset, 10, ett_omron_error_log_data, NULL, "Error log data");\r\nproto_tree_add_item(error_log_tree, hf_omron_error_reset_fals_no, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(error_log_tree, hf_omron_error_reset_fals_no, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(error_log_tree, hf_omron_minute, tvb, (offset+4), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(error_log_tree, hf_omron_second, tvb, (offset+5), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(error_log_tree, hf_omron_day, tvb, (offset+6), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(error_log_tree, hf_omron_hour, tvb, (offset+7), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(error_log_tree, hf_omron_year, tvb, (offset+8), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(error_log_tree, hf_omron_month, tvb, (offset+9), 1, ENC_BIG_ENDIAN);\r\noffset = offset + 10;\r\nreported_length_remaining = reported_length_remaining - 10;\r\n}\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x2103:\r\n{\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x2201:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 6)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_disk_no, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_beginning_file_position, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_no_of_files, tvb, (offset+4), 2, ENC_BIG_ENDIAN);\r\noffset = offset + 6;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining >= 50)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nomron_disk_data_tree = proto_tree_add_subtree(command_tree, tvb, (offset+2), 26, ett_omron_disk_data, NULL, "Disk data");\r\nproto_tree_add_item(omron_disk_data_tree, hf_omron_volume_label, tvb, (offset+2), 12, ENC_ASCII|ENC_NA);\r\nomron_byte = tvb_get_guint8(tvb, (offset+14));\r\nproto_tree_add_uint_format_value(omron_disk_data_tree, hf_omron_date_year, tvb, (offset+14), 1, omron_byte,\r\n"%d", ((omron_byte>>1)+1980));\r\nproto_tree_add_item(omron_disk_data_tree, hf_omron_date_month, tvb, (offset+14), 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_disk_data_tree, hf_omron_date_day, tvb, (offset+14), 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_disk_data_tree, hf_omron_date_hour, tvb, (offset+14), 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_disk_data_tree, hf_omron_date_minute, tvb, (offset+14), 4, ENC_BIG_ENDIAN);\r\nomron_byte = tvb_get_guint8(tvb, (offset+17));\r\nproto_tree_add_uint_format_value(omron_disk_data_tree, hf_omron_date_second, tvb, (offset+17), 1, omron_byte,\r\n"%d", ((omron_byte&0x1F)*2));\r\nproto_tree_add_item(omron_disk_data_tree, hf_omron_total_capacity, tvb, (offset+18), 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_disk_data_tree, hf_omron_unused_capacity, tvb, (offset+22), 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_disk_data_tree, hf_omron_total_no_files, tvb, (offset+26), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_disk_data_tree, hf_omron_no_files, tvb, (offset+28), 2, ENC_BIG_ENDIAN);\r\noffset = offset + 30;\r\nreported_length_remaining = reported_length_remaining - 30;\r\nwhile(reported_length_remaining >= 20)\r\n{\r\nomron_file_data_tree = proto_tree_add_subtree(command_tree, tvb, offset, 20, ett_omron_file_data, NULL, "File data");\r\nproto_tree_add_item(omron_file_data_tree, hf_omron_filename, tvb, offset, 12, ENC_ASCII|ENC_NA);\r\nomron_byte = tvb_get_guint8(tvb, (offset+12));\r\nproto_tree_add_uint_format_value(omron_file_data_tree, hf_omron_date_year, tvb, (offset+12), 1, omron_byte,\r\n"%d", ((omron_byte>>1)+1980));\r\nproto_tree_add_item(omron_file_data_tree, hf_omron_date_month, tvb, (offset+12), 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_file_data_tree, hf_omron_date_day, tvb, (offset+12), 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_file_data_tree, hf_omron_date_hour, tvb, (offset+12), 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(omron_file_data_tree, hf_omron_date_minute, tvb, (offset+12), 4, ENC_BIG_ENDIAN);\r\nomron_byte = tvb_get_guint8(tvb, (offset+15));\r\nproto_tree_add_uint_format_value(omron_file_data_tree, hf_omron_date_second, tvb, (offset+15), 1, omron_byte,\r\n"%d", ((omron_byte&0x1F)*2));\r\nproto_tree_add_item(omron_file_data_tree, hf_omron_file_capacity, tvb, (offset+16), 4, ENC_BIG_ENDIAN);\r\noffset = offset + 20;\r\nreported_length_remaining = reported_length_remaining - 20;\r\n}\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x2202:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 20)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_disk_no, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_filename, tvb, (offset+2), 12, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(command_tree, hf_omron_file_position, tvb, (offset+14), 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_data_length, tvb, (offset+18), 2, ENC_BIG_ENDIAN);\r\noffset = offset + 20;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining >= 12)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_file_capacity, tvb, (offset+2), 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_file_position, tvb, (offset+6), 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_data_length, tvb, (offset+10), 2, ENC_BIG_ENDIAN);\r\nif(reported_length_remaining > 12)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_file_data, tvb, (offset+12), -1, ENC_NA);\r\n}\r\noffset = offset + reported_length_remaining;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x2203:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining >= 22)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_disk_no, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_file_parameter_code, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_filename, tvb, (offset+4), 12, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(command_tree, hf_omron_file_position, tvb, (offset+16), 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_data_length, tvb, (offset+20), 2, ENC_BIG_ENDIAN);\r\nif(reported_length_remaining > 22)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_file_data, tvb, (offset+22), -1, ENC_NA);\r\n}\r\noffset = offset + reported_length_remaining;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x2204:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_disk_no, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x2205:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining >= 16)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_disk_no, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_no_files, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\noffset = offset + 4;\r\nreported_length_remaining = reported_length_remaining - 4;\r\nwhile(reported_length_remaining >= 12)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_filename, tvb, offset, 12, ENC_ASCII|ENC_NA);\r\noffset = offset + 12;\r\nreported_length_remaining = reported_length_remaining - 12;\r\n}\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 4)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_no_files, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\noffset = offset + 4;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x2206:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining >= 4)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_disk_no, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_volume_parameter_code, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\nif(reported_length_remaining == 16)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_volume_label, tvb, (offset+4), 12, ENC_ASCII|ENC_NA);\r\noffset = offset + 12;\r\n}\r\noffset = offset + 4;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x2207:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 28)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_disk_no, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_filename, tvb, (offset+2), 12, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(command_tree, hf_omron_disk_no, tvb, (offset+14), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_filename, tvb, (offset+16), 12, ENC_ASCII|ENC_NA);\r\noffset = offset + 28;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x2208:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 26)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_disk_no, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_filename, tvb, (offset+2), 12, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(command_tree, hf_omron_filename, tvb, (offset+14), 12, ENC_ASCII|ENC_NA);\r\noffset = offset + 26;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x2209:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 14)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_disk_no, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_filename, tvb, (offset+2), 12, ENC_ASCII|ENC_NA);\r\noffset = offset + 14;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x220A:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 22)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_transfer_parameter_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_command_memory_area_code, tvb, (offset+2), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_transfer_beginning_address, tvb, (offset+3), 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_num_items, tvb, (offset+6), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_disk_no, tvb, (offset+8), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_filename, tvb, (offset+10), 12, ENC_ASCII|ENC_NA);\r\noffset = offset + 22;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 4)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_num_items, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\noffset = offset + 4;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x220B:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 22)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_transfer_parameter_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_parameter_area_code, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_address, tvb, (offset+4), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_num_words, tvb, (offset+6), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_disk_no, tvb, (offset+8), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_filename, tvb, (offset+10), 12, ENC_ASCII|ENC_NA);\r\noffset = offset + 22;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 4)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_num_words, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\noffset = offset + 4;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x220C:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 26)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_transfer_parameter_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_program_number, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_begin_word, tvb, (offset+4), 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_number_of_bytes, tvb, (offset+8), 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_disk_no, tvb, (offset+12), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_filename, tvb, (offset+14), 12, ENC_ASCII|ENC_NA);\r\noffset = offset + 26;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 6)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_number_of_bytes, tvb, (offset+2), 4, ENC_BIG_ENDIAN);\r\noffset = offset + 6;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x220F:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 3)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_beginning_block_num, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_num_blocks, tvb, (offset+2), 1, ENC_BIG_ENDIAN);\r\noffset = offset + 3;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining >= 9)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_num_blocks_remaining, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_total_num_blocks, tvb, (offset+4), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_type, tvb, (offset+6), 1, ENC_BIG_ENDIAN);\r\noffset = offset + 7;\r\nreported_length_remaining = reported_length_remaining - 7;\r\nwhile(reported_length_remaining >= 2)\r\n{\r\nproto_tree_add_bitmask(command_tree, tvb, offset, hf_omron_data_type,\r\nett_omron_data_type, data_type_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_control_data, tvb, (offset+1), 1, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\nreported_length_remaining = reported_length_remaining - 2;\r\n}\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x2210:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_block_num, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining >= 4)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(command_tree, tvb, (offset+2), hf_omron_data_type,\r\nett_omron_data_type, data_type_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_control_data, tvb, (offset+3), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_data, tvb, (offset+4), -1, ENC_NA);\r\noffset = offset + reported_length_remaining;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x2211:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining >= 4)\r\n{\r\nproto_tree_add_bitmask(command_tree, tvb, offset, hf_omron_data_type,\r\nett_omron_data_type, data_type_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_control_data, tvb, (offset+1), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_block_num, tvb, (offset+2), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_data, tvb, (offset+4), -1, ENC_NA);\r\noffset = offset + reported_length_remaining;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x2301:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining >= 8)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_number_of_bits_flags, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\nreported_length_remaining = reported_length_remaining - 2;\r\nwhile (reported_length_remaining >= 6)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_set_reset_specification, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_command_memory_area_code, tvb, (offset+2), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_bit_flag, tvb, (offset+3), 3, ENC_BIG_ENDIAN);\r\noffset = offset + 6;\r\nreported_length_remaining = reported_length_remaining - 6;\r\n}\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x2302:\r\n{\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x230A:\r\n{\r\nif(is_command)\r\n{\r\nif(reported_length_remaining == 6)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_command_memory_area_code, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_transfer_beginning_address, tvb, (offset+1), 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_num_unit_uint16, tvb, (offset+4), 2, ENC_BIG_ENDIAN);\r\noffset = offset + 6;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining >= 8)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_command_memory_area_code, tvb, (offset+2), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_transfer_beginning_address, tvb, (offset+3), 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_num_unit_uint16, tvb, (offset+6), 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_data, tvb, (offset+8), -1, ENC_NA);\r\noffset = offset + reported_length_remaining;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x2601:\r\n{\r\nif(is_command)\r\n{\r\nif((reported_length_remaining > 0) && (reported_length_remaining <= 8))\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_name_data, tvb, offset, -1, ENC_ASCII|ENC_NA);\r\noffset = offset + reported_length_remaining;\r\n}\r\n}\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x2602:\r\n{\r\nif(is_response)\r\n{\r\nif(reported_length_remaining == 2)\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset = offset + 2;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x2603:\r\n{\r\nif(is_response)\r\n{\r\nif((reported_length_remaining > 2) && (reported_length_remaining <= (2+8)))\r\n{\r\nproto_tree_add_item(command_tree, hf_omron_response_code, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(command_tree, hf_omron_name_data, tvb, offset, -1, ENC_ASCII|ENC_NA);\r\noffset = offset + reported_length_remaining;\r\n}\r\n}\r\n}\r\nbreak;\r\ndefault:\r\n{\r\n;\r\n}\r\nbreak;\r\n}\r\nif ((guint)offset != tvb_reported_length(tvb)) {\r\nexpert_add_info(pinfo, omron_tree, &ei_omron_bad_length);\r\n}\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_omron_fins(void)\r\n{\r\n#if 0\r\nmodule_t *omron_fins_module;\r\n#endif\r\nstatic hf_register_info hf[] = {\r\n{ &hf_omron_icf,\r\n{ "OMRON ICF Field", "omron.icf", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_icf_gwb,\r\n{ "Gateway bit", "omron.icf.gwb", FT_UINT8, BASE_HEX, VALS(icf_gw_vals), ICF_GW_MASK, NULL, HFILL }},\r\n{ &hf_omron_icf_dtb,\r\n{ "Data Type bit", "omron.icf.dtb", FT_UINT8, BASE_HEX, VALS(icf_dtb_vals), ICF_DTB_MASK, NULL, HFILL }},\r\n{ &hf_omron_icf_rb0,\r\n{ "Reserved bit 0", "omron.icf.rb0", FT_UINT8, BASE_HEX, NULL, ICF_RB0_MASK, NULL, HFILL }},\r\n{ &hf_omron_icf_rb1,\r\n{ "Reserved bit 1", "omron.icf.rb1", FT_UINT8, BASE_HEX, NULL, ICF_RB1_MASK, NULL, HFILL }},\r\n{ &hf_omron_icf_rb2,\r\n{ "Reserved bit 2", "omron.icf.rb2", FT_UINT8, BASE_HEX, NULL, ICF_RB2_MASK, NULL, HFILL }},\r\n{ &hf_omron_icf_rb3,\r\n{ "Reserved bit 3", "omron.icf.rb3", FT_UINT8, BASE_HEX, NULL, ICF_RB3_MASK, NULL, HFILL }},\r\n{ &hf_omron_icf_rb4,\r\n{ "Reserved bit 4", "omron.icf.rb4", FT_UINT8, BASE_HEX, NULL, ICF_RB4_MASK, NULL, HFILL }},\r\n{ &hf_omron_icf_rsb,\r\n{ "Response setting bit", "omron.icf.rsb", FT_UINT8, BASE_HEX, VALS(icf_rsb_vals), ICF_RSB_MASK, NULL, HFILL }},\r\n{ &hf_omron_rsv,\r\n{ "Reserved", "omron.rsv", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_gct,\r\n{ "Gateway Count", "omron.gct", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_dna,\r\n{ "Destination network address", "omron.dna", FT_UINT8, BASE_RANGE_STRING|BASE_HEX, RVALS(omron_dna_range), 0x0, NULL, HFILL }},\r\n{ &hf_omron_da1,\r\n{ "Destination node number", "omron.da1", FT_UINT8, BASE_RANGE_STRING|BASE_HEX, RVALS(omron_da1_range), 0x0, NULL, HFILL }},\r\n{ &hf_omron_da2,\r\n{ "Destination unit address", "omron.da2", FT_UINT8, BASE_RANGE_STRING|BASE_HEX, RVALS(omron_da2_range), 0x0, NULL, HFILL }},\r\n{ &hf_omron_sna,\r\n{ "Source network address", "omron.sna", FT_UINT8, BASE_RANGE_STRING|BASE_HEX, RVALS(omron_sna_range), 0x0, NULL, HFILL }},\r\n{ &hf_omron_sa1,\r\n{ "Source node number", "omron.sa1", FT_UINT8, BASE_RANGE_STRING|BASE_HEX, RVALS(omron_sa1_range), 0x0, NULL, HFILL }},\r\n{ &hf_omron_sa2,\r\n{ "Source unit address", "omron.sa2", FT_UINT8, BASE_RANGE_STRING|BASE_HEX, RVALS(omron_sa2_range), 0x0, NULL, HFILL }},\r\n{ &hf_omron_sid,\r\n{ "Service ID", "omron.sid", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_command,\r\n{ "Command CODE", "omron.command", FT_UINT16, BASE_HEX, VALS(command_code_cv), 0x0, NULL, HFILL }},\r\n{ &hf_omron_command_memory_area_code,\r\n{ "Memory Area Code", "omron.memory.area.read", FT_UINT8, BASE_HEX, VALS(memory_area_code_cv), 0x0, NULL, HFILL }},\r\n{ &hf_omron_response_code,\r\n{ "Response code", "omron.response.code", FT_UINT16, BASE_HEX, VALS(response_codes), 0x0, NULL, HFILL }},\r\n{ &hf_omron_command_data,\r\n{ "Command Data", "omron.command.data", FT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_omron_address,\r\n{ "Beginning address", "omron.memory.address", FT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n{ &hf_omron_address_bits,\r\n{ "Beginning address bits", "omron.memory.address.bits", FT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n{ &hf_omron_num_items,\r\n{ "Number of items", "omron.memory.numitems", FT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_omron_response_data,\r\n{ "Response data", "omron.response.data", FT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_omron_parameter_area_code,\r\n{ "Parameter area code", "omron.parameter_area_code", FT_UINT16, BASE_HEX, VALS(parameter_area_codes), 0x0, NULL, HFILL }},\r\n{ &hf_omron_beginning_word,\r\n{ "Beginning word", "omron.word", FT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_num_words,\r\n{ "No. words or Bytes", "omron.numwords", FT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_program_number,\r\n{ "Program number", "omron.program_number", FT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_protect_code,\r\n{ "Protect code", "omron.protect_code", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_begin_word,\r\n{ "Beginning word", "omron.word.begin", FT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_last_word,\r\n{ "Last word", "omron.word.last", FT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_password,\r\n{ "Password", "omron.password", FT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_clear_code,\r\n{ "Clear Code", "omron.clearcode", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_mode_code,\r\n{ "Mode Code", "omron.mode_code", FT_UINT8, BASE_HEX, VALS(mode_codes), 0x0, NULL, HFILL }},\r\n{ &hf_omron_monitor_label,\r\n{ "Mode Code (Default Monitor)", "omron.mode_code_default_monitor", FT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_controller_model,\r\n{ "Controller model", "omron.controller.model", FT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_controller_version,\r\n{ "Controller version", "omron.controller.version", FT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_for_system_use,\r\n{ "For system use", "omron.system.use", FT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_program_area_size,\r\n{"Program area size", "omron.area_data.program_area_size", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_iom_size,\r\n{"IOM size", "omron.area_data.iom_size", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_num_dm_words,\r\n{ "No. of DM words", "omron.area_data.dm_words", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_timer_counter_size,\r\n{ "Timer/counter size", "omron.area_data.timer_size", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_expansion_dm_size,\r\n{ "Expansion DM size", "omron.area_data.dm_size", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_num_step_transitions,\r\n{ "No. of steps/transitions", "omron.area_data.num_steps", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_kind_memory_card,\r\n{ "Kind of Memory card", "omron.area_data.memory_card", FT_UINT8, BASE_DEC, VALS(memory_card_codes), 0x0, NULL, HFILL }},\r\n{ &hf_omron_memory_card_size,\r\n{ "Memory card size", "omron.area_data.memory_card.size", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_cpu_bus_unit_0,\r\n{ "CPU Bus Unit No. 0", "omron.cpubus_unit.no0", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_cpu_bus_unit_1,\r\n{ "CPU Bus Unit No. 1", "omron.cpubus_unit.no1", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_cpu_bus_unit_2,\r\n{ "CPU Bus Unit No. 2", "omron.cpubus_unit.no2", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_cpu_bus_unit_3,\r\n{ "CPU Bus Unit No. 3", "omron.cpubus_unit.no3", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_cpu_bus_unit_4,\r\n{ "CPU Bus Unit No. 4", "omron.cpubus_unit.no4", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_cpu_bus_unit_5,\r\n{ "CPU Bus Unit No. 5", "omron.cpubus_unit.no5", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_cpu_bus_unit_6,\r\n{ "CPU Bus Unit No. 6", "omron.cpubus_unit.no6", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_cpu_bus_unit_7,\r\n{ "CPU Bus Unit No. 7", "omron.cpubus_unit.no7", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_cpu_bus_unit_8,\r\n{ "CPU Bus Unit No. 8", "omron.cpubus_unit.no8", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_cpu_bus_unit_9,\r\n{ "CPU Bus Unit No. 9", "omron.cpubus_unit.no9", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_cpu_bus_unit_10,\r\n{ "CPU Bus Unit No. 10", "omron.cpubus_unit.no10", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_cpu_bus_unit_11,\r\n{ "CPU Bus Unit No. 11", "omron.cpubus_unit.no11", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_cpu_bus_unit_12,\r\n{ "CPU Bus Unit No. 12", "omron.cpubus_unit.no12", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_cpu_bus_unit_13,\r\n{ "CPU Bus Unit No. 13", "omron.cpubus_unit.no13", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_cpu_bus_unit_14,\r\n{ "CPU Bus Unit No. 14", "omron.cpubus_unit.no14", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_cpu_bus_unit_15,\r\n{ "CPU Bus Unit No. 15", "omron.cpubus_unit.no15", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_cpu_bus_reserved,\r\n{ "CPU Bus Unit Reserved", "omron.cpubus_unit.reserved", FT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_io_data_num_sysmac_1,\r\n{ "No. of SYSMAC BUS/2 Masters mounted", "omron.remote_io_date.sysmac_1", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_io_data_num_sysmac_2,\r\n{ "No. of SYSMAC BUS Masters mounted", "omron.remote_io_date.sysmac_2", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_pc_status,\r\n{ "PC status", "omron.pc_status", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_pc_status_pdc,\r\n{ "Peripheral Device connected", "omron.pc_status.pdc", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x80, NULL, HFILL}},\r\n{ &hf_omron_pc_status_hi,\r\n{ "With built-in host interface", "omron.pc_status.hi", FT_UINT8, BASE_DEC, NULL, 0x40, NULL, HFILL}},\r\n{ &hf_omron_pc_status_r1,\r\n{ "Reserved 1", "omron.pc_status.r1", FT_UINT8, BASE_DEC, NULL, 0x20, NULL, HFILL}},\r\n{ &hf_omron_pc_status_r2,\r\n{ "Reserved 2", "omron.pc_status.r2", FT_UINT8, BASE_DEC, NULL, 0x10, NULL, HFILL}},\r\n{ &hf_omron_pc_status_rack_num,\r\n{ "Rack Number", "omron.pcp_status.rack_num", FT_UINT8, BASE_DEC, NULL, 0x0F, NULL, HFILL}},\r\n{ &hf_omron_unit_address,\r\n{ "Unit address", "omron.unit_address", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}},\r\n{ &hf_omron_num_units,\r\n{ "No. of Units", "omron.unit_nums", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL}},\r\n{ &hf_omron_model_number,\r\n{ "Model Number", "omron.model_number", FT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL}},\r\n{ &hf_omron_status,\r\n{ "Status", "omron.status", FT_UINT8, BASE_HEX, VALS(status_codes), 0x0, NULL, HFILL}},\r\n{ &hf_omron_fatal_error_data,\r\n{ "Fatal error data", "omron.fatal_error_data", FT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}},\r\n{ &hf_omron_fatal_fals_error,\r\n{"FALS error", "omron.fatal.fals_error", FT_UINT16, BASE_DEC, NULL, 0x8000, NULL, HFILL }},\r\n{ &hf_omron_fatal_sfc_error,\r\n{"Fatal SFC error", "omron.fatal.sfc_error", FT_UINT16, BASE_DEC, NULL, 0x4000, NULL, HFILL }},\r\n{ &hf_omron_fatal_cycle_time_over,\r\n{"Cycle time over", "omron.fatal.cycle_time_over", FT_UINT16, BASE_DEC, NULL, 0x2000, NULL, HFILL }},\r\n{ &hf_omron_fatal_program_error,\r\n{"Program error", "omron.fatal.program_error", FT_UINT16, BASE_DEC, NULL, 0x1000, NULL, HFILL }},\r\n{ &hf_omron_fatal_io_setting_error,\r\n{"I/O setting error", "omron.fatal.io_setting_error", FT_UINT16, BASE_DEC, NULL, 0x0800, NULL, HFILL }},\r\n{ &hf_omron_fatal_io_point_overflow,\r\n{"I/O point overflow", "omron.fatal.io_point_overflow", FT_UINT16, BASE_DEC, NULL, 0x0400, NULL, HFILL }},\r\n{ &hf_omron_fatal_cpu_bus_error,\r\n{"CPU bus error", "omron.fatal.cpu_bus_error", FT_UINT16, BASE_DEC, NULL, 0x0200, NULL, HFILL }},\r\n{ &hf_omron_fatal_duplication_error,\r\n{"Duplication error", "omron.fatal.duplication_error", FT_UINT16, BASE_DEC, NULL, 0x0100, NULL, HFILL }},\r\n{ &hf_omron_fatal_io_bus_error,\r\n{"I/O bus error", "omron.fatal.io_bus_error", FT_UINT16, BASE_DEC, NULL, 0x0080, NULL, HFILL }},\r\n{ &hf_omron_fatal_memory_error,\r\n{"Memory error", "omron.fatal.memory_error", FT_UINT16, BASE_DEC, NULL, 0x0040, NULL, HFILL }},\r\n{ &hf_omron_fatal_rv_1,\r\n{"Reserved", "omron.fatal.rv_1", FT_UINT16, BASE_DEC, NULL, 0x0020, NULL, HFILL }},\r\n{ &hf_omron_fatal_rv_2,\r\n{"Reserved", "omron.fatal.rv_2", FT_UINT16, BASE_DEC, NULL, 0x0010, NULL, HFILL }},\r\n{ &hf_omron_fatal_rv_3,\r\n{"Reserved", "omron.fatal.rv_3", FT_UINT16, BASE_DEC, NULL, 0x0008, NULL, HFILL }},\r\n{ &hf_omron_fatal_rv_4,\r\n{"Reserved", "omron.fatal.rv_4", FT_UINT16, BASE_DEC, NULL, 0x0004, NULL, HFILL }},\r\n{ &hf_omron_fatal_rv_5,\r\n{"Reserved", "omron.fatal.rv_5", FT_UINT16, BASE_DEC, NULL, 0x0002, NULL, HFILL }},\r\n{ &hf_omron_fatal_watch_dog_timer_error,\r\n{"Watch dog timer error", "omron.fatal.watch_dog_timer_error", FT_UINT16, BASE_DEC, NULL, 0x0001, NULL, HFILL }},\r\n{ &hf_omron_non_fatal_error_data,\r\n{ "Non fatal error data", "omron.fatal_error_data", FT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}},\r\n{ &hf_omron_non_fatal_rv1,\r\n{ "Reserved", "omron.non_fatal.rv1", FT_UINT16, BASE_DEC, NULL, 0x8000, NULL, HFILL }},\r\n{ &hf_omron_non_fatal_rv2,\r\n{ "Reserved", "omron.non_fatal.rv2", FT_UINT16, BASE_DEC, NULL, 0x4000, NULL, HFILL }},\r\n{ &hf_omron_non_fatal_power_interruption,\r\n{ "Momentary power interruption", "omron.non_fatal.power_interruption", FT_UINT16, BASE_DEC, NULL, 0x2000, NULL, HFILL }},\r\n{ &hf_omron_non_fatal_cpu_bus_unit_setting_error,\r\n{ "CPU Bus Unit setting error", "omron.non_fatal.cpu_bus_unit_setting_error", FT_UINT16, BASE_DEC, NULL, 0x1000, NULL, HFILL }},\r\n{ &hf_omron_non_fatal_battery_error,\r\n{ "Battery error", "omron.non_fatal.batter_error", FT_UINT16, BASE_DEC, NULL, 0x0800, NULL, HFILL }},\r\n{ &hf_omron_non_fatal_sysmac_bus_error,\r\n{ "SYSMAC BUS error", "omron.non_fatal.sysmac_bus_error", FT_UINT16, BASE_DEC, NULL, 0x0400, NULL, HFILL }},\r\n{ &hf_omron_non_fatal_sysmac_bus2_error,\r\n{ "SYSMAC BUS/2 error", "omron.non_fatal.sysmac_bus2_error", FT_UINT16, BASE_DEC, NULL, 0x0200, NULL, HFILL }},\r\n{ &hf_omron_non_fatal_cpu_bus_unit_error,\r\n{ "CPU Bus Unit error", "omron.non_fatal.cpu_bus_unit_error", FT_UINT16, BASE_DEC, NULL, 0x0100, NULL, HFILL }},\r\n{ &hf_omron_non_fatal_rv3,\r\n{ "Reserved", "omron.non_fatal.rv3", FT_UINT16, BASE_DEC, NULL, 0x0080, NULL, HFILL }},\r\n{ &hf_omron_non_fatal_io_verification_error,\r\n{ "I/O verification error", "omron.non_fatal.io_verification_error", FT_UINT16, BASE_DEC, NULL, 0x0040, NULL, HFILL }},\r\n{ &hf_omron_non_fatal_rv4,\r\n{ "Reserved", "omron.non_fatal.rv4", FT_UINT16, BASE_DEC, NULL, 0x0020, NULL, HFILL }},\r\n{ &hf_omron_non_fatal_sfc_error,\r\n{ "Non-fatal SFC error v", "omron.non_fatal.sfc_error", FT_UINT16, BASE_DEC, NULL, 0x0010, NULL, HFILL }},\r\n{ &hf_omron_non_fatal_indirect_dm_error,\r\n{ "Indirect DM error", "omron.non_fatal.indirect_dm_error", FT_UINT16, BASE_DEC, NULL, 0x0008, NULL, HFILL }},\r\n{ &hf_omron_non_fatal_jmp_error,\r\n{ "JMP error", "omron.non_fatal.jmp_error", FT_UINT16, BASE_DEC, NULL, 0x0004, NULL, HFILL }},\r\n{ &hf_omron_non_fatal_rv5,\r\n{ "Reserved", "omron.non_fatal.rv5", FT_UINT16, BASE_DEC, NULL, 0x0002, NULL, HFILL }},\r\n{ &hf_omron_non_fatal_fal_error,\r\n{ "FAL error", "omron.non_fatal.fal_error", FT_UINT16, BASE_DEC, NULL, 0x0001, NULL, HFILL }},\r\n{ &hf_omron_message,\r\n{ "Message", "omron.message", FT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}},\r\n{ &hf_omron_message_no_0,\r\n{ "Message no. 0", "omron.message.no_0", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x8000, NULL, HFILL }},\r\n{ &hf_omron_message_no_1,\r\n{ "Message no. 1", "omron.message.no_1", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x4000, NULL, HFILL }},\r\n{ &hf_omron_message_no_2,\r\n{ "Message no. 2", "omron.message.no_2", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x2000, NULL, HFILL }},\r\n{ &hf_omron_message_no_3,\r\n{ "Message no. 3", "omron.message.no_3", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x1000, NULL, HFILL }},\r\n{ &hf_omron_message_no_4,\r\n{ "Message no. 4", "omron.message.no_4", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0800, NULL, HFILL }},\r\n{ &hf_omron_message_no_5,\r\n{ "Message no. 5", "omron.message.no_5", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0400, NULL, HFILL }},\r\n{ &hf_omron_message_no_6,\r\n{ "Message no. 6", "omron.message.no_6", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0200, NULL, HFILL }},\r\n{ &hf_omron_message_no_7,\r\n{ "Message no. 7", "omron.message.no_7", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0100, NULL, HFILL }},\r\n{ &hf_omron_message_rv_0,\r\n{ "Reserved", "omron.message.rv_0", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0080, NULL, HFILL }},\r\n{ &hf_omron_message_rv_1,\r\n{ "Reserved", "omron.message.rv_1", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0040, NULL, HFILL }},\r\n{ &hf_omron_message_rv_2,\r\n{ "Reserved", "omron.message.rv_2", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0020, NULL, HFILL }},\r\n{ &hf_omron_message_rv_3,\r\n{ "Reserved", "omron.message.rv_3", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0010, NULL, HFILL }},\r\n{ &hf_omron_message_rv_4,\r\n{ "Reserved", "omron.message.rv_4", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0008, NULL, HFILL }},\r\n{ &hf_omron_message_rv_5,\r\n{ "Reserved", "omron.message.rv_5", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0004, NULL, HFILL }},\r\n{ &hf_omron_message_rv_6,\r\n{ "Reserved", "omron.message.rv_6", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0002, NULL, HFILL }},\r\n{ &hf_omron_message_rv_7,\r\n{ "Reserved", "omron.message.rv_7", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0001, NULL, HFILL }},\r\n{ &hf_omron_fals,\r\n{ "FALS / FALS no.", "omron.fals", FT_UINT16, BASE_HEX, NULL, 0x3FFF, NULL, HFILL}},\r\n{ &hf_omron_error_message,\r\n{ "Error message", "omron.error_message", FT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL}},\r\n{ &hf_omron_parameter,\r\n{ "Parameter", "omron.parameter", FT_UINT8, BASE_HEX, VALS(parameter_codes), 0x0, NULL, HFILL }},\r\n{ &hf_omron_avg_cycle_time,\r\n{ "Average cycle time", "omron.avg_cycle_time", FT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_max_cycle_time,\r\n{ "Max. cycle time", "omron.max_cycle_time", FT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_min_cycle_time,\r\n{ "Min cycle time", "omron.min_cycle_time", FT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_year,\r\n{ "Year", "omron.year", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_month,\r\n{ "Month", "omron.month", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_date,\r\n{ "Date", "omron.date", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_hour,\r\n{ "Hour", "omron.hour", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_minute,\r\n{ "Minute", "omron.minute", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_second,\r\n{ "Second", "omron.second", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_day,\r\n{ "Day", "omron.day", FT_UINT8, BASE_DEC, VALS(omron_days), 0x0, NULL, HFILL }},\r\n{ &hf_omron_read_message,\r\n{ "Message", "omron.read_message", FT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_node_number,\r\n{ "Node number", "omron.node_number", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_network_address,\r\n{ "Network address", "omron.network_address", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_error_reset_fals_no,\r\n{ "Error reset FAL no.", "omron.error_reset_fals_no", FT_UINT16, BASE_RANGE_STRING|BASE_HEX, RVALS(omron_error_reset_range), 0x0, NULL, HFILL }},\r\n{ &hf_omron_beginning_record_no,\r\n{ "Beginning record no.", "omron.beginning_record_no", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_no_of_records,\r\n{ "No. of records", "omron.no_of_records", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_max_no_of_stored_records,\r\n{ "Max. no. of stored records", "omron.max_no_of_stored_records", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_no_of_stored_records,\r\n{ "No. of stored records", "omron.no_stored_records", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_disk_no,\r\n{ "Disk no.", "omron.disk_no", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_beginning_file_position,\r\n{ "Beginning file position", "omron.beginning_file_position", FT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_no_of_files,\r\n{ "No. of files", "omron.no_of_files", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_volume_label,\r\n{ "Volume label", "omron.disk_data.volume_label", FT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_date_year,\r\n{ "Year", "omron.disk_data.year", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_date_month,\r\n{ "Month", "omron.disk_data.month", FT_UINT32, BASE_DEC, NULL, 0x01E00000, NULL, HFILL }},\r\n{ &hf_omron_date_day,\r\n{ "Day", "omron.disk_data.day", FT_UINT32, BASE_DEC, NULL, 0x001F0000, NULL, HFILL }},\r\n{ &hf_omron_date_hour,\r\n{ "Hour", "omron.disk_data.hour", FT_UINT32, BASE_DEC, NULL, 0x0000F800, NULL, HFILL }},\r\n{ &hf_omron_date_minute,\r\n{ "Minute", "omron.disk_data.minute", FT_UINT32, BASE_DEC, NULL, 0x000007E0, NULL, HFILL }},\r\n{ &hf_omron_date_second,\r\n{ "Second", "omron.disk_data.second", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_total_capacity,\r\n{ "Total capacity", "omron.disk_data.total_capacity", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_unused_capacity,\r\n{ "Unused capacity", "omron.disk_data.unused_capacity", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_total_no_files,\r\n{ "Total no. of files", "omron.disk_data.total_no_files", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_no_files,\r\n{ "No. of files", "omron.disk_data.no_files", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_filename,\r\n{ "Filename", "omron.file_data.filename", FT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_file_capacity,\r\n{ "File capacity", "omron.file_data.file_capacity", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_file_position,\r\n{ "File position", "omron.file_position", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_data_length,\r\n{ "Data length", "omron.data_length", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_file_data,\r\n{ "File data", "omron.file_data", FT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_file_parameter_code,\r\n{ "Parameter code", "omron.file_parameter_code", FT_UINT16, BASE_HEX, VALS(omron_file_parameter_codes), 0x0, NULL, HFILL }},\r\n{ &hf_omron_volume_parameter_code,\r\n{ "Volume parameter code", "omron.volume_parameter_code", FT_UINT16, BASE_HEX, VALS(omron_volume_parameter_codes), 0x0, NULL, HFILL }},\r\n{ &hf_omron_transfer_parameter_code,\r\n{ "Parameter code", "omron.transfer_parameter_code", FT_UINT16, BASE_HEX, VALS(omron_transfer_parameter_codes), 0x0, NULL, HFILL }},\r\n{ &hf_omron_transfer_beginning_address,\r\n{ "Beginning address", "omron.transfer_beginning_address", FT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_number_of_bytes,\r\n{ "Number of bytes", "omron.number_of_bytes", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_number_of_bits_flags,\r\n{ "No. of bits/flags", "omron.number_of_bits_flags", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_set_reset_specification,\r\n{ "Set/Reset Specification", "omron.set_reset_specification", FT_UINT16, BASE_HEX, VALS(omron_set_reset_specifications), 0x0, NULL, HFILL }},\r\n{ &hf_omron_bit_flag,\r\n{ "Bit/flag", "omron.bit_flag", FT_UINT24, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_data,\r\n{ "Data", "omron.data", FT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_beginning_block_num,\r\n{ "Beginning block number", "omron.beginning_block_num", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_num_blocks,\r\n{ "Number of blocks", "omron.num_blocks", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_num_blocks_remaining,\r\n{ "Number of blocks remaining", "omron.num_blocks_remaining", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_total_num_blocks,\r\n{ "Total number of blocks", "omron.total_num_blocks", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_type,\r\n{ "Type", "omron.type", FT_UINT8, BASE_HEX, VALS(omron_type_codes), 0x0, NULL, HFILL }},\r\n{ &hf_omron_data_type,\r\n{ "Data type", "omron.data_type", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_data_type_type,\r\n{ "Data type", "omron.data_type_type", FT_UINT8, BASE_HEX, VALS(omron_data_type_bits), 0x07, NULL, HFILL }},\r\n{ &hf_omron_data_type_rv,\r\n{ "Reserved", "omron.data_type_rv", FT_UINT8, BASE_HEX, NULL, 0x38, NULL, HFILL }},\r\n{ &hf_omron_data_type_protected,\r\n{ "Protected", "omron.data_type_protected", FT_BOOLEAN, 8, TFS(&boolean_data_type_protected), 0x40, NULL, HFILL }},\r\n{ &hf_omron_data_type_end,\r\n{ "Block", "omron.data_type_end", FT_BOOLEAN, 8, TFS(&boolean_data_type_end), 0x80, NULL, HFILL }},\r\n{ &hf_omron_control_data,\r\n{ "Control data", "omron.control_data", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_block_num,\r\n{ "Block number", "omron.block_num", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_num_unit_uint16,\r\n{ "Number of units", "omron.num_unit_uint16", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_fixed,\r\n{ "Fixed", "omron.fixed", FT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_intelligent_id_no,\r\n{ "Intelligent ID no.", "omron.intelligent_id_no", FT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_first_word,\r\n{ "First word", "omron.first_word", FT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_read_len,\r\n{ "Read length", "omron.read_length", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_no_of_link_nodes,\r\n{ "No. of link nodes", "omron.no_of_link_nodes", FT_UINT8, BASE_DEC, NULL, 0x7F, NULL, HFILL }},\r\n{ &hf_omron_block_record_node_num_status,\r\n{ "Data link status", "omron.block_record.node_num_status", FT_BOOLEAN, 8, TFS(&boolean_node_num_status), 0x80, NULL, HFILL }},\r\n{ &hf_omron_block_record_node_num_num_nodes,\r\n{ "No. of link nodes", "omron.block_record.node_num_num_nodes", FT_UINT8, BASE_DEC, NULL, 0x7F, NULL, HFILL }},\r\n{ &hf_omron_block_record_cio_area,\r\n{ "CIO Area first word", "omron.block_record.cio_area", FT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_block_record_kind_of_dm,\r\n{ "Kind of DM", "omron.block_record.kind_of_dm", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_block_record_dm_area_first_word,\r\n{ "DM Area first word", "omron.block_record.dm_area_first_word", FT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_block_record_no_of_total_words,\r\n{ "No. of total words", "omron.block_record.no_of_total_words", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_status_flags,\r\n{ "Status flags", "omron.status_flags", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_status_flags_slave_master,\r\n{ "Status Type", "omron.status_flags.slave_master", FT_BOOLEAN, 8, TFS(&boolean_status_flags_slave_master), 0x80, NULL, HFILL }},\r\n{ &hf_omron_status_flags_data_link,\r\n{ "Status Data link", "omron.status_flags.data_link", FT_BOOLEAN, 8, TFS(&boolean_status_flags_data_link), 0x01, NULL, HFILL }},\r\n{ &hf_omron_master_node_number,\r\n{ "Master node number", "omron.master_node_number", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_status_node_0,\r\n{ "Node 0", "omron.status.node.0", FT_BOOLEAN, 8, TFS(&boolean_status_flag_status), 0x01, NULL, HFILL }},\r\n{ &hf_omron_status_node_1,\r\n{ "Node 1", "omron.status.node.1", FT_BOOLEAN, 8, TFS(&boolean_status_flag_status), 0x02, NULL, HFILL }},\r\n{ &hf_omron_status_node_2,\r\n{ "Node 2", "omron.status.node.2", FT_BOOLEAN, 8, TFS(&boolean_status_flag_status), 0x04, NULL, HFILL }},\r\n{ &hf_omron_status_node_3,\r\n{ "Node 3", "omron.status.node.3", FT_BOOLEAN, 8, TFS(&boolean_status_flag_status), 0x08, NULL, HFILL }},\r\n{ &hf_omron_status_node_4,\r\n{ "Node 4", "omron.status.node.4", FT_BOOLEAN, 8, TFS(&boolean_status_flag_status), 0x10, NULL, HFILL }},\r\n{ &hf_omron_status_node_5,\r\n{ "Node 5", "omron.status.node.5", FT_BOOLEAN, 8, TFS(&boolean_status_flag_status), 0x20, NULL, HFILL }},\r\n{ &hf_omron_status_node_6,\r\n{ "Node 6", "omron.status.node.6", FT_BOOLEAN, 8, TFS(&boolean_status_flag_status), 0x40, NULL, HFILL }},\r\n{ &hf_omron_status_node_7,\r\n{ "Node 7", "omron.status.node.7", FT_BOOLEAN, 8, TFS(&boolean_status_flag_status), 0x80, NULL, HFILL }},\r\n{ &hf_omron_status_1_node_0,\r\n{ "Node 0", "omron.status.node.10", FT_BOOLEAN, 8, TFS(&boolean_status_block_stop_run), 0x01, NULL, HFILL }},\r\n{ &hf_omron_status_1_node_1,\r\n{ "Node 1", "omron.status.node.11", FT_BOOLEAN, 8, TFS(&boolean_status_block_stop_run), 0x02, NULL, HFILL }},\r\n{ &hf_omron_status_1_node_2,\r\n{ "Node 2", "omron.status.node.12", FT_BOOLEAN, 8, TFS(&boolean_status_block_stop_run), 0x04, NULL, HFILL }},\r\n{ &hf_omron_status_1_node_3,\r\n{ "Node 3", "omron.status.node.13", FT_BOOLEAN, 8, TFS(&boolean_status_block_stop_run), 0x08, NULL, HFILL }},\r\n{ &hf_omron_status_1_node_4,\r\n{ "Node 4", "omron.status.node.14", FT_BOOLEAN, 8, TFS(&boolean_status_block_stop_run), 0x10, NULL, HFILL }},\r\n{ &hf_omron_status_1_node_5,\r\n{ "Node 5", "omron.status.node.15", FT_BOOLEAN, 8, TFS(&boolean_status_block_stop_run), 0x20, NULL, HFILL }},\r\n{ &hf_omron_status_1_node_6,\r\n{ "Node 6", "omron.status.node.16", FT_BOOLEAN, 8, TFS(&boolean_status_block_stop_run), 0x40, NULL, HFILL }},\r\n{ &hf_omron_status_1_node_7,\r\n{ "Node 7", "omron.status.node.17", FT_BOOLEAN, 8, TFS(&boolean_status_block_stop_run), 0x80, NULL, HFILL }},\r\n{ &hf_omron_status_2_node_0,\r\n{ "Node 0", "omron.status.node.20", FT_BOOLEAN, 8, TFS(&boolean_status_flag_status_2), 0x01, NULL, HFILL }},\r\n{ &hf_omron_status_2_node_1,\r\n{ "Node 1", "omron.status.node.21", FT_BOOLEAN, 8, TFS(&boolean_status_flag_status_2), 0x02, NULL, HFILL }},\r\n{ &hf_omron_status_2_node_2,\r\n{ "Node 2", "omron.status.node.22", FT_BOOLEAN, 8, TFS(&boolean_status_flag_status_2), 0x04, NULL, HFILL }},\r\n{ &hf_omron_status_2_node_3,\r\n{ "Node 3", "omron.status.node.23", FT_BOOLEAN, 8, TFS(&boolean_status_flag_status_2), 0x08, NULL, HFILL }},\r\n{ &hf_omron_status_2_node_4,\r\n{ "Node 4", "omron.status.node.24", FT_BOOLEAN, 8, TFS(&boolean_status_flag_status_2), 0x10, NULL, HFILL }},\r\n{ &hf_omron_status_2_node_5,\r\n{ "Node 5", "omron.status.node.25", FT_BOOLEAN, 8, TFS(&boolean_status_flag_status_2), 0x20, NULL, HFILL }},\r\n{ &hf_omron_status_2_node_6,\r\n{ "Node 6", "omron.status.node.26", FT_BOOLEAN, 8, TFS(&boolean_status_flag_status_2), 0x40, NULL, HFILL }},\r\n{ &hf_omron_status_2_node_7,\r\n{ "Node 7", "omron.status.node.27", FT_BOOLEAN, 8, TFS(&boolean_status_flag_status_2), 0x80, NULL, HFILL }},\r\n{ &hf_omron_name_data,\r\n{ "Name data", "omron.name_data", FT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_num_receptions,\r\n{ "Number of receptions", "omron.num_receptions", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_netw_node_sts_low_0,\r\n{ "Network", "omron.node_number.low.network", FT_BOOLEAN, 8, TFS(&boolean_member_network), 0x01, NULL, HFILL }},\r\n{ &hf_omron_netw_node_sts_low_1,\r\n{ "Exit status", "omron.node_number.low.exit_status", FT_BOOLEAN, 8, TFS(&boolean_status_flag_status), 0x02, NULL, HFILL }},\r\n{ &hf_omron_netw_node_sts_low_2,\r\n{ "Reserved", "omron.node_number.low.rv", FT_BOOLEAN, 8, NULL, 0x04, NULL, HFILL }},\r\n{ &hf_omron_netw_node_sts_low_3,\r\n{ "Polling", "omron.node_number.low.polling_Status", FT_BOOLEAN, 8, TFS(&boolean_member_polling), 0x08, NULL, HFILL }},\r\n{ &hf_omron_netw_node_sts_high_0,\r\n{ "Network", "omron.node_number.high.network", FT_BOOLEAN, 8, TFS(&boolean_member_network), 0x10, NULL, HFILL }},\r\n{ &hf_omron_netw_node_sts_high_1,\r\n{ "Exit status", "omron.node_number.high.exit_status", FT_BOOLEAN, 8, TFS(&boolean_status_flag_status), 0x20, NULL, HFILL }},\r\n{ &hf_omron_netw_node_sts_high_2,\r\n{ "Reserved", "omron.node_number.high.rv", FT_BOOLEAN, 8, NULL, 0x40, NULL, HFILL }},\r\n{ &hf_omron_netw_node_sts_high_3,\r\n{ "Polling", "omron.node_number.high.polling_Status", FT_BOOLEAN, 8, TFS(&boolean_member_polling), 0x80, NULL, HFILL }},\r\n{ &hf_omron_com_cycle_time,\r\n{ "Communications cycle time (usec)", "omron.com_cycle_time", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_polling_unit_node_num,\r\n{ "Current polling unit node number", "omron.polling_unit_node_num", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_cyclic_operation,\r\n{ "Cyclic operation", "omron.cyclic_operation", FT_UINT8, BASE_HEX, VALS(omron_cyclic_ops_codes), 0x0, NULL, HFILL }},\r\n{ &hf_omron_cyclic_trans_status,\r\n{ "Cyclic transmission status", "omron.cyclic_trans_status", FT_UINT8, BASE_HEX, VALS(omron_cyclic_trans_codes), 0x0, NULL, HFILL }},\r\n{ &hf_omron_cyclic_label_1,\r\n{ "Nodes 1- 7", "omron.cyclic_error_status", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_cyclic_7,\r\n{ "Node 7 error status", "omron.cyclic_error.node.7", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x80, NULL, HFILL }},\r\n{ &hf_omron_cyclic_6,\r\n{ "Node 6 error status", "omron.cyclic_error.node.6", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x40, NULL, HFILL }},\r\n{ &hf_omron_cyclic_5,\r\n{ "Node 5 error status", "omron.cyclic_error.node.5", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x20, NULL, HFILL }},\r\n{ &hf_omron_cyclic_4,\r\n{ "Node 4 error status", "omron.cyclic_error.node.4", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x10, NULL, HFILL }},\r\n{ &hf_omron_cyclic_3,\r\n{ "Node 3 error status", "omron.cyclic_error.node.3", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x08, NULL, HFILL }},\r\n{ &hf_omron_cyclic_2,\r\n{ "Node 2 error status", "omron.cyclic_error.node.2", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x04, NULL, HFILL }},\r\n{ &hf_omron_cyclic_1,\r\n{ "Node 1 error status", "omron.cyclic_error.node.1", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x02, NULL, HFILL }},\r\n{ &hf_omron_cyclic_label_2,\r\n{ "Nodes 8-15", "omron.cyclic_error_status", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_cyclic_15,\r\n{ "Node 15 error status", "omron.cyclic_error.node.15", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x80, NULL, HFILL }},\r\n{ &hf_omron_cyclic_14,\r\n{ "Node 14 error status", "omron.cyclic_error.node.14", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x40, NULL, HFILL }},\r\n{ &hf_omron_cyclic_13,\r\n{ "Node 13 error status", "omron.cyclic_error.node.13", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x20, NULL, HFILL }},\r\n{ &hf_omron_cyclic_12,\r\n{ "Node 12 error status", "omron.cyclic_error.node.12", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x10, NULL, HFILL }},\r\n{ &hf_omron_cyclic_11,\r\n{ "Node 11 error status", "omron.cyclic_error.node.11", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x08, NULL, HFILL }},\r\n{ &hf_omron_cyclic_10,\r\n{ "Node 10 error status", "omron.cyclic_error.node.10", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x04, NULL, HFILL }},\r\n{ &hf_omron_cyclic_9,\r\n{ "Node 9 error status", "omron.cyclic_error.node.9", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x02, NULL, HFILL }},\r\n{ &hf_omron_cyclic_8,\r\n{ "Node 8 error status", "omron.cyclic_error.node.8", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x01, NULL, HFILL }},\r\n{ &hf_omron_cyclic_label_3,\r\n{ "Nodes 16-23", "omron.cyclic_error_status", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_cyclic_23,\r\n{ "Node 23 error status", "omron.cyclic_error.node.23", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x80, NULL, HFILL }},\r\n{ &hf_omron_cyclic_22,\r\n{ "Node 22 error status", "omron.cyclic_error.node.22", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x40, NULL, HFILL }},\r\n{ &hf_omron_cyclic_21,\r\n{ "Node 21 error status", "omron.cyclic_error.node.21", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x20, NULL, HFILL }},\r\n{ &hf_omron_cyclic_20,\r\n{ "Node 20 error status", "omron.cyclic_error.node.20", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x10, NULL, HFILL }},\r\n{ &hf_omron_cyclic_19,\r\n{ "Node 19 error status", "omron.cyclic_error.node.19", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x08, NULL, HFILL }},\r\n{ &hf_omron_cyclic_18,\r\n{ "Node 18 error status", "omron.cyclic_error.node.18", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x04, NULL, HFILL }},\r\n{ &hf_omron_cyclic_17,\r\n{ "Node 17 error status", "omron.cyclic_error.node.17", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x02, NULL, HFILL }},\r\n{ &hf_omron_cyclic_16,\r\n{ "Node 16 error status", "omron.cyclic_error.node.16", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x01, NULL, HFILL }},\r\n{ &hf_omron_cyclic_label_4,\r\n{ "Nodes 24-31", "omron.cyclic_error_status", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_cyclic_31,\r\n{ "Node 31 error status", "omron.cyclic_error.node.31", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x80, NULL, HFILL }},\r\n{ &hf_omron_cyclic_30,\r\n{ "Node 30 error status", "omron.cyclic_error.node.30", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x40, NULL, HFILL }},\r\n{ &hf_omron_cyclic_29,\r\n{ "Node 29 error status", "omron.cyclic_error.node.29", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x20, NULL, HFILL }},\r\n{ &hf_omron_cyclic_28,\r\n{ "Node 28 error status", "omron.cyclic_error.node.28", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x10, NULL, HFILL }},\r\n{ &hf_omron_cyclic_27,\r\n{ "Node 27 error status", "omron.cyclic_error.node.27", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x08, NULL, HFILL }},\r\n{ &hf_omron_cyclic_26,\r\n{ "Node 26 error status", "omron.cyclic_error.node.26", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x04, NULL, HFILL }},\r\n{ &hf_omron_cyclic_25,\r\n{ "Node 25 error status", "omron.cyclic_error.node.25", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x02, NULL, HFILL }},\r\n{ &hf_omron_cyclic_24,\r\n{ "Node 24 error status", "omron.cyclic_error.node.24", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x01, NULL, HFILL }},\r\n{ &hf_omron_cyclic_label_5,\r\n{ "Nodes 32-39", "omron.cyclic_error_status", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_cyclic_39,\r\n{ "Node 39 error status", "omron.cyclic_error.node.39", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x80, NULL, HFILL }},\r\n{ &hf_omron_cyclic_38,\r\n{ "Node 38 error status", "omron.cyclic_error.node.38", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x40, NULL, HFILL }},\r\n{ &hf_omron_cyclic_37,\r\n{ "Node 37 error status", "omron.cyclic_error.node.37", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x20, NULL, HFILL }},\r\n{ &hf_omron_cyclic_36,\r\n{ "Node 36 error status", "omron.cyclic_error.node.36", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x10, NULL, HFILL }},\r\n{ &hf_omron_cyclic_35,\r\n{ "Node 35 error status", "omron.cyclic_error.node.35", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x08, NULL, HFILL }},\r\n{ &hf_omron_cyclic_34,\r\n{ "Node 34 error status", "omron.cyclic_error.node.34", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x04, NULL, HFILL }},\r\n{ &hf_omron_cyclic_33,\r\n{ "Node 33 error status", "omron.cyclic_error.node.33", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x02, NULL, HFILL }},\r\n{ &hf_omron_cyclic_32,\r\n{ "Node 32 error status", "omron.cyclic_error.node.32", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x01, NULL, HFILL }},\r\n{ &hf_omron_cyclic_label_6,\r\n{ "Nodes 40-47", "omron.cyclic_error_status", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_cyclic_47,\r\n{ "Node 47 error status", "omron.cyclic_error.node.47", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x80, NULL, HFILL }},\r\n{ &hf_omron_cyclic_46,\r\n{ "Node 46 error status", "omron.cyclic_error.node.46", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x40, NULL, HFILL }},\r\n{ &hf_omron_cyclic_45,\r\n{ "Node 45 error status", "omron.cyclic_error.node.45", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x20, NULL, HFILL }},\r\n{ &hf_omron_cyclic_44,\r\n{ "Node 44 error status", "omron.cyclic_error.node.44", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x10, NULL, HFILL }},\r\n{ &hf_omron_cyclic_43,\r\n{ "Node 43 error status", "omron.cyclic_error.node.43", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x08, NULL, HFILL }},\r\n{ &hf_omron_cyclic_42,\r\n{ "Node 42 error status", "omron.cyclic_error.node.42", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x04, NULL, HFILL }},\r\n{ &hf_omron_cyclic_41,\r\n{ "Node 41 error status", "omron.cyclic_error.node.41", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x02, NULL, HFILL }},\r\n{ &hf_omron_cyclic_40,\r\n{ "Node 40 error status", "omron.cyclic_error.node.40", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x01, NULL, HFILL }},\r\n{ &hf_omron_cyclic_label_7,\r\n{ "Nodes 48-55", "omron.cyclic_error_status", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_cyclic_55,\r\n{ "Node 55 error status", "omron.cyclic_error.node.55", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x80, NULL, HFILL }},\r\n{ &hf_omron_cyclic_54,\r\n{ "Node 54 error status", "omron.cyclic_error.node.54", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x40, NULL, HFILL }},\r\n{ &hf_omron_cyclic_53,\r\n{ "Node 53 error status", "omron.cyclic_error.node.53", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x20, NULL, HFILL }},\r\n{ &hf_omron_cyclic_52,\r\n{ "Node 52 error status", "omron.cyclic_error.node.52", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x10, NULL, HFILL }},\r\n{ &hf_omron_cyclic_51,\r\n{ "Node 51 error status", "omron.cyclic_error.node.51", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x08, NULL, HFILL }},\r\n{ &hf_omron_cyclic_50,\r\n{ "Node 50 error status", "omron.cyclic_error.node.50", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x04, NULL, HFILL }},\r\n{ &hf_omron_cyclic_49,\r\n{ "Node 49 error status", "omron.cyclic_error.node.49", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x02, NULL, HFILL }},\r\n{ &hf_omron_cyclic_48,\r\n{ "Node 48 error status", "omron.cyclic_error.node.48", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x01, NULL, HFILL }},\r\n{ &hf_omron_cyclic_label_8,\r\n{ "Nodes 56-62", "omron.cyclic_error_status", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_omron_cyclic_62,\r\n{ "Node 62 error status", "omron.cyclic_error.node.62", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x40, NULL, HFILL }},\r\n{ &hf_omron_cyclic_61,\r\n{ "Node 61 error status", "omron.cyclic_error.node.61", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x20, NULL, HFILL }},\r\n{ &hf_omron_cyclic_60,\r\n{ "Node 60 error status", "omron.cyclic_error.node.60", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x10, NULL, HFILL }},\r\n{ &hf_omron_cyclic_59,\r\n{ "Node 59 error status", "omron.cyclic_error.node.59", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x08, NULL, HFILL }},\r\n{ &hf_omron_cyclic_58,\r\n{ "Node 58 error status", "omron.cyclic_error.node.58", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x04, NULL, HFILL }},\r\n{ &hf_omron_cyclic_57,\r\n{ "Node 57 error status", "omron.cyclic_error.node.57", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x02, NULL, HFILL }},\r\n{ &hf_omron_cyclic_56,\r\n{ "Node 56 error status", "omron.cyclic_error.node.56", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x01, NULL, HFILL }},\r\n{ &hf_omron_node_error_count,\r\n{ "Node error count", "omron.node_error_count", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }}\r\n};\r\nstatic gint *ett[] = {\r\n&ett_omron,\r\n&ett_omron_header,\r\n&ett_omron_icf_fields,\r\n&ett_omron_command_data,\r\n&ett_area_data,\r\n&ett_cpu_bus,\r\n&ett_io_data,\r\n&ett_pc_status_fields,\r\n&ett_fatal_fields,\r\n&ett_non_fatal_fields,\r\n&ett_message_fields,\r\n&ett_omron_error_log_data,\r\n&ett_omron_disk_data,\r\n&ett_omron_file_data,\r\n&ett_omron_data_type,\r\n&ett_omron_block_record,\r\n&ett_omron_status_block,\r\n&ett_omron_cyclic_fields,\r\n&ett_omron_netw_nodes_sts,\r\n&ett_omron_netw_node_sts,\r\n&ett_omron_netw_nodes_non_fatal_err_sts,\r\n&ett_omron_netw_nodes_cyclic_err_ctrs,\r\n&ett_omron_data_link_status_tree,\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_omron_command_code, { "omron.command.unknown", PI_UNDECODED, PI_WARN, "Unknown Command-Code", EXPFILL }},\r\n{ &ei_oomron_command_memory_area_code, { "omron.memory.area.read.unknown", PI_UNDECODED, PI_WARN, "Unknown Memory-Area-Code (%u)", EXPFILL }},\r\n{ &ei_omron_bad_length, { "omron.bad_length", PI_MALFORMED, PI_WARN, "Unexpected Length", EXPFILL }},\r\n};\r\nexpert_module_t* expert_omron_fins;\r\nproto_omron_fins = proto_register_protocol (\r\n"OMRON FINS Protocol",\r\n"OMRON-FINS",\r\n"omron"\r\n);\r\nproto_register_field_array(proto_omron_fins, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_omron_fins = expert_register_protocol(proto_omron_fins);\r\nexpert_register_field_array(expert_omron_fins, ei, array_length(ei));\r\n#if 0\r\nomron_fins_module = prefs_register_protocol(proto_omron_fins, NULL);\r\nprefs_register_bool_preference(omron_fins_module, "show_hex",\r\n"Display numbers in Hex",\r\n"Enable to display numerical values in hexadecimal.",\r\n&gPREF_HEX);\r\n#endif\r\n}\r\nvoid\r\nproto_reg_handoff_omron_fins(void)\r\n{\r\ndissector_handle_t omron_fins_handle;\r\nomron_fins_handle = create_dissector_handle(dissect_omron_fins, proto_omron_fins);\r\ndissector_add_uint("udp.port", OMRON_FINS_UDP_PORT, omron_fins_handle);\r\n}
