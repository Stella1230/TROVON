static void\r\nOperationalStatus_funk(tvbuff_t* tvb, packet_info *pinfo, proto_tree* tree, gint* offset)\r\n{\r\nguint32 value;\r\nproto_item* ti;\r\nvalue = tvb_get_ntohl(tvb, *offset);\r\nti = proto_tree_add_item(tree, hf_ged125_OperationalStatus, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\nif (value == 0)\r\nexpert_add_info(pinfo, ti, &ei_ged125_OperationalStatus_normal);\r\nelse if (value <= 31 && value >0)\r\nexpert_add_info(pinfo, ti, &ei_ged125_OperationalStatus_loss_redundant_component);\r\nelse if (value <= 63 && value >= 32 )\r\nexpert_add_info(pinfo, ti, &ei_ged125_OperationalStatus_degraded_call_processing);\r\nelse if (value <= 127 && value >= 64 )\r\nexpert_add_info(pinfo, ti, &ei_ged125_OperationalStatus_conditions_prevent_call);\r\nelse if (value > 127)\r\nexpert_add_info(pinfo, ti, &ei_ged125_OperationalStatus_invalid_message);\r\n*offset += 4;\r\n}\r\nstatic void\r\nStatusVariable_funk(tvbuff_t* tvb, proto_tree* tree, gint* offset, const gint size)\r\n{\r\nwhile(*offset+4 <= size)\r\n{\r\nproto_tree_add_item(tree, hf_ged125_StatusVariable, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\n}\r\n}\r\nstatic void\r\ntrunk_funk_without_status(tvbuff_t* tvb, proto_tree* z_tree, gint* offset, const gint size)\r\n{\r\ngint count = 0;\r\nwhile(*offset+2 <= size && count < 1024)\r\n{\r\nproto_tree_add_item(z_tree, hf_ged125_TrunkNumber, tvb, *offset, 2, ENC_BIG_ENDIAN);\r\n*offset += 2;\r\ncount++;\r\n}\r\n}\r\nstatic void\r\ntrunk_funk(tvbuff_t* tvb, proto_tree* tree, gint* offset, const gint size)\r\n{\r\nguint16 count = 0;\r\nwhile(*offset+4 <= size && count < 1024) {\r\nproto_tree_add_item(tree, hf_ged125_TrunkNumber, tvb, *offset, 2, ENC_BIG_ENDIAN);\r\n*offset += 2;\r\nproto_tree_add_item(tree, hf_ged125_TrunkStatus, tvb, *offset, 2, ENC_BIG_ENDIAN);\r\n*offset += 2;\r\ncount++;\r\n}\r\n}\r\nstatic void\r\nMedia_Specifier_dissect(tvbuff_t* tvb, proto_tree* tree, gint* offset, guint32 length)\r\n{\r\nguint8 media_protocol;\r\nmedia_protocol = tvb_get_guint8(tvb, *offset);\r\nproto_tree_add_item(tree, hf_ged125_floating_media_protocol, tvb, *offset, 1, ENC_BIG_ENDIAN);\r\n*offset += 1;\r\nswitch (media_protocol)\r\n{\r\ncase 'H':\r\ncase 'S':\r\ncase 'O':\r\ncase 'F':\r\nproto_tree_add_item(tree, hf_ged125_floating_library_designator, tvb, *offset, 1, ENC_BIG_ENDIAN);\r\n*offset += 1;\r\nproto_tree_add_item(tree, hf_ged125_floating_payload_strg, tvb, *offset, length - 2, ENC_NA|ENC_ASCII);\r\nbreak;\r\ncase 'T':\r\nproto_tree_add_item(tree, hf_ged125_floating_payload_strg, tvb, *offset, length - 1, ENC_NA|ENC_ASCII);\r\nbreak;\r\ncase 'D':\r\nproto_tree_add_item(tree, hf_ged125_Data_Playback_Type, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(tree, hf_ged125_Data_Playback_Formats, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(tree, hf_ged125_floating_payload_strg, tvb, *offset, length - 9, ENC_NA|ENC_ASCII);\r\nbreak;\r\n}\r\n*offset += length;\r\n}\r\nstatic void\r\nfloating_fields(tvbuff_t* tvb, packet_info *pinfo, proto_tree* tree, gint offset, const gint size)\r\n{\r\ngint32 length = 4;\r\nguint32 floating_type;\r\nproto_tree *ged125_tree, *float_tree;\r\nproto_item *ti;\r\nif (size - offset > 0)\r\nlength = size - offset;\r\nged125_tree = proto_tree_add_subtree(tree, tvb, offset, length, ett_ged125_floating, NULL, "Float Message");\r\nwhile (offset < size-2)\r\n{\r\nfloating_type = tvb_get_guint8(tvb, offset);\r\nti = proto_tree_add_uint_format(ged125_tree, hf_ged125_floating, tvb, offset, 1,\r\nfloating_type, "%s", val_to_str(floating_type,\r\nvals_floating_point_types, "Unknown %d"));\r\nfloat_tree = proto_item_add_subtree(ti, ett_ged125_float_field);\r\noffset += 1;\r\nlength = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_uint(float_tree, hf_ged125_length, tvb, offset, 1, length);\r\noffset += 1;\r\nif ((offset + length > size) && (length > 0))\r\n{\r\nexpert_add_info(pinfo, ti, &ei_ged125_length_bad);\r\nbreak;\r\n}\r\nswitch (floating_type)\r\n{\r\ncase 42:\r\ncase 43:\r\nproto_tree_add_item(float_tree, hf_ged125_floating_payload_ECC_tag, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nif (length-4 > 0)\r\n{\r\nproto_tree_add_item(float_tree, hf_ged125_floating_payload_strg, tvb, offset, length-4, ENC_NA|ENC_ASCII);\r\noffset += (length-4);\r\n}\r\nbreak;\r\ncase 44:\r\nproto_tree_add_item(float_tree, hf_ged125_floating_payload_ECC_tag, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(float_tree, hf_ged125_floating_uchar_array_index, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nif (length-5 > 0)\r\n{\r\nproto_tree_add_item(float_tree, hf_ged125_floating_payload_strg, tvb, offset, length-4, ENC_NA|ENC_ASCII);\r\noffset += (length-5);\r\n}\r\nbreak;\r\ncase 47:\r\ncase 48:\r\ncase 49:\r\ncase 50:\r\nMedia_Specifier_dissect(tvb, float_tree, &offset, length);\r\nbreak;\r\ncase 19:\r\nproto_tree_add_item(float_tree, hf_ged125_floating_payload_unspec, tvb, offset, length, ENC_NA);\r\noffset += length;\r\nbreak;\r\ncase 1:\r\ncase 18:\r\ncase 20: case 21: case 22: case 23: case 24: case 25: case 26: case 27:\r\ncase 28: case 29: case 30: case 31: case 32: case 33: case 34:\r\ncase 37: case 38: case 39: case 40:\r\ncase 51: case 52: case 53: case 54: case 55: case 56: case 57: case 58:\r\nproto_tree_add_item(float_tree, hf_ged125_floating_payload_strg, tvb, offset, length, ENC_NA|ENC_ASCII);\r\noffset += length;\r\nbreak;\r\ncase 35:\r\ncase 36:\r\nproto_tree_add_item(float_tree, hf_ged125_floating_payload_uint, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += length;\r\nbreak;\r\ncase 41:\r\nproto_tree_add_item(float_tree, hf_ged125_floating_cause_code, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += length;\r\nbreak;\r\ncase 45:\r\ncase 46:\r\nproto_tree_add_item(float_tree, hf_ged125_floating_payload_bool, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += length;\r\nbreak;\r\n}\r\n}\r\n}\r\nstatic void\r\nservice_control_dissect(tvbuff_t* tvb,proto_tree* msg_tree, proto_tree* ged125_tree, packet_info* pinfo,\r\ngint* offset, const gint size)\r\n{\r\nproto_item *ti;\r\nproto_tree *service_tree, *data_tree;\r\nguint32 mess_type, DialogueID, SendSeqNo;\r\nservice_tree = proto_tree_add_subtree(msg_tree, tvb, *offset, 12,\r\nett_ged125_service_control_header, NULL, "Service-Control Header");\r\nmess_type = tvb_get_ntohl(tvb, *offset);\r\n*offset += 4;\r\nDialogueID = tvb_get_ntohl(tvb, *offset);\r\nproto_tree_add_item(service_tree, hf_ged125_DialogueID_num, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "Service_Control->%s DIALOGUE_ID=%u LEN=%u",\r\nval_to_str(mess_type, vals_service_control_message_subvalues, "Unknown %d"), DialogueID, size);\r\nSendSeqNo = tvb_get_ntohl(tvb, *offset);\r\nti = proto_tree_add_item(service_tree, hf_ged125_SendSeqNo_num, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nif ((DialogueID != SendSeqNo) &&\r\n((DialogueID == 0xFFFFFFFF) || (SendSeqNo == 0xFFFFFFFF)))\r\nexpert_add_info(pinfo, ti, &ei_ged125_sendseqno_and_dialogueid);\r\nti = proto_tree_add_uint(service_tree, hf_ged125_service_control_value,\r\ntvb, *offset-12, 4, mess_type);\r\ndata_tree = proto_item_add_subtree(ti, ett_ged125_service_control_data);\r\nswitch (mess_type)\r\n{\r\ncase GED125_INIT_SERVICE_CTRL_REQ_VALUE:\r\ncase GED125_INIT_SERVICE_CTRL_CONF_VALUE:\r\ncase GED125_INIT_SERVICE_CTRL_END_VALUE:\r\nproto_tree_add_item(data_tree, hf_ged125_InvokeID, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nbreak;\r\ncase GED125_INIT_SERVICE_CTRL_DATA_VALUE:\r\nproto_tree_add_item(data_tree, hf_ged125_InvokeID, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_ServiceFeatures, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nbreak;\r\ncase GED125_NEW_CALL_VALUE:\r\ncase GED125_REQUEST_INSTRUCTION_VALUE:\r\nproto_tree_add_item(data_tree, hf_ged125_TrunkGroupID, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_TrunkNumber, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_ServiceID, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nfloating_fields(tvb, pinfo, ged125_tree, *offset, size);\r\nbreak;\r\ncase GED125_RUN_SCRIPT_REQ_VALUE:\r\nproto_tree_add_item(data_tree, hf_ged125_InvokeID, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nfloating_fields(tvb, pinfo, ged125_tree, *offset, size);\r\nbreak;\r\ncase GED125_RUN_SCRIPT_RESULT_VALUE:\r\nproto_tree_add_item(data_tree, hf_ged125_InvokeID, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_ResultCode, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nfloating_fields(tvb, pinfo, ged125_tree, *offset, size);\r\nbreak;\r\ncase GED125_CONNECT_VALUE:\r\nproto_tree_add_item(data_tree, hf_ged125_LabelType, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nfloating_fields(tvb, pinfo, ged125_tree, *offset, size);\r\nbreak;\r\ncase GED125_EVENT_REPORT_VALUE:\r\nproto_tree_add_item(data_tree, hf_ged125_EventID, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nfloating_fields(tvb, pinfo, ged125_tree, *offset, size);\r\nbreak;\r\ncase GED125_DIALOGUE_FAILURE_CONF_VALUE:\r\nproto_tree_add_item(data_tree, hf_ged125_InvokeID, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_ErrorCode, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nbreak;\r\ncase GED125_DIALOGUE_FAILURE_EVENT_VALUE:\r\nproto_tree_add_item(data_tree, hf_ged125_ErrorCode, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nbreak;\r\ncase GED125_INIT_SERVICE_CTRL_TRKGRP_VALUE:\r\nproto_tree_add_item(data_tree, hf_ged125_InvokeID, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_TrunkGroupID, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_TrunkCount, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\ntrunk_funk(tvb, data_tree, offset, size);\r\nbreak;\r\ncase GED125_INIT_SERVICE_CTRL_SERVICE_VALUE:\r\nproto_tree_add_item(data_tree, hf_ged125_InvokeID, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_ServiceID, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_AvailableNow, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_CallsInNow, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_CallsOutNow, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nbreak;\r\ncase GED125_INIT_SERVICE_CTRL_VRU_VALUE:\r\nproto_tree_add_item(data_tree, hf_ged125_InvokeID, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_CurrentTime_num, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_TimeZoneDelta, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nOperationalStatus_funk(tvb, pinfo, data_tree, offset);\r\nStatusVariable_funk(tvb, data_tree, offset, size);\r\nbreak;\r\ncase GED125_TRKGRP_STATUS_VALUE:\r\nproto_tree_add_item(data_tree, hf_ged125_TrunkGroupID, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_TrunkCount, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\ntrunk_funk(tvb, data_tree, offset, size);\r\nbreak;\r\ncase GED125_SERVICE_STATUS_VALUE:\r\nproto_tree_add_item(data_tree, hf_ged125_ServiceID, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_ServiceAvailable, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nbreak;\r\ncase GED125_VRU_STATUS_VALUE:\r\nproto_tree_add_item(data_tree, hf_ged125_CurrentTime_num, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_TimeZoneDelta, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nOperationalStatus_funk(tvb, pinfo, data_tree, offset);\r\nStatusVariable_funk(tvb, data_tree, offset, size);\r\nbreak;\r\ncase GED125_CANCEL_VALUE:\r\nproto_tree_add_item(data_tree, hf_ged125_InvokeID, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_RequestID, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nbreak;\r\ncase GED125_RELEASE_VALUE:\r\nproto_tree_add_item(data_tree, hf_ged125_Cause_just_for_release_message, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nbreak;\r\ncase GED125_NEW_DIALOGUE_VALUE:\r\nproto_tree_add_item(data_tree, hf_ged125_CallID, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_ServiceID, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nfloating_fields(tvb, pinfo, ged125_tree, *offset, size);\r\nbreak;\r\ncase GED125_CONNECT_TO_RESOURCE_VALUE:\r\ncase GED125_MICROAPP_CONTEXT_VALUE:\r\ncase GED125_TEMPORARY_CONNECT_VALUE:\r\nfloating_fields(tvb, pinfo, ged125_tree, *offset, size);\r\nbreak;\r\ncase GED125_RESOURCE_CONNECTED_VALUE:\r\nbreak;\r\ncase GED125_MICROAPP_PLAY_VALUE:\r\nproto_tree_add_item(data_tree, hf_ged125_InvokeID, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_ToBeContinued, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_Barge_In_Allowed, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nfloating_fields(tvb, pinfo, ged125_tree, *offset, size);\r\nbreak;\r\ncase GED125_MICROAPP_PLAY_CONTINUE_VALUE:\r\nproto_tree_add_item(data_tree, hf_ged125_InvokeID, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_ToBeContinued, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nfloating_fields(tvb, pinfo, ged125_tree, *offset, size);\r\nbreak;\r\ncase GED125_MICROAPP_COLLECT_DATA_VALUE:\r\nproto_tree_add_item(data_tree, hf_ged125_InvokeID, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_DTMF_Termination_Key, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_No_Entry_Timeout, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_Interdigit_Timeout, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_Number_of_No_Entry_Tries, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_Number_of_Invalid_Entry_Tries, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_Min_Length, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_Max_Length, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_Barge_In_Allowed, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_ASR_Allowed, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nfloating_fields(tvb, pinfo, ged125_tree, *offset, size);\r\nbreak;\r\ncase GED125_MICROAPP_MENU_VALUE:\r\nproto_tree_add_item(data_tree, hf_ged125_InvokeID, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_No_Entry_Timeout, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_Number_of_No_Entry_Tries, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_Number_of_Invalid_Entry_Tries, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_DTMF_Menu_Keys, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_Barge_In_Allowed, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_ASR_Allowed, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nfloating_fields(tvb, pinfo, ged125_tree, *offset, size);\r\nbreak;\r\ncase GED125_MICROAPP_RESULT_VALUE:\r\nproto_tree_add_item(data_tree, hf_ged125_InvokeID, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nproto_tree_add_item(data_tree, hf_ged125_Microapp_Error_Code, tvb, *offset, 4, ENC_BIG_ENDIAN);\r\n*offset += 4;\r\nfloating_fields(tvb, pinfo, ged125_tree, *offset, size);\r\nbreak;\r\ndefault:\r\nexpert_add_info(pinfo, ti, &ei_ged125_service_control_value_unknown);\r\n}\r\n}\r\nstatic guint\r\nget_ged125_pdu_len(packet_info *pinfo _U_, tvbuff_t *tvb,\r\nint offset _U_, void *data _U_)\r\n{\r\nreturn tvb_get_ntohl(tvb, 0) + 8;\r\n}\r\nstatic int\r\ndissect_ged125_base_messages(tvbuff_t* tvb, packet_info* pinfo, proto_tree* tree, void* data _U_)\r\n{\r\ngint size = tvb_reported_length(tvb);\r\nproto_item *ti, *message_item;\r\nproto_tree *ged125_tree, *ged125_header_tree, *ged125_message_tree;\r\ngint offset = 8;\r\nguint32 value,\r\nmessage_type = tvb_get_ntohl(tvb, 4);\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "GED125");\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "%s %u bytes",\r\nval_to_str(message_type, base_message_values, "Unknown %d"), size);\r\nti = proto_tree_add_item(tree, proto_ged125, tvb, 0, -1, ENC_NA);\r\nged125_tree = proto_item_add_subtree( ti, ett_ged125);\r\nged125_header_tree = proto_tree_add_subtree(ged125_tree, tvb, 0, 8, ett_ged125_header, NULL, "GED125 Header");\r\nproto_tree_add_item(ged125_header_tree, hf_ged125_length, tvb, 0, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ged125_header_tree, hf_ged125_value, tvb, 4, 4, ENC_BIG_ENDIAN);\r\nged125_message_tree = proto_tree_add_subtree(ged125_tree, tvb, offset, -1, ett_ged125_message, &message_item, "GED125 Message");\r\nswitch (message_type)\r\n{\r\ncase GED125_FAILURE_CONF_VALUE:\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_InvokeID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_Status, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nbreak;\r\ncase GED125_FAILURE_EVENT_VALUE:\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_Status, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nbreak;\r\ncase GED125_OPEN_REQ_VALUE:\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_InvokeID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_VersionNumber, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_IdleTimeout, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nbreak;\r\ncase GED125_OPEN_CONF_VALUE:\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_InvokeID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_UseEventFeed, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_UsePolledFeed, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_UseCallRouting, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_UseTimeSynch, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_UseServiceControl, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nbreak;\r\ncase GED125_HEARTBEAT_REQ_VALUE:\r\ncase GED125_HEARTBEAT_CONF_VALUE:\r\ncase GED125_CLOSE_CONF_VALUE:\r\ncase GED125_INIT_DATA_REQ_VALUE:\r\ncase GED125_INIT_DATA_CONF_VALUE:\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_InvokeID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nbreak;\r\ncase GED125_CLOSE_REQ_VALUE:\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_InvokeID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_Status, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nfloating_fields(tvb, pinfo, ged125_tree, offset, size);\r\nbreak;\r\ncase GED125_INIT_TRKGRP_DATA_EVENT_VALUE:\r\nvalue = tvb_get_ntohl(tvb, offset);\r\nti = proto_tree_add_item(ged125_message_tree, hf_ged125_InvokeID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nif (value > 65535)\r\nexpert_add_info(pinfo, ti, &ei_ged125_trunk_group_id);\r\nvalue = tvb_get_ntohl(tvb, offset);\r\nti = proto_tree_add_item(ged125_message_tree, hf_ged125_TrunkCount, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nif (value > 1023)\r\nexpert_add_info(pinfo, ti, &ei_ged125_TrunkCount_invalid);\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_CallsInToday, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_CallsOutToday, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_InServiceTimeToday, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_InUseInboundTimeToday, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_InUseOutboundTimeToday, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_AllTrunksInUseTimeToday, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\ntrunk_funk(tvb, ged125_message_tree, &offset, size);\r\nbreak;\r\ncase GED125_INIT_SERVICE_DATA_EVENT_VALUE:\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_InvokeID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_ServiceID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_AvailableNow, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_CallsInNow, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_CallsOutNow, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_CallsInToday, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_CallsOutToday, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_CallsHandledToday, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_HandleTimeToday, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_DivertedInToday, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_DivertedOutToday, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nbreak;\r\ncase GED125_INIT_VRU_DATA_EVENT_VALUE:\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_InvokeID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_TimeZoneDelta, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nOperationalStatus_funk(tvb, pinfo, ged125_message_tree, &offset);\r\nStatusVariable_funk(tvb, ged125_message_tree, &offset, size);\r\nbreak;\r\ncase GED125_INIT_DATA_END_EVENT_VALUE:\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_InvokeID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_InitDataTime, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_StartOfDay, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nbreak;\r\ncase GED125_DELIVERED_EVENT_VALUE:\r\ncase GED125_ORIGINATED_EVENT_VALUE:\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_CallID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_TrunkGroupID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_TrunkNumber, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_ServiceID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nfloating_fields(tvb, pinfo, ged125_tree, offset, size);\r\nbreak;\r\ncase GED125_CALL_CLEARED_EVENT_VALUE:\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_CallID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_floating_CauseCode, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nfloating_fields(tvb, pinfo, ged125_tree, offset, size);\r\nbreak;\r\ncase GED125_CONFERENCED_EVENT_VALUE:\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_ConferenceCallID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_PrimaryCallID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_SecondaryCallID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_ServiceID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nbreak;\r\ncase GED125_DIVERTED_EVENT_VALUE:\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_CallID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_NewServiceID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nbreak;\r\ncase GED125_NEW_TRANSACTION_EVENT_VALUE:\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_CallID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_NewCallID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_ServiceID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nbreak;\r\ncase GED125_SET_CALL_VARIABLES_EVENT_VALUE:\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_CallID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nfloating_fields(tvb, pinfo, ged125_tree, offset, size);\r\nbreak;\r\ncase GED125_VRU_STATUS_EVENT_VALUE:\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_CurrentTime_num, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_TimeZoneDelta, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nOperationalStatus_funk(tvb, pinfo, ged125_message_tree, &offset);\r\nStatusVariable_funk(tvb, ged125_message_tree, &offset, size);\r\nbreak;\r\ncase GED125_TRKGRP_STATUS_EVENT_VALUE:\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_TrunkGroupID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nvalue = tvb_get_ntohl(tvb, offset);\r\nti = proto_tree_add_item(ged125_message_tree, hf_ged125_TrunkCount, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nif (value > 1023)\r\nexpert_add_info(pinfo, ti, &ei_ged125_TrunkCount_invalid);\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_InService, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\ntrunk_funk_without_status(tvb, ged125_message_tree, &offset, size);\r\nbreak;\r\ncase GED125_SERVICE_STATUS_EVENT_VALUE:\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_ServiceID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_ServiceAvailable, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nbreak;\r\ncase GED125_ROUTE_REQUEST_EVENT_VALUE:\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_CrossRefID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_CallID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nfloating_fields(tvb, pinfo, ged125_tree, offset, size);\r\nreturn tvb_captured_length(tvb);\r\ncase GED125_ROUTE_SELECT_VALUE:\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_CrossRefID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_LabelType, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nfloating_fields(tvb, pinfo, ged125_tree, offset, size);\r\nbreak;\r\ncase GED125_ROUTE_END_EVENT_VALUE:\r\ncase GED125_ROUTE_END_VALUE:\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_CrossRefID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_Status, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nbreak;\r\ncase GED125_TIME_SYNCH_REQ_VALUE:\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_InvokeID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_VRUTimeLag, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nbreak;\r\ncase GED125_TIME_SYNCH_CONF_VALUE:\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_InvokeID, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nbreak;\r\ncase GED125_SERVICE_CONTROL_VALUE:\r\nservice_control_dissect(tvb, ged125_message_tree, ged125_tree, pinfo, &offset, size);\r\nbreak;\r\ncase GED125_SIMULATOR_RESET_EVENT_VALUE:\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_simulator_reset_event, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GED125_REGISTER_VARIABLES_VALUE:\r\nproto_tree_add_item(ged125_message_tree, hf_ged125_CallVarsMask, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nfloating_fields(tvb, pinfo, ged125_tree, offset, size);\r\nbreak;\r\n}\r\nproto_item_set_len(message_item, offset-8);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic int\r\ndissect_ged125(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data)\r\n{\r\ngint size;\r\nguint32 message_type;\r\nsize = tvb_captured_length(tvb);\r\nif (size < 12)\r\nreturn 0;\r\nmessage_type = tvb_get_ntohl(tvb, 4);\r\nif (try_val_to_str(message_type, base_message_values) == NULL)\r\nreturn 0;\r\ntcp_dissect_pdus(tvb, pinfo, tree, ged125_desegment_body, 4,\r\nget_ged125_pdu_len, dissect_ged125_base_messages, data);\r\nreturn size;\r\n}\r\nvoid\r\nproto_register_ged125 (void)\r\n{\r\nmodule_t* ged125_module;\r\nstatic hf_register_info hf[] = {\r\n{ &hf_ged125_length,\r\n{ "Package Length", "ged125.len",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_ged125_value,\r\n{ "Message value", "ged125.value",\r\nFT_UINT32, BASE_DEC, VALS(base_message_values), 0x0, NULL, HFILL }},\r\n{ &hf_ged125_service_control_value,\r\n{ "Sub-Service Control Message value", "ged125.service_control",\r\nFT_UINT32, BASE_DEC, VALS(vals_service_control_message_subvalues),\r\n0x0, NULL, HFILL }},\r\n{ &hf_ged125_DialogueID_num,\r\n{ "Dialogue Id", "ged125.dialogue_id",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_ged125_SendSeqNo_num,\r\n{ "SendSeqNo", "ged125.send_seq_no",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Send sequence for the sent message", HFILL }},\r\n{ &hf_ged125_CurrentTime_num,\r\n{ "Current Time", "ged125.current_time",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"The current UTC time (VRU clock)", HFILL }},\r\n{ &hf_ged125_TimeZoneDelta,\r\n{ "Time Zone Delta", "ged125.time_zone_delta",\r\nFT_INT32, BASE_DEC,NULL, 0x0,\r\n"The current local time zone delta, expressed in seconds."\r\n"This value is added to a UTC time to form a time in the local time zone",\r\nHFILL }},\r\n{ &hf_ged125_OperationalStatus,\r\n{ "Operational Status", "ged125.operational_status",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Operational Status of the VRU", HFILL }},\r\n{ &hf_ged125_StatusVariable,\r\n{ "Status Variable", "ged125.status_variable",\r\nFT_INT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_ged125_InvokeID,\r\n{ "Invoke ID", "ged125.invoke_id",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Same as the corresponding req. mess", HFILL }},\r\n{ &hf_ged125_Status,\r\n{ "Status", "ged125.status",\r\nFT_UINT32, BASE_DEC, VALS(error_codes), 0x0,\r\n"Status: Indicates cause of failure", HFILL }},\r\n{ &hf_ged125_VersionNumber,\r\n{ "Version Number", "ged125.version_number",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Interface number requested by the Peripheral Gateway,"\r\n"defines the version of all messages in the message set", HFILL }},\r\n{ &hf_ged125_IdleTimeout,\r\n{ "Idle Timeout (ms)", "ged125.idle_timeout",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_ged125_floating_CauseCode,\r\n{ "Cause code", "ged125.cause_code",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_ged125_UseEventFeed,\r\n{ "Use Event Feed", "ged125.use_event_feed",\r\nFT_BOOLEAN, 32, NULL, 0x01,\r\n"Indicates if the VRU supports the Event Data Feed", HFILL }},\r\n{ &hf_ged125_UsePolledFeed,\r\n{ "Use Polled Feed", "ged125.use_polled_feed",\r\nFT_BOOLEAN, 32, NULL, 0x01,\r\n"Indicates if the VRU supports the Polled Data Feed.", HFILL }},\r\n{ &hf_ged125_UseCallRouting,\r\n{ "Use Call Routing", "ged125.use_call_routing",\r\nFT_BOOLEAN, 32, NULL, 0x01,\r\n"Indicates if the VRU supports the Call Routing Interface", HFILL }},\r\n{ &hf_ged125_UseTimeSynch,\r\n{ "Use Time Synch", "ged125.use_time_synch",\r\nFT_BOOLEAN, 32, NULL, 0x01,\r\n"Indicates if the VRU supports the Time Synchronization Interface", HFILL }},\r\n{ &hf_ged125_UseServiceControl,\r\n{ "Use Service Control", "ged125.use_service_control",\r\nFT_BOOLEAN, 32, NULL, 0x01,\r\n"Indicates if the VRU supports the Service Control Interface", HFILL }},\r\n{ &hf_ged125_TrunkGroupID,\r\n{ "Trunk Group ID", "ged125.trunk_group_id",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"An ID assigned by the VRU to this trunk group, in the range 0 to 65535", HFILL }},\r\n{ &hf_ged125_TrunkCount,\r\n{ "Trunk Count", "ged125.trunk_count",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"The number of trunks configured in this message. TrunkCount may not exceed 1024", HFILL }},\r\n{ &hf_ged125_CallsInToday,\r\n{ "Calls In Today", "ged125.calls_in_today",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"The cumulative number of inbound calls that have arrived on the trunk group this day", HFILL }},\r\n{ &hf_ged125_CallsOutToday,\r\n{ "Calls Out Today", "ged125.call_out_today",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"The cumulative number of outbound calls that have been placed on the trunk group this day", HFILL }},\r\n{ &hf_ged125_InServiceTimeToday,\r\n{ "In Service Time Today", "ged125.in_service_time_today",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"The cumulative amount of time (sec) that trunks in the trunk group "\r\n"have been in service this day", HFILL }},\r\n{ &hf_ged125_InUseInboundTimeToday,\r\n{ "In Use Inbound Time Today", "ged125.in_use_inbound_time_today",\r\nFT_UINT32, BASE_DEC,NULL, 0x0,\r\n"The cumulative amount of time (sec) that trunks in the trunk group "\r\n"have been in use on incoming calls this day", HFILL }},\r\n{ &hf_ged125_InUseOutboundTimeToday,\r\n{ "In Use Outbound Time Today", "ged125.in_use_outbound_time_today",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"The cumulative amount of time (sec) that trunks in the trunk group "\r\n"have been in use on outgoing calls this day", HFILL }},\r\n{ &hf_ged125_AllTrunksInUseTimeToday,\r\n{ "All Trunks In Use Time Today", "ged125.all_trunks_in_use_time_today",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"The cumulative amount of time (sec) that all trunks in the trunk group "\r\n"were simultaneously busy this day", HFILL }},\r\n{ &hf_ged125_TrunkNumber,\r\n{ "Trunk Number", "ged125.trunk_number",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_ged125_TrunkStatus,\r\n{ "Trunk Status", "ged125.trunk_status",\r\nFT_UINT16, BASE_DEC, VALS(status_code_trunk_status), 0x0, NULL, HFILL }},\r\n{ &hf_ged125_ServiceID,\r\n{ "Service ID", "ged125.service_id",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"An ID assigned by the VRU to this service", HFILL }},\r\n{ &hf_ged125_AvailableNow,\r\n{ "Available Now", "ged125.available_now",\r\nFT_BOOLEAN, 32, NULL, 0x01,\r\n"Current availability of the service", HFILL }},\r\n{ &hf_ged125_CallsInNow,\r\n{ "Call In Now", "ged125.call_in_now",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"The number of inbound calls currently in progress on the service.", HFILL }},\r\n{ &hf_ged125_CallsOutNow,\r\n{ "Call Out Now", "ged125.call_out_now",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"The number of outbound calls currently in progress on the service", HFILL }},\r\n{ &hf_ged125_CallsHandledToday,\r\n{ "Calls Handled Today", "ged125.call_handled_today",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"The cumulative number of calls handled on the service this day", HFILL }},\r\n{ &hf_ged125_HandleTimeToday,\r\n{ "Handle Time Today", "ged125.handle_time_today",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"The cumulative amount of time (secs) spent handling calls on the service this day", HFILL }},\r\n{ &hf_ged125_DivertedInToday,\r\n{ "Diverted In Today", "ged125.diverted_in_today",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"The cumulative number of calls diverted from another service to this service this day", HFILL }},\r\n{ &hf_ged125_DivertedOutToday,\r\n{ "Diverted Out Today", "ged125.diverted_out_today",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"The cumulative number of calls diverted from this service to another service this day", HFILL }},\r\n{ &hf_ged125_InitDataTime,\r\n{ "Init Data Time", "ged125.init_data_time",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"The UTC time at which the initial snapshot was taken", HFILL }},\r\n{ &hf_ged125_StartOfDay,\r\n{ "Start Of Day", "ged125.start_of_day",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Corresponds to midnight local time at the VRU (UTC). However, this may refer "\r\n"to a different time if the VRU has restarted", HFILL }},\r\n{ &hf_ged125_CallID,\r\n{ "Call ID", "ged125.call_id",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"An ID assigned to the call by the VRU", HFILL }},\r\n{ &hf_ged125_floating,\r\n{ "Field", "ged125.floating_field",\r\nFT_UINT32, BASE_DEC, VALS(vals_floating_point_types), 0x0,\r\n"Shows the type of floating field", HFILL }},\r\n{ &hf_ged125_ServiceFeatures,\r\n{ "Service Features", "ged125.service_features",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\n"A bit mask that is a logical OR of the Service Control features supported by the VRU", HFILL }},\r\n{ &hf_ged125_floating_payload_strg,\r\n{ "Floating Payload", "ged125.floating_payload.strg",\r\nFT_STRING, FT_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_ged125_floating_payload_uint,\r\n{ "Floating Payload", "ged125.floating_payload.uint",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_ged125_floating_payload_bool,\r\n{ "Floating Payload", "ged125.floating_payload.bool",\r\nFT_BOOLEAN, 32, NULL, 0x01, NULL, HFILL }},\r\n{ &hf_ged125_floating_payload_ECC_tag,\r\n{ "ECC VAR Tag", "ged125.ecc_var_tag",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_ged125_ResultCode,\r\n{ "Errors running script", "ged125.result_code",\r\nFT_BOOLEAN, 32, TFS(&tfs_true_false), 0x01, NULL, HFILL }},\r\n{ &hf_ged125_LabelType,\r\n{ "Label Type", "ged125.label_type",\r\nFT_UINT32, BASE_DEC, VALS(status_code_Label_values),0x0,\r\n"The type of the label returned in the following field", HFILL }},\r\n{ &hf_ged125_EventID,\r\n{ "Event ID", "ged125.event_id",\r\nFT_UINT32, BASE_DEC, VALS(status_code_event_reportcodes), 0x0,\r\n"A code that identifies the event detected by the VRU", HFILL }},\r\n{ &hf_ged125_ErrorCode,\r\n{ "Error Code", "ged125.error_code",\r\nFT_UINT32, BASE_DEC, VALS(error_codes), 0x0,\r\n"A status code indicating the cause of the failure", HFILL }},\r\n{ &hf_ged125_Cause_just_for_release_message,\r\n{ "Cause of Release", "ged125.call_release",\r\nFT_UINT32, BASE_DEC, VALS(Cause_just_for_release_message_vals), 0x0,\r\n"The reason the call was released", HFILL }},\r\n{ &hf_ged125_InService,\r\n{ "In Service", "ged125.in_service",\r\nFT_BOOLEAN, 32, NULL, 0x01,\r\n"A flag indicating that the affected trunks have been placed into "\r\n"service (True) or removed from service (False)", HFILL }},\r\n{ &hf_ged125_ServiceAvailable,\r\n{ "Service Available", "ged125.service_available",\r\nFT_BOOLEAN, 32, NULL, 0x01,\r\nNULL, HFILL }},\r\n{ &hf_ged125_RequestID,\r\n{ "Request ID", "ged125.request_id",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"The InvokeID of the previously issued request to be cancelled", HFILL }},\r\n{ &hf_ged125_ToBeContinued,\r\n{ "To Be Continued", "ged125.to_be_continued",\r\nFT_BOOLEAN, 32, NULL, 0x01,\r\n"A flag which indicates whether additional MICROAPP_PLAY_CONTINUE messages will follow", HFILL }},\r\n{ &hf_ged125_Barge_In_Allowed,\r\n{ "Barge In Allowed", "ged125.barge_in_allowed",\r\nFT_BOOLEAN, 32, NULL, 0x01,\r\n"Indicates whether caller is allowed to interrupt playing", HFILL }},\r\n{ &hf_ged125_floating_cause_code,\r\n{ "Call Cleared Code", "ged125.call_cleared_code",\r\nFT_UINT32, BASE_DEC,VALS(vals_status_code_call_cleared), 0x0,\r\n"Termination Call Details", HFILL }},\r\n{ &hf_ged125_DTMF_Termination_Key,\r\n{ "DTMF Termination Key", "ged125.dtmf_termination_key",\r\nFT_UINT32,BASE_DEC, NULL,0x0,\r\n"Terminates a variable length string of DTMF digits "\r\n"(typically # key). The value is a bit map", HFILL }},\r\n{ &hf_ged125_No_Entry_Timeout,\r\n{ "No Entry Timeout", "ged125.no_entry_timeout",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Determines how many seconds a caller is allowed to start entering data", HFILL }},\r\n{ &hf_ged125_Interdigit_Timeout,\r\n{ "Interdigit Timeout", "ged125.interdigit_timeout",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Determines how many seconds the caller is allowed between digits, "\r\n"before the system assumes the caller is finished", HFILL }},\r\n{ &hf_ged125_Number_of_No_Entry_Tries,\r\n{ "Number of No Entry Tries", "ged125.number_of_no_entry_tries",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Number of times VRU should repeat the 'Get data' cycle when the caller "\r\n"doesn't enter any data", HFILL }},\r\n{ &hf_ged125_Number_of_Invalid_Entry_Tries,\r\n{ "Number of Invalid Entry Tries", "ged125.number_of_invalid_entry_tries",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Number of times VRU should repeat the 'Get data' cycle when the "\r\n"caller enters invalid data", HFILL }},\r\n{ &hf_ged125_Min_Length,\r\n{ "Min Length of Digits", "ged125.min_length",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Minimum number of digits expected from the caller", HFILL }},\r\n{ &hf_ged125_Max_Length,\r\n{ "Max Length of Digits", "ged125.max_length",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Maximum number of digits expected from the caller", HFILL }},\r\n{ &hf_ged125_ASR_Allowed,\r\n{ "ASR Allowed", "ged125.asr_allowed",\r\nFT_BOOLEAN, 32, NULL, 0x01,\r\n"Indicates whether Automatic Speech Recognition should be enabled for this request", HFILL }},\r\n{ &hf_ged125_DTMF_Menu_Keys,\r\n{ "DTMF Menu Keys", "ged125.dtmf_menu_keys",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Indicates which keypad keys represent valid menu choices", HFILL }},\r\n{ &hf_ged125_Microapp_Error_Code,\r\n{ "Microapp Error Code", "ged125.microapp_error_code",\r\nFT_UINT32, BASE_DEC,\r\nVALS(status_code_microcapp_error_codes), 0x0, NULL, HFILL }},\r\n{ &hf_ged125_ConferenceCallID,\r\n{ "Conference Call ID", "ged125.conference_call_id",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"An ID assigned to the resultant conference call by the VRU", HFILL }},\r\n{ &hf_ged125_PrimaryCallID,\r\n{ "Primary Call ID", "ged125.primary_call_id",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"The ID of the primary (inbound) call being conferenced", HFILL }},\r\n{ &hf_ged125_SecondaryCallID,\r\n{ "Secondary Call ID", "ged125.secondary_call_id",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"The ID of the secondary (outbound) call being conferenced", HFILL }},\r\n{ &hf_ged125_NewServiceID,\r\n{ "New Service ID", "ged125.new_service_id",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"The ID of the new service to which the call was diverted", HFILL }},\r\n{ &hf_ged125_NewCallID,\r\n{ "New Call ID", "ged125.new_call_id",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_ged125_simulator_reset_event,\r\n{ "Simulator Reset Event", "ged125.simulator_reset_event",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_ged125_CrossRefID,\r\n{ "Cross Reference ID", "ged125.cross_ref_id",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"A cross-reference identifier assigned by the VRU to this call routing dialogue", HFILL }},\r\n{ &hf_ged125_VRUTimeLag,\r\n{ "VRU Time Lag", "ged125.vru_time_lag",\r\nFT_INT32, BASE_DEC, NULL, 0x0,\r\n"Number of seconds that the VRU clock lags the ICM clock", HFILL }},\r\n{ &hf_ged125_CallVarsMask,\r\n{ "Call Vars Mask", "ged125.call_vars_mask",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\n"A bit map, with the least significant bit referring to Call Variable1", HFILL }},\r\n{ &hf_ged125_floating_payload_unspec,\r\n{ "Unspec floating data-type", "ged125.floating_unspec",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\n"Unknown data type", HFILL }},\r\n{ &hf_ged125_floating_media_protocol,\r\n{ "Media Protocol", "ged125.media_protocol",\r\nFT_UINT8, BASE_DEC, VALS(floating_media_protocol_vals), 0x0,\r\n"Type of media", HFILL }},\r\n{ &hf_ged125_floating_library_designator,\r\n{ "Library Designator", "ged125.library_designator",\r\nFT_UINT8, BASE_DEC, VALS(floating_media_library_designator_vals), 0x0,\r\n"System or Application", HFILL }},\r\n{ &hf_ged125_Data_Playback_Type,\r\n{ "Data Playback Type", "ged125.data_playback_type",\r\nFT_UINT32, BASE_DEC, VALS(Data_Playback_Type), 0x0, NULL, HFILL }},\r\n{ &hf_ged125_Data_Playback_Formats,\r\n{ "Data Playback Format", "ged125.data_playback_format",\r\nFT_UINT32, BASE_DEC, VALS(Data_Playback_Formats),0x0,\r\n"Only relevant if Data Playback Type is one of the time formats. "\r\n"It should contain PLAYBACK_FORMAT_OTHER in all other cases", HFILL }},\r\n{ &hf_ged125_floating_uchar_array_index,\r\n{ "Uchar-Array Index", "ged125.uchar_array_index",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\n"Array index of an ECC field", HFILL }}\r\n};\r\nstatic gint *ett[] = {\r\n&ett_ged125,\r\n&ett_ged125_header,\r\n&ett_ged125_message,\r\n&ett_ged125_floating,\r\n&ett_ged125_float_field,\r\n&ett_ged125_service_control_header,\r\n&ett_ged125_service_control_data\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_ged125_OperationalStatus_normal, { "ged125.operational_status.normal", PI_PROTOCOL, PI_NOTE, "Normal Operation", EXPFILL }},\r\n{ &ei_ged125_OperationalStatus_loss_redundant_component, { "ged125.operational_status.loss_redundant_component", PI_PROTOCOL, PI_NOTE,\r\n"Loss of redundant component or other transparent failure; still fully functional for call processing", EXPFILL }},\r\n{ &ei_ged125_OperationalStatus_degraded_call_processing, { "ged125.operational_status.degraded_call_processing", PI_PROTOCOL, PI_NOTE, "Degraded call processing", EXPFILL }},\r\n{ &ei_ged125_OperationalStatus_conditions_prevent_call, { "ged125.operational_status.conditions_prevent_call", PI_PROTOCOL, PI_NOTE, "Conditions prevent call processing", EXPFILL }},\r\n{ &ei_ged125_OperationalStatus_invalid_message, { "ged125.operational_status.invalid_message", PI_PROTOCOL, PI_WARN, "Error: Invalid message", EXPFILL }},\r\n{ &ei_ged125_length_bad, { "ged125.length.bad", PI_MALFORMED, PI_ERROR, "Incorrect size given in the packet (corrupted)", EXPFILL }},\r\n{ &ei_ged125_sendseqno_and_dialogueid, { "ged125.sendseqno_and_dialogueid", PI_PROTOCOL, PI_WARN, "Both SendSeqNo & DialogueID must be NULL because at least one is NULL", EXPFILL }},\r\n{ &ei_ged125_service_control_value_unknown, { "ged125.service_control_value.unknown", PI_PROTOCOL, PI_WARN, "Unknown Service-Control Message Sub-type, aborting dissection", EXPFILL }},\r\n{ &ei_ged125_trunk_group_id, { "ged125.trunk_group_id.bad_range", PI_PROTOCOL, PI_WARN, "TrunkGroupID must be between 0-65535", EXPFILL }},\r\n{ &ei_ged125_TrunkCount_invalid, { "ged125.trunk_count.invalid", PI_PROTOCOL, PI_WARN, "Invalid number of trunks (max is 1023)", EXPFILL }},\r\n};\r\nexpert_module_t* expert_ged125;\r\nproto_ged125 = proto_register_protocol ("Cisco GED-125 Protocol", "GED125", "ged125");\r\nproto_register_field_array (proto_ged125, hf, array_length (hf));\r\nproto_register_subtree_array (ett, array_length (ett));\r\nexpert_ged125 = expert_register_protocol(proto_ged125);\r\nexpert_register_field_array(expert_ged125, ei, array_length(ei));\r\nged125_handle = register_dissector("ged125", dissect_ged125, proto_ged125);\r\nged125_module = prefs_register_protocol(proto_ged125, NULL);\r\nprefs_register_uint_preference(ged125_module, "tcp_port","GED125 TCP Port",\r\n"Set up the TCP port for GED125",\r\n10, &global_tcp_port_ged125);\r\nprefs_register_bool_preference(ged125_module, "desegment_body",\r\n"Reassemble GED125 bodies spanning multiple TCP segments",\r\n"Whether the GED125 dissector should desegment all messages spanning multiple TCP segments",\r\n&ged125_desegment_body);\r\n}\r\nvoid\r\nproto_reg_handoff_ged125(void)\r\n{\r\nstatic guint old_ged125_tcp_port = 0;\r\nif (old_ged125_tcp_port != 0 && old_ged125_tcp_port != global_tcp_port_ged125)\r\ndissector_delete_uint("tcp.port", old_ged125_tcp_port, ged125_handle);\r\nif (global_tcp_port_ged125 != 0 && old_ged125_tcp_port != global_tcp_port_ged125)\r\ndissector_add_uint("tcp.port", global_tcp_port_ged125, ged125_handle);\r\nold_ged125_tcp_port = global_tcp_port_ged125;\r\n}
