static gint\r\ntn3270_add_hf_items(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\nconst hf_items *fields)\r\n{\r\ngint start = offset;\r\ngint i;\r\nfor (i = 0; fields[i].hf_idx_p; i++) {\r\nif (fields[i].bitmask == 0) {\r\nproto_tree_add_item(tn3270_tree,\r\n*fields[i].hf_idx_p,\r\ntvb, offset,\r\nfields[i].length,\r\nfields[i].encoding);\r\n}\r\nelse {\r\nproto_tree_add_bitmask(tn3270_tree, tvb, offset, *fields[i].hf_idx_p,\r\n*fields[i].bitmask_ett_idx_p, fields[i].bitmask, ENC_BIG_ENDIAN);\r\n}\r\noffset += fields[i].length;\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_unknown_data(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset, gint start,\r\ngint data_length)\r\n{\r\ngint len_left;\r\nlen_left = (data_length) - (offset - start);\r\nif (len_left > 0) {\r\nproto_tree_add_item(tn3270_tree, hf_tn3270_unknown_data,\r\ntvb, offset, len_left,\r\nENC_NA);\r\nreturn len_left;\r\n}\r\nreturn 0;\r\n}\r\nstatic gint\r\nadd_data_until_next_order_code(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset)\r\n{\r\ngint datalen = 0;\r\ngint length_remaining = tvb_reported_length_remaining(tvb, offset);\r\nwhile (datalen < length_remaining) {\r\nguint order_code;\r\norder_code = tvb_get_guint8(tvb, offset + datalen);\r\nif ((order_code > 0) && (order_code <= OC_MAX))\r\nbreak;\r\ndatalen += 1;\r\n}\r\nif (datalen > 0) {\r\nproto_tree_add_item(tn3270_tree, hf_tn3270_field_data, tvb, offset,\r\ndatalen, ENC_EBCDIC|ENC_NA);\r\n}\r\nreturn datalen;\r\n}\r\nstatic gint\r\ndissect_query_reply_resbytes(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_res_twobytes, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_wcc(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset)\r\n{\r\nstatic const gint *wcc_fields[] = {\r\n&hf_tn3270_wcc_nop,\r\n&hf_tn3270_wcc_reset,\r\n&hf_tn3270_wcc_printer1,\r\n&hf_tn3270_wcc_printer2,\r\n&hf_tn3270_wcc_start_printer,\r\n&hf_tn3270_wcc_sound_alarm,\r\n&hf_tn3270_wcc_keyboard_restore,\r\n&hf_tn3270_wcc_reset_mdt,\r\nNULL\r\n};\r\nproto_tree_add_bitmask_text(tn3270_tree, tvb, offset, 1, "Write Control Character: ", "None",\r\nett_tn3270_wcc, wcc_fields, ENC_BIG_ENDIAN, 0);\r\nreturn 1;\r\n}\r\nstatic gint\r\ndissect_3270_field_validation(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset)\r\n{\r\ngint start = offset;\r\nstatic const gint *byte[] = {\r\n&hf_tn3270_field_validation_mandatory_fill,\r\n&hf_tn3270_field_validation_mandatory_entry,\r\n&hf_tn3270_field_validation_trigger,\r\nNULL\r\n};\r\nproto_tree_add_bitmask_text(tn3270_tree, tvb, 1, 1, "Field Validation: ",\r\n"None", ett_tn3270_field_validation, byte, ENC_BIG_ENDIAN, 0);\r\noffset += 1;\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_3270_field_attribute(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset)\r\n{\r\ngint start = offset;\r\nstatic const gint *byte[] = {\r\n&hf_tn3270_fa_graphic_convert,\r\n&hf_tn3270_fa_protected,\r\n&hf_tn3270_fa_numeric,\r\n&hf_tn3270_fa_display,\r\n&hf_tn3270_fa_reserved,\r\n&hf_tn3270_fa_modified,\r\nNULL\r\n};\r\nproto_tree_add_bitmask(tn3270_tree, tvb, offset, hf_tn3270_field_attribute,\r\nett_tn3270_field_attribute, byte, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_ccc(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset)\r\n{\r\ngint start = offset;\r\nstatic const gint *byte[] = {\r\n&hf_tn3270_ccc_coding,\r\n&hf_tn3270_ccc_printout,\r\n&hf_tn3270_ccc_start_print,\r\n&hf_tn3270_ccc_sound_alarm,\r\n&hf_tn3270_ccc_copytype,\r\nNULL\r\n};\r\nproto_tree_add_bitmask(tn3270_tree, tvb, offset, hf_tn3270_ccc,\r\nett_tn3270_ccc, byte, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_create_partition(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset, gint sf_body_length)\r\n{\r\ngint start = offset;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_partition_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_partition_uom, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_partition_flags, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_partition_height, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_partition_width, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_partition_rv, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_partition_cv, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_partition_hv, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_partition_wv, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_partition_rw, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_partition_cw, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_partition_rs, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_partition_res, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_partition_pw, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_partition_ph, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_load_format_storage(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset, gint sf_body_length)\r\n{\r\ngint start = offset;\r\ngint operand;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_load_format_storage_flags1, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_load_format_storage_flags2, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_load_format_storage_operand, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_load_format_storage_localname, NULL, 8, NULL, ENC_EBCDIC|ENC_NA },\r\n{ &hf_tn3270_format_group, NULL, 6, NULL, ENC_EBCDIC|ENC_NA },\r\n{ &hf_tn3270_format_name, NULL, 16, NULL, ENC_EBCDIC|ENC_NA },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noperand = tvb_get_guint8(tvb, offset+2);\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\nif (operand == LOAD_FORMAT_STORAGE_OPERAND_ADD) {\r\ngint fmtln = sf_body_length - (offset - start);\r\nproto_tree_add_item(tn3270_tree, hf_tn3270_load_format_storage_format_data,\r\ntvb, offset, fmtln, ENC_EBCDIC|ENC_NA);\r\noffset += fmtln;\r\n}\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_load_programmed_symbols(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset, gint sf_body_length)\r\n{\r\ngint start = offset, i;\r\ngint8 flags;\r\ngint8 extended_ps_length;\r\nstatic const hf_items ps_fields[] = {\r\n{ &hf_tn3270_ps_flags, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ps_lcid, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ps_char, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ps_rws, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nstatic const hf_items extended_ps_fields[] = {\r\n{ &hf_tn3270_extended_ps_lw, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_extended_ps_lh, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_extended_ps_subsn, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_extended_ps_color, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_extended_ps_stsubs, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_extended_ps_echar, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_extended_ps_nw, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_extended_ps_nh, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_extended_ps_res, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nflags = tvb_get_guint8(tvb, offset);\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nps_fields);\r\nif (!(flags & 0x80)) {\r\nreturn (offset - start);\r\n}\r\nextended_ps_length = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tn3270_tree, hf_tn3270_extended_ps_length,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tn3270_tree, hf_tn3270_extended_ps_flags,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nfor (i = 0; i < extended_ps_length; ++i) {\r\nif (extended_ps_fields[i].hf_idx_p == NULL) {\r\nbreak;\r\n}\r\nproto_tree_add_item(tn3270_tree, *extended_ps_fields[i].hf_idx_p,\r\ntvb, offset, extended_ps_fields[i].length,\r\nextended_ps_fields[i].encoding);\r\noffset += extended_ps_fields[i].length;\r\n}\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_modify_partition(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset, gint sf_body_length)\r\n{\r\ngint start = offset;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_resbyte, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_partition_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_resbyte, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_partition_flags, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_resbyte, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_resbytes, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_partition_rv, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_partition_cv, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_partition_hv, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_partition_wv, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_partition_rw, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_partition_cw, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_partition_rs, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_partition_res, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_partition_pw, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_partition_ph, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_outbound_text_header(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\ngint16 hdr_length;\r\nstatic const hf_items outbound_text_header_fields1[] = {\r\n{ &hf_tn3270_partition_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_outbound_text_header_operation_type, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nstatic const hf_items outbound_text_header_fields2[] = {\r\n{ &hf_tn3270_resbyte, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_resbyte, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_lvl, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_cro, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_cc, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\noutbound_text_header_fields1);\r\noffset += dissect_wcc(tn3270_tree, tvb, offset);\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\noutbound_text_header_fields2);\r\nhdr_length = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_item(tn3270_tree, hf_tn3270_outbound_text_header_lhdr,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tn3270_tree, hf_tn3270_outbound_text_header_hdr,\r\ntvb, offset, hdr_length, ENC_NA);\r\noffset += hdr_length;\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_outbound_3270ds(proto_tree *tn3270_tree, packet_info *pinfo, tvbuff_t *tvb, gint offset,\r\ntn3270_conv_info_t *tn3270_info, gint sf_body_length )\r\n{\r\ngint start = offset;\r\ngint cmd;\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_partition_id,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\ncmd = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_partition_command,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nswitch (cmd) {\r\ncase CC_SNA_BSC:\r\noffset += dissect_ccc(tn3270_tree, tvb, offset);\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_bsc,\r\ntvb, offset,\r\n2,\r\nENC_BIG_ENDIAN);\r\noffset += 2;\r\nbreak;\r\ncase CC_LCL_W:\r\ncase CC_LCL_EW:\r\ncase CC_LCL_EWA:\r\ncase CC_LCL_EAU:\r\ncase CC_RMT_W:\r\ncase CC_RMT_EW:\r\ncase CC_RMT_EWA:\r\ncase CC_RMT_EAU:\r\nif ((offset - start) < sf_body_length)\r\noffset += dissect_wcc(tn3270_tree, tvb, offset);\r\nif ((offset - start) < sf_body_length)\r\noffset += dissect_orders_and_data(tn3270_tree, pinfo, tvb, offset, tn3270_info);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_present_absolute_format(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_partition_id,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_fpc,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\noffset += dissect_wcc(tn3270_tree, tvb, offset);\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_format_name,\r\ntvb, offset,\r\nsf_body_length - (offset - start),\r\nENC_EBCDIC|ENC_NA);\r\noffset += (sf_body_length - (offset - start));\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_present_relative_format(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_partition_id,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_fov,\r\ntvb, offset,\r\n2,\r\nENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_fpc,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\noffset += dissect_wcc(tn3270_tree, tvb, offset);\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_format_name,\r\ntvb, offset,\r\nsf_body_length - (offset - start),\r\nENC_EBCDIC|ENC_NA);\r\noffset += (sf_body_length - (offset - start));\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_read_partition(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\ngint type;\r\nproto_tree *query_list_tree;\r\ngint qcode_list_len, i;\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_partition_id,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\ntype = tvb_get_guint8(tvb, offset);\r\nif (type == 0xFF) {\r\noffset += 1;\r\ntype = tvb_get_guint8(tvb, offset);\r\n}\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_read_partition_operation_type,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nif (type == READ_PARTITION_OPTYPE_QUERY_LIST) {\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_read_partition_reqtyp,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nif (sf_body_length > (offset - start)) {\r\nqcode_list_len = sf_body_length - (offset - start);\r\nquery_list_tree = proto_tree_add_subtree(tn3270_tree, tvb, offset, qcode_list_len,\r\nett_tn3270_query_list, NULL, "Query List");\r\nfor (i = 0; i < qcode_list_len; i++) {\r\nproto_tree_add_item(query_list_tree,\r\nhf_tn3270_sf_query_reply,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\n}\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_restart(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_resbyte,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_start_page,\r\ntvb, offset,\r\n2,\r\nENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_start_line,\r\ntvb, offset,\r\n2,\r\nENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_scs_data,\r\ntvb, offset,\r\nsf_body_length - (offset - start),\r\nENC_NA);\r\noffset += (sf_body_length - (offset - start));\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_set_msr_control(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\nstatic const gint *byte[] = {\r\n&hf_tn3270_msr_user,\r\n&hf_tn3270_msr_locked,\r\n&hf_tn3270_msr_auto,\r\n&hf_tn3270_msr_ind1,\r\n&hf_tn3270_msr_ind2,\r\nNULL\r\n};\r\nstatic const hf_items outbound_text_header_fields[] = {\r\n{ &hf_tn3270_partition_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_msr_type, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_msr_state_mask, &ett_tn3270_msr_state_mask, 1, byte, 0 },\r\n{ &hf_tn3270_msr_state_value, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_msr_ind_mask, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_msr_ind_value, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\noutbound_text_header_fields);\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_set_partition_characteristics_sd_parms(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset)\r\n{\r\ngint start = offset;\r\nguint16 sdp;\r\nstatic const hf_items sdp1[] = {\r\n{ &hf_tn3270_sdp_ln, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_spc_sdp_ot, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_spc_sdp_ob, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_spc_sdp_ol, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_spc_sdp_or, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nstatic const hf_items sdp2[] = {\r\n{ &hf_tn3270_sdp_ln, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_spc_sdp_eucflags, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nstatic const hf_items sdp3[] = {\r\n{ &hf_tn3270_sdp_ln, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_spc_sdp_eucflags, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_spc_sdp_eucflags, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nsdp = tvb_get_ntohs(tvb, offset);\r\nswitch (sdp) {\r\ncase 0x0601:\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nsdp1);\r\nbreak;\r\ncase 0x0304:\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nsdp2);\r\nbreak;\r\ncase 0x0405:\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nsdp3);\r\nbreak;\r\ndefault:\r\nreturn 0;\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_set_partition_characteristics(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\ngint i;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_partition_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_resbytes, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\nfor (i = 0; i < 3; i++) {\r\noffset += dissect_set_partition_characteristics_sd_parms(tn3270_tree, tvb, offset);\r\nif (tvb_reported_length_remaining(tvb, offset) <= 0)\r\nbreak;\r\n}\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_set_printer_characteristics_sd_parms(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset)\r\n{\r\ngint start = offset;\r\nguint16 sdp;\r\nstatic const hf_items sdp1[] = {\r\n{ &hf_tn3270_sdp_ln, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_spc_sdp_srepc, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nsdp = tvb_get_ntohs(tvb, offset);\r\nswitch (sdp) {\r\ncase 0x0301:\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nsdp1);\r\nbreak;\r\ndefault:\r\nreturn 0;\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_set_printer_characteristics(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\ngint i;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_printer_flags, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_resbyte, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\nfor (i = 0; i < 3; i++) {\r\noffset += dissect_set_printer_characteristics_sd_parms(tn3270_tree, tvb, offset);\r\nif (tvb_reported_length_remaining(tvb, offset) <= 0)\r\nbreak;\r\n}\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_set_reply_mode(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\ngint type;\r\ngint i;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_partition_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_mode, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\ntype = tvb_get_guint8(tvb, offset+1);\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\nif (type == 0x02) {\r\nfor (i = 0; i < (sf_body_length-(offset-start)); i++) {\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_reply_mode_attr_list,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_type_1_text(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_partition_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_resbytes, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_field_data,\r\ntvb, offset,\r\nsf_body_length - (offset - start),\r\nENC_EBCDIC|ENC_NA);\r\noffset += (sf_body_length - (offset - start));\r\nreturn (offset - start);\r\n}\r\nstatic guint\r\ndissect_data_chain(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\nstatic const gint *byte[] = {\r\n&hf_tn3270_data_chain_group,\r\n&hf_tn3270_data_chain_inbound_control,\r\nNULL\r\n};\r\nstatic const hf_items data_chain_fields[] = {\r\n{ &hf_tn3270_data_chain_fields, &ett_tn3270_data_chain_fields, 1, byte, 0 },\r\n{ &hf_tn3270_resbyte, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\ndata_chain_fields);\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_object_control(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_partition_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_object_control_flags, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_object_type, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_type_1_text_outbound_data,\r\ntvb, offset,\r\nsf_body_length - (offset - start),\r\nENC_NA);\r\noffset += (sf_body_length - (offset - start));\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_save_or_restore_format(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\nhf_items fields[] = {\r\n{ &hf_tn3270_save_or_restore_format_flags, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_srf_fpcb, NULL, sf_body_length-1, NULL, ENC_NA },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_exception_or_status_sd_parms(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset)\r\n{\r\ngint start = offset;\r\nguint16 sdp;\r\nstatic const hf_items sdp1[] = {\r\n{ &hf_tn3270_sdp_ln, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_resbyte, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_excode, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nstatic const hf_items sdp2[] = {\r\n{ &hf_tn3270_sdp_ln, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_statcode, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nstatic const hf_items sdp3[] = {\r\n{ &hf_tn3270_sdp_ln, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_format_group, NULL, 16, NULL, ENC_EBCDIC|ENC_NA },\r\n{ &hf_tn3270_format_name, NULL, 16, NULL, ENC_EBCDIC|ENC_NA },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nstatic const hf_items sdp4[] = {\r\n{ &hf_tn3270_sdp_ln, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_ngl, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_nml, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_nlml, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_stor, NULL, 4, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nstatic const hf_items sdp5[] = {\r\n{ &hf_tn3270_sdp_ln, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_format_group, NULL, 16, NULL, ENC_EBCDIC|ENC_NA },\r\n{ &hf_tn3270_sdp_nml, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nsdp = tvb_get_ntohs(tvb, offset);\r\nswitch (sdp) {\r\ncase 0x0601:\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nsdp1);\r\nbreak;\r\ncase 0x0402:\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nsdp2);\r\nbreak;\r\ncase 0x2203:\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nsdp3);\r\nbreak;\r\ncase 0x0C04:\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nsdp4);\r\nbreak;\r\ncase 0x1405:\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nsdp5);\r\nbreak;\r\ndefault:\r\nreturn 0;\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_exception_or_status(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset, i;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_partition_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_exception_or_status_flags, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_resbyte, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\nfor (i = 0; i < 5; i++) {\r\noffset += dissect_exception_or_status_sd_parms(tn3270_tree, tvb, offset);\r\nif (tvb_reported_length_remaining(tvb, offset) <= 0)\r\nbreak;\r\n}\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_inbound_text_header(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\nstatic const hf_items outbound_text_header_fields[] = {\r\n{ &hf_tn3270_partition_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_aid, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_resbyte, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_resbyte, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_resbyte, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_lvl, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_cro, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_cc, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_rw, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_cw, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_hw, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ww, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\noutbound_text_header_fields);\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_inbound_3270ds(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ntn3270_conv_info_t *tn3270_info, gint sf_body_length)\r\n{\r\ngint start = offset;\r\nstatic const hf_items fields1[] = {\r\n{ &hf_tn3270_partition_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_aid, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nhf_items fields2[] = {\r\n{ &hf_tn3270_field_data, NULL, sf_body_length - 4, NULL, ENC_EBCDIC|ENC_NA },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset, fields1);\r\noffset += dissect_buffer_address(tn3270_tree, tvb, offset, hf_tn3270_cursor_address, tn3270_info);\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset, fields2);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_recovery_data(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_resbyte, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_recovery_data_flags, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sld, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_charset, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_vertical, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_v_offset, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_v_sequence, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_v_length, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_spd, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_horizon, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_h_offset, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_h_sequence, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_h_length, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_color, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_hilite, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_pages, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_lines, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_checkpoint, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_c_offset, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_c_sequence, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_c_seqoff, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_c_scsoff, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_prime, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_alphanumeric_sd_parms(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset)\r\n{\r\ngint start = offset;\r\nguint16 sdp;\r\nstatic const hf_items sdp1[] = {\r\n{ &hf_tn3270_sdp_ln, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ap_cm, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ap_ro, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ap_co, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ap_fo, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nsdp = tvb_get_ntohs(tvb, offset);\r\nswitch (sdp) {\r\ncase 0x0702:\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nsdp1);\r\nbreak;\r\ndefault:\r\nreturn 0;\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_alphanumeric(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\nstatic const gint *byte[] = {\r\n&hf_tn3270_ap_vertical_scrolling,\r\n&hf_tn3270_ap_horizontal_scrolling,\r\n&hf_tn3270_ap_apres1,\r\n&hf_tn3270_ap_apa,\r\n&hf_tn3270_ap_pp,\r\n&hf_tn3270_ap_lc,\r\n&hf_tn3270_ap_mp,\r\n&hf_tn3270_ap_apres2,\r\nNULL\r\n};\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_ap_na, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ap_m, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_query_reply_alphanumeric_flags, &ett_tn3270_query_reply_alphanumeric_flags, 1, byte, 0 },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\noffset += dissect_query_reply_alphanumeric_sd_parms(tn3270_tree, tvb, offset);\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_character_sets(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\ngint flagbyte1, flagbyte2;\r\nstatic const gint *byte1[] = {\r\n&hf_tn3270_cs_ge,\r\n&hf_tn3270_cs_mi,\r\n&hf_tn3270_cs_lps,\r\n&hf_tn3270_cs_lpse,\r\n&hf_tn3270_cs_ms,\r\n&hf_tn3270_cs_ch2,\r\n&hf_tn3270_cs_gf,\r\n&hf_tn3270_cs_res,\r\nNULL\r\n};\r\nstatic const gint *byte2[] = {\r\n&hf_tn3270_cs_res2,\r\n&hf_tn3270_cs_pscs,\r\n&hf_tn3270_cs_res3,\r\n&hf_tn3270_cs_cf,\r\nNULL\r\n};\r\nstatic const gint *byte3[] = {\r\n&hf_tn3270_cs_form_type1,\r\n&hf_tn3270_cs_form_type2,\r\n&hf_tn3270_cs_form_type3,\r\n&hf_tn3270_cs_form_type4,\r\n&hf_tn3270_cs_form_type5,\r\n&hf_tn3270_cs_form_type6,\r\n&hf_tn3270_cs_form_type8,\r\nNULL\r\n};\r\nstatic const gint *byte4[] = {\r\n&hf_tn3270_cs_ds_load,\r\n&hf_tn3270_cs_ds_triple,\r\n&hf_tn3270_cs_ds_char,\r\n&hf_tn3270_cs_ds_cb,\r\nNULL\r\n};\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_character_sets_flags1, &ett_tn3270_character_sets_flags1, 1, byte1, 0 },\r\n{ &hf_tn3270_character_sets_flags2, &ett_tn3270_character_sets_flags2, 1, byte2, 0 },\r\n{ &hf_tn3270_sdw, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdh, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_form, &ett_tn3270_character_sets_form, 1, byte3, 0 },\r\n{ &hf_tn3270_formres, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_formres, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_formres, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_cs_dl, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nstatic const hf_items descriptors[] = {\r\n{ &hf_tn3270_cs_descriptor_set, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_cs_descriptor_flags, &ett_tn3270_cs_descriptor_flags, 1, byte4, 0 },\r\n{ &hf_tn3270_lcid, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nstatic const hf_items sw_sh[] = {\r\n{ &hf_tn3270_sw, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sh, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nstatic const hf_items subsn[] = {\r\n{ &hf_tn3270_ssubsn, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_esubsn, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nstatic const hf_items gf[] = {\r\n{ &hf_tn3270_ccsgid, NULL, 4, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nstatic const hf_items cf[] = {\r\n{ &hf_tn3270_ccsid, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nflagbyte1 = tvb_get_guint8(tvb, offset);\r\nflagbyte2 = tvb_get_guint8(tvb, offset+1);\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\nwhile ((offset - start) < sf_body_length) {\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\ndescriptors);\r\nif (flagbyte1 & QR_CS_MS) {\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nsw_sh);\r\n}\r\nif (flagbyte1 & QR_CS_CH2) {\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nsubsn);\r\n}\r\nif (flagbyte1 & QR_CS_GF) {\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\ngf);\r\n}\r\nif (flagbyte2 & QR_CS_CF) {\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\ncf);\r\n}\r\n}\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_color_sd_parms(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset)\r\n{\r\ngint start = offset;\r\nguint16 sdp;\r\nstatic const hf_items sdp1[] = {\r\n{ &hf_tn3270_sdp_ln, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_db_cavdef, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_db_cidef, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nsdp = tvb_get_ntohs(tvb, offset);\r\nswitch (sdp) {\r\ncase 0x0402:\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nsdp1);\r\nbreak;\r\ndefault:\r\nreturn 0;\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_color(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\ngint i;\r\ngint np;\r\nstatic const gint *byte[] = {\r\n&hf_tn3270_c_prtblk,\r\nNULL\r\n};\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_color_flags, &ett_tn3270_color_flags, 1, byte, 0 },\r\n{ &hf_tn3270_c_np, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nnp = tvb_get_guint8(tvb, offset +1);\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\nfor (i=0; i < np; i++) {\r\nif (tvb_get_guint8(tvb, offset) == 0xFF) {\r\noffset += 1;\r\n}\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_c_cav,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nif (tvb_get_guint8(tvb, offset) == 0xFF) {\r\noffset += 1;\r\n}\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_c_ci,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\noffset += dissect_query_reply_color_sd_parms(tn3270_tree, tvb, offset);\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_daid_sd_parm(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset)\r\n{\r\ngint start = offset;\r\nstatic const hf_items sdp1[] = {\r\n{ &hf_tn3270_sdp_ln, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_daid, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nsdp1);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_pclk_sd_parm(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset)\r\n{\r\ngint start = offset;\r\nstatic const hf_items sdp1[] = {\r\n{ &hf_tn3270_sdp_ln, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_oem_sdp_pclk_vers, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nsdp1);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_oem_auxiliary_device_sd_parms(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset)\r\n{\r\ngint start = offset;\r\ngint sdp_len;\r\ngint sdp;\r\nstatic const hf_items sdp1[] = {\r\n{ &hf_tn3270_sdp_ln, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_daid, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nstatic const hf_items sdp2[] = {\r\n{ &hf_tn3270_sdp_ln, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_oem_sdp_ll_limin, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_oem_sdp_ll_limout, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nstatic const hf_items sdp3[] = {\r\n{ &hf_tn3270_sdp_ln, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_oem_sdp_pclk_vers, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nsdp_len = tvb_get_guint8(tvb, offset);\r\nif ((sdp_len != 0x04) && (sdp_len != 0x06)) {\r\nreturn 0;\r\n}\r\nsdp = tvb_get_guint8(tvb, offset+1);\r\nswitch (sdp) {\r\ncase 0x01:\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nsdp1);\r\nbreak;\r\ncase 0x02:\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nsdp2);\r\nbreak;\r\ncase 0x03:\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nsdp3);\r\nbreak;\r\ndefault:\r\nreturn 0;\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_cooperative(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_res_twobytes, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_limin, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_limout, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_featl, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_feats, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\n#if 0\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_field_data,\r\ntvb, offset,\r\nsf_body_length - (offset-start),\r\nENC_EBCDIC|ENC_NA);\r\noffset += (sf_body_length - (offset - start));\r\noffset += dissect_query_reply_oem_auxiliary_device_sd_parms(tn3270_tree, tvb, offset);\r\n#endif\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_data_chaining(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_dc_dir, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_resbyte, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_data_streams(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\ngint i;\r\nproto_tree_add_item(tn3270_tree, hf_tn3270_ds_default_sfid, tvb, offset, 1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nfor (i=0; i < (sf_body_length-(offset-start)); i++) {\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_ds_sfid,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_dbcs_asia_sd_parms(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset)\r\n{\r\ngint start = offset;\r\ngint sdp_len;\r\ngint sdp;\r\nstatic const hf_items sdp1[] = {\r\n{ &hf_tn3270_sdp_ln, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_asia_sdp_sosi_soset, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nstatic const hf_items sdp2[] = {\r\n{ &hf_tn3270_sdp_ln, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_asia_sdp_ic_func, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nsdp_len = tvb_get_guint8(tvb, offset);\r\nif (sdp_len != 0x03) {\r\nreturn 0;\r\n}\r\nsdp = tvb_get_guint8(tvb, offset+1);\r\nswitch (sdp) {\r\ncase 0x01:\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nsdp1);\r\nbreak;\r\ncase 0x02:\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nsdp2);\r\nbreak;\r\ndefault:\r\nreturn 0;\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_dbcs_asia(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\ngint i;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_resbyte, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\nfor (i = 0; i < 3; i++) {\r\noffset += dissect_query_reply_dbcs_asia_sd_parms(tn3270_tree, tvb, offset);\r\nif (tvb_reported_length_remaining(tvb, offset) <= 0)\r\nbreak;\r\n}\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_device_characteristics(proto_tree *tn3270_tree, tvbuff_t *tvb,\r\ngint offset, gint sf_body_length)\r\n{\r\ngint start = offset;\r\n#if 0\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_sf_outbound_id,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\n#endif\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_distributed_data_management(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset, i;\r\ngint sdp;\r\ngboolean done = FALSE;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_ddm_flags, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ddm_flags, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ddm_limin, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ddm_limout, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ddm_nss, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ddm_ddmss, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\nfor (i = 0; i < 3; i++) {\r\nsdp = tvb_get_guint8(tvb, offset+1);\r\nswitch (sdp) {\r\ncase 0x02:\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, tvb_get_guint8(tvb,offset));\r\nbreak;\r\ncase 0x01:\r\noffset += dissect_daid_sd_parm(tn3270_tree, tvb, offset);\r\nbreak;\r\ncase 0x03:\r\noffset += dissect_pclk_sd_parm(tn3270_tree, tvb, offset);\r\nbreak;\r\ndefault:\r\ndone = TRUE;\r\nbreak;\r\n}\r\nif ((tvb_reported_length_remaining(tvb, offset) <= 0) || done)\r\nbreak;\r\n}\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_document_interchange_architecture(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset, sdp, ln, i;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_dia_flags, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_dia_limin, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_dia_limout, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\nln = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tn3270_tree, hf_tn3270_dia_nfs, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nfor (i=0; i < ln; i++) {\r\nproto_tree_add_item(tn3270_tree, hf_tn3270_dia_diafs, tvb, offset, 1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tn3270_tree, hf_tn3270_dia_diafn, tvb, offset, 2,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\nsdp = tvb_get_guint8(tvb, offset+1);\r\nif (sdp == 0x01) {\r\noffset += dissect_daid_sd_parm(tn3270_tree, tvb, offset);\r\n}\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_extended_drawing_routine(proto_tree *tn3270_tree, tvbuff_t *tvb,\r\ngint offset, gint sf_body_length)\r\n{\r\ngint start = offset;\r\nproto_tree_add_item(tn3270_tree, hf_tn3270_field_data ,tvb, offset,\r\nsf_body_length, ENC_EBCDIC|ENC_NA);\r\noffset += sf_body_length;\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_field_outlining(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_resbyte, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_fo_flags, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_fo_vpos, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_fo_hpos, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_fo_hpos0, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_fo_hpos1, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_format_storage_aux_device(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset, sdp;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_fsad_flags, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_resbyte, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_fsad_limin, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_fsad_limout, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\nsdp = tvb_get_guint8(tvb, offset+1);\r\nif (sdp == 0x01) {\r\noffset += dissect_daid_sd_parm(tn3270_tree, tvb, offset);\r\nproto_tree_add_item(tn3270_tree, hf_tn3270_fsad_size ,tvb, offset,\r\n2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_highlighting(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\ngint i;\r\ngint np;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_h_np, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nnp = tvb_get_guint8(tvb, offset);\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\nfor (i=0; i < np; i++) {\r\nif (tvb_get_guint8(tvb, offset) == 0xFF) {\r\noffset += 1;\r\n}\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_h_vi,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nif (tvb_get_guint8(tvb, offset) == 0xFF) {\r\noffset += 1;\r\n}\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_h_ai,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_ibm_aux_device(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset, i, sdp;\r\ngboolean done = FALSE;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_ibm_flags, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_resbyte, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ibm_limin, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ibm_limout, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ibm_type, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\nfor (i = 0; i < 3; i++) {\r\nsdp = tvb_get_guint8(tvb, offset+1);\r\nswitch (sdp) {\r\ncase 0x02:\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, tvb_get_guint8(tvb,offset));\r\nbreak;\r\ncase 0x01:\r\noffset += dissect_daid_sd_parm(tn3270_tree, tvb, offset);\r\nbreak;\r\ncase 0x03:\r\noffset += dissect_pclk_sd_parm(tn3270_tree, tvb, offset);\r\nbreak;\r\ndefault:\r\ndone = TRUE;\r\nbreak;\r\n}\r\nif ((tvb_reported_length_remaining(tvb, offset) <= 0) || done)\r\nbreak;\r\n}\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_implicit_partitions_sd_parms(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset)\r\n{\r\ngint start = offset;\r\ngint sdp_len;\r\ngint sdp;\r\nstatic const hf_items sdp1[] = {\r\n{ &hf_tn3270_sdp_ln, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ip_flags, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ipdd_wd, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ipdd_hd, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ipdd_wa, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ipdd_ha, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nstatic const hf_items sdp2[] = {\r\n{ &hf_tn3270_sdp_ln, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ip_flags, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ippd_dpbs, NULL, 4, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ippd_apbs, NULL, 4, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nstatic const hf_items sdp3[] = {\r\n{ &hf_tn3270_sdp_ln, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ip_flags, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ipccd_wcd, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ipccd_hcd, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ipccd_wca, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ipccd_hca, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nsdp_len = tvb_get_guint8(tvb, offset);\r\nif (sdp_len != 0x0B) {\r\nreturn 0;\r\n}\r\nsdp = tvb_get_guint8(tvb, offset+1);\r\nswitch (sdp) {\r\ncase QR_IP_SDP_DISPLAY:\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nsdp1);\r\nbreak;\r\ncase QR_IP_SDP_PRINTER:\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nsdp2);\r\nbreak;\r\ncase QR_IP_SDP_CHARACTER:\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nsdp3);\r\nbreak;\r\ndefault:\r\nreturn 0;\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_implicit_partitions(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\ngint i;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_ip_flags, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ip_flags, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\nfor (i = 0; i < 3; i++) {\r\ngint len;\r\nlen = dissect_query_reply_implicit_partitions_sd_parms(tn3270_tree, tvb, offset);\r\nif ((len == 0) || (tvb_reported_length_remaining(tvb, offset) <= 0))\r\nbreak;\r\noffset += len;\r\n}\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_ioca_aux_device(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_resbyte, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_resbyte, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ioca_limin, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ioca_limout, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ioca_type, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_msr_control(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_resbyte, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_msr_nd, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_msr_type, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_oem_auxiliary_device(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\ngint i;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_resbyte, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_oem_dsref, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_oem_dtype, NULL, 8, NULL, ENC_EBCDIC|ENC_NA },\r\n{ &hf_tn3270_oem_uname, NULL, 8, NULL, ENC_EBCDIC|ENC_NA },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\nfor (i = 0; i < 3; i++) {\r\noffset += dissect_query_reply_oem_auxiliary_device_sd_parms(tn3270_tree, tvb, offset);\r\nif (tvb_reported_length_remaining(tvb, offset) <= 0)\r\nbreak;\r\n}\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_paper_feed_techniques(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_pft_flags, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_pft_tmo, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_pft_bmo, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_partition_characteristics(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset, i, sdp;\r\ngboolean done = FALSE;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_sdp_ln, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nfor (i = 0; i < 2; i++) {\r\nsdp = tvb_get_guint8(tvb, offset+1);\r\nswitch (sdp) {\r\ncase 0x01:\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\nproto_tree_add_item(tn3270_tree, hf_tn3270_pc_vo_thickness,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase 0x03:\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\nbreak;\r\ndefault:\r\ndone = TRUE;\r\nbreak;\r\n}\r\nif ((tvb_reported_length_remaining(tvb, offset) <= 0) || done)\r\nbreak;\r\n}\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_product_defined_data_stream(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset, sdp;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_resbytes, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_pdds_refid, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_pdds_ssid, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\nsdp = tvb_get_guint8(tvb, offset+1);\r\nif (sdp == 0x01) {\r\noffset += dissect_daid_sd_parm(tn3270_tree, tvb, offset);\r\n}\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_modes(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\ngint i;\r\nfor (i=0; i < sf_body_length; i++) {\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_mode,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_rpq_names(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\ngint rpql;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_rpq_device, NULL, 4, NULL, ENC_EBCDIC|ENC_NA },\r\n{ &hf_tn3270_rpq_mid, NULL, 4, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\nrpql = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_rpq_rpql,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_rpq_name,\r\ntvb, offset,\r\n(rpql - 1),\r\nENC_EBCDIC|ENC_NA);\r\noffset += (rpql-1);\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_save_or_restore_format(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_srf_fpcbl, NULL, 1, NULL, ENC_NA },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_settable_printer_characteristics(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset, sdp;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_resbytes, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nstatic const hf_items fields2[] = {\r\n{ &hf_tn3270_sdp_ln, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\nsdp = tvb_get_guint8(tvb, offset+1);\r\nif (sdp == 0x01) {\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields2);\r\nproto_tree_add_item(tn3270_tree, hf_tn3270_spc_epc_flags, tvb, offset,\r\n1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_storage_pools(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset, sdp, i;\r\nstatic const hf_items fields2[] = {\r\n{ &hf_tn3270_sdp_ln, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sdp_id, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sp_spid, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sp_size, NULL, 4, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_sp_space, NULL, 4, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nsdp = tvb_get_guint8(tvb, offset+1);\r\nif (sdp == 0x01) {\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields2);\r\nfor (i=0; i < (sf_body_length-(offset-start)); i+=2) {\r\nproto_tree_add_item(tn3270_tree, hf_tn3270_sp_objlist,\r\ntvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\n}\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_summary(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint i;\r\ngint datalen = 0;\r\ngint length_remaining = tvb_reported_length_remaining(tvb, offset);\r\nfor (i=0; i < sf_body_length; i++) {\r\nif (datalen >= length_remaining) {\r\nreturn (datalen);\r\n}\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_sf_query_reply,\r\ntvb, offset + datalen,\r\n1,\r\nENC_BIG_ENDIAN);\r\ndatalen += 1;\r\n}\r\ndatalen += dissect_unknown_data(tn3270_tree, tvb, offset+datalen, offset, sf_body_length);\r\nreturn (datalen);\r\n}\r\nstatic gint\r\ndissect_query_reply_text_partitions(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset, len, i;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_tp_nt, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_tp_m, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_tp_flags, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\nlen = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tn3270_tree, hf_tn3270_tp_ntt, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nfor (i=0; i < len; i++) {\r\nproto_tree_add_item(tn3270_tree, hf_tn3270_tp_tlist,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_transparency(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset, i, len;\r\nlen = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tn3270_tree, hf_tn3270_t_np, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nfor (i=0; i < len; i+=2) {\r\nproto_tree_add_item(tn3270_tree, hf_tn3270_t_vi,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tn3270_tree, hf_tn3270_t_ai,\r\ntvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_usable_area(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\ngint vcp;\r\nstatic const gint *byte1[] = {\r\n&hf_tn3270_ua_reserved1,\r\n&hf_tn3270_ua_page_printer,\r\n&hf_tn3270_ua_reserved2,\r\n&hf_tn3270_ua_hard_copy,\r\n&hf_tn3270_ua_addressing,\r\nNULL\r\n};\r\nstatic const gint *byte2[] = {\r\n&hf_tn3270_ua_variable_cells,\r\n&hf_tn3270_ua_characters,\r\n&hf_tn3270_ua_cell_units,\r\nNULL\r\n};\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_usable_area_flags1, &ett_tn3270_usable_area_flags1, 1, byte1, 0 },\r\n{ &hf_tn3270_usable_area_flags2, &ett_tn3270_usable_area_flags1, 1, byte2, 0 },\r\n{ &hf_tn3270_ua_width_cells_pels, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ua_height_cells_pels, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ua_uom_cells_pels, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ua_xr, NULL, 4, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ua_yr, NULL, 4, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ua_aw, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ua_ah, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ua_buffsz, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nstatic const hf_items fields2[] = {\r\n{ &hf_tn3270_ua_xmin, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ua_ymin, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ua_xmax, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_ua_ymax, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\nvcp = tvb_get_guint8(tvb, offset+1);\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\nif ((vcp & QR_UA_VARIABLE_CELLS) != 0) {\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields2);\r\n}\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_query_reply_3270_ipds(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_body_length)\r\n{\r\ngint start = offset;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_resbytes, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_3270_tranlim, NULL, 2, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\noffset += tn3270_add_hf_items(tn3270_tree, tvb, offset,\r\nfields);\r\noffset += dissect_unknown_data(tn3270_tree, tvb, offset, start, sf_body_length);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\nprocess_inbound_structured_field(proto_tree *sf_tree, tvbuff_t *tvb, gint offset,\r\ntn3270_conv_info_t *tn3270_info, guint sf_id, gint sf_body_length)\r\n{\r\ngint start = offset;\r\nswitch (sf_id) {\r\ncase SF_IB_EXCEPTION_OR_STATUS:\r\noffset += dissect_exception_or_status(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_INBOUND_TEXT_HEADER:\r\noffset += dissect_inbound_text_header(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_INBOUND_3270DS:\r\noffset += dissect_inbound_3270ds(sf_tree, tvb, offset, tn3270_info, sf_body_length);\r\nbreak;\r\ncase SF_IB_RECOVERY_DATA:\r\noffset += dissect_recovery_data(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_TYPE_1_TEXT_INBOUND:\r\noffset += dissect_type_1_text(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_ALPHANUMERIC_PARTITIONS:\r\noffset += dissect_query_reply_alphanumeric(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_AUXILIARY_DEVICE:\r\ncase SF_IB_QUERY_REPLY_BEGIN_OR_END_OF_FILE:\r\noffset += dissect_query_reply_resbytes(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_CHARACTER_SETS:\r\noffset += dissect_query_reply_character_sets(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_COLOR:\r\noffset += dissect_query_reply_color(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_COOPERATIVE_PROCESSING_REQUESTOR:\r\noffset += dissect_query_reply_cooperative(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_DATA_CHAINING:\r\noffset += dissect_query_reply_data_chaining(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_DATA_STREAMS:\r\noffset += dissect_query_reply_data_streams(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_DBCS_ASIA:\r\noffset += dissect_query_reply_dbcs_asia(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_DEVICE_CHARACTERISTICS:\r\noffset += dissect_query_reply_device_characteristics(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_SUMMARY:\r\noffset += dissect_query_reply_summary(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_USABLE_AREA:\r\noffset += dissect_query_reply_usable_area(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_HIGHLIGHTING:\r\noffset += dissect_query_reply_highlighting(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_REPLY_MODES:\r\noffset += dissect_query_reply_modes(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_DISTRIBUTED_DATA_MANAGEMENT:\r\noffset += dissect_query_reply_distributed_data_management(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_RPQ_NAMES:\r\noffset += dissect_query_reply_rpq_names(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_IMPLICIT_PARTITION:\r\noffset += dissect_query_reply_implicit_partitions(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_OEM_AUXILIARY_DEVICE:\r\noffset += dissect_query_reply_oem_auxiliary_device(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_DOCUMENT_INTERCHANGE_ARCHITECTURE:\r\noffset += dissect_query_reply_document_interchange_architecture(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_EXTENDED_DRAWING_ROUTINE:\r\noffset += dissect_query_reply_extended_drawing_routine(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_FIELD_OUTLINING:\r\noffset += dissect_query_reply_field_outlining(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_FIELD_VALIDATION:\r\noffset += dissect_3270_field_validation(sf_tree, tvb, offset);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_FORMAT_STORAGE_AUXILIARY_DEVICE:\r\noffset += dissect_query_reply_format_storage_aux_device(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_GRAPHIC_COLOR:\r\ncase SF_IB_QUERY_REPLY_GRAPHIC_SYMBOL_SETS:\r\ncase SF_IB_QUERY_REPLY_IMAGE:\r\ncase SF_IB_QUERY_REPLY_LINE_TYPE:\r\ncase SF_IB_QUERY_REPLY_PROCEDURE:\r\ncase SF_IB_QUERY_REPLY_SEGMENT:\r\noffset += dissect_query_reply_extended_drawing_routine(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_IBM_AUXILIARY_DEVICE:\r\noffset += dissect_query_reply_ibm_aux_device(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_IOCA_AUXILIARY_DEVICE:\r\noffset += dissect_query_reply_ioca_aux_device(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_MSR_CONTROL:\r\noffset += dissect_query_reply_msr_control(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_FORMAT_PRESENTATION:\r\ncase SF_IB_QUERY_REPLY_NULL:\r\ncase SF_IB_QUERY_REPLY_PORT:\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_PAPER_FEED_TECHNIQUES:\r\noffset += dissect_query_reply_paper_feed_techniques(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_PARTITION_CHARACTERISTICS:\r\noffset += dissect_query_reply_partition_characteristics(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_PRODUCT_DEFINED_DATA_STREAM:\r\noffset += dissect_query_reply_product_defined_data_stream(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_SAVE_OR_RESTORE_FORMAT:\r\noffset += dissect_query_reply_save_or_restore_format(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_SETTABLE_PRINTER_CHARACTERISTICS:\r\noffset += dissect_query_reply_settable_printer_characteristics(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_STORAGE_POOLS:\r\noffset += dissect_query_reply_storage_pools(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_TEXT_PARTITIONS:\r\noffset += dissect_query_reply_text_partitions(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_TRANSPARENCY:\r\noffset += dissect_query_reply_transparency(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_IB_QUERY_REPLY_3270_IPDS:\r\noffset += dissect_query_reply_3270_ipds(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ndefault:\r\nDISSECTOR_ASSERT_NOT_REACHED();\r\nbreak;\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\nprocess_outbound_structured_field(proto_tree *sf_tree, packet_info *pinfo, tvbuff_t *tvb, gint offset,\r\ntn3270_conv_info_t *tn3270_info, guint sf_id, gint sf_body_length)\r\n{\r\ngint start = offset;\r\nswitch (sf_id) {\r\ncase SF_OB_READ_PARTITION:\r\noffset += dissect_read_partition(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_OB_ACTIVATE_PARTITION:\r\ncase SF_OB_DESTROY_PARTITION:\r\ncase SF_OB_RESET_PARTITION:\r\nproto_tree_add_item(sf_tree,\r\nhf_tn3270_partition_id,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase SF_OB_CREATE_PARTITION:\r\noffset += dissect_create_partition(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_OB_ERASE_OR_RESET:\r\nif ((tvb_get_guint8(tvb, offset) & 0x80) != 0) {\r\ntn3270_info->rows = tn3270_info->altrows;\r\ntn3270_info->cols = tn3270_info->altcols;\r\n}\r\nelse {\r\ntn3270_info->rows = 24;\r\ntn3270_info->cols = 80;\r\n}\r\nproto_tree_add_bits_item(sf_tree,\r\nhf_tn3270_erase_flags,\r\ntvb, offset<<3,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase SF_OB_LOAD_PROGRAMMED_SYMBOLS:\r\noffset += dissect_load_programmed_symbols(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_OB_OUTBOUND_3270DS:\r\noffset += dissect_outbound_3270ds(sf_tree, pinfo, tvb, offset, tn3270_info, sf_body_length);\r\nbreak;\r\ncase SF_OB_PRESENT_ABSOLUTE_FORMAT:\r\noffset += dissect_present_absolute_format(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_OB_PRESENT_RELATIVE_FORMAT:\r\noffset += dissect_present_relative_format(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_OB_SCS_DATA:\r\nproto_tree_add_item(sf_tree,\r\nhf_tn3270_partition_id,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sf_tree,\r\nhf_tn3270_scs_data,\r\ntvb, offset,\r\n(sf_body_length - (offset - start)),\r\nENC_NA);\r\noffset += (sf_body_length - (offset - start));\r\nbreak;\r\ncase SF_OB_SET_REPLY_MODE:\r\noffset += dissect_set_reply_mode(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_OB_SELECT_FORMAT_GROUP:\r\nproto_tree_add_item(sf_tree,\r\nhf_tn3270_partition_id,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sf_tree,\r\nhf_tn3270_format_group,\r\ntvb, offset,\r\n(sf_body_length - (offset - start)),\r\nENC_EBCDIC|ENC_NA);\r\noffset += (sf_body_length - (offset - start));\r\nbreak;\r\ncase SF_OB_SET_WINDOW_ORIGIN:\r\nproto_tree_add_item(sf_tree,\r\nhf_tn3270_partition_id,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sf_tree,\r\nhf_tn3270_partition_rw,\r\ntvb, offset,\r\n2,\r\nENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(sf_tree,\r\nhf_tn3270_partition_cw,\r\ntvb, offset,\r\n2,\r\nENC_BIG_ENDIAN);\r\noffset += 2;\r\nbreak;\r\ncase SF_OB_BEGIN_OR_END_OF_FILE:\r\nproto_tree_add_item(sf_tree,\r\nhf_tn3270_partition_id,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_bits_item(sf_tree,\r\nhf_tn3270_begin_end_flags1,\r\ntvb, offset<<3,\r\n2,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sf_tree,\r\nhf_tn3270_begin_end_flags2,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase SF_OB_LOAD_COLOR_TABLE:\r\nproto_tree_add_item(sf_tree,\r\nhf_tn3270_load_color_command,\r\ntvb, offset,\r\nsf_body_length,\r\nENC_NA);\r\noffset += sf_body_length;\r\nbreak;\r\ncase SF_OB_LOAD_FORMAT_STORAGE:\r\noffset += dissect_load_format_storage(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_OB_LOAD_LINE_TYPE:\r\nproto_tree_add_item(sf_tree,\r\nhf_tn3270_load_line_type_command,\r\ntvb, offset,\r\nsf_body_length,\r\nENC_NA);\r\noffset += sf_body_length;\r\nbreak;\r\ncase SF_OB_MODIFY_PARTITION:\r\noffset += dissect_modify_partition(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_OB_OUTBOUND_TEXT_HEADER:\r\noffset += dissect_outbound_text_header(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_OB_REQUEST_RECOVERY_DATA:\r\nproto_tree_add_item(sf_tree,\r\nhf_tn3270_resbyte,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase SF_OB_RESTART:\r\noffset += dissect_restart(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_OB_SELECT_COLOR_TABLE:\r\nproto_tree_add_item(sf_tree,\r\nhf_tn3270_color_command,\r\ntvb, offset,\r\n2,\r\nENC_BIG_ENDIAN);\r\noffset += 2;\r\nbreak;\r\ncase SF_OB_SET_CHECKPOINT_INTERVAL:\r\nproto_tree_add_item(sf_tree,\r\nhf_tn3270_resbyte,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(sf_tree,\r\nhf_tn3270_interval,\r\ntvb, offset,\r\n2,\r\nENC_BIG_ENDIAN);\r\noffset += 2;\r\nbreak;\r\ncase SF_OB_SET_MSR_CONTROL:\r\noffset += dissect_set_msr_control(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_OB_SET_PARTITION_CHARACTERISTICS:\r\noffset += dissect_set_partition_characteristics(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_OB_SET_PRINTER_CHARACTERISTICS:\r\noffset += dissect_set_printer_characteristics(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_OB_TYPE_1_TEXT_OUTBOUND:\r\noffset += dissect_type_1_text(sf_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ndefault:\r\nDISSECTOR_ASSERT_NOT_REACHED();\r\nbreak;\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\nprocess_outbound_inbound_structured_field(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ntn3270_conv_info_t *tn3270_info _U_, guint sf_id, gint sf_body_length)\r\n{\r\ngint start = offset;\r\nswitch (sf_id) {\r\ncase SF_OB_IB_DATA_CHAIN:\r\noffset += dissect_data_chain(tn3270_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_OB_IB_DESTINATION_OR_ORIGIN:\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_destination_or_origin_flags_input_control,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_resbyte,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_destination_or_origin_doid,\r\ntvb, offset,\r\n2,\r\nENC_BIG_ENDIAN);\r\noffset += 2;\r\nbreak;\r\ncase SF_OB_IB_OBJECT_DATA:\r\ncase SF_OB_IB_OBJECT_CONTROL:\r\ncase SF_OB_IB_OBJECT_PICTURE:\r\ncase SF_OB_IB_OEM_DATA:\r\noffset += dissect_object_control(tn3270_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_OB_IB_SAVE_OR_RESTORE_FORMAT:\r\noffset += dissect_save_or_restore_format(tn3270_tree, tvb, offset, sf_body_length);\r\nbreak;\r\ncase SF_OB_IB_SELECT_IPDS_MODE:\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_resbytes,\r\ntvb, offset,\r\n2,\r\nENC_BIG_ENDIAN);\r\noffset += 2;\r\nbreak;\r\ndefault:\r\nDISSECTOR_ASSERT_NOT_REACHED();\r\nbreak;\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic proto_tree *\r\ndisplay_sf_hdr(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset,\r\ngint sf_length, guint sf_id, guint sf_id_len, const gchar *sf_id_str)\r\n{\r\nproto_tree *sf_tree;\r\nsf_tree = proto_tree_add_subtree_format(tn3270_tree, tvb, offset, sf_length,\r\nett_sf, NULL, "Structured Field: %s", sf_id_str);\r\nproto_tree_add_item(sf_tree,\r\nhf_tn3270_sf_length,\r\ntvb, offset,\r\n2,\r\nENC_BIG_ENDIAN);\r\nproto_tree_add_uint_format_value(sf_tree,\r\n(sf_id_len == 1) ? hf_tn3270_sf_single_byte_id : hf_tn3270_sf_double_byte_id,\r\ntvb, offset+2, sf_id_len,\r\nsf_id, "%s (0x%0*x)", sf_id_str, sf_id_len*2, sf_id);\r\nreturn sf_tree;\r\n}\r\nstatic gint\r\ndissect_structured_fields(proto_tree *tn3270_tree, packet_info *pinfo, tvbuff_t *tvb, gint offset,\r\ntn3270_conv_info_t *tn3270_info, gboolean direction_inbound)\r\n{\r\nproto_tree *sf_tree;\r\ngint start;\r\ngint sf_length;\r\nguint sf_id;\r\nguint sf_id_len;\r\nconst gchar *sf_id_str;\r\nstart = offset;\r\nwhile (tvb_reported_length_remaining(tvb, offset) >= 2) {\r\nif ((sf_length = tvb_get_ntohs(tvb, offset)) == 0) {\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_null,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\ncontinue;\r\n}\r\nsf_id = tvb_get_guint8(tvb, offset+2);\r\nsf_id_len = 1;\r\nif ((sf_id == 0x0F) ||\r\n(sf_id == 0x10) ||\r\n(sf_id == 0x81)) {\r\nsf_id = (sf_id << 8) + tvb_get_guint8(tvb, offset+3);\r\nsf_id_len = 2;\r\n}\r\nsf_id_str = try_val_to_str(sf_id, direction_inbound ?\r\nvals_inbound_structured_fields : vals_outbound_structured_fields);\r\nif (sf_id_str != NULL) {\r\nsf_tree = display_sf_hdr(tn3270_tree, tvb, offset,\r\nsf_length, sf_id, sf_id_len, sf_id_str);\r\noffset += (sf_id_len + 2);\r\nif (direction_inbound) {\r\noffset += process_inbound_structured_field(sf_tree, tvb, offset, tn3270_info, sf_id, sf_length-2-sf_id_len);\r\n}\r\nelse {\r\noffset += process_outbound_structured_field(sf_tree, pinfo, tvb, offset, tn3270_info, sf_id, sf_length-2-sf_id_len);\r\n}\r\ncontinue;\r\n}\r\nsf_id_str = try_val_to_str(sf_id, vals_outbound_inbound_structured_fields);\r\nif (sf_id_str != NULL) {\r\nsf_tree = display_sf_hdr(tn3270_tree, tvb, offset,\r\nsf_length, sf_id, sf_id_len, sf_id_str);\r\noffset += (sf_id_len + 2);\r\noffset += process_outbound_inbound_structured_field(sf_tree, tvb, offset, tn3270_info, sf_id, sf_length-2-sf_id_len);\r\ncontinue;\r\n}\r\nsf_id_str = wmem_strdup_printf(wmem_packet_scope(), "Unknown [%0*x]", sf_id_len*2, sf_id);\r\ndisplay_sf_hdr(tn3270_tree, tvb, offset, sf_length,\r\nsf_length, sf_id_len, sf_id_str);\r\noffset += sf_length;\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_stop_address(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset)\r\n{\r\ngint start = offset;\r\ngint is_oc_ge;\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_stop_address,\r\ntvb, offset,\r\n2,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nis_oc_ge = tvb_get_guint8(tvb, offset);\r\nif (is_oc_ge != OC_GE) {\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_character_code,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_buffer_address(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset, gint hf, tn3270_conv_info_t *tn3270_info)\r\n{\r\ngint start = offset;\r\nguint16 buffer_addr;\r\nguint16 address_format, address_value;\r\nguint8 b1, b2;\r\nguint8 rowsx = tn3270_info->rows;\r\nguint8 colsx = tn3270_info->cols;\r\nbuffer_addr = tvb_get_ntohs(tvb, offset);\r\naddress_format = SBA_ADDRESS_FORMAT(buffer_addr);\r\naddress_value = SBA_ADDRESS_VALUE(buffer_addr);\r\nswitch (address_format) {\r\ncase SBA_14_BIT_BINARY:\r\nproto_tree_add_uint_format_value(tn3270_tree,\r\nhf,\r\ntvb, offset, 2,\r\nbuffer_addr,\r\n"14-bit address, %u = row %u, column %u [assuming a %ux%u display] (0x%04x)",\r\naddress_value,\r\n(address_value / colsx) + 1,\r\n(address_value % colsx) + 1,\r\nrowsx, colsx,\r\nbuffer_addr);\r\nbreak;\r\ncase SBA_12_BIT_CODED_1:\r\ncase SBA_12_BIT_CODED_2:\r\nb1 = (address_value >> 8) & 0x3F;\r\nb2 = (address_value >> 0) & 0x3F;\r\naddress_value = (b1 << 6) | b2;\r\nproto_tree_add_uint_format_value(tn3270_tree,\r\nhf,\r\ntvb, offset, 2,\r\nbuffer_addr,\r\n"12-bit address, %u = row %u, column %u [assuming a %ux%u display] (0x%04x)",\r\naddress_value,\r\n(address_value / colsx) + 1,\r\n(address_value % colsx) + 1,\r\nrowsx, colsx,\r\nbuffer_addr);\r\nbreak;\r\ncase SBA_RESERVED:\r\nproto_tree_add_uint_format_value(tn3270_tree,\r\nhf,\r\ntvb, offset, 2,\r\nbuffer_addr,\r\n"Reserved (0x%04x)",\r\nbuffer_addr);\r\nbreak;\r\n}\r\noffset += 2;\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_field_attribute_pair(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset)\r\n{\r\ngint start = offset;\r\ngint attribute_type;\r\nattribute_type = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_attribute_type,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nswitch (attribute_type) {\r\ncase AT_ALL_CHARACTER_ATTRIBUTES:\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_all_character_attributes,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase AT_T3270_FIELD_ATTRIBUTE:\r\noffset += dissect_3270_field_attribute(tn3270_tree, tvb, offset);\r\nbreak;\r\ncase AT_EXTENDED_HIGHLIGHTING:\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_extended_highlighting,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase AT_FOREGROUND_COLOR:\r\ncase AT_BACKGROUND_COLOR:\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_color,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase AT_CHARACTER_SET:\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_character_set,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase AT_FIELD_OUTLINING:\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_field_outlining,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase AT_TRANSPARENCY:\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_transparency,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase AT_FIELD_VALIDATION:\r\noffset += dissect_3270_field_validation(tn3270_tree, tvb, offset);\r\nbreak;\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_field_attribute_pairs(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset)\r\n{\r\ngint start = offset;\r\ngint no_of_pairs;\r\ngint i;\r\nno_of_pairs = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_number_of_attributes,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nfor (i=0; i < no_of_pairs; i++) {\r\noffset += dissect_field_attribute_pair(tn3270_tree, tvb, offset);\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_orders_and_data(proto_tree *tn3270_tree, packet_info *pinfo, tvbuff_t *tvb, gint offset, tn3270_conv_info_t *tn3270_info)\r\n{\r\ngint start = offset;\r\ngint order_code;\r\nproto_item* item;\r\nwhile (tvb_reported_length_remaining(tvb, offset) > 0) {\r\norder_code = tvb_get_guint8(tvb, offset);\r\nif ((order_code > 0) && (order_code <= OC_MAX)) {\r\nitem = proto_tree_add_item(tn3270_tree,\r\nhf_tn3270_order_code,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nswitch (order_code) {\r\ncase OC_SF:\r\noffset += dissect_3270_field_attribute(tn3270_tree, tvb, offset);\r\nbreak;\r\ncase OC_MF:\r\ncase OC_SFE:\r\noffset += dissect_field_attribute_pairs(tn3270_tree, tvb, offset);\r\nbreak;\r\ncase OC_SA:\r\noffset += dissect_field_attribute_pair(tn3270_tree, tvb, offset);\r\nbreak;\r\ncase OC_EUA:\r\ncase OC_RA:\r\noffset += dissect_stop_address(tn3270_tree, tvb, offset);\r\nbreak;\r\ncase OC_GE:\r\nproto_tree_add_item(tn3270_tree,\r\nhf_tn3270_character_code,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nbreak;\r\ncase OC_SBA:\r\noffset += dissect_buffer_address(tn3270_tree, tvb, offset, hf_tn3270_buffer_address, tn3270_info);\r\nbreak;\r\ncase OC_PT:\r\ncase OC_IC:\r\nbreak;\r\ndefault:\r\nexpert_add_info(pinfo, item, &ei_tn3270_order_code);\r\nbreak;\r\n}\r\n}\r\nelse {\r\noffset += add_data_until_next_order_code(tn3270_tree, tvb, offset);\r\n}\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_tn3270e_header(proto_tree *tn3270_tree, tvbuff_t *tvb, gint offset)\r\n{\r\nproto_item *pi;\r\nproto_tree *tn3270e_hdr_tree;\r\ngint start = offset;\r\ngint data_type;\r\nstatic const hf_items fields[] = {\r\n{ &hf_tn3270_tn3270e_data_type, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ &hf_tn3270_tn3270e_request_flag, NULL, 1, NULL, ENC_BIG_ENDIAN },\r\n{ NULL, NULL, 0, NULL, 0 }\r\n};\r\ndata_type = tvb_get_guint8(tvb, offset);\r\ntn3270e_hdr_tree = proto_tree_add_subtree_format(tn3270_tree, tvb, offset, -1,\r\nett_tn3270e_hdr, &pi, "TN3270E Header (Data Type: %s)",\r\nval_to_str_const(data_type, vals_tn3270_header_data_types, "Unknown"));\r\noffset += tn3270_add_hf_items(tn3270e_hdr_tree, tvb, offset,\r\nfields);\r\nswitch(data_type) {\r\ncase TN3270E_3270_DATA:\r\ncase TN3270E_SCS_DATA:\r\nproto_tree_add_item(tn3270e_hdr_tree, hf_tn3270_tn3270e_response_flag_3270_SCS, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase TN3270E_RESPONSE:\r\nproto_tree_add_item(tn3270e_hdr_tree, hf_tn3270_tn3270e_response_flag_response, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase TN3270E_BIND_IMAGE:\r\ncase TN3270E_NVT_DATA:\r\ncase TN3270E_REQUEST:\r\ncase TN3270E_SSCP_LU_DATA:\r\ncase TN3270E_UNBIND:\r\ndefault:\r\nproto_tree_add_item(tn3270e_hdr_tree, hf_tn3270_tn3270e_response_flag_unused, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\noffset += 1;\r\nproto_tree_add_item(tn3270e_hdr_tree, hf_tn3270_tn3270e_seq_number, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nswitch (data_type) {\r\ncase TN3270E_BIND_IMAGE:\r\ncase TN3270E_NVT_DATA:\r\ncase TN3270E_REQUEST:\r\ncase TN3270E_RESPONSE:\r\ncase TN3270E_SCS_DATA:\r\ncase TN3270E_SSCP_LU_DATA:\r\ncase TN3270E_UNBIND:\r\nproto_tree_add_item(tn3270e_hdr_tree, hf_tn3270_tn3270e_header_data, tvb, offset, -1, ENC_EBCDIC|ENC_NA);\r\noffset += tvb_reported_length_remaining(tvb, offset);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nproto_item_set_len(pi, offset - start);\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_outbound_stream(proto_tree *tn3270_tree, packet_info *pinfo, tvbuff_t *tvb, gint offset, tn3270_conv_info_t *tn3270_info)\r\n{\r\ngint command_code;\r\ngint start = offset;\r\nproto_item* item;\r\ncommand_code = tvb_get_guint8(tvb, offset);\r\nswitch (command_code) {\r\ncase CC_LCL_EW:\r\ncase CC_RMT_EW:\r\ntn3270_info->rows = 24;\r\ntn3270_info->cols = 80;\r\nbreak;\r\ncase CC_LCL_EWA:\r\ncase CC_RMT_EWA:\r\ntn3270_info->rows = tn3270_info->altrows;\r\ntn3270_info->cols = tn3270_info->altcols;\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nitem = proto_tree_add_item(tn3270_tree,\r\nhf_tn3270_command_code,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nswitch (command_code) {\r\ncase CC_LCL_W:\r\ncase CC_LCL_EW:\r\ncase CC_LCL_EWA:\r\ncase CC_LCL_EAU:\r\ncase CC_RMT_W:\r\ncase CC_RMT_EW:\r\ncase CC_RMT_EWA:\r\ncase CC_RMT_EAU:\r\noffset += dissect_wcc(tn3270_tree, tvb, offset);\r\noffset += dissect_orders_and_data(tn3270_tree, pinfo, tvb, offset, tn3270_info);\r\nbreak;\r\ncase CC_LCL_WSF:\r\ncase CC_RMT_WSF:\r\noffset += dissect_structured_fields(tn3270_tree, pinfo, tvb, offset, tn3270_info, FALSE);\r\nbreak;\r\ncase CC_LCL_RB:\r\ncase CC_LCL_RM:\r\ncase CC_LCL_RMA:\r\ncase CC_RMT_RB:\r\ncase CC_RMT_RM:\r\ncase CC_RMT_RMA:\r\nbreak;\r\ndefault:\r\nexpert_add_info(pinfo, item, &ei_tn3270_command_code);\r\nbreak;\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic gint\r\ndissect_inbound_stream(proto_tree *tn3270_tree, packet_info *pinfo, tvbuff_t *tvb, gint offset, tn3270_conv_info_t *tn3270_info)\r\n{\r\ngint start = offset;\r\ngint aid;\r\nproto_item* item;\r\naid = tvb_get_guint8(tvb, offset);\r\nitem = proto_tree_add_item(tn3270_tree,\r\nhf_tn3270_aid,\r\ntvb, offset,\r\n1,\r\nENC_BIG_ENDIAN);\r\noffset += 1;\r\nswitch (aid) {\r\ncase AID_STRUCTURED_FIELD:\r\noffset += dissect_structured_fields(tn3270_tree, pinfo, tvb, offset, tn3270_info, TRUE);\r\nbreak;\r\ncase AID_PA1_KEY:\r\ncase AID_PA2_KEY_CNCL:\r\ncase AID_PA3_KEY:\r\ncase AID_CLEAR_KEY:\r\nif (tvb_reported_length_remaining(tvb, offset) <= 0)\r\nbreak;\r\ncase AID_READ_PARTITION_AID:\r\ncase AID_NO_AID_GENERATED:\r\ncase AID_NO_AID_GENERATED_PRINTER_ONLY:\r\ncase AID_TRIGGER_ACTION:\r\ncase AID_TEST_REQ_AND_SYS_REQ:\r\ncase AID_PF1_KEY:\r\ncase AID_PF2_KEY:\r\ncase AID_PF3_KEY:\r\ncase AID_PF4_KEY:\r\ncase AID_PF5_KEY:\r\ncase AID_PF6_KEY:\r\ncase AID_PF7_KEY:\r\ncase AID_PF8_KEY:\r\ncase AID_PF9_KEY:\r\ncase AID_PF10_KEY:\r\ncase AID_PF11_KEY:\r\ncase AID_PF12_KEY:\r\ncase AID_PF13_KEY:\r\ncase AID_PF14_KEY:\r\ncase AID_PF15_KEY:\r\ncase AID_PF16_KEY:\r\ncase AID_PF17_KEY:\r\ncase AID_PF18_KEY:\r\ncase AID_PF19_KEY:\r\ncase AID_PF20_KEY:\r\ncase AID_PF21_KEY:\r\ncase AID_PF22_KEY:\r\ncase AID_PF23_KEY:\r\ncase AID_PF24_KEY:\r\ncase AID_CLEAR_PARTITION_KEY:\r\ncase AID_ENTER_KEY:\r\ncase AID_SELECTOR_PEN_ATTENTION:\r\ncase AID_OPERATOR_ID_READER:\r\ncase AID_MAG_READER_NUMBER:\r\noffset += dissect_buffer_address(tn3270_tree, tvb, offset, hf_tn3270_cursor_address, tn3270_info);\r\noffset += dissect_orders_and_data(tn3270_tree, pinfo, tvb, offset, tn3270_info);\r\nbreak;\r\ndefault:\r\nexpert_add_info(pinfo, item, &ei_tn3270_aid);\r\noffset += 1;\r\nbreak;\r\n}\r\nreturn (offset - start);\r\n}\r\nstatic int\r\ndissect_tn3270(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nproto_tree *tn3270_tree;\r\nproto_item *pi;\r\ngint offset = 0;\r\nconversation_t *conversation;\r\ntn3270_conv_info_t *tn3270_info = NULL;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "TN3270");\r\npinfo->fd->flags.encoding = PACKET_CHAR_ENC_CHAR_EBCDIC;\r\nconversation = find_conversation(pinfo->num, &pinfo->src, &pinfo->dst,\r\npinfo->ptype, pinfo->srcport,\r\npinfo->destport, 0);\r\nif (conversation != NULL) {\r\ntn3270_info = (tn3270_conv_info_t *)conversation_get_proto_data(conversation, proto_tn3270);\r\n}\r\nif (tn3270_info == NULL)\r\nreturn 0;\r\npi = proto_tree_add_item(tree, proto_tn3270, tvb, offset, -1, ENC_NA);\r\ntn3270_tree = proto_item_add_subtree(pi, ett_tn3270);\r\ncol_clear(pinfo->cinfo, COL_INFO);\r\nif (tn3270_info->extended) {\r\noffset += dissect_tn3270e_header(tn3270_tree, tvb, offset);\r\n}\r\nif (tvb_reported_length_remaining(tvb, offset) <= 0)\r\nreturn offset;\r\nif (pinfo->srcport == tn3270_info->outbound_port) {\r\ncol_set_str(pinfo->cinfo, COL_INFO, "TN3270 Data from Mainframe");\r\n}\r\nelse {\r\ncol_set_str(pinfo->cinfo, COL_INFO, "TN3270 Data to Mainframe");\r\n}\r\nif(tree) {\r\nwhile (tvb_reported_length_remaining(tvb, offset) > 0) {\r\nif (pinfo->srcport == tn3270_info->outbound_port) {\r\noffset += dissect_outbound_stream(tn3270_tree, pinfo, tvb, offset, tn3270_info);\r\n}\r\nelse {\r\noffset += dissect_inbound_stream(tn3270_tree, pinfo, tvb, offset, tn3270_info);\r\n}\r\n}\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nadd_tn3270_conversation(packet_info *pinfo, int tn3270e, gint model)\r\n{\r\nconversation_t *conversation;\r\ntn3270_conv_info_t *tn3270_info;\r\nconversation = find_or_create_conversation(pinfo);\r\ntn3270_info = (tn3270_conv_info_t *)conversation_get_proto_data(conversation, proto_tn3270);\r\nif (tn3270_info == NULL) {\r\ntn3270_info = wmem_new(wmem_file_scope(), tn3270_conv_info_t);\r\ncopy_address(&(tn3270_info->outbound_addr), &(pinfo->dst));\r\ntn3270_info->outbound_port = pinfo->destport;\r\ncopy_address(&(tn3270_info->inbound_addr), &(pinfo->src));\r\ntn3270_info->inbound_port = pinfo->srcport;\r\nconversation_add_proto_data(conversation, proto_tn3270, tn3270_info);\r\n}\r\nswitch (model) {\r\ndefault:\r\ncase 2:\r\ntn3270_info->altrows = 24;\r\ntn3270_info->altcols = 80;\r\nbreak;\r\ncase 3:\r\ntn3270_info->altrows = 32;\r\ntn3270_info->altcols = 80;\r\nbreak;\r\ncase 4:\r\ntn3270_info->altrows = 43;\r\ntn3270_info->altcols = 80;\r\nbreak;\r\ncase 5:\r\ntn3270_info->altrows = 27;\r\ntn3270_info->altcols = 132;\r\nbreak;\r\n}\r\ntn3270_info->rows = 24;\r\ntn3270_info->cols = 80;\r\ntn3270_info->extended = tn3270e;\r\n}\r\nint\r\nfind_tn3270_conversation(packet_info *pinfo)\r\n{\r\nconversation_t *conversation = NULL;\r\ntn3270_conv_info_t *tn3270_info = NULL;\r\nconversation = find_conversation(pinfo->num, &pinfo->src, &pinfo->dst,\r\npinfo->ptype, pinfo->srcport,\r\npinfo->destport, 0);\r\nif (conversation != NULL) {\r\ntn3270_info = (tn3270_conv_info_t *)conversation_get_proto_data(conversation, proto_tn3270);\r\nif (tn3270_info != NULL) {\r\nreturn 1;\r\n}\r\n}\r\nreturn 0;\r\n}\r\nvoid\r\nproto_register_tn3270(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_tn3270_command_code,\r\n{ "Command Code",\r\n"tn3270.command_code",\r\nFT_UINT8, BASE_HEX, VALS(vals_command_codes), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_sf_length,\r\n{ "Structured Field Length",\r\n"tn3270.sf_length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_wcc_nop,\r\n{ "WCC NOP",\r\n"tn3270.wcc.nop",\r\nFT_BOOLEAN, 8, NULL, WCC_NOP,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_wcc_reset,\r\n{ "WCC Reset",\r\n"tn3270.wcc.reset",\r\nFT_BOOLEAN, 8, NULL, WCC_RESET,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_wcc_printer1,\r\n{ "WCC Printer1",\r\n"tn3270.wcc.printer1",\r\nFT_BOOLEAN, 8, NULL, WCC_PRINTER1,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_wcc_printer2,\r\n{ "WCC Printer2",\r\n"tn3270.wcc.printer2",\r\nFT_BOOLEAN, 8, NULL, WCC_PRINTER2,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_wcc_start_printer,\r\n{ "WCC Start Printer",\r\n"tn3270.wcc.start_printer",\r\nFT_BOOLEAN, 8, NULL, WCC_START_PRINTER,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_wcc_sound_alarm,\r\n{ "WCC Sound Alarm",\r\n"tn3270.wcc.sound_alarm",\r\nFT_BOOLEAN, 8, NULL, WCC_SOUND_ALARM,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_wcc_keyboard_restore,\r\n{ "WCC Keyboard Restore",\r\n"tn3270.wcc.keyboard_restore",\r\nFT_BOOLEAN, 8, NULL, WCC_KEYBOARD_RESTORE,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_wcc_reset_mdt,\r\n{ "WCC Reset MDT",\r\n"tn3270.wcc.reset_mdt",\r\nFT_BOOLEAN, 8, NULL, WCC_RESET_MDT,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ccc,\r\n{ "Copy Control Code",\r\n"tn3270.ccc",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ccc_coding,\r\n{ "Coding",\r\n"tn3270.ccc_coding",\r\nFT_UINT8, BASE_HEX, NULL, CCC_GRAPHIC_CONVERT_MASK,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ccc_printout,\r\n{ "Printout Format",\r\n"tn3270.ccc_printout",\r\nFT_UINT8, BASE_HEX, VALS(ccc_vals_printout_format), CCC_PRINT_BITS_MASK,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ccc_start_print,\r\n{ "The start-print bit",\r\n"tn3270.ccc_start_print",\r\nFT_BOOLEAN, 8, NULL, CCC_START_PRINT,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ccc_sound_alarm,\r\n{ "The sound-alarm bit",\r\n"tn3270.ccc_sound_alarm",\r\nFT_BOOLEAN, 8, NULL, CCC_SOUND_ALARM,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ccc_copytype,\r\n{ "Type of Data to be Copied",\r\n"tn3270.ccc_copytype",\r\nFT_UINT8, BASE_HEX, VALS(ccc_vals_copytype), CCC_ATTRIBUTE_BITS_MASK,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_field_attribute,\r\n{ "3270 Field Attribute",\r\n"tn3270.field_attribute",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_fa_graphic_convert,\r\n{ "Graphic Convert",\r\n"tn3270.fa.graphic_convert",\r\nFT_UINT8, BASE_HEX, NULL, FA_GRAPHIC_CONVERT_MASK,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_fa_protected,\r\n{ "Protected",\r\n"tn3270.fa.protected",\r\nFT_BOOLEAN, 8, NULL, FA_PROTECTED,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_fa_numeric,\r\n{ "Numeric",\r\n"tn3270.fa.numeric",\r\nFT_BOOLEAN, 8, NULL, FA_NUMERIC,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_fa_display,\r\n{ "Display",\r\n"tn3270.fa.display",\r\nFT_UINT8, BASE_HEX, VALS(vals_fa_display), FA_DISPLAY_BITS_MASK,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_fa_reserved,\r\n{ "Reserved",\r\n"tn3270.fa.reserved",\r\nFT_BOOLEAN, 8, NULL, FA_RESERVED,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_fa_modified,\r\n{ "Modified",\r\n"tn3270.fa.modified",\r\nFT_BOOLEAN, 8, NULL, FA_MODIFIED,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_order_code,\r\n{ "Order Code",\r\n"tn3270.order_code",\r\nFT_UINT8, BASE_HEX, VALS(vals_order_codes), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_character_code,\r\n{ "Character Code",\r\n"tn3270.character_code",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_stop_address,\r\n{ "Stop Address",\r\n"tn3270.stop_address",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_attribute_type,\r\n{ "Attribute Type",\r\n"tn3270.attribute_type",\r\nFT_UINT8, BASE_HEX, VALS(vals_attribute_types), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_extended_highlighting,\r\n{ "Extended Highlighting",\r\n"tn3270.extended_highlighting",\r\nFT_UINT8, BASE_HEX, VALS(vals_at_extended_highlighting), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_color,\r\n{ "Color",\r\n"tn3270.color",\r\nFT_UINT8, BASE_HEX, VALS(vals_at_color_identifications), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_character_set,\r\n{ "Character Set",\r\n"tn3270.character_set",\r\nFT_UINT8, BASE_RANGE_STRING|BASE_HEX, RVALS(rvals_at_character_set), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_field_outlining,\r\n{ "Field Outlining",\r\n"tn3270.field_outlining",\r\nFT_UINT8, BASE_HEX, VALS(vals_at_field_outlining), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_transparency,\r\n{ "Transparency",\r\n"tn3270.transparency",\r\nFT_UINT8, BASE_HEX, VALS(vals_at_transparency), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_field_validation_mandatory_fill,\r\n{ "3270 Field validation_mandatory_fill",\r\n"tn3270.field_validation_mandatory_fill",\r\nFT_BOOLEAN, 8, TFS(&tn3270_field_validation_mandatory_fill), AT_FV_MANDATORY_FILL,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_field_validation_mandatory_entry,\r\n{ "3270 Field validation_mandatory_entry",\r\n"tn3270.field_validation_mandatory_entry",\r\nFT_BOOLEAN, 8, TFS(&tn3270_field_validation_mandatory_entry), AT_FV_MANDATORY_ENTRY,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_field_validation_trigger,\r\n{ "3270 Field validation_trigger",\r\n"tn3270.field_validation_trigger",\r\nFT_BOOLEAN, 8, TFS(&tn3270_field_validation_trigger), AT_FV_TRIGGER,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_all_character_attributes,\r\n{ "all_character_attributes",\r\n"tn3270.all_character_attributes",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_aid,\r\n{ "Attention Identification",\r\n"tn3270.aid",\r\nFT_UINT8, BASE_HEX, VALS(vals_attention_identification_bytes), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_buffer_address,\r\n{ "Buffer Address",\r\n"tn3270.buffer_address",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_sdp_ln,\r\n{ "Length of this Self-Defining Parameter",\r\n"tn3270.sdp_ln",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_sdp_id,\r\n{ "Self-Defining Parameter ID",\r\n"tn3270.sdp_id",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_begin_end_flags1,\r\n{ "Begin End Flags1",\r\n"tn3270.begin_end_flags1",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_begin_end_flags2,\r\n{ "Begin End Flags2",\r\n"tn3270.begin_end_flags2",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_partition_id,\r\n{ "Partition ID",\r\n"tn3270.partition_id",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_partition_uom,\r\n{ "The unit of measure and address mode",\r\n"tn3270.partition_uom",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_partition_flags,\r\n{ "Flags",\r\n"tn3270.partition_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_partition_height,\r\n{ "The height of the presentation space",\r\n"tn3270.partition_height",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_partition_width,\r\n{ "The width of the presentation space",\r\n"tn3270.partition_width",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_partition_rv,\r\n{ "The y, or row, origin of the viewport relative to the top edge of the usable area",\r\n"tn3270.partition_rv",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_partition_cv,\r\n{ "The x, or column, origin of the viewport relative to the left side of the usable area",\r\n"tn3270.partition_cv",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_partition_hv,\r\n{ "The height of the viewport",\r\n"tn3270.partition_hv",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_partition_wv,\r\n{ "The width of the viewport",\r\n"tn3270.partition_wv",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_partition_rw,\r\n{ "The y, or row, origin of the window relative to the top edge of the presentation space",\r\n"tn3270.partition_rw",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_partition_cw,\r\n{ "The x, or column, origin of the window relative to the left edge of the presentation space",\r\n"tn3270.partition_cw",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_partition_rs,\r\n{ "The number of units to be scrolled in a vertical multiple scroll",\r\n"tn3270.partition_rs",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_partition_res,\r\n{ "Reserved",\r\n"tn3270.partition_res",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_partition_pw,\r\n{ "The number of points in the horizontal direction in a character cell in this presentation space",\r\n"tn3270.partition_pw",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_partition_ph,\r\n{ "The number of points in the vertical direction in a character cell in this presentation space",\r\n"tn3270.partition_ph",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_partition_command,\r\n{ "Partition Command",\r\n"tn3270.partition_command",\r\nFT_UINT8, BASE_HEX, VALS(vals_command_codes), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_erase_flags,\r\n{ "Erase Flags",\r\n"tn3270.erase_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_load_color_command,\r\n{ "Command",\r\n"tn3270.load_color_command",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_load_format_storage_flags1,\r\n{ "Flags",\r\n"tn3270.load_format_storage_flags1",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_load_format_storage_flags2,\r\n{ "Flags (Reserved)",\r\n"tn3270.load_format_storage_flags2",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_load_format_storage_operand,\r\n{ "Operand:",\r\n"tn3270.load_format_storage_operand",\r\nFT_UINT8, BASE_HEX, VALS(vals_load_storage_format_operand), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_load_format_storage_localname,\r\n{ "Local name for user selectable formats",\r\n"tn3270.load_format_storage_localname",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_format_group,\r\n{ "Format Group name",\r\n"tn3270.format_group_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_format_name,\r\n{ "Format name",\r\n"tn3270.format_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_load_format_storage_format_data,\r\n{ "Format data",\r\n"tn3270.load_format_storage_format_data",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_tn3270_load_line_type_command,\r\n{ "Line Type Command",\r\n"tn3270.load_line_type_command",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ps_flags,\r\n{ "Flags",\r\n"tn3270.ps_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ps_lcid,\r\n{ "Local character set ID",\r\n"tn3270.ps_lcid",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ps_char,\r\n{ "Beginning code point X'41' through X'FE'",\r\n"tn3270.ps_char",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ps_rws,\r\n{ "Loadable Character Set RWS Number",\r\n"tn3270.ps_rws",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_extended_ps_length,\r\n{ "Length of parameters for extended form, including the length parameter",\r\n"tn3270.extended_ps_length",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_extended_ps_flags,\r\n{ "Flags",\r\n"tn3270.extended_ps_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_extended_ps_lw,\r\n{ "Number of X-units in character cell (width of character matrixes)",\r\n"tn3270.extended_ps_lw",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_extended_ps_lh,\r\n{ "Number of Y-units in character cell (depth ofcharacter matrixes)",\r\n"tn3270.extended_ps_lh",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_extended_ps_subsn,\r\n{ "Subsection ID",\r\n"tn3270.extended_ps_subsn",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_extended_ps_color,\r\n{ "Color planes",\r\n"tn3270.extended_ps_color",\r\nFT_UINT8, BASE_HEX, VALS(vals_at_color_identifications), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_extended_ps_stsubs,\r\n{ "Starting Subsection Identifier",\r\n"tn3270.extended_ps_stsubs",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_extended_ps_echar,\r\n{ "Ending code point",\r\n"tn3270.extended_ps_echar",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_extended_ps_nw,\r\n{ "Number of width pairs",\r\n"tn3270.extended_ps_nw",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_extended_ps_nh,\r\n{ "Number of height pairs",\r\n"tn3270.extended_ps_nh",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_extended_ps_res,\r\n{ "Reserved",\r\n"tn3270.extended_ps_res",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_outbound_text_header_operation_type,\r\n{ "Outbound Text Operation Type",\r\n"tn3270.outbound_text_operation_type",\r\nFT_UINT8, BASE_HEX, VALS(vals_command_codes), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_lvl,\r\n{ "Cursor level",\r\n"tn3270.lvl",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_cro,\r\n{ "Cursor row offset",\r\n"tn3270.cro",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_cc,\r\n{ "Cursor column offset",\r\n"tn3270.cc",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_outbound_text_header_lhdr,\r\n{ "Header length includes itself",\r\n"tn3270.outbound_text_header_lhdr",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_outbound_text_header_hdr,\r\n{ "Initial format controls",\r\n"tn3270.outbound_text_header_hdr",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_bsc,\r\n{ "SNA BSC",\r\n"tn3270.bsc",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_fpc,\r\n{ "Format Presentation Command",\r\n"tn3270.fpc",\r\nFT_UINT8, BASE_HEX, VALS(vals_command_codes), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_fov,\r\n{ "Format Offset Value",\r\n"tn3270.fov",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_read_partition_operation_type,\r\n{ "Read Partition Operation Type",\r\n"tn3270.read_partition_reqtyp",\r\nFT_UINT8, BASE_HEX, VALS(vals_read_partition_operation_type), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_read_partition_reqtyp,\r\n{ "Read Partition Request Type",\r\n"tn3270.read_partition_reqtyp",\r\nFT_UINT8, BASE_HEX, VALS(vals_read_partition_reqtype), READ_PARTITION_REQTYPE_MASK,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_start_page,\r\n{ "Number of pages to skip on restart",\r\n"tn3270.start_page",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_start_line,\r\n{ "Number of lines to skip on page for restart",\r\n"tn3270.start_line",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_scs_data,\r\n{ "SCS data (noncompressed and noncompacted) to set up for restart",\r\n"tn3270.scs_data",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_color_command,\r\n{ "Color Command",\r\n"tn3270.color_command",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_interval,\r\n{ "Checkpoint interval",\r\n"tn3270.interval",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\n"Specifies the number of pages in the interval between terminal checkpoints", HFILL }\r\n},\r\n{ &hf_tn3270_msr_type,\r\n{ "MSR type",\r\n"tn3270.msr_type",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_msr_state_mask,\r\n{ "State Mask",\r\n"tn3270.msr_state_mask",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_msr_user,\r\n{ "User Mode",\r\n"tn3270.msr.user",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_msr_locked,\r\n{ "Locked",\r\n"tn3270.msr.locked",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_msr_auto,\r\n{ "Auto Enter",\r\n"tn3270.msr.auto",\r\nFT_BOOLEAN, 8, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_msr_ind1,\r\n{ "Audible Ind 1 Suppress",\r\n"tn3270.msr.ind1",\r\nFT_BOOLEAN, 8, NULL, 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_msr_ind2,\r\n{ "Audible Ind 2 Suppress",\r\n"tn3270.msr.ind2",\r\nFT_BOOLEAN, 8, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_msr_state_value,\r\n{ "State Value", "tn3270.msr_state_value",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_msr_ind_mask,\r\n{ "Indicator Mask",\r\n"tn3270.msr_ind_mask",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_msr_ind_value,\r\n{ "Indicator Value",\r\n"tn3270.msr_ind_value",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_spc_sdp_ot,\r\n{ "Top edge outline thickness",\r\n"tn3270.spc_sdp_ot",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_spc_sdp_ob,\r\n{ "Bottom edge outline thickness",\r\n"tn3270.spc_sdp_ob",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_spc_sdp_ol,\r\n{ "Left edge outline thickness",\r\n"tn3270.spc_sdp_ol",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_spc_sdp_or,\r\n{ "Right edge outline thickness",\r\n"tn3270.spc_sdp_or",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_spc_sdp_eucflags,\r\n{ "Flags",\r\n"tn3270.spc_sdp_eucflags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_printer_flags,\r\n{ "Flags",\r\n"tn3270.printer_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_spc_sdp_srepc,\r\n{ "Set/Reset Early Print Complete",\r\n"tn3270.spc_sdp_srepc",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_mode,\r\n{ "Mode",\r\n"tn3270.mode",\r\nFT_UINT8, BASE_HEX, VALS(vals_reply_modes), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_reply_mode_attr_list,\r\n{ "Type codes for the attribute types",\r\n"tn3270.reply_mode_attr_list",\r\nFT_UINT8, BASE_HEX, VALS(vals_attribute_types), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_data_chain_fields,\r\n{ "Data Chain Fields",\r\n"tn3270.data_chain_fields",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_data_chain_group,\r\n{ "Data Chain Group",\r\n"tn3270.data_chain_group",\r\nFT_UINT8, BASE_HEX, VALS(vals_data_chain_group), DATA_CHAIN_GROUP_MASK,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_data_chain_inbound_control,\r\n{ "Data Chain Inbound Control",\r\n"tn3270.data_chain_inbound_control",\r\nFT_UINT8, BASE_HEX, VALS(vals_data_chain_inbound_control), DATA_CHAIN_INBOUND_CONTROL_MASK,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_destination_or_origin_flags_input_control,\r\n{ "Input Control",\r\n"tn3270.destination_or_origin_flags_input_control",\r\nFT_UINT8, BASE_HEX, VALS(vals_destination_or_origin_flags_input_control), DESTINATION_OR_ORIGIN_FLAGS_INPUT_CONTROL_MASK,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_destination_or_origin_doid,\r\n{ "DOID",\r\n"tn3270.destination_or_origin_doid",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_object_control_flags,\r\n{ "Flags",\r\n"tn3270.object_control_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_object_type,\r\n{ "Object Type",\r\n"tn3270.object_type",\r\nFT_UINT8, BASE_HEX, VALS(vals_oc_type), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_save_or_restore_format_flags,\r\n{ "Flags",\r\n"tn3270.save_or_restore_format_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_srf_fpcb,\r\n{ "Contents of the FPCB that is to be saved or restored",\r\n"tn3270.srf_fpcb",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_type_1_text_outbound_data,\r\n{ "Type 1 text outbound data",\r\n"tn3270.type_1_text_outbound_data",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_exception_or_status_flags,\r\n{ "Flags",\r\n"tn3270.exception_or_status_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_sdp_excode,\r\n{ "Exception Code",\r\n"tn3270.sdp_excode",\r\nFT_UINT16, BASE_DEC, VALS(vals_sdp_excode), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_sdp_statcode,\r\n{ "Status Code",\r\n"tn3270.sdp_statcode",\r\nFT_UINT16, BASE_DEC, VALS(vals_sdp_statcode), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_sdp_ngl,\r\n{ "Number of groups currently assigned",\r\n"tn3270.sdp_ngl",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_sdp_nml,\r\n{ "Number of formats currently loaded",\r\n"tn3270.sdp_nml",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_sdp_nlml,\r\n{ "Number of local names used",\r\n"tn3270.sdp_nlml",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_sdp_stor,\r\n{ "Amount of format storage space available (KB)",\r\n"tn3270.sdp_stor",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_hw,\r\n{ "Window height",\r\n"tn3270.hw",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_rw,\r\n{ "Row offset of window origin",\r\n"tn3270.rw",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ww,\r\n{ "Window width",\r\n"tn3270.ww",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_cw,\r\n{ "Column Offset of Window Origin",\r\n"tn3270.cw",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_cursor_address,\r\n{ "Cursor Address",\r\n"tn3270.cursor_address",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_recovery_data_flags,\r\n{ "Flags",\r\n"tn3270.recovery_data_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_sld,\r\n{ "SLD -- Set line density parameter in effect at the checkpoint",\r\n"tn3270.sld",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_charset,\r\n{ "Character set parameter of Set Attribute control in effect at the checkpoint",\r\n"tn3270.charset",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_vertical,\r\n{ "Byte offset from Checkpoint Interval structured field to the Set Vertical Format control in effect for the checkpoint",\r\n"tn3270.vertical",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_v_offset,\r\n{ "Byte offset within the string control byte string or the SVF character",\r\n"tn3270.v_offset",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_v_sequence,\r\n{ "RU sequence number",\r\n"tn3270.v_sequence",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_v_length,\r\n{ "Length of the SVF character string required for restart",\r\n"tn3270.v_length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_spd,\r\n{ "Set Primary Density parameter in effect at the checkpoint",\r\n"tn3270.spd",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_horizon,\r\n{ "Byte offset from Checkpoint Interval structured field to the Set Horizontal Format control in effect for the checkpoint",\r\n"tn3270.horizon",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_h_offset,\r\n{ "Byte offset from Checkpoint Interval structured field to the Set Horizontal Format control in effect for the checkpoint",\r\n"tn3270.h_offset",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_h_sequence,\r\n{ "RU sequence number",\r\n"tn3270.h_sequence",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_h_length,\r\n{ "Length of the SHF character string required for restart",\r\n"tn3270.h_length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_hilite,\r\n{ "Highlighting",\r\n"tn3270.hilite",\r\nFT_UINT8, BASE_HEX, VALS(vals_at_extended_highlighting), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_pages,\r\n{ "Number of pages printed since the checkpoint",\r\n"tn3270.pages",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_lines,\r\n{ "Number of lines printed since the checkpoint",\r\n"tn3270.lines",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_checkpoint,\r\n{ "Byte offset from Set Checkpoint Interval structured field to the first"\r\n" character afterhe code point or character that caused an eject to the"\r\n" checkpointed page",\r\n"tn3270.checkpoint",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_c_offset,\r\n{ "Byte offset within the String Control Byte string or structured field of"\r\n" the checkpointed character",\r\n"tn3270.c_offset",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_c_sequence,\r\n{ "RU sequence number of the RU containing the checkpoint character",\r\n"tn3270.c_sequence",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_c_seqoff,\r\n{ "Byte offset within the RU of the checkpointed character",\r\n"tn3270.c_seqoff",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_c_scsoff,\r\n{ "Byte offset within the parameterized SCS control code (for example, TRN) of the checkpointed character.",\r\n"tn3270.c_scsoff",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_prime,\r\n{ "Prime compression character",\r\n"tn3270.prime",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ap_na,\r\n{ "Max number of alphanumeric partitions",\r\n"tn3270.ap_na",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ap_m,\r\n{ "Total available partition storage",\r\n"tn3270.ap_m",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_query_reply_alphanumeric_flags,\r\n{ "Flags",\r\n"tn3270.ap_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ap_vertical_scrolling,\r\n{ "Vertical Scrolling Supported",\r\n"tn3270.ap_vertical_scrolling",\r\nFT_BOOLEAN, 8, NULL, QR_AP_VERTWIN,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ap_horizontal_scrolling,\r\n{ "Horizontal Scrolling Supported",\r\n"tn3270.ap_horizontal_scrolling",\r\nFT_BOOLEAN, 8, NULL, QR_AP_HORWIN,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ap_apres1,\r\n{ "Reserved",\r\n"tn3270.ap_apres1",\r\nFT_BOOLEAN, 8, NULL, QR_AP_APRES1,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ap_apa,\r\n{ "All Points addressability supported",\r\n"tn3270.ap_apa",\r\nFT_BOOLEAN, 8, NULL, QR_AP_APA_FLG,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ap_pp,\r\n{ "Partition protection supported",\r\n"tn3270.ap_pp",\r\nFT_BOOLEAN, 8, NULL, QR_AP_PROT,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ap_lc,\r\n{ "Presentation space local copy supported",\r\n"tn3270.ap_lc",\r\nFT_BOOLEAN, 8, NULL, QR_AP_LCOPY,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ap_mp,\r\n{ "Modify Partition supported",\r\n"tn3270.ap_mp",\r\nFT_BOOLEAN, 8, NULL, QR_AP_MODPART,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ap_apres2,\r\n{ "Reserved",\r\n"tn3270.ap_apres2",\r\nFT_BOOLEAN, 8, NULL, QR_AP_APRES2,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ap_cm,\r\n{ "Character multiplier",\r\n"tn3270.ap_cm",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ap_ro,\r\n{ "Row overhead",\r\n"tn3270.ap_ro",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ap_co,\r\n{ "Column overhead",\r\n"tn3270.ap_co",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ap_fo,\r\n{ "Fixed overhead",\r\n"tn3270.ap_fo",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_character_sets_flags1,\r\n{ "Flags (1)",\r\n"tn3270.character_sets_flags1",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_cs_ge,\r\n{ "Graphic Escape supported",\r\n"tn3270.cs_ge",\r\nFT_BOOLEAN, 8, NULL, QR_CS_ALT,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_cs_mi,\r\n{ "Multiple LCIDs are supported",\r\n"tn3270.cs_mi",\r\nFT_BOOLEAN, 8, NULL, QR_CS_MULTID,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_cs_lps,\r\n{ "Load PSSF is supported",\r\n"tn3270.cs_lps",\r\nFT_BOOLEAN, 8, NULL, QR_CS_LOADABLE,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_cs_lpse,\r\n{ "Load PS EXTENDED is supported",\r\n"tn3270.cs_lpse",\r\nFT_BOOLEAN, 8, NULL, QR_CS_EXT,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_cs_ms,\r\n{ "More than one size of character slot is supported",\r\n"tn3270.cs_ms",\r\nFT_BOOLEAN, 8, NULL, QR_CS_MS,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_cs_ch2,\r\n{ "Two-byte coded character sets are supported",\r\n"tn3270.cs_ch2",\r\nFT_BOOLEAN, 8, NULL, QR_CS_CH2,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_cs_gf,\r\n{ "CGCSGID is present",\r\n"tn3270.cs_gf",\r\nFT_BOOLEAN, 8, NULL, QR_CS_GF,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_cs_res,\r\n{ "Reserved",\r\n"tn3270.cs_res",\r\nFT_BOOLEAN, 8, NULL, QR_CS_CSRES,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_character_sets_flags2,\r\n{ "Flags (2)",\r\n"tn3270.character_sets_flags2",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_cs_res2,\r\n{ "Reserved",\r\n"tn3270.cs_res2",\r\nFT_BOOLEAN, 8, NULL, QR_CS_CSRES2,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_cs_pscs,\r\n{ "Load PS slot size match not required",\r\n"tn3270.cs_pscs",\r\nFT_BOOLEAN, 8, NULL, QR_CS_PSCS,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_cs_res3,\r\n{ "Reserved",\r\n"tn3270.cs_res3",\r\nFT_BOOLEAN, 8, NULL, QR_CS_CSRES3,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_cs_cf,\r\n{ "CCSID present",\r\n"tn3270.cs_cf",\r\nFT_BOOLEAN, 8, NULL, QR_CS_CF,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_sdw,\r\n{ "Default character slot width",\r\n"tn3270.cs_sdw",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_sdh,\r\n{ "Default character slot height",\r\n"tn3270.cs_sdh",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_form,\r\n{ "Form Types",\r\n"tn3270.form",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_formres,\r\n{ "Form Types (Reserved)",\r\n"tn3270.formres",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_cs_form_type1,\r\n{ "18-byte form",\r\n"tn3270.cs_form_type1",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\n"the first 2 bytes contain a 16-bit vertical slice,"\r\n" the following 16 bytes contain 8-bit horizontal slices. For a 9"\r\n" x 12 character matrix the last 4 bytes contain binary zero.", HFILL }\r\n},\r\n{ &hf_tn3270_cs_form_type2,\r\n{ "18-byte form (COMPRESSED)",\r\n"tn3270.cs_form_type2",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\n"the first 2 bytes contain a 16-bit vertical slice,"\r\n" the following 16 bytes contain 8-bit horizontal slices. For a 9"\r\n" x 12 character matrix the last 4 bytes contain binary zero. (COMPRESSED)", HFILL }\r\n},\r\n{ &hf_tn3270_cs_form_type3,\r\n{ "Row loading (from top to bottom)",\r\n"tn3270.cs_form_type3",\r\nFT_BOOLEAN, 8, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_cs_form_type4,\r\n{ "Row loading (from top to bottom) (Compressed)",\r\n"tn3270.cs_form_type4",\r\nFT_BOOLEAN, 8, NULL, 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_cs_form_type5,\r\n{ "Column loading (from left to right)",\r\n"tn3270.cs_form_type5",\r\nFT_BOOLEAN, 8, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_cs_form_type6,\r\n{ "Column loading (from left to right) (Compressed)",\r\n"tn3270.cs_form_type6",\r\nFT_BOOLEAN, 8, NULL, 0x04,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_cs_form_type8,\r\n{ "Vector",\r\n"tn3270.cs_form_type8",\r\nFT_BOOLEAN, 8, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_cs_dl,\r\n{ "Length of each descriptor",\r\n"tn3270.cs_dl",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_cs_descriptor_set,\r\n{ "Device Specific Character Set ID (PS store No.)",\r\n"tn3270.cs_descriptor_set",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_cs_descriptor_flags,\r\n{ "Flags",\r\n"tn3270.cs_descriptor_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_cs_ds_load,\r\n{ "Loadable character set",\r\n"tn3270.cs_ds_load",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_cs_ds_triple,\r\n{ "Triple-plane character set",\r\n"tn3270.cs_ds_triple",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_cs_ds_char,\r\n{ "Double-Byte coded character set",\r\n"tn3270.cs_ds_char",\r\nFT_BOOLEAN, 8, NULL, 0x20,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_cs_ds_cb,\r\n{ "No LCID compare",\r\n"tn3270.cs_ds_cb",\r\nFT_BOOLEAN, 8, NULL, 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_lcid,\r\n{ "Local character set ID (alias)",\r\n"tn3270.lcid",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_sw,\r\n{ "Width of the character slots in this characterset.",\r\n"tn3270.sw",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_sh,\r\n{ "Height of the character slots in this character set.",\r\n"tn3270.sh",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ssubsn,\r\n{ "Starting subsection.",\r\n"tn3270.ssubsn",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_esubsn,\r\n{ "Ending subsection.",\r\n"tn3270.esubsn",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ccsgid,\r\n{ "Coded Graphic Character Set Identifier.",\r\n"tn3270.ccsgid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ccsid,\r\n{ "Coded Character Set Identifier.",\r\n"tn3270.ccsid",\r\nFT_UINT64, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_color_flags,\r\n{ "Flags",\r\n"tn3270.color_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_c_prtblk,\r\n{ "Printer only - black ribbon is loaded",\r\n"tn3270.cc_prtblk",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_c_np,\r\n{ "Length of color attribute list",\r\n"tn3270.np",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_c_cav,\r\n{ "Color attribute value accepted by the device",\r\n"tn3270.c_cav",\r\nFT_UINT8, BASE_HEX, VALS(vals_at_color_identifications), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_c_ci,\r\n{ "Color identifier",\r\n"tn3270.c_ci",\r\nFT_UINT8, BASE_HEX, VALS(vals_at_color_identifications), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_db_cavdef,\r\n{ "Default color attribute value",\r\n"tn3270.db_cavdef",\r\nFT_UINT8, BASE_HEX, VALS(vals_at_color_identifications), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_db_cidef,\r\n{ "Default background color identifier",\r\n"tn3270.db_cidef",\r\nFT_UINT8, BASE_HEX, VALS(vals_at_color_identifications), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_limin,\r\n{ "Maximum CPR bytes/transmission allowed inbound",\r\n"tn3270.limin",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_limout,\r\n{ "Maximum CPR bytes/transmission allowed outbound",\r\n"tn3270.limout",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_featl,\r\n{ "Length (in bytes) of feature information that follows",\r\n"tn3270.featl",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_feats,\r\n{ "CPR length and feature flags",\r\n"tn3270.feats",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_dc_dir,\r\n{ "Indicates which direction can use the Data Chain structured field.",\r\n"tn3270.dc_dir",\r\nFT_UINT8, BASE_HEX, VALS(vals_data_chaining_dir), 0xC0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ds_default_sfid,\r\n{ "Default Data Stream",\r\n"tn3270.ds_default_sfid",\r\nFT_UINT8, BASE_HEX, VALS(vals_data_streams), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ds_sfid,\r\n{ "Supported Data Stream",\r\n"tn3270.ds_sfid",\r\nFT_UINT8, BASE_HEX, VALS(vals_data_streams), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_asia_sdp_sosi_soset,\r\n{ "Set ID of the Shift Out (SO) character set",\r\n"tn3270.asia_sdp_sosi_soset",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_asia_sdp_ic_func,\r\n{ "SO/SI Creation supported",\r\n"tn3270.asia_sdp_ic_func",\r\nFT_BOOLEAN, 8, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ddm_flags,\r\n{ "Flags (Reserved)",\r\n"tn3270.ddm_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ddm_limin,\r\n{ "Maximum DDM bytes/transmission allowed inbound",\r\n"tn3270.ddm_limin",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ddm_limout,\r\n{ "Maximum DDM bytes/transmission allowed outbound",\r\n"tn3270.ddm_limout",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ddm_nss,\r\n{ "Number of subsets supported",\r\n"tn3270.ddm_nss",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ddm_ddmss,\r\n{ "DDM subset identifier",\r\n"tn3270.ddm_ddmss",\r\nFT_UINT8, BASE_HEX, VALS(vals_qr_ddm), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_dia_flags,\r\n{ "Flags (Reserved)",\r\n"tn3270.dia_flags",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_dia_limin,\r\n{ "Maximum DIA bytes/transmission allowed inbound",\r\n"tn3270.dia_limin",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_dia_limout,\r\n{ "Maximum DIA bytes/transmission allowed outbound",\r\n"tn3270.dia_limout",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_dia_nfs,\r\n{ "Number of subsets supported",\r\n"tn3270.dia_nfs",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_dia_diafs,\r\n{ "DIA function set identifier",\r\n"tn3270.dia_diafs",\r\nFT_UINT8, BASE_HEX, VALS(vals_qr_dia), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_dia_diafn,\r\n{ "DIA function set number",\r\n"tn3270.dia_diafn",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_fo_flags,\r\n{ "Flags",\r\n"tn3270.fo_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_fo_vpos,\r\n{ "Location of vertical line",\r\n"tn3270.fo_vpos",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_fo_hpos,\r\n{ "Location of overline/underline",\r\n"tn3270.fo_hpos",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_fo_hpos0,\r\n{ "Location of overline in case of separation",\r\n"tn3270.fo_hpos0",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_fo_hpos1,\r\n{ "Location of underline in case of separation",\r\n"tn3270.fo_hpos1",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_fsad_flags,\r\n{ "Flags",\r\n"tn3270.fsad_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_fsad_limin,\r\n{ "Reserved for LIMIN parameter. Must be set to zeros.",\r\n"tn3270.fsad_limin",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_fsad_limout,\r\n{ "Maximum bytes of format storage data per transmission allowed outbound.",\r\n"tn3270.fsad_limout",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_fsad_size,\r\n{ "Size of the format storage space",\r\n"tn3270.fsad_size",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_h_np,\r\n{ "Number of attribute-value/action pairs",\r\n"tn3270.h_np",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_h_vi,\r\n{ "Data stream attribute value accepted",\r\n"tn3270.h_vi",\r\nFT_UINT8, BASE_HEX, VALS(vals_at_extended_highlighting), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_h_ai,\r\n{ "Data stream action",\r\n"tn3270.h_ai",\r\nFT_UINT8, BASE_HEX, VALS(vals_at_extended_highlighting), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ibm_flags,\r\n{ "Flags",\r\n"tn3270.ibm_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ibm_limin,\r\n{ "Inbound message size limit",\r\n"tn3270.ibm_limin",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ibm_limout,\r\n{ "Outbound message size limit",\r\n"tn3270.ibm_limout",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ibm_type,\r\n{ "Type of IBM Auxiliary Device",\r\n"tn3270.ibm_type",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ip_flags,\r\n{ "Flags (Reserved)",\r\n"tn3270.ip_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ipdd_wd,\r\n{ "Width of the Implicit Partition default screen size (in character cells)",\r\n"tn3270.ipdd_wd",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ipdd_hd,\r\n{ "Height of the Implicit Partition default screen size",\r\n"tn3270.ipdd_hd",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ipdd_wa,\r\n{ "Width of the Implicit Partition alternate screen size",\r\n"tn3270.ipdd_wa",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ipdd_ha,\r\n{ "Height of the Implicit Partition alternate screen size",\r\n"tn3270.ipdd_ha",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ippd_dpbs,\r\n{ "Default printer buffer size (in character cells)",\r\n"tn3270.ippd_dpbs",\r\nFT_UINT64, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ippd_apbs,\r\n{ "Default printer buffer size (in character cells)",\r\n"tn3270.ippd_apbs",\r\nFT_UINT64, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ipccd_wcd,\r\n{ "Width of the character cell for the Implicit Partition default screen size",\r\n"tn3270.ipccd_wcd",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ipccd_hcd,\r\n{ "Height of the character cell for the Implicit Partition default screen size",\r\n"tn3270.ipccd_hcd",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ipccd_wca,\r\n{ "Width of the character cell for the Implicit Partition alternate screen size",\r\n"tn3270.ipccd_wca",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ipccd_hca,\r\n{ "Height of the character cell for the Implicit Partition alternate screen size",\r\n"tn3270.ipccd_hca",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ioca_limin,\r\n{ "Max IOCA bytes/inbound transmission",\r\n"tn3270.ioca_limin",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ioca_limout,\r\n{ "Max IOCA bytes/outbound transmission",\r\n"tn3270.ioca_limout",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ioca_type,\r\n{ "Type of IOCA Auxiliary Device",\r\n"tn3270.ioca_type",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_msr_nd,\r\n{ "Number of MSR device types",\r\n"tn3270.msr_nd",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_oem_dsref,\r\n{ "Data stream reference identifier",\r\n"tn3270.oem_dsref",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_oem_dtype,\r\n{ "Device type",\r\n"tn3270.oem_dtype",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_oem_uname,\r\n{ "User assigned name",\r\n"tn3270.oem_uname",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_sdp_daid,\r\n{ "Destination/Origin ID",\r\n"tn3270.oem_sdp_daid_doid",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_oem_sdp_ll_limin,\r\n{ "Maximum OEM dsf bytes/transmission allowed inbound",\r\n"tn3270.oem_sdp_ll_limin",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_oem_sdp_ll_limout,\r\n{ "Maximum OEM dsf bytes/transmission allowed outbound",\r\n"tn3270.oem_sdp_ll_limout",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_oem_sdp_pclk_vers,\r\n{ "Protocol version",\r\n"tn3270.oem_sdp_pclk_vers",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_pft_flags,\r\n{ "Flags",\r\n"tn3270.pft_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_pft_tmo,\r\n{ "Top margin offset in 1/1440ths of an inch",\r\n"tn3270.pft_tmo",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_pft_bmo,\r\n{ "Bottom margin offset in 1/1440ths of an inch",\r\n"tn3270.pft_bmo",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_pc_vo_thickness,\r\n{ "Thickness",\r\n"tn3270.pc_vo_thickness",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_pdds_refid,\r\n{ "Reference identifier",\r\n"tn3270.pdds_refid",\r\nFT_UINT8, BASE_HEX, VALS(vals_qr_pdds_refid), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_pdds_ssid,\r\n{ "Subset identifier",\r\n"tn3270.pdds_ssid",\r\nFT_UINT8, BASE_HEX, VALS(vals_qr_pdds_ssid), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_rpq_device,\r\n{ "Device type identifier",\r\n"tn3270.rpq_device",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_rpq_mid,\r\n{ "Model type identifier",\r\n"tn3270.rpq_mid",\r\nFT_UINT64, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_rpq_rpql,\r\n{ "Length of RPQ name (including this byte)",\r\n"tn3270.rpq_rpql",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_rpq_name,\r\n{ "RPQ name",\r\n"tn3270.rpq_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_srf_fpcbl,\r\n{ "Format parameter control block length",\r\n"tn3270.srf_fpcbl",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_spc_epc_flags,\r\n{ "Flags",\r\n"tn3270.spc_epc_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_sp_spid,\r\n{ "Storage pool identity",\r\n"tn3270.sp_spid",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_sp_size,\r\n{ "Size of this storage pool when empty",\r\n"tn3270.sp_size",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_sp_space,\r\n{ "Space available in this storage pool",\r\n"tn3270.sp_space",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_sp_objlist,\r\n{ "Identifiers of objects housed in this storage pool",\r\n"tn3270.sp_objlist",\r\nFT_UINT16, BASE_HEX, VALS(vals_sp_objlist), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_tp_nt,\r\n{ "Maximum number of text partitions",\r\n"tn3270.tp_nt",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_tp_m,\r\n{ "Maximum partition size",\r\n"tn3270.tp_m",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_tp_flags,\r\n{ "Flags",\r\n"tn3270.tp_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_tp_ntt,\r\n{ "Number of text types supported",\r\n"tn3270.tp_ntt",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_tp_tlist,\r\n{ "List of types supported",\r\n"tn3270.tp_tlist",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_t_np,\r\n{ "Number of pairs",\r\n"tn3270.t_np",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_t_vi,\r\n{ "Data stream attribute value accepted",\r\n"tn3270.t_vi",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_t_ai,\r\n{ "Associated action value",\r\n"tn3270.t_ai",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_usable_area_flags1,\r\n{"Usable Area Flags",\r\n"tn3270.query_reply_usable_area_flags1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_tn3270_ua_reserved1,\r\n{ "Reserved",\r\n"tn3270.reserved",\r\nFT_BOOLEAN, 8, NULL, QR_UA_RESERVED1,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ua_page_printer,\r\n{ "Page Printer",\r\n"tn3270.ua_page_printer",\r\nFT_BOOLEAN, 8, NULL, QR_UA_PAGE_PRINTER,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ua_reserved2,\r\n{ "Reserved",\r\n"tn3270.reserved",\r\nFT_BOOLEAN, 8, NULL, QR_UA_RESERVED2,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ua_hard_copy,\r\n{ "Hard Copy",\r\n"tn3270.ua_hard_copy",\r\nFT_BOOLEAN, 8, NULL, QR_UA_HARD_COPY,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ua_addressing,\r\n{ "Usable Area Addressing",\r\n"tn3270.ua_addressing",\r\nFT_UINT8, BASE_HEX, VALS(vals_usable_area_addr_mode), QR_UA_ADDR_MODE_MASK,\r\nNULL, HFILL}\r\n},\r\n{ &hf_tn3270_usable_area_flags2,\r\n{ "Usable Area Flags",\r\n"tn3270.query_reply_usable_area_flags2",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_tn3270_ua_variable_cells,\r\n{ "Variable Cells",\r\n"tn3270.ua_variable_cells",\r\nFT_BOOLEAN, 8, TFS(&tn3270_tfs_ua_variable_cells), QR_UA_VARIABLE_CELLS,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ua_characters,\r\n{ "Characters",\r\n"tn3270.ua_characters",\r\nFT_BOOLEAN, 8, TFS(&tn3270_tfs_ua_characters), QR_UA_CHARACTERS,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ua_cell_units,\r\n{ "Cell Units",\r\n"tn3270.ua_cell_units",\r\nFT_BOOLEAN, 8, TFS(&tn3270_tfs_ua_cell_units), QR_UA_CELL_UNITS,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ua_width_cells_pels,\r\n{ "Width of usable area in cells/pels",\r\n"tn3270.ua_width_cells_pels",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ua_height_cells_pels,\r\n{ "Height of usable area in cells/pels",\r\n"tn3270.ua_height_cells_pels",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ua_uom_cells_pels,\r\n{ "Units of measure for cells/pels",\r\n"tn3270.ua_uom_cells_pels",\r\nFT_UINT8, BASE_HEX, VALS(vals_usable_area_uom), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ua_xr,\r\n{ "Distance between points in X direction as a fraction",\r\n"tn3270.ua_xr",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\n"measured in UNITS, with 2-byte numerator and 2-byte denominator", HFILL }\r\n},\r\n{ &hf_tn3270_ua_yr,\r\n{ "Distance between points in Y direction as a fraction",\r\n"tn3270.ua_xr",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\n"measured in UNITS, with 2-byte numerator and 2-byte denominator", HFILL }\r\n},\r\n{ &hf_tn3270_ua_aw,\r\n{ "Number of X units in default cell",\r\n"tn3270.ua_aw",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ua_ah,\r\n{ "Number of Y units in default cell",\r\n"tn3270.ua_ah",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ua_buffsz,\r\n{ "Character buffer size (bytes)",\r\n"tn3270.ua_buffsz",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ua_xmin,\r\n{ "Minimum number of X units in variable cell",\r\n"tn3270.ua_xmin",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ua_ymin,\r\n{ "Minimum number of Y units in variable cell",\r\n"tn3270.ua_ymin",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ua_xmax,\r\n{ "Maximum number of X units in variable cell",\r\n"tn3270.ua_xmax",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_ua_ymax,\r\n{ "Maximum number of Y units in variable cell",\r\n"tn3270.ua_ymax",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_3270_tranlim,\r\n{ "Maximum transmission size allowed outbound",\r\n"tn3270.3270_tranlim",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_field_data,\r\n{ "Field Data",\r\n"tn3270.field_data",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\n"tn3270.field_data", HFILL }\r\n},\r\n{ &hf_tn3270_number_of_attributes,\r\n{ "Number of Attributes",\r\n"tn3270.number_of_attributes",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_resbyte,\r\n{ "Flags (Reserved)",\r\n"tn3270.resbyte",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_resbytes,\r\n{ "Flags (Reserved)",\r\n"tn3270.resbytes",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_res_twobytes,\r\n{ "Flags (Reserved)",\r\n"tn3270.res_twobytes",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_sf_single_byte_id,\r\n{ "Structured Field",\r\n"tn3270.sf_id",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_sf_double_byte_id,\r\n{ "Structured Field",\r\n"tn3270.sf_id",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_sf_query_reply,\r\n{ "Query Reply",\r\n"tn3270.sf_query_reply",\r\nFT_UINT8, BASE_HEX, VALS(vals_sf_query_replies), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_null,\r\n{ "Trailing Null (Possible Mainframe/Emulator Bug)",\r\n"tn3270.null",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_unknown_data,\r\n{ "Unknown Data (Possible Mainframe/Emulator Bug)",\r\n"tn3270.unknown_data",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_tn3270e_data_type,\r\n{ "TN3270E Data Type",\r\n"tn3270.tn3270e_data_type",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn3270_header_data_types), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_tn3270e_request_flag,\r\n{ "TN3270E Request Flag",\r\n"tn3270.tn3270e_request_flag",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn3270_header_request_flags), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_tn3270e_response_flag_3270_SCS,\r\n{ "TN3270E Response Flag",\r\n"tn3270.tn3270e_response_flag",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn3270_header_response_flags_3270_SCS), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_tn3270e_response_flag_response,\r\n{ "TN3270E Response Flag",\r\n"tn3270.tn3270e_response_flag",\r\nFT_UINT8, BASE_HEX, VALS(vals_tn3270_header_response_flags_response), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_tn3270e_response_flag_unused,\r\n{ "TN3270E Response Flag",\r\n"tn3270.tn3270e_response_flag",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_tn3270e_seq_number,\r\n{ "TN3270E Seq Number",\r\n"tn3270.tn3270e_seq_number",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_tn3270_tn3270e_header_data,\r\n{ "TN3270E Header Data",\r\n"tn3270.tn3270e_header_data",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n}\r\n};\r\nstatic gint *ett[] = {\r\n&ett_tn3270,\r\n&ett_tn3270e_hdr,\r\n&ett_sf,\r\n&ett_tn3270_field_attribute,\r\n&ett_tn3270_field_validation,\r\n&ett_tn3270_usable_area_flags1,\r\n&ett_tn3270_usable_area_flags2,\r\n&ett_tn3270_query_reply_alphanumeric_flags,\r\n&ett_tn3270_character_sets_flags1,\r\n&ett_tn3270_character_sets_flags2,\r\n&ett_tn3270_character_sets_form,\r\n&ett_tn3270_cs_descriptor_flags,\r\n&ett_tn3270_color_flags,\r\n&ett_tn3270_wcc,\r\n&ett_tn3270_ccc,\r\n&ett_tn3270_msr_state_mask,\r\n&ett_tn3270_data_chain_fields,\r\n&ett_tn3270_query_list\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_tn3270_order_code, { "tn3270.order_code.bogus", PI_PROTOCOL, PI_WARN, "Bogus value", EXPFILL }},\r\n{ &ei_tn3270_command_code, { "tn3270.command_code.bogus", PI_PROTOCOL, PI_WARN, "Bogus value", EXPFILL }},\r\n{ &ei_tn3270_aid, { "tn3270.aid.bogus", PI_PROTOCOL, PI_WARN, "Bogus value", EXPFILL }},\r\n};\r\nexpert_module_t* expert_tn3270;\r\nproto_tn3270 = proto_register_protocol("TN3270 Protocol", "TN3270", "tn3270");\r\nregister_dissector("tn3270", dissect_tn3270, proto_tn3270);\r\nproto_register_field_array(proto_tn3270, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_tn3270 = expert_register_protocol(proto_tn3270);\r\nexpert_register_field_array(expert_tn3270, ei, array_length(ei));\r\n}
