static guint\r\nget_gryphon_pdu_len(packet_info *pinfo _U_, tvbuff_t *tvb, int offset, void *data _U_)\r\n{\r\nguint16 plen;\r\nint padded_len;\r\nplen = tvb_get_ntohs(tvb, offset + 4);\r\npadded_len = plen + 3 - (plen + 3) % 4;\r\nreturn padded_len + FRAME_HEADER_LEN;\r\n}\r\nstatic int\r\ndissect_gryphon_pdu(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\ndissect_gryphon_message(tvb, pinfo, tree, FALSE);\r\nreturn tvb_reported_length(tvb);\r\n}\r\nstatic int\r\ndissect_gryphon(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data)\r\n{\r\ntcp_dissect_pdus(tvb, pinfo, tree, gryphon_desegment, FRAME_HEADER_LEN,\r\nget_gryphon_pdu_len, dissect_gryphon_pdu, data);\r\nreturn tvb_reported_length(tvb);\r\n}\r\nstatic void\r\ndissect_gryphon_message(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree,\r\ngboolean is_msgresp_add)\r\n{\r\nint offset = 0;\r\nproto_tree *gryphon_tree;\r\nproto_item *ti;\r\nproto_tree *header_tree, *body_tree;\r\nint msgend;\r\nint msglen, msgpad;\r\nunsigned int src, dest, i, frmtyp;\r\nguint8 flags;\r\nif (!is_msgresp_add) {\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "Gryphon");\r\ncol_clear(pinfo->cinfo, COL_INFO);\r\n}\r\nif (!is_msgresp_add) {\r\nti = proto_tree_add_item(tree, proto_gryphon, tvb, 0, -1, ENC_NA);\r\ngryphon_tree = proto_item_add_subtree(ti, ett_gryphon);\r\n} else\r\ngryphon_tree = tree;\r\nsrc = tvb_get_guint8(tvb, offset + 0);\r\ndest = tvb_get_guint8(tvb, offset + 2);\r\nmsglen = tvb_get_ntohs(tvb, offset + 4);\r\nflags = tvb_get_guint8(tvb, offset + 6);\r\nfrmtyp = flags & ~RESPONSE_FLAGS;\r\nif (!is_msgresp_add) {\r\nset_actual_length(tvb, msglen + FRAME_HEADER_LEN);\r\ncol_set_str(pinfo->cinfo, COL_INFO, val_to_str_const(frmtyp, frame_type, "- Invalid -"));\r\n}\r\nif (tree == NULL)\r\nreturn;\r\nif (try_val_to_str(frmtyp, frame_type) == NULL) {\r\nproto_tree_add_item(gryphon_tree, hf_gryphon_data, tvb, offset, msglen, ENC_NA);\r\nreturn;\r\n}\r\nheader_tree = proto_tree_add_subtree(gryphon_tree, tvb, offset, MSG_HDR_SZ, ett_gryphon_header, NULL, "Header");\r\nproto_tree_add_item(header_tree, hf_gryphon_src, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(header_tree, hf_gryphon_srcchan, tvb, offset+1, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(header_tree, hf_gryphon_dest, tvb, offset+2, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(header_tree, hf_gryphon_destchan, tvb, offset+3, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(header_tree, hf_gryphon_data_length, tvb, offset+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(header_tree, hf_gryphon_type, tvb, offset+6, 1, ENC_BIG_ENDIAN);\r\nif (is_msgresp_add) {\r\nstatic const int * wait_flags[] = {\r\n&hf_gryphon_wait_resp,\r\n&hf_gryphon_wait_prev_resp,\r\nNULL\r\n};\r\nproto_tree_add_bitmask(header_tree, tvb, offset+6, hf_gryphon_wait_flags, ett_gryphon_flags, wait_flags, ENC_NA);\r\n}\r\nproto_tree_add_item(header_tree, hf_gryphon_reserved, tvb, offset+7, 1, ENC_NA);\r\nmsgpad = 3 - (msglen + 3) % 4;\r\nmsgend = offset + msglen + msgpad + MSG_HDR_SZ;\r\nbody_tree = proto_tree_add_subtree(gryphon_tree, tvb, offset + MSG_HDR_SZ,\r\nmsglen + msgpad, ett_gryphon_body, NULL, "Body");\r\noffset += MSG_HDR_SZ;\r\nswitch (frmtyp) {\r\ncase GY_FT_CMD:\r\noffset = decode_command(tvb, offset, dest, body_tree);\r\nbreak;\r\ncase GY_FT_RESP:\r\noffset = decode_response(tvb, offset, src, body_tree);\r\nbreak;\r\ncase GY_FT_DATA:\r\noffset = decode_data(tvb, offset, body_tree);\r\nbreak;\r\ncase GY_FT_EVENT:\r\noffset = decode_event(tvb, offset, body_tree);\r\nbreak;\r\ncase GY_FT_MISC:\r\noffset = decode_misc (tvb, offset, body_tree);\r\nbreak;\r\ncase GY_FT_TEXT:\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nif (offset < msgend - msgpad) {\r\ni = msgend - msgpad - offset;\r\nproto_tree_add_item(gryphon_tree, hf_gryphon_data, tvb, offset, i, ENC_NA);\r\noffset += i;\r\n}\r\nif (offset < msgend) {\r\ni = msgend - offset;\r\nproto_tree_add_item(gryphon_tree, hf_gryphon_padding, tvb, offset, i, ENC_NA);\r\n}\r\n}\r\nstatic int\r\ndecode_command(tvbuff_t *tvb, int offset, int dst, proto_tree *pt)\r\n{\r\nint cmd, msglen;\r\nunsigned int i;\r\nproto_tree *ft;\r\nproto_item *hi;\r\nmsglen = tvb_reported_length_remaining(tvb, offset);\r\ncmd = tvb_get_guint8(tvb, offset);\r\nhi = proto_tree_add_uint(pt, hf_gryphon_cmd, tvb, offset, 1, cmd);\r\nPROTO_ITEM_SET_HIDDEN(hi);\r\nif (cmd > 0x3F)\r\ncmd += dst * 256;\r\nfor (i = 0; i < SIZEOF(cmds); i++) {\r\nif (cmds[i].value == cmd)\r\nbreak;\r\n}\r\nif (i >= SIZEOF(cmds) && dst >= SD_KNOWN) {\r\ncmd = (cmd & 0xFF) + SD_CARD * 256;\r\nfor (i = 0; i < SIZEOF(cmds); i++) {\r\nif (cmds[i].value == cmd)\r\nbreak;\r\n}\r\n}\r\nif (i >= SIZEOF(cmds))\r\ni = SIZEOF(cmds) - 1;\r\nproto_tree_add_string(pt, hf_gryphon_command, tvb, offset, 4, cmds[i].strptr);\r\noffset += 4;\r\nmsglen -= 4;\r\nif (cmds[i].cmd_fnct && msglen > 0) {\r\nft = proto_tree_add_subtree_format(pt, tvb, offset, -1, ett_gryphon_command_data, NULL,\r\n"Data: (%d byte%s)", msglen, msglen == 1 ? "" : "s");\r\noffset = (*(cmds[i].cmd_fnct)) (tvb, offset, ft);\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndecode_response(tvbuff_t *tvb, int offset, int src, proto_tree *pt)\r\n{\r\nint cmd, msglen;\r\nunsigned int i;\r\nproto_tree *ft;\r\nmsglen = tvb_reported_length_remaining(tvb, offset);\r\ncmd = tvb_get_guint8(tvb, offset);\r\nif (cmd > 0x3F)\r\ncmd += src * 256;\r\nfor (i = 0; i < SIZEOF(cmds); i++) {\r\nif (cmds[i].value == cmd)\r\nbreak;\r\n}\r\nif (i >= SIZEOF(cmds) && src >= SD_KNOWN) {\r\ncmd = (cmd & 0xFF) + SD_CARD * 256;\r\nfor (i = 0; i < SIZEOF(cmds); i++) {\r\nif (cmds[i].value == cmd)\r\nbreak;\r\n}\r\n}\r\nif (i >= SIZEOF(cmds))\r\ni = SIZEOF(cmds) - 1;\r\nproto_tree_add_string(pt, hf_gryphon_command, tvb, offset, 4, cmds[i].strptr);\r\noffset += 4;\r\nmsglen -= 4;\r\nproto_tree_add_item(pt, hf_gryphon_status, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nmsglen -= 4;\r\nif (cmds[i].rsp_fnct && msglen > 0) {\r\nft = proto_tree_add_subtree_format(pt, tvb, offset, msglen, ett_gryphon_response_data, NULL,\r\n"Data: (%d byte%s)", msglen, msglen == 1 ? "" : "s");\r\noffset = (*(cmds[i].rsp_fnct)) (tvb, offset, ft);\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndecode_data(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nproto_item *item1;\r\nproto_tree *tree, *tree1;\r\nint hdrsize, datasize, extrasize, msgsize, padding, mode;\r\nnstime_t timestamp;\r\nhdrsize = tvb_get_guint8(tvb, offset+0);\r\ndatasize = tvb_get_ntohs(tvb, offset+2);\r\nextrasize = tvb_get_guint8(tvb, offset+4);\r\npadding = 3 - (hdrsize + datasize + extrasize + 3) % 4;\r\nmsgsize = hdrsize + datasize + extrasize + padding + 16;\r\ntree = proto_tree_add_subtree(pt, tvb, offset, 16, ett_gryphon_data_header, NULL, "Message header");\r\nproto_tree_add_item(tree, hf_gryphon_data_header_length, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gryphon_data_data_length, tvb, offset+2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gryphon_data_extra_data_length, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nmode = tvb_get_guint8(tvb, offset+5);\r\nitem1 = proto_tree_add_item(tree, hf_gryphon_data_mode, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nif (mode) {\r\ntree1 = proto_item_add_subtree (item1, ett_gryphon_flags);\r\nproto_tree_add_item(tree1, hf_gryphon_data_mode_transmitted, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree1, hf_gryphon_data_mode_receive, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree1, hf_gryphon_data_mode_local, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree1, hf_gryphon_data_mode_remote, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree1, hf_gryphon_data_mode_internal, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\n}\r\nproto_tree_add_item(tree, hf_gryphon_data_priority, tvb, offset+6, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gryphon_data_error_status, tvb, offset+7, 1, ENC_BIG_ENDIAN);\r\ntimestamp.secs = tvb_get_ntohl(tvb, offset+8)/100000;\r\ntimestamp.nsecs = (tvb_get_ntohl(tvb, offset+8)%100000)*1000;\r\nproto_tree_add_time(tree, hf_gryphon_data_time, tvb, offset+8, 4, &timestamp);\r\nproto_tree_add_item(tree, hf_gryphon_data_context, tvb, offset+12, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gryphon_reserved, tvb, offset+13, 3, ENC_NA);\r\noffset += 16;\r\ntree = proto_tree_add_subtree(pt, tvb, offset, msgsize-16-padding, ett_gryphon_data_body, NULL, "Message Body");\r\nif (hdrsize) {\r\nproto_tree_add_item(tree, hf_gryphon_data_header_data, tvb, offset, hdrsize, ENC_NA);\r\noffset += hdrsize;\r\n}\r\nif (datasize) {\r\nproto_tree_add_item(tree, hf_gryphon_data_data, tvb, offset, datasize, ENC_NA);\r\noffset += datasize;\r\n}\r\nif (extrasize) {\r\nproto_tree_add_item(tree, hf_gryphon_data_extra_data, tvb, offset, extrasize, ENC_NA);\r\noffset += extrasize;\r\n}\r\nif (padding) {\r\nproto_tree_add_item(tree, hf_gryphon_data_padding, tvb, offset, padding, ENC_NA);\r\noffset += padding;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndecode_event(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nint msglen, msgend, padding, length;\r\nnstime_t timestamp;\r\nmsglen = tvb_reported_length_remaining(tvb, offset);\r\npadding = 3 - (msglen + 3) % 4;\r\nmsgend = offset + msglen;\r\nproto_tree_add_item(pt, hf_gryphon_event_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pt, hf_gryphon_event_context, tvb, offset+1, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pt, hf_gryphon_reserved, tvb, offset+2, 2, ENC_NA);\r\noffset += 4;\r\ntimestamp.secs = tvb_get_ntohl(tvb, offset)/100000;\r\ntimestamp.nsecs = (tvb_get_ntohl(tvb, offset)%100000)*1000;\r\nproto_tree_add_time(pt, hf_gryphon_event_time, tvb, offset, 4, &timestamp);\r\noffset += 4;\r\nif (offset < msgend) {\r\nlength = msgend - offset;\r\nproto_tree_add_item(pt, hf_gryphon_event_data, tvb, offset, length, ENC_NA);\r\noffset += length;\r\n}\r\nif (padding) {\r\nproto_tree_add_item(pt, hf_gryphon_event_padding, tvb, offset, padding, ENC_NA);\r\noffset += padding;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndecode_misc (tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nint padding, msglen;\r\ngint length = 120;\r\nmsglen = tvb_reported_length_remaining(tvb, offset);\r\npadding = 3 - (msglen + 3) % 4;\r\nproto_tree_add_item(pt, hf_gryphon_misc_data, tvb, offset, length, ENC_NA|ENC_ASCII);\r\noffset += msglen;\r\nif (padding) {\r\nproto_tree_add_item(pt, hf_gryphon_misc_padding, tvb, offset, padding, ENC_NA);\r\noffset += padding;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ncmd_init(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nguint8 mode = tvb_get_guint8(tvb, offset);\r\nif (mode == 0)\r\nproto_tree_add_uint_format_value(pt, hf_gryphon_cmd_mode, tvb, offset, 1, mode, "Always initialize");\r\nelse\r\nproto_tree_add_uint_format_value(pt, hf_gryphon_cmd_mode, tvb, offset, 1, mode, "Initialize if not previously initialized");\r\nproto_tree_add_item(pt, hf_gryphon_reserved, tvb, offset+1, 3, ENC_NA);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\neventnum(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nguint8 event = tvb_get_guint8(tvb, offset);\r\nif (event)\r\nproto_tree_add_item(pt, hf_gryphon_eventnum, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nelse\r\nproto_tree_add_uint_format_value(pt, hf_gryphon_eventnum, tvb, offset, 1,\r\n0, "All");\r\nproto_tree_add_item(pt, hf_gryphon_reserved, tvb, offset+1, 3, ENC_NA);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\nresp_time(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nguint64 val;\r\nnstime_t timestamp;\r\nval = tvb_get_ntoh64(tvb, offset);\r\ntimestamp.secs = (time_t)(val/100000);\r\ntimestamp.nsecs = (int)((val%100000)*1000);\r\nproto_tree_add_time(pt, hf_gryphon_resp_time, tvb, offset, 8, &timestamp);\r\noffset += 8;\r\nreturn offset;\r\n}\r\nstatic int\r\ncmd_setfilt(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nint flag = tvb_get_ntohl(tvb, offset);\r\nint length, padding;\r\nlength = tvb_get_guint8(tvb, offset+4) + tvb_get_guint8(tvb, offset+5)\r\n+ tvb_get_ntohs(tvb, offset+6);\r\nproto_tree_add_uint_format_value(pt, hf_gryphon_setfilt, tvb, offset, 4,\r\nflag, "%s%s", ((flag) ? "Pass" : "Block"), ((length == 0) ? " all" : ""));\r\nproto_tree_add_uint(pt, hf_gryphon_setfilt_length, tvb, offset+4, 4, length);\r\noffset += 8;\r\nif (length) {\r\nproto_tree_add_item(pt, hf_gryphon_setfilt_discard_data, tvb, offset, length * 2, ENC_NA);\r\noffset += length * 2;\r\n}\r\npadding = 3 - (length * 2 + 3) % 4;\r\nif (padding) {\r\nproto_tree_add_item(pt, hf_gryphon_setfilt_padding, tvb, offset, padding, ENC_NA);\r\noffset += padding;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ncmd_ioctl(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nint msglen = tvb_reported_length_remaining(tvb, offset);\r\nproto_tree_add_item(pt, hf_gryphon_ioctl, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nmsglen -= 4;\r\nif (msglen > 0) {\r\nproto_tree_add_item(pt, hf_gryphon_ioctl_data, tvb, offset, msglen, ENC_NA);\r\noffset += msglen;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ncmd_addfilt(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nproto_tree *tree;\r\nint blocks, i, length;\r\ntree = proto_tree_add_subtree(pt, tvb, offset, 1, ett_gryphon_flags, NULL, "Flags");\r\nproto_tree_add_item(tree, hf_gryphon_addfilt_pass, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gryphon_addfilt_active, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nblocks = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(pt, hf_gryphon_addfilt_blocks, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pt, hf_gryphon_reserved, tvb, offset+1, 6, ENC_NA);\r\noffset += 7;\r\nfor (i = 1; i <= blocks; i++) {\r\nlength = tvb_get_ntohs(tvb, offset+2) * 2 + 8;\r\nlength += 3 - (length + 3) % 4;\r\ntree = proto_tree_add_subtree_format(pt, tvb, offset, length, ett_gryphon_cmd_filter_block, NULL, "Filter block %d", i);\r\noffset = filter_block(tvb, offset, tree);\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\nresp_addfilt(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nproto_tree_add_item(pt, hf_gryphon_addfilt_handle, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pt, hf_gryphon_reserved, tvb, offset+1, 3, ENC_NA);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\ncmd_modfilt(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nguint8 filter_handle = tvb_get_guint8(tvb, offset);\r\nif (filter_handle)\r\nproto_tree_add_item(pt, hf_gryphon_modfilt, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nelse\r\nproto_tree_add_uint_format_value(pt, hf_gryphon_modfilt, tvb, offset, 1,\r\n0, "Filter handles: all");\r\nproto_tree_add_item(pt, hf_gryphon_modfilt_action, tvb, offset+1, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pt, hf_gryphon_reserved, tvb, offset+2, 2, ENC_NA);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\nresp_filthan(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nint handles = tvb_get_guint8(tvb, offset);\r\nint i, padding, handle;\r\nproto_tree_add_item(pt, hf_gryphon_filthan, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nfor (i = 1; i <= handles; i++){\r\nhandle = tvb_get_guint8(tvb, offset+i);\r\nproto_tree_add_uint_format_value(pt, hf_gryphon_filthan_id, tvb, offset+i, 1,\r\nhandle, "Handle %d: %u", i, handle);\r\n}\r\npadding = 3 - (handles + 1 + 3) % 4;\r\nif (padding)\r\nproto_tree_add_item(pt, hf_gryphon_filthan_padding, tvb, offset+1+handles, padding, ENC_NA);\r\noffset += 1+handles+padding;\r\nreturn offset;\r\n}\r\nstatic int\r\ndfiltmode(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nproto_tree_add_item(pt, hf_gryphon_dfiltmode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pt, hf_gryphon_reserved, tvb, offset+1, 3, ENC_NA);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\nfiltmode(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nproto_tree_add_item(pt, hf_gryphon_filtmode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pt, hf_gryphon_reserved, tvb, offset+1, 3, ENC_NA);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\nresp_events(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nint msglen;\r\nunsigned int i;\r\nproto_tree *tree;\r\nmsglen = tvb_reported_length_remaining(tvb, offset);\r\ni = 1;\r\nwhile (msglen != 0) {\r\ntree = proto_tree_add_subtree_format(pt, tvb, offset, 20, ett_gryphon_cmd_events_data, NULL, "Event %d:", i);\r\nproto_tree_add_item(tree, hf_gryphon_event_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gryphon_event_name, tvb, offset+1, 19, ENC_NA|ENC_ASCII);\r\noffset += 20;\r\nmsglen -= 20;\r\ni++;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ncmd_register(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nproto_tree_add_item(pt, hf_gryphon_register_username, tvb, offset, 16, ENC_NA|ENC_ASCII);\r\noffset += 16;\r\nproto_tree_add_item(pt, hf_gryphon_register_password, tvb, offset, 32, ENC_NA|ENC_ASCII);\r\noffset += 32;\r\nreturn offset;\r\n}\r\nstatic int\r\nresp_register(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nproto_tree_add_item(pt, hf_gryphon_register_client_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pt, hf_gryphon_register_privileges, tvb, offset+1, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pt, hf_gryphon_reserved, tvb, offset+2, 2, ENC_NA);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\nresp_getspeeds(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nint indx,\r\nsize = tvb_get_guint8(tvb, offset+8),\r\nnumber = tvb_get_guint8(tvb, offset+9);\r\nproto_tree_add_item(pt, hf_gryphon_getspeeds_set_ioctl, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pt, hf_gryphon_getspeeds_get_ioctl, tvb, offset+4, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pt, hf_gryphon_getspeeds_size, tvb, offset+8, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pt, hf_gryphon_getspeeds_preset, tvb, offset+9, 1, ENC_BIG_ENDIAN);\r\noffset += 10;\r\nfor (indx = 1; indx <= number; indx++) {\r\nproto_tree_add_bytes_format(pt, hf_gryphon_getspeeds_data, tvb, offset, size,\r\ntvb_get_ptr(tvb, offset, size), "Data for preset %d", indx);\r\noffset += size;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ncmd_sort(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nproto_tree_add_item(pt, hf_gryphon_cmd_sort, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nreturn (offset+1);\r\n}\r\nstatic int\r\ncmd_optimize(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nproto_tree_add_item(pt, hf_gryphon_cmd_optimize, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nreturn (offset+1);\r\n}\r\nstatic int\r\nresp_config(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nproto_tree *ft, *tree;\r\nint devices;\r\nint i;\r\nunsigned int j, x;\r\nproto_tree_add_item(pt, hf_gryphon_config_device_name, tvb, offset, 20, ENC_NA|ENC_ASCII);\r\noffset += 20;\r\nproto_tree_add_item(pt, hf_gryphon_config_device_version, tvb, offset, 8, ENC_NA|ENC_ASCII);\r\noffset += 8;\r\nproto_tree_add_item(pt, hf_gryphon_config_device_serial_number, tvb, offset, 20, ENC_NA|ENC_ASCII);\r\noffset += 20;\r\ndevices = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(pt, hf_gryphon_config_num_channels, tvb, offset+1, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pt, hf_gryphon_config_name_version_ext, tvb, offset+1, 11, ENC_NA|ENC_ASCII);\r\nproto_tree_add_item(pt, hf_gryphon_reserved, tvb, offset+12, 4, ENC_NA);\r\noffset += 16;\r\nfor (i = 1; i <= devices; i++) {\r\nft = proto_tree_add_subtree_format(pt, tvb, offset, 80, ett_gryphon_cmd_config_device, NULL, "Channel %d:", i);\r\nproto_tree_add_item(ft, hf_gryphon_config_driver_name, tvb, offset, 20, ENC_NA|ENC_ASCII);\r\noffset += 20;\r\nproto_tree_add_item(ft, hf_gryphon_config_driver_version, tvb, offset, 8, ENC_NA|ENC_ASCII);\r\noffset += 8;\r\nproto_tree_add_item(ft, hf_gryphon_config_device_security, tvb, offset, 16, ENC_NA|ENC_ASCII);\r\noffset += 16;\r\nx = tvb_get_ntohl (tvb, offset);\r\nif (x) {\r\ntree = proto_tree_add_subtree(ft, tvb, offset, 4, ett_gryphon_valid_headers, NULL, "Valid Header lengths");\r\nfor (j = 0; ; j++) {\r\nif (x & 1) {\r\nproto_tree_add_uint_format(tree, hf_gryphon_valid_header_length, tvb, offset, 4, j, "%d byte%s", j,\r\nj == 1 ? "" : "s");\r\n}\r\nif ((x >>= 1) == 0)\r\nbreak;\r\n}\r\n}\r\noffset += 4;\r\nproto_tree_add_item(ft, hf_gryphon_config_max_data_length, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(ft, hf_gryphon_config_min_data_length, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(ft, hf_gryphon_config_hardware_serial_number, tvb, offset, 20, ENC_NA|ENC_ASCII);\r\noffset += 20;\r\nproto_tree_add_item(ft, hf_gryphon_config_protocol_type, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(ft, hf_gryphon_config_channel_id, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(ft, hf_gryphon_config_card_slot_number, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset ++;\r\nproto_tree_add_item(ft, hf_gryphon_config_max_extra_data, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(ft, hf_gryphon_config_min_extra_data, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ncmd_sched(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nint msglen;\r\nproto_item *item, *item1;\r\nproto_tree *tree, *tree1;\r\nint save_offset;\r\nunsigned int i, x, length;\r\nunsigned char def_chan = tvb_get_guint8(tvb, offset-9);\r\nmsglen = tvb_reported_length_remaining(tvb, offset);\r\nif (tvb_get_ntohl(tvb, offset) == 0xFFFFFFFF)\r\nproto_tree_add_uint_format_value(pt, hf_gryphon_sched_num_iterations, tvb, offset, 4,\r\n0, "Number of iterations: \"infinite\"");\r\nelse\r\nproto_tree_add_item(pt, hf_gryphon_sched_num_iterations, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nmsglen -= 4;\r\nitem = proto_tree_add_item(pt, hf_gryphon_sched_flags, tvb, offset, 4, ENC_BIG_ENDIAN);\r\ntree = proto_item_add_subtree (item, ett_gryphon_flags);\r\nproto_tree_add_item(tree, hf_gryphon_sched_flags_scheduler, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nmsglen -= 4;\r\ni = 1;\r\nwhile (msglen > 0) {\r\nlength = 16 + tvb_get_guint8(tvb, offset+16) +\r\ntvb_get_ntohs(tvb, offset+18) + tvb_get_guint8(tvb, offset+20) + 16;\r\nlength += 3 - (length + 3) % 4;\r\ntree = proto_tree_add_subtree_format(pt, tvb, offset, length, ett_gryphon_cmd_sched_data, NULL, "Message %d", i);\r\nproto_tree_add_item(tree, hf_gryphon_sched_sleep, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nmsglen -= 4;\r\nproto_tree_add_item(tree, hf_gryphon_sched_transmit_count, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nmsglen -= 4;\r\nproto_tree_add_item(tree, hf_gryphon_sched_transmit_period, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nmsglen -= 4;\r\nitem1 = proto_tree_add_item(tree, hf_gryphon_sched_transmit_flags, tvb, offset, 2, ENC_BIG_ENDIAN);\r\ntree1 = proto_item_add_subtree (item1, ett_gryphon_flags);\r\nproto_tree_add_item(tree1, hf_gryphon_sched_skip_transmit_period, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nif (i == 1) {\r\nproto_tree_add_item(tree1, hf_gryphon_sched_skip_sleep, tvb, offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nx = tvb_get_guint8(tvb, offset+2);\r\nif (x == 0)\r\nx = def_chan;\r\nproto_tree_add_uint(tree, hf_gryphon_sched_channel, tvb, offset+2, 1, x);\r\nproto_tree_add_item(tree, hf_gryphon_reserved, tvb, offset+3, 1, ENC_NA);\r\noffset += 4;\r\nmsglen -= 4;\r\ntree1 = proto_tree_add_subtree(tree, tvb, offset, length, ett_gryphon_cmd_sched_cmd, NULL, "Message");\r\nsave_offset = offset;\r\noffset = decode_data(tvb, offset, tree1);\r\nmsglen -= offset - save_offset;\r\ni++;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ncmd_sched_rep(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nunsigned int x;\r\nconst char *type;\r\nx = tvb_get_ntohl(tvb, offset);\r\nif (x & 0x80000000)\r\ntype = "Critical";\r\nelse\r\ntype = "Normal";\r\nproto_tree_add_uint_format_value(pt, hf_gryphon_sched_rep_id, tvb,\r\noffset, 4, x, "%s schedule ID: %u", type, x);\r\noffset += 4;\r\nproto_tree_add_item(pt, hf_gryphon_sched_rep_message_index, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pt, hf_gryphon_reserved, tvb, offset+1, 3, ENC_NA);\r\noffset += 4;\r\noffset = decode_data(tvb, offset, pt);\r\nreturn offset;\r\n}\r\nstatic int\r\nresp_blm_data(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nint x;\r\nnstime_t timestamp;\r\ntimestamp.secs = tvb_get_ntohl(tvb, offset)/100000;\r\ntimestamp.nsecs = (tvb_get_ntohl(tvb, offset)%100000)*1000;\r\nproto_tree_add_time(pt, hf_gryphon_blm_data_time, tvb, offset, 4, &timestamp);\r\noffset += 4;\r\nx = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_uint_format_value(pt, hf_gryphon_blm_data_bus_load, tvb,\r\noffset, 2, x, "%d.%02d%%", x / 100, x % 100);\r\noffset += 2;\r\nx = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_uint_format_value(pt, hf_gryphon_blm_data_current_bus_load, tvb,\r\noffset, 2, x, "%d.%02d%%", x / 100, x % 100);\r\noffset += 2;\r\nx = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_uint_format_value(pt, hf_gryphon_blm_data_peak_bus_load, tvb,\r\noffset, 2, x, "%d.%02d%%", x / 100, x % 100);\r\noffset += 2;\r\nx = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_uint_format_value(pt, hf_gryphon_blm_data_historic_peak_bus_load, tvb,\r\noffset, 2, x, "%d.%02d%%", x / 100, x % 100);\r\noffset += 2;\r\nreturn offset;\r\n}\r\nstatic int\r\nresp_blm_stat(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\noffset = resp_blm_data(tvb, offset, pt);\r\nproto_tree_add_item(pt, hf_gryphon_blm_stat_receive_frame_count, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(pt, hf_gryphon_blm_stat_transmit_frame_count, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(pt, hf_gryphon_blm_stat_receive_dropped_frame_count, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(pt, hf_gryphon_blm_stat_transmit_dropped_frame_count, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(pt, hf_gryphon_blm_stat_receive_error_count, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(pt, hf_gryphon_blm_stat_transmit_error_count, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\ncmd_addresp(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nproto_item *item;\r\nproto_tree *tree;\r\nint blocks, responses, i, msglen, length;\r\nint action, actionType, actionValue;\r\ntvbuff_t *next_tvb;\r\nactionType = 0;\r\nitem = proto_tree_add_item(pt, hf_gryphon_addresp_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ntree = proto_item_add_subtree (item, ett_gryphon_flags);\r\nproto_tree_add_item(tree, hf_gryphon_addresp_flags_active, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nblocks = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_gryphon_addresp_blocks, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nresponses = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tree, hf_gryphon_addresp_responses, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(tree, hf_gryphon_addresp_old_handle, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\naction = tvb_get_guint8(tvb, offset);\r\nitem = proto_tree_add_item(tree, hf_gryphon_addresp_action, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ntree = proto_item_add_subtree (item, ett_gryphon_flags);\r\nactionValue = tvb_get_ntohs(tvb, offset+2);\r\nif (actionValue) {\r\nif (action & FR_PERIOD_MSGS) {\r\nactionType = 1;\r\n} else {\r\nactionType = 0;\r\n}\r\nproto_tree_add_item(tree, hf_gryphon_addresp_action_period, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nproto_tree_add_item(tree, hf_gryphon_addresp_action_deact_on_event, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_gryphon_addresp_action_deact_after_period, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(pt, hf_gryphon_reserved, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\nif (actionValue) {\r\nif (actionType == 1) {\r\nproto_tree_add_uint_format_value(tree, hf_gryphon_addresp_action_period_type, tvb,\r\noffset, 2, actionValue, "Period: %d messages", actionValue);\r\n} else {\r\nproto_tree_add_uint_format_value(tree, hf_gryphon_addresp_action_period_type, tvb,\r\noffset, 2, actionValue, "Period: %d.%02d seconds", actionValue/100, actionValue%100);\r\n}\r\n}\r\noffset += 2;\r\nfor (i = 1; i <= blocks; i++) {\r\nlength = tvb_get_ntohs(tvb, offset+2) * 2 + 8;\r\nlength += 3 - (length + 3) % 4;\r\ntree = proto_tree_add_subtree_format(pt, tvb, offset, length, ett_gryphon_cmd_filter_block, NULL, "Filter block %d", i);\r\noffset = filter_block(tvb, offset, tree);\r\n}\r\nfor (i = 1; i <= responses; i++) {\r\nmsglen = tvb_get_ntohs(tvb, offset+4) + 8;\r\nlength = msglen + 3 - (msglen + 3) % 4;\r\ntree = proto_tree_add_subtree_format(pt, tvb, offset, length, ett_gryphon_cmd_response_block, NULL, "Response block %d", i);\r\nnext_tvb = tvb_new_subset_length(tvb, offset, msglen);\r\ndissect_gryphon_message(next_tvb, NULL, tree, TRUE);\r\noffset += length;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\nresp_addresp(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nproto_tree_add_item(pt, hf_gryphon_addresp_handle, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pt, hf_gryphon_reserved, tvb, offset+1, 3, ENC_NA);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\ncmd_modresp(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nguint8 dest = tvb_get_guint8(tvb, offset-5),\r\nresp_handle = tvb_get_guint8(tvb, offset);\r\nif (resp_handle)\r\nproto_tree_add_item(pt, hf_gryphon_modresp_handle, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nelse if (dest)\r\nproto_tree_add_uint_format_value(pt, hf_gryphon_modresp_handle, tvb,\r\noffset, 1, dest, "Response handles: all on channel %c", dest);\r\nelse\r\nproto_tree_add_uint_format_value(pt, hf_gryphon_modresp_handle, tvb, offset, 1,\r\n0, "Response handles: all");\r\nproto_tree_add_item(pt, hf_gryphon_modresp_action, tvb, offset+1, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pt, hf_gryphon_reserved, tvb, offset+2, 2, ENC_NA);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\nresp_resphan(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nint handles = tvb_get_guint8(tvb, offset);\r\nint i, padding, handle;\r\nproto_tree_add_item(pt, hf_gryphon_num_resphan, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nfor (i = 1; i <= handles; i++){\r\nhandle = tvb_get_guint8(tvb, offset+i);\r\nproto_tree_add_uint_format(pt, hf_gryphon_handle, tvb, offset+i, 1, handle, "Handle %d: %u", i,\r\nhandle);\r\n}\r\npadding = 3 - (handles + 1 + 3) % 4;\r\nif (padding)\r\nproto_tree_add_item(pt, hf_gryphon_padding, tvb, offset+1+handles, padding, ENC_NA);\r\noffset += 1+handles+padding;\r\nreturn offset;\r\n}\r\nstatic int\r\nresp_sched(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nproto_tree_add_item(pt, hf_gryphon_transmit_sched_id, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\ncmd_desc(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nproto_tree_add_item(pt, hf_gryphon_desc_program_size, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(pt, hf_gryphon_desc_program_name, tvb, offset, 32, ENC_NA|ENC_ASCII);\r\noffset += 32;\r\nproto_tree_add_item(pt, hf_gryphon_desc_program_description, tvb, offset, 80, ENC_NA|ENC_ASCII);\r\noffset += 80;\r\nreturn offset;\r\n}\r\nstatic int\r\nresp_desc(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nproto_item *item;\r\nproto_tree *tree;\r\nitem = proto_tree_add_item(pt, hf_gryphon_desc_flags, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ntree = proto_item_add_subtree (item, ett_gryphon_flags);\r\nproto_tree_add_item(tree, hf_gryphon_desc_flags_program, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pt, hf_gryphon_desc_handle, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pt, hf_gryphon_reserved, tvb, offset+2, 2, ENC_NA);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\ncmd_upload(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nint msglen;\r\nunsigned int length;\r\nmsglen = tvb_reported_length_remaining(tvb, offset);\r\nproto_tree_add_item(pt, hf_gryphon_upload_block_number, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pt, hf_gryphon_upload_handle, tvb, offset+2, 1, ENC_BIG_ENDIAN);\r\noffset += 3;\r\nmsglen -= 3;\r\nlength = msglen;\r\nproto_tree_add_item(pt, hf_gryphon_upload_data, tvb, offset, length, ENC_NA);\r\noffset += length;\r\nlength = 3 - (length + 3) % 4;\r\nif (length) {\r\nproto_tree_add_item(pt, hf_gryphon_padding, tvb, offset, length, ENC_NA);\r\noffset += length;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ncmd_delete(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nproto_tree_add_item(pt, hf_gryphon_delete, tvb, offset, 32, ENC_NA|ENC_ASCII);\r\noffset += 32;\r\nreturn offset;\r\n}\r\nstatic int\r\ncmd_list(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nproto_tree_add_item(pt, hf_gryphon_list_block_number, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pt, hf_gryphon_reserved, tvb, offset+1, 3, ENC_NA);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\nresp_list(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nproto_tree *tree;\r\nunsigned int i, count;\r\ncount = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(pt, hf_gryphon_list_num_programs, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pt, hf_gryphon_reserved, tvb, offset+1, 1, ENC_NA);\r\noffset += 2;\r\nproto_tree_add_item(pt, hf_gryphon_list_num_remain_programs, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nfor (i = 1; i <= count; i++) {\r\ntree = proto_tree_add_subtree_format(pt, tvb, offset, 112, ett_gryphon_pgm_list, NULL, "Program %u", i);\r\nproto_tree_add_item(tree, hf_gryphon_list_name, tvb, offset, 32, ENC_NA|ENC_ASCII);\r\noffset += 32;\r\nproto_tree_add_item(tree, hf_gryphon_list_description, tvb, offset, 80, ENC_NA|ENC_ASCII);\r\noffset += 80;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ncmd_start(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nchar *string;\r\ngint length;\r\nint msglen;\r\nint hdr_stuff = offset;\r\nmsglen = tvb_reported_length_remaining(tvb, offset);\r\noffset = cmd_delete(tvb, offset, pt);\r\nif (offset < msglen + hdr_stuff) {\r\nstring = tvb_get_stringz_enc(wmem_packet_scope(), tvb, offset, &length, ENC_ASCII);\r\nif (length > 1) {\r\nproto_tree_add_string(pt, hf_gryphon_start_arguments, tvb, offset,\r\nlength, string);\r\noffset += length;\r\nlength = 3 - (length + 3) % 4;\r\nif (length) {\r\nproto_tree_add_item(pt, hf_gryphon_padding, tvb, offset, length, ENC_NA);\r\noffset += length;\r\n}\r\n}\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\nresp_start(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nint msglen;\r\nmsglen = tvb_reported_length_remaining(tvb, offset);\r\nif (msglen > 0) {\r\nproto_tree_add_item(pt, hf_gryphon_start_channel, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pt, hf_gryphon_reserved, tvb, offset+1, 3, ENC_NA);\r\noffset += 4;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\nresp_status(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nproto_item *item;\r\nproto_tree *tree;\r\nunsigned int i, copies, length, channel;\r\ncopies = tvb_get_guint8(tvb, offset);\r\nitem = proto_tree_add_item(pt, hf_gryphon_status_num_running_copies, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ntree = proto_item_add_subtree (item, ett_gryphon_pgm_status);\r\noffset += 1;\r\nif (copies) {\r\nfor (i = 1; i <= copies; i++) {\r\nchannel = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_uint_format(tree, hf_gryphon_program_channel_number, tvb, offset, 1, channel,\r\n"Program %u channel (client) number %u", i, channel);\r\noffset += 1;\r\n}\r\n}\r\nlength = 3 - (copies + 1 + 3) % 4;\r\nif (length) {\r\nproto_tree_add_item(pt, hf_gryphon_padding, tvb, offset, length, ENC_NA);\r\noffset += length;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ncmd_options(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nint msglen;\r\nproto_tree *tree;\r\nunsigned int i, size, padding, option, option_length, option_value;\r\nconst char *string, *string1;\r\nmsglen = tvb_reported_length_remaining(tvb, offset);\r\nproto_tree_add_item(pt, hf_gryphon_options_handle, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pt, hf_gryphon_reserved, tvb, offset+1, 3, ENC_NA);\r\noffset += 4;\r\nmsglen -= 4;\r\nfor (i = 1; msglen > 0; i++) {\r\noption_length = tvb_get_guint8(tvb, offset+1);\r\nsize = option_length + 2;\r\npadding = 3 - ((size + 3) %4);\r\ntree = proto_tree_add_subtree_format(pt, tvb, offset, size + padding, ett_gryphon_pgm_options, NULL, "Option number %u", i);\r\noption = tvb_get_guint8(tvb, offset);\r\nswitch (option_length) {\r\ncase 1:\r\noption_value = tvb_get_guint8(tvb, offset+2);\r\nbreak;\r\ncase 2:\r\noption_value = tvb_get_ntohs(tvb, offset+2);\r\nbreak;\r\ncase 4:\r\noption_value = tvb_get_ntohl(tvb, offset+2);\r\nbreak;\r\ndefault:\r\noption_value = 0;\r\n}\r\nstring = "unknown option";\r\nstring1 = "unknown option data";\r\nswitch (option) {\r\ncase PGM_CONV:\r\nstring = "Type of data in the file";\r\nswitch (option_value) {\r\ncase PGM_BIN:\r\nstring1 = "Binary - Don't modify";\r\nbreak;\r\ncase PGM_ASCII:\r\nstring1 = "ASCII - Remove CR's";\r\nbreak;\r\n}\r\nbreak;\r\ncase PGM_TYPE:\r\nstring = "Type of file";\r\nswitch (option_value) {\r\ncase PGM_PGM:\r\nstring1 = "Executable";\r\nbreak;\r\ncase PGM_DATA:\r\nstring1 = "Data";\r\nbreak;\r\n}\r\nbreak;\r\n}\r\nproto_tree_add_uint_format_value(tree, hf_gryphon_option, tvb, offset, 1, option, "%s", string);\r\nproto_tree_add_bytes_format_value(tree, hf_gryphon_option_data, tvb, offset+2, option_length, NULL, "%s", string1);\r\nif (padding)\r\nproto_tree_add_item(tree, hf_gryphon_padding, tvb, offset+option_length+2, padding, ENC_NA);\r\noffset += size + padding;\r\nmsglen -= size + padding;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ncmd_files(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nint msglen;\r\nguint8 file;\r\nmsglen = tvb_reported_length_remaining(tvb, offset);\r\nfile = tvb_get_guint8(tvb, offset);\r\nif (file == 0)\r\nproto_tree_add_uint_format(pt, hf_gryphon_cmd_file, tvb, offset, 1, file, "First group of names");\r\nelse\r\nproto_tree_add_uint_format(pt, hf_gryphon_cmd_file, tvb, offset, 1, file, "Subsequent group of names");\r\nproto_tree_add_item(pt, hf_gryphon_files, tvb, offset+1, msglen-1, ENC_NA|ENC_ASCII);\r\noffset += msglen;\r\nreturn offset;\r\n}\r\nstatic int\r\nresp_files(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nint msglen;\r\nguint8 flag;\r\nmsglen = tvb_reported_length_remaining(tvb, offset);\r\nflag = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_uint_format_value(pt, hf_gryphon_more_filenames, tvb, offset, 1, flag, "%s", flag ? "Yes": "No");\r\nproto_tree_add_item(pt, hf_gryphon_filenames, tvb, offset+1, msglen-1, ENC_ASCII|ENC_NA);\r\noffset += msglen;\r\nreturn offset;\r\n}\r\nstatic int\r\ncmd_usdt(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nint ids, id, remain, size, i, bytes;\r\nguint8 flags;\r\nproto_tree *localTree;\r\nproto_item *localItem;\r\nflags = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(pt, hf_gryphon_usdt_flags_register, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nif (flags & 1) {\r\nstatic const int * action_flags[] = {\r\n&hf_gryphon_usdt_action_flags_register,\r\n&hf_gryphon_usdt_action_flags_action,\r\nNULL\r\n};\r\nstatic const int * transmit_option_flags[] = {\r\n&hf_gryphon_usdt_transmit_options_flags_echo,\r\n&hf_gryphon_usdt_transmit_options_action,\r\n&hf_gryphon_usdt_transmit_options_send_done,\r\nNULL\r\n};\r\nstatic const int * receive_option_flags[] = {\r\n&hf_gryphon_usdt_receive_options_action,\r\n&hf_gryphon_usdt_receive_options_firstframe,\r\n&hf_gryphon_usdt_receive_options_lastframe,\r\nNULL\r\n};\r\nproto_tree_add_bitmask(pt, tvb, offset, hf_gryphon_usdt_action_flags, ett_gryphon_flags, action_flags, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(pt, tvb, offset+1, hf_gryphon_usdt_transmit_options_flags, ett_gryphon_flags, transmit_option_flags, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(pt, tvb, offset+2, hf_gryphon_usdt_receive_options_flags, ett_gryphon_flags, receive_option_flags, ENC_BIG_ENDIAN);\r\nif ((ids = tvb_get_guint8(tvb, offset+3))) {\r\nlocalItem = proto_tree_add_item(pt, hf_gryphon_usdt_ext_address, tvb, offset+3, 1, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nlocalTree = proto_item_add_subtree (localItem, ett_gryphon_usdt_data);\r\nwhile (ids) {\r\nproto_tree_add_item(localTree, hf_gryphon_usdt_ext_address_id, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nids--;\r\n}\r\n} else {\r\nproto_tree_add_uint_format_value(pt, hf_gryphon_usdt_ext_address, tvb, offset+3, 1,\r\n0, "Using extended addressing for the single, internally defined, ID");\r\noffset += 4;\r\n}\r\nfor (i = 0; i < 2; i++) {\r\nbytes = tvb_reported_length_remaining (tvb, offset);\r\nif (bytes <= 0)\r\nbreak;\r\nlocalTree = proto_tree_add_subtree_format(pt, tvb, offset, 16, ett_gryphon_usdt_data, NULL, "%s block of USDT/UUDT IDs", i==0?"First":"Second");\r\nsize = tvb_get_ntohl (tvb, offset);\r\nlocalItem = proto_tree_add_item(localTree, hf_gryphon_usdt_block_size, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nlocalTree = proto_item_add_subtree (localItem, ett_gryphon_usdt_data_block);\r\nif (size == 0) {\r\nproto_item_set_len(localItem, 16);\r\n} else {\r\noffset += 4;\r\nid = tvb_get_ntohl (tvb, offset);\r\nproto_tree_add_uint_format_value(localTree, hf_gryphon_usdt_request, tvb, offset, 4, id, "%04X through %04X", id, id+size-1);\r\noffset += 4;\r\nid = tvb_get_ntohl (tvb, offset);\r\nproto_tree_add_uint_format_value(localTree, hf_gryphon_usdt_response, tvb, offset, 4, id, "%04X through %04X", id, id+size-1);\r\noffset += 4;\r\nid = tvb_get_ntohl (tvb, offset);\r\nproto_tree_add_uint_format_value(localTree, hf_gryphon_uudt_response, tvb, offset, 4, id, "%04X through %04X", id, id+size-1);\r\noffset += 4;\r\n}\r\n}\r\n} else {\r\nproto_tree_add_item(pt, hf_gryphon_reserved, tvb, offset+1, 3, ENC_NA);\r\noffset += 4;\r\n}\r\nif ((remain = tvb_reported_length_remaining(tvb, offset))) {\r\nproto_tree_add_item(pt, hf_gryphon_ignored, tvb, offset, remain, ENC_NA);\r\noffset += remain;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ncmd_bits_in (tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nint msglen, value;\r\nmsglen = tvb_reported_length_remaining(tvb, offset);\r\nvalue = tvb_get_guint8(tvb, offset);\r\nif (value) {\r\nstatic const int * digital_values[] = {\r\n&hf_gryphon_bits_in_input1,\r\n&hf_gryphon_bits_in_input2,\r\n&hf_gryphon_bits_in_input3,\r\n&hf_gryphon_bits_in_pushbutton,\r\nNULL\r\n};\r\nproto_tree_add_bitmask(pt, tvb, 1, hf_gryphon_bit_in_digital_data, ett_gryphon_digital_data, digital_values, ENC_NA);\r\n} else {\r\nproto_tree_add_uint_format(pt, hf_gryphon_bit_in_digital_data, tvb, offset, 1, value, "No digital values are set");\r\n}\r\noffset++;\r\nmsglen--;\r\nreturn offset;\r\n}\r\nstatic int\r\ncmd_bits_out (tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nint msglen, value;\r\nmsglen = tvb_reported_length_remaining(tvb, offset);\r\nvalue = tvb_get_guint8(tvb, offset);\r\nif (value) {\r\nstatic const int * digital_values[] = {\r\n&hf_gryphon_bits_out_output1,\r\n&hf_gryphon_bits_out_output2,\r\nNULL\r\n};\r\nproto_tree_add_bitmask(pt, tvb, 1, hf_gryphon_bit_out_digital_data, ett_gryphon_digital_data, digital_values, ENC_NA);\r\n} else {\r\nproto_tree_add_uint_format(pt, hf_gryphon_bit_out_digital_data, tvb, offset, 1, value, "No digital values are set");\r\n}\r\noffset++;\r\nmsglen--;\r\nreturn offset;\r\n}\r\nstatic int\r\ncmd_init_strat (tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nguint32 reset_limit;\r\nint msglen, indx;\r\nfloat value;\r\nmsglen = tvb_reported_length_remaining(tvb, offset);\r\nreset_limit = tvb_get_ntohl(tvb, offset);\r\nproto_tree_add_uint_format_value(pt, hf_gryphon_init_strat_reset_limit, tvb, offset, 4,\r\nreset_limit, "Reset Limit = %u messages", reset_limit);\r\noffset += 4;\r\nmsglen -= 4;\r\nfor (indx = 1; msglen; indx++, offset++, msglen--) {\r\nvalue = tvb_get_guint8(tvb, offset);\r\nif (value)\r\nproto_tree_add_float_format_value(pt, hf_gryphon_init_strat_delay, tvb, offset, 1,\r\nvalue/4, "Delay %d = %.2f seconds", indx, value/4);\r\nelse\r\nproto_tree_add_float_format_value(pt, hf_gryphon_init_strat_delay, tvb, offset, 1,\r\n0, "Delay %d = infinite", indx);\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\nspeed(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nproto_tree_add_item(pt, hf_gryphon_speed_baud_rate_index, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pt, hf_gryphon_reserved, tvb, offset+1, 3, ENC_NA);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\nfilter_block(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nunsigned int op;\r\nint length, padding;\r\nproto_tree_add_item(pt, hf_gryphon_filter_block_filter_start, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nlength = tvb_get_ntohs(tvb, offset+2);\r\nproto_tree_add_item(pt, hf_gryphon_filter_block_filter_length, tvb, offset+2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pt, hf_gryphon_filter_block_filter_type, tvb, offset+4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(pt, hf_gryphon_filter_block_filter_operator, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nop = tvb_get_guint8(tvb, offset+5);\r\nproto_tree_add_item(pt, hf_gryphon_reserved, tvb, offset+6, 2, ENC_NA);\r\noffset += 8;\r\nif (op == BIT_FIELD_CHECK) {\r\nproto_tree_add_item(pt, hf_gryphon_filter_block_pattern, tvb, offset, length, ENC_NA);\r\nproto_tree_add_item(pt, hf_gryphon_filter_block_mask, tvb, offset+length, length, ENC_NA);\r\n} else {\r\nswitch (length) {\r\ncase 1:\r\nproto_tree_add_item(pt, hf_gryphon_filter_block_filter_value1, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 2:\r\nproto_tree_add_item(pt, hf_gryphon_filter_block_filter_value2, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 4:\r\nproto_tree_add_item(pt, hf_gryphon_filter_block_filter_value4, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(pt, hf_gryphon_filter_block_filter_value_bytes, tvb, offset, length, ENC_NA);\r\n}\r\n}\r\noffset += length * 2;\r\npadding = 3 - (length * 2 + 3) % 4;\r\nif (padding) {\r\nproto_tree_add_item(pt, hf_gryphon_padding, tvb, offset, padding, ENC_NA);\r\noffset += padding;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\nblm_mode(tvbuff_t *tvb, int offset, proto_tree *pt)\r\n{\r\nproto_item *item;\r\nproto_tree *tree;\r\nint mode, milliseconds;\r\nmode = tvb_get_ntohl(tvb, offset);\r\nitem = proto_tree_add_item(pt, hf_gryphon_blm_mode, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nswitch (mode) {\r\ncase 1:\r\ntree = proto_item_add_subtree (item, ett_gryphon_blm_mode);\r\nmilliseconds = tvb_get_ntohl(tvb, offset);\r\nproto_tree_add_uint_format_value(tree, hf_gryphon_blm_mode_avg_period, tvb, offset, 4,\r\nmilliseconds, "Averaging period: %d.%03d seconds", milliseconds/1000, milliseconds%1000);\r\nbreak;\r\ncase 2:\r\ntree = proto_item_add_subtree (item, ett_gryphon_blm_mode);\r\nproto_tree_add_item(tree, hf_gryphon_blm_mode_avg_frames, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(pt, hf_gryphon_reserved, tvb, offset, 4, ENC_NA);\r\nbreak;\r\n}\r\noffset += 4;\r\nreturn offset;\r\n}\r\nvoid\r\nproto_register_gryphon(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_gryphon_src,\r\n{ "Source", "gryphon.src", FT_UINT8, BASE_HEX, VALS(src_dest), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_srcchan,\r\n{ "Source channel", "gryphon.srcchan", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_dest,\r\n{ "Destination", "gryphon.dest", FT_UINT8, BASE_HEX, VALS(src_dest), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_destchan,\r\n{ "Destination channel", "gryphon.destchan", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_type,\r\n{ "Frame type", "gryphon.type", FT_UINT8, BASE_DEC, VALS(frame_type), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_cmd,\r\n{ "Command", "gryphon.cmd", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_data,\r\n{ "Data", "gryphon.data", FT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_padding,\r\n{ "Padding", "gryphon.padding", FT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_ignored,\r\n{ "Ignored", "gryphon.ignored", FT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_data_length,\r\n{ "Data length (bytes)", "gryphon.data_length", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_reserved,\r\n{ "Reserved", "gryphon.reserved", FT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_wait_flags,\r\n{ "Flags", "gryphon.wait_flags", FT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_wait_resp,\r\n{ "Wait for response", "gryphon.wait_resp", FT_BOOLEAN, 8, TFS(&tfs_wait_response), DONT_WAIT_FOR_RESP,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_wait_prev_resp,\r\n{ "Wait for previous response", "gryphon.wait_prev_resp", FT_BOOLEAN, 8, TFS(&tfs_wait_response), WAIT_FOR_PREV_RESP,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_status,\r\n{ "Status", "gryphon.status", FT_UINT32, BASE_HEX, VALS(responses_vs), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_data_header_length,\r\n{ "Header length (bytes)", "gryphon.data.header_length", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_data_data_length,\r\n{ "Data length (bytes)", "gryphon.data.data_length", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_data_extra_data_length,\r\n{ "Extra data length (bytes)", "gryphon.data.extra_length", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_data_mode,\r\n{ "Mode", "gryphon.data.mode", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_data_mode_transmitted,\r\n{ "Transmitted message", "gryphon.data.mode.transmitted", FT_BOOLEAN, 8, TFS(&true_false), 0x80,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_data_mode_receive,\r\n{ "Received message", "gryphon.data.mode.receive", FT_BOOLEAN, 8, TFS(&true_false), 0x40,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_data_mode_local,\r\n{ "Local message", "gryphon.data.mode.local", FT_BOOLEAN, 8, TFS(&true_false), 0x20,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_data_mode_remote,\r\n{ "Remote message", "gryphon.data.mode.remote", FT_BOOLEAN, 8, TFS(&true_false), 0x10,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_data_mode_internal,\r\n{ "Internal message", "gryphon.data.mode.internal", FT_BOOLEAN, 8, TFS(&true_false), 0x01,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_data_priority,\r\n{ "Priority", "gryphon.data.priority", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_data_error_status,\r\n{ "Error status", "gryphon.data.error_status", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_data_time,\r\n{ "Timestamp", "gryphon.data.time", FT_RELATIVE_TIME, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_data_context,\r\n{ "Context", "gryphon.data.context", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_data_header_data,\r\n{ "Header", "gryphon.data.header_data", FT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_data_data,\r\n{ "Data", "gryphon.data.data", FT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_data_extra_data,\r\n{ "Extra data", "gryphon.data.extra_data", FT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_data_padding,\r\n{ "Padding", "gryphon.data.padding", FT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_event_id,\r\n{ "Event ID", "gryphon.event.id", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_event_name,\r\n{ "Event name", "gryphon.event.name", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_event_context,\r\n{ "Event context", "gryphon.event.context", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_event_time,\r\n{ "Timestamp", "gryphon.event.time", FT_RELATIVE_TIME, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_event_data,\r\n{ "Data", "gryphon.event.data", FT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_event_padding,\r\n{ "Padding", "gryphon.event.padding", FT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_misc_data,\r\n{ "Data", "gryphon.misc.data", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_misc_padding,\r\n{ "Padding", "gryphon.misc.padding", FT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_eventnum,\r\n{ "Event numbers", "gryphon.eventnum", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_resp_time,\r\n{ "Date/Time", "gryphon.resp_time", FT_ABSOLUTE_TIME, ABSOLUTE_TIME_LOCAL, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_setfilt,\r\n{ "Pass/Block flag", "gryphon.setfilt.flag", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_setfilt_length,\r\n{ "Length of Pattern & Mask", "gryphon.setfilt.length", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_setfilt_discard_data,\r\n{ "Discarded data", "gryphon.setfilt.discard_data", FT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_setfilt_padding,\r\n{ "Padding", "gryphon.setfilt.padding", FT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_ioctl,\r\n{ "IOCTL", "gryphon.ioctl", FT_UINT32, BASE_HEX, VALS(ioctls), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_ioctl_data,\r\n{ "Data", "gryphon.ioctl.data", FT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_addfilt_pass,\r\n{ "Conforming messages", "gryphon.addfilt.pass", FT_BOOLEAN, 8, TFS(&tfs_passed_blocked), FILTER_PASS_FLAG,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_addfilt_active,\r\n{ "Filter", "gryphon.addfilt.active", FT_BOOLEAN, 8, TFS(&active_inactive), FILTER_ACTIVE_FLAG,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_addfilt_blocks,\r\n{ "Number of filter blocks", "gryphon.addfilt.blocks", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_addfilt_handle,\r\n{ "Filter handle", "gryphon.addfilt.handle", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_modfilt,\r\n{ "Filter handle", "gryphon.modfilt", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_modfilt_action,\r\n{ "Action", "gryphon.modfilt.action", FT_UINT8, BASE_DEC, VALS(filtacts), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_filthan,\r\n{ "Number of filter handles", "gryphon.filthan", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_filthan_id,\r\n{ "Filter handle ID", "gryphon.filthan.id", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_filthan_padding,\r\n{ "Padding", "gryphon.filthan.padding", FT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_dfiltmode,\r\n{ "Filter mode", "gryphon.dfiltmode", FT_UINT8, BASE_DEC, VALS(dmodes), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_filtmode,\r\n{ "Filter mode", "gryphon.filtmode", FT_UINT8, BASE_DEC, VALS(modes), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_register_username,\r\n{ "Username", "gryphon.register.username", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_register_password,\r\n{ "Password", "gryphon.register.password", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_register_client_id,\r\n{ "Client ID", "gryphon.register.client_id", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_register_privileges,\r\n{ "Privileges", "gryphon.register.privileges", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_getspeeds_set_ioctl,\r\n{ "Set Speed IOCTL", "gryphon.getspeeds.set_ioctl", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_getspeeds_get_ioctl,\r\n{ "Get Speed IOCTL", "gryphon.getspeeds.get_ioctl", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_getspeeds_size,\r\n{ "Speed data size (bytes)", "gryphon.getspeeds.size", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_getspeeds_preset,\r\n{ "Preset speed numbers", "gryphon.getspeeds.preset", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_getspeeds_data,\r\n{ "Data for preset", "gryphon.getspeeds.data", FT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_cmd_sort,\r\n{ "Set sorting", "gryphon.cmd_sort", FT_UINT8, BASE_DEC, VALS(cmd_sort_type), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_cmd_optimize,\r\n{ "Set optimization", "gryphon.cmd_optimize", FT_UINT8, BASE_DEC, VALS(cmd_optimize_type), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_config_device_name,\r\n{ "Device name", "gryphon.config.device_name", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_config_device_version,\r\n{ "Device version", "gryphon.config.device_version", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_config_device_serial_number,\r\n{ "Device serial number", "gryphon.config.device_serial_number", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_config_num_channels,\r\n{ "Number of channels", "gryphon.config.num_channels", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_config_name_version_ext,\r\n{ "Name & version extension", "gryphon.config.name_version_ext", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_config_driver_name,\r\n{ "Driver name", "gryphon.config.driver_name", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_config_driver_version,\r\n{ "Driver version", "gryphon.config.driver_version", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_config_device_security,\r\n{ "Device security string", "gryphon.config.device_security", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_config_max_data_length,\r\n{ "Maximum data length (bytes)", "gryphon.config.max_data_length", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_config_min_data_length,\r\n{ "Minimum data length (bytes)", "gryphon.config.min_data_length", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_config_hardware_serial_number,\r\n{ "Hardware serial number", "gryphon.config.hardware_serial_number", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_config_protocol_type,\r\n{ "Protocol type & subtype", "gryphon.config.protocol_type", FT_UINT16, BASE_HEX, VALS(protocol_types), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_config_channel_id,\r\n{ "Channel ID", "gryphon.config.channel_id", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_config_card_slot_number,\r\n{ "Card slot number", "gryphon.config.card_slot_number", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_config_max_extra_data,\r\n{ "Maximum extra data (bytes)", "gryphon.config.max_extra_data", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_config_min_extra_data,\r\n{ "Minimum extra data (bytes)", "gryphon.config.min_extra_data", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_sched_num_iterations,\r\n{ "Number of iterations", "gryphon.sched.num_iterations", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_sched_flags,\r\n{ "Flags", "gryphon.sched.flags", FT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_sched_flags_scheduler,\r\n{ "Scheduler", "gryphon.sched.flags.scheduler", FT_BOOLEAN, 32, TFS(&critical_normal), 0x01,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_sched_sleep,\r\n{ "Sleep (milliseconds)", "gryphon.sched.sleep", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_sched_transmit_count,\r\n{ "Transmit count", "gryphon.sched.transmit_count", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_sched_transmit_period,\r\n{ "Transmit period (milliseconds)", "gryphon.sched.transmit_period", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_sched_transmit_flags,\r\n{ "Flags", "gryphon.sched.transmit_flags", FT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_sched_skip_transmit_period,\r\n{ "Last transmit period", "gryphon.sched.skip_transmit_period", FT_BOOLEAN, 16, TFS(&skip_not_skip), 0x01,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_sched_skip_sleep,\r\n{ "Last transmit period", "gryphon.sched.skip_transmit_period", FT_BOOLEAN, 16, TFS(&skip_not_skip), 0x01,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_sched_channel,\r\n{ "Channel", "gryphon.sched.channel", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_sched_rep_id,\r\n{ "Schedule ID", "gryphon.sched.rep_id", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_sched_rep_message_index,\r\n{ "Message index", "gryphon.sched.rep_message_index", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_blm_data_time,\r\n{ "Timestamp", "gryphon.blm_data.time", FT_RELATIVE_TIME, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_blm_data_bus_load,\r\n{ "Bus load average (%)", "gryphon.blm_data.bus_load", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_blm_data_current_bus_load,\r\n{ "Current bus load (%)", "gryphon.blm_data.current_bus_load", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_blm_data_peak_bus_load,\r\n{ "Peak bus load (%)", "gryphon.blm_data.peak_bus_load", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_blm_data_historic_peak_bus_load,\r\n{ "Historic peak bus load (%)", "gryphon.blm_data.historic_peak_bus_load", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_blm_stat_receive_frame_count,\r\n{ "Receive frame count", "gryphon.blm_stat.receive_frame_count", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_blm_stat_transmit_frame_count,\r\n{ "Transmit frame count", "gryphon.blm_stat.transmit_frame_count", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_blm_stat_receive_dropped_frame_count,\r\n{ "Receive dropped frame count", "gryphon.blm_stat.receive_dropped_frame_count", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_blm_stat_transmit_dropped_frame_count,\r\n{ "Transmit dropped frame count", "gryphon.blm_stat.transmit_dropped_frame_count", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_blm_stat_receive_error_count,\r\n{ "Receive error count", "gryphon.blm_stat.receive_error_count", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_blm_stat_transmit_error_count,\r\n{ "Transmit error count", "gryphon.blm_stat.transmit_error_count", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_addresp_flags,\r\n{ "Flags", "gryphon.addresp.flags", FT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_addresp_flags_active,\r\n{ "Response", "gryphon.addresp.flags.active", FT_BOOLEAN, 8, TFS(&active_inactive), FILTER_ACTIVE_FLAG,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_addresp_blocks,\r\n{ "Number of filter blocks", "gryphon.addresp.blocks", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_addresp_responses,\r\n{ "Number of response blocks", "gryphon.addresp.responses", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_addresp_old_handle,\r\n{ "Old handle", "gryphon.addresp.old_handle", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_addresp_action,\r\n{ "Old handle", "gryphon.addresp.action", FT_UINT8, BASE_DEC, VALS(action_vals), 0x07,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_addresp_action_period,\r\n{ "Period", "gryphon.addresp.action_period", FT_BOOLEAN, 8, TFS(&frames_01seconds), FR_PERIOD_MSGS,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_addresp_action_deact_on_event,\r\n{ "Deact on event", "gryphon.addresp.action.deact_on_event", FT_UINT8, BASE_DEC, VALS(deact_on_event_vals), FR_DELETE|FR_DEACT_ON_EVENT,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_addresp_action_deact_after_period,\r\n{ "Deact on Period", "gryphon.addresp.action.deact_after_period", FT_UINT8, BASE_DEC, VALS(deact_after_per_vals), FR_DELETE|FR_DEACT_AFTER_PER,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_addresp_action_period_type,\r\n{ "Period", "gryphon.addresp.action_period_type", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_addresp_handle,\r\n{ "Response handle", "gryphon.addresp.handle", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_modresp_handle,\r\n{ "Response handle", "gryphon.modresp.handle", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_modresp_action,\r\n{ "Action response", "gryphon.modresp.action", FT_UINT8, BASE_DEC, VALS(filtacts), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_num_resphan,\r\n{ "Number of response handles", "gryphon.num_resphan", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_handle,\r\n{ "Handle", "gryphon.handle", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_transmit_sched_id,\r\n{ "Transmit schedule ID", "gryphon.transmit_sched_id", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_desc_program_size,\r\n{ "Program size", "gryphon.desc.program_size", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_desc_program_name,\r\n{ "Program name", "gryphon.desc.program_name", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_desc_program_description,\r\n{ "Program description", "gryphon.desc.program_description", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_desc_flags,\r\n{ "Flags", "gryphon.desc.flags", FT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_desc_flags_program,\r\n{ "Period", "gryphon.desc.flags.program", FT_BOOLEAN, 8, TFS(&present_not_present), 0x01,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_desc_handle,\r\n{ "Handle", "gryphon.desc.handle", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_upload_block_number,\r\n{ "Block number", "gryphon.upload.block_number", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_upload_handle,\r\n{ "Handle", "gryphon.upload.handle", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_upload_data,\r\n{ "Data", "gryphon.upload.data", FT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_delete,\r\n{ "Program name", "gryphon.delete", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_list_block_number,\r\n{ "Block number", "gryphon.list.block_number", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_list_num_programs,\r\n{ "Number of programs in this response", "gryphon.list.num_programs", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_list_num_remain_programs,\r\n{ "Number of remaining programs", "gryphon.list.num_remain_programs", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_list_name,\r\n{ "Name", "gryphon.list.name", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_list_description,\r\n{ "Description", "gryphon.list.description", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_start_arguments,\r\n{ "Arguments", "gryphon.start.arguments", FT_STRINGZ, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_start_channel,\r\n{ "Channel (Client) number", "gryphon.start.channel", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_status_num_running_copies,\r\n{ "Number of running copies", "gryphon.status.num_running_copies", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_options_handle,\r\n{ "Handle", "gryphon.options.handle", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_files,\r\n{ "Directory", "gryphon.files", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_usdt_flags_register,\r\n{ "USDT", "gryphon.usdt.flags_register", FT_UINT8, BASE_DEC, VALS(register_unregister), 0x01,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_usdt_action_flags,\r\n{ "Action Flags", "gryphon.usdt.action_flags", FT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_usdt_action_flags_register,\r\n{ "Register", "gryphon.usdt.action_flags.register", FT_UINT8, BASE_DEC, VALS(register_unregister), 0x01,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_usdt_action_flags_action,\r\n{ "Action", "gryphon.usdt.action_flags.action", FT_UINT8, BASE_DEC, VALS(usdt_action_vals), 0x06,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_usdt_transmit_options_flags,\r\n{ "Transmit options", "gryphon.usdt.transmit_options_flags", FT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_usdt_transmit_options_flags_echo,\r\n{ "Echo long transmit messages back to the client", "gryphon.usdt.transmit_options_flags.echo",\r\nFT_BOOLEAN, 8, TFS(&yes_no), 0x01, NULL, HFILL }},\r\n{ &hf_gryphon_usdt_transmit_options_action,\r\n{ "Transmit Action", "gryphon.usdt.transmit_options_flags.action", FT_UINT8, BASE_DEC, VALS(xmit_opt_vals), 0x06,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_usdt_transmit_options_send_done,\r\n{ "Send a USDT_DONE event when the last frame of a multi-frame USDT message is transmitted",\r\n"gryphon.usdt.transmit_options_flags.send_done", FT_BOOLEAN, 8, TFS(&yes_no), 0x08, NULL, HFILL }},\r\n{ &hf_gryphon_usdt_receive_options_flags,\r\n{ "Receive options", "gryphon.usdt.receive_options_flags", FT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_usdt_receive_options_action,\r\n{ "Receive Action", "gryphon.usdt.receive_options_flags.action", FT_UINT8, BASE_DEC, VALS(recv_opt_vals), 0x03,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_usdt_receive_options_firstframe,\r\n{ "Send a USDT_FIRSTFRAME event when the first frame of a multi-frame USDT message is received",\r\n"gryphon.usdt.receive_options_flags.firstframe", FT_BOOLEAN, 8, TFS(&yes_no), 0x04, NULL, HFILL }},\r\n{ &hf_gryphon_usdt_receive_options_lastframe,\r\n{ "Send a USDT_LASTFRAME event when the first frame of a multi-frame USDT message is received",\r\n"gryphon.usdt.receive_options_flags.lastframe", FT_BOOLEAN, 8, TFS(&yes_no), 0x08, NULL, HFILL }},\r\n{ &hf_gryphon_usdt_ext_address,\r\n{ "Using extended addressing for", "gryphon.usdt.ext_address", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_usdt_ext_address_id,\r\n{ "ID", "gryphon.usdt.ext_address.id", FT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_usdt_block_size,\r\n{ "Number of IDs in the block", "gryphon.usdt.block_size", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_bits_in_input1,\r\n{ "Input 1", "gryphon.bits_in.input1", FT_BOOLEAN, 8, TFS(&set_not_set), 0x01,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_bits_in_input2,\r\n{ "Input 2", "gryphon.bits_in.input2", FT_BOOLEAN, 8, TFS(&set_not_set), 0x02,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_bits_in_input3,\r\n{ "Input 3", "gryphon.bits_in.input3", FT_BOOLEAN, 8, TFS(&set_not_set), 0x04,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_bits_in_pushbutton,\r\n{ "Pushbutton", "gryphon.bits_in.pushbutton", FT_BOOLEAN, 8, TFS(&set_not_set), 0x08,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_bits_out_output1,\r\n{ "Input 1", "gryphon.bits_out.output1", FT_BOOLEAN, 8, TFS(&set_not_set), 0x01,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_bits_out_output2,\r\n{ "Input 2", "gryphon.bits_out.output2", FT_BOOLEAN, 8, TFS(&set_not_set), 0x02,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_init_strat_reset_limit,\r\n{ "Reset Limit", "gryphon.init_strat.reset_limit", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_init_strat_delay,\r\n{ "Delay", "gryphon.init_strat.strat_delay", FT_FLOAT, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_speed_baud_rate_index,\r\n{ "Baud rate index", "gryphon.speed.baud_rate_index", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_filter_block_filter_start,\r\n{ "Filter field starts at byte", "gryphon.filter_block.filter_start", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_filter_block_filter_length,\r\n{ "Filter field length", "gryphon.filter_block.filter_length", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_filter_block_filter_type,\r\n{ "Filtering on", "gryphon.filter_block.filter_type", FT_UINT8, BASE_DEC, VALS(filter_data_types), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_filter_block_filter_operator,\r\n{ "Type of comparison", "gryphon.filter_block.filter_operator", FT_UINT8, BASE_DEC, VALS(operators), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_filter_block_filter_value1,\r\n{ "Value", "gryphon.filter_block.filter_value", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_filter_block_filter_value2,\r\n{ "Value", "gryphon.filter_block.filter_value", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_filter_block_filter_value4,\r\n{ "Value", "gryphon.filter_block.filter_value", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_filter_block_filter_value_bytes,\r\n{ "Value", "gryphon.filter_block.filter_value_bytes", FT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_blm_mode,\r\n{ "Mode", "gryphon.blm_mode", FT_UINT32, BASE_DEC, VALS(blm_mode_vals), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_blm_mode_avg_period,\r\n{ "Averaging period (seconds)", "gryphon.blm_mode.avg_period", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_blm_mode_avg_frames,\r\n{ "Averaging period (frames)", "gryphon.blm_mode.avg_frames", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_command,\r\n{ "Command", "gryphon.command", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_cmd_mode,\r\n{ "Mode", "gryphon.command.mode", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_option,\r\n{ "Option", "gryphon.option", FT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_option_data,\r\n{ "Option data", "gryphon.option_data", FT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_cmd_file,\r\n{ "File", "gryphon.command.file", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_bit_in_digital_data,\r\n{ "Digital values set", "gryphon.bit_in_digital_data", FT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_bit_out_digital_data,\r\n{ "Digital values set", "gryphon.bit_out_digital_data", FT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_filter_block_pattern,\r\n{ "Pattern", "gryphon.filter_block.pattern", FT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_filter_block_mask,\r\n{ "Mask", "gryphon.filter_block.mask", FT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_usdt_request,\r\n{ "USDT request IDs", "gryphon.usdt_request", FT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_usdt_response,\r\n{ "USDT response IDs", "gryphon.usdt_response", FT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_uudt_response,\r\n{ "UUDT response IDs", "gryphon.uudt_response", FT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_more_filenames,\r\n{ "More filenames to return", "gryphon.more_filenames", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_filenames,\r\n{ "File and directory names", "gryphon.filenames", FT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_program_channel_number,\r\n{ "Program channel number", "gryphon.program_channel_number", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gryphon_valid_header_length,\r\n{ "Valid Header length", "gryphon.valid_header_length", FT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_gryphon,\r\n&ett_gryphon_header,\r\n&ett_gryphon_body,\r\n&ett_gryphon_command_data,\r\n&ett_gryphon_response_data,\r\n&ett_gryphon_data_header,\r\n&ett_gryphon_flags,\r\n&ett_gryphon_data_body,\r\n&ett_gryphon_cmd_filter_block,\r\n&ett_gryphon_cmd_events_data,\r\n&ett_gryphon_cmd_config_device,\r\n&ett_gryphon_cmd_sched_data,\r\n&ett_gryphon_cmd_sched_cmd,\r\n&ett_gryphon_cmd_response_block,\r\n&ett_gryphon_pgm_list,\r\n&ett_gryphon_pgm_status,\r\n&ett_gryphon_pgm_options,\r\n&ett_gryphon_valid_headers,\r\n&ett_gryphon_usdt_data,\r\n&ett_gryphon_usdt_data_block,\r\n&ett_gryphon_digital_data,\r\n&ett_gryphon_blm_mode\r\n};\r\nmodule_t *gryphon_module;\r\nproto_gryphon = proto_register_protocol("DG Gryphon Protocol",\r\n"Gryphon",\r\n"gryphon");\r\nproto_register_field_array(proto_gryphon, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\ngryphon_module = prefs_register_protocol(proto_gryphon, NULL);\r\nprefs_register_bool_preference(gryphon_module, "desegment",\r\n"Desegment all Gryphon messages spanning multiple TCP segments",\r\n"Whether the Gryphon dissector should desegment all messages spanning multiple TCP segments",\r\n&gryphon_desegment);\r\n}\r\nvoid\r\nproto_reg_handoff_gryphon(void)\r\n{\r\ndissector_handle_t gryphon_handle;\r\ngryphon_handle = create_dissector_handle(dissect_gryphon, proto_gryphon);\r\ndissector_add_uint("tcp.port", 7000, gryphon_handle);\r\n}
