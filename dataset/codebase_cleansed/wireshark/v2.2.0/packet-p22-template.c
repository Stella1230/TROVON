static int\r\ndissect_p22(tvbuff_t *tvb, packet_info *pinfo, proto_tree *parent_tree, void* data _U_)\r\n{\r\nint offset = 0;\r\nproto_item *item=NULL;\r\nproto_tree *tree=NULL;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\nif (parent_tree) {\r\nitem = proto_tree_add_item(parent_tree, proto_p22, tvb, 0, -1, ENC_NA);\r\ntree = proto_item_add_subtree(item, ett_p22);\r\n}\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "P22");\r\ncol_set_str(pinfo->cinfo, COL_INFO, "InterPersonal");\r\ndissect_p22_InformationObject(TRUE, tvb, offset, &asn1_ctx , tree, -1);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid proto_register_p22(void) {\r\nstatic hf_register_info hf[] =\r\n{\r\n#include "packet-p22-hfarr.c"\r\n};\r\nstatic gint *ett[] = {\r\n&ett_p22,\r\n#include "packet-p22-ettarr.c"\r\n};\r\nproto_p22 = proto_register_protocol(PNAME, PSNAME, PFNAME);\r\nregister_dissector("p22", dissect_p22, proto_p22);\r\nproto_register_field_array(proto_p22, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid proto_reg_handoff_p22(void) {\r\n#include "packet-p22-dis-tab.c"\r\nregister_ber_oid_dissector("2.6.1.10.0", dissect_p22, proto_p22, "InterPersonal Message (1984)");\r\nregister_ber_oid_dissector("2.6.1.10.1", dissect_p22, proto_p22, "InterPersonal Message (1988)");\r\n}
