static void\r\ndissect_usb_hub_clear_hub_feature(packet_info *pinfo, proto_tree *tree, tvbuff_t *tvb, int offset, gboolean is_request, usb_trans_info_t *usb_trans_info _U_, usb_conv_info_t *usb_conv_info _U_)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *subtree = NULL;\r\nconst gchar* feature_name;\r\nfeature_name = val_to_str(usb_trans_info->setup.wValue,\r\nhub_class_feature_selectors_recipient_hub_vals,\r\n"UNKNOWN (0x%x)");\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " [Hub: %s]", feature_name);\r\nif (is_request) {\r\nitem = proto_tree_add_item(tree, hf_usb_hub_value, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wValue);\r\nproto_tree_add_item(subtree, hf_usb_hub_hub_feature_selector, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\noffset += 2;\r\nitem = proto_tree_add_item(tree, hf_usb_hub_index, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wIndex);\r\nproto_tree_add_item(subtree, hf_usb_hub_zero, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\noffset += 2;\r\nitem = proto_tree_add_item(tree, hf_usb_hub_length, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wLength);\r\nproto_tree_add_item(subtree, hf_usb_hub_zero, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\n} else {\r\n}\r\n}\r\nstatic void\r\ndissect_usb_hub_clear_port_feature(packet_info *pinfo, proto_tree *tree, tvbuff_t *tvb, int offset, gboolean is_request, usb_trans_info_t *usb_trans_info _U_, usb_conv_info_t *usb_conv_info _U_)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *subtree = NULL;\r\nconst gchar* feature_name;\r\nfeature_name = val_to_str(usb_trans_info->setup.wValue,\r\nhub_class_feature_selectors_recipient_port_vals,\r\n"UNKNOWN (0x%x)");\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " [Port %u: %s]", usb_trans_info->setup.wIndex, feature_name);\r\nif (is_request) {\r\nitem = proto_tree_add_item(tree, hf_usb_hub_value, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wValue);\r\nproto_tree_add_item(subtree, hf_usb_hub_port_feature_selector, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\noffset += 2;\r\nitem = proto_tree_add_item(tree, hf_usb_hub_index, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wIndex);\r\nproto_tree_add_item(subtree, hf_usb_hub_port, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(subtree, hf_usb_hub_port_selector, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset++;\r\nitem = proto_tree_add_item(tree, hf_usb_hub_length, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wLength);\r\nproto_tree_add_item(subtree, hf_usb_hub_zero, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\n} else {\r\n}\r\n}\r\nstatic void\r\ndissect_usb_hub_clear_tt_buffer(packet_info *pinfo _U_, proto_tree *tree, tvbuff_t *tvb, int offset, gboolean is_request, usb_trans_info_t *usb_trans_info _U_, usb_conv_info_t *usb_conv_info _U_)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *subtree = NULL;\r\nif (is_request) {\r\nitem = proto_tree_add_item(tree, hf_usb_hub_value, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wValue);\r\nproto_tree_add_item(subtree, hf_usb_hub_ep_num, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(subtree, hf_usb_hub_dev_addr, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(tree, hf_usb_hub_index, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wIndex);\r\nproto_tree_add_item(subtree, hf_usb_hub_tt_port, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_usb_hub_length, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wLength);\r\nproto_tree_add_item(subtree, hf_usb_hub_zero, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\n} else {\r\n}\r\n}\r\nstatic void\r\ndissect_usb_hub_get_hub_descriptor(packet_info *pinfo _U_, proto_tree *tree, tvbuff_t *tvb, int offset, gboolean is_request, usb_trans_info_t *usb_trans_info _U_, usb_conv_info_t *usb_conv_info _U_)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *subtree = NULL;\r\nif (is_request) {\r\nitem = proto_tree_add_item(tree, hf_usb_hub_value, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wValue);\r\nproto_tree_add_item(subtree, hf_usb_hub_descriptor_index, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(subtree, hf_usb_hub_descriptor_type, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset++;\r\nitem = proto_tree_add_item(tree, hf_usb_hub_index, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wIndex);\r\nproto_tree_add_item(subtree, hf_usb_hub_zero, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\noffset += 2;\r\nitem = proto_tree_add_item(tree, hf_usb_hub_length, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wLength);\r\nproto_tree_add_item(subtree, hf_usb_hub_descriptor_length, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\n} else {\r\n}\r\n}\r\nstatic void\r\ndissect_usb_hub_get_hub_status(packet_info *pinfo, proto_tree *tree, tvbuff_t *tvb, int offset, gboolean is_request, usb_trans_info_t *usb_trans_info _U_, usb_conv_info_t *usb_conv_info _U_)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *subtree = NULL;\r\ncol_append_str(pinfo->cinfo, COL_INFO, " [Hub]");\r\nif (is_request) {\r\nitem = proto_tree_add_item(tree, hf_usb_hub_value, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wValue);\r\nproto_tree_add_item(subtree, hf_usb_hub_zero, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\noffset += 2;\r\nitem = proto_tree_add_item(tree, hf_usb_hub_index, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wIndex);\r\nproto_tree_add_item(subtree, hf_usb_hub_zero, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_usb_hub_length, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\n} else {\r\n}\r\n}\r\nstatic void\r\ndissect_usb_hub_get_port_status(packet_info *pinfo, proto_tree *tree, tvbuff_t *tvb, int offset, gboolean is_request, usb_trans_info_t *usb_trans_info, usb_conv_info_t *usb_conv_info _U_)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *subtree = NULL;\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " [Port %u]", usb_trans_info->setup.wIndex);\r\nif (is_request) {\r\nitem = proto_tree_add_item(tree, hf_usb_hub_value, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wValue);\r\nproto_tree_add_item(subtree, hf_usb_hub_zero, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\noffset += 2;\r\nitem = proto_tree_add_item(tree, hf_usb_hub_index, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wIndex);\r\nproto_tree_add_item(subtree, hf_usb_hub_port, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_usb_hub_length, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\n} else {\r\nstatic const int *status_fields[] = {\r\n&hf_usb_hub_port_status_connection,\r\n&hf_usb_hub_port_status_enable,\r\n&hf_usb_hub_port_status_suspend,\r\n&hf_usb_hub_port_status_overcurrent,\r\n&hf_usb_hub_port_status_reset,\r\n&hf_usb_hub_port_status_power,\r\n&hf_usb_hub_port_status_low_speed,\r\n&hf_usb_hub_port_status_high_speed,\r\n&hf_usb_hub_port_status_test,\r\n&hf_usb_hub_port_status_indicator,\r\nNULL\r\n};\r\nstatic const int *change_fields[] = {\r\n&hf_usb_hub_port_change_connection,\r\n&hf_usb_hub_port_change_enable,\r\n&hf_usb_hub_port_change_suspend,\r\n&hf_usb_hub_port_change_overcurrent,\r\n&hf_usb_hub_port_change_reset,\r\nNULL\r\n};\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_usb_hub_port_status,\r\nett_usb_hub_port_status, status_fields, ENC_LITTLE_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_usb_hub_port_change,\r\nett_usb_hub_port_change, change_fields, ENC_LITTLE_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_usb_hub_get_tt_state(packet_info *pinfo _U_, proto_tree *tree, tvbuff_t *tvb, int offset, gboolean is_request, usb_trans_info_t *usb_trans_info _U_, usb_conv_info_t *usb_conv_info _U_)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *subtree = NULL;\r\nif (is_request) {\r\nitem = proto_tree_add_item(tree, hf_usb_hub_value, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wValue);\r\nproto_tree_add_item(subtree, hf_usb_hub_tt_flags, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset += 2;\r\nitem = proto_tree_add_item(tree, hf_usb_hub_index, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wIndex);\r\nproto_tree_add_item(subtree, hf_usb_hub_tt_port, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset += 2;\r\nitem = proto_tree_add_item(tree, hf_usb_hub_length, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wLength);\r\nproto_tree_add_item(subtree, hf_usb_hub_tt_state_length, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\n} else {\r\n}\r\n}\r\nstatic void\r\ndissect_usb_hub_reset_tt(packet_info *pinfo _U_, proto_tree *tree, tvbuff_t *tvb, int offset, gboolean is_request, usb_trans_info_t *usb_trans_info _U_, usb_conv_info_t *usb_conv_info _U_)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *subtree = NULL;\r\nif (is_request) {\r\nitem = proto_tree_add_item(tree, hf_usb_hub_value, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wValue);\r\nproto_tree_add_item(subtree, hf_usb_hub_zero, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset += 2;\r\nitem = proto_tree_add_item(tree, hf_usb_hub_index, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wIndex);\r\nproto_tree_add_item(subtree, hf_usb_hub_tt_port, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset += 2;\r\nitem = proto_tree_add_item(tree, hf_usb_hub_length, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wLength);\r\nproto_tree_add_item(subtree, hf_usb_hub_zero, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\n} else {\r\n}\r\n}\r\nstatic void\r\ndissect_usb_hub_set_hub_descriptor(packet_info *pinfo _U_, proto_tree *tree, tvbuff_t *tvb, int offset, gboolean is_request, usb_trans_info_t *usb_trans_info _U_, usb_conv_info_t *usb_conv_info _U_)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *subtree = NULL;\r\nif (is_request) {\r\nitem = proto_tree_add_item(tree, hf_usb_hub_value, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wValue);\r\nproto_tree_add_item(subtree, hf_usb_hub_descriptor_index, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(subtree, hf_usb_hub_descriptor_type, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset++;\r\nitem = proto_tree_add_item(tree, hf_usb_hub_index, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wIndex);\r\nproto_tree_add_item(subtree, hf_usb_hub_zero, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\noffset += 2;\r\nitem = proto_tree_add_item(tree, hf_usb_hub_length, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wLength);\r\nproto_tree_add_item(subtree, hf_usb_hub_descriptor_length, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\n} else {\r\n}\r\n}\r\nstatic void\r\ndissect_usb_hub_stop_tt(packet_info *pinfo _U_, proto_tree *tree, tvbuff_t *tvb, int offset, gboolean is_request, usb_trans_info_t *usb_trans_info _U_, usb_conv_info_t *usb_conv_info _U_)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *subtree = NULL;\r\nif (is_request) {\r\nitem = proto_tree_add_item(tree, hf_usb_hub_value, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wValue);\r\nproto_tree_add_item(subtree, hf_usb_hub_zero, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset += 2;\r\nitem = proto_tree_add_item(tree, hf_usb_hub_index, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wIndex);\r\nproto_tree_add_item(subtree, hf_usb_hub_tt_port, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\noffset += 2;\r\nitem = proto_tree_add_item(tree, hf_usb_hub_length, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wLength);\r\nproto_tree_add_item(subtree, hf_usb_hub_zero, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\n} else {\r\n}\r\n}\r\nstatic void\r\ndissect_usb_hub_set_hub_feature(packet_info *pinfo, proto_tree *tree, tvbuff_t *tvb, int offset, gboolean is_request, usb_trans_info_t *usb_trans_info, usb_conv_info_t *usb_conv_info _U_)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *subtree = NULL;\r\nconst gchar* feature_name;\r\nfeature_name = val_to_str(usb_trans_info->setup.wValue,\r\nhub_class_feature_selectors_recipient_hub_vals,\r\n"UNKNOWN (0x%x)");\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " [Hub: %s]", feature_name);\r\nif (is_request) {\r\nitem = proto_tree_add_item(tree, hf_usb_hub_value, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wValue);\r\nproto_tree_add_item(subtree, hf_usb_hub_hub_feature_selector, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\noffset += 2;\r\nitem = proto_tree_add_item(tree, hf_usb_hub_index, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wIndex);\r\nproto_tree_add_item(subtree, hf_usb_hub_zero, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\noffset += 2;\r\nitem = proto_tree_add_item(tree, hf_usb_hub_length, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wLength);\r\nproto_tree_add_item(subtree, hf_usb_hub_zero, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\n} else {\r\n}\r\n}\r\nstatic void\r\ndissect_usb_hub_set_port_feature(packet_info *pinfo, proto_tree *tree, tvbuff_t *tvb, int offset, gboolean is_request, usb_trans_info_t *usb_trans_info, usb_conv_info_t *usb_conv_info _U_)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *subtree = NULL;\r\nconst gchar* feature_name;\r\nfeature_name = val_to_str(usb_trans_info->setup.wValue,\r\nhub_class_feature_selectors_recipient_port_vals,\r\n"UNKNOWN (0x%x)");\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " [Port %u: %s]", usb_trans_info->setup.wIndex,\r\nfeature_name);\r\nif (is_request) {\r\nitem = proto_tree_add_item(tree, hf_usb_hub_value, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wValue);\r\nproto_tree_add_item(subtree, hf_usb_hub_port_feature_selector, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\noffset += 2;\r\nitem = proto_tree_add_item(tree, hf_usb_hub_index, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wValue);\r\nproto_tree_add_item(subtree, hf_usb_hub_port, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(subtree, hf_usb_hub_port_selector, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset++;\r\nitem = proto_tree_add_item(tree, hf_usb_hub_length, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_usb_hub_wLength);\r\nproto_tree_add_item(subtree, hf_usb_hub_zero, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\n} else {\r\n}\r\n}\r\nstatic gint\r\ndissect_usb_hub_control(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data)\r\n{\r\ngboolean is_request;\r\nusb_conv_info_t *usb_conv_info;\r\nusb_trans_info_t *usb_trans_info;\r\nint offset = 0;\r\nusb_setup_dissector dissector;\r\nconst usb_setup_dissector_table_t *tmp;\r\nif (data == NULL || ((usb_conv_info_t *)data)->usb_trans_info == NULL)\r\nreturn 0;\r\nusb_conv_info = (usb_conv_info_t *)data;\r\nusb_trans_info = usb_conv_info->usb_trans_info;\r\nis_request = (pinfo->srcport==NO_ENDPOINT);\r\ndissector = NULL;\r\nfor (tmp = setup_dissectors; tmp->dissector; tmp++) {\r\nif (tmp->request_type == usb_trans_info->setup.requesttype &&\r\ntmp->request == usb_trans_info->setup.request) {\r\ndissector = tmp->dissector;\r\nbreak;\r\n}\r\n}\r\nif (!dissector) {\r\nreturn 0;\r\n}\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "USBHUB");\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "%s %s",\r\nval_to_str(usb_trans_info->setup.request, setup_request_names_vals, "Unknown type %x"),\r\nis_request ? "Request " : "Response");\r\nif (is_request) {\r\nproto_tree_add_item(tree, hf_usb_hub_request, tvb, offset, 1, ENC_LITTLE_ENDIAN);\r\noffset += 1;\r\n}\r\ndissector(pinfo, tree, tvb, offset, is_request, usb_trans_info, usb_conv_info);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_usb_hub(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_usb_hub_request,\r\n{ "bRequest", "usbhub.setup.bRequest", FT_UINT8, BASE_HEX, VALS(setup_request_names_vals), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_value,\r\n{ "wValue", "usbhub.setup.wValue", FT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_index,\r\n{ "wIndex", "usbhub.setup.wIndex", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_length,\r\n{ "wLength", "usbhub.setup.wLength", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_hub_feature_selector,\r\n{ "HubFeatureSelector", "usbhub.setup.HubFeatureSelector", FT_UINT16, BASE_DEC,\r\nVALS(hub_class_feature_selectors_recipient_hub_vals), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_port_feature_selector,\r\n{ "PortFeatureSelector", "usbhub.setup.PortFeatureSelector", FT_UINT16, BASE_DEC,\r\nVALS(hub_class_feature_selectors_recipient_port_vals), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_dev_addr,\r\n{ "Dev_Addr", "usbhub.setup.Dev_Addr", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_ep_num,\r\n{ "EP_Num", "usbhub.setup.EP_Num", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_descriptor_type,\r\n{ "DescriptorType", "usbhub.setup.DescriptorType", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_descriptor_index,\r\n{ "DescriptorIndex", "usbhub.setup.DescriptorIndex", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_descriptor_length,\r\n{ "DescriptorLength", "usbhub.setup.DescriptorLength", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_zero,\r\n{ "(zero)", "usbhub.setup.zero", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_tt_flags,\r\n{ "TT_Flags", "usbhub.setup.TT_Flags", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_tt_port,\r\n{ "TT_Port", "usbhub.setup.TT_Port", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_tt_state_length,\r\n{ "TT State Length", "usbhub.setup.TT_StateLength", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_port_selector,\r\n{ "PortSelector", "usbhub.setup.PortSelector", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_port,\r\n{ "Port", "usbhub.setup.Port", FT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_port_status,\r\n{ "Port Status", "usbhub.status.port", FT_UINT16, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_port_change,\r\n{ "Port Change", "usbhub.change.port", FT_UINT16, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_port_status_connection,\r\n{ "PORT_CONNECTION", "usbhub.status.port.connection", FT_BOOLEAN, 16, NULL, (1<<0),\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_port_status_enable,\r\n{ "PORT_ENABLE", "usbhub.status.port.enable", FT_BOOLEAN, 16, NULL, (1<<1),\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_port_status_suspend,\r\n{ "PORT_SUSPEND", "usbhub.status.port.suspend", FT_BOOLEAN, 16, NULL, (1<<2),\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_port_status_overcurrent,\r\n{ "PORT_OVER_CURRENT", "usbhub.status.port.overcurrent", FT_BOOLEAN, 16, NULL, (1<<3),\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_port_status_reset,\r\n{ "PORT_RESET", "usbhub.status.port.reset", FT_BOOLEAN, 16, NULL, (1<<4),\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_port_status_power,\r\n{ "PORT_POWER", "usbhub.status.port.power", FT_BOOLEAN, 16, NULL, (1<<8),\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_port_status_low_speed,\r\n{ "PORT_LOW_SPEED", "usbhub.status.port.low_speed", FT_BOOLEAN, 16, NULL, (1<<9),\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_port_status_high_speed,\r\n{ "PORT_HIGH_SPEED", "usbhub.status.port.high_speed", FT_BOOLEAN, 16, NULL, (1<<10),\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_port_status_test,\r\n{ "PORT_TEST", "usbhub.status.port.test", FT_BOOLEAN, 16, NULL, (1<<11),\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_port_status_indicator,\r\n{ "PORT_INDICATOR", "usbhub.status.port.indicator", FT_BOOLEAN, 16,\r\nTFS(&hub_port_status_indicator_meaning), (1<<12),\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_port_change_connection,\r\n{ "C_PORT_CONNECTION", "usbhub.change.port.connection", FT_BOOLEAN, 16, NULL, (1<<0),\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_port_change_enable,\r\n{ "C_PORT_ENABLE", "usbhub.change.port.enable", FT_BOOLEAN, 16, NULL, (1<<1),\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_port_change_suspend,\r\n{ "C_PORT_SUSPEND", "usbhub.status.port.suspend", FT_BOOLEAN, 16, NULL, (1<<2),\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_port_change_overcurrent,\r\n{ "C_PORT_OVER_CURRENT", "usbhub.status.port.overcurrent", FT_BOOLEAN, 16, NULL, (1<<3),\r\nNULL, HFILL }},\r\n{ &hf_usb_hub_port_change_reset,\r\n{ "C_PORT_RESET", "usbhub.status.port.reset", FT_BOOLEAN, 16, NULL, (1<<4),\r\nNULL, HFILL }}\r\n};\r\nstatic gint *usb_hub_subtrees[] = {\r\n&ett_usb_hub_wValue,\r\n&ett_usb_hub_wIndex,\r\n&ett_usb_hub_wLength,\r\n&ett_usb_hub_port_status,\r\n&ett_usb_hub_port_change\r\n};\r\nproto_usb_hub = proto_register_protocol("USB HUB", "USBHUB", "usbhub");\r\nproto_register_field_array(proto_usb_hub, hf, array_length(hf));\r\nproto_register_subtree_array(usb_hub_subtrees, array_length(usb_hub_subtrees));\r\n}\r\nvoid\r\nproto_reg_handoff_usb_hub(void)\r\n{\r\ndissector_handle_t usb_hub_control_handle;\r\nusb_hub_control_handle = create_dissector_handle(dissect_usb_hub_control, proto_usb_hub);\r\ndissector_add_uint("usb.control", IF_CLASS_HUB, usb_hub_control_handle);\r\ndissector_add_uint("usb.control", IF_CLASS_UNKNOWN, usb_hub_control_handle);\r\n}
