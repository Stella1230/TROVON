static int\r\ndissect_zbee_zcl_color_control(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data)\r\n{\r\nproto_tree *payload_tree;\r\nzbee_zcl_packet *zcl;\r\nguint offset = 0;\r\nguint8 cmd_id;\r\ngint rem_len;\r\nif (data == NULL)\r\nreturn 0;\r\nzcl = (zbee_zcl_packet *)data;\r\ncmd_id = zcl->cmd_id;\r\nif (zcl->direction == ZBEE_ZCL_FCF_TO_SERVER) {\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s, Seq: %u",\r\nval_to_str_const(cmd_id, zbee_zcl_color_control_srv_rx_cmd_names, "Unknown Command"),\r\nzcl->tran_seqno);\r\nproto_tree_add_item(tree, hf_zbee_zcl_color_control_srv_rx_cmd_id, tvb, offset, 1, cmd_id);\r\nrem_len = tvb_reported_length_remaining(tvb, ++offset);\r\nif (rem_len > 0) {\r\npayload_tree = proto_tree_add_subtree(tree, tvb, offset, rem_len, ett_zbee_zcl_color_control, NULL, "Payload");\r\nswitch (cmd_id) {\r\ncase ZBEE_ZCL_CMD_ID_COLOR_CONTROL_MOVE_TO_HUE:\r\ndissect_zcl_color_control_move_to_hue(tvb, payload_tree, &offset);\r\nbreak;\r\ncase ZBEE_ZCL_CMD_ID_COLOR_CONTROL_MOVE_HUE:\r\ndissect_zcl_color_control_move_hue_saturation(tvb, payload_tree, &offset);\r\nbreak;\r\ncase ZBEE_ZCL_CMD_ID_COLOR_CONTROL_STEP_HUE:\r\ndissect_zcl_color_control_step_hue_saturation(tvb, payload_tree, &offset);\r\nbreak;\r\ncase ZBEE_ZCL_CMD_ID_COLOR_CONTROL_MOVE_TO_SATURATION:\r\ndissect_zcl_color_control_move_to_saturation(tvb, payload_tree, &offset);\r\nbreak;\r\ncase ZBEE_ZCL_CMD_ID_COLOR_CONTROL_MOVE_SATURATION:\r\ndissect_zcl_color_control_move_hue_saturation(tvb, payload_tree, &offset);\r\nbreak;\r\ncase ZBEE_ZCL_CMD_ID_COLOR_CONTROL_STEP_SATURATION:\r\ndissect_zcl_color_control_step_hue_saturation(tvb, payload_tree, &offset);\r\nbreak;\r\ncase ZBEE_ZCL_CMD_ID_COLOR_CONTROL_MOVE_TO_HUE_AND_SATURATION:\r\ndissect_zcl_color_control_move_to_hue_and_saturation(tvb, payload_tree, &offset);\r\nbreak;\r\ncase ZBEE_ZCL_CMD_ID_COLOR_CONTROL_MOVE_TO_COLOR:\r\ndissect_zcl_color_control_move_to_color(tvb, payload_tree, &offset);\r\nbreak;\r\ncase ZBEE_ZCL_CMD_ID_COLOR_CONTROL_MOVE_COLOR:\r\ndissect_zcl_color_control_move_color(tvb, payload_tree, &offset);\r\nbreak;\r\ncase ZBEE_ZCL_CMD_ID_COLOR_CONTROL_STEP_COLOR:\r\ndissect_zcl_color_control_step_color(tvb, payload_tree, &offset);\r\nbreak;\r\ncase ZBEE_ZCL_CMD_ID_COLOR_CONTROL_MOVE_TO_COLOR_TEMP:\r\ndissect_zcl_color_control_move_to_color_temp(tvb, payload_tree, &offset);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic void\r\ndissect_zcl_color_control_move_to_hue(tvbuff_t *tvb, proto_tree *tree, guint *offset)\r\n{\r\nproto_tree_add_item(tree, hf_zbee_zcl_color_control_hue, tvb, *offset, 1, ENC_LITTLE_ENDIAN);\r\n*offset += 1;\r\nproto_tree_add_item(tree, hf_zbee_zcl_color_control_direction, tvb, *offset, 1, ENC_LITTLE_ENDIAN);\r\n*offset += 1;\r\nproto_tree_add_item(tree, hf_zbee_zcl_color_control_transit_time, tvb, *offset, 2, ENC_LITTLE_ENDIAN);\r\n*offset += 2;\r\n}\r\nstatic void\r\ndissect_zcl_color_control_move_hue_saturation(tvbuff_t *tvb, proto_tree *tree, guint *offset)\r\n{\r\nproto_tree_add_item(tree, hf_zbee_zcl_color_control_move_mode, tvb, *offset, 1, ENC_LITTLE_ENDIAN);\r\n*offset += 1;\r\nproto_tree_add_item(tree, hf_zbee_zcl_color_control_rate, tvb, *offset, 1, ENC_LITTLE_ENDIAN);\r\n*offset += 1;\r\n}\r\nstatic void\r\ndissect_zcl_color_control_step_hue_saturation(tvbuff_t *tvb, proto_tree *tree, guint *offset)\r\n{\r\nproto_tree_add_item(tree, hf_zbee_zcl_color_control_step_mode, tvb, *offset, 1, ENC_LITTLE_ENDIAN);\r\n*offset += 1;\r\nproto_tree_add_item(tree, hf_zbee_zcl_color_control_step_size, tvb, *offset, 1, ENC_LITTLE_ENDIAN);\r\n*offset += 1;\r\nproto_tree_add_item(tree, hf_zbee_zcl_color_control_transit_time_8bit, tvb, *offset, 1, ENC_LITTLE_ENDIAN);\r\n*offset += 1;\r\n}\r\nstatic void\r\ndissect_zcl_color_control_move_to_saturation(tvbuff_t *tvb, proto_tree *tree, guint *offset)\r\n{\r\nproto_tree_add_item(tree, hf_zbee_zcl_color_control_saturation, tvb, *offset, 1, ENC_LITTLE_ENDIAN);\r\n*offset += 1;\r\nproto_tree_add_item(tree, hf_zbee_zcl_color_control_transit_time, tvb, *offset, 2, ENC_LITTLE_ENDIAN);\r\n*offset += 2;\r\n}\r\nstatic void\r\ndissect_zcl_color_control_move_to_hue_and_saturation(tvbuff_t *tvb, proto_tree *tree, guint *offset)\r\n{\r\nproto_tree_add_item(tree, hf_zbee_zcl_color_control_hue, tvb, *offset, 1, ENC_LITTLE_ENDIAN);\r\n*offset += 1;\r\nproto_tree_add_item(tree, hf_zbee_zcl_color_control_saturation, tvb, *offset, 1, ENC_LITTLE_ENDIAN);\r\n*offset += 1;\r\nproto_tree_add_item(tree, hf_zbee_zcl_color_control_transit_time, tvb, *offset, 2, ENC_LITTLE_ENDIAN);\r\n*offset += 2;\r\n}\r\nstatic void\r\ndissect_zcl_color_control_move_to_color(tvbuff_t *tvb, proto_tree *tree, guint *offset)\r\n{\r\nproto_tree_add_item(tree, hf_zbee_zcl_color_control_color_X, tvb, *offset, 2, ENC_LITTLE_ENDIAN);\r\n*offset += 2;\r\nproto_tree_add_item(tree, hf_zbee_zcl_color_control_color_Y, tvb, *offset, 2, ENC_LITTLE_ENDIAN);\r\n*offset += 2;\r\nproto_tree_add_item(tree, hf_zbee_zcl_color_control_transit_time, tvb, *offset, 2, ENC_LITTLE_ENDIAN);\r\n*offset += 2;\r\n}\r\nstatic void\r\ndissect_zcl_color_control_move_color(tvbuff_t *tvb, proto_tree *tree, guint *offset)\r\n{\r\nproto_tree_add_item(tree, hf_zbee_zcl_color_control_rate_X, tvb, *offset, 2, ENC_LITTLE_ENDIAN);\r\n*offset += 2;\r\nproto_tree_add_item(tree, hf_zbee_zcl_color_control_rate_Y, tvb, *offset, 2, ENC_LITTLE_ENDIAN);\r\n*offset += 2;\r\n}\r\nstatic void\r\ndissect_zcl_color_control_step_color(tvbuff_t *tvb, proto_tree *tree, guint *offset)\r\n{\r\nproto_tree_add_item(tree, hf_zbee_zcl_color_control_step_X, tvb, *offset, 2, ENC_LITTLE_ENDIAN);\r\n*offset += 2;\r\nproto_tree_add_item(tree, hf_zbee_zcl_color_control_step_Y, tvb, *offset, 2, ENC_LITTLE_ENDIAN);\r\n*offset += 2;\r\nproto_tree_add_item(tree, hf_zbee_zcl_color_control_transit_time, tvb, *offset, 2, ENC_LITTLE_ENDIAN);\r\n*offset += 2;\r\n}\r\nstatic void\r\ndissect_zcl_color_control_move_to_color_temp(tvbuff_t *tvb, proto_tree *tree, guint *offset)\r\n{\r\nproto_tree_add_item(tree, hf_zbee_zcl_color_control_color_temp, tvb, *offset, 2, ENC_LITTLE_ENDIAN);\r\n*offset += 2;\r\nproto_tree_add_item(tree, hf_zbee_zcl_color_control_transit_time, tvb, *offset, 2, ENC_LITTLE_ENDIAN);\r\n*offset += 2;\r\n}\r\nvoid\r\ndissect_zcl_color_control_attr_data(proto_tree *tree, tvbuff_t *tvb, guint *offset, guint16 attr_id, guint data_type)\r\n{\r\nswitch ( attr_id ) {\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_DRIFT_COMPENSATION:\r\nproto_tree_add_item(tree, hf_zbee_zcl_color_control_attr_drift_compensation, tvb, *offset, 1, ENC_LITTLE_ENDIAN);\r\n*offset += 1;\r\nbreak;\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_COLOR_MODE:\r\nproto_tree_add_item(tree, hf_zbee_zcl_color_control_attr_color_mode, tvb, *offset, 1, ENC_LITTLE_ENDIAN);\r\n*offset += 1;\r\nbreak;\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_REMAINING_TIME:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_CURRENT_HUE:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_CURRENT_SATURATION:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_CURRENT_X:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_CURRENT_Y:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_COMPENSATION_TEXT:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_COLOR_TEMP:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_NO_OF_PRIMARIES:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_PRIMARY_1X:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_PRIMARY_1Y:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_PRIMARY_1INTENSITY:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_PRIMARY_2X:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_PRIMARY_2Y:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_PRIMARY_2INTENSITY:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_PRIMARY_3X:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_PRIMARY_3Y:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_PRIMARY_3INTENSITY:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_PRIMARY_4X:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_PRIMARY_4Y:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_PRIMARY_4INTENSITY:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_PRIMARY_5X:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_PRIMARY_5Y:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_PRIMARY_5INTENSITY:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_PRIMARY_6X:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_PRIMARY_6Y:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_PRIMARY_6INTENSITY:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_WHITE_POINT_X:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_WHITE_POINT_Y:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_COLOR_POINT_RX:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_COLOR_POINT_RY:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_COLOR_POINT_R_INTENSITY:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_COLOR_POINT_GX:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_COLOR_POINT_GY:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_COLOR_POINT_G_INTENSITY:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_COLOR_POINT_BX:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_COLOR_POINT_BY:\r\ncase ZBEE_ZCL_ATTR_ID_COLOR_CONTROL_COLOR_POINT_B_INTENSITY:\r\ndefault:\r\ndissect_zcl_attr_data(tvb, tree, offset, data_type);\r\nbreak;\r\n}\r\n}\r\nvoid\r\nproto_register_zbee_zcl_color_control(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_zbee_zcl_color_control_attr_id,\r\n{ "Attribute", "zbee_zcl_lighting.color_control.attr_id", FT_UINT16, BASE_HEX, VALS(zbee_zcl_color_control_attr_names),\r\n0x00, NULL, HFILL } },\r\n{ &hf_zbee_zcl_color_control_attr_drift_compensation,\r\n{ "Drift Compensation", "zbee_zcl_lighting.color_control.attr.drift_compensation", FT_UINT8, BASE_HEX, VALS(zbee_zcl_color_control_drift_compensation_values),\r\n0x00, NULL, HFILL } },\r\n{ &hf_zbee_zcl_color_control_attr_color_mode,\r\n{ "Color Mode", "zbee_zcl_lighting.color_control.color_mode", FT_UINT8, BASE_HEX, VALS(zbee_zcl_color_control_color_mode_values),\r\n0x00, NULL, HFILL } },\r\n{ &hf_zbee_zcl_color_control_hue,\r\n{ "Hue", "zbee_zcl_lighting.color_control.hue", FT_UINT8, BASE_HEX, NULL,\r\n0x00, NULL, HFILL } },\r\n{ &hf_zbee_zcl_color_control_direction,\r\n{ "Direction", "zbee_zcl_lighting.color_control.direction", FT_UINT8, BASE_HEX, VALS(zbee_zcl_color_control_direction_values),\r\n0x00, NULL, HFILL } },\r\n{ &hf_zbee_zcl_color_control_transit_time,\r\n{ "Transition Time", "zbee_zcl_lighting.color_control.transit_time", FT_UINT16, BASE_HEX, NULL,\r\n0x00, NULL, HFILL } },\r\n{ &hf_zbee_zcl_color_control_move_mode,\r\n{ "Move Mode", "zbee_zcl_lighting.color_control.move_mode", FT_UINT8, BASE_HEX, VALS(zbee_zcl_color_control_move_mode),\r\n0x00, NULL, HFILL } },\r\n{ &hf_zbee_zcl_color_control_rate,\r\n{ "Rate", "zbee_zcl_lighting.color_control.rate", FT_UINT8, BASE_DEC, NULL,\r\n0x00, NULL, HFILL }},\r\n{ &hf_zbee_zcl_color_control_step_mode,\r\n{ "Step Mode", "zbee_zcl_lighting.color_control.step_mode", FT_UINT8, BASE_HEX, VALS(zbee_zcl_color_control_step_mode),\r\n0x00, NULL, HFILL }},\r\n{ &hf_zbee_zcl_color_control_step_size,\r\n{ "Step Size", "zbee_zcl_lighting.color_control.step_size", FT_UINT8, BASE_DEC, NULL,\r\n0x00, NULL, HFILL }},\r\n{ &hf_zbee_zcl_color_control_transit_time_8bit,\r\n{ "Transition Time", "zbee_zcl_lighting.color_control.transition_time_8bit", FT_UINT8, BASE_HEX, NULL,\r\n0x00, NULL, HFILL }},\r\n{ &hf_zbee_zcl_color_control_saturation,\r\n{ "Saturation", "zbee_zcl_lighting.color_control.saturation", FT_UINT8, BASE_HEX, NULL,\r\n0x00, NULL, HFILL }},\r\n{ &hf_zbee_zcl_color_control_color_X,\r\n{ "Color X", "zbee_zcl_lighting.color_control.color_x", FT_UINT16, BASE_HEX, NULL,\r\n0x00, NULL, HFILL }},\r\n{ &hf_zbee_zcl_color_control_color_Y,\r\n{ "Color Y", "zbee_zcl_lighting.color_control.color_y", FT_UINT16, BASE_HEX, NULL,\r\n0x00, NULL, HFILL }},\r\n{ &hf_zbee_zcl_color_control_rate_X,\r\n{ "Rate X", "zbee_zcl_lighting.color_control.rate_x", FT_UINT16, BASE_HEX, NULL,\r\n0x00, NULL, HFILL }},\r\n{ &hf_zbee_zcl_color_control_rate_Y,\r\n{ "Rate Y", "zbee_zcl_lighting.color_control.rate_y", FT_UINT16, BASE_HEX, NULL,\r\n0x00, NULL, HFILL }},\r\n{ &hf_zbee_zcl_color_control_step_X,\r\n{ "Step X", "zbee_zcl_lighting.color_control.step_x", FT_UINT16, BASE_HEX, NULL,\r\n0x00, NULL, HFILL }},\r\n{ &hf_zbee_zcl_color_control_step_Y,\r\n{ "Step Y", "zbee_zcl_lighting.color_control.step_y", FT_UINT16, BASE_HEX, NULL,\r\n0x00, NULL, HFILL }},\r\n{ &hf_zbee_zcl_color_control_color_temp,\r\n{ "Color temperature", "zbee_zcl_lighting.color_control.color_temp", FT_UINT16, BASE_HEX, NULL,\r\n0x00, NULL, HFILL }},\r\n{ &hf_zbee_zcl_color_control_srv_rx_cmd_id,\r\n{ "Command", "zbee_zcl_lighting.color_control.cmd.srv_rx.id", FT_UINT8, BASE_HEX, VALS(zbee_zcl_color_control_srv_rx_cmd_names),\r\n0x00, NULL, HFILL } }\r\n};\r\nstatic gint *ett[ZBEE_ZCL_COLOR_CONTROL_NUM_ETT];\r\nett[0] = &ett_zbee_zcl_color_control;\r\nproto_zbee_zcl_color_control = proto_register_protocol("ZigBee ZCL Color Control", "ZCL Color Control", ZBEE_PROTOABBREV_ZCL_COLOR_CONTROL);\r\nproto_register_field_array(proto_zbee_zcl_color_control, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nregister_dissector(ZBEE_PROTOABBREV_ZCL_COLOR_CONTROL, dissect_zbee_zcl_color_control, proto_zbee_zcl_color_control);\r\n}\r\nvoid\r\nproto_reg_handoff_zbee_zcl_color_control(void)\r\n{\r\ndissector_handle_t color_control_handle;\r\ncolor_control_handle = find_dissector(ZBEE_PROTOABBREV_ZCL_COLOR_CONTROL);\r\ndissector_add_uint("zbee.zcl.cluster", ZBEE_ZCL_CID_COLOR_CONTROL, color_control_handle);\r\nzbee_zcl_init_cluster( proto_zbee_zcl_color_control,\r\nett_zbee_zcl_color_control,\r\nZBEE_ZCL_CID_COLOR_CONTROL,\r\nhf_zbee_zcl_color_control_attr_id,\r\nhf_zbee_zcl_color_control_srv_rx_cmd_id,\r\n-1,\r\n(zbee_zcl_fn_attr_data)dissect_zcl_color_control_attr_data\r\n);\r\n}\r\nstatic int\r\ndissect_zbee_zcl_ballast_configuration(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void* data _U_)\r\n{\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\ndissect_zcl_ballast_configuration_attr_data(proto_tree *tree, tvbuff_t *tvb, guint *offset, guint16 attr_id, guint data_type)\r\n{\r\nstatic const int * ballast_status[] = {\r\n&hf_zbee_zcl_ballast_configuration_status_non_operational,\r\n&hf_zbee_zcl_ballast_configuration_status_lamp_not_in_socket,\r\nNULL\r\n};\r\nstatic const int * lamp_alarm_mode[] = {\r\n&hf_zbee_zcl_ballast_configuration_lamp_alarm_mode_lamp_burn_hours,\r\nNULL\r\n};\r\nswitch (attr_id) {\r\ncase ZBEE_ZCL_ATTR_ID_BALLAST_CONFIGURATION_BALLAST_STATUS:\r\nproto_tree_add_bitmask(tree, tvb, *offset, hf_zbee_zcl_ballast_configuration_status, ett_zbee_zcl_ballast_configuration_status, ballast_status, ENC_LITTLE_ENDIAN);\r\n*offset += 1;\r\nbreak;\r\ncase ZBEE_ZCL_ATTR_ID_BALLAST_CONFIGURATION_LAMP_ALARM_MODE:\r\nproto_tree_add_bitmask(tree, tvb, *offset, hf_zbee_zcl_ballast_configuration_lamp_alarm_mode, ett_zbee_zcl_ballast_configuration_lamp_alarm_mode, lamp_alarm_mode, ENC_LITTLE_ENDIAN);\r\n*offset += 1;\r\nbreak;\r\ncase ZBEE_ZCL_ATTR_ID_BALLAST_CONFIGURATION_PHYSICAL_MIN_LEVEL:\r\ncase ZBEE_ZCL_ATTR_ID_BALLAST_CONFIGURATION_PHYSICAL_MAX_LEVEL:\r\ncase ZBEE_ZCL_ATTR_ID_BALLAST_CONFIGURATION_MIN_LEVEL:\r\ncase ZBEE_ZCL_ATTR_ID_BALLAST_CONFIGURATION_MAX_LEVEL:\r\ncase ZBEE_ZCL_ATTR_ID_BALLAST_CONFIGURATION_POWER_ON_LEVEL:\r\ncase ZBEE_ZCL_ATTR_ID_BALLAST_CONFIGURATION_POWER_ON_FADE_TIME:\r\ncase ZBEE_ZCL_ATTR_ID_BALLAST_CONFIGURATION_INTRINSIC_BALLAST_FACTOR:\r\ncase ZBEE_ZCL_ATTR_ID_BALLAST_CONFIGURATION_BALLAST_FACT_ADJ:\r\ncase ZBEE_ZCL_ATTR_ID_BALLAST_CONFIGURATION_LAMP_QUANTITY:\r\ncase ZBEE_ZCL_ATTR_ID_BALLAST_CONFIGURATION_LAMP_TYPE:\r\ncase ZBEE_ZCL_ATTR_ID_BALLAST_CONFIGURATION_LAMP_MANUFACTURER:\r\ncase ZBEE_ZCL_ATTR_ID_BALLAST_CONFIGURATION_LAMP_RATED_HOURS:\r\ncase ZBEE_ZCL_ATTR_ID_BALLAST_CONFIGURATION_LAMP_BURN_HOURS:\r\ncase ZBEE_ZCL_ATTR_ID_BALLAST_CONFIGURATION_LAMP_BURN_HOURS_TRIP_POINT:\r\ndefault:\r\ndissect_zcl_attr_data(tvb, tree, offset, data_type);\r\nbreak;\r\n}\r\n}\r\nvoid\r\nproto_register_zbee_zcl_ballast_configuration(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_zbee_zcl_ballast_configuration_attr_id,\r\n{ "Attribute", "zbee_zcl_lighting.ballast_configuration.attr_id", FT_UINT16, BASE_HEX, VALS(zbee_zcl_ballast_configuration_attr_names),\r\n0x00, NULL, HFILL } },\r\n{ &hf_zbee_zcl_ballast_configuration_status,\r\n{ "Status", "zbee_zcl_lighting.ballast_configuration.attr.status", FT_UINT8, BASE_HEX, NULL,\r\n0x00, NULL, HFILL } },\r\n{ &hf_zbee_zcl_ballast_configuration_status_non_operational,\r\n{ "Non-operational", "zbee_zcl_lighting.ballast_configuration.attr.status.non_operational", FT_UINT8, BASE_HEX, VALS(zbee_zcl_ballast_configuration_status_non_operational_names),\r\nZBEE_ZCL_BALLAST_CONFIGURATION_STATUS_NON_OPERATIONAL, NULL, HFILL } },\r\n{ &hf_zbee_zcl_ballast_configuration_status_lamp_not_in_socket,\r\n{ "Not in Socket", "zbee_zcl_lighting.ballast_configuration.attr.status.not_in_socket", FT_UINT8, BASE_HEX, VALS(zbee_zcl_ballast_configuration_status_lamp_not_in_socket_names),\r\nZBEE_ZCL_BALLAST_CONFIGURATION_STATUS_LAMP_NOT_IN_SOCKET, NULL, HFILL } },\r\n{ &hf_zbee_zcl_ballast_configuration_lamp_alarm_mode,\r\n{ "Lamp Alarm Mode", "zbee_zcl_lighting.ballast_configuration.attr.lamp_alarm_mode", FT_UINT8, BASE_HEX, NULL,\r\n0x00, NULL, HFILL } },\r\n{ &hf_zbee_zcl_ballast_configuration_lamp_alarm_mode_lamp_burn_hours,\r\n{ "Lamp Burn Hours", "zbee_zcl_lighting.ballast_configuration.attr.lamp_alarm_mode.lamp_burn_hours", FT_BOOLEAN, 8, NULL,\r\nZBEE_ZCL_BALLAST_CONFIGURATION_LAMP_ALARM_MODE_LAMP_BURN_HOURS, NULL, HFILL } }\r\n};\r\nstatic gint *ett[ZBEE_ZCL_BALLAST_CONFIGURATION_NUM_ETT];\r\nett[0] = &ett_zbee_zcl_ballast_configuration;\r\nett[1] = &ett_zbee_zcl_ballast_configuration_status;\r\nett[2] = &ett_zbee_zcl_ballast_configuration_lamp_alarm_mode;\r\nproto_zbee_zcl_ballast_configuration = proto_register_protocol("ZigBee ZCL Ballast Configuration", "ZCL Ballast Configuration", ZBEE_PROTOABBREV_ZCL_BALLAST_CONFIG);\r\nproto_register_field_array(proto_zbee_zcl_ballast_configuration, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nregister_dissector(ZBEE_PROTOABBREV_ZCL_BALLAST_CONFIG, dissect_zbee_zcl_ballast_configuration, proto_zbee_zcl_ballast_configuration);\r\n}\r\nvoid\r\nproto_reg_handoff_zbee_zcl_ballast_configuration(void)\r\n{\r\ndissector_handle_t ballast_config_handle;\r\nballast_config_handle = find_dissector(ZBEE_PROTOABBREV_ZCL_BALLAST_CONFIG);\r\ndissector_add_uint("zbee.zcl.cluster", ZBEE_ZCL_CID_BALLAST_CONFIG, ballast_config_handle);\r\nzbee_zcl_init_cluster( proto_zbee_zcl_ballast_configuration,\r\nett_zbee_zcl_ballast_configuration,\r\nZBEE_ZCL_CID_BALLAST_CONFIG,\r\nhf_zbee_zcl_ballast_configuration_attr_id,\r\n-1, -1,\r\n(zbee_zcl_fn_attr_data)dissect_zcl_ballast_configuration_attr_data\r\n);\r\n}
