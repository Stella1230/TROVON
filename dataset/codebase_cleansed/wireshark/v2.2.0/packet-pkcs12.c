static void append_oid(proto_tree *tree, const char *oid)\r\n{\r\nconst char *name = NULL;\r\nname = oid_resolved_from_string(wmem_packet_scope(), oid);\r\nproto_item_append_text(tree, " (%s)", name ? name : oid);\r\n}\r\nstatic int\r\ngenerate_key_or_iv(unsigned int id, tvbuff_t *salt_tvb, unsigned int iter,\r\nconst char *pw, unsigned int req_keylen, char * keybuf)\r\n{\r\nint rc;\r\nunsigned int i, j;\r\ngcry_md_hd_t md;\r\ngcry_mpi_t num_b1 = NULL;\r\nsize_t pwlen;\r\nchar hash[20], buf_b[64], buf_i[128], *p;\r\nchar *salt_p;\r\nint salt_size;\r\nsize_t cur_keylen;\r\nsize_t n;\r\ngcry_error_t err;\r\ncur_keylen = 0;\r\nsalt_size = tvb_captured_length(salt_tvb);\r\nsalt_p = (char *)tvb_memdup(wmem_packet_scope(), salt_tvb, 0, salt_size);\r\nif (pw == NULL)\r\npwlen = 0;\r\nelse\r\npwlen = strlen(pw);\r\nif (pwlen > 63 / 2)\r\n{\r\nreturn FALSE;\r\n}\r\np = buf_i;\r\nfor (i = 0; i < 64; i++)\r\n*p++ = salt_p[i % salt_size];\r\nif (pw)\r\n{\r\nfor (i = j = 0; i < 64; i += 2)\r\n{\r\n*p++ = 0;\r\n*p++ = pw[j];\r\nif (++j > pwlen)\r\nj = 0;\r\n}\r\n}\r\nelse\r\nmemset (p, 0, 64);\r\nfor (;;) {\r\nerr = gcry_md_open(&md, GCRY_MD_SHA1, 0);\r\nif (gcry_err_code(err))\r\n{\r\nreturn FALSE;\r\n}\r\nfor (i = 0; i < 64; i++)\r\n{\r\nunsigned char lid = id & 0xFF;\r\ngcry_md_write (md, &lid, 1);\r\n}\r\ngcry_md_write(md, buf_i, pw ? 128 : 64);\r\ngcry_md_final (md);\r\nmemcpy (hash, gcry_md_read (md, 0), 20);\r\ngcry_md_close (md);\r\nfor (i = 1; i < iter; i++)\r\ngcry_md_hash_buffer (GCRY_MD_SHA1, hash, hash, 20);\r\nfor (i = 0; i < 20 && cur_keylen < req_keylen; i++)\r\nkeybuf[cur_keylen++] = hash[i];\r\nif (cur_keylen == req_keylen)\r\n{\r\ngcry_mpi_release (num_b1);\r\nreturn TRUE;\r\n}\r\nfor (i = 0; i < 64; i++)\r\nbuf_b[i] = hash[i % 20];\r\nn = 64;\r\nrc = gcry_mpi_scan (&num_b1, GCRYMPI_FMT_USG, buf_b, n, &n);\r\nif (rc != 0)\r\n{\r\nreturn FALSE;\r\n}\r\ngcry_mpi_add_ui (num_b1, num_b1, 1);\r\nfor (i = 0; i < 128; i += 64)\r\n{\r\ngcry_mpi_t num_ij;\r\nn = 64;\r\nrc = gcry_mpi_scan (&num_ij, GCRYMPI_FMT_USG, buf_i + i, n, &n);\r\nif (rc != 0)\r\n{\r\nreturn FALSE;\r\n}\r\ngcry_mpi_add (num_ij, num_ij, num_b1);\r\ngcry_mpi_clear_highbit (num_ij, 64 * 8);\r\nn = 64;\r\nrc = gcry_mpi_print (GCRYMPI_FMT_USG, buf_i + i, n, &n, num_ij);\r\nif (rc != 0)\r\n{\r\nreturn FALSE;\r\n}\r\ngcry_mpi_release (num_ij);\r\n}\r\n}\r\n}\r\nvoid PBE_reset_parameters(void)\r\n{\r\niteration_count = 0;\r\nsalt = NULL;\r\n}\r\nint PBE_decrypt_data(const char *object_identifier_id_param _U_, tvbuff_t *encrypted_tvb _U_, asn1_ctx_t *actx _U_, proto_item *item _U_)\r\n{\r\n#ifdef HAVE_LIBGCRYPT\r\nconst char *encryption_algorithm;\r\ngcry_cipher_hd_t cipher;\r\ngcry_error_t err;\r\nint algo;\r\nint mode;\r\nint ivlen = 0;\r\nint keylen = 0;\r\nint datalen = 0;\r\nchar *key = NULL;\r\nchar *iv = NULL;\r\nchar *clear_data = NULL;\r\ntvbuff_t *clear_tvb = NULL;\r\nconst gchar *oidname;\r\nGString *name;\r\nproto_tree *tree;\r\nchar byte;\r\ngboolean decrypt_ok = TRUE;\r\nif(((password == NULL) || (*password == '\0')) && (try_null_password == FALSE)) {\r\nreturn FALSE;\r\n}\r\nencryption_algorithm = x509af_get_last_algorithm_id();\r\nif(!strcmp(encryption_algorithm, PKCS12_PBE_3DES_SHA1_OID)) {\r\nivlen = 8;\r\nkeylen = 24;\r\nalgo = GCRY_CIPHER_3DES;\r\nmode = GCRY_CIPHER_MODE_CBC;\r\n} else if(!strcmp(encryption_algorithm, PKCS12_PBE_ARCFOUR_SHA1_OID)) {\r\nivlen = 0;\r\nkeylen = 16;\r\nalgo = GCRY_CIPHER_ARCFOUR;\r\nmode = GCRY_CIPHER_MODE_NONE;\r\n} else if(!strcmp(encryption_algorithm, PKCS12_PBE_RC2_40_SHA1_OID)) {\r\nivlen = 8;\r\nkeylen = 5;\r\nalgo = GCRY_CIPHER_RFC2268_40;\r\nmode = GCRY_CIPHER_MODE_CBC;\r\n} else {\r\nproto_item_append_text(item, " [Unsupported encryption algorithm]");\r\nreturn FALSE;\r\n}\r\nif((iteration_count == 0) || (salt == NULL)) {\r\nproto_item_append_text(item, " [Insufficient parameters]");\r\nreturn FALSE;\r\n}\r\nkey = (char *)wmem_alloc(wmem_packet_scope(), keylen);\r\nif(!generate_key_or_iv(1 , salt, iteration_count, password, keylen, key))\r\nreturn FALSE;\r\nif(ivlen) {\r\niv = (char *)wmem_alloc(wmem_packet_scope(), ivlen);\r\nif(!generate_key_or_iv(2 , salt, iteration_count, password, ivlen, iv))\r\nreturn FALSE;\r\n}\r\nerr = gcry_cipher_open(&cipher, algo, mode, 0);\r\nif (gcry_err_code (err))\r\nreturn FALSE;\r\nerr = gcry_cipher_setkey (cipher, key, keylen);\r\nif (gcry_err_code (err)) {\r\ngcry_cipher_close (cipher);\r\nreturn FALSE;\r\n}\r\nif(ivlen) {\r\nerr = gcry_cipher_setiv (cipher, iv, ivlen);\r\nif (gcry_err_code (err)) {\r\ngcry_cipher_close (cipher);\r\nreturn FALSE;\r\n}\r\n}\r\ndatalen = tvb_captured_length(encrypted_tvb);\r\nclear_data = (char *)g_malloc(datalen);\r\nerr = gcry_cipher_decrypt (cipher, clear_data, datalen, (char *)tvb_memdup(wmem_packet_scope(), encrypted_tvb, 0, datalen), datalen);\r\nif (gcry_err_code (err)) {\r\nproto_item_append_text(item, " [Failed to decrypt with password preference]");\r\ngcry_cipher_close (cipher);\r\ng_free(clear_data);\r\nreturn FALSE;\r\n}\r\ngcry_cipher_close (cipher);\r\nbyte = clear_data[datalen-1];\r\nif(byte <= 0x08) {\r\nint i;\r\nfor(i = (int)byte; i > 0 ; i--) {\r\nif(clear_data[datalen - i] != byte) {\r\ndecrypt_ok = FALSE;\r\nbreak;\r\n}\r\n}\r\n} else {\r\n}\r\nbyte = clear_data[0];\r\nif((byte != 0x30) && (byte != 0x31)) {\r\ndecrypt_ok = FALSE;\r\n}\r\nif(!decrypt_ok) {\r\ng_free(clear_data);\r\nproto_item_append_text(item, " [Failed to decrypt with supplied password]");\r\nreturn FALSE;\r\n}\r\nproto_item_append_text(item, " [Decrypted successfully]");\r\ntree = proto_item_add_subtree(item, ett_decrypted_pbe);\r\nclear_tvb = tvb_new_child_real_data(encrypted_tvb,(const guint8 *)clear_data, datalen, datalen);\r\ntvb_set_free_cb(clear_tvb, g_free);\r\nname = g_string_new("");\r\noidname = oid_resolved_from_string(wmem_packet_scope(), object_identifier_id_param);\r\ng_string_printf(name, "Decrypted %s", oidname ? oidname : object_identifier_id_param);\r\nadd_new_data_source(actx->pinfo, clear_tvb, name->str);\r\ng_string_free(name, TRUE);\r\ncall_ber_oid_callback(object_identifier_id_param, clear_tvb, 0, actx->pinfo, tree, NULL);\r\nreturn TRUE;\r\n#else\r\nreturn FALSE;\r\n#endif\r\n}\r\nstatic int\r\ndissect_pkcs12_T_version(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_DigestInfo(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nDigestInfo_sequence, hf_index, ett_pkcs12_DigestInfo);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_OCTET_STRING(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_octet_string(implicit_tag, actx, tree, tvb, offset, hf_index,\r\n(hf_index == hf_pkcs12_salt ? &salt : NULL));\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_INTEGER(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,\r\n(hf_index == hf_pkcs12_iterationCount ? &iteration_count : NULL));\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_MacData(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nMacData_sequence, hf_index, ett_pkcs12_MacData);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_PFX(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 58 "./asn1/pkcs12/pkcs12.cnf"\r\ndissector_handle_t dissector_handle;\r\ndissector_handle=create_dissector_handle(dissect_AuthenticatedSafe_OCTETSTRING_PDU, proto_pkcs12);\r\ndissector_change_string("ber.oid", "1.2.840.113549.1.7.1", dissector_handle);\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nPFX_sequence, hf_index, ett_pkcs12_PFX);\r\ndissector_reset_string("ber.oid", "1.2.840.113549.1.7.1");\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_AuthenticatedSafe(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 71 "./asn1/pkcs12/pkcs12.cnf"\r\ndissector_handle_t dissector_handle;\r\ndissector_handle=create_dissector_handle(dissect_SafeContents_OCTETSTRING_PDU, proto_pkcs12);\r\ndissector_change_string("ber.oid", "1.2.840.113549.1.7.1", dissector_handle);\r\noffset = dissect_ber_sequence_of(implicit_tag, actx, tree, tvb, offset,\r\nAuthenticatedSafe_sequence_of, hf_index, ett_pkcs12_AuthenticatedSafe);\r\ndissector_reset_string("ber.oid", "1.2.840.113549.1.7.1");\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_T_bagId(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_object_identifier_str(implicit_tag, actx, tree, tvb, offset, hf_index, &object_identifier_id);\r\n#line 84 "./asn1/pkcs12/pkcs12.cnf"\r\nappend_oid(tree, object_identifier_id);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_T_bagValue(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 108 "./asn1/pkcs12/pkcs12.cnf"\r\nif(object_identifier_id)\r\noffset = call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_T_attrId(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_object_identifier_str(implicit_tag, actx, tree, tvb, offset, hf_index, &object_identifier_id);\r\n#line 104 "./asn1/pkcs12/pkcs12.cnf"\r\nappend_oid(tree, object_identifier_id);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_T_attrValues_item(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 112 "./asn1/pkcs12/pkcs12.cnf"\r\nif(object_identifier_id)\r\noffset = call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_T_attrValues(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_set_of(implicit_tag, actx, tree, tvb, offset,\r\nT_attrValues_set_of, hf_index, ett_pkcs12_T_attrValues);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_PKCS12Attribute(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nPKCS12Attribute_sequence, hf_index, ett_pkcs12_PKCS12Attribute);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_SET_OF_PKCS12Attribute(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_set_of(implicit_tag, actx, tree, tvb, offset,\r\nSET_OF_PKCS12Attribute_set_of, hf_index, ett_pkcs12_SET_OF_PKCS12Attribute);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_SafeBag(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nSafeBag_sequence, hf_index, ett_pkcs12_SafeBag);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_SafeContents(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence_of(implicit_tag, actx, tree, tvb, offset,\r\nSafeContents_sequence_of, hf_index, ett_pkcs12_SafeContents);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_Version(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_PrivateKey(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_octet_string(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_Attributes(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_set_of(implicit_tag, actx, tree, tvb, offset,\r\nAttributes_set_of, hf_index, ett_pkcs12_Attributes);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_PrivateKeyInfo(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nPrivateKeyInfo_sequence, hf_index, ett_pkcs12_PrivateKeyInfo);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_KeyBag(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_pkcs12_PrivateKeyInfo(implicit_tag, tvb, offset, actx, tree, hf_index);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_EncryptedData(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 139 "./asn1/pkcs12/pkcs12.cnf"\r\ntvbuff_t *encrypted_tvb;\r\ndissector_handle_t dissector_handle;\r\noffset = dissect_ber_octet_string(implicit_tag, actx, tree, tvb, offset, hf_index,\r\n&encrypted_tvb);\r\n#line 145 "./asn1/pkcs12/pkcs12.cnf"\r\ndissector_handle=create_dissector_handle(dissect_PrivateKeyInfo_PDU, proto_pkcs12);\r\ndissector_change_string("ber.oid", object_identifier_id, dissector_handle);\r\nPBE_decrypt_data(object_identifier_id, encrypted_tvb, actx, actx->created_item);\r\ndissector_reset_string("ber.oid", object_identifier_id);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_EncryptedPrivateKeyInfo(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nEncryptedPrivateKeyInfo_sequence, hf_index, ett_pkcs12_EncryptedPrivateKeyInfo);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_PKCS8ShroudedKeyBag(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_pkcs12_EncryptedPrivateKeyInfo(implicit_tag, tvb, offset, actx, tree, hf_index);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_T_certId(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_object_identifier_str(implicit_tag, actx, tree, tvb, offset, hf_index, &object_identifier_id);\r\n#line 89 "./asn1/pkcs12/pkcs12.cnf"\r\nappend_oid(tree, object_identifier_id);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_T_certValue(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 116 "./asn1/pkcs12/pkcs12.cnf"\r\nif(object_identifier_id)\r\noffset = call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_CertBag(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nCertBag_sequence, hf_index, ett_pkcs12_CertBag);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_T_crlId(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_object_identifier_str(implicit_tag, actx, tree, tvb, offset, hf_index, &object_identifier_id);\r\n#line 94 "./asn1/pkcs12/pkcs12.cnf"\r\nappend_oid(tree, object_identifier_id);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_T_crlValue(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 120 "./asn1/pkcs12/pkcs12.cnf"\r\nif(object_identifier_id)\r\noffset = call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_CRLBag(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nCRLBag_sequence, hf_index, ett_pkcs12_CRLBag);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_T_secretTypeId(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_object_identifier_str(implicit_tag, actx, tree, tvb, offset, hf_index, &object_identifier_id);\r\n#line 99 "./asn1/pkcs12/pkcs12.cnf"\r\nappend_oid(tree, object_identifier_id);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_T_secretValue(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 124 "./asn1/pkcs12/pkcs12.cnf"\r\nif(object_identifier_id)\r\noffset = call_ber_oid_callback(object_identifier_id, tvb, offset, actx->pinfo, tree, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_SecretBag(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nSecretBag_sequence, hf_index, ett_pkcs12_SecretBag);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_PBEParameter(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 128 "./asn1/pkcs12/pkcs12.cnf"\r\nPBE_reset_parameters();\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nPBEParameter_sequence, hf_index, ett_pkcs12_PBEParameter);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_T_saltChoice(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_choice(actx, tree, tvb, offset,\r\nT_saltChoice_choice, hf_index, ett_pkcs12_T_saltChoice,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_INTEGER_1_MAX(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_PBKDF2Params(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nPBKDF2Params_sequence, hf_index, ett_pkcs12_PBKDF2Params);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_PBES2Params(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nPBES2Params_sequence, hf_index, ett_pkcs12_PBES2Params);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkcs12_PBMAC1Params(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nPBMAC1Params_sequence, hf_index, ett_pkcs12_PBMAC1Params);\r\nreturn offset;\r\n}\r\nstatic int dissect_PFX_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_pkcs12_PFX(FALSE, tvb, offset, &asn1_ctx, tree, hf_pkcs12_PFX_PDU);\r\nreturn offset;\r\n}\r\nstatic int dissect_SafeContents_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_pkcs12_SafeContents(FALSE, tvb, offset, &asn1_ctx, tree, hf_pkcs12_SafeContents_PDU);\r\nreturn offset;\r\n}\r\nstatic int dissect_KeyBag_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_pkcs12_KeyBag(FALSE, tvb, offset, &asn1_ctx, tree, hf_pkcs12_KeyBag_PDU);\r\nreturn offset;\r\n}\r\nstatic int dissect_PKCS8ShroudedKeyBag_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_pkcs12_PKCS8ShroudedKeyBag(FALSE, tvb, offset, &asn1_ctx, tree, hf_pkcs12_PKCS8ShroudedKeyBag_PDU);\r\nreturn offset;\r\n}\r\nstatic int dissect_CertBag_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_pkcs12_CertBag(FALSE, tvb, offset, &asn1_ctx, tree, hf_pkcs12_CertBag_PDU);\r\nreturn offset;\r\n}\r\nstatic int dissect_CRLBag_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_pkcs12_CRLBag(FALSE, tvb, offset, &asn1_ctx, tree, hf_pkcs12_CRLBag_PDU);\r\nreturn offset;\r\n}\r\nstatic int dissect_SecretBag_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_pkcs12_SecretBag(FALSE, tvb, offset, &asn1_ctx, tree, hf_pkcs12_SecretBag_PDU);\r\nreturn offset;\r\n}\r\nstatic int dissect_PrivateKeyInfo_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_pkcs12_PrivateKeyInfo(FALSE, tvb, offset, &asn1_ctx, tree, hf_pkcs12_PrivateKeyInfo_PDU);\r\nreturn offset;\r\n}\r\nstatic int dissect_EncryptedPrivateKeyInfo_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_pkcs12_EncryptedPrivateKeyInfo(FALSE, tvb, offset, &asn1_ctx, tree, hf_pkcs12_EncryptedPrivateKeyInfo_PDU);\r\nreturn offset;\r\n}\r\nstatic int dissect_PBEParameter_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_pkcs12_PBEParameter(FALSE, tvb, offset, &asn1_ctx, tree, hf_pkcs12_PBEParameter_PDU);\r\nreturn offset;\r\n}\r\nstatic int dissect_PBKDF2Params_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_pkcs12_PBKDF2Params(FALSE, tvb, offset, &asn1_ctx, tree, hf_pkcs12_PBKDF2Params_PDU);\r\nreturn offset;\r\n}\r\nstatic int dissect_PBES2Params_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_pkcs12_PBES2Params(FALSE, tvb, offset, &asn1_ctx, tree, hf_pkcs12_PBES2Params_PDU);\r\nreturn offset;\r\n}\r\nstatic int dissect_PBMAC1Params_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_pkcs12_PBMAC1Params(FALSE, tvb, offset, &asn1_ctx, tree, hf_pkcs12_PBMAC1Params_PDU);\r\nreturn offset;\r\n}\r\nstatic int strip_octet_string(tvbuff_t *tvb)\r\n{\r\ngint8 ber_class;\r\ngboolean pc, ind;\r\ngint32 tag;\r\nguint32 len;\r\nint offset = 0;\r\noffset = get_ber_identifier(tvb, 0, &ber_class, &pc, &tag);\r\noffset = get_ber_length(tvb, offset, &len, &ind);\r\nif((ber_class == BER_CLASS_UNI) && (tag == BER_UNI_TAG_OCTETSTRING))\r\nreturn offset;\r\nreturn 0;\r\n}\r\nstatic int dissect_AuthenticatedSafe_OCTETSTRING_PDU(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\nif((offset = strip_octet_string(tvb)) > 0)\r\ndissect_pkcs12_AuthenticatedSafe(FALSE, tvb, offset, &asn1_ctx, tree, hf_pkcs12_AuthenticatedSafe_PDU);\r\nelse\r\nproto_tree_add_expert(tree, pinfo, &ei_pkcs12_octet_string_expected, tvb, 0, 1);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic int dissect_SafeContents_OCTETSTRING_PDU(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = strip_octet_string(tvb);\r\ndissect_pkcs12_SafeContents(FALSE, tvb, offset, &asn1_ctx, tree, hf_pkcs12_SafeContents_PDU);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic int dissect_X509Certificate_OCTETSTRING_PDU(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\nif((offset = strip_octet_string(tvb)) > 0)\r\ndissect_x509af_Certificate(FALSE, tvb, offset, &asn1_ctx, tree, hf_pkcs12_X509Certificate_PDU);\r\nelse\r\nproto_tree_add_expert(tree, pinfo, &ei_pkcs12_octet_string_expected, tvb, 0, 1);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid proto_register_pkcs12(void) {\r\nstatic hf_register_info hf[] = {\r\n{ &hf_pkcs12_X509Certificate_PDU,\r\n{ "X509Certificate", "pkcs12.X509Certificate",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"pkcs12.X509Certificate", HFILL }},\r\n{ &hf_pkcs12_AuthenticatedSafe_PDU,\r\n{ "AuthenticatedSafe", "pkcs12.AuthenticatedSafe",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n#line 1 "./asn1/pkcs12/packet-pkcs12-hfarr.c"\r\n{ &hf_pkcs12_PFX_PDU,\r\n{ "PFX", "pkcs12.PFX_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_SafeContents_PDU,\r\n{ "SafeContents", "pkcs12.SafeContents",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_KeyBag_PDU,\r\n{ "KeyBag", "pkcs12.KeyBag_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_PKCS8ShroudedKeyBag_PDU,\r\n{ "PKCS8ShroudedKeyBag", "pkcs12.PKCS8ShroudedKeyBag_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_CertBag_PDU,\r\n{ "CertBag", "pkcs12.CertBag_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_CRLBag_PDU,\r\n{ "CRLBag", "pkcs12.CRLBag_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_SecretBag_PDU,\r\n{ "SecretBag", "pkcs12.SecretBag_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_PrivateKeyInfo_PDU,\r\n{ "PrivateKeyInfo", "pkcs12.PrivateKeyInfo_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_EncryptedPrivateKeyInfo_PDU,\r\n{ "EncryptedPrivateKeyInfo", "pkcs12.EncryptedPrivateKeyInfo_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_PBEParameter_PDU,\r\n{ "PBEParameter", "pkcs12.PBEParameter_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_PBKDF2Params_PDU,\r\n{ "PBKDF2Params", "pkcs12.PBKDF2Params_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_PBES2Params_PDU,\r\n{ "PBES2Params", "pkcs12.PBES2Params_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_PBMAC1Params_PDU,\r\n{ "PBMAC1Params", "pkcs12.PBMAC1Params_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_version,\r\n{ "version", "pkcs12.version",\r\nFT_UINT32, BASE_DEC, VALS(pkcs12_T_version_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_authSafe,\r\n{ "authSafe", "pkcs12.authSafe_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"ContentInfo", HFILL }},\r\n{ &hf_pkcs12_macData,\r\n{ "macData", "pkcs12.macData_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_mac,\r\n{ "mac", "pkcs12.mac_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"DigestInfo", HFILL }},\r\n{ &hf_pkcs12_macSalt,\r\n{ "macSalt", "pkcs12.macSalt",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"OCTET_STRING", HFILL }},\r\n{ &hf_pkcs12_iterations,\r\n{ "iterations", "pkcs12.iterations",\r\nFT_INT32, BASE_DEC, NULL, 0,\r\n"INTEGER", HFILL }},\r\n{ &hf_pkcs12_digestAlgorithm,\r\n{ "digestAlgorithm", "pkcs12.digestAlgorithm_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"DigestAlgorithmIdentifier", HFILL }},\r\n{ &hf_pkcs12_digest,\r\n{ "digest", "pkcs12.digest",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_AuthenticatedSafe_item,\r\n{ "ContentInfo", "pkcs12.ContentInfo_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_SafeContents_item,\r\n{ "SafeBag", "pkcs12.SafeBag_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_bagId,\r\n{ "bagId", "pkcs12.bagId",\r\nFT_OID, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_bagValue,\r\n{ "bagValue", "pkcs12.bagValue_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_bagAttributes,\r\n{ "bagAttributes", "pkcs12.bagAttributes",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"SET_OF_PKCS12Attribute", HFILL }},\r\n{ &hf_pkcs12_bagAttributes_item,\r\n{ "PKCS12Attribute", "pkcs12.PKCS12Attribute_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_certId,\r\n{ "certId", "pkcs12.certId",\r\nFT_OID, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_certValue,\r\n{ "certValue", "pkcs12.certValue_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_crlId,\r\n{ "crlId", "pkcs12.crlId",\r\nFT_OID, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_crlValue,\r\n{ "crlValue", "pkcs12.crlValue_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_secretTypeId,\r\n{ "secretTypeId", "pkcs12.secretTypeId",\r\nFT_OID, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_secretValue,\r\n{ "secretValue", "pkcs12.secretValue_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_attrId,\r\n{ "attrId", "pkcs12.attrId",\r\nFT_OID, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_attrValues,\r\n{ "attrValues", "pkcs12.attrValues",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_attrValues_item,\r\n{ "attrValues item", "pkcs12.attrValues_item_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_privateKeyVersion,\r\n{ "version", "pkcs12.version",\r\nFT_UINT32, BASE_DEC, VALS(pkcs12_Version_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_privateKeyAlgorithm,\r\n{ "privateKeyAlgorithm", "pkcs12.privateKeyAlgorithm_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"AlgorithmIdentifier", HFILL }},\r\n{ &hf_pkcs12_privateKey,\r\n{ "privateKey", "pkcs12.privateKey",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_attributes,\r\n{ "attributes", "pkcs12.attributes",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_Attributes_item,\r\n{ "Attribute", "pkcs12.Attribute_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_encryptionAlgorithm,\r\n{ "encryptionAlgorithm", "pkcs12.encryptionAlgorithm_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"AlgorithmIdentifier", HFILL }},\r\n{ &hf_pkcs12_encryptedData,\r\n{ "encryptedData", "pkcs12.encryptedData",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkcs12_salt,\r\n{ "salt", "pkcs12.salt",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"OCTET_STRING", HFILL }},\r\n{ &hf_pkcs12_iterationCount,\r\n{ "iterationCount", "pkcs12.iterationCount",\r\nFT_INT32, BASE_DEC, NULL, 0,\r\n"INTEGER", HFILL }},\r\n{ &hf_pkcs12_saltChoice,\r\n{ "salt", "pkcs12.salt",\r\nFT_UINT32, BASE_DEC, VALS(pkcs12_T_saltChoice_vals), 0,\r\n"T_saltChoice", HFILL }},\r\n{ &hf_pkcs12_specified,\r\n{ "specified", "pkcs12.specified",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"OCTET_STRING", HFILL }},\r\n{ &hf_pkcs12_otherSource,\r\n{ "otherSource", "pkcs12.otherSource_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"AlgorithmIdentifier", HFILL }},\r\n{ &hf_pkcs12_keyLength,\r\n{ "keyLength", "pkcs12.keyLength",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"INTEGER_1_MAX", HFILL }},\r\n{ &hf_pkcs12_prf,\r\n{ "prf", "pkcs12.prf_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"AlgorithmIdentifier", HFILL }},\r\n{ &hf_pkcs12_keyDerivationFunc,\r\n{ "keyDerivationFunc", "pkcs12.keyDerivationFunc_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"AlgorithmIdentifier", HFILL }},\r\n{ &hf_pkcs12_encryptionScheme,\r\n{ "encryptionScheme", "pkcs12.encryptionScheme_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"AlgorithmIdentifier", HFILL }},\r\n{ &hf_pkcs12_messageAuthScheme,\r\n{ "messageAuthScheme", "pkcs12.messageAuthScheme_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"AlgorithmIdentifier", HFILL }},\r\n#line 463 "./asn1/pkcs12/packet-pkcs12-template.c"\r\n};\r\nstatic gint *ett[] = {\r\n&ett_decrypted_pbe,\r\n#line 1 "./asn1/pkcs12/packet-pkcs12-ettarr.c"\r\n&ett_pkcs12_PFX,\r\n&ett_pkcs12_MacData,\r\n&ett_pkcs12_DigestInfo,\r\n&ett_pkcs12_AuthenticatedSafe,\r\n&ett_pkcs12_SafeContents,\r\n&ett_pkcs12_SafeBag,\r\n&ett_pkcs12_SET_OF_PKCS12Attribute,\r\n&ett_pkcs12_CertBag,\r\n&ett_pkcs12_CRLBag,\r\n&ett_pkcs12_SecretBag,\r\n&ett_pkcs12_PKCS12Attribute,\r\n&ett_pkcs12_T_attrValues,\r\n&ett_pkcs12_PrivateKeyInfo,\r\n&ett_pkcs12_Attributes,\r\n&ett_pkcs12_EncryptedPrivateKeyInfo,\r\n&ett_pkcs12_PBEParameter,\r\n&ett_pkcs12_PBKDF2Params,\r\n&ett_pkcs12_T_saltChoice,\r\n&ett_pkcs12_PBES2Params,\r\n&ett_pkcs12_PBMAC1Params,\r\n#line 469 "./asn1/pkcs12/packet-pkcs12-template.c"\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_pkcs12_octet_string_expected, { "pkcs12.octet_string_expected", PI_PROTOCOL, PI_WARN, "BER Error: OCTET STRING expected", EXPFILL }},\r\n};\r\nmodule_t *pkcs12_module;\r\nexpert_module_t* expert_pkcs12;\r\nproto_pkcs12 = proto_register_protocol(PNAME, PSNAME, PFNAME);\r\nproto_register_field_array(proto_pkcs12, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_pkcs12 = expert_register_protocol(proto_pkcs12);\r\nexpert_register_field_array(expert_pkcs12, ei, array_length(ei));\r\npkcs12_module = prefs_register_protocol(proto_pkcs12, NULL);\r\nprefs_register_string_preference(pkcs12_module, "password",\r\n"Password to decrypt the file with",\r\n"The password to used to decrypt the encrypted elements within"\r\n" the PKCS#12 file", &password);\r\nprefs_register_bool_preference(pkcs12_module, "try_null_password",\r\n"Try to decrypt with a empty password",\r\n"Whether to try and decrypt the encrypted data within the"\r\n" PKCS#12 with a NULL password", &try_null_password);\r\nregister_ber_syntax_dissector("PKCS#12", proto_pkcs12, dissect_PFX_PDU);\r\nregister_ber_oid_syntax(".p12", NULL, "PKCS#12");\r\nregister_ber_oid_syntax(".pfx", NULL, "PKCS#12");\r\n}\r\nvoid proto_reg_handoff_pkcs12(void) {\r\n#line 1 "./asn1/pkcs12/packet-pkcs12-dis-tab.c"\r\nregister_ber_oid_dissector("1.2.840.113549.1.12.10.1.1", dissect_KeyBag_PDU, proto_pkcs12, "keyBag");\r\nregister_ber_oid_dissector("1.2.840.113549.1.12.10.1.2", dissect_PKCS8ShroudedKeyBag_PDU, proto_pkcs12, "pkcs8ShroudedKeyBag");\r\nregister_ber_oid_dissector("1.2.840.113549.1.12.10.1.3", dissect_CertBag_PDU, proto_pkcs12, "certBag");\r\nregister_ber_oid_dissector("1.2.840.113549.1.12.10.1.4", dissect_SecretBag_PDU, proto_pkcs12, "secretBag");\r\nregister_ber_oid_dissector("1.2.840.113549.1.12.10.1.5", dissect_CRLBag_PDU, proto_pkcs12, "crlBag");\r\nregister_ber_oid_dissector("1.2.840.113549.1.12.10.1.6", dissect_SafeContents_PDU, proto_pkcs12, "safeContentsBag");\r\nregister_ber_oid_dissector("2.16.840.1.113730.3.1.216", dissect_PFX_PDU, proto_pkcs12, "pkcs-9-at-PKCS12");\r\nregister_ber_oid_dissector("1.2.840.113549.1.9.25.2", dissect_EncryptedPrivateKeyInfo_PDU, proto_pkcs12, "pkcs-9-at-encryptedPrivateKeyInfo");\r\nregister_ber_oid_dissector("1.2.840.113549.1.12.1.1", dissect_PBEParameter_PDU, proto_pkcs12, "pbeWithSHAAnd128BitRC4");\r\nregister_ber_oid_dissector("1.2.840.113549.1.12.1.2", dissect_PBEParameter_PDU, proto_pkcs12, "pbeWithSHAAnd40BitRC4");\r\nregister_ber_oid_dissector("1.2.840.113549.1.12.1.3", dissect_PBEParameter_PDU, proto_pkcs12, "pbeWithSHAAnd3-KeyTripleDES-CBC");\r\nregister_ber_oid_dissector("1.2.840.113549.1.12.1.4", dissect_PBEParameter_PDU, proto_pkcs12, "pbeWithSHAAnd2-KeyTripleDES-CBC");\r\nregister_ber_oid_dissector("1.2.840.113549.1.12.1.5", dissect_PBEParameter_PDU, proto_pkcs12, "pbeWithSHAAnd128BitRC2-CBC");\r\nregister_ber_oid_dissector("1.2.840.113549.1.12.1.6", dissect_PBEParameter_PDU, proto_pkcs12, "pbeWithSHAAnd40BitRC2-CBC");\r\nregister_ber_oid_dissector("1.2.840.113549.1.5.1", dissect_PBEParameter_PDU, proto_pkcs12, "pbeWithMD2AndDES-CBC");\r\nregister_ber_oid_dissector("1.2.840.113549.1.5.3", dissect_PBEParameter_PDU, proto_pkcs12, "pbeWithMD5AndDES-CBC");\r\nregister_ber_oid_dissector("1.2.840.113549.1.5.4", dissect_PBEParameter_PDU, proto_pkcs12, "pbeWithMD2AndRC2-CBC");\r\nregister_ber_oid_dissector("1.2.840.113549.1.5.6", dissect_PBEParameter_PDU, proto_pkcs12, "pbeWithMD5AndRC2-CBC");\r\nregister_ber_oid_dissector("1.2.840.113549.1.5.10", dissect_PBEParameter_PDU, proto_pkcs12, "pbeWithSHA1AndDES-CBC");\r\nregister_ber_oid_dissector("1.2.840.113549.1.5.11", dissect_PBEParameter_PDU, proto_pkcs12, "pbeWithSHA1AndRC2-CBC");\r\nregister_ber_oid_dissector("1.2.840.113549.1.5.12", dissect_PBKDF2Params_PDU, proto_pkcs12, "id-PBKDF2");\r\nregister_ber_oid_dissector("1.2.840.113549.1.5.13", dissect_PBES2Params_PDU, proto_pkcs12, "id-PBES2");\r\nregister_ber_oid_dissector("1.2.840.113549.1.5.14", dissect_PBMAC1Params_PDU, proto_pkcs12, "id-PBMAC1");\r\n#line 508 "./asn1/pkcs12/packet-pkcs12-template.c"\r\nregister_ber_oid_dissector("1.2.840.113549.1.9.22.1", dissect_X509Certificate_OCTETSTRING_PDU, proto_pkcs12, "x509Certificate");\r\n}
