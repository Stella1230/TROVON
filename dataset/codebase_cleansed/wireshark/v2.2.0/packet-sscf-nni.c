static int\r\ndissect_sscf_nni(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nguint reported_length;\r\nproto_item *sscf_item = NULL;\r\nproto_tree *sscf_tree = NULL;\r\nguint8 sscf_status;\r\nreported_length = tvb_reported_length(tvb);\r\nif (tree) {\r\nsscf_item = proto_tree_add_item(tree, proto_sscf, tvb, 0, -1, ENC_NA);\r\nsscf_tree = proto_item_add_subtree(sscf_item, ett_sscf);\r\n}\r\nif (reported_length > SSCF_PDU_LENGTH)\r\n{\r\ncall_dissector(mtp3_handle, tvb, pinfo, tree);\r\n} else {\r\nsscf_status = tvb_get_guint8(tvb, SSCF_STATUS_OFFSET);\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "SSCF-NNI");\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "STATUS (%s) ",\r\nval_to_str_const(sscf_status, sscf_status_vals, "Unknown"));\r\nproto_tree_add_item(sscf_tree, hf_status, tvb, SSCF_STATUS_OFFSET,\r\nSSCF_STATUS_LENGTH, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(sscf_tree, hf_spare, tvb, SSCF_SPARE_OFFSET,\r\nSSCF_SPARE_LENGTH, ENC_BIG_ENDIAN);\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_sscf(void)\r\n{\r\nstatic hf_register_info hf[] =\r\n{ { &hf_status, { "Status", "sscf-nni.status", FT_UINT8, BASE_HEX,\r\nVALS(sscf_status_vals), 0x0, NULL, HFILL} },\r\n{ &hf_spare, { "Spare", "sscf-nni.spare", FT_UINT24, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL} }\r\n};\r\nstatic gint *ett[] = {\r\n&ett_sscf,\r\n};\r\nproto_sscf = proto_register_protocol("SSCF-NNI", "SSCF-NNI", "sscf-nni");\r\nproto_register_field_array(proto_sscf, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nregister_dissector("sscf-nni", dissect_sscf_nni, proto_sscf);\r\n}\r\nvoid\r\nproto_reg_handoff_sscf(void)\r\n{\r\nmtp3_handle = find_dissector_add_dependency("mtp3", proto_sscf);\r\n}
