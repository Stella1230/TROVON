static gint\r\ndissect_tss_mo_state(tvbuff_t *tvb, gint offset, proto_tree *tree)\r\n{\r\nguint8 tmp;\r\nguint i = 0;\r\nfor (i = 0; i < 8; i+= 2) {\r\ntmp = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_uint_format(tree, hf_om2k_tsn_state, tvb, offset, 1, tmp & 0xf,\r\n"Timslot %u MO State: %s", i,\r\nval_to_str(tmp & 0xf, om2k_mo_state_vals, "unknown (%02d)"));\r\nproto_tree_add_uint_format(tree, hf_om2k_tsn_state, tvb, offset, 1, tmp >> 4,\r\n"Timslot %u MO State: %s", i+1,\r\nval_to_str(tmp >> 4, om2k_mo_state_vals, "unknown (%02d)"));\r\noffset++;\r\n}\r\nreturn 4;\r\n}\r\nstatic gint\r\ndissect_om2k_time(tvbuff_t *tvb, gint offset, proto_tree *tree)\r\n{\r\nnstime_t tmptime;\r\ntime_t tval;\r\nstruct tm _time;\r\n_time.tm_year = 100 + tvb_get_guint8(tvb, offset++);\r\n_time.tm_mon = tvb_get_guint8(tvb, offset++) - 1;\r\n_time.tm_mday = tvb_get_guint8(tvb, offset++);\r\n_time.tm_hour = tvb_get_guint8(tvb, offset++);\r\n_time.tm_min = tvb_get_guint8(tvb, offset++);\r\n_time.tm_sec = tvb_get_guint8(tvb, offset++);\r\n_time.tm_isdst = -1;\r\ntval = mktime(&_time);\r\ntmptime.secs = tval;\r\ntmptime.nsecs = 0;\r\nproto_tree_add_time(tree, hf_om2k_cal_time, tvb, offset, 6,\r\n&tmptime);\r\nreturn 6;\r\n}\r\nstatic gint\r\ndissect_om2k_attr_unkn(tvbuff_t *tvb, gint offset, gint len, gint iei, proto_tree *tree)\r\n{\r\nproto_tree_add_bytes_format(tree, hf_om2k_unknown_val, tvb,\r\noffset, len, NULL,\r\n"%s: %s",\r\nval_to_str_ext(iei, &om2k_attr_vals_ext, "0x%02x"),\r\ntvb_bytes_to_str(wmem_packet_scope(), tvb, offset, len));\r\nreturn len;\r\n}\r\nstatic gint\r\ndissect_om2k_is_list(tvbuff_t *tvb, gint base_offset, proto_tree *tree)\r\n{\r\ngint offset = base_offset;\r\nproto_item *ti;\r\nproto_tree *isl_tree;\r\nguint8 len = tvb_get_guint8(tvb, offset++);\r\nti = proto_tree_add_item(tree, hf_om2k_isl, tvb, offset, len, ENC_NA);\r\nisl_tree = proto_item_add_subtree(ti, ett_om2k_isl);\r\nwhile (offset < base_offset + len) {\r\nproto_tree_add_item(isl_tree, hf_om2k_isl_icp1, tvb,\r\noffset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(isl_tree, hf_om2k_isl_icp2, tvb,\r\noffset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(isl_tree, hf_om2k_isl_ci, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\n}\r\nreturn offset - base_offset;\r\n}\r\nstatic gint\r\ndissect_om2k_con_list(tvbuff_t *tvb, gint base_offset, proto_tree *tree)\r\n{\r\ngint offset = base_offset;\r\nproto_item *ti;\r\nproto_tree *conl_tree;\r\nguint8 len = tvb_get_guint8(tvb, offset++);\r\nti = proto_tree_add_item(tree, hf_om2k_conl, tvb, offset, len, ENC_NA);\r\nconl_tree = proto_item_add_subtree(ti, ett_om2k_conl);\r\nproto_tree_add_item(conl_tree, hf_om2k_conl_nr_cgs, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nwhile (offset < base_offset + len) {\r\nguint8 nr_cps_cg = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(conl_tree, hf_om2k_conl_nr_cps_cg, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nwhile (nr_cps_cg--) {\r\nproto_tree_add_item(conl_tree, hf_om2k_conl_ccp, tvb,\r\noffset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(conl_tree, hf_om2k_conl_ci, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(conl_tree, hf_om2k_conl_tag, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(conl_tree, hf_om2k_conl_tei, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nreturn offset - base_offset;\r\n}\r\nstatic gint\r\ndissect_om2k_attrs(tvbuff_t *tvb, gint offset, proto_tree *tree)\r\n{\r\nwhile (tvb_reported_length_remaining(tvb, offset) > 0) {\r\nguint8 iei = tvb_get_guint8(tvb, offset++);\r\nguint8 len, tmp;\r\nswitch (iei) {\r\ncase 0x00:\r\nproto_tree_add_item(tree, hf_om2k_aip, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x06:\r\nproto_tree_add_item(tree, hf_om2k_bcc, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x07:\r\nproto_tree_add_item(tree, hf_om2k_bs_ag_blks_res, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x09:\r\nproto_tree_add_item(tree, hf_om2k_bsic, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x0a:\r\nproto_tree_add_item(tree, hf_om2k_bs_pa_mfrms, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x0b:\r\nproto_tree_add_item(tree, hf_om2k_cbi, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x0c:\r\nproto_tree_add_item(tree, hf_om2k_cr, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_om2k_ipt3, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_om2k_aop, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nbreak;\r\ncase 0x0d:\r\noffset += dissect_om2k_time(tvb, offset, tree);\r\nbreak;\r\ncase 0x0f:\r\nproto_tree_add_item(tree, hf_om2k_comb, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x10:\r\noffset += dissect_om2k_con_list(tvb, offset, tree);\r\nbreak;\r\ncase 0x12:\r\nproto_tree_add_item(tree, hf_om2k_drx_dev_max, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x13:\r\nproto_tree_add_item(tree, hf_om2k_list_nr_end, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x14:\r\ncase 0x15:\r\noffset += dissect_om2k_attr_unkn(tvb, offset, 2, iei, tree);\r\nbreak;\r\ncase 0x16:\r\nproto_tree_add_item(tree, hf_om2k_filerel_ilr, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_om2k_filerel_cur, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(tree, hf_om2k_filerel_other, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nbreak;\r\ncase 0x17:\r\nproto_tree_add_item(tree, hf_om2k_file_rev, tvb,\r\noffset, 8, ENC_ASCII|ENC_NA);\r\noffset += 8;\r\nbreak;\r\ncase 0x1c:\r\nproto_tree_add_item(tree, hf_om2k_fill_mark, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x1d:\r\nproto_tree_add_item(tree, hf_om2k_fn_offs, tvb,\r\noffset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nbreak;\r\ncase 0x1e:\r\nlen = tvb_get_guint8(tvb, offset++);\r\noffset += dissect_om2k_attr_unkn(tvb, offset, len, iei, tree);\r\nbreak;\r\ncase 0x1f:\r\ncase 0x20:\r\noffset += dissect_om2k_attr_unkn(tvb, offset, 2, iei, tree);\r\nbreak;\r\ncase 0x21:\r\nproto_tree_add_item(tree, hf_om2k_hsn, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x22:\r\nproto_tree_add_item(tree, hf_om2k_icm, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x23:\r\ncase 0x24:\r\ncase 0x25:\r\ncase 0x26:\r\noffset += dissect_om2k_attr_unkn(tvb, offset, 6, iei, tree);\r\nbreak;\r\ncase 0x27:\r\noffset += dissect_om2k_is_list(tvb, offset, tree);\r\nbreak;\r\ncase 0x28:\r\nproto_tree_add_item(tree, hf_om2k_list_nr, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x2a:\r\nproto_tree_add_item(tree, hf_om2k_la_state, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x2b:\r\nproto_tree_add_item(tree, hf_om2k_maio, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x2c:\r\nproto_tree_add_item(tree, hf_om2k_mo_state, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x2d:\r\nproto_tree_add_item(tree, hf_om2k_ny1, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x2e:\r\nproto_tree_add_item(tree, hf_om2k_oip, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x2f:\r\nproto_tree_add_item(tree, hf_om2k_nom_pwr, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x33:\r\nproto_tree_add_item(tree, hf_om2k_diversity, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x34:\r\noffset += dissect_om2k_attr_unkn(tvb, offset, 6, iei, tree);\r\nbreak;\r\ncase 0x38:\r\nproto_tree_add_item(tree, hf_om2k_t3105, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x3a:\r\nproto_tree_add_item(tree, hf_om2k_tf_mode, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x3c:\r\nproto_tree_add_item(tree, hf_om2k_ts, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x3d:\r\nproto_tree_add_item(tree, hf_om2k_tsc, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x40:\r\nproto_tree_add_item(tree, hf_om2k_bts_manuf, tvb,\r\noffset, 3, ENC_ASCII|ENC_NA);\r\noffset += 3;\r\nproto_tree_add_item(tree, hf_om2k_bts_gen, tvb,\r\noffset, 3, ENC_ASCII|ENC_NA);\r\noffset += 3;\r\nproto_tree_add_item(tree, hf_om2k_bts_rev, tvb,\r\noffset, 3, ENC_ASCII|ENC_NA);\r\noffset += 3;\r\nproto_tree_add_item(tree, hf_om2k_bts_var, tvb,\r\noffset, 3, ENC_ASCII|ENC_NA);\r\noffset += 3;\r\nbreak;\r\ncase 0x43:\r\ncase 0x44:\r\ncase 0x45:\r\ncase 0x46:\r\nlen = tvb_get_guint8(tvb, offset++);\r\noffset += dissect_om2k_attr_unkn(tvb, offset, len, iei, tree);\r\nbreak;\r\ncase 0x47:\r\nproto_tree_add_item(tree, hf_om2k_ext_range, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x48:\r\nproto_tree_add_item(tree, hf_om2k_brr, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_om2k_bfr, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nbreak;\r\ncase 0x50:\r\noffset += dissect_om2k_attr_unkn(tvb, offset, 6, iei, tree);\r\nbreak;\r\ncase 0x74:\r\noffset += dissect_om2k_attr_unkn(tvb, offset, 5, iei, tree);\r\nbreak;\r\ncase 0x79:\r\nproto_tree_add_item(tree, hf_om2k_lsc_fm, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_om2k_lsc_lsi, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_om2k_lsc_lsa, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nbreak;\r\ncase 0x7a:\r\nproto_tree_add_item(tree, hf_om2k_ls_ft, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x7b:\r\nproto_tree_add_item(tree, hf_om2k_cst, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x7e:\r\nproto_tree_add_item(tree, hf_om2k_icm_cr, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x84:\r\nproto_tree_add_item(tree, hf_om2k_hwinfo_sig, tvb,\r\noffset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nbreak;\r\ncase 0x87:\r\nproto_tree_add_item(tree, hf_om2k_tta, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x8a:\r\nproto_tree_add_item(tree, hf_om2k_capa_sig, tvb,\r\noffset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nbreak;\r\ncase 0x90:\r\ncase 0x91:\r\nlen = tvb_get_guint8(tvb, offset++);\r\noffset += dissect_om2k_attr_unkn(tvb, offset, len, iei, tree);\r\nbreak;\r\ncase 0x92:\r\nproto_tree_add_item(tree, hf_om2k_ea, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x94:\r\nproto_tree_add_item(tree, hf_om2k_irc, tvb,\r\noffset++, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x95:\r\noffset += dissect_om2k_attr_unkn(tvb, offset, 3, iei, tree);\r\nbreak;\r\ncase 0x98:\r\nproto_tree_add_item(tree, hf_om2k_tf_fs_offset, tvb,\r\noffset, 5, ENC_BIG_ENDIAN);\r\noffset += 5;\r\nbreak;\r\ncase 0x9c:\r\noffset += dissect_om2k_attr_unkn(tvb, offset, 4, iei, tree);\r\nbreak;\r\ncase 0x9d:\r\noffset += dissect_tss_mo_state(tvb, offset, tree);\r\nbreak;\r\ncase 0x9e:\r\ncase 0x9f:\r\ndefault:\r\ntmp = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_uint_format(tree, hf_om2k_unknown_tag, tvb,\r\noffset-1, 1, tmp, "Tag %s: 0x%02x",\r\nval_to_str_ext(iei, &om2k_attr_vals_ext, "0x%02x"), tmp);\r\noffset++;\r\nbreak;\r\n}\r\n}\r\nreturn offset;\r\n}\r\nstatic guint\r\ndissect_om2k_mo(tvbuff_t *tvb, gint offset, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint8 mo_class = tvb_get_guint8(tvb, offset);\r\nguint8 inst = tvb_get_guint8(tvb, offset+3);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ", (%-4s %u)",\r\nval_to_str(mo_class, om2k_mo_class_short_vals,\r\n"0x%02x"), inst);\r\nif (tree) {\r\nproto_item *ti;\r\nproto_tree *mo_tree;\r\nguint8 sub1 = tvb_get_guint8(tvb, offset+1);\r\nguint8 sub2 = tvb_get_guint8(tvb, offset+2);\r\nti = proto_tree_add_item(tree, hf_om2k_mo_if, tvb, offset,\r\n4, ENC_NA);\r\nmo_tree = proto_item_add_subtree(ti, ett_om2k_mo);\r\nproto_tree_add_item(mo_tree, hf_om2k_mo_class, tvb, offset,\r\n1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(mo_tree, hf_om2k_mo_sub1, tvb, offset+1,\r\n1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(mo_tree, hf_om2k_mo_sub2, tvb, offset+2,\r\n1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(mo_tree, hf_om2k_mo_instance, tvb, offset+3,\r\n1, ENC_BIG_ENDIAN);\r\nproto_item_append_text(ti, ", Class: %s, Sub: %02x/%02x, Instance: %u",\r\nval_to_str(mo_class, om2k_mo_class_vals, "0x%02x"),\r\nsub1, sub2, inst);\r\n}\r\nreturn 4;\r\n}\r\nstatic int\r\ndissect_abis_om2000(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nproto_item *ti;\r\nproto_tree *om2k_tree;\r\nguint16 msg_code;\r\nguint8 tmp;\r\nint offset;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "OM2000");\r\noffset = 0;\r\nti = proto_tree_add_item(tree, proto_abis_om2000,\r\ntvb, 0, -1, ENC_NA);\r\nom2k_tree = proto_item_add_subtree(ti, ett_om2000);\r\nmsg_code = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_item(om2k_tree, hf_om2k_msg_code, tvb, offset,\r\n2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\noffset += dissect_om2k_mo(tvb, offset, pinfo, om2k_tree);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " %s ",\r\nval_to_str_ext(msg_code, &om2k_msgcode_vals_ext,\r\n"unknown 0x%04x"));\r\nif (tree == NULL)\r\nreturn tvb_captured_length(tvb);\r\nproto_item_append_text(ti, " %s ",\r\nval_to_str_ext(msg_code, &om2k_msgcode_vals_ext,\r\n"unknown 0x%04x"));\r\nswitch (msg_code) {\r\ncase 0x74:\r\ntmp = tvb_get_guint8(tvb, offset+1);\r\nproto_item_append_text(ti, ": %s",\r\nval_to_str(tmp, om2k_oip_vals,\r\n"unknown 0x%02x"));\r\nbreak;\r\ncase 0x1A:\r\ncase 0x66:\r\ncase 0x82:\r\ncase 0xA6:\r\ncase 0xAE:\r\ncase 0xB6:\r\ncase 0xE2:\r\ncase 0xF6:\r\ntmp = tvb_get_guint8(tvb, offset+1);\r\nproto_item_append_text(ti, ": %s",\r\nval_to_str(tmp, om2k_aip_vals,\r\n"unknown 0x%02x"));\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\ndissect_om2k_attrs(tvb, offset, om2k_tree);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_abis_om2000(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_om2k_msg_code,\r\n{ "Message Code", "gsm_abis_om2000.msg_code",\r\nFT_UINT16, BASE_HEX|BASE_EXT_STRING, &om2k_msgcode_vals_ext, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_mo_if,\r\n{ "MO Interface", "gsm_abis_om2000.mo_if",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_mo_class,\r\n{ "MO IF Class", "gsm_abis_om2000.mo_if.class",\r\nFT_UINT8, BASE_HEX, VALS(om2k_mo_class_vals), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_mo_sub1,\r\n{ "MO IF Sub 1", "gsm_abis_om2000.mo_if.sub1",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_mo_sub2,\r\n{ "MO IF Sub 2", "gsm_abis_om2000.mo_if.sub2",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_mo_instance,\r\n{ "MO IF Instance", "gsm_abis_om2000.mo_if.instance",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_oip,\r\n{ "OIP (Operational Info)", "gsm_abis_om2000.oip",\r\nFT_UINT8, BASE_HEX, VALS(om2k_oip_vals), 0,\r\n"Operational Information Parameter", HFILL }\r\n},\r\n{ &hf_om2k_aip,\r\n{ "AIP (Accordance Info)", "gsm_abis_om2000.aip",\r\nFT_UINT8, BASE_HEX, VALS(om2k_aip_vals), 0,\r\n"Accordance Information Parameter", HFILL }\r\n},\r\n{ &hf_om2k_comb,\r\n{ "Channel Combination", "gsm_abis_om2000.chan_comb",\r\nFT_UINT8, BASE_DEC, VALS(om2k_comb_vals), 0,\r\n"Logical Channel Combination", HFILL }\r\n},\r\n{ &hf_om2k_ts,\r\n{ "Timeslot Number", "gsm_abis_om2000.ts",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_hsn,\r\n{ "HSN", "gsm_abis_om2000.hsn",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"Hopping Sequence Number", HFILL }\r\n},\r\n{ &hf_om2k_maio,\r\n{ "MAIO", "gsm_abis_om2000.maio",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"Mobile Allication Index Offset", HFILL }\r\n},\r\n{ &hf_om2k_bsic,\r\n{ "BSIC", "gsm_abis_om2000.bsic",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\n"Base Station Identity Code", HFILL }\r\n},\r\n{ &hf_om2k_diversity,\r\n{ "Receiver Diversity", "gsm_abis_om2000.diversity",\r\nFT_UINT8, BASE_HEX, VALS(om2k_diversity_vals), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_fn_offs,\r\n{ "FN Offset", "gsm_abis_om2000.fn_offset",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n"GSM Frame Number Offset", HFILL }\r\n},\r\n{ &hf_om2k_ext_range,\r\n{ "Extended Range", "gsm_abis_om2000.ext_range",\r\nFT_BOOLEAN, 1, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_irc,\r\n{ "Interference Rejection Combining", "gsm_abis_om2000.irc",\r\nFT_BOOLEAN, 1, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_bs_pa_mfrms,\r\n{ "BS_PA_MFRMS", "gsm_abis_om2000.bs_pa_mfrms",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_bs_ag_blks_res,\r\n{ "BS_AG_BLKS_RES", "gsm_abis_om2000.bs_ag_blks_res",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_drx_dev_max,\r\n{ "DRX_DEV_MAX", "gsm_abis_om2000.drx_dev_max",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_cr,\r\n{ "CCCH Repeat", "gsm_abis_om2000.ccch_repeat",\r\nFT_BOOLEAN, 1, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_ipt3,\r\n{ "Inhibit Paging Request Type 3", "gsm_abis_om2000.ipt3",\r\nFT_BOOLEAN, 2, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_aop,\r\n{ "Age Of Paging", "gsm_abis_om2000.aop",\r\nFT_UINT8, BASE_DEC, NULL, 0x3C,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_t3105,\r\n{ "T3105 (in 10ms)", "gsm_abis_om2000.t3105",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_ny1,\r\n{ "Ny1", "gsm_abis_om2000.ny1",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_cbi,\r\n{ "CBCH Indicator", "gsm_abis_om2000.cbi",\r\nFT_BOOLEAN, 1, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_tsc,\r\n{ "Training Sequence Code", "gsm_abis_om2000.tsc",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_icm,\r\n{ "Idle Channel Measurement", "gsm_abis_om2000.icm",\r\nFT_BOOLEAN, 1, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_tta,\r\n{ "Timer for Time Alignment", "gsm_abis_om2000.tta",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_icm_cr,\r\n{ "ICM Channel Rate", "gsm_abis_om2000.icm_cr",\r\nFT_UINT8, BASE_DEC, VALS(om2k_icmcr_vals), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_lsc_fm,\r\n{ "LSC Dummy Frequency Measurement", "gsm_abis_om2000.lsc.fm",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_lsc_lsi,\r\n{ "LSC Idle Channels", "gsm_abis_om2000.ls.lsi",\r\nFT_BOOLEAN, 8, NULL, 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_lsc_lsa,\r\n{ "LSC Active Channels", "gsm_abis_om2000.ls.lsa",\r\nFT_BOOLEAN, 8, NULL, 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_ls_ft,\r\n{ "Link Supervision Filtering Time (100ms)", "gsm_abis_om2000.ls_ft",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_cst,\r\n{ "Call Supervision Time (480ms)", "gsm_abis_om2000.cst",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_ea,\r\n{ "Encryption Algorithm", "gsm_abis_om2000.ea",\r\nFT_UINT8, BASE_DEC, VALS(om2k_ea_vals), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_nom_pwr,\r\n{ "Nominal Power (dBm)", "gsm_abis_om2000.pwr",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_fill_mark,\r\n{ "Filling Marker", "gsm_abis_om2000.filling",\r\nFT_UINT8, BASE_DEC, VALS(om2k_fill_vals), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_bcc,\r\n{ "BCC", "gsm_abis_om2000.bcc",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\n"Base Station Color Code", HFILL }\r\n},\r\n{ &hf_om2k_mo_state,\r\n{ "MO State", "gsm_abis_om2000.mo_state",\r\nFT_UINT8, BASE_DEC, VALS(om2k_mo_state_vals), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_la_state,\r\n{ "Local Access State", "gsm_abis_om2000.la_state",\r\nFT_UINT8, BASE_DEC, VALS(om2k_la_state_vals), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_tsn_state,\r\n{ "Time Slot N MO State", "gsm_abis_om2000.tsn_mo_state",\r\nFT_UINT8, BASE_DEC, VALS(om2k_mo_state_vals), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_bts_manuf,\r\n{ "BTS Manufacturer ID", "gsm_abis_om2000.bts_ver.manuf",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_bts_gen,\r\n{ "BTS Generation", "gsm_abis_om2000.bts_ver.gen",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_bts_rev,\r\n{ "BTS Revision", "gsm_abis_om2000.bts_ver.rev",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_bts_var,\r\n{ "BTS Variant", "gsm_abis_om2000.bts_ver.variant",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_brr,\r\n{ "BTS Requested Restart", "gsm_abis_om2000.brr",\r\nFT_BOOLEAN, 0x01, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_bfr,\r\n{ "BTS Requested File Relation", "gsm_abis_om2000.bfr",\r\nFT_BOOLEAN, 0x01, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_hwinfo_sig,\r\n{ "HW Info Signature", "gsm_abis_om2000.hwinfo_sig",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_capa_sig,\r\n{ "Capabilities Signature", "gsm_abis_om2000.capa_sig",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_unknown_tag,\r\n{ "Unknown Tag", "gsm_abis_om2000.unknown.tag",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_unknown_val,\r\n{ "Unknown Value", "gsm_abis_om2000.unknown.val",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_file_rev,\r\n{ "File Revision", "gsm_abis_om2000.file_rev",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_filerel_ilr,\r\n{ "Immediate Load Requested", "gsm_abis_om2000.filerel.ilr",\r\nFT_BOOLEAN, 8, NULL, 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_filerel_cur,\r\n{ "Current State", "gsm_abis_om2000.filerel.cur",\r\nFT_UINT8, BASE_HEX, VALS(filerel_state_vals), 0x07,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_filerel_other,\r\n{ "Other State", "gsm_abis_om2000.filerel.other",\r\nFT_UINT8, BASE_HEX, VALS(filerel_state_vals), 0x07,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_cal_time,\r\n{ "Calendar Time", "gsm_abis_om2000.cal_time",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_LOCAL, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_list_nr,\r\n{ "List Number", "gsm_abis_om2000.list_nr",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_list_nr_end,\r\n{ "End List Number", "gsm_abis_om2000.list_nr_end",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_isl,\r\n{ "IS Connection List", "gsm_abis_om2000.is_list",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_isl_icp1,\r\n{ "ICP1", "gsm_abis_om2000.is_list.icp1",\r\nFT_UINT16, BASE_DEC, NULL, 0x7ff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_isl_icp2,\r\n{ "ICP2", "gsm_abis_om2000.is_list.icp2",\r\nFT_UINT16, BASE_DEC, NULL, 0x7ff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_isl_ci,\r\n{ "Contiguity Index", "gsm_abis_om2000.is_list.ci",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_conl,\r\n{ "Connection List", "gsm_abis_om2000.con_list",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_conl_nr_cgs,\r\n{ "Number of CGs", "gsm_abis_om2000.con_list.nr_cgs",\r\nFT_UINT8, BASE_DEC, NULL, 0x1f,\r\n"Number of Concentration Groups in the DE", HFILL }\r\n},\r\n{ &hf_om2k_conl_nr_cps_cg,\r\n{ "Number of CPS in CG", "gsm_abis_om2000.con_list.nr_cps_cg",\r\nFT_UINT8, BASE_DEC, NULL, 0x1f,\r\n"Number of CPS in Concentration Group", HFILL }\r\n},\r\n{ &hf_om2k_conl_ccp,\r\n{ "CON Connection Point", "gsm_abis_om2000.con_list.cpp",\r\nFT_UINT16, BASE_DEC, NULL, 0x3ff,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_conl_ci,\r\n{ "Contiguity Index", "gsm_abis_om2000.con_list.ci",\r\nFT_UINT8, BASE_DEC, NULL, 0x7,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_conl_tag,\r\n{ "Tag", "gsm_abis_om2000.con_list.tag",\r\nFT_UINT8, BASE_DEC, NULL, 0x1f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_conl_tei,\r\n{ "TEI", "gsm_abis_om2000.con_list.tei",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_tf_mode,\r\n{ "TF Mode", "gsm_abis_om2000.tf_mode",\r\nFT_UINT8, BASE_HEX, VALS(om2k_tf_mode_vals), 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_om2k_tf_fs_offset,\r\n{ "TF FS Offset", "gsm_abis_om2000.tf_fs_offset",\r\nFT_UINT64, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_om2000,\r\n&ett_om2k_mo,\r\n&ett_om2k_isl,\r\n&ett_om2k_conl,\r\n};\r\nproto_abis_om2000 = proto_register_protocol("Ericsson A-bis OML",\r\n"Ericsson OML",\r\n"gsm_abis_om2000");\r\nproto_register_field_array(proto_abis_om2000, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nregister_dissector("gsm_abis_om2000", dissect_abis_om2000,\r\nproto_abis_om2000);\r\n}
