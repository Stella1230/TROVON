static int\r\ndissect_hpteam(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "HP NIC Team");\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "HP NIC Teaming Heartbeat; Port MAC = %s",\r\naddress_to_str(wmem_packet_scope(), &pinfo->dl_src));\r\nif (tree) {\r\nproto_item *hpteam_item;\r\nproto_tree *hpteam_tree;\r\nhpteam_item = proto_tree_add_item(tree, proto_hpteam, tvb, 0, -1, ENC_NA);\r\nhpteam_tree = proto_item_add_subtree(hpteam_item, ett_hpteam);\r\nproto_tree_add_item(hpteam_tree, hf_hpteam, tvb, 0, -1, ENC_NA);\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid proto_register_hpteam(void)\r\n{\r\nstatic hf_register_info hf_pid = {\r\n&hf_llc_hpteam_pid,\r\n{ "PID", "llc.hpteam_pid",\r\nFT_UINT16, BASE_HEX, VALS(hpteam_pid_vals),\r\n0x0, NULL, HFILL }\r\n};\r\nstatic hf_register_info hf_data[] = {\r\n{&hf_hpteam,\r\n{ "Proprietary Data", "hpteam.data",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n}\r\n};\r\nstatic gint *ett[] = {\r\n&ett_hpteam\r\n};\r\nproto_hpteam = proto_register_protocol ("HP NIC Teaming Heartbeat", "HPTEAM", "hpteam");\r\nllc_add_oui(OUI_HP_2, "llc.hpteam_pid", "LLC Hewlett Packard OUI PID", &hf_pid, proto_hpteam);\r\nproto_register_field_array(proto_hpteam, hf_data, array_length(hf_data));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nregister_dissector("hpteam", dissect_hpteam, proto_hpteam);\r\n}\r\nvoid proto_reg_handoff_hpteam(void)\r\n{\r\ndissector_handle_t hpteam_handle;\r\nhpteam_handle = find_dissector("hpteam");\r\ndissector_add_uint("llc.hpteam_pid", 0x0002, hpteam_handle);\r\n}
