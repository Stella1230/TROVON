static int\r\nefs_dissect_struct_dom_sid(tvbuff_t *tvb, int offset, packet_info *pinfo _U_, proto_tree *tree, dcerpc_info* di, guint8 *drep _U_, int hf_index _U_, guint32 param _U_)\r\n{\r\nif(di->conformant_run){\r\nreturn offset;\r\n}\r\noffset=dissect_nt_sid(tvb, offset, tree, "SID", NULL, -1);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EFS_HASH_BLOB_cbData(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_efs_EFS_HASH_BLOB_cbData, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EFS_HASH_BLOB_pbData(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, tree, di, drep, efs_dissect_element_EFS_HASH_BLOB_pbData_, NDR_POINTER_UNIQUE, "Pointer to Pbdata (uint8)",hf_efs_EFS_HASH_BLOB_pbData);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EFS_HASH_BLOB_pbData_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_ucarray(tvb, offset, pinfo, tree, di, drep, efs_dissect_element_EFS_HASH_BLOB_pbData__);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EFS_HASH_BLOB_pbData__(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint8(tvb, offset, pinfo, tree, di, drep, hf_efs_EFS_HASH_BLOB_pbData, 0);\r\nreturn offset;\r\n}\r\nint\r\nefs_dissect_struct_EFS_HASH_BLOB(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *parent_tree _U_, dcerpc_info* di _U_, guint8 *drep _U_, int hf_index _U_, guint32 param _U_)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset;\r\nALIGN_TO_5_BYTES;\r\nold_offset = offset;\r\nif (parent_tree) {\r\nitem = proto_tree_add_item(parent_tree, hf_index, tvb, offset, -1, ENC_NA);\r\ntree = proto_item_add_subtree(item, ett_efs_EFS_HASH_BLOB);\r\n}\r\noffset = efs_dissect_element_EFS_HASH_BLOB_cbData(tvb, offset, pinfo, tree, di, drep);\r\noffset = efs_dissect_element_EFS_HASH_BLOB_pbData(tvb, offset, pinfo, tree, di, drep);\r\nproto_item_set_len(item, offset-old_offset);\r\nif (di->call_data->flags & DCERPC_IS_NDR64) {\r\nALIGN_TO_5_BYTES;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_ENCRYPTION_CERTIFICATE_HASH_cbTotalLength(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_efs_ENCRYPTION_CERTIFICATE_HASH_cbTotalLength, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_ENCRYPTION_CERTIFICATE_HASH_pUserSid(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, tree, di, drep, efs_dissect_element_ENCRYPTION_CERTIFICATE_HASH_pUserSid_, NDR_POINTER_UNIQUE, "Pointer to Pusersid (dom_sid)",hf_efs_ENCRYPTION_CERTIFICATE_HASH_pUserSid);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_ENCRYPTION_CERTIFICATE_HASH_pUserSid_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = efs_dissect_struct_dom_sid(tvb,offset,pinfo,tree,di,drep,hf_efs_ENCRYPTION_CERTIFICATE_HASH_pUserSid,0);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_ENCRYPTION_CERTIFICATE_HASH_pHash(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, tree, di, drep, efs_dissect_element_ENCRYPTION_CERTIFICATE_HASH_pHash_, NDR_POINTER_UNIQUE, "Pointer to Phash (EFS_HASH_BLOB)",hf_efs_ENCRYPTION_CERTIFICATE_HASH_pHash);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_ENCRYPTION_CERTIFICATE_HASH_pHash_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = efs_dissect_struct_EFS_HASH_BLOB(tvb,offset,pinfo,tree,di,drep,hf_efs_ENCRYPTION_CERTIFICATE_HASH_pHash,0);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_ENCRYPTION_CERTIFICATE_HASH_lpDisplayInformation(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, tree, di, drep, efs_dissect_element_ENCRYPTION_CERTIFICATE_HASH_lpDisplayInformation_, NDR_POINTER_UNIQUE, "Pointer to Lpdisplayinformation (uint16)",hf_efs_ENCRYPTION_CERTIFICATE_HASH_lpDisplayInformation);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_ENCRYPTION_CERTIFICATE_HASH_lpDisplayInformation_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nchar *data;\r\noffset = dissect_ndr_cvstring(tvb, offset, pinfo, tree, di, drep, sizeof(guint16), hf_efs_ENCRYPTION_CERTIFICATE_HASH_lpDisplayInformation, FALSE, &data);\r\nproto_item_append_text(tree, ": %s", data);\r\nreturn offset;\r\n}\r\nint\r\nefs_dissect_struct_ENCRYPTION_CERTIFICATE_HASH(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *parent_tree _U_, dcerpc_info* di _U_, guint8 *drep _U_, int hf_index _U_, guint32 param _U_)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset;\r\nALIGN_TO_5_BYTES;\r\nold_offset = offset;\r\nif (parent_tree) {\r\nitem = proto_tree_add_item(parent_tree, hf_index, tvb, offset, -1, ENC_NA);\r\ntree = proto_item_add_subtree(item, ett_efs_ENCRYPTION_CERTIFICATE_HASH);\r\n}\r\noffset = efs_dissect_element_ENCRYPTION_CERTIFICATE_HASH_cbTotalLength(tvb, offset, pinfo, tree, di, drep);\r\noffset = efs_dissect_element_ENCRYPTION_CERTIFICATE_HASH_pUserSid(tvb, offset, pinfo, tree, di, drep);\r\noffset = efs_dissect_element_ENCRYPTION_CERTIFICATE_HASH_pHash(tvb, offset, pinfo, tree, di, drep);\r\noffset = efs_dissect_element_ENCRYPTION_CERTIFICATE_HASH_lpDisplayInformation(tvb, offset, pinfo, tree, di, drep);\r\nproto_item_set_len(item, offset-old_offset);\r\nif (di->call_data->flags & DCERPC_IS_NDR64) {\r\nALIGN_TO_5_BYTES;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_ENCRYPTION_CERTIFICATE_HASH_LIST_nCert_Hash(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_efs_ENCRYPTION_CERTIFICATE_HASH_LIST_nCert_Hash, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_ENCRYPTION_CERTIFICATE_HASH_LIST_pUsers(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_ucarray(tvb, offset, pinfo, tree, di, drep, efs_dissect_element_ENCRYPTION_CERTIFICATE_HASH_LIST_pUsers_);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_ENCRYPTION_CERTIFICATE_HASH_LIST_pUsers_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, tree, di, drep, efs_dissect_element_ENCRYPTION_CERTIFICATE_HASH_LIST_pUsers__, NDR_POINTER_UNIQUE, "Pointer to Pusers (ENCRYPTION_CERTIFICATE_HASH)",hf_efs_ENCRYPTION_CERTIFICATE_HASH_LIST_pUsers);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_ENCRYPTION_CERTIFICATE_HASH_LIST_pUsers__(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = efs_dissect_struct_ENCRYPTION_CERTIFICATE_HASH(tvb,offset,pinfo,tree,di,drep,hf_efs_ENCRYPTION_CERTIFICATE_HASH_LIST_pUsers,0);\r\nreturn offset;\r\n}\r\nint\r\nefs_dissect_struct_ENCRYPTION_CERTIFICATE_HASH_LIST(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *parent_tree _U_, dcerpc_info* di _U_, guint8 *drep _U_, int hf_index _U_, guint32 param _U_)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset;\r\nALIGN_TO_5_BYTES;\r\nold_offset = offset;\r\nif (parent_tree) {\r\nitem = proto_tree_add_item(parent_tree, hf_index, tvb, offset, -1, ENC_NA);\r\ntree = proto_item_add_subtree(item, ett_efs_ENCRYPTION_CERTIFICATE_HASH_LIST);\r\n}\r\noffset = efs_dissect_element_ENCRYPTION_CERTIFICATE_HASH_LIST_nCert_Hash(tvb, offset, pinfo, tree, di, drep);\r\noffset = efs_dissect_element_ENCRYPTION_CERTIFICATE_HASH_LIST_pUsers(tvb, offset, pinfo, tree, di, drep);\r\nproto_item_set_len(item, offset-old_offset);\r\nif (di->call_data->flags & DCERPC_IS_NDR64) {\r\nALIGN_TO_5_BYTES;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EFS_CERTIFICATE_BLOB_dwCertEncodingType(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_efs_EFS_CERTIFICATE_BLOB_dwCertEncodingType, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EFS_CERTIFICATE_BLOB_cbData(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_efs_EFS_CERTIFICATE_BLOB_cbData, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EFS_CERTIFICATE_BLOB_pbData(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, tree, di, drep, efs_dissect_element_EFS_CERTIFICATE_BLOB_pbData_, NDR_POINTER_UNIQUE, "Pointer to Pbdata (uint8)",hf_efs_EFS_CERTIFICATE_BLOB_pbData);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EFS_CERTIFICATE_BLOB_pbData_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_ucarray(tvb, offset, pinfo, tree, di, drep, efs_dissect_element_EFS_CERTIFICATE_BLOB_pbData__);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EFS_CERTIFICATE_BLOB_pbData__(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint8(tvb, offset, pinfo, tree, di, drep, hf_efs_EFS_CERTIFICATE_BLOB_pbData, 0);\r\nreturn offset;\r\n}\r\nint\r\nefs_dissect_struct_EFS_CERTIFICATE_BLOB(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *parent_tree _U_, dcerpc_info* di _U_, guint8 *drep _U_, int hf_index _U_, guint32 param _U_)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset;\r\nALIGN_TO_5_BYTES;\r\nold_offset = offset;\r\nif (parent_tree) {\r\nitem = proto_tree_add_item(parent_tree, hf_index, tvb, offset, -1, ENC_NA);\r\ntree = proto_item_add_subtree(item, ett_efs_EFS_CERTIFICATE_BLOB);\r\n}\r\noffset = efs_dissect_element_EFS_CERTIFICATE_BLOB_dwCertEncodingType(tvb, offset, pinfo, tree, di, drep);\r\noffset = efs_dissect_element_EFS_CERTIFICATE_BLOB_cbData(tvb, offset, pinfo, tree, di, drep);\r\noffset = efs_dissect_element_EFS_CERTIFICATE_BLOB_pbData(tvb, offset, pinfo, tree, di, drep);\r\nproto_item_set_len(item, offset-old_offset);\r\nif (di->call_data->flags & DCERPC_IS_NDR64) {\r\nALIGN_TO_5_BYTES;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_ENCRYPTION_CERTIFICATE_TotalLength(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_efs_ENCRYPTION_CERTIFICATE_TotalLength, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_ENCRYPTION_CERTIFICATE_pUserSid(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, tree, di, drep, efs_dissect_element_ENCRYPTION_CERTIFICATE_pUserSid_, NDR_POINTER_UNIQUE, "Pointer to Pusersid (dom_sid)",hf_efs_ENCRYPTION_CERTIFICATE_pUserSid);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_ENCRYPTION_CERTIFICATE_pUserSid_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = efs_dissect_struct_dom_sid(tvb,offset,pinfo,tree,di,drep,hf_efs_ENCRYPTION_CERTIFICATE_pUserSid,0);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_ENCRYPTION_CERTIFICATE_pCertBlob(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, tree, di, drep, efs_dissect_element_ENCRYPTION_CERTIFICATE_pCertBlob_, NDR_POINTER_UNIQUE, "Pointer to Pcertblob (EFS_CERTIFICATE_BLOB)",hf_efs_ENCRYPTION_CERTIFICATE_pCertBlob);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_ENCRYPTION_CERTIFICATE_pCertBlob_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = efs_dissect_struct_EFS_CERTIFICATE_BLOB(tvb,offset,pinfo,tree,di,drep,hf_efs_ENCRYPTION_CERTIFICATE_pCertBlob,0);\r\nreturn offset;\r\n}\r\nint\r\nefs_dissect_struct_ENCRYPTION_CERTIFICATE(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *parent_tree _U_, dcerpc_info* di _U_, guint8 *drep _U_, int hf_index _U_, guint32 param _U_)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset;\r\nALIGN_TO_5_BYTES;\r\nold_offset = offset;\r\nif (parent_tree) {\r\nitem = proto_tree_add_item(parent_tree, hf_index, tvb, offset, -1, ENC_NA);\r\ntree = proto_item_add_subtree(item, ett_efs_ENCRYPTION_CERTIFICATE);\r\n}\r\noffset = efs_dissect_element_ENCRYPTION_CERTIFICATE_TotalLength(tvb, offset, pinfo, tree, di, drep);\r\noffset = efs_dissect_element_ENCRYPTION_CERTIFICATE_pUserSid(tvb, offset, pinfo, tree, di, drep);\r\noffset = efs_dissect_element_ENCRYPTION_CERTIFICATE_pCertBlob(tvb, offset, pinfo, tree, di, drep);\r\nproto_item_set_len(item, offset-old_offset);\r\nif (di->call_data->flags & DCERPC_IS_NDR64) {\r\nALIGN_TO_5_BYTES;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EfsRpcOpenFileRaw_pvContext(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_toplevel_pointer(tvb, offset, pinfo, tree, di, drep, efs_dissect_element_EfsRpcOpenFileRaw_pvContext_, NDR_POINTER_REF, "Pointer to Pvcontext (policy_handle)",hf_efs_EfsRpcOpenFileRaw_pvContext);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EfsRpcOpenFileRaw_pvContext_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_policy_hnd(tvb, offset, pinfo, tree, di, drep, hf_efs_EfsRpcOpenFileRaw_pvContext, PIDL_POLHND_OPEN);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EfsRpcOpenFileRaw_FileName(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nchar *data;\r\noffset = dissect_ndr_cvstring(tvb, offset, pinfo, tree, di, drep, sizeof(guint16), hf_efs_EfsRpcOpenFileRaw_FileName, FALSE, &data);\r\nproto_item_append_text(tree, ": %s", data);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EfsRpcOpenFileRaw_Flags(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_efs_EfsRpcOpenFileRaw_Flags, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_EfsRpcOpenFileRaw_response(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nguint32 status;\r\ndi->dcerpc_procedure_name="EfsRpcOpenFileRaw";\r\noffset = efs_dissect_element_EfsRpcOpenFileRaw_pvContext(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep, hf_efs_werror, &status);\r\nif (status != 0)\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ", Error: %s", val_to_str(status, WERR_errors, "Unknown DOS error 0x%08x"));\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_EfsRpcOpenFileRaw_request(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\ndi->dcerpc_procedure_name="EfsRpcOpenFileRaw";\r\noffset = efs_dissect_element_EfsRpcOpenFileRaw_FileName(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = efs_dissect_element_EfsRpcOpenFileRaw_Flags(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EfsRpcReadFileRaw_pvContext(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_toplevel_pointer(tvb, offset, pinfo, tree, di, drep, efs_dissect_element_EfsRpcReadFileRaw_pvContext_, NDR_POINTER_REF, "Pointer to Pvcontext (policy_handle)",hf_efs_EfsRpcReadFileRaw_pvContext);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EfsRpcReadFileRaw_pvContext_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_policy_hnd(tvb, offset, pinfo, tree, di, drep, hf_efs_EfsRpcReadFileRaw_pvContext, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_EfsRpcReadFileRaw_response(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nguint32 status;\r\ndi->dcerpc_procedure_name="EfsRpcReadFileRaw";\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep, hf_efs_werror, &status);\r\nif (status != 0)\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ", Error: %s", val_to_str(status, WERR_errors, "Unknown DOS error 0x%08x"));\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_EfsRpcReadFileRaw_request(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\ndi->dcerpc_procedure_name="EfsRpcReadFileRaw";\r\noffset = efs_dissect_element_EfsRpcReadFileRaw_pvContext(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EfsRpcWriteFileRaw_pvContext(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_toplevel_pointer(tvb, offset, pinfo, tree, di, drep, efs_dissect_element_EfsRpcWriteFileRaw_pvContext_, NDR_POINTER_REF, "Pointer to Pvcontext (policy_handle)",hf_efs_EfsRpcWriteFileRaw_pvContext);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EfsRpcWriteFileRaw_pvContext_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_policy_hnd(tvb, offset, pinfo, tree, di, drep, hf_efs_EfsRpcWriteFileRaw_pvContext, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_EfsRpcWriteFileRaw_response(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nguint32 status;\r\ndi->dcerpc_procedure_name="EfsRpcWriteFileRaw";\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep, hf_efs_werror, &status);\r\nif (status != 0)\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ", Error: %s", val_to_str(status, WERR_errors, "Unknown DOS error 0x%08x"));\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_EfsRpcWriteFileRaw_request(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\ndi->dcerpc_procedure_name="EfsRpcWriteFileRaw";\r\noffset = efs_dissect_element_EfsRpcWriteFileRaw_pvContext(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EfsRpcCloseRaw_pvContext(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_toplevel_pointer(tvb, offset, pinfo, tree, di, drep, efs_dissect_element_EfsRpcCloseRaw_pvContext_, NDR_POINTER_REF, "Pointer to Pvcontext (policy_handle)",hf_efs_EfsRpcCloseRaw_pvContext);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EfsRpcCloseRaw_pvContext_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_policy_hnd(tvb, offset, pinfo, tree, di, drep, hf_efs_EfsRpcCloseRaw_pvContext, PIDL_POLHND_CLOSE);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_EfsRpcCloseRaw_response(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\ndi->dcerpc_procedure_name="EfsRpcCloseRaw";\r\noffset = efs_dissect_element_EfsRpcCloseRaw_pvContext(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_EfsRpcCloseRaw_request(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\ndi->dcerpc_procedure_name="EfsRpcCloseRaw";\r\noffset = efs_dissect_element_EfsRpcCloseRaw_pvContext(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EfsRpcEncryptFileSrv_Filename(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nchar *data;\r\noffset = dissect_ndr_cvstring(tvb, offset, pinfo, tree, di, drep, sizeof(guint16), hf_efs_EfsRpcEncryptFileSrv_Filename, FALSE, &data);\r\nproto_item_append_text(tree, ": %s", data);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_EfsRpcEncryptFileSrv_response(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nguint32 status;\r\ndi->dcerpc_procedure_name="EfsRpcEncryptFileSrv";\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep, hf_efs_werror, &status);\r\nif (status != 0)\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ", Error: %s", val_to_str(status, WERR_errors, "Unknown DOS error 0x%08x"));\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_EfsRpcEncryptFileSrv_request(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\ndi->dcerpc_procedure_name="EfsRpcEncryptFileSrv";\r\noffset = efs_dissect_element_EfsRpcEncryptFileSrv_Filename(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EfsRpcDecryptFileSrv_FileName(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nchar *data;\r\noffset = dissect_ndr_cvstring(tvb, offset, pinfo, tree, di, drep, sizeof(guint16), hf_efs_EfsRpcDecryptFileSrv_FileName, FALSE, &data);\r\nproto_item_append_text(tree, ": %s", data);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EfsRpcDecryptFileSrv_Reserved(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_efs_EfsRpcDecryptFileSrv_Reserved, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_EfsRpcDecryptFileSrv_response(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nguint32 status;\r\ndi->dcerpc_procedure_name="EfsRpcDecryptFileSrv";\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep, hf_efs_werror, &status);\r\nif (status != 0)\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ", Error: %s", val_to_str(status, WERR_errors, "Unknown DOS error 0x%08x"));\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_EfsRpcDecryptFileSrv_request(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\ndi->dcerpc_procedure_name="EfsRpcDecryptFileSrv";\r\noffset = efs_dissect_element_EfsRpcDecryptFileSrv_FileName(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = efs_dissect_element_EfsRpcDecryptFileSrv_Reserved(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EfsRpcQueryUsersOnFile_FileName(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nchar *data;\r\noffset = dissect_ndr_cvstring(tvb, offset, pinfo, tree, di, drep, sizeof(guint16), hf_efs_EfsRpcQueryUsersOnFile_FileName, FALSE, &data);\r\nproto_item_append_text(tree, ": %s", data);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EfsRpcQueryUsersOnFile_pUsers(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_toplevel_pointer(tvb, offset, pinfo, tree, di, drep, efs_dissect_element_EfsRpcQueryUsersOnFile_pUsers_, NDR_POINTER_REF, "Pointer to Pusers (ENCRYPTION_CERTIFICATE_HASH_LIST)",hf_efs_EfsRpcQueryUsersOnFile_pUsers);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EfsRpcQueryUsersOnFile_pUsers_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, tree, di, drep, efs_dissect_element_EfsRpcQueryUsersOnFile_pUsers__, NDR_POINTER_UNIQUE, "Pointer to Pusers (ENCRYPTION_CERTIFICATE_HASH_LIST)",hf_efs_EfsRpcQueryUsersOnFile_pUsers);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EfsRpcQueryUsersOnFile_pUsers__(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = efs_dissect_struct_ENCRYPTION_CERTIFICATE_HASH_LIST(tvb,offset,pinfo,tree,di,drep,hf_efs_EfsRpcQueryUsersOnFile_pUsers,0);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_EfsRpcQueryUsersOnFile_response(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nguint32 status;\r\ndi->dcerpc_procedure_name="EfsRpcQueryUsersOnFile";\r\noffset = efs_dissect_element_EfsRpcQueryUsersOnFile_pUsers(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep, hf_efs_werror, &status);\r\nif (status != 0)\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ", Error: %s", val_to_str(status, WERR_errors, "Unknown DOS error 0x%08x"));\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_EfsRpcQueryUsersOnFile_request(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\ndi->dcerpc_procedure_name="EfsRpcQueryUsersOnFile";\r\noffset = efs_dissect_element_EfsRpcQueryUsersOnFile_FileName(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EfsRpcQueryRecoveryAgents_FileName(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nchar *data;\r\noffset = dissect_ndr_cvstring(tvb, offset, pinfo, tree, di, drep, sizeof(guint16), hf_efs_EfsRpcQueryRecoveryAgents_FileName, FALSE, &data);\r\nproto_item_append_text(tree, ": %s", data);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EfsRpcQueryRecoveryAgents_pRecoveryAgents(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_toplevel_pointer(tvb, offset, pinfo, tree, di, drep, efs_dissect_element_EfsRpcQueryRecoveryAgents_pRecoveryAgents_, NDR_POINTER_REF, "Pointer to Precoveryagents (ENCRYPTION_CERTIFICATE_HASH_LIST)",hf_efs_EfsRpcQueryRecoveryAgents_pRecoveryAgents);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EfsRpcQueryRecoveryAgents_pRecoveryAgents_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, tree, di, drep, efs_dissect_element_EfsRpcQueryRecoveryAgents_pRecoveryAgents__, NDR_POINTER_UNIQUE, "Pointer to Precoveryagents (ENCRYPTION_CERTIFICATE_HASH_LIST)",hf_efs_EfsRpcQueryRecoveryAgents_pRecoveryAgents);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EfsRpcQueryRecoveryAgents_pRecoveryAgents__(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = efs_dissect_struct_ENCRYPTION_CERTIFICATE_HASH_LIST(tvb,offset,pinfo,tree,di,drep,hf_efs_EfsRpcQueryRecoveryAgents_pRecoveryAgents,0);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_EfsRpcQueryRecoveryAgents_response(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nguint32 status;\r\ndi->dcerpc_procedure_name="EfsRpcQueryRecoveryAgents";\r\noffset = efs_dissect_element_EfsRpcQueryRecoveryAgents_pRecoveryAgents(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep, hf_efs_werror, &status);\r\nif (status != 0)\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ", Error: %s", val_to_str(status, WERR_errors, "Unknown DOS error 0x%08x"));\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_EfsRpcQueryRecoveryAgents_request(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\ndi->dcerpc_procedure_name="EfsRpcQueryRecoveryAgents";\r\noffset = efs_dissect_element_EfsRpcQueryRecoveryAgents_FileName(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EfsRpcRemoveUsersFromFile_FileName(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nchar *data;\r\noffset = dissect_ndr_cvstring(tvb, offset, pinfo, tree, di, drep, sizeof(guint16), hf_efs_EfsRpcRemoveUsersFromFile_FileName, FALSE, &data);\r\nproto_item_append_text(tree, ": %s", data);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_EfsRpcRemoveUsersFromFile_response(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nguint32 status;\r\ndi->dcerpc_procedure_name="EfsRpcRemoveUsersFromFile";\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep, hf_efs_werror, &status);\r\nif (status != 0)\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ", Error: %s", val_to_str(status, WERR_errors, "Unknown DOS error 0x%08x"));\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_EfsRpcRemoveUsersFromFile_request(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\ndi->dcerpc_procedure_name="EfsRpcRemoveUsersFromFile";\r\noffset = efs_dissect_element_EfsRpcRemoveUsersFromFile_FileName(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EfsRpcAddUsersToFile_FileName(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nchar *data;\r\noffset = dissect_ndr_cvstring(tvb, offset, pinfo, tree, di, drep, sizeof(guint16), hf_efs_EfsRpcAddUsersToFile_FileName, FALSE, &data);\r\nproto_item_append_text(tree, ": %s", data);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_EfsRpcAddUsersToFile_response(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nguint32 status;\r\ndi->dcerpc_procedure_name="EfsRpcAddUsersToFile";\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep, hf_efs_werror, &status);\r\nif (status != 0)\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ", Error: %s", val_to_str(status, WERR_errors, "Unknown DOS error 0x%08x"));\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_EfsRpcAddUsersToFile_request(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\ndi->dcerpc_procedure_name="EfsRpcAddUsersToFile";\r\noffset = efs_dissect_element_EfsRpcAddUsersToFile_FileName(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EfsRpcSetFileEncryptionKey_pEncryptionCertificate(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_toplevel_pointer(tvb, offset, pinfo, tree, di, drep, efs_dissect_element_EfsRpcSetFileEncryptionKey_pEncryptionCertificate_, NDR_POINTER_UNIQUE, "Pointer to Pencryptioncertificate (ENCRYPTION_CERTIFICATE)",hf_efs_EfsRpcSetFileEncryptionKey_pEncryptionCertificate);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_element_EfsRpcSetFileEncryptionKey_pEncryptionCertificate_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = efs_dissect_struct_ENCRYPTION_CERTIFICATE(tvb,offset,pinfo,tree,di,drep,hf_efs_EfsRpcSetFileEncryptionKey_pEncryptionCertificate,0);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_EfsRpcSetFileEncryptionKey_response(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nguint32 status;\r\ndi->dcerpc_procedure_name="EfsRpcSetFileEncryptionKey";\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep, hf_efs_werror, &status);\r\nif (status != 0)\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ", Error: %s", val_to_str(status, WERR_errors, "Unknown DOS error 0x%08x"));\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_EfsRpcSetFileEncryptionKey_request(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\ndi->dcerpc_procedure_name="EfsRpcSetFileEncryptionKey";\r\noffset = efs_dissect_element_EfsRpcSetFileEncryptionKey_pEncryptionCertificate(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_EfsRpcNotSupported_response(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nguint32 status;\r\ndi->dcerpc_procedure_name="EfsRpcNotSupported";\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep, hf_efs_werror, &status);\r\nif (status != 0)\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ", Error: %s", val_to_str(status, WERR_errors, "Unknown DOS error 0x%08x"));\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_EfsRpcNotSupported_request(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\ndi->dcerpc_procedure_name="EfsRpcNotSupported";\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_EfsRpcFileKeyInfo_response(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nguint32 status;\r\ndi->dcerpc_procedure_name="EfsRpcFileKeyInfo";\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep, hf_efs_werror, &status);\r\nif (status != 0)\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ", Error: %s", val_to_str(status, WERR_errors, "Unknown DOS error 0x%08x"));\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_EfsRpcFileKeyInfo_request(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\ndi->dcerpc_procedure_name="EfsRpcFileKeyInfo";\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_EfsRpcDuplicateEncryptionInfoFile_response(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nguint32 status;\r\ndi->dcerpc_procedure_name="EfsRpcDuplicateEncryptionInfoFile";\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep, hf_efs_werror, &status);\r\nif (status != 0)\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ", Error: %s", val_to_str(status, WERR_errors, "Unknown DOS error 0x%08x"));\r\nreturn offset;\r\n}\r\nstatic int\r\nefs_dissect_EfsRpcDuplicateEncryptionInfoFile_request(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\ndi->dcerpc_procedure_name="EfsRpcDuplicateEncryptionInfoFile";\r\nreturn offset;\r\n}\r\nvoid proto_register_dcerpc_efs(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_efs_EFS_CERTIFICATE_BLOB_cbData,\r\n{ "Cbdata", "efs.EFS_CERTIFICATE_BLOB.cbData", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_EFS_CERTIFICATE_BLOB_dwCertEncodingType,\r\n{ "Dwcertencodingtype", "efs.EFS_CERTIFICATE_BLOB.dwCertEncodingType", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_EFS_CERTIFICATE_BLOB_pbData,\r\n{ "Pbdata", "efs.EFS_CERTIFICATE_BLOB.pbData", FT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_EFS_HASH_BLOB_cbData,\r\n{ "Cbdata", "efs.EFS_HASH_BLOB.cbData", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_EFS_HASH_BLOB_pbData,\r\n{ "Pbdata", "efs.EFS_HASH_BLOB.pbData", FT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_ENCRYPTION_CERTIFICATE_HASH_LIST_nCert_Hash,\r\n{ "Ncert Hash", "efs.ENCRYPTION_CERTIFICATE_HASH_LIST.nCert_Hash", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_ENCRYPTION_CERTIFICATE_HASH_LIST_pUsers,\r\n{ "Pusers", "efs.ENCRYPTION_CERTIFICATE_HASH_LIST.pUsers", FT_NONE, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_ENCRYPTION_CERTIFICATE_HASH_cbTotalLength,\r\n{ "Cbtotallength", "efs.ENCRYPTION_CERTIFICATE_HASH.cbTotalLength", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_ENCRYPTION_CERTIFICATE_HASH_lpDisplayInformation,\r\n{ "Lpdisplayinformation", "efs.ENCRYPTION_CERTIFICATE_HASH.lpDisplayInformation", FT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_ENCRYPTION_CERTIFICATE_HASH_pHash,\r\n{ "Phash", "efs.ENCRYPTION_CERTIFICATE_HASH.pHash", FT_NONE, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_ENCRYPTION_CERTIFICATE_HASH_pUserSid,\r\n{ "Pusersid", "efs.ENCRYPTION_CERTIFICATE_HASH.pUserSid", FT_NONE, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_ENCRYPTION_CERTIFICATE_TotalLength,\r\n{ "Totallength", "efs.ENCRYPTION_CERTIFICATE.TotalLength", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_ENCRYPTION_CERTIFICATE_pCertBlob,\r\n{ "Pcertblob", "efs.ENCRYPTION_CERTIFICATE.pCertBlob", FT_NONE, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_ENCRYPTION_CERTIFICATE_pUserSid,\r\n{ "Pusersid", "efs.ENCRYPTION_CERTIFICATE.pUserSid", FT_NONE, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_EfsRpcAddUsersToFile_FileName,\r\n{ "Filename", "efs.EfsRpcAddUsersToFile.FileName", FT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_EfsRpcCloseRaw_pvContext,\r\n{ "Pvcontext", "efs.EfsRpcCloseRaw.pvContext", FT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_EfsRpcDecryptFileSrv_FileName,\r\n{ "Filename", "efs.EfsRpcDecryptFileSrv.FileName", FT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_EfsRpcDecryptFileSrv_Reserved,\r\n{ "Reserved", "efs.EfsRpcDecryptFileSrv.Reserved", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_EfsRpcEncryptFileSrv_Filename,\r\n{ "Filename", "efs.EfsRpcEncryptFileSrv.Filename", FT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_EfsRpcOpenFileRaw_FileName,\r\n{ "Filename", "efs.EfsRpcOpenFileRaw.FileName", FT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_EfsRpcOpenFileRaw_Flags,\r\n{ "Flags", "efs.EfsRpcOpenFileRaw.Flags", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_EfsRpcOpenFileRaw_pvContext,\r\n{ "Pvcontext", "efs.EfsRpcOpenFileRaw.pvContext", FT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_EfsRpcQueryRecoveryAgents_FileName,\r\n{ "Filename", "efs.EfsRpcQueryRecoveryAgents.FileName", FT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_EfsRpcQueryRecoveryAgents_pRecoveryAgents,\r\n{ "Precoveryagents", "efs.EfsRpcQueryRecoveryAgents.pRecoveryAgents", FT_NONE, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_EfsRpcQueryUsersOnFile_FileName,\r\n{ "Filename", "efs.EfsRpcQueryUsersOnFile.FileName", FT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_EfsRpcQueryUsersOnFile_pUsers,\r\n{ "Pusers", "efs.EfsRpcQueryUsersOnFile.pUsers", FT_NONE, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_EfsRpcReadFileRaw_pvContext,\r\n{ "Pvcontext", "efs.EfsRpcReadFileRaw.pvContext", FT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_EfsRpcRemoveUsersFromFile_FileName,\r\n{ "Filename", "efs.EfsRpcRemoveUsersFromFile.FileName", FT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_EfsRpcSetFileEncryptionKey_pEncryptionCertificate,\r\n{ "Pencryptioncertificate", "efs.EfsRpcSetFileEncryptionKey.pEncryptionCertificate", FT_NONE, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_EfsRpcWriteFileRaw_pvContext,\r\n{ "Pvcontext", "efs.EfsRpcWriteFileRaw.pvContext", FT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_opnum,\r\n{ "Operation", "efs.opnum", FT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_efs_werror,\r\n{ "Windows Error", "efs.werror", FT_UINT32, BASE_HEX, VALS(WERR_errors), 0, NULL, HFILL }},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_dcerpc_efs,\r\n&ett_efs_EFS_HASH_BLOB,\r\n&ett_efs_ENCRYPTION_CERTIFICATE_HASH,\r\n&ett_efs_ENCRYPTION_CERTIFICATE_HASH_LIST,\r\n&ett_efs_EFS_CERTIFICATE_BLOB,\r\n&ett_efs_ENCRYPTION_CERTIFICATE,\r\n};\r\nproto_dcerpc_efs = proto_register_protocol("EFS (pidl)", "EFS", "efs");\r\nproto_register_field_array(proto_dcerpc_efs, hf, array_length (hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid proto_reg_handoff_dcerpc_efs(void)\r\n{\r\ndcerpc_init_uuid(proto_dcerpc_efs, ett_dcerpc_efs,\r\n&uuid_dcerpc_efs, ver_dcerpc_efs,\r\nefs_dissectors, hf_efs_opnum);\r\n}
