static int\r\ndissect_hclnfsd_gids(tvbuff_t *tvb, int offset, packet_info *pinfo _U_, proto_tree *tree)\r\n{\r\nguint32 ngids, ngids_i;\r\nproto_tree *gidtree = NULL;\r\nproto_item *giditem = NULL;\r\nngids = tvb_get_ntohl(tvb, offset);\r\nif (tree)\r\n{\r\ngiditem = proto_tree_add_item(tree, hf_hclnfsd_gids, tvb, offset, 4, ENC_BIG_ENDIAN);\r\ngidtree = proto_item_add_subtree(giditem, ett_hclnfsd_gids);\r\n}\r\noffset += 4;\r\nif (gidtree)\r\n{\r\nfor (ngids_i = 0; ngids_i < ngids; ngids_i++)\r\n{\r\nproto_tree_add_item(gidtree, hf_hclnfsd_gid, tvb, offset + (4 * ngids_i), 4, ENC_BIG_ENDIAN);\r\n}\r\n}\r\noffset += 4 * ngids;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_hclnfsd_spool_inquire_call(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_uint32(tvb, tree, hf_hclnfsd_status, offset);\r\noffset = dissect_nfs3_fh(tvb, offset, pinfo, tree, "spool filehandle", NULL, (rpc_call_info_value*)data);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_hclnfsd_spool_file_call(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_string(tvb, tree, hf_hclnfsd_printername, offset, NULL);\r\noffset = dissect_rpc_string(tvb, tree, hf_hclnfsd_filename, offset, NULL);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_hclnfsd_fileext, offset);\r\nreturn offset;\r\n}\r\nstatic char *\r\nhclnfsd_decode_obscure(const char *ident, int ident_len)\r\n{\r\nchar *ident_decoded, *ident_out;\r\nint j, x, y;\r\nident_decoded = (char *)wmem_alloc(wmem_packet_scope(), ident_len);\r\nident_out = ident_decoded;\r\nfor (x = -1, j = 0; j < ident_len; j++)\r\n{\r\ny = *ident;\r\nx ^= *ident;\r\n*ident_out = x;\r\nx = y;\r\nident++;\r\nident_out++;\r\n}\r\nreturn ident_decoded;\r\n}\r\nstatic int\r\ndissect_hclnfsd_authorize_call(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nguint32 request_type;\r\nconst char *ident = NULL;\r\nchar *ident_decoded;\r\nchar *username = NULL;\r\nchar *password = NULL;\r\nint ident_len = 0;\r\nint newoffset;\r\nproto_item *ident_item = NULL;\r\nproto_tree *ident_tree = NULL;\r\nint offset = 0;\r\nproto_tree_add_item(tree, hf_hclnfsd_server_ip, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nrequest_type = tvb_get_ntohl(tvb, offset);\r\nproto_tree_add_uint(tree, hf_hclnfsd_request_type, tvb, offset,\r\n4, request_type);\r\noffset += 4;\r\noffset = dissect_rpc_string(tvb, tree, hf_hclnfsd_device, offset,\r\nNULL);\r\nident_tree = proto_tree_add_subtree(tree, tvb, offset, -1,\r\nett_hclnfsd_auth_ident, &ident_item, "Authentication Ident");\r\nif (ident_tree)\r\n{\r\nnewoffset = dissect_rpc_string(tvb, ident_tree,\r\nhf_hclnfsd_auth_ident_obscure, offset, &ident);\r\nif (ident)\r\n{\r\nident_len = (int)strlen(ident);\r\nproto_item_set_len(ident_item, ident_len);\r\nident_decoded = hclnfsd_decode_obscure(ident, ident_len);\r\nusername = ident_decoded + 2;\r\npassword = username + strlen(username) + 1;\r\nproto_tree_add_string(ident_tree, hf_hclnfsd_username, tvb, offset, ident_len, username);\r\nproto_tree_add_string(ident_tree, hf_hclnfsd_password, tvb, offset, ident_len, password);\r\noffset = newoffset;\r\n}\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_hclnfsd_authorize_reply(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nguint32 status;\r\nint offset = 0;\r\nstatus = tvb_get_ntohl(tvb, offset);\r\nif (!tree)\r\nreturn offset;\r\noffset += 4;\r\nif (status != 0)\r\nreturn offset;\r\nproto_tree_add_uint(tree, hf_hclnfsd_status, tvb, offset, 4, status);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_hclnfsd_uid, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_hclnfsd_gid, offset);\r\noffset = dissect_hclnfsd_gids(tvb, offset, pinfo, tree);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_hclnfsd_grp_name_to_numb_call(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nreturn dissect_rpc_string(tvb, tree, hf_hclnfsd_grpname, 0, NULL);\r\n}\r\nstatic int\r\ndissect_hclnfsd_grp_name_to_numb_reply(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nreturn dissect_rpc_uint32(tvb, tree, hf_hclnfsd_gid, 0);\r\n}\r\nstatic int\r\ndissect_hclnfsd_grp_to_number_call(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nreturn dissect_hclnfsd_gids(tvb, 0, pinfo, tree);\r\n}\r\nstatic int\r\ndissect_hclnfsd_grp_to_number_reply(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nreturn dissect_rpc_string(tvb, tree, hf_hclnfsd_grpname, 0, NULL);\r\n}\r\nstatic int\r\ndissect_hclnfsd_return_host_call(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\nproto_tree_add_item(tree, hf_hclnfsd_host_ip, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_hclnfsd_return_host_reply(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nreturn dissect_rpc_string(tvb, tree, hf_hclnfsd_hostname, 0, NULL);\r\n}\r\nstatic int\r\ndissect_hclnfsd_uid_to_name_call(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nguint32 nuids, nuids_i;\r\nproto_tree *uidtree = NULL;\r\nproto_item *uiditem = NULL;\r\nint offset = 0;\r\nnuids = tvb_get_ntohl(tvb, offset);\r\nif (tree)\r\n{\r\nuiditem = proto_tree_add_item(tree, hf_hclnfsd_uids, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nif (uiditem)\r\nuidtree = proto_item_add_subtree(uiditem, ett_hclnfsd_uids);\r\n}\r\noffset += 4;\r\nfor (nuids_i = 0; nuids_i < nuids; nuids_i++)\r\noffset = dissect_rpc_uint32(tvb, uidtree, hf_hclnfsd_uid, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_hclnfsd_uid_to_name_reply(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nguint32 nusers, nusers_i;\r\nproto_tree *usertree = NULL;\r\nproto_item *useritem = NULL;\r\nint offset = 0;\r\nnusers = tvb_get_ntohl(tvb, offset);\r\nif (tree)\r\n{\r\nuseritem = proto_tree_add_item(tree, hf_hclnfsd_uids, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nif (useritem)\r\nusertree = proto_item_add_subtree(useritem, ett_hclnfsd_usernames);\r\n}\r\noffset += 4;\r\nif (!usertree)\r\nreturn offset;\r\nfor (nusers_i = 0; nusers_i < nusers; nusers_i++)\r\noffset = dissect_rpc_string(tvb, usertree,\r\nhf_hclnfsd_username, offset, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_hclnfsd_name_to_uid_call(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nreturn dissect_rpc_string(tvb, tree, hf_hclnfsd_username, 0, NULL);\r\n}\r\nstatic int\r\ndissect_hclnfsd_name_to_uid_reply(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nreturn dissect_rpc_uint32(tvb, tree, hf_hclnfsd_uid, 0);\r\n}\r\nstatic int\r\ndissect_hclnfsd_share_call(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data)\r\n{\r\nguint32 request_type;\r\nint offset = 0;\r\nproto_tree_add_item_ret_uint(tree, hf_hclnfsd_request_type, tvb, offset,\r\n4, ENC_BIG_ENDIAN, &request_type);\r\noffset += 4;\r\noffset = dissect_rpc_uint32(tvb, tree, hf_hclnfsd_cookie, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_hclnfsd_lockname, offset, NULL);\r\noffset = dissect_nfs3_fh(tvb, offset, pinfo, tree, "Filehandle", NULL, (rpc_call_info_value*)data);\r\noffset = dissect_rpc_data(tvb, tree, hf_hclnfsd_unknown_data, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_hclnfsd_mode, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_hclnfsd_access, offset);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_hclnfsd_share_reply(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nguint32 request_type;\r\nint offset = 0;\r\nrequest_type = tvb_get_ntohl(tvb, offset);\r\nif (tree)\r\nproto_tree_add_uint(tree, hf_hclnfsd_request_type, tvb, offset,\r\n4, request_type);\r\noffset += 4;\r\noffset = dissect_rpc_uint32(tvb, tree, hf_hclnfsd_cookie, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_hclnfsd_status, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_hclnfsd_sequence, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_hclnfsd_unshare_call(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nreturn dissect_hclnfsd_share_call(tvb, pinfo, tree, data);\r\n}\r\nstatic int\r\ndissect_hclnfsd_unshare_reply(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nreturn dissect_hclnfsd_share_reply(tvb, pinfo, tree, data);\r\n}\r\nstatic int\r\ndissect_hclnfsd_lock_call(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_uint32(tvb, tree, hf_hclnfsd_status, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_hclnfsd_cookie, offset);\r\noffset += 4;\r\noffset = dissect_rpc_uint32(tvb, tree, hf_hclnfsd_exclusive, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_hclnfsd_lockname, offset, NULL);\r\noffset = dissect_nfs3_fh(tvb, offset, pinfo, tree, "Filehandle", NULL, (rpc_call_info_value*)data);\r\noffset = dissect_rpc_data(tvb, tree, hf_hclnfsd_lockowner, offset);\r\noffset += 4;\r\noffset = dissect_rpc_uint32(tvb, tree, hf_hclnfsd_offset, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_hclnfsd_length, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_hclnfsd_lock_reply(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nguint32 request_type;\r\nint offset = 0;\r\nproto_tree_add_item_ret_uint(tree, hf_hclnfsd_request_type, tvb, offset,\r\n4, ENC_BIG_ENDIAN, &request_type);\r\noffset += 4;\r\noffset = dissect_rpc_uint32(tvb, tree, hf_hclnfsd_cookie, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_hclnfsd_status, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_hclnfsd_remove_call(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_string(tvb, tree, hf_hclnfsd_lockname, offset, NULL);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_hclnfsd_unlock_call(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data)\r\n{\r\nint offset = 0;\r\noffset += 4;\r\noffset = dissect_rpc_uint32(tvb, tree, hf_hclnfsd_cookie, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_hclnfsd_lockname, offset, NULL);\r\noffset = dissect_nfs3_fh(tvb, offset, pinfo, tree, "Filehandle", NULL, (rpc_call_info_value*)data);\r\noffset = dissect_rpc_data(tvb, tree, hf_hclnfsd_unknown_data, offset);\r\noffset += 4;\r\noffset = dissect_rpc_uint32(tvb, tree, hf_hclnfsd_offset, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_hclnfsd_length, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_hclnfsd_unlock_reply(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nreturn dissect_hclnfsd_lock_reply(tvb, pinfo, tree, data);\r\n}\r\nstatic int\r\ndissect_hclnfsd_get_printers_reply(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nguint nqueues, nqueues_i;\r\nproto_item *queuesitem = NULL;\r\nproto_tree *queuestree = NULL;\r\nint offset = 0;\r\nnqueues = tvb_get_ntohl(tvb, offset);\r\nif (tree)\r\n{\r\nqueuesitem = proto_tree_add_item(tree, hf_hclnfsd_print_queues, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nqueuestree = proto_item_add_subtree(queuesitem, ett_hclnfsd_printqueues);\r\n}\r\noffset += 4;\r\nif (!queuestree)\r\nreturn offset;\r\nfor (nqueues_i = 0; nqueues_i < nqueues; nqueues_i++)\r\n{\r\noffset = dissect_rpc_string(tvb, tree,\r\nhf_hclnfsd_queuename, offset, NULL);\r\noffset = dissect_rpc_string(tvb, tree,\r\nhf_hclnfsd_queuecomment, offset, NULL);\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_hclnfsd_get_printq_call(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_string(tvb, tree, hf_hclnfsd_queuename, offset, NULL);\r\noffset = dissect_rpc_string(tvb, tree, hf_hclnfsd_username, offset, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_hclnfsd_get_printq_reply(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nguint datafollows;\r\nproto_item *queueitem = NULL;\r\nproto_tree *queuetree = NULL;\r\nproto_item *jobitem;\r\nproto_tree *jobtree;\r\nint offset = 0;\r\noffset = dissect_rpc_uint32(tvb, tree, hf_hclnfsd_printqueuenumber, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_hclnfsd_queuecomment, offset, NULL);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_hclnfsd_queuestatus, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_hclnfsd_numphysicalprinters, offset);\r\ndatafollows = tvb_get_ntohl(tvb, offset);\r\nif (tree)\r\n{\r\nqueueitem = proto_tree_add_item(tree, hf_hclnfsd_print_jobs, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nqueuetree = proto_item_add_subtree(queueitem, ett_hclnfsd_printqueues);\r\n}\r\noffset += 4;\r\nwhile (datafollows)\r\n{\r\njobitem = proto_tree_add_item(queuetree, hf_hclnfsd_job_id, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\njobtree = proto_item_add_subtree(jobitem, ett_hclnfsd_printjob);\r\noffset = dissect_rpc_string(tvb, jobtree,\r\nhf_hclnfsd_username, offset, NULL);\r\noffset = dissect_rpc_string(tvb, jobtree,\r\nhf_hclnfsd_printparams, offset, NULL);\r\noffset = dissect_rpc_uint32(tvb, jobtree, hf_hclnfsd_queuestatus, offset);\r\noffset = dissect_rpc_uint32(tvb, jobtree, hf_hclnfsd_jobstatus, offset);\r\noffset = dissect_rpc_uint32(tvb, jobtree, hf_hclnfsd_timesubmitted, offset);\r\noffset = dissect_rpc_uint32(tvb, jobtree, hf_hclnfsd_size, offset);\r\noffset = dissect_rpc_uint32(tvb, jobtree, hf_hclnfsd_copies, offset);\r\noffset = dissect_rpc_string(tvb, jobtree, hf_hclnfsd_queuecomment, offset, NULL);\r\ndatafollows = tvb_get_ntohl(tvb, offset);\r\noffset += 4;\r\n}\r\nreturn offset;\r\n}\r\nvoid\r\nproto_register_hclnfsd(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_hclnfsd_procedure_v1, {\r\n"V1 Procedure", "hclnfsd.procedure_v1", FT_UINT32, BASE_DEC,\r\nVALS(hclnfsd1_proc_vals), 0, NULL, HFILL }},\r\n{ &hf_hclnfsd_request_type, {\r\n"Request Type", "hclnfsd.request_type", FT_UINT32, BASE_DEC,\r\nVALS(names_request_type), 0, NULL, HFILL }},\r\n{ &hf_hclnfsd_device, {\r\n"Device", "hclnfsd.device", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n#if 0\r\n{ &hf_hclnfsd_login, {\r\n"Login Text", "hclnfsd.logintext", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n#endif\r\n{ &hf_hclnfsd_lockname, {\r\n"Lockname", "hclnfsd.lockname", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_hclnfsd_unknown_data, {\r\n"Unknown", "hclnfsd.unknown_data", FT_BYTES, BASE_NONE,\r\nNULL, 0, "Data", HFILL }},\r\n{ &hf_hclnfsd_lockowner, {\r\n"Lockowner", "hclnfsd.lockowner", FT_BYTES, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_hclnfsd_printername, {\r\n"Printer Name", "hclnfsd.printername", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_hclnfsd_filename, {\r\n"Filename", "hclnfsd.filename", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_hclnfsd_fileext, {\r\n"File Extension", "hclnfsd.fileext", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_hclnfsd_grpname, {\r\n"Group", "hclnfsd.group", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_hclnfsd_hostname, {\r\n"Hostname", "hclnfsd.hostname", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_hclnfsd_username, {\r\n"Username", "hclnfsd.username", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_hclnfsd_queuename, {\r\n"Name", "hclnfsd.printqueuename", FT_STRING, BASE_NONE,\r\nNULL, 0, "Print Queue Name", HFILL }},\r\n{ &hf_hclnfsd_queuecomment, {\r\n"Comment", "hclnfsd.printqueuecomment", FT_STRING, BASE_NONE,\r\nNULL, 0, "Print Queue Comment", HFILL }},\r\n{ &hf_hclnfsd_printparams, {\r\n"Print Parameters", "hclnfsd.printparameters", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_hclnfsd_status, {\r\n"Status", "hclnfsd.status", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_hclnfsd_uid, {\r\n"UID", "hclnfsd.uid", FT_UINT32, BASE_DEC,\r\nNULL, 0, "User ID", HFILL }},\r\n{ &hf_hclnfsd_sequence, {\r\n"Sequence", "hclnfsd.sequence", FT_UINT32, BASE_HEX,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_hclnfsd_cookie, {\r\n"Cookie", "hclnfsd.cookie", FT_UINT32, BASE_HEX,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_hclnfsd_mode, {\r\n"Mode", "hclnfsd.mode", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_hclnfsd_access, {\r\n"Access", "hclnfsd.access", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_hclnfsd_exclusive, {\r\n"Exclusive", "hclnfsd.exclusive", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_hclnfsd_offset, {\r\n"Offset", "hclnfsd.offset", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_hclnfsd_length, {\r\n"Length", "hclnfsd.length", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_hclnfsd_queuestatus, {\r\n"Queue Status", "hclnfsd.queuestatus", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_hclnfsd_printqueuenumber, {\r\n"Print Queue Number", "hclnfsd.pqn", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_hclnfsd_numphysicalprinters, {\r\n"Number of Physical Printers", "hclnfsd.npp", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_hclnfsd_jobstatus, {\r\n"Job Status", "hclnfsd.jobstatus", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_hclnfsd_timesubmitted, {\r\n"Time Submitted", "hclnfsd.timesubmitted", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_hclnfsd_size, {\r\n"Size", "hclnfsd.size", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_hclnfsd_copies, {\r\n"Copies", "hclnfsd.copies", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_hclnfsd_gid, {\r\n"GID", "hclnfsd.gid", FT_UINT32, BASE_DEC,\r\nNULL, 0, "Group ID", HFILL }},\r\n{ &hf_hclnfsd_server_ip, {\r\n"Server IP", "hclnfsd.server_ip", FT_IPv4, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_hclnfsd_host_ip, {\r\n"Host IP", "hclnfsd.host_ip", FT_IPv4, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_hclnfsd_auth_ident_obscure, {\r\n"Obscure Ident", "hclnfsd.authorize.ident.obscure", FT_STRING,\r\nBASE_NONE , NULL, 0, "Authentication Obscure Ident", HFILL }},\r\n{ &hf_hclnfsd_gids,\r\n{ "GIDs", "hclnfsd.gids",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_hclnfsd_password,\r\n{ "Password", "hclnfsd.password",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_hclnfsd_uids,\r\n{ "UIDs", "hclnfsd.uids",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_hclnfsd_print_queues,\r\n{ "Print Queues", "hclnfsd.print_queues",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_hclnfsd_print_jobs,\r\n{ "Print Jobs", "hclnfsd.print_jobs",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_hclnfsd_job_id,\r\n{ "Job ID", "hclnfsd.job_id",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_hclnfsd,\r\n&ett_hclnfsd_gids,\r\n&ett_hclnfsd_groups,\r\n&ett_hclnfsd_uids,\r\n&ett_hclnfsd_usernames,\r\n&ett_hclnfsd_printqueues,\r\n&ett_hclnfsd_printjob,\r\n&ett_hclnfsd_auth_ident\r\n};\r\nproto_hclnfsd = proto_register_protocol("Hummingbird NFS Daemon",\r\n"HCLNFSD", "hclnfsd");\r\nproto_register_field_array(proto_hclnfsd, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid\r\nproto_reg_handoff_hclnfsd(void)\r\n{\r\nrpc_init_prog(proto_hclnfsd, HCLNFSD_PROGRAM, ett_hclnfsd,\r\nG_N_ELEMENTS(hclnfsd_vers_info), hclnfsd_vers_info);\r\n}
