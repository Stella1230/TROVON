static void\r\nseg3a_latitude_fmt(gchar *s, guint32 v)\r\n{\r\ngint32 sv = (gint32)v;\r\nchar c;\r\nif (sv < 0) {\r\nc = 'S';\r\nsv = -sv;\r\n} else\r\nc = 'N';\r\ng_snprintf(s, ITEM_LABEL_LENGTH, "%.1f %c (%d)", sv / 10.0f, c, sv);\r\n}\r\nstatic void\r\nseg3a_longitude_fmt(gchar *s, guint32 v)\r\n{\r\ngint32 sv;\r\nchar c;\r\nif (v < 1800) {\r\nc = 'W';\r\nsv = v;\r\n} else {\r\nc = 'E';\r\nsv = 3600 - v;\r\n}\r\ng_snprintf(s, ITEM_LABEL_LENGTH, "%.1f %c (%u)", sv / 10.0f, c, v);\r\n}\r\nstatic void\r\nseg3a_satpos_radius_fmt(gchar *s, guint32 v)\r\n{\r\ngint32 sv = (gint32)v;\r\ngint32 a = (42162 * 1000) + (sv * 5);\r\ng_snprintf(s, ITEM_LABEL_LENGTH, "%.3lf km (%u)", a / 1000.0, sv);\r\n}\r\nstatic void\r\nseg3a_miscinfo_sb_reselection_timer_fmt(gchar *s, guint32 v)\r\n{\r\ng_snprintf(s, ITEM_LABEL_LENGTH, "%d minutes (%u)", v*4, v);\r\n}\r\nstatic int\r\ndissect_gmr1_bcch(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* dissector_data _U_)\r\n{\r\nproto_item *bcch_item = NULL;\r\nproto_tree *bcch_tree = NULL;\r\ncsnStream_t ar;\r\ngboolean is_si1;\r\ncol_append_str(pinfo->cinfo, COL_INFO, "(BCCH) ");\r\nis_si1 = tvb_get_bits8(tvb, 0, 5) & 1;\r\nbcch_item = proto_tree_add_protocol_format(\r\ntree, proto_gmr1_bcch, tvb, 0, -1,\r\n"GMR-1 BCCH - System Information type %d", is_si1 ? 1 : 2\r\n);\r\nbcch_tree = proto_item_add_subtree(bcch_item, ett_gmr1_bcch);\r\ncsnStreamInit(&ar, 0, tvb_captured_length(tvb)*8, pinfo);\r\nif (is_si1) {\r\nSystemInformation1_t *data;\r\ndata = wmem_new(wmem_packet_scope(), SystemInformation1_t);\r\ndata->SegmentType = array_length(SI1_SegmentChoice) - 1;\r\ncsnStreamDissector(bcch_tree, &ar, CSNDESCR(SystemInformation1_t), tvb, data, ett_gmr1_bcch);\r\ncol_append_fstr(\r\npinfo->cinfo, COL_INFO,\r\n"System Information 1: Segment 1A, %s",\r\nSI1_SegmentChoice[data->SegmentType].descr.sz\r\n);\r\n} else {\r\nSystemInformation2_t *data;\r\ndata = wmem_new(wmem_packet_scope(), SystemInformation2_t);\r\ndata->SegmentType = array_length(SI2_SegmentChoice) - 1;\r\ncsnStreamDissector(bcch_tree, &ar, CSNDESCR(SystemInformation2_t), tvb, data, ett_gmr1_bcch);\r\ncol_append_fstr(\r\npinfo->cinfo, COL_INFO,\r\n"System Information 2: %s",\r\nSI2_SegmentChoice[data->SegmentType].descr.sz\r\n);\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_gmr1_bcch(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_seg1a_class_2_version,\r\n{ "Class 2 version", "gmr1.bcch.seg1a.class_2_version",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\n"Version number for current Class 2 information", HFILL }\r\n},\r\n{ &hf_seg1a_class_3_version,\r\n{ "Class 3 version", "gmr1.bcch.seg1a.class_3_version",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\n"Version number for current Class 3 information", HFILL }\r\n},\r\n{ &hf_seg1a_syncinfo_sb_frame_ts_offset,\r\n{ "SB_FRAME_TS_OFFSET", "gmr1.bcch.seg1a.syncinfo.sb_frame_ts_offset",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg1a_syncinfo_sb_symbol_offset,\r\n{ "SB_SYMBOL_OFFSET", "gmr1.bcch.seg1a.syncinfo.sb_symbol_offset",\r\nFT_INT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg1a_syncinfo_sa_freq_offset,\r\n{ "SA_FREQ_OFFSET", "gmr1.bcch.seg1a.syncinfo.sa_freq_offset",\r\nFT_UINT8, BASE_CUSTOM, CF_FUNC(seg1a_syncinfo_sa_freq_offset_fmt), 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg1a_rachctrl_max_retrans,\r\n{ "Max Retrans", "gmr1.bcch.seg1a.rachctrl.max_retrans",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg1a_rachctrl_acc[15],\r\n{ "AC15", "gmr1.bcch.seg1a.rachctrl.ac15",\r\nFT_UINT8, BASE_DEC, VALS(seg1a_rachctrl_acc_vals), 0x00,\r\n"Access Class 15 barred", HFILL }\r\n},\r\n{ &hf_seg1a_rachctrl_acc[14],\r\n{ "AC14", "gmr1.bcch.seg1a.rachctrl.ac14",\r\nFT_UINT8, BASE_DEC, VALS(seg1a_rachctrl_acc_vals), 0x00,\r\n"Access Class 14 barred", HFILL }\r\n},\r\n{ &hf_seg1a_rachctrl_acc[13],\r\n{ "AC13", "gmr1.bcch.seg1a.rachctrl.ac13",\r\nFT_UINT8, BASE_DEC, VALS(seg1a_rachctrl_acc_vals), 0x00,\r\n"Access Class 13 barred", HFILL }\r\n},\r\n{ &hf_seg1a_rachctrl_acc[12],\r\n{ "AC12", "gmr1.bcch.seg1a.rachctrl.ac12",\r\nFT_UINT8, BASE_DEC, VALS(seg1a_rachctrl_acc_vals), 0x00,\r\n"Access Class 12 barred", HFILL }\r\n},\r\n{ &hf_seg1a_rachctrl_acc[11],\r\n{ "AC11", "gmr1.bcch.seg1a.rachctrl.ac11",\r\nFT_UINT8, BASE_DEC, VALS(seg1a_rachctrl_acc_vals), 0x00,\r\n"Access Class 11 barred", HFILL }\r\n},\r\n{ &hf_seg1a_rachctrl_acc[10],\r\n{ "EC10", "gmr1.bcch.seg1a.rachctrl.ac10",\r\nFT_UINT8, BASE_DEC, VALS(seg1a_rachctrl_acc_vals), 0x00,\r\n"Emergency Class 10 barred", HFILL }\r\n},\r\n{ &hf_seg1a_rachctrl_acc[9],\r\n{ "AC9", "gmr1.bcch.seg1a.rachctrl.ac9",\r\nFT_UINT8, BASE_DEC, VALS(seg1a_rachctrl_acc_vals), 0x00,\r\n"Access Class 9 barred", HFILL }\r\n},\r\n{ &hf_seg1a_rachctrl_acc[8],\r\n{ "AC8", "gmr1.bcch.seg1a.rachctrl.ac8",\r\nFT_UINT8, BASE_DEC, VALS(seg1a_rachctrl_acc_vals), 0x00,\r\n"Access Class 8 barred", HFILL }\r\n},\r\n{ &hf_seg1a_rachctrl_acc[7],\r\n{ "AC7", "gmr1.bcch.seg1a.rachctrl.ac7",\r\nFT_UINT8, BASE_DEC, VALS(seg1a_rachctrl_acc_vals), 0x00,\r\n"Access Class 7 barred", HFILL }\r\n},\r\n{ &hf_seg1a_rachctrl_acc[6],\r\n{ "AC6", "gmr1.bcch.seg1a.rachctrl.ac6",\r\nFT_UINT8, BASE_DEC, VALS(seg1a_rachctrl_acc_vals), 0x00,\r\n"Access Class 6 barred", HFILL }\r\n},\r\n{ &hf_seg1a_rachctrl_acc[5],\r\n{ "AC5", "gmr1.bcch.seg1a.rachctrl.ac5",\r\nFT_UINT8, BASE_DEC, VALS(seg1a_rachctrl_acc_vals), 0x00,\r\n"Access Class 5 barred", HFILL }\r\n},\r\n{ &hf_seg1a_rachctrl_acc[4],\r\n{ "AC4", "gmr1.bcch.seg1a.rachctrl.ac4",\r\nFT_UINT8, BASE_DEC, VALS(seg1a_rachctrl_acc_vals), 0x00,\r\n"Access Class 4 barred", HFILL }\r\n},\r\n{ &hf_seg1a_rachctrl_acc[3],\r\n{ "AC3", "gmr1.bcch.seg1a.rachctrl.ac3",\r\nFT_UINT8, BASE_DEC, VALS(seg1a_rachctrl_acc_vals), 0x00,\r\n"Access Class 3 barred", HFILL }\r\n},\r\n{ &hf_seg1a_rachctrl_acc[2],\r\n{ "AC2", "gmr1.bcch.seg1a.rachctrl.ac2",\r\nFT_UINT8, BASE_DEC, VALS(seg1a_rachctrl_acc_vals), 0x00,\r\n"Access Class 2 barred", HFILL }\r\n},\r\n{ &hf_seg1a_rachctrl_acc[1],\r\n{ "AC1", "gmr1.bcch.seg1a.rachctrl.ac1",\r\nFT_UINT8, BASE_DEC, VALS(seg1a_rachctrl_acc_vals), 0x00,\r\n"Access Class 1 barred", HFILL }\r\n},\r\n{ &hf_seg1a_rachctrl_acc[0],\r\n{ "AC0", "gmr1.bcch.seg1a.rachctrl.ac0",\r\nFT_UINT8, BASE_DEC, VALS(seg1a_rachctrl_acc_vals), 0x00,\r\n"Access Class 0 barred", HFILL }\r\n},\r\n{ &hf_seg1a_rachctrl_cell_bar_access,\r\n{ "CELL_BAR_ACCESS", "gmr1.bcch.seg1a.rachctrl.cell_bar_access",\r\nFT_UINT8, BASE_DEC, VALS(seg1a_rachctrl_cell_bar_access_vals), 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg1a_miscinfo_sb_reselection_hysteresis,\r\n{ "SB_RESELECTION_HYSTERESIS", "gmr1.bcch.seg1a.miscinfo.sb_reselection_hysteresis",\r\nFT_UINT8, BASE_CUSTOM, CF_FUNC(segx_half_db_value_fmt), 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg1a_miscinfo_spare,\r\n{ "Spare", "gmr1.bcch.seg1a.miscinfo.spare",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg1a_miscinfo_priority_access_ind,\r\n{ "Priority Access Ind", "gmr1.bcch.seg1a.miscinfo.priority_access_ind",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\n"Reserved for future use", HFILL }\r\n},\r\n{ &hf_seg1a_gbch_present,\r\n{ "GBCH Present", "gmr1.bcch.seg1a.gbch_present",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg1a_test_gs,\r\n{ "Test GS", "gmr1.bcch.seg1a.test_gs",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg1a_test_gs2,\r\n{ "Test GS2", "gmr1.bcch.seg1a.test_gs2",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg1a_spare1,\r\n{ "Spare", "gmr1.bcch.seg1a.spare1",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg1a_cell_bar_access_extension2,\r\n{ "CELL_BAR_ACCESS_EXTENSION2", "gmr1.bcch.seg1a.cell_bar_access_extension2",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg1a_spare2,\r\n{ "Spare", "gmr1.bcch.seg1a.spare2",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg1a_cell_bar_access_extension,\r\n{ "CELL_BAR_ACCESS_EXTENSION", "gmr1.bcch.seg1a.cell_bar_access_extension",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg2a_class_4_version,\r\n{ "Class 4 version", "gmr1.bcch.seg2a.class_4_version",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\n"Version number for current Class 4 information", HFILL }\r\n},\r\n{ &hf_seg2a_syncinfo_sa_sirfn_delay,\r\n{ "SA_SIRFN_DELAY", "gmr1.bcch.seg2a.syncinfo.sa_sirfn_delay",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\n"Delay of system information relative to superframe", HFILL }\r\n},\r\n{ &hf_seg2a_syncinfo_sa_bcch_stn,\r\n{ "SA_BCCH_STN", "gmr1.bcch.seg2a.syncinfo.sa_bcch_stn",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\n"Starting timeslot number", HFILL }\r\n},\r\n{ &hf_seg2a_syncinfo_superframe_num,\r\n{ "Superframe Number", "gmr1.bcch.seg2a.syncinfo.superframe_num",\r\nFT_UINT16, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg2a_syncinfo_multiframe_num,\r\n{ "Multiframe Number", "gmr1.bcch.seg2a.syncinfo.multiframe_num",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\n"Multiframe number in a superframe", HFILL }\r\n},\r\n{ &hf_seg2a_syncinfo_mffn_high_bit,\r\n{ "MFFN high bit", "gmr1.bcch.seg2a.syncinfo.mffn_high_bit",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\n"High bit of the TDMA FN in a multiframe", HFILL }\r\n},\r\n{ &hf_seg2a_selcrit_rxlev_select_min,\r\n{ "RXLEV_SELECT_MIN", "gmr1.bcch.seg2a.selcrit.rxlev_select_min",\r\nFT_UINT8, BASE_CUSTOM, CF_FUNC(segx_half_db_value_fmt), 0x00,\r\n"Adjustment to threshold to camp-on system", HFILL }\r\n},\r\n{ &hf_seg2a_miscinfo_sb_selection_power,\r\n{ "SB_SELECTION_POWER", "gmr1.bcch.seg2a.miscinfo.sb_selection_power",\r\nFT_UINT8, BASE_CUSTOM, CF_FUNC(segx_half_db_value_fmt), 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg2a_lainfo_sa_pch_config,\r\n{ "SA_PCH_CONFIG", "gmr1.bcch.seg2a.lainfo.sa_pch_config",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\n"Paging group configuration information", HFILL }\r\n},\r\n{ &hf_seg2a_lainfo_sa_bach_config,\r\n{ "SA_BACH_CONFIG", "gmr1.bcch.seg2a.lainfo.sa_bach_config",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\n"Alerting group configuration information", HFILL }\r\n},\r\n{ &hf_seg2a_lainfo_rach_ts_offset,\r\n{ "RACH_TS_OFFSET", "gmr1.bcch.seg2a.lainfo.rach_ts_offset",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\n"Start of RACH window with respect to BCCH", HFILL }\r\n},\r\n{ &hf_seg2a_lainfo_n_page_occurrences,\r\n{ "N Page Occurrences", "gmr1.bcch.seg2a.lainfo.n_page_occurrences",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\n"Number of times a page shall be retransmitted after the initial transmission", HFILL }\r\n},\r\n{ &hf_seg2a_lainfo_imsi_attach_detach_ind,\r\n{ "IMSI attach-detach ind", "gmr1.bcch.seg2a.lainfo.imsi_attach_detach_ind",\r\nFT_UINT8, BASE_DEC, VALS(seg2a_lainfo_imsi_attach_detach_ind_vals), 0x00,\r\n"Should MESs apply IMSI attach and detach procedure for this LA", HFILL }\r\n},\r\n{ &hf_seg2a_lainfo_ecsc_indication,\r\n{ "ECSC indication", "gmr1.bcch.seg2a.lainfo.ecsc_indication",\r\nFT_UINT8, BASE_DEC, VALS(seg2a_lainfo_ecsc_indication_vals), 0x00,\r\n"Early Classmark Sending Control", HFILL }\r\n},\r\n{ &hf_seg2a_lainfo_si_update_ind,\r\n{ "SI update ind", "gmr1.bcch.seg2a.lainfo.si_update_ind",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\n"Flag for BACH reorganization. Value changes after each reorganization", HFILL }\r\n},\r\n{ &hf_seg2a_class_type,\r\n{ "Class type: 2", "gmr1.bcch.seg2a.class_type",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg2a_segment_type_a,\r\n{ "Segment type: A", "gmr1.bcch.seg2a.segment_type_a",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg2a_segment_type_abis,\r\n{ "Segment type: Abis", "gmr1.bcch.seg2a.segment_type_abis",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg2b_segment_type_b,\r\n{ "Segment type: B", "gmr1.bcch.seg2b.segment_type_b",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg2b_segment_type_bbis,\r\n{ "Segment type: B bis", "gmr1.bcch.seg2b.segment_type_bbis",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3a_class_type,\r\n{ "Class type: 3", "gmr1.bcch.seg3a.class_type",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3a_segment_type_a,\r\n{ "Segment type: A", "gmr1.bcch.seg3a.segment_type_a",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3a_lai_dissector,\r\n{ "LAI Dissector length", "gmr1.bcch.seg3a.lai_dissector",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3a_lai_mcc,\r\n{ "Mobile Country Code (MCC)", "gmr1.bcch.seg3a.lai.mcc",\r\nFT_UINT16, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3a_lai_mnc,\r\n{ "Mobile Network Code (MNC)", "gmr1.bcch.seg3a.lai.mnc",\r\nFT_UINT16, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3a_lai_lac,\r\n{ "Location Area Code (LAC)", "gmr1.bcch.seg3a.lai.lac",\r\nFT_UINT16, BASE_HEX, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3a_lai_msc_id,\r\n{ "MSC ID", "gmr1.bcch.seg3a.lai.msc_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3a_lai_spot_beam_id,\r\n{ "Spot Beam ID", "gmr1.bcch.seg3a.lai.spot_beam_id",\r\nFT_UINT16, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3a_system_sat_id,\r\n{ "Satellite ID", "gmr1.bcch.seg3a.system.sat_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3a_system_sys_id,\r\n{ "System ID", "gmr1.bcch.seg3a.system.sys_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3a_satpos_latitude,\r\n{ "Latitude", "gmr1.bcch.seg3a.satpos.latitude",\r\nFT_INT8, BASE_CUSTOM, CF_FUNC(seg3a_latitude_fmt), 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3a_satpos_longitude,\r\n{ "Longitude", "gmr1.bcch.seg3a.satpos.longitude",\r\nFT_UINT16, BASE_CUSTOM, CF_FUNC(seg3a_longitude_fmt), 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3a_satpos_radius,\r\n{ "Radius", "gmr1.bcch.seg3a.satpos.radius",\r\nFT_INT16, BASE_CUSTOM, CF_FUNC(seg3a_satpos_radius_fmt), 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3a_beam_latitude,\r\n{ "Latitude", "gmr1.bcch.seg3a.beam.latitude",\r\nFT_INT16, BASE_CUSTOM, CF_FUNC(seg3a_latitude_fmt), 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3a_beam_longitude,\r\n{ "Longitude", "gmr1.bcch.seg3a.beam.longitude",\r\nFT_UINT16, BASE_CUSTOM, CF_FUNC(seg3a_longitude_fmt), 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3a_miscinfo_sb_reselection_timer,\r\n{ "SB_RESELECTION_TIMER", "gmr1.bcch.seg3a.sb_reselection_timer",\r\nFT_UINT8, BASE_CUSTOM, CF_FUNC(seg3a_miscinfo_sb_reselection_timer_fmt), 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3a_spare,\r\n{ "Spare", "gmr1.bcch.seg3a.spare",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3b_segment_type_b,\r\n{ "Segment type: B", "gmr1.bcch.seg3b.segment_type_b",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3b_segment_type_bbis,\r\n{ "Segment type: B bis", "gmr1.bcch.seg3b.segment_type_bbis",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3c_segment_type_c,\r\n{ "Segment type: C", "gmr1.bcch.seg3c.segment_type_c",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3d_segment_type_d,\r\n{ "Segment type: D", "gmr1.bcch.seg3d.segment_type_d",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3e_segment_type_e,\r\n{ "Segment type: E", "gmr1.bcch.seg3e.segment_type_e",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3e_segment_type_ebis,\r\n{ "Segment type: E bis", "gmr1.bcch.seg3e.segment_type_ebis",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3f_segment_type_f,\r\n{ "Segment type: F", "gmr1.bcch.seg3f.segment_type_f",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3g_segment_type_g,\r\n{ "Segment type: G", "gmr1.bcch.seg3g.segment_type_g",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3g_segment_type_gbis,\r\n{ "Segment type: G bis", "gmr1.bcch.seg3g.segment_type_gbis",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3h_segment_type_h,\r\n{ "Segment type: H", "gmr1.bcch.seg3h.segment_type_h",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3i_segment_type_i,\r\n{ "Segment type: I", "gmr1.bcch.seg3i.segment_type_i",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3j_segment_type_j,\r\n{ "Segment type: J", "gmr1.bcch.seg3j.segment_type_j",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3j_segment_type_jbis,\r\n{ "Segment type: J bis", "gmr1.bcch.seg3j.segment_type_jbis",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg3k_segment_type_kbis,\r\n{ "Segment type: K bis", "gmr1.bcch.seg3k.segment_type_kbis",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg4a_class_type,\r\n{ "Class type: 4", "gmr1.bcch.seg4a.class_type",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg4a_segment_type_a,\r\n{ "Segment type: A", "gmr1.bcch.seg3a.segment_type_a",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg4b_segment_type_b,\r\n{ "Segment type: B", "gmr1.bcch.seg3b.segment_type_b",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg4c_segment_type_c,\r\n{ "Segment type: C", "gmr1.bcch.seg3c.segment_type_c",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg4d_segment_type_d,\r\n{ "Segment type: D", "gmr1.bcch.seg3d.segment_type_d",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg4e_segment_type_e,\r\n{ "Segment type: E", "gmr1.bcch.seg3e.segment_type_e",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg4f_segment_type_f,\r\n{ "Segment type: F", "gmr1.bcch.seg3f.segment_type_f",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg4g_segment_type_g,\r\n{ "Segment type: G", "gmr1.bcch.seg3g.segment_type_g",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg4h_segment_type_h,\r\n{ "Segment type: H", "gmr1.bcch.seg3h.segment_type_h",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg4i_segment_type_i,\r\n{ "Segment type: I", "gmr1.bcch.seg3i.segment_type_i",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg4j_segment_type_j,\r\n{ "Segment type: J", "gmr1.bcch.seg3j.segment_type_j",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_seg4k_segment_type_k,\r\n{ "Segment type: K", "gmr1.bcch.seg3k.segment_type_k",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_si1_segment_choice,\r\n{ "Segment Choice", "gmr1.bcch.si.segment_choice",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_si_protocol_version,\r\n{ "Protocol version", "gmr1.bcch.si.protocol_version",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_si_block_type,\r\n{ "Block Type", "gmr1.bcch.si.block_type",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_si_spare,\r\n{ "Spare", "gmr1.bcch.si.spare",\r\nFT_UINT8, BASE_DEC, NULL, 0x00,\r\nNULL, HFILL }\r\n},\r\n{ &hf_si1_randomization_period,\r\n{ "Randomization Period", "gmr1.bcch.si.randomization_period",\r\nFT_UINT8, BASE_DEC, VALS(si1_randomization_period_vals), 0x00,\r\nNULL, HFILL }\r\n},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_gmr1_bcch,\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_unknown_segment, { "gmr1.bcch.unknown_segment", PI_PROTOCOL, PI_WARN, "Unknown segment!", EXPFILL }},\r\n};\r\nexpert_module_t* expert_gmr1_bcch;\r\nproto_gmr1_bcch = proto_register_protocol("GEO-Mobile Radio (1) BCCH", "GMR-1 BCCH", "gmr1.bcch");\r\nproto_register_field_array(proto_gmr1_bcch, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_gmr1_bcch = expert_register_protocol(proto_gmr1_bcch);\r\nexpert_register_field_array(expert_gmr1_bcch, ei, array_length(ei));\r\nregister_dissector("gmr1_bcch", dissect_gmr1_bcch, proto_gmr1_bcch);\r\n}
