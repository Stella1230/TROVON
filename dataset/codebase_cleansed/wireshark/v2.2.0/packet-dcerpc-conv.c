static int\r\nconv_dissect_who_are_you_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\ne_guid_t actuid;\r\noffset = dissect_ndr_uuid_t(tvb, offset, pinfo, tree, di, drep, hf_conv_who_are_you_rqst_actuid, &actuid);\r\noffset = dissect_ndr_time_t(tvb, offset, pinfo, tree, di, drep, hf_conv_who_are_you_rqst_boot_time, NULL);\r\ncol_add_fstr(pinfo->cinfo, COL_INFO,\r\n"conv_who_are_you request actuid: %08x-%04x-%04x-%02x%02x-%02x%02x%02x%02x%02x%02x",\r\nactuid.data1, actuid.data2, actuid.data3,\r\nactuid.data4[0], actuid.data4[1], actuid.data4[2], actuid.data4[3],\r\nactuid.data4[4], actuid.data4[5], actuid.data4[6], actuid.data4[7]);\r\nreturn offset;\r\n}\r\nstatic int\r\nconv_dissect_who_are_you_resp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 seq, st;\r\noffset = dissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_conv_who_are_you_resp_seq, &seq);\r\noffset = dissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_conv_rc, &st);\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "conv_who_are_you response seq:%u st:%s",\r\nseq, val_to_str_ext(st, &dce_error_vals_ext, "%u"));\r\nreturn offset;\r\n}\r\nstatic int\r\nconv_dissect_who_are_you2_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\ne_guid_t actuid;\r\noffset = dissect_ndr_uuid_t(tvb, offset, pinfo, tree, di, drep, hf_conv_who_are_you2_rqst_actuid, &actuid);\r\noffset = dissect_ndr_time_t(tvb, offset, pinfo, tree, di, drep, hf_conv_who_are_you2_rqst_boot_time, NULL);\r\ncol_add_fstr(pinfo->cinfo, COL_INFO,\r\n"conv_who_are_you2 request actuid: %08x-%04x-%04x-%02x%02x-%02x%02x%02x%02x%02x%02x",\r\nactuid.data1, actuid.data2, actuid.data3,\r\nactuid.data4[0], actuid.data4[1], actuid.data4[2], actuid.data4[3],\r\nactuid.data4[4], actuid.data4[5], actuid.data4[6], actuid.data4[7]);\r\nreturn offset;\r\n}\r\nstatic int\r\nconv_dissect_who_are_you2_resp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 seq, st;\r\ne_guid_t cas_uuid;\r\noffset = dissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_conv_who_are_you2_resp_seq, &seq);\r\noffset = dissect_ndr_uuid_t (tvb, offset, pinfo, tree, di, drep, hf_conv_who_are_you2_resp_casuuid, &cas_uuid);\r\noffset = dissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_conv_rc, &st);\r\ncol_add_fstr(pinfo->cinfo, COL_INFO,\r\n"conv_who_are_you2 response seq:%u st:%s cas:%08x-%04x-%04x-%02x%02x-%02x%02x%02x%02x%02x%02x",\r\nseq, val_to_str_ext(st, &dce_error_vals_ext, "%u"),\r\ncas_uuid.data1, cas_uuid.data2, cas_uuid.data3,\r\ncas_uuid.data4[0], cas_uuid.data4[1], cas_uuid.data4[2], cas_uuid.data4[3],\r\ncas_uuid.data4[4], cas_uuid.data4[5], cas_uuid.data4[6], cas_uuid.data4[7]);\r\nreturn offset;\r\n}\r\nvoid\r\nproto_register_conv (void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_conv_opnum,\r\n{ "Operation", "conv.opnum", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_conv_rc,\r\n{"Status", "conv.status", FT_UINT32, BASE_DEC|BASE_EXT_STRING, &dce_error_vals_ext, 0x0, NULL, HFILL }},\r\n{ &hf_conv_who_are_you_rqst_actuid,\r\n{"Activity UID", "conv.who_are_you_rqst_actuid", FT_GUID, BASE_NONE, NULL, 0x0, "UUID", HFILL }},\r\n{ &hf_conv_who_are_you_rqst_boot_time,\r\n{"Boot time", "conv.who_are_you_rqst_boot_time", FT_ABSOLUTE_TIME, ABSOLUTE_TIME_LOCAL, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_conv_who_are_you2_rqst_actuid,\r\n{"Activity UID", "conv.who_are_you2_rqst_actuid", FT_GUID, BASE_NONE, NULL, 0x0, "UUID", HFILL }},\r\n{ &hf_conv_who_are_you2_rqst_boot_time,\r\n{"Boot time", "conv.who_are_you2_rqst_boot_time", FT_ABSOLUTE_TIME, ABSOLUTE_TIME_LOCAL, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_conv_who_are_you_resp_seq,\r\n{"Sequence Number", "conv.who_are_you_resp_seq", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_conv_who_are_you2_resp_seq,\r\n{"Sequence Number", "conv.who_are_you2_resp_seq", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_conv_who_are_you2_resp_casuuid,\r\n{"Client's address space UUID", "conv.who_are_you2_resp_casuuid", FT_GUID, BASE_NONE, NULL, 0x0, "UUID", HFILL }}\r\n};\r\nstatic gint *ett[] = {\r\n&ett_conv\r\n};\r\nproto_conv = proto_register_protocol ("DCE/RPC Conversation Manager", "CONV", "conv");\r\nproto_register_field_array (proto_conv, hf, array_length (hf));\r\nproto_register_subtree_array (ett, array_length (ett));\r\n}\r\nvoid\r\nproto_reg_handoff_conv (void)\r\n{\r\ndcerpc_init_uuid (proto_conv, ett_conv, &uuid_conv, ver_conv, conv_dissectors, hf_conv_opnum);\r\n}
