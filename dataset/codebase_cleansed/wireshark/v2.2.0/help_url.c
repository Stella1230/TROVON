const char *\r\ntopic_online_url(topic_action_e action)\r\n{\r\nswitch(action) {\r\ncase(ONLINEPAGE_HOME):\r\nreturn "https://www.wireshark.org";\r\nbreak;\r\ncase(ONLINEPAGE_WIKI):\r\nreturn "https://wiki.wireshark.org";\r\nbreak;\r\ncase(ONLINEPAGE_DOWNLOAD):\r\nreturn "https://www.wireshark.org/download.html";\r\nbreak;\r\ncase(ONLINEPAGE_USERGUIDE):\r\nreturn "https://www.wireshark.org/docs/wsug_html_chunked/";\r\nbreak;\r\ncase(ONLINEPAGE_FAQ):\r\nreturn "http://www.wireshark.org/faq.html";\r\nbreak;\r\ncase(ONLINEPAGE_ASK):\r\nreturn "https://ask.wireshark.org";\r\nbreak;\r\ncase(ONLINEPAGE_SAMPLE_FILES):\r\nreturn "https://wiki.wireshark.org/SampleCaptures";\r\nbreak;\r\ncase(ONLINEPAGE_CAPTURE_SETUP):\r\nreturn "https://wiki.wireshark.org/CaptureSetup";\r\nbreak;\r\ncase(ONLINEPAGE_NETWORK_MEDIA):\r\nreturn "https://wiki.wireshark.org/CaptureSetup/NetworkMedia";\r\nbreak;\r\ncase(ONLINEPAGE_SAMPLE_CAPTURES):\r\nreturn "https://wiki.wireshark.org/SampleCaptures";\r\nbreak;\r\ncase(ONLINEPAGE_SECURITY):\r\nreturn "https://wiki.wireshark.org/Security";\r\nbreak;\r\ncase(ONLINEPAGE_CHIMNEY):\r\nreturn "https://wiki.wireshark.org/CaptureSetup/Offloading#chimney";\r\nbreak;\r\ndefault:\r\nreturn NULL;\r\n}\r\n}\r\ngchar *\r\nuser_guide_url(const gchar *page) {\r\nGString *url = g_string_new("");\r\n#ifdef HHC_DIR\r\nHWND hw;\r\ng_string_printf(url, "%s\\user-guide.chm::/wsug_chm/%s>Wireshark Help",\r\nget_datafile_dir(), page);\r\nhw = HtmlHelpW(NULL,\r\nutf_8to16(url->str),\r\nHH_DISPLAY_TOPIC, 0);\r\nif(hw != NULL) {\r\ng_string_free(url, TRUE );\r\nreturn NULL;\r\n}\r\n#endif\r\n#ifdef DOC_DIR\r\nif (g_file_test(DOC_DIR "/guides/wsug_html_chunked", G_FILE_TEST_IS_DIR)) {\r\ng_string_printf(url, "file://" DOC_DIR "/guides/wsug_html_chunked/%s", page);\r\n} else {\r\n#endif\r\ng_string_printf(url, "https://www.wireshark.org/docs/wsug_html_chunked/%s", page);\r\n#ifdef DOC_DIR\r\n}\r\n#endif\r\nreturn g_string_free(url, FALSE);\r\n}\r\ngchar *\r\ntopic_action_url(topic_action_e action)\r\n{\r\ngchar *url;\r\nurl = g_strdup(topic_online_url(action));\r\nif(url != NULL) {\r\nreturn url;\r\n}\r\nswitch(action) {\r\ncase(LOCALPAGE_MAN_WIRESHARK):\r\nurl = data_file_url("wireshark.html");\r\nbreak;\r\ncase(LOCALPAGE_MAN_WIRESHARK_FILTER):\r\nurl = data_file_url("wireshark-filter.html");\r\nbreak;\r\ncase(LOCALPAGE_MAN_CAPINFOS):\r\nurl = data_file_url("capinfos.html");\r\nbreak;\r\ncase(LOCALPAGE_MAN_DUMPCAP):\r\nurl = data_file_url("dumpcap.html");\r\nbreak;\r\ncase(LOCALPAGE_MAN_EDITCAP):\r\nurl = data_file_url("editcap.html");\r\nbreak;\r\ncase(LOCALPAGE_MAN_MERGECAP):\r\nurl = data_file_url("mergecap.html");\r\nbreak;\r\ncase(LOCALPAGE_MAN_RAWSHARK):\r\nurl = data_file_url("rawshark.html");\r\nbreak;\r\ncase(LOCALPAGE_MAN_REORDERCAP):\r\nurl = data_file_url("reordercap.html");\r\nbreak;\r\ncase(LOCALPAGE_MAN_TEXT2PCAP):\r\nurl = data_file_url("text2pcap.html");\r\nbreak;\r\ncase(LOCALPAGE_MAN_TSHARK):\r\nurl = data_file_url("tshark.html");\r\nbreak;\r\ncase(HELP_CONTENT):\r\nurl = user_guide_url( "index.html");\r\nbreak;\r\ncase(HELP_CAPTURE_OPTIONS_DIALOG):\r\nurl = user_guide_url("ChCapCaptureOptions.html");\r\nbreak;\r\ncase(HELP_CAPTURE_FILTERS_DIALOG):\r\nurl = user_guide_url("ChWorkDefineFilterSection.html");\r\nbreak;\r\ncase(HELP_DISPLAY_FILTERS_DIALOG):\r\nurl = user_guide_url("ChWorkDefineFilterSection.html");\r\nbreak;\r\ncase(HELP_FILTER_EXPRESSION_DIALOG):\r\nurl = user_guide_url("ChWorkFilterAddExpressionSection.html");\r\nbreak;\r\ncase(HELP_COLORING_RULES_DIALOG):\r\nurl = user_guide_url("ChCustColorizationSection.html");\r\nbreak;\r\ncase(HELP_CONFIG_PROFILES_DIALOG):\r\nurl = user_guide_url("ChCustConfigProfilesSection.html");\r\nbreak;\r\ncase (HELP_MANUAL_ADDR_RESOLVE_DIALOG):\r\nurl = user_guide_url("ChManualAddressResolveSection.html");\r\nbreak;\r\ncase(HELP_PRINT_DIALOG):\r\nurl = user_guide_url("ChIOPrintSection.html");\r\nbreak;\r\ncase(HELP_FIND_DIALOG):\r\nurl = user_guide_url("ChWorkFindPacketSection.html");\r\nbreak;\r\ncase(HELP_FIREWALL_DIALOG):\r\nurl = user_guide_url("ChUseToolsMenuSection.html");\r\nbreak;\r\ncase(HELP_GOTO_DIALOG):\r\nurl = user_guide_url("ChWorkGoToPacketSection.html");\r\nbreak;\r\ncase(HELP_CAPTURE_INTERFACES_DIALOG):\r\nurl = user_guide_url("ChCapInterfaceSection.html");\r\nbreak;\r\ncase(HELP_CAPTURE_INFO_DIALOG):\r\nurl = user_guide_url("ChCapRunningSection.html");\r\nbreak;\r\ncase(HELP_CAPTURE_MANAGE_INTERFACES_DIALOG):\r\nurl = user_guide_url("ChCapManageInterfacesSection.html");\r\nbreak;\r\ncase(HELP_ENABLED_PROTOCOLS_DIALOG):\r\nurl = user_guide_url("ChCustProtocolDissectionSection.html");\r\nbreak;\r\ncase(HELP_ENABLED_HEURISTICS_DIALOG):\r\nurl = user_guide_url("ChCustProtocolDissectionSection.html");\r\nbreak;\r\ncase(HELP_DECODE_AS_DIALOG):\r\nurl = user_guide_url("ChCustProtocolDissectionSection.html");\r\nbreak;\r\ncase(HELP_DECODE_AS_SHOW_DIALOG):\r\nurl = user_guide_url("ChCustProtocolDissectionSection.html");\r\nbreak;\r\ncase(HELP_FOLLOW_STREAM_DIALOG):\r\nurl = user_guide_url("ChAdvFollowTCPSection.html");\r\nbreak;\r\ncase(HELP_SHOW_PACKET_BYTES_DIALOG):\r\nurl = user_guide_url("ChAdvShowPacketBytes.html");\r\nbreak;\r\ncase(HELP_EXPERT_INFO_DIALOG):\r\nurl = user_guide_url("ChAdvExpert.html");\r\nbreak;\r\n#ifdef HAVE_EXTCAP\r\ncase(HELP_EXTCAP_OPTIONS_DIALOG):\r\nurl = user_guide_url("ChExtcapOptions.html");\r\nbreak;\r\n#endif\r\ncase(HELP_STATS_SUMMARY_DIALOG):\r\nurl = user_guide_url("ChStatSummary.html");\r\nbreak;\r\ncase(HELP_STATS_PROTO_HIERARCHY_DIALOG):\r\nurl = user_guide_url("ChStatHierarchy.html");\r\nbreak;\r\ncase(HELP_STATS_ENDPOINTS_DIALOG):\r\nurl = user_guide_url("ChStatEndpoints.html");\r\nbreak;\r\ncase(HELP_STATS_CONVERSATIONS_DIALOG):\r\nurl = user_guide_url("ChStatConversations.html");\r\nbreak;\r\ncase(HELP_STATS_IO_GRAPH_DIALOG):\r\nurl = user_guide_url("ChStatIOGraphs.html");\r\nbreak;\r\ncase(HELP_STATS_COMPARE_FILES_DIALOG):\r\nurl = user_guide_url("ChStatCompareCaptureFiles.html");\r\nbreak;\r\ncase(HELP_STATS_LTE_MAC_TRAFFIC_DIALOG):\r\nurl = user_guide_url("ChTelLTEMACTraffic.html");\r\nbreak;\r\ncase(HELP_STATS_LTE_RLC_TRAFFIC_DIALOG):\r\nurl = user_guide_url("ChTelLTERLCTraffic.html");\r\nbreak;\r\ncase(HELP_STATS_WLAN_TRAFFIC_DIALOG):\r\nurl = user_guide_url("ChStatWLANTraffic.html");\r\nbreak;\r\ncase(HELP_FILESET_DIALOG):\r\nurl = user_guide_url("ChIOFileSetSection.html");\r\nbreak;\r\ncase(HELP_CAPTURE_INTERFACE_OPTIONS_DIALOG):\r\nurl = user_guide_url("ChCustPreferencesSection.html#ChCustInterfaceOptionsSection");\r\nbreak;\r\ncase(HELP_CAPTURE_INTERFACES_DETAILS_DIALOG):\r\nurl = user_guide_url("ChCapInterfaceDetailsSection.html");\r\nbreak;\r\ncase(HELP_PREFERENCES_DIALOG):\r\nurl = user_guide_url("ChCustPreferencesSection.html");\r\nbreak;\r\ncase(HELP_EXPORT_FILE_DIALOG):\r\ncase(HELP_EXPORT_FILE_WIN32_DIALOG):\r\nurl = user_guide_url("ChIOExportSection.html");\r\nbreak;\r\ncase(HELP_EXPORT_BYTES_DIALOG):\r\ncase(HELP_EXPORT_BYTES_WIN32_DIALOG):\r\nurl = user_guide_url("ChIOExportSection.html#ChIOExportSelectedDialog");\r\nbreak;\r\ncase(HELP_EXPORT_OBJECT_LIST):\r\nurl = user_guide_url("ChIOExportSection.html#ChIOExportObjectsDialog");\r\nbreak;\r\ncase(HELP_OPEN_DIALOG):\r\ncase(HELP_OPEN_WIN32_DIALOG):\r\nurl = user_guide_url("ChIOOpenSection.html");\r\nbreak;\r\ncase(HELP_MERGE_DIALOG):\r\ncase(HELP_MERGE_WIN32_DIALOG):\r\nurl = user_guide_url("ChIOMergeSection.html");\r\nbreak;\r\ncase(HELP_IMPORT_DIALOG):\r\nurl = user_guide_url("ChIOImportSection.html");\r\nbreak;\r\ncase(HELP_SAVE_DIALOG):\r\ncase(HELP_SAVE_WIN32_DIALOG):\r\nurl = user_guide_url("ChIOSaveSection.html");\r\nbreak;\r\ncase(HELP_TIME_SHIFT_DIALOG):\r\nurl = user_guide_url("ChWorkShiftTimePacketSection.html");\r\nbreak;\r\ncase(HELP_FILTER_SAVE_DIALOG):\r\nurl = user_guide_url("ChWorkFilterSaveSection.html");\r\nbreak;\r\ncase(HELP_TELEPHONY_VOIP_CALLS_DIALOG):\r\nurl = user_guide_url("ChTelVoipCalls.html");\r\nbreak;\r\ncase(HELP_RTP_ANALYSIS_DIALOG):\r\nurl = user_guide_url("ChTelRTPAnalysis.html");\r\nbreak;\r\ncase(HELP_NEW_PACKET_DIALOG):\r\nurl = user_guide_url("ChapterWork.html#ChWorkPacketSepView");\r\nbreak;\r\ncase(HELP_IAX2_ANALYSIS_DIALOG):\r\nurl = user_guide_url("ChTelIAX2Analysis.html");\r\nbreak;\r\ncase(HELP_TELEPHONY_RTP_PLAYER_DIALOG):\r\nurl = user_guide_url("ChTelRtpPlayer.html");\r\nbreak;\r\ncase(TOPIC_ACTION_NONE):\r\ndefault:\r\ng_assert_not_reached();\r\n}\r\nreturn url;\r\n}
