static const gchar* get_register_name_from_address(guint32 addr, gboolean* is_custom_register)\r\n{\r\nconst gchar* address_string = NULL;\r\nif (is_custom_register != NULL)\r\n{\r\n*is_custom_register = FALSE;\r\n}\r\naddress_string = try_val_to_str(addr, bootstrapregisternames);\r\nif (!address_string)\r\n{\r\naddress_string = wmem_strdup_printf(wmem_packet_scope(),"[Addr:0x%08X]", addr);\r\nif (is_custom_register != NULL)\r\n{\r\n*is_custom_register = TRUE;\r\n}\r\n}\r\nreturn address_string;\r\n}\r\nstatic int dissect_register(guint32 addr, proto_tree *branch, tvbuff_t *tvb, gint offset, gint length)\r\n{\r\nswitch (addr)\r\n{\r\ncase GVCP_VERSION:\r\nproto_tree_add_item(branch, hf_gvcp_spec_version_major, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_spec_version_minor, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_DEVICE_MODE:\r\nproto_tree_add_item(branch, hf_gvcp_devicemode_endianess, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_devicemode_deviceclass, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_devicemode_characterset, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_DEVICE_MAC_HIGH_0:\r\ncase GVCP_DEVICE_MAC_HIGH_1:\r\ncase GVCP_DEVICE_MAC_HIGH_2:\r\ncase GVCP_DEVICE_MAC_HIGH_3:\r\nproto_tree_add_item(branch, hf_gvcp_machigh, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_DEVICE_MAC_LOW_0:\r\ncase GVCP_DEVICE_MAC_LOW_1:\r\ncase GVCP_DEVICE_MAC_LOW_2:\r\ncase GVCP_DEVICE_MAC_LOW_3:\r\nproto_tree_add_item(branch, hf_gvcp_maclow, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_SUPPORTED_IP_CONFIGURATION_0:\r\ncase GVCP_SUPPORTED_IP_CONFIGURATION_1:\r\ncase GVCP_SUPPORTED_IP_CONFIGURATION_2:\r\ncase GVCP_SUPPORTED_IP_CONFIGURATION_3:\r\nproto_tree_add_item(branch, hf_gvcp_ip_config_can_handle_pause_frames_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_ip_config_can_generate_pause_frames_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_ip_config_lla, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_ip_config_dhcp, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_ip_config_persistent_ip, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_CURIPCFG_0:\r\ncase GVCP_CURIPCFG_1:\r\ncase GVCP_CURIPCFG_2:\r\ncase GVCP_CURIPCFG_3:\r\nproto_tree_add_item(branch, hf_gvcp_ip_config_can_handle_pause_frames_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_ip_config_can_generate_pause_frames_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_ip_config_lla, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_ip_config_dhcp, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_ip_config_persistent_ip, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_CURRENT_IP_ADDRESS_0:\r\ncase GVCP_CURRENT_IP_ADDRESS_1:\r\ncase GVCP_CURRENT_IP_ADDRESS_2:\r\ncase GVCP_CURRENT_IP_ADDRESS_3:\r\nproto_tree_add_item(branch, hf_gvcp_current_IP, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_CURRENT_SUBNET_MASK_0:\r\ncase GVCP_CURRENT_SUBNET_MASK_1:\r\ncase GVCP_CURRENT_SUBNET_MASK_2:\r\ncase GVCP_CURRENT_SUBNET_MASK_3:\r\nproto_tree_add_item(branch, hf_gvcp_current_subnet_mask, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_CURRENT_DEFAULT_GATEWAY_0:\r\ncase GVCP_CURRENT_DEFAULT_GATEWAY_1:\r\ncase GVCP_CURRENT_DEFAULT_GATEWAY_2:\r\ncase GVCP_CURRENT_DEFAULT_GATEWAY_3:\r\nproto_tree_add_item(branch, hf_gvcp_current_default_gateway, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_MANUFACTURER_NAME:\r\nproto_tree_add_item(branch, hf_gvcp_reserved_bit, tvb, 0, length, ENC_NA);\r\nbreak;\r\ncase GVCP_MODEL_NAME:\r\nproto_tree_add_item(branch, hf_gvcp_reserved_bit, tvb, 0, length, ENC_NA);\r\nbreak;\r\ncase GVCP_DEVICE_VERSION:\r\nproto_tree_add_item(branch, hf_gvcp_reserved_bit, tvb, 0, length, ENC_NA);\r\nbreak;\r\ncase GVCP_MANUFACTURER_INFO:\r\nproto_tree_add_item(branch, hf_gvcp_reserved_bit, tvb, 0, length, ENC_NA);\r\nbreak;\r\ncase GVCP_SERIAL_NUMBER:\r\nproto_tree_add_item(branch, hf_gvcp_reserved_bit, tvb, 0, length, ENC_NA);\r\nbreak;\r\ncase GVCP_USER_DEFINED_NAME:\r\nproto_tree_add_item(branch, hf_gvcp_user_defined_name, tvb, offset, 4, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase GVCP_FIRST_URL:\r\nproto_tree_add_item(branch, hf_gvcp_reserved_bit, tvb, 0, length, ENC_NA);\r\nbreak;\r\ncase GVCP_SECOND_URL:\r\nproto_tree_add_item(branch, hf_gvcp_reserved_bit, tvb, 0, length, ENC_NA);\r\nbreak;\r\ncase GVCP_NUMBER_OF_NETWORK_INTERFACES:\r\nproto_tree_add_item(branch, hf_gvcp_number_interfaces, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_PERSISTENT_IP_ADDRESS_0:\r\ncase GVCP_PERSISTENT_IP_ADDRESS_1:\r\ncase GVCP_PERSISTENT_IP_ADDRESS_2:\r\ncase GVCP_PERSISTENT_IP_ADDRESS_3:\r\nproto_tree_add_item(branch, hf_gvcp_persistent_ip, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_PERSISTENT_SUBNET_MASK_0:\r\ncase GVCP_PERSISTENT_SUBNET_MASK_1:\r\ncase GVCP_PERSISTENT_SUBNET_MASK_2:\r\ncase GVCP_PERSISTENT_SUBNET_MASK_3:\r\nproto_tree_add_item(branch, hf_gvcp_persistent_subnet, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_PERSISTENT_DEFAULT_GATEWAY_0:\r\ncase GVCP_PERSISTENT_DEFAULT_GATEWAY_1:\r\ncase GVCP_PERSISTENT_DEFAULT_GATEWAY_2:\r\ncase GVCP_PERSISTENT_DEFAULT_GATEWAY_3:\r\nproto_tree_add_item(branch, hf_gvcp_persistent_gateway, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_LINK_SPEED_0:\r\ncase GVCP_LINK_SPEED_1:\r\ncase GVCP_LINK_SPEED_2:\r\ncase GVCP_LINK_SPEED_3:\r\nproto_tree_add_item(branch, hf_gvcp_link_speed, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_NUMBER_OF_MESSAGE_CHANNELS:\r\nproto_tree_add_item(branch, hf_gvcp_number_message_channels, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_NUMBER_OF_STREAM_CHANNELS:\r\nproto_tree_add_item(branch, hf_gvcp_number_stream_channels, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_NUMBER_OF_ACTION_SIGNALS:\r\nproto_tree_add_item(branch, hf_gvcp_number_action_signals, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_ACTION_DEVICE_KEY:\r\nproto_tree_add_item(branch, hf_gvcp_writeregcmd_data, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_NUMBER_OF_ACTIVE_LINKS:\r\nproto_tree_add_item(branch, hf_gvcp_number_of_active_links_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_SC_CAPS:\r\nproto_tree_add_item(branch, hf_gvcp_sccaps_scspx_register_supported, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sccaps_legacy_16bit_blockid_supported_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_MESSAGE_CHANNEL_CAPS:\r\nproto_tree_add_item(branch, hf_gvcp_mcsp_supported, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_CAPABILITY:\r\nproto_tree_add_item(branch, hf_gvcp_capability_user_defined, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_capability_serial_number, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_capability_heartbeat_disable, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_capability_link_speed, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_capability_ccp_application_portip, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_capability_manifest_table, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_capability_test_data, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_capability_discovery_ACK_delay, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_capability_writable_discovery_ACK_delay, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_capability_extended_status_code_v1_1, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_capability_primary_application_switchover, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_capability_unconditional_action_command, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_capability_1588_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_capability_extended_status_code_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_capability_scheduled_action_command_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_capability_action_command, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_capability_pending, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_capability_evendata, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_capability_event, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_capability_packetresend, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_capability_writemem, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_capability_concatenation, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_HEARTBEAT_TIMEOUT:\r\nproto_tree_add_item(branch, hf_gvcp_heartbeat, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_TIMESTAMP_TICK_FREQUENCY_HIGH:\r\nproto_tree_add_item(branch, hf_gvcp_high_timestamp_frequency, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_TIMESTAMP_TICK_FREQUENCY_LOW:\r\nproto_tree_add_item(branch, hf_gvcp_low_timestamp_frequency, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_TIMESTAMP_CONTROL:\r\nproto_tree_add_item(branch, hf_gvcp_timestamp_control_latch, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_timestamp_control_reset, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_TIMESTAMP_VALUE_HIGH:\r\nproto_tree_add_item(branch, hf_gvcp_high_timestamp_value, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_TIMESTAMP_VALUE_LOW:\r\nproto_tree_add_item(branch, hf_gvcp_low_timestamp_value, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_DISCOVERY_ACK_DELAY:\r\nproto_tree_add_item(branch, hf_gvcp_discovery_ACK_delay, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_CONFIGURATION:\r\nproto_tree_add_item(branch, hf_gvcp_configuration_1588_enable_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_configuration_extended_status_codes_enable_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_configuration_unconditional_action_command_enable_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_configuration_extended_status_codes_enable_v1_1, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_configuration_pending_ack_enable, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_configuration_heartbeat_disable, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_PENDING_TIMEOUT:\r\nproto_tree_add_item(branch, hf_gvcp_pending_timeout_max_execution, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_CONTROL_SWITCHOVER_KEY:\r\nproto_tree_add_item(branch, hf_gvcp_control_switchover_key_register, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_GVSCP_CONFIGURATION:\r\nproto_tree_add_item(branch, hf_gvcp_gvsp_configuration_64bit_blockid_enable_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_PHYSICAL_LINK_CAPABILITY:\r\nproto_tree_add_item(branch, hf_gvcp_link_dlag_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_link_slag_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_link_ml_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_link_sl_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_PHYSICAL_LINK_CONFIGURATION:\r\nproto_tree_add_item(branch, hf_gvcp_link_dlag_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_link_slag_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_link_ml_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_link_sl_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_IEEE_1588_STATUS:\r\nproto_tree_add_item(branch, hf_gvcp_ieee1588_clock_status_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_SCHEDULED_ACTION_COMMAND_QUEUE_SIZE:\r\nproto_tree_add_item(branch, hf_gvcp_scheduled_action_command_queue_size_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_CCP:\r\nproto_tree_add_item(branch, hf_gvcp_control_switchover_key, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_control_switchover_en, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_control_access, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_exclusive_access, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_PRIMARY_APPLICATION_PORT:\r\nproto_tree_add_item(branch, hf_gvcp_primary_application_host_port, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_PRIMARY_APPLICATION_IP_ADDRESS:\r\nproto_tree_add_item(branch, hf_gvcp_primary_application_ip_address, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_MC_DESTINATION_PORT:\r\nproto_tree_add_item(branch, hf_gvcp_network_interface_index, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_host_port, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_MC_DESTINATION_ADDRESS:\r\nproto_tree_add_item(branch, hf_gvcp_channel_destination_ip, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_MC_TIMEOUT:\r\nproto_tree_add_item(branch, hf_gvcp_message_channel_transmission_timeout, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_MC_RETRY_COUNT:\r\nproto_tree_add_item(branch, hf_gvcp_message_channel_retry_count, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_MC_SOURCE_PORT:\r\nproto_tree_add_item(branch, hf_gvcp_message_channel_source_port, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_SC_DESTINATION_PORT(0):\r\ncase GVCP_SC_DESTINATION_PORT(1):\r\ncase GVCP_SC_DESTINATION_PORT(2):\r\ncase GVCP_SC_DESTINATION_PORT(3):\r\nproto_tree_add_item(branch, hf_gvcp_sc_direction, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_ni_index, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_host_port, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_SC_PACKET_SIZE(0):\r\ncase GVCP_SC_PACKET_SIZE(1):\r\ncase GVCP_SC_PACKET_SIZE(2):\r\ncase GVCP_SC_PACKET_SIZE(3):\r\nproto_tree_add_item(branch, hf_gvcp_sc_fire_test_packet, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_do_not_fragment, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_pixel_endianness, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_packet_size, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_SC_PACKET_DELAY(0):\r\ncase GVCP_SC_PACKET_DELAY(1):\r\ncase GVCP_SC_PACKET_DELAY(2):\r\ncase GVCP_SC_PACKET_DELAY(3):\r\nproto_tree_add_item(branch, hf_gvcp_sc_packet_delay, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_SC_DESTINATION_ADDRESS(0):\r\ncase GVCP_SC_DESTINATION_ADDRESS(1):\r\ncase GVCP_SC_DESTINATION_ADDRESS(2):\r\ncase GVCP_SC_DESTINATION_ADDRESS(3):\r\n{\r\nguint32 value = 0;\r\nvalue = tvb_get_letohl(tvb, offset);\r\nproto_tree_add_ipv4(branch, hf_gvcp_sc_destination_ip, tvb, offset, 4, value);\r\n}\r\nbreak;\r\ncase GVCP_SC_SOURCE_PORT(0):\r\ncase GVCP_SC_SOURCE_PORT(1):\r\ncase GVCP_SC_SOURCE_PORT(2):\r\ncase GVCP_SC_SOURCE_PORT(3):\r\nproto_tree_add_item(branch, hf_gvcp_sc_source_port, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_SC_CAPABILITY(0):\r\ncase GVCP_SC_CAPABILITY(1):\r\ncase GVCP_SC_CAPABILITY(2):\r\ncase GVCP_SC_CAPABILITY(3):\r\nproto_tree_add_item(branch, hf_gvcp_sc_big_little_endian_supported, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_ip_reassembly_supported, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_multizone_supported_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_packet_resend_destination_option_supported_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_packet_resend_all_in_transmission_supported_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_unconditional_streaming_supported, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_extended_chunk_data_supported, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_SC_CONFIGURATION(0):\r\ncase GVCP_SC_CONFIGURATION(1):\r\ncase GVCP_SC_CONFIGURATION(2):\r\ncase GVCP_SC_CONFIGURATION(3):\r\nproto_tree_add_item(branch, hf_gvcp_sc_packet_resend_destination_option_enabled_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_packet_resend_all_in_transmission_enabled_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_unconditional_streaming_enabled, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_extended_chunk_data_enabled, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_SC_ZONE(0):\r\ncase GVCP_SC_ZONE(1):\r\ncase GVCP_SC_ZONE(2):\r\ncase GVCP_SC_ZONE(3):\r\nproto_tree_add_item(branch, hf_gvcp_sc_additional_zones_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_SC_ZONE_DIRECTION(0):\r\ncase GVCP_SC_ZONE_DIRECTION(1):\r\ncase GVCP_SC_ZONE_DIRECTION(2):\r\ncase GVCP_SC_ZONE_DIRECTION(3):\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone0_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone1_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone2_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone3_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone4_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone5_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone6_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone7_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone8_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone9_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone10_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone11_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone12_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone13_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone14_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone15_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone16_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone17_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone18_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone19_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone20_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone21_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone22_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone23_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone24_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone25_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone26_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone27_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone28_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone29_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone30_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(branch, hf_gvcp_sc_zone31_direction_v2_0, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_MANIFEST_TABLE:\r\nproto_tree_add_item(branch, hf_gvcp_manifest_table, tvb, 0, length, ENC_NA);\r\nbreak;\r\ncase GVCP_ACTION_GROUP_KEY(0):\r\ncase GVCP_ACTION_GROUP_KEY(1):\r\ncase GVCP_ACTION_GROUP_KEY(2):\r\ncase GVCP_ACTION_GROUP_KEY(3):\r\ncase GVCP_ACTION_GROUP_KEY(4):\r\ncase GVCP_ACTION_GROUP_KEY(5):\r\ncase GVCP_ACTION_GROUP_KEY(6):\r\ncase GVCP_ACTION_GROUP_KEY(7):\r\ncase GVCP_ACTION_GROUP_KEY(8):\r\ncase GVCP_ACTION_GROUP_KEY(9):\r\nproto_tree_add_item(branch, hf_gvcp_action_group_key, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase GVCP_ACTION_GROUP_MASK(0):\r\ncase GVCP_ACTION_GROUP_MASK(1):\r\ncase GVCP_ACTION_GROUP_MASK(2):\r\ncase GVCP_ACTION_GROUP_MASK(3):\r\ncase GVCP_ACTION_GROUP_MASK(4):\r\ncase GVCP_ACTION_GROUP_MASK(5):\r\ncase GVCP_ACTION_GROUP_MASK(6):\r\ncase GVCP_ACTION_GROUP_MASK(7):\r\ncase GVCP_ACTION_GROUP_MASK(8):\r\ncase GVCP_ACTION_GROUP_MASK(9):\r\nproto_tree_add_item(branch, hf_gvcp_action_group_mask, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nreturn 0;\r\n}\r\nreturn 1;\r\n}\r\nstatic int dissect_register_data(guint32 addr, proto_tree *branch, tvbuff_t *tvb, gint offset, gint length)\r\n{\r\nswitch (addr)\r\n{\r\ncase GVCP_MANUFACTURER_NAME:\r\nif (length == 32)\r\n{\r\nproto_tree_add_item(branch, hf_gvcp_manufacturer_name, tvb, offset, -1, ENC_ASCII|ENC_NA);\r\n}\r\nbreak;\r\ncase GVCP_MODEL_NAME:\r\nif (length == 32)\r\n{\r\nproto_tree_add_item(branch, hf_gvcp_model_name, tvb, offset, -1, ENC_ASCII|ENC_NA);\r\n}\r\nbreak;\r\ncase GVCP_DEVICE_VERSION:\r\nif (length == 32)\r\n{\r\nproto_tree_add_item(branch, hf_gvcp_device_version, tvb, offset, -1, ENC_ASCII|ENC_NA);\r\n}\r\nbreak;\r\ncase GVCP_MANUFACTURER_INFO:\r\nif (length == 48)\r\n{\r\nproto_tree_add_item(branch, hf_gvcp_manufacturer_specific_info, tvb, offset, -1, ENC_ASCII|ENC_NA);\r\n}\r\nbreak;\r\ncase GVCP_SERIAL_NUMBER:\r\nif (length == 16)\r\n{\r\nproto_tree_add_item(branch, hf_gvcp_serial_number, tvb, offset, -1, ENC_ASCII|ENC_NA);\r\n}\r\nbreak;\r\ncase GVCP_USER_DEFINED_NAME:\r\nif (length == 16)\r\n{\r\nproto_tree_add_item(branch, hf_gvcp_user_defined_name, tvb, offset, -1, ENC_ASCII|ENC_NA);\r\n}\r\nbreak;\r\ncase GVCP_FIRST_URL:\r\nif (length == 512)\r\n{\r\nproto_tree_add_item(branch, hf_gvcp_first_xml_device_description_file, tvb, offset, -1, ENC_ASCII|ENC_NA);\r\n}\r\nbreak;\r\ncase GVCP_SECOND_URL:\r\nif (length == 512)\r\n{\r\nproto_tree_add_item(branch, hf_gvcp_second_xml_device_description_file, tvb, offset, -1, ENC_ASCII|ENC_NA);\r\n}\r\nbreak;\r\ndefault:\r\nreturn 0;\r\n}\r\nreturn 1;\r\n}\r\nstatic void dissect_forceip_cmd(proto_tree *gvcp_telegram_tree, tvbuff_t *tvb, packet_info *pinfo _U_, gint startoffset, gint length)\r\n{\r\nconst gint mac_offset = startoffset + 2;\r\nconst gint ip_offset = startoffset + 20;\r\nconst gint mask_offset = startoffset + 36;\r\nconst gint gateway_offset = startoffset + 52;\r\nif (gvcp_telegram_tree != NULL)\r\n{\r\ngvcp_telegram_tree = proto_tree_add_subtree(gvcp_telegram_tree, tvb, startoffset, length,\r\nett_gvcp_payload_cmd, NULL, "FORCEIP_CMD Options");\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_forceip_mac_address, tvb, mac_offset, 6, ENC_NA);\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_forceip_static_IP, tvb, ip_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_forceip_static_subnet_mask, tvb, mask_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_forceip_static_default_gateway, tvb, gateway_offset, 4, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void dissect_packetresend_cmd(proto_tree *gvcp_telegram_tree, tvbuff_t *tvb, packet_info *pinfo, gint startoffset, gint length, int extendedblockid)\r\n{\r\nguint64 block_id = 0;\r\nguint32 first_packet = 0;\r\nguint32 last_packet = 0;\r\ngint offset;\r\noffset = startoffset;\r\nif (extendedblockid == 0)\r\n{\r\nblock_id = tvb_get_ntohs(tvb, offset + 2);\r\n}\r\nelse\r\n{\r\nguint64 highid;\r\nguint64 lowid;\r\nhighid = tvb_get_ntoh64(tvb, offset + 12);\r\nlowid = tvb_get_ntoh64(tvb, offset + 16);\r\nblock_id = lowid | (highid << 32);\r\n}\r\nif (extendedblockid == 0)\r\n{\r\nfirst_packet = tvb_get_ntohl(tvb, offset + 4) & 0x00FFFFFF;\r\nlast_packet = tvb_get_ntohl(tvb, offset + 8) & 0x00FFFFFF;\r\n}\r\nelse\r\n{\r\nfirst_packet = tvb_get_ntohl(tvb, offset + 4);\r\nlast_packet = tvb_get_ntohl(tvb, offset + 8);\r\n}\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "Block %" G_GINT64_MODIFIER "u, Packets %d->%d", (gint64)block_id, first_packet, last_packet);\r\nif (gvcp_telegram_tree != NULL)\r\n{\r\ngvcp_telegram_tree = proto_tree_add_subtree(gvcp_telegram_tree, tvb, startoffset, length,\r\nett_gvcp_payload_cmd, NULL, "PACKETRESEND_CMD Values");\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_resendcmd_stream_channel_index, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nif (extendedblockid == 0)\r\n{\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_resendcmd_block_id, tvb, offset + 2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_resendcmd_first_packet_id, tvb, offset + 5, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_resendcmd_last_packet_id, tvb, offset + 9, 3, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_resendcmd_extended_block_id_v2_0, tvb, offset + 12, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_resendcmd_extended_first_packet_id_v2_0, tvb, offset + 4, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_resendcmd_extended_last_packet_id_v2_0, tvb, offset + 8, 4, ENC_BIG_ENDIAN);\r\n}\r\n}\r\n}\r\nstatic void dissect_readreg_cmd(proto_tree *gvcp_telegram_tree, tvbuff_t *tvb, packet_info *pinfo, gint startoffset, gint length, gvcp_transaction_t* gvcp_trans)\r\n{\r\nproto_item *item = NULL;\r\nguint32 addr = 0;\r\nconst gchar* address_string = NULL;\r\ngboolean is_custom_register = FALSE;\r\ngint offset;\r\ngint i;\r\ngint num_registers;\r\noffset = startoffset;\r\nnum_registers = length / 4;\r\naddr = tvb_get_ntohl(tvb, offset);\r\naddress_string = get_register_name_from_address(addr, &is_custom_register);\r\nif (num_registers > 1)\r\n{\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "[Multiple Register Read Command]");\r\n}\r\nelse\r\n{\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s", address_string);\r\n}\r\nif (!pinfo->fd->flags.visited)\r\n{\r\ngvcp_trans->addr_list = wmem_array_new(wmem_file_scope(), sizeof(guint32));\r\n}\r\nif (gvcp_telegram_tree != NULL)\r\n{\r\nif (num_registers > 1)\r\n{\r\ngvcp_telegram_tree = proto_tree_add_subtree(gvcp_telegram_tree, tvb, startoffset, length,\r\nett_gvcp_payload_cmd, &item, "READREG_CMD Address List");\r\n}\r\n}\r\nfor (i = 0; i < num_registers; i++)\r\n{\r\naddr = tvb_get_ntohl(tvb, offset);\r\nif (gvcp_trans && (!pinfo->fd->flags.visited))\r\n{\r\nwmem_array_append_one(gvcp_trans->addr_list, addr);\r\n}\r\nif (gvcp_telegram_tree != NULL)\r\n{\r\nif (try_val_to_str(addr, bootstrapregisternames) != NULL)\r\n{\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_readregcmd_bootstrap_register, tvb, offset, 4, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nitem = proto_tree_add_item(gvcp_telegram_tree, hf_gvcp_custom_register_addr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_item_append_text(item, " ");\r\nproto_item_append_text(item, "[Unknown Register]");\r\n}\r\n}\r\noffset +=4;\r\n}\r\n}\r\nstatic void dissect_writereg_cmd(proto_tree *gvcp_telegram_tree, tvbuff_t *tvb, packet_info *pinfo, gint startoffset, gint length, gvcp_transaction_t* gvcp_trans)\r\n{\r\ngint offset;\r\ngint i;\r\nproto_item *item = NULL;\r\nguint32 addr = 0;\r\nguint32 value = 0;\r\nconst gchar *address_string = NULL;\r\ngboolean is_custom_register = FALSE;\r\ngint num_registers;\r\nproto_tree *subtree = NULL;\r\noffset = startoffset;\r\nnum_registers = length / 8;\r\nif (gvcp_trans)\r\n{\r\ngvcp_trans->addr_count = num_registers;\r\n}\r\naddr = tvb_get_ntohl(tvb, offset);\r\nvalue = tvb_get_ntohl(tvb, offset+4);\r\naddress_string = get_register_name_from_address(addr, &is_custom_register);\r\nif ((addr == GVCP_SC_DESTINATION_PORT(0)) ||\r\n(addr == GVCP_SC_DESTINATION_PORT(1)) ||\r\n(addr == GVCP_SC_DESTINATION_PORT(2)) ||\r\n(addr == GVCP_SC_DESTINATION_PORT(3)))\r\n{\r\ndissector_handle_t gvsp_handle;\r\ngvsp_handle = find_dissector("gvsp");\r\nif (gvsp_handle != NULL)\r\n{\r\ndissector_add_uint("udp.port", value, gvsp_handle);\r\n}\r\n}\r\nif (addr == GVCP_MC_DESTINATION_PORT)\r\n{\r\ndissector_add_uint("udp.port", value, gvcp_handle);\r\n}\r\nif (num_registers > 1)\r\n{\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "[Multiple Register Write Command]");\r\n}\r\nelse\r\n{\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s Value=0x%08X", address_string, value);\r\n}\r\nif (gvcp_telegram_tree != NULL)\r\n{\r\nif (num_registers > 1)\r\n{\r\ngvcp_telegram_tree = proto_tree_add_subtree(gvcp_telegram_tree, tvb, startoffset, length,\r\nett_gvcp_payload_cmd, &item, "WRITEREG_CMD Address List");\r\n}\r\nfor (i = 0; i < num_registers; i++)\r\n{\r\naddr = tvb_get_ntohl(tvb, offset);\r\nif (try_val_to_str(addr, bootstrapregisternames) != NULL)\r\n{\r\nitem = proto_tree_add_item(gvcp_telegram_tree, hf_gvcp_writeregcmd_bootstrap_register, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nsubtree = proto_item_add_subtree(item, ett_gvcp_payload_cmd_subtree);\r\noffset += 4;\r\ndissect_register(addr, subtree, tvb, offset, 4);\r\n}\r\nelse\r\n{\r\nproto_tree* temp_tree = NULL;\r\nitem = proto_tree_add_item(gvcp_telegram_tree, hf_gvcp_custom_register_addr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\ntemp_tree = proto_item_add_subtree(item, ett_gvcp_payload_cmd_subtree);\r\nproto_tree_add_item(temp_tree, hf_gvcp_custom_register_value, tvb, offset, 4, ENC_BIG_ENDIAN);\r\n}\r\noffset += 4;\r\n}\r\n}\r\n}\r\nstatic void dissect_readmem_cmd(proto_tree *gvcp_telegram_tree, tvbuff_t *tvb, packet_info *pinfo, gint startoffset)\r\n{\r\nguint32 addr = 0;\r\nguint16 count = 0;\r\ngint offset;\r\noffset = startoffset;\r\naddr = tvb_get_ntohl(tvb, offset);\r\ncount = tvb_get_ntohs(tvb, offset + 6);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " (0x%08X (%d) bytes)", addr, count);\r\nif (gvcp_telegram_tree != NULL)\r\n{\r\nproto_item *item = NULL;\r\nif (try_val_to_str(addr, bootstrapregisternames) != NULL)\r\n{\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_readmemcmd_bootstrap_register, tvb, offset, 4, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nitem = proto_tree_add_item(gvcp_telegram_tree, hf_gvcp_custom_memory_addr, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_item_append_text(item, " ");\r\nproto_item_append_text(item, "[Unknown Register]");\r\n}\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_readmemcmd_count, tvb, (offset + 6), 2, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void dissect_writemem_cmd(proto_tree *gvcp_telegram_tree, tvbuff_t *tvb, packet_info *pinfo, gint startoffset, gint length, gvcp_transaction_t* gvcp_trans)\r\n{\r\nconst gchar* address_string = NULL;\r\ngboolean is_custom_register = FALSE;\r\nguint32 addr = 0;\r\naddr = tvb_get_ntohl(tvb, startoffset);\r\naddress_string = get_register_name_from_address(addr, &is_custom_register);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s: %d bytes", address_string, (length - 4));\r\nif (gvcp_trans && (!pinfo->fd->flags.visited))\r\n{\r\ngvcp_trans->addr_list = wmem_array_new(wmem_file_scope(), sizeof(guint32));\r\nwmem_array_append_one(gvcp_trans->addr_list, addr);\r\n}\r\nif (gvcp_telegram_tree != NULL)\r\n{\r\nguint offset;\r\nguint byte_count;\r\noffset = startoffset + 4;\r\nbyte_count = (length - 4);\r\nif (gvcp_trans && (gvcp_trans->rep_frame))\r\n{\r\nproto_item *item = NULL;\r\nitem = proto_tree_add_uint(gvcp_telegram_tree, hf_gvcp_response_in, tvb, 0, 0, gvcp_trans->rep_frame);\r\nPROTO_ITEM_SET_GENERATED(item);\r\n}\r\nif (try_val_to_str(addr, bootstrapregisternames) != NULL)\r\n{\r\ndissect_register_data(addr, gvcp_telegram_tree, tvb, offset, byte_count);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_writememcmd_data, tvb, offset, byte_count, ENC_NA);\r\n}\r\n}\r\n}\r\nstatic void dissect_event_cmd(proto_tree *gvcp_telegram_tree, tvbuff_t *tvb, packet_info *pinfo, gint startoffset, gint length, gint extendedblockids)\r\n{\r\ngint32 eventid;\r\ngint offset;\r\noffset = startoffset;\r\neventid = tvb_get_ntohs(tvb, offset + 2);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "[ID: 0x%04X]", eventid);\r\nif (gvcp_telegram_tree != NULL)\r\n{\r\ngint i;\r\ngint event_count = 0;\r\nif (extendedblockids == 0)\r\n{\r\nevent_count = length / 16;\r\n}\r\nelse\r\n{\r\nevent_count = length / 24;\r\n}\r\nif (event_count > 1)\r\n{\r\ngvcp_telegram_tree = proto_tree_add_subtree(gvcp_telegram_tree, tvb, offset, length,\r\nett_gvcp_payload_cmd, NULL, "EVENT_CMD Event List");\r\n}\r\nfor (i = 0; i < event_count; i++)\r\n{\r\noffset += 2;\r\neventid = tvb_get_ntohs(tvb, offset);\r\nif ((eventid >= 0x0000) && (eventid <= 0x8000))\r\n{\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_eventcmd_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nelse if ((eventid >= 0x8001) && (eventid <= 0x8FFF))\r\n{\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_eventcmd_error_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nelse if ((eventid >= 0x9000) && (eventid <= 0xFFFF))\r\n{\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_eventcmd_device_specific_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\n}\r\noffset += 2;\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_eventcmd_stream_channel_index, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nif (extendedblockids == 0)\r\n{\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_eventcmd_block_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\nelse\r\n{\r\noffset += 2;\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_eventcmd_block_id_64bit_v2_0, tvb, offset, 8, ENC_BIG_ENDIAN);\r\noffset += 8;\r\n}\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_eventcmd_timestamp, tvb, offset, 8, ENC_BIG_ENDIAN);\r\noffset += 8;\r\n}\r\n}\r\n}\r\nstatic void dissect_eventdata_cmd(proto_tree *gvcp_telegram_tree, tvbuff_t *tvb, packet_info *pinfo, gint startoffset, gint extendedblockids)\r\n{\r\ngint32 eventid;\r\ngint offset;\r\noffset = startoffset;\r\neventid = tvb_get_ntohs(tvb, offset + 2);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "[ID: 0x%04X]", eventid);\r\nif (gvcp_telegram_tree != NULL)\r\n{\r\noffset += 2;\r\nif ((eventid >= 0x0000) && (eventid <= 0x8000))\r\n{\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_eventcmd_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nelse if ((eventid >= 0x8001) && (eventid <= 0x8FFF))\r\n{\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_eventcmd_error_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nelse if ((eventid >= 0x9000) && (eventid <= 0xFFFF))\r\n{\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_eventcmd_device_specific_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\n}\r\noffset += 2;\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_eventcmd_stream_channel_index, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nif (extendedblockids == 0)\r\n{\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_eventcmd_block_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_eventcmd_block_id_64bit_v2_0, tvb, offset, 8, ENC_BIG_ENDIAN);\r\noffset += 8;\r\n}\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_eventcmd_timestamp, tvb, offset, 8, ENC_BIG_ENDIAN);\r\noffset += 8;\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_eventcmd_data, tvb, offset, -1, ENC_NA);\r\n}\r\n}\r\nstatic void dissect_action_cmd(proto_tree *gvcp_telegram_tree, tvbuff_t *tvb, packet_info *pinfo _U_, gint startoffset, gint scheduledactioncommand)\r\n{\r\nif (gvcp_telegram_tree != NULL)\r\n{\r\ngint offset;\r\noffset = startoffset;\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_actioncmd_device_key, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_actioncmd_group_key, tvb, offset + 4, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_actioncmd_group_mask, tvb, offset + 8, 4, ENC_BIG_ENDIAN);\r\nif (scheduledactioncommand != 0)\r\n{\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_actioncmd_time_v2_0, tvb, offset + 12, 8, ENC_BIG_ENDIAN);\r\n}\r\n}\r\n}\r\nstatic void dissect_discovery_ack(proto_tree *gvcp_telegram_tree, tvbuff_t *tvb, packet_info *pinfo, gint startoffset, gint length)\r\n{\r\nproto_item *item = NULL;\r\ngint offset;\r\nconst guint8* string_manufacturer_name = NULL;\r\nconst guint8* string_serial_number = NULL;\r\ngint string_length = 0;\r\nproto_tree *tree = NULL;\r\noffset = startoffset;\r\nstring_manufacturer_name = tvb_get_const_stringz(tvb, 80, &string_length);\r\nstring_serial_number = tvb_get_const_stringz(tvb, 224, &string_length);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "(%s, %s)",string_manufacturer_name, string_serial_number);\r\nif (gvcp_telegram_tree != NULL)\r\n{\r\ngvcp_telegram_tree = proto_tree_add_subtree(gvcp_telegram_tree, tvb, offset, length,\r\nett_gvcp_payload_cmd, NULL, "DISCOVERY_ACK Payload");\r\nitem = proto_tree_add_item(gvcp_telegram_tree, hf_gvcp_spec_version, tvb, offset, 4, ENC_BIG_ENDIAN);\r\ntree = proto_item_add_subtree(item, ett_gvcp_bootstrap_fields);\r\ndissect_register(GVCP_VERSION, tree, tvb, offset, 4 );\r\nitem = proto_tree_add_item(gvcp_telegram_tree, hf_gvcp_devicemodediscovery, tvb, offset + 4, 4, ENC_BIG_ENDIAN);\r\ntree = proto_item_add_subtree(item, ett_gvcp_bootstrap_fields);\r\ndissect_register(GVCP_DEVICE_MODE, tree, tvb, offset + 4, 4 );\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_device_mac_address, tvb, offset + 10, 6, ENC_NA);\r\nitem = proto_tree_add_item(gvcp_telegram_tree, hf_gvcp_supportedipconfig, tvb, offset + 16, 4, ENC_BIG_ENDIAN);\r\ntree = proto_item_add_subtree(item, ett_gvcp_bootstrap_fields);\r\ndissect_register(GVCP_SUPPORTED_IP_CONFIGURATION_0, tree, tvb, offset + 16, 4);\r\nitem = proto_tree_add_item(gvcp_telegram_tree, hf_gvcp_currentipconfig, tvb, offset + 20, 4, ENC_BIG_ENDIAN);\r\ntree = proto_item_add_subtree(item, ett_gvcp_bootstrap_fields);\r\ndissect_register(GVCP_CURIPCFG_0, tree, tvb, offset + 20, 4);\r\ndissect_register(GVCP_CURRENT_IP_ADDRESS_0, gvcp_telegram_tree, tvb, offset + 36, 4);\r\ndissect_register(GVCP_CURRENT_SUBNET_MASK_0, gvcp_telegram_tree, tvb, offset + 52, 4);\r\ndissect_register(GVCP_CURRENT_DEFAULT_GATEWAY_0, gvcp_telegram_tree, tvb, offset + 68, 4);\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_manufacturer_name, tvb, offset + 72, -1, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_model_name, tvb, offset + 104, -1, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_device_version, tvb, offset + 136, -1, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_manufacturer_specific_info, tvb, offset + 168, -1, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_serial_number, tvb, offset + 216, -1, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_user_defined_name, tvb, offset + 232, -1, ENC_ASCII|ENC_NA);\r\n}\r\n}\r\nstatic void dissect_readreg_ack(proto_tree *gvcp_telegram_tree, tvbuff_t *tvb, packet_info *pinfo, gint startoffset, gint length, gvcp_transaction_t *gvcp_trans)\r\n{\r\nguint i;\r\ngboolean is_custom_register = FALSE;\r\nconst gchar* address_string = NULL;\r\nguint num_registers;\r\ngint offset;\r\ngboolean valid_trans = FALSE;\r\nguint addr_list_size = 0;\r\noffset = startoffset;\r\nnum_registers = length / 4;\r\nif (gvcp_trans && gvcp_trans->addr_list)\r\n{\r\nvalid_trans = TRUE;\r\naddr_list_size = wmem_array_get_count(gvcp_trans->addr_list);\r\n}\r\nif (num_registers > 1)\r\n{\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "[Multiple ReadReg Ack]");\r\n}\r\nelse\r\n{\r\nif (valid_trans)\r\n{\r\nif (addr_list_size > 0)\r\n{\r\naddress_string = get_register_name_from_address(*((guint32*)wmem_array_index(gvcp_trans->addr_list, 0)), &is_custom_register);\r\n}\r\nif (num_registers)\r\n{\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s Value=0x%08X", address_string, tvb_get_ntohl(tvb, offset));\r\n}\r\nelse\r\n{\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s", address_string);\r\n}\r\n}\r\n}\r\nif (gvcp_telegram_tree != NULL)\r\n{\r\nif (num_registers > 1)\r\n{\r\ngvcp_telegram_tree = proto_tree_add_subtree(gvcp_telegram_tree, tvb, offset, length,\r\nett_gvcp_payload_ack, NULL, "Register Value List");\r\n}\r\nfor (i = 0; i < num_registers; i++)\r\n{\r\nguint32 curr_register = 0;\r\nif (valid_trans && i < addr_list_size)\r\n{\r\ncurr_register = *((guint32*)wmem_array_index(gvcp_trans->addr_list, i));\r\naddress_string = get_register_name_from_address(curr_register, &is_custom_register);\r\nif (!is_custom_register)\r\n{\r\nproto_tree_add_uint(gvcp_telegram_tree, hf_gvcp_readregcmd_bootstrap_register, tvb, 0, 4, curr_register);\r\ndissect_register(curr_register, gvcp_telegram_tree, tvb, offset, length);\r\n}\r\nelse\r\n{\r\nproto_tree_add_uint_format_value(gvcp_telegram_tree, hf_gvcp_custom_read_register_addr, tvb, offset, 4, curr_register, "%s (0x%08X)", address_string, curr_register);\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_custom_read_register_value, tvb, offset, 4, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_custom_register_value, tvb, offset, 4, ENC_BIG_ENDIAN);\r\n}\r\noffset += 4;\r\n}\r\n}\r\n}\r\nstatic void dissect_writereg_ack(proto_tree *gvcp_telegram_tree, tvbuff_t *tvb, packet_info *pinfo, gint startoffset, gvcp_transaction_t* gvcp_trans)\r\n{\r\nproto_item *item = NULL;\r\nguint16 ack_index = 0;\r\nif (gvcp_telegram_tree != NULL)\r\n{\r\nitem = proto_tree_add_item(gvcp_telegram_tree, hf_gvcp_writeregcmd_data_index, tvb, (startoffset + 2), 2, ENC_BIG_ENDIAN);\r\n}\r\nack_index = tvb_get_ntohs(tvb, 10);\r\nif (gvcp_trans)\r\n{\r\ngint num_registers = 0;\r\nnum_registers = gvcp_trans->addr_count;\r\nif (num_registers > 1)\r\n{\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "[Multiple WriteReg Ack] (%d/%d) %s ", ack_index, num_registers, (ack_index == num_registers ? "(Success)" : "(Failed)"));\r\n}\r\nelse\r\n{\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s ", (ack_index == num_registers ? "(Success)" : "(Failed)"));\r\n}\r\nif (gvcp_telegram_tree != NULL)\r\n{\r\nproto_item_append_text(item, " %s",(ack_index == num_registers ? "(Success)" : "(Failed)"));\r\n}\r\n}\r\nelse\r\n{\r\ncol_append_str(pinfo->cinfo, COL_INFO, "[Cannot find requesting packet]");\r\n}\r\n}\r\nstatic void dissect_readmem_ack(proto_tree *gvcp_telegram_tree, tvbuff_t *tvb, packet_info *pinfo, gint startoffset, gint length)\r\n{\r\nguint32 addr = 0;\r\nconst gchar *address_string = NULL;\r\ngboolean is_custom_register = FALSE;\r\naddr = tvb_get_ntohl(tvb, startoffset);\r\naddress_string = get_register_name_from_address(addr, &is_custom_register);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s", address_string);\r\nif (gvcp_telegram_tree != NULL)\r\n{\r\nguint offset;\r\nguint byte_count;\r\noffset = startoffset + 4;\r\nbyte_count = (length - 4);\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_readmemcmd_address, tvb, startoffset, 4, ENC_BIG_ENDIAN);\r\nif (try_val_to_str(addr, bootstrapregisternames) != NULL)\r\n{\r\ndissect_register_data(addr, gvcp_telegram_tree, tvb, offset, byte_count);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_readmemcmd_data_read, tvb, offset, byte_count, ENC_NA);\r\n}\r\n}\r\n}\r\nstatic void dissect_writemem_ack(proto_tree *gvcp_telegram_tree, tvbuff_t *tvb, packet_info *pinfo, gint startoffset, gint length, gvcp_transaction_t* gvcp_trans)\r\n{\r\nif (gvcp_trans && gvcp_trans->addr_list)\r\n{\r\nif (wmem_array_get_count(gvcp_trans->addr_list) > 0)\r\n{\r\nconst gchar *address_string = NULL;\r\naddress_string = get_register_name_from_address((*((guint32*)wmem_array_index(gvcp_trans->addr_list, 0))), NULL);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s", address_string);\r\n}\r\n}\r\nif (gvcp_telegram_tree != NULL)\r\n{\r\nproto_item *item;\r\nif (gvcp_trans && gvcp_trans->req_frame)\r\n{\r\nitem = proto_tree_add_uint(gvcp_telegram_tree, hf_gvcp_response_to, tvb, 0, 0, gvcp_trans->req_frame);\r\nPROTO_ITEM_SET_GENERATED(item);\r\n}\r\ngvcp_telegram_tree = proto_tree_add_subtree(gvcp_telegram_tree, tvb, startoffset, length,\r\nett_gvcp_payload_cmd, NULL, "Payload Data: WRITEMEM_ACK");\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_writememcmd_data_index, tvb, (startoffset +2), 2, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void dissect_pending_ack(proto_tree *gvcp_telegram_tree, tvbuff_t *tvb, packet_info *pinfo _U_, gint startoffset, gint length)\r\n{\r\nif (gvcp_telegram_tree != NULL)\r\n{\r\ngvcp_telegram_tree = proto_tree_add_subtree(gvcp_telegram_tree, tvb, startoffset, length,\r\nett_gvcp_payload_cmd, NULL, "Payload Data: PENDING_ACK");\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_time_to_completion, tvb, (startoffset + 2), 2, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic int dissect_gvcp(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data _U_)\r\n{\r\ngint offset = 0;\r\nproto_tree *gvcp_tree = NULL;\r\nproto_tree *gvcp_tree_flag = NULL;\r\nproto_tree *gvcp_telegram_tree = NULL;\r\ngint data_length = 0;\r\ngint command = -1;\r\nconst gchar* command_string = NULL;\r\ngint status = 0;\r\ngint flags = -1;\r\ngint extendedblockids = -1;\r\ngint scheduledactioncommand = -1;\r\ngint ack_code = -1;\r\nconst gchar* ack_string = NULL;\r\ngint request_id = 0;\r\ngchar key_code = 0;\r\nproto_item *ti = NULL;\r\nproto_item *item = NULL;\r\nconversation_t *conversation = 0;\r\ngvcp_conv_info_t *gvcp_info = 0;\r\ngvcp_transaction_t *gvcp_trans = 0;\r\nif (tvb_captured_length(tvb) < GVCP_MIN_PACKET_SIZE)\r\n{\r\nreturn 0;\r\n}\r\nkey_code = (gchar) tvb_get_guint8(tvb, offset);\r\nack_code = tvb_get_ntohs(tvb, offset+2);\r\nack_string = try_val_to_str(ack_code, acknowledgenames);\r\nif ((key_code != 0x42) && !ack_string)\r\n{\r\nreturn 0;\r\n}\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "GVCP");\r\ncol_clear(pinfo->cinfo, COL_INFO);\r\nti = proto_tree_add_item(tree, proto_gvcp, tvb, offset, -1, ENC_NA);\r\ngvcp_tree = proto_item_add_subtree(ti, ett_gvcp);\r\nif (key_code == 0x42)\r\n{\r\ncommand = tvb_get_ntohs(tvb, offset+2);\r\ncommand_string = val_to_str(command, commandnames,"Unknown Command (0x%x)");\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "> %s ", command_string);\r\ngvcp_tree = proto_tree_add_subtree_format(gvcp_tree, tvb, offset, 8,\r\nett_gvcp_cmd, NULL, "Command Header: %s", command_string);\r\nproto_tree_add_item(gvcp_tree, hf_gvcp_message_key_code, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nflags = (gchar) tvb_get_guint8(tvb, offset + 1);\r\nitem = proto_tree_add_item(gvcp_tree, hf_gvcp_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ngvcp_tree_flag = proto_item_add_subtree(item, ett_gvcp_flags);\r\nif (command == GVCP_ACTION_CMD)\r\n{\r\nproto_tree_add_item(gvcp_tree_flag, hf_gvcp_scheduledactioncommand_flag_v2_0, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nscheduledactioncommand = (flags & 0x80);\r\n}\r\nif ((command == GVCP_EVENTDATA_CMD) ||\r\n(command == GVCP_EVENT_CMD) ||\r\n(command == GVCP_PACKETRESEND_CMD))\r\n{\r\nproto_tree_add_item(gvcp_tree_flag, hf_gvcp_64bitid_flag_v2_0, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nextendedblockids = (flags & 0x10);\r\n}\r\nif ((command == GVCP_DISCOVERY_CMD) ||\r\n(command == GVCP_FORCEIP_CMD))\r\n{\r\nproto_tree_add_item(gvcp_tree_flag, hf_gvcp_allow_broadcast_acknowledge_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nproto_tree_add_item(gvcp_tree_flag, hf_gvcp_acknowledge_required_flag, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(gvcp_tree, hf_gvcp_command, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\nelse\r\n{\r\nstatus = tvb_get_ntohs(tvb, offset);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "< %s %s",\r\nack_string, val_to_str(status, statusnames_short, "Unknown status (0x%04X)"));\r\ngvcp_tree = proto_tree_add_subtree_format(gvcp_tree, tvb, offset+2, tvb_captured_length(tvb)-2,\r\nett_gvcp_ack, NULL, "Acknowledge Header: %s", ack_string);\r\nproto_tree_add_item(gvcp_tree, hf_gvcp_status, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(gvcp_tree, hf_gvcp_acknowledge, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\nproto_tree_add_item(gvcp_tree, hf_gvcp_length, tvb, offset, 2, ENC_BIG_ENDIAN);\r\ndata_length = tvb_get_ntohs(tvb, offset);\r\noffset += 2;\r\nproto_tree_add_item(gvcp_tree, hf_gvcp_request_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nrequest_id = tvb_get_ntohs(tvb, offset);\r\noffset += 2;\r\nconversation = find_or_create_conversation(pinfo);\r\ngvcp_info = (gvcp_conv_info_t*)conversation_get_proto_data(conversation, proto_gvcp);\r\nif (!gvcp_info)\r\n{\r\ngvcp_info = (gvcp_conv_info_t*)wmem_alloc(wmem_file_scope(), sizeof(gvcp_conv_info_t));\r\ngvcp_info->pdus = wmem_map_new(wmem_file_scope(), g_direct_hash, g_direct_equal);\r\nconversation_add_proto_data(conversation, proto_gvcp, gvcp_info);\r\n}\r\nif (!pinfo->fd->flags.visited)\r\n{\r\nif (key_code == 0x42)\r\n{\r\ngvcp_trans = (gvcp_transaction_t*)wmem_alloc(wmem_packet_scope(), sizeof(gvcp_transaction_t));\r\ngvcp_trans->req_frame = pinfo->num;\r\ngvcp_trans->rep_frame = 0;\r\ngvcp_trans->addr_list = 0;\r\ngvcp_trans->addr_count = 0;\r\n}\r\nelse\r\n{\r\nif (ack_string)\r\n{\r\ngvcp_trans_array = (wmem_array_t*)wmem_map_lookup(gvcp_info->pdus, GUINT_TO_POINTER(request_id));\r\nif (gvcp_trans_array)\r\n{\r\ngint i;\r\nguint array_size = wmem_array_get_count(gvcp_trans_array);\r\nfor (i = array_size-1; i >= 0; i--)\r\n{\r\ngvcp_trans = (gvcp_transaction_t*)wmem_array_index(gvcp_trans_array, i);\r\nif (gvcp_trans && (gvcp_trans->req_frame < pinfo->num))\r\n{\r\nif (gvcp_trans->rep_frame != 0)\r\n{\r\ngvcp_trans = 0;\r\n}\r\nelse\r\n{\r\ngvcp_trans->rep_frame = pinfo->num;\r\n}\r\nbreak;\r\n}\r\ngvcp_trans = 0;\r\n}\r\n}\r\n}\r\n}\r\n}\r\nelse\r\n{\r\ngvcp_trans = 0;\r\ngvcp_trans_array = (wmem_array_t*)wmem_map_lookup(gvcp_info->pdus, GUINT_TO_POINTER(request_id));\r\nif (gvcp_trans_array)\r\n{\r\nguint i;\r\nguint array_size = wmem_array_get_count(gvcp_trans_array);\r\nfor (i = 0; i < array_size; ++i)\r\n{\r\ngvcp_trans = (gvcp_transaction_t*)wmem_array_index(gvcp_trans_array, i);\r\nif (gvcp_trans && (pinfo->num == gvcp_trans->req_frame || pinfo->num == gvcp_trans->rep_frame))\r\n{\r\nbreak;\r\n}\r\ngvcp_trans = 0;\r\n}\r\n}\r\n}\r\nif (!gvcp_trans)\r\n{\r\ngvcp_trans = wmem_new0(wmem_packet_scope(), gvcp_transaction_t);\r\n}\r\ngvcp_telegram_tree = proto_item_add_subtree(gvcp_tree, ett_gvcp);\r\nif (key_code == 0x42)\r\n{\r\nif (gvcp_telegram_tree != NULL)\r\n{\r\nif (gvcp_trans->rep_frame)\r\n{\r\nitem = proto_tree_add_uint(gvcp_telegram_tree, hf_gvcp_response_in, tvb, 0, 0, gvcp_trans->rep_frame);\r\nPROTO_ITEM_SET_GENERATED(item);\r\n}\r\n}\r\nswitch (command)\r\n{\r\ncase GVCP_FORCEIP_CMD:\r\ndissect_forceip_cmd(gvcp_telegram_tree, tvb, pinfo, offset, data_length);\r\nbreak;\r\ncase GVCP_PACKETRESEND_CMD:\r\ndissect_packetresend_cmd(gvcp_telegram_tree, tvb, pinfo, offset, data_length, extendedblockids);\r\nbreak;\r\ncase GVCP_READREG_CMD:\r\ndissect_readreg_cmd(gvcp_telegram_tree, tvb, pinfo, offset, data_length, gvcp_trans);\r\nbreak;\r\ncase GVCP_WRITEREG_CMD:\r\ndissect_writereg_cmd(gvcp_telegram_tree, tvb, pinfo, offset, data_length, gvcp_trans);\r\nbreak;\r\ncase GVCP_READMEM_CMD:\r\ndissect_readmem_cmd(gvcp_telegram_tree, tvb, pinfo, offset);\r\nbreak;\r\ncase GVCP_WRITEMEM_CMD:\r\ndissect_writemem_cmd(gvcp_telegram_tree, tvb, pinfo, offset, data_length, gvcp_trans);\r\nbreak;\r\ncase GVCP_EVENT_CMD:\r\ndissect_event_cmd(gvcp_telegram_tree, tvb, pinfo, offset, data_length, extendedblockids);\r\nbreak;\r\ncase GVCP_EVENTDATA_CMD:\r\ndissect_eventdata_cmd(gvcp_telegram_tree, tvb, pinfo, offset, extendedblockids);\r\nbreak;\r\ncase GVCP_ACTION_CMD:\r\ndissect_action_cmd(gvcp_telegram_tree, tvb, pinfo, offset, scheduledactioncommand);\r\nbreak;\r\ncase GVCP_DISCOVERY_CMD:\r\ndefault:\r\nbreak;\r\n}\r\nif (!pinfo->fd->flags.visited)\r\n{\r\nif (key_code == 0x42)\r\n{\r\ngvcp_trans_array = (wmem_array_t*)wmem_map_lookup(gvcp_info->pdus, GUINT_TO_POINTER(request_id));\r\nif(gvcp_trans_array)\r\n{\r\nwmem_array_append(gvcp_trans_array, gvcp_trans, 1);\r\n}\r\nelse\r\n{\r\ngvcp_trans_array = wmem_array_new(wmem_file_scope(), sizeof(gvcp_transaction_t));\r\nwmem_array_append(gvcp_trans_array, gvcp_trans, 1);\r\nwmem_map_insert(gvcp_info->pdus, GUINT_TO_POINTER(request_id), (void *)gvcp_trans_array);\r\n}\r\n}\r\n}\r\n}\r\nelse\r\n{\r\nif (gvcp_telegram_tree != NULL)\r\n{\r\nif (gvcp_trans->req_frame)\r\n{\r\nitem = proto_tree_add_uint(gvcp_telegram_tree, hf_gvcp_response_to, tvb, 0, 0, gvcp_trans->req_frame);\r\nPROTO_ITEM_SET_GENERATED(item);\r\n}\r\n}\r\nswitch (ack_code)\r\n{\r\ncase GVCP_DISCOVERY_ACK:\r\ndissect_discovery_ack(gvcp_telegram_tree, tvb, pinfo, offset, data_length);\r\nbreak;\r\ncase GVCP_READREG_ACK:\r\ndissect_readreg_ack(gvcp_telegram_tree, tvb, pinfo, offset, data_length, gvcp_trans);\r\nbreak;\r\ncase GVCP_WRITEREG_ACK:\r\ndissect_writereg_ack(gvcp_telegram_tree, tvb, pinfo, offset, gvcp_trans);\r\nbreak;\r\ncase GVCP_READMEM_ACK:\r\ndissect_readmem_ack(gvcp_telegram_tree, tvb, pinfo, offset, data_length);\r\nbreak;\r\ncase GVCP_WRITEMEM_ACK:\r\ndissect_writemem_ack(gvcp_telegram_tree, tvb, pinfo, offset, data_length, gvcp_trans);\r\nbreak;\r\ncase GVCP_PENDING_ACK:\r\ndissect_pending_ack(gvcp_telegram_tree, tvb, pinfo, offset, data_length);\r\nbreak;\r\ncase GVCP_FORCEIP_ACK:\r\nbreak;\r\ncase GVCP_PACKETRESEND_ACK:\r\ncase GVCP_EVENT_ACK:\r\ncase GVCP_EVENTDATA_ACK:\r\ncase GVCP_ACTION_ACK:\r\ndefault:\r\nproto_tree_add_item(gvcp_telegram_tree, hf_gvcp_payloaddata, tvb, offset, data_length, ENC_NA);\r\nbreak;\r\n}\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid proto_register_gvcp(void)\r\n{\r\nstatic hf_register_info hf[] =\r\n{\r\n{ &hf_gvcp_message_key_code,\r\n{ "Message Key Code", "gvcp.message_key_code",\r\nFT_UINT8, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_flag,\r\n{ "Flags", "gvcp.cmd.flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_acknowledge_required_flag,\r\n{ "Acknowledge Required", "gvcp.cmd.flag.acq_required",\r\nFT_BOOLEAN, 8, NULL, 0x01,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_scheduledactioncommand_flag_v2_0,\r\n{ "Scheduled Action Command", "gvcp.cmd.flag.scheduledactioncommand",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_64bitid_flag_v2_0,\r\n{ "64 bit ID", "gvcp.cmd.flag.64bitid",\r\nFT_BOOLEAN, 8, NULL, 0x10,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_allow_broadcast_acknowledge_flag,\r\n{ "Allow Broadcast Acknowledge", "gvcp.cmd.flag.allowbroadcastacq",\r\nFT_BOOLEAN, 8, NULL, 0x10,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_command,\r\n{ "Command", "gvcp.cmd.command",\r\nFT_UINT16, BASE_HEX, VALS(commandnames), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_length,\r\n{ "Payload Length", "gvcp.cmd.payloadlength",\r\nFT_UINT16, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_request_id,\r\n{ "Request ID", "gvcp.cmd.req_id",\r\nFT_UINT16, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_payloaddata,\r\n{ "Payload Data", "gvcp.cmd.payloaddata",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_status,\r\n{ "Status", "gvcp.cmd.status",\r\nFT_UINT16, BASE_HEX, VALS(statusnames), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_acknowledge,\r\n{ "Acknowledge", "gvcp.ack",\r\nFT_UINT16, BASE_HEX, VALS(acknowledgenames), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_devicemodediscovery,\r\n{ "Device Mode", "gvcp.ack.discovery.devicemode",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_forceip_mac_address,\r\n{ "MAC Address", "gvcp.cmd.forceip.macaddress",\r\nFT_ETHER, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_forceip_static_IP,\r\n{ "IP address", "gvcp.cmd.forceip.ip",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_forceip_static_subnet_mask,\r\n{ "Subnet Mask", "gvcp.cmd.forceip.subnetmask",\r\nFT_IPv4, BASE_NETMASK, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_forceip_static_default_gateway,\r\n{ "Default Gateway", "gvcp.cmd.forceip.defaultgateway",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_device_mac_address,\r\n{ "Device MAC Address", "gvcp.cmd.discovery.devicemacaddress",\r\nFT_ETHER, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_readregcmd_bootstrap_register,\r\n{ "Bootstrap Register", "gvcp.cmd.readreg.bootstrapregister",\r\nFT_UINT32, BASE_HEX_DEC, VALS(bootstrapregisternames), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_writeregcmd_data,\r\n{ "DataX", "gvcp.cmd.writereg.data",\r\nFT_UINT32, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_writeregcmd_bootstrap_register,\r\n{ "Bootstrap Register", "gvcp.cmd.writereg.bootstrapregister",\r\nFT_UINT32, BASE_HEX_DEC, VALS(bootstrapregisternames), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_writeregcmd_data_index,\r\n{ "Data Index", "gvcp.cmd.writereg.dataindex",\r\nFT_UINT16, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_readmemcmd_address,\r\n{ "Register Address", "gvcp.cmd.readmem.address",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_readmemcmd_bootstrap_register,\r\n{ "Memory Bootstrap Register", "gvcp.cmd.readmem.bootstrapregister",\r\nFT_UINT32, BASE_HEX_DEC, VALS(bootstrapregisternames), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_readmemcmd_count,\r\n{ "Count", "gvcp.cmd.readmem.count",\r\nFT_UINT16, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_writememcmd_data,\r\n{ "DataY", "gvcp.cmd.writemem.data",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_writememcmd_data_index,\r\n{ "Data Index", "gvcp.cmd.writemem.dataindex",\r\nFT_UINT16, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_resendcmd_stream_channel_index,\r\n{ "Resend Stream Channel Index", "gvcp.cmd.resend.streamchannelindex",\r\nFT_UINT16, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_resendcmd_block_id,\r\n{ "Resend Block ID 16 bits", "gvcp.cmd.resend.blockid",\r\nFT_UINT16, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_resendcmd_first_packet_id,\r\n{ "Resend First Packet ID 24 bits", "gvcp.cmd.resend.firstpacketid",\r\nFT_UINT24, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_resendcmd_last_packet_id,\r\n{ "Resend Last Packet ID 24 bits", "gvcp.cmd.resend.lastpacketid",\r\nFT_UINT24, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_resendcmd_extended_block_id_v2_0,\r\n{ "Resend Block ID 64 bits", "gvcp.cmd.resend.extendedblockid",\r\nFT_UINT64, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_resendcmd_extended_first_packet_id_v2_0,\r\n{ "Resend First Packet ID 32 bits", "gvcp.cmd.resend.firstpacketid",\r\nFT_UINT32, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_resendcmd_extended_last_packet_id_v2_0,\r\n{ "Resend Last Packet ID 32 bits", "gvcp.cmd.resend.lastpacketid",\r\nFT_UINT32, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_eventcmd_id,\r\n{ "ID", "gvcp.cmd.event.id",\r\nFT_UINT16, BASE_HEX_DEC, VALS(eventidnames), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_eventcmd_error_id,\r\n{ "Error ID", "gvcp.cmd.event.errorid",\r\nFT_UINT16, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_eventcmd_device_specific_id,\r\n{ "Device Specific ID", "gvcp.cmd.event.devicespecificid",\r\nFT_UINT16, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_eventcmd_stream_channel_index,\r\n{ "Stream Channel Index", "gvcp.cmd.event.streamchannelindex",\r\nFT_UINT16, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_eventcmd_block_id,\r\n{ "Block ID (16 bit)", "gvcp.cmd.event.blockid",\r\nFT_UINT16, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_eventcmd_timestamp,\r\n{ "Timestamp", "gvcp.cmd.event.timestamp",\r\nFT_UINT64, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_eventcmd_block_id_64bit_v2_0,\r\n{ "Block ID 64 bit", "gvcp.event_timestamp",\r\nFT_UINT64, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_eventcmd_data,\r\n{ "Event Data", "gvcp.cmd.eventdata.data",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_actioncmd_device_key,\r\n{ "Action Device Key", "gvcp.cmd.action.devicekey",\r\nFT_UINT32, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_actioncmd_group_key,\r\n{ "Action Group Key", "gvcp.cmd.action.groupkey",\r\nFT_UINT32, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_actioncmd_group_mask,\r\n{ "Action Group Mask", "gvcp.cmd.action.groupmask",\r\nFT_UINT32, BASE_HEX_DEC, NULL, 0xFFFFFFFF,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_actioncmd_time_v2_0,\r\n{ "Action Scheduled Time", "gvcp.cmd.action.time",\r\nFT_UINT64, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_time_to_completion,\r\n{ "Time to completion", "gvcp.ack.pendingack.timetocompletion",\r\nFT_UINT16, BASE_HEX_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_spec_version_major,\r\n{ "Version Major", "gvcp.bootstrap.specversion.major",\r\nFT_UINT32, BASE_HEX, NULL, 0xFFFF0000,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_spec_version_minor,\r\n{ "Version Minor", "gvcp.bootstrap.specversion.minor",\r\nFT_UINT32, BASE_HEX, NULL, 0x0000FFFF,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_spec_version,\r\n{ "Spec Version", "gvcp.bootstrap.specversion",\r\nFT_UINT32, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_devicemode_endianess,\r\n{ "Endianness", "gvcp.bootstrap.devicemode.endianess",\r\nFT_BOOLEAN, 32, NULL, 0x80000000,\r\nNULL, HFILL\r\n}},\r\n{ &hf_gvcp_devicemode_deviceclass,\r\n{ "Device Class", "gvcp.bootstrap.devicemode.deviceclass",\r\nFT_UINT32, BASE_HEX, VALS(devicemodenames_class), 0x70000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_devicemode_characterset,\r\n{ "Character Set", "gvcp.bootstrap.devicemode.characterset",\r\nFT_UINT32, BASE_HEX, VALS(devicemodenames_characterset), 0x0000000F,\r\nNULL, HFILL\r\n}},\r\n{ &hf_gvcp_machigh,\r\n{ "MAC High", "gvcp.bootstrap.machigh",\r\nFT_UINT32, BASE_HEX, NULL, 0x0000FFFF,\r\nNULL, HFILL\r\n}},\r\n{ &hf_gvcp_maclow,\r\n{ "MAC Low", "gvcp.bootstrap.maclow",\r\nFT_UINT32, BASE_HEX, NULL, 0,\r\nNULL, HFILL\r\n}},\r\n{ &hf_gvcp_ip_config_can_handle_pause_frames_v2_0,\r\n{ "IP Config Can Handle Pause Frames", "gvcp.bootstrap.ipconfig.canhandlepauseframes",\r\nFT_BOOLEAN, 32, NULL, 0x80000000,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_ip_config_can_generate_pause_frames_v2_0,\r\n{ "Can Generate Pause Frames", "gvcp.bootstrap.ipconfig.cangeneratepauseframes",\r\nFT_BOOLEAN, 32, NULL, 0x40000000,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_ip_config_lla,\r\n{ "LLA", "gvcp.bootstrap.ipconfig.lla",\r\nFT_BOOLEAN, 32, NULL, 0x00000004,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_ip_config_dhcp,\r\n{ "DHCP", "gvcp.bootstrap.ipconfig.dhcp",\r\nFT_BOOLEAN, 32, NULL, 0x00000002,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_ip_config_persistent_ip,\r\n{ "Persistent IP", "gvcp.bootstrap.ipconfig.persistentip",\r\nFT_BOOLEAN, 32, NULL, 0x00000001,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_supportedipconfig,\r\n{ "Supported IP Configuration", "gvcp.bootstrap.supportedipconfig",\r\nFT_UINT32, BASE_HEX, NULL, 0,\r\nNULL, HFILL\r\n}},\r\n{ &hf_gvcp_currentipconfig,\r\n{ "Current IP Configuration", "gvcp.bootstrap.currentipconfig",\r\nFT_UINT32, BASE_HEX, NULL, 0,\r\nNULL, HFILL\r\n}},\r\n{ &hf_gvcp_current_IP,\r\n{ "Current IP", "gvcp.bootstrap.currentip",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_current_subnet_mask,\r\n{ "Subnet Mask", "gvcp.bootstrap.currentsubnetmask",\r\nFT_IPv4, BASE_NETMASK, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_current_default_gateway,\r\n{ "Default Gateway", "gvcp.bootstrap.currentdefaultgateway",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_manufacturer_name,\r\n{ "Manufacturer Name", "gvcp.bootstrap.manufacturername",\r\nFT_STRINGZ, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_model_name,\r\n{ "Model Name", "gvcp.bootstrap.modelname",\r\nFT_STRINGZ, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_device_version,\r\n{ "Device Version", "gvcp.bootstrap.deviceversion",\r\nFT_STRINGZ, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_manufacturer_specific_info,\r\n{ "Manufacturer Specific Info", "gvcp.bootstrap.manufacturerspecificinfo",\r\nFT_STRINGZ, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_serial_number,\r\n{ "Serial Number", "gvcp.bootstrap.serialnumber",\r\nFT_STRINGZ, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_user_defined_name,\r\n{ "User-defined Name", "gvcp.bootstrap.userdefinedname",\r\nFT_STRINGZ, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_first_xml_device_description_file,\r\n{ "First URL", "gvcp.bootstrap.firsturl",\r\nFT_STRINGZ, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_gvcp_second_xml_device_description_file,\r\n{ "Second URL", "gvcp.bootstrap.secondurl",\r\nFT_STRINGZ, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{& hf_gvcp_number_interfaces,\r\n{ "Number of Network Interfaces", "gvcp.bootstrap.numberofnetworminterfaces",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_persistent_ip,\r\n{ "Persistent IP", "gvcp.bootstrap.persistentip",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_persistent_subnet,\r\n{ "Persistent Subnet Mask", "gvcp.bootstrap.persistentsubnetmask",\r\nFT_IPv4, BASE_NETMASK, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_persistent_gateway,\r\n{ "Persistent GateWay", "gvcp.bootstrap.persistentgateway",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_link_speed,\r\n{ "Link Speed (in Mbs)", "gvcp.bootstrap.linkspeed",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_number_message_channels,\r\n{ "Number of Message Channels", "gvcp.bootstrap.numberofmessagechannels",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_number_stream_channels,\r\n{ "Number of Stream Channels", "gvcp.bootstrap.numberofstreamchannels",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_number_action_signals,\r\n{ "Number of Action Signals", "gvcp.bootstrap.numberofactionsignals",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_number_of_active_links_v2_0,\r\n{ "Number of Active Links", "gvcp.bootstrap.numberofactivelinks",\r\nFT_UINT32, BASE_DEC, NULL, 0x0000000F,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sccaps_scspx_register_supported,\r\n{ "SCSPx Register Supporteed", "gvcp.bootstrap.sccaps.scspxregistersupported",\r\nFT_BOOLEAN, 32, NULL, 0x80000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sccaps_legacy_16bit_blockid_supported_v2_0,\r\n{ "16 bit Block ID Supported", "gvcp.bootstrap.sccaps.16bitblockidsupported",\r\nFT_BOOLEAN, 32, NULL, 0x40000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_mcsp_supported,\r\n{ "MCSP Supported", "gvcp.bootstrap.mccaps.mcspsupported",\r\nFT_BOOLEAN, 32, NULL, 0x80000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_capability_user_defined,\r\n{ "User Defined Name Supported", "gvcp.bootstrap.capability.userdefined",\r\nFT_BOOLEAN, 32, NULL, 0x80000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_capability_serial_number,\r\n{ "Serial Number Supported", "gvcp.bootstrap.capability.serialnumber",\r\nFT_BOOLEAN, 32, NULL, 0x40000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_capability_heartbeat_disable,\r\n{ "Heartbeat Disable Supported", "gvcp.bootstrap.capability.heartbeatdisabled",\r\nFT_BOOLEAN, 32, NULL, 0x20000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_capability_link_speed,\r\n{ "Link Speed Supported", "gvcp.bootstrap.capability.linkspeed",\r\nFT_BOOLEAN, 32, NULL, 0x10000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_capability_ccp_application_portip,\r\n{ "CCP Application Port/IP Supported", "gvcp.bootstrap.capability.ccpapplicationportip",\r\nFT_BOOLEAN, 32, NULL, 0x08000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_capability_manifest_table,\r\n{ "Manifest Table Supported", "gvcp.bootstrap.capability.manifesttable",\r\nFT_BOOLEAN, 32, NULL, 0x04000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_capability_test_data,\r\n{ "Test Data Supported", "gvcp.bootstrap.capability.testdata",\r\nFT_BOOLEAN, 32, NULL, 0x02000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_capability_discovery_ACK_delay,\r\n{ "Discovery ACK Delay Supported", "gvcp.bootstrap.capability.discoveryackdelay",\r\nFT_BOOLEAN, 32, NULL, 0x01000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_capability_writable_discovery_ACK_delay,\r\n{ "Writable Discovery ACK Delay Supported", "gvcp.bootstrap.capability.writablediscoveryackdelay",\r\nFT_BOOLEAN, 32, NULL, 0x00800000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_capability_extended_status_code_v1_1,\r\n{ "Extended Status Code Supported (v1.1)", "gvcp.bootstrap.capability.extendedstatuscodesupportedv1_1",\r\nFT_BOOLEAN, 32, NULL, 0x00400000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_capability_primary_application_switchover,\r\n{ "Primary Application Switchover Supported", "gvcp.bootstrap.capability.primaryapplicationswitchover",\r\nFT_BOOLEAN, 32, NULL, 0x00200000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_capability_unconditional_action_command,\r\n{ "Unconditional Action Command Supported", "gvcp.bootstrap.capability.unconditionalactioncommand",\r\nFT_BOOLEAN, 32, NULL, 0x00100000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_capability_1588_v2_0,\r\n{ "Capability 1588", "gvcp.bootstrap.capability.ieee1588",\r\nFT_BOOLEAN, 32, NULL, 0x00080000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_capability_extended_status_code_v2_0,\r\n{ "Status Code", "gvcp.bootstrap.capability.pendingextendedstatuscodev2_0",\r\nFT_BOOLEAN, 32, NULL, 0x00040000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_capability_scheduled_action_command_v2_0,\r\n{ "Scheduled Action Command", "gvcp.bootstrap.capability.scheduledactioncommand",\r\nFT_BOOLEAN, 32, NULL, 0x00020000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_capability_action_command,\r\n{ "Action Command", "gvcp.bootstrap.capability.actioncommand",\r\nFT_BOOLEAN, 32, NULL, 0x00000040,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_capability_pending,\r\n{ "Pending ACK Supported", "gvcp.bootstrap.capability.pendingack",\r\nFT_BOOLEAN, 32, NULL, 0x00000020,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_capability_evendata,\r\n{ "Eventdata Supported", "gvcp.bootstrap.capability.eventdata",\r\nFT_BOOLEAN, 32, NULL, 0x00000010,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_capability_event,\r\n{ "Event Signal Supported", "gvcp.bootstrap.capability.eventsignal",\r\nFT_BOOLEAN, 32, NULL, 0x00000008,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_capability_packetresend,\r\n{ "Packet Resend CMD Supported", "gvcp.bootstrap.capability.packetresendcmd",\r\nFT_BOOLEAN, 32, NULL, 0x00000004,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_capability_writemem,\r\n{ "WRITEMEM Supported", "gvcp.bootstrap.capability.writemem",\r\nFT_BOOLEAN, 32, NULL, 0x00000002,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_capability_concatenation,\r\n{ "Concatenation Supported", "gvcp.bootstrap.capability.concatenation",\r\nFT_BOOLEAN, 32, NULL, 0x00000001,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_heartbeat,\r\n{ "Heartbeat Timeout (in ms)", "gvcp.bootstrap.heartbeattimeout",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_high_timestamp_frequency,\r\n{ "Timestamp Tick High Frequency (in Hz)", "gvcp.bootstrap.timestamptickfrequencyhigh",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_low_timestamp_frequency,\r\n{ "Timestamp Tick Low Frequency (in Hz)", "gvcp.bootstrap.timestamptickfrequencylow",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_timestamp_control_latch,\r\n{ "Timestamp Control Latch", "gvcp.bootstrap.timestampcontrol.latch",\r\nFT_BOOLEAN, 32, NULL, 0x00000002,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_timestamp_control_reset,\r\n{ "Timestamp Control Reset", "gvcp.bootstrap.timestampcontrol.reset",\r\nFT_BOOLEAN, 32, NULL, 0x00000001,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_high_timestamp_value,\r\n{ "Timestamp Value High", "gvcp.bootstrap.timestampvaluehigh",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_low_timestamp_value,\r\n{ "Timestamp Value Low", "gvcp.bootstrap.timestampvaluelow",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_discovery_ACK_delay,\r\n{ "Discovery ACK Delay (in ms)", "gvcp.bootstrap.discoveryackdelay",\r\nFT_UINT32, BASE_DEC, NULL, 0x0000FFFF,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_configuration_1588_enable_v2_0,\r\n{ "IEEE 1588 Enable", "gvcp.bootstrap.config.ieee1588enable",\r\nFT_BOOLEAN, 32, NULL, 0x00080000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_configuration_extended_status_codes_enable_v2_0,\r\n{ "Status Codes v2.0 Enable", "gvcp.bootstrap.config.statuscodesv2_0enable",\r\nFT_BOOLEAN, 32, NULL, 0x00040000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_configuration_unconditional_action_command_enable_v2_0,\r\n{ "Unconditional Action Command Enable", "gvcp.bootstrap.config.unconditionalactioncommandenable",\r\nFT_BOOLEAN, 32, NULL, 0x00000008,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_configuration_extended_status_codes_enable_v1_1,\r\n{ "Status Codes v1.1 Enable", "gvcp.bootstrap.config.statuscodesv1_1enable",\r\nFT_BOOLEAN, 32, NULL, 0x00000004,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_configuration_pending_ack_enable,\r\n{ "Pending_ACK Enable", "gvcp.bootstrap.config.pendingackenable",\r\nFT_BOOLEAN, 32, NULL, 0x00000002,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_configuration_heartbeat_disable,\r\n{ "Heartbeat Disable", "gvcp.bootstrap.config.heartbeatdisable",\r\nFT_BOOLEAN, 32, NULL, 0x00000001,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_pending_timeout_max_execution,\r\n{ "Pending Timeout (in ms)", "gvcp.bootstrap.pending.timeout",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_control_switchover_key_register,\r\n{ "Control Switchover Key", "gvcp.bootstrap.controlswitchoverkey",\r\nFT_UINT32, BASE_DEC, NULL, 0x0000FFFF,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_gvsp_configuration_64bit_blockid_enable_v2_0,\r\n{ "GVSP Configuration 64 bit Block ID", "gvcp.bootstrap.gvcspconfig.64bitblockidenable",\r\nFT_BOOLEAN, 32, NULL, 0x40000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_link_dlag_v2_0,\r\n{ "Link dLAG", "gvcp.bootstrap.link.dlag",\r\nFT_BOOLEAN, 32, NULL, 0x00000008,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_link_slag_v2_0,\r\n{ "Link sLAG", "gvcp.bootstrap.link.slag",\r\nFT_BOOLEAN, 32, NULL, 0x00000004,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_link_ml_v2_0,\r\n{ "Link ML", "gvcp.bootstrap.link.ml",\r\nFT_BOOLEAN, 32, NULL, 0x00000002,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_link_sl_v2_0,\r\n{ "Link SL", "gvcp.bootstrap.link.sl",\r\nFT_BOOLEAN, 32, NULL, 0x00000001,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_ieee1588_clock_status_v2_0,\r\n{ "IEEE 1588 Clock Status", "gvcp.bootstrap.ieee1588.clockstatus",\r\nFT_UINT32, BASE_HEX, NULL, 0x0000000F,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_scheduled_action_command_queue_size_v2_0,\r\n{ "Scheduled Action Command Queue Size", "gvcp.bootstrap.scheduledactioncommandqueuesize",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_control_switchover_key,\r\n{ "Control Switchover Key", "gvcp.bootstrap.control.switchoverkey",\r\nFT_UINT32, BASE_HEX, NULL, 0xFFFF0000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_control_switchover_en,\r\n{ "Control Switchover Enable", "gvcp.bootstrap.control.switchoverenable",\r\nFT_BOOLEAN, 32, NULL, 0x00000004,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_control_access,\r\n{ "Control Access", "gvcp.bootstrap.control.controlaccess",\r\nFT_BOOLEAN, 32, NULL, 0x00000002,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_exclusive_access,\r\n{ "Exclusive Access", "gvcp.bootstrap.control.exclusiveaccess",\r\nFT_BOOLEAN, 32, NULL, 0x00000001,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_primary_application_host_port,\r\n{ "Primary Application Port", "gvcp.bootstrap.primaryapplicationport",\r\nFT_UINT32, BASE_DEC, NULL, 0x0000FFFF,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_primary_application_ip_address,\r\n{ "Primary Application IP Address", "gvcp.bootstrap.primaryapplicationipaddress",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_network_interface_index,\r\n{ "Network Interface Index", "gvcp.bootstrap.mcp.networkinterfaceindex",\r\nFT_UINT32, BASE_DEC, NULL, 0x000F0000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_host_port,\r\n{ "Host Port", "gvcp.bootstrap.mcp.hostport",\r\nFT_UINT32, BASE_DEC, NULL, 0x0000FFFF,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_channel_destination_ip,\r\n{ "Destination IP Address", "gvcp.bootstrap.mcda",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_message_channel_transmission_timeout,\r\n{ "Transmission Timeout (in ms)", "gvcp.bootstrap.mctt",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_message_channel_retry_count,\r\n{ "Retry Count", "gvcp.bootstrap.mcrc",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_message_channel_source_port,\r\n{ "Source Port", "gvcp.bootstrap.mcsp",\r\nFT_UINT32, BASE_DEC, NULL, 0x0000FFFF,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_direction,\r\n{ "Direction", "gvcp.bootstrap.scpx.direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x80000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_ni_index,\r\n{ "Network Interface Index", "gvcp.bootstrap.scpx.networkinterfaceindex",\r\nFT_UINT32, BASE_DEC, NULL, 0x000F0000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_host_port,\r\n{ "Host Port", "gvcp.bootstrap.scpx.hostport",\r\nFT_UINT32, BASE_DEC, NULL, 0x0000FFFF,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_fire_test_packet,\r\n{ "Fire Test Packet", "gvcp.bootstrap.scpsx.firetestpacket",\r\nFT_BOOLEAN, 32, NULL, 0x80000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_do_not_fragment,\r\n{ "Do Not Fragment", "gvcp.bootstrap.scpsx.donotfragment",\r\nFT_BOOLEAN, 32, NULL, 0x40000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_pixel_endianness,\r\n{ "Pixel Endianness", "gvcp.bootstrap.scpsx.pixelendianness",\r\nFT_BOOLEAN, 32, NULL, 0x20000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_packet_size,\r\n{ "Packet Size", "gvcp.bootstrap.scpsx.packetsize",\r\nFT_UINT32, BASE_DEC, NULL, 0x0000FFFF,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_packet_delay,\r\n{ "Packet Delay", "gvcp.bootstrap.scpdx",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_destination_ip,\r\n{ "Destination Address", "gvcp.bootstrap.scdax",\r\nFT_IPv4, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_source_port,\r\n{ "Source Port", "gvcp.bootstrap.scspx",\r\nFT_UINT32, BASE_DEC, NULL, 0x0000FFFF,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_big_little_endian_supported,\r\n{ "Big/Little Endian Supported", "gvcp.bootstrap.sccx.biglittleendiansupported",\r\nFT_BOOLEAN, 32, NULL, 0x80000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_ip_reassembly_supported,\r\n{ "IP Reassembly Supported", "gvcp.bootstrap.sccx.ipreassemblysupported",\r\nFT_BOOLEAN, 32, NULL, 0x40000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_multizone_supported_v2_0,\r\n{ "Multizone Supported", "gvcp.bootstrap.sccx.multizonesupported",\r\nFT_BOOLEAN, 32, NULL, 0x00000010,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_packet_resend_destination_option_supported_v2_0,\r\n{ "Resend Destination Option Supported", "gvcp.bootstrap.sccx.resenddestinationoptionsupported",\r\nFT_BOOLEAN, 32, NULL, 0x8,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_packet_resend_all_in_transmission_supported_v2_0,\r\n{ "All In Transmission Supported", "gvcp.bootstrap.sccx.allintransmissionsupported",\r\nFT_BOOLEAN, 32, NULL, 0x4,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_unconditional_streaming_supported,\r\n{ "Unconditional Streaming Supported", "gvcp.bootstrap.sccx.unconditionalstreamingsupported",\r\nFT_BOOLEAN, 32, NULL, 0x2,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_extended_chunk_data_supported,\r\n{ "Extended Chunk Data Supported", "gvcp.bootstrap.sccx.extendedchunkdatasupported",\r\nFT_BOOLEAN, 32, NULL, 0x1,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_packet_resend_destination_option_enabled_v2_0,\r\n{ "Resend Destination Option Enabled", "gvcp.bootstrap.sccfgx.resenddestinationoptionenabled",\r\nFT_BOOLEAN, 32, NULL, 0x8,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_packet_resend_all_in_transmission_enabled_v2_0,\r\n{ "All In Transmission Enabled", "gvcp.bootstrap.sccfgx.allintransmissionenabled",\r\nFT_BOOLEAN, 32, NULL, 0x4,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_unconditional_streaming_enabled,\r\n{ "Unconditional Streaming Enabled", "gvcp.bootstrap.sccfgx.unconditionalstreamingenabled",\r\nFT_BOOLEAN, 32, NULL, 0x2,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_extended_chunk_data_enabled,\r\n{ "Extended Chunk Data Enabled", "gvcp.bootstrap.sccfgx.extendedchunkdataenabled",\r\nFT_BOOLEAN, 32, NULL, 0x1,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_additional_zones_v2_0,\r\n{ "Additional Zones", "gvcp.bootstrap.sczx.additionalzones",\r\nFT_UINT32, BASE_DEC, NULL, 0x0000000F,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone0_direction_v2_0,\r\n{ "Zone 0 Direction", "gvcp.bootstrap.sczdx.zone0direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x80000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone1_direction_v2_0,\r\n{ "Zone 1 Direction", "gvcp.bootstrap.sczdx.zone1direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x40000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone2_direction_v2_0,\r\n{ "Zone 2 Direction", "gvcp.bootstrap.sczdx.zone2direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x20000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone3_direction_v2_0,\r\n{ "Zone 3 Direction", "gvcp.bootstrap.sczdx.zone3direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x10000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone4_direction_v2_0,\r\n{ "Zone 4 Direction", "gvcp.bootstrap.sczdx.zone4direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x08000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone5_direction_v2_0,\r\n{ "Zone 5 Direction", "gvcp.bootstrap.sczdx.zone5direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x04000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone6_direction_v2_0,\r\n{ "Zone 6 Direction", "gvcp.bootstrap.sczdx.zone6direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x02000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone7_direction_v2_0,\r\n{ "Zone 7 Direction", "gvcp.bootstrap.sczdx.zone7direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x01000000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone8_direction_v2_0,\r\n{ "Zone 8 Direction", "gvcp.bootstrap.sczdx.zone8direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00800000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone9_direction_v2_0,\r\n{ "Zone 9 Direction", "gvcp.bootstrap.sczdx.zone9direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00400000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone10_direction_v2_0,\r\n{ "Zone 10 Direction", "gvcp.bootstrap.sczdx.zone10direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00200000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone11_direction_v2_0,\r\n{ "Zone 11 Direction", "gvcp.bootstrap.sczdx.zone1direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00100000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone12_direction_v2_0,\r\n{ "Zone 12 Direction", "gvcp.bootstrap.sczdx.zone12direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00080000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone13_direction_v2_0,\r\n{ "Zone 13 Direction", "gvcp.bootstrap.sczdx.zone13direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00040000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone14_direction_v2_0,\r\n{ "Zone 14 Direction", "gvcp.bootstrap.sczdx.zone14direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00020000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone15_direction_v2_0,\r\n{ "Zone 15 Direction", "gvcp.bootstrap.sczdx.zone15direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00010000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone16_direction_v2_0,\r\n{ "Zone 16 Direction", "gvcp.bootstrap.sczdx.zone16direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00008000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone17_direction_v2_0,\r\n{ "Zone 17 Direction", "gvcp.bootstrap.sczdx.zone17direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00004000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone18_direction_v2_0,\r\n{ "Zone 18 Direction", "gvcp.bootstrap.sczdx.zone18direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00002000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone19_direction_v2_0,\r\n{ "Zone 19 Direction", "gvcp.bootstrap.sczdx.zone19direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00001000,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone20_direction_v2_0,\r\n{ "Zone 20 Direction", "gvcp.bootstrap.sczdx.zone20direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00000800,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone21_direction_v2_0,\r\n{ "Zone 21 Direction", "gvcp.bootstrap.sczdx.zone21direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00000400,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone22_direction_v2_0,\r\n{ "Zone 22 Direction", "gvcp.bootstrap.sczdx.zone22direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00000200,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone23_direction_v2_0,\r\n{ "Zone 23 Direction", "gvcp.bootstrap.sczdx.zone23direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00000100,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone24_direction_v2_0,\r\n{ "Zone 24 Direction", "gvcp.bootstrap.sczdx.zone24direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00000080,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone25_direction_v2_0,\r\n{ "Zone 25 Direction", "gvcp.bootstrap.sczdx.zone25direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00000040,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone26_direction_v2_0,\r\n{ "Zone 26 Direction", "gvcp.bootstrap.sczdx.zone26direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00000020,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone27_direction_v2_0,\r\n{ "Zone 27 Direction", "gvcp.bootstrap.sczdx.zone27direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00000010,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone28_direction_v2_0,\r\n{ "Zone 28 Direction", "gvcp.bootstrap.sczdx.zone28direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00000008,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone29_direction_v2_0,\r\n{ "Zone 29 Direction", "gvcp.bootstrap.sczdx.zone29direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00000004,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone30_direction_v2_0,\r\n{ "Zone 30 Direction", "gvcp.bootstrap.sczdx.zone30direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00000002,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_sc_zone31_direction_v2_0,\r\n{ "Zone 31 Direction", "gvcp.bootstrap.sczdx.zone31direction",\r\nFT_BOOLEAN, 32, TFS(&directionnames), 0x00000001,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_action_group_key,\r\n{ "Action Group Key", "gvcp.bootstrap.actiongroupkey",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_action_group_mask,\r\n{ "Action Group Mask", "gvcp.bootstrap.actiongroupmask",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_custom_register_addr,\r\n{ "Custom Register Address", "gvcp.bootstrap.custom.register.write",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_custom_memory_addr,\r\n{ "Custom Memory Address", "gvcp.bootstrap.custom.register.write",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL\r\n}},\r\n{& hf_gvcp_response_in,\r\n{ "Response In", "gvcp.response_in",\r\nFT_FRAMENUM, BASE_NONE, NULL, 0x0,\r\n"The response to this GVCP request is in this frame", HFILL\r\n}},\r\n{& hf_gvcp_response_to,\r\n{ "Request In", "gvcp.response_to",\r\nFT_FRAMENUM, BASE_NONE, NULL, 0x0,\r\n"This is a response to the GVCP request in this frame", HFILL\r\n}},\r\n{ &hf_gvcp_reserved_bit, { "Reserved Bit", "gvcp.reserved_bit", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_gvcp_manifest_table, { "Manifest Table", "gvcp.manifest_table", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_gvcp_custom_register_value, { "Value", "gvcp.bootstrap.custom.register.value", FT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_gvcp_custom_read_register_addr, { "Custom Register Address", "gvcp.bootstrap.custom.register.read", FT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_gvcp_custom_read_register_value, { "Custom Register Value", "gvcp.bootstrap.custom.register.read_value", FT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_gvcp_readmemcmd_data_read, { "Data read", "gvcp.cmd.readmem.data", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_gvcp,\r\n&ett_gvcp_cmd,\r\n&ett_gvcp_flags,\r\n&ett_gvcp_ack,\r\n&ett_gvcp_payload_cmd,\r\n&ett_gvcp_payload_ack,\r\n&ett_gvcp_payload_ack_subtree,\r\n&ett_gvcp_payload_cmd_subtree,\r\n&ett_gvcp_bootstrap_fields\r\n};\r\nproto_gvcp = proto_register_protocol("GigE Vision Control Protocol", "GVCP", "gvcp");\r\ngvcp_handle = register_dissector("gvcp", dissect_gvcp, proto_gvcp);\r\nproto_register_field_array(proto_gvcp, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid proto_reg_handoff_gvcp(void)\r\n{\r\ndissector_add_uint("udp.port", global_gvcp_port, gvcp_handle);\r\n}
