static guint dissect_llrp_utf8_parameter(tvbuff_t * const tvb, packet_info *pinfo,\r\nproto_tree * const tree, const guint hfindex, const guint offset)\r\n{\r\ngint len;\r\nlen = tvb_get_ntohs(tvb, offset);\r\nif(tvb_reported_length_remaining(tvb, offset) < len) {\r\nexpert_add_info_format(pinfo, tree, &ei_llrp_invalid_length,\r\n"invalid length of string: claimed %u, available %u.",\r\nlen, tvb_reported_length_remaining(tvb, offset));\r\nreturn offset + 2;\r\n}\r\nproto_tree_add_item(tree, hfindex, tvb,\r\noffset, 2, ENC_BIG_ENDIAN | ENC_UTF_8);\r\nreturn offset + len + 2;\r\n}\r\nstatic guint dissect_llrp_bit_field(tvbuff_t * const tvb,\r\nproto_tree * const tree, const guint hfindex, const guint offset)\r\n{\r\nguint len;\r\nlen = tvb_get_ntohs(tvb, offset);\r\nlen = (len + 7) / 8;\r\nproto_tree_add_item(tree, hf_llrp_length_bits, tvb,\r\noffset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hfindex, tvb,\r\noffset + 2, len, ENC_NA);\r\nreturn offset + len + 2;\r\n}\r\nstatic guint dissect_llrp_word_array(tvbuff_t * const tvb,\r\nproto_tree * const tree, const guint hfindex, const guint offset)\r\n{\r\nguint len;\r\nlen = tvb_get_ntohs(tvb, offset);\r\nlen *= 2;\r\nproto_tree_add_item(tree, hf_llrp_length_words, tvb,\r\noffset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hfindex, tvb,\r\noffset + 2, len, ENC_NA);\r\nreturn offset + len + 2;\r\n}\r\nstatic guint dissect_llrp_item_array(tvbuff_t * const tvb, packet_info *pinfo,\r\nproto_tree * const tree, const guint hfindex_number,\r\nconst guint hfindex_item, const guint item_size, guint offset)\r\n{\r\nguint num;\r\nnum = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_item(tree, hfindex_number, tvb,\r\noffset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nif(tvb_reported_length_remaining(tvb, offset) < ((gint)(num*item_size))) {\r\nexpert_add_info_format(pinfo, tree, &ei_llrp_invalid_length,\r\n"Array longer than message");\r\nreturn offset + tvb_reported_length_remaining(tvb, offset);\r\n}\r\nwhile(num--) {\r\nproto_tree_add_item(tree, hfindex_item, tvb,\r\noffset, item_size, item_size == 1 ? ENC_NA : ENC_BIG_ENDIAN);\r\noffset += item_size;\r\n}\r\nreturn offset;\r\n}\r\nstatic guint\r\ndissect_llrp_impinj_parameter(tvbuff_t *tvb, packet_info *pinfo, proto_tree *param_tree,\r\nguint suboffset, const guint param_end)\r\n{\r\nguint32 subtype;\r\nsubtype = tvb_get_ntohl(tvb, suboffset);\r\nproto_item_append_text(param_tree, " (Impinj - %s)",\r\nval_to_str_ext(subtype, &impinj_param_type_ext, "Unknown Type: %d"));\r\nproto_tree_add_item(param_tree, hf_llrp_impinj_param_type, tvb, suboffset, 4, ENC_BIG_ENDIAN);\r\nsuboffset += 4;\r\nswitch(subtype) {\r\ncase LLRP_IMPINJ_PARAM_TAG_INFORMATION:\r\ncase LLRP_IMPINJ_PARAM_FORKLIFT_CONFIGURATION:\r\ncase LLRP_IMPINJ_PARAM_ACCESS_SPEC_CONFIGURATION:\r\ncase LLRP_IMPINJ_PARAM_TAG_REPORT_CONTENT_SELECTOR:\r\ncase LLRP_IMPINJ_PARAM_GPS_NMEA_SENTENCES:\r\ncase LLRP_IMPINJ_PARAM_HUB_VERSIONS:\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_REQUESTED_DATA:\r\nPARAM_TREE_ADD(impinj_req_data, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_SUBREGULATORY_REGION:\r\nPARAM_TREE_ADD(impinj_reg_region, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_INVENTORY_SEARCH_MODE:\r\nPARAM_TREE_ADD(impinj_search_mode, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_TAG_DIRECTION_REPORTING:\r\nPARAM_TREE_ADD(impinj_en_tag_dir, 2, ENC_NA);\r\nPARAM_TREE_ADD(impinj_antenna_conf, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(rfu, 4, ENC_NA);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_TAG_DIRECTION:\r\nPARAM_TREE_ADD(decision_time, 8, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(impinj_tag_dir, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(confidence, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_FIXED_FREQUENCY_LIST:\r\nPARAM_TREE_ADD(impinj_fix_freq_mode, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(rfu, 2, ENC_NA);\r\nsuboffset = dissect_llrp_item_array(tvb, pinfo, param_tree,\r\nhf_llrp_num_channels, hf_llrp_channel, 2, suboffset);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_REDUCED_POWER_FREQUENCY_LIST:\r\nPARAM_TREE_ADD(impinj_reduce_power_mode, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(rfu, 2, ENC_NA);\r\nsuboffset = dissect_llrp_item_array(tvb, pinfo, param_tree,\r\nhf_llrp_num_channels, hf_llrp_channel, 2, suboffset);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_LOW_DUTY_CYCLE:\r\nPARAM_TREE_ADD(impinj_low_duty_mode, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(empty_field_timeout, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(field_ping_interval, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_DETAILED_VERSION:\r\nsuboffset = dissect_llrp_utf8_parameter(tvb, pinfo, param_tree, hf_llrp_model_name, suboffset);\r\nsuboffset = dissect_llrp_utf8_parameter(tvb, pinfo, param_tree, hf_llrp_serial_number, suboffset);\r\nsuboffset = dissect_llrp_utf8_parameter(tvb, pinfo, param_tree, hf_llrp_soft_ver, suboffset);\r\nsuboffset = dissect_llrp_utf8_parameter(tvb, pinfo, param_tree, hf_llrp_firm_ver, suboffset);\r\nsuboffset = dissect_llrp_utf8_parameter(tvb, pinfo, param_tree, hf_llrp_fpga_ver, suboffset);\r\nsuboffset = dissect_llrp_utf8_parameter(tvb, pinfo, param_tree, hf_llrp_pcba_ver, suboffset);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_FREQUENCY_CAPABILITIES:\r\nsuboffset = dissect_llrp_item_array(tvb, pinfo, param_tree,\r\nhf_llrp_num_freqs, hf_llrp_frequency, 4, suboffset);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_FORKLIFT_HEIGHT_THRESHOLD:\r\nPARAM_TREE_ADD(height_thresh, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_FORKLIFT_ZEROMOTION_TIME_THRESHOLD:\r\nPARAM_TREE_ADD(zero_motion_thresh, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_FORKLIFT_COMPANION_BOARD_INFO:\r\nsuboffset = dissect_llrp_utf8_parameter(tvb, pinfo, param_tree, hf_llrp_board_manufacturer, suboffset);\r\nPARAM_TREE_ADD(fw_ver_hex, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(hw_ver_hex, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_GPI_DEBOUNCE_CONFIGURATION:\r\nPARAM_TREE_ADD(gpi_port, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(gpi_debounce, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_READER_TEMPERATURE:\r\nPARAM_TREE_ADD(temperature, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_LINK_MONITOR_CONFIGURATION:\r\nPARAM_TREE_ADD(impinj_link_monitor_mode, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(link_down_thresh, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_REPORT_BUFFER_CONFIGURATION:\r\nPARAM_TREE_ADD(impinj_report_buff_mode, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_BLOCK_WRITE_WORD_COUNT:\r\nPARAM_TREE_ADD(word_count, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_BLOCK_PERMALOCK:\r\nPARAM_TREE_ADD(opspec_id, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(access_pass, 4, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(mb, 1, ENC_NA);\r\nPARAM_TREE_ADD(block_pointer, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(block_mask, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_BLOCK_PERMALOCK_OPSPEC_RESULT:\r\nPARAM_TREE_ADD(permalock_result, 1, ENC_NA);\r\nPARAM_TREE_ADD(opspec_id, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_GET_BLOCK_PERMALOCK_STATUS:\r\nPARAM_TREE_ADD(opspec_id, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(access_pass, 4, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(mb, 1, ENC_NA);\r\nPARAM_TREE_ADD(block_pointer, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(block_range, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_GET_BLOCK_PERMALOCK_STATUS_OPSPEC_RESULT:\r\nPARAM_TREE_ADD(block_permalock_result, 1, ENC_NA);\r\nPARAM_TREE_ADD(opspec_id, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_SET_QT_CONFIG:\r\nPARAM_TREE_ADD(opspec_id, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(access_pass, 4, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(impinj_data_profile, 1, ENC_NA);\r\nPARAM_TREE_ADD(impinj_access_range, 1, ENC_NA);\r\nPARAM_TREE_ADD(impinj_persistence, 1, ENC_NA);\r\nPARAM_TREE_ADD(rfu, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_SET_QT_CONFIG_OPSPEC_RESULT:\r\nPARAM_TREE_ADD(set_qt_config_result, 1, ENC_NA);\r\nPARAM_TREE_ADD(opspec_id, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_GET_QT_CONFIG:\r\nPARAM_TREE_ADD(opspec_id, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(access_pass, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_GET_QT_CONFIG_OPSPEC_RESULT:\r\nPARAM_TREE_ADD(get_qt_config_result, 1, ENC_NA);\r\nPARAM_TREE_ADD(opspec_id, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(impinj_data_profile, 1, ENC_NA);\r\nPARAM_TREE_ADD(impinj_access_range, 1, ENC_NA);\r\nPARAM_TREE_ADD(rfu, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_ENABLE_SERIALIZED_TID:\r\nPARAM_TREE_ADD(impinj_serialized_tid_mode, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_ENABLE_RF_PHASE_ANGLE:\r\nPARAM_TREE_ADD(impinj_rf_phase_mode, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_ENABLE_PEAK_RSSI:\r\nPARAM_TREE_ADD(impinj_peak_rssi_mode, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_ENABLE_GPS_COORDINATES:\r\nPARAM_TREE_ADD(impinj_gps_coordinates_mode, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_SERIALIZED_TID:\r\nPARAM_TREE_ADD(impinj_tid, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_RF_PHASE_ANGLE:\r\nPARAM_TREE_ADD(phase_angle, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_PEAK_RSSI:\r\nPARAM_TREE_ADD(rssi, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_GPS_COORDINATES:\r\nPARAM_TREE_ADD(latitude, 4, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(longitude, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_LOOP_SPEC:\r\nPARAM_TREE_ADD(loop_count, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_GGA_SENTENCE:\r\nsuboffset = dissect_llrp_utf8_parameter(tvb, pinfo, param_tree, hf_llrp_gga_sentence, suboffset);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_RMC_SENTENCE:\r\nsuboffset = dissect_llrp_utf8_parameter(tvb, pinfo, param_tree, hf_llrp_rmc_sentence, suboffset);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_OPSPEC_RETRY_COUNT:\r\nPARAM_TREE_ADD(retry_count, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_ADVANCE_GPO_CONFIG:\r\nPARAM_TREE_ADD(gpo_port, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(impinj_gpo_mode, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(gpo_pulse_dur, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_ENABLE_OPTIM_READ:\r\nPARAM_TREE_ADD(impinj_optim_read_mode, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_ACCESS_SPEC_ORDERING:\r\nPARAM_TREE_ADD(impinj_access_spec_ordering, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_ENABLE_RF_DOPPLER_FREQ:\r\nPARAM_TREE_ADD(impinj_rf_doppler_mode, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_ARRAY_VERSION:\r\nsuboffset = dissect_llrp_utf8_parameter(tvb, pinfo, param_tree, hf_llrp_serial_number, suboffset);\r\nsuboffset = dissect_llrp_utf8_parameter(tvb, pinfo, param_tree, hf_llrp_firm_ver, suboffset);\r\nsuboffset = dissect_llrp_utf8_parameter(tvb, pinfo, param_tree, hf_llrp_pcba_ver, suboffset);\r\nbreak;\r\ncase LLRP_IMPINJ_PARAM_HUB_CONFIGURATION:\r\nPARAM_TREE_ADD(impinj_hub_id, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(impinj_hub_connected_type, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(impinj_hub_fault_type, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nreturn suboffset;\r\nbreak;\r\n}\r\nreturn dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, 0);\r\n}\r\nstatic guint\r\ndissect_llrp_parameters(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree,\r\nguint offset, const guint end, const guint depth)\r\n{\r\nguint8 has_length;\r\nguint16 len, type;\r\nguint real_len, param_end;\r\nguint suboffset;\r\nguint num;\r\nproto_item *ti;\r\nproto_tree *param_tree;\r\nwhile (((gint)(end - offset)) > 0)\r\n{\r\nhas_length = !(tvb_get_guint8(tvb, offset) & 0x80);\r\nif (has_length)\r\n{\r\ntype = tvb_get_ntohs(tvb, offset);\r\nlen = tvb_get_ntohs(tvb, offset + 2);\r\nif (len < LLRP_TLV_LEN_MIN)\r\nreal_len = LLRP_TLV_LEN_MIN;\r\nelse if (len > tvb_reported_length_remaining(tvb, offset))\r\nreal_len = tvb_reported_length_remaining(tvb, offset);\r\nelse\r\nreal_len = len;\r\nparam_end = offset + real_len;\r\nif (depth > 16) {\r\nreturn param_end;\r\n}\r\nti = proto_tree_add_none_format(tree, hf_llrp_param, tvb,\r\noffset, real_len, "TLV Parameter: %s",\r\nval_to_str_ext(type, &tlv_type_ext, "Unknown Type: %d"));\r\nparam_tree = proto_item_add_subtree(ti, ett_llrp_param);\r\nproto_tree_add_item(param_tree, hf_llrp_tlv_type, tvb,\r\noffset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nti = proto_tree_add_item(param_tree, hf_llrp_tlv_len, tvb,\r\noffset, 2, ENC_BIG_ENDIAN);\r\nif (len != real_len)\r\nexpert_add_info_format(pinfo, ti, &ei_llrp_invalid_length,\r\n"Invalid length field: claimed %u, should be %u.",\r\nlen, real_len);\r\noffset += 2;\r\nsuboffset = offset;\r\nswitch(type) {\r\ncase LLRP_TLV_RO_BOUND_SPEC:\r\ncase LLRP_TLV_UHF_CAPABILITIES:\r\ncase LLRP_TLV_ACCESS_COMMAND:\r\ncase LLRP_TLV_TAG_REPORT_DATA:\r\ncase LLRP_TLV_RF_SURVEY_REPORT_DATA:\r\ncase LLRP_TLV_READER_EVENT_NOTI_SPEC:\r\ncase LLRP_TLV_READER_EVENT_NOTI_DATA:\r\ncase LLRP_TLV_C1G2_UHF_RF_MD_TBL:\r\ncase LLRP_TLV_C1G2_TAG_SPEC:\r\nsuboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);\r\nbreak;\r\ncase LLRP_TLV_UTC_TIMESTAMP:\r\ncase LLRP_TLV_UPTIME:\r\nPARAM_TREE_ADD(microseconds, 8, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_GENERAL_DEVICE_CAP:\r\nPARAM_TREE_ADD_STAY(max_supported_antenna, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(can_set_antenna_prop, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(has_utc_clock, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(device_manufacturer, 4, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(model, 4, ENC_BIG_ENDIAN);\r\nsuboffset = dissect_llrp_utf8_parameter(tvb, pinfo, param_tree, hf_llrp_firmware_version, suboffset);\r\nsuboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);\r\nbreak;\r\ncase LLRP_TLV_MAX_RECEIVE_SENSE:\r\nPARAM_TREE_ADD(max_receive_sense, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_RECEIVE_SENSE_ENTRY:\r\nPARAM_TREE_ADD(index, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(receive_sense, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_ANTENNA_RCV_SENSE_RANGE:\r\nPARAM_TREE_ADD(antenna_id, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(receive_sense_index_min, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(receive_sense_index_max, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_ANTENNA_AIR_PROTO:\r\nPARAM_TREE_ADD(antenna_id, 2, ENC_BIG_ENDIAN);\r\nsuboffset = dissect_llrp_item_array(tvb, pinfo, param_tree,\r\nhf_llrp_num_protocols, hf_llrp_protocol_id, 1, suboffset);\r\nbreak;\r\ncase LLRP_TLV_GPIO_CAPABILITIES:\r\nPARAM_TREE_ADD(num_gpi, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(num_gpo, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_LLRP_CAPABILITIES:\r\nPARAM_TREE_ADD_STAY(can_do_survey, 1, ENC_NA);\r\nPARAM_TREE_ADD_STAY(can_report_buffer_warning, 1, ENC_NA);\r\nPARAM_TREE_ADD_STAY(support_client_opspec, 1, ENC_NA);\r\nPARAM_TREE_ADD_STAY(can_stateaware, 1, ENC_NA);\r\nPARAM_TREE_ADD(support_holding, 1, ENC_NA);\r\nPARAM_TREE_ADD(max_priority_supported, 1, ENC_NA);\r\nPARAM_TREE_ADD(client_opspec_timeout, 2, ENC_BIG_ENDIAN);\r\nnum = tvb_get_ntohl(tvb, suboffset);\r\nif(num == LLRP_NO_LIMIT)\r\nPARAM_TREE_ADD_SPEC_STAY(uint_format_value, max_num_rospec, 4, num, "No limit (%u)");\r\nelse\r\nPARAM_TREE_ADD_STAY(max_num_rospec, 4, ENC_BIG_ENDIAN);\r\nsuboffset += 4;\r\nnum = tvb_get_ntohl(tvb, suboffset);\r\nif(num == LLRP_NO_LIMIT)\r\nPARAM_TREE_ADD_SPEC_STAY(uint_format_value, max_num_spec_per_rospec, 4, num, "No limit (%u)");\r\nelse\r\nPARAM_TREE_ADD_STAY(max_num_spec_per_rospec, 4, ENC_BIG_ENDIAN);\r\nsuboffset += 4;\r\nnum = tvb_get_ntohl(tvb, suboffset);\r\nif(num == LLRP_NO_LIMIT)\r\nPARAM_TREE_ADD_SPEC_STAY(uint_format_value, max_num_inventory_per_aispec, 4, num, "No limit (%u)");\r\nelse\r\nPARAM_TREE_ADD_STAY(max_num_inventory_per_aispec, 4, ENC_BIG_ENDIAN);\r\nsuboffset += 4;\r\nnum = tvb_get_ntohl(tvb, suboffset);\r\nif(num == LLRP_NO_LIMIT)\r\nPARAM_TREE_ADD_SPEC_STAY(uint_format_value, max_num_accessspec, 4, num, "No limit (%u)");\r\nelse\r\nPARAM_TREE_ADD_STAY(max_num_accessspec, 4, ENC_BIG_ENDIAN);\r\nsuboffset += 4;\r\nnum = tvb_get_ntohl(tvb, suboffset);\r\nif(num == LLRP_NO_LIMIT)\r\nPARAM_TREE_ADD_SPEC_STAY(uint_format_value, max_num_opspec_per_accressspec, 4, num, "No limit (%u)");\r\nelse\r\nPARAM_TREE_ADD_STAY(max_num_opspec_per_accressspec, 4, ENC_BIG_ENDIAN);\r\nsuboffset += 4;\r\nbreak;\r\ncase LLRP_TLV_REGU_CAPABILITIES:\r\nPARAM_TREE_ADD(country_code, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(comm_standard, 2, ENC_BIG_ENDIAN);\r\nsuboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);\r\nbreak;\r\ncase LLRP_TLV_XMIT_POWER_LEVEL_ENTRY:\r\nPARAM_TREE_ADD(index, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(transmit_power, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_FREQ_INFORMATION:\r\nPARAM_TREE_ADD(hopping, 1, ENC_NA);\r\nsuboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);\r\nbreak;\r\ncase LLRP_TLV_FREQ_HOP_TABLE:\r\nPARAM_TREE_ADD(hop_table_id, 1, ENC_NA);\r\nPARAM_TREE_ADD(rfu, 1, ENC_NA);\r\nsuboffset = dissect_llrp_item_array(tvb, pinfo, param_tree,\r\nhf_llrp_num_hops, hf_llrp_frequency, 4, suboffset);\r\nbreak;\r\ncase LLRP_TLV_FIXED_FREQ_TABLE:\r\nsuboffset = dissect_llrp_item_array(tvb, pinfo, param_tree,\r\nhf_llrp_num_freqs, hf_llrp_frequency, 4, suboffset);\r\nbreak;\r\ncase LLRP_TLV_RF_SURVEY_FREQ_CAP:\r\nPARAM_TREE_ADD(min_freq, 4, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(max_freq, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_RO_SPEC:\r\nPARAM_TREE_ADD(rospec_id, 4, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(priority, 1, ENC_NA);\r\nPARAM_TREE_ADD(cur_state, 1, ENC_NA);\r\nsuboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);\r\nbreak;\r\ncase LLRP_TLV_RO_SPEC_START_TRIGGER:\r\nPARAM_TREE_ADD(rospec_start_trig_type, 1, ENC_NA);\r\nsuboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);\r\nbreak;\r\ncase LLRP_TLV_PER_TRIGGER_VAL:\r\nPARAM_TREE_ADD(offset, 4, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(period, 4, ENC_BIG_ENDIAN);\r\nsuboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);\r\nbreak;\r\ncase LLRP_TLV_GPI_TRIGGER_VAL:\r\nPARAM_TREE_ADD(gpi_port, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(gpi_event, 1, ENC_NA);\r\nPARAM_TREE_ADD(timeout, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_RO_SPEC_STOP_TRIGGER:\r\nPARAM_TREE_ADD(rospec_stop_trig_type, 1, ENC_NA);\r\nPARAM_TREE_ADD(duration_trig, 4, ENC_BIG_ENDIAN);\r\nsuboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);\r\nbreak;\r\ncase LLRP_TLV_AI_SPEC:\r\nsuboffset = dissect_llrp_item_array(tvb, pinfo, param_tree,\r\nhf_llrp_antenna_count, hf_llrp_antenna, 2, suboffset);\r\nsuboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);\r\nbreak;\r\ncase LLRP_TLV_AI_SPEC_STOP:\r\nPARAM_TREE_ADD(aispec_stop_trig_type, 1, ENC_NA);\r\nPARAM_TREE_ADD(duration_trig, 4, ENC_BIG_ENDIAN);\r\nsuboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);\r\nbreak;\r\ncase LLRP_TLV_TAG_OBSERV_TRIGGER:\r\nPARAM_TREE_ADD(trig_type, 1, ENC_NA);\r\nPARAM_TREE_ADD(rfu, 1, ENC_NA);\r\nPARAM_TREE_ADD(number_of_tags, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(number_of_attempts, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(t, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(timeout, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_INVENTORY_PARAM_SPEC:\r\nPARAM_TREE_ADD(inventory_spec_id, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(protocol_id, 1, ENC_NA);\r\nsuboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);\r\nbreak;\r\ncase LLRP_TLV_RF_SURVEY_SPEC:\r\nPARAM_TREE_ADD(antenna_id, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(start_freq, 4, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(stop_freq, 4, ENC_BIG_ENDIAN);\r\nsuboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);\r\nbreak;\r\ncase LLRP_TLV_RF_SURVEY_SPEC_STOP_TR:\r\nPARAM_TREE_ADD(stop_trig_type, 1, ENC_NA);\r\nPARAM_TREE_ADD(duration, 4, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(n_4, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_LOOP_SPEC:\r\nPARAM_TREE_ADD(loop_count, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_ACCESS_SPEC:\r\nPARAM_TREE_ADD(accessspec_id, 4, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(antenna_id, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(protocol_id, 1, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(access_cur_state, 1, ENC_NA);\r\nPARAM_TREE_ADD(rospec_id, 4, ENC_BIG_ENDIAN);\r\nsuboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);\r\nbreak;\r\ncase LLRP_TLV_ACCESS_SPEC_STOP_TRIG:\r\nPARAM_TREE_ADD(access_stop_trig_type, 1, ENC_NA);\r\nPARAM_TREE_ADD(operation_count, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_CLIENT_REQ_OP_SPEC:\r\nPARAM_TREE_ADD(opspec_id, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_CLIENT_REQ_RESPONSE:\r\nPARAM_TREE_ADD(accessspec_id, 2, ENC_BIG_ENDIAN);\r\nsuboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);\r\nbreak;\r\ncase LLRP_TLV_LLRP_CONF_STATE_VAL:\r\nPARAM_TREE_ADD(conf_value, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_IDENT:\r\nPARAM_TREE_ADD(id_type, 1, ENC_NA);\r\nnum = tvb_get_ntohs(tvb, suboffset);\r\nPARAM_TREE_ADD(reader_id, 2, ENC_BIG_ENDIAN);\r\nsuboffset += num;\r\nbreak;\r\ncase LLRP_TLV_GPO_WRITE_DATA:\r\nPARAM_TREE_ADD(gpo_port, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(gpo_data, 1, ENC_NA);\r\nbreak;\r\ncase LLRP_TLV_KEEPALIVE_SPEC:\r\nPARAM_TREE_ADD(keepalive_trig_type, 1, ENC_NA);\r\nPARAM_TREE_ADD(time_iterval, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_ANTENNA_PROPS:\r\nPARAM_TREE_ADD(antenna_connected, 1, ENC_NA);\r\nPARAM_TREE_ADD(antenna_id, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(antenna_gain, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_ANTENNA_CONF:\r\nPARAM_TREE_ADD(antenna_id, 2, ENC_BIG_ENDIAN);\r\nsuboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);\r\nbreak;\r\ncase LLRP_TLV_RF_RECEIVER:\r\nPARAM_TREE_ADD(receiver_sense, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_RF_TRANSMITTER:\r\nPARAM_TREE_ADD(hop_table_id, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(channel_idx, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(transmit_power, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_GPI_PORT_CURRENT_STATE:\r\nPARAM_TREE_ADD(gpi_port, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(gpi_config, 1, ENC_NA);\r\nPARAM_TREE_ADD(gpi_state, 1, ENC_NA);\r\nbreak;\r\ncase LLRP_TLV_EVENTS_AND_REPORTS:\r\nPARAM_TREE_ADD(hold_events_and_reports, 1, ENC_NA);\r\nbreak;\r\ncase LLRP_TLV_RO_REPORT_SPEC:\r\nPARAM_TREE_ADD(ro_report_trig, 1, ENC_NA);\r\nPARAM_TREE_ADD(n_2, 2, ENC_BIG_ENDIAN);\r\nsuboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);\r\nbreak;\r\ncase LLRP_TLV_TAG_REPORT_CONTENT_SEL:\r\nPARAM_TREE_ADD_STAY(enable_rospec_id, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD_STAY(enable_spec_idx, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD_STAY(enable_inv_spec_id, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD_STAY(enable_antenna_id, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD_STAY(enable_channel_idx, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD_STAY(enable_peak_rssi, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD_STAY(enable_first_seen, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD_STAY(enable_last_seen, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD_STAY(enable_seen_count, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(enable_accessspec_id, 2, ENC_BIG_ENDIAN);\r\nsuboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);\r\nbreak;\r\ncase LLRP_TLV_ACCESS_REPORT_SPEC:\r\nPARAM_TREE_ADD(access_report_trig, 1, ENC_NA);\r\nbreak;\r\ncase LLRP_TLV_EPC_DATA:\r\nsuboffset = dissect_llrp_bit_field(tvb, param_tree, hf_llrp_epc, suboffset);\r\nbreak;\r\ncase LLRP_TLV_FREQ_RSSI_LEVEL_ENTRY:\r\nPARAM_TREE_ADD(frequency, 4, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(bandwidth, 4, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(average_rssi, 1, ENC_NA);\r\nPARAM_TREE_ADD(peak_rssi, 1, ENC_NA);\r\nsuboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);\r\nbreak;\r\ncase LLRP_TLV_EVENT_NOTIF_STATE:\r\nPARAM_TREE_ADD(event_type, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(notif_state, 1, ENC_NA);\r\nbreak;\r\ncase LLRP_TLV_HOPPING_EVENT:\r\nPARAM_TREE_ADD(hop_table_id, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(next_chan_idx, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_GPI_EVENT:\r\nPARAM_TREE_ADD(gpi_port, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(gpi_event, 1, ENC_NA);\r\nbreak;\r\ncase LLRP_TLV_RO_SPEC_EVENT:\r\nPARAM_TREE_ADD(roevent_type, 1, ENC_NA);\r\nPARAM_TREE_ADD(rospec_id, 4, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(prem_rospec_id, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_REPORT_BUF_LEVEL_WARN:\r\nPARAM_TREE_ADD(buffer_full_percentage, 1, ENC_NA);\r\nbreak;\r\ncase LLRP_TLV_REPORT_BUF_OVERFLOW_ERR: break;\r\ncase LLRP_TLV_READER_EXCEPTION_EVENT:\r\nsuboffset = dissect_llrp_utf8_parameter(tvb, pinfo, param_tree, hf_llrp_message, suboffset);\r\nsuboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);\r\nbreak;\r\ncase LLRP_TLV_RF_SURVEY_EVENT:\r\nPARAM_TREE_ADD(rfevent_type, 1, ENC_NA);\r\nPARAM_TREE_ADD(rospec_id, 4, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(spec_idx, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_AI_SPEC_EVENT:\r\nPARAM_TREE_ADD(aievent_type, 1, ENC_NA);\r\nPARAM_TREE_ADD(rospec_id, 4, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(spec_idx, 2, ENC_BIG_ENDIAN);\r\nsuboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);\r\nbreak;\r\ncase LLRP_TLV_ANTENNA_EVENT:\r\nPARAM_TREE_ADD(antenna_event_type, 1, ENC_NA);\r\nPARAM_TREE_ADD(antenna_id, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_CONN_ATTEMPT_EVENT:\r\nPARAM_TREE_ADD(conn_status, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_CONN_CLOSE_EVENT:\r\nbreak;\r\ncase LLRP_TLV_SPEC_LOOP_EVENT:\r\nPARAM_TREE_ADD(rospec_id, 4, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(loop_count, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_LLRP_STATUS:\r\nPARAM_TREE_ADD(status_code, 2, ENC_BIG_ENDIAN);\r\nsuboffset = dissect_llrp_utf8_parameter(tvb, pinfo, param_tree, hf_llrp_error_desc, suboffset);\r\nsuboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);\r\nbreak;\r\ncase LLRP_TLV_FIELD_ERROR:\r\nPARAM_TREE_ADD(field_num, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(error_code, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_PARAM_ERROR:\r\nPARAM_TREE_ADD(parameter_type, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(error_code, 2, ENC_BIG_ENDIAN);\r\nsuboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);\r\nbreak;\r\ncase LLRP_TLV_C1G2_LLRP_CAP:\r\nPARAM_TREE_ADD_STAY(can_support_block_erase, 1, ENC_NA);\r\nPARAM_TREE_ADD_STAY(can_support_block_write, 1, ENC_NA);\r\nPARAM_TREE_ADD_STAY(can_support_block_permalock, 1, ENC_NA);\r\nPARAM_TREE_ADD_STAY(can_support_tag_recomm, 1, ENC_NA);\r\nPARAM_TREE_ADD_STAY(can_support_UMI_method2, 1, ENC_NA);\r\nPARAM_TREE_ADD(can_support_XPC, 1, ENC_NA);\r\nnum = tvb_get_ntohs(tvb, suboffset);\r\nif(num == LLRP_NO_LIMIT)\r\nPARAM_TREE_ADD_SPEC_STAY(uint_format_value, max_num_filter_per_query, 2, num, "No limit (%u)");\r\nelse\r\nPARAM_TREE_ADD_STAY(max_num_filter_per_query, 2, ENC_BIG_ENDIAN);\r\nsuboffset += 2;\r\nbreak;\r\ncase LLRP_TLV_C1G2_UHF_RF_MD_TBL_ENT:\r\nPARAM_TREE_ADD(mode_ident, 4, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD_STAY(DR, 1, ENC_NA);\r\nPARAM_TREE_ADD(hag_conformance, 1, ENC_NA);\r\nPARAM_TREE_ADD(mod, 1, ENC_NA);\r\nPARAM_TREE_ADD(flm, 1, ENC_NA);\r\nPARAM_TREE_ADD(m, 1, ENC_NA);\r\nPARAM_TREE_ADD(bdr, 4, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(pie, 4, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(min_tari, 4, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(max_tari, 4, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(step_tari, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_C1G2_INVENTORY_COMMAND:\r\nPARAM_TREE_ADD(inventory_state_aware, 1, ENC_NA);\r\nsuboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);\r\nbreak;\r\ncase LLRP_TLV_C1G2_FILTER:\r\nPARAM_TREE_ADD(trunc, 1, ENC_NA);\r\nsuboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);\r\nbreak;\r\ncase LLRP_TLV_C1G2_TAG_INV_MASK:\r\nPARAM_TREE_ADD(mb, 1, ENC_NA);\r\nPARAM_TREE_ADD(pointer, 2, ENC_BIG_ENDIAN);\r\nsuboffset = dissect_llrp_bit_field(tvb, param_tree, hf_llrp_tag_mask, suboffset);\r\nbreak;\r\ncase LLRP_TLV_C1G2_TAG_INV_AWARE_FLTR:\r\nPARAM_TREE_ADD(aware_filter_target, 1, ENC_NA);\r\nPARAM_TREE_ADD(aware_filter_action, 1, ENC_NA);\r\nbreak;\r\ncase LLRP_TLV_C1G2_TAG_INV_UNAWR_FLTR:\r\nPARAM_TREE_ADD(unaware_filter_action, 1, ENC_NA);\r\nbreak;\r\ncase LLRP_TLV_C1G2_RF_CONTROL:\r\nPARAM_TREE_ADD(mode_idx, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(tari, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_C1G2_SINGULATION_CTRL:\r\nPARAM_TREE_ADD(session, 1, ENC_NA);\r\nPARAM_TREE_ADD(tag_population, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(tag_transit_time, 4, ENC_BIG_ENDIAN);\r\nsuboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);\r\nbreak;\r\ncase LLRP_TLV_C1G2_TAG_INV_AWARE_SING:\r\nPARAM_TREE_ADD_STAY(sing_i, 1, ENC_NA);\r\nPARAM_TREE_ADD_STAY(sing_s, 1, ENC_NA);\r\nPARAM_TREE_ADD(sing_a, 1, ENC_NA);\r\nbreak;\r\ncase LLRP_TLV_C1G2_TARGET_TAG:\r\nPARAM_TREE_ADD_STAY(mb, 1, ENC_NA);\r\nPARAM_TREE_ADD(match, 1, ENC_NA);\r\nPARAM_TREE_ADD(pointer, 2, ENC_BIG_ENDIAN);\r\nsuboffset = dissect_llrp_bit_field(tvb, param_tree, hf_llrp_tag_mask, suboffset);\r\nsuboffset = dissect_llrp_bit_field(tvb, param_tree, hf_llrp_tag_data, suboffset);\r\nbreak;\r\ncase LLRP_TLV_C1G2_READ:\r\ncase LLRP_TLV_C1G2_BLK_ERASE:\r\nPARAM_TREE_ADD(opspec_id, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(access_pass, 4, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(mb, 1, ENC_NA);\r\nPARAM_TREE_ADD(word_pointer, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(word_count, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_C1G2_WRITE:\r\ncase LLRP_TLV_C1G2_BLK_WRITE:\r\nPARAM_TREE_ADD(opspec_id, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(access_pass, 4, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(mb, 1, ENC_NA);\r\nPARAM_TREE_ADD(word_pointer, 2, ENC_BIG_ENDIAN);\r\nsuboffset = dissect_llrp_word_array(tvb, param_tree, hf_llrp_write_data, suboffset);\r\nbreak;\r\ncase LLRP_TLV_C1G2_KILL:\r\nPARAM_TREE_ADD(opspec_id, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(kill_pass, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_C1G2_RECOMMISSION:\r\nPARAM_TREE_ADD(opspec_id, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(kill_pass, 4, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD_STAY(kill_3, 1, ENC_NA);\r\nPARAM_TREE_ADD_STAY(kill_2, 1, ENC_NA);\r\nPARAM_TREE_ADD(kill_l, 1, ENC_NA);\r\nbreak;\r\ncase LLRP_TLV_C1G2_LOCK:\r\nPARAM_TREE_ADD(opspec_id, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(access_pass, 4, ENC_BIG_ENDIAN);\r\nsuboffset = dissect_llrp_parameters(tvb, pinfo, param_tree, suboffset, param_end, depth+1);\r\nbreak;\r\ncase LLRP_TLV_C1G2_LOCK_PAYLOAD:\r\nPARAM_TREE_ADD(privilege, 1, ENC_NA);\r\nPARAM_TREE_ADD(data_field, 1, ENC_NA);\r\nbreak;\r\ncase LLRP_TLV_C1G2_BLK_PERMALOCK:\r\nPARAM_TREE_ADD(opspec_id, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(access_pass, 4, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(mb, 1, ENC_NA);\r\nPARAM_TREE_ADD(block_pointer, 2, ENC_BIG_ENDIAN);\r\nsuboffset = dissect_llrp_word_array(tvb, param_tree, hf_llrp_block_mask, suboffset);\r\nbreak;\r\ncase LLRP_TLV_C1G2_GET_BLK_PERMALOCK:\r\nPARAM_TREE_ADD(opspec_id, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(access_pass, 4, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(mb, 1, ENC_NA);\r\nPARAM_TREE_ADD(block_pointer, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(block_range, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_C1G2_EPC_MEMORY_SLCTOR:\r\nPARAM_TREE_ADD_STAY(enable_crc, 1, ENC_NA);\r\nPARAM_TREE_ADD_STAY(enable_pc, 1, ENC_NA);\r\nPARAM_TREE_ADD(enable_xpc, 1, ENC_NA);\r\nbreak;\r\ncase LLRP_TLV_C1G2_READ_OP_SPEC_RES:\r\nPARAM_TREE_ADD(access_result, 1, ENC_NA);\r\nPARAM_TREE_ADD(opspec_id, 2, ENC_BIG_ENDIAN);\r\nsuboffset = dissect_llrp_word_array(tvb, param_tree, hf_llrp_read_data, suboffset);\r\nbreak;\r\ncase LLRP_TLV_C1G2_WRT_OP_SPEC_RES:\r\ncase LLRP_TLV_C1G2_BLK_WRT_OP_SPC_RES:\r\nPARAM_TREE_ADD(access_result, 1, ENC_NA);\r\nPARAM_TREE_ADD(opspec_id, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD(num_words_written, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_C1G2_KILL_OP_SPEC_RES:\r\ncase LLRP_TLV_C1G2_RECOM_OP_SPEC_RES:\r\ncase LLRP_TLV_C1G2_LOCK_OP_SPEC_RES:\r\ncase LLRP_TLV_C1G2_BLK_ERS_OP_SPC_RES:\r\ncase LLRP_TLV_C1G2_BLK_PRL_OP_SPC_RES:\r\nPARAM_TREE_ADD(access_result, 1, ENC_NA);\r\nPARAM_TREE_ADD(opspec_id, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TLV_C1G2_BLK_PRL_STAT_RES:\r\nPARAM_TREE_ADD(access_result, 1, ENC_NA);\r\nPARAM_TREE_ADD(opspec_id, 2, ENC_BIG_ENDIAN);\r\nsuboffset = dissect_llrp_word_array(tvb, param_tree, hf_llrp_permlock_status, suboffset);\r\nbreak;\r\ncase LLRP_TLV_CUSTOM_PARAMETER:\r\nnum = tvb_get_ntohl(tvb, suboffset);\r\nPARAM_TREE_ADD(vendor_id, 4, ENC_BIG_ENDIAN);\r\nswitch(num) {\r\ncase LLRP_VENDOR_IMPINJ:\r\nsuboffset = dissect_llrp_impinj_parameter(tvb, pinfo, param_tree, suboffset, param_end);\r\nbreak;\r\n}\r\nbreak;\r\n}\r\nif(suboffset != param_end) {\r\nexpert_add_info_format(pinfo, param_tree, &ei_llrp_invalid_length,\r\n"Incorrect length of parameter: %u bytes decoded, but %u bytes claimed.",\r\nsuboffset - offset + 4, real_len);\r\n}\r\noffset += real_len - 4;\r\n}\r\nelse\r\n{\r\ntype = tvb_get_guint8(tvb, offset) & 0x7F;\r\nswitch (type)\r\n{\r\ncase LLRP_TV_ANTENNA_ID:\r\nreal_len = LLRP_TV_LEN_ANTENNA_ID; break;\r\ncase LLRP_TV_FIRST_SEEN_TIME_UTC:\r\nreal_len = LLRP_TV_LEN_FIRST_SEEN_TIME_UTC; break;\r\ncase LLRP_TV_FIRST_SEEN_TIME_UPTIME:\r\nreal_len = LLRP_TV_LEN_FIRST_SEEN_TIME_UPTIME; break;\r\ncase LLRP_TV_LAST_SEEN_TIME_UTC:\r\nreal_len = LLRP_TV_LEN_LAST_SEEN_TIME_UTC; break;\r\ncase LLRP_TV_LAST_SEEN_TIME_UPTIME:\r\nreal_len = LLRP_TV_LEN_LAST_SEEN_TIME_UPTIME; break;\r\ncase LLRP_TV_PEAK_RSSI:\r\nreal_len = LLRP_TV_LEN_PEAK_RSSI; break;\r\ncase LLRP_TV_CHANNEL_INDEX:\r\nreal_len = LLRP_TV_LEN_CHANNEL_INDEX; break;\r\ncase LLRP_TV_TAG_SEEN_COUNT:\r\nreal_len = LLRP_TV_LEN_TAG_SEEN_COUNT; break;\r\ncase LLRP_TV_RO_SPEC_ID:\r\nreal_len = LLRP_TV_LEN_RO_SPEC_ID; break;\r\ncase LLRP_TV_INVENTORY_PARAM_SPEC_ID:\r\nreal_len = LLRP_TV_LEN_INVENTORY_PARAM_SPEC_ID; break;\r\ncase LLRP_TV_C1G2_CRC:\r\nreal_len = LLRP_TV_LEN_C1G2_CRC; break;\r\ncase LLRP_TV_C1G2_PC:\r\nreal_len = LLRP_TV_LEN_C1G2_PC; break;\r\ncase LLRP_TV_EPC96:\r\nreal_len = LLRP_TV_LEN_EPC96; break;\r\ncase LLRP_TV_SPEC_INDEX:\r\nreal_len = LLRP_TV_LEN_SPEC_INDEX; break;\r\ncase LLRP_TV_CLIENT_REQ_OP_SPEC_RES:\r\nreal_len = LLRP_TV_LEN_CLIENT_REQ_OP_SPEC_RES; break;\r\ncase LLRP_TV_ACCESS_SPEC_ID:\r\nreal_len = LLRP_TV_LEN_ACCESS_SPEC_ID; break;\r\ncase LLRP_TV_OP_SPEC_ID:\r\nreal_len = LLRP_TV_LEN_OP_SPEC_ID; break;\r\ncase LLRP_TV_C1G2_SINGULATION_DET:\r\nreal_len = LLRP_TV_LEN_C1G2_SINGULATION_DET; break;\r\ncase LLRP_TV_C1G2_XPC_W1:\r\nreal_len = LLRP_TV_LEN_C1G2_XPC_W1; break;\r\ncase LLRP_TV_C1G2_XPC_W2:\r\nreal_len = LLRP_TV_LEN_C1G2_XPC_W2; break;\r\ndefault:\r\nreal_len = 0;\r\nbreak;\r\n};\r\nti = proto_tree_add_none_format(tree, hf_llrp_param, tvb,\r\noffset, real_len + 1, "TV Parameter : %s",\r\nval_to_str_ext(type, &tv_type_ext, "Unknown Type: %d"));\r\nparam_tree = proto_item_add_subtree(ti, ett_llrp_param);\r\nproto_tree_add_item(param_tree, hf_llrp_tv_type, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nsuboffset = offset;\r\nswitch (type)\r\n{\r\ncase LLRP_TV_ANTENNA_ID:\r\nPARAM_TREE_ADD_STAY(antenna_id, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TV_FIRST_SEEN_TIME_UTC:\r\ncase LLRP_TV_FIRST_SEEN_TIME_UPTIME:\r\ncase LLRP_TV_LAST_SEEN_TIME_UTC:\r\ncase LLRP_TV_LAST_SEEN_TIME_UPTIME:\r\nPARAM_TREE_ADD_STAY(microseconds, 8, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TV_PEAK_RSSI:\r\nPARAM_TREE_ADD_STAY(peak_rssi, 1, ENC_NA);\r\nbreak;\r\ncase LLRP_TV_CHANNEL_INDEX:\r\nPARAM_TREE_ADD_STAY(channel_idx, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TV_TAG_SEEN_COUNT:\r\nPARAM_TREE_ADD_STAY(tag_count, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TV_RO_SPEC_ID:\r\nPARAM_TREE_ADD_STAY(rospec_id, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TV_INVENTORY_PARAM_SPEC_ID:\r\nPARAM_TREE_ADD_STAY(inventory_spec_id, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TV_C1G2_CRC:\r\nPARAM_TREE_ADD_STAY(crc, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TV_C1G2_PC:\r\nPARAM_TREE_ADD_STAY(pc_bits, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TV_EPC96:\r\nPARAM_TREE_ADD_STAY(epc, 96/8, ENC_NA);\r\nbreak;\r\ncase LLRP_TV_SPEC_INDEX:\r\nPARAM_TREE_ADD_STAY(spec_idx, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TV_CLIENT_REQ_OP_SPEC_RES:\r\nPARAM_TREE_ADD_STAY(opspec_id, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TV_ACCESS_SPEC_ID:\r\nPARAM_TREE_ADD_STAY(accessspec_id, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TV_OP_SPEC_ID:\r\nPARAM_TREE_ADD_STAY(opspec_id, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TV_C1G2_SINGULATION_DET:\r\nPARAM_TREE_ADD_STAY(num_coll, 2, ENC_BIG_ENDIAN);\r\nPARAM_TREE_ADD_STAY(num_empty, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TV_C1G2_XPC_W1:\r\nPARAM_TREE_ADD_STAY(xpc_w1, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TV_C1G2_XPC_W2:\r\nPARAM_TREE_ADD_STAY(xpc_w2, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\n};\r\noffset += real_len;\r\n}\r\n}\r\nreturn offset;\r\n}\r\nstatic guint\r\ndissect_llrp_impinj_message(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint offset)\r\n{\r\nguint8 subtype;\r\nsubtype = tvb_get_guint8(tvb, offset);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " (Impinj - %s)",\r\nval_to_str_ext(subtype, &impinj_msg_subtype_ext, "Unknown Type: %d"));\r\nproto_tree_add_item(tree, hf_llrp_impinj_msg_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nswitch(subtype) {\r\ncase LLRP_IMPINJ_TYPE_ENABLE_EXTENSIONS:\r\nproto_tree_add_item(tree, hf_llrp_rfu, tvb, offset, 4, ENC_NA);\r\noffset += 4;\r\nbreak;\r\ncase LLRP_IMPINJ_TYPE_ENABLE_EXTENSIONS_RESPONSE:\r\nbreak;\r\ncase LLRP_IMPINJ_TYPE_SAVE_SETTINGS:\r\nproto_tree_add_item(tree, hf_llrp_save_config, tvb, offset, 1, ENC_NA);\r\noffset += 1;\r\nbreak;\r\ncase LLRP_IMPINJ_TYPE_SAVE_SETTINGS_RESPONSE:\r\nbreak;\r\n}\r\nreturn offset;\r\n}\r\nstatic void\r\ndissect_llrp_message(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree,\r\nguint16 type, guint offset)\r\n{\r\ngboolean ends_with_parameters;\r\nguint8 requested_data;\r\nguint16 antenna_id, gpi_port, gpo_port;\r\nguint32 spec_id, vendor;\r\nproto_item *request_item, *antenna_item, *gpi_item, *gpo_item;\r\nguint (*dissect_custom_message)(tvbuff_t *tvb,\r\npacket_info *pinfo, proto_tree *tree, guint offset) = NULL;\r\nends_with_parameters = FALSE;\r\nswitch (type)\r\n{\r\ncase LLRP_TYPE_CLOSE_CONNECTION_RESPONSE:\r\ncase LLRP_TYPE_GET_READER_CAPABILITIES_RESPONSE:\r\ncase LLRP_TYPE_ADD_ROSPEC:\r\ncase LLRP_TYPE_ADD_ROSPEC_RESPONSE:\r\ncase LLRP_TYPE_DELETE_ROSPEC_RESPONSE:\r\ncase LLRP_TYPE_START_ROSPEC_RESPONSE:\r\ncase LLRP_TYPE_STOP_ROSPEC_RESPONSE:\r\ncase LLRP_TYPE_ENABLE_ROSPEC_RESPONSE:\r\ncase LLRP_TYPE_DISABLE_ROSPEC_RESPONSE:\r\ncase LLRP_TYPE_GET_ROSPECS_RESPONSE:\r\ncase LLRP_TYPE_ADD_ACCESSSPEC:\r\ncase LLRP_TYPE_ADD_ACCESSSPEC_RESPONSE:\r\ncase LLRP_TYPE_DELETE_ACCESSSPEC_RESPONSE:\r\ncase LLRP_TYPE_ENABLE_ACCESSSPEC_RESPONSE:\r\ncase LLRP_TYPE_DISABLE_ACCESSSPEC_RESPONSE:\r\ncase LLRP_TYPE_GET_ACCESSSPECS:\r\ncase LLRP_TYPE_CLIENT_REQUEST_OP:\r\ncase LLRP_TYPE_CLIENT_RESQUEST_OP_RESPONSE:\r\ncase LLRP_TYPE_RO_ACCESS_REPORT:\r\ncase LLRP_TYPE_READER_EVENT_NOTIFICATION:\r\ncase LLRP_TYPE_ERROR_MESSAGE:\r\ncase LLRP_TYPE_GET_READER_CONFIG_RESPONSE:\r\ncase LLRP_TYPE_SET_READER_CONFIG_RESPONSE:\r\ncase LLRP_TYPE_SET_PROTOCOL_VERSION_RESPONSE:\r\ncase LLRP_TYPE_GET_ACCESSSPECS_RESPONSE:\r\ncase LLRP_TYPE_GET_REPORT:\r\ncase LLRP_TYPE_ENABLE_EVENTS_AND_REPORTS:\r\nends_with_parameters = TRUE;\r\nbreak;\r\ncase LLRP_TYPE_START_ROSPEC:\r\ncase LLRP_TYPE_STOP_ROSPEC:\r\ncase LLRP_TYPE_ENABLE_ROSPEC:\r\ncase LLRP_TYPE_DISABLE_ROSPEC:\r\ncase LLRP_TYPE_DELETE_ROSPEC:\r\nspec_id = tvb_get_ntohl(tvb, offset);\r\nif (spec_id == LLRP_ROSPEC_ALL)\r\nproto_tree_add_uint_format(tree, hf_llrp_rospec, tvb,\r\noffset, 4, spec_id, "All ROSpecs (%u)", spec_id);\r\nelse\r\nproto_tree_add_item(tree, hf_llrp_rospec, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nbreak;\r\ncase LLRP_TYPE_ENABLE_ACCESSSPEC:\r\ncase LLRP_TYPE_DELETE_ACCESSSPEC:\r\ncase LLRP_TYPE_DISABLE_ACCESSSPEC:\r\nspec_id = tvb_get_ntohl(tvb, offset);\r\nif (spec_id == LLRP_ACCESSSPEC_ALL)\r\nproto_tree_add_uint_format(tree, hf_llrp_accessspec, tvb,\r\noffset, 4, spec_id, "All Access Specs (%u)", spec_id);\r\nelse\r\nproto_tree_add_item(tree, hf_llrp_accessspec, tvb,\r\noffset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nbreak;\r\ncase LLRP_TYPE_GET_READER_CAPABILITIES:\r\nproto_tree_add_item(tree, hf_llrp_req_cap, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nends_with_parameters = TRUE;\r\nbreak;\r\ncase LLRP_TYPE_GET_READER_CONFIG:\r\nantenna_id = tvb_get_ntohs(tvb, offset);\r\nif (antenna_id == LLRP_ANTENNA_ALL)\r\nantenna_item = proto_tree_add_uint_format(tree, hf_llrp_antenna_id, tvb,\r\noffset, 2, antenna_id, "All Antennas (%u)", antenna_id);\r\nelse\r\nantenna_item = proto_tree_add_item(tree, hf_llrp_antenna_id, tvb,\r\noffset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nrequested_data = tvb_get_guint8(tvb, offset);\r\nrequest_item = proto_tree_add_item(tree, hf_llrp_req_conf, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\ngpi_port = tvb_get_ntohs(tvb, offset);\r\nif (gpi_port == LLRP_GPI_PORT_ALL)\r\ngpi_item = proto_tree_add_uint_format(tree, hf_llrp_gpi_port, tvb,\r\noffset, 2, gpi_port, "All GPI Ports (%u)", gpi_port);\r\nelse\r\ngpi_item = proto_tree_add_item(tree, hf_llrp_gpi_port, tvb,\r\noffset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\ngpo_port = tvb_get_ntohs(tvb, offset);\r\nif (gpo_port == LLRP_GPO_PORT_ALL)\r\ngpo_item = proto_tree_add_uint_format(tree, hf_llrp_gpo_port, tvb,\r\noffset, 2, gpo_port, "All GPO Ports (%u)", gpo_port);\r\nelse\r\ngpo_item = proto_tree_add_item(tree, hf_llrp_gpo_port, tvb,\r\noffset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nswitch (requested_data)\r\n{\r\ncase LLRP_CONF_ALL:\r\nbreak;\r\ncase LLRP_CONF_ANTENNA_PROPERTIES:\r\ncase LLRP_CONF_ANTENNA_CONFIGURATION:\r\nproto_item_append_text(gpi_item, " (Ignored)");\r\nproto_item_append_text(gpo_item, " (Ignored)");\r\nbreak;\r\ncase LLRP_CONF_IDENTIFICATION:\r\ncase LLRP_CONF_RO_REPORT_SPEC:\r\ncase LLRP_CONF_READER_EVENT_NOTIFICATION_SPEC:\r\ncase LLRP_CONF_ACCESS_REPORT_SPEC:\r\ncase LLRP_CONF_LLRP_CONFIGURATION_STATE:\r\ncase LLRP_CONF_KEEPALIVE_SPEC:\r\ncase LLRP_CONF_EVENTS_AND_REPORTS:\r\nproto_item_append_text(antenna_item, " (Ignored)");\r\nproto_item_append_text(gpi_item, " (Ignored)");\r\nproto_item_append_text(gpo_item, " (Ignored)");\r\nbreak;\r\ncase LLRP_CONF_GPI_PORT_CURRENT_STATE:\r\nproto_item_append_text(antenna_item, " (Ignored)");\r\nproto_item_append_text(gpo_item, " (Ignored)");\r\nbreak;\r\ncase LLRP_CONF_GPO_WRITE_DATA:\r\nproto_item_append_text(antenna_item, " (Ignored)");\r\nproto_item_append_text(gpi_item, " (Ignored)");\r\nbreak;\r\ndefault:\r\nproto_item_append_text(antenna_item, " (Ignored)");\r\nexpert_add_info_format(pinfo, request_item, &ei_llrp_req_conf,\r\n"Unrecognized configuration request: %u",\r\nrequested_data);\r\nproto_item_append_text(gpi_item, " (Ignored)");\r\nproto_item_append_text(gpo_item, " (Ignored)");\r\nbreak;\r\n};\r\nends_with_parameters = TRUE;\r\nbreak;\r\ncase LLRP_TYPE_SET_READER_CONFIG:\r\nproto_tree_add_item(tree, hf_llrp_rest_fact, tvb, offset, 1, ENC_NA);\r\noffset++;\r\nends_with_parameters = TRUE;\r\nbreak;\r\ncase LLRP_TYPE_SET_PROTOCOL_VERSION:\r\nproto_tree_add_item(tree, hf_llrp_version, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase LLRP_TYPE_GET_SUPPORTED_VERSION_RESPONSE:\r\nproto_tree_add_item(tree, hf_llrp_cur_ver, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(tree, hf_llrp_sup_ver, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nends_with_parameters = TRUE;\r\nbreak;\r\ncase LLRP_TYPE_CUSTOM_MESSAGE:\r\nvendor = tvb_get_ntohl(tvb, offset);\r\nproto_tree_add_item(tree, hf_llrp_vendor, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nswitch(vendor) {\r\ncase LLRP_VENDOR_IMPINJ:\r\ndissect_custom_message = dissect_llrp_impinj_message;\r\nends_with_parameters = TRUE;\r\nbreak;\r\n}\r\nif (dissect_custom_message)\r\noffset = dissect_custom_message(tvb, pinfo, tree, offset);\r\nbreak;\r\ncase LLRP_TYPE_KEEPALIVE:\r\ncase LLRP_TYPE_KEEPALIVE_ACK:\r\ncase LLRP_TYPE_CLOSE_CONNECTION:\r\ncase LLRP_TYPE_GET_ROSPECS:\r\ncase LLRP_TYPE_GET_SUPPORTED_VERSION:\r\nbreak;\r\ndefault:\r\nDISSECTOR_ASSERT_NOT_REACHED();\r\n};\r\nif(ends_with_parameters) {\r\noffset = dissect_llrp_parameters(tvb, pinfo, tree, offset, tvb_reported_length(tvb), 0);\r\n}\r\nif(tvb_reported_length_remaining(tvb, offset) != 0) {\r\nexpert_add_info_format(pinfo, tree, &ei_llrp_invalid_length,\r\n"Incorrect length of message: %u bytes decoded, but %u bytes available.",\r\noffset, tvb_reported_length(tvb));\r\n}\r\n}\r\nstatic int\r\ndissect_llrp_packet(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nproto_item *ti;\r\nproto_tree *llrp_tree;\r\nguint16 type;\r\nguint32 len;\r\nguint offset = 0;\r\nDISSECTOR_ASSERT(tvb_reported_length(tvb) >= LLRP_HEADER_LENGTH);\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "LLRP");\r\ncol_set_str(pinfo->cinfo, COL_INFO, "LLRP Message");\r\ntype = tvb_get_ntohs(tvb, offset) & 0x03FF;\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " (%s)",\r\nval_to_str_ext(type, &message_types_ext, "Unknown Type: %d"));\r\nti = proto_tree_add_item(tree, proto_llrp, tvb, offset, -1, ENC_NA);\r\nllrp_tree = proto_item_add_subtree(ti, ett_llrp);\r\nproto_tree_add_item(llrp_tree, hf_llrp_version, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(llrp_tree, hf_llrp_type, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nti = proto_tree_add_item(llrp_tree, hf_llrp_length, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nlen = tvb_get_ntohl(tvb, offset);\r\nif (len != tvb_reported_length(tvb))\r\n{\r\nexpert_add_info_format(pinfo, ti, &ei_llrp_invalid_length,\r\n"Incorrect length field: claimed %u, but have %u.",\r\nlen, tvb_reported_length(tvb));\r\n}\r\noffset += 4;\r\nproto_tree_add_item(llrp_tree, hf_llrp_id, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nif (try_val_to_str_ext(type, &message_types_ext))\r\ndissect_llrp_message(tvb, pinfo, llrp_tree, type, offset);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic guint\r\nget_llrp_message_len(packet_info *pinfo _U_, tvbuff_t *tvb, int offset, void *data _U_)\r\n{\r\nreturn (guint)tvb_get_ntohl(tvb, offset+2);\r\n}\r\nstatic int\r\ndissect_llrp(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data)\r\n{\r\ntcp_dissect_pdus(tvb, pinfo, tree, TRUE, LLRP_HEADER_LENGTH,\r\nget_llrp_message_len, dissect_llrp_packet, data);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_llrp(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_llrp_version,\r\n{ "Version", "llrp.version", FT_UINT8, BASE_DEC, VALS(llrp_versions), 0x1C,\r\nNULL, HFILL }},\r\n{ &hf_llrp_type,\r\n{ "Type", "llrp.type", FT_UINT16, BASE_DEC | BASE_EXT_STRING, &message_types_ext, 0x03FF,\r\nNULL, HFILL }},\r\n{ &hf_llrp_length,\r\n{ "Length", "llrp.length", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_id,\r\n{ "ID", "llrp.id", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_cur_ver,\r\n{ "Current Version", "llrp.cur_ver", FT_UINT8, BASE_DEC, VALS(llrp_versions), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_sup_ver,\r\n{ "Supported Version", "llrp.sup_ver", FT_UINT8, BASE_DEC, VALS(llrp_versions), 0,\r\n"The max supported protocol version.", HFILL }},\r\n{ &hf_llrp_req_cap,\r\n{ "Requested Capabilities", "llrp.req_cap", FT_UINT8, BASE_DEC, VALS(capabilities_request), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_req_conf,\r\n{ "Requested Configuration", "llrp.req_conf", FT_UINT8, BASE_DEC | BASE_EXT_STRING, &config_request_ext, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_rospec,\r\n{ "ROSpec ID", "llrp.rospec", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_antenna_id,\r\n{ "Antenna ID", "llrp.antenna_id", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_gpi_port,\r\n{ "GPI Port Number", "llrp.gpi_port", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_gpo_port,\r\n{ "GPO Port Number", "llrp.gpo_port", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_rest_fact,\r\n{ "Restore Factory Settings", "llrp.rest_fact", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x80,\r\nNULL, HFILL }},\r\n{ &hf_llrp_accessspec,\r\n{ "Access Spec ID", "llrp.accessspec", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_vendor,\r\n{ "Vendor ID", "llrp.vendor", FT_UINT32, BASE_DEC, VALS(llrp_vendors), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_impinj_msg_type,\r\n{ "Subtype", "llrp.impinj.type", FT_UINT8, BASE_DEC | BASE_EXT_STRING, &impinj_msg_subtype_ext, 0,\r\n"Subtype specified by vendor", HFILL }},\r\n{ &hf_llrp_tlv_type,\r\n{ "Type", "llrp.tlv_type", FT_UINT16, BASE_DEC | BASE_EXT_STRING, &tlv_type_ext, 0x03FF,\r\n"The type of TLV.", HFILL }},\r\n{ &hf_llrp_tv_type,\r\n{ "Type", "llrp.tv_type", FT_UINT8, BASE_DEC | BASE_EXT_STRING, &tv_type_ext, 0x7F,\r\n"The type of TV.", HFILL }},\r\n{ &hf_llrp_tlv_len,\r\n{ "Length", "llrp.tlv_len", FT_UINT16, BASE_DEC, NULL, 0,\r\n"The length of this TLV.", HFILL }},\r\n{ &hf_llrp_param,\r\n{ "Parameter", "llrp.param", FT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_num_gpi,\r\n{ "Number of GPI ports", "llrp.param.num_gpi", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_num_gpo,\r\n{ "Number of GPO ports", "llrp.param.num_gpo", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_microseconds,\r\n{ "Microseconds", "llrp.param.microseconds", FT_UINT64, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_max_supported_antenna,\r\n{ "Max number of antenna supported", "llrp.param.max_supported_antenna", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_can_set_antenna_prop,\r\n{ "Can set antenna properties", "llrp.param.can_set_antenna_prop", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x8000,\r\nNULL, HFILL }},\r\n{ &hf_llrp_has_utc_clock,\r\n{ "Has UTC clock capabilities", "llrp.param.has_utc_clock", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x4000,\r\nNULL, HFILL }},\r\n{ &hf_llrp_device_manufacturer,\r\n{ "Device manufacturer name", "llrp.param.device_manufacturer", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_model,\r\n{ "Model name", "llrp.param.model", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_firmware_version,\r\n{ "Reader firmware version", "llrp.param.firmware_version", FT_UINT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_max_receive_sense,\r\n{ "Maximum sensitivity value", "llrp.param.max_receive_sense", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_index,\r\n{ "Index", "llrp.param.index", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_receive_sense,\r\n{ "Receive sensitivity value", "llrp.param.receive_sense", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_receive_sense_index_min,\r\n{ "Receive sensitivity index min", "llrp.param.receive_sense_index_min", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_receive_sense_index_max,\r\n{ "Receive sensitivity index max", "llrp.param.receive_sense_index_max", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_num_protocols,\r\n{ "Number of protocols", "llrp.param.num_protocols", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_protocol_id,\r\n{ "Protocol ID", "llrp.param.protocol_id", FT_UINT8, BASE_DEC | BASE_RANGE_STRING, RVALS(protocol_id), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_can_do_survey,\r\n{ "Can do RF survey", "llrp.param.can_do_survey", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x80,\r\nNULL, HFILL }},\r\n{ &hf_llrp_can_report_buffer_warning,\r\n{ "Can report buffer fill warning", "llrp.param.can_report_buffer_warning", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x40,\r\nNULL, HFILL }},\r\n{ &hf_llrp_support_client_opspec,\r\n{ "Support client request OpSpec", "llrp.param.support_client_opspec", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x20,\r\nNULL, HFILL }},\r\n{ &hf_llrp_can_stateaware,\r\n{ "Can do tag inventory state aware singulation", "llrp.param.can_stateaware", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x10,\r\nNULL, HFILL }},\r\n{ &hf_llrp_support_holding,\r\n{ "Support event and report holding", "llrp.param.support_holding", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x08,\r\nNULL, HFILL }},\r\n{ &hf_llrp_max_priority_supported,\r\n{ "Max priority level supported", "llrp.param.max_priority_supported", FT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_client_opspec_timeout,\r\n{ "Client request OpSpec timeout", "llrp.param.client_opspec_timeout", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_max_num_rospec,\r\n{ "Maximum number of ROSpecs", "llrp.param.max_num_rospec", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_max_num_spec_per_rospec,\r\n{ "Maximum number of spec per ROSpec", "llrp.param.max_num_spec_per_rospec", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_max_num_inventory_per_aispec,\r\n{ "Maximum number of Inventory Spec per AISpec", "llrp.param.max_num_inventory_per_aispec", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_max_num_accessspec,\r\n{ "Maximum number of AccessSpec", "llrp.param.max_num_accessspec", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_max_num_opspec_per_accressspec,\r\n{ "Maximum number of OpSpec per AccessSpec", "llrp.param.max_num_opspec_per_accressspec", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_country_code,\r\n{ "Contry code", "llrp.param.country_code", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_comm_standard,\r\n{ "Communication standard", "llrp.param.comm_standard", FT_UINT16, BASE_DEC | BASE_EXT_STRING, &comm_standard_ext, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_transmit_power,\r\n{ "Transmit power value", "llrp.param.transmit_power", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_hopping,\r\n{ "Hopping", "llrp.param.hopping", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x80,\r\nNULL, HFILL }},\r\n{ &hf_llrp_hop_table_id,\r\n{ "Hop table ID", "llrp.param.hop_table_id", FT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_rfu,\r\n{ "Reserved for future use", "llrp.param.rfu", FT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_num_hops,\r\n{ "Number of hops", "llrp.param.num_hops", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_frequency,\r\n{ "Frequency", "llrp.param.frequency", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_num_freqs,\r\n{ "Number of frequencies", "llrp.param.num_freqs", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_min_freq,\r\n{ "Minimum frequency", "llrp.param.min_freq", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_max_freq,\r\n{ "Maximum frequency", "llrp.param.max_freq", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_rospec_id,\r\n{ "ROSpec ID", "llrp.param.rospec_id", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_priority,\r\n{ "Priority", "llrp.param.priority", FT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_cur_state,\r\n{ "Current state", "llrp.param.cur_state", FT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_rospec_start_trig_type,\r\n{ "ROSpec start trigger type", "llrp.param.rospec_start_trig_type", FT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_offset,\r\n{ "Offset", "llrp.param.offset", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_period,\r\n{ "Period", "llrp.param.period", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_gpi_event,\r\n{ "GPI event", "llrp.param.gpi_event", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x80,\r\nNULL, HFILL }},\r\n{ &hf_llrp_timeout,\r\n{ "Timeout", "llrp.param.timeout", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_rospec_stop_trig_type,\r\n{ "ROSpec stop trigger type", "llrp.param.rospec_stop_trig_type", FT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_duration_trig,\r\n{ "Duration trigger value", "llrp.param.duration_trig", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_antenna_count,\r\n{ "Antenna count", "llrp.param.antenna_count", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_antenna,\r\n{ "Antenna ID", "llrp.param.antenna", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_aispec_stop_trig_type,\r\n{ "AISpec stop trigger type", "llrp.param.aispec_stop_trig_type", FT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_trig_type,\r\n{ "Trigger type", "llrp.param.trig_type", FT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_number_of_tags,\r\n{ "Number of tags", "llrp.param.number_of_tags", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_number_of_attempts,\r\n{ "Number of attempts", "llrp.param.number_of_attempts", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_t,\r\n{ "T", "llrp.param.t", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_inventory_spec_id,\r\n{ "Inventory parameter spec id", "llrp.param.inventory_spec_id", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_start_freq,\r\n{ "Start frequency", "llrp.param.start_freq", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_stop_freq,\r\n{ "Stop frequency", "llrp.param.stop_freq", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_stop_trig_type,\r\n{ "Stop trigger type", "llrp.param.stop_trig_type", FT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_n_4,\r\n{ "N", "llrp.param.n_4", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_duration,\r\n{ "Duration", "llrp.param.duration", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_accessspec_id,\r\n{ "AccessSpec ID", "llrp.param.accessspec_id", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_access_cur_state,\r\n{ "Current state", "llrp.param.access_cur_state", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x80,\r\nNULL, HFILL }},\r\n{ &hf_llrp_access_stop_trig_type,\r\n{ "AccessSpec Stop trigger", "llrp.param.access_stop_trig_type", FT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_operation_count,\r\n{ "Operation count value", "llrp.param.operation_count", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_opspec_id,\r\n{ "OpSpec ID", "llrp.param.opspec_id", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_conf_value,\r\n{ "Configuration value", "llrp.param.conf_value", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_id_type,\r\n{ "ID type", "llrp.param.id_type", FT_UINT8, BASE_DEC, VALS(id_type), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_reader_id,\r\n{ "Reader ID", "llrp.param.reader_id", FT_UINT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_gpo_data,\r\n{ "GPO data", "llrp.param.gpo_data", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x80,\r\nNULL, HFILL }},\r\n{ &hf_llrp_keepalive_trig_type,\r\n{ "KeepAlive trigger type", "llrp.param.keepalive_trig_type", FT_UINT8, BASE_DEC, VALS(keepalive_type), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_time_iterval,\r\n{ "Time interval", "llrp.param.time_iterval", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_antenna_connected,\r\n{ "Antenna connected", "llrp.param.antenna_connected", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x80,\r\nNULL, HFILL }},\r\n{ &hf_llrp_antenna_gain,\r\n{ "Antenna gain", "llrp.param.antenna_gain", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_receiver_sense,\r\n{ "Receiver sensitivity", "llrp.param.receiver_sense", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_channel_idx,\r\n{ "Channel index", "llrp.param.channel_idx", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_gpi_config,\r\n{ "GPI config", "llrp.param.gpi_config", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x80,\r\nNULL, HFILL }},\r\n{ &hf_llrp_gpi_state,\r\n{ "GPI state", "llrp.param.gpi_state", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_hold_events_and_reports,\r\n{ "Hold events and reports upon reconnect", "llrp.param.hold_events_and_reports", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x80,\r\nNULL, HFILL }},\r\n{ &hf_llrp_ro_report_trig,\r\n{ "RO report trigger", "llrp.param.ro_report_trig", FT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_n_2,\r\n{ "N", "llrp.param.n_2", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_enable_rospec_id,\r\n{ "Enable ROSpec ID", "llrp.param.enable_rospec_id", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x8000,\r\nNULL, HFILL }},\r\n{ &hf_llrp_enable_spec_idx,\r\n{ "Enable spec index", "llrp.param.enable_spec_idx", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x4000,\r\nNULL, HFILL }},\r\n{ &hf_llrp_enable_inv_spec_id,\r\n{ "Enable inventory spec ID", "llrp.param.enable_inv_spec_id", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x2000,\r\nNULL, HFILL }},\r\n{ &hf_llrp_enable_antenna_id,\r\n{ "Enable antenna ID", "llrp.param.enable_antenna_id", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x1000,\r\nNULL, HFILL }},\r\n{ &hf_llrp_enable_channel_idx,\r\n{ "Enable channel index", "llrp.param.enable_channel_idx", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0800,\r\nNULL, HFILL }},\r\n{ &hf_llrp_enable_peak_rssi,\r\n{ "Enable peak RSSI", "llrp.param.enable_peak_rssi", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0400,\r\nNULL, HFILL }},\r\n{ &hf_llrp_enable_first_seen,\r\n{ "Enable first seen timestamp", "llrp.param.enable_first_seen", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0200,\r\nNULL, HFILL }},\r\n{ &hf_llrp_enable_last_seen,\r\n{ "Enable last seen timestamp", "llrp.param.enable_last_seen", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0100,\r\nNULL, HFILL }},\r\n{ &hf_llrp_enable_seen_count,\r\n{ "Enable tag seen count", "llrp.param.enable_seen_count", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0080,\r\nNULL, HFILL }},\r\n{ &hf_llrp_enable_accessspec_id,\r\n{ "Enable AccessSpec ID", "llrp.param.enable_accessspec_id", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x0040,\r\nNULL, HFILL }},\r\n{ &hf_llrp_access_report_trig,\r\n{ "Access report trigger", "llrp.param.access_report_trig", FT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_length_bits,\r\n{ "Bit field length (bits)", "llrp.param.length_bits", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_epc,\r\n{ "EPC", "llrp.param.epc", FT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_spec_idx,\r\n{ "Spec index", "llrp.param.spec_idx", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_peak_rssi,\r\n{ "Peak RSSI", "llrp.param.peak_rssi", FT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_tag_count,\r\n{ "Tag count", "llrp.param.tag_count", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_bandwidth,\r\n{ "Bandwidth", "llrp.param.bandwidth", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_average_rssi,\r\n{ "Average RSSI", "llrp.param.average_rssi", FT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_notif_state,\r\n{ "Notification state", "llrp.param.notif_state", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x80,\r\nNULL, HFILL }},\r\n{ &hf_llrp_event_type,\r\n{ "Event type", "llrp.param.event_type", FT_UINT16, BASE_DEC | BASE_EXT_STRING, &event_type_ext, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_next_chan_idx,\r\n{ "Next channel index", "llrp.param.next_chan_idx", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_roevent_type,\r\n{ "Event type", "llrp.param.roevent_type", FT_UINT8, BASE_DEC, VALS(roevent_type), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_prem_rospec_id,\r\n{ "Preempting ROSpec ID", "llrp.param.prem_rospec_id", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_buffer_full_percentage,\r\n{ "Report Buffer percentage full", "llrp.param.buffer_full_percentage", FT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_message,\r\n{ "Message", "llrp.param.message", FT_UINT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_rfevent_type,\r\n{ "Event type", "llrp.param.rfevent_type", FT_UINT8, BASE_DEC, VALS(rfevent_type), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_aievent_type,\r\n{ "Event type", "llrp.param.aievent_type", FT_UINT8, BASE_DEC, VALS(aievent_type), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_antenna_event_type,\r\n{ "Event type", "llrp.param.antenna_event_type", FT_UINT8, BASE_DEC, VALS(antenna_event_type), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_conn_status,\r\n{ "Status", "llrp.param.conn_status", FT_UINT16, BASE_DEC, VALS(connection_status), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_loop_count,\r\n{ "Loop count", "llrp.param.loop_count", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_status_code,\r\n{ "Status code", "llrp.param.status_code", FT_UINT16, BASE_DEC | BASE_EXT_STRING, &status_code_ext, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_error_desc,\r\n{ "Error Description", "llrp.param.error_desc", FT_UINT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_field_num,\r\n{ "Field number", "llrp.param.field_num", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_error_code,\r\n{ "Error code", "llrp.param.error_code", FT_UINT16, BASE_DEC | BASE_EXT_STRING, &status_code_ext, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_parameter_type,\r\n{ "Parameter type", "llrp.param.parameter_type", FT_UINT16, BASE_DEC | BASE_EXT_STRING, &tlv_type_ext, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_can_support_block_erase,\r\n{ "Can support block erase", "llrp.param.can_support_block_erase", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x80,\r\nNULL, HFILL }},\r\n{ &hf_llrp_can_support_block_write,\r\n{ "Can support block write", "llrp.param.can_support_block_write", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x40,\r\nNULL, HFILL }},\r\n{ &hf_llrp_can_support_block_permalock,\r\n{ "Can support block permalock", "llrp.param.can_support_block_permalock", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x20,\r\nNULL, HFILL }},\r\n{ &hf_llrp_can_support_tag_recomm,\r\n{ "Can support tag recommisioning", "llrp.param.can_support_tag_recomm", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x10,\r\nNULL, HFILL }},\r\n{ &hf_llrp_can_support_UMI_method2,\r\n{ "Can support UMI method 2", "llrp.param.can_support_UMI_method2", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x08,\r\nNULL, HFILL }},\r\n{ &hf_llrp_can_support_XPC,\r\n{ "Can support XPC", "llrp.param.can_support_XPC", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x04,\r\nNULL, HFILL }},\r\n{ &hf_llrp_max_num_filter_per_query,\r\n{ "Maximum number of select filters per query", "llrp.param.max_num_filter_per_query", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_mode_ident,\r\n{ "Mode identifier", "llrp.param.mode_ident", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_DR,\r\n{ "DR", "llrp.param.DR", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x80,\r\nNULL, HFILL }},\r\n{ &hf_llrp_hag_conformance,\r\n{ "EPC HAG T&C Conformance", "llrp.param.hag_conformance", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x40,\r\nNULL, HFILL }},\r\n{ &hf_llrp_mod,\r\n{ "M", "llrp.param.mod", FT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_flm,\r\n{ "Forward link modulation", "llrp.param.flm", FT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_m,\r\n{ "Spectral mask indicator", "llrp.param.m", FT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_bdr,\r\n{ "BDR", "llrp.param.bdr", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_pie,\r\n{ "PIE", "llrp.param.pie", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_min_tari,\r\n{ "Minimum tari", "llrp.param.min_tari", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_max_tari,\r\n{ "Maximum tari", "llrp.param.max_tari", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_step_tari,\r\n{ "Tari step", "llrp.param.step_tari", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_inventory_state_aware,\r\n{ "Tag inventory state aware", "llrp.param.inventory_state_aware", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x80,\r\nNULL, HFILL }},\r\n{ &hf_llrp_trunc,\r\n{ "T", "llrp.param.trunc", FT_UINT8, BASE_DEC, NULL, 0xC0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_mb,\r\n{ "MB", "llrp.param.mb", FT_UINT8, BASE_DEC, NULL, 0xC0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_pointer,\r\n{ "Pointer", "llrp.param.pointer", FT_UINT16, BASE_DEC_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_tag_mask,\r\n{ "Tag mask", "llrp.param.tag_mask", FT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_aware_filter_target,\r\n{ "Target", "llrp.param.aware_filter_target", FT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_aware_filter_action,\r\n{ "Action", "llrp.param.aware_filter_action", FT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_unaware_filter_action,\r\n{ "Action", "llrp.param.unaware_filter_action", FT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_mode_idx,\r\n{ "Mode index", "llrp.param.mode_idx", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_tari,\r\n{ "Tari", "llrp.param.tari", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_session,\r\n{ "Session", "llrp.param.session", FT_UINT8, BASE_DEC, NULL, 0xC0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_tag_population,\r\n{ "Tag population", "llrp.param.tag_population", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_tag_transit_time,\r\n{ "Tag tranzit time", "llrp.param.tag_transit_time", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_sing_i,\r\n{ "I", "llrp.param.sing_i", FT_BOOLEAN, 8, TFS(&tfs_state_a_b), 0x80,\r\nNULL, HFILL }},\r\n{ &hf_llrp_sing_s,\r\n{ "S", "llrp.param.sing_s", FT_BOOLEAN, 8, TFS(&tfs_sl), 0x40,\r\nNULL, HFILL }},\r\n{ &hf_llrp_sing_a,\r\n{ "S_All", "llrp.param.sing_a", FT_BOOLEAN, 8, TFS(&tfs_all_no), 0x20,\r\nNULL, HFILL }},\r\n{ &hf_llrp_match,\r\n{ "Match", "llrp.param.match", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x20,\r\nNULL, HFILL }},\r\n{ &hf_llrp_tag_data,\r\n{ "Tag data", "llrp.param.tag_data", FT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_access_pass,\r\n{ "Access password", "llrp.param.access_pass", FT_UINT32, BASE_DEC_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_word_pointer,\r\n{ "Word pointer", "llrp.param.word_pointer", FT_UINT16, BASE_DEC_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_word_count,\r\n{ "Word count", "llrp.param.word_count", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_write_data,\r\n{ "Write data", "llrp.param.write_data", FT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_kill_pass,\r\n{ "Killpassword", "llrp.param.kill_pass", FT_UINT32, BASE_DEC_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_kill_3,\r\n{ "3", "llrp.param.kill_3", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x04,\r\nNULL, HFILL }},\r\n{ &hf_llrp_kill_2,\r\n{ "2", "llrp.param.kill_2", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x02,\r\nNULL, HFILL }},\r\n{ &hf_llrp_kill_l,\r\n{ "L", "llrp.param.kill_l", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x01,\r\nNULL, HFILL }},\r\n{ &hf_llrp_privilege,\r\n{ "Privilege", "llrp.param.privilege", FT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_data_field,\r\n{ "Data field", "llrp.param.data_field", FT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_block_pointer,\r\n{ "Block pointer", "llrp.param.block_pointer", FT_UINT16, BASE_DEC_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_block_mask,\r\n{ "Block mask", "llrp.param.block_mask", FT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_length_words,\r\n{ "Field Length (words)", "llrp.param.length_words", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_block_range,\r\n{ "Block range", "llrp.param.block_range", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_enable_crc,\r\n{ "Enable CRC", "llrp.param.enable_crc", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x80,\r\nNULL, HFILL }},\r\n{ &hf_llrp_enable_pc,\r\n{ "Enable PC bits", "llrp.param.enable_pc", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x40,\r\nNULL, HFILL }},\r\n{ &hf_llrp_enable_xpc,\r\n{ "Enable XPC bits", "llrp.param.enable_xpc", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x20,\r\nNULL, HFILL }},\r\n{ &hf_llrp_pc_bits,\r\n{ "PC bits", "llrp.param.pc_bits", FT_UINT16, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_xpc_w1,\r\n{ "XPC-W1", "llrp.param.xpc_w1", FT_UINT16, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_xpc_w2,\r\n{ "XPC-W2", "llrp.param.xpc_w2", FT_UINT16, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_crc,\r\n{ "CRC", "llrp.param.crc", FT_UINT16, BASE_HEX, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_num_coll,\r\n{ "Number of collisions", "llrp.param.num_coll", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_num_empty,\r\n{ "Number of empty slots", "llrp.param.num_empty", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_access_result,\r\n{ "Result", "llrp.param.access_result", FT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_read_data,\r\n{ "Read data", "llrp.param.read_data", FT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_num_words_written,\r\n{ "Number of words written", "llrp.param.num_words_written", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_permlock_status,\r\n{ "Read data", "llrp.param.permlock_status", FT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_vendor_id,\r\n{ "Vendor ID", "llrp.param.vendor_id", FT_UINT32, BASE_DEC, VALS(llrp_vendors), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_impinj_param_type,\r\n{ "Impinj parameter subtype", "llrp.param.impinj_param_type", FT_UINT32, BASE_DEC | BASE_EXT_STRING, &impinj_param_type_ext, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_save_config,\r\n{ "Save configuration", "llrp.param.save_config", FT_BOOLEAN, 8, TFS(&tfs_yes_no), 0x80,\r\nNULL, HFILL }},\r\n{ &hf_llrp_impinj_req_data,\r\n{ "Requested data", "llrp.param.impinj_req_data", FT_UINT32, BASE_DEC | BASE_EXT_STRING, &impinj_req_data_ext, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_impinj_reg_region,\r\n{ "Regulatory region", "llrp.param.impinj_reg_region", FT_UINT16, BASE_DEC | BASE_EXT_STRING, &impinj_reg_region_ext, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_impinj_search_mode,\r\n{ "Inventory search mode", "llrp.param.impinj_search_mode", FT_UINT16, BASE_DEC, VALS(impinj_search_mode), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_impinj_en_tag_dir,\r\n{ "Enable tag direction", "llrp.param.impinj_en_tag_dir", FT_BOOLEAN, 16, TFS(&tfs_yes_no), 0x8000,\r\nNULL, HFILL }},\r\n{ &hf_llrp_impinj_antenna_conf,\r\n{ "Antenna configuration", "llrp.param.impinj_antenna_conf", FT_UINT16, BASE_DEC, VALS(impinj_ant_conf), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_decision_time,\r\n{ "Decision timestamp", "llrp.param.decision_time", FT_UINT64, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_impinj_tag_dir,\r\n{ "Tag direction", "llrp.param.impinj_tag_dir", FT_UINT16, BASE_DEC, VALS(impinj_tag_dir), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_confidence,\r\n{ "Confidence", "llrp.param.confidence", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_impinj_fix_freq_mode,\r\n{ "Fixed frequency mode", "llrp.param.impinj_fix_freq_mode", FT_UINT16, BASE_DEC, VALS(impinj_fix_freq_mode), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_num_channels,\r\n{ "Number of channels", "llrp.param.num_channels", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_channel,\r\n{ "Channel", "llrp.param.channel", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_impinj_reduce_power_mode,\r\n{ "Recuced power mode", "llrp.param.impinj_reduce_power_mode", FT_UINT16, BASE_DEC, VALS(impinj_boolean), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_impinj_low_duty_mode,\r\n{ "Low duty cycle mode", "llrp.param.impinj_low_duty_mode", FT_UINT16, BASE_DEC, VALS(impinj_boolean), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_empty_field_timeout,\r\n{ "Empty field timeout", "llrp.param.empty_field_timeout", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_field_ping_interval,\r\n{ "Field ping interval", "llrp.param.field_ping_interval", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_model_name,\r\n{ "Model name", "llrp.param.model_name", FT_UINT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_serial_number,\r\n{ "Serial number", "llrp.param.serial_number", FT_UINT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_soft_ver,\r\n{ "Softwave version", "llrp.param.soft_ver", FT_UINT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_firm_ver,\r\n{ "Firmware version", "llrp.param.firm_ver", FT_UINT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_fpga_ver,\r\n{ "FPGA version", "llrp.param.fpga_ver", FT_UINT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_pcba_ver,\r\n{ "PCBA version", "llrp.param.pcba_ver", FT_UINT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_height_thresh,\r\n{ "Height threshold", "llrp.param.height_thresh", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_zero_motion_thresh,\r\n{ "Zero motion threshold", "llrp.param.zero_motion_thresh", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_board_manufacturer,\r\n{ "Board manufacturer", "llrp.param.board_manufacturer", FT_UINT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_fw_ver_hex,\r\n{ "Firmware version", "llrp.param.fw_ver_hex", FT_UINT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_hw_ver_hex,\r\n{ "Hardware version", "llrp.param.hw_ver_hex", FT_UINT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_gpi_debounce,\r\n{ "GPI debounce timer Msec", "llrp.param.gpi_debounce", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_temperature,\r\n{ "Temperature", "llrp.param.temperature", FT_INT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_impinj_link_monitor_mode,\r\n{ "Link monitor mode", "llrp.param.impinj_link_monitor_mode", FT_UINT16, BASE_DEC, VALS(impinj_boolean), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_link_down_thresh,\r\n{ "Link down threshold", "llrp.param.link_down_thresh", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_impinj_report_buff_mode,\r\n{ "Report buffer mode", "llrp.param.impinj_report_buff_mode", FT_UINT16, BASE_DEC, VALS(impinj_report_buff_mode), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_permalock_result,\r\n{ "Result", "llrp.param.permalock_result", FT_UINT8, BASE_DEC | BASE_EXT_STRING, &impinj_permalock_result_ext, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_block_permalock_result,\r\n{ "Result", "llrp.param.block_permalock_result", FT_UINT8, BASE_DEC | BASE_EXT_STRING, &impinj_block_permalock_result_ext, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_impinj_data_profile,\r\n{ "Data profile", "llrp.param.impinj_data_profile", FT_UINT8, BASE_DEC, VALS(impinj_data_profile), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_impinj_access_range,\r\n{ "Access range", "llrp.param.impinj_access_range", FT_UINT8, BASE_DEC, VALS(impinj_access_range), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_impinj_persistence,\r\n{ "Persistence", "llrp.param.impinj_persistence", FT_UINT8, BASE_DEC, VALS(impinj_persistence), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_set_qt_config_result,\r\n{ "Result", "llrp.param.set_qt_config_result", FT_UINT8, BASE_DEC | BASE_EXT_STRING, &impinj_set_qt_config_result_ext, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_get_qt_config_result,\r\n{ "Result", "llrp.param.get_qt_config_result", FT_UINT8, BASE_DEC | BASE_EXT_STRING, &impinj_get_qt_config_result_ext, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_impinj_serialized_tid_mode,\r\n{ "Serialized TID Mode", "llrp.param.impinj_serialized_tid_mode", FT_UINT16, BASE_DEC, VALS(impinj_boolean), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_impinj_rf_phase_mode,\r\n{ "RF phase angle mode", "llrp.param.impinj_rf_phase_mode", FT_UINT16, BASE_DEC, VALS(impinj_boolean), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_impinj_peak_rssi_mode,\r\n{ "Peak RSSI mode", "llrp.param.impinj_peak_rssi_mode", FT_UINT16, BASE_DEC, VALS(impinj_boolean), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_impinj_gps_coordinates_mode,\r\n{ "GPS coordinates mode", "llrp.param.impinj_gps_coordinates_mode", FT_UINT16, BASE_DEC, VALS(impinj_boolean), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_impinj_tid,\r\n{ "TID", "llrp.param.impinj_tid", FT_UINT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_phase_angle,\r\n{ "Phase angle", "llrp.param.phase_angle", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_rssi,\r\n{ "RSSI", "llrp.param.rssi", FT_INT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_latitude,\r\n{ "Latitude", "llrp.param.latitude", FT_INT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_longitude,\r\n{ "Longitude", "llrp.param.longitude", FT_INT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_gga_sentence,\r\n{ "GGA sentence", "llrp.param.gga_sentence", FT_UINT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_rmc_sentence,\r\n{ "RMC sentence", "llrp.param.rmc_sentence", FT_UINT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_impinj_optim_read_mode,\r\n{ "Optimized read mode", "llrp.param.impinj_optim_read_mode", FT_UINT16, BASE_DEC, VALS(impinj_boolean), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_impinj_rf_doppler_mode,\r\n{ "RF doppler frequency mode", "llrp.param.impinj_rf_doppler_mode", FT_UINT16, BASE_DEC, VALS(impinj_boolean), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_retry_count,\r\n{ "Retry count", "llrp.param.retry_count", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_impinj_access_spec_ordering,\r\n{ "AccessSpec ordering", "llrp.param.impinj_access_spec_ordering", FT_UINT16, BASE_DEC, VALS(impinj_access_spec_ordering), 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_impinj_gpo_mode,\r\n{ "GPO mode", "llrp.param.impinj_gpo_mode", FT_UINT16, BASE_DEC | BASE_EXT_STRING, &impinj_gpo_mode_ext, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_gpo_pulse_dur,\r\n{ "GPO pulse duration", "llrp.param.gpo_pulse_dur", FT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_impinj_hub_id,\r\n{ "Hub ID", "llrp.impinj_hub_id", FT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_impinj_hub_fault_type,\r\n{ "Hub fault type", "llrp.param.impinj_hub_fault_type", FT_UINT16, BASE_DEC | BASE_EXT_STRING, &impinj_hub_fault_type_ext, 0,\r\nNULL, HFILL }},\r\n{ &hf_llrp_impinj_hub_connected_type,\r\n{ "Hub connected type", "llrp.param.impinj_hub_connected_type", FT_UINT16, BASE_DEC | BASE_EXT_STRING, &impinj_hub_connected_type_ext, 0,\r\nNULL, HFILL }},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_llrp,\r\n&ett_llrp_param\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_llrp_invalid_length, { "llrp.invalid_length_of_string_claimed", PI_MALFORMED, PI_ERROR, "invalid length of string: claimed %u, available %u.", EXPFILL }},\r\n{ &ei_llrp_req_conf, { "llrp.req_conf.invalid", PI_PROTOCOL, PI_ERROR, "Unrecognized configuration request: %u", EXPFILL }},\r\n};\r\nexpert_module_t* expert_llrp;\r\nproto_llrp = proto_register_protocol("Low Level Reader Protocol",\r\n"LLRP", "llrp");\r\nproto_register_field_array(proto_llrp, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_llrp = expert_register_protocol(proto_llrp);\r\nexpert_register_field_array(expert_llrp, ei, array_length(ei));\r\n}\r\nvoid\r\nproto_reg_handoff_llrp(void)\r\n{\r\ndissector_handle_t llrp_handle;\r\nllrp_handle = create_dissector_handle(dissect_llrp, proto_llrp);\r\ndissector_add_uint("tcp.port", LLRP_PORT, llrp_handle);\r\n}
