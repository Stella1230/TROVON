guint32 update_adler32(guint32 adler, const guint8 *buf, size_t len)\r\n{\r\nguint32 s1 = adler & 0xffff;\r\nguint32 s2 = (adler >> 16) & 0xffff;\r\nsize_t n;\r\nfor (n = 0; n < len; n++) {\r\ns1 = (s1 + buf[n]) % BASE;\r\ns2 = (s2 + s1) % BASE;\r\n}\r\nreturn (s2 << 16) + s1;\r\n}\r\nguint32 adler32_bytes(const guint8 *buf, size_t len)\r\n{\r\nreturn update_adler32(1, buf, len);\r\n}\r\nguint32 adler32_str(const char *buf)\r\n{\r\nreturn update_adler32(1, (const guint8*)buf, strlen(buf));\r\n}
