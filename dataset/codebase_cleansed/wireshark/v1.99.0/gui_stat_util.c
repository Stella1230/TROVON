void\r\ninit_main_stat_window(GtkWidget *window, GtkWidget *mainbox, const char *title, const char *filter)\r\n{\r\nGtkWidget *main_label;\r\nGtkWidget *filter_label;\r\nchar *filter_string;\r\ngtk_window_set_title(GTK_WINDOW(window), title);\r\ngtk_container_add(GTK_CONTAINER(window), mainbox);\r\ngtk_container_set_border_width(GTK_CONTAINER(mainbox), 10);\r\ngtk_widget_show(mainbox);\r\nmain_label = gtk_label_new(title);\r\ngtk_box_pack_start(GTK_BOX(mainbox), main_label, FALSE, FALSE, 0);\r\ngtk_widget_show(main_label);\r\nfilter_string = g_strdup_printf("Filter: %s", filter ? filter : "");\r\nfilter_label = gtk_label_new(filter_string);\r\ng_free(filter_string);\r\ngtk_label_set_line_wrap(GTK_LABEL(filter_label), TRUE);\r\ngtk_box_pack_start(GTK_BOX(mainbox), filter_label, FALSE, FALSE, 0);\r\ngtk_widget_show(filter_label);\r\n}\r\nGtkTreeView *\r\ncreate_stat_table(GtkWidget *scrolled_window, GtkWidget *vbox, int columns, const stat_column *headers)\r\n{\r\nGtkTreeView *table;\r\nGtkListStore *store;\r\nGtkWidget *tree;\r\nGtkTreeViewColumn *column;\r\nGtkTreeSelection *sel;\r\nGtkCellRenderer *renderer;\r\nGType *types;\r\nint i;\r\nif (columns <= 0)\r\nreturn NULL;\r\ntypes = (GType *)g_malloc(columns *sizeof(GType));\r\nfor (i = 0; i < columns; i++)\r\ntypes[i] = headers[i].type;\r\nstore = gtk_list_store_newv (columns, types);\r\ng_free(types);\r\ntree = gtk_tree_view_new_with_model (GTK_TREE_MODEL (store));\r\ntable = GTK_TREE_VIEW(tree);\r\ng_object_unref (G_OBJECT (store));\r\nfor (i = 0; i < columns; i++) {\r\nrenderer = gtk_cell_renderer_text_new ();\r\nif (headers[i].align == RIGHT) {\r\ng_object_set(G_OBJECT(renderer), "xalign", 1.0, NULL);\r\n}\r\ng_object_set(renderer, "ypad", 0, NULL);\r\ncolumn = gtk_tree_view_column_new_with_attributes (headers[i].title, renderer, "text",\r\ni, NULL);\r\ngtk_tree_view_column_set_resizable(column, TRUE);\r\ngtk_tree_view_append_column (table, column);\r\n}\r\ngtk_container_add(GTK_CONTAINER(scrolled_window), GTK_WIDGET (table));\r\ngtk_box_pack_start(GTK_BOX(vbox), scrolled_window, TRUE, TRUE, 0);\r\ngtk_tree_view_set_rules_hint(table, FALSE);\r\ngtk_tree_view_set_headers_clickable(table, FALSE);\r\nsel = gtk_tree_view_get_selection(GTK_TREE_VIEW(table));\r\ngtk_tree_selection_set_mode(sel, GTK_SELECTION_SINGLE);\r\ngtk_widget_show(scrolled_window);\r\nreturn table;\r\n}
