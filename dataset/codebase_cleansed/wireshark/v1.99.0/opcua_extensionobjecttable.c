void dispatchExtensionObjectType(proto_tree *tree, tvbuff_t *tvb, gint *pOffset, int TypeId)\r\n{\r\ngint iOffset = *pOffset;\r\nint indx = 0;\r\nint bFound = 0;\r\ngint32 iLen = 0;\r\niLen = tvb_get_letohl(tvb, iOffset);\r\niOffset += 4;\r\nwhile (indx < g_NumTypes)\r\n{\r\nif (g_arExtensionObjectParserTable[indx].iRequestId == TypeId)\r\n{\r\nbFound = 1;\r\n(*g_arExtensionObjectParserTable[indx].pParser)(tree, tvb, &iOffset, g_arExtensionObjectParserTable[indx].typeName);\r\nbreak;\r\n}\r\nindx++;\r\n}\r\nif (bFound == 0)\r\n{\r\nif (iLen == -1)\r\n{\r\nproto_tree_add_text(tree, tvb, *pOffset, 4, "[OpcUa Null ByteString]");\r\n}\r\nelse if (iLen >= 0)\r\n{\r\nproto_tree_add_item(tree, hf_opcua_ByteString, tvb, iOffset, iLen, ENC_NA);\r\niOffset += iLen;\r\n}\r\nelse\r\n{\r\nchar *szValue = wmem_strdup_printf(wmem_packet_scope(), "[Invalid ByteString] Invalid length: %d", iLen);\r\nproto_tree_add_text(tree, tvb, *pOffset, 4, "%s", szValue);\r\n}\r\n}\r\n*pOffset = iOffset;\r\n}
