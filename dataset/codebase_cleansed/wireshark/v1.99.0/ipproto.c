const char *ipprotostr(const int proto) {\r\nconst char *s;\r\nif ((s = try_val_to_str_ext(proto, &ipproto_val_ext)) != NULL)\r\nreturn s;\r\ns = "Unknown";\r\n#ifdef HAVE_GETPROTOBYNUMBER\r\nif (gbl_resolv_flags.mac_name || gbl_resolv_flags.network_name ||\r\ngbl_resolv_flags.transport_name || gbl_resolv_flags.concurrent_dns) {\r\nstatic char buf[128];\r\nstruct protoent *pe;\r\npe = getprotobynumber(proto);\r\nif (pe) {\r\ng_strlcpy(buf, pe->p_name, sizeof(buf));\r\ns = buf;\r\n}\r\n}\r\n#endif\r\nreturn s;\r\n}
