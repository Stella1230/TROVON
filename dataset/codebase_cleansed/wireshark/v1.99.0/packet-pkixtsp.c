static int\r\ndissect_pkixtsp_T_version(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkixtsp_OCTET_STRING(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_octet_string(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkixtsp_MessageImprint(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nMessageImprint_sequence, hf_index, ett_pkixtsp_MessageImprint);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkixtsp_TSAPolicyId(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_object_identifier(implicit_tag, actx, tree, tvb, offset, hf_index, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkixtsp_INTEGER(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkixtsp_BOOLEAN(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_boolean(implicit_tag, actx, tree, tvb, offset, hf_index, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkixtsp_TimeStampReq(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nTimeStampReq_sequence, hf_index, ett_pkixtsp_TimeStampReq);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkixtsp_PKIStatus(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkixtsp_PKIFailureInfo(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_bitstring(implicit_tag, actx, tree, tvb, offset,\r\nPKIFailureInfo_bits, hf_index, ett_pkixtsp_PKIFailureInfo,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkixtsp_PKIStatusInfo(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nPKIStatusInfo_sequence, hf_index, ett_pkixtsp_PKIStatusInfo);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkixtsp_TimeStampToken(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_cms_ContentInfo(implicit_tag, tvb, offset, actx, tree, hf_index);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkixtsp_TimeStampResp(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nTimeStampResp_sequence, hf_index, ett_pkixtsp_TimeStampResp);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkixtsp_Tst_version(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkixtsp_GeneralizedTime(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_GeneralizedTime(implicit_tag, actx, tree, tvb, offset, hf_index);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkixtsp_INTEGER_1_999(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkixtsp_Accuracy(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nAccuracy_sequence, hf_index, ett_pkixtsp_Accuracy);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_pkixtsp_TSTInfo(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nTSTInfo_sequence, hf_index, ett_pkixtsp_TSTInfo);\r\nreturn offset;\r\n}\r\nstatic void dissect_TSTInfo_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_) {\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\ndissect_pkixtsp_TSTInfo(FALSE, tvb, 0, &asn1_ctx, tree, hf_pkixtsp_TSTInfo_PDU);\r\n}\r\nstatic int\r\ndissect_timestamp_reply(tvbuff_t *tvb, packet_info *pinfo, proto_tree *parent_tree, void *data _U_)\r\n{\r\nproto_item *item=NULL;\r\nproto_tree *tree=NULL;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "PKIXTSP");\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Reply");\r\nif(parent_tree){\r\nitem=proto_tree_add_item(parent_tree, proto_pkixtsp, tvb, 0, -1, ENC_NA);\r\ntree = proto_item_add_subtree(item, ett_pkixtsp);\r\n}\r\nreturn dissect_pkixtsp_TimeStampResp(FALSE, tvb, 0, &asn1_ctx, tree, -1);\r\n}\r\nstatic int\r\ndissect_timestamp_query(tvbuff_t *tvb, packet_info *pinfo, proto_tree *parent_tree, void *data _U_)\r\n{\r\nproto_item *item=NULL;\r\nproto_tree *tree=NULL;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "PKIXTSP");\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Query");\r\nif(parent_tree){\r\nitem=proto_tree_add_item(parent_tree, proto_pkixtsp, tvb, 0, -1, ENC_NA);\r\ntree = proto_item_add_subtree(item, ett_pkixtsp);\r\n}\r\nreturn dissect_pkixtsp_TimeStampReq(FALSE, tvb, 0, &asn1_ctx, tree, -1);\r\n}\r\nvoid proto_register_pkixtsp(void) {\r\nstatic hf_register_info hf[] = {\r\n#line 1 "../../asn1/pkixtsp/packet-pkixtsp-hfarr.c"\r\n{ &hf_pkixtsp_TSTInfo_PDU,\r\n{ "TSTInfo", "pkixtsp.TSTInfo_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkixtsp_version,\r\n{ "version", "pkixtsp.version",\r\nFT_INT32, BASE_DEC, VALS(pkixtsp_T_version_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_pkixtsp_messageImprint,\r\n{ "messageImprint", "pkixtsp.messageImprint_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkixtsp_reqPolicy,\r\n{ "reqPolicy", "pkixtsp.reqPolicy",\r\nFT_OID, BASE_NONE, NULL, 0,\r\n"TSAPolicyId", HFILL }},\r\n{ &hf_pkixtsp_nonce,\r\n{ "nonce", "pkixtsp.nonce",\r\nFT_INT32, BASE_DEC, NULL, 0,\r\n"INTEGER", HFILL }},\r\n{ &hf_pkixtsp_certReq,\r\n{ "certReq", "pkixtsp.certReq",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0,\r\n"BOOLEAN", HFILL }},\r\n{ &hf_pkixtsp_extensions,\r\n{ "extensions", "pkixtsp.extensions",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkixtsp_hashAlgorithm,\r\n{ "hashAlgorithm", "pkixtsp.hashAlgorithm_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"AlgorithmIdentifier", HFILL }},\r\n{ &hf_pkixtsp_hashedMessage,\r\n{ "hashedMessage", "pkixtsp.hashedMessage",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"OCTET_STRING", HFILL }},\r\n{ &hf_pkixtsp_status,\r\n{ "status", "pkixtsp.status_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"PKIStatusInfo", HFILL }},\r\n{ &hf_pkixtsp_timeStampToken,\r\n{ "timeStampToken", "pkixtsp.timeStampToken_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkixtsp_pki_status,\r\n{ "status", "pkixtsp.status",\r\nFT_INT32, BASE_DEC, VALS(pkixtsp_PKIStatus_vals), 0,\r\n"PKIStatus", HFILL }},\r\n{ &hf_pkixtsp_failInfo,\r\n{ "failInfo", "pkixtsp.failInfo",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"PKIFailureInfo", HFILL }},\r\n{ &hf_pkixtsp_tst_version,\r\n{ "version", "pkixtsp.version",\r\nFT_INT32, BASE_DEC, VALS(pkixtsp_Tst_version_vals), 0,\r\n"Tst_version", HFILL }},\r\n{ &hf_pkixtsp_policy,\r\n{ "policy", "pkixtsp.policy",\r\nFT_OID, BASE_NONE, NULL, 0,\r\n"TSAPolicyId", HFILL }},\r\n{ &hf_pkixtsp_serialNumber,\r\n{ "serialNumber", "pkixtsp.serialNumber",\r\nFT_INT32, BASE_DEC, NULL, 0,\r\n"INTEGER", HFILL }},\r\n{ &hf_pkixtsp_genTime,\r\n{ "genTime", "pkixtsp.genTime",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\n"GeneralizedTime", HFILL }},\r\n{ &hf_pkixtsp_accuracy,\r\n{ "accuracy", "pkixtsp.accuracy_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_pkixtsp_ordering,\r\n{ "ordering", "pkixtsp.ordering",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0,\r\n"BOOLEAN", HFILL }},\r\n{ &hf_pkixtsp_tsa,\r\n{ "tsa", "pkixtsp.tsa",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"GeneralName", HFILL }},\r\n{ &hf_pkixtsp_seconds,\r\n{ "seconds", "pkixtsp.seconds",\r\nFT_INT32, BASE_DEC, NULL, 0,\r\n"INTEGER", HFILL }},\r\n{ &hf_pkixtsp_millis,\r\n{ "millis", "pkixtsp.millis",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"INTEGER_1_999", HFILL }},\r\n{ &hf_pkixtsp_micros,\r\n{ "micros", "pkixtsp.micros",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"INTEGER_1_999", HFILL }},\r\n{ &hf_pkixtsp_PKIFailureInfo_badAlg,\r\n{ "badAlg", "pkixtsp.badAlg",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }},\r\n{ &hf_pkixtsp_PKIFailureInfo_badRequest,\r\n{ "badRequest", "pkixtsp.badRequest",\r\nFT_BOOLEAN, 8, NULL, 0x20,\r\nNULL, HFILL }},\r\n{ &hf_pkixtsp_PKIFailureInfo_badDataFormat,\r\n{ "badDataFormat", "pkixtsp.badDataFormat",\r\nFT_BOOLEAN, 8, NULL, 0x04,\r\nNULL, HFILL }},\r\n{ &hf_pkixtsp_PKIFailureInfo_timeNotAvailable,\r\n{ "timeNotAvailable", "pkixtsp.timeNotAvailable",\r\nFT_BOOLEAN, 8, NULL, 0x02,\r\nNULL, HFILL }},\r\n{ &hf_pkixtsp_PKIFailureInfo_unacceptedPolicy,\r\n{ "unacceptedPolicy", "pkixtsp.unacceptedPolicy",\r\nFT_BOOLEAN, 8, NULL, 0x01,\r\nNULL, HFILL }},\r\n{ &hf_pkixtsp_PKIFailureInfo_unacceptedExtension,\r\n{ "unacceptedExtension", "pkixtsp.unacceptedExtension",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }},\r\n{ &hf_pkixtsp_PKIFailureInfo_addInfoNotAvailable,\r\n{ "addInfoNotAvailable", "pkixtsp.addInfoNotAvailable",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\nNULL, HFILL }},\r\n{ &hf_pkixtsp_PKIFailureInfo_systemFailure,\r\n{ "systemFailure", "pkixtsp.systemFailure",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\nNULL, HFILL }},\r\n#line 104 "../../asn1/pkixtsp/packet-pkixtsp-template.c"\r\n};\r\nstatic gint *ett[] = {\r\n&ett_pkixtsp,\r\n#line 1 "../../asn1/pkixtsp/packet-pkixtsp-ettarr.c"\r\n&ett_pkixtsp_TimeStampReq,\r\n&ett_pkixtsp_MessageImprint,\r\n&ett_pkixtsp_TimeStampResp,\r\n&ett_pkixtsp_PKIStatusInfo,\r\n&ett_pkixtsp_PKIFailureInfo,\r\n&ett_pkixtsp_TSTInfo,\r\n&ett_pkixtsp_Accuracy,\r\n#line 110 "../../asn1/pkixtsp/packet-pkixtsp-template.c"\r\n};\r\nproto_pkixtsp = proto_register_protocol(PNAME, PSNAME, PFNAME);\r\nproto_register_field_array(proto_pkixtsp, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid proto_reg_handoff_pkixtsp(void) {\r\ndissector_handle_t timestamp_reply_handle;\r\ndissector_handle_t timestamp_query_handle;\r\ntimestamp_reply_handle = new_create_dissector_handle(dissect_timestamp_reply, proto_pkixtsp);\r\ndissector_add_string("media_type", "application/timestamp-reply", timestamp_reply_handle);\r\ntimestamp_query_handle = new_create_dissector_handle(dissect_timestamp_query, proto_pkixtsp);\r\ndissector_add_string("media_type", "application/timestamp-query", timestamp_query_handle);\r\n#line 1 "../../asn1/pkixtsp/packet-pkixtsp-dis-tab.c"\r\nregister_ber_oid_dissector("1.2.840.113549.1.9.16.1.4", dissect_TSTInfo_PDU, proto_pkixtsp, "id-ct-TSTInfo");\r\n#line 134 "../../asn1/pkixtsp/packet-pkixtsp-template.c"\r\n}
