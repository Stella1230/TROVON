gboolean check_fcs(tvbuff_t *p, guint8 len, guint8 offset, guint8 received_fcs){\r\nguint8 FCS = 0xFF;\r\nguint8 tmp = 0;\r\nwhile (len--) {\r\ntmp = FCS^tvb_get_guint8(p,offset);\r\noffset++;\r\nFCS=crctable[tmp];\r\n}\r\nFCS=crctable[FCS^received_fcs];\r\nif (FCS==0xCF) {\r\nreturn TRUE;\r\n}\r\nelse {\r\nreturn FALSE;\r\n}\r\n}\r\nguint8 get_crc8_ieee8023_epon(tvbuff_t *p, guint8 len, guint8 offset) {\r\nguint8 FCS = 0x00;\r\nguint8 tmp = 0;\r\nwhile (len--) {\r\ntmp = FCS^tvb_get_guint8(p,offset);\r\noffset++;\r\nFCS=crctable[tmp];\r\n}\r\nreturn FCS;\r\n}
