static int\r\ndissect_timestamp_reply(tvbuff_t *tvb, packet_info *pinfo, proto_tree *parent_tree, void *data _U_)\r\n{\r\nproto_item *item=NULL;\r\nproto_tree *tree=NULL;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "PKIXTSP");\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Reply");\r\nif(parent_tree){\r\nitem=proto_tree_add_item(parent_tree, proto_pkixtsp, tvb, 0, -1, ENC_NA);\r\ntree = proto_item_add_subtree(item, ett_pkixtsp);\r\n}\r\nreturn dissect_pkixtsp_TimeStampResp(FALSE, tvb, 0, &asn1_ctx, tree, -1);\r\n}\r\nstatic int\r\ndissect_timestamp_query(tvbuff_t *tvb, packet_info *pinfo, proto_tree *parent_tree, void *data _U_)\r\n{\r\nproto_item *item=NULL;\r\nproto_tree *tree=NULL;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "PKIXTSP");\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Query");\r\nif(parent_tree){\r\nitem=proto_tree_add_item(parent_tree, proto_pkixtsp, tvb, 0, -1, ENC_NA);\r\ntree = proto_item_add_subtree(item, ett_pkixtsp);\r\n}\r\nreturn dissect_pkixtsp_TimeStampReq(FALSE, tvb, 0, &asn1_ctx, tree, -1);\r\n}\r\nvoid proto_register_pkixtsp(void) {\r\nstatic hf_register_info hf[] = {\r\n#include "packet-pkixtsp-hfarr.c"\r\n};\r\nstatic gint *ett[] = {\r\n&ett_pkixtsp,\r\n#include "packet-pkixtsp-ettarr.c"\r\n};\r\nproto_pkixtsp = proto_register_protocol(PNAME, PSNAME, PFNAME);\r\nproto_register_field_array(proto_pkixtsp, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid proto_reg_handoff_pkixtsp(void) {\r\ndissector_handle_t timestamp_reply_handle;\r\ndissector_handle_t timestamp_query_handle;\r\ntimestamp_reply_handle = new_create_dissector_handle(dissect_timestamp_reply, proto_pkixtsp);\r\ndissector_add_string("media_type", "application/timestamp-reply", timestamp_reply_handle);\r\ntimestamp_query_handle = new_create_dissector_handle(dissect_timestamp_query, proto_pkixtsp);\r\ndissector_add_string("media_type", "application/timestamp-query", timestamp_query_handle);\r\n#include "packet-pkixtsp-dis-tab.c"\r\n}
