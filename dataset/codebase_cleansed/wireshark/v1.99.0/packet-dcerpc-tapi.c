static int\r\ndissect_tapi_client_attach_rqst(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep,\r\nhf_tapi_unknown_long, NULL);\r\noffset = dissect_ndr_str_pointer_item(tvb, offset, pinfo, tree, di, drep,\r\nNDR_POINTER_REF, "unknown string",\r\nhf_tapi_unknown_string, 0);\r\noffset = dissect_ndr_str_pointer_item(tvb, offset, pinfo, tree, di, drep,\r\nNDR_POINTER_REF, "unknown string",\r\nhf_tapi_unknown_string, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_tapi_client_attach_reply(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\noffset = dissect_ndr_ctx_hnd(tvb, offset, pinfo, tree, di, drep,\r\nhf_tapi_hnd, NULL);\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep,\r\nhf_tapi_unknown_long, NULL);\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep,\r\nhf_tapi_rc, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_tapi_TYPE_1(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif(di->conformant_run){\r\noffset =dissect_ndr_ucvarray(tvb, offset, pinfo, tree, di, drep, NULL);\r\nreturn offset;\r\n}\r\nproto_tree_add_item(tree, hf_tapi_unknown_bytes, tvb, offset,\r\ndi->array_actual_count, ENC_NA);\r\noffset += di->array_actual_count;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_tapi_client_request_rqst(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\noffset = dissect_ndr_ctx_hnd(tvb, offset, pinfo, tree, di, drep,\r\nhf_tapi_hnd, NULL);\r\noffset = dissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_tapi_TYPE_1, NDR_POINTER_REF,\r\n"unknown array", -1);\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep,\r\nhf_tapi_unknown_long, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_tapi_client_request_reply(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep,\r\nhf_tapi_rc, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_tapi_client_detach_rqst(tvbuff_t *tvb _U_, int offset _U_,\r\npacket_info *pinfo _U_, proto_tree *tree _U_,\r\ndcerpc_info *di _U_, guint8 *drep _U_)\r\n{\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_tapi_client_detach_reply(tvbuff_t *tvb _U_, int offset _U_,\r\npacket_info *pinfo _U_, proto_tree *tree _U_,\r\ndcerpc_info *di _U_, guint8 *drep _U_)\r\n{\r\nreturn offset;\r\n}\r\nvoid\r\nproto_register_dcerpc_tapi(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_tapi_opnum, {\r\n"Operation", "tapi.opnum", FT_UINT16, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL }},\r\n{ &hf_tapi_rc, {\r\n"Return code", "tapi.rc", FT_UINT32, BASE_HEX | BASE_EXT_STRING,\r\n&NT_errors_ext, 0x0, "TAPI return code", HFILL }},\r\n{ &hf_tapi_hnd, {\r\n"Context Handle", "tapi.hnd", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL }},\r\n{ &hf_tapi_unknown_long, {\r\n"Unknown long", "tapi.unknown.long", FT_UINT32, BASE_HEX,\r\nNULL, 0x0, "Unknown long. If you know what this is, contact wireshark developers.", HFILL }},\r\n{ &hf_tapi_unknown_string, {\r\n"Unknown string", "tapi.unknown.string", FT_STRING, BASE_NONE,\r\nNULL, 0x0, "Unknown string. If you know what this is, contact wireshark developers.", HFILL }},\r\n{ &hf_tapi_unknown_bytes, {\r\n"Unknown bytes", "tapi.unknown.bytes", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, "Unknown bytes. If you know what this is, contact wireshark developers.", HFILL }}\r\n};\r\nstatic gint *ett[] = {\r\n&ett_dcerpc_tapi\r\n};\r\nproto_dcerpc_tapi = proto_register_protocol(\r\n"Microsoft Telephony API Service", "TAPI", "tapi");\r\nproto_register_field_array(proto_dcerpc_tapi, hf,\r\narray_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid\r\nproto_reg_handoff_dcerpc_tapi(void)\r\n{\r\ndcerpc_init_uuid(proto_dcerpc_tapi, ett_dcerpc_tapi,\r\n&uuid_dcerpc_tapi, ver_dcerpc_tapi,\r\ndcerpc_tapi_dissectors, hf_tapi_opnum);\r\n}
