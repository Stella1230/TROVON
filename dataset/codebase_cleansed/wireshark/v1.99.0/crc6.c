guint16 update_crc6_by_bytes(guint16 crc6, guint8 byte1, guint8 byte2) {\r\nint bit;\r\nguint32 remainder = ( byte1<<8 | byte2 ) << 6;\r\nguint32 polynomial = 0x6F << 15;\r\nfor (bit = 15;\r\nbit >= 0;\r\n--bit)\r\n{\r\nif (remainder & (0x40 << bit))\r\n{\r\nremainder ^= polynomial;\r\n}\r\npolynomial >>= 1;\r\n}\r\nreturn (guint16)(remainder ^ crc6);\r\n}\r\nguint16 crc6_compute(const guint8 *data_blk_ptr, int data_blk_size)\r\n{\r\nguint16 h;\r\nint byteIndex;\r\nh = 0;\r\nbyteIndex = 0;\r\nif(data_blk_size == 0)\r\n{\r\nreturn 0;\r\n}\r\ndo\r\n{\r\nh = (h << 8) | data_blk_ptr[byteIndex];\r\nh = crc6_table[h];\r\nbyteIndex++;\r\n}\r\nwhile(byteIndex < data_blk_size);\r\nreturn h;\r\n}
