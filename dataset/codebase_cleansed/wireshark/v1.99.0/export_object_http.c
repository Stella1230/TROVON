gboolean\r\neo_http_packet(void *tapdata, packet_info *pinfo, epan_dissect_t *edt _U_,\r\nconst void *data)\r\n{\r\nexport_object_list_t *object_list = (export_object_list_t *)tapdata;\r\nconst http_eo_t *eo_info = (const http_eo_t *)data;\r\nexport_object_entry_t *entry;\r\nif(eo_info) {\r\nentry = (export_object_entry_t *)g_malloc(sizeof(export_object_entry_t));\r\nentry->pkt_num = pinfo->fd->num;\r\nentry->hostname = g_strdup(eo_info->hostname);\r\nentry->content_type = g_strdup(eo_info->content_type);\r\nentry->filename = g_strdup(g_path_get_basename(eo_info->filename));\r\nentry->payload_len = eo_info->payload_len;\r\nentry->payload_data = (guint8 *)g_memdup(eo_info->payload_data,\r\neo_info->payload_len);\r\nobject_list_add_entry(object_list, entry);\r\nreturn TRUE;\r\n} else {\r\nreturn FALSE;\r\n}\r\n}
