gchar *\r\nsna_fid_to_str(const address *addr)\r\n{\r\ngchar *cur;\r\ncur=(gchar *)ep_alloc(14);\r\nsna_fid_to_str_buf(addr, cur, 14);\r\nreturn cur;\r\n}\r\nvoid\r\nsna_fid_to_str_buf(const address *addr, gchar *buf, int buf_len)\r\n{\r\nconst guint8 *addrdata;\r\nstruct sna_fid_type_4_addr sna_fid_type_4_addr;\r\nswitch (addr->len) {\r\ncase 1:\r\naddrdata = (const guint8 *)addr->data;\r\ng_snprintf(buf, buf_len, "%04X", addrdata[0]);\r\nbreak;\r\ncase 2:\r\naddrdata = (const guint8 *)addr->data;\r\ng_snprintf(buf, buf_len, "%04X", pntoh16(&addrdata[0]));\r\nbreak;\r\ncase SNA_FID_TYPE_4_ADDR_LEN:\r\nmemcpy(&sna_fid_type_4_addr, addr->data, SNA_FID_TYPE_4_ADDR_LEN);\r\ng_snprintf(buf, buf_len, "%08X.%04X", sna_fid_type_4_addr.saf,\r\nsna_fid_type_4_addr.ef);\r\nbreak;\r\n}\r\n}
