gboolean\r\npersfilepath_opt(int opt _U_, const char *optstr)\r\n{\r\ngchar *p, *colonp;\r\ncolonp = strchr(optstr, ':');\r\nif (colonp == NULL) {\r\nreturn FALSE;\r\n}\r\np = colonp;\r\n*p++ = '\0';\r\nwhile (isspace((guchar)*p))\r\np++;\r\nif (*p == '\0') {\r\n*colonp = ':';\r\nreturn FALSE;\r\n}\r\nif(test_for_directory(p) != EISDIR) {\r\n*colonp = ':';\r\nreturn FALSE;\r\n}\r\nif (strcmp(optstr,"persconf") == 0) {\r\nset_persconffile_dir(p);\r\n} else if (strcmp(optstr,"persdata") == 0) {\r\nset_persdatafile_dir(p);\r\n} else {\r\nreturn FALSE;\r\n}\r\n*colonp = ':';\r\nreturn TRUE;\r\n}
