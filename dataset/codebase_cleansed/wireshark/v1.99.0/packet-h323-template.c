gef_ctx_t* gef_ctx_alloc(gef_ctx_t *parent, const gchar *type) {\r\ngef_ctx_t *gefx;\r\ngefx = wmem_new0(wmem_packet_scope(), gef_ctx_t);\r\ngefx->signature = GEF_CTX_SIGNATURE;\r\ngefx->parent = parent;\r\ngefx->type = type;\r\nreturn gefx;\r\n}\r\ngboolean gef_ctx_check_signature(gef_ctx_t *gefx) {\r\nreturn gefx && (gefx->signature == GEF_CTX_SIGNATURE);\r\n}\r\ngef_ctx_t* gef_ctx_get(void *ptr) {\r\ngef_ctx_t *gefx = (gef_ctx_t*)ptr;\r\nasn1_ctx_t *actx = (asn1_ctx_t*)ptr;\r\nif (!asn1_ctx_check_signature(actx))\r\nactx = NULL;\r\nif (actx)\r\ngefx = (gef_ctx_t *)actx->private_data;\r\nif (!gef_ctx_check_signature(gefx))\r\ngefx = NULL;\r\nreturn gefx;\r\n}\r\nvoid gef_ctx_update_key(gef_ctx_t *gefx) {\r\nconst gchar *parent_key;\r\nif (!gefx) return;\r\nparent_key = (gefx->parent) ? gefx->parent->key : NULL;\r\ngefx->key = wmem_strdup_printf(wmem_packet_scope(),\r\n"%s%s"\r\n"%s%s%s"\r\n"%s%s" ,\r\n(parent_key) ? parent_key : "", (parent_key) ? "/" : "",\r\n(gefx->type) ? gefx->type : "", (gefx->type && (gefx->id || gefx->subid)) ? "/" : "", (gefx->id) ? gefx->id : "",\r\n(gefx->subid) ? "-" : "", (gefx->subid) ? gefx->subid : ""\r\n);\r\n}\r\nvoid proto_register_h323(void) {\r\nstatic hf_register_info hf[] = {\r\n#include "packet-h323-hfarr.c"\r\n};\r\nstatic gint *ett[] = {\r\n#include "packet-h323-ettarr.c"\r\n};\r\nproto_h323 = proto_register_protocol(PNAME, PSNAME, PFNAME);\r\nproto_register_field_array(proto_h323, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid proto_reg_handoff_h323(void)\r\n{\r\ndissector_handle_t q931_handle;\r\nq931_handle = find_dissector("q931");\r\ndissector_add_string("h225.tp", "1.3.12.9", q931_handle);\r\ndissector_add_string("h225.gef.content", "GenericData/1000/1",\r\nnew_create_dissector_handle(dissect_RasTunnelledSignallingMessage_PDU, proto_h323));\r\ndissector_add_string("h225.gef.content", "GenericData/1/1",\r\nnew_create_dissector_handle(dissect_RobustnessData_PDU, proto_h323));\r\n}
