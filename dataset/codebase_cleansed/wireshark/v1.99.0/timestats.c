void\r\ntime_stat_init(timestat_t *stats)\r\n{\r\nstats->num = 0;\r\nstats->min_num = 0;\r\nstats->max_num = 0;\r\nnstime_set_zero(&stats->min);\r\nnstime_set_zero(&stats->max);\r\nnstime_set_zero(&stats->tot);\r\nstats->variance = 0.0;\r\n}\r\nvoid\r\ntime_stat_update(timestat_t *stats, const nstime_t *delta, packet_info *pinfo)\r\n{\r\nif(stats->num==0){\r\nstats->max=*delta;\r\nstats->max_num=pinfo->fd->num;\r\nstats->min=*delta;\r\nstats->min_num=pinfo->fd->num;\r\n}\r\nif( (delta->secs<stats->min.secs)\r\n||( (delta->secs==stats->min.secs)\r\n&&(delta->nsecs<stats->min.nsecs) ) ){\r\nstats->min=*delta;\r\nstats->min_num=pinfo->fd->num;\r\n}\r\nif( (delta->secs>stats->max.secs)\r\n||( (delta->secs==stats->max.secs)\r\n&&(delta->nsecs>stats->max.nsecs) ) ){\r\nstats->max=*delta;\r\nstats->max_num=pinfo->fd->num;\r\n}\r\nnstime_add(&stats->tot, delta);\r\nstats->num++;\r\n}\r\ngdouble get_average(const nstime_t *sum, guint32 num)\r\n{\r\ngdouble average;\r\nif(num > 0) {\r\naverage = (double)sum->secs*1000 + (double)sum->nsecs/1000000;\r\naverage /= num;\r\n}\r\nelse {\r\naverage = 0;\r\n}\r\nreturn average;\r\n}
