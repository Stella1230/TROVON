void dissect_cdt (tvbuff_t *tvb, packet_info *pinfo, proto_tree *parent_tree)\r\n{\r\nproto_tree *tree = NULL;\r\ntop_tree = parent_tree;\r\nif (parent_tree) {\r\ncdt_item = proto_tree_add_item (parent_tree, proto_cdt, tvb, 0, -1, ENC_NA);\r\ntree = proto_item_add_subtree (cdt_item, ett_cdt_CompressedData);\r\n} else {\r\ncdt_item = NULL;\r\n}\r\ncol_set_str (pinfo->cinfo, COL_PROTOCOL, "CDT");\r\ncol_clear (pinfo->cinfo, COL_INFO);\r\ndissect_CompressedData_PDU (tvb, pinfo, tree);\r\n}\r\nvoid proto_register_cdt (void) {\r\nstatic hf_register_info hf[] = {\r\n#include "packet-cdt-hfarr.c"\r\n};\r\nstatic gint *ett[] = {\r\n#include "packet-cdt-ettarr.c"\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_cdt_unable_compress_content, { "cdt.unable_compress_content", PI_UNDECODED, PI_ERROR, "Unable to get compressed content", EXPFILL }},\r\n{ &ei_cdt_unable_uncompress_content, { "cdt.unable_uncompress_content", PI_UNDECODED, PI_ERROR, "Unable to get uncompressed content", EXPFILL }},\r\n};\r\nexpert_module_t* expert_cdt;\r\nproto_cdt = proto_register_protocol (PNAME, PSNAME, PFNAME);\r\nproto_register_field_array (proto_cdt, hf, array_length(hf));\r\nproto_register_subtree_array (ett, array_length(ett));\r\nexpert_cdt = expert_register_protocol(proto_cdt);\r\nexpert_register_field_array(expert_cdt, ei, array_length(ei));\r\n}\r\nvoid proto_reg_handoff_cdt (void) {\r\n#include "packet-cdt-dis-tab.c"\r\ndata_handle = find_dissector ("data");\r\n}
