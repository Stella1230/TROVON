static gint h225ras_call_equal(gconstpointer k1, gconstpointer k2)\r\n{\r\nconst h225ras_call_info_key* key1 = (const h225ras_call_info_key*) k1;\r\nconst h225ras_call_info_key* key2 = (const h225ras_call_info_key*) k2;\r\nreturn (key1->reqSeqNum == key2->reqSeqNum &&\r\nkey1->conversation == key2->conversation);\r\n}\r\nstatic guint h225ras_call_hash(gconstpointer k)\r\n{\r\nconst h225ras_call_info_key* key = (const h225ras_call_info_key*) k;\r\nreturn key->reqSeqNum + GPOINTER_TO_UINT(key->conversation);\r\n}\r\nh225ras_call_t * find_h225ras_call(h225ras_call_info_key *h225ras_call_key ,int category)\r\n{\r\nh225ras_call_t *h225ras_call = NULL;\r\nh225ras_call = (h225ras_call_t *)g_hash_table_lookup(ras_calls[category], h225ras_call_key);\r\nreturn h225ras_call;\r\n}\r\nh225ras_call_t * new_h225ras_call(h225ras_call_info_key *h225ras_call_key, packet_info *pinfo, e_guid_t *guid, int category)\r\n{\r\nh225ras_call_info_key *new_h225ras_call_key;\r\nh225ras_call_t *h225ras_call = NULL;\r\nnew_h225ras_call_key = se_new(h225ras_call_info_key);\r\nnew_h225ras_call_key->reqSeqNum = h225ras_call_key->reqSeqNum;\r\nnew_h225ras_call_key->conversation = h225ras_call_key->conversation;\r\nh225ras_call = se_new(h225ras_call_t);\r\nh225ras_call->req_num = pinfo->fd->num;\r\nh225ras_call->rsp_num = 0;\r\nh225ras_call->requestSeqNum = h225ras_call_key->reqSeqNum;\r\nh225ras_call->responded = FALSE;\r\nh225ras_call->next_call = NULL;\r\nh225ras_call->req_time=pinfo->fd->abs_ts;\r\nh225ras_call->guid=*guid;\r\ng_hash_table_insert(ras_calls[category], new_h225ras_call_key, h225ras_call);\r\nreturn h225ras_call;\r\n}\r\nh225ras_call_t * append_h225ras_call(h225ras_call_t *prev_call, packet_info *pinfo, e_guid_t *guid, int category _U_)\r\n{\r\nh225ras_call_t *h225ras_call = NULL;\r\nh225ras_call = se_new(h225ras_call_t);\r\nh225ras_call->req_num = pinfo->fd->num;\r\nh225ras_call->rsp_num = 0;\r\nh225ras_call->requestSeqNum = prev_call->requestSeqNum;\r\nh225ras_call->responded = FALSE;\r\nh225ras_call->next_call = NULL;\r\nh225ras_call->req_time=pinfo->fd->abs_ts;\r\nh225ras_call->guid=*guid;\r\nprev_call->next_call = h225ras_call;\r\nreturn h225ras_call;\r\n}\r\nvoid\r\nh225_init_routine(void)\r\n{\r\nint i;\r\nfor(i=0;i<7;i++) {\r\nif (ras_calls[i] != NULL) {\r\ng_hash_table_destroy(ras_calls[i]);\r\nras_calls[i] = NULL;\r\n}\r\n}\r\nfor(i=0;i<7;i++) {\r\nras_calls[i] = g_hash_table_new(h225ras_call_hash, h225ras_call_equal);\r\n}\r\n}
