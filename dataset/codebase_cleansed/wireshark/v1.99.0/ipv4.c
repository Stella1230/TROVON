ipv4_addr*\r\nipv4_addr_new(void)\r\n{\r\nipv4_addr *ipv4;\r\nipv4 = g_new(ipv4_addr, 1);\r\nreturn ipv4;\r\n}\r\nvoid\r\nipv4_addr_free(ipv4_addr *ipv4)\r\n{\r\ng_free(ipv4);\r\n}\r\nvoid\r\nipv4_addr_set_host_order_addr(ipv4_addr *ipv4, const guint32 new_addr)\r\n{\r\nipv4->addr = new_addr;\r\n}\r\nvoid\r\nipv4_addr_set_net_order_addr(ipv4_addr *ipv4, const guint32 new_addr)\r\n{\r\nipv4->addr = g_ntohl(new_addr);\r\n}\r\nvoid\r\nipv4_addr_set_netmask_bits(ipv4_addr *ipv4, const guint new_nmask_bits)\r\n{\r\nipv4->nmask = ip_get_subnet_mask(new_nmask_bits);\r\n}\r\nguint32\r\nipv4_get_net_order_addr(ipv4_addr *ipv4)\r\n{\r\nreturn g_htonl(ipv4->addr);\r\n}\r\nguint32\r\nipv4_get_host_order_addr(ipv4_addr *ipv4)\r\n{\r\nreturn ipv4->addr;\r\n}\r\nvoid\r\nipv4_addr_str_buf(const ipv4_addr *ipv4, gchar *buf)\r\n{\r\nguint32 ipv4_host_order = g_htonl(ipv4->addr);\r\nip_to_str_buf((guint8*)&ipv4_host_order, buf, MAX_IP_STR_LEN);\r\n}\r\ngboolean\r\nipv4_addr_eq(const ipv4_addr *a, const ipv4_addr *b)\r\n{\r\nguint32 val_a, val_b, nmask;\r\nnmask = MIN(a->nmask, b->nmask);\r\nval_a = a->addr & nmask;\r\nval_b = b->addr & nmask;\r\nreturn (val_a == val_b);\r\n}\r\ngboolean\r\nipv4_addr_gt(const ipv4_addr *a, const ipv4_addr *b)\r\n{\r\nguint32 val_a, val_b, nmask;\r\nnmask = MIN(a->nmask, b->nmask);\r\nval_a = a->addr & nmask;\r\nval_b = b->addr & nmask;\r\nreturn (val_a > val_b);\r\n}\r\ngboolean\r\nipv4_addr_ge(const ipv4_addr *a, const ipv4_addr *b)\r\n{\r\nguint32 val_a, val_b, nmask;\r\nnmask = MIN(a->nmask, b->nmask);\r\nval_a = a->addr & nmask;\r\nval_b = b->addr & nmask;\r\nreturn (val_a >= val_b);\r\n}\r\ngboolean\r\nipv4_addr_lt(const ipv4_addr *a, const ipv4_addr *b)\r\n{\r\nguint32 val_a, val_b, nmask;\r\nnmask = MIN(a->nmask, b->nmask);\r\nval_a = a->addr & nmask;\r\nval_b = b->addr & nmask;\r\nreturn (val_a < val_b);\r\n}\r\ngboolean\r\nipv4_addr_le(const ipv4_addr *a, const ipv4_addr *b)\r\n{\r\nguint32 val_a, val_b, nmask;\r\nnmask = MIN(a->nmask, b->nmask);\r\nval_a = a->addr & nmask;\r\nval_b = b->addr & nmask;\r\nreturn (val_a <= val_b);\r\n}
