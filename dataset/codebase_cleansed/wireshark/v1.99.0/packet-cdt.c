static int\r\ndissect_cdt_AlgorithmID_ShortForm(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 19 "../../asn1/cdt/cdt.cnf"\r\nguint32 value;\r\noffset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,\r\n&value);\r\nproto_item_append_text (cdt_item, ", %s",\r\nval_to_str (value, cdt_AlgorithmID_ShortForm_vals,\r\n"unknown"));\r\ncol_append_fstr (actx->pinfo->cinfo, COL_INFO, "%s ",\r\nval_to_str (value, cdt_AlgorithmID_ShortForm_vals,\r\n"unknown"));\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cdt_OBJECT_IDENTIFIER(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_object_identifier(implicit_tag, actx, tree, tvb, offset, hf_index, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cdt_CompressionAlgorithmIdentifier(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_choice(actx, tree, tvb, offset,\r\nCompressionAlgorithmIdentifier_choice, hf_index, ett_cdt_CompressionAlgorithmIdentifier,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cdt_ContentType_ShortForm(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 34 "../../asn1/cdt/cdt.cnf"\r\noffset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,\r\n&content_type);\r\nproto_item_append_text (cdt_item, ", %s",\r\nval_to_str (content_type, cdt_ContentType_ShortForm_vals,\r\n"unknown"));\r\ncol_append_fstr (actx->pinfo->cinfo, COL_INFO, "%s ",\r\nval_to_str (content_type, cdt_ContentType_ShortForm_vals,\r\n"unknown"));\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cdt_T_contentType_OID(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 48 "../../asn1/cdt/cdt.cnf"\r\nconst char *obj_id = NULL;\r\noffset = dissect_ber_object_identifier_str(implicit_tag, actx, tree, tvb, offset, hf_index, &obj_id);\r\nif (obj_id) {\r\nconst char *name = oid_resolved_from_string (obj_id);\r\nif (!name) {\r\nname = obj_id;\r\n}\r\nproto_item_append_text (cdt_item, ", %s", name);\r\ncol_append_fstr (actx->pinfo->cinfo, COL_INFO, "%s ", name);\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cdt_T_contentType(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_choice(actx, tree, tvb, offset,\r\nT_contentType_choice, hf_index, ett_cdt_T_contentType,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cdt_CompressedContent(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 67 "../../asn1/cdt/cdt.cnf"\r\ntvbuff_t *next_tvb = NULL, *compr_tvb = NULL;\r\nint save_offset = offset;\r\noffset = dissect_ber_octet_string(implicit_tag, actx, tree, tvb, offset, hf_index,\r\n&compr_tvb);\r\nif (compr_tvb == NULL) {\r\nproto_tree_add_expert(top_tree, actx->pinfo, &ei_cdt_unable_compress_content,\r\ntvb, save_offset, -1);\r\ncol_append_str (actx->pinfo->cinfo, COL_INFO,\r\n"[Error: Unable to get compressed content]");\r\nreturn offset;\r\n}\r\nnext_tvb = tvb_child_uncompress (tvb, compr_tvb, 0, tvb_length (compr_tvb));\r\nif (next_tvb == NULL) {\r\nproto_tree_add_expert(top_tree, actx->pinfo, &ei_cdt_unable_uncompress_content,\r\ntvb, save_offset, -1);\r\ncol_append_str (actx->pinfo->cinfo, COL_INFO,\r\n"[Error: Unable to uncompress content]");\r\nreturn offset;\r\n}\r\nadd_new_data_source (actx->pinfo, next_tvb, "Uncompressed Content");\r\nswitch (content_type) {\r\ncase CDT_UNDEFINED:\r\ncall_dissector (data_handle, next_tvb, actx->pinfo, top_tree);\r\nbreak;\r\ncase CDT_EXTERNAL:\r\ndissect_unknown_ber (actx->pinfo, next_tvb, 0, top_tree);\r\nbreak;\r\ncase CDT_P1:\r\ndissect_p1_mts_apdu (next_tvb, actx->pinfo, top_tree);\r\nbreak;\r\ndefault:\r\ncall_dissector (data_handle, next_tvb, actx->pinfo, top_tree);\r\nbreak;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cdt_CompressedContentInfo(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nCompressedContentInfo_sequence, hf_index, ett_cdt_CompressedContentInfo);\r\nreturn offset;\r\n}\r\nint\r\ndissect_cdt_CompressedData(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\n#line 11 "../../asn1/cdt/cdt.cnf"\r\ncontent_type = 0;\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nCompressedData_sequence, hf_index, ett_cdt_CompressedData);\r\nreturn offset;\r\n}\r\nstatic void dissect_CompressedData_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_) {\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\ndissect_cdt_CompressedData(FALSE, tvb, 0, &asn1_ctx, tree, hf_cdt_CompressedData_PDU);\r\n}\r\nvoid dissect_cdt (tvbuff_t *tvb, packet_info *pinfo, proto_tree *parent_tree)\r\n{\r\nproto_tree *tree = NULL;\r\ntop_tree = parent_tree;\r\nif (parent_tree) {\r\ncdt_item = proto_tree_add_item (parent_tree, proto_cdt, tvb, 0, -1, ENC_NA);\r\ntree = proto_item_add_subtree (cdt_item, ett_cdt_CompressedData);\r\n} else {\r\ncdt_item = NULL;\r\n}\r\ncol_set_str (pinfo->cinfo, COL_PROTOCOL, "CDT");\r\ncol_clear (pinfo->cinfo, COL_INFO);\r\ndissect_CompressedData_PDU (tvb, pinfo, tree);\r\n}\r\nvoid proto_register_cdt (void) {\r\nstatic hf_register_info hf[] = {\r\n#line 1 "../../asn1/cdt/packet-cdt-hfarr.c"\r\n{ &hf_cdt_CompressedData_PDU,\r\n{ "CompressedData", "cdt.CompressedData_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cdt_compressionAlgorithm,\r\n{ "compressionAlgorithm", "cdt.compressionAlgorithm",\r\nFT_UINT32, BASE_DEC, VALS(cdt_CompressionAlgorithmIdentifier_vals), 0,\r\n"CompressionAlgorithmIdentifier", HFILL }},\r\n{ &hf_cdt_compressedContentInfo,\r\n{ "compressedContentInfo", "cdt.compressedContentInfo_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cdt_algorithmID_ShortForm,\r\n{ "algorithmID-ShortForm", "cdt.algorithmID_ShortForm",\r\nFT_INT32, BASE_DEC, VALS(cdt_AlgorithmID_ShortForm_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_cdt_algorithmID_OID,\r\n{ "algorithmID-OID", "cdt.algorithmID_OID",\r\nFT_OID, BASE_NONE, NULL, 0,\r\n"OBJECT_IDENTIFIER", HFILL }},\r\n{ &hf_cdt_contentType,\r\n{ "contentType", "cdt.contentType",\r\nFT_UINT32, BASE_DEC, VALS(cdt_T_contentType_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_cdt_contentType_ShortForm,\r\n{ "contentType-ShortForm", "cdt.contentType_ShortForm",\r\nFT_INT32, BASE_DEC, VALS(cdt_ContentType_ShortForm_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_cdt_contentType_OID,\r\n{ "contentType-OID", "cdt.contentType_OID",\r\nFT_OID, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_cdt_compressedContent,\r\n{ "compressedContent", "cdt.compressedContent",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n#line 103 "../../asn1/cdt/packet-cdt-template.c"\r\n};\r\nstatic gint *ett[] = {\r\n#line 1 "../../asn1/cdt/packet-cdt-ettarr.c"\r\n&ett_cdt_CompressedData,\r\n&ett_cdt_CompressionAlgorithmIdentifier,\r\n&ett_cdt_CompressedContentInfo,\r\n&ett_cdt_T_contentType,\r\n#line 108 "../../asn1/cdt/packet-cdt-template.c"\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_cdt_unable_compress_content, { "cdt.unable_compress_content", PI_UNDECODED, PI_ERROR, "Unable to get compressed content", EXPFILL }},\r\n{ &ei_cdt_unable_uncompress_content, { "cdt.unable_uncompress_content", PI_UNDECODED, PI_ERROR, "Unable to get uncompressed content", EXPFILL }},\r\n};\r\nexpert_module_t* expert_cdt;\r\nproto_cdt = proto_register_protocol (PNAME, PSNAME, PFNAME);\r\nproto_register_field_array (proto_cdt, hf, array_length(hf));\r\nproto_register_subtree_array (ett, array_length(ett));\r\nexpert_cdt = expert_register_protocol(proto_cdt);\r\nexpert_register_field_array(expert_cdt, ei, array_length(ei));\r\n}\r\nvoid proto_reg_handoff_cdt (void) {\r\n#line 1 "../../asn1/cdt/packet-cdt-dis-tab.c"\r\nregister_ber_oid_dissector("1.3.26.0.4406.0.4.2", dissect_CompressedData_PDU, proto_cdt, "cdt");\r\n#line 131 "../../asn1/cdt/packet-cdt-template.c"\r\ndata_handle = find_dissector ("data");\r\n}
