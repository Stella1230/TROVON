static void dissect_h248_annexc_acodec(proto_tree* tree,
tvbuff_t* tvb,
packet_info* pinfo,
int hfid,
h248_curr_info_t* h248_info _U_,
void* implicit_p ) {
int len;
tvbuff_t* new_tvb;
asn1_ctx_t asn1_ctx;
asn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);
dissect_ber_octet_string(implicit_p ? *((gboolean*)implicit_p) : FALSE, &asn1_ctx, tree, tvb, 0, hfid, &new_tvb);
tree = proto_item_add_subtree(asn1_ctx.created_item,ett_codec);
len = tvb_reported_length(new_tvb);
dissect_codec_mode(tree,new_tvb,0,len);
}
static void dissect_h248_annexc_BIR(proto_tree* tree,
tvbuff_t* tvb,
packet_info* pinfo,
int hfid,
h248_curr_info_t* h248_info,
void* implicit_p ) {
tvbuff_t* new_tvb = NULL;
asn1_ctx_t asn1_ctx;
asn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);
dissect_ber_octet_string(implicit_p ? *((gboolean*)implicit_p) : FALSE, &asn1_ctx, tree, tvb, 0, hfid, &new_tvb);
if ( new_tvb && h248_info->term && ! h248_info->term->bir ) {
h248_info->term->bir = tvb_bytes_to_str(wmem_file_scope(), new_tvb,0,tvb_reported_length(new_tvb));
}
}
static void dissect_h248_annexc_NSAP(proto_tree* tree,
tvbuff_t* tvb,
packet_info* pinfo,
int hfid,
h248_curr_info_t* h248_info,
void* implicit_p ) {
tvbuff_t* new_tvb = NULL;
asn1_ctx_t asn1_ctx;
asn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);
dissect_ber_octet_string(implicit_p ? *((gboolean*)implicit_p) : FALSE, &asn1_ctx, tree, tvb, 0, hfid, &new_tvb);
if (new_tvb) {
dissect_nsap(new_tvb, 0,tvb_reported_length(new_tvb), tree);
if ( h248_info->term && ! h248_info->term->nsap) {
h248_info->term->nsap = tvb_bytes_to_str(wmem_file_scope(), new_tvb,0,tvb_reported_length(new_tvb));
}
}
}
static void dissect_h248_annexc_vpvc(proto_tree* tree, tvbuff_t* tvb, packet_info* pinfo _U_, int hfid, h248_curr_info_t* h248_info _U_, void* unused _U_) {
proto_item* pi = proto_tree_add_item(tree,hfid,tvb,0,2,ENC_BIG_ENDIAN);
proto_tree* pt = proto_item_add_subtree(pi,ett_vpvc);
proto_tree_add_item(pt,hf_h248_pkg_annexc_vp,tvb,0,2,ENC_BIG_ENDIAN);
proto_tree_add_item(pt,hf_h248_pkg_annexc_vc,tvb,2,2,ENC_BIG_ENDIAN);
}
static void dissect_h248_annexc_USI(proto_tree* tree, tvbuff_t* tvb, packet_info* pinfo, int hfid, h248_curr_info_t* h248_info _U_, void* implicit_p) {
tvbuff_t* new_tvb = NULL;
asn1_ctx_t asn1_ctx;
asn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);
dissect_ber_octet_string(implicit_p ? *((gboolean*)implicit_p) : FALSE, &asn1_ctx, tree, tvb, 0, hfid, &new_tvb);
if (new_tvb)
dissect_q931_bearer_capability_ie(new_tvb, 0, tvb_reported_length(new_tvb), tree);
}
static void dissect_h248_annexc_SDP(proto_tree* tree, tvbuff_t* tvb, packet_info* pinfo, int hfid, h248_curr_info_t* h248_info _U_, void* implicit_p _U_) {
asn1_ctx_t asn1_ctx;
asn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);
dissect_ber_restricted_string(FALSE, BER_UNI_TAG_IA5String,
&asn1_ctx, tree, tvb, 0, hfid,
NULL);
}
static void dissect_h248_annexc_SDP_C(proto_tree* tree, tvbuff_t* tvb, packet_info* pinfo, int hfid, h248_curr_info_t* h248_info _U_, void* implicit_p _U_) {
asn1_ctx_t asn1_ctx;
tvbuff_t *param_tvb = NULL;
proto_item *ti;
asn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);
dissect_ber_restricted_string(FALSE, BER_UNI_TAG_IA5String,
&asn1_ctx, tree, tvb, 0, hfid,
&param_tvb);
if (param_tvb){
ti = proto_tree_add_item(tree, hf_h248_sdp_connection_info, param_tvb, 0, -1, ENC_BIG_ENDIAN);
PROTO_ITEM_SET_GENERATED(ti);
}
}
static void dissect_h248_annexc_SDP_M(proto_tree* tree, tvbuff_t* tvb, packet_info* pinfo, int hfid, h248_curr_info_t* h248_info _U_, void* implicit_p _U_) {
asn1_ctx_t asn1_ctx;
tvbuff_t *param_tvb = NULL;
proto_item *ti;
int offset, next_offset, tokenlen;
gchar *port_str;
asn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);
dissect_ber_restricted_string(FALSE, BER_UNI_TAG_IA5String,
&asn1_ctx, tree, tvb, 0, hfid,
&param_tvb);
if (param_tvb){
offset = tvb_find_guint8(param_tvb, 0, -1, ' ');
if (offset != -1){
offset++;
next_offset = tvb_find_guint8(param_tvb, offset, -1, ' ');
if (next_offset > 0){
tokenlen = next_offset - offset;
port_str = tvb_get_string_enc(wmem_packet_scope(), param_tvb, offset, tokenlen, ENC_UTF_8 | ENC_NA);
if (g_ascii_isdigit(port_str[0])) {
ti = proto_tree_add_uint(tree, hf_h248_sdp_media_port, param_tvb, offset, tokenlen, atoi(port_str));
PROTO_ITEM_SET_GENERATED(ti);
}
}
}
}
}
void proto_register_h248_annex_c(void) {
static hf_register_info hf[] = {
{ &hf_h248_pkg_annexc_media,
{ "Media", "h248.annexc.media",
FT_UINT32, BASE_HEX, VALS(h248_annexc_media_vals), 0,
"Media Type", HFILL }},
{ &hf_h248_pkg_annexc_ACodec,
{ "ACodec", "h248.annexc.ACodec",
FT_BYTES, BASE_NONE, NULL, 0,
NULL, HFILL }},
{ &hf_h248_pkg_annexc_Mediatx,
{ "Mediatx", "h248.annexc.Mediatx",
FT_UINT32, BASE_DEC, VALS(h248_pkg_annexc_Mediatx_vals), 0,
NULL, HFILL }},
{ &hf_h248_pkg_annexc_BIR,
{ "BIR", "h248.annexc.BIR",
FT_BYTES, BASE_NONE, NULL, 0,
NULL, HFILL }},
{ &hf_h248_pkg_annexc_NSAP,
{ "NSAP", "h248.annexc.NSAP",
FT_BYTES, BASE_NONE, NULL, 0,
NULL, HFILL }},
{ &hf_h248_pkg_annexc_transmission_mode,
{ "Transmission Mode", "h248.annexc.transmission_mode",
FT_UINT32, BASE_DEC, VALS(h248_annexc_transmission_mode), 0,
NULL, HFILL }},
{ &hf_h248_pkg_annexc_num_of_channels,
{ "Number of Channels", "h248.annexc.num_of_channels",
FT_UINT32, BASE_DEC, NULL, 0,
NULL, HFILL }},
{ &hf_h248_pkg_annexc_sampling_rate,
{ "Sampling Rate", "h248.annexc.sampling_rate",
FT_UINT32, BASE_DEC, NULL, 0,
NULL, HFILL }},
{ &hf_h248_pkg_annexc_bit_rate,
{ "Bit Rate", "h248.annexc.bit_rate",
FT_UINT32, BASE_DEC, NULL, 0,
NULL, HFILL }},
{ &hf_h248_pkg_annexc_samplepp,
{ "Samplepp", "h248.annexc.samplepp",
FT_UINT32, BASE_DEC, NULL, 0,
NULL, HFILL }},
{ &hf_h248_pkg_annexc_silence_supp,
{ "SilenceSupp", "h248.annexc.silence_supp",
FT_BOOLEAN, BASE_NONE, NULL, 0x0,
"Silence Suppression", HFILL }},
{ &hf_h248_pkg_annexc_encrypt_type,
{ "Encrypttype", "h248.annexc.encrypt_type",
FT_BYTES, BASE_NONE, NULL, 0,
"Encryption Type", HFILL }},
{ &hf_h248_pkg_annexc_encrypt_key,
{ "Encrypt Key", "h248.annexc.encrypt_key",
FT_UINT32, BASE_DEC, NULL, 0,
"Encryption Key", HFILL }},
{ &hf_h248_pkg_annexc_gain,
{ "Gain", "h248.annexc.gain",
FT_UINT32, BASE_DEC, NULL, 0,
"Gain (dB)", HFILL }},
{ &hf_h248_pkg_annexc_jitterbuf,
{ "JitterBuff", "h248.annexc.jitterbuf",
FT_UINT32, BASE_DEC, NULL, 0,
"Jitter Buffer Size (ms)", HFILL }},
{ &hf_h248_pkg_annexc_propdelay,
{ "Propagation Delay", "h248.annexc.propdelay",
FT_UINT32, BASE_DEC, NULL, 0,
"Propagation Delay (ms)", HFILL }},
{ &hf_h248_pkg_annexc_rtp_payload,
{ "RTP Payload type", "h248.annexc.rtp_payload",
FT_UINT32, BASE_DEC, NULL, 0,
"Payload type in RTP Profile", HFILL }},
{ &hf_h248_pkg_annexc_h222,
{ "H222LogicalChannelParameters", "h248.annexc.h222",
FT_BYTES, BASE_NONE, NULL, 0,
NULL, HFILL }},
{ &hf_h248_pkg_annexc_h223,
{ "H223LogicalChannelParameters", "h248.annexc.h223",
FT_BYTES, BASE_NONE, NULL, 0,
NULL, HFILL }},
{ &hf_h248_pkg_annexc_v76,
{ "V76LogicalChannelParameters", "h248.annexc.v76",
FT_BYTES, BASE_NONE, NULL, 0,
NULL, HFILL }},
{ &hf_h248_pkg_annexc_h2250,
{ "H2250LogicalChannelParameters", "h248.annexc.h2250",
FT_BYTES, BASE_NONE, NULL, 0,
NULL, HFILL }},
{ &hf_h248_pkg_annexc_aesa,
{ "AESA", "h248.annexc.aesa",
FT_BYTES, BASE_NONE, NULL, 0,
"ATM End System Address", HFILL }},
{ &hf_h248_pkg_annexc_vp,
{ "VPI", "h248.annexc.vpi",
FT_UINT16, BASE_DEC, NULL, 0,
"Virtual Path Identifier", HFILL }},
{ &hf_h248_pkg_annexc_vc,
{ "VCI", "h248.annexc.vci",
FT_UINT16, BASE_DEC, NULL, 0,
"Virtual Circuit Identifier", HFILL }},
{ &hf_h248_pkg_annexc_sc,
{ "Service Class", "h248.annexc.sc",
FT_UINT32, BASE_DEC, NULL, 0,
NULL, HFILL }},
{ &hf_h248_pkg_annexc_bcob,
{ "BCOB", "h248.annexc.bcob",
FT_UINT8, BASE_DEC, NULL, 0x1F,
"Broadband Bearer Class", HFILL }},
{ &hf_h248_pkg_annexc_bbtc,
{ "BBTC", "h248.annexc.bbtc",
FT_UINT8, BASE_DEC, NULL, 0x3F,
"Broadband Transfer Capability", HFILL }},
{ &hf_h248_pkg_annexc_atc,
{ "ATC", "h248.annexc.atc",
FT_UINT32, BASE_DEC, VALS(h248_pkg_annexc_atc_values), 0x0,
"ATM Traffic Capability", HFILL }},
{ &hf_h248_pkg_annexc_stc,
{ "STC", "h248.annexc.stc",
FT_UINT8, BASE_DEC, VALS(h248_pkg_annexc_stc_values), 0x03,
"Susceptibility to Clipping", HFILL }},
{ &hf_h248_pkg_annexc_uppc,
{ "UPPC", "h248.annexc.uppc",
FT_UINT8, BASE_DEC, VALS(h248_pkg_annexc_uppc_values), 0x03,
"User Plane Connection Configuration", HFILL }},
{ &hf_h248_pkg_annexc_pcr0,
{ "PCR0", "h248.annexc.pcr0",
FT_UINT24, BASE_DEC, NULL, 0,
"Peak Cell Rate for CLP=0", HFILL }},
{ &hf_h248_pkg_annexc_scr0,
{ "SCR0", "h248.annexc.scr0",
FT_UINT24, BASE_DEC, NULL, 0,
"Sustained Cell Rate for CLP=0", HFILL }},
{ &hf_h248_pkg_annexc_mbs0,
{ "MBS0", "h248.annexc.mbs0",
FT_UINT24, BASE_DEC, NULL, 0,
"Maximum Burst Size for CLP=0", HFILL }},
{ &hf_h248_pkg_annexc_pcr1,
{ "PCR1", "h248.annexc.pcr1",
FT_UINT24, BASE_DEC, NULL, 0,
"Peak Cell Rate for CLP=1", HFILL }},
{ &hf_h248_pkg_annexc_scr1,
{ "SCR1", "h248.annexc.scr1",
FT_UINT24, BASE_DEC, NULL, 0,
"Sustained Cell Rate for CLP=1", HFILL }},
{ &hf_h248_pkg_annexc_mbs1,
{ "MBS1", "h248.annexc.mbs1",
FT_UINT24, BASE_DEC, NULL, 0,
"Maximum Burst Size for CLP=1", HFILL }},
{ &hf_h248_pkg_annexc_bei,
{ "BEI", "h248.annexc.bei",
FT_BOOLEAN, BASE_NONE, NULL, 0x0,
"Best Effort Indicator", HFILL }},
{ &hf_h248_pkg_annexc_ti,
{ "TI", "h248.annexc.ti",
FT_BOOLEAN, BASE_NONE, NULL, 0x0,
"Tagging Indicator", HFILL }},
{ &hf_h248_pkg_annexc_fd,
{ "FD", "h248.annexc.fd",
FT_BOOLEAN, BASE_NONE, NULL, 0x0,
"Frame Discard", HFILL }},
{ &hf_h248_pkg_annexc_a2pcdv,
{ "A2PCDV", "h248.annexc.a2pcdv",
FT_UINT24, BASE_DEC, NULL, 0,
"Acceptable 2 point CDV", HFILL }},
{ &hf_h248_pkg_annexc_c2pcdv,
{ "C2PCDV", "h248.annexc.c2pcdv",
FT_UINT24, BASE_DEC, NULL, 0,
"Cumulative 2 point CDV", HFILL }},
{ &hf_h248_pkg_annexc_appcdv,
{ "APPCDV", "h248.annexc.appcdv",
FT_UINT24, BASE_DEC, NULL, 0,
"Acceptable Point to Point CDV", HFILL }},
{ &hf_h248_pkg_annexc_cppcdv,
{ "CPPCDV", "h248.annexc.cppcdv",
FT_UINT24, BASE_DEC, NULL, 0,
"Cumulative Point to Point CDV", HFILL }},
{ &hf_h248_pkg_annexc_aclr,
{ "ACLR", "h248.annexc.aclr",
FT_UINT8, BASE_DEC, NULL, 0,
"Acceptable Cell Loss Ratio (Q.2965.2 ATMF UNI 4.0)", HFILL }},
{ &hf_h248_pkg_annexc_meetd,
{ "MEETD", "h248.annexc.meetd",
FT_UINT16, BASE_DEC, NULL, 0,
"Maximum End-to-End Transit Delay (Q.2965.2 ATMF UNI 4.0)", HFILL }},
{ &hf_h248_pkg_annexc_ceetd,
{ "CEETD", "h248.annexc.ceetd",
FT_UINT16, BASE_DEC, NULL, 0,
"Cumulative End-to-End Transit Delay (Q.2965.2 ATMF UNI 4.0)", HFILL }},
{ &hf_h248_pkg_annexc_QosClass,
{ "QosClass", "h248.annexc.qosclass",
FT_UINT16, BASE_DEC, VALS(h248_pkg_annexc_QosClass_values), 0,
"QoS Class (Q.2965.1)", HFILL }},
{ &hf_h248_pkg_annexc_AALtype,
{ "AALtype", "h248.annexc.aaltype",
FT_UINT8, BASE_DEC, VALS(h248_pkg_annexc_AALtype_values), 0,
"AAL Type", HFILL }},
{ &hf_h248_pkg_annexc_dlci,
{ "DLCI", "h248.annexc.dlci",
FT_UINT32, BASE_DEC, NULL, 0,
"Data Link Connection ID (FR)", HFILL }},
{ &hf_h248_pkg_annexc_cid,
{ "CID", "h248.annexc.cid",
FT_UINT32, BASE_DEC, NULL, 0,
"Channel-Id", HFILL }},
{ &hf_h248_pkg_annexc_sid,
{ "SID", "h248.annexc.sid",
FT_UINT32, BASE_DEC, NULL, 0,
"Silence Insertion Descriptor", HFILL }},
{ &hf_h248_pkg_annexc_ppt,
{ "PPT", "h248.annexc.ppt",
FT_UINT32, BASE_DEC, NULL, 0,
"Primary Payload Type", HFILL }},
{ &hf_h248_pkg_annexc_ipv4,
{ "IPv4", "h248.annexc.ipv4",
FT_IPv4, BASE_NONE, NULL, 0,
"IPv4 Address", HFILL }},
{ &hf_h248_pkg_annexc_ipv6,
{ "IPv6", "h248.annexc.ipv6",
FT_IPv6, BASE_NONE, NULL, 0,
"IPv6 Address", HFILL }},
{ &hf_h248_pkg_annexc_port,
{ "Port", "h248.annexc.port",
FT_UINT16, BASE_DEC, NULL, 0,
NULL, HFILL }},
{ &hf_h248_pkg_annexc_porttype,
{ "PortType", "h248.annexc.porttype",
FT_UINT32, BASE_DEC, VALS(h248_pkg_annexc_porttype_values), 0,
"Port Type", HFILL }},
{ &hf_h248_pkg_annexc_alc,
{ "ALC", "h248.annexc.alc",
FT_BYTES, BASE_NONE, NULL, 0,
"AAL2 Link Characteristics", HFILL }},
{ &hf_h248_pkg_annexc_sut,
{ "SUT", "h248.annexc.sut",
FT_BYTES, BASE_NONE, NULL, 0,
"Served User Transport", HFILL }},
{ &hf_h248_pkg_annexc_tci,
{ "TCI", "h248.annexc.tci",
FT_BOOLEAN, BASE_NONE, NULL, 0x0,
"Test Connection Indicator", HFILL }},
{ &hf_h248_pkg_annexc_timer_cu,
{ "Timer CU", "h248.annexc.timer_cu",
FT_UINT32, BASE_DEC, NULL, 0,
"Milliseconds to hold the partially filled cell before sending", HFILL }},
{ &hf_h248_pkg_annexc_maxcpssdu,
{ "Max CPS SDU", "h248.annexc.maxcpssdu",
FT_UINT8, BASE_DEC, NULL, 0,
"Maximum Common Part Sublayer Service Data Unit size", HFILL }},
{ &hf_h248_pkg_annexc_aal1st,
{ "AAL1ST", "h248.annexc.aal1st",
FT_UINT8, BASE_DEC, VALS(h248_pkg_annexc_aal1st_values), 0,
"AAL1 subtype", HFILL }},
{ &hf_h248_pkg_annexc_cbrr,
{ "CBRR", "h248.annexc.cbrr",
FT_UINT8, BASE_DEC, VALS(h248_pkg_annexc_cbrr_values), 0,
"CBR rate", HFILL }},
{ &hf_h248_pkg_annexc_scri,
{ "SCRI", "h248.annexc.scri",
FT_UINT8, BASE_DEC, VALS(h248_pkg_annexc_scri_values), 0,
"Source Clock frequency Recovery Method", HFILL }},
{ &hf_h248_pkg_annexc_ecm,
{ "ECM", "h248.annexc.ecm",
FT_UINT8, BASE_DEC, VALS(h248_pkg_annexc_ecm_values), 0,
"Error Correction Method", HFILL }},
{ &hf_h248_pkg_annexc_sdbt,
{ "SDBT", "h248.annexc.sdbt",
FT_UINT16, BASE_DEC, NULL, 0,
"Structured Data Transfer Blocksize", HFILL }},
{ &hf_h248_pkg_annexc_pfci,
{ "PFCI", "h248.annexc.pfci",
FT_UINT8, BASE_DEC, NULL, 0,
"Partially Filled Cells Identifier", HFILL }},
{ &hf_h248_pkg_annexc_tmr,
{ "TMR", "h248.annexc.tmr",
FT_UINT8, BASE_HEX|BASE_EXT_STRING, &isup_transmission_medium_requirement_value_ext, 0,
"Transmission Medium Requirement", HFILL }},
{ &hf_h248_pkg_annexc_tmrsr,
{ "TMSR", "h248.annexc.tmsr",
FT_UINT8, BASE_HEX, VALS(h248_pkg_annexc_tmrsr_values), 0,
"Transmission Medium Requirement Subrate", HFILL }},
{ &hf_h248_pkg_annexc_contcheck,
{ "Continuity Check", "h248.annexc.tmsr",
FT_UINT8, BASE_DEC, VALS(h248_pkg_annexc_contcheck_values), 0x0C,
NULL, HFILL }},
{ &hf_h248_pkg_annexc_itc,
{ "ITC", "h248.annexc.itc",
FT_UINT8, BASE_DEC, VALS(h248_pkg_annexc_itc_values), 0x1f,
"Information Transfer Capability", HFILL }},
{ &hf_h248_pkg_annexc_transmode,
{ "TransMode", "h248.annexc.transmode",
FT_UINT8, BASE_DEC, VALS(h248_pkg_annexc_transmode_values), 0x60,
"Transfer Mode", HFILL }},
{ &hf_h248_pkg_annexc_transrate,
{ "TransRate", "h248.annexc.transrate",
FT_UINT8, BASE_DEC, VALS(h248_pkg_annexc_transrate_values), 0x1f,
"Transfer Rate", HFILL }},
{ &hf_h248_pkg_annexc_mult,
{ "Rate Multiplier", "h248.annexc.mult",
FT_UINT8, BASE_DEC, NULL, 0,
NULL, HFILL }},
{ &hf_h248_pkg_annexc_syncasync,
{ "SyncAsync", "h248.annexc.syncasync",
FT_UINT8, BASE_DEC, VALS(h248_pkg_annexc_syncasync_values), 0x80,
"Synchronous/Asynchronous", HFILL }},
{ &hf_h248_pkg_annexc_negotiation,
{ "UPPC", "h248.annexc.negotiation",
FT_UINT8, BASE_DEC, VALS(h248_pkg_annexc_negotiation_values), 0x40,
"Negotiation", HFILL }},
{ &hf_h248_pkg_annexc_userrate,
{ "Userrate", "h248.annexc.userrate",
FT_UINT8, BASE_HEX, VALS(h248_pkg_annexc_userrate_values), 0x1f,
"User Rate", HFILL }},
{ &hf_h248_pkg_annexc_intrate,
{ "UPPC", "h248.annexc.intrate",
FT_UINT8, BASE_HEX, VALS(h248_pkg_annexc_intrate_values), 0xc0,
"Intermediate Rate", HFILL }},
{ &hf_h248_pkg_annexc_nictx,
{ "nictx", "h248.annexc.nictx",
FT_UINT8, BASE_HEX, VALS(h248_pkg_annexc_nictx_values), 0xc0,
"Network independent clock on transmission", HFILL }},
{ &hf_h248_pkg_annexc_nicrx,
{ "nicrx", "h248.annexc.nicrx",
FT_UINT8, BASE_HEX, VALS(h248_pkg_annexc_nicrx_values), 0xc0,
"Network independent clock on reception", HFILL }},
{ &hf_h248_pkg_annexc_flowconttx,
{ "flowconttx", "h248.annexc.flowconttx",
FT_UINT8, BASE_HEX, VALS(h248_pkg_annexc_flowconttx_values), 0xc0,
"Flow Control on Transmission", HFILL }},
{ &hf_h248_pkg_annexc_flowcontrx,
{ "flowcontrx", "h248.annexc.flowcontrx",
FT_UINT8, BASE_HEX, VALS(h248_pkg_annexc_flowcontrx_values), 0xc0,
"Flow Control on Reception", HFILL }},
{ &hf_h248_pkg_annexc_rateadapthdr,
{ "rateadapthdr", "h248.annexc.rateadapthdr",
FT_UINT8, BASE_HEX, VALS(h248_pkg_annexc_rateadapthdr_values), 0xc0,
"Rate Adaptation Header/No-Header", HFILL }},
{ &hf_h248_pkg_annexc_multiframe,
{ "multiframe", "h248.annexc.multiframe",
FT_UINT8, BASE_HEX, VALS(h248_pkg_annexc_multiframe_values), 0xc0,
"Multiple Frame establishment support in datalink", HFILL }},
{ &hf_h248_pkg_annexc_opmode,
{ "OPMODE", "h248.annexc.opmode",
FT_UINT8, BASE_HEX, VALS(h248_pkg_annexc_opmode_values), 0xc0,
"Mode of operation", HFILL }},
{ &hf_h248_pkg_annexc_llidnegot,
{ "llidnegot", "h248.annexc.llidnegot",
FT_UINT8, BASE_HEX, VALS(h248_pkg_annexc_llidnegot_values), 0xc0,
"Logical Link Identifier negotiation", HFILL }},
{ &hf_h248_pkg_annexc_assign,
{ "llidnegot", "h248.annexc.assign",
FT_UINT8, BASE_HEX, VALS(h248_pkg_annexc_assign_values), 0xc0,
"Assignor/Assignee", HFILL }},
{ &hf_h248_pkg_annexc_inbandneg,
{ "inbandneg", "h248.annexc.inbandneg",
FT_UINT8, BASE_HEX, VALS(h248_pkg_annexc_inbandneg_values), 0xc0,
"In-band/Out-band negotiation", HFILL }},
{ &hf_h248_pkg_annexc_stopbits,
{ "stopbits", "h248.annexc.stopbits",
FT_UINT8, BASE_HEX, VALS(h248_pkg_annexc_stopbits_values), 0xc0,
"Number of stop bits", HFILL }},
{ &hf_h248_pkg_annexc_databits,
{ "databits", "h248.annexc.databits",
FT_UINT8, BASE_HEX, VALS(h248_pkg_annexc_databits_values), 0xc0,
"Number of data bits", HFILL }},
{ &hf_h248_pkg_annexc_parity,
{ "parity", "h248.annexc.parity",
FT_UINT8, BASE_HEX, VALS(h248_pkg_annexc_parity_values), 0xe0,
"Parity Information Bits", HFILL }},
{ &hf_h248_pkg_annexc_duplexmode,
{ "duplexmode", "h248.annexc.duplexmode",
FT_UINT8, BASE_HEX, VALS(h248_pkg_annexc_duplexmode_values), 0x80,
"Mode Duplex", HFILL }},
{ &hf_h248_pkg_annexc_modem,
{ "modem", "h248.annexc.modem",
FT_UINT8, BASE_HEX, VALS(h248_pkg_annexc_modem_values), 0xfc,
"Modem Type", HFILL }},
{ &hf_h248_pkg_annexc_layer2prot,
{ "layer2prot", "h248.annexc.layer2prot",
FT_UINT8, BASE_HEX, VALS(h248_pkg_annexc_layer2prot_values), 0x80,
"Layer 2 protocol", HFILL }},
{ &hf_h248_pkg_annexc_layer3prot,
{ "layer3prot", "h248.annexc.layer3prot",
FT_UINT8, BASE_HEX, VALS(h248_pkg_annexc_layer3prot_values), 0x80,
"Layer 3 protocol", HFILL }},
{ &hf_h248_pkg_annexc_addlayer3prot,
{ "addlayer3prot", "h248.annexc.addlayer3prot",
FT_UINT8, BASE_HEX, VALS(h248_pkg_annexc_addlayer3prot_values), 0x80,
"Additional User Information Layer 3 protocol", HFILL }},
{ &hf_h248_pkg_annexc_dialedn,
{ "Dialed Number", "h248.annexc.dialedn",
FT_BYTES, BASE_NONE, NULL, 0,
NULL, HFILL }},
{ &hf_h248_pkg_annexc_dialingn,
{ "Dialing Number", "h248.annexc.dialingn",
FT_BYTES, BASE_NONE, NULL, 0,
NULL, HFILL }},
{ &hf_h248_pkg_annexc_echoci,
{ "ECHOCI", "h248.annexc.echoci",
FT_BYTES, BASE_NONE, NULL, 0,
"Not used", HFILL }},
{ &hf_h248_pkg_annexc_nci,
{ "NCI", "h248.annexc.nci",
FT_UINT8, BASE_HEX, NULL, 0xff,
"Nature of Connection Indicator", HFILL }},
{ &hf_h248_pkg_annexc_USI,
{ "USI", "h248.annexc.USI",
FT_BYTES, BASE_NONE, NULL, 0,
"User Service Information", HFILL }},
{ &hf_h248_pkg_annexc_fmsdu,
{ "fmsdu", "h248.annexc.fmsdu",
FT_BYTES, BASE_NONE, NULL, 0,
NULL, HFILL }},
{ &hf_h248_pkg_annexc_bmsdu,
{ "bmsdu", "h248.annexc.bmsdu",
FT_BYTES, BASE_NONE, NULL, 0,
NULL, HFILL }},
{ &hf_h248_pkg_annexc_sscs,
{ "sscs", "h248.annexc.sscs",
FT_BYTES, BASE_NONE, NULL, 0,
NULL, HFILL }},
{ &hf_h248_pkg_annexc_sdp_v,
{ "sdp_v", "h248.annexc.sdp_v",
FT_STRING, BASE_NONE, NULL, 0,
"SDP V", HFILL }},
{ &hf_h248_pkg_annexc_sdp_o,
{ "sdp_o", "h248.annexc.sdp_o",
FT_STRING, BASE_NONE, NULL, 0,
"SDP O", HFILL }},
{ &hf_h248_pkg_annexc_sdp_s,
{ "sdp_s", "h248.annexc.sdp_s",
FT_STRING, BASE_NONE, NULL, 0,
"SDP S", HFILL }},
{ &hf_h248_pkg_annexc_sdp_i,
{ "sdp_i", "h248.annexc.sdp_i",
FT_STRING, BASE_NONE, NULL, 0,
"SDP I", HFILL }},
{ &hf_h248_pkg_annexc_sdp_u,
{ "sdp_u", "h248.annexc.sdp_u",
FT_STRING, BASE_NONE, NULL, 0,
"SDP U", HFILL }},
{ &hf_h248_pkg_annexc_sdp_e,
{ "sdp_e", "h248.annexc.sdp_e",
FT_STRING, BASE_NONE, NULL, 0,
"SDP E", HFILL }},
{ &hf_h248_pkg_annexc_sdp_p,
{ "sdp_p", "h248.annexc.sdp_p",
FT_STRING, BASE_NONE, NULL, 0,
"SDP P", HFILL }},
{ &hf_h248_pkg_annexc_sdp_c,
{ "sdp_c", "h248.annexc.sdp_c",
FT_STRING, BASE_NONE, NULL, 0,
"SDP C", HFILL }},
{ &hf_h248_pkg_annexc_sdp_b,
{ "sdp_b", "h248.annexc.sdp_b",
FT_STRING, BASE_NONE, NULL, 0,
"SDP B", HFILL }},
{ &hf_h248_pkg_annexc_sdp_z,
{ "sdp_z", "h248.annexc.sdp_z",
FT_STRING, BASE_NONE, NULL, 0,
"SDP Z", HFILL }},
{ &hf_h248_pkg_annexc_sdp_k,
{ "sdp_k", "h248.annexc.sdp_k",
FT_STRING, BASE_NONE, NULL, 0,
"SDP K", HFILL }},
{ &hf_h248_pkg_annexc_sdp_a,
{ "sdp_a", "h248.annexc.sdp_a",
FT_STRING, BASE_NONE, NULL, 0,
"SDP A", HFILL }},
{ &hf_h248_pkg_annexc_sdp_t,
{ "sdp_t", "h248.annexc.sdp_t",
FT_STRING, BASE_NONE, NULL, 0,
"SDP T", HFILL }},
{ &hf_h248_pkg_annexc_sdp_r,
{ "sdp_r", "h248.annexc.sdp_r",
FT_STRING, BASE_NONE, NULL, 0,
"SDP R", HFILL }},
{ &hf_h248_pkg_annexc_sdp_m,
{ "sdp_m", "h248.annexc.sdp_m",
FT_STRING, BASE_NONE, NULL, 0,
"SDP M", HFILL }},
{ &hf_h248_pkg_annexc_olc,
{ "OLC", "h248.annexc.olc",
FT_BYTES, BASE_NONE, NULL, 0,
"Open Logical Channel", HFILL }},
{ &hf_h248_pkg_annexc_olcack,
{ "OLCack", "h248.annexc.olcack",
FT_BYTES, BASE_NONE, NULL, 0,
"Open Logical Channel Acknowledge", HFILL }},
{ &hf_h248_pkg_annexc_olccnf,
{ "OLCcnf", "h248.annexc.olccnf",
FT_BYTES, BASE_NONE, NULL, 0,
"Open Logical Channel CNF", HFILL }},
{ &hf_h248_pkg_annexc_olcrej,
{ "OLCrej", "h248.annexc.olcrej",
FT_BYTES, BASE_NONE, NULL, 0,
"Open Logical Channel Reject", HFILL }},
{ &hf_h248_pkg_annexc_clc,
{ "CLC", "h248.annexc.clc",
FT_BYTES, BASE_NONE, NULL, 0,
"Close Logical Channel", HFILL }},
{ &hf_h248_pkg_annexc_clcack,
{ "CLCack", "h248.annexc.clcack",
FT_BYTES, BASE_NONE, NULL, 0,
NULL, HFILL }},
};
static gint *ett[] = {
&ett_annexc,
&ett_vpvc,
&ett_codec
};
proto_h248_pkg_annexc = proto_register_protocol(PNAME, PSNAME, PFNAME);
proto_register_field_array(proto_h248_pkg_annexc, hf, array_length(hf));
proto_register_subtree_array(ett, array_length(ett));
h248_register_package(&h248_annexc_package,MERGE_PKG_HIGH);
}
void
proto_reg_handoff_h248_annex_c(void)
{
hf_h248_sdp_connection_info = proto_registrar_get_id_byname("sdp.connection_info");
hf_h248_sdp_media_port = proto_registrar_get_id_byname("sdp.media.port");
}
