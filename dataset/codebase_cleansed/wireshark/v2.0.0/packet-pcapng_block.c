static void\r\ndissect_pcapng_block(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nif (!dissector_try_uint(pcapng_block_type_dissector_table,\r\npinfo->pseudo_header->ftsrec.record_type, tvb, pinfo, tree)) {\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "PCAP-NG");\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "PCAP-NG block, type %u",\r\npinfo->pseudo_header->ftsrec.record_type);\r\nproto_tree_add_item(tree, proto_pcapng_block, tvb, 0, -1, ENC_NA);\r\n}\r\n}\r\nvoid proto_register_pcapng_block(void)\r\n{\r\nproto_pcapng_block = proto_register_protocol("PCAP-NG block",\r\n"PCAP-NG", "pcapng");\r\npcapng_block_type_dissector_table = register_dissector_table("pcapng.block_type",\r\n"pcap-ng block type", FT_UINT32, BASE_DEC);\r\n}\r\nvoid\r\nproto_reg_handoff_pcapng_block(void)\r\n{\r\ndissector_handle_t pcapng_block_handle;\r\npcapng_block_handle = create_dissector_handle(dissect_pcapng_block,\r\nproto_pcapng_block);\r\ndissector_add_uint("wtap_fts_rec", WTAP_FILE_TYPE_SUBTYPE_PCAPNG,\r\npcapng_block_handle);\r\n}
