void wimax_mac_gen_crc32_table(void)\r\n{\r\nguint32 index, bit;\r\nguint32 crc;\r\nfor ( index = 0; index < G_N_ELEMENTS(crc32_table); index++ )\r\n{\r\ncrc = ( index << 24 );\r\nfor ( bit = 0; bit < 8; bit++ )\r\n{\r\nif ( crc & 0x80000000U )\r\ncrc = ( crc << 1 ) ^ WMAX_MAC_CRC32_POLYNOMIAL;\r\nelse\r\ncrc = ( crc << 1 );\r\n}\r\ncrc32_table[index] = crc;\r\n}\r\n}\r\nvoid wimax_mac_gen_crc8_table(void)\r\n{\r\nguint index, bit;\r\nguint8 crc;\r\nfor ( index = 0; index < G_N_ELEMENTS(crc8_table); index++ )\r\n{\r\ncrc = index;\r\nfor ( bit = 0; bit < 8; bit++ )\r\n{\r\nif ( crc & 0x80 )\r\ncrc = ( crc << 1 ) ^ WMAX_MAC_CRC8_POLYNOMIAL;\r\nelse\r\ncrc = ( crc << 1 );\r\n}\r\ncrc8_table[index] = crc;\r\n}\r\n}\r\nguint32 wimax_mac_calc_crc32(const guint8 *data, guint data_len)\r\n{\r\nguint32 crc=CRC32_INITIAL_VALUE;\r\nguint i, j;\r\nfor ( j = 0; j < data_len; j++ )\r\n{\r\ni = ( (guint8)(crc>>24) ^ data[j] ) & 0xff;\r\ncrc = ( crc<<8 ) ^ crc32_table[i];\r\n}\r\nreturn ~crc;\r\n}\r\nguint16 wimax_mac_calc_crc16(const guint8 *data, guint data_len)\r\n{\r\nguint32 crc=CRC16_INITIAL_VALUE;\r\nguint j;\r\nfor ( j = 0; j < data_len; j++ )\r\n{\r\ncrc ^= data[j] << 8;\r\ncrc = (crc << 8) ^ crc16_table[(crc & 0xff00) >> 8];\r\n}\r\ncrc ^= 0xFFFF;\r\ncrc &= 0xFFFF;\r\nreturn crc;\r\n}\r\nguint8 wimax_mac_calc_crc8(const guint8 *data, guint data_len)\r\n{\r\nguint8 crc=0;\r\nguint i;\r\nfor(i = 0; i < data_len; i++)\r\n{\r\ncrc = crc8_table[data[i]^crc];\r\n}\r\nreturn crc;\r\n}
