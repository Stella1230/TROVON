static int\r\ndissect_statnotify_mon(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_string(tvb,tree,hf_statnotify_name,offset,NULL);\r\noffset = dissect_rpc_uint32(tvb,tree,hf_statnotify_state,offset);\r\nproto_tree_add_item(tree,hf_statnotify_priv,tvb,offset,16,ENC_NA);\r\noffset += 16;\r\nreturn offset;\r\n}\r\nvoid\r\nproto_register_statnotify(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_statnotify_procedure_v1, {\r\n"V1 Procedure", "statnotify.procedure_v1", FT_UINT32, BASE_DEC,\r\nVALS(statnotify1_proc_vals), 0, NULL, HFILL }},\r\n{ &hf_statnotify_name, {\r\n"Name", "statnotify.name", FT_STRING, BASE_NONE,\r\nNULL, 0, "Name of client that changed", HFILL }},\r\n{ &hf_statnotify_state, {\r\n"State", "statnotify.state", FT_UINT32, BASE_DEC,\r\nNULL, 0, "New state of client that changed", HFILL }},\r\n{ &hf_statnotify_priv, {\r\n"Priv", "statnotify.priv", FT_BYTES, BASE_NONE,\r\nNULL, 0, "Client supplied opaque data", HFILL }},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_statnotify,\r\n};\r\nproto_statnotify = proto_register_protocol("Network Status Monitor CallBack Protocol", "STAT-CB", "statnotify");\r\nproto_register_field_array(proto_statnotify, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid\r\nproto_reg_handoff_statnotify(void)\r\n{\r\nrpc_init_prog(proto_statnotify, STATNOTIFY_PROGRAM, ett_statnotify,\r\nG_N_ELEMENTS(statnotify_vers_info), statnotify_vers_info);\r\n}
