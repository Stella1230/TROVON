void\r\nzdp_parse_bind_table_entry(proto_tree *tree, tvbuff_t *tvb, guint *offset, guint8 version)\r\n{\r\nproto_tree *bind_tree;\r\nproto_item *ti;\r\nguint len = 0;\r\nguint8 mode;\r\nbind_tree = proto_tree_add_subtree(tree, tvb, *offset, 0, ett_zbee_zdp_bind_entry, &ti, "Bind");\r\nproto_tree_add_item(bind_tree, hf_zbee_zdp_bind_src64, tvb, *offset, 8, ENC_LITTLE_ENDIAN);\r\nlen += 8;\r\nproto_tree_add_item(bind_tree, hf_zbee_zdp_bind_src_ep, tvb, *offset + len, 1, ENC_LITTLE_ENDIAN);\r\nlen += 1;\r\nif (version >= ZBEE_VERSION_2007) {\r\nproto_tree_add_item(bind_tree, hf_zbee_zdp_cluster, tvb, *offset + len, 2, ENC_LITTLE_ENDIAN);\r\nlen += 2;\r\n}\r\nelse {\r\nproto_tree_add_item(bind_tree, hf_zbee_zdp_cluster, tvb, *offset + len, 1, ENC_LITTLE_ENDIAN);\r\nlen += 1;\r\n}\r\nif (version >= ZBEE_VERSION_2007) {\r\nmode = tvb_get_guint8(tvb, *offset + len);\r\nlen += 1;\r\n}\r\nelse {\r\nmode = ZBEE_ZDP_ADDR_MODE_UNICAST;\r\n}\r\nif (mode == ZBEE_ZDP_ADDR_MODE_GROUP) {\r\nproto_tree_add_item(bind_tree, hf_zbee_zdp_bind_dst, tvb, *offset + len, 2, ENC_LITTLE_ENDIAN);\r\nlen += 2;\r\n}\r\nelse if (mode == ZBEE_ZDP_ADDR_MODE_UNICAST) {\r\nproto_tree_add_item(bind_tree, hf_zbee_zdp_bind_dst64, tvb, *offset + len, 8, ENC_LITTLE_ENDIAN);\r\nlen += 8;\r\nproto_tree_add_item(bind_tree, hf_zbee_zdp_bind_dst_ep, tvb, *offset + len, 1, ENC_LITTLE_ENDIAN);\r\nlen += 1;\r\n}\r\nproto_item_set_len(ti, len);\r\n*offset += len;\r\n}\r\nvoid\r\ndissect_zbee_zdp_req_end_device_bind(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint8 version)\r\n{\r\nguint sizeof_cluster = (version >= ZBEE_VERSION_2007)?(int)sizeof(guint16):(int)sizeof(guint8);\r\nguint i;\r\nproto_tree *field_tree = NULL;\r\nguint offset = 0;\r\nguint16 target;\r\nguint64 ext_addr = 0;\r\nguint8 in_count;\r\nguint8 out_count;\r\ntarget = zbee_parse_uint(tree, hf_zbee_zdp_target, tvb, &offset, (guint)sizeof(guint16), NULL);\r\nif (version >= ZBEE_VERSION_2007) {\r\next_addr = zbee_parse_eui64(tree, hf_zbee_zdp_ext_addr, tvb, &offset, (guint)sizeof(guint64), NULL);\r\n}\r\nzbee_parse_uint(tree, hf_zbee_zdp_endpoint, tvb, &offset, (guint)sizeof(guint8), NULL);\r\nzbee_parse_uint(tree, hf_zbee_zdp_profile, tvb, &offset, (guint)sizeof(guint16), NULL);\r\nin_count = zbee_parse_uint(tree, hf_zbee_zdp_in_count, tvb, &offset, (guint)sizeof(guint8), NULL);\r\nif ((tree) && (in_count)){\r\nfield_tree = proto_tree_add_subtree(tree, tvb, offset, (int)(in_count*sizeof_cluster),\r\nett_zbee_zdp_bind_end_in, NULL, "Input Cluster List");\r\n}\r\nfor (i=0; i<in_count; i++) zbee_parse_uint(field_tree, hf_zbee_zdp_in_cluster, tvb, &offset, (guint)sizeof_cluster, NULL);\r\nout_count = zbee_parse_uint(tree, hf_zbee_zdp_out_count, tvb, &offset, (guint)sizeof(guint8), NULL);\r\nif ((tree) && (out_count)) {\r\nfield_tree = proto_tree_add_subtree(tree, tvb, offset, (int)(out_count*sizeof_cluster),\r\nett_zbee_zdp_bind_end_out, NULL, "Output Cluster List");\r\n}\r\nfor (i=0; i<out_count; i++) zbee_parse_uint(field_tree, hf_zbee_zdp_out_cluster, tvb, &offset, sizeof_cluster, NULL);\r\nif (version >= ZBEE_VERSION_2007) {\r\nzbee_append_info(tree, pinfo, " Src: %s", eui64_to_display(wmem_packet_scope(), ext_addr));\r\n}\r\nzbee_append_info(tree, pinfo, ", Target: 0x%04x", target);\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_req_bind(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint8 version)\r\n{\r\nproto_item *ti;\r\nguint offset = 0;\r\nguint64 src64;\r\nguint8 dst_mode;\r\nguint16 dst = 0;\r\nguint64 dst64 = 0;\r\nsrc64 = zbee_parse_eui64(tree, hf_zbee_zdp_bind_src64, tvb, &offset, (int)sizeof(guint64), NULL);\r\nzbee_parse_uint(tree, hf_zbee_zdp_bind_src_ep, tvb, &offset, (int)sizeof(guint8), NULL);\r\nzbee_parse_uint(tree, hf_zbee_zdp_cluster, tvb, &offset, ZBEE_HAS_2006(version)?(int)sizeof(guint16):(int)sizeof(guint8), NULL);\r\nif (version >= ZBEE_VERSION_2007) {\r\ndst_mode = zbee_parse_uint(tree, hf_zbee_zdp_addr_mode, tvb, &offset, (int)sizeof(guint8), &ti);\r\nif (tree) {\r\nif (dst_mode == ZBEE_ZDP_ADDR_MODE_GROUP) proto_item_append_text(ti, " (Group)");\r\nelse if (dst_mode == ZBEE_ZDP_ADDR_MODE_UNICAST) proto_item_append_text(ti, " (Unicast)");\r\nelse proto_item_append_text(ti, " (Reserved)");\r\n}\r\n}\r\nelse {\r\ndst_mode = ZBEE_ZDP_ADDR_MODE_UNICAST;\r\n}\r\nif (dst_mode == ZBEE_ZDP_ADDR_MODE_GROUP) {\r\ndst = zbee_parse_uint(tree, hf_zbee_zdp_bind_dst, tvb, &offset, (int)sizeof(guint16), NULL);\r\n}\r\nelse if (dst_mode == ZBEE_ZDP_ADDR_MODE_UNICAST) {\r\ndst64 = zbee_parse_eui64(tree, hf_zbee_zdp_bind_dst64, tvb, &offset, (int)sizeof(guint64), NULL);\r\nzbee_parse_uint(tree, hf_zbee_zdp_bind_dst_ep, tvb, &offset, (int)sizeof(guint8), NULL);\r\n}\r\nif (version >= ZBEE_VERSION_2007) {\r\nzbee_append_info(tree, pinfo, " Src: %s", eui64_to_display(wmem_packet_scope(), src64));\r\n}\r\nif (dst_mode == ZBEE_ZDP_ADDR_MODE_GROUP) {\r\nzbee_append_info(tree, pinfo, ", Dst: 0x%04x", dst);\r\n}\r\nelse {\r\nzbee_append_info(tree, pinfo, ", Dst: %s", eui64_to_display(wmem_packet_scope(), dst64));\r\n}\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_req_unbind(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint8 version)\r\n{\r\nproto_item *ti;\r\nguint offset = 0;\r\nguint64 src64;\r\nguint8 dst_mode;\r\nguint16 dst = 0;\r\nguint64 dst64 = 0;\r\nsrc64 = zbee_parse_eui64(tree, hf_zbee_zdp_bind_src64, tvb, &offset, (int)sizeof(guint64), NULL);\r\nzbee_parse_uint(tree, hf_zbee_zdp_bind_src_ep, tvb, &offset, (int)sizeof(guint8), NULL);\r\nzbee_parse_uint(tree, hf_zbee_zdp_cluster, tvb, &offset, (version >= ZBEE_VERSION_2007)?(int)sizeof(guint16):(int)sizeof(guint8), NULL);\r\nif (version >= ZBEE_VERSION_2007) {\r\ndst_mode = zbee_parse_uint(tree, hf_zbee_zdp_addr_mode, tvb, &offset, (int)sizeof(guint8), &ti);\r\nif (tree) {\r\nif (dst_mode == ZBEE_ZDP_ADDR_MODE_GROUP) proto_item_append_text(ti, " (Group)");\r\nelse if (dst_mode == ZBEE_ZDP_ADDR_MODE_UNICAST) proto_item_append_text(ti, " (Unicast)");\r\nelse proto_item_append_text(ti, " (Reserved)");\r\n}\r\n}\r\nelse {\r\ndst_mode = ZBEE_ZDP_ADDR_MODE_UNICAST;\r\n}\r\nif (dst_mode == ZBEE_ZDP_ADDR_MODE_GROUP) {\r\ndst = zbee_parse_uint(tree, hf_zbee_zdp_bind_dst, tvb, &offset, (int)sizeof(guint16), NULL);\r\n}\r\nelse if (dst_mode == ZBEE_ZDP_ADDR_MODE_UNICAST) {\r\ndst64 = zbee_parse_eui64(tree, hf_zbee_zdp_bind_dst64, tvb, &offset, (int)sizeof(guint64), NULL);\r\nzbee_parse_uint(tree, hf_zbee_zdp_bind_dst_ep, tvb, &offset, (int)sizeof(guint8), NULL);\r\n}\r\nif (version >= ZBEE_VERSION_2007) {\r\nzbee_append_info(tree, pinfo, " Src: %s", eui64_to_display(wmem_packet_scope(), src64));\r\n}\r\nif (dst_mode == ZBEE_ZDP_ADDR_MODE_GROUP) {\r\nzbee_append_info(tree, pinfo, ", Dst: 0x%04x", dst);\r\n}\r\nelse {\r\nzbee_append_info(tree, pinfo, ", Dst: %s", eui64_to_display(wmem_packet_scope(), dst64));\r\n}\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_req_bind_register(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint offset = 0;\r\nguint64 ext_addr;\r\next_addr = zbee_parse_eui64(tree, hf_zbee_zdp_ext_addr, tvb, &offset, (int)sizeof(guint64), NULL);\r\nzbee_append_info(tree, pinfo, ", Device: %s", eui64_to_display(wmem_packet_scope(), ext_addr));\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_req_replace_device(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint offset = 0;\r\nguint64 ext_addr;\r\nguint64 new_addr;\r\next_addr = zbee_parse_eui64(tree, hf_zbee_zdp_ext_addr, tvb, &offset, (int)sizeof(guint64), NULL);\r\nzbee_parse_uint(tree, hf_zbee_zdp_endpoint, tvb, &offset, (int)sizeof(guint8), NULL);\r\nnew_addr = zbee_parse_eui64(tree, hf_zbee_zdp_replacement, tvb, &offset, (int)sizeof(guint64), NULL);\r\nzbee_parse_uint(tree, hf_zbee_zdp_replacement_ep, tvb, &offset, (int)sizeof(guint8), NULL);\r\nzbee_append_info(tree, pinfo, ", Device: %s", eui64_to_display(wmem_packet_scope(), ext_addr));\r\nzbee_append_info(tree, pinfo, ", Replacement: %s", eui64_to_display(wmem_packet_scope(), new_addr));\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_req_store_bak_bind_entry(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint8 version)\r\n{\r\nproto_item *ti;\r\nguint offset = 0;\r\nguint64 src64;\r\nguint8 src_ep;\r\nguint16 cluster;\r\nguint8 dst_mode;\r\nsrc64 = zbee_parse_eui64(tree, hf_zbee_zdp_bind_src64, tvb, &offset, (int)sizeof(guint64), NULL);\r\nsrc_ep = zbee_parse_uint(tree, hf_zbee_zdp_bind_src_ep, tvb, &offset, (int)sizeof(guint8), NULL);\r\ncluster = zbee_parse_uint(tree, hf_zbee_zdp_cluster, tvb, &offset, (version >= ZBEE_VERSION_2007)?(int)sizeof(guint16):(int)sizeof(guint8), NULL);\r\ndst_mode = zbee_parse_uint(tree, hf_zbee_zdp_addr_mode, tvb, &offset, (int)sizeof(guint8), &ti);\r\nif (dst_mode == ZBEE_ZDP_ADDR_MODE_GROUP) {\r\nif (tree) proto_item_append_text(ti, " (Group)");\r\nzbee_parse_uint(tree, hf_zbee_zdp_bind_dst, tvb, &offset, (int)sizeof(guint16), NULL);\r\n}\r\nelse if (dst_mode == ZBEE_ZDP_ADDR_MODE_UNICAST) {\r\nif (tree) proto_item_append_text(ti, " (Unicast)");\r\nzbee_parse_eui64(tree, hf_zbee_zdp_bind_dst64, tvb, &offset, (int)sizeof(guint64), NULL);\r\nzbee_parse_uint(tree, hf_zbee_zdp_bind_dst_ep, tvb, &offset, (int)sizeof(guint8), NULL);\r\n}\r\nelse if (tree) proto_item_append_text(ti, " (Reserved)");\r\nzbee_append_info(tree, pinfo, ", Src: %s", eui64_to_display(wmem_packet_scope(), src64));\r\nzbee_append_info(tree, pinfo, ", Src Endpoint: %d", src_ep);\r\nzbee_append_info(tree, pinfo, ", Cluster: %d", cluster);\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_req_remove_bak_bind_entry(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint8 version)\r\n{\r\nproto_item *ti;\r\nguint offset = 0;\r\nguint64 src64;\r\nguint8 src_ep;\r\nguint16 cluster;\r\nguint8 dst_mode;\r\nsrc64 = zbee_parse_eui64(tree, hf_zbee_zdp_bind_src64, tvb, &offset, (int)sizeof(guint64), NULL);\r\nsrc_ep = zbee_parse_uint(tree, hf_zbee_zdp_bind_src_ep, tvb, &offset, (int)sizeof(guint8), NULL);\r\ncluster = zbee_parse_uint(tree, hf_zbee_zdp_cluster, tvb, &offset, (version >= ZBEE_VERSION_2007)?(int)sizeof(guint16):(int)sizeof(guint8), NULL);\r\ndst_mode = zbee_parse_uint(tree, hf_zbee_zdp_addr_mode, tvb, &offset, (int)sizeof(guint8), &ti);\r\nif (dst_mode == ZBEE_ZDP_ADDR_MODE_GROUP) {\r\nif (tree) proto_item_append_text(ti, " (Group)");\r\nzbee_parse_uint(tree, hf_zbee_zdp_bind_dst, tvb, &offset, (int)sizeof(guint16), NULL);\r\n}\r\nelse if (dst_mode == ZBEE_ZDP_ADDR_MODE_UNICAST) {\r\nif (tree) proto_item_append_text(ti, " (Unicast)");\r\nzbee_parse_eui64(tree, hf_zbee_zdp_bind_dst64, tvb, &offset, (int)sizeof(guint64), NULL);\r\nzbee_parse_uint(tree, hf_zbee_zdp_bind_dst_ep, tvb, &offset, (int)sizeof(guint8), NULL);\r\n}\r\nelse if (tree) proto_item_append_text(ti, " (Reserved)");\r\nzbee_append_info(tree, pinfo, ", Src: %s", eui64_to_display(wmem_packet_scope(), src64));\r\nzbee_append_info(tree, pinfo, ", Src Endpoint: %d", src_ep);\r\nzbee_append_info(tree, pinfo, ", Cluster: %d", cluster);\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_req_backup_bind_table(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint8 version)\r\n{\r\nproto_tree *field_tree;\r\nguint i;\r\nguint offset = 0;\r\nguint16 table_count;\r\nzbee_parse_uint(tree, hf_zbee_zdp_table_size, tvb, &offset, (int)sizeof(guint16), NULL);\r\nzbee_parse_uint(tree, hf_zbee_zdp_index, tvb, &offset, (int)sizeof(guint16), NULL);\r\ntable_count = zbee_parse_uint(tree, hf_zbee_zdp_table_count, tvb, &offset, (int)sizeof(guint16), NULL);\r\nfield_tree = proto_tree_add_subtree(tree, tvb, offset, -1, ett_zbee_zdp_bind, NULL, "Binding Table");\r\nfor (i=0; i<table_count; i++) {\r\nzdp_parse_bind_table_entry(field_tree, tvb, &offset, version);\r\n}\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_req_recover_bind_table(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint offset = 0;\r\nzbee_parse_uint(tree, hf_zbee_zdp_index, tvb, &offset, (int)sizeof(guint16), NULL);\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_req_backup_source_bind(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nproto_tree *field_tree;\r\nguint i;\r\nguint offset = 0;\r\nguint16 count;\r\nzbee_parse_uint(tree, hf_zbee_zdp_table_size, tvb, &offset, (int)sizeof(guint16), NULL);\r\nzbee_parse_uint(tree, hf_zbee_zdp_index, tvb, &offset, (int)sizeof(guint16), NULL);\r\ncount = zbee_parse_uint(tree, hf_zbee_zdp_table_count, tvb, &offset, (int)sizeof(guint16), NULL);\r\nfield_tree = proto_tree_add_subtree(tree, tvb, offset, count*(int)sizeof(guint64),\r\nett_zbee_zdp_bind_source, NULL, "Source Table");\r\nfor (i=0; i<count; i++) zbee_parse_eui64(field_tree, hf_zbee_zdp_bind_src64, tvb, &offset, (int)sizeof(guint64), NULL);\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_req_recover_source_bind(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint offset = 0;\r\nzbee_parse_uint(tree, hf_zbee_zdp_index, tvb, &offset, (int)sizeof(guint16), NULL);\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_rsp_end_device_bind(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint offset = 0;\r\nguint8 status;\r\nstatus = zdp_parse_status(tree, tvb, &offset);\r\nzbee_append_info(tree, pinfo, ", Status: %s", zdp_status_name(status));\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_rsp_bind(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint offset = 0;\r\nguint8 status;\r\nstatus = zdp_parse_status(tree, tvb, &offset);\r\nzbee_append_info(tree, pinfo, ", Status: %s", zdp_status_name(status));\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_rsp_unbind(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint offset = 0;\r\nguint8 status;\r\nstatus = zdp_parse_status(tree, tvb, &offset);\r\nzbee_append_info(tree, pinfo, ", Status: %s", zdp_status_name(status));\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_rsp_bind_register(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint8 version)\r\n{\r\nproto_tree *field_tree = NULL;\r\nguint offset = 0;\r\nguint i;\r\nguint8 status;\r\nguint16 table_count;\r\nstatus = zdp_parse_status(tree, tvb, &offset);\r\nzbee_parse_uint(tree, hf_zbee_zdp_table_size, tvb, &offset, (int)sizeof(guint16), NULL);\r\ntable_count = zbee_parse_uint(tree, hf_zbee_zdp_table_count, tvb, &offset, (int)sizeof(guint16), NULL);\r\nif (tree && table_count) {\r\nfield_tree = proto_tree_add_subtree(tree, tvb, offset, -1, ett_zbee_zdp_bind, NULL, "Binding List");\r\n}\r\nfor (i=0; i<table_count; i++) {\r\nzdp_parse_bind_table_entry(field_tree, tvb, &offset, version);\r\n}\r\nzbee_append_info(tree, pinfo, ", Status: %s", zdp_status_name(status));\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_rsp_replace_device(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint offset = 0;\r\nguint8 status;\r\nstatus = zdp_parse_status(tree, tvb, &offset);\r\nzbee_append_info(tree, pinfo, ", Status: %s", zdp_status_name(status));\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_rsp_store_bak_bind_entry(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint offset = 0;\r\nguint8 status;\r\nstatus = zdp_parse_status(tree, tvb, &offset);\r\nzbee_append_info(tree, pinfo, ", Status: %s", zdp_status_name(status));\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_rsp_remove_bak_bind_entry(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint offset = 0;\r\nguint8 status;\r\nstatus = zdp_parse_status(tree, tvb, &offset);\r\nzbee_append_info(tree, pinfo, ", Status: %s", zdp_status_name(status));\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_rsp_backup_bind_table(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint offset = 0;\r\nguint8 status;\r\nstatus = zdp_parse_status(tree, tvb, &offset);\r\nzbee_parse_uint(tree, hf_zbee_zdp_table_size, tvb, &offset, (int)sizeof(guint16), NULL);\r\nzbee_append_info(tree, pinfo, ", Status: %s", zdp_status_name(status));\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_rsp_recover_bind_table(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint8 version)\r\n{\r\nproto_tree *field_tree = NULL;\r\nguint offset = 0;\r\nguint i;\r\nguint8 status;\r\nguint16 table_count;\r\nstatus = zdp_parse_status(tree, tvb, &offset);\r\nzbee_parse_uint(tree, hf_zbee_zdp_table_size, tvb, &offset, (int)sizeof(guint16), NULL);\r\nzbee_parse_uint(tree, hf_zbee_zdp_index, tvb, &offset, (int)sizeof(guint16), NULL);\r\ntable_count = zbee_parse_uint(tree, hf_zbee_zdp_table_count, tvb, &offset, (int)sizeof(guint16), NULL);\r\nif (tree && table_count) {\r\nfield_tree = proto_tree_add_subtree(tree, tvb, offset, -1, ett_zbee_zdp_bind, NULL, "Binding Table");\r\n}\r\nfor (i=0; i<table_count; i++) {\r\nzdp_parse_bind_table_entry(field_tree, tvb, &offset, version);\r\n}\r\nzbee_append_info(tree, pinfo, ", Status: %s", zdp_status_name(status));\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_rsp_backup_source_bind(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint offset = 0;\r\nguint8 status;\r\nstatus = zdp_parse_status(tree, tvb, &offset);\r\nzbee_append_info(tree, pinfo, ", Status: %s", zdp_status_name(status));\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_rsp_recover_source_bind(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nproto_tree *field_tree = NULL;\r\nguint offset = 0;\r\nguint i;\r\nguint8 status;\r\nguint16 table_count;\r\nstatus = zdp_parse_status(tree, tvb, &offset);\r\nzbee_parse_uint(tree, hf_zbee_zdp_table_size, tvb, &offset, (int)sizeof(guint16), NULL);\r\nzbee_parse_uint(tree, hf_zbee_zdp_index, tvb, &offset, (int)sizeof(guint16), NULL);\r\ntable_count = zbee_parse_uint(tree, hf_zbee_zdp_table_count, tvb, &offset, (int)sizeof(guint16), NULL);\r\nif (tree && table_count) {\r\nfield_tree = proto_tree_add_subtree(tree, tvb, offset, table_count * (int)sizeof(guint64),\r\nett_zbee_zdp_bind_source, NULL, "Source Table");\r\n}\r\nfor (i=0; i<table_count; i++) {\r\n(void)zbee_parse_eui64(field_tree, hf_zbee_zdp_bind_src64, tvb, &offset, (int)sizeof(guint64), NULL);\r\n}\r\nzbee_append_info(tree, pinfo, ", Status: %s", zdp_status_name(status));\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}
