static int\r\nmisc_dissect_element_GUID_time_low(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_misc_GUID_time_low, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmisc_dissect_element_GUID_time_mid(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint16(tvb, offset, pinfo, tree, di, drep, hf_misc_GUID_time_mid, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmisc_dissect_element_GUID_time_hi_and_version(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint16(tvb, offset, pinfo, tree, di, drep, hf_misc_GUID_time_hi_and_version, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmisc_dissect_element_GUID_clock_seq(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nint i;\r\nfor (i = 0; i < 2; i++)\r\noffset = misc_dissect_element_GUID_clock_seq_(tvb, offset, pinfo, tree, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nmisc_dissect_element_GUID_clock_seq_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint8(tvb, offset, pinfo, tree, di, drep, hf_misc_GUID_clock_seq, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmisc_dissect_element_GUID_node(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nint i;\r\nfor (i = 0; i < 6; i++)\r\noffset = misc_dissect_element_GUID_node_(tvb, offset, pinfo, tree, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nmisc_dissect_element_GUID_node_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint8(tvb, offset, pinfo, tree, di, drep, hf_misc_GUID_node, 0);\r\nreturn offset;\r\n}\r\nint\r\nmisc_dissect_struct_GUID(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *parent_tree _U_, dcerpc_info* di _U_, guint8 *drep _U_, int hf_index _U_, guint32 param _U_)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset;\r\nALIGN_TO_4_BYTES;\r\nold_offset = offset;\r\nif (parent_tree) {\r\nitem = proto_tree_add_item(parent_tree, hf_index, tvb, offset, -1, ENC_NA);\r\ntree = proto_item_add_subtree(item, ett_misc_GUID);\r\n}\r\noffset = misc_dissect_element_GUID_time_low(tvb, offset, pinfo, tree, di, drep);\r\noffset = misc_dissect_element_GUID_time_mid(tvb, offset, pinfo, tree, di, drep);\r\noffset = misc_dissect_element_GUID_time_hi_and_version(tvb, offset, pinfo, tree, di, drep);\r\noffset = misc_dissect_element_GUID_clock_seq(tvb, offset, pinfo, tree, di, drep);\r\noffset = misc_dissect_element_GUID_node(tvb, offset, pinfo, tree, di, drep);\r\nproto_item_set_len(item, offset-old_offset);\r\nif (di->call_data->flags & DCERPC_IS_NDR64) {\r\nALIGN_TO_4_BYTES;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\nmisc_dissect_element_ndr_syntax_id_uuid(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_uuid_t(tvb, offset, pinfo, tree, di, drep, hf_misc_ndr_syntax_id_uuid, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\nmisc_dissect_element_ndr_syntax_id_if_version(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_misc_ndr_syntax_id_if_version, 0);\r\nreturn offset;\r\n}\r\nint\r\nmisc_dissect_struct_ndr_syntax_id(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *parent_tree _U_, dcerpc_info* di _U_, guint8 *drep _U_, int hf_index _U_, guint32 param _U_)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset;\r\nALIGN_TO_4_BYTES;\r\nold_offset = offset;\r\nif (parent_tree) {\r\nitem = proto_tree_add_item(parent_tree, hf_index, tvb, offset, -1, ENC_NA);\r\ntree = proto_item_add_subtree(item, ett_misc_ndr_syntax_id);\r\n}\r\noffset = misc_dissect_element_ndr_syntax_id_uuid(tvb, offset, pinfo, tree, di, drep);\r\noffset = misc_dissect_element_ndr_syntax_id_if_version(tvb, offset, pinfo, tree, di, drep);\r\nproto_item_set_len(item, offset-old_offset);\r\nif (di->call_data->flags & DCERPC_IS_NDR64) {\r\nALIGN_TO_4_BYTES;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\nmisc_dissect_element_policy_handle_handle_type(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_misc_policy_handle_handle_type, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmisc_dissect_element_policy_handle_uuid(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_uuid_t(tvb, offset, pinfo, tree, di, drep, hf_misc_policy_handle_uuid, NULL);\r\nreturn offset;\r\n}\r\nint\r\nmisc_dissect_struct_policy_handle(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *parent_tree _U_, dcerpc_info* di _U_, guint8 *drep _U_, int hf_index _U_, guint32 param _U_)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset;\r\nALIGN_TO_4_BYTES;\r\nold_offset = offset;\r\nif (parent_tree) {\r\nitem = proto_tree_add_item(parent_tree, hf_index, tvb, offset, -1, ENC_NA);\r\ntree = proto_item_add_subtree(item, ett_misc_policy_handle);\r\n}\r\noffset = misc_dissect_element_policy_handle_handle_type(tvb, offset, pinfo, tree, di, drep);\r\noffset = misc_dissect_element_policy_handle_uuid(tvb, offset, pinfo, tree, di, drep);\r\nproto_item_set_len(item, offset-old_offset);\r\nif (di->call_data->flags & DCERPC_IS_NDR64) {\r\nALIGN_TO_4_BYTES;\r\n}\r\nreturn offset;\r\n}\r\nint\r\nmisc_dissect_enum_netr_SchannelType(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_, int hf_index _U_, guint1632 *param _U_)\r\n{\r\nguint1632 parameter=0;\r\nif (param) {\r\nparameter = *param;\r\n}\r\noffset = dissect_ndr_uint1632(tvb, offset, pinfo, tree, di, drep, hf_index, &parameter);\r\nif (param) {\r\n*param = parameter;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\nmisc_dissect_element_KRB5_EDATA_NTSTATUS_ntstatus(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_misc_KRB5_EDATA_NTSTATUS_ntstatus, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmisc_dissect_element_KRB5_EDATA_NTSTATUS_unknown1(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_misc_KRB5_EDATA_NTSTATUS_unknown1, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmisc_dissect_element_KRB5_EDATA_NTSTATUS_unknown2(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_misc_KRB5_EDATA_NTSTATUS_unknown2, 0);\r\nreturn offset;\r\n}\r\nint\r\nmisc_dissect_struct_KRB5_EDATA_NTSTATUS(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *parent_tree _U_, dcerpc_info* di _U_, guint8 *drep _U_, int hf_index _U_, guint32 param _U_)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset;\r\nALIGN_TO_4_BYTES;\r\nold_offset = offset;\r\nif (parent_tree) {\r\nitem = proto_tree_add_item(parent_tree, hf_index, tvb, offset, -1, ENC_NA);\r\ntree = proto_item_add_subtree(item, ett_misc_KRB5_EDATA_NTSTATUS);\r\n}\r\noffset = misc_dissect_element_KRB5_EDATA_NTSTATUS_ntstatus(tvb, offset, pinfo, tree, di, drep);\r\noffset = misc_dissect_element_KRB5_EDATA_NTSTATUS_unknown1(tvb, offset, pinfo, tree, di, drep);\r\noffset = misc_dissect_element_KRB5_EDATA_NTSTATUS_unknown2(tvb, offset, pinfo, tree, di, drep);\r\nproto_item_set_len(item, offset-old_offset);\r\nif (di->call_data->flags & DCERPC_IS_NDR64) {\r\nALIGN_TO_4_BYTES;\r\n}\r\nreturn offset;\r\n}\r\nint\r\nmisc_dissect_enum_winreg_Type(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_, int hf_index _U_, guint32 *param _U_)\r\n{\r\nguint32 parameter=0;\r\nif (param) {\r\nparameter = *param;\r\n}\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep, hf_index, &parameter);\r\nif (param) {\r\n*param = parameter;\r\n}\r\nreturn offset;\r\n}\r\nvoid proto_register_dcerpc_misc(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_misc_GUID_clock_seq,\r\n{ "Clock Seq", "misc.GUID.clock_seq", FT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_misc_GUID_node,\r\n{ "Node", "misc.GUID.node", FT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_misc_GUID_time_hi_and_version,\r\n{ "Time Hi And Version", "misc.GUID.time_hi_and_version", FT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_misc_GUID_time_low,\r\n{ "Time Low", "misc.GUID.time_low", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_misc_GUID_time_mid,\r\n{ "Time Mid", "misc.GUID.time_mid", FT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_misc_KRB5_EDATA_NTSTATUS_ntstatus,\r\n{ "Ntstatus", "misc.KRB5_EDATA_NTSTATUS.ntstatus", FT_UINT32, BASE_DEC, VALS(NT_errors), 0, NULL, HFILL }},\r\n{ &hf_misc_KRB5_EDATA_NTSTATUS_unknown1,\r\n{ "Unknown1", "misc.KRB5_EDATA_NTSTATUS.unknown1", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_misc_KRB5_EDATA_NTSTATUS_unknown2,\r\n{ "Unknown2", "misc.KRB5_EDATA_NTSTATUS.unknown2", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_misc_ndr_syntax_id_if_version,\r\n{ "If Version", "misc.ndr_syntax_id.if_version", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_misc_ndr_syntax_id_uuid,\r\n{ "Uuid", "misc.ndr_syntax_id.uuid", FT_GUID, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_misc_opnum,\r\n{ "Operation", "misc.opnum", FT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_misc_policy_handle_handle_type,\r\n{ "Handle Type", "misc.policy_handle.handle_type", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_misc_policy_handle_uuid,\r\n{ "Uuid", "misc.policy_handle.uuid", FT_GUID, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_dcerpc_misc,\r\n&ett_misc_GUID,\r\n&ett_misc_ndr_syntax_id,\r\n&ett_misc_policy_handle,\r\n&ett_misc_KRB5_EDATA_NTSTATUS,\r\n};\r\nproto_dcerpc_misc = proto_register_protocol("MISC (pidl)", "MISC", "misc");\r\nproto_register_field_array(proto_dcerpc_misc, hf, array_length (hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid proto_reg_handoff_dcerpc_misc(void)\r\n{\r\ndcerpc_init_uuid(proto_dcerpc_misc, ett_dcerpc_misc,\r\n&uuid_dcerpc_misc, ver_dcerpc_misc,\r\nmisc_dissectors, hf_misc_opnum);\r\n}
