static int\r\nmdssvc_dissect_element_blob_spotlight_blob(tvbuff_t *tvb, int offset, packet_info *pinfo, proto_tree *tree, dcerpc_info* di, guint8 *drep _U_)\r\n{\r\ntvbuff_t *spotlight_tvb;\r\ndissector_handle_t spotlight_handle;\r\nif (di->conformant_run) {\r\nreturn offset;\r\n}\r\nspotlight_handle = find_dissector("afp_spotlight");\r\nif (spotlight_handle)\r\n{\r\nspotlight_tvb = tvb_new_subset_remaining(tvb, offset + 16);\r\nreturn (offset + 16 + call_dissector(spotlight_handle, spotlight_tvb, pinfo, tree));\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_blob_length(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_blob_length, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_blob_size(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_blob_size, 0);\r\nreturn offset;\r\n}\r\nint\r\nmdssvc_dissect_struct_blob(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *parent_tree _U_, dcerpc_info* di _U_, guint8 *drep _U_, int hf_index _U_, guint32 param _U_)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset;\r\nALIGN_TO_5_BYTES;\r\nold_offset = offset;\r\nif (parent_tree) {\r\nitem = proto_tree_add_item(parent_tree, hf_index, tvb, offset, -1, ENC_NA);\r\ntree = proto_item_add_subtree(item, ett_mdssvc_mdssvc_blob);\r\n}\r\noffset = mdssvc_dissect_element_blob_length(tvb, offset, pinfo, tree, di, drep);\r\noffset = mdssvc_dissect_element_blob_size(tvb, offset, pinfo, tree, di, drep);\r\noffset = mdssvc_dissect_element_blob_spotlight_blob(tvb, offset, pinfo, tree, di, drep);\r\nproto_item_set_len(item, offset-old_offset);\r\nif (di->call_data->flags & DCERPC_IS_NDR64) {\r\nALIGN_TO_5_BYTES;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_open_device_id(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_toplevel_pointer(tvb, offset, pinfo, tree, di, drep, mdssvc_dissect_element_open_device_id_, NDR_POINTER_REF, "Pointer to Device Id (uint32)",hf_mdssvc_mdssvc_open_device_id);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_open_device_id_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_open_device_id, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_open_unkn2(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_toplevel_pointer(tvb, offset, pinfo, tree, di, drep, mdssvc_dissect_element_open_unkn2_, NDR_POINTER_REF, "Pointer to Unkn2 (uint32)",hf_mdssvc_mdssvc_open_unkn2);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_open_unkn2_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_open_unkn2, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_open_unkn3(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_toplevel_pointer(tvb, offset, pinfo, tree, di, drep, mdssvc_dissect_element_open_unkn3_, NDR_POINTER_REF, "Pointer to Unkn3 (uint32)",hf_mdssvc_mdssvc_open_unkn3);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_open_unkn3_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_open_unkn3, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_open_share_mount_path(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nchar *data;\r\noffset = dissect_ndr_cvstring(tvb, offset, pinfo, tree, di, drep, sizeof(guint8), hf_mdssvc_mdssvc_open_share_mount_path, FALSE, &data);\r\nproto_item_append_text(tree, ": %s", data);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_open_share_name(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nchar *data;\r\noffset = dissect_ndr_cvstring(tvb, offset, pinfo, tree, di, drep, sizeof(guint8), hf_mdssvc_mdssvc_open_share_name, FALSE, &data);\r\nproto_item_append_text(tree, ": %s", data);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_open_share_path(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nchar *data;\r\noffset = dissect_ndr_cvstring(tvb, offset, pinfo, tree, di, drep, sizeof(guint8), hf_mdssvc_mdssvc_open_share_path, FALSE, &data);\r\nproto_item_append_text(tree, ": %s", data);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_open_share_handle(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_toplevel_pointer(tvb, offset, pinfo, tree, di, drep, mdssvc_dissect_element_open_share_handle_, NDR_POINTER_REF, "Pointer to Share Handle (policy_handle)",hf_mdssvc_mdssvc_open_share_handle);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_open_share_handle_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_policy_hnd(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_open_share_handle, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_open_response(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\ndi->dcerpc_procedure_name="open";\r\noffset = mdssvc_dissect_element_open_device_id(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_open_unkn2(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_open_unkn3(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_open_share_path(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_open_share_handle(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_open_request(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\ndi->dcerpc_procedure_name="open";\r\noffset = mdssvc_dissect_element_open_device_id(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_open_unkn2(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_open_unkn3(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_open_share_mount_path(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_open_share_name(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_unknown1_share_handle(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_policy_hnd(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_unknown1_share_handle, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_unknown1_unkn1(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_unknown1_unkn1, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_unknown1_device_id(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_unknown1_device_id, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_unknown1_unkn3(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_unknown1_unkn3, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_unknown1_unkn4(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_unknown1_unkn4, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_unknown1_unkn5(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_unknown1_unkn5, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_unknown1_unkn6(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_unknown1_unkn6, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_unknown1_status(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_toplevel_pointer(tvb, offset, pinfo, tree, di, drep, mdssvc_dissect_element_unknown1_status_, NDR_POINTER_REF, "Pointer to Status (uint32)",hf_mdssvc_mdssvc_unknown1_status);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_unknown1_status_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_unknown1_status, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_unknown1_flags(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_toplevel_pointer(tvb, offset, pinfo, tree, di, drep, mdssvc_dissect_element_unknown1_flags_, NDR_POINTER_REF, "Pointer to Flags (uint32)",hf_mdssvc_mdssvc_unknown1_flags);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_unknown1_flags_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_unknown1_flags, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_unknown1_unkn7(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_toplevel_pointer(tvb, offset, pinfo, tree, di, drep, mdssvc_dissect_element_unknown1_unkn7_, NDR_POINTER_REF, "Pointer to Unkn7 (uint32)",hf_mdssvc_mdssvc_unknown1_unkn7);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_unknown1_unkn7_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_unknown1_unkn7, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_unknown1_response(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\ndi->dcerpc_procedure_name="unknown1";\r\noffset = mdssvc_dissect_element_unknown1_status(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_unknown1_flags(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_unknown1_unkn7(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_unknown1_request(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\ndi->dcerpc_procedure_name="unknown1";\r\noffset = mdssvc_dissect_element_unknown1_share_handle(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_unknown1_unkn1(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_unknown1_device_id(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_unknown1_unkn3(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_unknown1_unkn4(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_unknown1_unkn5(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_unknown1_unkn6(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_cmd_share_handle(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_policy_hnd(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_cmd_share_handle, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_cmd_unkn1(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_cmd_unkn1, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_cmd_device_id(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_cmd_device_id, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_cmd_unkn3(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_cmd_unkn3, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_cmd_unkn4(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_cmd_unkn4, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_cmd_flags(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_cmd_flags, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_cmd_request_blob(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = mdssvc_dissect_struct_blob(tvb,offset,pinfo,tree,di,drep,hf_mdssvc_mdssvc_cmd_request_blob,0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_cmd_unkn5(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_cmd_unkn5, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_cmd_max_fragment_size1(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_cmd_max_fragment_size1, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_cmd_unkn6(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_cmd_unkn6, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_cmd_max_fragment_size2(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_cmd_max_fragment_size2, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_cmd_unkn7(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_cmd_unkn7, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_cmd_unkn8(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_cmd_unkn8, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_cmd_status(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_toplevel_pointer(tvb, offset, pinfo, tree, di, drep, mdssvc_dissect_element_cmd_status_, NDR_POINTER_REF, "Pointer to Status (uint32)",hf_mdssvc_mdssvc_cmd_status);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_cmd_status_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_cmd_status, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_cmd_response_blob(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_toplevel_pointer(tvb, offset, pinfo, tree, di, drep, mdssvc_dissect_element_cmd_response_blob_, NDR_POINTER_REF, "Pointer to Response Blob (mdssvc_blob)",hf_mdssvc_mdssvc_cmd_response_blob);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_cmd_response_blob_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = mdssvc_dissect_struct_blob(tvb,offset,pinfo,tree,di,drep,hf_mdssvc_mdssvc_cmd_response_blob,0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_cmd_unkn9(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_toplevel_pointer(tvb, offset, pinfo, tree, di, drep, mdssvc_dissect_element_cmd_unkn9_, NDR_POINTER_REF, "Pointer to Unkn9 (uint32)",hf_mdssvc_mdssvc_cmd_unkn9);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_element_cmd_unkn9_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_mdssvc_mdssvc_cmd_unkn9, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_cmd_response(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\ndi->dcerpc_procedure_name="cmd";\r\noffset = mdssvc_dissect_element_cmd_status(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_cmd_response_blob(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_cmd_unkn9(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nmdssvc_dissect_cmd_request(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\ndi->dcerpc_procedure_name="cmd";\r\noffset = mdssvc_dissect_element_cmd_share_handle(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_cmd_unkn1(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_cmd_device_id(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_cmd_unkn3(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_cmd_unkn4(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_cmd_flags(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_cmd_request_blob(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_cmd_unkn5(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_cmd_max_fragment_size1(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_cmd_unkn6(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_cmd_max_fragment_size2(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_cmd_unkn7(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = mdssvc_dissect_element_cmd_unkn8(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nreturn offset;\r\n}\r\nvoid proto_register_dcerpc_mdssvc(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_mdssvc_mdssvc_blob_length,\r\n{ "Length", "mdssvc.mdssvc_blob.length", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_blob_size,\r\n{ "Size", "mdssvc.mdssvc_blob.size", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_blob_spotlight_blob,\r\n{ "Spotlight Blob", "mdssvc.mdssvc_blob.spotlight_blob", FT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_cmd_device_id,\r\n{ "Device Id", "mdssvc.mdssvc_cmd.device_id", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_cmd_flags,\r\n{ "Flags", "mdssvc.mdssvc_cmd.flags", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_cmd_max_fragment_size1,\r\n{ "Max Fragment Size1", "mdssvc.mdssvc_cmd.max_fragment_size1", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_cmd_max_fragment_size2,\r\n{ "Max Fragment Size2", "mdssvc.mdssvc_cmd.max_fragment_size2", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_cmd_request_blob,\r\n{ "Request Blob", "mdssvc.mdssvc_cmd.request_blob", FT_NONE, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_cmd_response_blob,\r\n{ "Response Blob", "mdssvc.mdssvc_cmd.response_blob", FT_NONE, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_cmd_share_handle,\r\n{ "Share Handle", "mdssvc.mdssvc_cmd.share_handle", FT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_cmd_status,\r\n{ "Status", "mdssvc.mdssvc_cmd.status", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_cmd_unkn1,\r\n{ "Unkn1", "mdssvc.mdssvc_cmd.unkn1", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_cmd_unkn3,\r\n{ "Unkn3", "mdssvc.mdssvc_cmd.unkn3", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_cmd_unkn4,\r\n{ "Unkn4", "mdssvc.mdssvc_cmd.unkn4", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_cmd_unkn5,\r\n{ "Unkn5", "mdssvc.mdssvc_cmd.unkn5", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_cmd_unkn6,\r\n{ "Unkn6", "mdssvc.mdssvc_cmd.unkn6", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_cmd_unkn7,\r\n{ "Unkn7", "mdssvc.mdssvc_cmd.unkn7", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_cmd_unkn8,\r\n{ "Unkn8", "mdssvc.mdssvc_cmd.unkn8", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_cmd_unkn9,\r\n{ "Unkn9", "mdssvc.mdssvc_cmd.unkn9", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_open_device_id,\r\n{ "Device Id", "mdssvc.mdssvc_open.device_id", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_open_share_handle,\r\n{ "Share Handle", "mdssvc.mdssvc_open.share_handle", FT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_open_share_mount_path,\r\n{ "Share Mount Path", "mdssvc.mdssvc_open.share_mount_path", FT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_open_share_name,\r\n{ "Share Name", "mdssvc.mdssvc_open.share_name", FT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_open_share_path,\r\n{ "Share Path", "mdssvc.mdssvc_open.share_path", FT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_open_unkn2,\r\n{ "Unkn2", "mdssvc.mdssvc_open.unkn2", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_open_unkn3,\r\n{ "Unkn3", "mdssvc.mdssvc_open.unkn3", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_unknown1_device_id,\r\n{ "Device Id", "mdssvc.mdssvc_unknown1.device_id", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_unknown1_flags,\r\n{ "Flags", "mdssvc.mdssvc_unknown1.flags", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_unknown1_share_handle,\r\n{ "Share Handle", "mdssvc.mdssvc_unknown1.share_handle", FT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_unknown1_status,\r\n{ "Status", "mdssvc.mdssvc_unknown1.status", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_unknown1_unkn1,\r\n{ "Unkn1", "mdssvc.mdssvc_unknown1.unkn1", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_unknown1_unkn3,\r\n{ "Unkn3", "mdssvc.mdssvc_unknown1.unkn3", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_unknown1_unkn4,\r\n{ "Unkn4", "mdssvc.mdssvc_unknown1.unkn4", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_unknown1_unkn5,\r\n{ "Unkn5", "mdssvc.mdssvc_unknown1.unkn5", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_unknown1_unkn6,\r\n{ "Unkn6", "mdssvc.mdssvc_unknown1.unkn6", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_mdssvc_unknown1_unkn7,\r\n{ "Unkn7", "mdssvc.mdssvc_unknown1.unkn7", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_mdssvc_opnum,\r\n{ "Operation", "mdssvc.opnum", FT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_dcerpc_mdssvc,\r\n&ett_mdssvc_mdssvc_blob,\r\n};\r\nproto_dcerpc_mdssvc = proto_register_protocol("Spotlight metadata search service", "MDSSVC", "mdssvc");\r\nproto_register_field_array(proto_dcerpc_mdssvc, hf, array_length (hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid proto_reg_handoff_dcerpc_mdssvc(void)\r\n{\r\ndcerpc_init_uuid(proto_dcerpc_mdssvc, ett_dcerpc_mdssvc,\r\n&uuid_dcerpc_mdssvc, ver_dcerpc_mdssvc,\r\nmdssvc_dissectors, hf_mdssvc_opnum);\r\n}
