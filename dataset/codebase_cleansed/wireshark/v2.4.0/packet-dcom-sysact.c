static int\r\ndissect_TypeSzCommPrivHdr(tvbuff_t *tvb, gint offset, packet_info *pinfo,\r\nproto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nproto_item *sub_item;\r\nproto_tree *sub_tree;\r\nguint8 drep_tmp;\r\nguint8 endian = 0x10;\r\ngint old_offset;\r\nsub_item = proto_tree_add_item(tree, hf_typeszch, tvb, offset, 0, ENC_NA);\r\nsub_tree = proto_item_add_subtree(sub_item, ett_typeszcommhdr);\r\nold_offset = offset;\r\noffset = dissect_dcom_BYTE(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_typesz_ver, NULL);\r\noffset = dissect_dcom_BYTE(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_typesz_endianness, &endian);\r\nif (endian == 0x10)\r\n*drep = DREP_LITTLE_ENDIAN;\r\nelse\r\n*drep &= ~DREP_LITTLE_ENDIAN;\r\ndrep_tmp = DREP_LITTLE_ENDIAN;\r\noffset = dissect_dcom_WORD(tvb, offset, pinfo, sub_tree, di, &drep_tmp,\r\nhf_typesz_commhdrlen, NULL);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, &drep_tmp,\r\nhf_typesz_filler, NULL);\r\nproto_item_set_len(sub_item, offset - old_offset);\r\nold_offset = offset;\r\nsub_item = proto_tree_add_item(tree, hf_typeszph, tvb, offset, 0, ENC_NA);\r\nsub_tree = proto_item_add_subtree(sub_item, ett_typeszprivhdr);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_typesz_buflen, NULL);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_typesz_filler, NULL);\r\nproto_item_set_len(sub_item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_Property_Guid(tvbuff_t *tvb, gint offset, packet_info *pinfo,\r\nproto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nproperty_guids_t *pg;\r\npg = (property_guids_t*)di->private_data;\r\nif (pg->id_idx < MAX_ACTPROP_LIMIT) {\r\noffset = dissect_dcom_UUID(tvb, offset, pinfo, tree, di, drep,\r\nhf_sysact_actpropclsid, &pg->guid[pg->id_idx++]);\r\n}\r\nelse {\r\ntvb_ensure_bytes_exist(tvb, offset, 16);\r\noffset += 16;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_ActivationPropertiesCustomerHdr_PropertyGuids(tvbuff_t *tvb, gint offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\noffset = dissect_ndr_ucarray(tvb, offset, pinfo, tree, di, drep, dissect_dcom_Property_Guid);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_Property_Size(tvbuff_t *tvb, gint offset, packet_info *pinfo,\r\nproto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nproperty_guids_t *pg;\r\npg = (property_guids_t*)di->private_data;\r\nif (pg->size_idx < MAX_ACTPROP_LIMIT) {\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, tree, di, drep,\r\nhf_sysact_actpropsize, &pg->size[pg->size_idx++]);\r\n}\r\nelse {\r\ntvb_ensure_bytes_exist(tvb, offset, 4);\r\noffset += 4;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_ActivationPropertiesCustomerHdr_PropertySizes(tvbuff_t *tvb, gint offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\noffset = dissect_ndr_ucarray(tvb, offset, pinfo, tree, di, drep, dissect_dcom_Property_Size);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_ActivationPropertiesCustomerHdr(tvbuff_t *tvb, gint offset, packet_info *pinfo,\r\nproto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 u32TotalSize;\r\nguint32 u32CustomHdrSize;\r\nguint32 u32ActPropNumber;\r\ngint old_offset;\r\nproto_item *sub_item;\r\nproto_tree *sub_tree;\r\nsub_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_commonheader, &sub_item, "CustomHeader");\r\nold_offset = offset;\r\noffset = dissect_TypeSzCommPrivHdr(tvb, offset, pinfo, sub_tree, di, drep);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_totalsize, &u32TotalSize);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_customhdrsize, &u32CustomHdrSize);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_res, NULL);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_dstctx, NULL);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_actpropnumber, &u32ActPropNumber);\r\noffset = dissect_dcom_UUID(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_actpropclsinfoid, NULL);\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, sub_tree, di, drep,\r\ndissect_dcom_ActivationPropertiesCustomerHdr_PropertyGuids, NDR_POINTER_UNIQUE,\r\n"ClsIdPtr",hf_sysact_actpropclsid);\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, sub_tree, di, drep,\r\ndissect_dcom_ActivationPropertiesCustomerHdr_PropertySizes, NDR_POINTER_UNIQUE,\r\n"ClsSizesPtr",hf_sysact_actpropclsid);\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, sub_tree, di, drep,\r\nNULL, NDR_POINTER_UNIQUE, "OpaqueDataPtr: Pointer To NULL", 0);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nproto_item_set_len(sub_item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_ActivationProperty(tvbuff_t *tvb, gint offset, packet_info *pinfo,\r\nproto_tree *tree, dcerpc_info *di, guint8 *drep, e_guid_t *clsid, gint size)\r\n{\r\ndcom_dissect_fn_t routine = NULL;\r\nroutine = dcom_get_rountine_by_uuid(clsid);\r\nif (routine){\r\noffset = routine(tvb, offset, pinfo, tree, di, drep, size);\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_ActivationPropertiesBody(tvbuff_t *tvb, gint offset, packet_info *pinfo,\r\nproto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\ngint old_offset;\r\nproto_item *sub_item;\r\nproto_tree *sub_tree;\r\nproperty_guids_t *pg;\r\nguint32 i;\r\nguint32 min_idx;\r\npg = (property_guids_t*)di->private_data;\r\nif (pg->id_idx == pg->size_idx) {\r\nmin_idx = pg->id_idx;\r\n}\r\nelse {\r\nmin_idx = MIN(pg->id_idx, pg->size_idx);\r\n}\r\nsub_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_properties, &sub_item, "Properties");\r\nold_offset = offset;\r\nfor (i = 0; i < min_idx; i++) {\r\noffset = dissect_dcom_ActivationProperty(tvb, offset, pinfo, sub_tree, di, drep,\r\n&pg->guid[i], pg->size[i]);\r\n}\r\nproto_item_set_len(sub_item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_ActivationProperties(tvbuff_t *tvb, gint offset, packet_info *pinfo,\r\nproto_tree *tree, dcerpc_info *di, guint8 *drep, gint size _U_)\r\n{\r\nproto_item *sub_item;\r\nproto_tree *sub_tree;\r\nproperty_guids_t *old_pg = NULL;\r\nguint32 u32TotalSize;\r\nguint32 u32Res;\r\nsub_item = proto_tree_add_item(tree, hf_sysact_actproperties, tvb, offset, 0, ENC_NA);\r\nsub_tree = proto_item_add_subtree(sub_item, ett_actproperties);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_totalsize, &u32TotalSize);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_res, &u32Res);\r\nold_pg = (property_guids_t*)di->private_data;\r\ndi->private_data = wmem_new0(wmem_packet_scope(), property_guids_t);\r\noffset = dissect_dcom_ActivationPropertiesCustomerHdr(tvb, offset, pinfo, sub_tree, di, drep);\r\noffset = dissect_dcom_ActivationPropertiesBody(tvb, offset, pinfo, sub_tree, di, drep);\r\ndi->private_data = old_pg;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_ContextMarshaler(tvbuff_t *tvb, gint offset, packet_info *pinfo,\r\nproto_tree *tree, dcerpc_info *di, guint8 *drep, gint size _U_)\r\n{\r\nproto_item *sub_item;\r\nproto_tree *sub_tree;\r\ngint old_offset;\r\nguint32 u32Count;\r\nold_offset = offset;\r\nsub_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_dcom_context, &sub_item, "Context");\r\noffset = dissect_dcom_COMVERSION(tvb, offset, pinfo, sub_tree, di, drep,\r\nNULL, NULL);\r\noffset = dissect_dcom_UUID(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_ctx_id, NULL);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_ctx_flags, NULL);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_ctx_res, NULL);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_ctx_numextents, NULL);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_ctx_extentscnt, NULL);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_ctx_mashflags, NULL);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_ctx_count, &u32Count);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_ctx_frozen, NULL);\r\nif (u32Count) {\r\n}\r\nproto_item_set_len(sub_item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_SpecialSystemProperties(tvbuff_t *tvb, gint offset, packet_info *pinfo,\r\nproto_tree *tree, dcerpc_info *di, guint8 *drep, gint size)\r\n{\r\nproto_tree *sub_tree, *tr;\r\ngint old_offset, len, i;\r\nold_offset = offset;\r\nif (size <= 0) {\r\nsize = -1;\r\n}\r\nsub_tree = proto_tree_add_subtree(tree, tvb, offset, size, ett_dcom_spclsysprop, NULL, "SpecialSystemProperties");\r\noffset = dissect_TypeSzCommPrivHdr(tvb, offset, pinfo, sub_tree, di, drep);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_spsysprop_sid, NULL);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_spsysprop_remotethissid, NULL);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_spsysprop_cltimpersonating, NULL);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_spsysprop_partitionid, NULL);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_spsysprop_defauthlvl, NULL);\r\noffset = dissect_dcom_UUID(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_spsysprop_partition, NULL);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_spsysprop_procrqstflgs, NULL);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_spsysprop_origclsctx, NULL);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_spsysprop_flags, NULL);\r\ntr = proto_tree_add_subtree(sub_tree, tvb, offset, sizeof(guint32)*8,\r\nett_dcom_reserved, NULL, "Reserved: 8 DWORDs");\r\nfor (i = 0; i < 8; i++) {\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, tr, di, drep,\r\nhf_sysact_res, NULL);\r\n}\r\nlen = offset - old_offset;\r\nif (size < len) {\r\nsize = len;\r\n}\r\nelse if (size > len) {\r\nproto_tree_add_item(sub_tree, hf_sysact_unused_buffer, tvb, offset, size - len, ENC_NA);\r\n}\r\noffset = old_offset + size;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_InterfaceId(tvbuff_t *tvb, gint offset, packet_info *pinfo,\r\nproto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\noffset = dissect_dcom_UUID(tvb, offset, pinfo, tree, di, drep,\r\nhf_sysact_instninfo_iid, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_InstantiationInfoIids(tvbuff_t *tvb, gint offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\noffset = dissect_ndr_ucarray(tvb, offset, pinfo, tree, di, drep,\r\ndissect_dcom_InterfaceId);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_InstantiationInfo(tvbuff_t *tvb, gint offset, packet_info *pinfo,\r\nproto_tree *tree, dcerpc_info *di, guint8 *drep, gint size)\r\n{\r\nproto_tree *sub_tree;\r\ngint old_offset, len;\r\nold_offset = offset;\r\nif (size <= 0) {\r\nsize = -1;\r\n}\r\nsub_tree = proto_tree_add_subtree(tree, tvb, offset, size, ett_dcom_instantianinfo, NULL, "InstantiationInfo");\r\noffset = dissect_TypeSzCommPrivHdr(tvb, offset, pinfo, sub_tree, di, drep);\r\noffset = dissect_dcom_UUID(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_instninfo_clsid, NULL);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_instninfo_clsctx, NULL);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_instninfo_actflags, NULL);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_instninfo_issurrogate, NULL);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_instninfo_iidcount, NULL);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_instninfo_instflags, NULL);\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, sub_tree, di, drep,\r\ndissect_InstantiationInfoIids, NDR_POINTER_UNIQUE,\r\n"InterfaceIdsPtr", -1);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_instninfo_entiresize, NULL);\r\noffset = dissect_dcom_COMVERSION(tvb, offset, pinfo, sub_tree, di, drep,\r\nNULL, NULL);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nlen = offset - old_offset;\r\nif (size < len) {\r\nsize = len;\r\n}\r\nelse if (size > len) {\r\nproto_tree_add_item(sub_tree, hf_sysact_unused_buffer, tvb, offset, size - len, ENC_NA);\r\n}\r\noffset = old_offset + size;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_ActCtxInfo_PropCtx(tvbuff_t *tvb _U_, gint offset,\r\npacket_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info *di _U_, guint8 *drep _U_)\r\n{\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_ActCtxInfo_CltCtx(tvbuff_t *tvb, gint offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run) {\r\nreturn offset;\r\n}\r\noffset = dissect_dcom_MInterfacePointer(tvb, offset, pinfo, tree, di, drep,\r\nhf_sysact_context, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_ActivationContextInfo(tvbuff_t *tvb, gint offset, packet_info *pinfo,\r\nproto_tree *tree, dcerpc_info *di, guint8 *drep, gint size)\r\n{\r\nproto_tree *sub_tree;\r\ngint old_offset, len;\r\nold_offset = offset;\r\nif (size <= 0) {\r\nsize = -1;\r\n}\r\nsub_tree = proto_tree_add_subtree(tree, tvb, offset, size, ett_dcom_actctxinfo, NULL, "ActivationContextInfo");\r\noffset = dissect_TypeSzCommPrivHdr(tvb, offset, pinfo, sub_tree, di, drep);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_actctxinfo_cltok, NULL);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_res, NULL);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_res, NULL);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_res, NULL);\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, sub_tree, di, drep,\r\ndissect_ActCtxInfo_CltCtx, NDR_POINTER_UNIQUE,\r\n"ClientPtr", -1);\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, sub_tree, di, drep,\r\ndissect_ActCtxInfo_PropCtx, NDR_POINTER_UNIQUE,\r\n"PrototypePtr", -1);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nlen = offset - old_offset;\r\nif (size < len) {\r\nsize = len;\r\n}\r\nelse if (size > len) {\r\nproto_tree_add_item(sub_tree, hf_sysact_unused_buffer, tvb, offset, size - len, ENC_NA);\r\n}\r\noffset = old_offset + size;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_COSERVERINFO(tvbuff_t *tvb, gint offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep, int hfindex)\r\n{\r\nproto_item *sub_item;\r\nproto_tree *sub_tree;\r\ngint old_offset;\r\nif (di->conformant_run) {\r\nreturn offset;\r\n}\r\nsub_item = proto_tree_add_item(tree, hfindex, tvb, offset, 0, ENC_NA);\r\nsub_tree = proto_item_add_subtree(sub_item, ett_dcom_securityinfo);\r\nold_offset = offset;\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_si_ci_res, NULL);\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, sub_tree, di, drep,\r\ndissect_ndr_wchar_cvstring, NDR_POINTER_UNIQUE, "Name(wstring)",\r\nhf_sysact_si_ci_string);\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, sub_tree, di, drep,\r\nNULL, NDR_POINTER_UNIQUE, "AuthInfoPtr", -1);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_si_ci_res, NULL);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nproto_item_set_len(sub_item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_SI_ServerInfo(tvbuff_t *tvb, gint offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\noffset = dissect_dcom_COSERVERINFO(tvb, offset, pinfo, tree, di, drep,\r\nhf_sysact_si_serverinfo);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_SecurtiyInfo(tvbuff_t *tvb, gint offset, packet_info *pinfo,\r\nproto_tree *tree, dcerpc_info *di, guint8 *drep, gint size)\r\n{\r\nproto_tree *sub_tree;\r\ngint old_offset, len;\r\nold_offset = offset;\r\nif (size <= 0) {\r\nsize = -1;\r\n}\r\nsub_tree = proto_tree_add_subtree(tree, tvb, offset, size, ett_dcom_securityinfo, NULL, "SecurityInfo");\r\noffset = dissect_TypeSzCommPrivHdr(tvb, offset, pinfo, sub_tree, di ,drep);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_si_authflalgs, NULL);\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, sub_tree, di, drep,\r\ndissect_dcom_SI_ServerInfo, NDR_POINTER_UNIQUE, "ServerInfoPtr", -1);\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, sub_tree, di, drep,\r\nNULL, NDR_POINTER_UNIQUE, "ReservedPtr", -1);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nlen = offset - old_offset;\r\nif (size < len) {\r\nsize = len;\r\n}\r\nelse if (size > len) {\r\nproto_tree_add_item(sub_tree, hf_sysact_unused_buffer, tvb, offset, size - len, ENC_NA);\r\n}\r\noffset = old_offset + size;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_LocationInfo(tvbuff_t *tvb, gint offset, packet_info *pinfo,\r\nproto_tree *tree, dcerpc_info *di, guint8 *drep, gint size)\r\n{\r\nproto_tree *sub_tree;\r\ngint old_offset, len;\r\nold_offset = offset;\r\nif (size <= 0) {\r\nsize = -1;\r\n}\r\nsub_tree = proto_tree_add_subtree(tree, tvb, offset, size, ett_dcom_locationinfo, NULL, "LocationInfo");\r\noffset = dissect_TypeSzCommPrivHdr(tvb, offset, pinfo, sub_tree, di, drep);\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, sub_tree, di, drep,\r\ndissect_ndr_wchar_cvstring, NDR_POINTER_UNIQUE, "MachineNamePtr",\r\nhf_sysact_li_string);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_li_procid, NULL);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_li_apartid, NULL);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_li_ctxid, NULL);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nlen = offset - old_offset;\r\nif (size < len) {\r\nsize = len;\r\n}\r\nelse if (size > len) {\r\nproto_tree_add_item(sub_tree, hf_sysact_unused_buffer, tvb, offset, size - len, ENC_NA);\r\n}\r\noffset = old_offset + size;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_ProtoSeq(tvbuff_t *tvb, gint offset, packet_info *pinfo,\r\nproto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\noffset = dissect_dcom_WORD(tvb, offset, pinfo, tree, di, drep,\r\nhf_sysact_sri_protseq, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_ProtoSeqArray(tvbuff_t *tvb, gint offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\noffset = dissect_ndr_ucarray(tvb, offset, pinfo, tree, di, drep,\r\ndissect_dcom_ProtoSeq);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_customREMOTE_REQUEST_SCM_INFO(tvbuff_t *tvb, gint offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nproto_item *sub_item;\r\nproto_tree *sub_tree;\r\ngint old_offset;\r\nif (di->conformant_run) {\r\nreturn offset;\r\n}\r\nsub_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_dcom_rmtrqst, &sub_item, "RemoteRequest");\r\nold_offset = offset;\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_sri_cltimplvl, NULL);\r\noffset = dissect_dcom_WORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_sri_protseqnum, NULL);\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, sub_tree, di, drep,\r\ndissect_dcom_ProtoSeqArray, NDR_POINTER_UNIQUE, "ProtocolSeqsArrayPtr", -1);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nproto_item_set_len(sub_item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_ScmRqstInfo(tvbuff_t *tvb, gint offset, packet_info *pinfo,\r\nproto_tree *tree, dcerpc_info *di, guint8 *drep, gint size)\r\n{\r\nproto_tree *sub_tree;\r\ngint old_offset, len;\r\nold_offset = offset;\r\nif (size <= 0) {\r\nsize = -1;\r\n}\r\nsub_tree = proto_tree_add_subtree(tree, tvb, offset, size, ett_dcom_scmrqstinfo, NULL, "ScmRequestInfo");\r\noffset = dissect_TypeSzCommPrivHdr(tvb, offset, pinfo, sub_tree, di, drep);\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, sub_tree, di, drep,\r\nNULL, NDR_POINTER_UNIQUE, "Ptr", -1);\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, sub_tree, di, drep,\r\ndissect_dcom_customREMOTE_REQUEST_SCM_INFO, NDR_POINTER_UNIQUE,\r\n"RemoteRequestPtr", -1);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nlen = offset - old_offset;\r\nif (size < len) {\r\nsize = len;\r\n}\r\nelse if (size > len) {\r\nproto_tree_add_item(sub_tree, hf_sysact_unused_buffer, tvb, offset, size - len, ENC_NA);\r\n}\r\noffset = old_offset + size;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_IfId(tvbuff_t *tvb, gint offset, packet_info *pinfo,\r\nproto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\noffset = dissect_dcom_UUID(tvb, offset, pinfo, tree, di, drep,\r\nhf_sysact_pi_iid, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_IfIds(tvbuff_t *tvb, gint offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\noffset = dissect_ndr_ucarray(tvb, offset, pinfo, tree, di, drep,\r\ndissect_dcom_IfId);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_ReturnVal(tvbuff_t *tvb, gint offset, packet_info *pinfo,\r\nproto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, tree, di, drep,\r\nhf_sysact_pi_retval, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_ReturnVals(tvbuff_t *tvb, gint offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\noffset = dissect_ndr_ucarray(tvb, offset, pinfo, tree, di, drep,\r\ndissect_dcom_ReturnVal);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_OneInterfData(tvbuff_t *tvb, gint offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\noffset = dissect_dcom_MInterfacePointer(tvb, offset, pinfo, tree, di, drep,\r\nhf_sysact_pi_interf, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_OneInterfDataPtr(tvbuff_t *tvb, gint offset, packet_info *pinfo,\r\nproto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_OneInterfData, NDR_POINTER_UNIQUE, "InterfacePtr", -1);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_InterfData(tvbuff_t *tvb, gint offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\noffset = dissect_ndr_ucarray(tvb, offset, pinfo, tree, di, drep,\r\ndissect_dcom_OneInterfDataPtr);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_PropsOutInfo(tvbuff_t *tvb, gint offset, packet_info *pinfo,\r\nproto_tree *tree, dcerpc_info *di, guint8 *drep, gint size)\r\n{\r\nproto_tree *sub_tree;\r\ngint old_offset, len;\r\nold_offset = offset;\r\nif (size <= 0) {\r\nsize = -1;\r\n}\r\nsub_tree = proto_tree_add_subtree(tree, tvb, offset, size, ett_dcom_propsoutput, NULL, "PropertiesOutput");\r\noffset = dissect_TypeSzCommPrivHdr(tvb, offset, pinfo, sub_tree, di, drep);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_pi_ifnum, NULL);\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, sub_tree, di, drep,\r\ndissect_dcom_IfIds, NDR_POINTER_UNIQUE, "InterfaceIdsPtr", -1);\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, sub_tree, di, drep,\r\ndissect_dcom_ReturnVals, NDR_POINTER_UNIQUE, "ReturnValuesPtr", -1);\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, sub_tree, di, drep,\r\ndissect_dcom_InterfData, NDR_POINTER_UNIQUE, "InterfacePtrsPtr", -1);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nlen = offset - old_offset;\r\nif (size < len) {\r\nsize = len;\r\n}\r\nelse if (size > len) {\r\nproto_tree_add_item(sub_tree, hf_sysact_unused_buffer, tvb, offset, size - len, ENC_NA);\r\n}\r\noffset = old_offset + size;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_OxidBindings(tvbuff_t *tvb, gint offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nproto_item *sub_item;\r\nproto_tree *sub_tree;\r\ngint old_offset;\r\nif (di->conformant_run) {\r\nreturn offset;\r\n}\r\nold_offset = offset;\r\nsub_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_dcom_oxidbinding, &sub_item, "OxidBindings");\r\noffset = dissect_dcom_dcerpc_array_size(tvb, offset, pinfo, sub_tree, di, drep, NULL);\r\noffset = dissect_dcom_DUALSTRINGARRAY(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_scmri_binding, NULL);\r\nproto_item_set_len(sub_item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_customREMOTE_REPLY_SCM_INFO(tvbuff_t *tvb, gint offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nproto_item *sub_item;\r\nproto_tree *sub_tree;\r\ngint old_offset;\r\nif (di->conformant_run) {\r\nreturn offset;\r\n}\r\nsub_tree = proto_tree_add_subtree(tree, tvb, offset, 0, ett_dcom_rmtresp, &sub_item, "RemoteReply");\r\nold_offset = offset;\r\noffset = dissect_dcom_ID(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_scmri_oxid, NULL);\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, sub_tree, di, drep,\r\ndissect_dcom_OxidBindings, NDR_POINTER_UNIQUE, "OxidBindingsPtr", -1);\r\noffset = dissect_dcom_UUID(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_scmri_rmtunknid, NULL);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_sysact_scmri_authhint, NULL);\r\noffset = dissect_dcom_COMVERSION(tvb, offset, pinfo, sub_tree, di, drep,\r\nNULL, NULL);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nproto_item_set_len(sub_item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_dcom_ScmReplyInfo(tvbuff_t *tvb, gint offset, packet_info *pinfo,\r\nproto_tree *tree, dcerpc_info *di, guint8 *drep, gint size)\r\n{\r\nproto_tree *sub_tree;\r\ngint old_offset, len;\r\nold_offset = offset;\r\nif (size <= 0) {\r\nsize = -1;\r\n}\r\nsub_tree = proto_tree_add_subtree(tree, tvb, offset, size, ett_dcom_scmrespinfo, NULL, "ScmReplyInfo");\r\noffset = dissect_TypeSzCommPrivHdr(tvb, offset, pinfo, sub_tree, di, drep);\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, sub_tree, di, drep,\r\nNULL, NDR_POINTER_UNIQUE, "Ptr", -1);\r\noffset = dissect_ndr_embedded_pointer(tvb, offset, pinfo, sub_tree, di, drep,\r\ndissect_dcom_customREMOTE_REPLY_SCM_INFO, NDR_POINTER_UNIQUE,\r\n"RemoteRequestPtr", -1);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nlen = offset - old_offset;\r\nif (size < len) {\r\nsize = len;\r\n}\r\nelse if (size > len) {\r\nproto_tree_add_item(sub_tree, hf_sysact_unused_buffer, tvb, offset, size - len, ENC_NA);\r\n}\r\noffset = old_offset + size;\r\nreturn offset;\r\n}\r\nstatic void\r\nsysact_register_routines(void)\r\n{\r\ndcom_register_rountine(dissect_dcom_ActivationProperties, &iid_ActivationPropertiesIn);\r\ndcom_register_rountine(dissect_dcom_ActivationProperties, &iid_ActivationPropertiesOut);\r\ndcom_register_rountine(dissect_dcom_SpecialSystemProperties, &clsid_SpecialSystemProperties);\r\ndcom_register_rountine(dissect_dcom_InstantiationInfo, &clsid_InstantiationInfo);\r\ndcom_register_rountine(dissect_dcom_ActivationContextInfo, &clsid_ActivationContextInfo);\r\ndcom_register_rountine(dissect_dcom_ContextMarshaler, &clsid_ContextMarshaler);\r\ndcom_register_rountine(dissect_dcom_SecurtiyInfo, &clsid_SecurityInfo);\r\ndcom_register_rountine(dissect_dcom_LocationInfo, &clsid_ServerLocationInfo);\r\ndcom_register_rountine(dissect_dcom_ScmRqstInfo, &clsid_ScmRequestInfo);\r\ndcom_register_rountine(dissect_dcom_PropsOutInfo, &clsid_PropsOutInfo);\r\ndcom_register_rountine(dissect_dcom_ScmReplyInfo, &clsid_ScmReplyInfo);\r\nreturn;\r\n}\r\nstatic int\r\ndissect_remsysact_remotecreateinstance_rqst(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nsysact_register_routines();\r\noffset = dissect_dcom_this(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_nospec_data(tvb, offset, pinfo, tree, drep, 4);\r\noffset = dissect_dcom_PMInterfacePointer(tvb, offset, pinfo, tree, di, drep,\r\nhf_sysact_actproperties, NULL );\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_remsysact_remotecreateinstance_resp(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nsysact_register_routines();\r\noffset = dissect_dcom_that(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_PMInterfacePointer(tvb, offset, pinfo, tree, di, drep,\r\nhf_sysact_actproperties, NULL );\r\noffset = dissect_dcom_HRESULT(tvb, offset, pinfo, tree, di, drep,\r\nNULL );\r\nreturn offset;\r\n}\r\nvoid\r\nproto_register_ISystemActivator (void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_opnum,\r\n{ "Operation", "isystemactivator.opnum", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_actproperties,\r\n{ "IActProperties", "isystemactivator.actproperties", FT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n#if 0\r\n{ &hf_sysact_unknown,\r\n{ "IUnknown", "isystemactivator.unknown", FT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n#endif\r\n};\r\nstatic hf_register_info hf_actproperties[] = {\r\n{ &hf_sysact_totalsize,\r\n{ "Totalsize", "isystemactivator.actproperties.size", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_res,\r\n{ "Reserved", "isystemactivator.actproperties.resv", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_customhdrsize,\r\n{ "CustomHeaderSize", "isystemactivator.customhdr.size", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_dstctx,\r\n{ "DestinationContext", "isystemactivator.customhdr.dc", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_actpropnumber,\r\n{ "NumActivationPropertyStructs", "isystemactivator.customhdr.actpropnumber", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_actpropclsinfoid,\r\n{ "ClassInfoClsid", "isystemactivator.customhdr.clsinfoid", FT_GUID, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n#if 0\r\n{ &hf_sysact_actpropclsids,\r\n{ "PropertyGuids", "isystemactivator.customhdr.clsids", FT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n#endif\r\n{ &hf_sysact_actpropclsid,\r\n{ "PropertyStructGuid", "isystemactivator.customhdr.clsid", FT_GUID, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n#if 0\r\n{ &hf_sysact_actpropsizes,\r\n{ "PropertyDataSizes", "isystemactivator.customhdr.datasizes", FT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n#endif\r\n{ &hf_sysact_actpropsize,\r\n{ "PropertyDataSize", "isystemactivator.customhdr.datasize", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_spsysprop_sid,\r\n{ "SessionID", "isystemactivator.properties.spcl.sid", FT_UINT32, BASE_DEC_HEX, NULL, 0x0, "A value that uniquely identifies a logon session on the server", HFILL }},\r\n{ &hf_sysact_spsysprop_remotethissid,\r\n{ "RemoteThisSessionID", "isystemactivator.properties.spcl.remotesid", FT_UINT32, BASE_DEC_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_spsysprop_cltimpersonating,\r\n{ "ClientImpersonating", "isystemactivator.properties.spcl.cltimp", FT_UINT32, BASE_DEC_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_spsysprop_partitionid,\r\n{ "PartitionIDPresent", "isystemactivator.properties.spcl.cltimp", FT_UINT32, BASE_DEC_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_spsysprop_defauthlvl,\r\n{ "DefaultAuthnLevel", "isystemactivator.properties.spcl.defauthlvl", FT_UINT32, BASE_DEC_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_spsysprop_partition,\r\n{ "PartitionGuid", "isystemactivator.properties.spcl.partition", FT_GUID, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_spsysprop_procrqstflgs,\r\n{ "ProcessRequestFlags", "isystemactivator.properties.spcl.procreqstflgs", FT_UINT32, BASE_DEC_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_spsysprop_origclsctx,\r\n{ "OriginalClassContext", "isystemactivator.properties.spcl.origclsctx", FT_UINT32, BASE_DEC_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_spsysprop_flags,\r\n{ "Flags", "isystemactivator.properties.spcl.flags", FT_UINT32, BASE_DEC_HEX, NULL, 0x0, NULL, HFILL }},\r\n#if 0\r\n{ &hf_sysact_spsysprop_procid,\r\n{ "ProcessID", "isystemactivator.properties.spcl.procid", FT_UINT32, BASE_DEC_HEX, NULL, 0x0, NULL, HFILL }},\r\n#endif\r\n#if 0\r\n{ &hf_sysact_spsysprop_hwnd,\r\n{ "hWnd", "isystemactivator.properties.spcl.hwnd", FT_UINT64, BASE_DEC_HEX, NULL, 0x0, NULL, HFILL }},\r\n#endif\r\n{ &hf_sysact_instninfo_clsid,\r\n{ "InstantiatedObjectClsId", "isystemactivator.properties.instninfo.clsid", FT_GUID, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_instninfo_clsctx,\r\n{ "ClassContext", "isystemactivator.properties.instninfo.clsctx", FT_UINT32, BASE_DEC_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_instninfo_actflags,\r\n{ "ActivationFlags", "isystemactivator.properties.instninfo.actflags", FT_UINT32, BASE_DEC_HEX, VALS(instninfo_actflags), 0x0, NULL, HFILL }},\r\n{ &hf_sysact_instninfo_issurrogate,\r\n{ "FlagsSurrogate", "isystemactivator.properties.instninfo.actflags", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_instninfo_iidcount,\r\n{ "InterfaceIdCount", "isystemactivator.properties.instninfo.iidcount", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_instninfo_instflags,\r\n{ "InstantiationFlag", "isystemactivator.properties.instninfo.instflags", FT_UINT32, BASE_DEC_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_instninfo_entiresize,\r\n{ "EntirePropertySize", "isystemactivator.properties.instninfo.entiresize", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_instninfo_iid,\r\n{ "InterfaceIds", "isystemactivator.properties.instninfo.iid", FT_GUID, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_actctxinfo_cltok,\r\n{ "ClientOk", "isystemactivator.properties.actctxinfo.cltok", FT_INT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_context,\r\n{ "ClientContext", "isystemactivator.properties.context", FT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_ctx_id,\r\n{ "ContextID", "isystemactivator.properties.context.id", FT_GUID, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_ctx_flags,\r\n{ "Flags", "isystemactivator.properties.context.flags", FT_UINT32, BASE_HEX, VALS(dcom_context_flag_vals), 0x0, NULL, HFILL }},\r\n{ &hf_sysact_ctx_res,\r\n{ "Reserved", "isystemactivator.properties.context.res", FT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_ctx_numextents,\r\n{ "NumExtents", "isystemactivator.properties.context.numext", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_ctx_extentscnt,\r\n{ "ExtentCount", "isystemactivator.properties.context.extcnt", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_ctx_mashflags,\r\n{ "MarshalFlags", "isystemactivator.properties.context.mashflags", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_ctx_count,\r\n{ "ContextPropertyCount", "isystemactivator.properties.context.cnt", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_ctx_frozen,\r\n{ "Frozen", "isystemactivator.properties.context.frz", FT_UINT32, BASE_HEX, VALS(boolean_flag_vals), 0x0, NULL, HFILL }},\r\n{ &hf_sysact_si_authflalgs,\r\n{ "AuthenticationFlags", "isystemactivator.properties.si.authflags", FT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_si_serverinfo,\r\n{ "ServerInfo", "isystemactivator.properties.si.ci", FT_NONE, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_sysact_si_ci_res,\r\n{ "Reserved", "isystemactivator.properties.si.ci.res", FT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_si_ci_string,\r\n{ "String", "isystemactivator.properties.si.ci.name", FT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_sysact_li_string,\r\n{ "String", "isystemactivator.properties.li.name", FT_STRING, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_sysact_li_procid,\r\n{ "ProcessId", "isystemactivator.properties.li.procid", FT_UINT32, BASE_DEC_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_li_apartid,\r\n{ "ApartmentId", "isystemactivator.properties.li.apartid", FT_UINT32, BASE_DEC_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_li_ctxid,\r\n{ "ContextId", "isystemactivator.properties.li.ctxid", FT_UINT32, BASE_DEC_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_sri_cltimplvl,\r\n{ "ClientImpersonationLevel", "isystemactivator.properties.sri.cltimplvl", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_sri_protseqnum,\r\n{ "NumProtocolSequences", "isystemactivator.properties.sri.protseqnum", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_sri_protseq,\r\n{ "ProtocolSeq", "isystemactivator.properties.sri.protseq", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_pi_ifnum,\r\n{ "NumInterfaces", "isystemactivator.properties.pi.ifnum", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_pi_retval,\r\n{ "ReturnValue", "isystemactivator.properties.retval", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_pi_interf,\r\n{ "Interface", "isystemactivator.properties.interf", FT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_pi_iid,\r\n{ "IID", "isystemactivator.properties.iid", FT_GUID, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_scmri_rmtunknid,\r\n{ "IRemUnknownInterfacePointerId", "isystemactivator.properties.scmresp.rmtunknid", FT_GUID, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_scmri_authhint,\r\n{ "AuthenticationHint", "isystemactivator.properties.scmresp.authhint", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_scmri_binding,\r\n{ "Bindings", "isystemactivator.properties.scmresp.binding", FT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_scmri_oxid,\r\n{ "OXID", "isystemactivator.properties.scmresp.oxid", FT_UINT64, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sysact_unused_buffer,\r\n{ "Unused buffer", "isystemactivator.unused_buffer", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n};\r\nstatic hf_register_info hf_tshdr[] = {\r\n{ &hf_typeszch,\r\n{ "CommonHeader", "isystemactivator.actproperties.ts.hdr", FT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_typeszph,\r\n{ "PrivateHeader", "isystemactivator.actproperties.ts.hdr", FT_NONE, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_typesz_ver,\r\n{ "Version", "isystemactivator.actproperties.ts.ver", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_typesz_endianness,\r\n{ "Endianness", "isystemactivator.actproperties.ts.end", FT_UINT8, BASE_HEX, VALS(ts_endian_vals), 0x0, NULL, HFILL }},\r\n{ &hf_typesz_commhdrlen,\r\n{ "CommonHeaderLength", "isystemactivator.actproperties.ts.chl", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_typesz_filler,\r\n{ "Filler", "isystemactivator.actproperties.ts.fil", FT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_typesz_buflen,\r\n{ "ObjectBufferLength", "isystemactivator.actproperties.ts.buflen", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_isystemactivator,\r\n&ett_actproperties,\r\n&ett_properties,\r\n&ett_commonheader,\r\n&ett_propguids,\r\n&ett_typeszcommhdr,\r\n&ett_typeszprivhdr,\r\n&ett_dcom_spclsysprop,\r\n&ett_dcom_reserved,\r\n&ett_dcom_instantianinfo,\r\n&ett_dcom_actctxinfo,\r\n&ett_dcom_context,\r\n&ett_dcom_securityinfo,\r\n&ett_dcom_locationinfo,\r\n&ett_dcom_scmrqstinfo,\r\n&ett_dcom_rmtrqst,\r\n&ett_dcom_propsoutput,\r\n&ett_dcom_scmrespinfo,\r\n&ett_dcom_rmtresp,\r\n&ett_dcom_oxidbinding,\r\n};\r\nproto_ISystemActivator = proto_register_protocol ("ISystemActivator ISystemActivator Resolver", "ISystemActivator", "isystemactivator");\r\nproto_register_field_array (proto_ISystemActivator, hf, array_length (hf));\r\nproto_register_field_array (proto_ISystemActivator, hf_actproperties, array_length (hf_actproperties));\r\nproto_register_field_array(proto_ISystemActivator, hf_tshdr, array_length(hf_tshdr));\r\nproto_register_subtree_array (ett, array_length (ett));\r\n}\r\nvoid\r\nproto_reg_handoff_ISystemActivator (void)\r\n{\r\ndcerpc_init_uuid (proto_ISystemActivator, ett_isystemactivator, &uuid_ISystemActivator,\r\nver_ISystemActivator, ISystemActivator_dissectors, hf_opnum);\r\n}
