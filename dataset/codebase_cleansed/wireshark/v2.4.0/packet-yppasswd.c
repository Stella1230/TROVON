static int\r\ndissect_yppasswd_call(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nproto_item *lock_item = NULL;\r\nproto_tree *lock_tree = NULL;\r\nint offset = 0;\r\noffset = dissect_rpc_string(tvb, tree, hf_yppasswd_oldpass,\r\noffset, NULL);\r\nlock_item = proto_tree_add_item(tree, hf_yppasswd_newpw, tvb,\r\noffset, -1, ENC_NA);\r\nlock_tree = proto_item_add_subtree(lock_item, ett_yppasswd_newpw);\r\noffset = dissect_rpc_string(tvb, lock_tree,\r\nhf_yppasswd_newpw_name, offset, NULL);\r\noffset = dissect_rpc_string(tvb, lock_tree,\r\nhf_yppasswd_newpw_passwd, offset, NULL);\r\noffset = dissect_rpc_uint32(tvb, lock_tree,\r\nhf_yppasswd_newpw_uid, offset);\r\noffset = dissect_rpc_uint32(tvb, lock_tree,\r\nhf_yppasswd_newpw_gid, offset);\r\noffset = dissect_rpc_string(tvb, lock_tree,\r\nhf_yppasswd_newpw_gecos, offset, NULL);\r\noffset = dissect_rpc_string(tvb, lock_tree,\r\nhf_yppasswd_newpw_dir, offset, NULL);\r\noffset = dissect_rpc_string(tvb, lock_tree,\r\nhf_yppasswd_newpw_shell, offset, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_yppasswd_reply(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nreturn dissect_rpc_uint32(tvb, tree, hf_yppasswd_status, 0);\r\n}\r\nvoid\r\nproto_register_yppasswd(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_yppasswd_procedure_v1, {\r\n"V1 Procedure", "yppasswd.procedure_v1", FT_UINT32, BASE_DEC,\r\nVALS(yppasswd1_proc_vals), 0, NULL, HFILL }},\r\n{ &hf_yppasswd_status, {\r\n"status", "yppasswd.status", FT_UINT32, BASE_DEC,\r\nNULL, 0, "YPPasswd update status", HFILL }},\r\n{ &hf_yppasswd_oldpass, {\r\n"oldpass", "yppasswd.oldpass", FT_STRING, BASE_NONE,\r\nNULL, 0, "Old encrypted password", HFILL }},\r\n{ &hf_yppasswd_newpw, {\r\n"newpw", "yppasswd.newpw", FT_NONE, BASE_NONE,\r\nNULL, 0, "New passwd entry", HFILL }},\r\n{ &hf_yppasswd_newpw_name, {\r\n"name", "yppasswd.newpw.name", FT_STRING, BASE_NONE,\r\nNULL, 0, "Username", HFILL }},\r\n{ &hf_yppasswd_newpw_passwd, {\r\n"passwd", "yppasswd.newpw.passwd", FT_STRING, BASE_NONE,\r\nNULL, 0, "Encrypted passwd", HFILL }},\r\n{ &hf_yppasswd_newpw_uid, {\r\n"uid", "yppasswd.newpw.uid", FT_UINT32, BASE_DEC,\r\nNULL, 0, "UserID", HFILL }},\r\n{ &hf_yppasswd_newpw_gid, {\r\n"gid", "yppasswd.newpw.gid", FT_UINT32, BASE_DEC,\r\nNULL, 0, "GroupID", HFILL }},\r\n{ &hf_yppasswd_newpw_gecos, {\r\n"gecos", "yppasswd.newpw.gecos", FT_STRING, BASE_NONE,\r\nNULL, 0, "In real life name", HFILL }},\r\n{ &hf_yppasswd_newpw_dir, {\r\n"dir", "yppasswd.newpw.dir", FT_STRING, BASE_NONE,\r\nNULL, 0, "Home Directory", HFILL }},\r\n{ &hf_yppasswd_newpw_shell, {\r\n"shell", "yppasswd.newpw.shell", FT_STRING, BASE_NONE,\r\nNULL, 0, "Default shell", HFILL }},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_yppasswd,\r\n&ett_yppasswd_newpw,\r\n};\r\nproto_yppasswd = proto_register_protocol("Yellow Pages Passwd",\r\n"YPPASSWD", "yppasswd");\r\nproto_register_field_array(proto_yppasswd, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid\r\nproto_reg_handoff_yppasswd(void)\r\n{\r\nrpc_init_prog(proto_yppasswd, YPPASSWD_PROGRAM, ett_yppasswd,\r\nG_N_ELEMENTS(yppasswd_vers_info), yppasswd_vers_info);\r\n}
