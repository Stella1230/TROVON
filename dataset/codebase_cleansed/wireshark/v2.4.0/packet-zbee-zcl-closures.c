static int\r\ndissect_zbee_zcl_shade_configuration(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void* data _U_)\r\n{\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\ndissect_zcl_shade_configuration_attr_data(proto_tree *tree, tvbuff_t *tvb, guint *offset, guint16 attr_id, guint data_type)\r\n{\r\nstatic const int * shade_config_status[] = {\r\n&hf_zbee_zcl_shade_configuration_status_shade_operational,\r\n&hf_zbee_zcl_shade_configuration_status_shade_adjusting,\r\n&hf_zbee_zcl_shade_configuration_status_shade_direction,\r\n&hf_zbee_zcl_shade_configuration_status_motor_forward_direction,\r\nNULL\r\n};\r\nswitch (attr_id) {\r\ncase ZBEE_ZCL_ATTR_ID_SHADE_CONFIGURATION_STATUS:\r\nproto_tree_add_bitmask(tree, tvb, *offset, hf_zbee_zcl_shade_configuration_status, ett_zbee_zcl_shade_configuration_status, shade_config_status, ENC_LITTLE_ENDIAN);\r\n*offset += 1;\r\nbreak;\r\ncase ZBEE_ZCL_ATTR_ID_SHADE_CONFIGURATION_MODE:\r\nproto_tree_add_item(tree, hf_zbee_zcl_shade_configuration_mode, tvb, *offset, 1, ENC_NA);\r\n*offset += 1;\r\nbreak;\r\ncase ZBEE_ZCL_ATTR_ID_SHADE_CONFIGURATION_PHYSICAL_CLOSED_LIMIT:\r\ncase ZBEE_ZCL_ATTR_ID_SHADE_CONFIGURATION_MOTOR_STEP_SIZE:\r\ncase ZBEE_ZCL_ATTR_ID_SHADE_CONFIGURATION_CLOSED_LIMIT:\r\ndefault:\r\ndissect_zcl_attr_data(tvb, tree, offset, data_type);\r\nbreak;\r\n}\r\n}\r\nvoid\r\nproto_register_zbee_zcl_shade_configuration(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_zbee_zcl_shade_configuration_attr_id,\r\n{ "Attribute", "zbee_zcl_closures.shade_configuration.attr_id", FT_UINT16, BASE_HEX, VALS(zbee_zcl_shade_configuration_attr_names),\r\n0x00, NULL, HFILL } },\r\n{ &hf_zbee_zcl_shade_configuration_status,\r\n{ "Shade Configuration Status", "zbee_zcl_closures.shade_configuration.attr.status", FT_UINT8, BASE_HEX, NULL,\r\n0x00, NULL, HFILL } },\r\n{ &hf_zbee_zcl_shade_configuration_status_shade_operational,\r\n{ "Shade Operational", "zbee_zcl_closures.shade_configuration.attr.status.shade_operational", FT_BOOLEAN, 8, TFS(&tfs_no_yes),\r\nZBEE_ZCL_SHADE_CONFIGURATION_STATUS_SHADE_OPERATIONAL, NULL, HFILL } },\r\n{ &hf_zbee_zcl_shade_configuration_status_shade_adjusting,\r\n{ "Shade Adjusting", "zbee_zcl_closures.shade_configuration.attr.status.shade_adjusting", FT_BOOLEAN, 8, TFS(&tfs_no_yes),\r\nZBEE_ZCL_SHADE_CONFIGURATION_STATUS_SHADE_ADJUSTING, NULL, HFILL } },\r\n{ &hf_zbee_zcl_shade_configuration_status_shade_direction,\r\n{ "Shade Direction", "zbee_zcl_closures.shade_configuration.attr.status.shade_direction", FT_UINT8, BASE_DEC, VALS(zbee_zcl_shade_configuration_shade_motor_direction_names),\r\nZBEE_ZCL_SHADE_CONFIGURATION_STATUS_SHADE_DIRECTION, NULL, HFILL } },\r\n{ &hf_zbee_zcl_shade_configuration_status_motor_forward_direction,\r\n{ "Motor Forward Direction", "zbee_zcl_closures.shade_configuration.attr.status.motor_forward_direction", FT_UINT8, BASE_DEC, VALS(zbee_zcl_shade_configuration_shade_motor_direction_names),\r\nZBEE_ZCL_SHADE_CONFIGURATION_STATUS_MOTOR_FORWARD_DIRECTION, NULL, HFILL } },\r\n{ &hf_zbee_zcl_shade_configuration_mode,\r\n{ "Mode", "zbee_zcl_closures.shade_configuration.attr.mode", FT_UINT8, BASE_HEX, VALS(zbee_zcl_shade_configuration_mode_names),\r\n0x00, NULL, HFILL } }\r\n};\r\nstatic gint *ett[ZBEE_ZCL_SHADE_CONFIGURATION_NUM_ETT];\r\nett[0] = &ett_zbee_zcl_shade_configuration;\r\nett[1] = &ett_zbee_zcl_shade_configuration_status;\r\nproto_zbee_zcl_shade_configuration = proto_register_protocol("ZigBee ZCL Shade Configuration", "ZCL Shade Configuration", ZBEE_PROTOABBREV_ZCL_SHADE_CONFIG);\r\nproto_register_field_array(proto_zbee_zcl_shade_configuration, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nregister_dissector(ZBEE_PROTOABBREV_ZCL_SHADE_CONFIG, dissect_zbee_zcl_shade_configuration, proto_zbee_zcl_shade_configuration);\r\n}\r\nvoid\r\nproto_reg_handoff_zbee_zcl_shade_configuration(void)\r\n{\r\ndissector_handle_t shade_config_handle;\r\nshade_config_handle = find_dissector(ZBEE_PROTOABBREV_ZCL_SHADE_CONFIG);\r\ndissector_add_uint("zbee.zcl.cluster", ZBEE_ZCL_CID_SHADE_CONFIG, shade_config_handle);\r\nzbee_zcl_init_cluster( proto_zbee_zcl_shade_configuration,\r\nett_zbee_zcl_shade_configuration,\r\nZBEE_ZCL_CID_SHADE_CONFIG,\r\nhf_zbee_zcl_shade_configuration_attr_id,\r\n-1, -1,\r\n(zbee_zcl_fn_attr_data)dissect_zcl_shade_configuration_attr_data\r\n);\r\n}\r\nstatic int\r\ndissect_zbee_zcl_door_lock(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data)\r\n{\r\nproto_tree *payload_tree;\r\nzbee_zcl_packet *zcl;\r\nguint offset = 0;\r\nguint8 cmd_id;\r\ngint rem_len;\r\nif (data == NULL)\r\nreturn 0;\r\nzcl = (zbee_zcl_packet *)data;\r\ncmd_id = zcl->cmd_id;\r\nif (zcl->direction == ZBEE_ZCL_FCF_TO_SERVER) {\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s, Seq: %u",\r\nval_to_str_const(cmd_id, zbee_zcl_door_lock_srv_rx_cmd_names, "Unknown Command"),\r\nzcl->tran_seqno);\r\nproto_tree_add_item(tree, hf_zbee_zcl_door_lock_srv_rx_cmd_id, tvb, offset, 1, cmd_id);\r\nrem_len = tvb_reported_length_remaining(tvb, ++offset);\r\nif (rem_len > 0) {\r\nproto_tree_add_subtree(tree, tvb, offset, rem_len, ett_zbee_zcl_door_lock, NULL, "Payload");\r\nswitch (cmd_id) {\r\ncase ZBEE_ZCL_CMD_ID_DOOR_LOCK_LOCK_DOOR:\r\ncase ZBEE_ZCL_CMD_ID_DOOR_LOCK_UNLOCK_DOOR:\r\ndefault:\r\nbreak;\r\n}\r\n}\r\n}\r\nelse {\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s, Seq: %u",\r\nval_to_str_const(cmd_id, zbee_zcl_door_lock_srv_tx_cmd_names, "Unknown Command"),\r\nzcl->tran_seqno);\r\nproto_tree_add_item(tree, hf_zbee_zcl_door_lock_srv_tx_cmd_id, tvb, offset, 1, cmd_id);\r\nrem_len = tvb_reported_length_remaining(tvb, ++offset);\r\nif (rem_len > 0) {\r\npayload_tree = proto_tree_add_subtree(tree, tvb, offset, rem_len, ett_zbee_zcl_door_lock, NULL, "Payload");\r\nswitch (cmd_id) {\r\ncase ZBEE_ZCL_CMD_ID_DOOR_LOCK_LOCK_DOOR_RESPONSE:\r\ncase ZBEE_ZCL_CMD_ID_DOOR_LOCK_UNLOCK_DOOR_RESPONSE:\r\ndissect_zcl_door_lock_lock_unlock_door_response(tvb, payload_tree, &offset);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic void\r\ndissect_zcl_door_lock_lock_unlock_door_response(tvbuff_t *tvb, proto_tree *tree, guint *offset)\r\n{\r\nproto_tree_add_item(tree, hf_zbee_zcl_door_lock_status, tvb, *offset, 1, ENC_LITTLE_ENDIAN);\r\n*offset += 1;\r\n}\r\nvoid\r\ndissect_zcl_door_lock_attr_data(proto_tree *tree, tvbuff_t *tvb, guint *offset, guint16 attr_id, guint data_type)\r\n{\r\nswitch ( attr_id ) {\r\ncase ZBEE_ZCL_ATTR_ID_DOOR_LOCK_LOCK_STATE:\r\nproto_tree_add_item(tree, hf_zbee_zcl_door_lock_lock_state, tvb, *offset, 1, ENC_LITTLE_ENDIAN);\r\n*offset += 1;\r\nbreak;\r\ncase ZBEE_ZCL_ATTR_ID_DOOR_LOCK_LOCK_TYPE:\r\nproto_tree_add_item(tree, hf_zbee_zcl_door_lock_lock_type, tvb, *offset, 1, ENC_LITTLE_ENDIAN);\r\n*offset += 1;\r\nbreak;\r\ncase ZBEE_ZCL_ATTR_ID_DOOR_LOCK_ACTUATOR_ENABLED:\r\nproto_tree_add_item(tree, hf_zbee_zcl_door_lock_actuator_enabled, tvb, *offset, 1, ENC_LITTLE_ENDIAN);\r\n*offset += 1;\r\nbreak;\r\ncase ZBEE_ZCL_ATTR_ID_DOOR_LOCK_DOOR_STATE:\r\nproto_tree_add_item(tree, hf_zbee_zcl_door_lock_door_state, tvb, *offset, 1, ENC_LITTLE_ENDIAN);\r\n*offset += 1;\r\nbreak;\r\ncase ZBEE_ZCL_ATTR_ID_DOOR_LOCK_DOOR_OPEN_EVENTS:\r\ncase ZBEE_ZCL_ATTR_ID_DOOR_LOCK_DOOR_CLOSED_EVENTS:\r\ncase ZBEE_ZCL_ATTR_ID_DOOR_LOCK_OPEN_PERIOD:\r\ndefault:\r\ndissect_zcl_attr_data(tvb, tree, offset, data_type);\r\nbreak;\r\n}\r\n}\r\nvoid\r\nproto_register_zbee_zcl_door_lock(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_zbee_zcl_door_lock_attr_id,\r\n{ "Attribute", "zbee_zcl_closures.door_lock.attr_id", FT_UINT16, BASE_HEX, VALS(zbee_zcl_door_lock_attr_names),\r\n0x00, NULL, HFILL } },\r\n{ &hf_zbee_zcl_door_lock_lock_state,\r\n{ "Lock State", "zbee_zcl_closures.door_lock.attr.lock_state", FT_UINT8, BASE_HEX, VALS(zbee_zcl_door_lock_lock_state_values),\r\n0x00, NULL, HFILL } },\r\n{ &hf_zbee_zcl_door_lock_lock_type,\r\n{ "Lock Type", "zbee_zcl_closures.door_lock.attr.lock_type", FT_UINT8, BASE_HEX, VALS(zbee_zcl_door_lock_lock_type_values),\r\n0x00, NULL, HFILL } },\r\n{ &hf_zbee_zcl_door_lock_door_state,\r\n{ "Door State", "zbee_zcl_closures.door_lock.attr.door_state", FT_UINT8, BASE_HEX, VALS(zbee_zcl_door_lock_door_state_values),\r\n0x00, NULL, HFILL } },\r\n{ &hf_zbee_zcl_door_lock_actuator_enabled,\r\n{ "Actuator enabled", "zbee_zcl_closures.door_lock.attr.actuator_enabled", FT_BOOLEAN, 8, TFS(&tfs_disabled_enabled),\r\n0x01, NULL, HFILL } },\r\n{ &hf_zbee_zcl_door_lock_status,\r\n{ "Lock Status", "zbee_zcl_closures.door_lock.status", FT_UINT8, BASE_HEX, VALS(zbee_zcl_status_names),\r\n0x00, NULL, HFILL } },\r\n{ &hf_zbee_zcl_door_lock_srv_rx_cmd_id,\r\n{ "Command", "zbee_zcl_closures.door_lock.cmd.srv_rx.id", FT_UINT8, BASE_HEX, VALS(zbee_zcl_door_lock_srv_rx_cmd_names),\r\n0x00, NULL, HFILL } },\r\n{ &hf_zbee_zcl_door_lock_srv_tx_cmd_id,\r\n{ "Command", "zbee_zcl_closures.door_lock.cmd.srv_tx.id", FT_UINT8, BASE_HEX, VALS(zbee_zcl_door_lock_srv_tx_cmd_names),\r\n0x00, NULL, HFILL } }\r\n};\r\nstatic gint *ett[ZBEE_ZCL_DOOR_LOCK_NUM_ETT];\r\nett[0] = &ett_zbee_zcl_door_lock;\r\nproto_zbee_zcl_door_lock = proto_register_protocol("ZigBee ZCL Door Lock", "ZCL Door Lock", ZBEE_PROTOABBREV_ZCL_DOOR_LOCK);\r\nproto_register_field_array(proto_zbee_zcl_door_lock, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nregister_dissector(ZBEE_PROTOABBREV_ZCL_DOOR_LOCK, dissect_zbee_zcl_door_lock, proto_zbee_zcl_door_lock);\r\n}\r\nvoid\r\nproto_reg_handoff_zbee_zcl_door_lock(void)\r\n{\r\ndissector_handle_t door_lock_handle;\r\ndoor_lock_handle = find_dissector(ZBEE_PROTOABBREV_ZCL_DOOR_LOCK);\r\ndissector_add_uint("zbee.zcl.cluster", ZBEE_ZCL_CID_DOOR_LOCK, door_lock_handle);\r\nzbee_zcl_init_cluster( proto_zbee_zcl_door_lock,\r\nett_zbee_zcl_door_lock,\r\nZBEE_ZCL_CID_DOOR_LOCK,\r\nhf_zbee_zcl_door_lock_attr_id,\r\nhf_zbee_zcl_door_lock_srv_rx_cmd_id,\r\nhf_zbee_zcl_door_lock_srv_tx_cmd_id,\r\n(zbee_zcl_fn_attr_data)dissect_zcl_door_lock_attr_data\r\n);\r\n}
