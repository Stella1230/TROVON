gint init_tlv_info(tlv_info_t *info, tvbuff_t *tvb, gint offset)\r\n{\r\nguint tlv_len;\r\ninfo->type = (guint8)tvb_get_guint8( tvb, offset );\r\ntlv_len = (guint)tvb_get_guint8( tvb, (offset + 1) );\r\ninfo->value_offset = 2;\r\nif((tlv_len & WIMAX_TLV_EXTENDED_LENGTH_MASK) != 0)\r\n{\r\ninfo->length_type = 1;\r\ntlv_len = (tlv_len & WIMAX_TLV_LENGTH_MASK);\r\ninfo->size_of_length = tlv_len;\r\ninfo->value_offset += tlv_len;\r\nswitch (tlv_len)\r\n{\r\ncase 0:\r\ninfo->length = 0;\r\nbreak;\r\ncase 1:\r\ninfo->length = (gint32)tvb_get_guint8( tvb, (offset + 2) );\r\nbreak;\r\ncase 2:\r\ninfo->length = (gint32)tvb_get_ntohs( tvb, (offset + 2) );\r\nbreak;\r\ncase 3:\r\ninfo->length = (gint32)tvb_get_ntoh24( tvb, (offset + 2) );\r\nbreak;\r\ncase 4:\r\ninfo->length = (gint32)tvb_get_ntohl( tvb, (offset + 2) );\r\nbreak;\r\ndefault:\r\ninfo->valid = 0;\r\nreturn (gint)tlv_len;\r\nbreak;\r\n}\r\n}\r\nelse\r\n{\r\ninfo->length_type = 0;\r\ninfo->size_of_length = 0;\r\ninfo->length = (gint32)tlv_len;\r\n}\r\ninfo->valid = 1;\r\nreturn 0;\r\n}\r\ngint get_tlv_type(tlv_info_t *info)\r\n{\r\nif(info->valid)\r\nreturn (gint)info->type;\r\nreturn -1;\r\n}\r\ngint get_tlv_size_of_length(tlv_info_t *info)\r\n{\r\nif(info->valid)\r\nreturn (gint)info->size_of_length;\r\nreturn -1;\r\n}\r\ngint32 get_tlv_length(tlv_info_t *info)\r\n{\r\nif(info->valid)\r\nreturn (gint32)info->length;\r\nreturn -1;\r\n}\r\ngint get_tlv_value_offset(tlv_info_t *info)\r\n{\r\nif(info->valid)\r\nreturn (gint)info->value_offset;\r\nreturn -1;\r\n}\r\ngint get_tlv_length_type(tlv_info_t *info)\r\n{\r\nif(info->valid)\r\nreturn (gint)info->length_type;\r\nreturn -1;\r\n}
