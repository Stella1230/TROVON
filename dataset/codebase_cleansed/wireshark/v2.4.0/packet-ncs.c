static int\r\ndissect_ncs(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nproto_tree *ncs_tree;\r\nproto_item *ti;\r\nti = proto_tree_add_item(tree, proto_ncs, tvb, 0, -1, ENC_NA);\r\nncs_tree = proto_item_add_subtree(ti, ett_ncs);\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "NCS");\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Novell Cluster Services Heartbeat");\r\nproto_tree_add_item(ncs_tree, hf_panning_id, tvb, 4, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ncs_tree, hf_incarnation, tvb, 8, 4, ENC_BIG_ENDIAN);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_ncs(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_panning_id,\r\n{ "Panning ID", "ncs.pan_id", FT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_incarnation,\r\n{ "Incarnation", "ncs.incarnation", FT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_ncs,\r\n};\r\nproto_ncs = proto_register_protocol("Novell Cluster Services",\r\n"NCS", "ncs");\r\nproto_register_field_array(proto_ncs, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid\r\nproto_reg_handoff_ncs(void)\r\n{\r\ndissector_handle_t ncs_handle;\r\nncs_handle = create_dissector_handle(dissect_ncs, proto_ncs);\r\ndissector_add_uint("ip.proto", IP_PROTO_NCS_HEARTBEAT, ncs_handle);\r\n}
