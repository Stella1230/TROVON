gboolean\r\nright_justify_column (gint col, capture_file *cf)\r\n{\r\nheader_field_info *hfi;\r\ngboolean right_justify = FALSE;\r\nif (!cf) return FALSE;\r\nswitch (cf->cinfo.columns[col].col_fmt) {\r\ncase COL_NUMBER:\r\ncase COL_PACKET_LENGTH:\r\ncase COL_CUMULATIVE_BYTES:\r\ncase COL_DCE_CALL:\r\ncase COL_DSCP_VALUE:\r\ncase COL_UNRES_DST_PORT:\r\ncase COL_UNRES_SRC_PORT:\r\ncase COL_DEF_DST_PORT:\r\ncase COL_DEF_SRC_PORT:\r\ncase COL_DELTA_TIME:\r\ncase COL_DELTA_TIME_DIS:\r\nright_justify = TRUE;\r\nbreak;\r\ncase COL_CUSTOM:\r\nhfi = proto_registrar_get_byname(cf->cinfo.columns[col].col_custom_fields);\r\nif ((hfi != NULL) && ((hfi->strings == NULL) || !get_column_resolved(col))) {\r\nif ((hfi->type == FT_BOOLEAN) || (hfi->type == FT_FRAMENUM) ||\r\n(((hfi->display == BASE_DEC) || (hfi->display == BASE_OCT)) &&\r\n(IS_FT_INT(hfi->type) || IS_FT_UINT(hfi->type)))) {\r\nright_justify = TRUE;\r\n}\r\n}\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nreturn right_justify;\r\n}\r\ngboolean\r\nresolve_column (gint col, capture_file *cf)\r\n{\r\nheader_field_info *hfi;\r\ngboolean resolve = FALSE;\r\nguint num_fields, *field_idx, ii;\r\nif (!cf) return FALSE;\r\nswitch (cf->cinfo.columns[col].col_fmt) {\r\ncase COL_CUSTOM:\r\nnum_fields = g_slist_length(cf->cinfo.columns[col].col_custom_fields_ids);\r\nfor (ii = 0; ii < num_fields; ii++) {\r\nfield_idx = (guint *) g_slist_nth_data(cf->cinfo.columns[col].col_custom_fields_ids, ii);\r\nhfi = proto_registrar_get_nth(*field_idx);\r\nif ((hfi->type == FT_OID) || (hfi->type == FT_REL_OID) ||\r\n((hfi->strings != NULL) &&\r\n((hfi->type == FT_BOOLEAN) || (hfi->type == FT_FRAMENUM) ||\r\nIS_FT_INT(hfi->type) || IS_FT_UINT(hfi->type))))\r\n{\r\nresolve = TRUE;\r\nbreak;\r\n}\r\n}\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nreturn resolve;\r\n}
