static void\r\nzdp_parse_nwk_desc(proto_tree *tree, tvbuff_t *tvb, guint *offset, guint8 version)\r\n{\r\nproto_tree *network_tree;\r\nproto_item *ti;\r\nguint8 beacon;\r\nif (version >= ZBEE_VERSION_2007) {\r\nnetwork_tree = proto_tree_add_subtree(tree, tvb, *offset, 12, ett_zbee_zdp_nwk_desc, NULL, "Network descriptor");\r\nproto_tree_add_item(network_tree, hf_zbee_zdp_pan_eui64, tvb, *offset, 8, ENC_LITTLE_ENDIAN);\r\n*offset += 8;\r\n}\r\nelse {\r\nnetwork_tree = proto_tree_add_subtree(tree, tvb, *offset, 6, ett_zbee_zdp_nwk_desc, NULL, "Network descriptor");\r\nproto_tree_add_item(network_tree, hf_zbee_zdp_pan_uint, tvb, *offset, 2, ENC_LITTLE_ENDIAN);\r\n*offset += 2;\r\n}\r\nproto_tree_add_item(network_tree, hf_zbee_zdp_channel, tvb, *offset, 1, ENC_LITTLE_ENDIAN);\r\n*offset += 1;\r\nproto_tree_add_item(network_tree, hf_zbee_zdp_profile, tvb, *offset, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(network_tree, hf_zbee_zdp_profile_version, tvb, *offset, 1, ENC_LITTLE_ENDIAN);\r\n*offset += 1;\r\nti = proto_tree_add_item(network_tree, hf_zbee_zdp_beacon, tvb, *offset, 1, ENC_LITTLE_ENDIAN);\r\nproto_tree_add_item(network_tree, hf_zbee_zdp_superframe, tvb, *offset, 1, ENC_LITTLE_ENDIAN);\r\nbeacon = tvb_get_guint8(tvb, *offset) & 0x0f;\r\nif (beacon == 0xf) {\r\nproto_item_append_text(ti, " (Beacons Disabled)");\r\n}\r\n*offset += 1;\r\nproto_tree_add_item(network_tree, hf_zbee_zdp_permit_joining, tvb, *offset, 1, ENC_LITTLE_ENDIAN);\r\n*offset += 1;\r\n}\r\nstatic void\r\nzdp_parse_neighbor_table_entry(proto_tree *tree, tvbuff_t *tvb, guint *offset, guint8 version)\r\n{\r\nproto_tree *table_tree;\r\nproto_item *ti = NULL;\r\nguint len = 0;\r\nif (version >= ZBEE_VERSION_2007) {\r\ntable_tree = proto_tree_add_subtree(tree, tvb, *offset, 8, ett_zbee_zdp_table_entry, &ti, "Table Entry");\r\nproto_tree_add_item(table_tree, hf_zbee_zdp_extended_pan, tvb, *offset, 8, ENC_LITTLE_ENDIAN);\r\nlen += 8;\r\n}\r\nelse {\r\ntable_tree = proto_tree_add_subtree(tree, tvb, *offset, 2, ett_zbee_zdp_table_entry, &ti, "Table Entry");\r\nproto_tree_add_item(table_tree, hf_zbee_zdp_pan_uint, tvb, *offset, 2, ENC_LITTLE_ENDIAN);\r\nlen += 2;\r\n}\r\nproto_tree_add_item(table_tree, hf_zbee_zdp_ext_addr, tvb, *offset + len, 8, ENC_LITTLE_ENDIAN);\r\nlen += 8;\r\nproto_tree_add_item(table_tree, hf_zbee_zdp_addr, tvb, *offset + len, 2, ENC_LITTLE_ENDIAN);\r\nlen += 2;\r\nif (version >= ZBEE_VERSION_2007) {\r\nproto_tree_add_item(table_tree, hf_zbee_zdp_table_entry_type, tvb, *offset + len, 1, ENC_NA);\r\nproto_tree_add_item(table_tree, hf_zbee_zdp_table_entry_idle_rx_0c, tvb, *offset + len, 1, ENC_NA);\r\nproto_tree_add_item(table_tree, hf_zbee_zdp_table_entry_relationship_70, tvb, *offset + len, 1, ENC_NA);\r\n}\r\nelse {\r\nproto_tree_add_item(table_tree, hf_zbee_zdp_table_entry_type, tvb, *offset + len, 1, ENC_NA);\r\nproto_tree_add_item(table_tree, hf_zbee_zdp_table_entry_idle_rx_04, tvb, *offset + len, 1, ENC_NA);\r\nproto_tree_add_item(table_tree, hf_zbee_zdp_table_entry_relationship_18, tvb, *offset + len, 1, ENC_NA);\r\n}\r\nlen += 1;\r\nif (version <= ZBEE_VERSION_2004) {\r\nproto_tree_add_item(table_tree, hf_zbee_zdp_depth, tvb, *offset + len, 1, ENC_NA);\r\nlen += 1;\r\n}\r\nproto_tree_add_item(table_tree, hf_zbee_zdp_permit_joining_03, tvb, *offset + len, 1, ENC_NA);\r\nlen += 1;\r\nif (version >= ZBEE_VERSION_2007) {\r\nproto_tree_add_item(table_tree, hf_zbee_zdp_depth, tvb, *offset + len, 1, ENC_NA);\r\nlen += 1;\r\n}\r\nproto_tree_add_item(table_tree, hf_zbee_zdp_lqi, tvb, *offset + len, 1, ENC_NA);\r\nlen += 1;\r\nif (tree) proto_item_set_len(ti, len);\r\n*offset += len;\r\n}\r\nstatic void\r\nzdp_parse_routing_table_entry(proto_tree *tree, tvbuff_t *tvb, guint *offset)\r\n{\r\nguint len = 0;\r\nproto_item *ti;\r\nproto_tree *field_tree;\r\nguint16 dest;\r\nguint8 status;\r\nguint16 next;\r\nti = proto_tree_add_item(tree, hf_zbee_zdp_rtg_entry, tvb, *offset + len, 2 + 1 + 2, ENC_NA);\r\nfield_tree = proto_item_add_subtree(ti, ett_zbee_zdp_rtg);\r\nproto_tree_add_item(field_tree, hf_zbee_zdp_rtg_destination, tvb, *offset + len, 2, ENC_LITTLE_ENDIAN);\r\ndest = tvb_get_letohs(tvb, *offset + len);\r\nlen += 2;\r\nproto_tree_add_item(field_tree, hf_zbee_zdp_rtg_status, tvb, *offset + len , 1, ENC_LITTLE_ENDIAN);\r\nstatus = tvb_get_guint8(tvb, *offset + len);\r\nlen += 1;\r\nproto_tree_add_item(field_tree, hf_zbee_zdp_rtg_next_hop, tvb, *offset + len , 2, ENC_LITTLE_ENDIAN);\r\nnext = tvb_get_letohs(tvb, *offset + len);\r\nlen += 2;\r\nproto_item_append_text(ti, " {Destination: 0x%04x, Next Hop: 0x%04x, Status: %s}", dest, next, val_to_str_const(status, zbee_zdp_rtg_status_vals, "Unknown"));\r\n*offset += len;\r\n}\r\nvoid\r\ndissect_zbee_zdp_req_mgmt_nwk_disc(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, int hf_channel)\r\n{\r\nproto_item *ti;\r\nguint i;\r\nguint offset = 0;\r\nguint32 channels;\r\nchannels = tvb_get_letohl(tvb, offset);\r\nif (tree) {\r\ngboolean first = 1;\r\nti = proto_tree_add_uint_format(tree, hf_channel, tvb, offset, 4, channels, "Scan Channels: ");\r\nfor (i=0; i<27; i++) {\r\nif (channels & (1<<i)) {\r\nif (first) proto_item_append_text(ti, "%d", i);\r\nelse proto_item_append_text(ti, ", %d", i);\r\nif (channels & (2<<i)) {\r\nwhile ((channels&(2<<i)) && (i<26)) i++;\r\nproto_item_append_text(ti, "-%d", i);\r\n}\r\nfirst = 0;\r\n}\r\n}\r\nif (first) proto_item_append_text(ti, "None");\r\n}\r\noffset += 4;\r\nzbee_parse_uint(tree, hf_zbee_zdp_duration, tvb, &offset, 1, NULL);\r\nzbee_parse_uint(tree, hf_zbee_zdp_index, tvb, &offset, 1, NULL);\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_req_mgmt_lqi(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint offset = 0;\r\nzbee_parse_uint(tree, hf_zbee_zdp_index, tvb, &offset, 1, NULL);\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_req_mgmt_rtg(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint offset = 0;\r\nzbee_parse_uint(tree, hf_zbee_zdp_index, tvb, &offset, 1, NULL);\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_req_mgmt_bind(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint offset = 0;\r\nzbee_parse_uint(tree, hf_zbee_zdp_index, tvb, &offset, 1, NULL);\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_req_mgmt_leave(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint8 version)\r\n{\r\nguint offset = 0;\r\nguint64 ext_addr;\r\nstatic const int * flags[] = {\r\n&hf_zbee_zdp_leave_children,\r\n&hf_zbee_zdp_leave_rejoin,\r\nNULL\r\n};\r\next_addr = zbee_parse_eui64(tree, hf_zbee_zdp_ext_addr, tvb, &offset, 8, NULL);\r\nif (version >= ZBEE_VERSION_2007) {\r\nproto_tree_add_bitmask_list(tree, tvb, offset, 1, flags, ENC_NA);\r\noffset += 1;\r\n}\r\nzbee_append_info(tree, pinfo, ", Device: %s", eui64_to_display(wmem_packet_scope(), ext_addr));\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_req_mgmt_direct_join(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint offset = 0;\r\nguint64 ext_addr;\r\next_addr = zbee_parse_eui64(tree, hf_zbee_zdp_ext_addr, tvb, &offset, 8, NULL);\r\nzdp_parse_cinfo(tree, ett_zbee_zdp_cinfo, tvb, &offset);\r\nzbee_append_info(tree, pinfo, ", Device: %s", eui64_to_display(wmem_packet_scope(), ext_addr));\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_req_mgmt_permit_join(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint offset = 0;\r\nzbee_parse_uint(tree, hf_zbee_zdp_duration, tvb, &offset, 1, NULL);\r\nzbee_parse_uint(tree, hf_zbee_zdp_significance, tvb, &offset, 1, NULL);\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_req_mgmt_cache(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint offset = 0;\r\nzbee_parse_uint(tree, hf_zbee_zdp_index, tvb, &offset, 1, NULL);\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_req_mgmt_nwkupdate(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint offset = 0;\r\nguint8 duration;\r\nzdp_parse_chanmask(tree, tvb, &offset, hf_zbee_zdp_channel_page, hf_zbee_zdp_channel_mask);\r\nduration = zbee_parse_uint(tree, hf_zbee_zdp_duration, tvb, &offset, 1, NULL);\r\nif (duration == ZBEE_ZDP_NWKUPDATE_PARAMETERS) {\r\nzbee_parse_uint(tree, hf_zbee_zdp_update_id, tvb, &offset, 1, NULL);\r\nzbee_parse_uint(tree, hf_zbee_zdp_manager, tvb, &offset, 2, NULL);\r\n}\r\nelse if (duration == ZBEE_ZDP_NWKUPDATE_CHANNEL_HOP) {\r\nzbee_parse_uint(tree, hf_zbee_zdp_update_id, tvb, &offset, 1, NULL);\r\n}\r\nelse if (duration <= ZBEE_ZDP_NWKUPDATE_SCAN_MAX) {\r\nzbee_parse_uint(tree, hf_zbee_zdp_scan_count, tvb, &offset, 1, NULL);\r\n}\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_req_mgmt_nwkupdate_enh(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint offset = 0;\r\nguint8 duration;\r\nguint8 count;\r\nint i;\r\ncount = zbee_parse_uint(tree, hf_zbee_zdp_channel_page_count, tvb, &offset, 1, NULL);\r\nfor (i=0; i<count; i++) {\r\nzdp_parse_chanmask(tree, tvb, &offset, hf_zbee_zdp_channel_page, hf_zbee_zdp_channel_mask);\r\n}\r\nduration = zbee_parse_uint(tree, hf_zbee_zdp_duration, tvb, &offset, 1, NULL);\r\nif (duration == ZBEE_ZDP_NWKUPDATE_PARAMETERS) {\r\nzbee_parse_uint(tree, hf_zbee_zdp_update_id, tvb, &offset, 1, NULL);\r\nzbee_parse_uint(tree, hf_zbee_zdp_manager, tvb, &offset, 2, NULL);\r\n}\r\nelse if (duration == ZBEE_ZDP_NWKUPDATE_CHANNEL_HOP) {\r\nzbee_parse_uint(tree, hf_zbee_zdp_update_id, tvb, &offset, 1, NULL);\r\n}\r\nelse if (duration <= ZBEE_ZDP_NWKUPDATE_SCAN_MAX) {\r\nzbee_parse_uint(tree, hf_zbee_zdp_scan_count, tvb, &offset, 1, NULL);\r\n}\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_req_mgmt_ieee_join_list(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint offset = 0;\r\nzbee_parse_uint(tree, hf_zbee_zdp_ieee_join_start_index, tvb, &offset, 1, NULL);\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_rsp_mgmt_nwk_disc(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint8 version)\r\n{\r\nproto_tree *field_tree = NULL;\r\nguint offset = 0;\r\nguint i;\r\nguint8 status;\r\nguint8 table_count;\r\nstatus = zdp_parse_status(tree, tvb, &offset);\r\nzbee_parse_uint(tree, hf_zbee_zdp_table_size, tvb, &offset, 1, NULL);\r\nzbee_parse_uint(tree, hf_zbee_zdp_index, tvb, &offset, 1, NULL);\r\ntable_count = zbee_parse_uint(tree, hf_zbee_zdp_table_count, tvb, &offset, 1, NULL);\r\nif (tree && table_count) {\r\nfield_tree = proto_tree_add_subtree(tree, tvb, offset, -1, ett_zbee_zdp_nwk, NULL, "Network List");\r\n}\r\nfor (i=0; i<table_count; i++) {\r\nzdp_parse_nwk_desc(field_tree, tvb, &offset, version);\r\n}\r\nzbee_append_info(tree, pinfo, ", Status: %s", zdp_status_name(status));\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_rsp_mgmt_lqi(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint8 version)\r\n{\r\nproto_tree *field_tree = NULL;\r\nguint offset = 0;\r\nguint i;\r\nguint8 status;\r\nguint8 table_count;\r\nstatus = zdp_parse_status(tree, tvb, &offset);\r\nzbee_parse_uint(tree, hf_zbee_zdp_table_size, tvb, &offset, 1, NULL);\r\nzbee_parse_uint(tree, hf_zbee_zdp_index, tvb, &offset, 1, NULL);\r\ntable_count = zbee_parse_uint(tree, hf_zbee_zdp_table_count, tvb, &offset, 1, NULL);\r\nif (table_count) {\r\nfield_tree = proto_tree_add_subtree(tree, tvb, offset, -1, ett_zbee_zdp_lqi, NULL, "Neighbor Table");\r\nfor (i=0; i<table_count; i++) {\r\nzdp_parse_neighbor_table_entry(field_tree, tvb, &offset, version);\r\n}\r\n}\r\nzbee_append_info(tree, pinfo, ", Status: %s", zdp_status_name(status));\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_rsp_mgmt_rtg(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nproto_item *ti;\r\nproto_tree *field_tree = NULL;\r\nguint offset = 0;\r\nguint i;\r\nguint8 status;\r\nguint8 table_count;\r\nstatus = zdp_parse_status(tree, tvb, &offset);\r\nzbee_parse_uint(tree, hf_zbee_zdp_table_size, tvb, &offset, 1, NULL);\r\nzbee_parse_uint(tree, hf_zbee_zdp_index, tvb, &offset, 1, NULL);\r\ntable_count = zbee_parse_uint(tree, hf_zbee_zdp_table_count, tvb, &offset, 1, NULL);\r\nif (tree && table_count) {\r\nti = proto_tree_add_item(tree, hf_zbee_zdp_rtg, tvb, offset, -1, ENC_NA);\r\nfield_tree = proto_item_add_subtree(ti, ett_zbee_zdp_rtg);\r\n}\r\nfor (i=0; i<table_count; i++) {\r\nzdp_parse_routing_table_entry(field_tree, tvb, &offset);\r\n}\r\nzbee_append_info(tree, pinfo, ", Status: %s", zdp_status_name(status));\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_rsp_mgmt_bind(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, guint8 version)\r\n{\r\nproto_tree *field_tree = NULL;\r\nguint offset = 0;\r\nguint i;\r\nguint8 status;\r\nguint8 table_count;\r\nstatus = zdp_parse_status(tree, tvb, &offset);\r\nzbee_parse_uint(tree, hf_zbee_zdp_table_size, tvb, &offset, 1, NULL);\r\nzbee_parse_uint(tree, hf_zbee_zdp_index, tvb, &offset, 1, NULL);\r\ntable_count = zbee_parse_uint(tree, hf_zbee_zdp_table_count, tvb, &offset, 1, NULL);\r\nif (tree && table_count) {\r\nfield_tree = proto_tree_add_subtree(tree, tvb, offset, -1, ett_zbee_zdp_bind, NULL, "Binding Table");\r\n}\r\nfor (i=0; i<table_count; i++) {\r\nzdp_parse_bind_table_entry(field_tree, tvb, &offset, version);\r\n}\r\nzbee_append_info(tree, pinfo, ", Status: %s", zdp_status_name(status));\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_rsp_mgmt_leave(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint offset = 0;\r\nguint8 status;\r\nstatus = zdp_parse_status(tree, tvb, &offset);\r\nzbee_append_info(tree, pinfo, ", Status: %s", zdp_status_name(status));\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_rsp_mgmt_direct_join(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint offset = 0;\r\nguint8 status;\r\nstatus = zdp_parse_status(tree, tvb, &offset);\r\nzbee_append_info(tree, pinfo, ", Status: %s", zdp_status_name(status));\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_rsp_mgmt_permit_join(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint offset = 0;\r\nguint8 status;\r\nstatus = zdp_parse_status(tree, tvb, &offset);\r\nzbee_append_info(tree, pinfo, ", Status: %s", zdp_status_name(status));\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_rsp_mgmt_cache(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nproto_tree *field_tree = NULL;\r\nproto_tree *ti;\r\nguint offset = 0;\r\nguint i;\r\nguint8 status;\r\nguint8 table_count;\r\nstatus = zdp_parse_status(tree, tvb, &offset);\r\nzbee_parse_uint(tree, hf_zbee_zdp_table_size, tvb, &offset, 1, NULL);\r\nzbee_parse_uint(tree, hf_zbee_zdp_index, tvb, &offset, 1, NULL);\r\ntable_count = zbee_parse_uint(tree, hf_zbee_zdp_table_count, tvb, &offset, 1, NULL);\r\nif (table_count) {\r\nfield_tree = proto_tree_add_subtree(tree, tvb, offset, table_count*(2+8),\r\nett_zbee_zdp_cache, NULL, "Discovery Cache");\r\nfor (i=0; i<table_count; i++) {\r\nguint16 addr16 = tvb_get_letohs(tvb, offset+8);\r\nti = proto_tree_add_item(field_tree, hf_zbee_zdp_cache_address, tvb, offset, 8, ENC_LITTLE_ENDIAN);\r\nproto_item_append_text(ti, " = 0x%04x", addr16);\r\nproto_item_set_len(ti, 8+2);\r\noffset += 2+8;\r\n}\r\n}\r\nzbee_append_info(tree, pinfo, ", Status: %s", zdp_status_name(status));\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_rsp_mgmt_nwkupdate(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint offset = 0;\r\nguint i, j;\r\nguint32 channels;\r\nguint8 channel_count;\r\nzdp_parse_status(tree, tvb, &offset);\r\nchannels = zdp_parse_chanmask(tree, tvb, &offset, hf_zbee_zdp_channel_page, hf_zbee_zdp_channel_mask);\r\nzbee_parse_uint(tree, hf_zbee_zdp_tx_total, tvb, &offset, 2, NULL);\r\nzbee_parse_uint(tree, hf_zbee_zdp_tx_fail, tvb, &offset, 2, NULL);\r\nchannel_count = zbee_parse_uint(tree, hf_zbee_zdp_channel_count, tvb, &offset, 1, NULL);\r\nfor (i=0, j=0; i<(8*4); i++) {\r\nguint8 energy;\r\nif ( ! ((1<<i) & channels) ) {\r\ncontinue;\r\n}\r\nif (j>=channel_count) {\r\nbreak;\r\n}\r\nenergy = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_uint_format(tree, hf_zbee_zdp_channel_energy, tvb, offset, 1, energy, "Channel %d Energy: 0x%02x", i, energy);\r\noffset += 1;\r\nj++;\r\n}\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}\r\nvoid\r\ndissect_zbee_zdp_rsp_mgmt_ieee_join_list(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree)\r\n{\r\nguint8 status;\r\nguint8 list_total;\r\nguint8 list_count;\r\nguint offset = 0;\r\nint i;\r\nstatus = zbee_parse_uint(tree, hf_zbee_zdp_ieee_join_status, tvb, &offset, 1, NULL);\r\nif (status == 0x00) {\r\nzbee_parse_uint(tree, hf_zbee_zdp_ieee_join_update_id, tvb, &offset, 1, NULL);\r\nzbee_parse_uint(tree, hf_zbee_zdp_ieee_join_policy, tvb, &offset, 1, NULL);\r\nlist_total = zbee_parse_uint(tree, hf_zbee_zdp_ieee_join_list_total, tvb, &offset, 1, NULL);\r\nif (list_total > 0) {\r\nzbee_parse_uint(tree, hf_zbee_zdp_ieee_join_list_start, tvb, &offset, 1, NULL);\r\nlist_count = zbee_parse_uint(tree, hf_zbee_zdp_ieee_join_list_count, tvb, &offset, 1, NULL);\r\nfor(i=0; i<list_count; i++) {\r\nzbee_parse_eui64(tree, hf_zbee_zdp_ieee_join_list_ieee, tvb, &offset, 8, NULL);\r\n}\r\n}\r\n}\r\nzdp_dump_excess(tvb, offset, pinfo, tree);\r\n}
