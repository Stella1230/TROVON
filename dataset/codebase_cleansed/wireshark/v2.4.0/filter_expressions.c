struct filter_expression *\r\nfilter_expression_new(const gchar *label, const gchar *expr,\r\nconst gboolean enabled)\r\n{\r\nstruct filter_expression *expression;\r\nstruct filter_expression *prev;\r\nexpression = (struct filter_expression *)g_malloc0(sizeof(struct filter_expression));\r\nexpression->label = g_strdup(label);\r\nexpression->expression = g_strdup(expr);\r\nexpression->enabled = enabled;\r\nif (*pfilter_expression_head == NULL) {\r\n_filter_expression_head = expression;\r\n} else {\r\nprev = *pfilter_expression_head;\r\nwhile (prev->next != NULL)\r\nprev = prev->next;\r\nprev->next = expression;\r\nexpression->filter_index = prev->filter_index + 1;\r\n}\r\nreturn(expression);\r\n}\r\nvoid\r\nfilter_expression_init(void)\r\n{\r\nprefs.filter_expressions = pfilter_expression_head;\r\n}\r\nvoid\r\nfilter_expression_free(struct filter_expression *list_head)\r\n{\r\nif (list_head == NULL)\r\nreturn;\r\nfilter_expression_free(list_head->next);\r\ng_free(list_head->label);\r\ng_free(list_head->expression);\r\ng_free(list_head);\r\n}
