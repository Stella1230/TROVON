static void dissect_wifi_p2p_capability(proto_item *tlv_root,\r\nproto_item *tlv_item,\r\ntvbuff_t *tvb, int offset)\r\n{\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_capab_device, tvb,\r\noffset + 3, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root,\r\nhf_p2p_attr_capab_device_service_discovery, tvb,\r\noffset + 3, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root,\r\nhf_p2p_attr_capab_device_client_discoverability,\r\ntvb, offset + 3, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root,\r\nhf_p2p_attr_capab_device_concurrent_operation,\r\ntvb, offset + 3, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root,\r\nhf_p2p_attr_capab_device_infrastructure_managed,\r\ntvb, offset + 3, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_capab_device_limit, tvb,\r\noffset + 3, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_capab_invitation_procedure, tvb,\r\noffset + 3, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_capab_group,\r\ntvb, offset + 4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_capab_group_owner,\r\ntvb, offset + 4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_capab_group_persistent,\r\ntvb, offset + 4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_capab_group_limit,\r\ntvb, offset + 4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root,\r\nhf_p2p_attr_capab_group_intra_bss_distribution,\r\ntvb, offset + 4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_capab_group_cross_connection,\r\ntvb, offset + 4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root,\r\nhf_p2p_attr_capab_group_persistent_reconnect,\r\ntvb, offset + 4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_capab_group_group_formation,\r\ntvb, offset + 4, 1, ENC_BIG_ENDIAN);\r\nproto_item_append_text(tlv_item, ": Device 0x%x Group 0x%x",\r\ntvb_get_guint8(tvb, offset + 3),\r\ntvb_get_guint8(tvb, offset + 4));\r\n}\r\nstatic void dissect_device_id(proto_item *tlv_root, proto_item *tlv_item,\r\ntvbuff_t *tvb, int offset)\r\n{\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_device_id, tvb,\r\noffset + 3, 6, ENC_NA);\r\nproto_item_append_text(tlv_item, ": %s", tvb_ether_to_str(tvb, offset+3));\r\n}\r\nstatic void dissect_group_owner_intent(proto_item *tlv_root,\r\nproto_item *tlv_item,\r\ntvbuff_t *tvb, int offset)\r\n{\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_go_intent, tvb,\r\noffset + 3, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_go_intent_tie_breaker, tvb,\r\noffset + 3, 1, ENC_BIG_ENDIAN);\r\nproto_item_append_text(tlv_item, ": Intent %u Tie breaker %u",\r\ntvb_get_guint8(tvb, offset + 3) >> 1,\r\ntvb_get_guint8(tvb, offset + 3) & 0x01);\r\n}\r\nstatic void dissect_status(proto_item *tlv_root, proto_item *tlv_item,\r\ntvbuff_t *tvb, int offset)\r\n{\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_status, tvb,\r\noffset + 3, 1, ENC_BIG_ENDIAN);\r\nproto_item_append_text(tlv_item, ": %u (%s)",\r\ntvb_get_guint8(tvb, offset + 3),\r\nval_to_str(tvb_get_guint8(tvb, offset + 3),\r\np2p_status_codes,\r\n"Unknown Status Code (%u)"));\r\n}\r\nstatic void dissect_listen_channel(proto_item *tlv_root, proto_item *tlv_item,\r\ntvbuff_t *tvb, int offset)\r\n{\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_listen_channel_country, tvb,\r\noffset + 3, 3, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_listen_channel_oper_class, tvb,\r\noffset + 6, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_listen_channel_number, tvb,\r\noffset + 7, 1, ENC_BIG_ENDIAN);\r\nproto_item_append_text(tlv_item, ": Operating Class %u "\r\n"Channel Number %u",\r\ntvb_get_guint8(tvb, offset + 6),\r\ntvb_get_guint8(tvb, offset + 7));\r\n}\r\nstatic void dissect_operating_channel(proto_item *tlv_root,\r\nproto_item *tlv_item,\r\ntvbuff_t *tvb, int offset)\r\n{\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_operating_channel_country, tvb,\r\noffset + 3, 3, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_operating_channel_oper_class, tvb,\r\noffset + 6, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_operating_channel_number, tvb,\r\noffset + 7, 1, ENC_BIG_ENDIAN);\r\nproto_item_append_text(tlv_item, ": Operating Class %u "\r\n"Channel Number %u",\r\ntvb_get_guint8(tvb, offset + 6),\r\ntvb_get_guint8(tvb, offset + 7));\r\n}\r\nstatic void dissect_channel_list(proto_item *tlv_root, tvbuff_t *tvb,\r\nint offset, guint16 slen)\r\n{\r\nint s_offset = offset + 3;\r\nguint8 num_chan;\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_channel_list_country, tvb,\r\ns_offset, 3, ENC_ASCII|ENC_NA);\r\ns_offset += 3;\r\nwhile (offset + 3 + slen > s_offset) {\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_channel_list_oper_class, tvb,\r\ns_offset, 1, ENC_BIG_ENDIAN);\r\ns_offset++;\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_channel_list_num_chan, tvb,\r\ns_offset, 1, ENC_BIG_ENDIAN);\r\nnum_chan = tvb_get_guint8(tvb, s_offset);\r\ns_offset++;\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_channel_list_chan, tvb,\r\ns_offset, num_chan, ENC_NA);\r\ns_offset += num_chan;\r\n}\r\n}\r\nstatic void dissect_wifi_p2p_device_info(packet_info *pinfo,\r\nproto_item *tlv_root, tvbuff_t *tvb,\r\nint offset, guint16 slen)\r\n{\r\nint s_offset, nlen;\r\nguint8 num_sec;\r\nguint16 attr_type, attr_len;\r\nproto_item *item;\r\ns_offset = offset + 3;\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_dev_info_p2p_dev_addr, tvb,\r\ns_offset, 6, ENC_NA);\r\ns_offset += 6;\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_dev_info_config_methods,\r\ntvb, s_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root,\r\nhf_p2p_attr_dev_info_config_methods_usba,\r\ntvb, s_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root,\r\nhf_p2p_attr_dev_info_config_methods_ethernet,\r\ntvb, s_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root,\r\nhf_p2p_attr_dev_info_config_methods_label,\r\ntvb, s_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root,\r\nhf_p2p_attr_dev_info_config_methods_display,\r\ntvb, s_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root,\r\nhf_p2p_attr_dev_info_config_methods_ext_nfc_token,\r\ntvb, s_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root,\r\nhf_p2p_attr_dev_info_config_methods_int_nfc_token,\r\ntvb, s_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root,\r\nhf_p2p_attr_dev_info_config_methods_nfc_interface,\r\ntvb, s_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root,\r\nhf_p2p_attr_dev_info_config_methods_pushbutton,\r\ntvb, s_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root,\r\nhf_p2p_attr_dev_info_config_methods_keypad,\r\ntvb, s_offset, 2, ENC_BIG_ENDIAN);\r\ns_offset += 2;\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_dev_info_pri_dev_type, tvb,\r\ns_offset, 8, ENC_NA);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_dev_info_pri_dev_type_category,\r\ntvb, s_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_dev_info_pri_dev_type_oui,\r\ntvb, s_offset + 2, 4, ENC_NA);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_dev_info_pri_dev_type_subcategory,\r\ntvb, s_offset + 6, 2, ENC_BIG_ENDIAN);\r\ns_offset += 8;\r\nnum_sec = tvb_get_guint8(tvb, s_offset);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_dev_info_num_sec, tvb,\r\ns_offset, 1, ENC_BIG_ENDIAN);\r\ns_offset++;\r\nwhile (num_sec > 0) {\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_dev_info_sec_dev_type,\r\ntvb, s_offset, 8, ENC_NA);\r\ns_offset += 8;\r\nnum_sec--;\r\n}\r\nitem = proto_tree_add_item(tlv_root, hf_p2p_attr_dev_info_dev_name_type,\r\ntvb, s_offset, 2, ENC_BIG_ENDIAN);\r\nattr_type = tvb_get_ntohs(tvb, s_offset);\r\nif (attr_type != 0x1011) {\r\nexpert_add_info_format(pinfo, item, &ei_wifi_p2p_attr_dev_info_dev_name_type, "Incorrect Device Name attribute type");\r\n}\r\ns_offset += 2;\r\nitem = proto_tree_add_item(tlv_root, hf_p2p_attr_dev_info_dev_name_len,\r\ntvb, s_offset, 2, ENC_BIG_ENDIAN);\r\nattr_len = tvb_get_ntohs(tvb, s_offset);\r\ns_offset += 2;\r\nif (attr_len > offset + 3 + slen - s_offset) {\r\nexpert_add_info_format(pinfo, item, &ei_wifi_p2p_attr_len, "Invalid Device Name attribute length");\r\nreturn;\r\n}\r\nnlen = offset + 3 + slen - s_offset;\r\nif (nlen > 0)\r\nitem = proto_tree_add_item(tlv_root, hf_p2p_attr_dev_info_dev_name,\r\ntvb, s_offset,\r\nnlen > attr_len ? attr_len : nlen,\r\nENC_ASCII|ENC_NA);\r\nif (nlen != attr_len) {\r\nexpert_add_info_format(pinfo, item, &ei_wifi_p2p_attr_len, "Invalid Device Name attribute");\r\n}\r\n}\r\nstatic void dissect_configuration_timeout(proto_item *tlv_root,\r\nproto_item *tlv_item,\r\ntvbuff_t *tvb, int offset)\r\n{\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_config_timeout_go, tvb,\r\noffset + 3, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_config_timeout_client, tvb,\r\noffset + 4, 1, ENC_BIG_ENDIAN);\r\nproto_item_append_text(tlv_item, ": GO %u msec, client %u msec",\r\ntvb_get_guint8(tvb, offset + 3) * 10,\r\ntvb_get_guint8(tvb, offset + 4) * 10);\r\n}\r\nstatic void dissect_intended_interface_addr(proto_item *tlv_root,\r\nproto_item *tlv_item,\r\ntvbuff_t *tvb, int offset)\r\n{\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_intended_interface_addr, tvb,\r\noffset + 3, 6, ENC_NA);\r\nproto_item_append_text(tlv_item, ": %s", tvb_ether_to_str(tvb, offset + 3));\r\n}\r\nstatic void dissect_extended_listen_timing(proto_item *tlv_root,\r\nproto_item *tlv_item,\r\ntvbuff_t *tvb, int offset)\r\n{\r\nguint16 period, interval;\r\nperiod = tvb_get_letohs(tvb, offset + 3);\r\ninterval = tvb_get_letohs(tvb, offset + 5);\r\nproto_tree_add_uint(tlv_root, hf_p2p_attr_extended_listen_timing_period, tvb,\r\noffset + 3, 2, period);\r\nproto_tree_add_uint(tlv_root, hf_p2p_attr_extended_listen_timing_interval,\r\ntvb, offset + 5, 2, interval);\r\nproto_item_append_text(tlv_item, ": Availability Period %u msec, "\r\n"Availability Interval %u msec", period, interval);\r\n}\r\nstatic void dissect_wifi_p2p_group_id(proto_item *tlv_root,\r\nproto_item *tlv_item, tvbuff_t *tvb,\r\nint offset, guint16 slen)\r\n{\r\nint s_offset;\r\ns_offset = offset + 3;\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_p2p_group_id_dev_addr, tvb,\r\ns_offset, 6, ENC_NA);\r\nproto_item_append_text(tlv_item, ": %s", tvb_ether_to_str(tvb, offset + 3));\r\ns_offset += 6;\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_p2p_group_id_ssid, tvb,\r\ns_offset, offset + 3 + slen - s_offset, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void dissect_wifi_p2p_group_bssid(packet_info *pinfo,\r\nproto_item *tlv_root,\r\nproto_item *tlv_item, tvbuff_t *tvb,\r\nint offset, guint16 slen)\r\n{\r\nint s_offset;\r\nif (slen != 6) {\r\nexpert_add_info_format(pinfo, tlv_item, &ei_wifi_p2p_attr_len, "Invalid ethernet address");\r\nreturn;\r\n}\r\ns_offset = offset + 3;\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_p2p_group_bssid, tvb,\r\ns_offset, 6, ENC_NA);\r\nproto_item_append_text(tlv_item, ": %s", tvb_ether_to_str(tvb, offset + 3));\r\n}\r\nstatic void dissect_notice_of_absence(packet_info *pinfo, proto_item *tlv_root,\r\nproto_item *tlv_item,\r\ntvbuff_t *tvb, int offset, guint16 slen)\r\n{\r\nint s_offset = offset + 3;\r\nif (slen < 2) {\r\nexpert_add_info_format(pinfo, tlv_item, &ei_wifi_p2p_attr_len, "Too short NoA");\r\nreturn;\r\n}\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_noa_index, tvb, s_offset, 1,\r\nENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_noa_params, tvb, s_offset + 1, 1,\r\nENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_noa_params_opp_ps, tvb,\r\ns_offset + 1, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_noa_params_ctwindow, tvb,\r\ns_offset + 1, 1, ENC_BIG_ENDIAN);\r\ns_offset += 2;\r\nwhile (offset + 3 + slen >= s_offset + 13) {\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_noa_count_type, tvb, s_offset, 1,\r\nENC_BIG_ENDIAN);\r\ns_offset++;\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_noa_duration, tvb, s_offset, 4,\r\nENC_LITTLE_ENDIAN);\r\ns_offset += 4;\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_noa_interval, tvb, s_offset, 4,\r\nENC_LITTLE_ENDIAN);\r\ns_offset += 4;\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_noa_start_time, tvb, s_offset, 4,\r\nENC_LITTLE_ENDIAN);\r\ns_offset += 4;\r\n}\r\n}\r\nstatic void dissect_wifi_p2p_group_info(packet_info *pinfo,\r\nproto_item *tlv_root,\r\nproto_item *tlv_item,\r\ntvbuff_t *tvb, int offset,\r\nguint16 slen)\r\n{\r\nint s_offset = offset + 3;\r\nint next_offset, ci_len, num_sec, left, nlen;\r\nguint16 attr_type, attr_len;\r\nproto_item *item;\r\nproto_tree *tree;\r\nwhile (offset + 3 + slen > s_offset) {\r\nif (offset + 3 + slen - s_offset < 25) {\r\nexpert_add_info_format(pinfo, tlv_item, &ei_wifi_p2p_attr_len, "Too short P2P Client Info Descriptor");\r\nbreak;\r\n}\r\nci_len = tvb_get_guint8(tvb, s_offset);\r\ntree = proto_tree_add_subtree(tlv_root, tvb, s_offset, 1 + ci_len,\r\nett_p2p_client_descr, NULL, "P2P Client Info Descriptor");\r\nitem = proto_tree_add_item(tree, hf_p2p_attr_gi_length, tvb, s_offset,\r\n1, ENC_BIG_ENDIAN);\r\nif (ci_len < 24 || s_offset + ci_len > offset + 3 + slen) {\r\nexpert_add_info_format(pinfo, item, &ei_wifi_p2p_attr_len, "Invalid P2P Client Info Descriptor Length");\r\nbreak;\r\n}\r\ns_offset++;\r\nnext_offset = s_offset + ci_len;\r\nproto_tree_add_item(tree, hf_p2p_attr_gi_p2p_dev_addr, tvb, s_offset,\r\n6, ENC_NA);\r\nproto_item_append_text(tree, ": %s", tvb_ether_to_str(tvb, s_offset));\r\ns_offset += 6;\r\nproto_tree_add_item(tree, hf_p2p_attr_gi_p2p_iface_addr, tvb, s_offset,\r\n6, ENC_NA);\r\ns_offset += 6;\r\nproto_tree_add_item(tree, hf_p2p_attr_gi_dev_capab, tvb, s_offset, 1,\r\nENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,\r\nhf_p2p_attr_gi_dev_capab_service_discovery, tvb,\r\ns_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,\r\nhf_p2p_attr_gi_dev_capab_client_discoverability,\r\ntvb, s_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,\r\nhf_p2p_attr_gi_dev_capab_concurrent_operation,\r\ntvb, s_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree,\r\nhf_p2p_attr_gi_dev_capab_infrastructure_managed,\r\ntvb, s_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_p2p_attr_gi_dev_capab_limit, tvb,\r\ns_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_p2p_attr_capab_invitation_procedure, tvb,\r\ns_offset, 1, ENC_BIG_ENDIAN);\r\ns_offset++;\r\nproto_tree_add_item(tree, hf_p2p_attr_gi_config_methods, tvb, s_offset,\r\n2, ENC_BIG_ENDIAN);\r\ns_offset += 2;\r\nproto_tree_add_item(tree, hf_p2p_attr_gi_pri_dev_type, tvb,\r\ns_offset, 8, ENC_NA);\r\nproto_tree_add_item(tree, hf_p2p_attr_gi_pri_dev_type_category,\r\ntvb, s_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_p2p_attr_gi_pri_dev_type_oui,\r\ntvb, s_offset + 2, 4, ENC_NA);\r\nproto_tree_add_item(tree, hf_p2p_attr_gi_pri_dev_type_subcategory,\r\ntvb, s_offset + 6, 2, ENC_BIG_ENDIAN);\r\ns_offset += 8;\r\nitem = proto_tree_add_item(tree, hf_p2p_attr_gi_num_sec_dev_types, tvb,\r\ns_offset, 1, ENC_BIG_ENDIAN);\r\nnum_sec = tvb_get_guint8(tvb, s_offset);\r\ns_offset++;\r\nleft = offset + 3 + slen - s_offset;\r\nif (left < 8 * num_sec) {\r\nexpert_add_info_format(pinfo, item, &ei_wifi_p2p_attr_len, "Invalid Secondary Device Type List");\r\nbreak;\r\n}\r\nwhile (num_sec > 0) {\r\nproto_tree_add_item(tree, hf_p2p_attr_gi_sec_dev_type,\r\ntvb, s_offset, 8, ENC_NA);\r\ns_offset += 8;\r\nnum_sec--;\r\n}\r\nitem = proto_tree_add_item(tree, hf_p2p_attr_gi_dev_name_type,\r\ntvb, s_offset, 2, ENC_BIG_ENDIAN);\r\nattr_type = tvb_get_ntohs(tvb, s_offset);\r\nif (attr_type != 0x1011) {\r\nexpert_add_info_format(pinfo, item, &ei_wifi_p2p_attr_dev_info_dev_name_type, "Incorrect Device Name attribute type");\r\n}\r\ns_offset += 2;\r\nitem = proto_tree_add_item(tree, hf_p2p_attr_gi_dev_name_len,\r\ntvb, s_offset, 2, ENC_BIG_ENDIAN);\r\nattr_len = tvb_get_ntohs(tvb, s_offset);\r\ns_offset += 2;\r\nif (attr_len > offset + 3 + slen - s_offset) {\r\nexpert_add_info_format(pinfo, item, &ei_wifi_p2p_attr_len, "Invalid Device Name attribute length");\r\nbreak;\r\n}\r\nnlen = next_offset - s_offset;\r\nif (nlen > 0)\r\nitem = proto_tree_add_item(tree, hf_p2p_attr_gi_dev_name,\r\ntvb, s_offset,\r\nnlen > attr_len ? attr_len : nlen,\r\nENC_ASCII|ENC_NA);\r\nif (nlen != attr_len) {\r\nexpert_add_info_format(pinfo, item, &ei_wifi_p2p_attr_len, "Invalid Device Name attribute");\r\n}\r\ns_offset = next_offset;\r\n}\r\n}\r\nstatic void dissect_invitation_flags(proto_item *tlv_root,\r\nproto_item *tlv_item,\r\ntvbuff_t *tvb, int offset)\r\n{\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_invitation_flags, tvb,\r\noffset + 3, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_invitation_flags_type, tvb,\r\noffset + 3, 1, ENC_BIG_ENDIAN);\r\nproto_item_append_text(tlv_item, ": Invitation Flags 0x%x",\r\ntvb_get_guint8(tvb, offset + 3));\r\n}\r\nstatic void dissect_manageability(proto_item *tlv_root,\r\nproto_item *tlv_item,\r\ntvbuff_t *tvb, int offset)\r\n{\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_manageability_bitmap, tvb,\r\noffset + 3, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_manageability_bitmap_mgmt, tvb,\r\noffset + 3, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_manageability_bitmap_cross_connect,\r\ntvb, offset + 3, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_manageability_bitmap_coex_opt, tvb,\r\noffset + 3, 1, ENC_BIG_ENDIAN);\r\nproto_item_append_text(tlv_item, ": Bitmap field 0x%x",\r\ntvb_get_guint8(tvb, offset + 3));\r\n}\r\nstatic void dissect_minor_reason_code(proto_item *tlv_root,\r\nproto_item *tlv_item,\r\ntvbuff_t *tvb, int offset)\r\n{\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_minor_reason_code, tvb,\r\noffset + 3, 1, ENC_BIG_ENDIAN);\r\nproto_item_append_text(tlv_item, ": %u (%s)",\r\ntvb_get_guint8(tvb, offset + 3),\r\nval_to_str(tvb_get_guint8(tvb, offset + 3),\r\np2p_minor_reason_codes,\r\n"Unknown Minor Reason Code (%u)"));\r\n}\r\nstatic void dissect_oob_group_owner_negotiation_channel(proto_item *tlv_root,\r\nproto_item *tlv_item,\r\ntvbuff_t *tvb, int offset)\r\n{\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_oob_group_owner_negotiation_channel_country, tvb,\r\noffset + 3, 3, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_oob_group_owner_negotiation_channel_oper_class, tvb,\r\noffset + 6, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_oob_group_owner_negotiation_channel_number, tvb,\r\noffset + 7, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_oob_group_owner_negotiation_channel_role_indication, tvb,\r\noffset + 7, 1, ENC_BIG_ENDIAN);\r\nproto_item_append_text(tlv_item, ": Operating Class %u "\r\n"Channel Number %u",\r\ntvb_get_guint8(tvb, offset + 6),\r\ntvb_get_guint8(tvb, offset + 7));\r\n}\r\nstatic void dissect_service_hash(proto_item *tlv_root,\r\nproto_item *tlv_item _U_,\r\ntvbuff_t *tvb, int offset, int slen)\r\n{\r\nint s_offset = offset + 3;\r\nwhile(s_offset < offset + 3 + slen) {\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_service_hash, tvb,\r\ns_offset, 6, ENC_NA);\r\ns_offset += 6;\r\n}\r\n}\r\nstatic void dissect_session_information(proto_item *tlv_root,\r\nproto_item *tlv_item _U_,\r\ntvbuff_t *tvb, int offset, int slen)\r\n{\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_session_information, tvb,\r\noffset+3, slen, ENC_ASCII|ENC_NA);\r\n}\r\nstatic void dissect_connection_capability(proto_item *tlv_root,\r\nproto_item *tlv_item _U_,\r\ntvbuff_t *tvb, int offset)\r\n{\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_connection_capability, tvb,\r\noffset+3, 1, ENC_NA);\r\n}\r\nstatic void dissect_advertisement_id(proto_item *tlv_root,\r\nproto_item *tlv_item _U_,\r\ntvbuff_t *tvb, int offset)\r\n{\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_advertisement_id, tvb,\r\noffset+3, 4, ENC_NA);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_advertisement_id_service_mac_address, tvb,\r\noffset+7, 6, ENC_NA);\r\n}\r\nstatic void dissect_advertised_service(proto_item *tlv_root,\r\nproto_item *tlv_item _U_,\r\ntvbuff_t *tvb, int offset, int slen)\r\n{\r\nproto_item *subtree;\r\nint s_offset = offset + 3;\r\nint len_service_name;\r\nsubtree = proto_tree_add_subtree(tlv_root, tvb, s_offset, slen,\r\nett_p2p_advertised_service, NULL, "Advertised Service");\r\nwhile (s_offset < offset + 3 + slen) {\r\nproto_tree_add_item(subtree, hf_p2p_attr_advertised_service_advertisement_id, tvb,\r\ns_offset, 4, ENC_BIG_ENDIAN);\r\ns_offset += 4;\r\nproto_tree_add_item(subtree, hf_p2p_attr_advertised_service_config_methods, tvb,\r\ns_offset, 2, ENC_BIG_ENDIAN);\r\ns_offset += 2;\r\nproto_tree_add_item(subtree, hf_p2p_attr_advertised_service_service_name_length, tvb,\r\ns_offset, 2, ENC_BIG_ENDIAN);\r\nlen_service_name = tvb_get_guint8(tvb, s_offset);\r\ns_offset += 1;\r\nproto_tree_add_item(subtree, hf_p2p_attr_advertised_service_service_name, tvb,\r\ns_offset, len_service_name, ENC_ASCII|ENC_NA);\r\ns_offset += len_service_name;\r\n}\r\n}\r\nstatic void dissect_session_id(proto_item *tlv_root,\r\nproto_item *tlv_item _U_,\r\ntvbuff_t *tvb, int offset)\r\n{\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_session_id, tvb,\r\noffset+3, 4, ENC_NA);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_session_id_session_mac_address, tvb,\r\noffset+7, 6, ENC_NA);\r\n}\r\nstatic void dissect_feature_capability(proto_item *tlv_root,\r\nproto_item *tlv_item _U_,\r\ntvbuff_t *tvb, int offset, int slen)\r\n{\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_feature_capability, tvb,\r\noffset+3, slen, ENC_NA);\r\n}\r\nstatic void dissect_persistent_group(proto_item *tlv_root,\r\nproto_item *tlv_item _U_,\r\ntvbuff_t *tvb, int offset, int slen)\r\n{\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_persistent_group_p2p_device_address, tvb,\r\noffset+3, 6, ENC_NA);\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_persistent_group_ssid, tvb,\r\noffset+3+6, slen+6, ENC_ASCII|ENC_NA);\r\n}\r\nvoid dissect_wifi_p2p_ie(packet_info *pinfo, proto_tree *tree, tvbuff_t *tvb,\r\nint offset, gint size)\r\n{\r\nguint16 slen = 0;\r\nguint8 stype = 0;\r\nproto_item *tlv_root, *tlv_item;\r\nwhile (size > 0) {\r\nif (size < 3) {\r\nexpert_add_info_format(pinfo, NULL, &ei_wifi_p2p_attr_len, "Packet too short for P2P IE");\r\nbreak;\r\n}\r\nstype = tvb_get_guint8(tvb, offset);\r\nslen = tvb_get_letohs(tvb, offset + 1);\r\ntlv_root = proto_tree_add_subtree(tree, tvb, offset, 3 + slen, ett_p2p_tlv, &tlv_item,\r\nval_to_str(stype, p2p_attr_types,\r\n"Unknown attribute type (%u)"));\r\nproto_tree_add_item(tlv_root, hf_p2p_attr_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_uint(tlv_root, hf_p2p_attr_len, tvb, offset + 1, 2,\r\nslen);\r\nswitch(stype) {\r\ncase P2P_ATTR_P2P_CAPABILITY:\r\ndissect_wifi_p2p_capability(tlv_root, tlv_item, tvb, offset);\r\nbreak;\r\ncase P2P_ATTR_P2P_DEVICE_ID:\r\ndissect_device_id(tlv_root, tlv_item, tvb, offset);\r\nbreak;\r\ncase P2P_ATTR_GROUP_OWNER_INTENT:\r\ndissect_group_owner_intent(tlv_root, tlv_item, tvb, offset);\r\nbreak;\r\ncase P2P_ATTR_STATUS:\r\ndissect_status(tlv_root, tlv_item, tvb, offset);\r\nbreak;\r\ncase P2P_ATTR_LISTEN_CHANNEL:\r\ndissect_listen_channel(tlv_root, tlv_item, tvb, offset);\r\nbreak;\r\ncase P2P_ATTR_OPERATING_CHANNEL:\r\ndissect_operating_channel(tlv_root, tlv_item, tvb, offset);\r\nbreak;\r\ncase P2P_ATTR_CHANNEL_LIST:\r\ndissect_channel_list(tlv_root, tvb, offset, slen);\r\nbreak;\r\ncase P2P_ATTR_P2P_DEVICE_INFO:\r\ndissect_wifi_p2p_device_info(pinfo, tlv_root, tvb, offset, slen);\r\nbreak;\r\ncase P2P_ATTR_CONFIGURATION_TIMEOUT:\r\ndissect_configuration_timeout(tlv_root, tlv_item, tvb, offset);\r\nbreak;\r\ncase P2P_ATTR_INTENDED_P2P_INTERFACE_ADDRESS:\r\ndissect_intended_interface_addr(tlv_root, tlv_item, tvb, offset);\r\nbreak;\r\ncase P2P_ATTR_EXTENDED_LISTEN_TIMING:\r\ndissect_extended_listen_timing(tlv_root, tlv_item, tvb, offset);\r\nbreak;\r\ncase P2P_ATTR_P2P_GROUP_ID:\r\ndissect_wifi_p2p_group_id(tlv_root, tlv_item, tvb, offset, slen);\r\nbreak;\r\ncase P2P_ATTR_P2P_GROUP_BSSID:\r\ndissect_wifi_p2p_group_bssid(pinfo, tlv_root, tlv_item, tvb, offset, slen);\r\nbreak;\r\ncase P2P_ATTR_NOTICE_OF_ABSENCE:\r\ndissect_notice_of_absence(pinfo, tlv_root, tlv_item, tvb, offset, slen);\r\nbreak;\r\ncase P2P_ATTR_P2P_GROUP_INFO:\r\ndissect_wifi_p2p_group_info(pinfo, tlv_root, tlv_item, tvb, offset,\r\nslen);\r\nbreak;\r\ncase P2P_ATTR_INVITATION_FLAGS:\r\ndissect_invitation_flags(tlv_root, tlv_item, tvb, offset);\r\nbreak;\r\ncase P2P_ATTR_P2P_MANAGEABILITY:\r\ndissect_manageability(tlv_root, tlv_item, tvb, offset);\r\nbreak;\r\ncase P2P_ATTR_MINOR_REASON_CODE:\r\ndissect_minor_reason_code(tlv_root, tlv_item, tvb, offset);\r\nbreak;\r\ncase P2P_ATTR_OOB_GROUP_OWNER_NEGOTIATION_CHANNEL:\r\ndissect_oob_group_owner_negotiation_channel(tlv_root, tlv_item, tvb, offset);\r\nbreak;\r\ncase P2P_ATTR_SERVICE_HASH:\r\ndissect_service_hash(tlv_root, tlv_item, tvb, offset, slen);\r\nbreak;\r\ncase P2P_ATTR_SESSION_INFORMATION_DATA_INFO:\r\ndissect_session_information(tlv_root, tlv_item, tvb, offset, slen);\r\nbreak;\r\ncase P2P_ATTR_CONNECTION_CAPABILITY_INFO:\r\ndissect_connection_capability(tlv_root, tlv_item, tvb, offset);\r\nbreak;\r\ncase P2P_ATTR_ADVERTISEMENT_ID_INFO:\r\ndissect_advertisement_id(tlv_root, tlv_item, tvb, offset);\r\nbreak;\r\ncase P2P_ATTR_ADVERTISED_SERVICE_INFO:\r\ndissect_advertised_service(tlv_root, tlv_item, tvb, offset, slen);\r\nbreak;\r\ncase P2P_ATTR_SESSION_ID_INFO:\r\ndissect_session_id(tlv_root, tlv_item, tvb, offset);\r\nbreak;\r\ncase P2P_ATTR_FEATURE_CAPABILITY:\r\ndissect_feature_capability(tlv_root, tlv_item, tvb, offset, slen);\r\nbreak;\r\ncase P2P_ATTR_PERSISTENT_GROUP_INFO:\r\ndissect_persistent_group(tlv_root, tlv_item, tvb, offset, slen);\r\nbreak;\r\n}\r\noffset += 3 + slen;\r\nsize -= 3 + slen;\r\n}\r\n}\r\nint dissect_wifi_p2p_public_action(packet_info *pinfo, proto_tree *tree,\r\ntvbuff_t *tvb, int offset)\r\n{\r\nguint8 subtype;\r\nproto_tree_add_item(tree, hf_p2p_public_action_subtype, tvb, offset, 1,\r\nENC_BIG_ENDIAN);\r\nsubtype = tvb_get_guint8(tvb, offset);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ", P2P - %s",\r\nval_to_str(subtype, p2p_public_action_subtypes,\r\n"Unknown (%u)"));\r\noffset++;\r\nproto_tree_add_item(tree, hf_p2p_public_action_dialog_token, tvb, offset, 1,\r\nENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset;\r\n}\r\nint dissect_wifi_p2p_action(proto_tree *tree, tvbuff_t *tvb, int offset)\r\n{\r\nproto_tree_add_item(tree, hf_p2p_action_subtype, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item(tree, hf_p2p_action_dialog_token, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nreturn offset;\r\n}\r\nvoid dissect_wifi_p2p_anqp(packet_info *pinfo, proto_tree *tree, tvbuff_t *tvb,\r\nint offset, gboolean request)\r\n{\r\nproto_item *item;\r\nitem = proto_tree_add_item(tree, hf_p2p_anqp_service_update_indicator, tvb,\r\noffset, 2, ENC_LITTLE_ENDIAN);\r\noffset += 2;\r\nwhile (tvb_reported_length_remaining(tvb, offset) >= (request ? 4 : 5)) {\r\nguint16 len;\r\nproto_tree *tlv;\r\nguint8 type, id, sd_proto;\r\nlen = tvb_get_letohs(tvb, offset);\r\nif (len < 2) {\r\nexpert_add_info_format(pinfo, item, &ei_wifi_p2p_anqp_length, "Too short Service TLV field");\r\nreturn;\r\n}\r\nif (len > tvb_reported_length_remaining(tvb, offset + 2)) {\r\nexpert_add_info_format(pinfo, item, &ei_wifi_p2p_anqp_length, "Too short frame for Service TLV field");\r\nreturn;\r\n}\r\ntype = tvb_get_guint8(tvb, offset + 2);\r\nid = tvb_get_guint8(tvb, offset + 3);\r\ntlv = proto_tree_add_subtree_format(tree, tvb, offset, 2 + len,\r\nett_p2p_service_tlv, &item, "Service TLV (Transaction ID: %u Type: %s)",\r\nid, val_to_str(type, p2p_service_protocol_types,\r\n"Unknown (%u)"));\r\nproto_tree_add_item(tlv, hf_p2p_anqp_length, tvb, offset, 2, ENC_LITTLE_ENDIAN);\r\noffset += 2;\r\nsd_proto = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(tlv, hf_p2p_anqp_service_protocol_type, tvb,\r\noffset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv, hf_p2p_anqp_service_transaction_id, tvb,\r\noffset + 1, 1, ENC_BIG_ENDIAN);\r\nif (request) {\r\nproto_tree_add_item(tlv, hf_p2p_anqp_query_data, tvb,\r\noffset + 2, len - 2, ENC_NA);\r\n} else {\r\nproto_tree_add_item(tlv, hf_p2p_anqp_status_code, tvb,\r\noffset + 2, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv, hf_p2p_anqp_response_data, tvb,\r\noffset + 3, len - 3, ENC_NA);\r\nif (sd_proto == 4)\r\ndissect_wifi_display_ie(pinfo, tlv, tvb, offset + 3, len - 3);\r\n}\r\noffset += len;\r\n}\r\nif (tvb_reported_length_remaining(tvb, offset) > 0) {\r\nexpert_add_info(pinfo, item, &ei_wifi_p2p_anqp_unexpected_padding);\r\n}\r\n}\r\nvoid\r\nproto_register_p2p(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_p2p_attr_type,\r\n{ "Attribute Type", "wifi_p2p.type",\r\nFT_UINT8, BASE_DEC, VALS(p2p_attr_types), 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_len,\r\n{ "Attribute Length", "wifi_p2p.length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n#if 0\r\n{ &hf_p2p_attr_capab,\r\n{ "P2P Capability", "wifi_p2p.p2p_capability",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n#endif\r\n{ &hf_p2p_attr_capab_device,\r\n{ "Device Capability Bitmap",\r\n"wifi_p2p.p2p_capability.device_capability",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_capab_device_service_discovery,\r\n{ "Service Discovery",\r\n"wifi_p2p.p2p_capability.device_capability.service_discovery",\r\nFT_UINT8, BASE_HEX, NULL, P2P_DEV_CAPAB_SERVICE_DISCOVERY, NULL, HFILL\r\n}},\r\n{ &hf_p2p_attr_capab_device_client_discoverability,\r\n{ "P2P Client Discoverability",\r\n"wifi_p2p.p2p_capability.device_capability.client_discoverability",\r\nFT_UINT8, BASE_HEX, NULL, P2P_DEV_CAPAB_P2P_CLIENT_DISCOVERABILITY,\r\nNULL, HFILL\r\n}},\r\n{ &hf_p2p_attr_capab_device_concurrent_operation,\r\n{ "Concurrent Operation",\r\n"wifi_p2p.p2p_capability.device_capability.concurrent_operation",\r\nFT_UINT8, BASE_HEX, NULL, P2P_DEV_CAPAB_CONCURRENT_OPERATION, NULL,\r\nHFILL\r\n}},\r\n{ &hf_p2p_attr_capab_device_infrastructure_managed,\r\n{ "P2P Infrastructure Managed",\r\n"wifi_p2p.p2p_capability.device_capability.infrastructure_managed",\r\nFT_UINT8, BASE_HEX, NULL, P2P_DEV_CAPAB_P2P_INFRASTRUCTURE_MANAGED,\r\nNULL, HFILL\r\n}},\r\n{ &hf_p2p_attr_capab_device_limit,\r\n{ "P2P Device Limit",\r\n"wifi_p2p.p2p_capability.device_capability.device_limit",\r\nFT_UINT8, BASE_HEX, NULL, P2P_DEV_CAPAB_P2P_DEVICE_LIMIT, NULL, HFILL\r\n}},\r\n{ &hf_p2p_attr_capab_invitation_procedure,\r\n{ "P2P Invitation Procedure",\r\n"wifi_p2p.p2p_capability.device_capability.invitation_procedure",\r\nFT_UINT8, BASE_HEX, NULL, P2P_DEV_CAPAB_P2P_INVITATION_PROCEDURE, NULL,\r\nHFILL\r\n}},\r\n{ &hf_p2p_attr_capab_group,\r\n{ "Group Capability Bitmap", "wifi_p2p.p2p_capability.group_capability",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_capab_group_owner,\r\n{ "P2P Group Owner",\r\n"wifi_p2p.p2p_capability.group_capability.group_owner",\r\nFT_UINT8, BASE_HEX, NULL, P2P_GROUP_CAPAB_P2P_GROUP_OWNER, NULL, HFILL\r\n}},\r\n{ &hf_p2p_attr_capab_group_persistent,\r\n{ "Persistent P2P Group",\r\n"wifi_p2p.p2p_capability.group_capability.persistent_group",\r\nFT_UINT8, BASE_HEX, NULL, P2P_GROUP_CAPAB_PERSISTENT_P2P_GROUP, NULL,\r\nHFILL }},\r\n{ &hf_p2p_attr_capab_group_limit,\r\n{ "P2P Group Limit",\r\n"wifi_p2p.p2p_capability.group_capability.group_limit",\r\nFT_UINT8, BASE_HEX, NULL, P2P_GROUP_CAPAB_P2P_GROUP_LIMIT, NULL, HFILL\r\n}},\r\n{ &hf_p2p_attr_capab_group_intra_bss_distribution,\r\n{ "Intra-BSS Distribution",\r\n"wifi_p2p.p2p_capability.group_capability.intra_bss_distribution",\r\nFT_UINT8, BASE_HEX, NULL, P2P_GROUP_CAPAB_INTRA_BSS_DISTRIBUTION, NULL,\r\nHFILL }},\r\n{ &hf_p2p_attr_capab_group_cross_connection,\r\n{ "Cross Connection",\r\n"wifi_p2p.p2p_capability.group_capability.cross_connection",\r\nFT_UINT8, BASE_HEX, NULL, P2P_GROUP_CAPAB_CROSS_CONNECTION, NULL, HFILL\r\n}},\r\n{ &hf_p2p_attr_capab_group_persistent_reconnect,\r\n{ "Persistent Reconnect",\r\n"wifi_p2p.p2p_capability.group_capability.persistent_reconnect",\r\nFT_UINT8, BASE_HEX, NULL, P2P_GROUP_CAPAB_PERSISTENT_RECONNECT, NULL,\r\nHFILL }},\r\n{ &hf_p2p_attr_capab_group_group_formation,\r\n{ "Group Formation",\r\n"wifi_p2p.p2p_capability.group_capability.group_formation",\r\nFT_UINT8, BASE_HEX, NULL, P2P_GROUP_CAPAB_GROUP_FORMATION, NULL, HFILL\r\n}},\r\n{ &hf_p2p_attr_device_id,\r\n{ "Device ID", "wifi_p2p.device_id",\r\nFT_ETHER, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_status,\r\n{ "Status Code", "wifi_p2p.status",\r\nFT_UINT8, BASE_DEC, VALS(p2p_status_codes), 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_go_intent,\r\n{ "Group Owner Intent", "wifi_p2p.go_intent",\r\nFT_UINT8, BASE_DEC, NULL, 0x1e, NULL, HFILL }},\r\n{ &hf_p2p_attr_go_intent_tie_breaker,\r\n{ "Group Owner Intent Tie Breaker", "wifi_p2p.go_intent_tie_breaker",\r\nFT_UINT8, BASE_DEC, NULL, 0x01, NULL, HFILL }},\r\n#if 0\r\n{ &hf_p2p_attr_listen_channel,\r\n{ "Listen Channel", "wifi_p2p.listen_channel",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n#endif\r\n{ &hf_p2p_attr_listen_channel_country,\r\n{ "Country String", "wifi_p2p.listen_channel.country_string",\r\nFT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_listen_channel_oper_class,\r\n{ "Operating Class", "wifi_p2p.listen_channel.operating_class",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_listen_channel_number,\r\n{ "Channel Number", "wifi_p2p.listen_channel.channel_number",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n#if 0\r\n{ &hf_p2p_attr_operating_channel,\r\n{ "Operating Channel", "wifi_p2p.operating_channel",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n#endif\r\n{ &hf_p2p_attr_operating_channel_country,\r\n{ "Country String", "wifi_p2p.operating_channel.country_string",\r\nFT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_operating_channel_oper_class,\r\n{ "Operating Class", "wifi_p2p.operating_channel.operating_class",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_operating_channel_number,\r\n{ "Channel Number", "wifi_p2p.operating_channel.channel_number",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n#if 0\r\n{ &hf_p2p_attr_channel_list,\r\n{ "Channel List", "wifi_p2p.channel_list",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n#endif\r\n{ &hf_p2p_attr_channel_list_country,\r\n{ "Country String", "wifi_p2p.channel_list.country_string",\r\nFT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_channel_list_oper_class,\r\n{ "Operating Class", "wifi_p2p.channel_list.operating_class",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_channel_list_num_chan,\r\n{ "Number of Channels", "wifi_p2p.channel_list.num_chan",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_channel_list_chan,\r\n{ "Channel List", "wifi_p2p.channel_list.channel_list",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n#if 0\r\n{ &hf_p2p_attr_dev_info,\r\n{ "Device Info", "wifi_p2p.dev_info",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n#endif\r\n{ &hf_p2p_attr_dev_info_p2p_dev_addr,\r\n{ "P2P Device address", "wifi_p2p.dev_info.p2p_dev_addr",\r\nFT_ETHER, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_dev_info_pri_dev_type,\r\n{ "Primary Device Type", "wifi_p2p.dev_info.pri_dev_type",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_dev_info_pri_dev_type_category,\r\n{ "Primary Device Type: Category",\r\n"wifi_p2p.dev_info.pri_dev_type.category",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_dev_info_pri_dev_type_oui,\r\n{ "Primary Device Type: OUI", "wifi_p2p.dev_info.pri_dev_type.oui",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_dev_info_pri_dev_type_subcategory,\r\n{ "Primary Device Type: Subcategory",\r\n"wifi_p2p.dev_info.pri_dev_type.subcategory",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_dev_info_num_sec,\r\n{ "Number of Secondary Device Types", "wifi_p2p.dev_info.num_sec",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_dev_info_sec_dev_type,\r\n{ "Secondary Device Type", "wifi_p2p.dev_info.sec_dev_type",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_dev_info_dev_name_type,\r\n{ "Device Name attribute type", "wifi_p2p.dev_info.dev_name_type",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_dev_info_dev_name_len,\r\n{ "Device Name attribute length", "wifi_p2p.dev_info.dev_name_len",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_dev_info_dev_name,\r\n{ "Device Name", "wifi_p2p.dev_info.dev_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_dev_info_config_methods,\r\n{ "Config Methods", "wifi_p2p.dev_info.config_methods",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n{ &hf_p2p_attr_dev_info_config_methods_usba,\r\n{ "USBA (Flash Drive)", "wifi_p2p.dev_info.config_methods.usba",\r\nFT_UINT16, BASE_HEX, NULL, WPS_CONF_METH_USBA, NULL, HFILL }},\r\n{ &hf_p2p_attr_dev_info_config_methods_ethernet,\r\n{ "Ethernet", "wifi_p2p.dev_info.config_methods.ethernet",\r\nFT_UINT16, BASE_HEX, NULL, WPS_CONF_METH_ETHERNET, NULL, HFILL }},\r\n{ &hf_p2p_attr_dev_info_config_methods_label,\r\n{ "Label", "wifi_p2p.dev_info.config_methods.label",\r\nFT_UINT16, BASE_HEX, NULL, WPS_CONF_METH_LABEL, NULL, HFILL }},\r\n{ &hf_p2p_attr_dev_info_config_methods_display,\r\n{ "Display", "wifi_p2p.dev_info.config_methods.display",\r\nFT_UINT16, BASE_HEX, NULL, WPS_CONF_METH_DISPLAY, NULL, HFILL }},\r\n{ &hf_p2p_attr_dev_info_config_methods_ext_nfc_token,\r\n{ "External NFC Token", "wifi_p2p.dev_info.config_methods.ext_nfc_token",\r\nFT_UINT16, BASE_HEX, NULL, WPS_CONF_METH_EXT_NFC_TOKEN, NULL, HFILL }},\r\n{ &hf_p2p_attr_dev_info_config_methods_int_nfc_token,\r\n{ "Integrated NFC Token",\r\n"wifi_p2p.dev_info.config_methods.int_nfc_token",\r\nFT_UINT16, BASE_HEX, NULL, WPS_CONF_METH_INT_NFC_TOKEN, NULL, HFILL }},\r\n{ &hf_p2p_attr_dev_info_config_methods_nfc_interface,\r\n{ "NFC Interface", "wifi_p2p.dev_info.config_methods.nfc_interface",\r\nFT_UINT16, BASE_HEX, NULL, WPS_CONF_METH_NFC_INTERFACE, NULL, HFILL }},\r\n{ &hf_p2p_attr_dev_info_config_methods_pushbutton,\r\n{ "PushButton", "wifi_p2p.dev_info.config_methods.pushbutton",\r\nFT_UINT16, BASE_HEX, NULL, WPS_CONF_METH_PUSHBUTTON, NULL, HFILL }},\r\n{ &hf_p2p_attr_dev_info_config_methods_keypad,\r\n{ "Keypad", "wifi_p2p.dev_info.config_methods.keypad",\r\nFT_UINT16, BASE_HEX, NULL, WPS_CONF_METH_KEYPAD, NULL, HFILL }},\r\n{ &hf_p2p_attr_config_timeout_go,\r\n{ "GO Configuration Timeout", "wifi_p2p.config_timeout.go",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_config_timeout_client,\r\n{ "Client Configuration Timeout", "wifi_p2p.config_timeout.client",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_intended_interface_addr,\r\n{ "P2P Interface Address", "wifi_p2p.intended_interface_addr",\r\nFT_ETHER, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_extended_listen_timing_period,\r\n{ "Availability Period", "wifi_p2p.extended_listen_timing.period",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_extended_listen_timing_interval,\r\n{ "Availability Interval", "wifi_p2p.extended_listen_timing.interval",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_p2p_group_id_dev_addr,\r\n{ "P2P Device address", "wifi_p2p.p2p_group_id.p2p_dev_addr",\r\nFT_ETHER, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_p2p_group_id_ssid,\r\n{ "SSID", "wifi_p2p.p2p_group_id.ssid",\r\nFT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_p2p_group_bssid,\r\n{ "BSSID", "wifi_p2p.p2p_group_bssid",\r\nFT_ETHER, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_noa_index,\r\n{ "Index", "wifi_p2p.noa.index",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_noa_params,\r\n{ "CTWindow and OppPS Parameters", "wifi_p2p.noa.params",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_noa_params_opp_ps,\r\n{ "OppPS", "wifi_p2p.noa.params.opp_ps",\r\nFT_UINT8, BASE_DEC, NULL, 0x80, NULL, HFILL }},\r\n{ &hf_p2p_attr_noa_params_ctwindow,\r\n{ "CTWindow", "wifi_p2p.noa.params.ctwindow",\r\nFT_UINT8, BASE_DEC, NULL, 0x7f, NULL, HFILL }},\r\n{ &hf_p2p_attr_noa_count_type,\r\n{ "Count/Type", "wifi_p2p.noa.count_type",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_noa_duration,\r\n{ "Duration", "wifi_p2p.noa.duration",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_noa_interval,\r\n{ "Interval", "wifi_p2p.noa.interval",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_noa_start_time,\r\n{ "Start Time", "wifi_p2p.noa.start_time",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n#if 0\r\n{ &hf_p2p_attr_gi,\r\n{ "Device Info", "wifi_p2p.group_info",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n#endif\r\n{ &hf_p2p_attr_gi_length,\r\n{ "P2P Client Info Descriptor Length", "wifi_p2p.group_info.length",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_gi_p2p_dev_addr,\r\n{ "P2P Device address", "wifi_p2p.group_info.p2p_dev_addr",\r\nFT_ETHER, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_gi_p2p_iface_addr,\r\n{ "P2P Interface address", "wifi_p2p.group_info.p2p_interface_addr",\r\nFT_ETHER, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_gi_dev_capab,\r\n{ "Device Capability Bitmap", "wifi_p2p.group_info.device_capability",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_gi_dev_capab_service_discovery,\r\n{ "Service Discovery",\r\n"wifi_p2p.group_info.device_capability.service_discovery",\r\nFT_UINT8, BASE_HEX, NULL, P2P_DEV_CAPAB_SERVICE_DISCOVERY, NULL, HFILL\r\n}},\r\n{ &hf_p2p_attr_gi_dev_capab_client_discoverability,\r\n{ "P2P Client Discoverability",\r\n"wifi_p2p.group_info.device_capability.client_discoverability",\r\nFT_UINT8, BASE_HEX, NULL, P2P_DEV_CAPAB_P2P_CLIENT_DISCOVERABILITY,\r\nNULL, HFILL\r\n}},\r\n{ &hf_p2p_attr_gi_dev_capab_concurrent_operation,\r\n{ "Concurrent Operation",\r\n"wifi_p2p.group_info.device_capability.concurrent_operation",\r\nFT_UINT8, BASE_HEX, NULL, P2P_DEV_CAPAB_CONCURRENT_OPERATION, NULL,\r\nHFILL\r\n}},\r\n{ &hf_p2p_attr_gi_dev_capab_infrastructure_managed,\r\n{ "P2P Infrastructure Managed",\r\n"wifi_p2p.group_info.device_capability.infrastructure_managed",\r\nFT_UINT8, BASE_HEX, NULL, P2P_DEV_CAPAB_P2P_INFRASTRUCTURE_MANAGED,\r\nNULL, HFILL\r\n}},\r\n{ &hf_p2p_attr_gi_dev_capab_limit,\r\n{ "P2P Device Limit",\r\n"wifi_p2p.group_info.device_capability.device_limit",\r\nFT_UINT8, BASE_HEX, NULL, P2P_DEV_CAPAB_P2P_DEVICE_LIMIT, NULL, HFILL }},\r\n#if 0\r\n{ &hf_p2p_attr_gi_dev_capab_invitation_procedure,\r\n{ "P2P Invitation Procedure",\r\n"wifi_p2p.group_info.device_capability.invitation_procedure",\r\nFT_UINT8, BASE_HEX, NULL, P2P_DEV_CAPAB_P2P_INVITATION_PROCEDURE, NULL,\r\nHFILL }},\r\n#endif\r\n{ &hf_p2p_attr_gi_pri_dev_type,\r\n{ "Primary Device Type", "wifi_p2p.group_info.pri_dev_type",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_gi_pri_dev_type_category,\r\n{ "Primary Device Type: Category",\r\n"wifi_p2p.group_info.pri_dev_type.category",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_gi_pri_dev_type_oui,\r\n{ "Primary Device Type: OUI", "wifi_p2p.group_info.pri_dev_type.oui",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_gi_pri_dev_type_subcategory,\r\n{ "Primary Device Type: Subcategory",\r\n"wifi_p2p.group_info.pri_dev_type.subcategory",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_gi_num_sec_dev_types,\r\n{ "Number of Secondary Device Types", "wifi_p2p.group_info.num_sec",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_gi_sec_dev_type,\r\n{ "Secondary Device Type", "wifi_p2p.group_info.sec_dev_type",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_gi_dev_name_type,\r\n{ "Device Name attribute type", "wifi_p2p.group_info.dev_name_type",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_gi_dev_name_len,\r\n{ "Device Name attribute length", "wifi_p2p.group_info.dev_name_len",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_gi_dev_name,\r\n{ "Device Name", "wifi_p2p.group_info.dev_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_gi_config_methods,\r\n{ "Config Methods", "wifi_p2p.group_info.config_methods",\r\nFT_UINT16, BASE_HEX, NULL, 0, NULL, HFILL }},\r\n#if 0\r\n{ &hf_p2p_attr_gi_config_methods_usba,\r\n{ "USBA (Flash Drive)", "wifi_p2p.group_info.config_methods.usba",\r\nFT_UINT16, BASE_HEX, NULL, WPS_CONF_METH_USBA, NULL, HFILL }},\r\n#endif\r\n#if 0\r\n{ &hf_p2p_attr_gi_config_methods_ethernet,\r\n{ "Ethernet", "wifi_p2p.group_info.config_methods.ethernet",\r\nFT_UINT16, BASE_HEX, NULL, WPS_CONF_METH_ETHERNET, NULL, HFILL }},\r\n#endif\r\n#if 0\r\n{ &hf_p2p_attr_gi_config_methods_label,\r\n{ "Label", "wifi_p2p.group_info.config_methods.label",\r\nFT_UINT16, BASE_HEX, NULL, WPS_CONF_METH_LABEL, NULL, HFILL }},\r\n#endif\r\n#if 0\r\n{ &hf_p2p_attr_gi_config_methods_display,\r\n{ "Display", "wifi_p2p.group_info.config_methods.display",\r\nFT_UINT16, BASE_HEX, NULL, WPS_CONF_METH_DISPLAY, NULL, HFILL }},\r\n#endif\r\n#if 0\r\n{ &hf_p2p_attr_gi_config_methods_ext_nfc_token,\r\n{ "External NFC Token",\r\n"wifi_p2p.group_info.config_methods.ext_nfc_token",\r\nFT_UINT16, BASE_HEX, NULL, WPS_CONF_METH_EXT_NFC_TOKEN, NULL, HFILL }},\r\n#endif\r\n#if 0\r\n{ &hf_p2p_attr_gi_config_methods_int_nfc_token,\r\n{ "Integrated NFC Token",\r\n"wifi_p2p.group_info.config_methods.int_nfc_token",\r\nFT_UINT16, BASE_HEX, NULL, WPS_CONF_METH_INT_NFC_TOKEN, NULL, HFILL }},\r\n#endif\r\n#if 0\r\n{ &hf_p2p_attr_gi_config_methods_nfc_interface,\r\n{ "NFC Interface", "wifi_p2p.group_info.config_methods.nfc_interface",\r\nFT_UINT16, BASE_HEX, NULL, WPS_CONF_METH_NFC_INTERFACE, NULL, HFILL }},\r\n#endif\r\n#if 0\r\n{ &hf_p2p_attr_gi_config_methods_pushbutton,\r\n{ "PushButton", "wifi_p2p.group_info.config_methods.pushbutton",\r\nFT_UINT16, BASE_HEX, NULL, WPS_CONF_METH_PUSHBUTTON, NULL, HFILL }},\r\n#endif\r\n#if 0\r\n{ &hf_p2p_attr_gi_config_methods_keypad,\r\n{ "Keypad", "wifi_p2p.group_info.config_methods.keypad",\r\nFT_UINT16, BASE_HEX, NULL, WPS_CONF_METH_KEYPAD, NULL, HFILL }},\r\n#endif\r\n{ &hf_p2p_attr_invitation_flags,\r\n{ "Invitation Flags", "wifi_p2p.invitation_flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_invitation_flags_type,\r\n{ "Invitation Type", "wifi_p2p.invitation_flags.type",\r\nFT_UINT8, BASE_HEX, VALS(invitation_types), 0x01, NULL, HFILL }},\r\n{ &hf_p2p_attr_manageability_bitmap,\r\n{ "Manageability Bitmap field", "wifi_p2p.manageability.bitmap",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_manageability_bitmap_mgmt,\r\n{ "P2P Device Management", "wifi_p2p.manageability.bitmap.dev_mgmt",\r\nFT_UINT8, BASE_HEX, NULL, 0x01, NULL, HFILL }},\r\n{ &hf_p2p_attr_manageability_bitmap_cross_connect,\r\n{ "Cross Connection Permitted",\r\n"wifi_p2p.manageability.bitmap.cross_connect",\r\nFT_UINT8, BASE_HEX, NULL, 0x02, NULL, HFILL }},\r\n{ &hf_p2p_attr_manageability_bitmap_coex_opt,\r\n{ "Coexistence Optional", "wifi_p2p.manageability.bitmap.coex_opt",\r\nFT_UINT8, BASE_HEX, NULL, 0x04, NULL, HFILL }},\r\n{ &hf_p2p_attr_minor_reason_code,\r\n{ "Minor Reason Code", "wifi_p2p.minor_reason_code",\r\nFT_UINT8, BASE_DEC, VALS(p2p_minor_reason_codes), 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_oob_group_owner_negotiation_channel_country,\r\n{ "Country String", "wifi_p2p.oob_group_owner_negotiation_channel.country_string",\r\nFT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_oob_group_owner_negotiation_channel_oper_class,\r\n{ "Operating Class", "wifi_p2p.oob_group_owner_negotiation_channel.operating_class",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_oob_group_owner_negotiation_channel_number,\r\n{ "Channel Number", "wifi_p2p.oob_group_owner_negotiation_channel.channel_number",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_oob_group_owner_negotiation_channel_role_indication,\r\n{ "Role Indication", "wifi_p2p.oob_group_owner_negotiation_channel.role_indication",\r\nFT_UINT8, BASE_DEC, VALS(p2p_oob_group_owner_negotiation_channel_role_indication_vals), 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_service_hash,\r\n{ "Service Hash", "wifi_p2p.service_hash",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_session_information,\r\n{ "Service Information", "wifi_p2p.session_information",\r\nFT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_connection_capability,\r\n{ "Connection Capability Information", "wifi_p2p.connection_capability",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_advertisement_id,\r\n{ "Advertisement ID", "wifi_p2p.advertisement_id",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_advertisement_id_service_mac_address,\r\n{ "Service MAC Address", "wifi_p2p.advertisement_id.service_mac_address",\r\nFT_ETHER, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_advertised_service_advertisement_id,\r\n{ "Advertisement ID", "wifi_p2p.advertised_service.advertisement_id",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_advertised_service_config_methods,\r\n{ "Service Config Methods", "wifi_p2p.avertised_service.config_methods",\r\nFT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_advertised_service_service_name_length,\r\n{ "Service Name Length", "wifi_p2p.advertised_service.service_name_length",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_advertised_service_service_name,\r\n{ "Service Name", "wifi_p2p.advertised_service.service_name",\r\nFT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_session_id,\r\n{ "Session ID", "wifi_p2p.session_id",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_session_id_session_mac_address,\r\n{ "Session MAC Address", "wifi_p2p.session_id.session_mac_address",\r\nFT_ETHER, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_feature_capability,\r\n{ "Feature Capability", "wifi_p2p.feature_capability",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_persistent_group_p2p_device_address,\r\n{ "P2P device address", "wifi_p2p.persistent_group.p2p_device_address",\r\nFT_ETHER, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_attr_persistent_group_ssid,\r\n{ "SSID", "wifi_p2p.persistent_group.ssid",\r\nFT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_anqp_service_update_indicator,\r\n{ "Service Update Indicator", "wifi_p2p.anqp.service_update_indicator",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_anqp_length,\r\n{ "Length", "wifi_p2p.anqp.length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_anqp_service_protocol_type,\r\n{ "Service Protocol Type", "wifi_p2p.anqp.service_protocol_type",\r\nFT_UINT8, BASE_DEC, VALS(p2p_service_protocol_types), 0x0, NULL,\r\nHFILL }},\r\n{ &hf_p2p_anqp_service_transaction_id,\r\n{ "Service Transaction ID", "wifi_p2p.anqp.service_transaction_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_anqp_query_data,\r\n{ "Query Data", "wifi_p2p.anqp.query_data",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_anqp_status_code,\r\n{ "Status Code", "wifi_p2p.anqp.status_code",\r\nFT_UINT8, BASE_DEC, VALS(p2p_sd_status_codes), 0x0,\r\n"Service Query Status Code", HFILL }},\r\n{ &hf_p2p_anqp_response_data,\r\n{ "Response Data", "wifi_p2p.anqp.response_data",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_action_subtype,\r\n{ "P2P Action Subtype", "wifi_p2p.action.subtype",\r\nFT_UINT8, BASE_DEC, VALS(p2p_action_subtypes), 0x0, NULL, HFILL }},\r\n{ &hf_p2p_action_dialog_token,\r\n{ "P2P Action Dialog Token", "wifi_p2p.action.dialog_token",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_p2p_public_action_subtype,\r\n{ "P2P Public Action Subtype", "wifi_p2p.public_action.subtype",\r\nFT_UINT8, BASE_DEC, VALS(p2p_public_action_subtypes), 0x0, NULL, HFILL\r\n}},\r\n{ &hf_p2p_public_action_dialog_token,\r\n{ "P2P Public Action Dialog Token",\r\n"wifi_p2p.public_action.dialog_token",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL }}\r\n};\r\nstatic gint *ett[] = {\r\n&ett_p2p_tlv,\r\n&ett_p2p_service_tlv,\r\n&ett_p2p_advertised_service,\r\n&ett_p2p_client_descr\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_wifi_p2p_attr_dev_info_dev_name_type, { "wifi_p2p.dev_info.dev_name_type.invalid", PI_MALFORMED, PI_ERROR, "Incorrect Device Name attribute type", EXPFILL }},\r\n{ &ei_wifi_p2p_attr_len, { "wifi_p2p.length.invalid", PI_MALFORMED, PI_ERROR, "Invalid attribute length", EXPFILL }},\r\n{ &ei_wifi_p2p_anqp_length, { "wifi_p2p.anqp.length.invalid", PI_MALFORMED, PI_ERROR, "Invalid anqp_length", EXPFILL }},\r\n{ &ei_wifi_p2p_anqp_unexpected_padding, { "wifi_p2p.anqp.unexpected_padding", PI_MALFORMED, PI_ERROR, "Unexpected padding in the end of P2P ANQP", EXPFILL }},\r\n};\r\nexpert_module_t* expert_p2p;\r\nproto_p2p = proto_register_protocol("Wi-Fi Peer-to-Peer", "Wi-Fi P2P", "wifi_p2p");\r\nproto_register_field_array(proto_p2p, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_p2p = expert_register_protocol(proto_p2p);\r\nexpert_register_field_array(expert_p2p, ei, array_length(ei));\r\n}
