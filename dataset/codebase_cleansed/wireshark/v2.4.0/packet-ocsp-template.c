static int\r\ndissect_ocsp_request(tvbuff_t *tvb, packet_info *pinfo, proto_tree *parent_tree, void *data _U_)\r\n{\r\nproto_item *item=NULL;\r\nproto_tree *tree=NULL;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "OCSP");\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Request");\r\nif(parent_tree){\r\nitem=proto_tree_add_item(parent_tree, proto_ocsp, tvb, 0, -1, ENC_NA);\r\ntree = proto_item_add_subtree(item, ett_ocsp);\r\n}\r\nreturn dissect_ocsp_OCSPRequest(FALSE, tvb, 0, &asn1_ctx, tree, -1);\r\n}\r\nstatic int\r\ndissect_ocsp_response(tvbuff_t *tvb, packet_info *pinfo, proto_tree *parent_tree, void *data _U_)\r\n{\r\nproto_item *item=NULL;\r\nproto_tree *tree=NULL;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "OCSP");\r\ncol_set_str(pinfo->cinfo, COL_INFO, "Response");\r\nif(parent_tree){\r\nitem=proto_tree_add_item(parent_tree, proto_ocsp, tvb, 0, -1, ENC_NA);\r\ntree = proto_item_add_subtree(item, ett_ocsp);\r\n}\r\nreturn dissect_ocsp_OCSPResponse(FALSE, tvb, 0, &asn1_ctx, tree, -1);\r\n}\r\nvoid proto_register_ocsp(void) {\r\nstatic hf_register_info hf[] = {\r\n{ &hf_ocsp_responseType_id,\r\n{ "ResponseType Id", "ocsp.responseType.id",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n#include "packet-ocsp-hfarr.c"\r\n};\r\nstatic gint *ett[] = {\r\n&ett_ocsp,\r\n#include "packet-ocsp-ettarr.c"\r\n};\r\nproto_ocsp = proto_register_protocol(PNAME, PSNAME, PFNAME);\r\nproto_register_field_array(proto_ocsp, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid proto_reg_handoff_ocsp(void) {\r\ndissector_handle_t ocsp_request_handle;\r\ndissector_handle_t ocsp_response_handle;\r\nocsp_request_handle = create_dissector_handle(dissect_ocsp_request, proto_ocsp);\r\nocsp_response_handle = create_dissector_handle(dissect_ocsp_response, proto_ocsp);\r\ndissector_add_string("media_type", "application/ocsp-request", ocsp_request_handle);\r\ndissector_add_string("media_type", "application/ocsp-response", ocsp_response_handle);\r\n#include "packet-ocsp-dis-tab.c"\r\n}
