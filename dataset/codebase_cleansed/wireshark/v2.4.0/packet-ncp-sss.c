static void\r\nprocess_flags(proto_tree *sss_tree, tvbuff_t *tvb, guint32 foffset)\r\n{\r\ngchar flags_str[1024];\r\nconst gchar *sep;\r\nproto_item *tinew;\r\nproto_tree *flags_tree;\r\nguint32 i;\r\nguint32 bvalue = 0;\r\nguint32 flags = 0;\r\nbvalue = 0x00000001;\r\nflags_str[0]='\0';\r\nsep="";\r\nflags = tvb_get_ntohl(tvb, foffset);\r\nfor (i = 0 ; i < 256; i++) {\r\nif (flags & bvalue) {\r\ng_strlcat(flags_str, sep, 1024);\r\nswitch(bvalue) {\r\ncase 0x00000001:\r\ng_strlcat(flags_str, "Enhanced Protection", 1024);\r\nbreak;\r\ncase 0x00000002:\r\ng_strlcat(flags_str, "Create ID", 1024);\r\nbreak;\r\ncase 0x00000004:\r\ng_strlcat(flags_str, "Remove Lock", 1024);\r\nbreak;\r\ncase 0x00000008:\r\ng_strlcat(flags_str, "Repair", 1024);\r\nbreak;\r\ncase 0x00000010:\r\ng_strlcat(flags_str, "Unicode", 1024);\r\nbreak;\r\ncase 0x00000020:\r\ng_strlcat(flags_str, "EP Master Password Used", 1024);\r\nbreak;\r\ncase 0x00000040:\r\ng_strlcat(flags_str, "EP Password Used", 1024);\r\nbreak;\r\ncase 0x00000080:\r\ng_strlcat(flags_str, "Set Tree Name", 1024);\r\nbreak;\r\ncase 0x00000100:\r\ng_strlcat(flags_str, "Get Context", 1024);\r\nbreak;\r\ncase 0x00000200:\r\ng_strlcat(flags_str, "Destroy Context", 1024);\r\nbreak;\r\ncase 0x00000400:\r\ng_strlcat(flags_str, "Not Defined", 1024);\r\nbreak;\r\ncase 0x00000800:\r\ng_strlcat(flags_str, "Not Defined", 1024);\r\nbreak;\r\ncase 0x00001000:\r\ng_strlcat(flags_str, "EP Lock", 1024);\r\nbreak;\r\ncase 0x00002000:\r\ng_strlcat(flags_str, "Not Initialized", 1024);\r\nbreak;\r\ncase 0x00004000:\r\ng_strlcat(flags_str, "Enhanced Protection", 1024);\r\nbreak;\r\ncase 0x00008000:\r\ng_strlcat(flags_str, "Store Not Synced", 1024);\r\nbreak;\r\ncase 0x00010000:\r\ng_strlcat(flags_str, "Admin Last Modified", 1024);\r\nbreak;\r\ncase 0x00020000:\r\ng_strlcat(flags_str, "EP Password Present", 1024);\r\nbreak;\r\ncase 0x00040000:\r\ng_strlcat(flags_str, "EP Master Password Present", 1024);\r\nbreak;\r\ncase 0x00080000:\r\ng_strlcat(flags_str, "MP Disabled", 1024);\r\nbreak;\r\ncase 0x00100000:\r\ng_strlcat(flags_str, "Not Defined", 1024);\r\nbreak;\r\ncase 0x00200000:\r\ng_strlcat(flags_str, "Not Defined", 1024);\r\nbreak;\r\ncase 0x00400000:\r\ng_strlcat(flags_str, "Not Defined", 1024);\r\nbreak;\r\ncase 0x00800000:\r\ng_strlcat(flags_str, "Not Defined", 1024);\r\nbreak;\r\ncase 0x01000000:\r\ng_strlcat(flags_str, "Not Defined", 1024);\r\nbreak;\r\ncase 0x02000000:\r\ng_strlcat(flags_str, "Not Defined", 1024);\r\nbreak;\r\ncase 0x04000000:\r\ng_strlcat(flags_str, "Not Defined", 1024);\r\nbreak;\r\ncase 0x08000000:\r\ng_strlcat(flags_str, "Not Defined", 1024);\r\nbreak;\r\ncase 0x10000000:\r\ng_strlcat(flags_str, "Not Defined", 1024);\r\nbreak;\r\ncase 0x20000000:\r\ng_strlcat(flags_str, "Not Defined", 1024);\r\nbreak;\r\ncase 0x40000000:\r\ng_strlcat(flags_str, "Not Defined", 1024);\r\nbreak;\r\ncase 0x80000000:\r\ng_strlcat(flags_str, "Not Defined", 1024);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nsep = ", ";\r\n}\r\nbvalue = bvalue*2;\r\n}\r\ntinew = proto_tree_add_uint(sss_tree, hf_flags, tvb, foffset, 4, flags);\r\nflags_tree = proto_item_add_subtree(tinew, ett_nds);\r\nbvalue = 0x00000001;\r\nfor (i = 0 ; i < 256; i++ ) {\r\nif (flags & bvalue) {\r\nswitch(bvalue) {\r\ncase 0x00000001:\r\nproto_tree_add_item(flags_tree, hfbit1, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x00000002:\r\nproto_tree_add_item(flags_tree, hfbit2, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x00000004:\r\nproto_tree_add_item(flags_tree, hfbit3, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x00000008:\r\nproto_tree_add_item(flags_tree, hfbit4, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x00000010:\r\nproto_tree_add_item(flags_tree, hfbit5, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x00000020:\r\nproto_tree_add_item(flags_tree, hfbit6, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x00000040:\r\nproto_tree_add_item(flags_tree, hfbit7, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x00000080:\r\nproto_tree_add_item(flags_tree, hfbit8, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x00000100:\r\nproto_tree_add_item(flags_tree, hfbit9, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x00000200:\r\nproto_tree_add_item(flags_tree, hfbit10, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x00000400:\r\nproto_tree_add_item(flags_tree, hfbit11, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x00000800:\r\nproto_tree_add_item(flags_tree, hfbit12, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x00001000:\r\nproto_tree_add_item(flags_tree, hfbit13, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x00002000:\r\nproto_tree_add_item(flags_tree, hfbit14, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x00004000:\r\nproto_tree_add_item(flags_tree, hfbit15, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x00008000:\r\nproto_tree_add_item(flags_tree, hfbit16, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x00010000:\r\nproto_tree_add_item(flags_tree, hfbit17, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x00020000:\r\nproto_tree_add_item(flags_tree, hfbit18, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x00040000:\r\nproto_tree_add_item(flags_tree, hfbit19, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x00080000:\r\nproto_tree_add_item(flags_tree, hfbit20, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x00100000:\r\nproto_tree_add_item(flags_tree, hfbit21, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x00200000:\r\nproto_tree_add_item(flags_tree, hfbit22, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x00400000:\r\nproto_tree_add_item(flags_tree, hfbit23, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x00800000:\r\nproto_tree_add_item(flags_tree, hfbit24, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x01000000:\r\nproto_tree_add_item(flags_tree, hfbit25, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x02000000:\r\nproto_tree_add_item(flags_tree, hfbit26, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x04000000:\r\nproto_tree_add_item(flags_tree, hfbit27, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x08000000:\r\nproto_tree_add_item(flags_tree, hfbit28, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x10000000:\r\nproto_tree_add_item(flags_tree, hfbit29, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x20000000:\r\nproto_tree_add_item(flags_tree, hfbit30, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x40000000:\r\nproto_tree_add_item(flags_tree, hfbit31, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x80000000:\r\nproto_tree_add_item(flags_tree, hfbit32, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\nbvalue = bvalue*2;\r\n}\r\nreturn;\r\n}\r\nstatic int\r\nfind_delimiter(tvbuff_t *tvb, int foffset)\r\n{\r\nint offset;\r\noffset = tvb_find_guint8(tvb, foffset, 256, '*');\r\nif (offset >= foffset) {\r\nreturn offset - foffset;\r\n}\r\nreturn 0;\r\n}\r\nstatic int\r\nsss_string(tvbuff_t* tvb, int hfinfo, proto_tree *sss_tree, int offset, gboolean little, guint32 length)\r\n{\r\nint foffset = offset;\r\nguint32 str_length;\r\nchar buffer[1024];\r\nguint32 i;\r\nguint8 c_char;\r\ngint length_remaining;\r\nif (length==0) {\r\nif (little) {\r\nstr_length = tvb_get_letohl(tvb, foffset);\r\n} else {\r\nstr_length = tvb_get_ntohl(tvb, foffset);\r\n}\r\nfoffset += 4;\r\n} else {\r\nstr_length = length;\r\n}\r\nlength_remaining = tvb_captured_length_remaining(tvb, foffset);\r\nif (length_remaining <= 0) {\r\nreturn foffset;\r\n}\r\nif (str_length > (guint)length_remaining || str_length > (sizeof(buffer)-1)) {\r\nproto_tree_add_string(sss_tree, hfinfo, tvb, foffset,\r\nlength_remaining + 4, "<String too long to process>");\r\nfoffset += length_remaining;\r\nreturn foffset;\r\n}\r\nif (str_length == 0) {\r\nproto_tree_add_string(sss_tree, hfinfo, tvb, offset, 4, "<Not Specified>");\r\nreturn foffset;\r\n}\r\nfor ( i = 0; i < str_length; i++ ) {\r\nc_char = tvb_get_guint8(tvb, foffset);\r\nif (g_ascii_isprint(c_char)) {\r\nbuffer[i] = c_char;\r\n} else {\r\nif (c_char) {\r\nbuffer[i] = '.';\r\n} else {\r\ni--;\r\nstr_length--;\r\n}\r\n}\r\nfoffset++;\r\n}\r\nbuffer[i] = '\0';\r\nif (length==0) {\r\nif (little) {\r\nstr_length = tvb_get_letohl(tvb, offset);\r\n} else {\r\nstr_length = tvb_get_ntohl(tvb, offset);\r\n}\r\noffset += 4;\r\n} else {\r\nstr_length = length;\r\n}\r\nproto_tree_add_string(sss_tree, hfinfo, tvb, offset, str_length, buffer);\r\nreturn foffset;\r\n}\r\nvoid\r\ndissect_sss_request(tvbuff_t *tvb, packet_info *pinfo, proto_tree *ncp_tree, ncp_req_hash_value *request_value)\r\n{\r\nguint8 subfunc = 0;\r\nguint32 subverb=0;\r\nguint32 msg_length=0;\r\nguint32 foffset= 0;\r\nproto_tree *atree;\r\nproto_item *aitem;\r\nif (tvb_reported_length_remaining(tvb, foffset)<4) {\r\nreturn;\r\n}\r\nfoffset = 6;\r\nfoffset += 1;\r\nsubfunc = tvb_get_guint8(tvb, foffset);\r\nfoffset += 1;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "NSSS");\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "C SecretStore - %s", val_to_str(subfunc, sss_func_enum, "Unknown (%d)"));\r\nswitch (subfunc) {\r\ncase 1:\r\natree = proto_tree_add_subtree_format(ncp_tree, tvb, foffset, -1, ett_sss, NULL, "Packet Type: %s", val_to_str(subfunc, sss_func_enum, "Unknown (%d)"));\r\nproto_tree_add_item(atree, hf_ping_version, tvb, foffset, 4, ENC_LITTLE_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(atree, hf_flags, tvb, foffset, 4, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase 2:\r\nproto_tree_add_item(ncp_tree, hf_frag_handle, tvb, foffset, 4, ENC_LITTLE_ENDIAN);\r\nif (tvb_get_letohl(tvb, foffset)==0xffffffff) {\r\nfoffset += 4;\r\nproto_tree_add_item(ncp_tree, hf_buffer_size, tvb, foffset, 4, ENC_LITTLE_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(ncp_tree, hf_length, tvb, foffset, 4, ENC_LITTLE_ENDIAN);\r\nfoffset += 4;\r\nfoffset += 12;\r\nsubverb = tvb_get_letohl(tvb, foffset);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ", %s", val_to_str(subverb, sss_verb_enum, "Unknown (%d)"));\r\naitem = proto_tree_add_item(ncp_tree, hf_verb, tvb, foffset, 4, ENC_LITTLE_ENDIAN);\r\natree = proto_item_add_subtree(aitem, ett_sss);\r\nif (request_value) {\r\nrequest_value->req_nds_flags=subverb;\r\n}\r\nfoffset += 4;\r\nprocess_flags(atree, tvb, foffset);\r\nfoffset += 4;\r\nproto_tree_add_item(atree, hf_context, tvb, foffset, 4, ENC_BIG_ENDIAN);\r\nfoffset += 4;\r\nswitch (subverb) {\r\ncase 0:\r\nfoffset += 4;\r\nsss_string(tvb, hf_user, atree, foffset, TRUE, 0);\r\nbreak;\r\ncase 1:\r\nfoffset = sss_string(tvb, hf_secret, atree, foffset, TRUE, 0);\r\nmsg_length = tvb_get_letohl(tvb, foffset);\r\nfoffset += (msg_length+4);\r\nif (tvb_reported_length_remaining(tvb, foffset) > 4) {\r\nsss_string(tvb, hf_user, atree, foffset, TRUE, 0);\r\n}\r\nbreak;\r\ncase 2:\r\nfoffset += 4;\r\nfoffset = sss_string(tvb, hf_secret, atree, foffset, TRUE, 0);\r\nif (tvb_reported_length_remaining(tvb, foffset) > 4) {\r\nmsg_length = tvb_get_letohl(tvb, foffset);\r\nfoffset += 4;\r\nif (tvb_captured_length_remaining(tvb, foffset) < (gint) msg_length) {\r\nproto_tree_add_item(atree, hf_enc_data, tvb, foffset, -1, ENC_NA);\r\n} else {\r\nproto_tree_add_item(atree, hf_enc_data, tvb, foffset, msg_length, ENC_NA);\r\n}\r\n}\r\nbreak;\r\ncase 3:\r\ncase 4:\r\nfoffset = sss_string(tvb, hf_secret, atree, foffset, TRUE, 0);\r\nif (tvb_reported_length_remaining(tvb, foffset) > 4) {\r\nsss_string(tvb, hf_user, atree, foffset, TRUE, 0);\r\n}\r\nbreak;\r\ncase 5:\r\nbreak;\r\ncase 6:\r\nfoffset = sss_string(tvb, hf_secret, atree, foffset, TRUE, 0);\r\nif (tvb_reported_length_remaining(tvb, foffset) > 4) {\r\nsss_string(tvb, hf_user, atree, foffset, TRUE, 0);\r\n}\r\nbreak;\r\ncase 7:\r\nmsg_length = tvb_get_letohl(tvb, foffset);\r\nfoffset += 4;\r\nproto_tree_add_item(atree, hf_enc_cred, tvb, foffset, msg_length, ENC_NA);\r\nbreak;\r\ncase 8:\r\ncase 9:\r\ndefault:\r\nbreak;\r\n}\r\n} else {\r\ncol_set_str(pinfo->cinfo, COL_INFO, "C SecretStore - fragment");\r\nif (request_value) {\r\nrequest_value->req_nds_flags=255;\r\n}\r\nif (tvb_reported_length_remaining(tvb, foffset) > 8) {\r\nfoffset += 4;\r\nproto_tree_add_item(ncp_tree, hf_enc_data, tvb, foffset, -1, ENC_NA);\r\n}\r\n}\r\nbreak;\r\ncase 3:\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\nvoid\r\ndissect_sss_reply(tvbuff_t *tvb, packet_info *pinfo, proto_tree *ncp_tree, guint8 subfunc, ncp_req_hash_value *request_value)\r\n{\r\nguint32 foffset=0;\r\nguint32 subverb=0;\r\nguint32 msg_length=0;\r\nguint32 return_code=0;\r\nguint32 number_of_items=0;\r\ngint32 length_of_string=0;\r\nguint32 i = 0;\r\nconst gchar *str;\r\nproto_tree *atree;\r\nproto_item *expert_item;\r\nfoffset = 8;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "NSSS");\r\nif (tvb_captured_length_remaining(tvb, foffset)<4) {\r\nreturn;\r\n}\r\natree = proto_tree_add_subtree_format(ncp_tree, tvb, foffset, -1, ett_sss, NULL, "Function: %s", val_to_str_const(subfunc, sss_func_enum, "Unknown"));\r\nswitch (subfunc) {\r\ncase 1:\r\nproto_tree_add_item(atree, hf_flags, tvb, foffset, 4, ENC_LITTLE_ENDIAN);\r\nfoffset += 4;\r\nproto_tree_add_item(atree, hf_sss_version, tvb, foffset, 4, ENC_LITTLE_ENDIAN);\r\nbreak;\r\ncase 2:\r\nif (request_value) {\r\nsubverb = request_value->req_nds_flags;\r\nstr = try_val_to_str(subverb, sss_verb_enum);\r\nif (str) {\r\nproto_tree_add_uint(atree, hf_verb, tvb, foffset, -1, subverb);\r\n}\r\n}\r\nproto_tree_add_item(atree, hf_length, tvb, foffset, 4, ENC_LITTLE_ENDIAN);\r\nmsg_length = tvb_get_letohl(tvb, foffset);\r\nfoffset += 4;\r\nproto_tree_add_item(atree, hf_frag_handle, tvb, foffset, 4, ENC_LITTLE_ENDIAN);\r\nfoffset += 4;\r\nmsg_length -= 4;\r\nif ((tvb_get_letohl(tvb, foffset-4)==0xffffffff) && (msg_length > 4)) {\r\nfoffset += 4;\r\nreturn_code = tvb_get_letohl(tvb, foffset);\r\nstr = try_val_to_str(return_code, sss_errors_enum);\r\nif (str) {\r\nexpert_item = proto_tree_add_item(atree, hf_return_code, tvb, foffset, 4, ENC_LITTLE_ENDIAN);\r\nexpert_add_info_format(pinfo, expert_item, &ei_return_code, "SSS Error: %s", str);\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "R Error - %s", val_to_str(return_code, sss_errors_enum, "Unknown (%d)"));\r\n} else {\r\nproto_tree_add_uint_format_value(atree, hf_return_code, tvb, foffset, 4, 0, "Success (0x00000000)");\r\nif (tvb_reported_length_remaining(tvb, foffset) > 8) {\r\nfoffset += 4;\r\nif (request_value && subverb == 6) {\r\nfoffset += 4;\r\nnumber_of_items = tvb_get_letohl(tvb, foffset);\r\nfoffset += 8;\r\nfor (i=0; i<number_of_items; i++) {\r\nlength_of_string = find_delimiter(tvb, foffset);\r\nif (length_of_string > tvb_reported_length_remaining(tvb, foffset)) {\r\nreturn;\r\n}\r\nfoffset = sss_string(tvb, hf_secret, atree, foffset, TRUE, length_of_string);\r\nif (tvb_reported_length_remaining(tvb, foffset) < 8) {\r\nreturn;\r\n}\r\nfoffset++;\r\n}\r\n} else {\r\nproto_tree_add_item(atree, hf_enc_data, tvb, foffset, tvb_captured_length_remaining(tvb, foffset), ENC_NA);\r\n}\r\n}\r\n}\r\n} else {\r\nproto_tree_add_uint_format_value(atree, hf_return_code, tvb, foffset, 4, 0, "Success (0x00000000)");\r\nif (tvb_reported_length_remaining(tvb, foffset) > 8) {\r\nfoffset += 4;\r\nproto_tree_add_item(atree, hf_enc_data, tvb, foffset, tvb_captured_length_remaining(tvb, foffset), ENC_NA);\r\n}\r\n}\r\nbreak;\r\ncase 3:\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\nvoid\r\nproto_register_sss(void)\r\n{\r\nstatic hf_register_info hf_sss[] = {\r\n{ &hf_buffer_size,\r\n{ "Buffer Size", "sss.buffer", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_ping_version,\r\n{ "Ping Version", "sss.ping_version", FT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_flags,\r\n{ "Flags", "sss.flags", FT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_context,\r\n{ "Context", "sss.context", FT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_frag_handle,\r\n{ "Fragment Handle", "sss.frag_handle", FT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_length,\r\n{ "Length", "sss.length", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_verb,\r\n{ "Verb", "sss.verb", FT_UINT32, BASE_HEX, VALS(sss_verb_enum), 0x0, NULL, HFILL }},\r\n{ &hf_user,\r\n{ "User", "sss.user", FT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_secret,\r\n{ "Secret ID", "sss.secret", FT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_sss_version,\r\n{ "SecretStore Protocol Version", "sss.version", FT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_return_code,\r\n{ "Return Code", "sss.return_code", FT_UINT32, BASE_HEX, VALS(sss_errors_enum), 0x0, NULL, HFILL }},\r\n{ &hf_enc_cred,\r\n{ "Encrypted Credential", "sss.enc_cred", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_enc_data,\r\n{ "Encrypted Data", "sss.enc_data", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hfbit1,\r\n{ "Enhanced Protection", "ncp.sss_bit1", FT_BOOLEAN, 32, NULL, 0x00000001, NULL, HFILL }},\r\n{ &hfbit2,\r\n{ "Create ID", "ncp.sss_bit2", FT_BOOLEAN, 32, NULL, 0x00000002, NULL, HFILL }},\r\n{ &hfbit3,\r\n{ "Remove Lock", "ncp.sss_bit3", FT_BOOLEAN, 32, NULL, 0x00000004, NULL, HFILL }},\r\n{ &hfbit4,\r\n{ "Repair", "ncp.sss_bit4", FT_BOOLEAN, 32, NULL, 0x00000008, NULL, HFILL }},\r\n{ &hfbit5,\r\n{ "Unicode", "ncp.sss_bit5", FT_BOOLEAN, 32, NULL, 0x00000010, NULL, HFILL }},\r\n{ &hfbit6,\r\n{ "EP Master Password Used", "ncp.sss_bit6", FT_BOOLEAN, 32, NULL, 0x00000020, NULL, HFILL }},\r\n{ &hfbit7,\r\n{ "EP Password Used", "ncp.sss_bit7", FT_BOOLEAN, 32, NULL, 0x00000040, NULL, HFILL }},\r\n{ &hfbit8,\r\n{ "Set Tree Name", "ncp.sss_bit8", FT_BOOLEAN, 32, NULL, 0x00000080, NULL, HFILL }},\r\n{ &hfbit9,\r\n{ "Get Context", "ncp.sss_bit9", FT_BOOLEAN, 32, NULL, 0x00000100, NULL, HFILL }},\r\n{ &hfbit10,\r\n{ "Destroy Context", "ncp.sss_bit10", FT_BOOLEAN, 32, NULL, 0x00000200, NULL, HFILL }},\r\n{ &hfbit11,\r\n{ "Not Defined", "ncp.sss_bit11", FT_BOOLEAN, 32, NULL, 0x00000400, NULL, HFILL }},\r\n{ &hfbit12,\r\n{ "Not Defined", "ncp.sss_bit12", FT_BOOLEAN, 32, NULL, 0x00000800, NULL, HFILL }},\r\n{ &hfbit13,\r\n{ "Not Defined", "ncp.sss_bit13", FT_BOOLEAN, 32, NULL, 0x00001000, NULL, HFILL }},\r\n{ &hfbit14,\r\n{ "Not Defined", "ncp.sss_bit14", FT_BOOLEAN, 32, NULL, 0x00002000, NULL, HFILL }},\r\n{ &hfbit15,\r\n{ "Not Defined", "ncp.sss_bit15", FT_BOOLEAN, 32, NULL, 0x00004000, NULL, HFILL }},\r\n{ &hfbit16,\r\n{ "Not Defined", "ncp.sss_bit16", FT_BOOLEAN, 32, NULL, 0x00008000, NULL, HFILL }},\r\n{ &hfbit17,\r\n{ "EP Lock", "ncp.sss_bit17", FT_BOOLEAN, 32, NULL, 0x00010000, NULL, HFILL }},\r\n{ &hfbit18,\r\n{ "Not Initialized", "ncp.sss_bit18", FT_BOOLEAN, 32, NULL, 0x00020000, NULL, HFILL }},\r\n{ &hfbit19,\r\n{ "Enhanced Protection", "ncp.sss_bit19", FT_BOOLEAN, 32, NULL, 0x00040000, NULL, HFILL }},\r\n{ &hfbit20,\r\n{ "Store Not Synced", "ncp.sss_bit20", FT_BOOLEAN, 32, NULL, 0x00080000, NULL, HFILL }},\r\n{ &hfbit21,\r\n{ "Admin Last Modified", "ncp.sss_bit21", FT_BOOLEAN, 32, NULL, 0x00100000, NULL, HFILL }},\r\n{ &hfbit22,\r\n{ "EP Password Present", "ncp.sss_bit22", FT_BOOLEAN, 32, NULL, 0x00200000, NULL, HFILL }},\r\n{ &hfbit23,\r\n{ "EP Master Password Present", "ncp.sss_bit23", FT_BOOLEAN, 32, NULL, 0x00400000, NULL, HFILL }},\r\n{ &hfbit24,\r\n{ "MP Disabled", "ncp.sss_bit24", FT_BOOLEAN, 32, NULL, 0x00800000, NULL, HFILL }},\r\n{ &hfbit25,\r\n{ "Not Defined", "ncp.sss_bit25", FT_BOOLEAN, 32, NULL, 0x01000000, NULL, HFILL }},\r\n{ &hfbit26,\r\n{ "Not Defined", "ncp.sss_bit26", FT_BOOLEAN, 32, NULL, 0x02000000, NULL, HFILL }},\r\n{ &hfbit27,\r\n{ "Not Defined", "ncp.sss_bit27", FT_BOOLEAN, 32, NULL, 0x04000000, NULL, HFILL }},\r\n{ &hfbit28,\r\n{ "Not Defined", "ncp.sss_bit28", FT_BOOLEAN, 32, NULL, 0x08000000, NULL, HFILL }},\r\n{ &hfbit29,\r\n{ "Not Defined", "ncp.sss_bit29", FT_BOOLEAN, 32, NULL, 0x10000000, NULL, HFILL }},\r\n{ &hfbit30,\r\n{ "Not Defined", "ncp.sss_bit30", FT_BOOLEAN, 32, NULL, 0x20000000, NULL, HFILL }},\r\n{ &hfbit31,\r\n{ "Not Defined", "ncp.sss_bit31", FT_BOOLEAN, 32, NULL, 0x40000000, NULL, HFILL }},\r\n{ &hfbit32,\r\n{ "Not Defined", "ncp.sss_bit32", FT_BOOLEAN, 32, NULL, 0x80000000, NULL, HFILL }}\r\n};\r\nstatic gint *ett[] = {\r\n&ett_sss\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_return_code, { "sss.return_code.expert", PI_RESPONSE_CODE, PI_NOTE, "SSS Error", EXPFILL }}\r\n};\r\nexpert_module_t* expert_sss;\r\nproto_sss = proto_register_protocol("Novell SecretStore Services", "SSS", "sss");\r\nproto_register_field_array(proto_sss, hf_sss, array_length(hf_sss));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_sss = expert_register_protocol(proto_sss);\r\nexpert_register_field_array(expert_sss, ei, array_length(ei));\r\n}
