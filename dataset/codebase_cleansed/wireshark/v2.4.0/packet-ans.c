static int\r\ndissect_ans(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nproto_item *ti;\r\nproto_tree *ans_tree = NULL;\r\nguint16 sender_id;\r\nguint32 seq_num;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "Intel ANS probe");\r\nseq_num = tvb_get_ntohl(tvb, 4);\r\nsender_id = tvb_get_ntohs(tvb, 8);\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "Sequence: %u, Sender ID %u, Team ID %s",\r\nseq_num, sender_id, tvb_ether_to_str(tvb, 10));\r\nif (tree) {\r\nti = proto_tree_add_item(tree, proto_ans, tvb, 0, -1, ENC_NA);\r\nans_tree = proto_item_add_subtree(ti, ett_ans);\r\nproto_tree_add_item(ans_tree, hf_ans_app_id, tvb, 0, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ans_tree, hf_ans_rev_id, tvb, 2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ans_tree, hf_ans_seq_num, tvb, 4, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ans_tree, hf_ans_sender_id, tvb, 8, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ans_tree, hf_ans_team_id, tvb, 10, 6, ENC_NA);\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_ans(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_ans_app_id,\r\n{ "Application ID", "ans.app_id",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"Intel ANS Application ID", HFILL }\r\n},\r\n{ &hf_ans_rev_id,\r\n{ "Revision ID", "ans.rev_id",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\n"Intel ANS Revision ID", HFILL }\r\n},\r\n{ &hf_ans_seq_num,\r\n{ "Sequence Number", "ans.seq_num",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"Intel ANS Sequence Number", HFILL }\r\n},\r\n{ &hf_ans_sender_id,\r\n{ "Sender ID", "ans.sender_id",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\n"Intel ANS Sender ID", HFILL }\r\n},\r\n{ &hf_ans_team_id,\r\n{ "Team ID", "ans.team_id",\r\nFT_ETHER, BASE_NONE, NULL, 0,\r\n"Intel ANS Team ID", HFILL }\r\n},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_ans,\r\n};\r\nproto_ans = proto_register_protocol("Intel ANS probe", "ANS", "ans");\r\nproto_register_field_array(proto_ans, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid\r\nproto_reg_handoff_ans(void)\r\n{\r\ndissector_handle_t ans_handle;\r\nans_handle = create_dissector_handle(dissect_ans, proto_ans);\r\ndissector_add_uint("ethertype", ETHERTYPE_INTEL_ANS, ans_handle);\r\n}
