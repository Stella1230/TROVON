void\r\napply_selected_filter (guint callback_action, const char *filter)\r\n{\r\nint action, type;\r\nchar *str = NULL;\r\nconst char *current_filter;\r\naction = FILTER_ACTION(callback_action);\r\ntype = FILTER_ACTYPE(callback_action);\r\ncurrent_filter = gtk_entry_get_text(GTK_ENTRY(main_display_filter_widget));\r\nswitch(type){\r\ncase ACTYPE_SELECTED:\r\nstr = g_strdup(filter);\r\nbreak;\r\ncase ACTYPE_NOT_SELECTED:\r\nstr = g_strdup_printf("!(%s)", filter);\r\nbreak;\r\ncase ACTYPE_AND_SELECTED:\r\nif ((!current_filter) || (0 == strlen(current_filter)))\r\nstr = g_strdup(filter);\r\nelse\r\nstr = g_strdup_printf("(%s) && (%s)", current_filter, filter);\r\nbreak;\r\ncase ACTYPE_OR_SELECTED:\r\nif ((!current_filter) || (0 == strlen(current_filter)))\r\nstr = g_strdup(filter);\r\nelse\r\nstr = g_strdup_printf("(%s) || (%s)", current_filter, filter);\r\nbreak;\r\ncase ACTYPE_AND_NOT_SELECTED:\r\nif ((!current_filter) || (0 == strlen(current_filter)))\r\nstr = g_strdup_printf("!(%s)", filter);\r\nelse\r\nstr = g_strdup_printf("(%s) && !(%s)", current_filter, filter);\r\nbreak;\r\ncase ACTYPE_OR_NOT_SELECTED:\r\nif ((!current_filter) || (0 == strlen(current_filter)))\r\nstr = g_strdup_printf("!(%s)", filter);\r\nelse\r\nstr = g_strdup_printf("(%s) || !(%s)", current_filter, filter);\r\nbreak;\r\n}\r\nswitch(action){\r\ncase ACTION_MATCH:\r\ngtk_entry_set_text(GTK_ENTRY(main_display_filter_widget), str);\r\nmain_filter_packets(&cfile, str, FALSE);\r\ngdk_window_raise(gtk_widget_get_window(top_level));\r\nbreak;\r\ncase ACTION_PREPARE:\r\ngtk_entry_set_text(GTK_ENTRY(main_display_filter_widget), str);\r\nbreak;\r\ncase ACTION_FIND_FRAME:\r\nfind_frame_with_filter(str);\r\nbreak;\r\ncase ACTION_FIND_NEXT:\r\ncf_find_packet_dfilter_string(&cfile, str, SD_FORWARD);\r\nbreak;\r\ncase ACTION_FIND_PREVIOUS:\r\ncf_find_packet_dfilter_string(&cfile, str, SD_BACKWARD);\r\nbreak;\r\ncase ACTION_COLORIZE:\r\ncolor_display_with_filter(str);\r\nbreak;\r\n}\r\ng_free (str);\r\n}
