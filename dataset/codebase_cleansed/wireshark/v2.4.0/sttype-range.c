static gpointer\r\nrange_new(gpointer junk)\r\n{\r\nrange_t *range;\r\ng_assert(junk == NULL);\r\nrange = g_new(range_t, 1);\r\nrange->magic = RANGE_MAGIC;\r\nrange->entity = NULL;\r\nrange->drange = NULL;\r\nreturn (gpointer) range;\r\n}\r\nstatic gpointer\r\nrange_dup(gconstpointer data)\r\n{\r\nconst range_t *org = (const range_t *)data;\r\nrange_t *range;\r\nrange = (range_t *)range_new(NULL);\r\nrange->entity = stnode_dup(org->entity);\r\nrange->drange = drange_dup(org->drange);\r\nreturn (gpointer) range;\r\n}\r\nstatic void\r\nrange_free(gpointer value)\r\n{\r\nrange_t *range = (range_t*)value;\r\nassert_magic(range, RANGE_MAGIC);\r\nif (range->drange)\r\ndrange_free(range->drange);\r\nif (range->entity)\r\nstnode_free(range->entity);\r\ng_free(range);\r\n}\r\nvoid\r\nsttype_range_remove_drange(stnode_t *node)\r\n{\r\nrange_t *range;\r\nrange = (range_t*)stnode_data(node);\r\nassert_magic(range, RANGE_MAGIC);\r\nrange->drange = NULL;\r\n}\r\nvoid\r\nsttype_range_set(stnode_t *node, stnode_t *entity, GSList* drange_list)\r\n{\r\nrange_t *range;\r\nrange = (range_t*)stnode_data(node);\r\nassert_magic(range, RANGE_MAGIC);\r\nrange->entity = entity;\r\nrange->drange = drange_new_from_list(drange_list);\r\n}\r\nvoid\r\nsttype_range_set1(stnode_t *node, stnode_t *entity, drange_node *rn)\r\n{\r\nsttype_range_set(node, entity, g_slist_append(NULL, rn));\r\n}\r\nvoid\r\nsttype_register_range(void)\r\n{\r\nstatic sttype_t range_type = {\r\nSTTYPE_RANGE,\r\n"RANGE",\r\nrange_new,\r\nrange_free,\r\nrange_dup\r\n};\r\nsttype_register(&range_type);\r\n}
