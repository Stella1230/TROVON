static int\r\ndissect_atn_ulcs_Transfer_syntax_name(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_object_identifier(tvb, offset, actx, tree, hf_index, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_Presentation_context_identifier(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_constrained_integer(\r\ntvb,\r\noffset,\r\nactx,\r\ntree,\r\nhf_index,\r\n1U,\r\n127U,\r\n&ulcs_context_value,\r\nTRUE);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_T_pdv_list_presentation_data_values_single_asn1_type(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_open_type(tvb, offset, actx, tree, hf_index, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_OCTET_STRING(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_octet_string(tvb, offset, actx, tree, hf_index,\r\nNO_BOUND, NO_BOUND, FALSE, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_T_pdv_list_presentation_data_values_arbitrary(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\npacket_info * pinfo = actx->pinfo;\r\ntvbuff_t *tvb_usr = NULL;\r\nproto_tree *atn_ulcs_tree = NULL;\r\natn_conversation_t *atn_cv = NULL;\r\nheur_dtbl_entry_t *hdtbl_entry;\r\noffset = dissect_per_bit_string(\r\ntvb,\r\noffset,\r\nactx,\r\ntree,\r\nhf_index,\r\nNO_BOUND,\r\nNO_BOUND,\r\nFALSE,\r\n&tvb_usr,\r\nNULL);\r\nif (tvb_usr) {\r\nswitch(ulcs_context_value){\r\ncase 1:\r\natn_ulcs_tree = proto_tree_add_subtree(\r\nroot_tree, tvb, offset, 0,\r\nett_atn_acse, NULL, ATN_ACSE_PROTO );\r\ndissect_ACSE_apdu_PDU(\r\ntvb_new_subset_remaining(tvb_usr, 0),\r\npinfo,\r\natn_ulcs_tree, NULL);\r\nbreak;\r\ncase 3:\r\natn_cv = find_atn_conversation(\r\n&pinfo->dst,\r\npinfo->clnp_dstref,\r\n&pinfo->src);\r\nif(atn_cv) {\r\nswitch(atn_cv->ae_qualifier){\r\ncase cma:\r\ncall_dissector_with_data(\r\natn_cm_handle,\r\ntvb_new_subset_remaining(tvb_usr, 0),\r\npinfo,\r\nroot_tree,\r\nNULL);\r\nbreak;\r\ncase cpdlc:\r\ncase pmcpdlc:\r\ncall_dissector_with_data(\r\natn_cpdlc_handle,\r\ntvb_new_subset_remaining(tvb_usr, 0),\r\npinfo,\r\nroot_tree,\r\nNULL);\r\nbreak;\r\ndefault:\r\ndissector_try_heuristic(\r\natn_ulcs_heur_subdissector_list,\r\ntvb_new_subset_remaining(tvb_usr,0),\r\nactx->pinfo,\r\nroot_tree,\r\n&hdtbl_entry,\r\nNULL);\r\nbreak;\r\n}\r\n}\r\nelse{\r\ndissector_try_heuristic(\r\natn_ulcs_heur_subdissector_list,\r\ntvb_new_subset_remaining(tvb_usr,0),\r\nactx->pinfo,\r\nroot_tree,\r\n&hdtbl_entry,\r\nNULL);\r\n}\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_T_presentation_data_values(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_choice(tvb, offset, actx, tree, hf_index,\r\nett_atn_ulcs_T_presentation_data_values, T_presentation_data_values_choice,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_PDV_list(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,\r\nett_atn_ulcs_PDV_list, PDV_list_sequence);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_Fully_encoded_data(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_constrained_sequence_of(tvb, offset, actx, tree, hf_index,\r\nett_atn_ulcs_Fully_encoded_data, Fully_encoded_data_sequence_of,\r\n1, 1, TRUE);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_OBJECT_IDENTIFIER(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_object_identifier(tvb, offset, actx, tree, hf_index, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_INTEGER(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_integer(tvb, offset, actx, tree, hf_index, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_T_data_value_descriptor(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_octet_string(\r\ntvb,\r\noffset,\r\nactx,\r\ntree,\r\nhf_index,\r\n-1,\r\n-1,\r\nFALSE,\r\n&actx->external.data_value_descriptor);\r\nactx->external.data_value_descr_present = TRUE;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_T_externalt_encoding_single_asn1_type(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_open_type(tvb, offset, actx, tree, hf_index, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_T_externalt_encoding_octet_aligned(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_octet_string(tvb, offset, actx, tree, hf_index,\r\nNO_BOUND, NO_BOUND, FALSE, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_T_externalt_encoding_arbitrary(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\ntvbuff_t *tvb_usr = NULL;\r\npacket_info * pinfo = actx->pinfo;\r\natn_conversation_t *atn_cv = NULL;\r\nheur_dtbl_entry_t *hdtbl_entry;\r\noffset = dissect_per_bit_string(\r\ntvb,\r\noffset,\r\nactx,\r\ntree, hf_index,\r\nNO_BOUND,\r\nNO_BOUND,\r\nFALSE,\r\n&tvb_usr,\r\nNULL);\r\nif (tvb_usr) {\r\nif((pinfo->clnp_dstref) && (!pinfo->clnp_srcref)){\r\natn_cv = find_atn_conversation(\r\n&pinfo->dst,\r\npinfo->clnp_dstref,\r\n&pinfo->src);\r\n}\r\nif((pinfo->clnp_srcref) && (!pinfo->clnp_dstref)){\r\natn_cv = find_atn_conversation(\r\n&pinfo->src,\r\npinfo->clnp_srcref,\r\n&pinfo->dst);\r\n}\r\nif((pinfo->clnp_srcref) && (pinfo->clnp_dstref)){\r\natn_cv = find_atn_conversation(\r\n&pinfo->src,\r\npinfo->clnp_srcref,\r\n&pinfo->dst);\r\n}\r\nif(atn_cv) {\r\nswitch(atn_cv->ae_qualifier){\r\ncase cma:\r\ncall_dissector_with_data(\r\natn_cm_handle,\r\ntvb_new_subset_remaining(tvb_usr, 0),\r\npinfo,\r\nroot_tree,\r\nNULL);\r\nbreak;\r\ncase cpdlc:\r\ncase pmcpdlc:\r\ncall_dissector_with_data(\r\natn_cpdlc_handle,\r\ntvb_new_subset_remaining(tvb_usr, 0),\r\npinfo,\r\nroot_tree,\r\nNULL);\r\nbreak;\r\ndefault:\r\ndissector_try_heuristic(\r\natn_ulcs_heur_subdissector_list,\r\ntvb_new_subset_remaining(tvb_usr,0),\r\nactx->pinfo,\r\nroot_tree,\r\n&hdtbl_entry,\r\nNULL);\r\nbreak;\r\n}\r\n}else {\r\ndissector_try_heuristic(\r\natn_ulcs_heur_subdissector_list,\r\ntvb_new_subset_remaining(tvb_usr,0),\r\nactx->pinfo,\r\nroot_tree,\r\n&hdtbl_entry,\r\nNULL);\r\n}\r\n}\r\noffset += tvb_reported_length_remaining(tvb, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_T_encoding(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_choice(tvb, offset, actx, tree, hf_index,\r\nett_atn_ulcs_T_encoding, T_encoding_choice,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_EXTERNALt(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,\r\nett_atn_ulcs_EXTERNALt, EXTERNALt_sequence);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_T_aarq_apdu_protocol_version(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_bit_string(tvb, offset, actx, tree, hf_index,\r\nNO_BOUND, NO_BOUND, FALSE, NULL, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_Application_context_name(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_object_identifier(tvb, offset, actx, tree, hf_index, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_AP_title_form2(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_object_identifier(tvb, offset, actx, tree, hf_index, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_NULL(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_null(tvb, offset, actx, tree, hf_index);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_AttributeTypeAndValue(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,\r\nett_atn_ulcs_AttributeTypeAndValue, AttributeTypeAndValue_sequence);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_RelativeDistinguishedName(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_constrained_set_of(tvb, offset, actx, tree, hf_index,\r\nett_atn_ulcs_RelativeDistinguishedName, RelativeDistinguishedName_set_of,\r\n1, NO_BOUND, FALSE);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_RDNSequence(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_sequence_of(tvb, offset, actx, tree, hf_index,\r\nett_atn_ulcs_RDNSequence, RDNSequence_sequence_of);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_Name(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_choice(tvb, offset, actx, tree, hf_index,\r\nett_atn_ulcs_Name, Name_choice,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_AP_title_form1(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_atn_ulcs_Name(tvb, offset, actx, tree, hf_index);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_AP_title(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_choice(tvb, offset, actx, tree, hf_index,\r\nett_atn_ulcs_AP_title, AP_title_choice,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_AE_qualifier_form2(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\npacket_info * pinfo = actx->pinfo;\r\natn_conversation_t *atn_cv = NULL;\r\nguint32 ae_qualifier = 0;\r\noffset = dissect_per_integer(\r\ntvb,\r\noffset,\r\nactx,\r\ntree,\r\nhf_index,\r\n&ae_qualifier);\r\nif((pinfo->clnp_dstref) && (!pinfo->clnp_srcref)){\r\natn_cv = find_atn_conversation(&pinfo->dst,\r\npinfo->clnp_dstref,\r\n&pinfo->src );\r\n}\r\nif((!pinfo->clnp_dstref) && (pinfo->clnp_srcref)){\r\natn_cv = find_atn_conversation(&pinfo->src,\r\npinfo->clnp_srcref,\r\n&pinfo->dst );\r\n}\r\nif(atn_cv){\r\natn_cv->ae_qualifier = ae_qualifier;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_AE_qualifier_form1(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_atn_ulcs_RelativeDistinguishedName(tvb, offset, actx, tree, hf_index);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_AE_qualifier(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_choice(tvb, offset, actx, tree, hf_index,\r\nett_atn_ulcs_AE_qualifier, AE_qualifier_choice,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_AP_invocation_identifier(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_integer(tvb, offset, actx, tree, hf_index, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_AE_invocation_identifier(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_integer(tvb, offset, actx, tree, hf_index, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_ACSE_requirements(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_bit_string(tvb, offset, actx, tree, hf_index,\r\nNO_BOUND, NO_BOUND, FALSE, NULL, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_Mechanism_name(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_object_identifier(\r\ntvb,\r\noffset,\r\nactx,\r\ntree,\r\nhf_index,\r\nNULL);\r\noffset = dissect_per_object_identifier(\r\ntvb,\r\noffset,\r\nactx,\r\ntree,\r\nhf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_BIT_STRING(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_bit_string(tvb, offset, actx, tree, hf_index,\r\nNO_BOUND, NO_BOUND, FALSE, NULL, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_EXTERNAL(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_external_type(tvb, offset, actx, tree, hf_index, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_T_other_mechanism_value(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset=call_ber_oid_callback(\r\nobject_identifier_id,\r\ntvb,\r\noffset,\r\nactx->pinfo,\r\ntree, NULL);\r\noffset=call_ber_oid_callback(\r\nobject_identifier_id,\r\ntvb,\r\noffset,\r\nactx->pinfo,\r\ntree, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_T_other(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,\r\nett_atn_ulcs_T_other, T_other_sequence);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_Authentication_value(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_choice(tvb, offset, actx, tree, hf_index,\r\nett_atn_ulcs_Authentication_value, Authentication_value_choice,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_Application_context_name_list(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_sequence_of(tvb, offset, actx, tree, hf_index,\r\nett_atn_ulcs_Application_context_name_list, Application_context_name_list_sequence_of);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_Implementation_data(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_octet_string(tvb, offset, actx, tree, hf_index,\r\nNO_BOUND, NO_BOUND, FALSE, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_Association_information(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_constrained_sequence_of(tvb, offset, actx, tree, hf_index,\r\nett_atn_ulcs_Association_information, Association_information_sequence_of,\r\n1, 1, TRUE);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_AARQ_apdu(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\npacket_info * pinfo = actx->pinfo;\r\naarq_data_t *aarq_data = NULL;\r\natn_conversation_t *atn_cv = NULL;\r\nguint32 aircraft_24_bit_address = 0;\r\nif((pinfo->clnp_dstref) && (!pinfo->clnp_srcref)){\r\natn_cv = find_atn_conversation(\r\n&pinfo->dst,\r\npinfo->clnp_dstref,\r\n&pinfo->src );\r\nif(!atn_cv){\r\natn_cv = wmem_new(wmem_file_scope(), atn_conversation_t);\r\natn_cv->ae_qualifier = unknown;\r\ncreate_atn_conversation(&pinfo->dst,\r\npinfo->clnp_dstref,\r\n&pinfo->src ,\r\natn_cv);\r\n}\r\n}\r\nif((!pinfo->clnp_dstref) && (pinfo->clnp_srcref)){\r\natn_cv = find_atn_conversation(&pinfo->src,\r\npinfo->clnp_srcref,\r\n&pinfo->dst );\r\nif(!atn_cv){\r\natn_cv = wmem_new(wmem_file_scope(), atn_conversation_t);\r\natn_cv->ae_qualifier = unknown;\r\ncreate_atn_conversation(&pinfo->src,\r\npinfo->clnp_srcref,\r\n&pinfo->dst ,\r\natn_cv);\r\n}\r\n}\r\noffset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,\r\nett_atn_ulcs_AARQ_apdu, AARQ_apdu_sequence);\r\naircraft_24_bit_address =\r\nget_aircraft_24_bit_address_from_nsap(pinfo);\r\naarq_data = (aarq_data_t *) wmem_tree_lookup32(\r\naarq_data_tree,\r\naircraft_24_bit_address);\r\nif(!aarq_data){\r\naarq_data = wmem_new(wmem_file_scope(), aarq_data_t);\r\naarq_data-> aarq_pending = FALSE;\r\nwmem_tree_insert32(aarq_data_tree ,aircraft_24_bit_address,(void*)aarq_data);\r\n}\r\nif (aarq_data-> aarq_pending == FALSE ) {\r\nmemset(aarq_data,0,sizeof(aarq_data_t));\r\naarq_data->cv = atn_cv;\r\naarq_data-> aarq_pending = TRUE;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_T_aare_apdu_protocol_version(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_bit_string(tvb, offset, actx, tree, hf_index,\r\nNO_BOUND, NO_BOUND, FALSE, NULL, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_Associate_result(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,\r\n0U, 2U, NULL, TRUE);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_T_acse_service_user(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,\r\n0U, 14U, NULL, TRUE);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_T_acse_service_provider(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,\r\n0U, 2U, NULL, TRUE);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_Associate_source_diagnostic(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_choice(tvb, offset, actx, tree, hf_index,\r\nett_atn_ulcs_Associate_source_diagnostic, Associate_source_diagnostic_choice,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_AARE_apdu(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\npacket_info * pinfo = actx->pinfo;\r\nguint32 aircraft_24_bit_address = 0 ;\r\natn_conversation_t *atn_cv = NULL;\r\naarq_data_t *aarq_data = NULL;\r\naircraft_24_bit_address = get_aircraft_24_bit_address_from_nsap(pinfo);\r\naarq_data = (aarq_data_t *) wmem_tree_lookup32(\r\naarq_data_tree,\r\naircraft_24_bit_address);\r\nif(!aarq_data) {\r\nreturn offset;\r\n}\r\nif((pinfo->clnp_dstref) && (!pinfo->clnp_srcref)){\r\natn_cv = find_atn_conversation(&pinfo->dst,\r\npinfo->clnp_dstref,\r\n&pinfo->src );\r\nif(!atn_cv){\r\ncreate_atn_conversation(&pinfo->dst,\r\npinfo->clnp_dstref,\r\n&pinfo->src ,\r\naarq_data->cv);\r\n}\r\n}\r\nif((pinfo->clnp_dstref) && (pinfo->clnp_srcref)){\r\natn_cv = find_atn_conversation(\r\n&pinfo->src,\r\npinfo->clnp_srcref,\r\n&pinfo->dst);\r\nif(atn_cv){\r\ncreate_atn_conversation(&pinfo->dst,\r\npinfo->clnp_dstref,\r\n&pinfo->src ,\r\naarq_data->cv);\r\n}else {\r\ncreate_atn_conversation(&pinfo->src,\r\npinfo->clnp_srcref,\r\n&pinfo->dst ,\r\naarq_data->cv);\r\ncreate_atn_conversation(&pinfo->dst,\r\npinfo->clnp_dstref,\r\n&pinfo->src ,\r\naarq_data->cv);\r\n}\r\n}\r\nmemset(aarq_data,0,sizeof(aarq_data_t));\r\naarq_data-> aarq_pending = FALSE;\r\noffset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,\r\nett_atn_ulcs_AARE_apdu, AARE_apdu_sequence);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_Release_request_reason(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,\r\n0U, 30U, NULL, TRUE);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_RLRQ_apdu(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,\r\nett_atn_ulcs_RLRQ_apdu, RLRQ_apdu_sequence);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_Release_response_reason(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_constrained_integer(\r\ntvb,\r\noffset,\r\nactx,\r\ntree,\r\nhf_index,\r\n0U,\r\n30U,\r\nNULL,\r\nTRUE);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_RLRE_apdu(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,\r\nett_atn_ulcs_RLRE_apdu, RLRE_apdu_sequence);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_ABRT_source(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_constrained_integer(tvb, offset, actx, tree, hf_index,\r\n0U, 1U, NULL, TRUE);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_ABRT_diagnostic(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_enumerated(tvb, offset, actx, tree, hf_index,\r\n6, NULL, TRUE, 0, ABRT_diagnostic_value_map);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_ABRT_apdu(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_sequence(tvb, offset, actx, tree, hf_index,\r\nett_atn_ulcs_ABRT_apdu, ABRT_apdu_sequence);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_atn_ulcs_ACSE_apdu(tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_per_choice(tvb, offset, actx, tree, hf_index,\r\nett_atn_ulcs_ACSE_apdu, ACSE_apdu_choice,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int dissect_Fully_encoded_data_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_PER, FALSE, pinfo);\r\noffset = dissect_atn_ulcs_Fully_encoded_data(tvb, offset, &asn1_ctx, tree, hf_atn_ulcs_Fully_encoded_data_PDU);\r\noffset += 7; offset >>= 3;\r\nreturn offset;\r\n}\r\nstatic int dissect_ACSE_apdu_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_PER, FALSE, pinfo);\r\noffset = dissect_atn_ulcs_ACSE_apdu(tvb, offset, &asn1_ctx, tree, hf_atn_ulcs_ACSE_apdu_PDU);\r\noffset += 7; offset >>= 3;\r\nreturn offset;\r\n}\r\nguint32 get_aircraft_24_bit_address_from_nsap(\r\npacket_info *pinfo)\r\n{\r\nconst guint8* addr = NULL;\r\nguint32 ars =0;\r\nguint32 adr_prefix =0;\r\nif( (pinfo->src.type != get_osi_address_type()) ||\r\n(pinfo->dst.type != get_osi_address_type())) {\r\nreturn ars; }\r\nif( (pinfo->src.len != 20) ||\r\n(pinfo->dst.len != 20)) {\r\nreturn ars; }\r\naddr = (const guint8 *)pinfo->src.data;\r\nadr_prefix =\r\n((addr[0]<<24) |\r\n(addr[1]<<16) |\r\n(addr[2]<<8) |\r\naddr[3] );\r\nif((adr_prefix == 0x470027c1) ||\r\n(adr_prefix == 0x47002741)) {\r\nars = ((addr[8])<<16) |\r\n((addr[9])<<8) |\r\n(addr[10]);\r\n}\r\naddr = (const guint8 *)pinfo->dst.data;\r\nadr_prefix = ((addr[0]<<24) |\r\n(addr[1]<<16) |\r\n(addr[2]<<8) |\r\naddr[3] );\r\nif((adr_prefix == 0x470027c1) ||\r\n(adr_prefix == 0x47002741)) {\r\nars = ((addr[8])<<16) |\r\n((addr[9])<<8) |\r\n(addr[10]);\r\n}\r\nreturn ars;\r\n}\r\nint check_heur_msg_type(packet_info *pinfo _U_)\r\n{\r\nint t = no_msg;\r\nconst guint8* addr = NULL;\r\nguint32 adr_prefix =0;\r\nif( (pinfo->src.type != get_osi_address_type()) || (pinfo->dst.type != get_osi_address_type())) {\r\nreturn t; }\r\nif( (pinfo->src.len != 20) || (pinfo->dst.len != 20)) {\r\nreturn t; }\r\naddr = (const guint8 *)pinfo->src.data;\r\nadr_prefix = ((addr[0]<<24) | (addr[1]<<16) | (addr[2]<<8) | addr[3] );\r\nif((adr_prefix == 0x470027c1) || (adr_prefix == 0x47002741)) {\r\nt = dm;\r\n}\r\naddr = (const guint8 *)pinfo->dst.data;\r\nadr_prefix = ((addr[0]<<24) | (addr[1]<<16) | (addr[2]<<8) | addr[3] );\r\nif((adr_prefix == 0x470027c1) || (adr_prefix == 0x47002741)) {\r\nt = um;\r\n}\r\nreturn t;\r\n}\r\nwmem_tree_t *get_atn_conversation_tree(void){\r\nreturn atn_conversation_tree;\r\n}\r\natn_conversation_t * find_atn_conversation(\r\naddress *address1,\r\nguint16 clnp_ref1,\r\naddress *address2 )\r\n{\r\natn_conversation_t *cv = NULL;\r\nguint32 key = 0;\r\nguint32 tmp = 0;\r\ntmp = add_address_to_hash( tmp, address1);\r\nkey = (tmp << 16) | clnp_ref1 ;\r\ntmp = add_address_to_hash( tmp, address2);\r\nkey = (tmp << 24) | key ;\r\ncv = (atn_conversation_t *)\r\nwmem_tree_lookup32(get_atn_conversation_tree(),key);\r\nreturn cv;\r\n}\r\natn_conversation_t * create_atn_conversation(\r\naddress *address1,\r\nguint16 clnp_ref1,\r\naddress *address2,\r\natn_conversation_t *conversation)\r\n{\r\natn_conversation_t *cv = NULL;\r\nguint32 key = 0;\r\nguint32 tmp = 0;\r\ntmp = add_address_to_hash( tmp, address1);\r\nkey = (tmp << 16) | clnp_ref1 ;\r\ntmp = add_address_to_hash( tmp, address2);\r\nkey = (tmp << 24) | key ;\r\ncv = (atn_conversation_t *)\r\nwmem_tree_lookup32(\r\nget_atn_conversation_tree(),\r\nkey);\r\nif(cv) {\r\nreturn NULL; }\r\nwmem_tree_insert32(\r\nget_atn_conversation_tree(),\r\nkey,\r\n(void*)conversation);\r\nreturn conversation;\r\n}\r\nstatic int\r\ndissect_atn_ulcs(\r\ntvbuff_t *tvb,\r\npacket_info *pinfo,\r\nproto_tree *tree,\r\nvoid *data _U_)\r\n{\r\nint offset = 0;\r\nproto_item *ti = NULL;\r\nproto_tree *atn_ulcs_tree = NULL;\r\nguint8 value_pres = 0;\r\nguint8 value_ses = 0;\r\nguint16 value_ses_pres = 0;\r\nroot_tree = tree;\r\nif ( (int)(intptr_t) data == FALSE )\r\n{\r\nti = proto_tree_add_item(\r\ntree,\r\nproto_atn_ulcs,\r\ntvb,\r\n0,\r\n0 ,\r\nENC_NA);\r\natn_ulcs_tree = proto_item_add_subtree(\r\nti,\r\nett_atn_ulcs);\r\ndissect_Fully_encoded_data_PDU(\r\ntvb,\r\npinfo,\r\natn_ulcs_tree, NULL);\r\nreturn offset +\r\ntvb_reported_length_remaining(tvb, offset ) ;\r\n}\r\nif ( (int)(intptr_t) data == TRUE )\r\n{\r\nvalue_ses_pres = tvb_get_ntohs(tvb, offset);\r\natn_ulcs_tree = proto_tree_add_subtree(\r\ntree, tvb, offset, 0,\r\nett_atn_ses, NULL, ATN_SES_PROTO );\r\nvalue_ses = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_item(atn_ulcs_tree,\r\nhf_atn_ses_type,\r\ntvb,\r\noffset,\r\n1,\r\nENC_BIG_ENDIAN );\r\nswitch(value_ses & SES_PDU_TYPE_MASK){\r\ncase SES_ATN_SRF:\r\ncase SES_ATN_SRFC:\r\nproto_tree_add_item(atn_ulcs_tree,\r\nhf_atn_ses_param_ind,\r\ntvb,\r\noffset,\r\n1,\r\nENC_BIG_ENDIAN );\r\nproto_tree_add_item(atn_ulcs_tree,\r\nhf_atn_ses_param_b2,\r\ntvb,\r\noffset,\r\n1,\r\nENC_BIG_ENDIAN );\r\nproto_tree_add_item(atn_ulcs_tree,\r\nhf_atn_ses_param_b1,\r\ntvb,\r\noffset,\r\n1,\r\nENC_BIG_ENDIAN );\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\noffset++;\r\natn_ulcs_tree = proto_tree_add_subtree(\r\ntree, tvb, offset, 0,\r\nett_atn_pres, NULL, ATN_PRES_PROTO );\r\nvalue_pres = tvb_get_guint8(tvb, offset);\r\nproto_tree_add_uint_format(atn_ulcs_tree, hf_atn_pres_pdu_type,\r\ntvb,\r\noffset,\r\n1,\r\nvalue_ses_pres,\r\n"%s (0x%02x)",\r\nval_to_str( value_ses_pres & ATN_SES_PRES_MASK , atn_pres_vals, "?"),\r\nvalue_pres);\r\nswitch(value_ses & SES_PDU_TYPE_MASK){\r\ncase SES_ATN_SRF:\r\ncase SES_ATN_SRFC:\r\nproto_tree_add_item(\r\natn_ulcs_tree,\r\nhf_atn_pres_err,\r\ntvb,\r\noffset,\r\n1,\r\nENC_BIG_ENDIAN );\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\noffset++;\r\natn_ulcs_tree = proto_tree_add_subtree(\r\ntree, tvb, offset, 0,\r\nett_atn_acse, NULL, ATN_ACSE_PROTO );\r\ndissect_ACSE_apdu_PDU(\r\ntvb_new_subset_remaining(tvb, offset),\r\npinfo,\r\natn_ulcs_tree, NULL);\r\nreturn offset +\r\ntvb_reported_length_remaining(tvb, offset );\r\n}\r\nreturn offset;\r\n}\r\nstatic gboolean dissect_atn_ulcs_heur(\r\ntvbuff_t *tvb,\r\npacket_info *pinfo,\r\nproto_tree *tree,\r\nvoid *data _U_)\r\n{\r\nif (tvb_captured_length(tvb) < 2){\r\nreturn FALSE; }\r\nswitch( tvb_get_ntohs(tvb, 0) & 0xf8ff ){\r\ncase 0xe802:\r\ncase 0xf802:\r\ncase 0xf002:\r\ncase 0xd802:\r\ncase 0xe002:\r\ncase 0xe012:\r\ncase 0xe022:\r\ncase 0xe032:\r\ncase 0xe042:\r\ncase 0xe052:\r\ncase 0xe062:\r\ncase 0xe072:\r\ncase 0xa002:\r\ncase 0xa012:\r\ncase 0xa022:\r\ncase 0xa032:\r\ncase 0xa042:\r\ncase 0xa052:\r\ncase 0xa062:\r\ncase 0xa072:\r\ndissect_atn_ulcs(\r\ntvb,\r\npinfo,\r\ntree,\r\n(void*) TRUE);\r\nreturn TRUE;\r\ndefault:\r\nbreak;\r\n}\r\nswitch( tvb_get_ntohs(tvb, 0) & 0xfff0 ){\r\ncase 0x0020:\r\ncase 0x00a0:\r\ndissect_atn_ulcs(tvb, pinfo, tree, (void*) FALSE);\r\nreturn TRUE;\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nreturn FALSE;\r\n}\r\nvoid proto_register_atn_ulcs (void)\r\n{\r\nstatic hf_register_info hf_atn_ulcs[] = {\r\n#line 1 "./asn1/atn-ulcs/packet-atn-ulcs-hfarr.c"\r\n{ &hf_atn_ulcs_Fully_encoded_data_PDU,\r\n{ "Fully-encoded-data", "atn-ulcs.Fully_encoded_data",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_ACSE_apdu_PDU,\r\n{ "ACSE-apdu", "atn-ulcs.ACSE_apdu",\r\nFT_UINT32, BASE_DEC, VALS(atn_ulcs_ACSE_apdu_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_Fully_encoded_data_item,\r\n{ "PDV-list", "atn-ulcs.PDV_list_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_transfer_syntax_name,\r\n{ "transfer-syntax-name", "atn-ulcs.transfer_syntax_name",\r\nFT_OID, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_presentation_context_identifier,\r\n{ "presentation-context-identifier", "atn-ulcs.presentation_context_identifier",\r\nFT_UINT32, BASE_DEC, VALS(atn_ulcs_Presentation_context_identifier_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_presentation_data_values,\r\n{ "presentation-data-values", "atn-ulcs.presentation_data_values",\r\nFT_UINT32, BASE_DEC, VALS(atn_ulcs_T_presentation_data_values_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_pdv_list_presentation_data_values_single_asn1_type,\r\n{ "single-ASN1-type", "atn-ulcs.single_ASN1_type_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"T_pdv_list_presentation_data_values_single_asn1_type", HFILL }},\r\n{ &hf_atn_ulcs_octet_aligned,\r\n{ "octet-aligned", "atn-ulcs.octet_aligned",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"OCTET_STRING", HFILL }},\r\n{ &hf_atn_ulcs_pdv_list_presentation_data_values_arbitrary,\r\n{ "arbitrary", "atn-ulcs.arbitrary",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"T_pdv_list_presentation_data_values_arbitrary", HFILL }},\r\n{ &hf_atn_ulcs_direct_reference,\r\n{ "direct-reference", "atn-ulcs.direct_reference",\r\nFT_OID, BASE_NONE, NULL, 0,\r\n"OBJECT_IDENTIFIER", HFILL }},\r\n{ &hf_atn_ulcs_indirect_reference,\r\n{ "indirect-reference", "atn-ulcs.indirect_reference",\r\nFT_INT32, BASE_DEC, NULL, 0,\r\n"INTEGER", HFILL }},\r\n{ &hf_atn_ulcs_data_value_descriptor,\r\n{ "data-value-descriptor", "atn-ulcs.data_value_descriptor",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_encoding,\r\n{ "encoding", "atn-ulcs.encoding",\r\nFT_UINT32, BASE_DEC, VALS(atn_ulcs_T_encoding_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_externalt_encoding_single_asn1_type,\r\n{ "single-ASN1-type", "atn-ulcs.single_ASN1_type_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"T_externalt_encoding_single_asn1_type", HFILL }},\r\n{ &hf_atn_ulcs_externalt_encoding_octet_aligned,\r\n{ "octet-aligned", "atn-ulcs.octet_aligned",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"T_externalt_encoding_octet_aligned", HFILL }},\r\n{ &hf_atn_ulcs_externalt_encoding_arbitrary,\r\n{ "arbitrary", "atn-ulcs.arbitrary",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"T_externalt_encoding_arbitrary", HFILL }},\r\n{ &hf_atn_ulcs_aarq,\r\n{ "aarq", "atn-ulcs.aarq_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"AARQ_apdu", HFILL }},\r\n{ &hf_atn_ulcs_aare,\r\n{ "aare", "atn-ulcs.aare_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"AARE_apdu", HFILL }},\r\n{ &hf_atn_ulcs_rlrq,\r\n{ "rlrq", "atn-ulcs.rlrq_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"RLRQ_apdu", HFILL }},\r\n{ &hf_atn_ulcs_rlre,\r\n{ "rlre", "atn-ulcs.rlre_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"RLRE_apdu", HFILL }},\r\n{ &hf_atn_ulcs_abrt,\r\n{ "abrt", "atn-ulcs.abrt_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"ABRT_apdu", HFILL }},\r\n{ &hf_atn_ulcs_aarq_apdu_protocol_version,\r\n{ "protocol-version", "atn-ulcs.protocol_version",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"T_aarq_apdu_protocol_version", HFILL }},\r\n{ &hf_atn_ulcs_application_context_name,\r\n{ "application-context-name", "atn-ulcs.application_context_name",\r\nFT_OID, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_called_AP_title,\r\n{ "called-AP-title", "atn-ulcs.called_AP_title",\r\nFT_UINT32, BASE_DEC, VALS(atn_ulcs_AP_title_vals), 0,\r\n"AP_title", HFILL }},\r\n{ &hf_atn_ulcs_called_AE_qualifier,\r\n{ "called-AE-qualifier", "atn-ulcs.called_AE_qualifier",\r\nFT_UINT32, BASE_DEC, VALS(atn_ulcs_AE_qualifier_vals), 0,\r\n"AE_qualifier", HFILL }},\r\n{ &hf_atn_ulcs_called_AP_invocation_identifier,\r\n{ "called-AP-invocation-identifier", "atn-ulcs.called_AP_invocation_identifier",\r\nFT_INT32, BASE_DEC, NULL, 0,\r\n"AP_invocation_identifier", HFILL }},\r\n{ &hf_atn_ulcs_called_AE_invocation_identifier,\r\n{ "called-AE-invocation-identifier", "atn-ulcs.called_AE_invocation_identifier",\r\nFT_INT32, BASE_DEC, NULL, 0,\r\n"AE_invocation_identifier", HFILL }},\r\n{ &hf_atn_ulcs_calling_AP_title,\r\n{ "calling-AP-title", "atn-ulcs.calling_AP_title",\r\nFT_UINT32, BASE_DEC, VALS(atn_ulcs_AP_title_vals), 0,\r\n"AP_title", HFILL }},\r\n{ &hf_atn_ulcs_calling_AE_qualifier,\r\n{ "calling-AE-qualifier", "atn-ulcs.calling_AE_qualifier",\r\nFT_UINT32, BASE_DEC, VALS(atn_ulcs_AE_qualifier_vals), 0,\r\n"AE_qualifier", HFILL }},\r\n{ &hf_atn_ulcs_calling_AP_invocation_identifier,\r\n{ "calling-AP-invocation-identifier", "atn-ulcs.calling_AP_invocation_identifier",\r\nFT_INT32, BASE_DEC, NULL, 0,\r\n"AP_invocation_identifier", HFILL }},\r\n{ &hf_atn_ulcs_calling_AE_invocation_identifier,\r\n{ "calling-AE-invocation-identifier", "atn-ulcs.calling_AE_invocation_identifier",\r\nFT_INT32, BASE_DEC, NULL, 0,\r\n"AE_invocation_identifier", HFILL }},\r\n{ &hf_atn_ulcs_sender_acse_requirements,\r\n{ "sender-acse-requirements", "atn-ulcs.sender_acse_requirements",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"ACSE_requirements", HFILL }},\r\n{ &hf_atn_ulcs_mechanism_name,\r\n{ "mechanism-name", "atn-ulcs.mechanism_name",\r\nFT_OID, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_calling_authentication_value,\r\n{ "calling-authentication-value", "atn-ulcs.calling_authentication_value",\r\nFT_UINT32, BASE_DEC, VALS(atn_ulcs_Authentication_value_vals), 0,\r\n"Authentication_value", HFILL }},\r\n{ &hf_atn_ulcs_application_context_name_list,\r\n{ "application-context-name-list", "atn-ulcs.application_context_name_list",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_implementation_information,\r\n{ "implementation-information", "atn-ulcs.implementation_information",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"Implementation_data", HFILL }},\r\n{ &hf_atn_ulcs_user_information,\r\n{ "user-information", "atn-ulcs.user_information",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\n"Association_information", HFILL }},\r\n{ &hf_atn_ulcs_aare_apdu_protocol_version,\r\n{ "protocol-version", "atn-ulcs.protocol_version",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"T_aare_apdu_protocol_version", HFILL }},\r\n{ &hf_atn_ulcs_result,\r\n{ "result", "atn-ulcs.result",\r\nFT_UINT32, BASE_DEC, VALS(atn_ulcs_Associate_result_vals), 0,\r\n"Associate_result", HFILL }},\r\n{ &hf_atn_ulcs_result_source_diagnostic,\r\n{ "result-source-diagnostic", "atn-ulcs.result_source_diagnostic",\r\nFT_UINT32, BASE_DEC, VALS(atn_ulcs_Associate_source_diagnostic_vals), 0,\r\n"Associate_source_diagnostic", HFILL }},\r\n{ &hf_atn_ulcs_responding_AP_title,\r\n{ "responding-AP-title", "atn-ulcs.responding_AP_title",\r\nFT_UINT32, BASE_DEC, VALS(atn_ulcs_AP_title_vals), 0,\r\n"AP_title", HFILL }},\r\n{ &hf_atn_ulcs_responding_AE_qualifier,\r\n{ "responding-AE-qualifier", "atn-ulcs.responding_AE_qualifier",\r\nFT_UINT32, BASE_DEC, VALS(atn_ulcs_AE_qualifier_vals), 0,\r\n"AE_qualifier", HFILL }},\r\n{ &hf_atn_ulcs_responding_AP_invocation_identifier,\r\n{ "responding-AP-invocation-identifier", "atn-ulcs.responding_AP_invocation_identifier",\r\nFT_INT32, BASE_DEC, NULL, 0,\r\n"AP_invocation_identifier", HFILL }},\r\n{ &hf_atn_ulcs_responding_AE_invocation_identifier,\r\n{ "responding-AE-invocation-identifier", "atn-ulcs.responding_AE_invocation_identifier",\r\nFT_INT32, BASE_DEC, NULL, 0,\r\n"AE_invocation_identifier", HFILL }},\r\n{ &hf_atn_ulcs_responder_acse_requirements,\r\n{ "responder-acse-requirements", "atn-ulcs.responder_acse_requirements",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"ACSE_requirements", HFILL }},\r\n{ &hf_atn_ulcs_responding_authentication_value,\r\n{ "responding-authentication-value", "atn-ulcs.responding_authentication_value",\r\nFT_UINT32, BASE_DEC, VALS(atn_ulcs_Authentication_value_vals), 0,\r\n"Authentication_value", HFILL }},\r\n{ &hf_atn_ulcs_rlrq_apdu_request_reason,\r\n{ "reason", "atn-ulcs.reason",\r\nFT_UINT32, BASE_DEC, VALS(atn_ulcs_Release_request_reason_vals), 0,\r\n"Release_request_reason", HFILL }},\r\n{ &hf_atn_ulcs_rlre_apdu_response_reason,\r\n{ "reason", "atn-ulcs.reason",\r\nFT_UINT32, BASE_DEC, VALS(atn_ulcs_Release_response_reason_vals), 0,\r\n"Release_response_reason", HFILL }},\r\n{ &hf_atn_ulcs_abort_source,\r\n{ "abort-source", "atn-ulcs.abort_source",\r\nFT_UINT32, BASE_DEC, VALS(atn_ulcs_ABRT_source_vals), 0,\r\n"ABRT_source", HFILL }},\r\n{ &hf_atn_ulcs_abort_diagnostic,\r\n{ "abort-diagnostic", "atn-ulcs.abort_diagnostic",\r\nFT_UINT32, BASE_DEC, VALS(atn_ulcs_ABRT_diagnostic_vals), 0,\r\n"ABRT_diagnostic", HFILL }},\r\n{ &hf_atn_ulcs_Application_context_name_list_item,\r\n{ "Application-context-name", "atn-ulcs.Application_context_name",\r\nFT_OID, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_ap_title_form2,\r\n{ "ap-title-form2", "atn-ulcs.ap_title_form2",\r\nFT_OID, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_ap_title_form1,\r\n{ "ap-title-form1", "atn-ulcs.ap_title_form1",\r\nFT_UINT32, BASE_DEC, VALS(atn_ulcs_Name_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_ae_qualifier_form2,\r\n{ "ae-qualifier-form2", "atn-ulcs.ae_qualifier_form2",\r\nFT_INT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_ae_qualifier_form1,\r\n{ "ae-qualifier-form1", "atn-ulcs.ae_qualifier_form1",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_acse_service_user,\r\n{ "acse-service-user", "atn-ulcs.acse_service_user",\r\nFT_UINT32, BASE_DEC, VALS(atn_ulcs_T_acse_service_user_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_acse_service_provider,\r\n{ "acse-service-provider", "atn-ulcs.acse_service_provider",\r\nFT_UINT32, BASE_DEC, VALS(atn_ulcs_T_acse_service_provider_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_Association_information_item,\r\n{ "EXTERNALt", "atn-ulcs.EXTERNALt_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_charstring,\r\n{ "charstring", "atn-ulcs.charstring",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"OCTET_STRING", HFILL }},\r\n{ &hf_atn_ulcs_bitstring,\r\n{ "bitstring", "atn-ulcs.bitstring",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\n"BIT_STRING", HFILL }},\r\n{ &hf_atn_ulcs_external,\r\n{ "external", "atn-ulcs.external_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_other,\r\n{ "other", "atn-ulcs.other_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_other_mechanism_name,\r\n{ "other-mechanism-name", "atn-ulcs.other_mechanism_name",\r\nFT_OID, BASE_NONE, NULL, 0,\r\n"OBJECT_IDENTIFIER", HFILL }},\r\n{ &hf_atn_ulcs_other_mechanism_value,\r\n{ "other-mechanism-value", "atn-ulcs.other_mechanism_value_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_rdnSequence,\r\n{ "rdnSequence", "atn-ulcs.rdnSequence",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_RDNSequence_item,\r\n{ "RelativeDistinguishedName", "atn-ulcs.RelativeDistinguishedName",\r\nFT_UINT32, BASE_DEC, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_RelativeDistinguishedName_item,\r\n{ "AttributeTypeAndValue", "atn-ulcs.AttributeTypeAndValue_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_null,\r\n{ "null", "atn-ulcs.null_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_T_aarq_apdu_protocol_version_version1,\r\n{ "version1", "atn-ulcs.version1",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_T_aare_apdu_protocol_version_version1,\r\n{ "version1", "atn-ulcs.version1",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_ACSE_requirements_authentication,\r\n{ "authentication", "atn-ulcs.authentication",\r\nFT_BOOLEAN, 8, NULL, 0x80,\r\nNULL, HFILL }},\r\n{ &hf_atn_ulcs_ACSE_requirements_application_context_negotiation,\r\n{ "application-context-negotiation", "atn-ulcs.application-context-negotiation",\r\nFT_BOOLEAN, 8, NULL, 0x40,\r\nNULL, HFILL }},\r\n#line 788 "./asn1/atn-ulcs/packet-atn-ulcs-template.c"\r\n{&hf_atn_ses_type,\r\n{ "SPDU Type",\r\n"atn-ulcs.ses.type",\r\nFT_UINT8,\r\nBASE_HEX,\r\nVALS(atn_ses_type),\r\n0xf8,\r\n"Indicates presence of session parameters",\r\nHFILL}},\r\n{&hf_atn_ses_param_ind,\r\n{ "SPDU Parameter Indication",\r\n"atn-ulcs.ses.parameter-indication",\r\nFT_UINT8,\r\nBASE_HEX,\r\nVALS(atn_ses_param_ind),\r\nSES_PARAM_IND_MASK,\r\n"Indicates presence of session parameters",\r\nHFILL}},\r\n{&hf_atn_ses_param_b1,\r\n{ "SRF Parameter B1",\r\n"atn-ulcs.ses.srf-b1",\r\nFT_UINT8,\r\nBASE_HEX,\r\nVALS(srf_b1),\r\n0x01,\r\n"Determines if transport connection reject is transient or persistent",\r\nHFILL}},\r\n{&hf_atn_ses_param_b2,\r\n{ "SRF Parameter B2",\r\n"atn-ulcs.ses.srf-b2",\r\nFT_UINT8,\r\nBASE_HEX,\r\nVALS(srf_b2),\r\n0x02,\r\n"Determines if transport connection is retained or released",\r\nHFILL}},\r\n{ &hf_atn_pres_err,\r\n{ "Error Code", "atn-ulcs.pres.cpr-error",\r\nFT_UINT8,\r\nBASE_HEX,\r\nVALS(atn_pres_err),\r\nPRES_CPR_ER_MASK,\r\nNULL,\r\nHFILL}},\r\n{ &hf_atn_pres_pdu_type,\r\n{ "PDU type", "atn-ulcs.pres.pdu_type",\r\nFT_UINT8,\r\nBASE_HEX,\r\nNULL,\r\nATN_SES_PRES_MASK,\r\nNULL,\r\nHFILL}},\r\n};\r\nstatic gint *ett[] = {\r\n#line 1 "./asn1/atn-ulcs/packet-atn-ulcs-ettarr.c"\r\n&ett_atn_ulcs_Fully_encoded_data,\r\n&ett_atn_ulcs_PDV_list,\r\n&ett_atn_ulcs_T_presentation_data_values,\r\n&ett_atn_ulcs_EXTERNALt,\r\n&ett_atn_ulcs_T_encoding,\r\n&ett_atn_ulcs_ACSE_apdu,\r\n&ett_atn_ulcs_AARQ_apdu,\r\n&ett_atn_ulcs_T_aarq_apdu_protocol_version,\r\n&ett_atn_ulcs_AARE_apdu,\r\n&ett_atn_ulcs_T_aare_apdu_protocol_version,\r\n&ett_atn_ulcs_RLRQ_apdu,\r\n&ett_atn_ulcs_RLRE_apdu,\r\n&ett_atn_ulcs_ABRT_apdu,\r\n&ett_atn_ulcs_ACSE_requirements,\r\n&ett_atn_ulcs_Application_context_name_list,\r\n&ett_atn_ulcs_AP_title,\r\n&ett_atn_ulcs_AE_qualifier,\r\n&ett_atn_ulcs_Associate_source_diagnostic,\r\n&ett_atn_ulcs_Association_information,\r\n&ett_atn_ulcs_Authentication_value,\r\n&ett_atn_ulcs_T_other,\r\n&ett_atn_ulcs_Name,\r\n&ett_atn_ulcs_RDNSequence,\r\n&ett_atn_ulcs_RelativeDistinguishedName,\r\n&ett_atn_ulcs_AttributeTypeAndValue,\r\n#line 844 "./asn1/atn-ulcs/packet-atn-ulcs-template.c"\r\n&ett_atn_ses,\r\n&ett_atn_pres,\r\n&ett_atn_acse,\r\n&ett_atn_ulcs\r\n};\r\nproto_atn_ulcs = proto_register_protocol (\r\nATN_ULCS_PROTO ,\r\n"ATN-ULCS",\r\n"atn-ulcs");\r\nproto_register_field_array (\r\nproto_atn_ulcs,\r\nhf_atn_ulcs,\r\narray_length(hf_atn_ulcs));\r\nproto_register_subtree_array (\r\nett,\r\narray_length (ett));\r\nregister_dissector(\r\n"atn-ulcs",\r\ndissect_atn_ulcs,\r\nproto_atn_ulcs);\r\natn_ulcs_heur_subdissector_list = register_heur_dissector_list("atn-ulcs", proto_atn_ulcs);\r\naarq_data_tree = wmem_tree_new_autoreset(wmem_epan_scope(), wmem_file_scope());\r\natn_conversation_tree = wmem_tree_new_autoreset(wmem_epan_scope(), wmem_file_scope());\r\n}\r\nvoid proto_reg_handoff_atn_ulcs(void)\r\n{\r\natn_cm_handle = find_dissector_add_dependency("atn-cm", proto_atn_ulcs);\r\natn_cpdlc_handle = find_dissector_add_dependency("atn-cpdlc", proto_atn_ulcs);\r\nheur_dissector_add(\r\n"cotp",\r\ndissect_atn_ulcs_heur,\r\n"ATN-ULCS over COTP",\r\n"atn-ucls_cotp",\r\nproto_atn_ulcs, HEURISTIC_ENABLE);\r\n}
