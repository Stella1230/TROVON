guint wimax_compact_ulmap_ie_decoder(proto_tree *tree, packet_info *pinfo, tvbuff_t *tvb, guint offset, guint nibble_offset)\r\n{\r\nguint uiuc, byte, length = 0;\r\nguint ul_map_type;\r\nguint harq_region_change_indication;\r\nguint cqi_region_change_indication;\r\nguint ul_map_offset, nibble_length;\r\nguint nband, band_count, i, allocation_mode;\r\n#ifdef DEBUG\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, NULL, "Compact UL-MAP IEs");\r\n#endif\r\nul_map_offset = offset;\r\nbyte = tvb_get_guint8(tvb, ul_map_offset);\r\nif(nibble_offset & 1)\r\n{\r\nul_map_type = ((byte & UL_MAP_TYPE_MASK_1) >> 1);\r\n}\r\nelse\r\n{\r\nul_map_type = ((byte & UL_MAP_TYPE_MASK) >> 5);\r\n}\r\nswitch (ul_map_type)\r\n{\r\ncase COMPACT_UL_MAP_TYPE_NORMAL_SUBCHANNEL:\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_culmap_ul_map_type_1, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_reserved_1, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\nnibble_offset = 0;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_culmap_ul_map_type, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_reserved, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nnibble_offset = 1;\r\n}\r\nlength = 1;\r\nnibble_length = wimax_compact_ulmap_rcid_ie_decoder(tree, pinfo, tvb, ul_map_offset, nibble_offset);\r\nlength += nibble_length;\r\nul_map_offset += (nibble_length >> 1);\r\nnibble_offset = (nibble_length & 1);\r\nif(!harq_mode)\r\n{\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_culmap_nep_code_1, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\nproto_tree_add_item(tree, hf_culmap_nsch_code, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_culmap_nep_code, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_nsch_code_1, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\n}\r\nlength += 2;\r\n}\r\nelse if(harq_mode == 1)\r\n{\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_culmap_shortened_uiuc_1, tvb, ul_map_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_companded_sc_1, tvb, ul_map_offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_culmap_shortened_uiuc, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_companded_sc, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nul_map_offset++;\r\nlength += 2;\r\n}\r\nnibble_length = wimax_compact_ulmap_harq_control_ie_decoder(tree, pinfo, tvb, ul_map_offset, nibble_offset);\r\nlength += nibble_length;\r\nbreak;\r\ncase COMPACT_UL_MAP_TYPE_BAND_AMC:\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_culmap_ul_map_type_1, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_reserved_1, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\nnibble_offset = 0;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_culmap_ul_map_type, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_reserved, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nnibble_offset = 1;\r\n}\r\nlength = 1;\r\nnibble_length = wimax_compact_ulmap_rcid_ie_decoder(tree, pinfo, tvb, ul_map_offset, nibble_offset);\r\nlength += nibble_length;\r\nul_map_offset += (nibble_length >> 1);\r\nnibble_offset = (nibble_length & 1);\r\nif(!harq_mode)\r\n{\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_culmap_nep_code_1, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\nproto_tree_add_item(tree, hf_culmap_nsch_code, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_culmap_nep_code, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_nsch_code_1, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\n}\r\nlength += 2;\r\n}\r\nelse if(harq_mode == 1)\r\n{\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_culmap_shortened_uiuc_1, tvb, ul_map_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_companded_sc_1, tvb, ul_map_offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_culmap_shortened_uiuc, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_companded_sc, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nul_map_offset++;\r\nlength += 2;\r\n}\r\nif(max_logical_bands)\r\n{\r\nnband = tvb_get_guint8(tvb, ul_map_offset);\r\nlength++;\r\nif(nibble_offset & 1)\r\n{\r\nnband = (nband & LSB_NIBBLE_MASK);\r\nproto_tree_add_item(tree, hf_culmap_num_bands_1, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\nnibble_offset = 0;\r\nif(max_logical_bands == 3)\r\n{\r\nproto_tree_add_item(tree, hf_culmap_band_index, tvb, ul_map_offset, nband, ENC_NA);\r\nlength += (nband * 2);\r\nul_map_offset += nband;\r\n}\r\nelse\r\n{\r\nnibble_offset = (nband & 1);\r\nproto_tree_add_item(tree, hf_culmap_band_index, tvb, ul_map_offset, ((nband >> 1) + nibble_offset), ENC_NA);\r\nlength += nband;\r\nul_map_offset += (nband >> 1);\r\n}\r\n}\r\nelse\r\n{\r\nnband = ((nband & MSB_NIBBLE_MASK) >> 4);\r\nproto_tree_add_item(tree, hf_culmap_num_bands, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nnibble_offset = 1;\r\nif(max_logical_bands == 3)\r\n{\r\nproto_tree_add_item(tree, hf_culmap_band_index, tvb, ul_map_offset, (nband + nibble_offset), ENC_NA);\r\nlength += (nband * 2);\r\nul_map_offset += nband;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_culmap_band_index, tvb, ul_map_offset, ((nband >> 1) + nibble_offset), ENC_NA);\r\nlength += nband;\r\nul_map_offset += ((nband + nibble_offset) >> 1);\r\nif(nband & 1)\r\nnibble_offset = 0;\r\n}\r\n}\r\nband_count = nband;\r\n}\r\nelse\r\n{\r\nband_count = 1;\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_culmap_nb_bitmap_1, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\nnibble_offset = 0;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_culmap_nb_bitmap, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nnibble_offset = 1;\r\n}\r\nlength++;\r\n}\r\nbyte = tvb_get_guint8(tvb, ul_map_offset);\r\nif(nibble_offset & 1)\r\n{\r\nallocation_mode = ((byte & ALLOCATION_MODE_MASK_1) >> 2);\r\nproto_tree_add_item(tree, hf_culmap_allocation_mode_1, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_allocation_mode_rsvd_1, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nnibble_offset = 0;\r\nul_map_offset++;\r\n}\r\nelse\r\n{\r\nallocation_mode = ((byte & ALLOCATION_MODE_MASK) >> 6);\r\nproto_tree_add_item(tree, hf_culmap_allocation_mode, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_allocation_mode_rsvd, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nnibble_offset = 1;\r\n}\r\nlength++;\r\nif(!allocation_mode)\r\n{\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_culmap_num_subchannels_1, tvb, ul_map_offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_culmap_num_subchannels, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nul_map_offset++;\r\nlength += 2;\r\n}\r\nelse if(allocation_mode == 1)\r\n{\r\nfor(i=0; i<band_count; i++)\r\n{\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_culmap_num_subchannels_1, tvb, ul_map_offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_culmap_num_subchannels, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nul_map_offset++;\r\n}\r\nlength += (band_count * 2);\r\n}\r\nnibble_length = wimax_compact_ulmap_harq_control_ie_decoder(tree, pinfo, tvb, ul_map_offset, nibble_offset);\r\nlength += nibble_length;\r\nbreak;\r\ncase COMPACT_UL_MAP_TYPE_SAFETY:\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_culmap_ul_map_type_1, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_reserved_1, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\nnibble_offset = 0;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_culmap_ul_map_type, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_reserved, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nnibble_offset = 1;\r\n}\r\nlength = 1;\r\nnibble_length = wimax_compact_ulmap_rcid_ie_decoder(tree, pinfo, tvb, ul_map_offset, nibble_offset);\r\nlength += nibble_length;\r\nul_map_offset += (nibble_length >> 1);\r\nnibble_offset = (nibble_length & 1);\r\nif(!harq_mode)\r\n{\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_culmap_nep_code_1, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\nproto_tree_add_item(tree, hf_culmap_nsch_code, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_culmap_nep_code, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_nsch_code_1, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\n}\r\nlength += 2;\r\n}\r\nelse if(harq_mode == 1)\r\n{\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_culmap_shortened_uiuc_1, tvb, ul_map_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_companded_sc_1, tvb, ul_map_offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_culmap_shortened_uiuc, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_companded_sc, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nul_map_offset++;\r\nlength += 2;\r\n}\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_culmap_bin_offset_1, tvb, ul_map_offset, 2, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_culmap_bin_offset, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\n}\r\nlength += 2;\r\nnibble_length = wimax_compact_ulmap_harq_control_ie_decoder(tree, pinfo, tvb, ul_map_offset, nibble_offset);\r\nlength += nibble_length;\r\nbreak;\r\ncase COMPACT_UL_MAP_TYPE_UIUC:\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_culmap_ul_map_type_1, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_reserved_1, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\nbyte = tvb_get_guint8(tvb, ul_map_offset);\r\nuiuc = ((byte & MSB_NIBBLE_MASK) >> 4);\r\nproto_tree_add_item(tree, hf_culmap_uiuc, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_culmap_ul_map_type, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_reserved, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nuiuc = (byte & LSB_NIBBLE_MASK);\r\nproto_tree_add_item(tree, hf_culmap_uiuc_1, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nlength = 2;\r\nnibble_length = wimax_compact_ulmap_rcid_ie_decoder(tree, pinfo, tvb, ul_map_offset, nibble_offset);\r\nlength += nibble_length;\r\nul_map_offset += (nibble_length >> 1);\r\nnibble_offset = (nibble_length & 1);\r\nif(uiuc == 15)\r\n{\r\nnibble_length = wimax_extended_uiuc_dependent_ie_decoder(tree, pinfo, tvb, ul_map_offset, nibble_offset);\r\nlength += nibble_length;\r\nul_map_offset += (nibble_length >> 1);\r\nnibble_offset = (nibble_length & 1);\r\n}\r\nelse if(uiuc == 14)\r\n{\r\nnibble_length = wimax_cdma_allocation_ie_decoder(tree, pinfo, tvb, ul_map_offset, nibble_offset);\r\nlength += nibble_length;\r\nul_map_offset += (nibble_length >> 1);\r\nnibble_offset = (nibble_length & 1);\r\n}\r\nelse if(uiuc == 12)\r\n{\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_culmap_uiuc_ofdma_symbol_offset_1, tvb, ul_map_offset, 2, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\nproto_tree_add_item(tree, hf_culmap_uiuc_subchannel_offset_7_1, tvb, ul_map_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_uiuc_num_of_ofdma_symbols_7_1, tvb, ul_map_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_uiuc_num_of_subchannels_7_1, tvb, ul_map_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_uiuc_ranging_method_1, tvb, ul_map_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_uiuc_reserved_1, tvb, ul_map_offset, 4, ENC_BIG_ENDIAN);\r\nul_map_offset += 3;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_culmap_uiuc_ofdma_symbol_offset, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\nproto_tree_add_item(tree, hf_culmap_uiuc_subchannel_offset_7, tvb, ul_map_offset, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_uiuc_num_of_ofdma_symbols_7, tvb, ul_map_offset, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_uiuc_num_of_subchannels_7, tvb, ul_map_offset, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_uiuc_ranging_method, tvb, ul_map_offset, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_uiuc_reserved, tvb, ul_map_offset, 3, ENC_BIG_ENDIAN);\r\nul_map_offset += 3;\r\n}\r\nlength += 8;\r\n}\r\nelse\r\n{\r\nif(nibble_offset & 1)\r\nproto_tree_add_item(tree, hf_culmap_uiuc_num_of_subchannels_1, tvb, ul_map_offset, 2, ENC_BIG_ENDIAN);\r\nelse\r\nproto_tree_add_item(tree, hf_culmap_uiuc_num_of_subchannels, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nlength += 2;\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_culmap_uiuc_repetition_coding_indication_1, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_uiuc_reserved_1, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nnibble_offset = 0;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_culmap_uiuc_repetition_coding_indication, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_uiuc_reserved, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nnibble_offset = 1;\r\n}\r\nlength += 1;\r\n}\r\nnibble_length = wimax_compact_ulmap_harq_control_ie_decoder(tree, pinfo, tvb, ul_map_offset, nibble_offset);\r\nlength += nibble_length;\r\nbreak;\r\ncase COMPACT_UL_MAP_TYPE_HARQ_REGION_IE:\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_culmap_ul_map_type_1, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_harq_region_change_indication_1, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nharq_region_change_indication = (byte & 0x01);\r\nul_map_offset++;\r\nnibble_offset = 0;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_culmap_ul_map_type, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_harq_region_change_indication, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nharq_region_change_indication = (byte & 0x10);\r\nnibble_offset = 1;\r\n}\r\nlength = 1;\r\nif(harq_region_change_indication == 1)\r\n{\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_culmap_uiuc_ofdma_symbol_offset_1, tvb, ul_map_offset, 2, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\nproto_tree_add_item(tree, hf_culmap_uiuc_subchannel_offset_1, tvb, ul_map_offset, 2, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\nproto_tree_add_item(tree, hf_culmap_uiuc_num_of_ofdma_symbols_1, tvb, ul_map_offset, 2, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\nproto_tree_add_item(tree, hf_culmap_uiuc_num_of_subchannels_1, tvb, ul_map_offset, 2, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_culmap_uiuc_ofdma_symbol_offset, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\nproto_tree_add_item(tree, hf_culmap_uiuc_subchannel_offset, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\nproto_tree_add_item(tree, hf_culmap_uiuc_num_of_ofdma_symbols, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\nproto_tree_add_item(tree, hf_culmap_uiuc_num_of_subchannels, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\n}\r\nlength += 8;\r\n}\r\nbreak;\r\ncase COMPACT_UL_MAP_TYPE_CQICH_REGION_IE:\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_culmap_ul_map_type_1, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_cqi_region_change_indication_1, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\ncqi_region_change_indication = (byte & 0x01);\r\nul_map_offset++;\r\nnibble_offset = 0;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_culmap_ul_map_type, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_cqi_region_change_indication, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\ncqi_region_change_indication = (byte & 0x10);\r\nnibble_offset = 1;\r\n}\r\nlength = 1;\r\nif(cqi_region_change_indication == 1)\r\n{\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_culmap_uiuc_ofdma_symbol_offset_1, tvb, ul_map_offset, 2, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\nproto_tree_add_item(tree, hf_culmap_uiuc_subchannel_offset_1, tvb, ul_map_offset, 2, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\nproto_tree_add_item(tree, hf_culmap_uiuc_num_of_ofdma_symbols_1, tvb, ul_map_offset, 2, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\nproto_tree_add_item(tree, hf_culmap_uiuc_num_of_subchannels_1, tvb, ul_map_offset, 2, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_culmap_uiuc_ofdma_symbol_offset, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\nproto_tree_add_item(tree, hf_culmap_uiuc_subchannel_offset, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\nproto_tree_add_item(tree, hf_culmap_uiuc_num_of_ofdma_symbols, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\nproto_tree_add_item(tree, hf_culmap_uiuc_num_of_subchannels, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nul_map_offset++;\r\n}\r\nlength += 8;\r\n}\r\nbreak;\r\ncase COMPACT_UL_MAP_TYPE_EXTENSION:\r\nnibble_length = wimax_culmap_extension_ie_decoder(tree, pinfo, tvb, ul_map_offset, nibble_offset);\r\nlength = nibble_length;\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(tree, hf_culmap_reserved_type_1, tvb, ul_map_offset, 1, ENC_BIG_ENDIAN);\r\nlength = 1;\r\nbreak;\r\n}\r\nreturn length;\r\n}\r\nstatic guint wimax_compact_ulmap_rcid_ie_decoder(proto_tree *tree, packet_info *pinfo _U_, tvbuff_t *tvb, guint offset, guint nibble_offset)\r\n{\r\nguint length = 0;\r\nguint prefix;\r\n#ifdef DEBUG\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, NULL, "RCID IE");\r\n#endif\r\nif(nibble_offset & 1)\r\n{\r\nif(cid_type == CID_TYPE_NORMAL)\r\n{\r\nproto_tree_add_item(tree, hf_rcid_ie_normal_cid_1, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nlength = 4;\r\n}\r\nelse\r\n{\r\nprefix = (tvb_get_guint8(tvb, offset) & 0x08);\r\nproto_tree_add_item(tree, hf_rcid_ie_prefix_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nif(prefix)\r\n{\r\nproto_tree_add_item(tree, hf_rcid_ie_cid11_3, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nlength = 3;\r\n}\r\nelse\r\n{\r\nif(cid_type == CID_TYPE_RCID11)\r\n{\r\nproto_tree_add_item(tree, hf_rcid_ie_cid11_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nlength = 3;\r\n}\r\nelse if(cid_type == CID_TYPE_RCID7)\r\n{\r\nproto_tree_add_item(tree, hf_rcid_ie_cid7_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nlength = 2;\r\n}\r\nelse if(cid_type == CID_TYPE_RCID3)\r\n{\r\nproto_tree_add_item(tree, hf_rcid_ie_cid3_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nlength = 1;\r\n}\r\n}\r\n}\r\n}\r\nelse\r\n{\r\nif(cid_type == CID_TYPE_NORMAL)\r\n{\r\nproto_tree_add_item(tree, hf_rcid_ie_normal_cid, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nlength = 4;\r\n}\r\nelse\r\n{\r\nprefix = (tvb_get_guint8(tvb, offset) & 0x08);\r\nproto_tree_add_item(tree, hf_rcid_ie_prefix, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nif(prefix || (cid_type == CID_TYPE_RCID11))\r\n{\r\nproto_tree_add_item(tree, hf_rcid_ie_cid11_2, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nlength = 3;\r\n}\r\nelse\r\n{\r\nif(cid_type == CID_TYPE_RCID11)\r\n{\r\nproto_tree_add_item(tree, hf_rcid_ie_cid11, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nlength = 3;\r\n}\r\nelse if(cid_type == CID_TYPE_RCID7)\r\n{\r\nproto_tree_add_item(tree, hf_rcid_ie_cid7, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nlength = 2;\r\n}\r\nelse if(cid_type == CID_TYPE_RCID3)\r\n{\r\nproto_tree_add_item(tree, hf_rcid_ie_cid3, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nlength = 1;\r\n}\r\n}\r\n}\r\n}\r\nreturn length;\r\n}\r\nstatic guint wimax_compact_ulmap_harq_control_ie_decoder(proto_tree *tree, packet_info *pinfo _U_, tvbuff_t *tvb, guint offset, guint nibble_offset)\r\n{\r\nguint byte, prefix, length = 0;\r\n#ifdef DEBUG\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, NULL, "HARQ Control IE");\r\n#endif\r\nbyte = tvb_get_guint8(tvb, offset);\r\nif(nibble_offset & 1)\r\n{\r\nprefix = (byte & 0x08);\r\nproto_tree_add_item(tree, hf_harq_control_ie_prefix_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nif(prefix)\r\n{\r\nproto_tree_add_item(tree, hf_harq_control_ie_ai_sn_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_harq_control_ie_spid_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_harq_control_ie_acid_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nlength = 2;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_harq_control_ie_reserved_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nlength = 1;\r\n}\r\n}\r\nelse\r\n{\r\nprefix = (byte & 0x80);\r\nproto_tree_add_item(tree, hf_harq_control_ie_prefix, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nif(prefix)\r\n{\r\nproto_tree_add_item(tree, hf_harq_control_ie_ai_sn, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_harq_control_ie_spid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_harq_control_ie_acid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nlength = 2;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_harq_control_ie_reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nlength = 1;\r\n}\r\n}\r\nreturn length;\r\n}\r\nstatic guint wimax_culmap_extension_ie_decoder(proto_tree *tree, packet_info *pinfo _U_, tvbuff_t *tvb, guint offset, guint nibble_offset)\r\n{\r\nguint tvb_value, ul_map_type, sub_type, length;\r\n#ifdef DEBUG\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, NULL, "UL-MAP Extension IE");\r\n#endif\r\ntvb_value = tvb_get_ntohs(tvb, offset);\r\nif(nibble_offset & 1)\r\n{\r\nul_map_type = ((tvb_value & EXTENSION_TYPE_MASK_1) >> EXTENSION_TYPE_SHIFT_1);\r\nif(ul_map_type != COMPACT_UL_MAP_TYPE_EXTENSION)\r\nreturn 0;\r\nsub_type = ((tvb_value & EXTENSION_SUBTYPE_MASK_1) >> EXTENSION_SUBTYPE_SHIFT_1);\r\nlength = (tvb_value & EXTENSION_LENGTH_MASK_1);\r\nproto_tree_add_item(tree, hf_culmap_extension_type_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_extension_subtype_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_extension_length_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nswitch (sub_type)\r\n{\r\ncase HARQ_MODE_SWITCH:\r\nproto_tree_add_item(tree, hf_culmap_extension_harq_mode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ntvb_value = tvb_get_guint8(tvb, offset);\r\nharq_mode = ((tvb_value & MSB_NIBBLE_MASK) >> 4);\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(tree, hf_culmap_extension_unknown_sub_type_1, tvb, offset, (length - 2), ENC_NA);\r\nbreak;\r\n}\r\n}\r\nelse\r\n{\r\nul_map_type = ((tvb_value & EXTENSION_TYPE_MASK) >> EXTENSION_TYPE_SHIFT);\r\nif(ul_map_type != COMPACT_UL_MAP_TYPE_EXTENSION)\r\nreturn 0;\r\nsub_type = ((tvb_value & EXTENSION_SUBTYPE_MASK) >> EXTENSION_SUBTYPE_SHIFT);\r\nlength = ((tvb_value & EXTENSION_LENGTH_MASK) >> EXTENSION_LENGTH_SHIFT);\r\nproto_tree_add_item(tree, hf_culmap_extension_type, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_extension_subtype, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_culmap_extension_length, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nswitch (sub_type)\r\n{\r\ncase HARQ_MODE_SWITCH:\r\nproto_tree_add_item(tree, hf_culmap_extension_harq_mode_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nharq_mode = (tvb_value & LSB_NIBBLE_MASK);\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(tree, hf_culmap_extension_unknown_sub_type, tvb, (offset + 1), (length - 1), ENC_NA);\r\nbreak;\r\n}\r\n}\r\nreturn (length * 2);\r\n}\r\nguint wimax_cdma_allocation_ie_decoder(proto_tree *tree, packet_info *pinfo _U_, tvbuff_t *tvb, guint offset, guint nibble_offset)\r\n{\r\n#ifdef DEBUG\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, NULL, "CDMA Allocation IE");\r\n#endif\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_cdma_allocation_duration_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdma_allocation_uiuc_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdma_allocation_repetition_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdma_allocation_frame_number_index_1, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdma_allocation_ranging_code_1, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdma_allocation_ranging_symbol_1, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdma_allocation_ranging_subchannel_1, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdma_allocation_bw_req_1, tvb, offset, 4, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_cdma_allocation_duration, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdma_allocation_uiuc, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdma_allocation_repetition, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdma_allocation_frame_number_index, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdma_allocation_ranging_code, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdma_allocation_ranging_symbol, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdma_allocation_ranging_subchannel, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdma_allocation_bw_req, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nreturn 8;\r\n}\r\nguint wimax_extended_uiuc_dependent_ie_decoder(proto_tree *tree, packet_info *pinfo _U_, tvbuff_t *tvb, guint offset, guint nibble_offset)\r\n{\r\nguint ext_uiuc, length, m, i;\r\nguint8 byte;\r\n#ifdef DEBUG\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, NULL, "Extended UIUC IE");\r\n#endif\r\nbyte = tvb_get_guint8(tvb, offset);\r\nif(nibble_offset & 1)\r\n{\r\next_uiuc = (byte & LSB_NIBBLE_MASK);\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_uiuc_1, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nbyte = tvb_get_guint8(tvb, offset);\r\nlength = ((byte & MSB_NIBBLE_MASK) >> 4);\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_length_1, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\next_uiuc = ((byte & MSB_NIBBLE_MASK) >> 4);\r\nlength = (byte & LSB_NIBBLE_MASK);\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_uiuc, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\n}\r\nswitch (ext_uiuc)\r\n{\r\ncase POWER_CONTROL_IE:\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_power_control_24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_power_measurement_frame_24, tvb, offset, 3, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_power_control, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_power_measurement_frame, tvb, (offset + 1), 1, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase MINI_SUBCHANNEL_ALLOCATION_IE:\r\nswitch (length)\r\n{\r\ncase 15:\r\nm = 6;\r\nbreak;\r\ncase 9:\r\nm = 3;\r\nbreak;\r\ncase 7:\r\ndefault:\r\nm = 2;\r\nbreak;\r\n}\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_mini_subchannel_alloc_ctype_16, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_mini_subchannel_alloc_duration_16, tvb, offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_mini_subchannel_alloc_ctype, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_mini_subchannel_alloc_duration, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\noffset++;\r\nfor(i=0; i<m; i+=2)\r\n{\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_mini_subchannel_alloc_cid_1, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_mini_subchannel_alloc_uiuc_1, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_mini_subchannel_alloc_repetition_1, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nif(i < (m-2))\r\n{\r\noffset += 3;\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_mini_subchannel_alloc_cid_3, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_mini_subchannel_alloc_uiuc_3, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_mini_subchannel_alloc_repetition_3, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 3;\r\n}\r\nelse if(m == 3)\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_mini_subchannel_alloc_padding_1, tvb, offset, 4, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_mini_subchannel_alloc_cid, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_mini_subchannel_alloc_uiuc, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_mini_subchannel_alloc_repetition, tvb, offset, 3, ENC_BIG_ENDIAN);\r\noffset += 3;\r\nif(i < (m-2))\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_mini_subchannel_alloc_cid_2, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_mini_subchannel_alloc_uiuc_2, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_mini_subchannel_alloc_repetition_2, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\n}\r\nelse if(m == 3)\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_mini_subchannel_alloc_padding, tvb, offset, 1, ENC_BIG_ENDIAN);\r\n}\r\n}\r\n}\r\nbreak;\r\ncase AAS_UL_IE:\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_aas_ul, tvb, offset, (length + 1), ENC_NA);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_aas_ul, tvb, offset, length, ENC_NA);\r\n}\r\nbreak;\r\ncase CQICH_ALLOC_IE:\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_cqich_alloc, tvb, offset, (length + 1), ENC_NA);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_cqich_alloc, tvb, offset, length, ENC_NA);\r\n}\r\nbreak;\r\ncase UL_ZONE_IE:\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_ul_zone, tvb, offset, (length + 1), ENC_NA);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_ul_zone, tvb, offset, length, ENC_NA);\r\n}\r\nbreak;\r\ncase PHYMOD_UL_IE:\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_phymod_ul, tvb, offset, (length + 1), ENC_NA);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_phymod_ul, tvb, offset, length, ENC_NA);\r\n}\r\nbreak;\r\ncase MIMO_UL_BASIC_IE:\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_mimo_ul_basic, tvb, offset, (length + 1), ENC_NA);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_mimo_ul_basic, tvb, offset, length, ENC_NA);\r\n}\r\nbreak;\r\ncase UL_MAP_FAST_TRACKING_IE:\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_fast_tracking, tvb, offset, (length + 1), ENC_NA);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_fast_tracking, tvb, offset, length, ENC_NA);\r\n}\r\nbreak;\r\ncase UL_PUSC_BURST_ALLOCATION_IN_OTHER_SEGMENT_IE:\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_ul_pusc_burst_allocation, tvb, offset, (length + 1), ENC_NA);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_ul_pusc_burst_allocation, tvb, offset, length, ENC_NA);\r\n}\r\nbreak;\r\ncase FAST_RANGING_IE:\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_fast_ranging, tvb, offset, (length + 1), ENC_NA);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_fast_ranging, tvb, offset, length, ENC_NA);\r\n}\r\nbreak;\r\ncase UL_ALLOCATION_START_IE:\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_ul_allocation_start, tvb, offset, (length + 1), ENC_NA);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_ul_allocation_start, tvb, offset, length, ENC_NA);\r\n}\r\nbreak;\r\ndefault:\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_unknown_uiuc, tvb, offset, (length + 1), ENC_NA);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_extended_uiuc_ie_unknown_uiuc, tvb, offset, length, ENC_NA);\r\n}\r\nbreak;\r\n}\r\nreturn ((length + 1) * 2 );\r\n}\r\nvoid proto_register_wimax_compact_ulmap_ie(void)\r\n{\r\nstatic hf_register_info hf_compact_ulmap[] =\r\n{\r\n{\r\n&hf_culmap_ul_map_type,\r\n{"UL-MAP Type", "wmx.compact_ulmap.ul_map_type", FT_UINT8, BASE_DEC, NULL, UL_MAP_TYPE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_ul_map_type_1,\r\n{"UL-MAP Type", "wmx.compact_ulmap.ul_map_type", FT_UINT8, BASE_DEC, NULL, UL_MAP_TYPE_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_reserved,\r\n{"Reserved", "wmx.compact_ulmap.reserved", FT_UINT8, BASE_HEX, NULL, UL_MAP_RESERVED_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_reserved_1,\r\n{"Reserved", "wmx.compact_ulmap.reserved", FT_UINT8, BASE_HEX, NULL, UL_MAP_RESERVED_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_nep_code,\r\n{"Nep Code", "wmx.compact_ulmap.nep_code", FT_UINT8, BASE_HEX, NULL, MSB_NIBBLE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_nep_code_1,\r\n{"Nep Code", "wmx.compact_ulmap.nep_code", FT_UINT8, BASE_HEX, NULL, LSB_NIBBLE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_nsch_code,\r\n{"Nsch Code", "wmx.compact_ulmap.nsch_code", FT_UINT8, BASE_HEX, NULL, MSB_NIBBLE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_nsch_code_1,\r\n{"Nsch Code", "wmx.compact_ulmap.nsch_code", FT_UINT8, BASE_HEX, NULL, LSB_NIBBLE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_shortened_uiuc,\r\n{"Shortened UIUC", "wmx.compact_ulmap.shortened_uiuc", FT_UINT8, BASE_HEX, NULL, SHORTENED_UIUC_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_companded_sc,\r\n{"Companded SC", "wmx.compact_ulmap.companded_sc", FT_UINT8, BASE_HEX, NULL, COMPANDED_SC_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_shortened_uiuc_1,\r\n{"Shortened UIUC", "wmx.compact_ulmap.shortened_uiuc", FT_UINT16, BASE_HEX, NULL, SHORTENED_UIUC_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_companded_sc_1,\r\n{"Companded SC", "wmx.compact_ulmap.companded_sc", FT_UINT16, BASE_HEX, NULL, COMPANDED_SC_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_num_bands,\r\n{"Number Of Bands", "wmx.compact_ulmap.num_bands", FT_UINT8, BASE_HEX, NULL, MSB_NIBBLE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_num_bands_1,\r\n{"Number Of Bands", "wmx.compact_ulmap.num_bands", FT_UINT8, BASE_HEX, NULL, LSB_NIBBLE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_band_index,\r\n{"Band Index", "wmx.compact_ulmap.band_index", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_nb_bitmap,\r\n{"Number Of Bits For Band BITMAP", "wmx.compact_ulmap.nb_bitmap", FT_UINT8, BASE_HEX, NULL, MSB_NIBBLE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_nb_bitmap_1,\r\n{"Number Of Bits For Band BITMAP", "wmx.compact_ulmap.nb_bitmap", FT_UINT8, BASE_HEX, NULL, LSB_NIBBLE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_allocation_mode,\r\n{"Allocation Mode", "wmx.compact_ulmap.allocation_mode", FT_UINT8, BASE_DEC, VALS(vals_allocation_modes), ALLOCATION_MODE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_allocation_mode_1,\r\n{"Allocation Mode", "wmx.compact_ulmap.allocation_mode", FT_UINT8, BASE_DEC, VALS(vals_allocation_modes), ALLOCATION_MODE_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_allocation_mode_rsvd,\r\n{"Reserved", "wmx.compact_ulmap.allocation_mode_rsvd", FT_UINT8, BASE_DEC, NULL, 0x30, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_allocation_mode_rsvd_1,\r\n{"Reserved", "wmx.compact_ulmap.allocation_mode_rsvd", FT_UINT8, BASE_DEC, NULL, 0x03, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_num_subchannels,\r\n{"Number Of Subchannels", "wmx.compact_ulmap.num_subchannels", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_num_subchannels_1,\r\n{"Number Of Subchannels", "wmx.compact_ulmap.num_subchannels", FT_UINT16, BASE_DEC, NULL, MIDDLE_BYTE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_bin_offset,\r\n{"BIN Offset", "wmx.compact_ulmap.bin_offset", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_bin_offset_1,\r\n{"BIN Offset", "wmx.compact_ulmap.bin_offset", FT_UINT16, BASE_HEX, NULL, MIDDLE_BYTE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_uiuc,\r\n{"UIUC", "wmx.compact_ulmap.uiuc", FT_UINT8, BASE_HEX, NULL, MSB_NIBBLE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_uiuc_1,\r\n{"UIUC", "wmx.compact_ulmap.uiuc", FT_UINT8, BASE_HEX, NULL, LSB_NIBBLE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_uiuc_ofdma_symbol_offset,\r\n{"OFDMA Symbol Offset", "wmx.compact_ulmap.uiuc_ofdma_symbol_offset", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_uiuc_ofdma_symbol_offset_1,\r\n{"OFDMA Symbol Offset", "wmx.compact_ulmap.uiuc_ofdma_symbol_offset", FT_UINT16, BASE_DEC, NULL, MIDDLE_BYTE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_uiuc_subchannel_offset_7,\r\n{"Subchannel Offset", "wmx.compact_ulmap.uiuc_subchannel_offset", FT_UINT24, BASE_DEC, NULL, 0xFE0000, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_uiuc_num_of_ofdma_symbols_7,\r\n{"Number Of OFDMA Symbols", "wmx.compact_ulmap.uiuc_num_of_ofdma_symbols", FT_UINT24, BASE_DEC, NULL, 0x01FC00, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_uiuc_num_of_subchannels_7,\r\n{"Number Of Subchannels", "wmx.compact_ulmap.uiuc_num_of_subchannels", FT_UINT24, BASE_DEC, NULL, 0x0003F8, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_uiuc_ranging_method,\r\n{"Ranging Method", "wmx.compact_ulmap.uiuc_ranging_method", FT_UINT24, BASE_DEC, NULL, 0x000006, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_uiuc_reserved,\r\n{"Reserved", "wmx.compact_ulmap.uiuc_reserved", FT_UINT24, BASE_HEX, NULL, 0x000001, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_uiuc_subchannel_offset_7_1,\r\n{"Subchannel Offset", "wmx.compact_ulmap.uiuc_subchannel_offset", FT_UINT32, BASE_DEC, NULL, 0x00FE0000, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_uiuc_num_of_ofdma_symbols_7_1,\r\n{"Number Of OFDMA Symbols", "wmx.compact_ulmap.uiuc_num_of_ofdma_symbols", FT_UINT32, BASE_DEC, NULL, 0x0001FC00, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_uiuc_num_of_subchannels_7_1,\r\n{"Number Of Subchannels", "wmx.compact_ulmap.uiuc_num_of_subchannels", FT_UINT32, BASE_DEC, NULL, 0x000003F80, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_uiuc_ranging_method_1,\r\n{"Ranging Method", "wmx.compact_ulmap.uiuc_ranging_method", FT_UINT32, BASE_DEC, NULL, 0x00000006, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_uiuc_reserved_1,\r\n{"Reserved", "wmx.compact_ulmap.uiuc_reserved", FT_UINT32, BASE_HEX, NULL, 0x00000001, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_uiuc_repetition_coding_indication,\r\n{"Repetition Coding Indication", "wmx.compact_ulmap.uiuc_repetition_coding_indication", FT_UINT8, BASE_DEC, VALS(vals_repetitions), ALLOCATION_MODE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_uiuc_repetition_coding_indication_1,\r\n{"Repetition Coding Indication", "wmx.compact_ulmap.uiuc_repetition_coding_indication", FT_UINT8, BASE_DEC, VALS(vals_repetitions), ALLOCATION_MODE_MASK_1, NULL, HFILL}\r\n},\r\n#if 0\r\n{\r\n&hf_culmap_uiuc_reserved1,\r\n{"Reserved", "wmx.compact_ulmap.uiuc_reserved1", FT_UINT8, BASE_HEX, NULL, 0x30, NULL, HFILL}\r\n},\r\n#endif\r\n#if 0\r\n{\r\n&hf_culmap_uiuc_reserved11_1,\r\n{"Reserved", "wmx.compact_ulmap.uiuc_reserved1", FT_UINT8, BASE_HEX, NULL, 0x03, NULL, HFILL}\r\n},\r\n#endif\r\n{\r\n&hf_culmap_uiuc_subchannel_offset,\r\n{"Subchannel Offset", "wmx.compact_ulmap.uiuc_subchannel_offset", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_uiuc_subchannel_offset_1,\r\n{"Subchannel Offset", "wmx.compact_ulmap.uiuc_subchannel_offset", FT_UINT16, BASE_DEC, NULL, MIDDLE_BYTE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_uiuc_num_of_ofdma_symbols,\r\n{"Number Of OFDMA Symbols", "wmx.compact_ulmap.uiuc_num_of_ofdma_symbols", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_uiuc_num_of_ofdma_symbols_1,\r\n{"Number Of OFDMA Symbols", "wmx.compact_ulmap.uiuc_num_of_ofdma_symbols", FT_UINT16, BASE_DEC, NULL, MIDDLE_BYTE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_uiuc_num_of_subchannels,\r\n{"Number Of Subchannels", "wmx.compact_ulmap.uiuc_num_of_subchannels", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_uiuc_num_of_subchannels_1,\r\n{"Number Of Subchannels", "wmx.compact_ulmap.uiuc_num_of_subchannels", FT_UINT16, BASE_DEC, NULL, MIDDLE_BYTE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_harq_region_change_indication,\r\n{"HARQ Region Change Indication", "wmx.compact_ulmap.harq_region_change_indication", FT_BOOLEAN, 8, TFS(&tfs_region_change), 0x10, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_harq_region_change_indication_1,\r\n{"HARQ Region Change Indication", "wmx.compact_ulmap.harq_region_change_indication", FT_BOOLEAN, 8, TFS(&tfs_region_change), 0x01, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_cqi_region_change_indication,\r\n{"CQI Region Change Indication", "wmx.compact_ulmap.cqi_region_change_indication", FT_BOOLEAN, 8, TFS(&tfs_region_change), 0x10, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_cqi_region_change_indication_1,\r\n{"CQI Region Change Indication", "wmx.compact_ulmap.cqi_region_change_indication", FT_BOOLEAN, 8, TFS(&tfs_region_change), 0x01, NULL, HFILL}\r\n},\r\n#if 0\r\n{\r\n&hf_culmap_reserved_type,\r\n{"UL-MAP Reserved Type", "wmx.compact_ulmap.reserved_type", FT_UINT8, BASE_DEC, NULL, UL_MAP_TYPE_MASK, NULL, HFILL}\r\n},\r\n#endif\r\n{\r\n&hf_culmap_reserved_type_1,\r\n{"UL-MAP Reserved Type", "wmx.compact_ulmap.reserved_type", FT_UINT8, BASE_DEC, NULL, UL_MAP_TYPE_MASK_1, NULL, HFILL}\r\n}\r\n};\r\nstatic hf_register_info hf_rcid[] =\r\n{\r\n{\r\n&hf_rcid_ie_normal_cid,\r\n{"Normal CID", "wmx.harq_map.rcid_ie.normal_cid", FT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{\r\n&hf_rcid_ie_normal_cid_1,\r\n{"Normal CID", "wmx.harq_map.rcid_ie.normal_cid", FT_UINT24, BASE_HEX, NULL, WIMAX_RCID_IE_NORMAL_CID_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_rcid_ie_prefix,\r\n{"Prefix", "wmx.harq_map.rcid_ie.prefix", FT_UINT16, BASE_HEX, NULL, WIMAX_RCID_IE_PREFIX_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_rcid_ie_prefix_1,\r\n{"Prefix", "wmx.harq_map.rcid_ie.prefix", FT_UINT16, BASE_HEX, NULL, WIMAX_RCID_IE_PREFIX_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_rcid_ie_cid3,\r\n{"3 LSB Of Basic CID", "wmx.harq_map.rcid_ie.cid3", FT_UINT16, BASE_HEX, NULL, WIMAX_RCID_IE_CID3_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_rcid_ie_cid3_1,\r\n{"3 LSB Of Basic CID", "wmx.harq_map.rcid_ie.cid3", FT_UINT16, BASE_HEX, NULL, WIMAX_RCID_IE_CID3_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_rcid_ie_cid7,\r\n{"7 LSB Of Basic CID", "wmx.harq_map.rcid_ie.cid7", FT_UINT16, BASE_HEX, NULL, WIMAX_RCID_IE_CID7_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_rcid_ie_cid7_1,\r\n{"7 LSB Of Basic CID", "wmx.harq_map.rcid_ie.cid7", FT_UINT16, BASE_HEX, NULL, WIMAX_RCID_IE_CID7_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_rcid_ie_cid11,\r\n{"11 LSB Of Basic CID", "wmx.harq_map.rcid_ie.cid11", FT_UINT16, BASE_HEX, NULL, WIMAX_RCID_IE_CID11_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_rcid_ie_cid11_1,\r\n{"11 LSB Of Basic CID", "wmx.harq_map.rcid_ie.cid11", FT_UINT16, BASE_HEX, NULL, WIMAX_RCID_IE_CID11_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_rcid_ie_cid11_2,\r\n{"11 LSB Of Multicast, AAS or Broadcast CID", "wmx.harq_map.rcid_ie.cid11", FT_UINT16, BASE_HEX, NULL, WIMAX_RCID_IE_CID11_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_rcid_ie_cid11_3,\r\n{"11 LSB Of Multicast, AAS or Broadcast CID", "wmx.harq_map.rcid_ie.cid11", FT_UINT16, BASE_HEX, NULL, WIMAX_RCID_IE_CID11_MASK_1, NULL, HFILL}\r\n}\r\n};\r\nstatic hf_register_info hf_harq_control[] =\r\n{\r\n{\r\n&hf_harq_control_ie_prefix,\r\n{"Prefix", "wmx.harq_map.harq_control_ie.prefix", FT_BOOLEAN, 8, TFS(&tfs_prefix), WIMAX_HARQ_CONTROL_IE_PREFIX_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_control_ie_ai_sn,\r\n{"HARQ ID Sequence Number(AI_SN)", "wmx.harq_map.harq_control_ie.ai_sn", FT_UINT8, BASE_HEX, NULL, WIMAX_HARQ_CONTROL_IE_AI_SN_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_control_ie_spid,\r\n{"Subpacket ID (SPID)", "wmx.harq_map.harq_control_ie.spid", FT_UINT8, BASE_HEX, NULL, WIMAX_HARQ_CONTROL_IE_SPID_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_control_ie_acid,\r\n{"HARQ CH ID (ACID)", "wmx.harq_map.harq_control_ie.acid", FT_UINT8, BASE_HEX, NULL, WIMAX_HARQ_CONTROL_IE_ACID_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_control_ie_reserved,\r\n{"Reserved", "wmx.harq_map.harq_control_ie.reserved", FT_UINT8, BASE_HEX, NULL, WIMAX_HARQ_CONTROL_IE_RESERVED_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_control_ie_prefix_1,\r\n{"Prefix", "wmx.harq_map.harq_control_ie.prefix", FT_BOOLEAN, 16, TFS(&tfs_prefix), WIMAX_HARQ_CONTROL_IE_PREFIX_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_control_ie_ai_sn_1,\r\n{"HARQ ID Sequence Number(AI_SN)", "wmx.harq_map.harq_control_ie.ai_sn", FT_UINT16, BASE_HEX, NULL, WIMAX_HARQ_CONTROL_IE_AI_SN_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_control_ie_spid_1,\r\n{"Subpacket ID (SPID)", "wmx.harq_map.harq_control_ie.spid", FT_UINT16, BASE_HEX, NULL, WIMAX_HARQ_CONTROL_IE_SPID_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_control_ie_acid_1,\r\n{"HARQ CH ID (ACID)", "wmx.harq_map.harq_control_ie.acid", FT_UINT16, BASE_HEX, NULL, WIMAX_HARQ_CONTROL_IE_ACID_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_control_ie_reserved_1,\r\n{"Reserved", "wmx.harq_map.harq_control_ie.reserved", FT_UINT16, BASE_HEX, NULL, WIMAX_HARQ_CONTROL_IE_RESERVED_MASK_1, NULL, HFILL}\r\n}\r\n};\r\nstatic hf_register_info hf_extension_type[] =\r\n{\r\n{\r\n&hf_culmap_extension_type,\r\n{"UL-MAP Type", "wmx.extension_type.ul_map_type", FT_UINT16, BASE_DEC, NULL, EXTENSION_TYPE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_extension_type_1,\r\n{"UL-MAP Type", "wmx.extension_type.ul_map_type", FT_UINT16, BASE_DEC, NULL, EXTENSION_TYPE_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_extension_subtype,\r\n{"Extension Subtype", "wmx.extension_type.subtype", FT_UINT16, BASE_DEC, NULL, EXTENSION_SUBTYPE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_extension_subtype_1,\r\n{"Extension Subtype", "wmx.extension_type.subtype", FT_UINT16, BASE_DEC, NULL, EXTENSION_SUBTYPE_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_extension_length,\r\n{"Extension Length", "wmx.extension_type.length", FT_UINT16, BASE_DEC, NULL, EXTENSION_LENGTH_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_extension_length_1,\r\n{"Extension Length", "wmx.extension_type.length", FT_UINT16, BASE_DEC, NULL, EXTENSION_LENGTH_MASK_1, NULL, HFILL}\r\n},\r\n#if 0\r\n{\r\n&hf_culmap_extension_time_diversity_mbs,\r\n{"Time Diversity MBS", "wmx.extension_type.time_diversity_mbs", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n#endif\r\n#if 0\r\n{\r\n&hf_culmap_extension_time_diversity_mbs_1,\r\n{"Time Diversity MBS", "wmx.extension_type.time_diversity_mbs", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n#endif\r\n{\r\n&hf_culmap_extension_harq_mode_1,\r\n{"HARQ Mode Switch", "wmx.extension_type.harq_mode", FT_UINT16, BASE_HEX, NULL, 0x000F, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_extension_harq_mode,\r\n{"HARQ Mode Switch", "wmx.extension_type.harq_mode", FT_UINT8, BASE_HEX, NULL, MSB_NIBBLE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_extension_unknown_sub_type,\r\n{"Unknown Extension Subtype", "wmx.extension_type.unknown_sub_type", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{\r\n&hf_culmap_extension_unknown_sub_type_1,\r\n{"Unknown Extension Subtype", "wmx.extension_type.unknown_sub_type", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n}\r\n};\r\nstatic hf_register_info hf_cdma_allocation[] =\r\n{\r\n{\r\n&hf_cdma_allocation_duration,\r\n{"Duration", "wmx.cdma_allocation.duration", FT_UINT16, BASE_DEC, NULL, CDMA_ALLOCATION_DURATION_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdma_allocation_uiuc,\r\n{"UIUC For Transmission", "wmx.cdma_allocation.uiuc", FT_UINT16, BASE_DEC, NULL, CDMA_ALLOCATION_UIUC_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdma_allocation_repetition,\r\n{"Repetition Coding Indication", "wmx.cdma_allocation.allocation_repetition", FT_UINT16, BASE_DEC, VALS(vals_repetitions), CDMA_ALLOCATION_REPETITION_CODE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdma_allocation_frame_number_index,\r\n{"Frame Number Index (LSBs of relevant frame number)", "wmx.cdma_allocation.frame_number_index", FT_UINT16, BASE_DEC, NULL, CDMA_ALLOCATION_FRAME_NUMBER_INDEX_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdma_allocation_ranging_code,\r\n{"Ranging Code", "wmx.cdma_allocation.ranging_code", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdma_allocation_ranging_symbol,\r\n{"Ranging Symbol", "wmx.cdma_allocation.ranging_symbol", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdma_allocation_ranging_subchannel,\r\n{"Ranging Subchannel", "wmx.cdma_allocation.ranging_subchannel", FT_UINT8, BASE_DEC, NULL, CDMA_ALLOCATION_RANGING_SUBCHANNEL_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdma_allocation_bw_req,\r\n{"BW Request Mandatory", "wmx.cdma_allocation.bw_req", FT_BOOLEAN, 8, TFS(&tfs_yes_no_ie), CDMA_ALLOCATION_BW_REQUEST_MANDATORY_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdma_allocation_duration_1,\r\n{"Duration", "wmx.cdma_allocation.duration", FT_UINT16, BASE_DEC, NULL, CDMA_ALLOCATION_DURATION_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdma_allocation_uiuc_1,\r\n{"UIUC For Transmission", "wmx.cdma_allocation.uiuc", FT_UINT16, BASE_DEC, NULL, CDMA_ALLOCATION_UIUC_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdma_allocation_repetition_1,\r\n{"Repetition Coding Indication", "wmx.cdma_allocation.allocation_repetition", FT_UINT16, BASE_DEC, VALS(vals_repetitions), CDMA_ALLOCATION_REPETITION_CODE_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdma_allocation_frame_number_index_1,\r\n{"Frame Number Index (LSBs of relevant frame number)", "wmx.cdma_allocation.frame_number_index", FT_UINT32, BASE_DEC, NULL, CDMA_ALLOCATION_FRAME_NUMBER_INDEX_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdma_allocation_ranging_code_1,\r\n{"Ranging Code", "wmx.cdma_allocation.ranging_code", FT_UINT32, BASE_DEC, NULL, CDMA_ALLOCATION_RANGING_CODE_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdma_allocation_ranging_symbol_1,\r\n{"Ranging Symbol", "wmx.cdma_allocation.ranging_symbol", FT_UINT32, BASE_DEC, NULL, CDMA_ALLOCATION_RANGING_SYMBOL_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdma_allocation_ranging_subchannel_1,\r\n{"Ranging Subchannel", "wmx.cdma_allocation.ranging_subchannel", FT_UINT32, BASE_DEC, NULL, CDMA_ALLOCATION_RANGING_SUBCHANNEL_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdma_allocation_bw_req_1,\r\n{"BW Request Mandatory", "wmx.cdma_allocation.bw_req", FT_BOOLEAN, 32, TFS(&tfs_yes_no_ie), CDMA_ALLOCATION_BW_REQUEST_MANDATORY_MASK_1, NULL, HFILL}\r\n}\r\n};\r\nstatic hf_register_info hf_extended_uiuc[] =\r\n{\r\n{\r\n&hf_extended_uiuc_ie_uiuc,\r\n{"Extended UIUC", "wmx.extended_uiuc_ie.uiuc", FT_UINT8, BASE_HEX, NULL, MSB_NIBBLE_MASK, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_uiuc_1,\r\n{"Extended UIUC", "wmx.extended_uiuc_ie.uiuc", FT_UINT8, BASE_HEX, NULL, LSB_NIBBLE_MASK, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_length,\r\n{"Length", "wmx.extended_uiuc_ie.length", FT_UINT8, BASE_DEC, NULL, MSB_NIBBLE_MASK, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_length_1,\r\n{"Length", "wmx.extended_uiuc_ie.length", FT_UINT24, BASE_DEC, NULL, LSB_NIBBLE_MASK, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_power_control,\r\n{"Power Control", "wmx.extended_uiuc_ie.power_control", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_power_control_24,\r\n{"Power Control", "wmx.extended_uiuc_ie.power_control", FT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_power_measurement_frame,\r\n{"Power Measurement Frame", "wmx.extended_uiuc_ie.power_measurement_frame", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_power_measurement_frame_24,\r\n{"Power Measurement Frame", "wmx.extended_uiuc_ie.power_measurement_frame", FT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_mini_subchannel_alloc_ctype,\r\n{"C Type", "wmx.extended_uiuc_ie.mini_subchannel_alloc.ctype", FT_UINT8, BASE_HEX, VALS(vals_ctypes), MINI_SUBCHANNEL_CTYPE_MASK, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_mini_subchannel_alloc_ctype_16,\r\n{"C Type", "wmx.extended_uiuc_ie.mini_subchannel_alloc.ctype", FT_UINT16, BASE_HEX, VALS(vals_ctypes), MINI_SUBCHANNEL_CTYPE_MASK_16, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_mini_subchannel_alloc_duration,\r\n{"Duration", "wmx.extended_uiuc_ie.mini_subchannel_alloc.duration", FT_UINT8, BASE_DEC, NULL, MINI_SUBCHANNEL_DURATION_MASK, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_mini_subchannel_alloc_duration_16,\r\n{"Duration", "wmx.extended_uiuc_ie.mini_subchannel_alloc.duration", FT_UINT16, BASE_DEC, NULL, MINI_SUBCHANNEL_DURATION_MASK_16, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_mini_subchannel_alloc_cid,\r\n{"CID", "wmx.extended_uiuc_ie.mini_subchannel_alloc.cid", FT_UINT24, BASE_HEX, NULL, MINI_SUBCHANNEL_CID_MASK, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_mini_subchannel_alloc_uiuc,\r\n{"UIUC", "wmx.extended_uiuc_ie.mini_subchannel_alloc.uiuc", FT_UINT24, BASE_HEX, NULL, MINI_SUBCHANNEL_UIUC_MASK, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_mini_subchannel_alloc_repetition,\r\n{"Repetition", "wmx.extended_uiuc_ie.mini_subchannel_alloc.repetition", FT_UINT24, BASE_HEX, VALS(vals_repetitions), MINI_SUBCHANNEL_REPETITION_MASK, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_mini_subchannel_alloc_cid_1,\r\n{"CID", "wmx.extended_uiuc_ie.mini_subchannel_alloc.cid", FT_UINT24, BASE_HEX, NULL, MINI_SUBCHANNEL_CID_MASK_1, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_mini_subchannel_alloc_uiuc_1,\r\n{"UIUC", "wmx.extended_uiuc_ie.mini_subchannel_alloc.uiuc", FT_UINT24, BASE_HEX, NULL, MINI_SUBCHANNEL_UIUC_MASK_1, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_mini_subchannel_alloc_repetition_1,\r\n{"Repetition", "wmx.extended_uiuc_ie.mini_subchannel_alloc.repetition", FT_UINT24, BASE_HEX, VALS(vals_repetitions), MINI_SUBCHANNEL_REPETITION_MASK_1, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_mini_subchannel_alloc_cid_2,\r\n{"CID", "wmx.extended_uiuc_ie.mini_subchannel_alloc.cid", FT_UINT24, BASE_HEX, NULL, MINI_SUBCHANNEL_CID_MASK_2, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_mini_subchannel_alloc_uiuc_2,\r\n{"UIUC", "wmx.extended_uiuc_ie.mini_subchannel_alloc.uiuc", FT_UINT24, BASE_HEX, NULL, MINI_SUBCHANNEL_UIUC_MASK_2, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_mini_subchannel_alloc_repetition_2,\r\n{"Repetition", "wmx.extended_uiuc_ie.mini_subchannel_alloc.repetition", FT_UINT24, BASE_HEX, VALS(vals_repetitions), MINI_SUBCHANNEL_REPETITION_MASK_2, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_mini_subchannel_alloc_cid_3,\r\n{"CID", "wmx.extended_uiuc_ie.mini_subchannel_alloc.cid", FT_UINT24, BASE_HEX, NULL, MINI_SUBCHANNEL_CID_MASK_3, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_mini_subchannel_alloc_uiuc_3,\r\n{"UIUC", "wmx.extended_uiuc_ie.mini_subchannel_alloc.uiuc", FT_UINT24, BASE_HEX, NULL, MINI_SUBCHANNEL_UIUC_MASK_2, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_mini_subchannel_alloc_repetition_3,\r\n{"Repetition", "wmx.extended_uiuc_ie.mini_subchannel_alloc.repetition", FT_UINT24, BASE_HEX, VALS(vals_repetitions), MINI_SUBCHANNEL_REPETITION_MASK_3, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_mini_subchannel_alloc_padding,\r\n{"Padding", "wmx.extended_uiuc_ie.mini_subchannel_alloc.padding", FT_UINT8, BASE_HEX, NULL, MINI_SUBCHANNEL_PADDING_MASK, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_mini_subchannel_alloc_padding_1,\r\n{"Padding", "wmx.extended_uiuc_ie.mini_subchannel_alloc.padding", FT_UINT24, BASE_HEX, NULL, MINI_SUBCHANNEL_PADDING_MASK_1, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_aas_ul,\r\n{"AAS_UL_IE (not implemented)", "wmx.extended_uiuc_ie.aas_ul", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_cqich_alloc,\r\n{"CQICH Allocation IE (not implemented)", "wmx.extended_uiuc_ie.cqich_alloc", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_ul_zone,\r\n{"UL Zone IE (not implemented)", "wmx.extended_uiuc_ie.ul_zone", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_mimo_ul_basic,\r\n{"MIMO UL Basic IE (not implemented)", "wmx.extended_uiuc_ie.mimo_ul_basic", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_fast_tracking,\r\n{"UL-MAP Fast Tracking IE (not implemented)", "wmx.extended_uiuc_ie.fast_tracking", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_fast_ranging,\r\n{"Fast Ranging IE (not implemented)", "wmx.extended_uiuc_ie.fast_ranging", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_phymod_ul,\r\n{"UL-MAP Physical Modifier IE (not implemented)", "wmx.extended_uiuc_ie.phymod_ul", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_ul_pusc_burst_allocation,\r\n{"UL_PUSC_Burst_Allocation_in_Other_Segment_IE (not implemented)", "wmx.extended_uiuc_ie.ul_pusc_burst_allocation", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_ul_allocation_start,\r\n{"UL Allocation Start IE (not implemented)", "wmx.extended_uiuc_ie.ul_allocation_start", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_uiuc_ie_unknown_uiuc,\r\n{"Unknown Extended UIUC", "wmx.extended_uiuc.unknown_uiuc", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n}\r\n};\r\n#if 0\r\nstatic gint *ett[] =\r\n{\r\n&ett_wimax_compact_ulmap_ie_decoder,\r\n&ett_wimax_rcid_ie_decoder,\r\n&ett_wimax_harq_control_ie_decoder,\r\n&ett_wimax_extended_uiuc_dependent_ie_decoder,\r\n&ett_wimax_extension_type_ie_decoder,\r\n};\r\nproto_register_subtree_array(ett, array_length(ett));\r\n#endif\r\nproto_wimax_compact_ulmap_ie_decoder = proto_wimax;\r\nproto_register_field_array(proto_wimax_compact_ulmap_ie_decoder, hf_compact_ulmap, array_length(hf_compact_ulmap));\r\nproto_register_field_array(proto_wimax_compact_ulmap_ie_decoder, hf_rcid, array_length(hf_rcid));\r\nproto_register_field_array(proto_wimax_compact_ulmap_ie_decoder, hf_harq_control, array_length(hf_harq_control));\r\nproto_register_field_array(proto_wimax_compact_ulmap_ie_decoder, hf_extension_type, array_length(hf_extension_type));\r\nproto_register_field_array(proto_wimax_compact_ulmap_ie_decoder, hf_cdma_allocation, array_length(hf_cdma_allocation));\r\nproto_register_field_array(proto_wimax_compact_ulmap_ie_decoder, hf_extended_uiuc, array_length(hf_extended_uiuc));\r\n}
