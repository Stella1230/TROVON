static void\r\ndissect_cat_efadn_coding(tvbuff_t *tvb, proto_tree *tree, guint32 pos, guint32 len, int hf_entry)\r\n{\r\nif (len) {\r\nguint32 i;\r\nguint8 first_byte = tvb_get_guint8(tvb, pos);\r\nif ((first_byte & 0x80) == 0) {\r\nwmem_strbuf_t *strbuf = wmem_strbuf_sized_new(wmem_packet_scope(), len+1, 0);\r\nfor (i = 0; i < len; i++) {\r\nguint8 gsm_chars[2];\r\ngsm_chars[0] = tvb_get_guint8(tvb, pos+i);\r\nif (gsm_chars[0] == 0x1b) {\r\nguint8 second_byte;\r\ni++;\r\nsecond_byte = tvb_get_guint8(tvb, pos+i);\r\ngsm_chars[0] |= second_byte << 7;\r\ngsm_chars[1] = second_byte >> 1;\r\nwmem_strbuf_append(strbuf, get_ts_23_038_7bits_string(wmem_packet_scope(), gsm_chars, 0, 2));\r\n} else {\r\nwmem_strbuf_append(strbuf, get_ts_23_038_7bits_string(wmem_packet_scope(), gsm_chars, 0, 1));\r\n}\r\n}\r\nproto_tree_add_string(tree, hf_entry, tvb, pos, len, wmem_strbuf_finalize(strbuf));\r\n} else if (first_byte == 0x80) {\r\nproto_tree_add_item(tree, hf_entry, tvb, pos+1, len-1, ENC_UCS_2|ENC_BIG_ENDIAN);\r\n} else if (first_byte == 0x81) {\r\nguint8 string_len = tvb_get_guint8(tvb, pos+1);\r\nguint16 ucs2_base = tvb_get_guint8(tvb, pos+2) << 7;\r\nwmem_strbuf_t *strbuf = wmem_strbuf_sized_new(wmem_packet_scope(), 2*string_len+1, 0);\r\nfor (i = 0; i < string_len; i++) {\r\nguint8 byte = tvb_get_guint8(tvb, pos+3+i);\r\nif ((byte & 0x80) == 0) {\r\nguint8 gsm_chars[2];\r\ngsm_chars[0] = byte;\r\nif (gsm_chars[0] == 0x1b) {\r\nguint8 second_byte;\r\ni++;\r\nsecond_byte = tvb_get_guint8(tvb, pos+3+i);\r\ngsm_chars[0] |= second_byte << 7;\r\ngsm_chars[1] = second_byte >> 1;\r\nwmem_strbuf_append(strbuf, get_ts_23_038_7bits_string(wmem_packet_scope(), gsm_chars, 0, 2));\r\n} else {\r\nwmem_strbuf_append(strbuf, get_ts_23_038_7bits_string(wmem_packet_scope(), gsm_chars, 0, 1));\r\n}\r\n} else {\r\nguint8 ucs2_char[2];\r\nucs2_char[0] = ucs2_base >> 8;\r\nucs2_char[1] = (ucs2_base & 0xff) + (byte & 0x7f);\r\nwmem_strbuf_append(strbuf, get_ucs_2_string(wmem_packet_scope(), ucs2_char, 2, ENC_BIG_ENDIAN));\r\n}\r\n}\r\nproto_tree_add_string(tree, hf_entry, tvb, pos, len, wmem_strbuf_finalize(strbuf));\r\n} else if (first_byte == 0x82) {\r\nguint8 string_len = tvb_get_guint8(tvb, pos+1);\r\nguint16 ucs2_base = tvb_get_ntohs(tvb, pos+2);\r\nwmem_strbuf_t *strbuf = wmem_strbuf_sized_new(wmem_packet_scope(), 2*string_len+1, 0);\r\nfor (i = 0; i < string_len; i++) {\r\nguint8 byte = tvb_get_guint8(tvb, pos+4+i);\r\nif ((byte & 0x80) == 0) {\r\nguint8 gsm_chars[2];\r\ngsm_chars[0] = byte;\r\nif (gsm_chars[0] == 0x1b) {\r\nguint8 second_byte;\r\ni++;\r\nsecond_byte = tvb_get_guint8(tvb, pos+4+i);\r\ngsm_chars[0] |= second_byte << 7;\r\ngsm_chars[1] = second_byte >> 1;\r\nwmem_strbuf_append(strbuf, get_ts_23_038_7bits_string(wmem_packet_scope(), gsm_chars, 0, 2));\r\n} else {\r\nwmem_strbuf_append(strbuf, get_ts_23_038_7bits_string(wmem_packet_scope(), gsm_chars, 0, 1));\r\n}\r\n} else {\r\nguint8 ucs2_char[2];\r\nucs2_char[0] = ucs2_base >> 8;\r\nucs2_char[1] = (ucs2_base & 0xff) + (byte & 0x7f);\r\nwmem_strbuf_append(strbuf, get_ucs_2_string(wmem_packet_scope(), ucs2_char, 2, ENC_BIG_ENDIAN));\r\n}\r\n}\r\nproto_tree_add_string(tree, hf_entry, tvb, pos, len, wmem_strbuf_finalize(strbuf));\r\n}\r\n}\r\n}\r\nstatic int\r\ndissect_cat(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data)\r\n{\r\nproto_item *cat_ti;\r\nproto_tree *cat_tree, *elem_tree;\r\nunsigned int pos = 0;\r\ntvbuff_t *new_tvb;\r\ngboolean ims_event = FALSE, dns_server = FALSE;\r\nguint length = tvb_reported_length(tvb);\r\ngsm_sms_data_t sms_data = {0};\r\ncat_ti = proto_tree_add_item(tree, proto_cat, tvb, 0, -1, ENC_NA);\r\ncat_tree = proto_item_add_subtree(cat_ti, ett_cat);\r\nwhile (pos < length) {\r\nproto_item *ti;\r\nguint8 g8;\r\nguint16 tag;\r\nguint32 len, i;\r\nguint8 *ptr = NULL;\r\ntag = tvb_get_guint8(tvb, pos++) & 0x7f;\r\nif (tag == 0x7f) {\r\ntag = tvb_get_ntohs(tvb, pos) & 0x7fff;\r\npos += 2;\r\n}\r\nlen = tvb_get_guint8(tvb, pos++);\r\nswitch (len) {\r\ncase 0x81:\r\nlen = tvb_get_guint8(tvb, pos++);\r\nbreak;\r\ncase 0x82:\r\nlen = tvb_get_ntohs(tvb, pos);\r\npos += 2;\r\nbreak;\r\ncase 0x83:\r\nlen = tvb_get_ntoh24(tvb, pos);\r\npos += 3;\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n#if 1\r\nti = proto_tree_add_bytes_format(cat_tree, hf_cat_tlv, tvb, pos,\r\nlen, ptr, "%s: %s",\r\nval_to_str_ext(tag, &comp_tlv_tag_vals_ext, "%02x"),\r\n(const guint8 *)tvb_bytes_to_str(wmem_packet_scope(), tvb, pos, len));\r\n#else\r\nti = proto_tree_add_bytes_format(cat_tree, hf_cat_tlv, tvb, pos,\r\nlen, ptr, "%s: ",\r\nval_to_str_ext(tag, &comp_tlv_tag_vals_ext, "%02x"));\r\n#endif\r\nelem_tree = proto_item_add_subtree(ti, ett_elem);\r\nswitch (tag) {\r\ncase 0x01:\r\nif (len < 3)\r\nbreak;\r\nproto_tree_add_item(elem_tree, hf_ctlv_cmd_nr, tvb, pos, 1, ENC_BIG_ENDIAN);\r\nif (tvb_get_guint8(tvb, pos) == 0x40) {\r\nims_event = TRUE;\r\ndns_server = TRUE;\r\n}\r\nproto_tree_add_item(elem_tree, hf_ctlv_cmd_type, tvb, pos+1, 1, ENC_BIG_ENDIAN);\r\ng8 = tvb_get_guint8(tvb, pos+1);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s ",\r\nval_to_str_ext(g8, &cmd_type_vals_ext, "%02x "));\r\nswitch (g8) {\r\ncase 0x01:\r\nproto_tree_add_item(elem_tree, hf_ctlv_cmd_qual_refresh, tvb, pos+2, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x13:\r\nproto_tree_add_item(elem_tree, hf_ctlv_cmd_qual_send_short_msg, tvb, pos+2, 1, ENC_NA);\r\nsms_data.stk_packing_required = tvb_get_guint8(tvb, pos+2) & 0x01 ? TRUE : FALSE;\r\nbreak;\r\ncase 0x26:\r\nproto_tree_add_item(elem_tree, hf_ctlv_cmd_qual_loci, tvb, pos+2, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x27:\r\nproto_tree_add_item(elem_tree, hf_ctlv_cmd_qual_timer_mgmt, tvb, pos+2, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x43:\r\nproto_tree_add_item(elem_tree, hf_ctlv_cmd_qual_send_data, tvb, pos+2, 1, ENC_NA);\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(elem_tree, hf_ctlv_cmd_qual, tvb, pos+2, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\n}\r\nbreak;\r\ncase 0x02:\r\nif (len < 2)\r\nbreak;\r\nproto_tree_add_item(elem_tree, hf_ctlv_devid_src, tvb, pos, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(elem_tree, hf_ctlv_devid_dst, tvb, pos+1, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x03:\r\ng8 = tvb_get_guint8(tvb, pos);\r\nproto_tree_add_item(elem_tree, hf_ctlv_result_gen, tvb, pos, 1, ENC_BIG_ENDIAN);\r\nswitch (g8) {\r\ncase 0x20:\r\nproto_tree_add_item(elem_tree, hf_ctlv_result_term, tvb, pos+1, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x26:\r\nproto_tree_add_item(elem_tree, hf_ctlv_result_launch_browser, tvb, pos+1, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x38:\r\nproto_tree_add_item(elem_tree, hf_ctlv_result_multiplecard, tvb, pos+1, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x39:\r\nproto_tree_add_item(elem_tree, hf_ctlv_result_cc_ctrl_mo_sm_ctrl, tvb, pos+1, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x3a:\r\nproto_tree_add_item(elem_tree, hf_ctlv_result_bip, tvb, pos+1, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x3c:\r\nproto_tree_add_item(elem_tree, hf_ctlv_result_frames_cmd, tvb, pos+1, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nbreak;\r\ncase 0x04:\r\nif (len < 2)\r\nbreak;\r\nproto_tree_add_item(elem_tree, hf_ctlv_dur_time_unit, tvb, pos, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(elem_tree, hf_ctlv_dur_time_intv, tvb, pos+1, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x05:\r\ndissect_cat_efadn_coding(tvb, elem_tree, pos, len, hf_ctlv_alpha_id_string);\r\nbreak;\r\ncase 0x06:\r\nproto_tree_add_item(elem_tree, hf_ctlv_address_ton, tvb, pos, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(elem_tree, hf_ctlv_address_npi, tvb, pos, 1, ENC_BIG_ENDIAN);\r\ndissect_cat_efadn_coding(tvb, elem_tree, pos+1, len-1, hf_ctlv_address_string);\r\nbreak;\r\ncase 0x08:\r\ndissect_cat_efadn_coding(tvb, elem_tree, pos, len, hf_ctlv_subaddress_string);\r\nbreak;\r\ncase 0x0b:\r\nnew_tvb = tvb_new_subset_length(tvb, pos, len);\r\nif (new_tvb) {\r\nint p2p_dir_save = pinfo->p2p_dir;\r\nif (data) {\r\nif (GPOINTER_TO_INT(data) == 0xd0) {\r\npinfo->p2p_dir = P2P_DIR_RECV;\r\n} else {\r\npinfo->p2p_dir = P2P_DIR_SENT;\r\n}\r\n}\r\ncall_dissector_only(gsm_sms_handle, new_tvb, pinfo, elem_tree, &sms_data);\r\npinfo->p2p_dir = p2p_dir_save;\r\n}\r\nbreak;\r\ncase 0x0d:\r\nif (len == 0)\r\nbreak;\r\nproto_tree_add_item(elem_tree, hf_ctlv_text_string_enc, tvb, pos, 1, ENC_BIG_ENDIAN);\r\ng8 = tvb_get_guint8(tvb, pos);\r\nswitch (g8 & 0xf0) {\r\ncase 0x00:\r\ng8 &= 0x0c;\r\nbreak;\r\ncase 0xf0:\r\ng8 &= 0x04;\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nswitch (g8) {\r\ncase 0x00:\r\nproto_tree_add_item(elem_tree, hf_ctlv_text_string, tvb, pos+1, len-1, ENC_3GPP_TS_23_038_7BITS|ENC_NA);\r\nbreak;\r\ncase 0x04:\r\nproto_tree_add_item(elem_tree, hf_ctlv_text_string, tvb, pos+1, len-1, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase 0x08:\r\nproto_tree_add_item(elem_tree, hf_ctlv_text_string, tvb, pos+1, len-1, ENC_UCS_2|ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nbreak;\r\ncase 0x0e:\r\nif (len < 1)\r\nbreak;\r\nproto_tree_add_item(elem_tree, hf_ctlv_tone, tvb, pos, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x0f:\r\nif (len) {\r\nproto_tree_add_item(elem_tree, hf_ctlv_item_id, tvb, pos, 1, ENC_BIG_ENDIAN);\r\ndissect_cat_efadn_coding(tvb, elem_tree, pos+1, len-1, hf_ctlv_item_string);\r\n}\r\nbreak;\r\ncase 0x13:\r\nif (len == 0)\r\nbreak;\r\ndissect_e212_mcc_mnc(tvb, pinfo, elem_tree, pos, E212_NONE, TRUE);\r\nproto_tree_add_item(elem_tree, hf_ctlv_loci_lac, tvb, pos+3, 2, ENC_BIG_ENDIAN);\r\nif (len == 5)\r\nbreak;\r\nproto_tree_add_item(elem_tree, hf_ctlv_loci_cell_id, tvb, pos+5, 2, ENC_BIG_ENDIAN);\r\nif (len == 7)\r\nbreak;\r\nproto_tree_add_item(elem_tree, hf_ctlv_loci_ext_cell_id, tvb, pos+7, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x14:\r\ncase 0x62:\r\nde_mid(tvb, elem_tree, pinfo, pos, len, NULL, 0);\r\nbreak;\r\ncase 0x19:\r\nfor (i = 0; i < len; i++) {\r\nguint8 event = tvb_get_guint8(tvb, pos+i);\r\nif ((event == 0x17) || (event == 0x18)) {\r\nims_event = TRUE;\r\n}\r\nproto_tree_add_uint(elem_tree, hf_ctlv_event, tvb, pos+i, 1, event);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "%s ",\r\nval_to_str_ext(event, &event_list_vals_ext, "%02x "));\r\n}\r\nbreak;\r\ncase 0x1b:\r\nfor (i = 0; i < len; i++)\r\nproto_tree_add_item(elem_tree, hf_ctlv_loc_status, tvb, pos+i, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x25:\r\n{\r\nguint8 oct;\r\noct = tvb_get_guint8(tvb, pos);\r\nproto_tree_add_uint_format_value(elem_tree, hf_ctlv_timer_val_hr, tvb, pos, 1, oct, "%u (0x%02x)", 10*(oct&0x0f)+(oct>>4), oct);\r\noct = tvb_get_guint8(tvb, pos+1);\r\nproto_tree_add_uint_format_value(elem_tree, hf_ctlv_timer_val_min, tvb, pos+1, 1, oct, "%u (0x%02x)", 10*(oct&0x0f)+(oct>>4), oct);\r\noct = tvb_get_guint8(tvb, pos+2);\r\nproto_tree_add_uint_format_value(elem_tree, hf_ctlv_timer_val_sec, tvb, pos+2, 1, oct, "%u (0x%02x)", 10*(oct&0x0f)+(oct>>4), oct);\r\n}\r\nbreak;\r\ncase 0x26:\r\n{\r\nguint8 oct, tz;\r\noct = tvb_get_guint8(tvb, pos);\r\nproto_tree_add_uint_format_value(elem_tree, hf_ctlv_date_time_yr, tvb, pos, 1, oct, "%u (0x%02x)", 10*(oct&0x0f)+(oct>>4), oct);\r\noct = tvb_get_guint8(tvb, pos+1);\r\nproto_tree_add_uint_format_value(elem_tree, hf_ctlv_date_time_mo, tvb, pos+1, 1, oct, "%u (0x%02x)", 10*(oct&0x0f)+(oct>>4), oct);\r\noct = tvb_get_guint8(tvb, pos+2);\r\nproto_tree_add_uint_format_value(elem_tree, hf_ctlv_date_time_day, tvb, pos+2, 1, oct, "%u (0x%02x)", 10*(oct&0x0f)+(oct>>4), oct);\r\noct = tvb_get_guint8(tvb, pos+3);\r\nproto_tree_add_uint_format_value(elem_tree, hf_ctlv_date_time_hr, tvb, pos+3, 1, oct, "%u (0x%02x)", 10*(oct&0x0f)+(oct>>4), oct);\r\noct = tvb_get_guint8(tvb, pos+4);\r\nproto_tree_add_uint_format_value(elem_tree, hf_ctlv_date_time_min, tvb, pos+4, 1, oct, "%u (0x%02x)", 10*(oct&0x0f)+(oct>>4), oct);\r\noct = tvb_get_guint8(tvb, pos+5);\r\nproto_tree_add_uint_format_value(elem_tree, hf_ctlv_date_time_sec, tvb, pos+5, 1, oct, "%u (0x%02x)", 10*(oct&0x0f)+(oct>>4), oct);\r\noct = tvb_get_guint8(tvb, pos+6);\r\nif (oct == 0xff) {\r\nproto_tree_add_uint_format_value(elem_tree, hf_ctlv_date_time_tz, tvb, pos+6, 1, oct, "Unknown (0x%02x)", oct);\r\n} else {\r\ntz = (oct >> 4) + (oct & 0x07) * 10;\r\nproto_tree_add_uint_format_value(elem_tree, hf_ctlv_date_time_tz, tvb, pos+6, 1, oct, "GMT %c %d hr %d min (0x%02x)",\r\n(oct & 0x08)?'-':'+', tz/4, (tz%4)*15, oct);\r\n}\r\n}\r\nbreak;\r\ncase 0x28:\r\nproto_tree_add_item(elem_tree, hf_ctlv_at_cmd, tvb, pos, len, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase 0x29:\r\nproto_tree_add_item(elem_tree, hf_ctlv_at_rsp, tvb, pos, len, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase 0x2c:\r\ndissect_cat_efadn_coding(tvb, elem_tree, pos, len, hf_ctlv_dtmf_string);\r\nbreak;\r\ncase 0x2d:\r\nproto_tree_add_item(elem_tree, hf_ctlv_language, tvb, pos, len, ENC_ASCII|ENC_NA);\r\nbreak;\r\ncase 0x2e:\r\nproto_tree_add_item(elem_tree, hf_ctlv_me_status, tvb, pos, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(elem_tree, hf_ctlv_timing_adv, tvb, pos+1, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x2f:\r\n{\r\nguint64 rid = tvb_get_ntoh40(tvb, pos);\r\nproto_tree_add_uint64(elem_tree, hf_ctlv_aid_rid, tvb, pos, 5, rid);\r\nif (rid == AID_RID_ETSI) {\r\nproto_tree_add_item(elem_tree, hf_ctlv_aid_pix_app_code_etsi, tvb, pos+5, 2, ENC_BIG_ENDIAN);\r\n} else if (rid == AID_RID_3GPP) {\r\nproto_tree_add_item(elem_tree, hf_ctlv_aid_pix_app_code_3gpp, tvb, pos+5, 2, ENC_BIG_ENDIAN);\r\n} else if (rid == AID_RID_3GPP2) {\r\nproto_tree_add_item(elem_tree, hf_ctlv_aid_pix_app_code_3gpp2, tvb, pos+5, 2, ENC_BIG_ENDIAN);\r\n} else {\r\nproto_tree_add_item(elem_tree, hf_ctlv_aid_pix_app_code, tvb, pos+5, 2, ENC_BIG_ENDIAN);\r\n}\r\nproto_tree_add_item(elem_tree, hf_ctlv_aid_pix_country_code, tvb, pos+7, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(elem_tree, hf_ctlv_aid_pix_app_prov_code, tvb, pos+9, 3, ENC_BIG_ENDIAN);\r\nif (len > 12) {\r\nproto_tree_add_item(elem_tree, hf_ctlv_aid_pix_app_prov_field, tvb, pos+12, len-12, ENC_NA);\r\n}\r\n}\r\nbreak;\r\ncase 0x32:\r\nfor (i = 0; i < len; i++)\r\nproto_tree_add_item(elem_tree, hf_ctlv_bearer, tvb, pos+i, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x35:\r\ng8 = tvb_get_guint8(tvb, pos);\r\nproto_tree_add_uint(elem_tree, hf_ctlv_bearer_descr, tvb, pos, 1, g8);\r\nswitch (g8) {\r\ncase 0x01:\r\nproto_tree_add_item(elem_tree, hf_ctlv_bearer_csd_data_rate, tvb, pos+1, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(elem_tree, hf_ctlv_bearer_csd_bearer_serv, tvb, pos+2, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(elem_tree, hf_ctlv_bearer_csd_conn_elem, tvb, pos+3, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x02:\r\nproto_tree_add_item(elem_tree, hf_ctlv_bearer_gprs_precedence, tvb, pos+1, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(elem_tree, hf_ctlv_bearer_gprs_delay, tvb, pos+2, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(elem_tree, hf_ctlv_bearer_gprs_reliability, tvb, pos+3, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(elem_tree, hf_ctlv_bearer_gprs_peak, tvb, pos+4, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(elem_tree, hf_ctlv_bearer_gprs_mean, tvb, pos+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(elem_tree, hf_ctlv_bearer_gprs_prot_type, tvb, pos+6, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x09:\r\nproto_tree_add_item(elem_tree, hf_ctlv_bearer_utran_traffic_class, tvb, pos+1, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(elem_tree, hf_ctlv_bearer_utran_max_bitrate_ul, tvb, pos+2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(elem_tree, hf_ctlv_bearer_utran_max_bitrate_dl, tvb, pos+4, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(elem_tree, hf_ctlv_bearer_utran_guaranteed_bitrate_ul, tvb, pos+6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(elem_tree, hf_ctlv_bearer_utran_guaranteed_bitrate_dl, tvb, pos+8, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(elem_tree, hf_ctlv_bearer_utran_delivery_order, tvb, pos+10, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(elem_tree, hf_ctlv_bearer_utran_max_sdu_size, tvb, pos+11, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(elem_tree, hf_ctlv_bearer_utran_sdu_error_ratio, tvb, pos+12, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(elem_tree, hf_ctlv_bearer_utran_residual_bit_error_ratio, tvb, pos+13, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(elem_tree, hf_ctlv_bearer_utran_delivery_erroneous_sdus, tvb, pos+14, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(elem_tree, hf_ctlv_bearer_utran_transfer_delay, tvb, pos+15, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(elem_tree, hf_ctlv_bearer_utran_traffic_handling_prio, tvb, pos+16, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(elem_tree, hf_ctlv_bearer_utran_pdp_type, tvb, pos+1, 17, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x0a:\r\nbreak;\r\ncase 0x0b:\r\nde_esm_qos(tvb, elem_tree, pinfo, pos+1, len-2, NULL, 0);\r\nproto_tree_add_item(elem_tree, hf_ctlv_bearer_utran_pdp_type, tvb, pos+len-1, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nif (len > 1) {\r\nproto_tree_add_item(elem_tree, hf_ctlv_bearer_params, tvb, pos+1, len-1, ENC_NA);\r\n}\r\nbreak;\r\n}\r\nbreak;\r\ncase 0x39:\r\nproto_tree_add_item(elem_tree, hf_ctlv_buffers_size, tvb, pos, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x3c:\r\nif (len < 3)\r\nbreak;\r\nproto_tree_add_item(elem_tree, hf_ctlv_transport_ptype, tvb, pos, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(elem_tree, hf_ctlv_transport_port, tvb, pos+1, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x3e:\r\ng8 = tvb_get_guint8(tvb, pos);\r\nproto_tree_add_uint(elem_tree, hf_ctlv_other_address_coding, tvb, pos, 1, g8);\r\nswitch (g8) {\r\ncase 0x21:\r\nproto_tree_add_item(elem_tree, hf_ctlv_other_address_ipv4, tvb, pos+1, 4, ENC_NA);\r\nbreak;\r\ncase 0x57:\r\nproto_tree_add_item(elem_tree, hf_ctlv_other_address_ipv6, tvb, pos+1, 16, ENC_NA);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nbreak;\r\ncase 0x3f:\r\nfor (i = 0; i < len; i++)\r\nproto_tree_add_item(elem_tree, hf_ctlv_access_tech, tvb, pos+i, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x40:\r\nif (dns_server) {\r\ng8 = tvb_get_guint8(tvb, pos);\r\nproto_tree_add_uint(elem_tree, hf_ctlv_dns_server_address_coding, tvb, pos, 1, g8);\r\nswitch (g8) {\r\ncase 0x21:\r\nproto_tree_add_item(elem_tree, hf_ctlv_dns_server_address_ipv4, tvb, pos+1, 4, ENC_NA);\r\nbreak;\r\ncase 0x57:\r\nproto_tree_add_item(elem_tree, hf_ctlv_dns_server_address_ipv6, tvb, pos+1, 16, ENC_NA);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\nbreak;\r\ncase 0x47:\r\nde_sm_apn(tvb, elem_tree, pinfo, pos, len, NULL, 0);\r\nbreak;\r\ncase 0x69:\r\nproto_tree_add_item(elem_tree, hf_ctlv_utran_eutran_meas_qual, tvb, pos, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x73:\r\nde_gmm_rai(tvb, elem_tree, pinfo, pos, len, NULL, 0);\r\nbreak;\r\ncase 0x74:\r\nproto_tree_add_item(elem_tree, hf_ctlv_upd_attach_type, tvb, pos, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase 0x76:\r\nif (ims_event) {\r\nproto_tree_add_item(elem_tree, hf_ctlv_iari, tvb, pos, len, ENC_UTF_8 | ENC_NA);\r\n}\r\nbreak;\r\ncase 0x77:\r\nif (ims_event) {\r\ni = 0;\r\nwhile (i < len) {\r\nif (tvb_get_guint8(tvb, pos+i) == 0x80) {\r\ng8 = tvb_get_guint8(tvb, pos+i+1);\r\nproto_tree_add_item(elem_tree, hf_ctlv_impu, tvb, pos+i+2, g8, ENC_UTF_8 | ENC_NA);\r\ni += 2+g8;\r\n} else {\r\nbreak;\r\n}\r\n}\r\n}\r\nbreak;\r\ncase 0x78:\r\nif (ims_event) {\r\nguint8 *status_code = tvb_get_string_enc(wmem_packet_scope(), tvb, pos, len, ENC_ASCII);\r\nproto_tree_add_string_format_value(elem_tree, hf_ctlv_ims_status_code, tvb, pos, len,\r\nstatus_code, "%s (%s)", status_code, str_to_str(status_code, ims_status_code, "Unknown"));\r\n}\r\nbreak;\r\ncase 0x79:\r\nfor (i = 0; i < len; i+=3) {\r\ndissect_e212_mcc_mnc(tvb, pinfo, elem_tree, pos+3*i, E212_NONE, TRUE);\r\n}\r\nbreak;\r\ncase 0x7a:\r\nproto_tree_add_item(elem_tree, hf_ctlv_broadcast_nw_tech, tvb, pos, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(elem_tree, hf_ctlv_broadcast_nw_loc_info, tvb, pos+1, len-1, ENC_NA);\r\nbreak;\r\ncase 0x7c:\r\nnas_esm_pdn_con_req(tvb, elem_tree, pinfo, pos, len);\r\nbreak;\r\ncase 0x7d:\r\nde_emm_trac_area_id(tvb, elem_tree, pinfo, pos, 5, NULL, 0);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\npos += len;\r\n}\r\nreturn length;\r\n}\r\nvoid\r\nproto_register_card_app_toolkit(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_cat_tlv,\r\n{ "COMPREHENSIVE-TLV", "etsi_cat.comp_tlv",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_devid_src,\r\n{ "Source Device ID", "etsi_cat.comp_tlv.src_dev",\r\nFT_UINT8, BASE_HEX | BASE_EXT_STRING, &dev_id_vals_ext, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_devid_dst,\r\n{ "Destination Device ID", "etsi_cat.comp_tlv.dst_dev",\r\nFT_UINT8, BASE_HEX | BASE_EXT_STRING, &dev_id_vals_ext, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_cmd_nr,\r\n{ "Command Number", "etsi_cat.comp_tlv.cmd_nr",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_cmd_type,\r\n{ "Command Type", "etsi_cat.comp_tlv.cmd_type",\r\nFT_UINT8, BASE_HEX | BASE_EXT_STRING, &cmd_type_vals_ext, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_cmd_qual_refresh,\r\n{ "Command Qualifier", "etsi_cat.comp_tlv.cmd_qual.refresh",\r\nFT_UINT8, BASE_HEX, VALS(cmd_qual_refresh_vals), 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_cmd_qual_send_short_msg,\r\n{ "Command Qualifier", "etsi_cat.comp_tlv.cmd_qual.send_short_msg",\r\nFT_BOOLEAN, 8, TFS(&cmd_qual_send_short_msg_value), 0x01,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_cmd_qual_loci,\r\n{ "Command Qualifier", "etsi_cat.comp_tlv.cmd_qual.loci",\r\nFT_UINT8, BASE_HEX | BASE_EXT_STRING, &cmd_qual_loci_vals_ext, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_cmd_qual_timer_mgmt,\r\n{ "Command Qualifier", "etsi_cat.comp_tlv.cmd_qual.timer_mgmt",\r\nFT_UINT8, BASE_HEX, VALS(cmd_qual_timer_mgmt_vals), 0x03,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_cmd_qual_send_data,\r\n{ "Command Qualifier", "etsi_cat.comp_tlv.cmd_qual.send_data",\r\nFT_BOOLEAN, 8, TFS(&cmd_qual_send_data_value), 0x01,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_cmd_qual,\r\n{ "Command Qualifier", "etsi_cat.comp_tlv.cmd_qual",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_dur_time_unit,\r\n{ "Time Unit", "etsi_cat.comp_tlv.time_unit",\r\nFT_UINT8, BASE_HEX, VALS(time_unit_vals), 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_dur_time_intv,\r\n{ "Time Interval", "etsi_cat.comp_tlv.time_interval",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_alpha_id_string,\r\n{ "Alpha Identifier String", "etsi_cat.comp_tlv.alpha_id.string",\r\nFT_STRING, STR_UNICODE, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_address_ton,\r\n{ "TON", "etsi_cat.comp_tlv.address.ton",\r\nFT_UINT8, BASE_HEX, VALS(ton_vals), 0x70,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_address_npi,\r\n{ "NPI", "etsi_cat.comp_tlv.address.npi",\r\nFT_UINT8, BASE_HEX, VALS(npi_vals), 0x0f,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_address_string,\r\n{ "Address String", "etsi_cat.comp_tlv.address.string",\r\nFT_STRING, STR_UNICODE, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_subaddress_string,\r\n{ "Subaddress String", "etsi_cat.comp_tlv.subaddress.string",\r\nFT_STRING, STR_UNICODE, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_result_gen,\r\n{ "Result", "etsi_cat.comp_tlv.result",\r\nFT_UINT8, BASE_HEX | BASE_EXT_STRING, &result_vals_ext, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_result_term,\r\n{ "Additional information", "etsi_cat.comp_tlv.result.term",\r\nFT_UINT8, BASE_HEX | BASE_EXT_STRING, &result_term_vals_ext, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_result_launch_browser,\r\n{ "Additional information", "etsi_cat.comp_tlv.result.launch_browser",\r\nFT_UINT8, BASE_HEX, VALS(result_launch_browser_vals), 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_result_multiplecard,\r\n{ "Additional information", "etsi_cat.comp_tlv.result.multiplecard",\r\nFT_UINT8, BASE_HEX | BASE_EXT_STRING, &result_multiplecard_vals_ext, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_result_cc_ctrl_mo_sm_ctrl,\r\n{ "Additional information", "etsi_cat.comp_tlv.result.cc_ctrl_mo_sm_ctrl",\r\nFT_UINT8, BASE_HEX, VALS(result_cc_ctrl_mo_sm_ctrl_vals), 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_result_bip,\r\n{ "Additional information", "etsi_cat.comp_tlv.result.bip",\r\nFT_UINT8, BASE_HEX | BASE_EXT_STRING, &result_bip_vals_ext, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_result_frames_cmd,\r\n{ "Additional information", "etsi_cat.comp_tlv.result.frames_cmd",\r\nFT_UINT8, BASE_HEX, VALS(result_frames_cmd_vals), 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_text_string_enc,\r\n{ "Text String Encoding", "etsi_cat.comp_tlv.text_encoding",\r\nFT_UINT8, BASE_HEX|BASE_RANGE_STRING, RVALS(text_encoding_vals), 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_text_string,\r\n{ "Text String", "etsi_cat.comp_tlv.text",\r\nFT_STRING, STR_UNICODE, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_event,\r\n{ "Event", "etsi_cat.comp_tlv.event",\r\nFT_UINT8, BASE_HEX | BASE_EXT_STRING, &event_list_vals_ext, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_tone,\r\n{ "Tone", "etsi_cat.comp_tlv.tone",\r\nFT_UINT8, BASE_HEX | BASE_EXT_STRING, &tone_vals_ext, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_item_id,\r\n{ "Item Identifier", "etsi_cat.comp_tlv.item.id",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_item_string,\r\n{ "Item String", "etsi_cat.comp_tlv.item.string",\r\nFT_STRING, STR_UNICODE, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_loc_status,\r\n{ "Location Status", "etsi_cat.comp_tlv.loc_status",\r\nFT_UINT8, BASE_HEX, VALS(loc_status_vals), 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_timer_val_hr,\r\n{ "Hours", "etsi_cat.comp_tlv.timer_val.hr",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_timer_val_min,\r\n{ "Minutes", "etsi_cat.comp_tlv.timer_val.min",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_timer_val_sec,\r\n{ "Seconds", "etsi_cat.comp_tlv.timer_val.sec",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_date_time_yr,\r\n{ "Year", "etsi_cat.comp_tlv.date_time.yr",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_date_time_mo,\r\n{ "Month", "etsi_cat.comp_tlv.date_time.mo",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_date_time_day,\r\n{ "Day", "etsi_cat.comp_tlv.date_time.day",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_date_time_hr,\r\n{ "Hours", "etsi_cat.comp_tlv.date_time.hr",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_date_time_min,\r\n{ "Minutes", "etsi_cat.comp_tlv.date_time.min",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_date_time_sec,\r\n{ "Seconds", "etsi_cat.comp_tlv.date_time.sec",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_date_time_tz,\r\n{ "Time Zone", "etsi_cat.comp_tlv.date_time.tz",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_at_cmd,\r\n{ "AT Command", "etsi_cat.comp_tlv.at_cmd",\r\nFT_STRING, STR_UNICODE, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_at_rsp,\r\n{ "AT Response", "etsi_cat.comp_tlv.at_rsp",\r\nFT_STRING, STR_UNICODE, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_dtmf_string,\r\n{ "DMTF String", "etsi_cat.comp_tlv.dtmf.string",\r\nFT_STRING, STR_UNICODE, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_language,\r\n{ "Language", "etsi_cat.comp_tlv.language",\r\nFT_STRING, STR_UNICODE, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_me_status,\r\n{ "ME Status", "etsi_cat.comp_tlv.me_status",\r\nFT_UINT8, BASE_DEC, VALS(me_status_vals), 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_timing_adv,\r\n{ "Timing Advance", "etsi_cat.comp_tlv.timing_adv",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_aid_rid,\r\n{ "RID", "etsi_cat.comp_tlv.aid.rid",\r\nFT_UINT64, BASE_HEX|BASE_VAL64_STRING, VALS64(aid_rid_vals), 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_aid_pix_app_code_etsi,\r\n{ "PIX Application Code", "etsi_cat.comp_tlv.aid.pix.app_code",\r\nFT_UINT16, BASE_HEX, VALS(aid_pix_app_code_etsi_vals), 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_aid_pix_app_code_3gpp,\r\n{ "PIX Application Code", "etsi_cat.comp_tlv.aid.pix.app_code",\r\nFT_UINT16, BASE_HEX, VALS(aid_pix_app_code_3gpp_vals), 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_aid_pix_app_code_3gpp2,\r\n{ "PIX Application Code", "etsi_cat.comp_tlv.aid.pix.app_code",\r\nFT_UINT16, BASE_HEX, VALS(aid_pix_app_code_3gpp2_vals), 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_aid_pix_app_code,\r\n{ "PIX Application Code", "etsi_cat.comp_tlv.aid.pix.app_code",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_aid_pix_country_code,\r\n{ "PIX Country Code", "etsi_cat.comp_tlv.aid.pix.country_code",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_aid_pix_app_prov_code,\r\n{ "PIX Application Provider Code", "etsi_cat.comp_tlv.aid.pix.app_prov_code",\r\nFT_UINT24, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_aid_pix_app_prov_field,\r\n{ "PIX Application Provider Field", "etsi_cat.comp_tlv.aid.pix.app_prov_field",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_bearer,\r\n{ "Bearer", "etsi_cat.comp_tlv.bearer",\r\nFT_UINT8, BASE_HEX, VALS(bearer_vals), 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_bearer_descr,\r\n{ "Bearer Description", "etsi_cat.comp_tlv.bearer.descr",\r\nFT_UINT8, BASE_HEX | BASE_EXT_STRING, &bearer_descr_vals_ext, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_bearer_csd_data_rate,\r\n{ "Data Rate", "etsi_cat.comp_tlv.bearer.csd.data_rate",\r\nFT_UINT8, BASE_DEC | BASE_EXT_STRING, &csd_data_rate_vals_ext, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_bearer_csd_bearer_serv,\r\n{ "Bearer Service", "etsi_cat.comp_tlv.bearer.csd.bearer_serv",\r\nFT_UINT8, BASE_DEC, VALS(csd_bearer_serv_vals), 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_bearer_csd_conn_elem,\r\n{ "Connection Element", "etsi_cat.comp_tlv.bearer.csd.conn_elem",\r\nFT_UINT8, BASE_DEC, VALS(csd_conn_elem_vals), 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_bearer_gprs_precedence,\r\n{ "Precedence Class", "etsi_cat.comp_tlv.bearer.gprs.precedence",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_bearer_gprs_delay,\r\n{ "Delay Class", "etsi_cat.comp_tlv.bearer.gprs.delay",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_bearer_gprs_reliability,\r\n{ "Reliability Class", "etsi_cat.comp_tlv.bearer.gprs.reliability",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_bearer_gprs_peak,\r\n{ "Peak Throughput Class", "etsi_cat.comp_tlv.bearer.gprs.peak",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_bearer_gprs_mean,\r\n{ "Mean Throughput Class", "etsi_cat.comp_tlv.bearer.gprs.mean",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_bearer_gprs_prot_type,\r\n{ "Packet Data Protocol Type", "etsi_cat.comp_tlv.bearer.gprs.prot_type",\r\nFT_UINT8, BASE_DEC, VALS(gprs_prot_type_vals), 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_bearer_utran_traffic_class,\r\n{ "Traffic Class", "etsi_cat.comp_tlv.bearer.utran.traffic_class",\r\nFT_UINT8, BASE_DEC, VALS(utran_traffic_class_vals), 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_bearer_utran_max_bitrate_ul,\r\n{ "Maximum Bitrate UL", "etsi_cat.comp_tlv.bearer.utran.max_bitrate_ul",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_bearer_utran_max_bitrate_dl,\r\n{ "Maximum Bitrate DL", "etsi_cat.comp_tlv.bearer.utran.max_bitrate_dl",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_bearer_utran_guaranteed_bitrate_ul,\r\n{ "Guaranteed Bitrate DL", "etsi_cat.comp_tlv.bearer.utran.guaranteed_bitrate_ul",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_bearer_utran_guaranteed_bitrate_dl,\r\n{ "Guaranteed Bitrate DL", "etsi_cat.comp_tlv.bearer.utran.guaranteed_bitrate_dl",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_bearer_utran_delivery_order,\r\n{ "Delivery Order", "etsi_cat.comp_tlv.bearer.utran.delivery_order",\r\nFT_UINT8, BASE_DEC, VALS(utran_delivery_order_vals), 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_bearer_utran_max_sdu_size,\r\n{ "Maximum SDU Size", "etsi_cat.comp_tlv.bearer.utran.max_sdu_size",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_bearer_utran_sdu_error_ratio,\r\n{ "SDU Error Ratio", "etsi_cat.comp_tlv.bearer.utran.sdu_error_ratio",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_bearer_utran_residual_bit_error_ratio,\r\n{ "Residual Bit Error Ratio", "etsi_cat.comp_tlv.bearer.utran.residual_bit_error_ratio",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_bearer_utran_delivery_erroneous_sdus,\r\n{ "Delivery of Erroneous SDUs", "etsi_cat.comp_tlv.bearer.utran.delivery_erroneous_sdus",\r\nFT_UINT8, BASE_DEC, VALS(utran_delivery_erroneous_sdus_vals), 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_bearer_utran_transfer_delay,\r\n{ "Transfer Delay", "etsi_cat.comp_tlv.bearer.utran.transfer_delay",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_bearer_utran_traffic_handling_prio,\r\n{ "Traffic Handling Priority", "etsi_cat.comp_tlv.bearer.utran.traffic_handling_prio",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_bearer_utran_pdp_type,\r\n{ "PDP Type", "etsi_cat.comp_tlv.bearer.utran.pdp_type",\r\nFT_UINT8, BASE_DEC, VALS(pdp_type_vals), 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_bearer_params,\r\n{ "Bearer Parameters", "etsi_cat.comp_tlv.bearer.params",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_buffers_size,\r\n{ "Buffer Size", "etsi_cat.comp_tlv.buffer_size",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_transport_ptype,\r\n{ "Transport protocol type", "etsi_cat.comp_tlv.transport.ptype",\r\nFT_UINT8, BASE_HEX, VALS(transport_ptype_vals), 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_transport_port,\r\n{ "Transport port", "etsi_cat.comp_tlv.transport.port",\r\nFT_UINT16, BASE_DEC, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_other_address_coding,\r\n{ "Coding of Type of address", "etsi_cat.comp_tlv.other_address.coding",\r\nFT_UINT8, BASE_HEX, VALS(other_address_coding_vals), 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_other_address_ipv4,\r\n{ "IPv4 address", "etsi_cat.comp_tlv.other_address.ipv4",\r\nFT_IPv4, BASE_NONE, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_other_address_ipv6,\r\n{ "IPv6 address", "etsi_cat.comp_tlv.other_address.ipv6",\r\nFT_IPv6, BASE_NONE, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_access_tech,\r\n{ "Access technology", "etsi_cat.comp_tlv.access_tech",\r\nFT_UINT8, BASE_HEX, VALS(access_tech_vals), 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_dns_server_address_coding,\r\n{ "Type of address", "etsi_cat.comp_tlv.dns_server_address.coding",\r\nFT_UINT8, BASE_HEX, VALS(other_address_coding_vals), 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_dns_server_address_ipv4,\r\n{ "IPv4 address", "etsi_cat.comp_tlv.dns_server_address.ipv4",\r\nFT_IPv4, BASE_NONE, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_dns_server_address_ipv6,\r\n{ "IPv6 address", "etsi_cat.comp_tlv.dns_server_address.ipv6",\r\nFT_IPv6, BASE_NONE, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_utran_eutran_meas_qual,\r\n{ "UTRAN/E-UTRAN Measurement Qualifier", "etsi_cat.comp_tlv.utran_eutran_meas_qual",\r\nFT_UINT8, BASE_HEX, VALS(utran_eutran_meas_qual_vals), 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_upd_attach_type,\r\n{ "UTRAN/E-UTRAN Measurement Qualifier", "etsi_cat.comp_tlv.upd_attach_type",\r\nFT_UINT8, BASE_HEX | BASE_EXT_STRING, &upd_attach_type_vals_ext, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_loci_lac,\r\n{ "Location Area Code / Tracking Area Code", "etsi_cat.comp_tlv.loci.lac",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_loci_cell_id,\r\n{ "Cell ID", "etsi_cat.comp_tlv.loci.cell_id",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_loci_ext_cell_id,\r\n{ "Extended Cell ID", "etsi_cat.comp_tlv.loci.ext_cell_id",\r\nFT_UINT16, BASE_HEX, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_iari,\r\n{ "IARI", "etsi_cat.comp_tlv.iari",\r\nFT_STRING, STR_UNICODE, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_impu,\r\n{ "IMPU", "etsi_cat.comp_tlv.impu",\r\nFT_STRING, STR_UNICODE, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_ims_status_code,\r\n{ "IMS Status-Code", "etsi_cat.comp_tlv.ims_status_code",\r\nFT_STRING, STR_UNICODE, NULL, 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_broadcast_nw_tech,\r\n{ "Broadcast Network Technology", "etsi_cat.comp_tlv.broadcast_nw.tech",\r\nFT_UINT8, BASE_HEX, VALS(broadcast_nw_tech_vals), 0,\r\nNULL, HFILL },\r\n},\r\n{ &hf_ctlv_broadcast_nw_loc_info,\r\n{ "Broadcast Network Location Information", "etsi_cat.comp_tlv.broadcast_nw.loc_info",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL },\r\n}\r\n};\r\nstatic gint *ett[] = {\r\n&ett_cat,\r\n&ett_elem,\r\n};\r\nproto_cat = proto_register_protocol("Card Application Tookit ETSI TS 102.223", "ETSI CAT",\r\n"etsi_cat");\r\nproto_register_field_array(proto_cat, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nregister_dissector("etsi_cat", dissect_cat, proto_cat);\r\n}\r\nvoid\r\nproto_reg_handoff_card_app_toolkit(void)\r\n{\r\ngsm_sms_handle = find_dissector_add_dependency("gsm_sms", proto_cat);\r\n}
