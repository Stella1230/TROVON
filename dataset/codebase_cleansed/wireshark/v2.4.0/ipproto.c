const char *ipprotostr(const int proto) {\r\nconst char *s;\r\nif ((s = try_val_to_str_ext(proto, &ipproto_val_ext)) != NULL)\r\nreturn s;\r\ns = "Unknown";\r\n#ifdef HAVE_GETPROTOBYNUMBER\r\nif (gbl_resolv_flags.mac_name || gbl_resolv_flags.network_name ||\r\ngbl_resolv_flags.transport_name) {\r\nstatic char buf[128];\r\nstruct protoent *pe;\r\npe = getprotobynumber(proto);\r\nif (pe) {\r\ng_strlcpy(buf, pe->p_name, sizeof(buf));\r\ns = buf;\r\n}\r\n}\r\n#endif\r\nreturn s;\r\n}\r\nstatic gboolean ipv6_exthdr_check(int proto)\r\n{\r\nswitch (proto) {\r\ncase IP_PROTO_HOPOPTS:\r\ncase IP_PROTO_ROUTING:\r\ncase IP_PROTO_FRAGMENT:\r\ncase IP_PROTO_ESP:\r\ncase IP_PROTO_AH:\r\ncase IP_PROTO_DSTOPTS:\r\ncase IP_PROTO_MIPV6:\r\ncase IP_PROTO_HIP:\r\ncase IP_PROTO_SHIM6:\r\nreturn TRUE;\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nreturn FALSE;\r\n}\r\nconst char *ipv6extprotostr(int proto)\r\n{\r\nif (ipv6_exthdr_check(proto))\r\nreturn ipprotostr(proto);\r\nreturn NULL;\r\n}
