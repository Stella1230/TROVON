static void\r\nreal_free(tvbuff_t *tvb)\r\n{\r\nstruct tvb_real *real_tvb = (struct tvb_real *) tvb;\r\nif (real_tvb->free_cb) {\r\nreal_tvb->free_cb((gpointer)tvb->real_data);\r\n}\r\n}\r\nstatic guint\r\nreal_offset(const tvbuff_t *tvb _U_, const guint counter)\r\n{\r\nreturn counter;\r\n}\r\ntvbuff_t *\r\ntvb_new_real_data(const guint8* data, const guint length, const gint reported_length)\r\n{\r\ntvbuff_t *tvb;\r\nstruct tvb_real *real_tvb;\r\nTHROW_ON(reported_length < -1, ReportedBoundsError);\r\ntvb = tvb_new(&tvb_real_ops);\r\ntvb->real_data = data;\r\ntvb->length = length;\r\ntvb->reported_length = reported_length;\r\ntvb->initialized = TRUE;\r\ntvb->ds_tvb = tvb;\r\nreal_tvb = (struct tvb_real *) tvb;\r\nreal_tvb->free_cb = NULL;\r\nreturn tvb;\r\n}\r\nvoid\r\ntvb_set_free_cb(tvbuff_t *tvb, const tvbuff_free_cb_t func)\r\n{\r\nstruct tvb_real *real_tvb = (struct tvb_real *) tvb;\r\nDISSECTOR_ASSERT(tvb);\r\nDISSECTOR_ASSERT(tvb->ops == &tvb_real_ops);\r\nreal_tvb->free_cb = func;\r\n}\r\nvoid\r\ntvb_set_child_real_data_tvbuff(tvbuff_t *parent, tvbuff_t *child)\r\n{\r\nDISSECTOR_ASSERT(parent && child);\r\nDISSECTOR_ASSERT(parent->initialized);\r\nDISSECTOR_ASSERT(child->initialized);\r\nDISSECTOR_ASSERT(child->ops == &tvb_real_ops);\r\ntvb_add_to_chain(parent, child);\r\n}\r\ntvbuff_t *\r\ntvb_new_child_real_data(tvbuff_t *parent, const guint8* data, const guint length, const gint reported_length)\r\n{\r\ntvbuff_t *tvb = tvb_new_real_data(data, length, reported_length);\r\ntvb_set_child_real_data_tvbuff(parent, tvb);\r\nreturn tvb;\r\n}
