static void dissect_bt_tunneled_proto(proto_tree* tree, tvbuff_t* tvb, packet_info* pinfo, int hfid, h248_curr_info_t* i _U_, void* d _U_) {\r\ntvbuff_t* bctp_tvb = NULL;\r\ngint8 appclass;\r\ngboolean pc;\r\ngint32 tag;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\nget_ber_identifier(tvb, 0, &appclass, &pc, &tag);\r\nif (tag == BER_UNI_TAG_OCTETSTRING) {\r\ndissect_ber_octet_string(FALSE, &asn1_ctx, tree, tvb, 0, hfid, &bctp_tvb);\r\nif (bctp_tvb) {\r\ncall_dissector(bctp_dissector,bctp_tvb,pinfo,tree);\r\n}\r\n} else {\r\nproto_tree_add_item(tree,hfid,tvb,0,-1,ENC_NA);\r\n}\r\n}\r\nvoid proto_reg_handoff_q1950(void) {\r\nbctp_dissector = find_dissector_add_dependency("bctp", proto_q1950);\r\n}\r\nvoid proto_register_q1950(void) {\r\nstatic hf_register_info hf[] = {\r\n{ &hf_h248_pkg_BCP,\r\n{ "BCP (Bearer characteristics package)", "h248.BCP",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_h248_pkg_BCP_BNCChar,\r\n{ "BNCChar (BNC Characteristics)", "h248.bcp.bncchar",\r\nFT_UINT32, BASE_HEX|BASE_EXT_STRING, &bearer_network_connection_characteristics_vals_ext, 0, "BNC Characteristics", HFILL }\r\n},\r\n{ &hf_h248_pkg_BNCCT,\r\n{ "BNCCT (Bearer network connection cut-through package)", "h248.BNCCT",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_h248_pkg_BNCCT_prop,\r\n{ "Bearer network connection cut-through capability", "h248.bcp.bncct",\r\nFT_UINT32, BASE_HEX, VALS(h248_pkg_BNCCT_prop_vals), 0, "This property allows the MGC to ask the MG when the cut through of a bearer will occur, early or late.", HFILL }\r\n},\r\n{ &hf_h248_pkg_GB,\r\n{ "GB (Generic bearer connection)", "h248.GB",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_h248_pkg_GB_BNCChange,\r\n{ "BNCChange", "h248.GB.BNCChang",\r\nFT_BYTES, BASE_NONE, NULL, 0, "This event occurs whenever a change to a Bearer Network connection occurs", HFILL }\r\n},\r\n{ &hf_h248_pkg_GB_BNCChange_type,\r\n{ "Type", "h248.GB.BNCChang.Type",\r\nFT_UINT32, BASE_HEX, VALS(h248_pkg_GB_BNCChange_type_vals), 0, NULL, HFILL }\r\n},\r\n{ &hf_h248_pkg_GB_EstBNC,\r\n{ "Type", "h248.GB.BNCChang.EstBNC",\r\nFT_BYTES, BASE_NONE, NULL, 0, "This signal triggers the bearer control function to send bearer establishment signalling", HFILL }\r\n},\r\n{ &hf_h248_pkg_GB_ModBNC,\r\n{ "Type", "h248.GB.BNCChang.ModBNC",\r\nFT_BYTES, BASE_NONE, NULL, 0, "This signal triggers the bearer control function to send bearer modification", HFILL }\r\n},\r\n{ &hf_h248_pkg_GB_RelBNC,\r\n{ "RelBNC", "h248.GB.BNCChang.RelBNC",\r\nFT_BYTES, BASE_NONE, NULL, 0, "This signal triggers the bearer control function to send bearer release", HFILL }\r\n},\r\n{ &hf_h248_pkg_GB_RelBNC_Generalcause,\r\n{ "Generalcause", "h248.GB.BNCChang.RelBNC.Generalcause",\r\nFT_UINT32, BASE_HEX, VALS(h248_pkg_GB_RelBNC_Generalcause_vals), 0, "This indicates the general reason for the Release", HFILL }\r\n},\r\n{ &hf_h248_pkg_GB_RelBNC_Failurecause,\r\n{ "Failurecause", "h248.GB.BNCChang.RelBNC.Failurecause",\r\nFT_BYTES, BASE_NONE, NULL, 0, "The Release Cause is the value generated by the Released equipment", HFILL }\r\n},\r\n{ &hf_h248_pkg_GB_RelBNC_Reset,\r\n{ "RelBNC", "h248.GB.BNCChang.RelBNC.Reset",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0x0, "This signal triggers the bearer control function to send bearer release", HFILL }\r\n},\r\n{ &hf_h248_pkg_RI,\r\n{ "RI (Reuse idle package)", "h248.RI",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_h248_pkg_RII,\r\n{ "Reuse Idle Indication", "h248.bcp.rii",\r\nFT_UINT32, BASE_HEX, VALS(h248_pkg_RII_vals), 0, "This property indicates that the provided bearer network connection relates to an Idle Bearer.", HFILL }\r\n},\r\n{ &hf_h248_pkg_bt,\r\n{ "BT (Bearer control Tunneling)", "h248.BT",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_h248_pkg_bt_tunopt,\r\n{ "Tunnelling Options", "h248.BT.TunOpt",\r\nFT_UINT32, BASE_DEC, VALS(h248_pkg_bt_tunopt_vals), 0, NULL, HFILL }\r\n},\r\n{ &hf_h248_pkg_bt_tind,\r\n{ "tind (Tunnel INDication)", "h248.BT.TIND",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_h248_pkg_bt_bit,\r\n{ "Bearer Information Transport", "h248.BT.BIT",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_h248_pkg_bcg,\r\n{ "bcg (Basic call progress tones generator with directionality)", "h248.bcg",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_h248_pkg_bcg_sig_bdt_par_btd,\r\n{ "btd (Tone Direction)", "h248.bcp.btd",\r\nFT_UINT32, BASE_HEX, VALS(h248_pkg_bcg_sig_bdt_par_btd_vals), 0, NULL, HFILL }\r\n},\r\n{ &hf_h248_pkg_bcg_sig_bdt,\r\n{ "bdt (Dial Tone)", "h248.bcg.bdt",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_h248_pkg_bcg_sig_brt,\r\n{ "brt (Ringing tone)", "h248.bcg.brt",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_h248_pkg_bcg_sig_bbt,\r\n{ "bbt (Busy tone)", "h248.bcg.bbt",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_h248_pkg_bcg_sig_bct,\r\n{ "bct (Congestion tone)", "h248.bcg.bct",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_h248_pkg_bcg_sig_bsit,\r\n{ "bsit (Special information tone)", "h248.bcg.bsit",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_h248_pkg_bcg_sig_bwt,\r\n{ "bwt (Warning tone)", "h248.bcg.bwt",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_h248_pkg_bcg_sig_bpt,\r\n{ "bpt (Payphone recognition tone)", "h248.bcg.bpt",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_h248_pkg_bcg_sig_bcw,\r\n{ "bcw (Call waiting tone)", "h248.bcg.bcw",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_h248_pkg_bcg_sig_bcr,\r\n{ "bcr (Call ringing tone)", "h248.bcg.bcr",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n{ &hf_h248_pkg_bcg_sig_bpy,\r\n{ "bpy (Pay tone)", "h248.bcg.bpy",\r\nFT_UINT8, BASE_HEX, NULL, 0, NULL, HFILL }\r\n},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_h248_pkg_BCP,\r\n&ett_h248_pkg_bt,\r\n&ett_h248_pkg_bt_tind,\r\n&ett_h248_pkg_bt_bit,\r\n&ett_h248_pkg_bcg,\r\n&ett_h248_pkg_bcg_sig_bdt,\r\n&ett_h248_pkg_BNCCT,\r\n&ett_h248_pkg_RI,\r\n&ett_h248_pkg_GB,\r\n&ett_h248_pkg_GB_EstBNC,\r\n&ett_h248_pkg_GB_ModBNC,\r\n&ett_h248_pkg_GB_RelBNC,\r\n&ett_h248_pkg_GB_BNCChange\r\n};\r\nproto_q1950 = proto_register_protocol(PNAME, PSNAME, PFNAME);\r\nproto_register_field_array(proto_q1950, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nh248_register_package(&h248_pkg_BCP,REPLACE_PKG);\r\nh248_register_package(&h248_pkg_BNCCT,REPLACE_PKG);\r\nh248_register_package(&h248_pkg_RI,REPLACE_PKG);\r\nh248_register_package(&h248_pkg_GB,REPLACE_PKG);\r\nh248_register_package(&h248_pkg_bcg,REPLACE_PKG);\r\nh248_register_package(&h248_pkg_bct,REPLACE_PKG);\r\n}
