static int dissect_mac_mgmt_msg_rep_req_decoder(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nguint offset = 0;\r\nguint tvb_len;\r\ngint tlv_type, tlv_len, tlv_value_offset, length, tlv_offset;\r\nproto_item *rep_item, *tlv_item, *ti_item;\r\nproto_tree *rep_tree, *tlv_tree, *ti_tree;\r\ntlv_info_t tlv_info;\r\n{\r\ntvb_len = tvb_reported_length(tvb);\r\nrep_item = proto_tree_add_protocol_format(tree, proto_mac_mgmt_msg_rep_decoder, tvb, offset, -1, "Report Request (REP-REQ)");\r\nrep_tree = proto_item_add_subtree(rep_item, ett_mac_mgmt_msg_rep_req_decoder);\r\nwhile(offset < tvb_len)\r\n{\r\ninit_tlv_info(&tlv_info, tvb, offset);\r\ntlv_type = get_tlv_type(&tlv_info);\r\ntlv_len = get_tlv_length(&tlv_info);\r\nif(tlv_type == -1 || tlv_len > MAX_TLV_LEN || tlv_len < 1)\r\n{\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, NULL, "REP-REQ TLV error");\r\nproto_tree_add_item(rep_tree, hf_rep_invalid_tlv, tvb, offset, (tvb_len - offset), ENC_NA);\r\nbreak;\r\n}\r\ntlv_value_offset = get_tlv_value_offset(&tlv_info);\r\n#ifdef DEBUG\r\nproto_tree_add_protocol_format(rep_tree, proto_mac_mgmt_msg_rep_decoder, tvb, offset, (tlv_len + tlv_value_offset), "REP-REQ Type: %u (%u bytes, offset=%u, length=%u, tvb_len=%u)", tlv_type, (tlv_len + tlv_value_offset), offset, tlv_len, tvb_len);\r\n#endif\r\noffset += tlv_value_offset;\r\nswitch (tlv_type)\r\n{\r\ncase REP_REQ_REPORT_REQUEST:\r\ntlv_item = add_tlv_subtree(&tlv_info, rep_tree, hf_rep_req_report_request, tvb, offset-tlv_value_offset, FALSE);\r\ntlv_tree = proto_item_add_subtree(tlv_item, ett_mac_mgmt_msg_rep_req_decoder);\r\nfor( tlv_offset = 0; tlv_offset < tlv_len; )\r\n{\r\ninit_tlv_info(&tlv_info, tvb, (offset + tlv_offset));\r\ntlv_type = get_tlv_type(&tlv_info);\r\nlength = get_tlv_length(&tlv_info);\r\nif(tlv_type == -1 || length > MAX_TLV_LEN || length < 1)\r\n{\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, NULL, "REP-REQ Report Request TLV error");\r\nproto_tree_add_item(tlv_tree, hf_rep_invalid_tlv, tvb, (offset + tlv_offset), (tlv_len - offset - tlv_offset), ENC_NA);\r\nbreak;\r\n}\r\n#ifdef DEBUG\r\nproto_tree_add_protocol_format(rep_tree, proto_mac_mgmt_msg_rep_decoder, tvb, offset, (length + tlv_value_offset), "REP-REQ Report Request Type: %u (%u bytes, offset=%u, length=%u, tvb_len=%u)", tlv_type, (length + tlv_value_offset), offset, length, tvb_len);\r\n#endif\r\ntlv_offset += get_tlv_value_offset(&tlv_info);\r\nswitch (tlv_type)\r\n{\r\ncase REP_REQ_REPORT_TYPE:\r\nti_item = add_tlv_subtree(&tlv_info, tlv_tree, hf_rep_req_report_type, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_BIG_ENDIAN);\r\nti_tree = proto_item_add_subtree(ti_item, ett_mac_mgmt_msg_rep_req_decoder);\r\nproto_tree_add_item(ti_tree, hf_rep_req_rep_type_bit0, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_req_rep_type_bit1, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_req_rep_type_bit2, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_req_rep_type_bit3_6, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_req_rep_type_bit7, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase REP_REQ_CHANNEL_NUMBER:\r\nadd_tlv_subtree(&tlv_info, tlv_tree, hf_rep_req_channel_number, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_BIG_ENDIAN);\r\nbreak;\r\ncase REP_REQ_CHANNEL_TYPE:\r\nti_item = add_tlv_subtree(&tlv_info, tlv_tree, hf_rep_req_channel_type, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_BIG_ENDIAN);\r\nti_tree = proto_item_add_subtree(ti_item, ett_mac_mgmt_msg_rep_req_decoder);\r\nproto_tree_add_item(ti_tree, hf_rep_req_channel_type_request, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_req_channel_type_reserved, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase REP_REQ_ZONE_SPEC_PHY_CINR_REQ:\r\nti_item = add_tlv_subtree(&tlv_info, tlv_tree, hf_rep_req_zone_spec_phy_cinr_request, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_NA);\r\nti_tree = proto_item_add_subtree(ti_item, ett_mac_mgmt_msg_rep_req_decoder);\r\nproto_tree_add_item(ti_tree, hf_rep_req_zone_spec_phy_cinr_req_bit0_2, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_req_zone_spec_phy_cinr_req_bit3, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_req_zone_spec_phy_cinr_req_bit4, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_req_zone_spec_phy_cinr_req_bit5_6, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_req_zone_spec_phy_cinr_req_bit7, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_req_zone_spec_phy_cinr_req_bit8_13, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_req_zone_spec_phy_cinr_req_bit14_17, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_req_zone_spec_phy_cinr_req_bit18, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_req_zone_spec_phy_cinr_req_bit19_23, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase REP_REQ_PREAMBLE_PHY_CINR_REQ:\r\nti_item = add_tlv_subtree(&tlv_info, tlv_tree, hf_rep_req_preamble_phy_cinr_request, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_NA);\r\nti_tree = proto_item_add_subtree(ti_item, ett_mac_mgmt_msg_rep_req_decoder);\r\nproto_tree_add_item(ti_tree, hf_rep_req_preamble_phy_cinr_req_bit0_1, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_req_preamble_phy_cinr_req_bit2_5, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_req_preamble_phy_cinr_req_bit6, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_req_preamble_phy_cinr_req_bit7, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase REP_REQ_ZONE_SPEC_EFF_CINR_REQ:\r\nti_item = add_tlv_subtree(&tlv_info, tlv_tree, hf_rep_req_zone_spec_effective_cinr_request, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_NA);\r\nti_tree = proto_item_add_subtree(ti_item, ett_mac_mgmt_msg_rep_req_decoder);\r\nproto_tree_add_item(ti_tree, hf_rep_req_zone_spec_effective_cinr_req_bit0_2, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_req_zone_spec_effective_cinr_req_bit3, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_req_zone_spec_effective_cinr_req_bit4, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_req_zone_spec_effective_cinr_req_bit5_6, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_req_zone_spec_effective_cinr_req_bit7, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_req_zone_spec_effective_cinr_req_bit8_13, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_req_zone_spec_effective_cinr_req_bit14_15, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase REP_REQ_PREAMBLE_EFF_CINR_REQ:\r\nti_item = add_tlv_subtree(&tlv_info, tlv_tree, hf_rep_req_preamble_effective_cinr_request, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_NA);\r\nti_tree = proto_item_add_subtree(ti_item, ett_mac_mgmt_msg_rep_req_decoder);\r\nproto_tree_add_item(ti_tree, hf_rep_req_preamble_effective_cinr_req_bit0_1, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_req_preamble_effective_cinr_req_bit2_7, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase REP_REQ_CHANNEL_SELECTIVITY_REPORT:\r\nti_item = add_tlv_subtree(&tlv_info, tlv_tree, hf_rep_req_channel_selectivity_report, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_NA);\r\nti_tree = proto_item_add_subtree(ti_item, ett_mac_mgmt_msg_rep_req_decoder);\r\nproto_tree_add_item(ti_tree, hf_rep_req_channel_selectivity_rep_bit0, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_req_channel_selectivity_rep_bit1_7, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nadd_tlv_subtree(&tlv_info, tlv_tree, hf_rep_unknown_type, tvb, (offset + tlv_offset), ENC_NA);\r\nbreak;\r\n}\r\ntlv_offset += length;\r\n}\r\nbreak;\r\ndefault:\r\nadd_tlv_subtree(&tlv_info, rep_tree, hf_rep_unknown_type, tvb, offset-tlv_value_offset, ENC_NA);\r\nbreak;\r\n}\r\noffset += tlv_len;\r\n}\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic int dissect_mac_mgmt_msg_rep_rsp_decoder(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nguint offset = 0;\r\nguint tvb_len, length, value;\r\ngint tlv_type, tlv_len, tlv_value_offset, tlv_offset;\r\ngint db_val;\r\nproto_item *rep_item, *tlv_item, *ti, *ti_item;\r\nproto_tree *rep_tree, *tlv_tree, *ti_tree;\r\ntlv_info_t tlv_info;\r\ngfloat current_power;\r\n{\r\ntvb_len = tvb_reported_length(tvb);\r\nrep_item = proto_tree_add_protocol_format(tree, proto_mac_mgmt_msg_rep_decoder, tvb, offset, -1, "Report Response (REP-RSP)");\r\nrep_tree = proto_item_add_subtree(rep_item, ett_mac_mgmt_msg_rep_rsp_decoder);\r\nwhile(offset < tvb_len)\r\n{\r\ninit_tlv_info(&tlv_info, tvb, offset);\r\ntlv_type = get_tlv_type(&tlv_info);\r\ntlv_len = get_tlv_length(&tlv_info);\r\nif(tlv_type == -1 || tlv_len > MAX_TLV_LEN || tlv_len < 1)\r\n{\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, NULL, "REP-RSP TLV error");\r\nproto_tree_add_item(rep_tree, hf_rep_invalid_tlv, tvb, offset, (tvb_len - offset), ENC_NA);\r\nbreak;\r\n}\r\ntlv_value_offset = get_tlv_value_offset(&tlv_info);\r\n#ifdef DEBUG\r\nproto_tree_add_protocol_format(rep_tree, proto_mac_mgmt_msg_rep_decoder, tvb, offset, (tlv_len + tlv_value_offset), "REP-RSP Type: %u (%u bytes, offset=%u, tlv_len=%u, tvb_len=%u)", tlv_type, (tlv_len + tlv_value_offset), offset, tlv_len, tvb_len);\r\n#endif\r\noffset += tlv_value_offset;\r\nswitch (tlv_type)\r\n{\r\ncase REP_RSP_REPORT_TYPE:\r\ntlv_item = add_tlv_subtree(&tlv_info, rep_tree, hf_rep_rsp_report_type, tvb, offset-tlv_value_offset, ENC_NA);\r\ntlv_tree = proto_item_add_subtree(tlv_item, ett_mac_mgmt_msg_rep_rsp_decoder);\r\nfor( tlv_offset = 0; tlv_offset < tlv_len; )\r\n{\r\ninit_tlv_info(&tlv_info, tvb, (offset + tlv_offset));\r\ntlv_type = get_tlv_type(&tlv_info);\r\nlength = get_tlv_length(&tlv_info);\r\nif(tlv_type == -1 || length > MAX_TLV_LEN || length < 1)\r\n{\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, NULL, "REP-RSP report subtype TLV error");\r\nproto_tree_add_item(tlv_tree, hf_rep_invalid_tlv, tvb, offset, (tlv_len - offset - tlv_offset), ENC_NA);\r\nbreak;\r\n}\r\ntlv_offset += get_tlv_value_offset(&tlv_info);\r\nswitch (tlv_type)\r\n{\r\ncase REP_RSP_REPORT_CHANNEL_NUMBER:\r\nadd_tlv_subtree(&tlv_info, tlv_tree, hf_rep_rsp_report_type_channel_number, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_BIG_ENDIAN);\r\nbreak;\r\ncase REP_RSP_REPORT_START_FRAME:\r\nadd_tlv_subtree(&tlv_info, tlv_tree, hf_rep_rsp_report_type_frame_number, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_BIG_ENDIAN);\r\nbreak;\r\ncase REP_RSP_REPORT_DURATION:\r\nadd_tlv_subtree(&tlv_info, tlv_tree, hf_rep_rsp_report_type_duration, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_BIG_ENDIAN);\r\nbreak;\r\ncase REP_RSP_REPORT_BASIC_REPORT:\r\nti_item = add_tlv_subtree(&tlv_info, tlv_tree, hf_rep_rsp_report_type_basic_report, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_NA);\r\nti_tree = proto_item_add_subtree(ti_item, ett_mac_mgmt_msg_rep_rsp_decoder);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_report_type_basic_report_bit0, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_report_type_basic_report_bit1, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_report_type_basic_report_bit2, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_report_type_basic_report_bit3, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_report_type_basic_report_reserved, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase REP_RSP_REPORT_CINR_REPORT:\r\nti_item = add_tlv_subtree(&tlv_info, tlv_tree, hf_rep_rsp_report_type_cinr_report, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_NA);\r\nti_tree = proto_item_add_subtree(ti_item, ett_mac_mgmt_msg_rep_rsp_decoder);\r\ndb_val = tvb_get_guint8(tvb, offset + tlv_offset) - 20;\r\nif (db_val > 37)\r\ndb_val = 37;\r\nproto_item_append_text(ti_item, " (%d dBm)", db_val);\r\nti = proto_tree_add_item(ti_tree, hf_rep_rsp_report_type_cinr_report_deviation, tvb, (offset + tlv_offset +1), 1, ENC_BIG_ENDIAN);\r\ndb_val = tvb_get_guint8(tvb, offset + tlv_offset + 1) - 20;\r\nif (db_val > 37)\r\ndb_val = 37;\r\nproto_item_append_text(ti, " (%d dBm)", db_val);\r\nbreak;\r\ncase REP_RSP_REPORT_RSSI_REPORT:\r\nti_item = add_tlv_subtree(&tlv_info, tlv_tree, hf_rep_rsp_report_type_rssi_report, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_NA);\r\nti_tree = proto_item_add_subtree(ti_item, ett_mac_mgmt_msg_rep_rsp_decoder);\r\nti = proto_tree_add_item(ti_tree, hf_rep_rsp_report_type_rssi_report_mean, tvb, (offset + tlv_offset), 1, ENC_BIG_ENDIAN);\r\ndb_val = tvb_get_guint8(tvb, offset + tlv_offset) - 123;\r\nif (db_val > -40)\r\ndb_val = -40;\r\nproto_item_append_text(ti, " (%d dBm)", db_val);\r\nti = proto_tree_add_item(ti_tree, hf_rep_rsp_report_type_rssi_report_deviation, tvb, (offset + tlv_offset +1), 1, ENC_BIG_ENDIAN);\r\ndb_val = tvb_get_guint8(tvb, offset + tlv_offset + 1) - 123;\r\nif (db_val > -40)\r\ndb_val = -40;\r\nproto_item_append_text(ti, " (%d dBm)", db_val);\r\nbreak;\r\ndefault:\r\nadd_tlv_subtree(&tlv_info, tlv_tree, hf_rep_unknown_type, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_NA);\r\nbreak;\r\n}\r\ntlv_offset += length;\r\n}\r\nbreak;\r\ncase REP_RSP_CHANNEL_TYPE:\r\ntlv_item = add_tlv_subtree(&tlv_info, rep_tree, hf_rep_rsp_channel_type_report, tvb, offset-tlv_value_offset, ENC_NA);\r\ntlv_tree = proto_item_add_subtree(tlv_item, ett_mac_mgmt_msg_rep_rsp_decoder);\r\nfor( tlv_offset = 0; tlv_offset < tlv_len; )\r\n{\r\ninit_tlv_info(&tlv_info, tvb, (offset + tlv_offset));\r\ntlv_type = get_tlv_type(&tlv_info);\r\nlength = get_tlv_length(&tlv_info);\r\nif(tlv_type == -1 || length > MAX_TLV_LEN || length < 1)\r\n{\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, NULL, "REP-RSP channel subtype TLV error");\r\nproto_tree_add_item(tlv_tree, hf_rep_invalid_tlv, tvb, offset, (tlv_len - offset - tlv_offset), ENC_NA);\r\nbreak;\r\n}\r\nswitch (tlv_type)\r\n{\r\ncase REP_RSP_CHANNEL_TYPE_SUBCHANNEL:\r\nadd_tlv_subtree(&tlv_info, tlv_tree, hf_rep_rsp_channel_type_subchannel, tvb, (offset + tlv_offset), ENC_BIG_ENDIAN);\r\nbreak;\r\ncase REP_RSP_CHANNEL_TYPE_BAND_AMC:\r\nadd_tlv_subtree(&tlv_info, tlv_tree, hf_rep_rsp_channel_type_band_amc, tvb, (offset + tlv_offset), ENC_BIG_ENDIAN);\r\nbreak;\r\ncase REP_RSP_CHANNEL_TYPE_SAFETY_CHANNEL:\r\nadd_tlv_subtree(&tlv_info, tlv_tree, hf_rep_rsp_channel_type_safety_channel, tvb, (offset + tlv_offset), ENC_NA);\r\nbreak;\r\ncase REP_RSP_CHANNEL_TYPE_ENHANCED_BAND_AMC:\r\nadd_tlv_subtree(&tlv_info, tlv_tree, hf_rep_rsp_channel_type_enhanced_band_amc, tvb, (offset + tlv_offset), ENC_NA);\r\nbreak;\r\ncase REP_RSP_CHANNEL_TYPE_SOUNDING:\r\nadd_tlv_subtree(&tlv_info, tlv_tree, hf_rep_rsp_channel_type_sounding, tvb, (offset + tlv_offset), ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nadd_tlv_subtree(&tlv_info, tlv_tree, hf_rep_unknown_type, tvb, (offset + tlv_offset), ENC_NA);\r\nbreak;\r\n}\r\ntlv_offset += (length + get_tlv_value_offset(&tlv_info));\r\n}\r\nbreak;\r\ncase REP_RSP_ZONE_SPECIFIC_PHY_CINR:\r\ntlv_item = add_tlv_subtree(&tlv_info, rep_tree, hf_rep_rsp_zone_spec_phy_cinr_report, tvb, offset-tlv_value_offset, ENC_NA);\r\ntlv_tree = proto_item_add_subtree(tlv_item, ett_mac_mgmt_msg_rep_rsp_decoder);\r\nfor( tlv_offset = 0; tlv_offset < tlv_len; )\r\n{\r\ninit_tlv_info(&tlv_info, tvb, (offset + tlv_offset));\r\ntlv_type = get_tlv_type(&tlv_info);\r\nlength = get_tlv_length(&tlv_info);\r\nif(tlv_type == -1 || length > MAX_TLV_LEN || length < 1)\r\n{\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, NULL, "REP-RSP zone-specific phy CINR report subtype TLV error");\r\nproto_tree_add_item(tlv_tree, hf_rep_invalid_tlv, tvb, offset, (tlv_len - offset - tlv_offset), ENC_NA);\r\nbreak;\r\n}\r\ntlv_offset += get_tlv_value_offset(&tlv_info);\r\nswitch (tlv_type)\r\n{\r\ncase REP_RSP_ZONE_SPECIFIC_PHY_CINR_PUSC_SC0:\r\nti_item = add_tlv_subtree(&tlv_info, tlv_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_pusc_sc0, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_NA);\r\nti_tree = proto_item_add_subtree(ti_item, ett_mac_mgmt_msg_rep_rsp_decoder);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_mean, tvb, (offset + tlv_offset), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_report_type, tvb, (offset + tlv_offset), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_reserved1, tvb, (offset + tlv_offset), 1, ENC_BIG_ENDIAN);\r\nif (length == 2)\r\n{\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_deviation, tvb, (offset + tlv_offset + 1), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_reserved2, tvb, (offset + tlv_offset + 1), 1, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase REP_RSP_ZONE_SPECIFIC_PHY_CINR_PUSC_SC1:\r\nti_item = add_tlv_subtree(&tlv_info, tlv_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_pusc_sc1, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_NA);\r\nti_tree = proto_item_add_subtree(ti_item, ett_mac_mgmt_msg_rep_rsp_decoder);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_mean, tvb, (offset + tlv_offset), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_report_type, tvb, (offset + tlv_offset), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_reserved1, tvb, (offset + tlv_offset), 1, ENC_BIG_ENDIAN);\r\nif (length == 2)\r\n{\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_deviation, tvb, (offset + tlv_offset + 1), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_reserved2, tvb, (offset + tlv_offset + 1), 1, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase REP_RSP_ZONE_SPECIFIC_PHY_CINR_FUSC:\r\nti_item = add_tlv_subtree(&tlv_info, tlv_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_fusc, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_NA);\r\nti_tree = proto_item_add_subtree(ti_item, ett_mac_mgmt_msg_rep_rsp_decoder);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_mean, tvb, (offset + tlv_offset), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_report_type, tvb, (offset + tlv_offset), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_reserved1, tvb, (offset + tlv_offset), 1, ENC_BIG_ENDIAN);\r\nif (length == 2)\r\n{\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_deviation, tvb, (offset + tlv_offset + 1), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_reserved2, tvb, (offset + tlv_offset + 1), 1, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase REP_RSP_ZONE_SPECIFIC_PHY_CINR_OPTIONAL_FUSC:\r\nti_item = add_tlv_subtree(&tlv_info, tlv_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_optional_fusc, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_NA);\r\nti_tree = proto_item_add_subtree(ti_item, ett_mac_mgmt_msg_rep_rsp_decoder);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_mean, tvb, (offset + tlv_offset), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_report_type, tvb, (offset + tlv_offset), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_reserved1, tvb, (offset + tlv_offset), 1, ENC_BIG_ENDIAN);\r\nif (length == 2)\r\n{\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_deviation, tvb, (offset + tlv_offset + 1), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_reserved2, tvb, (offset + tlv_offset + 1), 1, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ncase REP_RSP_ZONE_SPECIFIC_PHY_CINR_SAFETY_CHANNEL:\r\nadd_tlv_subtree(&tlv_info, tlv_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_safety_channel, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_NA);\r\nbreak;\r\ncase REP_RSP_ZONE_SPECIFIC_PHY_CINR_AMC:\r\nti_item = add_tlv_subtree(&tlv_info, tlv_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_amc, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_NA);\r\nti_tree = proto_item_add_subtree(ti_item, ett_mac_mgmt_msg_rep_rsp_decoder);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_mean, tvb, (offset + tlv_offset), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_report_type, tvb, (offset + tlv_offset), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_reserved1, tvb, (offset + tlv_offset), 1, ENC_BIG_ENDIAN);\r\nif (length == 2)\r\n{\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_deviation, tvb, (offset + tlv_offset + 1), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_reserved2, tvb, (offset + tlv_offset + 1), 1, ENC_BIG_ENDIAN);\r\n}\r\nbreak;\r\ndefault:\r\nadd_tlv_subtree(&tlv_info, tlv_tree, hf_rep_unknown_type, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_NA);\r\nbreak;\r\n}\r\ntlv_offset += length;\r\n}\r\nbreak;\r\ncase REP_RSP_PREAMBLE_PHY_CINR:\r\ntlv_item = add_tlv_subtree(&tlv_info, rep_tree, hf_rep_rsp_preamble_phy_cinr_report, tvb, offset-tlv_value_offset, ENC_NA);\r\ntlv_tree = proto_item_add_subtree(tlv_item, ett_mac_mgmt_msg_rep_rsp_decoder);\r\nfor( tlv_offset = 0; tlv_offset < tlv_len; )\r\n{\r\ninit_tlv_info(&tlv_info, tvb, (offset + tlv_offset));\r\ntlv_type = get_tlv_type(&tlv_info);\r\nlength = get_tlv_length(&tlv_info);\r\nif(tlv_type == -1 || length > MAX_TLV_LEN || length < 1)\r\n{\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, NULL, "REP-RSP preamble physical CINR report subtype TLV error");\r\nproto_tree_add_item(tlv_tree, hf_rep_invalid_tlv, tvb, offset, (tlv_len - offset - tlv_offset), ENC_NA);\r\nbreak;\r\n}\r\nswitch (tlv_type)\r\n{\r\ncase REP_RSP_PREAMBLE_PHY_CINR_CONFIGURATION1:\r\nti_item = add_tlv_subtree(&tlv_info, tlv_tree, hf_rep_rsp_preamble_phy_cinr_rep_configuration_1, tvb, (offset + tlv_offset), ENC_NA);\r\nti_tree = proto_item_add_subtree(ti_item, ett_mac_mgmt_msg_rep_rsp_decoder);\r\nif (length == 2)\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_deviation, tvb, (offset + tlv_offset + 1)+get_tlv_value_offset(&tlv_info), 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase REP_RSP_PREAMBLE_PHY_CINR_CONFIGURATION3:\r\nti_item = add_tlv_subtree(&tlv_info, tlv_tree, hf_rep_rsp_preamble_phy_cinr_rep_configuration_3, tvb, (offset + tlv_offset), ENC_NA);\r\nti_tree = proto_item_add_subtree(ti_item, ett_mac_mgmt_msg_rep_rsp_decoder);\r\nif (length == 2)\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_phy_cinr_rep_deviation, tvb, (offset + tlv_offset + 1)+get_tlv_value_offset(&tlv_info), 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase REP_RSP_PREAMBLE_PHY_CINR_BAND_AMC:\r\nadd_tlv_subtree(&tlv_info, tlv_tree, hf_rep_rsp_preamble_phy_cinr_rep_band_amc_zone, tvb, (offset + tlv_offset), ENC_NA);\r\nbreak;\r\ndefault:\r\nadd_tlv_subtree(&tlv_info, tlv_tree, hf_rep_unknown_type, tvb, (offset + tlv_offset), ENC_NA);\r\nbreak;\r\n}\r\ntlv_offset += (length+get_tlv_value_offset(&tlv_info));\r\n}\r\nbreak;\r\ncase REP_RSP_ZONE_SPECIFIC_EFFECTIVE_CINR:\r\ntlv_item = add_tlv_subtree(&tlv_info, rep_tree, hf_rep_rsp_zone_spec_effective_cinr_report, tvb, offset-tlv_value_offset, ENC_NA);\r\ntlv_tree = proto_item_add_subtree(tlv_item, ett_mac_mgmt_msg_rep_rsp_decoder);\r\nfor( tlv_offset = 0; tlv_offset < tlv_len; )\r\n{\r\ninit_tlv_info(&tlv_info, tvb, (offset + tlv_offset));\r\ntlv_type = get_tlv_type(&tlv_info);\r\nlength = get_tlv_length(&tlv_info);\r\nif(tlv_type == -1 || length > MAX_TLV_LEN || length < 1)\r\n{\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, NULL, "REP-RSP zone-specific effective CINR report subtype TLV error");\r\nproto_tree_add_item(tlv_tree, hf_rep_invalid_tlv, tvb, offset, (tlv_len - offset - tlv_offset), ENC_NA);\r\nbreak;\r\n}\r\ntlv_offset += get_tlv_value_offset(&tlv_info);\r\nswitch (tlv_type)\r\n{\r\ncase REP_RSP_ZONE_SPECIFIC_EFFECTIVE_CINR_PUSC_SC0:\r\nti_item = add_tlv_subtree(&tlv_info, tlv_tree, hf_rep_rsp_zone_spec_effective_cinr_rep_pusc_sc0, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_NA);\r\nti_tree = proto_item_add_subtree(ti_item, ett_mac_mgmt_msg_rep_rsp_decoder);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_effective_cinr_rep_effective_cinr, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_effective_cinr_rep_report_type, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_effective_cinr_rep_cqich_id, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase REP_RSP_ZONE_SPECIFIC_EFFECTIVE_CINR_PUSC_SC1:\r\nti_item = add_tlv_subtree(&tlv_info, tlv_tree, hf_rep_rsp_zone_spec_effective_cinr_rep_pusc_sc1, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_NA);\r\nti_tree = proto_item_add_subtree(ti_item, ett_mac_mgmt_msg_rep_rsp_decoder);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_effective_cinr_rep_effective_cinr, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_effective_cinr_rep_report_type, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_effective_cinr_rep_cqich_id, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase REP_RSP_ZONE_SPECIFIC_EFFECTIVE_CINR_FUSC:\r\nti_item = add_tlv_subtree(&tlv_info, tlv_tree, hf_rep_rsp_zone_spec_effective_cinr_rep_fusc, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_NA);\r\nti_tree = proto_item_add_subtree(ti_item, ett_mac_mgmt_msg_rep_rsp_decoder);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_effective_cinr_rep_effective_cinr, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_effective_cinr_rep_report_type, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_effective_cinr_rep_cqich_id, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase REP_RSP_ZONE_SPECIFIC_EFFECTIVE_CINR_OPTIONAL_FUSC:\r\nti_item = add_tlv_subtree(&tlv_info, tlv_tree, hf_rep_rsp_zone_spec_effective_cinr_rep_optional_fusc, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_NA);\r\nti_tree = proto_item_add_subtree(ti_item, ett_mac_mgmt_msg_rep_rsp_decoder);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_effective_cinr_rep_effective_cinr, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_effective_cinr_rep_report_type, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_effective_cinr_rep_cqich_id, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase REP_RSP_ZONE_SPECIFIC_EFFECTIVE_CINR_AMC_AAS:\r\nti_item = add_tlv_subtree(&tlv_info, tlv_tree, hf_rep_rsp_zone_spec_effective_cinr_rep_amc_aas, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_NA);\r\nti_tree = proto_item_add_subtree(ti_item, ett_mac_mgmt_msg_rep_rsp_decoder);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_effective_cinr_rep_effective_cinr, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_effective_cinr_rep_report_type, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_effective_cinr_rep_cqich_id, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nadd_tlv_subtree(&tlv_info, tlv_tree, hf_rep_unknown_type, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_NA);\r\nbreak;\r\n}\r\ntlv_offset += length;\r\n}\r\nbreak;\r\ncase REP_RSP_PREAMBLE_EFFECTIVE_CINR:\r\ntlv_item = add_tlv_subtree(&tlv_info, rep_tree, hf_rep_rsp_preamble_effective_cinr_report, tvb, offset-tlv_value_offset, ENC_NA);\r\ntlv_tree = proto_item_add_subtree(tlv_item, ett_mac_mgmt_msg_rep_rsp_decoder);\r\nfor( tlv_offset = 0; tlv_offset < tlv_len; )\r\n{\r\ninit_tlv_info(&tlv_info, tvb, (offset + tlv_offset));\r\ntlv_type = get_tlv_type(&tlv_info);\r\nlength = get_tlv_length(&tlv_info);\r\nif(tlv_type == -1 || length > MAX_TLV_LEN || length < 1)\r\n{\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, NULL, "REP-RSP preamble effective CINR report subtype TLV error");\r\nproto_tree_add_item(tlv_tree, hf_rep_invalid_tlv, tvb, offset, (tlv_len - offset - tlv_offset), ENC_NA);\r\nbreak;\r\n}\r\ntlv_offset += get_tlv_value_offset(&tlv_info);\r\nswitch (tlv_type)\r\n{\r\ncase REP_RSP_PREAMBLE_EFFECTIVE_CINR_CONFIGURATION1:\r\nti_item = add_tlv_subtree(&tlv_info, tlv_tree, hf_rep_rsp_preamble_effective_cinr_rep_configuration_1, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_NA);\r\nti_tree = proto_item_add_subtree(ti_item, ett_mac_mgmt_msg_rep_rsp_decoder);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_effective_cinr_rep_effective_cinr, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_preamble_effective_cinr_rep_cqich_id, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase REP_RSP_PREAMBLE_EFFECTIVE_CINR_CONFIGURATION3:\r\nti_item = add_tlv_subtree(&tlv_info, tlv_tree, hf_rep_rsp_preamble_effective_cinr_rep_configuration_3, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_NA);\r\nti_tree = proto_item_add_subtree(ti_item, ett_mac_mgmt_msg_rep_rsp_decoder);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_zone_spec_effective_cinr_rep_effective_cinr, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_preamble_effective_cinr_rep_cqich_id, tvb, (offset + tlv_offset), length, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase REP_RSP_CHANNEL_SELECTIVITY:\r\nti_item = add_tlv_subtree(&tlv_info, rep_tree, hf_rep_rsp_channel_selectivity_report, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_NA);\r\nti_tree = proto_item_add_subtree(ti_item, ett_mac_mgmt_msg_rep_rsp_decoder);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_channel_selectivity_rep_frequency_a, tvb, (offset + tlv_offset + 2), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_channel_selectivity_rep_frequency_b, tvb, (offset + tlv_offset + 1), 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ti_tree, hf_rep_rsp_channel_selectivity_rep_frequency_c, tvb, (offset + tlv_offset), 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nadd_tlv_subtree(&tlv_info, tlv_tree, hf_rep_unknown_type, tvb, (offset + tlv_offset)-get_tlv_value_offset(&tlv_info), ENC_NA);\r\nbreak;\r\n}\r\ntlv_offset += length;\r\n}\r\nbreak;\r\ncase CURRENT_TX_POWER:\r\ntlv_item = add_tlv_subtree(&tlv_info, rep_tree, hf_rep_rsp_current_transmitted_power, tvb, offset-tlv_value_offset, ENC_BIG_ENDIAN);\r\nvalue = tvb_get_guint8(tvb, offset);\r\ncurrent_power = ((gfloat)value - 128) / 2;\r\nproto_item_append_text(tlv_item, " (%.1f dBm)", current_power);\r\nbreak;\r\ndefault:\r\nadd_tlv_subtree(&tlv_info, rep_tree, hf_rep_unknown_type, tvb, offset-tlv_value_offset, ENC_NA);\r\nbreak;\r\n}\r\noffset += tlv_len;\r\n}\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid proto_register_mac_mgmt_msg_rep(void)\r\n{\r\nstatic hf_register_info hf_rep[] =\r\n{\r\n{\r\n&hf_rep_invalid_tlv,\r\n{\r\n"Invalid TLV", "wmx.rep.invalid_tlv",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_channel_number,\r\n{\r\n"Channel Number", "wmx.rep_req.channel_number",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_channel_selectivity_report,\r\n{\r\n"Channel Selectivity Report", "wmx.rep_req.channel_selectivity_report",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_channel_selectivity_rep_bit0,\r\n{\r\n"Include Frequency Selectivity Report", "wmx.rep_req.channel_selectivity_report.bit0",\r\nFT_BOOLEAN, 8, NULL, REP_REQ_CHANNEL_SELECTIVITY_REPORT_BIT0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_channel_selectivity_rep_bit1_7,\r\n{\r\n"Reserved", "wmx.rep_req.channel_selectivity_report.bit1_7",\r\nFT_UINT8, BASE_HEX, NULL, REP_REQ_CHANNEL_SELECTIVITY_REPORT_BIT1_7, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_channel_type,\r\n{\r\n"Channel Type", "wmx.rep_req.channel_type",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_channel_type_request,\r\n{\r\n"Channel Type Request", "wmx.rep_req.channel_type.request",\r\nFT_UINT8, BASE_DEC, VALS(vals_channel_types), 0x03, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_channel_type_reserved,\r\n{\r\n"Reserved", "wmx.rep_req.channel_type.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0xFC, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_preamble_effective_cinr_request,\r\n{\r\n"Preamble Effective CINR Request", "wmx.rep_req.preamble_effective_cinr_request",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_preamble_effective_cinr_req_bit0_1,\r\n{\r\n"Type Of Preamble Physical CINR Measurement", "wmx.rep_req.preamble_effective_cinr_request.bit0_1",\r\nFT_UINT8, BASE_DEC, VALS(vals_type_of_measurements), REP_REQ_PREAMBLE_EFFECTIVE_CINR_REQUEST_BIT0_1, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_preamble_effective_cinr_req_bit2_7,\r\n{\r\n"Reserved", "wmx.rep_req.preamble_effective_cinr_request.bit2_7",\r\nFT_UINT8, BASE_HEX, NULL, REP_REQ_PREAMBLE_EFFECTIVE_CINR_REQUEST_BIT2_7, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_preamble_phy_cinr_request,\r\n{\r\n"Preamble Physical CINR Request", "wmx.rep_req.preamble_phy_cinr_request",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_preamble_phy_cinr_req_bit0_1,\r\n{\r\n"Type Of Preamble Physical CINR Measurement", "wmx.rep_req.preamble_phy_cinr_request.bit0_1",\r\nFT_UINT8, BASE_DEC, VALS(vals_type_of_measurements), REP_REQ_PREAMBLE_PHY_CINR_REQUEST_BIT0_1, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_preamble_phy_cinr_req_bit2_5,\r\n{\r\n"Alpha (ave) in multiples of 1/16", "wmx.rep_req.preamble_phy_cinr_request.bit2_5",\r\nFT_UINT8, BASE_DEC, NULL, REP_REQ_PREAMBLE_PHY_CINR_REQUEST_BIT2_5, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_preamble_phy_cinr_req_bit6,\r\n{\r\n"CINR Report Type", "wmx.rep_req.preamble_phy_cinr_request.bit6",\r\nFT_UINT8, BASE_DEC, VALS(vals_cinr_report_types), REP_REQ_PREAMBLE_PHY_CINR_REQUEST_BIT6, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_preamble_phy_cinr_req_bit7,\r\n{\r\n"Reserved", "wmx.rep_req.preamble_phy_cinr_request.bit7",\r\nFT_UINT8, BASE_HEX, NULL, REP_REQ_PREAMBLE_PHY_CINR_REQUEST_BIT7, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_report_request,\r\n{\r\n"Report Request", "wmx.rep_req.report_request",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_report_type,\r\n{\r\n"Report Type", "wmx.rep_req.report_type",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_rep_type_bit0,\r\n{\r\n"Include DFS Basic Report", "wmx.rep_req.report_type.bit0",\r\nFT_BOOLEAN, 8, NULL, REP_REQ_REPORT_TYPE_BIT0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_rep_type_bit1,\r\n{\r\n"Include CINR Report", "wmx.rep_req.report_type.bit1",\r\nFT_BOOLEAN, 8, NULL, REP_REQ_REPORT_TYPE_BIT1, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_rep_type_bit2,\r\n{\r\n"Include RSSI Report", "wmx.rep_req.report_type.bit2",\r\nFT_BOOLEAN, 8, NULL, REP_REQ_REPORT_TYPE_BIT2, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_rep_type_bit3_6,\r\n{\r\n"Alpha (ave) in multiples of 1/32", "wmx.rep_req.report_type.bit3_6",\r\nFT_UINT8, BASE_DEC, NULL, REP_REQ_REPORT_TYPE_BIT3_6, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_rep_type_bit7,\r\n{\r\n"Include Current Transmit Power Report", "wmx.rep_req.report_type.bit7",\r\nFT_BOOLEAN, 8, NULL, REP_REQ_REPORT_TYPE_BIT7, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_preamble_effective_cinr_rep_cqich_id,\r\n{\r\n"The 4 least significant bits of CQICH_ID", "wmx.rep_req.zone_spec_effective_cinr_report.cqich_id_4",\r\nFT_UINT8, BASE_HEX, NULL, REP_RSP_ZONE_SPEC_EFFECTIVE_CINR_CQICH_ID_4_MASK, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_zone_spec_effective_cinr_rep_cqich_id,\r\n{\r\n"The 3 least significant bits of CQICH_ID", "wmx.rep_req.zone_spec_effective_cinr_report.cqich_id",\r\nFT_UINT8, BASE_HEX, NULL, REP_RSP_ZONE_SPEC_EFFECTIVE_CINR_CQICH_ID_MASK, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_zone_spec_effective_cinr_rep_effective_cinr,\r\n{\r\n"Effective CINR", "wmx.rep_req.zone_spec_effective_cinr_report.effective_cinr",\r\nFT_UINT8, BASE_DEC, NULL, REP_RSP_ZONE_SPEC_EFFECTIVE_CINR_EFFECTIVE_CINR_MASK, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_zone_spec_effective_cinr_rep_report_type,\r\n{\r\n"Effective CINR Report", "wmx.rep_req.zone_spec_effective_cinr_report.report_type",\r\nFT_UINT8, BASE_DEC, VALS(vals_data_cinr_measurements), REP_RSP_ZONE_SPEC_EFFECTIVE_CINR_REPORT_TYPE_MASK, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_zone_spec_effective_cinr_request,\r\n{\r\n"Zone-specific Effective CINR Request", "wmx.rep_req.zone_spec_effective_cinr_request",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_zone_spec_effective_cinr_req_bit0_2,\r\n{\r\n"Type Of Zone On Which CINR Is To Be Reported", "wmx.rep_req.zone_spec_effective_cinr_request.bit0_2",\r\nFT_UINT16, BASE_HEX, VALS(vals_type_of_zones), REP_REQ_TYPE_OF_ZONE_REQUEST_16_BIT0_2, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_zone_spec_effective_cinr_req_bit3,\r\n{\r\n"STC Zone", "wmx.rep_req.zone_spec_effective_cinr_request.bit3",\r\nFT_BOOLEAN, 16, NULL, REP_REQ_TYPE_OF_ZONE_REQUEST_16_BIT3, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_zone_spec_effective_cinr_req_bit4,\r\n{\r\n"AAS Zone", "wmx.rep_req.zone_spec_effective_cinr_request.bit4",\r\nFT_BOOLEAN, 16, NULL, REP_REQ_TYPE_OF_ZONE_REQUEST_16_BIT4, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_zone_spec_effective_cinr_req_bit5_6,\r\n{\r\n"PRBS ID", "wmx.rep_req.zone_spec_effective_cinr_request.bit5_6",\r\nFT_UINT16, BASE_HEX, NULL, REP_REQ_TYPE_OF_ZONE_REQUEST_16_BIT5_6, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_zone_spec_effective_cinr_req_bit7,\r\n{\r\n"CINR Measurement Report", "wmx.rep_req.zone_spec_effective_cinr_request.bit7",\r\nFT_UINT16, BASE_HEX, VALS(vals_data_cinr_measurements), REP_REQ_TYPE_OF_ZONE_REQUEST_16_BIT7, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_zone_spec_effective_cinr_req_bit8_13,\r\n{\r\n"PUSC Major Group Map", "wmx.rep_req.zone_spec_effective_cinr_request.bit8_13",\r\nFT_UINT16, BASE_HEX, NULL, REP_REQ_TYPE_OF_ZONE_REQUEST_16_BIT8_13, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_zone_spec_effective_cinr_req_bit14_15,\r\n{\r\n"Reserved", "wmx.rep_req.zone_spec_effective_cinr_request.bit14_15",\r\nFT_UINT16, BASE_HEX, NULL, REP_REQ_TYPE_OF_ZONE_REQUEST_16_BIT14_15, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_zone_spec_phy_cinr_rep_deviation,\r\n{\r\n"Standard Deviation of CINR", "wmx.rep_req.zone_spec_phy_cinr_report.deviation",\r\nFT_UINT8, BASE_DEC, NULL, REP_RSP_ZONE_SPEC_PHY_CINR_DEVIATION_MASK, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_zone_spec_phy_cinr_rep_mean,\r\n{\r\n"Mean of Physical CINR", "wmx.rep_req.zone_spec_phy_cinr_report.mean",\r\nFT_UINT8, BASE_DEC, NULL, REP_RSP_ZONE_SPEC_PHY_CINR_MEAN_MASK, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_zone_spec_phy_cinr_rep_report_type,\r\n{\r\n"CINR Report Type", "wmx.rep_req.zone_spec_phy_cinr_report.report_type",\r\nFT_UINT8, BASE_DEC, VALS(vals_data_cinr_measurements), REP_RSP_ZONE_SPEC_PHY_CINR_REP_TYPE_MASK, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_zone_spec_phy_cinr_rep_reserved1,\r\n{\r\n"Reserved", "wmx.rep_req.zone_spec_phy_cinr_report.reserved1",\r\nFT_UINT8, BASE_HEX, NULL, REP_RSP_ZONE_SPEC_PHY_CINR_RSV1_MASK, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_zone_spec_phy_cinr_rep_reserved2,\r\n{\r\n"Reserved", "wmx.rep_req.zone_spec_phy_cinr_report.reserved2",\r\nFT_UINT8, BASE_HEX, NULL, REP_RSP_ZONE_SPEC_PHY_CINR_RSV2_MASK, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_zone_spec_phy_cinr_request,\r\n{\r\n"Zone-specific Physical CINR Request", "wmx.rep_req.zone_spec_phy_cinr_request",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_zone_spec_phy_cinr_req_bit0_2,\r\n{\r\n"Type Of Zone On Which CINR Is To Be Reported", "wmx.rep_req.zone_spec_phy_cinr_request.bit0_2",\r\nFT_UINT24, BASE_HEX, VALS(vals_type_of_zones), REP_REQ_TYPE_OF_ZONE_REQUEST_BIT0_2, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_zone_spec_phy_cinr_req_bit3,\r\n{\r\n"STC Zone", "wmx.rep_req.zone_spec_phy_cinr_request.bit3",\r\nFT_BOOLEAN, 24, NULL, REP_REQ_TYPE_OF_ZONE_REQUEST_BIT3, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_zone_spec_phy_cinr_req_bit4,\r\n{\r\n"AAS Zone", "wmx.rep_req.zone_spec_phy_cinr_request.bit4",\r\nFT_BOOLEAN, 24, NULL, REP_REQ_TYPE_OF_ZONE_REQUEST_BIT4, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_zone_spec_phy_cinr_req_bit5_6,\r\n{\r\n"PRBS ID", "wmx.rep_req.zone_spec_phy_cinr_request.bit5_6",\r\nFT_UINT24, BASE_HEX, NULL, REP_REQ_TYPE_OF_ZONE_REQUEST_BIT5_6, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_zone_spec_phy_cinr_req_bit7,\r\n{\r\n"CINR Measurement Report", "wmx.rep_req.zone_spec_phy_cinr_request.bit7",\r\nFT_UINT24, BASE_HEX, VALS(vals_data_cinr_measurements), REP_REQ_TYPE_OF_ZONE_REQUEST_BIT7, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_zone_spec_phy_cinr_req_bit8_13,\r\n{\r\n"PUSC Major Group Map", "wmx.rep_req.zone_spec_phy_cinr_request.bit8_13",\r\nFT_UINT24, BASE_HEX, NULL, REP_REQ_TYPE_OF_ZONE_REQUEST_BIT8_13, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_zone_spec_phy_cinr_req_bit14_17,\r\n{\r\n"Alpha (ave) in multiples of 1/16", "wmx.rep_req.zone_spec_phy_cinr_request.bit14_17",\r\nFT_UINT24, BASE_DEC, NULL, REP_REQ_TYPE_OF_ZONE_REQUEST_BIT14_17, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_zone_spec_phy_cinr_req_bit18,\r\n{\r\n"CINR Report Type", "wmx.rep_req.zone_spec_phy_cinr_request.bit18",\r\nFT_UINT24, BASE_HEX, VALS(vals_cinr_report_types), REP_REQ_TYPE_OF_ZONE_REQUEST_BIT18, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_req_zone_spec_phy_cinr_req_bit19_23,\r\n{\r\n"Reserved", "wmx.rep_req.zone_spec_phy_cinr_request.bit19_23",\r\nFT_UINT24, BASE_HEX, NULL, REP_REQ_TYPE_OF_ZONE_REQUEST_BIT19_23, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_channel_selectivity_report,\r\n{\r\n"Channel Selectivity Report", "wmx.rep_rsp.channel_selectivity_report",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_channel_selectivity_rep_frequency_a,\r\n{\r\n"Frequency Selectivity Report a", "wmx.rep_rsp.channel_selectivity_report.frequency_a",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_channel_selectivity_rep_frequency_b,\r\n{\r\n"Frequency Selectivity Report b", "wmx.rep_rsp.channel_selectivity_report.frequency_b",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_channel_selectivity_rep_frequency_c,\r\n{\r\n"Frequency Selectivity Report c", "wmx.rep_rsp.channel_selectivity_report.frequency_c",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_channel_type_report,\r\n{\r\n"Channel Type Report", "wmx.rep_rsp.channel_type_report",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_channel_type_band_amc,\r\n{\r\n"Band AMC", "wmx.rep_rsp.channel_type_report.band_amc",\r\nFT_UINT32, BASE_HEX, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_channel_type_enhanced_band_amc,\r\n{\r\n"Enhanced Band AMC", "wmx.rep_rsp.channel_type_report.enhanced_band_amc",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_channel_type_safety_channel,\r\n{\r\n"Safety Channel", "wmx.rep_rsp.channel_type_report.safety_channel",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_channel_type_sounding,\r\n{\r\n"Sounding", "wmx.rep_rsp.channel_type_report.sounding",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_channel_type_subchannel,\r\n{\r\n"Normal Subchannel", "wmx.rep_rsp.channel_type_report.subchannel",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_preamble_effective_cinr_report,\r\n{\r\n"Preamble Effective CINR Report", "wmx.rep_rsp.preamble_effective_cinr_report",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_preamble_effective_cinr_rep_configuration_1,\r\n{\r\n"The Estimation Of Effective CINR Measured From Preamble For Frequency Reuse Configuration=1", "wmx.rep_rsp.preamble_effective_cinr_report.configuration_1",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_preamble_effective_cinr_rep_configuration_3,\r\n{\r\n"The Estimation Of Effective CINR Measured From Preamble For Frequency Reuse Configuration=3", "wmx.rep_rsp.preamble_effective_cinr_report.configuration_3",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_preamble_phy_cinr_report,\r\n{\r\n"Preamble Physical CINR Report", "wmx.rep_rsp.preamble_phy_cinr_report",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_preamble_phy_cinr_rep_band_amc_zone,\r\n{\r\n"The Estimation Of Physical CINR Measured From Preamble For Band AMC Zone", "wmx.rep_rsp.preamble_phy_cinr_report.band_amc_zone",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_preamble_phy_cinr_rep_configuration_1,\r\n{\r\n"The Estimation Of Physical CINR Measured From Preamble For Frequency Reuse Configuration=1", "wmx.rep_rsp.preamble_phy_cinr_report.configuration_1",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_preamble_phy_cinr_rep_configuration_3,\r\n{\r\n"The Estimation Of Physical CINR Measured From Preamble For Frequency Reuse Configuration=3", "wmx.rep_rsp.preamble_phy_cinr_report.configuration_3",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_report_type,\r\n{\r\n"Report Type", "wmx.rep_rsp.report_type",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_report_type_basic_report,\r\n{\r\n"Basic Report", "wmx.rep_rsp.report_type.basic_report",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_report_type_basic_report_bit0,\r\n{\r\n"Wireless HUMAN Detected", "wmx.rep_rsp.report_type.basic_report.bit0",\r\nFT_BOOLEAN, 8, NULL, REP_RSP_REPORT_TYPE_BASIC_REPORT_BIT0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_report_type_basic_report_bit1,\r\n{\r\n"Unknown Transmission Detected", "wmx.rep_rsp.report_type.basic_report.bit1",\r\nFT_BOOLEAN, 8, NULL, REP_RSP_REPORT_TYPE_BASIC_REPORT_BIT1, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_report_type_basic_report_bit2,\r\n{\r\n"Specific Spectrum User Detected", "wmx.rep_rsp.report_type.basic_report.bit2",\r\nFT_BOOLEAN, 8, NULL, REP_RSP_REPORT_TYPE_BASIC_REPORT_BIT2, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_report_type_basic_report_bit3,\r\n{\r\n"Channel Not Measured", "wmx.rep_rsp.report_type.basic_report.bit3",\r\nFT_BOOLEAN, 8, NULL, REP_RSP_REPORT_TYPE_BASIC_REPORT_BIT3, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_report_type_basic_report_reserved,\r\n{\r\n"Reserved", "wmx.rep_rsp.report_type.basic_report.reserved",\r\nFT_UINT8, BASE_HEX, NULL, REP_RSP_REPORT_TYPE_BASIC_REPORT_RSV, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_report_type_channel_number,\r\n{\r\n"Channel Number", "wmx.rep_rsp.report_type.channel_number",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_report_type_cinr_report,\r\n{\r\n"CINR Report", "wmx.rep_rsp.report_type.cinr_report",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_report_type_cinr_report_deviation,\r\n{\r\n"CINR Standard Deviation", "wmx.rep_rsp.report_type.cinr_report_deviation",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_report_type_cinr_report_mean,\r\n{\r\n"CINR Mean", "wmx.rep_rsp.report_type.cinr_report_mean",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_report_type_duration,\r\n{\r\n"Duration", "wmx.rep_rsp.report_type.duration",\r\nFT_UINT24, BASE_HEX, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_report_type_frame_number,\r\n{\r\n"Start Frame", "wmx.rep_rsp.report_type.frame_number",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_report_type_rssi_report,\r\n{\r\n"RSSI Report", "wmx.rep_rsp.report_type.rssi_report",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_report_type_rssi_report_deviation,\r\n{\r\n"RSSI Standard Deviation", "wmx.rep_rsp.report_type.rssi_report_deviation",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_current_transmitted_power,\r\n{\r\n"Current Transmitted Power", "wmx.rep_rsp.current_transmitted_power",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_report_type_rssi_report_mean,\r\n{\r\n"RSSI Mean", "wmx.rep_rsp.report_type.rssi_report_mean",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_zone_spec_effective_cinr_report,\r\n{\r\n"Zone-specific Effective CINR Report", "wmx.rep_rsp.zone_spec_effective_cinr_report",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_zone_spec_effective_cinr_rep_amc_aas,\r\n{\r\n"AMC AAS Zone", "wmx.rep_rsp.zone_spec_effective_cinr_report.amc_aas",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_zone_spec_effective_cinr_rep_fusc,\r\n{\r\n"FUSC Zone", "wmx.rep_rsp.zone_spec_effective_cinr_report.fusc",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_zone_spec_effective_cinr_rep_optional_fusc,\r\n{\r\n"Optional FUSC Zone", "wmx.rep_rsp.zone_spec_effective_cinr_report.optional_fusc",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_zone_spec_effective_cinr_rep_pusc_sc0,\r\n{\r\n"PUSC Zone (use all SC=0)", "wmx.rep_rsp.zone_spec_effective_cinr_report.pusc_sc0",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_zone_spec_effective_cinr_rep_pusc_sc1,\r\n{\r\n"PUSC Zone (use all SC=1)", "wmx.rep_rsp.zone_spec_effective_cinr_report.pusc_sc1",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_zone_spec_phy_cinr_report,\r\n{\r\n"Zone-specific Physical CINR Report", "wmx.rep_rsp.zone_spec_phy_cinr_report",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_zone_spec_phy_cinr_rep_amc,\r\n{\r\n"AMC Zone", "wmx.rep_rsp.zone_spec_phy_cinr_report.amc",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_zone_spec_phy_cinr_rep_fusc,\r\n{\r\n"FUSC Zone", "wmx.rep_rsp.zone_spec_phy_cinr_report.fusc",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_zone_spec_phy_cinr_rep_optional_fusc,\r\n{\r\n"Optional FUSC Zone", "wmx.rep_rsp.zone_spec_phy_cinr_report.optional_fusc",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_zone_spec_phy_cinr_rep_pusc_sc0,\r\n{\r\n"PUSC Zone (use all SC=0)", "wmx.rep_rsp.zone_spec_phy_cinr_report.pusc_sc0",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_zone_spec_phy_cinr_rep_pusc_sc1,\r\n{\r\n"PUSC Zone (use all SC=1)", "wmx.rep_rsp.zone_spec_phy_cinr_report.pusc_sc1",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_rsp_zone_spec_phy_cinr_rep_safety_channel,\r\n{\r\n"Safety Channel", "wmx.rep_rsp.zone_spec_phy_cinr_report.safety_channel",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rep_unknown_type,\r\n{\r\n"Unknown TLV type", "wmx.rep.unknown_tlv_type",\r\nFT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL\r\n}\r\n}\r\n};\r\nstatic gint *ett_rep[] =\r\n{\r\n&ett_mac_mgmt_msg_rep_req_decoder,\r\n&ett_mac_mgmt_msg_rep_rsp_decoder,\r\n};\r\nproto_mac_mgmt_msg_rep_decoder = proto_register_protocol (\r\n"WiMax REP-REQ/RSP Messages",\r\n"WiMax REP-REQ/RSP (rep)",\r\n"wmx.rep"\r\n);\r\nproto_register_field_array(proto_mac_mgmt_msg_rep_decoder, hf_rep, array_length(hf_rep));\r\nproto_register_subtree_array(ett_rep, array_length(ett_rep));\r\n}\r\nvoid\r\nproto_reg_handoff_mac_mgmt_msg_rep(void)\r\n{\r\ndissector_handle_t rep_handle;\r\nrep_handle = create_dissector_handle(dissect_mac_mgmt_msg_rep_req_decoder, proto_mac_mgmt_msg_rep_decoder);\r\ndissector_add_uint("wmx.mgmtmsg", MAC_MGMT_MSG_REP_REQ, rep_handle);\r\nrep_handle = create_dissector_handle(dissect_mac_mgmt_msg_rep_rsp_decoder, proto_mac_mgmt_msg_rep_decoder);\r\ndissector_add_uint("wmx.mgmtmsg", MAC_MGMT_MSG_REP_RSP, rep_handle);\r\n}
