static int\r\ndissect_retix_bpdu(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nproto_tree *retix_bpdu_tree;\r\nproto_tree *ti;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "R-STP");\r\nti = proto_tree_add_item(tree, proto_retix_bpdu, tvb, 0, -1, ENC_NA);\r\nretix_bpdu_tree = proto_item_add_subtree(ti, ett_retix_bpdu);\r\nproto_tree_add_item(retix_bpdu_tree, hf_retix_bpdu_root_mac, tvb, 0, 6, ENC_NA);\r\nproto_tree_add_item(retix_bpdu_tree, hf_retix_bpdu_bridge_mac, tvb, 10, 6, ENC_NA);\r\ncol_add_fstr(pinfo->cinfo, COL_INFO, "Bridge MAC %s", tvb_ether_to_str(tvb, 10));\r\nproto_tree_add_item(retix_bpdu_tree, hf_retix_bpdu_max_age, tvb, 20, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(retix_bpdu_tree, hf_retix_bpdu_hello_time, tvb, 22, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(retix_bpdu_tree, hf_retix_bpdu_forward_delay, tvb, 24, 2, ENC_BIG_ENDIAN);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_retix_bpdu(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_retix_bpdu_root_mac,\r\n{ "Root MAC", "r-stp.root.hw", FT_ETHER, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL}},\r\n{ &hf_retix_bpdu_bridge_mac,\r\n{ "Bridge MAC", "r-stp.bridge.hw", FT_ETHER, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL}},\r\n{ &hf_retix_bpdu_max_age,\r\n{ "Max Age", "r-stp.maxage", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}},\r\n{ &hf_retix_bpdu_hello_time,\r\n{ "Hello Time", "r-stp.hello", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}},\r\n{ &hf_retix_bpdu_forward_delay,\r\n{ "Forward Delay", "r-stp.forward", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}},\r\n};\r\nstatic gint *ett[] ={\r\n&ett_retix_bpdu,\r\n};\r\nproto_retix_bpdu = proto_register_protocol("Retix Spanning Tree Protocol", "R-STP", "r-stp");\r\nproto_register_field_array(proto_retix_bpdu, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nregister_dissector("rbpdu", dissect_retix_bpdu, proto_retix_bpdu);\r\n}
