gboolean\r\nrange_check_validity(packet_range_t *range)\r\n{\r\nswitch (packet_range_check(range)) {\r\ncase CVT_NO_ERROR:\r\nreturn TRUE;\r\ncase CVT_SYNTAX_ERROR:\r\nsimple_dialog(ESD_TYPE_ERROR, ESD_BTN_OK,\r\n"The specified range of packets isn't a valid range.");\r\nreturn FALSE;\r\ncase CVT_NUMBER_TOO_BIG:\r\nsimple_dialog(ESD_TYPE_ERROR, ESD_BTN_OK,\r\n"The specified range of packets has a packet number that's too large.");\r\nreturn FALSE;\r\ndefault:\r\ng_assert_not_reached();\r\nreturn FALSE;\r\n}\r\n}\r\ngboolean\r\nrange_check_validity_modal(GtkWidget *parent, packet_range_t *range)\r\n{\r\nGtkWidget *dialog;\r\nswitch (packet_range_check(range)) {\r\ncase CVT_NO_ERROR:\r\nreturn TRUE;\r\ncase CVT_SYNTAX_ERROR:\r\ndialog = gtk_message_dialog_new(GTK_WINDOW(parent),\r\nGTK_DIALOG_DESTROY_WITH_PARENT,\r\nGTK_MESSAGE_ERROR,\r\nGTK_BUTTONS_OK,\r\n"The specified range of packets isn't a valid range.");\r\ngtk_dialog_run(GTK_DIALOG(dialog));\r\ngtk_widget_destroy(dialog);\r\nreturn FALSE;\r\ncase CVT_NUMBER_TOO_BIG:\r\ndialog = gtk_message_dialog_new(GTK_WINDOW(parent),\r\nGTK_DIALOG_DESTROY_WITH_PARENT,\r\nGTK_MESSAGE_ERROR,\r\nGTK_BUTTONS_OK,\r\n"The specified range of packets has a packet number that's too large.");\r\ngtk_dialog_run(GTK_DIALOG(dialog));\r\ngtk_widget_destroy(dialog);\r\nreturn FALSE;\r\ndefault:\r\ng_assert_not_reached();\r\nreturn FALSE;\r\n}\r\n}\r\nvoid\r\nrange_update_dynamics(gpointer data)\r\n{\r\npacket_range_t *range;\r\nGtkWidget *range_displayed_bt;\r\ngboolean filtered_active;\r\ngint selected_num;\r\ngboolean can_select;\r\ngboolean selected_packets;\r\ngchar label_text[100];\r\nguint32 ignored_cnt = 0, displayed_ignored_cnt = 0;\r\nguint32 displayed_cnt;\r\nrange = (packet_range_t *)g_object_get_data(G_OBJECT(data), RANGE_VALUES_KEY);\r\nrange_displayed_bt = (GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_DISPLAYED_BT_KEY);\r\nfiltered_active = gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON(range_displayed_bt));\r\nif (range->displayed_cnt != 0)\r\ngtk_widget_set_sensitive(range_displayed_bt, TRUE);\r\nelse {\r\nfiltered_active = FALSE;\r\ngtk_toggle_button_set_active(GTK_TOGGLE_BUTTON(g_object_get_data(G_OBJECT(data), RANGE_SELECT_ALL_KEY)), FALSE);\r\ngtk_widget_set_sensitive(range_displayed_bt, FALSE);\r\n}\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_SELECT_ALL_C_KEY), !filtered_active);\r\nif (range->remove_ignored) {\r\ng_snprintf(label_text, sizeof(label_text), "%u", cfile.count - range->ignored_cnt);\r\n} else {\r\ng_snprintf(label_text, sizeof(label_text), "%u", cfile.count);\r\n}\r\ngtk_label_set_text(GTK_LABEL(g_object_get_data(G_OBJECT(data), RANGE_SELECT_ALL_C_KEY)), label_text);\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_SELECT_ALL_D_KEY), filtered_active);\r\nif (range->include_dependents)\r\ndisplayed_cnt = range->displayed_plus_dependents_cnt;\r\nelse\r\ndisplayed_cnt = range->displayed_cnt;\r\nif (range->remove_ignored) {\r\ng_snprintf(label_text, sizeof(label_text), "%u", displayed_cnt - range->displayed_ignored_cnt);\r\n} else {\r\ng_snprintf(label_text, sizeof(label_text), "%u", displayed_cnt);\r\n}\r\ngtk_label_set_text(GTK_LABEL(g_object_get_data(G_OBJECT(data), RANGE_SELECT_ALL_D_KEY)), label_text);\r\nselected_num = (cfile.current_frame) ? cfile.current_frame->num : 0;\r\ncan_select = (selected_num != 0);\r\nif (can_select) {\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_SELECT_CURR_KEY), TRUE);\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_SELECT_CURR_C_KEY), !filtered_active);\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_SELECT_CURR_D_KEY), filtered_active);\r\n} else {\r\nif (range->process == range_process_selected) {\r\nrange->process = range_process_all;\r\ngtk_toggle_button_set_active(GTK_TOGGLE_BUTTON(g_object_get_data(G_OBJECT(data), RANGE_SELECT_ALL_KEY)), TRUE);\r\n}\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_SELECT_CURR_KEY), FALSE);\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_SELECT_CURR_C_KEY), FALSE);\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_SELECT_CURR_D_KEY), FALSE);\r\n}\r\nif (range->remove_ignored && can_select && cfile.current_frame->flags.ignored) {\r\ng_snprintf(label_text, sizeof(label_text), "0");\r\n} else {\r\ng_snprintf(label_text, sizeof(label_text), "%u", selected_num ? 1 : 0);\r\n}\r\ngtk_label_set_text(GTK_LABEL(g_object_get_data(G_OBJECT(data), RANGE_SELECT_CURR_C_KEY)), label_text);\r\nif (range->remove_ignored && can_select && cfile.current_frame->flags.ignored) {\r\ng_snprintf(label_text, sizeof(label_text), "0");\r\n} else {\r\ng_snprintf(label_text, sizeof(label_text), "%u", selected_num ? 1 : 0);\r\n}\r\ngtk_label_set_text(GTK_LABEL(g_object_get_data(G_OBJECT(data), RANGE_SELECT_CURR_D_KEY)), label_text);\r\nif (filtered_active)\r\nselected_packets = (range->displayed_marked_cnt != 0);\r\nelse\r\nselected_packets = (cfile.marked_count > 0);\r\nif (selected_packets) {\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_SELECT_MARKED_KEY), TRUE);\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_SELECT_MARKED_C_KEY), !filtered_active);\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_SELECT_MARKED_D_KEY), filtered_active);\r\n}\r\nelse {\r\nif (range->process == range_process_marked) {\r\nrange->process = range_process_all;\r\ngtk_toggle_button_set_active(GTK_TOGGLE_BUTTON(g_object_get_data(G_OBJECT(data), RANGE_SELECT_ALL_KEY)), TRUE);\r\n}\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_SELECT_MARKED_KEY), FALSE);\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_SELECT_MARKED_C_KEY), FALSE);\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_SELECT_MARKED_D_KEY), FALSE);\r\n}\r\nif (range->remove_ignored) {\r\ng_snprintf(label_text, sizeof(label_text), "%u", cfile.marked_count - range->ignored_marked_cnt);\r\n} else {\r\ng_snprintf(label_text, sizeof(label_text), "%u", cfile.marked_count);\r\n}\r\ngtk_label_set_text(GTK_LABEL(g_object_get_data(G_OBJECT(data), RANGE_SELECT_MARKED_C_KEY)), label_text);\r\nif (range->remove_ignored) {\r\ng_snprintf(label_text, sizeof(label_text), "%u", range->displayed_marked_cnt - range->displayed_ignored_marked_cnt);\r\n} else {\r\ng_snprintf(label_text, sizeof(label_text), "%u", range->displayed_marked_cnt);\r\n}\r\ngtk_label_set_text(GTK_LABEL(g_object_get_data(G_OBJECT(data), RANGE_SELECT_MARKED_D_KEY)), label_text);\r\nif (filtered_active)\r\nselected_packets = (range->displayed_mark_range_cnt != 0);\r\nelse\r\nselected_packets = (range->mark_range_cnt != 0);\r\nif (selected_packets) {\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_SELECT_MARKED_RANGE_KEY), TRUE);\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_SELECT_MARKED_RANGE_C_KEY), !filtered_active);\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_SELECT_MARKED_RANGE_D_KEY), filtered_active);\r\n}\r\nelse {\r\nif (range->process == range_process_marked_range) {\r\nrange->process = range_process_all;\r\ngtk_toggle_button_set_active(GTK_TOGGLE_BUTTON(g_object_get_data(G_OBJECT(data), RANGE_SELECT_ALL_KEY)), TRUE);\r\n}\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_SELECT_MARKED_RANGE_KEY), FALSE);\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_SELECT_MARKED_RANGE_C_KEY), FALSE);\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_SELECT_MARKED_RANGE_D_KEY), FALSE);\r\n}\r\nif (range->remove_ignored) {\r\ng_snprintf(label_text, sizeof(label_text), "%u", range->mark_range_cnt - range->ignored_mark_range_cnt);\r\n} else {\r\ng_snprintf(label_text, sizeof(label_text), "%u", range->mark_range_cnt);\r\n}\r\ngtk_label_set_text(GTK_LABEL(g_object_get_data(G_OBJECT(data), RANGE_SELECT_MARKED_RANGE_C_KEY)), label_text);\r\nif (range->remove_ignored) {\r\ng_snprintf(label_text, sizeof(label_text), "%u",\r\nrange->displayed_mark_range_cnt - range->displayed_ignored_mark_range_cnt);\r\n} else {\r\ng_snprintf(label_text, sizeof(label_text), "%u", range->displayed_mark_range_cnt);\r\n}\r\ngtk_label_set_text(GTK_LABEL(g_object_get_data(G_OBJECT(data), RANGE_SELECT_MARKED_RANGE_D_KEY)), label_text);\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_SELECT_USER_KEY), TRUE);\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_SELECT_USER_C_KEY), !filtered_active);\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_SELECT_USER_D_KEY), filtered_active);\r\nif (range->remove_ignored) {\r\ng_snprintf(label_text, sizeof(label_text), "%u", range->user_range_cnt - range->ignored_user_range_cnt);\r\n} else {\r\ng_snprintf(label_text, sizeof(label_text), "%u", range->user_range_cnt);\r\n}\r\ngtk_label_set_text(GTK_LABEL(g_object_get_data(G_OBJECT(data), RANGE_SELECT_USER_C_KEY)), label_text);\r\nif (range->remove_ignored) {\r\ng_snprintf(label_text, sizeof(label_text), "%u",\r\nrange->displayed_user_range_cnt - range->displayed_ignored_user_range_cnt);\r\n} else {\r\ng_snprintf(label_text, sizeof(label_text), "%u", range->displayed_user_range_cnt);\r\n}\r\ngtk_label_set_text(GTK_LABEL(g_object_get_data(G_OBJECT(data), RANGE_SELECT_USER_D_KEY)), label_text);\r\nswitch(range->process) {\r\ncase(range_process_all):\r\nignored_cnt = range->ignored_cnt;\r\ndisplayed_ignored_cnt = range->displayed_ignored_cnt;\r\nbreak;\r\ncase(range_process_selected):\r\nignored_cnt = (can_select && cfile.current_frame->flags.ignored) ? 1 : 0;\r\ndisplayed_ignored_cnt = ignored_cnt;\r\nbreak;\r\ncase(range_process_marked):\r\nignored_cnt = range->ignored_marked_cnt;\r\ndisplayed_ignored_cnt = range->displayed_ignored_marked_cnt;\r\nbreak;\r\ncase(range_process_marked_range):\r\nignored_cnt = range->ignored_mark_range_cnt;\r\ndisplayed_ignored_cnt = range->displayed_ignored_mark_range_cnt;\r\nbreak;\r\ncase(range_process_user_range):\r\nignored_cnt = range->ignored_user_range_cnt;\r\ndisplayed_ignored_cnt = range->displayed_ignored_user_range_cnt;\r\nbreak;\r\ndefault:\r\ng_assert_not_reached();\r\n}\r\nif (filtered_active)\r\nselected_packets = (displayed_ignored_cnt != 0);\r\nelse\r\nselected_packets = (ignored_cnt != 0);\r\nif (selected_packets) {\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_REMOVE_IGNORED_KEY), TRUE);\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_IGNORED_C_KEY), !filtered_active);\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_IGNORED_D_KEY), filtered_active);\r\n} else {\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_REMOVE_IGNORED_KEY), FALSE);\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_IGNORED_C_KEY), FALSE);\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_IGNORED_D_KEY), FALSE);\r\n}\r\ng_snprintf(label_text, sizeof(label_text), "%u", ignored_cnt);\r\ngtk_label_set_text(GTK_LABEL(g_object_get_data(G_OBJECT(data), RANGE_IGNORED_C_KEY)), label_text);\r\ng_snprintf(label_text, sizeof(label_text), "%u", displayed_ignored_cnt);\r\ngtk_label_set_text(GTK_LABEL(g_object_get_data(G_OBJECT(data), RANGE_IGNORED_D_KEY)), label_text);\r\n}\r\nstatic void\r\ntoggle_captured_cb(GtkWidget *widget, gpointer data)\r\n{\r\nGtkWidget *bt;\r\npacket_range_t *range;\r\nrange = (packet_range_t *)g_object_get_data(G_OBJECT(data), RANGE_VALUES_KEY);\r\nif (gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON (widget))) {\r\nrange->process_filtered = FALSE;\r\nbt = (GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_CAPTURED_BT_KEY);\r\ngtk_toggle_button_set_active(GTK_TOGGLE_BUTTON(bt), TRUE);\r\nbt = (GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_DISPLAYED_BT_KEY);\r\ngtk_toggle_button_set_active(GTK_TOGGLE_BUTTON(bt), FALSE);\r\nrange_update_dynamics(data);\r\n}\r\n}\r\nstatic void\r\ntoggle_filtered_cb(GtkWidget *widget, gpointer data)\r\n{\r\nGtkWidget *bt;\r\npacket_range_t *range;\r\nrange = (packet_range_t *)g_object_get_data(G_OBJECT(data), RANGE_VALUES_KEY);\r\nif (gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON (widget))) {\r\nrange->process_filtered = TRUE;\r\nbt = (GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_CAPTURED_BT_KEY);\r\ngtk_toggle_button_set_active(GTK_TOGGLE_BUTTON(bt), FALSE);\r\nbt = (GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_DISPLAYED_BT_KEY);\r\ngtk_toggle_button_set_active(GTK_TOGGLE_BUTTON(bt), TRUE);\r\nrange_update_dynamics(data);\r\n}\r\n}\r\nstatic void\r\ntoggle_select_all(GtkWidget *widget, gpointer data)\r\n{\r\npacket_range_t *range;\r\nrange = (packet_range_t *)g_object_get_data(G_OBJECT(data), RANGE_VALUES_KEY);\r\nif (gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON (widget))) {\r\nrange->process = range_process_all;\r\nrange_update_dynamics(data);\r\n}\r\n}\r\nstatic void\r\ntoggle_select_selected(GtkWidget *widget, gpointer data)\r\n{\r\npacket_range_t *range;\r\nrange = (packet_range_t *)g_object_get_data(G_OBJECT(data), RANGE_VALUES_KEY);\r\nif (gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON (widget))) {\r\nrange->process = range_process_selected;\r\nrange_update_dynamics(data);\r\n}\r\n}\r\nstatic void\r\ntoggle_select_marked_only(GtkWidget *widget, gpointer data)\r\n{\r\npacket_range_t *range;\r\nrange = (packet_range_t *)g_object_get_data(G_OBJECT(data), RANGE_VALUES_KEY);\r\nif (gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON (widget))) {\r\nrange->process = range_process_marked;\r\nrange_update_dynamics(data);\r\n}\r\n}\r\nstatic void\r\ntoggle_select_marked_range(GtkWidget *widget, gpointer data)\r\n{\r\npacket_range_t *range;\r\nrange = (packet_range_t *)g_object_get_data(G_OBJECT(data), RANGE_VALUES_KEY);\r\nif (gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON (widget))) {\r\nrange->process = range_process_marked_range;\r\nrange_update_dynamics(data);\r\n}\r\n}\r\nstatic void\r\ntoggle_select_user_range(GtkWidget *widget, gpointer data)\r\n{\r\npacket_range_t *range;\r\nrange = (packet_range_t *)g_object_get_data(G_OBJECT(data), RANGE_VALUES_KEY);\r\nif (gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON (widget))) {\r\nrange->process = range_process_user_range;\r\nrange_update_dynamics(data);\r\n}\r\ngtk_widget_set_sensitive((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_SELECT_USER_ENTRY_KEY),\r\nrange->process == range_process_user_range);\r\nif (range->process == range_process_user_range)\r\ngtk_widget_grab_focus((GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_SELECT_USER_ENTRY_KEY));\r\n}\r\nstatic void\r\ntoggle_remove_ignored(GtkWidget *widget, gpointer data)\r\n{\r\npacket_range_t *range;\r\nrange = (packet_range_t *)g_object_get_data(G_OBJECT(data), RANGE_VALUES_KEY);\r\nif (gtk_toggle_button_get_active(GTK_TOGGLE_BUTTON (widget))) {\r\nrange->remove_ignored = TRUE;\r\n} else {\r\nrange->remove_ignored = FALSE;\r\n}\r\nrange_update_dynamics(data);\r\n}\r\nstatic void\r\nrange_entry(GtkWidget *widget _U_, gpointer data)\r\n{\r\nconst gchar *entry_text;\r\nGtkWidget *entry;\r\npacket_range_t *range;\r\nrange = (packet_range_t *)g_object_get_data(G_OBJECT(data), RANGE_VALUES_KEY);\r\nentry = (GtkWidget *)g_object_get_data(G_OBJECT(data), RANGE_SELECT_USER_ENTRY_KEY);\r\ngtk_toggle_button_set_active((GtkToggleButton *)g_object_get_data(G_OBJECT(data), RANGE_SELECT_USER_KEY), TRUE);\r\nentry_text = gtk_entry_get_text (GTK_ENTRY (entry));\r\npacket_range_convert_str(range, entry_text);\r\nrange_update_dynamics(data);\r\n}\r\nstatic void\r\nrange_entry_in_event(GtkWidget *widget _U_, GdkEventFocus *event _U_, gpointer user_data _U_)\r\n{\r\n}\r\nGtkWidget *range_new(packet_range_t *range, gboolean saving)\r\n{\r\nGtkWidget *range_grid;\r\nGtkWidget *captured_bt;\r\nGtkWidget *displayed_bt;\r\nGtkWidget *select_all_rb;\r\nGtkWidget *select_all_c_lb;\r\nGtkWidget *select_all_d_lb;\r\nGtkWidget *select_curr_rb;\r\nGtkWidget *select_curr_c_lb;\r\nGtkWidget *select_curr_d_lb;\r\nGtkWidget *select_marked_only_rb;\r\nGtkWidget *select_marked_only_c_lb;\r\nGtkWidget *select_marked_only_d_lb;\r\nGtkWidget *select_marked_range_rb;\r\nGtkWidget *select_marked_range_c_lb;\r\nGtkWidget *select_marked_range_d_lb;\r\nGtkWidget *select_user_range_rb;\r\nGtkWidget *select_user_range_c_lb;\r\nGtkWidget *select_user_range_d_lb;\r\nGtkWidget *select_user_range_entry;\r\nGtkWidget *remove_ignored_cb;\r\nGtkWidget *ignored_c_lb;\r\nGtkWidget *ignored_d_lb;\r\nrange_grid = ws_gtk_grid_new();\r\ngtk_container_set_border_width(GTK_CONTAINER(range_grid), 5);\r\ncaptured_bt = gtk_toggle_button_new_with_mnemonic("_Captured");\r\nws_gtk_grid_attach_defaults(GTK_GRID(range_grid), captured_bt, 1, 0, 1, 1);\r\ng_signal_connect(captured_bt, "toggled", G_CALLBACK(toggle_captured_cb), range_grid);\r\ngtk_widget_set_tooltip_text (captured_bt,("Process all the below chosen packets"));\r\ndisplayed_bt = gtk_toggle_button_new_with_mnemonic("_Displayed");\r\nws_gtk_grid_attach_defaults(GTK_GRID(range_grid), displayed_bt, 2, 0, 1, 1);\r\ng_signal_connect(displayed_bt, "toggled", G_CALLBACK(toggle_filtered_cb), range_grid);\r\nif (saving)\r\ngtk_widget_set_tooltip_text (displayed_bt,("Save the packets chosen below which also pass the current"\r\n" display filter. If \"all packets\" is selected then the packets"\r\n" required (e.g., for reassembled data) by the packets"\r\n" that passed the display filter are also included."));\r\nelse\r\ngtk_widget_set_tooltip_text (displayed_bt,("Process only the below chosen packets which also pass"\r\n" the current display filter"));\r\nselect_all_rb = gtk_radio_button_new_with_mnemonic_from_widget(NULL, "_All packets");\r\nws_gtk_grid_attach_defaults(GTK_GRID(range_grid), select_all_rb, 0, 1, 1, 1);\r\ngtk_widget_set_tooltip_text (select_all_rb, ("Process all packets"));\r\ng_signal_connect(select_all_rb, "toggled", G_CALLBACK(toggle_select_all), range_grid);\r\nselect_all_c_lb = gtk_label_new("?");\r\nws_gtk_grid_attach_defaults(GTK_GRID(range_grid), select_all_c_lb, 1, 1, 1, 1);\r\nselect_all_d_lb = gtk_label_new("?");\r\nws_gtk_grid_attach_defaults(GTK_GRID(range_grid), select_all_d_lb, 2, 1, 1, 1);\r\nselect_curr_rb = gtk_radio_button_new_with_mnemonic_from_widget(GTK_RADIO_BUTTON(select_all_rb),\r\n"_Selected packet only");\r\nws_gtk_grid_attach_defaults(GTK_GRID(range_grid), select_curr_rb, 0, 2, 1, 1);\r\ngtk_widget_set_tooltip_text (select_curr_rb, ("Process the currently selected packet only"));\r\ng_signal_connect(select_curr_rb, "toggled", G_CALLBACK(toggle_select_selected), range_grid);\r\nselect_curr_c_lb = gtk_label_new("?");\r\nws_gtk_grid_attach_defaults(GTK_GRID(range_grid), select_curr_c_lb, 1, 2, 1, 1);\r\nselect_curr_d_lb = gtk_label_new("?");\r\nws_gtk_grid_attach_defaults(GTK_GRID(range_grid), select_curr_d_lb, 2, 2, 1, 1);\r\nselect_marked_only_rb = gtk_radio_button_new_with_mnemonic_from_widget(GTK_RADIO_BUTTON(select_all_rb),\r\n"_Marked packets only");\r\nws_gtk_grid_attach_defaults(GTK_GRID(range_grid), select_marked_only_rb, 0, 3, 1, 1);\r\ngtk_widget_set_tooltip_text (select_marked_only_rb, ("Process marked packets only"));\r\ng_signal_connect(select_marked_only_rb, "toggled", G_CALLBACK(toggle_select_marked_only), range_grid);\r\nselect_marked_only_c_lb = gtk_label_new("?");\r\nws_gtk_grid_attach_defaults(GTK_GRID(range_grid), select_marked_only_c_lb, 1, 3, 1, 1);\r\nselect_marked_only_d_lb = gtk_label_new("?");\r\nws_gtk_grid_attach_defaults(GTK_GRID(range_grid), select_marked_only_d_lb, 2, 3, 1, 1);\r\nselect_marked_range_rb = gtk_radio_button_new_with_mnemonic_from_widget(GTK_RADIO_BUTTON(select_all_rb),\r\n"From first _to last marked packet");\r\nws_gtk_grid_attach_defaults(GTK_GRID(range_grid), select_marked_range_rb, 0, 4, 1, 1);\r\ngtk_widget_set_tooltip_text (select_marked_range_rb,("Process all packets between the first and last marker"));\r\ng_signal_connect(select_marked_range_rb, "toggled", G_CALLBACK(toggle_select_marked_range), range_grid);\r\nselect_marked_range_c_lb = gtk_label_new("?");\r\nws_gtk_grid_attach_defaults(GTK_GRID(range_grid), select_marked_range_c_lb, 1, 4, 1, 1);\r\nselect_marked_range_d_lb = gtk_label_new("?");\r\nws_gtk_grid_attach_defaults(GTK_GRID(range_grid), select_marked_range_d_lb, 2, 4, 1, 1);\r\nselect_user_range_rb = gtk_radio_button_new_with_mnemonic_from_widget(GTK_RADIO_BUTTON(select_all_rb),\r\n"Specify a packet _range:");\r\nws_gtk_grid_attach_defaults(GTK_GRID(range_grid), select_user_range_rb, 0, 5, 1, 1);\r\ngtk_widget_set_tooltip_text (select_user_range_rb,("Process a specified packet range"));\r\ng_signal_connect(select_user_range_rb, "toggled", G_CALLBACK(toggle_select_user_range), range_grid);\r\nselect_user_range_c_lb = gtk_label_new("?");\r\nws_gtk_grid_attach_defaults(GTK_GRID(range_grid), select_user_range_c_lb, 1, 5, 1, 1);\r\nselect_user_range_d_lb = gtk_label_new("?");\r\nws_gtk_grid_attach_defaults(GTK_GRID(range_grid), select_user_range_d_lb, 2, 5, 1, 1);\r\nselect_user_range_entry = gtk_entry_new();\r\ngtk_entry_set_max_length (GTK_ENTRY (select_user_range_entry), 254);\r\nws_gtk_grid_attach_defaults(GTK_GRID(range_grid), select_user_range_entry, 0, 6, 1, 1);\r\ngtk_widget_set_tooltip_text (select_user_range_entry,\r\n"Specify a range of packet numbers : \nExample : 1-10,18,25-100,332-");\r\ng_signal_connect(select_user_range_entry,"changed", G_CALLBACK(range_entry), range_grid);\r\ng_signal_connect(select_user_range_entry,"activate", G_CALLBACK(range_entry_in_event), range_grid);\r\nremove_ignored_cb = gtk_check_button_new_with_mnemonic("Remove _Ignored packets");\r\nws_gtk_grid_attach_defaults(GTK_GRID(range_grid), remove_ignored_cb, 0, 7, 1, 1);\r\ngtk_widget_set_tooltip_text (remove_ignored_cb,("Remove all packets marked as Ignored"));\r\ng_signal_connect(remove_ignored_cb, "toggled", G_CALLBACK(toggle_remove_ignored), range_grid);\r\nignored_c_lb = gtk_label_new("?");\r\nws_gtk_grid_attach_defaults(GTK_GRID(range_grid), ignored_c_lb, 1, 7, 1, 1);\r\nignored_d_lb = gtk_label_new("?");\r\nws_gtk_grid_attach_defaults(GTK_GRID(range_grid), ignored_d_lb, 2, 7, 1, 1);\r\ngtk_widget_show_all(range_grid);\r\ng_object_set_data(G_OBJECT(range_grid), RANGE_VALUES_KEY, range);\r\ng_object_set_data(G_OBJECT(range_grid), RANGE_CAPTURED_BT_KEY, captured_bt);\r\ng_object_set_data(G_OBJECT(range_grid), RANGE_DISPLAYED_BT_KEY, displayed_bt);\r\ng_object_set_data(G_OBJECT(range_grid), RANGE_SELECT_ALL_KEY, select_all_rb);\r\ng_object_set_data(G_OBJECT(range_grid), RANGE_SELECT_ALL_C_KEY, select_all_c_lb);\r\ng_object_set_data(G_OBJECT(range_grid), RANGE_SELECT_ALL_D_KEY, select_all_d_lb);\r\ng_object_set_data(G_OBJECT(range_grid), RANGE_SELECT_CURR_KEY, select_curr_rb);\r\ng_object_set_data(G_OBJECT(range_grid), RANGE_SELECT_CURR_C_KEY, select_curr_c_lb);\r\ng_object_set_data(G_OBJECT(range_grid), RANGE_SELECT_CURR_D_KEY, select_curr_d_lb);\r\ng_object_set_data(G_OBJECT(range_grid), RANGE_SELECT_CURR_D_KEY, select_curr_d_lb);\r\ng_object_set_data(G_OBJECT(range_grid), RANGE_SELECT_MARKED_KEY, select_marked_only_rb);\r\ng_object_set_data(G_OBJECT(range_grid), RANGE_SELECT_MARKED_C_KEY, select_marked_only_c_lb);\r\ng_object_set_data(G_OBJECT(range_grid), RANGE_SELECT_MARKED_D_KEY, select_marked_only_d_lb);\r\ng_object_set_data(G_OBJECT(range_grid), RANGE_SELECT_MARKED_RANGE_KEY, select_marked_range_rb);\r\ng_object_set_data(G_OBJECT(range_grid), RANGE_SELECT_MARKED_RANGE_C_KEY,select_marked_range_c_lb);\r\ng_object_set_data(G_OBJECT(range_grid), RANGE_SELECT_MARKED_RANGE_D_KEY,select_marked_range_d_lb);\r\ng_object_set_data(G_OBJECT(range_grid), RANGE_SELECT_USER_KEY, select_user_range_rb);\r\ng_object_set_data(G_OBJECT(range_grid), RANGE_SELECT_USER_C_KEY, select_user_range_c_lb);\r\ng_object_set_data(G_OBJECT(range_grid), RANGE_SELECT_USER_D_KEY, select_user_range_d_lb);\r\ng_object_set_data(G_OBJECT(range_grid), RANGE_SELECT_USER_ENTRY_KEY, select_user_range_entry);\r\ng_object_set_data(G_OBJECT(range_grid), RANGE_REMOVE_IGNORED_KEY, remove_ignored_cb);\r\ng_object_set_data(G_OBJECT(range_grid), RANGE_IGNORED_C_KEY, ignored_c_lb);\r\ng_object_set_data(G_OBJECT(range_grid), RANGE_IGNORED_D_KEY, ignored_d_lb);\r\ngtk_toggle_button_set_active(GTK_TOGGLE_BUTTON(captured_bt), !range->process_filtered);\r\ngtk_toggle_button_set_active(GTK_TOGGLE_BUTTON(displayed_bt), range->process_filtered);\r\nswitch(range->process) {\r\ncase(range_process_all):\r\ngtk_toggle_button_set_active(GTK_TOGGLE_BUTTON(select_all_rb), TRUE);\r\nbreak;\r\ncase(range_process_selected):\r\ngtk_toggle_button_set_active(GTK_TOGGLE_BUTTON(select_curr_rb), TRUE);\r\nbreak;\r\ncase(range_process_marked):\r\ngtk_toggle_button_set_active(GTK_TOGGLE_BUTTON(select_marked_only_rb), TRUE);\r\nbreak;\r\ncase(range_process_marked_range):\r\ngtk_toggle_button_set_active(GTK_TOGGLE_BUTTON(select_marked_range_rb), TRUE);\r\nbreak;\r\ncase(range_process_user_range):\r\ngtk_toggle_button_set_active(GTK_TOGGLE_BUTTON(select_user_range_rb), TRUE);\r\nbreak;\r\ndefault:\r\ng_assert_not_reached();\r\n}\r\nreturn range_grid;\r\n}
