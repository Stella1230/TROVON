static int\r\ndissect_q932_NumberDigits(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_restricted_string(implicit_tag, BER_UNI_TAG_NumericString,\r\nactx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_q932_PublicTypeOfNumber(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_q932_PublicPartyNumber(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nPublicPartyNumber_sequence, hf_index, ett_q932_PublicPartyNumber);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_q932_NsapEncodedNumber(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_octet_string(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_q932_PrivateTypeOfNumber(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_q932_PrivatePartyNumber(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nPrivatePartyNumber_sequence, hf_index, ett_q932_PrivatePartyNumber);\r\nreturn offset;\r\n}\r\nint\r\ndissect_q932_PartyNumber(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_choice(actx, tree, tvb, offset,\r\nPartyNumber_choice, hf_index, ett_q932_PartyNumber,\r\nNULL);\r\nreturn offset;\r\n}\r\nint\r\ndissect_q932_ScreeningIndicator(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_q932_SubaddressInformation(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_octet_string(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_q932_BOOLEAN(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_boolean(implicit_tag, actx, tree, tvb, offset, hf_index, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_q932_UserSpecifiedSubaddress(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nUserSpecifiedSubaddress_sequence, hf_index, ett_q932_UserSpecifiedSubaddress);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_q932_NSAPSubaddress(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_octet_string(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nint\r\ndissect_q932_PartySubaddress(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_choice(actx, tree, tvb, offset,\r\nPartySubaddress_choice, hf_index, ett_q932_PartySubaddress,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_q932_AddressScreened(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nAddressScreened_sequence, hf_index, ett_q932_AddressScreened);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_q932_NULL(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_null(implicit_tag, actx, tree, tvb, offset, hf_index);\r\nreturn offset;\r\n}\r\nint\r\ndissect_q932_PresentedAddressScreened(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_choice(actx, tree, tvb, offset,\r\nPresentedAddressScreened_choice, hf_index, ett_q932_PresentedAddressScreened,\r\nNULL);\r\nreturn offset;\r\n}\r\nint\r\ndissect_q932_Address(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nAddress_sequence, hf_index, ett_q932_Address);\r\nreturn offset;\r\n}\r\nint\r\ndissect_q932_PresentedAddressUnscreened(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_choice(actx, tree, tvb, offset,\r\nPresentedAddressUnscreened_choice, hf_index, ett_q932_PresentedAddressUnscreened,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_q932_NumberScreened(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nNumberScreened_sequence, hf_index, ett_q932_NumberScreened);\r\nreturn offset;\r\n}\r\nint\r\ndissect_q932_PresentedNumberScreened(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_choice(actx, tree, tvb, offset,\r\nPresentedNumberScreened_choice, hf_index, ett_q932_PresentedNumberScreened,\r\nNULL);\r\nreturn offset;\r\n}\r\nint\r\ndissect_q932_PresentedNumberUnscreened(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_choice(actx, tree, tvb, offset,\r\nPresentedNumberUnscreened_choice, hf_index, ett_q932_PresentedNumberUnscreened,\r\nNULL);\r\nreturn offset;\r\n}\r\nint\r\ndissect_q932_PresentationAllowedIndicator(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_boolean(implicit_tag, actx, tree, tvb, offset, hf_index, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_q932_EntityType(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_q932_AddressInformation(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_q932_PartyNumber(implicit_tag, tvb, offset, actx, tree, hf_index);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_q932_NetworkFacilityExtension_U(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_sequence(implicit_tag, actx, tree, tvb, offset,\r\nNetworkFacilityExtension_U_sequence, hf_index, ett_q932_NetworkFacilityExtension_U);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_q932_NetworkFacilityExtension(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_tagged_type(implicit_tag, actx, tree, tvb, offset,\r\nhf_index, BER_CLASS_CON, 10, TRUE, dissect_q932_NetworkFacilityExtension_U);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_q932_NetworkProtocolProfile_U(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_q932_NetworkProtocolProfile(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_tagged_type(implicit_tag, actx, tree, tvb, offset,\r\nhf_index, BER_CLASS_CON, 18, TRUE, dissect_q932_NetworkProtocolProfile_U);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_q932_InterpretationComponent_U(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_integer(implicit_tag, actx, tree, tvb, offset, hf_index,\r\nNULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_q932_InterpretationComponent(gboolean implicit_tag _U_, tvbuff_t *tvb _U_, int offset _U_, asn1_ctx_t *actx _U_, proto_tree *tree _U_, int hf_index _U_) {\r\noffset = dissect_ber_tagged_type(implicit_tag, actx, tree, tvb, offset,\r\nhf_index, BER_CLASS_CON, 11, TRUE, dissect_q932_InterpretationComponent_U);\r\nreturn offset;\r\n}\r\nstatic int dissect_NetworkFacilityExtension_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_q932_NetworkFacilityExtension(FALSE, tvb, offset, &asn1_ctx, tree, hf_q932_NetworkFacilityExtension_PDU);\r\nreturn offset;\r\n}\r\nstatic int dissect_NetworkProtocolProfile_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_q932_NetworkProtocolProfile(FALSE, tvb, offset, &asn1_ctx, tree, hf_q932_NetworkProtocolProfile_PDU);\r\nreturn offset;\r\n}\r\nstatic int dissect_InterpretationComponent_PDU(tvbuff_t *tvb _U_, packet_info *pinfo _U_, proto_tree *tree _U_, void *data _U_) {\r\nint offset = 0;\r\nasn1_ctx_t asn1_ctx;\r\nasn1_ctx_init(&asn1_ctx, ASN1_ENC_BER, TRUE, pinfo);\r\noffset = dissect_q932_InterpretationComponent(FALSE, tvb, offset, &asn1_ctx, tree, hf_q932_InterpretationComponent_PDU);\r\nreturn offset;\r\n}\r\nstatic void\r\ndissect_q932_facility_ie(tvbuff_t *tvb, int offset, packet_info *pinfo, proto_tree *tree, int length) {\r\ngint8 appclass;\r\ngboolean pc;\r\ngint32 tag;\r\nguint32 len;\r\nint hoffset, eoffset;\r\nint ie_end;\r\ntvbuff_t *next_tvb;\r\nie_end = offset + length;\r\nproto_tree_add_item(tree, hf_q932_pp, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nwhile (offset < ie_end) {\r\nhoffset = offset;\r\noffset = get_ber_identifier(tvb, offset, &appclass, &pc, &tag);\r\noffset = get_ber_length(tvb, offset, &len, NULL);\r\neoffset = offset + len;\r\nnext_tvb = tvb_new_subset_length(tvb, hoffset, eoffset - hoffset);\r\nswitch (appclass) {\r\ncase BER_CLASS_CON:\r\nswitch (tag) {\r\ncase 10 :\r\ndissect_NetworkFacilityExtension_PDU(next_tvb, pinfo, tree, NULL);\r\nbreak;\r\ncase 18 :\r\ndissect_NetworkProtocolProfile_PDU(next_tvb, pinfo, tree, NULL);\r\nbreak;\r\ncase 11 :\r\ndissect_InterpretationComponent_PDU(next_tvb, pinfo, tree, NULL);\r\nbreak;\r\ncase 1 :\r\ncase 2 :\r\ncase 3 :\r\ncase 4 :\r\nq932_rose_ctx.apdu_depth = 1;\r\ncall_dissector_with_data(q932_ros_handle, next_tvb, pinfo, tree, &q932_rose_ctx);\r\nbreak;\r\ncase 12 :\r\ncase 14 :\r\ncase 15 :\r\ncase 17 :\r\noffset = dissect_ber_identifier(pinfo, tree, tvb, hoffset, NULL, NULL, NULL);\r\noffset = dissect_ber_length(pinfo, tree, tvb, offset, NULL, NULL);\r\nproto_tree_add_expert(tree, pinfo, &ei_q932_dse_not_supported, tvb, offset, len);\r\nbreak;\r\ndefault:\r\noffset = dissect_ber_identifier(pinfo, tree, tvb, hoffset, NULL, NULL, NULL);\r\noffset = dissect_ber_length(pinfo, tree, tvb, offset, NULL, NULL);\r\nproto_tree_add_expert(tree, pinfo, &ei_q932_unknown_component, tvb, offset, len);\r\n}\r\nbreak;\r\ncase BER_CLASS_APP:\r\nswitch (tag) {\r\ncase 0 :\r\ncase 1 :\r\ncase 2 :\r\ncase 3 :\r\ncase 4 :\r\noffset = dissect_ber_identifier(pinfo, tree, tvb, hoffset, NULL, NULL, NULL);\r\noffset = dissect_ber_length(pinfo, tree, tvb, offset, NULL, NULL);\r\nproto_tree_add_expert(tree, pinfo, &ei_q932_acse_not_supported, tvb, offset, len);\r\nbreak;\r\ndefault:\r\noffset = dissect_ber_identifier(pinfo, tree, tvb, hoffset, NULL, NULL, NULL);\r\noffset = dissect_ber_length(pinfo, tree, tvb, offset, NULL, NULL);\r\nproto_tree_add_expert(tree, pinfo, &ei_q932_unknown_component, tvb, offset, len);\r\n}\r\nbreak;\r\ndefault:\r\noffset = dissect_ber_identifier(pinfo, tree, tvb, hoffset, NULL, NULL, NULL);\r\noffset = dissect_ber_length(pinfo, tree, tvb, offset, NULL, NULL);\r\nproto_tree_add_expert(tree, pinfo, &ei_q932_unknown_component, tvb, offset, len);\r\n}\r\noffset = eoffset;\r\n}\r\n}\r\nstatic void\r\ndissect_q932_ni_ie(tvbuff_t *tvb, int offset, packet_info *pinfo, proto_tree *tree, int length) {\r\nint remain = length;\r\nguint8 octet = 0;\r\nguint32 value = 0;\r\nproto_item* ti;\r\nwhile ((remain > 0) && !(octet & 0x80)) {\r\noctet = tvb_get_guint8(tvb, offset++);\r\nremain--;\r\nvalue <<= 7;\r\nvalue |= octet & 0x7F;\r\n}\r\nti = proto_tree_add_uint(tree, hf_q932_nd, tvb, offset - (length - remain), length - remain, value);\r\nif (remain > 0) {\r\nexpert_add_info(pinfo, ti, &ei_q932_asn1_encoded);\r\n}\r\n}\r\nstatic int\r\ndissect_q932_ie(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_) {\r\ngint offset;\r\nproto_item *ti;\r\nproto_tree *ie_tree;\r\nguint8 ie_type, ie_len;\r\noffset = 0;\r\nti = proto_tree_add_item(tree, proto_q932, tvb, offset, -1, ENC_NA);\r\nPROTO_ITEM_SET_HIDDEN(ti);\r\nie_type = tvb_get_guint8(tvb, offset);\r\nie_len = tvb_get_guint8(tvb, offset + 1);\r\nie_tree = proto_tree_add_subtree(tree, tvb, offset, -1, ett_q932_ie, NULL,\r\nval_to_str(ie_type, VALS(q932_str_ie_type), "unknown (0x%02X)"));\r\nproto_tree_add_item(ie_tree, hf_q932_ie_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(ie_tree, hf_q932_ie_len, tvb, offset + 1, 1, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nif (tvb_reported_length_remaining(tvb, offset) <= 0)\r\nreturn offset;\r\nswitch (ie_type) {\r\ncase Q932_IE_FACILITY :\r\ndissect_q932_facility_ie(tvb, offset, pinfo, ie_tree, ie_len);\r\nbreak;\r\ncase Q932_IE_NOTIFICATION_INDICATOR :\r\ndissect_q932_ni_ie(tvb, offset, pinfo, ie_tree, ie_len);\r\nbreak;\r\ndefault:\r\nif (ie_len > 0) {\r\nproto_tree_add_item(ie_tree, hf_q932_ie_data, tvb, offset, ie_len, ENC_NA);\r\n}\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nstatic int\r\ndissect_q932_apdu(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_) {\r\nreturn call_dissector(q932_ros_handle, tvb, pinfo, tree);\r\n}\r\nvoid proto_register_q932(void) {\r\nstatic hf_register_info hf[] = {\r\n{ &hf_q932_ie_type, { "Type", "q932.ie.type",\r\nFT_UINT8, BASE_HEX, VALS(q932_str_ie_type), 0x0,\r\n"Information Element Type", HFILL }},\r\n{ &hf_q932_ie_len, { "Length", "q932.ie.len",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\n"Information Element Length", HFILL }},\r\n{ &hf_q932_ie_data, { "Data", "q932.ie.data",\r\nFT_BYTES, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_q932_pp, { "Protocol profile", "q932.pp",\r\nFT_UINT8, BASE_HEX, VALS(str_pp), 0x1F,\r\nNULL, HFILL }},\r\n{ &hf_q932_nd, { "Notification description", "q932.nd",\r\nFT_UINT8, BASE_HEX, VALS(str_nd), 0x0,\r\nNULL, HFILL }},\r\n#line 1 "./asn1/q932/packet-q932-hfarr.c"\r\n{ &hf_q932_NetworkFacilityExtension_PDU,\r\n{ "NetworkFacilityExtension", "q932.NetworkFacilityExtension_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_q932_NetworkProtocolProfile_PDU,\r\n{ "NetworkProtocolProfile", "q932.NetworkProtocolProfile",\r\nFT_UINT32, BASE_DEC, VALS(q932_NetworkProtocolProfile_U_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_q932_InterpretationComponent_PDU,\r\n{ "InterpretationComponent", "q932.InterpretationComponent",\r\nFT_UINT32, BASE_DEC, VALS(q932_InterpretationComponent_U_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_q932_presentationAlIowedAddress,\r\n{ "presentationAlIowedAddress", "q932.presentationAlIowedAddress_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"AddressScreened", HFILL }},\r\n{ &hf_q932_presentationRestricted,\r\n{ "presentationRestricted", "q932.presentationRestricted_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_q932_numberNotAvailableDueTolnterworking,\r\n{ "numberNotAvailableDueTolnterworking", "q932.numberNotAvailableDueTolnterworking_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_q932_presentationRestrictedAddressScreened,\r\n{ "presentationRestrictedAddress", "q932.presentationRestrictedAddress_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"AddressScreened", HFILL }},\r\n{ &hf_q932_presentationAllowedAddress,\r\n{ "presentationAllowedAddress", "q932.presentationAllowedAddress_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"Address", HFILL }},\r\n{ &hf_q932_presentationRestrictedAddress,\r\n{ "presentationRestrictedAddress", "q932.presentationRestrictedAddress_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"Address", HFILL }},\r\n{ &hf_q932_presentationAllowedNumberScreened,\r\n{ "presentationAllowedNumber", "q932.presentationAllowedNumber_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"NumberScreened", HFILL }},\r\n{ &hf_q932_numberNotAvailableDueToInterworking,\r\n{ "numberNotAvailableDueToInterworking", "q932.numberNotAvailableDueToInterworking_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_q932_presentationRestrictedNumberScreened,\r\n{ "presentationRestrictedNumber", "q932.presentationRestrictedNumber_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\n"NumberScreened", HFILL }},\r\n{ &hf_q932_presentationAllowedNumber,\r\n{ "presentationAllowedNumber", "q932.presentationAllowedNumber",\r\nFT_UINT32, BASE_DEC, VALS(q932_PartyNumber_vals), 0,\r\n"PartyNumber", HFILL }},\r\n{ &hf_q932_presentationRestrictedNumber,\r\n{ "presentationRestrictedNumber", "q932.presentationRestrictedNumber",\r\nFT_UINT32, BASE_DEC, VALS(q932_PartyNumber_vals), 0,\r\n"PartyNumber", HFILL }},\r\n{ &hf_q932_partyNumber,\r\n{ "partyNumber", "q932.partyNumber",\r\nFT_UINT32, BASE_DEC, VALS(q932_PartyNumber_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_q932_screeninglndicator,\r\n{ "screeninglndicator", "q932.screeninglndicator",\r\nFT_UINT32, BASE_DEC, VALS(q932_ScreeningIndicator_vals), 0,\r\n"ScreeningIndicator", HFILL }},\r\n{ &hf_q932_partySubaddress,\r\n{ "partySubaddress", "q932.partySubaddress",\r\nFT_UINT32, BASE_DEC, VALS(q932_PartySubaddress_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_q932_screeningIndicator,\r\n{ "screeningIndicator", "q932.screeningIndicator",\r\nFT_UINT32, BASE_DEC, VALS(q932_ScreeningIndicator_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_q932_unknownPartyNumber,\r\n{ "unknownPartyNumber", "q932.unknownPartyNumber",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\n"NumberDigits", HFILL }},\r\n{ &hf_q932_publicPartyNumber,\r\n{ "publicPartyNumber", "q932.publicPartyNumber_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_q932_nsapEncodedNumber,\r\n{ "nsapEncodedNumber", "q932.nsapEncodedNumber",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_q932_dataPartyNumber,\r\n{ "dataPartyNumber", "q932.dataPartyNumber",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\n"NumberDigits", HFILL }},\r\n{ &hf_q932_telexPartyNumber,\r\n{ "telexPartyNumber", "q932.telexPartyNumber",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\n"NumberDigits", HFILL }},\r\n{ &hf_q932_privatePartyNumber,\r\n{ "privatePartyNumber", "q932.privatePartyNumber_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_q932_nationalStandardPartyNumber,\r\n{ "nationalStandardPartyNumber", "q932.nationalStandardPartyNumber",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\n"NumberDigits", HFILL }},\r\n{ &hf_q932_publicTypeOfNumber,\r\n{ "publicTypeOfNumber", "q932.publicTypeOfNumber",\r\nFT_UINT32, BASE_DEC, VALS(q932_PublicTypeOfNumber_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_q932_publicNumberDigits,\r\n{ "publicNumberDigits", "q932.publicNumberDigits",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\n"NumberDigits", HFILL }},\r\n{ &hf_q932_privateTypeOfNumber,\r\n{ "privateTypeOfNumber", "q932.privateTypeOfNumber",\r\nFT_UINT32, BASE_DEC, VALS(q932_PrivateTypeOfNumber_vals), 0,\r\nNULL, HFILL }},\r\n{ &hf_q932_privateNumberDigits,\r\n{ "privateNumberDigits", "q932.privateNumberDigits",\r\nFT_STRING, BASE_NONE, NULL, 0,\r\n"NumberDigits", HFILL }},\r\n{ &hf_q932_userSpecifiedSubaddress,\r\n{ "userSpecifiedSubaddress", "q932.userSpecifiedSubaddress_element",\r\nFT_NONE, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_q932_nSAPSubaddress,\r\n{ "nSAPSubaddress", "q932.nSAPSubaddress",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_q932_subaddressInformation,\r\n{ "subaddressInformation", "q932.subaddressInformation",\r\nFT_BYTES, BASE_NONE, NULL, 0,\r\nNULL, HFILL }},\r\n{ &hf_q932_oddCountIndicator,\r\n{ "oddCountIndicator", "q932.oddCountIndicator",\r\nFT_BOOLEAN, BASE_NONE, NULL, 0,\r\n"BOOLEAN", HFILL }},\r\n{ &hf_q932_sourceEntity,\r\n{ "sourceEntity", "q932.sourceEntity",\r\nFT_UINT32, BASE_DEC, VALS(q932_EntityType_vals), 0,\r\n"EntityType", HFILL }},\r\n{ &hf_q932_sourceEntityAddress,\r\n{ "sourceEntityAddress", "q932.sourceEntityAddress",\r\nFT_UINT32, BASE_DEC, VALS(q932_PartyNumber_vals), 0,\r\n"AddressInformation", HFILL }},\r\n{ &hf_q932_destinationEntity,\r\n{ "destinationEntity", "q932.destinationEntity",\r\nFT_UINT32, BASE_DEC, VALS(q932_EntityType_vals), 0,\r\n"EntityType", HFILL }},\r\n{ &hf_q932_destinationEntityAddress,\r\n{ "destinationEntityAddress", "q932.destinationEntityAddress",\r\nFT_UINT32, BASE_DEC, VALS(q932_PartyNumber_vals), 0,\r\n"AddressInformation", HFILL }},\r\n#line 313 "./asn1/q932/packet-q932-template.c"\r\n};\r\nstatic gint *ett[] = {\r\n&ett_q932,\r\n&ett_q932_ie,\r\n#line 1 "./asn1/q932/packet-q932-ettarr.c"\r\n&ett_q932_PresentedAddressScreened,\r\n&ett_q932_PresentedAddressUnscreened,\r\n&ett_q932_PresentedNumberScreened,\r\n&ett_q932_PresentedNumberUnscreened,\r\n&ett_q932_AddressScreened,\r\n&ett_q932_NumberScreened,\r\n&ett_q932_Address,\r\n&ett_q932_PartyNumber,\r\n&ett_q932_PublicPartyNumber,\r\n&ett_q932_PrivatePartyNumber,\r\n&ett_q932_PartySubaddress,\r\n&ett_q932_UserSpecifiedSubaddress,\r\n&ett_q932_NetworkFacilityExtension_U,\r\n#line 320 "./asn1/q932/packet-q932-template.c"\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_q932_dse_not_supported, { "q932.dse_not_supported", PI_UNDECODED, PI_WARN, "DSE APDU (not supported)", EXPFILL }},\r\n{ &ei_q932_acse_not_supported, { "q932.acse_not_supported", PI_UNDECODED, PI_WARN, "ACSE APDU (not supported)", EXPFILL }},\r\n{ &ei_q932_unknown_component, { "q932.unknown_component", PI_UNDECODED, PI_WARN, "Unknown Component", EXPFILL }},\r\n{ &ei_q932_asn1_encoded, { "q932.asn1_encoded", PI_UNDECODED, PI_WARN, "ASN.1 Encoded Data Structure(NOT IMPLEMENTED)", EXPFILL }},\r\n};\r\nmodule_t *q932_module;\r\nexpert_module_t* expert_q932;\r\nstatic const enum_val_t facility_encoding[] = {\r\n{"Facility as QSIG", "Dissect facility as QSIG", FACILITY_QSIG},\r\n{"Facility as ETSI", "Dissect facility as ETSI", FACILITY_ETSI},\r\n{NULL, NULL, -1}\r\n};\r\nproto_q932 = proto_register_protocol(PNAME, PSNAME, PFNAME);\r\nregister_dissector("q932.apdu", dissect_q932_apdu, proto_q932);\r\nproto_register_field_array(proto_q932, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_q932 = expert_register_protocol(proto_q932);\r\nexpert_register_field_array(expert_q932, ei, array_length(ei));\r\nrose_ctx_init(&q932_rose_ctx);\r\nq932_rose_ctx.arg_global_dissector_table = register_dissector_table("q932.ros.global.arg", "Q.932 Operation Argument (global opcode)", proto_q932, FT_STRING, BASE_NONE);\r\nq932_rose_ctx.res_global_dissector_table = register_dissector_table("q932.ros.global.res", "Q.932 Operation Result (global opcode)", proto_q932, FT_STRING, BASE_NONE);\r\nq932_rose_ctx.err_global_dissector_table = register_dissector_table("q932.ros.global.err", "Q.932 Error (global opcode)", proto_q932, FT_STRING, BASE_NONE);\r\nqsig_arg_local_dissector_table = register_dissector_table("q932.ros.local.arg", "Q.932 Operation Argument (local opcode)", proto_q932, FT_UINT32, BASE_HEX);\r\nqsig_res_local_dissector_table = register_dissector_table("q932.ros.local.res", "Q.932 Operation Result (local opcode)", proto_q932, FT_UINT32, BASE_HEX);\r\nqsig_err_local_dissector_table = register_dissector_table("q932.ros.local.err", "Q.932 Error (local opcode)", proto_q932, FT_UINT32, BASE_HEX);\r\netsi_arg_local_dissector_table = register_dissector_table("q932.ros.etsi.local.arg", "Q.932 ETSI Operation Argument (local opcode)", proto_q932, FT_UINT32, BASE_HEX);\r\netsi_res_local_dissector_table = register_dissector_table("q932.ros.etsi.local.res", "Q.932 ETSI Operation Result (local opcode)", proto_q932, FT_UINT32, BASE_HEX);\r\netsi_err_local_dissector_table = register_dissector_table("q932.ros.etsi.local.err", "Q.932 ETSI Error (local opcode)", proto_q932, FT_UINT32, BASE_HEX);\r\nq932_module = prefs_register_protocol(proto_q932, proto_reg_handoff_q932);\r\nprefs_register_enum_preference(q932_module, "facility_encoding",\r\n"Type of Facility encoding",\r\n"Type of Facility encoding",\r\n&g_facility_encoding, facility_encoding, FALSE);\r\n}\r\nvoid proto_reg_handoff_q932(void) {\r\ndissector_handle_t q932_ie_handle;\r\nstatic gboolean q931_prefs_initialized = FALSE;\r\nif (!q931_prefs_initialized) {\r\nq932_ie_handle = create_dissector_handle(dissect_q932_ie, proto_q932);\r\ndissector_add_uint("q931.ie", (0x00 << 8) | Q932_IE_FACILITY, q932_ie_handle);\r\ndissector_add_uint("q931.ie", (0x00 << 8) | Q932_IE_NOTIFICATION_INDICATOR, q932_ie_handle);\r\nq932_ros_handle = find_dissector_add_dependency("q932.ros", proto_q932);\r\n}\r\nif(g_facility_encoding == FACILITY_QSIG){\r\nq932_rose_ctx.arg_local_dissector_table = qsig_arg_local_dissector_table;\r\nq932_rose_ctx.res_local_dissector_table = qsig_res_local_dissector_table;\r\nq932_rose_ctx.err_local_dissector_table = qsig_err_local_dissector_table;\r\n}else{\r\nq932_rose_ctx.arg_local_dissector_table = etsi_arg_local_dissector_table;\r\nq932_rose_ctx.res_local_dissector_table = etsi_res_local_dissector_table;\r\nq932_rose_ctx.err_local_dissector_table = etsi_err_local_dissector_table;\r\n}\r\n}
