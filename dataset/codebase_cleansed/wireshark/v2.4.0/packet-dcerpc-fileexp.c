static int\r\ndissect_afsFid (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *parent_tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\nguint32 volume_low, unique, vnode, inode;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree = proto_tree_add_subtree (parent_tree, tvb, offset, -1, ett_fileexp_afsFid, &item, "afsFid:");\r\n}\r\noffset = dissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_afsFid_cell_high, NULL);\r\noffset = dissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_afsFid_cell_low, NULL);\r\noffset = dissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_afsFid_volume_high, NULL);\r\noffset = dissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_afsFid_volume_low, &volume_low);\r\noffset = dissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_afsFid_Vnode, &vnode);\r\noffset = dissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_afsFid_Unique, &unique);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " :FSID:%u ", volume_low);\r\nif ((vnode == 1) || (vnode == 2))\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, " InFS ");\r\n}\r\nelse\r\n{\r\ninode = ((volume_low << 16) + vnode) & 0x7fffffff;\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " inode:%u ", inode);\r\n}\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_afsConnParams (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *parent_tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\nguint32 mask, Values[20];\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree =\r\nproto_tree_add_subtree (parent_tree, tvb, offset, -1,\r\nett_fileexp_afsConnParams, &item, "afsConnParams_t:");\r\n}\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_afsconnparams_mask, &mask);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_afsconnparams_values, &Values[0]);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_afsconnparams_values, &Values[1]);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_afsconnparams_values, &Values[2]);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_afsconnparams_values, &Values[3]);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_afsconnparams_values, &Values[4]);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_afsconnparams_values, &Values[5]);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_afsconnparams_values, &Values[6]);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_afsconnparams_values, &Values[7]);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_afsconnparams_values, &Values[8]);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_afsconnparams_values, &Values[9]);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_afsconnparams_values, &Values[10]);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_afsconnparams_values, &Values[11]);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_afsconnparams_values, &Values[12]);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_afsconnparams_values, &Values[13]);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_afsconnparams_values, &Values[14]);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_afsconnparams_values, &Values[15]);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_afsconnparams_values, &Values[16]);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_afsconnparams_values, &Values[17]);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_afsconnparams_values, &Values[18]);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_afsconnparams_values, &Values[19]);\r\nif ((mask & AFS_CONN_PARAM_HOSTLIFE) == AFS_CONN_PARAM_HOSTLIFE)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":HOSTLIFE");\r\n}\r\nif ((mask & AFS_CONN_PARAM_HOSTRPC) == AFS_CONN_PARAM_HOSTRPC)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":HOSTRPC");\r\n}\r\nif ((mask & AFS_CONN_PARAM_DEADSERVER) == AFS_CONN_PARAM_DEADSERVER)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":DEADSERVER");\r\n}\r\nif ((mask & AFS_CONN_PARAM_EPOCH) == AFS_CONN_PARAM_EPOCH)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":EPOCH");\r\n}\r\nif ((mask & AFS_CONN_PARAM_MAXFILE_CLIENT) == AFS_CONN_PARAM_MAXFILE_CLIENT)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":MAXFILE_CLIENT");\r\n}\r\nif ((mask & AFS_CONN_PARAM_MAXFILE_SERVER) == AFS_CONN_PARAM_MAXFILE_SERVER)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":MAXFILE_SERVER");\r\n}\r\nif ((mask & AFS_CONN_PARAM_HOST_TYPE_CLIENT) ==\r\nAFS_CONN_PARAM_HOST_TYPE_CLIENT)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":HOST_TYPE_CLIENT");\r\n}\r\nif ((mask & AFS_CONN_PARAM_HOST_TYPE_SERVER) ==\r\nAFS_CONN_PARAM_HOST_TYPE_SERVER)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":HOST_TYPE_SERVER");\r\n}\r\nif ((mask & AFS_CONN_PARAM_FT_MASK_CLIENT) == AFS_CONN_PARAM_FT_MASK_CLIENT)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":FT_MASK_CLIENT");\r\n}\r\nif ((mask & AFS_CONN_PARAM_FT_MASK_SERVER) == AFS_CONN_PARAM_FT_MASK_SERVER)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":FT_MASK_SERVER");\r\n}\r\nif ((mask & AFS_CONN_PARAM_SUPPORTS_64BITS) ==\r\nAFS_CONN_PARAM_SUPPORTS_64BITS)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":SUPPORTS_64BITS");\r\n}\r\nif ((mask & AFS_CONN_PARAM_512BYTE_BLOCKS) == AFS_CONN_PARAM_512BYTE_BLOCKS)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":512BYTE_BLOCKS");\r\n}\r\ncol_append_fstr (pinfo->cinfo, COL_INFO,\r\n" Values:%u%u%u%u%u%u%u%u%u%u%u%u%u%u%u%u%u%u%u%u",\r\nValues[0], Values[1], Values[2], Values[3],\r\nValues[4], Values[5], Values[6], Values[7], Values[8],\r\nValues[9], Values[10], Values[11], Values[12],\r\nValues[13], Values[14], Values[15], Values[16],\r\nValues[17], Values[18], Values[19]);\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_afsNameString_t (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *parent_tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\n#define AFS_NAMEMAX 256\r\nguint32 string_size;\r\nconst guint8 *namestring;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree =\r\nproto_tree_add_subtree (parent_tree, tvb, offset, -1,\r\nett_fileexp_afsNameString_t, &item, "afsNameString_t:");\r\n}\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_afsNameString_t_principalName_size,\r\n&string_size);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " String_size:%u", string_size);\r\nif (string_size < AFS_NAMEMAX)\r\n{\r\nproto_tree_add_item_ret_string(tree, hf_fileexp_afsNameString_t_principalName_string, tvb, offset, string_size, ENC_ASCII|ENC_NA, wmem_packet_scope(), &namestring);\r\noffset += string_size;\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " Principal:%s", namestring);\r\n}\r\nelse\r\n{\r\ncol_append_fstr (pinfo->cinfo, COL_INFO,\r\n" :FIXME!: Invalid string length of %u",\r\nstring_size);\r\n}\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_afsNetAddr (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *parent_tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\nguint16 type;\r\nguint8 data;\r\nint i;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree = proto_tree_add_subtree (parent_tree, tvb, offset, -1,\r\nett_fileexp_afsNetAddr, &item, "afsNetAddr:");\r\n}\r\noffset =\r\ndissect_ndr_uint16 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_afsNetAddr_type, &type);\r\nif (type)\r\n{\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " Type:%u ", type);\r\nfor (i = 0; i < 14; i++)\r\n{\r\noffset =\r\ndissect_ndr_uint8 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_afsNetAddr_data, &data);\r\nswitch (i)\r\n{\r\ncase 1:\r\nif (data)\r\n{\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " Port:%u",\r\ndata);\r\n}\r\nbreak;\r\ncase 2:\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " IP:%u.", data);\r\nbreak;\r\ncase 3:\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "%u.", data);\r\nbreak;\r\ncase 4:\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "%u.", data);\r\nbreak;\r\ncase 5:\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "%u", data);\r\nbreak;\r\n}\r\n}\r\n}\r\nelse\r\n{\r\noffset += 14;\r\n}\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_afsNetData (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *parent_tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree =\r\nproto_tree_add_subtree (parent_tree, tvb, offset, -1, ett_fileexp_afsNetData, &item, "afsNetData:");\r\n}\r\noffset = dissect_afsNetAddr ( tvb, offset, pinfo, tree, di, drep);\r\noffset += 4;\r\noffset = dissect_afsNameString_t ( tvb, offset, pinfo, tree, di, drep);\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_afsTaggedPath (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *parent_tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\nguint32 tp_tag;\r\nguint16 tp_length;\r\nconst guint8 *tp_chars;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree =\r\nproto_tree_add_subtree (parent_tree, tvb, offset, -1, ett_fileexp_afsTaggedPath, &item, "afsTaggedPath");\r\n}\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_afsTaggedPath_tp_tag, &tp_tag);\r\noffset =\r\ndissect_ndr_uint16 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_afsTaggedPath_tp_length, &tp_length);\r\nproto_tree_add_item (tree, hf_fileexp_afsTaggedPath_tp_chars, tvb, offset,\r\ntp_length, ENC_ASCII|ENC_NA);\r\ntp_chars = tvb_get_string_enc (wmem_packet_scope(), tvb, offset, 1025, ENC_ASCII);\r\noffset += 1025;\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " :tp_chars %s", tp_chars);\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_afsAcl (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *parent_tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree;\r\nint old_offset = offset;\r\nguint32 acl_len;\r\ne_guid_t uuid1, defaultcell;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\ntree = proto_tree_add_subtree (parent_tree, tvb, offset, -1, ett_fileexp_afsAcl, &item, "afsAcl");\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_acl_len,\r\n&acl_len);\r\noffset += 8;\r\noffset =\r\ndissect_ndr_uuid_t (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_afsacl_uuid1, &uuid1);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO,\r\n" - %08x-%04x-%04x-%02x%02x-%02x%02x%02x%02x%02x%02x",\r\nuuid1.data1, uuid1.data2, uuid1.data3, uuid1.data4[0],\r\nuuid1.data4[1], uuid1.data4[2], uuid1.data4[3],\r\nuuid1.data4[4], uuid1.data4[5], uuid1.data4[6],\r\nuuid1.data4[7]);\r\noffset =\r\ndissect_ndr_uuid_t (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_afsacl_defaultcell_uuid, &defaultcell);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO,\r\n" %08x-%04x-%04x-%02x%02x-%02x%02x%02x%02x%02x%02x",\r\ndefaultcell.data1, defaultcell.data2, defaultcell.data3,\r\ndefaultcell.data4[0], defaultcell.data4[1],\r\ndefaultcell.data4[2], defaultcell.data4[3],\r\ndefaultcell.data4[4], defaultcell.data4[5],\r\ndefaultcell.data4[6], defaultcell.data4[7]);\r\nif (acl_len < 38)\r\n{\r\nreturn offset;\r\n}\r\noffset += (acl_len - 38);\r\nproto_item_set_len (item, offset-old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_afsErrorStatus (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *parent_tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\nguint32 st;\r\nconst char *st_str;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree = proto_tree_add_subtree (parent_tree, tvb, offset, -1,\r\nett_fileexp_afsErrorStatus, &item, "afsErrorStatus");\r\n}\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_afserrorstatus_st,\r\n&st);\r\nst_str = val_to_str_ext (st, &dce_error_vals_ext, "%u");\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " st:%s ", st_str);\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_afsRecordLock (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *parent_tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\nguint16 l_type, l_whence;\r\nguint32 l_start_pos, l_end_pos, l_pid, l_sysid, l_fstype;\r\nguint32 l_start_pos_ext, l_end_pos_ext;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree = proto_tree_add_subtree (parent_tree, tvb, offset, -1,\r\nett_fileexp_afsRecordLock, &item, "afsRecordLock:");\r\n}\r\noffset =\r\ndissect_ndr_uint16 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_l_type,\r\n&l_type);\r\noffset =\r\ndissect_ndr_uint16 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_l_whence,\r\n&l_whence);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_l_start_pos, &l_start_pos);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_l_end_pos,\r\n&l_end_pos);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_l_pid,\r\n&l_pid);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_l_sysid,\r\n&l_sysid);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_l_fstype,\r\n&l_fstype);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_l_start_pos_ext, &l_start_pos_ext);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_l_end_pos_ext, &l_end_pos_ext);\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_afsstorestatus (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *parent_tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\nguint32 mask, modtime_sec, changetime_sec, accesstime_sec, devicenumber;\r\nguint32 clientspare1, devicenumberhighbits, spare1, spare2, spare3, spare4;\r\nguint32 spare5, spare6, accesstime_usec, changetime_usec, owner, group, mode;\r\nguint32 trunc_high, trunc_low, length_high, length_low, devicetype;\r\nguint32 cmask, modtime_usec;\r\ne_guid_t typeuuid;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree = proto_tree_add_subtree (parent_tree, tvb, offset, -1,\r\nett_fileexp_afsstorestatus, &item, "afsStoreStatus:");\r\n}\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_storestatus_mask, &mask);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_storestatus_modtime_sec, &modtime_sec);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_storestatus_modtime_usec, &modtime_usec);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_storestatus_accesstime_sec,\r\n&accesstime_sec);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_storestatus_accesstime_usec,\r\n&accesstime_usec);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_storestatus_changetime_sec,\r\n&changetime_sec);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_storestatus_changetime_usec,\r\n&changetime_usec);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_storestatus_owner, &owner);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_storestatus_group, &group);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_storestatus_mode, &mode);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_storestatus_trunc_high, &trunc_high);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_storestatus_trunc_low, &trunc_low);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_storestatus_length_high, &length_high);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_storestatus_length_low, &length_low);\r\noffset =\r\ndissect_ndr_uuid_t (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_storestatus_typeuuid, &typeuuid);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_storestatus_devicetype, &devicetype);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_storestatus_devicenumber, &devicenumber);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_storestatus_cmask, &cmask);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_storestatus_clientspare1, &clientspare1);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_storestatus_devicenumberhighbits,\r\n&devicenumberhighbits);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_storestatus_spare1, &spare1);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_storestatus_spare2, &spare2);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_storestatus_spare3, &spare3);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_storestatus_spare4, &spare4);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_storestatus_spare5, &spare5);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_storestatus_spare6, &spare6);\r\ncol_append_str (pinfo->cinfo, COL_INFO, " Mask=");\r\nif ((mask & AFS_SETMODTIME) == AFS_SETMODTIME)\r\n{\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, ":SETMODTIME-%u.%u",\r\nmodtime_sec, modtime_usec);\r\n}\r\nif ((mask & AFS_SETOWNER) == AFS_SETOWNER)\r\n{\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, ":SETOWNER-%u", owner);\r\n}\r\nif ((mask & AFS_SETGROUP) == AFS_SETGROUP)\r\n{\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, ":SETGROUP-%u", group);\r\n}\r\nif ((mask & AFS_SETMODE) == AFS_SETMODE)\r\n{\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, ":SETMODE-%o", mode);\r\n}\r\nif ((mask & AFS_SETACCESSTIME) == AFS_SETACCESSTIME)\r\n{\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, ":SETACCESSTIME-%u.%u",\r\naccesstime_sec, accesstime_usec);\r\n}\r\nif ((mask & AFS_SETCHANGETIME) == AFS_SETCHANGETIME)\r\n{\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, ":SETCHANGETIME-%u.%u",\r\nchangetime_sec, changetime_usec);\r\n}\r\nif ((mask & AFS_SETLENGTH) == AFS_SETLENGTH)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":SETLENGTH");\r\n}\r\nif ((mask & AFS_SETTYPEUUID) == AFS_SETTYPEUUID)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":SETTYPEUUID");\r\n}\r\nif ((mask & AFS_SETDEVNUM) == AFS_SETDEVNUM)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":SETDEVNUM");\r\n}\r\nif ((mask & AFS_SETMODEXACT) == AFS_SETMODEXACT)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":SETMODEXACT");\r\n}\r\nif ((mask & AFS_SETTRUNCLENGTH) == AFS_SETTRUNCLENGTH)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":SETTRUNCLENGTH");\r\n}\r\nif ((mask & AFS_SETCLIENTSPARE) == AFS_SETCLIENTSPARE)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":SETCLIENTSPARE");\r\n}\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_afstoken (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *parent_tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\nguint32 tokenid_hi, tokenid_low, expirationtime, type_hi, type_low;\r\nguint32 beginrange, endrange, beginrangeext, endrangeext, type;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree = proto_tree_add_subtree (parent_tree, tvb, offset, -1, ett_fileexp_afstoken, &item, "afsToken:");\r\n}\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_tokenid_hi,\r\n&tokenid_hi);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_tokenid_low, &tokenid_low);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_expirationtime, &expirationtime);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_type_hi,\r\n&type_hi);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_type_low,\r\n&type_low);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_beginrange,\r\n&beginrange);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_endrange,\r\n&endrange);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_beginrangeext, &beginrangeext);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_endrangeext, &endrangeext);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO,\r\n" :Tokenid:%u/%u ExpirationTime:%u beginrange:%u endrange:%u beginrangeext:%u endrangeext:%u",\r\ntokenid_hi, tokenid_low, expirationtime, beginrange,\r\nendrange, beginrangeext, endrangeext);\r\ntype = type_low;\r\ncol_append_str (pinfo->cinfo, COL_INFO, " Type=");\r\nif ((type & TKN_LOCK_READ) == TKN_LOCK_READ)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":LOCK_READ");\r\n}\r\nif ((type & TKN_LOCK_WRITE) == TKN_LOCK_WRITE)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":LOCK_WRITE");\r\n}\r\nif ((type & TKN_DATA_READ) == TKN_DATA_READ)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":DATA_READ");\r\n}\r\nif ((type & TKN_DATA_WRITE) == TKN_DATA_WRITE)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":DATA_WRITE");\r\n}\r\nif ((type & TKN_OPEN_READ) == TKN_OPEN_READ)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":OPEN_READ");\r\n}\r\nif ((type & TKN_OPEN_WRITE) == TKN_OPEN_WRITE)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":OPEN_WRITE");\r\n}\r\nif ((type & TKN_OPEN_SHARED) == TKN_OPEN_SHARED)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":OPEN_SHARED");\r\n}\r\nif ((type & TKN_OPEN_EXCLUSIVE) == TKN_OPEN_EXCLUSIVE)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":OPEN_EXCLUSIVE");\r\n}\r\nif ((type & TKN_OPEN_DELETE) == TKN_OPEN_DELETE)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":OPEN_DELETE");\r\n}\r\nif ((type & TKN_OPEN_PRESERVE) == TKN_OPEN_PRESERVE)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":OPEN_PRESERVE");\r\n}\r\nif ((type & TKN_STATUS_READ) == TKN_STATUS_READ)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":STATUS_READ");\r\n}\r\nif ((type & TKN_STATUS_WRITE) == TKN_STATUS_WRITE)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":STATUS_WRITE");\r\n}\r\nif ((type & TKN_OPEN_UNLINK) == TKN_OPEN_UNLINK)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":OPEN_UNLINK");\r\n}\r\nif ((type & TKN_SPOT_HERE) == TKN_SPOT_HERE)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":SPOT_HERE");\r\n}\r\nif ((type & TKN_SPOT_THERE) == TKN_SPOT_THERE)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":SPOT_THERE");\r\n}\r\nif ((type & TKN_OPEN_NO_READ) == TKN_OPEN_NO_READ)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":OPEN_NO_READ");\r\n}\r\nif ((type & TKN_OPEN_NO_WRITE) == TKN_OPEN_NO_WRITE)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":OPEN_NO_WRITE");\r\n}\r\nif ((type & TKN_OPEN_NO_UNLINK) == TKN_OPEN_NO_UNLINK)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":OPEN_NO_UNLINK");\r\n}\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_afstaggedname (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *parent_tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\nguint32 tn_tag;\r\nguint16 tn_length;\r\nconst guint8 *tn_string;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree = proto_tree_add_subtree (parent_tree, tvb, offset, -1,\r\nett_fileexp_afstaggedname, &item, "afsTaggedName:");\r\n}\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_tn_tag,\r\n&tn_tag);\r\noffset =\r\ndissect_ndr_uint16 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_tn_length,\r\n&tn_length);\r\nif (tn_length < 254)\r\n{\r\nproto_tree_add_item (tree, hf_fileexp_tn_string, tvb, offset,\r\ntn_length, ENC_ASCII|ENC_NA);\r\ntn_string = tvb_get_string_enc (wmem_packet_scope(), tvb, offset, 257, ENC_ASCII);\r\noffset += 257;\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " :tn_tag: %s", tn_string);\r\n}\r\nelse\r\n{\r\ncol_append_fstr (pinfo->cinfo, COL_INFO,\r\n" :FIXME!: Invalid string length of %u", tn_length);\r\n}\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_afsfidtaggedname (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *parent_tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree = proto_tree_add_subtree (parent_tree, tvb, offset, -1,\r\nett_fileexp_afsfidtaggedname, &item, "FidTaggedName:");\r\n}\r\noffset = dissect_afsFid (tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_afstaggedname (tvb, offset, pinfo, tree, di, drep);\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_minvvp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *parent_tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\nguint32 minvvp_high, minvvp_low;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree = proto_tree_add_subtree (parent_tree, tvb, offset, -1, ett_fileexp_minvvp, &item, "minVVp:");\r\n}\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_minvvp_high, &minvvp_high);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_minvvp_low,\r\n&minvvp_low);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " minVVp:%u/%u", minvvp_high,\r\nminvvp_low);\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_afsuuid (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *parent_tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\ne_guid_t uuid1;\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree = proto_tree_add_subtree (parent_tree, tvb, offset, -1, ett_fileexp_afsuuid, &item, "afsUUID:");\r\n}\r\noffset = dissect_ndr_uuid_t (tvb, offset, pinfo, tree, di, drep, hf_fileexp_afsuuid_uuid, &uuid1);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, ":%08x-%04x-%04x-%02x%02x-%02x%02x%02x%02x%02x%02x", uuid1.data1, uuid1.data2, uuid1.data3, uuid1.data4[0], uuid1.data4[1], uuid1.data4[2], uuid1.data4[3], uuid1.data4[4], uuid1.data4[5], uuid1.data4[6], uuid1.data4[7]);\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_offsetp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *parent_tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\nguint32 offsetp_high, offsetp_low;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree = proto_tree_add_subtree (parent_tree, tvb, offset, -1, ett_fileexp_offsetp, &item, "minVVp:");\r\n}\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_offsetp_high, &offsetp_high);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_offsetp_low,\r\n&offsetp_low);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " offsetp:%u/%u", offsetp_high,\r\noffsetp_low);\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_returntokenidp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *parent_tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\nguint32 returntokenidp_high, returntokenidp_low;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree = proto_tree_add_subtree (parent_tree, tvb, offset, -1, ett_fileexp_returntokenidp, &item, "returnTokenIDp:");\r\n}\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_returntokenidp_high, &returntokenidp_high);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_returntokenidp_low,\r\n&returntokenidp_low);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " returnTokenIDp:%u/%u", returntokenidp_high,\r\nreturntokenidp_low);\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_volsync (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *parent_tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\nguint32 volid_hi, volid_low, vv_hi, vv_low, vvage, vvpingage;\r\nguint32 vvspare1, vvspare2;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree = proto_tree_add_subtree (parent_tree, tvb, offset, -1,\r\nett_fileexp_volsync, &item, "AfsVolSync:");\r\n}\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_volid_hi,\r\n&volid_hi);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_volid_low,\r\n&volid_low);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_vv_hi,\r\n&vv_hi);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_vv_low,\r\n&vv_low);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_vvage,\r\n&vvage);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_vvpingage,\r\n&vvpingage);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_vvspare1,\r\n&vvspare1);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_vvspare2,\r\n&vvspare2);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO,\r\n" volid_hi:%u volid_low:%u vv_hi:%u vv_low:%u vvage:%u vvpingage:%u vvpspare1:%u vvspare2:%u",\r\nvolid_hi, volid_low, vv_hi, vv_low, vvage, vvpingage,\r\nvvspare1, vvspare2);\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_afsFlags (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *parent_tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\nguint32 flags;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree = proto_tree_add_subtree (parent_tree, tvb, offset, -1, ett_fileexp_afsflags, &item, "AfsFlags:");\r\n}\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_flags,\r\n&flags);\r\nif (flags)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, " Flags=");\r\nif ((flags & AFS_FLAG_RETURNTOKEN) == AFS_FLAG_RETURNTOKEN)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":RETURNTOKEN");\r\n}\r\nif ((flags & AFS_FLAG_TOKENJUMPQUEUE) == AFS_FLAG_TOKENJUMPQUEUE)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":TOKENJUMPQUEUE");\r\n}\r\nif ((flags & AFS_FLAG_SKIPTOKEN) == AFS_FLAG_SKIPTOKEN)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":SKIPTOKEN");\r\n}\r\nif ((flags & AFS_FLAG_NOOPTIMISM) == AFS_FLAG_NOOPTIMISM)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":NOOPTIMISM");\r\n}\r\nif ((flags & AFS_FLAG_TOKENID) == AFS_FLAG_TOKENID)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":TOKENID");\r\n}\r\nif ((flags & AFS_FLAG_RETURNBLOCKER) == AFS_FLAG_RETURNBLOCKER)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":RETURNBLOCKER");\r\n}\r\nif ((flags & AFS_FLAG_ASYNCGRANT) == AFS_FLAG_ASYNCGRANT)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":ASYNCGRANT");\r\n}\r\nif ((flags & AFS_FLAG_NOREVOKE) == AFS_FLAG_NOREVOKE)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":NOREVOKE");\r\n}\r\nif ((flags & AFS_FLAG_MOVE_REESTABLISH) == AFS_FLAG_MOVE_REESTABLISH)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":MOVE_REESTABLISH");\r\n}\r\nif ((flags & AFS_FLAG_SERVER_REESTABLISH) ==\r\nAFS_FLAG_SERVER_REESTABLISH)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":SERVER_REESTABLISH");\r\n}\r\nif ((flags & AFS_FLAG_NO_NEW_EPOCH) == AFS_FLAG_NO_NEW_EPOCH)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":NO_NEW_EPOCH");\r\n}\r\nif ((flags & AFS_FLAG_MOVE_SOURCE_OK) == AFS_FLAG_MOVE_SOURCE_OK)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":MOVE_SOURCE_OK");\r\n}\r\nif ((flags & AFS_FLAG_SYNC) == AFS_FLAG_SYNC)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":SYNC");\r\n}\r\nif ((flags & AFS_FLAG_ZERO) == AFS_FLAG_ZERO)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":ZERO");\r\n}\r\nif ((flags & AFS_FLAG_SKIPSTATUS) == AFS_FLAG_SKIPSTATUS)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":SKIPSTATUS");\r\n}\r\nif ((flags & AFS_FLAG_FORCEREVOCATIONS) == AFS_FLAG_FORCEREVOCATIONS)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":FORCEREVOCATIONS");\r\n}\r\nif ((flags & AFS_FLAG_FORCEVOLQUIESCE) == AFS_FLAG_FORCEVOLQUIESCE)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":FORCEVOLQUIESCE");\r\n}\r\nif ((flags & AFS_FLAG_SEC_SERVICE) == AFS_FLAG_SEC_SERVICE)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":SEC_SERVICE");\r\n}\r\nif ((flags & AFS_FLAG_CONTEXT_NEW_ACL_IF) ==\r\nAFS_FLAG_CONTEXT_NEW_ACL_IF)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":CONTEXT_NEW_ACL_IF");\r\n}\r\n}\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_fetchstatus (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *parent_tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\nguint32 interfaceversion, filetype, linkcount, length_high, length_low;\r\nguint32 dataversion_high, dataversion_low, author, owner, group, calleraccess;\r\nguint32 anonymousaccess, aclexpirationtime, mode, parentvnode, parentunique;\r\nguint32 modtime_sec, modtime_msec, changetime_sec, changetime_msec;\r\nguint32 accesstime_sec, accesstime_msec, servermodtime_msec, servermodtime_sec;\r\nguint32 devicenumber, blocksused, clientspare1, devicenumberhighbits;\r\nguint32 agtypeunique, himaxspare, lomaxspare, pathconfspare, spare4;\r\nguint32 spare5, spare6;\r\ne_guid_t typeuuid, objectuuid;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree = proto_tree_add_subtree (parent_tree, tvb, offset, -1,\r\nett_fileexp_fetchstatus, &item, "FetchStatus:");\r\n}\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_interfaceversion, &interfaceversion);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_filetype,\r\n&filetype);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_linkcount,\r\n&linkcount);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_length_high, &length_high);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_length_low,\r\n&length_low);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_dataversion_high, &dataversion_high);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_dataversion_low, &dataversion_low);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_author,\r\n&author);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_owner,\r\n&owner);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_group,\r\n&group);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_calleraccess, &calleraccess);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_anonymousaccess, &anonymousaccess);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_aclexpirationtime, &aclexpirationtime);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_mode,\r\n&mode);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_parentvnode, &parentvnode);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_parentunique, &parentunique);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_modtime_sec, &modtime_sec);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_modtime_msec, &modtime_msec);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_changetime_sec, &changetime_sec);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_changetime_msec, &changetime_msec);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_accesstime_sec, &accesstime_sec);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_accesstime_msec, &accesstime_msec);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_servermodtime_sec, &servermodtime_sec);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_servermodtime_msec, &servermodtime_msec);\r\noffset =\r\ndissect_ndr_uuid_t (tvb, offset, pinfo, tree, di, drep, hf_fileexp_typeuuid,\r\n&typeuuid);\r\noffset =\r\ndissect_ndr_uuid_t (tvb, offset, pinfo, tree, di, drep, hf_fileexp_objectuuid,\r\n&objectuuid);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_devicenumber, &devicenumber);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_blocksused,\r\n&blocksused);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_clientspare1, &clientspare1);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_devicenumberhighbits,\r\n&devicenumberhighbits);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_agtypeunique, &agtypeunique);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_himaxspare,\r\n&himaxspare);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_lomaxspare,\r\n&lomaxspare);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_pathconfspare, &pathconfspare);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_spare4,\r\n&spare4);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_spare5,\r\n&spare5);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_spare6,\r\n&spare6);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO,\r\n" :interfacever:%u filetype:%u linkcount:%u length:%u dataver:%u author:%u owner:%u group:%u calleraccess:%u anonaccess:%u aclexpire:%u mode:%u parentvnode:%u parentunique:%u modtimesec:%u changetime_sec:%u accesstime_sec:%u servermodtimesec:%u devicenumber:%u blocksused:%u clientspare:%u devicehighbits:%u agtypeunique:%u",\r\ninterfaceversion, filetype, linkcount, length_low,\r\ndataversion_low, author, owner, group, calleraccess,\r\nanonymousaccess, aclexpirationtime, mode, parentvnode,\r\nparentunique, modtime_sec, changetime_sec,\r\naccesstime_sec, servermodtime_sec, devicenumber,\r\nblocksused, clientspare1, devicenumberhighbits,\r\nagtypeunique);\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_afsReturnDesc (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *parent_tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\nguint32 tokenid_high, tokenid_low, type_high, type_low;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree = proto_tree_add_subtree (parent_tree, tvb, offset, -1,\r\nett_fileexp_afsReturnDesc, &item, "afsReturnDesc:");\r\n}\r\noffset = dissect_afsFid ( tvb, offset, pinfo, tree, di, drep);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_afsreturndesc_tokenid_high, &tokenid_high);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_afsreturndesc_tokenid_low, &tokenid_low);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_afsreturndesc_type_high, &type_high);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_afsreturndesc_type_low, &type_low);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " TokenId:%u/%u Type:%u/%u",\r\ntokenid_high, tokenid_low, type_high, type_low);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFlags,\r\nNDR_POINTER_REF, "afsFlags: ", -1);\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_afsReturns (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_ucvarray (tvb, offset, pinfo, tree, di, drep,\r\ndissect_afsReturnDesc);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_afsBulkStat (tvbuff_t *tvb _U_, int offset,\r\npacket_info *pinfo _U_, proto_tree *tree _U_,\r\ndcerpc_info *di _U_, guint8 *drep _U_)\r\n{\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_removefile_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep,\r\ndissect_afsfidtaggedname, NDR_POINTER_REF,\r\n"afsFidTaggedName: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_returntokenidp,\r\nNDR_POINTER_REF, "afsReturnTokenIDp:", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_minvvp,\r\nNDR_POINTER_REF, "afsMinVVp:", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFlags,\r\nNDR_POINTER_REF, "afsFlags:", -1);\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_storedata_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 position_high, position_low, length;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep,\r\ndissect_afsstorestatus, NDR_POINTER_REF,\r\n"afsStoreStatus:", -1);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_position_high, &position_high);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_position_low, &position_low);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_length, &length);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " Position:%u/%u Length:%u",\r\nposition_high, position_low, length);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_minvvp,\r\nNDR_POINTER_REF, "MinVVp:", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFlags,\r\nNDR_POINTER_REF, "afsFlags:", -1);\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_gettoken_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afstoken,\r\nNDR_POINTER_REF, "afsToken: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_minvvp,\r\nNDR_POINTER_REF, "MinVVp:", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFlags,\r\nNDR_POINTER_REF, "afsFlags:", -1);\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_gettoken_resp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afstoken,\r\nNDR_POINTER_REF, "afsToken: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep,\r\ndissect_afsRecordLock, NDR_POINTER_REF,\r\n"afsRecordLock: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "afsFetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_volsync,\r\nNDR_POINTER_REF, "VolSync: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep,\r\ndissect_afsErrorStatus, NDR_POINTER_REF,\r\n"afsErrorStatus: ", -1);\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_lookuproot_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_minvvp,\r\nNDR_POINTER_REF, "MinVVp:", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFlags,\r\nNDR_POINTER_REF, "afsFlags:", -1);\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_fetchdata_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 position_high, position_low, length;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_minvvp,\r\nNDR_POINTER_REF, "MinVVp:", -1);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_position_high, &position_high);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_position_low, &position_low);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_length, &length);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " Position:%u/%u Length:%u",\r\nposition_high, position_low, length);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFlags,\r\nNDR_POINTER_REF, "afsFlags:", -1);\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_fetchacl_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 acltype;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_acltype,\r\n&acltype);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_minvvp,\r\nNDR_POINTER_REF, "MinVVp:", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFlags,\r\nNDR_POINTER_REF, "afsFlags:", -1);\r\nif (acltype)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO,\r\n" :copy the ACL from specified fid:");\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_fetchstatus_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_minvvp,\r\nNDR_POINTER_REF, "MinVVp:", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFlags,\r\nNDR_POINTER_REF, "afsFlags:", -1);\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_storeacl_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 acltype;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsAcl,\r\nNDR_POINTER_REF, "afsAcl: ", -1);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_acltype,\r\n&acltype);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_minvvp,\r\nNDR_POINTER_REF, "MinVVp:", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFlags,\r\nNDR_POINTER_REF, "afsFlags:", -1);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " aclType:%u",acltype);\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_storestatus_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep,\r\ndissect_afsstorestatus, NDR_POINTER_REF,\r\n"afsStoreStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_minvvp,\r\nNDR_POINTER_REF, "MinVVp:", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFlags,\r\nNDR_POINTER_REF, "afsFlags:", -1);\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_createfile_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep,\r\ndissect_afstaggedname, NDR_POINTER_REF,\r\n"afsTaggedName: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep,\r\ndissect_afsstorestatus, NDR_POINTER_REF,\r\n"afsStoreStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_minvvp,\r\nNDR_POINTER_REF, "MinVVp:", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFlags,\r\nNDR_POINTER_REF, "afsFlags:", -1);\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_rename_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep,\r\ndissect_afsfidtaggedname, NDR_POINTER_REF,\r\n"afsFidTaggedName: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep,\r\ndissect_afstaggedname, NDR_POINTER_REF,\r\n"afsFidTaggedName: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep,\r\ndissect_returntokenidp, NDR_POINTER_REF,\r\n"afsReturnTokenIDp: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep,\r\ndissect_minvvp, NDR_POINTER_REF,\r\n"afsminVVp: ", -1);\r\noffset = dissect_afsFlags (tvb, offset, pinfo, tree, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_symlink_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep,\r\ndissect_afstaggedname, NDR_POINTER_REF,\r\n"afsTaggedName: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep,\r\ndissect_afsTaggedPath, NDR_POINTER_REF,\r\n"afsTaggedPath: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep,\r\ndissect_afsstorestatus, NDR_POINTER_REF,\r\n"afsStoreStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_minvvp,\r\nNDR_POINTER_REF, "MinVVp:", -1);\r\noffset = dissect_afsFlags (tvb, offset, pinfo, tree, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_readdir_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 size;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_offsetp,\r\nNDR_POINTER_REF, "Offsetp: ", -1);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_readdir_size, &size);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " Size:%u", size);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_minvvp,\r\nNDR_POINTER_REF, "MinVVp:", -1);\r\noffset = dissect_afsFlags ( tvb, offset, pinfo, tree, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_makedir_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep,\r\ndissect_afstaggedname, NDR_POINTER_REF,\r\n"afsTaggedName: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep,\r\ndissect_afsstorestatus, NDR_POINTER_REF,\r\n"afsStoreStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_minvvp,\r\nNDR_POINTER_REF, "MinVVp:", -1);\r\noffset = dissect_afsFlags ( tvb, offset, pinfo, tree, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_removedir_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 returntokenidp_high, returntokenidp_low;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep,\r\ndissect_afsfidtaggedname, NDR_POINTER_REF,\r\n"afsFidTaggedName: ", -1);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_returntokenidp_high, &returntokenidp_high);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_returntokenidp_low, &returntokenidp_low);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " returnTokenIDp:%u/%u",\r\nreturntokenidp_high, returntokenidp_low);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_minvvp,\r\nNDR_POINTER_REF, "MinVVp:", -1);\r\noffset = dissect_afsFlags ( tvb, offset, pinfo, tree, di, drep );\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_lookup_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep,\r\ndissect_afstaggedname, NDR_POINTER_REF,\r\n"afsTaggedName: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_minvvp,\r\nNDR_POINTER_REF, "MinVVp:", -1);\r\noffset = dissect_afsFlags ( tvb, offset, pinfo, tree, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_lookup_resp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "FetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "FetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afstoken,\r\nNDR_POINTER_REF, "afsToken: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_volsync,\r\nNDR_POINTER_REF, "VolSync: ", -1);\r\nMACRO_ST_CLEAR ("Lookup reply");\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_makemountpoint_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nguint16 type;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep,\r\ndissect_afstaggedname, NDR_POINTER_REF,\r\n"afsTaggedName: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep,\r\ndissect_afstaggedname, NDR_POINTER_REF,\r\n"afsTaggedName: ", -1);\r\noffset =\r\ndissect_ndr_uint16 (tvb, offset, pinfo, tree, di, drep, hf_fileexp_fstype,\r\n&type);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep,\r\ndissect_afstaggedname, NDR_POINTER_REF,\r\n"afsTaggedName: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep,\r\ndissect_afsstorestatus, NDR_POINTER_REF,\r\n"afsStoreStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_minvvp,\r\nNDR_POINTER_REF, "MinVVp:", -1);\r\noffset = dissect_afsFlags (tvb, offset, pinfo, tree, di, drep);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " Type:%u", type);\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_setcontext_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 epochtime, clientsizesattrs, parm7;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_dcerpc_time_t (tvb, offset, pinfo, tree, drep,\r\nhf_fileexp_setcontext_rqst_epochtime, &epochtime);\r\noffset = dissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsNetData,\r\nNDR_POINTER_REF, "afsNetData:", -1);\r\noffset = dissect_afsFlags (tvb, offset, pinfo, tree, di, drep);\r\ncol_append_str (pinfo->cinfo, COL_INFO, " setObjectID");\r\noffset = dissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsuuid,\r\nNDR_POINTER_REF, "afsUUID:", -1);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_setcontext_rqst_clientsizesattrs,\r\n&clientsizesattrs);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_setcontext_rqst_parm7, &parm7);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " epochTime:%u clientSizesAttrs:%u parm7:%u", epochtime, clientsizesattrs, parm7);\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_setcontext_resp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nMACRO_ST_CLEAR ("SetContext reply");\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_lookuproot_resp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "FetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afstoken,\r\nNDR_POINTER_REF, "afsToken: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_volsync,\r\nNDR_POINTER_REF, "VolSync: ", -1);\r\nMACRO_ST_CLEAR ("LookupRoot reply");\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_fetchdata_resp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 pipe_t_size;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_fetchdata_pipe_t_size, &pipe_t_size);\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_fetchacl_resp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsAcl,\r\nNDR_POINTER_REF, "afsAcl: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "FetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_volsync,\r\nNDR_POINTER_REF, "VolSync: ", -1);\r\nMACRO_ST_CLEAR ("FetchAcl reply");\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_fetchstatus_resp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "FetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afstoken,\r\nNDR_POINTER_REF, "afsToken: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_volsync,\r\nNDR_POINTER_REF, "VolSync: ", -1);\r\nMACRO_ST_CLEAR ("FetchStatus reply");\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_storedata_resp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "FetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_volsync,\r\nNDR_POINTER_REF, "VolSync: ", -1);\r\nMACRO_ST_CLEAR ("StoreData reply");\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_storeacl_resp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "FetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_volsync,\r\nNDR_POINTER_REF, "VolSync: ", -1);\r\nMACRO_ST_CLEAR ("StoreAcl reply");\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_storestatus_resp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "FetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_volsync,\r\nNDR_POINTER_REF, "VolSync: ", -1);\r\nMACRO_ST_CLEAR ("StoreStatus reply");\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_removefile_resp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "FetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "FetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_volsync,\r\nNDR_POINTER_REF, "VolSync: ", -1);\r\nMACRO_ST_CLEAR ("RemoveFile reply");\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_createfile_resp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "FetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "FetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afstoken,\r\nNDR_POINTER_REF, "afsToken: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_volsync,\r\nNDR_POINTER_REF, "VolSync: ", -1);\r\nMACRO_ST_CLEAR ("CreateFile reply");\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_rename_resp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "FetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "FetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "FetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "FetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_volsync,\r\nNDR_POINTER_REF, "VolSync: ", -1);\r\nMACRO_ST_CLEAR ("Rename reply");\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_symlink_resp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "FetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "FetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afstoken,\r\nNDR_POINTER_REF, "afsToken: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_volsync,\r\nNDR_POINTER_REF, "VolSync: ", -1);\r\nMACRO_ST_CLEAR ("Symlink reply");\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_hardlink_resp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "FetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "FetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_volsync,\r\nNDR_POINTER_REF, "VolSync: ", -1);\r\nMACRO_ST_CLEAR ("Hardlink reply");\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_hardlink_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep,\r\ndissect_afstaggedname, NDR_POINTER_REF,\r\n"afsTaggedName: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_minvvp,\r\nNDR_POINTER_REF, "MinVVp:", -1);\r\noffset = dissect_afsFlags ( tvb, offset, pinfo, tree, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_makedir_resp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "FetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "FetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afstoken,\r\nNDR_POINTER_REF, "afsToken: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_volsync,\r\nNDR_POINTER_REF, "VolSync: ", -1);\r\nMACRO_ST_CLEAR ("MakeDir reply");\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_removedir_resp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "FetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "FetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_volsync,\r\nNDR_POINTER_REF, "VolSync: ", -1);\r\nMACRO_ST_CLEAR ("RemoveDir reply");\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_readdir_resp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 nextoffsetp_high, nextoffsetp_low;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_nextoffsetp_high, &nextoffsetp_high);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_nextoffsetp_low, &nextoffsetp_low);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " NextOffsetp:%u/%u",\r\nnextoffsetp_high, nextoffsetp_low);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_volsync,\r\nNDR_POINTER_REF, "VolSync: ", -1);\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_releasetokens_resp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nMACRO_ST_CLEAR ("ReleaseTokens reply");\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_releasetokens_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsReturns,\r\nNDR_POINTER_REF, "afsReturns: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFlags,\r\nNDR_POINTER_REF, "afsFlags: ", -1);\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_gettime_resp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 secondsp, usecondsp, syncdistance, syncdispersion;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_gettime_secondsp, &secondsp);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_gettime_usecondsp, &usecondsp);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_gettime_syncdistance, &syncdistance);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_gettime_syncdispersion, &syncdispersion);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " Secondsp:%u Usecondsp:%u SyncDistance:/%u SyncDispersion:%u", secondsp, usecondsp, syncdistance, syncdispersion);\r\nMACRO_ST_CLEAR ("GetTime reply");\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_gettime_rqst (tvbuff_t *tvb _U_, int offset,\r\npacket_info *pinfo _U_, proto_tree *tree _U_,\r\ndcerpc_info *di, guint8 *drep _U_)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_processquota_resp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset += 92;\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "FetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_volsync,\r\nNDR_POINTER_REF, "VolSync: ", -1);\r\nMACRO_ST_CLEAR ("ProcessQuota reply");\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_processquota_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_minvvp,\r\nNDR_POINTER_REF, "MinVVp:", -1);\r\noffset = dissect_afsFlags ( tvb, offset, pinfo, tree, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_getserverinterfaces_rqst (tvbuff_t *tvb _U_, int offset,\r\npacket_info *pinfo _U_, proto_tree *tree _U_,\r\ndcerpc_info *di, guint8 *drep _U_)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_getserverinterfaces_resp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nMACRO_ST_CLEAR ("GetServerInterfaces reply");\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_setparams_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset = dissect_afsFlags ( tvb, offset, pinfo, tree, di, drep);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep,\r\ndissect_afsConnParams, NDR_POINTER_REF,\r\n"afsConnParams:", -1);\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_setparams_resp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep,\r\ndissect_afsConnParams, NDR_POINTER_REF,\r\n"afsConnParams:", -1);\r\nMACRO_ST_CLEAR ("SetParams reply");\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_makemountpoint_resp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "FetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "FetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_volsync,\r\nNDR_POINTER_REF, "VolSync: ", -1);\r\nMACRO_ST_CLEAR ("MakeMountPoint reply");\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_getstatistics_rqst (tvbuff_t *tvb _U_, int offset,\r\npacket_info *pinfo _U_, proto_tree *tree _U_,\r\ndcerpc_info *di, guint8 *drep _U_)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_getstatistics_resp (tvbuff_t *tvb _U_, int offset,\r\npacket_info *pinfo _U_, proto_tree *tree _U_,\r\ndcerpc_info *di, guint8 *drep _U_)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_bulkfetchvv_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 cellidp_high, cellidp_low, numvols, spare1, spare2;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_cellidp_high, &cellidp_high);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_cellidp_low, &cellidp_low);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " CellIDp:%u/%u", cellidp_high,\r\ncellidp_low);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_bulkfetchvv_numvols, &numvols);\r\noffset = dissect_afsFlags (tvb, offset, pinfo, tree, di, drep);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_bulkfetchvv_spare1, &spare1);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_bulkfetchvv_spare2, &spare2);\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_bulkfetchvv_resp (tvbuff_t *tvb _U_, int offset,\r\npacket_info *pinfo _U_, proto_tree *tree _U_,\r\ndcerpc_info *di, guint8 *drep _U_)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_bulkkeepalive_resp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 spare4;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_bulkkeepalive_spare4, &spare4);\r\nMACRO_ST_CLEAR ("BulkKeepAlive reply");\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_bulkkeepalive_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 numexecfids, spare1, spare2;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_bulkkeepalive_numexecfids, &numexecfids);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFlags,\r\nNDR_POINTER_REF, "afsFlags:", -1);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_bulkkeepalive_spare1, &spare1);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_bulkkeepalive_spare2, &spare2);\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_bulkfetchstatus_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 offsetp_high, offsetp_low, size;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsFid,\r\nNDR_POINTER_REF, "afsFid: ", -1);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_offsetp_high, &offsetp_high);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_offsetp_low, &offsetp_low);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " Offsetp:%u/%u", offsetp_high,\r\noffsetp_low);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_bulkfetchstatus_size, &size);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_minvvp,\r\nNDR_POINTER_REF, "MinVVp:", -1);\r\noffset = dissect_afsFlags (tvb, offset, pinfo, tree, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nfileexp_dissect_bulkfetchstatus_resp (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree,\r\ndcerpc_info *di, guint8 *drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afsBulkStat,\r\nNDR_POINTER_REF, "BulkStat: ", -1);\r\n#if 0\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_nextoffsetp_high, &nextoffsetp_high);\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_fileexp_nextoffsetp_low, &nextoffsetp_low);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " NextOffsetp:%u/%u",\r\nnextoffsetp_high, nextoffsetp_low);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_fetchstatus,\r\nNDR_POINTER_REF, "FetchStatus: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_afstoken,\r\nNDR_POINTER_REF, "afsToken: ", -1);\r\noffset =\r\ndissect_ndr_pointer (tvb, offset, pinfo, tree, di, drep, dissect_volsync,\r\nNDR_POINTER_REF, "VolSync: ", -1);\r\n#endif\r\nreturn offset;\r\n}\r\nvoid\r\nproto_register_fileexp (void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_error_st,\r\n{ "AFS4Int Error Status Code", "fileexp.st",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_flags,\r\n{ "DFS Flags", "fileexp.flags",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_tn_string,\r\n{ "String", "fileexp.string",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_opnum,\r\n{ "Operation", "fileexp.opnum",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_setcontext_rqst_epochtime,\r\n{ "EpochTime:", "fileexp.setcontext_rqst_epochtime",\r\nFT_ABSOLUTE_TIME, ABSOLUTE_TIME_LOCAL, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_setcontext_rqst_clientsizesattrs,\r\n{ "ClientSizeAttrs:", "fileexp.setcontext_clientsizesattrs",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_setcontext_rqst_parm7,\r\n{ "Parm7:", "fileexp.setcontext.parm7",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_acl_len,\r\n{ "Acl Length", "fileexp.acl_len",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_acltype,\r\n{ "Acl type", "fileexp.acltype",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_minvvp_high,\r\n{ "minVVp high", "fileexp.minvvp_high",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_minvvp_low,\r\n{ "minVVp low", "fileexp.minvvp_low",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_accesstime_msec,\r\n{ "Access time (msec)", "fileexp.accesstime_msec",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_accesstime_sec,\r\n{ "Access time (sec)", "fileexp.accesstime_sec",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_aclexpirationtime,\r\n{ "Acl expiration time", "fileexp.aclexpirationtime",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_agtypeunique,\r\n{ "agtypeunique", "fileexp.agtypeunique",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_anonymousaccess,\r\n{ "Anonymous Access", "fileexp.anonymousaccess",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_author,\r\n{ "Author", "fileexp.author",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_blocksused,\r\n{ "Blocks used", "fileexp.blocksused",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_calleraccess,\r\n{ "Caller access", "fileexp.calleraccess",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_changetime_msec,\r\n{ "Change time (msec)", "fileexp.changetime_msec",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_changetime_sec,\r\n{ "Change time (sec)", "fileexp.changetime_sec",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_clientspare1,\r\n{ "Client spare1", "fileexp.clientspare1",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_dataversion_high,\r\n{ "Data version (high)", "fileexp.dataversion_high",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_dataversion_low,\r\n{ "Data version (low)", "fileexp.dataversion_low",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_devicenumber,\r\n{ "Device number", "fileexp.devicenumber",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_devicenumberhighbits,\r\n{ "Device number high bits", "fileexp.devicenumberhighbits",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_filetype,\r\n{ "File type", "fileexp.filetype",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_group,\r\n{ "Group", "fileexp.group",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_himaxspare,\r\n{ "Hi max spare", "fileexp.himaxspare",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_interfaceversion,\r\n{ "Interface version", "fileexp.interfaceversion",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_length_high,\r\n{ "Length high", "fileexp.length_high",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_length_low,\r\n{ "Length low", "fileexp.length_low",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_linkcount,\r\n{ "Link count", "fileexp.linkcount",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_lomaxspare,\r\n{ "Lo max spare", "fileexp.lomaxspare",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_mode,\r\n{ "Mode", "fileexp.mode",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_modtime_msec,\r\n{ "Modify time (msec)", "fileexp.modtime_msec",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_modtime_sec,\r\n{ "Modify time (sec)", "fileexp.modtime_sec",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_objectuuid,\r\n{ "Object uuid", "fileexp.objectuuid",\r\nFT_GUID, BASE_NONE, NULL, 0x0,\r\n"UUID", HFILL}\r\n},\r\n{ &hf_fileexp_owner,\r\n{ "Owner", "fileexp.owner",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_parentunique,\r\n{ "Parent unique", "fileexp.parentunique",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_parentvnode,\r\n{ "Parent vnode", "fileexp.parentvnode",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_pathconfspare,\r\n{ "Path conf spare", "fileexp.pathconfspare",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_servermodtime_msec,\r\n{ "Server modify time (msec)", "fileexp.servermodtime_msec",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_servermodtime_sec,\r\n{ "Server modify time (sec)", "fileexp.servermodtime_sec",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_spare4,\r\n{ "Spare4", "fileexp.spare4",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_spare5,\r\n{ "Spare5", "fileexp.spare5",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_spare6,\r\n{ "Spare6", "fileexp.spare6",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_typeuuid,\r\n{ "Type uuid", "fileexp.typeuuid",\r\nFT_GUID, BASE_NONE, NULL, 0x0,\r\n"UUID", HFILL}\r\n},\r\n{ &hf_fileexp_volid_hi,\r\n{ "Vol id hi", "fileexp.volid_hi",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_volid_low,\r\n{ "Vol id low", "fileexp.volid_low",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_vvage,\r\n{ "Vvage", "fileexp.vvage",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_vv_hi,\r\n{ "Vv hi", "fileexp.vv_hi",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_vv_low,\r\n{ "Vv low", "fileexp.vv_low",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_vvpingage,\r\n{ "Vv pingage", "fileexp.vvpingage",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_vvspare1,\r\n{ "Vv spare1", "fileexp.vvspare1",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_vvspare2,\r\n{ "Vv spare2", "fileexp.vvspare2",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_beginrange,\r\n{ "Begin range", "fileexp.beginrange",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_beginrangeext,\r\n{ "Begin range ext", "fileexp.beginrangeext",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_endrange,\r\n{ "End range", "fileexp.endrange",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_endrangeext,\r\n{ "End range ext", "fileexp.endrangeext",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_expirationtime,\r\n{ "Expiration time", "fileexp.expirationtime",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_tokenid_hi,\r\n{ "Tokenid hi", "fileexp.tokenid_hi",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_tokenid_low,\r\n{ "Tokenid low", "fileexp.tokenid_low",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_type_hi,\r\n{ "Type hi", "fileexp.type_hi",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_type_low,\r\n{ "Type low", "fileexp.type_low",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_tn_length,\r\n{ "Tn length", "fileexp.tn_length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_tn_tag,\r\n{ "Tn tag", "fileexp.tn_tag",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_storestatus_accesstime_sec,\r\n{ "Store status access time (sec)", "fileexp.storestatus_accesstime_sec",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_storestatus_accesstime_usec,\r\n{ "Store status access time (usec)", "fileexp.storestatus_accesstime_usec",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_storestatus_changetime_sec,\r\n{ "Store status change time (sec)", "fileexp.storestatus_changetime_sec",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_storestatus_changetime_usec,\r\n{ "Store status change time (usec)", "fileexp.storestatus_changetime_usec",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_storestatus_clientspare1,\r\n{ "Store Status client spare1", "fileexp.storestatus_clientspare1",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_storestatus_cmask,\r\n{ "Store status cmask", "fileexp.storestatus_cmask",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_storestatus_devicenumber,\r\n{ "Store status device number", "fileexp.storestatus_devicenumber",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_storestatus_devicenumberhighbits,\r\n{ "Store status device number high bits", "fileexp.storestatus_devicenumberhighbits",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_storestatus_devicetype,\r\n{ "Store status device type", "fileexp.storestatus_devicetype",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_storestatus_group,\r\n{ "Store status group", "fileexp.storestatus_group",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_storestatus_length_high,\r\n{ "Store status length high", "fileexp.storestatus_length_high",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_storestatus_length_low,\r\n{ "Store status length low", "fileexp.storestatus_length_low",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_storestatus_mask,\r\n{ "Store status mask", "fileexp.storestatus_mask",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_storestatus_mode,\r\n{ "Store status mode", "fileexp.storestatus_mode",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_storestatus_modtime_sec,\r\n{ "Store status modify time (sec)", "fileexp.storestatus_modtime_sec",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_storestatus_modtime_usec,\r\n{ "Store status modify time (usec)", "fileexp.storestatus_modtime_usec",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_storestatus_owner,\r\n{ "Store status owner", "fileexp.storestatus_owner",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_storestatus_spare1,\r\n{ "Store status spare1", "fileexp.storestatus_spare1",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_storestatus_spare2,\r\n{ "Store status spare2", "fileexp.storestatus_spare2",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_storestatus_spare3,\r\n{ "Store status spare3", "fileexp.storestatus_spare3",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_storestatus_spare4,\r\n{ "Store status spare4", "fileexp.storestatus_spare4",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_storestatus_spare5,\r\n{ "Store status spare5", "fileexp.storestatus_spare5",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_storestatus_spare6,\r\n{ "Store status spare6", "fileexp.storestatus_spare6",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_storestatus_trunc_high,\r\n{ "Store status trunc high", "fileexp.storestatus_trunc_high",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_storestatus_trunc_low,\r\n{ "Store status trunc low", "fileexp.storestatus_trunc_low",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_storestatus_typeuuid,\r\n{ "Store status type uuid", "fileexp.storestatus_typeuuid",\r\nFT_GUID, BASE_NONE, NULL, 0x0,\r\n"UUID", HFILL}\r\n},\r\n{ &hf_fileexp_l_end_pos,\r\n{ "l_end_pos", "fileexp.l_end_pos",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_l_end_pos_ext,\r\n{ "l_end_pos_ext", "fileexp.l_end_pos_ext",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_l_fstype,\r\n{ "l_fstype", "fileexp.l_fstype",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_l_pid,\r\n{ "l_pid", "fileexp.l_pid",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_l_start_pos,\r\n{ "l_start_pos", "fileexp.l_start_pos",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_l_start_pos_ext,\r\n{ "l_start_pos_ext", "fileexp.l_start_pos_ext",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_l_sysid,\r\n{ "l_sysid", "fileexp.l_sysid",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_l_type,\r\n{ "l_type", "fileexp.l_type",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_l_whence,\r\n{ "l_whence", "fileexp.l_whence",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_afsconnparams_mask,\r\n{ "afs conn params mask", "fileexp.afs_connparams_mask",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_afsconnparams_values,\r\n{ "afs conn params values", "fileexp.afs_connparams_values",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_afsFid_cell_high,\r\n{ "Cell High", "fileexp.afsFid.cell_high",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\n"afsFid Cell High", HFILL}\r\n},\r\n{ &hf_fileexp_afsFid_cell_low,\r\n{ "Cell Low", "fileexp.afsFid.cell_low",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\n"afsFid Cell Low", HFILL}\r\n},\r\n{ &hf_fileexp_afsFid_volume_high,\r\n{ "Volume High", "fileexp.afsFid.volume_high",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\n"afsFid Volume High", HFILL}\r\n},\r\n{ &hf_fileexp_afsFid_volume_low,\r\n{ "Volume Low", "fileexp.afsFid.volume_low",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\n"afsFid Volume Low", HFILL}\r\n},\r\n{ &hf_fileexp_afsFid_Vnode,\r\n{ "Vnode", "fileexp.afsFid.Vnode",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\n"afsFid Vnode", HFILL}\r\n},\r\n{ &hf_fileexp_afsFid_Unique,\r\n{ "Unique", "fileexp.afsFid.Unique",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\n"afsFid Unique", HFILL}\r\n},\r\n{ &hf_fileexp_afsNetAddr_type,\r\n{ "Type", "fileexp.afsNetAddr.type",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_afsNetAddr_data,\r\n{ "IP Data", "fileexp.afsNetAddr.data",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_position_high,\r\n{ "Position High", "fileexp.position_high",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_position_low,\r\n{ "Position Low", "fileexp.position_low",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_afsreturndesc_tokenid_high,\r\n{ "Token id High", "fileexp.afsreturndesc_tokenid_high",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_afsreturndesc_tokenid_low,\r\n{ "Token id low", "fileexp.afsreturndesc_tokenid_low",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_afsreturndesc_type_high,\r\n{ "Type high", "fileexp.type_high",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_afsreturndesc_type_low,\r\n{ "Type low", "fileexp.type_low",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_offsetp_high,\r\n{ "offset high", "fileexp.offset_high",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_offsetp_low,\r\n{ "offset high", "fileexp.offset_high",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_nextoffsetp_high,\r\n{ "next offset high", "fileexp.nextoffset_high",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_nextoffsetp_low,\r\n{ "next offset low", "fileexp.nextoffset_low",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_returntokenidp_high,\r\n{ "return token idp high", "fileexp.returntokenidp_high",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_returntokenidp_low,\r\n{ "return token idp low", "fileexp.returntokenidp_low",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_cellidp_high,\r\n{ "cellidp high", "fileexp.cellidp_high",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_cellidp_low,\r\n{ "cellidp low", "fileexp.cellidp_low",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_afserrorstatus_st,\r\n{ "AFS Error Code", "fileexp.afserrortstatus_st",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_length,\r\n{ "Length", "fileexp.length",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_afsTaggedPath_tp_chars,\r\n{ "AFS Tagged Path", "fileexp.TaggedPath_tp_chars",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_afsTaggedPath_tp_tag,\r\n{ "AFS Tagged Path Name", "fileexp.TaggedPath_tp_tag",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_afsacl_uuid1,\r\n{ "AFS ACL UUID1", "fileexp.afsacl_uuid1",\r\nFT_GUID, BASE_NONE, NULL, 0x0,\r\n"UUID", HFILL}\r\n},\r\n{ &hf_fileexp_bulkfetchstatus_size,\r\n{ "BulkFetchStatus Size", "fileexp.bulkfetchstatus_size",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_bulkfetchvv_numvols,\r\n{ "BulkFetchVv num vols", "fileexp.bulkfetchvv_numvols",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_bulkfetchvv_spare1,\r\n{ "BulkFetchVv spare1", "fileexp.bulkfetchvv_spare1",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_bulkfetchvv_spare2,\r\n{ "BulkFetchVv spare2", "fileexp.bulkfetchvv_spare2",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_bulkkeepalive_numexecfids,\r\n{ "BulkKeepAlive numexecfids", "fileexp.bulkkeepalive_numexecfids",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_bulkkeepalive_spare4,\r\n{ "BulkKeepAlive spare4", "fileexp.bulkfetchkeepalive_spare2",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_bulkkeepalive_spare2,\r\n{ "BulkKeepAlive spare2", "fileexp.bulkfetchkeepalive_spare2",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_bulkkeepalive_spare1,\r\n{ "BulkFetch KeepAlive spare1", "fileexp.bulkfetchkeepalive_spare1",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_afsacl_defaultcell_uuid,\r\n{ "Default Cell UUID", "fileexp.defaultcell_uuid",\r\nFT_GUID, BASE_NONE, NULL, 0x0,\r\n"UUID", HFILL}\r\n},\r\n{ &hf_fileexp_afsuuid_uuid,\r\n{ "AFS UUID", "fileexp.uuid",\r\nFT_GUID, BASE_NONE, NULL, 0x0,\r\n"UUID", HFILL}\r\n},\r\n{ &hf_fileexp_gettime_syncdispersion,\r\n{ "GetTime Syncdispersion", "fileexp.gettime_syncdispersion",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_gettime_syncdistance,\r\n{ "SyncDistance", "fileexp.gettime.syncdistance",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_gettime_usecondsp,\r\n{ "GetTime usecondsp", "fileexp.gettime_usecondsp",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_readdir_size,\r\n{ "Readdir Size", "fileexp.readdir.size",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_afsNameString_t_principalName_size,\r\n{ "Principal Name Size", "fileexp.principalName_size",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_afsTaggedPath_tp_length,\r\n{ "Tagged Path Length", "fileexp.afsTaggedPath_length",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_fstype,\r\n{ "Filetype", "fileexp.fstype",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_gettime_secondsp,\r\n{ "GetTime secondsp", "fileexp.gettime_secondsp",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_afsNameString_t_principalName_string,\r\n{ "Principal Name", "fileexp.NameString_principal",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n{ &hf_fileexp_fetchdata_pipe_t_size,\r\n{ "FetchData Pipe_t size", "fileexp.fetchdata_pipe_t_size",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL}\r\n},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_fileexp,\r\n&ett_fileexp_afsReturnDesc,\r\n&ett_fileexp_afsFid,\r\n&ett_fileexp_afsNetAddr,\r\n&ett_fileexp_fetchstatus,\r\n&ett_fileexp_afsflags,\r\n&ett_fileexp_volsync,\r\n&ett_fileexp_minvvp,\r\n&ett_fileexp_afsfidtaggedname,\r\n&ett_fileexp_afstaggedname,\r\n&ett_fileexp_afstoken,\r\n&ett_fileexp_afsstorestatus,\r\n&ett_fileexp_afsRecordLock,\r\n&ett_fileexp_afsAcl,\r\n&ett_fileexp_afsNameString_t,\r\n&ett_fileexp_afsConnParams,\r\n&ett_fileexp_afsErrorStatus,\r\n&ett_fileexp_afsTaggedPath,\r\n&ett_fileexp_afsNetData,\r\n&ett_fileexp_afsBulkStat,\r\n&ett_fileexp_afsuuid,\r\n&ett_fileexp_offsetp,\r\n&ett_fileexp_returntokenidp,\r\n&ett_fileexp_afsbundled_stat,\r\n};\r\nproto_fileexp = proto_register_protocol ("DCE DFS File Exporter", "FILEEXP", "fileexp");\r\nproto_register_field_array (proto_fileexp, hf, array_length (hf));\r\nproto_register_subtree_array (ett, array_length (ett));\r\n}\r\nvoid\r\nproto_reg_handoff_fileexp (void)\r\n{\r\ndcerpc_init_uuid (proto_fileexp, ett_fileexp, &uuid_fileexp, ver_fileexp,\r\nfileexp_dissectors, hf_fileexp_opnum);\r\n}
