void dissect_power_saving_class(proto_tree *rng_req_tree, gint tlv_type, tvbuff_t *tvb, guint compound_tlv_len, packet_info *pinfo, guint offset)\r\n{\r\nproto_item *tlv_item;\r\nproto_tree *tlv_tree;\r\nproto_tree *power_saving_class_tree = NULL;\r\nguint tlv_len;\r\nguint tlv_offset;\r\ntlv_info_t tlv_info;\r\ntlv_item = proto_tree_add_protocol_format(rng_req_tree, proto_mac_mgmt_msg_rng_req_decoder, tvb, offset, compound_tlv_len, "Power saving class parameters (%u bytes)", compound_tlv_len);\r\npower_saving_class_tree = proto_item_add_subtree(tlv_item, ett_mac_mgmt_msg_rng_req_decoder);\r\ncompound_tlv_len += offset;\r\nwhile(offset < compound_tlv_len)\r\n{\r\ninit_tlv_info(&tlv_info, tvb, offset);\r\ntlv_type = get_tlv_type(&tlv_info);\r\ntlv_len = get_tlv_length(&tlv_info);\r\nif(tlv_type == -1 || tlv_len > MAX_TLV_LEN || tlv_len < 1)\r\n{\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, NULL, "RNG-REQ TLV error");\r\nproto_tree_add_item(power_saving_class_tree, hf_rng_invalid_tlv, tvb, offset, (compound_tlv_len - offset), ENC_NA);\r\nbreak;\r\n}\r\ntlv_offset = offset + get_tlv_value_offset(&tlv_info);\r\nswitch (tlv_type) {\r\ncase RNG_POWER_SAVING_CLASS_FLAGS:\r\ntlv_item = add_tlv_subtree(&tlv_info, power_saving_class_tree, hf_rng_power_saving_class_flags, tvb, offset, ENC_BIG_ENDIAN);\r\ntlv_tree = proto_item_add_subtree(tlv_item, ett_mac_mgmt_msg_rng_req_decoder);\r\nproto_tree_add_item(tlv_tree, hf_rng_definition_of_power_saving_class_present, tvb, tlv_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_tree, hf_rng_activation_of_power_saving_class, tvb, tlv_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_tree, hf_rng_trf_ind_required, tvb, tlv_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_tree, hf_rng_power_saving_class_reserved, tvb, tlv_offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase RNG_POWER_SAVING_CLASS_ID:\r\nadd_tlv_subtree(&tlv_info, power_saving_class_tree, hf_rng_power_saving_class_id, tvb, offset, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase RNG_POWER_SAVING_CLASS_TYPE:\r\nadd_tlv_subtree(&tlv_info, power_saving_class_tree, hf_rng_power_saving_class_type, tvb, offset, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase RNG_START_FRAME_NUMBER:\r\nadd_tlv_subtree(&tlv_info, power_saving_class_tree, hf_rng_power_saving_first_sleep_window_frame, tvb, offset, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase RNG_INITIAL_SLEEP_WINDOW:\r\nadd_tlv_subtree(&tlv_info, power_saving_class_tree, hf_rng_power_saving_initial_sleep_window, tvb, offset, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase RNG_LISTENING_WINDOW:\r\nadd_tlv_subtree(&tlv_info, power_saving_class_tree, hf_rng_power_saving_listening_window, tvb, offset, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase RNG_FINAL_SLEEP_WINDOW_BASE:\r\nadd_tlv_subtree(&tlv_info, power_saving_class_tree, hf_rng_power_saving_final_sleep_window_base, tvb, offset, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase RNG_FINAL_SLEEP_WINDOW_EXPONENT:\r\nadd_tlv_subtree(&tlv_info, power_saving_class_tree, hf_rng_power_saving_final_sleep_window_exp, tvb, offset, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase RNG_SLPID:\r\nadd_tlv_subtree(&tlv_info, power_saving_class_tree, hf_rng_power_saving_slpid, tvb, offset, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase RNG_CID:\r\nadd_tlv_subtree(&tlv_info, power_saving_class_tree, hf_rng_power_saving_included_cid, tvb, offset, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase RNG_DIRECTION:\r\nadd_tlv_subtree(&tlv_info, power_saving_class_tree, hf_rng_power_saving_mgmt_connection_direction, tvb, offset, ENC_BIG_ENDIAN);\r\nbreak;\r\ndefault:\r\nadd_tlv_subtree(&tlv_info, power_saving_class_tree, hf_tlv_type, tvb, offset, ENC_NA);\r\nbreak;\r\n}\r\noffset = tlv_len + tlv_offset;\r\n}\r\n}\r\nstatic int dissect_mac_mgmt_msg_rng_req_decoder(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nguint offset = 0;\r\nguint tlv_offset;\r\nguint tvb_len;\r\nproto_item *rng_req_item, *tlv_item;\r\nproto_tree *rng_req_tree, *tlv_tree;\r\ntlv_info_t tlv_info;\r\ngint tlv_type;\r\ngint tlv_len;\r\n{\r\ntvb_len = tvb_reported_length(tvb);\r\nrng_req_item = proto_tree_add_protocol_format(tree, proto_mac_mgmt_msg_rng_req_decoder, tvb, offset, tvb_len, "MAC Management Message, RNG-REQ");\r\nrng_req_tree = proto_item_add_subtree(rng_req_item, ett_mac_mgmt_msg_rng_req_decoder);\r\nproto_tree_add_item(rng_req_tree, hf_rng_req_reserved, tvb, 0, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nwhile(offset < tvb_len)\r\n{\r\ninit_tlv_info(&tlv_info, tvb, offset);\r\ntlv_type = get_tlv_type(&tlv_info);\r\ntlv_len = get_tlv_length(&tlv_info);\r\nif(tlv_type == -1 || tlv_len > MAX_TLV_LEN || tlv_len < 1)\r\n{\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, NULL, "RNG-REQ TLV error");\r\nproto_tree_add_item(rng_req_tree, hf_rng_invalid_tlv, tvb, offset, (tvb_len - offset), ENC_NA);\r\nbreak;\r\n}\r\ntlv_offset = offset + get_tlv_value_offset(&tlv_info);\r\nswitch (tlv_type) {\r\ncase RNG_REQ_DL_BURST_PROFILE:\r\ntlv_item = add_tlv_subtree(&tlv_info, rng_req_tree, hf_rng_req_dl_burst_profile, tvb, offset, ENC_BIG_ENDIAN);\r\ntlv_tree = proto_item_add_subtree(tlv_item, ett_mac_mgmt_msg_rng_req_decoder);\r\nproto_tree_add_item(tlv_tree, hf_rng_req_dl_burst_profile_diuc, tvb, tlv_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_tree, hf_rng_req_dl_burst_profile_lsb_ccc, tvb, tlv_offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase RNG_REQ_SS_MAC_ADDRESS:\r\nadd_tlv_subtree(&tlv_info, rng_req_tree, hf_rng_req_ss_mac_address, tvb, offset, ENC_NA);\r\nbreak;\r\ncase RNG_REQ_RANGING_ANOMALIES:\r\ntlv_item = add_tlv_subtree(&tlv_info, rng_req_tree, hf_rng_req_ranging_anomalies, tvb, offset, ENC_BIG_ENDIAN);\r\ntlv_tree = proto_item_add_subtree(tlv_item, ett_mac_mgmt_msg_rng_req_decoder);\r\nproto_tree_add_item(tlv_tree, hf_rng_req_ranging_anomalies_max_power, tvb, tlv_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_tree, hf_rng_req_ranging_anomalies_min_power, tvb, tlv_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_tree, hf_rng_req_ranging_anomalies_timing_adj, tvb, tlv_offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase RNG_REQ_AAS_BROADCAST:\r\nadd_tlv_subtree(&tlv_info, rng_req_tree, hf_rng_req_aas_broadcast, tvb, offset, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase RNG_REQ_SERVING_BS_ID:\r\nadd_tlv_subtree(&tlv_info, rng_req_tree, hf_rng_req_serving_bs_id, tvb, offset, ENC_NA);\r\nbreak;\r\ncase RNG_REQ_RANGING_PURPOSE_INDICATION:\r\ntlv_item = add_tlv_subtree(&tlv_info, rng_req_tree, hf_rng_req_ranging_purpose_indication, tvb, offset, ENC_BIG_ENDIAN);\r\ntlv_tree = proto_item_add_subtree(tlv_item, ett_mac_mgmt_msg_rng_req_decoder);\r\nproto_tree_add_item(tlv_tree, hf_rng_req_ranging_purpose_ho_indication, tvb, tlv_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_tree, hf_rng_req_ranging_purpose_location_update_request, tvb, tlv_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_tree, hf_rng_req_ranging_purpose_reserved, tvb, tlv_offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase RNG_REQ_HO_ID:\r\nadd_tlv_subtree(&tlv_info, rng_req_tree, hf_rng_req_ho_id, tvb, offset, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase RNG_REQ_POWER_DOWN_INDICATOR:\r\nadd_tlv_subtree(&tlv_info, rng_req_tree, hf_rng_req_power_down_indicator, tvb, offset, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase RNG_REQ_REQUESTED_DNLK_REP_CODING_LEVEL:\r\ntlv_item = add_tlv_subtree(&tlv_info, rng_req_tree, hf_rng_req_requested_rep_coding_level, tvb, offset, ENC_BIG_ENDIAN);\r\ntlv_tree = proto_item_add_subtree(tlv_item, ett_mac_mgmt_msg_rng_req_decoder);\r\nproto_tree_add_item(tlv_tree, hf_rng_req_repetition_coding_level, tvb, tlv_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tlv_tree, hf_rng_req_requested_downlink_repetition_coding_level_reserved, tvb, tlv_offset, 1, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase RNG_REQ_CMAC_KEY_COUNT:\r\nif (include_cor2_changes) {\r\nadd_tlv_subtree(&tlv_info, rng_req_tree, hf_rng_req_cmac_key_count, tvb, offset, ENC_BIG_ENDIAN);\r\n} else {\r\nadd_tlv_subtree(&tlv_info, rng_req_tree, hf_tlv_type, tvb, offset, ENC_NA);\r\n}\r\nbreak;\r\ncase SHORT_HMAC_TUPLE:\r\ncase SHORT_HMAC_TUPLE_COR2:\r\nif ((!include_cor2_changes && (tlv_type == SHORT_HMAC_TUPLE)) ||\r\n(include_cor2_changes && (tlv_type == SHORT_HMAC_TUPLE_COR2))) {\r\ntlv_tree = add_protocol_subtree(&tlv_info, ett_mac_mgmt_msg_rng_req_decoder, rng_req_tree, proto_mac_mgmt_msg_rng_req_decoder, tvb, offset, tlv_len, "Short HMAC Tuple");\r\nwimax_short_hmac_tuple_decoder(tlv_tree, tvb, tlv_offset, tvb_len - offset);\r\n} else {\r\nadd_tlv_subtree(&tlv_info, rng_req_tree, hf_tlv_type, tvb, offset, ENC_NA);\r\n}\r\nbreak;\r\ncase MAC_VERSION_ENCODING:\r\noffset += wimax_common_tlv_encoding_decoder(tvb_new_subset_remaining(tvb, offset), pinfo, rng_req_tree);\r\ncontinue;\r\nbreak;\r\ncase RNG_REQ_POWER_SAVING_CLASS_PARAMETERS:\r\ntlv_tree = add_protocol_subtree(&tlv_info, ett_mac_mgmt_msg_rng_req_decoder, rng_req_tree, proto_mac_mgmt_msg_rng_req_decoder, tvb, offset, tlv_len, "Power Saving Class Parameters");\r\ndissect_power_saving_class(tlv_tree, tlv_type, tvb, tlv_len, pinfo, tlv_offset);\r\nbreak;\r\ndefault:\r\nadd_tlv_subtree(&tlv_info, rng_req_tree, hf_tlv_type, tvb, offset, ENC_NA);\r\nbreak;\r\n}\r\noffset = tlv_len + tlv_offset;\r\n}\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid proto_register_mac_mgmt_msg_rng_req(void)\r\n{\r\nstatic hf_register_info hf[] =\r\n{\r\n{\r\n&hf_rng_activation_of_power_saving_class,\r\n{\r\n"Activation of Power Saving Class (Types 1 and 2 only)", "wmx.rng.power_save.activate",\r\nFT_BOOLEAN, 8, TFS(&tfs_rng_activate), 0x02, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_power_saving_class_id,\r\n{\r\n"Power Saving Class ID", "wmx.rng.power_save.class_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_power_saving_class_type,\r\n{\r\n"Power Saving Class Type", "wmx.rng.power_save.class_type",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_definition_of_power_saving_class_present,\r\n{\r\n"Definition of Power Saving Class present", "wmx.rng.power_save.definition_present",\r\nFT_UINT8, BASE_DEC, NULL, 0x01, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_power_saving_final_sleep_window_base,\r\n{\r\n"Final-sleep window base (measured in frames)", "wmx.rng.power_save.final_sleep_window_base",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_power_saving_final_sleep_window_exp,\r\n{\r\n"Final-sleep window exponent (measured in frames)", "wmx.rng.power_save.final_sleep_window_exp",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_power_saving_first_sleep_window_frame,\r\n{\r\n"Start frame number for first sleep window", "wmx.rng.power_save.first_sleep_window_frame",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_power_saving_included_cid,\r\n{\r\n"CID of connection to be included into the Power Saving Class.", "wmx.rng.power_save.included_cid",\r\nFT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_power_saving_initial_sleep_window,\r\n{\r\n"Initial-sleep window", "wmx.rng.power_save.initial_sleep_window",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_power_saving_listening_window,\r\n{\r\n"Listening window duration (measured in frames)", "wmx.rng.power_save.listening_window",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_power_saving_mgmt_connection_direction,\r\n{\r\n"Direction for management connection added to Power Saving Class", "wmx.rng.power_save.mgmt_connection_direction",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_power_saving_class_reserved,\r\n{\r\n"Reserved", "wmx.rng.power_save.reserved",\r\nFT_UINT8, BASE_DEC, NULL, 0xF8, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_power_saving_slpid,\r\n{\r\n"SLPID assigned by the BS whenever an MS is instructed to enter sleep mode", "wmx.rng.power_save.slpid",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_trf_ind_required,\r\n{\r\n"BS shall transmit at least one TRF-IND message during each listening window of the Power Saving Class", "wmx.rng.power_save.trf_ind_required",\r\nFT_BOOLEAN, 8, TFS(&tfs_rng_activate), 0x04, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_req_aas_broadcast,\r\n{\r\n"AAS broadcast capability", "wmx.rng_req.aas_broadcast",\r\nFT_BOOLEAN, BASE_NONE, TFS(&tfs_rng_req_aas_broadcast), 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_req_ranging_anomalies_max_power,\r\n{\r\n"Meaning", "wmx.rng_req.anomalies.max_power",\r\nFT_BOOLEAN, 8, TFS(&tfs_rng_max_power), 0x04, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_req_ranging_anomalies_min_power,\r\n{\r\n"Meaning", "wmx.rng_req.anomalies.min_power",\r\nFT_BOOLEAN, 8, TFS(&tfs_rng_min_power), 0x02, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_req_ranging_anomalies_timing_adj,\r\n{\r\n"Meaning", "wmx.rng_req.anomalies.timing_adj",\r\nFT_BOOLEAN, 8, TFS(&tfs_rng_timing_adj), 0x01, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_req_cmac_key_count,\r\n{\r\n"CMAC Key Count", "wmx.rng_req.cmac_key_count",\r\nFT_UINT16, BASE_DEC, NULL, 0x00, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_req_dl_burst_profile_lsb_ccc,\r\n{\r\n"LSB of CCC of DCD associated with DIUC", "wmx.rng_req.dl_burst_profile.ccc",\r\nFT_UINT8, BASE_DEC, NULL, 0xF0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_req_dl_burst_profile_diuc,\r\n{\r\n"DIUC", "wmx.rng_req.dl_burst_profile.diuc",\r\nFT_UINT8, BASE_DEC, NULL, 0x0F, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_tlv_type,\r\n{\r\n"Unknown TLV Type", "wmx.rng_req.unknown_tlv_type",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_invalid_tlv,\r\n{\r\n"Invalid TLV", "wmx.rng_req.invalid_tlv",\r\nFT_BYTES, BASE_NONE, NULL, 0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_req_ho_id,\r\n{\r\n"ID from the target BS for use in initial ranging during MS handover to it", "wmx.rng_req.ho_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_req_power_down_indicator,\r\n{\r\n"Power down Indicator", "wmx.rng_req.power_down_indicator",\r\nFT_UINT8, BASE_DEC, NULL, 0x00, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_req_ranging_purpose_ho_indication,\r\n{\r\n"MS HO indication", "wmx.rng_req.ranging_purpose.ho_indication",\r\nFT_UINT8, BASE_DEC, NULL, 0x01, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_req_ranging_purpose_reserved,\r\n{\r\n"Reserved", "wmx.rng_req.ranging_purpose.reserved",\r\nFT_UINT8, BASE_DEC, NULL, 0xFC, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_req_ranging_purpose_location_update_request,\r\n{\r\n"Location Update Request", "wmx.rng_req.ranging_purpose.loc_update_req",\r\nFT_UINT8, BASE_DEC, VALS(vals_rng_req_ranging_purpose_location_update_request), 0x02, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_req_repetition_coding_level,\r\n{\r\n"Repetition coding level", "wmx.rng_req.repetition_coding_level",\r\nFT_UINT8, BASE_DEC, VALS(vals_rng_req_repetition_coding_level), 0x03, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_req_requested_downlink_repetition_coding_level_reserved,\r\n{\r\n"Reserved", "wmx.rng_req.reserved",\r\nFT_UINT8, BASE_DEC, NULL, 0xFC, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_req_reserved,\r\n{\r\n"Reserved", "wmx.rng_req.reserved",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_req_serving_bs_id,\r\n{\r\n"Former serving BS ID", "wmx.rng_req.serving_bs_id",\r\nFT_ETHER, BASE_NONE, NULL, 0x00, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_req_ss_mac_address,\r\n{\r\n"SS MAC Address", "wmx.rng_req.ss_mac_address",\r\nFT_ETHER, BASE_NONE, NULL, 0x00, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_power_saving_class_flags,\r\n{\r\n"Power Saving Class", "wmx.rng.power_save.flags",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_req_dl_burst_profile,\r\n{\r\n"Requested Downlink Burst Profile", "wmx.rng_req.dl_burst_profile",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_req_ranging_anomalies,\r\n{\r\n"Ranging Anomalies", "wmx.rng_req.anomalies",\r\nFT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_req_ranging_purpose_indication,\r\n{\r\n"Ranging Purpose Flags", "wmx.rng_req.ranging_purpose.indication",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n{\r\n&hf_rng_req_requested_rep_coding_level,\r\n{\r\n"Requested downlink repetition coding level", "wmx.rng_req.requested_rep_coding_level",\r\nFT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL\r\n}\r\n},\r\n};\r\nstatic gint *ett[] =\r\n{\r\n&ett_mac_mgmt_msg_rng_req_decoder,\r\n};\r\nproto_mac_mgmt_msg_rng_req_decoder = proto_register_protocol (\r\n"WiMax RNG-REQ Messages",\r\n"WiMax RNG-REQ",\r\n"wmx.rng_req"\r\n);\r\nproto_register_field_array(proto_mac_mgmt_msg_rng_req_decoder, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid proto_reg_handoff_mac_mgmt_msg_rng_req(void)\r\n{\r\ndissector_handle_t rng_req_handle;\r\nrng_req_handle = create_dissector_handle(dissect_mac_mgmt_msg_rng_req_decoder, proto_mac_mgmt_msg_rng_req_decoder);\r\ndissector_add_uint("wmx.mgmtmsg", MAC_MGMT_MSG_RNG_REQ, rng_req_handle);\r\n}
