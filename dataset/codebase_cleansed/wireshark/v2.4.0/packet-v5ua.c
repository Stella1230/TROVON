static void\r\ndissect_int_interface_identifier_parameter(tvbuff_t *parameter_tvb, proto_tree *parameter_tree, proto_item *parameter_item)\r\n{\r\nguint32 identifier;\r\nguint16 number_of_ids, id_number;\r\ngint offset;\r\nnumber_of_ids= (tvb_get_ntohs(parameter_tvb, PARAMETER_LENGTH_OFFSET) - PARAMETER_HEADER_LENGTH) / INT_INTERFACE_ID_LENGTH;\r\noffset = INT_IF_ID_LINK_OFFSET;\r\nproto_item_append_text(parameter_item, "(");\r\nfor (id_number = 0; id_number < number_of_ids; id_number++) {\r\nproto_tree_add_item(parameter_tree, hf_link_id, parameter_tvb, offset, INT_IF_ID_LINK_LENGTH, ENC_BIG_ENDIAN);\r\nidentifier = tvb_get_ntohl(parameter_tvb,offset)>>5;\r\nif (id_number < 1) {\r\nproto_item_append_text(parameter_item, "L:%d",identifier);\r\n} else {\r\nproto_item_append_text(parameter_item, " | L:%d",identifier);\r\n}\r\nlinkIdentifier = identifier;\r\nproto_tree_add_item(parameter_tree, hf_chnl_id, parameter_tvb, offset+3, INT_IF_ID_CHNL_LENGTH, ENC_BIG_ENDIAN);\r\nidentifier = tvb_get_guint8(parameter_tvb,offset+3)&0x1f;\r\nproto_item_append_text(parameter_item, " C:%d", identifier);\r\noffset += INT_INTERFACE_ID_LENGTH;\r\n}\r\nproto_item_append_text(parameter_item, ")");\r\n}\r\nstatic void\r\ndissect_text_interface_identifier_parameter(tvbuff_t *parameter_tvb, proto_tree *parameter_tree, proto_item *parameter_item)\r\n{\r\nguint16 if_id_length;\r\nconst guint8* str;\r\nif_id_length = tvb_get_ntohs(parameter_tvb, TEXT_IF_ID_LENGTH_OFFSET) - TEXT_IF_ID_HEADER_LENGTH;\r\nproto_tree_add_item_ret_string(parameter_tree, hf_text_if_id, parameter_tvb, TEXT_IF_ID_VALUE_OFFSET, if_id_length, ENC_ASCII|ENC_NA, wmem_packet_scope(), &str);\r\nproto_item_append_text(parameter_item, " (0x%.*s)", if_id_length, str);\r\n}\r\nstatic void\r\ndissect_dlci_parameter(tvbuff_t *parameter_tvb, proto_tree *parameter_tree, proto_item *parameter_item, packet_info *pinfo)\r\n{\r\nguint16 efa = 0, offset = 0;\r\nguint8 sapi = -1;\r\nguint8 tei = -1;\r\nif (iua_version == RFC) offset = DLCI_SAPI_OFFSET;\r\nelse if(iua_version == DRAFT) offset = DLCI_HEADER_LENGTH + tvb_get_ntohs(parameter_tvb, DLCI_LENGTH_OFFSET);\r\nproto_tree_add_item(parameter_tree, hf_dlci_zero_bit, parameter_tvb, offset, DLCI_SAPI_LENGTH, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(parameter_tree, hf_dlci_spare_bit, parameter_tvb, offset, DLCI_SAPI_LENGTH, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(parameter_tree, hf_dlci_sapi, parameter_tvb, offset, DLCI_SAPI_LENGTH, ENC_BIG_ENDIAN);\r\noffset += DLCI_SAPI_LENGTH;\r\nproto_tree_add_item(parameter_tree, hf_dlci_one_bit, parameter_tvb, offset, DLCI_TEI_LENGTH, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(parameter_tree, hf_dlci_tei, parameter_tvb, offset, DLCI_TEI_LENGTH, ENC_BIG_ENDIAN);\r\nsapi = tvb_get_ntohs(parameter_tvb, offset-DLCI_TEI_LENGTH-DLCI_SAPI_LENGTH)>>2;\r\ntei = tvb_get_ntohs(parameter_tvb, offset-DLCI_TEI_LENGTH)>>1;\r\noffset += DLCI_TEI_LENGTH;\r\nefa = tvb_get_ntohs(parameter_tvb, offset);\r\ndlci_efa = tvb_get_ntohs(parameter_tvb, offset);\r\nif (dlci_efa >= 0 && dlci_efa <= 8175) { col_append_fstr(pinfo->cinfo, COL_INFO, " | ISDN: %u", dlci_efa); }\r\nelse if (dlci_efa == 8176) { col_append_str(pinfo->cinfo, COL_INFO, " | PSTN"); }\r\nelse if (dlci_efa == 8177) { col_append_str(pinfo->cinfo, COL_INFO, " | Ctrl"); }\r\nelse if (dlci_efa == 8178) { col_append_str(pinfo->cinfo, COL_INFO, " | BCC"); }\r\nelse if (dlci_efa == 8179) { col_append_str(pinfo->cinfo, COL_INFO, " | ProtProt"); }\r\nelse if (dlci_efa == 8180) { col_append_str(pinfo->cinfo, COL_INFO, " | LinkCtrl"); }\r\nif(efa <= 8175) {\r\nproto_tree_add_uint_format_value(parameter_tree, hf_efa, parameter_tvb, offset, EFA_LENGTH, efa,\r\n"ISDN (%u)", efa);\r\nproto_item_append_text(parameter_item, " (SAPI:%u TEI:%u EFA:ISDN (%u))",sapi,tei,efa);\r\n}\r\nelse if (efa > 8175 && efa <= 8180){\r\nproto_tree_add_uint_format_value(parameter_tree, hf_efa, parameter_tvb, offset, EFA_LENGTH, efa,\r\n"%s (%u)", val_to_str_const(efa, efa_values, "unknown EFA"),tvb_get_ntohs(parameter_tvb, offset));\r\nproto_item_append_text(parameter_item, " (SAPI:%u TEI:%u EFA:%s (%u))",sapi,tei,val_to_str_const(efa, efa_values, "unknown EFA-value"),efa);\r\n}\r\nelse {\r\nproto_tree_add_uint_format_value(parameter_tree, hf_efa, parameter_tvb, offset, EFA_LENGTH, efa,\r\n"RESERVED (%u)", efa);\r\nproto_item_append_text(parameter_item, " (SAPI:%u TEI:%u EFA:RESERVED (%u))",sapi,tei,efa);\r\n}\r\n}\r\nstatic void\r\ndissect_draft_error_code_parameter(tvbuff_t *parameter_tvb, proto_tree *parameter_tree)\r\n{\r\nguint16 offset = MGMT_ERROR_MSG_HEADER_LENGTH + tvb_get_ntohs(parameter_tvb, MGMT_ERROR_MSG_LENGTH_OFFSET) + 4;\r\nproto_tree_add_item(parameter_tree, hf_draft_error_code, parameter_tvb, offset, MGMT_ERROR_CODE_LENGTH, ENC_BIG_ENDIAN);\r\noffset += MGMT_ERROR_CODE_LENGTH ;\r\nif( tvb_reported_length_remaining(parameter_tvb,offset) > 0 )\r\nproto_tree_add_item(parameter_tree, hf_info_string, parameter_tvb, offset, msg_length - offset,ENC_ASCII|ENC_NA);\r\n}\r\nstatic void\r\ndissect_error_code_parameter(tvbuff_t *parameter_tvb, proto_tree *parameter_tree, proto_item *parameter_item)\r\n{\r\nproto_tree_add_item(parameter_tree, hf_error_code, parameter_tvb, MGMT_ERROR_CODE_OFFSET, MGMT_ERROR_CODE_LENGTH, ENC_BIG_ENDIAN);\r\nproto_item_append_text(parameter_item, " (%s)",\r\nval_to_str_const(tvb_get_ntohl(parameter_tvb, MGMT_ERROR_CODE_OFFSET), error_code_values, "Unknown error code"));\r\n}\r\nstatic void\r\ndissect_diagnostic_information_parameter(tvbuff_t *parameter_tvb, proto_tree *parameter_tree, proto_item *parameter_item)\r\n{\r\nguint16 diag_info_length;\r\ndiag_info_length = tvb_get_ntohs(parameter_tvb, MGMT_ERROR_MSG_LENGTH_OFFSET) - MGMT_ERROR_MSG_HEADER_LENGTH;\r\nproto_tree_add_item(parameter_tree, hf_diagnostic_info, parameter_tvb, PARAMETER_VALUE_OFFSET, diag_info_length, ENC_NA);\r\nproto_item_append_text(parameter_item, " (%u byte%s)", diag_info_length, plurality(diag_info_length, "", "s"));\r\n}\r\nstatic void\r\ndissect_status_type_identification_parameter(tvbuff_t *parameter_tvb, proto_tree *parameter_tree, proto_item *parameter_item)\r\n{\r\nguint16 status_type, status_id;\r\nstatus_type = tvb_get_ntohs(parameter_tvb, NTFY_STATUS_TYPE_OFFSET);\r\nstatus_id = tvb_get_ntohs(parameter_tvb, NTFY_STATUS_IDENT_OFFSET);\r\nproto_tree_add_item(parameter_tree, hf_status_type, parameter_tvb, NTFY_STATUS_TYPE_OFFSET, NTFY_STATUS_TYPE_LENGTH, ENC_BIG_ENDIAN);\r\nproto_tree_add_uint_format_value(parameter_tree, hf_status_id, parameter_tvb, NTFY_STATUS_IDENT_OFFSET, NTFY_STATUS_IDENT_LENGTH,\r\nstatus_id, "%u (%s)", status_id,\r\nval_to_str_const(status_type * 256 * 256 + status_id, status_type_id_values, "unknown"));\r\nproto_item_append_text(parameter_item, " (%s)",\r\nval_to_str_const(status_type * 256 * 256 + status_id, status_type_id_values, "Unknown status information"));\r\n}\r\nstatic void\r\ndissect_tei_status_parameter(tvbuff_t *parameter_tvb, proto_tree *parameter_tree, proto_item *parameter_item)\r\n{\r\nproto_tree_add_item(parameter_tree, hf_tei_status, parameter_tvb, TEI_STATUS_OFFSET, TEI_STATUS_LENGTH, ENC_BIG_ENDIAN);\r\nproto_item_append_text(parameter_item, " (%s)",\r\nval_to_str_const(tvb_get_ntohl(parameter_tvb, TEI_STATUS_OFFSET), tei_status_values, "Unknown TEI status"));\r\n}\r\nstatic void\r\ndissect_draft_tei_status_parameter(tvbuff_t *parameter_tvb, proto_tree *parameter_tree, proto_item *parameter_item)\r\n{\r\ngint offset;\r\noffset = tvb_get_ntohs(parameter_tvb, TEI_STATUS_LENGTH_OFFSET) + 8;\r\nif(tvb_reported_length_remaining(parameter_tvb, offset) > 0 ){\r\nproto_tree_add_item(parameter_tree, hf_tei_draft_status, parameter_tvb, offset, TEI_STATUS_LENGTH, ENC_BIG_ENDIAN);\r\nproto_item_append_text(parameter_item, " (%s)",\r\nval_to_str_const(tvb_get_ntohl(parameter_tvb, offset), tei_draft_status_values, "Unknown TEI Status"));\r\n}\r\n}\r\nstatic void\r\ndissect_asp_msg_parameter(tvbuff_t *parameter_tvb, proto_tree *parameter_tree, proto_item *parameter_item)\r\n{\r\nconst guint8* str;\r\nguint16 adaptation_layer_id_length = tvb_get_ntohs(parameter_tvb, PARAMETER_LENGTH_OFFSET);\r\nproto_tree_add_item_ret_string(parameter_tree, hf_adaptation_layer_id, parameter_tvb, PARAMETER_VALUE_OFFSET, adaptation_layer_id_length, ENC_ASCII|ENC_NA, wmem_packet_scope(), &str);\r\nproto_item_append_text(parameter_item, " (%.*s)", adaptation_layer_id_length, str);\r\n}\r\nstatic void\r\ndissect_scn_protocol_id_parameter(tvbuff_t *parameter_tvb, proto_tree *parameter_tree, proto_item *parameter_item)\r\n{\r\nconst guint8* str;\r\nguint16 id_length = tvb_get_ntohs(parameter_tvb, PARAMETER_LENGTH_OFFSET);\r\nproto_tree_add_item_ret_string(parameter_tree, hf_scn_protocol_id, parameter_tvb, PARAMETER_VALUE_OFFSET, id_length, ENC_ASCII|ENC_NA, wmem_packet_scope(), &str);\r\nproto_item_append_text(parameter_item, " (%.*s)", id_length, str);\r\n}\r\nstatic void\r\ndissect_asp_reason_parameter(tvbuff_t *parameter_tvb, proto_tree *parameter_tree, proto_item *parameter_item)\r\n{\r\nproto_tree_add_item(parameter_tree, hf_asp_reason, parameter_tvb, ASP_REASON_OFFSET, ASP_REASON_LENGTH, ENC_BIG_ENDIAN);\r\nproto_item_append_text(parameter_item, " (%s)", val_to_str_const(tvb_get_ntohl(parameter_tvb, ASP_REASON_OFFSET), asp_reason_values, "Unknown ASP down reason"));\r\n}\r\nstatic void\r\ndissect_heartbeat_data_parameter(tvbuff_t *parameter_tvb, proto_tree *parameter_tree, proto_item *parameter_item)\r\n{\r\nguint16 heartbeat_data_length;\r\nheartbeat_data_length = tvb_get_ntohs(parameter_tvb, HEARTBEAT_MSG_LENGTH_OFFSET) - HEARTBEAT_MSG_HEADER_LENGTH;\r\nproto_tree_add_item(parameter_tree, hf_heartbeat_data, parameter_tvb, HEARTBEAT_DATA_OFFSET, heartbeat_data_length, ENC_NA);\r\nproto_item_append_text(parameter_item, " (%u byte%s)", heartbeat_data_length, plurality(heartbeat_data_length, "", "s"));\r\n}\r\nstatic void\r\ndissect_traffic_mode_type_parameter(tvbuff_t *parameter_tvb, proto_tree *parameter_tree, proto_item *parameter_item)\r\n{\r\nproto_tree_add_item(parameter_tree, hf_traffic_mode_type, parameter_tvb, TRAFFIC_MODE_TYPE_OFFSET, TRAFFIC_MODE_TYPE_LENGTH, ENC_BIG_ENDIAN);\r\nproto_item_append_text(parameter_item, " (%s)",\r\nval_to_str_const(tvb_get_ntohl(parameter_tvb, TRAFFIC_MODE_TYPE_OFFSET), traffic_mode_type_values, "Unknown traffic mode type"));\r\n}\r\nstatic void\r\ndissect_integer_range_interface_identifier_parameter(tvbuff_t *parameter_tvb, proto_tree *parameter_tree, proto_item *parameter_item)\r\n{\r\nguint16 number_of_ranges, range_number, offset;\r\nnumber_of_ranges = (tvb_get_ntohs(parameter_tvb, INT_RANGE_LENGTH_OFFSET) - INT_RANGE_HEADER_LENGTH) / IF_ID_INTERVAL_LENGTH;\r\noffset = INT_RANGE_START_OFFSET;\r\nfor(range_number = 0; range_number < number_of_ranges; range_number++) {\r\nproto_tree_add_item(parameter_tree, hf_if_range_start, parameter_tvb, offset + IF_ID_START_OFFSET, IF_ID_START_LENGTH, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(parameter_tree, hf_if_range_end, parameter_tvb, offset + IF_ID_END_OFFSET, IF_ID_END_LENGTH, ENC_BIG_ENDIAN);\r\noffset += IF_ID_INTERVAL_LENGTH;\r\n};\r\nproto_item_append_text(parameter_item, " (%u range%s)", number_of_ranges, plurality(number_of_ranges, "", "s"));\r\n}\r\nstatic void\r\ndissect_layer3_message(tvbuff_t *layer3_data_tvb, proto_tree *v5ua_tree,proto_item *parameter_item, packet_info *pinfo)\r\n{\r\nguint16 discriminator_offset;\r\nif(iua_version == DRAFT){\r\ndiscriminator_offset = DISCRIMINATOR_OFFSET;\r\n}\r\nelse{\r\ndiscriminator_offset = DISCRIMINATOR_OFFSET + PARAMETER_HEADER_LENGTH;\r\n}\r\nif (tvb_get_guint8(layer3_data_tvb, discriminator_offset) == 0x48){\r\nguint16 protocol_data_length;\r\ntvbuff_t *protocol_data_tvb;\r\nprotocol_data_length = tvb_get_ntohs(layer3_data_tvb, PARAMETER_LENGTH_OFFSET) - PARAMETER_HEADER_LENGTH;\r\nprotocol_data_tvb = tvb_new_subset_length(layer3_data_tvb, PARAMETER_VALUE_OFFSET, protocol_data_length);\r\ncall_dissector(v52_handle, protocol_data_tvb, pinfo, v5ua_tree);\r\nproto_item_append_text(parameter_item, " (%u byte%s)", protocol_data_length, plurality(protocol_data_length, "", "s"));\r\n}\r\nelse{\r\nguint16 protocol_data_length;\r\ntvbuff_t *protocol_data_tvb;\r\nprotocol_data_length = tvb_get_ntohs(layer3_data_tvb, PARAMETER_LENGTH_OFFSET) - PARAMETER_HEADER_LENGTH;\r\nprotocol_data_tvb = tvb_new_subset_length(layer3_data_tvb, PARAMETER_VALUE_OFFSET, protocol_data_length);\r\ncall_dissector(q931_handle, protocol_data_tvb, pinfo, v5ua_tree);\r\nproto_item_append_text(parameter_item, " (%u byte%s)", protocol_data_length, plurality(protocol_data_length, "", "s"));\r\n}\r\n}\r\nstatic void\r\ndissect_release_reason_parameter(tvbuff_t *parameter_tvb, proto_tree *parameter_tree, proto_item *parameter_item)\r\n{\r\ngint offset = RELEASE_REASON_OFFSET;\r\nif(iua_version == DRAFT) offset = tvb_get_ntohs(parameter_tvb, RELEASE_REASON_LENGTH_OFFSET)+8;\r\nproto_tree_add_item(parameter_tree, hf_release_reason, parameter_tvb, offset, RELEASE_REASON_LENGTH, ENC_BIG_ENDIAN);\r\nif(iua_version != DRAFT)\r\nproto_item_append_text(parameter_item, " (%s)",\r\nval_to_str_const(tvb_get_ntohl(parameter_tvb, offset), release_reason_values, "Unknown release reason"));\r\n}\r\nstatic void\r\ndissect_link_status_parameter(tvbuff_t *parameter_tvb, proto_tree *parameter_tree, proto_item *parameter_item)\r\n{\r\nproto_tree_add_item(parameter_tree, hf_link_status, parameter_tvb, LINK_STATUS_OFFSET, LINK_STATUS_LENGTH, ENC_BIG_ENDIAN);\r\nproto_item_append_text(parameter_item, " (%s)",\r\nval_to_str_const(tvb_get_ntohl(parameter_tvb, LINK_STATUS_OFFSET),link_status_values, "Unknown Link status"));\r\nlink_status_operational = tvb_get_ntohl(parameter_tvb, LINK_STATUS_OFFSET);\r\n}\r\nstatic void\r\ndissect_sa_bit_status_parameter(tvbuff_t *parameter_tvb, proto_tree *parameter_tree, proto_item *parameter_item)\r\n{\r\nproto_tree_add_item(parameter_tree, hf_sa_bit_id, parameter_tvb, SA_BIT_ID_OFFSET, SA_BIT_ID_LENGTH, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(parameter_tree, hf_sa_bit_value, parameter_tvb, SA_BIT_VALUE_OFFSET, SA_BIT_VALUE_LENGTH, ENC_BIG_ENDIAN);\r\nproto_item_append_text(parameter_item, " (%s %s)",\r\nval_to_str_const(tvb_get_ntohs(parameter_tvb, SA_BIT_ID_OFFSET), sa_bit_values, "unknown"),\r\nval_to_str_const(tvb_get_ntohs(parameter_tvb, SA_BIT_VALUE_OFFSET), sa_bit_values, "unknown Bit"));\r\nsa_bit_id = tvb_get_ntohs(parameter_tvb, SA_BIT_VALUE_OFFSET);\r\n}\r\nstatic void\r\ndissect_error_indication_parameter(tvbuff_t *parameter_tvb, proto_tree *parameter_tree, proto_item *parameter_item)\r\n{\r\nproto_tree_add_item(parameter_tree, hf_error_reason, parameter_tvb, ERROR_REASON_OFFSET, ERROR_REASON_LENGTH, ENC_BIG_ENDIAN);\r\nproto_item_append_text(parameter_item, " (%s)",\r\nval_to_str_const(tvb_get_ntohl(parameter_tvb, ERROR_REASON_OFFSET), error_reason_values, "unknown"));\r\n}\r\nstatic void\r\ndissect_asp_identifier_parameter(tvbuff_t *parameter_tvb, proto_tree *parameter_tree, proto_item *parameter_item)\r\n{\r\nproto_tree_add_item(parameter_tree, hf_asp_identifier, parameter_tvb, ASP_IDENTIFIER_OFFSET, ASP_IDENTIFIER_LENGTH, ENC_BIG_ENDIAN);\r\nproto_item_append_text(parameter_item, " (%d) ",tvb_get_ntohl(parameter_tvb,ASP_IDENTIFIER_OFFSET));\r\n}\r\nstatic void\r\ndissect_info_string_parameter(tvbuff_t *parameter_tvb, proto_tree *parameter_tree, proto_item *parameter_item)\r\n{\r\nguint16 info_string_length;\r\nconst guint8* str;\r\ninfo_string_length = tvb_get_ntohs(parameter_tvb, PARAMETER_LENGTH_OFFSET);\r\nif(iua_version == DRAFT) info_string_length += 4;\r\nif(info_string_length > 4){\r\ninfo_string_length -= PARAMETER_HEADER_LENGTH;\r\nproto_tree_add_item_ret_string(parameter_tree, hf_info_string, parameter_tvb, INFO_STRING_OFFSET, info_string_length, ENC_ASCII|ENC_NA, wmem_packet_scope(), &str);\r\nproto_item_append_text(parameter_item, " (%.*s)", info_string_length, str);\r\n}\r\n}\r\nstatic void\r\ndissect_unknown_parameter(tvbuff_t *parameter_tvb, proto_tree *parameter_tree, proto_item *parameter_item)\r\n{\r\nguint16 parameter_value_length;\r\nparameter_value_length = tvb_get_ntohs(parameter_tvb, PARAMETER_LENGTH_OFFSET) - PARAMETER_HEADER_LENGTH;\r\nif (parameter_value_length > 0)\r\nproto_tree_add_item(parameter_tree, hf_parameter_value, parameter_tvb, PARAMETER_VALUE_OFFSET, parameter_value_length, ENC_NA);\r\nproto_item_append_text(parameter_item, " with tag %u and %u byte%s value",\r\ntvb_get_ntohs(parameter_tvb, PARAMETER_TAG_OFFSET), parameter_value_length, plurality(parameter_value_length, "", "s"));\r\n}\r\nstatic void\r\ndissect_parameter(tvbuff_t *parameter_tvb, packet_info *pinfo, proto_tree *v5ua_tree)\r\n{\r\nguint16 tag, length, padding_length;\r\nproto_item *parameter_item;\r\nproto_tree *parameter_tree;\r\ntag = tvb_get_ntohs(parameter_tvb, PARAMETER_TAG_OFFSET);\r\nlength = tvb_get_ntohs(parameter_tvb, PARAMETER_LENGTH_OFFSET);\r\nif((iua_version==DRAFT)&&(tag<=0x4)){\r\nif(tag==0x1) length += 8;\r\nelse if(tag<=0x4) length += PARAMETER_HEADER_LENGTH;\r\nif((msg_class==0 || msg_class==1 || msg_class==9) && msg_type<=10)\r\nlength = msg_length;\r\n}\r\npadding_length = tvb_reported_length(parameter_tvb) - length;\r\npaddingl = padding_length;\r\nswitch(iua_version){\r\ncase RFC:\r\nparameter_tree = proto_tree_add_subtree(v5ua_tree, parameter_tvb, PARAMETER_HEADER_OFFSET, -1, ett_v5ua_parameter, &parameter_item,\r\nval_to_str_const(tag, parameter_tag_values, "Unknown parameter"));\r\nproto_tree_add_item(parameter_tree, hf_parameter_tag, parameter_tvb, PARAMETER_TAG_OFFSET, PARAMETER_TAG_LENGTH, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase DRAFT:\r\ndefault:\r\nparameter_tree = proto_tree_add_subtree(v5ua_tree, parameter_tvb, PARAMETER_HEADER_OFFSET, -1, ett_v5ua_parameter, &parameter_item,\r\nval_to_str_const(tag, parameter_tag_draft_values, "Unknown parameter"));\r\nproto_tree_add_item(parameter_tree, hf_parameter_tag_draft, parameter_tvb, PARAMETER_TAG_OFFSET, PARAMETER_TAG_LENGTH, ENC_BIG_ENDIAN);\r\nbreak;\r\n};\r\nproto_tree_add_item(parameter_tree, hf_parameter_length, parameter_tvb, PARAMETER_LENGTH_OFFSET, PARAMETER_LENGTH_LENGTH, ENC_BIG_ENDIAN);\r\nswitch(tag) {\r\ncase INT_INTERFACE_IDENTIFIER_PARAMETER_TAG:\r\nif(iua_version == RFC) dissect_int_interface_identifier_parameter(parameter_tvb, parameter_tree, parameter_item);\r\nif(iua_version == DRAFT){\r\ndissect_int_interface_identifier_parameter(parameter_tvb, parameter_tree, parameter_item);\r\ndissect_dlci_parameter(parameter_tvb, parameter_tree, parameter_item, pinfo);\r\nif(msg_class==0 && msg_type==0) dissect_draft_error_code_parameter(parameter_tvb, parameter_tree);\r\nif(msg_class==1) dissect_draft_tei_status_parameter(parameter_tvb, parameter_tree, parameter_item);\r\nif(msg_class==9){\r\nif(msg_type==1||msg_type==2||msg_type==3||msg_type==4){\r\nguint16 length_2, offset;\r\ntvbuff_t *layer3_data_tvb;\r\noffset = tvb_get_ntohs(parameter_tvb, PARAMETER_LENGTH_OFFSET) + 8;\r\nlength_2 = msg_length - offset;\r\nif(length_2 > 0){\r\nif(tvb_get_guint8(parameter_tvb, offset) == 0x48){\r\nlayer3_data_tvb = tvb_new_subset_length(parameter_tvb, offset, length_2);\r\ndissect_layer3_message(layer3_data_tvb, v5ua_tree, parameter_item, pinfo);\r\n}\r\n}\r\n}\r\nelse if(msg_type==8||msg_type==10) dissect_release_reason_parameter(parameter_tvb, parameter_tree, parameter_item);\r\n}\r\n}\r\nbreak;\r\ncase ASP_MSG_PARAMETER_TAG:\r\ndissect_asp_msg_parameter(parameter_tvb, parameter_tree, parameter_item);\r\nbreak;\r\ncase TEXT_INTERFACE_IDENTIFIER_PARAMETER_TAG:\r\nif(iua_version == RFC)\r\ndissect_text_interface_identifier_parameter(parameter_tvb, parameter_tree, parameter_item);\r\nif(iua_version == DRAFT)\r\ndissect_scn_protocol_id_parameter(parameter_tvb, parameter_tree, parameter_item);\r\nbreak;\r\ncase INFO_PARAMETER_TAG:\r\ndissect_info_string_parameter(parameter_tvb, parameter_tree, parameter_item);\r\nbreak;\r\ncase DLCI_PARAMETER_TAG:\r\ndissect_dlci_parameter(parameter_tvb, parameter_tree, parameter_item, pinfo);\r\nbreak;\r\ncase DIAGNOSTIC_INFORMATION_PARAMETER_TAG:\r\ndissect_diagnostic_information_parameter(parameter_tvb, parameter_tree, parameter_item);\r\nbreak;\r\ncase INTEGER_RANGE_INTERFACE_IDENTIFIER_PARAMETER_TAG:\r\ndissect_integer_range_interface_identifier_parameter(parameter_tvb, parameter_tree, parameter_item);\r\nbreak;\r\ncase HEARTBEAT_DATA_PARAMETER_TAG:\r\ndissect_heartbeat_data_parameter(parameter_tvb, parameter_tree, parameter_item);\r\nbreak;\r\ncase ASP_DOWN_REASON_PARAMETER_TAG:\r\ndissect_asp_reason_parameter(parameter_tvb, parameter_tree, parameter_item);\r\nbreak;\r\ncase TRAFFIC_MODE_TYPE_PARAMETER_TAG:\r\ndissect_traffic_mode_type_parameter(parameter_tvb, parameter_tree, parameter_item);\r\nbreak;\r\ncase ERROR_CODE_PARAMETER_TAG:\r\ndissect_error_code_parameter(parameter_tvb, parameter_tree, parameter_item);\r\nbreak;\r\ncase STATUS_TYPE_INDENTIFICATION_PARAMETER_TAG:\r\ndissect_status_type_identification_parameter(parameter_tvb, parameter_tree, parameter_item);\r\nbreak;\r\ncase PROTOCOL_DATA_PARAMETER_TAG:\r\ndissect_layer3_message(parameter_tvb, v5ua_tree, parameter_item, pinfo);\r\nbreak;\r\ncase RELEASE_REASON_PARAMETER_TAG:\r\ndissect_release_reason_parameter(parameter_tvb, parameter_tree, parameter_item);\r\nbreak;\r\ncase TEI_STATUS_PARAMETER_TAG:\r\ndissect_tei_status_parameter(parameter_tvb, parameter_tree, parameter_item);\r\nbreak;\r\ncase ASP_IDENTIFIER_PARAMETER_TAG:\r\ndissect_asp_identifier_parameter(parameter_tvb, parameter_tree, parameter_item);\r\nbreak;\r\ncase LINK_STATUS_PARAMETER_TAG:\r\ndissect_link_status_parameter(parameter_tvb, parameter_tree, parameter_item);\r\nbreak;\r\ncase SA_BIT_STATUS_PARAMETER_TAG:\r\ndissect_sa_bit_status_parameter(parameter_tvb, parameter_tree, parameter_item);\r\nbreak;\r\ncase ERROR_INDICATION_PARAMETER_TAG:\r\ndissect_error_indication_parameter( parameter_tvb, parameter_tree, parameter_item);\r\nbreak;\r\ndefault:\r\ndissect_unknown_parameter(parameter_tvb, parameter_tree, parameter_item);\r\nbreak;\r\n};\r\nif (padding_length > 0){\r\nproto_tree_add_item(parameter_tree, hf_parameter_padding, parameter_tvb, PARAMETER_HEADER_OFFSET + length, padding_length, ENC_NA);\r\n}\r\n}\r\nstatic void\r\ndissect_parameters(tvbuff_t *parameters_tvb, packet_info *pinfo, proto_tree *tree _U_, proto_tree *v5ua_tree)\r\n{\r\ngint tag, offset, length, total_length, remaining_length;\r\ntvbuff_t *parameter_tvb;\r\noffset = 0;\r\nwhile((remaining_length = tvb_reported_length_remaining(parameters_tvb, offset))) {\r\ntag = tvb_get_ntohs(parameters_tvb, offset + PARAMETER_TAG_OFFSET);\r\nlength = tvb_get_ntohs(parameters_tvb, offset + PARAMETER_LENGTH_OFFSET);\r\nif(iua_version==DRAFT){\r\nif(tag==0x1) length += 8;\r\nelse if(tag<=0x4) length += PARAMETER_HEADER_LENGTH;\r\nif((msg_class==0 || msg_class==1 || msg_class==9)&&msg_type<=10)\r\nlength = msg_length;\r\n}\r\ntotal_length = ADD_PADDING(length);\r\nif (remaining_length >= length)\r\ntotal_length = MIN(total_length, remaining_length);\r\nparameter_tvb = tvb_new_subset_length(parameters_tvb, offset, total_length);\r\ndissect_parameter(parameter_tvb, pinfo, v5ua_tree);\r\noffset += total_length;\r\n}\r\n}\r\nstatic void\r\ndissect_common_header(tvbuff_t *common_header_tvb, packet_info *pinfo, proto_tree *v5ua_tree)\r\n{\r\nproto_item *common_header_item;\r\nproto_tree *common_header_tree;\r\nguint8 message_class, message_type;\r\nmessage_class = tvb_get_guint8(common_header_tvb, COMMON_HEADER_MSG_CLASS_OFFSET);\r\nmessage_type = tvb_get_guint8(common_header_tvb, COMMON_HEADER_MSG_TYPE_OFFSET);\r\ncol_set_str(pinfo->cinfo, COL_INFO, val_to_str_const(message_class * 256 + message_type, msg_class_type_values_short, "UNKNOWN"));\r\nif (v5ua_tree) {\r\ncommon_header_tree = proto_tree_add_subtree(v5ua_tree, common_header_tvb, COMMON_HEADER_OFFSET, -1,\r\nett_v5ua_common_header, &common_header_item, "Common Msg-Header");\r\nproto_tree_add_item(common_header_tree, hf_version, common_header_tvb, COMMON_HEADER_VERSION_OFFSET, COMMON_HEADER_VERSION_LENGTH, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(common_header_tree, hf_reserved, common_header_tvb, COMMON_HEADER_RESERVED_OFFSET, COMMON_HEADER_RESERVED_LENGTH, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(common_header_tree, hf_msg_class, common_header_tvb, COMMON_HEADER_MSG_CLASS_OFFSET, COMMON_HEADER_MSG_CLASS_LENGTH, ENC_BIG_ENDIAN);\r\nproto_tree_add_uint_format_value(common_header_tree, hf_msg_type,\r\ncommon_header_tvb, COMMON_HEADER_MSG_TYPE_OFFSET, COMMON_HEADER_MSG_TYPE_LENGTH,\r\nmessage_type, "%s ( %u )",\r\nval_to_str_const(message_class * 256 + message_type, msg_class_type_values, "reserved"), message_type);\r\nproto_tree_add_item(common_header_tree, hf_msg_length, common_header_tvb, COMMON_HEADER_MSG_LENGTH_OFFSET, COMMON_HEADER_MSG_LENGTH_LENGTH, ENC_BIG_ENDIAN);\r\nproto_item_append_text(common_header_item, " (%s)",val_to_str_const(message_class * 256 + message_type, msg_class_type_values, "Unknown Msg-Type"));\r\nmessageclassCopy = message_class;\r\n}\r\nif (iua_version == DRAFT){\r\nmsg_class = message_class;\r\nmsg_type = message_type;\r\nmsg_length = tvb_get_ntohl (common_header_tvb, COMMON_HEADER_MSG_LENGTH_OFFSET);\r\n}\r\n}\r\nstatic void\r\ndissect_v5ua_message(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, proto_tree *v5ua_tree)\r\n{\r\ntvbuff_t *common_header_tvb, *parameters_tvb;\r\ncommon_header_tvb = tvb_new_subset_length(tvb, COMMON_HEADER_OFFSET, COMMON_HEADER_LENGTH);\r\ndissect_common_header(common_header_tvb, pinfo, v5ua_tree);\r\nparameters_tvb = tvb_new_subset_remaining(tvb, COMMON_HEADER_LENGTH);\r\ndissect_parameters(parameters_tvb, pinfo, tree, v5ua_tree);\r\nif (dlci_efa >= 0 && dlci_efa <= 8175) {\r\nif ((messageclassCopy == 0) || (messageclassCopy == 3) || (messageclassCopy == 4)) {\r\nmessageclassCopy = -1;\r\n}\r\nelse {\r\ncol_append_str(pinfo->cinfo, COL_INFO, " | ");\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "LinkId: %u", linkIdentifier);\r\n}\r\n}\r\nif (sa_bit_id > -1) {\r\ncol_append_str(pinfo->cinfo, COL_INFO, " | ");\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "SA7bit: %u", sa_bit_id);\r\nsa_bit_id = -1;\r\n}\r\nif (link_status_operational > -1) {\r\nif (link_status_operational == 0) {\r\ncol_append_str(pinfo->cinfo, COL_INFO, " | operational");\r\n}\r\nelse if (link_status_operational == 1) {\r\ncol_append_str(pinfo->cinfo, COL_INFO, " | non-operational");\r\n}\r\nlink_status_operational = -1;\r\n}\r\n}\r\nstatic int\r\ndissect_v5ua(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\ngint offset, remaining_length, length, tag, one_bit;\r\nproto_tree *v5ua_tree;\r\nproto_item *ti;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "V5UA");\r\ncol_clear(pinfo->cinfo, COL_INFO);\r\nti = proto_tree_add_item(tree, proto_v5ua, tvb, 0, -1, ENC_NA);\r\nv5ua_tree = proto_item_add_subtree(ti, ett_v5ua);\r\niua_version = RFC;\r\noffset = COMMON_HEADER_LENGTH;\r\nremaining_length = tvb_reported_length_remaining(tvb, offset);\r\nwhile(remaining_length) {\r\ntag = tvb_get_ntohs(tvb, offset);\r\nif(tag==0x1){\r\nlength = tvb_get_ntohs(tvb, offset+2);\r\ntag = tvb_get_ntohs(tvb, offset+length);\r\nif(tag==0x81){\r\nremaining_length = FALSE;\r\n}\r\nelse{\r\none_bit = tvb_get_guint8(tvb, offset+4+length+1);\r\nif((one_bit & 0x01) == 0x01){\r\niua_version = DRAFT;\r\nremaining_length = FALSE;\r\n}\r\nelse{\r\nproto_item_append_text(v5ua_tree, " !! DLCI INCORRECT !!");\r\niua_version = DRAFT;\r\nremaining_length = FALSE;\r\n}\r\n}\r\n}\r\nelse if(tag==0x02){\r\niua_version = DRAFT;\r\nremaining_length = FALSE;\r\n}\r\nelse if(tag==0x03){\r\niua_version = RFC;\r\nremaining_length = FALSE;\r\n}\r\nelse if(tag==0x11){\r\nremaining_length = FALSE;\r\n}\r\nelse if(tag==0x04 || tag == 0x0a || tag == 0x0b || tag == 0x0c || tag == 0x0d){\r\nremaining_length = FALSE;\r\n}\r\nelse{\r\noffset+=2;\r\nremaining_length = tvb_reported_length_remaining(tvb, offset);\r\n}\r\nif(iua_version == DRAFT){\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "V5UA (draft)");\r\n}\r\n}\r\ndissect_v5ua_message(tvb, pinfo, tree, v5ua_tree);\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_v5ua(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_version,\r\n{ "Version", "v5ua.version",\r\nFT_UINT8, BASE_DEC, VALS(v5ua_protocol_version_values), 0x0,\r\nNULL, HFILL } },\r\n{ &hf_reserved,\r\n{ "Reserved", "v5ua.reserved",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL } },\r\n{ &hf_msg_class,\r\n{ "Message class", "v5ua.msg_class",\r\nFT_UINT8, BASE_DEC, VALS(msg_class_values), 0x0,\r\nNULL, HFILL } },\r\n{ &hf_msg_type,\r\n{ "Message Type", "v5ua.msg_type",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL } },\r\n#if 0\r\n{ &hf_msg_type_id,\r\n{ "Message Type ID", "v5ua.msg_type_id",\r\nFT_UINT8, BASE_DEC, VALS(msg_class_type_values), 0x0,\r\nNULL, HFILL } },\r\n#endif\r\n{ &hf_msg_length,\r\n{ "Message length", "v5ua.msg_length",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL } },\r\n{ &hf_link_id,\r\n{ "Link Identifier", "v5ua.link_id",\r\nFT_UINT32, BASE_DEC, NULL, 0xffffffe0,\r\nNULL, HFILL } },\r\n{ &hf_chnl_id,\r\n{ "Channel Identifier", "v5ua.channel_id",\r\nFT_UINT8, BASE_DEC, NULL, 0x1f,\r\nNULL, HFILL } },\r\n{ &hf_adaptation_layer_id,\r\n{ "Adaptation Layer ID", "v5ua.adaptation_layer_id",\r\nFT_STRING, BASE_NONE,NULL, 0x0,\r\nNULL, HFILL } },\r\n{ &hf_text_if_id,\r\n{ "Text interface identifier","v5ua.text_interface_id",\r\nFT_STRING, BASE_NONE,NULL, 0x0,\r\nNULL, HFILL } },\r\n{ &hf_scn_protocol_id,\r\n{ "SCN Protocol Identifier","v5ua.scn_protocol_id",\r\nFT_STRING, BASE_NONE,NULL, 0x0,\r\nNULL, HFILL } },\r\n{ &hf_info_string,\r\n{ "Info String", "v5ua.info_string",\r\nFT_STRING, BASE_NONE,NULL, 0x0,\r\nNULL, HFILL } },\r\n{ &hf_asp_identifier,\r\n{ "ASP Identifier", "v5ua.asp_identifier",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL } },\r\n{ &hf_dlci_zero_bit,\r\n{ "Zero bit", "v5ua.dlci_zero_bit",\r\nFT_BOOLEAN, 8, NULL, 0x01,\r\nNULL, HFILL } },\r\n{ &hf_dlci_spare_bit,\r\n{ "Spare bit", "v5ua.dlci_spare_bit",\r\nFT_BOOLEAN, 8, NULL, 0x02,\r\nNULL, HFILL } },\r\n{ &hf_dlci_sapi,\r\n{ "SAPI", "v5ua.dlci_sapi",\r\nFT_UINT8, BASE_HEX, NULL, 0xfc,\r\nNULL, HFILL } },\r\n{ &hf_dlci_one_bit,\r\n{ "One bit", "v5ua.dlci_one_bit",\r\nFT_BOOLEAN, 8, NULL, 0x01,\r\nNULL, HFILL } },\r\n{ &hf_dlci_tei,\r\n{ "TEI", "v5ua.dlci_tei",\r\nFT_UINT8, BASE_HEX, NULL, 0xfe,\r\nNULL, HFILL } },\r\n{ &hf_efa,\r\n{ "Envelope Function Address","v5ua.efa",\r\nFT_UINT16, BASE_DEC, VALS(efa_values), 0x0,\r\nNULL, HFILL } },\r\n#if 0\r\n{ &hf_spare_efa,\r\n{ "Envelope Function Address (spare)","v5ua.efa",\r\nFT_UINT16, BASE_DEC, NULL, ~7,\r\nNULL, HFILL } },\r\n#endif\r\n{ &hf_asp_reason,\r\n{ "Reason", "v5ua.asp_reason",\r\nFT_UINT32, BASE_HEX, VALS(asp_reason_values), 0x0,\r\nNULL, HFILL } },\r\n{ &hf_release_reason,\r\n{ "Release Reason", "v5ua.release_reason",\r\nFT_UINT32, BASE_HEX, VALS(release_reason_values), 0x0,\r\nNULL, HFILL } },\r\n{ &hf_tei_status,\r\n{ "TEI status", "v5ua.tei_status",\r\nFT_UINT32, BASE_HEX, VALS(tei_status_values), 0x0,\r\nNULL, HFILL } },\r\n{ &hf_tei_draft_status,\r\n{ "TEI status", "v5ua.tei_draft_status",\r\nFT_UINT32, BASE_HEX, VALS(tei_draft_status_values), 0x0,\r\nNULL, HFILL } },\r\n{ &hf_link_status,\r\n{ "Link Status", "v5ua.link_status",\r\nFT_UINT32, BASE_HEX, VALS(link_status_values), 0x0,\r\nNULL, HFILL } },\r\n{ &hf_sa_bit_id,\r\n{ "BIT ID", "v5ua.sa_bit_id",\r\nFT_UINT16, BASE_HEX, VALS(sa_bit_values), 0x0,\r\nNULL, HFILL } },\r\n{ &hf_sa_bit_value,\r\n{ "Bit Value", "v5ua.sa_bit_value",\r\nFT_UINT16, BASE_HEX, VALS(sa_bit_values), 0x0,\r\nNULL, HFILL } },\r\n{ &hf_parameter_tag,\r\n{ "Parameter Tag", "v5ua.parameter_tag",\r\nFT_UINT16, BASE_HEX, VALS(parameter_tag_values), 0x0,\r\nNULL, HFILL } },\r\n{ &hf_parameter_tag_draft,\r\n{ "Parameter Tag", "v5ua.parameter_tag",\r\nFT_UINT16, BASE_HEX, VALS(parameter_tag_draft_values), 0x0,\r\nNULL, HFILL } },\r\n{ &hf_parameter_length,\r\n{ "Parameter length", "v5ua.parameter_length",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL } },\r\n{ &hf_parameter_value,\r\n{ "Parameter value", "v5ua.parameter_value",\r\nFT_BYTES, BASE_NONE,NULL, 0x0,\r\nNULL, HFILL } },\r\n{ &hf_parameter_padding,\r\n{ "Parameter padding", "v5ua.parameter_padding",\r\nFT_BYTES, BASE_NONE,NULL, 0x0,\r\nNULL, HFILL } },\r\n{ &hf_diagnostic_info,\r\n{ "Diagnostic Information", "v5ua.diagnostic_info",\r\nFT_BYTES, BASE_NONE,NULL, 0x0,\r\nNULL, HFILL } },\r\n{ &hf_if_range_start,\r\n{ "Interface range Start", "v5ua.interface_range_start",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL } },\r\n{ &hf_if_range_end,\r\n{ "Interface range End", "v5ua.interface_range_end",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL } },\r\n{ &hf_heartbeat_data,\r\n{ "Heartbeat data", "v5ua.heartbeat_data",\r\nFT_BYTES, BASE_NONE,NULL, 0x0,\r\nNULL, HFILL } },\r\n{ &hf_traffic_mode_type,\r\n{ "Traffic mode type", "v5ua.traffic_mode_type",\r\nFT_UINT32, BASE_HEX, VALS(traffic_mode_type_values), 0x0,\r\nNULL, HFILL } },\r\n{ &hf_error_code,\r\n{ "Error code", "v5ua.error_code",\r\nFT_UINT32, BASE_HEX, VALS(error_code_values), 0x0,\r\nNULL, HFILL } },\r\n{ &hf_draft_error_code,\r\n{ "Error code (draft)", "v5ua.draft_error_code",\r\nFT_UINT32, BASE_HEX, VALS(draft_error_code_values), 0x0,\r\nNULL, HFILL } },\r\n{ &hf_status_type,\r\n{ "Status type", "v5ua.status_type",\r\nFT_UINT16, BASE_DEC, VALS(status_type_values), 0x0,\r\nNULL, HFILL } },\r\n{ &hf_status_id,\r\n{ "Status identification", "v5ua.status_id",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL } },\r\n{ &hf_error_reason,\r\n{ "Error Reason", "v5ua.error_reason",\r\nFT_UINT32, BASE_HEX, VALS(error_reason_values), 0x0,\r\nNULL, HFILL } }\r\n};\r\nstatic gint *ett[] = {\r\n&ett_v5ua,\r\n&ett_v5ua_common_header,\r\n&ett_v5ua_parameter,\r\n&ett_v5ua_layer3\r\n};\r\nproto_v5ua = proto_register_protocol("V5.2-User Adaptation Layer", "V5UA", "v5ua");\r\nproto_register_field_array(proto_v5ua, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid\r\nproto_reg_handoff_v5ua(void)\r\n{\r\ndissector_handle_t v5ua_handle;\r\nv5ua_handle = create_dissector_handle(dissect_v5ua, proto_v5ua);\r\nq931_handle = find_dissector_add_dependency("q931", proto_v5ua);\r\nv52_handle = find_dissector_add_dependency("v52", proto_v5ua);\r\ndissector_add_uint("sctp.port", SCTP_PORT_V5UA_DRAFT, v5ua_handle);\r\ndissector_add_uint("sctp.port", SCTP_PORT_V5UA_RFC, v5ua_handle);\r\ndissector_add_uint("sctp.ppi", V5UA_PAYLOAD_PROTOCOL_ID, v5ua_handle);\r\n}
