static void\r\nprt_sa32(gchar *buff, guint32 val)\r\n{\r\ndouble deg, min, sec;\r\ndouble x = (double) ((gint32) val);\r\nx /= (double) (1UL<<30);\r\nx *= 45.0;\r\ndeg = floor(x);\r\nmin = floor(60.0 * (x - deg));\r\nsec = 60.0 * (60.0 * (x - deg) - min);\r\ng_snprintf(buff, ITEM_LABEL_LENGTH, "%.8f degrees (%.0f %.0f\' %.2f\")", x, deg, min, sec);\r\n}\r\nstatic void\r\nprt_ba32(gchar *buff, guint32 val)\r\n{\r\ndouble deg, min, sec;\r\ndouble x = (double) val;\r\nx /= (double) (1UL<<30);\r\nx *= 90.0;\r\ndeg = floor(x);\r\nmin = floor(60.0 * (x - deg));\r\nsec = 60.0 * (60.0 * (x - deg) - min);\r\ng_snprintf(buff, ITEM_LABEL_LENGTH, "%.8f degrees (%.0f %.0f\' %.2f\")", x, deg, min, sec);\r\n}\r\nstatic void\r\nprt_sa16(gchar *buff, guint32 val)\r\n{\r\ndouble x = (double) ((gint32) val);\r\nx /= (double) (1<<14);\r\nx *= 90.0;\r\ng_snprintf(buff, ITEM_LABEL_LENGTH, "%.3f degrees", x);\r\n}\r\nstatic void\r\nprt_ba16(gchar *buff, guint32 val)\r\n{\r\ndouble x = (double) val;\r\nx /= (double) (1<<14);\r\nx *= 90.0;\r\ng_snprintf(buff, ITEM_LABEL_LENGTH, "%.3f degrees", x);\r\n}\r\nstatic void\r\nprt_ba16_none(gchar *buff, guint32 val)\r\n{\r\ndouble x = (double) val;\r\nx /= (double) (1<<14);\r\nx *= 90.0;\r\nif (val <= 65536)\r\ng_snprintf(buff, ITEM_LABEL_LENGTH, "No Statement");\r\nelse\r\ng_snprintf(buff, ITEM_LABEL_LENGTH, "%.3f degrees", x);\r\n}\r\nstatic void\r\nprt_kilo(gchar *buff, guint32 val)\r\n{\r\ndouble x = (double) ((gint32) val);\r\nx /= 128.0;\r\ng_snprintf(buff, ITEM_LABEL_LENGTH, "%.2f kilometers", x);\r\n}\r\nstatic void\r\nprt_meters(gchar *buff, guint32 val)\r\n{\r\ndouble x = (double) ((gint32) val);\r\ng_snprintf(buff, ITEM_LABEL_LENGTH, "%.0f meters", x);\r\n}\r\nstatic void\r\nprt_decimeters(gchar *buff, guint32 val)\r\n{\r\ndouble x = (double) ((gint32) val);\r\nx /= 10.0;\r\ng_snprintf(buff, ITEM_LABEL_LENGTH, "%.1f meters", x);\r\n}\r\nstatic void\r\nprt_centimeters(gchar *buff, guint32 val)\r\n{\r\ndouble x = (double) ((gint32) val);\r\nx /= 100.0;\r\ng_snprintf(buff, ITEM_LABEL_LENGTH, "%.2f meters", x);\r\n}\r\nstatic void\r\nprt_speed(gchar *buff, guint32 val)\r\n{\r\ndouble x = (double) val;\r\nx /= 1000.0;\r\ng_snprintf(buff, ITEM_LABEL_LENGTH, "%.3f meters/second", x);\r\n}\r\nstatic void\r\nprt_speed_centi(gchar *buff, guint32 val)\r\n{\r\ndouble x = (double) ((gint32) val);\r\nx /= 100.0;\r\ng_snprintf(buff, ITEM_LABEL_LENGTH, "%.2f meters/second", x);\r\n}\r\nstatic void\r\nprt_speed_deci(gchar *buff, guint32 val)\r\n{\r\ndouble x = (double) ((gint32) val);\r\nx /= 10.0;\r\ng_snprintf(buff, ITEM_LABEL_LENGTH, "%.1f meters/second", x);\r\n}\r\nstatic void\r\nprt_millisec(gchar *buff, guint32 val)\r\n{\r\ndouble x = (double) val;\r\nx /= 1000.0;\r\ng_snprintf(buff, ITEM_LABEL_LENGTH, "%.3f seconds", x);\r\n}\r\nstatic void\r\nprt_none8(gchar *buff, guint32 val)\r\n{\r\nif (0xff == val)\r\ng_snprintf(buff, ITEM_LABEL_LENGTH, "No Statement");\r\nelse\r\ng_snprintf(buff, ITEM_LABEL_LENGTH, "%d", val);\r\n}\r\nstatic void\r\nprt_none16(gchar *buff, guint32 val)\r\n{\r\nif (0xffff == val)\r\ng_snprintf(buff, ITEM_LABEL_LENGTH, "No Statement");\r\nelse\r\ng_snprintf(buff, ITEM_LABEL_LENGTH, "%d", val);\r\n}\r\nstatic gint\r\ndissect_mission(tvbuff_t *tvb, proto_tree *seg_tree, gint offset)\r\n{\r\nproto_tree_add_item(seg_tree, hf_4607_mission_plan, tvb, offset, 12, ENC_ASCII|ENC_NA);\r\noffset += 12;\r\nproto_tree_add_item(seg_tree, hf_4607_mission_flight_plan, tvb, offset, 12, ENC_ASCII|ENC_NA);\r\noffset += 12;\r\nproto_tree_add_item(seg_tree, hf_4607_mission_platform, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(seg_tree, hf_4607_mission_platform_config, tvb, offset, 10, ENC_ASCII|ENC_NA);\r\noffset += 10;\r\nproto_tree_add_item(seg_tree, hf_4607_mission_time_year, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(seg_tree, hf_4607_mission_time_month, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(seg_tree, hf_4607_mission_time_day, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nreturn offset;\r\n}\r\nstatic gint\r\ndissect_target(tvbuff_t *tvb, proto_tree *seg_tree, gint offset, guint64 mask)\r\n{\r\nproto_item *rpt_item = NULL;\r\nproto_tree *rpt_tree = seg_tree;\r\nif (SET(mask, D32_1)) {\r\nrpt_item = proto_tree_add_item(rpt_tree, hf_4607_dwell_report_index, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nrpt_tree = proto_item_add_subtree(rpt_item, ett_4607_rpt);\r\n}\r\nif (SET(mask, D32_2)) {\r\nrpt_item = proto_tree_add_item(rpt_tree, hf_4607_dwell_report_lat, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(rpt_tree, hf_4607_dwell_report_lon, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\n} else {\r\nrpt_item = proto_tree_add_item(rpt_tree, hf_4607_dwell_report_delta_lat, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(rpt_tree, hf_4607_dwell_report_delta_lon, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\nif (rpt_item && rpt_tree == seg_tree) {\r\nrpt_tree = proto_item_add_subtree(rpt_item, ett_4607_rpt);\r\n}\r\nif (SET(mask, D32_6)) {\r\nproto_tree_add_item(rpt_tree, hf_4607_dwell_report_height, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\nif (SET(mask, D32_7)) {\r\nproto_tree_add_item(rpt_tree, hf_4607_dwell_report_radial, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(rpt_tree, hf_4607_dwell_report_wrap, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\nif (SET(mask, D32_9)) {\r\nproto_tree_add_item(rpt_tree, hf_4607_dwell_report_snr, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\nif (SET(mask, D32_10)) {\r\nproto_tree_add_item(rpt_tree, hf_4607_dwell_report_class, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\nif (SET(mask, D32_11)) {\r\nproto_tree_add_item(rpt_tree, hf_4607_dwell_report_prob, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\nif (SET(mask, D32_12)) {\r\nproto_tree_add_item(rpt_tree, hf_4607_dwell_report_unc_slant, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(rpt_tree, hf_4607_dwell_report_unc_cross, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(rpt_tree, hf_4607_dwell_report_unc_height, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(rpt_tree, hf_4607_dwell_report_unc_radial, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\nif (SET(mask, D32_16)) {\r\nproto_tree_add_item(rpt_tree, hf_4607_dwell_report_tag_app, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(rpt_tree, hf_4607_dwell_report_tag_entity, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\n}\r\nif (SET(mask, D32_18)) {\r\nproto_tree_add_item(rpt_tree, hf_4607_dwell_report_section, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\nreturn offset;\r\n}\r\nstatic gint\r\ndissect_dwell(tvbuff_t *tvb, proto_tree *seg_tree, gint offset)\r\n{\r\nguint64 mask;\r\nguint32 count;\r\nmask = tvb_get_ntoh64(tvb, offset);\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_mask, tvb, offset, 8, ENC_BIG_ENDIAN);\r\noffset += 8;\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_revisit_index, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_dwell_index, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_last_dwell, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\ncount = tvb_get_ntohs(tvb, offset);\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_count, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_time, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_sensor_lat, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_sensor_lon, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_sensor_alt, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nif (SET(mask, D10)) {\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_scale_lat, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_scale_lon, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\n}\r\nif (SET(mask, D12)) {\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_unc_along, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_unc_cross, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_unc_alt, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\nif (SET(mask, D15)) {\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_track, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_speed, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_vert_velocity, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\nif (SET(mask, D18)) {\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_track_unc, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_speed_unc, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_vv_unc, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\nif (SET(mask, D21)) {\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_plat_heading, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_plat_pitch, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_plat_roll, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_da_lat, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_da_lon, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_da_range, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_da_angle, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nif (SET(mask, D28)) {\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_sensor_heading, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_sensor_pitch, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_sensor_roll, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\n}\r\nif (SET(mask, D31)) {\r\nproto_tree_add_item(seg_tree, hf_4607_dwell_mdv, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\n}\r\nwhile (count--) {\r\noffset = dissect_target(tvb, seg_tree, offset, mask);\r\n}\r\nreturn offset;\r\n}\r\nstatic gint\r\ndissect_jobdef(tvbuff_t *tvb, proto_tree *seg_tree, gint offset)\r\n{\r\nproto_tree_add_item(seg_tree, hf_4607_jobdef_job_id, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(seg_tree, hf_4607_jobdef_sensor_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(seg_tree, hf_4607_jobdef_sensor_model, tvb, offset, 6, ENC_ASCII|ENC_NA);\r\noffset += 6;\r\nproto_tree_add_item(seg_tree, hf_4607_jobdef_filter, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(seg_tree, hf_4607_jobdef_priority, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(seg_tree, hf_4607_jobdef_ba_lat_a, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(seg_tree, hf_4607_jobdef_ba_lon_a, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(seg_tree, hf_4607_jobdef_ba_lat_b, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(seg_tree, hf_4607_jobdef_ba_lon_b, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(seg_tree, hf_4607_jobdef_ba_lat_c, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(seg_tree, hf_4607_jobdef_ba_lon_c, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(seg_tree, hf_4607_jobdef_ba_lat_d, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(seg_tree, hf_4607_jobdef_ba_lon_d, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(seg_tree, hf_4607_jobdef_radar_mode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(seg_tree, hf_4607_jobdef_revisit_interval, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(seg_tree, hf_4607_jobdef_unc_along, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(seg_tree, hf_4607_jobdef_unc_cross, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(seg_tree, hf_4607_jobdef_unc_alt, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(seg_tree, hf_4607_jobdef_unc_heading, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(seg_tree, hf_4607_jobdef_unc_speed, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(seg_tree, hf_4607_jobdef_sense_slant, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(seg_tree, hf_4607_jobdef_sense_cross, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(seg_tree, hf_4607_jobdef_sense_vlos, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(seg_tree, hf_4607_jobdef_sense_mdv, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(seg_tree, hf_4607_jobdef_sense_prob, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(seg_tree, hf_4607_jobdef_sense_alarm, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(seg_tree, hf_4607_jobdef_terrain_model, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nproto_tree_add_item(seg_tree, hf_4607_jobdef_geoid_model, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nreturn offset;\r\n}\r\nstatic gint\r\ndissect_platform_location(tvbuff_t *tvb, proto_tree *seg_tree, gint offset)\r\n{\r\nproto_tree_add_item(seg_tree, hf_4607_platloc_time, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(seg_tree, hf_4607_platloc_latitude, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(seg_tree, hf_4607_platloc_longitude, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(seg_tree, hf_4607_platloc_altitude, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(seg_tree, hf_4607_platloc_track, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nproto_tree_add_item(seg_tree, hf_4607_platloc_speed, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nproto_tree_add_item(seg_tree, hf_4607_platloc_vertical_velocity, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 1;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_stanag4607(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nguint32 offset = 0;\r\ngint8 first_segment;\r\nguint32 pkt_size = 0;\r\nproto_item *ti = NULL;\r\nproto_tree *hdr_tree = NULL;\r\nproto_item *seg_type = NULL;\r\nproto_tree *seg_tree = NULL;\r\nguint8 seg_id = 0;\r\nif (tvb_captured_length(tvb) < STANAG4607_MIN_LENGTH)\r\nreturn 0;\r\ncol_set_str(pinfo->cinfo, COL_PROTOCOL, "S4607");\r\ncol_clear(pinfo->cinfo, COL_INFO);\r\nfirst_segment = tvb_get_guint8(tvb, 32);\r\ncol_add_str(pinfo->cinfo, COL_INFO,\r\nval_to_str(first_segment, stanag4607_segment_vals, "Unknown (0x%02x)"));\r\nif (PLATFORM_LOCATION_SEGMENT == first_segment) {\r\nguint32 millisecs;\r\nnstime_t ts;\r\nmillisecs = tvb_get_ntohl(tvb, 37);\r\nts.secs = millisecs / 1000;\r\nts.nsecs = (int)((millisecs - 1000 * ts.secs) * 1000000);\r\ncol_set_time(pinfo->cinfo, COL_REL_TIME, &ts, "s4607.ploc.time");\r\n}\r\nif (tree) {\r\nti = proto_tree_add_item(tree, proto_stanag4607, tvb, 0, -1, ENC_NA);\r\nhdr_tree = proto_item_add_subtree(ti, ett_4607_hdr);\r\nproto_tree_add_item(hdr_tree, hf_4607_version, tvb, 0, 2, ENC_ASCII|ENC_NA);\r\nti = proto_tree_add_item(hdr_tree, hf_4607_packet_size, tvb, 2, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(hdr_tree, hf_4607_nationality, tvb, 6, 2, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(hdr_tree, hf_4607_sec_class, tvb, 8, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(hdr_tree, hf_4607_sec_system, tvb, 9, 2, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(hdr_tree, hf_4607_sec_code, tvb, 11, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(hdr_tree, hf_4607_exercise_indicator, tvb, 13, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(hdr_tree, hf_4607_platform_id, tvb, 14, 10, ENC_ASCII|ENC_NA);\r\nproto_tree_add_item(hdr_tree, hf_4607_mission_id, tvb, 24, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(hdr_tree, hf_4607_job_id, tvb, 28, 4, ENC_BIG_ENDIAN);\r\n}\r\noffset = 32;\r\npkt_size = tvb_get_ntohl(tvb, 2);\r\nif (tvb_reported_length(tvb) != pkt_size) {\r\nexpert_add_info(pinfo, ti, &ei_bad_packet_size);\r\npkt_size = tvb_reported_length(tvb);\r\n}\r\nwhile (offset < pkt_size) {\r\nguint32 seg_size = 0;\r\nguint32 saved_offset = offset;\r\nproto_item * pi;\r\nseg_type = proto_tree_add_item(hdr_tree, hf_4607_segment_type, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nseg_id = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\nseg_tree = proto_item_add_subtree(seg_type, ett_4607_seg);\r\npi = proto_tree_add_item(seg_tree, hf_4607_segment_size, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nseg_size = tvb_get_ntohl(tvb, offset);\r\noffset += 4;\r\nif (seg_size < MINIMUM_SEGMENT_SIZE) {\r\nseg_size = MINIMUM_SEGMENT_SIZE;\r\ncol_append_str(pinfo->cinfo, COL_INFO, ", Error: Invalid segment size ");\r\nexpert_add_info(pinfo, pi, &ei_too_short);\r\n}\r\nswitch (seg_id) {\r\ncase MISSION_SEGMENT:\r\nCHK_SIZE(MISSION_SEGMENT);\r\noffset = dissect_mission(tvb, seg_tree, offset);\r\nbreak;\r\ncase DWELL_SEGMENT:\r\noffset = dissect_dwell(tvb, seg_tree, offset);\r\nbreak;\r\ncase JOB_DEFINITION_SEGMENT:\r\nCHK_SIZE(JOB_DEFINITION_SEGMENT);\r\noffset = dissect_jobdef(tvb, seg_tree, offset);\r\nbreak;\r\ncase PLATFORM_LOCATION_SEGMENT:\r\nCHK_SIZE(PLATFORM_LOCATION_SEGMENT);\r\noffset = dissect_platform_location(tvb, seg_tree, offset);\r\nbreak;\r\ndefault:\r\noffset += seg_size - 5;\r\nbreak;\r\n}\r\nif (offset < saved_offset) {\r\nbreak;\r\n}\r\n}\r\nreturn tvb_captured_length(tvb);\r\n}\r\nvoid\r\nproto_register_stanag4607(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_4607_version,\r\n{ "Version ID", "s4607.version",\r\nFT_STRING, BASE_NONE,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_packet_size,\r\n{ "Packet Size", "s4607.size",\r\nFT_UINT32, BASE_DEC,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_nationality,\r\n{ "Nationality", "s4607.nationality",\r\nFT_STRING, BASE_NONE,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_sec_class,\r\n{ "Security Classification", "s4607.sec.class",\r\nFT_UINT8, BASE_DEC,\r\nVALS(stanag4607_class_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_sec_system,\r\n{ "Security System", "s4607.sec.system",\r\nFT_STRING, BASE_NONE,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_sec_code,\r\n{ "Security Codes", "s4607.sec.codes",\r\nFT_UINT16, BASE_HEX,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_exercise_indicator,\r\n{ "Exercise Indicator", "s4607.exind",\r\nFT_UINT8, BASE_DEC,\r\nVALS(stanag4607_exind_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_platform_id,\r\n{ "Platform ID", "s4607.platform",\r\nFT_STRING, BASE_NONE,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_mission_id,\r\n{ "Mission ID", "s4607.mission",\r\nFT_UINT32, BASE_DEC,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_job_id,\r\n{ "Job ID", "s4607.job",\r\nFT_UINT32, BASE_DEC,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_segment_type,\r\n{ "Segment Type", "s4607.seg.type",\r\nFT_UINT8, BASE_DEC,\r\nVALS(stanag4607_segment_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_segment_size,\r\n{ "Segment Size", "s4607.seg.size",\r\nFT_UINT32, BASE_DEC,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_mask,\r\n{ "Existence Mask", "s4607.dwell.mask",\r\nFT_UINT64, BASE_HEX,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_revisit_index,\r\n{ "Revisit Index", "s4607.dwell.revisit",\r\nFT_UINT16, BASE_DEC,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_dwell_index,\r\n{ "Dwell Index", "s4607.dwell.dwell",\r\nFT_UINT16, BASE_DEC,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_last_dwell,\r\n{ "Last Dwell of Revisit", "s4607.dwell.last",\r\nFT_UINT8, BASE_DEC,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_count,\r\n{ "Target Report Count", "s4607.dwell.count",\r\nFT_UINT16, BASE_DEC,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_time,\r\n{ "Dwell Time", "s4607.dwell.time",\r\nFT_UINT32, BASE_CUSTOM,\r\nCF_FUNC(prt_millisec), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_sensor_lat,\r\n{ "Sensor Position Latitude", "s4607.dwell.sensor.lat",\r\nFT_INT32, BASE_CUSTOM,\r\nCF_FUNC(prt_sa32), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_sensor_lon,\r\n{ "Sensor Position Longitude", "s4607.dwell.sensor.lon",\r\nFT_UINT32, BASE_CUSTOM,\r\nCF_FUNC(prt_ba32), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_sensor_alt,\r\n{ "Sensor Position Altitude", "s4607.dwell.sensor.alt",\r\nFT_INT32, BASE_CUSTOM,\r\nCF_FUNC(prt_centimeters), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_scale_lat,\r\n{ "Scale Factor, Latitude", "s4607.dwell.scale.lat",\r\nFT_INT32, BASE_CUSTOM,\r\nCF_FUNC(prt_sa32), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_scale_lon,\r\n{ "Scale Factor, Longitude", "s4607.dwell.scale.lon",\r\nFT_UINT32, BASE_CUSTOM,\r\nCF_FUNC(prt_ba32), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_unc_along,\r\n{ "Sensor Position Uncertainty Along Track", "s4607.dwell.unc.along",\r\nFT_UINT32, BASE_CUSTOM,\r\nCF_FUNC(prt_centimeters), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_unc_cross,\r\n{ "Sensor Position Uncertainty Cross Track", "s4607.dwell.unc.cross",\r\nFT_UINT32, BASE_CUSTOM,\r\nCF_FUNC(prt_centimeters), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_unc_alt,\r\n{ "Sensor Position Uncertainty Altitude", "s4607.dwell.unc.alt",\r\nFT_UINT16, BASE_CUSTOM,\r\nCF_FUNC(prt_centimeters), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_track,\r\n{ "Sensor Track", "s4607.dwell.track",\r\nFT_UINT16, BASE_CUSTOM,\r\nCF_FUNC(prt_ba16), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_speed,\r\n{ "Sensor Speed", "s4607.dwell.speed",\r\nFT_UINT32, BASE_CUSTOM,\r\nCF_FUNC(prt_speed), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_vert_velocity,\r\n{ "Sensor Vertical Velocity", "s4607.dwell.vvel",\r\nFT_INT8, BASE_CUSTOM,\r\nCF_FUNC(prt_speed_deci), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_track_unc,\r\n{ "Sensor Track Uncertainty", "s4607.dwell.track.unc",\r\nFT_UINT8, BASE_DEC,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_speed_unc,\r\n{ "Sensor Speed Uncertainty", "s4607.dwell.speed.unc",\r\nFT_UINT16, BASE_CUSTOM,\r\nCF_FUNC(prt_speed), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_vv_unc,\r\n{ "Sensor Vertical Velocity Uncertainty", "s4607.dwell.vvel.unc",\r\nFT_UINT16, BASE_CUSTOM,\r\nCF_FUNC(prt_speed_centi), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_plat_heading,\r\n{ "Platform Orientation Heading", "s4607.dwell.plat.heading",\r\nFT_UINT16, BASE_CUSTOM,\r\nCF_FUNC(prt_ba16), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_plat_pitch,\r\n{ "Platform Orientation Pitch", "s4607.dwell.plat.pitch",\r\nFT_INT16, BASE_CUSTOM,\r\nCF_FUNC(prt_sa16), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_plat_roll,\r\n{ "Platform Orientation Roll (Bank Angle)", "s4607.dwell.plat.roll",\r\nFT_INT16, BASE_CUSTOM,\r\nCF_FUNC(prt_sa16), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_da_lat,\r\n{ "Dwell Area Center Latitude", "s4607.dwell.da.lat",\r\nFT_INT32, BASE_CUSTOM,\r\nCF_FUNC(prt_sa32), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_da_lon,\r\n{ "Dwell Area Center Longitude", "s4607.dwell.da.lon",\r\nFT_UINT32, BASE_CUSTOM,\r\nCF_FUNC(prt_ba32), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_da_range,\r\n{ "Dwell Area Range Half Extent", "s4607.dwell.da.range",\r\nFT_UINT16, BASE_CUSTOM,\r\nCF_FUNC(prt_kilo), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_da_angle,\r\n{ "Dwell Area Dwell Angle Half Extent", "s4607.dwell.da.angle",\r\nFT_UINT16, BASE_CUSTOM,\r\nCF_FUNC(prt_ba16), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_sensor_heading,\r\n{ "Sensor Orientation Heading", "s4607.dwell.sensor.heading",\r\nFT_UINT16, BASE_CUSTOM,\r\nCF_FUNC(prt_ba16), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_sensor_pitch,\r\n{ "Sensor Orientation Pitch", "s4607.dwell.sensor.pitch",\r\nFT_INT16, BASE_CUSTOM,\r\nCF_FUNC(prt_sa16), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_sensor_roll,\r\n{ "Sensor Orientation Roll (Bank Angle)", "s4607.dwell.sensor.roll",\r\nFT_INT16, BASE_CUSTOM,\r\nCF_FUNC(prt_sa16), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_mdv,\r\n{ "Minimum Detectable Velocity (MDV)", "s4607.dwell.mdv",\r\nFT_UINT8, BASE_CUSTOM,\r\nCF_FUNC(prt_speed_deci), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_report_index,\r\n{ "MTI Report Index", "s4607.dwell.rpt.idx",\r\nFT_UINT16, BASE_DEC,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_report_lat,\r\n{ "Target Location Hi-Res Latitude", "s4607.dwell.rpt.lat",\r\nFT_INT32, BASE_CUSTOM,\r\nCF_FUNC(prt_sa32), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_report_lon,\r\n{ "Target Location Hi-Res Longitude", "s4607.dwell.rpt.lon",\r\nFT_UINT32, BASE_CUSTOM,\r\nCF_FUNC(prt_ba32), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_report_delta_lat,\r\n{ "Target Location Delta Latitude", "s4607.dwell.rpt.delta.lat",\r\nFT_INT16, BASE_DEC,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_report_delta_lon,\r\n{ "Target Location Delta Longitude", "s4607.dwell.rpt.delta.lon",\r\nFT_INT16, BASE_DEC,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_report_height,\r\n{ "Target Location Geodetic Height", "s4607.dwell.rpt.height",\r\nFT_INT16, BASE_CUSTOM,\r\nCF_FUNC(prt_meters), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_report_radial,\r\n{ "Target Velocity Line of Sight Component", "s4607.dwell.rpt.radial",\r\nFT_INT16, BASE_CUSTOM,\r\nCF_FUNC(prt_speed_centi), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_report_wrap,\r\n{ "Target Wrap Velocity", "s4607.dwell.rpt.wrap",\r\nFT_UINT16, BASE_CUSTOM,\r\nCF_FUNC(prt_speed_centi), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_report_snr,\r\n{ "Target SNR", "s4607.dwell.rpt.snr",\r\nFT_INT8, BASE_DEC,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_report_class,\r\n{ "Target Classification", "s4607.dwell.rpt.class",\r\nFT_UINT8, BASE_DEC,\r\nVALS(stanag4607_target_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_report_prob,\r\n{ "Target Class Probability", "s4607.dwell.rpt.prob",\r\nFT_UINT8, BASE_DEC,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_report_unc_slant,\r\n{ "Target Measurement Uncertainty Slant Range", "s4607.dwell.rpt.unc.slant",\r\nFT_UINT16, BASE_CUSTOM,\r\nCF_FUNC(prt_centimeters), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_report_unc_cross,\r\n{ "Target Measurement Uncertainty Cross Range", "s4607.dwell.rpt.unc.cross",\r\nFT_UINT16, BASE_CUSTOM,\r\nCF_FUNC(prt_decimeters), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_report_unc_height,\r\n{ "Target Measurement Uncertainty Height", "s4607.dwell.rpt.unc.height",\r\nFT_UINT8, BASE_CUSTOM,\r\nCF_FUNC(prt_meters), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_report_unc_radial,\r\n{ "Target Measurement Uncertainty Radial Velocity", "s4607.dwell.rpt.unc.radial",\r\nFT_UINT16, BASE_CUSTOM,\r\nCF_FUNC(prt_speed_centi), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_report_tag_app,\r\n{ "Truth Tag Application", "s4607.dwell.rpt.tag.app",\r\nFT_UINT8, BASE_DEC,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_report_tag_entity,\r\n{ "Truth Tag Entity", "s4607.dwell.rpt.tag.entity",\r\nFT_UINT32, BASE_DEC,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_dwell_report_section,\r\n{ "Radar Cross Section", "s4607.dwell.rpt.section",\r\nFT_INT8, BASE_DEC,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_jobdef_job_id,\r\n{ "Job ID", "s4607.job.id",\r\nFT_UINT32, BASE_DEC,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_jobdef_sensor_type,\r\n{ "Sensor Type", "s4607.job.type",\r\nFT_UINT8, BASE_DEC,\r\nVALS(stanag4607_sensor_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_jobdef_sensor_model,\r\n{ "Sensor Model", "s4607.job.model",\r\nFT_STRING, BASE_NONE,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_jobdef_filter,\r\n{ "Target Filtering Flag", "s4607.job.filter",\r\nFT_UINT8, BASE_DEC,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_jobdef_priority,\r\n{ "Radar Priority", "s4607.job.priority",\r\nFT_UINT8, BASE_DEC,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_jobdef_ba_lat_a,\r\n{ "Bounding Area Point A Latitude", "s4607.job.ba.lat.a",\r\nFT_INT32, BASE_CUSTOM,\r\nCF_FUNC(prt_sa32), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_jobdef_ba_lon_a,\r\n{ "Bounding Area Point A Longitude", "s4607.job.ba.lon.a",\r\nFT_UINT32, BASE_CUSTOM,\r\nCF_FUNC(prt_ba32), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_jobdef_ba_lat_b,\r\n{ "Bounding Area Point B Latitude", "s4607.job.ba.lat.b",\r\nFT_INT32, BASE_CUSTOM,\r\nCF_FUNC(prt_sa32), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_jobdef_ba_lon_b,\r\n{ "Bounding Area Point B Longitude", "s4607.job.ba.lon.b",\r\nFT_UINT32, BASE_CUSTOM,\r\nCF_FUNC(prt_ba32), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_jobdef_ba_lat_c,\r\n{ "Bounding Area Point C Latitude", "s4607.job.ba.lat.c",\r\nFT_INT32, BASE_CUSTOM,\r\nCF_FUNC(prt_sa32), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_jobdef_ba_lon_c,\r\n{ "Bounding Area Point C Longitude", "s4607.job.ba.lon.c",\r\nFT_UINT32, BASE_CUSTOM,\r\nCF_FUNC(prt_ba32), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_jobdef_ba_lat_d,\r\n{ "Bounding Area Point D Latitude", "s4607.job.ba.lat.d",\r\nFT_INT32, BASE_CUSTOM,\r\nCF_FUNC(prt_sa32), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_jobdef_ba_lon_d,\r\n{ "Bounding Area Point D Longitude", "s4607.job.ba.lon.d",\r\nFT_UINT32, BASE_CUSTOM,\r\nCF_FUNC(prt_ba32), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_jobdef_radar_mode,\r\n{ "Radar Mode", "s4607.job.mode",\r\nFT_UINT8, BASE_DEC,\r\nVALS(stanag4607_radar_mode_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_jobdef_revisit_interval,\r\n{ "Nominal Revisit Interval", "s4607.job.revisit",\r\nFT_UINT16, BASE_DEC,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_jobdef_unc_along,\r\n{ "Nominal Sensor Position Uncertainty Along Track", "s4607.job.unc.track",\r\nFT_UINT16, BASE_CUSTOM,\r\nCF_FUNC(prt_none16), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_jobdef_unc_cross,\r\n{ "Nominal Sensor Position Uncertainty Cross Track", "s4607.job.unc.cross",\r\nFT_UINT16, BASE_CUSTOM,\r\nCF_FUNC(prt_none16), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_jobdef_unc_alt,\r\n{ "Nominal Sensor Position Uncertainty Altitude", "s4607.job.unc.alt",\r\nFT_UINT16, BASE_CUSTOM,\r\nCF_FUNC(prt_none16), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_jobdef_unc_heading,\r\n{ "Nominal Sensor Position Uncertainty Track Heading", "s4607.job.unc.heading",\r\nFT_UINT8, BASE_CUSTOM,\r\nCF_FUNC(prt_none8), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_jobdef_unc_speed,\r\n{ "Nominal Sensor Position Uncertainty Speed", "s4607.job.unc.speed",\r\nFT_UINT16, BASE_CUSTOM,\r\nCF_FUNC(prt_none16), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_jobdef_sense_slant,\r\n{ "Nominal Sensor Slant Range Standard Deviation", "s4607.job.sense.slant",\r\nFT_UINT16, BASE_CUSTOM,\r\nCF_FUNC(prt_none16), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_jobdef_sense_cross,\r\n{ "Nominal Sensor Cross Range Standard Deviation", "s4607.job.sense.cross",\r\nFT_UINT16, BASE_CUSTOM,\r\nCF_FUNC(prt_ba16_none), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_jobdef_sense_vlos,\r\n{ "Nominal Sensor Velocity Line-Of-Sight Std. Dev", "s4607.job.sense.vlos",\r\nFT_UINT16, BASE_CUSTOM,\r\nCF_FUNC(prt_none16), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_jobdef_sense_mdv,\r\n{ "Nominal Sensor Minimum Detectable Velocity (MDV)", "s4607.job.sense.mdv",\r\nFT_UINT8, BASE_CUSTOM,\r\nCF_FUNC(prt_none8), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_jobdef_sense_prob,\r\n{ "Nominal Sensor Detection Probability", "s4607.job.sense.prob",\r\nFT_UINT8, BASE_CUSTOM,\r\nCF_FUNC(prt_none8), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_jobdef_sense_alarm,\r\n{ "Nominal Sensor False Alarm Density", "s4607.job.sense.alarm",\r\nFT_UINT8, BASE_CUSTOM,\r\nCF_FUNC(prt_none8), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_jobdef_terrain_model,\r\n{ "Terrain Elevation Model Used", "s4607.job.terrain",\r\nFT_UINT8, BASE_DEC,\r\nVALS(stanag4607_terrain_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_jobdef_geoid_model,\r\n{ "Geoid Model Used", "s4607.job.geoid",\r\nFT_UINT8, BASE_DEC,\r\nVALS(stanag4607_geoid_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_mission_plan,\r\n{ "Mission Plan", "s4607.mission.plan",\r\nFT_STRING, BASE_NONE,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_mission_flight_plan,\r\n{ "Mission Flight Plan", "s4607.mission.flight",\r\nFT_STRING, BASE_NONE,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_mission_platform,\r\n{ "Mission Platform Type", "s4607.mission.platform",\r\nFT_UINT8, BASE_DEC,\r\nVALS(stanag4607_platform_vals), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_mission_platform_config,\r\n{ "Mission Platform Configuration", "s4607.mission.config",\r\nFT_STRING, BASE_NONE,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_mission_time_year,\r\n{ "Mission Reference Time Year", "s4607.mission.year",\r\nFT_UINT16, BASE_DEC,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_mission_time_month,\r\n{ "Mission Reference Time Month", "s4607.mission.month",\r\nFT_UINT8, BASE_DEC,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_mission_time_day,\r\n{ "Mission Reference Time Day", "s4607.mission.day",\r\nFT_UINT8, BASE_DEC,\r\nNULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_platloc_time,\r\n{ "Platform Location Time", "s4607.ploc.time",\r\nFT_UINT32, BASE_CUSTOM,\r\nCF_FUNC(prt_millisec), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_platloc_latitude,\r\n{ "Platform Position Latitude", "s4607.ploc.lat",\r\nFT_INT32, BASE_CUSTOM,\r\nCF_FUNC(prt_sa32), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_platloc_longitude,\r\n{ "Platform Position Longitude", "s4607.ploc.lon",\r\nFT_UINT32, BASE_CUSTOM,\r\nCF_FUNC(prt_ba32), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_platloc_altitude,\r\n{ "Platform Position Altitude", "s4607.ploc.alt",\r\nFT_INT32, BASE_CUSTOM,\r\nCF_FUNC(prt_centimeters), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_platloc_track,\r\n{ "Platform Track", "s4607.ploc.track",\r\nFT_UINT16, BASE_CUSTOM,\r\nCF_FUNC(prt_ba16), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_platloc_speed,\r\n{ "Platform Speed", "s4607.ploc.speed",\r\nFT_UINT32, BASE_CUSTOM,\r\nCF_FUNC(prt_speed), 0x0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_4607_platloc_vertical_velocity,\r\n{ "Platform Vertical Velocity", "s4607.ploc.velocity",\r\nFT_INT8, BASE_CUSTOM,\r\nCF_FUNC(prt_speed_deci), 0x0,\r\nNULL, HFILL }\r\n},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_4607_hdr,\r\n&ett_4607_seg,\r\n&ett_4607_rpt,\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_too_short,\r\n{ "s4607.segment_too_short", PI_MALFORMED, PI_ERROR,\r\n"Segment size too small", EXPFILL }},\r\n{ &ei_bad_length,\r\n{ "s4607.segment_bad_length", PI_MALFORMED, PI_ERROR,\r\n"Bad segment size", EXPFILL }},\r\n{ &ei_bad_packet_size,\r\n{ "s4607.bad_packet_size", PI_MALFORMED, PI_ERROR,\r\n"Bad packet size field", EXPFILL }}\r\n};\r\nexpert_module_t* expert_4607;\r\nproto_stanag4607 = proto_register_protocol (\r\n"STANAG 4607 (GMTI Format)",\r\n"STANAG 4607",\r\n"s4607"\r\n);\r\nproto_register_field_array(proto_stanag4607, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\nexpert_4607 = expert_register_protocol(proto_stanag4607);\r\nexpert_register_field_array(expert_4607, ei, array_length(ei));\r\nstanag4607_handle = register_dissector("STANAG 4607", dissect_stanag4607, proto_stanag4607);\r\n}\r\nvoid\r\nproto_reg_handoff_stanag4607(void)\r\n{\r\ndissector_add_uint("wtap_encap", WTAP_ENCAP_STANAG_4607, stanag4607_handle);\r\n}
