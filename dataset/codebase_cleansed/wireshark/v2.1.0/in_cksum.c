guint16\r\nip_checksum(const guint8 *ptr, int len)\r\n{\r\nvec_t cksum_vec[1];\r\nSET_CKSUM_VEC_PTR(cksum_vec[0], ptr, len);\r\nreturn in_cksum(&cksum_vec[0], 1);\r\n}\r\nguint16\r\nip_checksum_tvb(tvbuff_t *tvb, int offset, int len)\r\n{\r\nvec_t cksum_vec[1];\r\nSET_CKSUM_VEC_TVB(cksum_vec[0], tvb, offset, len);\r\nreturn in_cksum(&cksum_vec[0], 1);\r\n}\r\nguint16\r\nin_cksum_shouldbe(guint16 sum, guint16 computed_sum)\r\n{\r\nguint32 shouldbe;\r\nshouldbe = sum;\r\nshouldbe += g_ntohs(computed_sum);\r\nshouldbe = (shouldbe & 0xFFFF) + (shouldbe >> 16);\r\nshouldbe = (shouldbe & 0xFFFF) + (shouldbe >> 16);\r\nreturn shouldbe;\r\n}
