static int\r\nrs_acct_dissect_lookup_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 key_size;\r\nconst char *keyx_t = NULL;\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep,\r\nhf_rs_acct_lookup_rqst_var, NULL);\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep,\r\nhf_rs_acct_lookup_rqst_key_size, &key_size);\r\nif (key_size){\r\nproto_tree_add_item (tree, hf_rs_acct_lookup_rqst_key_t, tvb, offset, key_size, ENC_ASCII|ENC_NA);\r\nkeyx_t = tvb_get_string_enc(wmem_packet_scope(), tvb, offset, key_size, ENC_ASCII);\r\noffset += key_size;\r\ncol_append_fstr(pinfo->cinfo, COL_INFO,\r\n" Request for: %s ", keyx_t);\r\n} else {\r\ncol_append_str(pinfo->cinfo, COL_INFO,\r\n" Request (other)");\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\nrs_acct_dissect_get_projlist_rqst (tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 key_size;\r\nconst char *keyx_t = NULL;\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep,\r\nhf_rs_acct_get_projlist_rqst_var1, NULL);\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep,\r\nhf_rs_acct_get_projlist_rqst_key_size, &key_size);\r\nproto_tree_add_item (tree, hf_rs_acct_get_projlist_rqst_key_t,\r\ntvb, offset, key_size, ENC_ASCII|ENC_NA);\r\nkeyx_t = tvb_get_string_enc(wmem_packet_scope(), tvb, offset, key_size, ENC_ASCII);\r\noffset += key_size;\r\ncol_append_fstr(pinfo->cinfo, COL_INFO,\r\n" Request for: %s", keyx_t);\r\nreturn offset;\r\n}\r\nvoid\r\nproto_register_rs_acct (void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_rs_acct_opnum,\r\n{ "Operation", "rs_acct.opnum", FT_UINT16, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_rs_acct_lookup_rqst_var,\r\n{ "Var", "rs_acct.lookup_rqst_var", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_rs_acct_lookup_rqst_key_size,\r\n{ "Key Size", "rs_acct.lookup_rqst_key_size", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_rs_acct_lookup_rqst_key_t,\r\n{ "Key", "rs_acct.lookup_rqst_key_t", FT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_rs_acct_get_projlist_rqst_var1,\r\n{ "Var1", "rs_acct.get_projlist_rqst_var1", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_rs_acct_get_projlist_rqst_key_size,\r\n{ "Var1", "rs_acct.get_projlist_rqst_key_size", FT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL }},\r\n{ &hf_rs_acct_get_projlist_rqst_key_t,\r\n{ "Var1", "rs_acct.get_projlist_rqst_key_t", FT_STRING, BASE_NONE, NULL, 0x0, NULL, HFILL }}\r\n};\r\nstatic gint *ett[] = {\r\n&ett_rs_acct,\r\n};\r\nproto_rs_acct = proto_register_protocol ("DCE/RPC RS_ACCT", "RS_ACCT", "rs_acct");\r\nproto_register_field_array (proto_rs_acct, hf, array_length (hf));\r\nproto_register_subtree_array (ett, array_length (ett));\r\n}\r\nvoid\r\nproto_reg_handoff_rs_acct (void)\r\n{\r\ndcerpc_init_uuid (proto_rs_acct, ett_rs_acct, &uuid_rs_acct, ver_rs_acct, rs_acct_dissectors, hf_rs_acct_opnum);\r\n}
