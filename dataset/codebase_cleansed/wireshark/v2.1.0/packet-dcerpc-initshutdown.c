int\r\ninitshutdown_dissect_enum_ReasonMajor(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_, int hf_index _U_, guint32 *param _U_)\r\n{\r\nguint32 parameter=0;\r\nif (param) {\r\nparameter = *param;\r\n}\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep, hf_index, &parameter);\r\nif (param) {\r\n*param = parameter;\r\n}\r\nreturn offset;\r\n}\r\nint\r\ninitshutdown_dissect_enum_ReasonMinor(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_, int hf_index _U_, guint32 *param _U_)\r\n{\r\nguint32 parameter=0;\r\nif (param) {\r\nparameter = *param;\r\n}\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep, hf_index, &parameter);\r\nif (param) {\r\n*param = parameter;\r\n}\r\nreturn offset;\r\n}\r\nint\r\ninitshutdown_dissect_bitmap_ReasonFlags(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *parent_tree _U_, dcerpc_info* di _U_, guint8 *drep _U_, int hf_index _U_, guint32 param _U_)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nguint32 flags;\r\nALIGN_TO_4_BYTES;\r\nif (parent_tree) {\r\nitem = proto_tree_add_item(parent_tree, hf_index, tvb, offset, 4, DREP_ENC_INTEGER(drep));\r\ntree = proto_item_add_subtree(item,ett_initshutdown_initshutdown_ReasonFlags);\r\n}\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep, -1, &flags);\r\nproto_item_append_text(item, ": ");\r\nif (!flags)\r\nproto_item_append_text(item, "(No values set)");\r\nproto_tree_add_boolean(tree, hf_initshutdown_initshutdown_ReasonFlags_SHTDN_REASON_FLAG_USER_DEFINED, tvb, offset-4, 4, flags);\r\nif (flags&( 0x40000000 )){\r\nproto_item_append_text(item, "SHTDN_REASON_FLAG_USER_DEFINED");\r\nif (flags & (~( 0x40000000 )))\r\nproto_item_append_text(item, ", ");\r\n}\r\nflags&=(~( 0x40000000 ));\r\nproto_tree_add_boolean(tree, hf_initshutdown_initshutdown_ReasonFlags_SHTDN_REASON_FLAG_PLANNED, tvb, offset-4, 4, flags);\r\nif (flags&( 0x80000000 )){\r\nproto_item_append_text(item, "SHTDN_REASON_FLAG_PLANNED");\r\nif (flags & (~( 0x80000000 )))\r\nproto_item_append_text(item, ", ");\r\n}\r\nflags&=(~( 0x80000000 ));\r\nif (flags) {\r\nproto_item_append_text(item, "Unknown bitmap value 0x%x", flags);\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ninitshutdown_dissect_element_Init_hostname(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_toplevel_pointer(tvb, offset, pinfo, tree, di, drep, initshutdown_dissect_element_Init_hostname_, NDR_POINTER_UNIQUE, "Pointer to Hostname (uint16)",hf_initshutdown_initshutdown_Init_hostname);\r\nreturn offset;\r\n}\r\nstatic int\r\ninitshutdown_dissect_element_Init_hostname_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint16(tvb, offset, pinfo, tree, di, drep, hf_initshutdown_initshutdown_Init_hostname, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\ninitshutdown_dissect_element_Init_message(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_toplevel_pointer(tvb, offset, pinfo, tree, di, drep, initshutdown_dissect_element_Init_message_, NDR_POINTER_UNIQUE, "Pointer to Message (lsa_StringLarge)",hf_initshutdown_initshutdown_Init_message);\r\nreturn offset;\r\n}\r\nstatic int\r\ninitshutdown_dissect_element_Init_message_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset=lsarpc_dissect_struct_lsa_StringLarge(tvb, offset, pinfo, tree, di, drep, hf_initshutdown_initshutdown_Init_message, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\ninitshutdown_dissect_element_Init_timeout(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_initshutdown_initshutdown_Init_timeout, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\ninitshutdown_dissect_element_Init_force_apps(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint8(tvb, offset, pinfo, tree, di, drep, hf_initshutdown_initshutdown_Init_force_apps, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\ninitshutdown_dissect_element_Init_do_reboot(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint8(tvb, offset, pinfo, tree, di, drep, hf_initshutdown_initshutdown_Init_do_reboot, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\ninitshutdown_dissect_Init_response(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nguint32 status;\r\ndi->dcerpc_procedure_name="Init";\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep, hf_initshutdown_werror, &status);\r\nif (status != 0)\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ", Error: %s", val_to_str(status, WERR_errors, "Unknown DOS error 0x%08x"));\r\nreturn offset;\r\n}\r\nstatic int\r\ninitshutdown_dissect_Init_request(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\ndi->dcerpc_procedure_name="Init";\r\noffset = initshutdown_dissect_element_Init_hostname(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = initshutdown_dissect_element_Init_message(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = initshutdown_dissect_element_Init_timeout(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = initshutdown_dissect_element_Init_force_apps(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = initshutdown_dissect_element_Init_do_reboot(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\ninitshutdown_dissect_element_Abort_server(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_toplevel_pointer(tvb, offset, pinfo, tree, di, drep, initshutdown_dissect_element_Abort_server_, NDR_POINTER_UNIQUE, "Pointer to Server (uint16)",hf_initshutdown_initshutdown_Abort_server);\r\nreturn offset;\r\n}\r\nstatic int\r\ninitshutdown_dissect_element_Abort_server_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint16(tvb, offset, pinfo, tree, di, drep, hf_initshutdown_initshutdown_Abort_server, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\ninitshutdown_dissect_Abort_response(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nguint32 status;\r\ndi->dcerpc_procedure_name="Abort";\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep, hf_initshutdown_werror, &status);\r\nif (status != 0)\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ", Error: %s", val_to_str(status, WERR_errors, "Unknown DOS error 0x%08x"));\r\nreturn offset;\r\n}\r\nstatic int\r\ninitshutdown_dissect_Abort_request(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\ndi->dcerpc_procedure_name="Abort";\r\noffset = initshutdown_dissect_element_Abort_server(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\ninitshutdown_dissect_element_InitEx_hostname(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_toplevel_pointer(tvb, offset, pinfo, tree, di, drep, initshutdown_dissect_element_InitEx_hostname_, NDR_POINTER_UNIQUE, "Pointer to Hostname (uint16)",hf_initshutdown_initshutdown_InitEx_hostname);\r\nreturn offset;\r\n}\r\nstatic int\r\ninitshutdown_dissect_element_InitEx_hostname_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint16(tvb, offset, pinfo, tree, di, drep, hf_initshutdown_initshutdown_InitEx_hostname, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\ninitshutdown_dissect_element_InitEx_message(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = dissect_ndr_toplevel_pointer(tvb, offset, pinfo, tree, di, drep, initshutdown_dissect_element_InitEx_message_, NDR_POINTER_UNIQUE, "Pointer to Message (lsa_StringLarge)",hf_initshutdown_initshutdown_InitEx_message);\r\nreturn offset;\r\n}\r\nstatic int\r\ninitshutdown_dissect_element_InitEx_message_(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset=lsarpc_dissect_struct_lsa_StringLarge(tvb, offset, pinfo, tree, di, drep, hf_initshutdown_initshutdown_InitEx_message, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\ninitshutdown_dissect_element_InitEx_timeout(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_initshutdown_initshutdown_InitEx_timeout, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\ninitshutdown_dissect_element_InitEx_force_apps(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint8(tvb, offset, pinfo, tree, di, drep, hf_initshutdown_initshutdown_InitEx_force_apps, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\ninitshutdown_dissect_element_InitEx_do_reboot(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint8(tvb, offset, pinfo, tree, di, drep, hf_initshutdown_initshutdown_InitEx_do_reboot, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\ninitshutdown_dissect_element_InitEx_reason(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\noffset = PIDL_dissect_uint32(tvb, offset, pinfo, tree, di, drep, hf_initshutdown_initshutdown_InitEx_reason, 0);\r\nreturn offset;\r\n}\r\nstatic int\r\ninitshutdown_dissect_InitEx_response(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\nguint32 status;\r\ndi->dcerpc_procedure_name="InitEx";\r\noffset = dissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep, hf_initshutdown_werror, &status);\r\nif (status != 0)\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ", Error: %s", val_to_str(status, WERR_errors, "Unknown DOS error 0x%08x"));\r\nreturn offset;\r\n}\r\nstatic int\r\ninitshutdown_dissect_InitEx_request(tvbuff_t *tvb _U_, int offset _U_, packet_info *pinfo _U_, proto_tree *tree _U_, dcerpc_info* di _U_, guint8 *drep _U_)\r\n{\r\ndi->dcerpc_procedure_name="InitEx";\r\noffset = initshutdown_dissect_element_InitEx_hostname(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = initshutdown_dissect_element_InitEx_message(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = initshutdown_dissect_element_InitEx_timeout(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = initshutdown_dissect_element_InitEx_force_apps(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = initshutdown_dissect_element_InitEx_do_reboot(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\noffset = initshutdown_dissect_element_InitEx_reason(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_deferred_pointers(pinfo, tvb, offset, di, drep);\r\nreturn offset;\r\n}\r\nvoid proto_register_dcerpc_initshutdown(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_initshutdown_initshutdown_Abort_server,\r\n{ "Server", "initshutdown.initshutdown_Abort.server", FT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_initshutdown_initshutdown_InitEx_do_reboot,\r\n{ "Do Reboot", "initshutdown.initshutdown_InitEx.do_reboot", FT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_initshutdown_initshutdown_InitEx_force_apps,\r\n{ "Force Apps", "initshutdown.initshutdown_InitEx.force_apps", FT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_initshutdown_initshutdown_InitEx_hostname,\r\n{ "Hostname", "initshutdown.initshutdown_InitEx.hostname", FT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_initshutdown_initshutdown_InitEx_message,\r\n{ "Message", "initshutdown.initshutdown_InitEx.message", FT_NONE, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_initshutdown_initshutdown_InitEx_reason,\r\n{ "Reason", "initshutdown.initshutdown_InitEx.reason", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_initshutdown_initshutdown_InitEx_timeout,\r\n{ "Timeout", "initshutdown.initshutdown_InitEx.timeout", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_initshutdown_initshutdown_Init_do_reboot,\r\n{ "Do Reboot", "initshutdown.initshutdown_Init.do_reboot", FT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_initshutdown_initshutdown_Init_force_apps,\r\n{ "Force Apps", "initshutdown.initshutdown_Init.force_apps", FT_UINT8, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_initshutdown_initshutdown_Init_hostname,\r\n{ "Hostname", "initshutdown.initshutdown_Init.hostname", FT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_initshutdown_initshutdown_Init_message,\r\n{ "Message", "initshutdown.initshutdown_Init.message", FT_NONE, BASE_NONE, NULL, 0, NULL, HFILL }},\r\n{ &hf_initshutdown_initshutdown_Init_timeout,\r\n{ "Timeout", "initshutdown.initshutdown_Init.timeout", FT_UINT32, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_initshutdown_initshutdown_ReasonFlags_SHTDN_REASON_FLAG_PLANNED,\r\n{ "Shtdn Reason Flag Planned", "initshutdown.initshutdown_ReasonFlags.SHTDN_REASON_FLAG_PLANNED", FT_BOOLEAN, 32, TFS(&initshutdown_ReasonFlags_SHTDN_REASON_FLAG_PLANNED_tfs), ( 0x80000000 ), NULL, HFILL }},\r\n{ &hf_initshutdown_initshutdown_ReasonFlags_SHTDN_REASON_FLAG_USER_DEFINED,\r\n{ "Shtdn Reason Flag User Defined", "initshutdown.initshutdown_ReasonFlags.SHTDN_REASON_FLAG_USER_DEFINED", FT_BOOLEAN, 32, TFS(&initshutdown_ReasonFlags_SHTDN_REASON_FLAG_USER_DEFINED_tfs), ( 0x40000000 ), NULL, HFILL }},\r\n{ &hf_initshutdown_opnum,\r\n{ "Operation", "initshutdown.opnum", FT_UINT16, BASE_DEC, NULL, 0, NULL, HFILL }},\r\n{ &hf_initshutdown_werror,\r\n{ "Windows Error", "initshutdown.werror", FT_UINT32, BASE_HEX, VALS(WERR_errors), 0, NULL, HFILL }},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_dcerpc_initshutdown,\r\n&ett_initshutdown_initshutdown_ReasonFlags,\r\n};\r\nproto_dcerpc_initshutdown = proto_register_protocol("Init shutdown service", "INITSHUTDOWN", "initshutdown");\r\nproto_register_field_array(proto_dcerpc_initshutdown, hf, array_length (hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid proto_reg_handoff_dcerpc_initshutdown(void)\r\n{\r\ndcerpc_init_uuid(proto_dcerpc_initshutdown, ett_dcerpc_initshutdown,\r\n&uuid_dcerpc_initshutdown, ver_dcerpc_initshutdown,\r\ninitshutdown_dissectors, hf_initshutdown_opnum);\r\n}
