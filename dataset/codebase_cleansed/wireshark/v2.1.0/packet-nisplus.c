static int\r\ndissect_nisplus_time(tvbuff_t *tvb, int offset, proto_tree *tree, int hfindex)\r\n{\r\nnstime_t ts;\r\nts.nsecs = 0;\r\nts.secs = tvb_get_ntohl(tvb, offset);\r\noffset += 4;\r\nproto_tree_add_time(tree, hfindex, tvb, offset, 4, &ts);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_group(tvbuff_t *tvb, int offset, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\noffset = dissect_rpc_string(tvb, tree,\r\nhf_nisplus_group_name, offset, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_group_obj(tvbuff_t *tvb, int offset, packet_info *pinfo, proto_tree *tree)\r\n{\r\nproto_item* lock_item = NULL;\r\nproto_tree* lock_tree = NULL;\r\nint old_offset = offset;\r\nlock_item = proto_tree_add_item(tree, hf_nisplus_group,\r\ntvb, offset, -1, ENC_NA);\r\nlock_tree = proto_item_add_subtree(lock_item, ett_nisplus_group);\r\noffset = dissect_rpc_uint32(tvb, lock_tree,\r\nhf_nisplus_group_flags, offset);\r\noffset = dissect_rpc_array(tvb, pinfo, lock_tree, offset,\r\ndissect_group, hf_nisplus_grps);\r\nproto_item_set_len(lock_item, offset-old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_access_rights(tvbuff_t *tvb, int offset, proto_tree *tree)\r\n{\r\nstatic const int * flags[] = {\r\n&hf_nisplus_mask_world_read,\r\n&hf_nisplus_mask_world_modify,\r\n&hf_nisplus_mask_world_create,\r\n&hf_nisplus_mask_world_destroy,\r\n&hf_nisplus_mask_group_read,\r\n&hf_nisplus_mask_group_modify,\r\n&hf_nisplus_mask_group_create,\r\n&hf_nisplus_mask_group_destroy,\r\n&hf_nisplus_mask_owner_read,\r\n&hf_nisplus_mask_owner_modify,\r\n&hf_nisplus_mask_owner_create,\r\n&hf_nisplus_mask_owner_destroy,\r\n&hf_nisplus_mask_nobody_read,\r\n&hf_nisplus_mask_nobody_modify,\r\n&hf_nisplus_mask_nobody_create,\r\n&hf_nisplus_mask_nobody_destroy,\r\nNULL\r\n};\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_nisplus_access_mask, ett_nisplus_access_mask, flags, ENC_BIG_ENDIAN);\r\noffset += 4;\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_table(tvbuff_t *tvb, int offset, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nproto_item* lock_item;\r\nproto_tree* lock_tree;\r\nint old_offset = offset;\r\nstatic const int * flags[] = {\r\n&hf_nisplus_table_col_mask_binary,\r\n&hf_nisplus_table_col_mask_encrypted,\r\n&hf_nisplus_table_col_mask_xdr,\r\n&hf_nisplus_table_col_mask_searchable,\r\n&hf_nisplus_table_col_mask_casesensitive,\r\n&hf_nisplus_table_col_mask_modified,\r\n&hf_nisplus_table_col_mask_asn,\r\nNULL\r\n};\r\nlock_item = proto_tree_add_item(tree, hf_nisplus_table_col,\r\ntvb, offset, -1, ENC_NA);\r\nlock_tree = proto_item_add_subtree(lock_item, ett_nisplus_table_col);\r\noffset = dissect_rpc_string(tvb, lock_tree,\r\nhf_nisplus_table_col_name, offset, NULL);\r\nproto_tree_add_bitmask(lock_tree, tvb, offset, hf_nisplus_table_col_mask, ett_nisplus_table_col_mask, flags, ENC_BIG_ENDIAN);\r\noffset += 4;\r\noffset = dissect_access_rights(tvb, offset, lock_tree);\r\nproto_item_set_len(lock_item, offset-old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_table_obj(tvbuff_t *tvb, int offset, packet_info *pinfo, proto_tree *tree)\r\n{\r\nproto_item* lock_item = NULL;\r\nproto_tree* lock_tree = NULL;\r\nint old_offset = offset;\r\nlock_item = proto_tree_add_item(tree, hf_nisplus_table,\r\ntvb, offset, -1, ENC_NA);\r\nlock_tree = proto_item_add_subtree(lock_item, ett_nisplus_table);\r\noffset = dissect_rpc_string(tvb, lock_tree,\r\nhf_nisplus_table_type, offset, NULL);\r\noffset = dissect_rpc_uint32(tvb, lock_tree,\r\nhf_nisplus_table_maxcol, offset);\r\noffset = dissect_rpc_uint32(tvb, lock_tree,\r\nhf_nisplus_table_sep, offset);\r\noffset = dissect_rpc_array(tvb, pinfo, lock_tree, offset,\r\ndissect_table, hf_nisplus_table_cols);\r\noffset = dissect_rpc_string(tvb, lock_tree,\r\nhf_nisplus_table_path, offset, NULL);\r\nproto_item_set_len(lock_item, offset-old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_entry(tvbuff_t *tvb, int offset, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nproto_item* lock_item;\r\nproto_tree* lock_tree;\r\nint old_offset = offset;\r\nstatic const int * flags[] = {\r\n&hf_nisplus_entry_mask_binary,\r\n&hf_nisplus_entry_mask_crypt,\r\n&hf_nisplus_entry_mask_xdr,\r\n&hf_nisplus_entry_mask_modified,\r\n&hf_nisplus_entry_mask_asn,\r\nNULL\r\n};\r\nlock_item = proto_tree_add_item(tree, hf_nisplus_entry_col,\r\ntvb, offset, -1, ENC_NA);\r\nlock_tree = proto_item_add_subtree(lock_item, ett_nisplus_entry_col);\r\nproto_tree_add_bitmask(lock_tree, tvb, offset, hf_nisplus_entry_mask, ett_nisplus_entry_mask, flags, ENC_BIG_ENDIAN);\r\noffset += 4;\r\noffset = dissect_rpc_string(tvb, lock_tree,\r\nhf_nisplus_entry_val, offset, NULL);\r\nproto_item_set_len(lock_item, offset-old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_entry_obj(tvbuff_t *tvb, int offset, packet_info *pinfo, proto_tree *tree)\r\n{\r\nproto_item* lock_item = NULL;\r\nproto_tree* lock_tree = NULL;\r\nint old_offset = offset;\r\nlock_item = proto_tree_add_item(tree, hf_nisplus_entry,\r\ntvb, offset, -1, ENC_NA);\r\nlock_tree = proto_item_add_subtree(lock_item, ett_nisplus_entry);\r\noffset = dissect_rpc_string(tvb, lock_tree,\r\nhf_nisplus_entry_type, offset, NULL);\r\noffset = dissect_rpc_array(tvb, pinfo, lock_tree, offset,\r\ndissect_entry, hf_nisplus_entry_cols);\r\nproto_item_set_len(lock_item, offset-old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_attr(tvbuff_t *tvb, int offset, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nproto_item* lock_item = NULL;\r\nproto_tree* lock_tree = NULL;\r\nint old_offset = offset;\r\nlock_item = proto_tree_add_item(tree, hf_nisplus_attr,\r\ntvb, offset, -1, ENC_NA);\r\nlock_tree = proto_item_add_subtree(lock_item, ett_nisplus_attr);\r\noffset = dissect_rpc_string(tvb, lock_tree,\r\nhf_nisplus_attr_name, offset, NULL);\r\noffset = dissect_rpc_data(tvb, lock_tree,\r\nhf_nisplus_attr_val, offset);\r\nproto_item_set_len(lock_item, offset-old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_link_obj(tvbuff_t *tvb, int offset, packet_info *pinfo, proto_tree *tree)\r\n{\r\nproto_item* lock_item = NULL;\r\nproto_tree* lock_tree = NULL;\r\nint old_offset = offset;\r\nlock_item = proto_tree_add_item(tree, hf_nisplus_link,\r\ntvb, offset, -1, ENC_NA);\r\nlock_tree = proto_item_add_subtree(lock_item, ett_nisplus_link);\r\noffset = dissect_rpc_uint32(tvb, lock_tree,\r\nhf_nisplus_object_type, offset);\r\noffset = dissect_rpc_array(tvb, pinfo, lock_tree, offset,\r\ndissect_attr, hf_nisplus_attrs_array);\r\noffset = dissect_rpc_string(tvb, lock_tree,\r\nhf_nisplus_object_name, offset, NULL);\r\nproto_item_set_len(lock_item, offset-old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_endpoint(tvbuff_t *tvb, int offset, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nproto_item* lock_item = NULL;\r\nproto_tree* lock_tree = NULL;\r\nint old_offset = offset;\r\nlock_item = proto_tree_add_item(tree, hf_nisplus_endpoint,\r\ntvb, offset, -1, ENC_NA);\r\nlock_tree = proto_item_add_subtree(lock_item, ett_nisplus_endpoint);\r\noffset = dissect_rpc_string(tvb, lock_tree,\r\nhf_nisplus_endpoint_uaddr, offset, NULL);\r\noffset = dissect_rpc_string(tvb, lock_tree,\r\nhf_nisplus_endpoint_family, offset, NULL);\r\noffset = dissect_rpc_string(tvb, lock_tree,\r\nhf_nisplus_endpoint_proto, offset, NULL);\r\nproto_item_set_len(lock_item, offset-old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_directory_server(tvbuff_t *tvb, int offset, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nproto_item* lock_item = NULL;\r\nproto_tree* lock_tree = NULL;\r\nint old_offset = offset;\r\nlock_item = proto_tree_add_item(tree, hf_nisplus_server,\r\ntvb, offset, -1, ENC_NA);\r\nlock_tree = proto_item_add_subtree(lock_item, ett_nisplus_server);\r\noffset = dissect_rpc_string(tvb, lock_tree,\r\nhf_nisplus_server_name, offset, NULL);\r\noffset = dissect_rpc_array(tvb, pinfo, lock_tree, offset,\r\ndissect_endpoint, hf_nisplus_endpoints);\r\noffset = dissect_rpc_uint32(tvb, lock_tree,\r\nhf_nisplus_key_type, offset);\r\noffset = dissect_rpc_data(tvb, lock_tree,\r\nhf_nisplus_key_data, offset);\r\nproto_item_set_len(lock_item, offset-old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_directory_mask(tvbuff_t *tvb, int offset, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nproto_item* lock_item = NULL;\r\nproto_tree* lock_tree = NULL;\r\nint old_offset = offset;\r\nlock_item = proto_tree_add_item(tree, hf_nisplus_directory_mask,\r\ntvb, offset, -1, ENC_NA);\r\nlock_tree = proto_item_add_subtree(lock_item, ett_nisplus_directory_mask);\r\noffset = dissect_access_rights(tvb, offset, lock_tree);\r\noffset = dissect_rpc_uint32(tvb, lock_tree,\r\nhf_nisplus_object_type, offset);\r\nproto_item_set_len(lock_item, offset-old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_directory_obj(tvbuff_t *tvb, int offset, packet_info *pinfo, proto_tree *tree)\r\n{\r\nproto_item* lock_item = NULL;\r\nproto_tree* lock_tree = NULL;\r\nint old_offset = offset;\r\nlock_item = proto_tree_add_item(tree, hf_nisplus_directory,\r\ntvb, offset, -1, ENC_NA);\r\nlock_tree = proto_item_add_subtree(lock_item, ett_nisplus_directory);\r\noffset = dissect_rpc_string(tvb, lock_tree,\r\nhf_nisplus_directory_name, offset, NULL);\r\noffset = dissect_rpc_uint32(tvb, lock_tree,\r\nhf_nisplus_directory_type, offset);\r\noffset = dissect_rpc_array(tvb, pinfo, lock_tree, offset,\r\ndissect_directory_server, hf_nisplus_servers);\r\noffset = dissect_rpc_uint32(tvb, lock_tree,\r\nhf_nisplus_directory_ttl, offset);\r\noffset = dissect_rpc_array(tvb, pinfo, lock_tree, offset,\r\ndissect_directory_mask, hf_nisplus_directory_mask_list);\r\nproto_item_set_len(lock_item, offset-old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_nisplus_oid(tvbuff_t *tvb, int offset, proto_tree *tree)\r\n{\r\nproto_item* lock_item = NULL;\r\nproto_tree* lock_tree = NULL;\r\nint old_offset = offset;\r\nlock_item = proto_tree_add_item(tree, hf_nisplus_oid, tvb,\r\noffset, -1, ENC_NA);\r\nlock_tree = proto_item_add_subtree(lock_item, ett_nisplus_oid);\r\noffset = dissect_nisplus_time(tvb, offset, lock_tree,\r\nhf_nisplus_object_ctime);\r\noffset = dissect_nisplus_time(tvb, offset, lock_tree,\r\nhf_nisplus_object_mtime);\r\nproto_item_set_len(lock_item, offset-old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_nisplus_object(tvbuff_t *tvb, int offset, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nproto_item* lock_item = NULL;\r\nproto_tree* lock_tree = NULL;\r\ngint32 type;\r\nint old_offset = offset;\r\nlock_item = proto_tree_add_item(tree, hf_nisplus_object, tvb,\r\noffset, -1, ENC_NA);\r\nlock_tree = proto_item_add_subtree(lock_item, ett_nisplus_object);\r\noffset = dissect_nisplus_oid(tvb, offset, lock_tree);\r\noffset = dissect_rpc_string(tvb, lock_tree,\r\nhf_nisplus_object_name, offset, NULL);\r\noffset = dissect_rpc_string(tvb, lock_tree,\r\nhf_nisplus_object_owner, offset, NULL);\r\noffset = dissect_rpc_string(tvb, lock_tree,\r\nhf_nisplus_object_group, offset, NULL);\r\noffset = dissect_rpc_string(tvb, lock_tree,\r\nhf_nisplus_object_domain, offset, NULL);\r\noffset = dissect_access_rights(tvb, offset, lock_tree);\r\noffset = dissect_rpc_uint32(tvb, lock_tree,\r\nhf_nisplus_object_ttl, offset);\r\ntype = tvb_get_ntohl(tvb, offset);\r\noffset = dissect_rpc_uint32(tvb, lock_tree,\r\nhf_nisplus_object_type, offset);\r\nswitch (type) {\r\ncase NIS_DIRECTORY_OBJ:\r\noffset = dissect_directory_obj(tvb, offset, pinfo, lock_tree);\r\nbreak;\r\ncase NIS_GROUP_OBJ:\r\noffset = dissect_group_obj(tvb, offset, pinfo, lock_tree);\r\nbreak;\r\ncase NIS_TABLE_OBJ:\r\noffset = dissect_table_obj(tvb, offset, pinfo, lock_tree);\r\nbreak;\r\ncase NIS_ENTRY_OBJ:\r\noffset = dissect_entry_obj(tvb, offset, pinfo, lock_tree);\r\nbreak;\r\ncase NIS_LINK_OBJ:\r\noffset = dissect_link_obj(tvb, offset, pinfo, lock_tree);\r\nbreak;\r\ncase NIS_PRIVATE_OBJ:\r\noffset = dissect_rpc_data(tvb, lock_tree,\r\nhf_nisplus_object_private, offset);\r\nbreak;\r\ncase NIS_NO_OBJ:\r\nbreak;\r\ncase NIS_BOGUS_OBJ:\r\nbreak;\r\ndefault:\r\nbreak;\r\n};\r\nproto_item_set_len(lock_item, offset-old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_ns_request(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_string(tvb, tree,\r\nhf_nisplus_object_name, offset, NULL);\r\noffset = dissect_rpc_array(tvb, pinfo, tree, offset,\r\ndissect_nisplus_object, hf_nisplus_object);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_ib_request(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_string(tvb, tree,\r\nhf_nisplus_object_name, offset, NULL);\r\noffset = dissect_rpc_array(tvb, pinfo, tree, offset,\r\ndissect_attr, hf_nisplus_attrs_array);\r\noffset = dissect_rpc_uint32(tvb, tree,\r\nhf_nisplus_ib_flags, offset);\r\noffset = dissect_rpc_array(tvb, pinfo, tree, offset,\r\ndissect_nisplus_object, hf_nisplus_object);\r\noffset = dissect_rpc_array(tvb, pinfo, tree, offset,\r\ndissect_directory_server, hf_nisplus_cbservers);\r\noffset = dissect_rpc_uint32(tvb, tree,\r\nhf_nisplus_ib_bufsize, offset);\r\noffset = dissect_rpc_data(tvb, tree,\r\nhf_nisplus_cookie, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_fd_args(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_string(tvb, tree,\r\nhf_nisplus_fd_dirname, offset, NULL);\r\noffset = dissect_rpc_string(tvb, tree,\r\nhf_nisplus_fd_requester, offset, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_nisplus_tag(tvbuff_t *tvb, int offset, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nproto_item* lock_item = NULL;\r\nproto_tree* lock_tree = NULL;\r\nint old_offset = offset;\r\nlock_item = proto_tree_add_item(tree, hf_nisplus_tag, tvb,\r\noffset, -1, ENC_NA);\r\nlock_tree = proto_item_add_subtree(lock_item, ett_nisplus_tag);\r\noffset = dissect_rpc_uint32(tvb, lock_tree,\r\nhf_nisplus_tag_type, offset);\r\noffset = dissect_rpc_string(tvb, lock_tree,\r\nhf_nisplus_tag_val, offset, NULL);\r\nproto_item_set_len(lock_item, offset-old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_nisplus_taglist(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nreturn dissect_rpc_array(tvb, pinfo, tree, 0,\r\ndissect_nisplus_tag, hf_nisplus_taglist);\r\n}\r\nstatic int\r\ndissect_dump_args(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_string(tvb, tree,\r\nhf_nisplus_dump_dir, offset, NULL);\r\noffset = dissect_nisplus_time(tvb, offset, tree,\r\nhf_nisplus_dump_time);\r\noffset = dissect_rpc_array(tvb, pinfo, tree, offset,\r\ndissect_directory_server, hf_nisplus_cbservers);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_netobj(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nreturn dissect_rpc_data(tvb, tree, hf_nisplus_dummy, 0);\r\n}\r\nstatic int\r\ndissect_nisname(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nreturn dissect_rpc_string(tvb, tree,\r\nhf_nisplus_object_name, 0, NULL);\r\n}\r\nstatic int\r\ndissect_ping_args(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_string(tvb, tree,\r\nhf_nisplus_ping_dir, offset, NULL);\r\noffset = dissect_nisplus_time(tvb, offset, tree,\r\nhf_nisplus_ping_time);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_nisplus_result(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_uint32(tvb, tree,\r\nhf_nisplus_error, offset);\r\noffset = dissect_rpc_array(tvb, pinfo, tree, offset,\r\ndissect_nisplus_object, hf_nisplus_object);\r\noffset = dissect_rpc_data(tvb, tree,\r\nhf_nisplus_cookie, offset);\r\noffset = dissect_rpc_uint32(tvb, tree,\r\nhf_nisplus_zticks, offset);\r\noffset = dissect_rpc_uint32(tvb, tree,\r\nhf_nisplus_dticks, offset);\r\noffset = dissect_rpc_uint32(tvb, tree,\r\nhf_nisplus_aticks, offset);\r\noffset = dissect_rpc_uint32(tvb, tree,\r\nhf_nisplus_cticks, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_fd_result(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_uint32(tvb, tree,\r\nhf_nisplus_error, offset);\r\noffset = dissect_rpc_string(tvb, tree,\r\nhf_nisplus_fd_dirname, offset, NULL);\r\noffset = dissect_rpc_data(tvb, tree,\r\nhf_nisplus_dir_data, offset);\r\noffset = dissect_rpc_data(tvb, tree,\r\nhf_nisplus_signature, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_log_entry(tvbuff_t *tvb, int offset, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nproto_item* lock_item = NULL;\r\nproto_tree* lock_tree = NULL;\r\nint old_offset = offset;\r\nlock_item = proto_tree_add_item(tree, hf_nisplus_log_entry,\r\ntvb, offset, -1, ENC_NA);\r\nlock_tree = proto_item_add_subtree(lock_item, ett_nisplus_log_entry);\r\noffset = dissect_nisplus_time(tvb, offset, lock_tree,\r\nhf_nisplus_log_time);\r\noffset = dissect_rpc_uint32(tvb, lock_tree,\r\nhf_nisplus_log_type, offset);\r\noffset = dissect_rpc_string(tvb, lock_tree,\r\nhf_nisplus_log_principal, offset, NULL);\r\noffset = dissect_rpc_string(tvb, lock_tree,\r\nhf_nisplus_directory_name, offset, NULL);\r\noffset = dissect_rpc_array(tvb, pinfo, lock_tree, offset,\r\ndissect_attr, hf_nisplus_attrs_array);\r\noffset = dissect_nisplus_object(tvb, offset, pinfo, lock_tree, data);\r\nproto_item_set_len(lock_item, offset-old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_log_result(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_uint32(tvb, tree,\r\nhf_nisplus_error, offset);\r\noffset = dissect_rpc_data(tvb, tree,\r\nhf_nisplus_cookie, offset);\r\noffset = dissect_rpc_array(tvb, pinfo, tree, offset,\r\ndissect_log_entry, hf_nisplus_log_entries);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_callback_result(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nreturn dissect_rpc_bool(tvb, tree, hf_nisplus_callback_status, 0);\r\n}\r\nstatic int\r\ndissect_change_time(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nreturn dissect_nisplus_time(tvb, 0, tree, hf_nisplus_log_time);\r\n}\r\nstatic int\r\ndissect_cp_result(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_uint32(tvb, tree,\r\nhf_nisplus_cp_status, offset);\r\noffset = dissect_rpc_uint32(tvb, tree,\r\nhf_nisplus_cp_zticks, offset);\r\noffset = dissect_rpc_uint32(tvb, tree,\r\nhf_nisplus_cp_dticks, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_nisplus_error(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nreturn dissect_rpc_uint32(tvb, tree, hf_nisplus_error, 0);\r\n}\r\nvoid\r\nproto_register_nis(void)\r\n{\r\nstatic const true_false_string tfs_col_binary = {\r\n"column is binary",\r\n"column is NOT binary"\r\n};\r\nstatic const true_false_string tfs_col_encrypted = {\r\n"column is encrypted",\r\n"column is NOT encrypted"\r\n};\r\nstatic const true_false_string tfs_col_xdr = {\r\n"column is xdr encoded",\r\n"column is NOT xdr encoded"\r\n};\r\nstatic const true_false_string tfs_col_searchable = {\r\n"column is searchable",\r\n"column is NOT searchable"\r\n};\r\nstatic const true_false_string tfs_col_casesensitive = {\r\n"column is case sensitive",\r\n"column is NOT case sensitive"\r\n};\r\nstatic const true_false_string tfs_col_modified = {\r\n"column is modified",\r\n"column is NOT modified"\r\n};\r\nstatic const true_false_string tfs_col_asn = {\r\n"column is asn.1 encoded",\r\n"column is NOT asn.1 encoded"\r\n};\r\nstatic const true_false_string tfs_entry_binary = {\r\n"entry is binary",\r\n"entry is NOT binary"\r\n};\r\nstatic const true_false_string tfs_entry_crypt = {\r\n"entry is encrypted",\r\n"entry is NOT encrypted"\r\n};\r\nstatic const true_false_string tfs_entry_xdr = {\r\n"entry is xdr encoded",\r\n"entry is NOT xdr encoded"\r\n};\r\nstatic const true_false_string tfs_entry_modified = {\r\n"entry is modified",\r\n"entry is NOT modified"\r\n};\r\nstatic const true_false_string tfs_entry_asn = {\r\n"entry is asn.1 encoded",\r\n"entry is NOT asn.1 encoded"\r\n};\r\nstatic const true_false_string tfs_world_read = {\r\n"world can read",\r\n"world can NOT read"\r\n};\r\nstatic const true_false_string tfs_world_modify = {\r\n"world can modify",\r\n"world can NOT modify"\r\n};\r\nstatic const true_false_string tfs_world_create = {\r\n"world can create",\r\n"world can NOT create"\r\n};\r\nstatic const true_false_string tfs_world_destroy = {\r\n"world can destroy",\r\n"world can NOT destroy"\r\n};\r\nstatic const true_false_string tfs_group_read = {\r\n"group can read",\r\n"group can NOT read"\r\n};\r\nstatic const true_false_string tfs_group_modify = {\r\n"group can modify",\r\n"group can NOT modify"\r\n};\r\nstatic const true_false_string tfs_group_create = {\r\n"group can create",\r\n"group can NOT create"\r\n};\r\nstatic const true_false_string tfs_group_destroy = {\r\n"group can destroy",\r\n"group can NOT destroy"\r\n};\r\nstatic const true_false_string tfs_owner_read = {\r\n"owner can read",\r\n"owner can NOT read"\r\n};\r\nstatic const true_false_string tfs_owner_modify = {\r\n"owner can modify",\r\n"owner can NOT modify"\r\n};\r\nstatic const true_false_string tfs_owner_create = {\r\n"owner can create",\r\n"owner can NOT create"\r\n};\r\nstatic const true_false_string tfs_owner_destroy = {\r\n"owner can destroy",\r\n"owner can NOT destroy"\r\n};\r\nstatic const true_false_string tfs_nobody_read = {\r\n"nobody can read",\r\n"nobody can NOT read"\r\n};\r\nstatic const true_false_string tfs_nobody_modify = {\r\n"nobody can modify",\r\n"nobody can NOT modify"\r\n};\r\nstatic const true_false_string tfs_nobody_create = {\r\n"nobody can create",\r\n"nobody can NOT create"\r\n};\r\nstatic const true_false_string tfs_nobody_destroy = {\r\n"nobody can destroy",\r\n"nobody can NOT destroy"\r\n};\r\nstatic const true_false_string tfs_callback_status = {\r\n"unknown",\r\n"unknown"\r\n};\r\nstatic hf_register_info hf[] = {\r\n{ &hf_nisplus_procedure_v3, {\r\n"V3 Procedure", "nisplus.procedure_v3", FT_UINT32, BASE_DEC,\r\nVALS(nisplus3_proc_vals), 0, NULL, HFILL }},\r\n{ &hf_nisplus_object, {\r\n"NIS Object", "nisplus.object", FT_NONE, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_nisplus_oid, {\r\n"Object Identity Verifier", "nisplus.object.oid", FT_NONE, BASE_NONE,\r\nNULL, 0, "NIS Object Identity Verifier", HFILL }},\r\n{ &hf_nisplus_object_name, {\r\n"name", "nisplus.object.name", FT_STRING, BASE_NONE,\r\nNULL, 0, "NIS Name For This Object", HFILL }},\r\n{ &hf_nisplus_object_owner, {\r\n"owner", "nisplus.object.owner", FT_STRING, BASE_NONE,\r\nNULL, 0, "NIS Name Of Object Owner", HFILL }},\r\n{ &hf_nisplus_object_group, {\r\n"group", "nisplus.object.group", FT_STRING, BASE_NONE,\r\nNULL, 0, "NIS Name Of Access Group", HFILL }},\r\n{ &hf_nisplus_object_domain, {\r\n"domain", "nisplus.object.domain", FT_STRING, BASE_NONE,\r\nNULL, 0, "NIS Administrator For This Object", HFILL }},\r\n{ &hf_nisplus_object_ttl, {\r\n"ttl", "nisplus.object.ttl", FT_UINT32, BASE_DEC,\r\nNULL, 0, "NIS Time To Live For This Object", HFILL }},\r\n{ &hf_nisplus_object_private, {\r\n"private", "nisplus.object.private", FT_BYTES, BASE_NONE,\r\nNULL, 0, "NIS Private Object", HFILL }},\r\n{ &hf_nisplus_directory, {\r\n"directory", "nisplus.directory", FT_NONE, BASE_NONE,\r\nNULL, 0, "NIS Directory Object", HFILL }},\r\n{ &hf_nisplus_directory_name, {\r\n"directory name", "nisplus.directory.name", FT_STRING, BASE_NONE,\r\nNULL, 0, "Name Of Directory Being Served", HFILL }},\r\n{ &hf_nisplus_directory_type, {\r\n"type", "nisplus.directory.type", FT_UINT32, BASE_DEC,\r\nVALS(ns_type), 0, "NIS Type Of Name Service", HFILL }},\r\n{ &hf_nisplus_directory_ttl, {\r\n"ttl", "nisplus.directory.ttl", FT_UINT32, BASE_DEC,\r\nNULL, 0, "Time To Live", HFILL }},\r\n{ &hf_nisplus_directory_mask, {\r\n"mask", "nisplus.directory.mask", FT_NONE, BASE_NONE,\r\nNULL, 0, "NIS Directory Create/Destroy Rights", HFILL }},\r\n{ &hf_nisplus_directory_mask_list, {\r\n"mask list", "nisplus.directory.mask_list", FT_NONE, BASE_NONE,\r\nNULL, 0, "List Of Directory Create/Destroy Rights", HFILL }},\r\n{ &hf_nisplus_mask_world_read, {\r\n"WORLD READ", "nisplus.directory.mask.world_read",\r\nFT_BOOLEAN, 32, TFS(&tfs_world_read),\r\nNIS_MASK_WORLD_READ, "World Read Flag", HFILL }},\r\n{ &hf_nisplus_mask_world_modify, {\r\n"WORLD MODIFY", "nisplus.directory.mask.world_modify",\r\nFT_BOOLEAN, 32, TFS(&tfs_world_modify),\r\nNIS_MASK_WORLD_MODIFY, "World Modify Flag", HFILL }},\r\n{ &hf_nisplus_mask_world_create, {\r\n"WORLD CREATE", "nisplus.directory.mask.world_create",\r\nFT_BOOLEAN, 32, TFS(&tfs_world_create),\r\nNIS_MASK_WORLD_CREATE, "World Create Flag", HFILL }},\r\n{ &hf_nisplus_mask_world_destroy, {\r\n"WORLD DESTROY", "nisplus.directory.mask.world_destroy",\r\nFT_BOOLEAN, 32, TFS(&tfs_world_destroy),\r\nNIS_MASK_WORLD_DESTROY, "World Destroy Flag", HFILL }},\r\n{ &hf_nisplus_mask_group_read, {\r\n"GROUP READ", "nisplus.directory.mask.group_read",\r\nFT_BOOLEAN, 32, TFS(&tfs_group_read),\r\nNIS_MASK_GROUP_READ, "Group Read Flag", HFILL }},\r\n{ &hf_nisplus_mask_group_modify, {\r\n"GROUP MODIFY", "nisplus.directory.mask.group_modify",\r\nFT_BOOLEAN, 32, TFS(&tfs_group_modify),\r\nNIS_MASK_GROUP_MODIFY, "Group Modify Flag", HFILL }},\r\n{ &hf_nisplus_mask_group_create, {\r\n"GROUP CREATE", "nisplus.directory.mask.group_create",\r\nFT_BOOLEAN, 32, TFS(&tfs_group_create),\r\nNIS_MASK_GROUP_CREATE, "Group Create Flag", HFILL }},\r\n{ &hf_nisplus_mask_group_destroy, {\r\n"GROUP DESTROY", "nisplus.directory.mask.group_destroy",\r\nFT_BOOLEAN, 32, TFS(&tfs_group_destroy),\r\nNIS_MASK_GROUP_DESTROY, "Group Destroy Flag", HFILL }},\r\n{ &hf_nisplus_mask_owner_read, {\r\n"OWNER READ", "nisplus.directory.mask.owner_read",\r\nFT_BOOLEAN, 32, TFS(&tfs_owner_read),\r\nNIS_MASK_OWNER_READ, "Owner Read Flag", HFILL }},\r\n{ &hf_nisplus_mask_owner_modify, {\r\n"OWNER MODIFY", "nisplus.directory.mask.owner_modify",\r\nFT_BOOLEAN, 32, TFS(&tfs_owner_modify),\r\nNIS_MASK_OWNER_MODIFY, "Owner Modify Flag", HFILL }},\r\n{ &hf_nisplus_mask_owner_create, {\r\n"OWNER CREATE", "nisplus.directory.mask.owner_create",\r\nFT_BOOLEAN, 32, TFS(&tfs_owner_create),\r\nNIS_MASK_OWNER_CREATE, "Owner Create Flag", HFILL }},\r\n{ &hf_nisplus_mask_owner_destroy, {\r\n"OWNER DESTROY", "nisplus.directory.mask.owner_destroy",\r\nFT_BOOLEAN, 32, TFS(&tfs_owner_destroy),\r\nNIS_MASK_OWNER_DESTROY, "Owner Destroy Flag", HFILL }},\r\n{ &hf_nisplus_mask_nobody_read, {\r\n"NOBODY READ", "nisplus.directory.mask.nobody_read",\r\nFT_BOOLEAN, 32, TFS(&tfs_nobody_read),\r\nNIS_MASK_NOBODY_READ, "Nobody Read Flag", HFILL }},\r\n{ &hf_nisplus_mask_nobody_modify, {\r\n"NOBODY MODIFY", "nisplus.directory.mask.nobody_modify",\r\nFT_BOOLEAN, 32, TFS(&tfs_nobody_modify),\r\nNIS_MASK_NOBODY_MODIFY, "Nobody Modify Flag", HFILL }},\r\n{ &hf_nisplus_mask_nobody_create, {\r\n"NOBODY CREATE", "nisplus.directory.mask.nobody_create",\r\nFT_BOOLEAN, 32, TFS(&tfs_nobody_create),\r\nNIS_MASK_NOBODY_CREATE, "Nobody Create Flag", HFILL }},\r\n{ &hf_nisplus_mask_nobody_destroy, {\r\n"NOBODY DESTROY", "nisplus.directory.mask.nobody_destroy",\r\nFT_BOOLEAN, 32, TFS(&tfs_nobody_destroy),\r\nNIS_MASK_NOBODY_DESTROY, "Nobody Destroy Flag", HFILL }},\r\n{ &hf_nisplus_access_mask, {\r\n"access mask", "nisplus.access.mask", FT_UINT32, BASE_HEX,\r\nNULL, 0, "NIS Access Mask", HFILL }},\r\n{ &hf_nisplus_object_type, {\r\n"type", "nisplus.object.type", FT_UINT32, BASE_DEC,\r\nVALS(obj_type), 0, "NIS Type Of Object", HFILL }},\r\n{ &hf_nisplus_servers, {\r\n"nis servers", "nisplus.servers", FT_NONE, BASE_NONE,\r\nNULL, 0, "NIS Servers For This Directory", HFILL }},\r\n{ &hf_nisplus_cbservers, {\r\n"nis servers", "nisplus.servers", FT_NONE, BASE_NONE,\r\nNULL, 0, "Optional Callback Server", HFILL }},\r\n{ &hf_nisplus_server, {\r\n"server", "nisplus.server", FT_NONE, BASE_NONE,\r\nNULL, 0, "NIS Server For This Directory", HFILL }},\r\n{ &hf_nisplus_server_name, {\r\n"name", "nisplus.server.name", FT_STRING, BASE_NONE,\r\nNULL, 0, "Name Of NIS Server", HFILL }},\r\n{ &hf_nisplus_key_type, {\r\n"type", "nisplus.key.type", FT_UINT32, BASE_DEC,\r\nVALS(key_type), 0, "Type Of Key", HFILL }},\r\n{ &hf_nisplus_key_data, {\r\n"key data", "nisplus.key.data", FT_BYTES, BASE_NONE,\r\nNULL, 0, "Encryption Key", HFILL }},\r\n{ &hf_nisplus_endpoints, {\r\n"nis endpoints", "nisplus.endpoints", FT_NONE, BASE_NONE,\r\nNULL, 0, "Endpoints For This NIS Server", HFILL }},\r\n{ &hf_nisplus_endpoint, {\r\n"endpoint", "nisplus.endpoint", FT_NONE, BASE_NONE,\r\nNULL, 0, "Endpoint For This NIS Server", HFILL }},\r\n{ &hf_nisplus_endpoint_uaddr, {\r\n"addr", "nisplus.endpoint.uaddr", FT_STRING, BASE_NONE,\r\nNULL, 0, "Address", HFILL }},\r\n{ &hf_nisplus_endpoint_family, {\r\n"family", "nisplus.endpoint.family", FT_STRING, BASE_NONE,\r\nNULL, 0, "Transport Family", HFILL }},\r\n{ &hf_nisplus_endpoint_proto, {\r\n"proto", "nisplus.endpoint.proto", FT_STRING, BASE_NONE,\r\nNULL, 0, "Protocol", HFILL }},\r\n{ &hf_nisplus_link, {\r\n"link", "nisplus.link", FT_NONE, BASE_NONE,\r\nNULL, 0, "NIS Link Object", HFILL }},\r\n{ &hf_nisplus_attrs_array, {\r\n"Attributes", "nisplus.attributes", FT_NONE, BASE_NONE,\r\nNULL, 0, "List Of Attributes", HFILL }},\r\n{ &hf_nisplus_attr, {\r\n"Attribute", "nisplus.attr", FT_NONE, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_nisplus_attr_name, {\r\n"name", "nisplus.attr.name", FT_STRING, BASE_NONE,\r\nNULL, 0, "Attribute Name", HFILL }},\r\n{ &hf_nisplus_attr_val, {\r\n"val", "nisplus.attr.val", FT_BYTES, BASE_NONE,\r\nNULL, 0, "Attribute Value", HFILL }},\r\n{ &hf_nisplus_entry, {\r\n"entry", "nisplus.entry", FT_NONE, BASE_NONE,\r\nNULL, 0, "Entry Object", HFILL }},\r\n{ &hf_nisplus_entry_type, {\r\n"type", "nisplus.entry.type", FT_STRING, BASE_NONE,\r\nNULL, 0, "Entry Type", HFILL }},\r\n{ &hf_nisplus_entry_cols, {\r\n"columns", "nisplus.entry.cols", FT_NONE, BASE_NONE,\r\nNULL, 0, "Entry Columns", HFILL }},\r\n{ &hf_nisplus_entry_col, {\r\n"column", "nisplus.entry.col", FT_NONE, BASE_NONE,\r\nNULL, 0, "Entry Column", HFILL }},\r\n#if 0\r\n{ &hf_nisplus_entry_flags, {\r\n"flags", "nisplus.entry.flags", FT_UINT32, BASE_HEX,\r\nNULL, 0, "Entry Col Flags", HFILL }},\r\n#endif\r\n{ &hf_nisplus_entry_val, {\r\n"val", "nisplus.entry.val", FT_STRING, BASE_NONE,\r\nNULL, 0, "Entry Value", HFILL }},\r\n{ &hf_nisplus_entry_mask, {\r\n"mask", "nisplus.entry.mask", FT_UINT32, BASE_HEX,\r\nNULL, 0, "Entry Col Mask", HFILL }},\r\n{ &hf_nisplus_entry_mask_binary, {\r\n"BINARY", "nisplus.entry.mask.binary",\r\nFT_BOOLEAN, 32, TFS(&tfs_entry_binary),\r\nNIS_MASK_ENTRY_BINARY, "Is This Entry BINARY Flag", HFILL }},\r\n{ &hf_nisplus_entry_mask_crypt, {\r\n"ENCRYPTED", "nisplus.entry.mask.encrypted",\r\nFT_BOOLEAN, 32, TFS(&tfs_entry_crypt),\r\nNIS_MASK_ENTRY_CRYPT, "Is This Entry ENCRYPTED Flag", HFILL }},\r\n{ &hf_nisplus_entry_mask_xdr, {\r\n"XDR", "nisplus.entry.mask.xdr",\r\nFT_BOOLEAN, 32, TFS(&tfs_entry_xdr),\r\nNIS_MASK_ENTRY_XDR, "Is This Entry XDR Encoded Flag", HFILL }},\r\n{ &hf_nisplus_entry_mask_modified, {\r\n"MODIFIED", "nisplus.entry.mask.modified",\r\nFT_BOOLEAN, 32, TFS(&tfs_entry_modified),\r\nNIS_MASK_ENTRY_MODIFIED, "Is This Entry MODIFIED Flag", HFILL }},\r\n{ &hf_nisplus_entry_mask_asn, {\r\n"ASN.1", "nisplus.entry.mask.asn",\r\nFT_BOOLEAN, 32, TFS(&tfs_entry_asn),\r\nNIS_MASK_ENTRY_ASN, "Is This Entry ASN.1 Encoded Flag", HFILL }},\r\n{ &hf_nisplus_table, {\r\n"table", "nisplus.table", FT_NONE, BASE_NONE,\r\nNULL, 0, "Table Object", HFILL }},\r\n{ &hf_nisplus_table_type, {\r\n"type", "nisplus.table.type", FT_STRING, BASE_NONE,\r\nNULL, 0, "Table Type", HFILL }},\r\n{ &hf_nisplus_table_maxcol, {\r\n"max columns", "nisplus.table.maxcol", FT_UINT16, BASE_DEC,\r\nNULL, 0, "Maximum Number Of Columns For Table", HFILL }},\r\n{ &hf_nisplus_table_sep, {\r\n"separator", "nisplus.table.separator", FT_UINT8, BASE_HEX,\r\nNULL, 0, "Separator Character", HFILL }},\r\n{ &hf_nisplus_table_cols, {\r\n"columns", "nisplus.table.cols", FT_NONE, BASE_NONE,\r\nNULL, 0, "Table Columns", HFILL }},\r\n{ &hf_nisplus_table_col, {\r\n"column", "nisplus.table.col", FT_NONE, BASE_NONE,\r\nNULL, 0, "Table Column", HFILL }},\r\n{ &hf_nisplus_table_path, {\r\n"path", "nisplus.table.path", FT_STRING, BASE_NONE,\r\nNULL, 0, "Table Path", HFILL }},\r\n{ &hf_nisplus_table_col_name, {\r\n"column name", "nisplus.table.col.name", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_nisplus_table_col_mask, {\r\n"flags", "nisplus.table.col.flags", FT_UINT32, BASE_HEX,\r\nNULL, 0, "Flags For This Column", HFILL }},\r\n{ &hf_nisplus_table_col_mask_binary, {\r\n"binary", "nisplus.table.flags.binary",\r\nFT_BOOLEAN, 32, TFS(&tfs_col_binary),\r\nNIS_MASK_TABLE_BINARY, "Is This Column BINARY", HFILL }},\r\n{ &hf_nisplus_table_col_mask_encrypted, {\r\n"encrypted", "nisplus.table.flags.encrypted",\r\nFT_BOOLEAN, 32, TFS(&tfs_col_encrypted),\r\nNIS_MASK_TABLE_CRYPT, "Is This Column ENCRYPTED", HFILL }},\r\n{ &hf_nisplus_table_col_mask_xdr, {\r\n"xdr", "nisplus.table.flags.xdr",\r\nFT_BOOLEAN, 32, TFS(&tfs_col_xdr),\r\nNIS_MASK_TABLE_XDR, "Is This Column XDR Encoded", HFILL }},\r\n{ &hf_nisplus_table_col_mask_searchable, {\r\n"searchable", "nisplus.table.flags.searchable",\r\nFT_BOOLEAN, 32, TFS(&tfs_col_searchable),\r\nNIS_MASK_TABLE_SRCH, "Is This Column SEARCHABLE", HFILL }},\r\n{ &hf_nisplus_table_col_mask_casesensitive, {\r\n"casesensitive", "nisplus.table.flags.casesensitive",\r\nFT_BOOLEAN, 32, TFS(&tfs_col_casesensitive),\r\nNIS_MASK_TABLE_CASE, "Is This Column CASESENSITIVE", HFILL }},\r\n{ &hf_nisplus_table_col_mask_modified, {\r\n"modified", "nisplus.table.flags.modified",\r\nFT_BOOLEAN, 32, TFS(&tfs_col_modified),\r\nNIS_MASK_TABLE_MODIFIED, "Is This Column MODIFIED", HFILL }},\r\n{ &hf_nisplus_table_col_mask_asn, {\r\n"asn", "nisplus.table.flags.asn",\r\nFT_BOOLEAN, 32, TFS(&tfs_col_asn),\r\nNIS_MASK_TABLE_ASN, "Is This Column ASN.1 Encoded", HFILL }},\r\n{ &hf_nisplus_group, {\r\n"Group", "nisplus.group", FT_NONE, BASE_NONE,\r\nNULL, 0, "Group Object", HFILL }},\r\n{ &hf_nisplus_grps, {\r\n"Groups", "nisplus.grps", FT_NONE, BASE_NONE,\r\nNULL, 0, "List Of Groups", HFILL }},\r\n{ &hf_nisplus_group_flags, {\r\n"flags", "nisplus.group.flags", FT_UINT32, BASE_HEX,\r\nNULL, 0, "Group Object Flags", HFILL }},\r\n{ &hf_nisplus_group_name, {\r\n"group name", "nisplus.group.name", FT_STRING, BASE_NONE,\r\nNULL, 0, "Name Of Group Member", HFILL }},\r\n{ &hf_nisplus_object_ctime, {\r\n"ctime", "nisplus.ctime", FT_ABSOLUTE_TIME, ABSOLUTE_TIME_LOCAL,\r\nNULL, 0, "Time Of Creation", HFILL }},\r\n{ &hf_nisplus_object_mtime, {\r\n"mtime", "nisplus.mtime", FT_ABSOLUTE_TIME, ABSOLUTE_TIME_LOCAL,\r\nNULL, 0, "Time Last Modified", HFILL }},\r\n{ &hf_nisplus_ib_flags, {\r\n"flags", "nisplus.ib.flags", FT_UINT32, BASE_HEX,\r\nNULL, 0, "Information Base Flags", HFILL }},\r\n{ &hf_nisplus_ib_bufsize, {\r\n"bufsize", "nisplus.ib.bufsize", FT_UINT32, BASE_HEX,\r\nNULL, 0, "Optional First/NextBufSize", HFILL }},\r\n{ &hf_nisplus_cookie, {\r\n"cookie", "nisplus.cookie", FT_BYTES, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_nisplus_fd_dirname, {\r\n"dirname", "nisplus.fd.dirname", FT_STRING, BASE_NONE,\r\nNULL, 0, "Directory Name", HFILL }},\r\n{ &hf_nisplus_fd_requester, {\r\n"requester", "nisplus.fd.requester", FT_STRING, BASE_NONE,\r\nNULL, 0, "Host Principal Name For Signature", HFILL }},\r\n{ &hf_nisplus_taglist, {\r\n"taglist", "nisplus.taglist", FT_NONE, BASE_NONE,\r\nNULL, 0, "List Of Tags", HFILL }},\r\n{ &hf_nisplus_tag, {\r\n"tag", "nisplus.tag", FT_NONE, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_nisplus_tag_type, {\r\n"type", "nisplus.tag.type", FT_UINT32, BASE_DEC,\r\nNULL, 0, "Type Of Statistics Tag", HFILL }},\r\n{ &hf_nisplus_tag_val, {\r\n"value", "nisplus.tag.value", FT_STRING, BASE_NONE,\r\nNULL, 0, "Value Of Statistics Tag", HFILL }},\r\n{ &hf_nisplus_dump_dir, {\r\n"directory", "nisplus.dump.dir", FT_STRING, BASE_NONE,\r\nNULL, 0, "Directory To Dump", HFILL }},\r\n{ &hf_nisplus_dump_time, {\r\n"time", "nisplus.dump.time", FT_ABSOLUTE_TIME, ABSOLUTE_TIME_LOCAL,\r\nNULL, 0, "From This Timestamp", HFILL }},\r\n{ &hf_nisplus_dummy, {\r\n"dummy", "nisplus.dummy", FT_BYTES, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_nisplus_ping_time, {\r\n"time", "nisplus.ping.time", FT_ABSOLUTE_TIME, ABSOLUTE_TIME_LOCAL,\r\nNULL, 0, "Timestamp Of The Transaction", HFILL }},\r\n{ &hf_nisplus_ping_dir, {\r\n"directory", "nisplus.ping.dir", FT_STRING, BASE_NONE,\r\nNULL, 0, "Directory That Had The Change", HFILL }},\r\n{ &hf_nisplus_error, {\r\n"status", "nisplus.status", FT_UINT32, BASE_DEC,\r\nVALS(nis_error), 0, "NIS Status Code", HFILL }},\r\n{ &hf_nisplus_dir_data, {\r\n"data", "nisplus.fd.dir.data", FT_BYTES, BASE_NONE,\r\nNULL, 0, "Directory Data In XDR Format", HFILL }},\r\n{ &hf_nisplus_signature, {\r\n"signature", "nisplus.fd.sig", FT_BYTES, BASE_NONE,\r\nNULL, 0, "Signature Of The Source", HFILL }},\r\n{ &hf_nisplus_log_entries, {\r\n"log entries", "nisplus.log.entries", FT_NONE, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_nisplus_log_entry, {\r\n"log entry", "nisplus.log.entry", FT_NONE, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_nisplus_log_time, {\r\n"time", "nisplus.log.time", FT_ABSOLUTE_TIME, ABSOLUTE_TIME_LOCAL,\r\nNULL, 0, "Time Of Log Entry", HFILL }},\r\n{ &hf_nisplus_log_type, {\r\n"type", "nisplus.log.entry.type", FT_UINT32, BASE_DEC,\r\nVALS(entry_type), 0, "Type Of Entry In Transaction Log", HFILL }},\r\n{ &hf_nisplus_log_principal, {\r\n"principal", "nisplus.log.principal", FT_STRING, BASE_NONE,\r\nNULL, 0, "Principal Making The Change", HFILL }},\r\n{ &hf_nisplus_callback_status, {\r\n"status", "nisplus.callback.status",\r\nFT_BOOLEAN, BASE_NONE, TFS(&tfs_callback_status),\r\n0x0, "Status Of Callback Thread", HFILL }},\r\n{ &hf_nisplus_cp_status, {\r\n"status", "nisplus.checkpoint.status", FT_UINT32, BASE_DEC,\r\nNULL, 0, "Checkpoint Status", HFILL }},\r\n{ &hf_nisplus_cp_zticks, {\r\n"zticks", "nisplus.checkpoint.zticks", FT_UINT32, BASE_DEC,\r\nNULL, 0, "Service Ticks", HFILL }},\r\n{ &hf_nisplus_cp_dticks, {\r\n"dticks", "nisplus.checkpoint.dticks", FT_UINT32, BASE_DEC,\r\nNULL, 0, "Database Ticks", HFILL }},\r\n{ &hf_nisplus_zticks, {\r\n"zticks", "nisplus.zticks", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_nisplus_dticks, {\r\n"dticks", "nisplus.dticks", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_nisplus_aticks, {\r\n"aticks", "nisplus.aticks", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_nisplus_cticks, {\r\n"cticks", "nisplus.cticks", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_nisplus,\r\n&ett_nisplus_object,\r\n&ett_nisplus_oid,\r\n&ett_nisplus_directory,\r\n&ett_nisplus_directory_mask,\r\n&ett_nisplus_access_mask,\r\n&ett_nisplus_server,\r\n&ett_nisplus_endpoint,\r\n&ett_nisplus_link,\r\n&ett_nisplus_attr,\r\n&ett_nisplus_entry,\r\n&ett_nisplus_entry_col,\r\n&ett_nisplus_entry_mask,\r\n&ett_nisplus_table,\r\n&ett_nisplus_table_col,\r\n&ett_nisplus_table_col_mask,\r\n&ett_nisplus_group,\r\n&ett_nisplus_grps,\r\n&ett_nisplus_tag,\r\n&ett_nisplus_log_entry,\r\n};\r\nproto_nisplus = proto_register_protocol("NIS+",\r\n"NIS+", "nisplus");\r\nproto_register_field_array(proto_nisplus, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid\r\nproto_reg_handoff_nis(void)\r\n{\r\nrpc_init_prog(proto_nisplus, NIS_PROGRAM, ett_nisplus,\r\nG_N_ELEMENTS(nisplus_vers_info), nisplus_vers_info);\r\n}\r\nstatic int\r\ndissect_cb_entry(tvbuff_t *tvb, int offset, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nproto_item* lock_item = NULL;\r\nint old_offset = offset;\r\nlock_item = proto_tree_add_item(tree, hf_nispluscb_entry,\r\ntvb, offset, -1, ENC_NA);\r\nproto_item_set_len(lock_item, offset-old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_cback_data(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void* data _U_)\r\n{\r\nreturn dissect_rpc_array(tvb, pinfo, tree, 0,\r\ndissect_cb_entry, hf_nispluscb_entries);\r\n}\r\nvoid\r\nproto_register_niscb(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_nispluscb_procedure_v1, {\r\n"V1 Procedure", "nispluscb.procedure_v1", FT_UINT32, BASE_DEC,\r\nVALS(nispluscb1_proc_vals), 0, NULL, HFILL }},\r\n{ &hf_nispluscb_entries, {\r\n"entries", "nispluscb.entries", FT_NONE, BASE_NONE,\r\nNULL, 0, "NIS Callback Entries", HFILL }},\r\n{ &hf_nispluscb_entry, {\r\n"entry", "nispluscb.entry", FT_NONE, BASE_NONE,\r\nNULL, 0, "NIS Callback Entry", HFILL }},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_nispluscb,\r\n&ett_nispluscb_entry,\r\n};\r\nproto_nispluscb = proto_register_protocol("NIS+ Callback",\r\n"NIS+ CB", "nispluscb");\r\nproto_register_field_array(proto_nispluscb, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid\r\nproto_reg_handoff_niscb(void)\r\n{\r\nrpc_init_prog(proto_nispluscb, CB_PROGRAM, ett_nispluscb,\r\nG_N_ELEMENTS(nispluscb_vers_info), nispluscb_vers_info);\r\n}
