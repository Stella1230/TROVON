gint\r\ndissect_uleb128(tvbuff_t *tvb, gint offset, guint64 *value)\r\n{\r\nguint start_offset = offset;\r\nguint shift = 0;\r\nguint8 byte;\r\n*value = 0;\r\ndo {\r\nbyte = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\n*value |= ((guint64)(byte & 0x7F) << shift);\r\nshift += 7;\r\n} while (byte & 0x80);\r\nreturn offset - start_offset;\r\n}\r\ngint\r\ndissect_leb128(tvbuff_t *tvb, gint offset, gint64 *value)\r\n{\r\nguint start_offset = offset;\r\nguint shift = 0;\r\nguint8 byte;\r\n*value = 0;\r\ndo {\r\nbyte = tvb_get_guint8(tvb, offset);\r\noffset += 1;\r\n*value |= ((guint64)(byte & 0x7F) << shift);\r\nshift += 7;\r\n} while (byte & 0x80);\r\nif (shift < 64 && byte & 0x40)\r\n*value |= - ((gint64)1 << shift);\r\nreturn offset - start_offset;\r\n}
