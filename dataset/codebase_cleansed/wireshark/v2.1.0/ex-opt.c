gboolean ex_opt_add(const gchar* optarg) {\r\ngchar** splitted;\r\nif (!ex_opts)\r\nex_opts = g_hash_table_new(g_str_hash,g_str_equal);\r\nsplitted = g_strsplit(optarg,":",2);\r\nif (splitted[0] && splitted[1]) {\r\nGPtrArray* this_opts = (GPtrArray *)g_hash_table_lookup(ex_opts,splitted[0]);\r\nif (this_opts) {\r\ng_ptr_array_add(this_opts,splitted[1]);\r\ng_free(splitted[0]);\r\n} else {\r\nthis_opts = g_ptr_array_new();\r\ng_ptr_array_add(this_opts,splitted[1]);\r\ng_hash_table_insert(ex_opts,splitted[0],this_opts);\r\n}\r\ng_free(splitted);\r\nreturn TRUE;\r\n} else {\r\ng_strfreev(splitted);\r\nreturn FALSE;\r\n}\r\n}\r\ngint ex_opt_count(const gchar* key) {\r\nGPtrArray* this_opts;\r\nif (! ex_opts)\r\nreturn 0;\r\nthis_opts = (GPtrArray *)g_hash_table_lookup(ex_opts,key);\r\nif (this_opts) {\r\nreturn this_opts->len;\r\n} else {\r\nreturn 0;\r\n}\r\n}\r\nconst gchar* ex_opt_get_nth(const gchar* key, guint index) {\r\nGPtrArray* this_opts;\r\nif (! ex_opts)\r\nreturn 0;\r\nthis_opts = (GPtrArray *)g_hash_table_lookup(ex_opts,key);\r\nif (this_opts) {\r\nif (this_opts->len > index) {\r\nreturn (const gchar *)g_ptr_array_index(this_opts,index);\r\n} else {\r\nreturn NULL;\r\n}\r\n} else {\r\nreturn NULL;\r\n}\r\n}\r\nextern const gchar* ex_opt_get_next(const gchar* key) {\r\nGPtrArray* this_opts;\r\nif (! ex_opts)\r\nreturn 0;\r\nthis_opts = (GPtrArray *)g_hash_table_lookup(ex_opts,key);\r\nif (this_opts) {\r\nif (this_opts->len)\r\nreturn (const gchar *)g_ptr_array_remove_index(this_opts,0);\r\nelse\r\nreturn NULL;\r\n} else {\r\nreturn NULL;\r\n}\r\n}
