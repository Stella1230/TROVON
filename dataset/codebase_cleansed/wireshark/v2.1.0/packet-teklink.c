static int dissect_teklink_tlaframeopen_call(tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_unknown_long, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_teklink_unknown_string, offset, NULL);\r\noffset = dissect_rpc_string(tvb, tree, hf_teklink_unknown_string, offset, NULL);\r\noffset = dissect_rpc_string(tvb, tree, hf_teklink_unknown_string, offset, NULL);\r\nreturn offset;\r\n}\r\nstatic int dissect_teklink_tlaframeclose_call(tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nreturn dissect_rpc_uint32(tvb, tree, hf_teklink_unknown_long, 0);\r\n}\r\nstatic int dissect_teklink_tlaframeclose_reply(tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nreturn dissect_rpc_uint32(tvb, tree, hf_teklink_unknown_long, 0);\r\n}\r\nstatic int dissect_teklink_tlaframeopen_reply(tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_unknown_long, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_unknown_long, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_unknown_long, offset);\r\nreturn offset;\r\n}\r\nstatic int dissect_teklink_get_software_version_reply(tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_unknown_long, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_unknown_long, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_teklink_unknown_string, offset, NULL);\r\noffset = dissect_rpc_string(tvb, tree, hf_teklink_unknown_string, offset, NULL);\r\nreturn offset;\r\n}\r\nstatic int dissect_teklink_call65_call(tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_cmd, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_unknown_long, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_unknown_long, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_unknown_long, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_unknown_long, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_unknown_long, offset);\r\nreturn offset;\r\n}\r\nstatic int dissect_teklink_call65_reply(tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nreturn dissect_rpc_uint32(tvb, tree, hf_teklink_unknown_long, 0);\r\n}\r\nstatic int dissect_teklink_info_reply(tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_locked, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_unknown_long, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_tla_type, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_unknown_long, offset);\r\noffset = dissect_rpc_string(tvb, tree, hf_teklink_unknown_string, offset, NULL);\r\noffset = dissect_rpc_string(tvb, tree, hf_teklink_location, offset, NULL);\r\noffset = dissect_rpc_string(tvb, tree, hf_teklink_user, offset, NULL);\r\noffset = dissect_rpc_string(tvb, tree, hf_teklink_host, offset, NULL);\r\noffset = dissect_rpc_string(tvb, tree, hf_teklink_unknown_string, offset, NULL);\r\nreturn offset;\r\n}\r\nstatic int dissect_teklink_info_call(tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_unknown_long, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_unknown_long, offset);\r\nreturn offset;\r\n}\r\nstatic int dissect_teklink_vtc_ident(tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_unknown_long, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_unknown_long, offset);\r\nreturn offset;\r\n}\r\nstatic int dissect_teklink_vtc_sigstatall(tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_unknown_long, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_unknown_long, offset);\r\nreturn offset;\r\n}\r\nstatic int dissect_teklink_vtc_outen(tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\nguint32 sig = tvb_get_ntohl(tvb, offset);\r\nguint32 sigon = tvb_get_ntohl(tvb, offset + 4);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_vtc_dstnames, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_vtc_sigen, offset);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO," %s, %s ",\r\nval_to_str(sig, teklink_vtc_dstnames, "Unknown destination %d"),\r\nsigon ? "VTC_OUT_FORCE_ON" : "VTC_OUT_FORCE_OFF");\r\nreturn offset;\r\n}\r\nstatic int dissect_teklink_vtc_map(tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nguint32 src, dst;\r\nint offset = 0;\r\nsrc = tvb_get_ntohl(tvb, offset);\r\ndst = tvb_get_ntohl(tvb, offset + 4);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_vtc_srcnames, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_vtc_dstnames, offset);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO," %s, %s ",\r\nval_to_str(src, teklink_vtc_srcnames, "Unknown source %d"),\r\nval_to_str(dst, teklink_vtc_dstnames, "Unknown destination %d"));\r\nreturn offset;\r\n}\r\nstatic int dissect_teklink_vtc_clk(tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nguint32 sig, clksource, clkedge, clkmode;\r\nint offset = 0;\r\nsig = tvb_get_ntohl(tvb, offset);\r\nclksource = tvb_get_ntohl(tvb, offset + 4);\r\nclkedge = tvb_get_ntohl(tvb, offset + 8);\r\nclkmode = tvb_get_ntohl(tvb, offset + 12);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_vtc_dstnames, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_vtc_clksource, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_vtc_clkedge, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_vtc_clkmode, offset);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO," %s, %s, %s, %s",\r\nval_to_str(sig, teklink_vtc_dstnames, "Unknown destination %d"),\r\nval_to_str(clksource, teklink_vtc_clksource, "Unknown clocksource %d"),\r\nval_to_str(clkedge, teklink_vtc_clkedge, "Unknown edge setting %d"),\r\nval_to_str(clkmode, teklink_vtc_clkmode, "Unknown mode setting %d"));\r\nreturn offset;\r\n}\r\nstatic int dissect_teklink_vtc_mode(tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nguint32 sig, edge, mode;\r\nint offset = 0;\r\nsig = tvb_get_ntohl(tvb, offset);\r\nedge = tvb_get_ntohl(tvb, offset + 4);\r\nmode = tvb_get_ntohl(tvb, offset + 12);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_vtc_dstnames, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_vtc_edge, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_unknown_long, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_vtc_mode, offset);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO," %s, %s, %s",\r\nval_to_str(sig, teklink_vtc_dstnames, "Unknown destination %d"),\r\nval_to_str(edge, teklink_vtc_edge, "Unknown edge setting %d"),\r\nval_to_str(mode, teklink_vtc_modes, "Unknown mode setting %d"));\r\nreturn offset;\r\n}\r\nstatic int dissect_teklink_vtc_outsetup(tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nguint32 sig, en, pol, feedback;\r\nint offset = 0;\r\nsig = tvb_get_ntohl(tvb, offset);\r\nen = tvb_get_ntohl(tvb, offset + 4);\r\npol = tvb_get_ntohl(tvb, offset + 8);\r\nfeedback = tvb_get_ntohl(tvb, offset + 12);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_vtc_dstnames, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_vtc_sigen, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_vtc_sigpol, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_vtc_sigfeedback, offset);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO," %s, %s, %s, %s",\r\nval_to_str(sig, teklink_vtc_dstnames, "Unknown destination %d"),\r\nval_to_str(pol, teklink_vtc_sigpol, "Unknown signal polarity %d"),\r\nval_to_str(en, teklink_vtc_sigen, "Unknown signal enable %d"),\r\nval_to_str(feedback, teklink_vtc_sigfeedback, "Unknown signal feedback setting %d"));\r\nreturn offset;\r\n}\r\nstatic int dissect_teklink_vtc_res(tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\nguint32 sig = tvb_get_ntohl(tvb, offset);\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_vtc_dstnames, offset);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO," %s",\r\nval_to_str(sig, teklink_vtc_dstnames, "Unknown destination %d"));\r\nreturn offset;\r\n}\r\nstatic int dissect_teklink_vtl_spinbits(tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nint offset = 0;\r\noffset = dissect_rpc_uint32(tvb, tree, hf_teklink_unknown_long, offset);\r\nreturn offset;\r\n}\r\nstatic int dissect_teklink_vtl_zmode(tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, void* data _U_)\r\n{\r\nreturn dissect_rpc_uint32(tvb, tree, hf_teklink_unknown_long, 0);\r\n}\r\nvoid\r\nproto_register_teklink(void)\r\n{\r\nstatic hf_register_info hf_core[] = {\r\n{ &hf_teklink_procedure, {\r\n"Procedure", "teklink.procedure", FT_UINT8, BASE_DEC,\r\nVALS(teklink_proc_vals), 0, NULL, HFILL }},\r\n{ &hf_teklink_unknown_long, {\r\n"Unknown long", "teklink.long", FT_UINT32, BASE_HEX,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_teklink_unknown_string, {\r\n"Unknown String", "teklink.string", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_teklink_cmd, {\r\n"Command", "teklink.command", FT_UINT32, BASE_DEC,\r\nVALS(teklink_cmd_vals), 0, NULL, HFILL }},\r\n{ &hf_teklink_tla_type, {\r\n"TLA Type", "teklink.tla_type", FT_UINT32, BASE_DEC,\r\nVALS(teklink_tla_types), 0, NULL, HFILL }},\r\n{ &hf_teklink_host, {\r\n"Host", "teklink.host", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_teklink_user, {\r\n"User", "teklink.user", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_teklink_location, {\r\n"Location", "teklink.location", FT_STRING, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_teklink_locked, {\r\n"Locked", "teklink.locked", FT_UINT32, BASE_HEX,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_teklink_vtc_dstnames, {\r\n"Destination signal", "teklink.signal.destination", FT_UINT32, BASE_HEX,\r\nVALS(teklink_vtc_dstnames), 0, NULL, HFILL }},\r\n{ &hf_teklink_vtc_srcnames, {\r\n"Source signal", "teklink.signal.source", FT_UINT32, BASE_HEX,\r\nVALS(teklink_vtc_srcnames), 0, NULL, HFILL }},\r\n{ &hf_teklink_vtc_sigen, {\r\n"Signal Enable", "teklink.signal.enable", FT_UINT32, BASE_HEX,\r\nVALS(teklink_vtc_sigen), 0, NULL, HFILL }},\r\n{ &hf_teklink_vtc_sigpol, {\r\n"Signal Polarity", "teklink.signal.polarity", FT_UINT32, BASE_HEX,\r\nVALS(teklink_vtc_sigpol), 0, NULL, HFILL }},\r\n{ &hf_teklink_vtc_clkmode, {\r\n"Clock Mode", "teklink.clock.polarity", FT_UINT32, BASE_HEX,\r\nVALS(teklink_vtc_clkmode), 0, NULL, HFILL }},\r\n{ &hf_teklink_vtc_clkedge, {\r\n"Clock Edge", "teklink.clock.polarity", FT_UINT32, BASE_HEX,\r\nVALS(teklink_vtc_clkedge), 0, NULL, HFILL }},\r\n{ &hf_teklink_vtc_clksource, {\r\n"Clock Source", "teklink.clock.source", FT_UINT32, BASE_HEX,\r\nVALS(teklink_vtc_clksource), 0, NULL, HFILL }},\r\n{ &hf_teklink_vtc_mode, {\r\n"Signal Mode", "teklink.signal.mode", FT_UINT32, BASE_HEX,\r\nVALS(teklink_vtc_modes), 0, NULL, HFILL }},\r\n{ &hf_teklink_vtc_edge, {\r\n"Signal Edge", "teklink.signal.edge", FT_UINT32, BASE_HEX,\r\nVALS(teklink_vtc_edge), 0, NULL, HFILL }},\r\n{ &hf_teklink_vtc_sigfeedback, {\r\n"Signal Feedbmode", "teklink.signal.feedback", FT_UINT32, BASE_HEX,\r\nVALS(teklink_vtc_sigfeedback), 0, NULL, HFILL }}\r\n};\r\nstatic gint *ett[] = {\r\n&ett_teklink\r\n};\r\nproto_teklink = proto_register_protocol("TEKLINK", "TEKLINK", "teklink");\r\nproto_register_field_array(proto_teklink, hf_core, array_length(hf_core));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid\r\nproto_reg_handoff_teklink(void)\r\n{\r\nrpc_init_prog(proto_teklink, PROGRAM_TEKLINK, ett_teklink,\r\nG_N_ELEMENTS(teklink_vers_info), teklink_vers_info);\r\n}
