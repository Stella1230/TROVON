WSLUA_CONSTRUCTOR NSTime_new(lua_State *L) {\r\n#define WSLUA_OPTARG_NSTime_new_SECONDS 1\r\n#define WSLUA_OPTARG_NSTime_new_NSECONDS 2\r\nNSTime nstime = (NSTime)g_malloc(sizeof(nstime_t));\r\nif (!nstime) return 0;\r\nnstime->secs = (time_t) luaL_optinteger(L,WSLUA_OPTARG_NSTime_new_SECONDS,0);\r\nnstime->nsecs = (int) luaL_optinteger(L,WSLUA_OPTARG_NSTime_new_NSECONDS,0);\r\npushNSTime(L,nstime);\r\nWSLUA_RETURN(1);\r\n}\r\nWSLUA_METAMETHOD NSTime__call(lua_State* L) {\r\n#define WSLUA_OPTARG_NSTime__call_SECONDS 1\r\n#define WSLUA_OPTARG_NSTime__call_NSECONDS 2\r\nlua_remove(L,1);\r\nWSLUA_RETURN(NSTime_new(L));\r\n}\r\nWSLUA_METAMETHOD NSTime__tostring(lua_State* L) {\r\nNSTime nstime = checkNSTime(L,1);\r\ngchar *str;\r\nstr = wmem_strdup_printf(NULL, "%ld.%09d", (long)nstime->secs, nstime->nsecs);\r\nlua_pushstring(L, str);\r\nwmem_free(NULL, str);\r\nWSLUA_RETURN(1);\r\n}\r\nWSLUA_METAMETHOD NSTime__add(lua_State* L) {\r\nNSTime time1 = checkNSTime(L,1);\r\nNSTime time2 = checkNSTime(L,2);\r\nNSTime time3 = (NSTime)g_malloc (sizeof (nstime_t));\r\nnstime_sum (time3, time1, time2);\r\npushNSTime (L, time3);\r\nreturn 1;\r\n}\r\nWSLUA_METAMETHOD NSTime__sub(lua_State* L) {\r\nNSTime time1 = checkNSTime(L,1);\r\nNSTime time2 = checkNSTime(L,2);\r\nNSTime time3 = (NSTime)g_malloc (sizeof (nstime_t));\r\nnstime_delta (time3, time1, time2);\r\npushNSTime (L, time3);\r\nreturn 1;\r\n}\r\nWSLUA_METAMETHOD NSTime__unm(lua_State* L) {\r\nNSTime time1 = checkNSTime(L,1);\r\nNSTime time2 = (NSTime)g_malloc (sizeof (nstime_t));\r\nnstime_set_zero (time2);\r\nnstime_subtract (time2, time1);\r\npushNSTime (L, time2);\r\nreturn 1;\r\n}\r\nWSLUA_METAMETHOD NSTime__eq(lua_State* L) {\r\nNSTime time1 = checkNSTime(L,1);\r\nNSTime time2 = checkNSTime(L,2);\r\ngboolean result = FALSE;\r\nif (nstime_cmp(time1, time2) == 0)\r\nresult = TRUE;\r\nlua_pushboolean(L,result);\r\nreturn 1;\r\n}\r\nWSLUA_METAMETHOD NSTime__le(lua_State* L) {\r\nNSTime time1 = checkNSTime(L,1);\r\nNSTime time2 = checkNSTime(L,2);\r\ngboolean result = FALSE;\r\nif (nstime_cmp(time1, time2) <= 0)\r\nresult = TRUE;\r\nlua_pushboolean(L,result);\r\nreturn 1;\r\n}\r\nWSLUA_METAMETHOD NSTime__lt(lua_State* L) {\r\nNSTime time1 = checkNSTime(L,1);\r\nNSTime time2 = checkNSTime(L,2);\r\ngboolean result = FALSE;\r\nif (nstime_cmp(time1, time2) < 0)\r\nresult = TRUE;\r\nlua_pushboolean(L,result);\r\nreturn 1;\r\n}\r\nstatic int NSTime__gc(lua_State* L) {\r\nNSTime nstime = toNSTime(L,1);\r\nif (!nstime) return 0;\r\ng_free (nstime);\r\nreturn 0;\r\n}\r\nint NSTime_register(lua_State* L) {\r\nWSLUA_REGISTER_CLASS(NSTime);\r\nWSLUA_REGISTER_ATTRIBUTES(NSTime);\r\nreturn 0;\r\n}
