guint32\r\ncrc32c_table_lookup (guchar pos)\r\n{\r\nreturn crc32c_table[pos];\r\n}\r\nguint32\r\ncrc32_ccitt_table_lookup (guchar pos)\r\n{\r\nreturn crc32_ccitt_table[pos];\r\n}\r\nguint32\r\ncrc32c_calculate(const void *buf, int len, guint32 crc)\r\n{\r\nconst guint8 *p = (const guint8 *)buf;\r\ncrc = CRC32C_SWAP(crc);\r\nwhile (len-- > 0) {\r\nCRC32C(crc, *p++);\r\n}\r\nreturn CRC32C_SWAP(crc);\r\n}\r\nguint32\r\ncrc32c_calculate_no_swap(const void *buf, int len, guint32 crc)\r\n{\r\nconst guint8 *p = (const guint8 *)buf;\r\nwhile (len-- > 0) {\r\nCRC32C(crc, *p++);\r\n}\r\nreturn crc;\r\n}\r\nguint32\r\ncrc32_ccitt(const guint8 *buf, guint len)\r\n{\r\nreturn (crc32_ccitt_seed(buf, len, CRC32_CCITT_SEED));\r\n}\r\nguint32\r\ncrc32_ccitt_seed(const guint8 *buf, guint len, guint32 seed)\r\n{\r\nguint i;\r\nguint32 crc32 = seed;\r\nfor (i = 0; i < len; i++)\r\nCRC32_ACCUMULATE(crc32, buf[i], crc32_ccitt_table);\r\nreturn ( ~crc32 );\r\n}\r\nguint32\r\ncrc32_mpeg2_seed(const guint8 *buf, guint len, guint32 seed)\r\n{\r\nguint i;\r\nguint32 crc32;\r\ncrc32 = seed;\r\nfor (i = 0; i < len; i++)\r\ncrc32 = (crc32 << 8) ^ crc32_mpeg2_table[((crc32 >> 24) ^ buf[i]) & 0xff];\r\nreturn ( crc32 );\r\n}\r\nguint32\r\ncrc32_0x0AA725CF_seed(const guint8 *buf, guint len, guint32 seed)\r\n{\r\nguint crc32;\r\ncrc32 = (guint)seed;\r\nwhile( len-- != 0 )\r\nCRC32_ACCUMULATE(crc32, *buf++, crc32_0AA725CF_reverse);\r\nreturn (guint32)crc32;\r\n}
