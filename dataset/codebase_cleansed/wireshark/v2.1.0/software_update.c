static const char *get_appcast_update_url(software_update_channel_e chan) {\r\nconst char *chan_name;\r\nconst char *arch = "x86";\r\nif (!update_url_str) {\r\nupdate_url_str = g_string_new("");\r\n}\r\nif (sizeof(arch) != 4) {\r\narch = "x86-64";\r\n}\r\nswitch (chan) {\r\ncase UPDATE_CHANNEL_DEVELOPMENT:\r\nchan_name = "development";\r\nbreak;\r\ndefault:\r\nchan_name = "stable";\r\nbreak;\r\n}\r\ng_string_printf(update_url_str, "https://www.wireshark.org/%s/%u/%s/%s/%s/%s/en-US/%s.xml",\r\nSU_SCHEMA_PREFIX,\r\nSU_SCHEMA_VERSION,\r\nSU_APPLICATION,\r\nVERSION,\r\nSU_OSNAME,\r\narch,\r\nchan_name);\r\nreturn update_url_str->str;\r\n}\r\nvoid\r\nsoftware_update_init(void) {\r\nconst char *update_url = get_appcast_update_url(prefs.gui_update_channel);\r\nwin_sparkle_set_registry_path("Software\\Wireshark\\WinSparkle Settings");\r\nwin_sparkle_set_appcast_url(update_url);\r\nwin_sparkle_set_automatic_check_for_updates(prefs.gui_update_enabled ? 1 : 0);\r\nwin_sparkle_set_update_check_interval(prefs.gui_update_interval);\r\nwin_sparkle_init();\r\n}\r\nvoid\r\nsoftware_update_check(void) {\r\nwin_sparkle_check_update_with_ui();\r\n}\r\nextern void software_update_cleanup(void) {\r\nwin_sparkle_cleanup();\r\n}\r\nvoid\r\nsoftware_update_init(void) {\r\n}\r\nvoid\r\nsoftware_update_check(void) {\r\n}\r\nextern void software_update_cleanup(void) {\r\n}
