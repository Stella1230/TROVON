ETH_HF\r\nETH_ETT\r\nstatic int\r\nucarray_drsuapi_dissect_DsReplicaSyncRequest1Info_nc_dn(tvbuff_t *tvb, int offset, packet_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nstatic guint32 len;\r\nint old_offset;\r\nif(di->conformant_run){\r\nold_offset=offset;\r\noffset=dissect_dcerpc_uint32(tvb, offset, pinfo, NULL, drep, -1, &len);\r\ndi->array_max_count_offset=offset-4;\r\ndi->conformant_run=1;\r\ndi->conformant_eaten=offset-old_offset;\r\nreturn offset;\r\n}\r\nALIGN_TO_2_BYTES;\r\nif (tree && len) {\r\nproto_tree_add_item(tree, hf_drsuapi_DsReplicaSyncRequest1Info_nc_dn, tvb, offset,\r\nlen*2, ENC_UTF_16|ENC_LITTLE_ENDIAN);\r\n}\r\noffset+=2*len;\r\nreturn offset;\r\n}\r\nstatic int\r\ndrsuapi_dissect_a_string(tvbuff_t *tvb, int offset, packet_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep, int hf_index, guint32 param _U_)\r\n{\r\noffset=dissect_ndr_vstring(tvb, offset, pinfo, tree, di, drep, 1, hf_index, FALSE, NULL);\r\nreturn offset;\r\n}\r\nETH_CODE\r\nvoid\r\nproto_register_drsuapi(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_drsuapi_DsReplicaSyncRequest1Info_nc_dn,\r\n{ "nc_dn", "drsuapi.DsReplicaSyncRequest1Info.nc_dn", FT_STRING, BASE_NONE,\r\nNULL, 0,\r\nNULL, HFILL }},\r\nETH_HFARR\r\n};\r\nstatic gint *ett[] = {\r\nETH_ETTARR\r\n};\r\nproto_drsuapi = proto_register_protocol(\r\n"DRSUAPI",\r\n"DRSUAPI", "drsuapi");\r\nproto_register_field_array(proto_drsuapi, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid\r\nproto_reg_handoff_drsuapi(void)\r\n{\r\nETH_HANDOFF\r\n}
