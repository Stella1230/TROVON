static int\r\ndissect_get_reply(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nproto_item* lock_item = NULL;\r\nproto_tree* lock_tree = NULL;\r\nint offset = 0;\r\noffset = dissect_rpc_uint32(tvb, tree,\r\nhf_spray_counter, offset);\r\nlock_item = proto_tree_add_item(tree, hf_spray_clock, tvb,\r\noffset, -1, ENC_NA);\r\nlock_tree = proto_item_add_subtree(lock_item, ett_spray_clock);\r\noffset = dissect_rpc_uint32(tvb, lock_tree,\r\nhf_spray_sec, offset);\r\noffset = dissect_rpc_uint32(tvb, lock_tree,\r\nhf_spray_usec, offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_spray_call(tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree, void* data _U_)\r\n{\r\nreturn dissect_rpc_data(tvb, tree, hf_spray_sprayarr, 0);\r\n}\r\nvoid\r\nproto_register_spray(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_spray_procedure_v1, {\r\n"V1 Procedure", "spray.procedure_v1", FT_UINT32, BASE_DEC,\r\nVALS(spray1_proc_vals), 0, NULL, HFILL }},\r\n{ &hf_spray_sprayarr, {\r\n"Data", "spray.sprayarr", FT_BYTES, BASE_NONE,\r\nNULL, 0, "Sprayarr data", HFILL }},\r\n{ &hf_spray_counter, {\r\n"counter", "spray.counter", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_spray_clock, {\r\n"clock", "spray.clock", FT_NONE, BASE_NONE,\r\nNULL, 0, NULL, HFILL }},\r\n{ &hf_spray_sec, {\r\n"sec", "spray.sec", FT_UINT32, BASE_DEC,\r\nNULL, 0, "Seconds", HFILL }},\r\n{ &hf_spray_usec, {\r\n"usec", "spray.usec", FT_UINT32, BASE_DEC,\r\nNULL, 0, "Microseconds", HFILL }}\r\n};\r\nstatic gint *ett[] = {\r\n&ett_spray,\r\n&ett_spray_clock,\r\n};\r\nproto_spray = proto_register_protocol("SPRAY", "SPRAY", "spray");\r\nproto_register_field_array(proto_spray, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}\r\nvoid\r\nproto_reg_handoff_spray(void)\r\n{\r\nrpc_init_prog(proto_spray, SPRAY_PROGRAM, ett_spray,\r\nG_N_ELEMENTS(spray_vers_info), spray_vers_info);\r\n}
