guint wimax_compact_dlmap_ie_decoder(proto_tree *tree, packet_info *pinfo, tvbuff_t *tvb, guint offset, guint nibble_offset)\r\n{\r\nguint diuc, byte, length = 0;\r\nguint dl_map_type, ul_map_append;\r\nguint dl_map_offset, nibble_length, bit_map_length;\r\nguint nband, band_count, i, allocation_mode;\r\n#ifdef DEBUG\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, NULL, "Compact DL-MAP IEs");\r\n#endif\r\ndl_map_offset = offset;\r\nbyte = tvb_get_guint8(tvb, dl_map_offset);\r\nif(nibble_offset & 1)\r\n{\r\ndl_map_type = ((byte & DL_MAP_TYPE_MASK_1) >> 1);\r\nul_map_append = (byte & UL_MAP_APPEND_MASK_1);\r\n}\r\nelse\r\n{\r\ndl_map_type = ((byte & DL_MAP_TYPE_MASK) >> 5);\r\nul_map_append = (byte & UL_MAP_APPEND_MASK);\r\n}\r\nswitch (dl_map_type)\r\n{\r\ncase COMPACT_DL_MAP_TYPE_NORMAL_SUBCHANNEL:\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_dl_map_type_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_ul_map_append_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\ndl_map_offset++;\r\nnibble_offset = 0;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_dl_map_type, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_ul_map_append, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nnibble_offset = 1;\r\n}\r\nlength = 1;\r\nnibble_length = wimax_compact_dlmap_rcid_ie_decoder(tree, pinfo, tvb, dl_map_offset, nibble_offset);\r\nlength += nibble_length;\r\ndl_map_offset += (nibble_length >> 1);\r\nnibble_offset = (nibble_length & 1);\r\nif(!harq_mode)\r\n{\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_nep_code_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\ndl_map_offset++;\r\nproto_tree_add_item(tree, hf_cdlmap_nsch_code, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_nep_code, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_nsch_code_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\ndl_map_offset++;\r\n}\r\nlength += 2;\r\n}\r\nelse if(harq_mode == 1)\r\n{\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_shortened_diuc_1, tvb, dl_map_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_companded_sc_1, tvb, dl_map_offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_shortened_diuc, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_companded_sc, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\n}\r\ndl_map_offset++;\r\nlength += 2;\r\n}\r\nnibble_length = wimax_compact_dlmap_harq_control_ie_decoder(tree, pinfo, tvb, dl_map_offset, nibble_offset);\r\nlength += nibble_length;\r\ndl_map_offset += ((nibble_offset + nibble_length) >> 1);\r\nnibble_offset = ((nibble_offset + nibble_length) & 1);\r\nnibble_length = wimax_compact_dlmap_cqich_control_ie_decoder(tree, pinfo, tvb, dl_map_offset, nibble_offset);\r\nlength += nibble_length;\r\ndl_map_offset += ((nibble_offset + nibble_length) >> 1);\r\nnibble_offset = ((nibble_offset + nibble_length) & 1);\r\nif(ul_map_append)\r\n{\r\nif(harq_mode == 1)\r\n{\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_shortened_uiuc_1, tvb, dl_map_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_companded_sc_1, tvb, dl_map_offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_shortened_uiuc, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_companded_sc, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\n}\r\ndl_map_offset++;\r\nlength += 2;\r\n}\r\nelse if(!harq_mode)\r\n{\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_nep_code_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\ndl_map_offset++;\r\nproto_tree_add_item(tree, hf_cdlmap_nsch_code, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_nep_code, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_nsch_code_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\ndl_map_offset++;\r\n}\r\nlength += 2;\r\n}\r\nnibble_length = wimax_compact_dlmap_harq_control_ie_decoder(tree, pinfo, tvb, dl_map_offset, nibble_offset);\r\nlength += nibble_length;\r\n}\r\nbreak;\r\ncase COMPACT_DL_MAP_TYPE_BAND_AMC:\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_dl_map_type_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_reserved_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\ndl_map_offset++;\r\nnibble_offset = 0;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_dl_map_type, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_reserved, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nnibble_offset = 1;\r\n}\r\nlength = 1;\r\nnibble_length = wimax_compact_dlmap_rcid_ie_decoder(tree, pinfo, tvb, dl_map_offset, nibble_offset);\r\nlength += nibble_length;\r\ndl_map_offset += (nibble_length >> 1);\r\nnibble_offset = (nibble_length & 1);\r\nif(!harq_mode)\r\n{\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_nep_code_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\ndl_map_offset++;\r\nproto_tree_add_item(tree, hf_cdlmap_nsch_code, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_nep_code, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_nsch_code_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\ndl_map_offset++;\r\n}\r\nlength += 2;\r\n}\r\nelse if(harq_mode == 1)\r\n{\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_shortened_diuc_1, tvb, dl_map_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_companded_sc_1, tvb, dl_map_offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_shortened_diuc, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_companded_sc, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\n}\r\ndl_map_offset++;\r\nlength += 2;\r\n}\r\nif(max_logical_bands)\r\n{\r\nnband = tvb_get_guint8(tvb, dl_map_offset);\r\nif(nibble_offset & 1)\r\n{\r\nnband = (nband & LSB_NIBBLE_MASK);\r\nproto_tree_add_item(tree, hf_cdlmap_num_bands_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\ndl_map_offset++;\r\nnibble_offset = 0;\r\nif(max_logical_bands == 3)\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_band_index, tvb, dl_map_offset, nband, ENC_NA);\r\nlength += (nband * 2);\r\ndl_map_offset += nband;\r\n}\r\nelse\r\n{\r\nnibble_offset = (nband & 1);\r\nproto_tree_add_item(tree, hf_cdlmap_band_index, tvb, dl_map_offset, ((nband >> 1) + nibble_offset), ENC_NA);\r\nlength += nband;\r\ndl_map_offset += (nband >> 1);\r\n}\r\n}\r\nelse\r\n{\r\nnband = ((nband & MSB_NIBBLE_MASK) >> 4);\r\nproto_tree_add_item(tree, hf_cdlmap_num_bands, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nnibble_offset = 1;\r\nif(max_logical_bands == 3)\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_band_index, tvb, dl_map_offset, (nband + nibble_offset), ENC_NA);\r\nlength += (nband * 2);\r\ndl_map_offset += nband;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_band_index, tvb, dl_map_offset, ((nband >> 1) + nibble_offset), ENC_NA);\r\nlength += nband;\r\ndl_map_offset += ((nband + nibble_offset) >> 1);\r\nif(nband & 1)\r\nnibble_offset = 0;\r\n}\r\n}\r\nlength++;\r\nband_count = nband;\r\n}\r\nelse\r\n{\r\nband_count = 1;\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_nb_bitmap_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\ndl_map_offset++;\r\nnibble_offset = 0;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_nb_bitmap, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nnibble_offset = 1;\r\n}\r\nlength++;\r\n}\r\nbyte = tvb_get_guint8(tvb, dl_map_offset);\r\nif(nibble_offset & 1)\r\n{\r\nallocation_mode = ((byte & 0x0C) >> 2);\r\nproto_tree_add_item(tree, hf_cdlmap_allocation_mode_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_allocation_mode_rsvd_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nnibble_offset = 0;\r\ndl_map_offset++;\r\n}\r\nelse\r\n{\r\nallocation_mode = ((byte & 0xC0) >> 6);\r\nproto_tree_add_item(tree, hf_cdlmap_allocation_mode, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_allocation_mode_rsvd, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nnibble_offset = 1;\r\n}\r\nif(!allocation_mode)\r\n{\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_num_subchannels_1, tvb, dl_map_offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_num_subchannels, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\n}\r\ndl_map_offset++;\r\n}\r\nelse if(allocation_mode == 1)\r\n{\r\nfor(i=0; i<band_count; i++)\r\n{\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_num_subchannels_1, tvb, dl_map_offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_num_subchannels, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\n}\r\ndl_map_offset++;\r\n}\r\n}\r\nnibble_length = wimax_compact_dlmap_harq_control_ie_decoder(tree, pinfo, tvb, dl_map_offset, nibble_offset);\r\nlength += nibble_length;\r\ndl_map_offset += ((nibble_offset + nibble_length) >> 1);\r\nnibble_offset = ((nibble_offset + nibble_length) & 1);\r\nnibble_length = wimax_compact_dlmap_cqich_control_ie_decoder(tree, pinfo, tvb, dl_map_offset, nibble_offset);\r\nlength += nibble_length;\r\nbreak;\r\ncase COMPACT_DL_MAP_TYPE_SAFETY:\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_dl_map_type_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_ul_map_append_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\ndl_map_offset++;\r\nnibble_offset = 0;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_dl_map_type, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_ul_map_append, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nnibble_offset = 1;\r\n}\r\nlength = 1;\r\nnibble_length = wimax_compact_dlmap_rcid_ie_decoder(tree, pinfo, tvb, dl_map_offset, nibble_offset);\r\nlength += nibble_length;\r\ndl_map_offset += (nibble_length >> 1);\r\nnibble_offset = (nibble_length & 1);\r\nif(!harq_mode)\r\n{\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_nep_code_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\ndl_map_offset++;\r\nproto_tree_add_item(tree, hf_cdlmap_nsch_code, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_nep_code, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_nsch_code_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\ndl_map_offset++;\r\n}\r\nlength += 2;\r\n}\r\nelse if(harq_mode == 1)\r\n{\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_shortened_diuc_1, tvb, dl_map_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_companded_sc_1, tvb, dl_map_offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_shortened_diuc, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_companded_sc, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\n}\r\ndl_map_offset++;\r\nlength += 2;\r\n}\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_bin_offset_1, tvb, dl_map_offset, 2, ENC_BIG_ENDIAN);\r\ndl_map_offset++;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_bin_offset, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\ndl_map_offset++;\r\n}\r\nlength += 2;\r\nnibble_length = wimax_compact_dlmap_harq_control_ie_decoder(tree, pinfo, tvb, dl_map_offset, nibble_offset);\r\nlength += nibble_length;\r\ndl_map_offset += ((nibble_offset + nibble_length) >> 1);\r\nnibble_offset = ((nibble_offset + nibble_length) & 1);\r\nnibble_length = wimax_compact_dlmap_cqich_control_ie_decoder(tree, pinfo, tvb, dl_map_offset, nibble_offset);\r\nlength += nibble_length;\r\ndl_map_offset += ((nibble_offset + nibble_length) >> 1);\r\nnibble_offset = ((nibble_offset + nibble_length) & 1);\r\nif(ul_map_append)\r\n{\r\nif(harq_mode == 1)\r\n{\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_shortened_diuc_1, tvb, dl_map_offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_companded_sc_1, tvb, dl_map_offset, 2, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_shortened_diuc, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_companded_sc, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\n}\r\ndl_map_offset++;\r\nlength += 2;\r\n}\r\nelse if(!harq_mode)\r\n{\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_nep_code_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\ndl_map_offset++;\r\nproto_tree_add_item(tree, hf_cdlmap_nsch_code, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_nep_code, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_nsch_code_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\ndl_map_offset++;\r\n}\r\nlength += 2;\r\n}\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_bin_offset_1, tvb, dl_map_offset, 2, ENC_BIG_ENDIAN);\r\ndl_map_offset++;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_bin_offset, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\ndl_map_offset++;\r\n}\r\nlength += 2;\r\nnibble_length = wimax_compact_dlmap_harq_control_ie_decoder(tree, pinfo, tvb, dl_map_offset, nibble_offset);\r\nlength += nibble_length;\r\n}\r\nbreak;\r\ncase COMPACT_DL_MAP_TYPE_UIUC:\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_dl_map_type_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_reserved_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\ndl_map_offset++;\r\nbyte = tvb_get_guint8(tvb, dl_map_offset);\r\ndiuc = ((byte & MSB_NIBBLE_MASK) >> 4);\r\nproto_tree_add_item(tree, hf_cdlmap_diuc, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_dl_map_type, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_reserved, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\ndiuc = (tvb_get_guint8(tvb, dl_map_offset) & LSB_NIBBLE_MASK);\r\nproto_tree_add_item(tree, hf_cdlmap_diuc_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\ndl_map_offset++;\r\n}\r\nlength = 2;\r\nif(diuc == 15)\r\n{\r\nnibble_length = wimax_extended_diuc_dependent_ie_decoder(tree, pinfo, tvb, dl_map_offset, nibble_offset);\r\nlength += nibble_length;\r\ndl_map_offset += (nibble_length >> 1);\r\nnibble_offset = (nibble_length & 1);\r\n}\r\nelse\r\n{\r\nnibble_length = wimax_compact_dlmap_rcid_ie_decoder(tree, pinfo, tvb, dl_map_offset, nibble_offset);\r\nlength += nibble_length;\r\ndl_map_offset += (nibble_length >> 1);\r\nnibble_offset = (nibble_length & 1);\r\nif(nibble_offset & 1)\r\nproto_tree_add_item(tree, hf_cdlmap_diuc_num_of_subchannels_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nelse\r\nproto_tree_add_item(tree, hf_cdlmap_diuc_num_of_subchannels, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nlength += 2;\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_diuc_repetition_coding_indication_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_diuc_reserved_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_diuc_repetition_coding_indication, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_diuc_reserved, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\n}\r\nlength += 1;\r\n}\r\nnibble_length = wimax_compact_dlmap_harq_control_ie_decoder(tree, pinfo, tvb, dl_map_offset, nibble_offset);\r\nlength += nibble_length;\r\ndl_map_offset += ((nibble_offset + nibble_length) >> 1);\r\nnibble_offset = ((nibble_offset + nibble_length) & 1);\r\nnibble_length = wimax_compact_dlmap_cqich_control_ie_decoder(tree, pinfo, tvb, dl_map_offset, nibble_offset);\r\nlength += nibble_length;\r\nbreak;\r\ncase COMPACT_DL_MAP_TYPE_FORMAT_CONF_IE:\r\nnibble_length = wimax_compact_dlmap_format_configuration_ie_decoder(tree, pinfo, tvb, dl_map_offset, nibble_offset);\r\nlength = nibble_length;\r\nbreak;\r\ncase COMPACT_DL_MAP_TYPE_HARQ_ACK_BITMAP_IE:\r\nif(nibble_offset & 1)\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_dl_map_type_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_reserved_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nlength = 1;\r\ndl_map_offset++;\r\nbyte = tvb_get_guint8(tvb, dl_map_offset);\r\nbit_map_length = ((byte & MSB_NIBBLE_MASK) >> 4);\r\nproto_tree_add_item(tree, hf_cdlmap_bit_map_length, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_bit_map, tvb, dl_map_offset, bit_map_length + 1, ENC_NA);\r\nlength += (1 + bit_map_length * 2);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_cdlmap_dl_map_type, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_reserved, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_bit_map_length_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nlength = 2;\r\nbit_map_length = (byte & LSB_NIBBLE_MASK);\r\ndl_map_offset++;\r\nproto_tree_add_item(tree, hf_cdlmap_bit_map, tvb, dl_map_offset, bit_map_length, ENC_NA);\r\nlength += (bit_map_length * 2);\r\n}\r\nbreak;\r\ncase COMPACT_DL_MAP_TYPE_EXTENSION:\r\nnibble_length = wimax_cdlmap_extension_ie_decoder(tree, pinfo, tvb, dl_map_offset, nibble_offset);\r\nlength = nibble_length;\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(tree, hf_cdlmap_reserved_type_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nlength = 1;\r\nbreak;\r\n}\r\nreturn length;\r\n}\r\nstatic guint wimax_compact_dlmap_format_configuration_ie_decoder(proto_tree *tree, packet_info *pinfo _U_, tvbuff_t *tvb, guint offset, guint nibble_offset)\r\n{\r\nguint length = 0;\r\nguint dl_map_type, new_format_ind;\r\nguint dl_map_offset;\r\nguint32 tvb_value;\r\n#ifdef DEBUG\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, NULL, "Format Configuration IE");\r\n#endif\r\ndl_map_offset = offset;\r\ntvb_value = tvb_get_guint8(tvb, dl_map_offset);\r\nif(nibble_offset & 1)\r\n{\r\ndl_map_type = ((tvb_value & DL_MAP_TYPE_MASK_1) >> 1);\r\nif(dl_map_type != COMPACT_DL_MAP_TYPE_FORMAT_CONF_IE)\r\nreturn 0;\r\nnew_format_ind = (tvb_value & 0x01);\r\nproto_tree_add_item(tree, hf_format_config_ie_dl_map_type_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_format_config_ie_new_format_indication_1, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nlength = 1;\r\ndl_map_offset++;\r\nif(new_format_ind)\r\n{\r\nproto_tree_add_item(tree, hf_format_config_ie_cid_type, tvb, dl_map_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_format_config_ie_safety_pattern, tvb, dl_map_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_format_config_ie_subchannel_type, tvb, dl_map_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_format_config_ie_max_logical_bands, tvb, dl_map_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_format_config_ie_num_of_broadcast_symbol, tvb, dl_map_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_format_config_ie_num_of_dl_band_amc_symbol, tvb, dl_map_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_format_config_ie_num_of_ul_band_amc_symbol, tvb, dl_map_offset, 4, ENC_BIG_ENDIAN);\r\nlength += 7;\r\ntvb_value = tvb_get_ntohl(tvb, dl_map_offset);\r\ncid_type = ((tvb_value & CID_TYPE_MASK) >> CID_TYPE_SHIFT);\r\nband_amc_subchannel_type = ((tvb_value & BAND_AMC_SUBCHANNEL_TYPE_MASK) >> BAND_AMC_SUBCHANNEL_TYPE_SHIFT);\r\nmax_logical_bands = ((tvb_value & MAX_LOGICAL_BANDS_MASK) >> MAX_LOGICAL_BANDS_SHIFT);\r\nnum_of_broadcast_symbols = ((tvb_value & NUM_BROADCAST_SYMBOLS_MASK) >> NUM_BROADCAST_SYMBOLS_SHIFT);\r\nnum_of_dl_band_amc_symbols = ((tvb_value & NUM_DL_AMC_SYMBOLS_MASK) >> NUM_DL_AMC_SYMBOLS_SHIFT);\r\nnum_of_ul_band_amc_symbols = ((tvb_value & NUM_UL_AMC_SYMBOLS_MASK) >> NUM_UL_AMC_SYMBOLS_SHIFT);\r\n}\r\n}\r\nelse\r\n{\r\ndl_map_type = ((tvb_value & DL_MAP_TYPE_MASK) >> 5);\r\nif(dl_map_type != COMPACT_DL_MAP_TYPE_FORMAT_CONF_IE)\r\nreturn 0;\r\nnew_format_ind = (tvb_value & 0x10);\r\nif(new_format_ind)\r\n{\r\nproto_tree_add_item(tree, hf_format_config_ie_dl_map_type_32, tvb, dl_map_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_format_config_ie_new_format_indication_32, tvb, dl_map_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_format_config_ie_cid_type_1, tvb, dl_map_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_format_config_ie_safety_pattern_1, tvb, dl_map_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_format_config_ie_subchannel_type_1, tvb, dl_map_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_format_config_ie_max_logical_bands_1, tvb, dl_map_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_format_config_ie_num_of_broadcast_symbol_1, tvb, dl_map_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_format_config_ie_num_of_dl_band_amc_symbol_1, tvb, dl_map_offset, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_format_config_ie_num_of_ul_band_amc_symbol_1, tvb, dl_map_offset, 4, ENC_BIG_ENDIAN);\r\nlength = 8;\r\ntvb_value = tvb_get_ntohl(tvb, dl_map_offset);\r\ncid_type = ((tvb_value & CID_TYPE_MASK_1) >> CID_TYPE_SHIFT_1);\r\nband_amc_subchannel_type = ((tvb_value & BAND_AMC_SUBCHANNEL_TYPE_MASK_1) >> BAND_AMC_SUBCHANNEL_TYPE_SHIFT_1);\r\nmax_logical_bands = ((tvb_value & MAX_LOGICAL_BANDS_MASK_1) >> MAX_LOGICAL_BANDS_SHIFT_1);\r\nnum_of_broadcast_symbols = ((tvb_value & NUM_BROADCAST_SYMBOLS_MASK_1) >> NUM_BROADCAST_SYMBOLS_SHIFT_1);\r\nnum_of_dl_band_amc_symbols = ((tvb_value & NUM_DL_AMC_SYMBOLS_MASK_1) >> NUM_DL_AMC_SYMBOLS_SHIFT_1);\r\nnum_of_ul_band_amc_symbols = (tvb_value & NUM_UL_AMC_SYMBOLS_MASK_1);\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_format_config_ie_dl_map_type, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_format_config_ie_new_format_indication, tvb, dl_map_offset, 1, ENC_BIG_ENDIAN);\r\nlength = 1;\r\n}\r\n}\r\nreturn length;\r\n}\r\nstatic guint wimax_compact_dlmap_rcid_ie_decoder(proto_tree *tree, packet_info *pinfo _U_, tvbuff_t *tvb, guint offset, guint nibble_offset)\r\n{\r\nguint length = 0;\r\nguint prefix;\r\n#ifdef DEBUG\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, NULL, "RCID IE");\r\n#endif\r\nif(nibble_offset & 1)\r\n{\r\nif(cid_type == CID_TYPE_NORMAL)\r\n{\r\nproto_tree_add_item(tree, hf_harq_rcid_ie_normal_cid_1, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nlength = 4;\r\n}\r\nelse\r\n{\r\nprefix = (tvb_get_guint8(tvb, offset) & 0x08);\r\nproto_tree_add_item(tree, hf_harq_rcid_ie_prefix_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nif(prefix)\r\n{\r\nproto_tree_add_item(tree, hf_harq_rcid_ie_cid11_3, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nlength = 3;\r\n}\r\nelse\r\n{\r\nif(cid_type == CID_TYPE_RCID11)\r\n{\r\nproto_tree_add_item(tree, hf_harq_rcid_ie_cid11_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nlength = 3;\r\n}\r\nelse if(cid_type == CID_TYPE_RCID7)\r\n{\r\nproto_tree_add_item(tree, hf_harq_rcid_ie_cid7_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nlength = 2;\r\n}\r\nelse if(cid_type == CID_TYPE_RCID3)\r\n{\r\nproto_tree_add_item(tree, hf_harq_rcid_ie_cid3_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nlength = 1;\r\n}\r\n}\r\n}\r\n}\r\nelse\r\n{\r\nif(cid_type == CID_TYPE_NORMAL)\r\n{\r\nproto_tree_add_item(tree, hf_harq_rcid_ie_normal_cid, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nlength = 4;\r\n}\r\nelse\r\n{\r\nprefix = (tvb_get_guint8(tvb, offset) & 0x08);\r\nproto_tree_add_item(tree, hf_harq_rcid_ie_prefix, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nif(prefix || (cid_type == CID_TYPE_RCID11))\r\n{\r\nproto_tree_add_item(tree, hf_harq_rcid_ie_cid11_2, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nlength = 3;\r\n}\r\nelse\r\n{\r\nif(cid_type == CID_TYPE_RCID11)\r\n{\r\nproto_tree_add_item(tree, hf_harq_rcid_ie_cid11, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nlength = 3;\r\n}\r\nelse if(cid_type == CID_TYPE_RCID7)\r\n{\r\nproto_tree_add_item(tree, hf_harq_rcid_ie_cid7, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nlength = 2;\r\n}\r\nelse if(cid_type == CID_TYPE_RCID3)\r\n{\r\nproto_tree_add_item(tree, hf_harq_rcid_ie_cid3, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nlength = 1;\r\n}\r\n}\r\n}\r\n}\r\nreturn length;\r\n}\r\nstatic guint wimax_compact_dlmap_harq_control_ie_decoder(proto_tree *tree, packet_info *pinfo _U_, tvbuff_t *tvb, guint offset, guint nibble_offset)\r\n{\r\nguint byte, prefix, length = 0;\r\n#ifdef DEBUG\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, NULL, "HARQ Control IE");\r\n#endif\r\nbyte = tvb_get_guint8(tvb, offset);\r\nif(nibble_offset & 1)\r\n{\r\nprefix = (byte & 0x08);\r\nproto_tree_add_item(tree, hf_harq_control_ie_prefix_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nif(prefix)\r\n{\r\nproto_tree_add_item(tree, hf_harq_control_ie_ai_sn_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_harq_control_ie_spid_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_harq_control_ie_acid_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nlength = 2;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_harq_control_ie_reserved_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nlength = 1;\r\n}\r\n}\r\nelse\r\n{\r\nprefix = (byte & 0x80);\r\nproto_tree_add_item(tree, hf_harq_control_ie_prefix, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nif(prefix)\r\n{\r\nproto_tree_add_item(tree, hf_harq_control_ie_ai_sn, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_harq_control_ie_spid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_harq_control_ie_acid, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nlength = 2;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_harq_control_ie_reserved, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nlength = 1;\r\n}\r\n}\r\nreturn length;\r\n}\r\nstatic guint wimax_compact_dlmap_cqich_control_ie_decoder(proto_tree *tree, packet_info *pinfo _U_, tvbuff_t *tvb, guint offset, guint nibble_offset)\r\n{\r\nguint byte, cqich_indicator, length = 0;\r\n#ifdef DEBUG\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, NULL, "CQICH Control IE");\r\n#endif\r\nbyte = tvb_get_guint8(tvb, offset);\r\nif(nibble_offset & 1)\r\n{\r\ncqich_indicator = (byte & 0x08);\r\nif(cqich_indicator)\r\n{\r\nproto_tree_add_item(tree, hf_cqich_control_ie_indicator_1, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cqich_control_ie_alloc_id_1, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cqich_control_ie_period_1, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cqich_control_ie_frame_offset_1, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cqich_control_ie_duration_1, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nlength = 4;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_cqich_control_ie_indicator_1, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cqich_control_ie_cqi_rep_threshold_1, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nlength = 1;\r\n}\r\n}\r\nelse\r\n{\r\ncqich_indicator = (byte & 0x80);\r\nif(cqich_indicator)\r\n{\r\nproto_tree_add_item(tree, hf_cqich_control_ie_indicator, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cqich_control_ie_alloc_id, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cqich_control_ie_period, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cqich_control_ie_frame_offset, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cqich_control_ie_duration, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nlength = 4;\r\n}\r\nelse\r\n{\r\nproto_tree_add_item(tree, hf_cqich_control_ie_indicator, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cqich_control_ie_cqi_rep_threshold, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nlength = 1;\r\n}\r\n}\r\nreturn length;\r\n}\r\nstatic guint wimax_cdlmap_extension_ie_decoder(proto_tree *tree, packet_info *pinfo _U_, tvbuff_t *tvb, guint offset, guint nibble_offset)\r\n{\r\nguint tvb_value, dl_map_type, sub_type, length;\r\n#ifdef DEBUG\r\ncol_append_sep_str(pinfo->cinfo, COL_INFO, NULL, "DL-MAP Extension IE");\r\n#endif\r\ntvb_value = tvb_get_ntohs(tvb, offset);\r\nif(nibble_offset & 1)\r\n{\r\ndl_map_type = ((tvb_value & 0x0E00) >> 9);\r\nif(dl_map_type != COMPACT_DL_MAP_TYPE_EXTENSION)\r\nreturn 0;\r\nsub_type = ((tvb_value & 0x01F0) >> 4);\r\nlength = (tvb_value & 0x000F);\r\nproto_tree_add_item(tree, hf_cdlmap_extension_type_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_extension_subtype_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_extension_length_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset += 2;\r\nswitch (sub_type)\r\n{\r\ncase TIME_DIVERSITY_MBS:\r\nproto_tree_add_item(tree, hf_cdlmap_extension_time_diversity_mbs_1, tvb, offset, (length - 2), ENC_NA);\r\nbreak;\r\ncase HARQ_MODE_SWITCH:\r\nproto_tree_add_item(tree, hf_cdlmap_extension_harq_mode, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ntvb_value = tvb_get_guint8(tvb, offset);\r\nharq_mode = ((tvb_value & MSB_NIBBLE_MASK) >> 4);\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(tree, hf_cdlmap_extension_unknown_sub_type_1, tvb, offset, (length - 2), ENC_NA);\r\nbreak;\r\n}\r\n}\r\nelse\r\n{\r\ndl_map_type = ((tvb_value & 0xE000) >> 13);\r\nif(dl_map_type != COMPACT_DL_MAP_TYPE_EXTENSION)\r\nreturn 0;\r\nsub_type = ((tvb_value & 0x1F00) >> 8);\r\nlength = ((tvb_value & 0x00F0) >> 4);\r\nproto_tree_add_item(tree, hf_cdlmap_extension_type, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_extension_subtype, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_cdlmap_extension_length, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nswitch (sub_type)\r\n{\r\ncase TIME_DIVERSITY_MBS:\r\nproto_tree_add_item(tree, hf_cdlmap_extension_time_diversity_mbs, tvb, (offset + 1), (length - 1), ENC_NA);\r\nbreak;\r\ncase HARQ_MODE_SWITCH:\r\nproto_tree_add_item(tree, hf_cdlmap_extension_harq_mode_1, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nharq_mode = (tvb_value & 0x000F);\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(tree, hf_cdlmap_extension_unknown_sub_type, tvb, (offset + 1), (length - 1), ENC_NA);\r\nbreak;\r\n}\r\n}\r\nreturn (length * 2);\r\n}\r\nguint wimax_extended_diuc_dependent_ie_decoder(proto_tree *tree, packet_info *pinfo _U_, tvbuff_t *tvb, guint offset, guint nibble_offset)\r\n{\r\nguint ext_diuc, length;\r\nguint8 byte;\r\nbyte = tvb_get_guint8(tvb, offset);\r\nif(nibble_offset & 1)\r\n{\r\next_diuc = (byte & LSB_NIBBLE_MASK);\r\nproto_tree_add_item(tree, hf_extended_diuc_dependent_ie_diuc_1, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nbyte = tvb_get_guint8(tvb, offset);\r\nlength = ((byte & MSB_NIBBLE_MASK) >> 4);\r\nproto_tree_add_item(tree, hf_extended_diuc_dependent_ie_length, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nswitch (ext_diuc)\r\n{\r\ncase CHANNEL_MEASUREMENT_IE:\r\nproto_tree_add_item(tree, hf_extended_diuc_dependent_ie_channel_measurement, tvb, offset, (length + 1), ENC_NA);\r\nbreak;\r\ncase STC_ZONE_IE:\r\nproto_tree_add_item(tree, hf_extended_diuc_dependent_ie_stc_zone, tvb, offset, (length + 1), ENC_NA);\r\nbreak;\r\ncase AAS_DL_IE:\r\nproto_tree_add_item(tree, hf_extended_diuc_dependent_ie_aas_dl, tvb, offset, (length + 1), ENC_NA);\r\nbreak;\r\ncase DATA_LOCATION_IN_ANOTHER_BS_IE:\r\nproto_tree_add_item(tree, hf_extended_diuc_dependent_ie_data_location, tvb, offset, (length + 1), ENC_NA);\r\nbreak;\r\ncase CID_SWITCH_IE:\r\nproto_tree_add_item(tree, hf_extended_diuc_dependent_ie_cid_switch, tvb, offset, (length + 1), ENC_NA);\r\nbreak;\r\ncase MIMO_DL_BASIC_IE:\r\nproto_tree_add_item(tree, hf_extended_diuc_dependent_ie_mimo_dl_basic, tvb, offset, (length + 1), ENC_NA);\r\nbreak;\r\ncase MIMO_DL_ENHANCED_IE:\r\nproto_tree_add_item(tree, hf_extended_diuc_dependent_ie_mimo_dl_enhanced, tvb, offset, (length + 1), ENC_NA);\r\nbreak;\r\ncase HARQ_MAP_POINTER_IE:\r\nproto_tree_add_item(tree, hf_extended_diuc_dependent_ie_harq_map_pointer, tvb, offset, (length + 1), ENC_NA);\r\nbreak;\r\ncase PHYMOD_DL_IE:\r\nproto_tree_add_item(tree, hf_extended_diuc_dependent_ie_phymod_dl, tvb, offset, (length + 1), ENC_NA);\r\nbreak;\r\ncase DL_PUSC_BURST_ALLOCATION_IN_OTHER_SEGMENT_IE:\r\nproto_tree_add_item(tree, hf_extended_diuc_dependent_ie_dl_pusc_burst_allocation, tvb, offset, (length + 1), ENC_NA);\r\nbreak;\r\ncase UL_INTERFERENCE_AND_NOISE_LEVEL_IE:\r\nproto_tree_add_item(tree, hf_extended_diuc_dependent_ie_ul_interference_and_noise_level, tvb, offset, (length + 1), ENC_NA);\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(tree, hf_extended_diuc_dependent_ie_unknown_diuc, tvb, offset, (length + 1), ENC_NA);\r\nbreak;\r\n}\r\n}\r\nelse\r\n{\r\next_diuc = ((byte & MSB_NIBBLE_MASK) >> 4);\r\nlength = (byte & LSB_NIBBLE_MASK);\r\nproto_tree_add_item(tree, hf_extended_diuc_dependent_ie_diuc, tvb, offset, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item(tree, hf_extended_diuc_dependent_ie_length_1, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nswitch (ext_diuc)\r\n{\r\ncase CHANNEL_MEASUREMENT_IE:\r\nproto_tree_add_item(tree, hf_extended_diuc_dependent_ie_channel_measurement, tvb, offset, length, ENC_NA);\r\nbreak;\r\ncase STC_ZONE_IE:\r\nproto_tree_add_item(tree, hf_extended_diuc_dependent_ie_stc_zone, tvb, offset, length, ENC_NA);\r\nbreak;\r\ncase AAS_DL_IE:\r\nproto_tree_add_item(tree, hf_extended_diuc_dependent_ie_aas_dl, tvb, offset, length, ENC_NA);\r\nbreak;\r\ncase DATA_LOCATION_IN_ANOTHER_BS_IE:\r\nproto_tree_add_item(tree, hf_extended_diuc_dependent_ie_data_location, tvb, offset, length, ENC_NA);\r\nbreak;\r\ncase CID_SWITCH_IE:\r\nproto_tree_add_item(tree, hf_extended_diuc_dependent_ie_cid_switch, tvb, offset, length, ENC_NA);\r\nbreak;\r\ncase MIMO_DL_BASIC_IE:\r\nproto_tree_add_item(tree, hf_extended_diuc_dependent_ie_mimo_dl_basic, tvb, offset, length, ENC_NA);\r\nbreak;\r\ncase MIMO_DL_ENHANCED_IE:\r\nproto_tree_add_item(tree, hf_extended_diuc_dependent_ie_mimo_dl_enhanced, tvb, offset, length, ENC_NA);\r\nbreak;\r\ncase HARQ_MAP_POINTER_IE:\r\nproto_tree_add_item(tree, hf_extended_diuc_dependent_ie_harq_map_pointer, tvb, offset, length, ENC_NA);\r\nbreak;\r\ncase PHYMOD_DL_IE:\r\nproto_tree_add_item(tree, hf_extended_diuc_dependent_ie_phymod_dl, tvb, offset, length, ENC_NA);\r\nbreak;\r\ncase DL_PUSC_BURST_ALLOCATION_IN_OTHER_SEGMENT_IE:\r\nproto_tree_add_item(tree, hf_extended_diuc_dependent_ie_dl_pusc_burst_allocation, tvb, offset, length, ENC_NA);\r\nbreak;\r\ncase UL_INTERFERENCE_AND_NOISE_LEVEL_IE:\r\nproto_tree_add_item(tree, hf_extended_diuc_dependent_ie_ul_interference_and_noise_level, tvb, offset, length, ENC_NA);\r\nbreak;\r\ndefault:\r\nproto_tree_add_item(tree, hf_extended_diuc_dependent_ie_unknown_diuc, tvb, offset, length, ENC_NA);\r\nbreak;\r\n}\r\n}\r\nreturn ((length + 1) * 2 );\r\n}\r\nvoid proto_register_wimax_compact_dlmap_ie(void)\r\n{\r\nstatic hf_register_info hf_compact_dlmap[] =\r\n{\r\n{\r\n&hf_cdlmap_dl_map_type,\r\n{"DL-MAP Type", "wmx.compact_dlmap.dl_map_type", FT_UINT8, BASE_DEC, NULL, DL_MAP_TYPE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_dl_map_type_1,\r\n{"DL-MAP Type", "wmx.compact_dlmap.dl_map_type", FT_UINT8, BASE_DEC, NULL, DL_MAP_TYPE_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_ul_map_append,\r\n{"UL-MAP Append", "wmx.compact_dlmap.ul_map_append", FT_UINT8, BASE_HEX, NULL, UL_MAP_APPEND_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_ul_map_append_1,\r\n{"UL-MAP Append", "wmx.compact_dlmap.ul_map_append", FT_UINT8, BASE_HEX, NULL, UL_MAP_APPEND_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_reserved,\r\n{"Reserved", "wmx.compact_dlmap.reserved", FT_UINT8, BASE_HEX, NULL, UL_MAP_APPEND_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_reserved_1,\r\n{"Reserved", "wmx.compact_dlmap.reserved", FT_UINT8, BASE_HEX, NULL, UL_MAP_APPEND_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_nep_code,\r\n{"Nep Code", "wmx.compact_dlmap.nep_code", FT_UINT8, BASE_HEX, NULL, MSB_NIBBLE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_nep_code_1,\r\n{"Nep Code", "wmx.compact_dlmap.nep_code", FT_UINT8, BASE_HEX, NULL, LSB_NIBBLE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_nsch_code,\r\n{"Nsch Code", "wmx.compact_dlmap.nsch_code", FT_UINT8, BASE_HEX, NULL, MSB_NIBBLE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_nsch_code_1,\r\n{"Nsch Code", "wmx.compact_dlmap.nsch_code", FT_UINT8, BASE_HEX, NULL, LSB_NIBBLE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_num_bands,\r\n{"Number Of Bands", "wmx.compact_dlmap.num_bands", FT_UINT8, BASE_HEX, NULL, MSB_NIBBLE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_num_bands_1,\r\n{"Number Of Bands", "wmx.compact_dlmap.num_bands", FT_UINT8, BASE_HEX, NULL, LSB_NIBBLE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_band_index,\r\n{"Band Index", "wmx.compact_dlmap.band_index", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n#if 0\r\n{\r\n&hf_cdlmap_band_index_1,\r\n{"Band Index", "wmx.compact_dlmap.band_index", FT_BYTES, BASE_HEX, NULL, 0x0, "", HFILL}\r\n},\r\n#endif\r\n{\r\n&hf_cdlmap_nb_bitmap,\r\n{"Number Of Bits For Band BITMAP", "wmx.compact_dlmap.nb_bitmap", FT_UINT8, BASE_HEX, NULL, MSB_NIBBLE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_nb_bitmap_1,\r\n{"Number Of Bits For Band BITMAP", "wmx.compact_dlmap.nb_bitmap", FT_UINT8, BASE_HEX, NULL, LSB_NIBBLE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_shortened_uiuc,\r\n{"Shortened UIUC", "wmx.compact_dlmap.shortened_uiuc", FT_UINT8, BASE_HEX, NULL, SHORTENED_DIUC_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_shortened_uiuc_1,\r\n{"Shortened UIUC", "wmx.compact_dlmap.shortened_uiuc", FT_UINT16, BASE_HEX, NULL, SHORTENED_DIUC_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_shortened_diuc,\r\n{"Shortened DIUC", "wmx.compact_dlmap.shortened_diuc", FT_UINT8, BASE_HEX, NULL, SHORTENED_DIUC_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_shortened_diuc_1,\r\n{"Shortened DIUC", "wmx.compact_dlmap.shortened_diuc", FT_UINT16, BASE_HEX, NULL, SHORTENED_DIUC_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_companded_sc,\r\n{"Companded SC", "wmx.compact_dlmap.companded_sc", FT_UINT8, BASE_HEX, NULL, COMPANDED_SC_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_companded_sc_1,\r\n{"Companded SC", "wmx.compact_dlmap.companded_sc", FT_UINT16, BASE_HEX, NULL, COMPANDED_SC_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_bin_offset,\r\n{"BIN Offset", "wmx.compact_dlmap.bin_offset", FT_UINT8, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_bin_offset_1,\r\n{"BIN Offset", "wmx.compact_dlmap.bin_offset", FT_UINT16, BASE_HEX, NULL, 0x0FF0, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_diuc_num_of_subchannels,\r\n{"Number Of Subchannels", "wmx.compact_dlmap.diuc_num_of_subchannels", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_diuc_num_of_subchannels_1,\r\n{"Number Of Subchannels", "wmx.compact_dlmap.diuc_num_of_subchannels", FT_UINT16, BASE_DEC, NULL, 0x0FF0, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_diuc_repetition_coding_indication,\r\n{"Repetition Coding Indication", "wmx.compact_dlmap.diuc_repetition_coding_indication", FT_UINT8, BASE_DEC, VALS(rep_msgs), 0xC0, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_diuc_repetition_coding_indication_1,\r\n{"Repetition Coding Indication", "wmx.compact_dlmap.diuc_repetition_coding_indication", FT_UINT8, BASE_DEC, VALS(rep_msgs), 0x0C, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_diuc_reserved,\r\n{"Reserved", "wmx.compact_dlmap.diuc_reserved", FT_UINT8, BASE_HEX, NULL, 0x30, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_diuc_reserved_1,\r\n{"Reserved", "wmx.compact_dlmap.diuc_reserved", FT_UINT8, BASE_HEX, NULL, 0x03, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_bit_map_length,\r\n{"BIT MAP Length", "wmx.compact_dlmap.bit_map_length", FT_UINT8, BASE_DEC, NULL, MSB_NIBBLE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_bit_map_length_1,\r\n{"BIT MAP Length", "wmx.compact_dlmap.bit_map_length", FT_UINT8, BASE_DEC, NULL, LSB_NIBBLE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_bit_map,\r\n{"BIT MAP", "wmx.compact_dlmap.bit_map", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_diuc,\r\n{"DIUC", "wmx.compact_dlmap.diuc", FT_UINT8, BASE_HEX, NULL, MSB_NIBBLE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_diuc_1,\r\n{"DIUC", "wmx.compact_dlmap.diuc", FT_UINT8, BASE_HEX, NULL, LSB_NIBBLE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_allocation_mode,\r\n{"Allocation Mode", "wmx.compact_dlmap.allocation_mode", FT_UINT8, BASE_DEC, VALS(vals_allocation_modes), 0xC0, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_allocation_mode_1,\r\n{"Allocation Mode", "wmx.compact_dlmap.allocation_mode", FT_UINT8, BASE_DEC, VALS(vals_allocation_modes), 0x0C, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_allocation_mode_rsvd,\r\n{"Reserved", "wmx.compact_dlmap.allocation_mode_rsvd", FT_UINT8, BASE_DEC, NULL, 0x30, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_allocation_mode_rsvd_1,\r\n{"Reserved", "wmx.compact_dlmap.allocation_mode_rsvd", FT_UINT8, BASE_DEC, NULL, 0x03, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_num_subchannels,\r\n{"Number Of Subchannels", "wmx.compact_dlmap.num_subchannels", FT_UINT8, BASE_DEC, NULL, 0x0, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_num_subchannels_1,\r\n{"Number Of Subchannels", "wmx.compact_dlmap.num_subchannels", FT_UINT16, BASE_DEC, NULL, 0x0FF0, NULL, HFILL}\r\n},\r\n#if 0\r\n{\r\n&hf_cdlmap_reserved_type,\r\n{"DL-MAP Reserved Type", "wmx.compact_dlmap.reserved_type", FT_UINT8, BASE_DEC, NULL, DL_MAP_TYPE_MASK, NULL, HFILL}\r\n},\r\n#endif\r\n{\r\n&hf_cdlmap_reserved_type_1,\r\n{"DL-MAP Reserved Type", "wmx.compact_dlmap.reserved_type", FT_UINT8, BASE_DEC, NULL, DL_MAP_TYPE_MASK_1, NULL, HFILL}\r\n}\r\n};\r\nstatic hf_register_info hf_format_config[] =\r\n{\r\n{\r\n&hf_format_config_ie_dl_map_type,\r\n{"DL-MAP Type", "wmx.format_config_ie.dl_map_type", FT_UINT8, BASE_DEC, NULL, DL_MAP_TYPE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_format_config_ie_dl_map_type_1,\r\n{"DL-MAP Type", "wmx.format_config_ie.dl_map_type", FT_UINT8, BASE_DEC, NULL, DL_MAP_TYPE_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_format_config_ie_dl_map_type_32,\r\n{"DL-MAP Type", "wmx.format_config_ie.dl_map_type", FT_UINT32, BASE_DEC, NULL, FORMAT_CONFIG_IE_DL_MAP_TYPE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_format_config_ie_new_format_indication,\r\n{"New Format Indication", "wmx.format_config_ie.new_format_indication", FT_BOOLEAN, 8, TFS(&tfs_indication), UL_MAP_APPEND_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_format_config_ie_new_format_indication_1,\r\n{"New Format Indication", "wmx.format_config_ie.new_format_indication", FT_BOOLEAN, 8, TFS(&tfs_indication), UL_MAP_APPEND_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_format_config_ie_new_format_indication_32,\r\n{"New Format Indication", "wmx.format_config_ie.new_format_indication", FT_BOOLEAN, 32, TFS(&tfs_indication), FORMAT_CONFIG_IE_NEW_FORMAT_IND_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_format_config_ie_cid_type,\r\n{"HARQ MAP Indicator", "wmx.harq_map.format_config_ie.indicator", FT_UINT32, BASE_HEX, VALS(vals_cid_types), CID_TYPE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_format_config_ie_cid_type_1,\r\n{"CID Type", "wmx.harq_map.format_config_ie.cid_type", FT_UINT32, BASE_HEX, VALS(vals_cid_types), CID_TYPE_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_format_config_ie_safety_pattern,\r\n{"Safety Pattern", "wmx.harq_map.format_config_ie.safety_pattern", FT_UINT32, BASE_HEX, NULL, SAFETY_PATTERN_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_format_config_ie_safety_pattern_1,\r\n{"Safety Pattern", "wmx.harq_map.format_config_ie.safety_pattern", FT_UINT32, BASE_HEX, NULL, SAFETY_PATTERN_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_format_config_ie_subchannel_type,\r\n{"Subchannel Type For Band AMC", "wmx.harq_map.format_config_ie.subchannel_type", FT_UINT32, BASE_HEX, VALS(vals_subchannel_types), BAND_AMC_SUBCHANNEL_TYPE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_format_config_ie_subchannel_type_1,\r\n{"Subchannel Type For Band AMC", "wmx.harq_map.format_config_ie.subchannel_type", FT_UINT32, BASE_HEX, VALS(vals_subchannel_types), BAND_AMC_SUBCHANNEL_TYPE_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_format_config_ie_max_logical_bands,\r\n{"Max Logical Bands", "wmx.harq_map.format_config_ie.max_logical_bands", FT_UINT32, BASE_HEX, VALS(vals_max_logical_bands), MAX_LOGICAL_BANDS_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_format_config_ie_max_logical_bands_1,\r\n{"Max Logical Bands", "wmx.harq_map.format_config_ie.max_logical_bands", FT_UINT32, BASE_HEX, VALS(vals_max_logical_bands), MAX_LOGICAL_BANDS_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_format_config_ie_num_of_broadcast_symbol,\r\n{"Number Of Symbols for Broadcast", "wmx.harq_map.format_config_ie.num_of_broadcast_symbol", FT_UINT32, BASE_HEX, NULL, NUM_BROADCAST_SYMBOLS_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_format_config_ie_num_of_broadcast_symbol_1,\r\n{"Number Of Symbols for Broadcast", "wmx.harq_map.num_of_broadcast_symbol", FT_UINT32, BASE_HEX, NULL, NUM_BROADCAST_SYMBOLS_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_format_config_ie_num_of_dl_band_amc_symbol,\r\n{"Number Of Symbols for Broadcast", "wmx.harq_map.format_config_ie.num_of_dl_band_amc_symbol", FT_UINT32, BASE_HEX, NULL, NUM_DL_AMC_SYMBOLS_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_format_config_ie_num_of_dl_band_amc_symbol_1,\r\n{"Number Of Symbols for Broadcast", "wmx.harq_map.num_of_dl_band_amc_symbol", FT_UINT32, BASE_HEX, NULL, NUM_DL_AMC_SYMBOLS_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_format_config_ie_num_of_ul_band_amc_symbol,\r\n{"Number Of Symbols for Broadcast", "wmx.harq_map.format_config_ie.num_of_ul_band_amc_symbol", FT_UINT32, BASE_HEX, NULL, NUM_UL_AMC_SYMBOLS_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_format_config_ie_num_of_ul_band_amc_symbol_1,\r\n{"Number Of Symbols for Broadcast", "wmx.harq_map.num_of_ul_band_amc_symbol", FT_UINT32, BASE_HEX, NULL, NUM_UL_AMC_SYMBOLS_MASK_1, NULL, HFILL}\r\n}\r\n};\r\nstatic hf_register_info hf_rcid[] =\r\n{\r\n{\r\n&hf_harq_rcid_ie_normal_cid,\r\n{"Normal CID", "wmx.harq_map.rcid_ie.normal_cid", FT_UINT16, BASE_HEX, NULL, 0x0, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_rcid_ie_normal_cid_1,\r\n{"Normal CID", "wmx.harq_map.rcid_ie.normal_cid", FT_UINT24, BASE_HEX, NULL, WIMAX_RCID_IE_NORMAL_CID_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_rcid_ie_prefix,\r\n{"Prefix", "wmx.harq_map.rcid_ie.prefix", FT_UINT16, BASE_HEX, NULL, WIMAX_RCID_IE_PREFIX_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_rcid_ie_prefix_1,\r\n{"Prefix", "wmx.harq_map.rcid_ie.prefix", FT_UINT16, BASE_HEX, NULL, WIMAX_RCID_IE_PREFIX_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_rcid_ie_cid3,\r\n{"3 LSB Of Basic CID", "wmx.harq_map.rcid_ie.cid3", FT_UINT16, BASE_HEX, NULL, WIMAX_RCID_IE_CID3_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_rcid_ie_cid3_1,\r\n{"3 LSB Of Basic CID", "wmx.harq_map.rcid_ie.cid3", FT_UINT16, BASE_HEX, NULL, WIMAX_RCID_IE_CID3_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_rcid_ie_cid7,\r\n{"7 LSB Of Basic CID", "wmx.harq_map.rcid_ie.cid7", FT_UINT16, BASE_HEX, NULL, WIMAX_RCID_IE_CID7_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_rcid_ie_cid7_1,\r\n{"7 LSB Of Basic CID", "wmx.harq_map.rcid_ie.cid7", FT_UINT16, BASE_HEX, NULL, WIMAX_RCID_IE_CID7_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_rcid_ie_cid11,\r\n{"11 LSB Of Basic CID", "wmx.harq_map.rcid_ie.cid11", FT_UINT16, BASE_HEX, NULL, WIMAX_RCID_IE_CID11_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_rcid_ie_cid11_1,\r\n{"11 LSB Of Basic CID", "wmx.harq_map.rcid_ie.cid11", FT_UINT16, BASE_HEX, NULL, WIMAX_RCID_IE_CID11_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_rcid_ie_cid11_2,\r\n{"11 LSB Of Multicast, AAS or Broadcast CID", "wmx.harq_map.rcid_ie.cid11", FT_UINT16, BASE_HEX, NULL, WIMAX_RCID_IE_CID11_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_rcid_ie_cid11_3,\r\n{"11 LSB Of Multicast, AAS or Broadcast CID", "wmx.harq_map.rcid_ie.cid11", FT_UINT16, BASE_HEX, NULL, WIMAX_RCID_IE_CID11_MASK_1, NULL, HFILL}\r\n}\r\n};\r\nstatic hf_register_info hf_harq_control[] =\r\n{\r\n{\r\n&hf_harq_control_ie_prefix,\r\n{"Prefix", "wmx.harq_map.harq_control_ie.prefix", FT_BOOLEAN, 8, TFS(&tfs_prefix), WIMAX_HARQ_CONTROL_IE_PREFIX_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_control_ie_ai_sn,\r\n{"HARQ ID Sequence Number(AI_SN)", "wmx.harq_map.harq_control_ie.ai_sn", FT_UINT8, BASE_HEX, NULL, WIMAX_HARQ_CONTROL_IE_AI_SN_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_control_ie_spid,\r\n{"Subpacket ID (SPID)", "wmx.harq_map.harq_control_ie.spid", FT_UINT8, BASE_HEX, NULL, WIMAX_HARQ_CONTROL_IE_SPID_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_control_ie_acid,\r\n{"HARQ CH ID (ACID)", "wmx.harq_map.harq_control_ie.acid", FT_UINT8, BASE_HEX, NULL, WIMAX_HARQ_CONTROL_IE_ACID_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_control_ie_reserved,\r\n{"Reserved", "wmx.harq_map.harq_control_ie.reserved", FT_UINT8, BASE_HEX, NULL, WIMAX_HARQ_CONTROL_IE_RESERVED_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_control_ie_prefix_1,\r\n{"Prefix", "wmx.harq_map.harq_control_ie.prefix", FT_BOOLEAN, 16, TFS(&tfs_prefix), WIMAX_HARQ_CONTROL_IE_PREFIX_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_control_ie_ai_sn_1,\r\n{"HARQ ID Sequence Number(AI_SN)", "wmx.harq_map.harq_control_ie.ai_sn", FT_UINT16, BASE_HEX, NULL, WIMAX_HARQ_CONTROL_IE_AI_SN_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_control_ie_spid_1,\r\n{"Subpacket ID (SPID)", "wmx.harq_map.harq_control_ie.spid", FT_UINT16, BASE_HEX, NULL, WIMAX_HARQ_CONTROL_IE_SPID_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_control_ie_acid_1,\r\n{"HARQ CH ID (ACID)", "wmx.harq_map.harq_control_ie.acid", FT_UINT16, BASE_HEX, NULL, WIMAX_HARQ_CONTROL_IE_ACID_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_harq_control_ie_reserved_1,\r\n{"Reserved", "wmx.harq_map.harq_control_ie.reserved", FT_UINT16, BASE_HEX, NULL, WIMAX_HARQ_CONTROL_IE_RESERVED_MASK_1, NULL, HFILL}\r\n}\r\n};\r\nstatic hf_register_info hf_cqich_control[] =\r\n{\r\n{\r\n&hf_cqich_control_ie_indicator,\r\n{"CQICH Indicator", "wmx.harq_map.cqich_control_ie.cqich_indicator", FT_BOOLEAN, 16, TFS(&tfs_cqich_ind), WIMAX_CQICH_CONTROL_IE_INDICATOR_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cqich_control_ie_alloc_id,\r\n{"Allocation Index", "wmx.harq_map.cqich_control_ie.alloc_id", FT_UINT16, BASE_HEX, NULL, WIMAX_CQICH_CONTROL_IE_ALLOCATION_INDEX_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cqich_control_ie_period,\r\n{"PERIOD", "wmx.harq_map.cqich_control_ie.period", FT_UINT16, BASE_HEX, NULL, WIMAX_CQICH_CONTROL_IE_PERIOD_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cqich_control_ie_frame_offset,\r\n{"Frame Offset", "wmx.harq_map.cqich_control_ie.frame_offset", FT_UINT16, BASE_HEX, NULL, WIMAX_CQICH_CONTROL_IE_FRAME_OFFSET_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cqich_control_ie_duration,\r\n{"Duration", "wmx.harq_map.cqich_control_ie.duration", FT_UINT16, BASE_HEX, NULL, WIMAX_CQICH_CONTROL_IE_DURATION_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cqich_control_ie_cqi_rep_threshold,\r\n{"CQI Reporting Threshold", "wmx.harq_map.cqich_control_ie.cqi_rep_threshold", FT_UINT16, BASE_HEX, NULL, WIMAX_CQICH_CONTROL_IE_CQI_REP_THRESHOLD_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cqich_control_ie_indicator_1,\r\n{"CQICH Indicator", "wmx.harq_map.cqich_control_ie.cqich_indicator", FT_BOOLEAN, 24, TFS(&tfs_cqich_ind), WIMAX_CQICH_CONTROL_IE_INDICATOR_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_cqich_control_ie_alloc_id_1,\r\n{"Allocation Index", "wmx.harq_map.cqich_control_ie.alloc_id", FT_UINT24, BASE_HEX, NULL, WIMAX_CQICH_CONTROL_IE_ALLOCATION_INDEX_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_cqich_control_ie_period_1,\r\n{"PERIOD", "wmx.harq_map.cqich_control_ie.period", FT_UINT24, BASE_HEX, NULL, WIMAX_CQICH_CONTROL_IE_PERIOD_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_cqich_control_ie_frame_offset_1,\r\n{"Frame Offset", "wmx.harq_map.cqich_control_ie.frame_offset", FT_UINT24, BASE_HEX, NULL, WIMAX_CQICH_CONTROL_IE_FRAME_OFFSET_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_cqich_control_ie_duration_1,\r\n{"Duration", "wmx.harq_map.cqich_control_ie.duration", FT_UINT24, BASE_HEX, NULL, WIMAX_CQICH_CONTROL_IE_DURATION_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_cqich_control_ie_cqi_rep_threshold_1,\r\n{"CQI Reporting Threshold", "wmx.harq_map.cqich_control_ie.cqi_rep_threshold", FT_UINT24, BASE_HEX, NULL, WIMAX_CQICH_CONTROL_IE_CQI_REP_THRESHOLD_MASK_1, NULL, HFILL}\r\n}\r\n};\r\nstatic hf_register_info hf_extension_type[] =\r\n{\r\n{\r\n&hf_cdlmap_extension_type,\r\n{"DL-MAP Type", "wmx.extension_type.dl_map_type", FT_UINT16, BASE_DEC, NULL, EXTENSION_TYPE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_extension_type_1,\r\n{"DL-MAP Type", "wmx.extension_type.dl_map_type", FT_UINT16, BASE_DEC, NULL, EXTENSION_TYPE_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_extension_subtype,\r\n{"Extension Subtype", "wmx.extension_type.subtype", FT_UINT16, BASE_DEC, NULL, EXTENSION_SUBTYPE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_extension_subtype_1,\r\n{"Extension Subtype", "wmx.extension_type.subtype", FT_UINT16, BASE_DEC, NULL, EXTENSION_SUBTYPE_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_extension_length,\r\n{"Extension Length", "wmx.extension_type.length", FT_UINT16, BASE_DEC, NULL, EXTENSION_LENGTH_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_extension_length_1,\r\n{"Extension Length", "wmx.extension_type.length", FT_UINT16, BASE_DEC, NULL, EXTENSION_LENGTH_MASK_1, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_extension_time_diversity_mbs,\r\n{"Time Diversity MBS", "wmx.extension_type.time_diversity_mbs", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_extension_time_diversity_mbs_1,\r\n{"Time Diversity MBS", "wmx.extension_type.time_diversity_mbs", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_extension_harq_mode_1,\r\n{"HARQ Mode Switch", "wmx.extension_type.harq_mode", FT_UINT16, BASE_HEX, NULL, 0x000F, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_extension_harq_mode,\r\n{"HARQ Mode Switch", "wmx.extension_type.harq_mode", FT_UINT8, BASE_HEX, NULL, MSB_NIBBLE_MASK, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_extension_unknown_sub_type,\r\n{"Unknown Extension Subtype", "wmx.extension_type.unknown_sub_type", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n},\r\n{\r\n&hf_cdlmap_extension_unknown_sub_type_1,\r\n{"Unknown Extension Subtype", "wmx.extension_type.unknown_sub_type", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL}\r\n}\r\n};\r\nstatic hf_register_info hf_extended_diuc[] =\r\n{\r\n{\r\n&hf_extended_diuc_dependent_ie_diuc,\r\n{"Extended DIUC", "wmx.extended_diuc_dependent_ie.diuc", FT_UINT8, BASE_HEX, NULL, MSB_NIBBLE_MASK, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_diuc_dependent_ie_diuc_1,\r\n{"Extended DIUC", "wmx.extended_diuc_dependent_ie.diuc", FT_UINT8, BASE_HEX, NULL, LSB_NIBBLE_MASK, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_diuc_dependent_ie_length,\r\n{"Length", "wmx.extended_diuc_dependent_ie.length", FT_UINT8, BASE_DEC, NULL, MSB_NIBBLE_MASK, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_diuc_dependent_ie_length_1,\r\n{"Length", "wmx.extended_diuc_dependent_ie.length", FT_UINT8, BASE_DEC, NULL, LSB_NIBBLE_MASK, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_diuc_dependent_ie_channel_measurement,\r\n{"Channel_Measurement_IE (not implemented)", "wmx.extended_diuc_dependent_ie.channel_measurement", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_diuc_dependent_ie_stc_zone,\r\n{"STC_Zone_IE (not implemented)", "wmx.extended_diuc_dependent_ie.stc_zone", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_diuc_dependent_ie_aas_dl,\r\n{"AAS_DL_IE (not implemented)", "wmx.extended_diuc_dependent_ie.aas_dl", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_diuc_dependent_ie_data_location,\r\n{"Data_location_in_another_BS_IE (not implemented)", "wmx.extended_diuc_dependent_ie.data_location", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_diuc_dependent_ie_cid_switch,\r\n{"CID_Switch_IE (not implemented)", "wmx.extended_diuc_dependent_ie.cid_switch", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_diuc_dependent_ie_mimo_dl_basic,\r\n{"MIMO_DL_Basic_IE (not implemented)", "wmx.extended_diuc_dependent_ie.mimo_dl_basic", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_diuc_dependent_ie_mimo_dl_enhanced,\r\n{"MIMO_DL_Enhanced_IE (not implemented)", "wmx.extended_diuc_dependent_ie.mimo_dl_enhanced", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_diuc_dependent_ie_harq_map_pointer,\r\n{"HARQ_Map_Pointer_IE (not implemented)", "wmx.extended_diuc_dependent_ie.harq_map_pointer", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_diuc_dependent_ie_phymod_dl,\r\n{"PHYMOD_DL_IE (not implemented)", "wmx.extended_diuc_dependent_ie.phymod_dl", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_diuc_dependent_ie_dl_pusc_burst_allocation,\r\n{"DL_PUSC_Burst_Allocation_in_Other_Segment_IE (not implemented)", "wmx.extended_diuc_dependent_ie.dl_pusc_burst_allocation", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_diuc_dependent_ie_ul_interference_and_noise_level,\r\n{"UL_interference_and_noise_level_IE (not implemented)", "wmx.extended_diuc_dependent_ie.ul_interference_and_noise_level", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n},\r\n{\r\n&hf_extended_diuc_dependent_ie_unknown_diuc,\r\n{"Unknown Extended DIUC", "wmx.extended_diuc_dependent_ie.unknown_diuc", FT_BYTES, BASE_NONE, NULL, 0x0, NULL, HFILL }\r\n}\r\n};\r\n#if 0\r\nstatic gint *ett[] =\r\n{\r\n&ett_wimax_compact_dlmap_ie_decoder,\r\n&ett_wimax_format_configuration_ie_decoder,\r\n&ett_wimax_rcid_ie_decoder,\r\n&ett_wimax_harq_control_ie_decoder,\r\n&ett_wimax_extended_diuc_dependent_ie_decoder,\r\n&ett_wimax_cqich_control_ie_decoder,\r\n&ett_wimax_extension_type_ie_decoder,\r\n};\r\nproto_register_subtree_array(ett, array_length(ett));\r\n#endif\r\nproto_wimax_compact_dlmap_ie_decoder = proto_wimax;\r\nproto_register_field_array(proto_wimax_compact_dlmap_ie_decoder, hf_compact_dlmap, array_length(hf_compact_dlmap));\r\nproto_register_field_array(proto_wimax_compact_dlmap_ie_decoder, hf_format_config, array_length(hf_format_config));\r\nproto_register_field_array(proto_wimax_compact_dlmap_ie_decoder, hf_rcid, array_length(hf_rcid));\r\nproto_register_field_array(proto_wimax_compact_dlmap_ie_decoder, hf_harq_control, array_length(hf_harq_control));\r\nproto_register_field_array(proto_wimax_compact_dlmap_ie_decoder, hf_cqich_control, array_length(hf_cqich_control));\r\nproto_register_field_array(proto_wimax_compact_dlmap_ie_decoder, hf_extension_type, array_length(hf_extension_type));\r\nproto_register_field_array(proto_wimax_compact_dlmap_ie_decoder, hf_extended_diuc, array_length(hf_extended_diuc));\r\n}
