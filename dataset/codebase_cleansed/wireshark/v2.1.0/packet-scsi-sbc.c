static void\r\ndissect_sbc_formatunit (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *fuflags_fields[] = {\r\n&hf_scsi_sbc_fuflags_fmtpinfo,\r\n&hf_scsi_sbc_fuflags_rto_req,\r\n&hf_scsi_sbc_fuflags_longlist,\r\n&hf_scsi_sbc_fuflags_fmtdata,\r\n&hf_scsi_sbc_fuflags_cmplist,\r\n&hf_scsi_sbc_defect_list_format,\r\nNULL\r\n};\r\nif (!tree)\r\nreturn;\r\nif (isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_formatunit_flags,\r\nett_scsi_format_unit, fuflags_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_formatunit_vendor, tvb, offset+1, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_formatunit_interleave, tvb, offset+2, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+4, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_read6 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nif (isreq && iscdb) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(LBA: 0x%06x, Len: %u)",\r\ntvb_get_ntoh24 (tvb, offset),\r\ntvb_get_guint8 (tvb, offset+3));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr6_lba, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr6_xferlen, tvb, offset+3, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+4, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_write6 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nif (isreq && iscdb) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(LBA: 0x%06x, Len: %u)",\r\ntvb_get_ntoh24 (tvb, offset),\r\ntvb_get_guint8 (tvb, offset+3));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr6_lba, tvb, offset, 3, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr6_xferlen, tvb, offset+3, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+4, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_prefetch10 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *prefetch_fields[] = {\r\n&hf_scsi_sbc_prefetch_immed,\r\nNULL\r\n};\r\nif (isreq && iscdb) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(LBA: 0x%08x, Len: %u)",\r\ntvb_get_ntohl (tvb, offset+1),\r\ntvb_get_ntohs (tvb, offset+6));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_prefetch_flags,\r\nett_scsi_prefetch, prefetch_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr10_lba, tvb, offset+1, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_group, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr10_xferlen, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+8, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_synchronizecache10 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *sync_fields[] = {\r\n&hf_scsi_sbc_synccache_sync_nv,\r\n&hf_scsi_sbc_synccache_immed,\r\nNULL\r\n};\r\nif (isreq && iscdb) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(LBA: 0x%08x, Len: %u)",\r\ntvb_get_ntohl (tvb, offset+1),\r\ntvb_get_ntohs (tvb, offset+6));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_synccache_flags,\r\nett_scsi_synccache, sync_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr10_lba, tvb, offset+1, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_group, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr10_xferlen, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+8, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_synchronizecache16 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *sync_fields[] = {\r\n&hf_scsi_sbc_synccache_sync_nv,\r\n&hf_scsi_sbc_synccache_immed,\r\nNULL\r\n};\r\nif (isreq && iscdb) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(LBA: %" G_GINT64_MODIFIER "u, Len: %u)",\r\ntvb_get_ntoh64 (tvb, offset+1),\r\ntvb_get_ntohl (tvb, offset+9));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_synccache_flags,\r\nett_scsi_synccache, sync_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr16_lba, tvb, offset+1, 8, ENC_NA);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr12_xferlen, tvb, offset+9, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_group, tvb, offset+13, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+14, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_prefetch16 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *prefetch_fields[] = {\r\n&hf_scsi_sbc_prefetch_immed,\r\nNULL\r\n};\r\nif (isreq && iscdb) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(LBA: %" G_GINT64_MODIFIER "u, Len: %u)",\r\ntvb_get_ntoh64 (tvb, offset+1),\r\ntvb_get_ntohl (tvb, offset+9));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_prefetch_flags,\r\nett_scsi_prefetch, prefetch_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr16_lba, tvb, offset+1, 8, ENC_NA);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr12_xferlen, tvb, offset+9, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_group, tvb, offset+13, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+14, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nvoid\r\ndissect_sbc_read10 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *rdwr10_fields[] = {\r\n&hf_scsi_sbc_rdprotect,\r\n&hf_scsi_sbc_dpo,\r\n&hf_scsi_sbc_fua,\r\n&hf_scsi_sbc_fua_nv,\r\nNULL\r\n};\r\nif (isreq && iscdb) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(LBA: 0x%08x, Len: %u)",\r\ntvb_get_ntohl (tvb, offset+1),\r\ntvb_get_ntohs (tvb, offset+6));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_read_flags,\r\nett_scsi_rdwr, rdwr10_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr10_lba, tvb, offset+1, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_group, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr10_xferlen, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+8, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_xdread10 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *xdread10_fields[] = {\r\n&hf_scsi_sbc_xorpinfo,\r\nNULL\r\n};\r\nif (isreq && iscdb) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(LBA: 0x%08x, Len: %u)",\r\ntvb_get_ntohl (tvb, offset+1),\r\ntvb_get_ntohs (tvb, offset+6));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_xdread_flags,\r\nett_scsi_xdread, xdread10_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr10_lba, tvb, offset+1, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_group, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr10_xferlen, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+8, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_xdwrite10 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *xdwrite10_fields[] = {\r\n&hf_scsi_sbc_wrprotect,\r\n&hf_scsi_sbc_dpo,\r\n&hf_scsi_sbc_fua,\r\n&hf_scsi_sbc_disable_write,\r\n&hf_scsi_sbc_fua_nv,\r\nNULL\r\n};\r\nif (isreq && iscdb) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(LBA: 0x%08x, Len: %u)",\r\ntvb_get_ntohl (tvb, offset+1),\r\ntvb_get_ntohs (tvb, offset+6));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_xdwrite_flags,\r\nett_scsi_xdwrite, xdwrite10_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr10_lba, tvb, offset+1, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_group, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr10_xferlen, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+8, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_xdwriteread10 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *xdwriteread10_fields[] = {\r\n&hf_scsi_sbc_wrprotect,\r\n&hf_scsi_sbc_dpo,\r\n&hf_scsi_sbc_fua,\r\n&hf_scsi_sbc_disable_write,\r\n&hf_scsi_sbc_fua_nv,\r\n&hf_scsi_sbc_xorpinfo,\r\nNULL\r\n};\r\nif (isreq && iscdb) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(LBA: 0x%08x, Len: %u)",\r\ntvb_get_ntohl (tvb, offset+1),\r\ntvb_get_ntohs (tvb, offset+6));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_xdwriteread_flags,\r\nett_scsi_xdwriteread, xdwriteread10_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr10_lba, tvb, offset+1, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_group, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr10_xferlen, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+8, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_xpwrite10 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *xpwrite10_fields[] = {\r\n&hf_scsi_sbc_dpo,\r\n&hf_scsi_sbc_fua,\r\n&hf_scsi_sbc_fua_nv,\r\n&hf_scsi_sbc_xorpinfo,\r\nNULL\r\n};\r\nif (isreq && iscdb) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(LBA: 0x%08x, Len: %u)",\r\ntvb_get_ntohl (tvb, offset+1),\r\ntvb_get_ntohs (tvb, offset+6));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_xpwrite_flags,\r\nett_scsi_xpwrite, xpwrite10_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr10_lba, tvb, offset+1, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_group, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr10_xferlen, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+8, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nvoid\r\ndissect_sbc_write10 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *rdwr10_fields[] = {\r\n&hf_scsi_sbc_wrprotect,\r\n&hf_scsi_sbc_dpo,\r\n&hf_scsi_sbc_fua,\r\n&hf_scsi_sbc_fua_nv,\r\nNULL\r\n};\r\nif (isreq && iscdb) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(LBA: 0x%08x, Len: %u)",\r\ntvb_get_ntohl (tvb, offset+1),\r\ntvb_get_ntohs (tvb, offset+6));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_read_flags,\r\nett_scsi_rdwr, rdwr10_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr10_lba, tvb, offset+1, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_group, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr10_xferlen, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+8, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nvoid\r\ndissect_sbc_read12 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *rdwr12_fields[] = {\r\n&hf_scsi_sbc_rdprotect,\r\n&hf_scsi_sbc_dpo,\r\n&hf_scsi_sbc_fua,\r\n&hf_scsi_sbc_fua_nv,\r\nNULL\r\n};\r\nif (isreq && iscdb) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(LBA: 0x%08x, Len: %u)",\r\ntvb_get_ntohl (tvb, offset+1),\r\ntvb_get_ntohl (tvb, offset+5));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_read_flags,\r\nett_scsi_rdwr, rdwr12_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr10_lba, tvb, offset+1, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr12_xferlen, tvb, offset+5, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_group, tvb, offset+9, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+10, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nvoid\r\ndissect_sbc_write12 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *rdwr12_fields[] = {\r\n&hf_scsi_sbc_wrprotect,\r\n&hf_scsi_sbc_dpo,\r\n&hf_scsi_sbc_fua,\r\n&hf_scsi_sbc_fua_nv,\r\nNULL\r\n};\r\nif (isreq && iscdb) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(LBA: 0x%08x, Len: %u)",\r\ntvb_get_ntohl (tvb, offset+1),\r\ntvb_get_ntohl (tvb, offset+5));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_read_flags,\r\nett_scsi_rdwr, rdwr12_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr10_lba, tvb, offset+1, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr12_xferlen, tvb, offset+5, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_group, tvb, offset+9, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+10, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_read16 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *rdwr16_fields[] = {\r\n&hf_scsi_sbc_rdprotect,\r\n&hf_scsi_sbc_dpo,\r\n&hf_scsi_sbc_fua,\r\n&hf_scsi_sbc_fua_nv,\r\nNULL\r\n};\r\nif (isreq && iscdb) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(LBA: %" G_GINT64_MODIFIER "u, Len: %u)",\r\ntvb_get_ntoh64 (tvb, offset+1),\r\ntvb_get_ntohl (tvb, offset+9));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_read_flags,\r\nett_scsi_rdwr, rdwr16_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr16_lba, tvb, offset+1, 8, ENC_NA);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr12_xferlen, tvb, offset+9, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_group, tvb, offset+13, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+14, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_write16 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *rdwr16_fields[] = {\r\n&hf_scsi_sbc_wrprotect,\r\n&hf_scsi_sbc_dpo,\r\n&hf_scsi_sbc_fua,\r\n&hf_scsi_sbc_fua_nv,\r\nNULL\r\n};\r\nif (isreq && iscdb) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(LBA: %" G_GINT64_MODIFIER "u, Len: %u)",\r\ntvb_get_ntoh64 (tvb, offset+1),\r\ntvb_get_ntohl (tvb, offset+9));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_read_flags,\r\nett_scsi_rdwr, rdwr16_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr16_lba, tvb, offset+1, 8, ENC_NA);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr12_xferlen, tvb, offset+9, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_group, tvb, offset+13, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+14, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_writeatomic16 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *rdwr16_fields[] = {\r\n&hf_scsi_sbc_wrprotect,\r\n&hf_scsi_sbc_dpo,\r\n&hf_scsi_sbc_fua,\r\nNULL\r\n};\r\nif (isreq && iscdb) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(LBA: %" G_GINT64_MODIFIER "u, Len: %u)",\r\ntvb_get_ntoh64 (tvb, offset+1),\r\ntvb_get_ntohs (tvb, offset+11));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_read_flags,\r\nett_scsi_rdwr, rdwr16_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr16_lba, tvb, offset+1, 8, ENC_NA);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr12_xferlen, tvb, offset+11, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_group, tvb, offset+13, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+14, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_orwrite (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *rdwr16_fields[] = {\r\n&hf_scsi_sbc_wrprotect,\r\n&hf_scsi_sbc_dpo,\r\n&hf_scsi_sbc_fua,\r\n&hf_scsi_sbc_fua_nv,\r\nNULL\r\n};\r\nif (isreq && iscdb) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(LBA: %" G_GINT64_MODIFIER "u, Len: %u)",\r\ntvb_get_ntoh64 (tvb, offset+1),\r\ntvb_get_ntohl (tvb, offset+9));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_read_flags,\r\nett_scsi_rdwr, rdwr16_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr16_lba, tvb, offset+1, 8, ENC_NA);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr12_xferlen, tvb, offset+9, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_group, tvb, offset+13, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+14, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_comparenwrite (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *rdwr16_fields[] = {\r\n&hf_scsi_sbc_wrprotect,\r\n&hf_scsi_sbc_dpo,\r\n&hf_scsi_sbc_fua,\r\n&hf_scsi_sbc_fua_nv,\r\nNULL\r\n};\r\nif (isreq && iscdb) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(LBA: %" G_GINT64_MODIFIER "u, Len: %u)",\r\ntvb_get_ntoh64 (tvb, offset+1),\r\ntvb_get_ntohl (tvb, offset+9));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_read_flags,\r\nett_scsi_rdwr, rdwr16_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr16_lba, tvb, offset+1, 8, ENC_NA);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr12_xferlen, tvb, offset+12, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_group, tvb, offset+13, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+14, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nvoid\r\ndissect_sbc_startstopunit (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq _U_, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *ssu_fields[] = {\r\n&hf_scsi_sbc_ssu_immed,\r\nNULL\r\n};\r\nstatic const int *pwr_fields[] = {\r\n&hf_scsi_sbc_ssu_pwr_cond,\r\n&hf_scsi_sbc_ssu_loej,\r\n&hf_scsi_sbc_ssu_start,\r\nNULL\r\n};\r\nif (!tree || !iscdb)\r\nreturn;\r\nif (isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_ssu_immed_flags,\r\nett_scsi_ssu_immed, ssu_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+3, hf_scsi_sbc_ssu_pwr_flags,\r\nett_scsi_ssu_pwr, pwr_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+4, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_verify10 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *verify10_fields[] = {\r\n&hf_scsi_sbc_vrprotect,\r\n&hf_scsi_sbc_dpo,\r\n&hf_scsi_sbc_bytchk,\r\nNULL\r\n};\r\nif (isreq && iscdb) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(LBA: 0x%08x, Len: %u)",\r\ntvb_get_ntohl (tvb, offset+1),\r\ntvb_get_ntohs (tvb, offset+6));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_verify_flags,\r\nett_scsi_verify, verify10_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_verify_lba, tvb, offset+1, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_group, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_verify_vlen, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+8, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_verify12 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *verify12_fields[] = {\r\n&hf_scsi_sbc_vrprotect,\r\n&hf_scsi_sbc_dpo,\r\n&hf_scsi_sbc_bytchk,\r\nNULL\r\n};\r\nif (isreq && iscdb) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(LBA: 0x%08x, Len: %u)",\r\ntvb_get_ntohl (tvb, offset+1),\r\ntvb_get_ntohl (tvb, offset+5));\r\n}\r\nif (isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_verify_flags,\r\nett_scsi_verify, verify12_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_verify_lba, tvb, offset+1, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_verify_vlen32, tvb, offset+5, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_group, tvb, offset+9, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+10, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_verify16 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *verify16_fields[] = {\r\n&hf_scsi_sbc_vrprotect,\r\n&hf_scsi_sbc_dpo,\r\n&hf_scsi_sbc_bytchk,\r\nNULL\r\n};\r\nif (isreq && iscdb) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(LBA: %" G_GINT64_MODIFIER "u, Len: %u)",\r\ntvb_get_ntoh64 (tvb, offset+1),\r\ntvb_get_ntohl (tvb, offset+9));\r\n}\r\nif (isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_verify_flags,\r\nett_scsi_verify, verify16_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_verify_lba64, tvb, offset+1, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_verify_vlen32, tvb, offset+9, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_group, tvb, offset+13, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+14, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_wrverify10 (tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, guint offset, gboolean isreq,\r\ngboolean iscdb, guint payload_len _U_,\r\nscsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *wrverify10_fields[] = {\r\n&hf_scsi_sbc_wrprotect,\r\n&hf_scsi_sbc_dpo,\r\n&hf_scsi_sbc_bytchk,\r\nNULL\r\n};\r\nif (isreq && iscdb) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(LBA: 0x%08x, Len: %u)",\r\ntvb_get_ntohl (tvb, offset+1),\r\ntvb_get_ntohs (tvb, offset+6));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_wrverify_flags,\r\nett_scsi_wrverify, wrverify10_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_wrverify_lba, tvb, offset+1, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_group, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_wrverify_xferlen, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+8, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_wrverify12 (tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, guint offset, gboolean isreq,\r\ngboolean iscdb, guint payload_len _U_,\r\nscsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *wrverify12_fields[] = {\r\n&hf_scsi_sbc_wrprotect,\r\n&hf_scsi_sbc_dpo,\r\n&hf_scsi_sbc_bytchk,\r\nNULL\r\n};\r\nif (isreq && iscdb) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(LBA: 0x%08x, Len: %u)",\r\ntvb_get_ntohl (tvb, offset+1),\r\ntvb_get_ntohl (tvb, offset+5));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_wrverify_flags,\r\nett_scsi_wrverify, wrverify12_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_wrverify_lba, tvb, offset+1, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_wrverify_xferlen32, tvb, offset+5, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_group, tvb, offset+9, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+10, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_wrverify16 (tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, guint offset, gboolean isreq,\r\ngboolean iscdb, guint payload_len _U_,\r\nscsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *wrverify16_fields[] = {\r\n&hf_scsi_sbc_wrprotect,\r\n&hf_scsi_sbc_dpo,\r\n&hf_scsi_sbc_bytchk,\r\nNULL\r\n};\r\nif (isreq && iscdb) {\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, "(LBA: %" G_GINT64_MODIFIER "u, Len: %u)",\r\ntvb_get_ntoh64 (tvb, offset+1),\r\ntvb_get_ntohl (tvb, offset+9));\r\n}\r\nif (tree && isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_wrverify_flags,\r\nett_scsi_wrverify, wrverify16_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_wrverify_lba64, tvb, offset+1, 8, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_wrverify_xferlen32, tvb, offset+9, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_group, tvb, offset+13, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+14, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nvoid\r\ndissect_sbc_readcapacity10 (tvbuff_t *tvb, packet_info *pinfo _U_, proto_tree *tree,\r\nguint offset, gboolean isreq, gboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nguint32 len, block_len, tot_len;\r\nconst char *un;\r\nif (!tree)\r\nreturn;\r\nif (isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset+8, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\nelse if (!iscdb) {\r\nlen = tvb_get_ntohl (tvb, offset);\r\nblock_len = tvb_get_ntohl (tvb, offset+4);\r\ntot_len=((len/1024)*block_len)/1024;\r\nun="MB";\r\nif(tot_len>20000){\r\ntot_len/=1024;\r\nun="GB";\r\n}\r\nproto_tree_add_uint_format (tree, hf_scsi_sbc_returned_lba, tvb, offset, 4, len, "LBA: %u (%u %s)", len, tot_len, un);\r\nproto_tree_add_item (tree, hf_scsi_sbc_blocksize, tvb, offset+4, 4, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_readdefectdata10 (tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, guint offset, gboolean isreq,\r\ngboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *defect_fields[] = {\r\n&hf_scsi_sbc_defect_list_format,\r\n&hf_scsi_sbc_req_plist,\r\n&hf_scsi_sbc_req_glist,\r\nNULL\r\n};\r\nif (!tree)\r\nreturn;\r\nif (isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset+1, hf_scsi_sbc_readdefdata_flags,\r\nett_scsi_defectdata, defect_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_alloclen16, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+8, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_readlong10 (tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, guint offset, gboolean isreq,\r\ngboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *corrct_fields[] = {\r\n&hf_scsi_sbc_corrct,\r\nNULL\r\n};\r\nif (!tree)\r\nreturn;\r\nif (isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_corrct_flags,\r\nett_scsi_corrct, corrct_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr10_lba, tvb, offset+1, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_alloclen16, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+8, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_writelong10 (tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, guint offset, gboolean isreq,\r\ngboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nif (!tree)\r\nreturn;\r\nif (isreq && iscdb) {\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr10_lba, tvb, offset+1, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_alloclen16, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+8, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_writesame10 (tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, guint offset, gboolean isreq,\r\ngboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *writesame10_fields[] = {\r\n&hf_scsi_sbc_wrprotect,\r\n&hf_scsi_sbc_anchor,\r\n&hf_scsi_sbc_unmap,\r\n&hf_scsi_sbc_pbdata,\r\n&hf_scsi_sbc_lbdata,\r\nNULL\r\n};\r\nif (!tree)\r\nreturn;\r\nif (isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_writesame_flags,\r\nett_scsi_writesame, writesame10_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr10_lba, tvb, offset+1, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_group, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_alloclen16, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+8, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_writesame16 (tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, guint offset, gboolean isreq,\r\ngboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *writesame16_fields[] = {\r\n&hf_scsi_sbc_wrprotect,\r\n&hf_scsi_sbc_anchor,\r\n&hf_scsi_sbc_unmap,\r\n&hf_scsi_sbc_pbdata,\r\n&hf_scsi_sbc_lbdata,\r\nNULL\r\n};\r\nif (!tree)\r\nreturn;\r\nif (isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_writesame_flags,\r\nett_scsi_writesame, writesame16_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr16_lba, tvb, offset+1, 8, ENC_NA);\r\nproto_tree_add_item (tree, hf_scsi_sbc_rdwr12_xferlen, tvb, offset+9, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_group, tvb, offset+13, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+14, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_unmap (tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, guint offset, gboolean isreq,\r\ngboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *unmap_fields[] = {\r\n&hf_scsi_sbc_unmap_anchor,\r\nNULL\r\n};\r\nif (!tree)\r\nreturn;\r\nif (isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_unmap_flags,\r\nett_scsi_unmap, unmap_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_group, tvb, offset+5, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_alloclen16, tvb, offset+6, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+8, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n} else if (isreq) {\r\nproto_tree_add_item (tree, hf_scsi_sbc_unmap_data_length, tvb, offset, 2, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_unmap_block_descriptor_data_length, tvb, offset+2, 2, ENC_BIG_ENDIAN);\r\noffset += 8;\r\nwhile (tvb_reported_length_remaining(tvb, offset) >=16) {\r\nproto_tree *tr;\r\nproto_item *it;\r\ngint64 lba;\r\ngint32 num_blocks;\r\ntr = proto_tree_add_subtree(tree, tvb, offset, 16, ett_scsi_unmap_block_descriptor, &it, "UNMAP Block Descriptor: LBA ");\r\nproto_tree_add_item (tr, hf_scsi_sbc_unmap_lba, tvb, offset, 8, ENC_BIG_ENDIAN);\r\nlba = tvb_get_ntoh64 (tvb, offset);\r\nproto_tree_add_item (tr, hf_scsi_sbc_unmap_num_blocks, tvb, offset+8, 4, ENC_BIG_ENDIAN);\r\nnum_blocks = tvb_get_ntohl(tvb, offset+8);\r\nif (num_blocks > 1) {\r\nproto_item_append_text (it, "%" G_GINT64_MODIFIER "u-%" G_GINT64_MODIFIER "u ", lba, lba+num_blocks-1);\r\n} else {\r\nproto_item_append_text (it, "%" G_GINT64_MODIFIER "u ", lba);\r\n}\r\noffset += 16;\r\n}\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_sanitize (tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, guint offset, gboolean isreq,\r\ngboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *sanitize_fields[] = {\r\n&hf_scsi_sbc_sanitize_immed,\r\n&hf_scsi_sbc_sanitize_ause,\r\n&hf_scsi_sbc_sanitize_sa,\r\nNULL\r\n};\r\nstatic const int *sanitize_overwrite_fields[] = {\r\n&hf_scsi_sbc_sanitize_invert,\r\n&hf_scsi_sbc_sanitize_test,\r\n&hf_scsi_sbc_sanitize_owcount,\r\nNULL\r\n};\r\nif (!tree)\r\nreturn;\r\nif (isreq && iscdb) {\r\nguint8 service_action;\r\nservice_action = tvb_get_guint8 (tvb, offset) & 0x1F;\r\ncol_append_str(pinfo->cinfo, COL_INFO,\r\nval_to_str(service_action, sanitize_val, "Unknown (0x%02x)"));\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_sanitize_flags,\r\nett_scsi_sanitize, sanitize_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_alloclen16, tvb, offset+6, 2,\r\nENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+8, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n} else if (isreq) {\r\nproto_tree_add_bitmask(tree, tvb, offset,\r\nhf_scsi_sbc_sanitize_overwrite_flags,\r\nett_scsi_sanitize_overwrite,\r\nsanitize_overwrite_fields,\r\nENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_sanitize_pattern_length,\r\ntvb, offset+2, 2,\r\nENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_sanitize_pattern,\r\ntvb, offset+4, -1,\r\nENC_NA);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_readdefectdata12 (tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, guint offset, gboolean isreq,\r\ngboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *defect_fields[] = {\r\n&hf_scsi_sbc_defect_list_format,\r\n&hf_scsi_sbc_req_plist,\r\n&hf_scsi_sbc_req_glist,\r\nNULL\r\n};\r\nif (!tree)\r\nreturn;\r\nif (isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_readdefdata_flags,\r\nett_scsi_defectdata, defect_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_alloclen32, tvb, offset+5, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+10, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_reassignblocks (tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, guint offset, gboolean isreq,\r\ngboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nstatic const int *reassign_fields[] = {\r\n&hf_scsi_sbc_reassignblocks_longlba,\r\n&hf_scsi_sbc_reassignblocks_longlist,\r\nNULL\r\n};\r\nif (!tree)\r\nreturn;\r\nif (isreq && iscdb) {\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_sbc_reassignblks_flags,\r\nett_scsi_reassign_blocks, reassign_fields, ENC_BIG_ENDIAN);\r\nproto_tree_add_bitmask(tree, tvb, offset+4, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_serviceactionin16 (tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, guint offset, gboolean isreq,\r\ngboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nguint8 service_action;\r\nguint32 block_len;\r\nguint64 len, tot_len;\r\nconst char *un;\r\nproto_item *it = NULL;\r\nif (isreq && iscdb) {\r\nservice_action = tvb_get_guint8 (tvb, offset) & 0x1F;\r\nif(cdata && cdata->itlq){\r\ncdata->itlq->flags=service_action;\r\n}\r\nswitch(service_action){\r\ncase SERVICE_READ_CAPACITY16:\r\ncol_append_str(pinfo->cinfo, COL_INFO, " READCAPACITY16");\r\nif (!tree)\r\nreturn;\r\nproto_tree_add_item (tree, hf_scsi_sbc_service_action, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset += 9;\r\nproto_tree_add_item (tree, hf_scsi_sbc_alloclen32, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 5;\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\noffset++;\r\nbreak;\r\ncase SERVICE_READ_LONG16:\r\ncol_append_str(pinfo->cinfo, COL_INFO, " READ_LONG16");\r\nif (!tree)\r\nreturn;\r\nproto_tree_add_item (tree, hf_scsi_sbc_service_action, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item (tree, hf_scsi_sbc_lba64_address, tvb, offset, 8, ENC_BIG_ENDIAN);\r\noffset+=8;\r\noffset+=2;\r\nproto_tree_add_item (tree, hf_scsi_sbc_alloclen16, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset+=2;\r\noffset++;\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\noffset++;\r\nbreak;\r\ncase SERVICE_GET_LBA_STATUS:\r\ncol_append_str(pinfo->cinfo, COL_INFO, " GET_LBA_STATUS");\r\nif (!tree)\r\nreturn;\r\nproto_tree_add_item (tree, hf_scsi_sbc_service_action, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item (tree, hf_scsi_sbc_get_lba_status_lba, tvb, offset, 8, ENC_BIG_ENDIAN);\r\noffset += 8;\r\nproto_tree_add_item (tree, hf_scsi_sbc_alloclen32, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\noffset++;\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\noffset++;\r\nbreak;\r\ncase SERVICE_REPORT_REFERRALS:\r\ncol_append_str(pinfo->cinfo, COL_INFO, " REPORT_REFERRALS");\r\nif (!tree)\r\nreturn;\r\nproto_tree_add_item (tree, hf_scsi_sbc_service_action, tvb, offset, 1, ENC_BIG_ENDIAN);\r\noffset++;\r\nproto_tree_add_item (tree, hf_scsi_sbc_lba64_address, tvb, offset, 8, ENC_BIG_ENDIAN);\r\noffset += 8;\r\nproto_tree_add_item (tree, hf_scsi_sbc_alloclen32, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset +=4;\r\noffset++;\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\noffset++;\r\nbreak;\r\ndefault:\r\ncol_append_str(pinfo->cinfo, COL_INFO, " RESERVED");\r\nif (!tree)\r\nreturn;\r\nproto_tree_add_uint_format_value(tree, hf_scsi_sbc_service_action, tvb, offset, 1, service_action, "Reserved (0x%x)", service_action);\r\nbreak;\r\n};\r\n} else if (!iscdb) {\r\nif (!tree)\r\nreturn;\r\nif(cdata && cdata->itlq){\r\nswitch(cdata->itlq->flags){\r\ncase SERVICE_READ_CAPACITY16:\r\nlen = tvb_get_ntoh64 (tvb, offset);\r\nblock_len = tvb_get_ntohl (tvb, offset+8);\r\ntot_len=((len/1024)*block_len)/1024;\r\nun="MB";\r\nif(tot_len>20000){\r\ntot_len/=1024;\r\nun="GB";\r\n}\r\nit = proto_tree_add_item (tree, hf_scsi_sbc_lba64_address, tvb, offset, 8, ENC_BIG_ENDIAN);\r\nproto_item_append_text (it, " (%" G_GINT64_MODIFIER "u %s)", tot_len, un);\r\nproto_tree_add_item (tree, hf_scsi_sbc_blocksize, tvb, offset+8, 4, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_prot_en, tvb, offset+12, 1, ENC_BIG_ENDIAN);\r\nif (tvb_get_guint8(tvb, offset+12) & 0x01) {\r\nproto_tree_add_item (tree, hf_scsi_sbc_ptype, tvb, offset+12, 1, ENC_BIG_ENDIAN);\r\n}\r\nproto_tree_add_item (tree, hf_scsi_sbc_p_i_exponent, tvb, offset+13, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_lbppbe, tvb, offset+13, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_lbpme, tvb, offset+14, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_lbprz, tvb, offset+14, 1, ENC_BIG_ENDIAN);\r\nproto_tree_add_item (tree, hf_scsi_sbc_lalba, tvb, offset+14, 2, ENC_BIG_ENDIAN);\r\nbreak;\r\ncase SERVICE_GET_LBA_STATUS:\r\nproto_tree_add_item (tree, hf_scsi_sbc_get_lba_status_data_length, tvb, offset, 4, ENC_BIG_ENDIAN);\r\noffset += 4;\r\noffset += 4;\r\nwhile (tvb_captured_length_remaining(tvb, offset) >= 16) {\r\nproto_tree *tr;\r\nguint64 lba;\r\nguint32 num_blocks;\r\nguint8 type;\r\ntr = proto_tree_add_subtree(tree, tvb, offset, 16, ett_scsi_lba_status_descriptor, &it, "LBA Status Descriptor: ");\r\nproto_tree_add_item (tr, hf_scsi_sbc_get_lba_status_lba, tvb, offset, 8, ENC_BIG_ENDIAN);\r\nlba = tvb_get_ntoh64(tvb, offset);\r\noffset += 8;\r\nproto_tree_add_item (tr, hf_scsi_sbc_get_lba_status_num_blocks, tvb, offset, 4, ENC_BIG_ENDIAN);\r\nnum_blocks = tvb_get_ntohl(tvb, offset);\r\noffset += 4;\r\nproto_tree_add_item (tr, hf_scsi_sbc_get_lba_status_provisioning_status, tvb, offset, 1, ENC_BIG_ENDIAN);\r\ntype = tvb_get_guint8(tvb, offset) & 0x07;\r\noffset++;\r\noffset += 3;\r\nproto_item_append_text (it, "%" G_GINT64_MODIFIER "u-%" G_GINT64_MODIFIER "u %s",\r\nlba,\r\nlba + num_blocks - 1,\r\nval_to_str(type, scsi_provisioning_type_val, "Unknown (0x%02x)")\r\n);\r\n}\r\nbreak;\r\n}\r\n}\r\n}\r\n}\r\nstatic void\r\ndissect_sbc_serviceactionout16(tvbuff_t *tvb, packet_info *pinfo _U_,\r\nproto_tree *tree, guint offset, gboolean isreq,\r\ngboolean iscdb,\r\nguint payload_len _U_, scsi_task_data_t *cdata _U_)\r\n{\r\nguint8 service_action;\r\nif (isreq && iscdb) {\r\nservice_action = tvb_get_guint8 (tvb, offset) & 0x1F;\r\nif(cdata && cdata->itlq){\r\ncdata->itlq->flags=service_action;\r\n}\r\nswitch(service_action){\r\ncase SERVICE_WRITE_LONG16:\r\ncol_append_str(pinfo->cinfo, COL_INFO, " WRITE_LONG16");\r\nif (!tree)\r\nreturn;\r\nproto_tree_add_uint_format_value(tree, hf_scsi_sbc_service_action, tvb, offset, 1, service_action, "Write Long (16) (0x%x)", service_action);\r\noffset++;\r\nproto_tree_add_item(tree, hf_scsi_sbc_lba64_address, tvb, offset, 8, ENC_BIG_ENDIAN);\r\noffset+=8;\r\noffset+=2;\r\nproto_tree_add_item(tree, hf_scsi_sbc_alloclen16, tvb, offset, 2, ENC_BIG_ENDIAN);\r\noffset+=2;\r\noffset++;\r\nproto_tree_add_bitmask(tree, tvb, offset, hf_scsi_control,\r\nett_scsi_control, cdb_control_fields, ENC_BIG_ENDIAN);\r\noffset++;\r\nbreak;\r\ndefault:\r\ncol_append_str(pinfo->cinfo, COL_INFO, " RESERVED");\r\nif (!tree)\r\nreturn;\r\nproto_tree_add_uint_format_value(tree, hf_scsi_sbc_service_action, tvb, offset, 1, service_action, "Reserved (0x%x)", service_action);\r\nbreak;\r\n};\r\n}\r\n}\r\nvoid\r\nproto_register_scsi_sbc(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_scsi_sbc_opcode,\r\n{"SBC Opcode", "scsi_sbc.opcode", FT_UINT8, BASE_HEX | BASE_EXT_STRING,\r\n&scsi_sbc_vals_ext, 0x0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_service_action,\r\n{"Service Action", "scsi_sbc.sa", FT_UINT8, BASE_HEX,\r\nVALS(service_action_vals), 0x1F, "Unknown", HFILL}},\r\n{ &hf_scsi_sbc_formatunit_flags,\r\n{"Flags", "scsi_sbc.formatunit.flags", FT_UINT8, BASE_HEX, NULL, 0xF8,\r\nNULL, HFILL}},\r\n{ &hf_scsi_sbc_defect_list_format,\r\n{"Defect List Format", "scsi_sbc.defect_list_format", FT_UINT8, BASE_DEC,\r\nNULL, 0x7, NULL, HFILL}},\r\n{ &hf_scsi_sbc_formatunit_vendor,\r\n{"Vendor Unique", "scsi_sbc.formatunit.vendor", FT_UINT8, BASE_HEX, NULL,\r\n0x0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_formatunit_interleave,\r\n{"Interleave", "scsi_sbc.formatunit.interleave", FT_UINT16, BASE_HEX,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_rdwr6_lba,\r\n{"Logical Block Address (LBA)", "scsi_sbc.rdwr6.lba", FT_UINT24, BASE_DEC,\r\nNULL, 0x0FFFFF, NULL, HFILL}},\r\n{ &hf_scsi_sbc_rdwr6_xferlen,\r\n{"Transfer Length", "scsi_sbc.rdwr6.xferlen", FT_UINT24, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}},\r\n{ &hf_scsi_sbc_rdwr10_lba,\r\n{"Logical Block Address (LBA)", "scsi_sbc.rdwr10.lba", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_rdwr10_xferlen,\r\n{"Transfer Length", "scsi_sbc.rdwr10.xferlen", FT_UINT16, BASE_DEC, NULL,\r\n0x0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_rdwr12_xferlen,\r\n{"Transfer Length", "scsi_sbc.rdwr12.xferlen", FT_UINT32, BASE_DEC, NULL,\r\n0x0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_rdwr16_lba,\r\n{"Logical Block Address (LBA)", "scsi_sbc.rdwr16.lba", FT_BYTES, BASE_NONE,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_ssu_immed,\r\n{"Immediate", "scsi_sbc.ssu.immediate", FT_BOOLEAN, 8, NULL,\r\n0x01, NULL, HFILL}},\r\n{ &hf_scsi_sbc_ssu_pwr_cond,\r\n{"Power Conditions", "scsi_sbc.ssu.pwr", FT_UINT8, BASE_HEX,\r\nVALS (scsi_ssu_pwrcnd_val), 0xF0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_ssu_loej,\r\n{"LOEJ", "scsi_sbc.ssu.loej", FT_BOOLEAN, 8, NULL, 0x2, NULL,\r\nHFILL}},\r\n{ &hf_scsi_sbc_ssu_start,\r\n{"Start", "scsi_sbc.ssu.start", FT_BOOLEAN, 8, NULL, 0x1,\r\nNULL, HFILL}},\r\n{ &hf_scsi_sbc_bytchk,\r\n{"BYTCHK", "scsi_sbc.bytchk", FT_BOOLEAN, 8,\r\nNULL, 0x02, NULL, HFILL}},\r\n#if 0\r\n{ &hf_scsi_sbc_verify_reladdr,\r\n{"RELADDR", "scsi_sbc.verify.reladdr", FT_BOOLEAN, 8, NULL,\r\n0x1, NULL, HFILL}},\r\n#endif\r\n{ &hf_scsi_sbc_verify_lba,\r\n{"LBA", "scsi_sbc.verify.lba", FT_UINT32, BASE_DEC, NULL, 0x0, NULL,\r\nHFILL}},\r\n{ &hf_scsi_sbc_verify_lba64,\r\n{"LBA", "scsi_sbc.verify.lba64", FT_UINT64, BASE_DEC, NULL, 0x0, NULL,\r\nHFILL}},\r\n{ &hf_scsi_sbc_verify_vlen,\r\n{"Verification Length", "scsi_sbc.verify.vlen", FT_UINT16,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_verify_vlen32,\r\n{"Verification Length", "scsi_sbc.verify.vlen32", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_wrverify_lba,\r\n{"LBA", "scsi_sbc.wrverify.lba", FT_UINT32, BASE_DEC, NULL, 0x0, NULL,\r\nHFILL}},\r\n{ &hf_scsi_sbc_wrverify_xferlen,\r\n{"Transfer Length", "scsi_sbc.wrverify.xferlen", FT_UINT16, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_wrverify_lba64,\r\n{"LBA", "scsi_sbc.wrverify.lba64", FT_UINT64, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}},\r\n{ &hf_scsi_sbc_wrverify_xferlen32,\r\n{"Transfer Length", "scsi_sbc.wrverify.xferlen32", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL}},\r\n#if 0\r\n{ &hf_scsi_sbc_readcapacity_flags,\r\n{"Flags", "scsi_sbc.readcapacity.flags", FT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL}},\r\n#endif\r\n{ &hf_scsi_sbc_readdefdata_flags,\r\n{"Flags", "scsi_sbc.readdefdata.flags", FT_UINT8, BASE_HEX, NULL, 0x0, NULL,\r\nHFILL}},\r\n{ &hf_scsi_sbc_reassignblks_flags,\r\n{"Flags", "scsi_sbc.reassignblks.flags", FT_UINT8, BASE_HEX, NULL, 0x0, NULL,\r\nHFILL}},\r\n{ &hf_scsi_sbc_read_flags,\r\n{"Flags", "scsi_sbc.read.flags", FT_UINT8, BASE_HEX, NULL, 0x0, NULL,\r\nHFILL}},\r\n{ &hf_scsi_sbc_alloclen32,\r\n{"Allocation Length", "scsi_sbc.alloclen32", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_alloclen16,\r\n{"Allocation Length", "scsi_sbc.alloclen16", FT_UINT16, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_lba64_address,\r\n{"Logical Block Address", "scsi_sbc.lba64_add", FT_UINT64, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_fuflags_fmtpinfo,\r\n{"FMTPINFO", "scsi_sbc.format_unit.fmtpinfo", FT_BOOLEAN, 8,\r\nNULL, 0x80, NULL, HFILL}},\r\n{ &hf_scsi_sbc_fuflags_rto_req,\r\n{"RTO_REQ", "scsi_sbc.format_unit.rto_req", FT_BOOLEAN, 8,\r\nNULL, 0x40, NULL, HFILL}},\r\n{ &hf_scsi_sbc_fuflags_longlist,\r\n{"LONGLIST", "scsi_sbc.format_unit.longlist", FT_BOOLEAN, 8,\r\nNULL, 0x20, NULL, HFILL}},\r\n{ &hf_scsi_sbc_fuflags_fmtdata,\r\n{"FMTDATA", "scsi_sbc.format_unit.fmtdata", FT_BOOLEAN, 8,\r\nNULL, 0x10, NULL, HFILL}},\r\n{ &hf_scsi_sbc_fuflags_cmplist,\r\n{"CMPLIST", "scsi_sbc.format_unit.cmplist", FT_BOOLEAN, 8,\r\nNULL, 0x08, NULL, HFILL}},\r\n{ &hf_scsi_sbc_prefetch_flags,\r\n{"Flags", "scsi_sbc.prefetch.flags", FT_UINT8, BASE_HEX, NULL, 0x0, NULL,\r\nHFILL}},\r\n{ &hf_scsi_sbc_prefetch_immed,\r\n{"Immediate", "scsi_sbc.prefetch.immediate", FT_BOOLEAN, 8, NULL,\r\n0x2, NULL, HFILL}},\r\n{ &hf_scsi_sbc_group,\r\n{"Group", "scsi_sbc.group", FT_UINT8, BASE_HEX, NULL,\r\n0x1f, NULL, HFILL}},\r\n{ &hf_scsi_sbc_rdprotect,\r\n{"RDPROTECT", "scsi_sbc.rdprotect", FT_UINT8, BASE_HEX,\r\nNULL, 0xe0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_dpo,\r\n{"DPO", "scsi_sbc.dpo", FT_BOOLEAN, 8,\r\nTFS(&dpo_tfs), 0x10, "DisablePageOut: Whether the device should cache the data or not", HFILL}},\r\n{ &hf_scsi_sbc_fua,\r\n{"FUA", "scsi_sbc.fua", FT_BOOLEAN, 8,\r\nTFS(&fua_tfs), 0x08, "ForceUnitAccess: Whether to allow reading from the cache or not", HFILL}},\r\n{ &hf_scsi_sbc_fua_nv,\r\n{"FUA_NV", "scsi_sbc.fua_nv", FT_BOOLEAN, 8,\r\nTFS(&fua_nv_tfs), 0x02, "ForceUnitAccess_NonVolatile: Whether to allow reading from non-volatile cache or not", HFILL}},\r\n{ &hf_scsi_sbc_blocksize,\r\n{"Block size in bytes", "scsi_sbc.blocksize", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_returned_lba,\r\n{"Returned LBA", "scsi_sbc.returned_lba", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_req_plist,\r\n{"REQ_PLIST", "scsi_sbc.req_plist", FT_BOOLEAN, 8,\r\nNULL, 0x10, NULL, HFILL}},\r\n{ &hf_scsi_sbc_req_glist,\r\n{"REQ_GLIST", "scsi_sbc.req_glist", FT_BOOLEAN, 8,\r\nNULL, 0x08, NULL, HFILL}},\r\n{ &hf_scsi_sbc_corrct,\r\n{"CORRCT", "scsi_sbc.corrct", FT_BOOLEAN, 8,\r\nNULL, 0x02, NULL, HFILL}},\r\n{ &hf_scsi_sbc_corrct_flags,\r\n{"Flags", "scsi_sbc.corrct_flags", FT_UINT8, BASE_HEX,\r\nNULL, 0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_reassignblocks_longlba,\r\n{"LongLBA", "scsi_sbc.reassignblocks.longlba", FT_BOOLEAN, 8,\r\nNULL, 0x02, NULL, HFILL}},\r\n{ &hf_scsi_sbc_reassignblocks_longlist,\r\n{"LongList", "scsi_sbc.reassignblocks.longlist", FT_BOOLEAN, 8,\r\nNULL, 0x01, NULL, HFILL}},\r\n{ &hf_scsi_sbc_ssu_immed_flags,\r\n{"Immed flags", "scsi_sbc.ssu.immed_flags", FT_UINT8, BASE_HEX,\r\nNULL, 0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_ssu_pwr_flags,\r\n{"Pwr flags", "scsi_sbc.ssu.pwr_flags", FT_UINT8, BASE_HEX,\r\nNULL, 0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_synccache_flags,\r\n{"Flags", "scsi_sbc.synccache.flags", FT_UINT8, BASE_HEX, NULL, 0x0, NULL,\r\nHFILL}},\r\n{ &hf_scsi_sbc_synccache_immed,\r\n{"Immediate", "scsi_sbc.synccache.immediate", FT_BOOLEAN, 8, NULL,\r\n0x02, NULL, HFILL}},\r\n{ &hf_scsi_sbc_synccache_sync_nv,\r\n{"SYNC_NV", "scsi_sbc.synccache.sync_nv", FT_BOOLEAN, 8, NULL,\r\n0x04, NULL, HFILL}},\r\n{ &hf_scsi_sbc_vrprotect,\r\n{"VRPROTECT", "scsi_sbc.vrprotect", FT_UINT8, BASE_HEX,\r\nNULL, 0xe0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_verify_flags,\r\n{"Flags", "scsi_sbc.verify_flags", FT_UINT8, BASE_HEX,\r\nNULL, 0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_wrprotect,\r\n{"WRPROTECT", "scsi_sbc.wrprotect", FT_UINT8, BASE_HEX,\r\nNULL, 0xe0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_wrverify_flags,\r\n{"Flags", "scsi_sbc.wrverify_flags", FT_UINT8, BASE_HEX,\r\nNULL, 0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_writesame_flags,\r\n{"Flags", "scsi_sbc.writesame_flags", FT_UINT8, BASE_HEX,\r\nNULL, 0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_anchor,\r\n{"ANCHOR", "scsi_sbc.anchor", FT_BOOLEAN, 8, NULL,\r\n0x10, NULL, HFILL}},\r\n{ &hf_scsi_sbc_unmap,\r\n{"UNMAP", "scsi_sbc.unmap", FT_BOOLEAN, 8, NULL,\r\n0x08, NULL, HFILL}},\r\n{ &hf_scsi_sbc_pbdata,\r\n{"PBDATA", "scsi_sbc.pbdata", FT_BOOLEAN, 8, NULL,\r\n0x04, NULL, HFILL}},\r\n{ &hf_scsi_sbc_lbdata,\r\n{"LBDATA", "scsi_sbc.lbdata", FT_BOOLEAN, 8, NULL,\r\n0x02, NULL, HFILL}},\r\n{ &hf_scsi_sbc_xdread_flags,\r\n{"Flags", "scsi_sbc.xdread.flags", FT_UINT8, BASE_HEX, NULL, 0x0, NULL,\r\nHFILL}},\r\n{ &hf_scsi_sbc_xorpinfo,\r\n{"XORPINFO", "scsi_sbc.xorpinfo", FT_BOOLEAN, 8, NULL,\r\n0x01, NULL, HFILL}},\r\n{ &hf_scsi_sbc_disable_write,\r\n{"DISABLE_WRITE", "scsi_sbc.disable_write", FT_BOOLEAN, 8, NULL,\r\n0x04, NULL, HFILL}},\r\n{ &hf_scsi_sbc_xdwrite_flags,\r\n{"Flags", "scsi_sbc.xdwrite.flags", FT_UINT8, BASE_HEX, NULL, 0x0, NULL,\r\nHFILL}},\r\n{ &hf_scsi_sbc_xdwriteread_flags,\r\n{"Flags", "scsi_sbc.xdwriteread.flags", FT_UINT8, BASE_HEX, NULL, 0x0, NULL,\r\nHFILL}},\r\n{ &hf_scsi_sbc_xpwrite_flags,\r\n{"Flags", "scsi_sbc.xpwrite.flags", FT_UINT8, BASE_HEX, NULL, 0x0, NULL,\r\nHFILL}},\r\n{ &hf_scsi_sbc_unmap_anchor,\r\n{"ANCHOR", "scsi_sbc.unmap.anchor", FT_BOOLEAN, 8, NULL,\r\n0x01, NULL, HFILL}},\r\n{ &hf_scsi_sbc_unmap_flags,\r\n{"Flags", "scsi_sbc.unmap_flags", FT_UINT8, BASE_HEX,\r\nNULL, 0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_unmap_data_length,\r\n{"Data Length", "scsi_sbc.unmap.data_length", FT_UINT16, BASE_DEC,\r\nNULL, 0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_unmap_block_descriptor_data_length,\r\n{"Block Descriptor Data Length", "scsi_sbc.unmap.block_descriptor_data_length", FT_UINT16, BASE_DEC,\r\nNULL, 0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_unmap_lba,\r\n{"LBA", "scsi_sbc.unmap.lba", FT_UINT64, BASE_DEC,\r\nNULL, 0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_unmap_num_blocks,\r\n{"Num Blocks", "scsi_sbc.unmap.num_blocks", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_ptype,\r\n{"PTYPE", "scsi_sbc.ptype", FT_UINT8, BASE_DEC,\r\nVALS(scsi_ptype_val), 0x0e, NULL, HFILL}},\r\n{ &hf_scsi_sbc_prot_en,\r\n{"PROT_EN", "scsi_sbc.prot_en", FT_BOOLEAN, 8,\r\nNULL, 0x01, NULL, HFILL}},\r\n{ &hf_scsi_sbc_p_i_exponent,\r\n{"P_I_EXPONENT", "scsi_sbc.p_i_exponent", FT_UINT8, BASE_DEC,\r\nNULL, 0xf0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_lbppbe,\r\n{"LOGICAL_BLOCKS_PER_PHYSICAL_BLOCK_EXPONENT", "scsi_sbc.lbppbe", FT_UINT8, BASE_DEC,\r\nNULL, 0x0f, NULL, HFILL}},\r\n{ &hf_scsi_sbc_lbpme,\r\n{"LBPME (logical block provisioning management enabled) / TPE", "scsi_sbc.lbpme", FT_BOOLEAN, 8,\r\nNULL, 0x80, NULL, HFILL}},\r\n{ &hf_scsi_sbc_lbprz,\r\n{"LBPRZ (logical block provisioning read zeros) / TPRZ", "scsi_sbc.lbprz", FT_BOOLEAN, 8,\r\nNULL, 0x40, NULL, HFILL}},\r\n{ &hf_scsi_sbc_lalba,\r\n{"LOWEST_ALIGNED_LBA", "scsi_sbc.lalba", FT_UINT16, BASE_DEC,\r\nNULL, 0x3fff, NULL, HFILL}},\r\n{ &hf_scsi_sbc_get_lba_status_lba,\r\n{"LBA", "scsi_sbc.get_lba_status.start_lba", FT_UINT64, BASE_DEC,\r\nNULL, 0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_get_lba_status_data_length,\r\n{"Data Length", "scsi_sbc.get_lba_status.data_length", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_get_lba_status_num_blocks,\r\n{"Num Blocks", "scsi_sbc.get_lba_status.num_blocks", FT_UINT32, BASE_DEC,\r\nNULL, 0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_get_lba_status_provisioning_status,\r\n{"Provisioning Type", "scsi_sbc.get_lba_status.provisioning_type", FT_UINT8, BASE_DEC,\r\nVALS(scsi_provisioning_type_val), 0x07, NULL, HFILL}},\r\n{ &hf_scsi_sbc_sanitize_sa,\r\n{"Service Action", "scsi_sbc.sanitize.sa", FT_UINT8, BASE_HEX,\r\nVALS(sanitize_val), 0x1f, NULL, HFILL}},\r\n{ &hf_scsi_sbc_sanitize_ause,\r\n{"AUSE", "scsi_sbc.sanitize.ause", FT_BOOLEAN, 8, NULL,\r\n0x20, NULL, HFILL}},\r\n{ &hf_scsi_sbc_sanitize_immed,\r\n{"IMMED", "scsi_sbc.sanitize.immed", FT_BOOLEAN, 8, NULL,\r\n0x80, NULL, HFILL}},\r\n{ &hf_scsi_sbc_sanitize_flags,\r\n{"Flags", "scsi_sbc.sanitize_flags", FT_UINT8, BASE_HEX,\r\nNULL, 0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_sanitize_overwrite_flags,\r\n{"Flags", "scsi_sbc.sanitize_overwrite_flags", FT_UINT8, BASE_HEX,\r\nNULL, 0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_sanitize_invert,\r\n{"INVERT", "scsi_sbc.sanitize.invert", FT_BOOLEAN, 8, NULL,\r\n0x80, NULL, HFILL}},\r\n{ &hf_scsi_sbc_sanitize_test,\r\n{"TEST", "scsi_sbc.sanitize.test", FT_UINT8, BASE_HEX, NULL,\r\n0x60, NULL, HFILL}},\r\n{ &hf_scsi_sbc_sanitize_owcount,\r\n{"Overwrite Count", "scsi_sbc.sanitize.overwrite_count", FT_UINT8, BASE_HEX, NULL,\r\n0x1f, NULL, HFILL}},\r\n{ &hf_scsi_sbc_sanitize_pattern_length,\r\n{"Initialization Pattern Length", "scsi_sbc.sanitize.pattern_length", FT_UINT16, BASE_DEC, NULL,\r\n0, NULL, HFILL}},\r\n{ &hf_scsi_sbc_sanitize_pattern,\r\n{"Initialization Pattern", "scsi_sbc.sanitize.pattern", FT_BYTES, BASE_NONE, NULL,\r\n0, NULL, HFILL}},\r\n};\r\nstatic gint *ett[] = {\r\n&ett_scsi_format_unit,\r\n&ett_scsi_prefetch,\r\n&ett_scsi_rdwr,\r\n&ett_scsi_xdread,\r\n&ett_scsi_xdwrite,\r\n&ett_scsi_xdwriteread,\r\n&ett_scsi_xpwrite,\r\n&ett_scsi_defectdata,\r\n&ett_scsi_corrct,\r\n&ett_scsi_reassign_blocks,\r\n&ett_scsi_ssu_immed,\r\n&ett_scsi_ssu_pwr,\r\n&ett_scsi_synccache,\r\n&ett_scsi_verify,\r\n&ett_scsi_wrverify,\r\n&ett_scsi_writesame,\r\n&ett_scsi_unmap,\r\n&ett_scsi_unmap_block_descriptor,\r\n&ett_scsi_lba_status_descriptor,\r\n&ett_scsi_sanitize,\r\n&ett_scsi_sanitize_overwrite\r\n};\r\nproto_scsi_sbc = proto_register_protocol("SCSI_SBC", "SCSI_SBC", "scsi_sbc");\r\nproto_register_field_array(proto_scsi_sbc, hf, array_length(hf));\r\nproto_register_subtree_array(ett, array_length(ett));\r\n}
