void\r\ngmr1_get_msg_params(gmr1_pd_e pd, guint8 oct, const gchar **msg_str,\r\nint *ett_tree, int *hf_idx, gmr1_msg_func_t *msg_func_p)\r\n{\r\nswitch (pd) {\r\ncase GMR1_PD_RR:\r\ngmr1_get_msg_rr_params(oct, 1, msg_str, ett_tree, hf_idx, msg_func_p);\r\nbreak;\r\ndefault:\r\n*msg_str = NULL;\r\n*ett_tree = -1;\r\n*hf_idx = -1;\r\n*msg_func_p = NULL;\r\n}\r\n}\r\nvoid\r\nproto_register_gmr1_common(void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{ &hf_gmr1_skip_ind,\r\n{ "Skip Indicator", "gmr1.skip_ind",\r\nFT_UINT8, BASE_DEC, NULL, 0xf0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gmr1_l3_pd,\r\n{ "Protocol discriminator","gmr1.l3_protocol_discriminator",\r\nFT_UINT8, BASE_DEC, VALS(gmr1_pd_vals), 0x0f,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gmr1_elem_id,\r\n{ "Element ID", "gmr1.ie.elem_id",\r\nFT_UINT8, BASE_HEX, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_gmr1_len,\r\n{ "Length", "gmr1.ie.length",\r\nFT_UINT8, BASE_DEC, NULL, 0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_com_cm2_spare1,\r\n{ "Spare", "gmr1.common.cm2.spare1",\r\nFT_UINT8, BASE_DEC, NULL, 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_com_cm2_revision,\r\n{ "Revision Level", "gmr1.common.cm2.revision",\r\nFT_UINT8, BASE_DEC, VALS(com_cm2_revision_vals), 0x60,\r\nNULL, HFILL }\r\n},\r\n{ &hf_com_cm2_early_send,\r\n{ "ES IND", "gmr1.common.cm2.early_send",\r\nFT_UINT8, BASE_DEC, VALS(com_cm2_early_send_vals), 0x10,\r\nNULL, HFILL }\r\n},\r\n{ &hf_com_cm2_a5_1,\r\n{ "A5/1", "gmr1.common.cm2.a5_1",\r\nFT_UINT8, BASE_DEC, VALS(com_cm2_a5_1_vals), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_com_cm2_mes_type,\r\n{ "MES terminal type", "gmr1.common.cm2.mes_type",\r\nFT_UINT8, BASE_DEC, VALS(com_cm2_mes_type_vals), 0x07,\r\nNULL, HFILL }\r\n},\r\n{ &hf_com_cm2_spare2,\r\n{ "Spare", "gmr1.common.cm2.spare2",\r\nFT_UINT8, BASE_DEC, NULL, 0xc0,\r\nNULL, HFILL }\r\n},\r\n{ &hf_com_cm2_ss_screen_ind,\r\n{ "SS Screening Indicator", "gmr1.common.cm2.ss_screen_ind",\r\nFT_UINT8, BASE_DEC, VALS(com_cm2_ss_screen_ind_vals), 0x30,\r\nNULL, HFILL }\r\n},\r\n{ &hf_com_cm2_sms_cap,\r\n{ "SM capability", "gmr1.common.cm2.sms_cap",\r\nFT_UINT8, BASE_DEC, VALS(com_cm2_sms_cap_vals), 0x08,\r\nNULL, HFILL }\r\n},\r\n{ &hf_com_cm2_spare3,\r\n{ "Spare", "gmr1.common.cm2.spare3",\r\nFT_UINT8, BASE_DEC, NULL, 0x06,\r\nNULL, HFILL }\r\n},\r\n{ &hf_com_cm2_freq_cap,\r\n{ "FC", "gmr1.common.cm2.freq_cap",\r\nFT_UINT8, BASE_DEC, VALS(com_cm2_freq_cap_vals), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_com_cm2_cm3_presence,\r\n{ "CM3", "gmr1.common.cm2.cm3_presence",\r\nFT_UINT8, BASE_DEC, VALS(com_cm3_presence_vals), 0x80,\r\nNULL, HFILL }\r\n},\r\n{ &hf_com_cm2_spare4,\r\n{ "Spare", "gmr1.common.cm2.spare4",\r\nFT_UINT8, BASE_DEC, NULL, 0x7c,\r\nNULL, HFILL }\r\n},\r\n{ &hf_com_cm2_a5_3,\r\n{ "A5/3", "gmr1.common.cm2.a5_3",\r\nFT_UINT8, BASE_DEC, VALS(com_cm2_a5_3_vals), 0x02,\r\nNULL, HFILL }\r\n},\r\n{ &hf_com_cm2_a5_2_gmr1,\r\n{ "A5/2 GMR-1", "gmr1.common.cm2.a5_2_gmr1",\r\nFT_UINT8, BASE_DEC, VALS(com_cm2_a5_2_gmr1_vals), 0x01,\r\nNULL, HFILL }\r\n},\r\n{ &hf_com_spare_nibble,\r\n{ "Spare Half Octet", "gmr1.common.spare_nibble",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }\r\n},\r\n};\r\nproto_gmr1_common = proto_register_protocol("GEO-Mobile Radio (1) Common", "GMR-1 Common", "gmr1.common");\r\nproto_register_field_array(proto_gmr1_common, hf, array_length(hf));\r\n}
