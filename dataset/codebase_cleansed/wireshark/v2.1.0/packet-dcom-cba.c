static int\r\ndissect_ICBABrowse_get_Count_resp(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 u32Count;\r\nguint32 u32HResult;\r\noffset = dissect_dcom_that(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_browse_count, &u32Count);\r\noffset = dissect_dcom_HRESULT(tvb, offset, pinfo, tree, di, drep,\r\n&u32HResult);\r\nif (u32HResult) {\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, "-> %s",\r\nval_to_str(u32HResult, dcom_hresult_vals, "Unknown (0x%08x)") );\r\n} else {\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " Cnt=%u -> S_OK", u32Count);\r\n}\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_ICBABrowse_BrowseItems_rqst(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 u32Offset;\r\nguint32 u32MaxReturn;\r\noffset = dissect_dcom_this(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_browse_offset, &u32Offset);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_browse_max_return, &u32MaxReturn);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " Offset=%u MaxReturn=%u",\r\nu32Offset, u32MaxReturn);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_ICBABrowse_BrowseItems_resp(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 u32Pointer;\r\nguint32 u32HResult;\r\noffset = dissect_dcom_that(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_dcerpc_pointer(tvb, offset, pinfo, tree, di, drep,\r\n&u32Pointer);\r\nif (u32Pointer) {\r\noffset = dissect_dcom_VARIANT(tvb, offset, pinfo, tree, di, drep, hf_cba_browse_item);\r\n}\r\noffset = dissect_dcom_dcerpc_pointer(tvb, offset, pinfo, tree, di, drep,\r\n&u32Pointer);\r\nif (u32Pointer) {\r\noffset = dissect_dcom_VARIANT(tvb, offset, pinfo, tree, di, drep, hf_cba_browse_data_type);\r\n}\r\noffset = dissect_dcom_dcerpc_pointer(tvb, offset, pinfo, tree, di, drep,\r\n&u32Pointer);\r\nif (u32Pointer) {\r\noffset = dissect_dcom_VARIANT(tvb, offset, pinfo, tree, di, drep, hf_cba_browse_access_right);\r\n}\r\noffset = dissect_dcom_HRESULT(tvb, offset, pinfo, tree, di, drep,\r\n&u32HResult);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " -> %s",\r\nval_to_str(u32HResult, dcom_hresult_vals, "Unknown (0x%08x)") );\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_ICBABrowse2_get_Count2_rqst(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 u32Selector;\r\noffset = dissect_dcom_this(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_browse_selector, &u32Selector);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " Selector=%u",\r\nu32Selector);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_ICBABrowse2_BrowseItems2_rqst(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 u32Selector;\r\nguint32 u32Offset;\r\nguint32 u32MaxReturn;\r\noffset = dissect_dcom_this(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_browse_selector, &u32Selector);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_browse_offset, &u32Offset);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_browse_max_return, &u32MaxReturn);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " Sel=%u Offset=%u MaxReturn=%u",\r\nu32Selector, u32Offset, u32MaxReturn);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_ICBABrowse2_BrowseItems2_resp(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 u32Pointer;\r\nguint32 u32HResult;\r\noffset = dissect_dcom_that(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_dcerpc_pointer(tvb, offset, pinfo, tree, di, drep,\r\n&u32Pointer);\r\nif (u32Pointer) {\r\noffset = dissect_dcom_VARIANT(tvb, offset, pinfo, tree, di, drep, hf_cba_browse_item);\r\n}\r\noffset = dissect_dcom_dcerpc_pointer(tvb, offset, pinfo, tree, di, drep,\r\n&u32Pointer);\r\nif (u32Pointer) {\r\noffset = dissect_dcom_VARIANT(tvb, offset, pinfo, tree, di, drep, hf_cba_browse_info1);\r\n}\r\noffset = dissect_dcom_dcerpc_pointer(tvb, offset, pinfo, tree, di, drep,\r\n&u32Pointer);\r\nif (u32Pointer) {\r\noffset = dissect_dcom_VARIANT(tvb, offset, pinfo, tree, di, drep, hf_cba_browse_info2);\r\n}\r\noffset = dissect_dcom_HRESULT(tvb, offset, pinfo, tree, di, drep,\r\n&u32HResult);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " -> %s",\r\nval_to_str(u32HResult, dcom_hresult_vals, "Unknown (0x%08x)") );\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_ICBAPersist2_Save2_resp(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 u32Pointer;\r\nguint32 u32HResult;\r\noffset = dissect_dcom_that(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_dcerpc_pointer(tvb, offset, pinfo, tree, di, drep,\r\n&u32Pointer);\r\nif (u32Pointer) {\r\noffset = dissect_dcom_VARIANT(tvb, offset, pinfo, tree, di, drep, hf_cba_save_ldev_name);\r\n}\r\noffset = dissect_dcom_dcerpc_pointer(tvb, offset, pinfo, tree, di, drep,\r\n&u32Pointer);\r\nif (u32Pointer) {\r\noffset = dissect_dcom_VARIANT(tvb, offset, pinfo, tree, di, drep, hf_cba_save_result);\r\n}\r\noffset = dissect_dcom_HRESULT(tvb, offset, pinfo, tree, di, drep,\r\n&u32HResult);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " -> %s",\r\nval_to_str(u32HResult, dcom_hresult_vals, "Unknown (0x%08x)") );\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_get_BSTR_resp(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep, int hfindex)\r\n{\r\ngchar szStr[1000];\r\nguint32 u32MaxStr = sizeof(szStr);\r\nguint32 u32Pointer;\r\nguint32 u32HResult;\r\noffset = dissect_dcom_that(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_dcerpc_pointer(tvb, offset, pinfo, tree, di, drep,\r\n&u32Pointer);\r\nif (u32Pointer) {\r\noffset = dissect_dcom_BSTR(tvb, offset, pinfo, tree, di, drep,\r\nhfindex, szStr, u32MaxStr);\r\n} else {\r\nszStr[0] = '\0';\r\n}\r\noffset = dissect_dcom_HRESULT(tvb, offset, pinfo, tree, di, drep,\r\n&u32HResult);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ": \"%s\" -> %s", szStr,\r\nval_to_str(u32HResult, dcom_hresult_vals, "Unknown (0x%08x)") );\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_get_ProductionDate_resp(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 u32HResult;\r\ngdouble r8Date;\r\noffset = dissect_dcom_that(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_DATE(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_production_date, &r8Date);\r\noffset = dissect_dcom_HRESULT(tvb, offset, pinfo, tree, di, drep,\r\n&u32HResult);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ": Date: %g -> %s",\r\nr8Date,\r\nval_to_str(u32HResult, dcom_hresult_vals, "Unknown (0x%08x)") );\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_get_SerialNo_resp(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 u32HResult;\r\nguint32 u32Pointer;\r\noffset = dissect_dcom_that(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_dcerpc_pointer(tvb, offset, pinfo, tree, di, drep,\r\n&u32Pointer);\r\nif (u32Pointer) {\r\noffset = dissect_dcom_VARIANT(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_serial_no);\r\n}\r\noffset = dissect_dcom_HRESULT(tvb, offset, pinfo, tree, di, drep,\r\n&u32HResult);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " -> %s",\r\nval_to_str(u32HResult, dcom_hresult_vals, "Unknown (0x%08x)") );\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_ICBATime_get_Time_resp(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 u32HResult;\r\ngdouble r8Date;\r\noffset = dissect_dcom_that(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_DATE(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_time, &r8Date);\r\noffset = dissect_dcom_HRESULT(tvb, offset, pinfo, tree, di, drep,\r\n&u32HResult);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ": Time: %g -> %s",\r\nr8Date,\r\nval_to_str(u32HResult, dcom_hresult_vals, "Unknown (0x%08x)") );\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_ICBATime_put_Time_rqst(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\ngdouble r8Date;\r\noffset = dissect_dcom_this(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_DATE(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_time, &r8Date);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_get_Producer_resp(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nreturn dissect_get_BSTR_resp(tvb, offset, pinfo, tree, di, drep, hf_cba_producer);\r\n}\r\nstatic int\r\ndissect_get_Product_resp(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nreturn dissect_get_BSTR_resp(tvb, offset, pinfo, tree, di, drep, hf_cba_product);\r\n}\r\nstatic int\r\ndissect_ICBAPhysicalDevice_get_LogicalDevice_rqst(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 u32Pointer;\r\ngchar szStr[1000];\r\nguint32 u32MaxStr = sizeof(szStr);\r\ngchar *call;\r\noffset = dissect_dcom_this(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_dcerpc_pointer(tvb, offset, pinfo, tree, di, drep,\r\n&u32Pointer);\r\nif (u32Pointer) {\r\noffset = dissect_dcom_BSTR(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_name, szStr, u32MaxStr);\r\n} else {\r\nszStr[0] = '\0';\r\n}\r\nif (strlen(szStr) > 0) {\r\ncall = wmem_strdup(wmem_file_scope(), szStr);\r\ndi->call_data->private_data = call;\r\n}\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ": \"%s\"", szStr);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_ICBAPhysicalDevice_get_LogicalDevice_resp(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 u32HResult;\r\ngchar *ldev_name = (gchar *)di->call_data->private_data;\r\ndcom_interface_t *pdev_interf;\r\ndcom_interface_t *ldev_interf;\r\ncba_pdev_t *pdev;\r\ncba_ldev_t *ldev;\r\noffset = dissect_dcom_that(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_PMInterfacePointer(tvb, offset, pinfo, tree, di, drep, 0, &ldev_interf);\r\nif (ldev_name != NULL && ldev_interf != NULL) {\r\npdev_interf = dcom_interface_new(pinfo, &pinfo->net_dst, &uuid_ICBAPhysicalDevice, 0, 0, &di->call_data->object_uuid);\r\nif (pdev_interf != NULL) {\r\npdev = cba_pdev_add(pinfo, &pinfo->net_dst);\r\ncba_pdev_link(pinfo, pdev, pdev_interf);\r\nldev = cba_ldev_add(pinfo, pdev, ldev_name);\r\ncba_ldev_link(pinfo, ldev, ldev_interf);\r\n}\r\n}\r\noffset = dissect_dcom_HRESULT(tvb, offset, pinfo, tree, di, drep,\r\n&u32HResult);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " -> %s",\r\nval_to_str(u32HResult, dcom_hresult_vals, "Unknown (0x%08x)") );\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_ICBAPhysicalDevice2_Type_resp(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint16 u16MultiApp;\r\nguint16 u16PROFInetDCOMStack;\r\nguint32 u32HResult;\r\noffset = dissect_dcom_that(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_VARIANT_BOOL(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_multi_app, &u16MultiApp);\r\noffset = dissect_dcom_VARIANT_BOOL(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_profinet_dcom_stack, &u16PROFInetDCOMStack);\r\noffset = dissect_dcom_HRESULT(tvb, offset, pinfo, tree, di, drep,\r\n&u32HResult);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " App=%s Stack=%s -> %s",\r\n(u16MultiApp) ? "Multi" : "Single",\r\n(u16PROFInetDCOMStack) ? "PN-DCOM" : "MS-DCOM",\r\nval_to_str(u32HResult, dcom_hresult_vals, "Unknown (0x%08x)") );\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_PROFInetRevision_resp(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint16 u16Major;\r\nguint16 u16Minor;\r\nguint16 u16ServicePack;\r\nguint16 u16Build;\r\nguint32 u32HResult;\r\noffset = dissect_dcom_that(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_WORD(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_revision_major, &u16Major);\r\noffset = dissect_dcom_WORD(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_revision_minor, &u16Minor);\r\noffset = dissect_dcom_WORD(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_revision_service_pack, &u16ServicePack);\r\noffset = dissect_dcom_WORD(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_revision_build, &u16Build);\r\noffset = dissect_dcom_HRESULT(tvb, offset, pinfo, tree, di, drep,\r\n&u32HResult);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " Revision=%u.%u.%u.%u -> %s",\r\nu16Major, u16Minor, u16ServicePack, u16Build,\r\nval_to_str(u32HResult, dcom_hresult_vals, "Unknown (0x%08x)") );\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_ICBAPhysicalDevice2_get_PDevStamp_resp(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 u32PDevStamp;\r\nguint32 u32HResult;\r\noffset = dissect_dcom_that(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_pdev_stamp, &u32PDevStamp);\r\noffset = dissect_dcom_HRESULT(tvb, offset, pinfo, tree, di, drep,\r\n&u32HResult);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " PDevStamp=0x%x -> %s",\r\nu32PDevStamp,\r\nval_to_str(u32HResult, dcom_hresult_vals, "Unknown (0x%08x)") );\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_Revision_resp(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint16 u16Major;\r\nguint16 u16Minor;\r\nguint32 u32HResult;\r\noffset = dissect_dcom_that(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_WORD(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_revision_major, &u16Major);\r\noffset = dissect_dcom_WORD(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_revision_minor, &u16Minor);\r\noffset = dissect_dcom_HRESULT(tvb, offset, pinfo, tree, di, drep,\r\n&u32HResult);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ": %u.%u -> %s",\r\nu16Major, u16Minor,\r\nval_to_str(u32HResult, dcom_hresult_vals, "Unknown (0x%08x)") );\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_ICBALogicalDevice_get_Name_resp(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\ngchar szStr[1000];\r\nguint32 u32MaxStr = sizeof(szStr);\r\nguint32 u32Pointer;\r\nguint32 u32HResult;\r\noffset = dissect_dcom_that(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_dcerpc_pointer(tvb, offset, pinfo, tree, di, drep,\r\n&u32Pointer);\r\nif (u32Pointer) {\r\noffset = dissect_dcom_BSTR(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_name, szStr, u32MaxStr);\r\n} else {\r\nszStr[0] = '\0';\r\n}\r\noffset = dissect_dcom_HRESULT(tvb, offset, pinfo, tree, di, drep,\r\n&u32HResult);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ": \"%s\" -> %s", szStr,\r\nval_to_str(u32HResult, dcom_hresult_vals, "Unknown (0x%08x)") );\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_RTAuto_get_Name_resp(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nreturn dissect_get_BSTR_resp(tvb, offset, pinfo, tree, di, drep, hf_cba_name);\r\n}\r\nstatic int\r\ndissect_ICBALogicalDevice_get_ACCO_resp(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 u32HResult;\r\ndcom_interface_t *acco_interf;\r\ncba_ldev_t *ldev;\r\noffset = dissect_dcom_that(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_PMInterfacePointer(tvb, offset, pinfo, tree, di, drep, 0, &acco_interf);\r\nif (acco_interf == NULL) {\r\nexpert_add_info(pinfo, NULL, &ei_cba_acco_interface_pointer_unresolved);\r\n}\r\nldev = cba_ldev_find(pinfo, &pinfo->net_src, &di->call_data->object_uuid);\r\nif (ldev != NULL && acco_interf != NULL) {\r\ncba_ldev_link_acco(pinfo, ldev, acco_interf);\r\n}\r\noffset = dissect_dcom_HRESULT(tvb, offset, pinfo, tree, di, drep, &u32HResult);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " -> %s",\r\nval_to_str(u32HResult, dcom_hresult_vals, "Unknown (0x%08x)") );\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_ICBALogicalDevice_get_RTAuto_resp(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 u32HResult;\r\noffset = dissect_dcom_that(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_PMInterfacePointer(tvb, offset, pinfo, tree, di, drep, 0, NULL);\r\noffset = dissect_dcom_HRESULT(tvb, offset, pinfo, tree, di, drep, &u32HResult);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " -> %s",\r\nval_to_str(u32HResult, dcom_hresult_vals, "Unknown (0x%08x)") );\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_ICBALogicalDevice_Get_RTAuto_rqst(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\ngchar szStr[1000];\r\nguint32 u32MaxStr = sizeof(szStr);\r\nguint32 u32Pointer;\r\noffset = dissect_dcom_this(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_dcerpc_pointer(tvb, offset, pinfo, tree, di, drep,\r\n&u32Pointer);\r\nif (u32Pointer) {\r\noffset = dissect_dcom_BSTR(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_name, szStr, u32MaxStr);\r\n} else {\r\nszStr[0] = '\0';\r\n}\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ": \"%s\"", szStr);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_ComponentInfo_resp(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\ngchar szStr[1000];\r\nguint32 u32MaxStr = sizeof(szStr);\r\ngchar szStr2[1000];\r\nguint32 u32MaxStr2 = sizeof(szStr2);\r\nguint32 u32HResult;\r\nguint32 u32Pointer;\r\noffset = dissect_dcom_that(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_dcerpc_pointer(tvb, offset, pinfo, tree, di, drep,\r\n&u32Pointer);\r\nif (u32Pointer) {\r\noffset = dissect_dcom_BSTR(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_component_id, szStr, u32MaxStr);\r\n} else {\r\nszStr[0] = '\0';\r\n}\r\noffset = dissect_dcom_dcerpc_pointer(tvb, offset, pinfo, tree, di, drep,\r\n&u32Pointer);\r\nif (u32Pointer) {\r\noffset = dissect_dcom_BSTR(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_component_version, szStr2, u32MaxStr2);\r\n} else {\r\nszStr2[0] = '\0';\r\n}\r\noffset = dissect_dcom_HRESULT(tvb, offset, pinfo, tree, di, drep, &u32HResult);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ": ID=\"%s\" Version=\"%s\" -> %s",\r\nszStr, szStr2,\r\nval_to_str(u32HResult, dcom_hresult_vals, "Unknown (0x%08x)") );\r\nreturn offset;\r\n}\r\nstatic void\r\ndissect_PBAddressInfo(tvbuff_t *tvb, gint offset, packet_info *pinfo,\r\nproto_tree *tree, dcerpc_info *di, guint8 *drep,\r\nguint32 u32VarType _U_, guint32 u32ArraySize)\r\n{\r\nguint8 u8ID;\r\nguint8 u8Addr;\r\nproto_item *sub_item;\r\nproto_tree *sub_tree;\r\nwhile (u32ArraySize != 0) {\r\nsub_item = proto_tree_add_item(tree, hf_cba_pbaddress, tvb, offset, 2, ENC_NA);\r\nsub_tree = proto_item_add_subtree(sub_item, ett_PBAddress);\r\noffset = dissect_dcom_BYTE(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_cba_pbaddress_system_id, &u8ID);\r\noffset = dissect_dcom_BYTE(tvb, offset, pinfo, sub_tree, di, drep,\r\nhf_cba_pbaddress_address, &u8Addr);\r\nu32ArraySize-=2;\r\nproto_item_append_text(sub_item, ": ID=0x%x Addr=%u", u8ID, u8Addr);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ", ID=0x%x Addr=%u",\r\nu8ID, u8Addr);\r\n}\r\n}\r\nstatic int\r\ndissect_PBAddressInfo_resp(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 u32HResult;\r\noffset = dissect_dcom_that(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_SAFEARRAY(tvb, offset, pinfo, tree, di, drep, 0 , dissect_PBAddressInfo);\r\noffset = dissect_dcom_HRESULT(tvb, offset, pinfo, tree, di, drep, &u32HResult);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, " -> %s",\r\nval_to_str(u32HResult, dcom_hresult_vals, "Unknown (0x%08x)") );\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_Advise_rqst(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\noffset = dissect_dcom_this(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_PMInterfacePointer(tvb, offset, pinfo, tree, di, drep, 0, NULL);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_Advise_resp(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 u32Cookie;\r\nguint32 u32HResult;\r\noffset = dissect_dcom_that(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_cookie, &u32Cookie);\r\noffset = dissect_dcom_HRESULT(tvb, offset, pinfo, tree, di, drep,\r\n&u32HResult);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ": Cookie=0x%x -> %s",\r\nu32Cookie,\r\nval_to_str(u32HResult, dcom_hresult_vals, "Unknown (0x%08x)") );\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_Unadvise_rqst(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 u32Cookie;\r\noffset = dissect_dcom_this(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_cookie, &u32Cookie);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ": Cookie=0x%x",\r\nu32Cookie);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_ICBAState_get_State_resp(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint16 u16State;\r\nguint32 u32HResult;\r\noffset = dissect_dcom_that(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_WORD(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_state, &u16State);\r\noffset = dissect_dcom_HRESULT(tvb, offset, pinfo, tree, di, drep,\r\n&u32HResult);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ": State=%s -> %s",\r\nval_to_str(u16State, cba_state_vals, "Unknown (0x%08x)"),\r\nval_to_str(u32HResult, dcom_hresult_vals, "Unknown (0x%08x)") );\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_ICBAStateEvent_OnStateChanged_rqst(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint16 u16NewState;\r\nguint16 u16OldState;\r\noffset = dissect_dcom_this(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_WORD(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_new_state, &u16NewState);\r\noffset = dissect_dcom_WORD(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_old_state, &u16OldState);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ": NewState=%s OldState=%s",\r\nval_to_str(u16NewState, cba_state_vals, "Unknown (0x%04x)"),\r\nval_to_str(u16OldState, cba_state_vals, "Unknown (0x%04x)") );\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_ICBAGroupError_OnGroupErrorChanged_rqst(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint16 u16NewGroupError;\r\nguint16 u16OldGroupError;\r\noffset = dissect_dcom_this(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_WORD(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_new_grouperror, &u16NewGroupError);\r\noffset = dissect_dcom_WORD(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_old_grouperror, &u16OldGroupError);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ": NewGE=%s OldGE=%s",\r\nval_to_str(u16NewGroupError, cba_grouperror_vals, "Unknown (0x%04x)"),\r\nval_to_str(u16OldGroupError, cba_grouperror_vals, "Unknown (0x%04x)") );\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_ICBAPhysicalDevicePCEvent_OnLogicalDeviceAdded_rqst(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint32 u32Cookie;\r\nguint32 u32HResult;\r\noffset = dissect_dcom_this(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_cookie, &u32Cookie);\r\noffset = dissect_dcom_PMInterfacePointer(tvb, offset, pinfo, tree, di, drep, 0, NULL);\r\noffset = dissect_dcom_HRESULT(tvb, offset, pinfo, tree, di, drep,\r\n&u32HResult);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ": Cookie=0x%x %s",\r\nu32Cookie,\r\nval_to_str(u32HResult, dcom_hresult_vals, "Unknown (0x%08x)") );\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_ICBAGroupError_GroupError_resp(tvbuff_t *tvb, int offset,\r\npacket_info *pinfo, proto_tree *tree, dcerpc_info *di, guint8 *drep)\r\n{\r\nguint16 u16GroupError;\r\nguint32 u32Cookie;\r\nguint32 u32HResult;\r\noffset = dissect_dcom_that(tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_dcom_WORD(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_grouperror, &u16GroupError);\r\noffset = dissect_dcom_DWORD(tvb, offset, pinfo, tree, di, drep,\r\nhf_cba_cookie, &u32Cookie);\r\noffset = dissect_dcom_HRESULT(tvb, offset, pinfo, tree, di, drep,\r\n&u32HResult);\r\ncol_append_fstr(pinfo->cinfo, COL_INFO, ": GroupError=%s Cookie=0x%x -> %s",\r\nval_to_str(u16GroupError, cba_grouperror_vals, "Unknown (0x%08x)"),\r\nu32Cookie,\r\nval_to_str(u32HResult, dcom_hresult_vals, "Unknown (0x%08x)") );\r\nreturn offset;\r\n}\r\nstatic void cba_cleanup(void) {\r\ng_list_free(cba_pdevs);\r\ncba_pdevs = NULL;\r\n}\r\nvoid\r\nproto_register_dcom_cba (void)\r\n{\r\nstatic hf_register_info hf_cba_browse_array[] = {\r\n{ &hf_cba_browse_count,\r\n{ "Count", "cba.browse.count",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_browse_offset,\r\n{ "Offset", "cba.browse.offset",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_browse_max_return,\r\n{ "MaxReturn", "cba.browse.max_return",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_browse_item,\r\n{ "ItemNames", "cba.browse.item",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_browse_data_type,\r\n{ "DataTypes", "cba.browse.data_type",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_browse_access_right,\r\n{ "AccessRights", "cba.browse.access_right",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_browse_selector,\r\n{ "Selector", "cba.browse.selector",\r\nFT_UINT32, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_browse_info1,\r\n{ "Info1", "cba.browse.info1",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_browse_info2,\r\n{ "Info2", "cba.browse.info2",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n};\r\nstatic hf_register_info hf_cba_pdev_array[] = {\r\n{ &hf_cba_revision_major,\r\n{ "Major", "cba.revision_major",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_revision_minor,\r\n{ "Minor", "cba.revision_minor",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_revision_service_pack,\r\n{ "ServicePack", "cba.revision_service_pack",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_revision_build,\r\n{ "Build", "cba_revision_build",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_producer,\r\n{ "Producer", "cba.producer",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_product,\r\n{ "Product", "cba.product",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_multi_app,\r\n{ "MultiApp", "cba.multi_app",\r\nFT_UINT16, BASE_HEX, VALS(dcom_boolean_vals), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_profinet_dcom_stack,\r\n{ "PROFInetDCOMStack", "cba.profinet_dcom_stack",\r\nFT_UINT16, BASE_HEX, VALS(dcom_boolean_vals), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_pdev_stamp,\r\n{ "PDevStamp", "cba.pdev_stamp",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_save_ldev_name,\r\n{ "LDevName", "cba.save_ldev_name",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_save_result,\r\n{ "PartialResult", "cba.save_result",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n};\r\nstatic hf_register_info hf_cba_ldev_array[] = {\r\n{ &hf_cba_name,\r\n{ "Name", "cba.name",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_component_id,\r\n{ "ComponentID", "cba.component_id",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_component_version,\r\n{ "Version", "cba.component_version",\r\nFT_STRING, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_pbaddress,\r\n{ "PROFIBUS Address", "cba.pbaddress",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_pbaddress_system_id,\r\n{ "SystemID", "cba.pbaddress.system_id",\r\nFT_UINT8, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_pbaddress_address,\r\n{ "Address", "cba.pbaddress.address",\r\nFT_UINT8, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n};\r\nstatic hf_register_info hf_cba_array[] = {\r\n{ &hf_cba_opnum,\r\n{ "Operation", "cba.opnum",\r\nFT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_production_date,\r\n{ "ProductionDate", "cba.production_date",\r\nFT_DOUBLE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_time,\r\n{ "Time", "cba.time",\r\nFT_DOUBLE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_serial_no,\r\n{ "SerialNo", "cba.serial_no",\r\nFT_NONE, BASE_NONE, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_state,\r\n{ "State", "cba.state",\r\nFT_UINT16, BASE_HEX, VALS(cba_state_vals), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_new_state,\r\n{ "NewState", "cba.state_new",\r\nFT_UINT16, BASE_HEX, VALS(cba_state_vals), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_old_state,\r\n{ "OldState", "cba.state_old",\r\nFT_UINT16, BASE_HEX, VALS(cba_state_vals), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_cookie,\r\n{ "Cookie", "cba.cookie",\r\nFT_UINT32, BASE_HEX, NULL, 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_grouperror,\r\n{ "GroupError", "cba.grouperror",\r\nFT_UINT16, BASE_HEX, VALS(cba_grouperror_vals), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_new_grouperror,\r\n{ "NewGroupError", "cba.grouperror_new",\r\nFT_UINT16, BASE_HEX, VALS(cba_grouperror_vals), 0x0,\r\nNULL, HFILL }},\r\n{ &hf_cba_old_grouperror,\r\n{ "OldGroupError", "cba.grouperror_old",\r\nFT_UINT16, BASE_HEX, VALS(cba_grouperror_vals), 0x0,\r\nNULL, HFILL }},\r\n};\r\nstatic gint *ett_cba[] = {\r\n&ett_ICBAPhysicalDevice,\r\n&ett_ICBABrowse,\r\n&ett_ICBAPhysicalDevicePC,\r\n&ett_ICBAPhysicalDevicePCEvent,\r\n&ett_ICBAPersist,\r\n&ett_ICBALogicalDevice,\r\n&ett_ICBAState,\r\n&ett_ICBAStateEvent,\r\n&ett_ICBATime,\r\n&ett_ICBAGroupError,\r\n&ett_ICBAGroupErrorEvent,\r\n&ett_ICBARTAuto,\r\n&ett_ICBASystemProperties,\r\n&ett_PBAddress\r\n};\r\nstatic ei_register_info ei[] = {\r\n{ &ei_cba_acco_interface_pointer_unresolved, { "cba.acco.interface_pointer_unresolved", PI_UNDECODED, PI_WARN, "LDev_get_ACCO: can't resolve ACCO interface pointer", EXPFILL }},\r\n};\r\nexpert_module_t* expert_cba_acco;\r\nproto_register_subtree_array (ett_cba, array_length (ett_cba));\r\nproto_ICBAPhysicalDevice = proto_register_protocol ("ICBAPhysicalDevice", "ICBAPDev", "cba_pdev");\r\nproto_register_field_array(proto_ICBAPhysicalDevice, hf_cba_pdev_array, array_length(hf_cba_pdev_array));\r\nexpert_cba_acco = expert_register_protocol(proto_ICBAPhysicalDevice);\r\nexpert_register_field_array(expert_cba_acco, ei, array_length(ei));\r\nproto_ICBAPhysicalDevice2 = proto_register_protocol ("ICBAPhysicalDevice2", "ICBAPDev2", "cba_pdev2");\r\nproto_ICBABrowse = proto_register_protocol ("ICBABrowse", "ICBABrowse", "cba_browse");\r\nproto_register_field_array(proto_ICBABrowse, hf_cba_array, array_length(hf_cba_array));\r\nproto_register_field_array(proto_ICBABrowse, hf_cba_browse_array, array_length(hf_cba_browse_array));\r\nproto_ICBABrowse2 = proto_register_protocol ("ICBABrowse2", "ICBABrowse2", "cba_browse2");\r\nproto_ICBAPhysicalDevicePC = proto_register_protocol ("ICBAPhysicalDevicePC", "ICBAPDevPC", "cba_pdev_pc");\r\nproto_ICBAPhysicalDevicePCEvent = proto_register_protocol ("ICBAPhysicalDevicePCEvent", "ICBAPDevPCEvent", "cba_pdev_pc_event");\r\nproto_ICBAPersist = proto_register_protocol ("ICBAPersist", "ICBAPersist", "cba_persist");\r\nproto_ICBAPersist2 = proto_register_protocol ("ICBAPersist2", "ICBAPersist2", "cba_persist2");\r\nproto_ICBALogicalDevice = proto_register_protocol ("ICBALogicalDevice", "ICBALDev", "cba_ldev");\r\nproto_register_field_array(proto_ICBAPhysicalDevice, hf_cba_ldev_array, array_length(hf_cba_ldev_array));\r\nproto_ICBALogicalDevice2 = proto_register_protocol ("ICBALogicalDevice2", "ICBALDev2", "cba_ldev2");\r\nproto_ICBAState = proto_register_protocol ("ICBAState", "ICBAState", "cba_state");\r\nproto_ICBAStateEvent = proto_register_protocol ("ICBAStateEvent", "ICBAStateEvent", "cba_state_event");\r\nproto_ICBATime = proto_register_protocol ("ICBATime", "ICBATime", "cba_time");\r\nproto_ICBAGroupError = proto_register_protocol ("ICBAGroupError", "ICBAGErr", "cba_grouperror");\r\nproto_ICBAGroupErrorEvent = proto_register_protocol ("ICBAGroupErrorEvent", "ICBAGErrEvent", "cba_grouperror_event");\r\nproto_ICBARTAuto = proto_register_protocol ("ICBARTAuto", "ICBARTAuto", "cba_rtauto");\r\nproto_ICBARTAuto2 = proto_register_protocol ("ICBARTAuto2", "ICBARTAuto2", "cba_rtauto2");\r\nproto_ICBASystemProperties = proto_register_protocol ("ICBASystemProperties", "ICBASysProp", "cba_sysprop");\r\nregister_cleanup_routine(cba_cleanup);\r\n}\r\nvoid\r\nproto_reg_handoff_dcom_cba (void)\r\n{\r\nguids_add_uuid(&uuid_coclass_CBAPhysicalDevice, "CBA");\r\ndcerpc_init_uuid(proto_ICBAPhysicalDevice, ett_ICBAPhysicalDevice,\r\n&uuid_ICBAPhysicalDevice, ver_ICBAPhysicalDevice,\r\nICBAPhysicalDevice_dissectors, hf_cba_opnum);\r\ndcerpc_init_uuid(proto_ICBAPhysicalDevice2, ett_ICBAPhysicalDevice,\r\n&uuid_ICBAPhysicalDevice2, ver_ICBAPhysicalDevice2,\r\nICBAPhysicalDevice_dissectors, hf_cba_opnum);\r\ndcerpc_init_uuid(proto_ICBABrowse, ett_ICBABrowse,\r\n&uuid_ICBABrowse, ver_ICBABrowse,\r\nICBABrowse_dissectors, hf_cba_opnum);\r\ndcerpc_init_uuid(proto_ICBABrowse2, ett_ICBABrowse,\r\n&uuid_ICBABrowse2, ver_ICBABrowse2,\r\nICBABrowse_dissectors, hf_cba_opnum);\r\ndcerpc_init_uuid(proto_ICBAPhysicalDevicePC, ett_ICBAPhysicalDevicePC,\r\n&uuid_ICBAPhysicalDevicePC, ver_ICBAPhysicalDevicePC,\r\nICBAPhysicalDevicePC_dissectors, hf_cba_opnum);\r\ndcerpc_init_uuid(proto_ICBAPhysicalDevicePCEvent, ett_ICBAPhysicalDevicePCEvent,\r\n&uuid_ICBAPhysicalDevicePCEvent, ver_ICBAPhysicalDevicePCEvent,\r\nICBAPhysicalDevicePCEvent_dissectors, hf_cba_opnum);\r\ndcerpc_init_uuid(proto_ICBAPersist, ett_ICBAPersist,\r\n&uuid_ICBAPersist, ver_ICBAPersist,\r\nICBAPersist_dissectors, hf_cba_opnum);\r\ndcerpc_init_uuid(proto_ICBAPersist2, ett_ICBAPersist,\r\n&uuid_ICBAPersist2, ver_ICBAPersist2,\r\nICBAPersist_dissectors, hf_cba_opnum);\r\ndcerpc_init_uuid(proto_ICBALogicalDevice, ett_ICBALogicalDevice,\r\n&uuid_ICBALogicalDevice, ver_ICBALogicalDevice,\r\nICBALogicalDevice_dissectors, hf_cba_opnum);\r\ndcerpc_init_uuid(proto_ICBALogicalDevice2, ett_ICBALogicalDevice,\r\n&uuid_ICBALogicalDevice2, ver_ICBALogicalDevice2,\r\nICBALogicalDevice_dissectors, hf_cba_opnum);\r\ndcerpc_init_uuid(proto_ICBAState, ett_ICBAState,\r\n&uuid_ICBAState, ver_ICBAState,\r\nICBAState_dissectors, hf_cba_opnum);\r\ndcerpc_init_uuid(proto_ICBAStateEvent, ett_ICBAStateEvent,\r\n&uuid_ICBAStateEvent, ver_ICBAStateEvent,\r\nICBAStateEvent_dissectors, hf_cba_opnum);\r\ndcerpc_init_uuid(proto_ICBATime, ett_ICBATime,\r\n&uuid_ICBATime, ver_ICBATime,\r\nICBATime_dissectors, hf_cba_opnum);\r\ndcerpc_init_uuid(proto_ICBAGroupError, ett_ICBAGroupError,\r\n&uuid_ICBAGroupError, ver_ICBAGroupError,\r\nICBAGroupError_dissectors, hf_cba_opnum);\r\ndcerpc_init_uuid(proto_ICBAGroupErrorEvent, ett_ICBAGroupErrorEvent,\r\n&uuid_ICBAGroupErrorEvent, ver_ICBAGroupErrorEvent,\r\nICBAGroupErrorEvent_dissectors, hf_cba_opnum);\r\ndcerpc_init_uuid(proto_ICBARTAuto, ett_ICBARTAuto,\r\n&uuid_ICBARTAuto, ver_ICBARTAuto,\r\nICBARTAuto_dissectors, hf_cba_opnum);\r\ndcerpc_init_uuid(proto_ICBARTAuto2, ett_ICBARTAuto,\r\n&uuid_ICBARTAuto2, ver_ICBARTAuto2,\r\nICBARTAuto_dissectors, hf_cba_opnum);\r\ndcerpc_init_uuid(proto_ICBASystemProperties, ett_ICBASystemProperties,\r\n&uuid_ICBASystemProperties, ver_ICBASystemProperties,\r\nICBASystemProperties_dissectors, hf_cba_opnum);\r\n}
