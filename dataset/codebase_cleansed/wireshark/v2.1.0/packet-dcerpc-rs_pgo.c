static int\r\ndissect_error_status_t (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * parent_tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nproto_item *item;\r\nproto_tree *tree;\r\nint old_offset = offset;\r\nguint32 st;\r\nconst char *st_str;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\ntree = proto_tree_add_subtree(parent_tree, tvb, offset, -1, ett_error_status_t, &item, "error_status_t");\r\noffset =\r\ndissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep, hf_error_status_t,\r\n&st);\r\nst_str = val_to_str_ext (st, &dce_error_vals_ext, "%u");\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " st:%s ", st_str);\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_sec_rgy_pname_t (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * parent_tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\n#define sec_rgy_pname_t_size 257\r\nguint32 string_size;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree =\r\nproto_tree_add_subtree(parent_tree, tvb, offset, -1, ett_sec_rgy_pname_t, &item, "sec_rgy_pname_t");\r\n}\r\noffset = dissect_ndr_uint32 (tvb, offset, pinfo, tree, di, drep,\r\nhf_sec_rgy_pname_t_size, &string_size);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " String_size:%u", string_size);\r\nif (string_size < sec_rgy_pname_t_size)\r\n{\r\nproto_tree_add_item (tree, hf_sec_rgy_pname_t_principalName_string,\r\ntvb, offset, string_size, ENC_ASCII|ENC_NA);\r\nif (string_size > 1)\r\n{\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " Principal:%s",\r\ntvb_get_string_enc(wmem_packet_scope(), tvb, offset, string_size, ENC_ASCII));\r\n}\r\noffset += string_size;\r\n}\r\nelse\r\n{\r\ncol_append_fstr (pinfo->cinfo, COL_INFO,\r\n" :FIXME!: Invalid string length of %u",\r\nstring_size);\r\n}\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_sec_rgy_pgo_flags_t (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * parent_tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\nguint32 flags;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree =\r\nproto_tree_add_subtree(parent_tree, tvb, offset, -1,\r\nett_sec_rgy_pgo_flags_t, &item, "sec_rgy_pgo_flags_t ");\r\n}\r\noffset =\r\ndissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep,\r\nhf_sec_rgy_pgo_flags_t, &flags);\r\n#define sec_rgy_pgo_is_an_alias 0x01\r\n#define sec_rgy_pgo_is_required 0x02\r\n#define sec_rgy_pgo_projlist_ok 0x04\r\n#define sec_rgy_pgo_flags_none 0x00\r\ncol_append_str (pinfo->cinfo, COL_INFO, " PgoFlags=");\r\nif ((flags & sec_rgy_pgo_is_an_alias) == sec_rgy_pgo_is_an_alias)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":IS_AN_ALIAS");\r\n}\r\nif ((flags & sec_rgy_pgo_is_required) == sec_rgy_pgo_is_required)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":IS_REQUIRED");\r\n}\r\nif ((flags & sec_rgy_pgo_projlist_ok) == sec_rgy_pgo_projlist_ok)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":PROJLIST_OK");\r\n}\r\nif ((flags & sec_rgy_acct_admin_client) == sec_rgy_acct_admin_client)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":NONE");\r\n}\r\nif ((flags & sec_rgy_pgo_flags_none) == sec_rgy_pgo_flags_none)\r\n{\r\ncol_append_str (pinfo->cinfo, COL_INFO, ":NONE");\r\n}\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rs_cache_data_t (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * parent_tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\nguint32 person_dtm, group_dtm, org_dtm;\r\ne_guid_t uuid1;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree =\r\nproto_tree_add_subtree(parent_tree, tvb, offset, -1, ett_rs_cache_data_t, &item, "rs_cache_data_t");\r\n}\r\noffset =\r\ndissect_ndr_uuid_t(tvb, offset, pinfo, tree, di, drep, hf_rs_uuid1, &uuid1);\r\noffset =\r\ndissect_dcerpc_time_t (tvb, offset, pinfo, tree, drep, hf_rs_timeval,\r\n&person_dtm);\r\noffset =\r\ndissect_dcerpc_time_t (tvb, offset, pinfo, tree, drep, hf_rs_timeval,\r\n&group_dtm);\r\noffset =\r\ndissect_dcerpc_time_t (tvb, offset, pinfo, tree, drep, hf_rs_timeval,\r\n&org_dtm);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO,\r\n" siteid %08x-%04x-%04x-%02x%02x-%02x%02x%02x%02x%02x%02x person_dtm:%u group_dtm:%u org_dtm:%u",\r\nuuid1.data1, uuid1.data2, uuid1.data3, uuid1.data4[0],\r\nuuid1.data4[1], uuid1.data4[2], uuid1.data4[3],\r\nuuid1.data4[4], uuid1.data4[5], uuid1.data4[6],\r\nuuid1.data4[7], person_dtm, group_dtm, org_dtm);\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_sec_rgy_name_t (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * parent_tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\n#define sec_rgy_name_t_size 1025\r\nguint32 string_size;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree =\r\nproto_tree_add_subtree(parent_tree, tvb, offset, -1, ett_sec_rgy_name_t, &item, "sec_rgy_name_t");\r\n}\r\noffset =\r\ndissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep,\r\nhf_sec_rgy_name_t_size, &string_size);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " String_size:%u", string_size);\r\nif (string_size < sec_rgy_name_t_size)\r\n{\r\nproto_tree_add_item (tree, hf_sec_rgy_name_t_principalName_string,\r\ntvb, offset, string_size, ENC_ASCII|ENC_NA);\r\nif (string_size > 1)\r\n{\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " Principal:%s",\r\ntvb_get_string_enc(wmem_packet_scope(), tvb, offset, string_size, ENC_ASCII));\r\n}\r\noffset += string_size;\r\n}\r\nelse\r\n{\r\ncol_append_fstr (pinfo->cinfo, COL_INFO,\r\n" :FIXME!: Invalid string length of %u",\r\nstring_size);\r\n}\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_sec_rgy_domain_t (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * parent_tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\nguint32 domain_t;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree =\r\nproto_tree_add_subtree(parent_tree, tvb, offset, -1, ett_sec_rgy_domain_t, &item, "sec_rgy_domain_t");\r\n}\r\noffset =\r\ndissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep, hf_sec_rgy_domain_t,\r\n&domain_t);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " sec_rgy_domain_t:%u",\r\ndomain_t);\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_sec_rgy_pgo_item_t (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * parent_tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\ne_guid_t id;\r\nguint32 unix_num, quota;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree =\r\nproto_tree_add_subtree(parent_tree, tvb, offset, -1,\r\nett_sec_rgy_pgo_item_t, &item, " sec_rgy_pgo_item_t ");\r\n}\r\noffset =\r\ndissect_ndr_uuid_t(tvb, offset, pinfo, tree, di, drep, hf_rs_uuid1, &id);\r\noffset =\r\ndissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep,\r\nhf_rs_sec_rgy_pgo_item_t_unix_num, &unix_num);\r\noffset =\r\ndissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep,\r\nhf_rs_sec_rgy_pgo_item_t_quota, &quota);\r\noffset = dissect_sec_rgy_pgo_flags_t (tvb, offset, pinfo, tree, di, drep);\r\noffset += 4;\r\noffset = dissect_sec_rgy_pname_t (tvb, offset, pinfo, tree, di, drep);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO,\r\n" sec_rgy_pgo_item_t - id %08x-%04x-%04x-%02x%02x-%02x%02x%02x%02x%02x%02x unix_num:%u quota:%u",\r\nid.data1, id.data2, id.data3, id.data4[0],\r\nid.data4[1], id.data4[2], id.data4[3],\r\nid.data4[4], id.data4[5], id.data4[6],\r\nid.data4[7], unix_num, quota);\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_sec_rgy_cursor_t (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * parent_tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\ne_guid_t source;\r\nguint32 handle, valid;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree =\r\nproto_tree_add_subtree(parent_tree, tvb, offset, -1,\r\nett_sec_rgy_cursor_t, &item, " sec_rgy_cursor_t ");\r\n}\r\noffset =\r\ndissect_ndr_uuid_t(tvb, offset, pinfo, tree, di, drep, hf_rs_uuid1, &source);\r\noffset =\r\ndissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep,\r\nhf_rs_sec_rgy_pgo_item_t_unix_num, &handle);\r\noffset =\r\ndissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep,\r\nhf_rs_sec_rgy_pgo_item_t_quota, &valid);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO,\r\n" sec_rgy_cursor_t - source %08x-%04x-%04x-%02x%02x-%02x%02x%02x%02x%02x%02x handle:%u valid:%u",\r\nsource.data1, source.data2, source.data3,\r\nsource.data4[0], source.data4[1], source.data4[2],\r\nsource.data4[3], source.data4[4], source.data4[5],\r\nsource.data4[6], source.data4[7], handle, valid);\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rs_pgo_query_t (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * parent_tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nenum\r\n{\r\nrs_pgo_query_name,\r\nrs_pgo_query_id,\r\nrs_pgo_query_unix_num,\r\nrs_pgo_query_next,\r\nrs_pgo_query_none\r\n};\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\nguint8 query_t;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree =\r\nproto_tree_add_subtree(parent_tree, tvb, offset, -1, ett_rs_pgo_query_t, &item, "rs_pgo_query_t ");\r\n}\r\noffset =\r\ndissect_ndr_uint8 (tvb, offset, pinfo, tree, di, drep, hf_rs_pgo_query_t,\r\n&query_t);\r\ncol_append_str (pinfo->cinfo, COL_INFO, " rs_pgo_query_t:");\r\nswitch (query_t)\r\n{\r\ncase rs_pgo_query_name:\r\ncol_append_str (pinfo->cinfo, COL_INFO, "NAME");\r\nbreak;\r\ncase rs_pgo_query_id:\r\ncol_append_str (pinfo->cinfo, COL_INFO, "ID");\r\nbreak;\r\ncase rs_pgo_query_unix_num:\r\ncol_append_str (pinfo->cinfo, COL_INFO, "UNIX_NUM");\r\nbreak;\r\ncase rs_pgo_query_next:\r\ncol_append_str (pinfo->cinfo, COL_INFO, "NEXT");\r\nbreak;\r\ncase rs_pgo_query_none:\r\ncol_append_str (pinfo->cinfo, COL_INFO, "NONE");\r\nbreak;\r\ndefault:\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " unknown:%u", query_t);\r\nbreak;\r\n;\r\n}\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rs_pgo_id_key_t (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * parent_tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\ne_guid_t id;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree =\r\nproto_tree_add_subtree(parent_tree, tvb, offset, -1,\r\nett_rs_pgo_id_key_t, &item, "rs_pgo_id_key_t ");\r\n}\r\noffset =\r\ndissect_ndr_uuid_t(tvb, offset, pinfo, tree, di, drep, hf_rs_uuid1, &id);\r\noffset = dissect_sec_rgy_name_t (tvb, offset, pinfo, tree, di, drep);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO,\r\n" rs_pgo_id_key_t - id %08x-%04x-%04x-%02x%02x-%02x%02x%02x%02x%02x%02x",\r\nid.data1, id.data2, id.data3, id.data4[0],\r\nid.data4[1], id.data4[2], id.data4[3],\r\nid.data4[4], id.data4[5], id.data4[6], id.data4[7]);\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rs_pgo_result_t (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * parent_tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree =\r\nproto_tree_add_subtree(parent_tree, tvb, offset, -1,\r\nett_rs_pgo_result_t, &item, "rs_pgo_result_t ");\r\n}\r\noffset = dissect_sec_rgy_name_t (tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_sec_rgy_pgo_item_t (tvb, offset, pinfo, tree, di, drep);\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rs_pgo_unix_num_key_t (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * parent_tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\nguint32 rs_pgo_unix_num_key_t;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree =\r\nproto_tree_add_subtree(parent_tree, tvb, offset, -1,\r\nett_rs_pgo_unix_num_key_t, &item, " rs_pgo_unix_num_key_t ");\r\n}\r\noffset =\r\ndissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep,\r\nhf_rs_pgo_unix_num_key_t, &rs_pgo_unix_num_key_t);\r\noffset = dissect_sec_rgy_name_t (tvb, offset, pinfo, tree, di, drep);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO,\r\n" rs_pgo_unix_num_key_t:%u", rs_pgo_unix_num_key_t);\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rs_pgo_query_key_t (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * parent_tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nenum\r\n{\r\nrs_pgo_query_name,\r\nrs_pgo_query_id,\r\nrs_pgo_query_unix_num,\r\nrs_pgo_query_next,\r\nrs_pgo_query_none\r\n};\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\nguint16 query_t;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree =\r\nproto_tree_add_subtree(parent_tree, tvb, offset, -1,\r\nett_rs_pgo_query_key_t, &item, "rs_pgo_query_key_t ");\r\n}\r\noffset =\r\ndissect_ndr_uint16 (tvb, offset, pinfo, tree, di, drep, hf_rs_pgo_query_key_t,\r\n&query_t);\r\ncol_append_str (pinfo->cinfo, COL_INFO, " rs_pgo_query_key_t:");\r\noffset += 4;\r\nswitch (query_t)\r\n{\r\ncase rs_pgo_query_name:\r\ncol_append_str (pinfo->cinfo, COL_INFO, "NAME");\r\noffset = dissect_sec_rgy_name_t (tvb, offset, pinfo, tree, di, drep);\r\nbreak;\r\ncase rs_pgo_query_id:\r\ncol_append_str (pinfo->cinfo, COL_INFO, "ID");\r\noffset = dissect_rs_pgo_id_key_t (tvb, offset, pinfo, tree, di, drep);\r\nbreak;\r\ncase rs_pgo_query_unix_num:\r\ncol_append_str (pinfo->cinfo, COL_INFO, "UNIX_NUM");\r\noffset = dissect_rs_pgo_unix_num_key_t (tvb, offset, pinfo, tree, di, drep);\r\nbreak;\r\ncase rs_pgo_query_next:\r\ncol_append_str (pinfo->cinfo, COL_INFO, "NEXT");\r\noffset = dissect_sec_rgy_name_t (tvb, offset, pinfo, tree, di, drep);\r\nbreak;\r\ncase rs_pgo_query_none:\r\ncol_append_str (pinfo->cinfo, COL_INFO, "NONE");\r\nbreak;\r\ndefault:\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " unknown:%u", query_t);\r\nbreak;\r\n}\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\ndissect_rs_pgo_query_result_t (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * parent_tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nproto_item *item = NULL;\r\nproto_tree *tree = NULL;\r\nint old_offset = offset;\r\nguint32 st;\r\nconst char *status;\r\n#define error_status_ok 0\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nif (parent_tree)\r\n{\r\ntree = proto_tree_add_subtree(parent_tree, tvb, offset, -1,\r\nett_rs_pgo_query_result_t, &item, "rs_pgo_query_result_t");\r\n}\r\noffset =\r\ndissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep,\r\nhf_rs_pgo_query_result_t, &st);\r\nstatus = val_to_str_ext (st, &dce_error_vals_ext, "%u");\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " status:%s ", status);\r\noffset += 4;\r\nswitch (st)\r\n{\r\ncase error_status_ok:\r\noffset = dissect_rs_pgo_result_t (tvb, offset, pinfo, tree, di, drep);\r\nbreak;\r\ndefault:\r\n;\r\n}\r\nproto_item_set_len (item, offset - old_offset);\r\nreturn offset;\r\n}\r\nstatic int\r\nrs_pgo_dissect_add_rqst (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset = dissect_sec_rgy_domain_t (tvb, offset, pinfo, tree, di, drep);\r\noffset += 4;\r\noffset = dissect_sec_rgy_name_t (tvb, offset, pinfo, tree, di, drep);\r\noffset =\r\ndissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_sec_rgy_pgo_item_t, NDR_POINTER_REF,\r\n"sec_rgy_pgo_item_t: ", -1);\r\nreturn offset;\r\n}\r\nstatic int\r\nrs_pgo_dissect_add_resp (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\ngint buff_remain;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nbuff_remain = tvb_captured_length_remaining(tvb, offset);\r\nif (buff_remain > 8) {\r\noffset =\r\ndissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_rs_cache_data_t, NDR_POINTER_REF,\r\n"cache_info: ", -1);\r\n}\r\noffset =\r\ndissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_error_status_t, NDR_POINTER_REF, "status: ",\r\n-1);\r\nreturn offset;\r\n}\r\nstatic int\r\nrs_pgo_dissect_delete_rqst (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset = dissect_sec_rgy_domain_t (tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_sec_rgy_name_t (tvb, offset, pinfo, tree, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nrs_pgo_dissect_delete_resp (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\ngint buff_remain;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nbuff_remain = tvb_captured_length_remaining(tvb, offset);\r\nif (buff_remain > 8) {\r\noffset =\r\ndissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_rs_cache_data_t, NDR_POINTER_REF,\r\n"cache_info:", -1);\r\n}\r\noffset =\r\ndissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_error_status_t, NDR_POINTER_REF, "status:",\r\n-1);\r\nreturn offset;\r\n}\r\nstatic int\r\nrs_pgo_dissect_replace_rqst (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset = dissect_sec_rgy_domain_t (tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_sec_rgy_name_t (tvb, offset, pinfo, tree, di, drep);\r\noffset =\r\ndissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_sec_rgy_pgo_item_t, NDR_POINTER_REF,\r\n"pgo_item:", -1);\r\nreturn offset;\r\n}\r\nstatic int\r\nrs_pgo_dissect_replace_resp (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_rs_cache_data_t, NDR_POINTER_REF,\r\n"cache_info:", -1);\r\noffset =\r\ndissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_error_status_t, NDR_POINTER_REF, "status:",\r\n-1);\r\nreturn offset;\r\n}\r\nstatic int\r\nrs_pgo_dissect_add_member_rqst (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset = dissect_sec_rgy_domain_t (tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_sec_rgy_name_t (tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_sec_rgy_name_t (tvb, offset, pinfo, tree, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nrs_pgo_dissect_rename_rqst (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset = dissect_sec_rgy_domain_t (tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_sec_rgy_name_t (tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_sec_rgy_name_t (tvb, offset, pinfo, tree, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nrs_pgo_dissect_rename_resp (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_rs_cache_data_t, NDR_POINTER_REF,\r\n"cache_info:", -1);\r\noffset =\r\ndissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_error_status_t, NDR_POINTER_REF, "status:",\r\n-1);\r\nreturn offset;\r\n}\r\nstatic int\r\nrs_pgo_dissect_add_member_resp (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\ngint buff_remain;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\nbuff_remain = tvb_captured_length_remaining(tvb, offset);\r\nif (buff_remain > 8) {\r\noffset =\r\ndissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_rs_cache_data_t, NDR_POINTER_REF,\r\n"cache_info:", -1);\r\n}\r\noffset =\r\ndissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_error_status_t, NDR_POINTER_REF, "status:",\r\n-1);\r\nreturn offset;\r\n}\r\nstatic int\r\nrs_pgo_dissect_delete_member_rqst (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset = dissect_sec_rgy_domain_t (tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_sec_rgy_name_t (tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_sec_rgy_name_t (tvb, offset, pinfo, tree, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nrs_pgo_dissect_get_members_rqst (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nguint32 max_members;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset = dissect_sec_rgy_domain_t (tvb, offset, pinfo, tree, di, drep);\r\noffset += 4;\r\noffset = dissect_sec_rgy_name_t (tvb, offset, pinfo, tree, di, drep);\r\noffset =\r\ndissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_sec_rgy_cursor_t, NDR_POINTER_REF,\r\n"member_cursor:", -1);\r\noffset =\r\ndissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep, hf_rs_var1,\r\n&max_members);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " :max_members:%u", max_members);\r\nreturn offset;\r\n}\r\nstatic int\r\nrs_pgo_dissect_key_transfer_rqst (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset += 4;\r\noffset = dissect_sec_rgy_domain_t (tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_rs_pgo_query_t (tvb, offset, pinfo, tree, di, drep);\r\noffset =\r\ndissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_rs_pgo_query_key_t, NDR_POINTER_REF, "key:",\r\n-1);\r\nreturn offset;\r\n}\r\nstatic int\r\nrs_pgo_dissect_key_transfer_resp (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_rs_pgo_query_key_t, NDR_POINTER_REF, "key:",\r\n-1);\r\noffset =\r\ndissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_rs_cache_data_t, NDR_POINTER_REF,\r\n"cache_info:", -1);\r\noffset =\r\ndissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_error_status_t, NDR_POINTER_REF, "status:",\r\n-1);\r\nreturn offset;\r\n}\r\nstatic int\r\nrs_pgo_dissect_is_member_resp (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_rs_cache_data_t, NDR_POINTER_REF,\r\n"cache_info:", -1);\r\noffset =\r\ndissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_error_status_t, NDR_POINTER_REF, "status:",\r\n-1);\r\nreturn offset;\r\n}\r\nstatic int\r\nrs_pgo_dissect_is_member_rqst (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset += 4;\r\noffset = dissect_sec_rgy_domain_t (tvb, offset, pinfo, tree, di, drep);\r\noffset = dissect_sec_rgy_name_t (tvb, offset, pinfo, tree, di, drep);\r\noffset += 4;\r\noffset = dissect_sec_rgy_name_t (tvb, offset, pinfo, tree, di, drep);\r\nreturn offset;\r\n}\r\nstatic int\r\nrs_pgo_dissect_get_rqst (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nguint32 allow_aliases;\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset = dissect_sec_rgy_domain_t (tvb, offset, pinfo, tree, di, drep);\r\noffset =\r\ndissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_rs_pgo_query_key_t, NDR_POINTER_REF, "key:",\r\n-1);\r\noffset =\r\ndissect_ndr_uint32(tvb, offset, pinfo, tree, di, drep, hf_rs_var1,\r\n&allow_aliases);\r\ncol_append_fstr (pinfo->cinfo, COL_INFO, " :allow_aliases:%u",\r\nallow_aliases);\r\noffset += 4;\r\noffset =\r\ndissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_sec_rgy_cursor_t, NDR_POINTER_REF,\r\n"item_cursor:", -1);\r\nreturn offset;\r\n}\r\nstatic int\r\nrs_pgo_dissect_get_resp (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_sec_rgy_cursor_t, NDR_POINTER_REF,\r\n"item_cursor:", -1);\r\noffset =\r\ndissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_rs_cache_data_t, NDR_POINTER_REF,\r\n"cache_info:", -1);\r\noffset =\r\ndissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_rs_pgo_query_result_t, NDR_POINTER_REF,\r\n"result:", -1);\r\nreturn offset;\r\n}\r\nstatic int\r\nrs_pgo_dissect_delete_member_resp (tvbuff_t * tvb, int offset,\r\npacket_info * pinfo, proto_tree * tree,\r\ndcerpc_info *di, guint8 * drep)\r\n{\r\nif (di->conformant_run)\r\n{\r\nreturn offset;\r\n}\r\noffset =\r\ndissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_rs_cache_data_t, NDR_POINTER_REF,\r\n"cache_info:", -1);\r\noffset =\r\ndissect_ndr_pointer(tvb, offset, pinfo, tree, di, drep,\r\ndissect_error_status_t, NDR_POINTER_REF, "status:",\r\n-1);\r\nreturn offset;\r\n}\r\nvoid\r\nproto_register_rs_pgo (void)\r\n{\r\nstatic hf_register_info hf[] = {\r\n{&hf_rs_pgo_opnum,\r\n{"Operation", "rs_pgo.opnum", FT_UINT16, BASE_DEC, NULL, 0x0,\r\nNULL, HFILL}},\r\n{&hf_error_status_t,\r\n{"Error status", "rs_pgo.error_status", FT_UINT32, BASE_DEC, NULL,\r\n0x0, NULL, HFILL}},\r\n{&hf_rs_pgo_query_key_t,\r\n{"Query key", "rs_pgo.query_key", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{&hf_rs_pgo_query_result_t,\r\n{"Query result", "rs_pgo.query_result", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL}},\r\n{&hf_rs_pgo_query_t,\r\n{"Query", "rs_pgo.query", FT_UINT32, BASE_DEC, NULL,\r\n0x0, NULL, HFILL}},\r\n{&hf_rs_sec_rgy_pgo_item_t_quota,\r\n{"Quota", "rs_pgo.quota",\r\nFT_UINT32, BASE_DEC, NULL, 0x0, NULL, HFILL}},\r\n{&hf_rs_sec_rgy_pgo_item_t_unix_num,\r\n{"Unix num",\r\n"rs_pgo.unix_num", FT_UINT32, BASE_DEC, NULL, 0x0, NULL,\r\nHFILL}},\r\n{&hf_rs_timeval,\r\n{"Timeval", "rs_pgo.timeval", FT_RELATIVE_TIME, BASE_NONE, NULL,\r\n0x0, NULL, HFILL}},\r\n{&hf_rs_uuid1,\r\n{"Uuid1", "rs_pgo.uuid1", FT_GUID, BASE_NONE, NULL, 0x0, NULL, HFILL}},\r\n{&hf_rs_var1,\r\n{"Var1", "rs_pgo.var1", FT_UINT32, BASE_DEC, NULL, 0x0, NULL,\r\nHFILL}},\r\n{&hf_sec_rgy_domain_t,\r\n{"Domain", "rs_pgo.domain", FT_UINT32, BASE_DEC,\r\nNULL, 0x0, NULL, HFILL}},\r\n{&hf_sec_rgy_name_t_principalName_string,\r\n{"Name principalName", "rs_pgo.name_principalName", FT_STRING, BASE_NONE, NULL,\r\n0x0, NULL, HFILL}},\r\n{&hf_sec_rgy_name_t_size,\r\n{"Name_t size", "rs_pgo.name_t_size", FT_UINT32,\r\nBASE_DEC, NULL, 0x0, NULL, HFILL}},\r\n{&hf_sec_rgy_pgo_flags_t,\r\n{"Flags", "rs_pgo.flags", FT_UINT32,\r\nBASE_HEX, NULL, 0x0, NULL, HFILL}},\r\n{&hf_sec_rgy_pname_t_size,\r\n{"Pname_t size", "rs_pgo.pname_t_size", FT_UINT32, BASE_DEC, NULL,\r\n0x0, NULL, HFILL}},\r\n{&hf_sec_rgy_pname_t_principalName_string,\r\n{"Pname principalName", "rs_pgo.pname_principalName", FT_STRING,\r\nBASE_NONE, NULL, 0x0, NULL, HFILL}},\r\n{&hf_rs_pgo_unix_num_key_t,\r\n{"Unix num key", "rs_pgo.unix_num_key_t", FT_UINT32,\r\nBASE_DEC,\r\nNULL, 0x0, NULL, HFILL}}\r\n};\r\nstatic gint *ett[] = {\r\n&ett_error_status_t,\r\n&ett_rgy_acct_user_flags_t,\r\n&ett_rs_pgo,\r\n&ett_rs_pgo_id_key_t,\r\n&ett_rs_pgo_query_key_t,\r\n&ett_rs_pgo_query_result_t,\r\n&ett_rs_pgo_query_t,\r\n&ett_rs_pgo_result_t,\r\n&ett_rs_pgo_unix_num_key_t,\r\n&ett_sec_attr_component_name_t,\r\n&ett_sec_passwd_type_t,\r\n&ett_sec_rgy_acct_admin_flags_t,\r\n&ett_sec_rgy_acct_admin_t,\r\n&ett_sec_rgy_acct_auth_flags_t,\r\n&ett_sec_rgy_acct_key_t,\r\n&ett_sec_rgy_acct_user_t,\r\n&ett_sec_rgy_cursor_t,\r\n&ett_sec_rgy_foreign_id_t,\r\n&ett_sec_rgy_login_name_t,\r\n&ett_sec_rgy_name_t,\r\n&ett_sec_rgy_domain_t,\r\n&ett_sec_rgy_pgo_flags_t,\r\n&ett_sec_rgy_pgo_item_t,\r\n&ett_sec_rgy_pname_t,\r\n&ett_sec_rgy_sid_t,\r\n&ett_sec_rgy_unix_passwd_buf_t,\r\n&ett_sec_rgy_unix_sid_t,\r\n&ett_sec_timeval_sec_t,\r\n&ett_rs_cache_data_t,\r\n};\r\nproto_rs_pgo =\r\nproto_register_protocol ("DCE Name Service", "RS_PGO", "rs_pgo");\r\nproto_register_field_array (proto_rs_pgo, hf, array_length (hf));\r\nproto_register_subtree_array (ett, array_length (ett));\r\n}\r\nvoid\r\nproto_reg_handoff_rs_pgo (void)\r\n{\r\ndcerpc_init_uuid (proto_rs_pgo, ett_rs_pgo, &uuid_rs_pgo, ver_rs_pgo,\r\nrs_pgo_dissectors, hf_rs_pgo_opnum);\r\n}
