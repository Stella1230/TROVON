EVP_PKEY * ReadPublicKey(const char *certfile)\r\n{\r\nFILE *fp = fopen (certfile, "r");\r\nX509 *x509;\r\nEVP_PKEY *pkey;\r\nif (!fp)\r\nreturn NULL;\r\nx509 = PEM_read_X509(fp, NULL, 0, NULL);\r\nif (x509 == NULL)\r\n{\r\nERR_print_errors_fp (stderr);\r\nreturn NULL;\r\n}\r\nfclose (fp);\r\npkey=X509_extract_key(x509);\r\nX509_free(x509);\r\nif (pkey == NULL)\r\nERR_print_errors_fp (stderr);\r\nreturn pkey;\r\n}\r\nEVP_PKEY *ReadPrivateKey(const char *keyfile)\r\n{\r\nFILE *fp = fopen(keyfile, "r");\r\nEVP_PKEY *pkey;\r\nif (!fp)\r\nreturn NULL;\r\npkey = PEM_read_PrivateKey(fp, NULL, 0, NULL);\r\nfclose (fp);\r\nif (pkey == NULL)\r\nERR_print_errors_fp (stderr);\r\nreturn pkey;\r\n}
