int i2d_PublicKey(EVP_PKEY *a, unsigned char **pp)\r\n{\r\nswitch (a->type)\r\n{\r\n#ifndef OPENSSL_NO_RSA\r\ncase EVP_PKEY_RSA:\r\nreturn(i2d_RSAPublicKey(a->pkey.rsa,pp));\r\n#endif\r\n#ifndef OPENSSL_NO_DSA\r\ncase EVP_PKEY_DSA:\r\nreturn(i2d_DSAPublicKey(a->pkey.dsa,pp));\r\n#endif\r\n#ifndef OPENSSL_NO_EC\r\ncase EVP_PKEY_EC:\r\nreturn(i2o_ECPublicKey(a->pkey.ec, pp));\r\n#endif\r\ndefault:\r\nASN1err(ASN1_F_I2D_PUBLICKEY,ASN1_R_UNSUPPORTED_PUBLIC_KEY_TYPE);\r\nreturn(-1);\r\n}\r\n}
