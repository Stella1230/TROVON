static int rc5_ctrl(EVP_CIPHER_CTX *c, int type, int arg, void *ptr)\r\n{\r\nswitch(type)\r\n{\r\ncase EVP_CTRL_INIT:\r\ndata(c)->rounds = RC5_12_ROUNDS;\r\nreturn 1;\r\ncase EVP_CTRL_GET_RC5_ROUNDS:\r\n*(int *)ptr = data(c)->rounds;\r\nreturn 1;\r\ncase EVP_CTRL_SET_RC5_ROUNDS:\r\nswitch(arg)\r\n{\r\ncase RC5_8_ROUNDS:\r\ncase RC5_12_ROUNDS:\r\ncase RC5_16_ROUNDS:\r\ndata(c)->rounds = arg;\r\nreturn 1;\r\ndefault:\r\nEVPerr(EVP_F_RC5_CTRL, EVP_R_UNSUPORTED_NUMBER_OF_ROUNDS);\r\nreturn 0;\r\n}\r\ndefault:\r\nreturn -1;\r\n}\r\n}\r\nstatic int r_32_12_16_init_key(EVP_CIPHER_CTX *ctx, const unsigned char *key,\r\nconst unsigned char *iv, int enc)\r\n{\r\nRC5_32_set_key(&data(ctx)->ks,EVP_CIPHER_CTX_key_length(ctx),\r\nkey,data(ctx)->rounds);\r\nreturn 1;\r\n}
