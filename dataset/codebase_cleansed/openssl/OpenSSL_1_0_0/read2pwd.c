int DES_read_password(DES_cblock *key, const char *prompt, int verify)\r\n{\r\nint ok;\r\nchar buf[BUFSIZ],buff[BUFSIZ];\r\nif ((ok=UI_UTIL_read_pw(buf,buff,BUFSIZ,prompt,verify)) == 0)\r\nDES_string_to_key(buf,key);\r\nOPENSSL_cleanse(buf,BUFSIZ);\r\nOPENSSL_cleanse(buff,BUFSIZ);\r\nreturn(ok);\r\n}\r\nint DES_read_2passwords(DES_cblock *key1, DES_cblock *key2, const char *prompt,\r\nint verify)\r\n{\r\nint ok;\r\nchar buf[BUFSIZ],buff[BUFSIZ];\r\nif ((ok=UI_UTIL_read_pw(buf,buff,BUFSIZ,prompt,verify)) == 0)\r\nDES_string_to_2keys(buf,key1,key2);\r\nOPENSSL_cleanse(buf,BUFSIZ);\r\nOPENSSL_cleanse(buff,BUFSIZ);\r\nreturn(ok);\r\n}
