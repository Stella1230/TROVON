const char *BF_options(void)\r\n{\r\n#ifdef BF_PTR\r\nreturn("blowfish(ptr)");\r\n#elif defined(BF_PTR2)\r\nreturn("blowfish(ptr2)");\r\n#else\r\nreturn("blowfish(idx)");\r\n#endif\r\n}\r\nvoid BF_ecb_encrypt(const unsigned char *in, unsigned char *out,\r\nconst BF_KEY *key, int encrypt)\r\n{\r\nBF_LONG l,d[2];\r\nn2l(in,l); d[0]=l;\r\nn2l(in,l); d[1]=l;\r\nif (encrypt)\r\nBF_encrypt(d,key);\r\nelse\r\nBF_decrypt(d,key);\r\nl=d[0]; l2n(l,out);\r\nl=d[1]; l2n(l,out);\r\nl=d[0]=d[1]=0;\r\n}
