DH *d2i_DHparams(DH **a, unsigned char **pp, long length)\r\n{\r\nint i=ERR_R_NESTED_ASN1_ERROR;\r\nASN1_INTEGER *bs=NULL;\r\nlong v=0;\r\nM_ASN1_D2I_vars(a,DH *,DH_new);\r\nM_ASN1_D2I_Init();\r\nM_ASN1_D2I_start_sequence();\r\nM_ASN1_D2I_get(bs,d2i_ASN1_INTEGER);\r\nif ((ret->p=BN_bin2bn(bs->data,bs->length,ret->p)) == NULL) goto err_bn;\r\nM_ASN1_D2I_get(bs,d2i_ASN1_INTEGER);\r\nif ((ret->g=BN_bin2bn(bs->data,bs->length,ret->g)) == NULL) goto err_bn;\r\nif (!M_ASN1_D2I_end_sequence())\r\n{\r\nM_ASN1_D2I_get(bs,d2i_ASN1_INTEGER);\r\nfor (i=0; i<bs->length; i++)\r\nv=(v<<8)|(bs->data[i]);\r\nret->length=(int)v;\r\n}\r\nM_ASN1_BIT_STRING_free(bs);\r\nM_ASN1_D2I_Finish_2(a);\r\nerr_bn:\r\ni=ERR_R_BN_LIB;\r\nerr:\r\nASN1err(ASN1_F_D2I_DHPARAMS,i);\r\nif ((ret != NULL) && ((a == NULL) || (*a != ret))) DH_free(ret);\r\nif (bs != NULL) M_ASN1_BIT_STRING_free(bs);\r\nreturn(NULL);\r\n}
