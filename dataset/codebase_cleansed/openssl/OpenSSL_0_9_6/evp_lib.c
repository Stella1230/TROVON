int EVP_CIPHER_param_to_asn1(EVP_CIPHER_CTX *c, ASN1_TYPE *type)\r\n{\r\nint ret;\r\nif (c->cipher->set_asn1_parameters != NULL)\r\nret=c->cipher->set_asn1_parameters(c,type);\r\nelse\r\nret=1;\r\nreturn(ret);\r\n}\r\nint EVP_CIPHER_asn1_to_param(EVP_CIPHER_CTX *c, ASN1_TYPE *type)\r\n{\r\nint ret;\r\nif (c->cipher->get_asn1_parameters != NULL)\r\nret=c->cipher->get_asn1_parameters(c,type);\r\nelse\r\nret=1;\r\nreturn(ret);\r\n}\r\nint EVP_CIPHER_get_asn1_iv(EVP_CIPHER_CTX *c, ASN1_TYPE *type)\r\n{\r\nint i=0,l;\r\nif (type != NULL)\r\n{\r\nl=EVP_CIPHER_CTX_iv_length(c);\r\ni=ASN1_TYPE_get_octetstring(type,c->oiv,l);\r\nif (i != l)\r\nreturn(-1);\r\nelse if (i > 0)\r\nmemcpy(c->iv,c->oiv,l);\r\n}\r\nreturn(i);\r\n}\r\nint EVP_CIPHER_set_asn1_iv(EVP_CIPHER_CTX *c, ASN1_TYPE *type)\r\n{\r\nint i=0,j;\r\nif (type != NULL)\r\n{\r\nj=EVP_CIPHER_CTX_iv_length(c);\r\ni=ASN1_TYPE_set_octetstring(type,c->oiv,j);\r\n}\r\nreturn(i);\r\n}\r\nint EVP_CIPHER_type(const EVP_CIPHER *ctx)\r\n{\r\nint nid;\r\nASN1_OBJECT *otmp;\r\nnid = EVP_CIPHER_nid(ctx);\r\nswitch(nid) {\r\ncase NID_rc2_cbc:\r\ncase NID_rc2_64_cbc:\r\ncase NID_rc2_40_cbc:\r\nreturn NID_rc2_cbc;\r\ncase NID_rc4:\r\ncase NID_rc4_40:\r\nreturn NID_rc4;\r\ndefault:\r\notmp = OBJ_nid2obj(nid);\r\nif(!otmp || !otmp->data) nid = NID_undef;\r\nASN1_OBJECT_free(otmp);\r\nreturn nid;\r\n}\r\n}
