int ASN1_BIT_STRING_name_print(BIO *out, ASN1_BIT_STRING *bs,\r\nBIT_STRING_BITNAME *tbl, int indent)\r\n{\r\nBIT_STRING_BITNAME *bnam;\r\nchar first = 1;\r\nBIO_printf(out, "%*s", indent, "");\r\nfor(bnam = tbl; bnam->lname; bnam++) {\r\nif(ASN1_BIT_STRING_get_bit(bs, bnam->bitnum)) {\r\nif(!first) BIO_puts(out, ", ");\r\nBIO_puts(out, bnam->lname);\r\nfirst = 0;\r\n}\r\n}\r\nBIO_puts(out, "\n");\r\nreturn 1;\r\n}\r\nint ASN1_BIT_STRING_set_asc(ASN1_BIT_STRING *bs, char *name, int value,\r\nBIT_STRING_BITNAME *tbl)\r\n{\r\nint bitnum;\r\nbitnum = ASN1_BIT_STRING_num_asc(name, tbl);\r\nif(bitnum < 0) return 0;\r\nif(bs) ASN1_BIT_STRING_set_bit(bs, bitnum, value);\r\nreturn 1;\r\n}\r\nint ASN1_BIT_STRING_num_asc(char *name, BIT_STRING_BITNAME *tbl)\r\n{\r\nBIT_STRING_BITNAME *bnam;\r\nfor(bnam = tbl; bnam->lname; bnam++) {\r\nif(!strcmp(bnam->sname, name) ||\r\n!strcmp(bnam->lname, name) ) return bnam->bitnum;\r\n}\r\nreturn -1;\r\n}
