ASN1_METHOD *RSAPrivateKey_asn1_meth(void)\r\n{\r\nreturn(&method);\r\n}\r\nRSA *d2i_RSAPrivateKey(RSA **a, unsigned char **pp, long length)\r\n{\r\nint i=ASN1_R_PARSING;\r\nASN1_INTEGER *bs=NULL;\r\nM_ASN1_D2I_vars(a,RSA *,RSA_new);\r\nM_ASN1_D2I_Init();\r\nM_ASN1_D2I_start_sequence();\r\nM_ASN1_D2I_get(bs,d2i_ASN1_INTEGER);\r\nif (bs->length == 0)\r\nret->version=0;\r\nelse ret->version=bs->data[0];\r\nM_ASN1_D2I_get(bs,d2i_ASN1_INTEGER);\r\nif ((ret->n=BN_bin2bn(bs->data,bs->length,ret->n)) == NULL) goto err_bn;\r\nM_ASN1_D2I_get(bs,d2i_ASN1_INTEGER);\r\nif ((ret->e=BN_bin2bn(bs->data,bs->length,ret->e)) == NULL) goto err_bn;\r\nM_ASN1_D2I_get(bs,d2i_ASN1_INTEGER);\r\nif ((ret->d=BN_bin2bn(bs->data,bs->length,ret->d)) == NULL) goto err_bn;\r\nM_ASN1_D2I_get(bs,d2i_ASN1_INTEGER);\r\nif ((ret->p=BN_bin2bn(bs->data,bs->length,ret->p)) == NULL) goto err_bn;\r\nM_ASN1_D2I_get(bs,d2i_ASN1_INTEGER);\r\nif ((ret->q=BN_bin2bn(bs->data,bs->length,ret->q)) == NULL) goto err_bn;\r\nM_ASN1_D2I_get(bs,d2i_ASN1_INTEGER);\r\nif ((ret->dmp1=BN_bin2bn(bs->data,bs->length,ret->dmp1)) == NULL)\r\ngoto err_bn;\r\nM_ASN1_D2I_get(bs,d2i_ASN1_INTEGER);\r\nif ((ret->dmq1=BN_bin2bn(bs->data,bs->length,ret->dmq1)) == NULL)\r\ngoto err_bn;\r\nM_ASN1_D2I_get(bs,d2i_ASN1_INTEGER);\r\nif ((ret->iqmp=BN_bin2bn(bs->data,bs->length,ret->iqmp)) == NULL)\r\ngoto err_bn;\r\nM_ASN1_INTEGER_free(bs);\r\nM_ASN1_D2I_Finish_2(a);\r\nerr_bn:\r\ni=ERR_R_BN_LIB;\r\nerr:\r\nASN1err(ASN1_F_D2I_RSAPRIVATEKEY,i);\r\nif ((ret != NULL) && ((a == NULL) || (*a != ret))) RSA_free(ret);\r\nif (bs != NULL) M_ASN1_INTEGER_free(bs);\r\nreturn(NULL);\r\n}
