ASN1_IA5STRING *ASN1_IA5STRING_new(void)\r\n{ return M_ASN1_IA5STRING_new();}\r\nvoid ASN1_IA5STRING_free(ASN1_IA5STRING *x)\r\n{ M_ASN1_IA5STRING_free(x);}\r\nint i2d_ASN1_IA5STRING(ASN1_IA5STRING *a, unsigned char **pp)\r\n{ return(M_i2d_ASN1_IA5STRING(a,pp)); }\r\nASN1_IA5STRING *d2i_ASN1_IA5STRING(ASN1_IA5STRING **a, unsigned char **pp,\r\nlong l)\r\n{ return(M_d2i_ASN1_IA5STRING(a,pp,l)); }\r\nASN1_T61STRING *ASN1_T61STRING_new(void)\r\n{ return M_ASN1_T61STRING_new();}\r\nvoid ASN1_T61STRING_free(ASN1_T61STRING *x)\r\n{ M_ASN1_T61STRING_free(x);}\r\nASN1_T61STRING *d2i_ASN1_T61STRING(ASN1_T61STRING **a, unsigned char **pp,\r\nlong l)\r\n{ return(M_d2i_ASN1_T61STRING(a,pp,l)); }\r\nASN1_PRINTABLESTRING *ASN1_PRINTABLESTRING_new(void)\r\n{ return M_ASN1_PRINTABLESTRING_new();}\r\nvoid ASN1_PRINTABLESTRING_free(ASN1_PRINTABLESTRING *x)\r\n{ M_ASN1_PRINTABLESTRING_free(x);}\r\nASN1_PRINTABLESTRING *d2i_ASN1_PRINTABLESTRING(ASN1_PRINTABLESTRING **a,\r\nunsigned char **pp, long l)\r\n{ return(M_d2i_ASN1_PRINTABLESTRING(a,pp,\r\nl)); }\r\nint i2d_ASN1_PRINTABLESTRING(ASN1_PRINTABLESTRING *a, unsigned char **pp)\r\n{ return(M_i2d_ASN1_PRINTABLESTRING(a,pp)); }\r\nint i2d_ASN1_PRINTABLE(ASN1_STRING *a, unsigned char **pp)\r\n{ return(M_i2d_ASN1_PRINTABLE(a,pp)); }\r\nASN1_STRING *d2i_ASN1_PRINTABLE(ASN1_STRING **a, unsigned char **pp,\r\nlong l)\r\n{ return(M_d2i_ASN1_PRINTABLE(a,pp,l)); }\r\nint ASN1_PRINTABLE_type(unsigned char *s, int len)\r\n{\r\nint c;\r\nint ia5=0;\r\nint t61=0;\r\nif (len <= 0) len= -1;\r\nif (s == NULL) return(V_ASN1_PRINTABLESTRING);\r\nwhile ((*s) && (len-- != 0))\r\n{\r\nc= *(s++);\r\n#ifndef CHARSET_EBCDIC\r\nif (!( ((c >= 'a') && (c <= 'z')) ||\r\n((c >= 'A') && (c <= 'Z')) ||\r\n(c == ' ') ||\r\n((c >= '0') && (c <= '9')) ||\r\n(c == ' ') || (c == '\'') ||\r\n(c == '(') || (c == ')') ||\r\n(c == '+') || (c == ',') ||\r\n(c == '-') || (c == '.') ||\r\n(c == '/') || (c == ':') ||\r\n(c == '=') || (c == '?')))\r\nia5=1;\r\nif (c&0x80)\r\nt61=1;\r\n#else\r\nif (!isalnum(c) && (c != ' ') &&\r\nstrchr("'()+,-./:=?", c) == NULL)\r\nia5=1;\r\nif (os_toascii[c] & 0x80)\r\nt61=1;\r\n#endif\r\n}\r\nif (t61) return(V_ASN1_T61STRING);\r\nif (ia5) return(V_ASN1_IA5STRING);\r\nreturn(V_ASN1_PRINTABLESTRING);\r\n}\r\nint ASN1_UNIVERSALSTRING_to_string(ASN1_UNIVERSALSTRING *s)\r\n{\r\nint i;\r\nunsigned char *p;\r\nif (s->type != V_ASN1_UNIVERSALSTRING) return(0);\r\nif ((s->length%4) != 0) return(0);\r\np=s->data;\r\nfor (i=0; i<s->length; i+=4)\r\n{\r\nif ((p[0] != '\0') || (p[1] != '\0') || (p[2] != '\0'))\r\nbreak;\r\nelse\r\np+=4;\r\n}\r\nif (i < s->length) return(0);\r\np=s->data;\r\nfor (i=3; i<s->length; i+=4)\r\n{\r\n*(p++)=s->data[i];\r\n}\r\n*(p)='\0';\r\ns->length/=4;\r\ns->type=ASN1_PRINTABLE_type(s->data,s->length);\r\nreturn(1);\r\n}\r\nASN1_STRING *DIRECTORYSTRING_new(void)\r\n{ return M_DIRECTORYSTRING_new();}\r\nvoid DIRECTORYSTRING_free(ASN1_STRING *x)\r\n{ M_DIRECTORYSTRING_free(x);}\r\nint i2d_DIRECTORYSTRING(ASN1_STRING *a, unsigned char **pp)\r\n{ return(M_i2d_DIRECTORYSTRING(a,pp)); }\r\nASN1_STRING *d2i_DIRECTORYSTRING(ASN1_STRING **a, unsigned char **pp,\r\nlong l)\r\n{ return(M_d2i_DIRECTORYSTRING(a,pp,l)); }\r\nASN1_STRING *DISPLAYTEXT_new(void)\r\n{ return M_DISPLAYTEXT_new();}\r\nvoid DISPLAYTEXT_free(ASN1_STRING *x)\r\n{ M_DISPLAYTEXT_free(x);}\r\nint i2d_DISPLAYTEXT(ASN1_STRING *a, unsigned char **pp)\r\n{ return(M_i2d_DISPLAYTEXT(a,pp)); }\r\nASN1_STRING *d2i_DISPLAYTEXT(ASN1_STRING **a, unsigned char **pp,\r\nlong l)\r\n{ return(M_d2i_DISPLAYTEXT(a,pp,l)); }
