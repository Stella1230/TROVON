const char *des_options(void)\r\n{\r\nstatic int init=1;\r\nstatic char buf[32];\r\nif (init)\r\n{\r\nconst char *ptr,*unroll,*risc,*size;\r\n#ifdef DES_PTR\r\nptr="ptr";\r\n#else\r\nptr="idx";\r\n#endif\r\n#if defined(DES_RISC1) || defined(DES_RISC2)\r\n#ifdef DES_RISC1\r\nrisc="risc1";\r\n#endif\r\n#ifdef DES_RISC2\r\nrisc="risc2";\r\n#endif\r\n#else\r\nrisc="cisc";\r\n#endif\r\n#ifdef DES_UNROLL\r\nunroll="16";\r\n#else\r\nunroll="4";\r\n#endif\r\nif (sizeof(DES_LONG) != sizeof(long))\r\nsize="int";\r\nelse\r\nsize="long";\r\nsprintf(buf,"des(%s,%s,%s,%s)",ptr,risc,unroll,size);\r\ninit=0;\r\n}\r\nreturn(buf);\r\n}\r\nvoid des_ecb_encrypt(const_des_cblock *input, des_cblock *output,\r\ndes_key_schedule ks,\r\nint enc)\r\n{\r\nregister DES_LONG l;\r\nDES_LONG ll[2];\r\nconst unsigned char *in = &(*input)[0];\r\nunsigned char *out = &(*output)[0];\r\nc2l(in,l); ll[0]=l;\r\nc2l(in,l); ll[1]=l;\r\ndes_encrypt(ll,ks,enc);\r\nl=ll[0]; l2c(l,out);\r\nl=ll[1]; l2c(l,out);\r\nl=ll[0]=ll[1]=0;\r\n}
