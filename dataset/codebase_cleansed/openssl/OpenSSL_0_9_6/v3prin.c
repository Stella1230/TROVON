int main(int argc, char **argv)\r\n{\r\nX509 *cert;\r\nFILE *inf;\r\nint i, count;\r\nX509_EXTENSION *ext;\r\nX509V3_add_standard_extensions();\r\nERR_load_crypto_strings();\r\nif(!argv[1]) {\r\nfprintf(stderr, "Usage v3prin cert.pem\n");\r\nexit(1);\r\n}\r\nif(!(inf = fopen(argv[1], "r"))) {\r\nfprintf(stderr, "Can't open %s\n", argv[1]);\r\nexit(1);\r\n}\r\nif(!(cert = PEM_read_X509(inf, NULL, NULL))) {\r\nfprintf(stderr, "Can't read certificate %s\n", argv[1]);\r\nERR_print_errors_fp(stderr);\r\nexit(1);\r\n}\r\nfclose(inf);\r\ncount = X509_get_ext_count(cert);\r\nprintf("%d extensions\n", count);\r\nfor(i = 0; i < count; i++) {\r\next = X509_get_ext(cert, i);\r\nprintf("%s\n", OBJ_nid2ln(OBJ_obj2nid(ext->object)));\r\nif(!X509V3_EXT_print_fp(stdout, ext, 0, 0)) ERR_print_errors_fp(stderr);\r\nprintf("\n");\r\n}\r\nreturn 0;\r\n}
