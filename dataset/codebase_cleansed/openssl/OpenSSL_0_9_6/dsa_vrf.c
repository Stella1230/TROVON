int DSA_do_verify(const unsigned char *dgst, int dgst_len, DSA_SIG *sig,\r\nDSA *dsa)\r\n{\r\nreturn dsa->meth->dsa_do_verify(dgst, dgst_len, sig, dsa);\r\n}\r\nint DSA_verify(int type, const unsigned char *dgst, int dgst_len,\r\nunsigned char *sigbuf, int siglen, DSA *dsa)\r\n{\r\nDSA_SIG *s;\r\nint ret=-1;\r\ns = DSA_SIG_new();\r\nif (s == NULL) return(ret);\r\nif (d2i_DSA_SIG(&s,&sigbuf,siglen) == NULL) goto err;\r\nret=DSA_do_verify(dgst,dgst_len,s,dsa);\r\nerr:\r\nDSA_SIG_free(s);\r\nreturn(ret);\r\n}
