int main(int argc, char *argv[])\r\n{\r\nint i,err=0;\r\nFILE *IN;\r\nif (argc == 1)\r\n{\r\ndo_fp(stdin);\r\n}\r\nelse\r\n{\r\nfor (i=1; i<argc; i++)\r\n{\r\nIN=fopen(argv[i],"r");\r\nif (IN == NULL)\r\n{\r\nperror(argv[i]);\r\nerr++;\r\ncontinue;\r\n}\r\nprintf("MD2(%s)= ",argv[i]);\r\ndo_fp(IN);\r\nfclose(IN);\r\n}\r\n}\r\nexit(err);\r\nreturn(err);\r\n}\r\nvoid do_fp(FILE *f)\r\n{\r\nMD2_CTX c;\r\nunsigned char md[MD2_DIGEST_LENGTH];\r\nint fd,i;\r\nstatic unsigned char buf[BUFSIZE];\r\nfd=fileno(f);\r\nMD2_Init(&c);\r\nfor (;;)\r\n{\r\ni=read(fd,buf,BUFSIZE);\r\nif (i <= 0) break;\r\nMD2_Update(&c,buf,(unsigned long)i);\r\n}\r\nMD2_Final(&(md[0]),&c);\r\npt(md);\r\n}\r\nvoid pt(unsigned char *md)\r\n{\r\nint i;\r\nfor (i=0; i<MD2_DIGEST_LENGTH; i++)\r\nprintf("%02x",md[i]);\r\nprintf("\n");\r\n}
