int i2d_NETSCAPE_CERT_SEQUENCE(NETSCAPE_CERT_SEQUENCE *a, unsigned char **pp)\r\n{\r\nint v = 0;\r\nM_ASN1_I2D_vars(a);\r\nM_ASN1_I2D_len (a->type, i2d_ASN1_OBJECT);\r\nM_ASN1_I2D_len_EXP_SEQUENCE_opt_type(X509,a->certs,i2d_X509,0,\r\nV_ASN1_SEQUENCE,v);\r\nM_ASN1_I2D_seq_total();\r\nM_ASN1_I2D_put (a->type, i2d_ASN1_OBJECT);\r\nM_ASN1_I2D_put_EXP_SEQUENCE_opt_type(X509,a->certs,i2d_X509,0,\r\nV_ASN1_SEQUENCE,v);\r\nM_ASN1_I2D_finish();\r\n}\r\nNETSCAPE_CERT_SEQUENCE *NETSCAPE_CERT_SEQUENCE_new(void)\r\n{\r\nNETSCAPE_CERT_SEQUENCE *ret=NULL;\r\nASN1_CTX c;\r\nM_ASN1_New_Malloc(ret, NETSCAPE_CERT_SEQUENCE);\r\nret->type = OBJ_nid2obj(NID_netscape_cert_sequence);\r\nret->certs = NULL;\r\nreturn (ret);\r\nM_ASN1_New_Error(ASN1_F_NETSCAPE_CERT_SEQUENCE_NEW);\r\n}\r\nNETSCAPE_CERT_SEQUENCE *d2i_NETSCAPE_CERT_SEQUENCE(NETSCAPE_CERT_SEQUENCE **a,\r\nunsigned char **pp, long length)\r\n{\r\nM_ASN1_D2I_vars(a,NETSCAPE_CERT_SEQUENCE *,\r\nNETSCAPE_CERT_SEQUENCE_new);\r\nM_ASN1_D2I_Init();\r\nM_ASN1_D2I_start_sequence();\r\nM_ASN1_D2I_get (ret->type, d2i_ASN1_OBJECT);\r\nM_ASN1_D2I_get_EXP_set_opt_type(X509,ret->certs,d2i_X509,X509_free,0,\r\nV_ASN1_SEQUENCE);\r\nM_ASN1_D2I_Finish(a, NETSCAPE_CERT_SEQUENCE_free,\r\nASN1_F_D2I_NETSCAPE_CERT_SEQUENCE);\r\n}\r\nvoid NETSCAPE_CERT_SEQUENCE_free (NETSCAPE_CERT_SEQUENCE *a)\r\n{\r\nif (a == NULL) return;\r\nASN1_OBJECT_free(a->type);\r\nif(a->certs)\r\nsk_X509_pop_free(a->certs, X509_free);\r\nFree (a);\r\n}
