EVP_CIPHER *EVP_idea_ecb(void)\r\n{\r\nreturn(&i_ecb_cipher);\r\n}\r\nstatic void idea_ecb_init_key(EVP_CIPHER_CTX *ctx, unsigned char *key,\r\nunsigned char *iv, int enc)\r\n{\r\nif (key != NULL)\r\n{\r\nif (enc)\r\nidea_set_encrypt_key(key,&(ctx->c.idea_ks));\r\nelse\r\n{\r\nIDEA_KEY_SCHEDULE tmp;\r\nidea_set_encrypt_key(key,&tmp);\r\nidea_set_decrypt_key(&tmp, &(ctx->c.idea_ks));\r\nmemset((unsigned char *)&tmp,0,\r\nsizeof(IDEA_KEY_SCHEDULE));\r\n}\r\n}\r\n}\r\nstatic void idea_ecb_cipher(EVP_CIPHER_CTX *ctx, unsigned char *out,\r\nunsigned char *in, unsigned int inl)\r\n{\r\nunsigned int i;\r\nif (inl < 8) return;\r\ninl-=8;\r\nfor (i=0; i<=inl; i+=8)\r\n{\r\nidea_ecb_encrypt(\r\n&(in[i]),&(out[i]),&(ctx->c.idea_ks));\r\n}\r\n}
