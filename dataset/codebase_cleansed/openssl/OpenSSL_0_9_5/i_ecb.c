const char *idea_options(void)\r\n{\r\nif (sizeof(short) != sizeof(IDEA_INT))\r\nreturn("idea(int)");\r\nelse\r\nreturn("idea(short)");\r\n}\r\nvoid idea_ecb_encrypt(unsigned char *in, unsigned char *out,\r\nIDEA_KEY_SCHEDULE *ks)\r\n{\r\nunsigned long l0,l1,d[2];\r\nn2l(in,l0); d[0]=l0;\r\nn2l(in,l1); d[1]=l1;\r\nidea_encrypt(d,ks);\r\nl0=d[0]; l2n(l0,out);\r\nl1=d[1]; l2n(l1,out);\r\nl0=l1=d[0]=d[1]=0;\r\n}
