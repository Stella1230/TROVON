EVP_CIPHER *EVP_rc5_32_12_16_cbc(void)\r\n{\r\nreturn(&rc5_32_12_16_cbc_cipher);\r\n}\r\nstatic void r_32_12_16_cbc_init_key(EVP_CIPHER_CTX *ctx, unsigned char *key,\r\nunsigned char *iv, int enc)\r\n{\r\nif (iv != NULL)\r\nmemcpy(&(ctx->oiv[0]),iv,8);\r\nmemcpy(&(ctx->iv[0]),&(ctx->oiv[0]),8);\r\nif (key != NULL)\r\nRC5_32_set_key(&(ctx->c.rc5_ks),EVP_RC5_32_12_16_KEY_SIZE,\r\nkey,RC5_12_ROUNDS);\r\n}\r\nstatic void r_32_12_16_cbc_cipher(EVP_CIPHER_CTX *ctx, unsigned char *out,\r\nunsigned char *in, unsigned int inl)\r\n{\r\nRC5_32_cbc_encrypt(\r\nin,out,(long)inl,\r\n&(ctx->c.rc5_ks),&(ctx->iv[0]),\r\nctx->encrypt);\r\n}
