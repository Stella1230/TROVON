unsigned char *asc2uni (const char *asc, unsigned char **uni, int *unilen)\r\n{\r\nint ulen, i;\r\nunsigned char *unitmp;\r\nulen = strlen(asc)*2 + 2;\r\nif (!(unitmp = Malloc (ulen))) return NULL;\r\nfor (i = 0; i < ulen; i+=2) {\r\nunitmp[i] = 0;\r\nunitmp[i + 1] = asc[i>>1];\r\n}\r\nif (unilen) *unilen = ulen;\r\nif (uni) *uni = unitmp;\r\nreturn unitmp;\r\n}\r\nchar *uni2asc (unsigned char *uni, int unilen)\r\n{\r\nint asclen, i;\r\nchar *asctmp;\r\nasclen = unilen / 2;\r\nif (uni[unilen - 1]) asclen++;\r\nuni++;\r\nif (!(asctmp = Malloc (asclen))) return NULL;\r\nfor (i = 0; i < unilen; i+=2) asctmp[i>>1] = uni[i];\r\nasctmp[asclen - 1] = 0;\r\nreturn asctmp;\r\n}\r\nint i2d_PKCS12_bio(BIO *bp, PKCS12 *p12)\r\n{\r\nreturn ASN1_i2d_bio((int(*)())i2d_PKCS12, bp, (unsigned char *)p12);\r\n}\r\nint i2d_PKCS12_fp(FILE *fp, PKCS12 *p12)\r\n{\r\nreturn ASN1_i2d_fp((int(*)())i2d_PKCS12, fp, (unsigned char *)p12);\r\n}\r\nPKCS12 *d2i_PKCS12_bio(BIO *bp, PKCS12 **p12)\r\n{\r\nreturn (PKCS12 *)ASN1_d2i_bio((char *(*)())PKCS12_new,\r\n(char *(*)())d2i_PKCS12, bp, (unsigned char **)p12);\r\n}\r\nPKCS12 *d2i_PKCS12_fp(FILE *fp, PKCS12 **p12)\r\n{\r\nreturn (PKCS12 *)ASN1_d2i_fp((char *(*)())PKCS12_new,\r\n(char *(*)())d2i_PKCS12, fp, (unsigned char **)(p12));\r\n}
