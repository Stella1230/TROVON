void EVP_DigestInit(EVP_MD_CTX *ctx, const EVP_MD *type)\r\n{\r\nctx->digest=type;\r\ntype->init(&(ctx->md));\r\n}\r\nvoid EVP_DigestUpdate(EVP_MD_CTX *ctx, const void *data,\r\nunsigned int count)\r\n{\r\nctx->digest->update(&(ctx->md.base[0]),data,(unsigned long)count);\r\n}\r\nvoid EVP_DigestFinal(EVP_MD_CTX *ctx, unsigned char *md, unsigned int *size)\r\n{\r\nctx->digest->final(md,&(ctx->md.base[0]));\r\nif (size != NULL)\r\n*size=ctx->digest->md_size;\r\nmemset(&(ctx->md),0,sizeof(ctx->md));\r\n}\r\nint EVP_MD_CTX_copy(EVP_MD_CTX *out, EVP_MD_CTX *in)\r\n{\r\nif ((in == NULL) || (in->digest == NULL)) {\r\nEVPerr(EVP_F_EVP_MD_CTX_COPY,EVP_R_INPUT_NOT_INITIALIZED);\r\nreturn 0;\r\n}\r\nmemcpy((char *)out,(char *)in,in->digest->ctx_size);\r\nreturn 1;\r\n}
