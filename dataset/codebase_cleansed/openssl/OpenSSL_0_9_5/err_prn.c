void ERR_print_errors_fp(FILE *fp)\r\n{\r\nunsigned long l;\r\nchar buf[200];\r\nconst char *file,*data;\r\nint line,flags;\r\nunsigned long es;\r\nes=CRYPTO_thread_id();\r\nwhile ((l=ERR_get_error_line_data(&file,&line,&data,&flags)) != 0)\r\n{\r\nfprintf(fp,"%lu:%s:%s:%d:%s\n",es,ERR_error_string(l,buf),\r\nfile,line,(flags&ERR_TXT_STRING)?data:"");\r\n}\r\n}\r\nvoid ERR_print_errors(BIO *bp)\r\n{\r\nunsigned long l;\r\nchar buf[256];\r\nchar buf2[256];\r\nconst char *file,*data;\r\nint line,flags;\r\nunsigned long es;\r\nes=CRYPTO_thread_id();\r\nwhile ((l=ERR_get_error_line_data(&file,&line,&data,&flags)) != 0)\r\n{\r\nsprintf(buf2,"%lu:%s:%s:%d:",es,ERR_error_string(l,buf),\r\nfile,line);\r\nBIO_write(bp,buf2,strlen(buf2));\r\nif (flags & ERR_TXT_STRING)\r\nBIO_write(bp,data,strlen(data));\r\nBIO_write(bp,"\n",1);\r\n}\r\n}
