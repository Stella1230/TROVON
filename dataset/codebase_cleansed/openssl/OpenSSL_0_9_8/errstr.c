int MAIN(int argc, char **argv)\r\n{\r\nint i,ret=0;\r\nchar buf[256];\r\nunsigned long l;\r\napps_startup();\r\nif (bio_err == NULL)\r\nif ((bio_err=BIO_new(BIO_s_file())) != NULL)\r\nBIO_set_fp(bio_err,stderr,BIO_NOCLOSE|BIO_FP_TEXT);\r\nSSL_load_error_strings();\r\nif ((argc > 1) && (strcmp(argv[1],"-stats") == 0))\r\n{\r\nBIO *out=NULL;\r\nout=BIO_new(BIO_s_file());\r\nif ((out != NULL) && BIO_set_fp(out,stdout,BIO_NOCLOSE))\r\n{\r\n#ifdef OPENSSL_SYS_VMS\r\n{\r\nBIO *tmpbio = BIO_new(BIO_f_linebuffer());\r\nout = BIO_push(tmpbio, out);\r\n}\r\n#endif\r\nlh_node_stats_bio((LHASH *)ERR_get_string_table(),out);\r\nlh_stats_bio((LHASH *)ERR_get_string_table(),out);\r\nlh_node_usage_stats_bio((LHASH *)\r\nERR_get_string_table(),out);\r\n}\r\nif (out != NULL) BIO_free_all(out);\r\nargc--;\r\nargv++;\r\n}\r\nfor (i=1; i<argc; i++)\r\n{\r\nif (sscanf(argv[i],"%lx",&l))\r\n{\r\nERR_error_string_n(l, buf, sizeof buf);\r\nprintf("%s\n",buf);\r\n}\r\nelse\r\n{\r\nprintf("%s: bad error code\n",argv[i]);\r\nprintf("usage: errstr [-stats] <errno> ...\n");\r\nret++;\r\n}\r\n}\r\napps_shutdown();\r\nOPENSSL_EXIT(ret);\r\n}
