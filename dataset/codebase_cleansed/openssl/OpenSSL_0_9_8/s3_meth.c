static SSL_METHOD *ssl3_get_method(int ver)\r\n{\r\nif (ver == SSL3_VERSION)\r\nreturn(SSLv3_method());\r\nelse\r\nreturn(NULL);\r\n}\r\nSSL_METHOD *SSLv3_method(void)\r\n{\r\nstatic int init=1;\r\nstatic SSL_METHOD SSLv3_data;\r\nif (init)\r\n{\r\nCRYPTO_w_lock(CRYPTO_LOCK_SSL_METHOD);\r\nif (init)\r\n{\r\nmemcpy((char *)&SSLv3_data,(char *)sslv3_base_method(),\r\nsizeof(SSL_METHOD));\r\nSSLv3_data.ssl_connect=ssl3_connect;\r\nSSLv3_data.ssl_accept=ssl3_accept;\r\nSSLv3_data.get_ssl_method=ssl3_get_method;\r\ninit=0;\r\n}\r\nCRYPTO_w_unlock(CRYPTO_LOCK_SSL_METHOD);\r\n}\r\nreturn(&SSLv3_data);\r\n}
