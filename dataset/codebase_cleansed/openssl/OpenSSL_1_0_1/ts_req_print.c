int TS_REQ_print_bio(BIO *bio, TS_REQ *a)\r\n{\r\nint v;\r\nASN1_OBJECT *policy_id;\r\nconst ASN1_INTEGER *nonce;\r\nif (a == NULL) return 0;\r\nv = TS_REQ_get_version(a);\r\nBIO_printf(bio, "Version: %d\n", v);\r\nTS_MSG_IMPRINT_print_bio(bio, TS_REQ_get_msg_imprint(a));\r\nBIO_printf(bio, "Policy OID: ");\r\npolicy_id = TS_REQ_get_policy_id(a);\r\nif (policy_id == NULL)\r\nBIO_printf(bio, "unspecified\n");\r\nelse\r\nTS_OBJ_print_bio(bio, policy_id);\r\nBIO_printf(bio, "Nonce: ");\r\nnonce = TS_REQ_get_nonce(a);\r\nif (nonce == NULL)\r\nBIO_printf(bio, "unspecified");\r\nelse\r\nTS_ASN1_INTEGER_print_bio(bio, nonce);\r\nBIO_write(bio, "\n", 1);\r\nBIO_printf(bio, "Certificate required: %s\n",\r\nTS_REQ_get_cert_req(a) ? "yes" : "no");\r\nTS_ext_print_bio(bio, TS_REQ_get_exts(a));\r\nreturn 1;\r\n}
