int ASN1_TYPE_get(ASN1_TYPE *a)\r\n{\r\nif ((a->value.ptr != NULL) || (a->type == V_ASN1_NULL))\r\nreturn(a->type);\r\nelse\r\nreturn(0);\r\n}\r\nvoid ASN1_TYPE_set(ASN1_TYPE *a, int type, void *value)\r\n{\r\nif (a->value.ptr != NULL)\r\n{\r\nASN1_TYPE **tmp_a = &a;\r\nASN1_primitive_free((ASN1_VALUE **)tmp_a, NULL);\r\n}\r\na->type=type;\r\nif (type == V_ASN1_BOOLEAN)\r\na->value.boolean = value ? 0xff : 0;\r\nelse\r\na->value.ptr=value;\r\n}\r\nint ASN1_TYPE_set1(ASN1_TYPE *a, int type, const void *value)\r\n{\r\nif (!value || (type == V_ASN1_BOOLEAN))\r\n{\r\nvoid *p = (void *)value;\r\nASN1_TYPE_set(a, type, p);\r\n}\r\nelse if (type == V_ASN1_OBJECT)\r\n{\r\nASN1_OBJECT *odup;\r\nodup = OBJ_dup(value);\r\nif (!odup)\r\nreturn 0;\r\nASN1_TYPE_set(a, type, odup);\r\n}\r\nelse\r\n{\r\nASN1_STRING *sdup;\r\nsdup = ASN1_STRING_dup(value);\r\nif (!sdup)\r\nreturn 0;\r\nASN1_TYPE_set(a, type, sdup);\r\n}\r\nreturn 1;\r\n}\r\nint ASN1_TYPE_cmp(ASN1_TYPE *a, ASN1_TYPE *b)\r\n{\r\nint result = -1;\r\nif (!a || !b || a->type != b->type) return -1;\r\nswitch (a->type)\r\n{\r\ncase V_ASN1_OBJECT:\r\nresult = OBJ_cmp(a->value.object, b->value.object);\r\nbreak;\r\ncase V_ASN1_NULL:\r\nresult = 0;\r\nbreak;\r\ncase V_ASN1_INTEGER:\r\ncase V_ASN1_NEG_INTEGER:\r\ncase V_ASN1_ENUMERATED:\r\ncase V_ASN1_NEG_ENUMERATED:\r\ncase V_ASN1_BIT_STRING:\r\ncase V_ASN1_OCTET_STRING:\r\ncase V_ASN1_SEQUENCE:\r\ncase V_ASN1_SET:\r\ncase V_ASN1_NUMERICSTRING:\r\ncase V_ASN1_PRINTABLESTRING:\r\ncase V_ASN1_T61STRING:\r\ncase V_ASN1_VIDEOTEXSTRING:\r\ncase V_ASN1_IA5STRING:\r\ncase V_ASN1_UTCTIME:\r\ncase V_ASN1_GENERALIZEDTIME:\r\ncase V_ASN1_GRAPHICSTRING:\r\ncase V_ASN1_VISIBLESTRING:\r\ncase V_ASN1_GENERALSTRING:\r\ncase V_ASN1_UNIVERSALSTRING:\r\ncase V_ASN1_BMPSTRING:\r\ncase V_ASN1_UTF8STRING:\r\ncase V_ASN1_OTHER:\r\ndefault:\r\nresult = ASN1_STRING_cmp((ASN1_STRING *) a->value.ptr,\r\n(ASN1_STRING *) b->value.ptr);\r\nbreak;\r\n}\r\nreturn result;\r\n}
