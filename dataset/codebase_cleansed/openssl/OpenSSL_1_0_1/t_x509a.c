int X509_CERT_AUX_print(BIO *out, X509_CERT_AUX *aux, int indent)\r\n{\r\nchar oidstr[80], first;\r\nint i;\r\nif(!aux) return 1;\r\nif(aux->trust) {\r\nfirst = 1;\r\nBIO_printf(out, "%*sTrusted Uses:\n%*s",\r\nindent, "", indent + 2, "");\r\nfor(i = 0; i < sk_ASN1_OBJECT_num(aux->trust); i++) {\r\nif(!first) BIO_puts(out, ", ");\r\nelse first = 0;\r\nOBJ_obj2txt(oidstr, sizeof oidstr,\r\nsk_ASN1_OBJECT_value(aux->trust, i), 0);\r\nBIO_puts(out, oidstr);\r\n}\r\nBIO_puts(out, "\n");\r\n} else BIO_printf(out, "%*sNo Trusted Uses.\n", indent, "");\r\nif(aux->reject) {\r\nfirst = 1;\r\nBIO_printf(out, "%*sRejected Uses:\n%*s",\r\nindent, "", indent + 2, "");\r\nfor(i = 0; i < sk_ASN1_OBJECT_num(aux->reject); i++) {\r\nif(!first) BIO_puts(out, ", ");\r\nelse first = 0;\r\nOBJ_obj2txt(oidstr, sizeof oidstr,\r\nsk_ASN1_OBJECT_value(aux->reject, i), 0);\r\nBIO_puts(out, oidstr);\r\n}\r\nBIO_puts(out, "\n");\r\n} else BIO_printf(out, "%*sNo Rejected Uses.\n", indent, "");\r\nif(aux->alias) BIO_printf(out, "%*sAlias: %s\n", indent, "",\r\naux->alias->data);\r\nif(aux->keyid) {\r\nBIO_printf(out, "%*sKey Id: ", indent, "");\r\nfor(i = 0; i < aux->keyid->length; i++)\r\nBIO_printf(out, "%s%02X",\r\ni ? ":" : "",\r\naux->keyid->data[i]);\r\nBIO_write(out,"\n",1);\r\n}\r\nreturn 1;\r\n}
