int main(int argc, char *argv[])\r\n{\r\nprintf("No SHA512 support\n");\r\nreturn(0);\r\n}\r\nint main (int argc,char **argv)\r\n{ unsigned char md[SHA512_DIGEST_LENGTH];\r\nint i;\r\nEVP_MD_CTX evp;\r\n#ifdef OPENSSL_IA32_SSE2\r\n{ char *env;\r\nif ((env=getenv("OPENSSL_ia32cap")))\r\nOPENSSL_ia32cap = strtoul (env,NULL,0);\r\n}\r\n#endif\r\nfprintf(stdout,"Testing SHA-512 ");\r\nEVP_Digest ("abc",3,md,NULL,EVP_sha512(),NULL);\r\nif (memcmp(md,app_c1,sizeof(app_c1)))\r\n{ fflush(stdout);\r\nfprintf(stderr,"\nTEST 1 of 3 failed.\n");\r\nreturn 1;\r\n}\r\nelse\r\nfprintf(stdout,"."); fflush(stdout);\r\nEVP_Digest ("abcdefgh""bcdefghi""cdefghij""defghijk"\r\n"efghijkl""fghijklm""ghijklmn""hijklmno"\r\n"ijklmnop""jklmnopq""klmnopqr""lmnopqrs"\r\n"mnopqrst""nopqrstu",112,md,NULL,EVP_sha512(),NULL);\r\nif (memcmp(md,app_c2,sizeof(app_c2)))\r\n{ fflush(stdout);\r\nfprintf(stderr,"\nTEST 2 of 3 failed.\n");\r\nreturn 1;\r\n}\r\nelse\r\nfprintf(stdout,"."); fflush(stdout);\r\nEVP_MD_CTX_init (&evp);\r\nEVP_DigestInit_ex (&evp,EVP_sha512(),NULL);\r\nfor (i=0;i<1000000;i+=288)\r\nEVP_DigestUpdate (&evp, "aaaaaaaa""aaaaaaaa""aaaaaaaa""aaaaaaaa"\r\n"aaaaaaaa""aaaaaaaa""aaaaaaaa""aaaaaaaa"\r\n"aaaaaaaa""aaaaaaaa""aaaaaaaa""aaaaaaaa"\r\n"aaaaaaaa""aaaaaaaa""aaaaaaaa""aaaaaaaa"\r\n"aaaaaaaa""aaaaaaaa""aaaaaaaa""aaaaaaaa"\r\n"aaaaaaaa""aaaaaaaa""aaaaaaaa""aaaaaaaa"\r\n"aaaaaaaa""aaaaaaaa""aaaaaaaa""aaaaaaaa"\r\n"aaaaaaaa""aaaaaaaa""aaaaaaaa""aaaaaaaa"\r\n"aaaaaaaa""aaaaaaaa""aaaaaaaa""aaaaaaaa",\r\n(1000000-i)<288?1000000-i:288);\r\nEVP_DigestFinal_ex (&evp,md,NULL);\r\nEVP_MD_CTX_cleanup (&evp);\r\nif (memcmp(md,app_c3,sizeof(app_c3)))\r\n{ fflush(stdout);\r\nfprintf(stderr,"\nTEST 3 of 3 failed.\n");\r\nreturn 1;\r\n}\r\nelse\r\nfprintf(stdout,"."); fflush(stdout);\r\nfprintf(stdout," passed.\n"); fflush(stdout);\r\nfprintf(stdout,"Testing SHA-384 ");\r\nEVP_Digest ("abc",3,md,NULL,EVP_sha384(),NULL);\r\nif (memcmp(md,app_d1,sizeof(app_d1)))\r\n{ fflush(stdout);\r\nfprintf(stderr,"\nTEST 1 of 3 failed.\n");\r\nreturn 1;\r\n}\r\nelse\r\nfprintf(stdout,"."); fflush(stdout);\r\nEVP_Digest ("abcdefgh""bcdefghi""cdefghij""defghijk"\r\n"efghijkl""fghijklm""ghijklmn""hijklmno"\r\n"ijklmnop""jklmnopq""klmnopqr""lmnopqrs"\r\n"mnopqrst""nopqrstu",112,md,NULL,EVP_sha384(),NULL);\r\nif (memcmp(md,app_d2,sizeof(app_d2)))\r\n{ fflush(stdout);\r\nfprintf(stderr,"\nTEST 2 of 3 failed.\n");\r\nreturn 1;\r\n}\r\nelse\r\nfprintf(stdout,"."); fflush(stdout);\r\nEVP_MD_CTX_init (&evp);\r\nEVP_DigestInit_ex (&evp,EVP_sha384(),NULL);\r\nfor (i=0;i<1000000;i+=64)\r\nEVP_DigestUpdate (&evp, "aaaaaaaa""aaaaaaaa""aaaaaaaa""aaaaaaaa"\r\n"aaaaaaaa""aaaaaaaa""aaaaaaaa""aaaaaaaa",\r\n(1000000-i)<64?1000000-i:64);\r\nEVP_DigestFinal_ex (&evp,md,NULL);\r\nEVP_MD_CTX_cleanup (&evp);\r\nif (memcmp(md,app_d3,sizeof(app_d3)))\r\n{ fflush(stdout);\r\nfprintf(stderr,"\nTEST 3 of 3 failed.\n");\r\nreturn 1;\r\n}\r\nelse\r\nfprintf(stdout,"."); fflush(stdout);\r\nfprintf(stdout," passed.\n"
