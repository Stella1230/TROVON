void ENGINE_unregister_ECDH(ENGINE *e)\r\n{\r\nengine_table_unregister(&ecdh_table, e);\r\n}\r\nstatic void engine_unregister_all_ECDH(void)\r\n{\r\nengine_table_cleanup(&ecdh_table);\r\n}\r\nint ENGINE_register_ECDH(ENGINE *e)\r\n{\r\nif(e->ecdh_meth)\r\nreturn engine_table_register(&ecdh_table,\r\nengine_unregister_all_ECDH, e, &dummy_nid, 1, 0);\r\nreturn 1;\r\n}\r\nvoid ENGINE_register_all_ECDH()\r\n{\r\nENGINE *e;\r\nfor(e=ENGINE_get_first() ; e ; e=ENGINE_get_next(e))\r\nENGINE_register_ECDH(e);\r\n}\r\nint ENGINE_set_default_ECDH(ENGINE *e)\r\n{\r\nif(e->ecdh_meth)\r\nreturn engine_table_register(&ecdh_table,\r\nengine_unregister_all_ECDH, e, &dummy_nid, 1, 1);\r\nreturn 1;\r\n}\r\nENGINE *ENGINE_get_default_ECDH(void)\r\n{\r\nreturn engine_table_select(&ecdh_table, dummy_nid);\r\n}\r\nconst ECDH_METHOD *ENGINE_get_ECDH(const ENGINE *e)\r\n{\r\nreturn e->ecdh_meth;\r\n}\r\nint ENGINE_set_ECDH(ENGINE *e, const ECDH_METHOD *ecdh_meth)\r\n{\r\ne->ecdh_meth = ecdh_meth;\r\nreturn 1;\r\n}
