const char *X509_verify_cert_error_string(long n)\r\n{\r\nstatic char buf[100];\r\nswitch ((int)n)\r\n{\r\ncase X509_V_OK:\r\nreturn("ok");\r\ncase X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT:\r\nreturn("unable to get issuer certificate");\r\ncase X509_V_ERR_UNABLE_TO_GET_CRL:\r\nreturn("unable to get certificate CRL");\r\ncase X509_V_ERR_UNABLE_TO_DECRYPT_CERT_SIGNATURE:\r\nreturn("unable to decrypt certificate's signature");\r\ncase X509_V_ERR_UNABLE_TO_DECRYPT_CRL_SIGNATURE:\r\nreturn("unable to decrypt CRL's signature");\r\ncase X509_V_ERR_UNABLE_TO_DECODE_ISSUER_PUBLIC_KEY:\r\nreturn("unable to decode issuer public key");\r\ncase X509_V_ERR_CERT_SIGNATURE_FAILURE:\r\nreturn("certificate signature failure");\r\ncase X509_V_ERR_CRL_SIGNATURE_FAILURE:\r\nreturn("CRL signature failure");\r\ncase X509_V_ERR_CERT_NOT_YET_VALID:\r\nreturn("certificate is not yet valid");\r\ncase X509_V_ERR_CRL_NOT_YET_VALID:\r\nreturn("CRL is not yet valid");\r\ncase X509_V_ERR_CERT_HAS_EXPIRED:\r\nreturn("certificate has expired");\r\ncase X509_V_ERR_CRL_HAS_EXPIRED:\r\nreturn("CRL has expired");\r\ncase X509_V_ERR_ERROR_IN_CERT_NOT_BEFORE_FIELD:\r\nreturn("format error in certificate's notBefore field");\r\ncase X509_V_ERR_ERROR_IN_CERT_NOT_AFTER_FIELD:\r\nreturn("format error in certificate's notAfter field");\r\ncase X509_V_ERR_ERROR_IN_CRL_LAST_UPDATE_FIELD:\r\nreturn("format error in CRL's lastUpdate field");\r\ncase X509_V_ERR_ERROR_IN_CRL_NEXT_UPDATE_FIELD:\r\nreturn("format error in CRL's nextUpdate field");\r\ncase X509_V_ERR_OUT_OF_MEM:\r\nreturn("out of memory");\r\ncase X509_V_ERR_DEPTH_ZERO_SELF_SIGNED_CERT:\r\nreturn("self signed certificate");\r\ncase X509_V_ERR_SELF_SIGNED_CERT_IN_CHAIN:\r\nreturn("self signed certificate in certificate chain");\r\ncase X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY:\r\nreturn("unable to get local issuer certificate");\r\ncase X509_V_ERR_UNABLE_TO_VERIFY_LEAF_SIGNATURE:\r\nreturn("unable to verify the first certificate");\r\ncase X509_V_ERR_CERT_CHAIN_TOO_LONG:\r\nreturn("certificate chain too long");\r\ncase X509_V_ERR_CERT_REVOKED:\r\nreturn("certificate revoked");\r\ncase X509_V_ERR_INVALID_CA:\r\nreturn ("invalid CA certificate");\r\ncase X509_V_ERR_INVALID_NON_CA:\r\nreturn ("invalid non-CA certificate (has CA markings)");\r\ncase X509_V_ERR_PATH_LENGTH_EXCEEDED:\r\nreturn ("path length constraint exceeded");\r\ncase X509_V_ERR_PROXY_PATH_LENGTH_EXCEEDED:\r\nreturn("proxy path length constraint exceeded");\r\ncase X509_V_ERR_PROXY_CERTIFICATES_NOT_ALLOWED:\r\nreturn("proxy certificates not allowed, please set the appropriate flag");\r\ncase X509_V_ERR_INVALID_PURPOSE:\r\nreturn ("unsupported certificate purpose");\r\ncase X509_V_ERR_CERT_UNTRUSTED:\r\nreturn ("certificate not trusted");\r\ncase X509_V_ERR_CERT_REJECTED:\r\nreturn ("certificate rejected");\r\ncase X509_V_ERR_APPLICATION_VERIFICATION:\r\nreturn("application verification failure");\r\ncase X509_V_ERR_SUBJECT_ISSUER_MISMATCH:\r\nreturn("subject issuer mismatch");\r\ncase X509_V_ERR_AKID_SKID_MISMATCH:\r\nreturn("authority and subject key identifier mismatch");\r\ncase X509_V_ERR_AKID_ISSUER_SERIAL_MISMATCH:\r\nreturn("authority and issuer serial number mismatch");\r\ncase X509_V_ERR_KEYUSAGE_NO_CERTSIGN:\r\nreturn("key usage does not include certificate signing");\r\ncase X509_V_ERR_UNABLE_TO_GET_CRL_ISSUER:\r\nreturn("unable to get CRL issuer certificate");\r\ncase X509_V_ERR_UNHANDLED_CRITICAL_EXTENSION:\r\nreturn("unhandled critical extension");\r\ncase X509_V_ERR_KEYUSAGE_NO_CRL_SIGN:\r\nreturn("key usage does not include CRL signing");\r\ncase X509_V_ERR_KEYUSAGE_NO_DIGITAL_SIGNATURE:\r\nreturn("key usage does not include digital signature");\r\ncase X509_V_ERR_UNHANDLED_CRITICAL_CRL_EXTENSION:\r\nreturn("unhandled critical CRL extension");\r\ncase X509_V_ERR_INVALID_EXTENSION:\r\nreturn("invalid or inconsistent certificate extension");\r\ncase X509_V_ERR_INVALID_POLICY_EXTENSION:\r\nreturn("invalid or inconsistent certificate policy extension");\r\ncase X509_V_ERR_NO_EXPLICIT_POLICY:\r\nreturn("no explicit policy");\r\ncase X509_V_ERR_DIFFERENT_CRL_SCOPE:\r\nreturn("Different CRL scope");\r\ncase X509_V_ERR_UNSUPPORTED_EXTENSION_FEATURE:\r\nreturn("Unsupported extension feature");\r\ncase X509_V_ERR_UNNESTED_RESOURCE:\r\nreturn("RFC 3779 resource not subset of parent's resources");\r\ncase X509_V_ERR_PERMITTED_VIOLATION:\r\nreturn("permitted subtree violation");\r\ncase X509_V_ERR_EXCLUDED_VIOLATION:\r\nreturn("excluded subtree violation");\r\ncase X509_V_ERR_SUBTREE_MINMAX:\r\nreturn("name constraints minimum and maximum not supported");\r\ncase X509_V_ERR_UNSUPPORTED_CONSTRAINT_TYPE:\r\nreturn("unsupported name constraint type");\r\ncase X509_V_ERR_UNSUPPORTED_CONSTRAINT_SYNTAX:\r\nreturn("unsupported or invalid name constraint syntax");\r\ncase X509_V_ERR_UNSUPPORTED_NAME_SYNTAX:\r\nreturn("unsupported or invalid name syntax");\r\ncase X509_V_ERR_CRL_PATH_VALIDATION_ERROR:\r\nreturn("CRL path validation error");\r\ndefault:\r\nBIO_snprintf(buf,sizeof buf,"error number %ld",n);\r\nreturn(buf);\r\n}\r\n}
