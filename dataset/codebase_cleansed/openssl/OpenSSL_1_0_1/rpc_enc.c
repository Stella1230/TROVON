int _des_crypt(char *buf, int len, struct desparams *desp)\r\n{\r\nDES_key_schedule ks;\r\nint enc;\r\nDES_set_key_unchecked(&desp->des_key,&ks);\r\nenc=(desp->des_dir == ENCRYPT)?DES_ENCRYPT:DES_DECRYPT;\r\nif (desp->des_mode == CBC)\r\nDES_ecb_encrypt((const_DES_cblock *)desp->UDES.UDES_buf,\r\n(DES_cblock *)desp->UDES.UDES_buf,&ks,\r\nenc);\r\nelse\r\n{\r\nDES_ncbc_encrypt(desp->UDES.UDES_buf,desp->UDES.UDES_buf,\r\nlen,&ks,&desp->des_ivec,enc);\r\n#ifdef undef\r\na=(char *)&(desp->UDES.UDES_buf[len-8]);\r\nb=(char *)&(desp->des_ivec[0]);\r\n*(a++)= *(b++); *(a++)= *(b++);\r\n*(a++)= *(b++); *(a++)= *(b++);\r\n*(a++)= *(b++); *(a++)= *(b++);\r\n*(a++)= *(b++); *(a++)= *(b++);\r\n#endif\r\n}\r\nreturn(1);\r\n}
