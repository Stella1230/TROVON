int X509_CRL_set_version(X509_CRL *x, long version)\r\n{\r\nif (x == NULL) return(0);\r\nif (x->crl->version == NULL)\r\n{\r\nif ((x->crl->version=M_ASN1_INTEGER_new()) == NULL)\r\nreturn(0);\r\n}\r\nreturn(ASN1_INTEGER_set(x->crl->version,version));\r\n}\r\nint X509_CRL_set_issuer_name(X509_CRL *x, X509_NAME *name)\r\n{\r\nif ((x == NULL) || (x->crl == NULL)) return(0);\r\nreturn(X509_NAME_set(&x->crl->issuer,name));\r\n}\r\nint X509_CRL_set_lastUpdate(X509_CRL *x, const ASN1_TIME *tm)\r\n{\r\nASN1_TIME *in;\r\nif (x == NULL) return(0);\r\nin=x->crl->lastUpdate;\r\nif (in != tm)\r\n{\r\nin=M_ASN1_TIME_dup(tm);\r\nif (in != NULL)\r\n{\r\nM_ASN1_TIME_free(x->crl->lastUpdate);\r\nx->crl->lastUpdate=in;\r\n}\r\n}\r\nreturn(in != NULL);\r\n}\r\nint X509_CRL_set_nextUpdate(X509_CRL *x, const ASN1_TIME *tm)\r\n{\r\nASN1_TIME *in;\r\nif (x == NULL) return(0);\r\nin=x->crl->nextUpdate;\r\nif (in != tm)\r\n{\r\nin=M_ASN1_TIME_dup(tm);\r\nif (in != NULL)\r\n{\r\nM_ASN1_TIME_free(x->crl->nextUpdate);\r\nx->crl->nextUpdate=in;\r\n}\r\n}\r\nreturn(in != NULL);\r\n}\r\nint X509_CRL_sort(X509_CRL *c)\r\n{\r\nint i;\r\nX509_REVOKED *r;\r\nsk_X509_REVOKED_sort(c->crl->revoked);\r\nfor (i=0; i<sk_X509_REVOKED_num(c->crl->revoked); i++)\r\n{\r\nr=sk_X509_REVOKED_value(c->crl->revoked,i);\r\nr->sequence=i;\r\n}\r\nc->crl->enc.modified = 1;\r\nreturn 1;\r\n}\r\nint X509_REVOKED_set_revocationDate(X509_REVOKED *x, ASN1_TIME *tm)\r\n{\r\nASN1_TIME *in;\r\nif (x == NULL) return(0);\r\nin=x->revocationDate;\r\nif (in != tm)\r\n{\r\nin=M_ASN1_TIME_dup(tm);\r\nif (in != NULL)\r\n{\r\nM_ASN1_TIME_free(x->revocationDate);\r\nx->revocationDate=in;\r\n}\r\n}\r\nreturn(in != NULL);\r\n}\r\nint X509_REVOKED_set_serialNumber(X509_REVOKED *x, ASN1_INTEGER *serial)\r\n{\r\nASN1_INTEGER *in;\r\nif (x == NULL) return(0);\r\nin=x->serialNumber;\r\nif (in != serial)\r\n{\r\nin=M_ASN1_INTEGER_dup(serial);\r\nif (in != NULL)\r\n{\r\nM_ASN1_INTEGER_free(x->serialNumber);\r\nx->serialNumber=in;\r\n}\r\n}\r\nreturn(in != NULL);\r\n}
