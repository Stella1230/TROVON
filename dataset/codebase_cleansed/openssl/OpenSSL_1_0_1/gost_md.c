int gost_digest_init(EVP_MD_CTX *ctx)\r\n{\r\nstruct ossl_gost_digest_ctx *c = ctx->md_data;\r\nmemset(&(c->dctx),0,sizeof(gost_hash_ctx));\r\ngost_init(&(c->cctx),&GostR3411_94_CryptoProParamSet);\r\nc->dctx.cipher_ctx= &(c->cctx);\r\nreturn 1;\r\n}\r\nint gost_digest_update(EVP_MD_CTX *ctx,const void *data,size_t count)\r\n{\r\nreturn hash_block((gost_hash_ctx *)ctx->md_data,data,count);\r\n}\r\nint gost_digest_final(EVP_MD_CTX *ctx,unsigned char *md)\r\n{\r\nreturn finish_hash((gost_hash_ctx *)ctx->md_data,md);\r\n}\r\nint gost_digest_copy(EVP_MD_CTX *to,const EVP_MD_CTX *from)\r\n{\r\nstruct ossl_gost_digest_ctx *md_ctx=to->md_data;\r\nif (to->md_data && from->md_data) {\r\nmemcpy(to->md_data,from->md_data,sizeof(struct ossl_gost_digest_ctx));\r\nmd_ctx->dctx.cipher_ctx=&(md_ctx->cctx);\r\n}\r\nreturn 1;\r\n}\r\nint gost_digest_cleanup(EVP_MD_CTX *ctx)\r\n{\r\nif (ctx->md_data)\r\nmemset(ctx->md_data,0,sizeof(struct ossl_gost_digest_ctx));\r\nreturn 1;\r\n}
