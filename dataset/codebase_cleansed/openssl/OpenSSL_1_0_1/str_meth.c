STORE_METHOD *STORE_create_method(char *name)\r\n{\r\nSTORE_METHOD *store_method = (STORE_METHOD *)OPENSSL_malloc(sizeof(STORE_METHOD));\r\nif (store_method)\r\n{\r\nmemset(store_method, 0, sizeof(*store_method));\r\nstore_method->name = BUF_strdup(name);\r\n}\r\nreturn store_method;\r\n}\r\nvoid STORE_destroy_method(STORE_METHOD *store_method)\r\n{\r\nif (!store_method) return;\r\nOPENSSL_free(store_method->name);\r\nstore_method->name = NULL;\r\nOPENSSL_free(store_method);\r\n}\r\nint STORE_method_set_initialise_function(STORE_METHOD *sm, STORE_INITIALISE_FUNC_PTR init_f)\r\n{\r\nsm->init = init_f;\r\nreturn 1;\r\n}\r\nint STORE_method_set_cleanup_function(STORE_METHOD *sm, STORE_CLEANUP_FUNC_PTR clean_f)\r\n{\r\nsm->clean = clean_f;\r\nreturn 1;\r\n}\r\nint STORE_method_set_generate_function(STORE_METHOD *sm, STORE_GENERATE_OBJECT_FUNC_PTR generate_f)\r\n{\r\nsm->generate_object = generate_f;\r\nreturn 1;\r\n}\r\nint STORE_method_set_get_function(STORE_METHOD *sm, STORE_GET_OBJECT_FUNC_PTR get_f)\r\n{\r\nsm->get_object = get_f;\r\nreturn 1;\r\n}\r\nint STORE_method_set_store_function(STORE_METHOD *sm, STORE_STORE_OBJECT_FUNC_PTR store_f)\r\n{\r\nsm->store_object = store_f;\r\nreturn 1;\r\n}\r\nint STORE_method_set_modify_function(STORE_METHOD *sm, STORE_MODIFY_OBJECT_FUNC_PTR modify_f)\r\n{\r\nsm->modify_object = modify_f;\r\nreturn 1;\r\n}\r\nint STORE_method_set_revoke_function(STORE_METHOD *sm, STORE_HANDLE_OBJECT_FUNC_PTR revoke_f)\r\n{\r\nsm->revoke_object = revoke_f;\r\nreturn 1;\r\n}\r\nint STORE_method_set_delete_function(STORE_METHOD *sm, STORE_HANDLE_OBJECT_FUNC_PTR delete_f)\r\n{\r\nsm->delete_object = delete_f;\r\nreturn 1;\r\n}\r\nint STORE_method_set_list_start_function(STORE_METHOD *sm, STORE_START_OBJECT_FUNC_PTR list_start_f)\r\n{\r\nsm->list_object_start = list_start_f;\r\nreturn 1;\r\n}\r\nint STORE_method_set_list_next_function(STORE_METHOD *sm, STORE_NEXT_OBJECT_FUNC_PTR list_next_f)\r\n{\r\nsm->list_object_next = list_next_f;\r\nreturn 1;\r\n}\r\nint STORE_method_set_list_end_function(STORE_METHOD *sm, STORE_END_OBJECT_FUNC_PTR list_end_f)\r\n{\r\nsm->list_object_end = list_end_f;\r\nreturn 1;\r\n}\r\nint STORE_method_set_update_store_function(STORE_METHOD *sm, STORE_GENERIC_FUNC_PTR update_f)\r\n{\r\nsm->update_store = update_f;\r\nreturn 1;\r\n}\r\nint STORE_method_set_lock_store_function(STORE_METHOD *sm, STORE_GENERIC_FUNC_PTR lock_f)\r\n{\r\nsm->lock_store = lock_f;\r\nreturn 1;\r\n}\r\nint STORE_method_set_unlock_store_function(STORE_METHOD *sm, STORE_GENERIC_FUNC_PTR unlock_f)\r\n{\r\nsm->unlock_store = unlock_f;\r\nreturn 1;\r\n}\r\nint STORE_method_set_ctrl_function(STORE_METHOD *sm, STORE_CTRL_FUNC_PTR ctrl_f)\r\n{\r\nsm->ctrl = ctrl_f;\r\nreturn 1;\r\n}\r\nSTORE_INITIALISE_FUNC_PTR STORE_method_get_initialise_function(STORE_METHOD *sm)\r\n{\r\nreturn sm->init;\r\n}\r\nSTORE_CLEANUP_FUNC_PTR STORE_method_get_cleanup_function(STORE_METHOD *sm)\r\n{\r\nreturn sm->clean;\r\n}\r\nSTORE_GENERATE_OBJECT_FUNC_PTR STORE_method_get_generate_function(STORE_METHOD *sm)\r\n{\r\nreturn sm->generate_object;\r\n}\r\nSTORE_GET_OBJECT_FUNC_PTR STORE_method_get_get_function(STORE_METHOD *sm)\r\n{\r\nreturn sm->get_object;\r\n}\r\nSTORE_STORE_OBJECT_FUNC_PTR STORE_method_get_store_function(STORE_METHOD *sm)\r\n{\r\nreturn sm->store_object;\r\n}\r\nSTORE_MODIFY_OBJECT_FUNC_PTR STORE_method_get_modify_function(STORE_METHOD *sm)\r\n{\r\nreturn sm->modify_object;\r\n}\r\nSTORE_HANDLE_OBJECT_FUNC_PTR STORE_method_get_revoke_function(STORE_METHOD *sm)\r\n{\r\nreturn sm->revoke_object;\r\n}\r\nSTORE_HANDLE_OBJECT_FUNC_PTR STORE_method_get_delete_function(STORE_METHOD *sm)\r\n{\r\nreturn sm->delete_object;\r\n}\r\nSTORE_START_OBJECT_FUNC_PTR STORE_method_get_list_start_function(STORE_METHOD *sm)\r\n{\r\nreturn sm->list_object_start;\r\n}\r\nSTORE_NEXT_OBJECT_FUNC_PTR STORE_method_get_list_next_function(STORE_METHOD *sm)\r\n{\r\nreturn sm->list_object_next;\r\n}\r\nSTORE_END_OBJECT_FUNC_PTR STORE_method_get_list_end_function(STORE_METHOD *sm)\r\n{\r\nreturn sm->list_object_end;\r\n}\r\nSTORE_GENERIC_FUNC_PTR STORE_method_get_update_store_function(STORE_METHOD *sm)\r\n{\r\nreturn sm->update_store;\r\n}\r\nSTORE_GENERIC_FUNC_PTR STORE_method_get_lock_store_function(STORE_METHOD *sm)\r\n{\r\nreturn sm->lock_store;\r\n}\r\nSTORE_GENERIC_FUNC_PTR STORE_method_get_unlock_store_function(STORE_METHOD *sm)\r\n{\r\nreturn sm->unlock_store;\r\n}\r\nSTORE_CTRL_FUNC_PTR STORE_method_get_ctrl_function(STORE_METHOD *sm)\r\n{\r\nreturn sm->ctrl;\r\n}
