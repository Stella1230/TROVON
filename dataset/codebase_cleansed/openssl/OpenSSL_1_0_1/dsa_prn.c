int DSA_print_fp(FILE *fp, const DSA *x, int off)\r\n{\r\nBIO *b;\r\nint ret;\r\nif ((b=BIO_new(BIO_s_file())) == NULL)\r\n{\r\nDSAerr(DSA_F_DSA_PRINT_FP,ERR_R_BUF_LIB);\r\nreturn(0);\r\n}\r\nBIO_set_fp(b,fp,BIO_NOCLOSE);\r\nret=DSA_print(b,x,off);\r\nBIO_free(b);\r\nreturn(ret);\r\n}\r\nint DSAparams_print_fp(FILE *fp, const DSA *x)\r\n{\r\nBIO *b;\r\nint ret;\r\nif ((b=BIO_new(BIO_s_file())) == NULL)\r\n{\r\nDSAerr(DSA_F_DSAPARAMS_PRINT_FP,ERR_R_BUF_LIB);\r\nreturn(0);\r\n}\r\nBIO_set_fp(b,fp,BIO_NOCLOSE);\r\nret=DSAparams_print(b, x);\r\nBIO_free(b);\r\nreturn(ret);\r\n}\r\nint DSA_print(BIO *bp, const DSA *x, int off)\r\n{\r\nEVP_PKEY *pk;\r\nint ret;\r\npk = EVP_PKEY_new();\r\nif (!pk || !EVP_PKEY_set1_DSA(pk, (DSA *)x))\r\nreturn 0;\r\nret = EVP_PKEY_print_private(bp, pk, off, NULL);\r\nEVP_PKEY_free(pk);\r\nreturn ret;\r\n}\r\nint DSAparams_print(BIO *bp, const DSA *x)\r\n{\r\nEVP_PKEY *pk;\r\nint ret;\r\npk = EVP_PKEY_new();\r\nif (!pk || !EVP_PKEY_set1_DSA(pk, (DSA *)x))\r\nreturn 0;\r\nret = EVP_PKEY_print_params(bp, pk, 4, NULL);\r\nEVP_PKEY_free(pk);\r\nreturn ret;\r\n}
