BIGNUM *BN_generate_prime(BIGNUM *ret, int bits, int safe,\r\nconst BIGNUM *add, const BIGNUM *rem,\r\nvoid (*callback)(int,int,void *), void *cb_arg)\r\n{\r\nBN_GENCB cb;\r\nBIGNUM *rnd=NULL;\r\nint found = 0;\r\nBN_GENCB_set_old(&cb, callback, cb_arg);\r\nif (ret == NULL)\r\n{\r\nif ((rnd=BN_new()) == NULL) goto err;\r\n}\r\nelse\r\nrnd=ret;\r\nif(!BN_generate_prime_ex(rnd, bits, safe, add, rem, &cb))\r\ngoto err;\r\nfound = 1;\r\nerr:\r\nif (!found && (ret == NULL) && (rnd != NULL)) BN_free(rnd);\r\nreturn(found ? rnd : NULL);\r\n}\r\nint BN_is_prime(const BIGNUM *a, int checks, void (*callback)(int,int,void *),\r\nBN_CTX *ctx_passed, void *cb_arg)\r\n{\r\nBN_GENCB cb;\r\nBN_GENCB_set_old(&cb, callback, cb_arg);\r\nreturn BN_is_prime_ex(a, checks, ctx_passed, &cb);\r\n}\r\nint BN_is_prime_fasttest(const BIGNUM *a, int checks,\r\nvoid (*callback)(int,int,void *),\r\nBN_CTX *ctx_passed, void *cb_arg,\r\nint do_trial_division)\r\n{\r\nBN_GENCB cb;\r\nBN_GENCB_set_old(&cb, callback, cb_arg);\r\nreturn BN_is_prime_fasttest_ex(a, checks, ctx_passed,\r\ndo_trial_division, &cb);\r\n}
