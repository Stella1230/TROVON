int RSA_print_fp(FILE *fp, const RSA *x, int off)\r\n{\r\nBIO *b;\r\nint ret;\r\nif ((b=BIO_new(BIO_s_file())) == NULL)\r\n{\r\nRSAerr(RSA_F_RSA_PRINT_FP,ERR_R_BUF_LIB);\r\nreturn(0);\r\n}\r\nBIO_set_fp(b,fp,BIO_NOCLOSE);\r\nret=RSA_print(b,x,off);\r\nBIO_free(b);\r\nreturn(ret);\r\n}\r\nint RSA_print(BIO *bp, const RSA *x, int off)\r\n{\r\nEVP_PKEY *pk;\r\nint ret;\r\npk = EVP_PKEY_new();\r\nif (!pk || !EVP_PKEY_set1_RSA(pk, (RSA *)x))\r\nreturn 0;\r\nret = EVP_PKEY_print_private(bp, pk, off, NULL);\r\nEVP_PKEY_free(pk);\r\nreturn ret;\r\n}
