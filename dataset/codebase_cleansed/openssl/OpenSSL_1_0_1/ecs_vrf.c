int ECDSA_do_verify(const unsigned char *dgst, int dgst_len,\r\nconst ECDSA_SIG *sig, EC_KEY *eckey)\r\n{\r\nECDSA_DATA *ecdsa = ecdsa_check(eckey);\r\nif (ecdsa == NULL)\r\nreturn 0;\r\nreturn ecdsa->meth->ecdsa_do_verify(dgst, dgst_len, sig, eckey);\r\n}\r\nint ECDSA_verify(int type, const unsigned char *dgst, int dgst_len,\r\nconst unsigned char *sigbuf, int sig_len, EC_KEY *eckey)\r\n{\r\nECDSA_SIG *s;\r\nint ret=-1;\r\ns = ECDSA_SIG_new();\r\nif (s == NULL) return(ret);\r\nif (d2i_ECDSA_SIG(&s, &sigbuf, sig_len) == NULL) goto err;\r\nret=ECDSA_do_verify(dgst, dgst_len, s, eckey);\r\nerr:\r\nECDSA_SIG_free(s);\r\nreturn(ret);\r\n}
