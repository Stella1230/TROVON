void gost_param_free()\r\n{\r\nint i;\r\nfor (i=0;i<=GOST_PARAM_MAX;i++)\r\nif (gost_params[i]!=NULL)\r\n{\r\nOPENSSL_free(gost_params[i]);\r\ngost_params[i]=NULL;\r\n}\r\n}\r\nint gost_control_func(ENGINE *e,int cmd,long i, void *p, void (*f)(void))\r\n{\r\nint param = cmd-ENGINE_CMD_BASE;\r\nint ret=0;\r\nif (param <0 || param >GOST_PARAM_MAX) return -1;\r\nret=gost_set_default_param(param,p);\r\nreturn ret;\r\n}\r\nconst char *get_gost_engine_param(int param)\r\n{\r\nchar *tmp;\r\nif (param <0 || param >GOST_PARAM_MAX) return NULL;\r\nif (gost_params[param]!=NULL)\r\n{\r\nreturn gost_params[param];\r\n}\r\ntmp = getenv(gost_envnames[param]);\r\nif (tmp)\r\n{\r\nif (gost_params[param]) OPENSSL_free(gost_params[param]);\r\ngost_params[param] = BUF_strdup(tmp);\r\nreturn gost_params[param];\r\n}\r\nreturn NULL;\r\n}\r\nint gost_set_default_param(int param, const char *value)\r\n{\r\nconst char *tmp;\r\nif (param <0 || param >GOST_PARAM_MAX) return 0;\r\ntmp = getenv(gost_envnames[param]);\r\nif (!tmp) tmp=value;\r\nif (gost_params[param]) OPENSSL_free(gost_params[param]);\r\ngost_params[param] = BUF_strdup(tmp);\r\nreturn 1;\r\n}
