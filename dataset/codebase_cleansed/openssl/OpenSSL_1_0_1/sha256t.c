int main(int argc, char *argv[])\r\n{\r\nprintf("No SHA256 support\n");\r\nreturn(0);\r\n}\r\nint main (int argc,char **argv)\r\n{ unsigned char md[SHA256_DIGEST_LENGTH];\r\nint i;\r\nEVP_MD_CTX evp;\r\nfprintf(stdout,"Testing SHA-256 ");\r\nEVP_Digest ("abc",3,md,NULL,EVP_sha256(),NULL);\r\nif (memcmp(md,app_b1,sizeof(app_b1)))\r\n{ fflush(stdout);\r\nfprintf(stderr,"\nTEST 1 of 3 failed.\n");\r\nreturn 1;\r\n}\r\nelse\r\nfprintf(stdout,"."); fflush(stdout);\r\nEVP_Digest ("abcdbcde""cdefdefg""efghfghi""ghijhijk"\r\n"ijkljklm""klmnlmno""mnopnopq",56,md,NULL,EVP_sha256(),NULL);\r\nif (memcmp(md,app_b2,sizeof(app_b2)))\r\n{ fflush(stdout);\r\nfprintf(stderr,"\nTEST 2 of 3 failed.\n");\r\nreturn 1;\r\n}\r\nelse\r\nfprintf(stdout,"."); fflush(stdout);\r\nEVP_MD_CTX_init (&evp);\r\nEVP_DigestInit_ex (&evp,EVP_sha256(),NULL);\r\nfor (i=0;i<1000000;i+=160)\r\nEVP_DigestUpdate (&evp, "aaaaaaaa""aaaaaaaa""aaaaaaaa""aaaaaaaa"\r\n"aaaaaaaa""aaaaaaaa""aaaaaaaa""aaaaaaaa"\r\n"aaaaaaaa""aaaaaaaa""aaaaaaaa""aaaaaaaa"\r\n"aaaaaaaa""aaaaaaaa""aaaaaaaa""aaaaaaaa"\r\n"aaaaaaaa""aaaaaaaa""aaaaaaaa""aaaaaaaa",\r\n(1000000-i)<160?1000000-i:160);\r\nEVP_DigestFinal_ex (&evp,md,NULL);\r\nEVP_MD_CTX_cleanup (&evp);\r\nif (memcmp(md,app_b3,sizeof(app_b3)))\r\n{ fflush(stdout);\r\nfprintf(stderr,"\nTEST 3 of 3 failed.\n");\r\nreturn 1;\r\n}\r\nelse\r\nfprintf(stdout,"."); fflush(stdout);\r\nfprintf(stdout," passed.\n"); fflush(stdout);\r\nfprintf(stdout,"Testing SHA-224 ");\r\nEVP_Digest ("abc",3,md,NULL,EVP_sha224(),NULL);\r\nif (memcmp(md,addenum_1,sizeof(addenum_1)))\r\n{ fflush(stdout);\r\nfprintf(stderr,"\nTEST 1 of 3 failed.\n");\r\nreturn 1;\r\n}\r\nelse\r\nfprintf(stdout,"."); fflush(stdout);\r\nEVP_Digest ("abcdbcde""cdefdefg""efghfghi""ghijhijk"\r\n"ijkljklm""klmnlmno""mnopnopq",56,md,NULL,EVP_sha224(),NULL);\r\nif (memcmp(md,addenum_2,sizeof(addenum_2)))\r\n{ fflush(stdout);\r\nfprintf(stderr,"\nTEST 2 of 3 failed.\n");\r\nreturn 1;\r\n}\r\nelse\r\nfprintf(stdout,"."); fflush(stdout);\r\nEVP_MD_CTX_init (&evp);\r\nEVP_DigestInit_ex (&evp,EVP_sha224(),NULL);\r\nfor (i=0;i<1000000;i+=64)\r\nEVP_DigestUpdate (&evp, "aaaaaaaa""aaaaaaaa""aaaaaaaa""aaaaaaaa"\r\n"aaaaaaaa""aaaaaaaa""aaaaaaaa""aaaaaaaa",\r\n(1000000-i)<64?1000000-i:64);\r\nEVP_DigestFinal_ex (&evp,md,NULL);\r\nEVP_MD_CTX_cleanup (&evp);\r\nif (memcmp(md,addenum_3,sizeof(addenum_3)))\r\n{ fflush(stdout);\r\nfprintf(stderr,"\nTEST 3 of 3 failed.\n");\r\nreturn 1;\r\n}\r\nelse\r\nfprintf(stdout,"."); fflush(stdout);\r\nfprintf(stdout," passed.\n"
