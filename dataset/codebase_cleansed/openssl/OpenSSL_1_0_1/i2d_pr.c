int i2d_PrivateKey(EVP_PKEY *a, unsigned char **pp)\r\n{\r\nif (a->ameth && a->ameth->old_priv_encode)\r\n{\r\nreturn a->ameth->old_priv_encode(a, pp);\r\n}\r\nif (a->ameth && a->ameth->priv_encode) {\r\nPKCS8_PRIV_KEY_INFO *p8 = EVP_PKEY2PKCS8(a);\r\nint ret = i2d_PKCS8_PRIV_KEY_INFO(p8,pp);\r\nPKCS8_PRIV_KEY_INFO_free(p8);\r\nreturn ret;\r\n}\r\nASN1err(ASN1_F_I2D_PRIVATEKEY,ASN1_R_UNSUPPORTED_PUBLIC_KEY_TYPE);\r\nreturn(-1);\r\n}
