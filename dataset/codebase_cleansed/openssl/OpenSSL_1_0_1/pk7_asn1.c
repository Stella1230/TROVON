static int pk7_cb(int operation, ASN1_VALUE **pval, const ASN1_ITEM *it,\r\nvoid *exarg)\r\n{\r\nASN1_STREAM_ARG *sarg = exarg;\r\nPKCS7 **pp7 = (PKCS7 **)pval;\r\nswitch(operation)\r\n{\r\ncase ASN1_OP_STREAM_PRE:\r\nif (PKCS7_stream(&sarg->boundary, *pp7) <= 0)\r\nreturn 0;\r\ncase ASN1_OP_DETACHED_PRE:\r\nsarg->ndef_bio = PKCS7_dataInit(*pp7, sarg->out);\r\nif (!sarg->ndef_bio)\r\nreturn 0;\r\nbreak;\r\ncase ASN1_OP_STREAM_POST:\r\ncase ASN1_OP_DETACHED_POST:\r\nif (PKCS7_dataFinal(*pp7, sarg->ndef_bio) <= 0)\r\nreturn 0;\r\nbreak;\r\n}\r\nreturn 1;\r\n}
