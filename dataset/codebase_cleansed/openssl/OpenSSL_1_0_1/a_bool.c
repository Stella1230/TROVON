int i2d_ASN1_BOOLEAN(int a, unsigned char **pp)\r\n{\r\nint r;\r\nunsigned char *p;\r\nr=ASN1_object_size(0,1,V_ASN1_BOOLEAN);\r\nif (pp == NULL) return(r);\r\np= *pp;\r\nASN1_put_object(&p,0,1,V_ASN1_BOOLEAN,V_ASN1_UNIVERSAL);\r\n*(p++)= (unsigned char)a;\r\n*pp=p;\r\nreturn(r);\r\n}\r\nint d2i_ASN1_BOOLEAN(int *a, const unsigned char **pp, long length)\r\n{\r\nint ret= -1;\r\nconst unsigned char *p;\r\nlong len;\r\nint inf,tag,xclass;\r\nint i=0;\r\np= *pp;\r\ninf=ASN1_get_object(&p,&len,&tag,&xclass,length);\r\nif (inf & 0x80)\r\n{\r\ni=ASN1_R_BAD_OBJECT_HEADER;\r\ngoto err;\r\n}\r\nif (tag != V_ASN1_BOOLEAN)\r\n{\r\ni=ASN1_R_EXPECTING_A_BOOLEAN;\r\ngoto err;\r\n}\r\nif (len != 1)\r\n{\r\ni=ASN1_R_BOOLEAN_IS_WRONG_LENGTH;\r\ngoto err;\r\n}\r\nret= (int)*(p++);\r\nif (a != NULL) (*a)=ret;\r\n*pp=p;\r\nreturn(ret);\r\nerr:\r\nASN1err(ASN1_F_D2I_ASN1_BOOLEAN,i);\r\nreturn(ret);\r\n}
