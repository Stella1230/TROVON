int EVP_PKEY_encrypt_old(unsigned char *ek, const unsigned char *key, int key_len,\r\nEVP_PKEY *pubk)\r\n{\r\nint ret=0;\r\n#ifndef OPENSSL_NO_RSA\r\nif (pubk->type != EVP_PKEY_RSA)\r\n{\r\n#endif\r\nEVPerr(EVP_F_EVP_PKEY_ENCRYPT_OLD,EVP_R_PUBLIC_KEY_NOT_RSA);\r\n#ifndef OPENSSL_NO_RSA\r\ngoto err;\r\n}\r\nret=RSA_public_encrypt(key_len,key,ek,pubk->pkey.rsa,RSA_PKCS1_PADDING);\r\nerr:\r\n#endif\r\nreturn(ret);\r\n}
