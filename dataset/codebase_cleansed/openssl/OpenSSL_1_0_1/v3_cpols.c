static void print_notice(BIO *out, USERNOTICE *notice, int indent)\r\n{\r\nint i;\r\nif(notice->noticeref) {\r\nNOTICEREF *ref;\r\nref = notice->noticeref;\r\nBIO_printf(out, "%*sOrganization: %s\n", indent, "",\r\nref->organization->data);\r\nBIO_printf(out, "%*sNumber%s: ", indent, "",\r\nsk_ASN1_INTEGER_num(ref->noticenos) > 1 ? "s" : "");\r\nfor(i = 0; i < sk_ASN1_INTEGER_num(ref->noticenos); i++) {\r\nASN1_INTEGER *num;\r\nchar *tmp;\r\nnum = sk_ASN1_INTEGER_value(ref->noticenos, i);\r\nif(i) BIO_puts(out, ", ");\r\ntmp = i2s_ASN1_INTEGER(NULL, num);\r\nBIO_puts(out, tmp);\r\nOPENSSL_free(tmp);\r\n}\r\nBIO_puts(out, "\n");\r\n}\r\nif(notice->exptext)\r\nBIO_printf(out, "%*sExplicit Text: %s\n", indent, "",\r\nnotice->exptext->data);\r\n}\r\nvoid X509_POLICY_NODE_print(BIO *out, X509_POLICY_NODE *node, int indent)\r\n{\r\nconst X509_POLICY_DATA *dat = node->data;\r\nBIO_printf(out, "%*sPolicy: ", indent, "");\r\ni2a_ASN1_OBJECT(out, dat->valid_policy);\r\nBIO_puts(out, "\n");\r\nBIO_printf(out, "%*s%s\n", indent + 2, "",\r\nnode_data_critical(dat) ? "Critical" : "Non Critical");\r\nif (dat->qualifier_set)\r\nprint_qualifiers(out, dat->qualifier_set, indent + 2);\r\nelse\r\nBIO_printf(out, "%*sNo Qualifiers\n", indent + 2, "");\r\n}
