int X509_keyid_set1(X509 *x, unsigned char *id, int len)\r\n{\r\nX509_CERT_AUX *aux;\r\nif (!id)\r\n{\r\nif (!x || !x->aux || !x->aux->keyid)\r\nreturn 1;\r\nASN1_OCTET_STRING_free(x->aux->keyid);\r\nx->aux->keyid = NULL;\r\nreturn 1;\r\n}\r\nif(!(aux = aux_get(x))) return 0;\r\nif(!aux->keyid && !(aux->keyid = ASN1_OCTET_STRING_new())) return 0;\r\nreturn ASN1_STRING_set(aux->keyid, id, len);\r\n}\r\nunsigned char *X509_alias_get0(X509 *x, int *len)\r\n{\r\nif(!x->aux || !x->aux->alias) return NULL;\r\nif(len) *len = x->aux->alias->length;\r\nreturn x->aux->alias->data;\r\n}\r\nunsigned char *X509_keyid_get0(X509 *x, int *len)\r\n{\r\nif(!x->aux || !x->aux->keyid) return NULL;\r\nif(len) *len = x->aux->keyid->length;\r\nreturn x->aux->keyid->data;\r\n}\r\nint X509_add1_trust_object(X509 *x, ASN1_OBJECT *obj)\r\n{\r\nX509_CERT_AUX *aux;\r\nASN1_OBJECT *objtmp;\r\nif(!(objtmp = OBJ_dup(obj))) return 0;\r\nif(!(aux = aux_get(x))) return 0;\r\nif(!aux->trust\r\n&& !(aux->trust = sk_ASN1_OBJECT_new_null())) return 0;\r\nreturn sk_ASN1_OBJECT_push(aux->trust, objtmp);\r\n}\r\nint X509_add1_reject_object(X509 *x, ASN1_OBJECT *obj)\r\n{\r\nX509_CERT_AUX *aux;\r\nASN1_OBJECT *objtmp;\r\nif(!(objtmp = OBJ_dup(obj))) return 0;\r\nif(!(aux = aux_get(x))) return 0;\r\nif(!aux->reject\r\n&& !(aux->reject = sk_ASN1_OBJECT_new_null())) return 0;\r\nreturn sk_ASN1_OBJECT_push(aux->reject, objtmp);\r\n}\r\nvoid X509_trust_clear(X509 *x)\r\n{\r\nif(x->aux && x->aux->trust) {\r\nsk_ASN1_OBJECT_pop_free(x->aux->trust, ASN1_OBJECT_free);\r\nx->aux->trust = NULL;\r\n}\r\n}\r\nvoid X509_reject_clear(X509 *x)\r\n{\r\nif(x->aux && x->aux->reject) {\r\nsk_ASN1_OBJECT_pop_free(x->aux->reject, ASN1_OBJECT_free);\r\nx->aux->reject = NULL;\r\n}\r\n}
