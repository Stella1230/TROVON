int i2d_PKCS7_bio_stream(BIO *out, PKCS7 *p7, BIO *in, int flags)\r\n{\r\nreturn i2d_ASN1_bio_stream(out, (ASN1_VALUE *)p7, in, flags,\r\nASN1_ITEM_rptr(PKCS7));\r\n}\r\nint PEM_write_bio_PKCS7_stream(BIO *out, PKCS7 *p7, BIO *in, int flags)\r\n{\r\nreturn PEM_write_bio_ASN1_stream(out, (ASN1_VALUE *) p7, in, flags,\r\n"PKCS7",\r\nASN1_ITEM_rptr(PKCS7));\r\n}\r\nint SMIME_write_PKCS7(BIO *bio, PKCS7 *p7, BIO *data, int flags)\r\n{\r\nSTACK_OF(X509_ALGOR) *mdalgs;\r\nint ctype_nid = OBJ_obj2nid(p7->type);\r\nif (ctype_nid == NID_pkcs7_signed)\r\nmdalgs = p7->d.sign->md_algs;\r\nelse\r\nmdalgs = NULL;\r\nflags ^= SMIME_OLDMIME;\r\nreturn SMIME_write_ASN1(bio, (ASN1_VALUE *)p7, data, flags,\r\nctype_nid, NID_undef, mdalgs,\r\nASN1_ITEM_rptr(PKCS7));\r\n}\r\nPKCS7 *SMIME_read_PKCS7(BIO *bio, BIO **bcont)\r\n{\r\nreturn (PKCS7 *)SMIME_read_ASN1(bio, bcont, ASN1_ITEM_rptr(PKCS7));\r\n}
