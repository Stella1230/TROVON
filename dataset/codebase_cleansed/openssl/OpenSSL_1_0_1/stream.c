main()\r\n{\r\nfprintf(stderr,"rc4\n");\r\nrc4();\r\nfprintf(stderr,"cfb des\n");\r\ndes();\r\n}\r\nint des()\r\n{\r\ndes_key_schedule ks;\r\ndes_cblock iv,key;\r\nint num;\r\nstatic char *keystr="01234567";\r\nstatic char *in1="0123456789ABCEDFdata 12345";\r\nstatic char *in2="9876543210abcdefdata 12345";\r\nunsigned char out[100];\r\nint i;\r\ndes_set_key((des_cblock *)keystr,ks);\r\nnum=0;\r\nmemset(iv,0,8);\r\ndes_cfb64_encrypt(in1,out,26,ks,(des_cblock *)iv,&num,1);\r\nfor (i=0; i<26; i++)\r\nfprintf(stderr,"%02X ",out[i]);\r\nfprintf(stderr,"\n");\r\nnum=0;\r\nmemset(iv,0,8);\r\ndes_cfb64_encrypt(in2,out,26,ks,(des_cblock *)iv,&num,1);\r\nfor (i=0; i<26; i++)\r\nfprintf(stderr,"%02X ",out[i]);\r\nfprintf(stderr,"\n");\r\n}\r\nint rc4()\r\n{\r\nstatic char *keystr="0123456789abcdef";\r\nRC4_KEY key;\r\nunsigned char in[100],out[100];\r\nint i;\r\nRC4_set_key(&key,16,keystr);\r\nin[0]='\0';\r\nstrcpy(in,"0123456789ABCEDFdata 12345");\r\nRC4(key,26,in,out);\r\nfor (i=0; i<26; i++)\r\nfprintf(stderr,"%02X ",out[i]);\r\nfprintf(stderr,"\n");\r\nRC4_set_key(&key,16,keystr);\r\nin[0]='\0';\r\nstrcpy(in,"9876543210abcdefdata 12345");\r\nRC4(key,26,in,out);\r\nfor (i=0; i<26; i++)\r\nfprintf(stderr,"%02X ",out[i]);\r\nfprintf(stderr,"\n");\r\n}
