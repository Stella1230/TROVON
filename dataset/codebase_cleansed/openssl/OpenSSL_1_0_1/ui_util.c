int UI_UTIL_read_pw_string(char *buf,int length,const char *prompt,int verify)\r\n{\r\nchar buff[BUFSIZ];\r\nint ret;\r\nret=UI_UTIL_read_pw(buf,buff,(length>BUFSIZ)?BUFSIZ:length,prompt,verify);\r\nOPENSSL_cleanse(buff,BUFSIZ);\r\nreturn(ret);\r\n}\r\nint UI_UTIL_read_pw(char *buf,char *buff,int size,const char *prompt,int verify)\r\n{\r\nint ok = 0;\r\nUI *ui;\r\nif (size < 1)\r\nreturn -1;\r\nui = UI_new();\r\nif (ui)\r\n{\r\nok = UI_add_input_string(ui,prompt,0,buf,0,size-1);\r\nif (ok >= 0 && verify)\r\nok = UI_add_verify_string(ui,prompt,0,buff,0,size-1,\r\nbuf);\r\nif (ok >= 0)\r\nok=UI_process(ui);\r\nUI_free(ui);\r\n}\r\nif (ok > 0)\r\nok = 0;\r\nreturn(ok);\r\n}
