int NETSCAPE_SPKI_print(BIO *out, NETSCAPE_SPKI *spki)\r\n{\r\nEVP_PKEY *pkey;\r\nASN1_IA5STRING *chal;\r\nint i, n;\r\nchar *s;\r\nBIO_printf(out, "Netscape SPKI:\n");\r\ni=OBJ_obj2nid(spki->spkac->pubkey->algor->algorithm);\r\nBIO_printf(out," Public Key Algorithm: %s\n",\r\n(i == NID_undef)?"UNKNOWN":OBJ_nid2ln(i));\r\npkey = X509_PUBKEY_get(spki->spkac->pubkey);\r\nif(!pkey) BIO_printf(out, " Unable to load public key\n");\r\nelse\r\n{\r\nEVP_PKEY_print_public(out, pkey, 4, NULL);\r\nEVP_PKEY_free(pkey);\r\n}\r\nchal = spki->spkac->challenge;\r\nif(chal->length)\r\nBIO_printf(out, " Challenge String: %s\n", chal->data);\r\ni=OBJ_obj2nid(spki->sig_algor->algorithm);\r\nBIO_printf(out," Signature Algorithm: %s",\r\n(i == NID_undef)?"UNKNOWN":OBJ_nid2ln(i));\r\nn=spki->signature->length;\r\ns=(char *)spki->signature->data;\r\nfor (i=0; i<n; i++)\r\n{\r\nif ((i%18) == 0) BIO_write(out,"\n ",7);\r\nBIO_printf(out,"%02x%s",(unsigned char)s[i],\r\n((i+1) == n)?"":":");\r\n}\r\nBIO_write(out,"\n",1);\r\nreturn 1;\r\n}
