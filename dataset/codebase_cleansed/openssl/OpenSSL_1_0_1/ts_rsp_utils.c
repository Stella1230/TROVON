int TS_RESP_set_status_info(TS_RESP *a, TS_STATUS_INFO *status_info)\r\n{\r\nTS_STATUS_INFO *new_status_info;\r\nif (a->status_info == status_info)\r\nreturn 1;\r\nnew_status_info = TS_STATUS_INFO_dup(status_info);\r\nif (new_status_info == NULL)\r\n{\r\nTSerr(TS_F_TS_RESP_SET_STATUS_INFO, ERR_R_MALLOC_FAILURE);\r\nreturn 0;\r\n}\r\nTS_STATUS_INFO_free(a->status_info);\r\na->status_info = new_status_info;\r\nreturn 1;\r\n}\r\nTS_STATUS_INFO *TS_RESP_get_status_info(TS_RESP *a)\r\n{\r\nreturn a->status_info;\r\n}\r\nvoid TS_RESP_set_tst_info(TS_RESP *a, PKCS7 *p7, TS_TST_INFO *tst_info)\r\n{\r\nPKCS7_free(a->token);\r\na->token = p7;\r\nTS_TST_INFO_free(a->tst_info);\r\na->tst_info = tst_info;\r\n}\r\nPKCS7 *TS_RESP_get_token(TS_RESP *a)\r\n{\r\nreturn a->token;\r\n}\r\nTS_TST_INFO *TS_RESP_get_tst_info(TS_RESP *a)\r\n{\r\nreturn a->tst_info;\r\n}\r\nint TS_TST_INFO_set_version(TS_TST_INFO *a, long version)\r\n{\r\nreturn ASN1_INTEGER_set(a->version, version);\r\n}\r\nlong TS_TST_INFO_get_version(const TS_TST_INFO *a)\r\n{\r\nreturn ASN1_INTEGER_get(a->version);\r\n}\r\nint TS_TST_INFO_set_policy_id(TS_TST_INFO *a, ASN1_OBJECT *policy)\r\n{\r\nASN1_OBJECT *new_policy;\r\nif (a->policy_id == policy)\r\nreturn 1;\r\nnew_policy = OBJ_dup(policy);\r\nif (new_policy == NULL)\r\n{\r\nTSerr(TS_F_TS_TST_INFO_SET_POLICY_ID, ERR_R_MALLOC_FAILURE);\r\nreturn 0;\r\n}\r\nASN1_OBJECT_free(a->policy_id);\r\na->policy_id = new_policy;\r\nreturn 1;\r\n}\r\nASN1_OBJECT *TS_TST_INFO_get_policy_id(TS_TST_INFO *a)\r\n{\r\nreturn a->policy_id;\r\n}\r\nint TS_TST_INFO_set_msg_imprint(TS_TST_INFO *a, TS_MSG_IMPRINT *msg_imprint)\r\n{\r\nTS_MSG_IMPRINT *new_msg_imprint;\r\nif (a->msg_imprint == msg_imprint)\r\nreturn 1;\r\nnew_msg_imprint = TS_MSG_IMPRINT_dup(msg_imprint);\r\nif (new_msg_imprint == NULL)\r\n{\r\nTSerr(TS_F_TS_TST_INFO_SET_MSG_IMPRINT, ERR_R_MALLOC_FAILURE);\r\nreturn 0;\r\n}\r\nTS_MSG_IMPRINT_free(a->msg_imprint);\r\na->msg_imprint = new_msg_imprint;\r\nreturn 1;\r\n}\r\nTS_MSG_IMPRINT *TS_TST_INFO_get_msg_imprint(TS_TST_INFO *a)\r\n{\r\nreturn a->msg_imprint;\r\n}\r\nint TS_TST_INFO_set_serial(TS_TST_INFO *a, const ASN1_INTEGER *serial)\r\n{\r\nASN1_INTEGER *new_serial;\r\nif (a->serial == serial)\r\nreturn 1;\r\nnew_serial = ASN1_INTEGER_dup(serial);\r\nif (new_serial == NULL)\r\n{\r\nTSerr(TS_F_TS_TST_INFO_SET_SERIAL, ERR_R_MALLOC_FAILURE);\r\nreturn 0;\r\n}\r\nASN1_INTEGER_free(a->serial);\r\na->serial = new_serial;\r\nreturn 1;\r\n}\r\nconst ASN1_INTEGER *TS_TST_INFO_get_serial(const TS_TST_INFO *a)\r\n{\r\nreturn a->serial;\r\n}\r\nint TS_TST_INFO_set_time(TS_TST_INFO *a, const ASN1_GENERALIZEDTIME *gtime)\r\n{\r\nASN1_GENERALIZEDTIME *new_time;\r\nif (a->time == gtime)\r\nreturn 1;\r\nnew_time = M_ASN1_GENERALIZEDTIME_dup(gtime);\r\nif (new_time == NULL)\r\n{\r\nTSerr(TS_F_TS_TST_INFO_SET_TIME, ERR_R_MALLOC_FAILURE);\r\nreturn 0;\r\n}\r\nASN1_GENERALIZEDTIME_free(a->time);\r\na->time = new_time;\r\nreturn 1;\r\n}\r\nconst ASN1_GENERALIZEDTIME *TS_TST_INFO_get_time(const TS_TST_INFO *a)\r\n{\r\nreturn a->time;\r\n}\r\nint TS_TST_INFO_set_accuracy(TS_TST_INFO *a, TS_ACCURACY *accuracy)\r\n{\r\nTS_ACCURACY *new_accuracy;\r\nif (a->accuracy == accuracy)\r\nreturn 1;\r\nnew_accuracy = TS_ACCURACY_dup(accuracy);\r\nif (new_accuracy == NULL)\r\n{\r\nTSerr(TS_F_TS_TST_INFO_SET_ACCURACY, ERR_R_MALLOC_FAILURE);\r\nreturn 0;\r\n}\r\nTS_ACCURACY_free(a->accuracy);\r\na->accuracy = new_accuracy;\r\nreturn 1;\r\n}\r\nTS_ACCURACY *TS_TST_INFO_get_accuracy(TS_TST_INFO *a)\r\n{\r\nreturn a->accuracy;\r\n}\r\nint TS_ACCURACY_set_seconds(TS_ACCURACY *a, const ASN1_INTEGER *seconds)\r\n{\r\nASN1_INTEGER *new_seconds;\r\nif (a->seconds == seconds)\r\nreturn 1;\r\nnew_seconds = ASN1_INTEGER_dup(seconds);\r\nif (new_seconds == NULL)\r\n{\r\nTSerr(TS_F_TS_ACCURACY_SET_SECONDS, ERR_R_MALLOC_FAILURE);\r\nreturn 0;\r\n}\r\nASN1_INTEGER_free(a->seconds);\r\na->seconds = new_seconds;\r\nreturn 1;\r\n}\r\nconst ASN1_INTEGER *TS_ACCURACY_get_seconds(const TS_ACCURACY *a)\r\n{\r\nreturn a->seconds;\r\n}\r\nint TS_ACCURACY_set_millis(TS_ACCURACY *a, const ASN1_INTEGER *millis)\r\n{\r\nASN1_INTEGER *new_millis = NULL;\r\nif (a->millis == millis)\r\nreturn 1;\r\nif (millis != NULL)\r\n{\r\nnew_millis = ASN1_INTEGER_dup(millis);\r\nif (new_millis == NULL)\r\n{\r\nTSerr(TS_F_TS_ACCURACY_SET_MILLIS,\r\nERR_R_MALLOC_FAILURE);\r\nreturn 0;\r\n}\r\n}\r\nASN1_INTEGER_free(a->millis);\r\na->millis = new_millis;\r\nreturn 1;\r\n}\r\nconst ASN1_INTEGER *TS_ACCURACY_get_millis(const TS_ACCURACY *a)\r\n{\r\nreturn a->millis;\r\n}\r\nint TS_ACCURACY_set_micros(TS_ACCURACY *a, const ASN1_INTEGER *micros)\r\n{\r\nASN1_INTEGER *new_micros = NULL;\r\nif (a->micros == micros)\r\nreturn 1;\r\nif (micros != NULL)\r\n{\r\nnew_micros = ASN1_INTEGER_dup(micros);\r\nif (new_micros == NULL)\r\n{\r\nTSerr(TS_F_TS_ACCURACY_SET_MICROS,\r\nERR_R_MALLOC_FAILURE);\r\nreturn 0;\r\n}\r\n}\r\nASN1_INTEGER_free(a->micros);\r\na->micros = new_micros;\r\nreturn 1;\r\n}\r\nconst ASN1_INTEGER *TS_ACCURACY_get_micros(const TS_ACCURACY *a)\r\n{\r\nreturn a->micros;\r\n}\r\nint TS_TST_INFO_set_ordering(TS_TST_INFO *a, int ordering)\r\n{\r\na->ordering = ordering ? 0xFF : 0x00;\r\nreturn 1;\r\n}\r\nint TS_TST_INFO_get_ordering(const TS_TST_INFO *a)\r\n{\r\nreturn a->ordering ? 1 : 0;\r\n}\r\nint TS_TST_INFO_set_nonce(TS_TST_INFO *a, const ASN1_INTEGER *nonce)\r\n{\r\nASN1_INTEGER *new_nonce;\r\nif (a->nonce == nonce)\r\nreturn 1;\r\nnew_nonce = ASN1_INTEGER_dup(nonce);\r\nif (new_nonce == NULL)\r\n{\r\nTSerr(TS_F_TS_TST_INFO_SET_NONCE, ERR_R_MALLOC_FAILURE);\r\nreturn 0;\r\n}\r\nASN1_INTEGER_free(a->nonce);\r\na->nonce = new_nonce;\r\nreturn 1;\r\n}\r\nconst ASN1_INTEGER *TS_TST_INFO_get_nonce(const TS_TST_INFO *a)\r\n{\r\nreturn a->nonce;\r\n}\r\nint TS_TST_INFO_set_tsa(TS_TST_INFO *a, GENERAL_NAME *tsa)\r\n{\r\nGENERAL_NAME *new_tsa;\r\nif (a->tsa == tsa)\r\nreturn 1;\r\nnew_tsa = GENERAL_NAME_dup(tsa);\r\nif (new_tsa == NULL)\r\n{\r\nTSerr(TS_F_TS_TST_INFO_SET_TSA, ERR_R_MALLOC_FAILURE);\r\nreturn 0;\r\n}\r\nGENERAL_NAME_free(a->tsa);\r\na->tsa = new_tsa;\r\nreturn 1;\r\n}\r\nGENERAL_NAME *TS_TST_INFO_get_tsa(TS_TST_INFO *a)\r\n{\r\nreturn a->tsa;\r\n}\r\nvoid TS_TST_INFO_ext_free(TS_TST_INFO *a)\r\n{\r\nif (!a) return;\r\nsk_X509_EXTENSION_pop_free(a->extensions, X509_EXTENSION_free);\r\na->extensions = NULL;\r\n}\r\nint TS_TST_INFO_get_ext_count(TS_TST_INFO *a)\r\n{\r\nreturn X509v3_get_ext_count(a->extensions);\r\n}\r\nint TS_TST_INFO_get_ext_by_NID(TS_TST_INFO *a, int nid, int lastpos)\r\n{\r\nreturn X509v3_get_ext_by_NID(a->extensions, nid, lastpos);\r\n}\r\nint TS_TST_INFO_get_ext_by_OBJ(TS_TST_INFO *a, ASN1_OBJECT *obj, int lastpos)\r\n{\r\nreturn X509v3_get_ext_by_OBJ(a->extensions, obj, lastpos);\r\n}\r\nint TS_TST_INFO_get_ext_by_critical(TS_TST_INFO *a, int crit, int lastpos)\r\n{\r\nreturn X509v3_get_ext_by_critical(a->extensions, crit, lastpos);\r\n}\r\nX509_EXTENSION *TS_TST_INFO_get_ext(TS_TST_INFO *a, int loc)\r\n{\r\nreturn X509v3_get_ext(a->extensions,loc);\r\n}\r\nX509_EXTENSION *TS_TST_INFO_delete_ext(TS_TST_INFO *a, int loc)\r\n{\r\nreturn X509v3_delete_ext(a->extensions,loc);\r\n}\r\nint TS_TST_INFO_add_ext(TS_TST_INFO *a, X509_EXTENSION *ex, int loc)\r\n{\r\nreturn X509v3_add_ext(&a->extensions,ex,loc) != NULL;\r\n}\r\nvoid *TS_TST_INFO_get_ext_d2i(TS_TST_INFO *a, int nid, int *crit, int *idx)\r\n{\r\nreturn X509V3_get_d2i(a->extensions, nid, crit, idx);\r\n}
