EVP_CIPHER *EVP_rc5_32_12_16_ecb(void)\r\n{\r\nreturn(&rc5_ecb_cipher);\r\n}\r\nstatic void rc5_32_12_16_ecb_init_key(EVP_CIPHER_CTX *ctx, unsigned char *key,\r\nunsigned char *iv, int enc)\r\n{\r\nif (key != NULL)\r\nRC5_32_set_key(&(ctx->c.rc5_ks),EVP_RC5_32_12_16_KEY_SIZE,key,\r\nRC5_12_ROUNDS);\r\n}\r\nstatic void rc5_32_12_16_ecb_cipher(EVP_CIPHER_CTX *ctx, unsigned char *out,\r\nunsigned char *in, unsigned int inl)\r\n{\r\nunsigned int i;\r\nif (inl < 8) return;\r\ninl-=8;\r\nfor (i=0; i<=inl; i+=8)\r\n{\r\nRC5_32_ecb_encrypt(\r\n&(in[i]),&(out[i]),\r\n&(ctx->c.rc5_ks),ctx->encrypt);\r\n}\r\n}
