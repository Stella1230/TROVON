int i2d_PKCS12_MAC_DATA(PKCS12_MAC_DATA *a, unsigned char **pp)\r\n{\r\nM_ASN1_I2D_vars(a);\r\nM_ASN1_I2D_len (a->dinfo, i2d_X509_SIG);\r\nM_ASN1_I2D_len (a->salt, i2d_ASN1_OCTET_STRING);\r\nM_ASN1_I2D_len (a->iter, i2d_ASN1_INTEGER);\r\nM_ASN1_I2D_seq_total();\r\nM_ASN1_I2D_put (a->dinfo, i2d_X509_SIG);\r\nM_ASN1_I2D_put (a->salt, i2d_ASN1_OCTET_STRING);\r\nM_ASN1_I2D_put (a->iter, i2d_ASN1_INTEGER);\r\nM_ASN1_I2D_finish();\r\n}\r\nPKCS12_MAC_DATA *PKCS12_MAC_DATA_new(void)\r\n{\r\nPKCS12_MAC_DATA *ret=NULL;\r\nASN1_CTX c;\r\nM_ASN1_New_Malloc(ret, PKCS12_MAC_DATA);\r\nret->dinfo = X509_SIG_new();\r\nret->salt = ASN1_OCTET_STRING_new();\r\nret->iter = NULL;\r\nreturn (ret);\r\nM_ASN1_New_Error(ASN1_F_PKCS12_MAC_DATA_NEW);\r\n}\r\nPKCS12_MAC_DATA *d2i_PKCS12_MAC_DATA(PKCS12_MAC_DATA **a, unsigned char **pp,\r\nlong length)\r\n{\r\nM_ASN1_D2I_vars(a,PKCS12_MAC_DATA *,PKCS12_MAC_DATA_new);\r\nM_ASN1_D2I_Init();\r\nM_ASN1_D2I_start_sequence();\r\nM_ASN1_D2I_get (ret->dinfo, d2i_X509_SIG);\r\nM_ASN1_D2I_get (ret->salt, d2i_ASN1_OCTET_STRING);\r\nM_ASN1_D2I_get_opt (ret->iter, d2i_ASN1_INTEGER, V_ASN1_INTEGER);\r\nM_ASN1_D2I_Finish(a, PKCS12_MAC_DATA_free, ASN1_F_D2I_PKCS12_MAC_DATA);\r\n}\r\nvoid PKCS12_MAC_DATA_free (PKCS12_MAC_DATA *a)\r\n{\r\nif (a == NULL) return;\r\nX509_SIG_free (a->dinfo);\r\nASN1_OCTET_STRING_free (a->salt);\r\nASN1_INTEGER_free (a->iter);\r\nFree ((char *)a);\r\n}
