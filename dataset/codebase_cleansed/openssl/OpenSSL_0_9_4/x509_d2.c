int X509_STORE_set_default_paths(X509_STORE *ctx)\r\n{\r\nX509_LOOKUP *lookup;\r\nlookup=X509_STORE_add_lookup(ctx,X509_LOOKUP_file());\r\nif (lookup == NULL) return(0);\r\nX509_LOOKUP_load_file(lookup,NULL,X509_FILETYPE_DEFAULT);\r\nlookup=X509_STORE_add_lookup(ctx,X509_LOOKUP_hash_dir());\r\nif (lookup == NULL) return(0);\r\nX509_LOOKUP_add_dir(lookup,NULL,X509_FILETYPE_DEFAULT);\r\nERR_clear_error();\r\nreturn(1);\r\n}\r\nint X509_STORE_load_locations(X509_STORE *ctx, const char *file,\r\nconst char *path)\r\n{\r\nX509_LOOKUP *lookup;\r\nif (file != NULL)\r\n{\r\nlookup=X509_STORE_add_lookup(ctx,X509_LOOKUP_file());\r\nif (lookup == NULL) return(0);\r\nX509_LOOKUP_load_file(lookup,file,X509_FILETYPE_PEM);\r\n}\r\nif (path != NULL)\r\n{\r\nlookup=X509_STORE_add_lookup(ctx,X509_LOOKUP_hash_dir());\r\nif (lookup == NULL) return(0);\r\nX509_LOOKUP_add_dir(lookup,path,X509_FILETYPE_PEM);\r\n}\r\nif ((path == NULL) && (file == NULL))\r\nreturn(0);\r\nreturn(1);\r\n}
