int i2d_PKCS7_ISSUER_AND_SERIAL(PKCS7_ISSUER_AND_SERIAL *a,\r\nunsigned char **pp)\r\n{\r\nM_ASN1_I2D_vars(a);\r\nM_ASN1_I2D_len(a->issuer,i2d_X509_NAME);\r\nM_ASN1_I2D_len(a->serial,i2d_ASN1_INTEGER);\r\nM_ASN1_I2D_seq_total();\r\nM_ASN1_I2D_put(a->issuer,i2d_X509_NAME);\r\nM_ASN1_I2D_put(a->serial,i2d_ASN1_INTEGER);\r\nM_ASN1_I2D_finish();\r\n}\r\nPKCS7_ISSUER_AND_SERIAL *d2i_PKCS7_ISSUER_AND_SERIAL(PKCS7_ISSUER_AND_SERIAL **a, unsigned char **pp, long length)\r\n{\r\nM_ASN1_D2I_vars(a,PKCS7_ISSUER_AND_SERIAL *,PKCS7_ISSUER_AND_SERIAL_new);\r\nM_ASN1_D2I_Init();\r\nM_ASN1_D2I_start_sequence();\r\nM_ASN1_D2I_get(ret->issuer,d2i_X509_NAME);\r\nM_ASN1_D2I_get(ret->serial,d2i_ASN1_INTEGER);\r\nM_ASN1_D2I_Finish(a,PKCS7_ISSUER_AND_SERIAL_free,\r\nASN1_F_D2I_PKCS7_ISSUER_AND_SERIAL);\r\n}\r\nPKCS7_ISSUER_AND_SERIAL *PKCS7_ISSUER_AND_SERIAL_new(void)\r\n{\r\nPKCS7_ISSUER_AND_SERIAL *ret=NULL;\r\nASN1_CTX c;\r\nM_ASN1_New_Malloc(ret,PKCS7_ISSUER_AND_SERIAL);\r\nM_ASN1_New(ret->issuer,X509_NAME_new);\r\nM_ASN1_New(ret->serial,ASN1_INTEGER_new);\r\nreturn(ret);\r\nM_ASN1_New_Error(ASN1_F_PKCS7_ISSUER_AND_SERIAL_NEW);\r\n}\r\nvoid PKCS7_ISSUER_AND_SERIAL_free(PKCS7_ISSUER_AND_SERIAL *a)\r\n{\r\nif (a == NULL) return;\r\nX509_NAME_free(a->issuer);\r\nASN1_INTEGER_free(a->serial);\r\nFree((char *)a);\r\n}
