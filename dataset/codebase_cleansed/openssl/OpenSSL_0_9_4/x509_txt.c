const char *X509_verify_cert_error_string(long n)\r\n{\r\nstatic char buf[100];\r\nswitch ((int)n)\r\n{\r\ncase X509_V_OK:\r\nreturn("ok");\r\ncase X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT:\r\nreturn("unable to get issuer certificate");\r\ncase X509_V_ERR_UNABLE_TO_GET_CRL:\r\nreturn("unable to get certificate CRL");\r\ncase X509_V_ERR_UNABLE_TO_DECRYPT_CERT_SIGNATURE:\r\nreturn("unable to decrypt certificate's signature");\r\ncase X509_V_ERR_UNABLE_TO_DECRYPT_CRL_SIGNATURE:\r\nreturn("unable to decrypt CRL's's signature");\r\ncase X509_V_ERR_UNABLE_TO_DECODE_ISSUER_PUBLIC_KEY:\r\nreturn("unable to decode issuer public key");\r\ncase X509_V_ERR_CERT_SIGNATURE_FAILURE:\r\nreturn("certificate signature failure");\r\ncase X509_V_ERR_CRL_SIGNATURE_FAILURE:\r\nreturn("CRL signature failure");\r\ncase X509_V_ERR_CERT_NOT_YET_VALID:\r\nreturn("certificate is not yet valid");\r\ncase X509_V_ERR_CRL_NOT_YET_VALID:\r\nreturn("CRL is not yet valid");\r\ncase X509_V_ERR_CERT_HAS_EXPIRED:\r\nreturn("Certificate has expired");\r\ncase X509_V_ERR_CRL_HAS_EXPIRED:\r\nreturn("CRL has expired");\r\ncase X509_V_ERR_ERROR_IN_CERT_NOT_BEFORE_FIELD:\r\nreturn("format error in certificate's notBefore field");\r\ncase X509_V_ERR_ERROR_IN_CERT_NOT_AFTER_FIELD:\r\nreturn("format error in certificate's notAfter field");\r\ncase X509_V_ERR_ERROR_IN_CRL_LAST_UPDATE_FIELD:\r\nreturn("format error in CRL's lastUpdate field");\r\ncase X509_V_ERR_ERROR_IN_CRL_NEXT_UPDATE_FIELD:\r\nreturn("format error in CRL's nextUpdate field");\r\ncase X509_V_ERR_OUT_OF_MEM:\r\nreturn("out of memory");\r\ncase X509_V_ERR_DEPTH_ZERO_SELF_SIGNED_CERT:\r\nreturn("self signed certificate");\r\ncase X509_V_ERR_SELF_SIGNED_CERT_IN_CHAIN:\r\nreturn("self signed certificate in certificate chain");\r\ncase X509_V_ERR_UNABLE_TO_GET_ISSUER_CERT_LOCALLY:\r\nreturn("unable to get local issuer certificate");\r\ncase X509_V_ERR_UNABLE_TO_VERIFY_LEAF_SIGNATURE:\r\nreturn("unable to verify the first certificate");\r\ncase X509_V_ERR_CERT_CHAIN_TOO_LONG:\r\nreturn("certificate chain too long");\r\ncase X509_V_ERR_CERT_REVOKED:\r\nreturn("certificate revoked");\r\ncase X509_V_ERR_APPLICATION_VERIFICATION:\r\nreturn("application verification failure");\r\ndefault:\r\nsprintf(buf,"error number %ld",n);\r\nreturn(buf);\r\n}\r\n}
