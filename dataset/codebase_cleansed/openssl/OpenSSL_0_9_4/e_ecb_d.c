EVP_CIPHER *EVP_des_ecb(void)\r\n{\r\nreturn(&d_ecb_cipher);\r\n}\r\nstatic void des_ecb_init_key(EVP_CIPHER_CTX *ctx, unsigned char *key,\r\nunsigned char *iv, int enc)\r\n{\r\ndes_cblock *deskey = (des_cblock *)key;\r\nif (deskey != NULL)\r\ndes_set_key(deskey,ctx->c.des_ks);\r\n}\r\nstatic void des_ecb_cipher(EVP_CIPHER_CTX *ctx, unsigned char *out,\r\nunsigned char *in, unsigned int inl)\r\n{\r\nunsigned int i;\r\ndes_cblock *output ;\r\ndes_cblock *input ;\r\nif (inl < 8) return;\r\ninl-=8;\r\nfor (i=0; i<=inl; i+=8)\r\n{\r\noutput = (des_cblock *)(out + i);\r\ninput = (des_cblock *)(in + i);\r\ndes_ecb_encrypt(input,output,ctx->c.des_ks,ctx->encrypt);\r\n}\r\n}
