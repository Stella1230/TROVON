int X509_set_version(X509 *x, long version)\r\n{\r\nif (x == NULL) return(0);\r\nif (x->cert_info->version == NULL)\r\n{\r\nif ((x->cert_info->version=ASN1_INTEGER_new()) == NULL)\r\nreturn(0);\r\n}\r\nreturn(ASN1_INTEGER_set(x->cert_info->version,version));\r\n}\r\nint X509_set_serialNumber(X509 *x, ASN1_INTEGER *serial)\r\n{\r\nASN1_INTEGER *in;\r\nif (x == NULL) return(0);\r\nin=x->cert_info->serialNumber;\r\nif (in != serial)\r\n{\r\nin=ASN1_INTEGER_dup(serial);\r\nif (in != NULL)\r\n{\r\nASN1_INTEGER_free(x->cert_info->serialNumber);\r\nx->cert_info->serialNumber=in;\r\n}\r\n}\r\nreturn(in != NULL);\r\n}\r\nint X509_set_issuer_name(X509 *x, X509_NAME *name)\r\n{\r\nif ((x == NULL) || (x->cert_info == NULL)) return(0);\r\nreturn(X509_NAME_set(&x->cert_info->issuer,name));\r\n}\r\nint X509_set_subject_name(X509 *x, X509_NAME *name)\r\n{\r\nif ((x == NULL) || (x->cert_info == NULL)) return(0);\r\nreturn(X509_NAME_set(&x->cert_info->subject,name));\r\n}\r\nint X509_set_notBefore(X509 *x, ASN1_UTCTIME *tm)\r\n{\r\nASN1_UTCTIME *in;\r\nif ((x == NULL) || (x->cert_info->validity == NULL)) return(0);\r\nin=x->cert_info->validity->notBefore;\r\nif (in != tm)\r\n{\r\nin=ASN1_UTCTIME_dup(tm);\r\nif (in != NULL)\r\n{\r\nASN1_UTCTIME_free(x->cert_info->validity->notBefore);\r\nx->cert_info->validity->notBefore=in;\r\n}\r\n}\r\nreturn(in != NULL);\r\n}\r\nint X509_set_notAfter(X509 *x, ASN1_UTCTIME *tm)\r\n{\r\nASN1_UTCTIME *in;\r\nif ((x == NULL) || (x->cert_info->validity == NULL)) return(0);\r\nin=x->cert_info->validity->notAfter;\r\nif (in != tm)\r\n{\r\nin=ASN1_UTCTIME_dup(tm);\r\nif (in != NULL)\r\n{\r\nASN1_UTCTIME_free(x->cert_info->validity->notAfter);\r\nx->cert_info->validity->notAfter=in;\r\n}\r\n}\r\nreturn(in != NULL);\r\n}\r\nint X509_set_pubkey(X509 *x, EVP_PKEY *pkey)\r\n{\r\nif ((x == NULL) || (x->cert_info == NULL)) return(0);\r\nreturn(X509_PUBKEY_set(&(x->cert_info->key),pkey));\r\n}
