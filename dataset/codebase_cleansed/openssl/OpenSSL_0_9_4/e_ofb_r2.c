EVP_CIPHER *EVP_rc2_ofb(void)\r\n{\r\nreturn(&r2_ofb_cipher);\r\n}\r\nstatic void rc2_ofb_init_key(EVP_CIPHER_CTX *ctx, unsigned char *key,\r\nunsigned char *iv, int enc)\r\n{\r\nctx->num=0;\r\nif (iv != NULL)\r\nmemcpy(&(ctx->oiv[0]),iv,8);\r\nmemcpy(&(ctx->iv[0]),&(ctx->oiv[0]),8);\r\nif (key != NULL)\r\nRC2_set_key(&(ctx->c.rc2_ks),EVP_CIPHER_CTX_key_length(ctx),\r\nkey,EVP_CIPHER_CTX_key_length(ctx)*8);\r\n}\r\nstatic void rc2_ofb_cipher(EVP_CIPHER_CTX *ctx, unsigned char *out,\r\nunsigned char *in, unsigned int inl)\r\n{\r\nRC2_ofb64_encrypt(\r\nin,out,\r\n(long)inl, &(ctx->c.rc2_ks),\r\n&(ctx->iv[0]),\r\n&ctx->num);\r\n}
