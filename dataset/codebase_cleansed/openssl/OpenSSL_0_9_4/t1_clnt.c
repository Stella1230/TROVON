static SSL_METHOD *tls1_get_client_method(int ver)\r\n{\r\nif (ver == TLS1_VERSION)\r\nreturn(TLSv1_client_method());\r\nelse\r\nreturn(NULL);\r\n}\r\nSSL_METHOD *TLSv1_client_method(void)\r\n{\r\nstatic int init=1;\r\nstatic SSL_METHOD TLSv1_client_data;\r\nif (init)\r\n{\r\nmemcpy((char *)&TLSv1_client_data,(char *)tlsv1_base_method(),\r\nsizeof(SSL_METHOD));\r\nTLSv1_client_data.ssl_connect=ssl3_connect;\r\nTLSv1_client_data.get_ssl_method=tls1_get_client_method;\r\ninit=0;\r\n}\r\nreturn(&TLSv1_client_data);\r\n}
