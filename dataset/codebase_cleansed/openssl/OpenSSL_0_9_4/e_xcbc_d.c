EVP_CIPHER *EVP_desx_cbc(void)\r\n{\r\nreturn(&d_xcbc_cipher);\r\n}\r\nstatic void desx_cbc_init_key(EVP_CIPHER_CTX *ctx, unsigned char *key,\r\nunsigned char *iv, int enc)\r\n{\r\ndes_cblock *deskey = (des_cblock *)key;\r\nif (iv != NULL)\r\nmemcpy(&(ctx->oiv[0]),iv,8);\r\nmemcpy(&(ctx->iv[0]),&(ctx->oiv[0]),8);\r\nif (deskey != NULL)\r\n{\r\ndes_set_key(deskey,ctx->c.desx_cbc.ks);\r\nmemcpy(&(ctx->c.desx_cbc.inw[0]),&(key[8]),8);\r\nmemcpy(&(ctx->c.desx_cbc.outw[0]),&(key[16]),8);\r\n}\r\n}\r\nstatic void desx_cbc_cipher(EVP_CIPHER_CTX *ctx, unsigned char *out,\r\nunsigned char *in, unsigned int inl)\r\n{\r\ndes_xcbc_encrypt(in,out,inl,ctx->c.desx_cbc.ks,\r\n(des_cblock *)&(ctx->iv[0]),\r\n&ctx->c.desx_cbc.inw,\r\n&ctx->c.desx_cbc.outw,\r\nctx->encrypt);\r\n}
