main(argc,argv)\r\nint argc;\r\nchar *argv[];\r\n{\r\nBN_CTX ctx;\r\nBN_RECP_CTX recp;\r\nBIGNUM a,b,dd,d,r,rr,t,l;\r\nint i;\r\nMemCheck_start();\r\nMemCheck_on();\r\nBN_CTX_init(&ctx);\r\nBN_RECP_CTX_init(&recp);\r\nBN_init(&r);\r\nBN_init(&rr);\r\nBN_init(&d);\r\nBN_init(&dd);\r\nBN_init(&a);\r\nBN_init(&b);\r\n{\r\nBN_rand(&a,SIZE_A,0,0);\r\nBN_rand(&b,SIZE_B,0,0);\r\na.neg=1;\r\nBN_RECP_CTX_set(&recp,&b,&ctx);\r\nBN_print_fp(stdout,&a); printf(" a\n");\r\nBN_print_fp(stdout,&b); printf(" b\n");\r\nBN_print_fp(stdout,&recp.N); printf(" N\n");\r\nBN_print_fp(stdout,&recp.Nr); printf(" Nr num_bits=%d\n",recp.num_bits);\r\nBN_div_recp(&r,&d,&a,&recp,&ctx);\r\nfor (i=0; i<300; i++)\r\nBN_div(&rr,&dd,&a,&b,&ctx);\r\nBN_print_fp(stdout,&r); printf(" div recp\n");\r\nBN_print_fp(stdout,&rr); printf(" div\n");\r\nBN_print_fp(stdout,&d); printf(" rem recp\n");\r\nBN_print_fp(stdout,&dd); printf(" rem\n");\r\n}\r\nBN_CTX_free(&ctx);\r\nBN_RECP_CTX_free(&recp);\r\nBN_free(&r);\r\nBN_free(&rr);\r\nBN_free(&d);\r\nBN_free(&dd);\r\nBN_free(&a);\r\nBN_free(&b);\r\n{\r\nBIO *out;\r\nif ((out=BIO_new(BIO_s_file())) != NULL)\r\nBIO_set_fp(out,stderr,BIO_NOCLOSE|BIO_FP_TEXT);\r\nCRYPTO_mem_leaks(out);\r\nBIO_free(out);\r\n}\r\n}
