int i2d_PKCS7_ENC_CONTENT(PKCS7_ENC_CONTENT *a, unsigned char **pp)\r\n{\r\nM_ASN1_I2D_vars(a);\r\nM_ASN1_I2D_len(a->content_type,i2d_ASN1_OBJECT);\r\nM_ASN1_I2D_len(a->algorithm,i2d_X509_ALGOR);\r\nM_ASN1_I2D_len_IMP_opt(a->enc_data,i2d_ASN1_OCTET_STRING);\r\nM_ASN1_I2D_seq_total();\r\nM_ASN1_I2D_put(a->content_type,i2d_ASN1_OBJECT);\r\nM_ASN1_I2D_put(a->algorithm,i2d_X509_ALGOR);\r\nM_ASN1_I2D_put_IMP_opt(a->enc_data,i2d_ASN1_OCTET_STRING,0);\r\nM_ASN1_I2D_finish();\r\n}\r\nPKCS7_ENC_CONTENT *d2i_PKCS7_ENC_CONTENT(PKCS7_ENC_CONTENT **a,\r\nunsigned char **pp, long length)\r\n{\r\nM_ASN1_D2I_vars(a,PKCS7_ENC_CONTENT *,PKCS7_ENC_CONTENT_new);\r\nM_ASN1_D2I_Init();\r\nM_ASN1_D2I_start_sequence();\r\nM_ASN1_D2I_get(ret->content_type,d2i_ASN1_OBJECT);\r\nM_ASN1_D2I_get(ret->algorithm,d2i_X509_ALGOR);\r\nM_ASN1_D2I_get_IMP_opt(ret->enc_data,d2i_ASN1_OCTET_STRING,0,\r\nV_ASN1_OCTET_STRING);\r\nM_ASN1_D2I_Finish(a,PKCS7_ENC_CONTENT_free,\r\nASN1_F_D2I_PKCS7_ENC_CONTENT);\r\n}\r\nPKCS7_ENC_CONTENT *PKCS7_ENC_CONTENT_new(void)\r\n{\r\nPKCS7_ENC_CONTENT *ret=NULL;\r\nASN1_CTX c;\r\nM_ASN1_New_Malloc(ret,PKCS7_ENC_CONTENT);\r\nret->content_type=OBJ_nid2obj(NID_pkcs7_encrypted);\r\nM_ASN1_New(ret->algorithm,X509_ALGOR_new);\r\nret->enc_data=NULL;\r\nreturn(ret);\r\nM_ASN1_New_Error(ASN1_F_PKCS7_ENC_CONTENT_NEW);\r\n}\r\nvoid PKCS7_ENC_CONTENT_free(PKCS7_ENC_CONTENT *a)\r\n{\r\nif (a == NULL) return;\r\nASN1_OBJECT_free(a->content_type);\r\nX509_ALGOR_free(a->algorithm);\r\nASN1_OCTET_STRING_free(a->enc_data);\r\nFree((char *)a);\r\n}
