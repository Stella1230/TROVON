static ASN1_IA5STRING *ia5string_new(void)\r\n{\r\nreturn ASN1_IA5STRING_new();\r\n}\r\nstatic char *i2s_ASN1_IA5STRING(X509V3_EXT_METHOD *method,\r\nASN1_IA5STRING *ia5)\r\n{\r\nchar *tmp;\r\nif(!ia5 || !ia5->length) return NULL;\r\ntmp = Malloc(ia5->length + 1);\r\nmemcpy(tmp, ia5->data, ia5->length);\r\ntmp[ia5->length] = 0;\r\nreturn tmp;\r\n}\r\nstatic ASN1_IA5STRING *s2i_ASN1_IA5STRING(X509V3_EXT_METHOD *method,\r\nX509V3_CTX *ctx, char *str)\r\n{\r\nASN1_IA5STRING *ia5;\r\nif(!str) {\r\nX509V3err(X509V3_F_S2I_ASN1_IA5STRING,X509V3_R_INVALID_NULL_ARGUMENT);\r\nreturn NULL;\r\n}\r\nif(!(ia5 = ASN1_IA5STRING_new())) goto err;\r\nif(!ASN1_STRING_set((ASN1_STRING *)ia5, (unsigned char*)str,\r\nstrlen(str))) {\r\nASN1_IA5STRING_free(ia5);\r\ngoto err;\r\n}\r\nreturn ia5;\r\nerr:\r\nX509V3err(X509V3_F_S2I_ASN1_IA5STRING,ERR_R_MALLOC_FAILURE);\r\nreturn NULL;\r\n}
