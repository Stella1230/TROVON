int EVP_PKEY_decrypt(unsigned char *key, unsigned char *ek, int ekl,\r\nEVP_PKEY *priv)\r\n{\r\nint ret= -1;\r\n#ifndef NO_RSA\r\nif (priv->type != EVP_PKEY_RSA)\r\n{\r\n#endif\r\nEVPerr(EVP_F_EVP_PKEY_DECRYPT,EVP_R_PUBLIC_KEY_NOT_RSA);\r\n#ifndef NO_RSA\r\ngoto err;\r\n}\r\nret=RSA_private_decrypt(ekl,ek,key,priv->pkey.rsa,RSA_PKCS1_PADDING);\r\nerr:\r\n#endif\r\nreturn(ret);\r\n}
