int i2d_NETSCAPE_SPKAC(NETSCAPE_SPKAC *a, unsigned char **pp)\r\n{\r\nM_ASN1_I2D_vars(a);\r\nM_ASN1_I2D_len(a->pubkey, i2d_X509_PUBKEY);\r\nM_ASN1_I2D_len(a->challenge, i2d_ASN1_IA5STRING);\r\nM_ASN1_I2D_seq_total();\r\nM_ASN1_I2D_put(a->pubkey, i2d_X509_PUBKEY);\r\nM_ASN1_I2D_put(a->challenge, i2d_ASN1_IA5STRING);\r\nM_ASN1_I2D_finish();\r\n}\r\nNETSCAPE_SPKAC *d2i_NETSCAPE_SPKAC(NETSCAPE_SPKAC **a, unsigned char **pp,\r\nlong length)\r\n{\r\nM_ASN1_D2I_vars(a,NETSCAPE_SPKAC *,NETSCAPE_SPKAC_new);\r\nM_ASN1_D2I_Init();\r\nM_ASN1_D2I_start_sequence();\r\nM_ASN1_D2I_get(ret->pubkey,d2i_X509_PUBKEY);\r\nM_ASN1_D2I_get(ret->challenge,d2i_ASN1_IA5STRING);\r\nM_ASN1_D2I_Finish(a,NETSCAPE_SPKAC_free,ASN1_F_D2I_NETSCAPE_SPKAC);\r\n}\r\nNETSCAPE_SPKAC *NETSCAPE_SPKAC_new(void)\r\n{\r\nNETSCAPE_SPKAC *ret=NULL;\r\nASN1_CTX c;\r\nM_ASN1_New_Malloc(ret,NETSCAPE_SPKAC);\r\nM_ASN1_New(ret->pubkey,X509_PUBKEY_new);\r\nM_ASN1_New(ret->challenge,ASN1_IA5STRING_new);\r\nreturn(ret);\r\nM_ASN1_New_Error(ASN1_F_NETSCAPE_SPKAC_NEW);\r\n}\r\nvoid NETSCAPE_SPKAC_free(NETSCAPE_SPKAC *a)\r\n{\r\nif (a == NULL) return;\r\nX509_PUBKEY_free(a->pubkey);\r\nASN1_IA5STRING_free(a->challenge);\r\nFree((char *)a);\r\n}\r\nint i2d_NETSCAPE_SPKI(NETSCAPE_SPKI *a, unsigned char **pp)\r\n{\r\nM_ASN1_I2D_vars(a);\r\nM_ASN1_I2D_len(a->spkac, i2d_NETSCAPE_SPKAC);\r\nM_ASN1_I2D_len(a->sig_algor, i2d_X509_ALGOR);\r\nM_ASN1_I2D_len(a->signature, i2d_ASN1_BIT_STRING);\r\nM_ASN1_I2D_seq_total();\r\nM_ASN1_I2D_put(a->spkac, i2d_NETSCAPE_SPKAC);\r\nM_ASN1_I2D_put(a->sig_algor, i2d_X509_ALGOR);\r\nM_ASN1_I2D_put(a->signature, i2d_ASN1_BIT_STRING);\r\nM_ASN1_I2D_finish();\r\n}\r\nNETSCAPE_SPKI *d2i_NETSCAPE_SPKI(NETSCAPE_SPKI **a, unsigned char **pp,\r\nlong length)\r\n{\r\nM_ASN1_D2I_vars(a,NETSCAPE_SPKI *,NETSCAPE_SPKI_new);\r\nM_ASN1_D2I_Init();\r\nM_ASN1_D2I_start_sequence();\r\nM_ASN1_D2I_get(ret->spkac,d2i_NETSCAPE_SPKAC);\r\nM_ASN1_D2I_get(ret->sig_algor,d2i_X509_ALGOR);\r\nM_ASN1_D2I_get(ret->signature,d2i_ASN1_BIT_STRING);\r\nM_ASN1_D2I_Finish(a,NETSCAPE_SPKI_free,ASN1_F_D2I_NETSCAPE_SPKI);\r\n}\r\nNETSCAPE_SPKI *NETSCAPE_SPKI_new(void)\r\n{\r\nNETSCAPE_SPKI *ret=NULL;\r\nASN1_CTX c;\r\nM_ASN1_New_Malloc(ret,NETSCAPE_SPKI);\r\nM_ASN1_New(ret->spkac,NETSCAPE_SPKAC_new);\r\nM_ASN1_New(ret->sig_algor,X509_ALGOR_new);\r\nM_ASN1_New(ret->signature,ASN1_BIT_STRING_new);\r\nreturn(ret);\r\nM_ASN1_New_Error(ASN1_F_NETSCAPE_SPKI_NEW);\r\n}\r\nvoid NETSCAPE_SPKI_free(NETSCAPE_SPKI *a)\r\n{\r\nif (a == NULL) return;\r\nNETSCAPE_SPKAC_free(a->spkac);\r\nX509_ALGOR_free(a->sig_algor);\r\nASN1_BIT_STRING_free(a->signature);\r\nFree((char *)a);\r\n}
