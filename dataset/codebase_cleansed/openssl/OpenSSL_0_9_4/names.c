int EVP_add_cipher(EVP_CIPHER *c)\r\n{\r\nint r;\r\nr=OBJ_NAME_add(OBJ_nid2sn(c->nid),OBJ_NAME_TYPE_CIPHER_METH,(char *)c);\r\nif (r == 0) return(0);\r\nr=OBJ_NAME_add(OBJ_nid2ln(c->nid),OBJ_NAME_TYPE_CIPHER_METH,(char *)c);\r\nreturn(r);\r\n}\r\nint EVP_add_digest(EVP_MD *md)\r\n{\r\nint r;\r\nconst char *name;\r\nname=OBJ_nid2sn(md->type);\r\nr=OBJ_NAME_add(name,OBJ_NAME_TYPE_MD_METH,(char *)md);\r\nif (r == 0) return(0);\r\nr=OBJ_NAME_add(OBJ_nid2ln(md->type),OBJ_NAME_TYPE_MD_METH,(char *)md);\r\nif (r == 0) return(0);\r\nif (md->type != md->pkey_type)\r\n{\r\nr=OBJ_NAME_add(OBJ_nid2sn(md->pkey_type),\r\nOBJ_NAME_TYPE_MD_METH|OBJ_NAME_ALIAS,name);\r\nif (r == 0) return(0);\r\nr=OBJ_NAME_add(OBJ_nid2ln(md->pkey_type),\r\nOBJ_NAME_TYPE_MD_METH|OBJ_NAME_ALIAS,name);\r\n}\r\nreturn(r);\r\n}\r\nconst EVP_CIPHER *EVP_get_cipherbyname(const char *name)\r\n{\r\nconst EVP_CIPHER *cp;\r\ncp=(const EVP_CIPHER *)OBJ_NAME_get(name,OBJ_NAME_TYPE_CIPHER_METH);\r\nreturn(cp);\r\n}\r\nconst EVP_MD *EVP_get_digestbyname(const char *name)\r\n{\r\nconst EVP_MD *cp;\r\ncp=(const EVP_MD *)OBJ_NAME_get(name,OBJ_NAME_TYPE_MD_METH);\r\nreturn(cp);\r\n}\r\nvoid EVP_cleanup(void)\r\n{\r\nOBJ_NAME_cleanup(OBJ_NAME_TYPE_CIPHER_METH);\r\nOBJ_NAME_cleanup(OBJ_NAME_TYPE_MD_METH);\r\nEVP_PBE_cleanup();\r\n}
