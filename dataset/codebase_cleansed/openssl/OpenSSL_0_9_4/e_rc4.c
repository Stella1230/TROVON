EVP_CIPHER *EVP_rc4(void)\r\n{\r\nreturn(&r4_cipher);\r\n}\r\nEVP_CIPHER *EVP_rc4_40(void)\r\n{\r\nreturn(&r4_40_cipher);\r\n}\r\nstatic void rc4_init_key(EVP_CIPHER_CTX *ctx, unsigned char *key,\r\nunsigned char *iv, int enc)\r\n{\r\nif (key != NULL)\r\nmemcpy(&(ctx->c.rc4.key[0]),key,EVP_CIPHER_CTX_key_length(ctx));\r\nRC4_set_key(&(ctx->c.rc4.ks),EVP_CIPHER_CTX_key_length(ctx),\r\nctx->c.rc4.key);\r\n}\r\nstatic void rc4_cipher(EVP_CIPHER_CTX *ctx, unsigned char *out,\r\nunsigned char *in, unsigned int inl)\r\n{\r\nRC4(&(ctx->c.rc4.ks),inl,in,out);\r\n}
