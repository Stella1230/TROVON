static SSL_METHOD *ssl2_get_method(int ver)\r\n{\r\nif (ver == SSL2_VERSION)\r\nreturn(SSLv2_method());\r\nelse\r\nreturn(NULL);\r\n}\r\nSSL_METHOD *SSLv2_method(void)\r\n{\r\nstatic int init=1;\r\nstatic SSL_METHOD SSLv2_data;\r\nif (init)\r\n{\r\nmemcpy((char *)&SSLv2_data,(char *)sslv2_base_method(),\r\nsizeof(SSL_METHOD));\r\nSSLv2_data.ssl_connect=ssl2_connect;\r\nSSLv2_data.ssl_accept=ssl2_accept;\r\nSSLv2_data.get_ssl_method=ssl2_get_method;\r\ninit=0;\r\n}\r\nreturn(&SSLv2_data);\r\n}
