DES_LONG des_quad_cksum(const unsigned char *input, des_cblock output[],\r\nlong length, int out_count, des_cblock *seed)\r\n{\r\nDES_LONG z0,z1,t0,t1;\r\nint i;\r\nlong l;\r\nconst unsigned char *cp;\r\nunsigned char *lp;\r\nif (out_count < 1) out_count=1;\r\nlp = &(output[0])[0];\r\nz0=Q_B0((*seed)[0])|Q_B1((*seed)[1])|Q_B2((*seed)[2])|Q_B3((*seed)[3]);\r\nz1=Q_B0((*seed)[4])|Q_B1((*seed)[5])|Q_B2((*seed)[6])|Q_B3((*seed)[7]);\r\nfor (i=0; ((i<4)&&(i<out_count)); i++)\r\n{\r\ncp=input;\r\nl=length;\r\nwhile (l > 0)\r\n{\r\nif (l > 1)\r\n{\r\nt0= (DES_LONG)(*(cp++));\r\nt0|=(DES_LONG)Q_B1(*(cp++));\r\nl--;\r\n}\r\nelse\r\nt0= (DES_LONG)(*(cp++));\r\nl--;\r\nt0+=z0;\r\nt0&=0xffffffffL;\r\nt1=z1;\r\nz0=((((t0*t0)&0xffffffffL)+((t1*t1)&0xffffffffL))\r\n&0xffffffffL)%0x7fffffffL;\r\nz1=((t0*((t1+NOISE)&0xffffffffL))&0xffffffffL)%0x7fffffffL;\r\n}\r\nif (lp != NULL)\r\n{\r\nstatic DES_LONG ltmp=1;\r\nstatic unsigned char *c=(unsigned char *)&ltmp;\r\nif (c[0])\r\n{\r\nl2c(z0,lp);\r\nl2c(z1,lp);\r\n}\r\nelse\r\n{\r\nlp = &(output[out_count-i-1])[0];\r\nl2n(z1,lp);\r\nl2n(z0,lp);\r\n}\r\n}\r\n}\r\nreturn(z0);\r\n}
