int i2d_ASN1_HEADER(ASN1_HEADER *a, unsigned char **pp)\r\n{\r\nM_ASN1_I2D_vars(a);\r\nM_ASN1_I2D_len(a->header, i2d_ASN1_OCTET_STRING);\r\nM_ASN1_I2D_len(a->data, a->meth->i2d);\r\nM_ASN1_I2D_seq_total();\r\nM_ASN1_I2D_put(a->header, i2d_ASN1_OCTET_STRING);\r\nM_ASN1_I2D_put(a->data, a->meth->i2d);\r\nM_ASN1_I2D_finish();\r\n}\r\nASN1_HEADER *d2i_ASN1_HEADER(ASN1_HEADER **a, unsigned char **pp,\r\nlong length)\r\n{\r\nM_ASN1_D2I_vars(a,ASN1_HEADER *,ASN1_HEADER_new);\r\nM_ASN1_D2I_Init();\r\nM_ASN1_D2I_start_sequence();\r\nM_ASN1_D2I_get(ret->header,d2i_ASN1_OCTET_STRING);\r\nif (ret->meth != NULL)\r\n{\r\nM_ASN1_D2I_get(ret->data,ret->meth->d2i);\r\n}\r\nelse\r\n{\r\nif (a != NULL) (*a)=ret;\r\nreturn(ret);\r\n}\r\nM_ASN1_D2I_Finish(a,ASN1_HEADER_free,ASN1_F_D2I_ASN1_HEADER);\r\n}\r\nASN1_HEADER *ASN1_HEADER_new(void)\r\n{\r\nASN1_HEADER *ret=NULL;\r\nASN1_CTX c;\r\nM_ASN1_New_Malloc(ret,ASN1_HEADER);\r\nM_ASN1_New(ret->header,M_ASN1_OCTET_STRING_new);\r\nret->meth=NULL;\r\nret->data=NULL;\r\nreturn(ret);\r\nM_ASN1_New_Error(ASN1_F_ASN1_HEADER_NEW);\r\n}\r\nvoid ASN1_HEADER_free(ASN1_HEADER *a)\r\n{\r\nif (a == NULL) return;\r\nM_ASN1_OCTET_STRING_free(a->header);\r\nif (a->meth != NULL)\r\na->meth->destroy(a->data);\r\nOPENSSL_free(a);\r\n}
