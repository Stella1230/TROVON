void * __iomem __iop13xx_io(unsigned long io_addr)\r\n{\r\nvoid __iomem * io_virt;\r\nswitch (io_addr) {\r\ncase IOP13XX_PCIE_LOWER_IO_PA ... IOP13XX_PCIE_UPPER_IO_PA:\r\nio_virt = (void *) IOP13XX_PCIE_IO_PHYS_TO_VIRT(io_addr);\r\nbreak;\r\ncase IOP13XX_PCIX_LOWER_IO_PA ... IOP13XX_PCIX_UPPER_IO_PA:\r\nio_virt = (void *) IOP13XX_PCIX_IO_PHYS_TO_VIRT(io_addr);\r\nbreak;\r\ndefault:\r\nBUG();\r\n}\r\nreturn io_virt;\r\n}\r\nvoid * __iomem __iop13xx_ioremap(unsigned long cookie, size_t size,\r\nunsigned int mtype)\r\n{\r\nvoid __iomem * retval;\r\nswitch (cookie) {\r\ncase IOP13XX_PCIX_LOWER_MEM_RA ... IOP13XX_PCIX_UPPER_MEM_RA:\r\nif (unlikely(!iop13xx_atux_mem_base))\r\nretval = NULL;\r\nelse\r\nretval = (void *)(iop13xx_atux_mem_base +\r\n(cookie - IOP13XX_PCIX_LOWER_MEM_RA));\r\nbreak;\r\ncase IOP13XX_PCIE_LOWER_MEM_RA ... IOP13XX_PCIE_UPPER_MEM_RA:\r\nif (unlikely(!iop13xx_atue_mem_base))\r\nretval = NULL;\r\nelse\r\nretval = (void *)(iop13xx_atue_mem_base +\r\n(cookie - IOP13XX_PCIE_LOWER_MEM_RA));\r\nbreak;\r\ncase IOP13XX_PBI_LOWER_MEM_RA ... IOP13XX_PBI_UPPER_MEM_RA:\r\nretval = __arm_ioremap_caller(IOP13XX_PBI_LOWER_MEM_PA +\r\n(cookie - IOP13XX_PBI_LOWER_MEM_RA),\r\nsize, mtype, __builtin_return_address(0));\r\nbreak;\r\ncase IOP13XX_PCIE_LOWER_IO_PA ... IOP13XX_PCIE_UPPER_IO_PA:\r\nretval = (void *) IOP13XX_PCIE_IO_PHYS_TO_VIRT(cookie);\r\nbreak;\r\ncase IOP13XX_PCIX_LOWER_IO_PA ... IOP13XX_PCIX_UPPER_IO_PA:\r\nretval = (void *) IOP13XX_PCIX_IO_PHYS_TO_VIRT(cookie);\r\nbreak;\r\ncase IOP13XX_PMMR_PHYS_MEM_BASE ... IOP13XX_PMMR_UPPER_MEM_PA:\r\nretval = (void *) IOP13XX_PMMR_PHYS_TO_VIRT(cookie);\r\nbreak;\r\ndefault:\r\nretval = __arm_ioremap_caller(cookie, size, mtype,\r\n__builtin_return_address(0));\r\n}\r\nreturn retval;\r\n}\r\nvoid __iop13xx_iounmap(void __iomem *addr)\r\n{\r\nextern void __iounmap(volatile void __iomem *addr);\r\nif (iop13xx_atue_mem_base)\r\nif (addr >= (void __iomem *) iop13xx_atue_mem_base &&\r\naddr < (void __iomem *) (iop13xx_atue_mem_base +\r\niop13xx_atue_mem_size))\r\ngoto skip;\r\nif (iop13xx_atux_mem_base)\r\nif (addr >= (void __iomem *) iop13xx_atux_mem_base &&\r\naddr < (void __iomem *) (iop13xx_atux_mem_base +\r\niop13xx_atux_mem_size))\r\ngoto skip;\r\nswitch ((u32) addr) {\r\ncase IOP13XX_PCIE_LOWER_IO_VA ... IOP13XX_PCIE_UPPER_IO_VA:\r\ncase IOP13XX_PCIX_LOWER_IO_VA ... IOP13XX_PCIX_UPPER_IO_VA:\r\ncase IOP13XX_PMMR_VIRT_MEM_BASE ... IOP13XX_PMMR_UPPER_MEM_VA:\r\ngoto skip;\r\n}\r\n__iounmap(addr);\r\nskip:\r\nreturn;\r\n}
