static inline bool valid_bank(u8 bank)\r\n{\r\nreturn ((bank == AB8500_SYS_CTRL1_BLOCK) ||\r\n(bank == AB8500_SYS_CTRL2_BLOCK));\r\n}\r\nint ab8500_sysctrl_read(u16 reg, u8 *value)\r\n{\r\nu8 bank;\r\nif (sysctrl_dev == NULL)\r\nreturn -EAGAIN;\r\nbank = (reg >> 8);\r\nif (!valid_bank(bank))\r\nreturn -EINVAL;\r\nreturn abx500_get_register_interruptible(sysctrl_dev, bank,\r\n(u8)(reg & 0xFF), value);\r\n}\r\nint ab8500_sysctrl_write(u16 reg, u8 mask, u8 value)\r\n{\r\nu8 bank;\r\nif (sysctrl_dev == NULL)\r\nreturn -EAGAIN;\r\nbank = (reg >> 8);\r\nif (!valid_bank(bank))\r\nreturn -EINVAL;\r\nreturn abx500_mask_and_set_register_interruptible(sysctrl_dev, bank,\r\n(u8)(reg & 0xFF), mask, value);\r\n}\r\nstatic int __devinit ab8500_sysctrl_probe(struct platform_device *pdev)\r\n{\r\nsysctrl_dev = &pdev->dev;\r\nreturn 0;\r\n}\r\nstatic int __devexit ab8500_sysctrl_remove(struct platform_device *pdev)\r\n{\r\nsysctrl_dev = NULL;\r\nreturn 0;\r\n}\r\nstatic int __init ab8500_sysctrl_init(void)\r\n{\r\nreturn platform_driver_register(&ab8500_sysctrl_driver);\r\n}
