static int xqm_proc_show(struct seq_file *m, void *v)\r\n{\r\nseq_printf(m, "%d\t%d\t%d\t%u\n",\r\nndquot,\r\nxfs_Gqm? atomic_read(&xfs_Gqm->qm_totaldquots) : 0,\r\nxfs_Gqm? xfs_Gqm->qm_dqfree_ratio : 0,\r\nxfs_Gqm? xfs_Gqm->qm_dqfrlist_cnt : 0);\r\nreturn 0;\r\n}\r\nstatic int xqm_proc_open(struct inode *inode, struct file *file)\r\n{\r\nreturn single_open(file, xqm_proc_show, NULL);\r\n}\r\nstatic int xqmstat_proc_show(struct seq_file *m, void *v)\r\n{\r\nseq_printf(m, "qm %u %u %u %u %u %u %u %u\n",\r\nxqmstats.xs_qm_dqreclaims,\r\nxqmstats.xs_qm_dqreclaim_misses,\r\nxqmstats.xs_qm_dquot_dups,\r\nxqmstats.xs_qm_dqcachemisses,\r\nxqmstats.xs_qm_dqcachehits,\r\nxqmstats.xs_qm_dqwants,\r\nxqmstats.xs_qm_dqshake_reclaims,\r\nxqmstats.xs_qm_dqinact_reclaims);\r\nreturn 0;\r\n}\r\nstatic int xqmstat_proc_open(struct inode *inode, struct file *file)\r\n{\r\nreturn single_open(file, xqmstat_proc_show, NULL);\r\n}\r\nvoid\r\nxfs_qm_init_procfs(void)\r\n{\r\nproc_create("fs/xfs/xqmstat", 0, NULL, &xqmstat_proc_fops);\r\nproc_create("fs/xfs/xqm", 0, NULL, &xqm_proc_fops);\r\n}\r\nvoid\r\nxfs_qm_cleanup_procfs(void)\r\n{\r\nremove_proc_entry("fs/xfs/xqm", NULL);\r\nremove_proc_entry("fs/xfs/xqmstat", NULL);\r\n}
