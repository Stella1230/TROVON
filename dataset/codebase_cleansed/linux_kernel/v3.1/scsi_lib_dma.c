int scsi_dma_map(struct scsi_cmnd *cmd)\r\n{\r\nint nseg = 0;\r\nif (scsi_sg_count(cmd)) {\r\nstruct device *dev = cmd->device->host->dma_dev;\r\nnseg = dma_map_sg(dev, scsi_sglist(cmd), scsi_sg_count(cmd),\r\ncmd->sc_data_direction);\r\nif (unlikely(!nseg))\r\nreturn -ENOMEM;\r\n}\r\nreturn nseg;\r\n}\r\nvoid scsi_dma_unmap(struct scsi_cmnd *cmd)\r\n{\r\nif (scsi_sg_count(cmd)) {\r\nstruct device *dev = cmd->device->host->dma_dev;\r\ndma_unmap_sg(dev, scsi_sglist(cmd), scsi_sg_count(cmd),\r\ncmd->sc_data_direction);\r\n}\r\n}
