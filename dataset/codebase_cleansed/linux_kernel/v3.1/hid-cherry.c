static __u8 *ch_report_fixup(struct hid_device *hdev, __u8 *rdesc,\r\nunsigned int *rsize)\r\n{\r\nif (*rsize >= 17 && rdesc[11] == 0x3c && rdesc[12] == 0x02) {\r\nhid_info(hdev, "fixing up Cherry Cymotion report descriptor\n");\r\nrdesc[11] = rdesc[16] = 0xff;\r\nrdesc[12] = rdesc[17] = 0x03;\r\n}\r\nreturn rdesc;\r\n}\r\nstatic int ch_input_mapping(struct hid_device *hdev, struct hid_input *hi,\r\nstruct hid_field *field, struct hid_usage *usage,\r\nunsigned long **bit, int *max)\r\n{\r\nif ((usage->hid & HID_USAGE_PAGE) != HID_UP_CONSUMER)\r\nreturn 0;\r\nswitch (usage->hid & HID_USAGE) {\r\ncase 0x301: ch_map_key_clear(KEY_PROG1); break;\r\ncase 0x302: ch_map_key_clear(KEY_PROG2); break;\r\ncase 0x303: ch_map_key_clear(KEY_PROG3); break;\r\ndefault:\r\nreturn 0;\r\n}\r\nreturn 1;\r\n}\r\nstatic int __init ch_init(void)\r\n{\r\nreturn hid_register_driver(&ch_driver);\r\n}\r\nstatic void __exit ch_exit(void)\r\n{\r\nhid_unregister_driver(&ch_driver);\r\n}
