static int pcie_port_bus_match(struct device *dev, struct device_driver *drv)\r\n{\r\nstruct pcie_device *pciedev;\r\nstruct pcie_port_service_driver *driver;\r\nif (drv->bus != &pcie_port_bus_type || dev->bus != &pcie_port_bus_type)\r\nreturn 0;\r\npciedev = to_pcie_device(dev);\r\ndriver = to_service_driver(drv);\r\nif (driver->service != pciedev->service)\r\nreturn 0;\r\nif ((driver->port_type != PCIE_ANY_PORT) &&\r\n(driver->port_type != pciedev->port->pcie_type))\r\nreturn 0;\r\nreturn 1;\r\n}\r\nint pcie_port_bus_register(void)\r\n{\r\nreturn bus_register(&pcie_port_bus_type);\r\n}\r\nvoid pcie_port_bus_unregister(void)\r\n{\r\nbus_unregister(&pcie_port_bus_type);\r\n}
