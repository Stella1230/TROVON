char *xstrdup(const char *s)\r\n{\r\nint len = strlen(s) + 1;\r\nchar *dup = xmalloc(len);\r\nmemcpy(dup, s, len);\r\nreturn dup;\r\n}\r\nchar *join_path(const char *path, const char *name)\r\n{\r\nint lenp = strlen(path);\r\nint lenn = strlen(name);\r\nint len;\r\nint needslash = 1;\r\nchar *str;\r\nlen = lenp + lenn + 2;\r\nif ((lenp > 0) && (path[lenp-1] == '/')) {\r\nneedslash = 0;\r\nlen--;\r\n}\r\nstr = xmalloc(len);\r\nmemcpy(str, path, lenp);\r\nif (needslash) {\r\nstr[lenp] = '/';\r\nlenp++;\r\n}\r\nmemcpy(str+lenp, name, lenn+1);\r\nreturn str;\r\n}
