int\r\nnv04_timer_init(struct drm_device *dev)\r\n{\r\nnv_wr32(dev, NV04_PTIMER_INTR_EN_0, 0x00000000);\r\nnv_wr32(dev, NV04_PTIMER_INTR_0, 0xFFFFFFFF);\r\nif (!nv_rd32(dev, NV04_PTIMER_NUMERATOR) ||\r\n!nv_rd32(dev, NV04_PTIMER_DENOMINATOR)) {\r\nnv_wr32(dev, NV04_PTIMER_NUMERATOR, 0x00000008);\r\nnv_wr32(dev, NV04_PTIMER_DENOMINATOR, 0x00000003);\r\n}\r\nreturn 0;\r\n}\r\nuint64_t\r\nnv04_timer_read(struct drm_device *dev)\r\n{\r\nuint32_t low;\r\nuint32_t high2 = nv_rd32(dev, NV04_PTIMER_TIME_1);\r\nuint32_t high1;\r\ndo {\r\nhigh1 = high2;\r\nlow = nv_rd32(dev, NV04_PTIMER_TIME_0);\r\nhigh2 = nv_rd32(dev, NV04_PTIMER_TIME_1);\r\n} while (high1 != high2);\r\nreturn (((uint64_t)high2) << 32) | (uint64_t)low;\r\n}\r\nvoid\r\nnv04_timer_takedown(struct drm_device *dev)\r\n{\r\n}
