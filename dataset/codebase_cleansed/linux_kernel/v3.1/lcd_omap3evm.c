static int omap3evm_panel_init(struct lcd_panel *panel,\r\nstruct omapfb_device *fbdev)\r\n{\r\ngpio_request(LCD_PANEL_LR, "LCD lr");\r\ngpio_request(LCD_PANEL_UD, "LCD ud");\r\ngpio_request(LCD_PANEL_INI, "LCD ini");\r\ngpio_request(LCD_PANEL_RESB, "LCD resb");\r\ngpio_request(LCD_PANEL_QVGA, "LCD qvga");\r\ngpio_direction_output(LCD_PANEL_RESB, 1);\r\ngpio_direction_output(LCD_PANEL_INI, 1);\r\ngpio_direction_output(LCD_PANEL_QVGA, 0);\r\ngpio_direction_output(LCD_PANEL_LR, 1);\r\ngpio_direction_output(LCD_PANEL_UD, 1);\r\ntwl_i2c_write_u8(TWL4030_MODULE_LED, 0x11, TWL_LED_LEDEN);\r\ntwl_i2c_write_u8(TWL4030_MODULE_PWMA, 0x01, TWL_PWMA_PWMAON);\r\ntwl_i2c_write_u8(TWL4030_MODULE_PWMA, 0x02, TWL_PWMA_PWMAOFF);\r\nbklight_level = 100;\r\nreturn 0;\r\n}\r\nstatic void omap3evm_panel_cleanup(struct lcd_panel *panel)\r\n{\r\ngpio_free(LCD_PANEL_QVGA);\r\ngpio_free(LCD_PANEL_RESB);\r\ngpio_free(LCD_PANEL_INI);\r\ngpio_free(LCD_PANEL_UD);\r\ngpio_free(LCD_PANEL_LR);\r\n}\r\nstatic int omap3evm_panel_enable(struct lcd_panel *panel)\r\n{\r\ngpio_set_value(LCD_PANEL_ENABLE_GPIO, 0);\r\nreturn 0;\r\n}\r\nstatic void omap3evm_panel_disable(struct lcd_panel *panel)\r\n{\r\ngpio_set_value(LCD_PANEL_ENABLE_GPIO, 1);\r\n}\r\nstatic unsigned long omap3evm_panel_get_caps(struct lcd_panel *panel)\r\n{\r\nreturn 0;\r\n}\r\nstatic int omap3evm_bklight_setlevel(struct lcd_panel *panel,\r\nunsigned int level)\r\n{\r\nu8 c;\r\nif ((level >= 0) && (level <= 100)) {\r\nc = (125 * (100 - level)) / 100 + 2;\r\ntwl_i2c_write_u8(TWL4030_MODULE_PWMA, c, TWL_PWMA_PWMAOFF);\r\nbklight_level = level;\r\n}\r\nreturn 0;\r\n}\r\nstatic unsigned int omap3evm_bklight_getlevel(struct lcd_panel *panel)\r\n{\r\nreturn bklight_level;\r\n}\r\nstatic unsigned int omap3evm_bklight_getmaxlevel(struct lcd_panel *panel)\r\n{\r\nreturn 100;\r\n}\r\nstatic int omap3evm_panel_probe(struct platform_device *pdev)\r\n{\r\nomapfb_register_panel(&omap3evm_panel);\r\nreturn 0;\r\n}\r\nstatic int omap3evm_panel_remove(struct platform_device *pdev)\r\n{\r\nreturn 0;\r\n}\r\nstatic int omap3evm_panel_suspend(struct platform_device *pdev,\r\npm_message_t mesg)\r\n{\r\nreturn 0;\r\n}\r\nstatic int omap3evm_panel_resume(struct platform_device *pdev)\r\n{\r\nreturn 0;\r\n}\r\nstatic int __init omap3evm_panel_drv_init(void)\r\n{\r\nreturn platform_driver_register(&omap3evm_panel_driver);\r\n}\r\nstatic void __exit omap3evm_panel_drv_exit(void)\r\n{\r\nplatform_driver_unregister(&omap3evm_panel_driver);\r\n}
