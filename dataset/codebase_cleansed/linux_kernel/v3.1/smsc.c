static int smsc_phy_config_intr(struct phy_device *phydev)\r\n{\r\nint rc = phy_write (phydev, MII_LAN83C185_IM,\r\n((PHY_INTERRUPT_ENABLED == phydev->interrupts)\r\n? MII_LAN83C185_ISF_INT_PHYLIB_EVENTS\r\n: 0));\r\nreturn rc < 0 ? rc : 0;\r\n}\r\nstatic int smsc_phy_ack_interrupt(struct phy_device *phydev)\r\n{\r\nint rc = phy_read (phydev, MII_LAN83C185_ISF);\r\nreturn rc < 0 ? rc : 0;\r\n}\r\nstatic int smsc_phy_config_init(struct phy_device *phydev)\r\n{\r\nint rc = phy_read(phydev, MII_LAN83C185_CTRL_STATUS);\r\nif (rc < 0)\r\nreturn rc;\r\nrc = phy_write(phydev, MII_LAN83C185_CTRL_STATUS,\r\nrc | MII_LAN83C185_EDPWRDOWN);\r\nif (rc < 0)\r\nreturn rc;\r\nreturn smsc_phy_ack_interrupt (phydev);\r\n}\r\nstatic int lan911x_config_init(struct phy_device *phydev)\r\n{\r\nreturn smsc_phy_ack_interrupt(phydev);\r\n}\r\nstatic int __init smsc_init(void)\r\n{\r\nint ret;\r\nret = phy_driver_register (&lan83c185_driver);\r\nif (ret)\r\ngoto err1;\r\nret = phy_driver_register (&lan8187_driver);\r\nif (ret)\r\ngoto err2;\r\nret = phy_driver_register (&lan8700_driver);\r\nif (ret)\r\ngoto err3;\r\nret = phy_driver_register (&lan911x_int_driver);\r\nif (ret)\r\ngoto err4;\r\nret = phy_driver_register (&lan8710_driver);\r\nif (ret)\r\ngoto err5;\r\nreturn 0;\r\nerr5:\r\nphy_driver_unregister (&lan911x_int_driver);\r\nerr4:\r\nphy_driver_unregister (&lan8700_driver);\r\nerr3:\r\nphy_driver_unregister (&lan8187_driver);\r\nerr2:\r\nphy_driver_unregister (&lan83c185_driver);\r\nerr1:\r\nreturn ret;\r\n}\r\nstatic void __exit smsc_exit(void)\r\n{\r\nphy_driver_unregister (&lan8710_driver);\r\nphy_driver_unregister (&lan911x_int_driver);\r\nphy_driver_unregister (&lan8700_driver);\r\nphy_driver_unregister (&lan8187_driver);\r\nphy_driver_unregister (&lan83c185_driver);\r\n}
