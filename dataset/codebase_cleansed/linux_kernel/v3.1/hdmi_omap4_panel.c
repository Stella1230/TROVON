static int hdmi_panel_probe(struct omap_dss_device *dssdev)\r\n{\r\nDSSDBG("ENTER hdmi_panel_probe\n");\r\ndssdev->panel.config = OMAP_DSS_LCD_TFT |\r\nOMAP_DSS_LCD_IVS | OMAP_DSS_LCD_IHS;\r\ndssdev->panel.timings.x_res = 640;\r\ndssdev->panel.timings.y_res = 480;\r\nDSSDBG("hdmi_panel_probe x_res= %d y_res = %d\n",\r\ndssdev->panel.timings.x_res,\r\ndssdev->panel.timings.y_res);\r\nreturn 0;\r\n}\r\nstatic void hdmi_panel_remove(struct omap_dss_device *dssdev)\r\n{\r\n}\r\nstatic int hdmi_panel_enable(struct omap_dss_device *dssdev)\r\n{\r\nint r = 0;\r\nDSSDBG("ENTER hdmi_panel_enable\n");\r\nmutex_lock(&hdmi.hdmi_lock);\r\nif (dssdev->state != OMAP_DSS_DISPLAY_DISABLED) {\r\nr = -EINVAL;\r\ngoto err;\r\n}\r\nr = omapdss_hdmi_display_enable(dssdev);\r\nif (r) {\r\nDSSERR("failed to power on\n");\r\ngoto err;\r\n}\r\ndssdev->state = OMAP_DSS_DISPLAY_ACTIVE;\r\nerr:\r\nmutex_unlock(&hdmi.hdmi_lock);\r\nreturn r;\r\n}\r\nstatic void hdmi_panel_disable(struct omap_dss_device *dssdev)\r\n{\r\nmutex_lock(&hdmi.hdmi_lock);\r\nif (dssdev->state == OMAP_DSS_DISPLAY_ACTIVE)\r\nomapdss_hdmi_display_disable(dssdev);\r\ndssdev->state = OMAP_DSS_DISPLAY_DISABLED;\r\nmutex_unlock(&hdmi.hdmi_lock);\r\n}\r\nstatic int hdmi_panel_suspend(struct omap_dss_device *dssdev)\r\n{\r\nint r = 0;\r\nmutex_lock(&hdmi.hdmi_lock);\r\nif (dssdev->state != OMAP_DSS_DISPLAY_ACTIVE) {\r\nr = -EINVAL;\r\ngoto err;\r\n}\r\ndssdev->state = OMAP_DSS_DISPLAY_SUSPENDED;\r\nomapdss_hdmi_display_disable(dssdev);\r\nerr:\r\nmutex_unlock(&hdmi.hdmi_lock);\r\nreturn r;\r\n}\r\nstatic int hdmi_panel_resume(struct omap_dss_device *dssdev)\r\n{\r\nint r = 0;\r\nmutex_lock(&hdmi.hdmi_lock);\r\nif (dssdev->state != OMAP_DSS_DISPLAY_SUSPENDED) {\r\nr = -EINVAL;\r\ngoto err;\r\n}\r\nr = omapdss_hdmi_display_enable(dssdev);\r\nif (r) {\r\nDSSERR("failed to power on\n");\r\ngoto err;\r\n}\r\ndssdev->state = OMAP_DSS_DISPLAY_ACTIVE;\r\nerr:\r\nmutex_unlock(&hdmi.hdmi_lock);\r\nreturn r;\r\n}\r\nstatic void hdmi_get_timings(struct omap_dss_device *dssdev,\r\nstruct omap_video_timings *timings)\r\n{\r\nmutex_lock(&hdmi.hdmi_lock);\r\n*timings = dssdev->panel.timings;\r\nmutex_unlock(&hdmi.hdmi_lock);\r\n}\r\nstatic void hdmi_set_timings(struct omap_dss_device *dssdev,\r\nstruct omap_video_timings *timings)\r\n{\r\nDSSDBG("hdmi_set_timings\n");\r\nmutex_lock(&hdmi.hdmi_lock);\r\ndssdev->panel.timings = *timings;\r\nif (dssdev->state == OMAP_DSS_DISPLAY_ACTIVE) {\r\nomapdss_hdmi_display_disable(dssdev);\r\nomapdss_hdmi_display_set_timing(dssdev);\r\n}\r\nmutex_unlock(&hdmi.hdmi_lock);\r\n}\r\nstatic int hdmi_check_timings(struct omap_dss_device *dssdev,\r\nstruct omap_video_timings *timings)\r\n{\r\nint r = 0;\r\nDSSDBG("hdmi_check_timings\n");\r\nmutex_lock(&hdmi.hdmi_lock);\r\nr = omapdss_hdmi_display_check_timing(dssdev, timings);\r\nif (r) {\r\nDSSERR("Timing cannot be applied\n");\r\ngoto err;\r\n}\r\nerr:\r\nmutex_unlock(&hdmi.hdmi_lock);\r\nreturn r;\r\n}\r\nint hdmi_panel_init(void)\r\n{\r\nmutex_init(&hdmi.hdmi_lock);\r\nomap_dss_register_driver(&hdmi_driver);\r\nreturn 0;\r\n}\r\nvoid hdmi_panel_exit(void)\r\n{\r\nomap_dss_unregister_driver(&hdmi_driver);\r\n}
