static int bcm63xx_config_init(struct phy_device *phydev)\r\n{\r\nint reg, err;\r\nreg = phy_read(phydev, MII_BCM63XX_IR);\r\nif (reg < 0)\r\nreturn reg;\r\nreg |= MII_BCM63XX_IR_GMASK;\r\nerr = phy_write(phydev, MII_BCM63XX_IR, reg);\r\nif (err < 0)\r\nreturn err;\r\nreg = ~(MII_BCM63XX_IR_DUPLEX |\r\nMII_BCM63XX_IR_SPEED |\r\nMII_BCM63XX_IR_LINK) |\r\nMII_BCM63XX_IR_EN;\r\nerr = phy_write(phydev, MII_BCM63XX_IR, reg);\r\nif (err < 0)\r\nreturn err;\r\nreturn 0;\r\n}\r\nstatic int bcm63xx_ack_interrupt(struct phy_device *phydev)\r\n{\r\nint reg;\r\nreg = phy_read(phydev, MII_BCM63XX_IR);\r\nif (reg < 0)\r\nreturn reg;\r\nreturn 0;\r\n}\r\nstatic int bcm63xx_config_intr(struct phy_device *phydev)\r\n{\r\nint reg, err;\r\nreg = phy_read(phydev, MII_BCM63XX_IR);\r\nif (reg < 0)\r\nreturn reg;\r\nif (phydev->interrupts == PHY_INTERRUPT_ENABLED)\r\nreg &= ~MII_BCM63XX_IR_GMASK;\r\nelse\r\nreg |= MII_BCM63XX_IR_GMASK;\r\nerr = phy_write(phydev, MII_BCM63XX_IR, reg);\r\nreturn err;\r\n}\r\nstatic int __init bcm63xx_phy_init(void)\r\n{\r\nint ret;\r\nret = phy_driver_register(&bcm63xx_1_driver);\r\nif (ret)\r\ngoto out_63xx_1;\r\nret = phy_driver_register(&bcm63xx_2_driver);\r\nif (ret)\r\ngoto out_63xx_2;\r\nreturn ret;\r\nout_63xx_2:\r\nphy_driver_unregister(&bcm63xx_1_driver);\r\nout_63xx_1:\r\nreturn ret;\r\n}\r\nstatic void __exit bcm63xx_phy_exit(void)\r\n{\r\nphy_driver_unregister(&bcm63xx_1_driver);\r\nphy_driver_unregister(&bcm63xx_2_driver);\r\n}
