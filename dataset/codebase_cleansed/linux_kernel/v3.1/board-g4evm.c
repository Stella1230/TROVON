static void usb_host_port_power(int port, int power)\r\n{\r\nif (!power)\r\nreturn;\r\n__raw_writew(__raw_readw(0xe6890008) | 0x600, 0xe6890008);\r\n}\r\nstatic void __init g4evm_map_io(void)\r\n{\r\niotable_init(g4evm_io_desc, ARRAY_SIZE(g4evm_io_desc));\r\nsh7377_add_early_devices();\r\nshmobile_setup_console();\r\n}\r\nstatic void __init gpio_pull_up(u32 addr)\r\n{\r\nu8 data = __raw_readb(addr);\r\ndata &= 0x0F;\r\ndata |= 0xC0;\r\n__raw_writeb(data, addr);\r\n}\r\nstatic void __init g4evm_init(void)\r\n{\r\nsh7377_pinmux_init();\r\ngpio_request(GPIO_PORT109, NULL);\r\ngpio_direction_output(GPIO_PORT109, 1);\r\ngpio_export(GPIO_PORT109, 1);\r\ngpio_request(GPIO_PORT110, NULL);\r\ngpio_direction_output(GPIO_PORT110, 1);\r\ngpio_export(GPIO_PORT110, 1);\r\ngpio_request(GPIO_PORT112, NULL);\r\ngpio_direction_output(GPIO_PORT112, 1);\r\ngpio_export(GPIO_PORT112, 1);\r\ngpio_request(GPIO_PORT113, NULL);\r\ngpio_direction_output(GPIO_PORT113, 1);\r\ngpio_export(GPIO_PORT113, 1);\r\ngpio_request(GPIO_FN_VBUS_0, NULL);\r\ngpio_request(GPIO_FN_PWEN, NULL);\r\ngpio_request(GPIO_FN_OVCN, NULL);\r\ngpio_request(GPIO_FN_OVCN2, NULL);\r\ngpio_request(GPIO_FN_EXTLP, NULL);\r\ngpio_request(GPIO_FN_IDIN, NULL);\r\n__raw_writew(0x0200, 0xe605810a);\r\n__raw_writew(0x00e0, 0xe60581c0);\r\n__raw_writew(0x6010, 0xe60581c6);\r\n__raw_writew(0x8a0a, 0xe605810c);\r\ngpio_request(GPIO_FN_PORT60_KEYOUT5, NULL);\r\ngpio_request(GPIO_FN_PORT61_KEYOUT4, NULL);\r\ngpio_request(GPIO_FN_PORT62_KEYOUT3, NULL);\r\ngpio_request(GPIO_FN_PORT63_KEYOUT2, NULL);\r\ngpio_request(GPIO_FN_PORT64_KEYOUT1, NULL);\r\ngpio_request(GPIO_FN_PORT65_KEYOUT0, NULL);\r\ngpio_request(GPIO_FN_PORT66_KEYIN0_PU, NULL);\r\ngpio_request(GPIO_FN_PORT67_KEYIN1_PU, NULL);\r\ngpio_request(GPIO_FN_PORT68_KEYIN2_PU, NULL);\r\ngpio_request(GPIO_FN_PORT69_KEYIN3_PU, NULL);\r\ngpio_request(GPIO_FN_PORT70_KEYIN4_PU, NULL);\r\ngpio_request(GPIO_FN_PORT71_KEYIN5_PU, NULL);\r\ngpio_request(GPIO_FN_PORT72_KEYIN6_PU, NULL);\r\ngpio_request(GPIO_FN_SDHICLK0, NULL);\r\ngpio_request(GPIO_FN_SDHICD0, NULL);\r\ngpio_request(GPIO_FN_SDHID0_0, NULL);\r\ngpio_request(GPIO_FN_SDHID0_1, NULL);\r\ngpio_request(GPIO_FN_SDHID0_2, NULL);\r\ngpio_request(GPIO_FN_SDHID0_3, NULL);\r\ngpio_request(GPIO_FN_SDHICMD0, NULL);\r\ngpio_request(GPIO_FN_SDHIWP0, NULL);\r\ngpio_pull_up(GPIO_SDHID0_D0);\r\ngpio_pull_up(GPIO_SDHID0_D1);\r\ngpio_pull_up(GPIO_SDHID0_D2);\r\ngpio_pull_up(GPIO_SDHID0_D3);\r\ngpio_pull_up(GPIO_SDHICMD0);\r\ngpio_request(GPIO_FN_SDHICLK1, NULL);\r\ngpio_request(GPIO_FN_SDHID1_0, NULL);\r\ngpio_request(GPIO_FN_SDHID1_1, NULL);\r\ngpio_request(GPIO_FN_SDHID1_2, NULL);\r\ngpio_request(GPIO_FN_SDHID1_3, NULL);\r\ngpio_request(GPIO_FN_SDHICMD1, NULL);\r\ngpio_pull_up(GPIO_SDHID1_D0);\r\ngpio_pull_up(GPIO_SDHID1_D1);\r\ngpio_pull_up(GPIO_SDHID1_D2);\r\ngpio_pull_up(GPIO_SDHID1_D3);\r\ngpio_pull_up(GPIO_SDHICMD1);\r\nsh7377_add_standard_devices();\r\nplatform_add_devices(g4evm_devices, ARRAY_SIZE(g4evm_devices));\r\n}\r\nstatic void __init g4evm_timer_init(void)\r\n{\r\nsh7377_clock_init();\r\nshmobile_timer.init();\r\n}
