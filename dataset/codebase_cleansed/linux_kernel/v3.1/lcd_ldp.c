static int ldp_panel_init(struct lcd_panel *panel,\r\nstruct omapfb_device *fbdev)\r\n{\r\ngpio_request(LCD_PANEL_RESET_GPIO, "lcd reset");\r\ngpio_request(LCD_PANEL_QVGA_GPIO, "lcd qvga");\r\ngpio_request(LCD_PANEL_ENABLE_GPIO, "lcd panel");\r\ngpio_request(LCD_PANEL_BACKLIGHT_GPIO, "lcd backlight");\r\ngpio_direction_output(LCD_PANEL_QVGA_GPIO, 0);\r\ngpio_direction_output(LCD_PANEL_RESET_GPIO, 0);\r\ngpio_direction_output(LCD_PANEL_ENABLE_GPIO, 0);\r\ngpio_direction_output(LCD_PANEL_BACKLIGHT_GPIO, 0);\r\n#ifdef CONFIG_FB_OMAP_LCD_VGA\r\ngpio_set_value(LCD_PANEL_QVGA_GPIO, 0);\r\n#else\r\ngpio_set_value(LCD_PANEL_QVGA_GPIO, 1);\r\n#endif\r\ngpio_set_value(LCD_PANEL_RESET_GPIO, 1);\r\nreturn 0;\r\n}\r\nstatic void ldp_panel_cleanup(struct lcd_panel *panel)\r\n{\r\ngpio_free(LCD_PANEL_BACKLIGHT_GPIO);\r\ngpio_free(LCD_PANEL_ENABLE_GPIO);\r\ngpio_free(LCD_PANEL_QVGA_GPIO);\r\ngpio_free(LCD_PANEL_RESET_GPIO);\r\n}\r\nstatic int ldp_panel_enable(struct lcd_panel *panel)\r\n{\r\nif (0 != t2_out(PM_RECEIVER, ENABLE_VPLL2_DEDICATED,\r\nTWL4030_VPLL2_DEDICATED))\r\nreturn -EIO;\r\nif (0 != t2_out(PM_RECEIVER, ENABLE_VPLL2_DEV_GRP,\r\nTWL4030_VPLL2_DEV_GRP))\r\nreturn -EIO;\r\ngpio_direction_output(LCD_PANEL_ENABLE_GPIO, 1);\r\ngpio_direction_output(LCD_PANEL_BACKLIGHT_GPIO, 1);\r\nif (0 != t2_out(PM_RECEIVER, ENABLE_VAUX3_DEDICATED,\r\nTWL4030_VAUX3_DEDICATED))\r\nreturn -EIO;\r\nif (0 != t2_out(PM_RECEIVER, ENABLE_VAUX3_DEV_GRP,\r\nTWL4030_VAUX3_DEV_GRP))\r\nreturn -EIO;\r\nreturn 0;\r\n}\r\nstatic void ldp_panel_disable(struct lcd_panel *panel)\r\n{\r\ngpio_direction_output(LCD_PANEL_ENABLE_GPIO, 0);\r\ngpio_direction_output(LCD_PANEL_BACKLIGHT_GPIO, 0);\r\nt2_out(PM_RECEIVER, 0x0, TWL4030_VPLL2_DEDICATED);\r\nt2_out(PM_RECEIVER, 0x0, TWL4030_VPLL2_DEV_GRP);\r\nmsleep(4);\r\n}\r\nstatic unsigned long ldp_panel_get_caps(struct lcd_panel *panel)\r\n{\r\nreturn 0;\r\n}\r\nstatic int ldp_panel_probe(struct platform_device *pdev)\r\n{\r\nomapfb_register_panel(&ldp_panel);\r\nreturn 0;\r\n}\r\nstatic int ldp_panel_remove(struct platform_device *pdev)\r\n{\r\nreturn 0;\r\n}\r\nstatic int ldp_panel_suspend(struct platform_device *pdev, pm_message_t mesg)\r\n{\r\nreturn 0;\r\n}\r\nstatic int ldp_panel_resume(struct platform_device *pdev)\r\n{\r\nreturn 0;\r\n}\r\nstatic int __init ldp_panel_drv_init(void)\r\n{\r\nreturn platform_driver_register(&ldp_panel_driver);\r\n}\r\nstatic void __exit ldp_panel_drv_exit(void)\r\n{\r\nplatform_driver_unregister(&ldp_panel_driver);\r\n}
