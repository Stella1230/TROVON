static long jdo_fork(unsigned long clone_flags, unsigned long stack_start,\r\nstruct pt_regs *regs, unsigned long stack_size,\r\nint __user *parent_tidptr, int __user *child_tidptr)\r\n{\r\nprintk(KERN_INFO "jprobe: clone_flags = 0x%lx, stack_size = 0x%lx,"\r\n" regs = 0x%p\n",\r\nclone_flags, stack_size, regs);\r\njprobe_return();\r\nreturn 0;\r\n}\r\nstatic int __init jprobe_init(void)\r\n{\r\nint ret;\r\nret = register_jprobe(&my_jprobe);\r\nif (ret < 0) {\r\nprintk(KERN_INFO "register_jprobe failed, returned %d\n", ret);\r\nreturn -1;\r\n}\r\nprintk(KERN_INFO "Planted jprobe at %p, handler addr %p\n",\r\nmy_jprobe.kp.addr, my_jprobe.entry);\r\nreturn 0;\r\n}\r\nstatic void __exit jprobe_exit(void)\r\n{\r\nunregister_jprobe(&my_jprobe);\r\nprintk(KERN_INFO "jprobe at %p unregistered\n", my_jprobe.kp.addr);\r\n}
