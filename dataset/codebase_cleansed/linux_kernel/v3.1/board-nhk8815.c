static int nhk8815_nand_init(void)\r\n{\r\nwritel(0x0000000E, FSMC_PCR(0));\r\nwritel(0x000D0A00, FSMC_PMEM(0));\r\nwritel(0x00100A00, FSMC_PATT(0));\r\nwritel(readl(FSMC_PCR(0)) | 0x04, FSMC_PCR(0));\r\nreturn 0;\r\n}\r\nstatic void __init nhk8815_onenand_init(void)\r\n{\r\n#ifdef CONFIG_MTD_ONENAND\r\nwritel(0x000030db, FSMC_BCR(0));\r\nwritel(0x02100551, FSMC_BTR(0));\r\n#endif\r\n}\r\nstatic int __init nhk8815_eth_init(void)\r\n{\r\nint gpio_nr = 115;\r\nint err;\r\nerr = gpio_request(gpio_nr, "eth_irq");\r\nif (!err) err = nmk_gpio_set_mode(gpio_nr, NMK_GPIO_ALT_GPIO);\r\nif (!err) err = gpio_direction_input(gpio_nr);\r\nif (err)\r\npr_err("Error %i in %s\n", err, __func__);\r\nreturn err;\r\n}\r\nstatic void __init nomadik_timer_init(void)\r\n{\r\nu32 src_cr;\r\nsrc_cr = readl(io_p2v(NOMADIK_SRC_BASE));\r\nsrc_cr &= SRC_CR_INIT_MASK;\r\nsrc_cr |= SRC_CR_INIT_VAL;\r\nwritel(src_cr, io_p2v(NOMADIK_SRC_BASE));\r\nmtu_base = io_p2v(NOMADIK_MTU0_BASE);\r\nnmdk_timer_init();\r\n}\r\nstatic void __init nhk8815_platform_init(void)\r\n{\r\nint i;\r\ncpu8815_platform_init();\r\nnhk8815_onenand_init();\r\nplatform_add_devices(nhk8815_platform_devices,\r\nARRAY_SIZE(nhk8815_platform_devices));\r\nfor (i = 0; i < ARRAY_SIZE(amba_devs); i++)\r\namba_device_register(amba_devs[i], &iomem_resource);\r\n}
