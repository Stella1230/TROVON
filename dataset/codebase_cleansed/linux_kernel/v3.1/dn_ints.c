void dn_process_int(unsigned int irq, struct pt_regs *fp)\r\n{\r\n__m68k_handle_int(irq, fp);\r\n*(volatile unsigned char *)(pica)=0x20;\r\n*(volatile unsigned char *)(picb)=0x20;\r\n}\r\nint apollo_irq_startup(unsigned int irq)\r\n{\r\nif (irq < 8)\r\n*(volatile unsigned char *)(pica+1) &= ~(1 << irq);\r\nelse\r\n*(volatile unsigned char *)(picb+1) &= ~(1 << (irq - 8));\r\nreturn 0;\r\n}\r\nvoid apollo_irq_shutdown(unsigned int irq)\r\n{\r\nif (irq < 8)\r\n*(volatile unsigned char *)(pica+1) |= (1 << irq);\r\nelse\r\n*(volatile unsigned char *)(picb+1) |= (1 << (irq - 8));\r\n}\r\nvoid __init dn_init_IRQ(void)\r\n{\r\nm68k_setup_user_interrupt(VEC_USER + 96, 16, dn_process_int);\r\nm68k_setup_irq_controller(&apollo_irq_controller, IRQ_APOLLO, 16);\r\n}
