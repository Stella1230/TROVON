int usb_stor_euscsi_init(struct us_data *us)\r\n{\r\nint result;\r\nUS_DEBUGP("Attempting to init eUSCSI bridge...\n");\r\nus->iobuf[0] = 0x1;\r\nresult = usb_stor_control_msg(us, us->send_ctrl_pipe,\r\n0x0C, USB_RECIP_INTERFACE | USB_TYPE_VENDOR,\r\n0x01, 0x0, us->iobuf, 0x1, 5000);\r\nUS_DEBUGP("-- result is %d\n", result);\r\nreturn 0;\r\n}\r\nint usb_stor_ucr61s2b_init(struct us_data *us)\r\n{\r\nstruct bulk_cb_wrap *bcb = (struct bulk_cb_wrap*) us->iobuf;\r\nstruct bulk_cs_wrap *bcs = (struct bulk_cs_wrap*) us->iobuf;\r\nint res;\r\nunsigned int partial;\r\nstatic char init_string[] = "\xec\x0a\x06\x00$PCCHIPS";\r\nUS_DEBUGP("Sending UCR-61S2B initialization packet...\n");\r\nbcb->Signature = cpu_to_le32(US_BULK_CB_SIGN);\r\nbcb->Tag = 0;\r\nbcb->DataTransferLength = cpu_to_le32(0);\r\nbcb->Flags = bcb->Lun = 0;\r\nbcb->Length = sizeof(init_string) - 1;\r\nmemset(bcb->CDB, 0, sizeof(bcb->CDB));\r\nmemcpy(bcb->CDB, init_string, sizeof(init_string) - 1);\r\nres = usb_stor_bulk_transfer_buf(us, us->send_bulk_pipe, bcb,\r\nUS_BULK_CB_WRAP_LEN, &partial);\r\nif (res)\r\nreturn -EIO;\r\nUS_DEBUGP("Getting status packet...\n");\r\nres = usb_stor_bulk_transfer_buf(us, us->recv_bulk_pipe, bcs,\r\nUS_BULK_CS_WRAP_LEN, &partial);\r\nif (res)\r\nreturn -EIO;\r\nreturn 0;\r\n}\r\nint usb_stor_huawei_e220_init(struct us_data *us)\r\n{\r\nint result;\r\nresult = usb_stor_control_msg(us, us->send_ctrl_pipe,\r\nUSB_REQ_SET_FEATURE,\r\nUSB_TYPE_STANDARD | USB_RECIP_DEVICE,\r\n0x01, 0x0, NULL, 0x0, 1000);\r\nUS_DEBUGP("Huawei mode set result is %d\n", result);\r\nreturn 0;\r\n}
