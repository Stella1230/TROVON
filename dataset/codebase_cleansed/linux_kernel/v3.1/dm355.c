void __init dm355_init_spi0(unsigned chipselect_mask,\r\nstruct spi_board_info *info, unsigned len)\r\n{\r\ndavinci_cfg_reg(DM355_SPI0_SDI);\r\nif (chipselect_mask & BIT(0))\r\ndavinci_cfg_reg(DM355_SPI0_SDENA0);\r\nif (chipselect_mask & BIT(1))\r\ndavinci_cfg_reg(DM355_SPI0_SDENA1);\r\nspi_register_board_info(info, len);\r\nplatform_device_register(&dm355_spi0_device);\r\n}\r\nstatic void dm355_ccdc_setup_pinmux(void)\r\n{\r\ndavinci_cfg_reg(DM355_VIN_PCLK);\r\ndavinci_cfg_reg(DM355_VIN_CAM_WEN);\r\ndavinci_cfg_reg(DM355_VIN_CAM_VD);\r\ndavinci_cfg_reg(DM355_VIN_CAM_HD);\r\ndavinci_cfg_reg(DM355_VIN_YIN_EN);\r\ndavinci_cfg_reg(DM355_VIN_CINL_EN);\r\ndavinci_cfg_reg(DM355_VIN_CINH_EN);\r\n}\r\nvoid dm355_set_vpfe_config(struct vpfe_config *cfg)\r\n{\r\nvpfe_capture_dev.dev.platform_data = cfg;\r\n}\r\nvoid __init dm355_init_asp1(u32 evt_enable, struct snd_platform_data *pdata)\r\n{\r\nif (evt_enable & ASP1_TX_EVT_EN)\r\ndavinci_cfg_reg(DM355_EVT8_ASP1_TX);\r\nif (evt_enable & ASP1_RX_EVT_EN)\r\ndavinci_cfg_reg(DM355_EVT9_ASP1_RX);\r\ndm355_asp1_device.dev.platform_data = pdata;\r\nplatform_device_register(&dm355_asp1_device);\r\n}\r\nvoid __init dm355_init(void)\r\n{\r\ndavinci_common_init(&davinci_soc_info_dm355);\r\n}\r\nstatic int __init dm355_init_devices(void)\r\n{\r\nif (!cpu_is_davinci_dm355())\r\nreturn 0;\r\nclk_add_alias("master", dm355_ccdc_dev.name, "vpss_master", NULL);\r\nclk_add_alias("slave", dm355_ccdc_dev.name, "vpss_master", NULL);\r\ndavinci_cfg_reg(DM355_INT_EDMA_CC);\r\nplatform_device_register(&dm355_edma_device);\r\nplatform_device_register(&dm355_vpss_device);\r\nplatform_device_register(&dm355_ccdc_dev);\r\nplatform_device_register(&vpfe_capture_dev);\r\nreturn 0;\r\n}
