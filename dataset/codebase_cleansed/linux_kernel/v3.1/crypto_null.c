static int null_compress(struct crypto_tfm *tfm, const u8 *src,\r\nunsigned int slen, u8 *dst, unsigned int *dlen)\r\n{\r\nif (slen > *dlen)\r\nreturn -EINVAL;\r\nmemcpy(dst, src, slen);\r\n*dlen = slen;\r\nreturn 0;\r\n}\r\nstatic int null_init(struct shash_desc *desc)\r\n{\r\nreturn 0;\r\n}\r\nstatic int null_update(struct shash_desc *desc, const u8 *data,\r\nunsigned int len)\r\n{\r\nreturn 0;\r\n}\r\nstatic int null_final(struct shash_desc *desc, u8 *out)\r\n{\r\nreturn 0;\r\n}\r\nstatic int null_digest(struct shash_desc *desc, const u8 *data,\r\nunsigned int len, u8 *out)\r\n{\r\nreturn 0;\r\n}\r\nstatic int null_hash_setkey(struct crypto_shash *tfm, const u8 *key,\r\nunsigned int keylen)\r\n{ return 0; }\r\nstatic int null_setkey(struct crypto_tfm *tfm, const u8 *key,\r\nunsigned int keylen)\r\n{ return 0; }\r\nstatic void null_crypt(struct crypto_tfm *tfm, u8 *dst, const u8 *src)\r\n{\r\nmemcpy(dst, src, NULL_BLOCK_SIZE);\r\n}\r\nstatic int skcipher_null_crypt(struct blkcipher_desc *desc,\r\nstruct scatterlist *dst,\r\nstruct scatterlist *src, unsigned int nbytes)\r\n{\r\nstruct blkcipher_walk walk;\r\nint err;\r\nblkcipher_walk_init(&walk, dst, src, nbytes);\r\nerr = blkcipher_walk_virt(desc, &walk);\r\nwhile (walk.nbytes) {\r\nif (walk.src.virt.addr != walk.dst.virt.addr)\r\nmemcpy(walk.dst.virt.addr, walk.src.virt.addr,\r\nwalk.nbytes);\r\nerr = blkcipher_walk_done(desc, &walk, 0);\r\n}\r\nreturn err;\r\n}\r\nstatic int __init crypto_null_mod_init(void)\r\n{\r\nint ret = 0;\r\nret = crypto_register_alg(&cipher_null);\r\nif (ret < 0)\r\ngoto out;\r\nret = crypto_register_alg(&skcipher_null);\r\nif (ret < 0)\r\ngoto out_unregister_cipher;\r\nret = crypto_register_shash(&digest_null);\r\nif (ret < 0)\r\ngoto out_unregister_skcipher;\r\nret = crypto_register_alg(&compress_null);\r\nif (ret < 0)\r\ngoto out_unregister_digest;\r\nout:\r\nreturn ret;\r\nout_unregister_digest:\r\ncrypto_unregister_shash(&digest_null);\r\nout_unregister_skcipher:\r\ncrypto_unregister_alg(&skcipher_null);\r\nout_unregister_cipher:\r\ncrypto_unregister_alg(&cipher_null);\r\ngoto out;\r\n}\r\nstatic void __exit crypto_null_mod_fini(void)\r\n{\r\ncrypto_unregister_alg(&compress_null);\r\ncrypto_unregister_shash(&digest_null);\r\ncrypto_unregister_alg(&skcipher_null);\r\ncrypto_unregister_alg(&cipher_null);\r\n}
