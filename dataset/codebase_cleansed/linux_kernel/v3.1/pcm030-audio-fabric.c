static __init int pcm030_fabric_init(void)\r\n{\r\nstruct platform_device *pdev;\r\nint rc;\r\nif (!of_machine_is_compatible("phytec,pcm030"))\r\nreturn -ENODEV;\r\ncard.name = "pcm030";\r\ncard.dai_link = pcm030_fabric_dai;\r\ncard.num_links = ARRAY_SIZE(pcm030_fabric_dai);\r\npdev = platform_device_alloc("soc-audio", 1);\r\nif (!pdev) {\r\npr_err("pcm030_fabric_init: platform_device_alloc() failed\n");\r\nreturn -ENODEV;\r\n}\r\nplatform_set_drvdata(pdev, &card);\r\nrc = platform_device_add(pdev);\r\nif (rc) {\r\npr_err("pcm030_fabric_init: platform_device_add() failed\n");\r\nplatform_device_put(pdev);\r\nreturn -ENODEV;\r\n}\r\nreturn 0;\r\n}
