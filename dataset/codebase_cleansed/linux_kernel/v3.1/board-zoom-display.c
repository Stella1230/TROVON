static void __init zoom_lcd_panel_init(void)\r\n{\r\nzoom_lcd_gpios[0].gpio = (omap_rev() > OMAP3430_REV_ES3_0) ?\r\nLCD_PANEL_RESET_GPIO_PROD :\r\nLCD_PANEL_RESET_GPIO_PILOT;\r\nif (gpio_request_array(zoom_lcd_gpios, ARRAY_SIZE(zoom_lcd_gpios)))\r\npr_err("%s: Failed to get LCD GPIOs.\n", __func__);\r\n}\r\nstatic int zoom_panel_enable_lcd(struct omap_dss_device *dssdev)\r\n{\r\nreturn 0;\r\n}\r\nstatic void zoom_panel_disable_lcd(struct omap_dss_device *dssdev)\r\n{\r\n}\r\nstatic int zoom_set_bl_intensity(struct omap_dss_device *dssdev, int level)\r\n{\r\nunsigned char c;\r\nu8 mux_pwm, enb_pwm;\r\nif (level > 100)\r\nreturn -1;\r\ntwl_i2c_read_u8(TWL4030_MODULE_INTBR, &mux_pwm, TWL_INTBR_PMBR1);\r\ntwl_i2c_read_u8(TWL4030_MODULE_INTBR, &enb_pwm, TWL_INTBR_GPBR1);\r\nif (level == 0) {\r\nenb_pwm = enb_pwm & 0xF5;\r\nmux_pwm = mux_pwm & 0xCF;\r\ntwl_i2c_write_u8(TWL4030_MODULE_INTBR,\r\nenb_pwm, TWL_INTBR_GPBR1);\r\ntwl_i2c_write_u8(TWL4030_MODULE_INTBR,\r\nmux_pwm, TWL_INTBR_PMBR1);\r\nreturn 0;\r\n}\r\nif (!((enb_pwm & 0xA) && (mux_pwm & 0x30))) {\r\nmux_pwm = mux_pwm | 0x30;\r\nenb_pwm = enb_pwm | 0x0A;\r\ntwl_i2c_write_u8(TWL4030_MODULE_INTBR,\r\nmux_pwm, TWL_INTBR_PMBR1);\r\ntwl_i2c_write_u8(TWL4030_MODULE_INTBR,\r\nenb_pwm, TWL_INTBR_GPBR1);\r\n}\r\nc = ((50 * (100 - level)) / 100) + 1;\r\ntwl_i2c_write_u8(TWL4030_MODULE_PWM1, 0x7F, TWL_LED_PWMOFF);\r\ntwl_i2c_write_u8(TWL4030_MODULE_PWM1, c, TWL_LED_PWMON);\r\nreturn 0;\r\n}\r\nvoid __init zoom_display_init(void)\r\n{\r\nomap_display_init(&zoom_dss_data);\r\nspi_register_board_info(nec_8048_spi_board_info,\r\nARRAY_SIZE(nec_8048_spi_board_info));\r\nzoom_lcd_panel_init();\r\n}
