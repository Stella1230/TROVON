static int sis_driver_load(struct drm_device *dev, unsigned long chipset)\r\n{\r\ndrm_sis_private_t *dev_priv;\r\nint ret;\r\ndev_priv = kzalloc(sizeof(drm_sis_private_t), GFP_KERNEL);\r\nif (dev_priv == NULL)\r\nreturn -ENOMEM;\r\ndev->dev_private = (void *)dev_priv;\r\ndev_priv->chipset = chipset;\r\nret = drm_sman_init(&dev_priv->sman, 2, 12, 8);\r\nif (ret)\r\nkfree(dev_priv);\r\nreturn ret;\r\n}\r\nstatic int sis_driver_unload(struct drm_device *dev)\r\n{\r\ndrm_sis_private_t *dev_priv = dev->dev_private;\r\ndrm_sman_takedown(&dev_priv->sman);\r\nkfree(dev_priv);\r\nreturn 0;\r\n}\r\nstatic int __init sis_init(void)\r\n{\r\ndriver.num_ioctls = sis_max_ioctl;\r\nreturn drm_pci_init(&driver, &sis_pci_driver);\r\n}\r\nstatic void __exit sis_exit(void)\r\n{\r\ndrm_pci_exit(&driver, &sis_pci_driver);\r\n}
