static void platform_fixups(void)\r\n{\r\nvoid *node;\r\ndt_fixup_memory(bd.bi_memstart, bd.bi_memsize);\r\ndt_fixup_mac_addresses(bd.bi_enetaddr, bd.bi_enet1addr);\r\ndt_fixup_cpu_clocks(bd.bi_intfreq, bd.bi_busfreq / 16, bd.bi_busfreq);\r\nnode = finddevice("/soc/cpm");\r\nif (node)\r\nsetprop(node, "clock-frequency", &bd.bi_busfreq, 4);\r\nnode = finddevice("/soc/cpm/brg");\r\nif (node)\r\nsetprop(node, "clock-frequency", &bd.bi_busfreq, 4);\r\n}\r\nvoid platform_init(unsigned long r3, unsigned long r4, unsigned long r5,\r\nunsigned long r6, unsigned long r7)\r\n{\r\nCUBOOT_INIT();\r\nfdt_init(_dtb_start);\r\nserial_console_init();\r\nplatform_ops.fixups = platform_fixups;\r\n}
