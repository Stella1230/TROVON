static __u8 *pl_report_fixup(struct hid_device *hdev, __u8 *rdesc,\r\nunsigned int *rsize)\r\n{\r\nif (*rsize >= 60 && rdesc[39] == 0x2a && rdesc[40] == 0xf5 &&\r\nrdesc[41] == 0x00 && rdesc[59] == 0x26 &&\r\nrdesc[60] == 0xf9 && rdesc[61] == 0x00) {\r\nhid_info(hdev, "fixing up Petalynx Maxter Remote report descriptor\n");\r\nrdesc[60] = 0xfa;\r\nrdesc[40] = 0xfa;\r\n}\r\nreturn rdesc;\r\n}\r\nstatic int pl_input_mapping(struct hid_device *hdev, struct hid_input *hi,\r\nstruct hid_field *field, struct hid_usage *usage,\r\nunsigned long **bit, int *max)\r\n{\r\nif ((usage->hid & HID_USAGE_PAGE) == HID_UP_LOGIVENDOR) {\r\nswitch (usage->hid & HID_USAGE) {\r\ncase 0x05a: pl_map_key_clear(KEY_TEXT); break;\r\ncase 0x05b: pl_map_key_clear(KEY_RED); break;\r\ncase 0x05c: pl_map_key_clear(KEY_GREEN); break;\r\ncase 0x05d: pl_map_key_clear(KEY_YELLOW); break;\r\ncase 0x05e: pl_map_key_clear(KEY_BLUE); break;\r\ndefault:\r\nreturn 0;\r\n}\r\nreturn 1;\r\n}\r\nif ((usage->hid & HID_USAGE_PAGE) == HID_UP_CONSUMER) {\r\nswitch (usage->hid & HID_USAGE) {\r\ncase 0x0f6: pl_map_key_clear(KEY_NEXT); break;\r\ncase 0x0fa: pl_map_key_clear(KEY_BACK); break;\r\ndefault:\r\nreturn 0;\r\n}\r\nreturn 1;\r\n}\r\nreturn 0;\r\n}\r\nstatic int pl_probe(struct hid_device *hdev, const struct hid_device_id *id)\r\n{\r\nint ret;\r\nhdev->quirks |= HID_QUIRK_NOGET;\r\nret = hid_parse(hdev);\r\nif (ret) {\r\nhid_err(hdev, "parse failed\n");\r\ngoto err_free;\r\n}\r\nret = hid_hw_start(hdev, HID_CONNECT_DEFAULT);\r\nif (ret) {\r\nhid_err(hdev, "hw start failed\n");\r\ngoto err_free;\r\n}\r\nreturn 0;\r\nerr_free:\r\nreturn ret;\r\n}
