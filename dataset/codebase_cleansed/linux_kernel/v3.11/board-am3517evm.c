static void __init am3517_evm_rtc_init(void)\r\n{\r\nint r;\r\nomap_mux_init_gpio(GPIO_RTCS35390A_IRQ, OMAP_PIN_INPUT_PULLUP);\r\nr = gpio_request_one(GPIO_RTCS35390A_IRQ, GPIOF_IN, "rtcs35390a-irq");\r\nif (r < 0) {\r\nprintk(KERN_WARNING "failed to request GPIO#%d\n",\r\nGPIO_RTCS35390A_IRQ);\r\nreturn;\r\n}\r\nam3517evm_i2c1_boardinfo[0].irq = gpio_to_irq(GPIO_RTCS35390A_IRQ);\r\n}\r\nstatic int __init am3517_evm_i2c_init(void)\r\n{\r\nomap_register_i2c_bus(1, 400, NULL, 0);\r\nomap_register_i2c_bus(2, 400, am3517evm_i2c2_boardinfo,\r\nARRAY_SIZE(am3517evm_i2c2_boardinfo));\r\nomap_register_i2c_bus(3, 400, am3517evm_i2c3_boardinfo,\r\nARRAY_SIZE(am3517evm_i2c3_boardinfo));\r\nreturn 0;\r\n}\r\nstatic __init void am3517_evm_musb_init(void)\r\n{\r\nu32 devconf2;\r\ndevconf2 = omap_ctrl_readl(AM35XX_CONTROL_DEVCONF2);\r\ndevconf2 &= ~(CONF2_REFFREQ | CONF2_OTGMODE | CONF2_PHY_GPIOMODE);\r\ndevconf2 |= CONF2_REFFREQ_13MHZ | CONF2_SESENDEN | CONF2_VBDTCTEN\r\n| CONF2_DATPOL;\r\nomap_ctrl_writel(devconf2, AM35XX_CONTROL_DEVCONF2);\r\nusb_musb_init(&musb_board_data);\r\n}\r\nstatic __init void am3517_evm_mcbsp1_init(void)\r\n{\r\nu32 devconf0;\r\ndevconf0 = omap_ctrl_readl(OMAP2_CONTROL_DEVCONF0);\r\ndevconf0 |= OMAP2_MCBSP1_CLKR_MASK | OMAP2_MCBSP1_FSR_MASK;\r\nomap_ctrl_writel(devconf0, OMAP2_CONTROL_DEVCONF0);\r\n}\r\nstatic void am3517_evm_hecc_init(struct ti_hecc_platform_data *pdata)\r\n{\r\nam3517_hecc_device.dev.platform_data = pdata;\r\nplatform_device_register(&am3517_hecc_device);\r\n}\r\nstatic void __init am3517_evm_init(void)\r\n{\r\nomap3_mux_init(board_mux, OMAP_PACKAGE_CBB);\r\nam3517_evm_i2c_init();\r\nomap_display_init(&am3517_evm_dss_data);\r\nomap_serial_init();\r\nomap_sdrc_init(NULL, NULL);\r\nomap_mux_init_gpio(57, OMAP_PIN_OUTPUT);\r\nusbhs_init_phys(phy_data, ARRAY_SIZE(phy_data));\r\nusbhs_init(&usbhs_bdata);\r\nam3517_evm_hecc_init(&am3517_evm_hecc_pdata);\r\nam3517_evm_rtc_init();\r\ni2c_register_board_info(1, am3517evm_i2c1_boardinfo,\r\nARRAY_SIZE(am3517evm_i2c1_boardinfo));\r\nam35xx_emac_init(AM35XX_DEFAULT_MDIO_FREQUENCY, 1);\r\nam3517_evm_musb_init();\r\nam3517_evm_mcbsp1_init();\r\nomap_hsmmc_init(mmc);\r\n}
