static ssize_t iscsi_stat_instance_show_attr_inst(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = container_of(igrps,\r\nstruct iscsi_tiqn, tiqn_stat_grps);\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", tiqn->tiqn_index);\r\n}\r\nstatic ssize_t iscsi_stat_instance_show_attr_min_ver(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", ISCSI_DRAFT20_VERSION);\r\n}\r\nstatic ssize_t iscsi_stat_instance_show_attr_max_ver(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", ISCSI_DRAFT20_VERSION);\r\n}\r\nstatic ssize_t iscsi_stat_instance_show_attr_portals(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = container_of(igrps,\r\nstruct iscsi_tiqn, tiqn_stat_grps);\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", tiqn->tiqn_num_tpg_nps);\r\n}\r\nstatic ssize_t iscsi_stat_instance_show_attr_nodes(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", ISCSI_INST_NUM_NODES);\r\n}\r\nstatic ssize_t iscsi_stat_instance_show_attr_sessions(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = container_of(igrps,\r\nstruct iscsi_tiqn, tiqn_stat_grps);\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", tiqn->tiqn_nsessions);\r\n}\r\nstatic ssize_t iscsi_stat_instance_show_attr_fail_sess(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = container_of(igrps,\r\nstruct iscsi_tiqn, tiqn_stat_grps);\r\nstruct iscsi_sess_err_stats *sess_err = &tiqn->sess_err_stats;\r\nu32 sess_err_count;\r\nspin_lock_bh(&sess_err->lock);\r\nsess_err_count = (sess_err->digest_errors +\r\nsess_err->cxn_timeout_errors +\r\nsess_err->pdu_format_errors);\r\nspin_unlock_bh(&sess_err->lock);\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", sess_err_count);\r\n}\r\nstatic ssize_t iscsi_stat_instance_show_attr_fail_type(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = container_of(igrps,\r\nstruct iscsi_tiqn, tiqn_stat_grps);\r\nstruct iscsi_sess_err_stats *sess_err = &tiqn->sess_err_stats;\r\nreturn snprintf(page, PAGE_SIZE, "%u\n",\r\nsess_err->last_sess_failure_type);\r\n}\r\nstatic ssize_t iscsi_stat_instance_show_attr_fail_rem_name(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = container_of(igrps,\r\nstruct iscsi_tiqn, tiqn_stat_grps);\r\nstruct iscsi_sess_err_stats *sess_err = &tiqn->sess_err_stats;\r\nreturn snprintf(page, PAGE_SIZE, "%s\n",\r\nsess_err->last_sess_fail_rem_name[0] ?\r\nsess_err->last_sess_fail_rem_name : NONE);\r\n}\r\nstatic ssize_t iscsi_stat_instance_show_attr_disc_time(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", ISCSI_DISCONTINUITY_TIME);\r\n}\r\nstatic ssize_t iscsi_stat_instance_show_attr_description(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nreturn snprintf(page, PAGE_SIZE, "%s\n", ISCSI_INST_DESCR);\r\n}\r\nstatic ssize_t iscsi_stat_instance_show_attr_vendor(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nreturn snprintf(page, PAGE_SIZE, "RisingTide Systems iSCSI-Target\n");\r\n}\r\nstatic ssize_t iscsi_stat_instance_show_attr_version(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nreturn snprintf(page, PAGE_SIZE, "%s\n", ISCSIT_VERSION);\r\n}\r\nstatic ssize_t iscsi_stat_sess_err_show_attr_inst(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = container_of(igrps,\r\nstruct iscsi_tiqn, tiqn_stat_grps);\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", tiqn->tiqn_index);\r\n}\r\nstatic ssize_t iscsi_stat_sess_err_show_attr_digest_errors(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = container_of(igrps,\r\nstruct iscsi_tiqn, tiqn_stat_grps);\r\nstruct iscsi_sess_err_stats *sess_err = &tiqn->sess_err_stats;\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", sess_err->digest_errors);\r\n}\r\nstatic ssize_t iscsi_stat_sess_err_show_attr_cxn_errors(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = container_of(igrps,\r\nstruct iscsi_tiqn, tiqn_stat_grps);\r\nstruct iscsi_sess_err_stats *sess_err = &tiqn->sess_err_stats;\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", sess_err->cxn_timeout_errors);\r\n}\r\nstatic ssize_t iscsi_stat_sess_err_show_attr_format_errors(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = container_of(igrps,\r\nstruct iscsi_tiqn, tiqn_stat_grps);\r\nstruct iscsi_sess_err_stats *sess_err = &tiqn->sess_err_stats;\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", sess_err->pdu_format_errors);\r\n}\r\nstatic ssize_t iscsi_stat_tgt_attr_show_attr_inst(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = container_of(igrps,\r\nstruct iscsi_tiqn, tiqn_stat_grps);\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", tiqn->tiqn_index);\r\n}\r\nstatic ssize_t iscsi_stat_tgt_attr_show_attr_indx(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", ISCSI_NODE_INDEX);\r\n}\r\nstatic ssize_t iscsi_stat_tgt_attr_show_attr_login_fails(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = container_of(igrps,\r\nstruct iscsi_tiqn, tiqn_stat_grps);\r\nstruct iscsi_login_stats *lstat = &tiqn->login_stats;\r\nu32 fail_count;\r\nspin_lock(&lstat->lock);\r\nfail_count = (lstat->redirects + lstat->authorize_fails +\r\nlstat->authenticate_fails + lstat->negotiate_fails +\r\nlstat->other_fails);\r\nspin_unlock(&lstat->lock);\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", fail_count);\r\n}\r\nstatic ssize_t iscsi_stat_tgt_attr_show_attr_last_fail_time(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = container_of(igrps,\r\nstruct iscsi_tiqn, tiqn_stat_grps);\r\nstruct iscsi_login_stats *lstat = &tiqn->login_stats;\r\nu32 last_fail_time;\r\nspin_lock(&lstat->lock);\r\nlast_fail_time = lstat->last_fail_time ?\r\n(u32)(((u32)lstat->last_fail_time -\r\nINITIAL_JIFFIES) * 100 / HZ) : 0;\r\nspin_unlock(&lstat->lock);\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", last_fail_time);\r\n}\r\nstatic ssize_t iscsi_stat_tgt_attr_show_attr_last_fail_type(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = container_of(igrps,\r\nstruct iscsi_tiqn, tiqn_stat_grps);\r\nstruct iscsi_login_stats *lstat = &tiqn->login_stats;\r\nu32 last_fail_type;\r\nspin_lock(&lstat->lock);\r\nlast_fail_type = lstat->last_fail_type;\r\nspin_unlock(&lstat->lock);\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", last_fail_type);\r\n}\r\nstatic ssize_t iscsi_stat_tgt_attr_show_attr_fail_intr_name(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = container_of(igrps,\r\nstruct iscsi_tiqn, tiqn_stat_grps);\r\nstruct iscsi_login_stats *lstat = &tiqn->login_stats;\r\nunsigned char buf[224];\r\nspin_lock(&lstat->lock);\r\nsnprintf(buf, 224, "%s", lstat->last_intr_fail_name[0] ?\r\nlstat->last_intr_fail_name : NONE);\r\nspin_unlock(&lstat->lock);\r\nreturn snprintf(page, PAGE_SIZE, "%s\n", buf);\r\n}\r\nstatic ssize_t iscsi_stat_tgt_attr_show_attr_fail_intr_addr_type(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = container_of(igrps,\r\nstruct iscsi_tiqn, tiqn_stat_grps);\r\nstruct iscsi_login_stats *lstat = &tiqn->login_stats;\r\nint ret;\r\nspin_lock(&lstat->lock);\r\nif (lstat->last_intr_fail_ip_family == AF_INET6)\r\nret = snprintf(page, PAGE_SIZE, "ipv6\n");\r\nelse\r\nret = snprintf(page, PAGE_SIZE, "ipv4\n");\r\nspin_unlock(&lstat->lock);\r\nreturn ret;\r\n}\r\nstatic ssize_t iscsi_stat_tgt_attr_show_attr_fail_intr_addr(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = container_of(igrps,\r\nstruct iscsi_tiqn, tiqn_stat_grps);\r\nstruct iscsi_login_stats *lstat = &tiqn->login_stats;\r\nint ret;\r\nspin_lock(&lstat->lock);\r\nif (lstat->last_intr_fail_ip_family == AF_INET6) {\r\nret = snprintf(page, PAGE_SIZE, "[%s]\n",\r\nlstat->last_intr_fail_ip_addr);\r\n} else {\r\nret = snprintf(page, PAGE_SIZE, "%s\n",\r\nlstat->last_intr_fail_ip_addr);\r\n}\r\nspin_unlock(&lstat->lock);\r\nreturn ret;\r\n}\r\nstatic ssize_t iscsi_stat_login_show_attr_inst(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = container_of(igrps,\r\nstruct iscsi_tiqn, tiqn_stat_grps);\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", tiqn->tiqn_index);\r\n}\r\nstatic ssize_t iscsi_stat_login_show_attr_indx(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", ISCSI_NODE_INDEX);\r\n}\r\nstatic ssize_t iscsi_stat_login_show_attr_accepts(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = container_of(igrps,\r\nstruct iscsi_tiqn, tiqn_stat_grps);\r\nstruct iscsi_login_stats *lstat = &tiqn->login_stats;\r\nssize_t ret;\r\nspin_lock(&lstat->lock);\r\nret = snprintf(page, PAGE_SIZE, "%u\n", lstat->accepts);\r\nspin_unlock(&lstat->lock);\r\nreturn ret;\r\n}\r\nstatic ssize_t iscsi_stat_login_show_attr_other_fails(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = container_of(igrps,\r\nstruct iscsi_tiqn, tiqn_stat_grps);\r\nstruct iscsi_login_stats *lstat = &tiqn->login_stats;\r\nssize_t ret;\r\nspin_lock(&lstat->lock);\r\nret = snprintf(page, PAGE_SIZE, "%u\n", lstat->other_fails);\r\nspin_unlock(&lstat->lock);\r\nreturn ret;\r\n}\r\nstatic ssize_t iscsi_stat_login_show_attr_redirects(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = container_of(igrps,\r\nstruct iscsi_tiqn, tiqn_stat_grps);\r\nstruct iscsi_login_stats *lstat = &tiqn->login_stats;\r\nssize_t ret;\r\nspin_lock(&lstat->lock);\r\nret = snprintf(page, PAGE_SIZE, "%u\n", lstat->redirects);\r\nspin_unlock(&lstat->lock);\r\nreturn ret;\r\n}\r\nstatic ssize_t iscsi_stat_login_show_attr_authorize_fails(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = container_of(igrps,\r\nstruct iscsi_tiqn, tiqn_stat_grps);\r\nstruct iscsi_login_stats *lstat = &tiqn->login_stats;\r\nssize_t ret;\r\nspin_lock(&lstat->lock);\r\nret = snprintf(page, PAGE_SIZE, "%u\n", lstat->authorize_fails);\r\nspin_unlock(&lstat->lock);\r\nreturn ret;\r\n}\r\nstatic ssize_t iscsi_stat_login_show_attr_authenticate_fails(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = container_of(igrps,\r\nstruct iscsi_tiqn, tiqn_stat_grps);\r\nstruct iscsi_login_stats *lstat = &tiqn->login_stats;\r\nssize_t ret;\r\nspin_lock(&lstat->lock);\r\nret = snprintf(page, PAGE_SIZE, "%u\n", lstat->authenticate_fails);\r\nspin_unlock(&lstat->lock);\r\nreturn ret;\r\n}\r\nstatic ssize_t iscsi_stat_login_show_attr_negotiate_fails(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = container_of(igrps,\r\nstruct iscsi_tiqn, tiqn_stat_grps);\r\nstruct iscsi_login_stats *lstat = &tiqn->login_stats;\r\nssize_t ret;\r\nspin_lock(&lstat->lock);\r\nret = snprintf(page, PAGE_SIZE, "%u\n", lstat->negotiate_fails);\r\nspin_unlock(&lstat->lock);\r\nreturn ret;\r\n}\r\nstatic ssize_t iscsi_stat_logout_show_attr_inst(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = container_of(igrps,\r\nstruct iscsi_tiqn, tiqn_stat_grps);\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", tiqn->tiqn_index);\r\n}\r\nstatic ssize_t iscsi_stat_logout_show_attr_indx(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", ISCSI_NODE_INDEX);\r\n}\r\nstatic ssize_t iscsi_stat_logout_show_attr_normal_logouts(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = container_of(igrps,\r\nstruct iscsi_tiqn, tiqn_stat_grps);\r\nstruct iscsi_logout_stats *lstats = &tiqn->logout_stats;\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", lstats->normal_logouts);\r\n}\r\nstatic ssize_t iscsi_stat_logout_show_attr_abnormal_logouts(\r\nstruct iscsi_wwn_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = container_of(igrps,\r\nstruct iscsi_tiqn, tiqn_stat_grps);\r\nstruct iscsi_logout_stats *lstats = &tiqn->logout_stats;\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", lstats->abnormal_logouts);\r\n}\r\nstatic ssize_t iscsi_stat_sess_show_attr_inst(\r\nstruct iscsi_node_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_node_acl *acl = container_of(igrps,\r\nstruct iscsi_node_acl, node_stat_grps);\r\nstruct se_wwn *wwn = acl->se_node_acl.se_tpg->se_tpg_wwn;\r\nstruct iscsi_tiqn *tiqn = container_of(wwn,\r\nstruct iscsi_tiqn, tiqn_wwn);\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", tiqn->tiqn_index);\r\n}\r\nstatic ssize_t iscsi_stat_sess_show_attr_node(\r\nstruct iscsi_node_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_node_acl *acl = container_of(igrps,\r\nstruct iscsi_node_acl, node_stat_grps);\r\nstruct se_node_acl *se_nacl = &acl->se_node_acl;\r\nstruct iscsi_session *sess;\r\nstruct se_session *se_sess;\r\nssize_t ret = 0;\r\nspin_lock_bh(&se_nacl->nacl_sess_lock);\r\nse_sess = se_nacl->nacl_sess;\r\nif (se_sess) {\r\nsess = se_sess->fabric_sess_ptr;\r\nif (sess)\r\nret = snprintf(page, PAGE_SIZE, "%u\n",\r\nsess->sess_ops->SessionType ? 0 : ISCSI_NODE_INDEX);\r\n}\r\nspin_unlock_bh(&se_nacl->nacl_sess_lock);\r\nreturn ret;\r\n}\r\nstatic ssize_t iscsi_stat_sess_show_attr_indx(\r\nstruct iscsi_node_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_node_acl *acl = container_of(igrps,\r\nstruct iscsi_node_acl, node_stat_grps);\r\nstruct se_node_acl *se_nacl = &acl->se_node_acl;\r\nstruct iscsi_session *sess;\r\nstruct se_session *se_sess;\r\nssize_t ret = 0;\r\nspin_lock_bh(&se_nacl->nacl_sess_lock);\r\nse_sess = se_nacl->nacl_sess;\r\nif (se_sess) {\r\nsess = se_sess->fabric_sess_ptr;\r\nif (sess)\r\nret = snprintf(page, PAGE_SIZE, "%u\n",\r\nsess->session_index);\r\n}\r\nspin_unlock_bh(&se_nacl->nacl_sess_lock);\r\nreturn ret;\r\n}\r\nstatic ssize_t iscsi_stat_sess_show_attr_cmd_pdus(\r\nstruct iscsi_node_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_node_acl *acl = container_of(igrps,\r\nstruct iscsi_node_acl, node_stat_grps);\r\nstruct se_node_acl *se_nacl = &acl->se_node_acl;\r\nstruct iscsi_session *sess;\r\nstruct se_session *se_sess;\r\nssize_t ret = 0;\r\nspin_lock_bh(&se_nacl->nacl_sess_lock);\r\nse_sess = se_nacl->nacl_sess;\r\nif (se_sess) {\r\nsess = se_sess->fabric_sess_ptr;\r\nif (sess)\r\nret = snprintf(page, PAGE_SIZE, "%u\n", sess->cmd_pdus);\r\n}\r\nspin_unlock_bh(&se_nacl->nacl_sess_lock);\r\nreturn ret;\r\n}\r\nstatic ssize_t iscsi_stat_sess_show_attr_rsp_pdus(\r\nstruct iscsi_node_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_node_acl *acl = container_of(igrps,\r\nstruct iscsi_node_acl, node_stat_grps);\r\nstruct se_node_acl *se_nacl = &acl->se_node_acl;\r\nstruct iscsi_session *sess;\r\nstruct se_session *se_sess;\r\nssize_t ret = 0;\r\nspin_lock_bh(&se_nacl->nacl_sess_lock);\r\nse_sess = se_nacl->nacl_sess;\r\nif (se_sess) {\r\nsess = se_sess->fabric_sess_ptr;\r\nif (sess)\r\nret = snprintf(page, PAGE_SIZE, "%u\n", sess->rsp_pdus);\r\n}\r\nspin_unlock_bh(&se_nacl->nacl_sess_lock);\r\nreturn ret;\r\n}\r\nstatic ssize_t iscsi_stat_sess_show_attr_txdata_octs(\r\nstruct iscsi_node_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_node_acl *acl = container_of(igrps,\r\nstruct iscsi_node_acl, node_stat_grps);\r\nstruct se_node_acl *se_nacl = &acl->se_node_acl;\r\nstruct iscsi_session *sess;\r\nstruct se_session *se_sess;\r\nssize_t ret = 0;\r\nspin_lock_bh(&se_nacl->nacl_sess_lock);\r\nse_sess = se_nacl->nacl_sess;\r\nif (se_sess) {\r\nsess = se_sess->fabric_sess_ptr;\r\nif (sess)\r\nret = snprintf(page, PAGE_SIZE, "%llu\n",\r\n(unsigned long long)sess->tx_data_octets);\r\n}\r\nspin_unlock_bh(&se_nacl->nacl_sess_lock);\r\nreturn ret;\r\n}\r\nstatic ssize_t iscsi_stat_sess_show_attr_rxdata_octs(\r\nstruct iscsi_node_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_node_acl *acl = container_of(igrps,\r\nstruct iscsi_node_acl, node_stat_grps);\r\nstruct se_node_acl *se_nacl = &acl->se_node_acl;\r\nstruct iscsi_session *sess;\r\nstruct se_session *se_sess;\r\nssize_t ret = 0;\r\nspin_lock_bh(&se_nacl->nacl_sess_lock);\r\nse_sess = se_nacl->nacl_sess;\r\nif (se_sess) {\r\nsess = se_sess->fabric_sess_ptr;\r\nif (sess)\r\nret = snprintf(page, PAGE_SIZE, "%llu\n",\r\n(unsigned long long)sess->rx_data_octets);\r\n}\r\nspin_unlock_bh(&se_nacl->nacl_sess_lock);\r\nreturn ret;\r\n}\r\nstatic ssize_t iscsi_stat_sess_show_attr_conn_digest_errors(\r\nstruct iscsi_node_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_node_acl *acl = container_of(igrps,\r\nstruct iscsi_node_acl, node_stat_grps);\r\nstruct se_node_acl *se_nacl = &acl->se_node_acl;\r\nstruct iscsi_session *sess;\r\nstruct se_session *se_sess;\r\nssize_t ret = 0;\r\nspin_lock_bh(&se_nacl->nacl_sess_lock);\r\nse_sess = se_nacl->nacl_sess;\r\nif (se_sess) {\r\nsess = se_sess->fabric_sess_ptr;\r\nif (sess)\r\nret = snprintf(page, PAGE_SIZE, "%u\n",\r\nsess->conn_digest_errors);\r\n}\r\nspin_unlock_bh(&se_nacl->nacl_sess_lock);\r\nreturn ret;\r\n}\r\nstatic ssize_t iscsi_stat_sess_show_attr_conn_timeout_errors(\r\nstruct iscsi_node_stat_grps *igrps, char *page)\r\n{\r\nstruct iscsi_node_acl *acl = container_of(igrps,\r\nstruct iscsi_node_acl, node_stat_grps);\r\nstruct se_node_acl *se_nacl = &acl->se_node_acl;\r\nstruct iscsi_session *sess;\r\nstruct se_session *se_sess;\r\nssize_t ret = 0;\r\nspin_lock_bh(&se_nacl->nacl_sess_lock);\r\nse_sess = se_nacl->nacl_sess;\r\nif (se_sess) {\r\nsess = se_sess->fabric_sess_ptr;\r\nif (sess)\r\nret = snprintf(page, PAGE_SIZE, "%u\n",\r\nsess->conn_timeout_errors);\r\n}\r\nspin_unlock_bh(&se_nacl->nacl_sess_lock);\r\nreturn ret;\r\n}
