static void __init cpu9krea_init_early(void)\r\n{\r\nat91_initialize(18432000);\r\n}\r\nstatic void __init cpu9krea_add_device_nand(void)\r\n{\r\nsam9_smc_configure(0, 3, &cpu9krea_nand_smc_config);\r\nat91_add_device_nand(&cpu9krea_nand_data);\r\n}\r\nstatic __init void cpu9krea_add_device_nor(void)\r\n{\r\nunsigned long csa;\r\ncsa = at91_matrix_read(AT91_MATRIX_EBICSA);\r\nat91_matrix_write(AT91_MATRIX_EBICSA, csa | AT91_MATRIX_VDDIOMSEL_3_3V);\r\nsam9_smc_configure(0, 0, &cpu9krea_nor_smc_config);\r\nplatform_device_register(&cpu9krea_nor_flash);\r\n}\r\nstatic void __init cpu9krea_add_device_buttons(void)\r\n{\r\nat91_set_gpio_input(AT91_PIN_PC3, 1);\r\nat91_set_deglitch(AT91_PIN_PC3, 1);\r\nat91_set_gpio_input(AT91_PIN_PB20, 1);\r\nat91_set_deglitch(AT91_PIN_PB20, 1);\r\nplatform_device_register(&cpu9krea_button_device);\r\n}\r\nstatic void __init cpu9krea_add_device_buttons(void)\r\n{\r\n}\r\nstatic void __init cpu9krea_board_init(void)\r\n{\r\ncpu9krea_add_device_nor();\r\nat91_register_uart(0, 0, 0);\r\nat91_register_uart(AT91SAM9260_ID_US0, 1, ATMEL_UART_CTS |\r\nATMEL_UART_RTS | ATMEL_UART_DTR | ATMEL_UART_DSR |\r\nATMEL_UART_DCD | ATMEL_UART_RI);\r\nat91_register_uart(AT91SAM9260_ID_US1, 2, ATMEL_UART_CTS |\r\nATMEL_UART_RTS);\r\nat91_register_uart(AT91SAM9260_ID_US2, 3, ATMEL_UART_CTS |\r\nATMEL_UART_RTS);\r\nat91_register_uart(AT91SAM9260_ID_US3, 4, 0);\r\nat91_register_uart(AT91SAM9260_ID_US4, 5, 0);\r\nat91_register_uart(AT91SAM9260_ID_US5, 6, 0);\r\nat91_add_device_serial();\r\nat91_add_device_usbh(&cpu9krea_usbh_data);\r\nat91_add_device_udc(&cpu9krea_udc_data);\r\ncpu9krea_add_device_nand();\r\nat91_add_device_eth(&cpu9krea_macb_data);\r\nat91_add_device_mci(0, &cpu9krea_mci0_data);\r\nat91_add_device_i2c(cpu9krea_i2c_devices,\r\nARRAY_SIZE(cpu9krea_i2c_devices));\r\nat91_gpio_leds(cpu9krea_leds, ARRAY_SIZE(cpu9krea_leds));\r\ncpu9krea_add_device_buttons();\r\n}
