static int gem_show(struct seq_file *m, void *arg)\r\n{\r\nstruct drm_info_node *node = (struct drm_info_node *) m->private;\r\nstruct drm_device *dev = node->minor->dev;\r\nstruct omap_drm_private *priv = dev->dev_private;\r\nint ret;\r\nret = mutex_lock_interruptible(&dev->struct_mutex);\r\nif (ret)\r\nreturn ret;\r\nseq_printf(m, "All Objects:\n");\r\nomap_gem_describe_objects(&priv->obj_list, m);\r\nmutex_unlock(&dev->struct_mutex);\r\nreturn 0;\r\n}\r\nstatic int mm_show(struct seq_file *m, void *arg)\r\n{\r\nstruct drm_info_node *node = (struct drm_info_node *) m->private;\r\nstruct drm_device *dev = node->minor->dev;\r\nreturn drm_mm_dump_table(m, dev->mm_private);\r\n}\r\nstatic int fb_show(struct seq_file *m, void *arg)\r\n{\r\nstruct drm_info_node *node = (struct drm_info_node *) m->private;\r\nstruct drm_device *dev = node->minor->dev;\r\nstruct omap_drm_private *priv = dev->dev_private;\r\nstruct drm_framebuffer *fb;\r\nseq_printf(m, "fbcon ");\r\nomap_framebuffer_describe(priv->fbdev->fb, m);\r\nmutex_lock(&dev->mode_config.fb_lock);\r\nlist_for_each_entry(fb, &dev->mode_config.fb_list, head) {\r\nif (fb == priv->fbdev->fb)\r\ncontinue;\r\nseq_printf(m, "user ");\r\nomap_framebuffer_describe(fb, m);\r\n}\r\nmutex_unlock(&dev->mode_config.fb_lock);\r\nreturn 0;\r\n}\r\nint omap_debugfs_init(struct drm_minor *minor)\r\n{\r\nstruct drm_device *dev = minor->dev;\r\nint ret;\r\nret = drm_debugfs_create_files(omap_debugfs_list,\r\nARRAY_SIZE(omap_debugfs_list),\r\nminor->debugfs_root, minor);\r\nif (ret) {\r\ndev_err(dev->dev, "could not install omap_debugfs_list\n");\r\nreturn ret;\r\n}\r\nif (dmm_is_available())\r\nret = drm_debugfs_create_files(omap_dmm_debugfs_list,\r\nARRAY_SIZE(omap_dmm_debugfs_list),\r\nminor->debugfs_root, minor);\r\nif (ret) {\r\ndev_err(dev->dev, "could not install omap_dmm_debugfs_list\n");\r\nreturn ret;\r\n}\r\nreturn ret;\r\n}\r\nvoid omap_debugfs_cleanup(struct drm_minor *minor)\r\n{\r\ndrm_debugfs_remove_files(omap_debugfs_list,\r\nARRAY_SIZE(omap_debugfs_list), minor);\r\nif (dmm_is_available())\r\ndrm_debugfs_remove_files(omap_dmm_debugfs_list,\r\nARRAY_SIZE(omap_dmm_debugfs_list), minor);\r\n}
