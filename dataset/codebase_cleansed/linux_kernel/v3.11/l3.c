static void sendbyte(struct l3_pins *adap, unsigned int byte)\r\n{\r\nint i;\r\nfor (i = 0; i < 8; i++) {\r\nadap->setclk(0);\r\nudelay(adap->data_hold);\r\nadap->setdat(byte & 1);\r\nudelay(adap->data_setup);\r\nadap->setclk(1);\r\nudelay(adap->clock_high);\r\nbyte >>= 1;\r\n}\r\n}\r\nstatic void sendbytes(struct l3_pins *adap, const u8 *buf,\r\nint len)\r\n{\r\nint i;\r\nfor (i = 0; i < len; i++) {\r\nif (i) {\r\nudelay(adap->mode_hold);\r\nadap->setmode(0);\r\nudelay(adap->mode);\r\n}\r\nadap->setmode(1);\r\nudelay(adap->mode_setup);\r\nsendbyte(adap, buf[i]);\r\n}\r\n}\r\nint l3_write(struct l3_pins *adap, u8 addr, u8 *data, int len)\r\n{\r\nadap->setclk(1);\r\nadap->setdat(1);\r\nadap->setmode(1);\r\nudelay(adap->mode);\r\nadap->setmode(0);\r\nudelay(adap->mode_setup);\r\nsendbyte(adap, addr);\r\nudelay(adap->mode_hold);\r\nsendbytes(adap, data, len);\r\nadap->setclk(1);\r\nadap->setdat(1);\r\nadap->setmode(0);\r\nreturn len;\r\n}
