static ssize_t last_radio_log_read(struct file *file, char __user *buf,\r\nsize_t len, loff_t *offset)\r\n{\r\nreturn simple_read_from_buffer(buf, len, offset,\r\nradio_log_base, radio_log_size);\r\n}\r\nvoid msm_init_last_radio_log(struct module *owner)\r\n{\r\nstruct proc_dir_entry *entry;\r\nif (last_radio_log_fops.owner) {\r\npr_err("%s: already claimed\n", __func__);\r\nreturn;\r\n}\r\nradio_log_base = smem_item(SMEM_CLKREGIM_BSP, &radio_log_size);\r\nif (!radio_log_base) {\r\npr_err("%s: could not retrieve SMEM_CLKREGIM_BSP\n", __func__);\r\nreturn;\r\n}\r\nentry = proc_create("last_radio_log", S_IRUGO, NULL,\r\n&last_radio_log_fops);\r\nif (!entry) {\r\npr_err("%s: could not create proc entry for radio log\n",\r\n__func__);\r\nreturn;\r\n}\r\npr_err("%s: last radio log is %d bytes long\n", __func__,\r\nradio_log_size);\r\nlast_radio_log_fops.owner = owner;\r\nproc_set_size(entry, radio_log_size);\r\n}
