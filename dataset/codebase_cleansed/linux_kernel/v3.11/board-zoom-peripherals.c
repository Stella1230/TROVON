static int zoom_twl_gpio_setup(struct device *dev,\r\nunsigned gpio, unsigned ngpio)\r\n{\r\nmmc[0].gpio_cd = gpio + 0;\r\nomap_hsmmc_late_init(mmc);\r\nomap_twl4030_audio_data.jack_detect = gpio + 2;\r\nomap_twl4030_audio_init("Zoom2", &omap_twl4030_audio_data);\r\nreturn 0;\r\n}\r\nstatic int __init omap_i2c_init(void)\r\n{\r\nomap3_pmic_get_config(&zoom_twldata,\r\nTWL_COMMON_PDATA_USB | TWL_COMMON_PDATA_BCI |\r\nTWL_COMMON_PDATA_MADC | TWL_COMMON_PDATA_AUDIO,\r\nTWL_COMMON_REGULATOR_VDAC | TWL_COMMON_REGULATOR_VPLL2);\r\nif (machine_is_omap_zoom2())\r\nzoom_twldata.audio->codec->ramp_delay_value = 3;\r\nomap_pmic_init(1, 2400, "twl5030", 7 + OMAP_INTC_START, &zoom_twldata);\r\nomap_register_i2c_bus(2, 400, NULL, 0);\r\nomap_register_i2c_bus(3, 400, NULL, 0);\r\nreturn 0;\r\n}\r\nstatic void enable_board_wakeup_source(void)\r\n{\r\nomap_mux_init_signal("sys_nirq",\r\nOMAP_WAKEUP_EN | OMAP_PIN_INPUT_PULLUP);\r\n}\r\nvoid __init zoom_peripherals_init(void)\r\n{\r\nint ret;\r\nomap_zoom_wlan_data.irq = gpio_to_irq(OMAP_ZOOM_WLAN_IRQ_GPIO);\r\nret = wl12xx_set_platform_data(&omap_zoom_wlan_data);\r\nif (ret)\r\npr_err("error setting wl12xx data: %d\n", ret);\r\nomap_hsmmc_init(mmc);\r\nomap_i2c_init();\r\npwm_add_table(zoom_pwm_lookup, ARRAY_SIZE(zoom_pwm_lookup));\r\nplatform_add_devices(zoom_devices, ARRAY_SIZE(zoom_devices));\r\nusb_bind_phy("musb-hdrc.0.auto", 0, "twl4030_usb");\r\nusb_musb_init(NULL);\r\nenable_board_wakeup_source();\r\nomap_serial_init();\r\n}
