unsigned char ETHbyGetHashIndexByCrc32(unsigned char *pbyMultiAddr)\r\n{\r\nint ii;\r\nunsigned char byTmpHash;\r\nunsigned char byHash = 0;\r\nbyTmpHash = (unsigned char)(CRCdwCrc32(pbyMultiAddr, ETH_ALEN,\r\n0xFFFFFFFFL) & 0x3F);\r\nfor (ii = 0; ii < (sizeof(byTmpHash) * 8); ii++) {\r\nbyHash <<= 1;\r\nif (byTmpHash & 0x01)\r\nbyHash |= 1;\r\nbyTmpHash >>= 1;\r\n}\r\nreturn byHash >> 2;\r\n}\r\nbool ETHbIsBufferCrc32Ok(unsigned char *pbyBuffer, unsigned int cbFrameLength)\r\n{\r\nunsigned long dwCRC;\r\ndwCRC = CRCdwGetCrc32(pbyBuffer, cbFrameLength - 4);\r\nif (cpu_to_le32(*((unsigned long *)(pbyBuffer + cbFrameLength - 4))) != dwCRC) {\r\nreturn false;\r\n}\r\nreturn true;\r\n}
