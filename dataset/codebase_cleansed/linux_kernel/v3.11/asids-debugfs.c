static int asids_seq_show(struct seq_file *file, void *iter)\r\n{\r\nstruct task_struct *p;\r\nread_lock(&tasklist_lock);\r\nfor_each_process(p) {\r\nint pid = p->pid;\r\nif (unlikely(!pid))\r\ncontinue;\r\nif (p->mm)\r\nseq_printf(file, "%5d : %04lx\n", pid,\r\ncpu_asid(smp_processor_id(), p->mm));\r\n}\r\nread_unlock(&tasklist_lock);\r\nreturn 0;\r\n}\r\nstatic int asids_debugfs_open(struct inode *inode, struct file *file)\r\n{\r\nreturn single_open(file, asids_seq_show, inode->i_private);\r\n}\r\nstatic int __init asids_debugfs_init(void)\r\n{\r\nstruct dentry *asids_dentry;\r\nasids_dentry = debugfs_create_file("asids", S_IRUSR, arch_debugfs_dir,\r\nNULL, &asids_debugfs_fops);\r\nif (!asids_dentry)\r\nreturn -ENOMEM;\r\nif (IS_ERR(asids_dentry))\r\nreturn PTR_ERR(asids_dentry);\r\nreturn 0;\r\n}
