void m68ez328_reset(void)\r\n{\r\nlocal_irq_disable();\r\nasm volatile (\r\n"moveal #0x10c00000, %a0;\n"\r\n"moveb #0, 0xFFFFF300;\n"\r\n"moveal 0(%a0), %sp;\n"\r\n"moveal 4(%a0), %a0;\n"\r\n"jmp (%a0);\n"\r\n);\r\n}\r\nvoid config_BSP(char *command, int len)\r\n{\r\nunsigned char *p;\r\nprintk(KERN_INFO "\n68EZ328 DragonBallEZ support (C) 1999 Rt-Control, Inc\n");\r\n#ifdef CONFIG_UCSIMM\r\nprintk(KERN_INFO "uCsimm serial string [%s]\n",getserialnum());\r\np = cs8900a_hwaddr = gethwaddr(0);\r\nprintk(KERN_INFO "uCsimm hwaddr %.2x:%.2x:%.2x:%.2x:%.2x:%.2x\n",\r\np[0], p[1], p[2], p[3], p[4], p[5]);\r\np = getbenv("APPEND");\r\nif (p) strcpy(p,command);\r\nelse command[0] = 0;\r\n#endif\r\nmach_hwclk = m68328_hwclk;\r\nmach_reset = m68ez328_reset;\r\n}
