unsigned short snd_gf1_lvol_to_gvol_raw(unsigned int vol)\r\n{\r\nunsigned short e, m, tmp;\r\nif (vol > 65535)\r\nvol = 65535;\r\ntmp = vol;\r\ne = 7;\r\nif (tmp < 128) {\r\nwhile (e > 0 && tmp < (1 << e))\r\ne--;\r\n} else {\r\nwhile (tmp > 255) {\r\ntmp >>= 1;\r\ne++;\r\n}\r\n}\r\nm = vol - (1 << e);\r\nif (m > 0) {\r\nif (e > 8)\r\nm >>= e - 8;\r\nelse if (e < 8)\r\nm <<= 8 - e;\r\nm &= 255;\r\n}\r\nreturn (e << 8) | m;\r\n}\r\nunsigned short snd_gf1_translate_freq(struct snd_gus_card * gus, unsigned int freq16)\r\n{\r\nfreq16 >>= 3;\r\nif (freq16 < 50)\r\nfreq16 = 50;\r\nif (freq16 & 0xf8000000) {\r\nfreq16 = ~0xf8000000;\r\nsnd_printk(KERN_ERR "snd_gf1_translate_freq: overflow - freq = 0x%x\n", freq16);\r\n}\r\nreturn ((freq16 << 9) + (gus->gf1.playback_freq >> 1)) / gus->gf1.playback_freq;\r\n}
