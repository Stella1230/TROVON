static void\r\ndecode_avc(struct link_transaction *t)\r\n{\r\nstruct avc_frame *frame =\r\n(struct avc_frame *) t->request->packet.write_block.data;\r\nconst struct avc_opcode_info *info;\r\nconst char *name;\r\nchar buffer[32];\r\nint i;\r\ninfo = &opcode_info[frame->opcode];\r\nif (info->name == NULL) {\r\nsnprintf(buffer, sizeof(buffer),\r\n"(unknown opcode 0x%02x)", frame->opcode);\r\nname = buffer;\r\n} else {\r\nname = info->name;\r\n}\r\nprintf("av/c %s, subunit_type=%s, subunit_id=%d, opcode=%s",\r\nctype_names[frame->ctype], subunit_type_names[frame->subunit_type],\r\nframe->subunit_id, name);\r\nfor (i = 0; info->fields[i].name != NULL; i++)\r\nprintf(", %s", info->fields[i].name);\r\nprintf("\n");\r\n}\r\nint\r\ndecode_fcp(struct link_transaction *t)\r\n{\r\nstruct avc_frame *frame =\r\n(struct avc_frame *) t->request->packet.write_block.data;\r\nunsigned long long offset =\r\n((unsigned long long) t->request->packet.common.offset_high << 32) |\r\nt->request->packet.common.offset_low;\r\nif (t->request->packet.common.tcode != TCODE_WRITE_BLOCK_REQUEST)\r\nreturn 0;\r\nif (offset == CSR_FCP_COMMAND || offset == CSR_FCP_RESPONSE) {\r\nswitch (frame->cts) {\r\ncase 0x00:\r\ndecode_avc(t);\r\nbreak;\r\ncase 0x01:\r\nprintf("cal fcp frame (cts=0x01)\n");\r\nbreak;\r\ncase 0x02:\r\nprintf("ehs fcp frame (cts=0x02)\n");\r\nbreak;\r\ncase 0x03:\r\nprintf("havi fcp frame (cts=0x03)\n");\r\nbreak;\r\ncase 0x0e:\r\nprintf("vendor specific fcp frame (cts=0x0e)\n");\r\nbreak;\r\ncase 0x0f:\r\nprintf("extended cts\n");\r\nbreak;\r\ndefault:\r\nprintf("reserved fcp frame (ctx=0x%02x)\n", frame->cts);\r\nbreak;\r\n}\r\nreturn 1;\r\n}\r\nreturn 0;\r\n}
