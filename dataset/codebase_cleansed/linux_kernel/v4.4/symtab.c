static unsigned int symhash(struct hashtab *h, const void *key)\r\n{\r\nconst char *p, *keyp;\r\nunsigned int size;\r\nunsigned int val;\r\nval = 0;\r\nkeyp = key;\r\nsize = strlen(keyp);\r\nfor (p = keyp; (p - keyp) < size; p++)\r\nval = (val << 4 | (val >> (8*sizeof(unsigned int)-4))) ^ (*p);\r\nreturn val & (h->size - 1);\r\n}\r\nstatic int symcmp(struct hashtab *h, const void *key1, const void *key2)\r\n{\r\nconst char *keyp1, *keyp2;\r\nkeyp1 = key1;\r\nkeyp2 = key2;\r\nreturn strcmp(keyp1, keyp2);\r\n}\r\nint symtab_init(struct symtab *s, unsigned int size)\r\n{\r\ns->table = hashtab_create(symhash, symcmp, size);\r\nif (!s->table)\r\nreturn -ENOMEM;\r\ns->nprim = 0;\r\nreturn 0;\r\n}
