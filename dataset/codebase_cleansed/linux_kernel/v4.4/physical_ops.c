static int\r\nphysical_op_open(struct rpcrdma_ia *ia, struct rpcrdma_ep *ep,\r\nstruct rpcrdma_create_data_internal *cdata)\r\n{\r\nstruct ib_mr *mr;\r\nmr = ib_get_dma_mr(ia->ri_pd,\r\nIB_ACCESS_LOCAL_WRITE |\r\nIB_ACCESS_REMOTE_WRITE |\r\nIB_ACCESS_REMOTE_READ);\r\nif (IS_ERR(mr)) {\r\npr_err("%s: ib_get_dma_mr for failed with %lX\n",\r\n__func__, PTR_ERR(mr));\r\nreturn -ENOMEM;\r\n}\r\nia->ri_dma_mr = mr;\r\nreturn 0;\r\n}\r\nstatic size_t\r\nphysical_op_maxpages(struct rpcrdma_xprt *r_xprt)\r\n{\r\nreturn min_t(unsigned int, RPCRDMA_MAX_DATA_SEGS,\r\nrpcrdma_max_segments(r_xprt));\r\n}\r\nstatic int\r\nphysical_op_init(struct rpcrdma_xprt *r_xprt)\r\n{\r\nreturn 0;\r\n}\r\nstatic int\r\nphysical_op_map(struct rpcrdma_xprt *r_xprt, struct rpcrdma_mr_seg *seg,\r\nint nsegs, bool writing)\r\n{\r\nstruct rpcrdma_ia *ia = &r_xprt->rx_ia;\r\nrpcrdma_map_one(ia->ri_device, seg, rpcrdma_data_dir(writing));\r\nseg->mr_rkey = ia->ri_dma_mr->rkey;\r\nseg->mr_base = seg->mr_dma;\r\nseg->mr_nsegs = 1;\r\nreturn 1;\r\n}\r\nstatic int\r\nphysical_op_unmap(struct rpcrdma_xprt *r_xprt, struct rpcrdma_mr_seg *seg)\r\n{\r\nstruct rpcrdma_ia *ia = &r_xprt->rx_ia;\r\nrpcrdma_unmap_one(ia->ri_device, seg);\r\nreturn 1;\r\n}\r\nstatic void\r\nphysical_op_destroy(struct rpcrdma_buffer *buf)\r\n{\r\n}
