static acpi_status\r\nacpi_ds_init_one_object(acpi_handle obj_handle,\r\nu32 level, void *context, void **return_value)\r\n{\r\nstruct acpi_init_walk_info *info =\r\n(struct acpi_init_walk_info *)context;\r\nstruct acpi_namespace_node *node =\r\n(struct acpi_namespace_node *)obj_handle;\r\nacpi_status status;\r\nunion acpi_operand_object *obj_desc;\r\nACPI_FUNCTION_ENTRY();\r\nif (node->owner_id != info->owner_id) {\r\nreturn (AE_OK);\r\n}\r\ninfo->object_count++;\r\nswitch (acpi_ns_get_type(obj_handle)) {\r\ncase ACPI_TYPE_REGION:\r\nstatus = acpi_ds_initialize_region(obj_handle);\r\nif (ACPI_FAILURE(status)) {\r\nACPI_EXCEPTION((AE_INFO, status,\r\n"During Region initialization %p [%4.4s]",\r\nobj_handle,\r\nacpi_ut_get_node_name(obj_handle)));\r\n}\r\ninfo->op_region_count++;\r\nbreak;\r\ncase ACPI_TYPE_METHOD:\r\ninfo->method_count++;\r\nobj_desc = acpi_ns_get_attached_object(node);\r\nif (!obj_desc) {\r\nbreak;\r\n}\r\nif (obj_desc->method.info_flags & ACPI_METHOD_SERIALIZED) {\r\ninfo->serial_method_count++;\r\nbreak;\r\n}\r\nif (acpi_gbl_auto_serialize_methods) {\r\nacpi_ds_auto_serialize_method(node, obj_desc);\r\nif (obj_desc->method.\r\ninfo_flags & ACPI_METHOD_SERIALIZED) {\r\ninfo->serial_method_count++;\r\ninfo->serialized_method_count++;\r\nbreak;\r\n}\r\n}\r\ninfo->non_serial_method_count++;\r\nbreak;\r\ncase ACPI_TYPE_DEVICE:\r\ninfo->device_count++;\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nreturn (AE_OK);\r\n}\r\nacpi_status\r\nacpi_ds_initialize_objects(u32 table_index,\r\nstruct acpi_namespace_node * start_node)\r\n{\r\nacpi_status status;\r\nstruct acpi_init_walk_info info;\r\nstruct acpi_table_header *table;\r\nacpi_owner_id owner_id;\r\nACPI_FUNCTION_TRACE(ds_initialize_objects);\r\nstatus = acpi_tb_get_owner_id(table_index, &owner_id);\r\nif (ACPI_FAILURE(status)) {\r\nreturn_ACPI_STATUS(status);\r\n}\r\nACPI_DEBUG_PRINT((ACPI_DB_DISPATCH,\r\n"**** Starting initialization of namespace objects ****\n"));\r\nmemset(&info, 0, sizeof(struct acpi_init_walk_info));\r\ninfo.owner_id = owner_id;\r\ninfo.table_index = table_index;\r\nstatus = acpi_ut_acquire_mutex(ACPI_MTX_NAMESPACE);\r\nif (ACPI_FAILURE(status)) {\r\nreturn_ACPI_STATUS(status);\r\n}\r\nstatus =\r\nacpi_ns_walk_namespace(ACPI_TYPE_ANY, start_node, ACPI_UINT32_MAX,\r\nACPI_NS_WALK_UNLOCK, acpi_ds_init_one_object,\r\nNULL, &info, NULL);\r\nif (ACPI_FAILURE(status)) {\r\nACPI_EXCEPTION((AE_INFO, status, "During WalkNamespace"));\r\n}\r\n(void)acpi_ut_release_mutex(ACPI_MTX_NAMESPACE);\r\nstatus = acpi_get_table_by_index(table_index, &table);\r\nif (ACPI_FAILURE(status)) {\r\nreturn_ACPI_STATUS(status);\r\n}\r\nif (ACPI_COMPARE_NAME(table->signature, ACPI_SIG_DSDT)) {\r\nACPI_DEBUG_PRINT_RAW((ACPI_DB_INIT,\r\n"\nInitializing Namespace objects:\n"));\r\n}\r\nACPI_DEBUG_PRINT_RAW((ACPI_DB_INIT,\r\n"Table [%4.4s:%8.8s] (id %.2X) - %4u Objects with %3u Devices, "\r\n"%3u Regions, %4u Methods (%u/%u/%u Serial/Non/Cvt)\n",\r\ntable->signature, table->oem_table_id, owner_id,\r\ninfo.object_count, info.device_count,\r\ninfo.op_region_count, info.method_count,\r\ninfo.serial_method_count,\r\ninfo.non_serial_method_count,\r\ninfo.serialized_method_count));\r\nACPI_DEBUG_PRINT((ACPI_DB_DISPATCH, "%u Methods, %u Regions\n",\r\ninfo.method_count, info.op_region_count));\r\nreturn_ACPI_STATUS(AE_OK);\r\n}
