static void __init tegra_sclk_init(void __iomem *clk_base,\r\nstruct tegra_clk *tegra_clks)\r\n{\r\nstruct clk *clk;\r\nstruct clk **dt_clk;\r\ndt_clk = tegra_lookup_dt_id(tegra_clk_sclk, tegra_clks);\r\nif (dt_clk) {\r\nclk = tegra_clk_register_super_mux("sclk", sclk_parents,\r\nARRAY_SIZE(sclk_parents),\r\nCLK_SET_RATE_PARENT,\r\nclk_base + SCLK_BURST_POLICY,\r\n0, 4, 0, 0, NULL);\r\n*dt_clk = clk;\r\n}\r\ndt_clk = tegra_lookup_dt_id(tegra_clk_hclk, tegra_clks);\r\nif (dt_clk) {\r\nclk = clk_register_divider(NULL, "hclk_div", "sclk", 0,\r\nclk_base + SYSTEM_CLK_RATE, 4, 2, 0,\r\n&sysrate_lock);\r\nclk = clk_register_gate(NULL, "hclk", "hclk_div",\r\nCLK_SET_RATE_PARENT | CLK_IGNORE_UNUSED,\r\nclk_base + SYSTEM_CLK_RATE,\r\n7, CLK_GATE_SET_TO_DISABLE, &sysrate_lock);\r\n*dt_clk = clk;\r\n}\r\ndt_clk = tegra_lookup_dt_id(tegra_clk_pclk, tegra_clks);\r\nif (!dt_clk)\r\nreturn;\r\nclk = clk_register_divider(NULL, "pclk_div", "hclk", 0,\r\nclk_base + SYSTEM_CLK_RATE, 0, 2, 0,\r\n&sysrate_lock);\r\nclk = clk_register_gate(NULL, "pclk", "pclk_div", CLK_SET_RATE_PARENT |\r\nCLK_IGNORE_UNUSED, clk_base + SYSTEM_CLK_RATE,\r\n3, CLK_GATE_SET_TO_DISABLE, &sysrate_lock);\r\n*dt_clk = clk;\r\n}\r\nvoid __init tegra_super_clk_gen4_init(void __iomem *clk_base,\r\nvoid __iomem *pmc_base,\r\nstruct tegra_clk *tegra_clks,\r\nstruct tegra_clk_pll_params *params)\r\n{\r\nstruct clk *clk;\r\nstruct clk **dt_clk;\r\ndt_clk = tegra_lookup_dt_id(tegra_clk_cclk_g, tegra_clks);\r\nif (dt_clk) {\r\nclk = tegra_clk_register_super_mux("cclk_g", cclk_g_parents,\r\nARRAY_SIZE(cclk_g_parents),\r\nCLK_SET_RATE_PARENT,\r\nclk_base + CCLKG_BURST_POLICY,\r\n0, 4, 0, 0, NULL);\r\n*dt_clk = clk;\r\n}\r\ndt_clk = tegra_lookup_dt_id(tegra_clk_cclk_lp, tegra_clks);\r\nif (dt_clk) {\r\nclk = tegra_clk_register_super_mux("cclk_lp", cclk_lp_parents,\r\nARRAY_SIZE(cclk_lp_parents),\r\nCLK_SET_RATE_PARENT,\r\nclk_base + CCLKLP_BURST_POLICY,\r\nTEGRA_DIVIDER_2, 4, 8, 9, NULL);\r\n*dt_clk = clk;\r\n}\r\ntegra_sclk_init(clk_base, tegra_clks);\r\n#if defined(CONFIG_ARCH_TEGRA_114_SOC) || defined(CONFIG_ARCH_TEGRA_124_SOC)\r\ndt_clk = tegra_lookup_dt_id(tegra_clk_pll_x, tegra_clks);\r\nif (!dt_clk)\r\nreturn;\r\nclk = tegra_clk_register_pllxc("pll_x", "pll_ref", clk_base,\r\npmc_base, CLK_IGNORE_UNUSED, params, NULL);\r\n*dt_clk = clk;\r\ndt_clk = tegra_lookup_dt_id(tegra_clk_pll_x_out0, tegra_clks);\r\nif (!dt_clk)\r\nreturn;\r\nclk = clk_register_fixed_factor(NULL, "pll_x_out0", "pll_x",\r\nCLK_SET_RATE_PARENT, 1, 2);\r\n*dt_clk = clk;\r\n#endif\r\n}
