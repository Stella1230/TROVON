static int tangier_probe(struct platform_device *pdev)\r\n{\r\nint gsi;\r\nstruct irq_alloc_info info;\r\nstruct intel_mid_wdt_pdata *pdata = pdev->dev.platform_data;\r\nif (!pdata)\r\nreturn -EINVAL;\r\ngsi = pdata->irq;\r\nioapic_set_alloc_attr(&info, cpu_to_node(0), 1, 0);\r\nif (mp_map_gsi_to_irq(gsi, IOAPIC_MAP_ALLOC, &info) <= 0) {\r\ndev_warn(&pdev->dev, "cannot find interrupt %d in ioapic\n",\r\ngsi);\r\nreturn -EINVAL;\r\n}\r\nreturn 0;\r\n}\r\nstatic int __init register_mid_wdt(void)\r\n{\r\nif (intel_mid_identify_cpu() == INTEL_MID_CPU_CHIP_TANGIER) {\r\nwdt_dev.dev.platform_data = &tangier_pdata;\r\nreturn platform_device_register(&wdt_dev);\r\n}\r\nreturn -ENODEV;\r\n}
