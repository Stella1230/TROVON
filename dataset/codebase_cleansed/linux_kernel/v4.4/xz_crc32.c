XZ_EXTERN void xz_crc32_init(void)\r\n{\r\nconst uint32_t poly = 0xEDB88320;\r\nuint32_t i;\r\nuint32_t j;\r\nuint32_t r;\r\nfor (i = 0; i < 256; ++i) {\r\nr = i;\r\nfor (j = 0; j < 8; ++j)\r\nr = (r >> 1) ^ (poly & ~((r & 1) - 1));\r\nxz_crc32_table[i] = r;\r\n}\r\nreturn;\r\n}\r\nXZ_EXTERN uint32_t xz_crc32(const uint8_t *buf, size_t size, uint32_t crc)\r\n{\r\ncrc = ~crc;\r\nwhile (size != 0) {\r\ncrc = xz_crc32_table[*buf++ ^ (crc & 0xFF)] ^ (crc >> 8);\r\n--size;\r\n}\r\nreturn ~crc;\r\n}
