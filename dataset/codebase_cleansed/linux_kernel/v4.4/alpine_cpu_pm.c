int alpine_cpu_wakeup(unsigned int phys_cpu, uint32_t phys_resume_addr)\r\n{\r\nif (!wakeup_supported)\r\nreturn -ENOSYS;\r\nwritel(phys_resume_addr,\r\n&al_cpu_resume_regs->per_cpu[phys_cpu].resume_addr);\r\nregmap_write(al_sysfabric, AL_SYSFAB_POWER_CONTROL(phys_cpu), 0);\r\nreturn 0;\r\n}\r\nvoid __init alpine_cpu_pm_init(void)\r\n{\r\nstruct device_node *np;\r\nuint32_t watermark;\r\nal_sysfabric = syscon_regmap_lookup_by_compatible("al,alpine-sysfabric-service");\r\nnp = of_find_compatible_node(NULL, NULL, "al,alpine-cpu-resume");\r\nal_cpu_resume_regs = of_iomap(np, 0);\r\nwakeup_supported = !IS_ERR(al_sysfabric) && al_cpu_resume_regs;\r\nif (wakeup_supported) {\r\nwatermark = readl(&al_cpu_resume_regs->watermark);\r\nwakeup_supported = (watermark & AL_CPU_RESUME_MAGIC_NUM_MASK)\r\n== AL_CPU_RESUME_MAGIC_NUM;\r\n}\r\n}
