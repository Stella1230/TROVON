static void ioc_setscl(void *data, int state)\r\n{\r\nu_int ioc_control = ioc_readb(IOC_CONTROL) & ~(SCL | SDA);\r\nu_int ones = force_ones;\r\nif (state)\r\nones |= SCL;\r\nelse\r\nones &= ~SCL;\r\nforce_ones = ones;\r\nioc_writeb(ioc_control | ones, IOC_CONTROL);\r\n}\r\nstatic void ioc_setsda(void *data, int state)\r\n{\r\nu_int ioc_control = ioc_readb(IOC_CONTROL) & ~(SCL | SDA);\r\nu_int ones = force_ones;\r\nif (state)\r\nones |= SDA;\r\nelse\r\nones &= ~SDA;\r\nforce_ones = ones;\r\nioc_writeb(ioc_control | ones, IOC_CONTROL);\r\n}\r\nstatic int ioc_getscl(void *data)\r\n{\r\nreturn (ioc_readb(IOC_CONTROL) & SCL) != 0;\r\n}\r\nstatic int ioc_getsda(void *data)\r\n{\r\nreturn (ioc_readb(IOC_CONTROL) & SDA) != 0;\r\n}\r\nstatic int __init i2c_ioc_init(void)\r\n{\r\nforce_ones = FORCE_ONES | SCL | SDA;\r\nreturn i2c_bit_add_numbered_bus(&ioc_ops);\r\n}
