static void sim_write(struct console *co, const char *ptr,\r\nunsigned len)\r\n{\r\nregister const int fd __asm__("er0") = 1;\r\nregister const char *_ptr __asm__("er1") = ptr;\r\nregister const unsigned _len __asm__("er2") = len;\r\n__asm__(".byte 0x5e,0x00,0x00,0xc7\n\t"\r\n: : "g"(fd), "g"(_ptr), "g"(_len));\r\n}\r\nstatic int sim_probe(struct platform_device *pdev)\r\n{\r\nif (sim_console.data)\r\nreturn -EEXIST;\r\nif (!strstr(sim_console_buf, "keep"))\r\nsim_console.flags |= CON_BOOT;\r\nregister_console(&sim_console);\r\nreturn 0;\r\n}\r\nstatic int sim_remove(struct platform_device *pdev)\r\n{\r\nreturn 0;\r\n}\r\nvoid __init sim_console_register(void)\r\n{\r\nearly_platform_add_devices(devices,\r\nARRAY_SIZE(devices));\r\n}
