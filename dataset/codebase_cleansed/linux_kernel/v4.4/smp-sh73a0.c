static int sh73a0_boot_secondary(unsigned int cpu, struct task_struct *idle)\r\n{\r\nunsigned int lcpu = cpu_logical_map(cpu);\r\nif (((__raw_readl(PSTR) >> (4 * lcpu)) & 3) == 3)\r\n__raw_writel(1 << lcpu, WUPCR);\r\nelse\r\n__raw_writel(1 << lcpu, SRESCR);\r\nreturn 0;\r\n}\r\nstatic void __init sh73a0_smp_prepare_cpus(unsigned int max_cpus)\r\n{\r\n__raw_writel(0, APARMBAREA);\r\n__raw_writel(__pa(shmobile_boot_vector), SBAR);\r\nshmobile_scu_base = IOMEM(SH73A0_SCU_BASE);\r\nshmobile_smp_scu_prepare_cpus(max_cpus);\r\n}
