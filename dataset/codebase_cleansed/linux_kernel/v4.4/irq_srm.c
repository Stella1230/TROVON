static inline void\r\nsrm_enable_irq(struct irq_data *d)\r\n{\r\nspin_lock(&srm_irq_lock);\r\ncserve_ena(d->irq - 16);\r\nspin_unlock(&srm_irq_lock);\r\n}\r\nstatic void\r\nsrm_disable_irq(struct irq_data *d)\r\n{\r\nspin_lock(&srm_irq_lock);\r\ncserve_dis(d->irq - 16);\r\nspin_unlock(&srm_irq_lock);\r\n}\r\nvoid __init\r\ninit_srm_irqs(long max, unsigned long ignore_mask)\r\n{\r\nlong i;\r\nif (NR_IRQS <= 16)\r\nreturn;\r\nfor (i = 16; i < max; ++i) {\r\nif (i < 64 && ((ignore_mask >> i) & 1))\r\ncontinue;\r\nirq_set_chip_and_handler(i, &srm_irq_type, handle_level_irq);\r\nirq_set_status_flags(i, IRQ_LEVEL);\r\n}\r\n}\r\nvoid\r\nsrm_device_interrupt(unsigned long vector)\r\n{\r\nint irq = (vector - 0x800) >> 4;\r\nhandle_irq(irq);\r\n}
