static void pci236_intr_update_cb(struct comedi_device *dev, bool enable)\r\n{\r\nstruct pc236_private *devpriv = dev->private;\r\noutl(enable ? PCI236_INTR_ENABLE : PCI236_INTR_DISABLE,\r\ndevpriv->lcr_iobase + PLX9052_INTCSR);\r\n}\r\nstatic bool pci236_intr_chk_clr_cb(struct comedi_device *dev)\r\n{\r\nstruct pc236_private *devpriv = dev->private;\r\nif (!(inl(devpriv->lcr_iobase + PLX9052_INTCSR) &\r\nPLX9052_INTCSR_LI1STAT))\r\nreturn false;\r\npci236_intr_update_cb(dev, devpriv->enable_irq);\r\nreturn true;\r\n}\r\nstatic int pci236_auto_attach(struct comedi_device *dev,\r\nunsigned long context_unused)\r\n{\r\nstruct pci_dev *pci_dev = comedi_to_pci_dev(dev);\r\nstruct pc236_private *devpriv;\r\nunsigned long iobase;\r\nint ret;\r\ndev_info(dev->class_dev, "amplc_pci236: attach pci %s\n",\r\npci_name(pci_dev));\r\ndevpriv = comedi_alloc_devpriv(dev, sizeof(*devpriv));\r\nif (!devpriv)\r\nreturn -ENOMEM;\r\ndev->board_ptr = &pc236_pci_board;\r\ndev->board_name = pc236_pci_board.name;\r\nret = comedi_pci_enable(dev);\r\nif (ret)\r\nreturn ret;\r\ndevpriv->lcr_iobase = pci_resource_start(pci_dev, 1);\r\niobase = pci_resource_start(pci_dev, 2);\r\nreturn amplc_pc236_common_attach(dev, iobase, pci_dev->irq,\r\nIRQF_SHARED);\r\n}\r\nstatic int amplc_pci236_pci_probe(struct pci_dev *dev,\r\nconst struct pci_device_id *id)\r\n{\r\nreturn comedi_pci_auto_config(dev, &amplc_pci236_driver,\r\nid->driver_data);\r\n}
