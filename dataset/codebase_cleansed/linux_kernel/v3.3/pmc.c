static void pmc_swift_idle(void)\r\n{\r\n#ifdef PMC_DEBUG_LED\r\nset_auxio(0x00, AUXIO_LED);\r\n#endif\r\npmc_writeb(pmc_readb(PMC_IDLE_REG) | PMC_IDLE_ON, PMC_IDLE_REG);\r\n#ifdef PMC_DEBUG_LED\r\nset_auxio(AUXIO_LED, 0x00);\r\n#endif\r\n}\r\nstatic int __devinit pmc_probe(struct platform_device *op)\r\n{\r\nregs = of_ioremap(&op->resource[0], 0,\r\nresource_size(&op->resource[0]), PMC_OBPNAME);\r\nif (!regs) {\r\nprintk(KERN_ERR "%s: unable to map registers\n", PMC_DEVNAME);\r\nreturn -ENODEV;\r\n}\r\n#ifndef PMC_NO_IDLE\r\npm_idle = pmc_swift_idle;\r\n#endif\r\nprintk(KERN_INFO "%s: power management initialized\n", PMC_DEVNAME);\r\nreturn 0;\r\n}\r\nstatic int __init pmc_init(void)\r\n{\r\nreturn platform_driver_register(&pmc_driver);\r\n}
