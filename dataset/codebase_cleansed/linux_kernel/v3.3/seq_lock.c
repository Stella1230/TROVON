void snd_use_lock_sync_helper(snd_use_lock_t *lockp, const char *file, int line)\r\n{\r\nint max_count = 5 * HZ;\r\nif (atomic_read(lockp) < 0) {\r\nprintk(KERN_WARNING "seq_lock: lock trouble [counter = %d] in %s:%d\n", atomic_read(lockp), file, line);\r\nreturn;\r\n}\r\nwhile (atomic_read(lockp) > 0) {\r\nif (max_count == 0) {\r\nsnd_printk(KERN_WARNING "seq_lock: timeout [%d left] in %s:%d\n", atomic_read(lockp), file, line);\r\nbreak;\r\n}\r\nschedule_timeout_uninterruptible(1);\r\nmax_count--;\r\n}\r\n}
