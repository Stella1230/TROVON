static int p8022_request(struct datalink_proto *dl, struct sk_buff *skb,\r\nunsigned char *dest)\r\n{\r\nllc_build_and_send_ui_pkt(dl->sap, skb, dest, dl->sap->laddr.lsap);\r\nreturn 0;\r\n}\r\nstruct datalink_proto *register_8022_client(unsigned char type,\r\nint (*func)(struct sk_buff *skb,\r\nstruct net_device *dev,\r\nstruct packet_type *pt,\r\nstruct net_device *orig_dev))\r\n{\r\nstruct datalink_proto *proto;\r\nproto = kmalloc(sizeof(*proto), GFP_ATOMIC);\r\nif (proto) {\r\nproto->type[0] = type;\r\nproto->header_length = 3;\r\nproto->request = p8022_request;\r\nproto->sap = llc_sap_open(type, func);\r\nif (!proto->sap) {\r\nkfree(proto);\r\nproto = NULL;\r\n}\r\n}\r\nreturn proto;\r\n}\r\nvoid unregister_8022_client(struct datalink_proto *proto)\r\n{\r\nllc_sap_put(proto->sap);\r\nkfree(proto);\r\n}
