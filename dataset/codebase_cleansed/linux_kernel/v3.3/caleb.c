static u8 caleb_reg_read(int reg)\r\n{\r\nu8 value;\r\nvalue = *((volatile u8 *)(ENP2611_CALEB_VIRT_BASE + reg));\r\nreturn value;\r\n}\r\nstatic void caleb_reg_write(int reg, u8 value)\r\n{\r\nu8 dummy;\r\n*((volatile u8 *)(ENP2611_CALEB_VIRT_BASE + reg)) = value;\r\ndummy = *((volatile u8 *)ENP2611_CALEB_VIRT_BASE);\r\n__asm__ __volatile__("mov %0, %0" : "+r" (dummy));\r\n}\r\nvoid caleb_reset(void)\r\n{\r\ncaleb_reg_write(CALEB_RESET, 0x02);\r\nudelay(1);\r\ncaleb_reg_write(CALEB_INTREN0, 0xff);\r\ncaleb_reg_write(CALEB_INTREN1, 0x07);\r\ncaleb_reg_write(CALEB_PHY0RX, 0x11);\r\ncaleb_reg_write(CALEB_PHY1RX, 0x11);\r\ncaleb_reg_write(CALEB_PHY0TX, 0x11);\r\ncaleb_reg_write(CALEB_PHY1TX, 0x11);\r\ncaleb_reg_write(CALEB_BURST, 0);\r\n}\r\nvoid caleb_enable_rx(int port)\r\n{\r\nu8 temp;\r\ntemp = caleb_reg_read(CALEB_PORTEN);\r\ntemp |= 1 << port;\r\ncaleb_reg_write(CALEB_PORTEN, temp);\r\n}\r\nvoid caleb_disable_rx(int port)\r\n{\r\nu8 temp;\r\ntemp = caleb_reg_read(CALEB_PORTEN);\r\ntemp &= ~(1 << port);\r\ncaleb_reg_write(CALEB_PORTEN, temp);\r\n}\r\nvoid caleb_enable_tx(int port)\r\n{\r\nu8 temp;\r\ntemp = caleb_reg_read(CALEB_PORTEN);\r\ntemp |= 1 << (port + 4);\r\ncaleb_reg_write(CALEB_PORTEN, temp);\r\n}\r\nvoid caleb_disable_tx(int port)\r\n{\r\nu8 temp;\r\ntemp = caleb_reg_read(CALEB_PORTEN);\r\ntemp &= ~(1 << (port + 4));\r\ncaleb_reg_write(CALEB_PORTEN, temp);\r\n}
