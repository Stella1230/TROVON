void mn10300_dcache_flush(void)\r\n{\r\nunsigned long flags;\r\nflags = smp_lock_cache();\r\nmn10300_local_dcache_flush();\r\nsmp_cache_call(SMP_DCACHE_FLUSH, 0, 0);\r\nsmp_unlock_cache(flags);\r\n}\r\nvoid mn10300_dcache_flush_page(unsigned long start)\r\n{\r\nunsigned long flags;\r\nstart &= ~(PAGE_SIZE-1);\r\nflags = smp_lock_cache();\r\nmn10300_local_dcache_flush_page(start);\r\nsmp_cache_call(SMP_DCACHE_FLUSH_RANGE, start, start + PAGE_SIZE);\r\nsmp_unlock_cache(flags);\r\n}\r\nvoid mn10300_dcache_flush_range(unsigned long start, unsigned long end)\r\n{\r\nunsigned long flags;\r\nflags = smp_lock_cache();\r\nmn10300_local_dcache_flush_range(start, end);\r\nsmp_cache_call(SMP_DCACHE_FLUSH_RANGE, start, end);\r\nsmp_unlock_cache(flags);\r\n}\r\nvoid mn10300_dcache_flush_range2(unsigned long start, unsigned long size)\r\n{\r\nunsigned long flags;\r\nflags = smp_lock_cache();\r\nmn10300_local_dcache_flush_range2(start, size);\r\nsmp_cache_call(SMP_DCACHE_FLUSH_RANGE, start, start + size);\r\nsmp_unlock_cache(flags);\r\n}\r\nvoid mn10300_dcache_flush_inv(void)\r\n{\r\nunsigned long flags;\r\nflags = smp_lock_cache();\r\nmn10300_local_dcache_flush_inv();\r\nsmp_cache_call(SMP_DCACHE_FLUSH_INV, 0, 0);\r\nsmp_unlock_cache(flags);\r\n}\r\nvoid mn10300_dcache_flush_inv_page(unsigned long start)\r\n{\r\nunsigned long flags;\r\nstart &= ~(PAGE_SIZE-1);\r\nflags = smp_lock_cache();\r\nmn10300_local_dcache_flush_inv_page(start);\r\nsmp_cache_call(SMP_DCACHE_FLUSH_INV_RANGE, start, start + PAGE_SIZE);\r\nsmp_unlock_cache(flags);\r\n}\r\nvoid mn10300_dcache_flush_inv_range(unsigned long start, unsigned long end)\r\n{\r\nunsigned long flags;\r\nflags = smp_lock_cache();\r\nmn10300_local_dcache_flush_inv_range(start, end);\r\nsmp_cache_call(SMP_DCACHE_FLUSH_INV_RANGE, start, end);\r\nsmp_unlock_cache(flags);\r\n}\r\nvoid mn10300_dcache_flush_inv_range2(unsigned long start, unsigned long size)\r\n{\r\nunsigned long flags;\r\nflags = smp_lock_cache();\r\nmn10300_local_dcache_flush_inv_range2(start, size);\r\nsmp_cache_call(SMP_DCACHE_FLUSH_INV_RANGE, start, start + size);\r\nsmp_unlock_cache(flags);\r\n}
