static int px_raw_event(struct hid_device *hid, struct hid_report *report,\r\nu8 *data, int size)\r\n{\r\nint idx = size;\r\nswitch (report->id) {\r\ncase 0:\r\nwhile (--idx > 1) {\r\nif (data[idx] < 0xE0 || data[idx] > 0xE7)\r\ncontinue;\r\ndata[0] |= (1 << (data[idx] - 0xE0));\r\ndata[idx] = 0;\r\n}\r\nhid_report_raw_event(hid, HID_INPUT_REPORT, data, size, 0);\r\nreturn 1;\r\ndefault:\r\nhid_info(hid, "unknown report type %d\n", report->id);\r\nbreak;\r\n}\r\nreturn 0;\r\n}\r\nstatic int px_probe(struct hid_device *hid, const struct hid_device_id *id)\r\n{\r\nint ret;\r\nret = hid_parse(hid);\r\nif (ret) {\r\nhid_err(hid, "parse failed\n");\r\ngoto fail;\r\n}\r\nret = hid_hw_start(hid, HID_CONNECT_DEFAULT);\r\nif (ret)\r\nhid_err(hid, "hw start failed\n");\r\nfail:\r\nreturn ret;\r\n}\r\nstatic void px_remove(struct hid_device *hid)\r\n{\r\nhid_hw_stop(hid);\r\n}\r\nstatic int __init px_init(void)\r\n{\r\nreturn hid_register_driver(&px_driver);\r\n}\r\nstatic void __exit px_exit(void)\r\n{\r\nhid_unregister_driver(&px_driver);\r\n}
