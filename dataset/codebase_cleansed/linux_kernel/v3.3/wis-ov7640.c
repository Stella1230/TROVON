static int write_regs(struct i2c_client *client, u8 *regs)\r\n{\r\nint i;\r\nfor (i = 0; regs[i] != 0xFF; i += 2)\r\nif (i2c_smbus_write_byte_data(client, regs[i], regs[i + 1]) < 0)\r\nreturn -1;\r\nreturn 0;\r\n}\r\nstatic int wis_ov7640_probe(struct i2c_client *client,\r\nconst struct i2c_device_id *id)\r\n{\r\nstruct i2c_adapter *adapter = client->adapter;\r\nif (!i2c_check_functionality(adapter, I2C_FUNC_SMBUS_BYTE_DATA))\r\nreturn -ENODEV;\r\nclient->flags = I2C_CLIENT_SCCB;\r\nprintk(KERN_DEBUG\r\n"wis-ov7640: initializing OV7640 at address %d on %s\n",\r\nclient->addr, adapter->name);\r\nif (write_regs(client, initial_registers) < 0) {\r\nprintk(KERN_ERR "wis-ov7640: error initializing OV7640\n");\r\nreturn -ENODEV;\r\n}\r\nreturn 0;\r\n}\r\nstatic int wis_ov7640_remove(struct i2c_client *client)\r\n{\r\nreturn 0;\r\n}\r\nstatic int __init wis_ov7640_init(void)\r\n{\r\nreturn i2c_add_driver(&wis_ov7640_driver);\r\n}\r\nstatic void __exit wis_ov7640_cleanup(void)\r\n{\r\ni2c_del_driver(&wis_ov7640_driver);\r\n}
