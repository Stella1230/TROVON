static void ap_cs8427_write_byte(struct snd_ice1712 *ice, unsigned char data, unsigned char tmp)\r\n{\r\nint idx;\r\nfor (idx = 7; idx >= 0; idx--) {\r\ntmp &= ~(ICE1712_DELTA_AP_DOUT|ICE1712_DELTA_AP_CCLK);\r\nif (data & (1 << idx))\r\ntmp |= ICE1712_DELTA_AP_DOUT;\r\nsnd_ice1712_write(ice, ICE1712_IREG_GPIO_DATA, tmp);\r\nudelay(5);\r\ntmp |= ICE1712_DELTA_AP_CCLK;\r\nsnd_ice1712_write(ice, ICE1712_IREG_GPIO_DATA, tmp);\r\nudelay(5);\r\n}\r\n}\r\nstatic unsigned char ap_cs8427_read_byte(struct snd_ice1712 *ice, unsigned char tmp)\r\n{\r\nunsigned char data = 0;\r\nint idx;\r\nfor (idx = 7; idx >= 0; idx--) {\r\ntmp &= ~ICE1712_DELTA_AP_CCLK;\r\nsnd_ice1712_write(ice, ICE1712_IREG_GPIO_DATA, tmp);\r\nudelay(5);\r\nif (snd_ice1712_read(ice, ICE1712_IREG_GPIO_DATA) & ICE1712_DELTA_AP_DIN)\r\ndata |= 1 << idx;\r\ntmp |= ICE1712_DELTA_AP_CCLK;\r\nsnd_ice1712_write(ice, ICE1712_IREG_GPIO_DATA, tmp);\r\nudelay(5);\r\n}\r\nreturn data;\r\n}\r\nstatic unsigned char ap_cs8427_codec_select(struct snd_ice1712 *ice)\r\n{\r\nunsigned char tmp;\r\ntmp = snd_ice1712_read(ice, ICE1712_IREG_GPIO_DATA);\r\nswitch (ice->eeprom.subvendor) {\r\ncase ICE1712_SUBDEVICE_DELTA1010E:\r\ncase ICE1712_SUBDEVICE_DELTA1010LT:\r\ntmp &= ~ICE1712_DELTA_1010LT_CS;\r\ntmp |= ICE1712_DELTA_1010LT_CCLK | ICE1712_DELTA_1010LT_CS_CS8427;\r\nbreak;\r\ncase ICE1712_SUBDEVICE_AUDIOPHILE:\r\ncase ICE1712_SUBDEVICE_DELTA410:\r\ntmp |= ICE1712_DELTA_AP_CCLK | ICE1712_DELTA_AP_CS_CODEC;\r\ntmp &= ~ICE1712_DELTA_AP_CS_DIGITAL;\r\nbreak;\r\ncase ICE1712_SUBDEVICE_DELTA66E:\r\ntmp |= ICE1712_DELTA_66E_CCLK | ICE1712_DELTA_66E_CS_CHIP_A |\r\nICE1712_DELTA_66E_CS_CHIP_B;\r\ntmp &= ~ICE1712_DELTA_66E_CS_CS8427;\r\nbreak;\r\ncase ICE1712_SUBDEVICE_VX442:\r\ntmp |= ICE1712_VX442_CCLK | ICE1712_VX442_CODEC_CHIP_A | ICE1712_VX442_CODEC_CHIP_B;\r\ntmp &= ~ICE1712_VX442_CS_DIGITAL;\r\nbreak;\r\n}\r\nsnd_ice1712_write(ice, ICE1712_IREG_GPIO_DATA, tmp);\r\nudelay(5);\r\nreturn tmp;\r\n}\r\nstatic void ap_cs8427_codec_deassert(struct snd_ice1712 *ice, unsigned char tmp)\r\n{\r\nswitch (ice->eeprom.subvendor) {\r\ncase ICE1712_SUBDEVICE_DELTA1010E:\r\ncase ICE1712_SUBDEVICE_DELTA1010LT:\r\ntmp &= ~ICE1712_DELTA_1010LT_CS;\r\ntmp |= ICE1712_DELTA_1010LT_CS_NONE;\r\nbreak;\r\ncase ICE1712_SUBDEVICE_AUDIOPHILE:\r\ncase ICE1712_SUBDEVICE_DELTA410:\r\ntmp |= ICE1712_DELTA_AP_CS_DIGITAL;\r\nbreak;\r\ncase ICE1712_SUBDEVICE_DELTA66E:\r\ntmp |= ICE1712_DELTA_66E_CS_CS8427;\r\nbreak;\r\ncase ICE1712_SUBDEVICE_VX442:\r\ntmp |= ICE1712_VX442_CS_DIGITAL;\r\nbreak;\r\n}\r\nsnd_ice1712_write(ice, ICE1712_IREG_GPIO_DATA, tmp);\r\n}\r\nstatic int ap_cs8427_sendbytes(struct snd_i2c_device *device, unsigned char *bytes, int count)\r\n{\r\nstruct snd_ice1712 *ice = device->bus->private_data;\r\nint res = count;\r\nunsigned char tmp;\r\nmutex_lock(&ice->gpio_mutex);\r\ntmp = ap_cs8427_codec_select(ice);\r\nap_cs8427_write_byte(ice, (device->addr << 1) | 0, tmp);\r\nwhile (count-- > 0)\r\nap_cs8427_write_byte(ice, *bytes++, tmp);\r\nap_cs8427_codec_deassert(ice, tmp);\r\nmutex_unlock(&ice->gpio_mutex);\r\nreturn res;\r\n}\r\nstatic int ap_cs8427_readbytes(struct snd_i2c_device *device, unsigned char *bytes, int count)\r\n{\r\nstruct snd_ice1712 *ice = device->bus->private_data;\r\nint res = count;\r\nunsigned char tmp;\r\nmutex_lock(&ice->gpio_mutex);\r\ntmp = ap_cs8427_codec_select(ice);\r\nap_cs8427_write_byte(ice, (device->addr << 1) | 1, tmp);\r\nwhile (count-- > 0)\r\n*bytes++ = ap_cs8427_read_byte(ice, tmp);\r\nap_cs8427_codec_deassert(ice, tmp);\r\nmutex_unlock(&ice->gpio_mutex);\r\nreturn res;\r\n}\r\nstatic int ap_cs8427_probeaddr(struct snd_i2c_bus *bus, unsigned short addr)\r\n{\r\nif (addr == 0x10)\r\nreturn 1;\r\nreturn -ENOENT;\r\n}\r\nstatic void snd_ice1712_delta_cs8403_spdif_write(struct snd_ice1712 *ice, unsigned char bits)\r\n{\r\nunsigned char tmp, mask1, mask2;\r\nint idx;\r\nmask1 = ICE1712_DELTA_SPDIF_OUT_STAT_CLOCK;\r\nmask2 = ICE1712_DELTA_SPDIF_OUT_STAT_DATA;\r\nmutex_lock(&ice->gpio_mutex);\r\ntmp = snd_ice1712_read(ice, ICE1712_IREG_GPIO_DATA);\r\nfor (idx = 7; idx >= 0; idx--) {\r\ntmp &= ~(mask1 | mask2);\r\nif (bits & (1 << idx))\r\ntmp |= mask2;\r\nsnd_ice1712_write(ice, ICE1712_IREG_GPIO_DATA, tmp);\r\nudelay(100);\r\ntmp |= mask1;\r\nsnd_ice1712_write(ice, ICE1712_IREG_GPIO_DATA, tmp);\r\nudelay(100);\r\n}\r\ntmp &= ~mask1;\r\nsnd_ice1712_write(ice, ICE1712_IREG_GPIO_DATA, tmp);\r\nmutex_unlock(&ice->gpio_mutex);\r\n}\r\nstatic void delta_spdif_default_get(struct snd_ice1712 *ice, struct snd_ctl_elem_value *ucontrol)\r\n{\r\nsnd_cs8403_decode_spdif_bits(&ucontrol->value.iec958, ice->spdif.cs8403_bits);\r\n}\r\nstatic int delta_spdif_default_put(struct snd_ice1712 *ice, struct snd_ctl_elem_value *ucontrol)\r\n{\r\nunsigned int val;\r\nint change;\r\nval = snd_cs8403_encode_spdif_bits(&ucontrol->value.iec958);\r\nspin_lock_irq(&ice->reg_lock);\r\nchange = ice->spdif.cs8403_bits != val;\r\nice->spdif.cs8403_bits = val;\r\nif (change && ice->playback_pro_substream == NULL) {\r\nspin_unlock_irq(&ice->reg_lock);\r\nsnd_ice1712_delta_cs8403_spdif_write(ice, val);\r\n} else {\r\nspin_unlock_irq(&ice->reg_lock);\r\n}\r\nreturn change;\r\n}\r\nstatic void delta_spdif_stream_get(struct snd_ice1712 *ice, struct snd_ctl_elem_value *ucontrol)\r\n{\r\nsnd_cs8403_decode_spdif_bits(&ucontrol->value.iec958, ice->spdif.cs8403_stream_bits);\r\n}\r\nstatic int delta_spdif_stream_put(struct snd_ice1712 *ice, struct snd_ctl_elem_value *ucontrol)\r\n{\r\nunsigned int val;\r\nint change;\r\nval = snd_cs8403_encode_spdif_bits(&ucontrol->value.iec958);\r\nspin_lock_irq(&ice->reg_lock);\r\nchange = ice->spdif.cs8403_stream_bits != val;\r\nice->spdif.cs8403_stream_bits = val;\r\nif (change && ice->playback_pro_substream != NULL) {\r\nspin_unlock_irq(&ice->reg_lock);\r\nsnd_ice1712_delta_cs8403_spdif_write(ice, val);\r\n} else {\r\nspin_unlock_irq(&ice->reg_lock);\r\n}\r\nreturn change;\r\n}\r\nstatic void delta_ak4524_lock(struct snd_akm4xxx *ak, int chip)\r\n{\r\nstruct snd_ak4xxx_private *priv = (void *)ak->private_value[0];\r\nstruct snd_ice1712 *ice = ak->private_data[0];\r\nsnd_ice1712_save_gpio_status(ice);\r\npriv->cs_mask =\r\npriv->cs_addr = chip == 0 ? ICE1712_DELTA_CODEC_CHIP_A :\r\nICE1712_DELTA_CODEC_CHIP_B;\r\n}\r\nstatic void delta1010lt_ak4524_lock(struct snd_akm4xxx *ak, int chip)\r\n{\r\nstruct snd_ak4xxx_private *priv = (void *)ak->private_value[0];\r\nstruct snd_ice1712 *ice = ak->private_data[0];\r\nsnd_ice1712_save_gpio_status(ice);\r\npriv->cs_mask = ICE1712_DELTA_1010LT_CS;\r\npriv->cs_addr = chip << 4;\r\n}\r\nstatic void delta66e_ak4524_lock(struct snd_akm4xxx *ak, int chip)\r\n{\r\nstruct snd_ak4xxx_private *priv = (void *)ak->private_value[0];\r\nstruct snd_ice1712 *ice = ak->private_data[0];\r\nsnd_ice1712_save_gpio_status(ice);\r\npriv->cs_mask =\r\npriv->cs_addr = chip == 0 ? ICE1712_DELTA_66E_CS_CHIP_A :\r\nICE1712_DELTA_66E_CS_CHIP_B;\r\n}\r\nstatic void vx442_ak4524_lock(struct snd_akm4xxx *ak, int chip)\r\n{\r\nstruct snd_ak4xxx_private *priv = (void *)ak->private_value[0];\r\nstruct snd_ice1712 *ice = ak->private_data[0];\r\nsnd_ice1712_save_gpio_status(ice);\r\npriv->cs_mask =\r\npriv->cs_addr = chip == 0 ? ICE1712_VX442_CODEC_CHIP_A :\r\nICE1712_VX442_CODEC_CHIP_B;\r\n}\r\nstatic void delta_1010_set_rate_val(struct snd_ice1712 *ice, unsigned int rate)\r\n{\r\nunsigned char tmp, tmp2;\r\nif (rate == 0)\r\nreturn;\r\nmutex_lock(&ice->gpio_mutex);\r\ntmp = snd_ice1712_read(ice, ICE1712_IREG_GPIO_DATA);\r\ntmp2 = tmp & ~ICE1712_DELTA_DFS;\r\nif (rate > 48000)\r\ntmp2 |= ICE1712_DELTA_DFS;\r\nif (tmp != tmp2)\r\nsnd_ice1712_write(ice, ICE1712_IREG_GPIO_DATA, tmp2);\r\nmutex_unlock(&ice->gpio_mutex);\r\n}\r\nstatic void delta_ak4524_set_rate_val(struct snd_akm4xxx *ak, unsigned int rate)\r\n{\r\nunsigned char tmp, tmp2;\r\nstruct snd_ice1712 *ice = ak->private_data[0];\r\nif (rate == 0)\r\nreturn;\r\nmutex_lock(&ice->gpio_mutex);\r\ntmp = snd_ice1712_read(ice, ICE1712_IREG_GPIO_DATA);\r\nmutex_unlock(&ice->gpio_mutex);\r\ntmp2 = tmp & ~ICE1712_DELTA_DFS;\r\nif (rate > 48000)\r\ntmp2 |= ICE1712_DELTA_DFS;\r\nif (tmp == tmp2)\r\nreturn;\r\nsnd_akm4xxx_reset(ak, 1);\r\nmutex_lock(&ice->gpio_mutex);\r\ntmp = snd_ice1712_read(ice, ICE1712_IREG_GPIO_DATA) & ~ICE1712_DELTA_DFS;\r\nif (rate > 48000)\r\ntmp |= ICE1712_DELTA_DFS;\r\nsnd_ice1712_write(ice, ICE1712_IREG_GPIO_DATA, tmp);\r\nmutex_unlock(&ice->gpio_mutex);\r\nsnd_akm4xxx_reset(ak, 0);\r\n}\r\nstatic void vx442_ak4524_set_rate_val(struct snd_akm4xxx *ak, unsigned int rate)\r\n{\r\nunsigned char val;\r\nval = (rate > 48000) ? 0x65 : 0x60;\r\nif (snd_akm4xxx_get(ak, 0, 0x02) != val ||\r\nsnd_akm4xxx_get(ak, 1, 0x02) != val) {\r\nsnd_akm4xxx_reset(ak, 1);\r\nsnd_akm4xxx_write(ak, 0, 0x02, val);\r\nsnd_akm4xxx_write(ak, 1, 0x02, val);\r\nsnd_akm4xxx_reset(ak, 0);\r\n}\r\n}\r\nstatic void delta_open_spdif(struct snd_ice1712 *ice, struct snd_pcm_substream *substream)\r\n{\r\nice->spdif.cs8403_stream_bits = ice->spdif.cs8403_bits;\r\n}\r\nstatic void delta_setup_spdif(struct snd_ice1712 *ice, int rate)\r\n{\r\nunsigned long flags;\r\nunsigned int tmp;\r\nint change;\r\nspin_lock_irqsave(&ice->reg_lock, flags);\r\ntmp = ice->spdif.cs8403_stream_bits;\r\nif (tmp & 0x01)\r\ntmp &= (tmp & 0x01) ? ~0x06 : ~0x18;\r\nswitch (rate) {\r\ncase 32000: tmp |= (tmp & 0x01) ? 0x04 : 0x00; break;\r\ncase 44100: tmp |= (tmp & 0x01) ? 0x00 : 0x10; break;\r\ncase 48000: tmp |= (tmp & 0x01) ? 0x02 : 0x08; break;\r\ndefault: tmp |= (tmp & 0x01) ? 0x00 : 0x18; break;\r\n}\r\nchange = ice->spdif.cs8403_stream_bits != tmp;\r\nice->spdif.cs8403_stream_bits = tmp;\r\nspin_unlock_irqrestore(&ice->reg_lock, flags);\r\nif (change)\r\nsnd_ctl_notify(ice->card, SNDRV_CTL_EVENT_MASK_VALUE, &ice->spdif.stream_ctl->id);\r\nsnd_ice1712_delta_cs8403_spdif_write(ice, tmp);\r\n}\r\nstatic int snd_ice1712_delta1010lt_wordclock_status_get(struct snd_kcontrol *kcontrol,\r\nstruct snd_ctl_elem_value *ucontrol)\r\n{\r\nchar reg = 0x10;\r\nstruct snd_ice1712 *ice = snd_kcontrol_chip(kcontrol);\r\nif (snd_i2c_sendbytes(ice->cs8427, &reg, 1) != 1)\r\nsnd_printk(KERN_ERR "unable to send register 0x%x byte to CS8427\n", reg);\r\nsnd_i2c_readbytes(ice->cs8427, &reg, 1);\r\nucontrol->value.integer.value[0] = (reg & CS8427_UNLOCK) ? 1 : 0;\r\nreturn 0;\r\n}\r\nstatic int __devinit snd_ice1712_delta_init(struct snd_ice1712 *ice)\r\n{\r\nint err;\r\nstruct snd_akm4xxx *ak;\r\nunsigned char tmp;\r\nif (ice->eeprom.subvendor == ICE1712_SUBDEVICE_DELTA1010 &&\r\nice->eeprom.gpiodir == 0x7b)\r\nice->eeprom.subvendor = ICE1712_SUBDEVICE_DELTA1010E;\r\nif (ice->eeprom.subvendor == ICE1712_SUBDEVICE_DELTA66 &&\r\nice->eeprom.gpiodir == 0xfb)\r\nice->eeprom.subvendor = ICE1712_SUBDEVICE_DELTA66E;\r\nswitch (ice->eeprom.subvendor) {\r\ncase ICE1712_SUBDEVICE_AUDIOPHILE:\r\nice->num_total_dacs = 2;\r\nice->num_total_adcs = 2;\r\nbreak;\r\ncase ICE1712_SUBDEVICE_DELTA410:\r\nice->num_total_dacs = 8;\r\nice->num_total_adcs = 2;\r\nbreak;\r\ncase ICE1712_SUBDEVICE_DELTA44:\r\ncase ICE1712_SUBDEVICE_DELTA66:\r\nice->num_total_dacs = ice->omni ? 8 : 4;\r\nice->num_total_adcs = ice->omni ? 8 : 4;\r\nbreak;\r\ncase ICE1712_SUBDEVICE_DELTA1010:\r\ncase ICE1712_SUBDEVICE_DELTA1010E:\r\ncase ICE1712_SUBDEVICE_DELTA1010LT:\r\ncase ICE1712_SUBDEVICE_MEDIASTATION:\r\ncase ICE1712_SUBDEVICE_EDIROLDA2496:\r\nice->num_total_dacs = 8;\r\nice->num_total_adcs = 8;\r\nbreak;\r\ncase ICE1712_SUBDEVICE_DELTADIO2496:\r\nice->num_total_dacs = 4;\r\nbreak;\r\ncase ICE1712_SUBDEVICE_VX442:\r\ncase ICE1712_SUBDEVICE_DELTA66E:\r\nice->num_total_dacs = 4;\r\nice->num_total_adcs = 4;\r\nbreak;\r\n}\r\ntmp = snd_ice1712_read(ice, ICE1712_IREG_GPIO_DATA);\r\ntmp |= ICE1712_DELTA_AP_CCLK;\r\nsnd_ice1712_write(ice, ICE1712_IREG_GPIO_DATA, tmp);\r\nudelay(5);\r\nswitch (ice->eeprom.subvendor) {\r\ncase ICE1712_SUBDEVICE_AUDIOPHILE:\r\ncase ICE1712_SUBDEVICE_DELTA410:\r\ncase ICE1712_SUBDEVICE_DELTA1010E:\r\ncase ICE1712_SUBDEVICE_DELTA1010LT:\r\ncase ICE1712_SUBDEVICE_VX442:\r\ncase ICE1712_SUBDEVICE_DELTA66E:\r\nif ((err = snd_i2c_bus_create(ice->card, "ICE1712 GPIO 1", NULL, &ice->i2c)) < 0) {\r\nsnd_printk(KERN_ERR "unable to create I2C bus\n");\r\nreturn err;\r\n}\r\nice->i2c->private_data = ice;\r\nice->i2c->ops = &ap_cs8427_i2c_ops;\r\nif ((err = snd_ice1712_init_cs8427(ice, CS8427_BASE_ADDR)) < 0)\r\nreturn err;\r\nbreak;\r\ncase ICE1712_SUBDEVICE_DELTA1010:\r\ncase ICE1712_SUBDEVICE_MEDIASTATION:\r\nice->gpio.set_pro_rate = delta_1010_set_rate_val;\r\nbreak;\r\ncase ICE1712_SUBDEVICE_DELTADIO2496:\r\nice->gpio.set_pro_rate = delta_1010_set_rate_val;\r\ncase ICE1712_SUBDEVICE_DELTA66:\r\nice->spdif.ops.open = delta_open_spdif;\r\nice->spdif.ops.setup_rate = delta_setup_spdif;\r\nice->spdif.ops.default_get = delta_spdif_default_get;\r\nice->spdif.ops.default_put = delta_spdif_default_put;\r\nice->spdif.ops.stream_get = delta_spdif_stream_get;\r\nice->spdif.ops.stream_put = delta_spdif_stream_put;\r\nsnd_ice1712_delta_cs8403_spdif_write(ice, ice->spdif.cs8403_bits);\r\nbreak;\r\n}\r\nswitch (ice->eeprom.subvendor) {\r\ncase ICE1712_SUBDEVICE_DELTA1010:\r\ncase ICE1712_SUBDEVICE_DELTA1010E:\r\ncase ICE1712_SUBDEVICE_DELTADIO2496:\r\ncase ICE1712_SUBDEVICE_MEDIASTATION:\r\nreturn 0;\r\n}\r\nak = ice->akm = kmalloc(sizeof(struct snd_akm4xxx), GFP_KERNEL);\r\nif (! ak)\r\nreturn -ENOMEM;\r\nice->akm_codecs = 1;\r\nswitch (ice->eeprom.subvendor) {\r\ncase ICE1712_SUBDEVICE_AUDIOPHILE:\r\nerr = snd_ice1712_akm4xxx_init(ak, &akm_audiophile, &akm_audiophile_priv, ice);\r\nbreak;\r\ncase ICE1712_SUBDEVICE_DELTA410:\r\nerr = snd_ice1712_akm4xxx_init(ak, &akm_delta410, &akm_delta410_priv, ice);\r\nbreak;\r\ncase ICE1712_SUBDEVICE_DELTA1010LT:\r\ncase ICE1712_SUBDEVICE_EDIROLDA2496:\r\nerr = snd_ice1712_akm4xxx_init(ak, &akm_delta1010lt, &akm_delta1010lt_priv, ice);\r\nbreak;\r\ncase ICE1712_SUBDEVICE_DELTA66:\r\ncase ICE1712_SUBDEVICE_DELTA44:\r\nerr = snd_ice1712_akm4xxx_init(ak, &akm_delta44, &akm_delta44_priv, ice);\r\nbreak;\r\ncase ICE1712_SUBDEVICE_VX442:\r\nerr = snd_ice1712_akm4xxx_init(ak, &akm_vx442, &akm_vx442_priv, ice);\r\nbreak;\r\ncase ICE1712_SUBDEVICE_DELTA66E:\r\nerr = snd_ice1712_akm4xxx_init(ak, &akm_delta66e, &akm_delta66e_priv, ice);\r\nbreak;\r\ndefault:\r\nsnd_BUG();\r\nreturn -EINVAL;\r\n}\r\nreturn err;\r\n}\r\nstatic int __devinit snd_ice1712_delta_add_controls(struct snd_ice1712 *ice)\r\n{\r\nint err;\r\nswitch (ice->eeprom.subvendor) {\r\ncase ICE1712_SUBDEVICE_DELTA1010:\r\ncase ICE1712_SUBDEVICE_MEDIASTATION:\r\nerr = snd_ctl_add(ice->card, snd_ctl_new1(&snd_ice1712_delta1010_wordclock_select, ice));\r\nif (err < 0)\r\nreturn err;\r\nerr = snd_ctl_add(ice->card, snd_ctl_new1(&snd_ice1712_delta1010_wordclock_status, ice));\r\nif (err < 0)\r\nreturn err;\r\nbreak;\r\ncase ICE1712_SUBDEVICE_DELTADIO2496:\r\nerr = snd_ctl_add(ice->card, snd_ctl_new1(&snd_ice1712_deltadio2496_spdif_in_select, ice));\r\nif (err < 0)\r\nreturn err;\r\nbreak;\r\ncase ICE1712_SUBDEVICE_DELTA1010E:\r\ncase ICE1712_SUBDEVICE_DELTA1010LT:\r\nerr = snd_ctl_add(ice->card, snd_ctl_new1(&snd_ice1712_delta1010lt_wordclock_select, ice));\r\nif (err < 0)\r\nreturn err;\r\nerr = snd_ctl_add(ice->card, snd_ctl_new1(&snd_ice1712_delta1010lt_wordclock_status, ice));\r\nif (err < 0)\r\nreturn err;\r\nbreak;\r\n}\r\nswitch (ice->eeprom.subvendor) {\r\ncase ICE1712_SUBDEVICE_DELTA1010:\r\ncase ICE1712_SUBDEVICE_DELTADIO2496:\r\ncase ICE1712_SUBDEVICE_DELTA66:\r\ncase ICE1712_SUBDEVICE_MEDIASTATION:\r\nerr = snd_ice1712_spdif_build_controls(ice);\r\nif (err < 0)\r\nreturn err;\r\nbreak;\r\n}\r\nswitch (ice->eeprom.subvendor) {\r\ncase ICE1712_SUBDEVICE_DELTA1010:\r\ncase ICE1712_SUBDEVICE_DELTADIO2496:\r\ncase ICE1712_SUBDEVICE_DELTA66:\r\ncase ICE1712_SUBDEVICE_MEDIASTATION:\r\nerr = snd_ctl_add(ice->card, snd_ctl_new1(&snd_ice1712_delta_spdif_in_status, ice));\r\nif (err < 0)\r\nreturn err;\r\nbreak;\r\n}\r\nswitch (ice->eeprom.subvendor) {\r\ncase ICE1712_SUBDEVICE_DELTA1010LT:\r\ncase ICE1712_SUBDEVICE_AUDIOPHILE:\r\ncase ICE1712_SUBDEVICE_DELTA410:\r\ncase ICE1712_SUBDEVICE_DELTA44:\r\ncase ICE1712_SUBDEVICE_DELTA66:\r\ncase ICE1712_SUBDEVICE_VX442:\r\ncase ICE1712_SUBDEVICE_DELTA66E:\r\ncase ICE1712_SUBDEVICE_EDIROLDA2496:\r\nerr = snd_ice1712_akm4xxx_build_controls(ice);\r\nif (err < 0)\r\nreturn err;\r\nbreak;\r\n}\r\nreturn 0;\r\n}
