char * __init\r\nprom_getbootargs(void)\r\n{\r\nint iter;\r\nchar *cp, *arg;\r\nif (fetched) {\r\nreturn barg_buf;\r\n}\r\nswitch(prom_vers) {\r\ncase PROM_V0:\r\ncp = barg_buf;\r\nfor(iter = 1; iter < 8; iter++) {\r\narg = (*(romvec->pv_v0bootargs))->argv[iter];\r\nif (arg == NULL)\r\nbreak;\r\nwhile(*arg != 0) {\r\nif(cp >= barg_buf + BARG_LEN-2){\r\nbreak;\r\n}\r\n*cp++ = *arg++;\r\n}\r\n*cp++ = ' ';\r\n}\r\n*cp = 0;\r\nbreak;\r\ncase PROM_V2:\r\ncase PROM_V3:\r\nstrlcpy(barg_buf, *romvec->pv_v2bootargs.bootargs, sizeof(barg_buf));\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nfetched = 1;\r\nreturn barg_buf;\r\n}
