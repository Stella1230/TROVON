static void __init\r\nsx164_init_irq(void)\r\n{\r\noutb(0, DMA1_RESET_REG);\r\noutb(0, DMA2_RESET_REG);\r\noutb(DMA_MODE_CASCADE, DMA2_MODE_REG);\r\noutb(0, DMA2_MASK_REG);\r\nif (alpha_using_srm)\r\nalpha_mv.device_interrupt = srm_device_interrupt;\r\ninit_i8259a_irqs();\r\nif (alpha_using_srm)\r\ninit_srm_irqs(40, 0x3f0000);\r\nelse\r\ninit_pyxis_irqs(0xff00003f0000UL);\r\nsetup_irq(16+6, &timer_cascade_irqaction);\r\n}\r\nstatic int __init\r\nsx164_map_irq(const struct pci_dev *dev, u8 slot, u8 pin)\r\n{\r\nstatic char irq_tab[5][5] __initdata = {\r\n{ 16+ 9, 16+ 9, 16+13, 16+17, 16+21},\r\n{ 16+11, 16+11, 16+15, 16+19, 16+23},\r\n{ 16+10, 16+10, 16+14, 16+18, 16+22},\r\n{ -1, -1, -1, -1, -1},\r\n{ 16+ 8, 16+ 8, 16+12, 16+16, 16+20}\r\n};\r\nconst long min_idsel = 5, max_idsel = 9, irqs_per_slot = 5;\r\nreturn COMMON_TABLE_LOOKUP;\r\n}\r\nstatic void __init\r\nsx164_init_pci(void)\r\n{\r\ncia_init_pci();\r\nSMC669_Init(0);\r\n}\r\nstatic void __init\r\nsx164_init_arch(void)\r\n{\r\nstruct percpu_struct *cpu = (struct percpu_struct*)\r\n((char*)hwrpb + hwrpb->processor_offset);\r\nif (amask(AMASK_MAX) != 0\r\n&& alpha_using_srm\r\n&& (cpu->pal_revision & 0xffff) <= 0x117) {\r\n__asm__ __volatile__(\r\n"lda $16,8($31)\n"\r\n"call_pal 9\n"\r\n".long 0x64000118\n\n"\r\n"ldah $16,(1<<(19-16))($31)\n"\r\n"or $0,$16,$0\n"\r\n".long 0x74000118\n"\r\n"lda $16,9($31)\n"\r\n"call_pal 9"\r\n: : : "$0", "$16");\r\nprintk("PCA56 MVI set enabled\n");\r\n}\r\npyxis_init_arch();\r\n}
