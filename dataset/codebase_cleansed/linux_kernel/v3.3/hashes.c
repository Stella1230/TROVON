u32 keyed_hash(const signed char *msg, int len)\r\n{\r\nu32 k[] = { 0x9464a485, 0x542e1a94, 0x3e846bff, 0xb75bcfc3 };\r\nu32 h0 = k[0], h1 = k[1];\r\nu32 a, b, c, d;\r\nu32 pad;\r\nint i;\r\npad = (u32) len | ((u32) len << 8);\r\npad |= pad << 16;\r\nwhile (len >= 16) {\r\na = (u32) msg[0] |\r\n(u32) msg[1] << 8 | (u32) msg[2] << 16 | (u32) msg[3] << 24;\r\nb = (u32) msg[4] |\r\n(u32) msg[5] << 8 | (u32) msg[6] << 16 | (u32) msg[7] << 24;\r\nc = (u32) msg[8] |\r\n(u32) msg[9] << 8 |\r\n(u32) msg[10] << 16 | (u32) msg[11] << 24;\r\nd = (u32) msg[12] |\r\n(u32) msg[13] << 8 |\r\n(u32) msg[14] << 16 | (u32) msg[15] << 24;\r\nTEACORE(PARTROUNDS);\r\nlen -= 16;\r\nmsg += 16;\r\n}\r\nif (len >= 12) {\r\na = (u32) msg[0] |\r\n(u32) msg[1] << 8 | (u32) msg[2] << 16 | (u32) msg[3] << 24;\r\nb = (u32) msg[4] |\r\n(u32) msg[5] << 8 | (u32) msg[6] << 16 | (u32) msg[7] << 24;\r\nc = (u32) msg[8] |\r\n(u32) msg[9] << 8 |\r\n(u32) msg[10] << 16 | (u32) msg[11] << 24;\r\nd = pad;\r\nfor (i = 12; i < len; i++) {\r\nd <<= 8;\r\nd |= msg[i];\r\n}\r\n} else if (len >= 8) {\r\na = (u32) msg[0] |\r\n(u32) msg[1] << 8 | (u32) msg[2] << 16 | (u32) msg[3] << 24;\r\nb = (u32) msg[4] |\r\n(u32) msg[5] << 8 | (u32) msg[6] << 16 | (u32) msg[7] << 24;\r\nc = d = pad;\r\nfor (i = 8; i < len; i++) {\r\nc <<= 8;\r\nc |= msg[i];\r\n}\r\n} else if (len >= 4) {\r\na = (u32) msg[0] |\r\n(u32) msg[1] << 8 | (u32) msg[2] << 16 | (u32) msg[3] << 24;\r\nb = c = d = pad;\r\nfor (i = 4; i < len; i++) {\r\nb <<= 8;\r\nb |= msg[i];\r\n}\r\n} else {\r\na = b = c = d = pad;\r\nfor (i = 0; i < len; i++) {\r\na <<= 8;\r\na |= msg[i];\r\n}\r\n}\r\nTEACORE(FULLROUNDS);\r\nreturn h0 ^ h1;\r\n}\r\nu32 yura_hash(const signed char *msg, int len)\r\n{\r\nint j, pow;\r\nu32 a, c;\r\nint i;\r\nfor (pow = 1, i = 1; i < len; i++)\r\npow = pow * 10;\r\nif (len == 1)\r\na = msg[0] - 48;\r\nelse\r\na = (msg[0] - 48) * pow;\r\nfor (i = 1; i < len; i++) {\r\nc = msg[i] - 48;\r\nfor (pow = 1, j = i; j < len - 1; j++)\r\npow = pow * 10;\r\na = a + c * pow;\r\n}\r\nfor (; i < 40; i++) {\r\nc = '0' - 48;\r\nfor (pow = 1, j = i; j < len - 1; j++)\r\npow = pow * 10;\r\na = a + c * pow;\r\n}\r\nfor (; i < 256; i++) {\r\nc = i;\r\nfor (pow = 1, j = i; j < len - 1; j++)\r\npow = pow * 10;\r\na = a + c * pow;\r\n}\r\na = a << 7;\r\nreturn a;\r\n}\r\nu32 r5_hash(const signed char *msg, int len)\r\n{\r\nu32 a = 0;\r\nwhile (*msg) {\r\na += *msg << 4;\r\na += *msg >> 4;\r\na *= 11;\r\nmsg++;\r\n}\r\nreturn a;\r\n}
