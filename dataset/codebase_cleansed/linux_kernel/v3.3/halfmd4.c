__u32 half_md4_transform(__u32 buf[4], __u32 const in[8])\r\n{\r\n__u32 a = buf[0], b = buf[1], c = buf[2], d = buf[3];\r\nROUND(F, a, b, c, d, in[0] + K1, 3);\r\nROUND(F, d, a, b, c, in[1] + K1, 7);\r\nROUND(F, c, d, a, b, in[2] + K1, 11);\r\nROUND(F, b, c, d, a, in[3] + K1, 19);\r\nROUND(F, a, b, c, d, in[4] + K1, 3);\r\nROUND(F, d, a, b, c, in[5] + K1, 7);\r\nROUND(F, c, d, a, b, in[6] + K1, 11);\r\nROUND(F, b, c, d, a, in[7] + K1, 19);\r\nROUND(G, a, b, c, d, in[1] + K2, 3);\r\nROUND(G, d, a, b, c, in[3] + K2, 5);\r\nROUND(G, c, d, a, b, in[5] + K2, 9);\r\nROUND(G, b, c, d, a, in[7] + K2, 13);\r\nROUND(G, a, b, c, d, in[0] + K2, 3);\r\nROUND(G, d, a, b, c, in[2] + K2, 5);\r\nROUND(G, c, d, a, b, in[4] + K2, 9);\r\nROUND(G, b, c, d, a, in[6] + K2, 13);\r\nROUND(H, a, b, c, d, in[3] + K3, 3);\r\nROUND(H, d, a, b, c, in[7] + K3, 9);\r\nROUND(H, c, d, a, b, in[2] + K3, 11);\r\nROUND(H, b, c, d, a, in[6] + K3, 15);\r\nROUND(H, a, b, c, d, in[1] + K3, 3);\r\nROUND(H, d, a, b, c, in[5] + K3, 9);\r\nROUND(H, c, d, a, b, in[0] + K3, 11);\r\nROUND(H, b, c, d, a, in[4] + K3, 15);\r\nbuf[0] += a;\r\nbuf[1] += b;\r\nbuf[2] += c;\r\nbuf[3] += d;\r\nreturn buf[1];\r\n}
