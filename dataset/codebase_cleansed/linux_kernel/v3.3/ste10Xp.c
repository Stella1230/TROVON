static int ste10Xp_config_init(struct phy_device *phydev)\r\n{\r\nint value, err;\r\nvalue = phy_read(phydev, MII_BMCR);\r\nif (value < 0)\r\nreturn value;\r\nvalue |= BMCR_RESET;\r\nerr = phy_write(phydev, MII_BMCR, value);\r\nif (err < 0)\r\nreturn err;\r\ndo {\r\nvalue = phy_read(phydev, MII_BMCR);\r\n} while (value & BMCR_RESET);\r\nreturn 0;\r\n}\r\nstatic int ste10Xp_config_intr(struct phy_device *phydev)\r\n{\r\nint err, value;\r\nif (phydev->interrupts == PHY_INTERRUPT_ENABLED) {\r\nerr = phy_write(phydev, MII_XIE, MII_XIE_DEFAULT_MASK);\r\nif (err == 0) {\r\nvalue = phy_read(phydev, MII_XCIIS);\r\nif (value < 0)\r\nerr = value;\r\n}\r\n} else\r\nerr = phy_write(phydev, MII_XIE, 0);\r\nreturn err;\r\n}\r\nstatic int ste10Xp_ack_interrupt(struct phy_device *phydev)\r\n{\r\nint err = phy_read(phydev, MII_XCIIS);\r\nif (err < 0)\r\nreturn err;\r\nreturn 0;\r\n}\r\nstatic int __init ste10Xp_init(void)\r\n{\r\nint retval;\r\nretval = phy_driver_register(&ste100p_pdriver);\r\nif (retval < 0)\r\nreturn retval;\r\nreturn phy_driver_register(&ste101p_pdriver);\r\n}\r\nstatic void __exit ste10Xp_exit(void)\r\n{\r\nphy_driver_unregister(&ste100p_pdriver);\r\nphy_driver_unregister(&ste101p_pdriver);\r\n}
