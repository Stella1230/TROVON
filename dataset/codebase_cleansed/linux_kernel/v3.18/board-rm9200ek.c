static void __init ek_init_early(void)\r\n{\r\nat91_initialize(18432000);\r\n}\r\nstatic void __init ek_board_init(void)\r\n{\r\nat91_register_uart(0, 0, 0);\r\nat91_register_uart(AT91RM9200_ID_US1, 1, ATMEL_UART_CTS | ATMEL_UART_RTS\r\n| ATMEL_UART_DTR | ATMEL_UART_DSR | ATMEL_UART_DCD\r\n| ATMEL_UART_RI);\r\nat91_add_device_serial();\r\nat91_add_device_eth(&ek_eth_data);\r\nat91_add_device_usbh(&ek_usbh_data);\r\nat91_add_device_udc(&ek_udc_data);\r\nat91_set_multi_drive(ek_udc_data.pullup_pin, 1);\r\nat91_add_device_i2c(ek_i2c_devices, ARRAY_SIZE(ek_i2c_devices));\r\nat91_add_device_spi(ek_spi_devices, ARRAY_SIZE(ek_spi_devices));\r\n#ifdef CONFIG_MTD_AT91_DATAFLASH_CARD\r\nat91_set_gpio_output(AT91_PIN_PB22, 0);\r\n#else\r\nat91_set_gpio_output(AT91_PIN_PB22, 1);\r\nat91_add_device_mci(0, &ek_mci0_data);\r\n#endif\r\nplatform_device_register(&ek_flash);\r\nat91_gpio_leds(ek_leds, ARRAY_SIZE(ek_leds));\r\n}
