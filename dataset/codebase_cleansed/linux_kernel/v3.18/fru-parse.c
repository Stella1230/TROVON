static struct fru_type_length *\r\n__fru_get_board_tl(struct fru_common_header *header, int nr)\r\n{\r\nstruct fru_board_info_area *bia;\r\nstruct fru_type_length *tl;\r\nbia = fru_get_board_area(header);\r\ntl = bia->tl;\r\nwhile (nr > 0 && !fru_is_eof(tl)) {\r\ntl = fru_next_tl(tl);\r\nnr--;\r\n}\r\nif (fru_is_eof(tl))\r\nreturn NULL;\r\nreturn tl;\r\n}\r\nstatic char *__fru_alloc_get_tl(struct fru_common_header *header, int nr)\r\n{\r\nstruct fru_type_length *tl;\r\nchar *res;\r\nint len;\r\ntl = __fru_get_board_tl(header, nr);\r\nif (!tl)\r\nreturn NULL;\r\nlen = fru_strlen(tl);\r\nres = fru_alloc(fru_strlen(tl) + 1);\r\nif (!res)\r\nreturn NULL;\r\nreturn fru_strcpy(res, tl);\r\n}\r\nint fru_header_cksum_ok(struct fru_common_header *header)\r\n{\r\nuint8_t *ptr = (void *)header;\r\nint i, sum;\r\nfor (i = sum = 0; i < sizeof(*header); i++)\r\nsum += ptr[i];\r\nreturn (sum & 0xff) == 0;\r\n}\r\nint fru_bia_cksum_ok(struct fru_board_info_area *bia)\r\n{\r\nuint8_t *ptr = (void *)bia;\r\nint i, sum;\r\nfor (i = sum = 0; i < 8 * bia->area_len; i++)\r\nsum += ptr[i];\r\nreturn (sum & 0xff) == 0;\r\n}\r\nchar *fru_get_board_manufacturer(struct fru_common_header *header)\r\n{\r\nreturn __fru_alloc_get_tl(header, 0);\r\n}\r\nchar *fru_get_product_name(struct fru_common_header *header)\r\n{\r\nreturn __fru_alloc_get_tl(header, 1);\r\n}\r\nchar *fru_get_serial_number(struct fru_common_header *header)\r\n{\r\nreturn __fru_alloc_get_tl(header, 2);\r\n}\r\nchar *fru_get_part_number(struct fru_common_header *header)\r\n{\r\nreturn __fru_alloc_get_tl(header, 3);\r\n}
