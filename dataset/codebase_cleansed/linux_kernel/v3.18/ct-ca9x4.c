static void __init ct_ca9x4_map_io(void)\r\n{\r\niotable_init(ct_ca9x4_io_desc, ARRAY_SIZE(ct_ca9x4_io_desc));\r\n}\r\nstatic void __init ca9x4_l2_init(void)\r\n{\r\n#ifdef CONFIG_CACHE_L2X0\r\nvoid __iomem *l2x0_base = ioremap(CT_CA9X4_L2CC, SZ_4K);\r\nif (l2x0_base) {\r\nwritel(0, l2x0_base + L310_TAG_LATENCY_CTRL);\r\nwritel(0, l2x0_base + L310_DATA_LATENCY_CTRL);\r\nl2x0_init(l2x0_base, 0x00400000, 0xfe0fffff);\r\n} else {\r\npr_err("L2C: unable to map L2 cache controller\n");\r\n}\r\n#endif\r\n}\r\nstatic void __init ca9x4_twd_init(void)\r\n{\r\nint err = twd_local_timer_register(&twd_local_timer);\r\nif (err)\r\npr_err("twd_local_timer_register failed %d\n", err);\r\n}\r\nstatic void __init ct_ca9x4_init_irq(void)\r\n{\r\ngic_init(0, 29, ioremap(A9_MPCORE_GIC_DIST, SZ_4K),\r\nioremap(A9_MPCORE_GIC_CPU, SZ_256));\r\nca9x4_twd_init();\r\nca9x4_l2_init();\r\n}\r\nstatic int ct_ca9x4_clcd_setup(struct clcd_fb *fb)\r\n{\r\nunsigned long framesize = 1024 * 768 * 2;\r\nfb->panel = versatile_clcd_get_panel("XVGA");\r\nif (!fb->panel)\r\nreturn -EINVAL;\r\nreturn versatile_clcd_setup_dma(fb, framesize);\r\n}\r\nstatic void __init ct_ca9x4_init(void)\r\n{\r\nint i;\r\nfor (i = 0; i < ARRAY_SIZE(ct_ca9x4_amba_devs); i++)\r\namba_device_register(ct_ca9x4_amba_devs[i], &iomem_resource);\r\nplatform_device_register(&pmu_device);\r\nvexpress_syscfg_device_register(&osc1_device);\r\n}\r\nstatic void __init ct_ca9x4_init_cpu_map(void)\r\n{\r\nint i, ncores;\r\nct_ca9x4_scu_base = ioremap(A9_MPCORE_SCU, SZ_128);\r\nif (WARN_ON(!ct_ca9x4_scu_base))\r\nreturn;\r\nncores = scu_get_core_count(ct_ca9x4_scu_base);\r\nif (ncores > nr_cpu_ids) {\r\npr_warn("SMP: %u cores greater than maximum (%u), clipping\n",\r\nncores, nr_cpu_ids);\r\nncores = nr_cpu_ids;\r\n}\r\nfor (i = 0; i < ncores; ++i)\r\nset_cpu_possible(i, true);\r\n}\r\nstatic void __init ct_ca9x4_smp_enable(unsigned int max_cpus)\r\n{\r\nscu_enable(ct_ca9x4_scu_base);\r\n}
