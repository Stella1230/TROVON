static int mac802154_mlme_start_req(struct net_device *dev,\r\nstruct ieee802154_addr *addr,\r\nu8 channel, u8 page,\r\nu8 bcn_ord, u8 sf_ord,\r\nu8 pan_coord, u8 blx,\r\nu8 coord_realign)\r\n{\r\nstruct ieee802154_mlme_ops *ops = ieee802154_mlme_ops(dev);\r\nint rc = 0;\r\nBUG_ON(addr->mode != IEEE802154_ADDR_SHORT);\r\nmac802154_dev_set_pan_id(dev, addr->pan_id);\r\nmac802154_dev_set_short_addr(dev, addr->short_addr);\r\nmac802154_dev_set_ieee_addr(dev);\r\nmac802154_dev_set_page_channel(dev, page, channel);\r\nif (ops->llsec) {\r\nstruct ieee802154_llsec_params params;\r\nint changed = 0;\r\nparams.coord_shortaddr = addr->short_addr;\r\nchanged |= IEEE802154_LLSEC_PARAM_COORD_SHORTADDR;\r\nparams.pan_id = addr->pan_id;\r\nchanged |= IEEE802154_LLSEC_PARAM_PAN_ID;\r\nparams.hwaddr = ieee802154_devaddr_from_raw(dev->dev_addr);\r\nchanged |= IEEE802154_LLSEC_PARAM_HWADDR;\r\nparams.coord_hwaddr = params.hwaddr;\r\nchanged |= IEEE802154_LLSEC_PARAM_COORD_HWADDR;\r\nrc = ops->llsec->set_params(dev, &params, changed);\r\n}\r\nieee802154_nl_start_confirm(dev, IEEE802154_SUCCESS);\r\nreturn rc;\r\n}\r\nstatic struct wpan_phy *mac802154_get_phy(const struct net_device *dev)\r\n{\r\nstruct mac802154_sub_if_data *priv = netdev_priv(dev);\r\nBUG_ON(dev->type != ARPHRD_IEEE802154);\r\nreturn to_phy(get_device(&priv->hw->phy->dev));\r\n}
