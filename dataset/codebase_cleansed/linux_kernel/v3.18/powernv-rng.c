static int powernv_rng_read(struct hwrng *rng, void *data, size_t max, bool wait)\r\n{\r\nunsigned long *buf;\r\nint i, len;\r\nlen = max / sizeof(unsigned long);\r\nbuf = (unsigned long *)data;\r\nfor (i = 0; i < len; i++)\r\npowernv_get_random_long(buf++);\r\nreturn len * sizeof(unsigned long);\r\n}\r\nstatic int powernv_rng_remove(struct platform_device *pdev)\r\n{\r\nhwrng_unregister(&powernv_hwrng);\r\nreturn 0;\r\n}\r\nstatic int powernv_rng_probe(struct platform_device *pdev)\r\n{\r\nint rc;\r\nrc = hwrng_register(&powernv_hwrng);\r\nif (rc) {\r\nif (rc == -EEXIST)\r\nrc = -ENODEV;\r\nreturn rc;\r\n}\r\npr_info("Registered powernv hwrng.\n");\r\nreturn 0;\r\n}
