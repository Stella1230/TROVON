void show_regs(struct pt_regs *regs)\r\n{\r\nprintk("\n");\r\nprint_modules();\r\nprintk(KERN_INFO "Pid: %d, comm: %.20s %s %s\n", task_pid_nr(current),\r\ncurrent->comm, print_tainted(), init_utsname()->release);\r\nprintk(KERN_INFO "RIP: %04lx:[<%016lx>]\n", PT_REGS_CS(regs) & 0xffff,\r\nPT_REGS_IP(regs));\r\nprintk(KERN_INFO "RSP: %016lx EFLAGS: %08lx\n", PT_REGS_SP(regs),\r\nPT_REGS_EFLAGS(regs));\r\nprintk(KERN_INFO "RAX: %016lx RBX: %016lx RCX: %016lx\n",\r\nPT_REGS_AX(regs), PT_REGS_BX(regs), PT_REGS_CX(regs));\r\nprintk(KERN_INFO "RDX: %016lx RSI: %016lx RDI: %016lx\n",\r\nPT_REGS_DX(regs), PT_REGS_SI(regs), PT_REGS_DI(regs));\r\nprintk(KERN_INFO "RBP: %016lx R08: %016lx R09: %016lx\n",\r\nPT_REGS_BP(regs), PT_REGS_R8(regs), PT_REGS_R9(regs));\r\nprintk(KERN_INFO "R10: %016lx R11: %016lx R12: %016lx\n",\r\nPT_REGS_R10(regs), PT_REGS_R11(regs), PT_REGS_R12(regs));\r\nprintk(KERN_INFO "R13: %016lx R14: %016lx R15: %016lx\n",\r\nPT_REGS_R13(regs), PT_REGS_R14(regs), PT_REGS_R15(regs));\r\n}
