static int\r\nperf_evsel__apply_drv_configs(struct perf_evsel *evsel,\r\nstruct perf_evsel_config_term **err_term)\r\n{\r\nbool found = false;\r\nint err = 0;\r\nstruct perf_evsel_config_term *term;\r\nstruct perf_pmu *pmu = NULL;\r\nwhile ((pmu = perf_pmu__scan(pmu)) != NULL)\r\nif (pmu->type == evsel->attr.type) {\r\nfound = true;\r\nbreak;\r\n}\r\nlist_for_each_entry(term, &evsel->config_terms, list) {\r\nif (term->type != PERF_EVSEL__CONFIG_TERM_DRV_CFG)\r\ncontinue;\r\nif (!found || !pmu->set_drv_config) {\r\nerr = -EINVAL;\r\n*err_term = term;\r\nbreak;\r\n}\r\nerr = pmu->set_drv_config(term);\r\nif (err) {\r\n*err_term = term;\r\nbreak;\r\n}\r\n}\r\nreturn err;\r\n}\r\nint perf_evlist__apply_drv_configs(struct perf_evlist *evlist,\r\nstruct perf_evsel **err_evsel,\r\nstruct perf_evsel_config_term **err_term)\r\n{\r\nstruct perf_evsel *evsel;\r\nint err = 0;\r\nevlist__for_each_entry(evlist, evsel) {\r\nerr = perf_evsel__apply_drv_configs(evsel, err_term);\r\nif (err) {\r\n*err_evsel = evsel;\r\nbreak;\r\n}\r\n}\r\nreturn err;\r\n}
