void mdiobus_setup_mdiodev_from_board_info(struct mii_bus *bus,\r\nint (*cb)\r\n(struct mii_bus *bus,\r\nstruct mdio_board_info *bi))\r\n{\r\nstruct mdio_board_entry *be;\r\nstruct mdio_board_info *bi;\r\nint ret;\r\nmutex_lock(&mdio_board_lock);\r\nlist_for_each_entry(be, &mdio_board_list, list) {\r\nbi = &be->board_info;\r\nif (strcmp(bus->id, bi->bus_id))\r\ncontinue;\r\nret = cb(bus, bi);\r\nif (ret)\r\ncontinue;\r\n}\r\nmutex_unlock(&mdio_board_lock);\r\n}\r\nint mdiobus_register_board_info(const struct mdio_board_info *info,\r\nunsigned int n)\r\n{\r\nstruct mdio_board_entry *be;\r\nunsigned int i;\r\nbe = kcalloc(n, sizeof(*be), GFP_KERNEL);\r\nif (!be)\r\nreturn -ENOMEM;\r\nfor (i = 0; i < n; i++, be++, info++) {\r\nmemcpy(&be->board_info, info, sizeof(*info));\r\nmutex_lock(&mdio_board_lock);\r\nlist_add_tail(&be->list, &mdio_board_list);\r\nmutex_unlock(&mdio_board_lock);\r\n}\r\nreturn 0;\r\n}
