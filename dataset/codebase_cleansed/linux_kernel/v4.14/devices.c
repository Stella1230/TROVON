void __init cns3xxx_ahci_init(void)\r\n{\r\nu32 tmp;\r\ntmp = __raw_readl(MISC_SATA_POWER_MODE);\r\ntmp |= 0x1 << 16;\r\ntmp |= 0x1 << 17;\r\n__raw_writel(tmp, MISC_SATA_POWER_MODE);\r\ncns3xxx_pwr_power_up(0x1 << PM_PLL_HM_PD_CTRL_REG_OFFSET_SATA_PHY0);\r\ncns3xxx_pwr_power_up(0x1 << PM_PLL_HM_PD_CTRL_REG_OFFSET_SATA_PHY1);\r\ncns3xxx_pwr_clk_en(0x1 << PM_CLK_GATE_REG_OFFSET_SATA);\r\ncns3xxx_pwr_soft_rst(CNS3XXX_PWR_SOFTWARE_RST(SATA));\r\nplatform_device_register(&cns3xxx_ahci_pdev);\r\n}\r\nvoid __init cns3xxx_sdhci_init(void)\r\n{\r\nu32 __iomem *gpioa = IOMEM(CNS3XXX_MISC_BASE_VIRT + 0x0014);\r\nu32 gpioa_pins = __raw_readl(gpioa);\r\ngpioa_pins |= 0x1fff0004;\r\n__raw_writel(gpioa_pins, gpioa);\r\ncns3xxx_pwr_clk_en(CNS3XXX_PWR_CLK_EN(SDIO));\r\ncns3xxx_pwr_soft_rst(CNS3XXX_PWR_SOFTWARE_RST(SDIO));\r\nplatform_device_register(&cns3xxx_sdhci_pdev);\r\n}
