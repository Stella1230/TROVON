static int tpg_s_stream(struct v4l2_subdev *sd, int enable)\r\n{\r\nreturn 0;\r\n}\r\nstatic int tpg_g_parm(struct v4l2_subdev *sd, struct v4l2_streamparm *param)\r\n{\r\nreturn 0;\r\n}\r\nstatic int tpg_s_parm(struct v4l2_subdev *sd, struct v4l2_streamparm *param)\r\n{\r\nreturn 0;\r\n}\r\nstatic int tpg_get_fmt(struct v4l2_subdev *sd,\r\nstruct v4l2_subdev_pad_config *cfg,\r\nstruct v4l2_subdev_format *format)\r\n{\r\nreturn 0;\r\n}\r\nstatic int tpg_set_fmt(struct v4l2_subdev *sd,\r\nstruct v4l2_subdev_pad_config *cfg,\r\nstruct v4l2_subdev_format *format)\r\n{\r\nstruct v4l2_mbus_framefmt *fmt = &format->format;\r\nif (format->pad)\r\nreturn -EINVAL;\r\nfmt->code = MEDIA_BUS_FMT_SGRBG8_1X8;\r\nif (format->which == V4L2_SUBDEV_FORMAT_TRY) {\r\ncfg->try_fmt = *fmt;\r\nreturn 0;\r\n}\r\nreturn 0;\r\n}\r\nstatic int tpg_log_status(struct v4l2_subdev *sd)\r\n{\r\nreturn 0;\r\n}\r\nstatic int tpg_s_power(struct v4l2_subdev *sd, int on)\r\n{\r\nreturn 0;\r\n}\r\nstatic int tpg_enum_mbus_code(struct v4l2_subdev *sd,\r\nstruct v4l2_subdev_pad_config *cfg,\r\nstruct v4l2_subdev_mbus_code_enum *code)\r\n{\r\nreturn 0;\r\n}\r\nstatic int tpg_enum_frame_size(struct v4l2_subdev *sd,\r\nstruct v4l2_subdev_pad_config *cfg,\r\nstruct v4l2_subdev_frame_size_enum *fse)\r\n{\r\nreturn 0;\r\n}\r\nstatic int tpg_enum_frame_ival(struct v4l2_subdev *sd,\r\nstruct v4l2_subdev_pad_config *cfg,\r\nstruct v4l2_subdev_frame_interval_enum *fie)\r\n{\r\nreturn 0;\r\n}\r\nvoid atomisp_tpg_unregister_entities(struct atomisp_tpg_device *tpg)\r\n{\r\nmedia_entity_cleanup(&tpg->sd.entity);\r\nv4l2_device_unregister_subdev(&tpg->sd);\r\n}\r\nint atomisp_tpg_register_entities(struct atomisp_tpg_device *tpg,\r\nstruct v4l2_device *vdev)\r\n{\r\nint ret;\r\nret = v4l2_device_register_subdev(vdev, &tpg->sd);\r\nif (ret < 0)\r\ngoto error;\r\nreturn 0;\r\nerror:\r\natomisp_tpg_unregister_entities(tpg);\r\nreturn ret;\r\n}\r\nvoid atomisp_tpg_cleanup(struct atomisp_device *isp)\r\n{\r\n}\r\nint atomisp_tpg_init(struct atomisp_device *isp)\r\n{\r\nstruct atomisp_tpg_device *tpg = &isp->tpg;\r\nstruct v4l2_subdev *sd = &tpg->sd;\r\nstruct media_pad *pads = tpg->pads;\r\nstruct media_entity *me = &sd->entity;\r\nint ret;\r\ntpg->isp = isp;\r\nv4l2_subdev_init(sd, &tpg_ops);\r\nsd->flags |= V4L2_SUBDEV_FL_HAS_DEVNODE;\r\nstrcpy(sd->name, "tpg_subdev");\r\nv4l2_set_subdevdata(sd, tpg);\r\npads[0].flags = MEDIA_PAD_FL_SINK;\r\nme->function = MEDIA_ENT_F_V4L2_SUBDEV_UNKNOWN;\r\nret = media_entity_pads_init(me, 1, pads);\r\nif (ret < 0)\r\ngoto fail;\r\nreturn 0;\r\nfail:\r\natomisp_tpg_cleanup(isp);\r\nreturn ret;\r\n}
