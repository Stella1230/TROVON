static int __init mrfld_legacy_rtc_alloc_irq(void)\r\n{\r\nstruct irq_alloc_info info;\r\nint ret;\r\nif (!x86_platform.legacy.rtc)\r\nreturn -ENODEV;\r\nioapic_set_alloc_attr(&info, NUMA_NO_NODE, 1, 0);\r\nret = mp_map_gsi_to_irq(RTC_IRQ, IOAPIC_MAP_ALLOC, &info);\r\nif (ret < 0) {\r\npr_info("Failed to allocate RTC interrupt. Disabling RTC\n");\r\nx86_platform.legacy.rtc = 0;\r\nreturn ret;\r\n}\r\nreturn 0;\r\n}\r\nstatic int __init mrfld_legacy_rtc_init(void)\r\n{\r\nif (intel_mid_identify_cpu() != INTEL_MID_CPU_CHIP_TANGIER)\r\nreturn -ENODEV;\r\nreturn mrfld_legacy_rtc_alloc_irq();\r\n}
