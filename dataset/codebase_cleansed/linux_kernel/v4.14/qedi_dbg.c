void\r\nqedi_dbg_err(struct qedi_dbg_ctx *qedi, const char *func, u32 line,\r\nconst char *fmt, ...)\r\n{\r\nva_list va;\r\nstruct va_format vaf;\r\nchar nfunc[32];\r\nmemset(nfunc, 0, sizeof(nfunc));\r\nmemcpy(nfunc, func, sizeof(nfunc) - 1);\r\nva_start(va, fmt);\r\nvaf.fmt = fmt;\r\nvaf.va = &va;\r\nif (likely(qedi) && likely(qedi->pdev))\r\npr_err("[%s]:[%s:%d]:%d: %pV", dev_name(&qedi->pdev->dev),\r\nnfunc, line, qedi->host_no, &vaf);\r\nelse\r\npr_err("[0000:00:00.0]:[%s:%d]: %pV", nfunc, line, &vaf);\r\nva_end(va);\r\n}\r\nvoid\r\nqedi_dbg_warn(struct qedi_dbg_ctx *qedi, const char *func, u32 line,\r\nconst char *fmt, ...)\r\n{\r\nva_list va;\r\nstruct va_format vaf;\r\nchar nfunc[32];\r\nmemset(nfunc, 0, sizeof(nfunc));\r\nmemcpy(nfunc, func, sizeof(nfunc) - 1);\r\nva_start(va, fmt);\r\nvaf.fmt = fmt;\r\nvaf.va = &va;\r\nif (!(qedi_dbg_log & QEDI_LOG_WARN))\r\ngoto ret;\r\nif (likely(qedi) && likely(qedi->pdev))\r\npr_warn("[%s]:[%s:%d]:%d: %pV", dev_name(&qedi->pdev->dev),\r\nnfunc, line, qedi->host_no, &vaf);\r\nelse\r\npr_warn("[0000:00:00.0]:[%s:%d]: %pV", nfunc, line, &vaf);\r\nret:\r\nva_end(va);\r\n}\r\nvoid\r\nqedi_dbg_notice(struct qedi_dbg_ctx *qedi, const char *func, u32 line,\r\nconst char *fmt, ...)\r\n{\r\nva_list va;\r\nstruct va_format vaf;\r\nchar nfunc[32];\r\nmemset(nfunc, 0, sizeof(nfunc));\r\nmemcpy(nfunc, func, sizeof(nfunc) - 1);\r\nva_start(va, fmt);\r\nvaf.fmt = fmt;\r\nvaf.va = &va;\r\nif (!(qedi_dbg_log & QEDI_LOG_NOTICE))\r\ngoto ret;\r\nif (likely(qedi) && likely(qedi->pdev))\r\npr_notice("[%s]:[%s:%d]:%d: %pV",\r\ndev_name(&qedi->pdev->dev), nfunc, line,\r\nqedi->host_no, &vaf);\r\nelse\r\npr_notice("[0000:00:00.0]:[%s:%d]: %pV", nfunc, line, &vaf);\r\nret:\r\nva_end(va);\r\n}\r\nvoid\r\nqedi_dbg_info(struct qedi_dbg_ctx *qedi, const char *func, u32 line,\r\nu32 level, const char *fmt, ...)\r\n{\r\nva_list va;\r\nstruct va_format vaf;\r\nchar nfunc[32];\r\nmemset(nfunc, 0, sizeof(nfunc));\r\nmemcpy(nfunc, func, sizeof(nfunc) - 1);\r\nva_start(va, fmt);\r\nvaf.fmt = fmt;\r\nvaf.va = &va;\r\nif (!(qedi_dbg_log & level))\r\ngoto ret;\r\nif (likely(qedi) && likely(qedi->pdev))\r\npr_info("[%s]:[%s:%d]:%d: %pV", dev_name(&qedi->pdev->dev),\r\nnfunc, line, qedi->host_no, &vaf);\r\nelse\r\npr_info("[0000:00:00.0]:[%s:%d]: %pV", nfunc, line, &vaf);\r\nret:\r\nva_end(va);\r\n}\r\nint\r\nqedi_create_sysfs_attr(struct Scsi_Host *shost, struct sysfs_bin_attrs *iter)\r\n{\r\nint ret = 0;\r\nfor (; iter->name; iter++) {\r\nret = sysfs_create_bin_file(&shost->shost_gendev.kobj,\r\niter->attr);\r\nif (ret)\r\npr_err("Unable to create sysfs %s attr, err(%d).\n",\r\niter->name, ret);\r\n}\r\nreturn ret;\r\n}\r\nvoid\r\nqedi_remove_sysfs_attr(struct Scsi_Host *shost, struct sysfs_bin_attrs *iter)\r\n{\r\nfor (; iter->name; iter++)\r\nsysfs_remove_bin_file(&shost->shost_gendev.kobj, iter->attr);\r\n}
