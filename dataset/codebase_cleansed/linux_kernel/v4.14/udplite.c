static int udplitev6_rcv(struct sk_buff *skb)\r\n{\r\nreturn __udp6_lib_rcv(skb, &udplite_table, IPPROTO_UDPLITE);\r\n}\r\nstatic void udplitev6_err(struct sk_buff *skb,\r\nstruct inet6_skb_parm *opt,\r\nu8 type, u8 code, int offset, __be32 info)\r\n{\r\n__udp6_lib_err(skb, opt, type, code, offset, info, &udplite_table);\r\n}\r\nint __init udplitev6_init(void)\r\n{\r\nint ret;\r\nret = inet6_add_protocol(&udplitev6_protocol, IPPROTO_UDPLITE);\r\nif (ret)\r\ngoto out;\r\nret = inet6_register_protosw(&udplite6_protosw);\r\nif (ret)\r\ngoto out_udplitev6_protocol;\r\nout:\r\nreturn ret;\r\nout_udplitev6_protocol:\r\ninet6_del_protocol(&udplitev6_protocol, IPPROTO_UDPLITE);\r\ngoto out;\r\n}\r\nvoid udplitev6_exit(void)\r\n{\r\ninet6_unregister_protosw(&udplite6_protosw);\r\ninet6_del_protocol(&udplitev6_protocol, IPPROTO_UDPLITE);\r\n}\r\nstatic int __net_init udplite6_proc_init_net(struct net *net)\r\n{\r\nreturn udp_proc_register(net, &udplite6_seq_afinfo);\r\n}\r\nstatic void __net_exit udplite6_proc_exit_net(struct net *net)\r\n{\r\nudp_proc_unregister(net, &udplite6_seq_afinfo);\r\n}\r\nint __init udplite6_proc_init(void)\r\n{\r\nreturn register_pernet_subsys(&udplite6_net_ops);\r\n}\r\nvoid udplite6_proc_exit(void)\r\n{\r\nunregister_pernet_subsys(&udplite6_net_ops);\r\n}
