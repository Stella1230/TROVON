static int ux500_wdt_start(struct watchdog_device *wdd)\r\n{\r\nreturn prcmu_enable_a9wdog(PRCMU_WDOG_ALL);\r\n}\r\nstatic int ux500_wdt_stop(struct watchdog_device *wdd)\r\n{\r\nreturn prcmu_disable_a9wdog(PRCMU_WDOG_ALL);\r\n}\r\nstatic int ux500_wdt_keepalive(struct watchdog_device *wdd)\r\n{\r\nreturn prcmu_kick_a9wdog(PRCMU_WDOG_ALL);\r\n}\r\nstatic int ux500_wdt_set_timeout(struct watchdog_device *wdd,\r\nunsigned int timeout)\r\n{\r\nux500_wdt_stop(wdd);\r\nprcmu_load_a9wdog(PRCMU_WDOG_ALL, timeout * 1000);\r\nux500_wdt_start(wdd);\r\nreturn 0;\r\n}\r\nstatic int ux500_wdt_probe(struct platform_device *pdev)\r\n{\r\nint ret;\r\nstruct ux500_wdt_data *pdata = dev_get_platdata(&pdev->dev);\r\nif (pdata) {\r\nif (pdata->timeout > 0)\r\ntimeout = pdata->timeout;\r\nif (pdata->has_28_bits_resolution)\r\nux500_wdt.max_timeout = WATCHDOG_MAX28;\r\n}\r\nux500_wdt.parent = &pdev->dev;\r\nwatchdog_set_nowayout(&ux500_wdt, nowayout);\r\nprcmu_config_a9wdog(PRCMU_WDOG_CPU1, false);\r\nprcmu_load_a9wdog(PRCMU_WDOG_ALL, timeout * 1000);\r\nret = watchdog_register_device(&ux500_wdt);\r\nif (ret)\r\nreturn ret;\r\ndev_info(&pdev->dev, "initialized\n");\r\nreturn 0;\r\n}\r\nstatic int ux500_wdt_remove(struct platform_device *dev)\r\n{\r\nwatchdog_unregister_device(&ux500_wdt);\r\nreturn 0;\r\n}\r\nstatic int ux500_wdt_suspend(struct platform_device *pdev,\r\npm_message_t state)\r\n{\r\nif (watchdog_active(&ux500_wdt)) {\r\nux500_wdt_stop(&ux500_wdt);\r\nprcmu_config_a9wdog(PRCMU_WDOG_CPU1, true);\r\nprcmu_load_a9wdog(PRCMU_WDOG_ALL, timeout * 1000);\r\nux500_wdt_start(&ux500_wdt);\r\n}\r\nreturn 0;\r\n}\r\nstatic int ux500_wdt_resume(struct platform_device *pdev)\r\n{\r\nif (watchdog_active(&ux500_wdt)) {\r\nux500_wdt_stop(&ux500_wdt);\r\nprcmu_config_a9wdog(PRCMU_WDOG_CPU1, false);\r\nprcmu_load_a9wdog(PRCMU_WDOG_ALL, timeout * 1000);\r\nux500_wdt_start(&ux500_wdt);\r\n}\r\nreturn 0;\r\n}
