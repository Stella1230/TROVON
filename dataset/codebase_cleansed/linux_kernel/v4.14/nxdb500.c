static inline int nxdb500_check(struct clcd_fb *fb, struct fb_var_screeninfo *var)\r\n{\r\nvar->green.length = 5;\r\nvar->green.msb_right = 0;\r\nreturn clcdfb_check(fb, var);\r\n}\r\nstatic int nxdb500_clcd_setup(struct clcd_fb *fb)\r\n{\r\nunsigned int val;\r\nfb->fb.var.green.length = 5;\r\nfb->fb.var.green.msb_right = 0;\r\nval = readl(NETX_SYSTEM_IOC_ACCESS_KEY);\r\nwritel(val, NETX_SYSTEM_IOC_ACCESS_KEY);\r\nwritel(3, NETX_SYSTEM_IOC_CR);\r\nval = readl(NETX_PIO_OUTPIO);\r\nwritel(val | 1, NETX_PIO_OUTPIO);\r\nval = readl(NETX_PIO_OEPIO);\r\nwritel(val | 1, NETX_PIO_OEPIO);\r\nreturn netx_clcd_setup(fb);\r\n}\r\nstatic void __init nxdb500_init(void)\r\n{\r\nnetx_fb_init(&clcd_data, &qvga);\r\nplatform_add_devices(devices, ARRAY_SIZE(devices));\r\n}
