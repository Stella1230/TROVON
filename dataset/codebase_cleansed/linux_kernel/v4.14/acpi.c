static int\r\nnvkm_acpi_ntfy(struct notifier_block *nb, unsigned long val, void *data)\r\n{\r\nstruct nvkm_device *device =\r\ncontainer_of(nb, typeof(*device), acpi.nb);\r\nstruct acpi_bus_event *info = data;\r\nif (!strcmp(info->device_class, "ac_adapter"))\r\nnvkm_event_send(&device->event, 1, 0, NULL, 0);\r\nreturn NOTIFY_DONE;\r\n}\r\nvoid\r\nnvkm_acpi_fini(struct nvkm_device *device)\r\n{\r\n#ifdef CONFIG_ACPI\r\nunregister_acpi_notifier(&device->acpi.nb);\r\n#endif\r\n}\r\nvoid\r\nnvkm_acpi_init(struct nvkm_device *device)\r\n{\r\n#ifdef CONFIG_ACPI\r\ndevice->acpi.nb.notifier_call = nvkm_acpi_ntfy;\r\nregister_acpi_notifier(&device->acpi.nb);\r\n#endif\r\n}
