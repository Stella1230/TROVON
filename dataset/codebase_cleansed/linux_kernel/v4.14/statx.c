size_t syscall_arg__scnprintf_statx_flags(char *bf, size_t size, struct syscall_arg *arg)\r\n{\r\nint printed = 0, flags = arg->val;\r\nif (flags == 0)\r\nreturn scnprintf(bf, size, "SYNC_AS_STAT");\r\n#define P_FLAG(n) \\r\nif (flags & AT_##n) { \\r\nprinted += scnprintf(bf + printed, size - printed, "%s%s", printed ? "|" : "", #n); \\r\nflags &= ~AT_##n; \\r\n}\r\nP_FLAG(SYMLINK_NOFOLLOW);\r\nP_FLAG(REMOVEDIR);\r\nP_FLAG(SYMLINK_FOLLOW);\r\nP_FLAG(NO_AUTOMOUNT);\r\nP_FLAG(EMPTY_PATH);\r\nP_FLAG(STATX_FORCE_SYNC);\r\nP_FLAG(STATX_DONT_SYNC);\r\n#undef P_FLAG\r\nif (flags)\r\nprinted += scnprintf(bf + printed, size - printed, "%s%#x", printed ? "|" : "", flags);\r\nreturn printed;\r\n}\r\nsize_t syscall_arg__scnprintf_statx_mask(char *bf, size_t size, struct syscall_arg *arg)\r\n{\r\nint printed = 0, flags = arg->val;\r\n#define P_FLAG(n) \\r\nif (flags & STATX_##n) { \\r\nprinted += scnprintf(bf + printed, size - printed, "%s%s", printed ? "|" : "", #n); \\r\nflags &= ~STATX_##n; \\r\n}\r\nP_FLAG(TYPE);\r\nP_FLAG(MODE);\r\nP_FLAG(NLINK);\r\nP_FLAG(UID);\r\nP_FLAG(GID);\r\nP_FLAG(ATIME);\r\nP_FLAG(MTIME);\r\nP_FLAG(CTIME);\r\nP_FLAG(INO);\r\nP_FLAG(SIZE);\r\nP_FLAG(BLOCKS);\r\nP_FLAG(BTIME);\r\n#undef P_FLAG\r\nif (flags)\r\nprinted += scnprintf(bf + printed, size - printed, "%s%#x", printed ? "|" : "", flags);\r\nreturn printed;\r\n}
