static int mxl5005s_SetRfFreqHz(struct dvb_frontend *fe, unsigned long RfFreqHz)\r\n{\r\nstruct mxl5005s_state *state = fe->tuner_priv;\r\nunsigned char AddrTable[MXL5005S_REG_WRITING_TABLE_LEN_MAX];\r\nunsigned char ByteTable[MXL5005S_REG_WRITING_TABLE_LEN_MAX];\r\nint TableLen;\r\nu32 IfDivval = 0;\r\nunsigned char MasterControlByte;\r\ndprintk(1, "%s() freq=%ld\n", __func__, RfFreqHz);\r\nMXL_GetMasterControl(ByteTable, MC_SYNTH_RESET);\r\nAddrTable[0] = MASTER_CONTROL_ADDR;\r\nByteTable[0] |= state->config->AgcMasterByte;\r\nmxl5005s_writeregs(fe, AddrTable, ByteTable, 1);\r\nMXL_TuneRF(fe, RfFreqHz);\r\nMXL_ControlRead(fe, IF_DIVVAL, &IfDivval);\r\nMXL_ControlWrite(fe, SEQ_FSM_PULSE, 0);\r\nMXL_ControlWrite(fe, SEQ_EXTPOWERUP, 1);\r\nMXL_ControlWrite(fe, IF_DIVVAL, 8);\r\nMXL_GetCHRegister(fe, AddrTable, ByteTable, &TableLen);\r\nMXL_GetMasterControl(&MasterControlByte, MC_LOAD_START);\r\nAddrTable[TableLen] = MASTER_CONTROL_ADDR ;\r\nByteTable[TableLen] = MasterControlByte |\r\nstate->config->AgcMasterByte;\r\nTableLen += 1;\r\nmxl5005s_writeregs(fe, AddrTable, ByteTable, TableLen);\r\nmsleep(150);\r\nMXL_ControlWrite(fe, SEQ_FSM_PULSE, 1);\r\nMXL_ControlWrite(fe, IF_DIVVAL, IfDivval);\r\nMXL_GetCHRegister_ZeroIF(fe, AddrTable, ByteTable, &TableLen);\r\nMXL_GetMasterControl(&MasterControlByte, MC_LOAD_START);\r\nAddrTable[TableLen] = MASTER_CONTROL_ADDR ;\r\nByteTable[TableLen] = MasterControlByte |\r\nstate->config->AgcMasterByte ;\r\nTableLen += 1;\r\nmxl5005s_writeregs(fe, AddrTable, ByteTable, TableLen);\r\nmsleep(100);\r\nreturn 0;\r\n}\r\nstatic u16 MXL5005_RegisterInit(struct dvb_frontend *fe)\r\n{\r\nstruct mxl5005s_state *state = fe->tuner_priv;\r\nstate->TunerRegs_Num = TUNER_REGS_NUM ;\r\nstate->TunerRegs[0].Reg_Num = 9 ;\r\nstate->TunerRegs[0].Reg_Val = 0x40 ;\r\nstate->TunerRegs[1].Reg_Num = 11 ;\r\nstate->TunerRegs[1].Reg_Val = 0x19 ;\r\nstate->TunerRegs[2].Reg_Num = 12 ;\r\nstate->TunerRegs[2].Reg_Val = 0x60 ;\r\nstate->TunerRegs[3].Reg_Num = 13 ;\r\nstate->TunerRegs[3].Reg_Val = 0x00 ;\r\nstate->TunerRegs[4].Reg_Num = 14 ;\r\nstate->TunerRegs[4].Reg_Val = 0x00 ;\r\nstate->TunerRegs[5].Reg_Num = 15 ;\r\nstate->TunerRegs[5].Reg_Val = 0xC0 ;\r\nstate->TunerRegs[6].Reg_Num = 16 ;\r\nstate->TunerRegs[6].Reg_Val = 0x00 ;\r\nstate->TunerRegs[7].Reg_Num = 17 ;\r\nstate->TunerRegs[7].Reg_Val = 0x00 ;\r\nstate->TunerRegs[8].Reg_Num = 18 ;\r\nstate->TunerRegs[8].Reg_Val = 0x00 ;\r\nstate->TunerRegs[9].Reg_Num = 19 ;\r\nstate->TunerRegs[9].Reg_Val = 0x34 ;\r\nstate->TunerRegs[10].Reg_Num = 21 ;\r\nstate->TunerRegs[10].Reg_Val = 0x00 ;\r\nstate->TunerRegs[11].Reg_Num = 22 ;\r\nstate->TunerRegs[11].Reg_Val = 0x6B ;\r\nstate->TunerRegs[12].Reg_Num = 23 ;\r\nstate->TunerRegs[12].Reg_Val = 0x35 ;\r\nstate->TunerRegs[13].Reg_Num = 24 ;\r\nstate->TunerRegs[13].Reg_Val = 0x70 ;\r\nstate->TunerRegs[14].Reg_Num = 25 ;\r\nstate->TunerRegs[14].Reg_Val = 0x3E ;\r\nstate->TunerRegs[15].Reg_Num = 26 ;\r\nstate->TunerRegs[15].Reg_Val = 0x82 ;\r\nstate->TunerRegs[16].Reg_Num = 31 ;\r\nstate->TunerRegs[16].Reg_Val = 0x00 ;\r\nstate->TunerRegs[17].Reg_Num = 32 ;\r\nstate->TunerRegs[17].Reg_Val = 0x40 ;\r\nstate->TunerRegs[18].Reg_Num = 33 ;\r\nstate->TunerRegs[18].Reg_Val = 0x53 ;\r\nstate->TunerRegs[19].Reg_Num = 34 ;\r\nstate->TunerRegs[19].Reg_Val = 0x81 ;\r\nstate->TunerRegs[20].Reg_Num = 35 ;\r\nstate->TunerRegs[20].Reg_Val = 0xC9 ;\r\nstate->TunerRegs[21].Reg_Num = 36 ;\r\nstate->TunerRegs[21].Reg_Val = 0x01 ;\r\nstate->TunerRegs[22].Reg_Num = 37 ;\r\nstate->TunerRegs[22].Reg_Val = 0x00 ;\r\nstate->TunerRegs[23].Reg_Num = 41 ;\r\nstate->TunerRegs[23].Reg_Val = 0x00 ;\r\nstate->TunerRegs[24].Reg_Num = 42 ;\r\nstate->TunerRegs[24].Reg_Val = 0xF8 ;\r\nstate->TunerRegs[25].Reg_Num = 43 ;\r\nstate->TunerRegs[25].Reg_Val = 0x43 ;\r\nstate->TunerRegs[26].Reg_Num = 44 ;\r\nstate->TunerRegs[26].Reg_Val = 0x20 ;\r\nstate->TunerRegs[27].Reg_Num = 45 ;\r\nstate->TunerRegs[27].Reg_Val = 0x80 ;\r\nstate->TunerRegs[28].Reg_Num = 46 ;\r\nstate->TunerRegs[28].Reg_Val = 0x88 ;\r\nstate->TunerRegs[29].Reg_Num = 47 ;\r\nstate->TunerRegs[29].Reg_Val = 0x86 ;\r\nstate->TunerRegs[30].Reg_Num = 48 ;\r\nstate->TunerRegs[30].Reg_Val = 0x00 ;\r\nstate->TunerRegs[31].Reg_Num = 49 ;\r\nstate->TunerRegs[31].Reg_Val = 0x00 ;\r\nstate->TunerRegs[32].Reg_Num = 53 ;\r\nstate->TunerRegs[32].Reg_Val = 0x94 ;\r\nstate->TunerRegs[33].Reg_Num = 54 ;\r\nstate->TunerRegs[33].Reg_Val = 0xFA ;\r\nstate->TunerRegs[34].Reg_Num = 55 ;\r\nstate->TunerRegs[34].Reg_Val = 0x92 ;\r\nstate->TunerRegs[35].Reg_Num = 56 ;\r\nstate->TunerRegs[35].Reg_Val = 0x80 ;\r\nstate->TunerRegs[36].Reg_Num = 57 ;\r\nstate->TunerRegs[36].Reg_Val = 0x41 ;\r\nstate->TunerRegs[37].Reg_Num = 58 ;\r\nstate->TunerRegs[37].Reg_Val = 0xDB ;\r\nstate->TunerRegs[38].Reg_Num = 59 ;\r\nstate->TunerRegs[38].Reg_Val = 0x00 ;\r\nstate->TunerRegs[39].Reg_Num = 60 ;\r\nstate->TunerRegs[39].Reg_Val = 0x00 ;\r\nstate->TunerRegs[40].Reg_Num = 61 ;\r\nstate->TunerRegs[40].Reg_Val = 0x00 ;\r\nstate->TunerRegs[41].Reg_Num = 62 ;\r\nstate->TunerRegs[41].Reg_Val = 0x00 ;\r\nstate->TunerRegs[42].Reg_Num = 65 ;\r\nstate->TunerRegs[42].Reg_Val = 0xF8 ;\r\nstate->TunerRegs[43].Reg_Num = 66 ;\r\nstate->TunerRegs[43].Reg_Val = 0xE4 ;\r\nstate->TunerRegs[44].Reg_Num = 67 ;\r\nstate->TunerRegs[44].Reg_Val = 0x90 ;\r\nstate->TunerRegs[45].Reg_Num = 68 ;\r\nstate->TunerRegs[45].Reg_Val = 0xC0 ;\r\nstate->TunerRegs[46].Reg_Num = 69 ;\r\nstate->TunerRegs[46].Reg_Val = 0x01 ;\r\nstate->TunerRegs[47].Reg_Num = 70 ;\r\nstate->TunerRegs[47].Reg_Val = 0x50 ;\r\nstate->TunerRegs[48].Reg_Num = 71 ;\r\nstate->TunerRegs[48].Reg_Val = 0x06 ;\r\nstate->TunerRegs[49].Reg_Num = 72 ;\r\nstate->TunerRegs[49].Reg_Val = 0x00 ;\r\nstate->TunerRegs[50].Reg_Num = 73 ;\r\nstate->TunerRegs[50].Reg_Val = 0x20 ;\r\nstate->TunerRegs[51].Reg_Num = 76 ;\r\nstate->TunerRegs[51].Reg_Val = 0xBB ;\r\nstate->TunerRegs[52].Reg_Num = 77 ;\r\nstate->TunerRegs[52].Reg_Val = 0x13 ;\r\nstate->TunerRegs[53].Reg_Num = 81 ;\r\nstate->TunerRegs[53].Reg_Val = 0x04 ;\r\nstate->TunerRegs[54].Reg_Num = 82 ;\r\nstate->TunerRegs[54].Reg_Val = 0x75 ;\r\nstate->TunerRegs[55].Reg_Num = 83 ;\r\nstate->TunerRegs[55].Reg_Val = 0x00 ;\r\nstate->TunerRegs[56].Reg_Num = 84 ;\r\nstate->TunerRegs[56].Reg_Val = 0x00 ;\r\nstate->TunerRegs[57].Reg_Num = 85 ;\r\nstate->TunerRegs[57].Reg_Val = 0x00 ;\r\nstate->TunerRegs[58].Reg_Num = 91 ;\r\nstate->TunerRegs[58].Reg_Val = 0x70 ;\r\nstate->TunerRegs[59].Reg_Num = 92 ;\r\nstate->TunerRegs[59].Reg_Val = 0x00 ;\r\nstate->TunerRegs[60].Reg_Num = 93 ;\r\nstate->TunerRegs[60].Reg_Val = 0x00 ;\r\nstate->TunerRegs[61].Reg_Num = 94 ;\r\nstate->TunerRegs[61].Reg_Val = 0x00 ;\r\nstate->TunerRegs[62].Reg_Num = 95 ;\r\nstate->TunerRegs[62].Reg_Val = 0x0C ;\r\nstate->TunerRegs[63].Reg_Num = 96 ;\r\nstate->TunerRegs[63].Reg_Val = 0x00 ;\r\nstate->TunerRegs[64].Reg_Num = 97 ;\r\nstate->TunerRegs[64].Reg_Val = 0x00 ;\r\nstate->TunerRegs[65].Reg_Num = 98 ;\r\nstate->TunerRegs[65].Reg_Val = 0xE2 ;\r\nstate->TunerRegs[66].Reg_Num = 99 ;\r\nstate->TunerRegs[66].Reg_Val = 0x00 ;\r\nstate->TunerRegs[67].Reg_Num = 100 ;\r\nstate->TunerRegs[67].Reg_Val = 0x00 ;\r\nstate->TunerRegs[68].Reg_Num = 101 ;\r\nstate->TunerRegs[68].Reg_Val = 0x12 ;\r\nstate->TunerRegs[69].Reg_Num = 102 ;\r\nstate->TunerRegs[69].Reg_Val = 0x80 ;\r\nstate->TunerRegs[70].Reg_Num = 103 ;\r\nstate->TunerRegs[70].Reg_Val = 0x32 ;\r\nstate->TunerRegs[71].Reg_Num = 104 ;\r\nstate->TunerRegs[71].Reg_Val = 0xB4 ;\r\nstate->TunerRegs[72].Reg_Num = 105 ;\r\nstate->TunerRegs[72].Reg_Val = 0x60 ;\r\nstate->TunerRegs[73].Reg_Num = 106 ;\r\nstate->TunerRegs[73].Reg_Val = 0x83 ;\r\nstate->TunerRegs[74].Reg_Num = 107 ;\r\nstate->TunerRegs[74].Reg_Val = 0x84 ;\r\nstate->TunerRegs[75].Reg_Num = 108 ;\r\nstate->TunerRegs[75].Reg_Val = 0x9C ;\r\nstate->TunerRegs[76].Reg_Num = 109 ;\r\nstate->TunerRegs[76].Reg_Val = 0x02 ;\r\nstate->TunerRegs[77].Reg_Num = 110 ;\r\nstate->TunerRegs[77].Reg_Val = 0x81 ;\r\nstate->TunerRegs[78].Reg_Num = 111 ;\r\nstate->TunerRegs[78].Reg_Val = 0xC0 ;\r\nstate->TunerRegs[79].Reg_Num = 112 ;\r\nstate->TunerRegs[79].Reg_Val = 0x10 ;\r\nstate->TunerRegs[80].Reg_Num = 131 ;\r\nstate->TunerRegs[80].Reg_Val = 0x8A ;\r\nstate->TunerRegs[81].Reg_Num = 132 ;\r\nstate->TunerRegs[81].Reg_Val = 0x10 ;\r\nstate->TunerRegs[82].Reg_Num = 133 ;\r\nstate->TunerRegs[82].Reg_Val = 0x24 ;\r\nstate->TunerRegs[83].Reg_Num = 134 ;\r\nstate->TunerRegs[83].Reg_Val = 0x00 ;\r\nstate->TunerRegs[84].Reg_Num = 135 ;\r\nstate->TunerRegs[84].Reg_Val = 0x00 ;\r\nstate->TunerRegs[85].Reg_Num = 136 ;\r\nstate->TunerRegs[85].Reg_Val = 0x7E ;\r\nstate->TunerRegs[86].Reg_Num = 137 ;\r\nstate->TunerRegs[86].Reg_Val = 0x40 ;\r\nstate->TunerRegs[87].Reg_Num = 138 ;\r\nstate->TunerRegs[87].Reg_Val = 0x38 ;\r\nstate->TunerRegs[88].Reg_Num = 146 ;\r\nstate->TunerRegs[88].Reg_Val = 0xF6 ;\r\nstate->TunerRegs[89].Reg_Num = 147 ;\r\nstate->TunerRegs[89].Reg_Val = 0x1A ;\r\nstate->TunerRegs[90].Reg_Num = 148 ;\r\nstate->TunerRegs[90].Reg_Val = 0x62 ;\r\nstate->TunerRegs[91].Reg_Num = 149 ;\r\nstate->TunerRegs[91].Reg_Val = 0x33 ;\r\nstate->TunerRegs[92].Reg_Num = 150 ;\r\nstate->TunerRegs[92].Reg_Val = 0x80 ;\r\nstate->TunerRegs[93].Reg_Num = 156 ;\r\nstate->TunerRegs[93].Reg_Val = 0x56 ;\r\nstate->TunerRegs[94].Reg_Num = 157 ;\r\nstate->TunerRegs[94].Reg_Val = 0x17 ;\r\nstate->TunerRegs[95].Reg_Num = 158 ;\r\nstate->TunerRegs[95].Reg_Val = 0xA9 ;\r\nstate->TunerRegs[96].Reg_Num = 159 ;\r\nstate->TunerRegs[96].Reg_Val = 0x00 ;\r\nstate->TunerRegs[97].Reg_Num = 160 ;\r\nstate->TunerRegs[97].Reg_Val = 0x00 ;\r\nstate->TunerRegs[98].Reg_Num = 161 ;\r\nstate->TunerRegs[98].Reg_Val = 0x00 ;\r\nstate->TunerRegs[99].Reg_Num = 162 ;\r\nstate->TunerRegs[99].Reg_Val = 0x40 ;\r\nstate->TunerRegs[100].Reg_Num = 166 ;\r\nstate->TunerRegs[100].Reg_Val = 0xAE ;\r\nstate->TunerRegs[101].Reg_Num = 167 ;\r\nstate->TunerRegs[101].Reg_Val = 0x1B ;\r\nstate->TunerRegs[102].Reg_Num = 168 ;\r\nstate->TunerRegs[102].Reg_Val = 0xF2 ;\r\nstate->TunerRegs[103].Reg_Num = 195 ;\r\nstate->TunerRegs[103].Reg_Val = 0x00 ;\r\nreturn 0 ;\r\n}\r\nstatic u16 MXL5005_ControlInit(struct dvb_frontend *fe)\r\n{\r\nstruct mxl5005s_state *state = fe->tuner_priv;\r\nstate->Init_Ctrl_Num = INITCTRL_NUM;\r\nstate->Init_Ctrl[0].Ctrl_Num = DN_IQTN_AMP_CUT ;\r\nstate->Init_Ctrl[0].size = 1 ;\r\nstate->Init_Ctrl[0].addr[0] = 73;\r\nstate->Init_Ctrl[0].bit[0] = 7;\r\nstate->Init_Ctrl[0].val[0] = 0;\r\nstate->Init_Ctrl[1].Ctrl_Num = BB_MODE ;\r\nstate->Init_Ctrl[1].size = 1 ;\r\nstate->Init_Ctrl[1].addr[0] = 53;\r\nstate->Init_Ctrl[1].bit[0] = 2;\r\nstate->Init_Ctrl[1].val[0] = 1;\r\nstate->Init_Ctrl[2].Ctrl_Num = BB_BUF ;\r\nstate->Init_Ctrl[2].size = 2 ;\r\nstate->Init_Ctrl[2].addr[0] = 53;\r\nstate->Init_Ctrl[2].bit[0] = 1;\r\nstate->Init_Ctrl[2].val[0] = 0;\r\nstate->Init_Ctrl[2].addr[1] = 57;\r\nstate->Init_Ctrl[2].bit[1] = 0;\r\nstate->Init_Ctrl[2].val[1] = 1;\r\nstate->Init_Ctrl[3].Ctrl_Num = BB_BUF_OA ;\r\nstate->Init_Ctrl[3].size = 1 ;\r\nstate->Init_Ctrl[3].addr[0] = 53;\r\nstate->Init_Ctrl[3].bit[0] = 0;\r\nstate->Init_Ctrl[3].val[0] = 0;\r\nstate->Init_Ctrl[4].Ctrl_Num = BB_ALPF_BANDSELECT ;\r\nstate->Init_Ctrl[4].size = 3 ;\r\nstate->Init_Ctrl[4].addr[0] = 53;\r\nstate->Init_Ctrl[4].bit[0] = 5;\r\nstate->Init_Ctrl[4].val[0] = 0;\r\nstate->Init_Ctrl[4].addr[1] = 53;\r\nstate->Init_Ctrl[4].bit[1] = 6;\r\nstate->Init_Ctrl[4].val[1] = 0;\r\nstate->Init_Ctrl[4].addr[2] = 53;\r\nstate->Init_Ctrl[4].bit[2] = 7;\r\nstate->Init_Ctrl[4].val[2] = 1;\r\nstate->Init_Ctrl[5].Ctrl_Num = BB_IQSWAP ;\r\nstate->Init_Ctrl[5].size = 1 ;\r\nstate->Init_Ctrl[5].addr[0] = 59;\r\nstate->Init_Ctrl[5].bit[0] = 0;\r\nstate->Init_Ctrl[5].val[0] = 0;\r\nstate->Init_Ctrl[6].Ctrl_Num = BB_DLPF_BANDSEL ;\r\nstate->Init_Ctrl[6].size = 2 ;\r\nstate->Init_Ctrl[6].addr[0] = 53;\r\nstate->Init_Ctrl[6].bit[0] = 3;\r\nstate->Init_Ctrl[6].val[0] = 0;\r\nstate->Init_Ctrl[6].addr[1] = 53;\r\nstate->Init_Ctrl[6].bit[1] = 4;\r\nstate->Init_Ctrl[6].val[1] = 1;\r\nstate->Init_Ctrl[7].Ctrl_Num = RFSYN_CHP_GAIN ;\r\nstate->Init_Ctrl[7].size = 4 ;\r\nstate->Init_Ctrl[7].addr[0] = 22;\r\nstate->Init_Ctrl[7].bit[0] = 4;\r\nstate->Init_Ctrl[7].val[0] = 0;\r\nstate->Init_Ctrl[7].addr[1] = 22;\r\nstate->Init_Ctrl[7].bit[1] = 5;\r\nstate->Init_Ctrl[7].val[1] = 1;\r\nstate->Init_Ctrl[7].addr[2] = 22;\r\nstate->Init_Ctrl[7].bit[2] = 6;\r\nstate->Init_Ctrl[7].val[2] = 1;\r\nstate->Init_Ctrl[7].addr[3] = 22;\r\nstate->Init_Ctrl[7].bit[3] = 7;\r\nstate->Init_Ctrl[7].val[3] = 0;\r\nstate->Init_Ctrl[8].Ctrl_Num = RFSYN_EN_CHP_HIGAIN ;\r\nstate->Init_Ctrl[8].size = 1 ;\r\nstate->Init_Ctrl[8].addr[0] = 22;\r\nstate->Init_Ctrl[8].bit[0] = 2;\r\nstate->Init_Ctrl[8].val[0] = 0;\r\nstate->Init_Ctrl[9].Ctrl_Num = AGC_IF ;\r\nstate->Init_Ctrl[9].size = 4 ;\r\nstate->Init_Ctrl[9].addr[0] = 76;\r\nstate->Init_Ctrl[9].bit[0] = 0;\r\nstate->Init_Ctrl[9].val[0] = 1;\r\nstate->Init_Ctrl[9].addr[1] = 76;\r\nstate->Init_Ctrl[9].bit[1] = 1;\r\nstate->Init_Ctrl[9].val[1] = 1;\r\nstate->Init_Ctrl[9].addr[2] = 76;\r\nstate->Init_Ctrl[9].bit[2] = 2;\r\nstate->Init_Ctrl[9].val[2] = 0;\r\nstate->Init_Ctrl[9].addr[3] = 76;\r\nstate->Init_Ctrl[9].bit[3] = 3;\r\nstate->Init_Ctrl[9].val[3] = 1;\r\nstate->Init_Ctrl[10].Ctrl_Num = AGC_RF ;\r\nstate->Init_Ctrl[10].size = 4 ;\r\nstate->Init_Ctrl[10].addr[0] = 76;\r\nstate->Init_Ctrl[10].bit[0] = 4;\r\nstate->Init_Ctrl[10].val[0] = 1;\r\nstate->Init_Ctrl[10].addr[1] = 76;\r\nstate->Init_Ctrl[10].bit[1] = 5;\r\nstate->Init_Ctrl[10].val[1] = 1;\r\nstate->Init_Ctrl[10].addr[2] = 76;\r\nstate->Init_Ctrl[10].bit[2] = 6;\r\nstate->Init_Ctrl[10].val[2] = 0;\r\nstate->Init_Ctrl[10].addr[3] = 76;\r\nstate->Init_Ctrl[10].bit[3] = 7;\r\nstate->Init_Ctrl[10].val[3] = 1;\r\nstate->Init_Ctrl[11].Ctrl_Num = IF_DIVVAL ;\r\nstate->Init_Ctrl[11].size = 5 ;\r\nstate->Init_Ctrl[11].addr[0] = 43;\r\nstate->Init_Ctrl[11].bit[0] = 3;\r\nstate->Init_Ctrl[11].val[0] = 0;\r\nstate->Init_Ctrl[11].addr[1] = 43;\r\nstate->Init_Ctrl[11].bit[1] = 4;\r\nstate->Init_Ctrl[11].val[1] = 0;\r\nstate->Init_Ctrl[11].addr[2] = 43;\r\nstate->Init_Ctrl[11].bit[2] = 5;\r\nstate->Init_Ctrl[11].val[2] = 0;\r\nstate->Init_Ctrl[11].addr[3] = 43;\r\nstate->Init_Ctrl[11].bit[3] = 6;\r\nstate->Init_Ctrl[11].val[3] = 1;\r\nstate->Init_Ctrl[11].addr[4] = 43;\r\nstate->Init_Ctrl[11].bit[4] = 7;\r\nstate->Init_Ctrl[11].val[4] = 0;\r\nstate->Init_Ctrl[12].Ctrl_Num = IF_VCO_BIAS ;\r\nstate->Init_Ctrl[12].size = 6 ;\r\nstate->Init_Ctrl[12].addr[0] = 44;\r\nstate->Init_Ctrl[12].bit[0] = 2;\r\nstate->Init_Ctrl[12].val[0] = 0;\r\nstate->Init_Ctrl[12].addr[1] = 44;\r\nstate->Init_Ctrl[12].bit[1] = 3;\r\nstate->Init_Ctrl[12].val[1] = 0;\r\nstate->Init_Ctrl[12].addr[2] = 44;\r\nstate->Init_Ctrl[12].bit[2] = 4;\r\nstate->Init_Ctrl[12].val[2] = 0;\r\nstate->Init_Ctrl[12].addr[3] = 44;\r\nstate->Init_Ctrl[12].bit[3] = 5;\r\nstate->Init_Ctrl[12].val[3] = 1;\r\nstate->Init_Ctrl[12].addr[4] = 44;\r\nstate->Init_Ctrl[12].bit[4] = 6;\r\nstate->Init_Ctrl[12].val[4] = 0;\r\nstate->Init_Ctrl[12].addr[5] = 44;\r\nstate->Init_Ctrl[12].bit[5] = 7;\r\nstate->Init_Ctrl[12].val[5] = 0;\r\nstate->Init_Ctrl[13].Ctrl_Num = CHCAL_INT_MOD_IF ;\r\nstate->Init_Ctrl[13].size = 7 ;\r\nstate->Init_Ctrl[13].addr[0] = 11;\r\nstate->Init_Ctrl[13].bit[0] = 0;\r\nstate->Init_Ctrl[13].val[0] = 1;\r\nstate->Init_Ctrl[13].addr[1] = 11;\r\nstate->Init_Ctrl[13].bit[1] = 1;\r\nstate->Init_Ctrl[13].val[1] = 0;\r\nstate->Init_Ctrl[13].addr[2] = 11;\r\nstate->Init_Ctrl[13].bit[2] = 2;\r\nstate->Init_Ctrl[13].val[2] = 0;\r\nstate->Init_Ctrl[13].addr[3] = 11;\r\nstate->Init_Ctrl[13].bit[3] = 3;\r\nstate->Init_Ctrl[13].val[3] = 1;\r\nstate->Init_Ctrl[13].addr[4] = 11;\r\nstate->Init_Ctrl[13].bit[4] = 4;\r\nstate->Init_Ctrl[13].val[4] = 1;\r\nstate->Init_Ctrl[13].addr[5] = 11;\r\nstate->Init_Ctrl[13].bit[5] = 5;\r\nstate->Init_Ctrl[13].val[5] = 0;\r\nstate->Init_Ctrl[13].addr[6] = 11;\r\nstate->Init_Ctrl[13].bit[6] = 6;\r\nstate->Init_Ctrl[13].val[6] = 0;\r\nstate->Init_Ctrl[14].Ctrl_Num = CHCAL_FRAC_MOD_IF ;\r\nstate->Init_Ctrl[14].size = 16 ;\r\nstate->Init_Ctrl[14].addr[0] = 13;\r\nstate->Init_Ctrl[14].bit[0] = 0;\r\nstate->Init_Ctrl[14].val[0] = 0;\r\nstate->Init_Ctrl[14].addr[1] = 13;\r\nstate->Init_Ctrl[14].bit[1] = 1;\r\nstate->Init_Ctrl[14].val[1] = 0;\r\nstate->Init_Ctrl[14].addr[2] = 13;\r\nstate->Init_Ctrl[14].bit[2] = 2;\r\nstate->Init_Ctrl[14].val[2] = 0;\r\nstate->Init_Ctrl[14].addr[3] = 13;\r\nstate->Init_Ctrl[14].bit[3] = 3;\r\nstate->Init_Ctrl[14].val[3] = 0;\r\nstate->Init_Ctrl[14].addr[4] = 13;\r\nstate->Init_Ctrl[14].bit[4] = 4;\r\nstate->Init_Ctrl[14].val[4] = 0;\r\nstate->Init_Ctrl[14].addr[5] = 13;\r\nstate->Init_Ctrl[14].bit[5] = 5;\r\nstate->Init_Ctrl[14].val[5] = 0;\r\nstate->Init_Ctrl[14].addr[6] = 13;\r\nstate->Init_Ctrl[14].bit[6] = 6;\r\nstate->Init_Ctrl[14].val[6] = 0;\r\nstate->Init_Ctrl[14].addr[7] = 13;\r\nstate->Init_Ctrl[14].bit[7] = 7;\r\nstate->Init_Ctrl[14].val[7] = 0;\r\nstate->Init_Ctrl[14].addr[8] = 12;\r\nstate->Init_Ctrl[14].bit[8] = 0;\r\nstate->Init_Ctrl[14].val[8] = 0;\r\nstate->Init_Ctrl[14].addr[9] = 12;\r\nstate->Init_Ctrl[14].bit[9] = 1;\r\nstate->Init_Ctrl[14].val[9] = 0;\r\nstate->Init_Ctrl[14].addr[10] = 12;\r\nstate->Init_Ctrl[14].bit[10] = 2;\r\nstate->Init_Ctrl[14].val[10] = 0;\r\nstate->Init_Ctrl[14].addr[11] = 12;\r\nstate->Init_Ctrl[14].bit[11] = 3;\r\nstate->Init_Ctrl[14].val[11] = 0;\r\nstate->Init_Ctrl[14].addr[12] = 12;\r\nstate->Init_Ctrl[14].bit[12] = 4;\r\nstate->Init_Ctrl[14].val[12] = 0;\r\nstate->Init_Ctrl[14].addr[13] = 12;\r\nstate->Init_Ctrl[14].bit[13] = 5;\r\nstate->Init_Ctrl[14].val[13] = 1;\r\nstate->Init_Ctrl[14].addr[14] = 12;\r\nstate->Init_Ctrl[14].bit[14] = 6;\r\nstate->Init_Ctrl[14].val[14] = 1;\r\nstate->Init_Ctrl[14].addr[15] = 12;\r\nstate->Init_Ctrl[14].bit[15] = 7;\r\nstate->Init_Ctrl[14].val[15] = 0;\r\nstate->Init_Ctrl[15].Ctrl_Num = DRV_RES_SEL ;\r\nstate->Init_Ctrl[15].size = 3 ;\r\nstate->Init_Ctrl[15].addr[0] = 147;\r\nstate->Init_Ctrl[15].bit[0] = 2;\r\nstate->Init_Ctrl[15].val[0] = 0;\r\nstate->Init_Ctrl[15].addr[1] = 147;\r\nstate->Init_Ctrl[15].bit[1] = 3;\r\nstate->Init_Ctrl[15].val[1] = 1;\r\nstate->Init_Ctrl[15].addr[2] = 147;\r\nstate->Init_Ctrl[15].bit[2] = 4;\r\nstate->Init_Ctrl[15].val[2] = 1;\r\nstate->Init_Ctrl[16].Ctrl_Num = I_DRIVER ;\r\nstate->Init_Ctrl[16].size = 2 ;\r\nstate->Init_Ctrl[16].addr[0] = 147;\r\nstate->Init_Ctrl[16].bit[0] = 0;\r\nstate->Init_Ctrl[16].val[0] = 0;\r\nstate->Init_Ctrl[16].addr[1] = 147;\r\nstate->Init_Ctrl[16].bit[1] = 1;\r\nstate->Init_Ctrl[16].val[1] = 1;\r\nstate->Init_Ctrl[17].Ctrl_Num = EN_AAF ;\r\nstate->Init_Ctrl[17].size = 1 ;\r\nstate->Init_Ctrl[17].addr[0] = 147;\r\nstate->Init_Ctrl[17].bit[0] = 7;\r\nstate->Init_Ctrl[17].val[0] = 0;\r\nstate->Init_Ctrl[18].Ctrl_Num = EN_3P ;\r\nstate->Init_Ctrl[18].size = 1 ;\r\nstate->Init_Ctrl[18].addr[0] = 147;\r\nstate->Init_Ctrl[18].bit[0] = 6;\r\nstate->Init_Ctrl[18].val[0] = 0;\r\nstate->Init_Ctrl[19].Ctrl_Num = EN_AUX_3P ;\r\nstate->Init_Ctrl[19].size = 1 ;\r\nstate->Init_Ctrl[19].addr[0] = 156;\r\nstate->Init_Ctrl[19].bit[0] = 0;\r\nstate->Init_Ctrl[19].val[0] = 0;\r\nstate->Init_Ctrl[20].Ctrl_Num = SEL_AAF_BAND ;\r\nstate->Init_Ctrl[20].size = 1 ;\r\nstate->Init_Ctrl[20].addr[0] = 147;\r\nstate->Init_Ctrl[20].bit[0] = 5;\r\nstate->Init_Ctrl[20].val[0] = 0;\r\nstate->Init_Ctrl[21].Ctrl_Num = SEQ_ENCLK16_CLK_OUT ;\r\nstate->Init_Ctrl[21].size = 1 ;\r\nstate->Init_Ctrl[21].addr[0] = 137;\r\nstate->Init_Ctrl[21].bit[0] = 4;\r\nstate->Init_Ctrl[21].val[0] = 0;\r\nstate->Init_Ctrl[22].Ctrl_Num = SEQ_SEL4_16B ;\r\nstate->Init_Ctrl[22].size = 1 ;\r\nstate->Init_Ctrl[22].addr[0] = 137;\r\nstate->Init_Ctrl[22].bit[0] = 7;\r\nstate->Init_Ctrl[22].val[0] = 0;\r\nstate->Init_Ctrl[23].Ctrl_Num = XTAL_CAPSELECT ;\r\nstate->Init_Ctrl[23].size = 1 ;\r\nstate->Init_Ctrl[23].addr[0] = 91;\r\nstate->Init_Ctrl[23].bit[0] = 5;\r\nstate->Init_Ctrl[23].val[0] = 1;\r\nstate->Init_Ctrl[24].Ctrl_Num = IF_SEL_DBL ;\r\nstate->Init_Ctrl[24].size = 1 ;\r\nstate->Init_Ctrl[24].addr[0] = 43;\r\nstate->Init_Ctrl[24].bit[0] = 0;\r\nstate->Init_Ctrl[24].val[0] = 1;\r\nstate->Init_Ctrl[25].Ctrl_Num = RFSYN_R_DIV ;\r\nstate->Init_Ctrl[25].size = 2 ;\r\nstate->Init_Ctrl[25].addr[0] = 22;\r\nstate->Init_Ctrl[25].bit[0] = 0;\r\nstate->Init_Ctrl[25].val[0] = 1;\r\nstate->Init_Ctrl[25].addr[1] = 22;\r\nstate->Init_Ctrl[25].bit[1] = 1;\r\nstate->Init_Ctrl[25].val[1] = 1;\r\nstate->Init_Ctrl[26].Ctrl_Num = SEQ_EXTSYNTHCALIF ;\r\nstate->Init_Ctrl[26].size = 1 ;\r\nstate->Init_Ctrl[26].addr[0] = 134;\r\nstate->Init_Ctrl[26].bit[0] = 2;\r\nstate->Init_Ctrl[26].val[0] = 0;\r\nstate->Init_Ctrl[27].Ctrl_Num = SEQ_EXTDCCAL ;\r\nstate->Init_Ctrl[27].size = 1 ;\r\nstate->Init_Ctrl[27].addr[0] = 137;\r\nstate->Init_Ctrl[27].bit[0] = 3;\r\nstate->Init_Ctrl[27].val[0] = 0;\r\nstate->Init_Ctrl[28].Ctrl_Num = AGC_EN_RSSI ;\r\nstate->Init_Ctrl[28].size = 1 ;\r\nstate->Init_Ctrl[28].addr[0] = 77;\r\nstate->Init_Ctrl[28].bit[0] = 7;\r\nstate->Init_Ctrl[28].val[0] = 0;\r\nstate->Init_Ctrl[29].Ctrl_Num = RFA_ENCLKRFAGC ;\r\nstate->Init_Ctrl[29].size = 1 ;\r\nstate->Init_Ctrl[29].addr[0] = 166;\r\nstate->Init_Ctrl[29].bit[0] = 7;\r\nstate->Init_Ctrl[29].val[0] = 1;\r\nstate->Init_Ctrl[30].Ctrl_Num = RFA_RSSI_REFH ;\r\nstate->Init_Ctrl[30].size = 3 ;\r\nstate->Init_Ctrl[30].addr[0] = 166;\r\nstate->Init_Ctrl[30].bit[0] = 0;\r\nstate->Init_Ctrl[30].val[0] = 0;\r\nstate->Init_Ctrl[30].addr[1] = 166;\r\nstate->Init_Ctrl[30].bit[1] = 1;\r\nstate->Init_Ctrl[30].val[1] = 1;\r\nstate->Init_Ctrl[30].addr[2] = 166;\r\nstate->Init_Ctrl[30].bit[2] = 2;\r\nstate->Init_Ctrl[30].val[2] = 1;\r\nstate->Init_Ctrl[31].Ctrl_Num = RFA_RSSI_REF ;\r\nstate->Init_Ctrl[31].size = 3 ;\r\nstate->Init_Ctrl[31].addr[0] = 166;\r\nstate->Init_Ctrl[31].bit[0] = 3;\r\nstate->Init_Ctrl[31].val[0] = 1;\r\nstate->Init_Ctrl[31].addr[1] = 166;\r\nstate->Init_Ctrl[31].bit[1] = 4;\r\nstate->Init_Ctrl[31].val[1] = 0;\r\nstate->Init_Ctrl[31].addr[2] = 166;\r\nstate->Init_Ctrl[31].bit[2] = 5;\r\nstate->Init_Ctrl[31].val[2] = 1;\r\nstate->Init_Ctrl[32].Ctrl_Num = RFA_RSSI_REFL ;\r\nstate->Init_Ctrl[32].size = 3 ;\r\nstate->Init_Ctrl[32].addr[0] = 167;\r\nstate->Init_Ctrl[32].bit[0] = 0;\r\nstate->Init_Ctrl[32].val[0] = 1;\r\nstate->Init_Ctrl[32].addr[1] = 167;\r\nstate->Init_Ctrl[32].bit[1] = 1;\r\nstate->Init_Ctrl[32].val[1] = 1;\r\nstate->Init_Ctrl[32].addr[2] = 167;\r\nstate->Init_Ctrl[32].bit[2] = 2;\r\nstate->Init_Ctrl[32].val[2] = 0;\r\nstate->Init_Ctrl[33].Ctrl_Num = RFA_FLR ;\r\nstate->Init_Ctrl[33].size = 4 ;\r\nstate->Init_Ctrl[33].addr[0] = 168;\r\nstate->Init_Ctrl[33].bit[0] = 0;\r\nstate->Init_Ctrl[33].val[0] = 0;\r\nstate->Init_Ctrl[33].addr[1] = 168;\r\nstate->Init_Ctrl[33].bit[1] = 1;\r\nstate->Init_Ctrl[33].val[1] = 1;\r\nstate->Init_Ctrl[33].addr[2] = 168;\r\nstate->Init_Ctrl[33].bit[2] = 2;\r\nstate->Init_Ctrl[33].val[2] = 0;\r\nstate->Init_Ctrl[33].addr[3] = 168;\r\nstate->Init_Ctrl[33].bit[3] = 3;\r\nstate->Init_Ctrl[33].val[3] = 0;\r\nstate->Init_Ctrl[34].Ctrl_Num = RFA_CEIL ;\r\nstate->Init_Ctrl[34].size = 4 ;\r\nstate->Init_Ctrl[34].addr[0] = 168;\r\nstate->Init_Ctrl[34].bit[0] = 4;\r\nstate->Init_Ctrl[34].val[0] = 1;\r\nstate->Init_Ctrl[34].addr[1] = 168;\r\nstate->Init_Ctrl[34].bit[1] = 5;\r\nstate->Init_Ctrl[34].val[1] = 1;\r\nstate->Init_Ctrl[34].addr[2] = 168;\r\nstate->Init_Ctrl[34].bit[2] = 6;\r\nstate->Init_Ctrl[34].val[2] = 1;\r\nstate->Init_Ctrl[34].addr[3] = 168;\r\nstate->Init_Ctrl[34].bit[3] = 7;\r\nstate->Init_Ctrl[34].val[3] = 1;\r\nstate->Init_Ctrl[35].Ctrl_Num = SEQ_EXTIQFSMPULSE ;\r\nstate->Init_Ctrl[35].size = 1 ;\r\nstate->Init_Ctrl[35].addr[0] = 135;\r\nstate->Init_Ctrl[35].bit[0] = 0;\r\nstate->Init_Ctrl[35].val[0] = 0;\r\nstate->Init_Ctrl[36].Ctrl_Num = OVERRIDE_1 ;\r\nstate->Init_Ctrl[36].size = 1 ;\r\nstate->Init_Ctrl[36].addr[0] = 56;\r\nstate->Init_Ctrl[36].bit[0] = 3;\r\nstate->Init_Ctrl[36].val[0] = 0;\r\nstate->Init_Ctrl[37].Ctrl_Num = BB_INITSTATE_DLPF_TUNE ;\r\nstate->Init_Ctrl[37].size = 7 ;\r\nstate->Init_Ctrl[37].addr[0] = 59;\r\nstate->Init_Ctrl[37].bit[0] = 1;\r\nstate->Init_Ctrl[37].val[0] = 0;\r\nstate->Init_Ctrl[37].addr[1] = 59;\r\nstate->Init_Ctrl[37].bit[1] = 2;\r\nstate->Init_Ctrl[37].val[1] = 0;\r\nstate->Init_Ctrl[37].addr[2] = 59;\r\nstate->Init_Ctrl[37].bit[2] = 3;\r\nstate->Init_Ctrl[37].val[2] = 0;\r\nstate->Init_Ctrl[37].addr[3] = 59;\r\nstate->Init_Ctrl[37].bit[3] = 4;\r\nstate->Init_Ctrl[37].val[3] = 0;\r\nstate->Init_Ctrl[37].addr[4] = 59;\r\nstate->Init_Ctrl[37].bit[4] = 5;\r\nstate->Init_Ctrl[37].val[4] = 0;\r\nstate->Init_Ctrl[37].addr[5] = 59;\r\nstate->Init_Ctrl[37].bit[5] = 6;\r\nstate->Init_Ctrl[37].val[5] = 0;\r\nstate->Init_Ctrl[37].addr[6] = 59;\r\nstate->Init_Ctrl[37].bit[6] = 7;\r\nstate->Init_Ctrl[37].val[6] = 0;\r\nstate->Init_Ctrl[38].Ctrl_Num = TG_R_DIV ;\r\nstate->Init_Ctrl[38].size = 6 ;\r\nstate->Init_Ctrl[38].addr[0] = 32;\r\nstate->Init_Ctrl[38].bit[0] = 2;\r\nstate->Init_Ctrl[38].val[0] = 0;\r\nstate->Init_Ctrl[38].addr[1] = 32;\r\nstate->Init_Ctrl[38].bit[1] = 3;\r\nstate->Init_Ctrl[38].val[1] = 0;\r\nstate->Init_Ctrl[38].addr[2] = 32;\r\nstate->Init_Ctrl[38].bit[2] = 4;\r\nstate->Init_Ctrl[38].val[2] = 0;\r\nstate->Init_Ctrl[38].addr[3] = 32;\r\nstate->Init_Ctrl[38].bit[3] = 5;\r\nstate->Init_Ctrl[38].val[3] = 0;\r\nstate->Init_Ctrl[38].addr[4] = 32;\r\nstate->Init_Ctrl[38].bit[4] = 6;\r\nstate->Init_Ctrl[38].val[4] = 1;\r\nstate->Init_Ctrl[38].addr[5] = 32;\r\nstate->Init_Ctrl[38].bit[5] = 7;\r\nstate->Init_Ctrl[38].val[5] = 0;\r\nstate->Init_Ctrl[39].Ctrl_Num = EN_CHP_LIN_B ;\r\nstate->Init_Ctrl[39].size = 1 ;\r\nstate->Init_Ctrl[39].addr[0] = 25;\r\nstate->Init_Ctrl[39].bit[0] = 3;\r\nstate->Init_Ctrl[39].val[0] = 1;\r\nstate->CH_Ctrl_Num = CHCTRL_NUM ;\r\nstate->CH_Ctrl[0].Ctrl_Num = DN_POLY ;\r\nstate->CH_Ctrl[0].size = 2 ;\r\nstate->CH_Ctrl[0].addr[0] = 68;\r\nstate->CH_Ctrl[0].bit[0] = 6;\r\nstate->CH_Ctrl[0].val[0] = 1;\r\nstate->CH_Ctrl[0].addr[1] = 68;\r\nstate->CH_Ctrl[0].bit[1] = 7;\r\nstate->CH_Ctrl[0].val[1] = 1;\r\nstate->CH_Ctrl[1].Ctrl_Num = DN_RFGAIN ;\r\nstate->CH_Ctrl[1].size = 2 ;\r\nstate->CH_Ctrl[1].addr[0] = 70;\r\nstate->CH_Ctrl[1].bit[0] = 6;\r\nstate->CH_Ctrl[1].val[0] = 1;\r\nstate->CH_Ctrl[1].addr[1] = 70;\r\nstate->CH_Ctrl[1].bit[1] = 7;\r\nstate->CH_Ctrl[1].val[1] = 0;\r\nstate->CH_Ctrl[2].Ctrl_Num = DN_CAP_RFLPF ;\r\nstate->CH_Ctrl[2].size = 9 ;\r\nstate->CH_Ctrl[2].addr[0] = 69;\r\nstate->CH_Ctrl[2].bit[0] = 5;\r\nstate->CH_Ctrl[2].val[0] = 0;\r\nstate->CH_Ctrl[2].addr[1] = 69;\r\nstate->CH_Ctrl[2].bit[1] = 6;\r\nstate->CH_Ctrl[2].val[1] = 0;\r\nstate->CH_Ctrl[2].addr[2] = 69;\r\nstate->CH_Ctrl[2].bit[2] = 7;\r\nstate->CH_Ctrl[2].val[2] = 0;\r\nstate->CH_Ctrl[2].addr[3] = 68;\r\nstate->CH_Ctrl[2].bit[3] = 0;\r\nstate->CH_Ctrl[2].val[3] = 0;\r\nstate->CH_Ctrl[2].addr[4] = 68;\r\nstate->CH_Ctrl[2].bit[4] = 1;\r\nstate->CH_Ctrl[2].val[4] = 0;\r\nstate->CH_Ctrl[2].addr[5] = 68;\r\nstate->CH_Ctrl[2].bit[5] = 2;\r\nstate->CH_Ctrl[2].val[5] = 0;\r\nstate->CH_Ctrl[2].addr[6] = 68;\r\nstate->CH_Ctrl[2].bit[6] = 3;\r\nstate->CH_Ctrl[2].val[6] = 0;\r\nstate->CH_Ctrl[2].addr[7] = 68;\r\nstate->CH_Ctrl[2].bit[7] = 4;\r\nstate->CH_Ctrl[2].val[7] = 0;\r\nstate->CH_Ctrl[2].addr[8] = 68;\r\nstate->CH_Ctrl[2].bit[8] = 5;\r\nstate->CH_Ctrl[2].val[8] = 0;\r\nstate->CH_Ctrl[3].Ctrl_Num = DN_EN_VHFUHFBAR ;\r\nstate->CH_Ctrl[3].size = 1 ;\r\nstate->CH_Ctrl[3].addr[0] = 70;\r\nstate->CH_Ctrl[3].bit[0] = 5;\r\nstate->CH_Ctrl[3].val[0] = 0;\r\nstate->CH_Ctrl[4].Ctrl_Num = DN_GAIN_ADJUST ;\r\nstate->CH_Ctrl[4].size = 3 ;\r\nstate->CH_Ctrl[4].addr[0] = 73;\r\nstate->CH_Ctrl[4].bit[0] = 4;\r\nstate->CH_Ctrl[4].val[0] = 0;\r\nstate->CH_Ctrl[4].addr[1] = 73;\r\nstate->CH_Ctrl[4].bit[1] = 5;\r\nstate->CH_Ctrl[4].val[1] = 1;\r\nstate->CH_Ctrl[4].addr[2] = 73;\r\nstate->CH_Ctrl[4].bit[2] = 6;\r\nstate->CH_Ctrl[4].val[2] = 0;\r\nstate->CH_Ctrl[5].Ctrl_Num = DN_IQTNBUF_AMP ;\r\nstate->CH_Ctrl[5].size = 4 ;\r\nstate->CH_Ctrl[5].addr[0] = 70;\r\nstate->CH_Ctrl[5].bit[0] = 0;\r\nstate->CH_Ctrl[5].val[0] = 0;\r\nstate->CH_Ctrl[5].addr[1] = 70;\r\nstate->CH_Ctrl[5].bit[1] = 1;\r\nstate->CH_Ctrl[5].val[1] = 0;\r\nstate->CH_Ctrl[5].addr[2] = 70;\r\nstate->CH_Ctrl[5].bit[2] = 2;\r\nstate->CH_Ctrl[5].val[2] = 0;\r\nstate->CH_Ctrl[5].addr[3] = 70;\r\nstate->CH_Ctrl[5].bit[3] = 3;\r\nstate->CH_Ctrl[5].val[3] = 0;\r\nstate->CH_Ctrl[6].Ctrl_Num = DN_IQTNGNBFBIAS_BST ;\r\nstate->CH_Ctrl[6].size = 1 ;\r\nstate->CH_Ctrl[6].addr[0] = 70;\r\nstate->CH_Ctrl[6].bit[0] = 4;\r\nstate->CH_Ctrl[6].val[0] = 1;\r\nstate->CH_Ctrl[7].Ctrl_Num = RFSYN_EN_OUTMUX ;\r\nstate->CH_Ctrl[7].size = 1 ;\r\nstate->CH_Ctrl[7].addr[0] = 111;\r\nstate->CH_Ctrl[7].bit[0] = 4;\r\nstate->CH_Ctrl[7].val[0] = 0;\r\nstate->CH_Ctrl[8].Ctrl_Num = RFSYN_SEL_VCO_OUT ;\r\nstate->CH_Ctrl[8].size = 1 ;\r\nstate->CH_Ctrl[8].addr[0] = 111;\r\nstate->CH_Ctrl[8].bit[0] = 7;\r\nstate->CH_Ctrl[8].val[0] = 1;\r\nstate->CH_Ctrl[9].Ctrl_Num = RFSYN_SEL_VCO_HI ;\r\nstate->CH_Ctrl[9].size = 1 ;\r\nstate->CH_Ctrl[9].addr[0] = 111;\r\nstate->CH_Ctrl[9].bit[0] = 6;\r\nstate->CH_Ctrl[9].val[0] = 1;\r\nstate->CH_Ctrl[10].Ctrl_Num = RFSYN_SEL_DIVM ;\r\nstate->CH_Ctrl[10].size = 1 ;\r\nstate->CH_Ctrl[10].addr[0] = 111;\r\nstate->CH_Ctrl[10].bit[0] = 5;\r\nstate->CH_Ctrl[10].val[0] = 0;\r\nstate->CH_Ctrl[11].Ctrl_Num = RFSYN_RF_DIV_BIAS ;\r\nstate->CH_Ctrl[11].size = 2 ;\r\nstate->CH_Ctrl[11].addr[0] = 110;\r\nstate->CH_Ctrl[11].bit[0] = 0;\r\nstate->CH_Ctrl[11].val[0] = 1;\r\nstate->CH_Ctrl[11].addr[1] = 110;\r\nstate->CH_Ctrl[11].bit[1] = 1;\r\nstate->CH_Ctrl[11].val[1] = 0;\r\nstate->CH_Ctrl[12].Ctrl_Num = DN_SEL_FREQ ;\r\nstate->CH_Ctrl[12].size = 3 ;\r\nstate->CH_Ctrl[12].addr[0] = 69;\r\nstate->CH_Ctrl[12].bit[0] = 2;\r\nstate->CH_Ctrl[12].val[0] = 0;\r\nstate->CH_Ctrl[12].addr[1] = 69;\r\nstate->CH_Ctrl[12].bit[1] = 3;\r\nstate->CH_Ctrl[12].val[1] = 0;\r\nstate->CH_Ctrl[12].addr[2] = 69;\r\nstate->CH_Ctrl[12].bit[2] = 4;\r\nstate->CH_Ctrl[12].val[2] = 0;\r\nstate->CH_Ctrl[13].Ctrl_Num = RFSYN_VCO_BIAS ;\r\nstate->CH_Ctrl[13].size = 6 ;\r\nstate->CH_Ctrl[13].addr[0] = 110;\r\nstate->CH_Ctrl[13].bit[0] = 2;\r\nstate->CH_Ctrl[13].val[0] = 0;\r\nstate->CH_Ctrl[13].addr[1] = 110;\r\nstate->CH_Ctrl[13].bit[1] = 3;\r\nstate->CH_Ctrl[13].val[1] = 0;\r\nstate->CH_Ctrl[13].addr[2] = 110;\r\nstate->CH_Ctrl[13].bit[2] = 4;\r\nstate->CH_Ctrl[13].val[2] = 0;\r\nstate->CH_Ctrl[13].addr[3] = 110;\r\nstate->CH_Ctrl[13].bit[3] = 5;\r\nstate->CH_Ctrl[13].val[3] = 0;\r\nstate->CH_Ctrl[13].addr[4] = 110;\r\nstate->CH_Ctrl[13].bit[4] = 6;\r\nstate->CH_Ctrl[13].val[4] = 0;\r\nstate->CH_Ctrl[13].addr[5] = 110;\r\nstate->CH_Ctrl[13].bit[5] = 7;\r\nstate->CH_Ctrl[13].val[5] = 1;\r\nstate->CH_Ctrl[14].Ctrl_Num = CHCAL_INT_MOD_RF ;\r\nstate->CH_Ctrl[14].size = 7 ;\r\nstate->CH_Ctrl[14].addr[0] = 14;\r\nstate->CH_Ctrl[14].bit[0] = 0;\r\nstate->CH_Ctrl[14].val[0] = 0;\r\nstate->CH_Ctrl[14].addr[1] = 14;\r\nstate->CH_Ctrl[14].bit[1] = 1;\r\nstate->CH_Ctrl[14].val[1] = 0;\r\nstate->CH_Ctrl[14].addr[2] = 14;\r\nstate->CH_Ctrl[14].bit[2] = 2;\r\nstate->CH_Ctrl[14].val[2] = 0;\r\nstate->CH_Ctrl[14].addr[3] = 14;\r\nstate->CH_Ctrl[14].bit[3] = 3;\r\nstate->CH_Ctrl[14].val[3] = 0;\r\nstate->CH_Ctrl[14].addr[4] = 14;\r\nstate->CH_Ctrl[14].bit[4] = 4;\r\nstate->CH_Ctrl[14].val[4] = 0;\r\nstate->CH_Ctrl[14].addr[5] = 14;\r\nstate->CH_Ctrl[14].bit[5] = 5;\r\nstate->CH_Ctrl[14].val[5] = 0;\r\nstate->CH_Ctrl[14].addr[6] = 14;\r\nstate->CH_Ctrl[14].bit[6] = 6;\r\nstate->CH_Ctrl[14].val[6] = 0;\r\nstate->CH_Ctrl[15].Ctrl_Num = CHCAL_FRAC_MOD_RF ;\r\nstate->CH_Ctrl[15].size = 18 ;\r\nstate->CH_Ctrl[15].addr[0] = 17;\r\nstate->CH_Ctrl[15].bit[0] = 6;\r\nstate->CH_Ctrl[15].val[0] = 0;\r\nstate->CH_Ctrl[15].addr[1] = 17;\r\nstate->CH_Ctrl[15].bit[1] = 7;\r\nstate->CH_Ctrl[15].val[1] = 0;\r\nstate->CH_Ctrl[15].addr[2] = 16;\r\nstate->CH_Ctrl[15].bit[2] = 0;\r\nstate->CH_Ctrl[15].val[2] = 0;\r\nstate->CH_Ctrl[15].addr[3] = 16;\r\nstate->CH_Ctrl[15].bit[3] = 1;\r\nstate->CH_Ctrl[15].val[3] = 0;\r\nstate->CH_Ctrl[15].addr[4] = 16;\r\nstate->CH_Ctrl[15].bit[4] = 2;\r\nstate->CH_Ctrl[15].val[4] = 0;\r\nstate->CH_Ctrl[15].addr[5] = 16;\r\nstate->CH_Ctrl[15].bit[5] = 3;\r\nstate->CH_Ctrl[15].val[5] = 0;\r\nstate->CH_Ctrl[15].addr[6] = 16;\r\nstate->CH_Ctrl[15].bit[6] = 4;\r\nstate->CH_Ctrl[15].val[6] = 0;\r\nstate->CH_Ctrl[15].addr[7] = 16;\r\nstate->CH_Ctrl[15].bit[7] = 5;\r\nstate->CH_Ctrl[15].val[7] = 0;\r\nstate->CH_Ctrl[15].addr[8] = 16;\r\nstate->CH_Ctrl[15].bit[8] = 6;\r\nstate->CH_Ctrl[15].val[8] = 0;\r\nstate->CH_Ctrl[15].addr[9] = 16;\r\nstate->CH_Ctrl[15].bit[9] = 7;\r\nstate->CH_Ctrl[15].val[9] = 0;\r\nstate->CH_Ctrl[15].addr[10] = 15;\r\nstate->CH_Ctrl[15].bit[10] = 0;\r\nstate->CH_Ctrl[15].val[10] = 0;\r\nstate->CH_Ctrl[15].addr[11] = 15;\r\nstate->CH_Ctrl[15].bit[11] = 1;\r\nstate->CH_Ctrl[15].val[11] = 0;\r\nstate->CH_Ctrl[15].addr[12] = 15;\r\nstate->CH_Ctrl[15].bit[12] = 2;\r\nstate->CH_Ctrl[15].val[12] = 0;\r\nstate->CH_Ctrl[15].addr[13] = 15;\r\nstate->CH_Ctrl[15].bit[13] = 3;\r\nstate->CH_Ctrl[15].val[13] = 0;\r\nstate->CH_Ctrl[15].addr[14] = 15;\r\nstate->CH_Ctrl[15].bit[14] = 4;\r\nstate->CH_Ctrl[15].val[14] = 0;\r\nstate->CH_Ctrl[15].addr[15] = 15;\r\nstate->CH_Ctrl[15].bit[15] = 5;\r\nstate->CH_Ctrl[15].val[15] = 0;\r\nstate->CH_Ctrl[15].addr[16] = 15;\r\nstate->CH_Ctrl[15].bit[16] = 6;\r\nstate->CH_Ctrl[15].val[16] = 1;\r\nstate->CH_Ctrl[15].addr[17] = 15;\r\nstate->CH_Ctrl[15].bit[17] = 7;\r\nstate->CH_Ctrl[15].val[17] = 1;\r\nstate->CH_Ctrl[16].Ctrl_Num = RFSYN_LPF_R ;\r\nstate->CH_Ctrl[16].size = 5 ;\r\nstate->CH_Ctrl[16].addr[0] = 112;\r\nstate->CH_Ctrl[16].bit[0] = 0;\r\nstate->CH_Ctrl[16].val[0] = 0;\r\nstate->CH_Ctrl[16].addr[1] = 112;\r\nstate->CH_Ctrl[16].bit[1] = 1;\r\nstate->CH_Ctrl[16].val[1] = 0;\r\nstate->CH_Ctrl[16].addr[2] = 112;\r\nstate->CH_Ctrl[16].bit[2] = 2;\r\nstate->CH_Ctrl[16].val[2] = 0;\r\nstate->CH_Ctrl[16].addr[3] = 112;\r\nstate->CH_Ctrl[16].bit[3] = 3;\r\nstate->CH_Ctrl[16].val[3] = 0;\r\nstate->CH_Ctrl[16].addr[4] = 112;\r\nstate->CH_Ctrl[16].bit[4] = 4;\r\nstate->CH_Ctrl[16].val[4] = 1;\r\nstate->CH_Ctrl[17].Ctrl_Num = CHCAL_EN_INT_RF ;\r\nstate->CH_Ctrl[17].size = 1 ;\r\nstate->CH_Ctrl[17].addr[0] = 14;\r\nstate->CH_Ctrl[17].bit[0] = 7;\r\nstate->CH_Ctrl[17].val[0] = 0;\r\nstate->CH_Ctrl[18].Ctrl_Num = TG_LO_DIVVAL ;\r\nstate->CH_Ctrl[18].size = 4 ;\r\nstate->CH_Ctrl[18].addr[0] = 107;\r\nstate->CH_Ctrl[18].bit[0] = 3;\r\nstate->CH_Ctrl[18].val[0] = 0;\r\nstate->CH_Ctrl[18].addr[1] = 107;\r\nstate->CH_Ctrl[18].bit[1] = 4;\r\nstate->CH_Ctrl[18].val[1] = 0;\r\nstate->CH_Ctrl[18].addr[2] = 107;\r\nstate->CH_Ctrl[18].bit[2] = 5;\r\nstate->CH_Ctrl[18].val[2] = 0;\r\nstate->CH_Ctrl[18].addr[3] = 107;\r\nstate->CH_Ctrl[18].bit[3] = 6;\r\nstate->CH_Ctrl[18].val[3] = 0;\r\nstate->CH_Ctrl[19].Ctrl_Num = TG_LO_SELVAL ;\r\nstate->CH_Ctrl[19].size = 3 ;\r\nstate->CH_Ctrl[19].addr[0] = 107;\r\nstate->CH_Ctrl[19].bit[0] = 7;\r\nstate->CH_Ctrl[19].val[0] = 1;\r\nstate->CH_Ctrl[19].addr[1] = 106;\r\nstate->CH_Ctrl[19].bit[1] = 0;\r\nstate->CH_Ctrl[19].val[1] = 1;\r\nstate->CH_Ctrl[19].addr[2] = 106;\r\nstate->CH_Ctrl[19].bit[2] = 1;\r\nstate->CH_Ctrl[19].val[2] = 1;\r\nstate->CH_Ctrl[20].Ctrl_Num = TG_DIV_VAL ;\r\nstate->CH_Ctrl[20].size = 11 ;\r\nstate->CH_Ctrl[20].addr[0] = 109;\r\nstate->CH_Ctrl[20].bit[0] = 2;\r\nstate->CH_Ctrl[20].val[0] = 0;\r\nstate->CH_Ctrl[20].addr[1] = 109;\r\nstate->CH_Ctrl[20].bit[1] = 3;\r\nstate->CH_Ctrl[20].val[1] = 0;\r\nstate->CH_Ctrl[20].addr[2] = 109;\r\nstate->CH_Ctrl[20].bit[2] = 4;\r\nstate->CH_Ctrl[20].val[2] = 0;\r\nstate->CH_Ctrl[20].addr[3] = 109;\r\nstate->CH_Ctrl[20].bit[3] = 5;\r\nstate->CH_Ctrl[20].val[3] = 0;\r\nstate->CH_Ctrl[20].addr[4] = 109;\r\nstate->CH_Ctrl[20].bit[4] = 6;\r\nstate->CH_Ctrl[20].val[4] = 0;\r\nstate->CH_Ctrl[20].addr[5] = 109;\r\nstate->CH_Ctrl[20].bit[5] = 7;\r\nstate->CH_Ctrl[20].val[5] = 0;\r\nstate->CH_Ctrl[20].addr[6] = 108;\r\nstate->CH_Ctrl[20].bit[6] = 0;\r\nstate->CH_Ctrl[20].val[6] = 0;\r\nstate->CH_Ctrl[20].addr[7] = 108;\r\nstate->CH_Ctrl[20].bit[7] = 1;\r\nstate->CH_Ctrl[20].val[7] = 0;\r\nstate->CH_Ctrl[20].addr[8] = 108;\r\nstate->CH_Ctrl[20].bit[8] = 2;\r\nstate->CH_Ctrl[20].val[8] = 1;\r\nstate->CH_Ctrl[20].addr[9] = 108;\r\nstate->CH_Ctrl[20].bit[9] = 3;\r\nstate->CH_Ctrl[20].val[9] = 1;\r\nstate->CH_Ctrl[20].addr[10] = 108;\r\nstate->CH_Ctrl[20].bit[10] = 4;\r\nstate->CH_Ctrl[20].val[10] = 1;\r\nstate->CH_Ctrl[21].Ctrl_Num = TG_VCO_BIAS ;\r\nstate->CH_Ctrl[21].size = 6 ;\r\nstate->CH_Ctrl[21].addr[0] = 106;\r\nstate->CH_Ctrl[21].bit[0] = 2;\r\nstate->CH_Ctrl[21].val[0] = 0;\r\nstate->CH_Ctrl[21].addr[1] = 106;\r\nstate->CH_Ctrl[21].bit[1] = 3;\r\nstate->CH_Ctrl[21].val[1] = 0;\r\nstate->CH_Ctrl[21].addr[2] = 106;\r\nstate->CH_Ctrl[21].bit[2] = 4;\r\nstate->CH_Ctrl[21].val[2] = 0;\r\nstate->CH_Ctrl[21].addr[3] = 106;\r\nstate->CH_Ctrl[21].bit[3] = 5;\r\nstate->CH_Ctrl[21].val[3] = 0;\r\nstate->CH_Ctrl[21].addr[4] = 106;\r\nstate->CH_Ctrl[21].bit[4] = 6;\r\nstate->CH_Ctrl[21].val[4] = 0;\r\nstate->CH_Ctrl[21].addr[5] = 106;\r\nstate->CH_Ctrl[21].bit[5] = 7;\r\nstate->CH_Ctrl[21].val[5] = 1;\r\nstate->CH_Ctrl[22].Ctrl_Num = SEQ_EXTPOWERUP ;\r\nstate->CH_Ctrl[22].size = 1 ;\r\nstate->CH_Ctrl[22].addr[0] = 138;\r\nstate->CH_Ctrl[22].bit[0] = 4;\r\nstate->CH_Ctrl[22].val[0] = 1;\r\nstate->CH_Ctrl[23].Ctrl_Num = OVERRIDE_2 ;\r\nstate->CH_Ctrl[23].size = 1 ;\r\nstate->CH_Ctrl[23].addr[0] = 17;\r\nstate->CH_Ctrl[23].bit[0] = 5;\r\nstate->CH_Ctrl[23].val[0] = 0;\r\nstate->CH_Ctrl[24].Ctrl_Num = OVERRIDE_3 ;\r\nstate->CH_Ctrl[24].size = 1 ;\r\nstate->CH_Ctrl[24].addr[0] = 111;\r\nstate->CH_Ctrl[24].bit[0] = 3;\r\nstate->CH_Ctrl[24].val[0] = 0;\r\nstate->CH_Ctrl[25].Ctrl_Num = OVERRIDE_4 ;\r\nstate->CH_Ctrl[25].size = 1 ;\r\nstate->CH_Ctrl[25].addr[0] = 112;\r\nstate->CH_Ctrl[25].bit[0] = 7;\r\nstate->CH_Ctrl[25].val[0] = 0;\r\nstate->CH_Ctrl[26].Ctrl_Num = SEQ_FSM_PULSE ;\r\nstate->CH_Ctrl[26].size = 1 ;\r\nstate->CH_Ctrl[26].addr[0] = 136;\r\nstate->CH_Ctrl[26].bit[0] = 7;\r\nstate->CH_Ctrl[26].val[0] = 0;\r\nstate->CH_Ctrl[27].Ctrl_Num = GPIO_4B ;\r\nstate->CH_Ctrl[27].size = 1 ;\r\nstate->CH_Ctrl[27].addr[0] = 149;\r\nstate->CH_Ctrl[27].bit[0] = 7;\r\nstate->CH_Ctrl[27].val[0] = 0;\r\nstate->CH_Ctrl[28].Ctrl_Num = GPIO_3B ;\r\nstate->CH_Ctrl[28].size = 1 ;\r\nstate->CH_Ctrl[28].addr[0] = 149;\r\nstate->CH_Ctrl[28].bit[0] = 6;\r\nstate->CH_Ctrl[28].val[0] = 0;\r\nstate->CH_Ctrl[29].Ctrl_Num = GPIO_4 ;\r\nstate->CH_Ctrl[29].size = 1 ;\r\nstate->CH_Ctrl[29].addr[0] = 149;\r\nstate->CH_Ctrl[29].bit[0] = 5;\r\nstate->CH_Ctrl[29].val[0] = 1;\r\nstate->CH_Ctrl[30].Ctrl_Num = GPIO_3 ;\r\nstate->CH_Ctrl[30].size = 1 ;\r\nstate->CH_Ctrl[30].addr[0] = 149;\r\nstate->CH_Ctrl[30].bit[0] = 4;\r\nstate->CH_Ctrl[30].val[0] = 1;\r\nstate->CH_Ctrl[31].Ctrl_Num = GPIO_1B ;\r\nstate->CH_Ctrl[31].size = 1 ;\r\nstate->CH_Ctrl[31].addr[0] = 149;\r\nstate->CH_Ctrl[31].bit[0] = 3;\r\nstate->CH_Ctrl[31].val[0] = 0;\r\nstate->CH_Ctrl[32].Ctrl_Num = DAC_A_ENABLE ;\r\nstate->CH_Ctrl[32].size = 1 ;\r\nstate->CH_Ctrl[32].addr[0] = 93;\r\nstate->CH_Ctrl[32].bit[0] = 1;\r\nstate->CH_Ctrl[32].val[0] = 0;\r\nstate->CH_Ctrl[33].Ctrl_Num = DAC_B_ENABLE ;\r\nstate->CH_Ctrl[33].size = 1 ;\r\nstate->CH_Ctrl[33].addr[0] = 93;\r\nstate->CH_Ctrl[33].bit[0] = 0;\r\nstate->CH_Ctrl[33].val[0] = 0;\r\nstate->CH_Ctrl[34].Ctrl_Num = DAC_DIN_A ;\r\nstate->CH_Ctrl[34].size = 6 ;\r\nstate->CH_Ctrl[34].addr[0] = 92;\r\nstate->CH_Ctrl[34].bit[0] = 2;\r\nstate->CH_Ctrl[34].val[0] = 0;\r\nstate->CH_Ctrl[34].addr[1] = 92;\r\nstate->CH_Ctrl[34].bit[1] = 3;\r\nstate->CH_Ctrl[34].val[1] = 0;\r\nstate->CH_Ctrl[34].addr[2] = 92;\r\nstate->CH_Ctrl[34].bit[2] = 4;\r\nstate->CH_Ctrl[34].val[2] = 0;\r\nstate->CH_Ctrl[34].addr[3] = 92;\r\nstate->CH_Ctrl[34].bit[3] = 5;\r\nstate->CH_Ctrl[34].val[3] = 0;\r\nstate->CH_Ctrl[34].addr[4] = 92;\r\nstate->CH_Ctrl[34].bit[4] = 6;\r\nstate->CH_Ctrl[34].val[4] = 0;\r\nstate->CH_Ctrl[34].addr[5] = 92;\r\nstate->CH_Ctrl[34].bit[5] = 7;\r\nstate->CH_Ctrl[34].val[5] = 0;\r\nstate->CH_Ctrl[35].Ctrl_Num = DAC_DIN_B ;\r\nstate->CH_Ctrl[35].size = 6 ;\r\nstate->CH_Ctrl[35].addr[0] = 93;\r\nstate->CH_Ctrl[35].bit[0] = 2;\r\nstate->CH_Ctrl[35].val[0] = 0;\r\nstate->CH_Ctrl[35].addr[1] = 93;\r\nstate->CH_Ctrl[35].bit[1] = 3;\r\nstate->CH_Ctrl[35].val[1] = 0;\r\nstate->CH_Ctrl[35].addr[2] = 93;\r\nstate->CH_Ctrl[35].bit[2] = 4;\r\nstate->CH_Ctrl[35].val[2] = 0;\r\nstate->CH_Ctrl[35].addr[3] = 93;\r\nstate->CH_Ctrl[35].bit[3] = 5;\r\nstate->CH_Ctrl[35].val[3] = 0;\r\nstate->CH_Ctrl[35].addr[4] = 93;\r\nstate->CH_Ctrl[35].bit[4] = 6;\r\nstate->CH_Ctrl[35].val[4] = 0;\r\nstate->CH_Ctrl[35].addr[5] = 93;\r\nstate->CH_Ctrl[35].bit[5] = 7;\r\nstate->CH_Ctrl[35].val[5] = 0;\r\n#ifdef _MXL_PRODUCTION\r\nstate->CH_Ctrl[36].Ctrl_Num = RFSYN_EN_DIV ;\r\nstate->CH_Ctrl[36].size = 1 ;\r\nstate->CH_Ctrl[36].addr[0] = 109;\r\nstate->CH_Ctrl[36].bit[0] = 1;\r\nstate->CH_Ctrl[36].val[0] = 1;\r\nstate->CH_Ctrl[37].Ctrl_Num = RFSYN_DIVM ;\r\nstate->CH_Ctrl[37].size = 2 ;\r\nstate->CH_Ctrl[37].addr[0] = 112;\r\nstate->CH_Ctrl[37].bit[0] = 5;\r\nstate->CH_Ctrl[37].val[0] = 0;\r\nstate->CH_Ctrl[37].addr[1] = 112;\r\nstate->CH_Ctrl[37].bit[1] = 6;\r\nstate->CH_Ctrl[37].val[1] = 0;\r\nstate->CH_Ctrl[38].Ctrl_Num = DN_BYPASS_AGC_I2C ;\r\nstate->CH_Ctrl[38].size = 1 ;\r\nstate->CH_Ctrl[38].addr[0] = 65;\r\nstate->CH_Ctrl[38].bit[0] = 1;\r\nstate->CH_Ctrl[38].val[0] = 0;\r\n#endif\r\nreturn 0 ;\r\n}\r\nstatic void InitTunerControls(struct dvb_frontend *fe)\r\n{\r\nMXL5005_RegisterInit(fe);\r\nMXL5005_ControlInit(fe);\r\n#ifdef _MXL_INTERNAL\r\nMXL5005_MXLControlInit(fe);\r\n#endif\r\n}\r\nstatic u16 MXL5005_TunerConfig(struct dvb_frontend *fe,\r\nu8 Mode,\r\nu8 IF_mode,\r\nu32 Bandwidth,\r\nu32 IF_out,\r\nu32 Fxtal,\r\nu8 AGC_Mode,\r\nu16 TOP,\r\nu16 IF_OUT_LOAD,\r\nu8 CLOCK_OUT,\r\nu8 DIV_OUT,\r\nu8 CAPSELECT,\r\nu8 EN_RSSI,\r\nu8 Mod_Type,\r\nu8 TF_Type\r\n)\r\n{\r\nstruct mxl5005s_state *state = fe->tuner_priv;\r\nstate->Mode = Mode;\r\nstate->IF_Mode = IF_mode;\r\nstate->Chan_Bandwidth = Bandwidth;\r\nstate->IF_OUT = IF_out;\r\nstate->Fxtal = Fxtal;\r\nstate->AGC_Mode = AGC_Mode;\r\nstate->TOP = TOP;\r\nstate->IF_OUT_LOAD = IF_OUT_LOAD;\r\nstate->CLOCK_OUT = CLOCK_OUT;\r\nstate->DIV_OUT = DIV_OUT;\r\nstate->CAPSELECT = CAPSELECT;\r\nstate->EN_RSSI = EN_RSSI;\r\nstate->Mod_Type = Mod_Type;\r\nstate->TF_Type = TF_Type;\r\nInitTunerControls(fe);\r\nMXL_SynthIFLO_Calc(fe);\r\nreturn 0;\r\n}\r\nstatic void MXL_SynthIFLO_Calc(struct dvb_frontend *fe)\r\n{\r\nstruct mxl5005s_state *state = fe->tuner_priv;\r\nif (state->Mode == 1)\r\nstate->IF_LO = state->IF_OUT;\r\nelse {\r\nif (state->IF_Mode == 0)\r\nstate->IF_LO = state->IF_OUT + 400000;\r\nelse\r\nstate->IF_LO = state->IF_OUT + state->Chan_Bandwidth/2;\r\n}\r\n}\r\nstatic void MXL_SynthRFTGLO_Calc(struct dvb_frontend *fe)\r\n{\r\nstruct mxl5005s_state *state = fe->tuner_priv;\r\nif (state->Mode == 1) {\r\nstate->RF_LO = state->RF_IN;\r\nstate->TG_LO = state->RF_IN - 750000;\r\n} else {\r\nif (state->IF_Mode == 0) {\r\nstate->RF_LO = state->RF_IN - 400000;\r\nstate->TG_LO = state->RF_IN - 1750000;\r\n} else {\r\nstate->RF_LO = state->RF_IN - state->Chan_Bandwidth/2;\r\nstate->TG_LO = state->RF_IN -\r\nstate->Chan_Bandwidth + 500000;\r\n}\r\n}\r\n}\r\nstatic u16 MXL_OverwriteICDefault(struct dvb_frontend *fe)\r\n{\r\nu16 status = 0;\r\nstatus += MXL_ControlWrite(fe, OVERRIDE_1, 1);\r\nstatus += MXL_ControlWrite(fe, OVERRIDE_2, 1);\r\nstatus += MXL_ControlWrite(fe, OVERRIDE_3, 1);\r\nstatus += MXL_ControlWrite(fe, OVERRIDE_4, 1);\r\nreturn status;\r\n}\r\nstatic u16 MXL_BlockInit(struct dvb_frontend *fe)\r\n{\r\nstruct mxl5005s_state *state = fe->tuner_priv;\r\nu16 status = 0;\r\nstatus += MXL_OverwriteICDefault(fe);\r\nstatus += MXL_ControlWrite(fe, DN_IQTN_AMP_CUT, state->Mode ? 1 : 0);\r\nstatus += MXL_ControlWrite(fe, BB_MODE, state->Mode ? 0 : 1);\r\nstatus += MXL_ControlWrite(fe, BB_BUF, state->Mode ? 3 : 2);\r\nstatus += MXL_ControlWrite(fe, BB_BUF_OA, state->Mode ? 1 : 0);\r\nstatus += MXL_ControlWrite(fe, BB_IQSWAP, state->Mode ? 0 : 1);\r\nstatus += MXL_ControlWrite(fe, BB_INITSTATE_DLPF_TUNE, 0);\r\nif (state->Mode) {\r\nswitch (state->Chan_Bandwidth) {\r\ncase 8000000:\r\nstatus += MXL_ControlWrite(fe, BB_DLPF_BANDSEL, 0);\r\nbreak;\r\ncase 7000000:\r\nstatus += MXL_ControlWrite(fe, BB_DLPF_BANDSEL, 2);\r\nbreak;\r\ncase 6000000:\r\nstatus += MXL_ControlWrite(fe,\r\nBB_DLPF_BANDSEL, 3);\r\nbreak;\r\n}\r\n} else {\r\nswitch (state->Chan_Bandwidth) {\r\ncase 8000000:\r\nstatus += MXL_ControlWrite(fe, BB_ALPF_BANDSELECT,\r\n(state->IF_Mode ? 0 : 3));\r\nbreak;\r\ncase 7000000:\r\nstatus += MXL_ControlWrite(fe, BB_ALPF_BANDSELECT,\r\n(state->IF_Mode ? 1 : 4));\r\nbreak;\r\ncase 6000000:\r\nstatus += MXL_ControlWrite(fe, BB_ALPF_BANDSELECT,\r\n(state->IF_Mode ? 2 : 5));\r\nbreak;\r\n}\r\n}\r\nstatus += MXL_ControlWrite(fe, RFSYN_CHP_GAIN, state->Mode ? 5 : 8);\r\nstatus += MXL_ControlWrite(fe,\r\nRFSYN_EN_CHP_HIGAIN, state->Mode ? 1 : 1);\r\nstatus += MXL_ControlWrite(fe, EN_CHP_LIN_B, state->Mode ? 0 : 0);\r\nif (state->AGC_Mode == 0) {\r\nstatus += MXL_ControlWrite(fe, AGC_IF, 15);\r\nstatus += MXL_ControlWrite(fe, AGC_RF, 15);\r\n} else\r\nstatus += MXL_ControlWrite(fe, AGC_RF, state->Mode ? 15 : 12);\r\nif (state->TOP == 55)\r\nstatus += MXL_ControlWrite(fe, AGC_IF, 0x0);\r\nif (state->TOP == 72)\r\nstatus += MXL_ControlWrite(fe, AGC_IF, 0x1);\r\nif (state->TOP == 92)\r\nstatus += MXL_ControlWrite(fe, AGC_IF, 0x2);\r\nif (state->TOP == 110)\r\nstatus += MXL_ControlWrite(fe, AGC_IF, 0x3);\r\nif (state->TOP == 129)\r\nstatus += MXL_ControlWrite(fe, AGC_IF, 0x4);\r\nif (state->TOP == 147)\r\nstatus += MXL_ControlWrite(fe, AGC_IF, 0x5);\r\nif (state->TOP == 168)\r\nstatus += MXL_ControlWrite(fe, AGC_IF, 0x6);\r\nif (state->TOP == 194)\r\nstatus += MXL_ControlWrite(fe, AGC_IF, 0x7);\r\nif (state->TOP == 212)\r\nstatus += MXL_ControlWrite(fe, AGC_IF, 0x9);\r\nif (state->TOP == 232)\r\nstatus += MXL_ControlWrite(fe, AGC_IF, 0xA);\r\nif (state->TOP == 252)\r\nstatus += MXL_ControlWrite(fe, AGC_IF, 0xB);\r\nif (state->TOP == 271)\r\nstatus += MXL_ControlWrite(fe, AGC_IF, 0xC);\r\nif (state->TOP == 292)\r\nstatus += MXL_ControlWrite(fe, AGC_IF, 0xD);\r\nif (state->TOP == 317)\r\nstatus += MXL_ControlWrite(fe, AGC_IF, 0xE);\r\nif (state->TOP == 349)\r\nstatus += MXL_ControlWrite(fe, AGC_IF, 0xF);\r\nstatus += MXL_IFSynthInit(fe);\r\nif (state->IF_OUT_LOAD == 200) {\r\nstatus += MXL_ControlWrite(fe, DRV_RES_SEL, 6);\r\nstatus += MXL_ControlWrite(fe, I_DRIVER, 2);\r\n}\r\nif (state->IF_OUT_LOAD == 300) {\r\nstatus += MXL_ControlWrite(fe, DRV_RES_SEL, 4);\r\nstatus += MXL_ControlWrite(fe, I_DRIVER, 1);\r\n}\r\nif (state->Mode) {\r\nif (state->IF_OUT >= 4000000UL && state->IF_OUT <= 6280000UL) {\r\nstatus += MXL_ControlWrite(fe, EN_AAF, 1);\r\nstatus += MXL_ControlWrite(fe, EN_3P, 1);\r\nstatus += MXL_ControlWrite(fe, EN_AUX_3P, 1);\r\nstatus += MXL_ControlWrite(fe, SEL_AAF_BAND, 0);\r\n}\r\nif ((state->IF_OUT == 36125000UL) ||\r\n(state->IF_OUT == 36150000UL)) {\r\nstatus += MXL_ControlWrite(fe, EN_AAF, 1);\r\nstatus += MXL_ControlWrite(fe, EN_3P, 1);\r\nstatus += MXL_ControlWrite(fe, EN_AUX_3P, 1);\r\nstatus += MXL_ControlWrite(fe, SEL_AAF_BAND, 1);\r\n}\r\nif (state->IF_OUT > 36150000UL) {\r\nstatus += MXL_ControlWrite(fe, EN_AAF, 0);\r\nstatus += MXL_ControlWrite(fe, EN_3P, 1);\r\nstatus += MXL_ControlWrite(fe, EN_AUX_3P, 1);\r\nstatus += MXL_ControlWrite(fe, SEL_AAF_BAND, 1);\r\n}\r\n} else {\r\nif (state->IF_OUT >= 4000000UL && state->IF_OUT <= 5000000UL) {\r\nstatus += MXL_ControlWrite(fe, EN_AAF, 1);\r\nstatus += MXL_ControlWrite(fe, EN_3P, 1);\r\nstatus += MXL_ControlWrite(fe, EN_AUX_3P, 1);\r\nstatus += MXL_ControlWrite(fe, SEL_AAF_BAND, 0);\r\n}\r\nif (state->IF_OUT > 5000000UL) {\r\nstatus += MXL_ControlWrite(fe, EN_AAF, 0);\r\nstatus += MXL_ControlWrite(fe, EN_3P, 0);\r\nstatus += MXL_ControlWrite(fe, EN_AUX_3P, 0);\r\nstatus += MXL_ControlWrite(fe, SEL_AAF_BAND, 0);\r\n}\r\n}\r\nif (state->CLOCK_OUT)\r\nstatus += MXL_ControlWrite(fe, SEQ_ENCLK16_CLK_OUT, 1);\r\nelse\r\nstatus += MXL_ControlWrite(fe, SEQ_ENCLK16_CLK_OUT, 0);\r\nif (state->DIV_OUT == 1)\r\nstatus += MXL_ControlWrite(fe, SEQ_SEL4_16B, 1);\r\nif (state->DIV_OUT == 0)\r\nstatus += MXL_ControlWrite(fe, SEQ_SEL4_16B, 0);\r\nif (state->CAPSELECT)\r\nstatus += MXL_ControlWrite(fe, XTAL_CAPSELECT, 1);\r\nelse\r\nstatus += MXL_ControlWrite(fe, XTAL_CAPSELECT, 0);\r\nif (state->Fxtal >= 12000000UL && state->Fxtal <= 16000000UL)\r\nstatus += MXL_ControlWrite(fe, IF_SEL_DBL, 1);\r\nif (state->Fxtal > 16000000UL && state->Fxtal <= 32000000UL)\r\nstatus += MXL_ControlWrite(fe, IF_SEL_DBL, 0);\r\nif (state->Fxtal >= 12000000UL && state->Fxtal <= 22000000UL)\r\nstatus += MXL_ControlWrite(fe, RFSYN_R_DIV, 3);\r\nif (state->Fxtal > 22000000UL && state->Fxtal <= 32000000UL)\r\nstatus += MXL_ControlWrite(fe, RFSYN_R_DIV, 0);\r\nif (state->Mode == 0 && state->IF_Mode == 1)\r\nstatus += MXL_ControlWrite(fe, SEQ_EXTIQFSMPULSE, 0);\r\nelse\r\nstatus += MXL_ControlWrite(fe, SEQ_EXTIQFSMPULSE, 1);\r\nstatus += MXL_ControlWrite(fe, TG_R_DIV,\r\nMXL_Ceiling(state->Fxtal, 1000000));\r\nif (state->EN_RSSI) {\r\nstatus += MXL_ControlWrite(fe, SEQ_EXTSYNTHCALIF, 1);\r\nstatus += MXL_ControlWrite(fe, SEQ_EXTDCCAL, 1);\r\nstatus += MXL_ControlWrite(fe, AGC_EN_RSSI, 1);\r\nstatus += MXL_ControlWrite(fe, RFA_ENCLKRFAGC, 1);\r\nstatus += MXL_ControlWrite(fe, RFA_RSSI_REF, 2);\r\nstatus += MXL_ControlWrite(fe, RFA_RSSI_REFH, 3);\r\nstatus += MXL_ControlWrite(fe, RFA_RSSI_REFL, 1);\r\nstatus += MXL_ControlWrite(fe, RFA_FLR, 0);\r\nstatus += MXL_ControlWrite(fe, RFA_CEIL, 12);\r\n}\r\nif (state->Mod_Type == MXL_DVBT) {\r\nstate->AGC_Mode = 1;\r\nstatus += MXL_ControlWrite(fe, SEQ_EXTSYNTHCALIF, 1);\r\nstatus += MXL_ControlWrite(fe, SEQ_EXTDCCAL, 1);\r\nstatus += MXL_ControlWrite(fe, AGC_EN_RSSI, 1);\r\nstatus += MXL_ControlWrite(fe, RFA_ENCLKRFAGC, 1);\r\nstatus += MXL_ControlWrite(fe, RFA_RSSI_REF, 3);\r\nstatus += MXL_ControlWrite(fe, RFA_RSSI_REFH, 5);\r\nstatus += MXL_ControlWrite(fe, RFA_RSSI_REFL, 1);\r\nstatus += MXL_ControlWrite(fe, RFA_FLR, 2);\r\nstatus += MXL_ControlWrite(fe, RFA_CEIL, 13);\r\nif (state->IF_OUT <= 6280000UL)\r\nstatus += MXL_ControlWrite(fe, BB_IQSWAP, 0);\r\nelse\r\nstatus += MXL_ControlWrite(fe, BB_IQSWAP, 1);\r\n}\r\nif (state->Mod_Type == MXL_ATSC) {\r\nstate->AGC_Mode = 1;\r\nstatus += MXL_ControlWrite(fe, SEQ_EXTSYNTHCALIF, 1);\r\nstatus += MXL_ControlWrite(fe, SEQ_EXTDCCAL, 1);\r\nstatus += MXL_ControlWrite(fe, AGC_EN_RSSI, 1);\r\nstatus += MXL_ControlWrite(fe, RFA_ENCLKRFAGC, 1);\r\nstatus += MXL_ControlWrite(fe, RFA_RSSI_REF, 2);\r\nstatus += MXL_ControlWrite(fe, RFA_RSSI_REFH, 4);\r\nstatus += MXL_ControlWrite(fe, RFA_RSSI_REFL, 1);\r\nstatus += MXL_ControlWrite(fe, RFA_FLR, 2);\r\nstatus += MXL_ControlWrite(fe, RFA_CEIL, 13);\r\nstatus += MXL_ControlWrite(fe, BB_INITSTATE_DLPF_TUNE, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_CHP_GAIN, 5);\r\nif (state->IF_OUT <= 6280000UL)\r\nstatus += MXL_ControlWrite(fe, BB_IQSWAP, 0);\r\nelse\r\nstatus += MXL_ControlWrite(fe, BB_IQSWAP, 1);\r\n}\r\nif (state->Mod_Type == MXL_QAM) {\r\nstate->Mode = MXL_DIGITAL_MODE;\r\nstatus += MXL_ControlWrite(fe, SEQ_EXTSYNTHCALIF, 1);\r\nstatus += MXL_ControlWrite(fe, SEQ_EXTDCCAL, 1);\r\nstatus += MXL_ControlWrite(fe, AGC_EN_RSSI, 0);\r\nstatus += MXL_ControlWrite(fe, RFA_ENCLKRFAGC, 1);\r\nstatus += MXL_ControlWrite(fe, RFA_RSSI_REFH, 5);\r\nstatus += MXL_ControlWrite(fe, RFA_RSSI_REF, 3);\r\nstatus += MXL_ControlWrite(fe, RFA_RSSI_REFL, 2);\r\nstatus += MXL_ControlWrite(fe, RFSYN_CHP_GAIN, 3);\r\nif (state->IF_OUT <= 6280000UL)\r\nstatus += MXL_ControlWrite(fe, BB_IQSWAP, 0);\r\nelse\r\nstatus += MXL_ControlWrite(fe, BB_IQSWAP, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_CHP_GAIN, 2);\r\n}\r\nif (state->Mod_Type == MXL_ANALOG_CABLE) {\r\nstate->AGC_Mode = 1;\r\nstatus += MXL_ControlWrite(fe, SEQ_EXTSYNTHCALIF, 1);\r\nstatus += MXL_ControlWrite(fe, SEQ_EXTDCCAL, 1);\r\nstatus += MXL_ControlWrite(fe, AGC_EN_RSSI, 0);\r\nstatus += MXL_ControlWrite(fe, RFA_ENCLKRFAGC, 1);\r\nstatus += MXL_ControlWrite(fe, AGC_IF, 1);\r\nstatus += MXL_ControlWrite(fe, AGC_RF, 15);\r\nstatus += MXL_ControlWrite(fe, BB_IQSWAP, 1);\r\n}\r\nif (state->Mod_Type == MXL_ANALOG_OTA) {\r\nstatus += MXL_ControlWrite(fe, SEQ_EXTSYNTHCALIF, 1);\r\nstatus += MXL_ControlWrite(fe, SEQ_EXTDCCAL, 1);\r\nstatus += MXL_ControlWrite(fe, AGC_EN_RSSI, 1);\r\nstatus += MXL_ControlWrite(fe, RFA_ENCLKRFAGC, 1);\r\nstatus += MXL_ControlWrite(fe, RFA_RSSI_REFH, 5);\r\nstatus += MXL_ControlWrite(fe, RFA_RSSI_REF, 3);\r\nstatus += MXL_ControlWrite(fe, RFA_RSSI_REFL, 2);\r\nstatus += MXL_ControlWrite(fe, RFSYN_CHP_GAIN, 3);\r\nstatus += MXL_ControlWrite(fe, BB_IQSWAP, 1);\r\n}\r\nif (state->EN_RSSI == 0) {\r\nstatus += MXL_ControlWrite(fe, SEQ_EXTSYNTHCALIF, 1);\r\nstatus += MXL_ControlWrite(fe, SEQ_EXTDCCAL, 1);\r\nstatus += MXL_ControlWrite(fe, AGC_EN_RSSI, 0);\r\nstatus += MXL_ControlWrite(fe, RFA_ENCLKRFAGC, 1);\r\n}\r\nreturn status;\r\n}\r\nstatic u16 MXL_IFSynthInit(struct dvb_frontend *fe)\r\n{\r\nstruct mxl5005s_state *state = fe->tuner_priv;\r\nu16 status = 0 ;\r\nu32 Fref = 0 ;\r\nu32 Kdbl, intModVal ;\r\nu32 fracModVal ;\r\nKdbl = 2 ;\r\nif (state->Fxtal >= 12000000UL && state->Fxtal <= 16000000UL)\r\nKdbl = 2 ;\r\nif (state->Fxtal > 16000000UL && state->Fxtal <= 32000000UL)\r\nKdbl = 1 ;\r\nif (state->Mode == 0 && state->IF_Mode == 1) {\r\nif (state->IF_LO == 41000000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x08);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x0C);\r\nFref = 328000000UL ;\r\n}\r\nif (state->IF_LO == 47000000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x08);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x08);\r\nFref = 376000000UL ;\r\n}\r\nif (state->IF_LO == 54000000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x10);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x0C);\r\nFref = 324000000UL ;\r\n}\r\nif (state->IF_LO == 60000000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x10);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x08);\r\nFref = 360000000UL ;\r\n}\r\nif (state->IF_LO == 39250000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x08);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x0C);\r\nFref = 314000000UL ;\r\n}\r\nif (state->IF_LO == 39650000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x08);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x0C);\r\nFref = 317200000UL ;\r\n}\r\nif (state->IF_LO == 40150000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x08);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x0C);\r\nFref = 321200000UL ;\r\n}\r\nif (state->IF_LO == 40650000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x08);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x0C);\r\nFref = 325200000UL ;\r\n}\r\n}\r\nif (state->Mode || (state->Mode == 0 && state->IF_Mode == 0)) {\r\nif (state->IF_LO == 57000000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x10);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x08);\r\nFref = 342000000UL ;\r\n}\r\nif (state->IF_LO == 44000000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x08);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x08);\r\nFref = 352000000UL ;\r\n}\r\nif (state->IF_LO == 43750000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x08);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x08);\r\nFref = 350000000UL ;\r\n}\r\nif (state->IF_LO == 36650000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x04);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x08);\r\nFref = 366500000UL ;\r\n}\r\nif (state->IF_LO == 36150000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x04);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x08);\r\nFref = 361500000UL ;\r\n}\r\nif (state->IF_LO == 36000000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x04);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x08);\r\nFref = 360000000UL ;\r\n}\r\nif (state->IF_LO == 35250000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x04);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x08);\r\nFref = 352500000UL ;\r\n}\r\nif (state->IF_LO == 34750000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x04);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x08);\r\nFref = 347500000UL ;\r\n}\r\nif (state->IF_LO == 6280000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x07);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x08);\r\nFref = 376800000UL ;\r\n}\r\nif (state->IF_LO == 5000000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x09);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x08);\r\nFref = 360000000UL ;\r\n}\r\nif (state->IF_LO == 4500000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x06);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x08);\r\nFref = 360000000UL ;\r\n}\r\nif (state->IF_LO == 4570000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x06);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x08);\r\nFref = 365600000UL ;\r\n}\r\nif (state->IF_LO == 4000000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x05);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x08);\r\nFref = 360000000UL ;\r\n}\r\nif (state->IF_LO == 57400000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x10);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x08);\r\nFref = 344400000UL ;\r\n}\r\nif (state->IF_LO == 44400000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x08);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x08);\r\nFref = 355200000UL ;\r\n}\r\nif (state->IF_LO == 44150000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x08);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x08);\r\nFref = 353200000UL ;\r\n}\r\nif (state->IF_LO == 37050000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x04);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x08);\r\nFref = 370500000UL ;\r\n}\r\nif (state->IF_LO == 36550000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x04);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x08);\r\nFref = 365500000UL ;\r\n}\r\nif (state->IF_LO == 36125000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x04);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x08);\r\nFref = 361250000UL ;\r\n}\r\nif (state->IF_LO == 6000000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x07);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x08);\r\nFref = 360000000UL ;\r\n}\r\nif (state->IF_LO == 5400000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x07);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x0C);\r\nFref = 324000000UL ;\r\n}\r\nif (state->IF_LO == 5380000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x07);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x0C);\r\nFref = 322800000UL ;\r\n}\r\nif (state->IF_LO == 5200000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x09);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x08);\r\nFref = 374400000UL ;\r\n}\r\nif (state->IF_LO == 4900000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x09);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x08);\r\nFref = 352800000UL ;\r\n}\r\nif (state->IF_LO == 4400000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x06);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x08);\r\nFref = 352000000UL ;\r\n}\r\nif (state->IF_LO == 4063000UL) {\r\nstatus += MXL_ControlWrite(fe, IF_DIVVAL, 0x05);\r\nstatus += MXL_ControlWrite(fe, IF_VCO_BIAS, 0x08);\r\nFref = 365670000UL ;\r\n}\r\n}\r\nintModVal = Fref / (state->Fxtal * Kdbl/2);\r\nstatus += MXL_ControlWrite(fe, CHCAL_INT_MOD_IF, intModVal);\r\nfracModVal = (2<<15)*(Fref/1000 - (state->Fxtal/1000 * Kdbl/2) *\r\nintModVal);\r\nfracModVal = fracModVal / ((state->Fxtal * Kdbl/2)/1000);\r\nstatus += MXL_ControlWrite(fe, CHCAL_FRAC_MOD_IF, fracModVal);\r\nreturn status ;\r\n}\r\nstatic u16 MXL_TuneRF(struct dvb_frontend *fe, u32 RF_Freq)\r\n{\r\nstruct mxl5005s_state *state = fe->tuner_priv;\r\nu16 status = 0;\r\nu32 divider_val, E3, E4, E5, E5A;\r\nu32 Fmax, Fmin, FmaxBin, FminBin;\r\nu32 Kdbl_RF = 2;\r\nu32 tg_divval;\r\nu32 tg_lo;\r\nu32 Fref_TG;\r\nu32 Fvco;\r\nstate->RF_IN = RF_Freq;\r\nMXL_SynthRFTGLO_Calc(fe);\r\nif (state->Fxtal >= 12000000UL && state->Fxtal <= 22000000UL)\r\nKdbl_RF = 2;\r\nif (state->Fxtal > 22000000 && state->Fxtal <= 32000000)\r\nKdbl_RF = 1;\r\nif (state->RF_LO < 40000000UL)\r\nreturn -1;\r\nif (state->RF_LO >= 40000000UL && state->RF_LO <= 75000000UL) {\r\nstatus += MXL_ControlWrite(fe, DN_POLY, 2);\r\nstatus += MXL_ControlWrite(fe, DN_RFGAIN, 3);\r\nstatus += MXL_ControlWrite(fe, DN_CAP_RFLPF, 423);\r\nstatus += MXL_ControlWrite(fe, DN_EN_VHFUHFBAR, 1);\r\nstatus += MXL_ControlWrite(fe, DN_GAIN_ADJUST, 1);\r\n}\r\nif (state->RF_LO > 75000000UL && state->RF_LO <= 100000000UL) {\r\nstatus += MXL_ControlWrite(fe, DN_POLY, 3);\r\nstatus += MXL_ControlWrite(fe, DN_RFGAIN, 3);\r\nstatus += MXL_ControlWrite(fe, DN_CAP_RFLPF, 222);\r\nstatus += MXL_ControlWrite(fe, DN_EN_VHFUHFBAR, 1);\r\nstatus += MXL_ControlWrite(fe, DN_GAIN_ADJUST, 1);\r\n}\r\nif (state->RF_LO > 100000000UL && state->RF_LO <= 150000000UL) {\r\nstatus += MXL_ControlWrite(fe, DN_POLY, 3);\r\nstatus += MXL_ControlWrite(fe, DN_RFGAIN, 3);\r\nstatus += MXL_ControlWrite(fe, DN_CAP_RFLPF, 147);\r\nstatus += MXL_ControlWrite(fe, DN_EN_VHFUHFBAR, 1);\r\nstatus += MXL_ControlWrite(fe, DN_GAIN_ADJUST, 2);\r\n}\r\nif (state->RF_LO > 150000000UL && state->RF_LO <= 200000000UL) {\r\nstatus += MXL_ControlWrite(fe, DN_POLY, 3);\r\nstatus += MXL_ControlWrite(fe, DN_RFGAIN, 3);\r\nstatus += MXL_ControlWrite(fe, DN_CAP_RFLPF, 9);\r\nstatus += MXL_ControlWrite(fe, DN_EN_VHFUHFBAR, 1);\r\nstatus += MXL_ControlWrite(fe, DN_GAIN_ADJUST, 2);\r\n}\r\nif (state->RF_LO > 200000000UL && state->RF_LO <= 300000000UL) {\r\nstatus += MXL_ControlWrite(fe, DN_POLY, 3);\r\nstatus += MXL_ControlWrite(fe, DN_RFGAIN, 3);\r\nstatus += MXL_ControlWrite(fe, DN_CAP_RFLPF, 0);\r\nstatus += MXL_ControlWrite(fe, DN_EN_VHFUHFBAR, 1);\r\nstatus += MXL_ControlWrite(fe, DN_GAIN_ADJUST, 3);\r\n}\r\nif (state->RF_LO > 300000000UL && state->RF_LO <= 650000000UL) {\r\nstatus += MXL_ControlWrite(fe, DN_POLY, 3);\r\nstatus += MXL_ControlWrite(fe, DN_RFGAIN, 1);\r\nstatus += MXL_ControlWrite(fe, DN_CAP_RFLPF, 0);\r\nstatus += MXL_ControlWrite(fe, DN_EN_VHFUHFBAR, 0);\r\nstatus += MXL_ControlWrite(fe, DN_GAIN_ADJUST, 3);\r\n}\r\nif (state->RF_LO > 650000000UL && state->RF_LO <= 900000000UL) {\r\nstatus += MXL_ControlWrite(fe, DN_POLY, 3);\r\nstatus += MXL_ControlWrite(fe, DN_RFGAIN, 2);\r\nstatus += MXL_ControlWrite(fe, DN_CAP_RFLPF, 0);\r\nstatus += MXL_ControlWrite(fe, DN_EN_VHFUHFBAR, 0);\r\nstatus += MXL_ControlWrite(fe, DN_GAIN_ADJUST, 3);\r\n}\r\nif (state->RF_LO > 900000000UL)\r\nreturn -1;\r\nif (state->RF_LO >= 40000000UL && state->RF_LO <= 75000000UL) {\r\nstatus += MXL_ControlWrite(fe, DN_IQTNBUF_AMP, 1);\r\nstatus += MXL_ControlWrite(fe, DN_IQTNGNBFBIAS_BST, 0);\r\n}\r\nif (state->RF_LO > 75000000UL && state->RF_LO <= 100000000UL) {\r\nstatus += MXL_ControlWrite(fe, DN_IQTNBUF_AMP, 1);\r\nstatus += MXL_ControlWrite(fe, DN_IQTNGNBFBIAS_BST, 0);\r\n}\r\nif (state->RF_LO > 100000000UL && state->RF_LO <= 150000000UL) {\r\nstatus += MXL_ControlWrite(fe, DN_IQTNBUF_AMP, 1);\r\nstatus += MXL_ControlWrite(fe, DN_IQTNGNBFBIAS_BST, 0);\r\n}\r\nif (state->RF_LO > 150000000UL && state->RF_LO <= 200000000UL) {\r\nstatus += MXL_ControlWrite(fe, DN_IQTNBUF_AMP, 1);\r\nstatus += MXL_ControlWrite(fe, DN_IQTNGNBFBIAS_BST, 0);\r\n}\r\nif (state->RF_LO > 200000000UL && state->RF_LO <= 300000000UL) {\r\nstatus += MXL_ControlWrite(fe, DN_IQTNBUF_AMP, 1);\r\nstatus += MXL_ControlWrite(fe, DN_IQTNGNBFBIAS_BST, 0);\r\n}\r\nif (state->RF_LO > 300000000UL && state->RF_LO <= 400000000UL) {\r\nstatus += MXL_ControlWrite(fe, DN_IQTNBUF_AMP, 1);\r\nstatus += MXL_ControlWrite(fe, DN_IQTNGNBFBIAS_BST, 0);\r\n}\r\nif (state->RF_LO > 400000000UL && state->RF_LO <= 450000000UL) {\r\nstatus += MXL_ControlWrite(fe, DN_IQTNBUF_AMP, 1);\r\nstatus += MXL_ControlWrite(fe, DN_IQTNGNBFBIAS_BST, 0);\r\n}\r\nif (state->RF_LO > 450000000UL && state->RF_LO <= 500000000UL) {\r\nstatus += MXL_ControlWrite(fe, DN_IQTNBUF_AMP, 1);\r\nstatus += MXL_ControlWrite(fe, DN_IQTNGNBFBIAS_BST, 0);\r\n}\r\nif (state->RF_LO > 500000000UL && state->RF_LO <= 550000000UL) {\r\nstatus += MXL_ControlWrite(fe, DN_IQTNBUF_AMP, 1);\r\nstatus += MXL_ControlWrite(fe, DN_IQTNGNBFBIAS_BST, 0);\r\n}\r\nif (state->RF_LO > 550000000UL && state->RF_LO <= 600000000UL) {\r\nstatus += MXL_ControlWrite(fe, DN_IQTNBUF_AMP, 1);\r\nstatus += MXL_ControlWrite(fe, DN_IQTNGNBFBIAS_BST, 0);\r\n}\r\nif (state->RF_LO > 600000000UL && state->RF_LO <= 650000000UL) {\r\nstatus += MXL_ControlWrite(fe, DN_IQTNBUF_AMP, 1);\r\nstatus += MXL_ControlWrite(fe, DN_IQTNGNBFBIAS_BST, 0);\r\n}\r\nif (state->RF_LO > 650000000UL && state->RF_LO <= 700000000UL) {\r\nstatus += MXL_ControlWrite(fe, DN_IQTNBUF_AMP, 1);\r\nstatus += MXL_ControlWrite(fe, DN_IQTNGNBFBIAS_BST, 0);\r\n}\r\nif (state->RF_LO > 700000000UL && state->RF_LO <= 750000000UL) {\r\nstatus += MXL_ControlWrite(fe, DN_IQTNBUF_AMP, 1);\r\nstatus += MXL_ControlWrite(fe, DN_IQTNGNBFBIAS_BST, 0);\r\n}\r\nif (state->RF_LO > 750000000UL && state->RF_LO <= 800000000UL) {\r\nstatus += MXL_ControlWrite(fe, DN_IQTNBUF_AMP, 1);\r\nstatus += MXL_ControlWrite(fe, DN_IQTNGNBFBIAS_BST, 0);\r\n}\r\nif (state->RF_LO > 800000000UL && state->RF_LO <= 850000000UL) {\r\nstatus += MXL_ControlWrite(fe, DN_IQTNBUF_AMP, 10);\r\nstatus += MXL_ControlWrite(fe, DN_IQTNGNBFBIAS_BST, 1);\r\n}\r\nif (state->RF_LO > 850000000UL && state->RF_LO <= 900000000UL) {\r\nstatus += MXL_ControlWrite(fe, DN_IQTNBUF_AMP, 10);\r\nstatus += MXL_ControlWrite(fe, DN_IQTNGNBFBIAS_BST, 1);\r\n}\r\nFminBin = 28000000UL ;\r\nFmaxBin = 42500000UL ;\r\nif (state->RF_LO >= 40000000UL && state->RF_LO <= FmaxBin) {\r\nstatus += MXL_ControlWrite(fe, RFSYN_EN_OUTMUX, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_OUT, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_HI, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_DIVM, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_RF_DIV_BIAS, 1);\r\nstatus += MXL_ControlWrite(fe, DN_SEL_FREQ, 1);\r\ndivider_val = 64 ;\r\nFmax = FmaxBin ;\r\nFmin = FminBin ;\r\n}\r\nFminBin = 42500000UL ;\r\nFmaxBin = 56000000UL ;\r\nif (state->RF_LO > FminBin && state->RF_LO <= FmaxBin) {\r\nstatus += MXL_ControlWrite(fe, RFSYN_EN_OUTMUX, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_OUT, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_HI, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_DIVM, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_RF_DIV_BIAS, 1);\r\nstatus += MXL_ControlWrite(fe, DN_SEL_FREQ, 1);\r\ndivider_val = 64 ;\r\nFmax = FmaxBin ;\r\nFmin = FminBin ;\r\n}\r\nFminBin = 56000000UL ;\r\nFmaxBin = 85000000UL ;\r\nif (state->RF_LO > FminBin && state->RF_LO <= FmaxBin) {\r\nstatus += MXL_ControlWrite(fe, RFSYN_EN_OUTMUX, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_OUT, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_HI, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_DIVM, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_RF_DIV_BIAS, 1);\r\nstatus += MXL_ControlWrite(fe, DN_SEL_FREQ, 1);\r\ndivider_val = 32 ;\r\nFmax = FmaxBin ;\r\nFmin = FminBin ;\r\n}\r\nFminBin = 85000000UL ;\r\nFmaxBin = 112000000UL ;\r\nif (state->RF_LO > FminBin && state->RF_LO <= FmaxBin) {\r\nstatus += MXL_ControlWrite(fe, RFSYN_EN_OUTMUX, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_OUT, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_HI, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_DIVM, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_RF_DIV_BIAS, 1);\r\nstatus += MXL_ControlWrite(fe, DN_SEL_FREQ, 1);\r\ndivider_val = 32 ;\r\nFmax = FmaxBin ;\r\nFmin = FminBin ;\r\n}\r\nFminBin = 112000000UL ;\r\nFmaxBin = 170000000UL ;\r\nif (state->RF_LO > FminBin && state->RF_LO <= FmaxBin) {\r\nstatus += MXL_ControlWrite(fe, RFSYN_EN_OUTMUX, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_OUT, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_HI, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_DIVM, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_RF_DIV_BIAS, 1);\r\nstatus += MXL_ControlWrite(fe, DN_SEL_FREQ, 2);\r\ndivider_val = 16 ;\r\nFmax = FmaxBin ;\r\nFmin = FminBin ;\r\n}\r\nFminBin = 170000000UL ;\r\nFmaxBin = 225000000UL ;\r\nif (state->RF_LO > FminBin && state->RF_LO <= FmaxBin) {\r\nstatus += MXL_ControlWrite(fe, RFSYN_EN_OUTMUX, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_OUT, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_HI, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_DIVM, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_RF_DIV_BIAS, 1);\r\nstatus += MXL_ControlWrite(fe, DN_SEL_FREQ, 2);\r\ndivider_val = 16 ;\r\nFmax = FmaxBin ;\r\nFmin = FminBin ;\r\n}\r\nFminBin = 225000000UL ;\r\nFmaxBin = 300000000UL ;\r\nif (state->RF_LO > FminBin && state->RF_LO <= FmaxBin) {\r\nstatus += MXL_ControlWrite(fe, RFSYN_EN_OUTMUX, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_OUT, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_HI, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_DIVM, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_RF_DIV_BIAS, 1);\r\nstatus += MXL_ControlWrite(fe, DN_SEL_FREQ, 4);\r\ndivider_val = 8 ;\r\nFmax = 340000000UL ;\r\nFmin = FminBin ;\r\n}\r\nFminBin = 300000000UL ;\r\nFmaxBin = 340000000UL ;\r\nif (state->RF_LO > FminBin && state->RF_LO <= FmaxBin) {\r\nstatus += MXL_ControlWrite(fe, RFSYN_EN_OUTMUX, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_OUT, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_HI, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_DIVM, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_RF_DIV_BIAS, 1);\r\nstatus += MXL_ControlWrite(fe, DN_SEL_FREQ, 0);\r\ndivider_val = 8 ;\r\nFmax = FmaxBin ;\r\nFmin = 225000000UL ;\r\n}\r\nFminBin = 340000000UL ;\r\nFmaxBin = 450000000UL ;\r\nif (state->RF_LO > FminBin && state->RF_LO <= FmaxBin) {\r\nstatus += MXL_ControlWrite(fe, RFSYN_EN_OUTMUX, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_OUT, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_HI, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_DIVM, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_RF_DIV_BIAS, 2);\r\nstatus += MXL_ControlWrite(fe, DN_SEL_FREQ, 0);\r\ndivider_val = 8 ;\r\nFmax = FmaxBin ;\r\nFmin = FminBin ;\r\n}\r\nFminBin = 450000000UL ;\r\nFmaxBin = 680000000UL ;\r\nif (state->RF_LO > FminBin && state->RF_LO <= FmaxBin) {\r\nstatus += MXL_ControlWrite(fe, RFSYN_EN_OUTMUX, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_OUT, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_HI, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_DIVM, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_RF_DIV_BIAS, 1);\r\nstatus += MXL_ControlWrite(fe, DN_SEL_FREQ, 0);\r\ndivider_val = 4 ;\r\nFmax = FmaxBin ;\r\nFmin = FminBin ;\r\n}\r\nFminBin = 680000000UL ;\r\nFmaxBin = 900000000UL ;\r\nif (state->RF_LO > FminBin && state->RF_LO <= FmaxBin) {\r\nstatus += MXL_ControlWrite(fe, RFSYN_EN_OUTMUX, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_OUT, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_HI, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_DIVM, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_RF_DIV_BIAS, 1);\r\nstatus += MXL_ControlWrite(fe, DN_SEL_FREQ, 0);\r\ndivider_val = 4 ;\r\nFmax = FmaxBin ;\r\nFmin = FminBin ;\r\n}\r\nE3 = (((Fmax-state->RF_LO)/1000)*32)/((Fmax-Fmin)/1000) + 8 ;\r\nstatus += MXL_ControlWrite(fe, RFSYN_VCO_BIAS, E3);\r\nE4 = (state->RF_LO*divider_val/1000)/(2*state->Fxtal*Kdbl_RF/1000);\r\nMXL_ControlWrite(fe, CHCAL_INT_MOD_RF, E4);\r\nE5 = ((2<<17)*(state->RF_LO/10000*divider_val -\r\n(E4*(2*state->Fxtal*Kdbl_RF)/10000))) /\r\n(2*state->Fxtal*Kdbl_RF/10000);\r\nstatus += MXL_ControlWrite(fe, CHCAL_FRAC_MOD_RF, E5);\r\nE5A = (((Fmax - state->RF_LO)/1000)*4/((Fmax-Fmin)/1000)) + 1 ;\r\nstatus += MXL_ControlWrite(fe, RFSYN_LPF_R, E5A);\r\nstatus += MXL_ControlWrite(fe, CHCAL_EN_INT_RF, ((E5 == 0) ? 1 : 0));\r\nif (state->TG_LO < 33000000UL)\r\nreturn -1;\r\nFminBin = 33000000UL ;\r\nFmaxBin = 50000000UL ;\r\nif (state->TG_LO >= FminBin && state->TG_LO <= FmaxBin) {\r\nstatus += MXL_ControlWrite(fe, TG_LO_DIVVAL, 0x6);\r\nstatus += MXL_ControlWrite(fe, TG_LO_SELVAL, 0x0);\r\ndivider_val = 36 ;\r\nFmax = FmaxBin ;\r\nFmin = FminBin ;\r\n}\r\nFminBin = 50000000UL ;\r\nFmaxBin = 67000000UL ;\r\nif (state->TG_LO > FminBin && state->TG_LO <= FmaxBin) {\r\nstatus += MXL_ControlWrite(fe, TG_LO_DIVVAL, 0x1);\r\nstatus += MXL_ControlWrite(fe, TG_LO_SELVAL, 0x0);\r\ndivider_val = 24 ;\r\nFmax = FmaxBin ;\r\nFmin = FminBin ;\r\n}\r\nFminBin = 67000000UL ;\r\nFmaxBin = 100000000UL ;\r\nif (state->TG_LO > FminBin && state->TG_LO <= FmaxBin) {\r\nstatus += MXL_ControlWrite(fe, TG_LO_DIVVAL, 0xC);\r\nstatus += MXL_ControlWrite(fe, TG_LO_SELVAL, 0x2);\r\ndivider_val = 18 ;\r\nFmax = FmaxBin ;\r\nFmin = FminBin ;\r\n}\r\nFminBin = 100000000UL ;\r\nFmaxBin = 150000000UL ;\r\nif (state->TG_LO > FminBin && state->TG_LO <= FmaxBin) {\r\nstatus += MXL_ControlWrite(fe, TG_LO_DIVVAL, 0x8);\r\nstatus += MXL_ControlWrite(fe, TG_LO_SELVAL, 0x2);\r\ndivider_val = 12 ;\r\nFmax = FmaxBin ;\r\nFmin = FminBin ;\r\n}\r\nFminBin = 150000000UL ;\r\nFmaxBin = 200000000UL ;\r\nif (state->TG_LO > FminBin && state->TG_LO <= FmaxBin) {\r\nstatus += MXL_ControlWrite(fe, TG_LO_DIVVAL, 0x0);\r\nstatus += MXL_ControlWrite(fe, TG_LO_SELVAL, 0x2);\r\ndivider_val = 8 ;\r\nFmax = FmaxBin ;\r\nFmin = FminBin ;\r\n}\r\nFminBin = 200000000UL ;\r\nFmaxBin = 300000000UL ;\r\nif (state->TG_LO > FminBin && state->TG_LO <= FmaxBin) {\r\nstatus += MXL_ControlWrite(fe, TG_LO_DIVVAL, 0x8);\r\nstatus += MXL_ControlWrite(fe, TG_LO_SELVAL, 0x3);\r\ndivider_val = 6 ;\r\nFmax = FmaxBin ;\r\nFmin = FminBin ;\r\n}\r\nFminBin = 300000000UL ;\r\nFmaxBin = 400000000UL ;\r\nif (state->TG_LO > FminBin && state->TG_LO <= FmaxBin) {\r\nstatus += MXL_ControlWrite(fe, TG_LO_DIVVAL, 0x0);\r\nstatus += MXL_ControlWrite(fe, TG_LO_SELVAL, 0x3);\r\ndivider_val = 4 ;\r\nFmax = FmaxBin ;\r\nFmin = FminBin ;\r\n}\r\nFminBin = 400000000UL ;\r\nFmaxBin = 600000000UL ;\r\nif (state->TG_LO > FminBin && state->TG_LO <= FmaxBin) {\r\nstatus += MXL_ControlWrite(fe, TG_LO_DIVVAL, 0x8);\r\nstatus += MXL_ControlWrite(fe, TG_LO_SELVAL, 0x7);\r\ndivider_val = 3 ;\r\nFmax = FmaxBin ;\r\nFmin = FminBin ;\r\n}\r\nFminBin = 600000000UL ;\r\nFmaxBin = 900000000UL ;\r\nif (state->TG_LO > FminBin && state->TG_LO <= FmaxBin) {\r\nstatus += MXL_ControlWrite(fe, TG_LO_DIVVAL, 0x0);\r\nstatus += MXL_ControlWrite(fe, TG_LO_SELVAL, 0x7);\r\ndivider_val = 2 ;\r\n}\r\ntg_divval = (state->TG_LO*divider_val/100000) *\r\n(MXL_Ceiling(state->Fxtal, 1000000) * 100) /\r\n(state->Fxtal/1000);\r\nstatus += MXL_ControlWrite(fe, TG_DIV_VAL, tg_divval);\r\nif (state->TG_LO > 600000000UL)\r\nstatus += MXL_ControlWrite(fe, TG_DIV_VAL, tg_divval + 1);\r\nFmax = 1800000000UL ;\r\nFmin = 1200000000UL ;\r\nFref_TG = (state->Fxtal/1000) / MXL_Ceiling(state->Fxtal, 1000000);\r\nFvco = (state->TG_LO/10000) * divider_val * Fref_TG;\r\ntg_lo = (((Fmax/10 - Fvco)/100)*32) / ((Fmax-Fmin)/1000)+8;\r\nstatus += MXL_ControlWrite(fe, TG_VCO_BIAS , tg_lo);\r\nif (state->Mod_Type == MXL_QAM) {\r\nif (state->config->qam_gain != 0)\r\nstatus += MXL_ControlWrite(fe, RFSYN_CHP_GAIN,\r\nstate->config->qam_gain);\r\nelse if (state->RF_IN < 680000000)\r\nstatus += MXL_ControlWrite(fe, RFSYN_CHP_GAIN, 3);\r\nelse\r\nstatus += MXL_ControlWrite(fe, RFSYN_CHP_GAIN, 2);\r\n}\r\nif (state->TF_Type == MXL_TF_OFF) {\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 0);\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\n}\r\nif (state->TF_Type == MXL_TF_C) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 1);\r\nstatus += MXL_ControlWrite(fe, DAC_DIN_A, 0);\r\nif (state->RF_IN >= 43000000 && state->RF_IN < 150000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 0);\r\nstatus += MXL_ControlWrite(fe, DAC_DIN_B, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 0);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\n}\r\nif (state->RF_IN >= 150000000 && state->RF_IN < 280000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 0);\r\nstatus += MXL_ControlWrite(fe, DAC_DIN_B, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\n}\r\nif (state->RF_IN >= 280000000 && state->RF_IN < 360000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 0);\r\nstatus += MXL_ControlWrite(fe, DAC_DIN_B, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 0);\r\n}\r\nif (state->RF_IN >= 360000000 && state->RF_IN < 560000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 0);\r\nstatus += MXL_ControlWrite(fe, DAC_DIN_B, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 0);\r\n}\r\nif (state->RF_IN >= 560000000 && state->RF_IN < 580000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 1);\r\nstatus += MXL_ControlWrite(fe, DAC_DIN_B, 29);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 0);\r\n}\r\nif (state->RF_IN >= 580000000 && state->RF_IN < 630000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 1);\r\nstatus += MXL_ControlWrite(fe, DAC_DIN_B, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 0);\r\n}\r\nif (state->RF_IN >= 630000000 && state->RF_IN < 700000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 1);\r\nstatus += MXL_ControlWrite(fe, DAC_DIN_B, 16);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\n}\r\nif (state->RF_IN >= 700000000 && state->RF_IN < 760000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 1);\r\nstatus += MXL_ControlWrite(fe, DAC_DIN_B, 7);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\n}\r\nif (state->RF_IN >= 760000000 && state->RF_IN <= 900000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 1);\r\nstatus += MXL_ControlWrite(fe, DAC_DIN_B, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\n}\r\n}\r\nif (state->TF_Type == MXL_TF_C_H) {\r\nstatus += MXL_ControlWrite(fe, DAC_DIN_A, 0);\r\nif (state->RF_IN >= 43000000 && state->RF_IN < 150000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\n}\r\nif (state->RF_IN >= 150000000 && state->RF_IN < 280000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 0);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\n}\r\nif (state->RF_IN >= 280000000 && state->RF_IN < 360000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 0);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\n}\r\nif (state->RF_IN >= 360000000 && state->RF_IN < 560000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\n}\r\nif (state->RF_IN >= 560000000 && state->RF_IN < 580000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\n}\r\nif (state->RF_IN >= 580000000 && state->RF_IN < 630000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\n}\r\nif (state->RF_IN >= 630000000 && state->RF_IN < 700000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\n}\r\nif (state->RF_IN >= 700000000 && state->RF_IN < 760000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\n}\r\nif (state->RF_IN >= 760000000 && state->RF_IN <= 900000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\n}\r\n}\r\nif (state->TF_Type == MXL_TF_D) {\r\nstatus += MXL_ControlWrite(fe, DAC_DIN_B, 0);\r\nif (state->RF_IN >= 43000000 && state->RF_IN < 174000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 0);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\nif (state->RF_IN >= 174000000 && state->RF_IN < 250000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 0);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\nif (state->RF_IN >= 250000000 && state->RF_IN < 310000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\nif (state->RF_IN >= 310000000 && state->RF_IN < 360000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 0);\r\n}\r\nif (state->RF_IN >= 360000000 && state->RF_IN < 470000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 0);\r\n}\r\nif (state->RF_IN >= 470000000 && state->RF_IN < 640000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 0);\r\n}\r\nif (state->RF_IN >= 640000000 && state->RF_IN <= 900000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\n}\r\nif (state->TF_Type == MXL_TF_D_L) {\r\nstatus += MXL_ControlWrite(fe, DAC_DIN_A, 0);\r\nif (state->RF_IN >= 471000000 &&\r\n(state->RF_IN - 471000000)%6000000 != 0) {\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 0);\r\nstatus += MXL_ControlWrite(fe, AGC_IF, 10);\r\n} else {\r\nif (state->RF_IN >= 43000000 &&\r\nstate->RF_IN < 140000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 0);\r\n}\r\nif (state->RF_IN >= 140000000 &&\r\nstate->RF_IN < 240000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 0);\r\n}\r\nif (state->RF_IN >= 240000000 &&\r\nstate->RF_IN < 340000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 0);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 0);\r\n}\r\nif (state->RF_IN >= 340000000 &&\r\nstate->RF_IN < 430000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 0);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\nif (state->RF_IN >= 430000000 &&\r\nstate->RF_IN < 470000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\nif (state->RF_IN >= 470000000 &&\r\nstate->RF_IN < 570000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 0);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\nif (state->RF_IN >= 570000000 &&\r\nstate->RF_IN < 620000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 0);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\nif (state->RF_IN >= 620000000 &&\r\nstate->RF_IN < 760000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 0);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\nif (state->RF_IN >= 760000000 &&\r\nstate->RF_IN <= 900000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_A_ENABLE, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\n}\r\n}\r\nif (state->TF_Type == MXL_TF_E) {\r\nstatus += MXL_ControlWrite(fe, DAC_DIN_B, 0);\r\nif (state->RF_IN >= 43000000 && state->RF_IN < 174000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 0);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\nif (state->RF_IN >= 174000000 && state->RF_IN < 250000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 0);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\nif (state->RF_IN >= 250000000 && state->RF_IN < 310000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\nif (state->RF_IN >= 310000000 && state->RF_IN < 360000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 0);\r\n}\r\nif (state->RF_IN >= 360000000 && state->RF_IN < 470000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 0);\r\n}\r\nif (state->RF_IN >= 470000000 && state->RF_IN < 640000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 0);\r\n}\r\nif (state->RF_IN >= 640000000 && state->RF_IN <= 900000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\n}\r\nif (state->TF_Type == MXL_TF_F) {\r\nstatus += MXL_ControlWrite(fe, DAC_DIN_B, 0);\r\nif (state->RF_IN >= 43000000 && state->RF_IN < 160000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 0);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\nif (state->RF_IN >= 160000000 && state->RF_IN < 210000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 0);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\nif (state->RF_IN >= 210000000 && state->RF_IN < 300000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\nif (state->RF_IN >= 300000000 && state->RF_IN < 390000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 0);\r\n}\r\nif (state->RF_IN >= 390000000 && state->RF_IN < 515000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 0);\r\n}\r\nif (state->RF_IN >= 515000000 && state->RF_IN < 650000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 0);\r\n}\r\nif (state->RF_IN >= 650000000 && state->RF_IN <= 900000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\n}\r\nif (state->TF_Type == MXL_TF_E_2) {\r\nstatus += MXL_ControlWrite(fe, DAC_DIN_B, 0);\r\nif (state->RF_IN >= 43000000 && state->RF_IN < 174000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 0);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\nif (state->RF_IN >= 174000000 && state->RF_IN < 250000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 0);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\nif (state->RF_IN >= 250000000 && state->RF_IN < 350000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\nif (state->RF_IN >= 350000000 && state->RF_IN < 400000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 0);\r\n}\r\nif (state->RF_IN >= 400000000 && state->RF_IN < 570000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 0);\r\n}\r\nif (state->RF_IN >= 570000000 && state->RF_IN < 770000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 0);\r\n}\r\nif (state->RF_IN >= 770000000 && state->RF_IN <= 900000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\n}\r\nif (state->TF_Type == MXL_TF_G) {\r\nstatus += MXL_ControlWrite(fe, DAC_DIN_B, 0);\r\nif (state->RF_IN >= 50000000 && state->RF_IN < 190000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 0);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\nif (state->RF_IN >= 190000000 && state->RF_IN < 280000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 0);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\nif (state->RF_IN >= 280000000 && state->RF_IN < 350000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\nif (state->RF_IN >= 350000000 && state->RF_IN < 400000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 0);\r\n}\r\nif (state->RF_IN >= 400000000 && state->RF_IN < 470000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\nif (state->RF_IN >= 470000000 && state->RF_IN < 640000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 0);\r\n}\r\nif (state->RF_IN >= 640000000 && state->RF_IN < 820000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 0);\r\n}\r\nif (state->RF_IN >= 820000000 && state->RF_IN <= 900000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\n}\r\nif (state->TF_Type == MXL_TF_E_NA) {\r\nstatus += MXL_ControlWrite(fe, DAC_DIN_B, 0);\r\nif (state->RF_IN >= 471000000 &&\r\n(state->RF_IN - 471000000)%6000000 != 0) {\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_ControlWrite(fe, SEQ_EXTSYNTHCALIF, 1);\r\nstatus += MXL_ControlWrite(fe, SEQ_EXTDCCAL, 1);\r\nstatus += MXL_ControlWrite(fe, AGC_EN_RSSI, 1);\r\nstatus += MXL_ControlWrite(fe, RFA_ENCLKRFAGC, 1);\r\nstatus += MXL_ControlWrite(fe, RFA_RSSI_REFH, 5);\r\nstatus += MXL_ControlWrite(fe, RFA_RSSI_REF, 3);\r\nstatus += MXL_ControlWrite(fe, RFA_RSSI_REFL, 2);\r\nstatus += MXL_ControlWrite(fe, RFSYN_CHP_GAIN, 3);\r\n} else {\r\nstatus += MXL_ControlWrite(fe, AGC_EN_RSSI, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_CHP_GAIN, 5);\r\nif (state->RF_IN >= 43000000 && state->RF_IN < 174000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 0);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\nif (state->RF_IN >= 174000000 && state->RF_IN < 250000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 0);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\nif (state->RF_IN >= 250000000 && state->RF_IN < 350000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\nif (state->RF_IN >= 350000000 && state->RF_IN < 400000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 0);\r\nstatus += MXL_SetGPIO(fe, 3, 0);\r\n}\r\nif (state->RF_IN >= 400000000 && state->RF_IN < 570000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 0);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 0);\r\n}\r\nif (state->RF_IN >= 570000000 && state->RF_IN < 770000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 0);\r\n}\r\nif (state->RF_IN >= 770000000 && state->RF_IN <= 900000000) {\r\nstatus += MXL_ControlWrite(fe, DAC_B_ENABLE, 1);\r\nstatus += MXL_SetGPIO(fe, 4, 1);\r\nstatus += MXL_SetGPIO(fe, 1, 1);\r\nstatus += MXL_SetGPIO(fe, 3, 1);\r\n}\r\n}\r\n}\r\nreturn status ;\r\n}\r\nstatic u16 MXL_SetGPIO(struct dvb_frontend *fe, u8 GPIO_Num, u8 GPIO_Val)\r\n{\r\nu16 status = 0;\r\nif (GPIO_Num == 1)\r\nstatus += MXL_ControlWrite(fe, GPIO_1B, GPIO_Val ? 0 : 1);\r\nif (GPIO_Num == 3) {\r\nif (GPIO_Val == 1) {\r\nstatus += MXL_ControlWrite(fe, GPIO_3, 0);\r\nstatus += MXL_ControlWrite(fe, GPIO_3B, 0);\r\n}\r\nif (GPIO_Val == 0) {\r\nstatus += MXL_ControlWrite(fe, GPIO_3, 1);\r\nstatus += MXL_ControlWrite(fe, GPIO_3B, 1);\r\n}\r\nif (GPIO_Val == 3) {\r\nstatus += MXL_ControlWrite(fe, GPIO_3, 0);\r\nstatus += MXL_ControlWrite(fe, GPIO_3B, 1);\r\n}\r\n}\r\nif (GPIO_Num == 4) {\r\nif (GPIO_Val == 1) {\r\nstatus += MXL_ControlWrite(fe, GPIO_4, 0);\r\nstatus += MXL_ControlWrite(fe, GPIO_4B, 0);\r\n}\r\nif (GPIO_Val == 0) {\r\nstatus += MXL_ControlWrite(fe, GPIO_4, 1);\r\nstatus += MXL_ControlWrite(fe, GPIO_4B, 1);\r\n}\r\nif (GPIO_Val == 3) {\r\nstatus += MXL_ControlWrite(fe, GPIO_4, 0);\r\nstatus += MXL_ControlWrite(fe, GPIO_4B, 1);\r\n}\r\n}\r\nreturn status;\r\n}\r\nstatic u16 MXL_ControlWrite(struct dvb_frontend *fe, u16 ControlNum, u32 value)\r\n{\r\nu16 status = 0;\r\nstatus += MXL_ControlWrite_Group(fe, ControlNum, value, 1);\r\nstatus += MXL_ControlWrite_Group(fe, ControlNum, value, 2);\r\n#ifdef _MXL_INTERNAL\r\nstatus += MXL_ControlWrite_Group(fe, ControlNum, value, 3);\r\n#endif\r\nreturn status;\r\n}\r\nstatic u16 MXL_ControlWrite_Group(struct dvb_frontend *fe, u16 controlNum,\r\nu32 value, u16 controlGroup)\r\n{\r\nstruct mxl5005s_state *state = fe->tuner_priv;\r\nu16 i, j, k;\r\nu32 highLimit;\r\nu32 ctrlVal;\r\nif (controlGroup == 1) {\r\nfor (i = 0; i < state->Init_Ctrl_Num; i++) {\r\nif (controlNum == state->Init_Ctrl[i].Ctrl_Num) {\r\nhighLimit = 1 << state->Init_Ctrl[i].size;\r\nif (value < highLimit) {\r\nfor (j = 0; j < state->Init_Ctrl[i].size; j++) {\r\nstate->Init_Ctrl[i].val[j] = (u8)((value >> j) & 0x01);\r\nMXL_RegWriteBit(fe, (u8)(state->Init_Ctrl[i].addr[j]),\r\n(u8)(state->Init_Ctrl[i].bit[j]),\r\n(u8)((value>>j) & 0x01));\r\n}\r\nctrlVal = 0;\r\nfor (k = 0; k < state->Init_Ctrl[i].size; k++)\r\nctrlVal += state->Init_Ctrl[i].val[k] * (1 << k);\r\n} else\r\nreturn -1;\r\n}\r\n}\r\n}\r\nif (controlGroup == 2) {\r\nfor (i = 0; i < state->CH_Ctrl_Num; i++) {\r\nif (controlNum == state->CH_Ctrl[i].Ctrl_Num) {\r\nhighLimit = 1 << state->CH_Ctrl[i].size;\r\nif (value < highLimit) {\r\nfor (j = 0; j < state->CH_Ctrl[i].size; j++) {\r\nstate->CH_Ctrl[i].val[j] = (u8)((value >> j) & 0x01);\r\nMXL_RegWriteBit(fe, (u8)(state->CH_Ctrl[i].addr[j]),\r\n(u8)(state->CH_Ctrl[i].bit[j]),\r\n(u8)((value>>j) & 0x01));\r\n}\r\nctrlVal = 0;\r\nfor (k = 0; k < state->CH_Ctrl[i].size; k++)\r\nctrlVal += state->CH_Ctrl[i].val[k] * (1 << k);\r\n} else\r\nreturn -1;\r\n}\r\n}\r\n}\r\n#ifdef _MXL_INTERNAL\r\nif (controlGroup == 3) {\r\nfor (i = 0; i < state->MXL_Ctrl_Num; i++) {\r\nif (controlNum == state->MXL_Ctrl[i].Ctrl_Num) {\r\nhighLimit = (1 << state->MXL_Ctrl[i].size);\r\nif (value < highLimit) {\r\nfor (j = 0; j < state->MXL_Ctrl[i].size; j++) {\r\nstate->MXL_Ctrl[i].val[j] = (u8)((value >> j) & 0x01);\r\nMXL_RegWriteBit(fe, (u8)(state->MXL_Ctrl[i].addr[j]),\r\n(u8)(state->MXL_Ctrl[i].bit[j]),\r\n(u8)((value>>j) & 0x01));\r\n}\r\nctrlVal = 0;\r\nfor (k = 0; k < state->MXL_Ctrl[i].size; k++)\r\nctrlVal += state->\r\nMXL_Ctrl[i].val[k] *\r\n(1 << k);\r\n} else\r\nreturn -1;\r\n}\r\n}\r\n}\r\n#endif\r\nreturn 0 ;\r\n}\r\nstatic u16 MXL_RegRead(struct dvb_frontend *fe, u8 RegNum, u8 *RegVal)\r\n{\r\nstruct mxl5005s_state *state = fe->tuner_priv;\r\nint i ;\r\nfor (i = 0; i < 104; i++) {\r\nif (RegNum == state->TunerRegs[i].Reg_Num) {\r\n*RegVal = (u8)(state->TunerRegs[i].Reg_Val);\r\nreturn 0;\r\n}\r\n}\r\nreturn 1;\r\n}\r\nstatic u16 MXL_ControlRead(struct dvb_frontend *fe, u16 controlNum, u32 *value)\r\n{\r\nstruct mxl5005s_state *state = fe->tuner_priv;\r\nu32 ctrlVal ;\r\nu16 i, k ;\r\nfor (i = 0; i < state->Init_Ctrl_Num ; i++) {\r\nif (controlNum == state->Init_Ctrl[i].Ctrl_Num) {\r\nctrlVal = 0;\r\nfor (k = 0; k < state->Init_Ctrl[i].size; k++)\r\nctrlVal += state->Init_Ctrl[i].val[k] * (1<<k);\r\n*value = ctrlVal;\r\nreturn 0;\r\n}\r\n}\r\nfor (i = 0; i < state->CH_Ctrl_Num ; i++) {\r\nif (controlNum == state->CH_Ctrl[i].Ctrl_Num) {\r\nctrlVal = 0;\r\nfor (k = 0; k < state->CH_Ctrl[i].size; k++)\r\nctrlVal += state->CH_Ctrl[i].val[k] * (1 << k);\r\n*value = ctrlVal;\r\nreturn 0;\r\n}\r\n}\r\n#ifdef _MXL_INTERNAL\r\nfor (i = 0; i < state->MXL_Ctrl_Num ; i++) {\r\nif (controlNum == state->MXL_Ctrl[i].Ctrl_Num) {\r\nctrlVal = 0;\r\nfor (k = 0; k < state->MXL_Ctrl[i].size; k++)\r\nctrlVal += state->MXL_Ctrl[i].val[k] * (1<<k);\r\n*value = ctrlVal;\r\nreturn 0;\r\n}\r\n}\r\n#endif\r\nreturn 1;\r\n}\r\nstatic void MXL_RegWriteBit(struct dvb_frontend *fe, u8 address, u8 bit,\r\nu8 bitVal)\r\n{\r\nstruct mxl5005s_state *state = fe->tuner_priv;\r\nint i ;\r\nconst u8 AND_MAP[8] = {\r\n0xFE, 0xFD, 0xFB, 0xF7,\r\n0xEF, 0xDF, 0xBF, 0x7F } ;\r\nconst u8 OR_MAP[8] = {\r\n0x01, 0x02, 0x04, 0x08,\r\n0x10, 0x20, 0x40, 0x80 } ;\r\nfor (i = 0; i < state->TunerRegs_Num; i++) {\r\nif (state->TunerRegs[i].Reg_Num == address) {\r\nif (bitVal)\r\nstate->TunerRegs[i].Reg_Val |= OR_MAP[bit];\r\nelse\r\nstate->TunerRegs[i].Reg_Val &= AND_MAP[bit];\r\nbreak ;\r\n}\r\n}\r\n}\r\nstatic u32 MXL_Ceiling(u32 value, u32 resolution)\r\n{\r\nreturn value / resolution + (value % resolution > 0 ? 1 : 0);\r\n}\r\nstatic u16 MXL_GetInitRegister(struct dvb_frontend *fe, u8 *RegNum,\r\nu8 *RegVal, int *count)\r\n{\r\nu16 status = 0;\r\nint i ;\r\nu8 RegAddr[] = {\r\n11, 12, 13, 22, 32, 43, 44, 53, 56, 59, 73,\r\n76, 77, 91, 134, 135, 137, 147,\r\n156, 166, 167, 168, 25 };\r\n*count = ARRAY_SIZE(RegAddr);\r\nstatus += MXL_BlockInit(fe);\r\nfor (i = 0 ; i < *count; i++) {\r\nRegNum[i] = RegAddr[i];\r\nstatus += MXL_RegRead(fe, RegNum[i], &RegVal[i]);\r\n}\r\nreturn status;\r\n}\r\nstatic u16 MXL_GetCHRegister(struct dvb_frontend *fe, u8 *RegNum, u8 *RegVal,\r\nint *count)\r\n{\r\nu16 status = 0;\r\nint i ;\r\n#ifdef _MXL_PRODUCTION\r\nu8 RegAddr[] = {14, 15, 16, 17, 22, 43, 65, 68, 69, 70, 73, 92, 93, 106,\r\n107, 108, 109, 110, 111, 112, 136, 138, 149, 77, 166, 167, 168 } ;\r\n#else\r\nu8 RegAddr[] = {14, 15, 16, 17, 22, 43, 68, 69, 70, 73, 92, 93, 106,\r\n107, 108, 109, 110, 111, 112, 136, 138, 149, 77, 166, 167, 168 } ;\r\n#endif\r\n*count = ARRAY_SIZE(RegAddr);\r\nfor (i = 0 ; i < *count; i++) {\r\nRegNum[i] = RegAddr[i];\r\nstatus += MXL_RegRead(fe, RegNum[i], &RegVal[i]);\r\n}\r\nreturn status;\r\n}\r\nstatic u16 MXL_GetCHRegister_ZeroIF(struct dvb_frontend *fe, u8 *RegNum,\r\nu8 *RegVal, int *count)\r\n{\r\nu16 status = 0;\r\nint i;\r\nu8 RegAddr[] = {43, 136};\r\n*count = ARRAY_SIZE(RegAddr);\r\nfor (i = 0; i < *count; i++) {\r\nRegNum[i] = RegAddr[i];\r\nstatus += MXL_RegRead(fe, RegNum[i], &RegVal[i]);\r\n}\r\nreturn status;\r\n}\r\nstatic u16 MXL_GetMasterControl(u8 *MasterReg, int state)\r\n{\r\nif (state == 1)\r\n*MasterReg = 0xF3;\r\nif (state == 2)\r\n*MasterReg = 0x41;\r\nif (state == 3)\r\n*MasterReg = 0xB1;\r\nif (state == 4)\r\n*MasterReg = 0xF1;\r\nreturn 0;\r\n}\r\nstatic u16 MXL_VCORange_Test(struct dvb_frontend *fe, int VCO_Range)\r\n{\r\nstruct mxl5005s_state *state = fe->tuner_priv;\r\nu16 status = 0 ;\r\nif (VCO_Range == 1) {\r\nstatus += MXL_ControlWrite(fe, RFSYN_EN_DIV, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_EN_OUTMUX, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_DIVM, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_DIVM, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_OUT, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_RF_DIV_BIAS, 1);\r\nstatus += MXL_ControlWrite(fe, DN_SEL_FREQ, 0);\r\nif (state->Mode == 0 && state->IF_Mode == 1) {\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_HI, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_VCO_BIAS, 8);\r\nstatus += MXL_ControlWrite(fe, CHCAL_INT_MOD_RF, 56);\r\nstatus += MXL_ControlWrite(fe,\r\nCHCAL_FRAC_MOD_RF, 180224);\r\n}\r\nif (state->Mode == 0 && state->IF_Mode == 0) {\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_HI, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_VCO_BIAS, 8);\r\nstatus += MXL_ControlWrite(fe, CHCAL_INT_MOD_RF, 56);\r\nstatus += MXL_ControlWrite(fe,\r\nCHCAL_FRAC_MOD_RF, 222822);\r\n}\r\nif (state->Mode == 1) {\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_HI, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_VCO_BIAS, 8);\r\nstatus += MXL_ControlWrite(fe, CHCAL_INT_MOD_RF, 56);\r\nstatus += MXL_ControlWrite(fe,\r\nCHCAL_FRAC_MOD_RF, 229376);\r\n}\r\n}\r\nif (VCO_Range == 2) {\r\nstatus += MXL_ControlWrite(fe, RFSYN_EN_DIV, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_EN_OUTMUX, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_DIVM, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_DIVM, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_OUT, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_RF_DIV_BIAS, 1);\r\nstatus += MXL_ControlWrite(fe, DN_SEL_FREQ, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_HI, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_VCO_BIAS, 40);\r\nstatus += MXL_ControlWrite(fe, CHCAL_INT_MOD_RF, 41);\r\nif (state->Mode == 0 && state->IF_Mode == 1) {\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_HI, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_VCO_BIAS, 40);\r\nstatus += MXL_ControlWrite(fe, CHCAL_INT_MOD_RF, 42);\r\nstatus += MXL_ControlWrite(fe,\r\nCHCAL_FRAC_MOD_RF, 206438);\r\n}\r\nif (state->Mode == 0 && state->IF_Mode == 0) {\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_HI, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_VCO_BIAS, 40);\r\nstatus += MXL_ControlWrite(fe, CHCAL_INT_MOD_RF, 42);\r\nstatus += MXL_ControlWrite(fe,\r\nCHCAL_FRAC_MOD_RF, 206438);\r\n}\r\nif (state->Mode == 1) {\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_HI, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_VCO_BIAS, 40);\r\nstatus += MXL_ControlWrite(fe, CHCAL_INT_MOD_RF, 41);\r\nstatus += MXL_ControlWrite(fe,\r\nCHCAL_FRAC_MOD_RF, 16384);\r\n}\r\n}\r\nif (VCO_Range == 3) {\r\nstatus += MXL_ControlWrite(fe, RFSYN_EN_DIV, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_EN_OUTMUX, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_DIVM, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_DIVM, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_OUT, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_RF_DIV_BIAS, 1);\r\nstatus += MXL_ControlWrite(fe, DN_SEL_FREQ, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_HI, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_VCO_BIAS, 8);\r\nstatus += MXL_ControlWrite(fe, CHCAL_INT_MOD_RF, 42);\r\nif (state->Mode == 0 && state->IF_Mode == 1) {\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_HI, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_VCO_BIAS, 8);\r\nstatus += MXL_ControlWrite(fe, CHCAL_INT_MOD_RF, 44);\r\nstatus += MXL_ControlWrite(fe,\r\nCHCAL_FRAC_MOD_RF, 173670);\r\n}\r\nif (state->Mode == 0 && state->IF_Mode == 0) {\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_HI, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_VCO_BIAS, 8);\r\nstatus += MXL_ControlWrite(fe, CHCAL_INT_MOD_RF, 44);\r\nstatus += MXL_ControlWrite(fe,\r\nCHCAL_FRAC_MOD_RF, 173670);\r\n}\r\nif (state->Mode == 1) {\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_HI, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_VCO_BIAS, 8);\r\nstatus += MXL_ControlWrite(fe, CHCAL_INT_MOD_RF, 42);\r\nstatus += MXL_ControlWrite(fe,\r\nCHCAL_FRAC_MOD_RF, 245760);\r\n}\r\n}\r\nif (VCO_Range == 4) {\r\nstatus += MXL_ControlWrite(fe, RFSYN_EN_DIV, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_EN_OUTMUX, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_DIVM, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_DIVM, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_OUT, 1);\r\nstatus += MXL_ControlWrite(fe, RFSYN_RF_DIV_BIAS, 1);\r\nstatus += MXL_ControlWrite(fe, DN_SEL_FREQ, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_HI, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_VCO_BIAS, 40);\r\nstatus += MXL_ControlWrite(fe, CHCAL_INT_MOD_RF, 27);\r\nif (state->Mode == 0 && state->IF_Mode == 1) {\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_HI, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_VCO_BIAS, 40);\r\nstatus += MXL_ControlWrite(fe, CHCAL_INT_MOD_RF, 27);\r\nstatus += MXL_ControlWrite(fe,\r\nCHCAL_FRAC_MOD_RF, 206438);\r\n}\r\nif (state->Mode == 0 && state->IF_Mode == 0) {\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_HI, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_VCO_BIAS, 40);\r\nstatus += MXL_ControlWrite(fe, CHCAL_INT_MOD_RF, 27);\r\nstatus += MXL_ControlWrite(fe,\r\nCHCAL_FRAC_MOD_RF, 206438);\r\n}\r\nif (state->Mode == 1) {\r\nstatus += MXL_ControlWrite(fe, RFSYN_SEL_VCO_HI, 0);\r\nstatus += MXL_ControlWrite(fe, RFSYN_VCO_BIAS, 40);\r\nstatus += MXL_ControlWrite(fe, CHCAL_INT_MOD_RF, 27);\r\nstatus += MXL_ControlWrite(fe,\r\nCHCAL_FRAC_MOD_RF, 212992);\r\n}\r\n}\r\nreturn status;\r\n}\r\nstatic u16 MXL_Hystersis_Test(struct dvb_frontend *fe, int Hystersis)\r\n{\r\nstruct mxl5005s_state *state = fe->tuner_priv;\r\nu16 status = 0;\r\nif (Hystersis == 1)\r\nstatus += MXL_ControlWrite(fe, DN_BYPASS_AGC_I2C, 1);\r\nreturn status;\r\n}\r\nstatic int mxl5005s_reset(struct dvb_frontend *fe)\r\n{\r\nstruct mxl5005s_state *state = fe->tuner_priv;\r\nint ret = 0;\r\nu8 buf[2] = { 0xff, 0x00 };\r\nstruct i2c_msg msg = { .addr = state->config->i2c_address, .flags = 0,\r\n.buf = buf, .len = 2 };\r\ndprintk(2, "%s()\n", __func__);\r\nif (fe->ops.i2c_gate_ctrl)\r\nfe->ops.i2c_gate_ctrl(fe, 1);\r\nif (i2c_transfer(state->i2c, &msg, 1) != 1) {\r\nprintk(KERN_WARNING "mxl5005s I2C reset failed\n");\r\nret = -EREMOTEIO;\r\n}\r\nif (fe->ops.i2c_gate_ctrl)\r\nfe->ops.i2c_gate_ctrl(fe, 0);\r\nreturn ret;\r\n}\r\nstatic int mxl5005s_writereg(struct dvb_frontend *fe, u8 reg, u8 val, int latch)\r\n{\r\nstruct mxl5005s_state *state = fe->tuner_priv;\r\nu8 buf[3] = { reg, val, MXL5005S_LATCH_BYTE };\r\nstruct i2c_msg msg = { .addr = state->config->i2c_address, .flags = 0,\r\n.buf = buf, .len = 3 };\r\nif (latch == 0)\r\nmsg.len = 2;\r\ndprintk(2, "%s(0x%x, 0x%x, 0x%x)\n", __func__, reg, val, msg.addr);\r\nif (i2c_transfer(state->i2c, &msg, 1) != 1) {\r\nprintk(KERN_WARNING "mxl5005s I2C write failed\n");\r\nreturn -EREMOTEIO;\r\n}\r\nreturn 0;\r\n}\r\nstatic int mxl5005s_writeregs(struct dvb_frontend *fe, u8 *addrtable,\r\nu8 *datatable, u8 len)\r\n{\r\nint ret = 0, i;\r\nif (fe->ops.i2c_gate_ctrl)\r\nfe->ops.i2c_gate_ctrl(fe, 1);\r\nfor (i = 0 ; i < len-1; i++) {\r\nret = mxl5005s_writereg(fe, addrtable[i], datatable[i], 0);\r\nif (ret < 0)\r\nbreak;\r\n}\r\nret = mxl5005s_writereg(fe, addrtable[i], datatable[i], 1);\r\nif (fe->ops.i2c_gate_ctrl)\r\nfe->ops.i2c_gate_ctrl(fe, 0);\r\nreturn ret;\r\n}\r\nstatic int mxl5005s_init(struct dvb_frontend *fe)\r\n{\r\nstruct mxl5005s_state *state = fe->tuner_priv;\r\ndprintk(1, "%s()\n", __func__);\r\nstate->current_mode = MXL_QAM;\r\nreturn mxl5005s_reconfigure(fe, MXL_QAM, MXL5005S_BANDWIDTH_6MHZ);\r\n}\r\nstatic int mxl5005s_reconfigure(struct dvb_frontend *fe, u32 mod_type,\r\nu32 bandwidth)\r\n{\r\nstruct mxl5005s_state *state = fe->tuner_priv;\r\nu8 AddrTable[MXL5005S_REG_WRITING_TABLE_LEN_MAX];\r\nu8 ByteTable[MXL5005S_REG_WRITING_TABLE_LEN_MAX];\r\nint TableLen;\r\ndprintk(1, "%s(type=%d, bw=%d)\n", __func__, mod_type, bandwidth);\r\nmxl5005s_reset(fe);\r\nMXL_GetMasterControl(ByteTable, MC_SYNTH_RESET);\r\nAddrTable[0] = MASTER_CONTROL_ADDR;\r\nByteTable[0] |= state->config->AgcMasterByte;\r\nmxl5005s_writeregs(fe, AddrTable, ByteTable, 1);\r\nmxl5005s_AssignTunerMode(fe, mod_type, bandwidth);\r\nMXL_GetInitRegister(fe, AddrTable, ByteTable, &TableLen);\r\nmxl5005s_writeregs(fe, AddrTable, ByteTable, TableLen);\r\nreturn 0;\r\n}\r\nstatic int mxl5005s_AssignTunerMode(struct dvb_frontend *fe, u32 mod_type,\r\nu32 bandwidth)\r\n{\r\nstruct mxl5005s_state *state = fe->tuner_priv;\r\nstruct mxl5005s_config *c = state->config;\r\nInitTunerControls(fe);\r\nMXL5005_TunerConfig(\r\nfe,\r\nc->mod_mode,\r\nc->if_mode,\r\nbandwidth,\r\nc->if_freq,\r\nc->xtal_freq,\r\nc->agc_mode,\r\nc->top,\r\nc->output_load,\r\nc->clock_out,\r\nc->div_out,\r\nc->cap_select,\r\nc->rssi_enable,\r\nmod_type,\r\nc->tracking_filter);\r\nreturn 0;\r\n}\r\nstatic int mxl5005s_set_params(struct dvb_frontend *fe)\r\n{\r\nstruct mxl5005s_state *state = fe->tuner_priv;\r\nstruct dtv_frontend_properties *c = &fe->dtv_property_cache;\r\nu32 delsys = c->delivery_system;\r\nu32 bw = c->bandwidth_hz;\r\nu32 req_mode, req_bw = 0;\r\nint ret;\r\ndprintk(1, "%s()\n", __func__);\r\nswitch (delsys) {\r\ncase SYS_ATSC:\r\nreq_mode = MXL_ATSC;\r\nreq_bw = MXL5005S_BANDWIDTH_6MHZ;\r\nbreak;\r\ncase SYS_DVBC_ANNEX_B:\r\nreq_mode = MXL_QAM;\r\nreq_bw = MXL5005S_BANDWIDTH_6MHZ;\r\nbreak;\r\ndefault:\r\nreq_mode = MXL_DVBT;\r\nswitch (bw) {\r\ncase 6000000:\r\nreq_bw = MXL5005S_BANDWIDTH_6MHZ;\r\nbreak;\r\ncase 7000000:\r\nreq_bw = MXL5005S_BANDWIDTH_7MHZ;\r\nbreak;\r\ncase 8000000:\r\ncase 0:\r\nreq_bw = MXL5005S_BANDWIDTH_8MHZ;\r\nbreak;\r\ndefault:\r\nreturn -EINVAL;\r\n}\r\n}\r\nif (req_mode != state->current_mode ||\r\nreq_bw != state->Chan_Bandwidth) {\r\nstate->current_mode = req_mode;\r\nret = mxl5005s_reconfigure(fe, req_mode, req_bw);\r\n} else\r\nret = 0;\r\nif (ret == 0) {\r\ndprintk(1, "%s() freq=%d\n", __func__, c->frequency);\r\nret = mxl5005s_SetRfFreqHz(fe, c->frequency);\r\n}\r\nreturn ret;\r\n}\r\nstatic int mxl5005s_get_frequency(struct dvb_frontend *fe, u32 *frequency)\r\n{\r\nstruct mxl5005s_state *state = fe->tuner_priv;\r\ndprintk(1, "%s()\n", __func__);\r\n*frequency = state->RF_IN;\r\nreturn 0;\r\n}\r\nstatic int mxl5005s_get_bandwidth(struct dvb_frontend *fe, u32 *bandwidth)\r\n{\r\nstruct mxl5005s_state *state = fe->tuner_priv;\r\ndprintk(1, "%s()\n", __func__);\r\n*bandwidth = state->Chan_Bandwidth;\r\nreturn 0;\r\n}\r\nstatic int mxl5005s_get_if_frequency(struct dvb_frontend *fe, u32 *frequency)\r\n{\r\nstruct mxl5005s_state *state = fe->tuner_priv;\r\ndprintk(1, "%s()\n", __func__);\r\n*frequency = state->IF_OUT;\r\nreturn 0;\r\n}\r\nstatic void mxl5005s_release(struct dvb_frontend *fe)\r\n{\r\ndprintk(1, "%s()\n", __func__);\r\nkfree(fe->tuner_priv);\r\nfe->tuner_priv = NULL;\r\n}\r\nstruct dvb_frontend *mxl5005s_attach(struct dvb_frontend *fe,\r\nstruct i2c_adapter *i2c,\r\nstruct mxl5005s_config *config)\r\n{\r\nstruct mxl5005s_state *state = NULL;\r\ndprintk(1, "%s()\n", __func__);\r\nstate = kzalloc(sizeof(struct mxl5005s_state), GFP_KERNEL);\r\nif (state == NULL)\r\nreturn NULL;\r\nstate->frontend = fe;\r\nstate->config = config;\r\nstate->i2c = i2c;\r\nprintk(KERN_INFO "MXL5005S: Attached at address 0x%02x\n",\r\nconfig->i2c_address);\r\nmemcpy(&fe->ops.tuner_ops, &mxl5005s_tuner_ops,\r\nsizeof(struct dvb_tuner_ops));\r\nfe->tuner_priv = state;\r\nreturn fe;\r\n}
