static enum probes_insn __kprobes t32_check_stack(probes_opcode_t insn,\r\nstruct arch_probes_insn *asi,\r\nconst struct decode_header *h)\r\n{\r\nstatic const union decode_item table[] = {\r\nDECODE_CUSTOM (0x00100000, 0x00100000, STACK_USE_NONE),\r\nDECODE_OR (0xff9f0fc0, 0xf80d0000),\r\nDECODE_CUSTOM (0xff900fcf, 0xf800000d, STACK_USE_UNKNOWN),\r\nDECODE_CUSTOM (0xff9f0e00, 0xf80d0c00, STACK_USE_FIXED_0XX),\r\nDECODE_CUSTOM (0xffdf0000, 0xe94d0000, STACK_USE_T32STRD),\r\nDECODE_CUSTOM (0xffdf0000, 0xe90d0000, STACK_USE_STMDX),\r\nDECODE_CUSTOM (0, 0, STACK_USE_NONE),\r\nDECODE_END\r\n};\r\nreturn probes_decode_insn(insn, asi, table, false, false, stack_check_actions, NULL);\r\n}\r\nstatic enum probes_insn __kprobes t16_check_stack(probes_opcode_t insn,\r\nstruct arch_probes_insn *asi,\r\nconst struct decode_header *h)\r\n{\r\nunsigned int reglist = insn & 0x1ff;\r\nasi->stack_space = hweight32(reglist) * 4;\r\nreturn INSN_GOOD;\r\n}
