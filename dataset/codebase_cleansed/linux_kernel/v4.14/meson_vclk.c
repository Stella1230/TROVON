void meson_vid_pll_set(struct meson_drm *priv, unsigned int div)\r\n{\r\nunsigned int shift_val = 0;\r\nunsigned int shift_sel = 0;\r\nregmap_update_bits(priv->hhi, HHI_VID_PLL_CLK_DIV, VID_PLL_EN, 0);\r\nregmap_update_bits(priv->hhi, HHI_VID_PLL_CLK_DIV, VID_PLL_PRESET, 0);\r\nswitch (div) {\r\ncase VID_PLL_DIV_2:\r\nshift_val = 0x0aaa;\r\nshift_sel = 0;\r\nbreak;\r\ncase VID_PLL_DIV_2p5:\r\nshift_val = 0x5294;\r\nshift_sel = 2;\r\nbreak;\r\ncase VID_PLL_DIV_3:\r\nshift_val = 0x0db6;\r\nshift_sel = 0;\r\nbreak;\r\ncase VID_PLL_DIV_3p5:\r\nshift_val = 0x36cc;\r\nshift_sel = 1;\r\nbreak;\r\ncase VID_PLL_DIV_3p75:\r\nshift_val = 0x6666;\r\nshift_sel = 2;\r\nbreak;\r\ncase VID_PLL_DIV_4:\r\nshift_val = 0x0ccc;\r\nshift_sel = 0;\r\nbreak;\r\ncase VID_PLL_DIV_5:\r\nshift_val = 0x739c;\r\nshift_sel = 2;\r\nbreak;\r\ncase VID_PLL_DIV_6:\r\nshift_val = 0x0e38;\r\nshift_sel = 0;\r\nbreak;\r\ncase VID_PLL_DIV_6p25:\r\nshift_val = 0x0000;\r\nshift_sel = 3;\r\nbreak;\r\ncase VID_PLL_DIV_7:\r\nshift_val = 0x3c78;\r\nshift_sel = 1;\r\nbreak;\r\ncase VID_PLL_DIV_7p5:\r\nshift_val = 0x78f0;\r\nshift_sel = 2;\r\nbreak;\r\ncase VID_PLL_DIV_12:\r\nshift_val = 0x0fc0;\r\nshift_sel = 0;\r\nbreak;\r\ncase VID_PLL_DIV_14:\r\nshift_val = 0x3f80;\r\nshift_sel = 1;\r\nbreak;\r\ncase VID_PLL_DIV_15:\r\nshift_val = 0x7f80;\r\nshift_sel = 2;\r\nbreak;\r\n}\r\nif (div == VID_PLL_DIV_1)\r\nregmap_update_bits(priv->hhi, HHI_VID_PLL_CLK_DIV,\r\nVID_PLL_BYPASS, VID_PLL_BYPASS);\r\nelse {\r\nregmap_update_bits(priv->hhi, HHI_VID_PLL_CLK_DIV,\r\nVID_PLL_BYPASS, 0);\r\nregmap_update_bits(priv->hhi, HHI_VID_PLL_CLK_DIV,\r\n3 << 16, 0);\r\nregmap_update_bits(priv->hhi, HHI_VID_PLL_CLK_DIV,\r\nVID_PLL_PRESET, 0);\r\nregmap_update_bits(priv->hhi, HHI_VID_PLL_CLK_DIV,\r\n0x7fff, 0);\r\nregmap_update_bits(priv->hhi, HHI_VID_PLL_CLK_DIV,\r\n3 << 16, shift_sel << 16);\r\nregmap_update_bits(priv->hhi, HHI_VID_PLL_CLK_DIV,\r\nVID_PLL_PRESET, VID_PLL_PRESET);\r\nregmap_update_bits(priv->hhi, HHI_VID_PLL_CLK_DIV,\r\n0x7fff, shift_val);\r\nregmap_update_bits(priv->hhi, HHI_VID_PLL_CLK_DIV,\r\nVID_PLL_PRESET, 0);\r\n}\r\nregmap_update_bits(priv->hhi, HHI_VID_PLL_CLK_DIV,\r\nVID_PLL_EN, VID_PLL_EN);\r\n}\r\nstatic void meson_venci_cvbs_clock_config(struct meson_drm *priv)\r\n{\r\nunsigned int val;\r\nif (meson_vpu_is_compatible(priv, "amlogic,meson-gxbb-vpu")) {\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL, 0x5800023d);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL2, 0x00404e00);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL3, 0x0d5c5091);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL4, 0x801da72c);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL5, 0x71486980);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL6, 0x00000e55);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL, 0x4800023d);\r\n} else if (meson_vpu_is_compatible(priv, "amlogic,meson-gxm-vpu") ||\r\nmeson_vpu_is_compatible(priv, "amlogic,meson-gxl-vpu")) {\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL, 0x4000027b);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL2, 0x800cb300);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL3, 0xa6212844);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL4, 0x0c4d000c);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL5, 0x001fa729);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL6, 0x01a31500);\r\nregmap_update_bits(priv->hhi, HHI_HDMI_PLL_CNTL,\r\nHDMI_PLL_RESET, HDMI_PLL_RESET);\r\nregmap_update_bits(priv->hhi, HHI_HDMI_PLL_CNTL,\r\nHDMI_PLL_RESET, 0);\r\n}\r\nregmap_read_poll_timeout(priv->hhi, HHI_HDMI_PLL_CNTL, val,\r\n(val & HDMI_PLL_LOCK), 10, 0);\r\nregmap_update_bits(priv->hhi, HHI_VIID_CLK_CNTL, VCLK2_EN, 0);\r\nmeson_vid_pll_set(priv, VID_PLL_DIV_1);\r\nregmap_update_bits(priv->hhi, HHI_VIID_CLK_DIV,\r\nVCLK2_DIV_MASK, (55 - 1));\r\nregmap_update_bits(priv->hhi, HHI_VIID_CLK_CNTL,\r\nVCLK2_SEL_MASK, (4 << VCLK2_SEL_SHIFT));\r\nregmap_update_bits(priv->hhi, HHI_VIID_CLK_CNTL, VCLK2_EN, VCLK2_EN);\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_DIV,\r\nCTS_ENCI_SEL_MASK, (8 << CTS_ENCI_SEL_SHIFT));\r\nregmap_update_bits(priv->hhi, HHI_VIID_CLK_DIV,\r\nCTS_VDAC_SEL_MASK, (8 << CTS_VDAC_SEL_SHIFT));\r\nregmap_update_bits(priv->hhi, HHI_VIID_CLK_DIV,\r\nVCLK2_DIV_EN | VCLK2_DIV_RESET, VCLK2_DIV_EN);\r\nregmap_update_bits(priv->hhi, HHI_VIID_CLK_CNTL,\r\nVCLK2_DIV1_EN, VCLK2_DIV1_EN);\r\nregmap_update_bits(priv->hhi, HHI_VIID_CLK_CNTL,\r\nVCLK2_SOFT_RESET, VCLK2_SOFT_RESET);\r\nregmap_update_bits(priv->hhi, HHI_VIID_CLK_CNTL,\r\nVCLK2_SOFT_RESET, 0);\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_CNTL2,\r\nCTS_ENCI_EN, CTS_ENCI_EN);\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_CNTL2,\r\nCTS_VDAC_EN, CTS_VDAC_EN);\r\n}\r\nstatic inline unsigned int pll_od_to_reg(unsigned int od)\r\n{\r\nswitch (od) {\r\ncase 1:\r\nreturn 0;\r\ncase 2:\r\nreturn 1;\r\ncase 4:\r\nreturn 2;\r\ncase 8:\r\nreturn 3;\r\n}\r\nreturn 0;\r\n}\r\nvoid meson_hdmi_pll_set(struct meson_drm *priv,\r\nunsigned int base,\r\nunsigned int od1,\r\nunsigned int od2,\r\nunsigned int od3)\r\n{\r\nunsigned int val;\r\nif (meson_vpu_is_compatible(priv, "amlogic,meson-gxbb-vpu")) {\r\nswitch (base) {\r\ncase 2970000:\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL, 0x5800023d);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL2, 0x00000000);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL3, 0x0d5c5091);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL4, 0x801da72c);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL5, 0x71486980);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL6, 0x00000e55);\r\nregmap_update_bits(priv->hhi, HHI_HDMI_PLL_CNTL,\r\n0x7 << 28, 0x4 << 28);\r\nregmap_read_poll_timeout(priv->hhi, HHI_HDMI_PLL_CNTL,\r\nval, (val & HDMI_PLL_LOCK), 10, 0);\r\nregmap_update_bits(priv->hhi, HHI_HDMI_PLL_CNTL2,\r\n0xFFFF, 0x4e00);\r\nbreak;\r\ncase 4320000:\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL, 0x5800025a);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL2, 0x00000000);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL3, 0x0d5c5091);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL4, 0x801da72c);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL5, 0x71486980);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL6, 0x00000e55);\r\nregmap_update_bits(priv->hhi, HHI_HDMI_PLL_CNTL,\r\nBIT(28), 0);\r\nregmap_read_poll_timeout(priv->hhi, HHI_HDMI_PLL_CNTL,\r\nval, (val & HDMI_PLL_LOCK), 10, 0);\r\nbreak;\r\ncase 5940000:\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL, 0x5800027b);\r\nregmap_update_bits(priv->hhi, HHI_HDMI_PLL_CNTL2,\r\n0xFFFF, 0x4c00);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL3, 0x135c5091);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL4, 0x801da72c);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL5, 0x71486980);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL6, 0x00000e55);\r\nregmap_update_bits(priv->hhi, HHI_HDMI_PLL_CNTL,\r\nBIT(28), 0);\r\nregmap_read_poll_timeout(priv->hhi, HHI_HDMI_PLL_CNTL,\r\nval, (val & HDMI_PLL_LOCK), 10, 0);\r\nbreak;\r\n};\r\n} else if (meson_vpu_is_compatible(priv, "amlogic,meson-gxm-vpu") ||\r\nmeson_vpu_is_compatible(priv, "amlogic,meson-gxl-vpu")) {\r\nswitch (base) {\r\ncase 2970000:\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL, 0x4000027b);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL2, 0x800cb300);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL3, 0x860f30c4);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL4, 0x0c8e0000);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL5, 0x001fa729);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL6, 0x01a31500);\r\nbreak;\r\ncase 4320000:\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL, 0x400002b4);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL2, 0x800cb000);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL3, 0x860f30c4);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL4, 0x0c8e0000);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL5, 0x001fa729);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL6, 0x01a31500);\r\nbreak;\r\ncase 5940000:\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL, 0x400002f7);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL2, 0x800cb200);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL3, 0x860f30c4);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL4, 0x0c8e0000);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL5, 0x001fa729);\r\nregmap_write(priv->hhi, HHI_HDMI_PLL_CNTL6, 0x01a31500);\r\nbreak;\r\n};\r\nregmap_update_bits(priv->hhi, HHI_HDMI_PLL_CNTL,\r\nHDMI_PLL_RESET, HDMI_PLL_RESET);\r\nregmap_update_bits(priv->hhi, HHI_HDMI_PLL_CNTL,\r\nHDMI_PLL_RESET, 0);\r\nregmap_read_poll_timeout(priv->hhi, HHI_HDMI_PLL_CNTL, val,\r\n(val & HDMI_PLL_LOCK), 10, 0);\r\n};\r\nif (meson_vpu_is_compatible(priv, "amlogic,meson-gxbb-vpu"))\r\nregmap_update_bits(priv->hhi, HHI_HDMI_PLL_CNTL2,\r\n3 << 16, pll_od_to_reg(od1) << 16);\r\nelse if (meson_vpu_is_compatible(priv, "amlogic,meson-gxm-vpu") ||\r\nmeson_vpu_is_compatible(priv, "amlogic,meson-gxl-vpu"))\r\nregmap_update_bits(priv->hhi, HHI_HDMI_PLL_CNTL3,\r\n3 << 21, pll_od_to_reg(od1) << 21);\r\nif (meson_vpu_is_compatible(priv, "amlogic,meson-gxbb-vpu"))\r\nregmap_update_bits(priv->hhi, HHI_HDMI_PLL_CNTL2,\r\n3 << 22, pll_od_to_reg(od2) << 22);\r\nelse if (meson_vpu_is_compatible(priv, "amlogic,meson-gxm-vpu") ||\r\nmeson_vpu_is_compatible(priv, "amlogic,meson-gxl-vpu"))\r\nregmap_update_bits(priv->hhi, HHI_HDMI_PLL_CNTL3,\r\n3 << 23, pll_od_to_reg(od2) << 23);\r\nif (meson_vpu_is_compatible(priv, "amlogic,meson-gxbb-vpu"))\r\nregmap_update_bits(priv->hhi, HHI_HDMI_PLL_CNTL2,\r\n3 << 18, pll_od_to_reg(od3) << 18);\r\nelse if (meson_vpu_is_compatible(priv, "amlogic,meson-gxm-vpu") ||\r\nmeson_vpu_is_compatible(priv, "amlogic,meson-gxl-vpu"))\r\nregmap_update_bits(priv->hhi, HHI_HDMI_PLL_CNTL3,\r\n3 << 19, pll_od_to_reg(od3) << 19);\r\n}\r\nvoid meson_vclk_setup(struct meson_drm *priv, unsigned int target,\r\nunsigned int vclk_freq, unsigned int venc_freq,\r\nunsigned int dac_freq, bool hdmi_use_enci)\r\n{\r\nunsigned int freq;\r\nunsigned int hdmi_tx_div;\r\nunsigned int venc_div;\r\nif (target == MESON_VCLK_TARGET_CVBS) {\r\nmeson_venci_cvbs_clock_config(priv);\r\nreturn;\r\n}\r\nhdmi_tx_div = vclk_freq / dac_freq;\r\nif (hdmi_tx_div == 0) {\r\npr_err("Fatal Error, invalid HDMI-TX freq %d\n",\r\ndac_freq);\r\nreturn;\r\n}\r\nvenc_div = vclk_freq / venc_freq;\r\nif (venc_div == 0) {\r\npr_err("Fatal Error, invalid HDMI venc freq %d\n",\r\nvenc_freq);\r\nreturn;\r\n}\r\nswitch (vclk_freq) {\r\ncase 54000:\r\nif (hdmi_use_enci)\r\nfreq = MESON_VCLK_HDMI_ENCI_54000;\r\nelse\r\nfreq = MESON_VCLK_HDMI_DDR_54000;\r\nbreak;\r\ncase 74250:\r\nfreq = MESON_VCLK_HDMI_74250;\r\nbreak;\r\ncase 148500:\r\nif (dac_freq != 148500)\r\nfreq = MESON_VCLK_HDMI_DDR_148500;\r\nelse\r\nfreq = MESON_VCLK_HDMI_148500;\r\nbreak;\r\ncase 297000:\r\nfreq = MESON_VCLK_HDMI_297000;\r\nbreak;\r\ncase 594000:\r\nfreq = MESON_VCLK_HDMI_594000;\r\nbreak;\r\ndefault:\r\npr_err("Fatal Error, invalid HDMI vclk freq %d\n",\r\nvclk_freq);\r\nreturn;\r\n}\r\nregmap_update_bits(priv->hhi, HHI_HDMI_CLK_CNTL,\r\nCTS_HDMI_SYS_SEL_MASK, 0);\r\nregmap_update_bits(priv->hhi, HHI_HDMI_CLK_CNTL,\r\nCTS_HDMI_SYS_DIV_MASK, 0);\r\nregmap_update_bits(priv->hhi, HHI_HDMI_CLK_CNTL,\r\nCTS_HDMI_SYS_EN, CTS_HDMI_SYS_EN);\r\nmeson_hdmi_pll_set(priv, params[freq].pll_base_freq,\r\nparams[freq].pll_od1,\r\nparams[freq].pll_od2,\r\nparams[freq].pll_od3);\r\nmeson_vid_pll_set(priv, params[freq].vid_pll_div);\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_CNTL,\r\nVCLK_SEL_MASK, 0);\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_DIV,\r\nVCLK_DIV_MASK, params[freq].vclk_div - 1);\r\nswitch (hdmi_tx_div) {\r\ncase 1:\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_CNTL,\r\nVCLK_DIV1_EN, VCLK_DIV1_EN);\r\nregmap_update_bits(priv->hhi, HHI_HDMI_CLK_CNTL,\r\nHDMI_TX_PIXEL_SEL_MASK, 0);\r\nbreak;\r\ncase 2:\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_CNTL,\r\nVCLK_DIV2_EN, VCLK_DIV2_EN);\r\nregmap_update_bits(priv->hhi, HHI_HDMI_CLK_CNTL,\r\nHDMI_TX_PIXEL_SEL_MASK, 1 << HDMI_TX_PIXEL_SEL_SHIFT);\r\nbreak;\r\ncase 4:\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_CNTL,\r\nVCLK_DIV4_EN, VCLK_DIV4_EN);\r\nregmap_update_bits(priv->hhi, HHI_HDMI_CLK_CNTL,\r\nHDMI_TX_PIXEL_SEL_MASK, 2 << HDMI_TX_PIXEL_SEL_SHIFT);\r\nbreak;\r\ncase 6:\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_CNTL,\r\nVCLK_DIV6_EN, VCLK_DIV6_EN);\r\nregmap_update_bits(priv->hhi, HHI_HDMI_CLK_CNTL,\r\nHDMI_TX_PIXEL_SEL_MASK, 3 << HDMI_TX_PIXEL_SEL_SHIFT);\r\nbreak;\r\ncase 12:\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_CNTL,\r\nVCLK_DIV12_EN, VCLK_DIV12_EN);\r\nregmap_update_bits(priv->hhi, HHI_HDMI_CLK_CNTL,\r\nHDMI_TX_PIXEL_SEL_MASK, 4 << HDMI_TX_PIXEL_SEL_SHIFT);\r\nbreak;\r\n}\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_CNTL2,\r\nHDMI_TX_PIXEL_EN, HDMI_TX_PIXEL_EN);\r\nswitch (venc_div) {\r\ncase 1:\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_CNTL,\r\nVCLK_DIV1_EN, VCLK_DIV1_EN);\r\nif (hdmi_use_enci)\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_DIV,\r\nCTS_ENCI_SEL_MASK, 0);\r\nelse\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_DIV,\r\nCTS_ENCP_SEL_MASK, 0);\r\nbreak;\r\ncase 2:\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_CNTL,\r\nVCLK_DIV2_EN, VCLK_DIV2_EN);\r\nif (hdmi_use_enci)\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_DIV,\r\nCTS_ENCI_SEL_MASK, 1 << CTS_ENCI_SEL_SHIFT);\r\nelse\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_DIV,\r\nCTS_ENCP_SEL_MASK, 1 << CTS_ENCP_SEL_SHIFT);\r\nbreak;\r\ncase 4:\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_CNTL,\r\nVCLK_DIV4_EN, VCLK_DIV4_EN);\r\nif (hdmi_use_enci)\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_DIV,\r\nCTS_ENCI_SEL_MASK, 2 << CTS_ENCI_SEL_SHIFT);\r\nelse\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_DIV,\r\nCTS_ENCP_SEL_MASK, 2 << CTS_ENCP_SEL_SHIFT);\r\nbreak;\r\ncase 6:\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_CNTL,\r\nVCLK_DIV6_EN, VCLK_DIV6_EN);\r\nif (hdmi_use_enci)\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_DIV,\r\nCTS_ENCI_SEL_MASK, 3 << CTS_ENCI_SEL_SHIFT);\r\nelse\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_DIV,\r\nCTS_ENCP_SEL_MASK, 3 << CTS_ENCP_SEL_SHIFT);\r\nbreak;\r\ncase 12:\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_CNTL,\r\nVCLK_DIV12_EN, VCLK_DIV12_EN);\r\nif (hdmi_use_enci)\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_DIV,\r\nCTS_ENCI_SEL_MASK, 4 << CTS_ENCI_SEL_SHIFT);\r\nelse\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_DIV,\r\nCTS_ENCP_SEL_MASK, 4 << CTS_ENCP_SEL_SHIFT);\r\nbreak;\r\n}\r\nif (hdmi_use_enci)\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_CNTL2,\r\nCTS_ENCI_EN, CTS_ENCI_EN);\r\nelse\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_CNTL2,\r\nCTS_ENCP_EN, CTS_ENCP_EN);\r\nregmap_update_bits(priv->hhi, HHI_VID_CLK_CNTL, VCLK_EN, VCLK_EN);\r\n}
