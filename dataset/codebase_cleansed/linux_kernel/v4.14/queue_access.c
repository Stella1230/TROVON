int ia_css_queue_load(\r\nstruct ia_css_queue *rdesc,\r\nia_css_circbuf_desc_t *cb_desc,\r\nuint32_t ignore_desc_flags)\r\n{\r\nif (rdesc == NULL || cb_desc == NULL)\r\nreturn EINVAL;\r\nif (rdesc->location == IA_CSS_QUEUE_LOC_SP) {\r\nassert(ignore_desc_flags <= QUEUE_IGNORE_DESC_FLAGS_MAX);\r\nif (0 == (ignore_desc_flags & QUEUE_IGNORE_SIZE_FLAG)) {\r\ncb_desc->size = sp_dmem_load_uint8(rdesc->proc_id,\r\nrdesc->desc.remote.cb_desc_addr\r\n+ offsetof(ia_css_circbuf_desc_t, size));\r\nif (0 == cb_desc->size) {\r\nreturn EDOM;\r\n}\r\n}\r\nif (0 == (ignore_desc_flags & QUEUE_IGNORE_START_FLAG))\r\ncb_desc->start = sp_dmem_load_uint8(rdesc->proc_id,\r\nrdesc->desc.remote.cb_desc_addr\r\n+ offsetof(ia_css_circbuf_desc_t, start));\r\nif (0 == (ignore_desc_flags & QUEUE_IGNORE_END_FLAG))\r\ncb_desc->end = sp_dmem_load_uint8(rdesc->proc_id,\r\nrdesc->desc.remote.cb_desc_addr\r\n+ offsetof(ia_css_circbuf_desc_t, end));\r\nif (0 == (ignore_desc_flags & QUEUE_IGNORE_STEP_FLAG))\r\ncb_desc->step = sp_dmem_load_uint8(rdesc->proc_id,\r\nrdesc->desc.remote.cb_desc_addr\r\n+ offsetof(ia_css_circbuf_desc_t, step));\r\n} else if (rdesc->location == IA_CSS_QUEUE_LOC_HOST) {\r\nmmgr_load(rdesc->desc.remote.cb_desc_addr,\r\n(void *)cb_desc,\r\nsizeof(ia_css_circbuf_desc_t));\r\n} else if (rdesc->location == IA_CSS_QUEUE_LOC_ISP) {\r\nreturn ENOTSUP;\r\n}\r\nreturn 0;\r\n}\r\nint ia_css_queue_store(\r\nstruct ia_css_queue *rdesc,\r\nia_css_circbuf_desc_t *cb_desc,\r\nuint32_t ignore_desc_flags)\r\n{\r\nif (rdesc == NULL || cb_desc == NULL)\r\nreturn EINVAL;\r\nif (rdesc->location == IA_CSS_QUEUE_LOC_SP) {\r\nassert(ignore_desc_flags <= QUEUE_IGNORE_DESC_FLAGS_MAX);\r\nif (0 == (ignore_desc_flags & QUEUE_IGNORE_SIZE_FLAG))\r\nsp_dmem_store_uint8(rdesc->proc_id,\r\nrdesc->desc.remote.cb_desc_addr\r\n+ offsetof(ia_css_circbuf_desc_t, size),\r\ncb_desc->size);\r\nif (0 == (ignore_desc_flags & QUEUE_IGNORE_START_FLAG))\r\nsp_dmem_store_uint8(rdesc->proc_id,\r\nrdesc->desc.remote.cb_desc_addr\r\n+ offsetof(ia_css_circbuf_desc_t, start),\r\ncb_desc->start);\r\nif (0 == (ignore_desc_flags & QUEUE_IGNORE_END_FLAG))\r\nsp_dmem_store_uint8(rdesc->proc_id,\r\nrdesc->desc.remote.cb_desc_addr\r\n+ offsetof(ia_css_circbuf_desc_t, end),\r\ncb_desc->end);\r\nif (0 == (ignore_desc_flags & QUEUE_IGNORE_STEP_FLAG))\r\nsp_dmem_store_uint8(rdesc->proc_id,\r\nrdesc->desc.remote.cb_desc_addr\r\n+ offsetof(ia_css_circbuf_desc_t, step),\r\ncb_desc->step);\r\n} else if (rdesc->location == IA_CSS_QUEUE_LOC_HOST) {\r\nmmgr_store(rdesc->desc.remote.cb_desc_addr,\r\n(void *)cb_desc,\r\nsizeof(ia_css_circbuf_desc_t));\r\n} else if (rdesc->location == IA_CSS_QUEUE_LOC_ISP) {\r\nreturn ENOTSUP;\r\n}\r\nreturn 0;\r\n}\r\nint ia_css_queue_item_load(\r\nstruct ia_css_queue *rdesc,\r\nuint8_t position,\r\nia_css_circbuf_elem_t *item)\r\n{\r\nif (rdesc == NULL || item == NULL)\r\nreturn EINVAL;\r\nif (rdesc->location == IA_CSS_QUEUE_LOC_SP) {\r\nsp_dmem_load(rdesc->proc_id,\r\nrdesc->desc.remote.cb_elems_addr\r\n+ position * sizeof(ia_css_circbuf_elem_t),\r\nitem,\r\nsizeof(ia_css_circbuf_elem_t));\r\n} else if (rdesc->location == IA_CSS_QUEUE_LOC_HOST) {\r\nmmgr_load(rdesc->desc.remote.cb_elems_addr\r\n+ position * sizeof(ia_css_circbuf_elem_t),\r\n(void *)item,\r\nsizeof(ia_css_circbuf_elem_t));\r\n} else if (rdesc->location == IA_CSS_QUEUE_LOC_ISP) {\r\nreturn ENOTSUP;\r\n}\r\nreturn 0;\r\n}\r\nint ia_css_queue_item_store(\r\nstruct ia_css_queue *rdesc,\r\nuint8_t position,\r\nia_css_circbuf_elem_t *item)\r\n{\r\nif (rdesc == NULL || item == NULL)\r\nreturn EINVAL;\r\nif (rdesc->location == IA_CSS_QUEUE_LOC_SP) {\r\nsp_dmem_store(rdesc->proc_id,\r\nrdesc->desc.remote.cb_elems_addr\r\n+ position * sizeof(ia_css_circbuf_elem_t),\r\nitem,\r\nsizeof(ia_css_circbuf_elem_t));\r\n} else if (rdesc->location == IA_CSS_QUEUE_LOC_HOST) {\r\nmmgr_store(rdesc->desc.remote.cb_elems_addr\r\n+ position * sizeof(ia_css_circbuf_elem_t),\r\n(void *)item,\r\nsizeof(ia_css_circbuf_elem_t));\r\n} else if (rdesc->location == IA_CSS_QUEUE_LOC_ISP) {\r\nreturn ENOTSUP;\r\n}\r\nreturn 0;\r\n}
