static int retrode_input_configured(struct hid_device *hdev,\r\nstruct hid_input *hi)\r\n{\r\nstruct hid_field *field = hi->report->field[0];\r\nconst char *suffix;\r\nint number = 0;\r\nchar *name;\r\nswitch (field->report->id) {\r\ncase 0:\r\nsuffix = "SNES Mouse";\r\nbreak;\r\ncase 1:\r\ncase 2:\r\nsuffix = "SNES / N64";\r\nnumber = field->report->id;\r\nbreak;\r\ncase 3:\r\ncase 4:\r\nsuffix = "Mega Drive";\r\nnumber = field->report->id - 2;\r\nbreak;\r\ndefault:\r\nhid_err(hdev, "Got unhandled report id %d\n", field->report->id);\r\nsuffix = "Unknown";\r\n}\r\nif (number)\r\nname = devm_kasprintf(&hdev->dev, GFP_KERNEL,\r\n"%s %s #%d", CONTROLLER_NAME_BASE,\r\nsuffix, number);\r\nelse\r\nname = devm_kasprintf(&hdev->dev, GFP_KERNEL,\r\n"%s %s", CONTROLLER_NAME_BASE, suffix);\r\nif (!name)\r\nreturn -ENOMEM;\r\nhi->input->name = name;\r\nreturn 0;\r\n}\r\nstatic int retrode_probe(struct hid_device *hdev,\r\nconst struct hid_device_id *id)\r\n{\r\nint ret;\r\nhdev->quirks |= HID_QUIRK_MULTI_INPUT;\r\nret = hid_parse(hdev);\r\nif (ret)\r\nreturn ret;\r\nret = hid_hw_start(hdev, HID_CONNECT_DEFAULT);\r\nif (ret)\r\nreturn ret;\r\nreturn 0;\r\n}
