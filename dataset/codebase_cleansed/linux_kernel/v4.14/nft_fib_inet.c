static void nft_fib_inet_eval(const struct nft_expr *expr,\r\nstruct nft_regs *regs,\r\nconst struct nft_pktinfo *pkt)\r\n{\r\nconst struct nft_fib *priv = nft_expr_priv(expr);\r\nswitch (nft_pf(pkt)) {\r\ncase NFPROTO_IPV4:\r\nswitch (priv->result) {\r\ncase NFT_FIB_RESULT_OIF:\r\ncase NFT_FIB_RESULT_OIFNAME:\r\nreturn nft_fib4_eval(expr, regs, pkt);\r\ncase NFT_FIB_RESULT_ADDRTYPE:\r\nreturn nft_fib4_eval_type(expr, regs, pkt);\r\n}\r\nbreak;\r\ncase NFPROTO_IPV6:\r\nswitch (priv->result) {\r\ncase NFT_FIB_RESULT_OIF:\r\ncase NFT_FIB_RESULT_OIFNAME:\r\nreturn nft_fib6_eval(expr, regs, pkt);\r\ncase NFT_FIB_RESULT_ADDRTYPE:\r\nreturn nft_fib6_eval_type(expr, regs, pkt);\r\n}\r\nbreak;\r\n}\r\nregs->verdict.code = NF_DROP;\r\n}\r\nstatic int __init nft_fib_inet_module_init(void)\r\n{\r\nreturn nft_register_expr(&nft_fib_inet_type);\r\n}\r\nstatic void __exit nft_fib_inet_module_exit(void)\r\n{\r\nnft_unregister_expr(&nft_fib_inet_type);\r\n}
