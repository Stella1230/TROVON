unsigned int ptp_classify_raw(const struct sk_buff *skb)\r\n{\r\nreturn BPF_PROG_RUN(ptp_insns, skb);\r\n}\r\nvoid __init ptp_classifier_init(void)\r\n{\r\nstatic struct sock_filter ptp_filter[] __initdata = {\r\n{ 0x28, 0, 0, 0x0000000c },\r\n{ 0x15, 0, 12, 0x00000800 },\r\n{ 0x30, 0, 0, 0x00000017 },\r\n{ 0x15, 0, 9, 0x00000011 },\r\n{ 0x28, 0, 0, 0x00000014 },\r\n{ 0x45, 7, 0, 0x00001fff },\r\n{ 0xb1, 0, 0, 0x0000000e },\r\n{ 0x48, 0, 0, 0x00000010 },\r\n{ 0x15, 0, 4, 0x0000013f },\r\n{ 0x48, 0, 0, 0x00000016 },\r\n{ 0x54, 0, 0, 0x0000000f },\r\n{ 0x44, 0, 0, 0x00000010 },\r\n{ 0x16, 0, 0, 0x00000000 },\r\n{ 0x06, 0, 0, 0x00000000 },\r\n{ 0x15, 0, 9, 0x000086dd },\r\n{ 0x30, 0, 0, 0x00000014 },\r\n{ 0x15, 0, 6, 0x00000011 },\r\n{ 0x28, 0, 0, 0x00000038 },\r\n{ 0x15, 0, 4, 0x0000013f },\r\n{ 0x28, 0, 0, 0x0000003e },\r\n{ 0x54, 0, 0, 0x0000000f },\r\n{ 0x44, 0, 0, 0x00000020 },\r\n{ 0x16, 0, 0, 0x00000000 },\r\n{ 0x06, 0, 0, 0x00000000 },\r\n{ 0x15, 0, 32, 0x00008100 },\r\n{ 0x28, 0, 0, 0x00000010 },\r\n{ 0x15, 0, 7, 0x000088f7 },\r\n{ 0x30, 0, 0, 0x00000012 },\r\n{ 0x54, 0, 0, 0x00000008 },\r\n{ 0x15, 0, 35, 0x00000000 },\r\n{ 0x28, 0, 0, 0x00000012 },\r\n{ 0x54, 0, 0, 0x0000000f },\r\n{ 0x44, 0, 0, 0x000000c0 },\r\n{ 0x16, 0, 0, 0x00000000 },\r\n{ 0x15, 0, 12, 0x00000800 },\r\n{ 0x30, 0, 0, 0x0000001b },\r\n{ 0x15, 0, 9, 0x00000011 },\r\n{ 0x28, 0, 0, 0x00000018 },\r\n{ 0x45, 7, 0, 0x00001fff },\r\n{ 0xb1, 0, 0, 0x00000012 },\r\n{ 0x48, 0, 0, 0x00000014 },\r\n{ 0x15, 0, 4, 0x0000013f },\r\n{ 0x48, 0, 0, 0x0000001a },\r\n{ 0x54, 0, 0, 0x0000000f },\r\n{ 0x44, 0, 0, 0x00000090 },\r\n{ 0x16, 0, 0, 0x00000000 },\r\n{ 0x06, 0, 0, 0x00000000 },\r\n{ 0x15, 0, 8, 0x000086dd },\r\n{ 0x30, 0, 0, 0x00000018 },\r\n{ 0x15, 0, 6, 0x00000011 },\r\n{ 0x28, 0, 0, 0x0000003c },\r\n{ 0x15, 0, 4, 0x0000013f },\r\n{ 0x28, 0, 0, 0x00000042 },\r\n{ 0x54, 0, 0, 0x0000000f },\r\n{ 0x44, 0, 0, 0x000000a0 },\r\n{ 0x16, 0, 0, 0x00000000 },\r\n{ 0x06, 0, 0, 0x00000000 },\r\n{ 0x15, 0, 7, 0x000088f7 },\r\n{ 0x30, 0, 0, 0x0000000e },\r\n{ 0x54, 0, 0, 0x00000008 },\r\n{ 0x15, 0, 4, 0x00000000 },\r\n{ 0x28, 0, 0, 0x0000000e },\r\n{ 0x54, 0, 0, 0x0000000f },\r\n{ 0x44, 0, 0, 0x00000040 },\r\n{ 0x16, 0, 0, 0x00000000 },\r\n{ 0x06, 0, 0, 0x00000000 },\r\n};\r\nstruct sock_fprog_kern ptp_prog = {\r\n.len = ARRAY_SIZE(ptp_filter), .filter = ptp_filter,\r\n};\r\nBUG_ON(bpf_prog_create(&ptp_insns, &ptp_prog));\r\n}
