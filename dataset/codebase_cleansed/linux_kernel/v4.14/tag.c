void\r\nsh_css_create_tag_descr(int num_captures,\r\nunsigned int skip,\r\nint offset,\r\nunsigned int exp_id,\r\nstruct sh_css_tag_descr *tag_descr)\r\n{\r\nassert(tag_descr != NULL);\r\ntag_descr->num_captures = num_captures;\r\ntag_descr->skip = skip;\r\ntag_descr->offset = offset;\r\ntag_descr->exp_id = exp_id;\r\n}\r\nunsigned int\r\nsh_css_encode_tag_descr(struct sh_css_tag_descr *tag)\r\n{\r\nint num_captures;\r\nunsigned int num_captures_sign;\r\nunsigned int skip;\r\nint offset;\r\nunsigned int offset_sign;\r\nunsigned int exp_id;\r\nunsigned int encoded_tag;\r\nassert(tag != NULL);\r\nif (tag->num_captures < 0) {\r\nnum_captures = -tag->num_captures;\r\nnum_captures_sign = 1;\r\n} else {\r\nnum_captures = tag->num_captures;\r\nnum_captures_sign = 0;\r\n}\r\nskip = tag->skip;\r\nif (tag->offset < 0) {\r\noffset = -tag->offset;\r\noffset_sign = 1;\r\n} else {\r\noffset = tag->offset;\r\noffset_sign = 0;\r\n}\r\nexp_id = tag->exp_id;\r\nif (exp_id != 0)\r\n{\r\nassert((num_captures == 0) && (skip == 0) && (offset == 0));\r\nencoded_tag = TAG_EXP | (exp_id & 0xFF) << TAG_EXP_ID_SHIFT;\r\n}\r\nelse\r\n{\r\nencoded_tag = TAG_CAP\r\n| ((num_captures_sign & 0x00000001) << TAG_NUM_CAPTURES_SIGN_SHIFT)\r\n| ((offset_sign & 0x00000001) << TAG_OFFSET_SIGN_SHIFT)\r\n| ((num_captures & 0x000000FF) << TAG_NUM_CAPTURES_SHIFT)\r\n| ((skip & 0x000000FF) << TAG_OFFSET_SHIFT)\r\n| ((offset & 0x000000FF) << TAG_SKIP_SHIFT);\r\n}\r\nreturn encoded_tag;\r\n}
