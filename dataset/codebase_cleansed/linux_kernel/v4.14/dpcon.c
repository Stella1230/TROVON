int dpcon_open(struct fsl_mc_io *mc_io,\r\nu32 cmd_flags,\r\nint dpcon_id,\r\nu16 *token)\r\n{\r\nstruct mc_command cmd = { 0 };\r\nstruct dpcon_cmd_open *dpcon_cmd;\r\nint err;\r\ncmd.header = mc_encode_cmd_header(DPCON_CMDID_OPEN,\r\ncmd_flags,\r\n0);\r\ndpcon_cmd = (struct dpcon_cmd_open *)cmd.params;\r\ndpcon_cmd->dpcon_id = cpu_to_le32(dpcon_id);\r\nerr = mc_send_command(mc_io, &cmd);\r\nif (err)\r\nreturn err;\r\n*token = mc_cmd_hdr_read_token(&cmd);\r\nreturn 0;\r\n}\r\nint dpcon_close(struct fsl_mc_io *mc_io,\r\nu32 cmd_flags,\r\nu16 token)\r\n{\r\nstruct mc_command cmd = { 0 };\r\ncmd.header = mc_encode_cmd_header(DPCON_CMDID_CLOSE,\r\ncmd_flags,\r\ntoken);\r\nreturn mc_send_command(mc_io, &cmd);\r\n}\r\nint dpcon_enable(struct fsl_mc_io *mc_io,\r\nu32 cmd_flags,\r\nu16 token)\r\n{\r\nstruct mc_command cmd = { 0 };\r\ncmd.header = mc_encode_cmd_header(DPCON_CMDID_ENABLE,\r\ncmd_flags,\r\ntoken);\r\nreturn mc_send_command(mc_io, &cmd);\r\n}\r\nint dpcon_disable(struct fsl_mc_io *mc_io,\r\nu32 cmd_flags,\r\nu16 token)\r\n{\r\nstruct mc_command cmd = { 0 };\r\ncmd.header = mc_encode_cmd_header(DPCON_CMDID_DISABLE,\r\ncmd_flags,\r\ntoken);\r\nreturn mc_send_command(mc_io, &cmd);\r\n}\r\nint dpcon_is_enabled(struct fsl_mc_io *mc_io,\r\nu32 cmd_flags,\r\nu16 token,\r\nint *en)\r\n{\r\nstruct mc_command cmd = { 0 };\r\nstruct dpcon_rsp_is_enabled *dpcon_rsp;\r\nint err;\r\ncmd.header = mc_encode_cmd_header(DPCON_CMDID_IS_ENABLED,\r\ncmd_flags,\r\ntoken);\r\nerr = mc_send_command(mc_io, &cmd);\r\nif (err)\r\nreturn err;\r\ndpcon_rsp = (struct dpcon_rsp_is_enabled *)cmd.params;\r\n*en = dpcon_rsp->enabled & DPCON_ENABLE;\r\nreturn 0;\r\n}\r\nint dpcon_reset(struct fsl_mc_io *mc_io,\r\nu32 cmd_flags,\r\nu16 token)\r\n{\r\nstruct mc_command cmd = { 0 };\r\ncmd.header = mc_encode_cmd_header(DPCON_CMDID_RESET,\r\ncmd_flags, token);\r\nreturn mc_send_command(mc_io, &cmd);\r\n}\r\nint dpcon_get_attributes(struct fsl_mc_io *mc_io,\r\nu32 cmd_flags,\r\nu16 token,\r\nstruct dpcon_attr *attr)\r\n{\r\nstruct mc_command cmd = { 0 };\r\nstruct dpcon_rsp_get_attr *dpcon_rsp;\r\nint err;\r\ncmd.header = mc_encode_cmd_header(DPCON_CMDID_GET_ATTR,\r\ncmd_flags,\r\ntoken);\r\nerr = mc_send_command(mc_io, &cmd);\r\nif (err)\r\nreturn err;\r\ndpcon_rsp = (struct dpcon_rsp_get_attr *)cmd.params;\r\nattr->id = le32_to_cpu(dpcon_rsp->id);\r\nattr->qbman_ch_id = le16_to_cpu(dpcon_rsp->qbman_ch_id);\r\nattr->num_priorities = dpcon_rsp->num_priorities;\r\nreturn 0;\r\n}\r\nint dpcon_set_notification(struct fsl_mc_io *mc_io,\r\nu32 cmd_flags,\r\nu16 token,\r\nstruct dpcon_notification_cfg *cfg)\r\n{\r\nstruct mc_command cmd = { 0 };\r\nstruct dpcon_cmd_set_notification *dpcon_cmd;\r\ncmd.header = mc_encode_cmd_header(DPCON_CMDID_SET_NOTIFICATION,\r\ncmd_flags,\r\ntoken);\r\ndpcon_cmd = (struct dpcon_cmd_set_notification *)cmd.params;\r\ndpcon_cmd->dpio_id = cpu_to_le32(cfg->dpio_id);\r\ndpcon_cmd->priority = cfg->priority;\r\ndpcon_cmd->user_ctx = cpu_to_le64(cfg->user_ctx);\r\nreturn mc_send_command(mc_io, &cmd);\r\n}\r\nint dpcon_get_api_version(struct fsl_mc_io *mc_io,\r\nu32 cmd_flags,\r\nu16 *major_ver,\r\nu16 *minor_ver)\r\n{\r\nstruct mc_command cmd = { 0 };\r\nint err;\r\ncmd.header = mc_encode_cmd_header(DPCON_CMDID_GET_API_VERSION,\r\ncmd_flags, 0);\r\nerr = mc_send_command(mc_io, &cmd);\r\nif (err)\r\nreturn err;\r\nmc_cmd_read_api_version(&cmd, major_ver, minor_ver);\r\nreturn 0;\r\n}
