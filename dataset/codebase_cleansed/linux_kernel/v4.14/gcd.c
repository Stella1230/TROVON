unsigned long gcd(unsigned long a, unsigned long b)\r\n{\r\nunsigned long r = a | b;\r\nif (!a || !b)\r\nreturn r;\r\nb >>= __ffs(b);\r\nif (b == 1)\r\nreturn r & -r;\r\nfor (;;) {\r\na >>= __ffs(a);\r\nif (a == 1)\r\nreturn r & -r;\r\nif (a == b)\r\nreturn a << __ffs(r);\r\nif (a < b)\r\nswap(a, b);\r\na -= b;\r\n}\r\n}\r\nunsigned long gcd(unsigned long a, unsigned long b)\r\n{\r\nunsigned long r = a | b;\r\nif (!a || !b)\r\nreturn r;\r\nr &= -r;\r\nwhile (!(b & r))\r\nb >>= 1;\r\nif (b == r)\r\nreturn r;\r\nfor (;;) {\r\nwhile (!(a & r))\r\na >>= 1;\r\nif (a == r)\r\nreturn r;\r\nif (a == b)\r\nreturn a;\r\nif (a < b)\r\nswap(a, b);\r\na -= b;\r\na >>= 1;\r\nif (a & r)\r\na += b;\r\na >>= 1;\r\n}\r\n}
