struct device_node *dss_of_port_get_parent_device(struct device_node *port)\r\n{\r\nstruct device_node *np;\r\nint i;\r\nif (!port)\r\nreturn NULL;\r\nnp = of_get_parent(port);\r\nfor (i = 0; i < 2 && np; ++i) {\r\nstruct property *prop;\r\nprop = of_find_property(np, "compatible", NULL);\r\nif (prop)\r\nreturn np;\r\nnp = of_get_next_parent(np);\r\n}\r\nreturn NULL;\r\n}\r\nu32 dss_of_port_get_port_number(struct device_node *port)\r\n{\r\nint r;\r\nu32 reg;\r\nr = of_property_read_u32(port, "reg", &reg);\r\nif (r)\r\nreg = 0;\r\nreturn reg;\r\n}\r\nstruct omap_dss_device *\r\nomapdss_of_find_source_for_first_ep(struct device_node *node)\r\n{\r\nstruct device_node *ep;\r\nstruct device_node *src_port;\r\nstruct omap_dss_device *src;\r\nep = of_graph_get_endpoint_by_regs(node, 0, 0);\r\nif (!ep)\r\nreturn ERR_PTR(-EINVAL);\r\nsrc_port = of_graph_get_remote_port(ep);\r\nif (!src_port) {\r\nof_node_put(ep);\r\nreturn ERR_PTR(-EINVAL);\r\n}\r\nof_node_put(ep);\r\nsrc = omap_dss_find_output_by_port_node(src_port);\r\nof_node_put(src_port);\r\nreturn src ? src : ERR_PTR(-EPROBE_DEFER);\r\n}
