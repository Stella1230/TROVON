static void pxa2xx_ac97_warm_reset(struct snd_ac97 *ac97)\r\n{\r\npxa2xx_ac97_try_warm_reset(ac97);\r\npxa2xx_ac97_finish_reset(ac97);\r\n}\r\nstatic void pxa2xx_ac97_cold_reset(struct snd_ac97 *ac97)\r\n{\r\npxa2xx_ac97_try_cold_reset(ac97);\r\npxa2xx_ac97_finish_reset(ac97);\r\n}\r\nstatic int pxa2xx_ac97_hifi_startup(struct snd_pcm_substream *substream,\r\nstruct snd_soc_dai *cpu_dai)\r\n{\r\nstruct snd_dmaengine_dai_dma_data *dma_data;\r\nif (substream->stream == SNDRV_PCM_STREAM_PLAYBACK)\r\ndma_data = &pxa2xx_ac97_pcm_stereo_out;\r\nelse\r\ndma_data = &pxa2xx_ac97_pcm_stereo_in;\r\nsnd_soc_dai_set_dma_data(cpu_dai, substream, dma_data);\r\nreturn 0;\r\n}\r\nstatic int pxa2xx_ac97_aux_startup(struct snd_pcm_substream *substream,\r\nstruct snd_soc_dai *cpu_dai)\r\n{\r\nstruct snd_dmaengine_dai_dma_data *dma_data;\r\nif (substream->stream == SNDRV_PCM_STREAM_PLAYBACK)\r\ndma_data = &pxa2xx_ac97_pcm_aux_mono_out;\r\nelse\r\ndma_data = &pxa2xx_ac97_pcm_aux_mono_in;\r\nsnd_soc_dai_set_dma_data(cpu_dai, substream, dma_data);\r\nreturn 0;\r\n}\r\nstatic int pxa2xx_ac97_mic_startup(struct snd_pcm_substream *substream,\r\nstruct snd_soc_dai *cpu_dai)\r\n{\r\nif (substream->stream == SNDRV_PCM_STREAM_PLAYBACK)\r\nreturn -ENODEV;\r\nsnd_soc_dai_set_dma_data(cpu_dai, substream,\r\n&pxa2xx_ac97_pcm_mic_mono_in);\r\nreturn 0;\r\n}\r\nstatic int pxa2xx_ac97_dev_probe(struct platform_device *pdev)\r\n{\r\nint ret;\r\nif (pdev->id != -1) {\r\ndev_err(&pdev->dev, "PXA2xx has only one AC97 port.\n");\r\nreturn -ENXIO;\r\n}\r\nret = pxa2xx_ac97_hw_probe(pdev);\r\nif (ret) {\r\ndev_err(&pdev->dev, "PXA2xx AC97 hw probe error (%d)\n", ret);\r\nreturn ret;\r\n}\r\nret = snd_soc_set_ac97_ops(&pxa2xx_ac97_ops);\r\nif (ret != 0)\r\nreturn ret;\r\nreturn snd_soc_register_component(&pdev->dev, &pxa_ac97_component,\r\npxa_ac97_dai_driver, ARRAY_SIZE(pxa_ac97_dai_driver));\r\n}\r\nstatic int pxa2xx_ac97_dev_remove(struct platform_device *pdev)\r\n{\r\nsnd_soc_unregister_component(&pdev->dev);\r\nsnd_soc_set_ac97_ops(NULL);\r\npxa2xx_ac97_hw_remove(pdev);\r\nreturn 0;\r\n}\r\nstatic int pxa2xx_ac97_dev_suspend(struct device *dev)\r\n{\r\nreturn pxa2xx_ac97_hw_suspend();\r\n}\r\nstatic int pxa2xx_ac97_dev_resume(struct device *dev)\r\n{\r\nreturn pxa2xx_ac97_hw_resume();\r\n}
