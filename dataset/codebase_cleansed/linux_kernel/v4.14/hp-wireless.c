static int hp_wireless_input_setup(void)\r\n{\r\nint err;\r\nhpwl_input_dev = input_allocate_device();\r\nif (!hpwl_input_dev)\r\nreturn -ENOMEM;\r\nhpwl_input_dev->name = "HP Wireless hotkeys";\r\nhpwl_input_dev->phys = "hpq6001/input0";\r\nhpwl_input_dev->id.bustype = BUS_HOST;\r\nhpwl_input_dev->evbit[0] = BIT(EV_KEY);\r\nset_bit(KEY_RFKILL, hpwl_input_dev->keybit);\r\nerr = input_register_device(hpwl_input_dev);\r\nif (err)\r\ngoto err_free_dev;\r\nreturn 0;\r\nerr_free_dev:\r\ninput_free_device(hpwl_input_dev);\r\nreturn err;\r\n}\r\nstatic void hp_wireless_input_destroy(void)\r\n{\r\ninput_unregister_device(hpwl_input_dev);\r\n}\r\nstatic void hpwl_notify(struct acpi_device *acpi_dev, u32 event)\r\n{\r\nif (event != 0x80) {\r\npr_info("Received unknown event (0x%x)\n", event);\r\nreturn;\r\n}\r\ninput_report_key(hpwl_input_dev, KEY_RFKILL, 1);\r\ninput_sync(hpwl_input_dev);\r\ninput_report_key(hpwl_input_dev, KEY_RFKILL, 0);\r\ninput_sync(hpwl_input_dev);\r\n}\r\nstatic int hpwl_add(struct acpi_device *device)\r\n{\r\nint err;\r\nerr = hp_wireless_input_setup();\r\nif (err)\r\npr_err("Failed to setup hp wireless hotkeys\n");\r\nreturn err;\r\n}\r\nstatic int hpwl_remove(struct acpi_device *device)\r\n{\r\nhp_wireless_input_destroy();\r\nreturn 0;\r\n}
