static void\r\nacr_r364_fixup_hs_desc(struct acr_r352 *acr, struct nvkm_secboot *sb,\r\nvoid *_desc)\r\n{\r\nstruct acr_r364_hsflcn_desc *desc = _desc;\r\nstruct nvkm_gpuobj *ls_blob = acr->ls_blob;\r\nif (sb->wpr_size == 0) {\r\nu64 wpr_start = ls_blob->addr;\r\nu64 wpr_end = ls_blob->addr + ls_blob->size;\r\nif (acr->func->shadow_blob)\r\nwpr_start += ls_blob->size / 2;\r\ndesc->wpr_region_id = 1;\r\ndesc->regions.no_regions = 2;\r\ndesc->regions.region_props[0].start_addr = wpr_start >> 8;\r\ndesc->regions.region_props[0].end_addr = wpr_end >> 8;\r\ndesc->regions.region_props[0].region_id = 1;\r\ndesc->regions.region_props[0].read_mask = 0xf;\r\ndesc->regions.region_props[0].write_mask = 0xc;\r\ndesc->regions.region_props[0].client_mask = 0x2;\r\nif (acr->func->shadow_blob)\r\ndesc->regions.region_props[0].shadow_mem_start_addr =\r\nls_blob->addr >> 8;\r\nelse\r\ndesc->regions.region_props[0].shadow_mem_start_addr = 0;\r\n} else {\r\ndesc->ucode_blob_base = ls_blob->addr;\r\ndesc->ucode_blob_size = ls_blob->size;\r\n}\r\n}\r\nstruct nvkm_acr *\r\nacr_r364_new(unsigned long managed_falcons)\r\n{\r\nreturn acr_r352_new_(&acr_r364_func, NVKM_SECBOOT_FALCON_PMU,\r\nmanaged_falcons);\r\n}
