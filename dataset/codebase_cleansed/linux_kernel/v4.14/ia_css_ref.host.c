void\r\nia_css_ref_config(\r\nstruct sh_css_isp_ref_isp_config *to,\r\nconst struct ia_css_ref_configuration *from,\r\nunsigned size)\r\n{\r\nunsigned elems_a = ISP_VEC_NELEMS, i;\r\n(void)size;\r\nia_css_dma_configure_from_info(&to->port_b, &(from->ref_frames[0]->info));\r\nto->width_a_over_b = elems_a / to->port_b.elems;\r\nto->dvs_frame_delay = from->dvs_frame_delay;\r\nfor (i = 0; i < MAX_NUM_VIDEO_DELAY_FRAMES; i++) {\r\nif (from->ref_frames[i]) {\r\nto->ref_frame_addr_y[i] = from->ref_frames[i]->data + from->ref_frames[i]->planes.yuv.y.offset;\r\nto->ref_frame_addr_c[i] = from->ref_frames[i]->data + from->ref_frames[i]->planes.yuv.u.offset;\r\n} else {\r\nto->ref_frame_addr_y[i] = 0;\r\nto->ref_frame_addr_c[i] = 0;\r\n}\r\n}\r\nassert (elems_a % to->port_b.elems == 0);\r\n}\r\nvoid\r\nia_css_ref_configure(\r\nconst struct ia_css_binary *binary,\r\nconst struct ia_css_frame **ref_frames,\r\nconst uint32_t dvs_frame_delay)\r\n{\r\nstruct ia_css_ref_configuration config;\r\nunsigned i;\r\nfor (i = 0; i < MAX_NUM_VIDEO_DELAY_FRAMES; i++)\r\nconfig.ref_frames[i] = ref_frames[i];\r\nconfig.dvs_frame_delay = dvs_frame_delay;\r\nia_css_configure_ref(binary, &config);\r\n}\r\nvoid\r\nia_css_init_ref_state(\r\nstruct sh_css_isp_ref_dmem_state *state,\r\nunsigned size)\r\n{\r\n(void)size;\r\nassert(MAX_NUM_VIDEO_DELAY_FRAMES >= 2);\r\nstate->ref_in_buf_idx = 0;\r\nstate->ref_out_buf_idx = 1;\r\n}
