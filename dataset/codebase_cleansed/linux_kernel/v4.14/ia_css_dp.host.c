void\r\nia_css_dp_encode(\r\nstruct sh_css_isp_dp_params *to,\r\nconst struct ia_css_dp_config *from,\r\nunsigned size)\r\n{\r\nint gain = from->gain;\r\nint gr = from->gr;\r\nint r = from->r;\r\nint b = from->b;\r\nint gb = from->gb;\r\n(void)size;\r\nto->threshold_single =\r\nSH_CSS_BAYER_MAXVAL;\r\nto->threshold_2adjacent =\r\nuDIGIT_FITTING(from->threshold, 16, SH_CSS_BAYER_BITS);\r\nto->gain =\r\nuDIGIT_FITTING(from->gain, 8, SH_CSS_DP_GAIN_SHIFT);\r\nto->coef_rr_gr =\r\nuDIGIT_FITTING (gain * gr / r, 8, SH_CSS_DP_GAIN_SHIFT);\r\nto->coef_rr_gb =\r\nuDIGIT_FITTING (gain * gb / r, 8, SH_CSS_DP_GAIN_SHIFT);\r\nto->coef_bb_gb =\r\nuDIGIT_FITTING (gain * gb / b, 8, SH_CSS_DP_GAIN_SHIFT);\r\nto->coef_bb_gr =\r\nuDIGIT_FITTING (gain * gr / b, 8, SH_CSS_DP_GAIN_SHIFT);\r\nto->coef_gr_rr =\r\nuDIGIT_FITTING (gain * r / gr, 8, SH_CSS_DP_GAIN_SHIFT);\r\nto->coef_gr_bb =\r\nuDIGIT_FITTING (gain * b / gr, 8, SH_CSS_DP_GAIN_SHIFT);\r\nto->coef_gb_bb =\r\nuDIGIT_FITTING (gain * b / gb, 8, SH_CSS_DP_GAIN_SHIFT);\r\nto->coef_gb_rr =\r\nuDIGIT_FITTING (gain * r / gb, 8, SH_CSS_DP_GAIN_SHIFT);\r\n}\r\nvoid\r\nia_css_dp_dump(\r\nconst struct sh_css_isp_dp_params *dp,\r\nunsigned level)\r\n{\r\nif (!dp) return;\r\nia_css_debug_dtrace(level, "Defect Pixel Correction:\n");\r\nia_css_debug_dtrace(level, "\t%-32s = %d\n",\r\n"dp_threshold_single_w_2adj_on",\r\ndp->threshold_single);\r\nia_css_debug_dtrace(level, "\t%-32s = %d\n",\r\n"dp_threshold_2adj_w_2adj_on",\r\ndp->threshold_2adjacent);\r\nia_css_debug_dtrace(level, "\t%-32s = %d\n",\r\n"dp_gain", dp->gain);\r\nia_css_debug_dtrace(level, "\t%-32s = %d\n",\r\n"dpc_coef_rr_gr", dp->coef_rr_gr);\r\nia_css_debug_dtrace(level, "\t%-32s = %d\n",\r\n"dpc_coef_rr_gb", dp->coef_rr_gb);\r\nia_css_debug_dtrace(level, "\t%-32s = %d\n",\r\n"dpc_coef_bb_gb", dp->coef_bb_gb);\r\nia_css_debug_dtrace(level, "\t%-32s = %d\n",\r\n"dpc_coef_bb_gr", dp->coef_bb_gr);\r\nia_css_debug_dtrace(level, "\t%-32s = %d\n",\r\n"dpc_coef_gr_rr", dp->coef_gr_rr);\r\nia_css_debug_dtrace(level, "\t%-32s = %d\n",\r\n"dpc_coef_gr_bb", dp->coef_gr_bb);\r\nia_css_debug_dtrace(level, "\t%-32s = %d\n",\r\n"dpc_coef_gb_bb", dp->coef_gb_bb);\r\nia_css_debug_dtrace(level, "\t%-32s = %d\n",\r\n"dpc_coef_gb_rr", dp->coef_gb_rr);\r\n}\r\nvoid\r\nia_css_dp_debug_dtrace(\r\nconst struct ia_css_dp_config *config,\r\nunsigned level)\r\n{\r\nia_css_debug_dtrace(level,\r\n"config.threshold=%d, config.gain=%d\n",\r\nconfig->threshold, config->gain);\r\n}\r\nvoid\r\nia_css_init_dp_state(\r\nvoid *state,\r\nsize_t size)\r\n{\r\nmemset(state, 0, size);\r\n}
