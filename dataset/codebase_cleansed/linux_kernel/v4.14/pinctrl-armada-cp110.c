static void mvebu_pinctrl_assign_variant(struct mvebu_mpp_mode *m,\r\nu8 variant)\r\n{\r\nstruct mvebu_mpp_ctrl_setting *s;\r\nfor (s = m->settings ; s->name ; s++)\r\ns->variant = variant;\r\n}\r\nstatic int armada_cp110_pinctrl_probe(struct platform_device *pdev)\r\n{\r\nstruct mvebu_pinctrl_soc_info *soc;\r\nconst struct of_device_id *match =\r\nof_match_device(armada_cp110_pinctrl_of_match, &pdev->dev);\r\nint i;\r\nif (!pdev->dev.parent)\r\nreturn -ENODEV;\r\nsoc = devm_kzalloc(&pdev->dev,\r\nsizeof(struct mvebu_pinctrl_soc_info), GFP_KERNEL);\r\nif (!soc)\r\nreturn -ENOMEM;\r\nsoc->variant = (unsigned long) match->data & 0xff;\r\nsoc->controls = armada_cp110_mpp_controls;\r\nsoc->ncontrols = ARRAY_SIZE(armada_cp110_mpp_controls);\r\nsoc->modes = armada_cp110_mpp_modes;\r\nsoc->nmodes = ARRAY_SIZE(armada_cp110_mpp_modes);\r\nfor (i = 0; i < ARRAY_SIZE(armada_cp110_mpp_modes); i++) {\r\nstruct mvebu_mpp_mode *m = &armada_cp110_mpp_modes[i];\r\nswitch (i) {\r\ncase 0 ... 31:\r\nmvebu_pinctrl_assign_variant(m, V_ARMADA_7K_8K_CPS);\r\nbreak;\r\ncase 32 ... 38:\r\nmvebu_pinctrl_assign_variant(m, V_ARMADA_7K_8K_CPM);\r\nbreak;\r\ncase 39 ... 43:\r\nmvebu_pinctrl_assign_variant(m, V_ARMADA_8K_CPM);\r\nbreak;\r\ncase 44 ... 62:\r\nmvebu_pinctrl_assign_variant(m, V_ARMADA_7K_8K_CPM);\r\nbreak;\r\n}\r\n}\r\npdev->dev.platform_data = soc;\r\nreturn mvebu_pinctrl_simple_regmap_probe(pdev, pdev->dev.parent, 0);\r\n}
