struct nvkm_ior *\r\nnvkm_ior_find(struct nvkm_disp *disp, enum nvkm_ior_type type, int id)\r\n{\r\nstruct nvkm_ior *ior;\r\nlist_for_each_entry(ior, &disp->ior, head) {\r\nif (ior->type == type && (id < 0 || ior->id == id))\r\nreturn ior;\r\n}\r\nreturn NULL;\r\n}\r\nvoid\r\nnvkm_ior_del(struct nvkm_ior **pior)\r\n{\r\nstruct nvkm_ior *ior = *pior;\r\nif (ior) {\r\nIOR_DBG(ior, "dtor");\r\nlist_del(&ior->head);\r\nkfree(*pior);\r\n*pior = NULL;\r\n}\r\n}\r\nint\r\nnvkm_ior_new_(const struct nvkm_ior_func *func, struct nvkm_disp *disp,\r\nenum nvkm_ior_type type, int id)\r\n{\r\nstruct nvkm_ior *ior;\r\nif (!(ior = kzalloc(sizeof(*ior), GFP_KERNEL)))\r\nreturn -ENOMEM;\r\nior->func = func;\r\nior->disp = disp;\r\nior->type = type;\r\nior->id = id;\r\nsnprintf(ior->name, sizeof(ior->name), "%s-%d",\r\nnvkm_ior_name[ior->type], ior->id);\r\nlist_add_tail(&ior->head, &disp->ior);\r\nIOR_DBG(ior, "ctor");\r\nreturn 0;\r\n}
