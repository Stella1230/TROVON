static unsigned int cyc_complexity_execute(void)\r\n{\r\nint complexity;\r\nexpanded_location xloc;\r\ncomplexity = n_edges_for_fn(cfun) - n_basic_blocks_for_fn(cfun) + 2;\r\nxloc = expand_location(DECL_SOURCE_LOCATION(current_function_decl));\r\nfprintf(stderr, "Cyclomatic Complexity %d %s:%s\n", complexity,\r\nxloc.file, DECL_NAME_POINTER(current_function_decl));\r\nreturn 0;\r\n}\r\n__visible int plugin_init(struct plugin_name_args *plugin_info, struct plugin_gcc_version *version)\r\n{\r\nconst char * const plugin_name = plugin_info->base_name;\r\nPASS_INFO(cyc_complexity, "ssa", 1, PASS_POS_INSERT_AFTER);\r\nif (!plugin_default_version_check(version, &gcc_version)) {\r\nerror(G_("incompatible gcc/plugin versions"));\r\nreturn 1;\r\n}\r\nregister_callback(plugin_name, PLUGIN_INFO, NULL,\r\n&cyc_complexity_plugin_info);\r\nregister_callback(plugin_name, PLUGIN_PASS_MANAGER_SETUP, NULL,\r\n&cyc_complexity_pass_info);\r\nreturn 0;\r\n}
