void\r\nia_css_tnr_encode(\r\nstruct sh_css_isp_tnr_params *to,\r\nconst struct ia_css_tnr_config *from,\r\nunsigned size)\r\n{\r\n(void)size;\r\nto->coef =\r\nuDIGIT_FITTING(from->gain, 16, SH_CSS_TNR_COEF_SHIFT);\r\nto->threshold_Y =\r\nuDIGIT_FITTING(from->threshold_y, 16, SH_CSS_ISP_YUV_BITS);\r\nto->threshold_C =\r\nuDIGIT_FITTING(from->threshold_uv, 16, SH_CSS_ISP_YUV_BITS);\r\n}\r\nvoid\r\nia_css_tnr_dump(\r\nconst struct sh_css_isp_tnr_params *tnr,\r\nunsigned level)\r\n{\r\nif (!tnr) return;\r\nia_css_debug_dtrace(level, "Temporal Noise Reduction:\n");\r\nia_css_debug_dtrace(level, "\t%-32s = %d\n",\r\n"tnr_coef", tnr->coef);\r\nia_css_debug_dtrace(level, "\t%-32s = %d\n",\r\n"tnr_threshold_Y", tnr->threshold_Y);\r\nia_css_debug_dtrace(level, "\t%-32s = %d\n",\r\n"tnr_threshold_C", tnr->threshold_C);\r\n}\r\nvoid\r\nia_css_tnr_debug_dtrace(\r\nconst struct ia_css_tnr_config *config,\r\nunsigned level)\r\n{\r\nia_css_debug_dtrace(level,\r\n"config.gain=%d, "\r\n"config.threshold_y=%d, config.threshold_uv=%d\n",\r\nconfig->gain,\r\nconfig->threshold_y, config->threshold_uv);\r\n}\r\nvoid\r\nia_css_tnr_configure(\r\nconst struct ia_css_binary *binary,\r\nconst struct ia_css_frame **frames)\r\n{\r\nstruct ia_css_tnr_configuration config;\r\nunsigned i;\r\n#ifndef ISP2401\r\nfor (i = 0; i < NUM_VIDEO_TNR_FRAMES; i++)\r\n#else\r\nfor (i = 0; i < NUM_TNR_FRAMES; i++)\r\n#endif\r\nconfig.tnr_frames[i] = frames[i];\r\nia_css_configure_tnr(binary, &config);\r\n}\r\nvoid\r\nia_css_init_tnr_state(\r\nstruct sh_css_isp_tnr_dmem_state *state,\r\nsize_t size)\r\n{\r\n(void)size;\r\n#ifndef ISP2401\r\nassert(NUM_VIDEO_TNR_FRAMES >= 2);\r\n#endif\r\nassert(sizeof(*state) == size);\r\nstate->tnr_in_buf_idx = 0;\r\nstate->tnr_out_buf_idx = 1;\r\n}
