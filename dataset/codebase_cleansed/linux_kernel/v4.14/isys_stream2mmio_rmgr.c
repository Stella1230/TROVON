void ia_css_isys_stream2mmio_sid_rmgr_init(void)\r\n{\r\nmemset(isys_stream2mmio_rsrc, 0, sizeof(isys_stream2mmio_rsrc));\r\n}\r\nvoid ia_css_isys_stream2mmio_sid_rmgr_uninit(void)\r\n{\r\nmemset(isys_stream2mmio_rsrc, 0, sizeof(isys_stream2mmio_rsrc));\r\n}\r\nbool ia_css_isys_stream2mmio_sid_rmgr_acquire(\r\nstream2mmio_ID_t stream2mmio,\r\nstream2mmio_sid_ID_t *sid)\r\n{\r\nbool retval = false;\r\nstream2mmio_sid_ID_t max_sid;\r\nisys_stream2mmio_rsrc_t *cur_rsrc = NULL;\r\nstream2mmio_sid_ID_t i;\r\nassert(stream2mmio < N_STREAM2MMIO_ID);\r\nassert(sid != NULL);\r\nif ((stream2mmio < N_STREAM2MMIO_ID) && (sid != NULL)) {\r\nmax_sid = N_STREAM2MMIO_SID_PROCS[stream2mmio];\r\ncur_rsrc = &isys_stream2mmio_rsrc[stream2mmio];\r\nif (cur_rsrc->num_active < max_sid) {\r\nfor (i = STREAM2MMIO_SID0_ID; i < max_sid; i++) {\r\nif (bitop_getbit(cur_rsrc->active_table, i) == 0) {\r\nbitop_setbit(cur_rsrc->active_table, i);\r\n*sid = i;\r\ncur_rsrc->num_active++;\r\nretval = true;\r\nbreak;\r\n}\r\n}\r\n}\r\n}\r\nreturn retval;\r\n}\r\nvoid ia_css_isys_stream2mmio_sid_rmgr_release(\r\nstream2mmio_ID_t stream2mmio,\r\nstream2mmio_sid_ID_t *sid)\r\n{\r\nstream2mmio_sid_ID_t max_sid;\r\nisys_stream2mmio_rsrc_t *cur_rsrc = NULL;\r\nassert(stream2mmio < N_STREAM2MMIO_ID);\r\nassert(sid != NULL);\r\nif ((stream2mmio < N_STREAM2MMIO_ID) && (sid != NULL)) {\r\nmax_sid = N_STREAM2MMIO_SID_PROCS[stream2mmio];\r\ncur_rsrc = &isys_stream2mmio_rsrc[stream2mmio];\r\nif ((*sid < max_sid) && (cur_rsrc->num_active > 0)) {\r\nif (bitop_getbit(cur_rsrc->active_table, *sid) == 1) {\r\nbitop_clearbit(cur_rsrc->active_table, *sid);\r\ncur_rsrc->num_active--;\r\n}\r\n}\r\n}\r\n}
