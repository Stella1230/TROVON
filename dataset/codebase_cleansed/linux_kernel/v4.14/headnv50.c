static void\r\nnv50_head_vblank_put(struct nvkm_head *head)\r\n{\r\nstruct nvkm_device *device = head->disp->engine.subdev.device;\r\nnvkm_mask(device, 0x61002c, (4 << head->id), 0);\r\n}\r\nstatic void\r\nnv50_head_vblank_get(struct nvkm_head *head)\r\n{\r\nstruct nvkm_device *device = head->disp->engine.subdev.device;\r\nnvkm_mask(device, 0x61002c, (4 << head->id), (4 << head->id));\r\n}\r\nstatic void\r\nnv50_head_rgclk(struct nvkm_head *head, int div)\r\n{\r\nstruct nvkm_device *device = head->disp->engine.subdev.device;\r\nnvkm_mask(device, 0x614200 + (head->id * 0x800), 0x0000000f, div);\r\n}\r\nvoid\r\nnv50_head_rgpos(struct nvkm_head *head, u16 *hline, u16 *vline)\r\n{\r\nstruct nvkm_device *device = head->disp->engine.subdev.device;\r\nconst u32 hoff = head->id * 0x800;\r\n*vline = nvkm_rd32(device, 0x616340 + hoff) & 0x0000ffff;\r\n*hline = nvkm_rd32(device, 0x616344 + hoff) & 0x0000ffff;\r\n}\r\nstatic void\r\nnv50_head_state(struct nvkm_head *head, struct nvkm_head_state *state)\r\n{\r\nstruct nvkm_device *device = head->disp->engine.subdev.device;\r\nconst u32 hoff = head->id * 0x540 + (state == &head->arm) * 4;\r\nu32 data;\r\ndata = nvkm_rd32(device, 0x610ae8 + hoff);\r\nstate->vblanke = (data & 0xffff0000) >> 16;\r\nstate->hblanke = (data & 0x0000ffff);\r\ndata = nvkm_rd32(device, 0x610af0 + hoff);\r\nstate->vblanks = (data & 0xffff0000) >> 16;\r\nstate->hblanks = (data & 0x0000ffff);\r\ndata = nvkm_rd32(device, 0x610af8 + hoff);\r\nstate->vtotal = (data & 0xffff0000) >> 16;\r\nstate->htotal = (data & 0x0000ffff);\r\ndata = nvkm_rd32(device, 0x610b00 + hoff);\r\nstate->vsynce = (data & 0xffff0000) >> 16;\r\nstate->hsynce = (data & 0x0000ffff);\r\nstate->hz = (nvkm_rd32(device, 0x610ad0 + hoff) & 0x003fffff) * 1000;\r\n}\r\nint\r\nnv50_head_new(struct nvkm_disp *disp, int id)\r\n{\r\nreturn nvkm_head_new_(&nv50_head, disp, id);\r\n}
