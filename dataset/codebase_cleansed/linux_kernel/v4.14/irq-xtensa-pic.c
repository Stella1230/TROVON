static int xtensa_pic_irq_domain_xlate(struct irq_domain *d,\r\nstruct device_node *ctrlr,\r\nconst u32 *intspec, unsigned int intsize,\r\nunsigned long *out_hwirq, unsigned int *out_type)\r\n{\r\nreturn xtensa_irq_domain_xlate(intspec, intsize,\r\nintspec[0], intspec[0],\r\nout_hwirq, out_type);\r\n}\r\nstatic void xtensa_irq_mask(struct irq_data *d)\r\n{\r\ncached_irq_mask &= ~(1 << d->hwirq);\r\nset_sr(cached_irq_mask, intenable);\r\n}\r\nstatic void xtensa_irq_unmask(struct irq_data *d)\r\n{\r\ncached_irq_mask |= 1 << d->hwirq;\r\nset_sr(cached_irq_mask, intenable);\r\n}\r\nstatic void xtensa_irq_enable(struct irq_data *d)\r\n{\r\nvariant_irq_enable(d->hwirq);\r\nxtensa_irq_unmask(d);\r\n}\r\nstatic void xtensa_irq_disable(struct irq_data *d)\r\n{\r\nxtensa_irq_mask(d);\r\nvariant_irq_disable(d->hwirq);\r\n}\r\nstatic void xtensa_irq_ack(struct irq_data *d)\r\n{\r\nset_sr(1 << d->hwirq, intclear);\r\n}\r\nstatic int xtensa_irq_retrigger(struct irq_data *d)\r\n{\r\nset_sr(1 << d->hwirq, intset);\r\nreturn 1;\r\n}\r\nint __init xtensa_pic_init_legacy(struct device_node *interrupt_parent)\r\n{\r\nstruct irq_domain *root_domain =\r\nirq_domain_add_legacy(NULL, NR_IRQS - 1, 1, 0,\r\n&xtensa_irq_domain_ops, &xtensa_irq_chip);\r\nirq_set_default_host(root_domain);\r\nreturn 0;\r\n}\r\nstatic int __init xtensa_pic_init(struct device_node *np,\r\nstruct device_node *interrupt_parent)\r\n{\r\nstruct irq_domain *root_domain =\r\nirq_domain_add_linear(np, NR_IRQS, &xtensa_irq_domain_ops,\r\n&xtensa_irq_chip);\r\nirq_set_default_host(root_domain);\r\nreturn 0;\r\n}
