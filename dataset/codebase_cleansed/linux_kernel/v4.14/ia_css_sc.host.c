void\r\nia_css_sc_encode(\r\nstruct sh_css_isp_sc_params *to,\r\nstruct ia_css_shading_table **from,\r\nunsigned size)\r\n{\r\n(void)size;\r\nto->gain_shift = (*from)->fraction_bits;\r\n}\r\nvoid\r\nia_css_sc_dump(\r\nconst struct sh_css_isp_sc_params *sc,\r\nunsigned level)\r\n{\r\nif (!sc) return;\r\nia_css_debug_dtrace(level, "Shading Correction:\n");\r\nia_css_debug_dtrace(level, "\t%-32s = %d\n",\r\n"sc_gain_shift", sc->gain_shift);\r\n}\r\nvoid\r\nia_css_sc_config(\r\nstruct sh_css_isp_sc_isp_config *to,\r\nconst struct ia_css_sc_configuration *from,\r\nunsigned size)\r\n{\r\nuint32_t internal_org_x_bqs = from->internal_frame_origin_x_bqs_on_sctbl;\r\nuint32_t internal_org_y_bqs = from->internal_frame_origin_y_bqs_on_sctbl;\r\nuint32_t slice, rest, i;\r\n(void)size;\r\nrest = internal_org_x_bqs;\r\nfor (i = 0; i < SH_CSS_SC_INTERPED_GAIN_HOR_SLICE_TIMES; i++) {\r\nslice = min(rest, ((uint32_t)ISP_SLICE_NELEMS));\r\nrest = rest - slice;\r\nto->interped_gain_hor_slice_bqs[i] = slice;\r\n}\r\nto->internal_frame_origin_y_bqs_on_sctbl = internal_org_y_bqs;\r\n}\r\nvoid\r\nia_css_sc_configure(\r\nconst struct ia_css_binary *binary,\r\nuint32_t internal_frame_origin_x_bqs_on_sctbl,\r\nuint32_t internal_frame_origin_y_bqs_on_sctbl)\r\n{\r\nconst struct ia_css_sc_configuration config = {\r\ninternal_frame_origin_x_bqs_on_sctbl,\r\ninternal_frame_origin_y_bqs_on_sctbl };\r\nia_css_configure_sc(binary, &config);\r\n}\r\nvoid\r\nsh_css_get_shading_settings(const struct ia_css_isp_parameters *params,\r\nstruct ia_css_shading_settings *settings)\r\n{\r\nif (settings == NULL)\r\nreturn;\r\nassert(params != NULL);\r\nia_css_debug_dtrace(IA_CSS_DEBUG_TRACE,\r\n"ia_css_get_shading_settings() enter: settings=%p\n", settings);\r\n*settings = params->shading_settings;\r\nia_css_debug_dtrace(IA_CSS_DEBUG_TRACE,\r\n"ia_css_get_shading_settings() leave: settings.enable_shading_table_conversion=%d\n",\r\nsettings->enable_shading_table_conversion);\r\n}\r\nvoid\r\nsh_css_set_shading_settings(struct ia_css_isp_parameters *params,\r\nconst struct ia_css_shading_settings *settings)\r\n{\r\nif (settings == NULL)\r\nreturn;\r\nassert(params != NULL);\r\nia_css_debug_dtrace(IA_CSS_DEBUG_TRACE,\r\n"ia_css_set_shading_settings() enter: settings.enable_shading_table_conversion=%d\n",\r\nsettings->enable_shading_table_conversion);\r\nparams->shading_settings = *settings;\r\nparams->shading_settings_changed = true;\r\nia_css_debug_dtrace(IA_CSS_DEBUG_TRACE,\r\n"ia_css_set_shading_settings() leave: return_void\n");\r\n}
