static int mvebu_v7_enter_idle(struct cpuidle_device *dev,\r\nstruct cpuidle_driver *drv,\r\nint index)\r\n{\r\nint ret;\r\nbool deepidle = false;\r\ncpu_pm_enter();\r\nif (drv->states[index].flags & MVEBU_V7_FLAG_DEEP_IDLE)\r\ndeepidle = true;\r\nret = mvebu_v7_cpu_suspend(deepidle);\r\ncpu_pm_exit();\r\nif (ret)\r\nreturn ret;\r\nreturn index;\r\n}\r\nstatic int mvebu_v7_cpuidle_probe(struct platform_device *pdev)\r\n{\r\nconst struct platform_device_id *id = pdev->id_entry;\r\nif (!id)\r\nreturn -EINVAL;\r\nmvebu_v7_cpu_suspend = pdev->dev.platform_data;\r\nreturn cpuidle_register((struct cpuidle_driver *)id->driver_data, NULL);\r\n}
