const char *get_system_type(void)\r\n{\r\nreturn system_types[mips_machtype];\r\n}\r\nvoid __weak __init mach_prom_init_machtype(void)\r\n{\r\n}\r\nvoid __init prom_init_machtype(void)\r\n{\r\nchar *p, str[MACHTYPE_LEN + 1];\r\nint machtype = MACH_LEMOTE_FL2E;\r\nmips_machtype = LOONGSON_MACHTYPE;\r\np = strstr(arcs_cmdline, "machtype=");\r\nif (!p) {\r\nmach_prom_init_machtype();\r\nreturn;\r\n}\r\np += strlen("machtype=");\r\nstrncpy(str, p, MACHTYPE_LEN);\r\nstr[MACHTYPE_LEN] = '\0';\r\np = strstr(str, " ");\r\nif (p)\r\n*p = '\0';\r\nfor (; system_types[machtype]; machtype++)\r\nif (strstr(system_types[machtype], str)) {\r\nmips_machtype = machtype;\r\nbreak;\r\n}\r\n}
