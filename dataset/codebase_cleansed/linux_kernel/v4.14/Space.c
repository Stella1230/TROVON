static int __init probe_list2(int unit, struct devprobe2 *p, int autoprobe)\r\n{\r\nstruct net_device *dev;\r\nfor (; p->probe; p++) {\r\nif (autoprobe && p->status)\r\ncontinue;\r\ndev = p->probe(unit);\r\nif (!IS_ERR(dev))\r\nreturn 0;\r\nif (autoprobe)\r\np->status = PTR_ERR(dev);\r\n}\r\nreturn -ENODEV;\r\n}\r\nstatic void __init ethif_probe2(int unit)\r\n{\r\nunsigned long base_addr = netdev_boot_base("eth", unit);\r\nif (base_addr == 1)\r\nreturn;\r\n(void)(probe_list2(unit, m68k_probes, base_addr == 0) &&\r\nprobe_list2(unit, isa_probes, base_addr == 0));\r\n}\r\nstatic int __init net_olddevs_init(void)\r\n{\r\nint num;\r\n#ifdef CONFIG_SBNI\r\nfor (num = 0; num < 8; ++num)\r\nsbni_probe(num);\r\n#endif\r\nfor (num = 0; num < 8; ++num)\r\nethif_probe2(num);\r\n#ifdef CONFIG_COPS\r\ncops_probe(0);\r\ncops_probe(1);\r\ncops_probe(2);\r\n#endif\r\n#ifdef CONFIG_LTPC\r\nltpc_probe();\r\n#endif\r\nreturn 0;\r\n}
