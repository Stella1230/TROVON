int bpf_synrto(struct bpf_sock_ops *skops)\r\n{\r\nint rv = -1;\r\nint op;\r\nif (bpf_ntohl(skops->remote_port) != 55601 &&\r\nskops->local_port != 55601)\r\nreturn -1;\r\nop = (int) skops->op;\r\n#ifdef DEBUG\r\nbpf_printk("BPF command: %d\n", op);\r\n#endif\r\nif (op == BPF_SOCK_OPS_TIMEOUT_INIT &&\r\nskops->family == AF_INET6) {\r\nif (skops->local_ip6[0] == skops->remote_ip6[0] &&\r\n(bpf_ntohl(skops->local_ip6[1]) & 0xfff00000) ==\r\n(bpf_ntohl(skops->remote_ip6[1]) & 0xfff00000))\r\nrv = 10;\r\n}\r\n#ifdef DEBUG\r\nbpf_printk("Returning %d\n", rv);\r\n#endif\r\nskops->reply = rv;\r\nreturn 1;\r\n}
