static u8\r\nacpi_ex_do_match(u32 match_op,\r\nunion acpi_operand_object *package_obj,\r\nunion acpi_operand_object *match_obj)\r\n{\r\nu8 logical_result = TRUE;\r\nacpi_status status;\r\nswitch (match_op) {\r\ncase MATCH_MTR:\r\nbreak;\r\ncase MATCH_MEQ:\r\nstatus =\r\nacpi_ex_do_logical_op(AML_LOGICAL_EQUAL_OP, match_obj,\r\npackage_obj, &logical_result);\r\nif (ACPI_FAILURE(status)) {\r\nreturn (FALSE);\r\n}\r\nbreak;\r\ncase MATCH_MLE:\r\nstatus =\r\nacpi_ex_do_logical_op(AML_LOGICAL_LESS_OP, match_obj,\r\npackage_obj, &logical_result);\r\nif (ACPI_FAILURE(status)) {\r\nreturn (FALSE);\r\n}\r\nlogical_result = (u8) ! logical_result;\r\nbreak;\r\ncase MATCH_MLT:\r\nstatus =\r\nacpi_ex_do_logical_op(AML_LOGICAL_GREATER_OP, match_obj,\r\npackage_obj, &logical_result);\r\nif (ACPI_FAILURE(status)) {\r\nreturn (FALSE);\r\n}\r\nbreak;\r\ncase MATCH_MGE:\r\nstatus =\r\nacpi_ex_do_logical_op(AML_LOGICAL_GREATER_OP, match_obj,\r\npackage_obj, &logical_result);\r\nif (ACPI_FAILURE(status)) {\r\nreturn (FALSE);\r\n}\r\nlogical_result = (u8) ! logical_result;\r\nbreak;\r\ncase MATCH_MGT:\r\nstatus =\r\nacpi_ex_do_logical_op(AML_LOGICAL_LESS_OP, match_obj,\r\npackage_obj, &logical_result);\r\nif (ACPI_FAILURE(status)) {\r\nreturn (FALSE);\r\n}\r\nbreak;\r\ndefault:\r\nreturn (FALSE);\r\n}\r\nreturn (logical_result);\r\n}\r\nacpi_status acpi_ex_opcode_6A_0T_1R(struct acpi_walk_state *walk_state)\r\n{\r\nunion acpi_operand_object **operand = &walk_state->operands[0];\r\nunion acpi_operand_object *return_desc = NULL;\r\nacpi_status status = AE_OK;\r\nu64 index;\r\nunion acpi_operand_object *this_element;\r\nACPI_FUNCTION_TRACE_STR(ex_opcode_6A_0T_1R,\r\nacpi_ps_get_opcode_name(walk_state->opcode));\r\nswitch (walk_state->opcode) {\r\ncase AML_MATCH_OP:\r\nif ((operand[1]->integer.value > MAX_MATCH_OPERATOR) ||\r\n(operand[3]->integer.value > MAX_MATCH_OPERATOR)) {\r\nACPI_ERROR((AE_INFO, "Match operator out of range"));\r\nstatus = AE_AML_OPERAND_VALUE;\r\ngoto cleanup;\r\n}\r\nindex = operand[5]->integer.value;\r\nif (index >= operand[0]->package.count) {\r\nACPI_ERROR((AE_INFO,\r\n"Index (0x%8.8X%8.8X) beyond package end (0x%X)",\r\nACPI_FORMAT_UINT64(index),\r\noperand[0]->package.count));\r\nstatus = AE_AML_PACKAGE_LIMIT;\r\ngoto cleanup;\r\n}\r\nreturn_desc = acpi_ut_create_integer_object(ACPI_UINT64_MAX);\r\nif (!return_desc) {\r\nstatus = AE_NO_MEMORY;\r\ngoto cleanup;\r\n}\r\nfor (; index < operand[0]->package.count; index++) {\r\nthis_element = operand[0]->package.elements[index];\r\nif (!this_element) {\r\ncontinue;\r\n}\r\nif (!acpi_ex_do_match((u32) operand[1]->integer.value,\r\nthis_element, operand[2])) {\r\ncontinue;\r\n}\r\nif (!acpi_ex_do_match((u32) operand[3]->integer.value,\r\nthis_element, operand[4])) {\r\ncontinue;\r\n}\r\nreturn_desc->integer.value = index;\r\nbreak;\r\n}\r\nbreak;\r\ncase AML_LOAD_TABLE_OP:\r\nstatus = acpi_ex_load_table_op(walk_state, &return_desc);\r\nbreak;\r\ndefault:\r\nACPI_ERROR((AE_INFO, "Unknown AML opcode 0x%X",\r\nwalk_state->opcode));\r\nstatus = AE_AML_BAD_OPCODE;\r\ngoto cleanup;\r\n}\r\ncleanup:\r\nif (ACPI_FAILURE(status)) {\r\nacpi_ut_remove_reference(return_desc);\r\n}\r\nelse {\r\nwalk_state->result_obj = return_desc;\r\n}\r\nreturn_ACPI_STATUS(status);\r\n}
