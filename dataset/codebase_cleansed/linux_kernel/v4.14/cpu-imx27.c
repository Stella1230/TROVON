static int mx27_read_cpu_rev(void)\r\n{\r\nu32 val;\r\nval = imx_readl(MX27_IO_ADDRESS(MX27_SYSCTRL_BASE_ADDR + SYS_CHIP_ID));\r\nmx27_cpu_partnumber = (int)((val >> 12) & 0xFFFF);\r\nswitch (val >> 28) {\r\ncase 0:\r\nreturn IMX_CHIP_REVISION_1_0;\r\ncase 1:\r\nreturn IMX_CHIP_REVISION_2_0;\r\ncase 2:\r\nreturn IMX_CHIP_REVISION_2_1;\r\ndefault:\r\nreturn IMX_CHIP_REVISION_UNKNOWN;\r\n}\r\n}\r\nint mx27_revision(void)\r\n{\r\nif (mx27_cpu_rev == -1)\r\nmx27_cpu_rev = mx27_read_cpu_rev();\r\nif (mx27_cpu_partnumber != 0x8821)\r\nreturn -EINVAL;\r\nreturn mx27_cpu_rev;\r\n}
