void\r\nia_css_fpn_encode(\r\nstruct sh_css_isp_fpn_params *to,\r\nconst struct ia_css_fpn_table *from,\r\nunsigned size)\r\n{\r\n(void)size;\r\nto->shift = from->shift;\r\nto->enabled = from->data != NULL;\r\n}\r\nvoid\r\nia_css_fpn_dump(\r\nconst struct sh_css_isp_fpn_params *fpn,\r\nunsigned level)\r\n{\r\nif (!fpn) return;\r\nia_css_debug_dtrace(level, "Fixed Pattern Noise Reduction:\n");\r\nia_css_debug_dtrace(level, "\t%-32s = %d\n",\r\n"fpn_shift", fpn->shift);\r\nia_css_debug_dtrace(level, "\t%-32s = %d\n",\r\n"fpn_enabled", fpn->enabled);\r\n}\r\nvoid\r\nia_css_fpn_config(\r\nstruct sh_css_isp_fpn_isp_config *to,\r\nconst struct ia_css_fpn_configuration *from,\r\nunsigned size)\r\n{\r\nunsigned elems_a = ISP_VEC_NELEMS;\r\n(void)size;\r\nia_css_dma_configure_from_info(&to->port_b, from->info);\r\nto->width_a_over_b = elems_a / to->port_b.elems;\r\nassert (elems_a % to->port_b.elems == 0);\r\n}\r\nvoid\r\nia_css_fpn_configure(\r\nconst struct ia_css_binary *binary,\r\nconst struct ia_css_frame_info *info)\r\n{\r\nstruct ia_css_frame_info my_info = IA_CSS_BINARY_DEFAULT_FRAME_INFO;\r\nconst struct ia_css_fpn_configuration config = {\r\n&my_info\r\n};\r\nmy_info.res.width = CEIL_DIV(info->res.width, 2);\r\nmy_info.res.height = info->res.height;\r\nmy_info.padded_width = CEIL_DIV(info->padded_width, 2);\r\nmy_info.format = info->format;\r\nmy_info.raw_bit_depth = FPN_BITS_PER_PIXEL;\r\nmy_info.raw_bayer_order = info->raw_bayer_order;\r\nmy_info.crop_info = info->crop_info;\r\nia_css_configure_fpn(binary, &config);\r\n}
