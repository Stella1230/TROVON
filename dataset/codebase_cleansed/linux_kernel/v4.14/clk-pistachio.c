static void __init pistachio_clk_init(struct device_node *np)\r\n{\r\nstruct pistachio_clk_provider *p;\r\nstruct clk *debug_clk;\r\np = pistachio_clk_alloc_provider(np, CLK_NR_CLKS);\r\nif (!p)\r\nreturn;\r\npistachio_clk_register_pll(p, pistachio_plls,\r\nARRAY_SIZE(pistachio_plls));\r\npistachio_clk_register_mux(p, pistachio_muxes,\r\nARRAY_SIZE(pistachio_muxes));\r\npistachio_clk_register_div(p, pistachio_divs,\r\nARRAY_SIZE(pistachio_divs));\r\npistachio_clk_register_fixed_factor(p, pistachio_ffs,\r\nARRAY_SIZE(pistachio_ffs));\r\npistachio_clk_register_gate(p, pistachio_gates,\r\nARRAY_SIZE(pistachio_gates));\r\ndebug_clk = clk_register_mux_table(NULL, "debug_mux", mux_debug,\r\nARRAY_SIZE(mux_debug),\r\nCLK_SET_RATE_NO_REPARENT,\r\np->base + 0x200, 18, 0x1f, 0,\r\nmux_debug_idx, NULL);\r\np->clk_data.clks[CLK_DEBUG_MUX] = debug_clk;\r\npistachio_clk_register_provider(p);\r\npistachio_clk_force_enable(p, pistachio_critical_clks_core,\r\nARRAY_SIZE(pistachio_critical_clks_core));\r\n}\r\nstatic void __init pistachio_clk_periph_init(struct device_node *np)\r\n{\r\nstruct pistachio_clk_provider *p;\r\np = pistachio_clk_alloc_provider(np, PERIPH_CLK_NR_CLKS);\r\nif (!p)\r\nreturn;\r\npistachio_clk_register_div(p, pistachio_periph_divs,\r\nARRAY_SIZE(pistachio_periph_divs));\r\npistachio_clk_register_gate(p, pistachio_periph_gates,\r\nARRAY_SIZE(pistachio_periph_gates));\r\npistachio_clk_register_provider(p);\r\npistachio_clk_force_enable(p, pistachio_critical_clks_sys,\r\nARRAY_SIZE(pistachio_critical_clks_sys));\r\n}\r\nstatic void __init pistachio_cr_periph_init(struct device_node *np)\r\n{\r\nstruct pistachio_clk_provider *p;\r\np = pistachio_clk_alloc_provider(np, SYS_CLK_NR_CLKS);\r\nif (!p)\r\nreturn;\r\npistachio_clk_register_gate(p, pistachio_sys_gates,\r\nARRAY_SIZE(pistachio_sys_gates));\r\npistachio_clk_register_provider(p);\r\n}\r\nstatic void __init pistachio_cr_top_init(struct device_node *np)\r\n{\r\nstruct pistachio_clk_provider *p;\r\np = pistachio_clk_alloc_provider(np, EXT_CLK_NR_CLKS);\r\nif (!p)\r\nreturn;\r\npistachio_clk_register_gate(p, pistachio_ext_gates,\r\nARRAY_SIZE(pistachio_ext_gates));\r\npistachio_clk_register_provider(p);\r\n}
