void hgsmi_process_display_info(struct gen_pool *ctx, u32 display,\r\ns32 origin_x, s32 origin_y, u32 start_offset,\r\nu32 pitch, u32 width, u32 height,\r\nu16 bpp, u16 flags)\r\n{\r\nstruct vbva_infoscreen *p;\r\np = hgsmi_buffer_alloc(ctx, sizeof(*p), HGSMI_CH_VBVA,\r\nVBVA_INFO_SCREEN);\r\nif (!p)\r\nreturn;\r\np->view_index = display;\r\np->origin_x = origin_x;\r\np->origin_y = origin_y;\r\np->start_offset = start_offset;\r\np->line_size = pitch;\r\np->width = width;\r\np->height = height;\r\np->bits_per_pixel = bpp;\r\np->flags = flags;\r\nhgsmi_buffer_submit(ctx, p);\r\nhgsmi_buffer_free(ctx, p);\r\n}\r\nint hgsmi_update_input_mapping(struct gen_pool *ctx, s32 origin_x, s32 origin_y,\r\nu32 width, u32 height)\r\n{\r\nstruct vbva_report_input_mapping *p;\r\np = hgsmi_buffer_alloc(ctx, sizeof(*p), HGSMI_CH_VBVA,\r\nVBVA_REPORT_INPUT_MAPPING);\r\nif (!p)\r\nreturn -ENOMEM;\r\np->x = origin_x;\r\np->y = origin_y;\r\np->cx = width;\r\np->cy = height;\r\nhgsmi_buffer_submit(ctx, p);\r\nhgsmi_buffer_free(ctx, p);\r\nreturn 0;\r\n}\r\nint hgsmi_get_mode_hints(struct gen_pool *ctx, unsigned int screens,\r\nstruct vbva_modehint *hints)\r\n{\r\nstruct vbva_query_mode_hints *p;\r\nsize_t size;\r\nif (WARN_ON(!hints))\r\nreturn -EINVAL;\r\nsize = screens * sizeof(struct vbva_modehint);\r\np = hgsmi_buffer_alloc(ctx, sizeof(*p) + size, HGSMI_CH_VBVA,\r\nVBVA_QUERY_MODE_HINTS);\r\nif (!p)\r\nreturn -ENOMEM;\r\np->hints_queried_count = screens;\r\np->hint_structure_guest_size = sizeof(struct vbva_modehint);\r\np->rc = VERR_NOT_SUPPORTED;\r\nhgsmi_buffer_submit(ctx, p);\r\nif (RT_FAILURE(p->rc)) {\r\nhgsmi_buffer_free(ctx, p);\r\nreturn -EIO;\r\n}\r\nmemcpy(hints, ((u8 *)p) + sizeof(struct vbva_query_mode_hints), size);\r\nhgsmi_buffer_free(ctx, p);\r\nreturn 0;\r\n}
