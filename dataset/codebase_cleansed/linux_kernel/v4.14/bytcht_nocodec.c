static int codec_fixup(struct snd_soc_pcm_runtime *rtd,\r\nstruct snd_pcm_hw_params *params)\r\n{\r\nstruct snd_interval *rate = hw_param_interval(params,\r\nSNDRV_PCM_HW_PARAM_RATE);\r\nstruct snd_interval *channels = hw_param_interval(params,\r\nSNDRV_PCM_HW_PARAM_CHANNELS);\r\nint ret;\r\nrate->min = rate->max = 48000;\r\nchannels->min = channels->max = 2;\r\nparams_set_format(params, SNDRV_PCM_FORMAT_S24_LE);\r\nret = snd_soc_dai_set_fmt(rtd->cpu_dai,\r\nSND_SOC_DAIFMT_I2S |\r\nSND_SOC_DAIFMT_NB_NF |\r\nSND_SOC_DAIFMT_CBS_CFS);\r\nif (ret < 0) {\r\ndev_err(rtd->dev, "can't set format to I2S, err %d\n", ret);\r\nreturn ret;\r\n}\r\nret = snd_soc_dai_set_tdm_slot(rtd->cpu_dai, 0x3, 0x3, 2, 24);\r\nif (ret < 0) {\r\ndev_err(rtd->dev, "can't set I2S config, err %d\n", ret);\r\nreturn ret;\r\n}\r\nreturn 0;\r\n}\r\nstatic int aif1_startup(struct snd_pcm_substream *substream)\r\n{\r\nreturn snd_pcm_hw_constraint_list(substream->runtime, 0,\r\nSNDRV_PCM_HW_PARAM_RATE,\r\n&constraints_48000);\r\n}\r\nstatic int snd_bytcht_nocodec_mc_probe(struct platform_device *pdev)\r\n{\r\nint ret_val = 0;\r\nbytcht_nocodec_card.dev = &pdev->dev;\r\nret_val = devm_snd_soc_register_card(&pdev->dev, &bytcht_nocodec_card);\r\nif (ret_val) {\r\ndev_err(&pdev->dev, "devm_snd_soc_register_card failed %d\n",\r\nret_val);\r\nreturn ret_val;\r\n}\r\nplatform_set_drvdata(pdev, &bytcht_nocodec_card);\r\nreturn ret_val;\r\n}
