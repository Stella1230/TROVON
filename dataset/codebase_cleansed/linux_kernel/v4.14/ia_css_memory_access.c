hrt_vaddress\r\nmmgr_malloc(const size_t size)\r\n{\r\nreturn mmgr_alloc_attr(size, 0);\r\n}\r\nhrt_vaddress mmgr_alloc_attr(const size_t size, const uint16_t attrs)\r\n{\r\nuint16_t masked_attrs = attrs & MMGR_ATTRIBUTE_MASK;\r\nWARN_ON(attrs & MMGR_ATTRIBUTE_CONTIGUOUS);\r\nif (masked_attrs & MMGR_ATTRIBUTE_CLEARED) {\r\nif (masked_attrs & MMGR_ATTRIBUTE_CACHED)\r\nreturn (ia_css_ptr) hrt_isp_css_mm_calloc_cached(size);\r\nelse\r\nreturn (ia_css_ptr) hrt_isp_css_mm_calloc(size);\r\n} else {\r\nif (masked_attrs & MMGR_ATTRIBUTE_CACHED)\r\nreturn (ia_css_ptr) hrt_isp_css_mm_alloc_cached(size);\r\nelse\r\nreturn (ia_css_ptr) hrt_isp_css_mm_alloc(size);\r\n}\r\n}\r\nhrt_vaddress\r\nmmgr_calloc(const size_t N, const size_t size)\r\n{\r\nreturn mmgr_alloc_attr(size * N, MMGR_ATTRIBUTE_CLEARED);\r\n}\r\nvoid mmgr_clear(hrt_vaddress vaddr, const size_t size)\r\n{\r\nif (vaddr)\r\nhmm_set(vaddr, 0, size);\r\n}\r\nvoid mmgr_load(const hrt_vaddress vaddr, void *data, const size_t size)\r\n{\r\nif (vaddr && data)\r\nhmm_load(vaddr, data, size);\r\n}\r\nvoid\r\nmmgr_store(const hrt_vaddress vaddr, const void *data, const size_t size)\r\n{\r\nif (vaddr && data)\r\nhmm_store(vaddr, data, size);\r\n}\r\nhrt_vaddress\r\nmmgr_mmap(const void *ptr, const size_t size,\r\nuint16_t attribute, void *context)\r\n{\r\nstruct hrt_userbuffer_attr *userbuffer_attr = context;\r\nreturn hrt_isp_css_mm_alloc_user_ptr(\r\nsize, (void *)ptr, userbuffer_attr->pgnr,\r\nuserbuffer_attr->type,\r\nattribute & HRT_BUF_FLAG_CACHED);\r\n}
