static uint32_t drm_crtc_port_mask(struct drm_device *dev,\r\nstruct device_node *port)\r\n{\r\nunsigned int index = 0;\r\nstruct drm_crtc *tmp;\r\nlist_for_each_entry(tmp, &dev->mode_config.crtc_list, head) {\r\nif (tmp->port == port)\r\nreturn 1 << index;\r\nindex++;\r\n}\r\nreturn 0;\r\n}\r\nuint32_t drm_of_find_possible_crtcs(struct drm_device *dev,\r\nstruct device_node *port)\r\n{\r\nstruct device_node *remote_port, *ep = NULL;\r\nuint32_t possible_crtcs = 0;\r\ndo {\r\nep = of_graph_get_next_endpoint(port, ep);\r\nif (!ep)\r\nbreak;\r\nremote_port = of_graph_get_remote_port(ep);\r\nif (!remote_port) {\r\nof_node_put(ep);\r\nreturn 0;\r\n}\r\npossible_crtcs |= drm_crtc_port_mask(dev, remote_port);\r\nof_node_put(remote_port);\r\n} while (1);\r\nreturn possible_crtcs;\r\n}
