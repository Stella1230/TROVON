void fsl_ssi_dbg_isr(struct fsl_ssi_dbg *dbg, u32 sisr)\r\n{\r\nif (sisr & CCSR_SSI_SISR_RFRC)\r\ndbg->stats.rfrc++;\r\nif (sisr & CCSR_SSI_SISR_TFRC)\r\ndbg->stats.tfrc++;\r\nif (sisr & CCSR_SSI_SISR_CMDAU)\r\ndbg->stats.cmdau++;\r\nif (sisr & CCSR_SSI_SISR_CMDDU)\r\ndbg->stats.cmddu++;\r\nif (sisr & CCSR_SSI_SISR_RXT)\r\ndbg->stats.rxt++;\r\nif (sisr & CCSR_SSI_SISR_RDR1)\r\ndbg->stats.rdr1++;\r\nif (sisr & CCSR_SSI_SISR_RDR0)\r\ndbg->stats.rdr0++;\r\nif (sisr & CCSR_SSI_SISR_TDE1)\r\ndbg->stats.tde1++;\r\nif (sisr & CCSR_SSI_SISR_TDE0)\r\ndbg->stats.tde0++;\r\nif (sisr & CCSR_SSI_SISR_ROE1)\r\ndbg->stats.roe1++;\r\nif (sisr & CCSR_SSI_SISR_ROE0)\r\ndbg->stats.roe0++;\r\nif (sisr & CCSR_SSI_SISR_TUE1)\r\ndbg->stats.tue1++;\r\nif (sisr & CCSR_SSI_SISR_TUE0)\r\ndbg->stats.tue0++;\r\nif (sisr & CCSR_SSI_SISR_TFS)\r\ndbg->stats.tfs++;\r\nif (sisr & CCSR_SSI_SISR_RFS)\r\ndbg->stats.rfs++;\r\nif (sisr & CCSR_SSI_SISR_TLS)\r\ndbg->stats.tls++;\r\nif (sisr & CCSR_SSI_SISR_RLS)\r\ndbg->stats.rls++;\r\nif (sisr & CCSR_SSI_SISR_RFF1)\r\ndbg->stats.rff1++;\r\nif (sisr & CCSR_SSI_SISR_RFF0)\r\ndbg->stats.rff0++;\r\nif (sisr & CCSR_SSI_SISR_TFE1)\r\ndbg->stats.tfe1++;\r\nif (sisr & CCSR_SSI_SISR_TFE0)\r\ndbg->stats.tfe0++;\r\n}\r\nstatic int fsl_ssi_stats_show(struct seq_file *s, void *unused)\r\n{\r\nstruct fsl_ssi_dbg *ssi_dbg = s->private;\r\nSIER_SHOW(RFRC_EN, rfrc);\r\nSIER_SHOW(TFRC_EN, tfrc);\r\nSIER_SHOW(CMDAU_EN, cmdau);\r\nSIER_SHOW(CMDDU_EN, cmddu);\r\nSIER_SHOW(RXT_EN, rxt);\r\nSIER_SHOW(RDR1_EN, rdr1);\r\nSIER_SHOW(RDR0_EN, rdr0);\r\nSIER_SHOW(TDE1_EN, tde1);\r\nSIER_SHOW(TDE0_EN, tde0);\r\nSIER_SHOW(ROE1_EN, roe1);\r\nSIER_SHOW(ROE0_EN, roe0);\r\nSIER_SHOW(TUE1_EN, tue1);\r\nSIER_SHOW(TUE0_EN, tue0);\r\nSIER_SHOW(TFS_EN, tfs);\r\nSIER_SHOW(RFS_EN, rfs);\r\nSIER_SHOW(TLS_EN, tls);\r\nSIER_SHOW(RLS_EN, rls);\r\nSIER_SHOW(RFF1_EN, rff1);\r\nSIER_SHOW(RFF0_EN, rff0);\r\nSIER_SHOW(TFE1_EN, tfe1);\r\nSIER_SHOW(TFE0_EN, tfe0);\r\nreturn 0;\r\n}\r\nstatic int fsl_ssi_stats_open(struct inode *inode, struct file *file)\r\n{\r\nreturn single_open(file, fsl_ssi_stats_show, inode->i_private);\r\n}\r\nint fsl_ssi_debugfs_create(struct fsl_ssi_dbg *ssi_dbg, struct device *dev)\r\n{\r\nssi_dbg->dbg_dir = debugfs_create_dir(dev_name(dev), NULL);\r\nif (!ssi_dbg->dbg_dir)\r\nreturn -ENOMEM;\r\nssi_dbg->dbg_stats = debugfs_create_file("stats", S_IRUGO,\r\nssi_dbg->dbg_dir, ssi_dbg, &fsl_ssi_stats_ops);\r\nif (!ssi_dbg->dbg_stats) {\r\ndebugfs_remove(ssi_dbg->dbg_dir);\r\nreturn -ENOMEM;\r\n}\r\nreturn 0;\r\n}\r\nvoid fsl_ssi_debugfs_remove(struct fsl_ssi_dbg *ssi_dbg)\r\n{\r\ndebugfs_remove(ssi_dbg->dbg_stats);\r\ndebugfs_remove(ssi_dbg->dbg_dir);\r\n}
