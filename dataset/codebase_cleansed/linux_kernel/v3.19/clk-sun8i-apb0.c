static int sun8i_a23_apb0_clk_probe(struct platform_device *pdev)\r\n{\r\nstruct device_node *np = pdev->dev.of_node;\r\nconst char *clk_name = np->name;\r\nconst char *clk_parent;\r\nstruct resource *r;\r\nvoid __iomem *reg;\r\nstruct clk *clk;\r\nr = platform_get_resource(pdev, IORESOURCE_MEM, 0);\r\nreg = devm_ioremap_resource(&pdev->dev, r);\r\nif (IS_ERR(reg))\r\nreturn PTR_ERR(reg);\r\nclk_parent = of_clk_get_parent_name(np, 0);\r\nif (!clk_parent)\r\nreturn -EINVAL;\r\nof_property_read_string(np, "clock-output-names", &clk_name);\r\nclk = clk_register_divider(&pdev->dev, clk_name, clk_parent, 0, reg,\r\n0, 2, CLK_DIVIDER_POWER_OF_TWO, NULL);\r\nif (IS_ERR(clk))\r\nreturn PTR_ERR(clk);\r\nreturn of_clk_add_provider(np, of_clk_src_simple_get, clk);\r\n}
