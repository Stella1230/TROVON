static void dw_mci_k3_set_ios(struct dw_mci *host, struct mmc_ios *ios)\r\n{\r\nint ret;\r\nret = clk_set_rate(host->ciu_clk, ios->clock);\r\nif (ret)\r\ndev_warn(host->dev, "failed to set rate %uHz\n", ios->clock);\r\nhost->bus_hz = clk_get_rate(host->ciu_clk);\r\n}\r\nstatic int dw_mci_k3_probe(struct platform_device *pdev)\r\n{\r\nconst struct dw_mci_drv_data *drv_data;\r\nconst struct of_device_id *match;\r\nmatch = of_match_node(dw_mci_k3_match, pdev->dev.of_node);\r\ndrv_data = match->data;\r\nreturn dw_mci_pltfm_register(pdev, drv_data);\r\n}\r\nstatic int dw_mci_k3_suspend(struct device *dev)\r\n{\r\nstruct dw_mci *host = dev_get_drvdata(dev);\r\nint ret;\r\nret = dw_mci_suspend(host);\r\nif (!ret)\r\nclk_disable_unprepare(host->ciu_clk);\r\nreturn ret;\r\n}\r\nstatic int dw_mci_k3_resume(struct device *dev)\r\n{\r\nstruct dw_mci *host = dev_get_drvdata(dev);\r\nint ret;\r\nret = clk_prepare_enable(host->ciu_clk);\r\nif (ret) {\r\ndev_err(host->dev, "failed to enable ciu clock\n");\r\nreturn ret;\r\n}\r\nreturn dw_mci_resume(host);\r\n}
