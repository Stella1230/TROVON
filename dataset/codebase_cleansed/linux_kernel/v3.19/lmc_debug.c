void lmcConsoleLog(char *type, unsigned char *ucData, int iLen)\r\n{\r\nint iNewLine = 1;\r\nchar str[80], *pstr;\r\nsprintf(str, KERN_DEBUG "lmc: %s: ", type);\r\npstr = str+strlen(str);\r\nif(iLen > 240){\r\nprintk(KERN_DEBUG "lmc: Printing 240 chars... out of: %d\n", iLen);\r\niLen = 240;\r\n}\r\nelse{\r\nprintk(KERN_DEBUG "lmc: Printing %d chars\n", iLen);\r\n}\r\nwhile(iLen > 0)\r\n{\r\nsprintf(pstr, "%02x ", *ucData);\r\npstr+=3;\r\nucData++;\r\nif( !(iNewLine % 20))\r\n{\r\nsprintf(pstr, "\n");\r\nprintk(str);\r\nsprintf(str, KERN_DEBUG "lmc: %s: ", type);\r\npstr=str+strlen(str);\r\n}\r\niNewLine++;\r\niLen--;\r\n}\r\nsprintf(pstr, "\n");\r\nprintk(str);\r\n}\r\nvoid lmcEventLog(u32 EventNum, u32 arg2, u32 arg3)\r\n{\r\nlmcEventLogBuf[lmcEventLogIndex++] = EventNum;\r\nlmcEventLogBuf[lmcEventLogIndex++] = arg2;\r\nlmcEventLogBuf[lmcEventLogIndex++] = arg3;\r\nlmcEventLogBuf[lmcEventLogIndex++] = jiffies;\r\nlmcEventLogIndex &= (LMC_EVENTLOGSIZE * LMC_EVENTLOGARGS) - 1;\r\n}\r\nvoid lmc_trace(struct net_device *dev, char *msg){\r\n#ifdef LMC_TRACE\r\nunsigned long j = jiffies + 3;\r\nif(in_interrupt()){\r\nprintk("%s: * %s\n", dev->name, msg);\r\n}\r\nelse {\r\nprintk("%s: %s\n", dev->name, msg);\r\nwhile(time_before(jiffies, j))\r\nschedule();\r\n}\r\n#endif\r\n}
