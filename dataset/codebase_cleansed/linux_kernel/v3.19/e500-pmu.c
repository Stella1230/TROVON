static u64 e500_xlate_event(u64 event_id)\r\n{\r\nu32 event_low = (u32)event_id;\r\nu64 ret;\r\nif (event_low >= num_events)\r\nreturn 0;\r\nret = FSL_EMB_EVENT_VALID;\r\nif (event_low >= 76 && event_low <= 81) {\r\nret |= FSL_EMB_EVENT_RESTRICTED;\r\nret |= event_id &\r\n(FSL_EMB_EVENT_THRESHMUL | FSL_EMB_EVENT_THRESH);\r\n} else if (event_id &\r\n(FSL_EMB_EVENT_THRESHMUL | FSL_EMB_EVENT_THRESH)) {\r\nreturn 0;\r\n}\r\nreturn ret;\r\n}\r\nstatic int init_e500_pmu(void)\r\n{\r\nif (!cur_cpu_spec->oprofile_cpu_type)\r\nreturn -ENODEV;\r\nif (!strcmp(cur_cpu_spec->oprofile_cpu_type, "ppc/e500mc"))\r\nnum_events = 256;\r\nelse if (strcmp(cur_cpu_spec->oprofile_cpu_type, "ppc/e500"))\r\nreturn -ENODEV;\r\nreturn register_fsl_emb_pmu(&e500_pmu);\r\n}
