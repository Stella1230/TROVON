static void __net_init __xfrm_sysctl_init(struct net *net)\r\n{\r\nnet->xfrm.sysctl_aevent_etime = XFRM_AE_ETIME;\r\nnet->xfrm.sysctl_aevent_rseqth = XFRM_AE_SEQT_SIZE;\r\nnet->xfrm.sysctl_larval_drop = 1;\r\nnet->xfrm.sysctl_acq_expires = 30;\r\n}\r\nint __net_init xfrm_sysctl_init(struct net *net)\r\n{\r\nstruct ctl_table *table;\r\n__xfrm_sysctl_init(net);\r\ntable = kmemdup(xfrm_table, sizeof(xfrm_table), GFP_KERNEL);\r\nif (!table)\r\ngoto out_kmemdup;\r\ntable[0].data = &net->xfrm.sysctl_aevent_etime;\r\ntable[1].data = &net->xfrm.sysctl_aevent_rseqth;\r\ntable[2].data = &net->xfrm.sysctl_larval_drop;\r\ntable[3].data = &net->xfrm.sysctl_acq_expires;\r\nif (net->user_ns != &init_user_ns)\r\ntable[0].procname = NULL;\r\nnet->xfrm.sysctl_hdr = register_net_sysctl(net, "net/core", table);\r\nif (!net->xfrm.sysctl_hdr)\r\ngoto out_register;\r\nreturn 0;\r\nout_register:\r\nkfree(table);\r\nout_kmemdup:\r\nreturn -ENOMEM;\r\n}\r\nvoid __net_exit xfrm_sysctl_fini(struct net *net)\r\n{\r\nstruct ctl_table *table;\r\ntable = net->xfrm.sysctl_hdr->ctl_table_arg;\r\nunregister_net_sysctl_table(net->xfrm.sysctl_hdr);\r\nkfree(table);\r\n}\r\nint __net_init xfrm_sysctl_init(struct net *net)\r\n{\r\n__xfrm_sysctl_init(net);\r\nreturn 0;\r\n}
