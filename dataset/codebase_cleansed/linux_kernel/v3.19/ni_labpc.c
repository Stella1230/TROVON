static int labpc_attach(struct comedi_device *dev, struct comedi_devconfig *it)\r\n{\r\nstruct labpc_private *devpriv;\r\nunsigned int irq = it->options[1];\r\nunsigned int dma_chan = it->options[2];\r\nint ret;\r\ndevpriv = comedi_alloc_devpriv(dev, sizeof(*devpriv));\r\nif (!devpriv)\r\nreturn -ENOMEM;\r\nret = comedi_request_region(dev, it->options[0], 0x20);\r\nif (ret)\r\nreturn ret;\r\nret = labpc_common_attach(dev, irq, 0);\r\nif (ret)\r\nreturn ret;\r\nif (dev->irq)\r\nlabpc_init_dma_chan(dev, dma_chan);\r\nreturn 0;\r\n}\r\nstatic void labpc_detach(struct comedi_device *dev)\r\n{\r\nstruct labpc_private *devpriv = dev->private;\r\nif (devpriv)\r\nlabpc_free_dma_chan(dev);\r\ncomedi_legacy_detach(dev);\r\n}
