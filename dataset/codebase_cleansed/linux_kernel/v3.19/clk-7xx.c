int __init dra7xx_dt_clk_init(void)\r\n{\r\nint rc;\r\nstruct clk *abe_dpll_mux, *sys_clkin2, *dpll_ck;\r\nti_dt_clocks_register(dra7xx_clks);\r\nomap2_clk_disable_autoidle_all();\r\nabe_dpll_mux = clk_get_sys(NULL, "abe_dpll_sys_clk_mux");\r\nsys_clkin2 = clk_get_sys(NULL, "sys_clkin2");\r\ndpll_ck = clk_get_sys(NULL, "dpll_abe_ck");\r\nrc = clk_set_parent(abe_dpll_mux, sys_clkin2);\r\nif (!rc)\r\nrc = clk_set_rate(dpll_ck, DRA7_DPLL_ABE_DEFFREQ);\r\nif (rc)\r\npr_err("%s: failed to configure ABE DPLL!\n", __func__);\r\ndpll_ck = clk_get_sys(NULL, "dpll_abe_m2x2_ck");\r\nrc = clk_set_rate(dpll_ck, DRA7_DPLL_ABE_DEFFREQ * 2);\r\nif (rc)\r\npr_err("%s: failed to configure ABE DPLL m2x2!\n", __func__);\r\ndpll_ck = clk_get_sys(NULL, "dpll_gmac_ck");\r\nrc = clk_set_rate(dpll_ck, DRA7_DPLL_GMAC_DEFFREQ);\r\nif (rc)\r\npr_err("%s: failed to configure GMAC DPLL!\n", __func__);\r\ndpll_ck = clk_get_sys(NULL, "dpll_usb_ck");\r\nrc = clk_set_rate(dpll_ck, DRA7_DPLL_USB_DEFFREQ);\r\nif (rc)\r\npr_err("%s: failed to configure USB DPLL!\n", __func__);\r\ndpll_ck = clk_get_sys(NULL, "dpll_usb_m2_ck");\r\nrc = clk_set_rate(dpll_ck, DRA7_DPLL_USB_DEFFREQ/2);\r\nif (rc)\r\npr_err("%s: failed to set USB_DPLL M2 OUT\n", __func__);\r\nreturn rc;\r\n}
