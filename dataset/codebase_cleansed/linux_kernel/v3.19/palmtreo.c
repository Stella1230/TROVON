static void __init palmtreo_kpc_init(void)\r\n{\r\nstatic struct pxa27x_keypad_platform_data *data = &treo680_keypad_pdata;\r\nif (machine_is_centro())\r\ndata->matrix_keymap_data = &centro_matrix_keymap_data;\r\npxa_set_keypad_info(&treo680_keypad_pdata);\r\n}\r\nstatic inline void palmtreo_kpc_init(void) {}\r\nstatic void __init palmtreo_uhc_init(void)\r\n{\r\nif (machine_is_treo680())\r\npxa_set_ohci_info(&treo680_ohci_info);\r\n}\r\nstatic inline void palmtreo_uhc_init(void) {}\r\nstatic void __init palmtreo_leds_init(void)\r\n{\r\nif (machine_is_centro())\r\npalmtreo_leds.dev.platform_data = &centro_gpio_led_info;\r\nelse if (machine_is_treo680())\r\npalmtreo_leds.dev.platform_data = &treo680_gpio_led_info;\r\nplatform_device_register(&palmtreo_leds);\r\n}\r\nstatic void __init treo680_docg4_flash_init(void)\r\n{\r\nplatform_device_register(&treo680_docg4_flash);\r\n}\r\nstatic inline void treo680_docg4_flash_init(void) {}\r\nstatic void __init treo_reserve(void)\r\n{\r\nmemblock_reserve(0xa0000000, 0x1000);\r\nmemblock_reserve(0xa2000000, 0x1000);\r\n}\r\nstatic void __init palmphone_common_init(void)\r\n{\r\npxa2xx_mfp_config(ARRAY_AND_SIZE(treo_pin_config));\r\npxa_set_ffuart_info(NULL);\r\npxa_set_btuart_info(NULL);\r\npxa_set_stuart_info(NULL);\r\npalm27x_pm_init(TREO_STR_BASE);\r\npalm27x_lcd_init(GPIO_NR_TREO_BL_POWER, &palm_320x320_new_lcd_mode);\r\npalm27x_udc_init(GPIO_NR_TREO_USB_DETECT, GPIO_NR_TREO_USB_PULLUP, 1);\r\npalm27x_irda_init(GPIO_NR_TREO_IR_EN);\r\npalm27x_ac97_init(-1, -1, -1, 95);\r\npalm27x_pwm_init(GPIO_NR_TREO_BL_POWER, -1);\r\npalm27x_power_init(GPIO_NR_TREO_POWER_DETECT, -1);\r\npalm27x_pmic_init();\r\npalmtreo_kpc_init();\r\npalmtreo_uhc_init();\r\npalmtreo_leds_init();\r\n}\r\nvoid __init treo680_gpio_init(void)\r\n{\r\nunsigned int gpio;\r\nconst unsigned long lcd_flags = GPIOF_INIT_HIGH | GPIOF_DIR_OUT;\r\ngpio = GPIO_NR_TREO680_LCD_POWER;\r\nif (gpio_request_one(gpio, lcd_flags, "LCD power") < 0)\r\ngoto fail;\r\ngpio = GPIO_NR_TREO680_LCD_EN;\r\nif (gpio_request_one(gpio, lcd_flags, "LCD enable") < 0)\r\ngoto fail;\r\ngpio = GPIO_NR_TREO680_LCD_EN_N;\r\nif (gpio_request_one(gpio, lcd_flags, "LCD enable_n") < 0)\r\ngoto fail;\r\ngpio_set_value(GPIO_NR_TREO680_LCD_EN_N, 0);\r\nreturn;\r\nfail:\r\npr_err("gpio %d initialization failed\n", gpio);\r\ngpio_free(GPIO_NR_TREO680_LCD_POWER);\r\ngpio_free(GPIO_NR_TREO680_LCD_EN);\r\ngpio_free(GPIO_NR_TREO680_LCD_EN_N);\r\n}\r\nstatic void __init treo680_init(void)\r\n{\r\npxa2xx_mfp_config(ARRAY_AND_SIZE(treo680_pin_config));\r\npalmphone_common_init();\r\ntreo680_gpio_init();\r\npalm27x_mmc_init(GPIO_NR_TREO_SD_DETECT_N, GPIO_NR_TREO680_SD_READONLY,\r\nGPIO_NR_TREO680_SD_POWER, 0);\r\ntreo680_docg4_flash_init();\r\n}\r\nstatic void __init centro_init(void)\r\n{\r\npxa2xx_mfp_config(ARRAY_AND_SIZE(centro685_pin_config));\r\npalmphone_common_init();\r\npalm27x_mmc_init(GPIO_NR_TREO_SD_DETECT_N, -1,\r\nGPIO_NR_CENTRO_SD_POWER, 1);\r\n}
