static acpi_status\r\nacpi_ds_execute_arguments(struct acpi_namespace_node *node,\r\nstruct acpi_namespace_node *scope_node,\r\nu32 aml_length, u8 *aml_start)\r\n{\r\nacpi_status status;\r\nunion acpi_parse_object *op;\r\nstruct acpi_walk_state *walk_state;\r\nACPI_FUNCTION_TRACE(ds_execute_arguments);\r\nop = acpi_ps_alloc_op(AML_INT_EVAL_SUBTREE_OP);\r\nif (!op) {\r\nreturn_ACPI_STATUS(AE_NO_MEMORY);\r\n}\r\nop->common.node = scope_node;\r\nwalk_state = acpi_ds_create_walk_state(0, NULL, NULL, NULL);\r\nif (!walk_state) {\r\nstatus = AE_NO_MEMORY;\r\ngoto cleanup;\r\n}\r\nstatus = acpi_ds_init_aml_walk(walk_state, op, NULL, aml_start,\r\naml_length, NULL, ACPI_IMODE_LOAD_PASS1);\r\nif (ACPI_FAILURE(status)) {\r\nacpi_ds_delete_walk_state(walk_state);\r\ngoto cleanup;\r\n}\r\nwalk_state->parse_flags = ACPI_PARSE_DEFERRED_OP;\r\nwalk_state->deferred_node = node;\r\nstatus = acpi_ps_parse_aml(walk_state);\r\nif (ACPI_FAILURE(status)) {\r\ngoto cleanup;\r\n}\r\nop->common.node = node;\r\nacpi_ps_delete_parse_tree(op);\r\nop = acpi_ps_alloc_op(AML_INT_EVAL_SUBTREE_OP);\r\nif (!op) {\r\nreturn_ACPI_STATUS(AE_NO_MEMORY);\r\n}\r\nop->common.node = scope_node;\r\nwalk_state = acpi_ds_create_walk_state(0, NULL, NULL, NULL);\r\nif (!walk_state) {\r\nstatus = AE_NO_MEMORY;\r\ngoto cleanup;\r\n}\r\nstatus = acpi_ds_init_aml_walk(walk_state, op, NULL, aml_start,\r\naml_length, NULL, ACPI_IMODE_EXECUTE);\r\nif (ACPI_FAILURE(status)) {\r\nacpi_ds_delete_walk_state(walk_state);\r\ngoto cleanup;\r\n}\r\nwalk_state->deferred_node = node;\r\nstatus = acpi_ps_parse_aml(walk_state);\r\ncleanup:\r\nacpi_ps_delete_parse_tree(op);\r\nreturn_ACPI_STATUS(status);\r\n}\r\nacpi_status\r\nacpi_ds_get_buffer_field_arguments(union acpi_operand_object *obj_desc)\r\n{\r\nunion acpi_operand_object *extra_desc;\r\nstruct acpi_namespace_node *node;\r\nacpi_status status;\r\nACPI_FUNCTION_TRACE_PTR(ds_get_buffer_field_arguments, obj_desc);\r\nif (obj_desc->common.flags & AOPOBJ_DATA_VALID) {\r\nreturn_ACPI_STATUS(AE_OK);\r\n}\r\nextra_desc = acpi_ns_get_secondary_object(obj_desc);\r\nnode = obj_desc->buffer_field.node;\r\nACPI_DEBUG_EXEC(acpi_ut_display_init_pathname(ACPI_TYPE_BUFFER_FIELD,\r\nnode, NULL));\r\nACPI_DEBUG_PRINT((ACPI_DB_EXEC, "[%4.4s] BufferField Arg Init\n",\r\nacpi_ut_get_node_name(node)));\r\nstatus = acpi_ds_execute_arguments(node, node->parent,\r\nextra_desc->extra.aml_length,\r\nextra_desc->extra.aml_start);\r\nreturn_ACPI_STATUS(status);\r\n}\r\nacpi_status\r\nacpi_ds_get_bank_field_arguments(union acpi_operand_object *obj_desc)\r\n{\r\nunion acpi_operand_object *extra_desc;\r\nstruct acpi_namespace_node *node;\r\nacpi_status status;\r\nACPI_FUNCTION_TRACE_PTR(ds_get_bank_field_arguments, obj_desc);\r\nif (obj_desc->common.flags & AOPOBJ_DATA_VALID) {\r\nreturn_ACPI_STATUS(AE_OK);\r\n}\r\nextra_desc = acpi_ns_get_secondary_object(obj_desc);\r\nnode = obj_desc->bank_field.node;\r\nACPI_DEBUG_EXEC(acpi_ut_display_init_pathname\r\n(ACPI_TYPE_LOCAL_BANK_FIELD, node, NULL));\r\nACPI_DEBUG_PRINT((ACPI_DB_EXEC, "[%4.4s] BankField Arg Init\n",\r\nacpi_ut_get_node_name(node)));\r\nstatus = acpi_ds_execute_arguments(node, node->parent,\r\nextra_desc->extra.aml_length,\r\nextra_desc->extra.aml_start);\r\nif (ACPI_FAILURE(status)) {\r\nreturn_ACPI_STATUS(status);\r\n}\r\nstatus = acpi_ut_add_address_range(obj_desc->region.space_id,\r\nobj_desc->region.address,\r\nobj_desc->region.length, node);\r\nreturn_ACPI_STATUS(status);\r\n}\r\nacpi_status acpi_ds_get_buffer_arguments(union acpi_operand_object *obj_desc)\r\n{\r\nstruct acpi_namespace_node *node;\r\nacpi_status status;\r\nACPI_FUNCTION_TRACE_PTR(ds_get_buffer_arguments, obj_desc);\r\nif (obj_desc->common.flags & AOPOBJ_DATA_VALID) {\r\nreturn_ACPI_STATUS(AE_OK);\r\n}\r\nnode = obj_desc->buffer.node;\r\nif (!node) {\r\nACPI_ERROR((AE_INFO,\r\n"No pointer back to namespace node in buffer object %p",\r\nobj_desc));\r\nreturn_ACPI_STATUS(AE_AML_INTERNAL);\r\n}\r\nACPI_DEBUG_PRINT((ACPI_DB_EXEC, "Buffer Arg Init\n"));\r\nstatus = acpi_ds_execute_arguments(node, node,\r\nobj_desc->buffer.aml_length,\r\nobj_desc->buffer.aml_start);\r\nreturn_ACPI_STATUS(status);\r\n}\r\nacpi_status acpi_ds_get_package_arguments(union acpi_operand_object *obj_desc)\r\n{\r\nstruct acpi_namespace_node *node;\r\nacpi_status status;\r\nACPI_FUNCTION_TRACE_PTR(ds_get_package_arguments, obj_desc);\r\nif (obj_desc->common.flags & AOPOBJ_DATA_VALID) {\r\nreturn_ACPI_STATUS(AE_OK);\r\n}\r\nnode = obj_desc->package.node;\r\nif (!node) {\r\nACPI_ERROR((AE_INFO,\r\n"No pointer back to namespace node in package %p",\r\nobj_desc));\r\nreturn_ACPI_STATUS(AE_AML_INTERNAL);\r\n}\r\nACPI_DEBUG_PRINT((ACPI_DB_EXEC, "Package Arg Init\n"));\r\nstatus = acpi_ds_execute_arguments(node, node,\r\nobj_desc->package.aml_length,\r\nobj_desc->package.aml_start);\r\nreturn_ACPI_STATUS(status);\r\n}\r\nacpi_status acpi_ds_get_region_arguments(union acpi_operand_object *obj_desc)\r\n{\r\nstruct acpi_namespace_node *node;\r\nacpi_status status;\r\nunion acpi_operand_object *extra_desc;\r\nACPI_FUNCTION_TRACE_PTR(ds_get_region_arguments, obj_desc);\r\nif (obj_desc->region.flags & AOPOBJ_DATA_VALID) {\r\nreturn_ACPI_STATUS(AE_OK);\r\n}\r\nextra_desc = acpi_ns_get_secondary_object(obj_desc);\r\nif (!extra_desc) {\r\nreturn_ACPI_STATUS(AE_NOT_EXIST);\r\n}\r\nnode = obj_desc->region.node;\r\nACPI_DEBUG_EXEC(acpi_ut_display_init_pathname\r\n(ACPI_TYPE_REGION, node, NULL));\r\nACPI_DEBUG_PRINT((ACPI_DB_EXEC, "[%4.4s] OpRegion Arg Init at AML %p\n",\r\nacpi_ut_get_node_name(node),\r\nextra_desc->extra.aml_start));\r\nstatus = acpi_ds_execute_arguments(node, extra_desc->extra.scope_node,\r\nextra_desc->extra.aml_length,\r\nextra_desc->extra.aml_start);\r\nif (ACPI_FAILURE(status)) {\r\nreturn_ACPI_STATUS(status);\r\n}\r\nstatus = acpi_ut_add_address_range(obj_desc->region.space_id,\r\nobj_desc->region.address,\r\nobj_desc->region.length, node);\r\nreturn_ACPI_STATUS(status);\r\n}
