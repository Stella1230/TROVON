int poly_2xm1(u_char sign, FPU_REG *arg, FPU_REG *result)\r\n{\r\nlong int exponent, shift;\r\nunsigned long long Xll;\r\nXsig accumulator, Denom, argSignif;\r\nu_char tag;\r\nexponent = exponent16(arg);\r\n#ifdef PARANOID\r\nif (exponent >= 0) {\r\nEXCEPTION(EX_INTERNAL | 0x127);\r\nreturn 1;\r\n}\r\n#endif\r\nargSignif.lsw = 0;\r\nXSIG_LL(argSignif) = Xll = significand(arg);\r\nif (exponent == -1) {\r\nshift = (argSignif.msw & 0x40000000) ? 3 : 2;\r\nexponent -= 2;\r\nXSIG_LL(argSignif) <<= 2;\r\nXll <<= 2;\r\n} else if (exponent == -2) {\r\nshift = 1;\r\nexponent--;\r\nXSIG_LL(argSignif) <<= 1;\r\nXll <<= 1;\r\n} else\r\nshift = 0;\r\nif (exponent < -2) {\r\nif (FPU_shrx(&Xll, -2 - exponent) >= 0x80000000U)\r\nXll++;\r\n}\r\naccumulator.lsw = accumulator.midw = accumulator.msw = 0;\r\npolynomial_Xsig(&accumulator, &Xll, lterms, HIPOWER - 1);\r\nmul_Xsig_Xsig(&accumulator, &argSignif);\r\nshr_Xsig(&accumulator, 3);\r\nmul_Xsig_Xsig(&argSignif, &hiterm);\r\nadd_two_Xsig(&accumulator, &argSignif, &exponent);\r\nif (shift) {\r\nshr_Xsig(&accumulator, -exponent);\r\naccumulator.msw |= 0x80000000;\r\nmul_Xsig_Xsig(&accumulator, shiftterm[shift]);\r\naccumulator.msw &= 0x3fffffff;\r\nexponent = 1;\r\n}\r\nif (sign != SIGN_POS) {\r\nDenom.lsw = accumulator.lsw;\r\nXSIG_LL(Denom) = XSIG_LL(accumulator);\r\nif (exponent < 0)\r\nshr_Xsig(&Denom, -exponent);\r\nelse if (exponent > 0) {\r\nXSIG_LL(Denom) <<= 1;\r\nif (Denom.lsw & 0x80000000)\r\nXSIG_LL(Denom) |= 1;\r\n(Denom.lsw) <<= 1;\r\n}\r\nDenom.msw |= 0x80000000;\r\ndiv_Xsig(&accumulator, &Denom, &accumulator);\r\n}\r\nexponent += round_Xsig(&accumulator);\r\nresult = &st(0);\r\nsignificand(result) = XSIG_LL(accumulator);\r\nsetexponent16(result, exponent);\r\ntag = FPU_round(result, 1, 0, FULL_PRECISION, sign);\r\nsetsign(result, sign);\r\nFPU_settag0(tag);\r\nreturn 0;\r\n}
