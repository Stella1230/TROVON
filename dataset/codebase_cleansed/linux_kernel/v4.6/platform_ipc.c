void __init ipc_device_handler(struct sfi_device_table_entry *pentry,\r\nstruct devs_id *dev)\r\n{\r\nstruct platform_device *pdev;\r\nvoid *pdata = NULL;\r\nstatic struct resource res __initdata = {\r\n.name = "IRQ",\r\n.flags = IORESOURCE_IRQ,\r\n};\r\npr_debug("IPC bus, name = %16.16s, irq = 0x%2x\n",\r\npentry->name, pentry->irq);\r\nif (dev != NULL)\r\npdata = dev->get_platform_data(pentry);\r\nif (intel_mid_has_msic())\r\nreturn;\r\npdev = platform_device_alloc(pentry->name, 0);\r\nif (pdev == NULL) {\r\npr_err("out of memory for SFI platform device '%s'.\n",\r\npentry->name);\r\nreturn;\r\n}\r\nres.start = pentry->irq;\r\nplatform_device_add_resources(pdev, &res, 1);\r\npdev->dev.platform_data = pdata;\r\nintel_scu_device_register(pdev);\r\n}
