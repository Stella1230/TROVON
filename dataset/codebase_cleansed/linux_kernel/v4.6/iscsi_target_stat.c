static struct iscsi_tiqn *iscsi_instance_tiqn(struct config_item *item)\r\n{\r\nstruct iscsi_wwn_stat_grps *igrps = container_of(to_config_group(item),\r\nstruct iscsi_wwn_stat_grps, iscsi_instance_group);\r\nreturn container_of(igrps, struct iscsi_tiqn, tiqn_stat_grps);\r\n}\r\nstatic ssize_t iscsi_stat_instance_inst_show(struct config_item *item,\r\nchar *page)\r\n{\r\nreturn snprintf(page, PAGE_SIZE, "%u\n",\r\niscsi_instance_tiqn(item)->tiqn_index);\r\n}\r\nstatic ssize_t iscsi_stat_instance_min_ver_show(struct config_item *item,\r\nchar *page)\r\n{\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", ISCSI_DRAFT20_VERSION);\r\n}\r\nstatic ssize_t iscsi_stat_instance_max_ver_show(struct config_item *item,\r\nchar *page)\r\n{\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", ISCSI_DRAFT20_VERSION);\r\n}\r\nstatic ssize_t iscsi_stat_instance_portals_show(struct config_item *item,\r\nchar *page)\r\n{\r\nreturn snprintf(page, PAGE_SIZE, "%u\n",\r\niscsi_instance_tiqn(item)->tiqn_num_tpg_nps);\r\n}\r\nstatic ssize_t iscsi_stat_instance_nodes_show(struct config_item *item,\r\nchar *page)\r\n{\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", ISCSI_INST_NUM_NODES);\r\n}\r\nstatic ssize_t iscsi_stat_instance_sessions_show(struct config_item *item,\r\nchar *page)\r\n{\r\nreturn snprintf(page, PAGE_SIZE, "%u\n",\r\niscsi_instance_tiqn(item)->tiqn_nsessions);\r\n}\r\nstatic ssize_t iscsi_stat_instance_fail_sess_show(struct config_item *item,\r\nchar *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = iscsi_instance_tiqn(item);\r\nstruct iscsi_sess_err_stats *sess_err = &tiqn->sess_err_stats;\r\nu32 sess_err_count;\r\nspin_lock_bh(&sess_err->lock);\r\nsess_err_count = (sess_err->digest_errors +\r\nsess_err->cxn_timeout_errors +\r\nsess_err->pdu_format_errors);\r\nspin_unlock_bh(&sess_err->lock);\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", sess_err_count);\r\n}\r\nstatic ssize_t iscsi_stat_instance_fail_type_show(struct config_item *item,\r\nchar *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = iscsi_instance_tiqn(item);\r\nstruct iscsi_sess_err_stats *sess_err = &tiqn->sess_err_stats;\r\nreturn snprintf(page, PAGE_SIZE, "%u\n",\r\nsess_err->last_sess_failure_type);\r\n}\r\nstatic ssize_t iscsi_stat_instance_fail_rem_name_show(struct config_item *item,\r\nchar *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = iscsi_instance_tiqn(item);\r\nstruct iscsi_sess_err_stats *sess_err = &tiqn->sess_err_stats;\r\nreturn snprintf(page, PAGE_SIZE, "%s\n",\r\nsess_err->last_sess_fail_rem_name[0] ?\r\nsess_err->last_sess_fail_rem_name : NONE);\r\n}\r\nstatic ssize_t iscsi_stat_instance_disc_time_show(struct config_item *item,\r\nchar *page)\r\n{\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", ISCSI_DISCONTINUITY_TIME);\r\n}\r\nstatic ssize_t iscsi_stat_instance_description_show(struct config_item *item,\r\nchar *page)\r\n{\r\nreturn snprintf(page, PAGE_SIZE, "%s\n", ISCSI_INST_DESCR);\r\n}\r\nstatic ssize_t iscsi_stat_instance_vendor_show(struct config_item *item,\r\nchar *page)\r\n{\r\nreturn snprintf(page, PAGE_SIZE, "Datera, Inc. iSCSI-Target\n");\r\n}\r\nstatic ssize_t iscsi_stat_instance_version_show(struct config_item *item,\r\nchar *page)\r\n{\r\nreturn snprintf(page, PAGE_SIZE, "%s\n", ISCSIT_VERSION);\r\n}\r\nstatic struct iscsi_tiqn *iscsi_sess_err_tiqn(struct config_item *item)\r\n{\r\nstruct iscsi_wwn_stat_grps *igrps = container_of(to_config_group(item),\r\nstruct iscsi_wwn_stat_grps, iscsi_sess_err_group);\r\nreturn container_of(igrps, struct iscsi_tiqn, tiqn_stat_grps);\r\n}\r\nstatic ssize_t iscsi_stat_sess_err_inst_show(struct config_item *item,\r\nchar *page)\r\n{\r\nreturn snprintf(page, PAGE_SIZE, "%u\n",\r\niscsi_sess_err_tiqn(item)->tiqn_index);\r\n}\r\nstatic ssize_t iscsi_stat_sess_err_digest_errors_show(struct config_item *item,\r\nchar *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = iscsi_sess_err_tiqn(item);\r\nstruct iscsi_sess_err_stats *sess_err = &tiqn->sess_err_stats;\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", sess_err->digest_errors);\r\n}\r\nstatic ssize_t iscsi_stat_sess_err_cxn_errors_show(struct config_item *item,\r\nchar *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = iscsi_sess_err_tiqn(item);\r\nstruct iscsi_sess_err_stats *sess_err = &tiqn->sess_err_stats;\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", sess_err->cxn_timeout_errors);\r\n}\r\nstatic ssize_t iscsi_stat_sess_err_format_errors_show(struct config_item *item,\r\nchar *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = iscsi_sess_err_tiqn(item);\r\nstruct iscsi_sess_err_stats *sess_err = &tiqn->sess_err_stats;\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", sess_err->pdu_format_errors);\r\n}\r\nstatic struct iscsi_tiqn *iscsi_tgt_attr_tiqn(struct config_item *item)\r\n{\r\nstruct iscsi_wwn_stat_grps *igrps = container_of(to_config_group(item),\r\nstruct iscsi_wwn_stat_grps, iscsi_tgt_attr_group);\r\nreturn container_of(igrps, struct iscsi_tiqn, tiqn_stat_grps);\r\n}\r\nstatic ssize_t iscsi_stat_tgt_attr_inst_show(struct config_item *item,\r\nchar *page)\r\n{\r\nreturn snprintf(page, PAGE_SIZE, "%u\n",\r\niscsi_tgt_attr_tiqn(item)->tiqn_index);\r\n}\r\nstatic ssize_t iscsi_stat_tgt_attr_indx_show(struct config_item *item,\r\nchar *page)\r\n{\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", ISCSI_NODE_INDEX);\r\n}\r\nstatic ssize_t iscsi_stat_tgt_attr_login_fails_show(struct config_item *item,\r\nchar *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = iscsi_tgt_attr_tiqn(item);\r\nstruct iscsi_login_stats *lstat = &tiqn->login_stats;\r\nu32 fail_count;\r\nspin_lock(&lstat->lock);\r\nfail_count = (lstat->redirects + lstat->authorize_fails +\r\nlstat->authenticate_fails + lstat->negotiate_fails +\r\nlstat->other_fails);\r\nspin_unlock(&lstat->lock);\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", fail_count);\r\n}\r\nstatic ssize_t iscsi_stat_tgt_attr_last_fail_time_show(struct config_item *item,\r\nchar *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = iscsi_tgt_attr_tiqn(item);\r\nstruct iscsi_login_stats *lstat = &tiqn->login_stats;\r\nu32 last_fail_time;\r\nspin_lock(&lstat->lock);\r\nlast_fail_time = lstat->last_fail_time ?\r\n(u32)(((u32)lstat->last_fail_time -\r\nINITIAL_JIFFIES) * 100 / HZ) : 0;\r\nspin_unlock(&lstat->lock);\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", last_fail_time);\r\n}\r\nstatic ssize_t iscsi_stat_tgt_attr_last_fail_type_show(struct config_item *item,\r\nchar *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = iscsi_tgt_attr_tiqn(item);\r\nstruct iscsi_login_stats *lstat = &tiqn->login_stats;\r\nu32 last_fail_type;\r\nspin_lock(&lstat->lock);\r\nlast_fail_type = lstat->last_fail_type;\r\nspin_unlock(&lstat->lock);\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", last_fail_type);\r\n}\r\nstatic ssize_t iscsi_stat_tgt_attr_fail_intr_name_show(struct config_item *item,\r\nchar *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = iscsi_tgt_attr_tiqn(item);\r\nstruct iscsi_login_stats *lstat = &tiqn->login_stats;\r\nunsigned char buf[224];\r\nspin_lock(&lstat->lock);\r\nsnprintf(buf, 224, "%s", lstat->last_intr_fail_name[0] ?\r\nlstat->last_intr_fail_name : NONE);\r\nspin_unlock(&lstat->lock);\r\nreturn snprintf(page, PAGE_SIZE, "%s\n", buf);\r\n}\r\nstatic ssize_t iscsi_stat_tgt_attr_fail_intr_addr_type_show(struct config_item *item,\r\nchar *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = iscsi_tgt_attr_tiqn(item);\r\nstruct iscsi_login_stats *lstat = &tiqn->login_stats;\r\nint ret;\r\nspin_lock(&lstat->lock);\r\nif (lstat->last_intr_fail_ip_family == AF_INET6)\r\nret = snprintf(page, PAGE_SIZE, "ipv6\n");\r\nelse\r\nret = snprintf(page, PAGE_SIZE, "ipv4\n");\r\nspin_unlock(&lstat->lock);\r\nreturn ret;\r\n}\r\nstatic ssize_t iscsi_stat_tgt_attr_fail_intr_addr_show(struct config_item *item,\r\nchar *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = iscsi_tgt_attr_tiqn(item);\r\nstruct iscsi_login_stats *lstat = &tiqn->login_stats;\r\nint ret;\r\nspin_lock(&lstat->lock);\r\nret = snprintf(page, PAGE_SIZE, "%pISc\n", &lstat->last_intr_fail_sockaddr);\r\nspin_unlock(&lstat->lock);\r\nreturn ret;\r\n}\r\nstatic struct iscsi_tiqn *iscsi_login_stat_tiqn(struct config_item *item)\r\n{\r\nstruct iscsi_wwn_stat_grps *igrps = container_of(to_config_group(item),\r\nstruct iscsi_wwn_stat_grps, iscsi_login_stats_group);\r\nreturn container_of(igrps, struct iscsi_tiqn, tiqn_stat_grps);\r\n}\r\nstatic ssize_t iscsi_stat_login_inst_show(struct config_item *item, char *page)\r\n{\r\nreturn snprintf(page, PAGE_SIZE, "%u\n",\r\niscsi_login_stat_tiqn(item)->tiqn_index);\r\n}\r\nstatic ssize_t iscsi_stat_login_indx_show(struct config_item *item,\r\nchar *page)\r\n{\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", ISCSI_NODE_INDEX);\r\n}\r\nstatic ssize_t iscsi_stat_login_accepts_show(struct config_item *item,\r\nchar *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = iscsi_login_stat_tiqn(item);\r\nstruct iscsi_login_stats *lstat = &tiqn->login_stats;\r\nssize_t ret;\r\nspin_lock(&lstat->lock);\r\nret = snprintf(page, PAGE_SIZE, "%u\n", lstat->accepts);\r\nspin_unlock(&lstat->lock);\r\nreturn ret;\r\n}\r\nstatic ssize_t iscsi_stat_login_other_fails_show(struct config_item *item,\r\nchar *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = iscsi_login_stat_tiqn(item);\r\nstruct iscsi_login_stats *lstat = &tiqn->login_stats;\r\nssize_t ret;\r\nspin_lock(&lstat->lock);\r\nret = snprintf(page, PAGE_SIZE, "%u\n", lstat->other_fails);\r\nspin_unlock(&lstat->lock);\r\nreturn ret;\r\n}\r\nstatic ssize_t iscsi_stat_login_redirects_show(struct config_item *item,\r\nchar *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = iscsi_login_stat_tiqn(item);\r\nstruct iscsi_login_stats *lstat = &tiqn->login_stats;\r\nssize_t ret;\r\nspin_lock(&lstat->lock);\r\nret = snprintf(page, PAGE_SIZE, "%u\n", lstat->redirects);\r\nspin_unlock(&lstat->lock);\r\nreturn ret;\r\n}\r\nstatic ssize_t iscsi_stat_login_authorize_fails_show(struct config_item *item,\r\nchar *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = iscsi_login_stat_tiqn(item);\r\nstruct iscsi_login_stats *lstat = &tiqn->login_stats;\r\nssize_t ret;\r\nspin_lock(&lstat->lock);\r\nret = snprintf(page, PAGE_SIZE, "%u\n", lstat->authorize_fails);\r\nspin_unlock(&lstat->lock);\r\nreturn ret;\r\n}\r\nstatic ssize_t iscsi_stat_login_authenticate_fails_show(\r\nstruct config_item *item, char *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = iscsi_login_stat_tiqn(item);\r\nstruct iscsi_login_stats *lstat = &tiqn->login_stats;\r\nssize_t ret;\r\nspin_lock(&lstat->lock);\r\nret = snprintf(page, PAGE_SIZE, "%u\n", lstat->authenticate_fails);\r\nspin_unlock(&lstat->lock);\r\nreturn ret;\r\n}\r\nstatic ssize_t iscsi_stat_login_negotiate_fails_show(struct config_item *item,\r\nchar *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = iscsi_login_stat_tiqn(item);\r\nstruct iscsi_login_stats *lstat = &tiqn->login_stats;\r\nssize_t ret;\r\nspin_lock(&lstat->lock);\r\nret = snprintf(page, PAGE_SIZE, "%u\n", lstat->negotiate_fails);\r\nspin_unlock(&lstat->lock);\r\nreturn ret;\r\n}\r\nstatic struct iscsi_tiqn *iscsi_logout_stat_tiqn(struct config_item *item)\r\n{\r\nstruct iscsi_wwn_stat_grps *igrps = container_of(to_config_group(item),\r\nstruct iscsi_wwn_stat_grps, iscsi_logout_stats_group);\r\nreturn container_of(igrps, struct iscsi_tiqn, tiqn_stat_grps);\r\n}\r\nstatic ssize_t iscsi_stat_logout_inst_show(struct config_item *item, char *page)\r\n{\r\nreturn snprintf(page, PAGE_SIZE, "%u\n",\r\niscsi_logout_stat_tiqn(item)->tiqn_index);\r\n}\r\nstatic ssize_t iscsi_stat_logout_indx_show(struct config_item *item, char *page)\r\n{\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", ISCSI_NODE_INDEX);\r\n}\r\nstatic ssize_t iscsi_stat_logout_normal_logouts_show(struct config_item *item,\r\nchar *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = iscsi_logout_stat_tiqn(item);\r\nstruct iscsi_logout_stats *lstats = &tiqn->logout_stats;\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", lstats->normal_logouts);\r\n}\r\nstatic ssize_t iscsi_stat_logout_abnormal_logouts_show(struct config_item *item,\r\nchar *page)\r\n{\r\nstruct iscsi_tiqn *tiqn = iscsi_logout_stat_tiqn(item);\r\nstruct iscsi_logout_stats *lstats = &tiqn->logout_stats;\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", lstats->abnormal_logouts);\r\n}\r\nstatic struct iscsi_node_acl *iscsi_stat_nacl(struct config_item *item)\r\n{\r\nstruct iscsi_node_stat_grps *igrps = container_of(to_config_group(item),\r\nstruct iscsi_node_stat_grps, iscsi_sess_stats_group);\r\nreturn container_of(igrps, struct iscsi_node_acl, node_stat_grps);\r\n}\r\nstatic ssize_t iscsi_stat_sess_inst_show(struct config_item *item, char *page)\r\n{\r\nstruct iscsi_node_acl *acl = iscsi_stat_nacl(item);\r\nstruct se_wwn *wwn = acl->se_node_acl.se_tpg->se_tpg_wwn;\r\nstruct iscsi_tiqn *tiqn = container_of(wwn,\r\nstruct iscsi_tiqn, tiqn_wwn);\r\nreturn snprintf(page, PAGE_SIZE, "%u\n", tiqn->tiqn_index);\r\n}\r\nstatic ssize_t iscsi_stat_sess_node_show(struct config_item *item, char *page)\r\n{\r\nstruct iscsi_node_acl *acl = iscsi_stat_nacl(item);\r\nstruct se_node_acl *se_nacl = &acl->se_node_acl;\r\nstruct iscsi_session *sess;\r\nstruct se_session *se_sess;\r\nssize_t ret = 0;\r\nspin_lock_bh(&se_nacl->nacl_sess_lock);\r\nse_sess = se_nacl->nacl_sess;\r\nif (se_sess) {\r\nsess = se_sess->fabric_sess_ptr;\r\nif (sess)\r\nret = snprintf(page, PAGE_SIZE, "%u\n",\r\nsess->sess_ops->SessionType ? 0 : ISCSI_NODE_INDEX);\r\n}\r\nspin_unlock_bh(&se_nacl->nacl_sess_lock);\r\nreturn ret;\r\n}\r\nstatic ssize_t iscsi_stat_sess_indx_show(struct config_item *item, char *page)\r\n{\r\nstruct iscsi_node_acl *acl = iscsi_stat_nacl(item);\r\nstruct se_node_acl *se_nacl = &acl->se_node_acl;\r\nstruct iscsi_session *sess;\r\nstruct se_session *se_sess;\r\nssize_t ret = 0;\r\nspin_lock_bh(&se_nacl->nacl_sess_lock);\r\nse_sess = se_nacl->nacl_sess;\r\nif (se_sess) {\r\nsess = se_sess->fabric_sess_ptr;\r\nif (sess)\r\nret = snprintf(page, PAGE_SIZE, "%u\n",\r\nsess->session_index);\r\n}\r\nspin_unlock_bh(&se_nacl->nacl_sess_lock);\r\nreturn ret;\r\n}\r\nstatic ssize_t iscsi_stat_sess_cmd_pdus_show(struct config_item *item,\r\nchar *page)\r\n{\r\nstruct iscsi_node_acl *acl = iscsi_stat_nacl(item);\r\nstruct se_node_acl *se_nacl = &acl->se_node_acl;\r\nstruct iscsi_session *sess;\r\nstruct se_session *se_sess;\r\nssize_t ret = 0;\r\nspin_lock_bh(&se_nacl->nacl_sess_lock);\r\nse_sess = se_nacl->nacl_sess;\r\nif (se_sess) {\r\nsess = se_sess->fabric_sess_ptr;\r\nif (sess)\r\nret = snprintf(page, PAGE_SIZE, "%lu\n",\r\natomic_long_read(&sess->cmd_pdus));\r\n}\r\nspin_unlock_bh(&se_nacl->nacl_sess_lock);\r\nreturn ret;\r\n}\r\nstatic ssize_t iscsi_stat_sess_rsp_pdus_show(struct config_item *item,\r\nchar *page)\r\n{\r\nstruct iscsi_node_acl *acl = iscsi_stat_nacl(item);\r\nstruct se_node_acl *se_nacl = &acl->se_node_acl;\r\nstruct iscsi_session *sess;\r\nstruct se_session *se_sess;\r\nssize_t ret = 0;\r\nspin_lock_bh(&se_nacl->nacl_sess_lock);\r\nse_sess = se_nacl->nacl_sess;\r\nif (se_sess) {\r\nsess = se_sess->fabric_sess_ptr;\r\nif (sess)\r\nret = snprintf(page, PAGE_SIZE, "%lu\n",\r\natomic_long_read(&sess->rsp_pdus));\r\n}\r\nspin_unlock_bh(&se_nacl->nacl_sess_lock);\r\nreturn ret;\r\n}\r\nstatic ssize_t iscsi_stat_sess_txdata_octs_show(struct config_item *item,\r\nchar *page)\r\n{\r\nstruct iscsi_node_acl *acl = iscsi_stat_nacl(item);\r\nstruct se_node_acl *se_nacl = &acl->se_node_acl;\r\nstruct iscsi_session *sess;\r\nstruct se_session *se_sess;\r\nssize_t ret = 0;\r\nspin_lock_bh(&se_nacl->nacl_sess_lock);\r\nse_sess = se_nacl->nacl_sess;\r\nif (se_sess) {\r\nsess = se_sess->fabric_sess_ptr;\r\nif (sess)\r\nret = snprintf(page, PAGE_SIZE, "%lu\n",\r\natomic_long_read(&sess->tx_data_octets));\r\n}\r\nspin_unlock_bh(&se_nacl->nacl_sess_lock);\r\nreturn ret;\r\n}\r\nstatic ssize_t iscsi_stat_sess_rxdata_octs_show(struct config_item *item,\r\nchar *page)\r\n{\r\nstruct iscsi_node_acl *acl = iscsi_stat_nacl(item);\r\nstruct se_node_acl *se_nacl = &acl->se_node_acl;\r\nstruct iscsi_session *sess;\r\nstruct se_session *se_sess;\r\nssize_t ret = 0;\r\nspin_lock_bh(&se_nacl->nacl_sess_lock);\r\nse_sess = se_nacl->nacl_sess;\r\nif (se_sess) {\r\nsess = se_sess->fabric_sess_ptr;\r\nif (sess)\r\nret = snprintf(page, PAGE_SIZE, "%lu\n",\r\natomic_long_read(&sess->rx_data_octets));\r\n}\r\nspin_unlock_bh(&se_nacl->nacl_sess_lock);\r\nreturn ret;\r\n}\r\nstatic ssize_t iscsi_stat_sess_conn_digest_errors_show(struct config_item *item,\r\nchar *page)\r\n{\r\nstruct iscsi_node_acl *acl = iscsi_stat_nacl(item);\r\nstruct se_node_acl *se_nacl = &acl->se_node_acl;\r\nstruct iscsi_session *sess;\r\nstruct se_session *se_sess;\r\nssize_t ret = 0;\r\nspin_lock_bh(&se_nacl->nacl_sess_lock);\r\nse_sess = se_nacl->nacl_sess;\r\nif (se_sess) {\r\nsess = se_sess->fabric_sess_ptr;\r\nif (sess)\r\nret = snprintf(page, PAGE_SIZE, "%lu\n",\r\natomic_long_read(&sess->conn_digest_errors));\r\n}\r\nspin_unlock_bh(&se_nacl->nacl_sess_lock);\r\nreturn ret;\r\n}\r\nstatic ssize_t iscsi_stat_sess_conn_timeout_errors_show(\r\nstruct config_item *item, char *page)\r\n{\r\nstruct iscsi_node_acl *acl = iscsi_stat_nacl(item);\r\nstruct se_node_acl *se_nacl = &acl->se_node_acl;\r\nstruct iscsi_session *sess;\r\nstruct se_session *se_sess;\r\nssize_t ret = 0;\r\nspin_lock_bh(&se_nacl->nacl_sess_lock);\r\nse_sess = se_nacl->nacl_sess;\r\nif (se_sess) {\r\nsess = se_sess->fabric_sess_ptr;\r\nif (sess)\r\nret = snprintf(page, PAGE_SIZE, "%lu\n",\r\natomic_long_read(&sess->conn_timeout_errors));\r\n}\r\nspin_unlock_bh(&se_nacl->nacl_sess_lock);\r\nreturn ret;\r\n}
