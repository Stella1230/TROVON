static long j_do_fork(unsigned long clone_flags, unsigned long stack_start,\r\nunsigned long stack_size, int __user *parent_tidptr,\r\nint __user *child_tidptr)\r\n{\r\npr_info("jprobe: clone_flags = 0x%lx, stack_start = 0x%lx "\r\n"stack_size = 0x%lx\n", clone_flags, stack_start, stack_size);\r\njprobe_return();\r\nreturn 0;\r\n}\r\nstatic int __init jprobe_init(void)\r\n{\r\nint ret;\r\nret = register_jprobe(&my_jprobe);\r\nif (ret < 0) {\r\nprintk(KERN_INFO "register_jprobe failed, returned %d\n", ret);\r\nreturn -1;\r\n}\r\nprintk(KERN_INFO "Planted jprobe at %p, handler addr %p\n",\r\nmy_jprobe.kp.addr, my_jprobe.entry);\r\nreturn 0;\r\n}\r\nstatic void __exit jprobe_exit(void)\r\n{\r\nunregister_jprobe(&my_jprobe);\r\nprintk(KERN_INFO "jprobe at %p unregistered\n", my_jprobe.kp.addr);\r\n}
