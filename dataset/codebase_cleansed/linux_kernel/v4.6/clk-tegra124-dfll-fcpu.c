static int tegra124_dfll_fcpu_probe(struct platform_device *pdev)\r\n{\r\nint process_id, speedo_id, speedo_value;\r\nstruct tegra_dfll_soc_data *soc;\r\nconst struct cvb_table *cvb;\r\nprocess_id = tegra_sku_info.cpu_process_id;\r\nspeedo_id = tegra_sku_info.cpu_speedo_id;\r\nspeedo_value = tegra_sku_info.cpu_speedo_value;\r\nif (speedo_id >= ARRAY_SIZE(cpu_max_freq_table)) {\r\ndev_err(&pdev->dev, "unknown max CPU freq for speedo_id=%d\n",\r\nspeedo_id);\r\nreturn -ENODEV;\r\n}\r\nsoc = devm_kzalloc(&pdev->dev, sizeof(*soc), GFP_KERNEL);\r\nif (!soc)\r\nreturn -ENOMEM;\r\nsoc->dev = get_cpu_device(0);\r\nif (!soc->dev) {\r\ndev_err(&pdev->dev, "no CPU0 device\n");\r\nreturn -ENODEV;\r\n}\r\ncvb = tegra_cvb_build_opp_table(tegra124_cpu_cvb_tables,\r\nARRAY_SIZE(tegra124_cpu_cvb_tables),\r\nprocess_id, speedo_id, speedo_value,\r\ncpu_max_freq_table[speedo_id],\r\nsoc->dev);\r\nif (IS_ERR(cvb)) {\r\ndev_err(&pdev->dev, "couldn't build OPP table: %ld\n",\r\nPTR_ERR(cvb));\r\nreturn PTR_ERR(cvb);\r\n}\r\nsoc->min_millivolts = cvb->min_millivolts;\r\nsoc->tune0_low = cvb->cpu_dfll_data.tune0_low;\r\nsoc->tune0_high = cvb->cpu_dfll_data.tune0_high;\r\nsoc->tune1 = cvb->cpu_dfll_data.tune1;\r\nreturn tegra_dfll_register(pdev, soc);\r\n}\r\nstatic int __init tegra124_dfll_fcpu_init(void)\r\n{\r\nreturn platform_driver_register(&tegra124_dfll_fcpu_driver);\r\n}\r\nstatic void __exit tegra124_dfll_fcpu_exit(void)\r\n{\r\nplatform_driver_unregister(&tegra124_dfll_fcpu_driver);\r\n}
