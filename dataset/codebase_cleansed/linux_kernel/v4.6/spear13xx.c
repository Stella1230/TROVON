void __init spear13xx_l2x0_init(void)\r\n{\r\nif (!IS_ENABLED(CONFIG_CACHE_L2X0))\r\nreturn;\r\nwritel_relaxed(0x06, VA_L2CC_BASE + L310_PREFETCH_CTRL);\r\nwritel_relaxed(0x221, VA_L2CC_BASE + L310_TAG_LATENCY_CTRL);\r\nwritel_relaxed(0x441, VA_L2CC_BASE + L310_DATA_LATENCY_CTRL);\r\nl2x0_init(VA_L2CC_BASE, 0x30a00001, 0xfe0fffff);\r\n}\r\nvoid __init spear13xx_map_io(void)\r\n{\r\niotable_init(spear13xx_io_desc, ARRAY_SIZE(spear13xx_io_desc));\r\n}\r\nstatic void __init spear13xx_clk_init(void)\r\n{\r\nif (of_machine_is_compatible("st,spear1310"))\r\nspear1310_clk_init(VA_MISC_BASE, VA_SPEAR1310_RAS_BASE);\r\nelse if (of_machine_is_compatible("st,spear1340"))\r\nspear1340_clk_init(VA_MISC_BASE);\r\nelse\r\npr_err("%s: Unknown machine\n", __func__);\r\n}\r\nvoid __init spear13xx_timer_init(void)\r\n{\r\nchar pclk_name[] = "osc_24m_clk";\r\nstruct clk *gpt_clk, *pclk;\r\nspear13xx_clk_init();\r\ngpt_clk = clk_get_sys("gpt0", NULL);\r\nif (IS_ERR(gpt_clk)) {\r\npr_err("%s:couldn't get clk for gpt\n", __func__);\r\nBUG();\r\n}\r\npclk = clk_get(NULL, pclk_name);\r\nif (IS_ERR(pclk)) {\r\npr_err("%s:couldn't get %s as parent for gpt\n", __func__,\r\npclk_name);\r\nBUG();\r\n}\r\nclk_set_parent(gpt_clk, pclk);\r\nclk_put(gpt_clk);\r\nclk_put(pclk);\r\nspear_setup_of_timer();\r\nclocksource_probe();\r\n}
