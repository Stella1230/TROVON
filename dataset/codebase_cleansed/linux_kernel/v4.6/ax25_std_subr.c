void ax25_std_nr_error_recovery(ax25_cb *ax25)\r\n{\r\nax25_std_establish_data_link(ax25);\r\n}\r\nvoid ax25_std_establish_data_link(ax25_cb *ax25)\r\n{\r\nax25->condition = 0x00;\r\nax25->n2count = 0;\r\nif (ax25->modulus == AX25_MODULUS)\r\nax25_send_control(ax25, AX25_SABM, AX25_POLLON, AX25_COMMAND);\r\nelse\r\nax25_send_control(ax25, AX25_SABME, AX25_POLLON, AX25_COMMAND);\r\nax25_calculate_t1(ax25);\r\nax25_stop_idletimer(ax25);\r\nax25_stop_t3timer(ax25);\r\nax25_stop_t2timer(ax25);\r\nax25_start_t1timer(ax25);\r\n}\r\nvoid ax25_std_transmit_enquiry(ax25_cb *ax25)\r\n{\r\nif (ax25->condition & AX25_COND_OWN_RX_BUSY)\r\nax25_send_control(ax25, AX25_RNR, AX25_POLLON, AX25_COMMAND);\r\nelse\r\nax25_send_control(ax25, AX25_RR, AX25_POLLON, AX25_COMMAND);\r\nax25->condition &= ~AX25_COND_ACK_PENDING;\r\nax25_calculate_t1(ax25);\r\nax25_start_t1timer(ax25);\r\n}\r\nvoid ax25_std_enquiry_response(ax25_cb *ax25)\r\n{\r\nif (ax25->condition & AX25_COND_OWN_RX_BUSY)\r\nax25_send_control(ax25, AX25_RNR, AX25_POLLON, AX25_RESPONSE);\r\nelse\r\nax25_send_control(ax25, AX25_RR, AX25_POLLON, AX25_RESPONSE);\r\nax25->condition &= ~AX25_COND_ACK_PENDING;\r\n}\r\nvoid ax25_std_timeout_response(ax25_cb *ax25)\r\n{\r\nif (ax25->condition & AX25_COND_OWN_RX_BUSY)\r\nax25_send_control(ax25, AX25_RNR, AX25_POLLOFF, AX25_RESPONSE);\r\nelse\r\nax25_send_control(ax25, AX25_RR, AX25_POLLOFF, AX25_RESPONSE);\r\nax25->condition &= ~AX25_COND_ACK_PENDING;\r\n}
