void __init reserve_ebda_region(void)\r\n{\r\nunsigned int lowmem, ebda_addr;\r\nif (paravirt_enabled())\r\nreturn;\r\nlowmem = *(unsigned short *)__va(BIOS_LOWMEM_KILOBYTES);\r\nlowmem <<= 10;\r\nebda_addr = get_bios_ebda();\r\nif (ebda_addr < INSANE_CUTOFF)\r\nebda_addr = LOWMEM_CAP;\r\nif (lowmem < INSANE_CUTOFF)\r\nlowmem = LOWMEM_CAP;\r\nlowmem = min(lowmem, ebda_addr);\r\nlowmem = min(lowmem, LOWMEM_CAP);\r\nmemblock_reserve(lowmem, 0x100000 - lowmem);\r\n}
