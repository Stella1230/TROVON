mpi_limb_t\r\nmpihelp_rshift(mpi_ptr_t wp, mpi_ptr_t up, mpi_size_t usize, unsigned cnt)\r\n{\r\nmpi_limb_t high_limb, low_limb;\r\nunsigned sh_1, sh_2;\r\nmpi_size_t i;\r\nmpi_limb_t retval;\r\nsh_1 = cnt;\r\nwp -= 1;\r\nsh_2 = BITS_PER_MPI_LIMB - sh_1;\r\nhigh_limb = up[0];\r\nretval = high_limb << sh_2;\r\nlow_limb = high_limb;\r\nfor (i = 1; i < usize; i++) {\r\nhigh_limb = up[i];\r\nwp[i] = (low_limb >> sh_1) | (high_limb << sh_2);\r\nlow_limb = high_limb;\r\n}\r\nwp[i] = low_limb >> sh_1;\r\nreturn retval;\r\n}
