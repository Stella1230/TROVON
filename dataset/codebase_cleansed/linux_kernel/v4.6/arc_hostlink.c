static int arc_hl_mmap(struct file *fp, struct vm_area_struct *vma)\r\n{\r\nvma->vm_page_prot = pgprot_noncached(vma->vm_page_prot);\r\nif (io_remap_pfn_range(vma, vma->vm_start, vma->vm_pgoff,\r\nvma->vm_end - vma->vm_start,\r\nvma->vm_page_prot)) {\r\npr_warn("Hostlink buffer mmap ERROR\n");\r\nreturn -EAGAIN;\r\n}\r\nreturn 0;\r\n}\r\nstatic long arc_hl_ioctl(struct file *file, unsigned int cmd,\r\nunsigned long arg)\r\n{\r\nput_user((unsigned int)__HOSTLINK__, (int __user *)arg);\r\nreturn 0;\r\n}\r\nstatic int __init arc_hl_init(void)\r\n{\r\npr_info("ARC Hostlink driver mmap at 0x%p\n", __HOSTLINK__);\r\nreturn misc_register(&arc_hl_dev);\r\n}
