static void __init mtk_topckgen_init(struct device_node *node)\r\n{\r\nstruct clk_onecell_data *clk_data;\r\nvoid __iomem *base;\r\nint r;\r\nbase = of_iomap(node, 0);\r\nif (!base) {\r\npr_err("%s(): ioremap failed\n", __func__);\r\nreturn;\r\n}\r\nclk_data = mtk_alloc_clk_data(CLK_TOP_NR_CLK);\r\nmtk_clk_register_factors(root_clk_alias, ARRAY_SIZE(root_clk_alias), clk_data);\r\nmtk_clk_register_factors(top_divs, ARRAY_SIZE(top_divs), clk_data);\r\nmtk_clk_register_composites(top_muxes, ARRAY_SIZE(top_muxes), base,\r\n&mt8135_clk_lock, clk_data);\r\nclk_prepare_enable(clk_data->clks[CLK_TOP_CCI_SEL]);\r\nr = of_clk_add_provider(node, of_clk_src_onecell_get, clk_data);\r\nif (r)\r\npr_err("%s(): could not register clock provider: %d\n",\r\n__func__, r);\r\n}\r\nstatic void __init mtk_infrasys_init(struct device_node *node)\r\n{\r\nstruct clk_onecell_data *clk_data;\r\nint r;\r\nclk_data = mtk_alloc_clk_data(CLK_INFRA_NR_CLK);\r\nmtk_clk_register_gates(node, infra_clks, ARRAY_SIZE(infra_clks),\r\nclk_data);\r\nclk_prepare_enable(clk_data->clks[CLK_INFRA_M4U]);\r\nr = of_clk_add_provider(node, of_clk_src_onecell_get, clk_data);\r\nif (r)\r\npr_err("%s(): could not register clock provider: %d\n",\r\n__func__, r);\r\nmtk_register_reset_controller(node, 2, 0x30);\r\n}\r\nstatic void __init mtk_pericfg_init(struct device_node *node)\r\n{\r\nstruct clk_onecell_data *clk_data;\r\nint r;\r\nvoid __iomem *base;\r\nbase = of_iomap(node, 0);\r\nif (!base) {\r\npr_err("%s(): ioremap failed\n", __func__);\r\nreturn;\r\n}\r\nclk_data = mtk_alloc_clk_data(CLK_PERI_NR_CLK);\r\nmtk_clk_register_gates(node, peri_gates, ARRAY_SIZE(peri_gates),\r\nclk_data);\r\nmtk_clk_register_composites(peri_clks, ARRAY_SIZE(peri_clks), base,\r\n&mt8135_clk_lock, clk_data);\r\nr = of_clk_add_provider(node, of_clk_src_onecell_get, clk_data);\r\nif (r)\r\npr_err("%s(): could not register clock provider: %d\n",\r\n__func__, r);\r\nmtk_register_reset_controller(node, 2, 0);\r\n}\r\nstatic void __init mtk_apmixedsys_init(struct device_node *node)\r\n{\r\nstruct clk_onecell_data *clk_data;\r\nclk_data = mtk_alloc_clk_data(CLK_APMIXED_NR_CLK);\r\nif (!clk_data)\r\nreturn;\r\nmtk_clk_register_plls(node, plls, ARRAY_SIZE(plls), clk_data);\r\n}
