int verify_signature(const struct key *key,\r\nconst struct public_key_signature *sig)\r\n{\r\nconst struct asymmetric_key_subtype *subtype;\r\nint ret;\r\npr_devel("==>%s()\n", __func__);\r\nif (key->type != &key_type_asymmetric)\r\nreturn -EINVAL;\r\nsubtype = asymmetric_key_subtype(key);\r\nif (!subtype ||\r\n!key->payload.data[0])\r\nreturn -EINVAL;\r\nif (!subtype->verify_signature)\r\nreturn -ENOTSUPP;\r\nret = subtype->verify_signature(key, sig);\r\npr_devel("<==%s() = %d\n", __func__, ret);\r\nreturn ret;\r\n}
