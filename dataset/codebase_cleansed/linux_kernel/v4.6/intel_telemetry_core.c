static int telemetry_def_update_events(struct telemetry_evtconfig pss_evtconfig,\r\nstruct telemetry_evtconfig ioss_evtconfig)\r\n{\r\nreturn 0;\r\n}\r\nstatic int telemetry_def_set_sampling_period(u8 pss_period, u8 ioss_period)\r\n{\r\nreturn 0;\r\n}\r\nstatic int telemetry_def_get_sampling_period(u8 *pss_min_period,\r\nu8 *pss_max_period,\r\nu8 *ioss_min_period,\r\nu8 *ioss_max_period)\r\n{\r\nreturn 0;\r\n}\r\nstatic int telemetry_def_get_eventconfig(\r\nstruct telemetry_evtconfig *pss_evtconfig,\r\nstruct telemetry_evtconfig *ioss_evtconfig,\r\nint pss_len, int ioss_len)\r\n{\r\nreturn 0;\r\n}\r\nstatic int telemetry_def_get_trace_verbosity(enum telemetry_unit telem_unit,\r\nu32 *verbosity)\r\n{\r\nreturn 0;\r\n}\r\nstatic int telemetry_def_set_trace_verbosity(enum telemetry_unit telem_unit,\r\nu32 verbosity)\r\n{\r\nreturn 0;\r\n}\r\nstatic int telemetry_def_raw_read_eventlog(enum telemetry_unit telem_unit,\r\nstruct telemetry_evtlog *evtlog,\r\nint len, int log_all_evts)\r\n{\r\nreturn 0;\r\n}\r\nstatic int telemetry_def_read_eventlog(enum telemetry_unit telem_unit,\r\nstruct telemetry_evtlog *evtlog,\r\nint len, int log_all_evts)\r\n{\r\nreturn 0;\r\n}\r\nstatic int telemetry_def_add_events(u8 num_pss_evts, u8 num_ioss_evts,\r\nu32 *pss_evtmap, u32 *ioss_evtmap)\r\n{\r\nreturn 0;\r\n}\r\nstatic int telemetry_def_reset_events(void)\r\n{\r\nreturn 0;\r\n}\r\nint telemetry_update_events(struct telemetry_evtconfig pss_evtconfig,\r\nstruct telemetry_evtconfig ioss_evtconfig)\r\n{\r\nreturn telm_core_conf.telem_ops->update_events(pss_evtconfig,\r\nioss_evtconfig);\r\n}\r\nint telemetry_set_sampling_period(u8 pss_period, u8 ioss_period)\r\n{\r\nreturn telm_core_conf.telem_ops->set_sampling_period(pss_period,\r\nioss_period);\r\n}\r\nint telemetry_get_sampling_period(u8 *pss_min_period, u8 *pss_max_period,\r\nu8 *ioss_min_period, u8 *ioss_max_period)\r\n{\r\nreturn telm_core_conf.telem_ops->get_sampling_period(pss_min_period,\r\npss_max_period,\r\nioss_min_period,\r\nioss_max_period);\r\n}\r\nint telemetry_reset_events(void)\r\n{\r\nreturn telm_core_conf.telem_ops->reset_events();\r\n}\r\nint telemetry_get_eventconfig(struct telemetry_evtconfig *pss_evtconfig,\r\nstruct telemetry_evtconfig *ioss_evtconfig,\r\nint pss_len, int ioss_len)\r\n{\r\nreturn telm_core_conf.telem_ops->get_eventconfig(pss_evtconfig,\r\nioss_evtconfig,\r\npss_len, ioss_len);\r\n}\r\nint telemetry_add_events(u8 num_pss_evts, u8 num_ioss_evts,\r\nu32 *pss_evtmap, u32 *ioss_evtmap)\r\n{\r\nreturn telm_core_conf.telem_ops->add_events(num_pss_evts,\r\nnum_ioss_evts, pss_evtmap,\r\nioss_evtmap);\r\n}\r\nint telemetry_read_events(enum telemetry_unit telem_unit,\r\nstruct telemetry_evtlog *evtlog, int len)\r\n{\r\nreturn telm_core_conf.telem_ops->read_eventlog(telem_unit, evtlog,\r\nlen, 0);\r\n}\r\nint telemetry_raw_read_events(enum telemetry_unit telem_unit,\r\nstruct telemetry_evtlog *evtlog, int len)\r\n{\r\nreturn telm_core_conf.telem_ops->raw_read_eventlog(telem_unit, evtlog,\r\nlen, 0);\r\n}\r\nint telemetry_read_eventlog(enum telemetry_unit telem_unit,\r\nstruct telemetry_evtlog *evtlog, int len)\r\n{\r\nreturn telm_core_conf.telem_ops->read_eventlog(telem_unit, evtlog,\r\nlen, 1);\r\n}\r\nint telemetry_raw_read_eventlog(enum telemetry_unit telem_unit,\r\nstruct telemetry_evtlog *evtlog, int len)\r\n{\r\nreturn telm_core_conf.telem_ops->raw_read_eventlog(telem_unit, evtlog,\r\nlen, 1);\r\n}\r\nint telemetry_get_trace_verbosity(enum telemetry_unit telem_unit,\r\nu32 *verbosity)\r\n{\r\nreturn telm_core_conf.telem_ops->get_trace_verbosity(telem_unit,\r\nverbosity);\r\n}\r\nint telemetry_set_trace_verbosity(enum telemetry_unit telem_unit, u32 verbosity)\r\n{\r\nreturn telm_core_conf.telem_ops->set_trace_verbosity(telem_unit,\r\nverbosity);\r\n}\r\nint telemetry_set_pltdata(struct telemetry_core_ops *ops,\r\nstruct telemetry_plt_config *pltconfig)\r\n{\r\nif (ops)\r\ntelm_core_conf.telem_ops = ops;\r\nif (pltconfig)\r\ntelm_core_conf.plt_config = pltconfig;\r\nreturn 0;\r\n}\r\nint telemetry_clear_pltdata(void)\r\n{\r\ntelm_core_conf.telem_ops = &telm_defpltops;\r\ntelm_core_conf.plt_config = NULL;\r\nreturn 0;\r\n}\r\nint telemetry_pltconfig_valid(void)\r\n{\r\nif (telm_core_conf.plt_config)\r\nreturn 0;\r\nelse\r\nreturn -EINVAL;\r\n}\r\nstatic inline int telemetry_get_pssevtname(enum telemetry_unit telem_unit,\r\nconst char **name, int len)\r\n{\r\nstruct telemetry_unit_config psscfg;\r\nint i;\r\nif (!telm_core_conf.plt_config)\r\nreturn -EINVAL;\r\npsscfg = telm_core_conf.plt_config->pss_config;\r\nif (len > psscfg.ssram_evts_used)\r\nlen = psscfg.ssram_evts_used;\r\nfor (i = 0; i < len; i++)\r\nname[i] = psscfg.telem_evts[i].name;\r\nreturn 0;\r\n}\r\nstatic inline int telemetry_get_iossevtname(enum telemetry_unit telem_unit,\r\nconst char **name, int len)\r\n{\r\nstruct telemetry_unit_config iosscfg;\r\nint i;\r\nif (!(telm_core_conf.plt_config))\r\nreturn -EINVAL;\r\niosscfg = telm_core_conf.plt_config->ioss_config;\r\nif (len > iosscfg.ssram_evts_used)\r\nlen = iosscfg.ssram_evts_used;\r\nfor (i = 0; i < len; i++)\r\nname[i] = iosscfg.telem_evts[i].name;\r\nreturn 0;\r\n}\r\nint telemetry_get_evtname(enum telemetry_unit telem_unit,\r\nconst char **name, int len)\r\n{\r\nint ret = -EINVAL;\r\nif (telem_unit == TELEM_PSS)\r\nret = telemetry_get_pssevtname(telem_unit, name, len);\r\nelse if (telem_unit == TELEM_IOSS)\r\nret = telemetry_get_iossevtname(telem_unit, name, len);\r\nreturn ret;\r\n}\r\nstatic int __init telemetry_module_init(void)\r\n{\r\npr_info(pr_fmt(DRIVER_NAME) " Init\n");\r\ntelm_core_conf.telem_ops = &telm_defpltops;\r\nreturn 0;\r\n}\r\nstatic void __exit telemetry_module_exit(void)\r\n{\r\n}
