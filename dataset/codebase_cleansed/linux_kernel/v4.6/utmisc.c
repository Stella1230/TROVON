u8 acpi_ut_is_pci_root_bridge(char *id)\r\n{\r\nif (!(strcmp(id,\r\nPCI_ROOT_HID_STRING)) ||\r\n!(strcmp(id, PCI_EXPRESS_ROOT_HID_STRING))) {\r\nreturn (TRUE);\r\n}\r\nreturn (FALSE);\r\n}\r\nu8 acpi_ut_is_aml_table(struct acpi_table_header *table)\r\n{\r\nif (ACPI_COMPARE_NAME(table->signature, ACPI_SIG_DSDT) ||\r\nACPI_COMPARE_NAME(table->signature, ACPI_SIG_PSDT) ||\r\nACPI_COMPARE_NAME(table->signature, ACPI_SIG_SSDT) ||\r\nACPI_COMPARE_NAME(table->signature, ACPI_SIG_OSDT)) {\r\nreturn (TRUE);\r\n}\r\nreturn (FALSE);\r\n}\r\nu32 acpi_ut_dword_byte_swap(u32 value)\r\n{\r\nunion {\r\nu32 value;\r\nu8 bytes[4];\r\n} out;\r\nunion {\r\nu32 value;\r\nu8 bytes[4];\r\n} in;\r\nACPI_FUNCTION_ENTRY();\r\nin.value = value;\r\nout.bytes[0] = in.bytes[3];\r\nout.bytes[1] = in.bytes[2];\r\nout.bytes[2] = in.bytes[1];\r\nout.bytes[3] = in.bytes[0];\r\nreturn (out.value);\r\n}\r\nvoid acpi_ut_set_integer_width(u8 revision)\r\n{\r\nif (revision < 2) {\r\nacpi_gbl_integer_bit_width = 32;\r\nacpi_gbl_integer_nybble_width = 8;\r\nacpi_gbl_integer_byte_width = 4;\r\n} else {\r\nacpi_gbl_integer_bit_width = 64;\r\nacpi_gbl_integer_nybble_width = 16;\r\nacpi_gbl_integer_byte_width = 8;\r\n}\r\n}\r\nacpi_status\r\nacpi_ut_create_update_state_and_push(union acpi_operand_object *object,\r\nu16 action,\r\nunion acpi_generic_state **state_list)\r\n{\r\nunion acpi_generic_state *state;\r\nACPI_FUNCTION_ENTRY();\r\nif (!object) {\r\nreturn (AE_OK);\r\n}\r\nstate = acpi_ut_create_update_state(object, action);\r\nif (!state) {\r\nreturn (AE_NO_MEMORY);\r\n}\r\nacpi_ut_push_generic_state(state_list, state);\r\nreturn (AE_OK);\r\n}\r\nacpi_status\r\nacpi_ut_walk_package_tree(union acpi_operand_object *source_object,\r\nvoid *target_object,\r\nacpi_pkg_callback walk_callback, void *context)\r\n{\r\nacpi_status status = AE_OK;\r\nunion acpi_generic_state *state_list = NULL;\r\nunion acpi_generic_state *state;\r\nu32 this_index;\r\nunion acpi_operand_object *this_source_obj;\r\nACPI_FUNCTION_TRACE(ut_walk_package_tree);\r\nstate = acpi_ut_create_pkg_state(source_object, target_object, 0);\r\nif (!state) {\r\nreturn_ACPI_STATUS(AE_NO_MEMORY);\r\n}\r\nwhile (state) {\r\nthis_index = state->pkg.index;\r\nthis_source_obj = (union acpi_operand_object *)\r\nstate->pkg.source_object->package.elements[this_index];\r\nif ((!this_source_obj) ||\r\n(ACPI_GET_DESCRIPTOR_TYPE(this_source_obj) !=\r\nACPI_DESC_TYPE_OPERAND) ||\r\n(this_source_obj->common.type != ACPI_TYPE_PACKAGE)) {\r\nstatus =\r\nwalk_callback(ACPI_COPY_TYPE_SIMPLE,\r\nthis_source_obj, state, context);\r\nif (ACPI_FAILURE(status)) {\r\nreturn_ACPI_STATUS(status);\r\n}\r\nstate->pkg.index++;\r\nwhile (state->pkg.index >=\r\nstate->pkg.source_object->package.count) {\r\nacpi_ut_delete_generic_state(state);\r\nstate = acpi_ut_pop_generic_state(&state_list);\r\nif (!state) {\r\nreturn_ACPI_STATUS(AE_OK);\r\n}\r\nstate->pkg.index++;\r\n}\r\n} else {\r\nstatus =\r\nwalk_callback(ACPI_COPY_TYPE_PACKAGE,\r\nthis_source_obj, state, context);\r\nif (ACPI_FAILURE(status)) {\r\nreturn_ACPI_STATUS(status);\r\n}\r\nacpi_ut_push_generic_state(&state_list, state);\r\nstate =\r\nacpi_ut_create_pkg_state(this_source_obj,\r\nstate->pkg.this_target_obj,\r\n0);\r\nif (!state) {\r\nwhile (state_list) {\r\nstate =\r\nacpi_ut_pop_generic_state\r\n(&state_list);\r\nacpi_ut_delete_generic_state(state);\r\n}\r\nreturn_ACPI_STATUS(AE_NO_MEMORY);\r\n}\r\n}\r\n}\r\nreturn_ACPI_STATUS(AE_AML_INTERNAL);\r\n}\r\nvoid\r\nacpi_ut_display_init_pathname(u8 type,\r\nstruct acpi_namespace_node *obj_handle,\r\nchar *path)\r\n{\r\nacpi_status status;\r\nstruct acpi_buffer buffer;\r\nACPI_FUNCTION_ENTRY();\r\nif (!(acpi_dbg_level & ACPI_LV_INIT_NAMES)) {\r\nreturn;\r\n}\r\nbuffer.length = ACPI_ALLOCATE_LOCAL_BUFFER;\r\nstatus = acpi_ns_handle_to_pathname(obj_handle, &buffer, TRUE);\r\nif (ACPI_FAILURE(status)) {\r\nreturn;\r\n}\r\nswitch (type) {\r\ncase ACPI_TYPE_METHOD:\r\nacpi_os_printf("Executing ");\r\nbreak;\r\ndefault:\r\nacpi_os_printf("Initializing ");\r\nbreak;\r\n}\r\nacpi_os_printf("%-12s %s",\r\nacpi_ut_get_type_name(type), (char *)buffer.pointer);\r\nif (path) {\r\nacpi_os_printf(".%s", path);\r\n}\r\nacpi_os_printf("\n");\r\nACPI_FREE(buffer.pointer);\r\n}
