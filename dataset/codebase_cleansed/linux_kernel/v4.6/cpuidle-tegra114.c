static int tegra114_idle_power_down(struct cpuidle_device *dev,\r\nstruct cpuidle_driver *drv,\r\nint index)\r\n{\r\nlocal_fiq_disable();\r\ntegra_set_cpu_in_lp2();\r\ncpu_pm_enter();\r\ncall_firmware_op(prepare_idle);\r\nif (call_firmware_op(do_idle, 0) == -ENOSYS)\r\ncpu_suspend(0, tegra30_sleep_cpu_secondary_finish);\r\ncpu_pm_exit();\r\ntegra_clear_cpu_in_lp2();\r\nlocal_fiq_enable();\r\nreturn index;\r\n}\r\nstatic void tegra114_idle_enter_freeze(struct cpuidle_device *dev,\r\nstruct cpuidle_driver *drv,\r\nint index)\r\n{\r\ntegra114_idle_power_down(dev, drv, index);\r\n}\r\nint __init tegra114_cpuidle_init(void)\r\n{\r\nif (!psci_smp_available())\r\nreturn cpuidle_register(&tegra_idle_driver, NULL);\r\nreturn 0;\r\n}
