static int\r\next4_xattr_security_get(const struct xattr_handler *handler,\r\nstruct dentry *dentry, const char *name,\r\nvoid *buffer, size_t size)\r\n{\r\nreturn ext4_xattr_get(d_inode(dentry), EXT4_XATTR_INDEX_SECURITY,\r\nname, buffer, size);\r\n}\r\nstatic int\r\next4_xattr_security_set(const struct xattr_handler *handler,\r\nstruct dentry *dentry, const char *name,\r\nconst void *value, size_t size, int flags)\r\n{\r\nreturn ext4_xattr_set(d_inode(dentry), EXT4_XATTR_INDEX_SECURITY,\r\nname, value, size, flags);\r\n}\r\nstatic int\r\next4_initxattrs(struct inode *inode, const struct xattr *xattr_array,\r\nvoid *fs_info)\r\n{\r\nconst struct xattr *xattr;\r\nhandle_t *handle = fs_info;\r\nint err = 0;\r\nfor (xattr = xattr_array; xattr->name != NULL; xattr++) {\r\nerr = ext4_xattr_set_handle(handle, inode,\r\nEXT4_XATTR_INDEX_SECURITY,\r\nxattr->name, xattr->value,\r\nxattr->value_len, 0);\r\nif (err < 0)\r\nbreak;\r\n}\r\nreturn err;\r\n}\r\nint\r\next4_init_security(handle_t *handle, struct inode *inode, struct inode *dir,\r\nconst struct qstr *qstr)\r\n{\r\nreturn security_inode_init_security(inode, dir, qstr,\r\n&ext4_initxattrs, handle);\r\n}
