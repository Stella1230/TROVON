int bpf_prog1(struct pt_regs *ctx)\r\n{\r\nchar devname[IFNAMSIZ] = {};\r\nstruct net_device *dev;\r\nstruct sk_buff *skb;\r\nint len;\r\nskb = (struct sk_buff *) PT_REGS_PARM1(ctx);\r\ndev = _(skb->dev);\r\nlen = _(skb->len);\r\nbpf_probe_read(devname, sizeof(devname), dev->name);\r\nif (devname[0] == 'l' && devname[1] == 'o') {\r\nchar fmt[] = "skb %p len %d\n";\r\nbpf_trace_printk(fmt, sizeof(fmt), skb, len);\r\n}\r\nreturn 0;\r\n}
