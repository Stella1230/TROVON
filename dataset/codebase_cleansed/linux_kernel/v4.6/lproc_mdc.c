static ssize_t max_rpcs_in_flight_show(struct kobject *kobj,\r\nstruct attribute *attr,\r\nchar *buf)\r\n{\r\nint len;\r\nstruct obd_device *dev = container_of(kobj, struct obd_device,\r\nobd_kobj);\r\nstruct client_obd *cli = &dev->u.cli;\r\nclient_obd_list_lock(&cli->cl_loi_list_lock);\r\nlen = sprintf(buf, "%u\n", cli->cl_max_rpcs_in_flight);\r\nclient_obd_list_unlock(&cli->cl_loi_list_lock);\r\nreturn len;\r\n}\r\nstatic ssize_t max_rpcs_in_flight_store(struct kobject *kobj,\r\nstruct attribute *attr,\r\nconst char *buffer,\r\nsize_t count)\r\n{\r\nstruct obd_device *dev = container_of(kobj, struct obd_device,\r\nobd_kobj);\r\nstruct client_obd *cli = &dev->u.cli;\r\nint rc;\r\nunsigned long val;\r\nrc = kstrtoul(buffer, 10, &val);\r\nif (rc)\r\nreturn rc;\r\nif (val < 1 || val > MDC_MAX_RIF_MAX)\r\nreturn -ERANGE;\r\nclient_obd_list_lock(&cli->cl_loi_list_lock);\r\ncli->cl_max_rpcs_in_flight = val;\r\nclient_obd_list_unlock(&cli->cl_loi_list_lock);\r\nreturn count;\r\n}\r\nstatic ssize_t max_pages_per_rpc_show(struct kobject *kobj,\r\nstruct attribute *attr,\r\nchar *buf)\r\n{\r\nstruct obd_device *dev = container_of(kobj, struct obd_device,\r\nobd_kobj);\r\nstruct client_obd *cli = &dev->u.cli;\r\nreturn sprintf(buf, "%d\n", cli->cl_max_pages_per_rpc);\r\n}\r\nvoid lprocfs_mdc_init_vars(struct lprocfs_static_vars *lvars)\r\n{\r\nlvars->sysfs_vars = &mdc_attr_group;\r\nlvars->obd_vars = lprocfs_mdc_obd_vars;\r\n}
