int __init netlbl_netlink_init(void)\r\n{\r\nint ret_val;\r\nret_val = netlbl_mgmt_genl_init();\r\nif (ret_val != 0)\r\nreturn ret_val;\r\nret_val = netlbl_cipsov4_genl_init();\r\nif (ret_val != 0)\r\nreturn ret_val;\r\nret_val = netlbl_unlabel_genl_init();\r\nif (ret_val != 0)\r\nreturn ret_val;\r\nreturn 0;\r\n}\r\nstruct audit_buffer *netlbl_audit_start_common(int type,\r\nstruct netlbl_audit *audit_info)\r\n{\r\nstruct audit_buffer *audit_buf;\r\nchar *secctx;\r\nu32 secctx_len;\r\nif (audit_enabled == 0)\r\nreturn NULL;\r\naudit_buf = audit_log_start(current->audit_context, GFP_ATOMIC, type);\r\nif (audit_buf == NULL)\r\nreturn NULL;\r\naudit_log_format(audit_buf, "netlabel: auid=%u ses=%u",\r\naudit_info->loginuid,\r\naudit_info->sessionid);\r\nif (audit_info->secid != 0 &&\r\nsecurity_secid_to_secctx(audit_info->secid,\r\n&secctx,\r\n&secctx_len) == 0) {\r\naudit_log_format(audit_buf, " subj=%s", secctx);\r\nsecurity_release_secctx(secctx, secctx_len);\r\n}\r\nreturn audit_buf;\r\n}
