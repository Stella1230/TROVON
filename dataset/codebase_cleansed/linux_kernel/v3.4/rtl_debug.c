static int proc_get_stats_ap(char *page, char **start,\r\noff_t offset, int count,\r\nint *eof, void *data)\r\n{\r\nstruct net_device *dev = data;\r\nstruct r8192_priv *priv = (struct r8192_priv *)rtllib_priv(dev);\r\nstruct rtllib_device *ieee = priv->rtllib;\r\nstruct rtllib_network *target;\r\nint len = 0;\r\nlist_for_each_entry(target, &ieee->network_list, list) {\r\nlen += snprintf(page + len, count - len,\r\n"%s ", target->ssid);\r\nif (target->wpa_ie_len > 0 || target->rsn_ie_len > 0)\r\nlen += snprintf(page + len, count - len,\r\n"WPA\n");\r\nelse\r\nlen += snprintf(page + len, count - len,\r\n"non_WPA\n");\r\n}\r\n*eof = 1;\r\nreturn len;\r\n}\r\nstatic int proc_get_registers_0(char *page, char **start,\r\noff_t offset, int count,\r\nint *eof, void *data)\r\n{\r\nstruct net_device *dev = data;\r\nint len = 0;\r\nint i, n, page0;\r\nint max = 0xff;\r\npage0 = 0x000;\r\nlen += snprintf(page + len, count - len,\r\n"\n####################page %x##################\n ",\r\n(page0>>8));\r\nlen += snprintf(page + len, count - len,\r\n"\nD: OF > 00 01 02 03 04 05 06 07 08 09 0A 0B "\r\n"0C 0D 0E 0F");\r\nfor (n = 0; n <= max;) {\r\nlen += snprintf(page + len, count - len, "\nD: %2x > ", n);\r\nfor (i = 0; i < 16 && n <= max; n++, i++)\r\nlen += snprintf(page + len, count - len,\r\n"%2.2x ", read_nic_byte(dev,\r\n(page0 | n)));\r\n}\r\nlen += snprintf(page + len, count - len, "\n");\r\n*eof = 1;\r\nreturn len;\r\n}\r\nstatic int proc_get_registers_1(char *page, char **start,\r\noff_t offset, int count,\r\nint *eof, void *data)\r\n{\r\nstruct net_device *dev = data;\r\nint len = 0;\r\nint i, n, page0;\r\nint max = 0xff;\r\npage0 = 0x100;\r\nlen += snprintf(page + len, count - len,\r\n"\n####################page %x##################\n ",\r\n(page0>>8));\r\nlen += snprintf(page + len, count - len,\r\n"\nD: OF > 00 01 02 03 04 05 06 07 08 09 0A 0B "\r\n"0C 0D 0E 0F");\r\nfor (n = 0; n <= max;) {\r\nlen += snprintf(page + len, count - len,\r\n"\nD: %2x > ", n);\r\nfor (i = 0; i < 16 && n <= max; i++, n++)\r\nlen += snprintf(page + len, count - len,\r\n"%2.2x ", read_nic_byte(dev,\r\n(page0 | n)));\r\n}\r\nlen += snprintf(page + len, count - len, "\n");\r\n*eof = 1;\r\nreturn len;\r\n}\r\nstatic int proc_get_registers_2(char *page, char **start,\r\noff_t offset, int count,\r\nint *eof, void *data)\r\n{\r\nstruct net_device *dev = data;\r\nint len = 0;\r\nint i, n, page0;\r\nint max = 0xff;\r\npage0 = 0x200;\r\nlen += snprintf(page + len, count - len,\r\n"\n####################page %x##################\n ",\r\n(page0 >> 8));\r\nlen += snprintf(page + len, count - len,\r\n"\nD: OF > 00 01 02 03 04 05 06 07 08 09 0A 0B 0C "\r\n"0D 0E 0F");\r\nfor (n = 0; n <= max;) {\r\nlen += snprintf(page + len, count - len,\r\n"\nD: %2x > ", n);\r\nfor (i = 0; i < 16 && n <= max; i++, n++)\r\nlen += snprintf(page + len, count - len,\r\n"%2.2x ", read_nic_byte(dev,\r\n(page0 | n)));\r\n}\r\nlen += snprintf(page + len, count - len, "\n");\r\n*eof = 1;\r\nreturn len;\r\n}\r\nstatic int proc_get_registers_3(char *page, char **start,\r\noff_t offset, int count,\r\nint *eof, void *data)\r\n{\r\nstruct net_device *dev = data;\r\nint len = 0;\r\nint i, n, page0;\r\nint max = 0xff;\r\npage0 = 0x300;\r\nlen += snprintf(page + len, count - len,\r\n"\n####################page %x##################\n ",\r\n(page0>>8));\r\nlen += snprintf(page + len, count - len,\r\n"\nD: OF > 00 01 02 03 04 05 06 07 08 09 0A 0B "\r\n"0C 0D 0E 0F");\r\nfor (n = 0; n <= max;) {\r\nlen += snprintf(page + len, count - len,\r\n"\nD: %2x > ", n);\r\nfor (i = 0; i < 16 && n <= max; i++, n++)\r\nlen += snprintf(page + len, count - len,\r\n"%2.2x ", read_nic_byte(dev,\r\n(page0 | n)));\r\n}\r\nlen += snprintf(page + len, count - len, "\n");\r\n*eof = 1;\r\nreturn len;\r\n}\r\nstatic int proc_get_registers_4(char *page, char **start,\r\noff_t offset, int count,\r\nint *eof, void *data)\r\n{\r\nstruct net_device *dev = data;\r\nint len = 0;\r\nint i, n, page0;\r\nint max = 0xff;\r\npage0 = 0x400;\r\nlen += snprintf(page + len, count - len,\r\n"\n####################page %x##################\n ",\r\n(page0>>8));\r\nlen += snprintf(page + len, count - len,\r\n"\nD: OF > 00 01 02 03 04 05 06 07 08 09 0A 0B "\r\n"0C 0D 0E 0F");\r\nfor (n = 0; n <= max;) {\r\nlen += snprintf(page + len, count - len,\r\n"\nD: %2x > ", n);\r\nfor (i = 0; i < 16 && n <= max; i++, n++)\r\nlen += snprintf(page + len, count - len,\r\n"%2.2x ", read_nic_byte(dev,\r\n(page0 | n)));\r\n}\r\nlen += snprintf(page + len, count - len, "\n");\r\n*eof = 1;\r\nreturn len;\r\n}\r\nstatic int proc_get_registers_5(char *page, char **start,\r\noff_t offset, int count,\r\nint *eof, void *data)\r\n{\r\nstruct net_device *dev = data;\r\nint len = 0;\r\nint i, n, page0;\r\nint max = 0xff;\r\npage0 = 0x500;\r\nlen += snprintf(page + len, count - len,\r\n"\n####################page %x##################\n ",\r\n(page0 >> 8));\r\nlen += snprintf(page + len, count - len,\r\n"\nD: OF > 00 01 02 03 04 05 06 07 08 09 0A 0B "\r\n"0C 0D 0E 0F");\r\nfor (n = 0; n <= max;) {\r\nlen += snprintf(page + len, count - len,\r\n"\nD: %2x > ", n);\r\nfor (i = 0; i < 16 && n <= max; i++, n++)\r\nlen += snprintf(page + len, count - len,\r\n"%2.2x ", read_nic_byte(dev,\r\n(page0 | n)));\r\n}\r\nlen += snprintf(page + len, count - len, "\n");\r\n*eof = 1;\r\nreturn len;\r\n}\r\nstatic int proc_get_registers_6(char *page, char **start,\r\noff_t offset, int count,\r\nint *eof, void *data)\r\n{\r\nstruct net_device *dev = data;\r\nint len = 0;\r\nint i, n, page0;\r\nint max = 0xff;\r\npage0 = 0x600;\r\nlen += snprintf(page + len, count - len,\r\n"\n####################page %x##################\n ",\r\n(page0>>8));\r\nlen += snprintf(page + len, count - len,\r\n"\nD: OF > 00 01 02 03 04 05 06 07 08 09 0A 0B "\r\n"0C 0D 0E 0F");\r\nfor (n = 0; n <= max;) {\r\nlen += snprintf(page + len, count - len,\r\n"\nD: %2x > ", n);\r\nfor (i = 0; i < 16 && n <= max; i++, n++)\r\nlen += snprintf(page + len, count - len,\r\n"%2.2x ", read_nic_byte(dev,\r\n(page0 | n)));\r\n}\r\nlen += snprintf(page + len, count - len, "\n");\r\n*eof = 1;\r\nreturn len;\r\n}\r\nstatic int proc_get_registers_7(char *page, char **start,\r\noff_t offset, int count,\r\nint *eof, void *data)\r\n{\r\nstruct net_device *dev = data;\r\nint len = 0;\r\nint i, n, page0;\r\nint max = 0xff;\r\npage0 = 0x700;\r\nlen += snprintf(page + len, count - len,\r\n"\n####################page %x##################\n ",\r\n(page0 >> 8));\r\nlen += snprintf(page + len, count - len,\r\n"\nD: OF > 00 01 02 03 04 05 06 07 08 09 0A 0B 0C "\r\n"0D 0E 0F");\r\nfor (n = 0; n <= max;) {\r\nlen += snprintf(page + len, count - len,\r\n"\nD: %2x > ", n);\r\nfor (i = 0; i < 16 && n <= max; i++, n++)\r\nlen += snprintf(page + len, count - len,\r\n"%2.2x ", read_nic_byte(dev,\r\n(page0 | n)));\r\n}\r\nlen += snprintf(page + len, count - len, "\n");\r\n*eof = 1;\r\nreturn len;\r\n}\r\nstatic int proc_get_registers_8(char *page, char **start,\r\noff_t offset, int count,\r\nint *eof, void *data)\r\n{\r\nstruct net_device *dev = data;\r\nint len = 0;\r\nint i, n, page0;\r\nint max = 0xff;\r\npage0 = 0x800;\r\nlen += snprintf(page + len, count - len,\r\n"\n####################page %x##################\n",\r\n(page0 >> 8));\r\nfor (n = 0; n <= max;) {\r\nlen += snprintf(page + len, count - len, "\nD: %2x > ", n);\r\nfor (i = 0; i < 4 && n <= max; n += 4, i++)\r\nlen += snprintf(page + len, count - len,\r\n"%8.8x ", rtl8192_QueryBBReg(dev,\r\n(page0 | n), bMaskDWord));\r\n}\r\nlen += snprintf(page + len, count - len, "\n");\r\n*eof = 1;\r\nreturn len;\r\n}\r\nstatic int proc_get_registers_9(char *page, char **start,\r\noff_t offset, int count,\r\nint *eof, void *data)\r\n{\r\nstruct net_device *dev = data;\r\nint len = 0;\r\nint i, n, page0;\r\nint max = 0xff;\r\npage0 = 0x900;\r\nlen += snprintf(page + len, count - len,\r\n"\n####################page %x##################\n",\r\n(page0>>8));\r\nfor (n = 0; n <= max;) {\r\nlen += snprintf(page + len, count - len, "\nD: %2x > ", n);\r\nfor (i = 0; i < 4 && n <= max; n += 4, i++)\r\nlen += snprintf(page + len, count - len,\r\n"%8.8x ", rtl8192_QueryBBReg(dev,\r\n(page0 | n), bMaskDWord));\r\n}\r\nlen += snprintf(page + len, count - len, "\n");\r\n*eof = 1;\r\nreturn len;\r\n}\r\nstatic int proc_get_registers_a(char *page, char **start,\r\noff_t offset, int count,\r\nint *eof, void *data)\r\n{\r\nstruct net_device *dev = data;\r\nint len = 0;\r\nint i, n, page0;\r\nint max = 0xff;\r\npage0 = 0xa00;\r\nlen += snprintf(page + len, count - len,\r\n"\n####################page %x##################\n",\r\n(page0>>8));\r\nfor (n = 0; n <= max;) {\r\nlen += snprintf(page + len, count - len, "\nD: %2x > ", n);\r\nfor (i = 0; i < 4 && n <= max; n += 4, i++)\r\nlen += snprintf(page + len, count - len,\r\n"%8.8x ", rtl8192_QueryBBReg(dev,\r\n(page0 | n), bMaskDWord));\r\n}\r\nlen += snprintf(page + len, count - len, "\n");\r\n*eof = 1;\r\nreturn len;\r\n}\r\nstatic int proc_get_registers_b(char *page, char **start,\r\noff_t offset, int count,\r\nint *eof, void *data)\r\n{\r\nstruct net_device *dev = data;\r\nint len = 0;\r\nint i, n, page0;\r\nint max = 0xff;\r\npage0 = 0xb00;\r\nlen += snprintf(page + len, count - len,\r\n"\n####################page %x##################\n",\r\n(page0 >> 8));\r\nfor (n = 0; n <= max;) {\r\nlen += snprintf(page + len, count - len, "\nD: %2x > ", n);\r\nfor (i = 0; i < 4 && n <= max; n += 4, i++)\r\nlen += snprintf(page + len, count - len,\r\n"%8.8x ", rtl8192_QueryBBReg(dev,\r\n(page0 | n), bMaskDWord));\r\n}\r\nlen += snprintf(page + len, count - len, "\n");\r\n*eof = 1;\r\nreturn len;\r\n}\r\nstatic int proc_get_registers_c(char *page, char **start,\r\noff_t offset, int count,\r\nint *eof, void *data)\r\n{\r\nstruct net_device *dev = data;\r\nint len = 0;\r\nint i, n, page0;\r\nint max = 0xff;\r\npage0 = 0xc00;\r\nlen += snprintf(page + len, count - len,\r\n"\n####################page %x##################\n",\r\n(page0>>8));\r\nfor (n = 0; n <= max;) {\r\nlen += snprintf(page + len, count - len, "\nD: %2x > ", n);\r\nfor (i = 0; i < 4 && n <= max; n += 4, i++)\r\nlen += snprintf(page + len, count - len,\r\n"%8.8x ", rtl8192_QueryBBReg(dev,\r\n(page0 | n), bMaskDWord));\r\n}\r\nlen += snprintf(page + len, count - len, "\n");\r\n*eof = 1;\r\nreturn len;\r\n}\r\nstatic int proc_get_registers_d(char *page, char **start,\r\noff_t offset, int count,\r\nint *eof, void *data)\r\n{\r\nstruct net_device *dev = data;\r\nint len = 0;\r\nint i, n, page0;\r\nint max = 0xff;\r\npage0 = 0xd00;\r\nlen += snprintf(page + len, count - len,\r\n"\n####################page %x##################\n",\r\n(page0>>8));\r\nfor (n = 0; n <= max;) {\r\nlen += snprintf(page + len, count - len, "\nD: %2x > ", n);\r\nfor (i = 0; i < 4 && n <= max; n += 4, i++)\r\nlen += snprintf(page + len, count - len,\r\n"%8.8x ", rtl8192_QueryBBReg(dev,\r\n(page0 | n), bMaskDWord));\r\n}\r\nlen += snprintf(page + len, count - len, "\n");\r\n*eof = 1;\r\nreturn len;\r\n}\r\nstatic int proc_get_registers_e(char *page, char **start,\r\noff_t offset, int count,\r\nint *eof, void *data)\r\n{\r\nstruct net_device *dev = data;\r\nint len = 0;\r\nint i, n, page0;\r\nint max = 0xff;\r\npage0 = 0xe00;\r\nlen += snprintf(page + len, count - len,\r\n"\n####################page %x##################\n",\r\n(page0>>8));\r\nfor (n = 0; n <= max;) {\r\nlen += snprintf(page + len, count - len, "\nD: %2x > ", n);\r\nfor (i = 0; i < 4 && n <= max; n += 4, i++)\r\nlen += snprintf(page + len, count - len,\r\n"%8.8x ", rtl8192_QueryBBReg(dev,\r\n(page0 | n), bMaskDWord));\r\n}\r\nlen += snprintf(page + len, count - len, "\n");\r\n*eof = 1;\r\nreturn len;\r\n}\r\nstatic int proc_get_reg_rf_a(char *page, char **start,\r\noff_t offset, int count,\r\nint *eof, void *data)\r\n{\r\nstruct net_device *dev = data;\r\nint len = 0;\r\nint i, n;\r\nint max = 0xff;\r\nlen += snprintf(page + len, count - len,\r\n"\n#################### RF-A ##################\n ");\r\nfor (n = 0; n <= max;) {\r\nlen += snprintf(page + len, count - len, "\nD: %2x > ", n);\r\nfor (i = 0; i < 4 && n <= max; n += 4, i++)\r\nlen += snprintf(page + len, count - len,\r\n"%8.8x ", rtl8192_phy_QueryRFReg(dev,\r\n(enum rf90_radio_path)RF90_PATH_A, n,\r\nbMaskDWord));\r\n}\r\nlen += snprintf(page + len, count - len, "\n");\r\n*eof = 1;\r\nreturn len;\r\n}\r\nstatic int proc_get_reg_rf_b(char *page, char **start,\r\noff_t offset, int count,\r\nint *eof, void *data)\r\n{\r\nstruct net_device *dev = data;\r\nint len = 0;\r\nint i, n;\r\nint max = 0xff;\r\nlen += snprintf(page + len, count - len,\r\n"\n#################### RF-B ##################\n ");\r\nfor (n = 0; n <= max;) {\r\nlen += snprintf(page + len, count - len, "\nD: %2x > ", n);\r\nfor (i = 0; i < 4 && n <= max; n += 4, i++)\r\nlen += snprintf(page + len, count - len,\r\n"%8.8x ", rtl8192_phy_QueryRFReg(dev,\r\n(enum rf90_radio_path)RF90_PATH_B, n,\r\nbMaskDWord));\r\n}\r\nlen += snprintf(page + len, count - len, "\n");\r\n*eof = 1;\r\nreturn len;\r\n}\r\nstatic int proc_get_reg_rf_c(char *page, char **start,\r\noff_t offset, int count,\r\nint *eof, void *data)\r\n{\r\nstruct net_device *dev = data;\r\nint len = 0;\r\nint i, n;\r\nint max = 0xff;\r\nlen += snprintf(page + len, count - len,\r\n"\n#################### RF-C ##################\n");\r\nfor (n = 0; n <= max;) {\r\nlen += snprintf(page + len, count - len, "\nD: %2x > ", n);\r\nfor (i = 0; i < 4 && n <= max; n += 4, i++)\r\nlen += snprintf(page + len, count - len,\r\n"%8.8x ", rtl8192_phy_QueryRFReg(dev,\r\n(enum rf90_radio_path)RF90_PATH_C, n,\r\nbMaskDWord));\r\n}\r\nlen += snprintf(page + len, count - len, "\n");\r\n*eof = 1;\r\nreturn len;\r\n}\r\nstatic int proc_get_reg_rf_d(char *page, char **start,\r\noff_t offset, int count,\r\nint *eof, void *data)\r\n{\r\nstruct net_device *dev = data;\r\nint len = 0;\r\nint i, n;\r\nint max = 0xff;\r\nlen += snprintf(page + len, count - len,\r\n"\n#################### RF-D ##################\n ");\r\nfor (n = 0; n <= max;) {\r\nlen += snprintf(page + len, count - len, "\nD: %2x > ", n);\r\nfor (i = 0; i < 4 && n <= max; n += 4, i++)\r\nlen += snprintf(page + len, count - len,\r\n"%8.8x ", rtl8192_phy_QueryRFReg(dev,\r\n(enum rf90_radio_path)RF90_PATH_D, n,\r\nbMaskDWord));\r\n}\r\nlen += snprintf(page + len, count - len, "\n");\r\n*eof = 1;\r\nreturn len;\r\n}\r\nstatic int proc_get_cam_register_1(char *page, char **start,\r\noff_t offset, int count,\r\nint *eof, void *data)\r\n{\r\nstruct net_device *dev = data;\r\nu32 target_command = 0;\r\nu32 target_content = 0;\r\nu8 entry_i = 0;\r\nu32 ulStatus;\r\nint len = 0;\r\nint i = 100, j = 0;\r\nlen += snprintf(page + len, count - len,\r\n"\n#################### SECURITY CAM (0-10) ######"\r\n"############\n ");\r\nfor (j = 0; j < 11; j++) {\r\nlen += snprintf(page + len, count - len, "\nD: %2x > ", j);\r\nfor (entry_i = 0; entry_i < CAM_CONTENT_COUNT; entry_i++) {\r\ntarget_command = entry_i+CAM_CONTENT_COUNT*j;\r\ntarget_command = target_command | BIT31;\r\nwhile ((i--) >= 0) {\r\nulStatus = read_nic_dword(dev, RWCAM);\r\nif (ulStatus & BIT31)\r\ncontinue;\r\nelse\r\nbreak;\r\n}\r\nwrite_nic_dword(dev, RWCAM, target_command);\r\ntarget_content = read_nic_dword(dev, RCAMO);\r\nlen += snprintf(page + len, count - len, "%8.8x ",\r\ntarget_content);\r\n}\r\n}\r\nlen += snprintf(page + len, count - len, "\n");\r\n*eof = 1;\r\nreturn len;\r\n}\r\nstatic int proc_get_cam_register_2(char *page, char **start,\r\noff_t offset, int count,\r\nint *eof, void *data)\r\n{\r\nstruct net_device *dev = data;\r\nu32 target_command = 0;\r\nu32 target_content = 0;\r\nu8 entry_i = 0;\r\nu32 ulStatus;\r\nint len = 0;\r\nint i = 100, j = 0;\r\nlen += snprintf(page + len, count - len,\r\n"\n#################### SECURITY CAM (11-21) "\r\n"##################\n ");\r\nfor (j = 11; j < 22; j++) {\r\nlen += snprintf(page + len, count - len, "\nD: %2x > ", j);\r\nfor (entry_i = 0; entry_i < CAM_CONTENT_COUNT; entry_i++) {\r\ntarget_command = entry_i + CAM_CONTENT_COUNT * j;\r\ntarget_command = target_command | BIT31;\r\nwhile ((i--) >= 0) {\r\nulStatus = read_nic_dword(dev, RWCAM);\r\nif (ulStatus & BIT31)\r\ncontinue;\r\nelse\r\nbreak;\r\n}\r\nwrite_nic_dword(dev, RWCAM, target_command);\r\ntarget_content = read_nic_dword(dev, RCAMO);\r\nlen += snprintf(page + len, count - len, "%8.8x ",\r\ntarget_content);\r\n}\r\n}\r\nlen += snprintf(page + len, count - len, "\n");\r\n*eof = 1;\r\nreturn len;\r\n}\r\nstatic int proc_get_cam_register_3(char *page, char **start,\r\noff_t offset, int count,\r\nint *eof, void *data)\r\n{\r\nstruct net_device *dev = data;\r\nu32 target_command = 0;\r\nu32 target_content = 0;\r\nu8 entry_i = 0;\r\nu32 ulStatus;\r\nint len = 0;\r\nint i = 100, j = 0;\r\nlen += snprintf(page + len, count - len,\r\n"\n#################### SECURITY CAM (22-31) ######"\r\n"############\n ");\r\nfor (j = 22; j < TOTAL_CAM_ENTRY; j++) {\r\nlen += snprintf(page + len, count - len, "\nD: %2x > ", j);\r\nfor (entry_i = 0; entry_i < CAM_CONTENT_COUNT; entry_i++) {\r\ntarget_command = entry_i + CAM_CONTENT_COUNT * j;\r\ntarget_command = target_command | BIT31;\r\nwhile ((i--) >= 0) {\r\nulStatus = read_nic_dword(dev, RWCAM);\r\nif (ulStatus & BIT31)\r\ncontinue;\r\nelse\r\nbreak;\r\n}\r\nwrite_nic_dword(dev, RWCAM, target_command);\r\ntarget_content = read_nic_dword(dev, RCAMO);\r\nlen += snprintf(page + len, count - len, "%8.8x ",\r\ntarget_content);\r\n}\r\n}\r\nlen += snprintf(page + len, count - len, "\n");\r\n*eof = 1;\r\nreturn len;\r\n}\r\nstatic int proc_get_stats_tx(char *page, char **start,\r\noff_t offset, int count,\r\nint *eof, void *data)\r\n{\r\nstruct net_device *dev = data;\r\nstruct r8192_priv *priv = (struct r8192_priv *)rtllib_priv(dev);\r\nint len = 0;\r\nlen += snprintf(page + len, count - len,\r\n"TX VI priority ok int: %lu\n"\r\n"TX VO priority ok int: %lu\n"\r\n"TX BE priority ok int: %lu\n"\r\n"TX BK priority ok int: %lu\n"\r\n"TX MANAGE priority ok int: %lu\n"\r\n"TX BEACON priority ok int: %lu\n"\r\n"TX BEACON priority error int: %lu\n"\r\n"TX CMDPKT priority ok int: %lu\n"\r\n"TX queue stopped?: %d\n"\r\n"TX fifo overflow: %lu\n"\r\n"TX total data packets %lu\n"\r\n"TX total data bytes :%lu\n",\r\npriv->stats.txviokint,\r\npriv->stats.txvookint,\r\npriv->stats.txbeokint,\r\npriv->stats.txbkokint,\r\npriv->stats.txmanageokint,\r\npriv->stats.txbeaconokint,\r\npriv->stats.txbeaconerr,\r\npriv->stats.txcmdpktokint,\r\nnetif_queue_stopped(dev),\r\npriv->stats.txoverflow,\r\npriv->rtllib->stats.tx_packets,\r\npriv->rtllib->stats.tx_bytes\r\n);\r\n*eof = 1;\r\nreturn len;\r\n}\r\nstatic int proc_get_stats_rx(char *page, char **start,\r\noff_t offset, int count,\r\nint *eof, void *data)\r\n{\r\nstruct net_device *dev = data;\r\nstruct r8192_priv *priv = (struct r8192_priv *)rtllib_priv(dev);\r\nint len = 0;\r\nlen += snprintf(page + len, count - len,\r\n"RX packets: %lu\n"\r\n"RX data crc err: %lu\n"\r\n"RX mgmt crc err: %lu\n"\r\n"RX desc err: %lu\n"\r\n"RX rx overflow error: %lu\n",\r\npriv->stats.rxint,\r\npriv->stats.rxdatacrcerr,\r\npriv->stats.rxmgmtcrcerr,\r\npriv->stats.rxrdu,\r\npriv->stats.rxoverflow);\r\n*eof = 1;\r\nreturn len;\r\n}\r\nvoid rtl8192_proc_module_init(void)\r\n{\r\nRT_TRACE(COMP_INIT, "Initializing proc filesystem");\r\nrtl8192_proc = create_proc_entry(DRV_NAME, S_IFDIR, init_net.proc_net);\r\n}\r\nvoid rtl8192_proc_module_remove(void)\r\n{\r\nremove_proc_entry(DRV_NAME, init_net.proc_net);\r\n}\r\nvoid rtl8192_proc_remove_one(struct net_device *dev)\r\n{\r\nstruct r8192_priv *priv = (struct r8192_priv *)rtllib_priv(dev);\r\nprintk(KERN_INFO "dev name %s\n", dev->name);\r\nif (priv->dir_dev) {\r\nremove_proc_entry("stats-tx", priv->dir_dev);\r\nremove_proc_entry("stats-rx", priv->dir_dev);\r\nremove_proc_entry("stats-ap", priv->dir_dev);\r\nremove_proc_entry("registers-0", priv->dir_dev);\r\nremove_proc_entry("registers-1", priv->dir_dev);\r\nremove_proc_entry("registers-2", priv->dir_dev);\r\nremove_proc_entry("registers-3", priv->dir_dev);\r\nremove_proc_entry("registers-4", priv->dir_dev);\r\nremove_proc_entry("registers-5", priv->dir_dev);\r\nremove_proc_entry("registers-6", priv->dir_dev);\r\nremove_proc_entry("registers-7", priv->dir_dev);\r\nremove_proc_entry("registers-8", priv->dir_dev);\r\nremove_proc_entry("registers-9", priv->dir_dev);\r\nremove_proc_entry("registers-a", priv->dir_dev);\r\nremove_proc_entry("registers-b", priv->dir_dev);\r\nremove_proc_entry("registers-c", priv->dir_dev);\r\nremove_proc_entry("registers-d", priv->dir_dev);\r\nremove_proc_entry("registers-e", priv->dir_dev);\r\nremove_proc_entry("RF-A", priv->dir_dev);\r\nremove_proc_entry("RF-B", priv->dir_dev);\r\nremove_proc_entry("RF-C", priv->dir_dev);\r\nremove_proc_entry("RF-D", priv->dir_dev);\r\nremove_proc_entry("SEC-CAM-1", priv->dir_dev);\r\nremove_proc_entry("SEC-CAM-2", priv->dir_dev);\r\nremove_proc_entry("SEC-CAM-3", priv->dir_dev);\r\nremove_proc_entry("wlan0", rtl8192_proc);\r\npriv->dir_dev = NULL;\r\n}\r\n}\r\nvoid rtl8192_proc_init_one(struct net_device *dev)\r\n{\r\nstruct proc_dir_entry *e;\r\nstruct r8192_priv *priv = (struct r8192_priv *)rtllib_priv(dev);\r\npriv->dir_dev = create_proc_entry(dev->name,\r\nS_IFDIR | S_IRUGO | S_IXUGO,\r\nrtl8192_proc);\r\nif (!priv->dir_dev) {\r\nRT_TRACE(COMP_ERR, "Unable to initialize /proc/net/rtl8192"\r\n"/%s\n", dev->name);\r\nreturn;\r\n}\r\ne = create_proc_read_entry("stats-rx", S_IFREG | S_IRUGO,\r\npriv->dir_dev, proc_get_stats_rx, dev);\r\nif (!e)\r\nRT_TRACE(COMP_ERR, "Unable to initialize "\r\n"/proc/net/rtl8192/%s/stats-rx\n",\r\ndev->name);\r\ne = create_proc_read_entry("stats-tx", S_IFREG | S_IRUGO,\r\npriv->dir_dev, proc_get_stats_tx, dev);\r\nif (!e)\r\nRT_TRACE(COMP_ERR, "Unable to initialize "\r\n"/proc/net/rtl8192/%s/stats-tx\n",\r\ndev->name);\r\ne = create_proc_read_entry("stats-ap", S_IFREG | S_IRUGO,\r\npriv->dir_dev, proc_get_stats_ap, dev);\r\nif (!e)\r\nRT_TRACE(COMP_ERR, "Unable to initialize "\r\n"/proc/net/rtl8192/%s/stats-ap\n",\r\ndev->name);\r\ne = create_proc_read_entry("registers-0", S_IFREG | S_IRUGO,\r\npriv->dir_dev, proc_get_registers_0, dev);\r\nif (!e)\r\nRT_TRACE(COMP_ERR, "Unable to initialize "\r\n"/proc/net/rtl8192/%s/registers-0\n",\r\ndev->name);\r\ne = create_proc_read_entry("registers-1", S_IFREG | S_IRUGO,\r\npriv->dir_dev, proc_get_registers_1, dev);\r\nif (!e)\r\nRT_TRACE(COMP_ERR, "Unable to initialize "\r\n"/proc/net/rtl8192/%s/registers-1\n",\r\ndev->name);\r\ne = create_proc_read_entry("registers-2", S_IFREG | S_IRUGO,\r\npriv->dir_dev, proc_get_registers_2, dev);\r\nif (!e)\r\nRT_TRACE(COMP_ERR, "Unable to initialize "\r\n"/proc/net/rtl8192/%s/registers-2\n",\r\ndev->name);\r\ne = create_proc_read_entry("registers-3", S_IFREG | S_IRUGO,\r\npriv->dir_dev, proc_get_registers_3, dev);\r\nif (!e)\r\nRT_TRACE(COMP_ERR, "Unable to initialize "\r\n"/proc/net/rtl8192/%s/registers-3\n",\r\ndev->name);\r\ne = create_proc_read_entry("registers-4", S_IFREG | S_IRUGO,\r\npriv->dir_dev, proc_get_registers_4, dev);\r\nif (!e)\r\nRT_TRACE(COMP_ERR, "Unable to initialize "\r\n"/proc/net/rtl8192/%s/registers-4\n",\r\ndev->name);\r\ne = create_proc_read_entry("registers-5", S_IFREG | S_IRUGO,\r\npriv->dir_dev, proc_get_registers_5, dev);\r\nif (!e)\r\nRT_TRACE(COMP_ERR, "Unable to initialize "\r\n"/proc/net/rtl8192/%s/registers-5\n",\r\ndev->name);\r\ne = create_proc_read_entry("registers-6", S_IFREG | S_IRUGO,\r\npriv->dir_dev, proc_get_registers_6, dev);\r\nif (!e)\r\nRT_TRACE(COMP_ERR, "Unable to initialize "\r\n"/proc/net/rtl8192/%s/registers-6\n",\r\ndev->name);\r\ne = create_proc_read_entry("registers-7", S_IFREG | S_IRUGO,\r\npriv->dir_dev, proc_get_registers_7, dev);\r\nif (!e)\r\nRT_TRACE(COMP_ERR, "Unable to initialize "\r\n"/proc/net/rtl8192/%s/registers-7\n",\r\ndev->name);\r\ne = create_proc_read_entry("registers-8", S_IFREG | S_IRUGO,\r\npriv->dir_dev, proc_get_registers_8, dev);\r\nif (!e)\r\nRT_TRACE(COMP_ERR, "Unable to initialize "\r\n"/proc/net/rtl8192/%s/registers-8\n",\r\ndev->name);\r\ne = create_proc_read_entry("registers-9", S_IFREG | S_IRUGO,\r\npriv->dir_dev, proc_get_registers_9, dev);\r\nif (!e)\r\nRT_TRACE(COMP_ERR, "Unable to initialize "\r\n"/proc/net/rtl8192/%s/registers-9\n",\r\ndev->name);\r\ne = create_proc_read_entry("registers-a", S_IFREG | S_IRUGO,\r\npriv->dir_dev, proc_get_registers_a, dev);\r\nif (!e)\r\nRT_TRACE(COMP_ERR, "Unable to initialize "\r\n"/proc/net/rtl8192/%s/registers-a\n",\r\ndev->name);\r\ne = create_proc_read_entry("registers-b", S_IFREG | S_IRUGO,\r\npriv->dir_dev, proc_get_registers_b, dev);\r\nif (!e)\r\nRT_TRACE(COMP_ERR, "Unable to initialize "\r\n"/proc/net/rtl8192/%s/registers-b\n",\r\ndev->name);\r\ne = create_proc_read_entry("registers-c", S_IFREG | S_IRUGO,\r\npriv->dir_dev, proc_get_registers_c, dev);\r\nif (!e)\r\nRT_TRACE(COMP_ERR, "Unable to initialize "\r\n"/proc/net/rtl8192/%s/registers-c\n",\r\ndev->name);\r\ne = create_proc_read_entry("registers-d", S_IFREG | S_IRUGO,\r\npriv->dir_dev, proc_get_registers_d, dev);\r\nif (!e)\r\nRT_TRACE(COMP_ERR, "Unable to initialize "\r\n"/proc/net/rtl8192/%s/registers-d\n",\r\ndev->name);\r\ne = create_proc_read_entry("registers-e", S_IFREG | S_IRUGO,\r\npriv->dir_dev, proc_get_registers_e, dev);\r\nif (!e)\r\nRT_TRACE(COMP_ERR, "Unable to initialize "\r\n"/proc/net/rtl8192/%s/registers-e\n",\r\ndev->name);\r\ne = create_proc_read_entry("RF-A", S_IFREG | S_IRUGO,\r\npriv->dir_dev, proc_get_reg_rf_a, dev);\r\nif (!e)\r\nRT_TRACE(COMP_ERR, "Unable to initialize "\r\n"/proc/net/rtl8192/%s/RF-A\n",\r\ndev->name);\r\ne = create_proc_read_entry("RF-B", S_IFREG | S_IRUGO,\r\npriv->dir_dev, proc_get_reg_rf_b, dev);\r\nif (!e)\r\nRT_TRACE(COMP_ERR, "Unable to initialize "\r\n"/proc/net/rtl8192/%s/RF-B\n",\r\ndev->name);\r\ne = create_proc_read_entry("RF-C", S_IFREG | S_IRUGO,\r\npriv->dir_dev, proc_get_reg_rf_c, dev);\r\nif (!e)\r\nRT_TRACE(COMP_ERR, "Unable to initialize "\r\n"/proc/net/rtl8192/%s/RF-C\n",\r\ndev->name);\r\ne = create_proc_read_entry("RF-D", S_IFREG | S_IRUGO,\r\npriv->dir_dev, proc_get_reg_rf_d, dev);\r\nif (!e)\r\nRT_TRACE(COMP_ERR, "Unable to initialize "\r\n"/proc/net/rtl8192/%s/RF-D\n",\r\ndev->name);\r\ne = create_proc_read_entry("SEC-CAM-1", S_IFREG | S_IRUGO,\r\npriv->dir_dev, proc_get_cam_register_1, dev);\r\nif (!e)\r\nRT_TRACE(COMP_ERR, "Unable to initialize "\r\n"/proc/net/rtl8192/%s/SEC-CAM-1\n",\r\ndev->name);\r\ne = create_proc_read_entry("SEC-CAM-2", S_IFREG | S_IRUGO,\r\npriv->dir_dev, proc_get_cam_register_2, dev);\r\nif (!e)\r\nRT_TRACE(COMP_ERR, "Unable to initialize "\r\n"/proc/net/rtl8192/%s/SEC-CAM-2\n",\r\ndev->name);\r\ne = create_proc_read_entry("SEC-CAM-3", S_IFREG | S_IRUGO,\r\npriv->dir_dev, proc_get_cam_register_3, dev);\r\nif (!e)\r\nRT_TRACE(COMP_ERR, "Unable to initialize "\r\n"/proc/net/rtl8192/%s/SEC-CAM-3\n",\r\ndev->name);\r\n}
