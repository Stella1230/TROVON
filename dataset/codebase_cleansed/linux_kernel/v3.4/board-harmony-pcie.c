static int __init harmony_pcie_init(void)\r\n{\r\nstruct regulator *regulator = NULL;\r\nint err;\r\nif (!machine_is_harmony())\r\nreturn 0;\r\nerr = gpio_request(TEGRA_GPIO_EN_VDD_1V05_GPIO, "EN_VDD_1V05");\r\nif (err)\r\nreturn err;\r\ngpio_direction_output(TEGRA_GPIO_EN_VDD_1V05_GPIO, 1);\r\nregulator = regulator_get(NULL, "pex_clk");\r\nif (IS_ERR_OR_NULL(regulator))\r\ngoto err_reg;\r\nregulator_enable(regulator);\r\nerr = tegra_pcie_init(true, true);\r\nif (err)\r\ngoto err_pcie;\r\nreturn 0;\r\nerr_pcie:\r\nregulator_disable(regulator);\r\nregulator_put(regulator);\r\nerr_reg:\r\ngpio_free(TEGRA_GPIO_EN_VDD_1V05_GPIO);\r\nreturn err;\r\n}
