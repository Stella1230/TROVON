int ocpi_enable(void)\r\n{\r\nunsigned int val;\r\nif (!cpu_is_omap16xx())\r\nreturn -ENODEV;\r\nval = omap_readl(OCPI_PROT);\r\nval &= ~0xff;\r\nomap_writel(val, OCPI_PROT);\r\nval = omap_readl(OCPI_SEC);\r\nval &= ~0xff;\r\nomap_writel(val, OCPI_SEC);\r\nreturn 0;\r\n}\r\nstatic int __init omap_ocpi_init(void)\r\n{\r\nif (!cpu_is_omap16xx())\r\nreturn -ENODEV;\r\nocpi_ck = clk_get(NULL, "l3_ocpi_ck");\r\nif (IS_ERR(ocpi_ck))\r\nreturn PTR_ERR(ocpi_ck);\r\nclk_enable(ocpi_ck);\r\nocpi_enable();\r\nprintk("OMAP OCPI interconnect driver loaded\n");\r\nreturn 0;\r\n}\r\nstatic void __exit omap_ocpi_exit(void)\r\n{\r\nif (!cpu_is_omap16xx())\r\nreturn;\r\nclk_disable(ocpi_ck);\r\nclk_put(ocpi_ck);\r\n}
