static int adis16203_data_rdy_trigger_set_state(struct iio_trigger *trig,\r\nbool state)\r\n{\r\nstruct iio_dev *indio_dev = trig->private_data;\r\ndev_dbg(&indio_dev->dev, "%s (%d)\n", __func__, state);\r\nreturn adis16203_set_irq(indio_dev, state);\r\n}\r\nint adis16203_probe_trigger(struct iio_dev *indio_dev)\r\n{\r\nint ret;\r\nstruct adis16203_state *st = iio_priv(indio_dev);\r\nst->trig = iio_allocate_trigger("adis16203-dev%d", indio_dev->id);\r\nif (st->trig == NULL) {\r\nret = -ENOMEM;\r\ngoto error_ret;\r\n}\r\nret = request_irq(st->us->irq,\r\n&iio_trigger_generic_data_rdy_poll,\r\nIRQF_TRIGGER_RISING,\r\n"adis16203",\r\nst->trig);\r\nif (ret)\r\ngoto error_free_trig;\r\nst->trig->dev.parent = &st->us->dev;\r\nst->trig->ops = &adis16203_trigger_ops;\r\nst->trig->private_data = indio_dev;\r\nret = iio_trigger_register(st->trig);\r\nindio_dev->trig = st->trig;\r\nif (ret)\r\ngoto error_free_irq;\r\nreturn 0;\r\nerror_free_irq:\r\nfree_irq(st->us->irq, st->trig);\r\nerror_free_trig:\r\niio_free_trigger(st->trig);\r\nerror_ret:\r\nreturn ret;\r\n}\r\nvoid adis16203_remove_trigger(struct iio_dev *indio_dev)\r\n{\r\nstruct adis16203_state *st = iio_priv(indio_dev);\r\niio_trigger_unregister(st->trig);\r\nfree_irq(st->us->irq, st->trig);\r\niio_free_trigger(st->trig);\r\n}
