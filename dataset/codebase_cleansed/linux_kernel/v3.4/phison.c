static int phison_pre_reset(struct ata_link *link, unsigned long deadline)\r\n{\r\nint ret;\r\nstruct ata_port *ap = link->ap;\r\nap->cbl = ATA_CBL_NONE;\r\nret = ata_std_prereset(link, deadline);\r\ndev_dbg(ap->dev, "phison_pre_reset(), ret = %x\n", ret);\r\nreturn ret;\r\n}\r\nstatic int phison_init_one(struct pci_dev *pdev, const struct pci_device_id *id)\r\n{\r\nint ret;\r\nstruct ata_port_info info = {\r\n.flags = ATA_FLAG_NO_ATAPI,\r\n.pio_mask = 0x1f,\r\n.mwdma_mask = 0x07,\r\n.udma_mask = ATA_UDMA5,\r\n.port_ops = &phison_ops,\r\n};\r\nconst struct ata_port_info *ppi[] = { &info, NULL };\r\nret = ata_pci_bmdma_init_one(pdev, ppi, &phison_sht, NULL, 0);\r\ndev_dbg(&pdev->dev, "phison_init_one(), ret = %x\n", ret);\r\nreturn ret;\r\n}\r\nstatic int __init phison_ide_init(void)\r\n{\r\nreturn pci_register_driver(&phison_pci_driver);\r\n}\r\nstatic void __exit phison_ide_exit(void)\r\n{\r\npci_unregister_driver(&phison_pci_driver);\r\n}
