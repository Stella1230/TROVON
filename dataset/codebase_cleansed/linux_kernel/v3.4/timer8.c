static irqreturn_t timer_interrupt(int irq, void *dev_id)\r\n{\r\nh8300_timer_tick();\r\nctrl_bclr(CMFA, _8BASE + _8TCSR);\r\nreturn IRQ_HANDLED;\r\n}\r\nvoid __init h8300_timer_setup(void)\r\n{\r\nunsigned int div;\r\nunsigned int cnt;\r\ncalc_param(cnt, div, divide_rate, 0x10000);\r\ndiv++;\r\nsetup_irq(_8IRQ, &timer8_irq);\r\n#if defined(CONFIG_CPU_H8S)\r\nctrl_bclr(0, MSTPCRL)\r\n#endif\r\nctrl_outw(cnt, _8BASE + TCORA);\r\nctrl_outw(0x0000, _8BASE + _8TCSR);\r\nctrl_outw((CMIEA|CCLR_CMA|CKS2) << 8 | div,\r\n_8BASE + _8TCR);\r\n}
