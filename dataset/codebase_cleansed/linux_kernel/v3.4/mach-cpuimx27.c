static int eukrea_cpuimx27_otg_init(struct platform_device *pdev)\r\n{\r\nreturn mx27_initialize_usb_hw(pdev->id, MXC_EHCI_INTERFACE_DIFF_UNI);\r\n}\r\nstatic int eukrea_cpuimx27_usbh2_init(struct platform_device *pdev)\r\n{\r\nreturn mx27_initialize_usb_hw(pdev->id, MXC_EHCI_INTERFACE_DIFF_UNI);\r\n}\r\nstatic int __init eukrea_cpuimx27_otg_mode(char *options)\r\n{\r\nif (!strcmp(options, "host"))\r\notg_mode_host = 1;\r\nelse if (!strcmp(options, "device"))\r\notg_mode_host = 0;\r\nelse\r\npr_info("otg_mode neither \"host\" nor \"device\". "\r\n"Defaulting to device\n");\r\nreturn 0;\r\n}\r\nstatic void __init eukrea_cpuimx27_init(void)\r\n{\r\nimx27_soc_init();\r\nmxc_gpio_setup_multiple_pins(eukrea_cpuimx27_pins,\r\nARRAY_SIZE(eukrea_cpuimx27_pins), "CPUIMX27");\r\nimx27_add_imx_uart0(&uart_pdata);\r\nimx27_add_mxc_nand(&cpuimx27_nand_board_info);\r\ni2c_register_board_info(0, eukrea_cpuimx27_i2c_devices,\r\nARRAY_SIZE(eukrea_cpuimx27_i2c_devices));\r\nimx27_add_imx_i2c(0, &cpuimx27_i2c1_data);\r\nimx27_add_fec(NULL);\r\nplatform_add_devices(platform_devices, ARRAY_SIZE(platform_devices));\r\nimx27_add_imx2_wdt(NULL);\r\nimx27_add_mxc_w1(NULL);\r\n#if defined(CONFIG_MACH_EUKREA_CPUIMX27_USESDHC2)\r\nimx27_add_mxc_mmc(1, NULL);\r\n#endif\r\n#if defined(MACH_EUKREA_CPUIMX27_USEUART4)\r\nimx27_add_imx_uart3(&uart_pdata);\r\n#endif\r\n#if defined(CONFIG_SERIAL_8250) || defined(CONFIG_SERIAL_8250_MODULE)\r\nplatform_device_register(&serial_device);\r\n#endif\r\nif (otg_mode_host) {\r\notg_pdata.otg = imx_otg_ulpi_create(ULPI_OTG_DRVVBUS |\r\nULPI_OTG_DRVVBUS_EXT);\r\nif (otg_pdata.otg)\r\nimx27_add_mxc_ehci_otg(&otg_pdata);\r\n} else {\r\nimx27_add_fsl_usb2_udc(&otg_device_pdata);\r\n}\r\nusbh2_pdata.otg = imx_otg_ulpi_create(ULPI_OTG_DRVVBUS |\r\nULPI_OTG_DRVVBUS_EXT);\r\nif (usbh2_pdata.otg)\r\nimx27_add_mxc_ehci_hs(2, &usbh2_pdata);\r\n#ifdef CONFIG_MACH_EUKREA_MBIMX27_BASEBOARD\r\neukrea_mbimx27_baseboard_init();\r\n#endif\r\n}\r\nstatic void __init eukrea_cpuimx27_timer_init(void)\r\n{\r\nmx27_clocks_init(26000000);\r\n}
