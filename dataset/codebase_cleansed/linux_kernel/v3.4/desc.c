static int\r\nath5k_hw_setup_2word_tx_desc(struct ath5k_hw *ah,\r\nstruct ath5k_desc *desc,\r\nunsigned int pkt_len, unsigned int hdr_len,\r\nint padsize,\r\nenum ath5k_pkt_type type,\r\nunsigned int tx_power,\r\nunsigned int tx_rate0, unsigned int tx_tries0,\r\nunsigned int key_index,\r\nunsigned int antenna_mode,\r\nunsigned int flags,\r\nunsigned int rtscts_rate, unsigned int rtscts_duration)\r\n{\r\nu32 frame_type;\r\nstruct ath5k_hw_2w_tx_ctl *tx_ctl;\r\nunsigned int frame_len;\r\ntx_ctl = &desc->ud.ds_tx5210.tx_ctl;\r\nif (unlikely(tx_tries0 == 0)) {\r\nATH5K_ERR(ah, "zero retries\n");\r\nWARN_ON(1);\r\nreturn -EINVAL;\r\n}\r\nif (unlikely(tx_rate0 == 0)) {\r\nATH5K_ERR(ah, "zero rate\n");\r\nWARN_ON(1);\r\nreturn -EINVAL;\r\n}\r\nmemset(&desc->ud.ds_tx5210, 0, sizeof(struct ath5k_hw_5210_tx_desc));\r\nframe_len = pkt_len - padsize + FCS_LEN;\r\nif (frame_len & ~AR5K_2W_TX_DESC_CTL0_FRAME_LEN)\r\nreturn -EINVAL;\r\ntx_ctl->tx_control_0 = frame_len & AR5K_2W_TX_DESC_CTL0_FRAME_LEN;\r\nif (type == AR5K_PKT_TYPE_BEACON)\r\npkt_len = roundup(pkt_len, 4);\r\nif (pkt_len & ~AR5K_2W_TX_DESC_CTL1_BUF_LEN)\r\nreturn -EINVAL;\r\ntx_ctl->tx_control_1 = pkt_len & AR5K_2W_TX_DESC_CTL1_BUF_LEN;\r\nif (ah->ah_version == AR5K_AR5210) {\r\nif (hdr_len & ~AR5K_2W_TX_DESC_CTL0_HEADER_LEN_5210)\r\nreturn -EINVAL;\r\ntx_ctl->tx_control_0 |=\r\nAR5K_REG_SM(hdr_len, AR5K_2W_TX_DESC_CTL0_HEADER_LEN_5210);\r\n}\r\nif (ah->ah_version == AR5K_AR5210) {\r\nswitch (type) {\r\ncase AR5K_PKT_TYPE_BEACON:\r\ncase AR5K_PKT_TYPE_PROBE_RESP:\r\nframe_type = AR5K_AR5210_TX_DESC_FRAME_TYPE_NO_DELAY;\r\nbreak;\r\ncase AR5K_PKT_TYPE_PIFS:\r\nframe_type = AR5K_AR5210_TX_DESC_FRAME_TYPE_PIFS;\r\nbreak;\r\ndefault:\r\nframe_type = type;\r\nbreak;\r\n}\r\ntx_ctl->tx_control_0 |=\r\nAR5K_REG_SM(frame_type, AR5K_2W_TX_DESC_CTL0_FRAME_TYPE_5210) |\r\nAR5K_REG_SM(tx_rate0, AR5K_2W_TX_DESC_CTL0_XMIT_RATE);\r\n} else {\r\ntx_ctl->tx_control_0 |=\r\nAR5K_REG_SM(tx_rate0, AR5K_2W_TX_DESC_CTL0_XMIT_RATE) |\r\nAR5K_REG_SM(antenna_mode,\r\nAR5K_2W_TX_DESC_CTL0_ANT_MODE_XMIT);\r\ntx_ctl->tx_control_1 |=\r\nAR5K_REG_SM(type, AR5K_2W_TX_DESC_CTL1_FRAME_TYPE_5211);\r\n}\r\n#define _TX_FLAGS(_c, _flag) \\r\nif (flags & AR5K_TXDESC_##_flag) { \\r\ntx_ctl->tx_control_##_c |= \\r\nAR5K_2W_TX_DESC_CTL##_c##_##_flag; \\r\n}\r\n#define _TX_FLAGS_5211(_c, _flag) \\r\nif (flags & AR5K_TXDESC_##_flag) { \\r\ntx_ctl->tx_control_##_c |= \\r\nAR5K_2W_TX_DESC_CTL##_c##_##_flag##_5211; \\r\n}\r\n_TX_FLAGS(0, CLRDMASK);\r\n_TX_FLAGS(0, INTREQ);\r\n_TX_FLAGS(0, RTSENA);\r\nif (ah->ah_version == AR5K_AR5211) {\r\n_TX_FLAGS_5211(0, VEOL);\r\n_TX_FLAGS_5211(1, NOACK);\r\n}\r\n#undef _TX_FLAGS\r\n#undef _TX_FLAGS_5211\r\nif (key_index != AR5K_TXKEYIX_INVALID) {\r\ntx_ctl->tx_control_0 |=\r\nAR5K_2W_TX_DESC_CTL0_ENCRYPT_KEY_VALID;\r\ntx_ctl->tx_control_1 |=\r\nAR5K_REG_SM(key_index,\r\nAR5K_2W_TX_DESC_CTL1_ENC_KEY_IDX);\r\n}\r\nif ((ah->ah_version == AR5K_AR5210) &&\r\n(flags & (AR5K_TXDESC_RTSENA | AR5K_TXDESC_CTSENA)))\r\ntx_ctl->tx_control_1 |= rtscts_duration &\r\nAR5K_2W_TX_DESC_CTL1_RTS_DURATION_5210;\r\nreturn 0;\r\n}\r\nstatic int\r\nath5k_hw_setup_4word_tx_desc(struct ath5k_hw *ah,\r\nstruct ath5k_desc *desc,\r\nunsigned int pkt_len, unsigned int hdr_len,\r\nint padsize,\r\nenum ath5k_pkt_type type,\r\nunsigned int tx_power,\r\nunsigned int tx_rate0, unsigned int tx_tries0,\r\nunsigned int key_index,\r\nunsigned int antenna_mode,\r\nunsigned int flags,\r\nunsigned int rtscts_rate, unsigned int rtscts_duration)\r\n{\r\nstruct ath5k_hw_4w_tx_ctl *tx_ctl;\r\nunsigned int frame_len;\r\nu32 txctl0 = 0, txctl1 = 0, txctl2 = 0, txctl3 = 0;\r\ntx_ctl = &desc->ud.ds_tx5212.tx_ctl;\r\nif (unlikely(tx_tries0 == 0)) {\r\nATH5K_ERR(ah, "zero retries\n");\r\nWARN_ON(1);\r\nreturn -EINVAL;\r\n}\r\nif (unlikely(tx_rate0 == 0)) {\r\nATH5K_ERR(ah, "zero rate\n");\r\nWARN_ON(1);\r\nreturn -EINVAL;\r\n}\r\ntx_power += ah->ah_txpower.txp_offset;\r\nif (tx_power > AR5K_TUNE_MAX_TXPOWER)\r\ntx_power = AR5K_TUNE_MAX_TXPOWER;\r\nmemset(&desc->ud.ds_tx5212.tx_stat, 0,\r\nsizeof(desc->ud.ds_tx5212.tx_stat));\r\nframe_len = pkt_len - padsize + FCS_LEN;\r\nif (frame_len & ~AR5K_4W_TX_DESC_CTL0_FRAME_LEN)\r\nreturn -EINVAL;\r\ntxctl0 = frame_len & AR5K_4W_TX_DESC_CTL0_FRAME_LEN;\r\nif (type == AR5K_PKT_TYPE_BEACON)\r\npkt_len = roundup(pkt_len, 4);\r\nif (pkt_len & ~AR5K_4W_TX_DESC_CTL1_BUF_LEN)\r\nreturn -EINVAL;\r\ntxctl1 = pkt_len & AR5K_4W_TX_DESC_CTL1_BUF_LEN;\r\ntxctl0 |= AR5K_REG_SM(tx_power, AR5K_4W_TX_DESC_CTL0_XMIT_POWER) |\r\nAR5K_REG_SM(antenna_mode, AR5K_4W_TX_DESC_CTL0_ANT_MODE_XMIT);\r\ntxctl1 |= AR5K_REG_SM(type, AR5K_4W_TX_DESC_CTL1_FRAME_TYPE);\r\ntxctl2 = AR5K_REG_SM(tx_tries0, AR5K_4W_TX_DESC_CTL2_XMIT_TRIES0);\r\ntxctl3 = tx_rate0 & AR5K_4W_TX_DESC_CTL3_XMIT_RATE0;\r\n#define _TX_FLAGS(_c, _flag) \\r\nif (flags & AR5K_TXDESC_##_flag) { \\r\ntxctl##_c |= AR5K_4W_TX_DESC_CTL##_c##_##_flag; \\r\n}\r\n_TX_FLAGS(0, CLRDMASK);\r\n_TX_FLAGS(0, VEOL);\r\n_TX_FLAGS(0, INTREQ);\r\n_TX_FLAGS(0, RTSENA);\r\n_TX_FLAGS(0, CTSENA);\r\n_TX_FLAGS(1, NOACK);\r\n#undef _TX_FLAGS\r\nif (key_index != AR5K_TXKEYIX_INVALID) {\r\ntxctl0 |= AR5K_4W_TX_DESC_CTL0_ENCRYPT_KEY_VALID;\r\ntxctl1 |= AR5K_REG_SM(key_index,\r\nAR5K_4W_TX_DESC_CTL1_ENCRYPT_KEY_IDX);\r\n}\r\nif (flags & (AR5K_TXDESC_RTSENA | AR5K_TXDESC_CTSENA)) {\r\nif ((flags & AR5K_TXDESC_RTSENA) &&\r\n(flags & AR5K_TXDESC_CTSENA))\r\nreturn -EINVAL;\r\ntxctl2 |= rtscts_duration & AR5K_4W_TX_DESC_CTL2_RTS_DURATION;\r\ntxctl3 |= AR5K_REG_SM(rtscts_rate,\r\nAR5K_4W_TX_DESC_CTL3_RTS_CTS_RATE);\r\n}\r\ntx_ctl->tx_control_0 = txctl0;\r\ntx_ctl->tx_control_1 = txctl1;\r\ntx_ctl->tx_control_2 = txctl2;\r\ntx_ctl->tx_control_3 = txctl3;\r\nreturn 0;\r\n}\r\nint\r\nath5k_hw_setup_mrr_tx_desc(struct ath5k_hw *ah,\r\nstruct ath5k_desc *desc,\r\nu_int tx_rate1, u_int tx_tries1,\r\nu_int tx_rate2, u_int tx_tries2,\r\nu_int tx_rate3, u_int tx_tries3)\r\n{\r\nstruct ath5k_hw_4w_tx_ctl *tx_ctl;\r\nif (ah->ah_version < AR5K_AR5212)\r\nreturn 0;\r\nif (unlikely((tx_rate1 == 0 && tx_tries1 != 0) ||\r\n(tx_rate2 == 0 && tx_tries2 != 0) ||\r\n(tx_rate3 == 0 && tx_tries3 != 0))) {\r\nATH5K_ERR(ah, "zero rate\n");\r\nWARN_ON(1);\r\nreturn -EINVAL;\r\n}\r\nif (ah->ah_version == AR5K_AR5212) {\r\ntx_ctl = &desc->ud.ds_tx5212.tx_ctl;\r\n#define _XTX_TRIES(_n) \\r\nif (tx_tries##_n) { \\r\ntx_ctl->tx_control_2 |= \\r\nAR5K_REG_SM(tx_tries##_n, \\r\nAR5K_4W_TX_DESC_CTL2_XMIT_TRIES##_n); \\r\ntx_ctl->tx_control_3 |= \\r\nAR5K_REG_SM(tx_rate##_n, \\r\nAR5K_4W_TX_DESC_CTL3_XMIT_RATE##_n); \\r\n}\r\n_XTX_TRIES(1);\r\n_XTX_TRIES(2);\r\n_XTX_TRIES(3);\r\n#undef _XTX_TRIES\r\nreturn 1;\r\n}\r\nreturn 0;\r\n}\r\nstatic int\r\nath5k_hw_proc_2word_tx_status(struct ath5k_hw *ah,\r\nstruct ath5k_desc *desc,\r\nstruct ath5k_tx_status *ts)\r\n{\r\nstruct ath5k_hw_2w_tx_ctl *tx_ctl;\r\nstruct ath5k_hw_tx_status *tx_status;\r\ntx_ctl = &desc->ud.ds_tx5210.tx_ctl;\r\ntx_status = &desc->ud.ds_tx5210.tx_stat;\r\nif (unlikely((tx_status->tx_status_1 & AR5K_DESC_TX_STATUS1_DONE) == 0))\r\nreturn -EINPROGRESS;\r\nts->ts_tstamp = AR5K_REG_MS(tx_status->tx_status_0,\r\nAR5K_DESC_TX_STATUS0_SEND_TIMESTAMP);\r\nts->ts_shortretry = AR5K_REG_MS(tx_status->tx_status_0,\r\nAR5K_DESC_TX_STATUS0_SHORT_RETRY_COUNT);\r\nts->ts_final_retry = AR5K_REG_MS(tx_status->tx_status_0,\r\nAR5K_DESC_TX_STATUS0_LONG_RETRY_COUNT);\r\nts->ts_seqnum = AR5K_REG_MS(tx_status->tx_status_1,\r\nAR5K_DESC_TX_STATUS1_SEQ_NUM);\r\nts->ts_rssi = AR5K_REG_MS(tx_status->tx_status_1,\r\nAR5K_DESC_TX_STATUS1_ACK_SIG_STRENGTH);\r\nts->ts_antenna = 1;\r\nts->ts_status = 0;\r\nts->ts_final_idx = 0;\r\nif (!(tx_status->tx_status_0 & AR5K_DESC_TX_STATUS0_FRAME_XMIT_OK)) {\r\nif (tx_status->tx_status_0 &\r\nAR5K_DESC_TX_STATUS0_EXCESSIVE_RETRIES)\r\nts->ts_status |= AR5K_TXERR_XRETRY;\r\nif (tx_status->tx_status_0 & AR5K_DESC_TX_STATUS0_FIFO_UNDERRUN)\r\nts->ts_status |= AR5K_TXERR_FIFO;\r\nif (tx_status->tx_status_0 & AR5K_DESC_TX_STATUS0_FILTERED)\r\nts->ts_status |= AR5K_TXERR_FILT;\r\n}\r\nreturn 0;\r\n}\r\nstatic int\r\nath5k_hw_proc_4word_tx_status(struct ath5k_hw *ah,\r\nstruct ath5k_desc *desc,\r\nstruct ath5k_tx_status *ts)\r\n{\r\nstruct ath5k_hw_4w_tx_ctl *tx_ctl;\r\nstruct ath5k_hw_tx_status *tx_status;\r\nu32 txstat0, txstat1;\r\ntx_ctl = &desc->ud.ds_tx5212.tx_ctl;\r\ntx_status = &desc->ud.ds_tx5212.tx_stat;\r\ntxstat1 = ACCESS_ONCE(tx_status->tx_status_1);\r\nif (unlikely(!(txstat1 & AR5K_DESC_TX_STATUS1_DONE)))\r\nreturn -EINPROGRESS;\r\ntxstat0 = ACCESS_ONCE(tx_status->tx_status_0);\r\nts->ts_tstamp = AR5K_REG_MS(txstat0,\r\nAR5K_DESC_TX_STATUS0_SEND_TIMESTAMP);\r\nts->ts_shortretry = AR5K_REG_MS(txstat0,\r\nAR5K_DESC_TX_STATUS0_SHORT_RETRY_COUNT);\r\nts->ts_final_retry = AR5K_REG_MS(txstat0,\r\nAR5K_DESC_TX_STATUS0_LONG_RETRY_COUNT);\r\nts->ts_seqnum = AR5K_REG_MS(txstat1,\r\nAR5K_DESC_TX_STATUS1_SEQ_NUM);\r\nts->ts_rssi = AR5K_REG_MS(txstat1,\r\nAR5K_DESC_TX_STATUS1_ACK_SIG_STRENGTH);\r\nts->ts_antenna = (txstat1 &\r\nAR5K_DESC_TX_STATUS1_XMIT_ANTENNA_5212) ? 2 : 1;\r\nts->ts_status = 0;\r\nts->ts_final_idx = AR5K_REG_MS(txstat1,\r\nAR5K_DESC_TX_STATUS1_FINAL_TS_IX_5212);\r\nif (!(txstat0 & AR5K_DESC_TX_STATUS0_FRAME_XMIT_OK)) {\r\nif (txstat0 & AR5K_DESC_TX_STATUS0_EXCESSIVE_RETRIES)\r\nts->ts_status |= AR5K_TXERR_XRETRY;\r\nif (txstat0 & AR5K_DESC_TX_STATUS0_FIFO_UNDERRUN)\r\nts->ts_status |= AR5K_TXERR_FIFO;\r\nif (txstat0 & AR5K_DESC_TX_STATUS0_FILTERED)\r\nts->ts_status |= AR5K_TXERR_FILT;\r\n}\r\nreturn 0;\r\n}\r\nint\r\nath5k_hw_setup_rx_desc(struct ath5k_hw *ah,\r\nstruct ath5k_desc *desc,\r\nu32 size, unsigned int flags)\r\n{\r\nstruct ath5k_hw_rx_ctl *rx_ctl;\r\nrx_ctl = &desc->ud.ds_rx.rx_ctl;\r\nmemset(&desc->ud.ds_rx, 0, sizeof(struct ath5k_hw_all_rx_desc));\r\nif (unlikely(size & ~AR5K_DESC_RX_CTL1_BUF_LEN))\r\nreturn -EINVAL;\r\nrx_ctl->rx_control_1 = size & AR5K_DESC_RX_CTL1_BUF_LEN;\r\nif (flags & AR5K_RXDESC_INTREQ)\r\nrx_ctl->rx_control_1 |= AR5K_DESC_RX_CTL1_INTREQ;\r\nreturn 0;\r\n}\r\nstatic int\r\nath5k_hw_proc_5210_rx_status(struct ath5k_hw *ah,\r\nstruct ath5k_desc *desc,\r\nstruct ath5k_rx_status *rs)\r\n{\r\nstruct ath5k_hw_rx_status *rx_status;\r\nrx_status = &desc->ud.ds_rx.rx_stat;\r\nif (unlikely(!(rx_status->rx_status_1 &\r\nAR5K_5210_RX_DESC_STATUS1_DONE)))\r\nreturn -EINPROGRESS;\r\nmemset(rs, 0, sizeof(struct ath5k_rx_status));\r\nrs->rs_datalen = rx_status->rx_status_0 &\r\nAR5K_5210_RX_DESC_STATUS0_DATA_LEN;\r\nrs->rs_rssi = AR5K_REG_MS(rx_status->rx_status_0,\r\nAR5K_5210_RX_DESC_STATUS0_RECEIVE_SIGNAL);\r\nrs->rs_rate = AR5K_REG_MS(rx_status->rx_status_0,\r\nAR5K_5210_RX_DESC_STATUS0_RECEIVE_RATE);\r\nrs->rs_more = !!(rx_status->rx_status_0 &\r\nAR5K_5210_RX_DESC_STATUS0_MORE);\r\nrs->rs_tstamp = AR5K_REG_MS(rx_status->rx_status_1,\r\nAR5K_5210_RX_DESC_STATUS1_RECEIVE_TIMESTAMP);\r\nif (ah->ah_version == AR5K_AR5211)\r\nrs->rs_antenna = AR5K_REG_MS(rx_status->rx_status_0,\r\nAR5K_5210_RX_DESC_STATUS0_RECEIVE_ANT_5211);\r\nelse\r\nrs->rs_antenna = (rx_status->rx_status_0 &\r\nAR5K_5210_RX_DESC_STATUS0_RECEIVE_ANT_5210)\r\n? 2 : 1;\r\nif (rx_status->rx_status_1 & AR5K_5210_RX_DESC_STATUS1_KEY_INDEX_VALID)\r\nrs->rs_keyix = AR5K_REG_MS(rx_status->rx_status_1,\r\nAR5K_5210_RX_DESC_STATUS1_KEY_INDEX);\r\nelse\r\nrs->rs_keyix = AR5K_RXKEYIX_INVALID;\r\nif (!(rx_status->rx_status_1 &\r\nAR5K_5210_RX_DESC_STATUS1_FRAME_RECEIVE_OK)) {\r\nif (rx_status->rx_status_1 &\r\nAR5K_5210_RX_DESC_STATUS1_CRC_ERROR)\r\nrs->rs_status |= AR5K_RXERR_CRC;\r\nif ((ah->ah_version == AR5K_AR5210) &&\r\n(rx_status->rx_status_1 &\r\nAR5K_5210_RX_DESC_STATUS1_FIFO_OVERRUN_5210))\r\nrs->rs_status |= AR5K_RXERR_FIFO;\r\nif (rx_status->rx_status_1 &\r\nAR5K_5210_RX_DESC_STATUS1_PHY_ERROR) {\r\nrs->rs_status |= AR5K_RXERR_PHY;\r\nrs->rs_phyerr = AR5K_REG_MS(rx_status->rx_status_1,\r\nAR5K_5210_RX_DESC_STATUS1_PHY_ERROR);\r\n}\r\nif (rx_status->rx_status_1 &\r\nAR5K_5210_RX_DESC_STATUS1_DECRYPT_CRC_ERROR)\r\nrs->rs_status |= AR5K_RXERR_DECRYPT;\r\n}\r\nreturn 0;\r\n}\r\nstatic int\r\nath5k_hw_proc_5212_rx_status(struct ath5k_hw *ah,\r\nstruct ath5k_desc *desc,\r\nstruct ath5k_rx_status *rs)\r\n{\r\nstruct ath5k_hw_rx_status *rx_status;\r\nu32 rxstat0, rxstat1;\r\nrx_status = &desc->ud.ds_rx.rx_stat;\r\nrxstat1 = ACCESS_ONCE(rx_status->rx_status_1);\r\nif (unlikely(!(rxstat1 & AR5K_5212_RX_DESC_STATUS1_DONE)))\r\nreturn -EINPROGRESS;\r\nmemset(rs, 0, sizeof(struct ath5k_rx_status));\r\nrxstat0 = ACCESS_ONCE(rx_status->rx_status_0);\r\nrs->rs_datalen = rxstat0 & AR5K_5212_RX_DESC_STATUS0_DATA_LEN;\r\nrs->rs_rssi = AR5K_REG_MS(rxstat0,\r\nAR5K_5212_RX_DESC_STATUS0_RECEIVE_SIGNAL);\r\nrs->rs_rate = AR5K_REG_MS(rxstat0,\r\nAR5K_5212_RX_DESC_STATUS0_RECEIVE_RATE);\r\nrs->rs_antenna = AR5K_REG_MS(rxstat0,\r\nAR5K_5212_RX_DESC_STATUS0_RECEIVE_ANTENNA);\r\nrs->rs_more = !!(rxstat0 & AR5K_5212_RX_DESC_STATUS0_MORE);\r\nrs->rs_tstamp = AR5K_REG_MS(rxstat1,\r\nAR5K_5212_RX_DESC_STATUS1_RECEIVE_TIMESTAMP);\r\nif (rxstat1 & AR5K_5212_RX_DESC_STATUS1_KEY_INDEX_VALID)\r\nrs->rs_keyix = AR5K_REG_MS(rxstat1,\r\nAR5K_5212_RX_DESC_STATUS1_KEY_INDEX);\r\nelse\r\nrs->rs_keyix = AR5K_RXKEYIX_INVALID;\r\nif (!(rxstat1 & AR5K_5212_RX_DESC_STATUS1_FRAME_RECEIVE_OK)) {\r\nif (rxstat1 & AR5K_5212_RX_DESC_STATUS1_CRC_ERROR)\r\nrs->rs_status |= AR5K_RXERR_CRC;\r\nif (rxstat1 & AR5K_5212_RX_DESC_STATUS1_PHY_ERROR) {\r\nrs->rs_status |= AR5K_RXERR_PHY;\r\nrs->rs_phyerr = AR5K_REG_MS(rxstat1,\r\nAR5K_5212_RX_DESC_STATUS1_PHY_ERROR_CODE);\r\nif (!ah->ah_capabilities.cap_has_phyerr_counters)\r\nath5k_ani_phy_error_report(ah, rs->rs_phyerr);\r\n}\r\nif (rxstat1 & AR5K_5212_RX_DESC_STATUS1_DECRYPT_CRC_ERROR)\r\nrs->rs_status |= AR5K_RXERR_DECRYPT;\r\nif (rxstat1 & AR5K_5212_RX_DESC_STATUS1_MIC_ERROR)\r\nrs->rs_status |= AR5K_RXERR_MIC;\r\n}\r\nreturn 0;\r\n}\r\nint\r\nath5k_hw_init_desc_functions(struct ath5k_hw *ah)\r\n{\r\nif (ah->ah_version == AR5K_AR5212) {\r\nah->ah_setup_tx_desc = ath5k_hw_setup_4word_tx_desc;\r\nah->ah_proc_tx_desc = ath5k_hw_proc_4word_tx_status;\r\nah->ah_proc_rx_desc = ath5k_hw_proc_5212_rx_status;\r\n} else if (ah->ah_version <= AR5K_AR5211) {\r\nah->ah_setup_tx_desc = ath5k_hw_setup_2word_tx_desc;\r\nah->ah_proc_tx_desc = ath5k_hw_proc_2word_tx_status;\r\nah->ah_proc_rx_desc = ath5k_hw_proc_5210_rx_status;\r\n} else\r\nreturn -ENOTSUPP;\r\nreturn 0;\r\n}
