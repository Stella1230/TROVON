void acpi_ds_scope_stack_clear(struct acpi_walk_state *walk_state)\r\n{\r\nunion acpi_generic_state *scope_info;\r\nACPI_FUNCTION_NAME(ds_scope_stack_clear);\r\nwhile (walk_state->scope_info) {\r\nscope_info = walk_state->scope_info;\r\nwalk_state->scope_info = scope_info->scope.next;\r\nACPI_DEBUG_PRINT((ACPI_DB_EXEC,\r\n"Popped object type (%s)\n",\r\nacpi_ut_get_type_name(scope_info->common.\r\nvalue)));\r\nacpi_ut_delete_generic_state(scope_info);\r\n}\r\n}\r\nacpi_status\r\nacpi_ds_scope_stack_push(struct acpi_namespace_node *node,\r\nacpi_object_type type,\r\nstruct acpi_walk_state *walk_state)\r\n{\r\nunion acpi_generic_state *scope_info;\r\nunion acpi_generic_state *old_scope_info;\r\nACPI_FUNCTION_TRACE(ds_scope_stack_push);\r\nif (!node) {\r\nACPI_ERROR((AE_INFO, "Null scope parameter"));\r\nreturn_ACPI_STATUS(AE_BAD_PARAMETER);\r\n}\r\nif (!acpi_ut_valid_object_type(type)) {\r\nACPI_WARNING((AE_INFO, "Invalid object type: 0x%X", type));\r\n}\r\nscope_info = acpi_ut_create_generic_state();\r\nif (!scope_info) {\r\nreturn_ACPI_STATUS(AE_NO_MEMORY);\r\n}\r\nscope_info->common.descriptor_type = ACPI_DESC_TYPE_STATE_WSCOPE;\r\nscope_info->scope.node = node;\r\nscope_info->common.value = (u16) type;\r\nwalk_state->scope_depth++;\r\nACPI_DEBUG_PRINT((ACPI_DB_EXEC,\r\n"[%.2d] Pushed scope ",\r\n(u32) walk_state->scope_depth));\r\nold_scope_info = walk_state->scope_info;\r\nif (old_scope_info) {\r\nACPI_DEBUG_PRINT_RAW((ACPI_DB_EXEC,\r\n"[%4.4s] (%s)",\r\nacpi_ut_get_node_name(old_scope_info->\r\nscope.node),\r\nacpi_ut_get_type_name(old_scope_info->\r\ncommon.value)));\r\n} else {\r\nACPI_DEBUG_PRINT_RAW((ACPI_DB_EXEC, "[\\___] (%s)", "ROOT"));\r\n}\r\nACPI_DEBUG_PRINT_RAW((ACPI_DB_EXEC,\r\n", New scope -> [%4.4s] (%s)\n",\r\nacpi_ut_get_node_name(scope_info->scope.node),\r\nacpi_ut_get_type_name(scope_info->common.value)));\r\nacpi_ut_push_generic_state(&walk_state->scope_info, scope_info);\r\nreturn_ACPI_STATUS(AE_OK);\r\n}\r\nacpi_status acpi_ds_scope_stack_pop(struct acpi_walk_state *walk_state)\r\n{\r\nunion acpi_generic_state *scope_info;\r\nunion acpi_generic_state *new_scope_info;\r\nACPI_FUNCTION_TRACE(ds_scope_stack_pop);\r\nscope_info = acpi_ut_pop_generic_state(&walk_state->scope_info);\r\nif (!scope_info) {\r\nreturn_ACPI_STATUS(AE_STACK_UNDERFLOW);\r\n}\r\nwalk_state->scope_depth--;\r\nACPI_DEBUG_PRINT((ACPI_DB_EXEC,\r\n"[%.2d] Popped scope [%4.4s] (%s), New scope -> ",\r\n(u32) walk_state->scope_depth,\r\nacpi_ut_get_node_name(scope_info->scope.node),\r\nacpi_ut_get_type_name(scope_info->common.value)));\r\nnew_scope_info = walk_state->scope_info;\r\nif (new_scope_info) {\r\nACPI_DEBUG_PRINT_RAW((ACPI_DB_EXEC,\r\n"[%4.4s] (%s)\n",\r\nacpi_ut_get_node_name(new_scope_info->\r\nscope.node),\r\nacpi_ut_get_type_name(new_scope_info->\r\ncommon.value)));\r\n} else {\r\nACPI_DEBUG_PRINT_RAW((ACPI_DB_EXEC, "[\\___] (ROOT)\n"));\r\n}\r\nacpi_ut_delete_generic_state(scope_info);\r\nreturn_ACPI_STATUS(AE_OK);\r\n}
