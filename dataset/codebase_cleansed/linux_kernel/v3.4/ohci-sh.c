static int ohci_sh_start(struct usb_hcd *hcd)\r\n{\r\nstruct ohci_hcd *ohci = hcd_to_ohci(hcd);\r\nohci_hcd_init(ohci);\r\nohci_init(ohci);\r\nohci_run(ohci);\r\nreturn 0;\r\n}\r\nstatic int ohci_hcd_sh_probe(struct platform_device *pdev)\r\n{\r\nstruct resource *res = NULL;\r\nstruct usb_hcd *hcd = NULL;\r\nint irq = -1;\r\nint ret;\r\nif (usb_disabled())\r\nreturn -ENODEV;\r\nres = platform_get_resource(pdev, IORESOURCE_MEM, 0);\r\nif (!res) {\r\nerr("platform_get_resource error.");\r\nreturn -ENODEV;\r\n}\r\nirq = platform_get_irq(pdev, 0);\r\nif (irq < 0) {\r\nerr("platform_get_irq error.");\r\nreturn -ENODEV;\r\n}\r\nhcd = usb_create_hcd(&ohci_sh_hc_driver, &pdev->dev, (char *)hcd_name);\r\nif (!hcd) {\r\nerr("Failed to create hcd");\r\nreturn -ENOMEM;\r\n}\r\nhcd->regs = (void __iomem *)res->start;\r\nhcd->rsrc_start = res->start;\r\nhcd->rsrc_len = resource_size(res);\r\nret = usb_add_hcd(hcd, irq, IRQF_SHARED);\r\nif (ret != 0) {\r\nerr("Failed to add hcd");\r\nusb_put_hcd(hcd);\r\nreturn ret;\r\n}\r\nreturn ret;\r\n}\r\nstatic int ohci_hcd_sh_remove(struct platform_device *pdev)\r\n{\r\nstruct usb_hcd *hcd = platform_get_drvdata(pdev);\r\nusb_remove_hcd(hcd);\r\nusb_put_hcd(hcd);\r\nreturn 0;\r\n}
