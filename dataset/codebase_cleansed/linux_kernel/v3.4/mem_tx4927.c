static unsigned int __init tx4927_process_sdccr(u64 __iomem *addr)\r\n{\r\nu64 val;\r\nunsigned int sdccr_ce;\r\nunsigned int sdccr_bs;\r\nunsigned int sdccr_rs;\r\nunsigned int sdccr_cs;\r\nunsigned int sdccr_mw;\r\nunsigned int bs = 0;\r\nunsigned int rs = 0;\r\nunsigned int cs = 0;\r\nunsigned int mw = 0;\r\nval = __raw_readq(addr);\r\nsdccr_ce = ((val & (1 << 10)) >> 10);\r\nsdccr_bs = ((val & (1 << 8)) >> 8);\r\nsdccr_rs = ((val & (3 << 5)) >> 5);\r\nsdccr_cs = ((val & (7 << 2)) >> 2);\r\nsdccr_mw = ((val & (1 << 0)) >> 0);\r\nif (sdccr_ce) {\r\nbs = 2 << sdccr_bs;\r\nrs = 2048 << sdccr_rs;\r\ncs = 256 << sdccr_cs;\r\nmw = 8 >> sdccr_mw;\r\n}\r\nreturn rs * cs * mw * bs;\r\n}\r\nunsigned int __init tx4927_get_mem_size(void)\r\n{\r\nunsigned int total = 0;\r\nint i;\r\nfor (i = 0; i < ARRAY_SIZE(tx4927_sdramcptr->cr); i++)\r\ntotal += tx4927_process_sdccr(&tx4927_sdramcptr->cr[i]);\r\nreturn total;\r\n}
