static void fsg_led_wlan_set(struct led_classdev *led_cdev,\r\nenum led_brightness value)\r\n{\r\nif (value) {\r\nlatch_value &= ~(1 << FSG_LED_WLAN_BIT);\r\n*latch_address = latch_value;\r\n} else {\r\nlatch_value |= (1 << FSG_LED_WLAN_BIT);\r\n*latch_address = latch_value;\r\n}\r\n}\r\nstatic void fsg_led_wan_set(struct led_classdev *led_cdev,\r\nenum led_brightness value)\r\n{\r\nif (value) {\r\nlatch_value &= ~(1 << FSG_LED_WAN_BIT);\r\n*latch_address = latch_value;\r\n} else {\r\nlatch_value |= (1 << FSG_LED_WAN_BIT);\r\n*latch_address = latch_value;\r\n}\r\n}\r\nstatic void fsg_led_sata_set(struct led_classdev *led_cdev,\r\nenum led_brightness value)\r\n{\r\nif (value) {\r\nlatch_value &= ~(1 << FSG_LED_SATA_BIT);\r\n*latch_address = latch_value;\r\n} else {\r\nlatch_value |= (1 << FSG_LED_SATA_BIT);\r\n*latch_address = latch_value;\r\n}\r\n}\r\nstatic void fsg_led_usb_set(struct led_classdev *led_cdev,\r\nenum led_brightness value)\r\n{\r\nif (value) {\r\nlatch_value &= ~(1 << FSG_LED_USB_BIT);\r\n*latch_address = latch_value;\r\n} else {\r\nlatch_value |= (1 << FSG_LED_USB_BIT);\r\n*latch_address = latch_value;\r\n}\r\n}\r\nstatic void fsg_led_sync_set(struct led_classdev *led_cdev,\r\nenum led_brightness value)\r\n{\r\nif (value) {\r\nlatch_value &= ~(1 << FSG_LED_SYNC_BIT);\r\n*latch_address = latch_value;\r\n} else {\r\nlatch_value |= (1 << FSG_LED_SYNC_BIT);\r\n*latch_address = latch_value;\r\n}\r\n}\r\nstatic void fsg_led_ring_set(struct led_classdev *led_cdev,\r\nenum led_brightness value)\r\n{\r\nif (value) {\r\nlatch_value &= ~(1 << FSG_LED_RING_BIT);\r\n*latch_address = latch_value;\r\n} else {\r\nlatch_value |= (1 << FSG_LED_RING_BIT);\r\n*latch_address = latch_value;\r\n}\r\n}\r\nstatic int fsg_led_probe(struct platform_device *pdev)\r\n{\r\nint ret;\r\nlatch_address = (unsigned short *) ioremap(IXP4XX_EXP_BUS_BASE(2), 512);\r\nif (!latch_address) {\r\nret = -ENOMEM;\r\ngoto failremap;\r\n}\r\nlatch_value = 0xffff;\r\n*latch_address = latch_value;\r\nret = led_classdev_register(&pdev->dev, &fsg_wlan_led);\r\nif (ret < 0)\r\ngoto failwlan;\r\nret = led_classdev_register(&pdev->dev, &fsg_wan_led);\r\nif (ret < 0)\r\ngoto failwan;\r\nret = led_classdev_register(&pdev->dev, &fsg_sata_led);\r\nif (ret < 0)\r\ngoto failsata;\r\nret = led_classdev_register(&pdev->dev, &fsg_usb_led);\r\nif (ret < 0)\r\ngoto failusb;\r\nret = led_classdev_register(&pdev->dev, &fsg_sync_led);\r\nif (ret < 0)\r\ngoto failsync;\r\nret = led_classdev_register(&pdev->dev, &fsg_ring_led);\r\nif (ret < 0)\r\ngoto failring;\r\nreturn ret;\r\nfailring:\r\nled_classdev_unregister(&fsg_sync_led);\r\nfailsync:\r\nled_classdev_unregister(&fsg_usb_led);\r\nfailusb:\r\nled_classdev_unregister(&fsg_sata_led);\r\nfailsata:\r\nled_classdev_unregister(&fsg_wan_led);\r\nfailwan:\r\nled_classdev_unregister(&fsg_wlan_led);\r\nfailwlan:\r\niounmap(latch_address);\r\nfailremap:\r\nreturn ret;\r\n}\r\nstatic int fsg_led_remove(struct platform_device *pdev)\r\n{\r\nled_classdev_unregister(&fsg_wlan_led);\r\nled_classdev_unregister(&fsg_wan_led);\r\nled_classdev_unregister(&fsg_sata_led);\r\nled_classdev_unregister(&fsg_usb_led);\r\nled_classdev_unregister(&fsg_sync_led);\r\nled_classdev_unregister(&fsg_ring_led);\r\niounmap(latch_address);\r\nreturn 0;\r\n}
