static int xen_acpi_notify_hypervisor_state(u8 sleep_state,\r\nu32 val_a, u32 val_b,\r\nbool extended)\r\n{\r\nunsigned int bits = extended ? 8 : 16;\r\nstruct xen_platform_op op = {\r\n.cmd = XENPF_enter_acpi_sleep,\r\n.interface_version = XENPF_INTERFACE_VERSION,\r\n.u.enter_acpi_sleep = {\r\n.val_a = (u16)val_a,\r\n.val_b = (u16)val_b,\r\n.sleep_state = sleep_state,\r\n.flags = extended ? XENPF_ACPI_SLEEP_EXTENDED : 0,\r\n},\r\n};\r\nif (WARN((val_a & (~0 << bits)) || (val_b & (~0 << bits)),\r\n"Using more than %u bits of sleep control values %#x/%#x!"\r\n"Email xen-devel@lists.xen.org - Thank you.\n", \\r\nbits, val_a, val_b))\r\nreturn -1;\r\nHYPERVISOR_dom0_op(&op);\r\nreturn 1;\r\n}\r\nint xen_acpi_notify_hypervisor_sleep(u8 sleep_state,\r\nu32 pm1a_cnt, u32 pm1b_cnt)\r\n{\r\nreturn xen_acpi_notify_hypervisor_state(sleep_state, pm1a_cnt,\r\npm1b_cnt, false);\r\n}\r\nint xen_acpi_notify_hypervisor_extended_sleep(u8 sleep_state,\r\nu32 val_a, u32 val_b)\r\n{\r\nreturn xen_acpi_notify_hypervisor_state(sleep_state, val_a,\r\nval_b, true);\r\n}
