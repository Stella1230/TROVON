static void edb7211_lcd_power_set(struct plat_lcd_data *pd, unsigned int power)\r\n{\r\nif (power) {\r\ngpio_set_value(EDB7211_LCDEN, 1);\r\nudelay(100);\r\ngpio_set_value(EDB7211_LCD_DC_DC_EN, 1);\r\n} else {\r\ngpio_set_value(EDB7211_LCD_DC_DC_EN, 0);\r\nudelay(100);\r\ngpio_set_value(EDB7211_LCDEN, 0);\r\n}\r\n}\r\nstatic void edb7211_lcd_backlight_set_intensity(int intensity)\r\n{\r\ngpio_set_value(EDB7211_LCDBL, !!intensity);\r\nclps_writel((clps_readl(PMPCON) & 0xf0ff) | (intensity << 8), PMPCON);\r\n}\r\nstatic void __init edb7211_reserve(void)\r\n{\r\nmemblock_reserve(PHYS_OFFSET, VIDEORAM_SIZE);\r\n}\r\nstatic void __init\r\nfixup_edb7211(struct tag *tags, char **cmdline, struct meminfo *mi)\r\n{\r\nmi->bank[0].start = 0xc0000000;\r\nmi->bank[0].size = SZ_8M;\r\nmi->bank[1].start = 0xc1000000;\r\nmi->bank[1].size = SZ_8M;\r\nmi->nr_banks = 2;\r\n}\r\nstatic void __init edb7211_init(void)\r\n{\r\nclps711x_devices_init();\r\n}\r\nstatic void __init edb7211_init_late(void)\r\n{\r\ngpio_request_array(edb7211_gpios, ARRAY_SIZE(edb7211_gpios));\r\nplatform_device_register(&edb7211_flash_pdev);\r\nplatform_device_register_data(&platform_bus, "platform-lcd", 0,\r\n&edb7211_lcd_power_pdata,\r\nsizeof(edb7211_lcd_power_pdata));\r\nplatform_device_register_data(&platform_bus, "generic-bl", 0,\r\n&edb7211_lcd_backlight_pdata,\r\nsizeof(edb7211_lcd_backlight_pdata));\r\nplatform_device_register_simple("video-clps711x", 0, NULL, 0);\r\nplatform_device_register_simple("cs89x0", 0, edb7211_cs8900_resource,\r\nARRAY_SIZE(edb7211_cs8900_resource));\r\nplatform_device_register_data(&platform_bus, "i2c-gpio", 0,\r\n&edb7211_i2c_pdata,\r\nsizeof(edb7211_i2c_pdata));\r\n}
