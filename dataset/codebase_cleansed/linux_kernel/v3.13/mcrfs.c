int\r\nmcrfs(u32 *ccr, u32 crfD, u32 crfS)\r\n{\r\nu32 value, clear;\r\n#ifdef DEBUG\r\nprintk("%s: %p (%08x) %d %d\n", __func__, ccr, *ccr, crfD, crfS);\r\n#endif\r\nclear = 15 << ((7 - crfS) << 2);\r\nif (!crfS)\r\nclear = 0x90000000;\r\nvalue = (__FPU_FPSCR >> ((7 - crfS) << 2)) & 15;\r\n__FPU_FPSCR &= ~(clear);\r\n*ccr &= ~(15 << ((7 - crfD) << 2));\r\n*ccr |= (value << ((7 - crfD) << 2));\r\n#ifdef DEBUG\r\nprintk("CR: %08x\n", __func__, *ccr);\r\n#endif\r\nreturn 0;\r\n}
