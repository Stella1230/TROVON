static void *\r\nvxfs_immed_follow_link(struct dentry *dp, struct nameidata *np)\r\n{\r\nstruct vxfs_inode_info *vip = VXFS_INO(dp->d_inode);\r\nnd_set_link(np, vip->vii_immed.vi_immed);\r\nreturn NULL;\r\n}\r\nstatic int\r\nvxfs_immed_readpage(struct file *fp, struct page *pp)\r\n{\r\nstruct vxfs_inode_info *vip = VXFS_INO(pp->mapping->host);\r\nu_int64_t offset = (u_int64_t)pp->index << PAGE_CACHE_SHIFT;\r\ncaddr_t kaddr;\r\nkaddr = kmap(pp);\r\nmemcpy(kaddr, vip->vii_immed.vi_immed + offset, PAGE_CACHE_SIZE);\r\nkunmap(pp);\r\nflush_dcache_page(pp);\r\nSetPageUptodate(pp);\r\nunlock_page(pp);\r\nreturn 0;\r\n}
