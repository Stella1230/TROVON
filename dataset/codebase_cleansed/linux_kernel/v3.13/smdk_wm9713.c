static int __init smdk_init(void)\r\n{\r\nint ret;\r\nsmdk_snd_wm9713_device = platform_device_alloc("wm9713-codec", -1);\r\nif (!smdk_snd_wm9713_device)\r\nreturn -ENOMEM;\r\nret = platform_device_add(smdk_snd_wm9713_device);\r\nif (ret)\r\ngoto err1;\r\nsmdk_snd_ac97_device = platform_device_alloc("soc-audio", -1);\r\nif (!smdk_snd_ac97_device) {\r\nret = -ENOMEM;\r\ngoto err2;\r\n}\r\nplatform_set_drvdata(smdk_snd_ac97_device, &smdk);\r\nret = platform_device_add(smdk_snd_ac97_device);\r\nif (ret)\r\ngoto err3;\r\nreturn 0;\r\nerr3:\r\nplatform_device_put(smdk_snd_ac97_device);\r\nerr2:\r\nplatform_device_del(smdk_snd_wm9713_device);\r\nerr1:\r\nplatform_device_put(smdk_snd_wm9713_device);\r\nreturn ret;\r\n}\r\nstatic void __exit smdk_exit(void)\r\n{\r\nplatform_device_unregister(smdk_snd_ac97_device);\r\nplatform_device_unregister(smdk_snd_wm9713_device);\r\n}
