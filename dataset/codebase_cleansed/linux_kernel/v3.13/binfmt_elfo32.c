static inline void\r\njiffies_to_compat_timeval(unsigned long jiffies, struct compat_timeval *value)\r\n{\r\nu64 nsec = (u64)jiffies * TICK_NSEC;\r\nu32 rem;\r\nvalue->tv_sec = div_u64_rem(nsec, NSEC_PER_SEC, &rem);\r\nvalue->tv_usec = rem / NSEC_PER_USEC;\r\n}\r\nvoid elf32_core_copy_regs(elf_gregset_t grp, struct pt_regs *regs)\r\n{\r\nint i;\r\nfor (i = 0; i < EF_R0; i++)\r\ngrp[i] = 0;\r\ngrp[EF_R0] = 0;\r\nfor (i = 1; i <= 31; i++)\r\ngrp[EF_R0 + i] = (elf_greg_t) regs->regs[i];\r\ngrp[EF_R26] = 0;\r\ngrp[EF_R27] = 0;\r\ngrp[EF_LO] = (elf_greg_t) regs->lo;\r\ngrp[EF_HI] = (elf_greg_t) regs->hi;\r\ngrp[EF_CP0_EPC] = (elf_greg_t) regs->cp0_epc;\r\ngrp[EF_CP0_BADVADDR] = (elf_greg_t) regs->cp0_badvaddr;\r\ngrp[EF_CP0_STATUS] = (elf_greg_t) regs->cp0_status;\r\ngrp[EF_CP0_CAUSE] = (elf_greg_t) regs->cp0_cause;\r\n#ifdef EF_UNUSED0\r\ngrp[EF_UNUSED0] = 0;\r\n#endif\r\n}\r\nstatic __inline__ void\r\ncputime_to_compat_timeval(const cputime_t cputime, struct compat_timeval *value)\r\n{\r\nunsigned long jiffies = cputime_to_jiffies(cputime);\r\nvalue->tv_usec = (jiffies % HZ) * (1000000L / HZ);\r\nvalue->tv_sec = jiffies / HZ;\r\n}
