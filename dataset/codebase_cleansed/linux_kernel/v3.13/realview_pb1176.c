static void __init realview_pb1176_map_io(void)\r\n{\r\niotable_init(realview_pb1176_io_desc, ARRAY_SIZE(realview_pb1176_io_desc));\r\n}\r\nstatic void __init gic_init_irq(void)\r\n{\r\ngic_init(0, IRQ_DC1176_GIC_START,\r\n__io_address(REALVIEW_DC1176_GIC_DIST_BASE),\r\n__io_address(REALVIEW_DC1176_GIC_CPU_BASE));\r\ngic_init(1, IRQ_PB1176_GIC_START,\r\n__io_address(REALVIEW_PB1176_GIC_DIST_BASE),\r\n__io_address(REALVIEW_PB1176_GIC_CPU_BASE));\r\ngic_cascade_irq(1, IRQ_DC1176_PB_IRQ1);\r\n}\r\nstatic void __init realview_pb1176_timer_init(void)\r\n{\r\ntimer0_va_base = __io_address(REALVIEW_PB1176_TIMER0_1_BASE);\r\ntimer1_va_base = __io_address(REALVIEW_PB1176_TIMER0_1_BASE) + 0x20;\r\ntimer2_va_base = __io_address(REALVIEW_PB1176_TIMER2_3_BASE);\r\ntimer3_va_base = __io_address(REALVIEW_PB1176_TIMER2_3_BASE) + 0x20;\r\nrealview_clk_init(__io_address(REALVIEW_SYS_BASE), true);\r\nrealview_timer_init(IRQ_DC1176_TIMER0);\r\n}\r\nstatic void realview_pb1176_restart(enum reboot_mode mode, const char *cmd)\r\n{\r\nvoid __iomem *reset_ctrl = __io_address(REALVIEW_SYS_RESETCTL);\r\nvoid __iomem *lock_ctrl = __io_address(REALVIEW_SYS_LOCK);\r\n__raw_writel(REALVIEW_SYS_LOCK_VAL, lock_ctrl);\r\n__raw_writel(REALVIEW_PB1176_SYS_SOFT_RESET, reset_ctrl);\r\ndsb();\r\n}\r\nstatic void realview_pb1176_fixup(struct tag *tags, char **from,\r\nstruct meminfo *meminfo)\r\n{\r\nmeminfo->bank[0].start = 0;\r\nmeminfo->bank[0].size = SZ_128M;\r\nmeminfo->nr_banks = 1;\r\n}\r\nstatic void __init realview_pb1176_init(void)\r\n{\r\nint i;\r\n#ifdef CONFIG_CACHE_L2X0\r\nl2x0_init(__io_address(REALVIEW_PB1176_L220_BASE), 0x00730000, 0xfe000fff);\r\n#endif\r\nrealview_flash_register(realview_pb1176_flash_resources,\r\nARRAY_SIZE(realview_pb1176_flash_resources));\r\nplatform_device_register(&pb1176_rom_device);\r\nrealview_eth_register(NULL, realview_pb1176_smsc911x_resources);\r\nplatform_device_register(&realview_i2c_device);\r\nrealview_usb_register(realview_pb1176_isp1761_resources);\r\nplatform_device_register(&pmu_device);\r\nplatform_device_register(&char_lcd_device);\r\nfor (i = 0; i < ARRAY_SIZE(amba_devs); i++) {\r\nstruct amba_device *d = amba_devs[i];\r\namba_device_register(d, &iomem_resource);\r\n}\r\n}
