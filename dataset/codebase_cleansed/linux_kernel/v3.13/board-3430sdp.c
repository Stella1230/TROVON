static void __init sdp3430_display_init(void)\r\n{\r\nint r;\r\nr = gpio_request_one(SDP3430_LCD_PANEL_BACKLIGHT_GPIO,\r\nGPIOF_OUT_INIT_HIGH, "LCD Backlight");\r\nif (r)\r\npr_err("failed to get LCD Backlight GPIO\n");\r\n}\r\nstatic int sdp3430_twl_gpio_setup(struct device *dev,\r\nunsigned gpio, unsigned ngpio)\r\n{\r\nmmc[0].gpio_cd = gpio + 0;\r\nmmc[1].gpio_cd = gpio + 1;\r\nomap_hsmmc_late_init(mmc);\r\ngpio_request_one(gpio + 7, GPIOF_OUT_INIT_LOW, "sub_lcd_en_bkl");\r\ngpio_request_one(gpio + 15, GPIOF_OUT_INIT_LOW, "sub_lcd_nRST");\r\nomap_twl4030_audio_data.jack_detect = gpio + 2;\r\nomap_twl4030_audio_init("SDP3430", &omap_twl4030_audio_data);\r\nreturn 0;\r\n}\r\nstatic int __init omap3430_i2c_init(void)\r\n{\r\nomap3_pmic_get_config(&sdp3430_twldata,\r\nTWL_COMMON_PDATA_USB | TWL_COMMON_PDATA_BCI |\r\nTWL_COMMON_PDATA_MADC | TWL_COMMON_PDATA_AUDIO,\r\nTWL_COMMON_REGULATOR_VDAC | TWL_COMMON_REGULATOR_VPLL2);\r\nsdp3430_twldata.vdac->constraints.apply_uV = true;\r\nsdp3430_twldata.vpll2->constraints.apply_uV = true;\r\nsdp3430_twldata.vpll2->constraints.name = "VDVI";\r\nsdp3430_twldata.audio->codec->hs_extmute = 1;\r\nsdp3430_twldata.audio->codec->hs_extmute_gpio = -EINVAL;\r\nomap3_pmic_init("twl4030", &sdp3430_twldata);\r\nomap_register_i2c_bus(2, 400, NULL, 0);\r\nomap_register_i2c_bus(3, 400, NULL, 0);\r\nreturn 0;\r\n}\r\nstatic void __init board_smc91x_init(void)\r\n{\r\nif (omap_rev() > OMAP3430_REV_ES1_0)\r\nboard_smc91x_data.gpio_irq = 6;\r\nelse\r\nboard_smc91x_data.gpio_irq = 29;\r\ngpmc_smc91x_init(&board_smc91x_data);\r\n}\r\nstatic inline void board_smc91x_init(void)\r\n{\r\n}\r\nstatic void enable_board_wakeup_source(void)\r\n{\r\nomap_mux_init_signal("sys_nirq",\r\nOMAP_WAKEUP_EN | OMAP_PIN_INPUT_PULLUP);\r\n}\r\nstatic void __init omap_3430sdp_init(void)\r\n{\r\nint gpio_pendown;\r\nomap3_mux_init(board_mux, OMAP_PACKAGE_CBB);\r\nomap_hsmmc_init(mmc);\r\nomap3430_i2c_init();\r\nomap_display_init(&sdp3430_dss_data);\r\nplatform_device_register(&sdp3430_lcd_device);\r\nplatform_device_register(&sdp3430_tfp410_device);\r\nplatform_device_register(&sdp3430_dvi_connector_device);\r\nplatform_device_register(&sdp3430_tv_connector_device);\r\nif (omap_rev() > OMAP3430_REV_ES1_0)\r\ngpio_pendown = SDP3430_TS_GPIO_IRQ_SDPV2;\r\nelse\r\ngpio_pendown = SDP3430_TS_GPIO_IRQ_SDPV1;\r\nomap_ads7846_init(1, gpio_pendown, 310, NULL);\r\nomap_serial_init();\r\nomap_sdrc_init(hyb18m512160af6_sdrc_params, NULL);\r\nusb_bind_phy("musb-hdrc.0.auto", 0, "twl4030_usb");\r\nusb_musb_init(NULL);\r\nboard_smc91x_init();\r\nboard_flash_init(sdp_flash_partitions, chip_sel_3430, 0);\r\nsdp3430_display_init();\r\nenable_board_wakeup_source();\r\nusbhs_init_phys(phy_data, ARRAY_SIZE(phy_data));\r\nusbhs_init(&usbhs_bdata);\r\n}
