int\r\ngct6_find_nodes(gct6_node *node, gct6_search_struct *search)\r\n{\r\ngct6_search_struct *wanted;\r\nint status = 0;\r\nif (node->magic != GCT_NODE_MAGIC) {\r\nprintk(KERN_ERR "GCT Node MAGIC incorrect - GCT invalid\n");\r\nreturn -EINVAL;\r\n}\r\nfor (wanted = search;\r\nwanted && (wanted->type | wanted->subtype);\r\nwanted++) {\r\nif (node->type != wanted->type)\r\ncontinue;\r\nif (node->subtype != wanted->subtype)\r\ncontinue;\r\nif (wanted->callout)\r\nwanted->callout(node);\r\n}\r\nif (node->next)\r\nstatus |= gct6_find_nodes(GCT_NODE_PTR(node->next), search);\r\nif (node->child)\r\nstatus |= gct6_find_nodes(GCT_NODE_PTR(node->child), search);\r\nreturn status;\r\n}
