static void podhd_destruct(struct usb_interface *interface)\r\n{\r\nstruct usb_line6_podhd *podhd = usb_get_intfdata(interface);\r\nif (podhd == NULL)\r\nreturn;\r\nline6_cleanup_audio(&podhd->line6);\r\n}\r\nstatic int podhd_try_init(struct usb_interface *interface,\r\nstruct usb_line6_podhd *podhd)\r\n{\r\nint err;\r\nstruct usb_line6 *line6 = &podhd->line6;\r\nif ((interface == NULL) || (podhd == NULL))\r\nreturn -ENODEV;\r\nerr = line6_init_audio(line6);\r\nif (err < 0)\r\nreturn err;\r\nerr = line6_init_midi(line6);\r\nif (err < 0)\r\nreturn err;\r\nerr = line6_init_pcm(line6, &podhd_pcm_properties);\r\nif (err < 0)\r\nreturn err;\r\nerr = line6_register_audio(line6);\r\nreturn err;\r\n}\r\nint line6_podhd_init(struct usb_interface *interface,\r\nstruct usb_line6_podhd *podhd)\r\n{\r\nint err = podhd_try_init(interface, podhd);\r\nif (err < 0)\r\npodhd_destruct(interface);\r\nreturn err;\r\n}\r\nvoid line6_podhd_disconnect(struct usb_interface *interface)\r\n{\r\nstruct usb_line6_podhd *podhd;\r\nif (interface == NULL)\r\nreturn;\r\npodhd = usb_get_intfdata(interface);\r\nif (podhd != NULL) {\r\nstruct snd_line6_pcm *line6pcm = podhd->line6.line6pcm;\r\nif (line6pcm != NULL)\r\nline6_pcm_disconnect(line6pcm);\r\n}\r\npodhd_destruct(interface);\r\n}
