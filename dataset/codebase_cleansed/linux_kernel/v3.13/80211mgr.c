void\r\nvMgrEncodeBeacon(\r\nPWLAN_FR_BEACON pFrame\r\n)\r\n{\r\npFrame->pHdr = (PUWLAN_80211HDR)pFrame->pBuf;\r\npFrame->pqwTimestamp =\r\n(u64 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3)) +\r\nWLAN_BEACON_OFF_TS);\r\npFrame->pwBeaconInterval = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_BEACON_OFF_BCN_INT);\r\npFrame->pwCapInfo = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_BEACON_OFF_CAPINFO);\r\npFrame->len = WLAN_HDR_ADDR3_LEN + WLAN_BEACON_OFF_SSID;\r\nreturn;\r\n}\r\nvoid\r\nvMgrDecodeBeacon(\r\nPWLAN_FR_BEACON pFrame\r\n)\r\n{\r\nPWLAN_IE pItem;\r\npFrame->pHdr = (PUWLAN_80211HDR)pFrame->pBuf;\r\npFrame->pqwTimestamp =\r\n(u64 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3)) +\r\nWLAN_BEACON_OFF_TS);\r\npFrame->pwBeaconInterval = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_BEACON_OFF_BCN_INT);\r\npFrame->pwCapInfo = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_BEACON_OFF_CAPINFO);\r\npItem = (PWLAN_IE)((u8 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3)))\r\n+ WLAN_BEACON_OFF_SSID);\r\nwhile (((u8 *)pItem) < (pFrame->pBuf + pFrame->len)) {\r\nswitch (pItem->byElementID) {\r\ncase WLAN_EID_SSID:\r\nif (pFrame->pSSID == NULL)\r\npFrame->pSSID = (PWLAN_IE_SSID)pItem;\r\nbreak;\r\ncase WLAN_EID_SUPP_RATES:\r\nif (pFrame->pSuppRates == NULL)\r\npFrame->pSuppRates = (PWLAN_IE_SUPP_RATES)pItem;\r\nbreak;\r\ncase WLAN_EID_FH_PARMS:\r\nbreak;\r\ncase WLAN_EID_DS_PARMS:\r\nif (pFrame->pDSParms == NULL)\r\npFrame->pDSParms = (PWLAN_IE_DS_PARMS)pItem;\r\nbreak;\r\ncase WLAN_EID_CF_PARMS:\r\nif (pFrame->pCFParms == NULL)\r\npFrame->pCFParms = (PWLAN_IE_CF_PARMS)pItem;\r\nbreak;\r\ncase WLAN_EID_IBSS_PARMS:\r\nif (pFrame->pIBSSParms == NULL)\r\npFrame->pIBSSParms = (PWLAN_IE_IBSS_PARMS)pItem;\r\nbreak;\r\ncase WLAN_EID_TIM:\r\nif (pFrame->pTIM == NULL)\r\npFrame->pTIM = (PWLAN_IE_TIM)pItem;\r\nbreak;\r\ncase WLAN_EID_RSN:\r\nif (pFrame->pRSN == NULL)\r\npFrame->pRSN = (PWLAN_IE_RSN)pItem;\r\nbreak;\r\ncase WLAN_EID_RSN_WPA:\r\nif (pFrame->pRSNWPA == NULL) {\r\nif (WPAb_Is_RSN((PWLAN_IE_RSN_EXT)pItem) == true)\r\npFrame->pRSNWPA = (PWLAN_IE_RSN_EXT)pItem;\r\n}\r\nbreak;\r\ncase WLAN_EID_ERP:\r\nif (pFrame->pERP == NULL)\r\npFrame->pERP = (PWLAN_IE_ERP)pItem;\r\nbreak;\r\ncase WLAN_EID_EXTSUPP_RATES:\r\nif (pFrame->pExtSuppRates == NULL)\r\npFrame->pExtSuppRates = (PWLAN_IE_SUPP_RATES)pItem;\r\nbreak;\r\ncase WLAN_EID_COUNTRY:\r\nif (pFrame->pIE_Country == NULL)\r\npFrame->pIE_Country = (PWLAN_IE_COUNTRY)pItem;\r\nbreak;\r\ncase WLAN_EID_PWR_CONSTRAINT:\r\nif (pFrame->pIE_PowerConstraint == NULL)\r\npFrame->pIE_PowerConstraint = (PWLAN_IE_PW_CONST)pItem;\r\nbreak;\r\ncase WLAN_EID_CH_SWITCH:\r\nif (pFrame->pIE_CHSW == NULL)\r\npFrame->pIE_CHSW = (PWLAN_IE_CH_SW)pItem;\r\nbreak;\r\ncase WLAN_EID_QUIET:\r\nif (pFrame->pIE_Quiet == NULL)\r\npFrame->pIE_Quiet = (PWLAN_IE_QUIET)pItem;\r\nbreak;\r\ncase WLAN_EID_IBSS_DFS:\r\nif (pFrame->pIE_IBSSDFS == NULL)\r\npFrame->pIE_IBSSDFS = (PWLAN_IE_IBSS_DFS)pItem;\r\nbreak;\r\ndefault:\r\nDBG_PRT(MSG_LEVEL_DEBUG, KERN_INFO "Unrecognized EID=%dd in beacon decode.\n", pItem->byElementID);\r\nbreak;\r\n}\r\npItem = (PWLAN_IE)(((u8 *)pItem) + 2 + pItem->len);\r\n}\r\n}\r\nvoid\r\nvMgrEncodeDisassociation(\r\nPWLAN_FR_DISASSOC pFrame\r\n)\r\n{\r\npFrame->pHdr = (PUWLAN_80211HDR)pFrame->pBuf;\r\npFrame->pwReason = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_DISASSOC_OFF_REASON);\r\npFrame->len = WLAN_HDR_ADDR3_LEN + WLAN_DISASSOC_OFF_REASON + sizeof(*(pFrame->pwReason));\r\n}\r\nvoid\r\nvMgrDecodeDisassociation(\r\nPWLAN_FR_DISASSOC pFrame\r\n)\r\n{\r\npFrame->pHdr = (PUWLAN_80211HDR)pFrame->pBuf;\r\npFrame->pwReason = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_DISASSOC_OFF_REASON);\r\n}\r\nvoid\r\nvMgrEncodeAssocRequest(\r\nPWLAN_FR_ASSOCREQ pFrame\r\n)\r\n{\r\npFrame->pHdr = (PUWLAN_80211HDR)pFrame->pBuf;\r\npFrame->pwCapInfo = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_ASSOCREQ_OFF_CAP_INFO);\r\npFrame->pwListenInterval = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_ASSOCREQ_OFF_LISTEN_INT);\r\npFrame->len = WLAN_HDR_ADDR3_LEN + WLAN_ASSOCREQ_OFF_LISTEN_INT + sizeof(*(pFrame->pwListenInterval));\r\n}\r\nvoid\r\nvMgrDecodeAssocRequest(\r\nPWLAN_FR_ASSOCREQ pFrame\r\n)\r\n{\r\nPWLAN_IE pItem;\r\npFrame->pHdr = (PUWLAN_80211HDR)pFrame->pBuf;\r\npFrame->pwCapInfo = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_ASSOCREQ_OFF_CAP_INFO);\r\npFrame->pwListenInterval = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_ASSOCREQ_OFF_LISTEN_INT);\r\npItem = (PWLAN_IE)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_ASSOCREQ_OFF_SSID);\r\nwhile (((u8 *)pItem) < (pFrame->pBuf + pFrame->len)) {\r\nswitch (pItem->byElementID) {\r\ncase WLAN_EID_SSID:\r\nif (pFrame->pSSID == NULL)\r\npFrame->pSSID = (PWLAN_IE_SSID)pItem;\r\nbreak;\r\ncase WLAN_EID_SUPP_RATES:\r\nif (pFrame->pSuppRates == NULL)\r\npFrame->pSuppRates = (PWLAN_IE_SUPP_RATES)pItem;\r\nbreak;\r\ncase WLAN_EID_RSN:\r\nif (pFrame->pRSN == NULL)\r\npFrame->pRSN = (PWLAN_IE_RSN)pItem;\r\nbreak;\r\ncase WLAN_EID_RSN_WPA:\r\nif (pFrame->pRSNWPA == NULL) {\r\nif (WPAb_Is_RSN((PWLAN_IE_RSN_EXT)pItem) == true)\r\npFrame->pRSNWPA = (PWLAN_IE_RSN_EXT)pItem;\r\n}\r\nbreak;\r\ncase WLAN_EID_EXTSUPP_RATES:\r\nif (pFrame->pExtSuppRates == NULL)\r\npFrame->pExtSuppRates = (PWLAN_IE_SUPP_RATES)pItem;\r\nbreak;\r\ndefault:\r\nDBG_PRT(MSG_LEVEL_DEBUG, KERN_INFO "Unrecognized EID=%dd in assocreq decode.\n",\r\npItem->byElementID);\r\nbreak;\r\n}\r\npItem = (PWLAN_IE)(((u8 *)pItem) + 2 + pItem->len);\r\n}\r\n}\r\nvoid\r\nvMgrEncodeAssocResponse(\r\nPWLAN_FR_ASSOCRESP pFrame\r\n)\r\n{\r\npFrame->pHdr = (PUWLAN_80211HDR)pFrame->pBuf;\r\npFrame->pwCapInfo = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_ASSOCRESP_OFF_CAP_INFO);\r\npFrame->pwStatus = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_ASSOCRESP_OFF_STATUS);\r\npFrame->pwAid = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_ASSOCRESP_OFF_AID);\r\npFrame->len = WLAN_HDR_ADDR3_LEN + WLAN_ASSOCRESP_OFF_AID\r\n+ sizeof(*(pFrame->pwAid));\r\n}\r\nvoid\r\nvMgrDecodeAssocResponse(\r\nPWLAN_FR_ASSOCRESP pFrame\r\n)\r\n{\r\nPWLAN_IE pItem;\r\npFrame->pHdr = (PUWLAN_80211HDR)pFrame->pBuf;\r\npFrame->pwCapInfo = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_ASSOCRESP_OFF_CAP_INFO);\r\npFrame->pwStatus = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_ASSOCRESP_OFF_STATUS);\r\npFrame->pwAid = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_ASSOCRESP_OFF_AID);\r\npFrame->pSuppRates = (PWLAN_IE_SUPP_RATES)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_ASSOCRESP_OFF_SUPP_RATES);\r\npItem = (PWLAN_IE)(pFrame->pSuppRates);\r\npItem = (PWLAN_IE)(((u8 *)pItem) + 2 + pItem->len);\r\nif ((((u8 *)pItem) < (pFrame->pBuf + pFrame->len)) && (pItem->byElementID == WLAN_EID_EXTSUPP_RATES)) {\r\npFrame->pExtSuppRates = (PWLAN_IE_SUPP_RATES)pItem;\r\nDBG_PRT(MSG_LEVEL_DEBUG, KERN_INFO "pFrame->pExtSuppRates=[%p].\n", pItem);\r\n} else\r\npFrame->pExtSuppRates = NULL;\r\n}\r\nvoid\r\nvMgrEncodeReassocRequest(\r\nPWLAN_FR_REASSOCREQ pFrame\r\n)\r\n{\r\npFrame->pHdr = (PUWLAN_80211HDR)pFrame->pBuf;\r\npFrame->pwCapInfo = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_REASSOCREQ_OFF_CAP_INFO);\r\npFrame->pwListenInterval = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_REASSOCREQ_OFF_LISTEN_INT);\r\npFrame->pAddrCurrAP = (PIEEE_ADDR)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_REASSOCREQ_OFF_CURR_AP);\r\npFrame->len = WLAN_HDR_ADDR3_LEN + WLAN_REASSOCREQ_OFF_CURR_AP + sizeof(*(pFrame->pAddrCurrAP));\r\n}\r\nvoid\r\nvMgrDecodeReassocRequest(\r\nPWLAN_FR_REASSOCREQ pFrame\r\n)\r\n{\r\nPWLAN_IE pItem;\r\npFrame->pHdr = (PUWLAN_80211HDR)pFrame->pBuf;\r\npFrame->pwCapInfo = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_REASSOCREQ_OFF_CAP_INFO);\r\npFrame->pwListenInterval = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_REASSOCREQ_OFF_LISTEN_INT);\r\npFrame->pAddrCurrAP = (PIEEE_ADDR)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_REASSOCREQ_OFF_CURR_AP);\r\npItem = (PWLAN_IE)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_REASSOCREQ_OFF_SSID);\r\nwhile (((u8 *)pItem) < (pFrame->pBuf + pFrame->len)) {\r\nswitch (pItem->byElementID) {\r\ncase WLAN_EID_SSID:\r\nif (pFrame->pSSID == NULL)\r\npFrame->pSSID = (PWLAN_IE_SSID)pItem;\r\nbreak;\r\ncase WLAN_EID_SUPP_RATES:\r\nif (pFrame->pSuppRates == NULL)\r\npFrame->pSuppRates = (PWLAN_IE_SUPP_RATES)pItem;\r\nbreak;\r\ncase WLAN_EID_RSN:\r\nif (pFrame->pRSN == NULL)\r\npFrame->pRSN = (PWLAN_IE_RSN)pItem;\r\nbreak;\r\ncase WLAN_EID_RSN_WPA:\r\nif (pFrame->pRSNWPA == NULL)\r\nif (WPAb_Is_RSN((PWLAN_IE_RSN_EXT)pItem) == true)\r\npFrame->pRSNWPA = (PWLAN_IE_RSN_EXT)pItem;\r\nbreak;\r\ncase WLAN_EID_EXTSUPP_RATES:\r\nif (pFrame->pExtSuppRates == NULL)\r\npFrame->pExtSuppRates = (PWLAN_IE_SUPP_RATES)pItem;\r\nbreak;\r\ndefault:\r\nDBG_PRT(MSG_LEVEL_DEBUG, KERN_INFO "Unrecognized EID=%dd in reassocreq decode.\n",\r\npItem->byElementID);\r\nbreak;\r\n}\r\npItem = (PWLAN_IE)(((u8 *)pItem) + 2 + pItem->len);\r\n}\r\n}\r\nvoid\r\nvMgrEncodeProbeRequest(\r\nPWLAN_FR_PROBEREQ pFrame\r\n)\r\n{\r\npFrame->pHdr = (PUWLAN_80211HDR)pFrame->pBuf;\r\npFrame->len = WLAN_HDR_ADDR3_LEN;\r\n}\r\nvoid\r\nvMgrDecodeProbeRequest(\r\nPWLAN_FR_PROBEREQ pFrame\r\n)\r\n{\r\nPWLAN_IE pItem;\r\npFrame->pHdr = (PUWLAN_80211HDR)pFrame->pBuf;\r\npItem = (PWLAN_IE)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3)));\r\nwhile (((u8 *)pItem) < (pFrame->pBuf + pFrame->len)) {\r\nswitch (pItem->byElementID) {\r\ncase WLAN_EID_SSID:\r\nif (pFrame->pSSID == NULL)\r\npFrame->pSSID = (PWLAN_IE_SSID)pItem;\r\nbreak;\r\ncase WLAN_EID_SUPP_RATES:\r\nif (pFrame->pSuppRates == NULL)\r\npFrame->pSuppRates = (PWLAN_IE_SUPP_RATES)pItem;\r\nbreak;\r\ncase WLAN_EID_EXTSUPP_RATES:\r\nif (pFrame->pExtSuppRates == NULL)\r\npFrame->pExtSuppRates = (PWLAN_IE_SUPP_RATES)pItem;\r\nbreak;\r\ndefault:\r\nDBG_PRT(MSG_LEVEL_DEBUG, KERN_INFO "Bad EID=%dd in probereq\n", pItem->byElementID);\r\nbreak;\r\n}\r\npItem = (PWLAN_IE)(((u8 *)pItem) + 2 + pItem->len);\r\n}\r\n}\r\nvoid\r\nvMgrEncodeProbeResponse(\r\nPWLAN_FR_PROBERESP pFrame\r\n)\r\n{\r\npFrame->pHdr = (PUWLAN_80211HDR)pFrame->pBuf;\r\npFrame->pqwTimestamp =\r\n(u64 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3)) +\r\nWLAN_PROBERESP_OFF_TS);\r\npFrame->pwBeaconInterval = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_PROBERESP_OFF_BCN_INT);\r\npFrame->pwCapInfo = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_PROBERESP_OFF_CAP_INFO);\r\npFrame->len = WLAN_HDR_ADDR3_LEN + WLAN_PROBERESP_OFF_CAP_INFO +\r\nsizeof(*(pFrame->pwCapInfo));\r\n}\r\nvoid\r\nvMgrDecodeProbeResponse(\r\nPWLAN_FR_PROBERESP pFrame\r\n)\r\n{\r\nPWLAN_IE pItem;\r\npFrame->pHdr = (PUWLAN_80211HDR)pFrame->pBuf;\r\npFrame->pqwTimestamp =\r\n(u64 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3)) +\r\nWLAN_PROBERESP_OFF_TS);\r\npFrame->pwBeaconInterval = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_PROBERESP_OFF_BCN_INT);\r\npFrame->pwCapInfo = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_PROBERESP_OFF_CAP_INFO);\r\npItem = (PWLAN_IE)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_PROBERESP_OFF_SSID);\r\nwhile (((u8 *)pItem) < (pFrame->pBuf + pFrame->len)) {\r\nswitch (pItem->byElementID) {\r\ncase WLAN_EID_SSID:\r\nif (pFrame->pSSID == NULL)\r\npFrame->pSSID = (PWLAN_IE_SSID)pItem;\r\nbreak;\r\ncase WLAN_EID_SUPP_RATES:\r\nif (pFrame->pSuppRates == NULL)\r\npFrame->pSuppRates = (PWLAN_IE_SUPP_RATES)pItem;\r\nbreak;\r\ncase WLAN_EID_FH_PARMS:\r\nbreak;\r\ncase WLAN_EID_DS_PARMS:\r\nif (pFrame->pDSParms == NULL)\r\npFrame->pDSParms = (PWLAN_IE_DS_PARMS)pItem;\r\nbreak;\r\ncase WLAN_EID_CF_PARMS:\r\nif (pFrame->pCFParms == NULL)\r\npFrame->pCFParms = (PWLAN_IE_CF_PARMS)pItem;\r\nbreak;\r\ncase WLAN_EID_IBSS_PARMS:\r\nif (pFrame->pIBSSParms == NULL)\r\npFrame->pIBSSParms = (PWLAN_IE_IBSS_PARMS)pItem;\r\nbreak;\r\ncase WLAN_EID_RSN:\r\nif (pFrame->pRSN == NULL)\r\npFrame->pRSN = (PWLAN_IE_RSN)pItem;\r\nbreak;\r\ncase WLAN_EID_RSN_WPA:\r\nif (pFrame->pRSNWPA == NULL) {\r\nif (WPAb_Is_RSN((PWLAN_IE_RSN_EXT)pItem) == true)\r\npFrame->pRSNWPA = (PWLAN_IE_RSN_EXT)pItem;\r\n}\r\nbreak;\r\ncase WLAN_EID_ERP:\r\nif (pFrame->pERP == NULL)\r\npFrame->pERP = (PWLAN_IE_ERP)pItem;\r\nbreak;\r\ncase WLAN_EID_EXTSUPP_RATES:\r\nif (pFrame->pExtSuppRates == NULL)\r\npFrame->pExtSuppRates = (PWLAN_IE_SUPP_RATES)pItem;\r\nbreak;\r\ncase WLAN_EID_COUNTRY:\r\nif (pFrame->pIE_Country == NULL)\r\npFrame->pIE_Country = (PWLAN_IE_COUNTRY)pItem;\r\nbreak;\r\ncase WLAN_EID_PWR_CONSTRAINT:\r\nif (pFrame->pIE_PowerConstraint == NULL)\r\npFrame->pIE_PowerConstraint = (PWLAN_IE_PW_CONST)pItem;\r\nbreak;\r\ncase WLAN_EID_CH_SWITCH:\r\nif (pFrame->pIE_CHSW == NULL)\r\npFrame->pIE_CHSW = (PWLAN_IE_CH_SW)pItem;\r\nbreak;\r\ncase WLAN_EID_QUIET:\r\nif (pFrame->pIE_Quiet == NULL)\r\npFrame->pIE_Quiet = (PWLAN_IE_QUIET)pItem;\r\nbreak;\r\ncase WLAN_EID_IBSS_DFS:\r\nif (pFrame->pIE_IBSSDFS == NULL)\r\npFrame->pIE_IBSSDFS = (PWLAN_IE_IBSS_DFS)pItem;\r\nbreak;\r\ndefault:\r\nDBG_PRT(MSG_LEVEL_DEBUG, KERN_INFO "Bad EID=%dd in proberesp\n", pItem->byElementID);\r\nbreak;\r\n}\r\npItem = (PWLAN_IE)(((u8 *)pItem) + 2 + pItem->len);\r\n}\r\n}\r\nvoid\r\nvMgrEncodeAuthen(\r\nPWLAN_FR_AUTHEN pFrame\r\n)\r\n{\r\npFrame->pHdr = (PUWLAN_80211HDR)pFrame->pBuf;\r\npFrame->pwAuthAlgorithm = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_AUTHEN_OFF_AUTH_ALG);\r\npFrame->pwAuthSequence = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_AUTHEN_OFF_AUTH_SEQ);\r\npFrame->pwStatus = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_AUTHEN_OFF_STATUS);\r\npFrame->len = WLAN_HDR_ADDR3_LEN + WLAN_AUTHEN_OFF_STATUS + sizeof(*(pFrame->pwStatus));\r\n}\r\nvoid\r\nvMgrDecodeAuthen(\r\nPWLAN_FR_AUTHEN pFrame\r\n)\r\n{\r\nPWLAN_IE pItem;\r\npFrame->pHdr = (PUWLAN_80211HDR)pFrame->pBuf;\r\npFrame->pwAuthAlgorithm = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_AUTHEN_OFF_AUTH_ALG);\r\npFrame->pwAuthSequence = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_AUTHEN_OFF_AUTH_SEQ);\r\npFrame->pwStatus = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_AUTHEN_OFF_STATUS);\r\npItem = (PWLAN_IE)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_AUTHEN_OFF_CHALLENGE);\r\nif ((((u8 *)pItem) < (pFrame->pBuf + pFrame->len)) && (pItem->byElementID == WLAN_EID_CHALLENGE))\r\npFrame->pChallenge = (PWLAN_IE_CHALLENGE)pItem;\r\n}\r\nvoid\r\nvMgrEncodeDeauthen(\r\nPWLAN_FR_DEAUTHEN pFrame\r\n)\r\n{\r\npFrame->pHdr = (PUWLAN_80211HDR)pFrame->pBuf;\r\npFrame->pwReason = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_DEAUTHEN_OFF_REASON);\r\npFrame->len = WLAN_HDR_ADDR3_LEN + WLAN_DEAUTHEN_OFF_REASON + sizeof(*(pFrame->pwReason));\r\n}\r\nvoid\r\nvMgrDecodeDeauthen(\r\nPWLAN_FR_DEAUTHEN pFrame\r\n)\r\n{\r\npFrame->pHdr = (PUWLAN_80211HDR)pFrame->pBuf;\r\npFrame->pwReason = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_DEAUTHEN_OFF_REASON);\r\n}\r\nvoid\r\nvMgrEncodeReassocResponse(\r\nPWLAN_FR_REASSOCRESP pFrame\r\n)\r\n{\r\npFrame->pHdr = (PUWLAN_80211HDR)pFrame->pBuf;\r\npFrame->pwCapInfo = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_REASSOCRESP_OFF_CAP_INFO);\r\npFrame->pwStatus = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_REASSOCRESP_OFF_STATUS);\r\npFrame->pwAid = (u16 *)(WLAN_HDR_A3_DATA_PTR(&(pFrame->pHdr->sA3))\r\n+ WLAN_REASSOCRESP_OFF_AID);\r\npFrame->len = WLAN_HDR_ADDR3_LEN + WLAN_REASSOCRESP_OFF_AID + sizeof(*(pFrame->pwAid));\r\n}
