u8 _rtw_read8(struct adapter *adapter, u32 addr)\r\n{\r\nu8 r_val;\r\nstruct io_priv *pio_priv = &adapter->iopriv;\r\nstruct intf_hdl *pintfhdl = &(pio_priv->intf);\r\nu8 (*_read8)(struct intf_hdl *pintfhdl, u32 addr);\r\n_func_enter_;\r\n_read8 = pintfhdl->io_ops._read8;\r\nr_val = _read8(pintfhdl, addr);\r\n_func_exit_;\r\nreturn r_val;\r\n}\r\nu16 _rtw_read16(struct adapter *adapter, u32 addr)\r\n{\r\nu16 r_val;\r\nstruct io_priv *pio_priv = &adapter->iopriv;\r\nstruct intf_hdl *pintfhdl = &(pio_priv->intf);\r\nu16 (*_read16)(struct intf_hdl *pintfhdl, u32 addr);\r\n_func_enter_;\r\n_read16 = pintfhdl->io_ops._read16;\r\nr_val = _read16(pintfhdl, addr);\r\n_func_exit_;\r\nreturn r_val;\r\n}\r\nu32 _rtw_read32(struct adapter *adapter, u32 addr)\r\n{\r\nu32 r_val;\r\nstruct io_priv *pio_priv = &adapter->iopriv;\r\nstruct intf_hdl *pintfhdl = &(pio_priv->intf);\r\nu32 (*_read32)(struct intf_hdl *pintfhdl, u32 addr);\r\n_func_enter_;\r\n_read32 = pintfhdl->io_ops._read32;\r\nr_val = _read32(pintfhdl, addr);\r\n_func_exit_;\r\nreturn r_val;\r\n}\r\nint _rtw_write8(struct adapter *adapter, u32 addr, u8 val)\r\n{\r\nstruct io_priv *pio_priv = &adapter->iopriv;\r\nstruct intf_hdl *pintfhdl = &(pio_priv->intf);\r\nint (*_write8)(struct intf_hdl *pintfhdl, u32 addr, u8 val);\r\nint ret;\r\n_func_enter_;\r\n_write8 = pintfhdl->io_ops._write8;\r\nret = _write8(pintfhdl, addr, val);\r\n_func_exit_;\r\nreturn RTW_STATUS_CODE(ret);\r\n}\r\nint _rtw_write16(struct adapter *adapter, u32 addr, u16 val)\r\n{\r\nstruct io_priv *pio_priv = &adapter->iopriv;\r\nstruct intf_hdl *pintfhdl = &(pio_priv->intf);\r\nint (*_write16)(struct intf_hdl *pintfhdl, u32 addr, u16 val);\r\nint ret;\r\n_func_enter_;\r\n_write16 = pintfhdl->io_ops._write16;\r\nret = _write16(pintfhdl, addr, val);\r\n_func_exit_;\r\nreturn RTW_STATUS_CODE(ret);\r\n}\r\nint _rtw_write32(struct adapter *adapter, u32 addr, u32 val)\r\n{\r\nstruct io_priv *pio_priv = &adapter->iopriv;\r\nstruct intf_hdl *pintfhdl = &(pio_priv->intf);\r\nint (*_write32)(struct intf_hdl *pintfhdl, u32 addr, u32 val);\r\nint ret;\r\n_func_enter_;\r\n_write32 = pintfhdl->io_ops._write32;\r\nret = _write32(pintfhdl, addr, val);\r\n_func_exit_;\r\nreturn RTW_STATUS_CODE(ret);\r\n}\r\nint _rtw_writeN(struct adapter *adapter, u32 addr , u32 length , u8 *pdata)\r\n{\r\nstruct io_priv *pio_priv = &adapter->iopriv;\r\nstruct intf_hdl *pintfhdl = (struct intf_hdl *)(&(pio_priv->intf));\r\nint (*_writeN)(struct intf_hdl *pintfhdl, u32 addr, u32 length, u8 *pdata);\r\nint ret;\r\n_func_enter_;\r\n_writeN = pintfhdl->io_ops._writeN;\r\nret = _writeN(pintfhdl, addr, length, pdata);\r\n_func_exit_;\r\nreturn RTW_STATUS_CODE(ret);\r\n}\r\nint _rtw_write8_async(struct adapter *adapter, u32 addr, u8 val)\r\n{\r\nstruct io_priv *pio_priv = &adapter->iopriv;\r\nstruct intf_hdl *pintfhdl = &(pio_priv->intf);\r\nint (*_write8_async)(struct intf_hdl *pintfhdl, u32 addr, u8 val);\r\nint ret;\r\n_func_enter_;\r\n_write8_async = pintfhdl->io_ops._write8_async;\r\nret = _write8_async(pintfhdl, addr, val);\r\n_func_exit_;\r\nreturn RTW_STATUS_CODE(ret);\r\n}\r\nint _rtw_write16_async(struct adapter *adapter, u32 addr, u16 val)\r\n{\r\nstruct io_priv *pio_priv = &adapter->iopriv;\r\nstruct intf_hdl *pintfhdl = &(pio_priv->intf);\r\nint (*_write16_async)(struct intf_hdl *pintfhdl, u32 addr, u16 val);\r\nint ret;\r\n_func_enter_;\r\n_write16_async = pintfhdl->io_ops._write16_async;\r\nret = _write16_async(pintfhdl, addr, val);\r\n_func_exit_;\r\nreturn RTW_STATUS_CODE(ret);\r\n}\r\nint _rtw_write32_async(struct adapter *adapter, u32 addr, u32 val)\r\n{\r\nstruct io_priv *pio_priv = &adapter->iopriv;\r\nstruct intf_hdl *pintfhdl = &(pio_priv->intf);\r\nint (*_write32_async)(struct intf_hdl *pintfhdl, u32 addr, u32 val);\r\nint ret;\r\n_func_enter_;\r\n_write32_async = pintfhdl->io_ops._write32_async;\r\nret = _write32_async(pintfhdl, addr, val);\r\n_func_exit_;\r\nreturn RTW_STATUS_CODE(ret);\r\n}\r\nvoid _rtw_read_mem(struct adapter *adapter, u32 addr, u32 cnt, u8 *pmem)\r\n{\r\nvoid (*_read_mem)(struct intf_hdl *pintfhdl, u32 addr, u32 cnt, u8 *pmem);\r\nstruct io_priv *pio_priv = &adapter->iopriv;\r\nstruct intf_hdl *pintfhdl = &(pio_priv->intf);\r\n_func_enter_;\r\nif (adapter->bDriverStopped || adapter->bSurpriseRemoved) {\r\nRT_TRACE(_module_rtl871x_io_c_, _drv_info_,\r\n("rtw_read_mem:bDriverStopped(%d) OR bSurpriseRemoved(%d)",\r\nadapter->bDriverStopped, adapter->bSurpriseRemoved));\r\nreturn;\r\n}\r\n_read_mem = pintfhdl->io_ops._read_mem;\r\n_read_mem(pintfhdl, addr, cnt, pmem);\r\n_func_exit_;\r\n}\r\nvoid _rtw_write_mem(struct adapter *adapter, u32 addr, u32 cnt, u8 *pmem)\r\n{\r\nvoid (*_write_mem)(struct intf_hdl *pintfhdl, u32 addr, u32 cnt, u8 *pmem);\r\nstruct io_priv *pio_priv = &adapter->iopriv;\r\nstruct intf_hdl *pintfhdl = &(pio_priv->intf);\r\n_func_enter_;\r\n_write_mem = pintfhdl->io_ops._write_mem;\r\n_write_mem(pintfhdl, addr, cnt, pmem);\r\n_func_exit_;\r\n}\r\nvoid _rtw_read_port(struct adapter *adapter, u32 addr, u32 cnt, u8 *pmem)\r\n{\r\nu32 (*_read_port)(struct intf_hdl *pintfhdl, u32 addr, u32 cnt, u8 *pmem);\r\nstruct io_priv *pio_priv = &adapter->iopriv;\r\nstruct intf_hdl *pintfhdl = &(pio_priv->intf);\r\n_func_enter_;\r\nif (adapter->bDriverStopped || adapter->bSurpriseRemoved) {\r\nRT_TRACE(_module_rtl871x_io_c_, _drv_info_,\r\n("rtw_read_port:bDriverStopped(%d) OR bSurpriseRemoved(%d)",\r\nadapter->bDriverStopped, adapter->bSurpriseRemoved));\r\nreturn;\r\n}\r\n_read_port = pintfhdl->io_ops._read_port;\r\n_read_port(pintfhdl, addr, cnt, pmem);\r\n_func_exit_;\r\n}\r\nvoid _rtw_read_port_cancel(struct adapter *adapter)\r\n{\r\nvoid (*_read_port_cancel)(struct intf_hdl *pintfhdl);\r\nstruct io_priv *pio_priv = &adapter->iopriv;\r\nstruct intf_hdl *pintfhdl = &(pio_priv->intf);\r\n_read_port_cancel = pintfhdl->io_ops._read_port_cancel;\r\nif (_read_port_cancel)\r\n_read_port_cancel(pintfhdl);\r\n}\r\nu32 _rtw_write_port(struct adapter *adapter, u32 addr, u32 cnt, u8 *pmem)\r\n{\r\nu32 (*_write_port)(struct intf_hdl *pintfhdl, u32 addr, u32 cnt, u8 *pmem);\r\nstruct io_priv *pio_priv = &adapter->iopriv;\r\nstruct intf_hdl *pintfhdl = &(pio_priv->intf);\r\nu32 ret = _SUCCESS;\r\n_func_enter_;\r\n_write_port = pintfhdl->io_ops._write_port;\r\nret = _write_port(pintfhdl, addr, cnt, pmem);\r\n_func_exit_;\r\nreturn ret;\r\n}\r\nu32 _rtw_write_port_and_wait(struct adapter *adapter, u32 addr, u32 cnt, u8 *pmem, int timeout_ms)\r\n{\r\nint ret = _SUCCESS;\r\nstruct xmit_buf *pxmitbuf = (struct xmit_buf *)pmem;\r\nstruct submit_ctx sctx;\r\nrtw_sctx_init(&sctx, timeout_ms);\r\npxmitbuf->sctx = &sctx;\r\nret = _rtw_write_port(adapter, addr, cnt, pmem);\r\nif (ret == _SUCCESS)\r\nret = rtw_sctx_wait(&sctx);\r\nreturn ret;\r\n}\r\nvoid _rtw_write_port_cancel(struct adapter *adapter)\r\n{\r\nvoid (*_write_port_cancel)(struct intf_hdl *pintfhdl);\r\nstruct io_priv *pio_priv = &adapter->iopriv;\r\nstruct intf_hdl *pintfhdl = &(pio_priv->intf);\r\n_write_port_cancel = pintfhdl->io_ops._write_port_cancel;\r\nif (_write_port_cancel)\r\n_write_port_cancel(pintfhdl);\r\n}\r\nint rtw_init_io_priv(struct adapter *padapter, void (*set_intf_ops)(struct _io_ops *pops))\r\n{\r\nstruct io_priv *piopriv = &padapter->iopriv;\r\nstruct intf_hdl *pintf = &piopriv->intf;\r\nif (set_intf_ops == NULL)\r\nreturn _FAIL;\r\npiopriv->padapter = padapter;\r\npintf->padapter = padapter;\r\npintf->pintf_dev = adapter_to_dvobj(padapter);\r\nset_intf_ops(&pintf->io_ops);\r\nreturn _SUCCESS;\r\n}
