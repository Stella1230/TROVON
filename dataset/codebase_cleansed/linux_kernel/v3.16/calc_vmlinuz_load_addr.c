int main(int argc, char *argv[])\r\n{\r\nunsigned long long vmlinux_size, vmlinux_load_addr, vmlinuz_load_addr;\r\nstruct stat sb;\r\nif (argc != 3) {\r\nfprintf(stderr, "Usage: %s <pathname> <vmlinux_load_addr>\n",\r\nargv[0]);\r\nreturn EXIT_FAILURE;\r\n}\r\nif (stat(argv[1], &sb) == -1) {\r\nperror("stat");\r\nreturn EXIT_FAILURE;\r\n}\r\nerrno = 0;\r\nif (sscanf(argv[2], "%llx", &vmlinux_load_addr) != 1) {\r\nif (errno != 0)\r\nperror("sscanf");\r\nelse\r\nfprintf(stderr, "No matching characters\n");\r\nreturn EXIT_FAILURE;\r\n}\r\nvmlinux_size = (uint64_t)sb.st_size;\r\nvmlinuz_load_addr = vmlinux_load_addr + vmlinux_size;\r\nvmlinuz_load_addr += (16 - vmlinux_size % 16);\r\nprintf("0x%llx\n", vmlinuz_load_addr);\r\nreturn EXIT_SUCCESS;\r\n}
