int __init mx21_clocks_init(unsigned long lref, unsigned long href)\r\n{\r\nint i;\r\nclk[ckil] = imx_clk_fixed("ckil", lref);\r\nclk[ckih] = imx_clk_fixed("ckih", href);\r\nclk[fpm] = imx_clk_fixed_factor("fpm", "ckil", 512, 1);\r\nclk[mpll_sel] = imx_clk_mux("mpll_sel", CCM_CSCR, 16, 1, mpll_sel_clks,\r\nARRAY_SIZE(mpll_sel_clks));\r\nclk[spll_sel] = imx_clk_mux("spll_sel", CCM_CSCR, 17, 1, spll_sel_clks,\r\nARRAY_SIZE(spll_sel_clks));\r\nclk[mpll] = imx_clk_pllv1("mpll", "mpll_sel", CCM_MPCTL0);\r\nclk[spll] = imx_clk_pllv1("spll", "spll_sel", CCM_SPCTL0);\r\nclk[fclk] = imx_clk_divider("fclk", "mpll", CCM_CSCR, 29, 3);\r\nclk[hclk] = imx_clk_divider("hclk", "fclk", CCM_CSCR, 10, 4);\r\nclk[ipg] = imx_clk_divider("ipg", "hclk", CCM_CSCR, 9, 1);\r\nclk[per1] = imx_clk_divider("per1", "mpll", CCM_PCDR1, 0, 6);\r\nclk[per2] = imx_clk_divider("per2", "mpll", CCM_PCDR1, 8, 6);\r\nclk[per3] = imx_clk_divider("per3", "mpll", CCM_PCDR1, 16, 6);\r\nclk[per4] = imx_clk_divider("per4", "mpll", CCM_PCDR1, 24, 6);\r\nclk[uart1_ipg_gate] = imx_clk_gate("uart1_ipg_gate", "ipg", CCM_PCCR0, 0);\r\nclk[uart2_ipg_gate] = imx_clk_gate("uart2_ipg_gate", "ipg", CCM_PCCR0, 1);\r\nclk[uart3_ipg_gate] = imx_clk_gate("uart3_ipg_gate", "ipg", CCM_PCCR0, 2);\r\nclk[uart4_ipg_gate] = imx_clk_gate("uart4_ipg_gate", "ipg", CCM_PCCR0, 3);\r\nclk[gpt1_ipg_gate] = imx_clk_gate("gpt1_ipg_gate", "ipg", CCM_PCCR1, 25);\r\nclk[gpt2_ipg_gate] = imx_clk_gate("gpt2_ipg_gate", "ipg", CCM_PCCR1, 26);\r\nclk[gpt3_ipg_gate] = imx_clk_gate("gpt3_ipg_gate", "ipg", CCM_PCCR1, 27);\r\nclk[pwm_ipg_gate] = imx_clk_gate("pwm_ipg_gate", "ipg", CCM_PCCR1, 28);\r\nclk[sdhc1_ipg_gate] = imx_clk_gate("sdhc1_ipg_gate", "ipg", CCM_PCCR0, 9);\r\nclk[sdhc2_ipg_gate] = imx_clk_gate("sdhc2_ipg_gate", "ipg", CCM_PCCR0, 10);\r\nclk[lcdc_ipg_gate] = imx_clk_gate("lcdc_ipg_gate", "ipg", CCM_PCCR0, 18);\r\nclk[lcdc_hclk_gate] = imx_clk_gate("lcdc_hclk_gate", "hclk", CCM_PCCR0, 26);\r\nclk[cspi3_ipg_gate] = imx_clk_gate("cspi3_ipg_gate", "ipg", CCM_PCCR1, 23);\r\nclk[cspi2_ipg_gate] = imx_clk_gate("cspi2_ipg_gate", "ipg", CCM_PCCR0, 5);\r\nclk[cspi1_ipg_gate] = imx_clk_gate("cspi1_ipg_gate", "ipg", CCM_PCCR0, 4);\r\nclk[per4_gate] = imx_clk_gate("per4_gate", "per4", CCM_PCCR0, 22);\r\nclk[csi_hclk_gate] = imx_clk_gate("csi_hclk_gate", "hclk", CCM_PCCR0, 31);\r\nclk[usb_div] = imx_clk_divider("usb_div", "spll", CCM_CSCR, 26, 3);\r\nclk[usb_gate] = imx_clk_gate("usb_gate", "usb_div", CCM_PCCR0, 14);\r\nclk[usb_hclk_gate] = imx_clk_gate("usb_hclk_gate", "hclk", CCM_PCCR0, 24);\r\nclk[ssi1_gate] = imx_clk_gate("ssi1_gate", "ipg", CCM_PCCR0, 6);\r\nclk[ssi2_gate] = imx_clk_gate("ssi2_gate", "ipg", CCM_PCCR0, 7);\r\nclk[nfc_div] = imx_clk_divider("nfc_div", "ipg", CCM_PCDR0, 12, 4);\r\nclk[nfc_gate] = imx_clk_gate("nfc_gate", "nfc_div", CCM_PCCR0, 19);\r\nclk[dma_gate] = imx_clk_gate("dma_gate", "ipg", CCM_PCCR0, 13);\r\nclk[dma_hclk_gate] = imx_clk_gate("dma_hclk_gate", "hclk", CCM_PCCR0, 30);\r\nclk[brom_gate] = imx_clk_gate("brom_gate", "hclk", CCM_PCCR0, 28);\r\nclk[emma_gate] = imx_clk_gate("emma_gate", "ipg", CCM_PCCR0, 15);\r\nclk[emma_hclk_gate] = imx_clk_gate("emma_hclk_gate", "hclk", CCM_PCCR0, 27);\r\nclk[slcdc_gate] = imx_clk_gate("slcdc_gate", "ipg", CCM_PCCR0, 25);\r\nclk[slcdc_hclk_gate] = imx_clk_gate("slcdc_hclk_gate", "hclk", CCM_PCCR0, 21);\r\nclk[wdog_gate] = imx_clk_gate("wdog_gate", "ipg", CCM_PCCR1, 24);\r\nclk[gpio_gate] = imx_clk_gate("gpio_gate", "ipg", CCM_PCCR0, 11);\r\nclk[i2c_gate] = imx_clk_gate("i2c_gate", "ipg", CCM_PCCR0, 12);\r\nclk[kpp_gate] = imx_clk_gate("kpp_gate", "ipg", CCM_PCCR1, 30);\r\nclk[owire_gate] = imx_clk_gate("owire_gate", "ipg", CCM_PCCR1, 31);\r\nclk[rtc_gate] = imx_clk_gate("rtc_gate", "ipg", CCM_PCCR1, 29);\r\nfor (i = 0; i < ARRAY_SIZE(clk); i++)\r\nif (IS_ERR(clk[i]))\r\npr_err("i.MX21 clk %d: register failed with %ld\n",\r\ni, PTR_ERR(clk[i]));\r\nclk_register_clkdev(clk[per1], "per1", NULL);\r\nclk_register_clkdev(clk[per2], "per2", NULL);\r\nclk_register_clkdev(clk[per3], "per3", NULL);\r\nclk_register_clkdev(clk[per4], "per4", NULL);\r\nclk_register_clkdev(clk[per1], "per", "imx21-uart.0");\r\nclk_register_clkdev(clk[uart1_ipg_gate], "ipg", "imx21-uart.0");\r\nclk_register_clkdev(clk[per1], "per", "imx21-uart.1");\r\nclk_register_clkdev(clk[uart2_ipg_gate], "ipg", "imx21-uart.1");\r\nclk_register_clkdev(clk[per1], "per", "imx21-uart.2");\r\nclk_register_clkdev(clk[uart3_ipg_gate], "ipg", "imx21-uart.2");\r\nclk_register_clkdev(clk[per1], "per", "imx21-uart.3");\r\nclk_register_clkdev(clk[uart4_ipg_gate], "ipg", "imx21-uart.3");\r\nclk_register_clkdev(clk[gpt1_ipg_gate], "ipg", "imx-gpt.0");\r\nclk_register_clkdev(clk[per1], "per", "imx-gpt.0");\r\nclk_register_clkdev(clk[gpt2_ipg_gate], "ipg", "imx-gpt.1");\r\nclk_register_clkdev(clk[per1], "per", "imx-gpt.1");\r\nclk_register_clkdev(clk[gpt3_ipg_gate], "ipg", "imx-gpt.2");\r\nclk_register_clkdev(clk[per1], "per", "imx-gpt.2");\r\nclk_register_clkdev(clk[per2], "per", "imx21-cspi.0");\r\nclk_register_clkdev(clk[cspi1_ipg_gate], "ipg", "imx21-cspi.0");\r\nclk_register_clkdev(clk[per2], "per", "imx21-cspi.1");\r\nclk_register_clkdev(clk[cspi2_ipg_gate], "ipg", "imx21-cspi.1");\r\nclk_register_clkdev(clk[per2], "per", "imx21-cspi.2");\r\nclk_register_clkdev(clk[cspi3_ipg_gate], "ipg", "imx21-cspi.2");\r\nclk_register_clkdev(clk[per3], "per", "imx21-fb.0");\r\nclk_register_clkdev(clk[lcdc_ipg_gate], "ipg", "imx21-fb.0");\r\nclk_register_clkdev(clk[lcdc_hclk_gate], "ahb", "imx21-fb.0");\r\nclk_register_clkdev(clk[usb_gate], "per", "imx21-hcd.0");\r\nclk_register_clkdev(clk[usb_hclk_gate], "ahb", "imx21-hcd.0");\r\nclk_register_clkdev(clk[nfc_gate], NULL, "imx21-nand.0");\r\nclk_register_clkdev(clk[dma_hclk_gate], "ahb", "imx21-dma");\r\nclk_register_clkdev(clk[dma_gate], "ipg", "imx21-dma");\r\nclk_register_clkdev(clk[wdog_gate], NULL, "imx2-wdt.0");\r\nclk_register_clkdev(clk[i2c_gate], NULL, "imx21-i2c.0");\r\nclk_register_clkdev(clk[kpp_gate], NULL, "mxc-keypad");\r\nclk_register_clkdev(clk[owire_gate], NULL, "mxc_w1.0");\r\nclk_register_clkdev(clk[brom_gate], "brom", NULL);\r\nclk_register_clkdev(clk[emma_gate], "emma", NULL);\r\nclk_register_clkdev(clk[slcdc_gate], "slcdc", NULL);\r\nclk_register_clkdev(clk[gpio_gate], "gpio", NULL);\r\nclk_register_clkdev(clk[rtc_gate], "rtc", NULL);\r\nclk_register_clkdev(clk[csi_hclk_gate], "csi", NULL);\r\nclk_register_clkdev(clk[ssi1_gate], "ssi1", NULL);\r\nclk_register_clkdev(clk[ssi2_gate], "ssi2", NULL);\r\nclk_register_clkdev(clk[sdhc1_ipg_gate], "sdhc1", NULL);\r\nclk_register_clkdev(clk[sdhc2_ipg_gate], "sdhc2", NULL);\r\nmxc_timer_init(MX21_IO_ADDRESS(MX21_GPT1_BASE_ADDR), MX21_INT_GPT1);\r\nreturn 0;\r\n}
