static int cgroup_mt_check(const struct xt_mtchk_param *par)\r\n{\r\nstruct xt_cgroup_info *info = par->matchinfo;\r\nif (info->invert & ~1)\r\nreturn -EINVAL;\r\nreturn info->id ? 0 : -EINVAL;\r\n}\r\nstatic bool\r\ncgroup_mt(const struct sk_buff *skb, struct xt_action_param *par)\r\n{\r\nconst struct xt_cgroup_info *info = par->matchinfo;\r\nif (skb->sk == NULL)\r\nreturn false;\r\nreturn (info->id == skb->sk->sk_classid) ^ info->invert;\r\n}\r\nstatic int __init cgroup_mt_init(void)\r\n{\r\nreturn xt_register_match(&cgroup_mt_reg);\r\n}\r\nstatic void __exit cgroup_mt_exit(void)\r\n{\r\nxt_unregister_match(&cgroup_mt_reg);\r\n}
