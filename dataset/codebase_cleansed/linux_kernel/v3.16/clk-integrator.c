static void __init of_integrator_cm_osc_setup(struct device_node *np)\r\n{\r\nstruct clk *clk = ERR_PTR(-EINVAL);\r\nconst char *clk_name = np->name;\r\nconst struct clk_icst_desc *desc = &cm_auxosc_desc;\r\nconst char *parent_name;\r\nif (!cm_base) {\r\nstruct device_node *parent;\r\nparent = of_get_parent(np);\r\nif (!np) {\r\npr_err("no parent on core module clock\n");\r\nreturn;\r\n}\r\ncm_base = of_iomap(parent, 0);\r\nif (!cm_base) {\r\npr_err("could not remap core module base\n");\r\nreturn;\r\n}\r\n}\r\nparent_name = of_clk_get_parent_name(np, 0);\r\nclk = icst_clk_register(NULL, desc, clk_name, parent_name, cm_base);\r\nif (!IS_ERR(clk))\r\nof_clk_add_provider(np, of_clk_src_simple_get, clk);\r\n}
