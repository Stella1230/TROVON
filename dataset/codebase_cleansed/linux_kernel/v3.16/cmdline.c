static char * __init move_firmware_args(char* cp)\r\n{\r\nchar *s;\r\nint actr, i;\r\nactr = 1;\r\nwhile (actr < prom_argc) {\r\nfor(i = 0; i < ARRAY_SIZE(used_arc); i++) {\r\nint len = strlen(used_arc[i][0]);\r\nif (!strncmp(prom_argv(actr), used_arc[i][0], len)) {\r\nstrcat(cp, used_arc[i][1]);\r\ncp += strlen(used_arc[i][1]);\r\ns = strchr(prom_argv(actr), '=');\r\nif (s) {\r\ns++;\r\nstrcpy(cp, s);\r\ncp += strlen(s);\r\n}\r\n*cp++ = ' ';\r\nbreak;\r\n}\r\n}\r\nactr++;\r\n}\r\nreturn cp;\r\n}\r\nvoid __init prom_init_cmdline(void)\r\n{\r\nchar *cp;\r\nint actr, i;\r\nactr = 1;\r\ncp = arcs_cmdline;\r\ncp = move_firmware_args(cp);\r\nwhile (actr < prom_argc) {\r\nfor (i = 0; i < ARRAY_SIZE(ignored); i++) {\r\nint len = strlen(ignored[i]);\r\nif (!strncmp(prom_argv(actr), ignored[i], len))\r\ngoto pic_cont;\r\n}\r\nstrcpy(cp, prom_argv(actr));\r\ncp += strlen(prom_argv(actr));\r\n*cp++ = ' ';\r\npic_cont:\r\nactr++;\r\n}\r\nif (cp != arcs_cmdline)\r\n--cp;\r\n*cp = '\0';\r\n#ifdef DEBUG_CMDLINE\r\nprintk(KERN_DEBUG "prom cmdline: %s\n", arcs_cmdline);\r\n#endif\r\n}
