static void __init of_ti_fixed_factor_clk_setup(struct device_node *node)\r\n{\r\nstruct clk *clk;\r\nconst char *clk_name = node->name;\r\nconst char *parent_name;\r\nu32 div, mult;\r\nu32 flags = 0;\r\nif (of_property_read_u32(node, "ti,clock-div", &div)) {\r\npr_err("%s must have a clock-div property\n", node->name);\r\nreturn;\r\n}\r\nif (of_property_read_u32(node, "ti,clock-mult", &mult)) {\r\npr_err("%s must have a clock-mult property\n", node->name);\r\nreturn;\r\n}\r\nif (of_property_read_bool(node, "ti,set-rate-parent"))\r\nflags |= CLK_SET_RATE_PARENT;\r\nparent_name = of_clk_get_parent_name(node, 0);\r\nclk = clk_register_fixed_factor(NULL, clk_name, parent_name, flags,\r\nmult, div);\r\nif (!IS_ERR(clk)) {\r\nof_clk_add_provider(node, of_clk_src_simple_get, clk);\r\nof_ti_clk_autoidle_setup(node);\r\n}\r\n}
