static ssize_t\r\nikconfig_read_current(struct file *file, char __user *buf,\r\nsize_t len, loff_t * offset)\r\n{\r\nreturn simple_read_from_buffer(buf, len, offset,\r\nkernel_config_data + MAGIC_SIZE,\r\nkernel_config_data_size);\r\n}\r\nstatic int __init ikconfig_init(void)\r\n{\r\nstruct proc_dir_entry *entry;\r\nentry = proc_create("config.gz", S_IFREG | S_IRUGO, NULL,\r\n&ikconfig_file_ops);\r\nif (!entry)\r\nreturn -ENOMEM;\r\nproc_set_size(entry, kernel_config_data_size);\r\nreturn 0;\r\n}\r\nstatic void __exit ikconfig_cleanup(void)\r\n{\r\nremove_proc_entry("config.gz", NULL);\r\n}
