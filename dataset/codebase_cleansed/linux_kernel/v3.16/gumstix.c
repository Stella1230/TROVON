static void __init gumstix_mmc_init(void)\r\n{\r\npxa_set_mci_info(&gumstix_mci_platform_data);\r\n}\r\nstatic void __init gumstix_mmc_init(void)\r\n{\r\npr_debug("Gumstix mmc disabled\n");\r\n}\r\nstatic void __init gumstix_udc_init(void)\r\n{\r\nplatform_device_register(&gumstix_gpio_vbus);\r\n}\r\nstatic void gumstix_udc_init(void)\r\n{\r\npr_debug("Gumstix udc is disabled\n");\r\n}\r\nstatic void gumstix_setup_bt_clock(void)\r\n{\r\nint timeout = 500;\r\nif (!(OSCC & OSCC_OOK))\r\npr_warning("32kHz clock was not on. Bootloader may need to "\r\n"be updated\n");\r\nelse\r\nreturn;\r\nOSCC |= OSCC_OON;\r\ndo {\r\nif (OSCC & OSCC_OOK)\r\nbreak;\r\nudelay(1);\r\n} while (--timeout);\r\nif (!timeout)\r\npr_err("Failed to start 32kHz clock\n");\r\n}\r\nstatic void __init gumstix_bluetooth_init(void)\r\n{\r\nint err;\r\ngumstix_setup_bt_clock();\r\nerr = gpio_request(GPIO_GUMSTIX_BTRESET, "BTRST");\r\nif (err) {\r\npr_err("gumstix: failed request gpio for bluetooth reset\n");\r\nreturn;\r\n}\r\nerr = gpio_direction_output(GPIO_GUMSTIX_BTRESET, 1);\r\nif (err) {\r\npr_err("gumstix: can't reset bluetooth\n");\r\nreturn;\r\n}\r\ngpio_set_value(GPIO_GUMSTIX_BTRESET, 0);\r\nudelay(100);\r\ngpio_set_value(GPIO_GUMSTIX_BTRESET, 1);\r\n}\r\nstatic void gumstix_bluetooth_init(void)\r\n{\r\npr_debug("Gumstix Bluetooth is disabled\n");\r\n}\r\nstatic void __init carrier_board_init(void)\r\n{\r\nam200_init();\r\nam300_init();\r\n}\r\nstatic void __init gumstix_init(void)\r\n{\r\npxa2xx_mfp_config(ARRAY_AND_SIZE(gumstix_pin_config));\r\npxa_set_ffuart_info(NULL);\r\npxa_set_btuart_info(NULL);\r\npxa_set_stuart_info(NULL);\r\npxa_set_hwuart_info(NULL);\r\ngumstix_bluetooth_init();\r\ngumstix_udc_init();\r\ngumstix_mmc_init();\r\n(void) platform_add_devices(devices, ARRAY_SIZE(devices));\r\ncarrier_board_init();\r\n}
