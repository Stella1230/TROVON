static int xen_dbgp_op(struct usb_hcd *hcd, int op)\r\n{\r\n#ifdef CONFIG_PCI\r\nconst struct device *ctrlr = hcd_to_bus(hcd)->controller;\r\n#endif\r\nstruct physdev_dbgp_op dbgp;\r\nif (!xen_initial_domain())\r\nreturn 0;\r\ndbgp.op = op;\r\n#ifdef CONFIG_PCI\r\nif (dev_is_pci(ctrlr)) {\r\nconst struct pci_dev *pdev = to_pci_dev(ctrlr);\r\ndbgp.u.pci.seg = pci_domain_nr(pdev->bus);\r\ndbgp.u.pci.bus = pdev->bus->number;\r\ndbgp.u.pci.devfn = pdev->devfn;\r\ndbgp.bus = PHYSDEVOP_DBGP_BUS_PCI;\r\n} else\r\n#endif\r\ndbgp.bus = PHYSDEVOP_DBGP_BUS_UNKNOWN;\r\nreturn HYPERVISOR_physdev_op(PHYSDEVOP_dbgp_op, &dbgp);\r\n}\r\nint xen_dbgp_reset_prep(struct usb_hcd *hcd)\r\n{\r\nreturn xen_dbgp_op(hcd, PHYSDEVOP_DBGP_RESET_PREPARE);\r\n}\r\nint xen_dbgp_external_startup(struct usb_hcd *hcd)\r\n{\r\nreturn xen_dbgp_op(hcd, PHYSDEVOP_DBGP_RESET_DONE);\r\n}
