static u8\r\nnvbios_ramcfg_strap(struct nouveau_subdev *subdev)\r\n{\r\nreturn (nv_rd32(subdev, 0x101000) & 0x0000003c) >> 2;\r\n}\r\nu8\r\nnvbios_ramcfg_count(struct nouveau_bios *bios)\r\n{\r\nstruct bit_entry bit_M;\r\nif (!bit_entry(bios, 'M', &bit_M)) {\r\nif (bit_M.version == 1 && bit_M.length >= 5)\r\nreturn nv_ro08(bios, bit_M.offset + 2);\r\nif (bit_M.version == 2 && bit_M.length >= 3)\r\nreturn nv_ro08(bios, bit_M.offset + 0);\r\n}\r\nreturn 0x00;\r\n}\r\nu8\r\nnvbios_ramcfg_index(struct nouveau_subdev *subdev)\r\n{\r\nstruct nouveau_bios *bios = nouveau_bios(subdev);\r\nu8 strap = nvbios_ramcfg_strap(subdev);\r\nu32 xlat = 0x00000000;\r\nstruct bit_entry bit_M;\r\nif (!bit_entry(bios, 'M', &bit_M)) {\r\nif (bit_M.version == 1 && bit_M.length >= 5)\r\nxlat = nv_ro16(bios, bit_M.offset + 3);\r\nif (bit_M.version == 2 && bit_M.length >= 3)\r\nxlat = nv_ro16(bios, bit_M.offset + 1);\r\n}\r\nif (xlat)\r\nstrap = nv_ro08(bios, xlat + strap);\r\nreturn strap;\r\n}
