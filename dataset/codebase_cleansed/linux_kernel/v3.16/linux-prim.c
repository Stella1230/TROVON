void\r\nadd_wait_queue_exclusive_head(wait_queue_head_t *waitq, wait_queue_t *link)\r\n{\r\nunsigned long flags;\r\nspin_lock_irqsave(&waitq->lock, flags);\r\n__add_wait_queue_exclusive(waitq, link);\r\nspin_unlock_irqrestore(&waitq->lock, flags);\r\n}\r\nvoid cfs_init_timer(struct timer_list *t)\r\n{\r\ninit_timer(t);\r\n}\r\nvoid cfs_timer_init(struct timer_list *t, cfs_timer_func_t *func, void *arg)\r\n{\r\ninit_timer(t);\r\nt->function = func;\r\nt->data = (unsigned long)arg;\r\n}\r\nvoid cfs_timer_done(struct timer_list *t)\r\n{\r\nreturn;\r\n}\r\nvoid cfs_timer_arm(struct timer_list *t, cfs_time_t deadline)\r\n{\r\nmod_timer(t, deadline);\r\n}\r\nvoid cfs_timer_disarm(struct timer_list *t)\r\n{\r\ndel_timer(t);\r\n}\r\nint cfs_timer_is_armed(struct timer_list *t)\r\n{\r\nreturn timer_pending(t);\r\n}\r\ncfs_time_t cfs_timer_deadline(struct timer_list *t)\r\n{\r\nreturn t->expires;\r\n}\r\nvoid cfs_enter_debugger(void)\r\n{\r\n#if defined(CONFIG_KGDB)\r\n#else\r\n#endif\r\n}\r\nsigset_t\r\ncfs_block_allsigs(void)\r\n{\r\nunsigned long flags;\r\nsigset_t old;\r\nSIGNAL_MASK_LOCK(current, flags);\r\nold = current->blocked;\r\nsigfillset(&current->blocked);\r\nrecalc_sigpending();\r\nSIGNAL_MASK_UNLOCK(current, flags);\r\nreturn old;\r\n}\r\nsigset_t cfs_block_sigs(unsigned long sigs)\r\n{\r\nunsigned long flags;\r\nsigset_t old;\r\nSIGNAL_MASK_LOCK(current, flags);\r\nold = current->blocked;\r\nsigaddsetmask(&current->blocked, sigs);\r\nrecalc_sigpending();\r\nSIGNAL_MASK_UNLOCK(current, flags);\r\nreturn old;\r\n}\r\nsigset_t cfs_block_sigsinv(unsigned long sigs)\r\n{\r\nunsigned long flags;\r\nsigset_t old;\r\nSIGNAL_MASK_LOCK(current, flags);\r\nold = current->blocked;\r\nsigaddsetmask(&current->blocked, ~sigs);\r\nrecalc_sigpending();\r\nSIGNAL_MASK_UNLOCK(current, flags);\r\nreturn old;\r\n}\r\nvoid\r\ncfs_restore_sigs (sigset_t old)\r\n{\r\nunsigned long flags;\r\nSIGNAL_MASK_LOCK(current, flags);\r\ncurrent->blocked = old;\r\nrecalc_sigpending();\r\nSIGNAL_MASK_UNLOCK(current, flags);\r\n}\r\nint\r\ncfs_signal_pending(void)\r\n{\r\nreturn signal_pending(current);\r\n}\r\nvoid\r\ncfs_clear_sigpending(void)\r\n{\r\nunsigned long flags;\r\nSIGNAL_MASK_LOCK(current, flags);\r\nclear_tsk_thread_flag(current, TIF_SIGPENDING);\r\nSIGNAL_MASK_UNLOCK(current, flags);\r\n}\r\nint\r\nlibcfs_arch_init(void)\r\n{\r\nreturn 0;\r\n}\r\nvoid\r\nlibcfs_arch_cleanup(void)\r\n{\r\nreturn;\r\n}
