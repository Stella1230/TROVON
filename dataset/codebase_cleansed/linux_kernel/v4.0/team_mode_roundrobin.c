static struct rr_priv *rr_priv(struct team *team)\r\n{\r\nreturn (struct rr_priv *) &team->mode_priv;\r\n}\r\nstatic bool rr_transmit(struct team *team, struct sk_buff *skb)\r\n{\r\nstruct team_port *port;\r\nint port_index;\r\nport_index = team_num_to_port_index(team,\r\nrr_priv(team)->sent_packets++);\r\nport = team_get_port_by_index_rcu(team, port_index);\r\nif (unlikely(!port))\r\ngoto drop;\r\nport = team_get_first_port_txable_rcu(team, port);\r\nif (unlikely(!port))\r\ngoto drop;\r\nif (team_dev_queue_xmit(team, port, skb))\r\nreturn false;\r\nreturn true;\r\ndrop:\r\ndev_kfree_skb_any(skb);\r\nreturn false;\r\n}\r\nstatic int __init rr_init_module(void)\r\n{\r\nreturn team_mode_register(&rr_mode);\r\n}\r\nstatic void __exit rr_cleanup_module(void)\r\n{\r\nteam_mode_unregister(&rr_mode);\r\n}
