static unsigned int nft_nat_do_chain(const struct nf_hook_ops *ops,\r\nstruct sk_buff *skb,\r\nconst struct net_device *in,\r\nconst struct net_device *out,\r\nstruct nf_conn *ct)\r\n{\r\nstruct nft_pktinfo pkt;\r\nnft_set_pktinfo_ipv6(&pkt, ops, skb, in, out);\r\nreturn nft_do_chain(&pkt, ops);\r\n}\r\nstatic unsigned int nft_nat_ipv6_fn(const struct nf_hook_ops *ops,\r\nstruct sk_buff *skb,\r\nconst struct net_device *in,\r\nconst struct net_device *out,\r\nint (*okfn)(struct sk_buff *))\r\n{\r\nreturn nf_nat_ipv6_fn(ops, skb, in, out, nft_nat_do_chain);\r\n}\r\nstatic unsigned int nft_nat_ipv6_in(const struct nf_hook_ops *ops,\r\nstruct sk_buff *skb,\r\nconst struct net_device *in,\r\nconst struct net_device *out,\r\nint (*okfn)(struct sk_buff *))\r\n{\r\nreturn nf_nat_ipv6_in(ops, skb, in, out, nft_nat_do_chain);\r\n}\r\nstatic unsigned int nft_nat_ipv6_out(const struct nf_hook_ops *ops,\r\nstruct sk_buff *skb,\r\nconst struct net_device *in,\r\nconst struct net_device *out,\r\nint (*okfn)(struct sk_buff *))\r\n{\r\nreturn nf_nat_ipv6_out(ops, skb, in, out, nft_nat_do_chain);\r\n}\r\nstatic unsigned int nft_nat_ipv6_local_fn(const struct nf_hook_ops *ops,\r\nstruct sk_buff *skb,\r\nconst struct net_device *in,\r\nconst struct net_device *out,\r\nint (*okfn)(struct sk_buff *))\r\n{\r\nreturn nf_nat_ipv6_local_fn(ops, skb, in, out, nft_nat_do_chain);\r\n}\r\nstatic int __init nft_chain_nat_ipv6_init(void)\r\n{\r\nint err;\r\nerr = nft_register_chain_type(&nft_chain_nat_ipv6);\r\nif (err < 0)\r\nreturn err;\r\nreturn 0;\r\n}\r\nstatic void __exit nft_chain_nat_ipv6_exit(void)\r\n{\r\nnft_unregister_chain_type(&nft_chain_nat_ipv6);\r\n}
