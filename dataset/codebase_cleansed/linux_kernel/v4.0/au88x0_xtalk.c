static void\r\nvortex_XtalkHw_SetLeftEQ(vortex_t * vortex, short arg_0, short arg_4,\r\nxtalk_coefs_t const coefs)\r\n{\r\nint i;\r\nfor (i = 0; i < 5; i++) {\r\nhwwrite(vortex->mmio, 0x24200 + i * 0x24, coefs[i][0]);\r\nhwwrite(vortex->mmio, 0x24204 + i * 0x24, coefs[i][1]);\r\nhwwrite(vortex->mmio, 0x24208 + i * 0x24, coefs[i][2]);\r\nhwwrite(vortex->mmio, 0x2420c + i * 0x24, coefs[i][3]);\r\nhwwrite(vortex->mmio, 0x24210 + i * 0x24, coefs[i][4]);\r\n}\r\nhwwrite(vortex->mmio, 0x24538, arg_0 & 0xffff);\r\nhwwrite(vortex->mmio, 0x2453C, arg_4 & 0xffff);\r\n}\r\nstatic void\r\nvortex_XtalkHw_SetRightEQ(vortex_t * vortex, short arg_0, short arg_4,\r\nxtalk_coefs_t const coefs)\r\n{\r\nint i;\r\nfor (i = 0; i < 5; i++) {\r\nhwwrite(vortex->mmio, 0x242b4 + i * 0x24, coefs[i][0]);\r\nhwwrite(vortex->mmio, 0x242b8 + i * 0x24, coefs[i][1]);\r\nhwwrite(vortex->mmio, 0x242bc + i * 0x24, coefs[i][2]);\r\nhwwrite(vortex->mmio, 0x242c0 + i * 0x24, coefs[i][3]);\r\nhwwrite(vortex->mmio, 0x242c4 + i * 0x24, coefs[i][4]);\r\n}\r\nhwwrite(vortex->mmio, 0x24540, arg_0 & 0xffff);\r\nhwwrite(vortex->mmio, 0x24544, arg_4 & 0xffff);\r\n}\r\nstatic void\r\nvortex_XtalkHw_SetLeftXT(vortex_t * vortex, short arg_0, short arg_4,\r\nxtalk_coefs_t const coefs)\r\n{\r\nint i;\r\nfor (i = 0; i < 5; i++) {\r\nhwwrite(vortex->mmio, 0x24368 + i * 0x24, coefs[i][0]);\r\nhwwrite(vortex->mmio, 0x2436c + i * 0x24, coefs[i][1]);\r\nhwwrite(vortex->mmio, 0x24370 + i * 0x24, coefs[i][2]);\r\nhwwrite(vortex->mmio, 0x24374 + i * 0x24, coefs[i][3]);\r\nhwwrite(vortex->mmio, 0x24378 + i * 0x24, coefs[i][4]);\r\n}\r\nhwwrite(vortex->mmio, 0x24548, arg_0 & 0xffff);\r\nhwwrite(vortex->mmio, 0x2454C, arg_4 & 0xffff);\r\n}\r\nstatic void\r\nvortex_XtalkHw_SetRightXT(vortex_t * vortex, short arg_0, short arg_4,\r\nxtalk_coefs_t const coefs)\r\n{\r\nint i;\r\nfor (i = 0; i < 5; i++) {\r\nhwwrite(vortex->mmio, 0x2441C + i * 0x24, coefs[i][0]);\r\nhwwrite(vortex->mmio, 0x24420 + i * 0x24, coefs[i][1]);\r\nhwwrite(vortex->mmio, 0x24424 + i * 0x24, coefs[i][2]);\r\nhwwrite(vortex->mmio, 0x24428 + i * 0x24, coefs[i][3]);\r\nhwwrite(vortex->mmio, 0x2442C + i * 0x24, coefs[i][4]);\r\n}\r\nhwwrite(vortex->mmio, 0x24550, arg_0 & 0xffff);\r\nhwwrite(vortex->mmio, 0x24554, arg_4 & 0xffff);\r\n}\r\nstatic void\r\nvortex_XtalkHw_SetLeftEQStates(vortex_t * vortex,\r\nxtalk_instate_t const arg_0,\r\nxtalk_state_t const coefs)\r\n{\r\nint i;\r\nfor (i = 0; i < 5; i++) {\r\nhwwrite(vortex->mmio, 0x24214 + i * 0x24, coefs[i][0]);\r\nhwwrite(vortex->mmio, 0x24218 + i * 0x24, coefs[i][1]);\r\nhwwrite(vortex->mmio, 0x2421C + i * 0x24, coefs[i][2]);\r\nhwwrite(vortex->mmio, 0x24220 + i * 0x24, coefs[i][3]);\r\n}\r\nhwwrite(vortex->mmio, 0x244F8, arg_0[0]);\r\nhwwrite(vortex->mmio, 0x244FC, arg_0[1]);\r\nhwwrite(vortex->mmio, 0x24500, arg_0[2]);\r\nhwwrite(vortex->mmio, 0x24504, arg_0[3]);\r\n}\r\nstatic void\r\nvortex_XtalkHw_SetRightEQStates(vortex_t * vortex,\r\nxtalk_instate_t const arg_0,\r\nxtalk_state_t const coefs)\r\n{\r\nint i;\r\nfor (i = 0; i < 5; i++) {\r\nhwwrite(vortex->mmio, 0x242C8 + i * 0x24, coefs[i][0]);\r\nhwwrite(vortex->mmio, 0x242CC + i * 0x24, coefs[i][1]);\r\nhwwrite(vortex->mmio, 0x242D0 + i * 0x24, coefs[i][2]);\r\nhwwrite(vortex->mmio, 0x244D4 + i * 0x24, coefs[i][3]);\r\n}\r\nhwwrite(vortex->mmio, 0x24508, arg_0[0]);\r\nhwwrite(vortex->mmio, 0x2450C, arg_0[1]);\r\nhwwrite(vortex->mmio, 0x24510, arg_0[2]);\r\nhwwrite(vortex->mmio, 0x24514, arg_0[3]);\r\n}\r\nstatic void\r\nvortex_XtalkHw_SetLeftXTStates(vortex_t * vortex,\r\nxtalk_instate_t const arg_0,\r\nxtalk_state_t const coefs)\r\n{\r\nint i;\r\nfor (i = 0; i < 5; i++) {\r\nhwwrite(vortex->mmio, 0x2437C + i * 0x24, coefs[i][0]);\r\nhwwrite(vortex->mmio, 0x24380 + i * 0x24, coefs[i][1]);\r\nhwwrite(vortex->mmio, 0x24384 + i * 0x24, coefs[i][2]);\r\nhwwrite(vortex->mmio, 0x24388 + i * 0x24, coefs[i][3]);\r\n}\r\nhwwrite(vortex->mmio, 0x24518, arg_0[0]);\r\nhwwrite(vortex->mmio, 0x2451C, arg_0[1]);\r\nhwwrite(vortex->mmio, 0x24520, arg_0[2]);\r\nhwwrite(vortex->mmio, 0x24524, arg_0[3]);\r\n}\r\nstatic void\r\nvortex_XtalkHw_SetRightXTStates(vortex_t * vortex,\r\nxtalk_instate_t const arg_0,\r\nxtalk_state_t const coefs)\r\n{\r\nint i;\r\nfor (i = 0; i < 5; i++) {\r\nhwwrite(vortex->mmio, 0x24430 + i * 0x24, coefs[i][0]);\r\nhwwrite(vortex->mmio, 0x24434 + i * 0x24, coefs[i][1]);\r\nhwwrite(vortex->mmio, 0x24438 + i * 0x24, coefs[i][2]);\r\nhwwrite(vortex->mmio, 0x2443C + i * 0x24, coefs[i][3]);\r\n}\r\nhwwrite(vortex->mmio, 0x24528, arg_0[0]);\r\nhwwrite(vortex->mmio, 0x2452C, arg_0[1]);\r\nhwwrite(vortex->mmio, 0x24530, arg_0[2]);\r\nhwwrite(vortex->mmio, 0x24534, arg_0[3]);\r\n}\r\nstatic void\r\nvortex_XtalkHw_SetGains(vortex_t * vortex, xtalk_gains_t const gains)\r\n{\r\nint i;\r\nfor (i = 0; i < XTGAINS_SZ; i++) {\r\nhwwrite(vortex->mmio, 0x244D0 + (i * 4), gains[i]);\r\n}\r\n}\r\nstatic void\r\nvortex_XtalkHw_SetGainsAllChan(vortex_t * vortex)\r\n{\r\nvortex_XtalkHw_SetGains(vortex, asXtalkGainsAllChan);\r\n}\r\nstatic void\r\nvortex_XtalkHw_SetDelay(vortex_t * vortex, unsigned short right,\r\nunsigned short left)\r\n{\r\nu32 esp0 = 0;\r\nesp0 &= 0x1FFFFFFF;\r\nesp0 |= 0xA0000000;\r\nesp0 = (esp0 & 0xffffE0ff) | ((right & 0x1F) << 8);\r\nesp0 = (esp0 & 0xfffc1fff) | ((left & 0x1F) << 0xd);\r\nhwwrite(vortex->mmio, 0x24660, esp0);\r\n}\r\nstatic void\r\nvortex_XtalkHw_SetLeftDline(vortex_t * vortex, xtalk_dline_t const dline)\r\n{\r\nint i;\r\nfor (i = 0; i < 0x20; i++) {\r\nhwwrite(vortex->mmio, 0x24000 + (i << 2), dline[i] & 0xffff);\r\nhwwrite(vortex->mmio, 0x24080 + (i << 2), dline[i] >> 0x10);\r\n}\r\n}\r\nstatic void\r\nvortex_XtalkHw_SetRightDline(vortex_t * vortex, xtalk_dline_t const dline)\r\n{\r\nint i;\r\nfor (i = 0; i < 0x20; i++) {\r\nhwwrite(vortex->mmio, 0x24100 + (i << 2), dline[i] & 0xffff);\r\nhwwrite(vortex->mmio, 0x24180 + (i << 2), dline[i] >> 0x10);\r\n}\r\n}\r\nstatic void vortex_XtalkHw_SetSampleRate(vortex_t * vortex, u32 sr)\r\n{\r\nu32 temp;\r\ntemp = (hwread(vortex->mmio, 0x24660) & 0x1FFFFFFF) | 0xC0000000;\r\ntemp = (temp & 0xffffff07) | ((sr & 0x1f) << 3);\r\nhwwrite(vortex->mmio, 0x24660, temp);\r\n}\r\nstatic void vortex_XtalkHw_Enable(vortex_t * vortex)\r\n{\r\nu32 temp;\r\ntemp = (hwread(vortex->mmio, 0x24660) & 0x1FFFFFFF) | 0xC0000000;\r\ntemp |= 1;\r\nhwwrite(vortex->mmio, 0x24660, temp);\r\n}\r\nstatic void vortex_XtalkHw_Disable(vortex_t * vortex)\r\n{\r\nu32 temp;\r\ntemp = (hwread(vortex->mmio, 0x24660) & 0x1FFFFFFF) | 0xC0000000;\r\ntemp &= 0xfffffffe;\r\nhwwrite(vortex->mmio, 0x24660, temp);\r\n}\r\nstatic void vortex_XtalkHw_ZeroIO(vortex_t * vortex)\r\n{\r\nint i;\r\nfor (i = 0; i < 20; i++)\r\nhwwrite(vortex->mmio, 0x24600 + (i << 2), 0);\r\nfor (i = 0; i < 4; i++)\r\nhwwrite(vortex->mmio, 0x24650 + (i << 2), 0);\r\n}\r\nstatic void vortex_XtalkHw_ZeroState(vortex_t * vortex)\r\n{\r\nvortex_XtalkHw_ZeroIO(vortex);\r\nvortex_XtalkHw_SetLeftEQ(vortex, 0, 0, asXtalkCoefsZeros);\r\nvortex_XtalkHw_SetRightEQ(vortex, 0, 0, asXtalkCoefsZeros);\r\nvortex_XtalkHw_SetLeftXT(vortex, 0, 0, asXtalkCoefsZeros);\r\nvortex_XtalkHw_SetRightXT(vortex, 0, 0, asXtalkCoefsZeros);\r\nvortex_XtalkHw_SetGains(vortex, asXtalkGainsZeros);\r\nvortex_XtalkHw_SetDelay(vortex, 0, 0);\r\nvortex_XtalkHw_SetLeftDline(vortex, alXtalkDlineZeros);\r\nvortex_XtalkHw_SetRightDline(vortex, alXtalkDlineZeros);\r\nvortex_XtalkHw_SetLeftDline(vortex, alXtalkDlineZeros);\r\nvortex_XtalkHw_SetRightDline(vortex, alXtalkDlineZeros);\r\nvortex_XtalkHw_SetLeftEQStates(vortex, asXtalkInStateZeros,\r\nasXtalkOutStateZeros);\r\nvortex_XtalkHw_SetRightEQStates(vortex, asXtalkInStateZeros,\r\nasXtalkOutStateZeros);\r\nvortex_XtalkHw_SetLeftXTStates(vortex, asXtalkInStateZeros,\r\nasXtalkOutStateZeros);\r\nvortex_XtalkHw_SetRightXTStates(vortex, asXtalkInStateZeros,\r\nasXtalkOutStateZeros);\r\n}\r\nstatic void vortex_XtalkHw_ProgramPipe(vortex_t * vortex)\r\n{\r\nvortex_XtalkHw_SetLeftEQ(vortex, 0, 1, asXtalkCoefsPipe);\r\nvortex_XtalkHw_SetRightEQ(vortex, 0, 1, asXtalkCoefsPipe);\r\nvortex_XtalkHw_SetLeftXT(vortex, 0, 0, asXtalkCoefsZeros);\r\nvortex_XtalkHw_SetRightXT(vortex, 0, 0, asXtalkCoefsZeros);\r\nvortex_XtalkHw_SetDelay(vortex, 0, 0);\r\n}\r\nstatic void vortex_XtalkHw_ProgramXtalkWide(vortex_t * vortex)\r\n{\r\nvortex_XtalkHw_SetLeftEQ(vortex, sXtalkWideKLeftEq,\r\nsXtalkWideShiftLeftEq, asXtalkWideCoefsLeftEq);\r\nvortex_XtalkHw_SetRightEQ(vortex, sXtalkWideKRightEq,\r\nsXtalkWideShiftRightEq,\r\nasXtalkWideCoefsRightEq);\r\nvortex_XtalkHw_SetLeftXT(vortex, sXtalkWideKLeftXt,\r\nsXtalkWideShiftLeftXt, asXtalkWideCoefsLeftXt);\r\nvortex_XtalkHw_SetRightXT(vortex, sXtalkWideKLeftXt,\r\nsXtalkWideShiftLeftXt,\r\nasXtalkWideCoefsLeftXt);\r\nvortex_XtalkHw_SetDelay(vortex, wXtalkWideRightDelay, wXtalkWideLeftDelay);\r\n}\r\nstatic void vortex_XtalkHw_ProgramXtalkNarrow(vortex_t * vortex)\r\n{\r\nvortex_XtalkHw_SetLeftEQ(vortex, sXtalkNarrowKLeftEq,\r\nsXtalkNarrowShiftLeftEq,\r\nasXtalkNarrowCoefsLeftEq);\r\nvortex_XtalkHw_SetRightEQ(vortex, sXtalkNarrowKRightEq,\r\nsXtalkNarrowShiftRightEq,\r\nasXtalkNarrowCoefsRightEq);\r\nvortex_XtalkHw_SetLeftXT(vortex, sXtalkNarrowKLeftXt,\r\nsXtalkNarrowShiftLeftXt,\r\nasXtalkNarrowCoefsLeftXt);\r\nvortex_XtalkHw_SetRightXT(vortex, sXtalkNarrowKLeftXt,\r\nsXtalkNarrowShiftLeftXt,\r\nasXtalkNarrowCoefsLeftXt);\r\nvortex_XtalkHw_SetDelay(vortex, wXtalkNarrowRightDelay, wXtalkNarrowLeftDelay);\r\n}\r\nstatic void vortex_XtalkHw_ProgramDiamondXtalk(vortex_t * vortex)\r\n{\r\nvortex_XtalkHw_SetLeftEQ(vortex, sDiamondKLeftEq,\r\nsDiamondShiftLeftEq, asDiamondCoefsLeftEq);\r\nvortex_XtalkHw_SetRightEQ(vortex, sDiamondKRightEq,\r\nsDiamondShiftRightEq, asDiamondCoefsRightEq);\r\nvortex_XtalkHw_SetLeftXT(vortex, sDiamondKLeftXt,\r\nsDiamondShiftLeftXt, asDiamondCoefsLeftXt);\r\nvortex_XtalkHw_SetRightXT(vortex, sDiamondKLeftXt,\r\nsDiamondShiftLeftXt, asDiamondCoefsLeftXt);\r\nvortex_XtalkHw_SetDelay(vortex, wDiamondRightDelay, wDiamondLeftDelay);\r\n}\r\nstatic void vortex_XtalkHw_init(vortex_t * vortex)\r\n{\r\nvortex_XtalkHw_ZeroState(vortex);\r\n}
