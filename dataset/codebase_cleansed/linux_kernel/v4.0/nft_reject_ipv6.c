static void nft_reject_ipv6_eval(const struct nft_expr *expr,\r\nstruct nft_data data[NFT_REG_MAX + 1],\r\nconst struct nft_pktinfo *pkt)\r\n{\r\nstruct nft_reject *priv = nft_expr_priv(expr);\r\nstruct net *net = dev_net((pkt->in != NULL) ? pkt->in : pkt->out);\r\nswitch (priv->type) {\r\ncase NFT_REJECT_ICMP_UNREACH:\r\nnf_send_unreach6(net, pkt->skb, priv->icmp_code,\r\npkt->ops->hooknum);\r\nbreak;\r\ncase NFT_REJECT_TCP_RST:\r\nnf_send_reset6(net, pkt->skb, pkt->ops->hooknum);\r\nbreak;\r\n}\r\ndata[NFT_REG_VERDICT].verdict = NF_DROP;\r\n}\r\nstatic int __init nft_reject_ipv6_module_init(void)\r\n{\r\nreturn nft_register_expr(&nft_reject_ipv6_type);\r\n}\r\nstatic void __exit nft_reject_ipv6_module_exit(void)\r\n{\r\nnft_unregister_expr(&nft_reject_ipv6_type);\r\n}
