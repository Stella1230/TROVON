static int usbh1_init(struct platform_device *pdev)\r\n{\r\nint pins[] = {\r\nMX31_PIN_CSPI1_MOSI__USBH1_RXDM,\r\nMX31_PIN_CSPI1_MISO__USBH1_RXDP,\r\nMX31_PIN_CSPI1_SS0__USBH1_TXDM,\r\nMX31_PIN_CSPI1_SS1__USBH1_TXDP,\r\nMX31_PIN_CSPI1_SS2__USBH1_RCV,\r\nMX31_PIN_CSPI1_SCLK__USBH1_OEB,\r\nMX31_PIN_CSPI1_SPI_RDY__USBH1_FS,\r\n};\r\nmxc_iomux_setup_multiple_pins(pins, ARRAY_SIZE(pins), "USB H1");\r\nmxc_iomux_set_pad(MX31_PIN_CSPI1_MOSI, USB_PAD_CFG);\r\nmxc_iomux_set_pad(MX31_PIN_CSPI1_MISO, USB_PAD_CFG);\r\nmxc_iomux_set_pad(MX31_PIN_CSPI1_SS0, USB_PAD_CFG);\r\nmxc_iomux_set_pad(MX31_PIN_CSPI1_SS1, USB_PAD_CFG);\r\nmxc_iomux_set_pad(MX31_PIN_CSPI1_SS2, USB_PAD_CFG);\r\nmxc_iomux_set_pad(MX31_PIN_CSPI1_SCLK, USB_PAD_CFG);\r\nmxc_iomux_set_pad(MX31_PIN_CSPI1_SPI_RDY, USB_PAD_CFG);\r\nmxc_iomux_set_gpr(MUX_PGP_USB_SUSPEND, true);\r\nmdelay(10);\r\nreturn mx31_initialize_usb_hw(pdev->id, MXC_EHCI_POWER_PINS_ENABLED |\r\nMXC_EHCI_INTERFACE_SINGLE_UNI);\r\n}\r\nstatic int usbh2_init(struct platform_device *pdev)\r\n{\r\nint pins[] = {\r\nMX31_PIN_USBH2_DATA0__USBH2_DATA0,\r\nMX31_PIN_USBH2_DATA1__USBH2_DATA1,\r\nMX31_PIN_USBH2_CLK__USBH2_CLK,\r\nMX31_PIN_USBH2_DIR__USBH2_DIR,\r\nMX31_PIN_USBH2_NXT__USBH2_NXT,\r\nMX31_PIN_USBH2_STP__USBH2_STP,\r\n};\r\nmxc_iomux_setup_multiple_pins(pins, ARRAY_SIZE(pins), "USB H2");\r\nmxc_iomux_set_pad(MX31_PIN_USBH2_CLK, USB_PAD_CFG);\r\nmxc_iomux_set_pad(MX31_PIN_USBH2_DIR, USB_PAD_CFG);\r\nmxc_iomux_set_pad(MX31_PIN_USBH2_NXT, USB_PAD_CFG);\r\nmxc_iomux_set_pad(MX31_PIN_USBH2_STP, USB_PAD_CFG);\r\nmxc_iomux_set_pad(MX31_PIN_USBH2_DATA0, USB_PAD_CFG);\r\nmxc_iomux_set_pad(MX31_PIN_USBH2_DATA1, USB_PAD_CFG);\r\nmxc_iomux_set_pad(MX31_PIN_SRXD6, USB_PAD_CFG);\r\nmxc_iomux_set_pad(MX31_PIN_STXD6, USB_PAD_CFG);\r\nmxc_iomux_set_pad(MX31_PIN_SFS3, USB_PAD_CFG);\r\nmxc_iomux_set_pad(MX31_PIN_SCK3, USB_PAD_CFG);\r\nmxc_iomux_set_pad(MX31_PIN_SRXD3, USB_PAD_CFG);\r\nmxc_iomux_set_pad(MX31_PIN_STXD3, USB_PAD_CFG);\r\nmxc_iomux_set_gpr(MUX_PGP_UH2, true);\r\nmxc_iomux_alloc_pin(IOMUX_MODE(MX31_PIN_DTR_DCE1, IOMUX_CONFIG_GPIO),\r\n"USBH2_CS");\r\ngpio_request(IOMUX_TO_GPIO(MX31_PIN_DTR_DCE1), "USBH2 CS");\r\ngpio_direction_output(IOMUX_TO_GPIO(MX31_PIN_DTR_DCE1), 0);\r\nmdelay(10);\r\nreturn mx31_initialize_usb_hw(pdev->id, MXC_EHCI_POWER_PINS_ENABLED);\r\n}\r\nstatic void __init lilly1131_usb_init(void)\r\n{\r\nimx31_add_mxc_ehci_hs(1, &usbh1_pdata);\r\nusbh2_pdata.otg = imx_otg_ulpi_create(ULPI_OTG_DRVVBUS |\r\nULPI_OTG_DRVVBUS_EXT);\r\nif (usbh2_pdata.otg)\r\nimx31_add_mxc_ehci_hs(2, &usbh2_pdata);\r\n}\r\nstatic void __init mx31lilly_board_init(void)\r\n{\r\nimx31_soc_init();\r\nswitch (mx31lilly_baseboard) {\r\ncase MX31LILLY_NOBOARD:\r\nbreak;\r\ncase MX31LILLY_DB:\r\nmx31lilly_db_init();\r\nbreak;\r\ndefault:\r\nprintk(KERN_ERR "Illegal mx31lilly_baseboard type %d\n",\r\nmx31lilly_baseboard);\r\n}\r\nmxc_iomux_alloc_pin(MX31_PIN_CS4__CS4, "Ethernet CS");\r\nmxc_iomux_alloc_pin(MX31_PIN_CSPI1_SCLK__SCLK, "SPI1_CLK");\r\nmxc_iomux_alloc_pin(MX31_PIN_CSPI1_MOSI__MOSI, "SPI1_TX");\r\nmxc_iomux_alloc_pin(MX31_PIN_CSPI1_MISO__MISO, "SPI1_RX");\r\nmxc_iomux_alloc_pin(MX31_PIN_CSPI1_SPI_RDY__SPI_RDY, "SPI1_RDY");\r\nmxc_iomux_alloc_pin(MX31_PIN_CSPI1_SS0__SS0, "SPI1_SS0");\r\nmxc_iomux_alloc_pin(MX31_PIN_CSPI1_SS1__SS1, "SPI1_SS1");\r\nmxc_iomux_alloc_pin(MX31_PIN_CSPI1_SS2__SS2, "SPI1_SS2");\r\nmxc_iomux_alloc_pin(MX31_PIN_CSPI2_SCLK__SCLK, "SPI2_CLK");\r\nmxc_iomux_alloc_pin(MX31_PIN_CSPI2_MOSI__MOSI, "SPI2_TX");\r\nmxc_iomux_alloc_pin(MX31_PIN_CSPI2_MISO__MISO, "SPI2_RX");\r\nmxc_iomux_alloc_pin(MX31_PIN_CSPI2_SPI_RDY__SPI_RDY, "SPI2_RDY");\r\nmxc_iomux_alloc_pin(MX31_PIN_CSPI2_SS0__SS0, "SPI2_SS0");\r\nmxc_iomux_alloc_pin(MX31_PIN_CSPI2_SS1__SS1, "SPI2_SS1");\r\nmxc_iomux_alloc_pin(MX31_PIN_CSPI2_SS2__SS2, "SPI2_SS2");\r\nimx31_add_spi_imx0(&spi0_pdata);\r\nimx31_add_spi_imx1(&spi1_pdata);\r\nmc13783_dev.irq = gpio_to_irq(IOMUX_TO_GPIO(MX31_PIN_GPIO1_3));\r\nspi_register_board_info(&mc13783_dev, 1);\r\nregulator_register_fixed(0, dummy_supplies, ARRAY_SIZE(dummy_supplies));\r\nsmsc91x_resources[1].start =\r\ngpio_to_irq(IOMUX_TO_GPIO(MX31_PIN_GPIO1_0));\r\nsmsc91x_resources[1].end =\r\ngpio_to_irq(IOMUX_TO_GPIO(MX31_PIN_GPIO1_0));\r\nplatform_add_devices(devices, ARRAY_SIZE(devices));\r\nlilly1131_usb_init();\r\n}\r\nstatic void __init mx31lilly_timer_init(void)\r\n{\r\nmx31_clocks_init(26000000);\r\n}
