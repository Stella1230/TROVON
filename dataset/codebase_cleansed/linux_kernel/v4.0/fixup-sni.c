static inline int is_rm300_revd(void)\r\n{\r\nunsigned char csmsr = *(volatile unsigned char *)PCIMT_CSMSR;\r\nreturn (csmsr & 0xa0) == 0x20;\r\n}\r\nint __init pcibios_map_irq(const struct pci_dev *dev, u8 slot, u8 pin)\r\n{\r\nswitch (sni_brd_type) {\r\ncase SNI_BRD_PCI_TOWER_CPLUS:\r\nif (slot == 4) {\r\nwhile (dev && dev->bus->number != 1)\r\ndev = dev->bus->self;\r\nif (dev && dev->devfn >= PCI_DEVFN(4, 0))\r\nslot = 5;\r\n}\r\nreturn irq_tab_pcit_cplus[slot][pin];\r\ncase SNI_BRD_PCI_TOWER:\r\nreturn irq_tab_pcit[slot][pin];\r\ncase SNI_BRD_PCI_MTOWER:\r\nif (is_rm300_revd())\r\nreturn irq_tab_rm300d[slot][pin];\r\ncase SNI_BRD_PCI_DESKTOP:\r\nreturn irq_tab_rm200[slot][pin];\r\ncase SNI_BRD_PCI_MTOWER_CPLUS:\r\nreturn irq_tab_rm300e[slot][pin];\r\n}\r\nreturn 0;\r\n}\r\nint pcibios_plat_dev_init(struct pci_dev *dev)\r\n{\r\nreturn 0;\r\n}
