static void nft_redir_ipv6_eval(const struct nft_expr *expr,\r\nstruct nft_data data[NFT_REG_MAX + 1],\r\nconst struct nft_pktinfo *pkt)\r\n{\r\nstruct nft_redir *priv = nft_expr_priv(expr);\r\nstruct nf_nat_range range;\r\nunsigned int verdict;\r\nmemset(&range, 0, sizeof(range));\r\nif (priv->sreg_proto_min) {\r\nrange.min_proto.all =\r\n*(__be16 *)&data[priv->sreg_proto_min].data[0];\r\nrange.max_proto.all =\r\n*(__be16 *)&data[priv->sreg_proto_max].data[0];\r\nrange.flags |= NF_NAT_RANGE_PROTO_SPECIFIED;\r\n}\r\nrange.flags |= priv->flags;\r\nverdict = nf_nat_redirect_ipv6(pkt->skb, &range, pkt->ops->hooknum);\r\ndata[NFT_REG_VERDICT].verdict = verdict;\r\n}\r\nstatic int __init nft_redir_ipv6_module_init(void)\r\n{\r\nreturn nft_register_expr(&nft_redir_ipv6_type);\r\n}\r\nstatic void __exit nft_redir_ipv6_module_exit(void)\r\n{\r\nnft_unregister_expr(&nft_redir_ipv6_type);\r\n}
