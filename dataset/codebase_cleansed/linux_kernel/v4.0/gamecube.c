static void gamecube_spin(void)\r\n{\r\nfor (;;)\r\ncpu_relax();\r\n}\r\nstatic void gamecube_restart(char *cmd)\r\n{\r\nlocal_irq_disable();\r\nflipper_platform_reset();\r\ngamecube_spin();\r\n}\r\nstatic void gamecube_power_off(void)\r\n{\r\nlocal_irq_disable();\r\ngamecube_spin();\r\n}\r\nstatic void gamecube_halt(void)\r\n{\r\ngamecube_restart(NULL);\r\n}\r\nstatic void __init gamecube_init_early(void)\r\n{\r\nug_udbg_init();\r\n}\r\nstatic int __init gamecube_probe(void)\r\n{\r\nunsigned long dt_root;\r\ndt_root = of_get_flat_dt_root();\r\nif (!of_flat_dt_is_compatible(dt_root, "nintendo,gamecube"))\r\nreturn 0;\r\npm_power_off = gamecube_power_off;\r\nreturn 1;\r\n}\r\nstatic void gamecube_shutdown(void)\r\n{\r\nflipper_quiesce();\r\n}\r\nstatic int __init gamecube_device_probe(void)\r\n{\r\nif (!machine_is(gamecube))\r\nreturn 0;\r\nof_platform_bus_probe(NULL, gamecube_of_bus, NULL);\r\nreturn 0;\r\n}
