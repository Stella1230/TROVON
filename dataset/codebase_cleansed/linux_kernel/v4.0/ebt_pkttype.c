static bool\r\nebt_pkttype_mt(const struct sk_buff *skb, struct xt_action_param *par)\r\n{\r\nconst struct ebt_pkttype_info *info = par->matchinfo;\r\nreturn (skb->pkt_type == info->pkt_type) ^ info->invert;\r\n}\r\nstatic int ebt_pkttype_mt_check(const struct xt_mtchk_param *par)\r\n{\r\nconst struct ebt_pkttype_info *info = par->matchinfo;\r\nif (info->invert != 0 && info->invert != 1)\r\nreturn -EINVAL;\r\nreturn 0;\r\n}\r\nstatic int __init ebt_pkttype_init(void)\r\n{\r\nreturn xt_register_match(&ebt_pkttype_mt_reg);\r\n}\r\nstatic void __exit ebt_pkttype_fini(void)\r\n{\r\nxt_unregister_match(&ebt_pkttype_mt_reg);\r\n}
