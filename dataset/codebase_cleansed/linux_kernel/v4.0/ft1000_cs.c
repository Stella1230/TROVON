static void ft1000_reset(struct pcmcia_device *link)\r\n{\r\npcmcia_reset_card(link->socket);\r\n}\r\nstatic int ft1000_attach(struct pcmcia_device *link)\r\n{\r\nlink->priv = NULL;\r\nlink->config_flags |= CONF_ENABLE_IRQ | CONF_AUTO_SET_IO;\r\nreturn ft1000_config(link);\r\n}\r\nstatic void ft1000_detach(struct pcmcia_device *link)\r\n{\r\nstruct net_device *dev = link->priv;\r\nif (dev)\r\nstop_ft1000_card(dev);\r\npcmcia_disable_device(link);\r\nfree_netdev(dev);\r\n}\r\nstatic int ft1000_confcheck(struct pcmcia_device *link, void *priv_data)\r\n{\r\nreturn pcmcia_request_io(link);\r\n}\r\nstatic int ft1000_config(struct pcmcia_device *link)\r\n{\r\nint ret;\r\ndev_dbg(&link->dev, "ft1000_cs: ft1000_config(0x%p)\n", link);\r\nret = pcmcia_loop_config(link, ft1000_confcheck, NULL);\r\nif (ret) {\r\ndev_err(&link->dev, "Could not configure pcmcia\n");\r\nreturn -ENODEV;\r\n}\r\nret = pcmcia_enable_device(link);\r\nif (ret) {\r\ndev_err(&link->dev, "Could not enable pcmcia\n");\r\ngoto failed;\r\n}\r\nlink->priv = init_ft1000_card(link, &ft1000_reset);\r\nif (!link->priv) {\r\ndev_err(&link->dev, "Could not register as network device\n");\r\ngoto failed;\r\n}\r\nreturn 0;\r\nfailed:\r\npcmcia_disable_device(link);\r\nreturn -ENODEV;\r\n}\r\nstatic int ft1000_suspend(struct pcmcia_device *link)\r\n{\r\nstruct net_device *dev = link->priv;\r\nif (link->open)\r\nnetif_device_detach(dev);\r\nreturn 0;\r\n}\r\nstatic int ft1000_resume(struct pcmcia_device *link)\r\n{\r\nreturn 0;\r\n}\r\nstatic int __init init_ft1000_cs(void)\r\n{\r\nreturn pcmcia_register_driver(&ft1000_cs_driver);\r\n}\r\nstatic void __exit exit_ft1000_cs(void)\r\n{\r\npcmcia_unregister_driver(&ft1000_cs_driver);\r\n}
