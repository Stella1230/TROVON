int save_registers(int pid, struct uml_pt_regs *regs)\r\n{\r\nint err;\r\nerr = ptrace(PTRACE_GETREGS, pid, 0, regs->gp);\r\nif (err < 0)\r\nreturn -errno;\r\nreturn 0;\r\n}\r\nint restore_registers(int pid, struct uml_pt_regs *regs)\r\n{\r\nint err;\r\nerr = ptrace(PTRACE_SETREGS, pid, 0, regs->gp);\r\nif (err < 0)\r\nreturn -errno;\r\nreturn 0;\r\n}\r\nint init_registers(int pid)\r\n{\r\nint err;\r\nerr = ptrace(PTRACE_GETREGS, pid, 0, exec_regs);\r\nif (err < 0)\r\nreturn -errno;\r\narch_init_registers(pid);\r\nget_fp_registers(pid, exec_fp_regs);\r\nreturn 0;\r\n}\r\nvoid get_safe_registers(unsigned long *regs, unsigned long *fp_regs)\r\n{\r\nmemcpy(regs, exec_regs, sizeof(exec_regs));\r\nif (fp_regs)\r\nmemcpy(fp_regs, exec_fp_regs, sizeof(exec_fp_regs));\r\n}
