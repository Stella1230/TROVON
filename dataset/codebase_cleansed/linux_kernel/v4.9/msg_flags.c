static size_t syscall_arg__scnprintf_msg_flags(char *bf, size_t size,\r\nstruct syscall_arg *arg)\r\n{\r\nint printed = 0, flags = arg->val;\r\nif (flags == 0)\r\nreturn scnprintf(bf, size, "NONE");\r\n#define P_MSG_FLAG(n) \\r\nif (flags & MSG_##n) { \\r\nprinted += scnprintf(bf + printed, size - printed, "%s%s", printed ? "|" : "", #n); \\r\nflags &= ~MSG_##n; \\r\n}\r\nP_MSG_FLAG(OOB);\r\nP_MSG_FLAG(PEEK);\r\nP_MSG_FLAG(DONTROUTE);\r\nP_MSG_FLAG(CTRUNC);\r\nP_MSG_FLAG(PROBE);\r\nP_MSG_FLAG(TRUNC);\r\nP_MSG_FLAG(DONTWAIT);\r\nP_MSG_FLAG(EOR);\r\nP_MSG_FLAG(WAITALL);\r\nP_MSG_FLAG(FIN);\r\nP_MSG_FLAG(SYN);\r\nP_MSG_FLAG(CONFIRM);\r\nP_MSG_FLAG(RST);\r\nP_MSG_FLAG(ERRQUEUE);\r\nP_MSG_FLAG(NOSIGNAL);\r\nP_MSG_FLAG(MORE);\r\nP_MSG_FLAG(WAITFORONE);\r\nP_MSG_FLAG(SENDPAGE_NOTLAST);\r\nP_MSG_FLAG(FASTOPEN);\r\nP_MSG_FLAG(CMSG_CLOEXEC);\r\n#undef P_MSG_FLAG\r\nif (flags)\r\nprinted += scnprintf(bf + printed, size - printed, "%s%#x", printed ? "|" : "", flags);\r\nreturn printed;\r\n}
