void ccu_gate_helper_disable(struct ccu_common *common, u32 gate)\r\n{\r\nunsigned long flags;\r\nu32 reg;\r\nif (!gate)\r\nreturn;\r\nspin_lock_irqsave(common->lock, flags);\r\nreg = readl(common->base + common->reg);\r\nwritel(reg & ~gate, common->base + common->reg);\r\nspin_unlock_irqrestore(common->lock, flags);\r\n}\r\nstatic void ccu_gate_disable(struct clk_hw *hw)\r\n{\r\nstruct ccu_gate *cg = hw_to_ccu_gate(hw);\r\nreturn ccu_gate_helper_disable(&cg->common, cg->enable);\r\n}\r\nint ccu_gate_helper_enable(struct ccu_common *common, u32 gate)\r\n{\r\nunsigned long flags;\r\nu32 reg;\r\nif (!gate)\r\nreturn 0;\r\nspin_lock_irqsave(common->lock, flags);\r\nreg = readl(common->base + common->reg);\r\nwritel(reg | gate, common->base + common->reg);\r\nspin_unlock_irqrestore(common->lock, flags);\r\nreturn 0;\r\n}\r\nstatic int ccu_gate_enable(struct clk_hw *hw)\r\n{\r\nstruct ccu_gate *cg = hw_to_ccu_gate(hw);\r\nreturn ccu_gate_helper_enable(&cg->common, cg->enable);\r\n}\r\nint ccu_gate_helper_is_enabled(struct ccu_common *common, u32 gate)\r\n{\r\nif (!gate)\r\nreturn 1;\r\nreturn readl(common->base + common->reg) & gate;\r\n}\r\nstatic int ccu_gate_is_enabled(struct clk_hw *hw)\r\n{\r\nstruct ccu_gate *cg = hw_to_ccu_gate(hw);\r\nreturn ccu_gate_helper_is_enabled(&cg->common, cg->enable);\r\n}
