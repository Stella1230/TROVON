void\r\nacpi_ex_do_debug_object(union acpi_operand_object *source_desc,\r\nu32 level, u32 index)\r\n{\r\nu32 i;\r\nu32 timer;\r\nunion acpi_operand_object *object_desc;\r\nu32 value;\r\nACPI_FUNCTION_TRACE_PTR(ex_do_debug_object, source_desc);\r\nif (!acpi_gbl_enable_aml_debug_object &&\r\n!(acpi_dbg_level & ACPI_LV_DEBUG_OBJECT)) {\r\nreturn_VOID;\r\n}\r\nif (source_desc &&\r\n(ACPI_GET_DESCRIPTOR_TYPE(source_desc) == ACPI_DESC_TYPE_OPERAND) &&\r\n(source_desc->common.type == ACPI_TYPE_STRING)) {\r\nif ((source_desc->string.length == 0) ||\r\n((source_desc->string.length == 1) &&\r\n(*source_desc->string.pointer == '\n'))) {\r\nacpi_os_printf("\n");\r\nreturn_VOID;\r\n}\r\n}\r\nif (!((level > 0) && index == 0)) {\r\nif (acpi_gbl_display_debug_timer) {\r\ntimer = ((u32)acpi_os_get_timer() / 10);\r\ntimer &= 0x03FFFFFF;\r\nacpi_os_printf("[ACPI Debug T=0x%8.8X] %*s", timer,\r\nlevel, " ");\r\n} else {\r\nacpi_os_printf("[ACPI Debug] %*s", level, " ");\r\n}\r\n}\r\nif (index > 0) {\r\nacpi_os_printf("(%.2u) ", index - 1);\r\n}\r\nif (!source_desc) {\r\nacpi_os_printf("[Null Object]\n");\r\nreturn_VOID;\r\n}\r\nif (ACPI_GET_DESCRIPTOR_TYPE(source_desc) == ACPI_DESC_TYPE_OPERAND) {\r\nif ((source_desc->common.type != ACPI_TYPE_INTEGER) &&\r\n(source_desc->common.type != ACPI_TYPE_STRING)) {\r\nacpi_os_printf("%s ",\r\nacpi_ut_get_object_type_name\r\n(source_desc));\r\n}\r\nif (!acpi_ut_valid_internal_object(source_desc)) {\r\nacpi_os_printf("%p, Invalid Internal Object!\n",\r\nsource_desc);\r\nreturn_VOID;\r\n}\r\n} else if (ACPI_GET_DESCRIPTOR_TYPE(source_desc) ==\r\nACPI_DESC_TYPE_NAMED) {\r\nacpi_os_printf("%s (Node %p)\n",\r\nacpi_ut_get_type_name(((struct\r\nacpi_namespace_node *)\r\nsource_desc)->type),\r\nsource_desc);\r\nreturn_VOID;\r\n} else {\r\nreturn_VOID;\r\n}\r\nswitch (source_desc->common.type) {\r\ncase ACPI_TYPE_INTEGER:\r\nif (acpi_gbl_integer_byte_width == 4) {\r\nacpi_os_printf("0x%8.8X\n",\r\n(u32)source_desc->integer.value);\r\n} else {\r\nacpi_os_printf("0x%8.8X%8.8X\n",\r\nACPI_FORMAT_UINT64(source_desc->integer.\r\nvalue));\r\n}\r\nbreak;\r\ncase ACPI_TYPE_BUFFER:\r\nacpi_os_printf("[0x%.2X]\n", (u32)source_desc->buffer.length);\r\nacpi_ut_dump_buffer(source_desc->buffer.pointer,\r\n(source_desc->buffer.length < 256) ?\r\nsource_desc->buffer.length : 256,\r\nDB_BYTE_DISPLAY, 0);\r\nbreak;\r\ncase ACPI_TYPE_STRING:\r\nacpi_os_printf("\"%s\"\n", source_desc->string.pointer);\r\nbreak;\r\ncase ACPI_TYPE_PACKAGE:\r\nacpi_os_printf("(Contains 0x%.2X Elements):\n",\r\nsource_desc->package.count);\r\nfor (i = 0; i < source_desc->package.count; i++) {\r\nacpi_ex_do_debug_object(source_desc->package.\r\nelements[i], level + 4, i + 1);\r\n}\r\nbreak;\r\ncase ACPI_TYPE_LOCAL_REFERENCE:\r\nacpi_os_printf("[%s] ",\r\nacpi_ut_get_reference_name(source_desc));\r\nswitch (source_desc->reference.class) {\r\ncase ACPI_REFCLASS_INDEX:\r\nacpi_os_printf("0x%X\n", source_desc->reference.value);\r\nbreak;\r\ncase ACPI_REFCLASS_TABLE:\r\nacpi_os_printf("Table Index 0x%X\n",\r\nsource_desc->reference.value);\r\nreturn_VOID;\r\ndefault:\r\nbreak;\r\n}\r\nacpi_os_printf(" ");\r\nif (source_desc->reference.node) {\r\nif (ACPI_GET_DESCRIPTOR_TYPE\r\n(source_desc->reference.node) !=\r\nACPI_DESC_TYPE_NAMED) {\r\nacpi_os_printf\r\n(" %p - Not a valid namespace node\n",\r\nsource_desc->reference.node);\r\n} else {\r\nacpi_os_printf("Node %p [%4.4s] ",\r\nsource_desc->reference.node,\r\n(source_desc->reference.node)->\r\nname.ascii);\r\nswitch ((source_desc->reference.node)->type) {\r\ncase ACPI_TYPE_DEVICE:\r\nacpi_os_printf("Device\n");\r\nbreak;\r\ncase ACPI_TYPE_THERMAL:\r\nacpi_os_printf("Thermal Zone\n");\r\nbreak;\r\ndefault:\r\nacpi_ex_do_debug_object((source_desc->\r\nreference.\r\nnode)->object,\r\nlevel + 4, 0);\r\nbreak;\r\n}\r\n}\r\n} else if (source_desc->reference.object) {\r\nif (ACPI_GET_DESCRIPTOR_TYPE\r\n(source_desc->reference.object) ==\r\nACPI_DESC_TYPE_NAMED) {\r\nacpi_ex_do_debug_object(ACPI_CAST_PTR\r\n(union\r\nacpi_operand_object,\r\nsource_desc->reference.\r\nobject), level + 4, 0);\r\n} else {\r\nobject_desc = source_desc->reference.object;\r\nvalue = source_desc->reference.value;\r\nswitch (object_desc->common.type) {\r\ncase ACPI_TYPE_BUFFER:\r\nacpi_os_printf("Buffer[%u] = 0x%2.2X\n",\r\nvalue,\r\n*source_desc->reference.\r\nindex_pointer);\r\nbreak;\r\ncase ACPI_TYPE_STRING:\r\nacpi_os_printf\r\n("String[%u] = \"%c\" (0x%2.2X)\n",\r\nvalue,\r\n*source_desc->reference.\r\nindex_pointer,\r\n*source_desc->reference.\r\nindex_pointer);\r\nbreak;\r\ncase ACPI_TYPE_PACKAGE:\r\nacpi_os_printf("Package[%u] = ", value);\r\nif (!(*source_desc->reference.where)) {\r\nacpi_os_printf\r\n("[Uninitialized Package Element]\n");\r\n} else {\r\nacpi_ex_do_debug_object\r\n(*source_desc->reference.\r\nwhere, level + 4, 0);\r\n}\r\nbreak;\r\ndefault:\r\nacpi_os_printf\r\n("Unknown Reference object type %X\n",\r\nobject_desc->common.type);\r\nbreak;\r\n}\r\n}\r\n}\r\nbreak;\r\ndefault:\r\nacpi_os_printf("(Descriptor %p)\n", source_desc);\r\nbreak;\r\n}\r\nACPI_DEBUG_PRINT_RAW((ACPI_DB_EXEC, "\n"));\r\nreturn_VOID;\r\n}
