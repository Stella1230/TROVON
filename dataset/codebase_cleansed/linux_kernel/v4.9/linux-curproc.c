void cfs_cap_raise(cfs_cap_t cap)\r\n{\r\nstruct cred *cred;\r\ncred = prepare_creds();\r\nif (cred) {\r\ncap_raise(cred->cap_effective, cap);\r\ncommit_creds(cred);\r\n}\r\n}\r\nvoid cfs_cap_lower(cfs_cap_t cap)\r\n{\r\nstruct cred *cred;\r\ncred = prepare_creds();\r\nif (cred) {\r\ncap_lower(cred->cap_effective, cap);\r\ncommit_creds(cred);\r\n}\r\n}\r\nint cfs_cap_raised(cfs_cap_t cap)\r\n{\r\nreturn cap_raised(current_cap(), cap);\r\n}\r\nstatic void cfs_kernel_cap_pack(kernel_cap_t kcap, cfs_cap_t *cap)\r\n{\r\n*cap = kcap.cap[0];\r\n}\r\ncfs_cap_t cfs_curproc_cap_pack(void)\r\n{\r\ncfs_cap_t cap;\r\ncfs_kernel_cap_pack(current_cap(), &cap);\r\nreturn cap;\r\n}
