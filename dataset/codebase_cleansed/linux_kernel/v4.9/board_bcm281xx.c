static void bcm281xx_restart(enum reboot_mode mode, const char *cmd)\r\n{\r\nuint32_t val;\r\nvoid __iomem *base;\r\nstruct device_node *np_wdog;\r\nnp_wdog = of_find_compatible_node(NULL, NULL, "brcm,kona-wdt");\r\nif (!np_wdog) {\r\npr_emerg("Couldn't find brcm,kona-wdt\n");\r\nreturn;\r\n}\r\nbase = of_iomap(np_wdog, 0);\r\nif (!base) {\r\npr_emerg("Couldn't map brcm,kona-wdt\n");\r\nreturn;\r\n}\r\nval = readl(base + SECWDOG_OFFSET);\r\nval &= SECWDOG_RESERVED_MASK | SECWDOG_WD_LOAD_FLAG_MASK;\r\nval |= SECWDOG_EN_MASK | SECWDOG_SRSTEN_MASK |\r\n(0x15 << SECWDOG_CLKS_SHIFT) |\r\n(0x8 << SECWDOG_COUNT_SHIFT);\r\nwritel(val, base + SECWDOG_OFFSET);\r\nwhile (1);\r\n}\r\nstatic void __init bcm281xx_init(void)\r\n{\r\nkona_l2_cache_init();\r\n}
