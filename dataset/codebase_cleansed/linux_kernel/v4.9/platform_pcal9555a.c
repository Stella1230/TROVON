static void __init *pcal9555a_platform_data(void *info)\r\n{\r\nstruct i2c_board_info *i2c_info = info;\r\nchar *type = i2c_info->type;\r\nstruct pca953x_platform_data *pcal9555a;\r\nchar base_pin_name[SFI_NAME_LEN + 1];\r\nchar intr_pin_name[SFI_NAME_LEN + 1];\r\nint gpio_base, intr;\r\nsnprintf(base_pin_name, sizeof(base_pin_name), "%s_base", type);\r\nsnprintf(intr_pin_name, sizeof(intr_pin_name), "%s_int", type);\r\ngpio_base = get_gpio_by_name(base_pin_name);\r\nintr = get_gpio_by_name(intr_pin_name);\r\nif (gpio_base == -1)\r\nreturn NULL;\r\nif (nr >= PCAL9555A_NUM) {\r\npr_err("%s: Too many instances, only %d supported\n", __func__,\r\nPCAL9555A_NUM);\r\nreturn NULL;\r\n}\r\npcal9555a = &pcal9555a_pdata[nr++];\r\npcal9555a->gpio_base = gpio_base;\r\nif (intr >= 0) {\r\ni2c_info->irq = intr + INTEL_MID_IRQ_OFFSET;\r\npcal9555a->irq_base = gpio_base + INTEL_MID_IRQ_OFFSET;\r\n} else {\r\ni2c_info->irq = -1;\r\npcal9555a->irq_base = -1;\r\n}\r\nstrcpy(type, "pcal9555a");\r\nreturn pcal9555a;\r\n}
