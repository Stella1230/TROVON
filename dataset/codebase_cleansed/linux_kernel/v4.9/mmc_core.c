void dwmac_mmc_ctrl(void __iomem *mmcaddr, unsigned int mode)\r\n{\r\nu32 value = readl(mmcaddr + MMC_CNTRL);\r\nvalue |= (mode & 0x3F);\r\nwritel(value, mmcaddr + MMC_CNTRL);\r\npr_debug("stmmac: MMC ctrl register (offset 0x%x): 0x%08x\n",\r\nMMC_CNTRL, value);\r\n}\r\nvoid dwmac_mmc_intr_all_mask(void __iomem *mmcaddr)\r\n{\r\nwritel(MMC_DEFAULT_MASK, mmcaddr + MMC_RX_INTR_MASK);\r\nwritel(MMC_DEFAULT_MASK, mmcaddr + MMC_TX_INTR_MASK);\r\nwritel(MMC_DEFAULT_MASK, mmcaddr + MMC_RX_IPC_INTR_MASK);\r\n}\r\nvoid dwmac_mmc_read(void __iomem *mmcaddr, struct stmmac_counters *mmc)\r\n{\r\nmmc->mmc_tx_octetcount_gb += readl(mmcaddr + MMC_TX_OCTETCOUNT_GB);\r\nmmc->mmc_tx_framecount_gb += readl(mmcaddr + MMC_TX_FRAMECOUNT_GB);\r\nmmc->mmc_tx_broadcastframe_g += readl(mmcaddr +\r\nMMC_TX_BROADCASTFRAME_G);\r\nmmc->mmc_tx_multicastframe_g += readl(mmcaddr +\r\nMMC_TX_MULTICASTFRAME_G);\r\nmmc->mmc_tx_64_octets_gb += readl(mmcaddr + MMC_TX_64_OCTETS_GB);\r\nmmc->mmc_tx_65_to_127_octets_gb +=\r\nreadl(mmcaddr + MMC_TX_65_TO_127_OCTETS_GB);\r\nmmc->mmc_tx_128_to_255_octets_gb +=\r\nreadl(mmcaddr + MMC_TX_128_TO_255_OCTETS_GB);\r\nmmc->mmc_tx_256_to_511_octets_gb +=\r\nreadl(mmcaddr + MMC_TX_256_TO_511_OCTETS_GB);\r\nmmc->mmc_tx_512_to_1023_octets_gb +=\r\nreadl(mmcaddr + MMC_TX_512_TO_1023_OCTETS_GB);\r\nmmc->mmc_tx_1024_to_max_octets_gb +=\r\nreadl(mmcaddr + MMC_TX_1024_TO_MAX_OCTETS_GB);\r\nmmc->mmc_tx_unicast_gb += readl(mmcaddr + MMC_TX_UNICAST_GB);\r\nmmc->mmc_tx_multicast_gb += readl(mmcaddr + MMC_TX_MULTICAST_GB);\r\nmmc->mmc_tx_broadcast_gb += readl(mmcaddr + MMC_TX_BROADCAST_GB);\r\nmmc->mmc_tx_underflow_error += readl(mmcaddr + MMC_TX_UNDERFLOW_ERROR);\r\nmmc->mmc_tx_singlecol_g += readl(mmcaddr + MMC_TX_SINGLECOL_G);\r\nmmc->mmc_tx_multicol_g += readl(mmcaddr + MMC_TX_MULTICOL_G);\r\nmmc->mmc_tx_deferred += readl(mmcaddr + MMC_TX_DEFERRED);\r\nmmc->mmc_tx_latecol += readl(mmcaddr + MMC_TX_LATECOL);\r\nmmc->mmc_tx_exesscol += readl(mmcaddr + MMC_TX_EXESSCOL);\r\nmmc->mmc_tx_carrier_error += readl(mmcaddr + MMC_TX_CARRIER_ERROR);\r\nmmc->mmc_tx_octetcount_g += readl(mmcaddr + MMC_TX_OCTETCOUNT_G);\r\nmmc->mmc_tx_framecount_g += readl(mmcaddr + MMC_TX_FRAMECOUNT_G);\r\nmmc->mmc_tx_excessdef += readl(mmcaddr + MMC_TX_EXCESSDEF);\r\nmmc->mmc_tx_pause_frame += readl(mmcaddr + MMC_TX_PAUSE_FRAME);\r\nmmc->mmc_tx_vlan_frame_g += readl(mmcaddr + MMC_TX_VLAN_FRAME_G);\r\nmmc->mmc_rx_framecount_gb += readl(mmcaddr + MMC_RX_FRAMECOUNT_GB);\r\nmmc->mmc_rx_octetcount_gb += readl(mmcaddr + MMC_RX_OCTETCOUNT_GB);\r\nmmc->mmc_rx_octetcount_g += readl(mmcaddr + MMC_RX_OCTETCOUNT_G);\r\nmmc->mmc_rx_broadcastframe_g += readl(mmcaddr +\r\nMMC_RX_BROADCASTFRAME_G);\r\nmmc->mmc_rx_multicastframe_g += readl(mmcaddr +\r\nMMC_RX_MULTICASTFRAME_G);\r\nmmc->mmc_rx_crc_error += readl(mmcaddr + MMC_RX_CRC_ERROR);\r\nmmc->mmc_rx_align_error += readl(mmcaddr + MMC_RX_ALIGN_ERROR);\r\nmmc->mmc_rx_run_error += readl(mmcaddr + MMC_RX_RUN_ERROR);\r\nmmc->mmc_rx_jabber_error += readl(mmcaddr + MMC_RX_JABBER_ERROR);\r\nmmc->mmc_rx_undersize_g += readl(mmcaddr + MMC_RX_UNDERSIZE_G);\r\nmmc->mmc_rx_oversize_g += readl(mmcaddr + MMC_RX_OVERSIZE_G);\r\nmmc->mmc_rx_64_octets_gb += readl(mmcaddr + MMC_RX_64_OCTETS_GB);\r\nmmc->mmc_rx_65_to_127_octets_gb +=\r\nreadl(mmcaddr + MMC_RX_65_TO_127_OCTETS_GB);\r\nmmc->mmc_rx_128_to_255_octets_gb +=\r\nreadl(mmcaddr + MMC_RX_128_TO_255_OCTETS_GB);\r\nmmc->mmc_rx_256_to_511_octets_gb +=\r\nreadl(mmcaddr + MMC_RX_256_TO_511_OCTETS_GB);\r\nmmc->mmc_rx_512_to_1023_octets_gb +=\r\nreadl(mmcaddr + MMC_RX_512_TO_1023_OCTETS_GB);\r\nmmc->mmc_rx_1024_to_max_octets_gb +=\r\nreadl(mmcaddr + MMC_RX_1024_TO_MAX_OCTETS_GB);\r\nmmc->mmc_rx_unicast_g += readl(mmcaddr + MMC_RX_UNICAST_G);\r\nmmc->mmc_rx_length_error += readl(mmcaddr + MMC_RX_LENGTH_ERROR);\r\nmmc->mmc_rx_autofrangetype += readl(mmcaddr + MMC_RX_AUTOFRANGETYPE);\r\nmmc->mmc_rx_pause_frames += readl(mmcaddr + MMC_RX_PAUSE_FRAMES);\r\nmmc->mmc_rx_fifo_overflow += readl(mmcaddr + MMC_RX_FIFO_OVERFLOW);\r\nmmc->mmc_rx_vlan_frames_gb += readl(mmcaddr + MMC_RX_VLAN_FRAMES_GB);\r\nmmc->mmc_rx_watchdog_error += readl(mmcaddr + MMC_RX_WATCHDOG_ERROR);\r\nmmc->mmc_rx_ipc_intr_mask += readl(mmcaddr + MMC_RX_IPC_INTR_MASK);\r\nmmc->mmc_rx_ipc_intr += readl(mmcaddr + MMC_RX_IPC_INTR);\r\nmmc->mmc_rx_ipv4_gd += readl(mmcaddr + MMC_RX_IPV4_GD);\r\nmmc->mmc_rx_ipv4_hderr += readl(mmcaddr + MMC_RX_IPV4_HDERR);\r\nmmc->mmc_rx_ipv4_nopay += readl(mmcaddr + MMC_RX_IPV4_NOPAY);\r\nmmc->mmc_rx_ipv4_frag += readl(mmcaddr + MMC_RX_IPV4_FRAG);\r\nmmc->mmc_rx_ipv4_udsbl += readl(mmcaddr + MMC_RX_IPV4_UDSBL);\r\nmmc->mmc_rx_ipv4_gd_octets += readl(mmcaddr + MMC_RX_IPV4_GD_OCTETS);\r\nmmc->mmc_rx_ipv4_hderr_octets +=\r\nreadl(mmcaddr + MMC_RX_IPV4_HDERR_OCTETS);\r\nmmc->mmc_rx_ipv4_nopay_octets +=\r\nreadl(mmcaddr + MMC_RX_IPV4_NOPAY_OCTETS);\r\nmmc->mmc_rx_ipv4_frag_octets += readl(mmcaddr +\r\nMMC_RX_IPV4_FRAG_OCTETS);\r\nmmc->mmc_rx_ipv4_udsbl_octets +=\r\nreadl(mmcaddr + MMC_RX_IPV4_UDSBL_OCTETS);\r\nmmc->mmc_rx_ipv6_gd_octets += readl(mmcaddr + MMC_RX_IPV6_GD_OCTETS);\r\nmmc->mmc_rx_ipv6_hderr_octets +=\r\nreadl(mmcaddr + MMC_RX_IPV6_HDERR_OCTETS);\r\nmmc->mmc_rx_ipv6_nopay_octets +=\r\nreadl(mmcaddr + MMC_RX_IPV6_NOPAY_OCTETS);\r\nmmc->mmc_rx_ipv6_gd += readl(mmcaddr + MMC_RX_IPV6_GD);\r\nmmc->mmc_rx_ipv6_hderr += readl(mmcaddr + MMC_RX_IPV6_HDERR);\r\nmmc->mmc_rx_ipv6_nopay += readl(mmcaddr + MMC_RX_IPV6_NOPAY);\r\nmmc->mmc_rx_udp_gd += readl(mmcaddr + MMC_RX_UDP_GD);\r\nmmc->mmc_rx_udp_err += readl(mmcaddr + MMC_RX_UDP_ERR);\r\nmmc->mmc_rx_tcp_gd += readl(mmcaddr + MMC_RX_TCP_GD);\r\nmmc->mmc_rx_tcp_err += readl(mmcaddr + MMC_RX_TCP_ERR);\r\nmmc->mmc_rx_icmp_gd += readl(mmcaddr + MMC_RX_ICMP_GD);\r\nmmc->mmc_rx_icmp_err += readl(mmcaddr + MMC_RX_ICMP_ERR);\r\nmmc->mmc_rx_udp_gd_octets += readl(mmcaddr + MMC_RX_UDP_GD_OCTETS);\r\nmmc->mmc_rx_udp_err_octets += readl(mmcaddr + MMC_RX_UDP_ERR_OCTETS);\r\nmmc->mmc_rx_tcp_gd_octets += readl(mmcaddr + MMC_RX_TCP_GD_OCTETS);\r\nmmc->mmc_rx_tcp_err_octets += readl(mmcaddr + MMC_RX_TCP_ERR_OCTETS);\r\nmmc->mmc_rx_icmp_gd_octets += readl(mmcaddr + MMC_RX_ICMP_GD_OCTETS);\r\nmmc->mmc_rx_icmp_err_octets += readl(mmcaddr + MMC_RX_ICMP_ERR_OCTETS);\r\n}
