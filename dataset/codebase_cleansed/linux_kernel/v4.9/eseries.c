void __init eseries_fixup(struct tag *tags, char **cmdline)\r\n{\r\nif (machine_is_e800())\r\nmemblock_add(0xa0000000, SZ_128M);\r\nelse\r\nmemblock_add(0xa0000000, SZ_64M);\r\n}\r\nint eseries_tmio_enable(struct platform_device *dev)\r\n{\r\ngpio_set_value(GPIO_ESERIES_TMIO_SUSPEND, 0);\r\ngpio_set_value(GPIO_ESERIES_TMIO_PCLR, 0);\r\nmsleep(1);\r\ngpio_set_value(GPIO_ESERIES_TMIO_SUSPEND, 1);\r\nmsleep(1);\r\ngpio_set_value(GPIO_ESERIES_TMIO_PCLR, 1);\r\nmsleep(1);\r\nreturn 0;\r\n}\r\nint eseries_tmio_disable(struct platform_device *dev)\r\n{\r\ngpio_set_value(GPIO_ESERIES_TMIO_SUSPEND, 0);\r\ngpio_set_value(GPIO_ESERIES_TMIO_PCLR, 0);\r\nreturn 0;\r\n}\r\nint eseries_tmio_suspend(struct platform_device *dev)\r\n{\r\ngpio_set_value(GPIO_ESERIES_TMIO_SUSPEND, 0);\r\nreturn 0;\r\n}\r\nint eseries_tmio_resume(struct platform_device *dev)\r\n{\r\ngpio_set_value(GPIO_ESERIES_TMIO_SUSPEND, 1);\r\nmsleep(1);\r\nreturn 0;\r\n}\r\nvoid eseries_get_tmio_gpios(void)\r\n{\r\ngpio_request(GPIO_ESERIES_TMIO_SUSPEND, NULL);\r\ngpio_request(GPIO_ESERIES_TMIO_PCLR, NULL);\r\ngpio_direction_output(GPIO_ESERIES_TMIO_SUSPEND, 0);\r\ngpio_direction_output(GPIO_ESERIES_TMIO_PCLR, 0);\r\n}\r\nstatic void __init __maybe_unused eseries_register_clks(void)\r\n{\r\nclk_register_fixed_rate(NULL, "CLK_CK32K", NULL, 0, 32768);\r\n}\r\nstatic void __init e330_init(void)\r\n{\r\npxa_set_ffuart_info(NULL);\r\npxa_set_btuart_info(NULL);\r\npxa_set_stuart_info(NULL);\r\neseries_register_clks();\r\neseries_get_tmio_gpios();\r\nplatform_add_devices(ARRAY_AND_SIZE(e330_devices));\r\n}\r\nstatic void __init e350_init(void)\r\n{\r\npxa_set_ffuart_info(NULL);\r\npxa_set_btuart_info(NULL);\r\npxa_set_stuart_info(NULL);\r\neseries_register_clks();\r\neseries_get_tmio_gpios();\r\nplatform_add_devices(ARRAY_AND_SIZE(e350_devices));\r\n}\r\nstatic void __init e400_init(void)\r\n{\r\npxa2xx_mfp_config(ARRAY_AND_SIZE(e400_pin_config));\r\npxa_set_ffuart_info(NULL);\r\npxa_set_btuart_info(NULL);\r\npxa_set_stuart_info(NULL);\r\neseries_register_clks();\r\neseries_get_tmio_gpios();\r\npxa_set_fb_info(NULL, &e400_pxafb_mach_info);\r\nplatform_add_devices(ARRAY_AND_SIZE(e400_devices));\r\n}\r\nstatic void __init e740_init(void)\r\n{\r\npxa2xx_mfp_config(ARRAY_AND_SIZE(e740_pin_config));\r\npxa_set_ffuart_info(NULL);\r\npxa_set_btuart_info(NULL);\r\npxa_set_stuart_info(NULL);\r\neseries_register_clks();\r\nclk_add_alias("CLK_CK48M", e740_t7l66xb_device.name,\r\n"UDCCLK", &pxa25x_device_udc.dev),\r\neseries_get_tmio_gpios();\r\nplatform_add_devices(ARRAY_AND_SIZE(e740_devices));\r\npxa_set_ac97_info(NULL);\r\npxa_set_ficp_info(&e7xx_ficp_platform_data);\r\n}\r\nstatic void __init e750_init(void)\r\n{\r\npxa2xx_mfp_config(ARRAY_AND_SIZE(e750_pin_config));\r\npxa_set_ffuart_info(NULL);\r\npxa_set_btuart_info(NULL);\r\npxa_set_stuart_info(NULL);\r\nclk_add_alias("CLK_CK3P6MI", e750_tc6393xb_device.name,\r\n"GPIO11_CLK", NULL),\r\neseries_get_tmio_gpios();\r\nplatform_add_devices(ARRAY_AND_SIZE(e750_devices));\r\npxa_set_ac97_info(NULL);\r\npxa_set_ficp_info(&e7xx_ficp_platform_data);\r\n}\r\nstatic void e800_tg_change(struct w100fb_par *par)\r\n{\r\nunsigned long tmp;\r\ntmp = w100fb_gpio_read(W100_GPIO_PORT_A);\r\nif (par->mode->xres == 480)\r\ntmp |= 0x100;\r\nelse\r\ntmp &= ~0x100;\r\nw100fb_gpio_write(W100_GPIO_PORT_A, tmp);\r\n}\r\nstatic void __init e800_init(void)\r\n{\r\npxa2xx_mfp_config(ARRAY_AND_SIZE(e800_pin_config));\r\npxa_set_ffuart_info(NULL);\r\npxa_set_btuart_info(NULL);\r\npxa_set_stuart_info(NULL);\r\nclk_add_alias("CLK_CK3P6MI", e800_tc6393xb_device.name,\r\n"GPIO11_CLK", NULL),\r\neseries_get_tmio_gpios();\r\nplatform_add_devices(ARRAY_AND_SIZE(e800_devices));\r\npxa_set_ac97_info(NULL);\r\n}
