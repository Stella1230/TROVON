static void nft_reject_ipv4_eval(const struct nft_expr *expr,\r\nstruct nft_regs *regs,\r\nconst struct nft_pktinfo *pkt)\r\n{\r\nstruct nft_reject *priv = nft_expr_priv(expr);\r\nswitch (priv->type) {\r\ncase NFT_REJECT_ICMP_UNREACH:\r\nnf_send_unreach(pkt->skb, priv->icmp_code, pkt->hook);\r\nbreak;\r\ncase NFT_REJECT_TCP_RST:\r\nnf_send_reset(pkt->net, pkt->skb, pkt->hook);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nregs->verdict.code = NF_DROP;\r\n}\r\nstatic int __init nft_reject_ipv4_module_init(void)\r\n{\r\nreturn nft_register_expr(&nft_reject_ipv4_type);\r\n}\r\nstatic void __exit nft_reject_ipv4_module_exit(void)\r\n{\r\nnft_unregister_expr(&nft_reject_ipv4_type);\r\n}
