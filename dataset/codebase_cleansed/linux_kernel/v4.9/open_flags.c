static size_t syscall_arg__scnprintf_open_flags(char *bf, size_t size,\r\nstruct syscall_arg *arg)\r\n{\r\nint printed = 0, flags = arg->val;\r\nif (!(flags & O_CREAT))\r\narg->mask |= 1 << (arg->idx + 1);\r\nif (flags == 0)\r\nreturn scnprintf(bf, size, "RDONLY");\r\n#define P_FLAG(n) \\r\nif (flags & O_##n) { \\r\nprinted += scnprintf(bf + printed, size - printed, "%s%s", printed ? "|" : "", #n); \\r\nflags &= ~O_##n; \\r\n}\r\nP_FLAG(APPEND);\r\nP_FLAG(ASYNC);\r\nP_FLAG(CLOEXEC);\r\nP_FLAG(CREAT);\r\nP_FLAG(DIRECT);\r\nP_FLAG(DIRECTORY);\r\nP_FLAG(EXCL);\r\nP_FLAG(LARGEFILE);\r\nP_FLAG(NOATIME);\r\nP_FLAG(NOCTTY);\r\n#ifdef O_NONBLOCK\r\nP_FLAG(NONBLOCK);\r\n#elif O_NDELAY\r\nP_FLAG(NDELAY);\r\n#endif\r\n#ifdef O_PATH\r\nP_FLAG(PATH);\r\n#endif\r\nP_FLAG(RDWR);\r\n#ifdef O_DSYNC\r\nif ((flags & O_SYNC) == O_SYNC)\r\nprinted += scnprintf(bf + printed, size - printed, "%s%s", printed ? "|" : "", "SYNC");\r\nelse {\r\nP_FLAG(DSYNC);\r\n}\r\n#else\r\nP_FLAG(SYNC);\r\n#endif\r\nP_FLAG(TRUNC);\r\nP_FLAG(WRONLY);\r\n#undef P_FLAG\r\nif (flags)\r\nprinted += scnprintf(bf + printed, size - printed, "%s%#x", printed ? "|" : "", flags);\r\nreturn printed;\r\n}
