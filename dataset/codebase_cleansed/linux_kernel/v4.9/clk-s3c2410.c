static int s3c2410_clk_suspend(void)\r\n{\r\nsamsung_clk_save(reg_base, s3c2410_save,\r\nARRAY_SIZE(s3c2410_clk_regs));\r\nreturn 0;\r\n}\r\nstatic void s3c2410_clk_resume(void)\r\n{\r\nsamsung_clk_restore(reg_base, s3c2410_save,\r\nARRAY_SIZE(s3c2410_clk_regs));\r\n}\r\nstatic void s3c2410_clk_sleep_init(void)\r\n{\r\ns3c2410_save = samsung_clk_alloc_reg_dump(s3c2410_clk_regs,\r\nARRAY_SIZE(s3c2410_clk_regs));\r\nif (!s3c2410_save) {\r\npr_warn("%s: failed to allocate sleep save data, no sleep support!\n",\r\n__func__);\r\nreturn;\r\n}\r\nregister_syscore_ops(&s3c2410_clk_syscore_ops);\r\nreturn;\r\n}\r\nstatic void s3c2410_clk_sleep_init(void) {}\r\nstatic void __init s3c2410_common_clk_register_fixed_ext(\r\nstruct samsung_clk_provider *ctx,\r\nunsigned long xti_f)\r\n{\r\nstruct samsung_clock_alias xti_alias = ALIAS(XTI, NULL, "xtal");\r\ns3c2410_common_frate_clks[0].fixed_rate = xti_f;\r\nsamsung_clk_register_fixed_rate(ctx, s3c2410_common_frate_clks,\r\nARRAY_SIZE(s3c2410_common_frate_clks));\r\nsamsung_clk_register_alias(ctx, &xti_alias, 1);\r\n}\r\nvoid __init s3c2410_common_clk_init(struct device_node *np, unsigned long xti_f,\r\nint current_soc,\r\nvoid __iomem *base)\r\n{\r\nstruct samsung_clk_provider *ctx;\r\nreg_base = base;\r\nif (np) {\r\nreg_base = of_iomap(np, 0);\r\nif (!reg_base)\r\npanic("%s: failed to map registers\n", __func__);\r\n}\r\nctx = samsung_clk_init(np, reg_base, NR_CLKS);\r\nif (!np)\r\ns3c2410_common_clk_register_fixed_ext(ctx, xti_f);\r\nif (current_soc == S3C2410) {\r\nif (_get_rate("xti") == 12 * MHZ) {\r\ns3c2410_plls[mpll].rate_table = pll_s3c2410_12mhz_tbl;\r\ns3c2410_plls[upll].rate_table = pll_s3c2410_12mhz_tbl;\r\n}\r\nsamsung_clk_register_pll(ctx, s3c2410_plls,\r\nARRAY_SIZE(s3c2410_plls), reg_base);\r\n} else {\r\nif (_get_rate("xti") == 12 * MHZ) {\r\ns3c244x_common_plls[mpll].rate_table =\r\npll_s3c244x_12mhz_tbl;\r\ns3c244x_common_plls[upll].rate_table =\r\npll_s3c2410_12mhz_tbl;\r\n}\r\nsamsung_clk_register_pll(ctx, s3c244x_common_plls,\r\nARRAY_SIZE(s3c244x_common_plls), reg_base);\r\n}\r\nsamsung_clk_register_mux(ctx, s3c2410_common_muxes,\r\nARRAY_SIZE(s3c2410_common_muxes));\r\nsamsung_clk_register_div(ctx, s3c2410_common_dividers,\r\nARRAY_SIZE(s3c2410_common_dividers));\r\nsamsung_clk_register_gate(ctx, s3c2410_common_gates,\r\nARRAY_SIZE(s3c2410_common_gates));\r\nif (current_soc == S3C2440 || current_soc == S3C2442) {\r\nsamsung_clk_register_div(ctx, s3c244x_common_dividers,\r\nARRAY_SIZE(s3c244x_common_dividers));\r\nsamsung_clk_register_gate(ctx, s3c244x_common_gates,\r\nARRAY_SIZE(s3c244x_common_gates));\r\nsamsung_clk_register_mux(ctx, s3c244x_common_muxes,\r\nARRAY_SIZE(s3c244x_common_muxes));\r\nsamsung_clk_register_fixed_factor(ctx, s3c244x_common_ffactor,\r\nARRAY_SIZE(s3c244x_common_ffactor));\r\n}\r\nswitch (current_soc) {\r\ncase S3C2410:\r\nsamsung_clk_register_div(ctx, s3c2410_dividers,\r\nARRAY_SIZE(s3c2410_dividers));\r\nsamsung_clk_register_fixed_factor(ctx, s3c2410_ffactor,\r\nARRAY_SIZE(s3c2410_ffactor));\r\nsamsung_clk_register_alias(ctx, s3c2410_aliases,\r\nARRAY_SIZE(s3c2410_aliases));\r\nbreak;\r\ncase S3C2440:\r\nsamsung_clk_register_mux(ctx, s3c2440_muxes,\r\nARRAY_SIZE(s3c2440_muxes));\r\nsamsung_clk_register_gate(ctx, s3c2440_gates,\r\nARRAY_SIZE(s3c2440_gates));\r\nbreak;\r\ncase S3C2442:\r\nsamsung_clk_register_mux(ctx, s3c2442_muxes,\r\nARRAY_SIZE(s3c2442_muxes));\r\nsamsung_clk_register_fixed_factor(ctx, s3c2442_ffactor,\r\nARRAY_SIZE(s3c2442_ffactor));\r\nbreak;\r\n}\r\nsamsung_clk_register_alias(ctx, s3c2410_common_aliases,\r\nARRAY_SIZE(s3c2410_common_aliases));\r\nif (current_soc == S3C2440 || current_soc == S3C2442) {\r\nsamsung_clk_register_alias(ctx, s3c244x_common_aliases,\r\nARRAY_SIZE(s3c244x_common_aliases));\r\n}\r\ns3c2410_clk_sleep_init();\r\nsamsung_clk_of_add_provider(np, ctx);\r\n}\r\nstatic void __init s3c2410_clk_init(struct device_node *np)\r\n{\r\ns3c2410_common_clk_init(np, 0, S3C2410, 0);\r\n}\r\nstatic void __init s3c2440_clk_init(struct device_node *np)\r\n{\r\ns3c2410_common_clk_init(np, 0, S3C2440, 0);\r\n}\r\nstatic void __init s3c2442_clk_init(struct device_node *np)\r\n{\r\ns3c2410_common_clk_init(np, 0, S3C2442, 0);\r\n}
