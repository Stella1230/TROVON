void socfpga_init_l2_ecc(void)\r\n{\r\nstruct device_node *np;\r\nvoid __iomem *mapped_l2_edac_addr;\r\nnp = of_find_compatible_node(NULL, NULL, "altr,socfpga-l2-ecc");\r\nif (!np) {\r\npr_err("Unable to find socfpga-l2-ecc in dtb\n");\r\nreturn;\r\n}\r\nmapped_l2_edac_addr = of_iomap(np, 0);\r\nof_node_put(np);\r\nif (!mapped_l2_edac_addr) {\r\npr_err("Unable to find L2 ECC mapping in dtb\n");\r\nreturn;\r\n}\r\nwritel(0x01, mapped_l2_edac_addr);\r\niounmap(mapped_l2_edac_addr);\r\n}\r\nvoid socfpga_init_arria10_l2_ecc(void)\r\n{\r\nstruct device_node *np;\r\nvoid __iomem *mapped_l2_edac_addr;\r\nnp = of_find_compatible_node(NULL, NULL, "altr,socfpga-a10-l2-ecc");\r\nif (!np) {\r\npr_err("Unable to find socfpga-a10-l2-ecc in dtb\n");\r\nreturn;\r\n}\r\nmapped_l2_edac_addr = of_iomap(np, 0);\r\nof_node_put(np);\r\nif (!mapped_l2_edac_addr) {\r\npr_err("Unable to find L2 ECC mapping in dtb\n");\r\nreturn;\r\n}\r\nif (!sys_manager_base_addr) {\r\npr_err("System Mananger not mapped for L2 ECC\n");\r\ngoto exit;\r\n}\r\nwritel(A10_SYSMGR_MPU_CLEAR_L2_ECC, (sys_manager_base_addr +\r\nA10_SYSMGR_MPU_CLEAR_L2_ECC_OFST));\r\nwritel(A10_SYSMGR_ECC_INTMASK_CLR_L2, sys_manager_base_addr +\r\nA10_SYSMGR_ECC_INTMASK_CLR_OFST);\r\nwritel(A10_MPU_CTRL_L2_ECC_EN, mapped_l2_edac_addr +\r\nA10_MPU_CTRL_L2_ECC_OFST);\r\nexit:\r\niounmap(mapped_l2_edac_addr);\r\n}
