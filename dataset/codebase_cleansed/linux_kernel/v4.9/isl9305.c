static int isl9305_i2c_probe(struct i2c_client *i2c,\r\nconst struct i2c_device_id *id)\r\n{\r\nstruct regulator_config config = { };\r\nstruct isl9305_pdata *pdata = i2c->dev.platform_data;\r\nstruct regulator_dev *rdev;\r\nstruct regmap *regmap;\r\nint i, ret;\r\nregmap = devm_regmap_init_i2c(i2c, &isl9305_regmap);\r\nif (IS_ERR(regmap)) {\r\nret = PTR_ERR(regmap);\r\ndev_err(&i2c->dev, "Failed to create regmap: %d\n", ret);\r\nreturn ret;\r\n}\r\nconfig.dev = &i2c->dev;\r\nfor (i = 0; i < ARRAY_SIZE(isl9305_regulators); i++) {\r\nif (pdata)\r\nconfig.init_data = pdata->init_data[i];\r\nelse\r\nconfig.init_data = NULL;\r\nrdev = devm_regulator_register(&i2c->dev,\r\n&isl9305_regulators[i],\r\n&config);\r\nif (IS_ERR(rdev)) {\r\nret = PTR_ERR(rdev);\r\ndev_err(&i2c->dev, "Failed to register %s: %d\n",\r\nisl9305_regulators[i].name, ret);\r\nreturn ret;\r\n}\r\n}\r\nreturn 0;\r\n}
