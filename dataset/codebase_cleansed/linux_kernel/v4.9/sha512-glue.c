int sha512_arm_update(struct shash_desc *desc, const u8 *data,\r\nunsigned int len)\r\n{\r\nreturn sha512_base_do_update(desc, data, len,\r\n(sha512_block_fn *)sha512_block_data_order);\r\n}\r\nint sha512_arm_final(struct shash_desc *desc, u8 *out)\r\n{\r\nsha512_base_do_finalize(desc,\r\n(sha512_block_fn *)sha512_block_data_order);\r\nreturn sha512_base_finish(desc, out);\r\n}\r\nint sha512_arm_finup(struct shash_desc *desc, const u8 *data,\r\nunsigned int len, u8 *out)\r\n{\r\nsha512_base_do_update(desc, data, len,\r\n(sha512_block_fn *)sha512_block_data_order);\r\nreturn sha512_arm_final(desc, out);\r\n}\r\nstatic int __init sha512_arm_mod_init(void)\r\n{\r\nint err;\r\nerr = crypto_register_shashes(sha512_arm_algs,\r\nARRAY_SIZE(sha512_arm_algs));\r\nif (err)\r\nreturn err;\r\nif (IS_ENABLED(CONFIG_KERNEL_MODE_NEON) && cpu_has_neon()) {\r\nerr = crypto_register_shashes(sha512_neon_algs,\r\nARRAY_SIZE(sha512_neon_algs));\r\nif (err)\r\ngoto err_unregister;\r\n}\r\nreturn 0;\r\nerr_unregister:\r\ncrypto_unregister_shashes(sha512_arm_algs,\r\nARRAY_SIZE(sha512_arm_algs));\r\nreturn err;\r\n}\r\nstatic void __exit sha512_arm_mod_fini(void)\r\n{\r\ncrypto_unregister_shashes(sha512_arm_algs,\r\nARRAY_SIZE(sha512_arm_algs));\r\nif (IS_ENABLED(CONFIG_KERNEL_MODE_NEON) && cpu_has_neon())\r\ncrypto_unregister_shashes(sha512_neon_algs,\r\nARRAY_SIZE(sha512_neon_algs));\r\n}
