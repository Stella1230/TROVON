int of_get_phy_mode(struct device_node *np)\r\n{\r\nconst char *pm;\r\nint err, i;\r\nerr = of_property_read_string(np, "phy-mode", &pm);\r\nif (err < 0)\r\nerr = of_property_read_string(np, "phy-connection-type", &pm);\r\nif (err < 0)\r\nreturn err;\r\nfor (i = 0; i < PHY_INTERFACE_MODE_MAX; i++)\r\nif (!strcasecmp(pm, phy_modes(i)))\r\nreturn i;\r\nreturn -ENODEV;\r\n}\r\nstatic const void *of_get_mac_addr(struct device_node *np, const char *name)\r\n{\r\nstruct property *pp = of_find_property(np, name, NULL);\r\nif (pp && pp->length == ETH_ALEN && is_valid_ether_addr(pp->value))\r\nreturn pp->value;\r\nreturn NULL;\r\n}\r\nconst void *of_get_mac_address(struct device_node *np)\r\n{\r\nconst void *addr;\r\naddr = of_get_mac_addr(np, "mac-address");\r\nif (addr)\r\nreturn addr;\r\naddr = of_get_mac_addr(np, "local-mac-address");\r\nif (addr)\r\nreturn addr;\r\nreturn of_get_mac_addr(np, "address");\r\n}
