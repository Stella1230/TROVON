static int ucv2_verify_speed(struct cpufreq_policy *policy)\r\n{\r\nif (policy->cpu)\r\nreturn -EINVAL;\r\ncpufreq_verify_within_cpu_limits(policy);\r\nreturn 0;\r\n}\r\nstatic int ucv2_target(struct cpufreq_policy *policy,\r\nunsigned int target_freq,\r\nunsigned int relation)\r\n{\r\nstruct cpufreq_freqs freqs;\r\nint ret;\r\nfreqs.old = policy->cur;\r\nfreqs.new = target_freq;\r\ncpufreq_freq_transition_begin(policy, &freqs);\r\nret = clk_set_rate(policy->clk, target_freq * 1000);\r\ncpufreq_freq_transition_end(policy, &freqs, ret);\r\nreturn ret;\r\n}\r\nstatic int __init ucv2_cpu_init(struct cpufreq_policy *policy)\r\n{\r\nif (policy->cpu != 0)\r\nreturn -EINVAL;\r\npolicy->min = policy->cpuinfo.min_freq = 250000;\r\npolicy->max = policy->cpuinfo.max_freq = 1000000;\r\npolicy->cpuinfo.transition_latency = CPUFREQ_ETERNAL;\r\npolicy->clk = clk_get(NULL, "MAIN_CLK");\r\nreturn PTR_ERR_OR_ZERO(policy->clk);\r\n}\r\nstatic int __init ucv2_cpufreq_init(void)\r\n{\r\nreturn cpufreq_register_driver(&ucv2_driver);\r\n}
