s64 div_s64_rem(s64 dividend, s32 divisor, s32 *remainder)\r\n{\r\nu64 quotient;\r\nif (dividend < 0) {\r\nquotient = div_u64_rem(-dividend, abs(divisor), (u32 *)remainder);\r\n*remainder = -*remainder;\r\nif (divisor > 0)\r\nquotient = -quotient;\r\n} else {\r\nquotient = div_u64_rem(dividend, abs(divisor), (u32 *)remainder);\r\nif (divisor < 0)\r\nquotient = -quotient;\r\n}\r\nreturn quotient;\r\n}\r\nu64 div64_u64_rem(u64 dividend, u64 divisor, u64 *remainder)\r\n{\r\nu32 high = divisor >> 32;\r\nu64 quot;\r\nif (high == 0) {\r\nu32 rem32;\r\nquot = div_u64_rem(dividend, divisor, &rem32);\r\n*remainder = rem32;\r\n} else {\r\nint n = 1 + fls(high);\r\nquot = div_u64(dividend >> n, divisor >> n);\r\nif (quot != 0)\r\nquot--;\r\n*remainder = dividend - quot * divisor;\r\nif (*remainder >= divisor) {\r\nquot++;\r\n*remainder -= divisor;\r\n}\r\n}\r\nreturn quot;\r\n}\r\nu64 div64_u64(u64 dividend, u64 divisor)\r\n{\r\nu32 high = divisor >> 32;\r\nu64 quot;\r\nif (high == 0) {\r\nquot = div_u64(dividend, divisor);\r\n} else {\r\nint n = 1 + fls(high);\r\nquot = div_u64(dividend >> n, divisor >> n);\r\nif (quot != 0)\r\nquot--;\r\nif ((dividend - quot * divisor) >= divisor)\r\nquot++;\r\n}\r\nreturn quot;\r\n}\r\ns64 div64_s64(s64 dividend, s64 divisor)\r\n{\r\ns64 quot, t;\r\nquot = div64_u64(abs(dividend), abs(divisor));\r\nt = (dividend ^ divisor) >> 63;\r\nreturn (quot ^ t) - t;\r\n}\r\nu32 iter_div_u64_rem(u64 dividend, u32 divisor, u64 *remainder)\r\n{\r\nreturn __iter_div_u64_rem(dividend, divisor, remainder);\r\n}
