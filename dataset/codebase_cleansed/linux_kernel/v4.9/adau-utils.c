int adau_calc_pll_cfg(unsigned int freq_in, unsigned int freq_out,\r\nuint8_t regs[5])\r\n{\r\nunsigned int r, n, m, i, j;\r\nunsigned int div;\r\nif (!freq_out) {\r\nr = 0;\r\nn = 0;\r\nm = 0;\r\ndiv = 0;\r\n} else {\r\nif (freq_out % freq_in != 0) {\r\ndiv = DIV_ROUND_UP(freq_in, 13500000);\r\nfreq_in /= div;\r\nr = freq_out / freq_in;\r\ni = freq_out % freq_in;\r\nj = gcd(i, freq_in);\r\nn = i / j;\r\nm = freq_in / j;\r\ndiv--;\r\n} else {\r\nr = freq_out / freq_in;\r\nn = 0;\r\nm = 0;\r\ndiv = 0;\r\n}\r\nif (n > 0xffff || m > 0xffff || div > 3 || r > 8 || r < 2)\r\nreturn -EINVAL;\r\n}\r\nregs[0] = m >> 8;\r\nregs[1] = m & 0xff;\r\nregs[2] = n >> 8;\r\nregs[3] = n & 0xff;\r\nregs[4] = (r << 3) | (div << 1);\r\nif (m != 0)\r\nregs[4] |= 1;\r\nreturn 0;\r\n}
