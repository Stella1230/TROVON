static int __init vr41xx_giu_add(void)\r\n{\r\nstruct platform_device *pdev;\r\nstruct resource *res;\r\nunsigned int num;\r\nint retval;\r\npdev = platform_device_alloc("GIU", -1);\r\nif (!pdev)\r\nreturn -ENOMEM;\r\nswitch (current_cpu_type()) {\r\ncase CPU_VR4111:\r\ncase CPU_VR4121:\r\npdev->id = GPIO_50PINS_PULLUPDOWN;\r\nres = giu_50pins_pullupdown_resource;\r\nnum = ARRAY_SIZE(giu_50pins_pullupdown_resource);\r\nbreak;\r\ncase CPU_VR4122:\r\ncase CPU_VR4131:\r\npdev->id = GPIO_36PINS;\r\nres = giu_36pins_resource;\r\nnum = ARRAY_SIZE(giu_36pins_resource);\r\nbreak;\r\ncase CPU_VR4133:\r\npdev->id = GPIO_48PINS_EDGE_SELECT;\r\nres = giu_48pins_resource;\r\nnum = ARRAY_SIZE(giu_48pins_resource);\r\nbreak;\r\ndefault:\r\nretval = -ENODEV;\r\ngoto err_free_device;\r\n}\r\nretval = platform_device_add_resources(pdev, res, num);\r\nif (retval)\r\ngoto err_free_device;\r\nretval = platform_device_add(pdev);\r\nif (retval)\r\ngoto err_free_device;\r\nreturn 0;\r\nerr_free_device:\r\nplatform_device_put(pdev);\r\nreturn retval;\r\n}
