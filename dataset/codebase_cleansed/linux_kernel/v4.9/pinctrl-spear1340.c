static void gpio_request_endisable(struct spear_pmx *pmx, int pin,\r\nbool enable)\r\n{\r\nunsigned int regoffset, regindex, bitoffset;\r\nunsigned int val;\r\npin++;\r\nregindex = pin / 32;\r\nbitoffset = pin % 32;\r\nif (regindex <= 3)\r\nregoffset = PAD_FUNCTION_EN_1 + regindex * sizeof(int *);\r\nelse\r\nregoffset = PAD_FUNCTION_EN_5 + (regindex - 4) * sizeof(int *);\r\nval = pmx_readl(pmx, regoffset);\r\nif (enable)\r\nval &= ~(0x1 << bitoffset);\r\nelse\r\nval |= 0x1 << bitoffset;\r\npmx_writel(pmx, val, regoffset);\r\n}\r\nstatic int spear1340_pinctrl_probe(struct platform_device *pdev)\r\n{\r\nreturn spear_pinctrl_probe(pdev, &spear1340_machdata);\r\n}\r\nstatic int __init spear1340_pinctrl_init(void)\r\n{\r\nreturn platform_driver_register(&spear1340_pinctrl_driver);\r\n}\r\nstatic void __exit spear1340_pinctrl_exit(void)\r\n{\r\nplatform_driver_unregister(&spear1340_pinctrl_driver);\r\n}
