static int dw_mci_pci_probe(struct pci_dev *pdev,\r\nconst struct pci_device_id *entries)\r\n{\r\nstruct dw_mci *host;\r\nint ret;\r\nret = pcim_enable_device(pdev);\r\nif (ret)\r\nreturn ret;\r\nhost = devm_kzalloc(&pdev->dev, sizeof(struct dw_mci), GFP_KERNEL);\r\nif (!host)\r\nreturn -ENOMEM;\r\nhost->irq = pdev->irq;\r\nhost->irq_flags = IRQF_SHARED;\r\nhost->dev = &pdev->dev;\r\nhost->pdata = &pci_board_data;\r\nret = pcim_iomap_regions(pdev, 1 << PCI_BAR_NO, pci_name(pdev));\r\nif (ret)\r\nreturn ret;\r\nhost->regs = pcim_iomap_table(pdev)[PCI_BAR_NO];\r\npci_set_master(pdev);\r\nret = dw_mci_probe(host);\r\nif (ret)\r\nreturn ret;\r\npci_set_drvdata(pdev, host);\r\nreturn 0;\r\n}\r\nstatic void dw_mci_pci_remove(struct pci_dev *pdev)\r\n{\r\nstruct dw_mci *host = pci_get_drvdata(pdev);\r\ndw_mci_remove(host);\r\n}\r\nstatic int dw_mci_pci_suspend(struct device *dev)\r\n{\r\nstruct pci_dev *pdev = to_pci_dev(dev);\r\nstruct dw_mci *host = pci_get_drvdata(pdev);\r\nreturn dw_mci_suspend(host);\r\n}\r\nstatic int dw_mci_pci_resume(struct device *dev)\r\n{\r\nstruct pci_dev *pdev = to_pci_dev(dev);\r\nstruct dw_mci *host = pci_get_drvdata(pdev);\r\nreturn dw_mci_resume(host);\r\n}
