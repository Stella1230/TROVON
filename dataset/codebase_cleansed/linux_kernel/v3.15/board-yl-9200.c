static void __init yl9200_init_early(void)\r\n{\r\nat91rm9200_set_type(ARCH_REVISON_9200_PQFP);\r\nat91_initialize(18432000);\r\n}\r\nstatic void __init yl9200_add_device_buttons(void)\r\n{\r\nat91_set_gpio_input(AT91_PIN_PA24, 1);\r\nat91_set_deglitch(AT91_PIN_PA24, 1);\r\nat91_set_gpio_input(AT91_PIN_PB1, 1);\r\nat91_set_deglitch(AT91_PIN_PB1, 1);\r\nat91_set_gpio_input(AT91_PIN_PB2, 1);\r\nat91_set_deglitch(AT91_PIN_PB2, 1);\r\nat91_set_gpio_input(AT91_PIN_PB6, 1);\r\nat91_set_deglitch(AT91_PIN_PB6, 1);\r\nat91_set_gpio_output(AT91_PIN_PB7, 1);\r\nplatform_device_register(&yl9200_button_device);\r\n}\r\nstatic void __init yl9200_add_device_buttons(void) {}\r\nstatic int ads7843_pendown_state(void)\r\n{\r\nreturn !at91_get_gpio_value(AT91_PIN_PB11);\r\n}\r\nstatic void __init yl9200_add_device_ts(void)\r\n{\r\nat91_set_gpio_input(AT91_PIN_PB11, 1);\r\nat91_set_gpio_input(AT91_PIN_PB10, 1);\r\n}\r\nstatic void __init yl9200_add_device_ts(void) {}\r\nstatic void yl9200_init_video(void)\r\n{\r\nat91_set_A_periph(AT91_PIN_PC6, 0);\r\nat91_ramc_write(0, AT91_SMC_CSR(2), AT91_SMC_DBW_16\r\n| AT91_SMC_WSEN | AT91_SMC_NWS_(0x4)\r\n| AT91_SMC_TDF_(0x100)\r\n);\r\n}\r\nvoid __init yl9200_add_device_video(void)\r\n{\r\nplatform_device_register(&yl9200_s1dfb_device);\r\n}\r\nvoid __init yl9200_add_device_video(void) {}\r\nstatic void __init yl9200_board_init(void)\r\n{\r\nat91_register_uart(0, 0, 0);\r\nat91_register_uart(AT91RM9200_ID_US1, 1, ATMEL_UART_CTS | ATMEL_UART_RTS\r\n| ATMEL_UART_DTR | ATMEL_UART_DSR | ATMEL_UART_DCD\r\n| ATMEL_UART_RI);\r\nat91_register_uart(AT91RM9200_ID_US0, 2, 0);\r\nat91_register_uart(AT91RM9200_ID_US3, 3, ATMEL_UART_RTS);\r\nat91_add_device_serial();\r\nat91_add_device_eth(&yl9200_eth_data);\r\nat91_add_device_usbh(&yl9200_usbh_data);\r\nat91_add_device_udc(&yl9200_udc_data);\r\nat91_add_device_i2c(yl9200_i2c_devices, ARRAY_SIZE(yl9200_i2c_devices));\r\nat91_add_device_mci(0, &yl9200_mci0_data);\r\nat91_add_device_nand(&yl9200_nand_data);\r\nplatform_device_register(&yl9200_flash);\r\n#if defined(CONFIG_SPI_ATMEL) || defined(CONFIG_SPI_ATMEL_MODULE)\r\nat91_add_device_spi(yl9200_spi_devices, ARRAY_SIZE(yl9200_spi_devices));\r\nyl9200_add_device_ts();\r\n#endif\r\nat91_gpio_leds(yl9200_leds, ARRAY_SIZE(yl9200_leds));\r\nyl9200_add_device_buttons();\r\nyl9200_add_device_video();\r\n}
