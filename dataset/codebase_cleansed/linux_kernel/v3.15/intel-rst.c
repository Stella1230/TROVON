static ssize_t irst_show_wakeup_events(struct device *dev,\r\nstruct device_attribute *attr,\r\nchar *buf)\r\n{\r\nstruct acpi_device *acpi;\r\nunsigned long long value;\r\nacpi_status status;\r\nacpi = to_acpi_device(dev);\r\nstatus = acpi_evaluate_integer(acpi->handle, "GFFS", NULL, &value);\r\nif (!ACPI_SUCCESS(status))\r\nreturn -EINVAL;\r\nreturn sprintf(buf, "%lld\n", value);\r\n}\r\nstatic ssize_t irst_store_wakeup_events(struct device *dev,\r\nstruct device_attribute *attr,\r\nconst char *buf, size_t count)\r\n{\r\nstruct acpi_device *acpi;\r\nacpi_status status;\r\nunsigned long value;\r\nint error;\r\nacpi = to_acpi_device(dev);\r\nerror = kstrtoul(buf, 0, &value);\r\nif (error)\r\nreturn error;\r\nstatus = acpi_execute_simple_method(acpi->handle, "SFFS", value);\r\nif (!ACPI_SUCCESS(status))\r\nreturn -EINVAL;\r\nreturn count;\r\n}\r\nstatic ssize_t irst_show_wakeup_time(struct device *dev,\r\nstruct device_attribute *attr, char *buf)\r\n{\r\nstruct acpi_device *acpi;\r\nunsigned long long value;\r\nacpi_status status;\r\nacpi = to_acpi_device(dev);\r\nstatus = acpi_evaluate_integer(acpi->handle, "GFTV", NULL, &value);\r\nif (!ACPI_SUCCESS(status))\r\nreturn -EINVAL;\r\nreturn sprintf(buf, "%lld\n", value);\r\n}\r\nstatic ssize_t irst_store_wakeup_time(struct device *dev,\r\nstruct device_attribute *attr,\r\nconst char *buf, size_t count)\r\n{\r\nstruct acpi_device *acpi;\r\nacpi_status status;\r\nunsigned long value;\r\nint error;\r\nacpi = to_acpi_device(dev);\r\nerror = kstrtoul(buf, 0, &value);\r\nif (error)\r\nreturn error;\r\nstatus = acpi_execute_simple_method(acpi->handle, "SFTV", value);\r\nif (!ACPI_SUCCESS(status))\r\nreturn -EINVAL;\r\nreturn count;\r\n}\r\nstatic int irst_add(struct acpi_device *acpi)\r\n{\r\nint error = 0;\r\nerror = device_create_file(&acpi->dev, &irst_timeout_attr);\r\nif (error)\r\ngoto out;\r\nerror = device_create_file(&acpi->dev, &irst_wakeup_attr);\r\nif (error)\r\ngoto out_timeout;\r\nreturn 0;\r\nout_timeout:\r\ndevice_remove_file(&acpi->dev, &irst_timeout_attr);\r\nout:\r\nreturn error;\r\n}\r\nstatic int irst_remove(struct acpi_device *acpi)\r\n{\r\ndevice_remove_file(&acpi->dev, &irst_wakeup_attr);\r\ndevice_remove_file(&acpi->dev, &irst_timeout_attr);\r\nreturn 0;\r\n}
