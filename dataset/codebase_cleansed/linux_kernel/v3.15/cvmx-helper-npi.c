int __cvmx_helper_npi_probe(int interface)\r\n{\r\n#if CVMX_PKO_QUEUES_PER_PORT_PCI > 0\r\nif (OCTEON_IS_MODEL(OCTEON_CN38XX) || OCTEON_IS_MODEL(OCTEON_CN58XX))\r\nreturn 4;\r\nelse if (OCTEON_IS_MODEL(OCTEON_CN56XX)\r\n&& !OCTEON_IS_MODEL(OCTEON_CN56XX_PASS1_X))\r\nreturn 4;\r\nelse if (OCTEON_IS_MODEL(OCTEON_CN52XX)\r\n&& !OCTEON_IS_MODEL(OCTEON_CN52XX_PASS1_X))\r\nreturn 4;\r\n#if 0\r\nelse if (OCTEON_IS_MODEL(OCTEON_CN31XX)\r\n|| OCTEON_IS_MODEL(OCTEON_CN50XX))\r\nreturn 2;\r\nelse if (OCTEON_IS_MODEL(OCTEON_CN30XX))\r\nreturn 1;\r\n#endif\r\n#endif\r\nreturn 0;\r\n}\r\nint __cvmx_helper_npi_enable(int interface)\r\n{\r\nif (!OCTEON_IS_MODEL(OCTEON_CN3XXX) &&\r\n!OCTEON_IS_MODEL(OCTEON_CN58XX)) {\r\nint num_ports = cvmx_helper_ports_on_interface(interface);\r\nint port;\r\nfor (port = 0; port < num_ports; port++) {\r\nunion cvmx_pip_prt_cfgx port_cfg;\r\nint ipd_port =\r\ncvmx_helper_get_ipd_port(interface, port);\r\nport_cfg.u64 =\r\ncvmx_read_csr(CVMX_PIP_PRT_CFGX(ipd_port));\r\nport_cfg.s.maxerr_en = 0;\r\nport_cfg.s.minerr_en = 0;\r\ncvmx_write_csr(CVMX_PIP_PRT_CFGX(ipd_port),\r\nport_cfg.u64);\r\n}\r\n}\r\nreturn 0;\r\n}
