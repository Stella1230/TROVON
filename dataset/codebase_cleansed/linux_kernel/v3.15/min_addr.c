static void update_mmap_min_addr(void)\r\n{\r\n#ifdef CONFIG_LSM_MMAP_MIN_ADDR\r\nif (dac_mmap_min_addr > CONFIG_LSM_MMAP_MIN_ADDR)\r\nmmap_min_addr = dac_mmap_min_addr;\r\nelse\r\nmmap_min_addr = CONFIG_LSM_MMAP_MIN_ADDR;\r\n#else\r\nmmap_min_addr = dac_mmap_min_addr;\r\n#endif\r\n}\r\nint mmap_min_addr_handler(struct ctl_table *table, int write,\r\nvoid __user *buffer, size_t *lenp, loff_t *ppos)\r\n{\r\nint ret;\r\nif (write && !capable(CAP_SYS_RAWIO))\r\nreturn -EPERM;\r\nret = proc_doulongvec_minmax(table, write, buffer, lenp, ppos);\r\nupdate_mmap_min_addr();\r\nreturn ret;\r\n}\r\nstatic int __init init_mmap_min_addr(void)\r\n{\r\nupdate_mmap_min_addr();\r\nreturn 0;\r\n}
