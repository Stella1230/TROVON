static int hfsplus_trusted_getxattr(struct dentry *dentry, const char *name,\r\nvoid *buffer, size_t size, int type)\r\n{\r\nchar xattr_name[HFSPLUS_ATTR_MAX_STRLEN + 1] = {0};\r\nsize_t len = strlen(name);\r\nif (!strcmp(name, ""))\r\nreturn -EINVAL;\r\nif (len + XATTR_TRUSTED_PREFIX_LEN > HFSPLUS_ATTR_MAX_STRLEN)\r\nreturn -EOPNOTSUPP;\r\nstrcpy(xattr_name, XATTR_TRUSTED_PREFIX);\r\nstrcpy(xattr_name + XATTR_TRUSTED_PREFIX_LEN, name);\r\nreturn hfsplus_getxattr(dentry, xattr_name, buffer, size);\r\n}\r\nstatic int hfsplus_trusted_setxattr(struct dentry *dentry, const char *name,\r\nconst void *buffer, size_t size, int flags, int type)\r\n{\r\nchar xattr_name[HFSPLUS_ATTR_MAX_STRLEN + 1] = {0};\r\nsize_t len = strlen(name);\r\nif (!strcmp(name, ""))\r\nreturn -EINVAL;\r\nif (len + XATTR_TRUSTED_PREFIX_LEN > HFSPLUS_ATTR_MAX_STRLEN)\r\nreturn -EOPNOTSUPP;\r\nstrcpy(xattr_name, XATTR_TRUSTED_PREFIX);\r\nstrcpy(xattr_name + XATTR_TRUSTED_PREFIX_LEN, name);\r\nreturn hfsplus_setxattr(dentry, xattr_name, buffer, size, flags);\r\n}\r\nstatic size_t hfsplus_trusted_listxattr(struct dentry *dentry, char *list,\r\nsize_t list_size, const char *name, size_t name_len, int type)\r\n{\r\nreturn -EOPNOTSUPP;\r\n}
