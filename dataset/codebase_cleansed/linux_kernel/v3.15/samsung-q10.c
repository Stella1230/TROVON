static int samsungq10_bl_set_intensity(struct backlight_device *bd)\r\n{\r\nacpi_status status;\r\nint i;\r\nfor (i = 0; i < SAMSUNGQ10_BL_MAX_INTENSITY; i++) {\r\nstatus = acpi_evaluate_object(ec_handle, "_Q63", NULL, NULL);\r\nif (ACPI_FAILURE(status))\r\nreturn -EIO;\r\n}\r\nfor (i = 0; i < bd->props.brightness; i++) {\r\nstatus = acpi_evaluate_object(ec_handle, "_Q64", NULL, NULL);\r\nif (ACPI_FAILURE(status))\r\nreturn -EIO;\r\n}\r\nreturn 0;\r\n}\r\nstatic int samsungq10_bl_get_intensity(struct backlight_device *bd)\r\n{\r\nreturn bd->props.brightness;\r\n}\r\nstatic int samsungq10_probe(struct platform_device *pdev)\r\n{\r\nstruct backlight_properties props;\r\nstruct backlight_device *bd;\r\nmemset(&props, 0, sizeof(struct backlight_properties));\r\nprops.type = BACKLIGHT_PLATFORM;\r\nprops.max_brightness = SAMSUNGQ10_BL_MAX_INTENSITY;\r\nbd = backlight_device_register("samsung", &pdev->dev, NULL,\r\n&samsungq10_bl_ops, &props);\r\nif (IS_ERR(bd))\r\nreturn PTR_ERR(bd);\r\nplatform_set_drvdata(pdev, bd);\r\nreturn 0;\r\n}\r\nstatic int samsungq10_remove(struct platform_device *pdev)\r\n{\r\nstruct backlight_device *bd = platform_get_drvdata(pdev);\r\nbacklight_device_unregister(bd);\r\nreturn 0;\r\n}\r\nstatic int __init dmi_check_callback(const struct dmi_system_id *id)\r\n{\r\nprintk(KERN_INFO KBUILD_MODNAME ": found model '%s'\n", id->ident);\r\nreturn 1;\r\n}\r\nstatic int __init samsungq10_init(void)\r\n{\r\nif (!force && !dmi_check_system(samsungq10_dmi_table))\r\nreturn -ENODEV;\r\nec_handle = ec_get_handle();\r\nif (!ec_handle)\r\nreturn -ENODEV;\r\nsamsungq10_device = platform_create_bundle(&samsungq10_driver,\r\nsamsungq10_probe,\r\nNULL, 0, NULL, 0);\r\nreturn PTR_ERR_OR_ZERO(samsungq10_device);\r\n}\r\nstatic void __exit samsungq10_exit(void)\r\n{\r\nplatform_device_unregister(samsungq10_device);\r\nplatform_driver_unregister(&samsungq10_driver);\r\n}
