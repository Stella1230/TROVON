static void nfs_init_server_aclclient(struct nfs_server *server)\r\n{\r\nif (server->flags & NFS_MOUNT_NOACL)\r\ngoto out_noacl;\r\nserver->client_acl = rpc_bind_new_program(server->client, &nfsacl_program, 3);\r\nif (IS_ERR(server->client_acl))\r\ngoto out_noacl;\r\nserver->caps |= NFS_CAP_ACLS;\r\nreturn;\r\nout_noacl:\r\nserver->caps &= ~NFS_CAP_ACLS;\r\n}\r\nstatic inline void nfs_init_server_aclclient(struct nfs_server *server)\r\n{\r\nserver->flags &= ~NFS_MOUNT_NOACL;\r\nserver->caps &= ~NFS_CAP_ACLS;\r\n}\r\nstruct nfs_server *nfs3_create_server(struct nfs_mount_info *mount_info,\r\nstruct nfs_subversion *nfs_mod)\r\n{\r\nstruct nfs_server *server = nfs_create_server(mount_info, nfs_mod);\r\nif (!IS_ERR(server))\r\nnfs_init_server_aclclient(server);\r\nreturn server;\r\n}\r\nstruct nfs_server *nfs3_clone_server(struct nfs_server *source,\r\nstruct nfs_fh *fh,\r\nstruct nfs_fattr *fattr,\r\nrpc_authflavor_t flavor)\r\n{\r\nstruct nfs_server *server = nfs_clone_server(source, fh, fattr, flavor);\r\nif (!IS_ERR(server) && !IS_ERR(source->client_acl))\r\nnfs_init_server_aclclient(server);\r\nreturn server;\r\n}
