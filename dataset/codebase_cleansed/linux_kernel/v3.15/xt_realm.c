static bool\r\nrealm_mt(const struct sk_buff *skb, struct xt_action_param *par)\r\n{\r\nconst struct xt_realm_info *info = par->matchinfo;\r\nconst struct dst_entry *dst = skb_dst(skb);\r\nreturn (info->id == (dst->tclassid & info->mask)) ^ info->invert;\r\n}\r\nstatic int __init realm_mt_init(void)\r\n{\r\nreturn xt_register_match(&realm_mt_reg);\r\n}\r\nstatic void __exit realm_mt_exit(void)\r\n{\r\nxt_unregister_match(&realm_mt_reg);\r\n}
