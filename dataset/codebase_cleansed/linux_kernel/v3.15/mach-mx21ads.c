static int mx21ads_fb_init(struct platform_device *pdev)\r\n{\r\nu16 tmp;\r\ntmp = __raw_readw(MX21ADS_IO_REG);\r\ntmp |= MX21ADS_IO_LCDON;\r\n__raw_writew(tmp, MX21ADS_IO_REG);\r\nreturn 0;\r\n}\r\nstatic void mx21ads_fb_exit(struct platform_device *pdev)\r\n{\r\nu16 tmp;\r\ntmp = __raw_readw(MX21ADS_IO_REG);\r\ntmp &= ~MX21ADS_IO_LCDON;\r\n__raw_writew(tmp, MX21ADS_IO_REG);\r\n}\r\nstatic int mx21ads_sdhc_get_ro(struct device *dev)\r\n{\r\nreturn (__raw_readw(MX21ADS_IO_REG) & MX21ADS_IO_SD_WP) ? 1 : 0;\r\n}\r\nstatic int mx21ads_sdhc_init(struct device *dev, irq_handler_t detect_irq,\r\nvoid *data)\r\n{\r\nreturn request_irq(gpio_to_irq(IMX_GPIO_NR(4, 25)), detect_irq,\r\nIRQF_TRIGGER_FALLING, "mmc-detect", data);\r\n}\r\nstatic void mx21ads_sdhc_exit(struct device *dev, void *data)\r\n{\r\nfree_irq(gpio_to_irq(IMX_GPIO_NR(4, 25)), data);\r\n}\r\nstatic void __init mx21ads_map_io(void)\r\n{\r\nmx21_map_io();\r\niotable_init(mx21ads_io_desc, ARRAY_SIZE(mx21ads_io_desc));\r\n}\r\nstatic void __init mx21ads_board_init(void)\r\n{\r\nimx21_soc_init();\r\nmxc_gpio_setup_multiple_pins(mx21ads_pins, ARRAY_SIZE(mx21ads_pins),\r\n"mx21ads");\r\nimx21_add_imx_uart0(&uart_pdata_rts);\r\nimx21_add_imx_uart2(&uart_pdata_norts);\r\nimx21_add_imx_uart3(&uart_pdata_rts);\r\nimx21_add_imx_fb(&mx21ads_fb_data);\r\nimx21_add_mxc_mmc(0, &mx21ads_sdhc_pdata);\r\nimx21_add_mxc_nand(&mx21ads_nand_board_info);\r\nplatform_add_devices(platform_devices, ARRAY_SIZE(platform_devices));\r\nmx21ads_cs8900_resources[1].start =\r\ngpio_to_irq(MX21ADS_CS8900A_IRQ_GPIO);\r\nmx21ads_cs8900_resources[1].end =\r\ngpio_to_irq(MX21ADS_CS8900A_IRQ_GPIO);\r\nplatform_device_register_full(&mx21ads_cs8900_devinfo);\r\n}\r\nstatic void __init mx21ads_timer_init(void)\r\n{\r\nmx21_clocks_init(32768, 26000000);\r\n}
