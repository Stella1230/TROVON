static int uni2char(wchar_t uni, unsigned char *out, int boundlen)\r\n{\r\nconst unsigned char *uni2charset;\r\nunsigned char cl = uni & 0x00ff;\r\nunsigned char ch = (uni & 0xff00) >> 8;\r\nif (boundlen <= 0)\r\nreturn -ENAMETOOLONG;\r\nuni2charset = page_uni2charset[ch];\r\nif (uni2charset && uni2charset[cl])\r\nout[0] = uni2charset[cl];\r\nelse\r\nreturn -EINVAL;\r\nreturn 1;\r\n}\r\nstatic int char2uni(const unsigned char *rawstring, int boundlen, wchar_t *uni)\r\n{\r\n*uni = charset2uni[*rawstring];\r\nif (*uni == 0x0000)\r\nreturn -EINVAL;\r\nreturn 1;\r\n}\r\nstatic int __init init_nls_cp874(void)\r\n{\r\nreturn register_nls(&table);\r\n}\r\nstatic void __exit exit_nls_cp874(void)\r\n{\r\nunregister_nls(&table);\r\n}
