static int vgg2432a4_lcd_init(struct ili9320 *lcd,\r\nstruct ili9320_platdata *cfg)\r\n{\r\nunsigned int addr;\r\nint ret;\r\nret = ili9320_write(lcd, 0x00e5, 0x8000);\r\nif (ret)\r\ngoto err_initial;\r\nret = ili9320_write(lcd, ILI9320_OSCILATION, ILI9320_OSCILATION_OSC);\r\nif (ret)\r\ngoto err_initial;\r\nmdelay(15);\r\nret = ili9320_write_regs(lcd, vgg_init0, ARRAY_SIZE(vgg_init0));\r\nif (ret != 0)\r\ngoto err_initial;\r\nili9320_write(lcd, ILI9320_DISPLAY2, cfg->display2);\r\nili9320_write(lcd, ILI9320_DISPLAY3, cfg->display3);\r\nili9320_write(lcd, ILI9320_DISPLAY4, cfg->display4);\r\nili9320_write(lcd, ILI9320_RGB_IF1, cfg->rgb_if1);\r\nili9320_write(lcd, ILI9320_FRAMEMAKER, 0x0);\r\nili9320_write(lcd, ILI9320_RGB_IF2, cfg->rgb_if2);\r\nret = ili9320_write_regs(lcd, vgg_init1, ARRAY_SIZE(vgg_init1));\r\nif (ret != 0)\r\ngoto err_vgg;\r\nmdelay(300);\r\nret = ili9320_write_regs(lcd, vgg_init2, ARRAY_SIZE(vgg_init2));\r\nif (ret != 0)\r\ngoto err_vgg2;\r\nmdelay(100);\r\nili9320_write(lcd, ILI9320_POWER3, 0x13c);\r\nmdelay(100);\r\nili9320_write(lcd, ILI9320_POWER4, 0x1c00);\r\nili9320_write(lcd, ILI9320_POWER7, 0x000e);\r\nmdelay(100);\r\nili9320_write(lcd, ILI9320_GRAM_HORIZ_ADDR, 0x00);\r\nili9320_write(lcd, ILI9320_GRAM_VERT_ADD, 0x00);\r\nret = ili9320_write_regs(lcd, vgg_gamma, ARRAY_SIZE(vgg_gamma));\r\nif (ret != 0)\r\ngoto err_vgg3;\r\nili9320_write(lcd, ILI9320_HORIZ_START, 0x0);\r\nili9320_write(lcd, ILI9320_HORIZ_END, cfg->hsize - 1);\r\nili9320_write(lcd, ILI9320_VERT_START, 0x0);\r\nili9320_write(lcd, ILI9320_VERT_END, cfg->vsize - 1);\r\nili9320_write(lcd, ILI9320_DRIVER2,\r\nILI9320_DRIVER2_NL(((cfg->vsize - 240) / 8) + 0x1D));\r\nili9320_write(lcd, ILI9320_BASE_IMAGE, 0x1);\r\nili9320_write(lcd, ILI9320_VERT_SCROLL, 0x00);\r\nfor (addr = ILI9320_PARTIAL1_POSITION; addr <= ILI9320_PARTIAL2_END;\r\naddr++) {\r\nili9320_write(lcd, addr, 0x0);\r\n}\r\nili9320_write(lcd, ILI9320_INTERFACE1, 0x10);\r\nili9320_write(lcd, ILI9320_INTERFACE2, cfg->interface2);\r\nili9320_write(lcd, ILI9320_INTERFACE3, cfg->interface3);\r\nili9320_write(lcd, ILI9320_INTERFACE4, cfg->interface4);\r\nili9320_write(lcd, ILI9320_INTERFACE5, cfg->interface5);\r\nili9320_write(lcd, ILI9320_INTERFACE6, cfg->interface6);\r\nlcd->display1 = (ILI9320_DISPLAY1_D(3) | ILI9320_DISPLAY1_DTE |\r\nILI9320_DISPLAY1_GON | ILI9320_DISPLAY1_BASEE |\r\n0x40);\r\nili9320_write(lcd, ILI9320_DISPLAY1, lcd->display1);\r\nreturn 0;\r\nerr_vgg3:\r\nerr_vgg2:\r\nerr_vgg:\r\nerr_initial:\r\nreturn ret;\r\n}\r\nstatic int vgg2432a4_suspend(struct device *dev)\r\n{\r\nreturn ili9320_suspend(dev_get_drvdata(dev));\r\n}\r\nstatic int vgg2432a4_resume(struct device *dev)\r\n{\r\nreturn ili9320_resume(dev_get_drvdata(dev));\r\n}\r\nstatic int vgg2432a4_probe(struct spi_device *spi)\r\n{\r\nint ret;\r\nret = ili9320_probe_spi(spi, &vgg2432a4_client);\r\nif (ret != 0) {\r\ndev_err(&spi->dev, "failed to initialise ili9320\n");\r\nreturn ret;\r\n}\r\nreturn 0;\r\n}\r\nstatic int vgg2432a4_remove(struct spi_device *spi)\r\n{\r\nreturn ili9320_remove(spi_get_drvdata(spi));\r\n}\r\nstatic void vgg2432a4_shutdown(struct spi_device *spi)\r\n{\r\nili9320_shutdown(spi_get_drvdata(spi));\r\n}
