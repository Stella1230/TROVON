int query_mca(void)\r\n{\r\nstruct biosregs ireg, oreg;\r\nu16 len;\r\ninitregs(&ireg);\r\nireg.ah = 0xc0;\r\nintcall(0x15, &ireg, &oreg);\r\nif (oreg.eflags & X86_EFLAGS_CF)\r\nreturn -1;\r\nset_fs(oreg.es);\r\nlen = rdfs16(oreg.bx);\r\nif (len > sizeof(boot_params.sys_desc_table))\r\nlen = sizeof(boot_params.sys_desc_table);\r\ncopy_from_fs(&boot_params.sys_desc_table, oreg.bx, len);\r\nreturn 0;\r\n}
