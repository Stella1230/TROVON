static void\r\nnouveau_therm_temp_set_defaults(struct nouveau_therm *therm)\r\n{\r\nstruct nouveau_therm_priv *priv = (void *)therm;\r\npriv->bios_sensor.slope_mult = 1;\r\npriv->bios_sensor.slope_div = 1;\r\npriv->bios_sensor.offset_num = 0;\r\npriv->bios_sensor.offset_den = 1;\r\npriv->bios_sensor.offset_constant = 0;\r\npriv->bios_sensor.thrs_fan_boost.temp = 90;\r\npriv->bios_sensor.thrs_fan_boost.hysteresis = 3;\r\npriv->bios_sensor.thrs_down_clock.temp = 95;\r\npriv->bios_sensor.thrs_down_clock.hysteresis = 3;\r\npriv->bios_sensor.thrs_critical.temp = 105;\r\npriv->bios_sensor.thrs_critical.hysteresis = 5;\r\npriv->bios_sensor.thrs_shutdown.temp = 135;\r\npriv->bios_sensor.thrs_shutdown.hysteresis = 5;\r\n}\r\nstatic void\r\nnouveau_therm_temp_safety_checks(struct nouveau_therm *therm)\r\n{\r\nstruct nouveau_therm_priv *priv = (void *)therm;\r\nif (!priv->bios_sensor.slope_div)\r\npriv->bios_sensor.slope_div = 1;\r\nif (!priv->bios_sensor.offset_den)\r\npriv->bios_sensor.offset_den = 1;\r\n}\r\nint\r\nnouveau_therm_sensor_ctor(struct nouveau_therm *therm)\r\n{\r\nstruct nouveau_therm_priv *priv = (void *)therm;\r\nstruct nouveau_bios *bios = nouveau_bios(therm);\r\nnouveau_therm_temp_set_defaults(therm);\r\nif (nvbios_therm_sensor_parse(bios, NVBIOS_THERM_DOMAIN_CORE,\r\n&priv->bios_sensor))\r\nnv_error(therm, "nvbios_therm_sensor_parse failed\n");\r\nnouveau_therm_temp_safety_checks(therm);\r\nreturn 0;\r\n}
