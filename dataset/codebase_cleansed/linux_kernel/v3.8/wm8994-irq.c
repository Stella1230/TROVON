int wm8994_irq_init(struct wm8994 *wm8994)\r\n{\r\nint ret;\r\nunsigned long irqflags;\r\nstruct wm8994_pdata *pdata = wm8994->dev->platform_data;\r\nif (!wm8994->irq) {\r\ndev_warn(wm8994->dev,\r\n"No interrupt specified, no interrupts\n");\r\nwm8994->irq_base = 0;\r\nreturn 0;\r\n}\r\nirqflags = IRQF_TRIGGER_HIGH | IRQF_ONESHOT;\r\nif (pdata->irq_flags)\r\nirqflags = pdata->irq_flags;\r\nret = regmap_add_irq_chip(wm8994->regmap, wm8994->irq,\r\nirqflags,\r\nwm8994->irq_base, &wm8994_irq_chip,\r\n&wm8994->irq_data);\r\nif (ret != 0) {\r\ndev_err(wm8994->dev, "Failed to register IRQ chip: %d\n", ret);\r\nreturn ret;\r\n}\r\nwm8994_reg_write(wm8994, WM8994_INTERRUPT_CONTROL, 0);\r\nreturn 0;\r\n}\r\nvoid wm8994_irq_exit(struct wm8994 *wm8994)\r\n{\r\nregmap_del_irq_chip(wm8994->irq, wm8994->irq_data);\r\n}
