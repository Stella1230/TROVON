void mvebu_restart(char mode, const char *cmd)\r\n{\r\nif (!system_controller_base) {\r\npr_err("Cannot restart, system-controller not available: check the device tree\n");\r\n} else {\r\nwritel(mvebu_sc->rstoutn_mask_reset_out_en,\r\nsystem_controller_base +\r\nmvebu_sc->rstoutn_mask_offset);\r\nwritel(mvebu_sc->system_soft_reset,\r\nsystem_controller_base +\r\nmvebu_sc->system_soft_reset_offset);\r\n}\r\nwhile (1)\r\n;\r\n}\r\nstatic int __init mvebu_system_controller_init(void)\r\n{\r\nstruct device_node *np;\r\nnp = of_find_matching_node(NULL, of_system_controller_table);\r\nif (np) {\r\nconst struct of_device_id *match =\r\nof_match_node(of_system_controller_table, np);\r\nBUG_ON(!match);\r\nsystem_controller_base = of_iomap(np, 0);\r\nmvebu_sc = (struct mvebu_system_controller *)match->data;\r\n}\r\nreturn 0;\r\n}
