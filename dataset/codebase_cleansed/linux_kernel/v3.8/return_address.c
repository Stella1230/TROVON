void *return_address(unsigned int depth)\r\n{\r\nstruct dwarf_frame *frame;\r\nunsigned long ra;\r\nint i;\r\nfor (i = 0, frame = NULL, ra = 0; i <= depth; i++) {\r\nstruct dwarf_frame *tmp;\r\ntmp = dwarf_unwind_stack(ra, frame);\r\nif (!tmp)\r\nreturn NULL;\r\nif (frame)\r\ndwarf_free_frame(frame);\r\nframe = tmp;\r\nif (!frame || !frame->return_addr)\r\nbreak;\r\nra = frame->return_addr;\r\n}\r\nWARN_ON(i != depth + 1);\r\nif (frame)\r\ndwarf_free_frame(frame);\r\nreturn (void *)ra;\r\n}\r\nvoid *return_address(unsigned int depth)\r\n{\r\nreturn NULL;\r\n}
