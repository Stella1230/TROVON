static int msp71xx_exd_gpio_get(struct gpio_chip *chip, unsigned offset)\r\n{\r\nstruct msp71xx_exd_gpio_chip *msp71xx_chip =\r\nto_msp71xx_exd_gpio_chip(chip);\r\nconst unsigned bit = MSP71XX_READ_OFFSET(offset);\r\nreturn __raw_readl(msp71xx_chip->reg) & (1 << bit);\r\n}\r\nstatic void msp71xx_exd_gpio_set(struct gpio_chip *chip,\r\nunsigned offset, int value)\r\n{\r\nstruct msp71xx_exd_gpio_chip *msp71xx_chip =\r\nto_msp71xx_exd_gpio_chip(chip);\r\nconst unsigned bit = MSP71XX_DATA_OFFSET(offset);\r\n__raw_writel(1 << (bit + (value ? 1 : 0)), msp71xx_chip->reg);\r\n}\r\nstatic int msp71xx_exd_direction_output(struct gpio_chip *chip,\r\nunsigned offset, int value)\r\n{\r\nstruct msp71xx_exd_gpio_chip *msp71xx_chip =\r\nto_msp71xx_exd_gpio_chip(chip);\r\nmsp71xx_exd_gpio_set(chip, offset, value);\r\n__raw_writel(1 << MSP71XX_CFG_OUT_OFFSET(offset), msp71xx_chip->reg);\r\nreturn 0;\r\n}\r\nstatic int msp71xx_exd_direction_input(struct gpio_chip *chip, unsigned offset)\r\n{\r\nstruct msp71xx_exd_gpio_chip *msp71xx_chip =\r\nto_msp71xx_exd_gpio_chip(chip);\r\n__raw_writel(1 << MSP71XX_CFG_IN_OFFSET(offset), msp71xx_chip->reg);\r\nreturn 0;\r\n}\r\nvoid __init msp71xx_init_gpio_extended(void)\r\n{\r\nint i;\r\nfor (i = 0; i < ARRAY_SIZE(msp71xx_exd_gpio_banks); i++)\r\ngpiochip_add(&msp71xx_exd_gpio_banks[i].chip);\r\n}
