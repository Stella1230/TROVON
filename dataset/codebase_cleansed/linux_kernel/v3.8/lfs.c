int\r\nlfs(void *frD, void *ea)\r\n{\r\nFP_DECL_D(R);\r\nFP_DECL_S(A);\r\nFP_DECL_EX;\r\nfloat f;\r\n#ifdef DEBUG\r\nprintk("%s: D %p, ea %p\n", __func__, frD, ea);\r\n#endif\r\nif (copy_from_user(&f, ea, sizeof(float)))\r\nreturn -EFAULT;\r\nFP_UNPACK_S(A, f);\r\n#ifdef DEBUG\r\nprintk("A: %ld %lu %ld (%ld) [%08lx]\n", A_s, A_f, A_e, A_c,\r\n*(unsigned long *)&f);\r\n#endif\r\nFP_CONV(D, S, 2, 1, R, A);\r\n#ifdef DEBUG\r\nprintk("R: %ld %lu %lu %ld (%ld)\n", R_s, R_f1, R_f0, R_e, R_c);\r\n#endif\r\nif (R_c == FP_CLS_NAN) {\r\nR_e = _FP_EXPMAX_D;\r\n_FP_PACK_RAW_2_P(D, frD, R);\r\n} else {\r\n__FP_PACK_D(frD, R);\r\n}\r\nreturn 0;\r\n}
