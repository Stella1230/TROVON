static inline unsigned int serial_in(int offset, unsigned int base_addr)\r\n{\r\nreturn __raw_readl(PORT(base_addr, offset)) & 0xff;\r\n}\r\nstatic inline void serial_out(int offset, int value, unsigned int base_addr)\r\n{\r\n__raw_writel(value, PORT(base_addr, offset));\r\n}\r\nvoid __init prom_init_early_console(char port)\r\n{\r\nconsole_port = port;\r\n}\r\nint prom_putchar(char c)\r\n{\r\nunsigned int base_addr;\r\nbase_addr = console_port ? SEAD_UART1_REGS_BASE : SEAD_UART0_REGS_BASE;\r\nwhile ((serial_in(UART_LSR, base_addr) & UART_LSR_THRE) == 0)\r\n;\r\nserial_out(UART_TX, c, base_addr);\r\nreturn 1;\r\n}
