static void\r\n__xfs_printk(\r\nconst char *level,\r\nconst struct xfs_mount *mp,\r\nstruct va_format *vaf)\r\n{\r\nif (mp && mp->m_fsname) {\r\nprintk("%sXFS (%s): %pV\n", level, mp->m_fsname, vaf);\r\nreturn;\r\n}\r\nprintk("%sXFS: %pV\n", level, vaf);\r\n}\r\nvoid\r\nxfs_alert_tag(\r\nconst struct xfs_mount *mp,\r\nint panic_tag,\r\nconst char *fmt, ...)\r\n{\r\nstruct va_format vaf;\r\nva_list args;\r\nint do_panic = 0;\r\nif (xfs_panic_mask && (xfs_panic_mask & panic_tag)) {\r\nxfs_alert(mp, "Transforming an alert into a BUG.");\r\ndo_panic = 1;\r\n}\r\nva_start(args, fmt);\r\nvaf.fmt = fmt;\r\nvaf.va = &args;\r\n__xfs_printk(KERN_ALERT, mp, &vaf);\r\nva_end(args);\r\nBUG_ON(do_panic);\r\n}\r\nvoid\r\nassfail(char *expr, char *file, int line)\r\n{\r\nxfs_emerg(NULL, "Assertion failed: %s, file: %s, line: %d",\r\nexpr, file, line);\r\nBUG();\r\n}\r\nvoid\r\nxfs_hex_dump(void *p, int length)\r\n{\r\nprint_hex_dump(KERN_ALERT, "", DUMP_PREFIX_ADDRESS, 16, 1, p, length, 1);\r\n}
