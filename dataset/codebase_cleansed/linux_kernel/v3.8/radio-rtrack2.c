static struct radio_isa_card *rtrack2_alloc(void)\r\n{\r\nreturn kzalloc(sizeof(struct radio_isa_card), GFP_KERNEL);\r\n}\r\nstatic void zero(struct radio_isa_card *isa)\r\n{\r\noutb_p(1, isa->io);\r\noutb_p(3, isa->io);\r\noutb_p(1, isa->io);\r\n}\r\nstatic void one(struct radio_isa_card *isa)\r\n{\r\noutb_p(5, isa->io);\r\noutb_p(7, isa->io);\r\noutb_p(5, isa->io);\r\n}\r\nstatic int rtrack2_s_frequency(struct radio_isa_card *isa, u32 freq)\r\n{\r\nint i;\r\nfreq = freq / 200 + 856;\r\noutb_p(0xc8, isa->io);\r\noutb_p(0xc9, isa->io);\r\noutb_p(0xc9, isa->io);\r\nfor (i = 0; i < 10; i++)\r\nzero(isa);\r\nfor (i = 14; i >= 0; i--)\r\nif (freq & (1 << i))\r\none(isa);\r\nelse\r\nzero(isa);\r\noutb_p(0xc8, isa->io);\r\nif (!v4l2_ctrl_g_ctrl(isa->mute))\r\noutb_p(0, isa->io);\r\nreturn 0;\r\n}\r\nstatic u32 rtrack2_g_signal(struct radio_isa_card *isa)\r\n{\r\nreturn (inb(isa->io) & 2) ? 0 : 0xffff;\r\n}\r\nstatic int rtrack2_s_mute_volume(struct radio_isa_card *isa, bool mute, int vol)\r\n{\r\noutb(mute, isa->io);\r\nreturn 0;\r\n}\r\nstatic int __init rtrack2_init(void)\r\n{\r\nreturn isa_register_driver(&rtrack2_driver.driver, RTRACK2_MAX);\r\n}\r\nstatic void __exit rtrack2_exit(void)\r\n{\r\nisa_unregister_driver(&rtrack2_driver.driver);\r\n}
