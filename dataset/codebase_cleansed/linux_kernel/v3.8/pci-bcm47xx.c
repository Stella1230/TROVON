int __init pcibios_map_irq(const struct pci_dev *dev, u8 slot, u8 pin)\r\n{\r\nreturn 0;\r\n}\r\nstatic int bcm47xx_pcibios_plat_dev_init_ssb(struct pci_dev *dev)\r\n{\r\nint res;\r\nu8 slot, pin;\r\nres = ssb_pcibios_plat_dev_init(dev);\r\nif (res < 0) {\r\nprintk(KERN_ALERT "PCI: Failed to init device %s\n",\r\npci_name(dev));\r\nreturn res;\r\n}\r\npci_read_config_byte(dev, PCI_INTERRUPT_PIN, &pin);\r\nslot = PCI_SLOT(dev->devfn);\r\nres = ssb_pcibios_map_irq(dev, slot, pin);\r\nif (res < 2) {\r\nprintk(KERN_ALERT "PCI: Failed to map IRQ of device %s\n",\r\npci_name(dev));\r\nreturn res;\r\n}\r\ndev->irq = res;\r\nreturn 0;\r\n}\r\nstatic int bcm47xx_pcibios_plat_dev_init_bcma(struct pci_dev *dev)\r\n{\r\nint res;\r\nres = bcma_core_pci_plat_dev_init(dev);\r\nif (res < 0) {\r\nprintk(KERN_ALERT "PCI: Failed to init device %s\n",\r\npci_name(dev));\r\nreturn res;\r\n}\r\nres = bcma_core_pci_pcibios_map_irq(dev);\r\nif (res < 2) {\r\nprintk(KERN_ALERT "PCI: Failed to map IRQ of device %s\n",\r\npci_name(dev));\r\nreturn res;\r\n}\r\ndev->irq = res;\r\nreturn 0;\r\n}\r\nint pcibios_plat_dev_init(struct pci_dev *dev)\r\n{\r\n#ifdef CONFIG_BCM47XX_SSB\r\nif (bcm47xx_bus_type == BCM47XX_BUS_TYPE_SSB)\r\nreturn bcm47xx_pcibios_plat_dev_init_ssb(dev);\r\nelse\r\n#endif\r\n#ifdef CONFIG_BCM47XX_BCMA\r\nif (bcm47xx_bus_type == BCM47XX_BUS_TYPE_BCMA)\r\nreturn bcm47xx_pcibios_plat_dev_init_bcma(dev);\r\nelse\r\n#endif\r\nreturn 0;\r\n}
