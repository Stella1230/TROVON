static size_t syscall_arg__scnprintf_socket_type(char *bf, size_t size, struct syscall_arg *arg)\r\n{\r\nsize_t printed;\r\nint type = arg->val,\r\nflags = type & ~SOCK_TYPE_MASK;\r\ntype &= SOCK_TYPE_MASK;\r\nswitch (type) {\r\n#define P_SK_TYPE(n) case SOCK_##n: printed = scnprintf(bf, size, #n); break;\r\nP_SK_TYPE(STREAM);\r\nP_SK_TYPE(DGRAM);\r\nP_SK_TYPE(RAW);\r\nP_SK_TYPE(RDM);\r\nP_SK_TYPE(SEQPACKET);\r\nP_SK_TYPE(DCCP);\r\nP_SK_TYPE(PACKET);\r\n#undef P_SK_TYPE\r\ndefault:\r\nprinted = scnprintf(bf, size, "%#x", type);\r\n}\r\n#define P_SK_FLAG(n) \\r\nif (flags & SOCK_##n) { \\r\nprinted += scnprintf(bf + printed, size - printed, "|%s", #n); \\r\nflags &= ~SOCK_##n; \\r\n}\r\nP_SK_FLAG(CLOEXEC);\r\nP_SK_FLAG(NONBLOCK);\r\n#undef P_SK_FLAG\r\nif (flags)\r\nprinted += scnprintf(bf + printed, size - printed, "|%#x", flags);\r\nreturn printed;\r\n}
