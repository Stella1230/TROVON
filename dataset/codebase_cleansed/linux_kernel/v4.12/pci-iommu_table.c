static struct iommu_table_entry * __init\r\nfind_dependents_of(struct iommu_table_entry *start,\r\nstruct iommu_table_entry *finish,\r\nstruct iommu_table_entry *q)\r\n{\r\nstruct iommu_table_entry *p;\r\nif (!q)\r\nreturn NULL;\r\nfor (p = start; p < finish; p++)\r\nif (p->detect == q->depend)\r\nreturn p;\r\nreturn NULL;\r\n}\r\nvoid __init sort_iommu_table(struct iommu_table_entry *start,\r\nstruct iommu_table_entry *finish) {\r\nstruct iommu_table_entry *p, *q, tmp;\r\nfor (p = start; p < finish; p++) {\r\nagain:\r\nq = find_dependents_of(start, finish, p);\r\nif (q > p) {\r\ntmp = *p;\r\nmemmove(p, q, sizeof(*p));\r\n*q = tmp;\r\ngoto again;\r\n}\r\n}\r\n}\r\nvoid __init check_iommu_entries(struct iommu_table_entry *start,\r\nstruct iommu_table_entry *finish)\r\n{\r\nstruct iommu_table_entry *p, *q, *x;\r\nfor (p = start; p < finish; p++) {\r\nq = find_dependents_of(start, finish, p);\r\nx = find_dependents_of(start, finish, q);\r\nif (p == x) {\r\nprintk(KERN_ERR "CYCLIC DEPENDENCY FOUND! %pS depends on %pS and vice-versa. BREAKING IT.\n",\r\np->detect, q->detect);\r\nx->depend = 0;\r\n}\r\n}\r\nfor (p = start; p < finish; p++) {\r\nq = find_dependents_of(p, finish, p);\r\nif (q && q > p) {\r\nprintk(KERN_ERR "EXECUTION ORDER INVALID! %pS should be called before %pS!\n",\r\np->detect, q->detect);\r\n}\r\n}\r\n}\r\nvoid __init check_iommu_entries(struct iommu_table_entry *start,\r\nstruct iommu_table_entry *finish)\r\n{\r\n}
