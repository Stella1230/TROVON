static inline u64 node_start(struct umem_odp_node *n)\r\n{\r\nstruct ib_umem_odp *umem_odp =\r\ncontainer_of(n, struct ib_umem_odp, interval_tree);\r\nreturn ib_umem_start(umem_odp->umem);\r\n}\r\nstatic inline u64 node_last(struct umem_odp_node *n)\r\n{\r\nstruct ib_umem_odp *umem_odp =\r\ncontainer_of(n, struct ib_umem_odp, interval_tree);\r\nreturn ib_umem_end(umem_odp->umem) - 1;\r\n}\r\nint rbt_ib_umem_for_each_in_range(struct rb_root *root,\r\nu64 start, u64 last,\r\numem_call_back cb,\r\nvoid *cookie)\r\n{\r\nint ret_val = 0;\r\nstruct umem_odp_node *node, *next;\r\nstruct ib_umem_odp *umem;\r\nif (unlikely(start == last))\r\nreturn ret_val;\r\nfor (node = rbt_ib_umem_iter_first(root, start, last - 1);\r\nnode; node = next) {\r\nnext = rbt_ib_umem_iter_next(node, start, last - 1);\r\numem = container_of(node, struct ib_umem_odp, interval_tree);\r\nret_val = cb(umem->umem, start, last, cookie) || ret_val;\r\n}\r\nreturn ret_val;\r\n}\r\nstruct ib_umem_odp *rbt_ib_umem_lookup(struct rb_root *root,\r\nu64 addr, u64 length)\r\n{\r\nstruct umem_odp_node *node;\r\nnode = rbt_ib_umem_iter_first(root, addr, addr + length - 1);\r\nif (node)\r\nreturn container_of(node, struct ib_umem_odp, interval_tree);\r\nreturn NULL;\r\n}
