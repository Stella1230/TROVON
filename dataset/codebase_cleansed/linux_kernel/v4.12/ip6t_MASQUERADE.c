static unsigned int\r\nmasquerade_tg6(struct sk_buff *skb, const struct xt_action_param *par)\r\n{\r\nreturn nf_nat_masquerade_ipv6(skb, par->targinfo, xt_out(par));\r\n}\r\nstatic int masquerade_tg6_checkentry(const struct xt_tgchk_param *par)\r\n{\r\nconst struct nf_nat_range *range = par->targinfo;\r\nif (range->flags & NF_NAT_RANGE_MAP_IPS)\r\nreturn -EINVAL;\r\nreturn 0;\r\n}\r\nstatic int __init masquerade_tg6_init(void)\r\n{\r\nint err;\r\nerr = xt_register_target(&masquerade_tg6_reg);\r\nif (err == 0)\r\nnf_nat_masquerade_ipv6_register_notifier();\r\nreturn err;\r\n}\r\nstatic void __exit masquerade_tg6_exit(void)\r\n{\r\nnf_nat_masquerade_ipv6_unregister_notifier();\r\nxt_unregister_target(&masquerade_tg6_reg);\r\n}
