static void\r\nsmb2_print_status(__le32 status)\r\n{\r\nint idx = 0;\r\nwhile (smb2_error_map_table[idx].status_string != NULL) {\r\nif ((smb2_error_map_table[idx].smb2_status) == status) {\r\npr_notice("Status code returned 0x%08x %s\n", status,\r\nsmb2_error_map_table[idx].status_string);\r\n}\r\nidx++;\r\n}\r\nreturn;\r\n}\r\nint\r\nmap_smb2_to_linux_error(char *buf, bool log_err)\r\n{\r\nstruct smb2_sync_hdr *shdr = get_sync_hdr(buf);\r\nunsigned int i;\r\nint rc = -EIO;\r\n__le32 smb2err = shdr->Status;\r\nif (smb2err == 0)\r\nreturn 0;\r\nif (log_err && (smb2err != STATUS_MORE_PROCESSING_REQUIRED) &&\r\n(smb2err != STATUS_END_OF_FILE))\r\nsmb2_print_status(smb2err);\r\nelse if (cifsFYI & CIFS_RC)\r\nsmb2_print_status(smb2err);\r\nfor (i = 0; i < sizeof(smb2_error_map_table) /\r\nsizeof(struct status_to_posix_error); i++) {\r\nif (smb2_error_map_table[i].smb2_status == smb2err) {\r\nrc = smb2_error_map_table[i].posix_error;\r\nbreak;\r\n}\r\n}\r\ncifs_dbg(FYI, "Mapping SMB2 status code %d to POSIX err %d\n",\r\nsmb2err, rc);\r\nreturn rc;\r\n}
