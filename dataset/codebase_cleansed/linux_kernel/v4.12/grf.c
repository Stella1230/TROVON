static int __init rockchip_grf_init(void)\r\n{\r\nconst struct rockchip_grf_info *grf_info;\r\nconst struct of_device_id *match;\r\nstruct device_node *np;\r\nstruct regmap *grf;\r\nint ret, i;\r\nnp = of_find_matching_node_and_match(NULL, rockchip_grf_dt_match,\r\n&match);\r\nif (!np)\r\nreturn -ENODEV;\r\nif (!match || !match->data) {\r\npr_err("%s: missing grf data\n", __func__);\r\nreturn -EINVAL;\r\n}\r\ngrf_info = match->data;\r\ngrf = syscon_node_to_regmap(np);\r\nif (IS_ERR(grf)) {\r\npr_err("%s: could not get grf syscon\n", __func__);\r\nreturn PTR_ERR(grf);\r\n}\r\nfor (i = 0; i < grf_info->num_values; i++) {\r\nconst struct rockchip_grf_value *val = &grf_info->values[i];\r\npr_debug("%s: adjusting %s in %#6x to %#10x\n", __func__,\r\nval->desc, val->reg, val->val);\r\nret = regmap_write(grf, val->reg, val->val);\r\nif (ret < 0)\r\npr_err("%s: write to %#6x failed with %d\n",\r\n__func__, val->reg, ret);\r\n}\r\nreturn 0;\r\n}
