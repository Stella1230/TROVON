int lmv_fld_lookup(struct lmv_obd *lmv, const struct lu_fid *fid, u32 *mds)\r\n{\r\nstruct obd_device *obd = lmv2obd_dev(lmv);\r\nint rc;\r\nif (!fid_is_sane(fid) || !(fid_seq_in_fldb(fid_seq(fid)) ||\r\nfid_seq_is_local_file(fid_seq(fid)))) {\r\nCERROR("%s: invalid FID " DFID "\n", obd->obd_name, PFID(fid));\r\nreturn -EINVAL;\r\n}\r\nrc = fld_client_lookup(&lmv->lmv_fld, fid_seq(fid), mds,\r\nLU_SEQ_RANGE_MDT, NULL);\r\nif (rc) {\r\nCERROR("Error while looking for mds number. Seq %#llx, err = %d\n",\r\nfid_seq(fid), rc);\r\nreturn rc;\r\n}\r\nCDEBUG(D_INODE, "FLD lookup got mds #%x for fid="DFID"\n",\r\n*mds, PFID(fid));\r\nif (*mds >= lmv->desc.ld_tgt_count) {\r\nCERROR("FLD lookup got invalid mds #%x (max: %x) for fid=" DFID "\n", *mds, lmv->desc.ld_tgt_count,\r\nPFID(fid));\r\nrc = -EINVAL;\r\n}\r\nreturn rc;\r\n}
