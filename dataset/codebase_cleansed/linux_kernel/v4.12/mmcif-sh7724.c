asmlinkage void mmcif_loader(unsigned char *buf, unsigned long no_bytes)\r\n{\r\nmmcif_update_progress(MMCIF_PROGRESS_ENTER);\r\n__raw_writel(__raw_readl(MSTPCR2) & ~0x20000000, MSTPCR2);\r\n__raw_writew(0x0000, PTWCR);\r\n__raw_writew(__raw_readw(PTXCR) & ~0x000f, PTXCR);\r\n__raw_writew(__raw_readw(PSELA) & ~0x2000, PSELA);\r\n__raw_writew(__raw_readw(PSELE) & ~0x3000, PSELE);\r\n__raw_writew(__raw_readw(HIZCRC) & ~0x0620, HIZCRC);\r\n__raw_writew(__raw_readw(DRVCRA) | 0x3000, DRVCRA);\r\nmmcif_update_progress(MMCIF_PROGRESS_INIT);\r\nsh_mmcif_boot_init(MMCIF_BASE);\r\nmmcif_update_progress(MMCIF_PROGRESS_LOAD);\r\nsh_mmcif_boot_do_read(MMCIF_BASE, 512,\r\n(no_bytes + SH_MMCIF_BBS - 1) / SH_MMCIF_BBS,\r\nbuf);\r\n__raw_writel(__raw_readl(MSTPCR2) | 0x20000000, MSTPCR2);\r\nmmcif_update_progress(MMCIF_PROGRESS_DONE);\r\n}
