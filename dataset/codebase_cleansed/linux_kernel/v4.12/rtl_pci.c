static void _rtl92e_parse_pci_configuration(struct pci_dev *pdev,\r\nstruct net_device *dev)\r\n{\r\nstruct r8192_priv *priv = (struct r8192_priv *)rtllib_priv(dev);\r\nu8 tmp;\r\nu16 LinkCtrlReg;\r\npcie_capability_read_word(priv->pdev, PCI_EXP_LNKCTL, &LinkCtrlReg);\r\nRT_TRACE(COMP_INIT, "Link Control Register =%x\n", LinkCtrlReg);\r\npci_read_config_byte(pdev, 0x98, &tmp);\r\ntmp |= BIT4;\r\npci_write_config_byte(pdev, 0x98, tmp);\r\ntmp = 0x17;\r\npci_write_config_byte(pdev, 0x70f, tmp);\r\n}\r\nbool rtl92e_check_adapter(struct pci_dev *pdev, struct net_device *dev)\r\n{\r\nstruct r8192_priv *priv = (struct r8192_priv *)rtllib_priv(dev);\r\nu16 VenderID;\r\nu16 DeviceID;\r\nu8 RevisionID;\r\nu16 IrqLine;\r\nVenderID = pdev->vendor;\r\nDeviceID = pdev->device;\r\nRevisionID = pdev->revision;\r\npci_read_config_word(pdev, 0x3C, &IrqLine);\r\npriv->card_8192 = priv->ops->nic_type;\r\nif (DeviceID == 0x8192) {\r\nswitch (RevisionID) {\r\ncase HAL_HW_PCI_REVISION_ID_8192PCIE:\r\ndev_info(&pdev->dev,\r\n"Adapter(8192 PCI-E) is found - DeviceID=%x\n",\r\nDeviceID);\r\npriv->card_8192 = NIC_8192E;\r\nbreak;\r\ncase HAL_HW_PCI_REVISION_ID_8192SE:\r\ndev_info(&pdev->dev,\r\n"Adapter(8192SE) is found - DeviceID=%x\n",\r\nDeviceID);\r\npriv->card_8192 = NIC_8192SE;\r\nbreak;\r\ndefault:\r\ndev_info(&pdev->dev,\r\n"UNKNOWN nic type(%4x:%4x)\n",\r\npdev->vendor, pdev->device);\r\npriv->card_8192 = NIC_UNKNOWN;\r\nreturn false;\r\n}\r\n}\r\nif (priv->ops->nic_type != priv->card_8192) {\r\ndev_info(&pdev->dev,\r\n"Detect info(%x) and hardware info(%x) not match!\n",\r\npriv->ops->nic_type, priv->card_8192);\r\ndev_info(&pdev->dev,\r\n"Please select proper driver before install!!!!\n");\r\nreturn false;\r\n}\r\n_rtl92e_parse_pci_configuration(pdev, dev);\r\nreturn true;\r\n}
