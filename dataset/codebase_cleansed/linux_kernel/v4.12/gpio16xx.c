static int __init omap16xx_gpio_init(void)\r\n{\r\nint i;\r\nvoid __iomem *base;\r\nstruct resource *res;\r\nstruct platform_device *pdev;\r\nstruct omap_gpio_platform_data *pdata;\r\nif (!cpu_is_omap16xx())\r\nreturn -EINVAL;\r\nomap_writel(omap_readl(ULPD_CAM_CLK_CTRL) | 0x04,\r\nULPD_CAM_CLK_CTRL);\r\nfor (i = 0; i < ARRAY_SIZE(omap16xx_gpio_dev); i++) {\r\npdev = omap16xx_gpio_dev[i];\r\npdata = pdev->dev.platform_data;\r\nres = platform_get_resource(pdev, IORESOURCE_MEM, 0);\r\nif (unlikely(!res)) {\r\ndev_err(&pdev->dev, "Invalid mem resource.\n");\r\nreturn -ENODEV;\r\n}\r\nbase = ioremap(res->start, resource_size(res));\r\nif (unlikely(!base)) {\r\ndev_err(&pdev->dev, "ioremap failed.\n");\r\nreturn -ENOMEM;\r\n}\r\n__raw_writel(SYSCONFIG_WORD, base + OMAP1610_GPIO_SYSCONFIG);\r\niounmap(base);\r\nplatform_device_register(omap16xx_gpio_dev[i]);\r\n}\r\nreturn 0;\r\n}
