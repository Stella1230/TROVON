static int ac100_rsb_probe(struct sunxi_rsb_device *rdev)\r\n{\r\nstruct ac100_dev *ac100;\r\nint ret;\r\nac100 = devm_kzalloc(&rdev->dev, sizeof(*ac100), GFP_KERNEL);\r\nif (!ac100)\r\nreturn -ENOMEM;\r\nac100->dev = &rdev->dev;\r\nsunxi_rsb_device_set_drvdata(rdev, ac100);\r\nac100->regmap = devm_regmap_init_sunxi_rsb(rdev, &ac100_regmap_config);\r\nif (IS_ERR(ac100->regmap)) {\r\nret = PTR_ERR(ac100->regmap);\r\ndev_err(ac100->dev, "regmap init failed: %d\n", ret);\r\nreturn ret;\r\n}\r\nret = devm_mfd_add_devices(ac100->dev, PLATFORM_DEVID_NONE, ac100_cells,\r\nARRAY_SIZE(ac100_cells), NULL, 0, NULL);\r\nif (ret) {\r\ndev_err(ac100->dev, "failed to add MFD devices: %d\n", ret);\r\nreturn ret;\r\n}\r\nreturn 0;\r\n}
