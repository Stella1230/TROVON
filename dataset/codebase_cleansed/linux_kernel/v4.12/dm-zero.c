static int zero_ctr(struct dm_target *ti, unsigned int argc, char **argv)\r\n{\r\nif (argc != 0) {\r\nti->error = "No arguments required";\r\nreturn -EINVAL;\r\n}\r\nti->num_discard_bios = 1;\r\nreturn 0;\r\n}\r\nstatic int zero_map(struct dm_target *ti, struct bio *bio)\r\n{\r\nswitch (bio_op(bio)) {\r\ncase REQ_OP_READ:\r\nif (bio->bi_opf & REQ_RAHEAD) {\r\nreturn -EIO;\r\n}\r\nzero_fill_bio(bio);\r\nbreak;\r\ncase REQ_OP_WRITE:\r\nbreak;\r\ndefault:\r\nreturn -EIO;\r\n}\r\nbio_endio(bio);\r\nreturn DM_MAPIO_SUBMITTED;\r\n}\r\nstatic int __init dm_zero_init(void)\r\n{\r\nint r = dm_register_target(&zero_target);\r\nif (r < 0)\r\nDMERR("register failed %d", r);\r\nreturn r;\r\n}\r\nstatic void __exit dm_zero_exit(void)\r\n{\r\ndm_unregister_target(&zero_target);\r\n}
