static void __init m54xx_uarts_init(void)\r\n{\r\n__raw_writeb(MCF_PAR_PSC_TXD | MCF_PAR_PSC_RXD, MCFGPIO_PAR_PSC0);\r\n__raw_writeb(MCF_PAR_PSC_TXD | MCF_PAR_PSC_RXD | MCF_PAR_PSC_RTS_RTS,\r\nMCFGPIO_PAR_PSC1);\r\n__raw_writeb(MCF_PAR_PSC_TXD | MCF_PAR_PSC_RXD | MCF_PAR_PSC_RTS_RTS |\r\nMCF_PAR_PSC_CTS_CTS, MCFGPIO_PAR_PSC2);\r\n__raw_writeb(MCF_PAR_PSC_TXD | MCF_PAR_PSC_RXD, MCFGPIO_PAR_PSC3);\r\n}\r\nstatic void __init m54xx_i2c_init(void)\r\n{\r\n#if IS_ENABLED(CONFIG_I2C_IMX)\r\nu32 r;\r\nr = readl(MCF_PAR_FECI2CIRQ);\r\nr |= MCF_PAR_FECI2CIRQ_SDA | MCF_PAR_FECI2CIRQ_SCL;\r\nwritel(r, MCF_PAR_FECI2CIRQ);\r\n#endif\r\n}\r\nstatic void mcf54xx_reset(void)\r\n{\r\nasm("movew #0x2700, %sr\n");\r\n__raw_writel(0, MCF_GPT_GMS0);\r\n__raw_writel(MCF_GPT_GCIR_CNT(1), MCF_GPT_GCIR0);\r\n__raw_writel(MCF_GPT_GMS_WDEN | MCF_GPT_GMS_CE | MCF_GPT_GMS_TMS(4),\r\nMCF_GPT_GMS0);\r\n}\r\nvoid __init config_BSP(char *commandp, int size)\r\n{\r\n#ifdef CONFIG_MMU\r\ncf_bootmem_alloc();\r\nmmu_context_init();\r\n#endif\r\nmach_reset = mcf54xx_reset;\r\nmach_sched_init = hw_timer_init;\r\nm54xx_uarts_init();\r\nm54xx_i2c_init();\r\n}
