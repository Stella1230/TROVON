static int intel_lpss_pci_probe(struct pci_dev *pdev,\r\nconst struct pci_device_id *id)\r\n{\r\nstruct intel_lpss_platform_info *info;\r\nint ret;\r\nret = pcim_enable_device(pdev);\r\nif (ret)\r\nreturn ret;\r\ninfo = devm_kmemdup(&pdev->dev, (void *)id->driver_data, sizeof(*info),\r\nGFP_KERNEL);\r\nif (!info)\r\nreturn -ENOMEM;\r\ninfo->mem = &pdev->resource[0];\r\ninfo->irq = pdev->irq;\r\npci_set_master(pdev);\r\npci_try_set_mwi(pdev);\r\nret = intel_lpss_probe(&pdev->dev, info);\r\nif (ret)\r\nreturn ret;\r\npm_runtime_put(&pdev->dev);\r\npm_runtime_allow(&pdev->dev);\r\nreturn 0;\r\n}\r\nstatic void intel_lpss_pci_remove(struct pci_dev *pdev)\r\n{\r\npm_runtime_forbid(&pdev->dev);\r\npm_runtime_get_sync(&pdev->dev);\r\nintel_lpss_remove(&pdev->dev);\r\n}
