static ssize_t xsd_read(struct file *file, char __user *buf,\r\nsize_t size, loff_t *off)\r\n{\r\nconst char *str = (const char *)file->private_data;\r\nreturn simple_read_from_buffer(buf, size, off, str, strlen(str));\r\n}\r\nstatic int xsd_release(struct inode *inode, struct file *file)\r\n{\r\nkfree(file->private_data);\r\nreturn 0;\r\n}\r\nstatic int xsd_kva_open(struct inode *inode, struct file *file)\r\n{\r\nfile->private_data = (void *)kasprintf(GFP_KERNEL, "0x%p",\r\nxen_store_interface);\r\nif (!file->private_data)\r\nreturn -ENOMEM;\r\nreturn 0;\r\n}\r\nstatic int xsd_kva_mmap(struct file *file, struct vm_area_struct *vma)\r\n{\r\nsize_t size = vma->vm_end - vma->vm_start;\r\nif ((size > PAGE_SIZE) || (vma->vm_pgoff != 0))\r\nreturn -EINVAL;\r\nif (remap_pfn_range(vma, vma->vm_start,\r\nvirt_to_pfn(xen_store_interface),\r\nsize, vma->vm_page_prot))\r\nreturn -EAGAIN;\r\nreturn 0;\r\n}\r\nstatic int xsd_port_open(struct inode *inode, struct file *file)\r\n{\r\nfile->private_data = (void *)kasprintf(GFP_KERNEL, "%d",\r\nxen_store_evtchn);\r\nif (!file->private_data)\r\nreturn -ENOMEM;\r\nreturn 0;\r\n}
