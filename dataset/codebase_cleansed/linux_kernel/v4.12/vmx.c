int __init p8_init(void)\r\n{\r\nint ret = 0;\r\nstruct crypto_alg **alg_it;\r\nfor (alg_it = algs; *alg_it; alg_it++) {\r\nret = crypto_register_alg(*alg_it);\r\nprintk(KERN_INFO "crypto_register_alg '%s' = %d\n",\r\n(*alg_it)->cra_name, ret);\r\nif (ret) {\r\nfor (alg_it--; alg_it >= algs; alg_it--)\r\ncrypto_unregister_alg(*alg_it);\r\nbreak;\r\n}\r\n}\r\nif (ret)\r\nreturn ret;\r\nret = crypto_register_shash(&p8_ghash_alg);\r\nif (ret) {\r\nfor (alg_it = algs; *alg_it; alg_it++)\r\ncrypto_unregister_alg(*alg_it);\r\n}\r\nreturn ret;\r\n}\r\nvoid __exit p8_exit(void)\r\n{\r\nstruct crypto_alg **alg_it;\r\nfor (alg_it = algs; *alg_it; alg_it++) {\r\nprintk(KERN_INFO "Removing '%s'\n", (*alg_it)->cra_name);\r\ncrypto_unregister_alg(*alg_it);\r\n}\r\ncrypto_unregister_shash(&p8_ghash_alg);\r\n}
