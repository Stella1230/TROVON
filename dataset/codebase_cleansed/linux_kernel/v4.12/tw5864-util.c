void tw5864_indir_writeb(struct tw5864_dev *dev, u16 addr, u8 data)\r\n{\r\nint retries = 30000;\r\nwhile (tw_readl(TW5864_IND_CTL) & BIT(31) && --retries)\r\n;\r\nif (!retries)\r\ndev_err(&dev->pci->dev,\r\n"tw_indir_writel() retries exhausted before writing\n");\r\ntw_writel(TW5864_IND_DATA, data);\r\ntw_writel(TW5864_IND_CTL, addr << 2 | TW5864_RW | TW5864_ENABLE);\r\n}\r\nu8 tw5864_indir_readb(struct tw5864_dev *dev, u16 addr)\r\n{\r\nint retries = 30000;\r\nwhile (tw_readl(TW5864_IND_CTL) & BIT(31) && --retries)\r\n;\r\nif (!retries)\r\ndev_err(&dev->pci->dev,\r\n"tw_indir_readl() retries exhausted before reading\n");\r\ntw_writel(TW5864_IND_CTL, addr << 2 | TW5864_ENABLE);\r\nretries = 30000;\r\nwhile (tw_readl(TW5864_IND_CTL) & BIT(31) && --retries)\r\n;\r\nif (!retries)\r\ndev_err(&dev->pci->dev,\r\n"tw_indir_readl() retries exhausted at reading\n");\r\nreturn tw_readl(TW5864_IND_DATA);\r\n}
