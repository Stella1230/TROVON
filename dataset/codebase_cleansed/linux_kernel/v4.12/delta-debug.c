char *delta_streaminfo_str(struct delta_streaminfo *s, char *str,\r\nunsigned int len)\r\n{\r\nif (!s)\r\nreturn NULL;\r\nsnprintf(str, len,\r\n"%4.4s %dx%d %s %s dpb=%d %s %s %s%dx%d@(%d,%d) %s%d/%d",\r\n(char *)&s->streamformat, s->width, s->height,\r\ns->profile, s->level, s->dpb,\r\n(s->field == V4L2_FIELD_NONE) ? "progressive" : "interlaced",\r\ns->other,\r\ns->flags & DELTA_STREAMINFO_FLAG_CROP ? "crop=" : "",\r\ns->crop.width, s->crop.height,\r\ns->crop.left, s->crop.top,\r\ns->flags & DELTA_STREAMINFO_FLAG_PIXELASPECT ? "par=" : "",\r\ns->pixelaspect.numerator,\r\ns->pixelaspect.denominator);\r\nreturn str;\r\n}\r\nchar *delta_frameinfo_str(struct delta_frameinfo *f, char *str,\r\nunsigned int len)\r\n{\r\nif (!f)\r\nreturn NULL;\r\nsnprintf(str, len,\r\n"%4.4s %dx%d aligned %dx%d %s %s%dx%d@(%d,%d) %s%d/%d",\r\n(char *)&f->pixelformat, f->width, f->height,\r\nf->aligned_width, f->aligned_height,\r\n(f->field == V4L2_FIELD_NONE) ? "progressive" : "interlaced",\r\nf->flags & DELTA_STREAMINFO_FLAG_CROP ? "crop=" : "",\r\nf->crop.width, f->crop.height,\r\nf->crop.left, f->crop.top,\r\nf->flags & DELTA_STREAMINFO_FLAG_PIXELASPECT ? "par=" : "",\r\nf->pixelaspect.numerator,\r\nf->pixelaspect.denominator);\r\nreturn str;\r\n}\r\nvoid delta_trace_summary(struct delta_ctx *ctx)\r\n{\r\nstruct delta_dev *delta = ctx->dev;\r\nstruct delta_streaminfo *s = &ctx->streaminfo;\r\nunsigned char str[100] = "";\r\nif (!(ctx->flags & DELTA_FLAG_STREAMINFO))\r\nreturn;\r\ndev_dbg(delta->dev, "%s %s, %d frames decoded, %d frames output, %d frames dropped, %d stream errors, %d decode errors",\r\nctx->name,\r\ndelta_streaminfo_str(s, str, sizeof(str)),\r\nctx->decoded_frames,\r\nctx->output_frames,\r\nctx->dropped_frames,\r\nctx->stream_errors,\r\nctx->decode_errors);\r\n}
