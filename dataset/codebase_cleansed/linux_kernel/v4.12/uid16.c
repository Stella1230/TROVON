static int groups16_to_user(old_gid_t __user *grouplist,\r\nstruct group_info *group_info)\r\n{\r\nstruct user_namespace *user_ns = current_user_ns();\r\nint i;\r\nold_gid_t group;\r\nkgid_t kgid;\r\nfor (i = 0; i < group_info->ngroups; i++) {\r\nkgid = group_info->gid[i];\r\ngroup = high2lowgid(from_kgid_munged(user_ns, kgid));\r\nif (put_user(group, grouplist+i))\r\nreturn -EFAULT;\r\n}\r\nreturn 0;\r\n}\r\nstatic int groups16_from_user(struct group_info *group_info,\r\nold_gid_t __user *grouplist)\r\n{\r\nstruct user_namespace *user_ns = current_user_ns();\r\nint i;\r\nold_gid_t group;\r\nkgid_t kgid;\r\nfor (i = 0; i < group_info->ngroups; i++) {\r\nif (get_user(group, grouplist+i))\r\nreturn -EFAULT;\r\nkgid = make_kgid(user_ns, low2highgid(group));\r\nif (!gid_valid(kgid))\r\nreturn -EINVAL;\r\ngroup_info->gid[i] = kgid;\r\n}\r\nreturn 0;\r\n}
