static int kirkwood_enter_idle(struct cpuidle_device *dev,\r\nstruct cpuidle_driver *drv,\r\nint index)\r\n{\r\nwritel(0x7, ddr_operation_base);\r\ncpu_do_idle();\r\nreturn index;\r\n}\r\nstatic int kirkwood_cpuidle_probe(struct platform_device *pdev)\r\n{\r\nstruct resource *res;\r\nres = platform_get_resource(pdev, IORESOURCE_MEM, 0);\r\nddr_operation_base = devm_ioremap_resource(&pdev->dev, res);\r\nif (IS_ERR(ddr_operation_base))\r\nreturn PTR_ERR(ddr_operation_base);\r\nreturn cpuidle_register(&kirkwood_idle_driver, NULL);\r\n}\r\nstatic int kirkwood_cpuidle_remove(struct platform_device *pdev)\r\n{\r\ncpuidle_unregister(&kirkwood_idle_driver);\r\nreturn 0;\r\n}
