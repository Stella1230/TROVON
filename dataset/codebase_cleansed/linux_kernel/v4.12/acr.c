void *\r\nnvkm_acr_load_firmware(const struct nvkm_subdev *subdev, const char *name,\r\nsize_t min_size)\r\n{\r\nconst struct firmware *fw;\r\nvoid *blob;\r\nint ret;\r\nret = nvkm_firmware_get(subdev->device, name, &fw);\r\nif (ret)\r\nreturn ERR_PTR(ret);\r\nif (fw->size < min_size) {\r\nnvkm_error(subdev, "%s is smaller than expected size %zu\n",\r\nname, min_size);\r\nnvkm_firmware_put(fw);\r\nreturn ERR_PTR(-EINVAL);\r\n}\r\nblob = kmemdup(fw->data, fw->size, GFP_KERNEL);\r\nnvkm_firmware_put(fw);\r\nif (!blob)\r\nreturn ERR_PTR(-ENOMEM);\r\nreturn blob;\r\n}
