acpi_status ACPI_INIT_FUNCTION acpi_terminate(void)\r\n{\r\nacpi_status status;\r\nACPI_FUNCTION_TRACE(acpi_terminate);\r\nacpi_ut_subsystem_shutdown();\r\nacpi_ut_mutex_terminate();\r\nstatus = acpi_os_terminate();\r\nreturn_ACPI_STATUS(status);\r\n}\r\nacpi_status acpi_subsystem_status(void)\r\n{\r\nif (acpi_gbl_startup_flags & ACPI_INITIALIZED_OK) {\r\nreturn (AE_OK);\r\n} else {\r\nreturn (AE_ERROR);\r\n}\r\n}\r\nacpi_status acpi_get_system_info(struct acpi_buffer *out_buffer)\r\n{\r\nstruct acpi_system_info *info_ptr;\r\nacpi_status status;\r\nACPI_FUNCTION_TRACE(acpi_get_system_info);\r\nstatus = acpi_ut_validate_buffer(out_buffer);\r\nif (ACPI_FAILURE(status)) {\r\nreturn_ACPI_STATUS(status);\r\n}\r\nstatus =\r\nacpi_ut_initialize_buffer(out_buffer,\r\nsizeof(struct acpi_system_info));\r\nif (ACPI_FAILURE(status)) {\r\nreturn_ACPI_STATUS(status);\r\n}\r\ninfo_ptr = (struct acpi_system_info *)out_buffer->pointer;\r\ninfo_ptr->acpi_ca_version = ACPI_CA_VERSION;\r\ninfo_ptr->flags = ACPI_SYS_MODE_ACPI;\r\nif (acpi_gbl_FADT.flags & ACPI_FADT_32BIT_TIMER) {\r\ninfo_ptr->timer_resolution = 24;\r\n} else {\r\ninfo_ptr->timer_resolution = 32;\r\n}\r\ninfo_ptr->reserved1 = 0;\r\ninfo_ptr->reserved2 = 0;\r\ninfo_ptr->debug_layer = acpi_dbg_layer;\r\ninfo_ptr->debug_level = acpi_dbg_level;\r\nreturn_ACPI_STATUS(AE_OK);\r\n}\r\nacpi_status acpi_get_statistics(struct acpi_statistics *stats)\r\n{\r\nACPI_FUNCTION_TRACE(acpi_get_statistics);\r\nif (!stats) {\r\nreturn_ACPI_STATUS(AE_BAD_PARAMETER);\r\n}\r\nstats->sci_count = acpi_sci_count;\r\nstats->gpe_count = acpi_gpe_count;\r\nmemcpy(stats->fixed_event_count, acpi_fixed_event_count,\r\nsizeof(acpi_fixed_event_count));\r\nstats->method_count = acpi_method_count;\r\nreturn_ACPI_STATUS(AE_OK);\r\n}\r\nacpi_status\r\nacpi_install_initialization_handler(acpi_init_handler handler, u32 function)\r\n{\r\nif (!handler) {\r\nreturn (AE_BAD_PARAMETER);\r\n}\r\nif (acpi_gbl_init_handler) {\r\nreturn (AE_ALREADY_EXISTS);\r\n}\r\nacpi_gbl_init_handler = handler;\r\nreturn (AE_OK);\r\n}\r\nacpi_status acpi_purge_cached_objects(void)\r\n{\r\nACPI_FUNCTION_TRACE(acpi_purge_cached_objects);\r\n(void)acpi_os_purge_cache(acpi_gbl_state_cache);\r\n(void)acpi_os_purge_cache(acpi_gbl_operand_cache);\r\n(void)acpi_os_purge_cache(acpi_gbl_ps_node_cache);\r\n(void)acpi_os_purge_cache(acpi_gbl_ps_node_ext_cache);\r\nreturn_ACPI_STATUS(AE_OK);\r\n}\r\nacpi_status acpi_install_interface(acpi_string interface_name)\r\n{\r\nacpi_status status;\r\nstruct acpi_interface_info *interface_info;\r\nif (!interface_name || (strlen(interface_name) == 0)) {\r\nreturn (AE_BAD_PARAMETER);\r\n}\r\nstatus = acpi_os_acquire_mutex(acpi_gbl_osi_mutex, ACPI_WAIT_FOREVER);\r\nif (ACPI_FAILURE(status)) {\r\nreturn (status);\r\n}\r\ninterface_info = acpi_ut_get_interface(interface_name);\r\nif (interface_info) {\r\nif (interface_info->flags & ACPI_OSI_INVALID) {\r\ninterface_info->flags &= ~ACPI_OSI_INVALID;\r\nstatus = AE_OK;\r\n} else {\r\nstatus = AE_ALREADY_EXISTS;\r\n}\r\n} else {\r\nstatus = acpi_ut_install_interface(interface_name);\r\n}\r\nacpi_os_release_mutex(acpi_gbl_osi_mutex);\r\nreturn (status);\r\n}\r\nacpi_status acpi_remove_interface(acpi_string interface_name)\r\n{\r\nacpi_status status;\r\nif (!interface_name || (strlen(interface_name) == 0)) {\r\nreturn (AE_BAD_PARAMETER);\r\n}\r\nstatus = acpi_os_acquire_mutex(acpi_gbl_osi_mutex, ACPI_WAIT_FOREVER);\r\nif (ACPI_FAILURE(status)) {\r\nreturn (status);\r\n}\r\nstatus = acpi_ut_remove_interface(interface_name);\r\nacpi_os_release_mutex(acpi_gbl_osi_mutex);\r\nreturn (status);\r\n}\r\nacpi_status acpi_install_interface_handler(acpi_interface_handler handler)\r\n{\r\nacpi_status status;\r\nstatus = acpi_os_acquire_mutex(acpi_gbl_osi_mutex, ACPI_WAIT_FOREVER);\r\nif (ACPI_FAILURE(status)) {\r\nreturn (status);\r\n}\r\nif (handler && acpi_gbl_interface_handler) {\r\nstatus = AE_ALREADY_EXISTS;\r\n} else {\r\nacpi_gbl_interface_handler = handler;\r\n}\r\nacpi_os_release_mutex(acpi_gbl_osi_mutex);\r\nreturn (status);\r\n}\r\nacpi_status acpi_update_interfaces(u8 action)\r\n{\r\nacpi_status status;\r\nstatus = acpi_os_acquire_mutex(acpi_gbl_osi_mutex, ACPI_WAIT_FOREVER);\r\nif (ACPI_FAILURE(status)) {\r\nreturn (status);\r\n}\r\nstatus = acpi_ut_update_interfaces(action);\r\nacpi_os_release_mutex(acpi_gbl_osi_mutex);\r\nreturn (status);\r\n}\r\nu32\r\nacpi_check_address_range(acpi_adr_space_type space_id,\r\nacpi_physical_address address,\r\nacpi_size length, u8 warn)\r\n{\r\nu32 overlaps;\r\nacpi_status status;\r\nstatus = acpi_ut_acquire_mutex(ACPI_MTX_NAMESPACE);\r\nif (ACPI_FAILURE(status)) {\r\nreturn (0);\r\n}\r\noverlaps = acpi_ut_check_address_range(space_id, address,\r\n(u32)length, warn);\r\n(void)acpi_ut_release_mutex(ACPI_MTX_NAMESPACE);\r\nreturn (overlaps);\r\n}\r\nacpi_status\r\nacpi_decode_pld_buffer(u8 *in_buffer,\r\nacpi_size length, struct acpi_pld_info **return_buffer)\r\n{\r\nstruct acpi_pld_info *pld_info;\r\nu32 *buffer = ACPI_CAST_PTR(u32, in_buffer);\r\nu32 dword;\r\nif (!in_buffer || !return_buffer\r\n|| (length < ACPI_PLD_REV1_BUFFER_SIZE)) {\r\nreturn (AE_BAD_PARAMETER);\r\n}\r\npld_info = ACPI_ALLOCATE_ZEROED(sizeof(struct acpi_pld_info));\r\nif (!pld_info) {\r\nreturn (AE_NO_MEMORY);\r\n}\r\nACPI_MOVE_32_TO_32(&dword, &buffer[0]);\r\npld_info->revision = ACPI_PLD_GET_REVISION(&dword);\r\npld_info->ignore_color = ACPI_PLD_GET_IGNORE_COLOR(&dword);\r\npld_info->red = ACPI_PLD_GET_RED(&dword);\r\npld_info->green = ACPI_PLD_GET_GREEN(&dword);\r\npld_info->blue = ACPI_PLD_GET_BLUE(&dword);\r\nACPI_MOVE_32_TO_32(&dword, &buffer[1]);\r\npld_info->width = ACPI_PLD_GET_WIDTH(&dword);\r\npld_info->height = ACPI_PLD_GET_HEIGHT(&dword);\r\nACPI_MOVE_32_TO_32(&dword, &buffer[2]);\r\npld_info->user_visible = ACPI_PLD_GET_USER_VISIBLE(&dword);\r\npld_info->dock = ACPI_PLD_GET_DOCK(&dword);\r\npld_info->lid = ACPI_PLD_GET_LID(&dword);\r\npld_info->panel = ACPI_PLD_GET_PANEL(&dword);\r\npld_info->vertical_position = ACPI_PLD_GET_VERTICAL(&dword);\r\npld_info->horizontal_position = ACPI_PLD_GET_HORIZONTAL(&dword);\r\npld_info->shape = ACPI_PLD_GET_SHAPE(&dword);\r\npld_info->group_orientation = ACPI_PLD_GET_ORIENTATION(&dword);\r\npld_info->group_token = ACPI_PLD_GET_TOKEN(&dword);\r\npld_info->group_position = ACPI_PLD_GET_POSITION(&dword);\r\npld_info->bay = ACPI_PLD_GET_BAY(&dword);\r\nACPI_MOVE_32_TO_32(&dword, &buffer[3]);\r\npld_info->ejectable = ACPI_PLD_GET_EJECTABLE(&dword);\r\npld_info->ospm_eject_required = ACPI_PLD_GET_OSPM_EJECT(&dword);\r\npld_info->cabinet_number = ACPI_PLD_GET_CABINET(&dword);\r\npld_info->card_cage_number = ACPI_PLD_GET_CARD_CAGE(&dword);\r\npld_info->reference = ACPI_PLD_GET_REFERENCE(&dword);\r\npld_info->rotation = ACPI_PLD_GET_ROTATION(&dword);\r\npld_info->order = ACPI_PLD_GET_ORDER(&dword);\r\nif (length >= ACPI_PLD_REV2_BUFFER_SIZE) {\r\nACPI_MOVE_32_TO_32(&dword, &buffer[4]);\r\npld_info->vertical_offset = ACPI_PLD_GET_VERT_OFFSET(&dword);\r\npld_info->horizontal_offset = ACPI_PLD_GET_HORIZ_OFFSET(&dword);\r\n}\r\n*return_buffer = pld_info;\r\nreturn (AE_OK);\r\n}
