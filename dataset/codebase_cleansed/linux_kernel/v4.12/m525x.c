static void __init m525x_qspi_init(void)\r\n{\r\n#if IS_ENABLED(CONFIG_SPI_COLDFIRE_QSPI)\r\nu32 f = readl(MCFSIM2_GPIOFUNC);\r\nf |= (1 << MCFQSPI_CS2) | (1 << MCFQSPI_CS1) | (1 << MCFQSPI_CS0);\r\nwritel(f, MCFSIM2_GPIOFUNC);\r\nwriteb(MCFSIM_ICR_AUTOVEC | MCFSIM_ICR_LEVEL4 | MCFSIM_ICR_PRI0,\r\nMCFSIM_QSPIICR);\r\nmcf_mapirq2imr(MCF_IRQ_QSPI, MCFINTC_QSPI);\r\n#endif\r\n}\r\nstatic void __init m525x_i2c_init(void)\r\n{\r\n#if IS_ENABLED(CONFIG_I2C_IMX)\r\nu32 r;\r\nwriteb(MCFSIM_ICR_AUTOVEC | MCFSIM_ICR_LEVEL5 | MCFSIM_ICR_PRI0,\r\nMCFSIM_I2CICR);\r\nmcf_mapirq2imr(MCF_IRQ_I2C0, MCFINTC_I2C);\r\nr = readl(MCFINTC2_INTPRI_REG(MCF_IRQ_I2C1));\r\nr &= ~MCFINTC2_INTPRI_BITS(0xf, MCF_IRQ_I2C1);\r\nr |= MCFINTC2_INTPRI_BITS(0x5, MCF_IRQ_I2C1);\r\nwritel(r, MCFINTC2_INTPRI_REG(MCF_IRQ_I2C1));\r\n#endif\r\n}\r\nvoid __init config_BSP(char *commandp, int size)\r\n{\r\nmach_sched_init = hw_timer_init;\r\nm525x_qspi_init();\r\nm525x_i2c_init();\r\n}
