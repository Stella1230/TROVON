static int __init pci_iommu_init(void)\r\n{\r\nif (iommu_detected)\r\nintel_iommu_init();\r\nreturn 0;\r\n}\r\nvoid pci_iommu_shutdown(void)\r\n{\r\nreturn;\r\n}\r\nvoid __init\r\niommu_dma_init(void)\r\n{\r\nreturn;\r\n}\r\nint iommu_dma_supported(struct device *dev, u64 mask)\r\n{\r\nif (mask < DMA_BIT_MASK(24))\r\nreturn 0;\r\nif (iommu_sac_force && (mask >= DMA_BIT_MASK(40))) {\r\ndev_info(dev, "Force SAC with mask %llx\n", mask);\r\nreturn 0;\r\n}\r\nreturn 1;\r\n}\r\nvoid __init pci_iommu_alloc(void)\r\n{\r\ndma_ops = &intel_dma_ops;\r\nintel_dma_ops.sync_single_for_cpu = machvec_dma_sync_single;\r\nintel_dma_ops.sync_sg_for_cpu = machvec_dma_sync_sg;\r\nintel_dma_ops.sync_single_for_device = machvec_dma_sync_single;\r\nintel_dma_ops.sync_sg_for_device = machvec_dma_sync_sg;\r\nintel_dma_ops.dma_supported = iommu_dma_supported;\r\ndetect_intel_iommu();\r\n#ifdef CONFIG_SWIOTLB\r\npci_swiotlb_init();\r\n#endif\r\n}
