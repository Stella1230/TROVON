void devprop_gpiochip_set_names(struct gpio_chip *chip)\r\n{\r\nstruct gpio_device *gdev = chip->gpiodev;\r\nconst char **names;\r\nint ret, i;\r\nif (!chip->parent) {\r\ndev_warn(&gdev->dev, "GPIO chip parent is NULL\n");\r\nreturn;\r\n}\r\nret = device_property_read_string_array(chip->parent, "gpio-line-names",\r\nNULL, 0);\r\nif (ret < 0)\r\nreturn;\r\nif (ret != gdev->ngpio) {\r\ndev_warn(chip->parent,\r\n"names %d do not match number of GPIOs %d\n", ret,\r\ngdev->ngpio);\r\nreturn;\r\n}\r\nnames = kcalloc(gdev->ngpio, sizeof(*names), GFP_KERNEL);\r\nif (!names)\r\nreturn;\r\nret = device_property_read_string_array(chip->parent, "gpio-line-names",\r\nnames, gdev->ngpio);\r\nif (ret < 0) {\r\ndev_warn(chip->parent, "failed to read GPIO line names\n");\r\nkfree(names);\r\nreturn;\r\n}\r\nfor (i = 0; i < gdev->ngpio; i++)\r\ngdev->descs[i].name = names[i];\r\nkfree(names);\r\n}
