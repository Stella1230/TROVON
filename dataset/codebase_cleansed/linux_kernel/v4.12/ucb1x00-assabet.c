static int ucb1x00_assabet_add(struct ucb1x00_dev *dev)\r\n{\r\nstruct ucb1x00 *ucb = dev->ucb;\r\nstruct platform_device *pdev;\r\nstruct gpio_keys_platform_data keys;\r\nstatic struct gpio_keys_button buttons[6];\r\nunsigned i;\r\nmemset(buttons, 0, sizeof(buttons));\r\nmemset(&keys, 0, sizeof(keys));\r\nfor (i = 0; i < ARRAY_SIZE(buttons); i++) {\r\nbuttons[i].code = BTN_0 + i;\r\nbuttons[i].gpio = ucb->gpio.base + i;\r\nbuttons[i].type = EV_KEY;\r\nbuttons[i].can_disable = true;\r\n}\r\nkeys.buttons = buttons;\r\nkeys.nbuttons = ARRAY_SIZE(buttons);\r\nkeys.poll_interval = 50;\r\nkeys.name = "ucb1x00";\r\npdev = platform_device_register_data(&ucb->dev, "gpio-keys", -1,\r\n&keys, sizeof(keys));\r\ndevice_create_file(&ucb->dev, &dev_attr_vbatt);\r\ndevice_create_file(&ucb->dev, &dev_attr_vcharger);\r\ndevice_create_file(&ucb->dev, &dev_attr_batt_temp);\r\ndev->priv = pdev;\r\nreturn 0;\r\n}\r\nstatic void ucb1x00_assabet_remove(struct ucb1x00_dev *dev)\r\n{\r\nstruct platform_device *pdev = dev->priv;\r\nif (!IS_ERR(pdev))\r\nplatform_device_unregister(pdev);\r\ndevice_remove_file(&dev->ucb->dev, &dev_attr_batt_temp);\r\ndevice_remove_file(&dev->ucb->dev, &dev_attr_vcharger);\r\ndevice_remove_file(&dev->ucb->dev, &dev_attr_vbatt);\r\n}\r\nstatic int __init ucb1x00_assabet_init(void)\r\n{\r\nreturn ucb1x00_register_driver(&ucb1x00_assabet_driver);\r\n}\r\nstatic void __exit ucb1x00_assabet_exit(void)\r\n{\r\nucb1x00_unregister_driver(&ucb1x00_assabet_driver);\r\n}
