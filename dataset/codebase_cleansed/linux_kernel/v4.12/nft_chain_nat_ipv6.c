static unsigned int nft_nat_do_chain(void *priv,\r\nstruct sk_buff *skb,\r\nconst struct nf_hook_state *state,\r\nstruct nf_conn *ct)\r\n{\r\nstruct nft_pktinfo pkt;\r\nnft_set_pktinfo_ipv6(&pkt, skb, state);\r\nreturn nft_do_chain(&pkt, priv);\r\n}\r\nstatic unsigned int nft_nat_ipv6_fn(void *priv,\r\nstruct sk_buff *skb,\r\nconst struct nf_hook_state *state)\r\n{\r\nreturn nf_nat_ipv6_fn(priv, skb, state, nft_nat_do_chain);\r\n}\r\nstatic unsigned int nft_nat_ipv6_in(void *priv,\r\nstruct sk_buff *skb,\r\nconst struct nf_hook_state *state)\r\n{\r\nreturn nf_nat_ipv6_in(priv, skb, state, nft_nat_do_chain);\r\n}\r\nstatic unsigned int nft_nat_ipv6_out(void *priv,\r\nstruct sk_buff *skb,\r\nconst struct nf_hook_state *state)\r\n{\r\nreturn nf_nat_ipv6_out(priv, skb, state, nft_nat_do_chain);\r\n}\r\nstatic unsigned int nft_nat_ipv6_local_fn(void *priv,\r\nstruct sk_buff *skb,\r\nconst struct nf_hook_state *state)\r\n{\r\nreturn nf_nat_ipv6_local_fn(priv, skb, state, nft_nat_do_chain);\r\n}\r\nstatic int __init nft_chain_nat_ipv6_init(void)\r\n{\r\nint err;\r\nerr = nft_register_chain_type(&nft_chain_nat_ipv6);\r\nif (err < 0)\r\nreturn err;\r\nreturn 0;\r\n}\r\nstatic void __exit nft_chain_nat_ipv6_exit(void)\r\n{\r\nnft_unregister_chain_type(&nft_chain_nat_ipv6);\r\n}
