static int r8a7796_pin_to_pocctrl(struct sh_pfc *pfc, unsigned int pin, u32 *pocctrl)\r\n{\r\nint bit = -EINVAL;\r\n*pocctrl = 0xe6060380;\r\nif (pin >= RCAR_GP_PIN(3, 0) && pin <= RCAR_GP_PIN(3, 11))\r\nbit = pin & 0x1f;\r\nif (pin >= RCAR_GP_PIN(4, 0) && pin <= RCAR_GP_PIN(4, 17))\r\nbit = (pin & 0x1f) + 12;\r\nreturn bit;\r\n}\r\nstatic unsigned int r8a7796_pinmux_get_bias(struct sh_pfc *pfc,\r\nunsigned int pin)\r\n{\r\nconst struct sh_pfc_bias_info *info;\r\nu32 reg;\r\nu32 bit;\r\ninfo = sh_pfc_pin_to_bias_info(bias_info, ARRAY_SIZE(bias_info), pin);\r\nif (!info)\r\nreturn PIN_CONFIG_BIAS_DISABLE;\r\nreg = info->reg;\r\nbit = BIT(info->bit);\r\nif (!(sh_pfc_read_reg(pfc, PUEN + reg, 32) & bit))\r\nreturn PIN_CONFIG_BIAS_DISABLE;\r\nelse if (sh_pfc_read_reg(pfc, PUD + reg, 32) & bit)\r\nreturn PIN_CONFIG_BIAS_PULL_UP;\r\nelse\r\nreturn PIN_CONFIG_BIAS_PULL_DOWN;\r\n}\r\nstatic void r8a7796_pinmux_set_bias(struct sh_pfc *pfc, unsigned int pin,\r\nunsigned int bias)\r\n{\r\nconst struct sh_pfc_bias_info *info;\r\nu32 enable, updown;\r\nu32 reg;\r\nu32 bit;\r\ninfo = sh_pfc_pin_to_bias_info(bias_info, ARRAY_SIZE(bias_info), pin);\r\nif (!info)\r\nreturn;\r\nreg = info->reg;\r\nbit = BIT(info->bit);\r\nenable = sh_pfc_read_reg(pfc, PUEN + reg, 32) & ~bit;\r\nif (bias != PIN_CONFIG_BIAS_DISABLE)\r\nenable |= bit;\r\nupdown = sh_pfc_read_reg(pfc, PUD + reg, 32) & ~bit;\r\nif (bias == PIN_CONFIG_BIAS_PULL_UP)\r\nupdown |= bit;\r\nsh_pfc_write_reg(pfc, PUD + reg, 32, updown);\r\nsh_pfc_write_reg(pfc, PUEN + reg, 32, enable);\r\n}
