int cyttsp_i2c_read_block_data(struct device *dev, u8 *xfer_buf,\r\nu16 addr, u8 length, void *values)\r\n{\r\nstruct i2c_client *client = to_i2c_client(dev);\r\nu8 client_addr = client->addr | ((addr >> 8) & 0x1);\r\nu8 addr_lo = addr & 0xFF;\r\nstruct i2c_msg msgs[] = {\r\n{\r\n.addr = client_addr,\r\n.flags = 0,\r\n.len = 1,\r\n.buf = &addr_lo,\r\n},\r\n{\r\n.addr = client_addr,\r\n.flags = I2C_M_RD,\r\n.len = length,\r\n.buf = values,\r\n},\r\n};\r\nint retval;\r\nretval = i2c_transfer(client->adapter, msgs, ARRAY_SIZE(msgs));\r\nif (retval < 0)\r\nreturn retval;\r\nreturn retval != ARRAY_SIZE(msgs) ? -EIO : 0;\r\n}\r\nint cyttsp_i2c_write_block_data(struct device *dev, u8 *xfer_buf,\r\nu16 addr, u8 length, const void *values)\r\n{\r\nstruct i2c_client *client = to_i2c_client(dev);\r\nu8 client_addr = client->addr | ((addr >> 8) & 0x1);\r\nu8 addr_lo = addr & 0xFF;\r\nstruct i2c_msg msgs[] = {\r\n{\r\n.addr = client_addr,\r\n.flags = 0,\r\n.len = length + 1,\r\n.buf = xfer_buf,\r\n},\r\n};\r\nint retval;\r\nxfer_buf[0] = addr_lo;\r\nmemcpy(&xfer_buf[1], values, length);\r\nretval = i2c_transfer(client->adapter, msgs, ARRAY_SIZE(msgs));\r\nif (retval < 0)\r\nreturn retval;\r\nreturn retval != ARRAY_SIZE(msgs) ? -EIO : 0;\r\n}
