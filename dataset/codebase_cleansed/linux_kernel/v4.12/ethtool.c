static void mwifiex_ethtool_get_wol(struct net_device *dev,\r\nstruct ethtool_wolinfo *wol)\r\n{\r\nstruct mwifiex_private *priv = mwifiex_netdev_get_priv(dev);\r\nu32 conditions = le32_to_cpu(priv->adapter->hs_cfg.conditions);\r\nwol->supported = WAKE_UCAST|WAKE_MCAST|WAKE_BCAST|WAKE_PHY;\r\nif (conditions == HS_CFG_COND_DEF)\r\nreturn;\r\nif (conditions & HS_CFG_COND_UNICAST_DATA)\r\nwol->wolopts |= WAKE_UCAST;\r\nif (conditions & HS_CFG_COND_MULTICAST_DATA)\r\nwol->wolopts |= WAKE_MCAST;\r\nif (conditions & HS_CFG_COND_BROADCAST_DATA)\r\nwol->wolopts |= WAKE_BCAST;\r\nif (conditions & HS_CFG_COND_MAC_EVENT)\r\nwol->wolopts |= WAKE_PHY;\r\n}\r\nstatic int mwifiex_ethtool_set_wol(struct net_device *dev,\r\nstruct ethtool_wolinfo *wol)\r\n{\r\nstruct mwifiex_private *priv = mwifiex_netdev_get_priv(dev);\r\nu32 conditions = 0;\r\nif (wol->wolopts & ~(WAKE_UCAST|WAKE_MCAST|WAKE_BCAST|WAKE_PHY))\r\nreturn -EOPNOTSUPP;\r\nif (wol->wolopts & WAKE_UCAST)\r\nconditions |= HS_CFG_COND_UNICAST_DATA;\r\nif (wol->wolopts & WAKE_MCAST)\r\nconditions |= HS_CFG_COND_MULTICAST_DATA;\r\nif (wol->wolopts & WAKE_BCAST)\r\nconditions |= HS_CFG_COND_BROADCAST_DATA;\r\nif (wol->wolopts & WAKE_PHY)\r\nconditions |= HS_CFG_COND_MAC_EVENT;\r\nif (wol->wolopts == 0)\r\nconditions |= HS_CFG_COND_DEF;\r\npriv->adapter->hs_cfg.conditions = cpu_to_le32(conditions);\r\nreturn 0;\r\n}
