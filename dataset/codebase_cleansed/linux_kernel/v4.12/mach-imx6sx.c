static int ar8031_phy_fixup(struct phy_device *dev)\r\n{\r\nu16 val;\r\nphy_write(dev, 0x1d, 0x1f);\r\nphy_write(dev, 0x1e, 0x8);\r\nphy_write(dev, 0x1d, 0x5);\r\nval = phy_read(dev, 0x1e);\r\nval |= 0x0100;\r\nphy_write(dev, 0x1e, val);\r\nreturn 0;\r\n}\r\nstatic void __init imx6sx_enet_phy_init(void)\r\n{\r\nif (IS_BUILTIN(CONFIG_PHYLIB))\r\nphy_register_fixup_for_uid(PHY_ID_AR8031, 0xffffffff,\r\nar8031_phy_fixup);\r\n}\r\nstatic void __init imx6sx_enet_clk_sel(void)\r\n{\r\nstruct regmap *gpr;\r\ngpr = syscon_regmap_lookup_by_compatible("fsl,imx6sx-iomuxc-gpr");\r\nif (!IS_ERR(gpr)) {\r\nregmap_update_bits(gpr, IOMUXC_GPR1,\r\nIMX6SX_GPR1_FEC_CLOCK_MUX_SEL_MASK, 0);\r\nregmap_update_bits(gpr, IOMUXC_GPR1,\r\nIMX6SX_GPR1_FEC_CLOCK_PAD_DIR_MASK, 0);\r\n} else {\r\npr_err("failed to find fsl,imx6sx-iomux-gpr regmap\n");\r\n}\r\n}\r\nstatic inline void imx6sx_enet_init(void)\r\n{\r\nimx6sx_enet_phy_init();\r\nimx6sx_enet_clk_sel();\r\n}\r\nstatic void __init imx6sx_init_machine(void)\r\n{\r\nstruct device *parent;\r\nparent = imx_soc_device_init();\r\nif (parent == NULL)\r\npr_warn("failed to initialize soc device\n");\r\nof_platform_default_populate(NULL, NULL, parent);\r\nimx6sx_enet_init();\r\nimx_anatop_init();\r\nimx6sx_pm_init();\r\n}\r\nstatic void __init imx6sx_init_irq(void)\r\n{\r\nimx_gpc_check_dt();\r\nimx_init_revision_from_anatop();\r\nimx_init_l2cache();\r\nimx_src_init();\r\nirqchip_init();\r\nimx6_pm_ccm_init("fsl,imx6sx-ccm");\r\n}\r\nstatic void __init imx6sx_init_late(void)\r\n{\r\nimx6sx_cpuidle_init();\r\nif (IS_ENABLED(CONFIG_ARM_IMX6Q_CPUFREQ))\r\nplatform_device_register_simple("imx6q-cpufreq", -1, NULL, 0);\r\n}
