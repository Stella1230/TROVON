static int ap136_pci_plat_dev_init(struct pci_dev *dev)\r\n{\r\nif (dev->bus->number == 1 && (PCI_SLOT(dev->devfn)) == 0)\r\ndev->dev.platform_data = &ap136_ath9k_data;\r\nreturn 0;\r\n}\r\nstatic void __init ap136_pci_init(u8 *eeprom)\r\n{\r\nmemcpy(ap136_ath9k_data.eeprom_data, eeprom,\r\nsizeof(ap136_ath9k_data.eeprom_data));\r\nath79_pci_set_plat_dev_init(ap136_pci_plat_dev_init);\r\nath79_register_pci();\r\n}\r\nstatic inline void ap136_pci_init(u8 *eeprom) {}\r\nstatic void __init ap136_setup(void)\r\n{\r\nu8 *art = (u8 *) KSEG1ADDR(0x1fff0000);\r\nath79_register_leds_gpio(-1, ARRAY_SIZE(ap136_leds_gpio),\r\nap136_leds_gpio);\r\nath79_register_gpio_keys_polled(-1, AP136_KEYS_POLL_INTERVAL,\r\nARRAY_SIZE(ap136_gpio_keys),\r\nap136_gpio_keys);\r\nath79_register_spi(&ap136_spi_data, ap136_spi_info,\r\nARRAY_SIZE(ap136_spi_info));\r\nath79_register_usb();\r\nath79_register_wmac(art + AP136_WMAC_CALDATA_OFFSET);\r\nap136_pci_init(art + AP136_PCIE_CALDATA_OFFSET);\r\n}
