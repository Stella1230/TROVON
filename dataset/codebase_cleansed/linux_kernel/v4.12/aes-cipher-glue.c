static void aes_encrypt(struct crypto_tfm *tfm, u8 *out, const u8 *in)\r\n{\r\nstruct crypto_aes_ctx *ctx = crypto_tfm_ctx(tfm);\r\nint rounds = 6 + ctx->key_length / 4;\r\n__aes_arm_encrypt(ctx->key_enc, rounds, in, out);\r\n}\r\nstatic void aes_decrypt(struct crypto_tfm *tfm, u8 *out, const u8 *in)\r\n{\r\nstruct crypto_aes_ctx *ctx = crypto_tfm_ctx(tfm);\r\nint rounds = 6 + ctx->key_length / 4;\r\n__aes_arm_decrypt(ctx->key_dec, rounds, in, out);\r\n}\r\nstatic int __init aes_init(void)\r\n{\r\nreturn crypto_register_alg(&aes_alg);\r\n}\r\nstatic void __exit aes_fini(void)\r\n{\r\ncrypto_unregister_alg(&aes_alg);\r\n}
