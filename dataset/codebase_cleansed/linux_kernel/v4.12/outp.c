void\r\nnvkm_output_fini(struct nvkm_output *outp)\r\n{\r\nif (outp->func->fini)\r\noutp->func->fini(outp);\r\n}\r\nvoid\r\nnvkm_output_init(struct nvkm_output *outp)\r\n{\r\nif (outp->func->init)\r\noutp->func->init(outp);\r\n}\r\nvoid\r\nnvkm_output_del(struct nvkm_output **poutp)\r\n{\r\nstruct nvkm_output *outp = *poutp;\r\nif (outp && !WARN_ON(!outp->func)) {\r\nif (outp->func->dtor)\r\n*poutp = outp->func->dtor(outp);\r\nkfree(*poutp);\r\n*poutp = NULL;\r\n}\r\n}\r\nvoid\r\nnvkm_output_ctor(const struct nvkm_output_func *func, struct nvkm_disp *disp,\r\nint index, struct dcb_output *dcbE, struct nvkm_output *outp)\r\n{\r\nstruct nvkm_i2c *i2c = disp->engine.subdev.device->i2c;\r\noutp->func = func;\r\noutp->disp = disp;\r\noutp->index = index;\r\noutp->info = *dcbE;\r\noutp->i2c = nvkm_i2c_bus_find(i2c, dcbE->i2c_index);\r\noutp->or = ffs(outp->info.or) - 1;\r\nOUTP_DBG(outp, "type %02x loc %d or %d link %d con %x "\r\n"edid %x bus %d head %x",\r\noutp->info.type, outp->info.location, outp->info.or,\r\noutp->info.type >= 2 ? outp->info.sorconf.link : 0,\r\noutp->info.connector, outp->info.i2c_index,\r\noutp->info.bus, outp->info.heads);\r\n}\r\nint\r\nnvkm_output_new_(const struct nvkm_output_func *func,\r\nstruct nvkm_disp *disp, int index, struct dcb_output *dcbE,\r\nstruct nvkm_output **poutp)\r\n{\r\nif (!(*poutp = kzalloc(sizeof(**poutp), GFP_KERNEL)))\r\nreturn -ENOMEM;\r\nnvkm_output_ctor(func, disp, index, dcbE, *poutp);\r\nreturn 0;\r\n}
