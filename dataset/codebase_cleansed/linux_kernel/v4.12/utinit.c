static void acpi_ut_free_gpe_lists(void)\r\n{\r\nstruct acpi_gpe_block_info *gpe_block;\r\nstruct acpi_gpe_block_info *next_gpe_block;\r\nstruct acpi_gpe_xrupt_info *gpe_xrupt_info;\r\nstruct acpi_gpe_xrupt_info *next_gpe_xrupt_info;\r\ngpe_xrupt_info = acpi_gbl_gpe_xrupt_list_head;\r\nwhile (gpe_xrupt_info) {\r\ngpe_block = gpe_xrupt_info->gpe_block_list_head;\r\nwhile (gpe_block) {\r\nnext_gpe_block = gpe_block->next;\r\nACPI_FREE(gpe_block->event_info);\r\nACPI_FREE(gpe_block->register_info);\r\nACPI_FREE(gpe_block);\r\ngpe_block = next_gpe_block;\r\n}\r\nnext_gpe_xrupt_info = gpe_xrupt_info->next;\r\nACPI_FREE(gpe_xrupt_info);\r\ngpe_xrupt_info = next_gpe_xrupt_info;\r\n}\r\n}\r\nacpi_status acpi_ut_init_globals(void)\r\n{\r\nacpi_status status;\r\nu32 i;\r\nACPI_FUNCTION_TRACE(ut_init_globals);\r\nstatus = acpi_ut_create_caches();\r\nif (ACPI_FAILURE(status)) {\r\nreturn_ACPI_STATUS(status);\r\n}\r\nfor (i = 0; i < ACPI_ADDRESS_RANGE_MAX; i++) {\r\nacpi_gbl_address_range_list[i] = NULL;\r\n}\r\nfor (i = 0; i < ACPI_NUM_MUTEX; i++) {\r\nacpi_gbl_mutex_info[i].mutex = NULL;\r\nacpi_gbl_mutex_info[i].thread_id = ACPI_MUTEX_NOT_ACQUIRED;\r\nacpi_gbl_mutex_info[i].use_count = 0;\r\n}\r\nfor (i = 0; i < ACPI_NUM_OWNERID_MASKS; i++) {\r\nacpi_gbl_owner_id_mask[i] = 0;\r\n}\r\nacpi_gbl_owner_id_mask[ACPI_NUM_OWNERID_MASKS - 1] = 0x80000000;\r\nacpi_method_count = 0;\r\nacpi_sci_count = 0;\r\nacpi_gpe_count = 0;\r\nfor (i = 0; i < ACPI_NUM_FIXED_EVENTS; i++) {\r\nacpi_fixed_event_count[i] = 0;\r\n}\r\n#if (!ACPI_REDUCED_HARDWARE)\r\nacpi_gbl_all_gpes_initialized = FALSE;\r\nacpi_gbl_gpe_xrupt_list_head = NULL;\r\nacpi_gbl_gpe_fadt_blocks[0] = NULL;\r\nacpi_gbl_gpe_fadt_blocks[1] = NULL;\r\nacpi_current_gpe_count = 0;\r\nacpi_gbl_global_event_handler = NULL;\r\nacpi_gbl_sci_handler_list = NULL;\r\n#endif\r\nacpi_gbl_global_notify[0].handler = NULL;\r\nacpi_gbl_global_notify[1].handler = NULL;\r\nacpi_gbl_exception_handler = NULL;\r\nacpi_gbl_init_handler = NULL;\r\nacpi_gbl_table_handler = NULL;\r\nacpi_gbl_interface_handler = NULL;\r\nacpi_gbl_global_lock_semaphore = NULL;\r\nacpi_gbl_global_lock_mutex = NULL;\r\nacpi_gbl_global_lock_acquired = FALSE;\r\nacpi_gbl_global_lock_handle = 0;\r\nacpi_gbl_global_lock_present = FALSE;\r\nacpi_gbl_DSDT = NULL;\r\nacpi_gbl_cm_single_step = FALSE;\r\nacpi_gbl_shutdown = FALSE;\r\nacpi_gbl_ns_lookup_count = 0;\r\nacpi_gbl_ps_find_count = 0;\r\nacpi_gbl_acpi_hardware_present = TRUE;\r\nacpi_gbl_last_owner_id_index = 0;\r\nacpi_gbl_next_owner_id_offset = 0;\r\nacpi_gbl_debugger_configuration = DEBUGGER_THREADING;\r\nacpi_gbl_osi_mutex = NULL;\r\nacpi_gbl_max_loop_iterations = ACPI_MAX_LOOP_COUNT;\r\nacpi_gbl_events_initialized = FALSE;\r\nacpi_gbl_system_awake_and_running = TRUE;\r\nacpi_gbl_module_code_list = NULL;\r\nacpi_gbl_root_node = NULL;\r\nacpi_gbl_root_node_struct.name.integer = ACPI_ROOT_NAME;\r\nacpi_gbl_root_node_struct.descriptor_type = ACPI_DESC_TYPE_NAMED;\r\nacpi_gbl_root_node_struct.type = ACPI_TYPE_DEVICE;\r\nacpi_gbl_root_node_struct.parent = NULL;\r\nacpi_gbl_root_node_struct.child = NULL;\r\nacpi_gbl_root_node_struct.peer = NULL;\r\nacpi_gbl_root_node_struct.object = NULL;\r\n#ifdef ACPI_DISASSEMBLER\r\nacpi_gbl_external_list = NULL;\r\nacpi_gbl_num_external_methods = 0;\r\nacpi_gbl_resolved_external_methods = 0;\r\n#endif\r\n#ifdef ACPI_DEBUG_OUTPUT\r\nacpi_gbl_lowest_stack_pointer = ACPI_CAST_PTR(acpi_size, ACPI_SIZE_MAX);\r\n#endif\r\n#ifdef ACPI_DBG_TRACK_ALLOCATIONS\r\nacpi_gbl_display_final_mem_stats = FALSE;\r\nacpi_gbl_disable_mem_tracking = FALSE;\r\n#endif\r\nreturn_ACPI_STATUS(AE_OK);\r\n}\r\nstatic void acpi_ut_terminate(void)\r\n{\r\nACPI_FUNCTION_TRACE(ut_terminate);\r\nacpi_ut_free_gpe_lists();\r\nacpi_ut_delete_address_lists();\r\nreturn_VOID;\r\n}\r\nvoid acpi_ut_subsystem_shutdown(void)\r\n{\r\nACPI_FUNCTION_TRACE(ut_subsystem_shutdown);\r\nif (acpi_gbl_shutdown) {\r\nACPI_ERROR((AE_INFO, "ACPI Subsystem is already terminated"));\r\nreturn_VOID;\r\n}\r\nacpi_gbl_shutdown = TRUE;\r\nacpi_gbl_startup_flags = 0;\r\nACPI_DEBUG_PRINT((ACPI_DB_INFO, "Shutting down ACPI Subsystem\n"));\r\n#ifndef ACPI_ASL_COMPILER\r\nacpi_ev_terminate();\r\nacpi_ut_interface_terminate();\r\n#endif\r\nacpi_ns_terminate();\r\nacpi_tb_terminate();\r\nacpi_ut_terminate();\r\n(void)acpi_ut_delete_caches();\r\nreturn_VOID;\r\n}
