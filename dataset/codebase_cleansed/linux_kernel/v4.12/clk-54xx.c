int __init omap5xxx_dt_clk_init(void)\r\n{\r\nint rc;\r\nstruct clk *abe_dpll_ref, *abe_dpll, *sys_32k_ck, *usb_dpll;\r\nti_dt_clocks_register(omap54xx_clks);\r\nomap2_clk_disable_autoidle_all();\r\nabe_dpll_ref = clk_get_sys(NULL, "abe_dpll_clk_mux");\r\nsys_32k_ck = clk_get_sys(NULL, "sys_32k_ck");\r\nrc = clk_set_parent(abe_dpll_ref, sys_32k_ck);\r\nabe_dpll = clk_get_sys(NULL, "dpll_abe_ck");\r\nif (!rc)\r\nrc = clk_set_rate(abe_dpll, OMAP5_DPLL_ABE_DEFFREQ);\r\nif (rc)\r\npr_err("%s: failed to configure ABE DPLL!\n", __func__);\r\nabe_dpll = clk_get_sys(NULL, "dpll_abe_m2x2_ck");\r\nif (!rc)\r\nrc = clk_set_rate(abe_dpll, OMAP5_DPLL_ABE_DEFFREQ * 2);\r\nif (rc)\r\npr_err("%s: failed to configure ABE m2x2 DPLL!\n", __func__);\r\nusb_dpll = clk_get_sys(NULL, "dpll_usb_ck");\r\nrc = clk_set_rate(usb_dpll, OMAP5_DPLL_USB_DEFFREQ);\r\nif (rc)\r\npr_err("%s: failed to configure USB DPLL!\n", __func__);\r\nusb_dpll = clk_get_sys(NULL, "dpll_usb_m2_ck");\r\nrc = clk_set_rate(usb_dpll, OMAP5_DPLL_USB_DEFFREQ/2);\r\nif (rc)\r\npr_err("%s: failed to set USB_DPLL M2 OUT\n", __func__);\r\nreturn 0;\r\n}
