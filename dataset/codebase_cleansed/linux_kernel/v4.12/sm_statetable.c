const sctp_sm_table_entry_t *sctp_sm_lookup_event(struct net *net,\r\nsctp_event_t event_type,\r\nsctp_state_t state,\r\nsctp_subtype_t event_subtype)\r\n{\r\nswitch (event_type) {\r\ncase SCTP_EVENT_T_CHUNK:\r\nreturn sctp_chunk_event_lookup(net, event_subtype.chunk, state);\r\ncase SCTP_EVENT_T_TIMEOUT:\r\nreturn DO_LOOKUP(SCTP_EVENT_TIMEOUT_MAX, timeout,\r\ntimeout_event_table);\r\ncase SCTP_EVENT_T_OTHER:\r\nreturn DO_LOOKUP(SCTP_EVENT_OTHER_MAX, other,\r\nother_event_table);\r\ncase SCTP_EVENT_T_PRIMITIVE:\r\nreturn DO_LOOKUP(SCTP_EVENT_PRIMITIVE_MAX, primitive,\r\nprimitive_event_table);\r\ndefault:\r\nreturn &bug;\r\n}\r\n}\r\nstatic const sctp_sm_table_entry_t *sctp_chunk_event_lookup(struct net *net,\r\nsctp_cid_t cid,\r\nsctp_state_t state)\r\n{\r\nif (state > SCTP_STATE_MAX)\r\nreturn &bug;\r\nif (cid <= SCTP_CID_BASE_MAX)\r\nreturn &chunk_event_table[cid][state];\r\nif (net->sctp.prsctp_enable) {\r\nif (cid == SCTP_CID_FWD_TSN)\r\nreturn &prsctp_chunk_event_table[0][state];\r\n}\r\nif (net->sctp.addip_enable) {\r\nif (cid == SCTP_CID_ASCONF)\r\nreturn &addip_chunk_event_table[0][state];\r\nif (cid == SCTP_CID_ASCONF_ACK)\r\nreturn &addip_chunk_event_table[1][state];\r\n}\r\nif (net->sctp.reconf_enable)\r\nif (cid == SCTP_CID_RECONF)\r\nreturn &reconf_chunk_event_table[0][state];\r\nif (net->sctp.auth_enable) {\r\nif (cid == SCTP_CID_AUTH)\r\nreturn &auth_chunk_event_table[0][state];\r\n}\r\nreturn &chunk_event_table_unknown[state];\r\n}
