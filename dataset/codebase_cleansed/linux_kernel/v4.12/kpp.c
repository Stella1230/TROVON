static int crypto_kpp_report(struct sk_buff *skb, struct crypto_alg *alg)\r\n{\r\nstruct crypto_report_kpp rkpp;\r\nstrncpy(rkpp.type, "kpp", sizeof(rkpp.type));\r\nif (nla_put(skb, CRYPTOCFGA_REPORT_KPP,\r\nsizeof(struct crypto_report_kpp), &rkpp))\r\ngoto nla_put_failure;\r\nreturn 0;\r\nnla_put_failure:\r\nreturn -EMSGSIZE;\r\n}\r\nstatic int crypto_kpp_report(struct sk_buff *skb, struct crypto_alg *alg)\r\n{\r\nreturn -ENOSYS;\r\n}\r\nstatic void crypto_kpp_show(struct seq_file *m, struct crypto_alg *alg)\r\n{\r\nseq_puts(m, "type : kpp\n");\r\n}\r\nstatic void crypto_kpp_exit_tfm(struct crypto_tfm *tfm)\r\n{\r\nstruct crypto_kpp *kpp = __crypto_kpp_tfm(tfm);\r\nstruct kpp_alg *alg = crypto_kpp_alg(kpp);\r\nalg->exit(kpp);\r\n}\r\nstatic int crypto_kpp_init_tfm(struct crypto_tfm *tfm)\r\n{\r\nstruct crypto_kpp *kpp = __crypto_kpp_tfm(tfm);\r\nstruct kpp_alg *alg = crypto_kpp_alg(kpp);\r\nif (alg->exit)\r\nkpp->base.exit = crypto_kpp_exit_tfm;\r\nif (alg->init)\r\nreturn alg->init(kpp);\r\nreturn 0;\r\n}\r\nstruct crypto_kpp *crypto_alloc_kpp(const char *alg_name, u32 type, u32 mask)\r\n{\r\nreturn crypto_alloc_tfm(alg_name, &crypto_kpp_type, type, mask);\r\n}\r\nstatic void kpp_prepare_alg(struct kpp_alg *alg)\r\n{\r\nstruct crypto_alg *base = &alg->base;\r\nbase->cra_type = &crypto_kpp_type;\r\nbase->cra_flags &= ~CRYPTO_ALG_TYPE_MASK;\r\nbase->cra_flags |= CRYPTO_ALG_TYPE_KPP;\r\n}\r\nint crypto_register_kpp(struct kpp_alg *alg)\r\n{\r\nstruct crypto_alg *base = &alg->base;\r\nkpp_prepare_alg(alg);\r\nreturn crypto_register_alg(base);\r\n}\r\nvoid crypto_unregister_kpp(struct kpp_alg *alg)\r\n{\r\ncrypto_unregister_alg(&alg->base);\r\n}
