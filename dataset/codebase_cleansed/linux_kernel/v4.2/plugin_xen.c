static const char *xen_hypercall_name(unsigned op)\r\n{\r\nif (op < ARRAY_SIZE(xen_hypercall_names) &&\r\nxen_hypercall_names[op] != NULL)\r\nreturn xen_hypercall_names[op];\r\nreturn "";\r\n}\r\nunsigned long long process_xen_hypercall_name(struct trace_seq *s,\r\nunsigned long long *args)\r\n{\r\nunsigned int op = args[0];\r\ntrace_seq_printf(s, "%s", xen_hypercall_name(op));\r\nreturn 0;\r\n}\r\nint PEVENT_PLUGIN_LOADER(struct pevent *pevent)\r\n{\r\npevent_register_print_function(pevent,\r\nprocess_xen_hypercall_name,\r\nPEVENT_FUNC_ARG_STRING,\r\n"xen_hypercall_name",\r\nPEVENT_FUNC_ARG_INT,\r\nPEVENT_FUNC_ARG_VOID);\r\nreturn 0;\r\n}\r\nvoid PEVENT_PLUGIN_UNLOADER(struct pevent *pevent)\r\n{\r\npevent_unregister_print_function(pevent, process_xen_hypercall_name,\r\n"xen_hypercall_name");\r\n}
