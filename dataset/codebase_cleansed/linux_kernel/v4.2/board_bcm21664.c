static void bcm21664_restart(enum reboot_mode mode, const char *cmd)\r\n{\r\nvoid __iomem *base;\r\nstruct device_node *resetmgr;\r\nresetmgr = of_find_compatible_node(NULL, NULL, RSTMGR_DT_STRING);\r\nif (!resetmgr) {\r\npr_emerg("Couldn't find " RSTMGR_DT_STRING "\n");\r\nreturn;\r\n}\r\nbase = of_iomap(resetmgr, 0);\r\nif (!base) {\r\npr_emerg("Couldn't map " RSTMGR_DT_STRING "\n");\r\nreturn;\r\n}\r\nwritel((RSTMGR_WR_PASSWORD << RSTMGR_WR_PASSWORD_SHIFT) |\r\nRSTMGR_WR_ACCESS_ENABLE,\r\nbase + RSTMGR_REG_WR_ACCESS_OFFSET);\r\nwritel(0, base + RSTMGR_REG_CHIP_SOFT_RST_OFFSET);\r\nwhile (1);\r\n}\r\nstatic void __init bcm21664_init(void)\r\n{\r\nof_platform_populate(NULL, of_default_bus_match_table, NULL, NULL);\r\nkona_l2_cache_init();\r\n}
