static int\r\nuser_get(struct dentry *dentry, const char *name, void *buffer, size_t size,\r\nint handler_flags)\r\n{\r\nif (strlen(name) < sizeof(XATTR_USER_PREFIX))\r\nreturn -EINVAL;\r\nif (!reiserfs_xattrs_user(dentry->d_sb))\r\nreturn -EOPNOTSUPP;\r\nreturn reiserfs_xattr_get(d_inode(dentry), name, buffer, size);\r\n}\r\nstatic int\r\nuser_set(struct dentry *dentry, const char *name, const void *buffer,\r\nsize_t size, int flags, int handler_flags)\r\n{\r\nif (strlen(name) < sizeof(XATTR_USER_PREFIX))\r\nreturn -EINVAL;\r\nif (!reiserfs_xattrs_user(dentry->d_sb))\r\nreturn -EOPNOTSUPP;\r\nreturn reiserfs_xattr_set(d_inode(dentry), name, buffer, size, flags);\r\n}\r\nstatic size_t user_list(struct dentry *dentry, char *list, size_t list_size,\r\nconst char *name, size_t name_len, int handler_flags)\r\n{\r\nconst size_t len = name_len + 1;\r\nif (!reiserfs_xattrs_user(dentry->d_sb))\r\nreturn 0;\r\nif (list && len <= list_size) {\r\nmemcpy(list, name, name_len);\r\nlist[name_len] = '\0';\r\n}\r\nreturn len;\r\n}
