bool scsi_opcode_sa_name(int opcode, int service_action,\r\nconst char **cdb_name, const char **sa_name)\r\n{\r\nstruct sa_name_list *sa_name_ptr;\r\nconst struct value_name_pair *arr = NULL;\r\nint arr_sz, k;\r\n*cdb_name = NULL;\r\nif (opcode >= VENDOR_SPECIFIC_CDB)\r\nreturn false;\r\nif (opcode < ARRAY_SIZE(cdb_byte0_names))\r\n*cdb_name = cdb_byte0_names[opcode];\r\nfor (sa_name_ptr = sa_names_arr; sa_name_ptr->arr; ++sa_name_ptr) {\r\nif (sa_name_ptr->opcode == opcode) {\r\narr = sa_name_ptr->arr;\r\narr_sz = sa_name_ptr->arr_sz;\r\nbreak;\r\n}\r\n}\r\nif (!arr)\r\nreturn false;\r\nfor (k = 0; k < arr_sz; ++k, ++arr) {\r\nif (service_action == arr->value)\r\nbreak;\r\n}\r\nif (k < arr_sz)\r\n*sa_name = arr->name;\r\nreturn true;\r\n}\r\nconst char *\r\nscsi_sense_key_string(unsigned char key) {\r\nif (key <= 0xE)\r\nreturn snstext[key];\r\nreturn NULL;\r\n}\r\nconst char *\r\nscsi_extd_sense_format(unsigned char asc, unsigned char ascq, const char **fmt)\r\n{\r\nint i;\r\nunsigned short code = ((asc << 8) | ascq);\r\n*fmt = NULL;\r\nfor (i = 0; additional[i].text; i++)\r\nif (additional[i].code12 == code)\r\nreturn additional[i].text;\r\nfor (i = 0; additional2[i].fmt; i++) {\r\nif (additional2[i].code1 == asc &&\r\nascq >= additional2[i].code2_min &&\r\nascq <= additional2[i].code2_max) {\r\n*fmt = additional2[i].fmt;\r\nreturn additional2[i].str;\r\n}\r\n}\r\nreturn NULL;\r\n}\r\nconst char *scsi_hostbyte_string(int result)\r\n{\r\nconst char *hb_string = NULL;\r\nint hb = host_byte(result);\r\nif (hb < ARRAY_SIZE(hostbyte_table))\r\nhb_string = hostbyte_table[hb];\r\nreturn hb_string;\r\n}\r\nconst char *scsi_driverbyte_string(int result)\r\n{\r\nconst char *db_string = NULL;\r\nint db = driver_byte(result);\r\nif (db < ARRAY_SIZE(driverbyte_table))\r\ndb_string = driverbyte_table[db];\r\nreturn db_string;\r\n}\r\nconst char *scsi_mlreturn_string(int result)\r\n{\r\nconst struct value_name_pair *arr = scsi_mlreturn_arr;\r\nint k;\r\nfor (k = 0; k < ARRAY_SIZE(scsi_mlreturn_arr); ++k, ++arr) {\r\nif (result == arr->value)\r\nreturn arr->name;\r\n}\r\nreturn NULL;\r\n}
