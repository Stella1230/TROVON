static void\r\npwr_perfctr_init(struct nvkm_pm *ppm, struct nvkm_perfdom *dom,\r\nstruct nvkm_perfctr *ctr)\r\n{\r\nu32 mask = 0x00000000;\r\nu32 ctrl = 0x00000001;\r\nint i;\r\nfor (i = 0; i < ARRAY_SIZE(ctr->signal) && ctr->signal[i]; i++)\r\nmask |= 1 << (ctr->signal[i] - dom->signal);\r\nnv_wr32(ppm, 0x10a504 + (ctr->slot * 0x10), mask);\r\nnv_wr32(ppm, 0x10a50c + (ctr->slot * 0x10), ctrl);\r\nnv_wr32(ppm, 0x10a50c + (ppm->last * 0x10), 0x00000003);\r\n}\r\nstatic void\r\npwr_perfctr_read(struct nvkm_pm *ppm, struct nvkm_perfdom *dom,\r\nstruct nvkm_perfctr *ctr)\r\n{\r\nctr->ctr = ppm->pwr[ctr->slot];\r\nctr->clk = ppm->pwr[ppm->last];\r\n}\r\nstatic void\r\npwr_perfctr_next(struct nvkm_pm *ppm, struct nvkm_perfdom *dom)\r\n{\r\nint i;\r\nfor (i = 0; i <= ppm->last; i++) {\r\nppm->pwr[i] = nv_rd32(ppm, 0x10a508 + (i * 0x10));\r\nnv_wr32(ppm, 0x10a508 + (i * 0x10), 0x80000000);\r\n}\r\n}
