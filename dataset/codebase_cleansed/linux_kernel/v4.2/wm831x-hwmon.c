static ssize_t show_voltage(struct device *dev,\r\nstruct device_attribute *attr, char *buf)\r\n{\r\nstruct wm831x *wm831x = dev_get_drvdata(dev);\r\nint channel = to_sensor_dev_attr(attr)->index;\r\nint ret;\r\nret = wm831x_auxadc_read_uv(wm831x, channel);\r\nif (ret < 0)\r\nreturn ret;\r\nreturn sprintf(buf, "%d\n", DIV_ROUND_CLOSEST(ret, 1000));\r\n}\r\nstatic ssize_t show_chip_temp(struct device *dev,\r\nstruct device_attribute *attr, char *buf)\r\n{\r\nstruct wm831x *wm831x = dev_get_drvdata(dev);\r\nint channel = to_sensor_dev_attr(attr)->index;\r\nint ret;\r\nret = wm831x_auxadc_read(wm831x, channel);\r\nif (ret < 0)\r\nreturn ret;\r\nret = 512180 - (ret * 1000);\r\nret = DIV_ROUND_CLOSEST(ret * 10000, 10983);\r\nreturn sprintf(buf, "%d\n", ret);\r\n}\r\nstatic ssize_t show_label(struct device *dev,\r\nstruct device_attribute *attr, char *buf)\r\n{\r\nint channel = to_sensor_dev_attr(attr)->index;\r\nreturn sprintf(buf, "%s\n", input_names[channel]);\r\n}\r\nstatic int wm831x_hwmon_probe(struct platform_device *pdev)\r\n{\r\nstruct wm831x *wm831x = dev_get_drvdata(pdev->dev.parent);\r\nstruct device *hwmon_dev;\r\nhwmon_dev = devm_hwmon_device_register_with_groups(&pdev->dev, "wm831x",\r\nwm831x,\r\nwm831x_groups);\r\nreturn PTR_ERR_OR_ZERO(hwmon_dev);\r\n}
