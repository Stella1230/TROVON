static unsigned int nft_nat_do_chain(const struct nf_hook_ops *ops,\r\nstruct sk_buff *skb,\r\nconst struct nf_hook_state *state,\r\nstruct nf_conn *ct)\r\n{\r\nstruct nft_pktinfo pkt;\r\nnft_set_pktinfo_ipv4(&pkt, ops, skb, state);\r\nreturn nft_do_chain(&pkt, ops);\r\n}\r\nstatic unsigned int nft_nat_ipv4_fn(const struct nf_hook_ops *ops,\r\nstruct sk_buff *skb,\r\nconst struct nf_hook_state *state)\r\n{\r\nreturn nf_nat_ipv4_fn(ops, skb, state, nft_nat_do_chain);\r\n}\r\nstatic unsigned int nft_nat_ipv4_in(const struct nf_hook_ops *ops,\r\nstruct sk_buff *skb,\r\nconst struct nf_hook_state *state)\r\n{\r\nreturn nf_nat_ipv4_in(ops, skb, state, nft_nat_do_chain);\r\n}\r\nstatic unsigned int nft_nat_ipv4_out(const struct nf_hook_ops *ops,\r\nstruct sk_buff *skb,\r\nconst struct nf_hook_state *state)\r\n{\r\nreturn nf_nat_ipv4_out(ops, skb, state, nft_nat_do_chain);\r\n}\r\nstatic unsigned int nft_nat_ipv4_local_fn(const struct nf_hook_ops *ops,\r\nstruct sk_buff *skb,\r\nconst struct nf_hook_state *state)\r\n{\r\nreturn nf_nat_ipv4_local_fn(ops, skb, state, nft_nat_do_chain);\r\n}\r\nstatic int __init nft_chain_nat_init(void)\r\n{\r\nint err;\r\nerr = nft_register_chain_type(&nft_chain_nat_ipv4);\r\nif (err < 0)\r\nreturn err;\r\nreturn 0;\r\n}\r\nstatic void __exit nft_chain_nat_exit(void)\r\n{\r\nnft_unregister_chain_type(&nft_chain_nat_ipv4);\r\n}
