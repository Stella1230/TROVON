void ps3_sys_manager_register_ops(const struct ps3_sys_manager_ops *ops)\r\n{\r\nBUG_ON(!ops);\r\nBUG_ON(!ops->dev);\r\nps3_sys_manager_ops = ops ? *ops : ps3_sys_manager_ops;\r\n}\r\nvoid __noreturn ps3_sys_manager_power_off(void)\r\n{\r\nif (ps3_sys_manager_ops.power_off)\r\nps3_sys_manager_ops.power_off(ps3_sys_manager_ops.dev);\r\nps3_sys_manager_halt();\r\n}\r\nvoid __noreturn ps3_sys_manager_restart(void)\r\n{\r\nif (ps3_sys_manager_ops.restart)\r\nps3_sys_manager_ops.restart(ps3_sys_manager_ops.dev);\r\nps3_sys_manager_halt();\r\n}\r\nvoid __noreturn ps3_sys_manager_halt(void)\r\n{\r\npr_emerg("System Halted, OK to turn off power\n");\r\nlocal_irq_disable();\r\nwhile (1)\r\nlv1_pause(1);\r\n}
