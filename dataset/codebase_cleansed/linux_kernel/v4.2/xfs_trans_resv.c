STATIC uint\r\nxfs_buf_log_overhead(void)\r\n{\r\nreturn round_up(sizeof(struct xlog_op_header) +\r\nsizeof(struct xfs_buf_log_format), 128);\r\n}\r\nSTATIC uint\r\nxfs_calc_buf_res(\r\nuint nbufs,\r\nuint size)\r\n{\r\nreturn nbufs * (size + xfs_buf_log_overhead());\r\n}\r\nSTATIC uint\r\nxfs_calc_inode_res(\r\nstruct xfs_mount *mp,\r\nuint ninodes)\r\n{\r\nreturn ninodes *\r\n(4 * sizeof(struct xlog_op_header) +\r\nsizeof(struct xfs_inode_log_format) +\r\nmp->m_sb.sb_inodesize +\r\n2 * XFS_BMBT_BLOCK_LEN(mp));\r\n}\r\nSTATIC uint\r\nxfs_calc_finobt_res(\r\nstruct xfs_mount *mp,\r\nint alloc,\r\nint modify)\r\n{\r\nuint res;\r\nif (!xfs_sb_version_hasfinobt(&mp->m_sb))\r\nreturn 0;\r\nres = xfs_calc_buf_res(mp->m_in_maxlevels, XFS_FSB_TO_B(mp, 1));\r\nif (alloc)\r\nres += xfs_calc_buf_res(XFS_ALLOCFREE_LOG_COUNT(mp, 1),\r\nXFS_FSB_TO_B(mp, 1));\r\nif (modify)\r\nres += (uint)XFS_FSB_TO_B(mp, 1);\r\nreturn res;\r\n}\r\nSTATIC uint\r\nxfs_calc_write_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn XFS_DQUOT_LOGRES(mp) +\r\nMAX((xfs_calc_inode_res(mp, 1) +\r\nxfs_calc_buf_res(XFS_BM_MAXLEVELS(mp, XFS_DATA_FORK),\r\nXFS_FSB_TO_B(mp, 1)) +\r\nxfs_calc_buf_res(3, mp->m_sb.sb_sectsize) +\r\nxfs_calc_buf_res(XFS_ALLOCFREE_LOG_COUNT(mp, 2),\r\nXFS_FSB_TO_B(mp, 1))),\r\n(xfs_calc_buf_res(5, mp->m_sb.sb_sectsize) +\r\nxfs_calc_buf_res(XFS_ALLOCFREE_LOG_COUNT(mp, 2),\r\nXFS_FSB_TO_B(mp, 1))));\r\n}\r\nSTATIC uint\r\nxfs_calc_itruncate_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn XFS_DQUOT_LOGRES(mp) +\r\nMAX((xfs_calc_inode_res(mp, 1) +\r\nxfs_calc_buf_res(XFS_BM_MAXLEVELS(mp, XFS_DATA_FORK) + 1,\r\nXFS_FSB_TO_B(mp, 1))),\r\n(xfs_calc_buf_res(9, mp->m_sb.sb_sectsize) +\r\nxfs_calc_buf_res(XFS_ALLOCFREE_LOG_COUNT(mp, 4),\r\nXFS_FSB_TO_B(mp, 1)) +\r\nxfs_calc_buf_res(5, 0) +\r\nxfs_calc_buf_res(XFS_ALLOCFREE_LOG_COUNT(mp, 1),\r\nXFS_FSB_TO_B(mp, 1)) +\r\nxfs_calc_buf_res(2 + mp->m_ialloc_blks +\r\nmp->m_in_maxlevels, 0)));\r\n}\r\nSTATIC uint\r\nxfs_calc_rename_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn XFS_DQUOT_LOGRES(mp) +\r\nMAX((xfs_calc_inode_res(mp, 4) +\r\nxfs_calc_buf_res(2 * XFS_DIROP_LOG_COUNT(mp),\r\nXFS_FSB_TO_B(mp, 1))),\r\n(xfs_calc_buf_res(7, mp->m_sb.sb_sectsize) +\r\nxfs_calc_buf_res(XFS_ALLOCFREE_LOG_COUNT(mp, 3),\r\nXFS_FSB_TO_B(mp, 1))));\r\n}\r\nSTATIC uint\r\nxfs_calc_iunlink_remove_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn xfs_calc_buf_res(1, mp->m_sb.sb_sectsize) +\r\nmax_t(uint, XFS_FSB_TO_B(mp, 1), mp->m_inode_cluster_size);\r\n}\r\nSTATIC uint\r\nxfs_calc_link_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn XFS_DQUOT_LOGRES(mp) +\r\nxfs_calc_iunlink_remove_reservation(mp) +\r\nMAX((xfs_calc_inode_res(mp, 2) +\r\nxfs_calc_buf_res(XFS_DIROP_LOG_COUNT(mp),\r\nXFS_FSB_TO_B(mp, 1))),\r\n(xfs_calc_buf_res(3, mp->m_sb.sb_sectsize) +\r\nxfs_calc_buf_res(XFS_ALLOCFREE_LOG_COUNT(mp, 1),\r\nXFS_FSB_TO_B(mp, 1))));\r\n}\r\nSTATIC uint\r\nxfs_calc_iunlink_add_reservation(xfs_mount_t *mp)\r\n{\r\nreturn xfs_calc_buf_res(1, mp->m_sb.sb_sectsize) +\r\nxfs_calc_inode_res(mp, 1);\r\n}\r\nSTATIC uint\r\nxfs_calc_remove_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn XFS_DQUOT_LOGRES(mp) +\r\nxfs_calc_iunlink_add_reservation(mp) +\r\nMAX((xfs_calc_inode_res(mp, 1) +\r\nxfs_calc_buf_res(XFS_DIROP_LOG_COUNT(mp),\r\nXFS_FSB_TO_B(mp, 1))),\r\n(xfs_calc_buf_res(4, mp->m_sb.sb_sectsize) +\r\nxfs_calc_buf_res(XFS_ALLOCFREE_LOG_COUNT(mp, 2),\r\nXFS_FSB_TO_B(mp, 1))));\r\n}\r\nSTATIC uint\r\nxfs_calc_create_resv_modify(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn xfs_calc_inode_res(mp, 2) +\r\nxfs_calc_buf_res(1, mp->m_sb.sb_sectsize) +\r\n(uint)XFS_FSB_TO_B(mp, 1) +\r\nxfs_calc_buf_res(XFS_DIROP_LOG_COUNT(mp), XFS_FSB_TO_B(mp, 1)) +\r\nxfs_calc_finobt_res(mp, 1, 1);\r\n}\r\nSTATIC uint\r\nxfs_calc_create_resv_alloc(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn xfs_calc_buf_res(2, mp->m_sb.sb_sectsize) +\r\nmp->m_sb.sb_sectsize +\r\nxfs_calc_buf_res(mp->m_ialloc_blks, XFS_FSB_TO_B(mp, 1)) +\r\nxfs_calc_buf_res(mp->m_in_maxlevels, XFS_FSB_TO_B(mp, 1)) +\r\nxfs_calc_buf_res(XFS_ALLOCFREE_LOG_COUNT(mp, 1),\r\nXFS_FSB_TO_B(mp, 1));\r\n}\r\nSTATIC uint\r\n__xfs_calc_create_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn XFS_DQUOT_LOGRES(mp) +\r\nMAX(xfs_calc_create_resv_alloc(mp),\r\nxfs_calc_create_resv_modify(mp));\r\n}\r\nSTATIC uint\r\nxfs_calc_icreate_resv_alloc(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn xfs_calc_buf_res(2, mp->m_sb.sb_sectsize) +\r\nmp->m_sb.sb_sectsize +\r\nxfs_calc_buf_res(mp->m_in_maxlevels, XFS_FSB_TO_B(mp, 1)) +\r\nxfs_calc_buf_res(XFS_ALLOCFREE_LOG_COUNT(mp, 1),\r\nXFS_FSB_TO_B(mp, 1)) +\r\nxfs_calc_finobt_res(mp, 0, 0);\r\n}\r\nSTATIC uint\r\nxfs_calc_icreate_reservation(xfs_mount_t *mp)\r\n{\r\nreturn XFS_DQUOT_LOGRES(mp) +\r\nMAX(xfs_calc_icreate_resv_alloc(mp),\r\nxfs_calc_create_resv_modify(mp));\r\n}\r\nSTATIC uint\r\nxfs_calc_create_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nif (xfs_sb_version_hascrc(&mp->m_sb))\r\nreturn xfs_calc_icreate_reservation(mp);\r\nreturn __xfs_calc_create_reservation(mp);\r\n}\r\nSTATIC uint\r\nxfs_calc_create_tmpfile_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nuint res = XFS_DQUOT_LOGRES(mp);\r\nif (xfs_sb_version_hascrc(&mp->m_sb))\r\nres += xfs_calc_icreate_resv_alloc(mp);\r\nelse\r\nres += xfs_calc_create_resv_alloc(mp);\r\nreturn res + xfs_calc_iunlink_add_reservation(mp);\r\n}\r\nSTATIC uint\r\nxfs_calc_mkdir_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn xfs_calc_create_reservation(mp);\r\n}\r\nSTATIC uint\r\nxfs_calc_symlink_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn xfs_calc_create_reservation(mp) +\r\nxfs_calc_buf_res(1, MAXPATHLEN);\r\n}\r\nSTATIC uint\r\nxfs_calc_ifree_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn XFS_DQUOT_LOGRES(mp) +\r\nxfs_calc_inode_res(mp, 1) +\r\nxfs_calc_buf_res(1, mp->m_sb.sb_sectsize) +\r\nxfs_calc_buf_res(1, XFS_FSB_TO_B(mp, 1)) +\r\nxfs_calc_iunlink_remove_reservation(mp) +\r\nxfs_calc_buf_res(1, 0) +\r\nxfs_calc_buf_res(2 + mp->m_ialloc_blks +\r\nmp->m_in_maxlevels, 0) +\r\nxfs_calc_buf_res(XFS_ALLOCFREE_LOG_COUNT(mp, 1),\r\nXFS_FSB_TO_B(mp, 1)) +\r\nxfs_calc_finobt_res(mp, 0, 1);\r\n}\r\nSTATIC uint\r\nxfs_calc_ichange_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn XFS_DQUOT_LOGRES(mp) +\r\nxfs_calc_inode_res(mp, 1) +\r\nxfs_calc_buf_res(1, mp->m_sb.sb_sectsize);\r\n}\r\nSTATIC uint\r\nxfs_calc_growdata_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn xfs_calc_buf_res(3, mp->m_sb.sb_sectsize) +\r\nxfs_calc_buf_res(XFS_ALLOCFREE_LOG_COUNT(mp, 1),\r\nXFS_FSB_TO_B(mp, 1));\r\n}\r\nSTATIC uint\r\nxfs_calc_growrtalloc_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn xfs_calc_buf_res(2, mp->m_sb.sb_sectsize) +\r\nxfs_calc_buf_res(XFS_BM_MAXLEVELS(mp, XFS_DATA_FORK),\r\nXFS_FSB_TO_B(mp, 1)) +\r\nxfs_calc_inode_res(mp, 1) +\r\nxfs_calc_buf_res(XFS_ALLOCFREE_LOG_COUNT(mp, 1),\r\nXFS_FSB_TO_B(mp, 1));\r\n}\r\nSTATIC uint\r\nxfs_calc_growrtzero_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn xfs_calc_buf_res(1, mp->m_sb.sb_blocksize);\r\n}\r\nSTATIC uint\r\nxfs_calc_growrtfree_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn xfs_calc_buf_res(1, mp->m_sb.sb_sectsize) +\r\nxfs_calc_inode_res(mp, 2) +\r\nxfs_calc_buf_res(1, mp->m_sb.sb_blocksize) +\r\nxfs_calc_buf_res(1, mp->m_rsumsize);\r\n}\r\nSTATIC uint\r\nxfs_calc_swrite_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn xfs_calc_inode_res(mp, 1);\r\n}\r\nSTATIC uint\r\nxfs_calc_writeid_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn xfs_calc_inode_res(mp, 1);\r\n}\r\nSTATIC uint\r\nxfs_calc_addafork_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn XFS_DQUOT_LOGRES(mp) +\r\nxfs_calc_inode_res(mp, 1) +\r\nxfs_calc_buf_res(2, mp->m_sb.sb_sectsize) +\r\nxfs_calc_buf_res(1, mp->m_dir_geo->blksize) +\r\nxfs_calc_buf_res(XFS_DAENTER_BMAP1B(mp, XFS_DATA_FORK) + 1,\r\nXFS_FSB_TO_B(mp, 1)) +\r\nxfs_calc_buf_res(XFS_ALLOCFREE_LOG_COUNT(mp, 1),\r\nXFS_FSB_TO_B(mp, 1));\r\n}\r\nSTATIC uint\r\nxfs_calc_attrinval_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn MAX((xfs_calc_inode_res(mp, 1) +\r\nxfs_calc_buf_res(XFS_BM_MAXLEVELS(mp, XFS_ATTR_FORK),\r\nXFS_FSB_TO_B(mp, 1))),\r\n(xfs_calc_buf_res(9, mp->m_sb.sb_sectsize) +\r\nxfs_calc_buf_res(XFS_ALLOCFREE_LOG_COUNT(mp, 4),\r\nXFS_FSB_TO_B(mp, 1))));\r\n}\r\nSTATIC uint\r\nxfs_calc_attrsetm_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn XFS_DQUOT_LOGRES(mp) +\r\nxfs_calc_inode_res(mp, 1) +\r\nxfs_calc_buf_res(1, mp->m_sb.sb_sectsize) +\r\nxfs_calc_buf_res(XFS_DA_NODE_MAXDEPTH, XFS_FSB_TO_B(mp, 1));\r\n}\r\nSTATIC uint\r\nxfs_calc_attrsetrt_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn xfs_calc_buf_res(1, mp->m_sb.sb_sectsize) +\r\nxfs_calc_buf_res(XFS_BM_MAXLEVELS(mp, XFS_ATTR_FORK),\r\nXFS_FSB_TO_B(mp, 1));\r\n}\r\nSTATIC uint\r\nxfs_calc_attrrm_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn XFS_DQUOT_LOGRES(mp) +\r\nMAX((xfs_calc_inode_res(mp, 1) +\r\nxfs_calc_buf_res(XFS_DA_NODE_MAXDEPTH,\r\nXFS_FSB_TO_B(mp, 1)) +\r\n(uint)XFS_FSB_TO_B(mp,\r\nXFS_BM_MAXLEVELS(mp, XFS_ATTR_FORK)) +\r\nxfs_calc_buf_res(XFS_BM_MAXLEVELS(mp, XFS_DATA_FORK), 0)),\r\n(xfs_calc_buf_res(5, mp->m_sb.sb_sectsize) +\r\nxfs_calc_buf_res(XFS_ALLOCFREE_LOG_COUNT(mp, 2),\r\nXFS_FSB_TO_B(mp, 1))));\r\n}\r\nSTATIC uint\r\nxfs_calc_clear_agi_bucket_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn xfs_calc_buf_res(1, mp->m_sb.sb_sectsize);\r\n}\r\nSTATIC uint\r\nxfs_calc_qm_setqlim_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn xfs_calc_buf_res(1, sizeof(struct xfs_disk_dquot));\r\n}\r\nSTATIC uint\r\nxfs_calc_qm_dqalloc_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn xfs_calc_write_reservation(mp) +\r\nxfs_calc_buf_res(1,\r\nXFS_FSB_TO_B(mp, XFS_DQUOT_CLUSTER_SIZE_FSB) - 1);\r\n}\r\nSTATIC uint\r\nxfs_calc_qm_quotaoff_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn sizeof(struct xfs_qoff_logitem) * 2 +\r\nxfs_calc_buf_res(1, mp->m_sb.sb_sectsize);\r\n}\r\nSTATIC uint\r\nxfs_calc_qm_quotaoff_end_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn sizeof(struct xfs_qoff_logitem) * 2;\r\n}\r\nSTATIC uint\r\nxfs_calc_sb_reservation(\r\nstruct xfs_mount *mp)\r\n{\r\nreturn xfs_calc_buf_res(1, mp->m_sb.sb_sectsize);\r\n}\r\nvoid\r\nxfs_trans_resv_calc(\r\nstruct xfs_mount *mp,\r\nstruct xfs_trans_resv *resp)\r\n{\r\nresp->tr_write.tr_logres = xfs_calc_write_reservation(mp);\r\nresp->tr_write.tr_logcount = XFS_WRITE_LOG_COUNT;\r\nresp->tr_write.tr_logflags |= XFS_TRANS_PERM_LOG_RES;\r\nresp->tr_itruncate.tr_logres = xfs_calc_itruncate_reservation(mp);\r\nresp->tr_itruncate.tr_logcount = XFS_ITRUNCATE_LOG_COUNT;\r\nresp->tr_itruncate.tr_logflags |= XFS_TRANS_PERM_LOG_RES;\r\nresp->tr_rename.tr_logres = xfs_calc_rename_reservation(mp);\r\nresp->tr_rename.tr_logcount = XFS_RENAME_LOG_COUNT;\r\nresp->tr_rename.tr_logflags |= XFS_TRANS_PERM_LOG_RES;\r\nresp->tr_link.tr_logres = xfs_calc_link_reservation(mp);\r\nresp->tr_link.tr_logcount = XFS_LINK_LOG_COUNT;\r\nresp->tr_link.tr_logflags |= XFS_TRANS_PERM_LOG_RES;\r\nresp->tr_remove.tr_logres = xfs_calc_remove_reservation(mp);\r\nresp->tr_remove.tr_logcount = XFS_REMOVE_LOG_COUNT;\r\nresp->tr_remove.tr_logflags |= XFS_TRANS_PERM_LOG_RES;\r\nresp->tr_symlink.tr_logres = xfs_calc_symlink_reservation(mp);\r\nresp->tr_symlink.tr_logcount = XFS_SYMLINK_LOG_COUNT;\r\nresp->tr_symlink.tr_logflags |= XFS_TRANS_PERM_LOG_RES;\r\nresp->tr_create.tr_logres = xfs_calc_create_reservation(mp);\r\nresp->tr_create.tr_logcount = XFS_CREATE_LOG_COUNT;\r\nresp->tr_create.tr_logflags |= XFS_TRANS_PERM_LOG_RES;\r\nresp->tr_create_tmpfile.tr_logres =\r\nxfs_calc_create_tmpfile_reservation(mp);\r\nresp->tr_create_tmpfile.tr_logcount = XFS_CREATE_TMPFILE_LOG_COUNT;\r\nresp->tr_create_tmpfile.tr_logflags |= XFS_TRANS_PERM_LOG_RES;\r\nresp->tr_mkdir.tr_logres = xfs_calc_mkdir_reservation(mp);\r\nresp->tr_mkdir.tr_logcount = XFS_MKDIR_LOG_COUNT;\r\nresp->tr_mkdir.tr_logflags |= XFS_TRANS_PERM_LOG_RES;\r\nresp->tr_ifree.tr_logres = xfs_calc_ifree_reservation(mp);\r\nresp->tr_ifree.tr_logcount = XFS_INACTIVE_LOG_COUNT;\r\nresp->tr_ifree.tr_logflags |= XFS_TRANS_PERM_LOG_RES;\r\nresp->tr_addafork.tr_logres = xfs_calc_addafork_reservation(mp);\r\nresp->tr_addafork.tr_logcount = XFS_ADDAFORK_LOG_COUNT;\r\nresp->tr_addafork.tr_logflags |= XFS_TRANS_PERM_LOG_RES;\r\nresp->tr_attrinval.tr_logres = xfs_calc_attrinval_reservation(mp);\r\nresp->tr_attrinval.tr_logcount = XFS_ATTRINVAL_LOG_COUNT;\r\nresp->tr_attrinval.tr_logflags |= XFS_TRANS_PERM_LOG_RES;\r\nresp->tr_attrsetm.tr_logres = xfs_calc_attrsetm_reservation(mp);\r\nresp->tr_attrsetm.tr_logcount = XFS_ATTRSET_LOG_COUNT;\r\nresp->tr_attrsetm.tr_logflags |= XFS_TRANS_PERM_LOG_RES;\r\nresp->tr_attrrm.tr_logres = xfs_calc_attrrm_reservation(mp);\r\nresp->tr_attrrm.tr_logcount = XFS_ATTRRM_LOG_COUNT;\r\nresp->tr_attrrm.tr_logflags |= XFS_TRANS_PERM_LOG_RES;\r\nresp->tr_growrtalloc.tr_logres = xfs_calc_growrtalloc_reservation(mp);\r\nresp->tr_growrtalloc.tr_logcount = XFS_DEFAULT_PERM_LOG_COUNT;\r\nresp->tr_growrtalloc.tr_logflags |= XFS_TRANS_PERM_LOG_RES;\r\nresp->tr_qm_dqalloc.tr_logres = xfs_calc_qm_dqalloc_reservation(mp);\r\nresp->tr_qm_dqalloc.tr_logcount = XFS_WRITE_LOG_COUNT;\r\nresp->tr_qm_dqalloc.tr_logflags |= XFS_TRANS_PERM_LOG_RES;\r\nresp->tr_qm_setqlim.tr_logres = xfs_calc_qm_setqlim_reservation(mp);\r\nresp->tr_qm_setqlim.tr_logcount = XFS_DEFAULT_LOG_COUNT;\r\nresp->tr_qm_quotaoff.tr_logres = xfs_calc_qm_quotaoff_reservation(mp);\r\nresp->tr_qm_quotaoff.tr_logcount = XFS_DEFAULT_LOG_COUNT;\r\nresp->tr_qm_equotaoff.tr_logres =\r\nxfs_calc_qm_quotaoff_end_reservation(mp);\r\nresp->tr_qm_equotaoff.tr_logcount = XFS_DEFAULT_LOG_COUNT;\r\nresp->tr_sb.tr_logres = xfs_calc_sb_reservation(mp);\r\nresp->tr_sb.tr_logcount = XFS_DEFAULT_LOG_COUNT;\r\nresp->tr_ichange.tr_logres = xfs_calc_ichange_reservation(mp);\r\nresp->tr_growdata.tr_logres = xfs_calc_growdata_reservation(mp);\r\nresp->tr_fsyncts.tr_logres = xfs_calc_swrite_reservation(mp);\r\nresp->tr_writeid.tr_logres = xfs_calc_writeid_reservation(mp);\r\nresp->tr_attrsetrt.tr_logres = xfs_calc_attrsetrt_reservation(mp);\r\nresp->tr_clearagi.tr_logres = xfs_calc_clear_agi_bucket_reservation(mp);\r\nresp->tr_growrtzero.tr_logres = xfs_calc_growrtzero_reservation(mp);\r\nresp->tr_growrtfree.tr_logres = xfs_calc_growrtfree_reservation(mp);\r\n}
