ACPI_FILE acpi_os_open_file(const char *path, u8 modes)\r\n{\r\nACPI_FILE file;\r\nu32 i = 0;\r\nchar modes_str[4];\r\nif (modes & ACPI_FILE_READING) {\r\nmodes_str[i++] = 'r';\r\n}\r\nif (modes & ACPI_FILE_WRITING) {\r\nmodes_str[i++] = 'w';\r\n}\r\nif (modes & ACPI_FILE_BINARY) {\r\nmodes_str[i++] = 'b';\r\n}\r\nmodes_str[i++] = '\0';\r\nfile = fopen(path, modes_str);\r\nif (!file) {\r\nperror("Could not open file");\r\n}\r\nreturn (file);\r\n}\r\nvoid acpi_os_close_file(ACPI_FILE file)\r\n{\r\nfclose(file);\r\n}\r\nint\r\nacpi_os_read_file(ACPI_FILE file, void *buffer, acpi_size size, acpi_size count)\r\n{\r\nint length;\r\nlength = fread(buffer, size, count, file);\r\nif (length < 0) {\r\nperror("Error reading file");\r\n}\r\nreturn (length);\r\n}\r\nint\r\nacpi_os_write_file(ACPI_FILE file,\r\nvoid *buffer, acpi_size size, acpi_size count)\r\n{\r\nint length;\r\nlength = fwrite(buffer, size, count, file);\r\nif (length < 0) {\r\nperror("Error writing file");\r\n}\r\nreturn (length);\r\n}\r\nlong acpi_os_get_file_offset(ACPI_FILE file)\r\n{\r\nlong offset;\r\noffset = ftell(file);\r\nreturn (offset);\r\n}\r\nacpi_status acpi_os_set_file_offset(ACPI_FILE file, long offset, u8 from)\r\n{\r\nint ret = 0;\r\nif (from == ACPI_FILE_BEGIN) {\r\nret = fseek(file, offset, SEEK_SET);\r\n}\r\nif (from == ACPI_FILE_END) {\r\nret = fseek(file, offset, SEEK_END);\r\n}\r\nif (ret < 0) {\r\nreturn (AE_ERROR);\r\n} else {\r\nreturn (AE_OK);\r\n}\r\n}
