char *kvasprintf(gfp_t gfp, const char *fmt, va_list ap)\r\n{\r\nunsigned int len;\r\nchar *p;\r\nva_list aq;\r\nva_copy(aq, ap);\r\nlen = vsnprintf(NULL, 0, fmt, aq);\r\nva_end(aq);\r\np = kmalloc_track_caller(len+1, gfp);\r\nif (!p)\r\nreturn NULL;\r\nvsnprintf(p, len+1, fmt, ap);\r\nreturn p;\r\n}\r\nchar *kasprintf(gfp_t gfp, const char *fmt, ...)\r\n{\r\nva_list ap;\r\nchar *p;\r\nva_start(ap, fmt);\r\np = kvasprintf(gfp, fmt, ap);\r\nva_end(ap);\r\nreturn p;\r\n}
