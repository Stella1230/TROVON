static int __init sh7760_ac97_init(void)\r\n{\r\nint ret;\r\nunsigned short ipsel;\r\nipsel = __raw_readw(IPSEL);\r\n__raw_writew(ipsel | (3 << 10), IPSEL);\r\nret = -ENOMEM;\r\nsh7760_ac97_snd_device = platform_device_alloc("soc-audio", -1);\r\nif (!sh7760_ac97_snd_device)\r\ngoto out;\r\nplatform_set_drvdata(sh7760_ac97_snd_device,\r\n&sh7760_ac97_soc_machine);\r\nret = platform_device_add(sh7760_ac97_snd_device);\r\nif (ret)\r\nplatform_device_put(sh7760_ac97_snd_device);\r\nout:\r\nreturn ret;\r\n}\r\nstatic void __exit sh7760_ac97_exit(void)\r\n{\r\nplatform_device_unregister(sh7760_ac97_snd_device);\r\n}
