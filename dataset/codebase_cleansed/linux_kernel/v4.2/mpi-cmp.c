int mpi_cmp_ui(MPI u, unsigned long v)\r\n{\r\nmpi_limb_t limb = v;\r\nmpi_normalize(u);\r\nif (!u->nlimbs && !limb)\r\nreturn 0;\r\nif (u->sign)\r\nreturn -1;\r\nif (u->nlimbs > 1)\r\nreturn 1;\r\nif (u->d[0] == limb)\r\nreturn 0;\r\nelse if (u->d[0] > limb)\r\nreturn 1;\r\nelse\r\nreturn -1;\r\n}\r\nint mpi_cmp(MPI u, MPI v)\r\n{\r\nmpi_size_t usize, vsize;\r\nint cmp;\r\nmpi_normalize(u);\r\nmpi_normalize(v);\r\nusize = u->nlimbs;\r\nvsize = v->nlimbs;\r\nif (!u->sign && v->sign)\r\nreturn 1;\r\nif (u->sign && !v->sign)\r\nreturn -1;\r\nif (usize != vsize && !u->sign && !v->sign)\r\nreturn usize - vsize;\r\nif (usize != vsize && u->sign && v->sign)\r\nreturn vsize - usize;\r\nif (!usize)\r\nreturn 0;\r\ncmp = mpihelp_cmp(u->d, v->d, usize);\r\nif (u->sign)\r\nreturn -cmp;\r\nreturn cmp;\r\n}
