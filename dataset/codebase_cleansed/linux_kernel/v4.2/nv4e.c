static void\r\nnv4e_i2c_drive_scl(struct nvkm_i2c_port *base, int state)\r\n{\r\nstruct nv4e_i2c_priv *priv = (void *)nvkm_i2c(base);\r\nstruct nv4e_i2c_port *port = (void *)base;\r\nnv_mask(priv, port->addr, 0x2f, state ? 0x21 : 0x01);\r\n}\r\nstatic void\r\nnv4e_i2c_drive_sda(struct nvkm_i2c_port *base, int state)\r\n{\r\nstruct nv4e_i2c_priv *priv = (void *)nvkm_i2c(base);\r\nstruct nv4e_i2c_port *port = (void *)base;\r\nnv_mask(priv, port->addr, 0x1f, state ? 0x11 : 0x01);\r\n}\r\nstatic int\r\nnv4e_i2c_sense_scl(struct nvkm_i2c_port *base)\r\n{\r\nstruct nv4e_i2c_priv *priv = (void *)nvkm_i2c(base);\r\nstruct nv4e_i2c_port *port = (void *)base;\r\nreturn !!(nv_rd32(priv, port->addr) & 0x00040000);\r\n}\r\nstatic int\r\nnv4e_i2c_sense_sda(struct nvkm_i2c_port *base)\r\n{\r\nstruct nv4e_i2c_priv *priv = (void *)nvkm_i2c(base);\r\nstruct nv4e_i2c_port *port = (void *)base;\r\nreturn !!(nv_rd32(priv, port->addr) & 0x00080000);\r\n}\r\nstatic int\r\nnv4e_i2c_port_ctor(struct nvkm_object *parent, struct nvkm_object *engine,\r\nstruct nvkm_oclass *oclass, void *data, u32 index,\r\nstruct nvkm_object **pobject)\r\n{\r\nstruct dcb_i2c_entry *info = data;\r\nstruct nv4e_i2c_port *port;\r\nint ret;\r\nret = nvkm_i2c_port_create(parent, engine, oclass, index,\r\n&nvkm_i2c_bit_algo, &nv4e_i2c_func, &port);\r\n*pobject = nv_object(port);\r\nif (ret)\r\nreturn ret;\r\nport->addr = 0x600800 + info->drive;\r\nreturn 0;\r\n}
