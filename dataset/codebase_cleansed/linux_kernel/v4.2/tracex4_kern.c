int bpf_prog1(struct pt_regs *ctx)\r\n{\r\nlong ptr = ctx->si;\r\nbpf_map_delete_elem(&my_map, &ptr);\r\nreturn 0;\r\n}\r\nint bpf_prog2(struct pt_regs *ctx)\r\n{\r\nlong ptr = ctx->ax;\r\nlong ip = 0;\r\nbpf_probe_read(&ip, sizeof(ip), (void *)(ctx->bp + sizeof(ip)));\r\nstruct pair v = {\r\n.val = bpf_ktime_get_ns(),\r\n.ip = ip,\r\n};\r\nbpf_map_update_elem(&my_map, &ptr, &v, BPF_ANY);\r\nreturn 0;\r\n}
