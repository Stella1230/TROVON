int ax25_register_dev_sysctl(ax25_dev *ax25_dev)\r\n{\r\nchar path[sizeof("net/ax25/") + IFNAMSIZ];\r\nint k;\r\nstruct ctl_table *table;\r\ntable = kmemdup(ax25_param_table, sizeof(ax25_param_table), GFP_KERNEL);\r\nif (!table)\r\nreturn -ENOMEM;\r\nfor (k = 0; k < AX25_MAX_VALUES; k++)\r\ntable[k].data = &ax25_dev->values[k];\r\nsnprintf(path, sizeof(path), "net/ax25/%s", ax25_dev->dev->name);\r\nax25_dev->sysheader = register_net_sysctl(&init_net, path, table);\r\nif (!ax25_dev->sysheader) {\r\nkfree(table);\r\nreturn -ENOMEM;\r\n}\r\nreturn 0;\r\n}\r\nvoid ax25_unregister_dev_sysctl(ax25_dev *ax25_dev)\r\n{\r\nstruct ctl_table_header *header = ax25_dev->sysheader;\r\nstruct ctl_table *table;\r\nif (header) {\r\nax25_dev->sysheader = NULL;\r\ntable = header->ctl_table_arg;\r\nunregister_net_sysctl_table(header);\r\nkfree(table);\r\n}\r\n}
