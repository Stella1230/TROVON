static inline unsigned long\r\n__crypto_memneq_generic(const void *a, const void *b, size_t size)\r\n{\r\nunsigned long neq = 0;\r\n#if defined(CONFIG_HAVE_EFFICIENT_UNALIGNED_ACCESS)\r\nwhile (size >= sizeof(unsigned long)) {\r\nneq |= *(unsigned long *)a ^ *(unsigned long *)b;\r\nOPTIMIZER_HIDE_VAR(neq);\r\na += sizeof(unsigned long);\r\nb += sizeof(unsigned long);\r\nsize -= sizeof(unsigned long);\r\n}\r\n#endif\r\nwhile (size > 0) {\r\nneq |= *(unsigned char *)a ^ *(unsigned char *)b;\r\nOPTIMIZER_HIDE_VAR(neq);\r\na += 1;\r\nb += 1;\r\nsize -= 1;\r\n}\r\nreturn neq;\r\n}\r\nstatic inline unsigned long __crypto_memneq_16(const void *a, const void *b)\r\n{\r\nunsigned long neq = 0;\r\n#ifdef CONFIG_HAVE_EFFICIENT_UNALIGNED_ACCESS\r\nif (sizeof(unsigned long) == 8) {\r\nneq |= *(unsigned long *)(a) ^ *(unsigned long *)(b);\r\nOPTIMIZER_HIDE_VAR(neq);\r\nneq |= *(unsigned long *)(a+8) ^ *(unsigned long *)(b+8);\r\nOPTIMIZER_HIDE_VAR(neq);\r\n} else if (sizeof(unsigned int) == 4) {\r\nneq |= *(unsigned int *)(a) ^ *(unsigned int *)(b);\r\nOPTIMIZER_HIDE_VAR(neq);\r\nneq |= *(unsigned int *)(a+4) ^ *(unsigned int *)(b+4);\r\nOPTIMIZER_HIDE_VAR(neq);\r\nneq |= *(unsigned int *)(a+8) ^ *(unsigned int *)(b+8);\r\nOPTIMIZER_HIDE_VAR(neq);\r\nneq |= *(unsigned int *)(a+12) ^ *(unsigned int *)(b+12);\r\nOPTIMIZER_HIDE_VAR(neq);\r\n} else\r\n#endif\r\n{\r\nneq |= *(unsigned char *)(a) ^ *(unsigned char *)(b);\r\nOPTIMIZER_HIDE_VAR(neq);\r\nneq |= *(unsigned char *)(a+1) ^ *(unsigned char *)(b+1);\r\nOPTIMIZER_HIDE_VAR(neq);\r\nneq |= *(unsigned char *)(a+2) ^ *(unsigned char *)(b+2);\r\nOPTIMIZER_HIDE_VAR(neq);\r\nneq |= *(unsigned char *)(a+3) ^ *(unsigned char *)(b+3);\r\nOPTIMIZER_HIDE_VAR(neq);\r\nneq |= *(unsigned char *)(a+4) ^ *(unsigned char *)(b+4);\r\nOPTIMIZER_HIDE_VAR(neq);\r\nneq |= *(unsigned char *)(a+5) ^ *(unsigned char *)(b+5);\r\nOPTIMIZER_HIDE_VAR(neq);\r\nneq |= *(unsigned char *)(a+6) ^ *(unsigned char *)(b+6);\r\nOPTIMIZER_HIDE_VAR(neq);\r\nneq |= *(unsigned char *)(a+7) ^ *(unsigned char *)(b+7);\r\nOPTIMIZER_HIDE_VAR(neq);\r\nneq |= *(unsigned char *)(a+8) ^ *(unsigned char *)(b+8);\r\nOPTIMIZER_HIDE_VAR(neq);\r\nneq |= *(unsigned char *)(a+9) ^ *(unsigned char *)(b+9);\r\nOPTIMIZER_HIDE_VAR(neq);\r\nneq |= *(unsigned char *)(a+10) ^ *(unsigned char *)(b+10);\r\nOPTIMIZER_HIDE_VAR(neq);\r\nneq |= *(unsigned char *)(a+11) ^ *(unsigned char *)(b+11);\r\nOPTIMIZER_HIDE_VAR(neq);\r\nneq |= *(unsigned char *)(a+12) ^ *(unsigned char *)(b+12);\r\nOPTIMIZER_HIDE_VAR(neq);\r\nneq |= *(unsigned char *)(a+13) ^ *(unsigned char *)(b+13);\r\nOPTIMIZER_HIDE_VAR(neq);\r\nneq |= *(unsigned char *)(a+14) ^ *(unsigned char *)(b+14);\r\nOPTIMIZER_HIDE_VAR(neq);\r\nneq |= *(unsigned char *)(a+15) ^ *(unsigned char *)(b+15);\r\nOPTIMIZER_HIDE_VAR(neq);\r\n}\r\nreturn neq;\r\n}\r\nnoinline unsigned long __crypto_memneq(const void *a, const void *b,\r\nsize_t size)\r\n{\r\nswitch (size) {\r\ncase 16:\r\nreturn __crypto_memneq_16(a, b);\r\ndefault:\r\nreturn __crypto_memneq_generic(a, b, size);\r\n}\r\n}
