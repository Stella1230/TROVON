static int msic_scu_status_change(struct notifier_block *nb,\r\nunsigned long code, void *data)\r\n{\r\nif (code == SCU_DOWN) {\r\nplatform_device_unregister(&msic_device);\r\nreturn 0;\r\n}\r\nreturn platform_device_register(&msic_device);\r\n}\r\nstatic int __init msic_init(void)\r\n{\r\nstatic struct notifier_block msic_scu_notifier = {\r\n.notifier_call = msic_scu_status_change,\r\n};\r\nif (intel_mid_has_msic())\r\nintel_scu_notifier_add(&msic_scu_notifier);\r\nreturn 0;\r\n}\r\nvoid *msic_generic_platform_data(void *info, enum intel_msic_block block)\r\n{\r\nstruct sfi_device_table_entry *entry = info;\r\nBUG_ON(block < 0 || block >= INTEL_MSIC_BLOCK_LAST);\r\nmsic_pdata.irq[block] = entry->irq;\r\nreturn NULL;\r\n}
