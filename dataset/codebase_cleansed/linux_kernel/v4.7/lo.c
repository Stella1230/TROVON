static int\r\nlolnd_send(lnet_ni_t *ni, void *private, lnet_msg_t *lntmsg)\r\n{\r\nLASSERT(!lntmsg->msg_routing);\r\nLASSERT(!lntmsg->msg_target_is_router);\r\nreturn lnet_parse(ni, &lntmsg->msg_hdr, ni->ni_nid, lntmsg, 0);\r\n}\r\nstatic int\r\nlolnd_recv(lnet_ni_t *ni, void *private, lnet_msg_t *lntmsg,\r\nint delayed, unsigned int niov,\r\nstruct kvec *iov, lnet_kiov_t *kiov,\r\nunsigned int offset, unsigned int mlen, unsigned int rlen)\r\n{\r\nlnet_msg_t *sendmsg = private;\r\nif (lntmsg) {\r\nif (sendmsg->msg_iov) {\r\nif (iov)\r\nlnet_copy_iov2iov(niov, iov, offset,\r\nsendmsg->msg_niov,\r\nsendmsg->msg_iov,\r\nsendmsg->msg_offset, mlen);\r\nelse\r\nlnet_copy_iov2kiov(niov, kiov, offset,\r\nsendmsg->msg_niov,\r\nsendmsg->msg_iov,\r\nsendmsg->msg_offset, mlen);\r\n} else {\r\nif (iov)\r\nlnet_copy_kiov2iov(niov, iov, offset,\r\nsendmsg->msg_niov,\r\nsendmsg->msg_kiov,\r\nsendmsg->msg_offset, mlen);\r\nelse\r\nlnet_copy_kiov2kiov(niov, kiov, offset,\r\nsendmsg->msg_niov,\r\nsendmsg->msg_kiov,\r\nsendmsg->msg_offset, mlen);\r\n}\r\nlnet_finalize(ni, lntmsg, 0);\r\n}\r\nlnet_finalize(ni, sendmsg, 0);\r\nreturn 0;\r\n}\r\nstatic void\r\nlolnd_shutdown(lnet_ni_t *ni)\r\n{\r\nCDEBUG(D_NET, "shutdown\n");\r\nLASSERT(lolnd_instanced);\r\nlolnd_instanced = 0;\r\n}\r\nstatic int\r\nlolnd_startup(lnet_ni_t *ni)\r\n{\r\nLASSERT(ni->ni_lnd == &the_lolnd);\r\nLASSERT(!lolnd_instanced);\r\nlolnd_instanced = 1;\r\nreturn 0;\r\n}
