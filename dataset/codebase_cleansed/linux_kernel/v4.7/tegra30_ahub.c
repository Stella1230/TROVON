static inline void tegra30_apbif_write(u32 reg, u32 val)\r\n{\r\nregmap_write(ahub->regmap_apbif, reg, val);\r\n}\r\nstatic inline u32 tegra30_apbif_read(u32 reg)\r\n{\r\nu32 val;\r\nregmap_read(ahub->regmap_apbif, reg, &val);\r\nreturn val;\r\n}\r\nstatic inline void tegra30_audio_write(u32 reg, u32 val)\r\n{\r\nregmap_write(ahub->regmap_ahub, reg, val);\r\n}\r\nstatic int tegra30_ahub_runtime_suspend(struct device *dev)\r\n{\r\nregcache_cache_only(ahub->regmap_apbif, true);\r\nregcache_cache_only(ahub->regmap_ahub, true);\r\nclk_disable_unprepare(ahub->clk_apbif);\r\nclk_disable_unprepare(ahub->clk_d_audio);\r\nreturn 0;\r\n}\r\nstatic int tegra30_ahub_runtime_resume(struct device *dev)\r\n{\r\nint ret;\r\nret = clk_prepare_enable(ahub->clk_d_audio);\r\nif (ret) {\r\ndev_err(dev, "clk_enable d_audio failed: %d\n", ret);\r\nreturn ret;\r\n}\r\nret = clk_prepare_enable(ahub->clk_apbif);\r\nif (ret) {\r\ndev_err(dev, "clk_enable apbif failed: %d\n", ret);\r\nclk_disable(ahub->clk_d_audio);\r\nreturn ret;\r\n}\r\nregcache_cache_only(ahub->regmap_apbif, false);\r\nregcache_cache_only(ahub->regmap_ahub, false);\r\nreturn 0;\r\n}\r\nint tegra30_ahub_allocate_rx_fifo(enum tegra30_ahub_rxcif *rxcif,\r\nchar *dmachan, int dmachan_len,\r\ndma_addr_t *fiforeg)\r\n{\r\nint channel;\r\nu32 reg, val;\r\nstruct tegra30_ahub_cif_conf cif_conf;\r\nchannel = find_first_zero_bit(ahub->rx_usage,\r\nTEGRA30_AHUB_CHANNEL_CTRL_COUNT);\r\nif (channel >= TEGRA30_AHUB_CHANNEL_CTRL_COUNT)\r\nreturn -EBUSY;\r\n__set_bit(channel, ahub->rx_usage);\r\n*rxcif = TEGRA30_AHUB_RXCIF_APBIF_RX0 + channel;\r\nsnprintf(dmachan, dmachan_len, "rx%d", channel);\r\n*fiforeg = ahub->apbif_addr + TEGRA30_AHUB_CHANNEL_RXFIFO +\r\n(channel * TEGRA30_AHUB_CHANNEL_RXFIFO_STRIDE);\r\npm_runtime_get_sync(ahub->dev);\r\nreg = TEGRA30_AHUB_CHANNEL_CTRL +\r\n(channel * TEGRA30_AHUB_CHANNEL_CTRL_STRIDE);\r\nval = tegra30_apbif_read(reg);\r\nval &= ~(TEGRA30_AHUB_CHANNEL_CTRL_RX_THRESHOLD_MASK |\r\nTEGRA30_AHUB_CHANNEL_CTRL_RX_PACK_MASK);\r\nval |= (7 << TEGRA30_AHUB_CHANNEL_CTRL_RX_THRESHOLD_SHIFT) |\r\nTEGRA30_AHUB_CHANNEL_CTRL_RX_PACK_EN |\r\nTEGRA30_AHUB_CHANNEL_CTRL_RX_PACK_16;\r\ntegra30_apbif_write(reg, val);\r\ncif_conf.threshold = 0;\r\ncif_conf.audio_channels = 2;\r\ncif_conf.client_channels = 2;\r\ncif_conf.audio_bits = TEGRA30_AUDIOCIF_BITS_16;\r\ncif_conf.client_bits = TEGRA30_AUDIOCIF_BITS_16;\r\ncif_conf.expand = 0;\r\ncif_conf.stereo_conv = 0;\r\ncif_conf.replicate = 0;\r\ncif_conf.direction = TEGRA30_AUDIOCIF_DIRECTION_RX;\r\ncif_conf.truncate = 0;\r\ncif_conf.mono_conv = 0;\r\nreg = TEGRA30_AHUB_CIF_RX_CTRL +\r\n(channel * TEGRA30_AHUB_CIF_RX_CTRL_STRIDE);\r\nahub->soc_data->set_audio_cif(ahub->regmap_apbif, reg, &cif_conf);\r\npm_runtime_put(ahub->dev);\r\nreturn 0;\r\n}\r\nint tegra30_ahub_enable_rx_fifo(enum tegra30_ahub_rxcif rxcif)\r\n{\r\nint channel = rxcif - TEGRA30_AHUB_RXCIF_APBIF_RX0;\r\nint reg, val;\r\npm_runtime_get_sync(ahub->dev);\r\nreg = TEGRA30_AHUB_CHANNEL_CTRL +\r\n(channel * TEGRA30_AHUB_CHANNEL_CTRL_STRIDE);\r\nval = tegra30_apbif_read(reg);\r\nval |= TEGRA30_AHUB_CHANNEL_CTRL_RX_EN;\r\ntegra30_apbif_write(reg, val);\r\npm_runtime_put(ahub->dev);\r\nreturn 0;\r\n}\r\nint tegra30_ahub_disable_rx_fifo(enum tegra30_ahub_rxcif rxcif)\r\n{\r\nint channel = rxcif - TEGRA30_AHUB_RXCIF_APBIF_RX0;\r\nint reg, val;\r\npm_runtime_get_sync(ahub->dev);\r\nreg = TEGRA30_AHUB_CHANNEL_CTRL +\r\n(channel * TEGRA30_AHUB_CHANNEL_CTRL_STRIDE);\r\nval = tegra30_apbif_read(reg);\r\nval &= ~TEGRA30_AHUB_CHANNEL_CTRL_RX_EN;\r\ntegra30_apbif_write(reg, val);\r\npm_runtime_put(ahub->dev);\r\nreturn 0;\r\n}\r\nint tegra30_ahub_free_rx_fifo(enum tegra30_ahub_rxcif rxcif)\r\n{\r\nint channel = rxcif - TEGRA30_AHUB_RXCIF_APBIF_RX0;\r\n__clear_bit(channel, ahub->rx_usage);\r\nreturn 0;\r\n}\r\nint tegra30_ahub_allocate_tx_fifo(enum tegra30_ahub_txcif *txcif,\r\nchar *dmachan, int dmachan_len,\r\ndma_addr_t *fiforeg)\r\n{\r\nint channel;\r\nu32 reg, val;\r\nstruct tegra30_ahub_cif_conf cif_conf;\r\nchannel = find_first_zero_bit(ahub->tx_usage,\r\nTEGRA30_AHUB_CHANNEL_CTRL_COUNT);\r\nif (channel >= TEGRA30_AHUB_CHANNEL_CTRL_COUNT)\r\nreturn -EBUSY;\r\n__set_bit(channel, ahub->tx_usage);\r\n*txcif = TEGRA30_AHUB_TXCIF_APBIF_TX0 + channel;\r\nsnprintf(dmachan, dmachan_len, "tx%d", channel);\r\n*fiforeg = ahub->apbif_addr + TEGRA30_AHUB_CHANNEL_TXFIFO +\r\n(channel * TEGRA30_AHUB_CHANNEL_TXFIFO_STRIDE);\r\npm_runtime_get_sync(ahub->dev);\r\nreg = TEGRA30_AHUB_CHANNEL_CTRL +\r\n(channel * TEGRA30_AHUB_CHANNEL_CTRL_STRIDE);\r\nval = tegra30_apbif_read(reg);\r\nval &= ~(TEGRA30_AHUB_CHANNEL_CTRL_TX_THRESHOLD_MASK |\r\nTEGRA30_AHUB_CHANNEL_CTRL_TX_PACK_MASK);\r\nval |= (7 << TEGRA30_AHUB_CHANNEL_CTRL_TX_THRESHOLD_SHIFT) |\r\nTEGRA30_AHUB_CHANNEL_CTRL_TX_PACK_EN |\r\nTEGRA30_AHUB_CHANNEL_CTRL_TX_PACK_16;\r\ntegra30_apbif_write(reg, val);\r\ncif_conf.threshold = 0;\r\ncif_conf.audio_channels = 2;\r\ncif_conf.client_channels = 2;\r\ncif_conf.audio_bits = TEGRA30_AUDIOCIF_BITS_16;\r\ncif_conf.client_bits = TEGRA30_AUDIOCIF_BITS_16;\r\ncif_conf.expand = 0;\r\ncif_conf.stereo_conv = 0;\r\ncif_conf.replicate = 0;\r\ncif_conf.direction = TEGRA30_AUDIOCIF_DIRECTION_TX;\r\ncif_conf.truncate = 0;\r\ncif_conf.mono_conv = 0;\r\nreg = TEGRA30_AHUB_CIF_TX_CTRL +\r\n(channel * TEGRA30_AHUB_CIF_TX_CTRL_STRIDE);\r\nahub->soc_data->set_audio_cif(ahub->regmap_apbif, reg, &cif_conf);\r\npm_runtime_put(ahub->dev);\r\nreturn 0;\r\n}\r\nint tegra30_ahub_enable_tx_fifo(enum tegra30_ahub_txcif txcif)\r\n{\r\nint channel = txcif - TEGRA30_AHUB_TXCIF_APBIF_TX0;\r\nint reg, val;\r\npm_runtime_get_sync(ahub->dev);\r\nreg = TEGRA30_AHUB_CHANNEL_CTRL +\r\n(channel * TEGRA30_AHUB_CHANNEL_CTRL_STRIDE);\r\nval = tegra30_apbif_read(reg);\r\nval |= TEGRA30_AHUB_CHANNEL_CTRL_TX_EN;\r\ntegra30_apbif_write(reg, val);\r\npm_runtime_put(ahub->dev);\r\nreturn 0;\r\n}\r\nint tegra30_ahub_disable_tx_fifo(enum tegra30_ahub_txcif txcif)\r\n{\r\nint channel = txcif - TEGRA30_AHUB_TXCIF_APBIF_TX0;\r\nint reg, val;\r\npm_runtime_get_sync(ahub->dev);\r\nreg = TEGRA30_AHUB_CHANNEL_CTRL +\r\n(channel * TEGRA30_AHUB_CHANNEL_CTRL_STRIDE);\r\nval = tegra30_apbif_read(reg);\r\nval &= ~TEGRA30_AHUB_CHANNEL_CTRL_TX_EN;\r\ntegra30_apbif_write(reg, val);\r\npm_runtime_put(ahub->dev);\r\nreturn 0;\r\n}\r\nint tegra30_ahub_free_tx_fifo(enum tegra30_ahub_txcif txcif)\r\n{\r\nint channel = txcif - TEGRA30_AHUB_TXCIF_APBIF_TX0;\r\n__clear_bit(channel, ahub->tx_usage);\r\nreturn 0;\r\n}\r\nint tegra30_ahub_set_rx_cif_source(enum tegra30_ahub_rxcif rxcif,\r\nenum tegra30_ahub_txcif txcif)\r\n{\r\nint channel = rxcif - TEGRA30_AHUB_RXCIF_APBIF_RX0;\r\nint reg;\r\npm_runtime_get_sync(ahub->dev);\r\nreg = TEGRA30_AHUB_AUDIO_RX +\r\n(channel * TEGRA30_AHUB_AUDIO_RX_STRIDE);\r\ntegra30_audio_write(reg, 1 << txcif);\r\npm_runtime_put(ahub->dev);\r\nreturn 0;\r\n}\r\nint tegra30_ahub_unset_rx_cif_source(enum tegra30_ahub_rxcif rxcif)\r\n{\r\nint channel = rxcif - TEGRA30_AHUB_RXCIF_APBIF_RX0;\r\nint reg;\r\npm_runtime_get_sync(ahub->dev);\r\nreg = TEGRA30_AHUB_AUDIO_RX +\r\n(channel * TEGRA30_AHUB_AUDIO_RX_STRIDE);\r\ntegra30_audio_write(reg, 0);\r\npm_runtime_put(ahub->dev);\r\nreturn 0;\r\n}\r\nstatic bool tegra30_ahub_apbif_wr_rd_reg(struct device *dev, unsigned int reg)\r\n{\r\nswitch (reg) {\r\ncase TEGRA30_AHUB_CONFIG_LINK_CTRL:\r\ncase TEGRA30_AHUB_MISC_CTRL:\r\ncase TEGRA30_AHUB_APBDMA_LIVE_STATUS:\r\ncase TEGRA30_AHUB_I2S_LIVE_STATUS:\r\ncase TEGRA30_AHUB_SPDIF_LIVE_STATUS:\r\ncase TEGRA30_AHUB_I2S_INT_MASK:\r\ncase TEGRA30_AHUB_DAM_INT_MASK:\r\ncase TEGRA30_AHUB_SPDIF_INT_MASK:\r\ncase TEGRA30_AHUB_APBIF_INT_MASK:\r\ncase TEGRA30_AHUB_I2S_INT_STATUS:\r\ncase TEGRA30_AHUB_DAM_INT_STATUS:\r\ncase TEGRA30_AHUB_SPDIF_INT_STATUS:\r\ncase TEGRA30_AHUB_APBIF_INT_STATUS:\r\ncase TEGRA30_AHUB_I2S_INT_SOURCE:\r\ncase TEGRA30_AHUB_DAM_INT_SOURCE:\r\ncase TEGRA30_AHUB_SPDIF_INT_SOURCE:\r\ncase TEGRA30_AHUB_APBIF_INT_SOURCE:\r\ncase TEGRA30_AHUB_I2S_INT_SET:\r\ncase TEGRA30_AHUB_DAM_INT_SET:\r\ncase TEGRA30_AHUB_SPDIF_INT_SET:\r\ncase TEGRA30_AHUB_APBIF_INT_SET:\r\nreturn true;\r\ndefault:\r\nbreak;\r\n}\r\nif (REG_IN_ARRAY(reg, CHANNEL_CTRL) ||\r\nREG_IN_ARRAY(reg, CHANNEL_CLEAR) ||\r\nREG_IN_ARRAY(reg, CHANNEL_STATUS) ||\r\nREG_IN_ARRAY(reg, CHANNEL_TXFIFO) ||\r\nREG_IN_ARRAY(reg, CHANNEL_RXFIFO) ||\r\nREG_IN_ARRAY(reg, CIF_TX_CTRL) ||\r\nREG_IN_ARRAY(reg, CIF_RX_CTRL) ||\r\nREG_IN_ARRAY(reg, DAM_LIVE_STATUS))\r\nreturn true;\r\nreturn false;\r\n}\r\nstatic bool tegra30_ahub_apbif_volatile_reg(struct device *dev,\r\nunsigned int reg)\r\n{\r\nswitch (reg) {\r\ncase TEGRA30_AHUB_CONFIG_LINK_CTRL:\r\ncase TEGRA30_AHUB_MISC_CTRL:\r\ncase TEGRA30_AHUB_APBDMA_LIVE_STATUS:\r\ncase TEGRA30_AHUB_I2S_LIVE_STATUS:\r\ncase TEGRA30_AHUB_SPDIF_LIVE_STATUS:\r\ncase TEGRA30_AHUB_I2S_INT_STATUS:\r\ncase TEGRA30_AHUB_DAM_INT_STATUS:\r\ncase TEGRA30_AHUB_SPDIF_INT_STATUS:\r\ncase TEGRA30_AHUB_APBIF_INT_STATUS:\r\ncase TEGRA30_AHUB_I2S_INT_SET:\r\ncase TEGRA30_AHUB_DAM_INT_SET:\r\ncase TEGRA30_AHUB_SPDIF_INT_SET:\r\ncase TEGRA30_AHUB_APBIF_INT_SET:\r\nreturn true;\r\ndefault:\r\nbreak;\r\n}\r\nif (REG_IN_ARRAY(reg, CHANNEL_CLEAR) ||\r\nREG_IN_ARRAY(reg, CHANNEL_STATUS) ||\r\nREG_IN_ARRAY(reg, CHANNEL_TXFIFO) ||\r\nREG_IN_ARRAY(reg, CHANNEL_RXFIFO) ||\r\nREG_IN_ARRAY(reg, DAM_LIVE_STATUS))\r\nreturn true;\r\nreturn false;\r\n}\r\nstatic bool tegra30_ahub_apbif_precious_reg(struct device *dev,\r\nunsigned int reg)\r\n{\r\nif (REG_IN_ARRAY(reg, CHANNEL_TXFIFO) ||\r\nREG_IN_ARRAY(reg, CHANNEL_RXFIFO))\r\nreturn true;\r\nreturn false;\r\n}\r\nstatic bool tegra30_ahub_ahub_wr_rd_reg(struct device *dev, unsigned int reg)\r\n{\r\nif (REG_IN_ARRAY(reg, AUDIO_RX))\r\nreturn true;\r\nreturn false;\r\n}\r\nstatic int tegra30_ahub_probe(struct platform_device *pdev)\r\n{\r\nconst struct of_device_id *match;\r\nconst struct tegra30_ahub_soc_data *soc_data;\r\nstruct reset_control *rst;\r\nint i;\r\nstruct resource *res0, *res1;\r\nvoid __iomem *regs_apbif, *regs_ahub;\r\nint ret = 0;\r\nif (ahub)\r\nreturn -ENODEV;\r\nmatch = of_match_device(tegra30_ahub_of_match, &pdev->dev);\r\nif (!match)\r\nreturn -EINVAL;\r\nsoc_data = match->data;\r\nfor (i = 0; i < ARRAY_SIZE(configlink_mods); i++) {\r\nif (!(configlink_mods[i].mod_list_mask &\r\nsoc_data->mod_list_mask))\r\ncontinue;\r\nrst = reset_control_get(&pdev->dev,\r\nconfiglink_mods[i].rst_name);\r\nif (IS_ERR(rst)) {\r\ndev_err(&pdev->dev, "Can't get reset %s\n",\r\nconfiglink_mods[i].rst_name);\r\nret = PTR_ERR(rst);\r\nreturn ret;\r\n}\r\nret = reset_control_deassert(rst);\r\nreset_control_put(rst);\r\nif (ret)\r\nreturn ret;\r\n}\r\nahub = devm_kzalloc(&pdev->dev, sizeof(struct tegra30_ahub),\r\nGFP_KERNEL);\r\nif (!ahub) {\r\ndev_err(&pdev->dev, "Can't allocate tegra30_ahub\n");\r\nreturn -ENOMEM;\r\n}\r\ndev_set_drvdata(&pdev->dev, ahub);\r\nahub->soc_data = soc_data;\r\nahub->dev = &pdev->dev;\r\nahub->clk_d_audio = devm_clk_get(&pdev->dev, "d_audio");\r\nif (IS_ERR(ahub->clk_d_audio)) {\r\ndev_err(&pdev->dev, "Can't retrieve ahub d_audio clock\n");\r\nret = PTR_ERR(ahub->clk_d_audio);\r\nreturn ret;\r\n}\r\nahub->clk_apbif = devm_clk_get(&pdev->dev, "apbif");\r\nif (IS_ERR(ahub->clk_apbif)) {\r\ndev_err(&pdev->dev, "Can't retrieve ahub apbif clock\n");\r\nret = PTR_ERR(ahub->clk_apbif);\r\nreturn ret;\r\n}\r\nres0 = platform_get_resource(pdev, IORESOURCE_MEM, 0);\r\nregs_apbif = devm_ioremap_resource(&pdev->dev, res0);\r\nif (IS_ERR(regs_apbif))\r\nreturn PTR_ERR(regs_apbif);\r\nahub->apbif_addr = res0->start;\r\nahub->regmap_apbif = devm_regmap_init_mmio(&pdev->dev, regs_apbif,\r\n&tegra30_ahub_apbif_regmap_config);\r\nif (IS_ERR(ahub->regmap_apbif)) {\r\ndev_err(&pdev->dev, "apbif regmap init failed\n");\r\nret = PTR_ERR(ahub->regmap_apbif);\r\nreturn ret;\r\n}\r\nregcache_cache_only(ahub->regmap_apbif, true);\r\nres1 = platform_get_resource(pdev, IORESOURCE_MEM, 1);\r\nregs_ahub = devm_ioremap_resource(&pdev->dev, res1);\r\nif (IS_ERR(regs_ahub))\r\nreturn PTR_ERR(regs_ahub);\r\nahub->regmap_ahub = devm_regmap_init_mmio(&pdev->dev, regs_ahub,\r\n&tegra30_ahub_ahub_regmap_config);\r\nif (IS_ERR(ahub->regmap_ahub)) {\r\ndev_err(&pdev->dev, "ahub regmap init failed\n");\r\nret = PTR_ERR(ahub->regmap_ahub);\r\nreturn ret;\r\n}\r\nregcache_cache_only(ahub->regmap_ahub, true);\r\npm_runtime_enable(&pdev->dev);\r\nif (!pm_runtime_enabled(&pdev->dev)) {\r\nret = tegra30_ahub_runtime_resume(&pdev->dev);\r\nif (ret)\r\ngoto err_pm_disable;\r\n}\r\nof_platform_populate(pdev->dev.of_node, NULL, NULL, &pdev->dev);\r\nreturn 0;\r\nerr_pm_disable:\r\npm_runtime_disable(&pdev->dev);\r\nreturn ret;\r\n}\r\nstatic int tegra30_ahub_remove(struct platform_device *pdev)\r\n{\r\nif (!ahub)\r\nreturn -ENODEV;\r\npm_runtime_disable(&pdev->dev);\r\nif (!pm_runtime_status_suspended(&pdev->dev))\r\ntegra30_ahub_runtime_suspend(&pdev->dev);\r\nreturn 0;\r\n}\r\nstatic int tegra30_ahub_suspend(struct device *dev)\r\n{\r\nregcache_mark_dirty(ahub->regmap_ahub);\r\nregcache_mark_dirty(ahub->regmap_apbif);\r\nreturn 0;\r\n}\r\nstatic int tegra30_ahub_resume(struct device *dev)\r\n{\r\nint ret;\r\nret = pm_runtime_get_sync(dev);\r\nif (ret < 0)\r\nreturn ret;\r\nret = regcache_sync(ahub->regmap_ahub);\r\nret |= regcache_sync(ahub->regmap_apbif);\r\npm_runtime_put(dev);\r\nreturn ret;\r\n}\r\nvoid tegra30_ahub_set_cif(struct regmap *regmap, unsigned int reg,\r\nstruct tegra30_ahub_cif_conf *conf)\r\n{\r\nunsigned int value;\r\nvalue = (conf->threshold <<\r\nTEGRA30_AUDIOCIF_CTRL_FIFO_THRESHOLD_SHIFT) |\r\n((conf->audio_channels - 1) <<\r\nTEGRA30_AUDIOCIF_CTRL_AUDIO_CHANNELS_SHIFT) |\r\n((conf->client_channels - 1) <<\r\nTEGRA30_AUDIOCIF_CTRL_CLIENT_CHANNELS_SHIFT) |\r\n(conf->audio_bits <<\r\nTEGRA30_AUDIOCIF_CTRL_AUDIO_BITS_SHIFT) |\r\n(conf->client_bits <<\r\nTEGRA30_AUDIOCIF_CTRL_CLIENT_BITS_SHIFT) |\r\n(conf->expand <<\r\nTEGRA30_AUDIOCIF_CTRL_EXPAND_SHIFT) |\r\n(conf->stereo_conv <<\r\nTEGRA30_AUDIOCIF_CTRL_STEREO_CONV_SHIFT) |\r\n(conf->replicate <<\r\nTEGRA30_AUDIOCIF_CTRL_REPLICATE_SHIFT) |\r\n(conf->direction <<\r\nTEGRA30_AUDIOCIF_CTRL_DIRECTION_SHIFT) |\r\n(conf->truncate <<\r\nTEGRA30_AUDIOCIF_CTRL_TRUNCATE_SHIFT) |\r\n(conf->mono_conv <<\r\nTEGRA30_AUDIOCIF_CTRL_MONO_CONV_SHIFT);\r\nregmap_write(regmap, reg, value);\r\n}\r\nvoid tegra124_ahub_set_cif(struct regmap *regmap, unsigned int reg,\r\nstruct tegra30_ahub_cif_conf *conf)\r\n{\r\nunsigned int value;\r\nvalue = (conf->threshold <<\r\nTEGRA124_AUDIOCIF_CTRL_FIFO_THRESHOLD_SHIFT) |\r\n((conf->audio_channels - 1) <<\r\nTEGRA124_AUDIOCIF_CTRL_AUDIO_CHANNELS_SHIFT) |\r\n((conf->client_channels - 1) <<\r\nTEGRA124_AUDIOCIF_CTRL_CLIENT_CHANNELS_SHIFT) |\r\n(conf->audio_bits <<\r\nTEGRA30_AUDIOCIF_CTRL_AUDIO_BITS_SHIFT) |\r\n(conf->client_bits <<\r\nTEGRA30_AUDIOCIF_CTRL_CLIENT_BITS_SHIFT) |\r\n(conf->expand <<\r\nTEGRA30_AUDIOCIF_CTRL_EXPAND_SHIFT) |\r\n(conf->stereo_conv <<\r\nTEGRA30_AUDIOCIF_CTRL_STEREO_CONV_SHIFT) |\r\n(conf->replicate <<\r\nTEGRA30_AUDIOCIF_CTRL_REPLICATE_SHIFT) |\r\n(conf->direction <<\r\nTEGRA30_AUDIOCIF_CTRL_DIRECTION_SHIFT) |\r\n(conf->truncate <<\r\nTEGRA30_AUDIOCIF_CTRL_TRUNCATE_SHIFT) |\r\n(conf->mono_conv <<\r\nTEGRA30_AUDIOCIF_CTRL_MONO_CONV_SHIFT);\r\nregmap_write(regmap, reg, value);\r\n}
