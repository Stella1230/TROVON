static int dwmac_generic_probe(struct platform_device *pdev)\r\n{\r\nstruct plat_stmmacenet_data *plat_dat;\r\nstruct stmmac_resources stmmac_res;\r\nint ret;\r\nret = stmmac_get_platform_resources(pdev, &stmmac_res);\r\nif (ret)\r\nreturn ret;\r\nif (pdev->dev.of_node) {\r\nplat_dat = stmmac_probe_config_dt(pdev, &stmmac_res.mac);\r\nif (IS_ERR(plat_dat)) {\r\ndev_err(&pdev->dev, "dt configuration failed\n");\r\nreturn PTR_ERR(plat_dat);\r\n}\r\n} else {\r\nplat_dat = dev_get_platdata(&pdev->dev);\r\nif (!plat_dat) {\r\ndev_err(&pdev->dev, "no platform data provided\n");\r\nreturn -EINVAL;\r\n}\r\nplat_dat->multicast_filter_bins = HASH_TABLE_SIZE;\r\nplat_dat->unicast_filter_entries = 1;\r\n}\r\nif (plat_dat->init) {\r\nret = plat_dat->init(pdev, plat_dat->bsp_priv);\r\nif (ret)\r\nreturn ret;\r\n}\r\nreturn stmmac_dvr_probe(&pdev->dev, plat_dat, &stmmac_res);\r\n}
