insn_attr_t inat_get_opcode_attribute(insn_byte_t opcode)\r\n{\r\nreturn inat_primary_table[opcode];\r\n}\r\nint inat_get_last_prefix_id(insn_byte_t last_pfx)\r\n{\r\ninsn_attr_t lpfx_attr;\r\nlpfx_attr = inat_get_opcode_attribute(last_pfx);\r\nreturn inat_last_prefix_id(lpfx_attr);\r\n}\r\ninsn_attr_t inat_get_escape_attribute(insn_byte_t opcode, int lpfx_id,\r\ninsn_attr_t esc_attr)\r\n{\r\nconst insn_attr_t *table;\r\nint n;\r\nn = inat_escape_id(esc_attr);\r\ntable = inat_escape_tables[n][0];\r\nif (!table)\r\nreturn 0;\r\nif (inat_has_variant(table[opcode]) && lpfx_id) {\r\ntable = inat_escape_tables[n][lpfx_id];\r\nif (!table)\r\nreturn 0;\r\n}\r\nreturn table[opcode];\r\n}\r\ninsn_attr_t inat_get_group_attribute(insn_byte_t modrm, int lpfx_id,\r\ninsn_attr_t grp_attr)\r\n{\r\nconst insn_attr_t *table;\r\nint n;\r\nn = inat_group_id(grp_attr);\r\ntable = inat_group_tables[n][0];\r\nif (!table)\r\nreturn inat_group_common_attribute(grp_attr);\r\nif (inat_has_variant(table[X86_MODRM_REG(modrm)]) && lpfx_id) {\r\ntable = inat_group_tables[n][lpfx_id];\r\nif (!table)\r\nreturn inat_group_common_attribute(grp_attr);\r\n}\r\nreturn table[X86_MODRM_REG(modrm)] |\r\ninat_group_common_attribute(grp_attr);\r\n}\r\ninsn_attr_t inat_get_avx_attribute(insn_byte_t opcode, insn_byte_t vex_m,\r\ninsn_byte_t vex_p)\r\n{\r\nconst insn_attr_t *table;\r\nif (vex_m > X86_VEX_M_MAX || vex_p > INAT_LSTPFX_MAX)\r\nreturn 0;\r\ntable = inat_avx_tables[vex_m][0];\r\nif (!table)\r\nreturn 0;\r\nif (!inat_is_group(table[opcode]) && vex_p) {\r\ntable = inat_avx_tables[vex_m][vex_p];\r\nif (!table)\r\nreturn 0;\r\n}\r\nreturn table[opcode];\r\n}
