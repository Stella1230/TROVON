struct key *request_trusted_key(const char *trusted_desc,\r\nconst u8 **master_key, size_t *master_keylen)\r\n{\r\nstruct trusted_key_payload *tpayload;\r\nstruct key *tkey;\r\ntkey = request_key(&key_type_trusted, trusted_desc, NULL);\r\nif (IS_ERR(tkey))\r\ngoto error;\r\ndown_read(&tkey->sem);\r\ntpayload = tkey->payload.data[0];\r\n*master_key = tpayload->key;\r\n*master_keylen = tpayload->key_len;\r\nerror:\r\nreturn tkey;\r\n}
