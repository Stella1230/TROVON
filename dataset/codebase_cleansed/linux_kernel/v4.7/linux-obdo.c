void obdo_refresh_inode(struct inode *dst, struct obdo *src, u32 valid)\r\n{\r\nvalid &= src->o_valid;\r\nif (valid & (OBD_MD_FLCTIME | OBD_MD_FLMTIME))\r\nCDEBUG(D_INODE,\r\n"valid %#llx, cur time %lu/%lu, new %llu/%llu\n",\r\nsrc->o_valid, LTIME_S(dst->i_mtime),\r\nLTIME_S(dst->i_ctime), src->o_mtime, src->o_ctime);\r\nif (valid & OBD_MD_FLATIME && src->o_atime > LTIME_S(dst->i_atime))\r\nLTIME_S(dst->i_atime) = src->o_atime;\r\nif (valid & OBD_MD_FLMTIME && src->o_mtime > LTIME_S(dst->i_mtime))\r\nLTIME_S(dst->i_mtime) = src->o_mtime;\r\nif (valid & OBD_MD_FLCTIME && src->o_ctime > LTIME_S(dst->i_ctime))\r\nLTIME_S(dst->i_ctime) = src->o_ctime;\r\nif (valid & OBD_MD_FLSIZE)\r\ni_size_write(dst, src->o_size);\r\nif (valid & OBD_MD_FLBLKSZ && src->o_blksize > (1 << dst->i_blkbits))\r\ndst->i_blkbits = ffs(src->o_blksize) - 1;\r\nif (dst->i_blkbits < PAGE_SHIFT)\r\ndst->i_blkbits = PAGE_SHIFT;\r\nif (valid & OBD_MD_FLBLOCKS && src->o_blocks > dst->i_blocks)\r\ndst->i_blocks = src->o_blocks;\r\n}
