static void *dma_noop_alloc(struct device *dev, size_t size,\r\ndma_addr_t *dma_handle, gfp_t gfp,\r\nstruct dma_attrs *attrs)\r\n{\r\nvoid *ret;\r\nret = (void *)__get_free_pages(gfp, get_order(size));\r\nif (ret)\r\n*dma_handle = virt_to_phys(ret);\r\nreturn ret;\r\n}\r\nstatic void dma_noop_free(struct device *dev, size_t size,\r\nvoid *cpu_addr, dma_addr_t dma_addr,\r\nstruct dma_attrs *attrs)\r\n{\r\nfree_pages((unsigned long)cpu_addr, get_order(size));\r\n}\r\nstatic dma_addr_t dma_noop_map_page(struct device *dev, struct page *page,\r\nunsigned long offset, size_t size,\r\nenum dma_data_direction dir,\r\nstruct dma_attrs *attrs)\r\n{\r\nreturn page_to_phys(page) + offset;\r\n}\r\nstatic int dma_noop_map_sg(struct device *dev, struct scatterlist *sgl, int nents,\r\nenum dma_data_direction dir, struct dma_attrs *attrs)\r\n{\r\nint i;\r\nstruct scatterlist *sg;\r\nfor_each_sg(sgl, sg, nents, i) {\r\nvoid *va;\r\nBUG_ON(!sg_page(sg));\r\nva = sg_virt(sg);\r\nsg_dma_address(sg) = (dma_addr_t)virt_to_phys(va);\r\nsg_dma_len(sg) = sg->length;\r\n}\r\nreturn nents;\r\n}\r\nstatic int dma_noop_mapping_error(struct device *dev, dma_addr_t dma_addr)\r\n{\r\nreturn 0;\r\n}\r\nstatic int dma_noop_supported(struct device *dev, u64 mask)\r\n{\r\nreturn 1;\r\n}
