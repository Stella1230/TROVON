int pci_hp_add_bridge(struct pci_dev *dev)\r\n{\r\nstruct pci_bus *parent = dev->bus;\r\nint pass, busnr, start = parent->busn_res.start;\r\nint end = parent->busn_res.end;\r\nfor (busnr = start; busnr <= end; busnr++) {\r\nif (!pci_find_bus(pci_domain_nr(parent), busnr))\r\nbreak;\r\n}\r\nif (busnr-- > end) {\r\nprintk(KERN_ERR "No bus number available for hot-added bridge %s\n",\r\npci_name(dev));\r\nreturn -1;\r\n}\r\nfor (pass = 0; pass < 2; pass++)\r\nbusnr = pci_scan_bridge(parent, dev, busnr, pass);\r\nif (!dev->subordinate)\r\nreturn -1;\r\nreturn 0;\r\n}
