int llc_mac_hdr_init(struct sk_buff *skb,\r\nconst unsigned char *sa, const unsigned char *da)\r\n{\r\nint rc = -EINVAL;\r\nswitch (skb->dev->type) {\r\ncase ARPHRD_ETHER:\r\ncase ARPHRD_LOOPBACK:\r\nrc = dev_hard_header(skb, skb->dev, ETH_P_802_2, da, sa,\r\nskb->len);\r\nif (rc > 0)\r\nrc = 0;\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nreturn rc;\r\n}\r\nint llc_build_and_send_ui_pkt(struct llc_sap *sap, struct sk_buff *skb,\r\nunsigned char *dmac, unsigned char dsap)\r\n{\r\nint rc;\r\nllc_pdu_header_init(skb, LLC_PDU_TYPE_U, sap->laddr.lsap,\r\ndsap, LLC_PDU_CMD);\r\nllc_pdu_init_as_ui_cmd(skb);\r\nrc = llc_mac_hdr_init(skb, skb->dev->dev_addr, dmac);\r\nif (likely(!rc))\r\nrc = dev_queue_xmit(skb);\r\nreturn rc;\r\n}
