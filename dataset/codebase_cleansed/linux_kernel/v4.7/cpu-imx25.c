static int mx25_read_cpu_rev(void)\r\n{\r\nu32 rev;\r\nvoid __iomem *iim_base;\r\nstruct device_node *np;\r\nnp = of_find_compatible_node(NULL, NULL, "fsl,imx25-iim");\r\niim_base = of_iomap(np, 0);\r\nBUG_ON(!iim_base);\r\nrev = readl(iim_base + MXC_IIMSREV);\r\niounmap(iim_base);\r\nswitch (rev) {\r\ncase 0x00:\r\nreturn IMX_CHIP_REVISION_1_0;\r\ncase 0x01:\r\nreturn IMX_CHIP_REVISION_1_1;\r\ndefault:\r\nreturn IMX_CHIP_REVISION_UNKNOWN;\r\n}\r\n}\r\nint mx25_revision(void)\r\n{\r\nif (mx25_cpu_rev == -1)\r\nmx25_cpu_rev = mx25_read_cpu_rev();\r\nreturn mx25_cpu_rev;\r\n}
