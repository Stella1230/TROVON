void perf_gtk__signal(int sig)\r\n{\r\nperf_gtk__exit(false);\r\npsignal(sig, "perf");\r\n}\r\nvoid perf_gtk__resize_window(GtkWidget *window)\r\n{\r\nGdkRectangle rect;\r\nGdkScreen *screen;\r\nint monitor;\r\nint height;\r\nint width;\r\nscreen = gtk_widget_get_screen(window);\r\nmonitor = gdk_screen_get_monitor_at_window(screen, window->window);\r\ngdk_screen_get_monitor_geometry(screen, monitor, &rect);\r\nwidth = rect.width * 3 / 4;\r\nheight = rect.height * 3 / 4;\r\ngtk_window_resize(GTK_WINDOW(window), width, height);\r\n}\r\nconst char *perf_gtk__get_percent_color(double percent)\r\n{\r\nif (percent >= MIN_RED)\r\nreturn "<span fgcolor='red'>";\r\nif (percent >= MIN_GREEN)\r\nreturn "<span fgcolor='dark green'>";\r\nreturn NULL;\r\n}\r\nGtkWidget *perf_gtk__setup_info_bar(void)\r\n{\r\nGtkWidget *info_bar;\r\nGtkWidget *label;\r\nGtkWidget *content_area;\r\ninfo_bar = gtk_info_bar_new();\r\ngtk_widget_set_no_show_all(info_bar, TRUE);\r\nlabel = gtk_label_new("");\r\ngtk_widget_show(label);\r\ncontent_area = gtk_info_bar_get_content_area(GTK_INFO_BAR(info_bar));\r\ngtk_container_add(GTK_CONTAINER(content_area), label);\r\ngtk_info_bar_add_button(GTK_INFO_BAR(info_bar), GTK_STOCK_OK,\r\nGTK_RESPONSE_OK);\r\ng_signal_connect(info_bar, "response",\r\nG_CALLBACK(gtk_widget_hide), NULL);\r\npgctx->info_bar = info_bar;\r\npgctx->message_label = label;\r\nreturn info_bar;\r\n}\r\nGtkWidget *perf_gtk__setup_statusbar(void)\r\n{\r\nGtkWidget *stbar;\r\nunsigned ctxid;\r\nstbar = gtk_statusbar_new();\r\nctxid = gtk_statusbar_get_context_id(GTK_STATUSBAR(stbar),\r\n"perf report");\r\npgctx->statbar = stbar;\r\npgctx->statbar_ctx_id = ctxid;\r\nreturn stbar;\r\n}
