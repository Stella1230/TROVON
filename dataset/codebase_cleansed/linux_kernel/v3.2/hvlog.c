void HvCall_writeLogBuffer(const void *buffer, u64 len)\r\n{\r\nstruct HvLpBufferList hv_buf;\r\nu64 left_this_page;\r\nu64 cur = virt_to_abs(buffer);\r\nwhile (len) {\r\nhv_buf.addr = cur;\r\nleft_this_page = ((cur & HW_PAGE_MASK) + HW_PAGE_SIZE) - cur;\r\nif (left_this_page > len)\r\nleft_this_page = len;\r\nhv_buf.len = left_this_page;\r\nlen -= left_this_page;\r\nHvCall2(HvCallBaseWriteLogBuffer,\r\nvirt_to_abs(&hv_buf),\r\nleft_this_page);\r\ncur = (cur & HW_PAGE_MASK) + HW_PAGE_SIZE;\r\n}\r\n}
