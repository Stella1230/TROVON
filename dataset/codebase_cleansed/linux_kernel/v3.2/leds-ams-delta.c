static void ams_delta_led_set(struct led_classdev *led_cdev,\r\nenum led_brightness value)\r\n{\r\nstruct ams_delta_led *led_dev =\r\ncontainer_of(led_cdev, struct ams_delta_led, cdev);\r\nif (value)\r\nams_delta_latch1_write(led_dev->bitmask, led_dev->bitmask);\r\nelse\r\nams_delta_latch1_write(led_dev->bitmask, 0);\r\n}\r\nstatic int ams_delta_led_probe(struct platform_device *pdev)\r\n{\r\nint i, ret;\r\nfor (i = 0; i < ARRAY_SIZE(ams_delta_leds); i++) {\r\nams_delta_leds[i].cdev.flags |= LED_CORE_SUSPENDRESUME;\r\nret = led_classdev_register(&pdev->dev,\r\n&ams_delta_leds[i].cdev);\r\nif (ret < 0)\r\ngoto fail;\r\n}\r\nreturn 0;\r\nfail:\r\nwhile (--i >= 0)\r\nled_classdev_unregister(&ams_delta_leds[i].cdev);\r\nreturn ret;\r\n}\r\nstatic int ams_delta_led_remove(struct platform_device *pdev)\r\n{\r\nint i;\r\nfor (i = 0; i < ARRAY_SIZE(ams_delta_leds); i++)\r\nled_classdev_unregister(&ams_delta_leds[i].cdev);\r\nreturn 0;\r\n}\r\nstatic int __init ams_delta_led_init(void)\r\n{\r\nreturn platform_driver_register(&ams_delta_led_driver);\r\n}\r\nstatic void __exit ams_delta_led_exit(void)\r\n{\r\nplatform_driver_unregister(&ams_delta_led_driver);\r\n}
