acpi_status acpi_ex_create_alias(struct acpi_walk_state *walk_state)\r\n{\r\nstruct acpi_namespace_node *target_node;\r\nstruct acpi_namespace_node *alias_node;\r\nacpi_status status = AE_OK;\r\nACPI_FUNCTION_TRACE(ex_create_alias);\r\nalias_node = (struct acpi_namespace_node *)walk_state->operands[0];\r\ntarget_node = (struct acpi_namespace_node *)walk_state->operands[1];\r\nif ((target_node->type == ACPI_TYPE_LOCAL_ALIAS) ||\r\n(target_node->type == ACPI_TYPE_LOCAL_METHOD_ALIAS)) {\r\ntarget_node =\r\nACPI_CAST_PTR(struct acpi_namespace_node,\r\ntarget_node->object);\r\n}\r\nswitch (target_node->type) {\r\ncase ACPI_TYPE_INTEGER:\r\ncase ACPI_TYPE_STRING:\r\ncase ACPI_TYPE_BUFFER:\r\ncase ACPI_TYPE_PACKAGE:\r\ncase ACPI_TYPE_BUFFER_FIELD:\r\ncase ACPI_TYPE_DEVICE:\r\ncase ACPI_TYPE_POWER:\r\ncase ACPI_TYPE_PROCESSOR:\r\ncase ACPI_TYPE_THERMAL:\r\ncase ACPI_TYPE_LOCAL_SCOPE:\r\nalias_node->type = ACPI_TYPE_LOCAL_ALIAS;\r\nalias_node->object =\r\nACPI_CAST_PTR(union acpi_operand_object, target_node);\r\nbreak;\r\ncase ACPI_TYPE_METHOD:\r\nalias_node->type = ACPI_TYPE_LOCAL_METHOD_ALIAS;\r\nalias_node->object =\r\nACPI_CAST_PTR(union acpi_operand_object, target_node);\r\nbreak;\r\ndefault:\r\nstatus = acpi_ns_attach_object(alias_node,\r\nacpi_ns_get_attached_object\r\n(target_node),\r\ntarget_node->type);\r\nbreak;\r\n}\r\nreturn_ACPI_STATUS(status);\r\n}\r\nacpi_status acpi_ex_create_event(struct acpi_walk_state *walk_state)\r\n{\r\nacpi_status status;\r\nunion acpi_operand_object *obj_desc;\r\nACPI_FUNCTION_TRACE(ex_create_event);\r\nobj_desc = acpi_ut_create_internal_object(ACPI_TYPE_EVENT);\r\nif (!obj_desc) {\r\nstatus = AE_NO_MEMORY;\r\ngoto cleanup;\r\n}\r\nstatus = acpi_os_create_semaphore(ACPI_NO_UNIT_LIMIT, 0,\r\n&obj_desc->event.os_semaphore);\r\nif (ACPI_FAILURE(status)) {\r\ngoto cleanup;\r\n}\r\nstatus =\r\nacpi_ns_attach_object((struct acpi_namespace_node *)walk_state->\r\noperands[0], obj_desc, ACPI_TYPE_EVENT);\r\ncleanup:\r\nacpi_ut_remove_reference(obj_desc);\r\nreturn_ACPI_STATUS(status);\r\n}\r\nacpi_status acpi_ex_create_mutex(struct acpi_walk_state *walk_state)\r\n{\r\nacpi_status status = AE_OK;\r\nunion acpi_operand_object *obj_desc;\r\nACPI_FUNCTION_TRACE_PTR(ex_create_mutex, ACPI_WALK_OPERANDS);\r\nobj_desc = acpi_ut_create_internal_object(ACPI_TYPE_MUTEX);\r\nif (!obj_desc) {\r\nstatus = AE_NO_MEMORY;\r\ngoto cleanup;\r\n}\r\nstatus = acpi_os_create_mutex(&obj_desc->mutex.os_mutex);\r\nif (ACPI_FAILURE(status)) {\r\ngoto cleanup;\r\n}\r\nobj_desc->mutex.sync_level =\r\n(u8) walk_state->operands[1]->integer.value;\r\nobj_desc->mutex.node =\r\n(struct acpi_namespace_node *)walk_state->operands[0];\r\nstatus =\r\nacpi_ns_attach_object(obj_desc->mutex.node, obj_desc,\r\nACPI_TYPE_MUTEX);\r\ncleanup:\r\nacpi_ut_remove_reference(obj_desc);\r\nreturn_ACPI_STATUS(status);\r\n}\r\nacpi_status\r\nacpi_ex_create_region(u8 * aml_start,\r\nu32 aml_length,\r\nu8 region_space, struct acpi_walk_state *walk_state)\r\n{\r\nacpi_status status;\r\nunion acpi_operand_object *obj_desc;\r\nstruct acpi_namespace_node *node;\r\nunion acpi_operand_object *region_obj2;\r\nACPI_FUNCTION_TRACE(ex_create_region);\r\nnode = walk_state->op->common.node;\r\nif (acpi_ns_get_attached_object(node)) {\r\nreturn_ACPI_STATUS(AE_OK);\r\n}\r\nif ((region_space >= ACPI_NUM_PREDEFINED_REGIONS) &&\r\n(region_space < ACPI_USER_REGION_BEGIN) &&\r\n(region_space != ACPI_ADR_SPACE_DATA_TABLE)) {\r\nACPI_ERROR((AE_INFO, "Invalid AddressSpace type 0x%X",\r\nregion_space));\r\nreturn_ACPI_STATUS(AE_AML_INVALID_SPACE_ID);\r\n}\r\nACPI_DEBUG_PRINT((ACPI_DB_LOAD, "Region Type - %s (0x%X)\n",\r\nacpi_ut_get_region_name(region_space), region_space));\r\nobj_desc = acpi_ut_create_internal_object(ACPI_TYPE_REGION);\r\nif (!obj_desc) {\r\nstatus = AE_NO_MEMORY;\r\ngoto cleanup;\r\n}\r\nregion_obj2 = obj_desc->common.next_object;\r\nregion_obj2->extra.aml_start = aml_start;\r\nregion_obj2->extra.aml_length = aml_length;\r\nobj_desc->region.space_id = region_space;\r\nobj_desc->region.address = 0;\r\nobj_desc->region.length = 0;\r\nobj_desc->region.node = node;\r\nstatus = acpi_ns_attach_object(node, obj_desc, ACPI_TYPE_REGION);\r\ncleanup:\r\nacpi_ut_remove_reference(obj_desc);\r\nreturn_ACPI_STATUS(status);\r\n}\r\nacpi_status acpi_ex_create_processor(struct acpi_walk_state *walk_state)\r\n{\r\nunion acpi_operand_object **operand = &walk_state->operands[0];\r\nunion acpi_operand_object *obj_desc;\r\nacpi_status status;\r\nACPI_FUNCTION_TRACE_PTR(ex_create_processor, walk_state);\r\nobj_desc = acpi_ut_create_internal_object(ACPI_TYPE_PROCESSOR);\r\nif (!obj_desc) {\r\nreturn_ACPI_STATUS(AE_NO_MEMORY);\r\n}\r\nobj_desc->processor.proc_id = (u8) operand[1]->integer.value;\r\nobj_desc->processor.length = (u8) operand[3]->integer.value;\r\nobj_desc->processor.address =\r\n(acpi_io_address) operand[2]->integer.value;\r\nstatus = acpi_ns_attach_object((struct acpi_namespace_node *)operand[0],\r\nobj_desc, ACPI_TYPE_PROCESSOR);\r\nacpi_ut_remove_reference(obj_desc);\r\nreturn_ACPI_STATUS(status);\r\n}\r\nacpi_status acpi_ex_create_power_resource(struct acpi_walk_state *walk_state)\r\n{\r\nunion acpi_operand_object **operand = &walk_state->operands[0];\r\nacpi_status status;\r\nunion acpi_operand_object *obj_desc;\r\nACPI_FUNCTION_TRACE_PTR(ex_create_power_resource, walk_state);\r\nobj_desc = acpi_ut_create_internal_object(ACPI_TYPE_POWER);\r\nif (!obj_desc) {\r\nreturn_ACPI_STATUS(AE_NO_MEMORY);\r\n}\r\nobj_desc->power_resource.system_level = (u8) operand[1]->integer.value;\r\nobj_desc->power_resource.resource_order =\r\n(u16) operand[2]->integer.value;\r\nstatus = acpi_ns_attach_object((struct acpi_namespace_node *)operand[0],\r\nobj_desc, ACPI_TYPE_POWER);\r\nacpi_ut_remove_reference(obj_desc);\r\nreturn_ACPI_STATUS(status);\r\n}\r\nacpi_status\r\nacpi_ex_create_method(u8 * aml_start,\r\nu32 aml_length, struct acpi_walk_state *walk_state)\r\n{\r\nunion acpi_operand_object **operand = &walk_state->operands[0];\r\nunion acpi_operand_object *obj_desc;\r\nacpi_status status;\r\nu8 method_flags;\r\nACPI_FUNCTION_TRACE_PTR(ex_create_method, walk_state);\r\nobj_desc = acpi_ut_create_internal_object(ACPI_TYPE_METHOD);\r\nif (!obj_desc) {\r\nstatus = AE_NO_MEMORY;\r\ngoto exit;\r\n}\r\nobj_desc->method.aml_start = aml_start;\r\nobj_desc->method.aml_length = aml_length;\r\nmethod_flags = (u8) operand[1]->integer.value;\r\nobj_desc->method.param_count =\r\n(u8) (method_flags & AML_METHOD_ARG_COUNT);\r\nif (method_flags & AML_METHOD_SERIALIZED) {\r\nobj_desc->method.info_flags = ACPI_METHOD_SERIALIZED;\r\nobj_desc->method.sync_level = (u8)\r\n((method_flags & AML_METHOD_SYNC_LEVEL) >> 4);\r\n}\r\nstatus = acpi_ns_attach_object((struct acpi_namespace_node *)operand[0],\r\nobj_desc, ACPI_TYPE_METHOD);\r\nacpi_ut_remove_reference(obj_desc);\r\nexit:\r\nacpi_ut_remove_reference(operand[1]);\r\nreturn_ACPI_STATUS(status);\r\n}
