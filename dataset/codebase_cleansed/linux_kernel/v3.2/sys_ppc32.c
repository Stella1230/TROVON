asmlinkage long ppc32_select(u32 n, compat_ulong_t __user *inp,\r\ncompat_ulong_t __user *outp, compat_ulong_t __user *exp,\r\ncompat_uptr_t tvp_x)\r\n{\r\nreturn compat_sys_select((int)n, inp, outp, exp, compat_ptr(tvp_x));\r\n}\r\nasmlinkage long compat_sys_sysfs(u32 option, u32 arg1, u32 arg2)\r\n{\r\nreturn sys_sysfs((int)option, arg1, arg2);\r\n}\r\nlong compat_sys_ipc(u32 call, u32 first, u32 second, u32 third, compat_uptr_t ptr,\r\nu32 fifth)\r\n{\r\nint version;\r\nversion = call >> 16;\r\ncall &= 0xffff;\r\nswitch (call) {\r\ncase SEMTIMEDOP:\r\nif (fifth)\r\nreturn compat_sys_semtimedop((int)first,\r\ncompat_ptr(ptr), second,\r\ncompat_ptr(fifth));\r\ncase SEMOP:\r\nreturn sys_semtimedop((int)first, compat_ptr(ptr), second,\r\nNULL);\r\ncase SEMGET:\r\nreturn sys_semget((int)first, (int)second, third);\r\ncase SEMCTL:\r\nreturn compat_sys_semctl((int)first, (int)second, third,\r\ncompat_ptr(ptr));\r\ncase MSGSND:\r\nreturn compat_sys_msgsnd((int)first, (int)second, third,\r\ncompat_ptr(ptr));\r\ncase MSGRCV:\r\nreturn compat_sys_msgrcv((int)first, second, (int)fifth,\r\nthird, version, compat_ptr(ptr));\r\ncase MSGGET:\r\nreturn sys_msgget((int)first, second);\r\ncase MSGCTL:\r\nreturn compat_sys_msgctl((int)first, second, compat_ptr(ptr));\r\ncase SHMAT:\r\nreturn compat_sys_shmat((int)first, second, third, version,\r\ncompat_ptr(ptr));\r\ncase SHMDT:\r\nreturn sys_shmdt(compat_ptr(ptr));\r\ncase SHMGET:\r\nreturn sys_shmget((int)first, second, third);\r\ncase SHMCTL:\r\nreturn compat_sys_shmctl((int)first, second, compat_ptr(ptr));\r\ndefault:\r\nreturn -ENOSYS;\r\n}\r\nreturn -ENOSYS;\r\n}\r\nasmlinkage long compat_sys_sendfile(u32 out_fd, u32 in_fd, compat_off_t __user * offset, u32 count)\r\n{\r\nmm_segment_t old_fs = get_fs();\r\nint ret;\r\noff_t of;\r\noff_t __user *up;\r\nif (offset && get_user(of, offset))\r\nreturn -EFAULT;\r\nset_fs(KERNEL_DS);\r\nup = offset ? (off_t __user *) &of : NULL;\r\nret = sys_sendfile((int)out_fd, (int)in_fd, up, count);\r\nset_fs(old_fs);\r\nif (offset && put_user(of, offset))\r\nreturn -EFAULT;\r\nreturn ret;\r\n}\r\nasmlinkage int compat_sys_sendfile64(int out_fd, int in_fd, compat_loff_t __user *offset, s32 count)\r\n{\r\nmm_segment_t old_fs = get_fs();\r\nint ret;\r\nloff_t lof;\r\nloff_t __user *up;\r\nif (offset && get_user(lof, offset))\r\nreturn -EFAULT;\r\nset_fs(KERNEL_DS);\r\nup = offset ? (loff_t __user *) &lof : NULL;\r\nret = sys_sendfile64(out_fd, in_fd, up, count);\r\nset_fs(old_fs);\r\nif (offset && put_user(lof, offset))\r\nreturn -EFAULT;\r\nreturn ret;\r\n}\r\nlong compat_sys_execve(unsigned long a0, unsigned long a1, unsigned long a2,\r\nunsigned long a3, unsigned long a4, unsigned long a5,\r\nstruct pt_regs *regs)\r\n{\r\nint error;\r\nchar * filename;\r\nfilename = getname((char __user *) a0);\r\nerror = PTR_ERR(filename);\r\nif (IS_ERR(filename))\r\ngoto out;\r\nflush_fp_to_thread(current);\r\nflush_altivec_to_thread(current);\r\nerror = compat_do_execve(filename, compat_ptr(a1), compat_ptr(a2), regs);\r\nputname(filename);\r\nout:\r\nreturn error;\r\n}\r\nasmlinkage long compat_sys_prctl(u32 option, u32 arg2, u32 arg3, u32 arg4, u32 arg5)\r\n{\r\nreturn sys_prctl((int)option,\r\n(unsigned long) arg2,\r\n(unsigned long) arg3,\r\n(unsigned long) arg4,\r\n(unsigned long) arg5);\r\n}\r\nasmlinkage long compat_sys_sched_rr_get_interval(u32 pid, struct compat_timespec __user *interval)\r\n{\r\nstruct timespec t;\r\nint ret;\r\nmm_segment_t old_fs = get_fs ();\r\nset_fs (KERNEL_DS);\r\nret = sys_sched_rr_get_interval((int)pid, (struct timespec __user *) &t);\r\nset_fs (old_fs);\r\nif (put_compat_timespec(&t, interval))\r\nreturn -EFAULT;\r\nreturn ret;\r\n}\r\nasmlinkage long compat_sys_access(const char __user * filename, u32 mode)\r\n{\r\nreturn sys_access(filename, (int)mode);\r\n}\r\nasmlinkage long compat_sys_creat(const char __user * pathname, u32 mode)\r\n{\r\nreturn sys_creat(pathname, (int)mode);\r\n}\r\nasmlinkage long compat_sys_waitpid(u32 pid, unsigned int __user * stat_addr, u32 options)\r\n{\r\nreturn sys_waitpid((int)pid, stat_addr, (int)options);\r\n}\r\nasmlinkage long compat_sys_getgroups(u32 gidsetsize, gid_t __user *grouplist)\r\n{\r\nreturn sys_getgroups((int)gidsetsize, grouplist);\r\n}\r\nasmlinkage long compat_sys_getpgid(u32 pid)\r\n{\r\nreturn sys_getpgid((int)pid);\r\n}\r\nasmlinkage long compat_sys_getsid(u32 pid)\r\n{\r\nreturn sys_getsid((int)pid);\r\n}\r\nasmlinkage long compat_sys_kill(u32 pid, u32 sig)\r\n{\r\nreturn sys_kill((int)pid, (int)sig);\r\n}\r\nasmlinkage long compat_sys_mkdir(const char __user * pathname, u32 mode)\r\n{\r\nreturn sys_mkdir(pathname, (int)mode);\r\n}\r\nlong compat_sys_nice(u32 increment)\r\n{\r\nreturn sys_nice((int)increment);\r\n}\r\noff_t ppc32_lseek(unsigned int fd, u32 offset, unsigned int origin)\r\n{\r\nreturn sys_lseek(fd, (int)offset, origin);\r\n}\r\nlong compat_sys_truncate(const char __user * path, u32 length)\r\n{\r\nreturn sys_truncate(path, (int)length);\r\n}\r\nlong compat_sys_ftruncate(int fd, u32 length)\r\n{\r\nreturn sys_ftruncate(fd, (int)length);\r\n}\r\nasmlinkage long compat_sys_readlink(const char __user * path, char __user * buf, u32 bufsiz)\r\n{\r\nreturn sys_readlink(path, buf, (int)bufsiz);\r\n}\r\nasmlinkage long compat_sys_sched_get_priority_max(u32 policy)\r\n{\r\nreturn sys_sched_get_priority_max((int)policy);\r\n}\r\nasmlinkage long compat_sys_sched_get_priority_min(u32 policy)\r\n{\r\nreturn sys_sched_get_priority_min((int)policy);\r\n}\r\nasmlinkage long compat_sys_sched_getparam(u32 pid, struct sched_param __user *param)\r\n{\r\nreturn sys_sched_getparam((int)pid, param);\r\n}\r\nasmlinkage long compat_sys_sched_getscheduler(u32 pid)\r\n{\r\nreturn sys_sched_getscheduler((int)pid);\r\n}\r\nasmlinkage long compat_sys_sched_setparam(u32 pid, struct sched_param __user *param)\r\n{\r\nreturn sys_sched_setparam((int)pid, param);\r\n}\r\nasmlinkage long compat_sys_sched_setscheduler(u32 pid, u32 policy, struct sched_param __user *param)\r\n{\r\nreturn sys_sched_setscheduler((int)pid, (int)policy, param);\r\n}\r\nasmlinkage long compat_sys_setdomainname(char __user *name, u32 len)\r\n{\r\nreturn sys_setdomainname(name, (int)len);\r\n}\r\nasmlinkage long compat_sys_setgroups(u32 gidsetsize, gid_t __user *grouplist)\r\n{\r\nreturn sys_setgroups((int)gidsetsize, grouplist);\r\n}\r\nasmlinkage long compat_sys_sethostname(char __user *name, u32 len)\r\n{\r\nreturn sys_sethostname(name, (int)len);\r\n}\r\nasmlinkage long compat_sys_setpgid(u32 pid, u32 pgid)\r\n{\r\nreturn sys_setpgid((int)pid, (int)pgid);\r\n}\r\nlong compat_sys_getpriority(u32 which, u32 who)\r\n{\r\nreturn sys_getpriority((int)which, (int)who);\r\n}\r\nlong compat_sys_setpriority(u32 which, u32 who, u32 niceval)\r\n{\r\nreturn sys_setpriority((int)which, (int)who, (int)niceval);\r\n}\r\nlong compat_sys_ioprio_get(u32 which, u32 who)\r\n{\r\nreturn sys_ioprio_get((int)which, (int)who);\r\n}\r\nlong compat_sys_ioprio_set(u32 which, u32 who, u32 ioprio)\r\n{\r\nreturn sys_ioprio_set((int)which, (int)who, (int)ioprio);\r\n}\r\nasmlinkage long compat_sys_ssetmask(u32 newmask)\r\n{\r\nreturn sys_ssetmask((int) newmask);\r\n}\r\nasmlinkage long compat_sys_syslog(u32 type, char __user * buf, u32 len)\r\n{\r\nreturn sys_syslog(type, buf, (int)len);\r\n}\r\nasmlinkage long compat_sys_umask(u32 mask)\r\n{\r\nreturn sys_umask((int)mask);\r\n}\r\nunsigned long compat_sys_mmap2(unsigned long addr, size_t len,\r\nunsigned long prot, unsigned long flags,\r\nunsigned long fd, unsigned long pgoff)\r\n{\r\nreturn sys_mmap(addr, len, prot, flags, fd, pgoff << 12);\r\n}\r\nlong compat_sys_tgkill(u32 tgid, u32 pid, int sig)\r\n{\r\nreturn sys_tgkill((int)tgid, (int)pid, sig);\r\n}\r\ncompat_ssize_t compat_sys_pread64(unsigned int fd, char __user *ubuf, compat_size_t count,\r\nu32 reg6, u32 poshi, u32 poslo)\r\n{\r\nreturn sys_pread64(fd, ubuf, count, ((loff_t)poshi << 32) | poslo);\r\n}\r\ncompat_ssize_t compat_sys_pwrite64(unsigned int fd, const char __user *ubuf, compat_size_t count,\r\nu32 reg6, u32 poshi, u32 poslo)\r\n{\r\nreturn sys_pwrite64(fd, ubuf, count, ((loff_t)poshi << 32) | poslo);\r\n}\r\ncompat_ssize_t compat_sys_readahead(int fd, u32 r4, u32 offhi, u32 offlo, u32 count)\r\n{\r\nreturn sys_readahead(fd, ((loff_t)offhi << 32) | offlo, count);\r\n}\r\nasmlinkage int compat_sys_truncate64(const char __user * path, u32 reg4,\r\nunsigned long high, unsigned long low)\r\n{\r\nreturn sys_truncate(path, (high << 32) | low);\r\n}\r\nasmlinkage long compat_sys_fallocate(int fd, int mode, u32 offhi, u32 offlo,\r\nu32 lenhi, u32 lenlo)\r\n{\r\nreturn sys_fallocate(fd, mode, ((loff_t)offhi << 32) | offlo,\r\n((loff_t)lenhi << 32) | lenlo);\r\n}\r\nasmlinkage int compat_sys_ftruncate64(unsigned int fd, u32 reg4, unsigned long high,\r\nunsigned long low)\r\n{\r\nreturn sys_ftruncate(fd, (high << 32) | low);\r\n}\r\nlong ppc32_lookup_dcookie(u32 cookie_high, u32 cookie_low, char __user *buf,\r\nsize_t len)\r\n{\r\nreturn sys_lookup_dcookie((u64)cookie_high << 32 | cookie_low,\r\nbuf, len);\r\n}\r\nlong ppc32_fadvise64(int fd, u32 unused, u32 offset_high, u32 offset_low,\r\nsize_t len, int advice)\r\n{\r\nreturn sys_fadvise64(fd, (u64)offset_high << 32 | offset_low, len,\r\nadvice);\r\n}\r\nasmlinkage long compat_sys_add_key(const char __user *_type,\r\nconst char __user *_description,\r\nconst void __user *_payload,\r\nu32 plen,\r\nu32 ringid)\r\n{\r\nreturn sys_add_key(_type, _description, _payload, plen, ringid);\r\n}\r\nasmlinkage long compat_sys_request_key(const char __user *_type,\r\nconst char __user *_description,\r\nconst char __user *_callout_info,\r\nu32 destringid)\r\n{\r\nreturn sys_request_key(_type, _description, _callout_info, destringid);\r\n}\r\nasmlinkage long compat_sys_sync_file_range2(int fd, unsigned int flags,\r\nunsigned offset_hi, unsigned offset_lo,\r\nunsigned nbytes_hi, unsigned nbytes_lo)\r\n{\r\nloff_t offset = ((loff_t)offset_hi << 32) | offset_lo;\r\nloff_t nbytes = ((loff_t)nbytes_hi << 32) | nbytes_lo;\r\nreturn sys_sync_file_range(fd, offset, nbytes, flags);\r\n}\r\nasmlinkage long compat_sys_fanotify_mark(int fanotify_fd, unsigned int flags,\r\nunsigned mask_hi, unsigned mask_lo,\r\nint dfd, const char __user *pathname)\r\n{\r\nu64 mask = ((u64)mask_hi << 32) | mask_lo;\r\nreturn sys_fanotify_mark(fanotify_fd, flags, mask, dfd, pathname);\r\n}
