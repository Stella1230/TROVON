int edac_handler_set(void)\r\n{\r\nif (edac_op_state == EDAC_OPSTATE_POLL)\r\nreturn 0;\r\nreturn atomic_read(&edac_handlers);\r\n}\r\nvoid edac_atomic_assert_error(void)\r\n{\r\nedac_err_assert++;\r\n}\r\nstruct sysdev_class *edac_get_sysfs_class(void)\r\n{\r\nint err = 0;\r\nif (atomic_read(&edac_class_valid))\r\ngoto out;\r\nerr = sysdev_class_register(&edac_class);\r\nif (err) {\r\nprintk(KERN_ERR "Error registering toplevel EDAC sysfs dir\n");\r\nreturn NULL;\r\n}\r\nout:\r\natomic_inc(&edac_class_valid);\r\nreturn &edac_class;\r\n}\r\nvoid edac_put_sysfs_class(void)\r\n{\r\nif (atomic_dec_and_test(&edac_class_valid))\r\nsysdev_class_unregister(&edac_class);\r\n}
