static int zoom_twl_gpio_setup(struct device *dev,\r\nunsigned gpio, unsigned ngpio)\r\n{\r\nint ret;\r\nmmc[0].gpio_cd = gpio + 0;\r\nomap2_hsmmc_init(mmc);\r\nret = gpio_request_one(LCD_PANEL_ENABLE_GPIO, GPIOF_OUT_INIT_LOW,\r\n"lcd enable");\r\nif (ret)\r\npr_err("Failed to get LCD_PANEL_ENABLE_GPIO (gpio%d).\n",\r\nLCD_PANEL_ENABLE_GPIO);\r\nreturn ret;\r\n}\r\nstatic void zoom2_set_hs_extmute(int mute)\r\n{\r\ngpio_set_value(ZOOM2_HEADSET_EXTMUTE_GPIO, mute);\r\n}\r\nstatic int __init omap_i2c_init(void)\r\n{\r\nomap3_pmic_get_config(&zoom_twldata,\r\nTWL_COMMON_PDATA_USB | TWL_COMMON_PDATA_BCI |\r\nTWL_COMMON_PDATA_MADC | TWL_COMMON_PDATA_AUDIO,\r\nTWL_COMMON_REGULATOR_VDAC | TWL_COMMON_REGULATOR_VPLL2);\r\nif (machine_is_omap_zoom2()) {\r\nstruct twl4030_codec_data *codec_data;\r\ncodec_data = zoom_twldata.audio->codec;\r\ncodec_data->ramp_delay_value = 3;\r\ncodec_data->hs_extmute = 1;\r\ncodec_data->set_hs_extmute = zoom2_set_hs_extmute;\r\n}\r\nomap_pmic_init(1, 2400, "twl5030", INT_34XX_SYS_NIRQ, &zoom_twldata);\r\nomap_register_i2c_bus(2, 400, NULL, 0);\r\nomap_register_i2c_bus(3, 400, NULL, 0);\r\nreturn 0;\r\n}\r\nstatic void enable_board_wakeup_source(void)\r\n{\r\nomap_mux_init_signal("sys_nirq",\r\nOMAP_WAKEUP_EN | OMAP_PIN_INPUT_PULLUP);\r\n}\r\nvoid __init zoom_peripherals_init(void)\r\n{\r\nif (wl12xx_set_platform_data(&omap_zoom_wlan_data))\r\npr_err("error setting wl12xx data\n");\r\nomap_i2c_init();\r\nplatform_device_register(&omap_vwlan_device);\r\nusb_musb_init(NULL);\r\nenable_board_wakeup_source();\r\nomap_serial_init();\r\n}
