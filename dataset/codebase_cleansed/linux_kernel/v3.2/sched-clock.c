unsigned long long notrace sched_clock(void)\r\n{\r\nif (ctr) {\r\nu32 cyc = readl(ctr);\r\nreturn cyc_to_fixed_sched_clock(&cd, cyc, (u32)~0,\r\nSC_MULT, SC_SHIFT);\r\n} else\r\nreturn 0;\r\n}\r\nstatic void notrace versatile_update_sched_clock(void)\r\n{\r\nu32 cyc = readl(ctr);\r\nupdate_sched_clock(&cd, cyc, (u32)~0);\r\n}\r\nvoid __init versatile_sched_clock_init(void __iomem *reg, unsigned long rate)\r\n{\r\nctr = reg;\r\ninit_fixed_sched_clock(&cd, versatile_update_sched_clock,\r\n32, rate, SC_MULT, SC_SHIFT);\r\n}
