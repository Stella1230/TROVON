static int aac_rkt_select_comm(struct aac_dev *dev, int comm)\r\n{\r\nint retval;\r\nretval = aac_rx_select_comm(dev, comm);\r\nif (comm == AAC_COMM_MESSAGE) {\r\nif (dev->scsi_host_ptr->can_queue > AAC_NUM_IO_FIB_RKT) {\r\ndev->init->MaxIoCommands =\r\ncpu_to_le32(AAC_NUM_IO_FIB_RKT + AAC_NUM_MGT_FIB);\r\ndev->scsi_host_ptr->can_queue = AAC_NUM_IO_FIB_RKT;\r\n}\r\n}\r\nreturn retval;\r\n}\r\nstatic int aac_rkt_ioremap(struct aac_dev * dev, u32 size)\r\n{\r\nif (!size) {\r\niounmap(dev->regs.rkt);\r\nreturn 0;\r\n}\r\ndev->base = dev->regs.rkt = ioremap(dev->scsi_host_ptr->base, size);\r\nif (dev->base == NULL)\r\nreturn -1;\r\ndev->IndexRegs = &dev->regs.rkt->IndexRegs;\r\nreturn 0;\r\n}\r\nint aac_rkt_init(struct aac_dev *dev)\r\n{\r\ndev->a_ops.adapter_ioremap = aac_rkt_ioremap;\r\ndev->a_ops.adapter_comm = aac_rkt_select_comm;\r\nreturn _aac_rx_init(dev);\r\n}
