static void qube_front_led_set(struct led_classdev *led_cdev,\r\nenum led_brightness brightness)\r\n{\r\nif (brightness)\r\nled_value = LED_FRONT_LEFT | LED_FRONT_RIGHT;\r\nelse\r\nled_value = ~(LED_FRONT_LEFT | LED_FRONT_RIGHT);\r\nwriteb(led_value, led_port);\r\n}\r\nstatic int __devinit cobalt_qube_led_probe(struct platform_device *pdev)\r\n{\r\nstruct resource *res;\r\nint retval;\r\nres = platform_get_resource(pdev, IORESOURCE_MEM, 0);\r\nif (!res)\r\nreturn -EBUSY;\r\nled_port = ioremap(res->start, resource_size(res));\r\nif (!led_port)\r\nreturn -ENOMEM;\r\nled_value = LED_FRONT_LEFT | LED_FRONT_RIGHT;\r\nwriteb(led_value, led_port);\r\nretval = led_classdev_register(&pdev->dev, &qube_front_led);\r\nif (retval)\r\ngoto err_iounmap;\r\nreturn 0;\r\nerr_iounmap:\r\niounmap(led_port);\r\nled_port = NULL;\r\nreturn retval;\r\n}\r\nstatic int __devexit cobalt_qube_led_remove(struct platform_device *pdev)\r\n{\r\nled_classdev_unregister(&qube_front_led);\r\nif (led_port) {\r\niounmap(led_port);\r\nled_port = NULL;\r\n}\r\nreturn 0;\r\n}\r\nstatic int __init cobalt_qube_led_init(void)\r\n{\r\nreturn platform_driver_register(&cobalt_qube_led_driver);\r\n}\r\nstatic void __exit cobalt_qube_led_exit(void)\r\n{\r\nplatform_driver_unregister(&cobalt_qube_led_driver);\r\n}
