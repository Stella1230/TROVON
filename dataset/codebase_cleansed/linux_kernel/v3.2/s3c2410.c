static int s3c2410_serial_setsource(struct uart_port *port,\r\nstruct s3c24xx_uart_clksrc *clk)\r\n{\r\nunsigned long ucon = rd_regl(port, S3C2410_UCON);\r\nif (strcmp(clk->name, "uclk") == 0)\r\nucon |= S3C2410_UCON_UCLK;\r\nelse\r\nucon &= ~S3C2410_UCON_UCLK;\r\nwr_regl(port, S3C2410_UCON, ucon);\r\nreturn 0;\r\n}\r\nstatic int s3c2410_serial_getsource(struct uart_port *port,\r\nstruct s3c24xx_uart_clksrc *clk)\r\n{\r\nunsigned long ucon = rd_regl(port, S3C2410_UCON);\r\nclk->divisor = 1;\r\nclk->name = (ucon & S3C2410_UCON_UCLK) ? "uclk" : "pclk";\r\nreturn 0;\r\n}\r\nstatic int s3c2410_serial_resetport(struct uart_port *port,\r\nstruct s3c2410_uartcfg *cfg)\r\n{\r\ndbg("s3c2410_serial_resetport: port=%p (%08lx), cfg=%p\n",\r\nport, port->mapbase, cfg);\r\nwr_regl(port, S3C2410_UCON, cfg->ucon);\r\nwr_regl(port, S3C2410_ULCON, cfg->ulcon);\r\nwr_regl(port, S3C2410_UFCON, cfg->ufcon | S3C2410_UFCON_RESETBOTH);\r\nwr_regl(port, S3C2410_UFCON, cfg->ufcon);\r\nreturn 0;\r\n}\r\nstatic int s3c2410_serial_probe(struct platform_device *dev)\r\n{\r\nreturn s3c24xx_serial_probe(dev, &s3c2410_uart_inf);\r\n}\r\nstatic int __init s3c2410_serial_init(void)\r\n{\r\nreturn s3c24xx_serial_init(&s3c2410_serial_driver, &s3c2410_uart_inf);\r\n}\r\nstatic void __exit s3c2410_serial_exit(void)\r\n{\r\nplatform_driver_unregister(&s3c2410_serial_driver);\r\n}
