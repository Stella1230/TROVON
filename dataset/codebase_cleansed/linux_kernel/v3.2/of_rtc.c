void __init of_instantiate_rtc(void)\r\n{\r\nstruct device_node *node;\r\nint err;\r\nint i;\r\nfor (i = 0; i < ARRAY_SIZE(of_rtc_table); i++) {\r\nchar *plat_name = of_rtc_table[i].plat_name;\r\nfor_each_compatible_node(node, NULL,\r\nof_rtc_table[i].compatible) {\r\nstruct resource *res;\r\nres = kmalloc(sizeof(*res), GFP_KERNEL);\r\nif (!res) {\r\nprintk(KERN_ERR "OF RTC: Out of memory "\r\n"allocating resource structure for %s\n",\r\nnode->full_name);\r\ncontinue;\r\n}\r\nerr = of_address_to_resource(node, 0, res);\r\nif (err) {\r\nprintk(KERN_ERR "OF RTC: Error "\r\n"translating resources for %s\n",\r\nnode->full_name);\r\ncontinue;\r\n}\r\nprintk(KERN_INFO "OF_RTC: %s is a %s @ 0x%llx-0x%llx\n",\r\nnode->full_name, plat_name,\r\n(unsigned long long)res->start,\r\n(unsigned long long)res->end);\r\nplatform_device_register_simple(plat_name, -1, res, 1);\r\n}\r\n}\r\n}
