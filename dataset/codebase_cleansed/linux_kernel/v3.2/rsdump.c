static void\r\nacpi_rs_dump_descriptor(void *resource, struct acpi_rsdump_info *table)\r\n{\r\nu8 *target = NULL;\r\nu8 *previous_target;\r\nchar *name;\r\nu8 count;\r\ncount = table->offset;\r\nwhile (count) {\r\nprevious_target = target;\r\ntarget = ACPI_ADD_PTR(u8, resource, table->offset);\r\nname = table->name;\r\nswitch (table->opcode) {\r\ncase ACPI_RSD_TITLE:\r\nif (table->name) {\r\nacpi_os_printf("%s Resource\n", name);\r\n}\r\nbreak;\r\ncase ACPI_RSD_LITERAL:\r\nacpi_rs_out_string(name,\r\nACPI_CAST_PTR(char, table->pointer));\r\nbreak;\r\ncase ACPI_RSD_STRING:\r\nacpi_rs_out_string(name, ACPI_CAST_PTR(char, target));\r\nbreak;\r\ncase ACPI_RSD_UINT8:\r\nacpi_rs_out_integer8(name, ACPI_GET8(target));\r\nbreak;\r\ncase ACPI_RSD_UINT16:\r\nacpi_rs_out_integer16(name, ACPI_GET16(target));\r\nbreak;\r\ncase ACPI_RSD_UINT32:\r\nacpi_rs_out_integer32(name, ACPI_GET32(target));\r\nbreak;\r\ncase ACPI_RSD_UINT64:\r\nacpi_rs_out_integer64(name, ACPI_GET64(target));\r\nbreak;\r\ncase ACPI_RSD_1BITFLAG:\r\nacpi_rs_out_string(name, ACPI_CAST_PTR(char,\r\ntable->\r\npointer[*target &\r\n0x01]));\r\nbreak;\r\ncase ACPI_RSD_2BITFLAG:\r\nacpi_rs_out_string(name, ACPI_CAST_PTR(char,\r\ntable->\r\npointer[*target &\r\n0x03]));\r\nbreak;\r\ncase ACPI_RSD_SHORTLIST:\r\nif (previous_target) {\r\nacpi_rs_out_title(name);\r\nacpi_rs_dump_short_byte_list(*previous_target,\r\ntarget);\r\n}\r\nbreak;\r\ncase ACPI_RSD_LONGLIST:\r\nif (previous_target) {\r\nacpi_rs_dump_byte_list(ACPI_GET16\r\n(previous_target),\r\ntarget);\r\n}\r\nbreak;\r\ncase ACPI_RSD_DWORDLIST:\r\nif (previous_target) {\r\nacpi_rs_dump_dword_list(*previous_target,\r\nACPI_CAST_PTR(u32,\r\ntarget));\r\n}\r\nbreak;\r\ncase ACPI_RSD_ADDRESS:\r\nacpi_rs_dump_address_common(ACPI_CAST_PTR\r\n(union acpi_resource_data,\r\ntarget));\r\nbreak;\r\ncase ACPI_RSD_SOURCE:\r\nacpi_rs_dump_resource_source(ACPI_CAST_PTR(struct\r\nacpi_resource_source,\r\ntarget));\r\nbreak;\r\ndefault:\r\nacpi_os_printf("**** Invalid table opcode [%X] ****\n",\r\ntable->opcode);\r\nreturn;\r\n}\r\ntable++;\r\ncount--;\r\n}\r\n}\r\nstatic void\r\nacpi_rs_dump_resource_source(struct acpi_resource_source *resource_source)\r\n{\r\nACPI_FUNCTION_ENTRY();\r\nif (resource_source->index == 0xFF) {\r\nreturn;\r\n}\r\nacpi_rs_out_integer8("Resource Source Index", resource_source->index);\r\nacpi_rs_out_string("Resource Source",\r\nresource_source->string_ptr ?\r\nresource_source->string_ptr : "[Not Specified]");\r\n}\r\nstatic void acpi_rs_dump_address_common(union acpi_resource_data *resource)\r\n{\r\nACPI_FUNCTION_ENTRY();\r\nswitch (resource->address.resource_type) {\r\ncase ACPI_MEMORY_RANGE:\r\nacpi_rs_dump_descriptor(resource, acpi_rs_dump_memory_flags);\r\nbreak;\r\ncase ACPI_IO_RANGE:\r\nacpi_rs_dump_descriptor(resource, acpi_rs_dump_io_flags);\r\nbreak;\r\ncase ACPI_BUS_NUMBER_RANGE:\r\nacpi_rs_out_string("Resource Type", "Bus Number Range");\r\nbreak;\r\ndefault:\r\nacpi_rs_out_integer8("Resource Type",\r\n(u8) resource->address.resource_type);\r\nbreak;\r\n}\r\nacpi_rs_dump_descriptor(resource, acpi_rs_dump_general_flags);\r\n}\r\nvoid acpi_rs_dump_resource_list(struct acpi_resource *resource_list)\r\n{\r\nu32 count = 0;\r\nu32 type;\r\nACPI_FUNCTION_ENTRY();\r\nif (!(acpi_dbg_level & ACPI_LV_RESOURCES)\r\n|| !(_COMPONENT & acpi_dbg_layer)) {\r\nreturn;\r\n}\r\ndo {\r\nacpi_os_printf("\n[%02X] ", count);\r\ncount++;\r\ntype = resource_list->type;\r\nif (type > ACPI_RESOURCE_TYPE_MAX) {\r\nacpi_os_printf\r\n("Invalid descriptor type (%X) in resource list\n",\r\nresource_list->type);\r\nreturn;\r\n}\r\nacpi_rs_dump_descriptor(&resource_list->data,\r\nacpi_gbl_dump_resource_dispatch[type]);\r\nresource_list =\r\nACPI_ADD_PTR(struct acpi_resource, resource_list,\r\nresource_list->length);\r\n} while (type != ACPI_RESOURCE_TYPE_END_TAG);\r\n}\r\nvoid acpi_rs_dump_irq_list(u8 * route_table)\r\n{\r\nstruct acpi_pci_routing_table *prt_element;\r\nu8 count;\r\nACPI_FUNCTION_ENTRY();\r\nif (!(acpi_dbg_level & ACPI_LV_RESOURCES)\r\n|| !(_COMPONENT & acpi_dbg_layer)) {\r\nreturn;\r\n}\r\nprt_element = ACPI_CAST_PTR(struct acpi_pci_routing_table, route_table);\r\nfor (count = 0; prt_element->length; count++) {\r\nacpi_os_printf("\n[%02X] PCI IRQ Routing Table Package\n",\r\ncount);\r\nacpi_rs_dump_descriptor(prt_element, acpi_rs_dump_prt);\r\nprt_element = ACPI_ADD_PTR(struct acpi_pci_routing_table,\r\nprt_element, prt_element->length);\r\n}\r\n}\r\nstatic void acpi_rs_out_string(char *title, char *value)\r\n{\r\nacpi_os_printf("%27s : %s", title, value);\r\nif (!*value) {\r\nacpi_os_printf("[NULL NAMESTRING]");\r\n}\r\nacpi_os_printf("\n");\r\n}\r\nstatic void acpi_rs_out_integer8(char *title, u8 value)\r\n{\r\nacpi_os_printf("%27s : %2.2X\n", title, value);\r\n}\r\nstatic void acpi_rs_out_integer16(char *title, u16 value)\r\n{\r\nacpi_os_printf("%27s : %4.4X\n", title, value);\r\n}\r\nstatic void acpi_rs_out_integer32(char *title, u32 value)\r\n{\r\nacpi_os_printf("%27s : %8.8X\n", title, value);\r\n}\r\nstatic void acpi_rs_out_integer64(char *title, u64 value)\r\n{\r\nacpi_os_printf("%27s : %8.8X%8.8X\n", title, ACPI_FORMAT_UINT64(value));\r\n}\r\nstatic void acpi_rs_out_title(char *title)\r\n{\r\nacpi_os_printf("%27s : ", title);\r\n}\r\nstatic void acpi_rs_dump_byte_list(u16 length, u8 * data)\r\n{\r\nu8 i;\r\nfor (i = 0; i < length; i++) {\r\nacpi_os_printf("%25s%2.2X : %2.2X\n", "Byte", i, data[i]);\r\n}\r\n}\r\nstatic void acpi_rs_dump_short_byte_list(u8 length, u8 * data)\r\n{\r\nu8 i;\r\nfor (i = 0; i < length; i++) {\r\nacpi_os_printf("%X ", data[i]);\r\n}\r\nacpi_os_printf("\n");\r\n}\r\nstatic void acpi_rs_dump_dword_list(u8 length, u32 * data)\r\n{\r\nu8 i;\r\nfor (i = 0; i < length; i++) {\r\nacpi_os_printf("%25s%2.2X : %8.8X\n", "Dword", i, data[i]);\r\n}\r\n}
