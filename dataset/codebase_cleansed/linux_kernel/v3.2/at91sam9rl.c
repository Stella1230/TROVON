static void __init at91sam9rl_register_clocks(void)\r\n{\r\nint i;\r\nfor (i = 0; i < ARRAY_SIZE(periph_clocks); i++)\r\nclk_register(periph_clocks[i]);\r\nclkdev_add_table(periph_clocks_lookups,\r\nARRAY_SIZE(periph_clocks_lookups));\r\nclkdev_add_table(usart_clocks_lookups,\r\nARRAY_SIZE(usart_clocks_lookups));\r\nclk_register(&pck0);\r\nclk_register(&pck1);\r\n}\r\nvoid __init at91sam9rl_set_console_clock(int id)\r\n{\r\nif (id >= ARRAY_SIZE(usart_clocks_lookups))\r\nreturn;\r\nconsole_clock_lookup.con_id = "usart";\r\nconsole_clock_lookup.clk = usart_clocks_lookups[id].clk;\r\nclkdev_add(&console_clock_lookup);\r\n}\r\nstatic void at91sam9rl_poweroff(void)\r\n{\r\nat91_sys_write(AT91_SHDW_CR, AT91_SHDW_KEY | AT91_SHDW_SHDW);\r\n}\r\nstatic void __init at91sam9rl_map_io(void)\r\n{\r\nunsigned long sram_size;\r\nswitch (at91_soc_initdata.cidr & AT91_CIDR_SRAMSIZ) {\r\ncase AT91_CIDR_SRAMSIZ_32K:\r\nsram_size = 2 * SZ_16K;\r\nbreak;\r\ncase AT91_CIDR_SRAMSIZ_16K:\r\ndefault:\r\nsram_size = SZ_16K;\r\n}\r\nat91_init_sram(0, AT91SAM9RL_SRAM_BASE, sram_size);\r\n}\r\nstatic void __init at91sam9rl_initialize(void)\r\n{\r\nat91_arch_reset = at91sam9_alt_reset;\r\npm_power_off = at91sam9rl_poweroff;\r\nat91_extern_irq = (1 << AT91SAM9RL_ID_IRQ0);\r\nat91_gpio_init(at91sam9rl_gpio, 4);\r\n}
