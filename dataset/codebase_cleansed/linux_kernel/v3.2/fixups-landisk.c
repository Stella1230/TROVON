int pcibios_map_platform_irq(const struct pci_dev *pdev, u8 slot, u8 pin)\r\n{\r\nint irq = ((slot + pin - 1) & 0x3) + 5;\r\nif ((slot | (pin - 1)) > 0x3) {\r\nprintk(KERN_WARNING "PCI: Bad IRQ mapping request for slot %d pin %c\n",\r\nslot, pin - 1 + 'A');\r\nreturn -1;\r\n}\r\nreturn irq;\r\n}\r\nint pci_fixup_pcic(struct pci_channel *chan)\r\n{\r\nunsigned long bcr1, mcr;\r\nbcr1 = __raw_readl(SH7751_BCR1);\r\nbcr1 |= 0x40080000;\r\npci_write_reg(chan, bcr1, SH4_PCIBCR1);\r\nmcr = __raw_readl(SH7751_MCR);\r\nmcr = (mcr & PCIMCR_MRSET_OFF) & PCIMCR_RFSH_OFF;\r\npci_write_reg(chan, mcr, SH4_PCIMCR);\r\npci_write_reg(chan, 0x0c000000, SH7751_PCICONF5);\r\npci_write_reg(chan, 0xd0000000, SH7751_PCICONF6);\r\npci_write_reg(chan, 0x0c000000, SH4_PCILAR0);\r\npci_write_reg(chan, 0x00000000, SH4_PCILAR1);\r\nreturn 0;\r\n}
