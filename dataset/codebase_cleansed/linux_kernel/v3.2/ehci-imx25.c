int mx25_initialize_usb_hw(int port, unsigned int flags)\r\n{\r\nunsigned int v;\r\nv = readl(MX25_IO_ADDRESS(MX25_USB_BASE_ADDR + USBCTRL_OTGBASE_OFFSET));\r\nswitch (port) {\r\ncase 0:\r\nv &= ~(MX25_OTG_SIC_MASK | MX25_OTG_PM_BIT);\r\nv |= (flags & MXC_EHCI_INTERFACE_MASK) << MX25_OTG_SIC_SHIFT;\r\nif (!(flags & MXC_EHCI_POWER_PINS_ENABLED))\r\nv |= MX25_OTG_PM_BIT;\r\nbreak;\r\ncase 1:\r\nv &= ~(MX25_H1_SIC_MASK | MX25_H1_PM_BIT | MX25_H1_TLL_BIT |\r\nMX25_H1_USBTE_BIT | MX25_H1_IPPUE_DOWN_BIT | MX25_H1_IPPUE_UP_BIT);\r\nv |= (flags & MXC_EHCI_INTERFACE_MASK) << MX25_H1_SIC_SHIFT;\r\nif (!(flags & MXC_EHCI_POWER_PINS_ENABLED))\r\nv |= MX25_H1_PM_BIT;\r\nif (!(flags & MXC_EHCI_TTL_ENABLED))\r\nv |= MX25_H1_TLL_BIT;\r\nif (flags & MXC_EHCI_INTERNAL_PHY)\r\nv |= MX25_H1_USBTE_BIT;\r\nif (flags & MXC_EHCI_IPPUE_DOWN)\r\nv |= MX25_H1_IPPUE_DOWN_BIT;\r\nif (flags & MXC_EHCI_IPPUE_UP)\r\nv |= MX25_H1_IPPUE_UP_BIT;\r\nbreak;\r\ndefault:\r\nreturn -EINVAL;\r\n}\r\nwritel(v, MX25_IO_ADDRESS(MX25_USB_BASE_ADDR + USBCTRL_OTGBASE_OFFSET));\r\nreturn 0;\r\n}
