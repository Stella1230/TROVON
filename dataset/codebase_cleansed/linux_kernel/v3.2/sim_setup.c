const char *get_system_type(void)\r\n{\r\nreturn "MIPSsim";\r\n}\r\nvoid __init plat_mem_setup(void)\r\n{\r\nset_io_port_base(0xbfd00000);\r\nserial_init();\r\n}\r\nvoid __init prom_init(void)\r\n{\r\nset_io_port_base(0xbfd00000);\r\nprom_meminit();\r\nif (cpu_has_mipsmt) {\r\nif (!register_vsmp_smp_ops())\r\nreturn;\r\n#ifdef CONFIG_MIPS_MT_SMTC\r\nregister_smp_ops(&ssmtc_smp_ops);\r\nreturn;\r\n#endif\r\n}\r\nregister_up_smp_ops();\r\n}\r\nstatic void __init serial_init(void)\r\n{\r\n#ifdef CONFIG_SERIAL_8250\r\nstruct uart_port s;\r\nmemset(&s, 0, sizeof(s));\r\ns.iobase = 0x3f8;\r\ns.irq = 0;\r\ns.uartclk = 1843200;\r\ns.flags = UPF_BOOT_AUTOCONF | UPF_SKIP_TEST;\r\ns.iotype = UPIO_PORT;\r\ns.regshift = 0;\r\ns.timeout = 4;\r\nif (early_serial_setup(&s) != 0) {\r\nprintk(KERN_ERR "Serial setup failed!\n");\r\n}\r\n#endif\r\n}
