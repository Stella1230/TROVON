static bool da9055_register_readable(struct device *dev, unsigned int reg)\r\n{\r\nswitch (reg) {\r\ncase DA9055_REG_STATUS_A:\r\ncase DA9055_REG_STATUS_B:\r\ncase DA9055_REG_EVENT_A:\r\ncase DA9055_REG_EVENT_B:\r\ncase DA9055_REG_EVENT_C:\r\ncase DA9055_REG_IRQ_MASK_A:\r\ncase DA9055_REG_IRQ_MASK_B:\r\ncase DA9055_REG_IRQ_MASK_C:\r\ncase DA9055_REG_CONTROL_A:\r\ncase DA9055_REG_CONTROL_B:\r\ncase DA9055_REG_CONTROL_C:\r\ncase DA9055_REG_CONTROL_D:\r\ncase DA9055_REG_CONTROL_E:\r\ncase DA9055_REG_ADC_MAN:\r\ncase DA9055_REG_ADC_CONT:\r\ncase DA9055_REG_VSYS_MON:\r\ncase DA9055_REG_ADC_RES_L:\r\ncase DA9055_REG_ADC_RES_H:\r\ncase DA9055_REG_VSYS_RES:\r\ncase DA9055_REG_ADCIN1_RES:\r\ncase DA9055_REG_ADCIN2_RES:\r\ncase DA9055_REG_ADCIN3_RES:\r\ncase DA9055_REG_COUNT_S:\r\ncase DA9055_REG_COUNT_MI:\r\ncase DA9055_REG_COUNT_H:\r\ncase DA9055_REG_COUNT_D:\r\ncase DA9055_REG_COUNT_MO:\r\ncase DA9055_REG_COUNT_Y:\r\ncase DA9055_REG_ALARM_H:\r\ncase DA9055_REG_ALARM_D:\r\ncase DA9055_REG_ALARM_MI:\r\ncase DA9055_REG_ALARM_MO:\r\ncase DA9055_REG_ALARM_Y:\r\ncase DA9055_REG_GPIO0_1:\r\ncase DA9055_REG_GPIO2:\r\ncase DA9055_REG_GPIO_MODE0_2:\r\ncase DA9055_REG_BCORE_CONT:\r\ncase DA9055_REG_BMEM_CONT:\r\ncase DA9055_REG_LDO1_CONT:\r\ncase DA9055_REG_LDO2_CONT:\r\ncase DA9055_REG_LDO3_CONT:\r\ncase DA9055_REG_LDO4_CONT:\r\ncase DA9055_REG_LDO5_CONT:\r\ncase DA9055_REG_LDO6_CONT:\r\ncase DA9055_REG_BUCK_LIM:\r\ncase DA9055_REG_BCORE_MODE:\r\ncase DA9055_REG_VBCORE_A:\r\ncase DA9055_REG_VBMEM_A:\r\ncase DA9055_REG_VLDO1_A:\r\ncase DA9055_REG_VLDO2_A:\r\ncase DA9055_REG_VLDO3_A:\r\ncase DA9055_REG_VLDO4_A:\r\ncase DA9055_REG_VLDO5_A:\r\ncase DA9055_REG_VLDO6_A:\r\ncase DA9055_REG_VBCORE_B:\r\ncase DA9055_REG_VBMEM_B:\r\ncase DA9055_REG_VLDO1_B:\r\ncase DA9055_REG_VLDO2_B:\r\ncase DA9055_REG_VLDO3_B:\r\ncase DA9055_REG_VLDO4_B:\r\ncase DA9055_REG_VLDO5_B:\r\ncase DA9055_REG_VLDO6_B:\r\nreturn true;\r\ndefault:\r\nreturn false;\r\n}\r\n}\r\nstatic bool da9055_register_writeable(struct device *dev, unsigned int reg)\r\n{\r\nswitch (reg) {\r\ncase DA9055_REG_STATUS_A:\r\ncase DA9055_REG_STATUS_B:\r\ncase DA9055_REG_EVENT_A:\r\ncase DA9055_REG_EVENT_B:\r\ncase DA9055_REG_EVENT_C:\r\ncase DA9055_REG_IRQ_MASK_A:\r\ncase DA9055_REG_IRQ_MASK_B:\r\ncase DA9055_REG_IRQ_MASK_C:\r\ncase DA9055_REG_CONTROL_A:\r\ncase DA9055_REG_CONTROL_B:\r\ncase DA9055_REG_CONTROL_C:\r\ncase DA9055_REG_CONTROL_D:\r\ncase DA9055_REG_CONTROL_E:\r\ncase DA9055_REG_ADC_MAN:\r\ncase DA9055_REG_ADC_CONT:\r\ncase DA9055_REG_VSYS_MON:\r\ncase DA9055_REG_ADC_RES_L:\r\ncase DA9055_REG_ADC_RES_H:\r\ncase DA9055_REG_VSYS_RES:\r\ncase DA9055_REG_ADCIN1_RES:\r\ncase DA9055_REG_ADCIN2_RES:\r\ncase DA9055_REG_ADCIN3_RES:\r\ncase DA9055_REG_COUNT_S:\r\ncase DA9055_REG_COUNT_MI:\r\ncase DA9055_REG_COUNT_H:\r\ncase DA9055_REG_COUNT_D:\r\ncase DA9055_REG_COUNT_MO:\r\ncase DA9055_REG_COUNT_Y:\r\ncase DA9055_REG_ALARM_H:\r\ncase DA9055_REG_ALARM_D:\r\ncase DA9055_REG_ALARM_MI:\r\ncase DA9055_REG_ALARM_MO:\r\ncase DA9055_REG_ALARM_Y:\r\ncase DA9055_REG_GPIO0_1:\r\ncase DA9055_REG_GPIO2:\r\ncase DA9055_REG_GPIO_MODE0_2:\r\ncase DA9055_REG_BCORE_CONT:\r\ncase DA9055_REG_BMEM_CONT:\r\ncase DA9055_REG_LDO1_CONT:\r\ncase DA9055_REG_LDO2_CONT:\r\ncase DA9055_REG_LDO3_CONT:\r\ncase DA9055_REG_LDO4_CONT:\r\ncase DA9055_REG_LDO5_CONT:\r\ncase DA9055_REG_LDO6_CONT:\r\ncase DA9055_REG_BUCK_LIM:\r\ncase DA9055_REG_BCORE_MODE:\r\ncase DA9055_REG_VBCORE_A:\r\ncase DA9055_REG_VBMEM_A:\r\ncase DA9055_REG_VLDO1_A:\r\ncase DA9055_REG_VLDO2_A:\r\ncase DA9055_REG_VLDO3_A:\r\ncase DA9055_REG_VLDO4_A:\r\ncase DA9055_REG_VLDO5_A:\r\ncase DA9055_REG_VLDO6_A:\r\ncase DA9055_REG_VBCORE_B:\r\ncase DA9055_REG_VBMEM_B:\r\ncase DA9055_REG_VLDO1_B:\r\ncase DA9055_REG_VLDO2_B:\r\ncase DA9055_REG_VLDO3_B:\r\ncase DA9055_REG_VLDO4_B:\r\ncase DA9055_REG_VLDO5_B:\r\ncase DA9055_REG_VLDO6_B:\r\nreturn true;\r\ndefault:\r\nreturn false;\r\n}\r\n}\r\nstatic bool da9055_register_volatile(struct device *dev, unsigned int reg)\r\n{\r\nswitch (reg) {\r\ncase DA9055_REG_STATUS_A:\r\ncase DA9055_REG_STATUS_B:\r\ncase DA9055_REG_EVENT_A:\r\ncase DA9055_REG_EVENT_B:\r\ncase DA9055_REG_EVENT_C:\r\ncase DA9055_REG_CONTROL_A:\r\ncase DA9055_REG_CONTROL_E:\r\ncase DA9055_REG_ADC_MAN:\r\ncase DA9055_REG_ADC_RES_L:\r\ncase DA9055_REG_ADC_RES_H:\r\ncase DA9055_REG_VSYS_RES:\r\ncase DA9055_REG_ADCIN1_RES:\r\ncase DA9055_REG_ADCIN2_RES:\r\ncase DA9055_REG_ADCIN3_RES:\r\ncase DA9055_REG_COUNT_S:\r\ncase DA9055_REG_COUNT_MI:\r\ncase DA9055_REG_COUNT_H:\r\ncase DA9055_REG_COUNT_D:\r\ncase DA9055_REG_COUNT_MO:\r\ncase DA9055_REG_COUNT_Y:\r\ncase DA9055_REG_ALARM_MI:\r\ncase DA9055_REG_BCORE_CONT:\r\ncase DA9055_REG_BMEM_CONT:\r\ncase DA9055_REG_LDO1_CONT:\r\ncase DA9055_REG_LDO2_CONT:\r\ncase DA9055_REG_LDO3_CONT:\r\ncase DA9055_REG_LDO4_CONT:\r\ncase DA9055_REG_LDO5_CONT:\r\ncase DA9055_REG_LDO6_CONT:\r\nreturn true;\r\ndefault:\r\nreturn false;\r\n}\r\n}\r\nint da9055_device_init(struct da9055 *da9055)\r\n{\r\nstruct da9055_pdata *pdata = da9055->dev->platform_data;\r\nint ret;\r\nif (pdata && pdata->init != NULL)\r\npdata->init(da9055);\r\nif (!pdata || !pdata->irq_base)\r\nda9055->irq_base = -1;\r\nelse\r\nda9055->irq_base = pdata->irq_base;\r\nret = regmap_add_irq_chip(da9055->regmap, da9055->chip_irq,\r\nIRQF_TRIGGER_HIGH | IRQF_ONESHOT,\r\nda9055->irq_base, &da9055_regmap_irq_chip,\r\n&da9055->irq_data);\r\nif (ret < 0)\r\nreturn ret;\r\nda9055->irq_base = regmap_irq_chip_get_base(da9055->irq_data);\r\nret = mfd_add_devices(da9055->dev, -1,\r\nda9055_devs, ARRAY_SIZE(da9055_devs),\r\nNULL, da9055->irq_base, NULL);\r\nif (ret)\r\ngoto err;\r\nreturn 0;\r\nerr:\r\nmfd_remove_devices(da9055->dev);\r\nreturn ret;\r\n}\r\nvoid da9055_device_exit(struct da9055 *da9055)\r\n{\r\nregmap_del_irq_chip(da9055->chip_irq, da9055->irq_data);\r\nmfd_remove_devices(da9055->dev);\r\n}
