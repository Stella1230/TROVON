static inline void assert_sizes(void)\r\n{\r\nBUILD_BUG_ON(B43_TAB_ROTOR_SIZE != ARRAY_SIZE(b43_tab_rotor));\r\nBUILD_BUG_ON(B43_TAB_RETARD_SIZE != ARRAY_SIZE(b43_tab_retard));\r\nBUILD_BUG_ON(B43_TAB_FINEFREQA_SIZE != ARRAY_SIZE(b43_tab_finefreqa));\r\nBUILD_BUG_ON(B43_TAB_FINEFREQG_SIZE != ARRAY_SIZE(b43_tab_finefreqg));\r\nBUILD_BUG_ON(B43_TAB_NOISEA2_SIZE != ARRAY_SIZE(b43_tab_noisea2));\r\nBUILD_BUG_ON(B43_TAB_NOISEA3_SIZE != ARRAY_SIZE(b43_tab_noisea3));\r\nBUILD_BUG_ON(B43_TAB_NOISEG1_SIZE != ARRAY_SIZE(b43_tab_noiseg1));\r\nBUILD_BUG_ON(B43_TAB_NOISEG2_SIZE != ARRAY_SIZE(b43_tab_noiseg2));\r\nBUILD_BUG_ON(B43_TAB_NOISESCALE_SIZE !=\r\nARRAY_SIZE(b43_tab_noisescalea2));\r\nBUILD_BUG_ON(B43_TAB_NOISESCALE_SIZE !=\r\nARRAY_SIZE(b43_tab_noisescalea3));\r\nBUILD_BUG_ON(B43_TAB_NOISESCALE_SIZE !=\r\nARRAY_SIZE(b43_tab_noisescaleg1));\r\nBUILD_BUG_ON(B43_TAB_NOISESCALE_SIZE !=\r\nARRAY_SIZE(b43_tab_noisescaleg2));\r\nBUILD_BUG_ON(B43_TAB_NOISESCALE_SIZE !=\r\nARRAY_SIZE(b43_tab_noisescaleg3));\r\nBUILD_BUG_ON(B43_TAB_SIGMASQR_SIZE != ARRAY_SIZE(b43_tab_sigmasqr1));\r\nBUILD_BUG_ON(B43_TAB_SIGMASQR_SIZE != ARRAY_SIZE(b43_tab_sigmasqr2));\r\nBUILD_BUG_ON(B43_TAB_RSSIAGC1_SIZE != ARRAY_SIZE(b43_tab_rssiagc1));\r\nBUILD_BUG_ON(B43_TAB_RSSIAGC2_SIZE != ARRAY_SIZE(b43_tab_rssiagc2));\r\n}\r\nu16 b43_ofdmtab_read16(struct b43_wldev *dev, u16 table, u16 offset)\r\n{\r\nstruct b43_phy_g *gphy = dev->phy.g;\r\nu16 addr;\r\naddr = table + offset;\r\nif ((gphy->ofdmtab_addr_direction != B43_OFDMTAB_DIRECTION_READ) ||\r\n(addr - 1 != gphy->ofdmtab_addr)) {\r\nb43_phy_write(dev, B43_PHY_OTABLECTL, addr);\r\ngphy->ofdmtab_addr_direction = B43_OFDMTAB_DIRECTION_READ;\r\n}\r\ngphy->ofdmtab_addr = addr;\r\nreturn b43_phy_read(dev, B43_PHY_OTABLEI);\r\nassert_sizes();\r\n}\r\nvoid b43_ofdmtab_write16(struct b43_wldev *dev, u16 table,\r\nu16 offset, u16 value)\r\n{\r\nstruct b43_phy_g *gphy = dev->phy.g;\r\nu16 addr;\r\naddr = table + offset;\r\nif ((gphy->ofdmtab_addr_direction != B43_OFDMTAB_DIRECTION_WRITE) ||\r\n(addr - 1 != gphy->ofdmtab_addr)) {\r\nb43_phy_write(dev, B43_PHY_OTABLECTL, addr);\r\ngphy->ofdmtab_addr_direction = B43_OFDMTAB_DIRECTION_WRITE;\r\n}\r\ngphy->ofdmtab_addr = addr;\r\nb43_phy_write(dev, B43_PHY_OTABLEI, value);\r\n}\r\nu32 b43_ofdmtab_read32(struct b43_wldev *dev, u16 table, u16 offset)\r\n{\r\nstruct b43_phy_g *gphy = dev->phy.g;\r\nu32 ret;\r\nu16 addr;\r\naddr = table + offset;\r\nif ((gphy->ofdmtab_addr_direction != B43_OFDMTAB_DIRECTION_READ) ||\r\n(addr - 1 != gphy->ofdmtab_addr)) {\r\nb43_phy_write(dev, B43_PHY_OTABLECTL, addr);\r\ngphy->ofdmtab_addr_direction = B43_OFDMTAB_DIRECTION_READ;\r\n}\r\ngphy->ofdmtab_addr = addr;\r\nret = b43_phy_read(dev, B43_PHY_OTABLEQ);\r\nret <<= 16;\r\nret |= b43_phy_read(dev, B43_PHY_OTABLEI);\r\nreturn ret;\r\n}\r\nvoid b43_ofdmtab_write32(struct b43_wldev *dev, u16 table,\r\nu16 offset, u32 value)\r\n{\r\nstruct b43_phy_g *gphy = dev->phy.g;\r\nu16 addr;\r\naddr = table + offset;\r\nif ((gphy->ofdmtab_addr_direction != B43_OFDMTAB_DIRECTION_WRITE) ||\r\n(addr - 1 != gphy->ofdmtab_addr)) {\r\nb43_phy_write(dev, B43_PHY_OTABLECTL, addr);\r\ngphy->ofdmtab_addr_direction = B43_OFDMTAB_DIRECTION_WRITE;\r\n}\r\ngphy->ofdmtab_addr = addr;\r\nb43_phy_write(dev, B43_PHY_OTABLEI, value);\r\nb43_phy_write(dev, B43_PHY_OTABLEQ, (value >> 16));\r\n}\r\nu16 b43_gtab_read(struct b43_wldev *dev, u16 table, u16 offset)\r\n{\r\nb43_phy_write(dev, B43_PHY_GTABCTL, table + offset);\r\nreturn b43_phy_read(dev, B43_PHY_GTABDATA);\r\n}\r\nvoid b43_gtab_write(struct b43_wldev *dev, u16 table, u16 offset, u16 value)\r\n{\r\nb43_phy_write(dev, B43_PHY_GTABCTL, table + offset);\r\nb43_phy_write(dev, B43_PHY_GTABDATA, value);\r\n}
