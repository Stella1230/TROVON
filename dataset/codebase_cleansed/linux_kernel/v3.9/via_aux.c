struct via_aux_bus *via_aux_probe(struct i2c_adapter *adap)\r\n{\r\nstruct via_aux_bus *bus;\r\nif (!adap)\r\nreturn NULL;\r\nbus = kmalloc(sizeof(*bus), GFP_KERNEL);\r\nif (!bus)\r\nreturn NULL;\r\nbus->adap = adap;\r\nINIT_LIST_HEAD(&bus->drivers);\r\nvia_aux_edid_probe(bus);\r\nvia_aux_vt1636_probe(bus);\r\nvia_aux_vt1632_probe(bus);\r\nvia_aux_vt1631_probe(bus);\r\nvia_aux_vt1625_probe(bus);\r\nvia_aux_vt1622_probe(bus);\r\nvia_aux_vt1621_probe(bus);\r\nvia_aux_sii164_probe(bus);\r\nvia_aux_ch7301_probe(bus);\r\nreturn bus;\r\n}\r\nvoid via_aux_free(struct via_aux_bus *bus)\r\n{\r\nstruct via_aux_drv *pos, *n;\r\nif (!bus)\r\nreturn;\r\nlist_for_each_entry_safe(pos, n, &bus->drivers, chain) {\r\nif (pos->cleanup)\r\npos->cleanup(pos);\r\nlist_del(&pos->chain);\r\nkfree(pos->data);\r\nkfree(pos);\r\n}\r\nkfree(bus);\r\n}\r\nconst struct fb_videomode *via_aux_get_preferred_mode(struct via_aux_bus *bus)\r\n{\r\nstruct via_aux_drv *pos;\r\nconst struct fb_videomode *mode = NULL;\r\nif (!bus)\r\nreturn NULL;\r\nlist_for_each_entry(pos, &bus->drivers, chain) {\r\nif (pos->get_preferred_mode)\r\nmode = pos->get_preferred_mode(pos);\r\n}\r\nreturn mode;\r\n}
