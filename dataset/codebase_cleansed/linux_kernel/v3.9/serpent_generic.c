int __serpent_setkey(struct serpent_ctx *ctx, const u8 *key,\r\nunsigned int keylen)\r\n{\r\nu32 *k = ctx->expkey;\r\nu8 *k8 = (u8 *)k;\r\nu32 r0, r1, r2, r3, r4;\r\nint i;\r\nfor (i = 0; i < keylen; ++i)\r\nk8[i] = key[i];\r\nif (i < SERPENT_MAX_KEY_SIZE)\r\nk8[i++] = 1;\r\nwhile (i < SERPENT_MAX_KEY_SIZE)\r\nk8[i++] = 0;\r\nr0 = le32_to_cpu(k[3]);\r\nr1 = le32_to_cpu(k[4]);\r\nr2 = le32_to_cpu(k[5]);\r\nr3 = le32_to_cpu(k[6]);\r\nr4 = le32_to_cpu(k[7]);\r\nkeyiter(le32_to_cpu(k[0]), r0, r4, r2, 0, 0);\r\nkeyiter(le32_to_cpu(k[1]), r1, r0, r3, 1, 1);\r\nkeyiter(le32_to_cpu(k[2]), r2, r1, r4, 2, 2);\r\nkeyiter(le32_to_cpu(k[3]), r3, r2, r0, 3, 3);\r\nkeyiter(le32_to_cpu(k[4]), r4, r3, r1, 4, 4);\r\nkeyiter(le32_to_cpu(k[5]), r0, r4, r2, 5, 5);\r\nkeyiter(le32_to_cpu(k[6]), r1, r0, r3, 6, 6);\r\nkeyiter(le32_to_cpu(k[7]), r2, r1, r4, 7, 7);\r\nkeyiter(k[0], r3, r2, r0, 8, 8);\r\nkeyiter(k[1], r4, r3, r1, 9, 9);\r\nkeyiter(k[2], r0, r4, r2, 10, 10);\r\nkeyiter(k[3], r1, r0, r3, 11, 11);\r\nkeyiter(k[4], r2, r1, r4, 12, 12);\r\nkeyiter(k[5], r3, r2, r0, 13, 13);\r\nkeyiter(k[6], r4, r3, r1, 14, 14);\r\nkeyiter(k[7], r0, r4, r2, 15, 15);\r\nkeyiter(k[8], r1, r0, r3, 16, 16);\r\nkeyiter(k[9], r2, r1, r4, 17, 17);\r\nkeyiter(k[10], r3, r2, r0, 18, 18);\r\nkeyiter(k[11], r4, r3, r1, 19, 19);\r\nkeyiter(k[12], r0, r4, r2, 20, 20);\r\nkeyiter(k[13], r1, r0, r3, 21, 21);\r\nkeyiter(k[14], r2, r1, r4, 22, 22);\r\nkeyiter(k[15], r3, r2, r0, 23, 23);\r\nkeyiter(k[16], r4, r3, r1, 24, 24);\r\nkeyiter(k[17], r0, r4, r2, 25, 25);\r\nkeyiter(k[18], r1, r0, r3, 26, 26);\r\nkeyiter(k[19], r2, r1, r4, 27, 27);\r\nkeyiter(k[20], r3, r2, r0, 28, 28);\r\nkeyiter(k[21], r4, r3, r1, 29, 29);\r\nkeyiter(k[22], r0, r4, r2, 30, 30);\r\nkeyiter(k[23], r1, r0, r3, 31, 31);\r\nk += 50;\r\nkeyiter(k[-26], r2, r1, r4, 32, -18);\r\nkeyiter(k[-25], r3, r2, r0, 33, -17);\r\nkeyiter(k[-24], r4, r3, r1, 34, -16);\r\nkeyiter(k[-23], r0, r4, r2, 35, -15);\r\nkeyiter(k[-22], r1, r0, r3, 36, -14);\r\nkeyiter(k[-21], r2, r1, r4, 37, -13);\r\nkeyiter(k[-20], r3, r2, r0, 38, -12);\r\nkeyiter(k[-19], r4, r3, r1, 39, -11);\r\nkeyiter(k[-18], r0, r4, r2, 40, -10);\r\nkeyiter(k[-17], r1, r0, r3, 41, -9);\r\nkeyiter(k[-16], r2, r1, r4, 42, -8);\r\nkeyiter(k[-15], r3, r2, r0, 43, -7);\r\nkeyiter(k[-14], r4, r3, r1, 44, -6);\r\nkeyiter(k[-13], r0, r4, r2, 45, -5);\r\nkeyiter(k[-12], r1, r0, r3, 46, -4);\r\nkeyiter(k[-11], r2, r1, r4, 47, -3);\r\nkeyiter(k[-10], r3, r2, r0, 48, -2);\r\nkeyiter(k[-9], r4, r3, r1, 49, -1);\r\nkeyiter(k[-8], r0, r4, r2, 50, 0);\r\nkeyiter(k[-7], r1, r0, r3, 51, 1);\r\nkeyiter(k[-6], r2, r1, r4, 52, 2);\r\nkeyiter(k[-5], r3, r2, r0, 53, 3);\r\nkeyiter(k[-4], r4, r3, r1, 54, 4);\r\nkeyiter(k[-3], r0, r4, r2, 55, 5);\r\nkeyiter(k[-2], r1, r0, r3, 56, 6);\r\nkeyiter(k[-1], r2, r1, r4, 57, 7);\r\nkeyiter(k[0], r3, r2, r0, 58, 8);\r\nkeyiter(k[1], r4, r3, r1, 59, 9);\r\nkeyiter(k[2], r0, r4, r2, 60, 10);\r\nkeyiter(k[3], r1, r0, r3, 61, 11);\r\nkeyiter(k[4], r2, r1, r4, 62, 12);\r\nkeyiter(k[5], r3, r2, r0, 63, 13);\r\nkeyiter(k[6], r4, r3, r1, 64, 14);\r\nkeyiter(k[7], r0, r4, r2, 65, 15);\r\nkeyiter(k[8], r1, r0, r3, 66, 16);\r\nkeyiter(k[9], r2, r1, r4, 67, 17);\r\nkeyiter(k[10], r3, r2, r0, 68, 18);\r\nkeyiter(k[11], r4, r3, r1, 69, 19);\r\nkeyiter(k[12], r0, r4, r2, 70, 20);\r\nkeyiter(k[13], r1, r0, r3, 71, 21);\r\nkeyiter(k[14], r2, r1, r4, 72, 22);\r\nkeyiter(k[15], r3, r2, r0, 73, 23);\r\nkeyiter(k[16], r4, r3, r1, 74, 24);\r\nkeyiter(k[17], r0, r4, r2, 75, 25);\r\nkeyiter(k[18], r1, r0, r3, 76, 26);\r\nkeyiter(k[19], r2, r1, r4, 77, 27);\r\nkeyiter(k[20], r3, r2, r0, 78, 28);\r\nkeyiter(k[21], r4, r3, r1, 79, 29);\r\nkeyiter(k[22], r0, r4, r2, 80, 30);\r\nkeyiter(k[23], r1, r0, r3, 81, 31);\r\nk += 50;\r\nkeyiter(k[-26], r2, r1, r4, 82, -18);\r\nkeyiter(k[-25], r3, r2, r0, 83, -17);\r\nkeyiter(k[-24], r4, r3, r1, 84, -16);\r\nkeyiter(k[-23], r0, r4, r2, 85, -15);\r\nkeyiter(k[-22], r1, r0, r3, 86, -14);\r\nkeyiter(k[-21], r2, r1, r4, 87, -13);\r\nkeyiter(k[-20], r3, r2, r0, 88, -12);\r\nkeyiter(k[-19], r4, r3, r1, 89, -11);\r\nkeyiter(k[-18], r0, r4, r2, 90, -10);\r\nkeyiter(k[-17], r1, r0, r3, 91, -9);\r\nkeyiter(k[-16], r2, r1, r4, 92, -8);\r\nkeyiter(k[-15], r3, r2, r0, 93, -7);\r\nkeyiter(k[-14], r4, r3, r1, 94, -6);\r\nkeyiter(k[-13], r0, r4, r2, 95, -5);\r\nkeyiter(k[-12], r1, r0, r3, 96, -4);\r\nkeyiter(k[-11], r2, r1, r4, 97, -3);\r\nkeyiter(k[-10], r3, r2, r0, 98, -2);\r\nkeyiter(k[-9], r4, r3, r1, 99, -1);\r\nkeyiter(k[-8], r0, r4, r2, 100, 0);\r\nkeyiter(k[-7], r1, r0, r3, 101, 1);\r\nkeyiter(k[-6], r2, r1, r4, 102, 2);\r\nkeyiter(k[-5], r3, r2, r0, 103, 3);\r\nkeyiter(k[-4], r4, r3, r1, 104, 4);\r\nkeyiter(k[-3], r0, r4, r2, 105, 5);\r\nkeyiter(k[-2], r1, r0, r3, 106, 6);\r\nkeyiter(k[-1], r2, r1, r4, 107, 7);\r\nkeyiter(k[0], r3, r2, r0, 108, 8);\r\nkeyiter(k[1], r4, r3, r1, 109, 9);\r\nkeyiter(k[2], r0, r4, r2, 110, 10);\r\nkeyiter(k[3], r1, r0, r3, 111, 11);\r\nkeyiter(k[4], r2, r1, r4, 112, 12);\r\nkeyiter(k[5], r3, r2, r0, 113, 13);\r\nkeyiter(k[6], r4, r3, r1, 114, 14);\r\nkeyiter(k[7], r0, r4, r2, 115, 15);\r\nkeyiter(k[8], r1, r0, r3, 116, 16);\r\nkeyiter(k[9], r2, r1, r4, 117, 17);\r\nkeyiter(k[10], r3, r2, r0, 118, 18);\r\nkeyiter(k[11], r4, r3, r1, 119, 19);\r\nkeyiter(k[12], r0, r4, r2, 120, 20);\r\nkeyiter(k[13], r1, r0, r3, 121, 21);\r\nkeyiter(k[14], r2, r1, r4, 122, 22);\r\nkeyiter(k[15], r3, r2, r0, 123, 23);\r\nkeyiter(k[16], r4, r3, r1, 124, 24);\r\nkeyiter(k[17], r0, r4, r2, 125, 25);\r\nkeyiter(k[18], r1, r0, r3, 126, 26);\r\nkeyiter(k[19], r2, r1, r4, 127, 27);\r\nkeyiter(k[20], r3, r2, r0, 128, 28);\r\nkeyiter(k[21], r4, r3, r1, 129, 29);\r\nkeyiter(k[22], r0, r4, r2, 130, 30);\r\nkeyiter(k[23], r1, r0, r3, 131, 31);\r\nS3(r3, r4, r0, r1, r2); store_and_load_keys(r1, r2, r4, r3, 28, 24);\r\nS4(r1, r2, r4, r3, r0); store_and_load_keys(r2, r4, r3, r0, 24, 20);\r\nS5(r2, r4, r3, r0, r1); store_and_load_keys(r1, r2, r4, r0, 20, 16);\r\nS6(r1, r2, r4, r0, r3); store_and_load_keys(r4, r3, r2, r0, 16, 12);\r\nS7(r4, r3, r2, r0, r1); store_and_load_keys(r1, r2, r0, r4, 12, 8);\r\nS0(r1, r2, r0, r4, r3); store_and_load_keys(r0, r2, r4, r1, 8, 4);\r\nS1(r0, r2, r4, r1, r3); store_and_load_keys(r3, r4, r1, r0, 4, 0);\r\nS2(r3, r4, r1, r0, r2); store_and_load_keys(r2, r4, r3, r0, 0, -4);\r\nS3(r2, r4, r3, r0, r1); store_and_load_keys(r0, r1, r4, r2, -4, -8);\r\nS4(r0, r1, r4, r2, r3); store_and_load_keys(r1, r4, r2, r3, -8, -12);\r\nS5(r1, r4, r2, r3, r0); store_and_load_keys(r0, r1, r4, r3, -12, -16);\r\nS6(r0, r1, r4, r3, r2); store_and_load_keys(r4, r2, r1, r3, -16, -20);\r\nS7(r4, r2, r1, r3, r0); store_and_load_keys(r0, r1, r3, r4, -20, -24);\r\nS0(r0, r1, r3, r4, r2); store_and_load_keys(r3, r1, r4, r0, -24, -28);\r\nk -= 50;\r\nS1(r3, r1, r4, r0, r2); store_and_load_keys(r2, r4, r0, r3, 22, 18);\r\nS2(r2, r4, r0, r3, r1); store_and_load_keys(r1, r4, r2, r3, 18, 14);\r\nS3(r1, r4, r2, r3, r0); store_and_load_keys(r3, r0, r4, r1, 14, 10);\r\nS4(r3, r0, r4, r1, r2); store_and_load_keys(r0, r4, r1, r2, 10, 6);\r\nS5(r0, r4, r1, r2, r3); store_and_load_keys(r3, r0, r4, r2, 6, 2);\r\nS6(r3, r0, r4, r2, r1); store_and_load_keys(r4, r1, r0, r2, 2, -2);\r\nS7(r4, r1, r0, r2, r3); store_and_load_keys(r3, r0, r2, r4, -2, -6);\r\nS0(r3, r0, r2, r4, r1); store_and_load_keys(r2, r0, r4, r3, -6, -10);\r\nS1(r2, r0, r4, r3, r1); store_and_load_keys(r1, r4, r3, r2, -10, -14);\r\nS2(r1, r4, r3, r2, r0); store_and_load_keys(r0, r4, r1, r2, -14, -18);\r\nS3(r0, r4, r1, r2, r3); store_and_load_keys(r2, r3, r4, r0, -18, -22);\r\nk -= 50;\r\nS4(r2, r3, r4, r0, r1); store_and_load_keys(r3, r4, r0, r1, 28, 24);\r\nS5(r3, r4, r0, r1, r2); store_and_load_keys(r2, r3, r4, r1, 24, 20);\r\nS6(r2, r3, r4, r1, r0); store_and_load_keys(r4, r0, r3, r1, 20, 16);\r\nS7(r4, r0, r3, r1, r2); store_and_load_keys(r2, r3, r1, r4, 16, 12);\r\nS0(r2, r3, r1, r4, r0); store_and_load_keys(r1, r3, r4, r2, 12, 8);\r\nS1(r1, r3, r4, r2, r0); store_and_load_keys(r0, r4, r2, r1, 8, 4);\r\nS2(r0, r4, r2, r1, r3); store_and_load_keys(r3, r4, r0, r1, 4, 0);\r\nS3(r3, r4, r0, r1, r2); storekeys(r1, r2, r4, r3, 0);\r\nreturn 0;\r\n}\r\nint serpent_setkey(struct crypto_tfm *tfm, const u8 *key, unsigned int keylen)\r\n{\r\nreturn __serpent_setkey(crypto_tfm_ctx(tfm), key, keylen);\r\n}\r\nvoid __serpent_encrypt(struct serpent_ctx *ctx, u8 *dst, const u8 *src)\r\n{\r\nconst u32 *k = ctx->expkey;\r\nconst __le32 *s = (const __le32 *)src;\r\n__le32 *d = (__le32 *)dst;\r\nu32 r0, r1, r2, r3, r4;\r\nr0 = le32_to_cpu(s[0]);\r\nr1 = le32_to_cpu(s[1]);\r\nr2 = le32_to_cpu(s[2]);\r\nr3 = le32_to_cpu(s[3]);\r\nK(r0, r1, r2, r3, 0);\r\nS0(r0, r1, r2, r3, r4); LK(r2, r1, r3, r0, r4, 1);\r\nS1(r2, r1, r3, r0, r4); LK(r4, r3, r0, r2, r1, 2);\r\nS2(r4, r3, r0, r2, r1); LK(r1, r3, r4, r2, r0, 3);\r\nS3(r1, r3, r4, r2, r0); LK(r2, r0, r3, r1, r4, 4);\r\nS4(r2, r0, r3, r1, r4); LK(r0, r3, r1, r4, r2, 5);\r\nS5(r0, r3, r1, r4, r2); LK(r2, r0, r3, r4, r1, 6);\r\nS6(r2, r0, r3, r4, r1); LK(r3, r1, r0, r4, r2, 7);\r\nS7(r3, r1, r0, r4, r2); LK(r2, r0, r4, r3, r1, 8);\r\nS0(r2, r0, r4, r3, r1); LK(r4, r0, r3, r2, r1, 9);\r\nS1(r4, r0, r3, r2, r1); LK(r1, r3, r2, r4, r0, 10);\r\nS2(r1, r3, r2, r4, r0); LK(r0, r3, r1, r4, r2, 11);\r\nS3(r0, r3, r1, r4, r2); LK(r4, r2, r3, r0, r1, 12);\r\nS4(r4, r2, r3, r0, r1); LK(r2, r3, r0, r1, r4, 13);\r\nS5(r2, r3, r0, r1, r4); LK(r4, r2, r3, r1, r0, 14);\r\nS6(r4, r2, r3, r1, r0); LK(r3, r0, r2, r1, r4, 15);\r\nS7(r3, r0, r2, r1, r4); LK(r4, r2, r1, r3, r0, 16);\r\nS0(r4, r2, r1, r3, r0); LK(r1, r2, r3, r4, r0, 17);\r\nS1(r1, r2, r3, r4, r0); LK(r0, r3, r4, r1, r2, 18);\r\nS2(r0, r3, r4, r1, r2); LK(r2, r3, r0, r1, r4, 19);\r\nS3(r2, r3, r0, r1, r4); LK(r1, r4, r3, r2, r0, 20);\r\nS4(r1, r4, r3, r2, r0); LK(r4, r3, r2, r0, r1, 21);\r\nS5(r4, r3, r2, r0, r1); LK(r1, r4, r3, r0, r2, 22);\r\nS6(r1, r4, r3, r0, r2); LK(r3, r2, r4, r0, r1, 23);\r\nS7(r3, r2, r4, r0, r1); LK(r1, r4, r0, r3, r2, 24);\r\nS0(r1, r4, r0, r3, r2); LK(r0, r4, r3, r1, r2, 25);\r\nS1(r0, r4, r3, r1, r2); LK(r2, r3, r1, r0, r4, 26);\r\nS2(r2, r3, r1, r0, r4); LK(r4, r3, r2, r0, r1, 27);\r\nS3(r4, r3, r2, r0, r1); LK(r0, r1, r3, r4, r2, 28);\r\nS4(r0, r1, r3, r4, r2); LK(r1, r3, r4, r2, r0, 29);\r\nS5(r1, r3, r4, r2, r0); LK(r0, r1, r3, r2, r4, 30);\r\nS6(r0, r1, r3, r2, r4); LK(r3, r4, r1, r2, r0, 31);\r\nS7(r3, r4, r1, r2, r0); K(r0, r1, r2, r3, 32);\r\nd[0] = cpu_to_le32(r0);\r\nd[1] = cpu_to_le32(r1);\r\nd[2] = cpu_to_le32(r2);\r\nd[3] = cpu_to_le32(r3);\r\n}\r\nstatic void serpent_encrypt(struct crypto_tfm *tfm, u8 *dst, const u8 *src)\r\n{\r\nstruct serpent_ctx *ctx = crypto_tfm_ctx(tfm);\r\n__serpent_encrypt(ctx, dst, src);\r\n}\r\nvoid __serpent_decrypt(struct serpent_ctx *ctx, u8 *dst, const u8 *src)\r\n{\r\nconst u32 *k = ctx->expkey;\r\nconst __le32 *s = (const __le32 *)src;\r\n__le32 *d = (__le32 *)dst;\r\nu32 r0, r1, r2, r3, r4;\r\nr0 = le32_to_cpu(s[0]);\r\nr1 = le32_to_cpu(s[1]);\r\nr2 = le32_to_cpu(s[2]);\r\nr3 = le32_to_cpu(s[3]);\r\nK(r0, r1, r2, r3, 32);\r\nSI7(r0, r1, r2, r3, r4); KL(r1, r3, r0, r4, r2, 31);\r\nSI6(r1, r3, r0, r4, r2); KL(r0, r2, r4, r1, r3, 30);\r\nSI5(r0, r2, r4, r1, r3); KL(r2, r3, r0, r4, r1, 29);\r\nSI4(r2, r3, r0, r4, r1); KL(r2, r0, r1, r4, r3, 28);\r\nSI3(r2, r0, r1, r4, r3); KL(r1, r2, r3, r4, r0, 27);\r\nSI2(r1, r2, r3, r4, r0); KL(r2, r0, r4, r3, r1, 26);\r\nSI1(r2, r0, r4, r3, r1); KL(r1, r0, r4, r3, r2, 25);\r\nSI0(r1, r0, r4, r3, r2); KL(r4, r2, r0, r1, r3, 24);\r\nSI7(r4, r2, r0, r1, r3); KL(r2, r1, r4, r3, r0, 23);\r\nSI6(r2, r1, r4, r3, r0); KL(r4, r0, r3, r2, r1, 22);\r\nSI5(r4, r0, r3, r2, r1); KL(r0, r1, r4, r3, r2, 21);\r\nSI4(r0, r1, r4, r3, r2); KL(r0, r4, r2, r3, r1, 20);\r\nSI3(r0, r4, r2, r3, r1); KL(r2, r0, r1, r3, r4, 19);\r\nSI2(r2, r0, r1, r3, r4); KL(r0, r4, r3, r1, r2, 18);\r\nSI1(r0, r4, r3, r1, r2); KL(r2, r4, r3, r1, r0, 17);\r\nSI0(r2, r4, r3, r1, r0); KL(r3, r0, r4, r2, r1, 16);\r\nSI7(r3, r0, r4, r2, r1); KL(r0, r2, r3, r1, r4, 15);\r\nSI6(r0, r2, r3, r1, r4); KL(r3, r4, r1, r0, r2, 14);\r\nSI5(r3, r4, r1, r0, r2); KL(r4, r2, r3, r1, r0, 13);\r\nSI4(r4, r2, r3, r1, r0); KL(r4, r3, r0, r1, r2, 12);\r\nSI3(r4, r3, r0, r1, r2); KL(r0, r4, r2, r1, r3, 11);\r\nSI2(r0, r4, r2, r1, r3); KL(r4, r3, r1, r2, r0, 10);\r\nSI1(r4, r3, r1, r2, r0); KL(r0, r3, r1, r2, r4, 9);\r\nSI0(r0, r3, r1, r2, r4); KL(r1, r4, r3, r0, r2, 8);\r\nSI7(r1, r4, r3, r0, r2); KL(r4, r0, r1, r2, r3, 7);\r\nSI6(r4, r0, r1, r2, r3); KL(r1, r3, r2, r4, r0, 6);\r\nSI5(r1, r3, r2, r4, r0); KL(r3, r0, r1, r2, r4, 5);\r\nSI4(r3, r0, r1, r2, r4); KL(r3, r1, r4, r2, r0, 4);\r\nSI3(r3, r1, r4, r2, r0); KL(r4, r3, r0, r2, r1, 3);\r\nSI2(r4, r3, r0, r2, r1); KL(r3, r1, r2, r0, r4, 2);\r\nSI1(r3, r1, r2, r0, r4); KL(r4, r1, r2, r0, r3, 1);\r\nSI0(r4, r1, r2, r0, r3); K(r2, r3, r1, r4, 0);\r\nd[0] = cpu_to_le32(r2);\r\nd[1] = cpu_to_le32(r3);\r\nd[2] = cpu_to_le32(r1);\r\nd[3] = cpu_to_le32(r4);\r\n}\r\nstatic void serpent_decrypt(struct crypto_tfm *tfm, u8 *dst, const u8 *src)\r\n{\r\nstruct serpent_ctx *ctx = crypto_tfm_ctx(tfm);\r\n__serpent_decrypt(ctx, dst, src);\r\n}\r\nstatic int tnepres_setkey(struct crypto_tfm *tfm, const u8 *key,\r\nunsigned int keylen)\r\n{\r\nu8 rev_key[SERPENT_MAX_KEY_SIZE];\r\nint i;\r\nfor (i = 0; i < keylen; ++i)\r\nrev_key[keylen - i - 1] = key[i];\r\nreturn serpent_setkey(tfm, rev_key, keylen);\r\n}\r\nstatic void tnepres_encrypt(struct crypto_tfm *tfm, u8 *dst, const u8 *src)\r\n{\r\nconst u32 * const s = (const u32 * const)src;\r\nu32 * const d = (u32 * const)dst;\r\nu32 rs[4], rd[4];\r\nrs[0] = swab32(s[3]);\r\nrs[1] = swab32(s[2]);\r\nrs[2] = swab32(s[1]);\r\nrs[3] = swab32(s[0]);\r\nserpent_encrypt(tfm, (u8 *)rd, (u8 *)rs);\r\nd[0] = swab32(rd[3]);\r\nd[1] = swab32(rd[2]);\r\nd[2] = swab32(rd[1]);\r\nd[3] = swab32(rd[0]);\r\n}\r\nstatic void tnepres_decrypt(struct crypto_tfm *tfm, u8 *dst, const u8 *src)\r\n{\r\nconst u32 * const s = (const u32 * const)src;\r\nu32 * const d = (u32 * const)dst;\r\nu32 rs[4], rd[4];\r\nrs[0] = swab32(s[3]);\r\nrs[1] = swab32(s[2]);\r\nrs[2] = swab32(s[1]);\r\nrs[3] = swab32(s[0]);\r\nserpent_decrypt(tfm, (u8 *)rd, (u8 *)rs);\r\nd[0] = swab32(rd[3]);\r\nd[1] = swab32(rd[2]);\r\nd[2] = swab32(rd[1]);\r\nd[3] = swab32(rd[0]);\r\n}\r\nstatic int __init serpent_mod_init(void)\r\n{\r\nreturn crypto_register_algs(srp_algs, ARRAY_SIZE(srp_algs));\r\n}\r\nstatic void __exit serpent_mod_fini(void)\r\n{\r\ncrypto_unregister_algs(srp_algs, ARRAY_SIZE(srp_algs));\r\n}
