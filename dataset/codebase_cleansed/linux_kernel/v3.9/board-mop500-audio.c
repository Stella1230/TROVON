static struct platform_device *db8500_add_msp_i2s(struct device *parent,\r\nint id,\r\nresource_size_t base, int irq,\r\nstruct msp_i2s_platform_data *pdata)\r\n{\r\nstruct platform_device *pdev;\r\nstruct resource res[] = {\r\nDEFINE_RES_MEM(base, SZ_4K),\r\nDEFINE_RES_IRQ(irq),\r\n};\r\npr_info("Register platform-device 'ux500-msp-i2s', id %d, irq %d\n",\r\nid, irq);\r\npdev = platform_device_register_resndata(parent, "ux500-msp-i2s", id,\r\nres, ARRAY_SIZE(res),\r\npdata, sizeof(*pdata));\r\nif (!pdev) {\r\npr_err("Failed to register platform-device 'ux500-msp-i2s.%d'!\n",\r\nid);\r\nreturn NULL;\r\n}\r\nreturn pdev;\r\n}\r\nvoid mop500_audio_init(struct device *parent)\r\n{\r\npr_info("%s: Register platform-device 'snd-soc-mop500'.\n", __func__);\r\nplatform_device_register(&snd_soc_mop500);\r\npr_info("Initialize MSP I2S-devices.\n");\r\ndb8500_add_msp_i2s(parent, 0, U8500_MSP0_BASE, IRQ_DB8500_MSP0,\r\n&msp0_platform_data);\r\ndb8500_add_msp_i2s(parent, 1, U8500_MSP1_BASE, IRQ_DB8500_MSP1,\r\n&msp1_platform_data);\r\ndb8500_add_msp_i2s(parent, 2, U8500_MSP2_BASE, IRQ_DB8500_MSP2,\r\n&msp2_platform_data);\r\ndb8500_add_msp_i2s(parent, 3, U8500_MSP3_BASE, IRQ_DB8500_MSP1,\r\n&msp3_platform_data);\r\n}
