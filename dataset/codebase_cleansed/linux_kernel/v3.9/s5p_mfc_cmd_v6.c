int s5p_mfc_cmd_host2risc_v6(struct s5p_mfc_dev *dev, int cmd,\r\nstruct s5p_mfc_cmd_args *args)\r\n{\r\nmfc_debug(2, "Issue the command: %d\n", cmd);\r\nmfc_write(dev, 0x0, S5P_FIMV_RISC2HOST_CMD_V6);\r\nmfc_write(dev, cmd, S5P_FIMV_HOST2RISC_CMD_V6);\r\nmfc_write(dev, 0x1, S5P_FIMV_HOST2RISC_INT_V6);\r\nreturn 0;\r\n}\r\nint s5p_mfc_sys_init_cmd_v6(struct s5p_mfc_dev *dev)\r\n{\r\nstruct s5p_mfc_cmd_args h2r_args;\r\nstruct s5p_mfc_buf_size_v6 *buf_size = dev->variant->buf_size->priv;\r\ns5p_mfc_hw_call(dev->mfc_ops, alloc_dev_context_buffer, dev);\r\nmfc_write(dev, dev->ctx_buf.dma, S5P_FIMV_CONTEXT_MEM_ADDR_V6);\r\nmfc_write(dev, buf_size->dev_ctx, S5P_FIMV_CONTEXT_MEM_SIZE_V6);\r\nreturn s5p_mfc_cmd_host2risc_v6(dev, S5P_FIMV_H2R_CMD_SYS_INIT_V6,\r\n&h2r_args);\r\n}\r\nint s5p_mfc_sleep_cmd_v6(struct s5p_mfc_dev *dev)\r\n{\r\nstruct s5p_mfc_cmd_args h2r_args;\r\nmemset(&h2r_args, 0, sizeof(struct s5p_mfc_cmd_args));\r\nreturn s5p_mfc_cmd_host2risc_v6(dev, S5P_FIMV_H2R_CMD_SLEEP_V6,\r\n&h2r_args);\r\n}\r\nint s5p_mfc_wakeup_cmd_v6(struct s5p_mfc_dev *dev)\r\n{\r\nstruct s5p_mfc_cmd_args h2r_args;\r\nmemset(&h2r_args, 0, sizeof(struct s5p_mfc_cmd_args));\r\nreturn s5p_mfc_cmd_host2risc_v6(dev, S5P_FIMV_H2R_CMD_WAKEUP_V6,\r\n&h2r_args);\r\n}\r\nint s5p_mfc_open_inst_cmd_v6(struct s5p_mfc_ctx *ctx)\r\n{\r\nstruct s5p_mfc_dev *dev = ctx->dev;\r\nstruct s5p_mfc_cmd_args h2r_args;\r\nint codec_type;\r\nmfc_debug(2, "Requested codec mode: %d\n", ctx->codec_mode);\r\ndev->curr_ctx = ctx->num;\r\nswitch (ctx->codec_mode) {\r\ncase S5P_MFC_CODEC_H264_DEC:\r\ncodec_type = S5P_FIMV_CODEC_H264_DEC_V6;\r\nbreak;\r\ncase S5P_MFC_CODEC_H264_MVC_DEC:\r\ncodec_type = S5P_FIMV_CODEC_H264_MVC_DEC_V6;\r\nbreak;\r\ncase S5P_MFC_CODEC_VC1_DEC:\r\ncodec_type = S5P_FIMV_CODEC_VC1_DEC_V6;\r\nbreak;\r\ncase S5P_MFC_CODEC_MPEG4_DEC:\r\ncodec_type = S5P_FIMV_CODEC_MPEG4_DEC_V6;\r\nbreak;\r\ncase S5P_MFC_CODEC_MPEG2_DEC:\r\ncodec_type = S5P_FIMV_CODEC_MPEG2_DEC_V6;\r\nbreak;\r\ncase S5P_MFC_CODEC_H263_DEC:\r\ncodec_type = S5P_FIMV_CODEC_H263_DEC_V6;\r\nbreak;\r\ncase S5P_MFC_CODEC_VC1RCV_DEC:\r\ncodec_type = S5P_FIMV_CODEC_VC1RCV_DEC_V6;\r\nbreak;\r\ncase S5P_MFC_CODEC_VP8_DEC:\r\ncodec_type = S5P_FIMV_CODEC_VP8_DEC_V6;\r\nbreak;\r\ncase S5P_MFC_CODEC_H264_ENC:\r\ncodec_type = S5P_FIMV_CODEC_H264_ENC_V6;\r\nbreak;\r\ncase S5P_MFC_CODEC_H264_MVC_ENC:\r\ncodec_type = S5P_FIMV_CODEC_H264_MVC_ENC_V6;\r\nbreak;\r\ncase S5P_MFC_CODEC_MPEG4_ENC:\r\ncodec_type = S5P_FIMV_CODEC_MPEG4_ENC_V6;\r\nbreak;\r\ncase S5P_MFC_CODEC_H263_ENC:\r\ncodec_type = S5P_FIMV_CODEC_H263_ENC_V6;\r\nbreak;\r\ndefault:\r\ncodec_type = S5P_FIMV_CODEC_NONE_V6;\r\n};\r\nmfc_write(dev, codec_type, S5P_FIMV_CODEC_TYPE_V6);\r\nmfc_write(dev, ctx->ctx.dma, S5P_FIMV_CONTEXT_MEM_ADDR_V6);\r\nmfc_write(dev, ctx->ctx.size, S5P_FIMV_CONTEXT_MEM_SIZE_V6);\r\nmfc_write(dev, 0, S5P_FIMV_D_CRC_CTRL_V6);\r\nreturn s5p_mfc_cmd_host2risc_v6(dev, S5P_FIMV_H2R_CMD_OPEN_INSTANCE_V6,\r\n&h2r_args);\r\n}\r\nint s5p_mfc_close_inst_cmd_v6(struct s5p_mfc_ctx *ctx)\r\n{\r\nstruct s5p_mfc_dev *dev = ctx->dev;\r\nstruct s5p_mfc_cmd_args h2r_args;\r\nint ret = 0;\r\ndev->curr_ctx = ctx->num;\r\nif (ctx->state != MFCINST_FREE) {\r\nmfc_write(dev, ctx->inst_no, S5P_FIMV_INSTANCE_ID_V6);\r\nret = s5p_mfc_cmd_host2risc_v6(dev,\r\nS5P_FIMV_H2R_CMD_CLOSE_INSTANCE_V6,\r\n&h2r_args);\r\n} else {\r\nret = -EINVAL;\r\n}\r\nreturn ret;\r\n}\r\nstruct s5p_mfc_hw_cmds *s5p_mfc_init_hw_cmds_v6(void)\r\n{\r\nreturn &s5p_mfc_cmds_v6;\r\n}
