void\r\n__delay(int loops)\r\n{\r\nint tmp;\r\n__asm__ __volatile__(\r\n" rpcc %0\n"\r\n" addl %1,%0,%1\n"\r\n"1: rpcc %0\n"\r\n" subl %1,%0,%0\n"\r\n" bgt %0,1b"\r\n: "=&r" (tmp), "=r" (loops) : "1"(loops));\r\n}\r\nvoid\r\nudelay(unsigned long usecs)\r\n{\r\nusecs *= (((unsigned long)HZ << 32) / 1000000) * LPJ;\r\n__delay((long)usecs >> 32);\r\n}\r\nvoid\r\nndelay(unsigned long nsecs)\r\n{\r\nnsecs *= (((unsigned long)HZ << 32) / 1000000000) * LPJ;\r\n__delay((long)nsecs >> 32);\r\n}
