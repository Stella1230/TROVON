static int __init blackstamp_init(void)\r\n{\r\nint ret;\r\nprintk(KERN_INFO "%s(): registering device resources\n", __func__);\r\ni2c_register_board_info(0, bfin_i2c_board_info,\r\nARRAY_SIZE(bfin_i2c_board_info));\r\nret = platform_add_devices(stamp_devices, ARRAY_SIZE(stamp_devices));\r\nif (ret < 0)\r\nreturn ret;\r\n#if defined(CONFIG_SMC91X) || defined(CONFIG_SMC91X_MODULE)\r\nret = gpio_request(GPIO_PF0, "enet_cpld");\r\nif (!ret) {\r\ngpio_direction_output(GPIO_PF0, 1);\r\ngpio_free(GPIO_PF0);\r\n}\r\n#endif\r\nspi_register_board_info(bfin_spi_board_info, ARRAY_SIZE(bfin_spi_board_info));\r\nreturn 0;\r\n}\r\nvoid __init native_machine_early_platform_add_devices(void)\r\n{\r\nprintk(KERN_INFO "register early platform devices\n");\r\nearly_platform_add_devices(stamp_early_devices,\r\nARRAY_SIZE(stamp_early_devices));\r\n}
