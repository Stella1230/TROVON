static int via_driver_open(struct drm_device *dev, struct drm_file *file)\r\n{\r\nstruct via_file_private *file_priv;\r\nDRM_DEBUG_DRIVER("\n");\r\nfile_priv = kmalloc(sizeof(*file_priv), GFP_KERNEL);\r\nif (!file_priv)\r\nreturn -ENOMEM;\r\nfile->driver_priv = file_priv;\r\nINIT_LIST_HEAD(&file_priv->obj_list);\r\nreturn 0;\r\n}\r\nvoid via_driver_postclose(struct drm_device *dev, struct drm_file *file)\r\n{\r\nstruct via_file_private *file_priv = file->driver_priv;\r\nkfree(file_priv);\r\n}\r\nstatic int __init via_init(void)\r\n{\r\ndriver.num_ioctls = via_max_ioctl;\r\nvia_init_command_verifier();\r\nreturn drm_pci_init(&driver, &via_pci_driver);\r\n}\r\nstatic void __exit via_exit(void)\r\n{\r\ndrm_pci_exit(&driver, &via_pci_driver);\r\n}
