static inline void __init zoom_init_smsc911x(void)\r\n{\r\ngpmc_smsc911x_init(&zoom_smsc911x_cfg);\r\n}\r\nstatic inline void __init zoom_init_quaduart(void)\r\n{\r\nint quart_cs;\r\nunsigned long cs_mem_base;\r\nint quart_gpio = 0;\r\nif (gpio_request_one(ZOOM_QUADUART_RST_GPIO,\r\nGPIOF_OUT_INIT_LOW,\r\n"TL16CP754C GPIO") < 0) {\r\npr_err("Failed to request GPIO%d for TL16CP754C\n",\r\nZOOM_QUADUART_RST_GPIO);\r\nreturn;\r\n}\r\nquart_cs = ZOOM_QUADUART_CS;\r\nif (gpmc_cs_request(quart_cs, SZ_1M, &cs_mem_base) < 0) {\r\npr_err("Failed to request GPMC mem for Quad UART(TL16CP754C)\n");\r\nreturn;\r\n}\r\nquart_gpio = ZOOM_QUADUART_GPIO;\r\nif (gpio_request_one(quart_gpio, GPIOF_IN, "TL16CP754C GPIO") < 0)\r\nprintk(KERN_ERR "Failed to request GPIO%d for TL16CP754C\n",\r\nquart_gpio);\r\nserial_platform_data[0].irq = gpio_to_irq(102);\r\n}\r\nstatic inline int omap_zoom_debugboard_detect(void)\r\n{\r\nint debug_board_detect = 0;\r\nint ret = 1;\r\ndebug_board_detect = ZOOM_SMSC911X_GPIO;\r\nif (gpio_request_one(debug_board_detect, GPIOF_IN,\r\n"Zoom debug board detect") < 0) {\r\npr_err("Failed to request GPIO%d for Zoom debug board detect\n",\r\ndebug_board_detect);\r\nreturn 0;\r\n}\r\nif (!gpio_get_value(debug_board_detect)) {\r\nret = 0;\r\n}\r\ngpio_free(debug_board_detect);\r\nreturn ret;\r\n}\r\nint __init zoom_debugboard_init(void)\r\n{\r\nif (!omap_zoom_debugboard_detect())\r\nreturn 0;\r\nregulator_register_fixed(0, dummy_supplies, ARRAY_SIZE(dummy_supplies));\r\nzoom_init_smsc911x();\r\nzoom_init_quaduart();\r\nreturn platform_add_devices(zoom_devices, ARRAY_SIZE(zoom_devices));\r\n}
