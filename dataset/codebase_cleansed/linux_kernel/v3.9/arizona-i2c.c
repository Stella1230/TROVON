static int arizona_i2c_probe(struct i2c_client *i2c,\r\nconst struct i2c_device_id *id)\r\n{\r\nstruct arizona *arizona;\r\nconst struct regmap_config *regmap_config;\r\nint ret;\r\nswitch (id->driver_data) {\r\n#ifdef CONFIG_MFD_WM5102\r\ncase WM5102:\r\nregmap_config = &wm5102_i2c_regmap;\r\nbreak;\r\n#endif\r\n#ifdef CONFIG_MFD_WM5110\r\ncase WM5110:\r\nregmap_config = &wm5110_i2c_regmap;\r\nbreak;\r\n#endif\r\ndefault:\r\ndev_err(&i2c->dev, "Unknown device type %ld\n",\r\nid->driver_data);\r\nreturn -EINVAL;\r\n}\r\narizona = devm_kzalloc(&i2c->dev, sizeof(*arizona), GFP_KERNEL);\r\nif (arizona == NULL)\r\nreturn -ENOMEM;\r\narizona->regmap = devm_regmap_init_i2c(i2c, regmap_config);\r\nif (IS_ERR(arizona->regmap)) {\r\nret = PTR_ERR(arizona->regmap);\r\ndev_err(&i2c->dev, "Failed to allocate register map: %d\n",\r\nret);\r\nreturn ret;\r\n}\r\narizona->type = id->driver_data;\r\narizona->dev = &i2c->dev;\r\narizona->irq = i2c->irq;\r\nreturn arizona_dev_init(arizona);\r\n}\r\nstatic int arizona_i2c_remove(struct i2c_client *i2c)\r\n{\r\nstruct arizona *arizona = dev_get_drvdata(&i2c->dev);\r\narizona_dev_exit(arizona);\r\nreturn 0;\r\n}
