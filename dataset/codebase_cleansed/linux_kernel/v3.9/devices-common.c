static struct platform_device *\r\ndbx500_add_gpio(struct device *parent, int id, resource_size_t addr, int irq,\r\nstruct nmk_gpio_platform_data *pdata)\r\n{\r\nstruct resource resources[] = {\r\n{\r\n.start = addr,\r\n.end = addr + 127,\r\n.flags = IORESOURCE_MEM,\r\n},\r\n{\r\n.start = irq,\r\n.end = irq,\r\n.flags = IORESOURCE_IRQ,\r\n}\r\n};\r\nreturn platform_device_register_resndata(\r\nparent,\r\n"gpio",\r\nid,\r\nresources,\r\nARRAY_SIZE(resources),\r\npdata,\r\nsizeof(*pdata));\r\n}\r\nvoid dbx500_add_gpios(struct device *parent, resource_size_t *base, int num,\r\nint irq, struct nmk_gpio_platform_data *pdata)\r\n{\r\nint first = 0;\r\nint i;\r\nfor (i = 0; i < num; i++, first += 32, irq++) {\r\npdata->first_gpio = first;\r\npdata->first_irq = NOMADIK_GPIO_TO_IRQ(first);\r\npdata->num_gpio = 32;\r\ndbx500_add_gpio(parent, i, base[i], irq, pdata);\r\n}\r\n}
