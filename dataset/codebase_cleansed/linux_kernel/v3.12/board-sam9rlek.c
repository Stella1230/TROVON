static void __init ek_init_early(void)\r\n{\r\nat91_initialize(12000000);\r\n}\r\nstatic void __init ek_add_device_nand(void)\r\n{\r\nsam9_smc_configure(0, 3, &ek_nand_smc_config);\r\nat91_add_device_nand(&ek_nand_data);\r\n}\r\nstatic void at91_lcdc_power_control(int on)\r\n{\r\nif (on)\r\nat91_set_gpio_value(AT91_PIN_PC1, 0);\r\nelse\r\nat91_set_gpio_value(AT91_PIN_PC1, 1);\r\n}\r\nstatic void __init ek_add_device_buttons(void)\r\n{\r\nat91_set_gpio_input(AT91_PIN_PB1, 1);\r\nat91_set_deglitch(AT91_PIN_PB1, 1);\r\nat91_set_gpio_input(AT91_PIN_PB0, 1);\r\nat91_set_deglitch(AT91_PIN_PB0, 1);\r\nplatform_device_register(&ek_button_device);\r\n}\r\nstatic void __init ek_add_device_buttons(void) {}\r\nstatic void __init ek_board_init(void)\r\n{\r\nat91_register_uart(0, 0, 0);\r\nat91_register_uart(AT91SAM9RL_ID_US0, 1, ATMEL_UART_CTS | ATMEL_UART_RTS);\r\nat91_add_device_serial();\r\nat91_add_device_usba(&ek_usba_udc_data);\r\nat91_add_device_i2c(NULL, 0);\r\nek_add_device_nand();\r\nat91_add_device_spi(ek_spi_devices, ARRAY_SIZE(ek_spi_devices));\r\nat91_add_device_mci(0, &mci0_data);\r\nat91_add_device_lcdc(&ek_lcdc_data);\r\nat91_add_device_ac97(&ek_ac97_data);\r\nat91_add_device_tsadcc(&ek_tsadcc_data);\r\nat91_gpio_leds(ek_leds, ARRAY_SIZE(ek_leds));\r\nek_add_device_buttons();\r\n}
