static void wrap_power_led_set(struct led_classdev *led_cdev,\r\nenum led_brightness value)\r\n{\r\nif (value)\r\nscx200_gpio_set_low(WRAP_POWER_LED_GPIO);\r\nelse\r\nscx200_gpio_set_high(WRAP_POWER_LED_GPIO);\r\n}\r\nstatic void wrap_error_led_set(struct led_classdev *led_cdev,\r\nenum led_brightness value)\r\n{\r\nif (value)\r\nscx200_gpio_set_low(WRAP_ERROR_LED_GPIO);\r\nelse\r\nscx200_gpio_set_high(WRAP_ERROR_LED_GPIO);\r\n}\r\nstatic void wrap_extra_led_set(struct led_classdev *led_cdev,\r\nenum led_brightness value)\r\n{\r\nif (value)\r\nscx200_gpio_set_low(WRAP_EXTRA_LED_GPIO);\r\nelse\r\nscx200_gpio_set_high(WRAP_EXTRA_LED_GPIO);\r\n}\r\nstatic int wrap_led_probe(struct platform_device *pdev)\r\n{\r\nint ret;\r\nret = led_classdev_register(&pdev->dev, &wrap_power_led);\r\nif (ret < 0)\r\nreturn ret;\r\nret = led_classdev_register(&pdev->dev, &wrap_error_led);\r\nif (ret < 0)\r\ngoto err1;\r\nret = led_classdev_register(&pdev->dev, &wrap_extra_led);\r\nif (ret < 0)\r\ngoto err2;\r\nreturn ret;\r\nerr2:\r\nled_classdev_unregister(&wrap_error_led);\r\nerr1:\r\nled_classdev_unregister(&wrap_power_led);\r\nreturn ret;\r\n}\r\nstatic int wrap_led_remove(struct platform_device *pdev)\r\n{\r\nled_classdev_unregister(&wrap_power_led);\r\nled_classdev_unregister(&wrap_error_led);\r\nled_classdev_unregister(&wrap_extra_led);\r\nreturn 0;\r\n}\r\nstatic int __init wrap_led_init(void)\r\n{\r\nint ret;\r\nif (!scx200_gpio_present()) {\r\nret = -ENODEV;\r\ngoto out;\r\n}\r\nret = platform_driver_register(&wrap_led_driver);\r\nif (ret < 0)\r\ngoto out;\r\npdev = platform_device_register_simple(DRVNAME, -1, NULL, 0);\r\nif (IS_ERR(pdev)) {\r\nret = PTR_ERR(pdev);\r\nplatform_driver_unregister(&wrap_led_driver);\r\ngoto out;\r\n}\r\nout:\r\nreturn ret;\r\n}\r\nstatic void __exit wrap_led_exit(void)\r\n{\r\nplatform_device_unregister(pdev);\r\nplatform_driver_unregister(&wrap_led_driver);\r\n}
