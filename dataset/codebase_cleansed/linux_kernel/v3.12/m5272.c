static void __init m5272_uarts_init(void)\r\n{\r\nu32 v;\r\nv = readl(MCFSIM_PBCNT);\r\nv = (v & ~0x000000ff) | 0x00000055;\r\nwritel(v, MCFSIM_PBCNT);\r\nv = readl(MCFSIM_PDCNT);\r\nv = (v & ~0x000003fc) | 0x000002a8;\r\nwritel(v, MCFSIM_PDCNT);\r\n}\r\nstatic void m5272_cpu_reset(void)\r\n{\r\nlocal_irq_disable();\r\n__raw_writew(0, MCFSIM_WIRR);\r\n__raw_writew(1, MCFSIM_WRRR);\r\n__raw_writew(0, MCFSIM_WCR);\r\nfor (;;)\r\n;\r\n}\r\nvoid __init config_BSP(char *commandp, int size)\r\n{\r\n#if defined (CONFIG_MOD5272)\r\nwriteb(0x40, MCFSIM_PIVR);\r\n#endif\r\n#if defined(CONFIG_NETtel) || defined(CONFIG_SCALES)\r\nmemcpy(commandp, (char *) 0xf0004000, size);\r\ncommandp[size-1] = 0;\r\n#elif defined(CONFIG_CANCam)\r\nmemcpy(commandp, (char *) 0xf0010000, size);\r\ncommandp[size-1] = 0;\r\n#endif\r\nmach_reset = m5272_cpu_reset;\r\nmach_sched_init = hw_timer_init;\r\n}\r\nstatic int __init init_BSP(void)\r\n{\r\nm5272_uarts_init();\r\nfixed_phy_add(PHY_POLL, 0, &nettel_fixed_phy_status);\r\nreturn 0;\r\n}
