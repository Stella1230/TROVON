void rtl8723ae_dm_bt_reject_ap_aggregated_packet(struct ieee80211_hw *hw,\r\nbool reject)\r\n{\r\n}\r\nvoid _rtl8723_dm_bt_check_wifi_state(struct ieee80211_hw *hw)\r\n{\r\nstruct rtl_priv *rtlpriv = rtl_priv(hw);\r\nstruct rtl_pci_priv *rtlpcipriv = rtl_pcipriv(hw);\r\nstruct rtl_phy *rtlphy = &(rtlpriv->phy);\r\nif (rtlpriv->link_info.busytraffic) {\r\nrtlpcipriv->bt_coexist.cstate &= ~BT_COEX_STATE_WIFI_IDLE;\r\nif (rtlpriv->link_info.tx_busy_traffic)\r\nrtlpcipriv->bt_coexist.cstate |=\r\nBT_COEX_STATE_WIFI_UPLINK;\r\nelse\r\nrtlpcipriv->bt_coexist.cstate &=\r\n~BT_COEX_STATE_WIFI_UPLINK;\r\nif (rtlpriv->link_info.rx_busy_traffic)\r\nrtlpcipriv->bt_coexist.cstate |=\r\nBT_COEX_STATE_WIFI_DOWNLINK;\r\nelse\r\nrtlpcipriv->bt_coexist.cstate &=\r\n~BT_COEX_STATE_WIFI_DOWNLINK;\r\n} else {\r\nrtlpcipriv->bt_coexist.cstate |= BT_COEX_STATE_WIFI_IDLE;\r\nrtlpcipriv->bt_coexist.cstate &= ~BT_COEX_STATE_WIFI_UPLINK;\r\nrtlpcipriv->bt_coexist.cstate &= ~BT_COEX_STATE_WIFI_DOWNLINK;\r\n}\r\nif (rtlpriv->mac80211.mode == WIRELESS_MODE_G ||\r\nrtlpriv->mac80211.mode == WIRELESS_MODE_B) {\r\nrtlpcipriv->bt_coexist.cstate |= BT_COEX_STATE_WIFI_LEGACY;\r\nrtlpcipriv->bt_coexist.cstate &= ~BT_COEX_STATE_WIFI_HT20;\r\nrtlpcipriv->bt_coexist.cstate &= ~BT_COEX_STATE_WIFI_HT40;\r\n} else {\r\nrtlpcipriv->bt_coexist.cstate &= ~BT_COEX_STATE_WIFI_LEGACY;\r\nif (rtlphy->current_chan_bw == HT_CHANNEL_WIDTH_20_40) {\r\nrtlpcipriv->bt_coexist.cstate |=\r\nBT_COEX_STATE_WIFI_HT40;\r\nrtlpcipriv->bt_coexist.cstate &=\r\n~BT_COEX_STATE_WIFI_HT20;\r\n} else {\r\nrtlpcipriv->bt_coexist.cstate |=\r\nBT_COEX_STATE_WIFI_HT20;\r\nrtlpcipriv->bt_coexist.cstate &=\r\n~BT_COEX_STATE_WIFI_HT40;\r\n}\r\n}\r\nif (rtlpriv->bt_operation_on)\r\nrtlpcipriv->bt_coexist.cstate |= BT_COEX_STATE_BT30;\r\nelse\r\nrtlpcipriv->bt_coexist.cstate &= ~BT_COEX_STATE_BT30;\r\n}\r\nu8 rtl8723ae_dm_bt_check_coex_rssi_state1(struct ieee80211_hw *hw,\r\nu8 level_num, u8 rssi_thresh,\r\nu8 rssi_thresh1)\r\n{\r\nstruct rtl_pci_priv *rtlpcipriv = rtl_pcipriv(hw);\r\nstruct rtl_priv *rtlpriv = rtl_priv(hw);\r\nlong smooth;\r\nu8 bt_rssi_state = 0;\r\nsmooth = rtl8723ae_dm_bt_get_rx_ss(hw);\r\nif (level_num == 2) {\r\nrtlpcipriv->bt_coexist.cstate &=\r\n~BT_COEX_STATE_WIFI_RSSI_1_MEDIUM;\r\nif ((rtlpcipriv->bt_coexist.bt_pre_rssi_state ==\r\nBT_RSSI_STATE_LOW) ||\r\n(rtlpcipriv->bt_coexist.bt_pre_rssi_state ==\r\nBT_RSSI_STATE_STAY_LOW)) {\r\nif (smooth >= (rssi_thresh +\r\nBT_FW_COEX_THRESH_TOL)) {\r\nbt_rssi_state = BT_RSSI_STATE_HIGH;\r\nrtlpcipriv->bt_coexist.cstate |=\r\nBT_COEX_STATE_WIFI_RSSI_1_HIGH;\r\nrtlpcipriv->bt_coexist.cstate &=\r\n~BT_COEX_STATE_WIFI_RSSI_1_LOW;\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[DM][BT], RSSI_1 state switch to High\n");\r\n} else {\r\nbt_rssi_state = BT_RSSI_STATE_STAY_LOW;\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[DM][BT], RSSI_1 state stay at Low\n");\r\n}\r\n} else {\r\nif (smooth < rssi_thresh) {\r\nbt_rssi_state = BT_RSSI_STATE_LOW;\r\nrtlpcipriv->bt_coexist.cstate |=\r\nBT_COEX_STATE_WIFI_RSSI_1_LOW;\r\nrtlpcipriv->bt_coexist.cstate &=\r\n~BT_COEX_STATE_WIFI_RSSI_1_HIGH;\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[DM][BT], RSSI_1 state switch to Low\n");\r\n} else {\r\nbt_rssi_state = BT_RSSI_STATE_STAY_HIGH;\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[DM][BT], RSSI_1 state stay at High\n");\r\n}\r\n}\r\n} else if (level_num == 3) {\r\nif (rssi_thresh > rssi_thresh1) {\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[DM][BT], RSSI_1 thresh error!!\n");\r\nreturn rtlpcipriv->bt_coexist.bt_pre_rssi_state;\r\n}\r\nif ((rtlpcipriv->bt_coexist.bt_pre_rssi_state ==\r\nBT_RSSI_STATE_LOW) ||\r\n(rtlpcipriv->bt_coexist.bt_pre_rssi_state ==\r\nBT_RSSI_STATE_STAY_LOW)) {\r\nif (smooth >=\r\n(rssi_thresh+BT_FW_COEX_THRESH_TOL)) {\r\nbt_rssi_state = BT_RSSI_STATE_MEDIUM;\r\nrtlpcipriv->bt_coexist.cstate |=\r\nBT_COEX_STATE_WIFI_RSSI_1_MEDIUM;\r\nrtlpcipriv->bt_coexist.cstate &=\r\n~BT_COEX_STATE_WIFI_RSSI_1_LOW;\r\nrtlpcipriv->bt_coexist.cstate &=\r\n~BT_COEX_STATE_WIFI_RSSI_1_HIGH;\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[DM][BT], RSSI_1 state switch to Medium\n");\r\n} else {\r\nbt_rssi_state = BT_RSSI_STATE_STAY_LOW;\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[DM][BT], RSSI_1 state stay at Low\n");\r\n}\r\n} else if ((rtlpcipriv->bt_coexist.bt_pre_rssi_state ==\r\nBT_RSSI_STATE_MEDIUM) ||\r\n(rtlpcipriv->bt_coexist.bt_pre_rssi_state ==\r\nBT_RSSI_STATE_STAY_MEDIUM)) {\r\nif (smooth >= (rssi_thresh1 +\r\nBT_FW_COEX_THRESH_TOL)) {\r\nbt_rssi_state = BT_RSSI_STATE_HIGH;\r\nrtlpcipriv->bt_coexist.cstate |=\r\nBT_COEX_STATE_WIFI_RSSI_1_HIGH;\r\nrtlpcipriv->bt_coexist.cstate &=\r\n~BT_COEX_STATE_WIFI_RSSI_1_LOW;\r\nrtlpcipriv->bt_coexist.cstate &=\r\n~BT_COEX_STATE_WIFI_RSSI_1_MEDIUM;\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[DM][BT], RSSI_1 state switch to High\n");\r\n} else if (smooth < rssi_thresh) {\r\nbt_rssi_state = BT_RSSI_STATE_LOW;\r\nrtlpcipriv->bt_coexist.cstate |=\r\nBT_COEX_STATE_WIFI_RSSI_1_LOW;\r\nrtlpcipriv->bt_coexist.cstate &=\r\n~BT_COEX_STATE_WIFI_RSSI_1_HIGH;\r\nrtlpcipriv->bt_coexist.cstate &=\r\n~BT_COEX_STATE_WIFI_RSSI_1_MEDIUM;\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[DM][BT], RSSI_1 state switch to Low\n");\r\n} else {\r\nbt_rssi_state = BT_RSSI_STATE_STAY_MEDIUM;\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[DM][BT], RSSI_1 state stay at Medium\n");\r\n}\r\n} else {\r\nif (smooth < rssi_thresh1) {\r\nbt_rssi_state = BT_RSSI_STATE_MEDIUM;\r\nrtlpcipriv->bt_coexist.cstate |=\r\nBT_COEX_STATE_WIFI_RSSI_1_MEDIUM;\r\nrtlpcipriv->bt_coexist.cstate &=\r\n~BT_COEX_STATE_WIFI_RSSI_1_HIGH;\r\nrtlpcipriv->bt_coexist.cstate &=\r\n~BT_COEX_STATE_WIFI_RSSI_1_LOW;\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[DM][BT], RSSI_1 state switch to Medium\n");\r\n} else {\r\nbt_rssi_state = BT_RSSI_STATE_STAY_HIGH;\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[DM][BT], RSSI_1 state stay at High\n");\r\n}\r\n}\r\n}\r\nrtlpcipriv->bt_coexist.bt_pre_rssi_state1 = bt_rssi_state;\r\nreturn bt_rssi_state;\r\n}\r\nu8 rtl8723ae_dm_bt_check_coex_rssi_state(struct ieee80211_hw *hw,\r\nu8 level_num, u8 rssi_thresh,\r\nu8 rssi_thresh1)\r\n{\r\nstruct rtl_pci_priv *rtlpcipriv = rtl_pcipriv(hw);\r\nstruct rtl_priv *rtlpriv = rtl_priv(hw);\r\nlong smooth;\r\nu8 bt_rssi_state = 0;\r\nsmooth = rtl8723ae_dm_bt_get_rx_ss(hw);\r\nif (level_num == 2) {\r\nrtlpcipriv->bt_coexist.cstate &=\r\n~BT_COEX_STATE_WIFI_RSSI_MEDIUM;\r\nif ((rtlpcipriv->bt_coexist.bt_pre_rssi_state ==\r\nBT_RSSI_STATE_LOW) ||\r\n(rtlpcipriv->bt_coexist.bt_pre_rssi_state ==\r\nBT_RSSI_STATE_STAY_LOW)){\r\nif (smooth >=\r\n(rssi_thresh + BT_FW_COEX_THRESH_TOL)) {\r\nbt_rssi_state = BT_RSSI_STATE_HIGH;\r\nrtlpcipriv->bt_coexist.cstate |=\r\nBT_COEX_STATE_WIFI_RSSI_HIGH;\r\nrtlpcipriv->bt_coexist.cstate &=\r\n~BT_COEX_STATE_WIFI_RSSI_LOW;\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[DM][BT], RSSI state switch to High\n");\r\n} else {\r\nbt_rssi_state = BT_RSSI_STATE_STAY_LOW;\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[DM][BT], RSSI state stay at Low\n");\r\n}\r\n} else {\r\nif (smooth < rssi_thresh) {\r\nbt_rssi_state = BT_RSSI_STATE_LOW;\r\nrtlpcipriv->bt_coexist.cstate |=\r\nBT_COEX_STATE_WIFI_RSSI_LOW;\r\nrtlpcipriv->bt_coexist.cstate &=\r\n~BT_COEX_STATE_WIFI_RSSI_HIGH;\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[DM][BT], RSSI state switch to Low\n");\r\n} else {\r\nbt_rssi_state = BT_RSSI_STATE_STAY_HIGH;\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[DM][BT], RSSI state stay at High\n");\r\n}\r\n}\r\n} else if (level_num == 3) {\r\nif (rssi_thresh > rssi_thresh1) {\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[DM][BT], RSSI thresh error!!\n");\r\nreturn rtlpcipriv->bt_coexist.bt_pre_rssi_state;\r\n}\r\nif ((rtlpcipriv->bt_coexist.bt_pre_rssi_state ==\r\nBT_RSSI_STATE_LOW) ||\r\n(rtlpcipriv->bt_coexist.bt_pre_rssi_state ==\r\nBT_RSSI_STATE_STAY_LOW)) {\r\nif (smooth >=\r\n(rssi_thresh + BT_FW_COEX_THRESH_TOL)) {\r\nbt_rssi_state = BT_RSSI_STATE_MEDIUM;\r\nrtlpcipriv->bt_coexist.cstate\r\n|= BT_COEX_STATE_WIFI_RSSI_MEDIUM;\r\nrtlpcipriv->bt_coexist.cstate\r\n&= ~BT_COEX_STATE_WIFI_RSSI_LOW;\r\nrtlpcipriv->bt_coexist.cstate\r\n&= ~BT_COEX_STATE_WIFI_RSSI_HIGH;\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[DM][BT], RSSI state switch to Medium\n");\r\n} else {\r\nbt_rssi_state = BT_RSSI_STATE_STAY_LOW;\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[DM][BT], RSSI state stay at Low\n");\r\n}\r\n} else if ((rtlpcipriv->bt_coexist.bt_pre_rssi_state ==\r\nBT_RSSI_STATE_MEDIUM) ||\r\n(rtlpcipriv->bt_coexist.bt_pre_rssi_state ==\r\nBT_RSSI_STATE_STAY_MEDIUM)) {\r\nif (smooth >=\r\n(rssi_thresh1 + BT_FW_COEX_THRESH_TOL)) {\r\nbt_rssi_state = BT_RSSI_STATE_HIGH;\r\nrtlpcipriv->bt_coexist.cstate\r\n|= BT_COEX_STATE_WIFI_RSSI_HIGH;\r\nrtlpcipriv->bt_coexist.cstate\r\n&= ~BT_COEX_STATE_WIFI_RSSI_LOW;\r\nrtlpcipriv->bt_coexist.cstate\r\n&= ~BT_COEX_STATE_WIFI_RSSI_MEDIUM;\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[DM][BT], RSSI state switch to High\n");\r\n} else if (smooth < rssi_thresh) {\r\nbt_rssi_state = BT_RSSI_STATE_LOW;\r\nrtlpcipriv->bt_coexist.cstate\r\n|= BT_COEX_STATE_WIFI_RSSI_LOW;\r\nrtlpcipriv->bt_coexist.cstate\r\n&= ~BT_COEX_STATE_WIFI_RSSI_HIGH;\r\nrtlpcipriv->bt_coexist.cstate\r\n&= ~BT_COEX_STATE_WIFI_RSSI_MEDIUM;\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[DM][BT], RSSI state switch to Low\n");\r\n} else {\r\nbt_rssi_state = BT_RSSI_STATE_STAY_MEDIUM;\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[DM][BT], RSSI state stay at Medium\n");\r\n}\r\n} else {\r\nif (smooth < rssi_thresh1) {\r\nbt_rssi_state = BT_RSSI_STATE_MEDIUM;\r\nrtlpcipriv->bt_coexist.cstate\r\n|= BT_COEX_STATE_WIFI_RSSI_MEDIUM;\r\nrtlpcipriv->bt_coexist.cstate\r\n&= ~BT_COEX_STATE_WIFI_RSSI_HIGH;\r\nrtlpcipriv->bt_coexist.cstate\r\n&= ~BT_COEX_STATE_WIFI_RSSI_LOW;\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[DM][BT], RSSI state switch to Medium\n");\r\n} else {\r\nbt_rssi_state = BT_RSSI_STATE_STAY_HIGH;\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[DM][BT], RSSI state stay at High\n");\r\n}\r\n}\r\n}\r\nrtlpcipriv->bt_coexist.bt_pre_rssi_state = bt_rssi_state;\r\nreturn bt_rssi_state;\r\n}\r\nlong rtl8723ae_dm_bt_get_rx_ss(struct ieee80211_hw *hw)\r\n{\r\nstruct rtl_priv *rtlpriv = rtl_priv(hw);\r\nlong smooth = 0;\r\nif (rtlpriv->mac80211.link_state >= MAC80211_LINKED)\r\nsmooth = GET_UNDECORATED_AVERAGE_RSSI(rtlpriv);\r\nelse\r\nsmooth = rtlpriv->dm.entry_min_undec_sm_pwdb;\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"rtl8723ae_dm_bt_get_rx_ss() = %ld\n", smooth);\r\nreturn smooth;\r\n}\r\nvoid rtl8723ae_dm_bt_balance(struct ieee80211_hw *hw,\r\nbool balance_on, u8 ms0, u8 ms1)\r\n{\r\nstruct rtl_pci_priv *rtlpcipriv = rtl_pcipriv(hw);\r\nstruct rtl_priv *rtlpriv = rtl_priv(hw);\r\nu8 h2c_parameter[3] = {0};\r\nif (balance_on) {\r\nh2c_parameter[2] = 1;\r\nh2c_parameter[1] = ms1;\r\nh2c_parameter[0] = ms0;\r\nrtlpcipriv->bt_coexist.fw_coexist_all_off = false;\r\n} else {\r\nh2c_parameter[2] = 0;\r\nh2c_parameter[1] = 0;\r\nh2c_parameter[0] = 0;\r\n}\r\nrtlpcipriv->bt_coexist.balance_on = balance_on;\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[DM][BT], Balance=[%s:%dms:%dms], write 0xc=0x%x\n",\r\nbalance_on ? "ON" : "OFF", ms0, ms1,\r\nh2c_parameter[0]<<16 | h2c_parameter[1]<<8 | h2c_parameter[2]);\r\nrtl8723ae_fill_h2c_cmd(hw, 0xc, 3, h2c_parameter);\r\n}\r\nvoid rtl8723ae_dm_bt_agc_table(struct ieee80211_hw *hw, u8 type)\r\n{\r\nstruct rtl_priv *rtlpriv = rtl_priv(hw);\r\nstruct rtl_pci_priv *rtlpcipriv = rtl_pcipriv(hw);\r\nif (type == BT_AGCTABLE_OFF) {\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[BT]AGCTable Off!\n");\r\nrtl_write_dword(rtlpriv, 0xc78, 0x641c0001);\r\nrtl_write_dword(rtlpriv, 0xc78, 0x631d0001);\r\nrtl_write_dword(rtlpriv, 0xc78, 0x621e0001);\r\nrtl_write_dword(rtlpriv, 0xc78, 0x611f0001);\r\nrtl_write_dword(rtlpriv, 0xc78, 0x60200001);\r\nrtl8723ae_phy_set_rf_reg(hw, RF90_PATH_A,\r\nRF_RX_AGC_HP, 0xfffff, 0x32000);\r\nrtl8723ae_phy_set_rf_reg(hw, RF90_PATH_A,\r\nRF_RX_AGC_HP, 0xfffff, 0x71000);\r\nrtl8723ae_phy_set_rf_reg(hw, RF90_PATH_A,\r\nRF_RX_AGC_HP, 0xfffff, 0xb0000);\r\nrtl8723ae_phy_set_rf_reg(hw, RF90_PATH_A,\r\nRF_RX_AGC_HP, 0xfffff, 0xfc000);\r\nrtl8723ae_phy_set_rf_reg(hw, RF90_PATH_A,\r\nRF_RX_G1, 0xfffff, 0x30355);\r\n} else if (type == BT_AGCTABLE_ON) {\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[BT]AGCTable On!\n");\r\nrtl_write_dword(rtlpriv, 0xc78, 0x4e1c0001);\r\nrtl_write_dword(rtlpriv, 0xc78, 0x4d1d0001);\r\nrtl_write_dword(rtlpriv, 0xc78, 0x4c1e0001);\r\nrtl_write_dword(rtlpriv, 0xc78, 0x4b1f0001);\r\nrtl_write_dword(rtlpriv, 0xc78, 0x4a200001);\r\nrtl8723ae_phy_set_rf_reg(hw, RF90_PATH_A,\r\nRF_RX_AGC_HP, 0xfffff, 0xdc000);\r\nrtl8723ae_phy_set_rf_reg(hw, RF90_PATH_A,\r\nRF_RX_AGC_HP, 0xfffff, 0x90000);\r\nrtl8723ae_phy_set_rf_reg(hw, RF90_PATH_A,\r\nRF_RX_AGC_HP, 0xfffff, 0x51000);\r\nrtl8723ae_phy_set_rf_reg(hw, RF90_PATH_A,\r\nRF_RX_AGC_HP, 0xfffff, 0x12000);\r\nrtl8723ae_phy_set_rf_reg(hw, RF90_PATH_A,\r\nRF_RX_G1, 0xfffff, 0x00355);\r\nrtlpcipriv->bt_coexist.sw_coexist_all_off = false;\r\n}\r\n}\r\nvoid rtl8723ae_dm_bt_bback_off_level(struct ieee80211_hw *hw, u8 type)\r\n{\r\nstruct rtl_priv *rtlpriv = rtl_priv(hw);\r\nstruct rtl_pci_priv *rtlpcipriv = rtl_pcipriv(hw);\r\nif (type == BT_BB_BACKOFF_OFF) {\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[BT]BBBackOffLevel Off!\n");\r\nrtl_write_dword(rtlpriv, 0xc04, 0x3a05611);\r\n} else if (type == BT_BB_BACKOFF_ON) {\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"[BT]BBBackOffLevel On!\n");\r\nrtl_write_dword(rtlpriv, 0xc04, 0x3a07611);\r\nrtlpcipriv->bt_coexist.sw_coexist_all_off = false;\r\n}\r\n}\r\nvoid rtl8723ae_dm_bt_fw_coex_all_off(struct ieee80211_hw *hw)\r\n{\r\nstruct rtl_pci_priv *rtlpcipriv = rtl_pcipriv(hw);\r\nstruct rtl_priv *rtlpriv = rtl_priv(hw);\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"rtl8723ae_dm_bt_fw_coex_all_off()\n");\r\nif (rtlpcipriv->bt_coexist.fw_coexist_all_off)\r\nreturn;\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"rtl8723ae_dm_bt_fw_coex_all_off(), real Do\n");\r\nrtl8723ae_dm_bt_fw_coex_all_off_8723a(hw);\r\nrtlpcipriv->bt_coexist.fw_coexist_all_off = true;\r\n}\r\nvoid rtl8723ae_dm_bt_sw_coex_all_off(struct ieee80211_hw *hw)\r\n{\r\nstruct rtl_pci_priv *rtlpcipriv = rtl_pcipriv(hw);\r\nstruct rtl_priv *rtlpriv = rtl_priv(hw);\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"rtl8723ae_dm_bt_sw_coex_all_off()\n");\r\nif (rtlpcipriv->bt_coexist.sw_coexist_all_off)\r\nreturn;\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"rtl8723ae_dm_bt_sw_coex_all_off(), real Do\n");\r\nrtl8723ae_dm_bt_sw_coex_all_off_8723a(hw);\r\nrtlpcipriv->bt_coexist.sw_coexist_all_off = true;\r\n}\r\nvoid rtl8723ae_dm_bt_hw_coex_all_off(struct ieee80211_hw *hw)\r\n{\r\nstruct rtl_pci_priv *rtlpcipriv = rtl_pcipriv(hw);\r\nstruct rtl_priv *rtlpriv = rtl_priv(hw);\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"rtl8723ae_dm_bt_hw_coex_all_off()\n");\r\nif (rtlpcipriv->bt_coexist.hw_coexist_all_off)\r\nreturn;\r\nRT_TRACE(rtlpriv, COMP_BT_COEXIST, DBG_TRACE,\r\n"rtl8723ae_dm_bt_hw_coex_all_off(), real Do\n");\r\nrtl8723ae_dm_bt_hw_coex_all_off_8723a(hw);\r\nrtlpcipriv->bt_coexist.hw_coexist_all_off = true;\r\n}\r\nvoid rtl8723ae_btdm_coex_all_off(struct ieee80211_hw *hw)\r\n{\r\nrtl8723ae_dm_bt_fw_coex_all_off(hw);\r\nrtl8723ae_dm_bt_sw_coex_all_off(hw);\r\nrtl8723ae_dm_bt_hw_coex_all_off(hw);\r\n}\r\nbool rtl8723ae_dm_bt_is_coexist_state_changed(struct ieee80211_hw *hw)\r\n{\r\nstruct rtl_pci_priv *rtlpcipriv = rtl_pcipriv(hw);\r\nif ((rtlpcipriv->bt_coexist.previous_state ==\r\nrtlpcipriv->bt_coexist.cstate) &&\r\n(rtlpcipriv->bt_coexist.previous_state_h ==\r\nrtlpcipriv->bt_coexist.cstate_h))\r\nreturn false;\r\nelse\r\nreturn true;\r\n}\r\nbool rtl8723ae_dm_bt_is_wifi_up_link(struct ieee80211_hw *hw)\r\n{\r\nstruct rtl_priv *rtlpriv = rtl_priv(hw);\r\nif (rtlpriv->link_info.tx_busy_traffic)\r\nreturn true;\r\nelse\r\nreturn false;\r\n}
