static unsigned long pll_recalc(struct clk *clk)\r\n{\r\nunsigned long rate = clk->parent->rate / pll1_div;\r\nreturn rate * pll1rate[(__raw_readw(FRQCR) >> 8) & 1];\r\n}\r\nint __init arch_clk_init(void)\r\n{\r\nint k, ret = 0;\r\nif (test_mode_pin(MODE_PIN0)) {\r\nif (test_mode_pin(MODE_PIN1))\r\npll1_div = 3;\r\nelse\r\npll1_div = 4;\r\n} else\r\npll1_div = 1;\r\nfor (k = 0; !ret && (k < ARRAY_SIZE(main_clks)); k++)\r\nret = clk_register(main_clks[k]);\r\nclkdev_add_table(lookups, ARRAY_SIZE(lookups));\r\nif (!ret)\r\nret = sh_clk_div4_register(div4_clks, DIV4_NR, &div4_table);\r\nif (!ret)\r\nret = sh_clk_mstp_register(mstp_clks, MSTP_NR);\r\nreturn ret;\r\n}
