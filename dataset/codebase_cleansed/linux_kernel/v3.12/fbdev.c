int fb_is_primary_device(struct fb_info *info)\r\n{\r\nstruct device *device = info->device;\r\nstruct pci_dev *pci_dev = NULL;\r\nstruct pci_dev *default_device = vga_default_device();\r\nstruct resource *res = NULL;\r\nif (device)\r\npci_dev = to_pci_dev(device);\r\nif (!pci_dev)\r\nreturn 0;\r\nif (default_device) {\r\nif (pci_dev == default_device)\r\nreturn 1;\r\nelse\r\nreturn 0;\r\n}\r\nres = &pci_dev->resource[PCI_ROM_RESOURCE];\r\nif (res && res->flags & IORESOURCE_ROM_SHADOW)\r\nreturn 1;\r\nreturn 0;\r\n}
