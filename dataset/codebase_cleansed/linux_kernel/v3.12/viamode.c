static const struct fb_videomode *get_best_mode(\r\nconst struct fb_videomode *modes, int n,\r\nint hres, int vres, int refresh)\r\n{\r\nconst struct fb_videomode *best = NULL;\r\nint i;\r\nfor (i = 0; i < n; i++) {\r\nif (modes[i].xres != hres || modes[i].yres != vres)\r\ncontinue;\r\nif (!best || abs(modes[i].refresh - refresh) <\r\nabs(best->refresh - refresh))\r\nbest = &modes[i];\r\n}\r\nreturn best;\r\n}\r\nconst struct fb_videomode *viafb_get_best_mode(int hres, int vres, int refresh)\r\n{\r\nreturn get_best_mode(viafb_modes, ARRAY_SIZE(viafb_modes),\r\nhres, vres, refresh);\r\n}\r\nconst struct fb_videomode *viafb_get_best_rb_mode(int hres, int vres,\r\nint refresh)\r\n{\r\nreturn get_best_mode(viafb_rb_modes, ARRAY_SIZE(viafb_rb_modes),\r\nhres, vres, refresh);\r\n}
