static void ip27_machine_restart(char *command)\r\n{\r\n#if 0\r\nint i;\r\n#endif\r\nprintk("Reboot started from CPU %d\n", smp_processor_id());\r\n#ifdef CONFIG_SMP\r\nsmp_send_stop();\r\n#endif\r\n#if 0\r\nfor_each_online_node(i)\r\nREMOTE_HUB_S(COMPACT_TO_NASID_NODEID(i), PROMOP_REG,\r\nPROMOP_REBOOT);\r\n#else\r\nLOCAL_HUB_S(NI_PORT_RESET, NPR_PORTRESET | NPR_LOCALRESET);\r\n#endif\r\nnoreturn;\r\n}\r\nstatic void ip27_machine_halt(void)\r\n{\r\nint i;\r\n#ifdef CONFIG_SMP\r\nsmp_send_stop();\r\n#endif\r\nfor_each_online_node(i)\r\nREMOTE_HUB_S(COMPACT_TO_NASID_NODEID(i), PROMOP_REG,\r\nPROMOP_RESTART);\r\nLOCAL_HUB_S(NI_PORT_RESET, NPR_PORTRESET | NPR_LOCALRESET);\r\nnoreturn;\r\n}\r\nstatic void ip27_machine_power_off(void)\r\n{\r\nnoreturn;\r\n}\r\nvoid ip27_reboot_setup(void)\r\n{\r\n_machine_restart = ip27_machine_restart;\r\n_machine_halt = ip27_machine_halt;\r\npm_power_off = ip27_machine_power_off;\r\n}
