static void restart_poweroff_do_poweroff(void)\r\n{\r\narm_pm_restart(REBOOT_HARD, NULL);\r\n}\r\nstatic int restart_poweroff_probe(struct platform_device *pdev)\r\n{\r\nif (pm_power_off != NULL) {\r\ndev_err(&pdev->dev,\r\n"pm_power_off function already registered");\r\nreturn -EBUSY;\r\n}\r\npm_power_off = &restart_poweroff_do_poweroff;\r\nreturn 0;\r\n}\r\nstatic int restart_poweroff_remove(struct platform_device *pdev)\r\n{\r\nif (pm_power_off == &restart_poweroff_do_poweroff)\r\npm_power_off = NULL;\r\nreturn 0;\r\n}
