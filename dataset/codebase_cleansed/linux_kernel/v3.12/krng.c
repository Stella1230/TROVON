static int krng_get_random(struct crypto_rng *tfm, u8 *rdata, unsigned int dlen)\r\n{\r\nget_random_bytes(rdata, dlen);\r\nreturn 0;\r\n}\r\nstatic int krng_reset(struct crypto_rng *tfm, u8 *seed, unsigned int slen)\r\n{\r\nreturn 0;\r\n}\r\nstatic int __init krng_mod_init(void)\r\n{\r\nreturn crypto_register_alg(&krng_alg);\r\n}\r\nstatic void __exit krng_mod_fini(void)\r\n{\r\ncrypto_unregister_alg(&krng_alg);\r\nreturn;\r\n}
