struct fp_ext *\r\nfp_fsqrt(struct fp_ext *dest, struct fp_ext *src)\r\n{\r\nstruct fp_ext tmp, src2;\r\nint i, exp;\r\ndprint(PINSTR, "fsqrt\n");\r\nfp_monadic_check(dest, src);\r\nif (IS_ZERO(dest))\r\nreturn dest;\r\nif (dest->sign) {\r\nfp_set_nan(dest);\r\nreturn dest;\r\n}\r\nif (IS_INF(dest))\r\nreturn dest;\r\nexp = dest->exp;\r\ndest->exp = 0x3FFF;\r\nif (!(exp & 1))\r\ndest->exp++;\r\nfp_copy_ext(&src2, dest);\r\nfp_fadd(dest, &fp_one);\r\ndest->exp--;\r\nfor (i = 0; i < 9; i++) {\r\nfp_copy_ext(&tmp, &src2);\r\nfp_fdiv(&tmp, dest);\r\nfp_fadd(dest, &tmp);\r\ndest->exp--;\r\n}\r\ndest->exp += (exp - 0x3FFF) / 2;\r\nreturn dest;\r\n}\r\nstruct fp_ext *\r\nfp_fetoxm1(struct fp_ext *dest, struct fp_ext *src)\r\n{\r\nuprint("fetoxm1\n");\r\nfp_monadic_check(dest, src);\r\nreturn dest;\r\n}\r\nstruct fp_ext *\r\nfp_fetox(struct fp_ext *dest, struct fp_ext *src)\r\n{\r\nuprint("fetox\n");\r\nfp_monadic_check(dest, src);\r\nreturn dest;\r\n}\r\nstruct fp_ext *\r\nfp_ftwotox(struct fp_ext *dest, struct fp_ext *src)\r\n{\r\nuprint("ftwotox\n");\r\nfp_monadic_check(dest, src);\r\nreturn dest;\r\n}\r\nstruct fp_ext *\r\nfp_ftentox(struct fp_ext *dest, struct fp_ext *src)\r\n{\r\nuprint("ftentox\n");\r\nfp_monadic_check(dest, src);\r\nreturn dest;\r\n}\r\nstruct fp_ext *\r\nfp_flogn(struct fp_ext *dest, struct fp_ext *src)\r\n{\r\nuprint("flogn\n");\r\nfp_monadic_check(dest, src);\r\nreturn dest;\r\n}\r\nstruct fp_ext *\r\nfp_flognp1(struct fp_ext *dest, struct fp_ext *src)\r\n{\r\nuprint("flognp1\n");\r\nfp_monadic_check(dest, src);\r\nreturn dest;\r\n}\r\nstruct fp_ext *\r\nfp_flog10(struct fp_ext *dest, struct fp_ext *src)\r\n{\r\nuprint("flog10\n");\r\nfp_monadic_check(dest, src);\r\nreturn dest;\r\n}\r\nstruct fp_ext *\r\nfp_flog2(struct fp_ext *dest, struct fp_ext *src)\r\n{\r\nuprint("flog2\n");\r\nfp_monadic_check(dest, src);\r\nreturn dest;\r\n}\r\nstruct fp_ext *\r\nfp_fgetexp(struct fp_ext *dest, struct fp_ext *src)\r\n{\r\ndprint(PINSTR, "fgetexp\n");\r\nfp_monadic_check(dest, src);\r\nif (IS_INF(dest)) {\r\nfp_set_nan(dest);\r\nreturn dest;\r\n}\r\nif (IS_ZERO(dest))\r\nreturn dest;\r\nfp_conv_long2ext(dest, (int)dest->exp - 0x3FFF);\r\nfp_normalize_ext(dest);\r\nreturn dest;\r\n}\r\nstruct fp_ext *\r\nfp_fgetman(struct fp_ext *dest, struct fp_ext *src)\r\n{\r\ndprint(PINSTR, "fgetman\n");\r\nfp_monadic_check(dest, src);\r\nif (IS_ZERO(dest))\r\nreturn dest;\r\nif (IS_INF(dest))\r\nreturn dest;\r\ndest->exp = 0x3FFF;\r\nreturn dest;\r\n}
