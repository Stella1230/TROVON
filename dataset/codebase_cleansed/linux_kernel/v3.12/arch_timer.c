static unsigned long arch_timer_read_counter_long(void)\r\n{\r\nreturn arch_timer_read_counter();\r\n}\r\nstatic unsigned long long notrace arch_timer_sched_clock(void)\r\n{\r\nreturn arch_timer_read_counter() * sched_clock_mult;\r\n}\r\nstatic void __init arch_timer_delay_timer_register(void)\r\n{\r\narch_delay_timer.read_current_timer = arch_timer_read_counter_long;\r\narch_delay_timer.freq = arch_timer_get_rate();\r\nregister_current_timer_delay(&arch_delay_timer);\r\n}\r\nint __init arch_timer_arch_init(void)\r\n{\r\nu32 arch_timer_rate = arch_timer_get_rate();\r\nif (arch_timer_rate == 0)\r\nreturn -ENXIO;\r\narch_timer_delay_timer_register();\r\nsched_clock_mult = NSEC_PER_SEC / arch_timer_rate;\r\nsched_clock_func = arch_timer_sched_clock;\r\npr_info("sched_clock: ARM arch timer >56 bits at %ukHz, resolution %uns\n",\r\narch_timer_rate / 1000, sched_clock_mult);\r\nreturn 0;\r\n}
