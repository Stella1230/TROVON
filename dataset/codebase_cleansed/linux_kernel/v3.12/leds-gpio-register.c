struct platform_device *__init gpio_led_register_device(\r\nint id, const struct gpio_led_platform_data *pdata)\r\n{\r\nstruct platform_device *ret;\r\nstruct gpio_led_platform_data _pdata = *pdata;\r\n_pdata.leds = kmemdup(pdata->leds,\r\npdata->num_leds * sizeof(*pdata->leds), GFP_KERNEL);\r\nif (!_pdata.leds)\r\nreturn ERR_PTR(-ENOMEM);\r\nret = platform_device_register_resndata(NULL, "leds-gpio", id,\r\nNULL, 0, &_pdata, sizeof(_pdata));\r\nif (IS_ERR(ret))\r\nkfree(_pdata.leds);\r\nreturn ret;\r\n}
