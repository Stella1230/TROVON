static inline union ieee754dp ieee754dp_nan_fsp(int xs, u64 xm)\r\n{\r\nreturn builddp(xs, DP_EMAX + 1 + DP_EBIAS,\r\nxm << (DP_FBITS - SP_FBITS));\r\n}\r\nunion ieee754dp ieee754dp_fsp(union ieee754sp x)\r\n{\r\nCOMPXSP;\r\nEXPLODEXSP;\r\nieee754_clearcx();\r\nFLUSHXSP;\r\nswitch (xc) {\r\ncase IEEE754_CLASS_SNAN:\r\nreturn ieee754dp_nanxcpt(ieee754dp_nan_fsp(xs, xm));\r\ncase IEEE754_CLASS_QNAN:\r\nreturn ieee754dp_nan_fsp(xs, xm);\r\ncase IEEE754_CLASS_INF:\r\nreturn ieee754dp_inf(xs);\r\ncase IEEE754_CLASS_ZERO:\r\nreturn ieee754dp_zero(xs);\r\ncase IEEE754_CLASS_DNORM:\r\nwhile ((xm >> SP_FBITS) == 0) {\r\nxm <<= 1;\r\nxe--;\r\n}\r\nbreak;\r\ncase IEEE754_CLASS_NORM:\r\nbreak;\r\n}\r\nxm &= ~SP_HIDDEN_BIT;\r\nreturn builddp(xs, xe + DP_EBIAS,\r\n(u64) xm << (DP_FBITS - SP_FBITS));\r\n}
