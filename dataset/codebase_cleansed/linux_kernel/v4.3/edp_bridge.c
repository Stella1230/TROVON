void edp_bridge_destroy(struct drm_bridge *bridge)\r\n{\r\n}\r\nstatic void edp_bridge_pre_enable(struct drm_bridge *bridge)\r\n{\r\nstruct edp_bridge *edp_bridge = to_edp_bridge(bridge);\r\nstruct msm_edp *edp = edp_bridge->edp;\r\nDBG("");\r\nmsm_edp_ctrl_power(edp->ctrl, true);\r\n}\r\nstatic void edp_bridge_enable(struct drm_bridge *bridge)\r\n{\r\nDBG("");\r\n}\r\nstatic void edp_bridge_disable(struct drm_bridge *bridge)\r\n{\r\nDBG("");\r\n}\r\nstatic void edp_bridge_post_disable(struct drm_bridge *bridge)\r\n{\r\nstruct edp_bridge *edp_bridge = to_edp_bridge(bridge);\r\nstruct msm_edp *edp = edp_bridge->edp;\r\nDBG("");\r\nmsm_edp_ctrl_power(edp->ctrl, false);\r\n}\r\nstatic void edp_bridge_mode_set(struct drm_bridge *bridge,\r\nstruct drm_display_mode *mode,\r\nstruct drm_display_mode *adjusted_mode)\r\n{\r\nstruct drm_device *dev = bridge->dev;\r\nstruct drm_connector *connector;\r\nstruct edp_bridge *edp_bridge = to_edp_bridge(bridge);\r\nstruct msm_edp *edp = edp_bridge->edp;\r\nDBG("set mode: %d:\"%s\" %d %d %d %d %d %d %d %d %d %d 0x%x 0x%x",\r\nmode->base.id, mode->name,\r\nmode->vrefresh, mode->clock,\r\nmode->hdisplay, mode->hsync_start,\r\nmode->hsync_end, mode->htotal,\r\nmode->vdisplay, mode->vsync_start,\r\nmode->vsync_end, mode->vtotal,\r\nmode->type, mode->flags);\r\nlist_for_each_entry(connector, &dev->mode_config.connector_list, head) {\r\nif ((connector->encoder != NULL) &&\r\n(connector->encoder->bridge == bridge)) {\r\nmsm_edp_ctrl_timing_cfg(edp->ctrl,\r\nadjusted_mode, &connector->display_info);\r\nbreak;\r\n}\r\n}\r\n}\r\nstruct drm_bridge *msm_edp_bridge_init(struct msm_edp *edp)\r\n{\r\nstruct drm_bridge *bridge = NULL;\r\nstruct edp_bridge *edp_bridge;\r\nint ret;\r\nedp_bridge = devm_kzalloc(edp->dev->dev,\r\nsizeof(*edp_bridge), GFP_KERNEL);\r\nif (!edp_bridge) {\r\nret = -ENOMEM;\r\ngoto fail;\r\n}\r\nedp_bridge->edp = edp;\r\nbridge = &edp_bridge->base;\r\nbridge->funcs = &edp_bridge_funcs;\r\nret = drm_bridge_attach(edp->dev, bridge);\r\nif (ret)\r\ngoto fail;\r\nreturn bridge;\r\nfail:\r\nif (bridge)\r\nedp_bridge_destroy(bridge);\r\nreturn ERR_PTR(ret);\r\n}
