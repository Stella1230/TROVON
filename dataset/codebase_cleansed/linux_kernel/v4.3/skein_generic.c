static int skein256_init(struct shash_desc *desc)\r\n{\r\nreturn skein_256_init((struct skein_256_ctx *) shash_desc_ctx(desc),\r\nSKEIN256_DIGEST_BIT_SIZE);\r\n}\r\nstatic int skein256_update(struct shash_desc *desc, const u8 *data,\r\nunsigned int len)\r\n{\r\nreturn skein_256_update((struct skein_256_ctx *)shash_desc_ctx(desc),\r\ndata, len);\r\n}\r\nstatic int skein256_final(struct shash_desc *desc, u8 *out)\r\n{\r\nreturn skein_256_final((struct skein_256_ctx *)shash_desc_ctx(desc),\r\nout);\r\n}\r\nstatic int skein256_export(struct shash_desc *desc, void *out)\r\n{\r\nstruct skein_256_ctx *sctx = shash_desc_ctx(desc);\r\nmemcpy(out, sctx, sizeof(*sctx));\r\nreturn 0;\r\n}\r\nstatic int skein256_import(struct shash_desc *desc, const void *in)\r\n{\r\nstruct skein_256_ctx *sctx = shash_desc_ctx(desc);\r\nmemcpy(sctx, in, sizeof(*sctx));\r\nreturn 0;\r\n}\r\nstatic int skein512_init(struct shash_desc *desc)\r\n{\r\nreturn skein_512_init((struct skein_512_ctx *)shash_desc_ctx(desc),\r\nSKEIN512_DIGEST_BIT_SIZE);\r\n}\r\nstatic int skein512_update(struct shash_desc *desc, const u8 *data,\r\nunsigned int len)\r\n{\r\nreturn skein_512_update((struct skein_512_ctx *)shash_desc_ctx(desc),\r\ndata, len);\r\n}\r\nstatic int skein512_final(struct shash_desc *desc, u8 *out)\r\n{\r\nreturn skein_512_final((struct skein_512_ctx *)shash_desc_ctx(desc),\r\nout);\r\n}\r\nstatic int skein512_export(struct shash_desc *desc, void *out)\r\n{\r\nstruct skein_512_ctx *sctx = shash_desc_ctx(desc);\r\nmemcpy(out, sctx, sizeof(*sctx));\r\nreturn 0;\r\n}\r\nstatic int skein512_import(struct shash_desc *desc, const void *in)\r\n{\r\nstruct skein_512_ctx *sctx = shash_desc_ctx(desc);\r\nmemcpy(sctx, in, sizeof(*sctx));\r\nreturn 0;\r\n}\r\nstatic int skein1024_init(struct shash_desc *desc)\r\n{\r\nreturn skein_1024_init((struct skein_1024_ctx *)shash_desc_ctx(desc),\r\nSKEIN1024_DIGEST_BIT_SIZE);\r\n}\r\nstatic int skein1024_update(struct shash_desc *desc, const u8 *data,\r\nunsigned int len)\r\n{\r\nreturn skein_1024_update((struct skein_1024_ctx *)shash_desc_ctx(desc),\r\ndata, len);\r\n}\r\nstatic int skein1024_final(struct shash_desc *desc, u8 *out)\r\n{\r\nreturn skein_1024_final((struct skein_1024_ctx *)shash_desc_ctx(desc),\r\nout);\r\n}\r\nstatic int skein1024_export(struct shash_desc *desc, void *out)\r\n{\r\nstruct skein_1024_ctx *sctx = shash_desc_ctx(desc);\r\nmemcpy(out, sctx, sizeof(*sctx));\r\nreturn 0;\r\n}\r\nstatic int skein1024_import(struct shash_desc *desc, const void *in)\r\n{\r\nstruct skein_1024_ctx *sctx = shash_desc_ctx(desc);\r\nmemcpy(sctx, in, sizeof(*sctx));\r\nreturn 0;\r\n}\r\nstatic int __init skein_generic_init(void)\r\n{\r\nif (crypto_register_shash(&alg256))\r\ngoto out;\r\nif (crypto_register_shash(&alg512))\r\ngoto unreg256;\r\nif (crypto_register_shash(&alg1024))\r\ngoto unreg512;\r\nreturn 0;\r\nunreg512:\r\ncrypto_unregister_shash(&alg512);\r\nunreg256:\r\ncrypto_unregister_shash(&alg256);\r\nout:\r\nreturn -1;\r\n}\r\nstatic void __exit skein_generic_fini(void)\r\n{\r\ncrypto_unregister_shash(&alg256);\r\ncrypto_unregister_shash(&alg512);\r\ncrypto_unregister_shash(&alg1024);\r\n}
