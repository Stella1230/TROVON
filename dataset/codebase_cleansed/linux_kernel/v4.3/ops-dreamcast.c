static int gapspci_config_access(unsigned char bus, unsigned int devfn)\r\n{\r\nreturn (bus == 0) && (devfn == 0);\r\n}\r\nstatic int gapspci_read(struct pci_bus *bus, unsigned int devfn, int where, int size, u32 *val)\r\n{\r\n*val = 0xffffffff;\r\nif (!gapspci_config_access(bus->number, devfn))\r\nreturn PCIBIOS_DEVICE_NOT_FOUND;\r\nswitch (size) {\r\ncase 1: *val = inb(GAPSPCI_BBA_CONFIG+where); break;\r\ncase 2: *val = inw(GAPSPCI_BBA_CONFIG+where); break;\r\ncase 4: *val = inl(GAPSPCI_BBA_CONFIG+where); break;\r\n}\r\nreturn PCIBIOS_SUCCESSFUL;\r\n}\r\nstatic int gapspci_write(struct pci_bus *bus, unsigned int devfn, int where, int size, u32 val)\r\n{\r\nif (!gapspci_config_access(bus->number, devfn))\r\nreturn PCIBIOS_DEVICE_NOT_FOUND;\r\nswitch (size) {\r\ncase 1: outb(( u8)val, GAPSPCI_BBA_CONFIG+where); break;\r\ncase 2: outw((u16)val, GAPSPCI_BBA_CONFIG+where); break;\r\ncase 4: outl((u32)val, GAPSPCI_BBA_CONFIG+where); break;\r\n}\r\nreturn PCIBIOS_SUCCESSFUL;\r\n}
