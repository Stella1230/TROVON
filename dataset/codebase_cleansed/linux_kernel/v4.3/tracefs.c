bool tracefs_configured(void)\r\n{\r\nreturn tracefs_find_mountpoint() != NULL;\r\n}\r\nconst char *tracefs_find_mountpoint(void)\r\n{\r\nconst char *ret;\r\nif (tracefs_found)\r\nreturn (const char *)tracefs_mountpoint;\r\nret = find_mountpoint("tracefs", (long) TRACEFS_MAGIC,\r\ntracefs_mountpoint, PATH_MAX + 1,\r\ntracefs_known_mountpoints);\r\nif (ret)\r\ntracefs_found = true;\r\nreturn ret;\r\n}\r\nchar *tracefs_mount(const char *mountpoint)\r\n{\r\nif (tracefs_find_mountpoint())\r\ngoto out;\r\nif (mountpoint == NULL) {\r\nmountpoint = getenv(PERF_TRACEFS_ENVIRONMENT);\r\nif (mountpoint == NULL)\r\nmountpoint = TRACEFS_DEFAULT_PATH;\r\n}\r\nif (mount(NULL, mountpoint, "tracefs", 0, NULL) < 0)\r\nreturn NULL;\r\ntracefs_found = true;\r\nstrncpy(tracefs_mountpoint, mountpoint, sizeof(tracefs_mountpoint));\r\nout:\r\nreturn tracefs_mountpoint;\r\n}
