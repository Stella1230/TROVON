int fb_get_options(const char *name, char **option)\r\n{\r\nchar *opt, *options = NULL;\r\nint retval = 0;\r\nint name_len = strlen(name), i;\r\nif (name_len && ofonly && strncmp(name, "offb", 4))\r\nretval = 1;\r\nif (name_len && !retval) {\r\nfor (i = 0; i < FB_MAX; i++) {\r\nif (video_options[i] == NULL)\r\ncontinue;\r\nif (!video_options[i][0])\r\ncontinue;\r\nopt = video_options[i];\r\nif (!strncmp(name, opt, name_len) &&\r\nopt[name_len] == ':')\r\noptions = opt + name_len + 1;\r\n}\r\n}\r\nif (!options && option && fb_mode_option)\r\noptions = kstrdup(fb_mode_option, GFP_KERNEL);\r\nif (options && !strncmp(options, "off", 3))\r\nretval = 1;\r\nif (option)\r\n*option = options;\r\nreturn retval;\r\n}\r\nstatic int __init video_setup(char *options)\r\n{\r\nint i, global = 0;\r\nif (!options || !*options)\r\nglobal = 1;\r\nif (!global && !strncmp(options, "ofonly", 6)) {\r\nofonly = 1;\r\nglobal = 1;\r\n}\r\nif (!global && !strchr(options, ':')) {\r\nfb_mode_option = options;\r\nglobal = 1;\r\n}\r\nif (!global) {\r\nfor (i = 0; i < FB_MAX; i++) {\r\nif (video_options[i] == NULL) {\r\nvideo_options[i] = options;\r\nbreak;\r\n}\r\n}\r\n}\r\nreturn 1;\r\n}
