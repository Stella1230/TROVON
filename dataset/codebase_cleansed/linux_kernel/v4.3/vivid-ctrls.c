static int vivid_user_gen_s_ctrl(struct v4l2_ctrl *ctrl)\r\n{\r\nstruct vivid_dev *dev = container_of(ctrl->handler, struct vivid_dev, ctrl_hdl_user_gen);\r\nswitch (ctrl->id) {\r\ncase VIVID_CID_DISCONNECT:\r\nv4l2_info(&dev->v4l2_dev, "disconnect\n");\r\nclear_bit(V4L2_FL_REGISTERED, &dev->vid_cap_dev.flags);\r\nclear_bit(V4L2_FL_REGISTERED, &dev->vid_out_dev.flags);\r\nclear_bit(V4L2_FL_REGISTERED, &dev->vbi_cap_dev.flags);\r\nclear_bit(V4L2_FL_REGISTERED, &dev->vbi_out_dev.flags);\r\nclear_bit(V4L2_FL_REGISTERED, &dev->sdr_cap_dev.flags);\r\nclear_bit(V4L2_FL_REGISTERED, &dev->radio_rx_dev.flags);\r\nclear_bit(V4L2_FL_REGISTERED, &dev->radio_tx_dev.flags);\r\nbreak;\r\ncase VIVID_CID_CLEAR_FB:\r\nvivid_clear_fb(dev);\r\nbreak;\r\ncase VIVID_CID_BUTTON:\r\ndev->button_pressed = 30;\r\nbreak;\r\n}\r\nreturn 0;\r\n}\r\nstatic int vivid_user_vid_g_volatile_ctrl(struct v4l2_ctrl *ctrl)\r\n{\r\nstruct vivid_dev *dev = container_of(ctrl->handler, struct vivid_dev, ctrl_hdl_user_vid);\r\nswitch (ctrl->id) {\r\ncase V4L2_CID_AUTOGAIN:\r\ndev->gain->val = dev->jiffies_vid_cap & 0xff;\r\nbreak;\r\n}\r\nreturn 0;\r\n}\r\nstatic int vivid_user_vid_s_ctrl(struct v4l2_ctrl *ctrl)\r\n{\r\nstruct vivid_dev *dev = container_of(ctrl->handler, struct vivid_dev, ctrl_hdl_user_vid);\r\nswitch (ctrl->id) {\r\ncase V4L2_CID_BRIGHTNESS:\r\ndev->input_brightness[dev->input] = ctrl->val - dev->input * 128;\r\ntpg_s_brightness(&dev->tpg, dev->input_brightness[dev->input]);\r\nbreak;\r\ncase V4L2_CID_CONTRAST:\r\ntpg_s_contrast(&dev->tpg, ctrl->val);\r\nbreak;\r\ncase V4L2_CID_SATURATION:\r\ntpg_s_saturation(&dev->tpg, ctrl->val);\r\nbreak;\r\ncase V4L2_CID_HUE:\r\ntpg_s_hue(&dev->tpg, ctrl->val);\r\nbreak;\r\ncase V4L2_CID_HFLIP:\r\ndev->hflip = ctrl->val;\r\ntpg_s_hflip(&dev->tpg, dev->sensor_hflip ^ dev->hflip);\r\nbreak;\r\ncase V4L2_CID_VFLIP:\r\ndev->vflip = ctrl->val;\r\ntpg_s_vflip(&dev->tpg, dev->sensor_vflip ^ dev->vflip);\r\nbreak;\r\ncase V4L2_CID_ALPHA_COMPONENT:\r\ntpg_s_alpha_component(&dev->tpg, ctrl->val);\r\nbreak;\r\n}\r\nreturn 0;\r\n}\r\nstatic int vivid_vid_cap_s_ctrl(struct v4l2_ctrl *ctrl)\r\n{\r\nstatic const u32 colorspaces[] = {\r\nV4L2_COLORSPACE_SMPTE170M,\r\nV4L2_COLORSPACE_REC709,\r\nV4L2_COLORSPACE_SRGB,\r\nV4L2_COLORSPACE_ADOBERGB,\r\nV4L2_COLORSPACE_BT2020,\r\nV4L2_COLORSPACE_SMPTE240M,\r\nV4L2_COLORSPACE_470_SYSTEM_M,\r\nV4L2_COLORSPACE_470_SYSTEM_BG,\r\n};\r\nstruct vivid_dev *dev = container_of(ctrl->handler, struct vivid_dev, ctrl_hdl_vid_cap);\r\nunsigned i;\r\nswitch (ctrl->id) {\r\ncase VIVID_CID_TEST_PATTERN:\r\nvivid_update_quality(dev);\r\ntpg_s_pattern(&dev->tpg, ctrl->val);\r\nbreak;\r\ncase VIVID_CID_COLORSPACE:\r\ntpg_s_colorspace(&dev->tpg, colorspaces[ctrl->val]);\r\nvivid_send_source_change(dev, TV);\r\nvivid_send_source_change(dev, SVID);\r\nvivid_send_source_change(dev, HDMI);\r\nvivid_send_source_change(dev, WEBCAM);\r\nbreak;\r\ncase VIVID_CID_XFER_FUNC:\r\ntpg_s_xfer_func(&dev->tpg, ctrl->val);\r\nvivid_send_source_change(dev, TV);\r\nvivid_send_source_change(dev, SVID);\r\nvivid_send_source_change(dev, HDMI);\r\nvivid_send_source_change(dev, WEBCAM);\r\nbreak;\r\ncase VIVID_CID_YCBCR_ENC:\r\ntpg_s_ycbcr_enc(&dev->tpg, ctrl->val);\r\nvivid_send_source_change(dev, TV);\r\nvivid_send_source_change(dev, SVID);\r\nvivid_send_source_change(dev, HDMI);\r\nvivid_send_source_change(dev, WEBCAM);\r\nbreak;\r\ncase VIVID_CID_QUANTIZATION:\r\ntpg_s_quantization(&dev->tpg, ctrl->val);\r\nvivid_send_source_change(dev, TV);\r\nvivid_send_source_change(dev, SVID);\r\nvivid_send_source_change(dev, HDMI);\r\nvivid_send_source_change(dev, WEBCAM);\r\nbreak;\r\ncase V4L2_CID_DV_RX_RGB_RANGE:\r\nif (!vivid_is_hdmi_cap(dev))\r\nbreak;\r\ntpg_s_rgb_range(&dev->tpg, ctrl->val);\r\nbreak;\r\ncase VIVID_CID_LIMITED_RGB_RANGE:\r\ntpg_s_real_rgb_range(&dev->tpg, ctrl->val ?\r\nV4L2_DV_RGB_RANGE_LIMITED : V4L2_DV_RGB_RANGE_FULL);\r\nbreak;\r\ncase VIVID_CID_ALPHA_MODE:\r\ntpg_s_alpha_mode(&dev->tpg, ctrl->val);\r\nbreak;\r\ncase VIVID_CID_HOR_MOVEMENT:\r\ntpg_s_mv_hor_mode(&dev->tpg, ctrl->val);\r\nbreak;\r\ncase VIVID_CID_VERT_MOVEMENT:\r\ntpg_s_mv_vert_mode(&dev->tpg, ctrl->val);\r\nbreak;\r\ncase VIVID_CID_OSD_TEXT_MODE:\r\ndev->osd_mode = ctrl->val;\r\nbreak;\r\ncase VIVID_CID_PERCENTAGE_FILL:\r\ntpg_s_perc_fill(&dev->tpg, ctrl->val);\r\nfor (i = 0; i < VIDEO_MAX_FRAME; i++)\r\ndev->must_blank[i] = ctrl->val < 100;\r\nbreak;\r\ncase VIVID_CID_INSERT_SAV:\r\ntpg_s_insert_sav(&dev->tpg, ctrl->val);\r\nbreak;\r\ncase VIVID_CID_INSERT_EAV:\r\ntpg_s_insert_eav(&dev->tpg, ctrl->val);\r\nbreak;\r\ncase VIVID_CID_HFLIP:\r\ndev->sensor_hflip = ctrl->val;\r\ntpg_s_hflip(&dev->tpg, dev->sensor_hflip ^ dev->hflip);\r\nbreak;\r\ncase VIVID_CID_VFLIP:\r\ndev->sensor_vflip = ctrl->val;\r\ntpg_s_vflip(&dev->tpg, dev->sensor_vflip ^ dev->vflip);\r\nbreak;\r\ncase VIVID_CID_HAS_CROP_CAP:\r\ndev->has_crop_cap = ctrl->val;\r\nvivid_update_format_cap(dev, true);\r\nbreak;\r\ncase VIVID_CID_HAS_COMPOSE_CAP:\r\ndev->has_compose_cap = ctrl->val;\r\nvivid_update_format_cap(dev, true);\r\nbreak;\r\ncase VIVID_CID_HAS_SCALER_CAP:\r\ndev->has_scaler_cap = ctrl->val;\r\nvivid_update_format_cap(dev, true);\r\nbreak;\r\ncase VIVID_CID_SHOW_BORDER:\r\ntpg_s_show_border(&dev->tpg, ctrl->val);\r\nbreak;\r\ncase VIVID_CID_SHOW_SQUARE:\r\ntpg_s_show_square(&dev->tpg, ctrl->val);\r\nbreak;\r\ncase VIVID_CID_STD_ASPECT_RATIO:\r\ndev->std_aspect_ratio = ctrl->val;\r\ntpg_s_video_aspect(&dev->tpg, vivid_get_video_aspect(dev));\r\nbreak;\r\ncase VIVID_CID_DV_TIMINGS_SIGNAL_MODE:\r\ndev->dv_timings_signal_mode = dev->ctrl_dv_timings_signal_mode->val;\r\nif (dev->dv_timings_signal_mode == SELECTED_DV_TIMINGS)\r\ndev->query_dv_timings = dev->ctrl_dv_timings->val;\r\nv4l2_ctrl_activate(dev->ctrl_dv_timings,\r\ndev->dv_timings_signal_mode == SELECTED_DV_TIMINGS);\r\nvivid_update_quality(dev);\r\nvivid_send_source_change(dev, HDMI);\r\nbreak;\r\ncase VIVID_CID_DV_TIMINGS_ASPECT_RATIO:\r\ndev->dv_timings_aspect_ratio = ctrl->val;\r\ntpg_s_video_aspect(&dev->tpg, vivid_get_video_aspect(dev));\r\nbreak;\r\ncase VIVID_CID_TSTAMP_SRC:\r\ndev->tstamp_src_is_soe = ctrl->val;\r\ndev->vb_vid_cap_q.timestamp_flags &= ~V4L2_BUF_FLAG_TSTAMP_SRC_MASK;\r\nif (dev->tstamp_src_is_soe)\r\ndev->vb_vid_cap_q.timestamp_flags |= V4L2_BUF_FLAG_TSTAMP_SRC_SOE;\r\nbreak;\r\ncase VIVID_CID_MAX_EDID_BLOCKS:\r\ndev->edid_max_blocks = ctrl->val;\r\nif (dev->edid_blocks > dev->edid_max_blocks)\r\ndev->edid_blocks = dev->edid_max_blocks;\r\nbreak;\r\n}\r\nreturn 0;\r\n}\r\nstatic int vivid_loop_cap_s_ctrl(struct v4l2_ctrl *ctrl)\r\n{\r\nstruct vivid_dev *dev = container_of(ctrl->handler, struct vivid_dev, ctrl_hdl_loop_cap);\r\nswitch (ctrl->id) {\r\ncase VIVID_CID_LOOP_VIDEO:\r\ndev->loop_video = ctrl->val;\r\nvivid_update_quality(dev);\r\nvivid_send_source_change(dev, SVID);\r\nvivid_send_source_change(dev, HDMI);\r\nbreak;\r\n}\r\nreturn 0;\r\n}\r\nstatic int vivid_vbi_cap_s_ctrl(struct v4l2_ctrl *ctrl)\r\n{\r\nstruct vivid_dev *dev = container_of(ctrl->handler, struct vivid_dev, ctrl_hdl_vbi_cap);\r\nswitch (ctrl->id) {\r\ncase VIVID_CID_VBI_CAP_INTERLACED:\r\ndev->vbi_cap_interlaced = ctrl->val;\r\nbreak;\r\n}\r\nreturn 0;\r\n}\r\nstatic int vivid_vid_out_s_ctrl(struct v4l2_ctrl *ctrl)\r\n{\r\nstruct vivid_dev *dev = container_of(ctrl->handler, struct vivid_dev, ctrl_hdl_vid_out);\r\nstruct v4l2_bt_timings *bt = &dev->dv_timings_out.bt;\r\nswitch (ctrl->id) {\r\ncase VIVID_CID_HAS_CROP_OUT:\r\ndev->has_crop_out = ctrl->val;\r\nvivid_update_format_out(dev);\r\nbreak;\r\ncase VIVID_CID_HAS_COMPOSE_OUT:\r\ndev->has_compose_out = ctrl->val;\r\nvivid_update_format_out(dev);\r\nbreak;\r\ncase VIVID_CID_HAS_SCALER_OUT:\r\ndev->has_scaler_out = ctrl->val;\r\nvivid_update_format_out(dev);\r\nbreak;\r\ncase V4L2_CID_DV_TX_MODE:\r\ndev->dvi_d_out = ctrl->val == V4L2_DV_TX_MODE_DVI_D;\r\nif (!vivid_is_hdmi_out(dev))\r\nbreak;\r\nif (!dev->dvi_d_out && (bt->flags & V4L2_DV_FL_IS_CE_VIDEO)) {\r\nif (bt->width == 720 && bt->height <= 576)\r\ndev->colorspace_out = V4L2_COLORSPACE_SMPTE170M;\r\nelse\r\ndev->colorspace_out = V4L2_COLORSPACE_REC709;\r\ndev->quantization_out = V4L2_QUANTIZATION_DEFAULT;\r\n} else {\r\ndev->colorspace_out = V4L2_COLORSPACE_SRGB;\r\ndev->quantization_out = dev->dvi_d_out ?\r\nV4L2_QUANTIZATION_LIM_RANGE :\r\nV4L2_QUANTIZATION_DEFAULT;\r\n}\r\nif (dev->loop_video)\r\nvivid_send_source_change(dev, HDMI);\r\nbreak;\r\n}\r\nreturn 0;\r\n}\r\nstatic int vivid_streaming_s_ctrl(struct v4l2_ctrl *ctrl)\r\n{\r\nstruct vivid_dev *dev = container_of(ctrl->handler, struct vivid_dev, ctrl_hdl_streaming);\r\nstruct timeval tv;\r\nswitch (ctrl->id) {\r\ncase VIVID_CID_DQBUF_ERROR:\r\ndev->dqbuf_error = true;\r\nbreak;\r\ncase VIVID_CID_PERC_DROPPED:\r\ndev->perc_dropped_buffers = ctrl->val;\r\nbreak;\r\ncase VIVID_CID_QUEUE_SETUP_ERROR:\r\ndev->queue_setup_error = true;\r\nbreak;\r\ncase VIVID_CID_BUF_PREPARE_ERROR:\r\ndev->buf_prepare_error = true;\r\nbreak;\r\ncase VIVID_CID_START_STR_ERROR:\r\ndev->start_streaming_error = true;\r\nbreak;\r\ncase VIVID_CID_QUEUE_ERROR:\r\nif (vb2_start_streaming_called(&dev->vb_vid_cap_q))\r\nvb2_queue_error(&dev->vb_vid_cap_q);\r\nif (vb2_start_streaming_called(&dev->vb_vbi_cap_q))\r\nvb2_queue_error(&dev->vb_vbi_cap_q);\r\nif (vb2_start_streaming_called(&dev->vb_vid_out_q))\r\nvb2_queue_error(&dev->vb_vid_out_q);\r\nif (vb2_start_streaming_called(&dev->vb_vbi_out_q))\r\nvb2_queue_error(&dev->vb_vbi_out_q);\r\nif (vb2_start_streaming_called(&dev->vb_sdr_cap_q))\r\nvb2_queue_error(&dev->vb_sdr_cap_q);\r\nbreak;\r\ncase VIVID_CID_SEQ_WRAP:\r\ndev->seq_wrap = ctrl->val;\r\nbreak;\r\ncase VIVID_CID_TIME_WRAP:\r\ndev->time_wrap = ctrl->val;\r\nif (ctrl->val == 0) {\r\ndev->time_wrap_offset = 0;\r\nbreak;\r\n}\r\nv4l2_get_timestamp(&tv);\r\ndev->time_wrap_offset = -tv.tv_sec - 16;\r\nbreak;\r\n}\r\nreturn 0;\r\n}\r\nstatic int vivid_sdtv_cap_s_ctrl(struct v4l2_ctrl *ctrl)\r\n{\r\nstruct vivid_dev *dev = container_of(ctrl->handler, struct vivid_dev, ctrl_hdl_sdtv_cap);\r\nswitch (ctrl->id) {\r\ncase VIVID_CID_STD_SIGNAL_MODE:\r\ndev->std_signal_mode = dev->ctrl_std_signal_mode->val;\r\nif (dev->std_signal_mode == SELECTED_STD)\r\ndev->query_std = vivid_standard[dev->ctrl_standard->val];\r\nv4l2_ctrl_activate(dev->ctrl_standard, dev->std_signal_mode == SELECTED_STD);\r\nvivid_update_quality(dev);\r\nvivid_send_source_change(dev, TV);\r\nvivid_send_source_change(dev, SVID);\r\nbreak;\r\n}\r\nreturn 0;\r\n}\r\nstatic int vivid_radio_rx_s_ctrl(struct v4l2_ctrl *ctrl)\r\n{\r\nstruct vivid_dev *dev = container_of(ctrl->handler, struct vivid_dev, ctrl_hdl_radio_rx);\r\nswitch (ctrl->id) {\r\ncase VIVID_CID_RADIO_SEEK_MODE:\r\ndev->radio_rx_hw_seek_mode = ctrl->val;\r\nbreak;\r\ncase VIVID_CID_RADIO_SEEK_PROG_LIM:\r\ndev->radio_rx_hw_seek_prog_lim = ctrl->val;\r\nbreak;\r\ncase VIVID_CID_RADIO_RX_RDS_RBDS:\r\ndev->rds_gen.use_rbds = ctrl->val;\r\nbreak;\r\ncase VIVID_CID_RADIO_RX_RDS_BLOCKIO:\r\ndev->radio_rx_rds_controls = ctrl->val;\r\ndev->radio_rx_caps &= ~V4L2_CAP_READWRITE;\r\ndev->radio_rx_rds_use_alternates = false;\r\nif (!dev->radio_rx_rds_controls) {\r\ndev->radio_rx_caps |= V4L2_CAP_READWRITE;\r\n__v4l2_ctrl_s_ctrl(dev->radio_rx_rds_pty, 0);\r\n__v4l2_ctrl_s_ctrl(dev->radio_rx_rds_ta, 0);\r\n__v4l2_ctrl_s_ctrl(dev->radio_rx_rds_tp, 0);\r\n__v4l2_ctrl_s_ctrl(dev->radio_rx_rds_ms, 0);\r\n__v4l2_ctrl_s_ctrl_string(dev->radio_rx_rds_psname, "");\r\n__v4l2_ctrl_s_ctrl_string(dev->radio_rx_rds_radiotext, "");\r\n}\r\nv4l2_ctrl_activate(dev->radio_rx_rds_pty, dev->radio_rx_rds_controls);\r\nv4l2_ctrl_activate(dev->radio_rx_rds_psname, dev->radio_rx_rds_controls);\r\nv4l2_ctrl_activate(dev->radio_rx_rds_radiotext, dev->radio_rx_rds_controls);\r\nv4l2_ctrl_activate(dev->radio_rx_rds_ta, dev->radio_rx_rds_controls);\r\nv4l2_ctrl_activate(dev->radio_rx_rds_tp, dev->radio_rx_rds_controls);\r\nv4l2_ctrl_activate(dev->radio_rx_rds_ms, dev->radio_rx_rds_controls);\r\nbreak;\r\ncase V4L2_CID_RDS_RECEPTION:\r\ndev->radio_rx_rds_enabled = ctrl->val;\r\nbreak;\r\n}\r\nreturn 0;\r\n}\r\nstatic int vivid_radio_tx_s_ctrl(struct v4l2_ctrl *ctrl)\r\n{\r\nstruct vivid_dev *dev = container_of(ctrl->handler, struct vivid_dev, ctrl_hdl_radio_tx);\r\nswitch (ctrl->id) {\r\ncase VIVID_CID_RADIO_TX_RDS_BLOCKIO:\r\ndev->radio_tx_rds_controls = ctrl->val;\r\ndev->radio_tx_caps &= ~V4L2_CAP_READWRITE;\r\nif (!dev->radio_tx_rds_controls)\r\ndev->radio_tx_caps |= V4L2_CAP_READWRITE;\r\nbreak;\r\ncase V4L2_CID_RDS_TX_PTY:\r\nif (dev->radio_rx_rds_controls)\r\nv4l2_ctrl_s_ctrl(dev->radio_rx_rds_pty, ctrl->val);\r\nbreak;\r\ncase V4L2_CID_RDS_TX_PS_NAME:\r\nif (dev->radio_rx_rds_controls)\r\nv4l2_ctrl_s_ctrl_string(dev->radio_rx_rds_psname, ctrl->p_new.p_char);\r\nbreak;\r\ncase V4L2_CID_RDS_TX_RADIO_TEXT:\r\nif (dev->radio_rx_rds_controls)\r\nv4l2_ctrl_s_ctrl_string(dev->radio_rx_rds_radiotext, ctrl->p_new.p_char);\r\nbreak;\r\ncase V4L2_CID_RDS_TX_TRAFFIC_ANNOUNCEMENT:\r\nif (dev->radio_rx_rds_controls)\r\nv4l2_ctrl_s_ctrl(dev->radio_rx_rds_ta, ctrl->val);\r\nbreak;\r\ncase V4L2_CID_RDS_TX_TRAFFIC_PROGRAM:\r\nif (dev->radio_rx_rds_controls)\r\nv4l2_ctrl_s_ctrl(dev->radio_rx_rds_tp, ctrl->val);\r\nbreak;\r\ncase V4L2_CID_RDS_TX_MUSIC_SPEECH:\r\nif (dev->radio_rx_rds_controls)\r\nv4l2_ctrl_s_ctrl(dev->radio_rx_rds_ms, ctrl->val);\r\nbreak;\r\n}\r\nreturn 0;\r\n}\r\nint vivid_create_controls(struct vivid_dev *dev, bool show_ccs_cap,\r\nbool show_ccs_out, bool no_error_inj,\r\nbool has_sdtv, bool has_hdmi)\r\n{\r\nstruct v4l2_ctrl_handler *hdl_user_gen = &dev->ctrl_hdl_user_gen;\r\nstruct v4l2_ctrl_handler *hdl_user_vid = &dev->ctrl_hdl_user_vid;\r\nstruct v4l2_ctrl_handler *hdl_user_aud = &dev->ctrl_hdl_user_aud;\r\nstruct v4l2_ctrl_handler *hdl_streaming = &dev->ctrl_hdl_streaming;\r\nstruct v4l2_ctrl_handler *hdl_sdtv_cap = &dev->ctrl_hdl_sdtv_cap;\r\nstruct v4l2_ctrl_handler *hdl_loop_cap = &dev->ctrl_hdl_loop_cap;\r\nstruct v4l2_ctrl_handler *hdl_vid_cap = &dev->ctrl_hdl_vid_cap;\r\nstruct v4l2_ctrl_handler *hdl_vid_out = &dev->ctrl_hdl_vid_out;\r\nstruct v4l2_ctrl_handler *hdl_vbi_cap = &dev->ctrl_hdl_vbi_cap;\r\nstruct v4l2_ctrl_handler *hdl_vbi_out = &dev->ctrl_hdl_vbi_out;\r\nstruct v4l2_ctrl_handler *hdl_radio_rx = &dev->ctrl_hdl_radio_rx;\r\nstruct v4l2_ctrl_handler *hdl_radio_tx = &dev->ctrl_hdl_radio_tx;\r\nstruct v4l2_ctrl_handler *hdl_sdr_cap = &dev->ctrl_hdl_sdr_cap;\r\nstruct v4l2_ctrl_config vivid_ctrl_dv_timings = {\r\n.ops = &vivid_vid_cap_ctrl_ops,\r\n.id = VIVID_CID_DV_TIMINGS,\r\n.name = "DV Timings",\r\n.type = V4L2_CTRL_TYPE_MENU,\r\n};\r\nint i;\r\nv4l2_ctrl_handler_init(hdl_user_gen, 10);\r\nv4l2_ctrl_new_custom(hdl_user_gen, &vivid_ctrl_class, NULL);\r\nv4l2_ctrl_handler_init(hdl_user_vid, 9);\r\nv4l2_ctrl_new_custom(hdl_user_vid, &vivid_ctrl_class, NULL);\r\nv4l2_ctrl_handler_init(hdl_user_aud, 2);\r\nv4l2_ctrl_new_custom(hdl_user_aud, &vivid_ctrl_class, NULL);\r\nv4l2_ctrl_handler_init(hdl_streaming, 8);\r\nv4l2_ctrl_new_custom(hdl_streaming, &vivid_ctrl_class, NULL);\r\nv4l2_ctrl_handler_init(hdl_sdtv_cap, 2);\r\nv4l2_ctrl_new_custom(hdl_sdtv_cap, &vivid_ctrl_class, NULL);\r\nv4l2_ctrl_handler_init(hdl_loop_cap, 1);\r\nv4l2_ctrl_new_custom(hdl_loop_cap, &vivid_ctrl_class, NULL);\r\nv4l2_ctrl_handler_init(hdl_vid_cap, 55);\r\nv4l2_ctrl_new_custom(hdl_vid_cap, &vivid_ctrl_class, NULL);\r\nv4l2_ctrl_handler_init(hdl_vid_out, 26);\r\nv4l2_ctrl_new_custom(hdl_vid_out, &vivid_ctrl_class, NULL);\r\nv4l2_ctrl_handler_init(hdl_vbi_cap, 21);\r\nv4l2_ctrl_new_custom(hdl_vbi_cap, &vivid_ctrl_class, NULL);\r\nv4l2_ctrl_handler_init(hdl_vbi_out, 19);\r\nv4l2_ctrl_new_custom(hdl_vbi_out, &vivid_ctrl_class, NULL);\r\nv4l2_ctrl_handler_init(hdl_radio_rx, 17);\r\nv4l2_ctrl_new_custom(hdl_radio_rx, &vivid_ctrl_class, NULL);\r\nv4l2_ctrl_handler_init(hdl_radio_tx, 17);\r\nv4l2_ctrl_new_custom(hdl_radio_tx, &vivid_ctrl_class, NULL);\r\nv4l2_ctrl_handler_init(hdl_sdr_cap, 18);\r\nv4l2_ctrl_new_custom(hdl_sdr_cap, &vivid_ctrl_class, NULL);\r\ndev->volume = v4l2_ctrl_new_std(hdl_user_aud, NULL,\r\nV4L2_CID_AUDIO_VOLUME, 0, 255, 1, 200);\r\ndev->mute = v4l2_ctrl_new_std(hdl_user_aud, NULL,\r\nV4L2_CID_AUDIO_MUTE, 0, 1, 1, 0);\r\nif (dev->has_vid_cap) {\r\ndev->brightness = v4l2_ctrl_new_std(hdl_user_vid, &vivid_user_vid_ctrl_ops,\r\nV4L2_CID_BRIGHTNESS, 0, 255, 1, 128);\r\nfor (i = 0; i < MAX_INPUTS; i++)\r\ndev->input_brightness[i] = 128;\r\ndev->contrast = v4l2_ctrl_new_std(hdl_user_vid, &vivid_user_vid_ctrl_ops,\r\nV4L2_CID_CONTRAST, 0, 255, 1, 128);\r\ndev->saturation = v4l2_ctrl_new_std(hdl_user_vid, &vivid_user_vid_ctrl_ops,\r\nV4L2_CID_SATURATION, 0, 255, 1, 128);\r\ndev->hue = v4l2_ctrl_new_std(hdl_user_vid, &vivid_user_vid_ctrl_ops,\r\nV4L2_CID_HUE, -128, 128, 1, 0);\r\nv4l2_ctrl_new_std(hdl_user_vid, &vivid_user_vid_ctrl_ops,\r\nV4L2_CID_HFLIP, 0, 1, 1, 0);\r\nv4l2_ctrl_new_std(hdl_user_vid, &vivid_user_vid_ctrl_ops,\r\nV4L2_CID_VFLIP, 0, 1, 1, 0);\r\ndev->autogain = v4l2_ctrl_new_std(hdl_user_vid, &vivid_user_vid_ctrl_ops,\r\nV4L2_CID_AUTOGAIN, 0, 1, 1, 1);\r\ndev->gain = v4l2_ctrl_new_std(hdl_user_vid, &vivid_user_vid_ctrl_ops,\r\nV4L2_CID_GAIN, 0, 255, 1, 100);\r\ndev->alpha = v4l2_ctrl_new_std(hdl_user_vid, &vivid_user_vid_ctrl_ops,\r\nV4L2_CID_ALPHA_COMPONENT, 0, 255, 1, 0);\r\n}\r\ndev->button = v4l2_ctrl_new_custom(hdl_user_gen, &vivid_ctrl_button, NULL);\r\ndev->int32 = v4l2_ctrl_new_custom(hdl_user_gen, &vivid_ctrl_int32, NULL);\r\ndev->int64 = v4l2_ctrl_new_custom(hdl_user_gen, &vivid_ctrl_int64, NULL);\r\ndev->boolean = v4l2_ctrl_new_custom(hdl_user_gen, &vivid_ctrl_boolean, NULL);\r\ndev->menu = v4l2_ctrl_new_custom(hdl_user_gen, &vivid_ctrl_menu, NULL);\r\ndev->string = v4l2_ctrl_new_custom(hdl_user_gen, &vivid_ctrl_string, NULL);\r\ndev->bitmask = v4l2_ctrl_new_custom(hdl_user_gen, &vivid_ctrl_bitmask, NULL);\r\ndev->int_menu = v4l2_ctrl_new_custom(hdl_user_gen, &vivid_ctrl_int_menu, NULL);\r\nv4l2_ctrl_new_custom(hdl_user_gen, &vivid_ctrl_u32_array, NULL);\r\nv4l2_ctrl_new_custom(hdl_user_gen, &vivid_ctrl_u16_matrix, NULL);\r\nv4l2_ctrl_new_custom(hdl_user_gen, &vivid_ctrl_u8_4d_array, NULL);\r\nif (dev->has_vid_cap) {\r\nstruct v4l2_ctrl_config vivid_ctrl_test_pattern = {\r\n.ops = &vivid_vid_cap_ctrl_ops,\r\n.id = VIVID_CID_TEST_PATTERN,\r\n.name = "Test Pattern",\r\n.type = V4L2_CTRL_TYPE_MENU,\r\n.max = TPG_PAT_NOISE,\r\n.qmenu = tpg_pattern_strings,\r\n};\r\ndev->test_pattern = v4l2_ctrl_new_custom(hdl_vid_cap,\r\n&vivid_ctrl_test_pattern, NULL);\r\nv4l2_ctrl_new_custom(hdl_vid_cap, &vivid_ctrl_perc_fill, NULL);\r\nv4l2_ctrl_new_custom(hdl_vid_cap, &vivid_ctrl_hor_movement, NULL);\r\nv4l2_ctrl_new_custom(hdl_vid_cap, &vivid_ctrl_vert_movement, NULL);\r\nv4l2_ctrl_new_custom(hdl_vid_cap, &vivid_ctrl_osd_mode, NULL);\r\nv4l2_ctrl_new_custom(hdl_vid_cap, &vivid_ctrl_show_border, NULL);\r\nv4l2_ctrl_new_custom(hdl_vid_cap, &vivid_ctrl_show_square, NULL);\r\nv4l2_ctrl_new_custom(hdl_vid_cap, &vivid_ctrl_hflip, NULL);\r\nv4l2_ctrl_new_custom(hdl_vid_cap, &vivid_ctrl_vflip, NULL);\r\nv4l2_ctrl_new_custom(hdl_vid_cap, &vivid_ctrl_insert_sav, NULL);\r\nv4l2_ctrl_new_custom(hdl_vid_cap, &vivid_ctrl_insert_eav, NULL);\r\nif (show_ccs_cap) {\r\ndev->ctrl_has_crop_cap = v4l2_ctrl_new_custom(hdl_vid_cap,\r\n&vivid_ctrl_has_crop_cap, NULL);\r\ndev->ctrl_has_compose_cap = v4l2_ctrl_new_custom(hdl_vid_cap,\r\n&vivid_ctrl_has_compose_cap, NULL);\r\ndev->ctrl_has_scaler_cap = v4l2_ctrl_new_custom(hdl_vid_cap,\r\n&vivid_ctrl_has_scaler_cap, NULL);\r\n}\r\nv4l2_ctrl_new_custom(hdl_vid_cap, &vivid_ctrl_tstamp_src, NULL);\r\ndev->colorspace = v4l2_ctrl_new_custom(hdl_vid_cap,\r\n&vivid_ctrl_colorspace, NULL);\r\nv4l2_ctrl_new_custom(hdl_vid_cap, &vivid_ctrl_xfer_func, NULL);\r\nv4l2_ctrl_new_custom(hdl_vid_cap, &vivid_ctrl_ycbcr_enc, NULL);\r\nv4l2_ctrl_new_custom(hdl_vid_cap, &vivid_ctrl_quantization, NULL);\r\nv4l2_ctrl_new_custom(hdl_vid_cap, &vivid_ctrl_alpha_mode, NULL);\r\n}\r\nif (dev->has_vid_out && show_ccs_out) {\r\ndev->ctrl_has_crop_out = v4l2_ctrl_new_custom(hdl_vid_out,\r\n&vivid_ctrl_has_crop_out, NULL);\r\ndev->ctrl_has_compose_out = v4l2_ctrl_new_custom(hdl_vid_out,\r\n&vivid_ctrl_has_compose_out, NULL);\r\ndev->ctrl_has_scaler_out = v4l2_ctrl_new_custom(hdl_vid_out,\r\n&vivid_ctrl_has_scaler_out, NULL);\r\n}\r\nif (!no_error_inj) {\r\nv4l2_ctrl_new_custom(hdl_user_gen, &vivid_ctrl_disconnect, NULL);\r\nv4l2_ctrl_new_custom(hdl_streaming, &vivid_ctrl_dqbuf_error, NULL);\r\nv4l2_ctrl_new_custom(hdl_streaming, &vivid_ctrl_perc_dropped, NULL);\r\nv4l2_ctrl_new_custom(hdl_streaming, &vivid_ctrl_queue_setup_error, NULL);\r\nv4l2_ctrl_new_custom(hdl_streaming, &vivid_ctrl_buf_prepare_error, NULL);\r\nv4l2_ctrl_new_custom(hdl_streaming, &vivid_ctrl_start_streaming_error, NULL);\r\nv4l2_ctrl_new_custom(hdl_streaming, &vivid_ctrl_queue_error, NULL);\r\nv4l2_ctrl_new_custom(hdl_streaming, &vivid_ctrl_seq_wrap, NULL);\r\nv4l2_ctrl_new_custom(hdl_streaming, &vivid_ctrl_time_wrap, NULL);\r\n}\r\nif (has_sdtv && (dev->has_vid_cap || dev->has_vbi_cap)) {\r\nif (dev->has_vid_cap)\r\nv4l2_ctrl_new_custom(hdl_vid_cap, &vivid_ctrl_std_aspect_ratio, NULL);\r\ndev->ctrl_std_signal_mode = v4l2_ctrl_new_custom(hdl_sdtv_cap,\r\n&vivid_ctrl_std_signal_mode, NULL);\r\ndev->ctrl_standard = v4l2_ctrl_new_custom(hdl_sdtv_cap,\r\n&vivid_ctrl_standard, NULL);\r\nif (dev->ctrl_std_signal_mode)\r\nv4l2_ctrl_cluster(2, &dev->ctrl_std_signal_mode);\r\nif (dev->has_raw_vbi_cap)\r\nv4l2_ctrl_new_custom(hdl_vbi_cap, &vivid_ctrl_vbi_cap_interlaced, NULL);\r\n}\r\nif (has_hdmi && dev->has_vid_cap) {\r\ndev->ctrl_dv_timings_signal_mode = v4l2_ctrl_new_custom(hdl_vid_cap,\r\n&vivid_ctrl_dv_timings_signal_mode, NULL);\r\nvivid_ctrl_dv_timings.max = dev->query_dv_timings_size - 1;\r\nvivid_ctrl_dv_timings.qmenu =\r\n(const char * const *)dev->query_dv_timings_qmenu;\r\ndev->ctrl_dv_timings = v4l2_ctrl_new_custom(hdl_vid_cap,\r\n&vivid_ctrl_dv_timings, NULL);\r\nif (dev->ctrl_dv_timings_signal_mode)\r\nv4l2_ctrl_cluster(2, &dev->ctrl_dv_timings_signal_mode);\r\nv4l2_ctrl_new_custom(hdl_vid_cap, &vivid_ctrl_dv_timings_aspect_ratio, NULL);\r\nv4l2_ctrl_new_custom(hdl_vid_cap, &vivid_ctrl_max_edid_blocks, NULL);\r\ndev->real_rgb_range_cap = v4l2_ctrl_new_custom(hdl_vid_cap,\r\n&vivid_ctrl_limited_rgb_range, NULL);\r\ndev->rgb_range_cap = v4l2_ctrl_new_std_menu(hdl_vid_cap,\r\n&vivid_vid_cap_ctrl_ops,\r\nV4L2_CID_DV_RX_RGB_RANGE, V4L2_DV_RGB_RANGE_FULL,\r\n0, V4L2_DV_RGB_RANGE_AUTO);\r\n}\r\nif (has_hdmi && dev->has_vid_out) {\r\ndev->ctrl_tx_rgb_range = v4l2_ctrl_new_std_menu(hdl_vid_out, NULL,\r\nV4L2_CID_DV_TX_RGB_RANGE, V4L2_DV_RGB_RANGE_FULL,\r\n0, V4L2_DV_RGB_RANGE_AUTO);\r\ndev->ctrl_tx_mode = v4l2_ctrl_new_std_menu(hdl_vid_out, NULL,\r\nV4L2_CID_DV_TX_MODE, V4L2_DV_TX_MODE_HDMI,\r\n0, V4L2_DV_TX_MODE_HDMI);\r\n}\r\nif ((dev->has_vid_cap && dev->has_vid_out) ||\r\n(dev->has_vbi_cap && dev->has_vbi_out))\r\nv4l2_ctrl_new_custom(hdl_loop_cap, &vivid_ctrl_loop_video, NULL);\r\nif (dev->has_fb)\r\nv4l2_ctrl_new_custom(hdl_user_gen, &vivid_ctrl_clear_fb, NULL);\r\nif (dev->has_radio_rx) {\r\nv4l2_ctrl_new_custom(hdl_radio_rx, &vivid_ctrl_radio_hw_seek_mode, NULL);\r\nv4l2_ctrl_new_custom(hdl_radio_rx, &vivid_ctrl_radio_hw_seek_prog_lim, NULL);\r\nv4l2_ctrl_new_custom(hdl_radio_rx, &vivid_ctrl_radio_rx_rds_blockio, NULL);\r\nv4l2_ctrl_new_custom(hdl_radio_rx, &vivid_ctrl_radio_rx_rds_rbds, NULL);\r\nv4l2_ctrl_new_std(hdl_radio_rx, &vivid_radio_rx_ctrl_ops,\r\nV4L2_CID_RDS_RECEPTION, 0, 1, 1, 1);\r\ndev->radio_rx_rds_pty = v4l2_ctrl_new_std(hdl_radio_rx,\r\n&vivid_radio_rx_ctrl_ops,\r\nV4L2_CID_RDS_RX_PTY, 0, 31, 1, 0);\r\ndev->radio_rx_rds_psname = v4l2_ctrl_new_std(hdl_radio_rx,\r\n&vivid_radio_rx_ctrl_ops,\r\nV4L2_CID_RDS_RX_PS_NAME, 0, 8, 8, 0);\r\ndev->radio_rx_rds_radiotext = v4l2_ctrl_new_std(hdl_radio_rx,\r\n&vivid_radio_rx_ctrl_ops,\r\nV4L2_CID_RDS_RX_RADIO_TEXT, 0, 64, 64, 0);\r\ndev->radio_rx_rds_ta = v4l2_ctrl_new_std(hdl_radio_rx,\r\n&vivid_radio_rx_ctrl_ops,\r\nV4L2_CID_RDS_RX_TRAFFIC_ANNOUNCEMENT, 0, 1, 1, 0);\r\ndev->radio_rx_rds_tp = v4l2_ctrl_new_std(hdl_radio_rx,\r\n&vivid_radio_rx_ctrl_ops,\r\nV4L2_CID_RDS_RX_TRAFFIC_PROGRAM, 0, 1, 1, 0);\r\ndev->radio_rx_rds_ms = v4l2_ctrl_new_std(hdl_radio_rx,\r\n&vivid_radio_rx_ctrl_ops,\r\nV4L2_CID_RDS_RX_MUSIC_SPEECH, 0, 1, 1, 1);\r\n}\r\nif (dev->has_radio_tx) {\r\nv4l2_ctrl_new_custom(hdl_radio_tx,\r\n&vivid_ctrl_radio_tx_rds_blockio, NULL);\r\ndev->radio_tx_rds_pi = v4l2_ctrl_new_std(hdl_radio_tx,\r\n&vivid_radio_tx_ctrl_ops,\r\nV4L2_CID_RDS_TX_PI, 0, 0xffff, 1, 0x8088);\r\ndev->radio_tx_rds_pty = v4l2_ctrl_new_std(hdl_radio_tx,\r\n&vivid_radio_tx_ctrl_ops,\r\nV4L2_CID_RDS_TX_PTY, 0, 31, 1, 3);\r\ndev->radio_tx_rds_psname = v4l2_ctrl_new_std(hdl_radio_tx,\r\n&vivid_radio_tx_ctrl_ops,\r\nV4L2_CID_RDS_TX_PS_NAME, 0, 8, 8, 0);\r\nif (dev->radio_tx_rds_psname)\r\nv4l2_ctrl_s_ctrl_string(dev->radio_tx_rds_psname, "VIVID-TX");\r\ndev->radio_tx_rds_radiotext = v4l2_ctrl_new_std(hdl_radio_tx,\r\n&vivid_radio_tx_ctrl_ops,\r\nV4L2_CID_RDS_TX_RADIO_TEXT, 0, 64 * 2, 64, 0);\r\nif (dev->radio_tx_rds_radiotext)\r\nv4l2_ctrl_s_ctrl_string(dev->radio_tx_rds_radiotext,\r\n"This is a VIVID default Radio Text template text, change at will");\r\ndev->radio_tx_rds_mono_stereo = v4l2_ctrl_new_std(hdl_radio_tx,\r\n&vivid_radio_tx_ctrl_ops,\r\nV4L2_CID_RDS_TX_MONO_STEREO, 0, 1, 1, 1);\r\ndev->radio_tx_rds_art_head = v4l2_ctrl_new_std(hdl_radio_tx,\r\n&vivid_radio_tx_ctrl_ops,\r\nV4L2_CID_RDS_TX_ARTIFICIAL_HEAD, 0, 1, 1, 0);\r\ndev->radio_tx_rds_compressed = v4l2_ctrl_new_std(hdl_radio_tx,\r\n&vivid_radio_tx_ctrl_ops,\r\nV4L2_CID_RDS_TX_COMPRESSED, 0, 1, 1, 0);\r\ndev->radio_tx_rds_dyn_pty = v4l2_ctrl_new_std(hdl_radio_tx,\r\n&vivid_radio_tx_ctrl_ops,\r\nV4L2_CID_RDS_TX_DYNAMIC_PTY, 0, 1, 1, 0);\r\ndev->radio_tx_rds_ta = v4l2_ctrl_new_std(hdl_radio_tx,\r\n&vivid_radio_tx_ctrl_ops,\r\nV4L2_CID_RDS_TX_TRAFFIC_ANNOUNCEMENT, 0, 1, 1, 0);\r\ndev->radio_tx_rds_tp = v4l2_ctrl_new_std(hdl_radio_tx,\r\n&vivid_radio_tx_ctrl_ops,\r\nV4L2_CID_RDS_TX_TRAFFIC_PROGRAM, 0, 1, 1, 1);\r\ndev->radio_tx_rds_ms = v4l2_ctrl_new_std(hdl_radio_tx,\r\n&vivid_radio_tx_ctrl_ops,\r\nV4L2_CID_RDS_TX_MUSIC_SPEECH, 0, 1, 1, 1);\r\n}\r\nif (hdl_user_gen->error)\r\nreturn hdl_user_gen->error;\r\nif (hdl_user_vid->error)\r\nreturn hdl_user_vid->error;\r\nif (hdl_user_aud->error)\r\nreturn hdl_user_aud->error;\r\nif (hdl_streaming->error)\r\nreturn hdl_streaming->error;\r\nif (hdl_sdr_cap->error)\r\nreturn hdl_sdr_cap->error;\r\nif (hdl_loop_cap->error)\r\nreturn hdl_loop_cap->error;\r\nif (dev->autogain)\r\nv4l2_ctrl_auto_cluster(2, &dev->autogain, 0, true);\r\nif (dev->has_vid_cap) {\r\nv4l2_ctrl_add_handler(hdl_vid_cap, hdl_user_gen, NULL);\r\nv4l2_ctrl_add_handler(hdl_vid_cap, hdl_user_vid, NULL);\r\nv4l2_ctrl_add_handler(hdl_vid_cap, hdl_user_aud, NULL);\r\nv4l2_ctrl_add_handler(hdl_vid_cap, hdl_streaming, NULL);\r\nv4l2_ctrl_add_handler(hdl_vid_cap, hdl_sdtv_cap, NULL);\r\nv4l2_ctrl_add_handler(hdl_vid_cap, hdl_loop_cap, NULL);\r\nif (hdl_vid_cap->error)\r\nreturn hdl_vid_cap->error;\r\ndev->vid_cap_dev.ctrl_handler = hdl_vid_cap;\r\n}\r\nif (dev->has_vid_out) {\r\nv4l2_ctrl_add_handler(hdl_vid_out, hdl_user_gen, NULL);\r\nv4l2_ctrl_add_handler(hdl_vid_out, hdl_user_aud, NULL);\r\nv4l2_ctrl_add_handler(hdl_vid_out, hdl_streaming, NULL);\r\nif (hdl_vid_out->error)\r\nreturn hdl_vid_out->error;\r\ndev->vid_out_dev.ctrl_handler = hdl_vid_out;\r\n}\r\nif (dev->has_vbi_cap) {\r\nv4l2_ctrl_add_handler(hdl_vbi_cap, hdl_user_gen, NULL);\r\nv4l2_ctrl_add_handler(hdl_vbi_cap, hdl_streaming, NULL);\r\nv4l2_ctrl_add_handler(hdl_vbi_cap, hdl_sdtv_cap, NULL);\r\nv4l2_ctrl_add_handler(hdl_vbi_cap, hdl_loop_cap, NULL);\r\nif (hdl_vbi_cap->error)\r\nreturn hdl_vbi_cap->error;\r\ndev->vbi_cap_dev.ctrl_handler = hdl_vbi_cap;\r\n}\r\nif (dev->has_vbi_out) {\r\nv4l2_ctrl_add_handler(hdl_vbi_out, hdl_user_gen, NULL);\r\nv4l2_ctrl_add_handler(hdl_vbi_out, hdl_streaming, NULL);\r\nif (hdl_vbi_out->error)\r\nreturn hdl_vbi_out->error;\r\ndev->vbi_out_dev.ctrl_handler = hdl_vbi_out;\r\n}\r\nif (dev->has_radio_rx) {\r\nv4l2_ctrl_add_handler(hdl_radio_rx, hdl_user_gen, NULL);\r\nv4l2_ctrl_add_handler(hdl_radio_rx, hdl_user_aud, NULL);\r\nif (hdl_radio_rx->error)\r\nreturn hdl_radio_rx->error;\r\ndev->radio_rx_dev.ctrl_handler = hdl_radio_rx;\r\n}\r\nif (dev->has_radio_tx) {\r\nv4l2_ctrl_add_handler(hdl_radio_tx, hdl_user_gen, NULL);\r\nv4l2_ctrl_add_handler(hdl_radio_tx, hdl_user_aud, NULL);\r\nif (hdl_radio_tx->error)\r\nreturn hdl_radio_tx->error;\r\ndev->radio_tx_dev.ctrl_handler = hdl_radio_tx;\r\n}\r\nif (dev->has_sdr_cap) {\r\nv4l2_ctrl_add_handler(hdl_sdr_cap, hdl_user_gen, NULL);\r\nv4l2_ctrl_add_handler(hdl_sdr_cap, hdl_streaming, NULL);\r\nif (hdl_sdr_cap->error)\r\nreturn hdl_sdr_cap->error;\r\ndev->sdr_cap_dev.ctrl_handler = hdl_sdr_cap;\r\n}\r\nreturn 0;\r\n}\r\nvoid vivid_free_controls(struct vivid_dev *dev)\r\n{\r\nv4l2_ctrl_handler_free(&dev->ctrl_hdl_vid_cap);\r\nv4l2_ctrl_handler_free(&dev->ctrl_hdl_vid_out);\r\nv4l2_ctrl_handler_free(&dev->ctrl_hdl_vbi_cap);\r\nv4l2_ctrl_handler_free(&dev->ctrl_hdl_vbi_out);\r\nv4l2_ctrl_handler_free(&dev->ctrl_hdl_radio_rx);\r\nv4l2_ctrl_handler_free(&dev->ctrl_hdl_radio_tx);\r\nv4l2_ctrl_handler_free(&dev->ctrl_hdl_sdr_cap);\r\nv4l2_ctrl_handler_free(&dev->ctrl_hdl_user_gen);\r\nv4l2_ctrl_handler_free(&dev->ctrl_hdl_user_vid);\r\nv4l2_ctrl_handler_free(&dev->ctrl_hdl_user_aud);\r\nv4l2_ctrl_handler_free(&dev->ctrl_hdl_streaming);\r\nv4l2_ctrl_handler_free(&dev->ctrl_hdl_sdtv_cap);\r\nv4l2_ctrl_handler_free(&dev->ctrl_hdl_loop_cap);\r\n}
