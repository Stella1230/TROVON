static void __init m527x_qspi_init(void)\r\n{\r\n#if IS_ENABLED(CONFIG_SPI_COLDFIRE_QSPI)\r\n#if defined(CONFIG_M5271)\r\nu16 par;\r\nwriteb(0x1f, MCFGPIO_PAR_QSPI);\r\npar = readw(MCFGPIO_PAR_TIMER);\r\npar &= 0x3f3f;\r\nwritew(par, MCFGPIO_PAR_TIMER);\r\n#elif defined(CONFIG_M5275)\r\nwritew(0x003e, MCFGPIO_PAR_QSPI);\r\n#endif\r\n#endif\r\n}\r\nstatic void __init m527x_uarts_init(void)\r\n{\r\nu16 sepmask;\r\nsepmask = readw(MCFGPIO_PAR_UART);\r\nsepmask |= UART0_ENABLE_MASK | UART1_ENABLE_MASK | UART2_ENABLE_MASK;\r\nwritew(sepmask, MCFGPIO_PAR_UART);\r\n}\r\nstatic void __init m527x_fec_init(void)\r\n{\r\nu8 v;\r\n#if defined(CONFIG_M5271)\r\nv = readb(MCFGPIO_PAR_FECI2C);\r\nwriteb(v | 0xf0, MCFGPIO_PAR_FECI2C);\r\n#else\r\nu16 par;\r\npar = readw(MCFGPIO_PAR_FECI2C);\r\nwritew(par | 0xf00, MCFGPIO_PAR_FECI2C);\r\nv = readb(MCFGPIO_PAR_FEC0HL);\r\nwriteb(v | 0xc0, MCFGPIO_PAR_FEC0HL);\r\npar = readw(MCFGPIO_PAR_FECI2C);\r\nwritew(par | 0xa0, MCFGPIO_PAR_FECI2C);\r\nv = readb(MCFGPIO_PAR_FEC1HL);\r\nwriteb(v | 0xc0, MCFGPIO_PAR_FEC1HL);\r\n#endif\r\n}\r\nvoid __init config_BSP(char *commandp, int size)\r\n{\r\nmach_sched_init = hw_timer_init;\r\nm527x_uarts_init();\r\nm527x_fec_init();\r\nm527x_qspi_init();\r\n}
