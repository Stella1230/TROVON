static int scif_dev_test(struct seq_file *s, void *unused)\r\n{\r\nint node;\r\nseq_printf(s, "Total Nodes %d Self Node Id %d Maxid %d\n",\r\nscif_info.total, scif_info.nodeid,\r\nscif_info.maxid);\r\nif (!scif_dev)\r\nreturn 0;\r\nseq_printf(s, "%-16s\t%-16s\n", "node_id", "state");\r\nfor (node = 0; node <= scif_info.maxid; node++)\r\nseq_printf(s, "%-16d\t%-16s\n", scif_dev[node].node,\r\n_scifdev_alive(&scif_dev[node]) ?\r\n"Running" : "Offline");\r\nreturn 0;\r\n}\r\nstatic int scif_dev_test_open(struct inode *inode, struct file *file)\r\n{\r\nreturn single_open(file, scif_dev_test, inode->i_private);\r\n}\r\nstatic int scif_dev_test_release(struct inode *inode, struct file *file)\r\n{\r\nreturn single_release(inode, file);\r\n}\r\nvoid __init scif_init_debugfs(void)\r\n{\r\nstruct dentry *d;\r\nscif_dbg = debugfs_create_dir(KBUILD_MODNAME, NULL);\r\nif (!scif_dbg) {\r\ndev_err(scif_info.mdev.this_device,\r\n"can't create debugfs dir scif\n");\r\nreturn;\r\n}\r\nd = debugfs_create_file("scif_dev", 0444, scif_dbg,\r\nNULL, &scif_dev_ops);\r\ndebugfs_create_u8("en_msg_log", 0666, scif_dbg, &scif_info.en_msg_log);\r\ndebugfs_create_u8("p2p_enable", 0666, scif_dbg, &scif_info.p2p_enable);\r\n}\r\nvoid scif_exit_debugfs(void)\r\n{\r\ndebugfs_remove_recursive(scif_dbg);\r\n}
