static struct rpc_auth *\r\nnul_create(struct rpc_auth_create_args *args, struct rpc_clnt *clnt)\r\n{\r\natomic_inc(&null_auth.au_count);\r\nreturn &null_auth;\r\n}\r\nstatic void\r\nnul_destroy(struct rpc_auth *auth)\r\n{\r\n}\r\nstatic struct rpc_cred *\r\nnul_lookup_cred(struct rpc_auth *auth, struct auth_cred *acred, int flags)\r\n{\r\nif (flags & RPCAUTH_LOOKUP_RCU)\r\nreturn &null_cred;\r\nreturn get_rpccred(&null_cred);\r\n}\r\nstatic void\r\nnul_destroy_cred(struct rpc_cred *cred)\r\n{\r\n}\r\nstatic int\r\nnul_match(struct auth_cred *acred, struct rpc_cred *cred, int taskflags)\r\n{\r\nreturn 1;\r\n}\r\nstatic __be32 *\r\nnul_marshal(struct rpc_task *task, __be32 *p)\r\n{\r\n*p++ = htonl(RPC_AUTH_NULL);\r\n*p++ = 0;\r\n*p++ = htonl(RPC_AUTH_NULL);\r\n*p++ = 0;\r\nreturn p;\r\n}\r\nstatic int\r\nnul_refresh(struct rpc_task *task)\r\n{\r\nset_bit(RPCAUTH_CRED_UPTODATE, &task->tk_rqstp->rq_cred->cr_flags);\r\nreturn 0;\r\n}\r\nstatic __be32 *\r\nnul_validate(struct rpc_task *task, __be32 *p)\r\n{\r\nrpc_authflavor_t flavor;\r\nu32 size;\r\nflavor = ntohl(*p++);\r\nif (flavor != RPC_AUTH_NULL) {\r\nprintk("RPC: bad verf flavor: %u\n", flavor);\r\nreturn ERR_PTR(-EIO);\r\n}\r\nsize = ntohl(*p++);\r\nif (size != 0) {\r\nprintk("RPC: bad verf size: %u\n", size);\r\nreturn ERR_PTR(-EIO);\r\n}\r\nreturn p;\r\n}
