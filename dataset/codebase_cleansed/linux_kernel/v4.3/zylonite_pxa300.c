static void __init zylonite_detect_lcd_panel(void)\r\n{\r\nunsigned long mfpr_save[NUM_LCD_DETECT_PINS];\r\nint i, gpio, id = 0;\r\nfor (i = 0; i < NUM_LCD_DETECT_PINS; i++) {\r\nmfpr_save[i] = pxa3xx_mfp_read(lcd_detect_pins[i]);\r\npxa3xx_mfp_write(lcd_detect_pins[i], 0x8440);\r\n}\r\nfor (i = 0; i < NUM_LCD_DETECT_PINS; i++) {\r\nid = id << 1;\r\ngpio = mfp_to_gpio(lcd_detect_pins[i]);\r\ngpio_request(gpio, "LCD_ID_PINS");\r\ngpio_direction_input(gpio);\r\nif (gpio_get_value(gpio))\r\nid = id | 0x1;\r\ngpio_free(gpio);\r\n}\r\nlcd_id = id & 0x3d;\r\nlcd_orientation = (id >> 6) & 0x1;\r\nfor (i = 0; i < NUM_LCD_DETECT_PINS; i++)\r\npxa3xx_mfp_write(lcd_detect_pins[i], mfpr_save[i]);\r\n}\r\nstatic void __init zylonite_init_i2c(void)\r\n{\r\npxa_set_i2c_info(NULL);\r\ni2c_register_board_info(0, ARRAY_AND_SIZE(zylonite_i2c_board_info));\r\n}\r\nstatic inline void zylonite_init_i2c(void) {}\r\nvoid __init zylonite_pxa300_init(void)\r\n{\r\nif (cpu_is_pxa300() || cpu_is_pxa310()) {\r\npxa3xx_mfp_config(ARRAY_AND_SIZE(common_mfp_cfg));\r\nzylonite_detect_lcd_panel();\r\nwm9713_irq = mfp_to_gpio(MFP_PIN_GPIO26);\r\nzylonite_init_i2c();\r\n}\r\nif (cpu_is_pxa300()) {\r\npxa3xx_mfp_config(ARRAY_AND_SIZE(pxa300_mfp_cfg));\r\ngpio_eth_irq = mfp_to_gpio(MFP_PIN_GPIO99);\r\n}\r\nif (cpu_is_pxa310()) {\r\npxa3xx_mfp_config(ARRAY_AND_SIZE(pxa310_mfp_cfg));\r\ngpio_eth_irq = mfp_to_gpio(MFP_PIN_GPIO102);\r\n}\r\ngpio_debug_led1 = EXT_GPIO(25);\r\ngpio_debug_led2 = EXT_GPIO(26);\r\n}
