void *libcfs_kvzalloc(size_t size, gfp_t flags)\r\n{\r\nvoid *ret;\r\nret = kzalloc(size, flags | __GFP_NOWARN);\r\nif (!ret)\r\nret = __vmalloc(size, flags | __GFP_ZERO, PAGE_KERNEL);\r\nreturn ret;\r\n}\r\nvoid *libcfs_kvzalloc_cpt(struct cfs_cpt_table *cptab, int cpt, size_t size,\r\ngfp_t flags)\r\n{\r\nvoid *ret;\r\nret = kzalloc_node(size, flags | __GFP_NOWARN,\r\ncfs_cpt_spread_node(cptab, cpt));\r\nif (!ret) {\r\nWARN_ON(!(flags & (__GFP_FS|__GFP_HIGH)));\r\nret = vmalloc_node(size, cfs_cpt_spread_node(cptab, cpt));\r\n}\r\nreturn ret;\r\n}
