static void kmsg_dumper_stdout(struct kmsg_dumper *dumper,\r\nenum kmsg_dump_reason reason)\r\n{\r\nstatic char line[1024];\r\nsize_t len = 0;\r\nbool con_available = false;\r\nif (!console_trylock())\r\nreturn;\r\nif (console_drivers != NULL)\r\ncon_available = true;\r\nconsole_unlock();\r\nif (con_available == true)\r\nreturn;\r\nprintf("kmsg_dump:\n");\r\nwhile (kmsg_dump_get_line(dumper, true, line, sizeof(line), &len)) {\r\nline[len] = '\0';\r\nprintf("%s", line);\r\n}\r\n}\r\nint __init kmsg_dumper_stdout_init(void)\r\n{\r\nreturn kmsg_dump_register(&kmsg_dumper);\r\n}
