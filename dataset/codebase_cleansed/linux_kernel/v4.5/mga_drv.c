static int __init mga_init(void)\r\n{\r\ndriver.num_ioctls = mga_max_ioctl;\r\nreturn drm_pci_init(&driver, &mga_pci_driver);\r\n}\r\nstatic void __exit mga_exit(void)\r\n{\r\ndrm_pci_exit(&driver, &mga_pci_driver);\r\n}\r\nstatic int mga_driver_device_is_agp(struct drm_device *dev)\r\n{\r\nconst struct pci_dev *const pdev = dev->pdev;\r\nif ((pdev->device == 0x0525) && pdev->bus->self\r\n&& (pdev->bus->self->vendor == 0x3388)\r\n&& (pdev->bus->self->device == 0x0021)) {\r\nreturn 0;\r\n}\r\nreturn 2;\r\n}
