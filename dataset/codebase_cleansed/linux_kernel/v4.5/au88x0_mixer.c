static int remove_ctl(struct snd_card *card, const char *name)\r\n{\r\nstruct snd_ctl_elem_id id;\r\nmemset(&id, 0, sizeof(id));\r\nstrcpy(id.name, name);\r\nid.iface = SNDRV_CTL_ELEM_IFACE_MIXER;\r\nreturn snd_ctl_remove_id(card, &id);\r\n}\r\nstatic int snd_vortex_mixer(vortex_t *vortex)\r\n{\r\nstruct snd_ac97_bus *pbus;\r\nstruct snd_ac97_template ac97;\r\nint err;\r\nstatic struct snd_ac97_bus_ops ops = {\r\n.write = vortex_codec_write,\r\n.read = vortex_codec_read,\r\n};\r\nif ((err = snd_ac97_bus(vortex->card, 0, &ops, NULL, &pbus)) < 0)\r\nreturn err;\r\nmemset(&ac97, 0, sizeof(ac97));\r\nac97.private_data = vortex;\r\nac97.scaps = AC97_SCAP_NO_SPDIF;\r\nerr = snd_ac97_mixer(pbus, &ac97, &vortex->codec);\r\nvortex->isquad = ((vortex->codec == NULL) ? 0 : (vortex->codec->ext_id&0x80));\r\nremove_ctl(vortex->card, "Master Mono Playback Volume");\r\nremove_ctl(vortex->card, "Master Mono Playback Switch");\r\nreturn err;\r\n}
