static int __init sh7785lcr_devices_setup(void)\r\n{\r\ni2c_register_board_info(0, sh7785lcr_i2c_devices,\r\nARRAY_SIZE(sh7785lcr_i2c_devices));\r\nif (mach_is_sh7785lcr_pt()) {\r\ni2c_device.resource = i2c_proto_resources;\r\ni2c_device.num_resources = ARRAY_SIZE(i2c_proto_resources);\r\n}\r\nreturn platform_add_devices(sh7785lcr_devices,\r\nARRAY_SIZE(sh7785lcr_devices));\r\n}\r\nvoid __init init_sh7785lcr_IRQ(void)\r\n{\r\nplat_irq_setup_pins(IRQ_MODE_IRQ7654);\r\nplat_irq_setup_pins(IRQ_MODE_IRQ3210);\r\n}\r\nstatic int sh7785lcr_clk_init(void)\r\n{\r\nstruct clk *clk;\r\nint ret;\r\nclk = clk_get(NULL, "extal");\r\nif (IS_ERR(clk))\r\nreturn PTR_ERR(clk);\r\nret = clk_set_rate(clk, 33333333);\r\nclk_put(clk);\r\nreturn ret;\r\n}\r\nstatic void sh7785lcr_power_off(void)\r\n{\r\nunsigned char *p;\r\np = ioremap(PLD_POFCR, PLD_POFCR + 1);\r\nif (!p) {\r\nprintk(KERN_ERR "%s: ioremap error.\n", __func__);\r\nreturn;\r\n}\r\n*p = 0x01;\r\niounmap(p);\r\nset_bl_bit();\r\nwhile (1)\r\ncpu_relax();\r\n}\r\nstatic void __init sh7785lcr_setup(char **cmdline_p)\r\n{\r\nvoid __iomem *sm501_reg;\r\nprintk(KERN_INFO "Renesas Technology Corp. R0P7785LC0011RL support.\n");\r\npm_power_off = sh7785lcr_power_off;\r\nsm501_reg = ioremap_nocache(SM107_REG_ADDR, SM501_DRAM_CONTROL);\r\nif (!sm501_reg) {\r\nprintk(KERN_ERR "%s: ioremap error.\n", __func__);\r\nreturn;\r\n}\r\nwritel(0x000307c2, sm501_reg + SM501_DRAM_CONTROL);\r\niounmap(sm501_reg);\r\n}\r\nstatic int sh7785lcr_mode_pins(void)\r\n{\r\nint value = 0;\r\nvalue |= MODE_PIN4;\r\nvalue |= MODE_PIN5;\r\nvalue |= MODE_PIN6;\r\nvalue |= MODE_PIN7;\r\nvalue |= MODE_PIN8;\r\nvalue |= MODE_PIN9;\r\nvalue |= MODE_PIN14;\r\nreturn value;\r\n}
