struct io_pgtable_ops *alloc_io_pgtable_ops(enum io_pgtable_fmt fmt,\r\nstruct io_pgtable_cfg *cfg,\r\nvoid *cookie)\r\n{\r\nstruct io_pgtable *iop;\r\nconst struct io_pgtable_init_fns *fns;\r\nif (fmt >= IO_PGTABLE_NUM_FMTS)\r\nreturn NULL;\r\nfns = io_pgtable_init_table[fmt];\r\nif (!fns)\r\nreturn NULL;\r\niop = fns->alloc(cfg, cookie);\r\nif (!iop)\r\nreturn NULL;\r\niop->fmt = fmt;\r\niop->cookie = cookie;\r\niop->cfg = *cfg;\r\nreturn &iop->ops;\r\n}\r\nvoid free_io_pgtable_ops(struct io_pgtable_ops *ops)\r\n{\r\nstruct io_pgtable *iop;\r\nif (!ops)\r\nreturn;\r\niop = container_of(ops, struct io_pgtable, ops);\r\niop->cfg.tlb->tlb_flush_all(iop->cookie);\r\nio_pgtable_init_table[iop->fmt]->free(iop);\r\n}
