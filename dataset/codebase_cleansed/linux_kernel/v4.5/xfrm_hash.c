struct hlist_head *xfrm_hash_alloc(unsigned int sz)\r\n{\r\nstruct hlist_head *n;\r\nif (sz <= PAGE_SIZE)\r\nn = kzalloc(sz, GFP_KERNEL);\r\nelse if (hashdist)\r\nn = vzalloc(sz);\r\nelse\r\nn = (struct hlist_head *)\r\n__get_free_pages(GFP_KERNEL | __GFP_NOWARN | __GFP_ZERO,\r\nget_order(sz));\r\nreturn n;\r\n}\r\nvoid xfrm_hash_free(struct hlist_head *n, unsigned int sz)\r\n{\r\nif (sz <= PAGE_SIZE)\r\nkfree(n);\r\nelse if (hashdist)\r\nvfree(n);\r\nelse\r\nfree_pages((unsigned long)n, get_order(sz));\r\n}
