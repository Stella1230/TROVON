void kernel_queue_init_vi(struct kernel_queue_ops *ops)\r\n{\r\nops->initialize = initialize_vi;\r\nops->uninitialize = uninitialize_vi;\r\n}\r\nstatic bool initialize_vi(struct kernel_queue *kq, struct kfd_dev *dev,\r\nenum kfd_queue_type type, unsigned int queue_size)\r\n{\r\nint retval;\r\nretval = kfd_gtt_sa_allocate(dev, PAGE_SIZE, &kq->eop_mem);\r\nif (retval != 0)\r\nreturn false;\r\nkq->eop_gpu_addr = kq->eop_mem->gpu_addr;\r\nkq->eop_kernel_addr = kq->eop_mem->cpu_ptr;\r\nmemset(kq->eop_kernel_addr, 0, PAGE_SIZE);\r\nreturn true;\r\n}\r\nstatic void uninitialize_vi(struct kernel_queue *kq)\r\n{\r\nkfd_gtt_sa_free(kq->dev, kq->eop_mem);\r\n}
