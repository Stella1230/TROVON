static int bcm_cygnus_afe_config(struct phy_device *phydev)\r\n{\r\nint rc;\r\nrc = phy_write(phydev, MII_BCM54XX_AUX_CTL, 0x0c30);\r\nif (rc < 0)\r\nreturn rc;\r\nrc = bcm_phy_write_misc(phydev, 0x39, 0x01, 0xA7C8);\r\nif (rc < 0)\r\nreturn rc;\r\nrc = bcm_phy_write_misc(phydev, 0x3A, 0x00, 0x0803);\r\nif (rc < 0)\r\nreturn rc;\r\nrc = bcm_phy_write_misc(phydev, 0x3A, 0x01, 0xA740);\r\nif (rc < 0)\r\nreturn rc;\r\nrc = bcm_phy_write_misc(phydev, 0x3A, 0x03, 0x8400);\r\nif (rc < 0)\r\nreturn rc;\r\nrc = bcm_phy_write_misc(phydev, 0x3B, 0x00, 0x0004);\r\nif (rc < 0)\r\nreturn rc;\r\nrc = phy_write(phydev, MII_BRCM_CORE_BASE1E, 0x02);\r\nif (rc < 0)\r\nreturn rc;\r\nrc = bcm_phy_write_exp(phydev, MII_BRCM_CORE_EXPB1, 0x10);\r\nif (rc < 0)\r\nreturn rc;\r\nrc = bcm_phy_write_exp(phydev, MII_BRCM_CORE_EXPB0, 0x10);\r\nif (rc < 0)\r\nreturn rc;\r\nrc = bcm_phy_write_exp(phydev, MII_BRCM_CORE_EXPB0, 0x00);\r\nreturn 0;\r\n}\r\nstatic int bcm_cygnus_config_init(struct phy_device *phydev)\r\n{\r\nint reg, rc;\r\nreg = phy_read(phydev, MII_BCM54XX_ECR);\r\nif (reg < 0)\r\nreturn reg;\r\nreg |= MII_BCM54XX_ECR_IM;\r\nrc = phy_write(phydev, MII_BCM54XX_ECR, reg);\r\nif (rc)\r\nreturn rc;\r\nreg = ~(MII_BCM54XX_INT_DUPLEX |\r\nMII_BCM54XX_INT_SPEED |\r\nMII_BCM54XX_INT_LINK);\r\nrc = phy_write(phydev, MII_BCM54XX_IMR, reg);\r\nif (rc)\r\nreturn rc;\r\nrc = bcm_cygnus_afe_config(phydev);\r\nif (rc)\r\nreturn rc;\r\nrc = bcm_phy_enable_eee(phydev);\r\nif (rc)\r\nreturn rc;\r\nreturn bcm_phy_enable_apd(phydev, false);\r\n}\r\nstatic int bcm_cygnus_resume(struct phy_device *phydev)\r\n{\r\nint rc;\r\ngenphy_resume(phydev);\r\nrc = bcm_cygnus_config_init(phydev);\r\nif (rc)\r\nreturn rc;\r\nreturn genphy_config_aneg(phydev);\r\n}
