static void nft_masq_ipv4_eval(const struct nft_expr *expr,\r\nstruct nft_regs *regs,\r\nconst struct nft_pktinfo *pkt)\r\n{\r\nstruct nft_masq *priv = nft_expr_priv(expr);\r\nstruct nf_nat_range range;\r\nmemset(&range, 0, sizeof(range));\r\nrange.flags = priv->flags;\r\nregs->verdict.code = nf_nat_masquerade_ipv4(pkt->skb, pkt->hook,\r\n&range, pkt->out);\r\n}\r\nstatic int __init nft_masq_ipv4_module_init(void)\r\n{\r\nint ret;\r\nret = nft_register_expr(&nft_masq_ipv4_type);\r\nif (ret < 0)\r\nreturn ret;\r\nnf_nat_masquerade_ipv4_register_notifier();\r\nreturn ret;\r\n}\r\nstatic void __exit nft_masq_ipv4_module_exit(void)\r\n{\r\nnft_unregister_expr(&nft_masq_ipv4_type);\r\nnf_nat_masquerade_ipv4_unregister_notifier();\r\n}
