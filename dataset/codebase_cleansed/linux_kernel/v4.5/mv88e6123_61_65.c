static char *mv88e6123_61_65_probe(struct device *host_dev, int sw_addr)\r\n{\r\nreturn mv88e6xxx_lookup_name(host_dev, sw_addr, mv88e6123_61_65_table,\r\nARRAY_SIZE(mv88e6123_61_65_table));\r\n}\r\nstatic int mv88e6123_61_65_setup_global(struct dsa_switch *ds)\r\n{\r\nu32 upstream_port = dsa_upstream_port(ds);\r\nint ret;\r\nu32 reg;\r\nret = mv88e6xxx_setup_global(ds);\r\nif (ret)\r\nreturn ret;\r\nREG_WRITE(REG_GLOBAL, GLOBAL_CONTROL, 0x0000);\r\nreg = upstream_port << GLOBAL_MONITOR_CONTROL_INGRESS_SHIFT |\r\nupstream_port << GLOBAL_MONITOR_CONTROL_EGRESS_SHIFT |\r\nupstream_port << GLOBAL_MONITOR_CONTROL_ARP_SHIFT;\r\nREG_WRITE(REG_GLOBAL, GLOBAL_MONITOR_CONTROL, reg);\r\nREG_WRITE(REG_GLOBAL, GLOBAL_CONTROL_2, ds->index & 0x1f);\r\nreturn 0;\r\n}\r\nstatic int mv88e6123_61_65_setup(struct dsa_switch *ds)\r\n{\r\nstruct mv88e6xxx_priv_state *ps = ds_to_priv(ds);\r\nint ret;\r\nret = mv88e6xxx_setup_common(ds);\r\nif (ret < 0)\r\nreturn ret;\r\nswitch (ps->id) {\r\ncase PORT_SWITCH_ID_6123:\r\nps->num_ports = 3;\r\nbreak;\r\ncase PORT_SWITCH_ID_6161:\r\ncase PORT_SWITCH_ID_6165:\r\nps->num_ports = 6;\r\nbreak;\r\ndefault:\r\nreturn -ENODEV;\r\n}\r\nret = mv88e6xxx_switch_reset(ds, false);\r\nif (ret < 0)\r\nreturn ret;\r\nret = mv88e6123_61_65_setup_global(ds);\r\nif (ret < 0)\r\nreturn ret;\r\nreturn mv88e6xxx_setup_ports(ds);\r\n}
