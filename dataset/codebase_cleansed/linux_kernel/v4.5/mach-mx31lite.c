static int usbh2_init(struct platform_device *pdev)\r\n{\r\nint pins[] = {\r\nMX31_PIN_USBH2_DATA0__USBH2_DATA0,\r\nMX31_PIN_USBH2_DATA1__USBH2_DATA1,\r\nMX31_PIN_USBH2_CLK__USBH2_CLK,\r\nMX31_PIN_USBH2_DIR__USBH2_DIR,\r\nMX31_PIN_USBH2_NXT__USBH2_NXT,\r\nMX31_PIN_USBH2_STP__USBH2_STP,\r\n};\r\nmxc_iomux_setup_multiple_pins(pins, ARRAY_SIZE(pins), "USB H2");\r\nmxc_iomux_set_pad(MX31_PIN_USBH2_CLK, USB_PAD_CFG);\r\nmxc_iomux_set_pad(MX31_PIN_USBH2_DIR, USB_PAD_CFG);\r\nmxc_iomux_set_pad(MX31_PIN_USBH2_NXT, USB_PAD_CFG);\r\nmxc_iomux_set_pad(MX31_PIN_USBH2_STP, USB_PAD_CFG);\r\nmxc_iomux_set_pad(MX31_PIN_USBH2_DATA0, USB_PAD_CFG);\r\nmxc_iomux_set_pad(MX31_PIN_USBH2_DATA1, USB_PAD_CFG);\r\nmxc_iomux_set_pad(MX31_PIN_SRXD6, USB_PAD_CFG);\r\nmxc_iomux_set_pad(MX31_PIN_STXD6, USB_PAD_CFG);\r\nmxc_iomux_set_pad(MX31_PIN_SFS3, USB_PAD_CFG);\r\nmxc_iomux_set_pad(MX31_PIN_SCK3, USB_PAD_CFG);\r\nmxc_iomux_set_pad(MX31_PIN_SRXD3, USB_PAD_CFG);\r\nmxc_iomux_set_pad(MX31_PIN_STXD3, USB_PAD_CFG);\r\nmxc_iomux_set_gpr(MUX_PGP_UH2, true);\r\nmxc_iomux_alloc_pin(IOMUX_MODE(MX31_PIN_DTR_DCE1, IOMUX_CONFIG_GPIO),\r\n"USBH2_CS");\r\ngpio_request(IOMUX_TO_GPIO(MX31_PIN_DTR_DCE1), "USBH2 CS");\r\ngpio_direction_output(IOMUX_TO_GPIO(MX31_PIN_DTR_DCE1), 0);\r\nmdelay(10);\r\nreturn mx31_initialize_usb_hw(pdev->id, MXC_EHCI_POWER_PINS_ENABLED);\r\n}\r\nvoid __init mx31lite_map_io(void)\r\n{\r\nmx31_map_io();\r\niotable_init(mx31lite_io_desc, ARRAY_SIZE(mx31lite_io_desc));\r\n}\r\nstatic void __init mx31lite_init(void)\r\n{\r\nint ret;\r\nimx31_soc_init();\r\nswitch (mx31lite_baseboard) {\r\ncase MX31LITE_NOBOARD:\r\nbreak;\r\ncase MX31LITE_DB:\r\nmx31lite_db_init();\r\nbreak;\r\ndefault:\r\nprintk(KERN_ERR "Illegal mx31lite_baseboard type %d\n",\r\nmx31lite_baseboard);\r\n}\r\nmxc_iomux_setup_multiple_pins(mx31lite_pins, ARRAY_SIZE(mx31lite_pins),\r\n"mx31lite");\r\nplatform_device_register(&physmap_flash_device);\r\nimx31_add_mxc_nand(&mx31lite_nand_board_info);\r\nimx31_add_spi_imx1(&spi1_pdata);\r\nmc13783_spi_dev.irq = gpio_to_irq(IOMUX_TO_GPIO(MX31_PIN_GPIO1_3));\r\nspi_register_board_info(&mc13783_spi_dev, 1);\r\nusbh2_pdata.otg = imx_otg_ulpi_create(ULPI_OTG_DRVVBUS |\r\nULPI_OTG_DRVVBUS_EXT);\r\nif (usbh2_pdata.otg)\r\nimx31_add_mxc_ehci_hs(2, &usbh2_pdata);\r\nregulator_register_fixed(0, dummy_supplies, ARRAY_SIZE(dummy_supplies));\r\nret = gpio_request(IOMUX_TO_GPIO(MX31_PIN_SFS6), "sms9117-irq");\r\nif (ret)\r\npr_warn("could not get LAN irq gpio\n");\r\nelse {\r\ngpio_direction_input(IOMUX_TO_GPIO(MX31_PIN_SFS6));\r\nsmsc911x_resources[1].start =\r\ngpio_to_irq(IOMUX_TO_GPIO(MX31_PIN_SFS6));\r\nsmsc911x_resources[1].end =\r\ngpio_to_irq(IOMUX_TO_GPIO(MX31_PIN_SFS6));\r\nplatform_device_register(&smsc911x_device);\r\n}\r\n}\r\nstatic void __init mx31lite_timer_init(void)\r\n{\r\nmx31_clocks_init(26000000);\r\n}
