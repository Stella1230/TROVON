static void bcmring_restart(char mode, const char *cmd)\r\n{\r\nprintk("arch_reset:%c %x\n", mode, bcmring_arch_warm_reboot);\r\nif (mode == 'h') {\r\nif (bcmring_arch_warm_reboot) {\r\nprintk("warm reset\n");\r\nchipcHw_reset(chipcHw_REG_SOFT_RESET_CHIP_WARM);\r\n} else {\r\nprintk("force reset\n");\r\nchipcHw_reset(chipcHw_REG_SOFT_RESET_CHIP_SOFT);\r\n}\r\n} else {\r\nprintk("force reset\n");\r\nchipcHw_reset(chipcHw_REG_SOFT_RESET_CHIP_SOFT);\r\n}\r\n}\r\nstatic void __init bcmring_init_machine(void)\r\n{\r\nbcmring_sysctl_header = register_sysctl_table(bcmring_sysctl_reboot);\r\nchipcHw_enableSpreadSpectrum();\r\nplatform_add_devices(devices, ARRAY_SIZE(devices));\r\nbcmring_amba_init();\r\ndma_init();\r\n}\r\nstatic void __init bcmring_fixup(struct tag *t, char **cmdline,\r\nstruct meminfo *mi) {\r\n#ifdef CONFIG_BLK_DEV_INITRD\r\nprintk(KERN_NOTICE "bcmring_fixup\n");\r\nt->hdr.tag = ATAG_CORE;\r\nt->hdr.size = tag_size(tag_core);\r\nt->u.core.flags = 0;\r\nt->u.core.pagesize = PAGE_SIZE;\r\nt->u.core.rootdev = 31 << 8 | 0;\r\nt = tag_next(t);\r\nt->hdr.tag = ATAG_MEM;\r\nt->hdr.size = tag_size(tag_mem32);\r\nt->u.mem.start = CFG_GLOBAL_RAM_BASE;\r\nt->u.mem.size = CFG_GLOBAL_RAM_SIZE;\r\nt = tag_next(t);\r\nt->hdr.tag = ATAG_NONE;\r\nt->hdr.size = 0;\r\n#endif\r\n}
