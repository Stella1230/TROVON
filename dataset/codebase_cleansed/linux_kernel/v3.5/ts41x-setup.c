static void __init qnap_ts41x_init(void)\r\n{\r\nu32 dev, rev;\r\nkirkwood_init();\r\nkirkwood_mpp_conf(qnap_ts41x_mpp_config);\r\nkirkwood_uart0_init();\r\nkirkwood_uart1_init();\r\nqnap_tsx1x_register_flash();\r\nkirkwood_i2c_init();\r\ni2c_register_board_info(0, &qnap_ts41x_i2c_rtc, 1);\r\nkirkwood_pcie_id(&dev, &rev);\r\nif (dev == MV88F6282_DEV_ID) {\r\nqnap_ts41x_ge00_data.phy_addr = MV643XX_ETH_PHY_ADDR(0);\r\nqnap_ts41x_ge01_data.phy_addr = MV643XX_ETH_PHY_ADDR(1);\r\n}\r\nkirkwood_ge00_init(&qnap_ts41x_ge00_data);\r\nkirkwood_ge01_init(&qnap_ts41x_ge01_data);\r\nkirkwood_sata_init(&qnap_ts41x_sata_data);\r\nkirkwood_ehci_init();\r\nplatform_device_register(&qnap_ts41x_button_device);\r\npm_power_off = qnap_tsx1x_power_off;\r\nif (gpio_request(QNAP_TS41X_JUMPER_JP1, "JP1") == 0)\r\ngpio_export(QNAP_TS41X_JUMPER_JP1, 0);\r\n}\r\nstatic int __init ts41x_pci_init(void)\r\n{\r\nif (machine_is_ts41x()) {\r\nu32 dev, rev;\r\norion_pcie_reset((void __iomem *)PCIE_VIRT_BASE);\r\nkirkwood_pcie_id(&dev, &rev);\r\nif (dev == MV88F6282_DEV_ID)\r\nkirkwood_pcie_init(KW_PCIE1 | KW_PCIE0);\r\nelse\r\nkirkwood_pcie_init(KW_PCIE0);\r\n}\r\nreturn 0;\r\n}
