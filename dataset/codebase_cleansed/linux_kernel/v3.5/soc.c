int soc_get_exception(void)\r\n{\r\nif (!soc_ops.get_exception)\r\nreturn -1;\r\nreturn soc_ops.get_exception();\r\n}\r\nvoid soc_assert_event(unsigned int evt)\r\n{\r\nif (soc_ops.assert_event)\r\nsoc_ops.assert_event(evt);\r\n}\r\nstatic int __init get_mac_addr_from_cmdline(char *str)\r\n{\r\nint count, i, val;\r\nfor (count = 0; count < 6 && *str; count++, str += 3) {\r\nif (!isxdigit(str[0]) || !isxdigit(str[1]))\r\nreturn 0;\r\nif (str[2] != ((count < 5) ? ':' : '\0'))\r\nreturn 0;\r\nfor (i = 0, val = 0; i < 2; i++) {\r\nval = val << 4;\r\nval |= isdigit(str[i]) ?\r\nstr[i] - '0' : toupper(str[i]) - 'A' + 10;\r\n}\r\ncmdline_mac[count] = val;\r\n}\r\nreturn 1;\r\n}\r\nint soc_mac_addr(unsigned int index, u8 *addr)\r\n{\r\nint i, have_dt_mac = 0, have_cmdline_mac = 0, have_fuse_mac = 0;\r\nfor (i = 0; i < 6; i++) {\r\nif (cmdline_mac[i])\r\nhave_cmdline_mac = 1;\r\nif (c6x_fuse_mac[i])\r\nhave_fuse_mac = 1;\r\nif (addr[i])\r\nhave_dt_mac = 1;\r\n}\r\nif (have_cmdline_mac)\r\nmemcpy(addr, cmdline_mac, 6);\r\nelse if (!have_dt_mac) {\r\nif (have_fuse_mac)\r\nmemcpy(addr, c6x_fuse_mac, 6);\r\nelse\r\nrandom_ether_addr(addr);\r\n}\r\naddr[5] += index * c6x_num_cores;\r\nreturn 1;\r\n}
