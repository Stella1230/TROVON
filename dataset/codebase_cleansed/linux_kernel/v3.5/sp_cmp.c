int ieee754sp_cmp(ieee754sp x, ieee754sp y, int cmp, int sig)\r\n{\r\nCOMPXSP;\r\nCOMPYSP;\r\nEXPLODEXSP;\r\nEXPLODEYSP;\r\nFLUSHXSP;\r\nFLUSHYSP;\r\nCLEARCX;\r\nif (ieee754sp_isnan(x) || ieee754sp_isnan(y)) {\r\nif (sig || xc == IEEE754_CLASS_SNAN || yc == IEEE754_CLASS_SNAN)\r\nSETCX(IEEE754_INVALID_OPERATION);\r\nif (cmp & IEEE754_CUN)\r\nreturn 1;\r\nif (cmp & (IEEE754_CLT | IEEE754_CGT)) {\r\nif (sig && SETANDTESTCX(IEEE754_INVALID_OPERATION))\r\nreturn ieee754si_xcpt(0, "fcmpf", x);\r\n}\r\nreturn 0;\r\n} else {\r\nint vx = x.bits;\r\nint vy = y.bits;\r\nif (vx < 0)\r\nvx = -vx ^ SP_SIGN_BIT;\r\nif (vy < 0)\r\nvy = -vy ^ SP_SIGN_BIT;\r\nif (vx < vy)\r\nreturn (cmp & IEEE754_CLT) != 0;\r\nelse if (vx == vy)\r\nreturn (cmp & IEEE754_CEQ) != 0;\r\nelse\r\nreturn (cmp & IEEE754_CGT) != 0;\r\n}\r\n}
