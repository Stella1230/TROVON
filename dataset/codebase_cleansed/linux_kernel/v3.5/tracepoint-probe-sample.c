static void probe_subsys_event(void *ignore,\r\nstruct inode *inode, struct file *file)\r\n{\r\npath_get(&file->f_path);\r\ndget(file->f_path.dentry);\r\nprintk(KERN_INFO "Event is encountered with filename %s\n",\r\nfile->f_path.dentry->d_name.name);\r\ndput(file->f_path.dentry);\r\npath_put(&file->f_path);\r\n}\r\nstatic void probe_subsys_eventb(void *ignore)\r\n{\r\nprintk(KERN_INFO "Event B is encountered\n");\r\n}\r\nstatic int __init tp_sample_trace_init(void)\r\n{\r\nint ret;\r\nret = register_trace_subsys_event(probe_subsys_event, NULL);\r\nWARN_ON(ret);\r\nret = register_trace_subsys_eventb(probe_subsys_eventb, NULL);\r\nWARN_ON(ret);\r\nreturn 0;\r\n}\r\nstatic void __exit tp_sample_trace_exit(void)\r\n{\r\nunregister_trace_subsys_eventb(probe_subsys_eventb, NULL);\r\nunregister_trace_subsys_event(probe_subsys_event, NULL);\r\ntracepoint_synchronize_unregister();\r\n}
