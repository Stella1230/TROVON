void * __devinit eeh_dev_init(struct device_node *dn, void *data)\r\n{\r\nstruct pci_controller *phb = data;\r\nstruct eeh_dev *edev;\r\nedev = zalloc_maybe_bootmem(sizeof(*edev), GFP_KERNEL);\r\nif (!edev) {\r\npr_warning("%s: out of memory\n", __func__);\r\nreturn NULL;\r\n}\r\nPCI_DN(dn)->edev = edev;\r\nedev->dn = dn;\r\nedev->phb = phb;\r\nreturn NULL;\r\n}\r\nvoid __devinit eeh_dev_phb_init_dynamic(struct pci_controller *phb)\r\n{\r\nstruct device_node *dn = phb->dn;\r\neeh_dev_init(dn, phb);\r\ntraverse_pci_devices(dn, eeh_dev_init, phb);\r\n}\r\nvoid __init eeh_dev_phb_init(void)\r\n{\r\nstruct pci_controller *phb, *tmp;\r\nlist_for_each_entry_safe(phb, tmp, &hose_list, list_node)\r\neeh_dev_phb_init_dynamic(phb);\r\n}
