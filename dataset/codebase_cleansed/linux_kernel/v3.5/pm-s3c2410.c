static void s3c2410_pm_prepare(void)\r\n{\r\n__raw_writel(virt_to_phys(s3c_cpu_resume), S3C2410_GSTATUS3);\r\nS3C_PMDBG("GSTATUS3 0x%08x\n", __raw_readl(S3C2410_GSTATUS3));\r\nS3C_PMDBG("GSTATUS4 0x%08x\n", __raw_readl(S3C2410_GSTATUS4));\r\nif (machine_is_h1940()) {\r\nvoid *base = phys_to_virt(H1940_SUSPEND_CHECK);\r\nunsigned long ptr;\r\nunsigned long calc = 0;\r\nfor (ptr = 0; ptr < 0x40000; ptr += 0x400)\r\ncalc += __raw_readl(base+ptr);\r\n__raw_writel(calc, phys_to_virt(H1940_SUSPEND_CHECKSUM));\r\n}\r\nif (machine_is_rx3715() || machine_is_rx1950()) {\r\nvoid *base = phys_to_virt(H1940_SUSPEND_CHECK);\r\nunsigned long ptr;\r\nunsigned long calc = 0;\r\nfor (ptr = 0; ptr < 0x40000; ptr += 0x4)\r\ncalc += __raw_readl(base+ptr);\r\n__raw_writel(calc, phys_to_virt(H1940_SUSPEND_CHECKSUM));\r\n}\r\nif ( machine_is_aml_m5900() )\r\ns3c2410_gpio_setpin(S3C2410_GPF(2), 1);\r\nif (machine_is_rx1950()) {\r\ns3c_gpio_cfgpin(S3C2410_GPG(13), S3C2410_GPIO_INPUT);\r\ns3c_gpio_cfgpin(S3C2410_GPG(14), S3C2410_GPIO_INPUT);\r\ns3c_gpio_cfgpin(S3C2410_GPG(15), S3C2410_GPIO_INPUT);\r\n}\r\n}\r\nstatic void s3c2410_pm_resume(void)\r\n{\r\nunsigned long tmp;\r\ntmp = __raw_readl(S3C2410_GSTATUS2);\r\ntmp &= S3C2410_GSTATUS2_OFFRESET;\r\n__raw_writel(tmp, S3C2410_GSTATUS2);\r\nif ( machine_is_aml_m5900() )\r\ns3c2410_gpio_setpin(S3C2410_GPF(2), 0);\r\n}\r\nstatic int s3c2410_pm_add(struct device *dev, struct subsys_interface *sif)\r\n{\r\npm_cpu_prep = s3c2410_pm_prepare;\r\npm_cpu_sleep = s3c2410_cpu_suspend;\r\nreturn 0;\r\n}\r\nstatic int __init s3c2410_pm_drvinit(void)\r\n{\r\nreturn subsys_interface_register(&s3c2410_pm_interface);\r\n}\r\nstatic int __init s3c2410a_pm_drvinit(void)\r\n{\r\nreturn subsys_interface_register(&s3c2410a_pm_interface);\r\n}\r\nstatic int __init s3c2440_pm_drvinit(void)\r\n{\r\nreturn subsys_interface_register(&s3c2440_pm_interface);\r\n}\r\nstatic int __init s3c2442_pm_drvinit(void)\r\n{\r\nreturn subsys_interface_register(&s3c2442_pm_interface);\r\n}
