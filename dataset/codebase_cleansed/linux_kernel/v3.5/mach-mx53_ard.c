static void __init mx53_ard_io_init(void)\r\n{\r\ngpio_request(ARD_ETHERNET_INT_B, "eth-int-b");\r\ngpio_direction_input(ARD_ETHERNET_INT_B);\r\ngpio_request(ARD_I2CPORTEXP_B, "i2cptexp-rst");\r\ngpio_direction_output(ARD_I2CPORTEXP_B, 1);\r\n}\r\nstatic int weim_cs_config(void)\r\n{\r\nu32 reg;\r\nvoid __iomem *weim_base, *iomuxc_base;\r\nweim_base = ioremap(MX53_WEIM_BASE_ADDR, SZ_4K);\r\nif (!weim_base)\r\nreturn -ENOMEM;\r\niomuxc_base = ioremap(MX53_IOMUXC_BASE_ADDR, SZ_4K);\r\nif (!iomuxc_base) {\r\niounmap(weim_base);\r\nreturn -ENOMEM;\r\n}\r\nwritel(0x20001, (weim_base + 0x18));\r\nwritel(0x0, (weim_base + 0x1C));\r\nwritel(0x16000202, (weim_base + 0x20));\r\nwritel(0x00000002, (weim_base + 0x24));\r\nwritel(0x16002082, (weim_base + 0x28));\r\nwritel(0x00000000, (weim_base + 0x2C));\r\nwritel(0x00000000, (weim_base + 0x90));\r\nreg = readl(iomuxc_base + 0x4);\r\nreg &= ~0x3F;\r\nreg |= 0x1B;\r\nwritel(reg, (iomuxc_base + 0x4));\r\niounmap(iomuxc_base);\r\niounmap(weim_base);\r\nreturn 0;\r\n}\r\nvoid __init imx53_ard_common_init(void)\r\n{\r\nmxc_iomux_v3_setup_multiple_pads(mx53_ard_pads,\r\nARRAY_SIZE(mx53_ard_pads));\r\nweim_cs_config();\r\n}\r\nstatic void __init mx53_ard_board_init(void)\r\n{\r\nimx53_soc_init();\r\nimx53_add_imx_uart(0, NULL);\r\nimx53_ard_common_init();\r\nmx53_ard_io_init();\r\nregulator_register_fixed(0, dummy_supplies, ARRAY_SIZE(dummy_supplies));\r\nplatform_add_devices(devices, ARRAY_SIZE(devices));\r\nimx53_add_sdhci_esdhc_imx(0, &mx53_ard_sd1_data);\r\nimx53_add_imx2_wdt(0, NULL);\r\nimx53_add_imx_i2c(1, &mx53_ard_i2c2_data);\r\nimx53_add_imx_i2c(2, &mx53_ard_i2c3_data);\r\nimx_add_gpio_keys(&ard_button_data);\r\nimx53_add_ahci_imx();\r\n}\r\nstatic void __init mx53_ard_timer_init(void)\r\n{\r\nmx53_clocks_init(32768, 24000000, 22579200, 0);\r\n}
