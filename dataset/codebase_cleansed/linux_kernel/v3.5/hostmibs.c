INT ProcessGetHostMibs(PMINI_ADAPTER Adapter, S_MIBS_HOST_STATS_MIBS *pstHostMibs)\r\n{\r\nS_SERVICEFLOW_ENTRY *pstServiceFlowEntry = NULL;\r\nS_PHS_RULE *pstPhsRule = NULL;\r\nS_CLASSIFIER_TABLE *pstClassifierTable = NULL;\r\nS_CLASSIFIER_ENTRY *pstClassifierRule = NULL;\r\nPPHS_DEVICE_EXTENSION pDeviceExtension = (PPHS_DEVICE_EXTENSION) &Adapter->stBCMPhsContext;\r\nUINT nClassifierIndex = 0, nPhsTableIndex = 0, nSfIndex = 0, uiIndex = 0;\r\nif (pDeviceExtension == NULL) {\r\nBCM_DEBUG_PRINT(Adapter, DBG_TYPE_OTHERS, HOST_MIBS, DBG_LVL_ALL, "Invalid Device Extension\n");\r\nreturn STATUS_FAILURE;\r\n}\r\nfor (nClassifierIndex = 0; nClassifierIndex < MAX_CLASSIFIERS; nClassifierIndex++) {\r\nif (Adapter->astClassifierTable[nClassifierIndex].bUsed == TRUE)\r\nmemcpy((PVOID) & pstHostMibs->\r\nastClassifierTable[nClassifierIndex],\r\n(PVOID) & Adapter->\r\nastClassifierTable[nClassifierIndex],\r\nsizeof(S_MIBS_CLASSIFIER_RULE));\r\n}\r\nfor (nSfIndex = 0; nSfIndex < NO_OF_QUEUES; nSfIndex++) {\r\nif (Adapter->PackInfo[nSfIndex].bValid) {\r\nmemcpy((PVOID) & pstHostMibs->astSFtable[nSfIndex],\r\n(PVOID) & Adapter->PackInfo[nSfIndex],\r\nsizeof(S_MIBS_SERVICEFLOW_TABLE));\r\n} else {\r\ncontinue;\r\n}\r\nif (PHS_INVALID_TABLE_INDEX ==\r\nGetServiceFlowEntry(pDeviceExtension->\r\npstServiceFlowPhsRulesTable,\r\nAdapter->PackInfo[nSfIndex].\r\nusVCID_Value, &pstServiceFlowEntry))\r\ncontinue;\r\npstClassifierTable = pstServiceFlowEntry->pstClassifierTable;\r\nfor (uiIndex = 0; uiIndex < MAX_PHSRULE_PER_SF; uiIndex++) {\r\npstClassifierRule = &pstClassifierTable->stActivePhsRulesList[uiIndex];\r\nif (pstClassifierRule->bUsed) {\r\npstPhsRule = pstClassifierRule->pstPhsRule;\r\npstHostMibs->astPhsRulesTable[nPhsTableIndex].\r\nulSFID = Adapter->PackInfo[nSfIndex].ulSFID;\r\nmemcpy(&pstHostMibs->\r\nastPhsRulesTable[nPhsTableIndex].u8PHSI,\r\n&pstPhsRule->u8PHSI, sizeof(S_PHS_RULE));\r\nnPhsTableIndex++;\r\n}\r\n}\r\n}\r\npstHostMibs->stHostInfo.GoodTransmits = Adapter->dev->stats.tx_packets;\r\npstHostMibs->stHostInfo.GoodReceives = Adapter->dev->stats.rx_packets;\r\npstHostMibs->stHostInfo.CurrNumFreeDesc = atomic_read(&Adapter->CurrNumFreeTxDesc);\r\npstHostMibs->stHostInfo.BEBucketSize = Adapter->BEBucketSize;\r\npstHostMibs->stHostInfo.rtPSBucketSize = Adapter->rtPSBucketSize;\r\npstHostMibs->stHostInfo.TimerActive = Adapter->TimerActive;\r\npstHostMibs->stHostInfo.u32TotalDSD = Adapter->u32TotalDSD;\r\nmemcpy(pstHostMibs->stHostInfo.aTxPktSizeHist, Adapter->aTxPktSizeHist, sizeof(UINT32) * MIBS_MAX_HIST_ENTRIES);\r\nmemcpy(pstHostMibs->stHostInfo.aRxPktSizeHist, Adapter->aRxPktSizeHist, sizeof(UINT32) * MIBS_MAX_HIST_ENTRIES);\r\nreturn STATUS_SUCCESS;\r\n}\r\nVOID GetDroppedAppCntrlPktMibs(S_MIBS_HOST_STATS_MIBS *pstHostMibs, const PPER_TARANG_DATA pTarang)\r\n{\r\nmemcpy(&(pstHostMibs->stDroppedAppCntrlMsgs),\r\n&(pTarang->stDroppedAppCntrlMsgs),\r\nsizeof(S_MIBS_DROPPED_APP_CNTRL_MESSAGES));\r\n}\r\nVOID CopyMIBSExtendedSFParameters(PMINI_ADAPTER Adapter, CServiceFlowParamSI *psfLocalSet, UINT uiSearchRuleIndex)\r\n{\r\nS_MIBS_EXTSERVICEFLOW_PARAMETERS *t = &Adapter->PackInfo[uiSearchRuleIndex].stMibsExtServiceFlowTable;\r\nt->wmanIfSfid = psfLocalSet->u32SFID;\r\nt->wmanIfCmnCpsMaxSustainedRate = psfLocalSet->u32MaxSustainedTrafficRate;\r\nt->wmanIfCmnCpsMaxTrafficBurst = psfLocalSet->u32MaxTrafficBurst;\r\nt->wmanIfCmnCpsMinReservedRate = psfLocalSet->u32MinReservedTrafficRate;\r\nt->wmanIfCmnCpsToleratedJitter = psfLocalSet->u32ToleratedJitter;\r\nt->wmanIfCmnCpsMaxLatency = psfLocalSet->u32MaximumLatency;\r\nt->wmanIfCmnCpsFixedVsVariableSduInd = psfLocalSet->u8FixedLengthVSVariableLengthSDUIndicator;\r\nt->wmanIfCmnCpsFixedVsVariableSduInd = ntohl(t->wmanIfCmnCpsFixedVsVariableSduInd);\r\nt->wmanIfCmnCpsSduSize = psfLocalSet->u8SDUSize;\r\nt->wmanIfCmnCpsSduSize = ntohl(t->wmanIfCmnCpsSduSize);\r\nt->wmanIfCmnCpsSfSchedulingType = psfLocalSet->u8ServiceFlowSchedulingType;\r\nt->wmanIfCmnCpsSfSchedulingType = ntohl(t->wmanIfCmnCpsSfSchedulingType);\r\nt->wmanIfCmnCpsArqEnable = psfLocalSet->u8ARQEnable;\r\nt->wmanIfCmnCpsArqEnable = ntohl(t->wmanIfCmnCpsArqEnable);\r\nt->wmanIfCmnCpsArqWindowSize = ntohs(psfLocalSet->u16ARQWindowSize);\r\nt->wmanIfCmnCpsArqWindowSize = ntohl(t->wmanIfCmnCpsArqWindowSize);\r\nt->wmanIfCmnCpsArqBlockLifetime = ntohs(psfLocalSet->u16ARQBlockLifeTime);\r\nt->wmanIfCmnCpsArqBlockLifetime = ntohl(t->wmanIfCmnCpsArqBlockLifetime);\r\nt->wmanIfCmnCpsArqSyncLossTimeout = ntohs(psfLocalSet->u16ARQSyncLossTimeOut);\r\nt->wmanIfCmnCpsArqSyncLossTimeout = ntohl(t->wmanIfCmnCpsArqSyncLossTimeout);\r\nt->wmanIfCmnCpsArqDeliverInOrder = psfLocalSet->u8ARQDeliverInOrder;\r\nt->wmanIfCmnCpsArqDeliverInOrder = ntohl(t->wmanIfCmnCpsArqDeliverInOrder);\r\nt->wmanIfCmnCpsArqRxPurgeTimeout = ntohs(psfLocalSet->u16ARQRxPurgeTimeOut);\r\nt->wmanIfCmnCpsArqRxPurgeTimeout = ntohl(t->wmanIfCmnCpsArqRxPurgeTimeout);\r\nt->wmanIfCmnCpsArqBlockSize = ntohs(psfLocalSet->u16ARQBlockSize);\r\nt->wmanIfCmnCpsArqBlockSize = ntohl(t->wmanIfCmnCpsArqBlockSize);\r\nt->wmanIfCmnCpsReqTxPolicy = psfLocalSet->u8RequesttransmissionPolicy;\r\nt->wmanIfCmnCpsReqTxPolicy = ntohl(t->wmanIfCmnCpsReqTxPolicy);\r\nt->wmanIfCmnSfCsSpecification = psfLocalSet->u8CSSpecification;\r\nt->wmanIfCmnSfCsSpecification = ntohl(t->wmanIfCmnSfCsSpecification);\r\nt->wmanIfCmnCpsTargetSaid = ntohs(psfLocalSet->u16TargetSAID);\r\nt->wmanIfCmnCpsTargetSaid = ntohl(t->wmanIfCmnCpsTargetSaid);\r\n}
