static unsigned int help(struct sk_buff *skb,\r\nenum ip_conntrack_info ctinfo,\r\nstruct nf_conntrack_expect *exp)\r\n{\r\nconst struct nf_conn *ct = exp->master;\r\nexp->saved_proto.udp.port\r\n= ct->tuplehash[IP_CT_DIR_ORIGINAL].tuple.src.u.udp.port;\r\nexp->dir = IP_CT_DIR_REPLY;\r\nexp->expectfn = nf_nat_follow_master;\r\nif (nf_ct_expect_related(exp) != 0)\r\nreturn NF_DROP;\r\nreturn NF_ACCEPT;\r\n}\r\nstatic void __exit nf_nat_tftp_fini(void)\r\n{\r\nRCU_INIT_POINTER(nf_nat_tftp_hook, NULL);\r\nsynchronize_rcu();\r\n}\r\nstatic int __init nf_nat_tftp_init(void)\r\n{\r\nBUG_ON(nf_nat_tftp_hook != NULL);\r\nRCU_INIT_POINTER(nf_nat_tftp_hook, help);\r\nreturn 0;\r\n}
