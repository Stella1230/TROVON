static struct mtd_info *map_absent_probe(struct map_info *map)\r\n{\r\nstruct mtd_info *mtd;\r\nmtd = kzalloc(sizeof(*mtd), GFP_KERNEL);\r\nif (!mtd) {\r\nreturn NULL;\r\n}\r\nmap->fldrv = &map_absent_chipdrv;\r\nmtd->priv = map;\r\nmtd->name = map->name;\r\nmtd->type = MTD_ABSENT;\r\nmtd->size = map->size;\r\nmtd->_erase = map_absent_erase;\r\nmtd->_read = map_absent_read;\r\nmtd->_write = map_absent_write;\r\nmtd->_sync = map_absent_sync;\r\nmtd->flags = 0;\r\nmtd->erasesize = PAGE_SIZE;\r\nmtd->writesize = 1;\r\n__module_get(THIS_MODULE);\r\nreturn mtd;\r\n}\r\nstatic int map_absent_read(struct mtd_info *mtd, loff_t from, size_t len, size_t *retlen, u_char *buf)\r\n{\r\nreturn -ENODEV;\r\n}\r\nstatic int map_absent_write(struct mtd_info *mtd, loff_t to, size_t len, size_t *retlen, const u_char *buf)\r\n{\r\nreturn -ENODEV;\r\n}\r\nstatic int map_absent_erase(struct mtd_info *mtd, struct erase_info *instr)\r\n{\r\nreturn -ENODEV;\r\n}\r\nstatic void map_absent_sync(struct mtd_info *mtd)\r\n{\r\n}\r\nstatic void map_absent_destroy(struct mtd_info *mtd)\r\n{\r\n}\r\nstatic int __init map_absent_init(void)\r\n{\r\nregister_mtd_chip_driver(&map_absent_chipdrv);\r\nreturn 0;\r\n}\r\nstatic void __exit map_absent_exit(void)\r\n{\r\nunregister_mtd_chip_driver(&map_absent_chipdrv);\r\n}
