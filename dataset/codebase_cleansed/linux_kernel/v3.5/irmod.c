void irda_notify_init(notify_t *notify)\r\n{\r\nnotify->data_indication = NULL;\r\nnotify->udata_indication = NULL;\r\nnotify->connect_confirm = NULL;\r\nnotify->connect_indication = NULL;\r\nnotify->disconnect_indication = NULL;\r\nnotify->flow_indication = NULL;\r\nnotify->status_indication = NULL;\r\nnotify->instance = NULL;\r\nstrlcpy(notify->name, "Unknown", sizeof(notify->name));\r\n}\r\nstatic int __init irda_init(void)\r\n{\r\nint ret = 0;\r\nIRDA_DEBUG(0, "%s()\n", __func__);\r\nirlmp_init();\r\nirlap_init();\r\nirda_device_init();\r\niriap_init();\r\nirttp_init();\r\nret = irsock_init();\r\nif (ret < 0)\r\ngoto out_err_1;\r\ndev_add_pack(&irda_packet_type);\r\n#ifdef CONFIG_PROC_FS\r\nirda_proc_register();\r\n#endif\r\n#ifdef CONFIG_SYSCTL\r\nret = irda_sysctl_register();\r\nif (ret < 0)\r\ngoto out_err_2;\r\n#endif\r\nret = irda_nl_register();\r\nif (ret < 0)\r\ngoto out_err_3;\r\nreturn 0;\r\nout_err_3:\r\n#ifdef CONFIG_SYSCTL\r\nirda_sysctl_unregister();\r\nout_err_2:\r\n#endif\r\n#ifdef CONFIG_PROC_FS\r\nirda_proc_unregister();\r\n#endif\r\ndev_remove_pack(&irda_packet_type);\r\nirsock_cleanup();\r\nout_err_1:\r\nirttp_cleanup();\r\niriap_cleanup();\r\nirda_device_cleanup();\r\nirlap_cleanup();\r\nirlmp_cleanup();\r\nreturn ret;\r\n}\r\nstatic void __exit irda_cleanup(void)\r\n{\r\nirda_nl_unregister();\r\n#ifdef CONFIG_SYSCTL\r\nirda_sysctl_unregister();\r\n#endif\r\n#ifdef CONFIG_PROC_FS\r\nirda_proc_unregister();\r\n#endif\r\ndev_remove_pack(&irda_packet_type);\r\nirsock_cleanup();\r\nirttp_cleanup();\r\niriap_cleanup();\r\nirda_device_cleanup();\r\nirlap_cleanup();\r\nirlmp_cleanup();\r\n}
