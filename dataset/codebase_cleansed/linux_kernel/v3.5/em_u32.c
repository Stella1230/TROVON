static int em_u32_match(struct sk_buff *skb, struct tcf_ematch *em,\r\nstruct tcf_pkt_info *info)\r\n{\r\nstruct tc_u32_key *key = (struct tc_u32_key *) em->data;\r\nconst unsigned char *ptr = skb_network_header(skb);\r\nif (info) {\r\nif (info->ptr)\r\nptr = info->ptr;\r\nptr += (info->nexthdr & key->offmask);\r\n}\r\nptr += key->off;\r\nif (!tcf_valid_offset(skb, ptr, sizeof(u32)))\r\nreturn 0;\r\nreturn !(((*(__be32 *) ptr) ^ key->val) & key->mask);\r\n}\r\nstatic int __init init_em_u32(void)\r\n{\r\nreturn tcf_em_register(&em_u32_ops);\r\n}\r\nstatic void __exit exit_em_u32(void)\r\n{\r\ntcf_em_unregister(&em_u32_ops);\r\n}
