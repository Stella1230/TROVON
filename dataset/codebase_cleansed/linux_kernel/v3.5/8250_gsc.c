static int __init serial_init_chip(struct parisc_device *dev)\r\n{\r\nstruct uart_port port;\r\nunsigned long address;\r\nint err;\r\nif (!dev->irq) {\r\nif (parisc_parent(dev)->id.hw_type != HPHW_IOA)\r\nprintk(KERN_INFO\r\n"Serial: device 0x%llx not configured.\n"\r\n"Enable support for Wax, Lasi, Asp or Dino.\n",\r\n(unsigned long long)dev->hpa.start);\r\nreturn -ENODEV;\r\n}\r\naddress = dev->hpa.start;\r\nif (dev->id.sversion != 0x8d)\r\naddress += 0x800;\r\nmemset(&port, 0, sizeof(port));\r\nport.iotype = UPIO_MEM;\r\nport.uartclk = 7272727;\r\nport.mapbase = address;\r\nport.membase = ioremap_nocache(address, 16);\r\nport.irq = dev->irq;\r\nport.flags = UPF_BOOT_AUTOCONF;\r\nport.dev = &dev->dev;\r\nerr = serial8250_register_port(&port);\r\nif (err < 0) {\r\nprintk(KERN_WARNING\r\n"serial8250_register_port returned error %d\n", err);\r\niounmap(port.membase);\r\nreturn err;\r\n}\r\nreturn 0;\r\n}\r\nstatic int __init probe_serial_gsc(void)\r\n{\r\nregister_parisc_driver(&lasi_driver);\r\nregister_parisc_driver(&serial_driver);\r\nreturn 0;\r\n}
