static inline void unmask_asic_irq(struct irq_data *d)\r\n{\r\nunsigned long enable_bit;\r\nunsigned int irq = d->irq;\r\nenable_bit = (1 << (irq & 0x1f));\r\nswitch (irq >> 5) {\r\ncase 0:\r\nasic_write(asic_read(ien_int_0) | enable_bit, ien_int_0);\r\nbreak;\r\ncase 1:\r\nasic_write(asic_read(ien_int_1) | enable_bit, ien_int_1);\r\nbreak;\r\ncase 2:\r\nasic_write(asic_read(ien_int_2) | enable_bit, ien_int_2);\r\nbreak;\r\ncase 3:\r\nasic_write(asic_read(ien_int_3) | enable_bit, ien_int_3);\r\nbreak;\r\ndefault:\r\nBUG();\r\n}\r\n}\r\nstatic inline void mask_asic_irq(struct irq_data *d)\r\n{\r\nunsigned long disable_mask;\r\nunsigned int irq = d->irq;\r\ndisable_mask = ~(1 << (irq & 0x1f));\r\nswitch (irq >> 5) {\r\ncase 0:\r\nasic_write(asic_read(ien_int_0) & disable_mask, ien_int_0);\r\nbreak;\r\ncase 1:\r\nasic_write(asic_read(ien_int_1) & disable_mask, ien_int_1);\r\nbreak;\r\ncase 2:\r\nasic_write(asic_read(ien_int_2) & disable_mask, ien_int_2);\r\nbreak;\r\ncase 3:\r\nasic_write(asic_read(ien_int_3) & disable_mask, ien_int_3);\r\nbreak;\r\ndefault:\r\nBUG();\r\n}\r\n}\r\nvoid __init asic_irq_init(void)\r\n{\r\nint i;\r\nwrite_c0_status(read_c0_status() & ~(0x0000fc00));\r\nasic_write(0, ien_int_0);\r\nasic_write(0, ien_int_1);\r\nasic_write(0, ien_int_2);\r\nasic_write(0, ien_int_3);\r\nasic_write(0x0fffffff, int_level_3_3);\r\nasic_write(0xffffffff, int_level_3_2);\r\nasic_write(0xffffffff, int_level_3_1);\r\nasic_write(0xffffffff, int_level_3_0);\r\nasic_write(0xffffffff, int_level_2_3);\r\nasic_write(0xffffffff, int_level_2_2);\r\nasic_write(0xffffffff, int_level_2_1);\r\nasic_write(0xffffffff, int_level_2_0);\r\nasic_write(0xffffffff, int_level_1_3);\r\nasic_write(0xffffffff, int_level_1_2);\r\nasic_write(0xffffffff, int_level_1_1);\r\nasic_write(0xffffffff, int_level_1_0);\r\nasic_write(0xffffffff, int_level_0_3);\r\nasic_write(0xffffffff, int_level_0_2);\r\nasic_write(0xffffffff, int_level_0_1);\r\nasic_write(0xffffffff, int_level_0_0);\r\nasic_write(0xf, int_int_scan);\r\nfor (i = 0; i < NR_IRQS; i++)\r\nirq_set_chip_and_handler(i, &asic_irq_chip, handle_level_irq);\r\n}
