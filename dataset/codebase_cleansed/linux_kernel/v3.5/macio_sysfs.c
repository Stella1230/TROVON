static ssize_t\r\ncompatible_show (struct device *dev, struct device_attribute *attr, char *buf)\r\n{\r\nstruct platform_device *of;\r\nconst char *compat;\r\nint cplen;\r\nint length = 0;\r\nof = &to_macio_device (dev)->ofdev;\r\ncompat = of_get_property(of->dev.of_node, "compatible", &cplen);\r\nif (!compat) {\r\n*buf = '\0';\r\nreturn 0;\r\n}\r\nwhile (cplen > 0) {\r\nint l;\r\nlength += sprintf (buf, "%s\n", compat);\r\nbuf += length;\r\nl = strlen (compat) + 1;\r\ncompat += l;\r\ncplen -= l;\r\n}\r\nreturn length;\r\n}\r\nstatic ssize_t modalias_show (struct device *dev, struct device_attribute *attr,\r\nchar *buf)\r\n{\r\nint len = of_device_get_modalias(dev, buf, PAGE_SIZE - 2);\r\nbuf[len] = '\n';\r\nbuf[len+1] = 0;\r\nreturn len+1;\r\n}\r\nstatic ssize_t devspec_show(struct device *dev,\r\nstruct device_attribute *attr, char *buf)\r\n{\r\nstruct platform_device *ofdev;\r\nofdev = to_platform_device(dev);\r\nreturn sprintf(buf, "%s\n", ofdev->dev.of_node->full_name);\r\n}
