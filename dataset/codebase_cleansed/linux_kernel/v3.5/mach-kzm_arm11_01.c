static int __init kzm_init_ext_uart(void)\r\n{\r\nu8 tmp;\r\nmxc_iomux_mode(IOMUX_MODE(MX31_PIN_GPIO1_1, IOMUX_CONFIG_GPIO));\r\ngpio_request(IOMUX_TO_GPIO(MX31_PIN_GPIO1_1), "ext-uart-int");\r\ngpio_direction_input(IOMUX_TO_GPIO(MX31_PIN_GPIO1_1));\r\ntmp = __raw_readb(KZM_ARM11_IO_ADDRESS(KZM_ARM11_CTL1));\r\ntmp |= 0x2;\r\n__raw_writeb(tmp, KZM_ARM11_IO_ADDRESS(KZM_ARM11_CTL1));\r\nreturn platform_device_register(&serial_device);\r\n}\r\nstatic inline int kzm_init_ext_uart(void)\r\n{\r\nreturn 0;\r\n}\r\nstatic int __init kzm_init_smsc9118(void)\r\n{\r\nmxc_iomux_mode(IOMUX_MODE(MX31_PIN_GPIO1_2, IOMUX_CONFIG_GPIO));\r\ngpio_request(IOMUX_TO_GPIO(MX31_PIN_GPIO1_2), "smsc9118-int");\r\ngpio_direction_input(IOMUX_TO_GPIO(MX31_PIN_GPIO1_2));\r\nregulator_register_fixed(0, dummy_supplies, ARRAY_SIZE(dummy_supplies));\r\nreturn platform_device_register(&kzm_smsc9118_device);\r\n}\r\nstatic inline int kzm_init_smsc9118(void)\r\n{\r\nreturn 0;\r\n}\r\nstatic void __init kzm_init_imx_uart(void)\r\n{\r\nimx31_add_imx_uart0(&uart_pdata);\r\nimx31_add_imx_uart1(&uart_pdata);\r\n}\r\nstatic inline void kzm_init_imx_uart(void)\r\n{\r\n}\r\nstatic void __init kzm_board_init(void)\r\n{\r\nimx31_soc_init();\r\nmxc_iomux_setup_multiple_pins(kzm_pins,\r\nARRAY_SIZE(kzm_pins), "kzm");\r\nkzm_init_ext_uart();\r\nkzm_init_smsc9118();\r\nkzm_init_imx_uart();\r\npr_info("Clock input source is 26MHz\n");\r\n}\r\nstatic void __init kzm_map_io(void)\r\n{\r\nmx31_map_io();\r\niotable_init(kzm_io_desc, ARRAY_SIZE(kzm_io_desc));\r\n}\r\nstatic void __init kzm_timer_init(void)\r\n{\r\nmx31_clocks_init(26000000);\r\n}
