int pci_vpd_find_tag(const u8 *buf, unsigned int off, unsigned int len, u8 rdt)\r\n{\r\nint i;\r\nfor (i = off; i < len; ) {\r\nu8 val = buf[i];\r\nif (val & PCI_VPD_LRDT) {\r\nif (i + PCI_VPD_LRDT_TAG_SIZE > len)\r\nbreak;\r\nif (val == rdt)\r\nreturn i;\r\ni += PCI_VPD_LRDT_TAG_SIZE +\r\npci_vpd_lrdt_size(&buf[i]);\r\n} else {\r\nu8 tag = val & ~PCI_VPD_SRDT_LEN_MASK;\r\nif (tag == rdt)\r\nreturn i;\r\nif (tag == PCI_VPD_SRDT_END)\r\nbreak;\r\ni += PCI_VPD_SRDT_TAG_SIZE +\r\npci_vpd_srdt_size(&buf[i]);\r\n}\r\n}\r\nreturn -ENOENT;\r\n}\r\nint pci_vpd_find_info_keyword(const u8 *buf, unsigned int off,\r\nunsigned int len, const char *kw)\r\n{\r\nint i;\r\nfor (i = off; i + PCI_VPD_INFO_FLD_HDR_SIZE <= off + len;) {\r\nif (buf[i + 0] == kw[0] &&\r\nbuf[i + 1] == kw[1])\r\nreturn i;\r\ni += PCI_VPD_INFO_FLD_HDR_SIZE +\r\npci_vpd_info_field_size(&buf[i]);\r\n}\r\nreturn -ENOENT;\r\n}
