static int\r\nnvaa_ram_ctor(struct nouveau_object *parent, struct nouveau_object *engine,\r\nstruct nouveau_oclass *oclass, void *data, u32 datasize,\r\nstruct nouveau_object **pobject)\r\n{\r\nconst u32 rsvd_head = ( 256 * 1024) >> 12;\r\nconst u32 rsvd_tail = (1024 * 1024) >> 12;\r\nstruct nouveau_fb *pfb = nouveau_fb(parent);\r\nstruct nouveau_ram *ram;\r\nint ret;\r\nret = nouveau_ram_create(parent, engine, oclass, &ram);\r\n*pobject = nv_object(ram);\r\nif (ret)\r\nreturn ret;\r\nram->size = nv_rd32(pfb, 0x10020c);\r\nram->size = (ram->size & 0xffffff00) | ((ram->size & 0x000000ff) << 32);\r\nret = nouveau_mm_init(&pfb->vram, rsvd_head, (ram->size >> 12) -\r\n(rsvd_head + rsvd_tail), 1);\r\nif (ret)\r\nreturn ret;\r\nram->type = NV_MEM_TYPE_STOLEN;\r\nram->stolen = (u64)nv_rd32(pfb, 0x100e10) << 12;\r\nram->get = nv50_ram_get;\r\nram->put = nv50_ram_put;\r\nreturn 0;\r\n}
