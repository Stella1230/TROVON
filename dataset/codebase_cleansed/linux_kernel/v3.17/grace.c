void locks_start_grace(struct net *net, struct lock_manager *lm)\r\n{\r\nstruct lockd_net *ln = net_generic(net, lockd_net_id);\r\nspin_lock(&grace_lock);\r\nlist_add(&lm->list, &ln->grace_list);\r\nspin_unlock(&grace_lock);\r\n}\r\nvoid locks_end_grace(struct lock_manager *lm)\r\n{\r\nspin_lock(&grace_lock);\r\nlist_del_init(&lm->list);\r\nspin_unlock(&grace_lock);\r\n}\r\nint locks_in_grace(struct net *net)\r\n{\r\nstruct lockd_net *ln = net_generic(net, lockd_net_id);\r\nreturn !list_empty(&ln->grace_list);\r\n}
