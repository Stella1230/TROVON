int __init omap3xxx_clk_init(void)\r\n{\r\nif (omap3_has_192mhz_clk())\r\nomap_96m_alwon_fck = omap_96m_alwon_fck_3630;\r\nif (cpu_is_omap3630()) {\r\ndpll3_m3x2_ck = dpll3_m3x2_ck_3630;\r\ndpll4_m2x2_ck = dpll4_m2x2_ck_3630;\r\ndpll4_m3x2_ck = dpll4_m3x2_ck_3630;\r\ndpll4_m4x2_ck = dpll4_m4x2_ck_3630;\r\ndpll4_m5x2_ck = dpll4_m5x2_ck_3630;\r\ndpll4_m6x2_ck = dpll4_m6x2_ck_3630;\r\n}\r\nif (cpu_is_omap3630())\r\ndpll4_dd = dpll4_dd_3630;\r\nelse\r\ndpll4_dd = dpll4_dd_34xx;\r\nif (soc_is_am35xx()) {\r\ncpu_mask = RATE_IN_34XX;\r\nomap_clocks_register(am35xx_clks, ARRAY_SIZE(am35xx_clks));\r\nomap_clocks_register(omap36xx_am35xx_omap3430es2plus_clks,\r\nARRAY_SIZE(omap36xx_am35xx_omap3430es2plus_clks));\r\nomap_clocks_register(omap3xxx_clks, ARRAY_SIZE(omap3xxx_clks));\r\n} else if (cpu_is_omap3630()) {\r\ncpu_mask = (RATE_IN_34XX | RATE_IN_36XX);\r\nomap_clocks_register(omap36xx_clks, ARRAY_SIZE(omap36xx_clks));\r\nomap_clocks_register(omap36xx_omap3430es2plus_clks,\r\nARRAY_SIZE(omap36xx_omap3430es2plus_clks));\r\nomap_clocks_register(omap34xx_omap36xx_clks,\r\nARRAY_SIZE(omap34xx_omap36xx_clks));\r\nomap_clocks_register(omap36xx_am35xx_omap3430es2plus_clks,\r\nARRAY_SIZE(omap36xx_am35xx_omap3430es2plus_clks));\r\nomap_clocks_register(omap3xxx_clks, ARRAY_SIZE(omap3xxx_clks));\r\n} else if (soc_is_am33xx()) {\r\ncpu_mask = RATE_IN_AM33XX;\r\n} else if (cpu_is_ti814x()) {\r\ncpu_mask = RATE_IN_TI814X;\r\n} else if (cpu_is_omap34xx()) {\r\nif (omap_rev() == OMAP3430_REV_ES1_0) {\r\ncpu_mask = RATE_IN_3430ES1;\r\nomap_clocks_register(omap3430es1_clks,\r\nARRAY_SIZE(omap3430es1_clks));\r\nomap_clocks_register(omap34xx_omap36xx_clks,\r\nARRAY_SIZE(omap34xx_omap36xx_clks));\r\nomap_clocks_register(omap3xxx_clks,\r\nARRAY_SIZE(omap3xxx_clks));\r\n} else {\r\ncpu_mask = RATE_IN_3430ES2PLUS;\r\nomap_clocks_register(omap34xx_omap36xx_clks,\r\nARRAY_SIZE(omap34xx_omap36xx_clks));\r\nomap_clocks_register(omap36xx_omap3430es2plus_clks,\r\nARRAY_SIZE(omap36xx_omap3430es2plus_clks));\r\nomap_clocks_register(omap36xx_am35xx_omap3430es2plus_clks,\r\nARRAY_SIZE(omap36xx_am35xx_omap3430es2plus_clks));\r\nomap_clocks_register(omap3xxx_clks,\r\nARRAY_SIZE(omap3xxx_clks));\r\n}\r\n} else {\r\nWARN(1, "clock: could not identify OMAP3 variant\n");\r\n}\r\nomap2_clk_disable_autoidle_all();\r\nomap2_clk_enable_init_clocks(enable_init_clks,\r\nARRAY_SIZE(enable_init_clks));\r\npr_info("Clocking rate (Crystal/Core/MPU): %ld.%01ld/%ld/%ld MHz\n",\r\n(clk_get_rate(&osc_sys_ck) / 1000000),\r\n(clk_get_rate(&osc_sys_ck) / 100000) % 10,\r\n(clk_get_rate(&core_ck) / 1000000),\r\n(clk_get_rate(&arm_fck) / 1000000));\r\nif (!cpu_is_ti81xx() && (omap_rev() >= OMAP3430_REV_ES2_0))\r\nomap3_clk_lock_dpll5();\r\nsdrc_ick_p = clk_get(NULL, "sdrc_ick");\r\narm_fck_p = clk_get(NULL, "arm_fck");\r\nreturn 0;\r\n}
