static int sh_pm_runtime_suspend(struct device *dev)\r\n{\r\nint ret;\r\nret = pm_generic_runtime_suspend(dev);\r\nif (ret) {\r\ndev_err(dev, "failed to suspend device\n");\r\nreturn ret;\r\n}\r\nret = pm_clk_suspend(dev);\r\nif (ret) {\r\ndev_err(dev, "failed to suspend clock\n");\r\npm_generic_runtime_resume(dev);\r\nreturn ret;\r\n}\r\nreturn 0;\r\n}\r\nstatic int sh_pm_runtime_resume(struct device *dev)\r\n{\r\nint ret;\r\nret = pm_clk_resume(dev);\r\nif (ret) {\r\ndev_err(dev, "failed to resume clock\n");\r\nreturn ret;\r\n}\r\nreturn pm_generic_runtime_resume(dev);\r\n}\r\nstatic int __init sh_pm_runtime_init(void)\r\n{\r\nif (IS_ENABLED(CONFIG_ARCH_SHMOBILE_MULTI)) {\r\nif (!of_machine_is_compatible("renesas,emev2") &&\r\n!of_machine_is_compatible("renesas,r7s72100") &&\r\n!of_machine_is_compatible("renesas,r8a73a4") &&\r\n!of_machine_is_compatible("renesas,r8a7740") &&\r\n!of_machine_is_compatible("renesas,r8a7778") &&\r\n!of_machine_is_compatible("renesas,r8a7779") &&\r\n!of_machine_is_compatible("renesas,r8a7790") &&\r\n!of_machine_is_compatible("renesas,r8a7791") &&\r\n!of_machine_is_compatible("renesas,r8a7792") &&\r\n!of_machine_is_compatible("renesas,r8a7793") &&\r\n!of_machine_is_compatible("renesas,r8a7794") &&\r\n!of_machine_is_compatible("renesas,sh7372") &&\r\n!of_machine_is_compatible("renesas,sh73a0"))\r\nreturn 0;\r\n}\r\ndefault_pm_on = true;\r\npm_clk_add_notifier(&platform_bus_type, &platform_bus_notifier);\r\nreturn 0;\r\n}\r\nstatic int __init sh_pm_runtime_late_init(void)\r\n{\r\nif (default_pm_on)\r\npm_genpd_poweroff_unused();\r\nreturn 0;\r\n}
