void __init plat_mem_setup(void)\r\n{\r\nchar *ctype;\r\nchar *cserial;\r\nboard_be_init = ip22_be_init;\r\nsgihpc_init();\r\nsgimc_init();\r\n#ifdef CONFIG_BOARD_SCACHE\r\nindy_sc_init();\r\n#endif\r\nset_io_port_base((unsigned long)ioremap(0x00080000,\r\n0x1fffffff - 0x00080000));\r\nctype = ArcGetEnvironmentVariable("console");\r\ncserial = ArcGetEnvironmentVariable("ConsoleOut");\r\nif ((ctype && *ctype == 'd') || (cserial && *cserial == 's')) {\r\nstatic char options[8] __initdata;\r\nchar *baud = ArcGetEnvironmentVariable("dbaud");\r\nif (baud)\r\nstrcpy(options, baud);\r\nadd_preferred_console("ttyS", *(ctype + 1) == '2' ? 1 : 0,\r\nbaud ? options : NULL);\r\n} else if (!ctype || *ctype != 'g') {\r\nprom_flags |= PROM_FLAG_USE_AS_CONSOLE;\r\nadd_preferred_console("arc", 0, NULL);\r\n}\r\n}
