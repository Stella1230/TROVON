static inline struct ioc3_uartregs *console_uart(void)\r\n{\r\nstruct ioc3 *ioc3;\r\nnasid_t nasid;\r\nnasid = (master_nasid == INVALID_NASID) ? get_nasid() : master_nasid;\r\nioc3 = (struct ioc3 *)KL_CONFIG_CH_CONS_INFO(nasid)->memory_base;\r\nreturn &ioc3->sregs.uarta;\r\n}\r\nvoid prom_putchar(char c)\r\n{\r\nstruct ioc3_uartregs *uart = console_uart();\r\nwhile ((uart->iu_lsr & 0x20) == 0);\r\nuart->iu_thr = c;\r\n}
