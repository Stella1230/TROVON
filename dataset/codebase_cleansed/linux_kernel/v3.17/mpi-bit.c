void mpi_normalize(MPI a)\r\n{\r\nfor (; a->nlimbs && !a->d[a->nlimbs - 1]; a->nlimbs--)\r\n;\r\n}\r\nunsigned mpi_get_nbits(MPI a)\r\n{\r\nunsigned n;\r\nmpi_normalize(a);\r\nif (a->nlimbs) {\r\nmpi_limb_t alimb = a->d[a->nlimbs - 1];\r\nif (alimb)\r\nn = count_leading_zeros(alimb);\r\nelse\r\nn = BITS_PER_MPI_LIMB;\r\nn = BITS_PER_MPI_LIMB - n + (a->nlimbs - 1) * BITS_PER_MPI_LIMB;\r\n} else\r\nn = 0;\r\nreturn n;\r\n}
