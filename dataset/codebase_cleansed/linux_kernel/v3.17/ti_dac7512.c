static ssize_t dac7512_store_val(struct device *dev,\r\nstruct device_attribute *attr,\r\nconst char *buf, size_t count)\r\n{\r\nstruct spi_device *spi = to_spi_device(dev);\r\nunsigned char tmp[2];\r\nunsigned long val;\r\nint ret;\r\nret = kstrtoul(buf, 10, &val);\r\nif (ret)\r\nreturn ret;\r\ntmp[0] = val >> 8;\r\ntmp[1] = val & 0xff;\r\nspi_write(spi, tmp, sizeof(tmp));\r\nreturn count;\r\n}\r\nstatic int dac7512_probe(struct spi_device *spi)\r\n{\r\nint ret;\r\nspi->bits_per_word = 8;\r\nspi->mode = SPI_MODE_0;\r\nret = spi_setup(spi);\r\nif (ret < 0)\r\nreturn ret;\r\nreturn sysfs_create_group(&spi->dev.kobj, &dac7512_attr_group);\r\n}\r\nstatic int dac7512_remove(struct spi_device *spi)\r\n{\r\nsysfs_remove_group(&spi->dev.kobj, &dac7512_attr_group);\r\nreturn 0;\r\n}
