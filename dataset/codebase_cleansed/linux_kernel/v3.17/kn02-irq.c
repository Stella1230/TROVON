static void unmask_kn02_irq(struct irq_data *d)\r\n{\r\nvolatile u32 *csr = (volatile u32 *)CKSEG1ADDR(KN02_SLOT_BASE +\r\nKN02_CSR);\r\ncached_kn02_csr |= (1 << (d->irq - kn02_irq_base + 16));\r\n*csr = cached_kn02_csr;\r\n}\r\nstatic void mask_kn02_irq(struct irq_data *d)\r\n{\r\nvolatile u32 *csr = (volatile u32 *)CKSEG1ADDR(KN02_SLOT_BASE +\r\nKN02_CSR);\r\ncached_kn02_csr &= ~(1 << (d->irq - kn02_irq_base + 16));\r\n*csr = cached_kn02_csr;\r\n}\r\nstatic void ack_kn02_irq(struct irq_data *d)\r\n{\r\nmask_kn02_irq(d);\r\niob();\r\n}\r\nvoid __init init_kn02_irqs(int base)\r\n{\r\nvolatile u32 *csr = (volatile u32 *)CKSEG1ADDR(KN02_SLOT_BASE +\r\nKN02_CSR);\r\nint i;\r\ncached_kn02_csr &= ~KN02_CSR_IOINTEN;\r\n*csr = cached_kn02_csr;\r\niob();\r\nfor (i = base; i < base + KN02_IRQ_LINES; i++)\r\nirq_set_chip_and_handler(i, &kn02_irq_type, handle_level_irq);\r\nkn02_irq_base = base;\r\n}
