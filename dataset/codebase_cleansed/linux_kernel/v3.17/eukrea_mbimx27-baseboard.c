static void eukrea_mbimx27_bl_set_intensity(int intensity)\r\n{\r\nif (intensity)\r\ngpio_direction_output(GPIO_PORTE | 5, 1);\r\nelse\r\ngpio_direction_output(GPIO_PORTE | 5, 0);\r\n}\r\nstatic void eukrea_mbimx27_lcd_power_set(struct plat_lcd_data *pd,\r\nunsigned int power)\r\n{\r\nif (power)\r\ngpio_direction_output(GPIO_PORTA | 25, 1);\r\nelse\r\ngpio_direction_output(GPIO_PORTA | 25, 0);\r\n}\r\nstatic void __maybe_unused ads7846_dev_init(void)\r\n{\r\nif (gpio_request(ADS7846_PENDOWN, "ADS7846 pendown") < 0) {\r\nprintk(KERN_ERR "can't get ads7846 pen down GPIO\n");\r\nreturn;\r\n}\r\ngpio_direction_input(ADS7846_PENDOWN);\r\n}\r\nstatic int ads7846_get_pendown_state(void)\r\n{\r\nreturn !gpio_get_value(ADS7846_PENDOWN);\r\n}\r\nvoid __init eukrea_mbimx27_baseboard_init(void)\r\n{\r\nmxc_gpio_setup_multiple_pins(eukrea_mbimx27_pins,\r\nARRAY_SIZE(eukrea_mbimx27_pins), "MBIMX27");\r\nimx27_add_imx_uart1(&uart_pdata);\r\nimx27_add_imx_uart2(&uart_pdata);\r\n#if !defined(CONFIG_MACH_EUKREA_CPUIMX27_USEUART4)\r\nimx27_add_imx_uart3(&uart_pdata);\r\n#endif\r\nimx27_add_imx_fb(&eukrea_mbimx27_fb_data);\r\nimx27_add_mxc_mmc(0, &sdhc_pdata);\r\ni2c_register_board_info(0, eukrea_mbimx27_i2c_devices,\r\nARRAY_SIZE(eukrea_mbimx27_i2c_devices));\r\nimx27_add_imx_ssi(0, &eukrea_mbimx27_ssi_pdata);\r\n#if defined(CONFIG_TOUCHSCREEN_ADS7846) \\r\n|| defined(CONFIG_TOUCHSCREEN_ADS7846_MODULE)\r\nmxc_gpio_mode(GPIO_PORTD | 25 | GPIO_GPIO | GPIO_IN);\r\nads7846_dev_init();\r\n#endif\r\nmxc_gpio_mode(GPIO_PORTD | 28 | GPIO_GPIO | GPIO_OUT);\r\nimx27_add_spi_imx0(&eukrea_mbimx27_spi0_data);\r\neukrea_mbimx27_spi_board_info[0].irq = gpio_to_irq(IMX_GPIO_NR(4, 25));\r\nspi_register_board_info(eukrea_mbimx27_spi_board_info,\r\nARRAY_SIZE(eukrea_mbimx27_spi_board_info));\r\nmxc_gpio_mode(GPIO_PORTF | 16 | GPIO_GPIO | GPIO_OUT);\r\nmxc_gpio_mode(GPIO_PORTF | 19 | GPIO_GPIO | GPIO_OUT);\r\nmxc_gpio_mode(GPIO_PORTE | 5 | GPIO_GPIO | GPIO_OUT);\r\ngpio_request(GPIO_PORTE | 5, "backlight");\r\nplatform_device_register(&eukrea_mbimx27_bl_dev);\r\nmxc_gpio_mode(GPIO_PORTA | 25 | GPIO_GPIO | GPIO_OUT);\r\ngpio_request(GPIO_PORTA | 25, "lcd_enable");\r\nplatform_device_register(&eukrea_mbimx27_lcd_powerdev);\r\nimx27_add_imx_keypad(&eukrea_mbimx27_keymap_data);\r\ngpio_led_register_device(-1, &eukrea_mbimx27_gpio_led_info);\r\nimx_add_platform_device("eukrea_tlv320", 0, NULL, 0, NULL, 0);\r\n}
