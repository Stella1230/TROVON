static void sony_lcd_init(void)\r\n{\r\ngpio_set_value(GPIO84_HX4700_LCD_SQN, 1);\r\ngpio_set_value(GPIO110_HX4700_LCD_LVDD_3V3_ON, 0);\r\ngpio_set_value(GPIO111_HX4700_LCD_AVDD_3V3_ON, 0);\r\ngpio_set_value(GPIO70_HX4700_LCD_SLIN1, 0);\r\ngpio_set_value(GPIO62_HX4700_LCD_nRESET, 0);\r\nmdelay(10);\r\ngpio_set_value(GPIO59_HX4700_LCD_PC1, 0);\r\ngpio_set_value(GPIO110_HX4700_LCD_LVDD_3V3_ON, 0);\r\nmdelay(20);\r\ngpio_set_value(GPIO110_HX4700_LCD_LVDD_3V3_ON, 1);\r\nmdelay(5);\r\ngpio_set_value(GPIO111_HX4700_LCD_AVDD_3V3_ON, 1);\r\nmdelay(5);\r\ngpio_set_value(GPIO70_HX4700_LCD_SLIN1, 1);\r\nmdelay(10);\r\ngpio_set_value(GPIO62_HX4700_LCD_nRESET, 1);\r\nmdelay(10);\r\ngpio_set_value(GPIO59_HX4700_LCD_PC1, 1);\r\nmdelay(10);\r\ngpio_set_value(GPIO112_HX4700_LCD_N2V7_7V3_ON, 1);\r\n}\r\nstatic void sony_lcd_off(void)\r\n{\r\ngpio_set_value(GPIO59_HX4700_LCD_PC1, 0);\r\ngpio_set_value(GPIO62_HX4700_LCD_nRESET, 0);\r\nmdelay(10);\r\ngpio_set_value(GPIO112_HX4700_LCD_N2V7_7V3_ON, 0);\r\nmdelay(10);\r\ngpio_set_value(GPIO111_HX4700_LCD_AVDD_3V3_ON, 0);\r\nmdelay(10);\r\ngpio_set_value(GPIO110_HX4700_LCD_LVDD_3V3_ON, 0);\r\n}\r\nstatic void w3220_lcd_suspend(struct w100fb_par *wfb)\r\n{\r\nsony_lcd_off();\r\n}\r\nstatic void w3220_lcd_resume(struct w100fb_par *wfb)\r\n{\r\nsony_lcd_init();\r\n}\r\nstatic void hx4700_lcd_set_power(struct plat_lcd_data *pd, unsigned int power)\r\n{\r\nif (power)\r\nsony_lcd_init();\r\nelse\r\nsony_lcd_off();\r\n}\r\nstatic int power_supply_init(struct device *dev)\r\n{\r\nreturn gpio_request(GPIOD9_nAC_IN, "AC charger detect");\r\n}\r\nstatic int hx4700_is_ac_online(void)\r\n{\r\nreturn !gpio_get_value(GPIOD9_nAC_IN);\r\n}\r\nstatic void power_supply_exit(struct device *dev)\r\n{\r\ngpio_free(GPIOD9_nAC_IN);\r\n}\r\nstatic void hx4700_set_vpp(struct platform_device *pdev, int vpp)\r\n{\r\ngpio_set_value(GPIO91_HX4700_FLASH_VPEN, vpp);\r\n}\r\nstatic void __init hx4700_init(void)\r\n{\r\nint ret;\r\nPCFR = PCFR_GPR_EN | PCFR_OPDE;\r\npxa2xx_mfp_config(ARRAY_AND_SIZE(hx4700_pin_config));\r\ngpio_set_wake(GPIO12_HX4700_ASIC3_IRQ, 1);\r\nret = gpio_request_array(ARRAY_AND_SIZE(global_gpios));\r\nif (ret)\r\npr_err ("hx4700: Failed to request GPIOs.\n");\r\npxa_set_ffuart_info(NULL);\r\npxa_set_btuart_info(NULL);\r\npxa_set_stuart_info(NULL);\r\nplatform_add_devices(devices, ARRAY_SIZE(devices));\r\npwm_add_table(hx4700_pwm_lookup, ARRAY_SIZE(hx4700_pwm_lookup));\r\npxa_set_ficp_info(&ficp_info);\r\npxa27x_set_i2c_power_info(NULL);\r\npxa_set_i2c_info(NULL);\r\ni2c_register_board_info(0, ARRAY_AND_SIZE(i2c_board_info));\r\ni2c_register_board_info(1, ARRAY_AND_SIZE(pi2c_board_info));\r\npxa2xx_set_spi_info(2, &pxa_ssp2_master_info);\r\nspi_register_board_info(ARRAY_AND_SIZE(tsc2046_board_info));\r\ngpio_set_value(GPIO71_HX4700_ASIC3_nRESET, 0);\r\nmdelay(10);\r\ngpio_set_value(GPIO71_HX4700_ASIC3_nRESET, 1);\r\nmdelay(10);\r\n}
