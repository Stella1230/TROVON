static bool\r\nlength_mt(const struct sk_buff *skb, struct xt_action_param *par)\r\n{\r\nconst struct xt_length_info *info = par->matchinfo;\r\nu_int16_t pktlen = ntohs(ip_hdr(skb)->tot_len);\r\nreturn (pktlen >= info->min && pktlen <= info->max) ^ info->invert;\r\n}\r\nstatic bool\r\nlength_mt6(const struct sk_buff *skb, struct xt_action_param *par)\r\n{\r\nconst struct xt_length_info *info = par->matchinfo;\r\nconst u_int16_t pktlen = ntohs(ipv6_hdr(skb)->payload_len) +\r\nsizeof(struct ipv6hdr);\r\nreturn (pktlen >= info->min && pktlen <= info->max) ^ info->invert;\r\n}\r\nstatic int __init length_mt_init(void)\r\n{\r\nreturn xt_register_matches(length_mt_reg, ARRAY_SIZE(length_mt_reg));\r\n}\r\nstatic void __exit length_mt_exit(void)\r\n{\r\nxt_unregister_matches(length_mt_reg, ARRAY_SIZE(length_mt_reg));\r\n}
