static void __init m520x_clk_init(void)\r\n{\r\nunsigned i;\r\nfor (i = 0; i < ARRAY_SIZE(enable_clks); ++i)\r\n__clk_init_enabled(enable_clks[i]);\r\nfor (i = 0; i < ARRAY_SIZE(disable_clks); ++i)\r\n__clk_init_disabled(disable_clks[i]);\r\n}\r\nstatic void __init m520x_qspi_init(void)\r\n{\r\n#if IS_ENABLED(CONFIG_SPI_COLDFIRE_QSPI)\r\nu16 par;\r\nwriteb(0x3f, MCF_GPIO_PAR_QSPI);\r\npar = readw(MCF_GPIO_PAR_UART);\r\npar &= 0x00ff;\r\nwritew(par, MCF_GPIO_PAR_UART);\r\n#endif\r\n}\r\nstatic void __init m520x_uarts_init(void)\r\n{\r\nu16 par;\r\nu8 par2;\r\npar = readw(MCF_GPIO_PAR_UART);\r\npar |= MCF_GPIO_PAR_UART_PAR_UTXD0 | MCF_GPIO_PAR_UART_PAR_URXD0;\r\npar |= MCF_GPIO_PAR_UART_PAR_UTXD1 | MCF_GPIO_PAR_UART_PAR_URXD1;\r\nwritew(par, MCF_GPIO_PAR_UART);\r\npar2 = readb(MCF_GPIO_PAR_FECI2C);\r\npar2 &= ~0x0F;\r\npar2 |= MCF_GPIO_PAR_FECI2C_PAR_SCL_UTXD2 |\r\nMCF_GPIO_PAR_FECI2C_PAR_SDA_URXD2;\r\nwriteb(par2, MCF_GPIO_PAR_FECI2C);\r\n}\r\nstatic void __init m520x_fec_init(void)\r\n{\r\nu8 v;\r\nv = readb(MCF_GPIO_PAR_FEC);\r\nwriteb(v | 0xf0, MCF_GPIO_PAR_FEC);\r\nv = readb(MCF_GPIO_PAR_FECI2C);\r\nwriteb(v | 0x0f, MCF_GPIO_PAR_FECI2C);\r\n}\r\nvoid __init config_BSP(char *commandp, int size)\r\n{\r\nmach_sched_init = hw_timer_init;\r\nm520x_clk_init();\r\nm520x_uarts_init();\r\nm520x_fec_init();\r\nm520x_qspi_init();\r\n}
