void rocker_tlv_parse(const struct rocker_tlv **tb, int maxtype,\r\nconst char *buf, int buf_len)\r\n{\r\nconst struct rocker_tlv *tlv;\r\nconst struct rocker_tlv *head = (const struct rocker_tlv *) buf;\r\nint rem;\r\nmemset(tb, 0, sizeof(struct rocker_tlv *) * (maxtype + 1));\r\nrocker_tlv_for_each(tlv, head, buf_len, rem) {\r\nu32 type = rocker_tlv_type(tlv);\r\nif (type > 0 && type <= maxtype)\r\ntb[type] = tlv;\r\n}\r\n}\r\nint rocker_tlv_put(struct rocker_desc_info *desc_info,\r\nint attrtype, int attrlen, const void *data)\r\n{\r\nint tail_room = desc_info->data_size - desc_info->tlv_size;\r\nint total_size = rocker_tlv_total_size(attrlen);\r\nstruct rocker_tlv *tlv;\r\nif (unlikely(tail_room < total_size))\r\nreturn -EMSGSIZE;\r\ntlv = rocker_tlv_start(desc_info);\r\ndesc_info->tlv_size += total_size;\r\ntlv->type = attrtype;\r\ntlv->len = rocker_tlv_attr_size(attrlen);\r\nmemcpy(rocker_tlv_data(tlv), data, attrlen);\r\nmemset((char *) tlv + tlv->len, 0, rocker_tlv_padlen(attrlen));\r\nreturn 0;\r\n}
