u32\r\nnvbios_npdeTe(struct nvkm_bios *bios, u32 base)\r\n{\r\nstruct nvbios_pcirT pcir;\r\nu8 ver; u16 hdr;\r\nu32 data = nvbios_pcirTp(bios, base, &ver, &hdr, &pcir);\r\nif (data = (data + hdr + 0x0f) & ~0x0f, data) {\r\nswitch (nvbios_rd32(bios, data + 0x00)) {\r\ncase 0x4544504e:\r\nbreak;\r\ndefault:\r\nnvkm_debug(&bios->subdev,\r\n"%08x: NPDE signature (%08x) unknown\n",\r\ndata, nvbios_rd32(bios, data + 0x00));\r\ndata = 0;\r\nbreak;\r\n}\r\n}\r\nreturn data;\r\n}\r\nu32\r\nnvbios_npdeTp(struct nvkm_bios *bios, u32 base, struct nvbios_npdeT *info)\r\n{\r\nu32 data = nvbios_npdeTe(bios, base);\r\nmemset(info, 0x00, sizeof(*info));\r\nif (data) {\r\ninfo->image_size = nvbios_rd16(bios, data + 0x08) * 512;\r\ninfo->last = nvbios_rd08(bios, data + 0x0a) & 0x80;\r\n}\r\nreturn data;\r\n}
