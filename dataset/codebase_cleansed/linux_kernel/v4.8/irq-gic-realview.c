static int __init\r\nrealview_gic_of_init(struct device_node *node, struct device_node *parent)\r\n{\r\nstatic struct regmap *map;\r\nstruct device_node *np;\r\nconst struct of_device_id *gic_id;\r\nu32 pld1_ctrl;\r\nnp = of_find_matching_node_and_match(NULL, syscon_pldset_of_match,\r\n&gic_id);\r\nif (!np)\r\nreturn -ENODEV;\r\npld1_ctrl = (u32)gic_id->data;\r\nmap = syscon_node_to_regmap(np);\r\nif (!IS_ERR(map)) {\r\nregmap_write(map, REALVIEW_SYS_LOCK_OFFSET,\r\nVERSATILE_LOCK_VAL);\r\nregmap_update_bits(map, pld1_ctrl,\r\nPLD_INTMODE_NEW_NO_DCC,\r\nPLD_INTMODE_MASK);\r\nregmap_write(map, REALVIEW_SYS_LOCK_OFFSET, 0x0000);\r\npr_info("RealView GIC: set up interrupt controller to NEW mode, no DCC\n");\r\n} else {\r\npr_err("RealView GIC setup: could not find syscon\n");\r\nreturn -ENODEV;\r\n}\r\nreturn gic_of_init(node, parent);\r\n}
