int acpi_gsi_to_irq(u32 gsi, unsigned int *irq)\r\n{\r\nstruct irq_domain *d = irq_find_matching_fwnode(acpi_gsi_domain_id,\r\nDOMAIN_BUS_ANY);\r\n*irq = irq_find_mapping(d, gsi);\r\nreturn (*irq > 0) ? *irq : -EINVAL;\r\n}\r\nint acpi_register_gsi(struct device *dev, u32 gsi, int trigger,\r\nint polarity)\r\n{\r\nstruct irq_fwspec fwspec;\r\nif (WARN_ON(!acpi_gsi_domain_id)) {\r\npr_warn("GSI: No registered irqchip, giving up\n");\r\nreturn -EINVAL;\r\n}\r\nfwspec.fwnode = acpi_gsi_domain_id;\r\nfwspec.param[0] = gsi;\r\nfwspec.param[1] = acpi_dev_get_irq_type(trigger, polarity);\r\nfwspec.param_count = 2;\r\nreturn irq_create_fwspec_mapping(&fwspec);\r\n}\r\nvoid acpi_unregister_gsi(u32 gsi)\r\n{\r\nstruct irq_domain *d = irq_find_matching_fwnode(acpi_gsi_domain_id,\r\nDOMAIN_BUS_ANY);\r\nint irq = irq_find_mapping(d, gsi);\r\nirq_dispose_mapping(irq);\r\n}\r\nvoid __init acpi_set_irq_model(enum acpi_irq_model_id model,\r\nstruct fwnode_handle *fwnode)\r\n{\r\nacpi_irq_model = model;\r\nacpi_gsi_domain_id = fwnode;\r\n}
