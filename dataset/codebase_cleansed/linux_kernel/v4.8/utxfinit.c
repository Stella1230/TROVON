acpi_status __init acpi_initialize_subsystem(void)\r\n{\r\nacpi_status status;\r\nACPI_FUNCTION_TRACE(acpi_initialize_subsystem);\r\nacpi_gbl_startup_flags = ACPI_SUBSYSTEM_INITIALIZE;\r\nACPI_DEBUG_EXEC(acpi_ut_init_stack_ptr_trace());\r\nstatus = acpi_os_initialize();\r\nif (ACPI_FAILURE(status)) {\r\nACPI_EXCEPTION((AE_INFO, status, "During OSL initialization"));\r\nreturn_ACPI_STATUS(status);\r\n}\r\nstatus = acpi_ut_init_globals();\r\nif (ACPI_FAILURE(status)) {\r\nACPI_EXCEPTION((AE_INFO, status,\r\n"During initialization of globals"));\r\nreturn_ACPI_STATUS(status);\r\n}\r\nstatus = acpi_ut_mutex_initialize();\r\nif (ACPI_FAILURE(status)) {\r\nACPI_EXCEPTION((AE_INFO, status,\r\n"During Global Mutex creation"));\r\nreturn_ACPI_STATUS(status);\r\n}\r\nstatus = acpi_ns_root_initialize();\r\nif (ACPI_FAILURE(status)) {\r\nACPI_EXCEPTION((AE_INFO, status,\r\n"During Namespace initialization"));\r\nreturn_ACPI_STATUS(status);\r\n}\r\nstatus = acpi_ut_initialize_interfaces();\r\nif (ACPI_FAILURE(status)) {\r\nACPI_EXCEPTION((AE_INFO, status,\r\n"During OSI interfaces initialization"));\r\nreturn_ACPI_STATUS(status);\r\n}\r\nreturn_ACPI_STATUS(AE_OK);\r\n}\r\nacpi_status __init acpi_enable_subsystem(u32 flags)\r\n{\r\nacpi_status status = AE_OK;\r\nACPI_FUNCTION_TRACE(acpi_enable_subsystem);\r\nacpi_gbl_early_initialization = FALSE;\r\n#if (!ACPI_REDUCED_HARDWARE)\r\nif (!(flags & ACPI_NO_ACPI_ENABLE)) {\r\nACPI_DEBUG_PRINT((ACPI_DB_EXEC,\r\n"[Init] Going into ACPI mode\n"));\r\nacpi_gbl_original_mode = acpi_hw_get_mode();\r\nstatus = acpi_enable();\r\nif (ACPI_FAILURE(status)) {\r\nACPI_WARNING((AE_INFO, "AcpiEnable failed"));\r\nreturn_ACPI_STATUS(status);\r\n}\r\n}\r\nif (!(flags & ACPI_NO_FACS_INIT)) {\r\nstatus = acpi_tb_initialize_facs();\r\nif (ACPI_FAILURE(status)) {\r\nACPI_WARNING((AE_INFO, "Could not map the FACS table"));\r\nreturn_ACPI_STATUS(status);\r\n}\r\n}\r\nif (!(flags & ACPI_NO_EVENT_INIT)) {\r\nACPI_DEBUG_PRINT((ACPI_DB_EXEC,\r\n"[Init] Initializing ACPI events\n"));\r\nstatus = acpi_ev_initialize_events();\r\nif (ACPI_FAILURE(status)) {\r\nreturn_ACPI_STATUS(status);\r\n}\r\n}\r\nif (!(flags & ACPI_NO_HANDLER_INIT)) {\r\nACPI_DEBUG_PRINT((ACPI_DB_EXEC,\r\n"[Init] Installing SCI/GL handlers\n"));\r\nstatus = acpi_ev_install_xrupt_handlers();\r\nif (ACPI_FAILURE(status)) {\r\nreturn_ACPI_STATUS(status);\r\n}\r\n}\r\n#endif\r\nreturn_ACPI_STATUS(status);\r\n}\r\nacpi_status __init acpi_initialize_objects(u32 flags)\r\n{\r\nacpi_status status = AE_OK;\r\nACPI_FUNCTION_TRACE(acpi_initialize_objects);\r\n#ifdef ACPI_EXEC_APP\r\nae_do_object_overrides();\r\n#endif\r\nif (acpi_gbl_group_module_level_code) {\r\nacpi_ns_exec_module_code_list();\r\nif (!(flags & ACPI_NO_OBJECT_INIT)) {\r\nstatus = acpi_ns_initialize_objects();\r\nif (ACPI_FAILURE(status)) {\r\nreturn_ACPI_STATUS(status);\r\n}\r\n}\r\n}\r\nif (!(flags & (ACPI_NO_DEVICE_INIT | ACPI_NO_ADDRESS_SPACE_INIT))) {\r\nstatus = acpi_ns_initialize_devices(flags);\r\nif (ACPI_FAILURE(status)) {\r\nreturn_ACPI_STATUS(status);\r\n}\r\n}\r\nstatus = acpi_purge_cached_objects();\r\nacpi_gbl_startup_flags |= ACPI_INITIALIZED_OK;\r\nreturn_ACPI_STATUS(status);\r\n}
