acpi_status\r\nacpi_ex_resolve_object(union acpi_operand_object **source_desc_ptr,\r\nacpi_object_type target_type,\r\nstruct acpi_walk_state *walk_state)\r\n{\r\nunion acpi_operand_object *source_desc = *source_desc_ptr;\r\nacpi_status status = AE_OK;\r\nACPI_FUNCTION_TRACE(ex_resolve_object);\r\nswitch (target_type) {\r\ncase ACPI_TYPE_BUFFER_FIELD:\r\ncase ACPI_TYPE_LOCAL_REGION_FIELD:\r\ncase ACPI_TYPE_LOCAL_BANK_FIELD:\r\ncase ACPI_TYPE_LOCAL_INDEX_FIELD:\r\ncase ACPI_TYPE_INTEGER:\r\ncase ACPI_TYPE_STRING:\r\ncase ACPI_TYPE_BUFFER:\r\nif (source_desc->common.type == ACPI_TYPE_LOCAL_REFERENCE) {\r\nstatus =\r\nacpi_ex_resolve_to_value(source_desc_ptr,\r\nwalk_state);\r\nif (ACPI_FAILURE(status)) {\r\nbreak;\r\n}\r\n}\r\nif (walk_state->opcode == AML_COPY_OP) {\r\nbreak;\r\n}\r\nif ((source_desc->common.type != ACPI_TYPE_INTEGER) &&\r\n(source_desc->common.type != ACPI_TYPE_BUFFER) &&\r\n(source_desc->common.type != ACPI_TYPE_STRING) &&\r\n!((source_desc->common.type == ACPI_TYPE_LOCAL_REFERENCE) &&\r\n(source_desc->reference.class == ACPI_REFCLASS_TABLE))) {\r\nACPI_ERROR((AE_INFO,\r\n"Cannot assign type [%s] to [%s] (must be type Int/Str/Buf)",\r\nacpi_ut_get_object_type_name(source_desc),\r\nacpi_ut_get_type_name(target_type)));\r\nstatus = AE_AML_OPERAND_TYPE;\r\n}\r\nbreak;\r\ncase ACPI_TYPE_LOCAL_ALIAS:\r\ncase ACPI_TYPE_LOCAL_METHOD_ALIAS:\r\nACPI_ERROR((AE_INFO, "Store into an unresolved Alias object"));\r\nstatus = AE_AML_INTERNAL;\r\nbreak;\r\ncase ACPI_TYPE_PACKAGE:\r\ndefault:\r\nbreak;\r\n}\r\nreturn_ACPI_STATUS(status);\r\n}\r\nacpi_status\r\nacpi_ex_store_object_to_object(union acpi_operand_object *source_desc,\r\nunion acpi_operand_object *dest_desc,\r\nunion acpi_operand_object **new_desc,\r\nstruct acpi_walk_state *walk_state)\r\n{\r\nunion acpi_operand_object *actual_src_desc;\r\nacpi_status status = AE_OK;\r\nACPI_FUNCTION_TRACE_PTR(ex_store_object_to_object, source_desc);\r\nactual_src_desc = source_desc;\r\nif (!dest_desc) {\r\nstatus =\r\nacpi_ut_copy_iobject_to_iobject(actual_src_desc, new_desc,\r\nwalk_state);\r\nreturn_ACPI_STATUS(status);\r\n}\r\nif (source_desc->common.type != dest_desc->common.type) {\r\nstatus = acpi_ex_convert_to_target_type(dest_desc->common.type,\r\nsource_desc,\r\n&actual_src_desc,\r\nwalk_state);\r\nif (ACPI_FAILURE(status)) {\r\nreturn_ACPI_STATUS(status);\r\n}\r\nif (source_desc == actual_src_desc) {\r\n*new_desc = source_desc;\r\nreturn_ACPI_STATUS(AE_OK);\r\n}\r\n}\r\nswitch (dest_desc->common.type) {\r\ncase ACPI_TYPE_INTEGER:\r\ndest_desc->integer.value = actual_src_desc->integer.value;\r\n(void)acpi_ex_truncate_for32bit_table(dest_desc);\r\nbreak;\r\ncase ACPI_TYPE_STRING:\r\nstatus =\r\nacpi_ex_store_string_to_string(actual_src_desc, dest_desc);\r\nbreak;\r\ncase ACPI_TYPE_BUFFER:\r\nstatus =\r\nacpi_ex_store_buffer_to_buffer(actual_src_desc, dest_desc);\r\nbreak;\r\ncase ACPI_TYPE_PACKAGE:\r\nstatus =\r\nacpi_ut_copy_iobject_to_iobject(actual_src_desc, &dest_desc,\r\nwalk_state);\r\nbreak;\r\ndefault:\r\nACPI_WARNING((AE_INFO, "Store into type [%s] not implemented",\r\nacpi_ut_get_object_type_name(dest_desc)));\r\nstatus = AE_NOT_IMPLEMENTED;\r\nbreak;\r\n}\r\nif (actual_src_desc != source_desc) {\r\nacpi_ut_remove_reference(actual_src_desc);\r\n}\r\n*new_desc = dest_desc;\r\nreturn_ACPI_STATUS(status);\r\n}
