pgd_t *pgd_alloc(struct mm_struct *mm)\r\n{\r\nif (PGD_SIZE == PAGE_SIZE)\r\nreturn (pgd_t *)__get_free_page(PGALLOC_GFP);\r\nelse\r\nreturn kmem_cache_alloc(pgd_cache, PGALLOC_GFP);\r\n}\r\nvoid pgd_free(struct mm_struct *mm, pgd_t *pgd)\r\n{\r\nif (PGD_SIZE == PAGE_SIZE)\r\nfree_page((unsigned long)pgd);\r\nelse\r\nkmem_cache_free(pgd_cache, pgd);\r\n}\r\nvoid __init pgd_cache_init(void)\r\n{\r\nif (PGD_SIZE == PAGE_SIZE)\r\nreturn;\r\npgd_cache = kmem_cache_create("pgd_cache", PGD_SIZE, PGD_SIZE,\r\nSLAB_PANIC, NULL);\r\n}
