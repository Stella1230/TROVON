void __init tegra_pmc_clk_init(void __iomem *pmc_base,\r\nstruct tegra_clk *tegra_clks)\r\n{\r\nstruct clk *clk;\r\nstruct clk **dt_clk;\r\nint i;\r\nfor (i = 0; i < ARRAY_SIZE(pmc_clks); i++) {\r\nstruct pmc_clk_init_data *data;\r\ndata = pmc_clks + i;\r\ndt_clk = tegra_lookup_dt_id(data->mux_id, tegra_clks);\r\nif (!dt_clk)\r\ncontinue;\r\nclk = clk_register_mux(NULL, data->mux_name, data->parents,\r\ndata->num_parents, CLK_SET_RATE_NO_REPARENT,\r\npmc_base + PMC_CLK_OUT_CNTRL, data->mux_shift,\r\n3, 0, &clk_out_lock);\r\n*dt_clk = clk;\r\ndt_clk = tegra_lookup_dt_id(data->gate_id, tegra_clks);\r\nif (!dt_clk)\r\ncontinue;\r\nclk = clk_register_gate(NULL, data->gate_name, data->mux_name,\r\n0, pmc_base + PMC_CLK_OUT_CNTRL,\r\ndata->gate_shift, 0, &clk_out_lock);\r\n*dt_clk = clk;\r\nclk_register_clkdev(clk, data->dev_name, data->gate_name);\r\n}\r\nwritel_relaxed(0, pmc_base + PMC_BLINK_TIMER);\r\nclk = clk_register_gate(NULL, "blink_override", "clk_32k", 0,\r\npmc_base + PMC_DPD_PADS_ORIDE,\r\nPMC_DPD_PADS_ORIDE_BLINK_ENB, 0, NULL);\r\ndt_clk = tegra_lookup_dt_id(tegra_clk_blink, tegra_clks);\r\nif (!dt_clk)\r\nreturn;\r\nclk = clk_register_gate(NULL, "blink", "blink_override", 0,\r\npmc_base + PMC_CTRL,\r\nPMC_CTRL_BLINK_ENB, 0, NULL);\r\nclk_register_clkdev(clk, "blink", NULL);\r\n*dt_clk = clk;\r\n}
