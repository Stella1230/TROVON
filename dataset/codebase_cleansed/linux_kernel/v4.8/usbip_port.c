static int list_imported_devices(void)\r\n{\r\nint i;\r\nstruct usbip_imported_device *idev;\r\nint ret;\r\nif (usbip_names_init(USBIDS_FILE))\r\nerr("failed to open %s", USBIDS_FILE);\r\nret = usbip_vhci_driver_open();\r\nif (ret < 0) {\r\nerr("open vhci_driver");\r\ngoto err_names_free;\r\n}\r\nprintf("Imported USB devices\n");\r\nprintf("====================\n");\r\nfor (i = 0; i < vhci_driver->nports; i++) {\r\nidev = &vhci_driver->idev[i];\r\nif (usbip_vhci_imported_device_dump(idev) < 0)\r\ngoto err_driver_close;\r\n}\r\nusbip_vhci_driver_close();\r\nusbip_names_free();\r\nreturn ret;\r\nerr_driver_close:\r\nusbip_vhci_driver_close();\r\nerr_names_free:\r\nusbip_names_free();\r\nreturn -1;\r\n}
