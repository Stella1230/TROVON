int lp3943_read_byte(struct lp3943 *lp3943, u8 reg, u8 *read)\r\n{\r\nint ret;\r\nunsigned int val;\r\nret = regmap_read(lp3943->regmap, reg, &val);\r\nif (ret < 0)\r\nreturn ret;\r\n*read = (u8)val;\r\nreturn 0;\r\n}\r\nint lp3943_write_byte(struct lp3943 *lp3943, u8 reg, u8 data)\r\n{\r\nreturn regmap_write(lp3943->regmap, reg, data);\r\n}\r\nint lp3943_update_bits(struct lp3943 *lp3943, u8 reg, u8 mask, u8 data)\r\n{\r\nreturn regmap_update_bits(lp3943->regmap, reg, mask, data);\r\n}\r\nstatic int lp3943_probe(struct i2c_client *cl, const struct i2c_device_id *id)\r\n{\r\nstruct lp3943 *lp3943;\r\nstruct device *dev = &cl->dev;\r\nlp3943 = devm_kzalloc(dev, sizeof(*lp3943), GFP_KERNEL);\r\nif (!lp3943)\r\nreturn -ENOMEM;\r\nlp3943->regmap = devm_regmap_init_i2c(cl, &lp3943_regmap_config);\r\nif (IS_ERR(lp3943->regmap))\r\nreturn PTR_ERR(lp3943->regmap);\r\nlp3943->pdata = dev_get_platdata(dev);\r\nlp3943->dev = dev;\r\nlp3943->mux_cfg = lp3943_mux_cfg;\r\ni2c_set_clientdata(cl, lp3943);\r\nreturn devm_mfd_add_devices(dev, -1, lp3943_devs,\r\nARRAY_SIZE(lp3943_devs),\r\nNULL, 0, NULL);\r\n}
