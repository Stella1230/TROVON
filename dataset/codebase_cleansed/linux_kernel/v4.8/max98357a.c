static int max98357a_daiops_trigger(struct snd_pcm_substream *substream,\r\nint cmd, struct snd_soc_dai *dai)\r\n{\r\nstruct gpio_desc *sdmode = snd_soc_dai_get_drvdata(dai);\r\nif (!sdmode)\r\nreturn 0;\r\nswitch (cmd) {\r\ncase SNDRV_PCM_TRIGGER_START:\r\ncase SNDRV_PCM_TRIGGER_RESUME:\r\ncase SNDRV_PCM_TRIGGER_PAUSE_RELEASE:\r\ngpiod_set_value(sdmode, 1);\r\nbreak;\r\ncase SNDRV_PCM_TRIGGER_STOP:\r\ncase SNDRV_PCM_TRIGGER_SUSPEND:\r\ncase SNDRV_PCM_TRIGGER_PAUSE_PUSH:\r\ngpiod_set_value(sdmode, 0);\r\nbreak;\r\n}\r\nreturn 0;\r\n}\r\nstatic int max98357a_codec_probe(struct snd_soc_codec *codec)\r\n{\r\nstruct gpio_desc *sdmode;\r\nsdmode = devm_gpiod_get_optional(codec->dev, "sdmode", GPIOD_OUT_LOW);\r\nif (IS_ERR(sdmode))\r\nreturn PTR_ERR(sdmode);\r\nsnd_soc_codec_set_drvdata(codec, sdmode);\r\nreturn 0;\r\n}\r\nstatic int max98357a_platform_probe(struct platform_device *pdev)\r\n{\r\nreturn snd_soc_register_codec(&pdev->dev, &max98357a_codec_driver,\r\n&max98357a_dai_driver, 1);\r\n}\r\nstatic int max98357a_platform_remove(struct platform_device *pdev)\r\n{\r\nsnd_soc_unregister_codec(&pdev->dev);\r\nreturn 0;\r\n}
