static int __init jornada720_init(void)\r\n{\r\nint ret = -ENODEV;\r\nif (machine_is_jornada720()) {\r\nGPDR |= GPIO_GPIO20;\r\nTUCR = TUCR_VAL;\r\nGPSR = GPIO_GPIO20;\r\nudelay(1);\r\nGPCR = GPIO_GPIO20;\r\nudelay(1);\r\nGPSR = GPIO_GPIO20;\r\nudelay(20);\r\nret = platform_add_devices(devices, ARRAY_SIZE(devices));\r\n}\r\nreturn ret;\r\n}\r\nstatic void __init jornada720_map_io(void)\r\n{\r\nsa1100_map_io();\r\niotable_init(jornada720_io_desc, ARRAY_SIZE(jornada720_io_desc));\r\nsa1100_register_uart(0, 3);\r\nsa1100_register_uart(1, 1);\r\n}\r\nstatic void jornada720_set_vpp(int vpp)\r\n{\r\nif (vpp)\r\nPPSR |= PPC_LDD7;\r\nelse\r\nPPSR &= ~PPC_LDD7;\r\nPPDR |= PPC_LDD7;\r\n}\r\nstatic void __init jornada720_mach_init(void)\r\n{\r\nsa11x0_register_mtd(&jornada720_flash_data, &jornada720_flash_resource, 1);\r\n}
