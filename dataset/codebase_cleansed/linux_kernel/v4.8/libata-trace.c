const char *\r\nlibata_trace_parse_status(struct trace_seq *p, unsigned char status)\r\n{\r\nconst char *ret = trace_seq_buffer_ptr(p);\r\ntrace_seq_printf(p, "{ ");\r\nif (status & ATA_BUSY)\r\ntrace_seq_printf(p, "BUSY ");\r\nif (status & ATA_DRDY)\r\ntrace_seq_printf(p, "DRDY ");\r\nif (status & ATA_DF)\r\ntrace_seq_printf(p, "DF ");\r\nif (status & ATA_DSC)\r\ntrace_seq_printf(p, "DSC ");\r\nif (status & ATA_DRQ)\r\ntrace_seq_printf(p, "DRQ ");\r\nif (status & ATA_CORR)\r\ntrace_seq_printf(p, "CORR ");\r\nif (status & ATA_SENSE)\r\ntrace_seq_printf(p, "SENSE ");\r\nif (status & ATA_ERR)\r\ntrace_seq_printf(p, "ERR ");\r\ntrace_seq_putc(p, '}');\r\ntrace_seq_putc(p, 0);\r\nreturn ret;\r\n}\r\nconst char *\r\nlibata_trace_parse_eh_action(struct trace_seq *p, unsigned int eh_action)\r\n{\r\nconst char *ret = trace_seq_buffer_ptr(p);\r\ntrace_seq_printf(p, "%x", eh_action);\r\nif (eh_action) {\r\ntrace_seq_printf(p, "{ ");\r\nif (eh_action & ATA_EH_REVALIDATE)\r\ntrace_seq_printf(p, "REVALIDATE ");\r\nif (eh_action & (ATA_EH_SOFTRESET | ATA_EH_HARDRESET))\r\ntrace_seq_printf(p, "RESET ");\r\nelse if (eh_action & ATA_EH_SOFTRESET)\r\ntrace_seq_printf(p, "SOFTRESET ");\r\nelse if (eh_action & ATA_EH_HARDRESET)\r\ntrace_seq_printf(p, "HARDRESET ");\r\nif (eh_action & ATA_EH_ENABLE_LINK)\r\ntrace_seq_printf(p, "ENABLE_LINK ");\r\nif (eh_action & ATA_EH_PARK)\r\ntrace_seq_printf(p, "PARK ");\r\ntrace_seq_putc(p, '}');\r\n}\r\ntrace_seq_putc(p, 0);\r\nreturn ret;\r\n}\r\nconst char *\r\nlibata_trace_parse_eh_err_mask(struct trace_seq *p, unsigned int eh_err_mask)\r\n{\r\nconst char *ret = trace_seq_buffer_ptr(p);\r\ntrace_seq_printf(p, "%x", eh_err_mask);\r\nif (eh_err_mask) {\r\ntrace_seq_printf(p, "{ ");\r\nif (eh_err_mask & AC_ERR_DEV)\r\ntrace_seq_printf(p, "DEV ");\r\nif (eh_err_mask & AC_ERR_HSM)\r\ntrace_seq_printf(p, "HSM ");\r\nif (eh_err_mask & AC_ERR_TIMEOUT)\r\ntrace_seq_printf(p, "TIMEOUT ");\r\nif (eh_err_mask & AC_ERR_MEDIA)\r\ntrace_seq_printf(p, "MEDIA ");\r\nif (eh_err_mask & AC_ERR_ATA_BUS)\r\ntrace_seq_printf(p, "ATA_BUS ");\r\nif (eh_err_mask & AC_ERR_HOST_BUS)\r\ntrace_seq_printf(p, "HOST_BUS ");\r\nif (eh_err_mask & AC_ERR_SYSTEM)\r\ntrace_seq_printf(p, "SYSTEM ");\r\nif (eh_err_mask & AC_ERR_INVALID)\r\ntrace_seq_printf(p, "INVALID ");\r\nif (eh_err_mask & AC_ERR_OTHER)\r\ntrace_seq_printf(p, "OTHER ");\r\nif (eh_err_mask & AC_ERR_NODEV_HINT)\r\ntrace_seq_printf(p, "NODEV_HINT ");\r\nif (eh_err_mask & AC_ERR_NCQ)\r\ntrace_seq_printf(p, "NCQ ");\r\ntrace_seq_putc(p, '}');\r\n}\r\ntrace_seq_putc(p, 0);\r\nreturn ret;\r\n}\r\nconst char *\r\nlibata_trace_parse_qc_flags(struct trace_seq *p, unsigned int qc_flags)\r\n{\r\nconst char *ret = trace_seq_buffer_ptr(p);\r\ntrace_seq_printf(p, "%x", qc_flags);\r\nif (qc_flags) {\r\ntrace_seq_printf(p, "{ ");\r\nif (qc_flags & ATA_QCFLAG_ACTIVE)\r\ntrace_seq_printf(p, "ACTIVE ");\r\nif (qc_flags & ATA_QCFLAG_DMAMAP)\r\ntrace_seq_printf(p, "DMAMAP ");\r\nif (qc_flags & ATA_QCFLAG_IO)\r\ntrace_seq_printf(p, "IO ");\r\nif (qc_flags & ATA_QCFLAG_RESULT_TF)\r\ntrace_seq_printf(p, "RESULT_TF ");\r\nif (qc_flags & ATA_QCFLAG_CLEAR_EXCL)\r\ntrace_seq_printf(p, "CLEAR_EXCL ");\r\nif (qc_flags & ATA_QCFLAG_QUIET)\r\ntrace_seq_printf(p, "QUIET ");\r\nif (qc_flags & ATA_QCFLAG_RETRY)\r\ntrace_seq_printf(p, "RETRY ");\r\nif (qc_flags & ATA_QCFLAG_FAILED)\r\ntrace_seq_printf(p, "FAILED ");\r\nif (qc_flags & ATA_QCFLAG_SENSE_VALID)\r\ntrace_seq_printf(p, "SENSE_VALID ");\r\nif (qc_flags & ATA_QCFLAG_EH_SCHEDULED)\r\ntrace_seq_printf(p, "EH_SCHEDULED ");\r\ntrace_seq_putc(p, '}');\r\n}\r\ntrace_seq_putc(p, 0);\r\nreturn ret;\r\n}\r\nconst char *\r\nlibata_trace_parse_subcmd(struct trace_seq *p, unsigned char cmd,\r\nunsigned char feature, unsigned char hob_nsect)\r\n{\r\nconst char *ret = trace_seq_buffer_ptr(p);\r\nswitch (cmd) {\r\ncase ATA_CMD_FPDMA_RECV:\r\nswitch (hob_nsect & 0x5f) {\r\ncase ATA_SUBCMD_FPDMA_RECV_RD_LOG_DMA_EXT:\r\ntrace_seq_printf(p, " READ_LOG_DMA_EXT");\r\nbreak;\r\ncase ATA_SUBCMD_FPDMA_RECV_ZAC_MGMT_IN:\r\ntrace_seq_printf(p, " ZAC_MGMT_IN");\r\nbreak;\r\n}\r\nbreak;\r\ncase ATA_CMD_FPDMA_SEND:\r\nswitch (hob_nsect & 0x5f) {\r\ncase ATA_SUBCMD_FPDMA_SEND_WR_LOG_DMA_EXT:\r\ntrace_seq_printf(p, " WRITE_LOG_DMA_EXT");\r\nbreak;\r\ncase ATA_SUBCMD_FPDMA_SEND_DSM:\r\ntrace_seq_printf(p, " DATASET_MANAGEMENT");\r\nbreak;\r\n}\r\nbreak;\r\ncase ATA_CMD_NCQ_NON_DATA:\r\nswitch (feature) {\r\ncase ATA_SUBCMD_NCQ_NON_DATA_ABORT_QUEUE:\r\ntrace_seq_printf(p, " ABORT_QUEUE");\r\nbreak;\r\ncase ATA_SUBCMD_NCQ_NON_DATA_SET_FEATURES:\r\ntrace_seq_printf(p, " SET_FEATURES");\r\nbreak;\r\ncase ATA_SUBCMD_NCQ_NON_DATA_ZERO_EXT:\r\ntrace_seq_printf(p, " ZERO_EXT");\r\nbreak;\r\ncase ATA_SUBCMD_NCQ_NON_DATA_ZAC_MGMT_OUT:\r\ntrace_seq_printf(p, " ZAC_MGMT_OUT");\r\nbreak;\r\n}\r\nbreak;\r\ncase ATA_CMD_ZAC_MGMT_IN:\r\nswitch (feature) {\r\ncase ATA_SUBCMD_ZAC_MGMT_IN_REPORT_ZONES:\r\ntrace_seq_printf(p, " REPORT_ZONES");\r\nbreak;\r\n}\r\nbreak;\r\ncase ATA_CMD_ZAC_MGMT_OUT:\r\nswitch (feature) {\r\ncase ATA_SUBCMD_ZAC_MGMT_OUT_CLOSE_ZONE:\r\ntrace_seq_printf(p, " CLOSE_ZONE");\r\nbreak;\r\ncase ATA_SUBCMD_ZAC_MGMT_OUT_FINISH_ZONE:\r\ntrace_seq_printf(p, " FINISH_ZONE");\r\nbreak;\r\ncase ATA_SUBCMD_ZAC_MGMT_OUT_OPEN_ZONE:\r\ntrace_seq_printf(p, " OPEN_ZONE");\r\nbreak;\r\ncase ATA_SUBCMD_ZAC_MGMT_OUT_RESET_WRITE_POINTER:\r\ntrace_seq_printf(p, " RESET_WRITE_POINTER");\r\nbreak;\r\n}\r\nbreak;\r\n}\r\ntrace_seq_putc(p, 0);\r\nreturn ret;\r\n}
