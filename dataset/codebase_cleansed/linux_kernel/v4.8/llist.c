bool llist_add_batch(struct llist_node *new_first, struct llist_node *new_last,\r\nstruct llist_head *head)\r\n{\r\nstruct llist_node *first;\r\ndo {\r\nnew_last->next = first = ACCESS_ONCE(head->first);\r\n} while (cmpxchg(&head->first, first, new_first) != first);\r\nreturn !first;\r\n}\r\nstruct llist_node *llist_del_first(struct llist_head *head)\r\n{\r\nstruct llist_node *entry, *old_entry, *next;\r\nentry = smp_load_acquire(&head->first);\r\nfor (;;) {\r\nif (entry == NULL)\r\nreturn NULL;\r\nold_entry = entry;\r\nnext = READ_ONCE(entry->next);\r\nentry = cmpxchg(&head->first, old_entry, next);\r\nif (entry == old_entry)\r\nbreak;\r\n}\r\nreturn entry;\r\n}\r\nstruct llist_node *llist_reverse_order(struct llist_node *head)\r\n{\r\nstruct llist_node *new_head = NULL;\r\nwhile (head) {\r\nstruct llist_node *tmp = head;\r\nhead = head->next;\r\ntmp->next = new_head;\r\nnew_head = tmp;\r\n}\r\nreturn new_head;\r\n}
