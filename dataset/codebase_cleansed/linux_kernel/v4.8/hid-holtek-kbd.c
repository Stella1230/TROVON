static __u8 *holtek_kbd_report_fixup(struct hid_device *hdev, __u8 *rdesc,\r\nunsigned int *rsize)\r\n{\r\nstruct usb_interface *intf = to_usb_interface(hdev->dev.parent);\r\nif (intf->cur_altsetting->desc.bInterfaceNumber == 1) {\r\nrdesc = holtek_kbd_rdesc_fixed;\r\n*rsize = sizeof(holtek_kbd_rdesc_fixed);\r\n}\r\nreturn rdesc;\r\n}\r\nstatic int holtek_kbd_input_event(struct input_dev *dev, unsigned int type,\r\nunsigned int code,\r\nint value)\r\n{\r\nstruct hid_device *hid = input_get_drvdata(dev);\r\nstruct usb_device *usb_dev = hid_to_usb_dev(hid);\r\nstruct usb_interface *boot_interface = usb_ifnum_to_if(usb_dev, 0);\r\nstruct hid_device *boot_hid = usb_get_intfdata(boot_interface);\r\nstruct hid_input *boot_hid_input = list_first_entry(&boot_hid->inputs,\r\nstruct hid_input, list);\r\nreturn boot_hid_input->input->event(boot_hid_input->input, type, code,\r\nvalue);\r\n}\r\nstatic int holtek_kbd_probe(struct hid_device *hdev,\r\nconst struct hid_device_id *id)\r\n{\r\nstruct usb_interface *intf = to_usb_interface(hdev->dev.parent);\r\nint ret = hid_parse(hdev);\r\nif (!ret)\r\nret = hid_hw_start(hdev, HID_CONNECT_DEFAULT);\r\nif (!ret && intf->cur_altsetting->desc.bInterfaceNumber == 1) {\r\nstruct hid_input *hidinput;\r\nlist_for_each_entry(hidinput, &hdev->inputs, list) {\r\nhidinput->input->event = holtek_kbd_input_event;\r\n}\r\n}\r\nreturn ret;\r\n}
