static int ubnt_xm_pci_plat_dev_init(struct pci_dev *dev)\r\n{\r\nswitch (PCI_SLOT(dev->devfn)) {\r\ncase 0:\r\ndev->dev.platform_data = &ubnt_xm_eeprom_data;\r\nbreak;\r\n}\r\nreturn 0;\r\n}\r\nstatic void __init ubnt_xm_pci_init(void)\r\n{\r\nmemcpy(ubnt_xm_eeprom_data.eeprom_data, UBNT_XM_EEPROM_ADDR,\r\nsizeof(ubnt_xm_eeprom_data.eeprom_data));\r\nath79_pci_set_plat_dev_init(ubnt_xm_pci_plat_dev_init);\r\nath79_register_pci();\r\n}\r\nstatic inline void ubnt_xm_pci_init(void) {}\r\nstatic void __init ubnt_xm_init(void)\r\n{\r\nath79_register_leds_gpio(-1, ARRAY_SIZE(ubnt_xm_leds_gpio),\r\nubnt_xm_leds_gpio);\r\nath79_register_gpio_keys_polled(-1, UBNT_XM_KEYS_POLL_INTERVAL,\r\nARRAY_SIZE(ubnt_xm_gpio_keys),\r\nubnt_xm_gpio_keys);\r\nath79_register_spi(&ubnt_xm_spi_data, ubnt_xm_spi_info,\r\nARRAY_SIZE(ubnt_xm_spi_info));\r\nubnt_xm_pci_init();\r\n}
