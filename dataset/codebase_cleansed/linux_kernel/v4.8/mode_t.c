static size_t syscall_arg__scnprintf_mode_t(char *bf, size_t size, struct syscall_arg *arg)\r\n{\r\nint printed = 0, mode = arg->val;\r\n#define P_MODE(n) \\r\nif ((mode & S_##n) == S_##n) { \\r\nprinted += scnprintf(bf + printed, size - printed, "%s%s", printed ? "|" : "", #n); \\r\nmode &= ~S_##n; \\r\n}\r\nP_MODE(IALLUGO);\r\nP_MODE(IRWXUGO);\r\nP_MODE(IRUGO);\r\nP_MODE(IWUGO);\r\nP_MODE(IXUGO);\r\nP_MODE(IFMT);\r\nP_MODE(IFSOCK);\r\nP_MODE(IFLNK);\r\nP_MODE(IFREG);\r\nP_MODE(IFBLK);\r\nP_MODE(IFDIR);\r\nP_MODE(IFCHR);\r\nP_MODE(IFIFO);\r\nP_MODE(ISUID);\r\nP_MODE(ISGID);\r\nP_MODE(ISVTX);\r\nP_MODE(IRWXU);\r\nP_MODE(IRUSR);\r\nP_MODE(IWUSR);\r\nP_MODE(IXUSR);\r\nP_MODE(IRWXG);\r\nP_MODE(IRGRP);\r\nP_MODE(IWGRP);\r\nP_MODE(IXGRP);\r\nP_MODE(IRWXO);\r\nP_MODE(IROTH);\r\nP_MODE(IWOTH);\r\nP_MODE(IXOTH);\r\n#undef P_MODE\r\nif (mode)\r\nprinted += scnprintf(bf + printed, size - printed, "%s%#x", printed ? "|" : "", mode);\r\nreturn printed;\r\n}
