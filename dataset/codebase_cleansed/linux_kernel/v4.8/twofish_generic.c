static void twofish_encrypt(struct crypto_tfm *tfm, u8 *out, const u8 *in)\r\n{\r\nstruct twofish_ctx *ctx = crypto_tfm_ctx(tfm);\r\nconst __le32 *src = (const __le32 *)in;\r\n__le32 *dst = (__le32 *)out;\r\nu32 a, b, c, d;\r\nu32 x, y;\r\nINPACK (0, a, 0);\r\nINPACK (1, b, 1);\r\nINPACK (2, c, 2);\r\nINPACK (3, d, 3);\r\nENCCYCLE (0);\r\nENCCYCLE (1);\r\nENCCYCLE (2);\r\nENCCYCLE (3);\r\nENCCYCLE (4);\r\nENCCYCLE (5);\r\nENCCYCLE (6);\r\nENCCYCLE (7);\r\nOUTUNPACK (0, c, 4);\r\nOUTUNPACK (1, d, 5);\r\nOUTUNPACK (2, a, 6);\r\nOUTUNPACK (3, b, 7);\r\n}\r\nstatic void twofish_decrypt(struct crypto_tfm *tfm, u8 *out, const u8 *in)\r\n{\r\nstruct twofish_ctx *ctx = crypto_tfm_ctx(tfm);\r\nconst __le32 *src = (const __le32 *)in;\r\n__le32 *dst = (__le32 *)out;\r\nu32 a, b, c, d;\r\nu32 x, y;\r\nINPACK (0, c, 4);\r\nINPACK (1, d, 5);\r\nINPACK (2, a, 6);\r\nINPACK (3, b, 7);\r\nDECCYCLE (7);\r\nDECCYCLE (6);\r\nDECCYCLE (5);\r\nDECCYCLE (4);\r\nDECCYCLE (3);\r\nDECCYCLE (2);\r\nDECCYCLE (1);\r\nDECCYCLE (0);\r\nOUTUNPACK (0, a, 0);\r\nOUTUNPACK (1, b, 1);\r\nOUTUNPACK (2, c, 2);\r\nOUTUNPACK (3, d, 3);\r\n}\r\nstatic int __init twofish_mod_init(void)\r\n{\r\nreturn crypto_register_alg(&alg);\r\n}\r\nstatic void __exit twofish_mod_fini(void)\r\n{\r\ncrypto_unregister_alg(&alg);\r\n}
