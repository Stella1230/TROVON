void ctcm_unregister_dbf_views(void)\r\n{\r\nint x;\r\nfor (x = 0; x < CTCM_DBF_INFOS; x++) {\r\ndebug_unregister(ctcm_dbf[x].id);\r\nctcm_dbf[x].id = NULL;\r\n}\r\n}\r\nint ctcm_register_dbf_views(void)\r\n{\r\nint x;\r\nfor (x = 0; x < CTCM_DBF_INFOS; x++) {\r\nctcm_dbf[x].id = debug_register(ctcm_dbf[x].name,\r\nctcm_dbf[x].pages,\r\nctcm_dbf[x].areas,\r\nctcm_dbf[x].len);\r\nif (ctcm_dbf[x].id == NULL) {\r\nctcm_unregister_dbf_views();\r\nreturn -ENOMEM;\r\n}\r\ndebug_register_view(ctcm_dbf[x].id, &debug_hex_ascii_view);\r\ndebug_set_level(ctcm_dbf[x].id, ctcm_dbf[x].level);\r\n}\r\nreturn 0;\r\n}\r\nvoid ctcm_dbf_longtext(enum ctcm_dbf_names dbf_nix, int level, char *fmt, ...)\r\n{\r\nchar dbf_txt_buf[64];\r\nva_list args;\r\nif (!debug_level_enabled(ctcm_dbf[dbf_nix].id, level))\r\nreturn;\r\nva_start(args, fmt);\r\nvsnprintf(dbf_txt_buf, sizeof(dbf_txt_buf), fmt, args);\r\nva_end(args);\r\ndebug_text_event(ctcm_dbf[dbf_nix].id, level, dbf_txt_buf);\r\n}
