int audit_classify_arch(int arch)\r\n{\r\n#ifdef CONFIG_COMPAT\r\nif (arch == AUDIT_ARCH_PARISC)\r\nreturn 1;\r\n#endif\r\nreturn 0;\r\n}\r\nint audit_classify_syscall(int abi, unsigned syscall)\r\n{\r\n#ifdef CONFIG_COMPAT\r\nextern int parisc32_classify_syscall(unsigned);\r\nif (abi == AUDIT_ARCH_PARISC)\r\nreturn parisc32_classify_syscall(syscall);\r\n#endif\r\nswitch (syscall) {\r\ncase __NR_open:\r\nreturn 2;\r\ncase __NR_openat:\r\nreturn 3;\r\ncase __NR_execve:\r\nreturn 5;\r\ndefault:\r\nreturn 0;\r\n}\r\n}\r\nstatic int __init audit_classes_init(void)\r\n{\r\n#ifdef CONFIG_COMPAT\r\nextern __u32 parisc32_dir_class[];\r\nextern __u32 parisc32_write_class[];\r\nextern __u32 parisc32_read_class[];\r\nextern __u32 parisc32_chattr_class[];\r\nextern __u32 parisc32_signal_class[];\r\naudit_register_class(AUDIT_CLASS_WRITE_32, parisc32_write_class);\r\naudit_register_class(AUDIT_CLASS_READ_32, parisc32_read_class);\r\naudit_register_class(AUDIT_CLASS_DIR_WRITE_32, parisc32_dir_class);\r\naudit_register_class(AUDIT_CLASS_CHATTR_32, parisc32_chattr_class);\r\naudit_register_class(AUDIT_CLASS_SIGNAL_32, parisc32_signal_class);\r\n#endif\r\naudit_register_class(AUDIT_CLASS_WRITE, write_class);\r\naudit_register_class(AUDIT_CLASS_READ, read_class);\r\naudit_register_class(AUDIT_CLASS_DIR_WRITE, dir_class);\r\naudit_register_class(AUDIT_CLASS_CHATTR, chattr_class);\r\naudit_register_class(AUDIT_CLASS_SIGNAL, signal_class);\r\nreturn 0;\r\n}
