int bpf_prog1(struct bpf_sock *sk)\r\n{\r\nchar fmt[] = "socket: family %d type %d protocol %d\n";\r\nbpf_trace_printk(fmt, sizeof(fmt), sk->family, sk->type, sk->protocol);\r\nif (sk->family == PF_INET6 &&\r\nsk->type == SOCK_RAW &&\r\nsk->protocol == IPPROTO_ICMPV6)\r\nreturn 0;\r\nreturn 1;\r\n}\r\nint bpf_prog2(struct bpf_sock *sk)\r\n{\r\nchar fmt[] = "socket: family %d type %d protocol %d\n";\r\nbpf_trace_printk(fmt, sizeof(fmt), sk->family, sk->type, sk->protocol);\r\nif (sk->family == PF_INET &&\r\nsk->type == SOCK_RAW &&\r\nsk->protocol == IPPROTO_ICMP)\r\nreturn 0;\r\nreturn 1;\r\n}
