static int ad7606_par16_read_block(struct device *dev,\r\nint count, void *buf)\r\n{\r\nstruct platform_device *pdev = to_platform_device(dev);\r\nstruct iio_dev *indio_dev = platform_get_drvdata(pdev);\r\nstruct ad7606_state *st = iio_priv(indio_dev);\r\ninsw((unsigned long)st->base_address, buf, count);\r\nreturn 0;\r\n}\r\nstatic int ad7606_par8_read_block(struct device *dev,\r\nint count, void *buf)\r\n{\r\nstruct platform_device *pdev = to_platform_device(dev);\r\nstruct iio_dev *indio_dev = platform_get_drvdata(pdev);\r\nstruct ad7606_state *st = iio_priv(indio_dev);\r\ninsb((unsigned long)st->base_address, buf, count * 2);\r\nreturn 0;\r\n}\r\nstatic int ad7606_par_probe(struct platform_device *pdev)\r\n{\r\nconst struct platform_device_id *id = platform_get_device_id(pdev);\r\nstruct resource *res;\r\nvoid __iomem *addr;\r\nresource_size_t remap_size;\r\nint irq;\r\nirq = platform_get_irq(pdev, 0);\r\nif (irq < 0) {\r\ndev_err(&pdev->dev, "no irq\n");\r\nreturn -ENODEV;\r\n}\r\nres = platform_get_resource(pdev, IORESOURCE_MEM, 0);\r\naddr = devm_ioremap_resource(&pdev->dev, res);\r\nif (IS_ERR(addr))\r\nreturn PTR_ERR(addr);\r\nremap_size = resource_size(res);\r\nreturn ad7606_probe(&pdev->dev, irq, addr,\r\nid->name, id->driver_data,\r\nremap_size > 1 ? &ad7606_par16_bops :\r\n&ad7606_par8_bops);\r\n}\r\nstatic int ad7606_par_remove(struct platform_device *pdev)\r\n{\r\nreturn ad7606_remove(&pdev->dev, platform_get_irq(pdev, 0));\r\n}
