static int ns2_pci_phy_init(struct phy *p)\r\n{\r\nstruct mdio_device *mdiodev = phy_get_drvdata(p);\r\nint rc;\r\nrc = mdiobus_write(mdiodev->bus, mdiodev->addr,\r\nBLK_ADDR_REG_OFFSET, PLL_AFE1_100MHZ_BLK);\r\nif (rc)\r\ngoto err;\r\nrc = mdiobus_write(mdiodev->bus, mdiodev->addr,\r\nPLL_CLK_AMP_OFFSET, PLL_CLK_AMP_2P05V);\r\nif (rc)\r\ngoto err;\r\nreturn 0;\r\nerr:\r\ndev_err(&mdiodev->dev, "Error %d writing to phy\n", rc);\r\nreturn rc;\r\n}\r\nstatic int ns2_pci_phy_probe(struct mdio_device *mdiodev)\r\n{\r\nstruct device *dev = &mdiodev->dev;\r\nstruct phy_provider *provider;\r\nstruct phy *phy;\r\nphy = devm_phy_create(dev, dev->of_node, &ns2_pci_phy_ops);\r\nif (IS_ERR(phy)) {\r\ndev_err(dev, "failed to create Phy\n");\r\nreturn PTR_ERR(phy);\r\n}\r\nphy_set_drvdata(phy, mdiodev);\r\nprovider = devm_of_phy_provider_register(&phy->dev,\r\nof_phy_simple_xlate);\r\nif (IS_ERR(provider)) {\r\ndev_err(dev, "failed to register Phy provider\n");\r\nreturn PTR_ERR(provider);\r\n}\r\ndev_info(dev, "%s PHY registered\n", dev_name(dev));\r\nreturn 0;\r\n}
