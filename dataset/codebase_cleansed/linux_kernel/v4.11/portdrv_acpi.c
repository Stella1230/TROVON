void pcie_port_acpi_setup(struct pci_dev *port, int *srv_mask)\r\n{\r\nstruct acpi_pci_root *root;\r\nacpi_handle handle;\r\nu32 flags;\r\nif (acpi_pci_disabled)\r\nreturn;\r\nhandle = acpi_find_root_bridge_handle(port);\r\nif (!handle)\r\nreturn;\r\nroot = acpi_pci_find_root(handle);\r\nif (!root)\r\nreturn;\r\nflags = root->osc_control_set;\r\n*srv_mask = PCIE_PORT_SERVICE_VC | PCIE_PORT_SERVICE_DPC;\r\nif (flags & OSC_PCI_EXPRESS_NATIVE_HP_CONTROL)\r\n*srv_mask |= PCIE_PORT_SERVICE_HP;\r\nif (flags & OSC_PCI_EXPRESS_PME_CONTROL)\r\n*srv_mask |= PCIE_PORT_SERVICE_PME;\r\nif (flags & OSC_PCI_EXPRESS_AER_CONTROL)\r\n*srv_mask |= PCIE_PORT_SERVICE_AER;\r\n}
