static int\r\nnvkm_nvsw_mthd_(struct nvkm_object *object, u32 mthd, void *data, u32 size)\r\n{\r\nstruct nvkm_nvsw *nvsw = nvkm_nvsw(object);\r\nif (nvsw->func->mthd)\r\nreturn nvsw->func->mthd(nvsw, mthd, data, size);\r\nreturn -ENODEV;\r\n}\r\nstatic int\r\nnvkm_nvsw_ntfy_(struct nvkm_object *object, u32 mthd,\r\nstruct nvkm_event **pevent)\r\n{\r\nstruct nvkm_nvsw *nvsw = nvkm_nvsw(object);\r\nswitch (mthd) {\r\ncase NV04_NVSW_NTFY_UEVENT:\r\n*pevent = &nvsw->chan->event;\r\nreturn 0;\r\ndefault:\r\nbreak;\r\n}\r\nreturn -EINVAL;\r\n}\r\nint\r\nnvkm_nvsw_new_(const struct nvkm_nvsw_func *func, struct nvkm_sw_chan *chan,\r\nconst struct nvkm_oclass *oclass, void *data, u32 size,\r\nstruct nvkm_object **pobject)\r\n{\r\nstruct nvkm_nvsw *nvsw;\r\nif (!(nvsw = kzalloc(sizeof(*nvsw), GFP_KERNEL)))\r\nreturn -ENOMEM;\r\n*pobject = &nvsw->object;\r\nnvkm_object_ctor(&nvkm_nvsw_, oclass, &nvsw->object);\r\nnvsw->func = func;\r\nnvsw->chan = chan;\r\nreturn 0;\r\n}\r\nint\r\nnvkm_nvsw_new(struct nvkm_sw_chan *chan, const struct nvkm_oclass *oclass,\r\nvoid *data, u32 size, struct nvkm_object **pobject)\r\n{\r\nreturn nvkm_nvsw_new_(&nvkm_nvsw, chan, oclass, data, size, pobject);\r\n}
