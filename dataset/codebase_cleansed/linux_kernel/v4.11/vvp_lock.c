static void vvp_lock_fini(const struct lu_env *env, struct cl_lock_slice *slice)\r\n{\r\nstruct vvp_lock *vlk = cl2vvp_lock(slice);\r\nkmem_cache_free(vvp_lock_kmem, vlk);\r\n}\r\nstatic int vvp_lock_enqueue(const struct lu_env *env,\r\nconst struct cl_lock_slice *slice,\r\nstruct cl_io *unused, struct cl_sync_io *anchor)\r\n{\r\nCLOBINVRNT(env, slice->cls_obj, vvp_object_invariant(slice->cls_obj));\r\nreturn 0;\r\n}\r\nint vvp_lock_init(const struct lu_env *env, struct cl_object *obj,\r\nstruct cl_lock *lock, const struct cl_io *unused)\r\n{\r\nstruct vvp_lock *vlk;\r\nint result;\r\nCLOBINVRNT(env, obj, vvp_object_invariant(obj));\r\nvlk = kmem_cache_zalloc(vvp_lock_kmem, GFP_NOFS);\r\nif (vlk) {\r\ncl_lock_slice_add(lock, &vlk->vlk_cl, obj, &vvp_lock_ops);\r\nresult = 0;\r\n} else {\r\nresult = -ENOMEM;\r\n}\r\nreturn result;\r\n}
