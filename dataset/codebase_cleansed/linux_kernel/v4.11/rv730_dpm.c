int rv730_populate_sclk_value(struct radeon_device *rdev,\r\nu32 engine_clock,\r\nRV770_SMC_SCLK_VALUE *sclk)\r\n{\r\nstruct rv7xx_power_info *pi = rv770_get_pi(rdev);\r\nstruct atom_clock_dividers dividers;\r\nu32 spll_func_cntl = pi->clk_regs.rv730.cg_spll_func_cntl;\r\nu32 spll_func_cntl_2 = pi->clk_regs.rv730.cg_spll_func_cntl_2;\r\nu32 spll_func_cntl_3 = pi->clk_regs.rv730.cg_spll_func_cntl_3;\r\nu32 cg_spll_spread_spectrum = pi->clk_regs.rv730.cg_spll_spread_spectrum;\r\nu32 cg_spll_spread_spectrum_2 = pi->clk_regs.rv730.cg_spll_spread_spectrum_2;\r\nu64 tmp;\r\nu32 reference_clock = rdev->clock.spll.reference_freq;\r\nu32 reference_divider, post_divider;\r\nu32 fbdiv;\r\nint ret;\r\nret = radeon_atom_get_clock_dividers(rdev, COMPUTE_ENGINE_PLL_PARAM,\r\nengine_clock, false, &dividers);\r\nif (ret)\r\nreturn ret;\r\nreference_divider = 1 + dividers.ref_div;\r\nif (dividers.enable_post_div)\r\npost_divider = ((dividers.post_div >> 4) & 0xf) +\r\n(dividers.post_div & 0xf) + 2;\r\nelse\r\npost_divider = 1;\r\ntmp = (u64) engine_clock * reference_divider * post_divider * 16384;\r\ndo_div(tmp, reference_clock);\r\nfbdiv = (u32) tmp;\r\nif (dividers.enable_post_div)\r\nspll_func_cntl |= SPLL_DIVEN;\r\nelse\r\nspll_func_cntl &= ~SPLL_DIVEN;\r\nspll_func_cntl &= ~(SPLL_HILEN_MASK | SPLL_LOLEN_MASK | SPLL_REF_DIV_MASK);\r\nspll_func_cntl |= SPLL_REF_DIV(dividers.ref_div);\r\nspll_func_cntl |= SPLL_HILEN((dividers.post_div >> 4) & 0xf);\r\nspll_func_cntl |= SPLL_LOLEN(dividers.post_div & 0xf);\r\nspll_func_cntl_2 &= ~SCLK_MUX_SEL_MASK;\r\nspll_func_cntl_2 |= SCLK_MUX_SEL(2);\r\nspll_func_cntl_3 &= ~SPLL_FB_DIV_MASK;\r\nspll_func_cntl_3 |= SPLL_FB_DIV(fbdiv);\r\nspll_func_cntl_3 |= SPLL_DITHEN;\r\nif (pi->sclk_ss) {\r\nstruct radeon_atom_ss ss;\r\nu32 vco_freq = engine_clock * post_divider;\r\nif (radeon_atombios_get_asic_ss_info(rdev, &ss,\r\nASIC_INTERNAL_ENGINE_SS, vco_freq)) {\r\nu32 clk_s = reference_clock * 5 / (reference_divider * ss.rate);\r\nu32 clk_v = ss.percentage * fbdiv / (clk_s * 10000);\r\ncg_spll_spread_spectrum &= ~CLK_S_MASK;\r\ncg_spll_spread_spectrum |= CLK_S(clk_s);\r\ncg_spll_spread_spectrum |= SSEN;\r\ncg_spll_spread_spectrum_2 &= ~CLK_V_MASK;\r\ncg_spll_spread_spectrum_2 |= CLK_V(clk_v);\r\n}\r\n}\r\nsclk->sclk_value = cpu_to_be32(engine_clock);\r\nsclk->vCG_SPLL_FUNC_CNTL = cpu_to_be32(spll_func_cntl);\r\nsclk->vCG_SPLL_FUNC_CNTL_2 = cpu_to_be32(spll_func_cntl_2);\r\nsclk->vCG_SPLL_FUNC_CNTL_3 = cpu_to_be32(spll_func_cntl_3);\r\nsclk->vCG_SPLL_SPREAD_SPECTRUM = cpu_to_be32(cg_spll_spread_spectrum);\r\nsclk->vCG_SPLL_SPREAD_SPECTRUM_2 = cpu_to_be32(cg_spll_spread_spectrum_2);\r\nreturn 0;\r\n}\r\nint rv730_populate_mclk_value(struct radeon_device *rdev,\r\nu32 engine_clock, u32 memory_clock,\r\nLPRV7XX_SMC_MCLK_VALUE mclk)\r\n{\r\nstruct rv7xx_power_info *pi = rv770_get_pi(rdev);\r\nu32 mclk_pwrmgt_cntl = pi->clk_regs.rv730.mclk_pwrmgt_cntl;\r\nu32 dll_cntl = pi->clk_regs.rv730.dll_cntl;\r\nu32 mpll_func_cntl = pi->clk_regs.rv730.mpll_func_cntl;\r\nu32 mpll_func_cntl_2 = pi->clk_regs.rv730.mpll_func_cntl2;\r\nu32 mpll_func_cntl_3 = pi->clk_regs.rv730.mpll_func_cntl3;\r\nu32 mpll_ss = pi->clk_regs.rv730.mpll_ss;\r\nu32 mpll_ss2 = pi->clk_regs.rv730.mpll_ss2;\r\nstruct atom_clock_dividers dividers;\r\nu32 post_divider, reference_divider;\r\nint ret;\r\nret = radeon_atom_get_clock_dividers(rdev, COMPUTE_MEMORY_PLL_PARAM,\r\nmemory_clock, false, &dividers);\r\nif (ret)\r\nreturn ret;\r\nreference_divider = dividers.ref_div + 1;\r\nif (dividers.enable_post_div)\r\npost_divider = ((dividers.post_div >> 4) & 0xf) +\r\n(dividers.post_div & 0xf) + 2;\r\nelse\r\npost_divider = 1;\r\nif (dividers.enable_post_div)\r\nmpll_func_cntl |= MPLL_DIVEN;\r\nelse\r\nmpll_func_cntl &= ~MPLL_DIVEN;\r\nmpll_func_cntl &= ~(MPLL_REF_DIV_MASK | MPLL_HILEN_MASK | MPLL_LOLEN_MASK);\r\nmpll_func_cntl |= MPLL_REF_DIV(dividers.ref_div);\r\nmpll_func_cntl |= MPLL_HILEN((dividers.post_div >> 4) & 0xf);\r\nmpll_func_cntl |= MPLL_LOLEN(dividers.post_div & 0xf);\r\nmpll_func_cntl_3 &= ~MPLL_FB_DIV_MASK;\r\nmpll_func_cntl_3 |= MPLL_FB_DIV(dividers.fb_div);\r\nif (dividers.enable_dithen)\r\nmpll_func_cntl_3 |= MPLL_DITHEN;\r\nelse\r\nmpll_func_cntl_3 &= ~MPLL_DITHEN;\r\nif (pi->mclk_ss) {\r\nstruct radeon_atom_ss ss;\r\nu32 vco_freq = memory_clock * post_divider;\r\nif (radeon_atombios_get_asic_ss_info(rdev, &ss,\r\nASIC_INTERNAL_MEMORY_SS, vco_freq)) {\r\nu32 reference_clock = rdev->clock.mpll.reference_freq;\r\nu32 clk_s = reference_clock * 5 / (reference_divider * ss.rate);\r\nu32 clk_v = ss.percentage * dividers.fb_div / (clk_s * 10000);\r\nmpll_ss &= ~CLK_S_MASK;\r\nmpll_ss |= CLK_S(clk_s);\r\nmpll_ss |= SSEN;\r\nmpll_ss2 &= ~CLK_V_MASK;\r\nmpll_ss |= CLK_V(clk_v);\r\n}\r\n}\r\nmclk->mclk730.vMCLK_PWRMGT_CNTL = cpu_to_be32(mclk_pwrmgt_cntl);\r\nmclk->mclk730.vDLL_CNTL = cpu_to_be32(dll_cntl);\r\nmclk->mclk730.mclk_value = cpu_to_be32(memory_clock);\r\nmclk->mclk730.vMPLL_FUNC_CNTL = cpu_to_be32(mpll_func_cntl);\r\nmclk->mclk730.vMPLL_FUNC_CNTL2 = cpu_to_be32(mpll_func_cntl_2);\r\nmclk->mclk730.vMPLL_FUNC_CNTL3 = cpu_to_be32(mpll_func_cntl_3);\r\nmclk->mclk730.vMPLL_SS = cpu_to_be32(mpll_ss);\r\nmclk->mclk730.vMPLL_SS2 = cpu_to_be32(mpll_ss2);\r\nreturn 0;\r\n}\r\nvoid rv730_read_clock_registers(struct radeon_device *rdev)\r\n{\r\nstruct rv7xx_power_info *pi = rv770_get_pi(rdev);\r\npi->clk_regs.rv730.cg_spll_func_cntl =\r\nRREG32(CG_SPLL_FUNC_CNTL);\r\npi->clk_regs.rv730.cg_spll_func_cntl_2 =\r\nRREG32(CG_SPLL_FUNC_CNTL_2);\r\npi->clk_regs.rv730.cg_spll_func_cntl_3 =\r\nRREG32(CG_SPLL_FUNC_CNTL_3);\r\npi->clk_regs.rv730.cg_spll_spread_spectrum =\r\nRREG32(CG_SPLL_SPREAD_SPECTRUM);\r\npi->clk_regs.rv730.cg_spll_spread_spectrum_2 =\r\nRREG32(CG_SPLL_SPREAD_SPECTRUM_2);\r\npi->clk_regs.rv730.mclk_pwrmgt_cntl =\r\nRREG32(TCI_MCLK_PWRMGT_CNTL);\r\npi->clk_regs.rv730.dll_cntl =\r\nRREG32(TCI_DLL_CNTL);\r\npi->clk_regs.rv730.mpll_func_cntl =\r\nRREG32(CG_MPLL_FUNC_CNTL);\r\npi->clk_regs.rv730.mpll_func_cntl2 =\r\nRREG32(CG_MPLL_FUNC_CNTL_2);\r\npi->clk_regs.rv730.mpll_func_cntl3 =\r\nRREG32(CG_MPLL_FUNC_CNTL_3);\r\npi->clk_regs.rv730.mpll_ss =\r\nRREG32(CG_TCI_MPLL_SPREAD_SPECTRUM);\r\npi->clk_regs.rv730.mpll_ss2 =\r\nRREG32(CG_TCI_MPLL_SPREAD_SPECTRUM_2);\r\n}\r\nint rv730_populate_smc_acpi_state(struct radeon_device *rdev,\r\nRV770_SMC_STATETABLE *table)\r\n{\r\nstruct rv7xx_power_info *pi = rv770_get_pi(rdev);\r\nu32 mpll_func_cntl = 0;\r\nu32 mpll_func_cntl_2 = 0 ;\r\nu32 mpll_func_cntl_3 = 0;\r\nu32 mclk_pwrmgt_cntl;\r\nu32 dll_cntl;\r\nu32 spll_func_cntl;\r\nu32 spll_func_cntl_2;\r\nu32 spll_func_cntl_3;\r\ntable->ACPIState = table->initialState;\r\ntable->ACPIState.flags &= ~PPSMC_SWSTATE_FLAG_DC;\r\nif (pi->acpi_vddc) {\r\nrv770_populate_vddc_value(rdev, pi->acpi_vddc,\r\n&table->ACPIState.levels[0].vddc);\r\ntable->ACPIState.levels[0].gen2PCIE = pi->pcie_gen2 ?\r\npi->acpi_pcie_gen2 : 0;\r\ntable->ACPIState.levels[0].gen2XSP =\r\npi->acpi_pcie_gen2;\r\n} else {\r\nrv770_populate_vddc_value(rdev, pi->min_vddc_in_table,\r\n&table->ACPIState.levels[0].vddc);\r\ntable->ACPIState.levels[0].gen2PCIE = 0;\r\n}\r\nmpll_func_cntl = pi->clk_regs.rv730.mpll_func_cntl;\r\nmpll_func_cntl_2 = pi->clk_regs.rv730.mpll_func_cntl2;\r\nmpll_func_cntl_3 = pi->clk_regs.rv730.mpll_func_cntl3;\r\nmpll_func_cntl |= MPLL_RESET | MPLL_BYPASS_EN;\r\nmpll_func_cntl &= ~MPLL_SLEEP;\r\nmpll_func_cntl_2 &= ~MCLK_MUX_SEL_MASK;\r\nmpll_func_cntl_2 |= MCLK_MUX_SEL(1);\r\nmclk_pwrmgt_cntl = (MRDCKA_RESET |\r\nMRDCKB_RESET |\r\nMRDCKC_RESET |\r\nMRDCKD_RESET |\r\nMRDCKE_RESET |\r\nMRDCKF_RESET |\r\nMRDCKG_RESET |\r\nMRDCKH_RESET |\r\nMRDCKA_SLEEP |\r\nMRDCKB_SLEEP |\r\nMRDCKC_SLEEP |\r\nMRDCKD_SLEEP |\r\nMRDCKE_SLEEP |\r\nMRDCKF_SLEEP |\r\nMRDCKG_SLEEP |\r\nMRDCKH_SLEEP);\r\ndll_cntl = 0xff000000;\r\nspll_func_cntl = pi->clk_regs.rv730.cg_spll_func_cntl;\r\nspll_func_cntl_2 = pi->clk_regs.rv730.cg_spll_func_cntl_2;\r\nspll_func_cntl_3 = pi->clk_regs.rv730.cg_spll_func_cntl_3;\r\nspll_func_cntl |= SPLL_RESET | SPLL_BYPASS_EN;\r\nspll_func_cntl &= ~SPLL_SLEEP;\r\nspll_func_cntl_2 &= ~SCLK_MUX_SEL_MASK;\r\nspll_func_cntl_2 |= SCLK_MUX_SEL(4);\r\ntable->ACPIState.levels[0].mclk.mclk730.vMPLL_FUNC_CNTL = cpu_to_be32(mpll_func_cntl);\r\ntable->ACPIState.levels[0].mclk.mclk730.vMPLL_FUNC_CNTL2 = cpu_to_be32(mpll_func_cntl_2);\r\ntable->ACPIState.levels[0].mclk.mclk730.vMPLL_FUNC_CNTL3 = cpu_to_be32(mpll_func_cntl_3);\r\ntable->ACPIState.levels[0].mclk.mclk730.vMCLK_PWRMGT_CNTL = cpu_to_be32(mclk_pwrmgt_cntl);\r\ntable->ACPIState.levels[0].mclk.mclk730.vDLL_CNTL = cpu_to_be32(dll_cntl);\r\ntable->ACPIState.levels[0].mclk.mclk730.mclk_value = 0;\r\ntable->ACPIState.levels[0].sclk.vCG_SPLL_FUNC_CNTL = cpu_to_be32(spll_func_cntl);\r\ntable->ACPIState.levels[0].sclk.vCG_SPLL_FUNC_CNTL_2 = cpu_to_be32(spll_func_cntl_2);\r\ntable->ACPIState.levels[0].sclk.vCG_SPLL_FUNC_CNTL_3 = cpu_to_be32(spll_func_cntl_3);\r\ntable->ACPIState.levels[0].sclk.sclk_value = 0;\r\nrv770_populate_mvdd_value(rdev, 0, &table->ACPIState.levels[0].mvdd);\r\ntable->ACPIState.levels[1] = table->ACPIState.levels[0];\r\ntable->ACPIState.levels[2] = table->ACPIState.levels[0];\r\nreturn 0;\r\n}\r\nint rv730_populate_smc_initial_state(struct radeon_device *rdev,\r\nstruct radeon_ps *radeon_state,\r\nRV770_SMC_STATETABLE *table)\r\n{\r\nstruct rv7xx_ps *initial_state = rv770_get_ps(radeon_state);\r\nstruct rv7xx_power_info *pi = rv770_get_pi(rdev);\r\nu32 a_t;\r\ntable->initialState.levels[0].mclk.mclk730.vMPLL_FUNC_CNTL =\r\ncpu_to_be32(pi->clk_regs.rv730.mpll_func_cntl);\r\ntable->initialState.levels[0].mclk.mclk730.vMPLL_FUNC_CNTL2 =\r\ncpu_to_be32(pi->clk_regs.rv730.mpll_func_cntl2);\r\ntable->initialState.levels[0].mclk.mclk730.vMPLL_FUNC_CNTL3 =\r\ncpu_to_be32(pi->clk_regs.rv730.mpll_func_cntl3);\r\ntable->initialState.levels[0].mclk.mclk730.vMCLK_PWRMGT_CNTL =\r\ncpu_to_be32(pi->clk_regs.rv730.mclk_pwrmgt_cntl);\r\ntable->initialState.levels[0].mclk.mclk730.vDLL_CNTL =\r\ncpu_to_be32(pi->clk_regs.rv730.dll_cntl);\r\ntable->initialState.levels[0].mclk.mclk730.vMPLL_SS =\r\ncpu_to_be32(pi->clk_regs.rv730.mpll_ss);\r\ntable->initialState.levels[0].mclk.mclk730.vMPLL_SS2 =\r\ncpu_to_be32(pi->clk_regs.rv730.mpll_ss2);\r\ntable->initialState.levels[0].mclk.mclk730.mclk_value =\r\ncpu_to_be32(initial_state->low.mclk);\r\ntable->initialState.levels[0].sclk.vCG_SPLL_FUNC_CNTL =\r\ncpu_to_be32(pi->clk_regs.rv730.cg_spll_func_cntl);\r\ntable->initialState.levels[0].sclk.vCG_SPLL_FUNC_CNTL_2 =\r\ncpu_to_be32(pi->clk_regs.rv730.cg_spll_func_cntl_2);\r\ntable->initialState.levels[0].sclk.vCG_SPLL_FUNC_CNTL_3 =\r\ncpu_to_be32(pi->clk_regs.rv730.cg_spll_func_cntl_3);\r\ntable->initialState.levels[0].sclk.vCG_SPLL_SPREAD_SPECTRUM =\r\ncpu_to_be32(pi->clk_regs.rv730.cg_spll_spread_spectrum);\r\ntable->initialState.levels[0].sclk.vCG_SPLL_SPREAD_SPECTRUM_2 =\r\ncpu_to_be32(pi->clk_regs.rv730.cg_spll_spread_spectrum_2);\r\ntable->initialState.levels[0].sclk.sclk_value =\r\ncpu_to_be32(initial_state->low.sclk);\r\ntable->initialState.levels[0].arbValue = MC_CG_ARB_FREQ_F0;\r\ntable->initialState.levels[0].seqValue =\r\nrv770_get_seq_value(rdev, &initial_state->low);\r\nrv770_populate_vddc_value(rdev,\r\ninitial_state->low.vddc,\r\n&table->initialState.levels[0].vddc);\r\nrv770_populate_initial_mvdd_value(rdev,\r\n&table->initialState.levels[0].mvdd);\r\na_t = CG_R(0xffff) | CG_L(0);\r\ntable->initialState.levels[0].aT = cpu_to_be32(a_t);\r\ntable->initialState.levels[0].bSP = cpu_to_be32(pi->dsp);\r\nif (pi->boot_in_gen2)\r\ntable->initialState.levels[0].gen2PCIE = 1;\r\nelse\r\ntable->initialState.levels[0].gen2PCIE = 0;\r\nif (initial_state->low.flags & ATOM_PPLIB_R600_FLAGS_PCIEGEN2)\r\ntable->initialState.levels[0].gen2XSP = 1;\r\nelse\r\ntable->initialState.levels[0].gen2XSP = 0;\r\ntable->initialState.levels[1] = table->initialState.levels[0];\r\ntable->initialState.levels[2] = table->initialState.levels[0];\r\ntable->initialState.flags |= PPSMC_SWSTATE_FLAG_DC;\r\nreturn 0;\r\n}\r\nvoid rv730_program_memory_timing_parameters(struct radeon_device *rdev,\r\nstruct radeon_ps *radeon_state)\r\n{\r\nstruct rv7xx_ps *state = rv770_get_ps(radeon_state);\r\nu32 arb_refresh_rate = 0;\r\nu32 dram_timing = 0;\r\nu32 dram_timing2 = 0;\r\nu32 old_dram_timing = 0;\r\nu32 old_dram_timing2 = 0;\r\narb_refresh_rate = RREG32(MC_ARB_RFSH_RATE) &\r\n~(POWERMODE1_MASK | POWERMODE2_MASK | POWERMODE3_MASK);\r\narb_refresh_rate |=\r\n(POWERMODE1(rv770_calculate_memory_refresh_rate(rdev, state->low.sclk)) |\r\nPOWERMODE2(rv770_calculate_memory_refresh_rate(rdev, state->medium.sclk)) |\r\nPOWERMODE3(rv770_calculate_memory_refresh_rate(rdev, state->high.sclk)));\r\nWREG32(MC_ARB_RFSH_RATE, arb_refresh_rate);\r\nold_dram_timing = RREG32(MC_ARB_DRAM_TIMING);\r\nold_dram_timing2 = RREG32(MC_ARB_DRAM_TIMING2);\r\nradeon_atom_set_engine_dram_timings(rdev,\r\nstate->high.sclk,\r\nstate->high.mclk);\r\ndram_timing = RREG32(MC_ARB_DRAM_TIMING);\r\ndram_timing2 = RREG32(MC_ARB_DRAM_TIMING2);\r\nWREG32(MC_ARB_DRAM_TIMING_3, dram_timing);\r\nWREG32(MC_ARB_DRAM_TIMING2_3, dram_timing2);\r\nradeon_atom_set_engine_dram_timings(rdev,\r\nstate->medium.sclk,\r\nstate->medium.mclk);\r\ndram_timing = RREG32(MC_ARB_DRAM_TIMING);\r\ndram_timing2 = RREG32(MC_ARB_DRAM_TIMING2);\r\nWREG32(MC_ARB_DRAM_TIMING_2, dram_timing);\r\nWREG32(MC_ARB_DRAM_TIMING2_2, dram_timing2);\r\nradeon_atom_set_engine_dram_timings(rdev,\r\nstate->low.sclk,\r\nstate->low.mclk);\r\ndram_timing = RREG32(MC_ARB_DRAM_TIMING);\r\ndram_timing2 = RREG32(MC_ARB_DRAM_TIMING2);\r\nWREG32(MC_ARB_DRAM_TIMING_1, dram_timing);\r\nWREG32(MC_ARB_DRAM_TIMING2_1, dram_timing2);\r\nWREG32(MC_ARB_DRAM_TIMING, old_dram_timing);\r\nWREG32(MC_ARB_DRAM_TIMING2, old_dram_timing2);\r\n}\r\nvoid rv730_start_dpm(struct radeon_device *rdev)\r\n{\r\nWREG32_P(SCLK_PWRMGT_CNTL, 0, ~SCLK_PWRMGT_OFF);\r\nWREG32_P(TCI_MCLK_PWRMGT_CNTL, 0, ~MPLL_PWRMGT_OFF);\r\nWREG32_P(GENERAL_PWRMGT, GLOBAL_PWRMGT_EN, ~GLOBAL_PWRMGT_EN);\r\n}\r\nvoid rv730_stop_dpm(struct radeon_device *rdev)\r\n{\r\nPPSMC_Result result;\r\nresult = rv770_send_msg_to_smc(rdev, PPSMC_MSG_TwoLevelsDisabled);\r\nif (result != PPSMC_Result_OK)\r\nDRM_DEBUG("Could not force DPM to low\n");\r\nWREG32_P(GENERAL_PWRMGT, 0, ~GLOBAL_PWRMGT_EN);\r\nWREG32_P(SCLK_PWRMGT_CNTL, SCLK_PWRMGT_OFF, ~SCLK_PWRMGT_OFF);\r\nWREG32_P(TCI_MCLK_PWRMGT_CNTL, MPLL_PWRMGT_OFF, ~MPLL_PWRMGT_OFF);\r\n}\r\nvoid rv730_program_dcodt(struct radeon_device *rdev, bool use_dcodt)\r\n{\r\nstruct rv7xx_power_info *pi = rv770_get_pi(rdev);\r\nu32 i = use_dcodt ? 0 : 1;\r\nu32 mc4_io_pad_cntl;\r\nmc4_io_pad_cntl = RREG32(MC4_IO_DQ_PAD_CNTL_D0_I0);\r\nmc4_io_pad_cntl &= 0xFFFFFF00;\r\nmc4_io_pad_cntl |= pi->odt_value_0[i];\r\nWREG32(MC4_IO_DQ_PAD_CNTL_D0_I0, mc4_io_pad_cntl);\r\nWREG32(MC4_IO_DQ_PAD_CNTL_D0_I1, mc4_io_pad_cntl);\r\nmc4_io_pad_cntl = RREG32(MC4_IO_QS_PAD_CNTL_D0_I0);\r\nmc4_io_pad_cntl &= 0xFFFFFF00;\r\nmc4_io_pad_cntl |= pi->odt_value_1[i];\r\nWREG32(MC4_IO_QS_PAD_CNTL_D0_I0, mc4_io_pad_cntl);\r\nWREG32(MC4_IO_QS_PAD_CNTL_D0_I1, mc4_io_pad_cntl);\r\n}\r\nvoid rv730_get_odt_values(struct radeon_device *rdev)\r\n{\r\nstruct rv7xx_power_info *pi = rv770_get_pi(rdev);\r\nu32 mc4_io_pad_cntl;\r\npi->odt_value_0[0] = (u8)0;\r\npi->odt_value_1[0] = (u8)0x80;\r\nmc4_io_pad_cntl = RREG32(MC4_IO_DQ_PAD_CNTL_D0_I0);\r\npi->odt_value_0[1] = (u8)(mc4_io_pad_cntl & 0xff);\r\nmc4_io_pad_cntl = RREG32(MC4_IO_QS_PAD_CNTL_D0_I0);\r\npi->odt_value_1[1] = (u8)(mc4_io_pad_cntl & 0xff);\r\n}
