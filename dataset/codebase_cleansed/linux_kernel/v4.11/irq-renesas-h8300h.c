static void h8300h_disable_irq(struct irq_data *data)\r\n{\r\nint bit;\r\nint irq = data->irq - 12;\r\nbit = ipr_bit[irq];\r\nif (bit >= 0) {\r\nif (bit < 8)\r\nctrl_bclr(bit & 7, IPR);\r\nelse\r\nctrl_bclr(bit & 7, (IPR+1));\r\n}\r\n}\r\nstatic void h8300h_enable_irq(struct irq_data *data)\r\n{\r\nint bit;\r\nint irq = data->irq - 12;\r\nbit = ipr_bit[irq];\r\nif (bit >= 0) {\r\nif (bit < 8)\r\nctrl_bset(bit & 7, IPR);\r\nelse\r\nctrl_bset(bit & 7, (IPR+1));\r\n}\r\n}\r\nstatic int irq_map(struct irq_domain *h, unsigned int virq,\r\nirq_hw_number_t hw_irq_num)\r\n{\r\nirq_set_chip_and_handler(virq, &h8300h_irq_chip, handle_simple_irq);\r\nreturn 0;\r\n}\r\nstatic int __init h8300h_intc_of_init(struct device_node *intc,\r\nstruct device_node *parent)\r\n{\r\nstruct irq_domain *domain;\r\nintc_baseaddr = of_iomap(intc, 0);\r\nBUG_ON(!intc_baseaddr);\r\nwriteb(0x00, IPR + 0);\r\nwriteb(0x00, IPR + 1);\r\ndomain = irq_domain_add_linear(intc, NR_IRQS, &irq_ops, NULL);\r\nBUG_ON(!domain);\r\nirq_set_default_host(domain);\r\nreturn 0;\r\n}
