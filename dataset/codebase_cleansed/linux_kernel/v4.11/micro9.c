static unsigned int __init micro9_detect_bootwidth(void)\r\n{\r\nu32 v;\r\nv = __raw_readl(EP93XX_SYSCON_SYSCFG);\r\nif (v & EP93XX_SYSCON_SYSCFG_LCSN7)\r\nreturn 4;\r\nelse\r\nreturn 2;\r\n}\r\nstatic void __init micro9_register_flash(void)\r\n{\r\nunsigned int width;\r\nif (machine_is_micro9())\r\nwidth = 4;\r\nelse if (machine_is_micro9m() || machine_is_micro9s())\r\nwidth = micro9_detect_bootwidth();\r\nelse\r\nwidth = 0;\r\nif (width)\r\nep93xx_register_flash(width, EP93XX_CS1_PHYS_BASE, SZ_64M);\r\n}\r\nstatic void __init micro9_init_machine(void)\r\n{\r\nep93xx_init_devices();\r\nep93xx_register_eth(&micro9_eth_data, 1);\r\nmicro9_register_flash();\r\n}
