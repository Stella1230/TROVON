static int\r\nll_initxattrs(struct inode *inode, const struct xattr *xattr_array,\r\nvoid *fs_info)\r\n{\r\nconst struct xattr_handler *handler;\r\nstruct dentry *dentry = fs_info;\r\nconst struct xattr *xattr;\r\nint err = 0;\r\nhandler = get_xattr_type(XATTR_SECURITY_PREFIX);\r\nif (!handler)\r\nreturn -ENXIO;\r\nfor (xattr = xattr_array; xattr->name; xattr++) {\r\nerr = handler->set(handler, dentry, inode, xattr->name,\r\nxattr->value, xattr->value_len,\r\nXATTR_CREATE);\r\nif (err < 0)\r\nbreak;\r\n}\r\nreturn err;\r\n}\r\nint\r\nll_init_security(struct dentry *dentry, struct inode *inode, struct inode *dir)\r\n{\r\nif (!selinux_is_enabled())\r\nreturn 0;\r\nreturn security_inode_init_security(inode, dir, NULL,\r\n&ll_initxattrs, dentry);\r\n}
