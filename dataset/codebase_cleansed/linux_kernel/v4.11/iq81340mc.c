static int __init\r\niq81340mc_pcix_map_irq(const struct pci_dev *dev, u8 idsel, u8 pin)\r\n{\r\nswitch (idsel) {\r\ncase 1:\r\nswitch (pin) {\r\ncase 1: return ATUX_INTB;\r\ncase 2: return ATUX_INTC;\r\ncase 3: return ATUX_INTD;\r\ncase 4: return ATUX_INTA;\r\ndefault: return -1;\r\n}\r\ncase 2:\r\nswitch (pin) {\r\ncase 1: return ATUX_INTC;\r\ncase 2: return ATUX_INTD;\r\ncase 3: return ATUX_INTC;\r\ncase 4: return ATUX_INTD;\r\ndefault: return -1;\r\n}\r\ndefault: return -1;\r\n}\r\n}\r\nstatic int __init iq81340mc_pci_init(void)\r\n{\r\niop13xx_atu_select(&iq81340mc_pci);\r\npci_common_init(&iq81340mc_pci);\r\niop13xx_map_pci_memory();\r\nreturn 0;\r\n}\r\nstatic void __init iq81340mc_init(void)\r\n{\r\niop13xx_platform_init();\r\niq81340mc_pci_init();\r\niop13xx_add_tpmi_devices();\r\n}\r\nstatic void __init iq81340mc_timer_init(void)\r\n{\r\nunsigned long bus_freq = iop13xx_core_freq() / iop13xx_xsi_bus_ratio();\r\nprintk(KERN_DEBUG "%s: bus frequency: %lu\n", __func__, bus_freq);\r\niop_init_time(bus_freq);\r\n}
