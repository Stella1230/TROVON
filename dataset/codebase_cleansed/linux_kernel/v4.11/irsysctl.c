static int do_devname(struct ctl_table *table, int write,\r\nvoid __user *buffer, size_t *lenp, loff_t *ppos)\r\n{\r\nint ret;\r\nret = proc_dostring(table, write, buffer, lenp, ppos);\r\nif (ret == 0 && write) {\r\nstruct ias_value *val;\r\nval = irias_new_string_value(sysctl_devname);\r\nif (val)\r\nirias_object_change_attribute("Device", "DeviceName", val);\r\n}\r\nreturn ret;\r\n}\r\nstatic int do_discovery(struct ctl_table *table, int write,\r\nvoid __user *buffer, size_t *lenp, loff_t *ppos)\r\n{\r\nint ret;\r\nret = proc_dointvec(table, write, buffer, lenp, ppos);\r\nif (ret)\r\nreturn ret;\r\nif (irlmp == NULL)\r\nreturn -ENODEV;\r\nif (sysctl_discovery)\r\nirlmp_start_discovery_timer(irlmp, sysctl_discovery_timeout*HZ);\r\nelse\r\ndel_timer_sync(&irlmp->discovery_timer);\r\nreturn ret;\r\n}\r\nint __init irda_sysctl_register(void)\r\n{\r\nirda_table_header = register_net_sysctl(&init_net, "net/irda", irda_table);\r\nif (!irda_table_header)\r\nreturn -ENOMEM;\r\nreturn 0;\r\n}\r\nvoid irda_sysctl_unregister(void)\r\n{\r\nunregister_net_sysctl_table(irda_table_header);\r\n}
