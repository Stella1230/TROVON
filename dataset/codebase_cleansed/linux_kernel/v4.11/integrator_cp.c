static void __init intcp_map_io(void)\r\n{\r\niotable_init(intcp_io_desc, ARRAY_SIZE(intcp_io_desc));\r\n}\r\nstatic unsigned int mmc_status(struct device *dev)\r\n{\r\nunsigned int status = readl(__io_address(0xca000000 + 4));\r\nwritel(8, intcp_con_base + 8);\r\nreturn status & 8;\r\n}\r\nstatic u64 notrace intcp_read_sched_clock(void)\r\n{\r\nunsigned int val;\r\nregmap_read(cm_map, CM_COUNTER_OFFSET, &val);\r\nreturn val;\r\n}\r\nstatic void __init intcp_init_early(void)\r\n{\r\ncm_map = syscon_regmap_lookup_by_compatible("arm,core-module-integrator");\r\nif (IS_ERR(cm_map))\r\nreturn;\r\nsched_clock_register(intcp_read_sched_clock, 32, 24000000);\r\n}\r\nstatic void __init intcp_init_irq_of(void)\r\n{\r\ncm_init();\r\nirqchip_init();\r\n}\r\nstatic void __init intcp_init_of(void)\r\n{\r\nstruct device_node *cpcon;\r\ncpcon = of_find_matching_node(NULL, intcp_syscon_match);\r\nif (!cpcon)\r\nreturn;\r\nintcp_con_base = of_iomap(cpcon, 0);\r\nif (!intcp_con_base)\r\nreturn;\r\nof_platform_default_populate(NULL, intcp_auxdata_lookup, NULL);\r\n}
