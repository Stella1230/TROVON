void request_event_sources_irqs(struct device_node *np,\r\nirq_handler_t handler,\r\nconst char *name)\r\n{\r\nint i, index, count = 0;\r\nstruct of_phandle_args oirq;\r\nunsigned int virqs[16];\r\nfor (index = 0; of_irq_parse_one(np, index, &oirq) == 0;\r\nindex++) {\r\nif (count > 15)\r\nbreak;\r\nvirqs[count] = irq_create_of_mapping(&oirq);\r\nif (!virqs[count]) {\r\npr_err("event-sources: Unable to allocate "\r\n"interrupt number for %s\n",\r\nnp->full_name);\r\nWARN_ON(1);\r\n} else {\r\ncount++;\r\n}\r\n}\r\nfor (i = 0; i < count; i++) {\r\nif (request_irq(virqs[i], handler, 0, name, NULL)) {\r\npr_err("event-sources: Unable to request interrupt "\r\n"%d for %s\n", virqs[i], np->full_name);\r\nWARN_ON(1);\r\nreturn;\r\n}\r\n}\r\n}
