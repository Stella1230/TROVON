u32 get_dynamic_sa_offset_state_ptr_field(struct crypto4xx_ctx *ctx)\r\n{\r\nu32 offset;\r\nunion dynamic_sa_contents cts;\r\nif (ctx->direction == DIR_INBOUND)\r\ncts.w = ((struct dynamic_sa_ctl *) ctx->sa_in)->sa_contents;\r\nelse\r\ncts.w = ((struct dynamic_sa_ctl *) ctx->sa_out)->sa_contents;\r\noffset = cts.bf.key_size\r\n+ cts.bf.inner_size\r\n+ cts.bf.outer_size\r\n+ cts.bf.spi\r\n+ cts.bf.seq_num0\r\n+ cts.bf.seq_num1\r\n+ cts.bf.seq_num_mask0\r\n+ cts.bf.seq_num_mask1\r\n+ cts.bf.seq_num_mask2\r\n+ cts.bf.seq_num_mask3\r\n+ cts.bf.iv0\r\n+ cts.bf.iv1\r\n+ cts.bf.iv2\r\n+ cts.bf.iv3;\r\nreturn sizeof(struct dynamic_sa_ctl) + offset * 4;\r\n}\r\nu32 get_dynamic_sa_iv_size(struct crypto4xx_ctx *ctx)\r\n{\r\nunion dynamic_sa_contents cts;\r\nif (ctx->direction == DIR_INBOUND)\r\ncts.w = ((struct dynamic_sa_ctl *) ctx->sa_in)->sa_contents;\r\nelse\r\ncts.w = ((struct dynamic_sa_ctl *) ctx->sa_out)->sa_contents;\r\nreturn (cts.bf.iv0 + cts.bf.iv1 + cts.bf.iv2 + cts.bf.iv3) * 4;\r\n}\r\nu32 get_dynamic_sa_offset_key_field(struct crypto4xx_ctx *ctx)\r\n{\r\nunion dynamic_sa_contents cts;\r\nif (ctx->direction == DIR_INBOUND)\r\ncts.w = ((struct dynamic_sa_ctl *) ctx->sa_in)->sa_contents;\r\nelse\r\ncts.w = ((struct dynamic_sa_ctl *) ctx->sa_out)->sa_contents;\r\nreturn sizeof(struct dynamic_sa_ctl);\r\n}
