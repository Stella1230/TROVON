int rsa_get_n(void *context, size_t hdrlen, unsigned char tag,\r\nconst void *value, size_t vlen)\r\n{\r\nstruct rsa_key *key = context;\r\nconst u8 *ptr = value;\r\nsize_t n_sz = vlen;\r\nif (!value || !vlen)\r\nreturn -EINVAL;\r\nif (fips_enabled) {\r\nwhile (!*ptr && n_sz) {\r\nptr++;\r\nn_sz--;\r\n}\r\nif (n_sz < 256) {\r\npr_err("RSA: key size not allowed in FIPS mode\n");\r\nreturn -EINVAL;\r\n}\r\n}\r\nkey->n = value;\r\nkey->n_sz = vlen;\r\nreturn 0;\r\n}\r\nint rsa_get_e(void *context, size_t hdrlen, unsigned char tag,\r\nconst void *value, size_t vlen)\r\n{\r\nstruct rsa_key *key = context;\r\nif (!value || !key->n_sz || !vlen || vlen > key->n_sz)\r\nreturn -EINVAL;\r\nkey->e = value;\r\nkey->e_sz = vlen;\r\nreturn 0;\r\n}\r\nint rsa_get_d(void *context, size_t hdrlen, unsigned char tag,\r\nconst void *value, size_t vlen)\r\n{\r\nstruct rsa_key *key = context;\r\nif (!value || !key->n_sz || !vlen || vlen > key->n_sz)\r\nreturn -EINVAL;\r\nkey->d = value;\r\nkey->d_sz = vlen;\r\nreturn 0;\r\n}\r\nint rsa_get_p(void *context, size_t hdrlen, unsigned char tag,\r\nconst void *value, size_t vlen)\r\n{\r\nstruct rsa_key *key = context;\r\nif (!value || !vlen || vlen > key->n_sz)\r\nreturn -EINVAL;\r\nkey->p = value;\r\nkey->p_sz = vlen;\r\nreturn 0;\r\n}\r\nint rsa_get_q(void *context, size_t hdrlen, unsigned char tag,\r\nconst void *value, size_t vlen)\r\n{\r\nstruct rsa_key *key = context;\r\nif (!value || !vlen || vlen > key->n_sz)\r\nreturn -EINVAL;\r\nkey->q = value;\r\nkey->q_sz = vlen;\r\nreturn 0;\r\n}\r\nint rsa_get_dp(void *context, size_t hdrlen, unsigned char tag,\r\nconst void *value, size_t vlen)\r\n{\r\nstruct rsa_key *key = context;\r\nif (!value || !vlen || vlen > key->n_sz)\r\nreturn -EINVAL;\r\nkey->dp = value;\r\nkey->dp_sz = vlen;\r\nreturn 0;\r\n}\r\nint rsa_get_dq(void *context, size_t hdrlen, unsigned char tag,\r\nconst void *value, size_t vlen)\r\n{\r\nstruct rsa_key *key = context;\r\nif (!value || !vlen || vlen > key->n_sz)\r\nreturn -EINVAL;\r\nkey->dq = value;\r\nkey->dq_sz = vlen;\r\nreturn 0;\r\n}\r\nint rsa_get_qinv(void *context, size_t hdrlen, unsigned char tag,\r\nconst void *value, size_t vlen)\r\n{\r\nstruct rsa_key *key = context;\r\nif (!value || !vlen || vlen > key->n_sz)\r\nreturn -EINVAL;\r\nkey->qinv = value;\r\nkey->qinv_sz = vlen;\r\nreturn 0;\r\n}\r\nint rsa_parse_pub_key(struct rsa_key *rsa_key, const void *key,\r\nunsigned int key_len)\r\n{\r\nreturn asn1_ber_decoder(&rsapubkey_decoder, rsa_key, key, key_len);\r\n}\r\nint rsa_parse_priv_key(struct rsa_key *rsa_key, const void *key,\r\nunsigned int key_len)\r\n{\r\nreturn asn1_ber_decoder(&rsaprivkey_decoder, rsa_key, key, key_len);\r\n}
