static ssize_t foo_show(struct kobject *kobj, struct kobj_attribute *attr,\r\nchar *buf)\r\n{\r\nreturn sprintf(buf, "%d\n", foo);\r\n}\r\nstatic ssize_t foo_store(struct kobject *kobj, struct kobj_attribute *attr,\r\nconst char *buf, size_t count)\r\n{\r\nint ret;\r\nret = kstrtoint(buf, 10, &foo);\r\nif (ret < 0)\r\nreturn ret;\r\nreturn count;\r\n}\r\nstatic ssize_t b_show(struct kobject *kobj, struct kobj_attribute *attr,\r\nchar *buf)\r\n{\r\nint var;\r\nif (strcmp(attr->attr.name, "baz") == 0)\r\nvar = baz;\r\nelse\r\nvar = bar;\r\nreturn sprintf(buf, "%d\n", var);\r\n}\r\nstatic ssize_t b_store(struct kobject *kobj, struct kobj_attribute *attr,\r\nconst char *buf, size_t count)\r\n{\r\nint var, ret;\r\nret = kstrtoint(buf, 10, &var);\r\nif (ret < 0)\r\nreturn ret;\r\nif (strcmp(attr->attr.name, "baz") == 0)\r\nbaz = var;\r\nelse\r\nbar = var;\r\nreturn count;\r\n}\r\nstatic int __init example_init(void)\r\n{\r\nint retval;\r\nexample_kobj = kobject_create_and_add("kobject_example", kernel_kobj);\r\nif (!example_kobj)\r\nreturn -ENOMEM;\r\nretval = sysfs_create_group(example_kobj, &attr_group);\r\nif (retval)\r\nkobject_put(example_kobj);\r\nreturn retval;\r\n}\r\nstatic void __exit example_exit(void)\r\n{\r\nkobject_put(example_kobj);\r\n}
