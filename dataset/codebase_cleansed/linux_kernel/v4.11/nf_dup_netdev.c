static void nf_do_netdev_egress(struct sk_buff *skb, struct net_device *dev)\r\n{\r\nif (skb_mac_header_was_set(skb))\r\nskb_push(skb, skb->mac_len);\r\nskb->dev = dev;\r\ndev_queue_xmit(skb);\r\n}\r\nvoid nf_fwd_netdev_egress(const struct nft_pktinfo *pkt, int oif)\r\n{\r\nstruct net_device *dev;\r\ndev = dev_get_by_index_rcu(nft_net(pkt), oif);\r\nif (!dev) {\r\nkfree_skb(pkt->skb);\r\nreturn;\r\n}\r\nnf_do_netdev_egress(pkt->skb, dev);\r\n}\r\nvoid nf_dup_netdev_egress(const struct nft_pktinfo *pkt, int oif)\r\n{\r\nstruct net_device *dev;\r\nstruct sk_buff *skb;\r\ndev = dev_get_by_index_rcu(nft_net(pkt), oif);\r\nif (dev == NULL)\r\nreturn;\r\nskb = skb_clone(pkt->skb, GFP_ATOMIC);\r\nif (skb)\r\nnf_do_netdev_egress(skb, dev);\r\n}
