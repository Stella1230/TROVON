static irqreturn_t hvc_handle_interrupt(int irq, void *dev_instance)\r\n{\r\nif (hvc_poll(dev_instance))\r\nhvc_kick();\r\nreturn IRQ_HANDLED;\r\n}\r\nint notifier_add_irq(struct hvc_struct *hp, int irq)\r\n{\r\nint rc;\r\nif (!irq) {\r\nhp->irq_requested = 0;\r\nreturn 0;\r\n}\r\nrc = request_irq(irq, hvc_handle_interrupt, 0,\r\n"hvc_console", hp);\r\nif (!rc)\r\nhp->irq_requested = 1;\r\nreturn rc;\r\n}\r\nvoid notifier_del_irq(struct hvc_struct *hp, int irq)\r\n{\r\nif (!hp->irq_requested)\r\nreturn;\r\nfree_irq(irq, hp);\r\nhp->irq_requested = 0;\r\n}\r\nvoid notifier_hangup_irq(struct hvc_struct *hp, int irq)\r\n{\r\nnotifier_del_irq(hp, irq);\r\n}
