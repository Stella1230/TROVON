static const struct b2056_inittabs_pts\r\n*b43_nphy_get_inittabs_rev3(struct b43_wldev *dev)\r\n{\r\nstruct b43_phy *phy = &dev->phy;\r\nswitch (dev->phy.rev) {\r\ncase 3:\r\nreturn &b2056_inittab_phy_rev3;\r\ncase 4:\r\nreturn &b2056_inittab_phy_rev4;\r\ndefault:\r\nswitch (phy->radio_rev) {\r\ncase 5:\r\nreturn &b2056_inittab_radio_rev5;\r\ncase 6:\r\nreturn &b2056_inittab_radio_rev6;\r\ncase 7:\r\ncase 9:\r\nreturn &b2056_inittab_radio_rev7_9;\r\ncase 8:\r\nreturn &b2056_inittab_radio_rev8;\r\ncase 11:\r\nreturn &b2056_inittab_radio_rev11;\r\n}\r\n}\r\nreturn NULL;\r\n}\r\nstatic void b2056_upload_inittab(struct b43_wldev *dev, bool ghz5,\r\nbool ignore_uploadflag, u16 routing,\r\nconst struct b2056_inittab_entry *e,\r\nunsigned int length)\r\n{\r\nunsigned int i;\r\nu16 value;\r\nfor (i = 0; i < length; i++, e++) {\r\nif (!(e->flags & B2056_INITTAB_ENTRY_OK))\r\ncontinue;\r\nif ((e->flags & B2056_INITTAB_UPLOAD) || ignore_uploadflag) {\r\nif (ghz5)\r\nvalue = e->ghz5;\r\nelse\r\nvalue = e->ghz2;\r\nb43_radio_write(dev, routing | i, value);\r\n}\r\n}\r\n}\r\nvoid b2056_upload_inittabs(struct b43_wldev *dev,\r\nbool ghz5, bool ignore_uploadflag)\r\n{\r\nconst struct b2056_inittabs_pts *pts;\r\npts = b43_nphy_get_inittabs_rev3(dev);\r\nif (!pts) {\r\nB43_WARN_ON(1);\r\nreturn;\r\n}\r\nb2056_upload_inittab(dev, ghz5, ignore_uploadflag,\r\nB2056_SYN, pts->syn, pts->syn_length);\r\nb2056_upload_inittab(dev, ghz5, ignore_uploadflag,\r\nB2056_TX0, pts->tx, pts->tx_length);\r\nb2056_upload_inittab(dev, ghz5, ignore_uploadflag,\r\nB2056_TX1, pts->tx, pts->tx_length);\r\nb2056_upload_inittab(dev, ghz5, ignore_uploadflag,\r\nB2056_RX0, pts->rx, pts->rx_length);\r\nb2056_upload_inittab(dev, ghz5, ignore_uploadflag,\r\nB2056_RX1, pts->rx, pts->rx_length);\r\n}\r\nvoid b2056_upload_syn_pll_cp2(struct b43_wldev *dev, bool ghz5)\r\n{\r\nconst struct b2056_inittabs_pts *pts;\r\nconst struct b2056_inittab_entry *e;\r\npts = b43_nphy_get_inittabs_rev3(dev);\r\nif (!pts) {\r\nB43_WARN_ON(1);\r\nreturn;\r\n}\r\ne = &pts->syn[B2056_SYN_PLL_CP2];\r\nb43_radio_write(dev, B2056_SYN_PLL_CP2, ghz5 ? e->ghz5 : e->ghz2);\r\n}\r\nconst struct b43_nphy_channeltab_entry_rev3 *\r\nb43_nphy_get_chantabent_rev3(struct b43_wldev *dev, u16 freq)\r\n{\r\nstruct b43_phy *phy = &dev->phy;\r\nconst struct b43_nphy_channeltab_entry_rev3 *e;\r\nunsigned int length, i;\r\nswitch (phy->rev) {\r\ncase 3:\r\ne = b43_nphy_channeltab_phy_rev3;\r\nlength = ARRAY_SIZE(b43_nphy_channeltab_phy_rev3);\r\nbreak;\r\ncase 4:\r\ne = b43_nphy_channeltab_phy_rev4;\r\nlength = ARRAY_SIZE(b43_nphy_channeltab_phy_rev4);\r\nbreak;\r\ndefault:\r\nswitch (phy->radio_rev) {\r\ncase 5:\r\ne = b43_nphy_channeltab_radio_rev5;\r\nlength = ARRAY_SIZE(b43_nphy_channeltab_radio_rev5);\r\nbreak;\r\ncase 6:\r\ne = b43_nphy_channeltab_radio_rev6;\r\nlength = ARRAY_SIZE(b43_nphy_channeltab_radio_rev6);\r\nbreak;\r\ncase 7:\r\ncase 9:\r\ne = b43_nphy_channeltab_radio_rev7_9;\r\nlength = ARRAY_SIZE(b43_nphy_channeltab_radio_rev7_9);\r\nbreak;\r\ncase 8:\r\ne = b43_nphy_channeltab_radio_rev8;\r\nlength = ARRAY_SIZE(b43_nphy_channeltab_radio_rev8);\r\nbreak;\r\ncase 11:\r\ne = b43_nphy_channeltab_radio_rev11;\r\nlength = ARRAY_SIZE(b43_nphy_channeltab_radio_rev11);\r\nbreak;\r\ndefault:\r\nB43_WARN_ON(1);\r\nreturn NULL;\r\n}\r\n}\r\nfor (i = 0; i < length; i++, e++) {\r\nif (e->freq == freq)\r\nreturn e;\r\n}\r\nreturn NULL;\r\n}
