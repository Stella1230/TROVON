static int calxeda_idle_finish(unsigned long val)\r\n{\r\nconst struct psci_power_state ps = {\r\n.type = PSCI_POWER_STATE_TYPE_POWER_DOWN,\r\n};\r\nreturn psci_ops.cpu_suspend(ps, __pa(cpu_resume));\r\n}\r\nstatic int calxeda_pwrdown_idle(struct cpuidle_device *dev,\r\nstruct cpuidle_driver *drv,\r\nint index)\r\n{\r\ncpu_pm_enter();\r\ncpu_suspend(0, calxeda_idle_finish);\r\ncpu_pm_exit();\r\nreturn index;\r\n}\r\nstatic int calxeda_cpuidle_probe(struct platform_device *pdev)\r\n{\r\nreturn cpuidle_register(&calxeda_idle_driver, NULL);\r\n}
