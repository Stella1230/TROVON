static ssize_t bL_switcher_write(struct file *file, const char __user *buf,\r\nsize_t len, loff_t *pos)\r\n{\r\nunsigned char val[3];\r\nunsigned int cpu, cluster;\r\nint ret;\r\npr_debug("%s\n", __func__);\r\nif (len < 3)\r\nreturn -EINVAL;\r\nif (copy_from_user(val, buf, 3))\r\nreturn -EFAULT;\r\nif (val[0] < '0' || val[0] > '9' ||\r\nval[1] != ',' ||\r\nval[2] < '0' || val[2] > '1')\r\nreturn -EINVAL;\r\ncpu = val[0] - '0';\r\ncluster = val[2] - '0';\r\nret = bL_switch_request(cpu, cluster);\r\nreturn ret ? : len;\r\n}\r\nstatic int __init bL_switcher_dummy_if_init(void)\r\n{\r\nreturn misc_register(&bL_switcher_device);\r\n}\r\nstatic void __exit bL_switcher_dummy_if_exit(void)\r\n{\r\nmisc_deregister(&bL_switcher_device);\r\n}
