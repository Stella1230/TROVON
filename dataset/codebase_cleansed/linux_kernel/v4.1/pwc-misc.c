int pwc_get_size(struct pwc_device *pdev, int width, int height)\r\n{\r\nint i;\r\nfor (i = PSZ_MAX - 1; i >= 0; i--) {\r\nif (!(pdev->image_mask & (1 << i)))\r\ncontinue;\r\nif (pwc_image_sizes[i][0] <= width &&\r\npwc_image_sizes[i][1] <= height)\r\nreturn i;\r\n}\r\nfor (i = 0; i < PSZ_MAX; i++) {\r\nif (pdev->image_mask & (1 << i))\r\nreturn i;\r\n}\r\nreturn 0;\r\n}\r\nvoid pwc_construct(struct pwc_device *pdev)\r\n{\r\nif (DEVICE_USE_CODEC1(pdev->type)) {\r\npdev->image_mask = 1 << PSZ_SQCIF | 1 << PSZ_QCIF | 1 << PSZ_CIF;\r\npdev->vcinterface = 2;\r\npdev->vendpoint = 4;\r\npdev->frame_header_size = 0;\r\npdev->frame_trailer_size = 0;\r\n} else if (DEVICE_USE_CODEC3(pdev->type)) {\r\npdev->image_mask = 1 << PSZ_QSIF | 1 << PSZ_SIF | 1 << PSZ_VGA;\r\npdev->vcinterface = 3;\r\npdev->vendpoint = 5;\r\npdev->frame_header_size = TOUCAM_HEADER_SIZE;\r\npdev->frame_trailer_size = TOUCAM_TRAILER_SIZE;\r\n} else {\r\npdev->image_mask = 1 << PSZ_SQCIF | 1 << PSZ_QSIF | 1 << PSZ_QCIF | 1 << PSZ_SIF | 1 << PSZ_CIF | 1 << PSZ_VGA;\r\npdev->vcinterface = 3;\r\npdev->vendpoint = 4;\r\npdev->frame_header_size = 0;\r\npdev->frame_trailer_size = 0;\r\n}\r\n}
