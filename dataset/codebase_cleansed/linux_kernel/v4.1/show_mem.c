void show_mem(unsigned int filter)\r\n{\r\npg_data_t *pgdat;\r\nunsigned long total = 0, reserved = 0, highmem = 0;\r\nprintk("Mem-Info:\n");\r\nshow_free_areas(filter);\r\nfor_each_online_pgdat(pgdat) {\r\nunsigned long flags;\r\nint zoneid;\r\npgdat_resize_lock(pgdat, &flags);\r\nfor (zoneid = 0; zoneid < MAX_NR_ZONES; zoneid++) {\r\nstruct zone *zone = &pgdat->node_zones[zoneid];\r\nif (!populated_zone(zone))\r\ncontinue;\r\ntotal += zone->present_pages;\r\nreserved += zone->present_pages - zone->managed_pages;\r\nif (is_highmem_idx(zoneid))\r\nhighmem += zone->present_pages;\r\n}\r\npgdat_resize_unlock(pgdat, &flags);\r\n}\r\nprintk("%lu pages RAM\n", total);\r\nprintk("%lu pages HighMem/MovableOnly\n", highmem);\r\n#ifdef CONFIG_CMA\r\nprintk("%lu pages reserved\n", (reserved - totalcma_pages));\r\nprintk("%lu pages cma reserved\n", totalcma_pages);\r\n#else\r\nprintk("%lu pages reserved\n", reserved);\r\n#endif\r\n#ifdef CONFIG_QUICKLIST\r\nprintk("%lu pages in pagetable cache\n",\r\nquicklist_total_size());\r\n#endif\r\n#ifdef CONFIG_MEMORY_FAILURE\r\nprintk("%lu pages hwpoisoned\n", atomic_long_read(&num_poisoned_pages));\r\n#endif\r\n}
