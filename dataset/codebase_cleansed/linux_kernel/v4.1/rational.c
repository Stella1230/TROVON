void rational_best_approximation(\r\nunsigned long given_numerator, unsigned long given_denominator,\r\nunsigned long max_numerator, unsigned long max_denominator,\r\nunsigned long *best_numerator, unsigned long *best_denominator)\r\n{\r\nunsigned long n, d, n0, d0, n1, d1;\r\nn = given_numerator;\r\nd = given_denominator;\r\nn0 = d1 = 0;\r\nn1 = d0 = 1;\r\nfor (;;) {\r\nunsigned long t, a;\r\nif ((n1 > max_numerator) || (d1 > max_denominator)) {\r\nn1 = n0;\r\nd1 = d0;\r\nbreak;\r\n}\r\nif (d == 0)\r\nbreak;\r\nt = d;\r\na = n / d;\r\nd = n % d;\r\nn = t;\r\nt = n0 + a * n1;\r\nn0 = n1;\r\nn1 = t;\r\nt = d0 + a * d1;\r\nd0 = d1;\r\nd1 = t;\r\n}\r\n*best_numerator = n1;\r\n*best_denominator = d1;\r\n}
