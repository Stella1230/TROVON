unsigned int intlog2(u32 value)\r\n{\r\nunsigned int msb;\r\nunsigned int logentry;\r\nunsigned int significand;\r\nunsigned int interpolation;\r\nif (unlikely(value == 0)) {\r\nWARN_ON(1);\r\nreturn 0;\r\n}\r\nmsb = fls(value) - 1;\r\nsignificand = value << (31 - msb);\r\nlogentry = (significand >> 23) & 0xff;\r\ninterpolation = ((significand & 0x7fffff) *\r\n((logtable[(logentry + 1) & 0xff] -\r\nlogtable[logentry]) & 0xffff)) >> 15;\r\nreturn ((msb << 24) + (logtable[logentry] << 8) + interpolation);\r\n}\r\nunsigned int intlog10(u32 value)\r\n{\r\nu64 log;\r\nif (unlikely(value == 0)) {\r\nWARN_ON(1);\r\nreturn 0;\r\n}\r\nlog = intlog2(value);\r\nreturn (log * 646456993) >> 31;\r\n}
