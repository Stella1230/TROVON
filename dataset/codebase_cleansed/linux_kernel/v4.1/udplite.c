static int udplite_rcv(struct sk_buff *skb)\r\n{\r\nreturn __udp4_lib_rcv(skb, &udplite_table, IPPROTO_UDPLITE);\r\n}\r\nstatic void udplite_err(struct sk_buff *skb, u32 info)\r\n{\r\n__udp4_lib_err(skb, info, &udplite_table);\r\n}\r\nstatic int __net_init udplite4_proc_init_net(struct net *net)\r\n{\r\nreturn udp_proc_register(net, &udplite4_seq_afinfo);\r\n}\r\nstatic void __net_exit udplite4_proc_exit_net(struct net *net)\r\n{\r\nudp_proc_unregister(net, &udplite4_seq_afinfo);\r\n}\r\nstatic __init int udplite4_proc_init(void)\r\n{\r\nreturn register_pernet_subsys(&udplite4_net_ops);\r\n}\r\nstatic inline int udplite4_proc_init(void)\r\n{\r\nreturn 0;\r\n}\r\nvoid __init udplite4_register(void)\r\n{\r\nudp_table_init(&udplite_table, "UDP-Lite");\r\nif (proto_register(&udplite_prot, 1))\r\ngoto out_register_err;\r\nif (inet_add_protocol(&udplite_protocol, IPPROTO_UDPLITE) < 0)\r\ngoto out_unregister_proto;\r\ninet_register_protosw(&udplite4_protosw);\r\nif (udplite4_proc_init())\r\npr_err("%s: Cannot register /proc!\n", __func__);\r\nreturn;\r\nout_unregister_proto:\r\nproto_unregister(&udplite_prot);\r\nout_register_err:\r\npr_crit("%s: Cannot add UDP-Lite protocol\n", __func__);\r\n}
