int dvb_usb_i2c_init(struct dvb_usb_device *d)\r\n{\r\nint ret = 0;\r\nif (!(d->props.caps & DVB_USB_IS_AN_I2C_ADAPTER))\r\nreturn 0;\r\nif (d->props.i2c_algo == NULL) {\r\nerr("no i2c algorithm specified");\r\nreturn -EINVAL;\r\n}\r\nstrlcpy(d->i2c_adap.name, d->desc->name, sizeof(d->i2c_adap.name));\r\nd->i2c_adap.algo = d->props.i2c_algo;\r\nd->i2c_adap.algo_data = NULL;\r\nd->i2c_adap.dev.parent = &d->udev->dev;\r\ni2c_set_adapdata(&d->i2c_adap, d);\r\nif ((ret = i2c_add_adapter(&d->i2c_adap)) < 0)\r\nerr("could not add i2c adapter");\r\nd->state |= DVB_USB_STATE_I2C;\r\nreturn ret;\r\n}\r\nint dvb_usb_i2c_exit(struct dvb_usb_device *d)\r\n{\r\nif (d->state & DVB_USB_STATE_I2C)\r\ni2c_del_adapter(&d->i2c_adap);\r\nd->state &= ~DVB_USB_STATE_I2C;\r\nreturn 0;\r\n}
