static inline struct rcar_sysc_ch *to_r8a7779_ch(struct generic_pm_domain *d)\r\n{\r\nreturn &container_of(d, struct r8a7779_pm_domain, genpd)->ch;\r\n}\r\nstatic void __init r8a7779_sysc_init(void)\r\n{\r\nvoid __iomem *base = rcar_sysc_init(0xffd85000);\r\niowrite32(0x0131000e, base + SYSCIER);\r\niowrite32(0, base + SYSCIMR);\r\n}\r\nstatic inline void r8a7779_sysc_init(void) {}\r\nstatic int pd_power_down(struct generic_pm_domain *genpd)\r\n{\r\nreturn rcar_sysc_power_down(to_r8a7779_ch(genpd));\r\n}\r\nstatic int pd_power_up(struct generic_pm_domain *genpd)\r\n{\r\nreturn rcar_sysc_power_up(to_r8a7779_ch(genpd));\r\n}\r\nstatic bool pd_is_off(struct generic_pm_domain *genpd)\r\n{\r\nreturn rcar_sysc_power_is_off(to_r8a7779_ch(genpd));\r\n}\r\nstatic bool pd_active_wakeup(struct device *dev)\r\n{\r\nreturn true;\r\n}\r\nstatic void r8a7779_init_pm_domain(struct r8a7779_pm_domain *r8a7779_pd)\r\n{\r\nstruct generic_pm_domain *genpd = &r8a7779_pd->genpd;\r\ngenpd->flags = GENPD_FLAG_PM_CLK;\r\npm_genpd_init(genpd, NULL, false);\r\ngenpd->dev_ops.active_wakeup = pd_active_wakeup;\r\ngenpd->power_off = pd_power_down;\r\ngenpd->power_on = pd_power_up;\r\nif (pd_is_off(&r8a7779_pd->genpd))\r\npd_power_up(&r8a7779_pd->genpd);\r\n}\r\nvoid __init r8a7779_init_pm_domains(void)\r\n{\r\nint j;\r\nfor (j = 0; j < ARRAY_SIZE(r8a7779_pm_domains); j++)\r\nr8a7779_init_pm_domain(&r8a7779_pm_domains[j]);\r\n}\r\nvoid __init r8a7779_pm_init(void)\r\n{\r\nstatic int once;\r\nif (!once++)\r\nr8a7779_sysc_init();\r\n}
