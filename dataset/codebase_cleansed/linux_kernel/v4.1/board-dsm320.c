static int dsm320_pci_map_irq(const struct pci_dev *dev, u8 slot, u8 pin)\r\n{\r\nswitch (slot) {\r\ncase 0:\r\nreturn KS8695_IRQ_EXTERN0;\r\ncase 18:\r\nreturn KS8695_IRQ_EXTERN2;\r\ncase 20:\r\nreturn KS8695_IRQ_EXTERN0;\r\n}\r\nBUG();\r\n}\r\nstatic void __init dsm320_register_pci(void)\r\n{\r\nks8695_gpio_interrupt(KS8695_GPIO_0, IRQ_TYPE_LEVEL_LOW);\r\nks8695_gpio_interrupt(KS8695_GPIO_2, IRQ_TYPE_LEVEL_LOW);\r\nks8695_init_pci(&dsm320_pci);\r\n}\r\nstatic inline void __init dsm320_register_pci(void) { }\r\nvoid __init dsm320_register_nor(void)\r\n{\r\nint ret;\r\nret = platform_device_register(&dsm320_device_nor);\r\nif (ret < 0)\r\nprintk(KERN_ERR "failed to register physmap-flash device\n");\r\n}\r\nstatic void __init dsm320_init(void)\r\n{\r\nks8695_register_gpios();\r\ndsm320_register_pci();\r\nks8695_add_device_lan();\r\ndsm320_register_nor();\r\n}
