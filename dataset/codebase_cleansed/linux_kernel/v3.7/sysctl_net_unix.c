int __net_init unix_sysctl_register(struct net *net)\r\n{\r\nstruct ctl_table *table;\r\ntable = kmemdup(unix_table, sizeof(unix_table), GFP_KERNEL);\r\nif (table == NULL)\r\ngoto err_alloc;\r\ntable[0].data = &net->unx.sysctl_max_dgram_qlen;\r\nnet->unx.ctl = register_net_sysctl(net, "net/unix", table);\r\nif (net->unx.ctl == NULL)\r\ngoto err_reg;\r\nreturn 0;\r\nerr_reg:\r\nkfree(table);\r\nerr_alloc:\r\nreturn -ENOMEM;\r\n}\r\nvoid unix_sysctl_unregister(struct net *net)\r\n{\r\nstruct ctl_table *table;\r\ntable = net->unx.ctl->ctl_table_arg;\r\nunregister_net_sysctl_table(net->unx.ctl);\r\nkfree(table);\r\n}
