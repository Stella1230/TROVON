int enic_dev_fw_info(struct enic *enic, struct vnic_devcmd_fw_info **fw_info)\r\n{\r\nint err;\r\nspin_lock(&enic->devcmd_lock);\r\nerr = vnic_dev_fw_info(enic->vdev, fw_info);\r\nspin_unlock(&enic->devcmd_lock);\r\nreturn err;\r\n}\r\nint enic_dev_stats_dump(struct enic *enic, struct vnic_stats **vstats)\r\n{\r\nint err;\r\nspin_lock(&enic->devcmd_lock);\r\nerr = vnic_dev_stats_dump(enic->vdev, vstats);\r\nspin_unlock(&enic->devcmd_lock);\r\nreturn err;\r\n}\r\nint enic_dev_add_station_addr(struct enic *enic)\r\n{\r\nint err;\r\nif (!is_valid_ether_addr(enic->netdev->dev_addr))\r\nreturn -EADDRNOTAVAIL;\r\nspin_lock(&enic->devcmd_lock);\r\nerr = vnic_dev_add_addr(enic->vdev, enic->netdev->dev_addr);\r\nspin_unlock(&enic->devcmd_lock);\r\nreturn err;\r\n}\r\nint enic_dev_del_station_addr(struct enic *enic)\r\n{\r\nint err;\r\nif (!is_valid_ether_addr(enic->netdev->dev_addr))\r\nreturn -EADDRNOTAVAIL;\r\nspin_lock(&enic->devcmd_lock);\r\nerr = vnic_dev_del_addr(enic->vdev, enic->netdev->dev_addr);\r\nspin_unlock(&enic->devcmd_lock);\r\nreturn err;\r\n}\r\nint enic_dev_packet_filter(struct enic *enic, int directed, int multicast,\r\nint broadcast, int promisc, int allmulti)\r\n{\r\nint err;\r\nspin_lock(&enic->devcmd_lock);\r\nerr = vnic_dev_packet_filter(enic->vdev, directed,\r\nmulticast, broadcast, promisc, allmulti);\r\nspin_unlock(&enic->devcmd_lock);\r\nreturn err;\r\n}\r\nint enic_dev_add_addr(struct enic *enic, u8 *addr)\r\n{\r\nint err;\r\nspin_lock(&enic->devcmd_lock);\r\nerr = vnic_dev_add_addr(enic->vdev, addr);\r\nspin_unlock(&enic->devcmd_lock);\r\nreturn err;\r\n}\r\nint enic_dev_del_addr(struct enic *enic, u8 *addr)\r\n{\r\nint err;\r\nspin_lock(&enic->devcmd_lock);\r\nerr = vnic_dev_del_addr(enic->vdev, addr);\r\nspin_unlock(&enic->devcmd_lock);\r\nreturn err;\r\n}\r\nint enic_dev_notify_unset(struct enic *enic)\r\n{\r\nint err;\r\nspin_lock(&enic->devcmd_lock);\r\nerr = vnic_dev_notify_unset(enic->vdev);\r\nspin_unlock(&enic->devcmd_lock);\r\nreturn err;\r\n}\r\nint enic_dev_hang_notify(struct enic *enic)\r\n{\r\nint err;\r\nspin_lock(&enic->devcmd_lock);\r\nerr = vnic_dev_hang_notify(enic->vdev);\r\nspin_unlock(&enic->devcmd_lock);\r\nreturn err;\r\n}\r\nint enic_dev_set_ig_vlan_rewrite_mode(struct enic *enic)\r\n{\r\nint err;\r\nspin_lock(&enic->devcmd_lock);\r\nerr = vnic_dev_set_ig_vlan_rewrite_mode(enic->vdev,\r\nIG_VLAN_REWRITE_MODE_PRIORITY_TAG_DEFAULT_VLAN);\r\nspin_unlock(&enic->devcmd_lock);\r\nreturn err;\r\n}\r\nint enic_dev_enable(struct enic *enic)\r\n{\r\nint err;\r\nspin_lock(&enic->devcmd_lock);\r\nerr = vnic_dev_enable_wait(enic->vdev);\r\nspin_unlock(&enic->devcmd_lock);\r\nreturn err;\r\n}\r\nint enic_dev_disable(struct enic *enic)\r\n{\r\nint err;\r\nspin_lock(&enic->devcmd_lock);\r\nerr = vnic_dev_disable(enic->vdev);\r\nspin_unlock(&enic->devcmd_lock);\r\nreturn err;\r\n}\r\nint enic_dev_intr_coal_timer_info(struct enic *enic)\r\n{\r\nint err;\r\nspin_lock(&enic->devcmd_lock);\r\nerr = vnic_dev_intr_coal_timer_info(enic->vdev);\r\nspin_unlock(&enic->devcmd_lock);\r\nreturn err;\r\n}\r\nint enic_vnic_dev_deinit(struct enic *enic)\r\n{\r\nint err;\r\nspin_lock(&enic->devcmd_lock);\r\nerr = vnic_dev_deinit(enic->vdev);\r\nspin_unlock(&enic->devcmd_lock);\r\nreturn err;\r\n}\r\nint enic_dev_init_prov2(struct enic *enic, struct vic_provinfo *vp)\r\n{\r\nint err;\r\nspin_lock(&enic->devcmd_lock);\r\nerr = vnic_dev_init_prov2(enic->vdev,\r\n(u8 *)vp, vic_provinfo_size(vp));\r\nspin_unlock(&enic->devcmd_lock);\r\nreturn err;\r\n}\r\nint enic_dev_deinit_done(struct enic *enic, int *status)\r\n{\r\nint err;\r\nspin_lock(&enic->devcmd_lock);\r\nerr = vnic_dev_deinit_done(enic->vdev, status);\r\nspin_unlock(&enic->devcmd_lock);\r\nreturn err;\r\n}\r\nint enic_vlan_rx_add_vid(struct net_device *netdev, u16 vid)\r\n{\r\nstruct enic *enic = netdev_priv(netdev);\r\nint err;\r\nspin_lock(&enic->devcmd_lock);\r\nerr = enic_add_vlan(enic, vid);\r\nspin_unlock(&enic->devcmd_lock);\r\nreturn err;\r\n}\r\nint enic_vlan_rx_kill_vid(struct net_device *netdev, u16 vid)\r\n{\r\nstruct enic *enic = netdev_priv(netdev);\r\nint err;\r\nspin_lock(&enic->devcmd_lock);\r\nerr = enic_del_vlan(enic, vid);\r\nspin_unlock(&enic->devcmd_lock);\r\nreturn err;\r\n}\r\nint enic_dev_enable2(struct enic *enic, int active)\r\n{\r\nint err;\r\nspin_lock(&enic->devcmd_lock);\r\nerr = vnic_dev_enable2(enic->vdev, active);\r\nspin_unlock(&enic->devcmd_lock);\r\nreturn err;\r\n}\r\nint enic_dev_enable2_done(struct enic *enic, int *status)\r\n{\r\nint err;\r\nspin_lock(&enic->devcmd_lock);\r\nerr = vnic_dev_enable2_done(enic->vdev, status);\r\nspin_unlock(&enic->devcmd_lock);\r\nreturn err;\r\n}\r\nint enic_dev_status_to_errno(int devcmd_status)\r\n{\r\nswitch (devcmd_status) {\r\ncase ERR_SUCCESS:\r\nreturn 0;\r\ncase ERR_EINVAL:\r\nreturn -EINVAL;\r\ncase ERR_EFAULT:\r\nreturn -EFAULT;\r\ncase ERR_EPERM:\r\nreturn -EPERM;\r\ncase ERR_EBUSY:\r\nreturn -EBUSY;\r\ncase ERR_ECMDUNKNOWN:\r\ncase ERR_ENOTSUPPORTED:\r\nreturn -EOPNOTSUPP;\r\ncase ERR_EBADSTATE:\r\nreturn -EINVAL;\r\ncase ERR_ENOMEM:\r\nreturn -ENOMEM;\r\ncase ERR_ETIMEDOUT:\r\nreturn -ETIMEDOUT;\r\ncase ERR_ELINKDOWN:\r\nreturn -ENETDOWN;\r\ncase ERR_EINPROGRESS:\r\nreturn -EINPROGRESS;\r\ncase ERR_EMAXRES:\r\ndefault:\r\nreturn (devcmd_status < 0) ? devcmd_status : -1;\r\n}\r\n}
