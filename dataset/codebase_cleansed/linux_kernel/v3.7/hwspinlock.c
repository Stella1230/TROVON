static int __init hwspinlocks_init(void)\r\n{\r\nint retval = 0;\r\nstruct omap_hwmod *oh;\r\nstruct platform_device *pdev;\r\nconst char *oh_name = "spinlock";\r\nconst char *dev_name = "omap_hwspinlock";\r\noh = omap_hwmod_lookup(oh_name);\r\nif (oh == NULL)\r\nreturn -EINVAL;\r\npdev = omap_device_build(dev_name, 0, oh, &omap_hwspinlock_pdata,\r\nsizeof(struct hwspinlock_pdata),\r\nNULL, 0, false);\r\nif (IS_ERR(pdev)) {\r\npr_err("Can't build omap_device for %s:%s\n", dev_name,\r\noh_name);\r\nretval = PTR_ERR(pdev);\r\n}\r\nreturn retval;\r\n}
