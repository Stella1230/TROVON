static int zero_ctr(struct dm_target *ti, unsigned int argc, char **argv)\r\n{\r\nif (argc != 0) {\r\nti->error = "No arguments required";\r\nreturn -EINVAL;\r\n}\r\nti->num_discard_requests = 1;\r\nreturn 0;\r\n}\r\nstatic int zero_map(struct dm_target *ti, struct bio *bio,\r\nunion map_info *map_context)\r\n{\r\nswitch(bio_rw(bio)) {\r\ncase READ:\r\nzero_fill_bio(bio);\r\nbreak;\r\ncase READA:\r\nreturn -EIO;\r\ncase WRITE:\r\nbreak;\r\n}\r\nbio_endio(bio, 0);\r\nreturn DM_MAPIO_SUBMITTED;\r\n}\r\nstatic int __init dm_zero_init(void)\r\n{\r\nint r = dm_register_target(&zero_target);\r\nif (r < 0)\r\nDMERR("register failed %d", r);\r\nreturn r;\r\n}\r\nstatic void __exit dm_zero_exit(void)\r\n{\r\ndm_unregister_target(&zero_target);\r\n}
