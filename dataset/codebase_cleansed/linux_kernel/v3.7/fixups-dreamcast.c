static void __devinit gapspci_fixup_resources(struct pci_dev *dev)\r\n{\r\nstruct pci_channel *p = dev->sysdata;\r\nprintk(KERN_NOTICE "PCI: Fixing up device %s\n", pci_name(dev));\r\nswitch (dev->device) {\r\ncase PCI_DEVICE_ID_SEGA_BBA:\r\ndev->resource[1].start = p->resources[0].start + 0x100;\r\ndev->resource[1].end = dev->resource[1].start + 0x200 - 1;\r\ndev->resource[1].flags |= IORESOURCE_PCI_FIXED;\r\nBUG_ON(!dma_declare_coherent_memory(&dev->dev,\r\nGAPSPCI_DMA_BASE,\r\nGAPSPCI_DMA_BASE,\r\nGAPSPCI_DMA_SIZE,\r\nDMA_MEMORY_MAP |\r\nDMA_MEMORY_EXCLUSIVE));\r\nbreak;\r\ndefault:\r\nprintk("PCI: Failed resource fixup\n");\r\n}\r\n}\r\nint __init pcibios_map_platform_irq(const struct pci_dev *dev, u8 slot, u8 pin)\r\n{\r\nreturn GAPSPCI_IRQ;\r\n}
