static int write_reg(struct i2c_client *client, int reg, int value)\r\n{\r\ni2c_smbus_write_word_data(client, reg, swab16(value));\r\nreturn 0;\r\n}\r\nstatic int wis_uda1342_command(struct i2c_client *client,\r\nunsigned int cmd, void *arg)\r\n{\r\nswitch (cmd) {\r\ncase VIDIOC_S_AUDIO:\r\n{\r\nint *inp = arg;\r\nswitch (*inp) {\r\ncase TVAUDIO_INPUT_TUNER:\r\nwrite_reg(client, 0x00, 0x1441);\r\nbreak;\r\ncase TVAUDIO_INPUT_EXTERN:\r\nwrite_reg(client, 0x00, 0x1241);\r\nbreak;\r\ndefault:\r\nprintk(KERN_ERR "wis-uda1342: input %d not supported\n",\r\n*inp);\r\nbreak;\r\n}\r\nbreak;\r\n}\r\ndefault:\r\nbreak;\r\n}\r\nreturn 0;\r\n}\r\nstatic int wis_uda1342_probe(struct i2c_client *client,\r\nconst struct i2c_device_id *id)\r\n{\r\nstruct i2c_adapter *adapter = client->adapter;\r\nif (!i2c_check_functionality(adapter, I2C_FUNC_SMBUS_WORD_DATA))\r\nreturn -ENODEV;\r\nprintk(KERN_DEBUG\r\n"wis-uda1342: initializing UDA1342 at address %d on %s\n",\r\nclient->addr, adapter->name);\r\nwrite_reg(client, 0x00, 0x8000);\r\nwrite_reg(client, 0x00, 0x1241);\r\nreturn 0;\r\n}\r\nstatic int wis_uda1342_remove(struct i2c_client *client)\r\n{\r\nreturn 0;\r\n}\r\nstatic int __init wis_uda1342_init(void)\r\n{\r\nreturn i2c_add_driver(&wis_uda1342_driver);\r\n}\r\nstatic void __exit wis_uda1342_cleanup(void)\r\n{\r\ni2c_del_driver(&wis_uda1342_driver);\r\n}
