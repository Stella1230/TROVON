static int ar9002_hw_set_channel(struct ath_hw *ah, struct ath9k_channel *chan)\r\n{\r\nu16 bMode, fracMode, aModeRefSel = 0;\r\nu32 freq, ndiv, channelSel = 0, channelFrac = 0, reg32 = 0;\r\nstruct chan_centers centers;\r\nu32 refDivA = 24;\r\nath9k_hw_get_channel_centers(ah, chan, &centers);\r\nfreq = centers.synth_center;\r\nreg32 = REG_READ(ah, AR_PHY_SYNTH_CONTROL);\r\nreg32 &= 0xc0000000;\r\nif (freq < 4800) {\r\nu32 txctl;\r\nint regWrites = 0;\r\nbMode = 1;\r\nfracMode = 1;\r\naModeRefSel = 0;\r\nchannelSel = CHANSEL_2G(freq);\r\nif (AR_SREV_9287_11_OR_LATER(ah)) {\r\nif (freq == 2484) {\r\nREG_WRITE_ARRAY(&ah->iniCckfirJapan2484,\r\n1, regWrites);\r\n} else {\r\nREG_WRITE_ARRAY(&ah->iniCckfirNormal,\r\n1, regWrites);\r\n}\r\n} else {\r\ntxctl = REG_READ(ah, AR_PHY_CCK_TX_CTRL);\r\nif (freq == 2484) {\r\nREG_WRITE(ah, AR_PHY_CCK_TX_CTRL,\r\ntxctl | AR_PHY_CCK_TX_CTRL_JAPAN);\r\n} else {\r\nREG_WRITE(ah, AR_PHY_CCK_TX_CTRL,\r\ntxctl & ~AR_PHY_CCK_TX_CTRL_JAPAN);\r\n}\r\n}\r\n} else {\r\nbMode = 0;\r\nfracMode = 0;\r\nswitch (ah->eep_ops->get_eeprom(ah, EEP_FRAC_N_5G)) {\r\ncase 0:\r\nif (IS_CHAN_HALF_RATE(chan) || IS_CHAN_QUARTER_RATE(chan))\r\naModeRefSel = 0;\r\nelse if ((freq % 20) == 0)\r\naModeRefSel = 3;\r\nelse if ((freq % 10) == 0)\r\naModeRefSel = 2;\r\nif (aModeRefSel)\r\nbreak;\r\ncase 1:\r\ndefault:\r\naModeRefSel = 0;\r\nfracMode = 1;\r\nrefDivA = 1;\r\nchannelSel = CHANSEL_5G(freq);\r\nath9k_hw_analog_shift_rmw(ah, AR_AN_SYNTH9,\r\nAR_AN_SYNTH9_REFDIVA,\r\nAR_AN_SYNTH9_REFDIVA_S, refDivA);\r\n}\r\nif (!fracMode) {\r\nndiv = (freq * (refDivA >> aModeRefSel)) / 60;\r\nchannelSel = ndiv & 0x1ff;\r\nchannelFrac = (ndiv & 0xfffffe00) * 2;\r\nchannelSel = (channelSel << 17) | channelFrac;\r\n}\r\n}\r\nreg32 = reg32 |\r\n(bMode << 29) |\r\n(fracMode << 28) | (aModeRefSel << 26) | (channelSel);\r\nREG_WRITE(ah, AR_PHY_SYNTH_CONTROL, reg32);\r\nah->curchan = chan;\r\nreturn 0;\r\n}\r\nstatic void ar9002_hw_spur_mitigate(struct ath_hw *ah,\r\nstruct ath9k_channel *chan)\r\n{\r\nint bb_spur = AR_NO_SPUR;\r\nint freq;\r\nint bin, cur_bin;\r\nint bb_spur_off, spur_subchannel_sd;\r\nint spur_freq_sd;\r\nint spur_delta_phase;\r\nint denominator;\r\nint upper, lower, cur_vit_mask;\r\nint tmp, newVal;\r\nint i;\r\nstatic const int pilot_mask_reg[4] = {\r\nAR_PHY_TIMING7, AR_PHY_TIMING8,\r\nAR_PHY_PILOT_MASK_01_30, AR_PHY_PILOT_MASK_31_60\r\n};\r\nstatic const int chan_mask_reg[4] = {\r\nAR_PHY_TIMING9, AR_PHY_TIMING10,\r\nAR_PHY_CHANNEL_MASK_01_30, AR_PHY_CHANNEL_MASK_31_60\r\n};\r\nstatic const int inc[4] = { 0, 100, 0, 0 };\r\nstruct chan_centers centers;\r\nint8_t mask_m[123];\r\nint8_t mask_p[123];\r\nint8_t mask_amt;\r\nint tmp_mask;\r\nint cur_bb_spur;\r\nbool is2GHz = IS_CHAN_2GHZ(chan);\r\nmemset(&mask_m, 0, sizeof(int8_t) * 123);\r\nmemset(&mask_p, 0, sizeof(int8_t) * 123);\r\nath9k_hw_get_channel_centers(ah, chan, &centers);\r\nfreq = centers.synth_center;\r\nah->config.spurmode = SPUR_ENABLE_EEPROM;\r\nfor (i = 0; i < AR_EEPROM_MODAL_SPURS; i++) {\r\ncur_bb_spur = ah->eep_ops->get_spur_channel(ah, i, is2GHz);\r\nif (AR_NO_SPUR == cur_bb_spur)\r\nbreak;\r\nif (is2GHz)\r\ncur_bb_spur = (cur_bb_spur / 10) + AR_BASE_FREQ_2GHZ;\r\nelse\r\ncur_bb_spur = (cur_bb_spur / 10) + AR_BASE_FREQ_5GHZ;\r\ncur_bb_spur = cur_bb_spur - freq;\r\nif (IS_CHAN_HT40(chan)) {\r\nif ((cur_bb_spur > -AR_SPUR_FEEQ_BOUND_HT40) &&\r\n(cur_bb_spur < AR_SPUR_FEEQ_BOUND_HT40)) {\r\nbb_spur = cur_bb_spur;\r\nbreak;\r\n}\r\n} else if ((cur_bb_spur > -AR_SPUR_FEEQ_BOUND_HT20) &&\r\n(cur_bb_spur < AR_SPUR_FEEQ_BOUND_HT20)) {\r\nbb_spur = cur_bb_spur;\r\nbreak;\r\n}\r\n}\r\nif (AR_NO_SPUR == bb_spur) {\r\nREG_CLR_BIT(ah, AR_PHY_FORCE_CLKEN_CCK,\r\nAR_PHY_FORCE_CLKEN_CCK_MRC_MUX);\r\nreturn;\r\n} else {\r\nREG_CLR_BIT(ah, AR_PHY_FORCE_CLKEN_CCK,\r\nAR_PHY_FORCE_CLKEN_CCK_MRC_MUX);\r\n}\r\nbin = bb_spur * 320;\r\ntmp = REG_READ(ah, AR_PHY_TIMING_CTRL4(0));\r\nENABLE_REGWRITE_BUFFER(ah);\r\nnewVal = tmp | (AR_PHY_TIMING_CTRL4_ENABLE_SPUR_RSSI |\r\nAR_PHY_TIMING_CTRL4_ENABLE_SPUR_FILTER |\r\nAR_PHY_TIMING_CTRL4_ENABLE_CHAN_MASK |\r\nAR_PHY_TIMING_CTRL4_ENABLE_PILOT_MASK);\r\nREG_WRITE(ah, AR_PHY_TIMING_CTRL4(0), newVal);\r\nnewVal = (AR_PHY_SPUR_REG_MASK_RATE_CNTL |\r\nAR_PHY_SPUR_REG_ENABLE_MASK_PPM |\r\nAR_PHY_SPUR_REG_MASK_RATE_SELECT |\r\nAR_PHY_SPUR_REG_ENABLE_VIT_SPUR_RSSI |\r\nSM(SPUR_RSSI_THRESH, AR_PHY_SPUR_REG_SPUR_RSSI_THRESH));\r\nREG_WRITE(ah, AR_PHY_SPUR_REG, newVal);\r\nif (IS_CHAN_HT40(chan)) {\r\nif (bb_spur < 0) {\r\nspur_subchannel_sd = 1;\r\nbb_spur_off = bb_spur + 10;\r\n} else {\r\nspur_subchannel_sd = 0;\r\nbb_spur_off = bb_spur - 10;\r\n}\r\n} else {\r\nspur_subchannel_sd = 0;\r\nbb_spur_off = bb_spur;\r\n}\r\nif (IS_CHAN_HT40(chan))\r\nspur_delta_phase =\r\n((bb_spur * 262144) /\r\n10) & AR_PHY_TIMING11_SPUR_DELTA_PHASE;\r\nelse\r\nspur_delta_phase =\r\n((bb_spur * 524288) /\r\n10) & AR_PHY_TIMING11_SPUR_DELTA_PHASE;\r\ndenominator = IS_CHAN_2GHZ(chan) ? 44 : 40;\r\nspur_freq_sd = ((bb_spur_off * 2048) / denominator) & 0x3ff;\r\nnewVal = (AR_PHY_TIMING11_USE_SPUR_IN_AGC |\r\nSM(spur_freq_sd, AR_PHY_TIMING11_SPUR_FREQ_SD) |\r\nSM(spur_delta_phase, AR_PHY_TIMING11_SPUR_DELTA_PHASE));\r\nREG_WRITE(ah, AR_PHY_TIMING11, newVal);\r\nnewVal = spur_subchannel_sd << AR_PHY_SFCORR_SPUR_SUBCHNL_SD_S;\r\nREG_WRITE(ah, AR_PHY_SFCORR_EXT, newVal);\r\ncur_bin = -6000;\r\nupper = bin + 100;\r\nlower = bin - 100;\r\nfor (i = 0; i < 4; i++) {\r\nint pilot_mask = 0;\r\nint chan_mask = 0;\r\nint bp = 0;\r\nfor (bp = 0; bp < 30; bp++) {\r\nif ((cur_bin > lower) && (cur_bin < upper)) {\r\npilot_mask = pilot_mask | 0x1 << bp;\r\nchan_mask = chan_mask | 0x1 << bp;\r\n}\r\ncur_bin += 100;\r\n}\r\ncur_bin += inc[i];\r\nREG_WRITE(ah, pilot_mask_reg[i], pilot_mask);\r\nREG_WRITE(ah, chan_mask_reg[i], chan_mask);\r\n}\r\ncur_vit_mask = 6100;\r\nupper = bin + 120;\r\nlower = bin - 120;\r\nfor (i = 0; i < 123; i++) {\r\nif ((cur_vit_mask > lower) && (cur_vit_mask < upper)) {\r\nvolatile int tmp_v = abs(cur_vit_mask - bin);\r\nif (tmp_v < 75)\r\nmask_amt = 1;\r\nelse\r\nmask_amt = 0;\r\nif (cur_vit_mask < 0)\r\nmask_m[abs(cur_vit_mask / 100)] = mask_amt;\r\nelse\r\nmask_p[cur_vit_mask / 100] = mask_amt;\r\n}\r\ncur_vit_mask -= 100;\r\n}\r\ntmp_mask = (mask_m[46] << 30) | (mask_m[47] << 28)\r\n| (mask_m[48] << 26) | (mask_m[49] << 24)\r\n| (mask_m[50] << 22) | (mask_m[51] << 20)\r\n| (mask_m[52] << 18) | (mask_m[53] << 16)\r\n| (mask_m[54] << 14) | (mask_m[55] << 12)\r\n| (mask_m[56] << 10) | (mask_m[57] << 8)\r\n| (mask_m[58] << 6) | (mask_m[59] << 4)\r\n| (mask_m[60] << 2) | (mask_m[61] << 0);\r\nREG_WRITE(ah, AR_PHY_BIN_MASK_1, tmp_mask);\r\nREG_WRITE(ah, AR_PHY_VIT_MASK2_M_46_61, tmp_mask);\r\ntmp_mask = (mask_m[31] << 28)\r\n| (mask_m[32] << 26) | (mask_m[33] << 24)\r\n| (mask_m[34] << 22) | (mask_m[35] << 20)\r\n| (mask_m[36] << 18) | (mask_m[37] << 16)\r\n| (mask_m[48] << 14) | (mask_m[39] << 12)\r\n| (mask_m[40] << 10) | (mask_m[41] << 8)\r\n| (mask_m[42] << 6) | (mask_m[43] << 4)\r\n| (mask_m[44] << 2) | (mask_m[45] << 0);\r\nREG_WRITE(ah, AR_PHY_BIN_MASK_2, tmp_mask);\r\nREG_WRITE(ah, AR_PHY_MASK2_M_31_45, tmp_mask);\r\ntmp_mask = (mask_m[16] << 30) | (mask_m[16] << 28)\r\n| (mask_m[18] << 26) | (mask_m[18] << 24)\r\n| (mask_m[20] << 22) | (mask_m[20] << 20)\r\n| (mask_m[22] << 18) | (mask_m[22] << 16)\r\n| (mask_m[24] << 14) | (mask_m[24] << 12)\r\n| (mask_m[25] << 10) | (mask_m[26] << 8)\r\n| (mask_m[27] << 6) | (mask_m[28] << 4)\r\n| (mask_m[29] << 2) | (mask_m[30] << 0);\r\nREG_WRITE(ah, AR_PHY_BIN_MASK_3, tmp_mask);\r\nREG_WRITE(ah, AR_PHY_MASK2_M_16_30, tmp_mask);\r\ntmp_mask = (mask_m[0] << 30) | (mask_m[1] << 28)\r\n| (mask_m[2] << 26) | (mask_m[3] << 24)\r\n| (mask_m[4] << 22) | (mask_m[5] << 20)\r\n| (mask_m[6] << 18) | (mask_m[7] << 16)\r\n| (mask_m[8] << 14) | (mask_m[9] << 12)\r\n| (mask_m[10] << 10) | (mask_m[11] << 8)\r\n| (mask_m[12] << 6) | (mask_m[13] << 4)\r\n| (mask_m[14] << 2) | (mask_m[15] << 0);\r\nREG_WRITE(ah, AR_PHY_MASK_CTL, tmp_mask);\r\nREG_WRITE(ah, AR_PHY_MASK2_M_00_15, tmp_mask);\r\ntmp_mask = (mask_p[15] << 28)\r\n| (mask_p[14] << 26) | (mask_p[13] << 24)\r\n| (mask_p[12] << 22) | (mask_p[11] << 20)\r\n| (mask_p[10] << 18) | (mask_p[9] << 16)\r\n| (mask_p[8] << 14) | (mask_p[7] << 12)\r\n| (mask_p[6] << 10) | (mask_p[5] << 8)\r\n| (mask_p[4] << 6) | (mask_p[3] << 4)\r\n| (mask_p[2] << 2) | (mask_p[1] << 0);\r\nREG_WRITE(ah, AR_PHY_BIN_MASK2_1, tmp_mask);\r\nREG_WRITE(ah, AR_PHY_MASK2_P_15_01, tmp_mask);\r\ntmp_mask = (mask_p[30] << 28)\r\n| (mask_p[29] << 26) | (mask_p[28] << 24)\r\n| (mask_p[27] << 22) | (mask_p[26] << 20)\r\n| (mask_p[25] << 18) | (mask_p[24] << 16)\r\n| (mask_p[23] << 14) | (mask_p[22] << 12)\r\n| (mask_p[21] << 10) | (mask_p[20] << 8)\r\n| (mask_p[19] << 6) | (mask_p[18] << 4)\r\n| (mask_p[17] << 2) | (mask_p[16] << 0);\r\nREG_WRITE(ah, AR_PHY_BIN_MASK2_2, tmp_mask);\r\nREG_WRITE(ah, AR_PHY_MASK2_P_30_16, tmp_mask);\r\ntmp_mask = (mask_p[45] << 28)\r\n| (mask_p[44] << 26) | (mask_p[43] << 24)\r\n| (mask_p[42] << 22) | (mask_p[41] << 20)\r\n| (mask_p[40] << 18) | (mask_p[39] << 16)\r\n| (mask_p[38] << 14) | (mask_p[37] << 12)\r\n| (mask_p[36] << 10) | (mask_p[35] << 8)\r\n| (mask_p[34] << 6) | (mask_p[33] << 4)\r\n| (mask_p[32] << 2) | (mask_p[31] << 0);\r\nREG_WRITE(ah, AR_PHY_BIN_MASK2_3, tmp_mask);\r\nREG_WRITE(ah, AR_PHY_MASK2_P_45_31, tmp_mask);\r\ntmp_mask = (mask_p[61] << 30) | (mask_p[60] << 28)\r\n| (mask_p[59] << 26) | (mask_p[58] << 24)\r\n| (mask_p[57] << 22) | (mask_p[56] << 20)\r\n| (mask_p[55] << 18) | (mask_p[54] << 16)\r\n| (mask_p[53] << 14) | (mask_p[52] << 12)\r\n| (mask_p[51] << 10) | (mask_p[50] << 8)\r\n| (mask_p[49] << 6) | (mask_p[48] << 4)\r\n| (mask_p[47] << 2) | (mask_p[46] << 0);\r\nREG_WRITE(ah, AR_PHY_BIN_MASK2_4, tmp_mask);\r\nREG_WRITE(ah, AR_PHY_MASK2_P_61_45, tmp_mask);\r\nREGWRITE_BUFFER_FLUSH(ah);\r\n}\r\nstatic void ar9002_olc_init(struct ath_hw *ah)\r\n{\r\nu32 i;\r\nif (!OLC_FOR_AR9280_20_LATER)\r\nreturn;\r\nif (OLC_FOR_AR9287_10_LATER) {\r\nREG_SET_BIT(ah, AR_PHY_TX_PWRCTRL9,\r\nAR_PHY_TX_PWRCTRL9_RES_DC_REMOVAL);\r\nath9k_hw_analog_shift_rmw(ah, AR9287_AN_TXPC0,\r\nAR9287_AN_TXPC0_TXPCMODE,\r\nAR9287_AN_TXPC0_TXPCMODE_S,\r\nAR9287_AN_TXPC0_TXPCMODE_TEMPSENSE);\r\nudelay(100);\r\n} else {\r\nfor (i = 0; i < AR9280_TX_GAIN_TABLE_SIZE; i++)\r\nah->originalGain[i] =\r\nMS(REG_READ(ah, AR_PHY_TX_GAIN_TBL1 + i * 4),\r\nAR_PHY_TX_GAIN);\r\nah->PDADCdelta = 0;\r\n}\r\n}\r\nstatic u32 ar9002_hw_compute_pll_control(struct ath_hw *ah,\r\nstruct ath9k_channel *chan)\r\n{\r\nint ref_div = 5;\r\nint pll_div = 0x2c;\r\nu32 pll;\r\nif (chan && IS_CHAN_5GHZ(chan) && !IS_CHAN_A_FAST_CLOCK(ah, chan)) {\r\nif (AR_SREV_9280_20(ah)) {\r\nref_div = 10;\r\npll_div = 0x50;\r\n} else {\r\npll_div = 0x28;\r\n}\r\n}\r\npll = SM(ref_div, AR_RTC_9160_PLL_REFDIV);\r\npll |= SM(pll_div, AR_RTC_9160_PLL_DIV);\r\nif (chan && IS_CHAN_HALF_RATE(chan))\r\npll |= SM(0x1, AR_RTC_9160_PLL_CLKSEL);\r\nelse if (chan && IS_CHAN_QUARTER_RATE(chan))\r\npll |= SM(0x2, AR_RTC_9160_PLL_CLKSEL);\r\nreturn pll;\r\n}\r\nstatic void ar9002_hw_do_getnf(struct ath_hw *ah,\r\nint16_t nfarray[NUM_NF_READINGS])\r\n{\r\nint16_t nf;\r\nnf = MS(REG_READ(ah, AR_PHY_CCA), AR9280_PHY_MINCCA_PWR);\r\nnfarray[0] = sign_extend32(nf, 8);\r\nnf = MS(REG_READ(ah, AR_PHY_EXT_CCA), AR9280_PHY_EXT_MINCCA_PWR);\r\nif (IS_CHAN_HT40(ah->curchan))\r\nnfarray[3] = sign_extend32(nf, 8);\r\nif (AR_SREV_9285(ah) || AR_SREV_9271(ah))\r\nreturn;\r\nnf = MS(REG_READ(ah, AR_PHY_CH1_CCA), AR9280_PHY_CH1_MINCCA_PWR);\r\nnfarray[1] = sign_extend32(nf, 8);\r\nnf = MS(REG_READ(ah, AR_PHY_CH1_EXT_CCA), AR9280_PHY_CH1_EXT_MINCCA_PWR);\r\nif (IS_CHAN_HT40(ah->curchan))\r\nnfarray[4] = sign_extend32(nf, 8);\r\n}\r\nstatic void ar9002_hw_set_nf_limits(struct ath_hw *ah)\r\n{\r\nif (AR_SREV_9285(ah)) {\r\nah->nf_2g.max = AR_PHY_CCA_MAX_GOOD_VAL_9285_2GHZ;\r\nah->nf_2g.min = AR_PHY_CCA_MIN_GOOD_VAL_9285_2GHZ;\r\nah->nf_2g.nominal = AR_PHY_CCA_NOM_VAL_9285_2GHZ;\r\n} else if (AR_SREV_9287(ah)) {\r\nah->nf_2g.max = AR_PHY_CCA_MAX_GOOD_VAL_9287_2GHZ;\r\nah->nf_2g.min = AR_PHY_CCA_MIN_GOOD_VAL_9287_2GHZ;\r\nah->nf_2g.nominal = AR_PHY_CCA_NOM_VAL_9287_2GHZ;\r\n} else if (AR_SREV_9271(ah)) {\r\nah->nf_2g.max = AR_PHY_CCA_MAX_GOOD_VAL_9271_2GHZ;\r\nah->nf_2g.min = AR_PHY_CCA_MIN_GOOD_VAL_9271_2GHZ;\r\nah->nf_2g.nominal = AR_PHY_CCA_NOM_VAL_9271_2GHZ;\r\n} else {\r\nah->nf_2g.max = AR_PHY_CCA_MAX_GOOD_VAL_9280_2GHZ;\r\nah->nf_2g.min = AR_PHY_CCA_MIN_GOOD_VAL_9280_2GHZ;\r\nah->nf_2g.nominal = AR_PHY_CCA_NOM_VAL_9280_2GHZ;\r\nah->nf_5g.max = AR_PHY_CCA_MAX_GOOD_VAL_9280_5GHZ;\r\nah->nf_5g.min = AR_PHY_CCA_MIN_GOOD_VAL_9280_5GHZ;\r\nah->nf_5g.nominal = AR_PHY_CCA_NOM_VAL_9280_5GHZ;\r\n}\r\n}\r\nstatic void ar9002_hw_antdiv_comb_conf_get(struct ath_hw *ah,\r\nstruct ath_hw_antcomb_conf *antconf)\r\n{\r\nu32 regval;\r\nregval = REG_READ(ah, AR_PHY_MULTICHAIN_GAIN_CTL);\r\nantconf->main_lna_conf = (regval & AR_PHY_9285_ANT_DIV_MAIN_LNACONF) >>\r\nAR_PHY_9285_ANT_DIV_MAIN_LNACONF_S;\r\nantconf->alt_lna_conf = (regval & AR_PHY_9285_ANT_DIV_ALT_LNACONF) >>\r\nAR_PHY_9285_ANT_DIV_ALT_LNACONF_S;\r\nantconf->fast_div_bias = (regval & AR_PHY_9285_FAST_DIV_BIAS) >>\r\nAR_PHY_9285_FAST_DIV_BIAS_S;\r\nantconf->lna1_lna2_delta = -3;\r\nantconf->div_group = 0;\r\n}\r\nstatic void ar9002_hw_antdiv_comb_conf_set(struct ath_hw *ah,\r\nstruct ath_hw_antcomb_conf *antconf)\r\n{\r\nu32 regval;\r\nregval = REG_READ(ah, AR_PHY_MULTICHAIN_GAIN_CTL);\r\nregval &= ~(AR_PHY_9285_ANT_DIV_MAIN_LNACONF |\r\nAR_PHY_9285_ANT_DIV_ALT_LNACONF |\r\nAR_PHY_9285_FAST_DIV_BIAS);\r\nregval |= ((antconf->main_lna_conf << AR_PHY_9285_ANT_DIV_MAIN_LNACONF_S)\r\n& AR_PHY_9285_ANT_DIV_MAIN_LNACONF);\r\nregval |= ((antconf->alt_lna_conf << AR_PHY_9285_ANT_DIV_ALT_LNACONF_S)\r\n& AR_PHY_9285_ANT_DIV_ALT_LNACONF);\r\nregval |= ((antconf->fast_div_bias << AR_PHY_9285_FAST_DIV_BIAS_S)\r\n& AR_PHY_9285_FAST_DIV_BIAS);\r\nREG_WRITE(ah, AR_PHY_MULTICHAIN_GAIN_CTL, regval);\r\n}\r\nvoid ar9002_hw_attach_phy_ops(struct ath_hw *ah)\r\n{\r\nstruct ath_hw_private_ops *priv_ops = ath9k_hw_private_ops(ah);\r\nstruct ath_hw_ops *ops = ath9k_hw_ops(ah);\r\npriv_ops->set_rf_regs = NULL;\r\npriv_ops->rf_alloc_ext_banks = NULL;\r\npriv_ops->rf_free_ext_banks = NULL;\r\npriv_ops->rf_set_freq = ar9002_hw_set_channel;\r\npriv_ops->spur_mitigate_freq = ar9002_hw_spur_mitigate;\r\npriv_ops->olc_init = ar9002_olc_init;\r\npriv_ops->compute_pll_control = ar9002_hw_compute_pll_control;\r\npriv_ops->do_getnf = ar9002_hw_do_getnf;\r\nops->antdiv_comb_conf_get = ar9002_hw_antdiv_comb_conf_get;\r\nops->antdiv_comb_conf_set = ar9002_hw_antdiv_comb_conf_set;\r\nar9002_hw_set_nf_limits(ah);\r\n}
