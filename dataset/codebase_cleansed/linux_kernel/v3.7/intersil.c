unsigned long sun3_gettimeoffset(void)\r\n{\r\nreturn 1;\r\n}\r\nint sun3_hwclk(int set, struct rtc_time *t)\r\n{\r\nvolatile struct intersil_dt *todintersil;\r\nunsigned long flags;\r\ntodintersil = (struct intersil_dt *) &intersil_clock->counter;\r\nlocal_irq_save(flags);\r\nintersil_clock->cmd_reg = STOP_VAL;\r\nif(set) {\r\ntodintersil->csec = 0;\r\ntodintersil->hour = t->tm_hour;\r\ntodintersil->minute = t->tm_min;\r\ntodintersil->second = t->tm_sec;\r\ntodintersil->month = t->tm_mon;\r\ntodintersil->day = t->tm_mday;\r\ntodintersil->year = t->tm_year - 68;\r\ntodintersil->weekday = t->tm_wday;\r\n} else {\r\nt->tm_sec = todintersil->csec;\r\nt->tm_hour = todintersil->hour;\r\nt->tm_min = todintersil->minute;\r\nt->tm_sec = todintersil->second;\r\nt->tm_mon = todintersil->month;\r\nt->tm_mday = todintersil->day;\r\nt->tm_year = todintersil->year + 68;\r\nt->tm_wday = todintersil->weekday;\r\n}\r\nintersil_clock->cmd_reg = START_VAL;\r\nlocal_irq_restore(flags);\r\nreturn 0;\r\n}
