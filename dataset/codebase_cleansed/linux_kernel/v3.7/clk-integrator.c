static struct icst_vco cp_auxvco_get(void)\r\n{\r\nu32 val;\r\nstruct icst_vco vco;\r\nval = readl(CM_AUXOSC);\r\nvco.v = val & 0x1ff;\r\nvco.r = (val >> 9) & 0x7f;\r\nvco.s = (val >> 16) & 03;\r\nreturn vco;\r\n}\r\nstatic void cp_auxvco_set(struct icst_vco vco)\r\n{\r\nu32 val;\r\nval = readl(CM_AUXOSC) & ~0x7ffff;\r\nval |= vco.v | (vco.r << 9) | (vco.s << 16);\r\nwritel(0xa05f, CM_LOCK);\r\nwritel(val, CM_AUXOSC);\r\nwritel(0, CM_LOCK);\r\n}\r\nvoid __init integrator_clk_init(bool is_cp)\r\n{\r\nstruct clk *clk;\r\nclk = clk_register_fixed_rate(NULL, "apb_pclk", NULL, CLK_IS_ROOT, 0);\r\nclk_register_clkdev(clk, "apb_pclk", NULL);\r\nclk = clk_register_fixed_rate(NULL, "uartclk", NULL, CLK_IS_ROOT,\r\n14745600);\r\nclk_register_clkdev(clk, NULL, "uart0");\r\nclk_register_clkdev(clk, NULL, "uart1");\r\nif (is_cp)\r\nclk_register_clkdev(clk, NULL, "mmci");\r\nclk = clk_register_fixed_rate(NULL, "clk24mhz", NULL, CLK_IS_ROOT,\r\n24000000);\r\nclk_register_clkdev(clk, NULL, "kmi0");\r\nclk_register_clkdev(clk, NULL, "kmi1");\r\nif (!is_cp)\r\nclk_register_clkdev(clk, NULL, "ap_timer");\r\nif (!is_cp)\r\nreturn;\r\nclk = clk_register_fixed_rate(NULL, "clk1mhz", NULL, CLK_IS_ROOT,\r\n1000000);\r\nclk_register_clkdev(clk, NULL, "sp804");\r\nclk = icst_clk_register(NULL, &cp_icst_desc);\r\nclk_register_clkdev(clk, NULL, "clcd");\r\n}
