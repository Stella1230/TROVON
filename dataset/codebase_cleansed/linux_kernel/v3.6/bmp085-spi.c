static int __devinit bmp085_spi_probe(struct spi_device *client)\r\n{\r\nint err;\r\nstruct regmap *regmap;\r\nclient->bits_per_word = 8;\r\nerr = spi_setup(client);\r\nif (err < 0) {\r\ndev_err(&client->dev, "spi_setup failed!\n");\r\nreturn err;\r\n}\r\nregmap = devm_regmap_init_spi(client, &bmp085_regmap_config);\r\nif (IS_ERR(regmap)) {\r\nerr = PTR_ERR(regmap);\r\ndev_err(&client->dev, "Failed to init regmap: %d\n", err);\r\nreturn err;\r\n}\r\nreturn bmp085_probe(&client->dev, regmap);\r\n}\r\nstatic int bmp085_spi_remove(struct spi_device *client)\r\n{\r\nreturn bmp085_remove(&client->dev);\r\n}\r\nstatic int __init bmp085_spi_init(void)\r\n{\r\nreturn spi_register_driver(&bmp085_spi_driver);\r\n}\r\nstatic void __exit bmp085_spi_exit(void)\r\n{\r\nspi_unregister_driver(&bmp085_spi_driver);\r\n}
