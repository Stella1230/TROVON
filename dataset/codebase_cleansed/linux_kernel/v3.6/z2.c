static void __init z2_nor_init(void)\r\n{\r\nplatform_device_register(&z2_flash);\r\n}\r\nstatic inline void z2_nor_init(void) {}\r\nstatic void __init z2_pwm_init(void)\r\n{\r\nplatform_device_register(&z2_backlight_devices[0]);\r\nplatform_device_register(&z2_backlight_devices[1]);\r\n}\r\nstatic inline void z2_pwm_init(void) {}\r\nstatic void __init z2_lcd_init(void)\r\n{\r\npxa_set_fb_info(NULL, &z2_lcd_screen);\r\n}\r\nstatic inline void z2_lcd_init(void) {}\r\nstatic void __init z2_mmc_init(void)\r\n{\r\npxa_set_mci_info(&z2_mci_platform_data);\r\n}\r\nstatic inline void z2_mmc_init(void) {}\r\nstatic void __init z2_leds_init(void)\r\n{\r\nplatform_device_register(&z2_leds);\r\n}\r\nstatic inline void z2_leds_init(void) {}\r\nstatic void __init z2_mkp_init(void)\r\n{\r\npxa_set_keypad_info(&z2_keypad_platform_data);\r\n}\r\nstatic inline void z2_mkp_init(void) {}\r\nstatic void __init z2_keys_init(void)\r\n{\r\nplatform_device_register(&z2_pxa_keys);\r\n}\r\nstatic inline void z2_keys_init(void) {}\r\nstatic void __init z2_i2c_init(void)\r\n{\r\npxa_set_i2c_info(NULL);\r\ni2c_register_board_info(0, ARRAY_AND_SIZE(z2_i2c_board_info));\r\n}\r\nstatic inline void z2_i2c_init(void) {}\r\nstatic int z2_lbs_spi_setup(struct spi_device *spi)\r\n{\r\nint ret = 0;\r\nret = gpio_request(GPIO14_ZIPITZ2_WIFI_POWER, "WiFi Power");\r\nif (ret)\r\ngoto err;\r\nret = gpio_direction_output(GPIO14_ZIPITZ2_WIFI_POWER, 1);\r\nif (ret)\r\ngoto err2;\r\nmdelay(180);\r\nspi->bits_per_word = 16;\r\nspi->mode = SPI_MODE_2,\r\nspi_setup(spi);\r\nreturn 0;\r\nerr2:\r\ngpio_free(GPIO14_ZIPITZ2_WIFI_POWER);\r\nerr:\r\nreturn ret;\r\n}\r\nstatic int z2_lbs_spi_teardown(struct spi_device *spi)\r\n{\r\ngpio_set_value(GPIO14_ZIPITZ2_WIFI_POWER, 0);\r\ngpio_free(GPIO14_ZIPITZ2_WIFI_POWER);\r\nreturn 0;\r\n}\r\nstatic void __init z2_spi_init(void)\r\n{\r\npxa2xx_set_spi_info(1, &pxa_ssp1_master_info);\r\npxa2xx_set_spi_info(2, &pxa_ssp2_master_info);\r\nspi_register_board_info(spi_board_info, ARRAY_SIZE(spi_board_info));\r\n}\r\nstatic inline void z2_spi_init(void) {}\r\nstatic void __init z2_pmic_init(void)\r\n{\r\npxa27x_set_i2c_power_info(NULL);\r\ni2c_register_board_info(1, ARRAY_AND_SIZE(z2_pi2c_board_info));\r\n}\r\nstatic inline void z2_pmic_init(void) {}\r\nstatic void z2_power_off(void)\r\n{\r\nPSPR = 0x0;\r\nlocal_irq_disable();\r\npxa27x_set_pwrmode(PWRMODE_DEEPSLEEP);\r\npxa27x_cpu_pm_enter(PM_SUSPEND_MEM);\r\n}\r\nstatic void __init z2_init(void)\r\n{\r\npxa2xx_mfp_config(ARRAY_AND_SIZE(z2_pin_config));\r\npxa_set_ffuart_info(NULL);\r\npxa_set_btuart_info(NULL);\r\npxa_set_stuart_info(NULL);\r\nz2_lcd_init();\r\nz2_mmc_init();\r\nz2_mkp_init();\r\nz2_i2c_init();\r\nz2_spi_init();\r\nz2_nor_init();\r\nz2_pwm_init();\r\nz2_leds_init();\r\nz2_keys_init();\r\nz2_pmic_init();\r\npm_power_off = z2_power_off;\r\n}
