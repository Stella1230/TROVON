static int devkit8000_panel_enable_lcd(struct omap_dss_device *dssdev)\r\n{\r\nif (gpio_is_valid(dssdev->reset_gpio))\r\ngpio_set_value_cansleep(dssdev->reset_gpio, 1);\r\nreturn 0;\r\n}\r\nstatic void devkit8000_panel_disable_lcd(struct omap_dss_device *dssdev)\r\n{\r\nif (gpio_is_valid(dssdev->reset_gpio))\r\ngpio_set_value_cansleep(dssdev->reset_gpio, 0);\r\n}\r\nstatic int devkit8000_twl_gpio_setup(struct device *dev,\r\nunsigned gpio, unsigned ngpio)\r\n{\r\nint ret;\r\nmmc[0].gpio_cd = gpio + 0;\r\nomap_hsmmc_late_init(mmc);\r\ngpio_leds[2].gpio = gpio + TWL4030_GPIO_MAX + 1;\r\ndevkit8000_lcd_device.reset_gpio = gpio + TWL4030_GPIO_MAX + 0;\r\nret = gpio_request_one(devkit8000_lcd_device.reset_gpio,\r\nGPIOF_OUT_INIT_LOW, "LCD_PWREN");\r\nif (ret < 0) {\r\ndevkit8000_lcd_device.reset_gpio = -EINVAL;\r\nprintk(KERN_ERR "Failed to request GPIO for LCD_PWRN\n");\r\n}\r\ndvi_panel.power_down_gpio = gpio + 7;\r\nreturn 0;\r\n}\r\nstatic int __init devkit8000_i2c_init(void)\r\n{\r\nomap3_pmic_get_config(&devkit8000_twldata,\r\nTWL_COMMON_PDATA_USB | TWL_COMMON_PDATA_AUDIO,\r\nTWL_COMMON_REGULATOR_VDAC);\r\nomap3_pmic_init("tps65930", &devkit8000_twldata);\r\nomap_register_i2c_bus(3, 400, NULL, 0);\r\nreturn 0;\r\n}\r\nstatic void __init omap_dm9000_init(void)\r\n{\r\nunsigned char *eth_addr = omap_dm9000_platdata.dev_addr;\r\nstruct omap_die_id odi;\r\nint ret;\r\nret = gpio_request_one(OMAP_DM9000_GPIO_IRQ, GPIOF_IN, "dm9000 irq");\r\nif (ret < 0) {\r\nprintk(KERN_ERR "Failed to request GPIO%d for dm9000 IRQ\n",\r\nOMAP_DM9000_GPIO_IRQ);\r\nreturn;\r\n}\r\nomap_get_die_id(&odi);\r\neth_addr[0] = 0x02;\r\neth_addr[1] = odi.id_1 & 0xff;\r\neth_addr[2] = (odi.id_0 & 0xff000000) >> 24;\r\neth_addr[3] = (odi.id_0 & 0x00ff0000) >> 16;\r\neth_addr[4] = (odi.id_0 & 0x0000ff00) >> 8;\r\neth_addr[5] = (odi.id_0 & 0x000000ff);\r\n}\r\nstatic void __init devkit8000_init(void)\r\n{\r\nomap3_mux_init(board_mux, OMAP_PACKAGE_CUS);\r\nomap_serial_init();\r\nomap_sdrc_init(mt46h32m32lf6_sdrc_params,\r\nmt46h32m32lf6_sdrc_params);\r\nomap_dm9000_init();\r\nomap_hsmmc_init(mmc);\r\ndevkit8000_i2c_init();\r\nomap_dm9000_resources[2].start = gpio_to_irq(OMAP_DM9000_GPIO_IRQ);\r\nplatform_add_devices(devkit8000_devices,\r\nARRAY_SIZE(devkit8000_devices));\r\nomap_display_init(&devkit8000_dss_data);\r\nomap_ads7846_init(2, OMAP3_DEVKIT_TS_GPIO, 0, NULL);\r\nusb_musb_init(NULL);\r\nusbhs_init(&usbhs_bdata);\r\nomap_nand_flash_init(NAND_BUSWIDTH_16, devkit8000_nand_partitions,\r\nARRAY_SIZE(devkit8000_nand_partitions));\r\nomap_mux_init_signal("sdrc_cke0", OMAP_PIN_OUTPUT);\r\nomap_mux_init_signal("sdrc_cke1", OMAP_PIN_OUTPUT);\r\n}
