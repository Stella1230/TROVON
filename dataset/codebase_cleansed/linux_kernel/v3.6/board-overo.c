static void __init overo_ads7846_init(void)\r\n{\r\nomap_ads7846_init(1, OVERO_GPIO_PENDOWN, 0, NULL);\r\nplatform_device_register(&vads7846_device);\r\n}\r\nstatic inline void __init overo_ads7846_init(void) { return; }\r\nstatic void __init overo_init_smsc911x(void)\r\n{\r\ngpmc_smsc911x_init(&smsc911x_cfg);\r\ngpmc_smsc911x_init(&smsc911x2_cfg);\r\n}\r\nstatic inline void __init overo_init_smsc911x(void) { return; }\r\nstatic void __init overo_display_init(void)\r\n{\r\nif (gpio_request_array(overo_dss_gpios, ARRAY_SIZE(overo_dss_gpios))) {\r\nprintk(KERN_ERR "could not obtain DSS control GPIOs\n");\r\nreturn;\r\n}\r\ngpio_export(OVERO_GPIO_LCD_EN, 0);\r\ngpio_export(OVERO_GPIO_LCD_BL, 0);\r\n}\r\nstatic int overo_panel_enable_lcd(struct omap_dss_device *dssdev)\r\n{\r\nif (dvi_enabled) {\r\nprintk(KERN_ERR "cannot enable LCD, DVI is enabled\n");\r\nreturn -EINVAL;\r\n}\r\ngpio_set_value(OVERO_GPIO_LCD_EN, 1);\r\ngpio_set_value(OVERO_GPIO_LCD_BL, 1);\r\nlcd_enabled = 1;\r\nreturn 0;\r\n}\r\nstatic void overo_panel_disable_lcd(struct omap_dss_device *dssdev)\r\n{\r\ngpio_set_value(OVERO_GPIO_LCD_EN, 0);\r\ngpio_set_value(OVERO_GPIO_LCD_BL, 0);\r\nlcd_enabled = 0;\r\n}\r\nstatic void __init overo_init_led(void)\r\n{\r\nplatform_device_register(&gpio_leds_device);\r\n}\r\nstatic inline void __init overo_init_led(void) { return; }\r\nstatic void __init overo_init_keys(void)\r\n{\r\nplatform_device_register(&gpio_keys_device);\r\n}\r\nstatic inline void __init overo_init_keys(void) { return; }\r\nstatic int overo_twl_gpio_setup(struct device *dev,\r\nunsigned gpio, unsigned ngpio)\r\n{\r\n#if defined(CONFIG_LEDS_GPIO) || defined(CONFIG_LEDS_GPIO_MODULE)\r\ngpio_leds[2].gpio = gpio + TWL4030_GPIO_MAX + 1;\r\n#endif\r\nreturn 0;\r\n}\r\nstatic int __init overo_i2c_init(void)\r\n{\r\nomap3_pmic_get_config(&overo_twldata,\r\nTWL_COMMON_PDATA_USB | TWL_COMMON_PDATA_AUDIO,\r\nTWL_COMMON_REGULATOR_VDAC | TWL_COMMON_REGULATOR_VPLL2);\r\novero_twldata.vpll2->constraints.name = "VDVI";\r\nomap3_pmic_init("tps65950", &overo_twldata);\r\nomap_register_i2c_bus(3, 400, NULL, 0);\r\nreturn 0;\r\n}\r\nstatic int __init overo_spi_init(void)\r\n{\r\novero_ads7846_init();\r\nspi_register_board_info(overo_spi_board_info,\r\nARRAY_SIZE(overo_spi_board_info));\r\nreturn 0;\r\n}\r\nstatic void __init overo_init(void)\r\n{\r\nint ret;\r\nregulator_register_fixed(0, dummy_supplies, ARRAY_SIZE(dummy_supplies));\r\nomap3_mux_init(board_mux, OMAP_PACKAGE_CBB);\r\novero_i2c_init();\r\nomap_hsmmc_init(mmc);\r\nomap_display_init(&overo_dss_data);\r\nomap_serial_init();\r\nomap_sdrc_init(mt46h32m32lf6_sdrc_params,\r\nmt46h32m32lf6_sdrc_params);\r\nomap_nand_flash_init(0, overo_nand_partitions,\r\nARRAY_SIZE(overo_nand_partitions));\r\nusb_musb_init(NULL);\r\nusbhs_init(&usbhs_bdata);\r\novero_spi_init();\r\novero_init_smsc911x();\r\novero_display_init();\r\novero_init_led();\r\novero_init_keys();\r\nomap_mux_init_signal("sdrc_cke0", OMAP_PIN_OUTPUT);\r\nomap_mux_init_signal("sdrc_cke1", OMAP_PIN_OUTPUT);\r\nret = gpio_request_one(OVERO_GPIO_W2W_NRESET, GPIOF_OUT_INIT_HIGH,\r\n"OVERO_GPIO_W2W_NRESET");\r\nif (ret == 0) {\r\ngpio_export(OVERO_GPIO_W2W_NRESET, 0);\r\ngpio_set_value(OVERO_GPIO_W2W_NRESET, 0);\r\nudelay(10);\r\ngpio_set_value(OVERO_GPIO_W2W_NRESET, 1);\r\n} else {\r\nprintk(KERN_ERR "could not obtain gpio for "\r\n"OVERO_GPIO_W2W_NRESET\n");\r\n}\r\nret = gpio_request_array(overo_bt_gpios, ARRAY_SIZE(overo_bt_gpios));\r\nif (ret) {\r\npr_err("%s: could not obtain BT gpios\n", __func__);\r\n} else {\r\ngpio_export(OVERO_GPIO_BT_XGATE, 0);\r\ngpio_export(OVERO_GPIO_BT_NRESET, 0);\r\ngpio_set_value(OVERO_GPIO_BT_NRESET, 0);\r\nmdelay(6);\r\ngpio_set_value(OVERO_GPIO_BT_NRESET, 1);\r\n}\r\nret = gpio_request_one(OVERO_GPIO_USBH_CPEN, GPIOF_OUT_INIT_HIGH,\r\n"OVERO_GPIO_USBH_CPEN");\r\nif (ret == 0)\r\ngpio_export(OVERO_GPIO_USBH_CPEN, 0);\r\nelse\r\nprintk(KERN_ERR "could not obtain gpio for "\r\n"OVERO_GPIO_USBH_CPEN\n");\r\n}
