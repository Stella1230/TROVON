static inline void __init ldp_init_smsc911x(void)\r\n{\r\ngpmc_smsc911x_init(&smsc911x_cfg);\r\n}\r\nstatic int ldp_panel_enable_lcd(struct omap_dss_device *dssdev)\r\n{\r\nif (gpio_is_valid(ldp_lcd_enable_gpio))\r\ngpio_direction_output(ldp_lcd_enable_gpio, 1);\r\nif (gpio_is_valid(ldp_backlight_gpio))\r\ngpio_direction_output(ldp_backlight_gpio, 1);\r\nreturn 0;\r\n}\r\nstatic void ldp_panel_disable_lcd(struct omap_dss_device *dssdev)\r\n{\r\nif (gpio_is_valid(ldp_lcd_enable_gpio))\r\ngpio_direction_output(ldp_lcd_enable_gpio, 0);\r\nif (gpio_is_valid(ldp_backlight_gpio))\r\ngpio_direction_output(ldp_backlight_gpio, 0);\r\n}\r\nstatic void __init ldp_display_init(void)\r\n{\r\nint r;\r\nstatic struct gpio gpios[] __initdata = {\r\n{LCD_PANEL_RESET_GPIO, GPIOF_OUT_INIT_HIGH, "LCD RESET"},\r\n{LCD_PANEL_QVGA_GPIO, GPIOF_OUT_INIT_HIGH, "LCD QVGA"},\r\n};\r\nr = gpio_request_array(gpios, ARRAY_SIZE(gpios));\r\nif (r) {\r\npr_err("Cannot request LCD GPIOs, error %d\n", r);\r\nreturn;\r\n}\r\nomap_display_init(&ldp_dss_data);\r\n}\r\nstatic int ldp_twl_gpio_setup(struct device *dev, unsigned gpio, unsigned ngpio)\r\n{\r\nint r;\r\nstruct gpio gpios[] = {\r\n{gpio + 7 , GPIOF_OUT_INIT_LOW, "LCD ENABLE"},\r\n{gpio + 15, GPIOF_OUT_INIT_LOW, "LCD BACKLIGHT"},\r\n};\r\nr = gpio_request_array(gpios, ARRAY_SIZE(gpios));\r\nif (r) {\r\npr_err("Cannot request LCD GPIOs, error %d\n", r);\r\nldp_backlight_gpio = -EINVAL;\r\nldp_lcd_enable_gpio = -EINVAL;\r\nreturn r;\r\n}\r\nldp_backlight_gpio = gpio + 15;\r\nldp_lcd_enable_gpio = gpio + 7;\r\nreturn 0;\r\n}\r\nstatic int __init omap_i2c_init(void)\r\n{\r\nomap3_pmic_get_config(&ldp_twldata,\r\nTWL_COMMON_PDATA_USB | TWL_COMMON_PDATA_MADC, 0);\r\nomap3_pmic_init("twl4030", &ldp_twldata);\r\nomap_register_i2c_bus(2, 400, NULL, 0);\r\nomap_register_i2c_bus(3, 400, NULL, 0);\r\nreturn 0;\r\n}\r\nstatic void __init omap_ldp_init(void)\r\n{\r\nregulator_register_fixed(0, dummy_supplies, ARRAY_SIZE(dummy_supplies));\r\nomap3_mux_init(board_mux, OMAP_PACKAGE_CBB);\r\nldp_init_smsc911x();\r\nomap_i2c_init();\r\nplatform_add_devices(ldp_devices, ARRAY_SIZE(ldp_devices));\r\nomap_ads7846_init(1, 54, 310, NULL);\r\nomap_serial_init();\r\nomap_sdrc_init(NULL, NULL);\r\nusb_musb_init(NULL);\r\nboard_nand_init(ldp_nand_partitions,\r\nARRAY_SIZE(ldp_nand_partitions), ZOOM_NAND_CS, 0);\r\nomap_hsmmc_init(mmc);\r\nldp_display_init();\r\n}
