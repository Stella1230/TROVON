int edac_handler_set(void)\r\n{\r\nif (edac_op_state == EDAC_OPSTATE_POLL)\r\nreturn 0;\r\nreturn atomic_read(&edac_handlers);\r\n}\r\nvoid edac_atomic_assert_error(void)\r\n{\r\nedac_err_assert++;\r\n}\r\nstruct bus_type *edac_get_sysfs_subsys(void)\r\n{\r\nint err = 0;\r\nif (atomic_read(&edac_subsys_valid))\r\ngoto out;\r\nerr = subsys_system_register(&edac_subsys, NULL);\r\nif (err) {\r\nprintk(KERN_ERR "Error registering toplevel EDAC sysfs dir\n");\r\nreturn NULL;\r\n}\r\nout:\r\natomic_inc(&edac_subsys_valid);\r\nreturn &edac_subsys;\r\n}\r\nvoid edac_put_sysfs_subsys(void)\r\n{\r\nif (atomic_dec_and_test(&edac_subsys_valid))\r\nbus_unregister(&edac_subsys);\r\n}
