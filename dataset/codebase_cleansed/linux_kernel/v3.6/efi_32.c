void efi_call_phys_prelog(void)\r\n{\r\nstruct desc_ptr gdt_descr;\r\nlocal_irq_save(efi_rt_eflags);\r\nload_cr3(initial_page_table);\r\n__flush_tlb_all();\r\ngdt_descr.address = __pa(get_cpu_gdt_table(0));\r\ngdt_descr.size = GDT_SIZE - 1;\r\nload_gdt(&gdt_descr);\r\n}\r\nvoid efi_call_phys_epilog(void)\r\n{\r\nstruct desc_ptr gdt_descr;\r\ngdt_descr.address = (unsigned long)get_cpu_gdt_table(0);\r\ngdt_descr.size = GDT_SIZE - 1;\r\nload_gdt(&gdt_descr);\r\nload_cr3(swapper_pg_dir);\r\n__flush_tlb_all();\r\nlocal_irq_restore(efi_rt_eflags);\r\n}
