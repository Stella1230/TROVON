static void __init fsample_init_smc91x(void)\r\n{\r\nfpga_write(1, H2P2_DBG_FPGA_LAN_RESET);\r\nmdelay(50);\r\nfpga_write(fpga_read(H2P2_DBG_FPGA_LAN_RESET) & ~1,\r\nH2P2_DBG_FPGA_LAN_RESET);\r\nmdelay(50);\r\n}\r\nstatic int nand_dev_ready(struct mtd_info *mtd)\r\n{\r\nreturn gpio_get_value(FSAMPLE_NAND_RB_GPIO_PIN);\r\n}\r\nstatic void __init omap_fsample_init(void)\r\n{\r\nomap_writew(omap_readw(OMAP7XX_DSP_M_CTL) & ~1, OMAP7XX_DSP_M_CTL);\r\nomap_writel(0x0000fff3, OMAP7XX_FLASH_CFG_0);\r\nomap_writel(0x00000088, OMAP7XX_FLASH_ACFG_0);\r\nomap_writel(0x0000fff3, OMAP7XX_FLASH_CFG_1);\r\nomap_writel(0x00000000, OMAP7XX_FLASH_ACFG_1);\r\nomap_writel(omap_readl(OMAP7XX_IO_CONF_9) & 0x1FFFFFFF,\r\nOMAP7XX_IO_CONF_9);\r\nfsample_init_smc91x();\r\nif (gpio_request(FSAMPLE_NAND_RB_GPIO_PIN, "NAND ready") < 0)\r\nBUG();\r\ngpio_direction_input(FSAMPLE_NAND_RB_GPIO_PIN);\r\nomap_cfg_reg(L3_1610_FLASH_CS2B_OE);\r\nomap_cfg_reg(M8_1610_FLASH_CS2B_WE);\r\nomap_cfg_reg(E2_7XX_KBR0);\r\nomap_cfg_reg(J7_7XX_KBR1);\r\nomap_cfg_reg(E1_7XX_KBR2);\r\nomap_cfg_reg(F3_7XX_KBR3);\r\nomap_cfg_reg(D2_7XX_KBR4);\r\nomap_cfg_reg(C2_7XX_KBC0);\r\nomap_cfg_reg(D3_7XX_KBC1);\r\nomap_cfg_reg(E4_7XX_KBC2);\r\nomap_cfg_reg(F4_7XX_KBC3);\r\nomap_cfg_reg(E3_7XX_KBC4);\r\nplatform_add_devices(devices, ARRAY_SIZE(devices));\r\nomap_serial_init();\r\nomap_register_i2c_bus(1, 100, NULL, 0);\r\nomapfb_set_lcd_config(&fsample_lcd_config);\r\n}\r\nstatic void __init omap_fsample_map_io(void)\r\n{\r\nomap15xx_map_io();\r\niotable_init(omap_fsample_io_desc,\r\nARRAY_SIZE(omap_fsample_io_desc));\r\n}
