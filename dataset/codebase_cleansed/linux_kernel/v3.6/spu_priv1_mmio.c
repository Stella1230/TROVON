static void int_mask_and(struct spu *spu, int class, u64 mask)\r\n{\r\nu64 old_mask;\r\nold_mask = in_be64(&spu->priv1->int_mask_RW[class]);\r\nout_be64(&spu->priv1->int_mask_RW[class], old_mask & mask);\r\n}\r\nstatic void int_mask_or(struct spu *spu, int class, u64 mask)\r\n{\r\nu64 old_mask;\r\nold_mask = in_be64(&spu->priv1->int_mask_RW[class]);\r\nout_be64(&spu->priv1->int_mask_RW[class], old_mask | mask);\r\n}\r\nstatic void int_mask_set(struct spu *spu, int class, u64 mask)\r\n{\r\nout_be64(&spu->priv1->int_mask_RW[class], mask);\r\n}\r\nstatic u64 int_mask_get(struct spu *spu, int class)\r\n{\r\nreturn in_be64(&spu->priv1->int_mask_RW[class]);\r\n}\r\nstatic void int_stat_clear(struct spu *spu, int class, u64 stat)\r\n{\r\nout_be64(&spu->priv1->int_stat_RW[class], stat);\r\n}\r\nstatic u64 int_stat_get(struct spu *spu, int class)\r\n{\r\nreturn in_be64(&spu->priv1->int_stat_RW[class]);\r\n}\r\nstatic void cpu_affinity_set(struct spu *spu, int cpu)\r\n{\r\nu64 target;\r\nu64 route;\r\nif (nr_cpus_node(spu->node)) {\r\nconst struct cpumask *spumask = cpumask_of_node(spu->node),\r\n*cpumask = cpumask_of_node(cpu_to_node(cpu));\r\nif (!cpumask_intersects(spumask, cpumask))\r\nreturn;\r\n}\r\ntarget = iic_get_target_id(cpu);\r\nroute = target << 48 | target << 32 | target << 16;\r\nout_be64(&spu->priv1->int_route_RW, route);\r\n}\r\nstatic u64 mfc_dar_get(struct spu *spu)\r\n{\r\nreturn in_be64(&spu->priv1->mfc_dar_RW);\r\n}\r\nstatic u64 mfc_dsisr_get(struct spu *spu)\r\n{\r\nreturn in_be64(&spu->priv1->mfc_dsisr_RW);\r\n}\r\nstatic void mfc_dsisr_set(struct spu *spu, u64 dsisr)\r\n{\r\nout_be64(&spu->priv1->mfc_dsisr_RW, dsisr);\r\n}\r\nstatic void mfc_sdr_setup(struct spu *spu)\r\n{\r\nout_be64(&spu->priv1->mfc_sdr_RW, mfspr(SPRN_SDR1));\r\n}\r\nstatic void mfc_sr1_set(struct spu *spu, u64 sr1)\r\n{\r\nout_be64(&spu->priv1->mfc_sr1_RW, sr1);\r\n}\r\nstatic u64 mfc_sr1_get(struct spu *spu)\r\n{\r\nreturn in_be64(&spu->priv1->mfc_sr1_RW);\r\n}\r\nstatic void mfc_tclass_id_set(struct spu *spu, u64 tclass_id)\r\n{\r\nout_be64(&spu->priv1->mfc_tclass_id_RW, tclass_id);\r\n}\r\nstatic u64 mfc_tclass_id_get(struct spu *spu)\r\n{\r\nreturn in_be64(&spu->priv1->mfc_tclass_id_RW);\r\n}\r\nstatic void tlb_invalidate(struct spu *spu)\r\n{\r\nout_be64(&spu->priv1->tlb_invalidate_entry_W, 0ul);\r\n}\r\nstatic void resource_allocation_groupID_set(struct spu *spu, u64 id)\r\n{\r\nout_be64(&spu->priv1->resource_allocation_groupID_RW, id);\r\n}\r\nstatic u64 resource_allocation_groupID_get(struct spu *spu)\r\n{\r\nreturn in_be64(&spu->priv1->resource_allocation_groupID_RW);\r\n}\r\nstatic void resource_allocation_enable_set(struct spu *spu, u64 enable)\r\n{\r\nout_be64(&spu->priv1->resource_allocation_enable_RW, enable);\r\n}\r\nstatic u64 resource_allocation_enable_get(struct spu *spu)\r\n{\r\nreturn in_be64(&spu->priv1->resource_allocation_enable_RW);\r\n}
