static inline u32 tegra_pmc_readl(u32 reg)\r\n{\r\nreturn readl(IO_ADDRESS(TEGRA_PMC_BASE + reg));\r\n}\r\nstatic inline void tegra_pmc_writel(u32 val, u32 reg)\r\n{\r\nwritel(val, IO_ADDRESS(TEGRA_PMC_BASE + reg));\r\n}\r\nvoid __init tegra_pmc_init(void)\r\n{\r\nbool invert_interrupt = true;\r\nu32 val;\r\n#ifdef CONFIG_OF\r\nif (of_have_populated_dt()) {\r\nstruct device_node *np;\r\ninvert_interrupt = false;\r\nnp = of_find_matching_node(NULL, matches);\r\nif (np) {\r\nif (of_find_property(np, "nvidia,invert-interrupt",\r\nNULL))\r\ninvert_interrupt = true;\r\n}\r\n}\r\n#endif\r\nval = tegra_pmc_readl(PMC_CTRL);\r\nif (invert_interrupt)\r\nval |= PMC_CTRL_INTR_LOW;\r\nelse\r\nval &= ~PMC_CTRL_INTR_LOW;\r\ntegra_pmc_writel(val, PMC_CTRL);\r\n}
