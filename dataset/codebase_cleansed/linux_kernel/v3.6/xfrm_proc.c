static int xfrm_statistics_seq_show(struct seq_file *seq, void *v)\r\n{\r\nstruct net *net = seq->private;\r\nint i;\r\nfor (i=0; xfrm_mib_list[i].name; i++)\r\nseq_printf(seq, "%-24s\t%lu\n", xfrm_mib_list[i].name,\r\nsnmp_fold_field((void __percpu **)\r\nnet->mib.xfrm_statistics,\r\nxfrm_mib_list[i].entry));\r\nreturn 0;\r\n}\r\nstatic int xfrm_statistics_seq_open(struct inode *inode, struct file *file)\r\n{\r\nreturn single_open_net(inode, file, xfrm_statistics_seq_show);\r\n}\r\nint __net_init xfrm_proc_init(struct net *net)\r\n{\r\nif (!proc_net_fops_create(net, "xfrm_stat", S_IRUGO,\r\n&xfrm_statistics_seq_fops))\r\nreturn -ENOMEM;\r\nreturn 0;\r\n}\r\nvoid xfrm_proc_fini(struct net *net)\r\n{\r\nproc_net_remove(net, "xfrm_stat");\r\n}
