static __init int sysfb_init(void)\r\n{\r\nstruct screen_info *si = &screen_info;\r\nstruct simplefb_platform_data mode;\r\nstruct platform_device *pd;\r\nconst char *name;\r\nbool compatible;\r\nint ret;\r\nsysfb_apply_efi_quirks();\r\ncompatible = parse_mode(si, &mode);\r\nif (compatible) {\r\nret = create_simplefb(si, &mode);\r\nif (!ret)\r\nreturn 0;\r\n}\r\nif (si->orig_video_isVGA == VIDEO_TYPE_EFI)\r\nname = "efi-framebuffer";\r\nelse if (si->orig_video_isVGA == VIDEO_TYPE_VLFB)\r\nname = "vesa-framebuffer";\r\nelse\r\nname = "platform-framebuffer";\r\npd = platform_device_register_resndata(NULL, name, 0,\r\nNULL, 0, si, sizeof(*si));\r\nreturn IS_ERR(pd) ? PTR_ERR(pd) : 0;\r\n}
