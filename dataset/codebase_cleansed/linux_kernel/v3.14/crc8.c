void crc8_populate_msb(u8 table[CRC8_TABLE_SIZE], u8 polynomial)\r\n{\r\nint i, j;\r\nconst u8 msbit = 0x80;\r\nu8 t = msbit;\r\ntable[0] = 0;\r\nfor (i = 1; i < CRC8_TABLE_SIZE; i *= 2) {\r\nt = (t << 1) ^ (t & msbit ? polynomial : 0);\r\nfor (j = 0; j < i; j++)\r\ntable[i+j] = table[j] ^ t;\r\n}\r\n}\r\nvoid crc8_populate_lsb(u8 table[CRC8_TABLE_SIZE], u8 polynomial)\r\n{\r\nint i, j;\r\nu8 t = 1;\r\ntable[0] = 0;\r\nfor (i = (CRC8_TABLE_SIZE >> 1); i; i >>= 1) {\r\nt = (t >> 1) ^ (t & 1 ? polynomial : 0);\r\nfor (j = 0; j < CRC8_TABLE_SIZE; j += 2*i)\r\ntable[i+j] = table[j] ^ t;\r\n}\r\n}\r\nu8 crc8(const u8 table[CRC8_TABLE_SIZE], u8 *pdata, size_t nbytes, u8 crc)\r\n{\r\nwhile (nbytes-- > 0)\r\ncrc = table[(crc ^ *pdata++) & 0xff];\r\nreturn crc;\r\n}
