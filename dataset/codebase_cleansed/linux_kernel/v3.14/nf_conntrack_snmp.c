static int snmp_conntrack_help(struct sk_buff *skb, unsigned int protoff,\r\nstruct nf_conn *ct, enum ip_conntrack_info ctinfo)\r\n{\r\ntypeof(nf_nat_snmp_hook) nf_nat_snmp;\r\nnf_conntrack_broadcast_help(skb, protoff, ct, ctinfo, timeout);\r\nnf_nat_snmp = rcu_dereference(nf_nat_snmp_hook);\r\nif (nf_nat_snmp && ct->status & IPS_NAT_MASK)\r\nreturn nf_nat_snmp(skb, protoff, ct, ctinfo);\r\nreturn NF_ACCEPT;\r\n}\r\nstatic int __init nf_conntrack_snmp_init(void)\r\n{\r\nexp_policy.timeout = timeout;\r\nreturn nf_conntrack_helper_register(&helper);\r\n}\r\nstatic void __exit nf_conntrack_snmp_fini(void)\r\n{\r\nnf_conntrack_helper_unregister(&helper);\r\n}
