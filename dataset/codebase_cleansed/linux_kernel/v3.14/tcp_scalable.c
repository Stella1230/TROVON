static void tcp_scalable_cong_avoid(struct sock *sk, u32 ack, u32 acked,\r\nu32 in_flight)\r\n{\r\nstruct tcp_sock *tp = tcp_sk(sk);\r\nif (!tcp_is_cwnd_limited(sk, in_flight))\r\nreturn;\r\nif (tp->snd_cwnd <= tp->snd_ssthresh)\r\ntcp_slow_start(tp, acked);\r\nelse\r\ntcp_cong_avoid_ai(tp, min(tp->snd_cwnd, TCP_SCALABLE_AI_CNT));\r\n}\r\nstatic u32 tcp_scalable_ssthresh(struct sock *sk)\r\n{\r\nconst struct tcp_sock *tp = tcp_sk(sk);\r\nreturn max(tp->snd_cwnd - (tp->snd_cwnd>>TCP_SCALABLE_MD_SCALE), 2U);\r\n}\r\nstatic int __init tcp_scalable_register(void)\r\n{\r\nreturn tcp_register_congestion_control(&tcp_scalable);\r\n}\r\nstatic void __exit tcp_scalable_unregister(void)\r\n{\r\ntcp_unregister_congestion_control(&tcp_scalable);\r\n}
