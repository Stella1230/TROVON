void BlinkTimerCallback(void *data)\r\n{\r\nstruct LED_871x *pLed = (struct LED_871x *)data;\r\nstruct adapter *padapter = pLed->padapter;\r\nif ((padapter->bSurpriseRemoved) || (padapter->bDriverStopped))\r\nreturn;\r\n_set_workitem(&(pLed->BlinkWorkItem));\r\n}\r\nvoid BlinkWorkItemCallback(struct work_struct *work)\r\n{\r\nstruct LED_871x *pLed = container_of(work, struct LED_871x, BlinkWorkItem);\r\nBlinkHandler(pLed);\r\n}\r\nvoid ResetLedStatus(struct LED_871x *pLed)\r\n{\r\npLed->CurrLedState = RTW_LED_OFF;\r\npLed->bLedOn = false;\r\npLed->bLedBlinkInProgress = false;\r\npLed->bLedWPSBlinkInProgress = false;\r\npLed->BlinkTimes = 0;\r\npLed->BlinkingLedState = LED_UNKNOWN;\r\npLed->bLedNoLinkBlinkInProgress = false;\r\npLed->bLedLinkBlinkInProgress = false;\r\npLed->bLedStartToLinkBlinkInProgress = false;\r\npLed->bLedScanBlinkInProgress = false;\r\n}\r\nvoid InitLed871x(struct adapter *padapter, struct LED_871x *pLed, enum LED_PIN_871x LedPin)\r\n{\r\npLed->padapter = padapter;\r\npLed->LedPin = LedPin;\r\nResetLedStatus(pLed);\r\n_init_timer(&(pLed->BlinkTimer), padapter->pnetdev, BlinkTimerCallback, pLed);\r\n_init_workitem(&(pLed->BlinkWorkItem), BlinkWorkItemCallback, pLed);\r\n}\r\nvoid DeInitLed871x(struct LED_871x *pLed)\r\n{\r\n_cancel_workitem_sync(&(pLed->BlinkWorkItem));\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\nResetLedStatus(pLed);\r\n}\r\nstatic void SwLedBlink(struct LED_871x *pLed)\r\n{\r\nstruct adapter *padapter = pLed->padapter;\r\nstruct mlme_priv *pmlmepriv = &(padapter->mlmepriv);\r\nu8 bStopBlinking = false;\r\nif (pLed->BlinkingLedState == RTW_LED_ON) {\r\nSwLedOn(padapter, pLed);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("Blinktimes (%d): turn on\n", pLed->BlinkTimes));\r\n} else {\r\nSwLedOff(padapter, pLed);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("Blinktimes (%d): turn off\n", pLed->BlinkTimes));\r\n}\r\npLed->BlinkTimes--;\r\nswitch (pLed->CurrLedState) {\r\ncase LED_BLINK_NORMAL:\r\nif (pLed->BlinkTimes == 0)\r\nbStopBlinking = true;\r\nbreak;\r\ncase LED_BLINK_StartToBlink:\r\nif (check_fwstate(pmlmepriv, _FW_LINKED) && check_fwstate(pmlmepriv, WIFI_STATION_STATE))\r\nbStopBlinking = true;\r\nif (check_fwstate(pmlmepriv, _FW_LINKED) &&\r\n(check_fwstate(pmlmepriv, WIFI_ADHOC_STATE) ||\r\ncheck_fwstate(pmlmepriv, WIFI_ADHOC_MASTER_STATE)))\r\nbStopBlinking = true;\r\nelse if (pLed->BlinkTimes == 0)\r\nbStopBlinking = true;\r\nbreak;\r\ncase LED_BLINK_WPS:\r\nif (pLed->BlinkTimes == 0)\r\nbStopBlinking = true;\r\nbreak;\r\ndefault:\r\nbStopBlinking = true;\r\nbreak;\r\n}\r\nif (bStopBlinking) {\r\nif (0) {\r\nSwLedOff(padapter, pLed);\r\n} else if ((check_fwstate(pmlmepriv, _FW_LINKED)) && (!pLed->bLedOn)) {\r\nSwLedOn(padapter, pLed);\r\n} else if ((check_fwstate(pmlmepriv, _FW_LINKED)) && pLed->bLedOn) {\r\nSwLedOff(padapter, pLed);\r\n}\r\npLed->BlinkTimes = 0;\r\npLed->bLedBlinkInProgress = false;\r\n} else {\r\nif (pLed->BlinkingLedState == RTW_LED_ON)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\nswitch (pLed->CurrLedState) {\r\ncase LED_BLINK_NORMAL:\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_NORMAL_INTERVAL);\r\nbreak;\r\ncase LED_BLINK_SLOWLY:\r\ncase LED_BLINK_StartToBlink:\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_SLOWLY_INTERVAL);\r\nbreak;\r\ncase LED_BLINK_WPS:\r\nif (pLed->BlinkingLedState == RTW_LED_ON)\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_LONG_INTERVAL);\r\nelse\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_LONG_INTERVAL);\r\nbreak;\r\ndefault:\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_SLOWLY_INTERVAL);\r\nbreak;\r\n}\r\n}\r\n}\r\nstatic void SwLedBlink1(struct LED_871x *pLed)\r\n{\r\nstruct adapter *padapter = pLed->padapter;\r\nstruct mlme_priv *pmlmepriv = &(padapter->mlmepriv);\r\nu8 bStopBlinking = false;\r\nif (pLed->BlinkingLedState == RTW_LED_ON) {\r\nSwLedOn(padapter, pLed);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("Blinktimes (%d): turn on\n", pLed->BlinkTimes));\r\n} else {\r\nSwLedOff(padapter, pLed);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("Blinktimes (%d): turn off\n", pLed->BlinkTimes));\r\n}\r\nif (padapter->pwrctrlpriv.rf_pwrstate != rf_on) {\r\nSwLedOff(padapter, pLed);\r\nResetLedStatus(pLed);\r\nreturn;\r\n}\r\nswitch (pLed->CurrLedState) {\r\ncase LED_BLINK_SLOWLY:\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_NO_LINK_INTERVAL_ALPHA);\r\nbreak;\r\ncase LED_BLINK_NORMAL:\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_LINK_INTERVAL_ALPHA);\r\nbreak;\r\ncase LED_BLINK_SCAN:\r\npLed->BlinkTimes--;\r\nif (pLed->BlinkTimes == 0)\r\nbStopBlinking = true;\r\nif (bStopBlinking) {\r\nif (check_fwstate(pmlmepriv, _FW_LINKED)) {\r\npLed->bLedLinkBlinkInProgress = true;\r\npLed->CurrLedState = LED_BLINK_NORMAL;\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_LINK_INTERVAL_ALPHA);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("CurrLedState %d\n", pLed->CurrLedState));\r\n} else if (!check_fwstate(pmlmepriv, _FW_LINKED)) {\r\npLed->bLedNoLinkBlinkInProgress = true;\r\npLed->CurrLedState = LED_BLINK_SLOWLY;\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_NO_LINK_INTERVAL_ALPHA);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("CurrLedState %d\n", pLed->CurrLedState));\r\n}\r\npLed->bLedScanBlinkInProgress = false;\r\n} else {\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_SCAN_INTERVAL_ALPHA);\r\n}\r\nbreak;\r\ncase LED_BLINK_TXRX:\r\npLed->BlinkTimes--;\r\nif (pLed->BlinkTimes == 0)\r\nbStopBlinking = true;\r\nif (bStopBlinking) {\r\nif (check_fwstate(pmlmepriv, _FW_LINKED)) {\r\npLed->bLedLinkBlinkInProgress = true;\r\npLed->CurrLedState = LED_BLINK_NORMAL;\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_LINK_INTERVAL_ALPHA);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("CurrLedState %d\n", pLed->CurrLedState));\r\n} else if (!check_fwstate(pmlmepriv, _FW_LINKED)) {\r\npLed->bLedNoLinkBlinkInProgress = true;\r\npLed->CurrLedState = LED_BLINK_SLOWLY;\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_NO_LINK_INTERVAL_ALPHA);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("CurrLedState %d\n", pLed->CurrLedState));\r\n}\r\npLed->BlinkTimes = 0;\r\npLed->bLedBlinkInProgress = false;\r\n} else {\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_FASTER_INTERVAL_ALPHA);\r\n}\r\nbreak;\r\ncase LED_BLINK_WPS:\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_SCAN_INTERVAL_ALPHA);\r\nbreak;\r\ncase LED_BLINK_WPS_STOP:\r\nif (pLed->BlinkingLedState == RTW_LED_ON)\r\nbStopBlinking = false;\r\nelse\r\nbStopBlinking = true;\r\nif (bStopBlinking) {\r\npLed->bLedLinkBlinkInProgress = true;\r\npLed->CurrLedState = LED_BLINK_NORMAL;\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_LINK_INTERVAL_ALPHA);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("CurrLedState %d\n", pLed->CurrLedState));\r\npLed->bLedWPSBlinkInProgress = false;\r\n} else {\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_WPS_SUCESS_INTERVAL_ALPHA);\r\n}\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\nstatic void SwLedBlink2(struct LED_871x *pLed)\r\n{\r\nstruct adapter *padapter = pLed->padapter;\r\nstruct mlme_priv *pmlmepriv = &(padapter->mlmepriv);\r\nu8 bStopBlinking = false;\r\nif (pLed->BlinkingLedState == RTW_LED_ON) {\r\nSwLedOn(padapter, pLed);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("Blinktimes (%d): turn on\n", pLed->BlinkTimes));\r\n} else {\r\nSwLedOff(padapter, pLed);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("Blinktimes (%d): turn off\n", pLed->BlinkTimes));\r\n}\r\nswitch (pLed->CurrLedState) {\r\ncase LED_BLINK_SCAN:\r\npLed->BlinkTimes--;\r\nif (pLed->BlinkTimes == 0)\r\nbStopBlinking = true;\r\nif (bStopBlinking) {\r\nif (padapter->pwrctrlpriv.rf_pwrstate != rf_on) {\r\nSwLedOff(padapter, pLed);\r\n} else if (check_fwstate(pmlmepriv, _FW_LINKED)) {\r\npLed->CurrLedState = RTW_LED_ON;\r\npLed->BlinkingLedState = RTW_LED_ON;\r\nSwLedOn(padapter, pLed);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("stop scan blink CurrLedState %d\n", pLed->CurrLedState));\r\n} else if (!check_fwstate(pmlmepriv, _FW_LINKED)) {\r\npLed->CurrLedState = RTW_LED_OFF;\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nSwLedOff(padapter, pLed);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("stop scan blink CurrLedState %d\n", pLed->CurrLedState));\r\n}\r\npLed->bLedScanBlinkInProgress = false;\r\n} else {\r\nif (padapter->pwrctrlpriv.rf_pwrstate != rf_on) {\r\nSwLedOff(padapter, pLed);\r\n} else {\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_SCAN_INTERVAL_ALPHA);\r\n}\r\n}\r\nbreak;\r\ncase LED_BLINK_TXRX:\r\npLed->BlinkTimes--;\r\nif (pLed->BlinkTimes == 0)\r\nbStopBlinking = true;\r\nif (bStopBlinking) {\r\nif (padapter->pwrctrlpriv.rf_pwrstate != rf_on) {\r\nSwLedOff(padapter, pLed);\r\n} else if (check_fwstate(pmlmepriv, _FW_LINKED)) {\r\npLed->CurrLedState = RTW_LED_ON;\r\npLed->BlinkingLedState = RTW_LED_ON;\r\nSwLedOn(padapter, pLed);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("stop CurrLedState %d\n", pLed->CurrLedState));\r\n} else if (!check_fwstate(pmlmepriv, _FW_LINKED)) {\r\npLed->CurrLedState = RTW_LED_OFF;\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nSwLedOff(padapter, pLed);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("stop CurrLedState %d\n", pLed->CurrLedState));\r\n}\r\npLed->bLedBlinkInProgress = false;\r\n} else {\r\nif (padapter->pwrctrlpriv.rf_pwrstate != rf_on) {\r\nSwLedOff(padapter, pLed);\r\n} else {\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_FASTER_INTERVAL_ALPHA);\r\n}\r\n}\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\nstatic void SwLedBlink3(struct LED_871x *pLed)\r\n{\r\nstruct adapter *padapter = pLed->padapter;\r\nstruct mlme_priv *pmlmepriv = &(padapter->mlmepriv);\r\nu8 bStopBlinking = false;\r\nif (pLed->BlinkingLedState == RTW_LED_ON) {\r\nSwLedOn(padapter, pLed);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("Blinktimes (%d): turn on\n", pLed->BlinkTimes));\r\n} else {\r\nif (pLed->CurrLedState != LED_BLINK_WPS_STOP)\r\nSwLedOff(padapter, pLed);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("Blinktimes (%d): turn off\n", pLed->BlinkTimes));\r\n}\r\nswitch (pLed->CurrLedState) {\r\ncase LED_BLINK_SCAN:\r\npLed->BlinkTimes--;\r\nif (pLed->BlinkTimes == 0)\r\nbStopBlinking = true;\r\nif (bStopBlinking) {\r\nif (padapter->pwrctrlpriv.rf_pwrstate != rf_on) {\r\nSwLedOff(padapter, pLed);\r\n} else if (check_fwstate(pmlmepriv, _FW_LINKED)) {\r\npLed->CurrLedState = RTW_LED_ON;\r\npLed->BlinkingLedState = RTW_LED_ON;\r\nif (!pLed->bLedOn)\r\nSwLedOn(padapter, pLed);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("CurrLedState %d\n", pLed->CurrLedState));\r\n} else if (!check_fwstate(pmlmepriv, _FW_LINKED)) {\r\npLed->CurrLedState = RTW_LED_OFF;\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nif (pLed->bLedOn)\r\nSwLedOff(padapter, pLed);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("CurrLedState %d\n", pLed->CurrLedState));\r\n}\r\npLed->bLedScanBlinkInProgress = false;\r\n} else {\r\nif (padapter->pwrctrlpriv.rf_pwrstate != rf_on) {\r\nSwLedOff(padapter, pLed);\r\n} else {\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_SCAN_INTERVAL_ALPHA);\r\n}\r\n}\r\nbreak;\r\ncase LED_BLINK_TXRX:\r\npLed->BlinkTimes--;\r\nif (pLed->BlinkTimes == 0)\r\nbStopBlinking = true;\r\nif (bStopBlinking) {\r\nif (padapter->pwrctrlpriv.rf_pwrstate != rf_on) {\r\nSwLedOff(padapter, pLed);\r\n} else if (check_fwstate(pmlmepriv, _FW_LINKED)) {\r\npLed->CurrLedState = RTW_LED_ON;\r\npLed->BlinkingLedState = RTW_LED_ON;\r\nif (!pLed->bLedOn)\r\nSwLedOn(padapter, pLed);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("CurrLedState %d\n", pLed->CurrLedState));\r\n} else if (!check_fwstate(pmlmepriv, _FW_LINKED)) {\r\npLed->CurrLedState = RTW_LED_OFF;\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nif (pLed->bLedOn)\r\nSwLedOff(padapter, pLed);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("CurrLedState %d\n", pLed->CurrLedState));\r\n}\r\npLed->bLedBlinkInProgress = false;\r\n} else {\r\nif (padapter->pwrctrlpriv.rf_pwrstate != rf_on) {\r\nSwLedOff(padapter, pLed);\r\n} else {\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_FASTER_INTERVAL_ALPHA);\r\n}\r\n}\r\nbreak;\r\ncase LED_BLINK_WPS:\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_SCAN_INTERVAL_ALPHA);\r\nbreak;\r\ncase LED_BLINK_WPS_STOP:\r\nif (pLed->BlinkingLedState == RTW_LED_ON) {\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_WPS_SUCESS_INTERVAL_ALPHA);\r\nbStopBlinking = false;\r\n} else {\r\nbStopBlinking = true;\r\n}\r\nif (bStopBlinking) {\r\nif (padapter->pwrctrlpriv.rf_pwrstate != rf_on) {\r\nSwLedOff(padapter, pLed);\r\n} else {\r\npLed->CurrLedState = RTW_LED_ON;\r\npLed->BlinkingLedState = RTW_LED_ON;\r\nSwLedOn(padapter, pLed);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("CurrLedState %d\n", pLed->CurrLedState));\r\n}\r\npLed->bLedWPSBlinkInProgress = false;\r\n}\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\nstatic void SwLedBlink4(struct LED_871x *pLed)\r\n{\r\nstruct adapter *padapter = pLed->padapter;\r\nstruct led_priv *ledpriv = &(padapter->ledpriv);\r\nstruct LED_871x *pLed1 = &(ledpriv->SwLed1);\r\nu8 bStopBlinking = false;\r\nif (pLed->BlinkingLedState == RTW_LED_ON) {\r\nSwLedOn(padapter, pLed);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("Blinktimes (%d): turn on\n", pLed->BlinkTimes));\r\n} else {\r\nSwLedOff(padapter, pLed);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("Blinktimes (%d): turn off\n", pLed->BlinkTimes));\r\n}\r\nif (!pLed1->bLedWPSBlinkInProgress && pLed1->BlinkingLedState == LED_UNKNOWN) {\r\npLed1->BlinkingLedState = RTW_LED_OFF;\r\npLed1->CurrLedState = RTW_LED_OFF;\r\nSwLedOff(padapter, pLed1);\r\n}\r\nswitch (pLed->CurrLedState) {\r\ncase LED_BLINK_SLOWLY:\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_NO_LINK_INTERVAL_ALPHA);\r\nbreak;\r\ncase LED_BLINK_StartToBlink:\r\nif (pLed->bLedOn) {\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_SLOWLY_INTERVAL);\r\n} else {\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_NORMAL_INTERVAL);\r\n}\r\nbreak;\r\ncase LED_BLINK_SCAN:\r\npLed->BlinkTimes--;\r\nif (pLed->BlinkTimes == 0)\r\nbStopBlinking = false;\r\nif (bStopBlinking) {\r\nif (padapter->pwrctrlpriv.rf_pwrstate != rf_on && padapter->pwrctrlpriv.rfoff_reason > RF_CHANGE_BY_PS) {\r\nSwLedOff(padapter, pLed);\r\n} else {\r\npLed->bLedNoLinkBlinkInProgress = false;\r\npLed->CurrLedState = LED_BLINK_SLOWLY;\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_NO_LINK_INTERVAL_ALPHA);\r\n}\r\npLed->bLedScanBlinkInProgress = false;\r\n} else {\r\nif (padapter->pwrctrlpriv.rf_pwrstate != rf_on && padapter->pwrctrlpriv.rfoff_reason > RF_CHANGE_BY_PS) {\r\nSwLedOff(padapter, pLed);\r\n} else {\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_SCAN_INTERVAL_ALPHA);\r\n}\r\n}\r\nbreak;\r\ncase LED_BLINK_TXRX:\r\npLed->BlinkTimes--;\r\nif (pLed->BlinkTimes == 0)\r\nbStopBlinking = true;\r\nif (bStopBlinking) {\r\nif (padapter->pwrctrlpriv.rf_pwrstate != rf_on && padapter->pwrctrlpriv.rfoff_reason > RF_CHANGE_BY_PS) {\r\nSwLedOff(padapter, pLed);\r\n} else {\r\npLed->bLedNoLinkBlinkInProgress = true;\r\npLed->CurrLedState = LED_BLINK_SLOWLY;\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_NO_LINK_INTERVAL_ALPHA);\r\n}\r\npLed->bLedBlinkInProgress = false;\r\n} else {\r\nif (padapter->pwrctrlpriv.rf_pwrstate != rf_on && padapter->pwrctrlpriv.rfoff_reason > RF_CHANGE_BY_PS) {\r\nSwLedOff(padapter, pLed);\r\n} else {\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_FASTER_INTERVAL_ALPHA);\r\n}\r\n}\r\nbreak;\r\ncase LED_BLINK_WPS:\r\nif (pLed->bLedOn) {\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_SLOWLY_INTERVAL);\r\n} else {\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_NORMAL_INTERVAL);\r\n}\r\nbreak;\r\ncase LED_BLINK_WPS_STOP:\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_NORMAL_INTERVAL);\r\nbreak;\r\ncase LED_BLINK_WPS_STOP_OVERLAP:\r\npLed->BlinkTimes--;\r\nif (pLed->BlinkTimes == 0) {\r\nif (pLed->bLedOn)\r\npLed->BlinkTimes = 1;\r\nelse\r\nbStopBlinking = true;\r\n}\r\nif (bStopBlinking) {\r\npLed->BlinkTimes = 10;\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_LINK_INTERVAL_ALPHA);\r\n} else {\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_NORMAL_INTERVAL);\r\n}\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("SwLedBlink4 CurrLedState %d\n", pLed->CurrLedState));\r\n}\r\nstatic void SwLedBlink5(struct LED_871x *pLed)\r\n{\r\nstruct adapter *padapter = pLed->padapter;\r\nu8 bStopBlinking = false;\r\nif (pLed->BlinkingLedState == RTW_LED_ON) {\r\nSwLedOn(padapter, pLed);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("Blinktimes (%d): turn on\n", pLed->BlinkTimes));\r\n} else {\r\nSwLedOff(padapter, pLed);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("Blinktimes (%d): turn off\n", pLed->BlinkTimes));\r\n}\r\nswitch (pLed->CurrLedState) {\r\ncase LED_BLINK_SCAN:\r\npLed->BlinkTimes--;\r\nif (pLed->BlinkTimes == 0)\r\nbStopBlinking = true;\r\nif (bStopBlinking) {\r\nif (padapter->pwrctrlpriv.rf_pwrstate != rf_on && padapter->pwrctrlpriv.rfoff_reason > RF_CHANGE_BY_PS) {\r\npLed->CurrLedState = RTW_LED_OFF;\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nif (pLed->bLedOn)\r\nSwLedOff(padapter, pLed);\r\n} else {\r\npLed->CurrLedState = RTW_LED_ON;\r\npLed->BlinkingLedState = RTW_LED_ON;\r\nif (!pLed->bLedOn)\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_FASTER_INTERVAL_ALPHA);\r\n}\r\npLed->bLedScanBlinkInProgress = false;\r\n} else {\r\nif (padapter->pwrctrlpriv.rf_pwrstate != rf_on && padapter->pwrctrlpriv.rfoff_reason > RF_CHANGE_BY_PS) {\r\nSwLedOff(padapter, pLed);\r\n} else {\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_SCAN_INTERVAL_ALPHA);\r\n}\r\n}\r\nbreak;\r\ncase LED_BLINK_TXRX:\r\npLed->BlinkTimes--;\r\nif (pLed->BlinkTimes == 0)\r\nbStopBlinking = true;\r\nif (bStopBlinking) {\r\nif (padapter->pwrctrlpriv.rf_pwrstate != rf_on && padapter->pwrctrlpriv.rfoff_reason > RF_CHANGE_BY_PS) {\r\npLed->CurrLedState = RTW_LED_OFF;\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nif (pLed->bLedOn)\r\nSwLedOff(padapter, pLed);\r\n} else {\r\npLed->CurrLedState = RTW_LED_ON;\r\npLed->BlinkingLedState = RTW_LED_ON;\r\nif (!pLed->bLedOn)\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_FASTER_INTERVAL_ALPHA);\r\n}\r\npLed->bLedBlinkInProgress = false;\r\n} else {\r\nif (padapter->pwrctrlpriv.rf_pwrstate != rf_on && padapter->pwrctrlpriv.rfoff_reason > RF_CHANGE_BY_PS) {\r\nSwLedOff(padapter, pLed);\r\n} else {\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_FASTER_INTERVAL_ALPHA);\r\n}\r\n}\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("SwLedBlink5 CurrLedState %d\n", pLed->CurrLedState));\r\n}\r\nstatic void SwLedBlink6(struct LED_871x *pLed)\r\n{\r\nstruct adapter *padapter = pLed->padapter;\r\nif (pLed->BlinkingLedState == RTW_LED_ON) {\r\nSwLedOn(padapter, pLed);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("Blinktimes (%d): turn on\n", pLed->BlinkTimes));\r\n} else {\r\nSwLedOff(padapter, pLed);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("Blinktimes (%d): turn off\n", pLed->BlinkTimes));\r\n}\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("<==== blink6\n"));\r\n}\r\nstatic void SwLedControlMode1(struct adapter *padapter, enum LED_CTL_MODE LedAction)\r\n{\r\nstruct led_priv *ledpriv = &(padapter->ledpriv);\r\nstruct LED_871x *pLed = &(ledpriv->SwLed0);\r\nstruct mlme_priv *pmlmepriv = &(padapter->mlmepriv);\r\nswitch (LedAction) {\r\ncase LED_CTL_POWER_ON:\r\ncase LED_CTL_START_TO_LINK:\r\ncase LED_CTL_NO_LINK:\r\nif (!pLed->bLedNoLinkBlinkInProgress) {\r\nif (pLed->CurrLedState == LED_BLINK_SCAN || IS_LED_WPS_BLINKING(pLed))\r\nreturn;\r\nif (pLed->bLedLinkBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedLinkBlinkInProgress = false;\r\n}\r\nif (pLed->bLedBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedBlinkInProgress = false;\r\n}\r\npLed->bLedNoLinkBlinkInProgress = true;\r\npLed->CurrLedState = LED_BLINK_SLOWLY;\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_NO_LINK_INTERVAL_ALPHA);\r\n}\r\nbreak;\r\ncase LED_CTL_LINK:\r\nif (!pLed->bLedLinkBlinkInProgress) {\r\nif (pLed->CurrLedState == LED_BLINK_SCAN || IS_LED_WPS_BLINKING(pLed))\r\nreturn;\r\nif (pLed->bLedNoLinkBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedNoLinkBlinkInProgress = false;\r\n}\r\nif (pLed->bLedBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedBlinkInProgress = false;\r\n}\r\npLed->bLedLinkBlinkInProgress = true;\r\npLed->CurrLedState = LED_BLINK_NORMAL;\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_LINK_INTERVAL_ALPHA);\r\n}\r\nbreak;\r\ncase LED_CTL_SITE_SURVEY:\r\nif ((pmlmepriv->LinkDetectInfo.bBusyTraffic) && (check_fwstate(pmlmepriv, _FW_LINKED))) {\r\n;\r\n} else if (!pLed->bLedScanBlinkInProgress) {\r\nif (IS_LED_WPS_BLINKING(pLed))\r\nreturn;\r\nif (pLed->bLedNoLinkBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedNoLinkBlinkInProgress = false;\r\n}\r\nif (pLed->bLedLinkBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedLinkBlinkInProgress = false;\r\n}\r\nif (pLed->bLedBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedBlinkInProgress = false;\r\n}\r\npLed->bLedScanBlinkInProgress = true;\r\npLed->CurrLedState = LED_BLINK_SCAN;\r\npLed->BlinkTimes = 24;\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_SCAN_INTERVAL_ALPHA);\r\n}\r\nbreak;\r\ncase LED_CTL_TX:\r\ncase LED_CTL_RX:\r\nif (!pLed->bLedBlinkInProgress) {\r\nif (pLed->CurrLedState == LED_BLINK_SCAN || IS_LED_WPS_BLINKING(pLed))\r\nreturn;\r\nif (pLed->bLedNoLinkBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedNoLinkBlinkInProgress = false;\r\n}\r\nif (pLed->bLedLinkBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedLinkBlinkInProgress = false;\r\n}\r\npLed->bLedBlinkInProgress = true;\r\npLed->CurrLedState = LED_BLINK_TXRX;\r\npLed->BlinkTimes = 2;\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_FASTER_INTERVAL_ALPHA);\r\n}\r\nbreak;\r\ncase LED_CTL_START_WPS:\r\ncase LED_CTL_START_WPS_BOTTON:\r\nif (!pLed->bLedWPSBlinkInProgress) {\r\nif (pLed->bLedNoLinkBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedNoLinkBlinkInProgress = false;\r\n}\r\nif (pLed->bLedLinkBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedLinkBlinkInProgress = false;\r\n}\r\nif (pLed->bLedBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedBlinkInProgress = false;\r\n}\r\nif (pLed->bLedScanBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedScanBlinkInProgress = false;\r\n}\r\npLed->bLedWPSBlinkInProgress = true;\r\npLed->CurrLedState = LED_BLINK_WPS;\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_SCAN_INTERVAL_ALPHA);\r\n}\r\nbreak;\r\ncase LED_CTL_STOP_WPS:\r\nif (pLed->bLedNoLinkBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedNoLinkBlinkInProgress = false;\r\n}\r\nif (pLed->bLedLinkBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedLinkBlinkInProgress = false;\r\n}\r\nif (pLed->bLedBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedBlinkInProgress = false;\r\n}\r\nif (pLed->bLedScanBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedScanBlinkInProgress = false;\r\n}\r\nif (pLed->bLedWPSBlinkInProgress)\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\nelse\r\npLed->bLedWPSBlinkInProgress = true;\r\npLed->CurrLedState = LED_BLINK_WPS_STOP;\r\nif (pLed->bLedOn) {\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_WPS_SUCESS_INTERVAL_ALPHA);\r\n} else {\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), 0);\r\n}\r\nbreak;\r\ncase LED_CTL_STOP_WPS_FAIL:\r\nif (pLed->bLedWPSBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedWPSBlinkInProgress = false;\r\n}\r\npLed->bLedNoLinkBlinkInProgress = true;\r\npLed->CurrLedState = LED_BLINK_SLOWLY;\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_NO_LINK_INTERVAL_ALPHA);\r\nbreak;\r\ncase LED_CTL_POWER_OFF:\r\npLed->CurrLedState = RTW_LED_OFF;\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nif (pLed->bLedNoLinkBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedNoLinkBlinkInProgress = false;\r\n}\r\nif (pLed->bLedLinkBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedLinkBlinkInProgress = false;\r\n}\r\nif (pLed->bLedBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedBlinkInProgress = false;\r\n}\r\nif (pLed->bLedWPSBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedWPSBlinkInProgress = false;\r\n}\r\nif (pLed->bLedScanBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedScanBlinkInProgress = false;\r\n}\r\nSwLedOff(padapter, pLed);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("Led %d\n", pLed->CurrLedState));\r\n}\r\nstatic void SwLedControlMode2(struct adapter *padapter, enum LED_CTL_MODE LedAction)\r\n{\r\nstruct led_priv *ledpriv = &(padapter->ledpriv);\r\nstruct mlme_priv *pmlmepriv = &padapter->mlmepriv;\r\nstruct LED_871x *pLed = &(ledpriv->SwLed0);\r\nswitch (LedAction) {\r\ncase LED_CTL_SITE_SURVEY:\r\nif (pmlmepriv->LinkDetectInfo.bBusyTraffic) {\r\n} else if (!pLed->bLedScanBlinkInProgress) {\r\nif (IS_LED_WPS_BLINKING(pLed))\r\nreturn;\r\nif (pLed->bLedBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedBlinkInProgress = false;\r\n}\r\npLed->bLedScanBlinkInProgress = true;\r\npLed->CurrLedState = LED_BLINK_SCAN;\r\npLed->BlinkTimes = 24;\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_SCAN_INTERVAL_ALPHA);\r\n}\r\nbreak;\r\ncase LED_CTL_TX:\r\ncase LED_CTL_RX:\r\nif ((!pLed->bLedBlinkInProgress) && (check_fwstate(pmlmepriv, _FW_LINKED))) {\r\nif (pLed->CurrLedState == LED_BLINK_SCAN || IS_LED_WPS_BLINKING(pLed))\r\nreturn;\r\npLed->bLedBlinkInProgress = true;\r\npLed->CurrLedState = LED_BLINK_TXRX;\r\npLed->BlinkTimes = 2;\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_FASTER_INTERVAL_ALPHA);\r\n}\r\nbreak;\r\ncase LED_CTL_LINK:\r\npLed->CurrLedState = RTW_LED_ON;\r\npLed->BlinkingLedState = RTW_LED_ON;\r\nif (pLed->bLedBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedBlinkInProgress = false;\r\n}\r\nif (pLed->bLedScanBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedScanBlinkInProgress = false;\r\n}\r\n_set_timer(&(pLed->BlinkTimer), 0);\r\nbreak;\r\ncase LED_CTL_START_WPS:\r\ncase LED_CTL_START_WPS_BOTTON:\r\nif (!pLed->bLedWPSBlinkInProgress) {\r\nif (pLed->bLedBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedBlinkInProgress = false;\r\n}\r\nif (pLed->bLedScanBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedScanBlinkInProgress = false;\r\n}\r\npLed->bLedWPSBlinkInProgress = true;\r\npLed->CurrLedState = RTW_LED_ON;\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), 0);\r\n}\r\nbreak;\r\ncase LED_CTL_STOP_WPS:\r\npLed->bLedWPSBlinkInProgress = false;\r\nif (padapter->pwrctrlpriv.rf_pwrstate != rf_on) {\r\nSwLedOff(padapter, pLed);\r\n} else {\r\npLed->CurrLedState = RTW_LED_ON;\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), 0);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("CurrLedState %d\n", pLed->CurrLedState));\r\n}\r\nbreak;\r\ncase LED_CTL_STOP_WPS_FAIL:\r\npLed->bLedWPSBlinkInProgress = false;\r\nif (padapter->pwrctrlpriv.rf_pwrstate != rf_on) {\r\nSwLedOff(padapter, pLed);\r\n} else {\r\npLed->CurrLedState = RTW_LED_OFF;\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\n_set_timer(&(pLed->BlinkTimer), 0);\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("CurrLedState %d\n", pLed->CurrLedState));\r\n}\r\nbreak;\r\ncase LED_CTL_START_TO_LINK:\r\ncase LED_CTL_NO_LINK:\r\nif (!IS_LED_BLINKING(pLed)) {\r\npLed->CurrLedState = RTW_LED_OFF;\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\n_set_timer(&(pLed->BlinkTimer), 0);\r\n}\r\nbreak;\r\ncase LED_CTL_POWER_OFF:\r\npLed->CurrLedState = RTW_LED_OFF;\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nif (pLed->bLedBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedBlinkInProgress = false;\r\n}\r\nif (pLed->bLedScanBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedScanBlinkInProgress = false;\r\n}\r\nif (pLed->bLedWPSBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedWPSBlinkInProgress = false;\r\n}\r\n_set_timer(&(pLed->BlinkTimer), 0);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("CurrLedState %d\n", pLed->CurrLedState));\r\n}\r\nstatic void SwLedControlMode3(struct adapter *padapter, enum LED_CTL_MODE LedAction)\r\n{\r\nstruct led_priv *ledpriv = &(padapter->ledpriv);\r\nstruct mlme_priv *pmlmepriv = &padapter->mlmepriv;\r\nstruct LED_871x *pLed = &(ledpriv->SwLed0);\r\nswitch (LedAction) {\r\ncase LED_CTL_SITE_SURVEY:\r\nif (pmlmepriv->LinkDetectInfo.bBusyTraffic) {\r\n} else if (!pLed->bLedScanBlinkInProgress) {\r\nif (IS_LED_WPS_BLINKING(pLed))\r\nreturn;\r\nif (pLed->bLedBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedBlinkInProgress = false;\r\n}\r\npLed->bLedScanBlinkInProgress = true;\r\npLed->CurrLedState = LED_BLINK_SCAN;\r\npLed->BlinkTimes = 24;\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_SCAN_INTERVAL_ALPHA);\r\n}\r\nbreak;\r\ncase LED_CTL_TX:\r\ncase LED_CTL_RX:\r\nif ((!pLed->bLedBlinkInProgress) && (check_fwstate(pmlmepriv, _FW_LINKED))) {\r\nif (pLed->CurrLedState == LED_BLINK_SCAN || IS_LED_WPS_BLINKING(pLed))\r\nreturn;\r\npLed->bLedBlinkInProgress = true;\r\npLed->CurrLedState = LED_BLINK_TXRX;\r\npLed->BlinkTimes = 2;\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_FASTER_INTERVAL_ALPHA);\r\n}\r\nbreak;\r\ncase LED_CTL_LINK:\r\nif (IS_LED_WPS_BLINKING(pLed))\r\nreturn;\r\npLed->CurrLedState = RTW_LED_ON;\r\npLed->BlinkingLedState = RTW_LED_ON;\r\nif (pLed->bLedBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedBlinkInProgress = false;\r\n}\r\nif (pLed->bLedScanBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedScanBlinkInProgress = false;\r\n}\r\n_set_timer(&(pLed->BlinkTimer), 0);\r\nbreak;\r\ncase LED_CTL_START_WPS:\r\ncase LED_CTL_START_WPS_BOTTON:\r\nif (!pLed->bLedWPSBlinkInProgress) {\r\nif (pLed->bLedBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedBlinkInProgress = false;\r\n}\r\nif (pLed->bLedScanBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedScanBlinkInProgress = false;\r\n}\r\npLed->bLedWPSBlinkInProgress = true;\r\npLed->CurrLedState = LED_BLINK_WPS;\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_SCAN_INTERVAL_ALPHA);\r\n}\r\nbreak;\r\ncase LED_CTL_STOP_WPS:\r\nif (pLed->bLedWPSBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedWPSBlinkInProgress = false;\r\n} else {\r\npLed->bLedWPSBlinkInProgress = true;\r\n}\r\npLed->CurrLedState = LED_BLINK_WPS_STOP;\r\nif (pLed->bLedOn) {\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_WPS_SUCESS_INTERVAL_ALPHA);\r\n} else {\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), 0);\r\n}\r\nbreak;\r\ncase LED_CTL_STOP_WPS_FAIL:\r\nif (pLed->bLedWPSBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedWPSBlinkInProgress = false;\r\n}\r\npLed->CurrLedState = RTW_LED_OFF;\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\n_set_timer(&(pLed->BlinkTimer), 0);\r\nbreak;\r\ncase LED_CTL_START_TO_LINK:\r\ncase LED_CTL_NO_LINK:\r\nif (!IS_LED_BLINKING(pLed)) {\r\npLed->CurrLedState = RTW_LED_OFF;\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\n_set_timer(&(pLed->BlinkTimer), 0);\r\n}\r\nbreak;\r\ncase LED_CTL_POWER_OFF:\r\npLed->CurrLedState = RTW_LED_OFF;\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nif (pLed->bLedBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedBlinkInProgress = false;\r\n}\r\nif (pLed->bLedScanBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedScanBlinkInProgress = false;\r\n}\r\nif (pLed->bLedWPSBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedWPSBlinkInProgress = false;\r\n}\r\n_set_timer(&(pLed->BlinkTimer), 0);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_,\r\n("CurrLedState %d\n", pLed->CurrLedState));\r\n}\r\nstatic void SwLedControlMode4(struct adapter *padapter, enum LED_CTL_MODE LedAction)\r\n{\r\nstruct led_priv *ledpriv = &(padapter->ledpriv);\r\nstruct mlme_priv *pmlmepriv = &padapter->mlmepriv;\r\nstruct LED_871x *pLed = &(ledpriv->SwLed0);\r\nstruct LED_871x *pLed1 = &(ledpriv->SwLed1);\r\nswitch (LedAction) {\r\ncase LED_CTL_START_TO_LINK:\r\nif (pLed1->bLedWPSBlinkInProgress) {\r\npLed1->bLedWPSBlinkInProgress = false;\r\n_cancel_timer_ex(&(pLed1->BlinkTimer));\r\npLed1->BlinkingLedState = RTW_LED_OFF;\r\npLed1->CurrLedState = RTW_LED_OFF;\r\nif (pLed1->bLedOn)\r\n_set_timer(&(pLed->BlinkTimer), 0);\r\n}\r\nif (!pLed->bLedStartToLinkBlinkInProgress) {\r\nif (pLed->CurrLedState == LED_BLINK_SCAN || IS_LED_WPS_BLINKING(pLed))\r\nreturn;\r\nif (pLed->bLedBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedBlinkInProgress = false;\r\n}\r\nif (pLed->bLedNoLinkBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedNoLinkBlinkInProgress = false;\r\n}\r\npLed->bLedStartToLinkBlinkInProgress = true;\r\npLed->CurrLedState = LED_BLINK_StartToBlink;\r\nif (pLed->bLedOn) {\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_SLOWLY_INTERVAL);\r\n} else {\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_NORMAL_INTERVAL);\r\n}\r\n}\r\nbreak;\r\ncase LED_CTL_LINK:\r\ncase LED_CTL_NO_LINK:\r\nif (LedAction == LED_CTL_LINK) {\r\nif (pLed1->bLedWPSBlinkInProgress) {\r\npLed1->bLedWPSBlinkInProgress = false;\r\n_cancel_timer_ex(&(pLed1->BlinkTimer));\r\npLed1->BlinkingLedState = RTW_LED_OFF;\r\npLed1->CurrLedState = RTW_LED_OFF;\r\nif (pLed1->bLedOn)\r\n_set_timer(&(pLed->BlinkTimer), 0);\r\n}\r\n}\r\nif (!pLed->bLedNoLinkBlinkInProgress) {\r\nif (pLed->CurrLedState == LED_BLINK_SCAN || IS_LED_WPS_BLINKING(pLed))\r\nreturn;\r\nif (pLed->bLedBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedBlinkInProgress = false;\r\n}\r\npLed->bLedNoLinkBlinkInProgress = true;\r\npLed->CurrLedState = LED_BLINK_SLOWLY;\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_NO_LINK_INTERVAL_ALPHA);\r\n}\r\nbreak;\r\ncase LED_CTL_SITE_SURVEY:\r\nif ((pmlmepriv->LinkDetectInfo.bBusyTraffic) && (check_fwstate(pmlmepriv, _FW_LINKED))) {\r\n} else if (!pLed->bLedScanBlinkInProgress) {\r\nif (IS_LED_WPS_BLINKING(pLed))\r\nreturn;\r\nif (pLed->bLedNoLinkBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedNoLinkBlinkInProgress = false;\r\n}\r\nif (pLed->bLedBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedBlinkInProgress = false;\r\n}\r\npLed->bLedScanBlinkInProgress = true;\r\npLed->CurrLedState = LED_BLINK_SCAN;\r\npLed->BlinkTimes = 24;\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_SCAN_INTERVAL_ALPHA);\r\n}\r\nbreak;\r\ncase LED_CTL_TX:\r\ncase LED_CTL_RX:\r\nif (!pLed->bLedBlinkInProgress) {\r\nif (pLed->CurrLedState == LED_BLINK_SCAN || IS_LED_WPS_BLINKING(pLed))\r\nreturn;\r\nif (pLed->bLedNoLinkBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedNoLinkBlinkInProgress = false;\r\n}\r\npLed->bLedBlinkInProgress = true;\r\npLed->CurrLedState = LED_BLINK_TXRX;\r\npLed->BlinkTimes = 2;\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_FASTER_INTERVAL_ALPHA);\r\n}\r\nbreak;\r\ncase LED_CTL_START_WPS:\r\ncase LED_CTL_START_WPS_BOTTON:\r\nif (pLed1->bLedWPSBlinkInProgress) {\r\npLed1->bLedWPSBlinkInProgress = false;\r\n_cancel_timer_ex(&(pLed1->BlinkTimer));\r\npLed1->BlinkingLedState = RTW_LED_OFF;\r\npLed1->CurrLedState = RTW_LED_OFF;\r\nif (pLed1->bLedOn)\r\n_set_timer(&(pLed->BlinkTimer), 0);\r\n}\r\nif (!pLed->bLedWPSBlinkInProgress) {\r\nif (pLed->bLedNoLinkBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedNoLinkBlinkInProgress = false;\r\n}\r\nif (pLed->bLedBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedBlinkInProgress = false;\r\n}\r\nif (pLed->bLedScanBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedScanBlinkInProgress = false;\r\n}\r\npLed->bLedWPSBlinkInProgress = true;\r\npLed->CurrLedState = LED_BLINK_WPS;\r\nif (pLed->bLedOn) {\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_SLOWLY_INTERVAL);\r\n} else {\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_NORMAL_INTERVAL);\r\n}\r\n}\r\nbreak;\r\ncase LED_CTL_STOP_WPS:\r\nif (pLed->bLedWPSBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedWPSBlinkInProgress = false;\r\n}\r\npLed->bLedNoLinkBlinkInProgress = true;\r\npLed->CurrLedState = LED_BLINK_SLOWLY;\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_NO_LINK_INTERVAL_ALPHA);\r\nbreak;\r\ncase LED_CTL_STOP_WPS_FAIL:\r\nif (pLed->bLedWPSBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedWPSBlinkInProgress = false;\r\n}\r\npLed->bLedNoLinkBlinkInProgress = true;\r\npLed->CurrLedState = LED_BLINK_SLOWLY;\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_NO_LINK_INTERVAL_ALPHA);\r\nif (pLed1->bLedWPSBlinkInProgress)\r\n_cancel_timer_ex(&(pLed1->BlinkTimer));\r\nelse\r\npLed1->bLedWPSBlinkInProgress = true;\r\npLed1->CurrLedState = LED_BLINK_WPS_STOP;\r\nif (pLed1->bLedOn)\r\npLed1->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed1->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_NORMAL_INTERVAL);\r\nbreak;\r\ncase LED_CTL_STOP_WPS_FAIL_OVERLAP:\r\nif (pLed->bLedWPSBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedWPSBlinkInProgress = false;\r\n}\r\npLed->bLedNoLinkBlinkInProgress = true;\r\npLed->CurrLedState = LED_BLINK_SLOWLY;\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_NO_LINK_INTERVAL_ALPHA);\r\nif (pLed1->bLedWPSBlinkInProgress)\r\n_cancel_timer_ex(&(pLed1->BlinkTimer));\r\nelse\r\npLed1->bLedWPSBlinkInProgress = true;\r\npLed1->CurrLedState = LED_BLINK_WPS_STOP_OVERLAP;\r\npLed1->BlinkTimes = 10;\r\nif (pLed1->bLedOn)\r\npLed1->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed1->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_NORMAL_INTERVAL);\r\nbreak;\r\ncase LED_CTL_POWER_OFF:\r\npLed->CurrLedState = RTW_LED_OFF;\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nif (pLed->bLedNoLinkBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedNoLinkBlinkInProgress = false;\r\n}\r\nif (pLed->bLedLinkBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedLinkBlinkInProgress = false;\r\n}\r\nif (pLed->bLedBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedBlinkInProgress = false;\r\n}\r\nif (pLed->bLedWPSBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedWPSBlinkInProgress = false;\r\n}\r\nif (pLed->bLedScanBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedScanBlinkInProgress = false;\r\n}\r\nif (pLed->bLedStartToLinkBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedStartToLinkBlinkInProgress = false;\r\n}\r\nif (pLed1->bLedWPSBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed1->BlinkTimer));\r\npLed1->bLedWPSBlinkInProgress = false;\r\n}\r\npLed1->BlinkingLedState = LED_UNKNOWN;\r\nSwLedOff(padapter, pLed);\r\nSwLedOff(padapter, pLed1);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("Led %d\n", pLed->CurrLedState));\r\n}\r\nstatic void\r\nSwLedControlMode5(\r\nstruct adapter *padapter,\r\nenum LED_CTL_MODE LedAction\r\n)\r\n{\r\nstruct led_priv *ledpriv = &(padapter->ledpriv);\r\nstruct mlme_priv *pmlmepriv = &padapter->mlmepriv;\r\nstruct LED_871x *pLed = &(ledpriv->SwLed0);\r\nswitch (LedAction) {\r\ncase LED_CTL_POWER_ON:\r\ncase LED_CTL_NO_LINK:\r\ncase LED_CTL_LINK:\r\npLed->CurrLedState = RTW_LED_ON;\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), 0);\r\nbreak;\r\ncase LED_CTL_SITE_SURVEY:\r\nif ((pmlmepriv->LinkDetectInfo.bBusyTraffic) && (check_fwstate(pmlmepriv, _FW_LINKED))) {\r\n} else if (!pLed->bLedScanBlinkInProgress) {\r\nif (pLed->bLedBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedBlinkInProgress = false;\r\n}\r\npLed->bLedScanBlinkInProgress = true;\r\npLed->CurrLedState = LED_BLINK_SCAN;\r\npLed->BlinkTimes = 24;\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_SCAN_INTERVAL_ALPHA);\r\n}\r\nbreak;\r\ncase LED_CTL_TX:\r\ncase LED_CTL_RX:\r\nif (!pLed->bLedBlinkInProgress) {\r\nif (pLed->CurrLedState == LED_BLINK_SCAN)\r\nreturn;\r\npLed->bLedBlinkInProgress = true;\r\npLed->CurrLedState = LED_BLINK_TXRX;\r\npLed->BlinkTimes = 2;\r\nif (pLed->bLedOn)\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nelse\r\npLed->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed->BlinkTimer), LED_BLINK_FASTER_INTERVAL_ALPHA);\r\n}\r\nbreak;\r\ncase LED_CTL_POWER_OFF:\r\npLed->CurrLedState = RTW_LED_OFF;\r\npLed->BlinkingLedState = RTW_LED_OFF;\r\nif (pLed->bLedBlinkInProgress) {\r\n_cancel_timer_ex(&(pLed->BlinkTimer));\r\npLed->bLedBlinkInProgress = false;\r\n}\r\nSwLedOff(padapter, pLed);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("Led %d\n", pLed->CurrLedState));\r\n}\r\nstatic void\r\nSwLedControlMode6(\r\nstruct adapter *padapter,\r\nenum LED_CTL_MODE LedAction\r\n)\r\n{\r\nstruct led_priv *ledpriv = &(padapter->ledpriv);\r\nstruct LED_871x *pLed0 = &(ledpriv->SwLed0);\r\nswitch (LedAction) {\r\ncase LED_CTL_POWER_ON:\r\ncase LED_CTL_LINK:\r\ncase LED_CTL_NO_LINK:\r\n_cancel_timer_ex(&(pLed0->BlinkTimer));\r\npLed0->CurrLedState = RTW_LED_ON;\r\npLed0->BlinkingLedState = RTW_LED_ON;\r\n_set_timer(&(pLed0->BlinkTimer), 0);\r\nbreak;\r\ncase LED_CTL_POWER_OFF:\r\nSwLedOff(padapter, pLed0);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_, ("ledcontrol 6 Led %d\n", pLed0->CurrLedState));\r\n}\r\nvoid BlinkHandler(struct LED_871x *pLed)\r\n{\r\nstruct adapter *padapter = pLed->padapter;\r\nstruct led_priv *ledpriv = &(padapter->ledpriv);\r\nif ((padapter->bSurpriseRemoved) || (padapter->bDriverStopped))\r\nreturn;\r\nswitch (ledpriv->LedStrategy) {\r\ncase SW_LED_MODE0:\r\nSwLedBlink(pLed);\r\nbreak;\r\ncase SW_LED_MODE1:\r\nSwLedBlink1(pLed);\r\nbreak;\r\ncase SW_LED_MODE2:\r\nSwLedBlink2(pLed);\r\nbreak;\r\ncase SW_LED_MODE3:\r\nSwLedBlink3(pLed);\r\nbreak;\r\ncase SW_LED_MODE4:\r\nSwLedBlink4(pLed);\r\nbreak;\r\ncase SW_LED_MODE5:\r\nSwLedBlink5(pLed);\r\nbreak;\r\ncase SW_LED_MODE6:\r\nSwLedBlink6(pLed);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\n}\r\nvoid LedControl8188eu(struct adapter *padapter, enum LED_CTL_MODE LedAction)\r\n{\r\nstruct led_priv *ledpriv = &(padapter->ledpriv);\r\nif ((padapter->bSurpriseRemoved) || (padapter->bDriverStopped) ||\r\n(!padapter->hw_init_completed))\r\nreturn;\r\nif (!ledpriv->bRegUseLed)\r\nreturn;\r\nif ((padapter->pwrctrlpriv.rf_pwrstate != rf_on &&\r\npadapter->pwrctrlpriv.rfoff_reason > RF_CHANGE_BY_PS) &&\r\n(LedAction == LED_CTL_TX || LedAction == LED_CTL_RX ||\r\nLedAction == LED_CTL_SITE_SURVEY ||\r\nLedAction == LED_CTL_LINK ||\r\nLedAction == LED_CTL_NO_LINK ||\r\nLedAction == LED_CTL_POWER_ON))\r\nreturn;\r\nswitch (ledpriv->LedStrategy) {\r\ncase SW_LED_MODE0:\r\nbreak;\r\ncase SW_LED_MODE1:\r\nSwLedControlMode1(padapter, LedAction);\r\nbreak;\r\ncase SW_LED_MODE2:\r\nSwLedControlMode2(padapter, LedAction);\r\nbreak;\r\ncase SW_LED_MODE3:\r\nSwLedControlMode3(padapter, LedAction);\r\nbreak;\r\ncase SW_LED_MODE4:\r\nSwLedControlMode4(padapter, LedAction);\r\nbreak;\r\ncase SW_LED_MODE5:\r\nSwLedControlMode5(padapter, LedAction);\r\nbreak;\r\ncase SW_LED_MODE6:\r\nSwLedControlMode6(padapter, LedAction);\r\nbreak;\r\ndefault:\r\nbreak;\r\n}\r\nRT_TRACE(_module_rtl8712_led_c_, _drv_info_,\r\n("LedStrategy:%d, LedAction %d\n",\r\nledpriv->LedStrategy, LedAction));\r\n}
