int\r\nnv50_sor_power(struct nv50_disp_priv *priv, int or, u32 data)\r\n{\r\nconst u32 stat = data & NV50_DISP_SOR_PWR_STATE;\r\nconst u32 soff = (or * 0x800);\r\nnv_wait(priv, 0x61c004 + soff, 0x80000000, 0x00000000);\r\nnv_mask(priv, 0x61c004 + soff, 0x80000001, 0x80000000 | stat);\r\nnv_wait(priv, 0x61c004 + soff, 0x80000000, 0x00000000);\r\nnv_wait(priv, 0x61c030 + soff, 0x10000000, 0x00000000);\r\nreturn 0;\r\n}\r\nint\r\nnv50_sor_mthd(struct nouveau_object *object, u32 mthd, void *args, u32 size)\r\n{\r\nstruct nv50_disp_priv *priv = (void *)object->engine;\r\nconst u8 head = (mthd & NV50_DISP_SOR_MTHD_HEAD) >> 3;\r\nconst u8 or = (mthd & NV50_DISP_SOR_MTHD_OR);\r\nu32 data;\r\nint ret = -EINVAL;\r\nif (size < sizeof(u32))\r\nreturn -EINVAL;\r\ndata = *(u32 *)args;\r\nswitch (mthd & ~0x3f) {\r\ncase NV50_DISP_SOR_PWR:\r\nret = priv->sor.power(priv, or, data);\r\nbreak;\r\ncase NVA3_DISP_SOR_HDA_ELD:\r\nret = priv->sor.hda_eld(priv, or, args, size);\r\nbreak;\r\ncase NV84_DISP_SOR_HDMI_PWR:\r\nret = priv->sor.hdmi(priv, head, or, data);\r\nbreak;\r\ncase NV50_DISP_SOR_LVDS_SCRIPT:\r\npriv->sor.lvdsconf = data & NV50_DISP_SOR_LVDS_SCRIPT_ID;\r\nret = 0;\r\nbreak;\r\ndefault:\r\nBUG_ON(1);\r\n}\r\nreturn ret;\r\n}
