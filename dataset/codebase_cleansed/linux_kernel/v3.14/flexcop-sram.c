static void flexcop_sram_set_chip(struct flexcop_device *fc,\r\nflexcop_sram_type_t type)\r\n{\r\nflexcop_set_ibi_value(wan_ctrl_reg_71c, sram_chip, type);\r\n}\r\nint flexcop_sram_init(struct flexcop_device *fc)\r\n{\r\nswitch (fc->rev) {\r\ncase FLEXCOP_II:\r\ncase FLEXCOP_IIB:\r\nflexcop_sram_set_chip(fc, FC_SRAM_1_32KB);\r\nbreak;\r\ncase FLEXCOP_III:\r\nflexcop_sram_set_chip(fc, FC_SRAM_1_48KB);\r\nbreak;\r\ndefault:\r\nreturn -EINVAL;\r\n}\r\nreturn 0;\r\n}\r\nint flexcop_sram_set_dest(struct flexcop_device *fc, flexcop_sram_dest_t dest,\r\nflexcop_sram_dest_target_t target)\r\n{\r\nflexcop_ibi_value v;\r\nv = fc->read_ibi_reg(fc, sram_dest_reg_714);\r\nif (fc->rev != FLEXCOP_III && target == FC_SRAM_DEST_TARGET_FC3_CA) {\r\nerr("SRAM destination target to available on FlexCopII(b)\n");\r\nreturn -EINVAL;\r\n}\r\ndeb_sram("sram dest: %x target: %x\n", dest, target);\r\nif (dest & FC_SRAM_DEST_NET)\r\nv.sram_dest_reg_714.NET_Dest = target;\r\nif (dest & FC_SRAM_DEST_CAI)\r\nv.sram_dest_reg_714.CAI_Dest = target;\r\nif (dest & FC_SRAM_DEST_CAO)\r\nv.sram_dest_reg_714.CAO_Dest = target;\r\nif (dest & FC_SRAM_DEST_MEDIA)\r\nv.sram_dest_reg_714.MEDIA_Dest = target;\r\nfc->write_ibi_reg(fc,sram_dest_reg_714,v);\r\nudelay(1000);\r\nreturn 0;\r\n}\r\nvoid flexcop_wan_set_speed(struct flexcop_device *fc, flexcop_wan_speed_t s)\r\n{\r\nflexcop_set_ibi_value(wan_ctrl_reg_71c,wan_speed_sig,s);\r\n}\r\nvoid flexcop_sram_ctrl(struct flexcop_device *fc, int usb_wan, int sramdma, int maximumfill)\r\n{\r\nflexcop_ibi_value v = fc->read_ibi_reg(fc,sram_dest_reg_714);\r\nv.sram_dest_reg_714.ctrl_usb_wan = usb_wan;\r\nv.sram_dest_reg_714.ctrl_sramdma = sramdma;\r\nv.sram_dest_reg_714.ctrl_maximumfill = maximumfill;\r\nfc->write_ibi_reg(fc,sram_dest_reg_714,v);\r\n}
