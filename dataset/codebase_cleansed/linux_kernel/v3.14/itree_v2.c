static inline unsigned long block_to_cpu(block_t n)\r\n{\r\nreturn n;\r\n}\r\nstatic inline block_t cpu_to_block(unsigned long n)\r\n{\r\nreturn n;\r\n}\r\nstatic inline block_t *i_data(struct inode *inode)\r\n{\r\nreturn (block_t *)minix_i(inode)->u.i2_data;\r\n}\r\nstatic int block_to_path(struct inode * inode, long block, int offsets[DEPTH])\r\n{\r\nint n = 0;\r\nchar b[BDEVNAME_SIZE];\r\nstruct super_block *sb = inode->i_sb;\r\nif (block < 0) {\r\nprintk("MINIX-fs: block_to_path: block %ld < 0 on dev %s\n",\r\nblock, bdevname(sb->s_bdev, b));\r\n} else if ((u64)block * (u64)sb->s_blocksize >=\r\nminix_sb(sb)->s_max_size) {\r\nif (printk_ratelimit())\r\nprintk("MINIX-fs: block_to_path: "\r\n"block %ld too big on dev %s\n",\r\nblock, bdevname(sb->s_bdev, b));\r\n} else if (block < DIRCOUNT) {\r\noffsets[n++] = block;\r\n} else if ((block -= DIRCOUNT) < INDIRCOUNT(sb)) {\r\noffsets[n++] = DIRCOUNT;\r\noffsets[n++] = block;\r\n} else if ((block -= INDIRCOUNT(sb)) < INDIRCOUNT(sb) * INDIRCOUNT(sb)) {\r\noffsets[n++] = DIRCOUNT + 1;\r\noffsets[n++] = block / INDIRCOUNT(sb);\r\noffsets[n++] = block % INDIRCOUNT(sb);\r\n} else {\r\nblock -= INDIRCOUNT(sb) * INDIRCOUNT(sb);\r\noffsets[n++] = DIRCOUNT + 2;\r\noffsets[n++] = (block / INDIRCOUNT(sb)) / INDIRCOUNT(sb);\r\noffsets[n++] = (block / INDIRCOUNT(sb)) % INDIRCOUNT(sb);\r\noffsets[n++] = block % INDIRCOUNT(sb);\r\n}\r\nreturn n;\r\n}\r\nint V2_minix_get_block(struct inode * inode, long block,\r\nstruct buffer_head *bh_result, int create)\r\n{\r\nreturn get_block(inode, block, bh_result, create);\r\n}\r\nvoid V2_minix_truncate(struct inode * inode)\r\n{\r\ntruncate(inode);\r\n}\r\nunsigned V2_minix_blocks(loff_t size, struct super_block *sb)\r\n{\r\nreturn nblocks(size, sb);\r\n}
