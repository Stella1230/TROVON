void __iomem *devm_ioremap_prot(struct device *dev, resource_size_t offset,\r\nsize_t size, unsigned long flags)\r\n{\r\nvoid __iomem **ptr, *addr;\r\nptr = devres_alloc(devm_ioremap_release, sizeof(*ptr), GFP_KERNEL);\r\nif (!ptr)\r\nreturn NULL;\r\naddr = ioremap_prot(offset, size, flags);\r\nif (addr) {\r\n*ptr = addr;\r\ndevres_add(dev, ptr);\r\n} else\r\ndevres_free(ptr);\r\nreturn addr;\r\n}
