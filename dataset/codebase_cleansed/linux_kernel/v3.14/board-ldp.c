static inline void __init ldp_init_smsc911x(void)\r\n{\r\ngpmc_smsc911x_init(&smsc911x_cfg);\r\n}\r\nstatic void __init ldp_display_init(void)\r\n{\r\nint r;\r\nstatic struct gpio gpios[] __initdata = {\r\n{LCD_PANEL_RESET_GPIO, GPIOF_OUT_INIT_HIGH, "LCD RESET"},\r\n{LCD_PANEL_QVGA_GPIO, GPIOF_OUT_INIT_HIGH, "LCD QVGA"},\r\n};\r\nr = gpio_request_array(gpios, ARRAY_SIZE(gpios));\r\nif (r) {\r\npr_err("Cannot request LCD GPIOs, error %d\n", r);\r\nreturn;\r\n}\r\nomap_display_init(&ldp_dss_data);\r\n}\r\nstatic int ldp_twl_gpio_setup(struct device *dev, unsigned gpio, unsigned ngpio)\r\n{\r\nint res;\r\nldp_lcd_pdata.enable_gpio = gpio + 7;\r\nldp_lcd_pdata.backlight_gpio = gpio + 15;\r\nres = platform_device_register(&ldp_lcd_device);\r\nif (res)\r\npr_err("Unable to register LCD: %d\n", res);\r\nreturn 0;\r\n}\r\nstatic int __init omap_i2c_init(void)\r\n{\r\nomap3_pmic_get_config(&ldp_twldata,\r\nTWL_COMMON_PDATA_USB | TWL_COMMON_PDATA_MADC, 0);\r\nomap3_pmic_init("twl4030", &ldp_twldata);\r\nomap_register_i2c_bus(2, 400, NULL, 0);\r\nomap_register_i2c_bus(3, 400, NULL, 0);\r\nreturn 0;\r\n}\r\nstatic void __init omap_ldp_init(void)\r\n{\r\nregulator_register_fixed(0, dummy_supplies, ARRAY_SIZE(dummy_supplies));\r\nomap3_mux_init(board_mux, OMAP_PACKAGE_CBB);\r\nldp_init_smsc911x();\r\nomap_i2c_init();\r\nplatform_add_devices(ldp_devices, ARRAY_SIZE(ldp_devices));\r\nomap_ads7846_init(1, 54, 310, NULL);\r\nomap_serial_init();\r\nomap_sdrc_init(NULL, NULL);\r\nusb_bind_phy("musb-hdrc.0.auto", 0, "twl4030_usb");\r\nusb_musb_init(NULL);\r\nboard_nand_init(ldp_nand_partitions, ARRAY_SIZE(ldp_nand_partitions),\r\n0, 0, nand_default_timings);\r\nomap_hsmmc_init(mmc);\r\nldp_display_init();\r\n}
