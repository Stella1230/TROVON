int s5p_gatectrl(void __iomem *reg, struct clk *clk, int enable)\r\n{\r\nunsigned int ctrlbit = clk->ctrlbit;\r\nu32 con;\r\ncon = __raw_readl(reg);\r\ncon = enable ? (con | ctrlbit) : (con & ~ctrlbit);\r\n__raw_writel(con, reg);\r\nreturn 0;\r\n}\r\nint s5p_epll_enable(struct clk *clk, int enable)\r\n{\r\nunsigned int ctrlbit = clk->ctrlbit;\r\nunsigned int epll_con = __raw_readl(S5P_EPLL_CON) & ~ctrlbit;\r\nif (enable)\r\n__raw_writel(epll_con | ctrlbit, S5P_EPLL_CON);\r\nelse\r\n__raw_writel(epll_con, S5P_EPLL_CON);\r\nreturn 0;\r\n}\r\nunsigned long s5p_epll_get_rate(struct clk *clk)\r\n{\r\nreturn clk->rate;\r\n}\r\nint s5p_spdif_set_rate(struct clk *clk, unsigned long rate)\r\n{\r\nstruct clk *pclk;\r\nint ret;\r\npclk = clk_get_parent(clk);\r\nif (IS_ERR(pclk))\r\nreturn -EINVAL;\r\nret = pclk->ops->set_rate(pclk, rate);\r\nclk_put(pclk);\r\nreturn ret;\r\n}\r\nunsigned long s5p_spdif_get_rate(struct clk *clk)\r\n{\r\nstruct clk *pclk;\r\nint rate;\r\npclk = clk_get_parent(clk);\r\nif (IS_ERR(pclk))\r\nreturn -EINVAL;\r\nrate = pclk->ops->get_rate(pclk);\r\nclk_put(pclk);\r\nreturn rate;\r\n}\r\nvoid __init s5p_register_clocks(unsigned long xtal_freq)\r\n{\r\nint ret;\r\nclk_ext_xtal_mux.rate = xtal_freq;\r\nret = s3c24xx_register_clocks(s5p_clks, ARRAY_SIZE(s5p_clks));\r\nif (ret > 0)\r\nprintk(KERN_ERR "Failed to register s5p clocks\n");\r\n}
