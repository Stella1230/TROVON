static int __init kona_l2_cache_init(void)\r\n{\r\nif (!IS_ENABLED(CONFIG_CACHE_L2X0))\r\nreturn 0;\r\nif (bcm_kona_smc_init() < 0) {\r\npr_info("Kona secure API not available. Skipping L2 init\n");\r\nreturn 0;\r\n}\r\nbcm_kona_smc(SSAPI_ENABLE_L2_CACHE, 0, 0, 0, 0);\r\nreturn l2x0_of_init(0, ~0);\r\n}\r\nstatic void bcm_board_setup_restart(void)\r\n{\r\nstruct device_node *np;\r\nnp = of_find_compatible_node(NULL, NULL, "brcm,bcm11351");\r\nif (np) {\r\nif (of_device_is_available(np))\r\nbcm_kona_setup_restart();\r\nof_node_put(np);\r\n}\r\n}\r\nstatic void __init board_init(void)\r\n{\r\nof_platform_populate(NULL, of_default_bus_match_table, NULL,\r\n&platform_bus);\r\nbcm_board_setup_restart();\r\nkona_l2_cache_init();\r\n}
